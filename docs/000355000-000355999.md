# StackOverflow 问答 000355000-000355999

# c++ - 如何在 Visual C++ 中使用 Windows 窗体创建特定控件？

> ID：355006
> 
> 赞同：2
> 
> 时间：2008-12-10T03:22:25.007
> 
> 标签：c++, windows, forms, visual-c++

我是在 C++ 中使用 Windows 窗体的新手（并且只是一般情况下），我不确定名称，或者是否可以这样做。

目前我正在做一个学校项目，我们必须为一个虚构的书店制作一个程序。我现在正在尝试制作一份清单，显示“客户”正在购买什么。我必须按价格和 ISBN 以及这本书的任何其他变量对其进行排序。

本质上，我正在尝试制作如下内容：
![控制](https://img.photobucket.com/albums/v683/Dalze/ListView.png)

我只需要知道如何开始。我无法弄清楚控件的名称是什么，或者每次用户单击标题时如何对其进行排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T04:29:00.160

您需要编写托管 C++ 请查看 [http://www.codeproject.com/KB/miscctrl/mfcandwindowsforms.aspx?fid=3422&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2509859](http://www.codeproject.com/KB/miscctrl/mfcandwindowsforms.aspx?fid=3422&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2509859)

尝试以同样的方式进行控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T17:16:43.110

请提供有关 Dalze-> 使用托管控件的任何要求的问题的更多详细信息？还是不使用它们？你的教授希望你从这个练习中学到什么（以及如何使用堆栈溢出来完成你的作业）？

有几种方法可以给这只猫剥皮。

如果您应该或想要使用托管代码：提到的 DataGrid 是一个很好的简单数据库工具[链接文本](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.aspx)

sql 数据库还可以保存所有信息并允许对各种子元素进行排序。

如果您选择不使用托管代码，您可以构建一些简单的对象来携带您需要的信息，然后为每个感兴趣的变量添加一些排序函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-21T17:43:02.047

如果你想了解 Windows UI 的内部工作原理，我建议你暂时远离 .NET，学习一些 C++ 和 WinAPI 的基础知识。有时编程 .NET（或 C++/COM）需要您调用非托管组件/函数，您会很高兴您了解低级事物的工作原理。

如果您的项目需要 .NET，请继续，但不要忘记给自己一些时间来学习古老的 Win32 / C++ 编程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T03:31:41.943

您正在寻找的 WindowsForms 控件称为 DataGrid

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T04:03:27.107

您的问题并不完全清楚，但是如果您尝试从标准 c++ 访问 Windows 窗体，那么您就不走运了。Windows 窗体生活在托管世界中，而 c++ 是非托管的。要使用 Windows 窗体，您必须切换到 C++/CLI 或 C#。如果您正在为学校项目做某事，那可能不是一个选择。

如果可以选择这样切换语言。我会开始查看 C++/CLI 文档，以了解事情如何为您工作。

# javascript - jQuery事件来检测元素位置何时改变

> ID：355015
> 
> 赞同：27
> 
> 时间：2008-12-10T03:32:52.177
> 
> 标签：javascript, jquery, events, javascript-events

我想知道是否有一个 jQuery 事件可用于确定特定 DIV 的`top`属性何时发生更改。

例如，我在 DIV 上方有不可见的内容。当该内容变得可见时，DIV 将向下移动。我想捕获该事件，然后使用该`offset()`函数获取 X/Y 坐标。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-10T03:46:41.307

简单的答案是 DOM 中没有用于检测布局更新的事件。

在我看来，您有几个选择：

1.  民意调查，讨厌，但它可能会根据您的更新频率要求而起作用。

2.  利用任何事件导致不可见的 DIV 改变大小并在该处理程序中执行您需要执行的任何操作

* * *

我会纠正自己。

我查看了 DOM 并注意到了 DOMAttrModified 事件并发现了这个[JQuery 插件](http://www.west-wind.com/weblog/posts/478985.aspx)，您可以利用它来做您想做的事情。

正如文章所提到的，它在 IE 和 Firefox 中运行良好，但在 WebKit 中似乎存在问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T03:40:16.687

我认为你应该能够做到：

```
$(document).ready( function (){
  $("#mydiv").bind("movestart", function (){ ...remember start position... });
  $("#mydiv").bind("moveend", function (){ ...calculate offsets etc... });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-06T01:30:12.877

```
$("#someId").resize(function () {

// your code

}); 
```

# c# - 在 C# 中自动终止非必要线程

> ID：355019
> 
> 赞同：3
> 
> 时间：2008-12-10T03:36:30.873
> 
> 标签：c#, multithreading

我在 C# 中有一个对象，我需要在该对象上定期执行一个方法。我希望仅在其他人使用我的对象时才执行此方法，一旦人们停止使用我的对象，我希望此后台操作停止。

因此，这是一个简单的示例（已损坏）：

```
class Fish
{
    public Fish()
    {
        Thread t = new Thread(new ThreadStart(BackgroundWork));     
        t.IsBackground = true;
        t.Start();
    }

    public void BackgroundWork()
    {
        while(true)
        {
            this.Swim(); 
            Thread.Sleep(1000); 
        }
    }

    public void Swim()
    {
         Console.WriteLine("The fish is Swimming"); 
    }
} 
```

问题是，如果我在任何地方新建一个 Fish 对象，它永远不会被垃圾收集，因为有一个后台线程引用它。这是损坏代码的图解版本。

```
public void DoStuff()
{ 
   Fish f = new Fish();
}
// after existing from this method my Fish object keeps on swimming. 
```

我知道 Fish 对象应该是一次性的，我应该在 dispose 时清理线程，但我无法控制我的调用者，也无法确保调用 dispose。

如何解决此问题并确保即使未显式调用 Dispose 也会自动释放后台线程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-25T00:56:58.837

这是我对这个问题提出的解决方案：

```
class Fish : IDisposable 
{
    class Swimmer
    {
        Thread t; 
        WeakReference fishRef;
        public ManualResetEvent terminate = new ManualResetEvent(false);

        public Swimmer(Fish3 fish)
        {
            this.fishRef = new WeakReference(fish);
            t = new Thread(new ThreadStart(BackgroundWork));    
            t.IsBackground = true;
            t.Start();
        } 

        public void BackgroundWork()
        {
            bool done = false;
            while(!done)
            {
                done = Swim(); 
                if (!done) 
                {
                    done = terminate.WaitOne(1000, false);
                } 
            }
        }

        // this is pulled out into a helper method to ensure 
        // the Fish object is referenced for the minimal amount of time
        private bool Swim()
        {
            bool done;

            Fish fish = Fish; 
            if (fish != null)
            {
                fish.Swim(); 
                done = false;
            }
            else 
            {
                done = true;
            }
            return done;
        }

        public Fish Fish
        {
            get { return fishRef.Target as Fish3; }
        }
    }

    Swimmer swimmer;

    public Fish()
    {
            swimmer = new Swimmer(this);
    }

    public void Swim()
    {
        Console.WriteLine("The third fish is Swimming"); 
    }

    volatile bool disposed = false;

    public void Dispose()
    {
        if (!disposed)
        {
            swimmer.terminate.Set();
            disposed = true;
            GC.SuppressFinalize(this);
        }       
    }

    ~Fish() 
    {
        if(!disposed)
        {
            Dispose();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T03:47:03.660

我认为 IDisposable 解决方案是正确的。

如果您的类的用户不遵循使用实现 IDisposable 的类的准则，那是他们的错 - 您可以确保文档明确提及应如何使用该类。

另一个更混乱的选项是“KeepAlive”日期时间字段，您的客户端调用的每个方法都会更新该字段。然后，工作线程会定期检查该字段，如果在一定时间内没有更新，则退出。当方法正在设置字段时，如果线程退出，它将重新启动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T04:39:27.673

我会这样做：

```
class Fish3 : IDisposable
{
    Thread t;
    private ManualResetEvent terminate = new ManualResetEvent(false);
    private volatile int disposed = 0;

    public Fish3()
    {
        t = new Thread(new ThreadStart(BackgroundWork));
        t.IsBackground = true;
        t.Start();
    }

    public void BackgroundWork()
    {
        while(!terminate.WaitOne(1000, false))
        {
            Swim();         
        }
    }

    public void Swim()
    {
        Console.WriteLine("The third fish is Swimming");
    }

    public void Dispose()
    {
        if(Interlocked.Exchange(ref disposed, 1) == 0)
        {
            terminate.Set();
            t.Join();
            GC.SuppressFinalize(this);
        }
    }

    ~Fish3()
    {
        if(Interlocked.Exchange(ref disposed, 1) == 0)
        {
            Dispose();
        }
    }
} 
```

# c# - 在C#中将double格式化为字符串

> ID：355020
> 
> 赞同：9
> 
> 时间：2008-12-10T03:36:51.530
> 
> 标签：c#, .net, formatting

我有一个 Double ，其值可能在 0.000001 到 1,000,000,000.000 之间

我希望将此数字格式化为字符串，但有条件地取决于它的大小。因此，如果它非常小，我想使用以下格式对其进行格式化：

```
String.Format("{0:.000000000}", number); 
```

如果它不是那么小，比如 0.001，那么我想使用类似的东西

```
String.Format("{0:.00000}", number); 
```

如果它结束了，比如 1,000，然后将其格式化为：

```
String.Format("{0:.0}", number); 
```

有没有一种聪明的方法可以根据我要格式化的值的大小来构造这个格式字符串？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-10T03:48:03.020

使用双精度绝对值的 Math.Log10 来计算小数点左侧（如果为正）或右侧（如果为负）需要多少个 0。根据该值选择格式字符串。您需要单独处理零值。

```
string s;
double epislon = 0.0000001; // or however near zero you want to consider as zero
if (Math.Abs(value) < epislon) {
    int digits = Math.Log10( Math.Abs( value ));
    // if (digits >= 0) ++digits; // if you care about the exact number
    if (digits < -5) {
       s = string.Format( "{0:0.000000000}", value );
    }
    else if (digits < 0) {
       s = string.Format( "{0:0.00000})", value );
    }
    else {
       s = string.Format( "{0:#,###,###,##0.000}", value );
    }
}
else {
    s = "0";
} 
```

或者根据位数动态构建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T03:42:52.733

将 # 字符用于字符串中的可选位置：

```
string.Format("{0:#,###,##0.000}", number); 
```

我不认为你可以控制这样的小数位数，因为双精度可能会搞砸。

要封装决定输出多少小数位的逻辑，您可以查看创建自定义格式化程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T13:53:35.230

您问题中的前两个 String.Format 可以通过自动删除尾随零来解决：

```
String.Format("{0:#,##0.########}", number); 
```

最后一个你可以通过调用 Math.Round(number,1) 来解决超过 1000 的值，然后使用相同的 String.Format。

就像是：

```
String.Format("{0:#,##0.########}", number<1000 ? number : Math.Round(number,1)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T18:49:14.653

跟进 OwenP（以及“扩展”tvanfosson）：

如果它足够常见，并且您使用的是 C# 3.0，我会将其转换为 double 的扩展方法：

```
class MyExtensions 
{
    public static string ToFormmatedString(this double d)
    {
        // Take d and implement tvanfosson's code
    }
} 
```

现在任何你有双倍的地方你都可以做：

```
double d = 1.005343;
string d_formatted = d.ToFormattedString(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T23:36:21.327

如果是我，我会编写一个自定义包装类并将 tvanfosson 的代码放入它的`ToString`方法中。这样你仍然可以使用双精度值，但几乎在所有情况下你都会得到正确的字符串表示。它看起来像这样：

```
class FormattedDouble
{ 
    public double Value { get; set; }

    protected overrides void ToString()
    {
        // tvanfosson's code to produce the right string
    }
} 
```

也许把它变成一个结构可能会更好，但我怀疑它会产生很大的不同。你可以像这样使用这个类：

```
var myDouble = new FormattedDouble();
myDouble.Value = Math.Pi;
Console.WriteLine(myDouble); 
```

# multithreading - 在这种情况下 SQLite 线程安全吗？

> ID：355025
> 
> 赞同：5
> 
> 时间：2008-12-10T03:44:03.557
> 
> 标签：multithreading, sqlite

我需要来自多个线程的数据库访问操作，通过一个持有数据库连接的单例对象。我从 SQLite3 的网站上读到，说“sqlite3 结构只能在调用 sqlite3_open() 来创建它的同一线程中使用。您无法在一个线程中打开数据库，然后将句柄传递给另一个线程以供它使用'。我想知道在我的情况下，是否存在线程不安全的威胁？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-10T03:49:48.773

如果 SQLite 库是使用 -DSQLITE_THREADSAFE 编译的，那么您可以使用更新的 SQLite 3 版本。

SQLite 的作者[说](http://www.mail-archive.com/sqlite-users@sqlite.org/msg34114.html)：

*从版本 3.5.0 开始，SQLite 使用
自己的内部互斥体强制执行此操作，因此应用程序可以自由（尝试）同时使用
来自多个线程的相同数据库连接。*

# queue - 是否可以仅使用 POSIX 信号量来避免唤醒等待竞赛？是良性的吗？

> ID：355030
> 
> 赞同：0
> 
> 时间：2008-12-10T03:48:34.283
> 
> 标签：queue, posix, atomic, semaphore, race-condition

我想使用 POSIX 信号量来管理从代表队列的文件中获取和放置的原子。我想要在文件系统中命名某些东西的灵活性，以便完全不相关的进程可以共享一个队列。我认为这个计划排除了 pthreads。命名的 posix 信号量非常适合在文件系统中放置任何进程都可以看到的东西，但我找不到标准的 CondWait 原语：

```
... decide we have to wait ....
CondWait(sem, cond); 
```

当进程调用 CondWait 时，它会自动发布到 sem 并等待 cond。当其他一些进程发布到 cond 时，等待进程只有在它也可以自动递减 sem 时才会唤醒。的替代品

```
... decide we have to wait ....
sem_post(sem);
sem_wait(cond);
sem_wait(sem); 
```

受到竞争条件的影响，其中一些其他进程在该进程等待它之前发出 cond 信号。

我几乎没有做过任何并发编程，所以我想我会问这样：如果我对条件变量使用标准的 POSIX 计数信号量，这场比赛有可能是良性的吗？

以防万一有人想要更大的上下文，我正在为可以从 shell 脚本调用的原子队列构建 get 和 put 操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T05:13:35.830

由于没有其他答案，我将跟进我所学到的：

*   Pthreads 不适用于我的应用程序，因为我有没有共同祖先的进程需要共享原子队列。
*   Posix 信号量*受到*唤醒等待竞赛的影响，但因为与经典条件变量不同，**它们计算信号量**，所以竞赛是良性的。我没有这种说法的证据，但我的系统已经运行了两天并且运行良好。（我知道这完全没有意义，但至少这意味着我完成了工作。）
*   命名的 Posix 信号量**很难从文件系统中进行垃圾收集**。

总而言之，命名 Posix 信号量被证明是**实现原子队列抽象以在不相关进程之间共享的良好基础**。

我想要一个证明或经过验证的 SPIN 模型，但由于我对应用程序的需求有限，我似乎不太可能写一个。我希望这对可能想要使用 Posix 信号量的其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T23:22:06.420

根据[POSIX](http://www.opengroup.org/onlinepubs/009695399/toc.htm)标准，信号量例程的集合是：

*   sem_close()
*   sem_destroy()
*   sem_getvalue()
*   sem_init()
*   sem_open()
*   sem_post()
*   sem_timedwait()
*   sem_trywait()
*   sem_unlink()
*   sem_wait()

和功能可能是您正在寻找的`sem_trywait()`。`sem_timedwait()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-04T06:44:05.407

我知道这个问题很老，但显而易见的解决方案是只使用位于文件中的进程共享互斥锁和条件变量`mmap`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-10T07:48:27.217

您正在寻找：pthread_cond_wait，pthread_cond_signal，我想。
也就是说，如果您使用的是 posix 线程，那么 pthread 方法将提供 CondWait 和 Signal 的功能。
在此处查找有关通过共享内存的多进程 pthread 的源代码。
[http://linux.die.net/man/3/pthread_mutexattr_init](http://linux.die.net/man/3/pthread_mutexattr_init)
那是针对Linux的，但是文档是posix的。它们类似于 Solaris，但您需要仔细阅读操作系统上的手册页。

# hibernate - 如何在休眠中表示与同一个表/实体的多对多关系？

> ID：355031
> 
> 赞同：0
> 
> 时间：2008-12-10T03:49:01.973
> 
> 标签：hibernate

那可能吗？我的意思是，多对多关系的两端可以指向同一张表吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T04:49:03.943

如果没有大量可怕的冗余，我不确定你会怎么做。处理两个表之间的多对多关系的标准方法是通过包含两个主键值的第三个表，一个用于第一个表，一个用于第二个表，并带有唯一约束（读取“索引”）所有这些列的组合，并且可能在单独的主键上带有一个或两个重复（非唯一）索引。概述：

```
CREATE TABLE Table1 (pkcol1 ... PRIMARY KEY, ...);
CREATE TABLE Table2 (pkcol2 ... PRIMARY KEY, ...);
CREATE TABLE MtoM_Table1_Table2
(
     pkcol1 ... REFERENCES Table1,
     pkcol2 ... REFERENCES Table2,
     PRIMARY KEY (pkcol1, pkcol2)
);
-- CREATE INDEX fk1_mtom_table1_table2 ON MtoM_Table1_Table2(pkcol1);
-- CREATE INDEX fk2_mtom_table1_table2 ON MtoM_Table1_Table2(pkcol2); 
```

如果您的 DBMS 是智能的，您可以跳过主键前导列上的单独索引，因为在搜索前导值时也可以使用主键上的索引。

假设 Table1 和 Table2 是同一张表（所以，事实上，我们只有 Table1），如问题所示；这通常仍需要 MtoM_Table1_Table1 映射表 - 与主表不同的表。映射表的 PK（主键）列必须具有单独的名称，但映射表中的两个列（或列集）都将引用 Table1 中的 PK 列。

```
CREATE TABLE Table1 (pkcol1 ... PRIMARY KEY, ...);
CREATE TABLE MtoM_Table1_Table1
(
     pkcol1 ... REFERENCES Table1(pkcol1),
     akcol1 ... REFERENCES Table1(pkcol1),
     PRIMARY KEY (pkcol1, akcol1)
);
-- CREATE INDEX fk1_mtom_table1_table1 ON MtoM_Table1_Table1(pkcol1);
-- CREATE INDEX fk2_mtom_table1_table1 ON MtoM_Table1_Table1(akcol1); 
```

如果您也想消除映射表，那么您必须在 Table1 中有第二列来保存另一个 PK 值 - 称之为 FKcol1（用于外键列）。这让你有一个困惑：主键是什么？它必须是 PKCol1 和 FKCol1 的组合。但是 FKCol1 应该引用另一行的主键——所以你有一个矛盾。即使假设您设法避免将其作为一个问题（如何，确切地说？），在多对多关系的引用端有“多行”，您必须在主表中有多行具有相同的数据除了 FKcol 之外的所有列，但这些列将引用表中的一个数字（通常不止一个）其他行。这是一个矛盾加上冗余的噩梦，再加上你丢失了简单的主键，

```
CREATE TABLE Table1
(
    pkcol1 ... /* PRIMARY KEY */,
    fkcol1 ... /* FOREIGN KEY REFERENCES Table1(pkcol1) */,
    ...
);
-- CREATE INDEX fk1_table1 ON Table1(pkcol1);
-- CREATE INDEX fk2_table1 ON Table1(fkcol1); 
```

So, I'm convinced that the only sane answer is "No - you cannot represent both ends of a many-to-many relationship in the same table; you must use a mapping table to retain much chance of anything working 'as usual' in the system".

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T03:50:58.503

如果您使用的是 hibernate-annotations，则有一个 @ManyToMany，不确定 XML 等价物。它应该出现在您的发行版的 API 文档中

# database - 如何在 Linq-To-Sql 类中创建可选关联？

> ID：355032
> 
> 赞同：0
> 
> 时间：2008-12-10T03:49:37.620
> 
> 标签：database, linq, linq-to-sql

我正在尝试在几个表之间创建可选关联。我有一张名为 Invoice 的表。Invoice 表通过 CustomerId 字段具有对 Customer 表的 FK 引用。Invoice 表还可以通过 ProjectId 字段对 Project 进行非强制 FK 引用。

无论如何设置我的 Linq-To-Sql 类以在 Invoice 和 Project 表之间建立可选关联？

如果有可用的话，我希望能够通过此关联选择项目名称。

**澄清**

是否可以在 dbml 文件中进行设置？我有一个扩展 Invoice 实体的部分类，并且希望能够创建一个名为 ProjectName 的属性来包装 Invoice.Project.Name。

只是想知道这是否可能，或者我是否必须在查询中返回左连接值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T04:05:35.433

这应该这样做（VB语法）：

```
Dim results = _
    From i in context.Invoice _
    Join c in context.Customer On i.CustomerId Equals c.CustomerId _
    Group Join p in context.Project On i.ProjectId Equals p.ProjectId Into g = Group _
    Select i.InvoiceName, c.CustomerName, ProjectName = (From x In g Select x.Name).SingleOrDefault 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T13:25:18.897

我想我想通了……这比我想象的要简单得多。我只需要检查部分类中的关系是否为空，它扩展了 LinqToSql 类。

就像是：

```
 public string ModifiedByName
    {
        get
        {
            if (this.ModifiedByUser == null)
                return string.Empty;
            else
                return this.ModifiedByUser.FirstName + " " + this.ModifiedByUser.LastName;
        }
    }

    public string CreatedByName
    {
        get
        {
            if (this.CreatedByUser == null)
                return string.Empty;
            else
                return this.CreatedByUser.FirstName + " " + this.CreatedByUser.LastName;
        }
    } 
```

# java - JSF RichFaces 和双滑块

> ID：355038
> 
> 赞同：1
> 
> 时间：2008-12-10T03:52:10.077
> 
> 标签：java, ajax, jsf, richfaces, scriptaculous

我在richfaces 中看到有一个滑块，想知道是否有人为它创建了一个像Scriptaculous 中那样的双滑块。

在应用程序中混合 JSF、Richfaces 和 Scriptaculous 是否有任何顾虑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T20:01:40.323

我无法准确回答您的问题，但这是我所知道的。

> 在应用程序中混合 JSF、Richfaces 和 Scriptaculous 是否有任何顾虑？

是的。人们在使用 JSF 时遇到的大约 50% 的问题是因为他们试图将其视为另一个 taglib 库，而不是像 Swing 或 SWT 这样的 UI 框架。JSF 设计者所设想的世界更像是可插入的 COM/ActiveX/VB 控件，而不是当前流行的 HTML 混搭。

也就是说，可以将 Scriptaculous 与 JSF 一起使用（见下文）。请注意，获取该值的 JSF 控件需要一些其他机制来将其*clientId*获取到 JavaScript（在本例中，绑定到托管 bean 的常规 HTML 隐藏字段）。这有点乱。

清理它的一种方法是将所有内容移动到 JSF 渲染器中，并让控件发出所有适当的 HTML 和 JavaScript。我想这就是 RichFaces 背后的基本原理。不幸的是，我从未使用过它，所以只有通过实验才能知道它的 JavaScript 库和 Scriptaculous 是否会共存。JavaScript 库作者是否一直在考虑互操作性的一个很好的指标是检查库是否已命名空间。

* * *

此代码使用滑块更新具有数值的文本字段：

看法：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core">
  <jsp:directive.page language="java"
    contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1" />
  <jsp:text>
    <![CDATA[ <?xml version="1.0" encoding="ISO-8859-1" ?> ]]>
  </jsp:text>
  <jsp:text>
    <![CDATA[ <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> ]]>
  </jsp:text>
  <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
  <meta http-equiv="Content-Type"
    content="text/html; charset=ISO-8859-1" />
  <title>Script Test</title>
  <script src="javascripts/prototype.js" type="text/javascript">/**/</script>
  <script src="javascripts/scriptaculous.js" type="text/javascript">/**/</script>
  <style type="text/css">
div.slider {
    width: 256px;
    margin: 10px 0;
    background-color: #ccc;
    height: 10px;
    position: relative;
}

div.slider div.handle {
    width: 10px;
    height: 15px;
    background-color: #f00;
    cursor: move;
    position: absolute;
}

div#zoom_element {
    width: 50px;
    height: 50px;
    background: #2d86bd;
    position: relative;
}
</style>
  </head>
  <body>

  <div class="demo">
  <p>Use the slider to change the value</p>
  <div id="zoom_slider" class="slider">
  <div class="handle"></div>
  </div>
  </div>

  <f:view>
    <h:form>
      <h:inputText binding="#{sliderIdBean.mycontrol}"
        value="#{sliderIdBean.value}" onchange="updateSlider()">
        <f:validateLongRange minimum="0" maximum="10" />
      </h:inputText>
      <h:commandButton value="Submit" action="#{sliderIdBean.action}" />
    </h:form>
    <h:messages />
  </f:view>

  <script type="text/javascript">
    var zoom_slider = $('zoom_slider'),
        mycontrol = $('${sliderIdBean.clientId}');

    var ctrl = new Control.Slider(zoom_slider.down('.handle'), zoom_slider, {
      range: $R(0, 10),
      sliderValue: mycontrol.getValue(),
      onSlide: function(value) {
        value = Math.ceil(value);
        mycontrol.setValue(value);
      },
      onChange: function(value) {
        value = Math.ceil(value); 
        mycontrol.setStyle(value);
      }
    });

    function updateSlider() {
        ctrl.setValue(mycontrol.value);
    }
  </script>

  </body>
  </html>
</jsp:root> 
```

会话 bean：

```
public class SliderIdBean {

  private long value = 0;
  private UIComponent mycontrol;

  public long getValue() {
    return value;
  }

  public void setValue(long value) {
    this.value = value;
  }

  public UIComponent getMycontrol() {
    return mycontrol;
  }

  public void setMycontrol(UIComponent mycontrol) {
    this.mycontrol = mycontrol;
  }

  public String getClientId() {
    FacesContext context = FacesContext
        .getCurrentInstance();
    return mycontrol.getClientId(context);
  }

  public String action() {
    System.out.println("Submitted value was: " + value);
    return null;
  }

} 
```

面孔-config.xml：

```
<managed-bean>
    <managed-bean-name>sliderIdBean</managed-bean-name>
    <managed-bean-class>scripty.SliderIdBean</managed-bean-class>
    <managed-bean-scope>session</managed-bean-scope>
</managed-bean> 
```

JavaScript 可能有点杂乱无章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T10:30:20.603

该代码包含四个带有 4 个图像的选项卡（您可以包括图像、页面等），每个图像更改的滑动默认时间为 5 秒，并为用户提供选项卡单击。每当用户单击 4 个选项卡中的任何一个时，幻灯片就会开始。

```
<%@ page language="java" import="java.util.*" pageEncoding="ISO-8859-1"%>
<%@ taglib uri="http://java.sun.com/jsf/html" prefix="h"%>
<%@ taglib uri="http://java.sun.com/jsf/core" prefix="f"%>
<%@ taglib uri="http://richfaces.org/a4j" prefix="a4j"%>

<f:view>
    <body>
        <h:form id="signup">
            <table class="logo_background">
                <tr>
                    <td valign="top">
                        <table style="margin-left: 55px; background:#FFCC00" class="tab_background">
                            <tr>
                                <td width="145px" style="padding-left: 25px;">
                                    <a4j:commandLink id="linkHowToPlayId" onclick="retTabClick(this.id);" value="howtoplay"></a4j:commandLink>
                                </td>
                                <td width="100px" align="center" style="padding-left: 5px;">
                                    <a4j:commandLink id="linkRulesId" onclick="retTabClick(this.id);" value="rules"/>
                                </td>
                                <td width="5px">
                                </td>
                                <td width="130px" align="center" style="padding-left: 5px;">
                                    <a4j:commandLink id="linkChallengesId" onclick="retTabClick(this.id);" value="challenges"></a4j:commandLink>
                                </td>
                                <td width="5px">
                                </td>
                                <td width="130px" align="center" style="padding-left: 5px; padding-right: 15px;">
                                    <a4j:commandLink id="linkPickATeamId" onclick="retTabClick(this.id);" value="pickateam"/>
                                </td>
                            </tr>
                        </table>
                        <table>
                            <tr>
                                <td width="100px"></td>
                                <td valign="top">
                                    <table class="signup_background" style="width: 565px; height: 390px; border: solid 1px #5F8CC2;">
                                        <tr>
                                            <td id="content" style="width: 100%;" valign="top">
                                                <a4j:region>
                                                    <a4j:poll id="poll1" interval="2000" enabled="true" reRender="signup:howtoplay,signup:rules,signup:challenges,signup:pickateam" oncomplete="javascript:loopIt();"></a4j:poll>
                                                </a4j:region>
                                                <a4j:outputPanel id="howtoplay" layout="block" style="display:none;">
                                                    <h:graphicImage value="http://connectnigeria.com/articles/wp-content/uploads/2012/12/Google.jpg"></h:graphicImage>
                                                </a4j:outputPanel>
                                                <a4j:outputPanel id="rules" layout="block" style="display:none;">
                                                    <h:graphicImage value="http://good-wallpapers.com/pictures/4528/1280_countryside_landscape_wallpaper.jpg"></h:graphicImage>
                                                </a4j:outputPanel>
                                                <a4j:outputPanel id="challenges" layout="block" style="display:none;">
                                                    <h:graphicImage value="http://www.hdwallpapers.in/walls/windows_8_official-wide.jpg"></h:graphicImage>
                                                </a4j:outputPanel>
                                                <a4j:outputPanel id="pickateam" layout="block" style="display:none;">
                                                    <h:graphicImage value="../../images/87643.jpg"></h:graphicImage>
                                                </a4j:outputPanel>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </h:form>

<script type="text/javascript">
        var first= 1;
        if( first == 1)
        {
            document.getElementById("signup:howtoplay").style.display = 'block';
            document.getElementById("signup:rules").style.display = 'none';
            document.getElementById("signup:challenges").style.display = 'none';
            document.getElementById("signup:pickateam").style.display = 'none';

    }
    function retTabClick(tabId) {
        if (tabId == "signup:linkHowToPlayId") {
            first = "1";
        } else if (tabId == "signup:linkRulesId") {
            first = "2";
        } else if (tabId == "signup:linkChallengesId") {
            first = "3";
        } else if (tabId == "signup:linkPickATeamId") {
            first = "4";
        }
    }
     function loopIt()
     {
         if( first == 1)
         {
            document.getElementById("signup:howtoplay").style.display = 'block';
            document.getElementById("signup:rules").style.display = 'none';
            document.getElementById("signup:challenges").style.display = 'none';
            document.getElementById("signup:pickateam").style.display = 'none';
             first = 2;
         }
         else if (first == 2)
         {
            document.getElementById("signup:howtoplay").style.display = 'none';
            document.getElementById("signup:rules").style.display = 'block';
            document.getElementById("signup:challenges").style.display = 'none';
            document.getElementById("signup:pickateam").style.display = 'none';

             first = 3;
         }
         else if (first == 3)
         {
            document.getElementById("signup:howtoplay").style.display = 'none';
            document.getElementById("signup:rules").style.display = 'none';
            document.getElementById("signup:challenges").style.display = 'block';
            document.getElementById("signup:pickateam").style.display = 'none';

             first = 4;
         }
         else if (first == 4)
         {
            document.getElementById("signup:howtoplay").style.display = 'none';
            document.getElementById("signup:rules").style.display = 'none';
            document.getElementById("signup:challenges").style.display = 'none';
            document.getElementById("signup:pickateam").style.display = 'block';

             first = 1;
         }
     }
 </script>
</body> 
```

# javascript - 如何在 javascript 字符串中转义 & 符号，以便页面验证严格？

> ID：355043
> 
> 赞同：31
> 
> 时间：2008-12-10T04:01:03.820
> 
> 标签：javascript, jquery, ajax, w3c-validation

我正在尝试使用 JQuery 将 dataString 传递给 ajax 调用。在调用中，我构造了get参数，然后将它们发送到接收端的php页面。问题是数据字符串中包含与号，并且 HTML 严格验证器正在阻塞它。

这是代码：

```
$(document).ready(function(){
    $("input#email").focus();
    $('#login_submit').submit(function(){
        var username = $('input#email').val();
        var password = $('input#password').val();
        var remember = $('input#remember').attr("checked");
        var dataString = "email="+username+"&password="+password+"&remember="+remember;
        $.post('login.php', dataString, function(data) {
            if (data == 'Login Succeeded.') {
                location.reload(true);
            } else {
                $("input#email").focus();
                $("#login_msg").html(data).effect("pulsate", {times: 2}, 1000); 
            }
        });         
        return false;
    });
}); 
```

这是验证器消息的示例：无法为一般实体“密码”生成系统标识符。

```
var dataString = "email="+username+"&password="+password+"&remember="+rememb… 
```

（在验证器中，第一个＆符号后面的“p”标记为红色，表示失败点）。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-12-10T04:04:08.820

尝试将您的 javascript 放在 CDATA 块中，如下所示：

```
<script type="text/javascript">
<![CDATA[
// content of your Javascript goes here
]]>
</script> 
```

这应该使它通过验证。为了更加安全，您可以在 CDATA 标记周围添加 Javascript 注释，以对不理解 CDATA 标记的旧浏览器隐藏它们：

```
<script type="text/javascript">
/* <![CDATA[ */
// content of your Javascript goes here
/* ]]> */
</script> 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-06T19:33:41.777

"\u0026" 有效！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-10T23:00:07.453

注意：在盲目地将文本包装在 CDATA 块中之前，请注意 CDATA 的目的**不是**使无效字符有效。

见：[http ://www.flightlab.com/~joe/sgml/cdata.html](http://www.flightlab.com/~joe/sgml/cdata.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-29T22:57:52.913

有时`\u0026`, `&#38`, `%26`, `&amp`, or`<![CDATA[ ... ]]>`用于 xhtml 脚本块中的 & 符号。
我想问一下为什么我们需要这种限制（对 SGML 设计中的错误保持忠诚），它也会阻止`&nbsp`、`mathml`、`target`和`nested xml`工作。
为什么我们不能简单地说在脚本块中没有标签或其他 SGML 内容被识别？为什么 xhtml 不能让目标工作？
我没有看到 SGML 的优势大于劣势。现在，尽管 html5 有点可用，但 xhtml 是捕获最多开发人员错误的验证器。让我们在不考虑其起源的情况下修复 xml。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-10T04:07:40.763

我会尝试：

```
var dataString = "email="+username+"&amp;password="+password+"&amp;remember="+remember; 
```

# database-design - 如何将 trie 存储在关系数据库中？

> ID：355051
> 
> 赞同：32
> 
> 时间：2008-12-10T04:06:33.263
> 
> 标签：database-design, schema, relational, trie

我有一个前缀特里。在关系数据库中表示这种结构的推荐模式是什么？我需要子字符串匹配以保持效率。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-10T04:15:36.707

[物化路径](http://www.dbazine.com/oracle/or-articles/tropashko4)设计怎么样？

```
CREATE TABLE trie (
  path VARCHAR(<maxdepth>) PRIMARY KEY,
  ...other attributes of a tree node...
); 
```

要存储像“stackoverflow”这样的单词：

```
INSERT INTO trie (path) VALUES
  ('s'), ('st'), ('sta'), ('stac'), ('stack'),
  ('stacko'), ('stackov'), ('stackove'), ('stackover'),
  ('stackover'), ('stackoverf'), ('stackoverflo'),
  ('stackoverflow'); 
```

树中的具体化路径是字符本身的前缀序列。这也形成了主键。varchar 列的大小是要存储的最大 trie 深度。

我想不出比这更简单直接的了，它保留了高效的字符串存储和搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T04:30:02.140

您的任何实体是否与任何其他实体有关系？如果不是，也就是说，不是关系的，带有序列化的哈希表会做到这一点。

# wpf - 将 ViewModel 中的命令绑定到 View 中的元素的最佳方法是什么？

> ID：355053
> 
> 赞同：4
> 
> 时间：2008-12-10T04:07:14.993
> 
> 标签：wpf, design-patterns, mvvm, routed-commands

任何尝试使用 MV-VM 在 WPF 中实现 RoutedCommands 的人无疑都会遇到问题。命令（即非 UI 命令）应在 ViewModel 中实现。例如，如果我需要保存 CustomerViewModel，那么我会直接在我的 CustomerViewModel 上将其实现为命令。但是，如果我想弹出一个窗口来显示用户地址，我会直接在视图中实现 ShowCustomerAddress 命令，因为这是一个特定于 UI 的功能。

如何在视图模型中定义命令绑定，并在视图中使用它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T04:07:55.117

这是我想出的一个[解决方案。](http://codingcontext.wordpress.com/2008/12/10/commandbindings-in-mvvm/)

# c# - C# 与 Java 泛型

> ID：355060
> 
> 赞同：129
> 
> 时间：2008-12-10T04:12:29.133
> 
> 标签：c#, java, generics, comparison

我听说泛型的 Java 实现不如 C# 实现。在语法看起来很相似的情况下，Java 实现不合标准的地方是什么，或者它是一种宗教观点？

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2008-12-10T04:26:20.133

[streloksi 的链接](http://www.jprl.com/Blog/archive/development/2007/Aug-31.html)在消除差异方面做得很好。快速而肮脏的总结是......

在语法和用法方面。语言之间的语法大致相同。这里和那里的一些怪癖（最明显的是在约束中）。但基本上，如果你能读懂一个，你就可以读/用另一个。

最大的区别在于实施。

Java 使用类型擦除的概念来实现泛型。简而言之，底层编译的类实际上并不是通用的。它们编译为 Object 和 casts。实际上，Java 泛型是编译时工件，在运行时很容易被破坏。

另一方面，C# 凭借 CLR 实现了泛型，一直到字节码。为了在 2.0 中支持泛型，CLR 进行了几项重大更改。好处是性能改进、深度类型安全验证和反射。

再次提供的[链接](http://www.jprl.com/Blog/archive/development/2007/Aug-31.html)有更深入的细分，我鼓励您阅读

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-12-10T04:24:55.923

差异归结为 Microsoft 和 Sun 的设计决定。

[Java中的泛型](http://en.wikipedia.org/wiki/Generics_in_Java)是由编译器通过[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)实现的，这意味着类型检查发生在编译时，类型信息被删除。采用这种方法是为了使遗留代码与使用泛型的新代码兼容：

来自 Java 教程，[泛型：类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)：

> 当泛型类型被实例化时，编译器通过一种称为类型擦除的技术来转换这些类型——在这个过程中，编译器会删除与类或方法中的类型参数和类型参数相关的所有信息。类型擦除使使用泛型的 Java 应用程序能够保持与在泛型之前创建的 Java 库和应用程序的二进制兼容性。

但是，对于[C# (.NET) 中的泛型，](http://en.wikipedia.org/wiki/Generic_programming#Generic_programming_in_C.23_and_.NET)编译器不会擦除类型，并且类型检查是在运行时执行的。这样做的好处是类型信息保留在编译的代码中。

来自维基百科：

> 这种设计选择用于提供额外的功能，例如允许通过保留泛型类型进行反射，以及减轻擦除的一些限制（例如无法创建泛型数组）。这也意味着运行时强制转换和通常昂贵的装箱转换不会影响性能。

与其说“.NET 泛型优于 Java 泛型”，不如研究实现泛型的方法的差异。在 Java 中，保持兼容性似乎是一个高优先级，而在 .NET（在 2.0 版中引入时），实现使用泛型的全部好处是一个更高的优先级。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-10T12:26:33.830

还发现与 Anders Hejlsberg[的](http://www.artima.com/intv/generics.html)对话也可能很有趣。总结一下 Anders Hejlsberg 用一些额外的注释提出的观点：**Java 泛型是为了与现有 JVM 的最大兼容性而设计的**，与您在 C# 中看到的实现相比，这导致了一些奇怪的事情：

*   类型擦除强制实现将每个通用参数化值表示为`Object`. `Object`虽然编译器在更具体的类型之间提供自动转换，但它**并没有消除类型转换和装箱对性能的负面影响**（例如，转换`Object`为特定类型`MyClass`或`int`必须装箱`Integer`，这对于 C#/. NET 如果由于用户定义的值类型而遵循类型擦除方法）。正如安德斯所说：“你没有得到任何执行效率”（具体化泛型在 C# 中启用）

*   **类型擦除使编译时可用的信息在运行时无法访问**。过去的东西`List<Integer>`变成了`List`无法在运行时恢复泛型类型参数的东西。**这使得围绕 Java 泛型构建反射或动态代码生成场景变得困难。**最近的[SO 答案](https://stackoverflow.com/a/4812643/44647)通过匿名类显示了一种解决方法。但是如果没有技巧，在运行时通过反射生成代码，从一个集合实例中获取元素并将其放入另一个集合实例，在动态生成的代码执行期间可能会在运行时失败：在这些情况下，反射无助于捕获不`List<Double>`匹配`List<Integer>`.

但是 +1 链接到 Jonathan Pryor 的[博客文章](http://www.jprl.com/Blog/archive/development/2007/Aug-31.html)的答案。

# c# - .NET 中是否有字符串数学评估器？

> ID：355062
> 
> 赞同：97
> 
> 时间：2008-12-10T04:14:05.090
> 
> 标签：c#, .net

如果我有一个带有有效数学表达式的字符串，例如：

```
String s = "1 + 2 * 7"; 
```

.NET 中是否有内置库/函数可以为我解析和评估该表达式并返回结果？在这种情况下 15。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-09-13T23:05:10.620

奇怪的是，这个著名的老问题没有一个暗示内置[`DataTable.Compute`](http://msdn.microsoft.com/en-us/library/system.data.datatable.compute.aspx)“技巧”的答案。这里是。

```
double result = Convert.ToDouble(new DataTable().Compute("1 + 2 * 7", null)); 
```

表达式中支持以下算术运算符：

```
+ (addition)
- (subtraction)
* (multiplication)
/ (division)
% (modulus) 
```

更多信息：[`DataColumn.Expression`](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)在*表达式语法*。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-12-24T23:48:56.893

您可以添加对 Microsoft 脚本控件库 (COM) 的引用，并使用这样的代码来评估表达式。（也适用于 JScript。）

```
Dim sc As New MSScriptControl.ScriptControl()
sc.Language = "VBScript"
Dim expression As String = "1 + 2 * 7"
Dim result As Double = sc.Eval(expression) 
```

**编辑**- C# 版本。

```
MSScriptControl.ScriptControl sc = new MSScriptControl.ScriptControl();
sc.Language = "VBScript";
string expression = "1 + 2 * 7";
object result = sc.Eval(expression);            
MessageBox.Show(result.ToString()); 
```

**编辑**- ScriptControl 是一个 COM 对象。在项目的“添加引用”对话框中，选择“COM”选项卡并向下滚动到“Microsoft Script Control 1.0”并选择“确定”。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-12-24T23:37:28.257

对于在 Silverlight 上使用 C# 开发的任何人，这是我刚刚发现的一个非常巧妙的技巧，它允许通过调用 Javascript 引擎来评估表达式：

```
double result = (double) HtmlPage.Window.Eval("15 + 35"); 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2010-12-09T09:35:41.340

你看过[http://ncalc.codeplex.com](http://ncalc.codeplex.com)吗？

它是可扩展的、快速的（例如有自己的缓存），使您能够通过处理 EvaluateFunction/EvaluateParameter 事件在运行时提供自定义函数和变量。它可以解析的示例表达式：

```
Expression e = new Expression("Round(Pow(Pi, 2) + Pow([Pi2], 2) + X, 2)"); 

  e.Parameters["Pi2"] = new Expression("Pi * Pi"); 
  e.Parameters["X"] = 10; 

  e.EvaluateParameter += delegate(string name, ParameterArgs args) 
    { 
      if (name == "Pi") 
      args.Result = 3.14; 
    }; 

  Debug.Assert(117.07 == e.Evaluate()); 
```

它还原生处理 unicode 和许多数据类型。如果您想更改语法，它会附带一个 antler 文件。还有一个 fork 支持 MEF 加载新功能。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-02-04T00:59:17.617

实际上有一种内置的 - 您可以使用 XPath 命名空间！尽管它要求您重新格式化字符串以使用 XPath 表示法进行确认。我使用这样的方法来处理简单的表达式：

```
 public static double Evaluate(string expression)
    {
        var xsltExpression = 
            string.Format("number({0})", 
                new Regex(@"([\+\-\*])").Replace(expression, " ${1} ")
                                        .Replace("/", " div ")
                                        .Replace("%", " mod "));

        return (double)new XPathDocument
            (new StringReader("<r/>"))
                .CreateNavigator()
                .Evaluate(xsltExpression);
    } 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2016-03-22T13:53:38.773

既然 Roslyn 可用，还有另一个选择：

您可以为此使用 CodeAnalysis.CSharp.Scripting 库。

```
using Microsoft.CodeAnalysis.CSharp.Scripting;
using System;

namespace ExpressionParser
{
    class Program
    {
        static void Main(string[] args)
        {
            //Demonstrate evaluating C# code
            var result = CSharpScript.EvaluateAsync("System.DateTime.Now.AddDays(-1) > System.DateTime.Now").Result;
            Console.WriteLine(result.ToString());

            //Demonstrate evaluating simple expressions
            var result2 = CSharpScript.EvaluateAsync(" 5 * 7").Result;
            Console.WriteLine(result2);
            Console.ReadKey();
        }
    }
} 
```

nuget包：

```
<package id="Microsoft.CodeAnalysis.Analyzers" version="1.1.0" targetFramework="net461" />
<package id="Microsoft.CodeAnalysis.Common" version="1.1.1" targetFramework="net461" />
<package id="Microsoft.CodeAnalysis.CSharp" version="1.1.1" targetFramework="net461" />
<package id="Microsoft.CodeAnalysis.CSharp.Scripting" version="1.1.1" targetFramework="net461" />
<package id="Microsoft.CodeAnalysis.Scripting" version="1.1.1" targetFramework="net461" />
<package id="Microsoft.CodeAnalysis.Scripting.Common" version="1.1.1" targetFramework="net461" /> 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2016-01-19T06:35:01.050

最初，我将 c# 包装器用于[muparser](http://muparser.beltoforion.de/)。这是非常快的。我知道的唯一更快的解决方案是[exprtk](http://www.partow.net/programming/exprtk/index.html)。如果您正在寻找其他解决方案，您可以查看[基准](https://github.com/ArashPartow/math-parser-benchmark-project)。

但是对于 .Net，您可以使用内置支持在运行时编译代码。这个想法是有一个“模板”源文件作为例如嵌入式资源，您可以在其中替换评估公式。然后你将这个准备好的类源代码传递给编译器。

一个基本模板可能如下所示：

```
public class CSCodeEvaler
{
    public double EvalCode()
    {
        return last = Convert.ToDouble(%formula%);
    }

    public double last = 0;
    public const double pi = Math.PI;
    public const double e = Math.E;
    public double sin(double value) { return Math.Sin(value); }
    public double cos(double value) { return Math.Cos(value); }
    public double tan(double value) { return Math.Tan(value); }
    ... 
```

请注意将放入表达式的 %formula%。

编译使用类 CSharpCodeProvider。我不想在这里放完整的源代码。但是[这个答案](https://stackoverflow.com/questions/3188882/compile-and-run-dynamic-code-without-generating-exe)可能会有所帮助：

加载内存程序集后，您可以创建类的实例并调用 EvalCode。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2016-03-03T23:22:32.660

最近我在使用 mXparser，它是一个用于 .NET 和 JAVA 的数学解析器库。mXparser 支持基本公式以及非常花哨/复杂的公式（包括变量、函数、运算符、迭代和递归）。

[https://mxparser.codeplex.com/](https://mxparser.codeplex.com/)

[https://mathparser.org/](https://mathparser.org/)

几个使用示例：

示例 1：

```
Expression e = new Expression("1+2*7 + (sin(10) - 2)/3");
double v = e.calculate(); 
```

示例 2：

```
Argument x = new Argument("x = 5");
Expression e = new Expression("2*x+3", x);
double v = e.calculate(); 
```

示例 3：

```
Function f = new Function("f(x,y) = sin(x) / cos(y)");
Expression e = new Expression("f(pi, 2*pi) - 2", f);
double v = e.calculate(); 
```

最近发现 - 如果您想尝试语法（并查看高级用例），您可以下载由 mXparser 提供支持的[Scalar](https://scalarmath.org) [Calculator](https://play.google.com/store/apps/details?id=org.mathparser.scalar.lite) [应用程序。](https://play.google.com/store/apps/details?id=org.mathparser.scalar.pro)

最好的祝福

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2011-11-15T10:28:50.263

如果您需要非常简单的东西，您可以使用`DataTable`:-)

```
Dim dt As New DataTable
dt.Columns.Add("A", GetType(Integer))
dt.Columns.Add("B", GetType(Integer))
dt.Columns.Add("C", GetType(Integer))
dt.Rows.Add(New Object() {12, 13, DBNull.Value})

Dim boolResult As Boolean = dt.Select("A>B-2").Length > 0

dt.Columns.Add("result", GetType(Integer), "A+B*2+ISNULL(C,0)")
Dim valResult As Object = dt.Rows(0)("result") 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-06-01T00:22:13.350

您可以使用我所编写的[Math-Expression-Evaluator库。](https://github.com/Giorgi/Math-Expression-Evaluator)它支持简单的表达式，例如`2.5+5.9`, `17.89-2.47+7.16`, `5/2/2+1.5*3+4.58`, 带括号的`(((9-6/2)*2-4)/2-6-1)/(2+24/(2+4))`表达式和带变量的表达式：

```
var a = 6;
var b = 4.32m;
var c = 24.15m;
var engine = new ExpressionEvaluator();
engine.Evaluate("(((9-a/2)*2-b)/2-a-1)/(2+c/(2+4))", new { a, b, c}); 
```

您还可以将参数作为命名变量传递：

```
dynamic dynamicEngine = new ExpressionEvaluator();

var a = 6;
var b = 4.5m;
var c = 2.6m;

dynamicEngine.Evaluate("(c+b)*a", a: 6, b: 4.5, c: 2.6); 
```

它支持 .Net Standard 2.0，因此可以从 .Net Core 以及 .Net Full Framework 项目中使用，并且没有任何外部依赖项。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-01-27T09:13:01.537

我也会看看 Jace ( [https://github.com/pieterderycke/Jace](https://github.com/pieterderycke/Jace) )。Jace 是一个高性能的数学解析器和计算引擎，支持所有 .NET 风格（.NET 4.x、Windows Phone、Windows Store，...）。Jace 也可通过 NuGet 获得：[https ://www.nuget.org/packages/Jace](https://www.nuget.org/packages/Jace)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-07-21T05:20:59.537

一个简单的数学解析器很容易构建，只需要几行代码：

举个灵活的例子：

```
class RPN
{
    public static double Parse( Stack<string> strStk )
    {
        if (strStk == null || strStk.Count == 0 )
        {
            return 0;
        }
        Stack<double> numStk = new Stack<double>();
        double result = 0;

        Func<double, double> op = null;
        while (strStk.Count > 0)
        {
            var s = strStk.Pop();
            switch (s)
            {
                case "+":
                    op = ( b ) => { return numStk.Pop() + b; };
                    break;
                case "-":
                    op = ( b ) => { return numStk.Pop() - b; };
                    break;
                case "*":
                    op = ( b ) => { return numStk.Pop() * b; };
                    break;
                case "/":
                    op = ( b ) => { return numStk.Pop() / b; };
                    break;

                default:
                    double.TryParse(s, NumberStyles.Any, out result);
                    if (numStk.Count > 0)
                    {
                        result = op(result);
                    }
                    numStk.Push(result);
                    break;
            }
        }
        return result;
    }
}

....
var str = " 100.5 + 300.5 - 100 * 10 / 100";    
str = Regex.Replace(str, @"\s", "", RegexOptions.Multiline);
Stack<string> strStk = new Stack<string>(
     Regex.Split(str, @"([()*+\/-])", RegexOptions.Multiline).Reverse()
);
RPN.Parse(strStk); 
```

通过将一堆堆栈括起来来启用优先级就足够了，例如通过递归归档。括号之间的任何东西都放在一个新的堆栈上。最后，您可以通过 lambdas 以清晰易读的方式支持数学运算。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-02-13T17:28:21.110

```
namespace CalcExp
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            double res = Evaluate("4+5/2-1");

            Console.WriteLine(res);

        }

        public static double Evaluate(string expression)
        {
            var xsltExpression =
                string.Format("number({0})",
                    new Regex(@"([\+\-\*])").Replace(expression, " ${1} ")
                                            .Replace("/", " div ")
                                            .Replace("%", " mod "));

// ReSharper disable PossibleNullReferenceException
            return (double)new XPathDocument
                (new StringReader("<r/>"))
                    .CreateNavigator()
                    .Evaluate(xsltExpression);
// ReSharper restore PossibleNullReferenceException
        }

    }
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-06-15T14:32:15.990

几年前我实现了一个表达式解析器，最近在[GitHub](https://github.com/RushuiGuan/expression)和[Nuget:Albatross.Expression](https://www.nuget.org/packages/Albatross.Expression/)上发布了它的一个版本。它包含一个 ExecutionContext 类，可以评估一组表达式，例如：

*   MV = 价格 * 数量；
*   价格 =（买价 + 卖价）/2；
*   出价 = .6;
*   询问 = .8;

它还内置了循环引用检查，可用于避免堆栈溢出。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-03-07T18:51:34.657

# MathNet.符号

```
using System;
using static MathNet.Symbolics.SymbolicExpression;
using static System.Console;
using static System.Numerics.Complex;
using Complex = System.Numerics.Complex;

namespace MathEvaluator
{
    class Program
    {
        static readonly Complex i = ImaginaryOne;

        static void Main(string[] args)
        {
            var z = Variable("z");
            Func<Complex, Complex> f = Parse("z * z").CompileComplex(nameof(z));
            Complex c = 1 / 2 - i / 3;
            WriteLine(f(c));

            var x = Variable("x");
            Func<double, double> g = Parse("x * x + 5 * x + 6").Compile(nameof(x));
            double a = 1 / 3.0;
            WriteLine(g(a));
        }
    }
} 
```

不要忘记加载

```
<PackageReference Include="MathNet.Symbolics" Version="0.20.0" /> 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-06-12T13:04:23.583

没有内置的解决方案，但有一些简单的方法可以让它工作。

现在至少有两个很好的新解决方案：使用符号代数[AngouriMath](https://github.com/asc-community/AngouriMath)或通用算法库[Towel](https://github.com/ZacharyPatten/Towel)。

### 安古里数学

你可以做

```
using AngouriMath;
Entity expr = "1 + 2 + sqrt(2)";
var answer = (double)expr.EvalNumerical(); 
```

（默认情况下它以高精度计算，也可能有用）

或者编译它

```
Entity expr = "1 + 2 + sqrt(2) + x + y";
Func<double, double, double> someFunc = expr.Compile<double, double, double>("x", "y");
Console.WriteLine(someFunc(3, 5)); 
```

这样它就可以在时间关键的代码中使用。

### 毛巾

在这里你可以做

```
using Towel.Mathematics;
var expression = Symbolics.Parse<double>("(2 + 2 * 2 - (2 ^ 4)) / 2");
Console.WriteLine(expression.Simplify()); 
```

这将直接将您的表达式计算为`double`.

### 安装

两者都可以通过 Nuget 安装：[AngouriMath](https://www.nuget.org/packages/AngouriMath)、[Towel](https://www.nuget.org/packages/Towel)。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-08-27T22:31:24.783

在 github 上试试我的 matheval 库

回购：[https ://github.com/matheval/expression-evaluator-c-sharp](https://github.com/matheval/expression-evaluator-c-sharp)

nuget：[https ://www.nuget.org/packages/org.matheval/](https://www.nuget.org/packages/org.matheval/)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-07-18T09:57:46.210

Flee Fast 轻量级表达式评估器

[https://flee.codeplex.com](https://flee.codeplex.com)

语言参考

*   算术运算符示例：a*2 + b ^ 2 - 100 % 5
*   比较运算符示例：a <> 100
*   AndOrXorNotOperators 示例（逻辑）：a > 100 And Not b = 100
*   ShiftOperators 示例：100 >> 2
*   连接示例：“abc”+“def”
*   索引示例：arr[i + 1] + 100
*   字面量
*   铸造示例：100 + cast(obj, int)
*   条件运算符示例：If(a > 100 and b > 10, "both greater", "less")
*   InOperator 示例（列表）：If(100 in (100, 200, 300, -1), "in", "not in")
*   类型上的重载运算符

例子 ：

```
Imports Ciloci.Flee
Imports Ciloci.Flee.CalcEngine
Imports System.Math 
```

* * *

```
 Dim ec As New Ciloci.Flee.ExpressionContext
    Dim ex As IDynamicExpression
    ec.Imports.AddType(GetType(Math))

    ec.Variables("a") = 10            
    ec.Variables("b") = 40               
    ex = ec.CompileDynamic("a+b")

    Dim evalData    
    evalData = ex.Evaluate()
    Console.WriteLine(evalData) 
```

输出：50

# debugging - 如何调试未正确显示 unicode（中文）的 vb6 Richtextbox

> ID：355073
> 
> 赞同：0
> 
> 时间：2008-12-10T04:23:35.163
> 
> 标签：debugging, unicode, vb6, richtextbox

我有一个简单的 vb6 编辑器类型应用程序，它有一个富文本框作为编辑器页面。它允许用户键入内容并将其存储到一个文件中，该文件将 RTF 中的所有文本存储为 xml 中的 CDATA。

当您加载回文件时，它将从 xml 中读取并加载回 rtf。我们允许 unicode 编辑，但我的问题是我有一个使用 Windows XP 的用户，他们在阅读中文字符时遇到了一些问题。他们在他们的电脑中显示为胡言乱语。

它在我的和同事的都显示得很好。我已经检查过他们的系统中是否有正确的区域语言和设置。已经检查了东亚语言的安装文件。他们可以在网站上看到中文单词，甚至可以将它们打出来。

我觉得我在这里遗漏了一些东西，但我不知道接下来要检查什么？关于下一步我可以测试或检查什么的任何想法？

我的描述能力很差，如果有什么不清楚的地方问我。谢谢。〜史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T04:35:13.767

可能是字体的问题？

尝试使用支持 unicode 字符（Arial Unicode）的字体。或者尝试去一个带有中文字符的网站并将其粘贴到richtextbox中，将其保存到文件中并尝试从文件中加载它。

那样有用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T05:20:56.560

这很奇怪。尝试确认您的用户具有相同版本的 RICHTXT32.OCX 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T05:28:06.750

好吧，他们应该是因为我将应用程序打包在 vs 安装程序安装包中。对于字体，它是 sim sun，我已经与用户确认他们在 window/fonts 下确实有 sim sun 字体。

顺便说一句，我已经更新数据实际上存储在 CDATA 下的 xml 中，尽管 rtf 块保持原样。

好的，这似乎是解决方案，虽然我不知道为什么。在我的 msi 安装文件中，我包含了riched.dll，所以当我安装它时，dll 会起作用并在富文本控件中搞砸我的汉字。

但是当我重新打包以排除该 dll 文件并使用该设置重新安装时，它现在似乎可以工作了......

# asp.net-mvc - ASP.NET MVC - 如何解释它？

> ID：355082
> 
> 赞同：8
> 
> 时间：2008-12-10T04:30:21.547
> 
> 标签：asp.net-mvc

我正在尝试向过去 8 周一直在学习 ASP.NET 的学生（本科生）教授 ASP.NET MVC（我知道这听起来时间不多，但是每天上课 4 小时，每人 5 天）一周的实验室、测验、考试和摔跤）。

我还没有得到这个问题……但我知道它来了……

> 我什么时候会使用 MVC 而不是 ASP？

我对 ASP MVC 没有任何实际经验，也无法在网上找到任何明确的答案。诸如“...web 是无状态的，ASP MVC 是更接近的匹配等”之类的论点对他们来说意义不大。他们开始注意到 ASP 有很多控件，与 MVC 相比，这些控件似乎简化了他们的标记。

我试图给出一个诚实的旋转，任何反馈将不胜感激！TIA

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-10T05:45:37.400

正如成员们已经强调的那样，无国籍是一个很好的解释。除此之外，还向学生提出以下问题？

如果他们必须使用 ASP.NET（没有 MVC）来执行以下操作，那会有多容易？

1.  测试你的观点
2.  模拟 Http 对象。
3.  视图状态减少（按设计）（
4.  用.aspx 替换轻量级视图引擎。
5.  彻底分离关注点。
6.  干净的 HTML
7.  等等等等

现在在上面的上下文中解释 asp.net mvc。可能还有更多。至少我认为他们会明白这一点，认为这可能不适用于所有项目，但如果我们只是从中受益，那有什么害处。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-10T04:39:20.327

对我来说，MVC 方法与 ASP Forms API 是一个非常不同的范例。我认为“无国籍”的想法实际上是用一个词来解释一个非常广泛的话题的好方法。

我看到的主要优点之一是 MVC 框架对页面的设计和输出提供了很多控制。对于小型项目，这可能不是最好的使用方式，但对于大型项目，它可以很好地扩展，因为您可以做出（个人）我认为更好的不同架构选择，例如 MVC 框架分离逻辑的方式从视图。

此外，如果您正在设计一个包含大量 Javascript 的网站，那么您在 MVC 框架中获得的对输出的控制会非常有用，因为您不必太担心如何呈现 ID 和其他标记，就像您通常在 ASP 表单框架中所做的那样。

MVC 框架确实是一种完全不同的网站设计方式。就个人而言，我认为它对大型项目更有利，但我也是从 Web 语言开始的，MVC 是一种更流行的设计选择。

那只是我的2美分。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-10T06:29:29.137

我一直认为 ASP.NET MVC 框架是一个坏名字，因为它是一种设计模式。

问题应该是：

**我什么时候可以在 ASP.NET Web 表单上使用 ASP.NET MVC 框架？**

*开发者体验*

a) ASP.NET Web 窗体试图从开发人员那里抽象出 HTTP 的无状态特性。GUI 元素的状态和/或数据存储在 Viewstate/Session 中。每个人 Form 都会对自己进行回发，基本上是模仿 WinForm 事件驱动设计的行为。

b) HTML GUI 元素由可重复使用的控件进一步抽象，从 3rd 方供应商处购买。这有助于开发人员在没有太多 JavaScript 和 HTML/HTTP 知识的情况下将 HTML 应用程序粘合在一起。基本上类似于您开发 VB / WinForms 的方式

c) 您可以很好地在 ASP.NET 网络表单中实现 MVC/MVP 模式。查看 Patterns and Practices Web Client 软件工厂，了解他们是如何做到的。

d) 使用 WebForms 进行开发，您通常会根据服务器上的用户反馈更改 HTML（视图）。大多数事件（用户单击按钮、编辑字段）在服务器上以连续回发循环的方式处理，执行所谓的 ASP.NET 页面生命周期。

VS

浏览器控制的视图（不知道还能叫什么）。基于用户输入对 HTML 的所有更改都在浏览器中处理。您将使用 Javascript 操作 DOM。

注意：我基于这样一个事实，即 ASP.NET MVC 很可能是由基本的 HTML + Ajax 驱动的

**我个人将如何在它们之间进行选择（从未使用过 MVC，只是阅读它）**

1) 如果我要使用 Ajax、Jquery、EXT JS 类型库构建一个纯无状态前端，ASP.NET MVC 似乎更合适。尽管您可以在 ASP.NET Webforms 中构建它，但它似乎毫无意义，因为您没有利用回发模型和服务器控件。

2) 如果我被要求构建一个新的基本 Web 应用程序，我会坚持使用 ASP.NET Webforms，因为我已经熟悉它并且知道整个页面的生命周期。

3) 如果我被要求构建一个 Web 2.0（讨厌这个词）以获得下一代用户体验，我可能会选择 ASP.NET MVC，并使用 JQuery / ASP.NET Ajax 客户端控件。

4) 许多公司已经建立了一套可靠的 WebForm 控件来使用。以纯粹的无状态ajaxy方式重建它们会很昂贵:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T05:06:13.597

对于在 Winforms 方面有经验（和痛苦）的人来说，最大的区别是不再有 Viewstate。表单上的控件状态保存在客户端、浏览器中，并针对每个请求发送到服务器。

如果您使用 Javascript，在浏览器端进行更改会更容易，而服务器端可以轻松地查看整个表单，而无需重新创建控件绑定。

除了 MVC 提供的所有优点——视图/代码分离、可测试性——这对我来说是转向 MVC 的关键。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T06:59:31.557

除了已经列出的所有其他优秀回应。Webforms 是对 HTML 的**抽象**。

当您想要一个 html 数据表时，您可以在页面上放置一个“gridview”控件——最终得到的是“gridview”html，而且很可能不*完全*是您所追求的。

鞋子适合 90% 的时间，但很多时候，尤其是当事情超出了控件不适合的基本站点时。使用 Webforms 通常意味着您无法完全控制呈现给浏览器的最终输出。

您当然可以扩展或编写自己的网格控件。但是你不是更喜欢写你想要的html吗？

根据我的经验，项目变得越来越复杂，而 UI 变得越来越复杂，以至于您最终会越来越频繁地与 Web 表单作斗争。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T07:17:19.290

[http://www.emadibrahim.com/2008/09/07/deciding-between-aspnet-mvc-and-webforms/](http://www.emadibrahim.com/2008/09/07/deciding-between-aspnet-mvc-and-webforms/)

# c# - 使用 Javascript 添加控件并从代码隐藏中获取它们的值

> ID：355083
> 
> 赞同：1
> 
> 时间：2008-12-10T04:30:33.993
> 
> 标签：c#, asp.net, javascript, controls

我想通过使用 javascript 添加服务器控件。我想要的主要目的是在没有任何回发的情况下添加控件并将它们放在代码隐藏中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T04:52:28.833

您可以检查服务器上所有表单值（客户端控件）的 Request.Form 集合。每个控件都需要有一个唯一的 ID 才能在 request.Form 集合中访问它。

例如，如果您有以下控件

```
<input type="text" id="testBox" value="blah" /> 
```

在服务器上，您将以 Request.Form["testBox"] 的形式访问该值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T04:52:26.073

尝试使用[Request.Form访问 html 输入](http://msdn.microsoft.com/en-us/library/ms525985.aspx)

```
Request.Form["inputName"] 
```

您必须`name`像这样在输入上设置属性：

```
<input type="text" value="blah" name="inputName" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T06:58:05.303

如果它是一个表单帖子，您可以使用 request.form["control"] 获取值，其中一个属性将帮助您执行此操作，如果它是某个页面中的新控件，您可以使用 ajax 执行某些操作，我没有尝试过，它只是一个理论，

您可以发出 ajax 请求，该请求将在服务器中创建一个文本框控件，然后将 html 呈现到您的页面。

现在，当您调用 text1.text 时，您将获得值 ..

但这对我来说有点骇人听闻..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T04:34:04.033

这通常是不可能的。*您必须在服务器上*添加服务器端控件。

如果您想避免回发的*可见性*，请使用 AJAX 和 UpdatePanel。否则你就不走运了。

# wpf - WPF Xaml 自定义样式列表框中的选定项样式

> ID：355084
> 
> 赞同：8
> 
> 时间：2008-12-10T04:30:46.803
> 
> 标签：wpf, listbox, styles, selecteditem

我有一个`ListBox`水平滚动图像。

我有以下 XAML，我使用 blend 来创建它。它最初有 ax:Key`Style TaregetType`在线，MSDN 说要删除它，因为我遇到了错误。现在我收到此错误：

`Error 3 Operation is not valid while ItemsSource is in use. Access and modify elements with ItemsControl.ItemsSource instead.`

我不明白如何以这种方式应用所有这些垃圾，我已经尝试了几件事，但没有任何效果。

我的目标是让所选项目的背景为白色，而不是蓝色。对于这么小的东西，似乎需要做很多工作！

谢谢。

```
 <ListBox ItemsSource="{Binding Source={StaticResource WPFApparelCollection}}"
        Grid.Row="1" Margin="2,26,2,104" ScrollViewer.VerticalScrollBarVisibility="Hidden"
             ScrollViewer.HorizontalScrollBarVisibility="Hidden" SelectionMode="Single" 
        x:Name="list1" MouseLeave="List1_MouseLeave" MouseMove="List1_MouseMove" Style="{DynamicResource ListBoxStyle1}"  >
        <Style TargetType="{x:Type ListBoxItem}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="Padding" Value="2,0,0,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                        <Border x:Name="Bd" SnapsToDevicePixels="true" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="true">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
                                <Setter Property="Background" TargetName="Bd" Value="#FFFFFFFF"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected" Value="true"/>
                                    <Condition Property="Selector.IsSelectionActive" Value="false"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                            </MultiTrigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <VirtualizingStackPanel 
           Orientation="Horizontal" 
           IsItemsHost="True" />
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
        <ListBox.ItemTemplate>
            <DataTemplate>
                <Image Source="{Binding Image}" />
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-11T00:31:52.540

使用 ItemContainerStyle 包装样式标签，如下所示：

```
<ListBox ItemsSource="{Binding Source={StaticResource WPFApparelCollection}}"
         Grid.Row="1" Margin="2,26,2,104"
         ScrollViewer.VerticalScrollBarVisibility="Hidden"
         ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
         SelectionMode="Single"
         x:Name="list1" MouseLeave="List1_MouseLeave" MouseMove="List1_MouseMove" 
         Style="{DynamicResource ListBoxStyle1}"  >

        <ListBox.ItemContainerStyle>
            <Style TargetType="{x:Type ListBoxItem}">
                <Setter Property="Background" Value="Transparent"/>
            </Style>
<!-- the rest of your code,  but close the ItemContainerStyle -->
        </ListBox.ItemContainerStyle> 
    </ListBox> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-17T11:48:59.920

我尝试了上述解决方案，但没有按预期工作，所以我找到了另一种解决问题的方法，即禁用列表框的选择

这就是我所做的

```
<ListBox.ItemContainerStyle>
    <Style TargetType="{x:Type ListBoxItem}">
         <Setter Property="Focusable" Value="False"/>
     </Style>
</ListBox.ItemContainerStyle> 
```

# floating-point - 我应该如何对 80 位 IEEE 浮点进行相等性测试？

> ID：355087
> 
> 赞同：2
> 
> 时间：2008-12-10T04:33:52.163
> 
> 标签：floating-point, d, bit-manipulation

相关：

*   [比较 ieee 浮点数和双精度数是否相等](https://stackoverflow.com/questions/21265/)
*   [我们是否应该将浮点数的相等性与*相对*误差进行比较](https://stackoverflow.com/questions/328475/)
*   [浮动和双重比较的最有效方法](https://stackoverflow.com/questions/17333/#17467)

但是关于x86 上的[80 位 IEEE 浮点数](http://download.intel.com/design/processor/manuals/253665.pdf)（参见第 8.2 节）

特别是我喜欢使用操作数之间的可表示值计数的[这种实现](https://stackoverflow.com/questions/21265/comparing-ieee-floats-and-doubles-for-equality#21277)，因为它默认缩放。

一个用例是数值近似，其中两个值彼此接近，我需要检查它们是否足够接近。

* * *

ps 实现语言是D，但我可以翻译。此外，可以自动处理任何底层类型的实现（例如，如果只有 64 位实数可用）将是理想的。

[当前使用的代码：](http://www.dsource.org/projects/scrapple/browser/trunk/units/unit.d#L141)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T06:04:13.930

由于 D 内置了 80 位实数（据我所知），您为什么不只使用与 epsilon 值进行比较的标准方法。如果您事先知道粗略的范围，这可以是一个固定值，例如美元：

```
if (abs (a - b) < 1e-6) // effectively equal 
```

或可接受的相对误差，例如平均值的百万分之一：

```
if (abs (a - b) < ((a + b) / 2) / 1e6) // effectively equal 
```

请记住，我不知道 D，上面的代码仅用于演示目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T06:03:58.143

我目前的解决方案是

```
bool Near(real a, real b, int count = 5)
{
    // Returns the number of mantissa bits which are equal in x and y.
    int i = std.math.feqrel!(real)(a,b);
    return i + count >= real.mant_dig;
} 
```

它给出了输入中不匹配的位数。我不确定这在 2 的幂附近效果如何。

# java - StringBuilder 和 StringBuffer 的区别

> ID：355089
> 
> 赞同：1681
> 
> 时间：2008-12-10T04:34:26.263
> 
> 标签：java, stringbuilder, stringbuffer

`StringBuffer`和之间的主要区别是什么`StringBuilder`？在决定其中任何一项时是否存在任何性能问题？

* * *

## 回答 #1

> 赞同：1747
> 
> 时间：2008-12-10T04:36:23.110

[`StringBuffer`](http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuffer.html)是同步的，[`StringBuilder`](http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html)不是。

* * *

## 回答 #2

> 赞同：750
> 
> 时间：2010-05-05T09:15:08.860

[`StringBuilder`](http://docs.oracle.com/javase/9/docs/api/java/lang/StringBuilder.html)比[`StringBuffer`](https://docs.oracle.com/javase/9/docs/api/java/lang/StringBuffer.html)因为它不是更快`synchronized`。

这是一个简单的基准测试：

```
public class Main {
    public static void main(String[] args) {
        int N = 77777777;
        long t;

        {
            StringBuffer sb = new StringBuffer();
            t = System.currentTimeMillis();
            for (int i = N; i --> 0 ;) {
                sb.append("");
            }
            System.out.println(System.currentTimeMillis() - t);
        }

        {
            StringBuilder sb = new StringBuilder();
            t = System.currentTimeMillis();
            for (int i = N; i > 0 ; i--) {
                sb.append("");
            }
            System.out.println(System.currentTimeMillis() - t);
        }
    }
} 
```

[测试运行](http://ideone.com/OpUDPU)给出了`2241 ms`for`StringBuffer`与`753 ms`for的数量`StringBuilder`。

* * *

## 回答 #3

> 赞同：257
> 
> 时间：2008-12-10T04:37:05.527

基本上，`StringBuffer`方法是同步的，而`StringBuilder`不是同步的。

操作“几乎”相同，但在单个线程中使用同步方法是多余的。

差不多就是这样。

[来自StringBuilder API](http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html)的引用：

> 此类 [StringBuilder] 提供了与 StringBuffer 兼容的 API，**但不保证同步**。此类设计用于在单个线程正在使用字符串缓冲区的地方（通常情况下）用作 StringBuffer 的替代品。在可能的情况下，建议优先使用此类而不是 StringBuffer，因为**它在大多数实现下会更快。**

于是就用它来代替它。

`Vector`和 也是如此`ArrayList`。

* * *

## 回答 #4

> 赞同：187
> 
> 时间：2011-01-25T12:30:54.637

> 但是需要借助示例来获得明显的区别吗？
> 
> StringBuffer 或 StringBuilder

***`StringBuilder`除非您真的想在线程之间共享缓冲区，否则只需使用。是原始同步类`StringBuilder`的非同步（更少开销=更高效）的弟弟。`StringBuffer`***

`StringBuffer`先来。Sun 关心所有条件下的正确性，因此他们将其同步以使其成为线程安全的，以防万一。

`StringBuilder`后来来了。大多数使用`StringBuffer`都是单线程的，并且不必要地支付了同步的成本。

由于`StringBuilder`是不同步***的直接替代品***，`StringBuffer`因此任何示例之间都不会存在差异。

如果您*尝试*在线程之间共享，您可以使用`StringBuffer`，但请考虑是否需要更高级别的同步，例如，如果您同步使用 StringBuilder 的方法，可能而不是使用 StringBuffer。

* * *

## 回答 #5

> 赞同：84
> 
> 时间：2013-12-11T07:11:07.613

首先让我们看看**相似之处**： StringBuilder 和 StringBuffer 都是可变的。这意味着您可以在同一位置更改它们的内容。

**区别**：StringBuffer 也是可变的和同步的。其中 StringBuilder 是可变的，但默认情况下不同步。

**同步（synchronization）的含义**：当一些东西被同步时，那么多个线程可以访问，并且修改它，没有任何问题或副作用。StringBuffer 是同步的，因此您可以将它与多个线程一起使用而不会出现任何问题。

**什么时候用哪一个？** StringBuilder ：当你需要一个可以修改的字符串时，只有一个线程在访问和修改它。StringBuffer ：当您需要一个可以修改的字符串时，并且多个线程正在访问和修改它。

**注意**：不要不必要地使用StringBuffer，也就是说，如果只有一个线程正在修改和访问它，就不要使用它，因为它有很多用于同步的锁定和解锁代码，这将不必要地占用CPU时间。除非需要，否则不要使用锁。

* * *

## 回答 #6

> 赞同：58
> 
> 时间：2012-11-15T16:20:46.073

由于 JVM 优化，在单线程中，**StringBuffer 并不比 StringBuilder 慢很多。**在多线程中，您不能安全地使用 StringBuilder。

这是我的测试（不是基准，只是测试）：

```
public static void main(String[] args) {

    String withString ="";
    long t0 = System.currentTimeMillis();
    for (int i = 0 ; i < 100000; i++){
        withString+="some string";
    }
    System.out.println("strings:" + (System.currentTimeMillis() - t0));

    t0 = System.currentTimeMillis();
    StringBuffer buf = new StringBuffer();
    for (int i = 0 ; i < 100000; i++){
        buf.append("some string");
    }
    System.out.println("Buffers : "+(System.currentTimeMillis() - t0));

    t0 = System.currentTimeMillis();
    StringBuilder building = new StringBuilder();
    for (int i = 0 ; i < 100000; i++){
        building.append("some string");
    }
    System.out.println("Builder : "+(System.currentTimeMillis() - t0));
} 
```

结果：
字符串：319740
缓冲区：**23**
生成器：7！

所以构建器比缓冲区快，而且比字符串连接快得多。现在让我们为多个线程使用**Executor ：**

```
public class StringsPerf {

    public static void main(String[] args) {

        ThreadPoolExecutor executorService = (ThreadPoolExecutor) Executors.newFixedThreadPool(10);
        //With Buffer
        StringBuffer buffer = new StringBuffer();
        for (int i = 0 ; i < 10; i++){
            executorService.execute(new AppendableRunnable(buffer));
        }
        shutdownAndAwaitTermination(executorService);
        System.out.println(" Thread Buffer : "+ AppendableRunnable.time);

        //With Builder
        AppendableRunnable.time = 0;
        executorService = (ThreadPoolExecutor) Executors.newFixedThreadPool(10);
        StringBuilder builder = new StringBuilder();
        for (int i = 0 ; i < 10; i++){
            executorService.execute(new AppendableRunnable(builder));
        }
        shutdownAndAwaitTermination(executorService);
        System.out.println(" Thread Builder: "+ AppendableRunnable.time);

    }

   static void shutdownAndAwaitTermination(ExecutorService pool) {
        pool.shutdown(); // code reduced from Official Javadoc for Executors
        try {
            if (!pool.awaitTermination(60, TimeUnit.SECONDS)) {
                pool.shutdownNow();
                if (!pool.awaitTermination(60, TimeUnit.SECONDS))
                    System.err.println("Pool did not terminate");
            }
        } catch (Exception e) {}
    }
}

class AppendableRunnable<T extends Appendable> implements Runnable {

    static long time = 0;
    T appendable;
    public AppendableRunnable(T appendable){
        this.appendable = appendable;
    }

    @Override
    public void run(){
        long t0 = System.currentTimeMillis();
        for (int j = 0 ; j < 10000 ; j++){
            try {
                appendable.append("some string");
            } catch (IOException e) {}
        }
        time+=(System.currentTimeMillis() - t0);
    }
} 
```

现在 StringBuffers 需要**157 毫秒**来处理 100000 次追加。这不是同一个测试，但与之前的 37 毫秒相比，您可以放心地假设**StringBuffers 的追加速度在使用多线程时会变慢**。原因是 JIT/hotspot/compiler/something 在检测到不需要检查锁时会进行*优化*。

但是**对于 StringBuilder，你有 java.lang.ArrayIndexOutOfBoundsException**，因为并发线程试图在不应该添加的地方添加一些东西。

结论是您不必追逐 StringBuffers。在你有线程的地方，想想它们在做什么，然后再尝试获得几纳秒。

* * *

## 回答 #7

> 赞同：42
> 
> 时间：2008-12-10T04:38:27.240

StringBuilder 是在 Java 1.5 中引入的，因此它不适用于早期的 JVM。

从[Javadocs](http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html)：

> StringBuilder 类提供了与 StringBuffer 兼容的 API，但不保证同步。此类设计用于在单个线程正在使用字符串缓冲区的地方（通常情况下）用作 StringBuffer 的替代品。在可能的情况下，建议优先使用此类而不是 StringBuffer，因为它在大多数实现下会更快。

* * *

## 回答 #8

> 赞同：37
> 
> 时间：2014-04-11T20:25:07.433

> 很好的问题

这是我注意到的差异：

字符串缓冲区：-

```
StringBuffer is  synchronized
StringBuffer is  thread-safe
StringBuffer is  slow (try to write a sample program and execute it, it will take more time than StringBuilder) 
```

字符串生成器：-

```
 StringBuilder is not synchronized 
 StringBuilder is not thread-safe
 StringBuilder performance is better than StringBuffer. 
```

共同点：-

> 两者都有相同的方法和相同的签名。两者都是可变的。

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2008-12-10T05:00:56.773

`StringBuffer`

*   同步，因此是线程安全的
*   线程安全，因此速度慢

`StringBuilder`

*   在 Java 5.0 中引入
*   异步因此快速高效
*   如果需要，用户明确需要同步它
*   您可以将其替换为`StringBuffer`无需任何其他更改

* * *

## 回答 #10

> 赞同：24
> 
> 时间：2016-09-20T17:40:58.290

**字符串缓冲区**

StringBuffer 是可变的，意味着可以改变对象的值。通过 StringBuffer 创建的对象存储在堆中。StringBuffer 具有与 StringBuilder 相同的方法，但 StringBuffer 中的每个方法都是同步的，即 StringBuffer 是线程安全的。

正因为如此，它不允许两个线程同时访问同一个方法。每个方法一次只能由一个线程访问。

但是线程安全也有缺点，因为由于线程安全属性，StringBuffer 的性能会受到影响。因此在调用每个类的相同方法时，StringBuilder 比 StringBuffer 更快。

StringBuffer 的值可以改变，这意味着它可以被赋予新的值。现在它是一个最常见的面试问题，上述课程之间的差异。可以使用 toString() 方法将 String Buffer 转换为字符串。

```
StringBuffer demo1 = new StringBuffer(“Hello”) ;
// The above object stored in heap and its value can be changed .

demo1=new StringBuffer(“Bye”);
// Above statement is right as it modifies the value which is allowed in the StringBuffer 
```

**字符串生成器**

StringBuilder 和 StringBuffer 一样，就是将对象存储在堆中，也可以修改。StringBuffer 和 StringBuilder 的主要区别在于 StringBuilder 也不是线程安全的。StringBuilder 速度很快，因为它不是线程安全的。

```
StringBuilder demo2= new StringBuilder(“Hello”);
// The above object too is stored in the heap and its value can be modified

demo2=new StringBuilder(“Bye”);
// Above statement is right as it modifies the value which is allowed in the StringBuilder 
```

[![在此处输入图像描述](https://i.stack.imgur.com/aydt9.jpg)](https://i.stack.imgur.com/aydt9.jpg)

资源：[String Vs StringBuffer Vs StringBuilder](https://itblackbelt.wordpress.com/2015/01/31/difference-between-string-stringbuilder-and-stringbuffer-classes-with-example-java/)

* * *

## 回答 #11

> 赞同：23
> 
> 时间：2008-12-10T04:41:07.547

StringBuilder 不是线程安全的。字符串缓冲区是。更多信息[在这里](http://www.java-tips.org/java-se-tips/java.lang/difference-between-string-stringbuffer-and-stringbu.html)。

编辑：至于性能，[热点](http://en.wikipedia.org/wiki/HotSpot)启动后，StringBuilder 是赢家。但是，对于小迭代，性能差异可以忽略不计。

* * *

## 回答 #12

> 赞同：21
> 
> 时间：2010-12-03T06:38:49.870

`StringBuilder`并且`StringBuffer`几乎相同。不同之`StringBuffer`处在于是同步的而`StringBuilder`不是同步的。虽然，`StringBuilder`比 快`StringBuffer`，但性能差异很小。`StringBuilder`是 SUN 的替代品`StringBuffer`。它只是避免了所有公共方法的同步。相反，它们的功能是相同的。

良好用法示例：

如果您的文本要更改并被多个线程使用，那么最好使用`StringBuffer`. 如果您的文本要更改但由单个线程使用，则使用`StringBuilder`.

* * *

## 回答 #13

> 赞同：18
> 
> 时间：2013-03-18T08:12:55.977

`String`是不可变的。

`StringBuffer`是可变的和同步的。

`StringBuilder`也是可变的，但它不同步。

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2011-01-25T12:21:51.247

[javadoc](http://download.oracle.com/javase/6/docs/api/java/lang/StringBuilder.html)解释了差异：

> 此类提供与 StringBuffer 兼容的 API，但不保证同步。此类设计用于在单个线程正在使用字符串缓冲区的地方（通常情况下）用作 StringBuffer 的替代品。在可能的情况下，建议优先使用此类而不是 StringBuffer，因为它在大多数实现下会更快。

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2020-07-03T06:41:27.127

[StringBuffer 和 StringBuilder源码](https://www.javatpoint.com/difference-between-stringbuffer-and-stringbuilder#:%7E:text=The%20String%20class%20is%20an,differences%20between%20StringBuffer%20and%20StringBuilder.&text=StringBuffer%20is%20synchronized%20i.e.%20thread,the%20methods%20of%20StringBuffer%20simultaneously.)的区别：

[![在此处输入图像描述](https://i.stack.imgur.com/ogDCo.png)](https://i.stack.imgur.com/ogDCo.png)

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2011-01-25T12:23:47.527

`StringBuilder`（在 Java 5 中引入）与 相同`StringBuffer`，只是它的方法不同步。这意味着它比后者具有更好的性能，但缺点是它不是线程安全的。

阅读[教程](https://web.archive.org/web/20130217083932/http://www.leepoint.net/notes-java/data/strings/23stringbufferetc.html)了解更多详情。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2014-03-14T18:40:42.357

一个简单的程序说明了 StringBuffer 和 StringBuilder 之间的区别：

```
/**
 * Run this program a couple of times. We see that the StringBuilder does not
 * give us reliable results because its methods are not thread-safe as compared
 * to StringBuffer.
 * 
 * For example, the single append in StringBuffer is thread-safe, i.e.
 * only one thread can call append() at any time and would finish writing
 * back to memory one at a time. In contrast, the append() in the StringBuilder 
 * class can be called concurrently by many threads, so the final size of the 
 * StringBuilder is sometimes less than expected.
 * 
 */
public class StringBufferVSStringBuilder {

    public static void main(String[] args) throws InterruptedException {

        int n = 10; 

        //*************************String Builder Test*******************************//
        StringBuilder sb = new StringBuilder();
        StringBuilderTest[] builderThreads = new StringBuilderTest[n];
        for (int i = 0; i < n; i++) {
            builderThreads[i] = new StringBuilderTest(sb);
        }
        for (int i = 0; i < n; i++) {
            builderThreads[i].start();
        }
        for (int i = 0; i < n; i++) {
            builderThreads[i].join();
        }
        System.out.println("StringBuilderTest: Expected result is 1000; got " + sb.length());

        //*************************String Buffer Test*******************************//

        StringBuffer sb2 = new StringBuffer();
        StringBufferTest[] bufferThreads = new StringBufferTest[n];
        for (int i = 0; i < n; i++) {
            bufferThreads[i] = new StringBufferTest(sb2);
        }
        for (int i = 0; i < n; i++) {
            bufferThreads[i].start();
        }
        for (int i = 0; i < n; i++) {
            bufferThreads[i].join();
        }
        System.out.println("StringBufferTest: Expected result is 1000; got " + sb2.length());

    }

}

// Every run would attempt to append 100 "A"s to the StringBuilder.
class StringBuilderTest extends Thread {

    StringBuilder sb;

    public StringBuilderTest (StringBuilder sb) {
        this.sb = sb;
    }

    @Override
    public void run() {
        for (int i = 0; i < 100; i++) {
            sb.append("A");
        }

    }
}

//Every run would attempt to append 100 "A"s to the StringBuffer.
class StringBufferTest extends Thread {

    StringBuffer sb2;

    public StringBufferTest (StringBuffer sb2) {
        this.sb2 = sb2;
    }

    @Override
    public void run() {
        for (int i = 0; i < 100; i++) {
            sb2.append("A");
        }

    }
} 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2009-04-23T13:44:45.263

StringBuffer 用于存储将要更改的字符串（String 对象不能更改）。它会根据需要自动扩展。相关类：String、CharSequence。

StringBuilder 是在 Java 5 中添加的。它在所有方面都与 StringBuffer 相同，只是它不是同步的，这意味着如果多个线程同时访问它，可能会出现问题。对于单线程程序，最常见的情况是，避免同步开销会使 StringBuilder 稍微快一些。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2009-12-23T08:42:53.077

`StringBuffer`是同步的，但`StringBuilder`不是。结果，`StringBuilder`比 快`StringBuffer`。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2010-11-17T11:33:16.023

A`String`是一个不可变对象，这意味着**值不能更改**，而`StringBuffer`它是可变的。

它`StringBuffer`是同步的，因此是线程安全的，而`StringBuilder`不是并且仅适用于单线程实例。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2011-01-25T12:21:09.947

更好地使用`StringBuilder`，因为它不**同步**并因此提供更好的性能。`StringBuilder`是**旧**的`StringBuffer`.

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2014-09-05T10:02:43.060

**StringBuffer** 是可变的。它可以在长度和内容方面发生变化。StringBuffers 是线程安全的，这意味着它们具有控制访问的同步方法，因此一次只有一个线程可以访问 StringBuffer 对象的同步代码。因此，StringBuffer 对象通常可以安全地用于多线程环境中，其中多个线程可能试图同时访问同一个 StringBuffer 对象。

**StringBuilder** StringBuilder 类与 StringBuffer 非常相似，只是它的访问不是同步的，因此它不是线程安全的。通过不同步，StringBuilder 的性能可以优于 StringBuffer。因此，如果您在单线程环境中工作，使用 StringBuilder 而不是 StringBuffer 可能会提高性能。这也适用于其他情况，例如只有一个线程将访问 StringBuilder 对象的 StringBuilder 局部变量（即方法中的变量）。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2015-09-27T20:34:41.247

**字符串缓冲区：**

*   多线程
*   同步的
*   比 StringBuilder 慢

**字符串生成器**

*   单线程
*   不同步
*   比以往更快字符串

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2017-02-01T08:44:23.943

**字符串生成器**：

```
int one = 1;
String color = "red";
StringBuilder sb = new StringBuilder();
sb.append("One=").append(one).append(", Color=").append(color).append('\n');
System.out.print(sb);
// Prints "One=1, Colour=red" followed by an ASCII newline. 
```

**字符串缓冲区**

```
StringBuffer sBuffer = new StringBuffer("test");
sBuffer.append(" String Buffer");
System.out.println(sBuffer); 
```

建议尽可能使用 StringBuilder，因为它比 StringBuffer 快。但是，如果需要线程安全，最好的选择是 StringBuffer 对象。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2013-07-25T06:39:34.790

由于`StringBuffer`是同步的，它需要一些额外的努力，因此基于性能，它比`StringBuilder`.

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2016-05-10T07:57:53.503

`StringBuilder`和之间没有基本区别`StringBuffer`，它们之间只有一些区别。在`StringBuffer`方法中是同步的。这意味着一次只有一个线程可以对它们进行操作。如果有多个线程，则第二个线程必须等待第一个线程完成，第三个线程必须等待第一个和第二个线程完成，依此类推。这使得该过程非常缓慢，因此在这种情况下的性能`StringBuffer`很低。

另一方面，`StringBuilder`不同步。这意味着一次多个线程可以同时对同一个`StringBuilder`对象进行操作。这使得该过程非常快，因此性能`StringBuilder`很高。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2013-11-15T18:05:28.110

主要区别是`StringBuffer`同步而不是同步。`StringBuilder`如果你需要使用多个线程，那么建议使用StringBuffer。但是，执行速度`StringBuilder`比 快`StringBuffer`，因为它没有同步。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2016-06-09T07:16:23.410

检查 的同步追加方法`StringBuffer`和非同步追加方法的内部结构`StringBuilder`。

[字符串缓冲区](http://grepcode.com/file_/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/StringBuffer.java/?v=source)：

```
public StringBuffer(String str) {
    super(str.length() + 16);
    append(str);
}

public synchronized StringBuffer append(Object obj) {
    super.append(String.valueOf(obj));
    return this;
}

public synchronized StringBuffer append(String str) {
    super.append(str);
    return this;
} 
```

[字符串生成器](http://grepcode.com/file_/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/StringBuilder.java/?v=source)：

```
public StringBuilder(String str) {
    super(str.length() + 16);
    append(str);
}

public StringBuilder append(Object obj) {
    return append(String.valueOf(obj));
}

public StringBuilder append(String str) {
    super.append(str);
    return this;
} 
```

由于 append is `synchronized`，因此与多线程场景`StringBuffer`相比具有性能开销。`StrinbBuilder`只要您不在多个线程之间共享缓冲区，请使用`StringBuilder`，由于没有`synchronized`附加方法，因此速度很快。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2018-08-24T07:59:59.117

这是**String vs StringBuffer vs StringBuilder**的性能测试结果。最后，StringBuilder 赢得了测试。请参阅下面的测试代码和结果。

**代码**：

```
private static void performanceTestStringVsStringbuffereVsStringBuilder() {
// String vs StringBiffer vs StringBuilder performance Test

int loop = 100000;
long start = 0;

// String
String str = null;
start = System.currentTimeMillis();
for (int i = 1; i <= loop; i++) {
  str += i + "test";
}
System.out.println("String - " + (System.currentTimeMillis() - start) + " ms");

// String buffer
StringBuffer sbuffer = new StringBuffer();
start = System.currentTimeMillis();
for (int i = 1; i <= loop; i++) {
  sbuffer.append(i).append("test");
}
System.out.println("String Buffer - " + (System.currentTimeMillis() - start) + " ms");

// String builder
start = System.currentTimeMillis();
StringBuilder sbuilder = new StringBuilder();
for (int i = 1; i <= loop; i++) {
  sbuffer.append(i).append("test");
}
System.out.println("String Builder - " + (System.currentTimeMillis() - start) + " ms");

  } 
```

[在ideone上执行我](https://ideone.com/OpUDPU)

**结果**：

添加单个文本的 100000 次迭代

```
String - 37489 ms
String Buffer - 5 ms
String Builder - 4 ms 
```

添加单个文本的 10000 次迭代

```
String - 389 ms
String Buffer - 1 ms
String Builder - 1 ms 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2018-11-01T17:41:05.103

*   StringBuffer 是线程安全的，但 StringBuilder 不是线程安全的。
*   StringBuilder 比 StringBuffer 快。
*   StringBuffer 是同步的，而 StringBuilder 是不同步的。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2013-07-01T13:52:16.967

StringBuffer 中存在的每个方法都是同步的。因此一次只允许一个线程操作 StringBuffer 对象。它增加了线程的等待时间并产生了性能问题来克服这个问题 SUN People 在 1.5 版本中引入了 StringBuilder。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2019-10-19T09:01:23.750

其他人正确地指出了两者之间的主要区别。然而，在性能方面，我想补充一点 JVM 级别的优化“Lock Elision”，它可以使同步上下文中的性能差异几乎不存在。一个很好的阅读是[here](https://sites.google.com/view/mayjun18/lock-elision-in-the-jvm)和 [here](https://shipilev.net/jvm/anatomy-quarks/19-lock-elision/)

# mysql - MySQL - “优化”功能？

> ID：355098
> 
> 赞同：2
> 
> 时间：2008-12-10T04:40:09.200
> 
> 标签：mysql

我在 phpMyAdmin 中注意到您可以在表格上单击“优化”，它会运行：

```
OPTIMIZE TABLE table_name 
```

这实际上是做什么的？

我是否应该每天运行一些在我的表上运行 OPTIMIZE TABLE 的 cron 作业？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T04:46:31.467

来自[InformIT](http://www.informit.com/articles/article.aspx?p=29406&seqNum=3)

> 优化的表结构不同于设计良好的表。表结构优化与删除后回收未使用的空间以及在进行结构修改后基本上清理表有关。OPTIMIZE SQL 命令使用以下语法处理此问题：

```
OPTIMIZE TABLE table_name[,table_name] 
```

把它想象成对你的表进行碎片整理。cron 作业可能是一个好主意，但是在低负载/无负载期间执行它，因为它会锁定表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T04:47:17.393

我将从[有关该命令的 MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/optimize-table.html)开始。看完之后，你还有疑问吗？

# ms-word - 如何从 USB 设备恢复的数据中提取 Word 文档？

> ID：355099
> 
> 赞同：1
> 
> 时间：2008-12-10T04:40:13.833
> 
> 标签：ms-word, data-recovery

我已经能够将原始数据从无法访问的 USB 驱动器复制到大约 250MB 的整体文件中。在那个字节的某个地方大约有 40 个 Word 文档。

1.  我在哪里可以找到有关 Word 文档内部结构的文档，以便我可以解析字节流、识别 Word 文档的开始和结束位置并提取副本？

2.  是否有任何特定于该任务的任何编程语言的库？

3.  谁能建议一个已经存在的软件解决方案来解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T04:52:28.007

两种方法：

您可以在 linux 中将文件挂载为卷。如果您的二进制 blob 没有太损坏，您可能能够分解文件系统以找出文件所在的位置。它是（曾经）是 FAT 分区还是 NTFS？

如果这不起作用，我会寻找[这个字节串](http://www.garykessler.net/library/file_sigs.html)：

```
D0 CF 11 E0 A1 B1 1A E1 
```

这些是办公文档文件签名的“神奇字节”。它们可能会随机出现在其他数据中，但这是一个开始。如果文件碎片化，您将遇到主要问题。

此外，尝试按原样在 Word 中重新创建文档片段，将其保存到文件中并提取块以在 blob 中搜索（使用 grep 二进制文件或其他）。如果您有来自文件所有部分的信息，您应该能够在它们所在的 blob 中解码 WHERE。将其重新拼凑到一个有效的 DOC 二进制文件中似乎有些牵强，但恢复文本的其余部分应该不是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T04:46:15.867

[Apache POI](http://poi.apache.org/)项目有一个用于读写各种 MS Office 文档的库。如果文件采用新的 XML 基本[OOXML](http://en.wikipedia.org/wiki/OOXML)格式，您将在压缩 XML 时寻找 zip 文件的开头。

# linux - Oracle linux 前端

> ID：355102
> 
> 赞同：2
> 
> 时间：2008-12-10T04:44:12.610
> 
> 标签：linux, oracle, frontend

是否有任何可以在 Linux 中免费或开源使用的 Oracle 数据库（版本 10 左右）前端？

我目前正在使用 Ubuntu 8.10，如果可能的话，我只希望它需要瘦 JDBC 来连接到 oracle，而不是安装在其中的整个（巨大的）oracle 客户端。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T05:11:32.883

我使用类似于 TOAD（不是免费的）的[Oracle SQL Developer 。](http://www.oracle.com/technology/products/database/sql_developer/index.html)SQL Developer 是免费的，并且受 Oracle 支持。确保您获得最新版本，因为他们一直在改进它。它有一个漂亮的图形用户界面并支持编辑 PL/SQL 存储过程。我认为甚至还有其他数据库（如 MySQL）的插件。

它是一个 Java 应用程序，并且有一个 Linux 发行版，尽管我使用的是 Windows 版本。它不需要 Oracle 客户端，但它确实支持一个，例如[Oracle Instant Client](http://www.oracle.com/technology/tech/oci/instantclient/index.html)，如果您安装了它的话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T05:14:58.507

好像[http://tora.sourceforge.net/](http://tora.sourceforge.net/)是 toad 的开源版本

还有[http://oss.oracle.com/sqldeveloper.html](http://oss.oracle.com/sqldeveloper.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T05:51:13.113

几乎任何 JDBC 工具都可以与 Oracle 通信。

我使用过 SQuirrel SQL Client、SQL Workbench、DbVisualizer（免费版）。甚至还有可以与数据库对话的 jEdit 插件。

# asp.net-mvc - ASP.NET MVC 视图 - 我可以使用代码隐藏

> ID：355106
> 
> 赞同：5
> 
> 时间：2008-12-10T04:45:33.870
> 
> 标签：asp.net-mvc, model-view-controller, code-behind

我是 MVC 的新手，我注意到视图页面在所有混合的脚本标签中看起来很讨厌。在视图代码隐藏中的方法中生成 HTML 然后将方法的字符串结果作为单个脚本插入是否有意义？

例如：`<div><%= GenerateTonsOfHTMLFromSomeIEnumerable() %></div>`

这是否与 MVC 哲学相悖？出于其他原因而愚蠢，比如性能？它有什么优点吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-10T05:36:17.233

这是一个实践问题。

这是一个有趣的读物。

1.  [代码隐藏文件是邪恶的](http://stevesmithblog.com/blog/codebehind-files-in-asp-net-mvc-are-evil/)

2.  [代码隐藏文件并不邪恶](http://msmvps.com/blogs/luisabreu/archive/2008/09/19/codebehind-files-in-asp-net-mvc-are-not-evil.aspx)

还有一篇有趣的文章“Rob Conery”

1.  [内联脚本和代码背后](http://blog.wekeroad.com/blog/crazy-talk-inline-scripting-and-code-behind/)

所以，选择权在你。这取决于您的应用程序架构，您希望如何构建它，等等等等……

我想没有代码隐藏的视图的优点是更容易切换到不支持代码隐藏的不同视图引擎。

虽然会有一些工作量，但它仍然是无缝的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T21:26:47.703

好的，为学习曲线写下另一个。我想我可能已经找到了我自己问题的答案......

ASP MVC 允许您安装您自己的自定义视图引擎，您可以使用它们（而不是默认的 ASP.NET 视图引擎）。所以你可以控制html的生成。一旦你知道要搜索什么，它就很容易:)

这是一个开始的好地方：[自定义视图引擎示例](http://www.singingeels.com/Articles/Creating_a_Custom_View_Engine_in_ASPNET_MVC.aspx)

@Rajesh - 感谢伟大的链接！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T17:33:41.683

我不会。你只需要认真地忘记代码隐藏文件。事实上，默认情况下，在 MVC Framework RC1 中，您的视图没有代码隐藏文件。无论您想继续使用什么 c# 处理来呈现您的视图，您都可以在 HTML 中进行内联处理。如果您正在考虑进行一些数据处理，请帮自己一个忙并将其放入控制器中。

这是一种范式转变，最好现在就打破你的旧习惯。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T04:51:51.470

您也可以使用后面的代码。这只是风格偏好的问题。

# java - mssql 相当笨拙地处理换行

> ID：355135
> 
> 赞同：0
> 
> 时间：2008-12-10T05:10:48.797
> 
> 标签：java, python, sql-server, formatting, jython

这是问题所在：

供你参考：

![http://i.stack.imgur.com/mmrNH.jpg](https://i.stack.imgur.com/mmrNH.jpg)

数据库条目 1,2 和 3 是使用 jdbc1.2 使用 jython 2.2.1 创建的。数据库条目 4 是使用 vb 制作的，旧的要使用 odbc 替换的程序。

我们发现，如果我直接从 SQL Server Enterprise Manager 软件将 jython 和 vb MailBody 条目复制并粘贴到写字板，它会以正确的换行符完美输出格式。如果我将每个文件的字节与十六进制编辑器或 KDiff3 进行比较，它们的二进制相同。

有一个使用此数据的第 3 方程序。可悲的是，第 3 方程序读取数据，并且对于条目 1 到 3，它显示的数据不带行返回。尽管对于条目 4，它正确地格式化了文本。作为我们在图片中看到的进一步证明，数据库中的数据显示方式不同。不知何故，行返回被保留在数据库中用于 vb 条目，但忽略了 jython 条目。如果我单击条目 4 的“MailBody”字段，我可以按下我可以看到电子邮件的其余部分。而 jython 的数据显示在一行中。

什么给了，我错过了什么，我该如何处理？这是我实际将其发送到数据库的代码片段。

编辑：仅供参考：请忽略“已处理”列中的差异，这是无关紧要的。编辑：我想做的是让 jython 程序以与 vb 程序相同的方式输入数据。这样第 3 方程序就会出现并正确显示数据。所以看起来“MailBody”中的每个条目都会显示“这只是一个测试！” 然后下一行“等”，所以如果我要进行屏幕转储，所有条目都将类似于数据库条目 4。

*解决了*

将 _force_CRLF 添加到组合中：

```
def _force_CRLF(self, data):
    '''Make sure data uses CRLF for line termination.
    Nicked the regex from smtplib.quotedata. '''
    print data
    newdata = re.sub(r'(?:\r\n|\n|\r(?!\n))', "\r\n", data)
    print newdata
    return newdata

def _execute_insert(self):
    try:
        self._stmt=self._con.prepareStatement(\
            "INSERT INTO EmailHdr (EntryID, MailSubject, MailFrom, MailTo, MailReceive, MailSent, AttachNo, MailBody)\
             VALUES (?, ?, ?, ?, ?, ?, ?, cast(? as varchar (" + str(BODY_FIELD_DATABASE) + ")))")
        self._stmt.setString(1,self._emailEntryId)
        self._stmt.setString(2,self._subject)
        self._stmt.setString(3,self._fromWho)
        self._stmt.setString(4,self._toWho)
        self._stmt.setString(5,self._format_date(self._emailRecv))
        self._stmt.setString(6,self._format_date(self._emailSent))
        self._stmt.setString(7,str(self._attachmentCount))
        self._stmt.setString(8,self._force_CRLF(self._format_email_body()))
        self._stmt.execute()
        self._prepare_inserting_attachment_data()
        self._insert_attachment_data()
    except:
        raise

def _format_email_body(self):
    if not self._emailBody:
        return "could not extract email body"
    if len(self._emailBody) > BODY_TRUNCATE_LENGTH:
        return self._clean_body(self._emailBody[:BODY_TRUNCATE_LENGTH])
    else:
        return self._clean_body(self._emailBody)

def _clean_body(self,dirty):
    '''this method simply deletes any occurrence of an '=20' that plagues my output after much testing this is not related to the line return issue, even if i comment it out I still have the problem.''' 
    dirty=str(dirty)
    dirty=dirty.replace(r"=20","")
    return r"%s"%dirty 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T14:06:49.047

您应该查看 quopri 模块（以及其他有关电子邮件的模块），因此您不必使用肮脏的技巧作为`_clean_body`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T05:36:27.200

我建议在您的程序中添加一个调试输出，在插入 DB 之前转储字符代码。Jython 有可能用单个字符替换 CrLf 对，并且在写入 DB 时不会恢复它。

# html - 为什么这种“宽度：自动”样式在两个浏览器中都作为内联样式工作，但仅在 IE 中移动到外部样式表时会中断？

> ID：355139
> 
> 赞同：0
> 
> 时间：2008-12-10T05:15:47.740
> 
> 标签：html, css, internet-explorer, stylesheet

我有一个默认为“宽度：100%”的 INPUT 元素。这会导致它将旁边的其他元素向下推到下一行。为了临时解决这个问题，我在元素上添加了一个内联样式属性，如下所示：

```
<input style="width: auto" ...> 
```

效果很好。现在我要回去清理临时修复，并将所有样式从样式属性移到外部样式表中。当我将这个特殊的“width: auto”样式移动到样式表中时，它在 Firefox 中看起来仍然很好，但在 IE 中它会忽略它并再次默认为“width: 100%”，这会再次吹出它旁边的元素。

IE web 开发工具栏没有告诉我样式来自哪里，因此很难诊断出发生了什么。我最好的猜测是 IE 中还有其他优先事项，但我不知道它可能是什么。

编辑：我发誓我尝试在 IE 开发人员栏中右键单击，但我想没有 - 当我在 IE 中的“宽度：100%”上执行“跟踪样式”时，我得到一个弹出窗口，上面写着“1。不匹配”，然而，在 Firefox 中，它显示 100% 是从上面元素上的选择器中流出的，类似于“#outer foo bar INPUT”，它也覆盖了这个 INPUT。我错误地认为直接在 INPUT 元素上的“#id”会比“#id foo bar INPUT”具有更高的特异性，但我猜浏览器不同意这一点。无论哪种方式，这都是我问题的根源，所以感谢您的评论。我希望有一种方法可以促进对答案的评论......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T07:36:18.487

您是否绝对确定您的规则没有冲突或顺序错误（并且优先级相同）从而相互抵消？

除了 John Sheehan 的建议之外，您还可以尝试的一件事是将 ID 应用于输入元素，然后在样式表中制定规则，通过 ID 选择器将 width:auto 添加到该元素。

这样，该规则将具有更高的优先级并且更有可能被应用。这将使您更好地了解问题所在。

编辑：考虑到您的更新，导致您悲伤的规则正在按预期工作（就特异性而言）。如果您想专门解决您的元素，您仍然可以编写具有*更强*特异性的规则，如下所示：

```
#outer foo bar INPUT#id {
  width:auto;
} 
```

但是，如果你发现自己是这样编写 CSS 的，那么很可能你做错了什么，并且可能需要重新思考你是如何构建 CSS 规则的。

# .net - 解决方法更快，DataSet.Tables 或 Dictionary

> ID：355141
> 
> 赞同：2
> 
> 时间：2008-12-10T05:16:43.667
> 
> 标签：.net, dictionary, datatable, comparison

我正在为导入导出测试创建一个模拟数据库（算法读取和写入我们的数据库的复杂数据结构，而不仅仅是测试 IO 操作），并试图决定是否使用 DataSet 来存储模拟表（按表name) 在虚假数据库中，或 Dictionary()

在按名称检索数据表方面，我希望从 dataset.Tables["TableName"] 或 dictionary<"TableName"> （来自 Dictionary() 中获得更好的性能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T09:20:22.677

实际上，由于执行字典逻辑（哈希、桶等）的固有复杂性，`Dictionary<,>`通常比线性搜索*慢。*在我的测试中，截止（`Dictionary<,>`开始变得更快）通常在 150 个元素左右。而且由于您的表通常少于 150 个，因此我很乐意使用线性列表来提高性能。

（这根本不意味着“不要使用`Dictionary<T>`；它只是意味着*性能*可能不是这个特定用例的主要原因；唯一的密钥执行和 foo["bar"] 模型可能是）

部分原因是获取哈希的复杂性 -特别是`GetHashCode()`for`string`相对昂贵（尽管`int.GetHashCode()`速度非常快;-p）。

实际上，在大多数小型数据集中，您永远不会注意到两者之间的差异。如果您有大量数据，那么显然您需要对此进行计划并进行相应的编码。

`Dictionary<,>`a和类似 a的其他区别`List<>`是唯一性：a`Dictionary<,>`不会让您拥有重复的键（尽管`Lookup<,>`.NET 3.5 中的 a 会）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-10T05:29:27.917

DataSet.Tables 在内部使用 ArrayList 实现。按名称查找表涉及对列表中的表进行线性搜索和大量转换。因此，使用基于散列的通用字典几乎肯定会更快。（虽然你需要很多表和/或很多访问才能产生很大的不同。）

# c# - 动态程序集加载时的依赖注入

> ID：355145
> 
> 赞同：1
> 
> 时间：2008-12-10T05:20:41.040
> 
> 标签：c#, winforms, reflection, dependency-injection

我有一个有很多 IOrderDataLoader 实现的 winforms 应用程序。其他团队开始构建自己的 IOrderDataLoader 新实现。因此，我们将应用程序切换为查看 Dll 目录并使用反射加载所有实现 IOrderDataLoader 的类。这样，其他组可以自行部署他们的 dll，主应用程序会按需加载它们。

问题是我们作为一个内部项目拥有的实现之一，我们正试图移出到它自己的部署中，它有许多依赖项。我该如何解决这个问题并将其与所有依赖项一起加载？所有其他数据加载器都有空的构造函数，所以我只是循环。.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T05:39:08.647

尝试查看[Managed Extensibility Framework](http://www.codeplex.com/MEF)。它是一个框架，用于完成您已经完成的工作，并支持您请求的样式的依赖注入。

# email - 从服务器发送大量电子邮件时遇到的限制

> ID：355151
> 
> 赞同：2
> 
> 时间：2008-12-10T05:30:00.707
> 
> 标签：email

从服务器发送大量电子邮件存在哪些实际问题？如果我只是盲目地调用 PHP 中的 mail() 函数数万次，那么该电子邮件被接收的可能性是否与从 g-mail 或个人电子邮件帐户发送的一样？一天？

*（注意：您不是在这里帮助垃圾邮件发送者，这与我正在考虑为未来的链接共享站点提供的通知功能有关）*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T22:31:57.227

虽然从技术上讲，您每分钟可以发送数千封邮件，但实际上您必须小心。

例如，假设您向雅虎发送了 500 封电子邮件。如果有足够多的人将您的邮件标记为垃圾邮件，很快，您发送给雅虎的任何电子邮件都将被标记为垃圾邮件，或 [BULK]。许多 isp 经常 tar-pit 或直接拒绝来自 RBL（实时黑洞列表）等列表中的服务器的电子邮件。如果您的邮件 IP 被列入这些列表之一，您就可以再次从该 IP 正常发送电子邮件再见了。用户非常挑剔，不需要太多投诉就可以在许多域中阻止您的邮件 IP。

此外，由于您正在发送自动消息，因此可以使用启发式方法来确定是否将同一消息发送给同一域中的许多用户。这也增加了您的邮件被标记为垃圾邮件的机会。

这就是为什么来自某些地址的干净电子邮件总是进入垃圾邮件箱的原因。他们的公司在发送可能被视为垃圾邮件的内容时可能不够小心。谨慎行事。

[http://wiki.apache.org/spamassassin/AvoidingFpsForSenders](http://wiki.apache.org/spamassassin/AvoidingFpsForSenders)

[http://support.microsoft.com/kb/842851](http://support.microsoft.com/kb/842851)

[http://www.blacklistedip.com/rbl_list.php](http://www.blacklistedip.com/rbl_list.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T05:42:05.347

它有助于设置一个真正的邮件客户端的“x-mailer”和（如果你伪装成 Outlook，则为“X-MimeOLE”）。它还有助于从作为发件人地址中域的邮件服务器的服务器发送它，并设置正向和反向 DNS 记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T06:24:36.993

没有问题。一旦服务器被正确配置为特定域的邮件服务器 (SMTP)，它发送的邮件是来自 Outlook 还是来自`mail()`PHP 中的函数没有区别 - 两者都让 SMTP 服务器完成所有工作举重的

我总是确保正确设置我的 X-Mailer 标头（识别邮件是从 PHP 内部发送的），以确保任何过分热心的反垃圾邮件服务将其识别为自动通知，而不是批量/垃圾邮件。例如

```
$headers .= "X-Mailer: PHP/".phpversion(); 
```

您将遇到的所有配置和限制都来自 SMTP 服务器，而不是来自 PHP。例如，您可以将 SMTP 配置为将速率限制为每秒 2 条消息，这意味着如果您将 1,200 条消息排队，它们将在接下来的一个小时内滴出，而不是一次全部流出（两个是一个非常低的数字，5- 25 更现实）。

SMTP 是电子邮件的主干，一些 SMTP 服务器每分钟可以愉快地处理数万条消息（或更多！） - 您可能面临的唯一限制是带宽；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-08T16:40:18.447

请咨询您的托管服务提供商，尤其是在您使用共享托管服务的情况下。例如：GoDaddy 将共享主机帐户限制为每天在其服务器上发送 1000 封电子邮件 ( [http://support.godaddy.com/groups/web-hosting/forum/topic/e-mail-sending-limit/](http://support.godaddy.com/groups/web-hosting/forum/topic/e-mail-sending-limit/) )。我确信其他供应商有自己的限制（我相信我工作的公司之一的供应商将外发电子邮件限制为每分钟 250 封或类似的东西）。

**编辑：**就我而言，解决方案是联系我们的托管服务提供商。他们提供信息以通过专用于发送外发电子邮件的服务器路由外发电子邮件。马上解决了问题。

# ajax - “支持 AJAX 的 WCF 服务”在哪里？

> ID：355153
> 
> 赞同：3
> 
> 时间：2008-12-10T05:33:41.027
> 
> 标签：ajax, visual-studio-2008, wcf

我已经安装了 Visual Studio 2008 并使用 SP1 对其进行了修补。但是，我在新建项目对话框中找不到“启用 AJAX 的 WCF 服务”。是否应该添加更多补丁以使“启用 AJAX 的 WCF 服务”模板出现？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-10T05:44:26.997

[http://msdn.microsoft.com/en-us/library/bb924552.aspx](http://msdn.microsoft.com/en-us/library/bb924552.aspx)

基本上它不在“新建项目”对话框中。它在“新项目”对话框中。

# c# - C# Excel页脚问题

> ID：355155
> 
> 赞同：0
> 
> 时间：2008-12-10T05:35:00.370
> 
> 标签：c#, excel-2003

我正在创建一个 C# windows 应用程序来创建一个 Excel 2003 工作表。需要添加到页脚：第 1 页，共 4 页。

我目前拥有它，因此它将“Page: &[Page] of &[Pages]”放入 Excel 工作表的页脚。

当我打开创建的文档并查看页脚时，我看到“Page: Page] of Pages]”

我可以单击文本，它会突出显示它并显示它应该显示的内容，然后可以正常工作。

有没有办法让它从一开始就正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T06:46:12.223

在 Excel 2007 中，如果您将其键入为页脚：

```
Page &[Page] of &[Pages] 
```

然后进入 VBA 编辑器立即窗口并输入：

```
print ActiveSheet.PageSetup.CenterFooter 
```

结果是：

```
Page &P of &N 
```

换句话说，代码中设置的值与用户界面中输入的值不同。

鉴于 Microsoft 将向后兼容性视为某种圣旨，我强烈怀疑您在 Excel 2003 中看到的情况相同 - 尝试修改代码以设置“Page &P of &N”。

# wcf - 如何删除 RESTful WCF 服务中的“.svc”扩展名？

> ID：355165
> 
> 赞同：52
> 
> 时间：2008-12-10T05:41:34.850
> 
> 标签：wcf, rest

据我所知，RESTful WCF 在其 URL 中仍然包含“.svc”。

例如，如果服务接口像

```
[OperationContract]
[WebGet(UriTemplate = "/Value/{value}")]
string GetDataStr(string value); 
```

访问 URI 类似于“ [http://machinename/Service.svc/Value/2](http://machinename/Service.svc/Value/2) ”。据我了解，REST 的部分优势在于它可以隐藏实现细节。像“ [http://machinename/Service/value/2](http://machinename/Service/value/2) ”这样的 RESTful URI 可以由任何 RESTful 框架实现，但是“ [http://machinename/Service.svc/value/2](http://machinename/Service.svc/value/2) ”公开其实现是 WCF。

如何在访问 URI 中删除此“.svc”主机？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-05-31T23:26:42.657

我知道这篇文章现在有点老了，但如果你碰巧使用的是 .NET 4，你应该看看使用 URL Routing（在 MVC 中引入，但在核心 ASP.NET 中引入）。

在您的应用程序启动 (global.asax) 中，只需使用以下路由配置行来设置默认路由：

```
RouteTable.Routes.Add(new ServiceRoute("mysvc", new WebServiceHostFactory(), typeof(MyServiceClass))); 
```

那么您的 URL 将如下所示：

```
http://servername/mysvc/value/2 
```

高温高压

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-12-10T09:03:53.537

在 IIS 7 中，您可以使用此博客[文章](http://blogs.msdn.com/endpoint/archive/2008/08/22/rest-in-wcf-part-ix-controlling-the-uri.aspx)中解释的[Url Rewrite Module](http://learn.iis.net/page.aspx/460/using-url-rewrite-module/)。

在 IIS 6 中，您可以编写一个将重写 url 的[http 模块](http://msdn.microsoft.com/en-us/library/system.web.ihttpmodule.aspx)：

```
public class RestModule : IHttpModule
{
    public void Dispose() { }

    public void Init(HttpApplication app)
    {
        app.BeginRequest += delegate
        {
            HttpContext ctx = HttpContext.Current;
            string path = ctx.Request.AppRelativeCurrentExecutionFilePath;

            int i = path.IndexOf('/', 2);
            if (i > 0)
            {
                string svc = path.Substring(0, i) + ".svc";
                string rest = path.Substring(i, path.Length - i);
                ctx.RewritePath(svc, rest, ctx.Request.QueryString.ToString(), false);
            }
        };
    }
} 
```

还有一个很好的[例子](http://www.codeproject.com/KB/aspnet/extensionless.aspx?display=Print)，如何在不使用第三方 ISAPI 模块或通配符映射的情况下在 IIS 6 中实现无扩展 url。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-20T03:20:27.513

以下是使用 IIS 7 重写模块或使用自定义模块的更详细信息： [http ://www.west-wind.com/Weblog/posts/570695.aspx](http://www.west-wind.com/Weblog/posts/570695.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-01-15T03:44:21.507

还有一种方法可以完全消除物理 .svc 文件。这可以通过`VirtualPathProvider`.

请参阅：[http ://social.msdn.microsoft.com/Forums/en-US/wcf/thread/350f2cb6-febd-4978-ae65-f79735d412db](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/350f2cb6-febd-4978-ae65-f79735d412db)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-15T22:24:54.420

在 IIS 7 上很容易 - 使用[URL 重写模块](http://learn.iis.net/page.aspx/460/using-url-rewrite-module/)

在 IIS 6 上，我发现最容易使用[ISAPI 重写模块](http://www.isapirewrite.com/)，它允许您定义一组将请求 Urls 映射到 .svc 文件的正则表达式...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-15T03:35:20.987

在 IIS6 或 7 中，您可以使用免费的重写过滤器[IIRF 。](http://iirf.codeplex.com)这是我使用的规则：

```
# Iirf.ini
#

RewriteEngine ON
RewriteLog  c:\inetpub\iirfLogs\iirf-v2.0.services
RewriteLogLevel 3
StatusInquiry  ON  RemoteOk
CondSubstringBackrefFlag *
MaxMatchCount 10

# remove the .svc tag from external URLs
RewriteRule  ^/services/([^/]+)(?<!\.svc)/(.*)$    /services/$1.svc/$2  [L] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-16T11:47:06.483

将此添加到您的 global.asax

```
private void Application_BeginRequest(object sender, EventArgs e)
{
    Context.RewritePath(System.Text.RegularExpressions.Regex.Replace(
               Request.Path, "/rest/(.*)/", "/$1.svc/"));
} 
```

这会将 /rest/Service1/arg1/arg2 替换为 /Service1.svc/arg1/arg2

# java - Java 中如何使用匿名内部类？

> ID：355167
> 
> 赞同：317
> 
> 时间：2008-12-10T05:42:06.813
> 
> 标签：java, anonymous-class, anonymous-inner-class

Java中匿名类有什么用？我们可以说匿名类的使用是Java的优势之一吗？

* * *

## 回答 #1

> 赞同：378
> 
> 时间：2008-12-10T05:50:57.967

通过“匿名类”，我认为您的意思是[匿名内部类](http://docs.oracle.com/javase/tutorial/java/javaOO/innerclasses.html)。

匿名内部类可以在创建具有某些“附加”（例如覆盖方法）的对象实例时很有用，而不必实际子类化一个类。

我倾向于将其用作附加事件侦听器的快捷方式：

```
button.addActionListener(new ActionListener() {
    @Override
    public void actionPerformed(ActionEvent e) {
        // do something
    }
}); 
```

使用这种方法可以使编码更快一点，因为我不需要创建一个额外的实现类`ActionListener`——我可以只实例化一个匿名内部类，而无需实际创建一个单独的类。

我只将这种技术用于“快速而肮脏”的任务，让整个班级感觉没有必要。拥有多个做同样事情的匿名内部类应该重构为一个实际的类，无论是内部类还是单独的类。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2008-12-10T07:54:45.347

匿名内部类实际上是闭包，因此它们可用于模拟 lambda 表达式或“委托”。以这个接口为例：

```
public interface F<A, B> {
   B f(A a);
} 
```

您可以匿名使用它在 Java中创建[一流的函数。](http://en.wikipedia.org/wiki/First-class_function)假设您有以下方法，它返回给定列表中大于 i 的第一个数字，或者如果没有更大的数字，则返回 i：

```
public static int larger(final List<Integer> ns, final int i) {
  for (Integer n : ns)
     if (n > i)
        return n;
  return i;
} 
```

然后你有另一个方法返回给定列表中小于 i 的第一个数字，或者如果没有数字更小，则返回 i：

```
public static int smaller(final List<Integer> ns, final int i) {
   for (Integer n : ns)
      if (n < i)
         return n;
   return i;
} 
```

这些方法几乎相同。使用第一类函数类型 F，我们可以将它们重写为一个方法，如下所示：

```
public static <T> T firstMatch(final List<T> ts, final F<T, Boolean> f, T z) {
   for (T t : ts)
      if (f.f(t))
         return t;
   return z;
} 
```

您可以使用匿名类来使用 firstMatch 方法：

```
F<Integer, Boolean> greaterThanTen = new F<Integer, Boolean> {
   Boolean f(final Integer n) {
      return n > 10;
   }
};
int moreThanMyFingersCanCount = firstMatch(xs, greaterThanTen, x); 
```

这是一个非常人为的例子，但很容易看出能够像值一样传递函数是一个非常有用的特性。请参阅Joel 自己的[“你的编程语言能做到这一点”](http://www.joelonsoftware.com/items/2006/08/01.html)。

以这种风格编写 Java 的一个不错的库：[Functional Java。](http://functionaljava.org)

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2014-03-09T18:42:28.283

匿名内部类用于以下场景：

1.) 对于覆盖（子类化），当类定义除当前情况外不可用时：

```
class A{
    public void methodA() {
        System.out.println("methodA");
    }
}

class B{
    A a = new A() {
        public void methodA() {
            System.out.println("anonymous methodA");
        }
    };
} 
```

2.) 对于实现接口，当仅当前情况需要实现接口时：

```
interface InterfaceA{
    public void methodA();
}

class B{
    InterfaceA a = new InterfaceA() {
        public void methodA() {
            System.out.println("anonymous methodA implementer");
        }
    };
} 
```

3.）参数定义的匿名内部类：

```
interface Foo {
    void methodFoo();
}

class B{
    void do(Foo f) { }
}

class A{
    void methodA() {
        B b = new B();
        b.do(new Foo() {
            public void methodFoo() {
                System.out.println("methodFoo");
            } 
        });
    } 
} 
```

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2008-12-11T20:59:36.867

我有时将它们用作 Map 实例化的语法技巧：

```
Map map = new HashMap() {{
   put("key", "value");
}}; 
```

对比

```
Map map = new HashMap();
map.put("key", "value"); 
```

它在执行大量 put 语句时节省了一些冗余。但是，当外部类需要通过远程处理进行序列化时，我也遇到了问题。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-12-10T05:51:13.583

它们通常用作回调的详细形式。

我想你可以说它们与没有它们相比是一个优势，并且每次都必须创建一个命名类，但是类似的概念在其他语言中实现得更好（作为闭包或块）

这是一个摆动的例子

```
myButton.addActionListener(new ActionListener(){
    public void actionPerformed(ActionEvent e) {
        // do stuff here...
    }
}); 
```

虽然它仍然很冗长，但它比强迫你为每个这样的丢弃监听器定义一个命名类要好得多（尽管取决于情况和重用，这可能仍然是更好的方法）

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-12-10T05:50:04.520

您可以在需要在另一个函数中为特定目的创建类的情况下使用它，例如，作为侦听器、作为可运行对象（生成线程）等。

这个想法是您从函数代码内部调用它们，因此您永远不会在其他地方引用它们，因此您不需要命名它们。编译器只是枚举它们。

它们本质上是语法糖，随着它们变大，通常应该移到别处。

我不确定这是否是 Java 的优势之一，但如果您确实使用它们（不幸的是，我们都经常使用它们），那么您可能会争辩说它们是其中之一。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-05-23T17:20:05.667

匿名类指南。

1.  匿名类同时声明和初始化。

2.  匿名类必须扩展或实现一个且只有一个类或接口。

3.  由于匿名类没有名字，所以只能使用一次。

例如：

```
button.addActionListener(new ActionListener(){

            public void actionPerformed(ActionEvent arg0) {
        // TODO Auto-generated method stub

    }
}); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-12-10T07:50:45.667

是的，匿名内部类绝对是 Java 的优势之一。

使用匿名内部类，您可以访问周围类的最终变量和成员变量，这在侦听器等中派上用场。

但是一个主要优点是内部类代码（至少应该）与周围的类/方法/块紧密耦合，具有特定的上下文（周围的类、方法和块）。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-03-21T05:59:11.083

```
new Thread() {
        public void run() {
            try {
                Thread.sleep(300);
            } catch (InterruptedException e) {
                System.out.println("Exception message: " + e.getMessage());
                System.out.println("Exception cause: " + e.getCause());
            }
        }
    }.start(); 
```

这也是使用线程的匿名内部类型的示例之一

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-11-17T09:04:30.787

内部[类](https://docs.oracle.com/javase/tutorial/java/javaOO/innerclasses.html)与外部类的实例相关联，有两种特殊类型：本地类和[匿名类](https://docs.oracle.com/javase/tutorial/java/javaOO/anonymousclasses.html)。匿名类使我们能够同时声明和实例化一个类，从而使代码简洁。当我们只需要一次本地类时，我们会使用它们，因为它们没有名称。

考虑我们有一个类的[文档中的示例：](https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html)`Person`

```
public class Person {

    public enum Sex {
        MALE, FEMALE
    }

    String name;
    LocalDate birthday;
    Sex gender;
    String emailAddress;

    public int getAge() {
        // ...
    }

    public void printPerson() {
        // ...
    }
} 
```

我们有一种方法可以将匹配搜索条件的成员打印为：

```
public static void printPersons(
    List<Person> roster, CheckPerson tester) {
    for (Person p : roster) {
        if (tester.test(p)) {
            p.printPerson();
        }
    }
} 
```

`CheckPerson`像这样的接口在哪里：

```
interface CheckPerson {
    boolean test(Person p);
} 
```

现在我们可以使用实现此接口的匿名类来指定搜索条件：

```
printPersons(
    roster,
    new CheckPerson() {
        public boolean test(Person p) {
            return p.getGender() == Person.Sex.MALE
                && p.getAge() >= 18
                && p.getAge() <= 25;
        }
    }
); 
```

这里的接口非常简单，匿名类的语法显得笨拙和不清楚。

**Java 8**引入了一个术语[函数式接口](https://docs.oracle.com/javase/8/docs/api/java/lang/FunctionalInterface.html)，它是一个只有一个抽象方法的接口，因此我们可以说`CheckPerson`是一个函数式接口。我们可以使用[Lambda 表达式](https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html)，它允许我们将函数作为方法参数传递为：

```
printPersons(
                roster,
                (Person p) -> p.getGender() == Person.Sex.MALE
                        && p.getAge() >= 18
                        && p.getAge() <= 25
        ); 
```

我们可以使用标准的功能接口`Predicate`代替接口`CheckPerson`，这将进一步减少所需的代码量。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-10-10T05:17:27.783

我使用匿名对象来调用新线程..

```
new Thread(new Runnable() {
    public void run() {
        // you code
    }
}).start(); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-12-17T06:59:06.983

匿名内部类在为不同对象提供不同实现时可能是有益的。但是应该非常谨慎地使用，因为它会给程序的可读性带来问题。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-12-28T10:38:18.650

匿名类在类终结中的主要用法之一，称为*终结器守护者*。在 Java 世界中，应该避免使用 finalize 方法，直到你真正需要它们。您必须记住，当您覆盖子类的 finalize 方法时，您也应该始终调用`super.finalize()`，因为超类的 finalize 方法不会自动调用，并且您可能会遇到内存泄漏的问题。

所以考虑到上面提到的事实，你可以使用匿名类，比如：

```
public class HeavyClass{
    private final Object finalizerGuardian = new Object() {
        @Override
        protected void finalize() throws Throwable{
            //Finalize outer HeavyClass object
        }
    };
} 
```

使用这种技术，您可以减轻自己和其他开发人员调用which need finalize 方法`super.finalize()`的每个子类的负担。`HeavyClass`

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-07-03T13:23:56.413

您可以通过这种方式使用匿名类

```
TreeSet treeSetObj = new TreeSet(new Comparator()
{
    public int compare(String i1,String i2)
    {
        return i2.compareTo(i1);
    }
}); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-08-17T20:06:50.523

这里似乎没有人提到，但您也可以使用匿名类来保存泛型类型参数*（通常由于类型擦除而丢失）*：

```
public abstract class TypeHolder<T> {
    private final Type type;

    public TypeReference() {
        // you may do do additional sanity checks here
        final Type superClass = getClass().getGenericSuperclass();
        this.type = ((ParameterizedType) superClass).getActualTypeArguments()[0];
    }

    public final Type getType() {
        return this.type;
    }
} 
```

如果你以匿名方式实例化这个类

```
TypeHolder<List<String>, Map<Ineger, Long>> holder = 
    new TypeHolder<List<String>, Map<Ineger, Long>>() {}; 
```

那么这样`holder`的实例将包含传递类型的非擦除定义。

### 用法

这对于构建验证器/反序列化器非常方便。你也可以用反射实例化泛型类型*（所以如果你想`new T()`在参数化类型中做 - 欢迎你！）*。

### 缺点/限制

1.  您应该显式传递泛型参数。不这样做会导致类型参数丢失
2.  每个实例化都会花费你额外的类来由编译器生成，这会导致类路径污染/jar 膨胀

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-03-21T12:24:07.270

**Anonymous Inner Class**用于创建一个永远不会被再次引用的对象。它没有名称，并在同一语句中声明和创建。这用于通常使用对象变量的地方。您将变量替换为`new`关键字、对构造函数的调用以及 and 中的类`{`定义`}`。

在 Java 中编写线程程序时，它通常看起来像这样

```
ThreadClass task = new ThreadClass();
Thread runner = new Thread(task);
runner.start(); 
```

此处使用的`ThreadClass`将是用户定义的。此类将实现`Runnable`创建线程所需的接口。在方法`ThreadClass`中`run()`（仅方法 in `Runnable`）也需要实现。很明显，摆脱`ThreadClass`会更有效，这正是存在匿名内部类的原因。

看下面的代码

```
Thread runner = new Thread(new Runnable() {
    public void run() {
        //Thread does it's work here
    }
});
runner.start(); 
```

此代码替换了`task`最上面的示例中的引用。构造函数内部的匿名内部类没有单独的类，而是`Thread()`返回一个未命名的对象，该对象实现了`Runnable`接口并覆盖了`run()`方法。该方法`run()`将包括执行线程所需工作的语句。

在回答匿名内部类是否是 Java 的优势之一的问题时，我不得不说我不太确定，因为我目前还不熟悉许多编程语言。但我能说的是，它绝对是一种更快、更容易的编码方法。

**参考资料：Sams 21 天自学 Java 第七版**

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-08-14T14:18:00.770

优化代码的最佳方式。此外，我们可以用于类或接口的覆盖方法。

```
import java.util.Scanner;
abstract class AnonymousInner {
    abstract void sum();
}

class AnonymousInnerMain {
    public static void main(String []k){
        Scanner sn = new Scanner(System.in);
        System.out.println("Enter two vlaues");
            int a= Integer.parseInt(sn.nextLine());
            int b= Integer.parseInt(sn.nextLine()); 
        AnonymousInner ac = new AnonymousInner(){
            void sum(){
                int c= a+b;
                System.out.println("Sum of two number is: "+c);
            }
        };
        ac.sum();
    }

} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-05-12T12:22:03.323

另一个优点：
如您所知，Java 不支持多重继承，因此如果您使用“线程”类作为匿名类，那么该类仍然有一个空间供任何其他类扩展。

# ios - 退出 iPhone 应用程序的正确方法？

> ID：355168
> 
> 赞同：287
> 
> 时间：2008-12-10T05:42:32.163
> 
> 标签：ios, objective-c, iphone, cocoa-touch, ipad

我正在编写一个 iPhone 应用程序，由于某些用户操作，我需要强制它退出。清理应用程序分配的内存后，调用终止应用程序的适当方法是什么？

* * *

## 回答 #1

> 赞同：276
> 
> 时间：2008-12-10T14:54:06.467

在 iPhone 上没有退出应用程序的概念。应该导致应用退出的唯一操作是触摸手机上的主页按钮，这不是开发人员可以访问的。

根据 Apple 的说法，您的应用程序不应自行终止。由于用户没有点击 Home 按钮，因此任何返回到 Home 屏幕的操作都会给用户留下您的应用程序崩溃的印象。这是令人困惑的非标准行为，应该避免。

* * *

## 回答 #2

> 赞同：221
> 
> 时间：2008-12-10T05:49:12.620

你试过`exit(0)`吗？

或者，`[[NSThread mainThread] exit]`虽然我没有尝试过它似乎是更合适的解决方案。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2013-07-23T05:54:32.630

exit(0) 向用户显示为崩溃，因此向用户显示确认消息。确认暂停后（以编程方式按下主页按钮）并等待 2 秒，而应用程序正在以动画形式进入后台，然后退出用户视图

```
-(IBAction)doExit
{
    //show confirmation message to user
    UIAlertView* alert = [[UIAlertView alloc] initWithTitle:@"Confirmation"
                                                 message:@"Do you want to exit?"
                                                delegate:self
                                       cancelButtonTitle:@"Cancel"
                                       otherButtonTitles:@"OK", nil];
    [alert show];
}

-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex != 0)  // 0 == the cancel button
    {
        //home button press programmatically
        UIApplication *app = [UIApplication sharedApplication];
        [app performSelector:@selector(suspend)];

        //wait 2 seconds while app is going background
        [NSThread sleepForTimeInterval:2.0];

        //exit app when app is in background
        exit(0);
    }
} 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2010-06-05T14:31:59.460

在此处查看问答：[https ://developer.apple.com/library/content/qa/qa1561/_index.html](https://developer.apple.com/library/content/qa/qa1561/_index.html)

> ### 问：如何以编程方式退出我的 iOS 应用程序？
> 
> 没有提供用于优雅终止 iOS 应用程序的 API。
> 
> 在 iOS 中，用户按下 Home 按钮来关闭应用程序。如果您的应用程序出现无法提供其预期功能的情况，推荐的方法是向用户显示警报，指出问题的性质以及用户可能采取的措施——打开 WiFi、启用定位服务等。允许用户自行决定终止应用程序。
> 
> > **警告：**不要调用该`exit`函数。调用的应用程序`exit`将在用户看来已经崩溃，而不是执行正常终止并动画返回主屏幕。
> 
> 此外，可能不会保存数据，因为如果您调用 exit，将不会调用`-applicationWillTerminate:`类似的方法。`UIApplicationDelegate`
> 
> 如果在开发或测试期间需要终止您的应用程序，建议使用该`abort`函数或`assert`宏

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2009-08-04T00:59:29.917

它并不是真正的退出程序的方法，而是一种迫使人们退出的方法。

```
UIAlertView *anAlert = [[UIAlertView alloc] initWithTitle:@"Hit Home Button to Exit" message:@"Tell em why they're quiting" delegate:self cancelButtonTitle:nil otherButtonTitles:nil];
[anAlert show]; 
```

* * *

## 回答 #6

> 赞同：38
> 
> 时间：2011-06-01T04:47:38.000

转到您的 info.plist 并检查“应用程序不在后台运行”键。这一次，当用户单击主页按钮时，应用程序完全退出。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2011-07-07T08:14:39.123

将`UIApplicationExitsOnSuspend`属性添加`application-info.plist`到`true`.

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2009-05-17T17:00:54.467

经过一些测试，我可以说以下内容：

*   使用私有接口：`[UIApplication sharedApplication]`会导致应用程序看起来像崩溃了，但它会`- (void)applicationWillTerminate:(UIApplication *)application`在这样做之前调用；
*   using`exit(0);`也会终止应用程序，但它看起来“正常”（跳板的图标看起来像预期的那样，具有缩小效果），但它不会调用`- (void)applicationWillTerminate:(UIApplication *)application`委托方法。

我的建议：

1.  手动调用`- (void)applicationWillTerminate:(UIApplication *)application`委托。
2.  打电话`exit(0);`。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2010-08-12T10:41:15.667

您的 ApplicationDelegate 会收到用户有意退出的通知：

```
- (void)applicationWillResignActive:(UIApplication *)application { 
```

当我收到此通知时，我只是打电话

```
 exit(0); 
```

哪个可以完成所有工作。最好的事情是，用户打算退出，这就是为什么在那里调用它应该不是问题的原因。

在我的音频应用程序上，当人们在音乐仍在播放时同步他们的设备后，有必要退出应用程序。同步完成后，我会立即收到通知。但在那之后立即退出应用程序实际上看起来就像一个崩溃。

因此，我设置了一个标志，以便在下一个后台操作时真正退出应用程序。同步后刷新应用程序是可以的。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-12-02T17:44:36.133

我的应用程序最近被拒绝，因为我使用了一种未记录的方法。字面上地：

“不幸的是，它无法添加到 App Store，因为它使用的是私有 API。禁止使用非公共 API，如 iPhone 开发人员程序许可协议第 3.3.1 节所述：

“3.3.1 应用程序只能以 Apple 规定的方式使用文档化 API，不得使用或调用任何私有 API。”

您的应用程序中包含的非公共 API 是 terminateWithSuccess"

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2013-05-23T12:01:23.547

苹果说：

“警告：不要调用退出函数。调用退出的应用程序将在用户看来已经崩溃，而不是执行正常终止并动画返回主屏幕。”

我认为这是一个糟糕的假设。如果用户点击退出按钮并出现一条消息，例如：“应用程序现在将退出。”，它似乎没有崩溃。Apple 应该提供一种有效的方式来退出应用程序（而不是 exit(0)）。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2019-06-18T10:07:30.420

您不应直接调用该函数`exit(0)`，因为它会立即退出应用程序，并且看起来您的应用程序已崩溃。因此最好向用户显示确认警报并让他们自己执行此操作。

## 斯威夫特 4.2

```
func askForQuit(_ completion:@escaping (_ canQuit: Bool) -> Void) {
    let alert = UIAlertController(title: "Confirmation!", message: "Do you want to quit the application", preferredStyle: .alert)
    alert.addAction(UIAlertAction(title: "Yes", style: UIAlertAction.Style.default, handler: { (action) in
        alert.dismiss(animated: true, completion: nil)
        completion(true)
    }))
    alert.addAction(UIAlertAction(title: "No", style: UIAlertAction.Style.cancel, handler: { (action) in
        alert.dismiss(animated: true, completion: nil)
        completion(false)
    }))
    self.present(alert, animated: true, completion: nil)
}

/// Will quit the application with animation
func quit() {
    UIApplication.shared.perform(#selector(NSXPCConnection.suspend))
    /// Sleep for a while to let the app goes in background
    sleep(2)
    exit(0)
} 
```

### 用法：

```
self.askForQuit { (canQuit) in
     if canQuit {
         self.quit()
     }
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2011-02-03T15:23:48.220

这已经得到了一个很好的答案，但决定扩大一点：

如果不仔细阅读 Apple 的 iOS 人机界面指南，您的应用程序将无法被 AppStore 接受。（他们保留拒绝您对他们做*任何事情*的权利）“不要以编程方式退出”部分[http://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/UEBestPractices/UEBestPractices。 html](http://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/UEBestPractices/UEBestPractices.html) 是在这种情况下您应该如何处理的确切指南。

如果您在 Apple 平台上遇到过无法轻松找到解决方案的问题，请咨询 HIG。Apple 可能根本不希望你这样做，而且他们通常（我不是 Apple，所以我不能总是保证）会在他们的文档中这么说。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-12-11T01:55:15.273

嗯，如果您的应用程序需要互联网连接，您可能“必须”退出该应用程序。您可以显示警报，然后执行以下操作：

```
if ([[UIApplication sharedApplication] respondsToSelector:@selector(terminate)]) {
    [[UIApplication sharedApplication] performSelector:@selector(terminate)];
} else {
    kill(getpid(), SIGINT); 
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-04-28T13:21:24.133

我们不能退出应用程序使用`exit(0)`,`abort()`功能，因为 Apple 强烈反对使用这些功能。尽管您可以将此功能用于开发或测试目的。

> 如果在开发或测试期间需要终止您的应用程序，建议使用中止函数或断言宏

请查找此 Apple [Q&A](https://developer.apple.com/library/ios/qa/qa1561/_index.html)线程以获取更多信息。

由于使用此功能会产生应用程序崩溃的印象。因此，我得到了一些建议，例如由于某些功能不可用，我们可以向意识到用户关闭应用程序时显示带有终止消息的警报。

但是 iOS Human Interface Guideline for [Starting and Stopping App](https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/MobileHIG/StartingStopping.html)，建议**不要使用 Quit 或 Close 按钮**​​来终止应用程序。而不是他们建议显示适当的信息来解释情况。

> iOS 应用从不显示关闭或退出选项。当人们切换到另一个应用程序、返回主屏幕或将他们的设备置于睡眠模式时，他们会停止使用一个应用程序。
> 
> 永远不要以编程方式退出 iOS 应用程序。人们倾向于将此解释为崩溃。如果某些事情阻止了您的应用程序按预期运行，您需要告诉用户这种情况并解释他们可以做些什么。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-12-10T14:04:15.663

除了以上，好，回答我只是想补充一下，想想清理一下你的记忆。

在您的应用程序退出后，iPhone OS 会自动清理您的应用程序留下的所有内容，因此手动释放所有内存只会增加您的应用程序退出所需的时间。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-09-17T11:56:38.873

```
- (IBAction)logOutButton:(id)sender
{
   //show confirmation message to user
   CustomAlert* alert = [[CustomAlert alloc] initWithTitle:@"Confirmation" message:@"Do you want  to exit?" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"OK", nil];
   alert.style = AlertStyleWhite;
   [alert setFontName:@"Helvetica" fontColor:[UIColor blackColor] fontShadowColor:[UIColor clearColor]];
   [alert show];
}
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{

   if (buttonIndex != 0)  // 0 == the cancel button
   {
      //home button press programmatically
      UIApplication *app = [UIApplication sharedApplication];
      [app performSelector:@selector(suspend)];
      //wait 2 seconds while app is going background
      [NSThread sleepForTimeInterval:2.0];
      //exit app when app is in background
      NSLog(@"exit(0)");
      exit(0);
  }
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-11-05T15:01:05.200

```
[[UIApplication sharedApplication] terminateWithSuccess]; 
```

它工作正常并自动调用

```
- (void)applicationWillTerminateUIApplication *)application delegate. 
```

删除编译时警告添加此代码

```
@interface UIApplication(MyExtras)
  - (void)terminateWithSuccess;
@end 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-11-24T23:44:08.760

我使用了上面提到的 [[NSMutableArray new] addObject:nil] 方法来强制退出（崩溃）应用程序，而无需调用 exit(0) 函数。

为什么？因为我的应用程序在所有网络 API 调用上使用证书固定来防止中间人攻击。这些包括我的金融应用程序在启动时进行的初始化调用。

如果证书身份验证失败，我的所有初始化调用都会出错并使我的应用程序处于不确定状态。让用户回家然后回到应用程序并没有帮助，因为除非应用程序已被操作系统清除，否则它仍然未初始化且不可信。

因此，在这种情况下，我们认为最好弹出警报，通知用户应用程序在不安全的环境中运行，然后当他们点击“关闭”时，使用上述方法强制退出应用程序。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-09-30T09:53:07.067

用户应该决定应用程序何时退出。我认为当应用退出时这不是一个好的用户交互。因此没有很好的API，只有主页按钮有一个。

如果有错误：更好地实施或通知用户。如果必须重新启动：更好地实施通知用户。

这听起来很愚蠢，但在不让用户决定并且不通知他的情况下退出应用程序是一种不好的做法。由于有一个用于用户交互的主页按钮，Apple 表示，同一个功能（退出应用程序）不应该有两个东西。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-01-27T14:57:13.910

退出主页按钮以外的应用程序**确实是非 iOS 风格的**方法。

不过，我做了这个助手，它不使用私人的东西：

```
void crash()
{ [[NSMutableArray new] addObject:NSStringFromClass(nil)]; } 
```

但就我而言，仍然不适合生产。它用于测试崩溃报告，或在 Core Data 重置后快速重启。如果功能留在生产代码中，只是确保不会被拒绝。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-10-12T16:55:35.503

如果一个应用程序是一个长期存在的应用程序，它也在后台执行，例如获取位置更新（为此使用*位置更新*后台功能），则退出应用程序可能是合适的。

例如，假设用户退出您的基于位置的应用程序，并使用主页按钮将应用程序推送到后台。在这种情况下，您的应用程序可能会继续运行，但完全退出它可能是有意义的。这对用户有好处（释放内存和其他不需要使用的资源），也有利于应用程序的稳定性（即确保应用程序在可能的情况下定期重启是防止内存泄漏和其他低内存的安全网问题）。

这可以（尽管可能不应该，见下文:-) 可以通过以下方式实现：

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{
    if (/* logged out */) {
        exit(0);
    } else {
       // normal handling.
    }
} 
```

由于应用程序随后会退出*后台*，因此在用户看来不会出错，也不会像崩溃一样，只要用户下次运行应用程序时恢复用户界面即可。换句话说，对于用户来说，当应用程序处于后台时，它与系统启动的应用程序终止没有什么不同。

不过，最好使用更标准的方法让系统知道应用程序可以终止。例如，在这种情况下，通过停止请求位置更新来确保 GPS 未在使用中，包括关闭在地图视图上显示当前位置（如果存在）。`[[UIApplication sharedApplication] backgroundTimeRemaining]`这样，系统将在应用程序进入后台几分钟（即）后终止应用程序。这将获得所有相同的好处，而无需使用代码来终止应用程序。

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{
    if (/* logged out */) {
       // stop requesting location updates if not already done so
       // tidy up as app will soon be terminated (run a background task using beginBackgroundTaskWithExpirationHandler if needed).
    } else {
       // normal handling.
    }
} 
```

当然，根据参考[http://developer.apple.com/iphone/library/qa/qa2008/qa1561.html](http://developer.apple.com/iphone/library/qa/qa2008/qa1561.html)`exit(0)`的其他答案，使用永远不适合在前台运行的普通生产应用程序

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-02-28T09:51:19.610

## Swift 4.2（或更早版本）

`Darvin`可以使用调用的库。

```
import Darwin

exit(0) // Here you go 
```

注意：这在 iOS 应用程序中不被推荐。

这样做会得到崩溃日志。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-11-21T16:36:52.170

在 iPadOS 13 中，您现在可以像这样关闭所有场景会话：

```
for session in UIApplication.shared.openSessions {
    UIApplication.shared.requestSceneSessionDestruction(session, options: nil, errorHandler: nil)
} 
```

这将调用`applicationWillTerminate(_ application: UIApplication)`您的应用程序委托并最终终止应用程序。

但要注意两点：

*   这当然不是用来关闭*所有*场景的。（见[https://developer.apple.com/design/human-interface-guidelines/ios/system-capabilities/multiple-windows/](https://developer.apple.com/design/human-interface-guidelines/ios/system-capabilities/multiple-windows/)）

*   它在 iPhone 上的 iOS 13 上编译并运行良好，但似乎什么也没做。

有关 iOS/iPadOS 13 中场景的更多信息：[https ://developer.apple.com/documentation/uikit/app_and_environment/scenes](https://developer.apple.com/documentation/uikit/app_and_environment/scenes)

# javascript - 在 javascript 中正确引用 html 列表项对象进行事件注册

> ID：355171
> 
> 赞同：1
> 
> 时间：2008-12-10T05:46:01.813
> 
> 标签：javascript, html, dom, event-handling, html-lists

如果我有例如以下 html 列表，我想知道如何引用列表项对象

```
<div id="subdiv_2">  
 <div id="subdiv_3">  
  <ul>  
   <li><a href="">Item1</a></li>  
   <li><a href="">Item2</a></li>  
   <li><a href="">Item3</a></li>    
  </ul>  
 </div>  
</div> 
```

如何在不需要唯一 elementId 的情况下将 onclick 注册到 Item2 li 例如，我可以为 subdiv_3 这样做，因为它具有唯一 ID 并且不在列表中

```
document.getElementById('subdiv_3').addEventListener('click', function();, false); 
```

我的目标最终是为每个列表对象分配一个函数，用于基于列表对象编号的具有唯一参数的列表对象的数量，例如：

```
for(i=0;i<list.length;i++){  
 "document.getElementById(list.item"+i+").addEventListener(\'click\',function("+i+");,false);";  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T05:59:04.033

你可以得到它的所有子`subdiv_3`元素`<li>`。然后迭代该循环，随时添加函数。

```
div = document.getElementById('subdiv_3');
els = div.getElementsByTagName('li');

for (var i=0, len=els.length; i<len; i++) {
    alert(i);  // add your functions here   
} 
```

查看您的代码示例，当您在创建函数的循环中时，您可能会遇到闭包范围问题。（所有函数似乎都使用相同的 i 值。）查看我对这个问题的回答以解决该问题：[如何在 Javascript 中将带有参数的事件处理程序添加到元素数组？](https://stackoverflow.com/questions/315712/how-to-add-event-handler-with-arguments-to-an-array-of-elements-in-javascript)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T07:52:03.947

@Supernovah：您实际上可以为`setTimeot()`. 这让你摆脱了字符串格式，当你想做比设置一个属性更复杂的事情时，它会阻碍你。

这是代码：

```
function attachToList() {
  var div = document.getElementById('menu2');
  var els = div.getElementsByTagName('li');
  // create a closure returning an anonymous inner function
  var fn  = function(li) {
    return function() {
      li.style.backgroundColor = "#FFFFCC";
    };
  };
  for (var i=0, len=els.length; i<len; i++) {
    // create function instance suitable for current iteration
    var changeLi = fn(els[i]);
    // pass function reference to setTimeout()
    setTimeout(changeLi, 250*i);
  }
} 
```

和一个简短的解释：

使用*闭包*是确保`setTimeout()`触发时所有变量仍然具有预期值的技巧。

您可以通过编写一个返回函数的函数来做到这一点。外部函数有参数，内部函数没有。但它*是指*外部函数的参数。在循环中，您调用外部函数（使用正确的参数）并每次都获得一个全新的内部函数，每个函数都有自己的参数值版本。这是您分配给 的那个`setTimeout()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T06:29:44.380

针对 Benry 对 Benry 的回答的评论，使用他的代码后，以下证明每个 elementLi 都可以用 els[i] 引用

```
function attachToList(){
div = document.getElementById('menu2');
els = div.getElementsByTagName('li');
for (var i=0, len=els.length; i<len; i++) {
setTimeout('els['+i+'].style.backgroundColor=\"#FFFFCC\";',(250*i));
}
} 
```

# c# - 如何设计具有复杂初始化的不可变对象

> ID：355172
> 
> 赞同：14
> 
> 时间：2008-12-10T05:46:52.733
> 
> 标签：c#, domain-driven-design, immutability

我正在学习 DDD，并且遇到了“价值对象”应该是不可变的声明。我了解这意味着对象状态在创建后不应更改。这对我来说是一种新的思维方式，但在很多情况下都是有意义的。

好的，所以我开始创建不可变的值对象。

*   我确保他们将整个状态作为构造函数的参数，
*   我不添加属性设置器，
*   并确保不允许任何方法修改内容（仅返回新实例）。

但现在我想创建这个包含 8 个不同数值的值对象。如果我创建一个有 8 个数字参数的构造函数，我觉得它不会很容易使用，或者更确切地说 - 在传递数字时很容易出错。这不可能是好的设计。

*所以问题是：*是否有任何其他方法可以使我的不可变对象变得更好.. 可以在 C# 中完成任何魔术来克服构造函数中的长参数列表？我很想听听你的想法。。

**更新：**在任何人提到它之前，这里已经讨论了一个想法： [C# 中的不可变对象模式 - 你怎么看？](https://stackoverflow.com/questions/263585/immutable-object-pattern-in-c-what-do-you-think)

不过，有兴趣听到其他建议或意见。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-10T05:56:33.230

使用构建器：

```
public class Entity
{
   public class Builder
   {
     private int _field1;
     private int _field2;
     private int _field3;

     public Builder WithField1(int value) { _field1 = value; return this; }
     public Builder WithField2(int value) { _field2 = value; return this; }
     public Builder WithField3(int value) { _field3 = value; return this; }

     public Entity Build() { return new Entity(_field1, _field2, _field3); }
   }

   private int _field1;
   private int _field2;
   private int _field3;

   private Entity(int field1, int field2, int field3) 
   {
     // Set the fields.
   }

   public int Field1 { get { return _field1; } }
   public int Field2 { get { return _field2; } }
   public int Field3 { get { return _field3; } }

   public static Builder Build() { return new Builder(); }
} 
```

然后像这样创建它：

```
Entity myEntity = Entity.Build()
                   .WithField1(123)
                   .WithField2(456)
                   .WithField3(789)
                  .Build() 
```

如果某些参数是可选的，则不需要调用 WithXXX 方法，它们可以具有默认值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-10T08:30:37.270

目前，您必须使用具有大量参数的构造函数或构建器。在 C# 4.0 (VS2010) 中，您可以使用命名/可选参数来实现类似于 C# 3.0 对象初始化器的功能 - 请参见[此处](http://marcgravell.blogspot.com/2008/11/immutability-and-optional-parameters.html)。博客上的例子是：

```
 Person p = new Person ( forename: "Fred", surname: "Flintstone" ); 
```

但是您可以很容易地看到类似的东西如何适用于任何构造函数（或其他复杂方法）。与 C# 3.0 对象初始化器语法（具有可变类型）相比：

```
 Person p = new Person { Forename = "Fred", Surname = "Flintstone" }; 
```

真的，没什么好区分的。

Jon Skeet 也在[这里](http://codeblog.jonskeet.uk/2008/03/15/c-4-immutable-type-initialization/)发表了一些关于这个主题的想法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T06:12:11.420

在我的脑海中，两个不同的答案浮现在脑海......

... 第一个，也可能是最简单的，是使用对象工厂（或构建器）作为帮助器，以确保您把事情做好。

对象初始化如下所示：

```
var factory = new ObjectFactory();
factory.Fimble = 32;
factory.Flummix = "Nearly";
var mine = factory.CreateInstance(); 
```

...第二个是将您的对象创建为具有 Lock() 或 Freeze() 函数的常规、可变对象。你所有的修改器都应该检查对象是否被锁定，如果有则抛出异常。

对象初始化如下所示：

```
var mine = new myImmutableObject();
mine.Fimble = 32;
mine.Flummix = "Nearly";
mine.Lock(); // Now it's immutable. 
```

采用哪种方法很大程度上取决于您的上下文 - 如果您有一系列相似的对象要构造，工厂的优点是方便，但它确实引入了另一个类来编写和维护。可锁定的对象意味着只有一个类，但其他用户可能会遇到意外的运行时错误，并且测试更加困难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T08:40:44.253

虽然它可能是您正在做的领域的一部分，因此我的建议可能无效，但尝试将 8 个参数分解为逻辑组怎么样？

每当我看到大量参数时，我都觉得对象/方法/构造器应该更简单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-06T06:23:40.867

我一直对同样的问题感到困惑，因为复杂的构造函数对我来说也是糟糕的设计。我也不是构建器概念的忠实拥护者，因为它似乎需要维护太多额外的代码。我们需要的是 popsicle 的不变性，这意味着一个对象一开始是可变的，你可以使用属性设置器。设置所有属性后，必须有一种方法可以将对象冻结为不可变状态。遗憾的是，C# 语言本身不支持此策略。因此，我最终设计了自己的模式来创建这个问题中描述的不可变对象：

[C# 中的不可变对象模式 - 你怎么看？](https://stackoverflow.com/questions/263585/immutable-object-pattern-in-c-what-do-you-think)

Anders Hejlsberg 在以下采访中从 36:30 开始谈论对这种类型不变性的支持：

[专家对专家：Anders Hejlsberg - C# 的未来](http://channel9.msdn.com/shows/Going%2BDeep/Expert-to-Expert-Anders-Hejlsberg-The-Future-of-C/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-26T13:17:18.313

您可以使用反射来初始化对象的所有字段，并使用惰性来制作类似“setter”的方法（使用单子函数样式），以便将设置的方法/函数链接在一起。

例如：

您可以使用这个基类：

```
public class ImmutableObject<T>
{
    private readonly Func<IEnumerable<KeyValuePair<string, object>>> initContainer;

    protected ImmutableObject() {}

    protected ImmutableObject(IEnumerable<KeyValuePair<string,object>> properties)
    {
        var fields = GetType().GetFields().Where(f=> f.IsPublic);

        var fieldsAndValues =
            from fieldInfo in fields
            join keyValuePair in properties on fieldInfo.Name.ToLower() equals keyValuePair.Key.ToLower()
            select new  {fieldInfo, keyValuePair.Value};

        fieldsAndValues.ToList().ForEach(fv=> fv.fieldInfo.SetValue(this,fv.Value));

    }

    protected ImmutableObject(Func<IEnumerable<KeyValuePair<string,object>>> init)
    {
        initContainer = init;
    }

    protected T setProperty(string propertyName, object propertyValue, bool lazy = true)
    {

        Func<IEnumerable<KeyValuePair<string, object>>> mergeFunc = delegate
                                                                        {
                                                                            var propertyDict = initContainer == null ? ObjectToDictonary () : initContainer();
                                                                            return propertyDict.Select(p => p.Key == propertyName? new KeyValuePair<string, object>(propertyName, propertyValue) : p).ToList();
                                                                        };

        var containerConstructor = typeof(T).GetConstructors()
            .First( ce => ce.GetParameters().Count() == 1 && ce.GetParameters()[0].ParameterType.Name == "Func`1");

        return (T) (lazy ?  containerConstructor.Invoke(new[] {mergeFunc}) :  DictonaryToObject<T>(mergeFunc()));
    }

    private IEnumerable<KeyValuePair<string,object>> ObjectToDictonary()
    {
        var fields = GetType().GetFields().Where(f=> f.IsPublic);
        return fields.Select(f=> new KeyValuePair<string,object>(f.Name, f.GetValue(this))).ToList();
    }

    private static object DictonaryToObject<T>(IEnumerable<KeyValuePair<string,object>> objectProperties)
    {
        var mainConstructor = typeof (T).GetConstructors()
            .First(c => c.GetParameters().Count()== 1 && c.GetParameters().Any(p => p.ParameterType.Name == "IEnumerable`1") );
        return mainConstructor.Invoke(new[]{objectProperties});
    }

    public T ToObject()
    {
        var properties = initContainer == null ? ObjectToDictonary() : initContainer();
        return (T) DictonaryToObject<T>(properties);
    }
} 
```

可以这样实现：

```
public class State:ImmutableObject<State>
{
    public State(){}
    public State(IEnumerable<KeyValuePair<string,object>> properties):base(properties) {}
    public State(Func<IEnumerable<KeyValuePair<string, object>>> func):base(func) {}

    public readonly int SomeInt;
    public State someInt(int someInt)
    {
        return setProperty("SomeInt", someInt);
    }

    public readonly string SomeString;
    public State someString(string someString)
    {
        return setProperty("SomeString", someString);
    }
} 
```

并且可以像这样使用：

```
//creating new empty object
var state = new State();

// Set fields, will return an empty object with the "chained methods".
var s2 = state.someInt(3).someString("a string");
// Resolves all the "chained methods" and initialize the object setting all the fields by reflection.
var s3 = s2.ToObject(); 
```

# audio - Flash 音频的循环问题

> ID：355178
> 
> 赞同：2
> 
> 时间：2008-12-10T05:51:07.827
> 
> 标签：audio, flash, dreamweaver

应我的客户的要求，我在她的网站上放了一首歌曲，设置为使用 flash 循环播放。swf 隐藏在侧边栏导航的表格内。出于某种原因，swf 在每次播放结束时翻倍，然后翻倍，等等。

我正在使用 Dreamweaver 和 Flash，并尝试了不同的参数组合：Flash 内部：事件循环，带流循环 内部 DW：循环打开和关闭

有没有人猜测为什么/是什么导致 swf 自行堆叠以及如何修复它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T05:59:44.237

回答我自己的问题：

需要将 for 循环的参数设置为 false，因为 swf 本身内置了一个循环。正确的组合是 Event:Loop（在 swf 内）和 DW 中的循环“假”。

# ajax - 使用 XMLHttpRequest 时权限被拒绝。打开跨浏览器访问

> ID：355185
> 
> 赞同：4
> 
> 时间：2008-12-10T05:56:27.253
> 
> 标签：ajax, xmlhttprequest

我正在尝试访问 XMLHTTPRequest.open 方法我什至包括了 netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");

但它仍然无法正常工作。

我正在使用 javascript 和 HTML 来访问 WebService。

任何帮助都会很棒

代码

```
 <html>
  <Head> 
    <Title>Calling A WebService from HTML </Title>
  </Head>

<Body onload='GetDataFrmWS()'>
  <form name="Form1" id="Form1" runat="server" method="post">
    <div id="DisplayData" > </div>
    <div id="Menu2"></div>

</form>

<script language='javascript'>

var objHttp;
var objXmlDoc;

function GetDataFrmWS()
{
  alert('I M Here');
  var func = getDataFromWS();

}

function getDataFromWS()
{

if(window.ActiveXObject)
  {
     try 
        {
        objHttp = new ActiveXObject('Msxml2.XMLHTTP');

```
 }
 catch (ex)
 {
  objHttp = new ActiveXObject('Microsoft.XMLHTTP');
 } 
```

}
 else if (window.XMLHttpRequest) 
 {
   objHttp = new window.XMLHttpRequest();
   netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
 }

strEnvelope = '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' +
'<soap:Body>' +
'  <HelloWorld xmlns="http://tempuri.org/">' +
'     <Dummy xsi:type="xsd:string">Hello</Dummy>'+
'  </HelloWorld>'+
'</soap:Body>' +
'</soap:Envelope>' ;

var szUrl;
szUrl = '[http://kamadhenu/Quoteme/GetCategories.asmx?op=HelloWorld](http://kamadhenu/Quoteme/GetCategories.asmx?op=HelloWorld)';
objHttp.onreadystatechange = HandleResponse;

objHttp.open('POST', szUrl, true);
objHttp.setRequestHeader('Content-Type', 'text/xml');
objHttp.setRequestHeader('SOAPAction','[http://tempuri.org/HelloWorld](http://tempuri.org/HelloWorld)');
objHttp.send(strEnvelope);

}

function HandleResponse()
{

if (objHttp.readyState == 4) 
 {

if (window.ActiveXObject)
   {
     objXmlDoc = new ActiveXObject("Microsoft.XMLDOM");
     objXmlDoc.async="false";
     objXmlDoc.loadXML(objHttp.responseText);
     var nodeSelect = objXmlDoc.getElementsByTagName("Menu1").item(0);
     var Menu2=objXmlDoc.getElementsByTagName("Menu2").item(0);
     document.getElementById('DisplayData').innerHTML=nodeSelect.text;

     document.getElementById('Menu2').innerHTML=Menu2.text; 
    }
  else
   {
    var Text=objHttp.responseText;
    var parser=new DOMParser();
    objXmlDoc = parser.parseFromString(Text,'text/xml');
    var Value=objXmlDoc.documentElement.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].nodeValue;
    var Menu2=objXmlDoc.documentElement.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0].nodeValue;
    var Menu3=objXmlDoc.documentElement.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[1].nodeValue;
    document.getElementById('DisplayData').innerHTML=Value;

    document.getElementById('Menu2').innerHTML=Menu2; 
    document.getElementById('Menu2').innerHTML+=Menu3; 
   }
 }

} 

</script>
  <input type='Button' Text='Click Me' onclick='GetDataFrmWS()' value="Click Me!"/>
  °
</Body>
</HTML> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T06:34:43.730

## XML HTTPRequest 的浏览器无关代码

我使用以下代码创建一个 XML 对象。它旨在处理所有浏览器（尤其是 IE 和非 IE）

```
/* Function to create an XMLHTTP object for all browsers */
function getXMLHTTPObject(){
    var xmlHttp;
    try{
        // Firefox, Opera 8.0+, Safari
        xmlHttp=new XMLHttpRequest();
    } catch (e){
        // Internet Explorer
        try{
            xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
        }catch (e){
            try{
                xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
            }catch (e){
                alert("Your browser does not support AJAX!");
                return false;
            }
        }
    }
    return xmlHttp;
}       
/* End Function */ 
```

PS您问题中的代码不可读。请格式化

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T13:21:54.943

据我所知，XMLHTTP 请求必须指向 html 页面的同一子域上的页面，以获得各种浏览器的权限。

一个技巧是在同一台服务器上以您的首选语言创建另一个页面，并使其处理服务器网络的请求。

例子：

从您的 HTML 页面向 mydomain.com/externalrequest.php?url=www.google.com 发出 ajax 请求，该页面将连接（fsock/cURL 等）到“url”并返回它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T13:24:13.987

如果您尝试使用 XHR 跨域，您可以查看 JSONP 方法。检查 JQuery 文档。

需要您接受 JSON 响应，但它确实可以跨域工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T06:19:14.523

[这里](http://www.codeproject.com/KB/webservices/WebServiceFromHTMLPage.aspx)有一个非常简洁的例子

尝试使您的 URL [http://recpushdata.cyndigo.com/Jobs.asmx/InsertXML](http://recpushdata.cyndigo.com/Jobs.asmx/InsertXML)

PS。您的代码在 StackOverflow 中不可读。

# c# - 将 N 元 B 样条转换为二次或三次 B 样条序列

> ID：355192
> 
> 赞同：2
> 
> 时间：2008-12-10T06:00:44.903
> 
> 标签：c#, algorithm, math, spline

我正在为 MOSA（所有 C# 操作系统之间的关联体）做一些 TTF 工作。我和 Colin Burn 目前正在努力让一些 TTF 代码正常工作（这些天我少了 :) - 他取得了很大进展）。

**在任何情况下，TTF 规范都允许在“句柄”和喘息**NO 句柄之间存在任意数量的控制点（TTF 有一个圆圈示例来演示它——干得好白痴——你节省了 10 个字节）。

谁能给我一个关于如何做到这一点的指针？我查看了 Wikipedia 上的 Bezier 文章，但并没有那么大的帮助 - 他们显示它正在发生，但没有给出任何数学。准备好“程序”的东西会有所帮助（我的微积分不是应该的） - 一些伪代码或其他东西。

多谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T06:29:45.253

从维基百科的[Bezier 文章](http://en.wikipedia.org/wiki/Bezier_curves)中，通过一些实用的微积分知识，您可以将公式转换为计算机程序，如下面的伪 C# 代码清单。我用二次样条做，但很容易翻译成另一个。

```
// Quadratic spline, with three given points
// B(t) = (1-t)^2P(0) + 2*tP(1) + t^2P(2)
// where T is a real number in the interval [0, 1]

public void DrawQuadSpline(Point p0, Point p1, Point p2, int steps) 
{
    Point next = p0;
    Point previous = p0;
    double tStep = 1 / ((float) steps);
    double t = 0;
    for (int i = 0; i < steps; i++) 
    {
        float x = CalculateQuadSpline(P0.x, P1.x, P2.x, t);
        float y = CalculateQuadSpline(P0.y, P1.y, P2.y, t);
        Point next = new Point(x, y);
        drawLine(previous, next);
        previous = next;
        t = t + tStep;
    }
} 

private void CalculateQuadSpline(float z0, float z1, float z2, float t) 
{
    return (1.0-t)*(1.0-t)*z0 + 2.0*t*z1 + t*t*z2;
} 
```

它可能需要一些调整，因为我以前只在 Java 中做过，但基本上就是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T07:25:48.417

我做了一些挖掘，并在[这个网站上](http://www.cs.technion.ac.il/~cs234326/projects/fonts/)找到了一些TTF 规范的[算法](http://www.cs.technion.ac.il/~cs234326/projects/fonts/Methods.htm)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T20:47:15.957

好的，看起来 TTF 轮廓被定义为二次 b 样条。

您需要熟悉两种算法。

第一个是通过节点插入提取贝塞尔曲线。这将为您提供二次贝塞尔线段。然后，您需要对每个 Bezier 段进行度数提升以获得三次方。

我使用的主要参考资料是我的在线 CAGD 课本。贝塞尔提取在[第 6.3 节](http://cagd.cs.byu.edu/~557/text/ch6.pdf)中介绍。贝塞尔曲线的度数在[2.4 节](http://cagd.cs.byu.edu/~557/text/ch2.pdf)中介绍。让我知道如果你有任何问题..

# iis - 除了 80，我们还可以使用哪个端口来运行 IIS？

> ID：355196
> 
> 赞同：30
> 
> 时间：2008-12-10T06:03:44.960
> 
> 标签：iis, port

当我启动像 Skype 这样的应用程序时，IIS 不起作用，因为它也使用端口 80。

除了 80，我还可以使用哪个端口来运行 IIS？（8080不行）

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-12-10T06:05:30.887

您可以在任何您喜欢的端口上运行 IIS，只要它不与其他应用程序冲突。我正在使用 88、8888 和其他容易记住的端口。

您可以在此处找到常用端口：[PORT NUMBERS](http://www.iana.org/assignments/port-numbers)，选择未分配的 TCP 端口更安全。

引用：

> 动态和/或专用端口是从 49152 到 65535 的端口

如果 IIS 正在工作并且您在使用 ASP.NET 应用程序时遇到问题，那么这些链接可能会有所帮助：

*   [如何：为 ASP.NET 版本配置 ASP.NET 应用程序](http://msdn.microsoft.com/en-us/library/1kdfe21k.aspx)
*   [ASP.NET 和 IIS 配置](http://msdn.microsoft.com/en-us/library/ms178477.aspx)
*   [ASP.NET IIS 注册工具 (Aspnet_regiis.exe)](http://msdn.microsoft.com/en-us/library/k6h9cz8h(VS.80).aspx)
*   [IIS 和 ASP.NET：应用程序池](http://www.developer.com/net/asp/article.php/2245511)

如果您仍然遇到问题，提供有关您的环境的更多信息、迄今为止为解决问题所采取的步骤以及重新标记问题会很有帮助（例如，附加 asp.net）

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-10T08:05:36.667

好吧，您可以禁用 Skype 以使用端口 80。单击工具 --> 选项 --> 高级 --> 连接并取消选中相应的复选框。![Skype 截图](https://lh5.ggpht.com/_XjcDyZkJqHg/TE7RS65LwkI/AAAAAAAAAFQ/n94H4apNXvE/Skype%20port%2080%20usage%5B7%5D.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-10T06:16:46.637

端口 8080 可能已被您计算机中的另一个进程使用。

在命令提示符下执行`netstat`以找出正在使用它的服务器/进程。

看看这个页面（[http://en.wikipedia.org/wiki/Port_number](http://en.wikipedia.org/wiki/Port_number)）它​​为您提供了有关如何使用端口号的完整说明

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-10T07:35:02.967

另请记住，在备用端口上运行时，您需要在 URL 上指定端口：

[http://www.example.com:8080](http://www.example.com:8080)

根据您的环境，可能需要考虑防火墙或代理服务器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T06:05:18.577

您可以在 IIS Mgr 中将 IIS 配置为使用 1 到 65535 之间的每个端口，只要它不被任何其他应用程序使用

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T07:48:15.657

阻止 Skype 使用端口 80：http: [//forum.skype.com/lofiversion/index.php/t15582.html](http://forum.skype.com/lofiversion/index.php/t15582.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-09T11:08:37.783

我将做一些假设并从不同的角度来解决这个问题......因为你已经在同一台机器上安装并运行了Skype，它不是生产机器而是用于测试/开发？

如果是这样，您可能希望完全查看 IIS 的替代方案以缓解您的问题。如果您使用 IISExpress 或最新版本的 Visual Studio 中内置的 Web 服务器，它们会自动为您选择一个端口。

当然，这确实意味着它对于授予其他人访问权限并不是特别有用，但对于个人使用的本地开发来说很好。

我认为其他答案在大多数情况下可能会提供更好的选择，但这可能会提供不同的见解。

这是 IIS Express 的介绍：[http ://learn.iis.net/page.aspx/860/iis-express/](http://learn.iis.net/page.aspx/860/iis-express/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-01-23T20:59:43.817

您必须首先配置端口，例如 127.0.0.1:91，然后您需要允许从 windows 防火墙->>高级设置->>入站规则->>新规则访问端口 91。然后检查端口->>分配新端口（91）。然后旁边就完成了。在此之后 127.0.0.1:91 应该可以从 Web 访问。

# mysql - MySQL 复制：暂时阻止特定的 SQL 语句复制到从站？

> ID：355202
> 
> 赞同：7
> 
> 时间：2008-12-10T06:07:34.033
> 
> 标签：mysql, replication

我想连接并执行一个（或有时几个）SQL 语句，而不是将这些语句复制到从站。

我没有复制做或复制忽略配置，所以我不能从`use`一些非复制数据库发送命令。我知道：

```
set global sql_slave_skip_counter = 1 
```

但那是在奴隶身上。我希望能够在主服务器上运行类似的命令，并且不会将以下 N 个命令发送到从服务器（我猜这意味着也没有登录到二进制日志中）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-10T06:42:36.927

`SET sql_log_bin=0`就是你要找的。需要超级权限，并且会关闭会话中的命令日志记录，直到您将其设置回 1。请参阅[http://dev.mysql.com/doc/refman/5.0/en/server-session-variables.html# sysvar_sql_log_bin](http://dev.mysql.com/doc/refman/5.0/en/server-session-variables.html#sysvar_sql_log_bin)

```
SET sql_log_bin=0;
UPDATE ... ;
INSERT ... ;
DELETE ... ;
SET sql_log_bin=1 ; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-08T19:16:02.070

当心.....！

`SET sql_log_bin=0;`

一段时间后（大约一分钟后），主 MySQL 服务器自动将此 0 值设置为 1。它不会等到我们明确将其设置为 1。所以根据我的经验，这根本不是关闭二进制日志记录的安全方法......！

# javascript - 方法：=> :delete 不起作用并且 :confirm 选项被忽略

> ID：355212
> 
> 赞同：8
> 
> 时间：2008-12-10T06:13:52.180
> 
> 标签：javascript, ruby-on-rails

返回到旧的 Rails 项目后，我发现没有任何销毁/删除链接起作用，并且单击确认弹出窗口上的取消仍然会提交链接。

我的代码示例是：

```
<%= link_to 'Delete', admin_user_path(@user), :confirm => 'Are you sure?', :method => :delete %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-01-20T01:21:50.450

如果您使用的是 jQuery，则会出现此问题，如果没有，请查找类似的内容：

就我而言，我使用的是：

javascript_include_tag :all %>

它不起作用，但是当我这样说时：

javascript_include_tag :默认值 %>

有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-06T14:20:34.980

克里斯，嗨。我有同样的问题。我删除了 Firebug，问题仍然存在。我从另一个用户那里读到他需要重新启动 Firefox，但这也不起作用。有人说试试 Safari，那也没用。

最后这是一个新手：

我有帮助插入一个图标，比如edit_icon，它为编辑图标返回一个漂亮的图像标签等。

这些辅助方法之一是 delete_icon 方法，我这样写：

def delete_icon(object=nil) link_to image_tag('icons/delete.jpg', :width => 20, :border=>0), object, :confirm => 'Are you sure?', :method => :delete结尾

这是对 DRY 的（很好的）尝试，但如果我只有 def delete_icon(object)，而不是 object=nil，那就更好了，因为当我调用它时，它更清楚我必须将对象传递给它以销毁. 对要删除的对象调用相同的方法对我有用。

简而言之：如果您尝试 DRY，请仔细检查您的辅助方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-17T02:48:20.897

就我而言，这似乎是原型和 rails.js 的旧组合的问题。这个问题的答案让我想到：[使用 Rails 3 和 jQuery UJS 时忽略 Rails 中的 :confirm 选项](https://stackoverflow.com/questions/2879545/confirm-option-in-rails-being-ignored-while-using-rails-3-and-jquery-ujs)

所以我从 https://github.com/rails/prototype-ujs/raw/master/src/rails.js 下载了最新的 rails.js，从[https://ajax.googleapis.com/ajax/libs](https://ajax.googleapis.com/ajax/libs/prototype/1.7.0.0/prototype.js)[下载](https://github.com/rails/prototype-ujs/raw/master/src/rails.js)了最新的原型[/prototype/1.7.0.0/prototype.js](https://ajax.googleapis.com/ajax/libs/prototype/1.7.0.0/prototype.js)。

现在一切似乎都按预期工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-26T05:57:44.733

这是一种使用 jQuery 为所有删除按钮提供相同确认的方法：

```
;(function($){
  $(function(){
    $('input.destroy').click(function(){
      return confirm($(this).attr('data-confirm'));
    });
  });
})(jQuery); 
```

您只需要确保将 class="destroy" 添加到每个元素，例如：

```
= button_to 'Delete', polygon, :method => :delete, :class => "destroy", :confirm => "Are you sure?" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-06T17:58:37.743

大多数情况下，这是因为您在加载 jQuery 代码之前调用它，或者在页面中的元素存在之前调用它。

为了对抗这种情况，请使用以下方法：

```
$(document).ready(function () {
  $('*[data-confirm]').click(function(){
    return confirm($(this).attr('data-confirm'));
  });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-29T12:12:46.753

这是快速解决方案 - 只需将conform替换为data-confirm

```
<%= link_to 'Delete', admin_user_path(@user), 'data-confirm' => 'Are you sure?', :method => :delete %> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-21T08:04:38.163

尝试使用

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script> 
```

前

```
<%= javascript_include_tag "application" %> 
```

在您的布局中，并删除

```
//= require jquery 
```

在你的**application.js**行。

我就是这种情况。不知道为什么它不适用于原始 rails jquery.js 文件。

# subdomain - 我是否应该将我的网站默认为 www.foo？

> ID：355217
> 
> 赞同：24
> 
> 时间：2008-12-10T06:15:43.877
> 
> 标签：subdomain, bare-domain

请注意 stackoverflow 的默认域是[http://stackoverflow.com](http://stackoverflow.com)，如果您尝试转到[http://www.stackoverflow.com](http://www.stackoverflow.com)它会将您弹回[http://stackoverflow.com](http://stackoverflow.com)？

这是什么原因？不是技术原因（如 http 代码等），而是网站所有者为什么要这样做？

我知道这纯粹是美学的，我总是有 www 和没有的主机标题，但是有理由将用户反弹到单个域，是否有子标题？

## 更新 1

## 没有子域称为*裸域*。谢谢窥视！从来不知道它有一个术语:) 更新 2

感谢您到目前为止的回答 - 请注意，我了解[www.domain.com](http://www.domain.com)可以指向 domain.com。这不是关于我是否应该提供两者或其中一个/或的问题，它是在询问为什么某些站点默认为裸域而不是 www 子域，反之亦然。干杯。

杰夫阿特伍德实际上已经解释了为什么他[在这里](https://blog.stackoverflow.com/2008/06/dropping-the-www-prefix/)和[这里](https://blog.codinghorror.com/the-great-dub-dub-dub-debate/)选择裸域。（向[乔纳斯·佩格福克致意](https://stackoverflow.com/users/1918/jonas-pegerfalk)：）

Jeff 的帖子（以及该线程中的其他帖子）还讨论了带有 cookie 和静态图像的裸域的问题。基本上，如果您在裸域中打开了 cookie，那么所有子域也会被强制执行。解决方案是购买另一个域，正如[Yahoo Perf 团队在此处](http://developer.yahoo.com/performance/rules.html#cookie_free)发布的那样。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-10T07:56:20.117

Jeff Atwood 写了一篇关于[The Great Dub-Dub-Dub 辩论](https://blog.codinghorror.com/the-great-dub-dub-dub-debate/)的精彩文章。Stackoverflow 博客中还有一篇关于 Stackoverflow 为何以及如何[删除 www 前缀](https://stackoverflow.blog/2008/06/14/dropping-the-www-prefix/)的博客条目。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-10T06:25:51.093

据我所知，这并不重要，但你应该选择一个或另一个作为默认值，然后转发。

原因是，根据浏览器的实现，`www.example.com`cookie 并不总是可以访问`example.com`（或者相反？）

有关这方面的更多讨论，请参阅：

**赞成 www**

*   [http://faq.nearlyfreespeech.net/section/domainnameservice/baredomain#baredomain](http://faq.nearlyfreespeech.net/section/domainnameservice/baredomain#baredomain) - 这个虚拟主机列出了几个很好的理由，让任何考虑做比简单虚拟主机更多的人考虑（例如负载平衡、具有不同内容的子域等）

*   [http://yes-www.org](http://web.archive.org/web/20080107105728/www.yes-www.org/www-is-not-deprecated/) - 这篇 2005 年的博文主要提出大多数互联网用户需要`www`前缀才能识别 URL。既然浏览器具有内置搜索功能，这一点就不那么重要了。我知道的大多数计算机文盲都完全绕过了 URL 栏。

**反对 www**

*   [http://no-www.org/](http://no-www.org/)

**以及**关于为什么 www 不应该用作`CNAME`，而只能用作`A RECORD`.

*   [http://member.dnsstuff.com/rc/index.php?option=com_myblog&task=view&id=62&Itemid=37](http://wayback.archive.org/web/20071025092434/http://member.dnsstuff.com/rc/index.php?option=com_myblog&task=view&id=62&Itemid=37)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-10T06:40:01.847

值得注意的是，您不能在 DNS 中的同一（裸域）名称上拥有 CNAME 和 NS 记录。因此，如果您使用 CDN 并且需要为您的 Web 服务器设置 CNAME 记录，那么如果您使用的是裸域，则无法执行此操作。您必须使用“ `www`”或其他前缀。

话虽如此，我更喜欢不带“”前缀的 URL，`www.`因此我对所有网站都使用裸域。（我不需要 CDN。）

当我提到面向公众的 URL 时（例如，在名片上），我觉得必须使用*前缀*`www.`或*前缀*`http://`。否则，仅仅一个裸域名并不能告诉人们他们一定可以在浏览器中输入它。所以，因为我认为`http://`名片上有一个丑陋的疣，我确实在`www.`那里使用了前缀。

真是一团糟。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T06:30:25.360

在某些情况下，www 可能确实指向大型企业环境中完全独立的子域。尤其是在内部网络上，如果网站是在外部托管的（例如，在德克萨斯州的 Rackspace，但其他一切都在您在弗吉尼亚州的办公室），那么使用显式 www 可以更容易地拆分 DNS。在大多数情况下，这并不重要。 .

重要的是**选择一个**并为您的平台添加 IHttpModule、重写规则或等效项，以将请求从一个永久重定向到另一个。

如果您没有通配符证书并且忘记根据您的站点名称显式重定向（您可能不这样做，因为您希望您的代码在两个开发人员中都可以工作，那么在从 http 切换到 https 时，两者都可能会导致可怕的证书警告和生产，所以你正在使用一些由服务器填充的变量）。

更重要的是，在搜索引擎中看到重复内容的结果都被接受了——你会因为有重复的内容而受到指责，而且你会因为你的点击被分成两个不同的 URI 而受到指责，从而损害了你的排名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T06:19:12.183

实际上你可以同时使用它们。所以最好找到用户你的地址或一些。我的意思是实际上这并不重要:)

但是把 www 作为前缀在公共场合更常见，所以我想我更喜欢在它后面使用 www。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T06:27:44.553

键入 google.com 比键入 www.google.com 更容易，因此请选择两者。请记住，www 只是一个子域。

这些天也没有 www 是司空见惯的，所以也许让 www.foo.com 重定向到 foo.com。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T06:31:48.523

我认为一个原因是帮助提高搜索排名，以便每个页面只有一个页面获得排名，而不是在两个域之间拆分。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-10T06:34:48.080

我不确定为什么 StackOVerflow 团队决定只使用一个，但如果是我，我会为了简单起见。您必须同时考虑这两种情况，因为很多人默认输入 www 或出于习惯（我敢肯定不太“技术含量高”的人不知道有区别）。

除此之外，就搜索引擎而言，过去存在差异，因此人们担心重复内容惩罚或链接声誉分裂。但这早已被处理，因此目前没有太多考虑。

所以我想说保持简单是个人喜好。

# c - 在 C 中定义 const 值

> ID：355220
> 
> 赞同：5
> 
> 时间：2008-12-10T06:16:35.340
> 
> 标签：c, constants, header-files, code-organization

我有一个 C 项目，其中所有代码都组织在`*.c`/`*.h`文件对中，我需要在一个文件中定义一个常量值，但是它也将用于其他文件。我应该如何声明和定义这个值？

应该`static const ...`和`*.h`文件里的一样吗？如`extern const ...`在`*.h`文件中并在文件中定义`*.c`？如果值不是原始数据类型（`int`,`double`等），而是 a`char *`或 a ，这有什么关系`struct`？（虽然在我的情况下它是一个`double`。）

通常，在文件中定义东西`*.h`似乎不是一个好主意。应该在文件中声明事物`*.h`，但在文件中定义它们`*.c`。但是，这种`extern const ...`方法似乎效率低下，因为编译器无法内联该值，而是必须始终通过其地址访问它。

我想这个问题的本质是：是否应该在 C`static const ...`中的文件中定义值`*.h`，以便在多个地方使用它们？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-10T06:46:18.853

我遵循的规则是只在 H 文件中声明事物并在 C 文件中定义它们。您可以在单个 C 文件中声明和定义，假设它只会在该文件中使用。

通过声明，我的意思是通知编译器它的存在，但不为其分配空间。这包括`#define`、`typedef`、`extern int x`等。

定义为声明分配值并为它们分配空间，例如`int x`和`const int x`。这包括函数定义；将这些包含在头文件中经常会导致代码空间的浪费。

我见过太多初级程序员`const int x = 7;`在输入头文件时感到困惑，然后想知道为什么他们会因为`x`多次定义而出现链接错误。我认为至少，您需要`static const int x`避免这个问题。

我不会太担心代码的速度。很久以前，计算机的主要问题（在速度和成本方面）从执行速度转移到易于开发。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T23:14:50.980

如果您需要常量（真实的，编译时常量），您可以通过三种方式进行操作，将它们放入头文件中（这没什么不好）：

```
enum {
    FOO_SIZE = 1234,
    BAR_SIZE = 5678
};

#define FOO_SIZE 1234
#define BAR_SIZE 5678

static const int FOO_SIZE = 1234;
static const int BAR_SIZE = 5678; 
```

在 C++ 中，我倾向于使用枚举方式，因为它可以限定在命名空间中。对于 C，我使用宏。不过，这基本上归结为品味问题。如果需要浮点常量，就不能再使用枚举了。在 C++ 中，我使用最后一种方式，即 static const double，在这种情况下（注意在 C++ 中静态将是多余的；它们会自动变为静态，因为它们是 const）。在 C 中，我会继续使用宏。

使用第三种方法会以任何方式减慢您的程序，这是一个*神话。*我只是更喜欢枚举，因为你得到的值是右值——你不能得到它们的地址，我认为这是一个额外的安全。此外，编写的样板代码要少得多。眼睛集中在常数上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T07:28:10.953

你真的需要担心内联的优势吗？除非您正在编写嵌入式代码，否则请坚持可读性。如果它真的是一个神奇的数字，我会使用定义；我认为 const 更适合 const 版本字符串和修改函数调用参数。也就是说，.c 中的定义，.h 中的声明规则绝对是一个相当普遍接受的约定，我不会仅仅因为您*可能会*节省内存查找而破坏它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T07:53:24.617

作为一般规则，您不会像`static`在标题中那样定义事物。如果您确实在标头中定义`static`变量，则使用标头的每个文件都会获得其自己声明的任何内容的私有副本`static`，这与**DRY**原则相反：*不要重复自己*。

因此，您应该使用替代方案。对于整数类型，使用 enum（在头文件中定义）非常强大；它也适用于调试器（尽管更好的调试器也可以帮助处理`#define`宏值）。对于非整数类型，头文件中的`extern`声明（可选地用 限定`const`）和一个 C 文件中的单个定义通常是最好的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T06:26:14.823

我可以给你一个间接的答案。在 C++（与 C 相对）中`const`意味着`static`. 也就是说，在 C++`static const`中与`const`. 这样就可以告诉您 C++ 标准机构对这个问题的看法，即所有`const`s 都应该是静态的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T06:29:07.483

我想为您的问题查看更多背景信息。值的类型很关键，但您忽略了它。C 中 const 关键字的含义相当微妙；例如 const char *p; 并不意味着指针 p 是一个常数；你可以随心所欲地写p。你不能写的是 p 指向的内存，即使 p 的值发生变化，这仍然是正确的。这是我真正理解的唯一案例；一般来说，我不知道 const 的微妙位置的含义。但是这种特殊情况对于**函数参数**非常有用，因为它从函数中提取参数指向的内存不会被改变的承诺。

每个人都应该知道另一种特殊情况：整数。几乎总是，常量，命名整数应该在 .h 文件中定义为**枚举文字**。枚举类型不仅允许您以自然的方式将相关常量组合在一起，而且还允许您在调试器中看到这些常量的名称，这是一个巨大的优势。

我写了几万行C；如果我试图追踪它，可能有数百个。（wc ~/src/c/*.c 说 85000，但其中一些是生成的，当然还有很多 C 代码潜伏在其他地方）。除了这两种情况之外，我从来没有发现 const 有什么用处。我很高兴学习一个新的有用的例子。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T08:26:59.807

对于 autoconf 环境：您也可以始终在配置文件中定义常量。AC_DEFINE() 我猜是在整个构建中定义的宏。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-10T12:36:36.977

要回答您问题的本质：
您通常**不想**在头文件中定义静态变量。
这将导致您在包含标题的每个翻译单元（C 文件）中都有重复的变量。

标头中的变量实际上应该声明为 extern，因为这是隐含的可见性。请参阅[此问题](https://stackoverflow.com/questions/92546/variable-declarations-in-header-files-static-or-not)以获得很好的解释。

实际上，情况可能并不那么可怕，因为编译器可能会将 const 类型转换为文字值。但是您可能不想依赖这种行为，尤其是在关闭优化的情况下。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-11T00:40:16.080

在 C++ 中，您应该始终使用

```
const int SOME_CONST = 17; 
```

对于常量，从不

```
#define SOME_CONST 17 
```

定义几乎总是会在以后回来咬你。常量在语言中，并且是强类型的，所以你不会因为一些隐藏的交互而得到奇怪的错误。我会将 const 放在适当的头文件中。只要它是#pragma once（或#ifndef x / #define x / #endif），你就不会得到任何编译错误。

在 vanilla C 中，您可能会遇到必须使用#defines 的兼容性问题。

# ruby - rake undefined exitstatus in nil:Nilclass

> ID：355228
> 
> 赞同：0
> 
> 时间：2008-12-10T06:18:36.553
> 
> 标签：ruby, rake

我正在尝试在新机器上运行 rake（原始机器工作正常）。. 运行我的 this 后，我收到一条错误消息。.

*rake aborted undefined method exitstatus for nil:nilClass*

关于我如何看到这里发生了什么的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T07:41:22.673

从 rake --trace 开始

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T18:03:12.793

我想到了 。. 愚蠢的错误。. 我是从命令提示符运行的.. 不是 VS 命令提示符，所以它无法识别 msbuild 任务

# .net - 有没有办法以编程方式更改几个文本框的只读属性

> ID：355248
> 
> 赞同：0
> 
> 时间：2008-12-10T06:31:30.130
> 
> 标签：.net

有没有办法在.net中以编程方式更改几个文本框的只读属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T07:48:28.137

假设您的文本框都以相同的前缀开头并且存在于页面控件集合中：

```
string commonTextBoxPrefix = "txt";
foreach (Control c in this.Controls)
{
    if (c.GetType() == typeof(TextBox) &&
        c.Name.StartsWith(commonTextBoxPrefix))
    {
        ((TextBox)c).ReadOnly = True;
    }
} 
```

不过，这不会递归整个控制层次结构:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T07:03:37.960

Yes there is.

Add each textbox to an array, and then loop through the array changing the attributes.

For example:

```
Dim textBoxes() As TextBox = {TextBox1, TextBox2, TextBox3}
For Each item As TextBox In textBoxes
    item.ReadOnly = True
Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T06:33:39.847

您可以将它们作为数组加载并使用循环更改它们

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T06:35:02.120

是的，

```
txt.Attributes["ReadOnly"] = "true"; 
```

只需为此使用一个循环:)

或者您的控件标签中没有该属性。

您可以使用该代码

```
txt.Attributes.Add("ReadOnly","true"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T06:35:43.947

您可以将文本框的名称加载到列表中并以这种方式更改它们，或者将文本框对象加载到列表中并更改它们。

```
foreach(TextBox txt in List<TextBox>)
{
    txt.ReadOnly = true;
} 
```

# c++ - 为什么 const 成员必须在构造函数初始化器中而不是在其主体中初始化？

> ID：355258
> 
> 赞同：69
> 
> 时间：2008-12-10T06:35:35.600
> 
> 标签：c++, constructor, initialization, constants

为什么声明为的类成员必须`const`在构造函数初始化器列表中而不是在构造函数体中进行初始化？

两者有什么区别？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-12-10T07:01:22.537

在 C++ 中，当执行进入构造函数的主体时，对象被认为是完全初始化的。

你说：

> “我想知道为什么 const 必须在构造函数初始化列表而不是它的主体中初始化？”

您缺少的是**初始化**发生在初始化列表中，而**赋值**发生在构造函数的主体中。逻辑步骤：

1) 一个 const 对象只能被初始化。

2) 一个对象的所有成员都在初始化列表中初始化。即使您没有在那里显式初始化它们，编译器也会很乐意为您这样做:-)

3) 因此，将 1) 和 2) 放在一起，const 成员只能在初始化时分配一个值，这发生在初始化列表期间。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-10T06:57:16.553

`const`并且引用变量必须在它们被声明的那一行被初始化。

```
 class Something  
 {  
     private:  
      const int m_nValue;  
     public:  
      Something()  
      {  
          m_nValue = 5;  
      }  
  }; 
```

将产生等效于的代码；

```
const int nValue; // error, const vars must be assigned values immediately  
nValue = 5; 
```

在构造函数的主体中分配 const 或引用成员变量值是不够的。

C++ 提供了另一种初始化成员变量的方法，允许在创建成员变量时而不是之后初始化成员变量。这是通过使用初始化列表来完成的。

您可以通过两种方式为变量赋值：显式和隐式：查看纯副本到剪贴板打印？

```
int nValue = 5; // explicit assignment  
double dValue(4.7); // implicit assignment 
```

使用初始化列表与进行隐式赋值非常相似。

请记住，用于初始化基本数据对象和成员数据对象的成员初始化列表位于定义中，而不是构造函数的声明中。

更多关于[cpp-tutorial](http://www.learncpp.com/cpp-tutorial/101-constructor-initialization-lists/)和[Code Wrangler](http://codewrangler.home.comcast.net/~codewrangler/tech_info/ctor_init.html)的信息。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2016-08-12T09:05:28.203

因为常量变量和引用必须在声明时即使用前进行初始化。但是构造函数会将值分配给变量而不是初始化变量，因此您必须使用 initailizier 列表来获取常量和引用

# asp.net - 之间的区别 和 ?

> ID：355261
> 
> 赞同：207
> 
> 时间：2008-12-10T06:36:51.540
> 
> 标签：asp.net, iis-7, web-config

每次我必须使用 IIS7 为 ASP.NET 添加处理程序或模块时，说明总是告诉我将其合并为两个部分：`system.web`和`system.webserver`.

```
<system.web>
    <httpHandlers>
    </httpHandlers>
    <httpModules>
    </httpModules>
</system.web> 
```

和这个：

```
<system.webServer>
    <modules>
    </modules>
    <handlers>
    </handlers>
</system.webServer> 
```

这两个部分有什么区别？

此外，如果我不将其添加到该`system.web`部分，我的 Visual Studio 2008 调试器也无法正常工作。

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2008-12-10T06:59:25.550

The system.web section is for configuring IIS 6.0, while the system.webserver version is used to configure IIS 7.0\. IIS 7.0 includes a new ASP.NET pipeline and some configuration differences, hence the extra config sections.

However...

If you're running IIS 7.0 in integrated mode only, you shouldn't need to add the handlers to both sections. Adding it to system.web as well is a fallback for IIS 7.0 operating in classic mode, unless I'm mistaken. I've not done extensive testing on this.

See [http://msdn.microsoft.com/en-us/library/bb763179.aspx](http://msdn.microsoft.com/en-us/library/bb763179.aspx) for more information.

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-12-10T06:59:42.010

The former is for Classic Mode.

The latter is for Integrated Pipeline Mode (available in IIS7+).

# perl - 如何为 CGI 脚本的模块设置 Perl 的包含路径？

> ID：355267
> 
> 赞同：8
> 
> 时间：2008-12-10T06:41:47.567
> 
> 标签：perl, path, cgi, module

我的主机上安装了几个 Perl 模块`~/perl`，如何将它们添加到 Perl 模块路径？设置`PERL5LIB`或`unshift`ing 路径`@INC`肯定有效，但环境变量在作为 CGI 脚本运行时无济于事，而且这种`@INC`方式不是很便携。有没有更好的办法？这一定是一个普遍的问题，我错过了什么吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-10T06:57:55.443

一种更清洁的方法是：

```
use lib "/path/" ; 
```

还有其他有趣且好的方法可以在这里找到：

[http://www.slideshare.net/pfig/cpan-training-presentation/](http://www.slideshare.net/pfig/cpan-training-presentation/)

另外，关于：CGI 脚本，您可以为您的 CGI 环境定义 PERL5LIB 路径，这仅取决于您的网络主机。

一些 Webhosts 允许对 CGI 环境的 env 变量进行特定控制，您只需设置它们，其他人可能有一个“允许”列表，允许在启动时可见的变量出现在本地范围内。

可能有助于了解如何在您的特定 HTTP 服务器上执行此操作。

如果设置 ENV 不符合您的口味，还有另一种选择：[local::lib](http://search.cpan.org/~mstrout/local-lib-1.002000/lib/local/lib.pm)

它会自动搜索一些预定义的路径。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-10T15:05:56.723

PERL5LIB 适用于 CGI 脚本。您只需将变量设置在正确的位置，例如服务器配置。您使用的是哪个网络服务器？对于 Apache，我使用[mod_env](http://httpd.apache.org/docs/1.3/mod/mod_env.html)中的 SetEnv 指令。

@INC 是可移植的。您输入的路径在每台机器上可能都不相同，但变量本身不应该有问题。

您是否阅读了[perlfaq8](http://faq.perl.org/perlfaq8.html)中的常见问题解答条目：

*   [如何将我的程序所在的目录添加到模块/库搜索路径中？](https://stackoverflow.com/questions/355267/how-can-i-set-perls-inclusion-path-for-modules)
*   [如何在运行时将目录添加到我的包含路径 (@INC)？](http://faq.perl.org/perlfaq8.html#How_do_I_add_the_dir)

# iphone - Downloading the gzip file and Uncompressing to retrieve Content using IPHONE SDK on iphone and ipod touch devices

> ID：355280
> 
> 赞同：1
> 
> 时间：2008-12-10T06:48:22.750
> 
> 标签：iphone, file, download, gzip, compression

I had the following questions related to downloading the file from the server.

a) Is it possible to download directly the GZIP (Compressed)file to the iphone device using IPHONE SDK. b) If the compressed file can be downloaded , then how to uncompress it(using ZLIB or else...).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T08:23:24.070

对此完全不确定，但如果它的 http 使用 gzip 编码，那么很可能会为您自动解压缩 - 作为 http 协议的一部分 - 猜测并且需要进行测试。也可能不适合您的情况。

# c# - 在 ASP.NET 站点上记录用户操作？

> ID：355282
> 
> 赞同：0
> 
> 时间：2008-12-10T06:49:25.493
> 
> 标签：c#, asp.net, logging

我想要的是记录用户调用的方法及其返回值（如果有的话）的系统。例如，用户登录并且他/她正在我的网络应用程序上冲浪。然后他/她自然会点击某些东西，因此他/她会启动一些事件方法，然后我的日志系统必须将此方法名称和时间戳以及用户登录名或 ID 记录到数据库中。

那么我怎么能在asp.net中做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T07:00:41.163

好吧，*最简单*的方法就是使用[Log4Net](http://logging.apache.org/log4net/index.html)之类的日志框架将所有日志语句添加到您的代码中。如果您想要一种更自动的方式来执行此操作，您可能需要查看[PostSharp](http://www.sharpcrafters.com)以便您可以使用属性装饰适当的方法 - 但这肯定更复杂，并且可能只有在您有很多事件时才值得日志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T07:15:28.937

您可以将编写逻辑类附加到由部分代码触发的事件。使用事件驱动架构是一个很好的模式

# visual-studio-2008 - VS2008 安装项目 - 覆盖较新的版本

> ID：355283
> 
> 赞同：1
> 
> 时间：2008-12-10T06:51:25.740
> 
> 标签：visual-studio-2008, windows-installer, setup-project

如果通过设置“DetectNewerInstalledVersion”检测到较新版本，VS2008 安装项目提供停止安装的选项。如果新版本存在，是否有办法删除它，即类似于“RemovePreviousVersions”选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T11:02:52.873

我个人也希望这样做，但仅限于在我编写它们时对版本之间的不一致性进行分类和测试安装程序的情况下！

并不意味着聪明，而是这将如何帮助用户 - 它只会使他们面临撤消良好安装的风险。

另请参阅[.NET 安装包有时不会完全删除以前的版本](https://stackoverflow.com/questions/290011/net-install-package-sometimes-not-completely-removing-previous-versions)

由于 2008 没有进行简单的卸载 + 安装，因此安装步骤需要能够处理升级和降级情况。

所以1）因为2008不能那样工作，2）因为它不是一个正常的用例

# xmlhttprequest - Permission Denied Error XMLHttpRequest

> ID：355299
> 
> 赞同：1
> 
> 时间：2008-12-10T06:59:43.303
> 
> 标签：xmlhttprequest

```
  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Calling a Web Service Using XmlHttpRequest</title>

    <script type="text/javascript" language="javascript"> 

var xmlhttp; 

var XMLContent='<XML ID="Transaction"><Transaction>'+
'<LoginDetails>'+
'<Email>artur</Email>'+
'<Password>demos2</Password>'+
'</LoginDetails>'+
'<JobDetails>'+
'<JobId>40170978</JobId>'+
'<JobRefNo>prod84</JobRefNo>'+
'<JobTitle>'+
'<![CDATA[ Director of R&D Software product  (Multimedia)]]>'+
'</JobTitle>'+
'<JobExpiry>30</JobExpiry>'+
'<JobContactName>'+
'<![CDATA[ Brian Mc Fadden]]>'+
'</JobContactName>'+
'<JobContactEmail>brian.mcfadden@recruiters.ie</JobContactEmail>'+
'<JobShortDesc>'+
'<![CDATA[ Director of R&D Software product concepts Multimedia Web 2.0]]> '+
'</JobShortDesc>'+
'<JobDetDesc><![CDATA[ <P class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><STRONG>Director of R&D Software product concepts to</STRONG>  build a the new prototyping team and processes from the ground up, utilizing an agile development model, manage the R&D team develop a strong vision and be able to clearly articulate the direction the group will take in terms of methodologies and tools in technologies such as J2EE, .NET, Flash, AJAX, DHTML, JavaScript, take marketing requirements from the principal investigators and write functional requirement documents, manage budget for R&D development,  manage the projects developed by the internal team and vendors. </P>  <P class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto">To get this new role you will have a degree in IT / Software and over 5 years plus doing cutting edge development in R&D/ prototyping and leading cutting edge development teams in a software production / product environment, project management and process management skills (AGILE) and demonstrated experience working on product innovation and releases. You may be working in educational gaming, social networking, Web 2.0 applications, mobile technologies, learning management systems, online courseware or shareware. </P>  <P class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"> </P>  <P class=MsoNormal style="MARGIN: 0cm 0cm 0pt">The package is to €105K + Bonus + VHI + Pension + relocation package where applicable + stock options may be negotiated. There are great career advancement opportunities. To discuss this and other opportunities please send an up-to-date resume to <A href="mailto:brian.mcfadden@recruiters.ie">brian.mcfadden@recruiters.ie</A> or call +353 1 6489113 in confidence. Your details will not be sent to any third party without your consent. </P>  <P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"> </P>]]>'+
'</JobDetDesc>'+
'<JobSalary>90000</JobSalary>'+
'<JobSalaryMax>105000</JobSalaryMax>'+
'<JobQues1><![CDATA[ ]]>'+
'</JobQues1>'+
'<JobQues2><![CDATA[ ]]>'+
'</JobQues2>'+
'<JobQues3><![CDATA[ ]]>'+
'</JobQues3>'+
'<JobType>0|0</JobType>'+
'<JobAddnlBens>17,14,23,1,5,9,12,10</JobAddnlBens>'+
'<JobLocations>96,98,97</JobLocations>'+
'<JobEducations>8</JobEducations>'+
'<JobExperiences>10</JobExperiences>'+
'<JobCategories>1043,1050</JobCategories>'+
'<JobSubcategories>69896,69869</JobSubcategories>'+
'</JobDetails>'+
'</Transaction>'+
'</XML>';

function on_click() 

{ 

if(window.ActiveXObject)
  {
     try 
        {
        xmlhttp = new ActiveXObject('Msxml2.XMLHTTP');

        }
     catch (ex)
     {
      xmlhttp = new ActiveXObject('Microsoft.XMLHTTP');

     }
  }
 else if (window.XMLHttpRequest) 
 {
   xmlhttp = new window.XMLHttpRequest();
   netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
 }

var xmlToSend = '<?xml version="1.0" encoding="utf-8"?>'+
'<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">'+ 
'<soap:Body>'+
'<InsertXML xmlns="http://recpushdata.cyndigo.com/">'+
'<Jobs>'+XMLContent+'</Jobs>'+
'</InsertXML>'+
'</soap:Body>'+
'</soap:Envelope>';

var szUrl;
szUrl = 'http://recpushdata.cyndigo.com/Jobs.asmx?op=InsertXML';

xmlhttp.onreadystatechange = state_Change; 

xmlhttp.open("Post", szUrl, true); 

xmlhttp.setRequestHeader ("SOAPAction", "http://recpushdata.cyndigo.com/InsertXML"); 

xmlhttp.setRequestHeader ("Content-Type", "text/xml"); 

xmlhttp.send(xmlToSend); 

} 

function state_Change() 

{ 

// if xmlhttp shows "loaded" 

if (xmlhttp.readyState==4) 

{ 

// if "OK" 

if (xmlhttp.status==200) 

{ 

alert("OK"+xmlhttp.responseText); 

} 

else 

{ 

alert("Problem retrieving XML data "+xmlhttp.responseText); 

} 

} 

} 

    </script>

</head>
<body>
    <div>
        <h1>
            Click the button to call the web service</h1>
        <input type="button" onclick="return on_click();" value="OK" />
    </div>
    <div id="responseDiv">
    </div>
</body>
</html> 

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-10T07:01:56.047

XmlHttpRequest can only be used to call services local to the domain/server from where the page is being served.

Thus, if you're serving a page from:

```
http://www.example.com/page1 
```

You cannot make an XmlHttpRequest to:

```
http://www.sample.com/webservice 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T07:37:04.477

由于您正在设置`Content-type`，因此您还需要将其设置为使用`UTF-8`。我认为它应该是`application/xml`（[来源](http://www.w3.org/TR/XMLHttpRequest/#xmlhttprequest)）。

```
xmlhttp.setRequestHeader("Content-Type", "application/xml; charset=utf-8"); 
```

否则，您是否验证过 XML 格式正确？尝试将其保存为完整的 XML 文件并在浏览器中打开它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T10:12:31.700

对于 Internet Explorer

[http://www.simple-talk.com/dotnet/asp.net/calling-cross-domain-web-services-in-ajax/](http://www.simple-talk.com/dotnet/asp.net/calling-cross-domain-web-services-in-ajax/)

对于火狐

[http://installingcats.com/2008/01/29/how-to-fix-ajax-error-uncaught-exception-permission-denied-to-call-method-xmlhttprequestopen/](http://installingcats.com/2008/01/29/how-to-fix-ajax-error-uncaught-exception-permission-denied-to-call-method-xmlhttprequestopen/)

# visual-studio-2008 - VS2008 安装项目 - 无修复选项

> ID：355305
> 
> 赞同：1
> 
> 时间：2008-12-10T07:03:06.697
> 
> 标签：visual-studio-2008, windows-installer, setup-project

无论如何禁用修复选项，以便如果用户再次运行 msi，它会自动卸载而不提示修复/删除选项？

编辑：这是针对受控的公司环境，并已作为要求传递下来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T05:42:48.013

阅读您的编辑后，我会尝试猜测，但我真的不知道是否可以仅使用 msi 文件。可以从 Microsoft 下载工具“orca”（与 Visual Studio 版本的代号“orcas”无关）。“Orca”可以编辑 msi 文件的某些属性，因此我会在此寻找禁用修复选项的可能性。

另一个猜测是您可能能够足够早地插入自定义操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T07:29:44.507

这真的不是一件很不友好的事情吗？用户不应该决定是要修复还是卸载？如果您想提供一个少点击的卸载程序，请编写一个单独的卸载程序。

# java - 为什么我的 Java 程序不能读取 Perl 的 STDERR？

> ID：355311
> 
> 赞同：5
> 
> 时间：2008-12-10T07:10:08.790
> 
> 标签：java, perl, stderr

我们有一个 Perl 程序来验证从 Java 程序调用的 XML。它无法写入标准错误并挂在打印位置。

Perl 正在写入 STDERR，而 java 程序正在使用 getErrorStream() 函数读取 STDERR。但是 Perl 程序正在挂起写入 STDERR。我怀疑 Java 函数完全阻塞了 STDERR 流，而 Perl 正在等待这个流被释放。

Perl 中有没有办法克服这种阻塞并强制写入标准错误？由于 Java 仅进行读取，因此 API 不应按照 java doc 锁定 STDERR 流。

Perl 代码片段是：

```
sub print_error
{
    print STDERR shift;
} 
```

Java代码片段是：

```
while ( getErrorStream() != null )
{
    SOP errorMessage;
} 
```

提前感谢帮助。

谢谢， 马修 Liju

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T07:40:45.607

getErrorStream 不*读取*错误流，它只是获取它的句柄。因为它是一个管道，如果你从未真正读过它，它会填满并强制 Perl 程序阻塞。

你需要类似的东西：

```
Inputstream errors = getErrorStream();
while (errors.read(buffer) > 0) {
    SOP buffer;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-10T07:27:19.707

另一个需要考虑的因素是管道进程发生的缓冲。

默认情况下，大约有一个 30 行的缓冲区，由创建进程间管道的 shell 维护，因此如果 Perl 应用程序没有创建足够的数据，它还不会被发送到 Java 应用程序过程。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-10T07:27:35.870

可能是[这个线程](http://forums.sun.com/thread.jspa?threadID=189595&forumID=31)有可能导致您的问题：

> 在 Perl 脚本的顶部添加 3 行：

```
use IO::Handle;
STDOUT->autoflush(1);
STDERR->autoflush(1); 
```

上述线程中的问题与“Perl 缓冲其输出的方式”有关。

然而在这里，[Adrian Pronk](https://stackoverflow.com/users/41861/adrian-pronk)在评论中提到“Perl 挂起，因为 Java 从不读取它的输出”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-10T14:58:16.880

理想情况下，我认为为了避免死锁，在 Java 中您需要生成单独的线程来读取 STDERR 和 STDOUT。听起来 Perl 在写入 STDERR 时会阻塞，因为出于某种原因，您永远不会在 Java 中读取它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-24T18:20:41.827

```
STDOUT->autoflush(1);
STDERR->autoflush(1); 
```

这是我需要的信息！我有一个运行一些 Perl 脚本的 Java 应用程序，我只会在它完成后得到输出。通过添加，`autoflush(1)`我马上就明白了。

顺便说一句，我确实有单独的线程来阅读`STDERR`和`STDOUT`，这就是要走的路。

谢谢。

# objective-c - 在objective-c中，如何区分类和类的实例？

> ID：355312
> 
> 赞同：3
> 
> 时间：2008-12-10T07:10:51.627
> 
> 标签：objective-c, pointers

假设我在objective-c中有一个通用指针。这个指针可以是一个`Class`对象，也可以是那个类的一个*实例*。有什么办法可以区分这两者吗？

例子：

```
 id pointerA = [someClass class];
id pointerB = [[someClass alloc] init];

bool pointerAIsAClass = is_this_a_Class(pointerA); // should be true
bool pointerBIsAClass = is_this_a_Class(pointerB); // should be false 
```

我将如何编写``is_this_a_Class``函数以使其返回正确的`bool`值？

```
bool is_this_a_Class(id somePointer)
{
    // your code goes here
}
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T07:40:07.950

我没有看到更好的方法，这不是万无一失的，但这应该可行：

```
BOOL pointer_isClass(id object) {
    return [object respondsToSelector:@selector(instancesRespondToSelector:)];
} 
```

因为从理论上讲，只有`Class`对象会响应`-instancesRespondToSelector:`消息，所以这应该有效。在实际`objc_*`调用之外，虽然我没有看到任何真正的 API。

**更新：**
阅读 Giao 的回答后，我想到了另一个想法，测试指针对`-class`方法的响应。调用`-class`类对象应该等同于调用`-self`对象实例，但会在对象实例上返回另一个对象。

```
BOOL pointer_isClass(id object) {
    return object == [object class];
} 
```

我认为这应该更加万无一失，尤其是在对象实例实现`-instancesRespondToSelector:`这个应该 100% 的情况下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-07-22T22:53:01.557

最正确的方法是检查对象的类，看看它是否是元类：

```
BOOL object_isClass(id object) {
    return class_isMetaClass(object_getClass(object));
} 
```

这里有更多答案：[检查对象是否为类类型](https://stackoverflow.com/questions/6536244/check-if-object-is-class-type)

# css - How do I hide an element when printing a web page?

> ID：355313
> 
> 赞同：531
> 
> 时间：2008-12-10T07:11:24.187
> 
> 标签：css, printing

I have a link on my webpage to print the webpage. However, the link is also visible in the printout itself.

Is there javascript or HTML code which would hide the link button when I click the print link?

Example:

```
 "Good Evening"
 Print (click Here To Print) 
```

I want to hide this "Print" label when it prints the text "Good Evening". The "Print" label should not show on the printout itself.

* * *

## 回答 #1

> 赞同：861
> 
> 时间：2008-12-10T14:02:10.813

在您的样式表中添加：

```
@media print
{    
    .no-print, .no-print *
    {
        display: none !important;
    }
} 
```

然后`class='no-print'`在您的 HTML 中添加（或将 no-print 类添加到现有的类语句中）您不希望出现在打印版本中，例如您的按钮。

* * *

## 回答 #2

> 赞同：215
> 
> 时间：2016-04-01T09:08:45.883

Bootstrap 3 有[自己**的**类，](https://getbootstrap.com/docs/3.3/css/#responsive-utilities-print)称为：

```
hidden-print 
```

它是这样定义的：

```
@media print {
  .hidden-print {
    display: none !important;
  }
} 
```

**您不必自己定义它。**

* * *

在[Bootstrap 4](https://getbootstrap.com/docs/4.3/utilities/display/#display-in-print)和[Bootstrap5](https://getbootstrap.com/docs/5.1/utilities/display/#display-in-print)中，这已更改为：

```
.d-print-none 
```

* * *

## 回答 #3

> 赞同：177
> 
> 时间：2008-12-10T07:23:38.153

The best practice is to **use a style sheet specifically for printing**, and and set its `media` attribute to `print`.

In it, show/hide the elements that you want to be printed on paper.

```
<link rel="stylesheet" type="text/css" href="print.css" media="print" /> 
```

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2017-06-23T15:00:36.787

这是一个简单的解决方案，把这个 CSS

```
@media print{
   .noprint{
       display:none;
   }
} 
```

这是HTML

```
<div class="noprint">
    element that need to be hidden when printing
</div> 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2015-12-17T09:05:02.163

CSS文件

```
@media print
{
    #pager,
    form,
    .no-print
    {
        display: none !important;
        height: 0;
    }

    .no-print, .no-print *{
        display: none !important;
        height: 0;
    }
} 
```

HTML 标题

```
<link href="/theme/css/ui/ui.print.css?version=x.x.x" media="print" rel="stylesheet" type="text/css" > 
```

元素

```
<div class="no-print"></div> 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-12-10T07:20:15.633

You could place the link within a div, then use JavaScript on the anchor tag to hide the div when clicked. Example (not tested, may need to be tweaked but you get the idea):

```
<div id="printOption">
    <a href="javascript:void();" 
       onclick="document.getElementById('printOption').style.visibility = 'hidden'; 
       document.print(); 
       return true;">
       Print
    </a>
</div> 
```

The downside is that once clicked, the button disappears and they lose that option on the page (there's always Ctrl+P though).

The better solution would be to create a print stylesheet and within that stylesheet specify the hidden status of the `printOption` ID (or whatever you call it). You can do this in the head section of the HTML and specify a second stylesheet with a media attribute.

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-10-26T23:38:27.577

```
@media print {
  .no-print {
    visibility: hidden;
  }
}
```

```
<div class="no-print">
  Nope
</div>

<div>
  Yup
</div>
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-12-10T21:42:05.690

最好的办法是创建页面的“仅打印”版本。

哦，等等……这已经不是 1999 年了。使用带有“显示：无”的打印 CSS。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-11-29T09:19:06.177

如果您的 Javascript 会干扰单个元素的样式属性，从而覆盖`!important`，我建议处理事件`onbeforeprint`和`onafterprint`. [https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeprint](https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeprint)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-01-28T06:45:07.110

diodus 接受的答案对我们中的一些人（如果不是所有人）都不起作用。我仍然无法隐藏我的“打印此按钮”以防止出现在纸上。

Clint Pachl 通过添加调用 css 文件的小调整

```
 media="screen, print" 
```

而不仅仅是

```
 media="screen" 
```

正在解决这个问题。所以为了清楚起见，并且因为不容易看到 Clint Pachl 在评论中隐藏了额外的帮助。用户应在 css 文件中包含所需格式的“,print”。

```
 <link rel="stylesheet" href="my_cssfile.css" media="screen, print"type="text/css"> 
```

而不是默认媒体=“屏幕”。

```
 <link rel="stylesheet" href="my_cssfile.css" media="screen" type="text/css"> 
```

我认为这可以为每个人解决这个问题。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2022-01-30T13:14:02.527

正如 Elias Hasle 所说，JavaScript 可以覆盖`!important`. 所以，我用一个理论实现扩展了他的答案。

此代码用 class 标识所有元素，`no-print`在打印前用 CSS 隐藏它们，并在打印后恢复原始样式：

```
var noPrintElements = [];

window.addEventListener("beforeprint", function(event) {
   var hideMe = document.getElementsByClassName("no-print");
   noPrintElements = [];
   Array.prototype.forEach.call(hideMe, function(item, index) {
      noPrintElements.push({"element": item, "display": item.style.display });
      item.style.display = 'none'; // hide the element
   });   
});

window.addEventListener("afterprint", function(event) {
   Array.prototype.forEach.call(noPrintElements, function(item, index) {
      item.element.style.display = item.display; // restore the element
   });      
   noPrintElements = []; // just to be on the safe side
}); 
```

# mod-rewrite - 301 redirect

> ID：355318
> 
> 赞同：1
> 
> 时间：2008-12-10T07:13:25.007
> 
> 标签：mod-rewrite, redirect, http-status-code-301

1.  **How do i redirect a url to domain .** eg. [http://www.mydomain.com/index.php=HairThing](http://www.mydomain.com/index.php=HairThing) --> [http://www.mydomain.com](http://www.mydomain.com)

2.  **How do i redirect a non-www to www WITHOUT a slash at end ?**

eg [http://mydomain.com](http://mydomain.com) ---> [http://www.mydomain.com](http://www.mydomain.com)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T07:22:04.773

See also: [Hidden features of mod_rewrite](https://stackoverflow.com/questions/286004/hidden-features-of-modrewrite)

```
#1
RewriteRule /index.php=HairThing$ http://www.mydomain.com [R=301]

#2
RewriteCond %{HTTP_HOST} ^mydomain.com 
RewriteRule .*   http://www.mydomain.com [R=301] 
```

However, example case 1, as said by Greg, will always put the `/` on if it is without a uri.

```
mydomain.com  # impossible 
mydomain.com/ # possible
mydomain.com/foo  #possible
mydomain.com/foo/ #possible 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T07:21:37.533

For your second question, the browser will *always* put a slash after the site name. This is because the trailing slash is required to indicate the root path of the web site.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T11:32:11.590

您可以使用适用于每个域的通用规则，而不必一直更改域的名称。当您将多个域停放在同一个根目录上时，这非常有用。

```
RewriteCond %{HTTP_HOST}    !^www\.[a-z0-9-]+\.[a-z]{2,6}   [NC]
RewriteCond %{HTTP_HOST}    ([a-z0-9-]+\.[a-z]{2,6})$       [NC]
RewriteRule (.*)            http://www.%1/$1                [L,R=301] 
```

# multithreading - Thread-safety and concurrent modification of a table in SQLite3

> ID：355327
> 
> 赞同：4
> 
> 时间：2008-12-10T07:17:12.987
> 
> 标签：multithreading, sqlite, thread-safety

Does thread-safety of SQLite3 mean different threads can modify the same table of a database concurrently?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-30T20:54:45.267

否 - SQLite 不支持对同一数据库文件的并发写访问。SQLite 将简单地阻止其中一个事务，直到另一个事务完成。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-24T05:11:06.103

请注意，如果您使用的是 python，要从不同的线程访问 sqlite3 连接，您需要禁用该`check_same_thread`参数，例如：

sqlite.connect(":memory:", check_same_thread = False)

截至 2010 年 5 月 24 日，文档省略了此选项。[遗漏在这里](http://bugs.python.org/issue8129)被列为错误

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T07:23:56.330

Not necessarily. If sqlite3 is compiled with the thread safe macro (check via the

```
int sqlite3_threadsafe(void)
```

function), then you can try to access the same DB from multiple threads without the risk of corruption. Depending on the lock(s) required, however, you may or may not be able to actually modify data (I don't believe sqlite3 supports row locking, which means that to write, you'll need to get a table lock). However, you can try; if one threads blocks, then it will automatically write as soon as the other thread finishes with the DB.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-17T11:50:44.303

您可以在 3 种不同的模式下使用 SQLite：

[http://www.sqlite.org/threadsafe.html](http://www.sqlite.org/threadsafe.html)

如果您决定采用多线程模式或序列化模式，您可以轻松地在多线程应用程序中使用 SQLite。在这些情况下，无论如何您都可以同时读取所有线程。如果您需要同时写入，打开的表将自动锁定当前写入线程并在此之后解锁（下一个线程将等待（互斥）轮到他，直到表被解锁）。在所有这些情况下，您需要为每个线程 (.NET Data.Sqlite.dll) 创建单独的连接字符串。如果您使用其他实现（例如任何 Android 包装器），有时情况会有所不同。

# c# - 获取有关 C# WAP 项目的统计信息以进行客户端通信

> ID：355333
> 
> 赞同：1
> 
> 时间：2008-12-10T07:19:50.393
> 
> 标签：c#, static-analysis, code-statistics

我有一个客户认为高度动态的 ASP.NET 应用程序是一个非常简单的系统，但是以他们未来发展所需的方式实现它，它已经发展到超过 100 个不同的代码文件。

我正在寻找一种方法，最有可能使用某种静态代码分析工具来为非技术人员提供一些可能“有意义”的数字。我完全理解代码行数和其他指标并不是真正要评估的“有效”项目，但在这种情况下，这是我需要的类型，代码行数、XML 注释数、文件总数、文件夹总数。

我知道我可以查看其中的一些，但我正在寻找一种简单的方法来批量获取这些值！我在这里找到了一些旧帖子，但没有专门讨论 .NET（当前版本）和/或 C#。

理想情况下，我想要一些可以调查 C# WAP 项目的东西。SQL Server 将是一个令人敬畏的增值，但不是 100% 需要的项目！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T08:13:55.587

对于简单的代码行和注释组合等，我发现 VS 插件“项目行计数器”非常好（[http://www.codeproject.com/KB/macros/linecount.aspx](http://www.codeproject.com/KB/macros/linecount.aspx)）。

如果您想要更详细的指标，我建议对圈复杂度进行简单解释，这将导致您的客户更深入地理解，并尊重您所知道的。像 Reflector 这样的工具有插件，可以将复杂性和类大小显示为框图。[请参阅 http://www.codeplex.com/reflectoraddins](http://www.codeplex.com/reflectoraddins)，或更具体的[http://www.codeplex.com/reflectoraddins/Wiki/View.aspx?title=CodeMetrics](http://www.codeplex.com/reflectoraddins/Wiki/View.aspx?title=CodeMetrics)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T16:07:41.123

您可以使用工具[NDepend](http://www.NDepend.com)获取 82 个代码指标，例如代码行数、方法参数数、方法调用者数、方法注释百分比、测试代码覆盖率百分比、排名（最流行的方法/类型。 ..)。

此页面上列出了所有 82 个指标[http://www.ndepend.com/Metrics.aspx](http://www.ndepend.com/Metrics.aspx)。

此外，代码度量只是NDepend的[主要功能之一：](http://www.ndepend.com/Features.aspx)

*   [CQLinq](http://www.ndepend.com/Features.aspx#CQL) : 通过 LINQ 查询编写代码规则（提供超过[200 条默认代码规则](http://www.ndepend.com/DefaultRules/webframe.html)）
*   [代码差异](http://www.ndepend.com/Doc_VS_Diff.aspx)
*   [依赖图](http://www.ndepend.com/Doc_VS_Arch.aspx)
*   [依赖矩阵](http://www.ndepend.com/Doc_Matrix.aspx)
*   [线束测试覆盖数据](http://www.ndepend.com/Coverage.aspx)
*   和更多...

# c# - 转换 VB.NET --> C# 项目

> ID：355340
> 
> 赞同：8
> 
> 时间：2008-12-10T07:22:53.803
> 
> 标签：c#, .net, vb.net

谁能推荐一个好的应用程序，可以用来将 VB.NET 项目转换为 C#，而不必做太多的手动工作？

我们已经使用 Reflector 手动完成小型库，但是一些较大的项目将太慢且太复杂而无法手动执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-10T11:34:10.240

您可以使用 Lutz Roeders Reflector ( [http://www.red-gate.com/products/reflector](http://www.red-gate.com/products/reflector) )，它可以将整个程序集反编译成 Visual Studio 项目。通过这种方式，您可以从任何 .NET 语言转换为该程序支持的语言之一（C#.VB.NET、MC++、Delphi、Chrome）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-10T09:28:21.583

[有形软件](http://tangiblesoftwaresolutions.com/)做各种转换器，包括 VB 到 C#。

我玩过它，因为他们很友好地免费给我一份，但我不能说我已经对它进行了压力测试。当我使用它时它很好 - 当然值得一试。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-10T13:26:27.923

有几件事要记住...

1) 根据 VB.Net 代码的编写方式，自动转换可能是也可能不是 100%。VB.Net 允许“宽松”的编码风格，这对 C# 来说是模棱两可的。因此，可能需要一些人工干预。

2) 如果 VB.Net 代码正常运行，您可能只想将其保留为 VB.Net。VB.Net 和 C# 项目可以在同一个解决方案中共存。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-10T18:53:03.130

最好的工具是 Econ Netvert，可以在 CodePlex [http://www.codeplex.com/econnetvert上找到](http://www.codeplex.com/econnetvert)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-10T07:48:54.907

[SharpDevelop](http://www.sharpdevelop.com/OpenSource/SD/Default.aspx)有这个功能，但我没有充分使用它来了解它是否可靠地工作。其他方面似乎还不错，所以值得一试。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-10T10:58:16.613

到目前为止我见过的最好和最快的转换器是[http://converter.telerik.com/](http://converter.telerik.com/)

使用 RAD AJAX 控件很好地呈现。

注意：它只转换代码片段而不是整个项目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T16:37:48.470

developerfusion还有[免费的在线转换器](http://www.developerfusion.com/tools/):)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-07-29T15:30:39.170

SharpDevelop 非常好，但在我的公司，我们发现[VBConversions](http://www.vbconversions.com/)可以提供更完整的转换。虽然这是一个商业应用程序，但对于通过 SharpDevelop 节省的时间来说，这对我们来说是轻而易举的事。

作为一个具体的例子，我们发现 SharpDevelop 没有正确转换的一件事是 VB 索引，它使用了弯括号。它似乎无法区分索引和方法调用，因此没有将索引转换为方括号。VBConversions 很好地转换了它们。这件事让我们值得购买。

看起来有形软件产品的工作方式与 VBConversions 非常相似。

# c# - Acessing a url from windows application

> ID：355343
> 
> 赞同：0
> 
> 时间：2008-12-10T07:23:52.740
> 
> 标签：c#, http, webclient

Does anyone know how to acess a url from a windows application?.

I have an address [http://serverport/Page.I](http://serverport/Page.I) want to acess this page from my windows application.

Regards, Harsh Suman

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T07:27:21.033

It's not clear what you want to do with the page.

If you want to display it on the form, you can use a `WebBrowser` control.

If you want to get the response and process it, use the `System.Net.WebClient` class.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T08:22:22.590

如果要下载 HTML 或任何文件，可以使用 WebClient 类。

例子：

```
 /// <summary>
    /// Downloads a file from the given location
    /// </summary>
    /// <param name="url">Location of the file</param>
    /// <param name="dest">The destination of the downloaded file</param>
    /// <returns>False if there was an error, else True</returns>
    public bool DownLoad(string url, string dest)
    {
        WebClient client = new WebClient();
        try
        {
            //Downloads the file from the given url to the given destination                
            client.DownloadFile(url, dest);
            return true;
        }
        catch (WebException)
        {
            // Handle exception
            return false;
        }
        catch (System.Security.SecurityException)
        {
            // Handle exception
            return false;
        }
        catch (Exception)
        {
            // Handle exception
            return false;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T07:53:28.327

我不确定你在问什么，所以我只是给出了另一种解释问题的方式的答案。

如果您只是想启动默认浏览器（显示本地或在线 html 手册等），在 Windows 中（在其他操作系统中可能类似），您可以使用某种“执行界面”来执行格式正确的 url作为命令，这通常会启动默认浏览器：

根据[此页面](http://support.microsoft.com/kb/305703)，此代码应启动浏览器：

```
string targeturl= "http://stackoverflow.com";

try
    {
     System.Diagnostics.Process.Start(targeturl);
    }
catch
    ( 
     System.ComponentModel.Win32Exception noBrowser) 
    {
     if (noBrowser.ErrorCode==-2147467259)
      MessageBox.Show(noBrowser.Message);
    }
catch (System.Exception other)
    {
      MessageBox.Show(other.Message);
    } 
```

（不过，错误代码的幻数看起来很丑陋……）

# svn - 使用 svnkit 设置 svn:ignore 标志

> ID：355355
> 
> 赞同：3
> 
> 时间：2008-12-10T07:32:19.323
> 
> 标签：svn, svnkit, svnignore

我在我的应用程序中使用[SVNKit](http://www.svnkit.com)。我有一个场景，其中在执行 svn 操作时应该忽略某些文件。即我需要为某些模式设置 svn:ignore 属性。

我如何使用 SVNKit 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T07:42:24.153

您可以使用[ISVNOptions](http://svnkit.com/kb/javadoc/org/tmatesoft/svn/core/wc/ISVNOptions.html)类。

它有一个[`addIgnorePattern()`](http://svnkit.com/kb/javadoc/org/tmatesoft/svn/core/wc/ISVNOptions.html#addIgnorePattern%28java.lang.String%29)功能，应该允许您根据给定的模式忽略文件。

如果要忽略特定目录中的“忽略”，则必须`svn:ignore`在其父目录上设置属性，而不是在文件本身上设置属性（因为被忽略该文件将永远不会添加到存储库中）。

```
File dir = file.getParentFile().getAbsoluteFile();
ourClientManager.getWCClient().doSetProperty(dir, SVNProperty.IGNORE,
    file.getName(), false, false, null); 
```

要忽略目录中的多个文件，`svn:ignore`属性值应为每个被忽略的文件包含一行，例如：

```
a\n
b\n
*.bin 
```

一旦设置了属性，提交目录以使新的属性值存储在存储库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T15:33:42.727

参数列表是 (file, propName, propValue, force, recursive, IPropertyHandler)。

因此，如果您想递归地应用一个属性，只需将其第 5 个参数（递归）设置为 true。

# iis - 无法连接到 IIS 6.0 中的默认网站

> ID：355358
> 
> 赞同：1
> 
> 时间：2008-12-10T07:35:25.527
> 
> 标签：iis

我无法使用 localhost 或 127.0.0.1 或服务器名称连接到 IIS 6.0 中的默认网站。当我使用这些名称之一远程登录到端口 80 时，没有连接。

但是其他网站正在运行，我可以使用任何 IP 地址进行远程登录。我可以 ping 到 127.0.0.1 响应的本地主机。默认网站正在运行。它没有停止。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T07:57:12.470

检查windows防火墙，它有在本地机器上阻止IIS的习惯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T08:42:42.753

默认站点是否绑定到特定 IP 地址？默认情况下，它会为 IP 显示“所有未分配”，但如果您已将所有站点链接到特定 IP 地址，则本地 IP 将不再在服务器上配置并且不会应答。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T20:58:16.607

httpcfg.exe 做到了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T08:50:19.710

停止 IIS 下的所有站点，重新启动 IIS 并启动您感兴趣的站点。

如果此操作失败，请删除 IIS 下的所有站点并从头开始创建。如果*此*操作失败，则问题不在于 IIS，您需要查看正在运行的其他服务并开始关闭它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T13:46:46.273

防火墙可能会阻止您网站/网站本身的某些内容被访问，因此如果您在访问内容时遇到问题，请检查您的防火墙是否拒绝来自您网站的内容。

确保您的防火墙不会阻止您访问站点服务的最简单方法是使用防火墙控制面板允许来自`*.(your site url)`.

# java - AtomicInteger weakCompareAndSet 上的“虚假失败”是什么意思？

> ID：355365
> 
> 赞同：21
> 
> 时间：2008-12-10T07:44:32.637
> 
> 标签：java, cas

Java AtomicInteger 类有一个方法 -

```
boolean weakCompareAndSet(int expect,int update) 
```

它的文档说：

> 可能会虚假失败。

这里的“虚假失败”是什么意思？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-10T08:05:35.637

虚假地：没有明显的原因

根据[`atomic`](http://gee.cs.oswego.edu/dl/jsr166/dist/docs/java/util/concurrent/atomic/package-summary.html)包javadoc：

> 原子类也支持方法weakCompareAndSet，它的适用性有限。
> 
> 在某些平台上，弱版本在正常情况下可能比 compareAndSet 更有效，但不同之处在于，**任何给定的 weakCompareAndSet 方法调用都可能虚假地返回 false**（也就是说，***没有明显的原因***）。
> 
> 错误返回仅意味着可以在需要时重试操作，这依赖于当变量保持预期值并且没有其他线程也尝试设置变量时重复调用最终会成功的保证。
> （例如，这种虚假故障可能是由于与预期值和当前值是否相等无关的内存争用效应造成的。）
> 
> 此外，weakCompareAndSet 不提供同步控制通常需要的排序保证。

* * *

根据[这个线程](http://markmail.org/message/aaozo22nsp4psa4h)，这不是因为“硬件/操作系统”，而是因为 weakCompareAndSet 使用的底层算法：

> **如果当前值 == 预期值，weakCompareAndSet 会自动将值设置为给定的更新值**。可能会虚假失败。
> 
> 与 compareAndSet() 和 AtomicX 上的其他操作不同，**weakCompareAndSet() 操作不会创建任何[先发生顺序](http://www.ibm.com/developerworks/library/j-jtp09238.html)**。
> 
> 因此，仅仅因为线程看到由weakCompareAndSet 引起的AtomicX 更新并不意味着它与weakCompareAndSet() 之前发生的操作正确同步。
> 
> 您可能不想使用此方法，而应该只使用 compareAndSet; 因为在少数情况下weakCompareAndSet 比compareAndSet 更快，并且在许多情况下，尝试使用weakCompareAndSet 而不是compareAndSet 来优化代码会在代码中引入微妙且难以重现的同步错误。

* * *

关于**[发生前订购的](http://www.ibm.com/developerworks/library/j-jtp09238.html)**注意事项：

> Java 内存模型 (JMM) 定义了保证读取变量的线程在另一个线程中看到写入结果的条件。
> 
> JMM 定义了一个名为happens-before 的程序的操作顺序。
> 
> Happens-before 跨线程的排序只能通过在公共锁上同步或访问公共 volatile 变量来创建。
> 
> 在没有发生之前的顺序的情况下，Java 平台有很大的自由度来延迟或更改一个线程中的写入对另一个线程中相同变量的读取可见的顺序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-10T07:51:26.053

这意味着即使它当前包含预期值，它也可能返回 false（并且不会设置新值）。

换句话说，该方法可能什么都不做，并且没有明显的原因返回 false……
在某些 CPU 架构中，这可能比强`CompareAndSet()`.

* * *

关于为什么会发生这样的事情的更具体的细节。

一些架构（如较新的 ARM）使用加载链接 (LL)/条件存储 (SC) 指令集实现 CAS 操作。LL 指令将值加载到内存位置并在某处“记住”该地址。如果记忆地址处的值未被修改，则 SC 指令将一个值存储到该内存位置。硬件有可能认为该位置已被修改，即使它显然没有出于多种可能的原因（原因可能因 CPU 架构而异）：

1.  该位置可能已写入相同的值
2.  所观察地址的分辨率可能并不完全是感兴趣的一个内存位置（想想缓存行）。写入“附近”的另一个位置可能会导致硬件将相关地址标记为“脏”
3.  许多其他可能导致 CPU 丢失 LL 指令的已保存状态的原因 - 可能是上下文切换、缓存刷新或页表更改。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-13T21:59:13.840

weakCompareAndSet 的一个很好的用例是性能计数器 - 无需排序，更新率高（因此排序对弱排序系统造成伤害），但不会在高负载下减少计数（紧密满足的性能计数器可以减少 99%计数，基本上使计数器的值相对于非竞争计数器随机）。

# html - 页面布局问题

> ID：355386
> 
> 赞同：4
> 
> 时间：2008-12-10T07:58:16.417
> 
> 标签：html, css, layout

请让我知道为什么页面内容下方有很多空白以及为什么显示水平滚动条。下面附上 zip 文件夹的链接。解压缩并打开 index.html。
[链接文本](http://shivanand.in/tmp/Basic_Profile.zip)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T08:31:57.393

第一条线索：

该规则`div#content`几乎适用于 IE，并且确实在 FireFox 中添加了额外的宽度：

额外的宽度应用于您的 div 类“ `content`”

```
div#content { margin: 3px 3px 3px 188px; background: rgb(255, 255, 255) none 
    repeat; min-height: 392px; } 
```

在 div 类中“ `container`”

```
div#container { margin: auto; padding: 10px; background: rgb(255, 255, 255) 
   none repeat; position: relative; min-height: 400px; 
   max-width: 100%; min-width: 750px; } 
```

水平滚动条的显示是针对添加到内容右侧的 188px。当然，它们需要留下来：不要移除它们。

**添加`overflow: hidden`; 到你的`div#container`CSS 规则**

在更一般的说明中，您可能希望遵循[“使用 CSS 进行渐进增强”](http://alistapart.com/articles/progressiveenhancementwithcss)最佳实践，并将您的 css 规则分隔在​​几个文件中（直到实际部署到生产环境中，您可以将所有 css 规则重新组合并压缩成一个紧密的文件）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T11:15:43.083

VonC 是对的。添加溢出：隐藏；到 div#container 规则。index.css 的第 274 行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T13:42:12.947

对于滚动条，VonC 的建议是正确的，而“页面内容下方的大量空白”是由于：您指定的“最小高度”。您可以为此使用属性“auto”而不是指定像素

关于：“当我添加溢出：自动时，它会在里面提供另一组滚动条。” ..为此，将溢出：自动添加到您使用过的所有 div

# algorithm - 如何有效地将 2D 图像分割成具有相似值的区域/块？

> ID：355398
> 
> 赞同：2
> 
> 时间：2008-12-10T08:13:31.783
> 
> 标签：algorithm, image-processing, computer-vision, mobile-robots

如何有效地将 2D 图像分割成具有相似值的块？给定的输入是一个整数数组，其中包括非灰色像素的色调和灰色像素的亮度。

我正在使用 Java 编写一个虚拟移动机器人，我正在使用分割来分析地图以及来自相机的图像。[这是计算机视觉](http://en.wikipedia.org/wiki/Computer_vision)中的一个众所周知的问题，但是当它在机器人上时，性能确实很重要，所以我想要一些输入。算法才是最重要的，因此您可以使用任何语言发布代码。

*   维基百科文章：[分割（图像处理）](http://en.wikipedia.org/wiki/Segmentation_%28image_processing%29)
*   [[PPT] Stanford CS-223-B Lecture 11 Segmentation and Grouping](http://robots.stanford.edu/cs223b04/CS%20223-B%20L11%20Segmentation.ppt)（说Mean Shift可能是迄今为止最好的技术）
*   [Mean Shift Pictures](http://www.caip.rutgers.edu/~comanici/MSPAMI/msPamiResults.html)（论文也可从[Dorin Comaniciu](http://www.caip.rutgers.edu/~comanici/)获得）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T08:53:10.737

我会在色彩空间和像素数上进行下采样，使用视觉方法（可能是均值偏移）并放大结果。

这很好，因为下采样还增加了对噪声的鲁棒性，并使您更有可能获得有意义的片段。

如果您需要平滑度，之后可以使用填充来平滑边缘。

还有一些想法（回应您的评论）。

1）你在下采样时混合了吗？y[i]=(x[2i]+x[2i+1])/2 这应该可以消除噪声。

2）你希望它有多快？

3）您尝试过动态均值偏移吗？（对于所有算法 x 的动态 x 也是谷歌）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T10:33:15.697

不确定它是否太有效，但您可以尝试使用[Kohonen 神经网络](http://en.wikipedia.org/wiki/Self%2Dorganizing_map)（或自组织图；SOM）对相似值进行分组，其中每个像素都包含原始颜色和位置，并且只有颜色用于科霍恩分组。

不过，您应该在实施此之前阅读，因为我对 Kohonen 网络的了解就其用于分组数据而言 - 所以我不知道您的场景的性能/可行性选项是什么。

还有[Hopfield 网络](http://en.wikipedia.org/wiki/Hopfield_network "维基百科文章")。它们可以根据我阅读的内容进行分组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T08:29:24.247

我现在拥有的：

1.  创建一个与输入图像大小相同的缓冲区，初始化为`UNSEGMENTED`.
2.  对于图像中相应缓冲区值不是 的每个像素，`UNSEGMENTED`使用像素值淹没缓冲区。

    一种。泛滥的边界检查是通过检查像素是否在`EPSILON`原始像素值的范围内（当前设置为 10）来完成的。

    湾。[洪水填充算法](http://en.wikipedia.org/wiki/Flood_fill#Alternative_implementations)。

可能的问题：

2.a.的边界检查在洪水填充算法中被多次调用。如果我可以使用边缘检测预先计算边界，我可以将其转换为查找，但这可能会比当前检查增加更多时间。

```
private boolean isValuesCloseEnough(int a_lhs, int a_rhs) {
    return Math.abs(a_lhs - a_rhs) <= EPSILON;
} 
```

可能的增强：

`UNSEGMENTED`我可以随机选择几个点，而不是检查每个像素。如果您预计大约有 10 个 blob，则按该顺序选择随机点可能就足够了。缺点是你可能会错过一个有用但很小的 blob。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-14T17:29:43.097

查看眼罩 (eyepatch.stanford.edu)。它应该通过提供各种可能的细分过滤器来帮助您在调查阶段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T09:52:19.397

洪水填充的替代方法是[连接组件](http://en.wikipedia.org/wiki/Connected_Component_Labeling)算法。所以，

1.  廉价地分类您的像素。例如在颜色空间中划分像素。
2.  运行 cc 以查找 blob
3.  保留显着大小的 blob

这种方法广泛用于早期视觉方法。例如在开创性论文“ [Blobworld: A System for Region-Based Image Indexing and Retrieval](http://portal.acm.org/citation.cfm?id=714153) ”中。

# iis - IIS7启动站点

> ID：355402
> 
> 赞同：0
> 
> 时间：2008-12-10T08:16:42.337
> 
> 标签：iis, iis-7

我有一个带有 IIS7 的 Windows 2008 服务器和一个以名称运行的网页，比如说*myApplication*。我有一个指向我的服务器 IP 的域名，比如说*myApplication.com*。

为了访问我的应用程序，我必须输入*[http://myApplication.com/myApplication](http://myApplication.com/myApplication)*。如果我写[http://myApplication.com/](http://myApplication.com/)我会到达 IIS7 起始页。当有人输入“ *[http://myApplication.com/](http://myApplication.com/)* ”时，有没有办法（除了重写*iisstart.htm*以进行 JavaScript 或元数据重定向）自动打开*myApplication*？

我想要的是以下内容：

*   用户在浏览器中输入：“ [http://myApplication.com/](http://myApplication.com/) ”
*   他/她被带到“ [http://myApplication.com/myApplication](http://myApplication.com/myApplication) ”
*   在浏览器的 URL 栏中，仅显示“ [http://myApplication.com/](http://myApplication.com/) ”，并且应用程序内的所有内容都与此 URL 相关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T08:21:25.400

通常，当我配置 IIS 时，我将“默认网站”的属性设置为一个不包含任何内容的文件夹，然后在 IIS 中为每个网站创建单独的条目。例如，您将为“MyApplication.com”创建一个新条目，并将其主目录设置为服务器上包含根文件的正确文件夹（通常为 c:\inetpub\wwwroot\myapplication.com\，但它可以在任何位置你喜欢）。

听起来好像您为应用程序创建了一个文件夹，但在 IIS 中没有配置特定条目来处理请求并从正确的文件夹加载文件。

如果您有应用程序的专用 IP 地址，请务必在该站点的站点设置中指定该 IP。如果您对多个站点使用单个 IP，请配置将用于访问该站点的 IP 和主机名/域，以便 IIS 知道哪些站点条目属于哪些域以及将请求路由到何处。

# sicp - 当您阅读 SICP 时让您感到惊讶的概念？

> ID：355406
> 
> 赞同：10
> 
> 时间：2008-12-10T08:21:37.587
> 
> 标签：sicp

SICP - “计算机程序的结构和解释”

相同的解释会很好

有人可以解释一下**元语言抽象吗**

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-27T13:10:47.263

SICP 确实让我们明白了可以将代码和数据视为同一事物的观点。

在考虑通用图灵机（UTM 的输入只是程序的表示）或冯诺依曼架构（其中单个存储结构同时保存代码和数据）时，我理解了这一点，但 SICP 使这个想法更加清晰. Scheme (Lisp) 在这里有所帮助，因为程序的语法与一般列表的语法完全相同，即 S 表达式。

一旦你有了代码和数据的“等价物”，很多事情突然变得容易了。例如，您可以编写具有不同评估方法（惰性、非确定性*等*）的程序。以前，我可能认为这需要对编程语言进行扩展；实际上，我可以自己将其添加到语言中，从而使核心语言最小化。再举一个例子，你可以类似地实现一个面向对象的框架；再说一次，我可能天真地认为这需要修改语言。

顺便说一句，我希望 SICP 多提到一件事：类型。*在编译*时进行类型检查是一件了不起的事情。面向对象编程的 SICP 实现没有这个好处。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-27T10:06:07.807

我还没有读过那本书，我只看过视频课程，但它教会了我很多。作为一等公民的职能让我兴奋不已。执行“变量”对我来说是非常新鲜的事情。看完这些视频后，我现在看待 JavaScript 和编程的方式发生了很大变化。

哦，我想我撒了谎，真正让我震惊的是 + 是一个函数。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-27T13:23:37.267

我认为非常酷的是延迟评估的[流](https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-24.html)。我认为关于生成素数的内容非常简洁。就像一个“PEZ”分配器，可以神奇地分配序列中的下一个素数。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-28T17:15:37.020

我认为关于 SICP 最令人惊讶的事情是看到实际上需要多少原语才能使图灵完备的语言 - 几乎任何东西都可以从几乎什么都没有构建。

由于我们正在讨论 SICP，我将在[http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/](http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/)上插入我的视频讲座的标准插件，这是最好的介绍您可能希望在 20 小时内获得计算机科学。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-27T13:32:12.197

A. Rex 的回答中的“数据和代码是同一件事”的一个例子让我非常深刻。

当我在俄罗斯被教 Lisp 时，我们的老师告诉我们语言是关于列表的：car、cdr、cons。真正让我吃惊的是你根本不需要这些函数——你可以编写自己的给定闭包。所以，Lisp 毕竟不是关于列表的！这是一个很大的惊喜。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-27T10:51:17.810

我完全不熟悉的一个概念是[协程](http://en.wikipedia.org/wiki/Coroutine)的概念，即有两个函数做互补的工作，并让程序流控制在它们之间交替。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-29T02:42:40.960

我读SICP的时候还在上高中，主要看第一章和第二章。对当时的我来说，我喜欢你可以用代码表达所有这些数学思想，并让计算机完成大部分脏活。

当我辅导 SICP 时，我对不同的方面印象深刻。一方面，数据和代码实际上是一回事的难题，因为代码是可执行数据。关于元语言抽象的章节对许多人来说是令人难以置信的，并且有许多带回家的信息。首先是所有规则都是任意的。这让一些学生感到困扰，特别是那些本质上是物理学家的学生。我认为美不在于规则本身，而在于研究规则的后果。代码中的一行更改可能意味着词法范围和动态范围之间的差异。

今天，尽管 SICP 对许多人来说仍然很有趣且富有洞察力，但我确实知道它已经过时了。一方面，它不教授调试技能和工具（我在其中包括类型系统），这对于在当今巨大的系统中工作至关重要。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-01T16:19:45.533

我最惊讶的是实现语言是多么容易。那个人可以将 Scheme 的解释器写在黑板上。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-29T16:23:26.447

读了SICP的一些章节后，我感受到了不同意义上的递归

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-18T18:09:15.523

我现在在“作为常规接口的序列”一节中，并且发现作为一等公民的过程的概念非常吸引人。此外，递归的应用是我在任何语言中从未见过的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-31T00:22:40.987

关闭。

来自主要的命令式背景（Java、C# 等——我大约一年前才第一次阅读 SICP，现在正在重新阅读），从函数角度思考对我来说是一个很大的启示；它彻底改变了我今天对工作的看法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-05-15T16:16:45.467

我阅读了本书的大部分内容（没有练习）。我学到的是如何在特定的层次上抽象现实世界，以及如何实现一门语言。

每章都有让我惊讶的想法：

前两章向我展示了两种抽象现实世界的方法：过程抽象和数据抽象。

第 3 章介绍了现实世界中的时间。这导致了状态。我们尝试分配，这会引发问题。然后我们尝试流。

第4章是元语言抽象，换句话说，我们通过构造一个评估器来实现一种新的语言，它决定了表达式的含义。

由于第 4 章中的求值器本身就是一个 Lisp 程序，它继承了底层 Lisp 系统的控制结构。因此，在第 5 章中，我们将借助抽象模型寄存器机深入研究真实计算机的逐步操作。

谢谢。

# apache-flex - Silverlight，异步，延迟加载什么是最好的方式？

> ID：355408
> 
> 赞同：0
> 
> 时间：2008-12-10T08:23:05.977
> 
> 标签：apache-flex, silverlight, lazy-loading

我开始使用 silverlight/flex 并立即遇到了异步服务调用。我习惯于使用一种或另一种服务器获取机制以 OO 方式解决数据访问问题。

我有以下简单的代码示例：

```
public double ComputeOrderTotal(Order order) 
{ 
   double total = 0;
   // OrderLines are lazy loaded
   foreach (Orderline line in order.Orderlines) 
   { 
       // Article,customer are lazy loaded 
       total = total + line.Article.Price - order.Customer.discount;
   }
   return total;
} 
```

如果我理解正确，这段代码在 Flex/Silverlight 中是不可能的。延迟加载迫使您使用回调。IMO 上面的简单示例将是一团糟。

谁能给我一种结构化的方式来实现上述内容？

编辑：

*   **Flex/Silverlight 的问题是一样的，伪代码就可以了**
*   **它不是真正与 ORM 相关，但大多数 orm 使用延迟加载，所以我将删除该标签**
*   **问题是模型中的延迟加载**
*   **上面的示例非常可行，因为所有数据都在内存中，但我们假设必须从服务器获取一些数据**
*   **Closueres 没有帮助，因为有时数据已经加载并且不需要异步获取**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T08:05:55.853

是的，我必须同意 O/R 映射通常在应用程序的服务器端完成。在 SilverLight 中，异步执行方式是使用服务时需要使用的模式。为什么是服务？因为正如我之前所说，目前没有可以在客户端（SilverLight）使用的 O/R 映射工具。最好的方法是让您的 O/R 映射数据由可以被 SilverLight 应用程序使用的服务公开。目前最好的方法是使用 Ado.Net DataServices 传输数据，并在客户端使用 LINQ to Services 管理数据。ADS（前 Astoria 项目）真正有趣的是它被设计为与实体框架一起使用，但好人也实现了对 IQueriable 的支持，所以基本上你可以连接任何支持 LINQ 的数据提供程序。[OpenAccess](http://www.telerik.com/products/orm.aspx "Telerik OpenAccess")、LLBLGen 等。要将更新推送回服务器，数据源需要支持 ADS IUpdateable。

您可以在我在这里准备的一系列博文中确切了解如何做到这一点：[ADO.NET 数据服务和 Telerik 开放访问入门](http://blogs.telerik.com/DimitarKapitanov/Posts.aspx "http://blogs.telerik.com/DimitarKapitanov/Posts.aspx")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T02:47:52.773

我无法与 Silverlight 交谈，但 Flex 是一种 Web 浏览器客户端技术，在 Flash 运行时中没有嵌入任何数据库驱动程序。您可以改为与 Web 服务器进行 HTTP 协议交互。它位于中间层 Web 服务器中，您可以在其中针对数据库连接执行任何 ORM，例如 Java JDBC。Hibernate ORM 和 iBATIS 是 Java 中间层空间中的两个流行选择。

另外，正因为如此：

[分布式计算的谬误](http://en.wikipedia.org/wiki/Fallacies_of_Distributed_Computing)

您不执行从 Flex 客户端到其中间层服务的同步交互。同步网络操作近来已被禁止，并且是设计不佳的应用程序的标志 - 由于上述链接中列举的原因，该应用程序可能（并且通常会）表现出非常糟糕的用户体验。

您改为进行异步调用以检索数据，将数据加载到客户端应用程序的模型对象中，然后继续在模型上实现操作。使用 Flex 和 BlazeDS，您还可以让中间层将数据推送到客户端并异步更新客户端的模型对象。（数据绑定是响应以事件驱动方式更新的数据的一种方式。）

所有这一切似乎与您发帖中询问的性质相去甚远——但您的发帖表明您在如何理解将异步和事件驱动编程融入其基础的客户端技术方面处于完全错误的基础上建筑学。这些 RIA 客户端技术完全是故意这样设计的。因此，如果您想获得良好且富有成效的使用体验，您将需要学习他们的思维方式。

在这篇文章中，我会以 Flex 的视角更详细地讨论这个问题：

[Flex 异步 I/O 与 Java 和 C# 显式线程](http://humbleblogger.blogspot.com/2008/05/flex-async-io-vs-java-and-c-explicit.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T02:55:19.233

根据我对 Flex 的直接体验，我认为这个讨论变得太复杂了。

您的概念 OO 视图在同步和异步之间没有什么不同。唯一的区别是您使用事件处理程序来处理 DAL 中的主机对话，而不是从方法调用返回的内容。这通常完全发生在主机端，与 Flex 或 Silverlight 无关。（如果您将 AIR 用于工作站应用程序，那么它可能在客户端代码中，但同样适用。如果您使用的是长时间的 AJAX。当然，Silverlight 没有 AIR 等效项。）

我已经能够设计出我需要的一切，而无需进行任何其他更改来适应异步。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T05:42:48.443

Flex 有一个单线程模型。如果您对 Web 服务器进行同步调用，您将阻止应用程序的整个 GUI。用户将有一个冻结的应用程序，直到调用完成（或在网络错误条件下超时等）。

当然，真正的 RIA 程序不是这样编写的。通过使用异步调用，他们的 GUI 仍然可以访问并响应用户。如果交互的性质允许，它还可以提供提供取消按钮等的真实进度指示器。

旧的、糟糕的用户体验 Web 1.0 应用程序在与 Web 层的交互中表现出同步行为。

正如我的链接文章所指出的，异步单线程模型与 ActionScript3 闭包相结合是一件好事，因为它是一种比替代方案（编写多线程应用程序）更简单的编程模型。多线程是编写客户端-服务器 Java Swing 或 C# .NET WinForm 应用程序的方法，以便在 GUI 中实现类似的响应式、始终流畅的用户体验。

这是另一篇深入探讨异步、消息传递/事件驱动的分布式应用程序架构的整个主题的文章：

[**构建有效的企业分布式软件系统** *数据驱动的通信与行为驱动的通信*](http://humbleblogger.blogspot.com/2006/08/building-effective-enterprise.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T11:07:49.620

Silverlight 是一种客户端技术，对象-关系映射完全发生在服务器中。所以你必须忘记 Silverlight 中的 ORM。

按照您的示例，您要做的是创建一个 Web 服务（SOAP、REST ...），它可以为您的 silverlight 客户端提供完整的“订单”对象。一旦你有了对象，你就可以使用它，而无需以正常的同步方式与服务器通信。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-21T16:23:26.487

谈到 Silverlight，您绝对应该检查[RIA 服务](http://silverlight.net/getstarted/riaservices/)。

简单地说，它将 DataContext 从服务器带到客户端，您可以从那里异步查询它（无需手动编写 WCF 服务，这一切都由 RIA 完成）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-12T12:04:49.847

C# 5 async / await 构造几乎正是我想要的..

[观看安德斯·海尔斯伯格的演讲](http://player.microsoftpdc.com/Session/1b127a7d-300e-4385-af8e-ac747fee677a)

# windows - Windows进程结构：如何存储用户信息？

> ID：355418
> 
> 赞同：0
> 
> 时间：2008-12-10T08:29:25.713
> 
> 标签：windows, security, winapi, kernel

我想在windows NT内核进程的EPROCESS结构中存储一些信息。我的目标是，当调用 winlogon 时，我想根据哪个用户登录为下一个进程分配一个唯一值。但我不知道在哪里存储这个唯一 ID。我已经尝试并成功地通过直接内核对象修改的方法修改了进程的 EPROCESS 块中的一些信息（如令牌），我想知道这个 EPROCESS 块中是否有任何结构可以存储一些其他信息。

ps 为了修改 EPROCESS 块，我使用了设备驱动程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T18:45:21.253

EPROCESS 结构是不透明且未记录的，这意味着您不应该弄乱它的内部结构。这样做需要您在计划支持的每个操作系统版本和服务包上进行测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T20:30:48.590

不要修改 EPROCESS。它会给你带来巨大的悲伤。

此外，如果您这样做，请不要将其安装在任何其他人的机器上。将这种具有深远破坏性、破坏系统稳定性的更改强加于他人计算机上是绝对错误的。如果我给你肺结核会怎样？

# wpf - 如何通过样式设置 WPF 的 Grid.RowDefinitions

> ID：355420
> 
> 赞同：12
> 
> 时间：2008-12-10T08:31:32.120
> 
> 标签：wpf, grid, styles

我正在使用几个`Grid`s 来格式化多个`GridViewColumn.CellTemplate`s：

```
<ListView SharedSizeScope="true">
  <ListView.View>
    <GridView>
      <GridViewColumn>
        <GridViewColumn.CellTemplate>
          <DataTemplate>
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition SharedSizeGroup="foo" />
                <!-- ... --> 
```

我试图将`RowDefinition`s （所有列都相同）提取到 a 中`Style`：

```
<Style TargetType="{x:Type Grid}">
  <Setter Property="RowDefinitions">
    <Setter.Value>
      <RowDefinition SharedSizeGroup="foo" />
      <!-- ... --> 
```

但是编译器抱怨：

> 错误：无法设置属性设置器“RowDefinitions”，因为它没有可访问的设置访问器。

这很明显，但不是很有帮助。

我如何避免多次指定行定义（另请参阅[不要重复自己](http://c2.com/cgi/wiki?DontRepeatYourself)），而不是编写自定义派生的`Grid`?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-10T08:41:45.313

Grid 不支持控件模板（信息取自[此处](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/731bf94e-0881-49e1-a35a-99a2e2ca647f/)，间接取自[此处](http://social.expression.microsoft.com/Forums/en-US/wpf/thread/51448155-637c-469d-856b-ff81552fe980/)）。

# date - cmd脚本中的日期算术

> ID：355425
> 
> 赞同：11
> 
> 时间：2008-12-10T08:36:43.403
> 
> 标签：date, batch-file, cmd, scripting

我需要编写一个脚本来将文件名从 aDate.txt 更改为 bDate.txt，其中：

*   aDate 是*yyyymmdd*格式的当前系统日期，并且
*   bDate 是当前系统日期 - 1，格式为*yyyymmdd 。*

我目前有：

```
set yy=%date:~6,2%
set mm=%date:~3,2%
set dd=%date:~0,2%
if "%date:~6,1%"==" " set yy=0%yy:~1,1%
if "%date:~3,1%"==" " set mm=0%mm:~1,1%
if "%date:~0,1%"==" " set dd=0%dd:~1,1%
SET sys_date=20%yy%%mm%%dd%
ECHO %sys_date%
REM still have to do this bit properly
SET sys_date_yesterday=%sys_date%a
move %sys_date%.txt %sys_date_yesterday%.txt 
```

但我不知道如何做日期 -1 的事情（除了长篇大论）从一天中减去 1，如果那是 = 0，那么从月份中减去一个并将日期设置为新月份的最后一天等等多年。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T09:59:25.547

你必须以困难的方式去做。我建议使用SteveGTR 的[这个解决方案。](http://www.experts-exchange.com/OS/Microsoft_Operating_Systems/MS_DOS/Q_21316459.html)我复制下面的文字，因为至少我不能总是在那个网站上看到解决方案。

* * *

这是我开发的一个批处理文件，用于从当前日期减去任意天数。它接受天数的命令行参数。默认值为 1 天（昨天）：

```
@echo off

set yyyy=

set $tok=1-3
for /f "tokens=1 delims=.:/-, " %%u in ('date /t') do set $d1=%%u
if "%$d1:~0,1%" GTR "9" set $tok=2-4
for /f "tokens=%$tok% delims=.:/-, " %%u in ('date /t') do (
 for /f "skip=1 tokens=2-4 delims=/-,()." %%x in ('echo.^|date') do (
    set %%x=%%u
    set %%y=%%v
    set %%z=%%w
    set $d1=
    set $tok=))

if "%yyyy%"=="" set yyyy=%yy%
if /I %yyyy% LSS 100 set /A yyyy=2000 + 1%yyyy% - 100

set CurDate=%mm%/%dd%/%yyyy%

set dayCnt=%1

if "%dayCnt%"=="" set dayCnt=1

REM Substract your days here
set /A dd=1%dd% - 100 - %dayCnt%
set /A mm=1%mm% - 100

:CHKDAY

if /I %dd% GTR 0 goto DONE

set /A mm=%mm% - 1

if /I %mm% GTR 0 goto ADJUSTDAY

set /A mm=12
set /A yyyy=%yyyy% - 1

:ADJUSTDAY

if %mm%==1 goto SET31
if %mm%==2 goto LEAPCHK
if %mm%==3 goto SET31
if %mm%==4 goto SET30
if %mm%==5 goto SET31
if %mm%==6 goto SET30
if %mm%==7 goto SET31
if %mm%==8 goto SET31
if %mm%==9 goto SET30
if %mm%==10 goto SET31
if %mm%==11 goto SET30
REM ** Month 12 falls through

:SET31

set /A dd=31 + %dd%

goto CHKDAY

:SET30

set /A dd=30 + %dd%

goto CHKDAY

:LEAPCHK

set /A tt=%yyyy% %% 4

if not %tt%==0 goto SET28

set /A tt=%yyyy% %% 100

if not %tt%==0 goto SET29

set /A tt=%yyyy% %% 400

if %tt%==0 goto SET29

:SET28

set /A dd=28 + %dd%

goto CHKDAY

:SET29

set /A dd=29 + %dd%

goto CHKDAY

:DONE

if /I %mm% LSS 10 set mm=0%mm%
if /I %dd% LSS 10 set dd=0%dd%

echo Date %dayCnt% day(s) before %CurDate% is %mm%/%dd%/%yyyy% 
```

祝你好运，史蒂夫

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-22T16:48:55.930

## 使用 Windows 批处理脚本轻松地从日期中添加或减去天数

这是我想出的使用批处理脚本计算日期（加法或减法）的解决方案。根据您的需要相应地设置变量，然后根据您的需要调整逻辑。这非常适合我的需求，并且它都包含在同一个批处理脚本中，没有太多逻辑。

**添加：**您还可以使用此脚本通过从例程中的 以下批处理脚本中**删除**减号**（`-`**这些行，现在变量值将等于您要添加的天数。**`:DynamicVBSScriptBuild`**`,-%MinusDay%,``,%MinusDay%,``MinusDay=`

**重要提示：**似乎五个 9 ( ) 是用值`99999`减去时批处理脚本的限制。加上值时`MinusDays=`，六个 9 ( ) 似乎也是批处理脚本的限制。`999999``MinusDays=`

**批处理脚本**

```
@ECHO ON

::// Minus days is the number of days to subtract from the CURRENT DAY i.e. 2 for minus 2 days or 99999 for minus 99999 days from when it's run
SET MinusDay=2

:: This calls the temp vbs script routine that will be used to set YYYY-MM-DD values for the subtracted days date you specify
CALL :DynamicVBSScriptBuild

FOR /F "TOKENS=*" %%A IN ('cscript//nologo "%YYYYTmpVBS%"') DO SET YYYY=%%A
FOR /F "TOKENS=*" %%A IN ('cscript//nologo "%MMTmpVBS%"') DO SET MM=%%A
FOR /F "TOKENS=*" %%A IN ('cscript//nologo "%DDTmpVBS%"') DO SET DD=%%A

::// Set your web server log file path in the below variable
SET WebServerLogPath=C:\WebServer\Logs

::// Set web server log file name where YYYY MM DD variables are set to the values after the day numbers setup above are subtracted
SET YYYY=%YYYY%
SET MM=%MM%
SET DD=%DD%

ECHO %YYYY%%MM%%DD%
PAUSE

GOTO EOF

:DynamicVBSScriptBuild
SET YYYYTmpVBS=%temp%\~tmp_yyyy.vbs
SET MMTmpVBS=%temp%\~tmp_mm.vbs
SET DDTmpVBS=%temp%\~tmp_dd.vbs
IF EXIST "%YYYYTmpVBS%" DEL /Q /F "%YYYYTmpVBS%"
IF EXIST "%MMTmpVBS%" DEL /Q /F "%MMTmpVBS%"
IF EXIST "%DDTmpVBS%" DEL /Q /F "%DDTmpVBS%"
ECHO dt = DateAdd("d",-%MinusDay%,date) >> "%YYYYTmpVBS%"
ECHO yyyy = Year(dt)                    >> "%YYYYTmpVBS%"
ECHO WScript.Echo yyyy                  >> "%YYYYTmpVBS%"
ECHO dt = DateAdd("d",-%MinusDay%,date) >> "%MMTmpVBS%"
ECHO mm = Right("0" ^& Month(dt),2)     >> "%MMTmpVBS%"
ECHO WScript.Echo mm                    >> "%MMTmpVBS%"
ECHO dt = DateAdd("d",-%MinusDay%,date) >> "%DDTmpVBS%"
ECHO dd = Right("0" ^& Day(dt),2)       >> "%DDTmpVBS%"
ECHO WScript.Echo dd                    >> "%DDTmpVBS%"
GOTO EOF 
```

* * *

## 更多资源

*   [**为 /F**](http://ss64.com/nt/for_f.html)
*   [**脚本**](http://ss64.com/vb/cscript.html)
*   [**脚本**](http://ss64.com/vb/syntax-wscript.html)
*   [**添加日期**](http://ss64.com/vb/dateadd.html)
*   [**正确的**](http://ss64.com/vb/right.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T04:06:50.943

换句话说，试试这个代码。您可以将其用作脚本子例程或将其与 CALL 和参数函数一起使用以传递回原始批处理文件：

```
:: Pass 1st parameter as number of days (whole numbers) to subtract from current day in   date
:: This script is able to subtract days to any date of the current date
:: This script will check for leap years, etc. as well
@echo on
::for /f "tokens=2-4 delims=/ " %%A in ("%date%") do set "mm=%%A" do & set "dd=%%B" do & set "yyyy=%%C"
set "mm=%date:~4,2%" & set "dd=%date:~7,2%" & set "yyyy=%date:~10,4%"
set CurDate=%mm%/%dd%/%yyyy%
set dayCnt=%1
if "%dayCnt%"=="" set dayCnt=1
:: Substract your days here
set /A dd=1%dd% - 100 - %dayCnt%
set /A mm=1%mm% - 100
:CHKDAY
if /I %dd% GTR 0 goto DONE
set /A mm=%mm% - 1
if /I %mm% GTR 0 goto ADJUSTDAY
set /A mm=12
set /A yyyy=%yyyy% - 1
:ADJUSTDAY
if %mm%==1 goto SET31
if %mm%==2 goto LEAPCHK
if %mm%==3 goto SET31
if %mm%==4 goto SET30
if %mm%==5 goto SET31
if %mm%==6 goto SET30
if %mm%==7 goto SET31
if %mm%==8 goto SET31
if %mm%==9 goto SET30
if %mm%==10 goto SET31
if %mm%==11 goto SET30
:: ** Month 12 falls through
:SET31
set /A dd=31 + %dd%
goto CHKDAY
:SET30
set /A dd=30 + %dd%
goto CHKDAY
:LEAPCHK
set /A tt=%yyyy% %% 4
if not %tt%==0 goto SET28
set /A tt=%yyyy% %% 100
if not %tt%==0 goto SET29
set /A tt=%yyyy% %% 400
if %tt%==0 goto SET29
:SET28
set /A dd=28 + %dd%
goto CHKDAY
:SET29
set /A dd=29 + %dd%
goto CHKDAY
:DONE
if /I %mm% LSS 10 set mm=0%mm%
if /I %dd% LSS 10 set dd=0%dd%
echo Date %dayCnt% day(s) before %CurDate% is %mm%/%dd%/%yyyy%
SET DirDate=%mm%/%dd%/%yyyy%
:: The %2 parameter is passed from the calling script as the full path and name of the          file to call back
:: %2 equals %~fnx0
:: The dirdate variable is passed as parameter %1 back to the calling script
Call %2 %dirdate%
GOTO EOF 
```

我将寻找一个 vb 或更有效的东西，我仍然可以合并或从批处理中调用以动态计算日期。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T01:48:06.190

我需要一些可以在检查闰年等时从当前日期减去天数的东西，这很好用。

我只是从那些带有所需参数（要减去的天数）的脚本中调用它，然后让它用替换回调调用脚本并将参数传递回原始脚本以获取修改（减去）日期。

以下是示例：

需要日期计算变量集的脚本：

```
IF "%1"=="" goto modifydate

:modifydate
SET subtractdays=5
SET ModDateScript=\\servershare\path\Called_Scripts\ModDate.cmd
CALL "%ModDateScript%" %subtractdays% "%~fnx0" 
```

将计算 %moddate% 参数并将其传递回原始调用脚本的脚本，以将其设置为变量，以便相应地进行处理。您只需将其放在您调用的脚本的末尾，以便从当前日期 (ModDate.cmd) 中修改/减去天数。

```
SET moddate=%mm%/%dd%/%yyyy%
Call %2 %moddate%
GOTO EOF 
```

我能够测试并确定发布的原始脚本中的这些行：

```
set yyyy=
set $tok=1-3
for /f "tokens=1 delims=.:/-, " %%u in ('date /t') do set $d1=%%u
if "%$d1:~0,1%" GTR "9" set $tok=2-4
for /f "tokens=%$tok% delims=.:/-, " %%u in ('date /t') do (
for /f "skip=1 tokens=2-4 delims=/-,()." %%x in ('echo.^|date') do (
    set %%x=%%u
    set %%y=%%v
    set %%z=%%w
    set $d1=
    set $tok=))
if "%yyyy%"=="" set yyyy=%yy%
if /I %yyyy% LSS 100 set /A yyyy=2000 + 1%yyyy% - 100 
```

可以仅用这一行替换，它也可以正常工作：

```
FOR /F "tokens=2-4 delims=/ " %%A IN ("%date%") DO SET "mm=%%A" DO (& SET "dd=%%B") DO (& SET "yyyy=%%C") 
```

请解释这些行（我用 and 语句更改为一行）无论如何都做了什么，因为我无法快速区分差异。我减去回到 19 世纪，这对我来说似乎是准确的。我想也许它有助于处理修改后的年份小于 2000 的计算——但除非我遗漏了什么，否则我看不到这一点。

否则，这个脚本可以很容易地被调用并将 %mm%/%dd%/%yyyy% 作为参数传回给需要自己计算的几个脚本。伟大且非常有效的批处理解决方案。我可以将参数作为 %1、%2、%3 等传递，并且仍然使用该脚本中的 setlocal 作为当前日期——只需创建一个类似于 moddate=%1 等的变量。

最后，我挑战任何批处理脚本专家进一步优化此脚本并将结果发回给批处理人员进行测试。

谢谢，P

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-29T12:39:10.043

在 ss64.com 上找到此脚本：[https](https://ss64.com/nt/syntax-datemath.html) ://ss64.com/nt/syntax-datemath.html （许可证：[https](https://ss64.com/docs/copyright.html) ://ss64.com/docs/copyright.html ）

您可以将其分开并从批处理文件中调用它，而不会弄乱您的代码，它会用操作结果填充一些环境变量。

例如，这会将当前日期减去一天（在我的系统上，日期以“dd/mm/yyyy”格式返回）：

```
set YY=%date:~-4,4%
set MM=%date:~-7,2%
set DD=%date:~-10,2
call datemath.bat %YY% %MM% %DD% - 1
echo year=%_yy_int%, month=%_mm_int%, day=%_dd_int%
echo padded date:%_ymd_str%, padded month:%_mm_str%, padded day:%_dd_str% 
```

剧本：

```
 @ECHO off
   SETLOCAL
   :: DateMath, a general purpose date math routine

   :: If DateMath detects an error, variable _dd_int is set to 999999.
   SET v_dd_int=0
   SET v_mm_int=0 
   SET v_yy_int=0
   SET v_ymd_str=
   SET v_mm_str=
   SET v_dd_str=

   IF "%3"=="" goto s_syntax
   IF "%4"=="+" goto s_validate_year
   IF "%4"=="-" goto s_validate_year
   IF "%4"=="" goto s_validate_year

   :s_syntax
   echo:
   echo DATEMATH SYNTAX:
   echo _______________
   echo:
   echo DateMath will set the variables as listed below
   echo 'str' variables include leading zeros e.g. "01"
   echo 'int' variables leading zeros are stripped e.g. "1"
   echo:
   echo CALL DateMath YY MM DD - YY2 MM2 DD2 
   echo:
   echo Will set variable _dd_int to the signed difference
   echo between the 2 dates (measured in days)
   echo:
   echo:
   echo CALL DateMath YY MM DD +/- Days 
   echo:
   echo Will set the following variables to the result of 
   echo adding or substracting days from the initial date:
   echo    _ymd_str, _yy_int
   echo    _mm_str, _mm_int,
   echo    _dd_str, _dd_int
   echo:
   echo:
   echo ___________________________________
   pause

   echo:
   echo:
   echo CALL DateMath YY MM DD
   echo:
   echo Will set the following variables:
   echo    _ymd_str, _yy_int
   echo    _mm_str, _mm_int,
   echo    _dd_str, _dd_int
   echo:
   echo ___________________________________
   echo:
   echo _ymd_str is in YYYYMMDD format.
   echo:
   echo _yy_int is in YYYY format, even if YY format was originally supplied.
   echo This conversion is useful for FAT/NTFS file dates which are in YY format.
   echo:

   ENDLOCAL & SET /a _dd_int=999999
   goto :eof

   :s_validate_year
   ::strip leading zeros
    SET v_yy=%1
    if %v_yy:~0,1% EQU 0 set v_yy=%v_yy:~1%

    :: Check for Y2K
    IF %v_yy% LSS 100 IF %v_yy% GEQ 80 SET /A v_yy += 1900
    IF %v_yy% LSS 80 SET /A v_yy += 2000

    :: at this point v_yy contains a 4 digit year

   ::validate month and day
    if %2 GTR 12 goto s_syntax
    if %3 GTR 31 goto s_syntax

    SET v_mm=%2
    SET v_dd=%3

    ::strip leading zeros
    if %v_mm:~0,1% EQU 0 set v_mm=%v_mm:~1%
    if %v_dd:~0,1% EQU 0 set v_dd=%v_dd:~1%

   :: Set the int variables
    SET /a v_dd_int=%v_dd%
    SET /a v_yy_int=%v_yy%
    SET /a v_mm_int=%v_mm%

   :: Determine which function to perform - ADD, SUBTRACT or CONVERT

    If not "%6"=="" goto s_validate_2nd_date 
    if "%4"=="" goto s_convert_only

   :: Add or subtract  days to a date
    SET /a v_number_of_days=%5
    goto s_add_or_subtract_days

   :s_convert_only

    SET /a v_dd_int=%v_dd%
    IF %v_dd% LEQ 9 (SET v_dd_str=0%v_dd%) ELSE (SET v_dd_str=%v_dd%)
    IF %v_mm% LEQ 9 (SET v_mm_str=0%v_mm%) ELSE (SET v_mm_str=%v_mm%)
    SET v_ymd_str=%v_yy%%v_mm_str%%v_dd_str%

   ECHO DATEMATH - Convert date only (no maths)
   goto s_end
   ::::::::::::::::::::::::::::::::::::::::::::::::::

   :s_validate_2nd_date
    If "%4"=="+" goto s_syntax
    :: Subtracting one date from another ::::::
    :: strip leading zero
    SET v_yy2=%5
    if %v_yy2:~0,1% EQU 0 set v_yy2=%v_yy2:~1%

    if %v_yy2% GTR 99 goto s_validate2nd_month
    if %v_yy2% GTR 49 goto s_prefix_2_1950_1999
    if %v_yy2% LSS 10 goto s_prefix_2_2000_2009
    SET v_yy2=20%v_yy2%
    goto s_validate2nd_month

   :s_prefix_2_2000_2009
    SET v_yy2=200%v_yy2%
    goto s_validate2nd_month

   :s_prefix_2_1950_1999
    SET v_yy2=19%v_yy2%

   :s_validate2nd_month
    ::strip leading zeros
    ::SET /a v_yy2=%v_yy2%
    if %v_yy2:~0,1% EQU 0 set v_yy2=%v_yy2:~1%
    ::v_yy2 now contains a 4 digit year

    if %6 GTR 12 goto s_syntax
    SET v_mm2=%6

    if %7 GTR 31 goto s_syntax
    SET v_dd2=%7

    ::strip leading zeros
    ::SET /a v_mm2=%v_mm2%
    if %v_mm2:~0,1% EQU 0 set v_mm2=%v_mm2:~1%
    ::SET /a v_dd2=%v_dd2%
    if %v_dd2:~0,1% EQU 0 set v_dd2=%v_dd2:~1%

   call :s_julian_day %v_yy_int% %v_mm_int% %v_dd_int%
   SET v_sumdays1=%v_JulianDay%

   call :s_julian_day %v_yy2% %v_mm2% %v_dd2%
   SET v_sumdays2=%v_JulianDay%

   SET /a v_dd_int=%v_sumdays1% - %v_sumdays2%

   ECHO DATEMATH - Subtracting one date from another = days difference
   ECHO ~~~~~~
   ECHO %v_dd_int%
   ECHO ~~~~~~
   goto s_end_days
   ::::::::::::::::::::::::::::::::::::::::::::::::::

   :s_add_or_subtract_days
   if /i "%4"=="+" goto s_add_up_days

   :: Subtract all days ::::::
   SET /a v_dd=%v_dd% - %v_number_of_days%

   :s_adjust_month_year
   if %v_dd% GEQ 1 goto s_add_subtract_days_DONE
   SET /a v_mm=%v_mm% - 1
   if %v_mm% GEQ 1 goto s_add_days_%v_mm%
   SET /a v_yy=%v_yy% - 1
   SET /a v_mm=%v_mm% + 12
   goto s_add_days_%v_mm%

   :s_add_days_2
   SET /a v_dd=%v_dd% + 28
   SET /a v_leapyear=%v_yy% / 4
   SET /a v_leapyear=%v_leapyear% * 4
   if %v_leapyear% NEQ %v_yy% goto s_adjust_month_year
   SET /a v_dd=%v_dd% + 1
   goto s_adjust_month_year

   :s_add_days_4
   :s_add_days_6
   :s_add_days_9
   :s_add_days_11
   SET /a v_dd=%v_dd% + 30
   goto s_adjust_month_year

   :s_add_days_1
   :s_add_days_3
   :s_add_days_5
   :s_add_days_7
   :s_add_days_8
   :s_add_days_10
   :s_add_days_12
   SET /a v_dd=%v_dd% + 31
   goto s_adjust_month_year

   :s_add_up_days
   :: add all days ::::::
   SET /a v_dd=%v_dd% + %v_number_of_days%

   :s_subtract_days_
   goto s_subtract_days_%v_mm%

   :s_adjust_mth_yr
   SET /a v_mm=%v_mm% + 1
   if %v_mm% LEQ 12 goto s_subtract_days_%v_mm%
   SET /a v_yy=%v_yy% + 1
   SET /a v_mm=%v_mm% - 12
   goto s_subtract_days_%v_mm%

   :s_subtract_days_2
   SET /a v_leapyear=%v_yy% / 4
   SET /a v_leapyear=%v_leapyear% * 4
   If %v_leapyear% EQU %v_yy% goto s_subtract_leapyear

   if %v_dd% LEQ 28 goto s_add_subtract_days_DONE
   SET /a v_dd=%v_dd% - 28
   goto s_adjust_mth_yr

   :s_subtract_leapyear
   if %v_dd% LEQ 29 goto s_add_subtract_days_DONE
   SET /a v_dd=%v_dd% - 29
   goto s_adjust_mth_yr

   :s_subtract_days_4
   :s_subtract_days_6
   :s_subtract_days_9
   :s_subtract_days_11
   if %v_dd% LEQ 30 goto s_add_subtract_days_DONE
   SET /a v_dd=%v_dd% - 30
   goto s_adjust_mth_yr

   :s_subtract_days_1
   :s_subtract_days_3
   :s_subtract_days_5
   :s_subtract_days_7
   :s_subtract_days_8
   :s_subtract_days_10
   :s_subtract_days_12
   if %v_dd% LEQ 31 goto s_add_subtract_days_DONE
   SET /a v_dd=%v_dd% - 31
   goto s_adjust_mth_yr

   :s_add_subtract_days_DONE
   SET /a v_dd_int=%v_dd%
   SET /a v_mm_int=%v_mm%
   SET /a v_yy_int=%v_yy%
   IF %v_dd% GTR 9 (SET v_dd_str=%v_dd%) ELSE (SET v_dd_str=0%v_dd%)
   IF %v_mm% GTR 9 (SET v_mm_str=%v_mm%) ELSE (SET v_mm_str=0%v_mm%)
   SET v_ymd_str=%v_yy%%v_mm_str%%v_dd_str%

   ECHO DATEMATH - add or subtract days from a date = new date
   goto s_end
   ::::::::::::::::::::::::::::::::::::::::::::::::::

   :s_julian_day
   SET v_year=%1
   SET v_month=%2
   SET v_day=%3

   SET /a v_month=v_month
   SET /a v_day=v_day

   SET /A a = 14 - v_month
   SET /A a /= 12
   SET /A y = v_year + 4800 - a
   SET /A m = v_month + 12 * a - 3
   SET /A m = 153 * m + 2
   SET /A m /= 5
   SET /A v_JulianDay = v_day + m + 365 * y + y / 4 - y / 100 + y / 400 - 32045

   ECHO The Julian Day is [%v_JulianDay%]
   goto :eof
   ::::::::::::::::::::::::::::::::::::::::::::::::::

   :s_end
   ECHO ~~~~~~~~~~~~
   ECHO [%v_ymd_str%] YY=[%v_yy_int%] MM=[%v_mm_str%] DD=[%v_dd_str%]
   ECHO ~~~~~~~~~~~~
   :s_end_days
   ENDLOCAL&SET /a _yy_int=%v_yy_int%&SET /a _mm_int=%v_mm_int%&SET /a _dd_int=%v_dd_int%&SET _ymd_str=%v_ymd_str%&SET _mm_str=%v_mm_str%&SET _dd_str=%v_dd_str% 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-04T09:57:41.460

可以通过将 jscript 代码添加到批处理文件来完成。这是`dayAdder.bat`只接受一个参数的 - 您要添加到当前日期并打印结果的天数：

```
 @if (@X) == (@Y) @end /* JScript comment 
    @echo off   
    cscript //E:JScript //nologo "%~f0" %*
    exit /b %errorlevel%       
@if (@X)==(@Y) @end JScript comment */

var days=parseInt(WScript.Arguments.Item(0));

Date.prototype.addDays = function(days) {
    var date = new Date(this.valueOf());
    date.setDate(date.getDate() + days);
    return date;
}

var date = new Date();

WScript.Echo(date.addDays(5));
WScript.Echo("Year: " + date.getFullYear());
WScript.Echo("Month: " + date.getMonth());
WScript.Echo("DayOfTeWEek: " + date.getDay()); 
```

示例和输出：

```
E:\scripts>dayAdder.bat 7
Sun Nov 8 16:27:48 UTC+0200 2020
Year: 2020
Month: 10
DayOfTeWEek: 2
DayOfTheMonth: 3 
```

您可以以适合您的方式对其进行修改。

# asp.net - 如何将参数传递给 Web 方法？

> ID：355429
> 
> 赞同：2
> 
> 时间：2008-12-10T08:38:51.293
> 
> 标签：asp.net, web-services, asmx

如何将参数传递给 Asp.Net(C#) 中的 [WebMethod]？有人可以在一个例子的帮助下解释一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T09:51:25.097

添加 Web 引用后，您必须创建包含 Web 方法的类的实例，然后以与任何其他方法完全相同的方式传递参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T14:23:28.993

你可以在这里看到一个例子：http: [//support.microsoft.com/kb/818364](http://support.microsoft.com/kb/818364)

如果 helloWorld 示例收到一个字符串，您可以像这样调用它： myService.HelloWorld("Example");

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-03T13:32:42.083

请参阅[如何使用 Web 服务](http://johnwsaundersiii.spaces.live.com/blog/cns!600A2BE4A82EA0A6!790.entry)。即使从 WCF 服务和服务参考的角度来看，它也主要适用于旧版 ASMX Web 参考。

# wget - “wget --domains”没有帮助..我做错了什么？

> ID：355439
> 
> 赞同：13
> 
> 时间：2008-12-10T08:43:39.413
> 
> 标签：wget

我正在尝试使用 wget 递归地仅从特定网站获取 .jpg 文件，以期为自己创建一个有趣的屏幕保护程序。真的没有那么远大的目标。

问题是图片托管在其他地方（mfrost.typepad.com），而不是网站的主域（www.cuteoverload.com）。

我曾尝试使用“-D”来指定允许的域，但遗憾的是没有可爱的 jpgs 即将出现。我怎样才能改变下面的行来完成这项工作？

```
wget -r -l2 -np -w1 -D www.cuteoverload.com,mfrost.typepad.com -A.jpg -R.html.php.gif www.cuteoverload.com/ 
```

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-10T09:01:25.600

对*wget*的手册页 [1] 的检查说明了 -D：

> 设置要遵循的域。domain-list 是以逗号分隔的域列表。请注意，它不会打开 -H。

这个关于 -H 的建议看起来很有趣：

> 在进行递归检索时启用跨主机。

因此，您只需将 -H 标志添加到您的调用中。

（完成此操作后，看起来所有图像都仅限于*mfrost.typepad.com/cute_overload/images/2008/12/07*和*mfrost.typepad.com/cute_overload/images/2008/12/08*）。

-- [1] 虽然*wget*的主要参考手册是信息格式。

# build-process - OpenOffice 命令行 PDF 创建

> ID：355447
> 
> 赞同：16
> 
> 时间：2008-12-10T08:49:07.733
> 
> 标签：build-process, build-automation, nant, openoffice.org, libreoffice

我有一些用 OpenOffice 编写的文档，我想将其中的一些作为 PDF 文件包含在最终的构建交付中。我想用自动构建脚本来做到这一点。

有没有办法使用命令行命令从 OpenOffice 创建 PDF 文件？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-20T08:25:32.193

截至 2012 年 9 月，LibreOffice 可以从命令行将文档转换为 PDF：

```
lowriter --headless --convert-to pdf yourfile.odt 
```

它还具有批量转换支持：

```
lowriter --headless --convert-to pdf yourfiles*.odt 
```

将所有与模式匹配的文件转换为相应的 PDF 文件。

运行此命令时，不得打开任何 LibreOffice 窗口。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-16T11:32:24.757

有一个很棒的工具叫做“unoconv”，它在我的 Ubuntu 存储库中。它将[ODF](http://en.wikipedia.org/wiki/OpenDocument)、[.ods](http://en.wikipedia.org/wiki/OpenDocument#Specifications)、 ... 转换为 PDF，我也认为是其他格式。

我还可以将 PowerPoint 文件转换为 PDF。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-10T09:03:40.807

[Art of Solving](http://www.artofsolving.com/opensource/jodconverter)还有一个非常好的 API 可以在 Java 中执行转换。它有点慢，但很简单。这就是我使用它的方式：

```
 File inputFile = new File("C:\\oreyes\\hola.doc"); 
        File outputFile = new File("C:\\oreyes\\hola.pdf"); 
        OpenOfficeConnection connection = new SocketOpenOfficeConnection(8100);
        try { 
            connection.connect(); 
        } catch(Exception e) {}

        DocumentConverter converter = new OpenOfficeDocumentConverter(connection);
        converter.convert(inputFile, outputFile); 
        connection.disconnect(); 
```

您可以使用它创建一个 jar 并从命令行处理它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-19T11:46:52.947

虽然这个问题有点老了，但这里有一些东西是为了记录 LibreOffice 解决方案的一些常见缺陷：

*   如果`lowriter`对您不起作用，因为它会忽略命令行参数并调出 gui，只需尝试调用`libreoffice`or`loffice`二进制文件：

    `loffice --headless --convert-to pdf yourfile.odt`

*   如果您收到此消息

    `Error: Please reverify input parameters...`

    尝试以 root 身份运行它（例如通过 sudo）。这在安装了 LibreOffice 3 的 Ubuntu 12.04 LTS 上帮助了我，也可能是在没有适当配置的情况下无法在网络服务器上运行此转换的原因（[除非 root，否则 Libreoffice --headless 拒绝转换，无法从 PHP 脚本](https://stackoverflow.com/questions/12101855/libreoffice-headless-refuses-to-convert-unless-root-wont-work-from-php-scrip)运行）

*   还要确保您没有运行任何其他 LibreOffice 实例，否则它会静默失败并且根本不进行任何转换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-26T16:02:35.697

有[anytopdf](http://code.google.com/p/anytopdf/)。自己没试过。

引用...

> anytopdf 是一个 perl 脚本，可将 OpenOffice.org、Microsoft Office（Word DOC、Excel XLS）、RTF、HTML 和其他 openoffice.org 可读文件格式转换为 PDF 格式。如果当前用户的 OpenOffice.org 配置中不存在支持的“AnyToPDF”OpenOffice.org Basic 宏库，它将自动安装它。
> 
> 致力于和平、爱、理解和尊重所有众生。

# iphone - Objective-C 中的单例共享数据源

> ID：355449
> 
> 赞同：3
> 
> 时间：2008-12-10T08:49:44.017
> 
> 标签：iphone, objective-c, singleton

嘿伙计们 - 我正在编写一个非常简单的 iPhone 应用程序。数据来自一个 plist 文件（基本上是 NSDictionary），我试图将它加载到一个单例类中，并在我的各种视图控制器中使用它来访问数据。

[这是我的单例的实现（在这个线程](https://stackoverflow.com/questions/145154/what-does-your-objective-c-singleton-look-like)之后大量建模）

```
@implementation SearchData

@synthesize searchDict;
@synthesize searchArray;

- (id)init {
    if (self = [super init]) {
        NSString *path = [[NSBundle mainBundle] bundlePath];
        NSString *finalPath = [path stringByAppendingPathComponent:@"searches.plist"];
        searchDict = [NSDictionary dictionaryWithContentsOfFile:finalPath];
        searchArray = [searchDict allKeys];
    }

    return self;
}

- (void)dealloc {
    [searchDict release];
    [searchArray release];
    [super dealloc];
}

static SearchData *sharedSingleton = NULL;

+ (SearchData *)sharedSearchData {
    @synchronized(self) {
        if (sharedSingleton == NULL)
            sharedSingleton = [[self alloc] init];
    }   
    return(sharedSingleton);
}

@end 
```

因此，每当我尝试访问应用程序中其他地方的 searchDict 或 searchArray 属性（如 TableView 委托）时，如下所示：

```
[[[SearchData sharedSearchData] searchArray] objectAtIndex:indexPath.row] 
```

我收到一个异常说明 *** -[NSCFSet objectAtIndex:]: unrecognized selector sent to instance 0x5551f0

我不太确定为什么将 objectAtIndex 消息发送到 NSCFSet 对象，我觉得我的单例实现错误或其他什么。我还尝试了一种更复杂的单例实现，就像苹果在[上述线程](https://stackoverflow.com/questions/145154/what-does-your-objective-c-singleton-look-like)中推荐的那样，并且遇到了同样的问题。感谢您提供的任何见解。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-10T08:59:14.233

在您的`-init`方法中，您直接访问您的实例变量并且您没有保留它们。它们将被释放，并且它们的内存在应用程序生命周期的后期被其他对象用完。

要么保留你在那里创建的对象，要么使用不方便的方法来生成它们。

```
searchDict = [[NSDictionary alloc] initWithContentsOfFile:finalPath];
searchArray = [[searchDict allKeys] retain]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T14:02:21.297

每当您分配合成变量时，请通过“自我”进行，因此：

```
- (id)init {
  if (self = [super init]) {
      NSString *path = [[NSBundle mainBundle] bundlePath];
      NSString *finalPath = [path stringByAppendingPathComponent:@"searches.plist"];
      self.searchDict = [NSDictionary dictionaryWithContentsOfFile:finalPath];
      self.searchArray = [searchDict allKeys];
  }

  return self; 
```

}

还要确保您已将这些变量设置为“保留”在头文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-03T08:49:25.213

> 嗨，你能告诉我当我们通过'self'分配合成变量时有什么优势吗？谢谢湿婆

这些值是通过设置器设置的；它释放先前的值并保留您分配的值。

# coredump - 如何获取已向已退出转储核心的另一个进程发送 SIGABRT 信号的进程的 pid

> ID：355451
> 
> 赞同：0
> 
> 时间：2008-12-10T08:50:24.500
> 
> 标签：coredump

如何获取已向已退出转储核心的另一个进程发送 SIGABRT 信号的进程的 pid

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T09:54:21.220

简而言之，通过为 SIGABRT 安装信号处理程序。更具体地说，如果您`SA_SIGINFO`在安装信号处理程序时指定标志，则`siginfo_t`结构应该填充有关信号的额外信息，包括发送者的 PID 等。

# perl - 如何在 Perl 中打印源代码行号？

> ID：355456
> 
> 赞同：39
> 
> 时间：2008-12-10T08:55:29.717
> 
> 标签：perl, line-numbers

是否可以在 Perl 中获取当前源代码行号？C++ 中的等价物是`__LINE__`.

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-12-10T09:01:07.287

该`__LINE__`文字记录在[perldata 手册页的](http://search.cpan.org/perldoc?perldata)[特殊文字](http://search.cpan.org/perldoc?perldata#Special_Literals_________)部分。

```
print "File: ", __FILE__, " Line: ", __LINE__, "\n"; 
```

或者

```
warn("foo"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-11T02:34:26.100

请注意，有一个问题

perl -e'warn("foo")'

foo 在 -e 第 1 行。

如果它以换行符结尾，*则不会*打印行号

perl -e'warn("foo\n")'

富

这在“perldoc -f die”中有记录，但在“perldoc -f warn”部分对 die 的引用中可能很容易错过......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-26T13:26:38.190

这会打印出您所在的行，以及“堆栈”（来自调用程序（脚本/模块/等）的行列表，这些行指向您现在所在的位置）

```
while(my @where=caller($frame++)) { print "$frame:" . join(",",@where) . "\n"; } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-17T22:28:48.643

“使用 Carp”并使用各种例程，您还会得到一个堆栈 - 不确定这种方式是否比 cnd 建议的“调用者”方法更好或更差。我在 C 和 Perl 中使用了 LINE 和 FILE 变量（可能还有其他类似的变量）来显示我在调试时在代码和其他信息中的位置，但在调试环境之外没有看到什么价值。

# javascript - Javascript按钮单击+显示

> ID：355459
> 
> 赞同：1
> 
> 时间：2008-12-10T08:57:40.663
> 
> 标签：javascript, onclick, onmousedown, onmouseup

我有一个大红色按钮，我正在尝试使用 javascript 执行以下操作：-

1.  OnMouseDown 更改图像，使按钮看起来很压抑
2.  OnMouseUp 返回初始图像并显示隐藏的 div

我可以让 onMouse Down 和 onMouseUp 图像更改部分工作。

我还可以通过使用 OnClick 来显示隐藏的 div

问题是我不能让它们一起工作。

我该怎么做呢？

顺便说一句，我确信它很明显，但我对 javascript 还很陌生，所以我很感谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T09:12:11.663

您可以使用分号分隔事件中的多个脚本语句：

```
<img src="..." alt="..."
  onmousedown="depressed();"
  onmouseup="undepressed(); revealDiv();" /> 
```

另外，我相信大多数浏览器都支持 onclick 事件：

```
<img src="..." alt="..."
  onmousedown="depressed();"
  onmouseup="undepressed();"
  onclick="revealDiv();" /> 
```

既然你说你已经分别弄清楚了这三个部分，我只是编写了函数调用，你可以用你自己的代码替换每个步骤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T09:02:11.450

没有看到您的代码，很难说，但我怀疑缺少“返回真”；onclick 或 onmouseup 事件处理程序末尾的语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T19:21:07.737

从不建议使用属性表示法将事件直接附加到 html 元素的标签。

将视图（作为呈现的 html）与控制器（正在发生的操作）分开是一种**更好的做法**

附加事件的最佳方式如下：

```
<img id="abut" />

<script>
var thebutton = document.getElementById('abut'); //Retrieve the button from the page 
thebutton.onmousedown = depressed; //depressed is a function that you declare earlier on...here, you are just passing a reference to it
thebutton.onmouseup = function () {
    undepressed();
    revealDiv(); //Invoke the two functions when the 'onmouseup' is triggered'
};
</script> 
```

# genetic-programming - 遗传编程的典型用例是什么？

> ID：355460
> 
> 赞同：39
> 
> 时间：2008-12-10T08:58:20.913
> 
> 标签：genetic-programming

今天，我阅读[了 Roger Alsing 的这篇博客文章，](http://rogeralsing.com/2008/12/07/genetic-programming-evolution-of-mona-lisa/)内容是关于如何仅使用 50 个半透明多边形绘制[蒙娜丽莎的复制品。](http://en.wikipedia.org/wiki/Mona_Lisa)

我对那个特定案例[的结果](http://rogeralsing.files.wordpress.com/2008/12/evolutionofmonalisa1.gif)很着迷，所以我想知道（这是我的问题）：**遗传编程如何工作以及遗传编程****可以解决**哪些其他问题？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-10T12:21:05.993

关于罗杰的蒙娜丽莎计划是否是[基因编程](http://en.wikipedia.org/wiki/Genetic_programming)存在一些争论。它似乎更接近于 (1 + 1)[进化策略](http://en.wikipedia.org/wiki/Evolution_strategy)。这两种技术都是更广泛的进化计算领域的例子，其中还包括[遗传算法](http://en.wikipedia.org/wiki/Genetic_algorithm)。

遗传编程 (GP) 是进化计算机程序的过程（通常以树的形式 - 通常是 Lisp 程序）。如果您专门询问全科医生，John Koza 被广泛认为是领先的专家。他的[网站](http://www.genetic-programming.org/)包含许多指向更多信息的链接。GP 通常是计算密集型的（对于不平凡的问题，它通常涉及大量机器）。

如果您问得更笼统，进化算法 (EA) 通常用于为使用其他技术无法轻松解决的问题（例如 NP-hard 问题）提供良好的近似解决方案。许多优化问题都属于这一类。找到精确的解决方案可能计算量太大，但有时接近最优的解决方案就足够了。在这些情况下，进化技术可能是有效的。由于它们的随机性，进化算法永远不能保证找到任何问题的最佳解决方案，但如果存在，它们通常会找到一个好的解决方案。

进化算法也可以用来解决人类不知道如何解决的问题。没有任何人类先入之见或偏见的 EA 可以生成令人惊讶的解决方案，这些解决方案可与人类产生的最佳努力相媲美或更好。即使我们不知道如何创建一个好的解决方案，我们也必须能够识别出一个好的解决方案。换句话说，我们需要能够制定一个有效的[适应度函数](http://en.wikipedia.org/wiki/Fitness_function)。

**一些例子**

*   [旅行推销员](https://watchmaker.dev.java.net/examples/salesman.html)
*   [数独](https://watchmaker.dev.java.net/examples/sudoku.html)

**编辑：** 免费提供的书，[遗传编程领域指南](http://www.gp-field-guide.org.uk/)，包含 GP 产生*人类竞争*结果的示例。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-10T12:55:01.590

有趣的是，在 Grand Theft Auto IV 和最新的星球大战游戏（The Force Unleashed）等游戏中使用的动态角色动画背后的公司使用基因编程来开发运动算法。该公司的网站在这里，视频令人印象深刻：

[http://www.naturalmotion.com/euphoria.htm](http://www.naturalmotion.com/euphoria.htm)

我相信他们模拟了角色的神经系统，然后在一定程度上随机化了连接。然后，他们将走得最远的模型的“基因”结合起来，在后代中创造出越来越多能干的“孩子”。真正迷人的模拟工作。

我还看到了寻路自动机中使用的遗传算法，寻找食物的蚂蚁就是典型的例子。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-10T09:33:09.127

遗传算法可用于解决大多数优化问题。但是，在很多情况下，有更好、更直接的方法来解决它们。它属于元编程算法类，这意味着它能够适应几乎任何你可以扔给它的东西，因为你可以生成一种编码潜在解决方案的方法，组合/变异解决方案，并决定哪个解决方案比其他解决方案更好。GA 优于其他元编程算法，因为它可以比纯爬山算法（如模拟退火）更好地处理局部最大值。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-10T09:11:13.040

我在论文中使用遗传编程来模拟基于地形的物种进化，但这当然是遗传算法的 A-life 应用。

GA擅长的问题是[爬山问题](http://en.wikipedia.org/wiki/Hill_climbing)。问题是，通常手工解决大多数问题更容易，除非定义问题的因素是未知的，换句话说，你无法以其他方式获得这些知识，比如与社会和社区有关的事情，或者在以下情况下你有一个很好的算法，但你需要微调参数，这里 GA 非常有用。

我做过的一个微调的情况是，基于相同的算法微调几个奥赛罗 AI 玩家，赋予每个不同的游戏风格，从而使每个对手都独一无二，并有自己的怪癖，然后我让他们竞争选出顶部我在游戏中使用的 16 个 AI。好处是他们都是非常优秀的玩家，技术差不多，所以这对人类对手来说很有趣，因为他们无法轻易猜出AI。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-10T09:10:41.027

[http://en.wikipedia.org/wiki/Genetic_algorithm#Problem_domains](http://en.wikipedia.org/wiki/Genetic_algorithm#Problem_domains)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-10T09:30:21.097

您应该问自己：“我可以（先验地）定义一个函数来确定特定解决方案相对于其他解决方案的好坏程度吗？”

在蒙娜丽莎的例子中，你可以很容易地确定新绘画是否比以前的绘画更像源图像，因此可以“轻松”应用遗传编程。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-10T12:59:35.370

我有一些使用遗传算法的项目。GA 是优化问题的理想选择，因为当您无法开发完全顺序的、精确的算法来解决问题时。例如：什么是汽车特性的最佳组合，以使其更快，同时更经济？

目前我正在开发一个简单的 GA 来制作播放列表。我的 GA 必须找到相似的专辑/歌曲的更好组合（这种相似性将在 last.fm 的帮助下“计算”）并为我推荐播放列表。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-14T22:38:19.043

机器人技术中有一个新兴领域，称为[进化机器人学](http://laral.istc.cnr.it/nolfi/er-book.html)( [w:Evolutionary Robotics](http://en.wikipedia.org/wiki/Evolutionary_robotics) )，它大量使用遗传算法 (GA)。

请参阅[w：遗传算法](http://en.wikipedia.org/wiki/Genetic_algorithm)：

> ## 简单的世代遗传算法伪代码
> 
> 1.  选择初始种群
> 2.  评估群体中每个个体的适应度
> 3.  重复直到终止：（达到时间限制或足够的适应度）
> 4.  选择排名最佳的个体进行复制
> 5.  通过交叉和/或突变（基因操作）培育新一代并产生后代
> 6.  评估后代的个体适应度
> 7.  用后代替换人口中排名最差的部分

关键是生殖部分，它可能发生有性或无性，使用遗传算子[Crossover](http://en.wikipedia.org/wiki/Crossover_%28genetic_algorithm%29)和[Mutation](http://en.wikipedia.org/wiki/Mutation_%28genetic_algorithm%29)。

# inversion-of-control - 泛型类型依赖注入：如何注入 T

> ID：355473
> 
> 赞同：4
> 
> 时间：2008-12-10T09:05:46.293
> 
> 标签：inversion-of-control, c#-2.0, unity-container

我想在我的应用程序中以相同的方式处理不同类型的文档因此：我有一个像这样的通用接口。

```
public interface IDocHandler<T>where T: class
{

T Document { get;set;}

void Load(T doc);

void Load(string PathToDoc);

void Execute();

void Execute(T doc);

} 
```

对于不同类型的文档，我实现了这个接口。

例如：

```
public class FinanceDocumentProcessor:IDocumentHandler<ReportDocument>
{} 

public class MarketingDocumentProcessor:IDocumentHandler<MediaDocument>
{} 
```

然后我当然可以做这样的事情：

```
IDocumentHandler<ReportDocument> docProc= new FinanceDocumentProcessor(); 
```

知道如何在运行时注入 T 以使上面的行松散耦合会很有趣...

```
IDocumentHandler<ReportDocument> docProc = container.resolve("FinanceDocumentProcessor()); 
```

但我想根据配置决定我想要我的 FinanceDomcumentProcessor 还是我的 MarketingDocumentProcessor ......因此我也必须在左侧站点上注入 T ......因为我必须使用 c# 2.0 我不能使用魔法词“var”在这种情况下会有很大帮助......但是我怎样才能将它设计为开放和灵活......

* * *

很抱歉造成误解并感谢所有评论，但我有另一个挑战示例（也许我为此使用了错误的设计）......但我试一试：同样的情况但不同的解释

我有的示例图像：

ReportingService、Crystal、ListAndLabel 三种不同的报告文档类型。我有一个通用的处理`IReportHandler<T>`程序（与上面的相同），这个处理程序提供了处理报告文档的所有功能。例如

```
ChrystalReportHandler:IReportHandler<CrystalReportDocument> 
```

现在我想使用像 Unity（或其他一些框架）这样的框架进行依赖注入，以通过配置决定我是要使用 Crystal`Reportingservices`还是 List 和 Label。

当我指定我的映射时，我可以注入我的`ChrystalReportHandler`，但我怎样才能在左侧注入 T 或者更好的词 The Type of `ReportDocument`。

```
IReportHandler<T (this needs also to be injected)> = IOContainer.Resolve(MyMappedType here) 
```

我的问题当然是左侧站点，因为它与类型耦合，但我有我的映射...是否可以基于映射生成对象并分配映射类型？或者基本上也将 T 注入左侧？还是这种方法不适合这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T10:20:02.277

我认为，在您当前的设计中，您正在`IDocumentHandler`与特定 Document ( `ReportDocument`or `MediaDocument`) 之间创建“依赖关系”，因此如果您想`IDocumentHandler<ReportDocument or MediaDocument>`直接在代码中使用，您必须假设您的容器会为您提供这一点。在这种情况下，容器不应该负责解析文档类型。

你会考虑像这样改变你的设计吗？

```
public interface IDocumentHandler
{
    IDocument Document { get; set; }

    void Load(IDocument doc);

    void Load(string PathToDoc);

    void Execute();

    void Execute(IDocument doc);

}

public class IDocument { }
public class ReportDocument : IDocument { }
public class MediaDocument : IDocument { }
public class FinanceDocumentProcessor : IDocumentHandler { }
public class MarketingDocumentProcessor : IDocumentHandler { } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T22:27:02.440

如果我理解正确，你有两个选择。

1.  如果您有接口 IDocHandler 和**多个**实现它的类，则必须显式注册**每种**类型，如下所示：

    container.AddComponent>(typeof(FooHandler));

2.  如果你有一个类 DocHandler 你可以使用开放的泛型类型注册组件

    container.AddComponent(typeof(IDocHandler<>), typeof(DocHandler<>));

那么每次你解析 IDocHandler 时，你都会得到一个 DocHandler 实例，当你解析 IDocHandler 时，你会得到 DocHandler

希望有帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T09:39:10.847

您需要在左侧使用非通用接口。

尝试：

```
public interface IDocumentHandler { }
public interface IDocumentHandler<T> : IDocumentHandler { } 
```

这将创建两个接口。将所有通用的、非 T 特定的东西放入基本接口中，并将其他所有东西放入通用接口中。

由于您想要将对象解析为的代码，您不知道处理器的类型，因此无论如何您都不能在那里调用任何特定于 T 的代码，因此您不会通过使用非- 通用接口。

* * *

**编辑**：我注意到我的回答被否决了。如果人们对事情投反对票会留下评论他们为什么这样做，那就太好了。我不在乎声誉点，此时这只是轻微的噪音，但如果答案有严重错误，那么我想知道以便我可以删除答案（如果它偏离目标) 或更正。

现在，在这种情况下，我怀疑要么是最初的被提问者投了反对票，因此要么没有发布足够的信息，所以他实际上是在问他所问的以外的东西，或者他不太明白我的回答，哪个是可以理解的，因为它有点短，或者不理解它的人再次出于同样的原因否决了它。

现在，详细说明。

您不能在“左侧”注入任何东西。那是不可能的。该代码必须在编译时编译、正确并且 100%“存在”。对于该部分，您不能说“我们会在运行时告诉您 T 是什么”。这是不可能的。

所以你唯一剩下的就是完全删除 T 。使使用依赖项的代码完全不依赖于 T。或者，至少，使用反射来发现 T 是什么，并根据该知识做事。

这就是你所能做的。您不能使左侧的代码根据您从右侧的方法返回的内容自行更改。

这是不可能的。

因此我的回答。

# apache - 使用 mod_jk 重写 URL

> ID：355475
> 
> 赞同：1
> 
> 时间：2008-12-10T09:07:23.843
> 
> 标签：apache, url, rewrite, mod-jk

在 php 应用程序中，我使用以下重写规则：

```
RewriteRule ^test-([0-9]+)\.html$ test.php?id=$1 
```

在我通过这条规则访问它之后：

[http://localhost/testphp/test-1.html](http://localhost/testphp/test-1.html)

我得到了预期的页面，并且浏览器中的 url 保持不变：

[http://localhost/testphp/test-1.html](http://localhost/testphp/test-1.html)

但是如果我用 mod_jk 配置相同的规则：

```
RewriteRule ^/testjk/test-([0-9]+)\.html$ http://%{SERVER_NAME}/testjk/test.jsp?id=$1 
```

然后在我使用重写的 url 访问页面后：

[http://localhost/testjk/test-1.html](http://localhost/testjk/test-1.html)

浏览器中的 url 将跳转到：

[http://localhost/testjk/test.jsp?id=1](http://localhost/testjk/test.jsp?id=1)

任何人都知道我怎样才能让 jk 像 php 一样执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T09:44:37.683

我设法通过将规则更改为以下内容来使其工作：

```
RewriteRule ^/testjk/test-([0-9]+).html$ /testjk/test.jsp?id=$1 [L,PT] 
```

# wpf - 在 Silverlight 中，为什么有些属性以 x 为前缀，例如 x:name 而有些则不是？

> ID：355477
> 
> 赞同：2
> 
> 时间：2008-12-10T09:09:11.000
> 
> 标签：wpf, xml, silverlight

在 Silverlight（我猜是 WPF）中，为什么属性 x:name x:fieldmodifier x:uid 是唯一带有前缀 x 的属性。

我知道 x 前缀用于引用 XML 命名空间，但还有许多其他属性不使用前缀，例如宽度。识别控件是一项如此常见的任务，需要前缀似乎很奇怪？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T10:32:41.127

我认为这里的重点是xaml和wpf/SL的区别。

Xaml 是真正的对象初始化语言，完全独立于 wpf / SL。例如，您还可以使用 xaml 在 WF 中定义工作流。我认为这就是将“纯”Xaml 命名空间与表示命名空间区分开来的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T09:27:26.360

更新：我很抱歉，因为我不太了解这个问题（见评论）。

在 silverlight 和 wpf 中，.net 命名空间与 xml 命名空间相关联。更常见的 .net 命名空间与 xml 命名空间“ [http://schemas.microsoft.com/winfx/2006/xaml/presentation](http://schemas.microsoft.com/winfx/2006/xaml/presentation) ”相关联。然后在 xaml 根元素中有这个命名空间定义：

```
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
```

这意味着与“ [http://schemas.microsoft.com/winfx/2006/xaml/presentation](http://schemas.microsoft.com/winfx/2006/xaml/presentation) ”关联的 .net 命名空间不需要前缀。

[这](http://msdn.microsoft.com/en-us/library/ms752059.aspx#xaml_files)是对 xaml 和命名空间的一个很好的解释。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-12-10T10:29:08.857

之一：

*   个人喜好。
*   该项目的实现（类）与 XAML 文件位于*同一程序集中。*
*   一些傻瓜决定创建自己的名称属性。

# objective-c - 你能绑定到 NSDatePicker 的 timeInterval 属性吗？

> ID：355486
> 
> 赞同：1
> 
> 时间：2008-12-10T09:12:45.250
> 
> 标签：objective-c, cocoa, core-data, osx-leopard

我有一个核心数据应用程序，它有一个事件类，它有一个开始日期和一个结束日期。将这些绑定到一对 NSDatePicker 小部件是微不足道的，但我想让它与 Leopard 中可用的 NSRangeDateMode 一起工作。

NSDatePicker 有一对处理 timeInterval 的方法，但我似乎无法绑定到这个。

**更新**：我已经使用手动调用来进行绑定，它只工作了一半：

```
[picker bind:@"timeInterval" 
    toObject:array 
 withKeyPath:@"selection.timeInterval" 
     options:options]; 
```

它在底层对象改变时设置 NSDatePicker 中的 timeInterval，但在 NSDatePicker 的 timeInterval 改变时不设置底层对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T21:57:22.663

间隔支持仅在您使用日期选择器的图形版本时可用。即使这样，也没有对`timeInterval`.

另外，根据您打算如何使用它，我认为 UI 选择超过当前月份的范围很差。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T22:05:42.647

可悲的是没有。日期选择器的 timeInterval 属性甚至不能正确地观察到键值。基本上，您要么设置一个操作方法，要么使用委托验证方法来接收对其值的更新。此外，您需要将其四舍五入到最接近的 86400.0 倍数（即一天中的秒数），因为日期选择器在其报告的 timeInterval 中始终偏离几分之一秒。或许等到 Snow Leopard 出现的时候，这个功能就会完全成熟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-30T19:03:10.947

[1169097](https://stackoverflow.com/questions/1169097/can-you-manually-implement-cocoa-bindings)解释了如何实现自定义绑定。

# c# - 如何在 C# 中从 LDAP 读取 TermainsServices IADsTSUserEx 属性？

> ID：355492
> 
> 赞同：2
> 
> 时间：2008-12-10T09:19:22.353
> 
> 标签：c#, ldap, c#-2.0, terminal-services, iadstsuserex

我已阅读 AD 的以下属性，

```
TerminalServicesProfilePath
TerminalServicesHomeDirectory
TerminalServicesHomeDrive 
```

我试过 DirectoryEntry 和 DirectorySearcher。但它们不包括属性。

我在 vbscript 和 VC 中找到了一些示例来阅读它们。但是我未能使其在 C# 中工作。我错过了一些棘手的事情吗？

编辑：我必须在“Windows Server”上运行它才能使其工作吗？可以从win XP中读取吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T09:52:02.037

我认为您可以在`InvokeGet`上使用该方法`DirectoryEntry`，传入您要读取的属性的名称。

*2008-12-10 11:50 CET——根据评论编辑*

如果我指定一个垃圾属性名称，我会得到相同的 COM 异常。您确定要检索的属性是 AD 架构的一部分吗？

为了确保，我使用的代码如下：

```
using (DirectorySearcher searcher = new DirectorySearcher("(cn=Test)"))
{
    SearchResult result = searcher.FindOne();
    if (result != null)
    {
        DirectoryEntry entry = result.GetDirectoryEntry();
        string s = entry.InvokeGet("TerminalServicesHomeDrive") as string;
        MessageBox.Show(s ?? "null");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T09:33:23.617

具体我记不太清了，大概是这样的：

```
//user is a DirectoryEntry
IADsTSUserEx adsiUser = (IADsTSUserEx)user.NativeObject; 
```

然后您可以通过 adsiUser 获取所需的 TerminalServices 属性。

根据我的经验，由于您使用的库，您最好在可以访问 AD 的 Windows Server 上进行开发。那么你可能也会完成上述工作:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-08T16:12:36.063

这对我有用：

```
 DirectoryEntry user = new DirectoryEntry("LDAP://" + sLDAP_SERVER + "/cn=" + SAMAccount + "," + sLdapFullPath, sUser, sPwd);

            //ActiveDs.IADsUser iADsUser = (ActiveDs.IADsUser)user.NativeObject;
            ActiveDs.IADsUser cont = null;

            cont = user.NativeObject as ActiveDs.IADsUser;

            TSUSEREXLib.IADsTSUserEx m_TsUser = (TSUSEREXLib.IADsTSUserEx)cont;
            int m_TSLogonDisabled = 0;

            m_TsUser.AllowLogon = m_TSLogonDisabled; 
```

# objective-c - 应用程序中的多个窗口或“页面”

> ID：355498
> 
> 赞同：5
> 
> 时间：2008-12-10T09:24:58.893
> 
> 标签：objective-c, cocoa, macos

我是 Mac 应用程序开发的新手。我想使用 Interface Builder 在 Cocoa 中编写一个 GUI 应用程序。我想要多个屏幕，即当单击屏幕上的一个按钮时，应该显示另一个屏幕。如何在按钮单击事件中激活新屏幕？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T10:24:15.153

我衷心推荐 Aaron Hilegass 的书[Cocoa Programming for Mac OS X](http://www.amazon.co.uk/Cocoa-Programming-Mac-OS-X/dp/0321503619)。在短短的几周内，我从感觉一切都变得不可能变得相对称职。我对它印象深刻。

Apple 的文档非常好，但需要一段时间才能习惯这种风格，而且在查找如何使用它们之前，您需要知道哪些对象实际存在，这就是 Aaron 的书的用武之地。

您的图书馆可能有它的副本，或者如果没有，也可以为您订购。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T14:08:40.303

我认为您的意思是窗户，而不是屏幕。屏幕是显示所有用户应用程序的所有用户窗口的显示器（监视器）。

我赞同乔纳森对希勒加斯书的推荐。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T09:53:30.957

该按钮有一个目标。那应该链接到新窗口。作为它的动作，你可以告诉窗口显示自己。

看看：http: [//developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/WinPanel/WinPanel.html](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/WinPanel/WinPanel.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T09:39:47.037

我认为您想要的是在 Coda 中看到的界面类型，或系统偏好设置，其中屏幕顶部有一个工具栏，可用于在窗口内容之间进行选择。

我发现的最简单的方法是使用[BWToolkit](http://www.brandonwalkin.com/blog/2008/11/13/introducing-bwtoolkit/)。

另一种方法是使用一系列视图，并在单击工具栏时在它们之间切换。我在[这里](http://forum.soft32.com/mac/NSToolbar-Acting-Tabs-ftopict43123.html)找到了一个描述，但这不是我第一次使用的描述（可能最初在 Ruby Cocoa，IIRC 中）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T12:14:38.977

NSTabView。

# asp.net - 事件日志消息被另一个事件日志覆盖

> ID：355500
> 
> 赞同：0
> 
> 时间：2008-12-10T09:27:02.540
> 
> 标签：asp.net, event-log

我为 asp.net 项目错误日志记录创建事件日志。我通过在 regedit 中添加一个键，然后添加一个子键来做到这一点。
有时，我创建一个新的密钥和子密钥，而不是获得一个新的空事件日志，而是在事件查看器中看到它正在向我显示来自不同项目的日志。我无法找到何时发生这种情况的模式。
有没有人遇到过这样的问题？难道我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T09:34:36.893

您可能希望使用[EventLog.CreateEventSource](http://msdn.microsoft.com/en-us/library/2awhba7a.aspx) API 来执行此操作 - 它应该为您处理任何细节。

快速阅读文档似乎表明检查了前 8 个字符的唯一性……也许这就是您的问题所在？

编辑：从反射器，API 这样做......

1.  检查无效字符（基于 Unicode 类别的“不可打印”、\、*、？）
2.  检查创建的 reg 键是否 <= 254 个字符
3.  检查源是否已经注册
4.  检查日志名称是否未保留（AppEvent、SecEvent、SysEvent）
5.  检查具有相同开头 8 个字符的另一个日志
6.  检查日志名称不作为源存在
7.  创建日志子键
8.  使用默认值初始化日志子项（MaxSize = 524288，AutoBackupLogFiles = 9\. Retention = 604800，File = %SystemRoot%\System32\config\logName.Substring(0, 8) + ".evt"）
9.  如果操作系统不是 > Windows NT 5.x（Vista 或更高版本），则在 logkey 上创建一个带有 logName 和源名称的多字符串值。或者，如果值存在，则将源名称附加到现有数组。
10.  为源创建子项
11.  使用默认值（EventMessageFile、ParameterMessageFile、CategoryMessageFile、CategoryCount）初始化源子项

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-02-15T08:34:36.663

似乎问题在于我们已经创建了一个具有该名称的事件日志，即使我们删除了它，它也没有帮助。解决方案是创建一个具有不同名称的事件日志。

# sql - 填写 SQL 查询的空白

> ID：355508
> 
> 赞同：2
> 
> 时间：2008-12-10T09:30:19.443
> 
> 标签：sql, mysql

抱歉这个模糊的主题，但我想不出该说什么。

这是我的问题，我正在对一个表进行查询，该表返回与一天相关的项目计数。我想确保如果我对数据库进行查询，我总是会得到一定数量的行。例如，假设我有下表，其中包含人们何时登录网站的日志：

```
**WebsiteLogin**
id: Integer
login_date: Datetime 
```

然后，我可以通过执行以下操作来获取每个日期的登录次数：

```
SELECT DATE(login_date), COUNT(*) FROM WebsiteLogin GROUP BY DATE(login_date) 
```

效果很好，并将返回我想要的数据。但是想象一下我的网站在周末很不受欢迎。返回的数据如下所示：

```
2008-12-10, 100
2008-12-11, 124
2008-12-12, 151
2008-12-15, 141
2008-12-16, 111 
```

缺少 13 日和 14 日，因为没有这些日期的数据。有什么方法可以更改我的查询，以便获得包含我查询的所有日期的数据。例如

```
2008-12-10, 100
2008-12-11, 124
2008-12-12, 151
2008-12-13, 0
2008-12-14, 0
2008-12-15, 141
2008-12-16, 111 
```

我想如果我设置一个包含一年中所有日期的表格然后使用左/右连接，我可以做到这一点，但这样做真的很混乱。

那么关于在 SQL 中执行此操作的好方法的任何线索？还是以编程方式是我唯一的选择？为任何输入欢呼。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T09:38:20.223

为此，您需要编写一个返回表结果的存储过程。

它将使用一个循环，每天遍历并获取计数并将其存储在临时表的一行中，然后将该表作为结果集返回。

这是一个循环的 MS SQL 服务器示例：

[http://www.databasejournal.com/features/mssql/article.php/3100621/T-SQL-Programming-Part-2---Building-aT-SQL-Loop.htm](http://www.databasejournal.com/features/mssql/article.php/3100621/T-SQL-Programming-Part-2---Building-a-T-SQL-Loop.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T09:36:18.603

> 我想如果我设置一个包含一年中所有日期的表格然后使用左/右连接，我可以做到这一点，但这样做真的很混乱。

没有。这就是如何做到这一点。另一方面，您可以使用临时表并仅使用所需的日期范围填充它。

如果只有 MS SQL 有虚拟表，你提供了一个生成器函数......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T10:25:14.480

您不需要创建临时表或类似的表，您只需要一个具有足够行的源来构造缺失的日期：

我不知道 mysql，但如果它支持“连接方式”，那么您可以执行以下操作：

（这是在甲骨文中）

```
select d login_date, count(login_date) count
from
    websitelogin wsl
    right outer join (
        select start_date+l-1 d from (select start_date, level l
        from (select min(login_date) start_date, max(login_date)-min(login_date)+1 num_days
        from websitelogin) connect by level <= num_days)) v on d=login_date
group by d
/ 
```

如果 mysql 没有连接，您可以只加入一些具有足够行数的任意表，并将结果限制为所需的行数：

```
select d login_date, count(login_date) count
from
    websitelogin wsl
    right outer join (select start_date+rownum-1 d from
(
select 
    min(login_date) start_date, 
    max(login_date)-min(login_date)+1 num_days
from websitelogin)v,all_objects
where rownum<=num_days
) v on d=login_date
group by d 
```

虽然不是很整洁，但显然您需要知道驾驶表中有足够的行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T12:11:05.203

我知道它不是 mysql，但我在 MSSQL 中使用了以下函数（MySql 版本见下文）：

```
CREATE FUNCTION dbo.DatesBetween (@start_date datetime, @end_date datetime)
RETURNS @DateTable TABLE (gen_date datetime)
AS 
BEGIN
    DECLARE @num_dates int
    DECLARE @tmpVal TABLE (a_count int identity(0,1))

    SELECT @num_dates = datediff(day, @start_date, @end_date)
    WHILE (select isnull(max(a_count), 0) from @tmpVal) < @num_dates
        INSERT @tmpVal DEFAULT VALUES

    INSERT @DateTable (gen_date) 
    SELECT dateadd(day, a_count, @start_date) FROM @tmpVal

    RETURN
END 
```

因此，要在您的示例中使用它，我会尝试以下操作：

```
DECLARE @min_date datetime, @max_date datetime
SELECT @min_date = min(login_date), @max_date = max(login_date) 
FROM WebsiteLogin

SELECT m.gen_date 'login_date', isnull(l.num_visits, 0) 'num_visits'
FROM dbo.DatesBetween(@min_date, @max_date) as d
LEFT OUTER JOIN (SELECT DATE(login_date) 'login_date', COUNT(*) 'num_visits'
             FROM WebsiteLogin 
             GROUP BY DATE(login_date)) AS l ON d.gen_date = l.login_date 
```

* * *

或者，通过对我的查询进行大幅速度改进，您可以研究此[博客条目](http://musingmarc.blogspot.com/2006/07/need-date-range-in-sql-without-filling.html)，它可以完成我上面的代码所做的工作，但适用于所有 SQL 版本。

他在那里解释得更多，但 SQL 是：

```
DECLARE @LowDate DATETIME
SET @LowDate = '01-01-2006'

DECLARE @HighDate DATETIME
SET @HighDate = '12-31-2016'

SELECT DISTINCT DATEADD(dd, Days.Row, DATEADD(mm, Months.Row, DATEADD(yy, Years.Row, @LowDate))) AS Date
FROM
(SELECT 0 AS Row UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4
 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9
 UNION ALL SELECT 10 UNION ALL SELECT 11 UNION ALL SELECT 12 UNION ALL SELECT 13 UNION ALL SELECT 14
 UNION ALL SELECT 15 UNION ALL SELECT 16 UNION ALL SELECT 17 UNION ALL SELECT 18 UNION ALL SELECT 19
 UNION ALL SELECT 20 UNION ALL SELECT 21 UNION ALL SELECT 22 UNION ALL SELECT 23 UNION ALL SELECT 24
 UNION ALL SELECT 25 UNION ALL SELECT 26 UNION ALL SELECT 27 UNION ALL SELECT 28 UNION ALL SELECT 29
 UNION ALL SELECT 30 -- add more years here...
) AS Years
INNER JOIN
(SELECT 0 AS Row UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4
 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9
 UNION ALL SELECT 10 UNION ALL SELECT 11
) AS Months
ON DATEADD(mm, Months.Row,  DATEADD(yy, Years.Row, @LowDate)) <= @HighDate 
INNER JOIN
(SELECT 0 AS Row UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4
 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9
 UNION ALL SELECT 10 UNION ALL SELECT 11 UNION ALL SELECT 12 UNION ALL SELECT 13 UNION ALL SELECT 14
 UNION ALL SELECT 15 UNION ALL SELECT 16 UNION ALL SELECT 17 UNION ALL SELECT 18 UNION ALL SELECT 19
 UNION ALL SELECT 20 UNION ALL SELECT 21 UNION ALL SELECT 22 UNION ALL SELECT 23 UNION ALL SELECT 24
 UNION ALL SELECT 25 UNION ALL SELECT 26 UNION ALL SELECT 27 UNION ALL SELECT 28 UNION ALL SELECT 29
 UNION ALL SELECT 30
) AS Days
ON DATEADD(dd, Days.Row, DATEADD(mm, Months.Row,  DATEADD(yy, Years.Row, @LowDate))) <= @HighDate
WHERE DATEADD(yy, Years.Row, @LowDate) <= @HighDate
ORDER BY 1 
```

# asp.net - 获取当前请求的凭据以在 WebRequest 中使用

> ID：355516
> 
> 赞同：3
> 
> 时间：2008-12-10T09:34:38.920
> 
> 标签：asp.net, asp.net-mvc

访问我的网站时，用户必须输入他的凭据。它们基本上是普通的目录访问凭据。在某个时刻，我通过调用检查他们想要下载的某个文件是否存在

```
WebRequest req = HttpWebRequest.Create(checkUri.AbsoluteUri);
WebResponse res = req.GetResponse(); 
```

虽然我可以从浏览器访问 checkUri，但在进行上述检查时我得到了 401。我想我必须设置

```
req.Credentials 
```

但我不知道当前凭据存储在哪里......

有任何想法吗？

**- 更新 -**

*   集成 Windows 身份验证：否
*   允许匿名：关闭
*   Caler：同一站点页面上的链接（GET）
*   模拟：默认关闭（甚至不知道如何在 asp.net mvc 中启用它）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-19T16:29:12.730

我在使用表单身份验证的网站上遇到了类似的问题，我能够通过使用[此处](http://www.codeproject.com/Messages/3139016/Forms-Authentication-and-using-Current-User-Creden.aspx#3139377)提供的代码作为线程中的第二个回复来解决这个问题。

```
HttpWebRequest req = (HttpWebRequest)WebRequest.Create(uri);
// Add the current authentication cookie to the request
HttpCookie cookie = HttpContext.Current.Request.Cookies[FormsAuthentication.FormsCookieName];
Cookie authenticationCookie = new Cookie(
    FormsAuthentication.FormsCookieName,
    cookie.Value,
    cookie.Path,
    HttpContext.Current.Request.Url.Authority);

req.CookieContainer = new CookieContainer();
req.CookieContainer.Add(authenticationCookie);

WebResponse res = req.GetResponse(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-10T09:37:42.940

我想你想要这个：

```
req.Credentials = CredentialCache.DefaultCredentials; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T14:46:01.083

您将需要启用集成 Windows 身份验证。

我不知道在 ASP.NET MVC 中会发生什么，但在 ASP.NET Web 窗体模拟中，通过以下方式打开：

```
<identity impersonate="true"> 
```

在 web.config 中。

# sql - 访问查询：如何查询以获取计算值？

> ID：355526
> 
> 赞同：1
> 
> 时间：2008-12-10T09:39:25.137
> 
> 标签：sql, ms-access

你好，

我有一个大表，我可以从中查询以获取下表

```
type       no of times type occurs
101            450
102            562
103            245 
```

我也可以得到另一张桌子

```
code      no of times code occurs
0               1222
1                750 
2                355 
```

但现在我想写一个查询，它可以让我得到下表

```
type  no of timescode1occurs %of timescode1 occurs out of  %of times code1 occurs out of  
                              no of times type occurs       no of times code occcurs

101          50                11%                                  6%
102          75                13%                                  10% 
```

我怎样才能写一个查询来得到这个？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T10:43:23.773

假设这样的表：

```
type, code, ... other columns. 
```

我假设您的前 2 个查询类似于

```
select type, count(*) from mytable group by type

select code, count(*) from mytable group by code 
```

然后你想做类似的事情

```
SELECT DISTINCTROW mytable.Type, mytable.Code, 
Count(*)/q1.[Count of type] AS [Percent Of Type],
Count(*)/q2.[Count of code] AS [Percent Of Code]
FROM mytable, 
  (select type, count(*) as [Count of type] from mytable group by type) q1,
  (select code, count(*) as [Count of code] from mytable group by code) q2
where mytable.Type =q1.Type
and mytable.Code=q2.Code
GROUP BY mytable.Type, mytable.Code, q1.[Count of type], q2.[Count of code]; 
```

希望这可以帮助。克里斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T11:51:24.540

怎么样：

```
SELECT t.Type, t.Code, COUNT(t.Code) AS CountOfCode, 
  [CountOfCode]/DCount("Code","t","Code=" & [Code])*100 AS PercentCode, 
  [CountOfCode]/DCount("Type","t","Type=" & [Type])*100 AS PercentType
      FROM t
      GROUP BY t.Type, t.Code 
```

其中 t 是大表的名称。

# git - 在持续重构的项目中使用 git/mercurial？

> ID：355531
> 
> 赞同：20
> 
> 时间：2008-12-10T09:43:11.743
> 
> 标签：git, version-control, refactoring

我试图了解我是否真的有任何使用 git/mercurial 的案例。

我工作的项目是 java 和 c# 项目，通常有 5-20 人朝着一个共同目标（“发布”）工作。大多数开发人员都是专业的开发人员，他们一直在重构*代码*。因此，在典型的 linux 内核在单独的文件中有大量相对独立的更改的情况下，我们会不断地进行重构更改 - 经常会遇到*大量*文件和*大量*代码。没有人害怕在这里更改代码。

现在有了颠覆，我们通过非常接近 SVN HEAD 来解决这个问题。我们中的一些人甚至在构建服务器的 jabber 广播上触发了自动 svn up。我们中的大多数人也学会了（或学得很快）如何计划我们的工作以接近 SVN HEAD。如果您正在进行重大重构，我们会逐渐将源代码树转向新的方向，而不是离开太久。有时您只是计划重构操作并从竞争较少的领域开始。以这种方式工作几年后，它变成了第二天性。我们大多数人根本就不会离开距离 svn head 不到 2 小时的“舒适区”。自动构建和 svn 头是项目“脉冲”，我们喜欢它。

当然，我们对每个版本都进行了分支，但是从发布分支回到主干的反向合并数量迅速减少到微不足道（我们有不错的测试覆盖率）。在源代码的私有分支上运行数天/数周听起来像是我们积极想要阻止的事情，而且它根本不会经常发生。

git 和 mercurial 听起来都很酷，git 稍微好一点，因为我更像是 McGyver 类型而不是 James Bond 类型。但是当谈到建立一个实际转换的案例时，感觉就像我和 Linus 生活在两个不同的星球上。大多数时候，我们*希望*我们的团队专注于 HEAD。

GIT 如何让我的版本控制更好？GIT 将如何让我改进我的流程？我是颠覆恐龙吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-10T10:59:22.463

从心态上来说，有时可以创建一个软分支，执行软分支中的所有更改，测试软分支中更改的结果，然后当软分支“完成” "，将其与本地主分支重新集成，重新测试，然后传播。

这在某些情况下比匆忙的头脑要好，因为你不会因为其他调试代码的存在而不断地中断你的代码以添加非错误来处理。

这也意味着您可以更频繁地提交，提供更全面的历史记录，因为提交不会立即出现在任何地方造成问题。

此外，在将软分支与共享主线协调时，您会看到一个漂亮的完整变更集，向您展示所有集体变更及其所有集体变更，这为很好的代码审查机会打开了大门。

另外，从测试的角度来看，如果你有更多的软分支，你可以在软分支上运行测试，然后再将它们合并回主分支，并有一个标准，一个分支不会被合并回主分支分支直到它有

1.  自行通过测试
2.  将主要分支更改协调到软分支后通过测试

从而为您提供额外的代码质量保证，因为您的主要协作分支非常干净，因为不允许出现故障代码。

（这也限制了解决问题的领域，因为您只需要测试自己的大部分更改，当您“完成”时，您才需要担心其他人做了什么，以及他们做了什么也应该通过测试，这意味着当某些事情*确实*失败时，你只需要看看*你*做了什么来解决问题）

> 但是我会不断地从中央回购头更新到我的软分支吗？这真的是我问题的本质

分支系统的美妙之处在于，您可以根据需要将“其他人认为稳定的任何内容”拉入本地副本。

“持续更新”变得不必要了，因为你没有出现同样的问题。

```
a  b   center
         |
         |
         /      Key:   / - | \   = Flow
/----<---|             < >       = Flow Directions
|  /--<--/             *         = Commit 
*  |     |             T         = Test
|  *     |             M         = Merging with "Current" state of common branch
*  |     |             C         = Tests Complete and Current state is "sane"
|  *     |
T  |     |
|  T     |
|  C     |
|  |/-<--/
*  M     |
|  T     |
*  C     |
|  \--->-\
*  /---<-/
T  |     |
C  *     |
|/-----<-/
M  |     |
T  *     |
|  T     |
*  C     |
|  |/-<--/
*  M     |
T  T     |
C  \-->--\
|/---<---/
M        |
T        |
C        |
\---->---\
         | 
```

此外，由于系统的工作方式，稍后也会发生这种情况：

```
a  b   center
|  |     |
T  |     |
C  *     |
|/</     |
M  |     |
|  *     |
T        |
C        |
|/----<--/
M        |
T        |
C        |
\-->-----\
         | 
```

在这种情况下，他们作为“头”的整个概念消失了。它有几十个头，你看到的哪个是容易透视的。

我还可以补充一点，这些逻辑分支虽然在此处显示为单独的，但可以非常可行地表示单独的结帐位置，或者仅表示单个机器上的不同软分支。a & b 实际上可能是一个开发人员。

本质上，“从主分支不断更新我的软分支”在概念上是没有意义的。因为事实上，主分支上还没有体现出来的变化，你什么时候知道它们已经被推送了？SVN 给你这种“单一”代码状态的错误错觉，而实际上，当用户在他们的文本编辑器中打开文件的那一刻，他们实际上已经创建了一个生命周期非常短的软分支，一种正在发生的变化，没有人知道，为了让这种错觉以你认为的方式持续下去，实际上，用户必须在每个字符之后都进行承诺，这几乎不切实际。所以在现实中，人们已经习惯了不同地点彼此“不同步”的事实，并学习解决它的方法，这样它就不再是问题了。

此外，“不断地用其他人的变化来更新我的树”有一个核心问题，那就是，你有太多的分心，你不断地被其​​他人正在做的事情轰炸，如果他们正在制作一系列 1行提交测试他们无法在自己的机器上测试的东西，然后你对不断变化的文件做了一场噩梦，看到看似随机的变化的用户无法理解它们。

通过允许在两次提交之间运行更长的时间，然后*分批*查看最终结果并一次仅查看同行的*最终结果*更改，您可以立即看到自签出后更改了哪些代码，并对其含义有一个统一的概述为您的代码，因此您可以编写自己的代码并完成它。

### 如果您有任何疑问

从简单的东西开始，不要过渡冷火鸡，DSCM 中的一些概念可能有点令人生畏（我看到许多人在理解垂直堆叠软分支的概念时悲惨地失败），移动一个小的非Git/Mercurial 代码库的重要部分，并使用它一段时间，试验它的好处和它可以做什么。没有比亲自体验更好的证明了，我所有可爱的解释都不太可能传达您需要理解的内容，只能通过尝试和失败几次来学习（因为失败是学习的关键部分）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-10T13:00:22.360

您的团队使用 Subversion 的方式意味着发生了大量的合并工作。几乎每次团队成员更新到最新的主线时，他们都会将他们的工作副本与最新的主线合并，即使他们在这个阶段没有提交自己的更改。合并开销往往是提交率和团队成员数量的乘积，并且由于提交率是团队成员数量的函数，因此您的源代码管理开销为 O(N^2)。

在 Mercurial/Git 模型中，这种合并工作将在团队之间共享。如果您经常从每个人那里提取变更集，那么您通常会发现其他人已经完成了几乎所有您可能不得不做的合并工作。而且，在合并破坏了某些东西的情况下，人们通常已经修复了它。协调一对分支只需执行一次，并且由于生成新分支的速度与团队成员的数量成正比，源代码管理开销为 O(N)。

我预计 20 名开发人员在一个分支上接近头部工作可能会涉及相当多的合并工作（处理冲突，以及处理由于独立开发而导致的回归），所以如果你尝试 Mercurial/ 我会感到惊讶Git 并没有找到有用的生产力胜利。你认为以你目前的进度可以管理 100 名开发人员吗？我估计 Linux 内核开发人员的数量为 4000，但他们完成了很多工作，并且总的源代码管理开销必须是可以接受的。

只要您的源代码管理系统跟踪共同的父母，合并通常是自动的。由于更改之间的交互，每次合并都有可能成为文本冲突或破坏构建和测试；你需要做的合并越少，你处理这两种问题的时间就越少。

因此，一个真正的重大胜利是 Mercurial/Git 用户不再害怕分支。在 BitKeeper（据我所知，真正引入这种工作方式的工具）之前，持久的分支是定时炸弹，偶尔会爆炸，需要一周的时间才能恢复。现在，我们可以毫不犹豫地进行分支，并确信我们以后能够合并。在一个健康的团队中，其他人可以看到您的分支正在进行中，并将它们合并到他们的分支中，如果他们认为值得，稍后再提交您的努力。在集中式模型中，如果每个开发人员有 3 或 4 个处于活动状态的分支，并且我更正地说它是 O(N^2)，那么您只是将源代码管理开销增加了 3ish^2 倍，即一个数量级，这可能足以真正损害整体健康、财富和幸福。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T09:55:29.360

一方面，如果不出意外，您可以离线使用 GIT，这样人们即使在旅行或在家时也可以继续在源代码控制下工作。如果任何一种情况都适用，那么您绝对可以从 GIT 中受益。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T10:56:46.990

给你一票支持 svn/dinosaur 破解中的幽默。

可以以与使用 subversion 非常相似的方式使用 Git，因此不会丢失任何内容，并且随着时间的推移，您和您的团队会发现一些用于有效分叉、分支或任何其他漂亮的 Git 特定功能的用途，它们可能是以衡量和负责任的方式实施。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-10T11:10:21.503

我认为mercurial很棒。尤其是[TortoiseHg](http://tortoisehg.sourceforge.net/)。

我发现最有用的一件事是能够与核心团队共享功能开发。

假设整个团队有 20 人，但您只想在提交到主存储库之前与 3-4 人的团队一起测试和开发一个功能。然后使用 Mercurial，您可以在 3-4 编码器之间同步代码，直到您都满意后再提交到主存储库。

或者你甚至可以成为你自己的团队，例如。当您想在提交到主存储库之前在多个平台上测试您的代码时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T12:31:46.037

你在 SVN 中描述的，可以使用 git/mercurial 来完成

# unix - 在debian（unix）下合并分区的最简单方法？

> ID：355533
> 
> 赞同：1
> 
> 时间：2008-12-10T09:44:22.457
> 
> 标签：unix, merge, debian, disk-partitioning

我在 debian 下有两个想要合并的 unix 分区（磁盘空间问题：/）。最简单的方法是什么？我认为最好将文件从一个分区 tar 或复制到另一个分区，删除一个分区并调整另一个分区的大小。我将使用 parted 来调整大小，但我应该如何复制文件？有些链接、权限和设备需要在不更改的情况下移动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T10:11:07.053

您可以运行以下命令（以 root 身份）复制文件。它适用于符号链接、设备和普通文件。

```
cd /partition2
tar cf - . | ( cd /partition1 && tar xf - ) 
```

另一种方法是使用 cpio，但我不记得正确的语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T21:09:04.783

由于这是带有 GNU fileutils 的 Debian，`cp --archive`应该可以正常工作。

```
cp --archive --sparse=always --verbose --one-file-system --target-directory=/TARGET /ORIGIN 
```

如果出于某种原因你想通过 GNU `tar`，你需要做这样的事情：

```
cd /origin
find . -xdev -depth -not -path ./lost+found -print0 \
    | tar --create --atime-preserve=system --null --files-from=- \
          --format=posix --no-recursion --sparse \
    | { cd /target; tar --extract --overwrite --preserve-permissions --sparse; } 
```

（我已经这样做了很多次，以至于我有一个包含所有这些命令行的文件以供快速参考。）

警告：使用 GNU " `tar`"*不会*复制 POSIX ACL；您需要使用上述“ `cp --archive`”方法或“ [bsdtar](http://code.google.com/p/libarchive/) ”：

```
mkdir /target
cd /origin
find . -xdev -depth -not -path ./lost+found -print0 \
    | bsdtar -c -n --null -T - --format pax \
    | { cd /target; bsdtar -x -pS -f -; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T10:17:13.467

您还可以使用 SquashFS 创建分区的镜像并将其复制过来。调整第二个分区的大小后，挂载 SquashFS 映像并复制必要的文件。请记住，您的内核将需要 SquashFS 支持才能挂载映像。

*   [壁球FS](http://squashfs.sourceforge.net/)

# oracle - Oracle 表中的 UTF 8

> ID：355538
> 
> 赞同：3
> 
> 时间：2008-12-10T09:47:50.530
> 
> 标签：oracle

客户要求将一些表提取到 csv 中，所有这些都没有问题。他们刚刚要求我们确保文件始终采用 UTF 8 格式。

我如何检查这实际上是这种情况。或者甚至更好地强制它是这样，我可以在运行查询之前在程序中设置它吗？

数据是从 Oracle 10g 数据库中提取的。

我应该检查什么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T10:03:16.583

您可以使用以下查询检查数据库字符集：

```
select value from nls_database_parameters 
where parameter='NLS_CHARACTERSET' 
```

如果它显示 AL32UTF8，那么您的数据库就是您需要的格式，如果导出不会损害它，那么您就完成了。

您可以在此处阅读有关 Oracle 全球化支持的信息，并[在此处](http://download.oracle.com/docs/cd/B19306_01/server.102/b14225/ch3globenv.htm)[阅读](http://download.oracle.com/docs/cd/B19306_01/server.102/b14225/ch6unicode.htm)有关上述 NLS 参数的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T14:22:38.793

您究竟是如何生成 CSV 文件的？根据具体的架构，会有不同的答案。

例如，如果您使用 SQL*Plus 来提取数据，则需要将`NLS_LANG`客户端计算机上的. 如果您使用其他方法，则可能很重要，`NLS_LANG`也可能不重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T10:27:12.933

您需要寻找的是 hte 输入中的 8 位 ascii 字符（如果有）被翻译成双字节 utf-8 字符。

这高度依赖于您的本地 ASCII 代码页，但通常：-ASCII“£”应该是 ascii 中的 x'A3' 神奇地变成了 utf-8 中的 x'C2A3'。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T16:42:17.933

好吧，这并不像我最初希望的那么简单。上面的查询返回 AL32UTF8。

我正在使用在数据库上编译的存储过程来循环遍历存储过程内部数组中保存的表名列表。

我使用 DBMS_SQL 包构建 SQL 并使用 UTL_FILE.PUT_NCHAR 将数据插入文本文件。

我相信我的结果输出将是 UTF 8 但是在 Textpad 中打开说它是 ANSI 并且数据在某些地方是乱码:)

干杯

NLS_CHARACTERSET 是 AL32UTF8 并且 NLS_NCHAR_CHARACTERSET 是 AL16UTF16 可能很重要

# python - 用于检查 Python 属性的类似 get() 的方法

> ID：355539
> 
> 赞同：86
> 
> 时间：2008-12-10T09:49:39.903
> 
> 标签：python, attributes

如果我有一本字典`dict`并且我想检查`dict['key']`我可以在一个`try`块中这样做（bleh！）或使用该`get()`方法，`False`作为默认值。

我想为`object.attribute`. 也就是说，`False`如果尚未设置对象，我已经有要返回的对象，但这会给我带来如下错误

> AttributeError：“布尔”对象没有属性“属性”

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2008-12-10T14:27:29.763

`dict.get(key, default)`比`hasattr`is更直接的类比`getattr`。

```
val = getattr(obj, 'attr_to_check', default_value) 
```

（where`default_value`是可选的，如果未找到，则在没有属性时引发异常。）

对于您的示例，您将通过`False`.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-10T09:59:36.297

你的意思是`hasattr()`也许？

```
hasattr(object, "attribute name") #Returns True or False 
```

[Python.org doc - 内置函数 - hasattr()](http://docs.python.org/library/functions.html#hasattr)

您也可以这样做，这有点杂乱，不适用于方法。

```
"attribute" in obj.__dict__ 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-10T10:01:28.133

要检查一个键是否在字典中，您可以使用`in`: `'key' in dictionary`。

要检查对象中的属性，请使用以下`hasattr()`函数：`hasattr(obj, 'attribute')`

# ruby-on-rails - Rails：使用 routes.rb 阻止用户

> ID：355540
> 
> 赞同：2
> 
> 时间：2008-12-10T09:49:47.267
> 
> 标签：ruby-on-rails, url-routing

我有一个特殊的网址，我希望只有少数人可以访问。我有一个超级用户列表作为数组存储在 app.yml 中。如何在 routes.rb 文件中特定路由的 :requirements 部分中使用此数组以仅允许那些超级用户访问此路由？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T09:57:23.117

不，你不能。`:requirements`仅与路由参数有关。

在我看来，这是一件好事。在控制器中具有身份验证逻辑是一个众所周知的约定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T10:20:09.297

就像佩德罗说的......认证逻辑应该在控制器代码中。
查看 before_filters，您可以在其中指定将在控制器中的（所有或指定的）操作运行之前调用的方法。您可以使用这种方法来拒绝运行操作。[在此处](http://api.rubyonrails.com/classes/ActionController/Filters/ClassMethods.html)查找名为 Filter Chain Halting 的部分

[:requirements](http://api.rubyonrails.org/classes/ActionController/Routing.html)用于为要匹配的路由指定部分 URL 的约束。通常正则表达式的指定如下所示。

```
map.geocode 'geocode/:postalcode', :controller => 'geocode',
              :action => 'show', :requirements => { :postalcode => /\d{5}(-\d{4})?/ } 
```

# php - 在 PHP 中按特定顺序对对象数组进行排序

> ID：355550
> 
> 赞同：14
> 
> 时间：2008-12-10T09:53:44.327
> 
> 标签：php, arrays, object

我在 PHP 中有两个数组。第一个数组 ($author_array) 由 user_ids 按特定顺序组成，如下所示：(8, 1, 6)

第二个数组 ($user_results) 由一个对象数组组成，如下所示：

```
Array
(
    [0] => stdClass Object
        (
            [ID] => 1
            [user_login] => user1
        )
    [1] => stdClass Object
        (
            [ID] => 6
            [user_login] => user6
        )
    [2] => stdClass Object
        (
            [ID] => 8
            [user_login] => user8
        )
) 
```

我想对第二个数组进行“排序”，使其按此顺序排列，这与（8、1、6）的第一个数组中的值的顺序相匹配。所以它看起来像这样：

```
Array
(
    [0] => stdClass Object
        (
            [ID] => 8
            [user_login] => user8
        )
    [1] => stdClass Object
        (
            [ID] => 1
            [user_login] => user1
        )
    [2] => stdClass Object
        (
            [ID] => 6
            [user_login] => user6
        )
) 
```

我在数据结构方面很薄弱。我怎么能这样做？:-)

在此先感谢您的帮助！

-鲍勃

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-10T10:06:20.790

使用[usort](http://php.net/uksort)并提供自定义比较函数，该函数使用“排序”数组中键的位置来确定排序顺序，例如：

```
function cmp($a, $b) 
{
   global $author_array;

   $pos1=array_search ($a->ID, $author_array);
   $pos2=array_search ($b->ID, $author_array);

   if ($pos1==$pos2)
       return 0;
   else
      return ($pos1 < $pos2 ? -1 : 1);

}

usort($user_results, "cmp"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T10:11:57.783

我不确定这是否会比其他示例慢得多，但它似乎更简单。可能您可以将 $user_results 数组构建为一个关联数组，使用 ID 作为键，然后您可以轻松地进行查找。

```
$hash = array();
$result = array();

foreach ($user_results as $obj) {
    $hash[$obj->ID] = $obj;
}

foreach ($author_array as $id) {
    $result[] = $hash[$id];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-26T22:09:27.810

所以我遇到了类似的问题，但我试图通过数组（不是对象）对对象进行排序。这是不可能的，所以这是我的解决方法：

```
$sort_array= array(11, 4, 16, 19, 23);
$myobject = sort_categories($myobject)

function cmp($a, $b) { 
    if ($a->sort_key == $b->sort_key) { return 0; }
    return ($a->sort_key < $b->sort_key) ? -1 : 1;
}
function sort_categories($obj) {
    global $sort_array;

    foreach($obj as $cat) {
        $cat->sort_key = 999;
        for ($i=0;$i<count($sort_array);$i++) {
            if ($sort_array[$i] == $cat->term_id) $cat->sort_key = $i;
        }
    }
    usort($obj,'cmp');
    return $obj;
} 
```

我正在查看对象并添加一个名为“sort_key”的新（属性？），然后我们将使用它与 usort() 和 cmp() 进行排序。默认情况下，新的 sort_key 将是 999，所以它会卡在最后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T22:15:46.473

```
public static function reorganizeBykey ($objects, array $keys){
    $results = array();
    foreach($keys as $key){
        $i=0;
        foreach($objects as $object){
            if($object->sourceName==$key){
                $results[$i] = $object;
            }
            $i++;
        }
    }
    $others = (array_diff_assoc($objects,$results));
    $results = array_merge($results,$others);
    return $results;
} 
```

我希望这会有所帮助——我必须使用它来`array()`按一些排序`keys()`，然后在最后附加不匹配的内容。

# sql - 如何对字母数字值中的数据进行排序

> ID：355560
> 
> 赞同：0
> 
> 时间：2008-12-10T09:58:55.393
> 
> 标签：sql

我有这些价值观：`d1, d45, d79, d33, d100`

我想从我的表中按升序对这些变量进行排序。

得到输出的查询是什么：

```
d1
d33
d45
d79
d100 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T10:17:33.310

您想要的称为“自然排序”。对于 Microsoft SQL Server 2005，请参阅[此问题](https://stackoverflow.com/questions/34509/natural-human-alpha-numeric-sort-in-microsoft-sql-2005)。对于其他语言，请参阅（例如）[this other question](https://stackoverflow.com/questions/127913/sorting-strings-is-much-harder-than-you-thought)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T10:15:58.260

抱歉，根本不是 SQL 答案。:) 对于只有一个字母的变体，仅按长度和字母排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T16:11:16.357

如果我们可以假设数据值只包含字母 d 和一个数值，那么您还可以使用：

```
select column from YourTable
order by convert(int, replace(column, 'd', '')) 
```

如果它包含任何其他字母，则此方法很快变得无法使用：

```
select column from YourTable
order by convert(int, 
        replace(replace(replace(replace(replace(
            column, 'a', ''),
                'b', ''),
                'c', ''),
                'd', ''), 
                'e', '')
        ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T10:21:56.110

如果你能保证 /\w\d+/ 的模式 ...

在 postgres 中：

```
select foo from bar order by cast(substring(foo from 2) as int) 
```

..对于其他 SQL 风格也将存在类似的情况。昂贵的头脑。

编辑：机器人解决方案看起来也不错：

```
..order by char_length(foo),foo 
```

# project-management - 与大型团队一起管理项目结束的最佳策略

> ID：355565
> 
> 赞同：2
> 
> 时间：2008-12-10T09:59:51.490
> 
> 标签：project-management, projects-and-solutions

我们目前的项目有一个庞大的团队，我们已经接近项目的尾声

像大多数项目结束时一样，数十个依赖项正在弹出 - 每个人都在等待其他人完成任务。处理这个问题的最佳策略是什么。

我曾考虑缩小团队的规模，以便团队的其余成员可以并行完成依赖，但我正在寻找包括让团队中的每个人都保持静止的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T10:14:06.750

我知道如何处理这个问题的唯一方法是将团队分成两部分。如果幸运的话，您可以将另一半设置为与下一个版本一起使用。给两个团队的信息是发布版本优先于下一个版本的工作。因此，只要有合理的需要，开发发布版本的人就可以从“下一个”版本中招募人员（这通常与不同的专业领域有关，谁在相关代码上工作）。

通常我们只让发布版本的团队从下一个版本的工作人员那里得到*建议*，所以下一个版本的工作人员通常会放弃一个小时的工作而没有任何讨论。如果他们应该被拉回开发该功能，我们通常会将其作为管理决策。大多数时候，这些事情都是显而易见的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T12:07:41.953

这是 ole'*将它们排成一行并将它们击倒的*方法。确保您真的处于项目的最后，并且没有发现任何缺失的可交付成果，确定可交付成果的优先级，并根据最重要的项目确定剩余的工作、依赖关系等。优先级可以基于可交付成果的大部分价值，大多数昂贵的资源或可能迟早转移的资源。如果人们在等待并且无事可做，那么是时候委派项目结束的文档任务了……（必须有人去做）。

# c++ - xsl：包含来自 Win32 资源的另一个 xslt 文件

> ID：355572
> 
> 赞同：2
> 
> 时间：2008-12-10T10:01:57.727
> 
> 标签：c++, xslt, resources

我在我的 C++ Win32 应用程序和几个 xsl 文件中使用 xslt 转换器，这些文件有一个共同的部分，我想将它们分成另一个 xsl 文件。所有 xsl 文件都存储为资源。我遇到的 xsl:include 的唯一方法是使用 res:// 协议，该协议不适用于 xsl 文件（至少在我的两个 Windows 安装中，加载生成的 xslt 文件时返回错误，而在一个安装中它可以正常工作）。MSDN 也提到了这个问题： http: [//support.microsoft.com/ ?scid=kb%3Ben-us%3B220830&x=13&y=12](http://support.microsoft.com/?scid=kb%3Ben-us%3B220830&x=13&y=12)

除了：

1.  实现我自己的协议处理程序来加载包含的 xsl 文件 - 不值得做。
2.  避免 <xsl:include> 并自己替换包含的文件 - 太笨拙了。
3.  所有模板中的公共部分重复 - 不，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-27T20:53:10.397

另外两个 xml/xslt 库是 Xerces ( [http://xerces.apache.org/xerces-c/](http://xerces.apache.org/xerces-c/) - 还有一个 java 风格的 IIRC) 和 libxml ( [http://xmlsoft.org/](http://xmlsoft.org/) )。我从 Xerces 开始，最后使用 libxml（两者都使用 C++），但我并不真正喜欢它们中的任何一个：它们似乎都不符合我对需要做什么的看法——也许是我的失败。我发现 libxml 更容易破解。

此外，我将这些与 VC6 一起使用，但我认为您的版本不会对它们产生影响。

# c# - TcpListener.AcceptTcpClient 会抛出非关键异常吗？

> ID：355573
> 
> 赞同：3
> 
> 时间：2008-12-10T10:02:41.033
> 
> 标签：c#, .net, sockets, tcpclient, tcplistener

在我的应用程序中，我目前在 AcceptTcpClient（或 EndAcceptTcpClient）引发异常时停止侦听。通常，当我停止侦听器（套接字错误 10004）或断开网络适配器时会引发异常。

```
try
{
    while (true)
    {
        TcpClient client = listener.AcceptTcpClient();
        // omitted: start new thread which handles the client connection
    }
}
catch (...)
{
    // omitted: handle exception, log, stop listening
} 
```

但是，是否有任何由客户端引起的异常，并且需要忽略（或记录）异常并继续调用 AcceptTcpClient？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T11:05:34.167

MSDN 的文档将列出方法/成员/等可能引发的所有异常。

我发现通过在谷歌上搜索“MSDN Ssystem.Net.Sockets.TcpListener 类”之类的内容，然后导航到我需要的页面，很容易找到你想去的地方。

[TcpLisenter.AcceptTcpClient 方法](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.accepttcpclient.aspx)

MSDN 列出了 2 个可以抛出的异常。

InvalidOperationException ：侦听器尚未通过调用 Start 启动。

SocketException ：使用 SocketException.ErrorCode 属性获取特定的错误代码。获取此代码后，您可以参考 MSDN 中的 Windows Sockets version 2 API 错误代码文档，了解错误的详细说明。

# .net - WCF：如何从配置中获取绑定对象

> ID：355576
> 
> 赞同：17
> 
> 时间：2008-12-10T10:03:33.683
> 
> 标签：.net, wcf, wcf-binding

我想从 web.config 或 app.config 中获取 Binding 对象。

所以，这段代码有效：

```
wcfTestClient = new TestServiceClient("my_endpoint", Url + "/TestService.svc"); 
```

但我想做以下事情：

```
Binding binding = DoSomething();
wcfTestClient = new TestServiceClient(binding, Url + "/TestService.svc"); 
```

当然，我对 DoSomething() 方法很感兴趣。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-10-20T16:58:28.213

**这个答案满足了 OP 的要求，并且 100% 来自 Pablo M. Cibraro 的这篇精彩的帖子。**

[http://weblogs.asp.net/cibrax/getting-wcf-bindings-and-behaviors-from-any-config-source](http://weblogs.asp.net/cibrax/getting-wcf-bindings-and-behaviors-from-any-config-source)

此方法为您提供配置的绑定部分。

```
private BindingsSection GetBindingsSection(string path)
{
  System.Configuration.Configuration config = 
  System.Configuration.ConfigurationManager.OpenMappedExeConfiguration(
    new System.Configuration.ExeConfigurationFileMap() { ExeConfigFilename = path },
      System.Configuration.ConfigurationUserLevel.None);

  var serviceModel = ServiceModelSectionGroup.GetSectionGroup(config);
  return serviceModel.Bindings;
} 
```

此方法为您提供了您`Binding`迫切需要的实际对象。

```
public Binding ResolveBinding(string name)
{
  BindingsSection section = GetBindingsSection(path);

  foreach (var bindingCollection in section.BindingCollections)
  {
    if (bindingCollection.ConfiguredBindings.Count > 0 
        && bindingCollection.ConfiguredBindings[0].Name == name)
    {
      var bindingElement = bindingCollection.ConfiguredBindings[0];
      var binding = (Binding)Activator.CreateInstance(bindingCollection.BindingType);
      binding.Name = bindingElement.Name;
      bindingElement.ApplyConfiguration(binding);

      return binding;
    }
  }

  return null;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-16T15:49:41.283

查看Mark Gabarra 的[这篇](http://blogs.msdn.com/markgabarra/archive/2006/04/27/585607.aspx)博文，它展示了如何枚举配置的绑定

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-04-29T19:40:58.230

如果您直到运行时才知道绑定的类型，您可以使用以下内容：

```
return (Binding)Activator.CreateInstance(bindingType, endpointConfigName); 
```

其中 bindingType 的绑定类型和 endpointConfigName 是配置文件中指定的名称。

所有包含的绑定都提供了一个构造函数，该构造函数将 endpointConfigurationName 作为唯一参数，因此这应该适用于所有绑定。我已经将它用于 WsHttpBinding 和 NetTcpBinding 没有问题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-10T11:05:36.413

一个厚颜无耻的选择可能是使用默认构造函数创建一个实例，以用作模板：

```
Binding defaultBinding;
using(TestServiceClient client = new TestServiceClient()) {
    defaultBinding = client.Endpoint.Binding;
} 
```

然后把它收起来并重新使用它。有什么帮助吗？

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-16T09:20:38.230

您可以从 App.config/Web.config 实例化提供绑定配置名称的绑定。

[http://msdn.microsoft.com/en-us/library/ms575163.aspx](http://msdn.microsoft.com/en-us/library/ms575163.aspx)

> 使用由其配置名称指定的绑定初始化 WSHttpBinding 类的新实例。
> 
> 下面的示例演示如何使用字符串参数初始化 WSHttpBinding 类的新实例。
> 
> ```
> // Set the IssuerBinding to a WSHttpBinding loaded from config
> b.Security.Message.IssuerBinding = new WSHttpBinding("Issuer"); 
> ```

# c# - 我的 exe 本身运行良好，但在被服务加载时什么也不做

> ID：355579
> 
> 赞同：1
> 
> 时间：2008-12-10T10:04:38.063
> 
> 标签：c#, windows-services, system-tray

托盘图标的简单 exe，可独立运行

我使用 Windows 服务调用它，它似乎在运行（在任务管理器中），但它似乎不执行任何代码。即没有托盘图标等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-10T10:07:00.307

在 Vista 和 Windows 2008 上，服务在与用户不同的会话中运行——服务运行的任何 EXE 都将在与服务相同的会话中运行。在 Vista 之前，您需要选中“允许服务与桌面交互”框，否则同样适用。

这意味着您的托盘图标 EXE 无法与用户的桌面交互。您需要查看使用 CreateProcessAsUser 在正确的会话中运行 EXE。

[这篇博](http://blogs.technet.com/osd/archive/2009/04/28/creating-a-user-interactive-task-sequence-experience.aspx)文针对的是使用 ConfigMgr OS 部署的人，但它包含了在另一个会话中运行进程所需的步骤的一个很好的列表。您需要采取一些不明显的步骤，否则事情会以奇怪的方式失败。

# asp.net - ASP.NET 项目中的虚拟目录

> ID：355600
> 
> 赞同：1
> 
> 时间：2008-12-10T10:16:44.437
> 
> 标签：asp.net, visual-studio, visual-studio-2008, virtual-directory

在我们的 Web 应用程序中，我们有一个位于项目外部的目录。在 IIS 上这没问题，但我也可以在 Visual Studio 的项目中这样做吗？

**编辑：**我的项目在文件系统上运行，而不是在本地 IIS 上

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T10:24:32.470

如果您单击`File|Open|Website`然后单击`Local IIS`对话框左侧的按钮，然后导航到您的项目文件并从那里打开，您应该会发现虚拟目录包含在解决方案资源管理器中。

# .net - 在 ASP .Net 自定义成员资格提供程序中锁定用户

> ID：355602
> 
> 赞同：6
> 
> 时间：2008-12-10T10:17:15.933
> 
> 标签：.net, asp.net, membership, membership-provider, lockout

我必须为我当前的 ASP .Net 项目创建一个自定义成员资格提供程序，以适应我们的数据库模式，并且在配置它以锁定用户时遇到问题，如果用户密码错误三次，如支持标准提供者。

这是我需要自己实现的东西，还是应该得到固有的支持？

我没有专门处理它的代码（并且似乎没有一个接口成员专门处理它），但是如果我需要自己实现它，我该如何通知用户他们被锁定了？我是否需要在 ValidateUser 中引发某种异常？

**解决方案**

遗憾的是，我无法标记两个答案，Dave R 提供的链接深入了解了会员的工作原理，而 Zhaph 指出的正是我最终要做的，处理自定义会员提供程序中的锁定逻辑。

然后，我通过使用 Login 控件的 LoginError 事件来处理错误情况，并在那里签入以查看用户是否被锁定以显示适当的错误消息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T13:48:02.077

Scott Mitchell 在 ASP.NET 站点上编写了一系列优秀的教程。此链接包含有关创建自定义提供程序的信息并讨论了锁定逻辑：

[http://www.asp.net/LEARN/security/tutorial-06-cs.aspx](http://www.asp.net/LEARN/security/tutorial-06-cs.aspx)

也没有解锁帐户的内置方法（即，如果您使用类似于 SqlMembershipProvider 的东西，则必须通过数据库工具来完成此操作）。Scott 还写了一篇关于创建 UI 来管理它的文章，你可以在这里找到：

[http://www.asp.net/LEARN/security/tutorial-14-vb.aspx](http://www.asp.net/LEARN/security/tutorial-14-vb.aspx)

我实际上建议阅读整个系列。斯科特是一位出色的沟通者。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T13:56:28.737

这是你必须自己写的东西。

默认数据库架构在 aspnet_Membership 表中具有以下列：

```
IsLockedOut
FailedPasswordAttemptCount
FailedPasswordAttemptWindowStart 
```

尝试窗口内的每次失败尝试都会增加尝试计数，并且第一次尝试失败的时间存储在窗口开始列中，一旦 FailedPasswordAttemptCount 等于配置中的 maxInvalidPasswordAttempts，则设置 IsLockedOut。

正如 Michiel 所说，您的 ValidateUser 方法将需要根据提供程序配置中的设置检查这些值 - 默认情况下，这些值是：

```
maxInvalidPasswordAttempts="5"
passwordAttemptWindow="10" 
```

一旦用户达到最大登录尝试次数，您需要确保您已设置 MembershipUser.IsLockedOut 是从您的提供者设置的 - 然后您可以检查该值并采取适当的行为 - 如果您使用的是默认登录控件，则此value 可能已经为您检查过了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-14T12:40:22.877

复制导致锁定的条件（太多错误的登录尝试）。由于成员资格提供者每次都会访问其后端，因此明智的做法是将这种方法限制为具有合理数量的 MaxInvalidPasswordAttempts 的提供者。

```
if (0 < Membership.MaxInvalidPasswordAttempts && Membership.MaxInvalidPasswordAttempts < 100)
       {
                for(int i = 0; i <= Membership.MaxInvalidPasswordAttempts; i++)
                {
                    Membership.ValidateUser(userName, "jfdlsjflksjlkfjsdlkfjsdl");
                }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T13:15:48.647

在您的自定义成员资格提供程序中，您应该实现 ValidateUser 函数。在那里，您不仅可以检查用户名和密码是否有效，还可以从数据存储中检索无效密码尝试的次数等。如果用户名/密码有效，则重置密码尝试次数，否则增加尝试次数。SqlMembershipProvider 还存储 LastAttempt 日期时间，因此您不能强行进入，因为不允许您在特定时间范围内尝试。

# delphi - Delphi 应用程序调用 cobol 应用程序 -> 错误

> ID：355613
> 
> 赞同：2
> 
> 时间：2008-12-10T10:22:11.337
> 
> 标签：delphi, cobol

我们需要从旧的会计系统中获取数据。我们收到了一个 dll，可以让我们访问所需的数据。它包括一个我们已经导入的类型库。

如果我们从与会计系统相同的目录运行我们的测试应用程序，一切正常。如果我们尝试从不同的目录运行我们的应用程序，我们会收到以下错误：

> **动态绑定 RTS**
> 运行时 DLL 'OOPS'，版本 3.1，入口点 oops 未记录在注册表中，未找到或与动态绑定 COBOL 程序的要求不兼容。RTS 的动态绑定需要：运行时 DLL 'OOLSM'，至少版本 3.1

任何人都可以提供一些有用的信息吗？

我们是否应该在我们的目录中有某种 cobol 运行时？还是在路上？还是在注册表中注册？

谢谢，
-素食主义者

**更新：**
设置系统 %path% 以包含会计系统的路径似乎可以解决问题。由于某种原因，将其作为用户变量包含在内并没有相同的效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T11:23:47.640

你用的是什么Cobol？我已经使用 Microfocus NetExpress 3.1 完成了这一年，并且一切正常。我编写 COBOL DLL 来访问 COBOL 数据文件，还编写 Delphi DLL 来为旧的 COBOL 系统添加新功能。

是的，我用来设置运行时路径，即环境变量 COBDIR，还有其他的，但通常 %PATH% 和 %COBDIR% 就足够了。

如果您提供更多有关您使用的COBOL编译器的详细信息，以及您正在调用的dll接口如何，我会很容易为您提供帮助。

也许“Dependence Walker”可以帮助您确定缺少哪些运行时文件（如果有的话）。 [http://www.dependencywalker.com/](http://www.dependencywalker.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T10:35:44.943

如果它适用于会计应用程序的目录，但不是不同的目录，那么我尝试的第一件事就是将该目录添加到您的路径中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T13:34:30.060

除非它已经加载到内存中，否则 Windows 会在其 PATH 环境变量中列出的每个位置以及应用程序所在的目录中查找程序请求的 DLL。

# java - 包含 inputText 的 DataTable：是否可以使用 JSF 自定义组件

> ID：355614
> 
> 赞同：9
> 
> 时间：2008-12-10T10:22:26.483
> 
> 标签：java, jsf

我是 JSF 的新手，对于我正在研究的应用程序，我必须做一个多字段输入表单。

简而言之，用户在输入数据时应该有一个 inputText 和一个“添加”按钮，该按钮添加一个新的输入文本以输入另一个数据。当用户完成后，他按下另一个提交按钮。我寻找了一些已经完成的东西，但我没有找到任何东西，所以我决定创建我自己的自定义 jsf 组件

这个想法是创建一个组件，该组件包含一个包含数据表中每一行的 inputText 的数据表，以及一个向绑定到数据表的集合中添加一行的按钮。

我正在浏览 jsf 文档和书籍，但我有点困惑，我不确定是否可以创建这样一个组件......有人可以帮助我吗？TIA

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-10T16:50:49.523

可以做任何你想做的事情。

* * *

您可以使用现有控件构建接近您想要的东西。充分利用 JSF 的一个好方法是为视图定制模型。例如，此视图显示允许您向数据表添加值的编辑选项。

```
<f:view>
    <h:form>
        <h:dataTable value="#{people.list}" var="row">
            <h:column>
                <f:facet name="header">
                    <h:outputText value="#" />
                </f:facet>
                <h:selectBooleanCheckbox value="#{row.selected}" />
            </h:column>
            <h:column>
                <f:facet name="header">
                    <h:outputText value="First Name" />
                </f:facet>
                <h:inputText value="#{row.firstname}" />
            </h:column>
            <h:column>
                <f:facet name="header">
                    <h:outputText value="Last Name" />
                </f:facet>
                <h:inputText value="#{row.lastname}" />
            </h:column>
            <f:facet name="footer">
                <h:panelGroup>
                    <h:commandButton value="Add Row" action="#{people.addPerson}" />
                    <h:commandButton value="Delete Selected"
                        action="#{people.deleteSelected}" />
                    <h:commandButton value="Finish" action="#{people.finish}" />
                </h:panelGroup>
            </f:facet>
        </h:dataTable>
    </h:form>
</f:view> 
```

人豆：

```
public class People implements Serializable {

    private static final long serialVersionUID = 1L;

    private List<Person> people = new ArrayList<Person>();

    public People() {
        // initialise with one entry
        people.add(new Person());
    }

    public List<Person> getList() {
        return people;
    }

    public String addPerson() {
        people.add(new Person());
        return null;
    }

    public String deleteSelected() {
        Iterator<Person> entries = people.iterator();
        while (entries.hasNext()) {
            Person person = entries.next();
            if (person.isSelected()) {
                entries.remove();
            }
        }
        return null;
    }

    public String finish() {
        System.out.println(people);
        return "someNavigationRule";
    }

} 
```

人豆：

```
public class Person implements Serializable {

    private static final long serialVersionUID = 1L;

    private String firstname;
    private String lastname;
    private transient boolean selected = false;

    public String getFirstname() {
        return firstname;
    }

    public void setFirstname(String firstname) {
        this.firstname = firstname;
    }

    public String getLastname() {
        return lastname;
    }

    public void setLastname(String lastname) {
        this.lastname = lastname;
    }

    public boolean isSelected() {
        return selected;
    }

    public void setSelected(boolean selected) {
        this.selected = selected;
    }

} 
```

面孔-config.xml：

```
<managed-bean>
    <managed-bean-name>people</managed-bean-name>
    <managed-bean-class>addmultiple.People</managed-bean-class>
    <managed-bean-scope>session</managed-bean-scope>
</managed-bean> 
```

这种方法非常灵活，加上一些 CSS，看起来相当不错。例如，通过对视图和模型进行一些更改，您只能使最后一行可编辑。

* * *

如果产生的体验不够丰富，或者如果您需要可以重用的东西，您可以创建自定义控件。在不确切知道您想要什么的情况下很难进入细节，但您可能需要：

1.  用于发出 HTML 和解码表单请求的新[渲染器。](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/render/Renderer.html)
2.  （也许）一个新[组件](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/component/UIComponent.html)，可能扩展[UIData](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/component/UIData.html)，以及一个用于公开渲染套件特定（例如 HTML）属性的[具体形式。](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/component/html/HtmlDataTable.html)
3.  允许在 JSP 中使用控件的新 JSP[标记类。](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/webapp/UIComponentELTag.html)
4.  *faces-config.xml*中所有上述内容的定义（请参阅[规范](http://java.sun.com/javaee/javaserverfaces/download.html)）。

# .net - .NET：用 WPF 对象替换 ImageMagick

> ID：355616
> 
> 赞同：2
> 
> 时间：2008-12-10T10:22:57.043
> 
> 标签：.net, wpf, image, imagemagick, rich-media

我们都见过带有富媒体的超酷 WPF 演示应用程序。

我的问题是**WPF 对象是否可以替换[ImageMagick](http://www.imagemagick.org/)**中的一些基本功能。**调整图像大小、裁剪**等基本功能。

.NET 2.0 的 System.Graphics 命名空间调整大小的结果令人遗憾（GDI+）。也许我用错了，但它似乎是开箱即用的。

此外，一个不错的选择是 WPF 的 API:s 比 ImageMagick 的 .NET API 更清晰。

**更新**：我的想法是 WPF 可能会有**一个用于 Image-manipulation 的对象**。就像 GDI 有 System.Drawing.Image 和 System.Drawing.Bitmap。但我希望 WPF 的对象在图像大小调整等方面性能更高、质量更好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T16:04:41.923

WPF 和 GDI+ 是专门为 GUI 设计的图形系统，它们不是图像处理库。

WPF 比 GDI+ 好得多，但它仍然是一个 GUI 系统——在不同的硬件上产生完全相同的结果（就像 IgorK 担心的那样）并不是优先考虑的事情，调整大小的质量不如性能重要——否则它不会可用作渲染管道的一部分。

因此，如果您在显示图像之前使用 ImageMagick 进行基本处理，那么 WPF 可能对您有用（但我敢打赌，它的选项比 ImageMagick 少得多），如果您需要高质量的图像处理，那么 WPF 只是错误的工具工作。

WPF 是一个很棒的 GUI 系统（我用过的最好的），但它不是一个通用的图形系统，也不是一个图像处理库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T10:34:27.987

我不了解 WPF，但您可以使用 GDI+ - 这里有一个介绍：

*   [http://www.codeproject.com/KB/GDI-plus/imageresize.aspx](http://www.codeproject.com/KB/GDI-plus/imageresize.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T13:13:48.337

发现[这个博客](http://blogs.microsoft.co.il/blogs/tomershamam/archive/2007/09/21/wpf-image-processing.aspx)与您的情况相似。

我有点担心 WPF 将使用硬件渲染（如果可用）。例如，如果您在不同的硬件上需要相同的结果（不仅仅是*看起来相似），这可能会成为一个问题。*

您可以做一些非常有趣的事情，例如在 WPF 中应用 HLSL 着色器，但至少现在在我看来，它仍然是一种非常特殊（并且可能存在问题）的图像处理方式。可能有一天在许多其他领域使用 WPF 会变得不费吹灰之力，但现在我会坚持使用更可预测的 :) 当然很高兴知道 WPF 正在积极开发并且项目中有从事 GDI+ 的人（请参阅[此](http://www.fernicola.org/loquitor/index.php?/archives/19-When-to-use-WPF-and-when-to-use-other-technologies.html)）但是在严肃的项目中以“新方式”使用它是一种非常新鲜的技术。无论如何，我很高兴知道你是否成功地让 WPF 方法为你工作，对我来说这看起来很有趣:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T16:49:50.773

您可以只使用普通的旧 System.Drawing 命名空间。只需使用正确的对象、方法和参数，调整大小的图像不会很糟糕。

[http://weblogs.asp.net/gunnarpeipman/archive/2009/04/02/resizing-images-without-loss-of-quality.aspx](http://weblogs.asp.net/gunnarpeipman/archive/2009/04/02/resizing-images-without-loss-of-quality.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-20T13:14:34.370

WPF 和 GDI+ 在加载和处理图像时都有很多类型的错误。我向微软报告了一些错误，微软现在已经修复了这些错误……但仅限于 FW4.0 和 Windows7。对于其他操作系统（WinXP、Vista、Win2000）和 FW2.0，此错误将不会随时修复。

-- 抱歉英语不好:(

# php - 在 facebook 中发布提要，无法使用 API

> ID：355617
> 
> 赞同：0
> 
> 时间：2008-12-10T10:23:15.373
> 
> 标签：php, facebook, feed

我得到一个 -

> 调用未定义的方法

当我尝试使用`registerBundleTemplates`和`feed_publishUserAction`.

谷歌让我相信我需要调用一个名为 的函数`useBetaApiServer`，但我找不到任何关于如何使用 PHP 调用它的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T10:46:41.613

使用 call_method 解决了问题。对于解决您拥有的库与记录的库之间的差异非常有用。

# documentation - 将内部库的 doxygen 注释块放在哪里 - 在 H 或 CPP 文件中？

> ID：355619
> 
> 赞同：109
> 
> 时间：2008-12-10T10:23:42.190
> 
> 标签：documentation, comments, doxygen

常识告诉 Doxygen 注释块必须放在类、结构、枚举、函数、声明所在的头文件中。我同意这是一个合理的论点，因为库的意思是在没有源代码的情况下分发（只有标头和带有目标代码的库）。

但是......当我开发公司内部（或作为我自己的副项目）库时，我一直在考虑完全相反的方法，该库将与其完整源代码一起使用。我建议将大的注释块放在实现文件（HPP、INL、CPP 等）中，以免弄乱标头中声明的类和函数的接口。

**优点：**

*   头文件中的混乱更少，只能添加功能的分类。
*   例如，使用 Intellisense 时预览的注释块不会发生冲突 - 这是我在 .H 文件中有函数的注释块并且在同一个 .H 文件中有其内联定义时观察到的缺陷但包含在 .INL 文件中。

**缺点：**

*   （显而易见的）注释块不在声明所在的头文件中。

那么，您有什么想法和可能的建议？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-01-14T23:18:26.267

将文档放在人们在使用和处理代码时会阅读和编写的地方。

类注释在类前面，方法注释在方法前面。

这是确保事情得到维护的最佳方式。它还使您的头文件相对精简，并避免人们更新方法文档导致头文件变脏并触发重建的*感人*问题。实际上，我知道人们用它作为以后编写文档的借口*！*

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2011-10-12T08:23:41.683

我喜欢利用可以在多个地方记录名称的事实。

在头文件中，我写了方法的简要描述，并记录了它的所有参数——这些比方法本身的实现更不可能改变，如果他们这样做了，那么无论如何都需要改变函数原型.

我将长格式文档放在实际实现旁边的源文件中，因此可以随着方法的发展更改细节。

例如：

**我的模块.h**

```
/// @brief This method adds two integers.
/// @param a First integer to add.
/// @param b Second integer to add.
/// @return The sum of both parameters.
int add(int a, int b); 
```

**我的模块.cpp**

```
/// This method uses a little-known variant of integer addition known as
/// Sophocles' Scissors. It optimises the function's performance on many
/// platforms that we may or may not choose to target in the future.
/// @TODO make sure I implemented the algorithm correctly with some unit tests.
int add(int a, int b) {
  return b + a;
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-01-09T14:22:33.233

标题中包含注释意味着如果更改了注释，则必须重新编译类的所有用户。对于大型项目，如果编码人员冒着在接下来的 20 分钟内重建所有内容的风险，他们将不太愿意更新标题中的注释。

而且.. 由于您应该阅读 html 文档而不是浏览文档代码，因此在源文件中更难找到注释块并不是一个大问题。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-12-10T10:39:46.947

*标题：* 更容易阅读评论，因为在查看文件时其他“噪音”较少。

*资料来源：* 然后您可以在查看评论时阅读实际功能。

我们只使用在标头中注释的所有全局函数和在源代码中注释的局部函数。如果您愿意，还可以包含 copydoc 命令以将文档插入多个位置，而无需多次编写（更好地进行维护）

但是，您也可以使用简单的命令将结果复制到不同的文件文档中。例如：-

我的文件1.h

```
/**
 * \brief Short about function
 *
 * More about function
 */
WORD my_fync1(BYTE*); 
```

我的文件1.c

```
/** \copydoc my_func1 */
WORD my_fync1(BYTE* data){/*code*/} 
```

现在您获得了关于这两个函数的相同文档。

这可以减少代码文件中的噪音，同时将文档写在一个地方，呈现在最终输出的多个地方。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-05T15:06:51.547

通常我将接口文档 (\param, \return) 放在 .h 文件中，将实现文档 (\details) 放在 .c/.cpp/.m 文件中。Doxygen 对函数/方法文档中的所有内容进行分组。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T10:29:14.537

我把所有东西都放在头文件中。

我记录了所有内容，但通常只提取公共接口。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-24T20:34:15.593

我正在使用 QtCreator 进行编程。一个非常有用的技巧是按住 Ctrl 键单击函数或方法以获取头文件中的声明。

当在头文件中注释方法时，您可以快速找到您要查找的信息。所以对我来说，注释应该位于头文件中！

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-11-15T20:06:15.297

在 c++ 中，有时可以在 header 和 .cpp 模块之间拆分实现。在这里，将它的文档放入头文件似乎更干净，因为这是唯一保证所有公共函数和方法的地方。

# visual-studio - 代号产品和 Visual Studio

> ID：355620
> 
> 赞同：1
> 
> 时间：2008-12-10T10:24:05.497
> 
> 标签：visual-studio, naming, project-planning

是否有关于在 Visual Studio 项目和解决方案中使用产品代号的做法？通常，一旦选择了产品名称，命名空间、程序集名称、二进制输出等都需要重命名：有什么方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T10:30:41.507

在我工作的一个地方，我们会为任何给定的项目选择一个无关的、无害的、通常是系统的名称.. Jupiter、Orca、Feynman 等等......并且永远坚持使用这个命名空间。

因为正如您所看到的，市场营销/客户/董事会选择如何称呼产品（见鬼，甚至他们选择的版本号）在开始时很少被知道，更不用说在结束时相同了，它就是这样每个人都更容易拥有一个固定的内部参考，他们以后不必重构。

我不能强调这个名字是多么重要，一个简单的词，虽然没有冒犯性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T10:37:52.317

这部分取决于产品的类型。如果它是一个客户端库——或者任何需要用户查看名称的东西——那么显然名称很重要。我不认为这真的很重要。请记住，产品的不同版本可能有新的代号（例如 Everett、Whidbey、Orcas for Visual Studio）——您不希望每次启动新版本时都必须重命名代码！

# sql-server - 分层数据结构设计（嵌套集）

> ID：355628
> 
> 赞同：4
> 
> 时间：2008-12-10T10:28:10.043
> 
> 标签：sql-server, database, database-design

我正在设计一个分层数据库结构，该结构对包含产品的目录进行建模（这与[这个问题](https://stackoverflow.com/questions/112866/database-schema-for-a-hierarchial-groups)类似）。数据库平台是 SQL Server 2005，目录很大（750,000 个产品，4 个级别的 8,500 个目录部分）但相对静态（每天重新加载一次），因此我们只关心 READ 性能。

目录层次结构的一般结构是：-

*   1级部分
    *   2级部分
        *   3级部分
            *   4级部分（产品链接到这里）

我们使用嵌套集模式来存储层次结构级别并将存在于该级别的产品存储在单独的链接表中。所以简化的数据库结构将是

```
CREATE TABLE CatalogueSection
(
    SectionID INTEGER,
    ParentID INTEGER,
    LeftExtent INTEGER,
    RightExtent INTEGER
)

CREATE TABLE CatalogueProduct
(
    ProductID INTEGER,
    SectionID INTEGER
) 
```

我们确实有一个额外的复杂性，因为我们有大约 1000 个单独的客户组，他们可能会或可能不会看到目录中的所有产品。因此，我们需要为每个客户组维护一个单独的目录层次结构“副本”，这样当他们浏览目录时，他们只能看到他们的产品，也看不到任何空的部分。

为了促进这一点，我们维护了一个表格，其中包含以下部分中“汇总”的层次结构中每个级别的产品数量。因此，即使产品仅直接链接到层次结构的最低级别，它们也会一直沿树计算。这张表的结构是

```
CREATE TABLE CatalogueSectionCount
(
    SectionID INTEGER,
    CustomerGroupID INTEGER,
    SubSectionCount INTEGER,
    ProductCount INTEGER
) 
```

**因此，问题** 在于层次结构的顶层性能非常差。在所选目录部分（以及所有子部分）中显示“前 10 名”产品的一般查询需要大约 1 分钟才能完成。在层次结构的较低部分，它更快，但仍然不够好。

我已经在所有关键表上放置了索引（包括适用的覆盖索引），通过查询分析器、索引调整向导等运行它，但仍然无法让它足够快地执行。

我想知道设计是否存在根本缺陷，还是因为我们有这么大的数据集？我们有一个合理的开发服务器（3.8GHZ Xeon，4GB RAM），但它只是不工作:)

谢谢你的帮助

詹姆士

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-10T16:55:27.750

使用闭合表。如果您的基本结构是具有字段 ID 和 ParentID 的父子结构，则闭包表的结构是 ID 和 DescendantID。换句话说，闭包表是一个祖先-后代表，其中每个可能的祖先都与所有后代相关联。如果需要，您可以包含 LevelsBetween 字段。闭包表实现通常包括自引用记录，即 ID 1 是后代 ID 1 的祖先，LevelsBetween 为零。

示例：父/子
ParentID - ID
1 - 2
1 - 3
3 - 4
3 - 5
4 - 6

祖先/后代
ID - 后代 ID - LevelsBetween
1 - 1 - 0
1 - 2 - 1
1 - 3 - 1
1 - 4 - 2
1 - 6 - 3
2 - 2 - 0
3 - 3 - 0
3 - 4 - 1
3 - 5 - 1
3 - 6 - 2
4 - 4 - 0
4 - 6 - 1
5 - 5 - 0

该表旨在消除递归连接。您将递归联接的负载推入一个 ETL 周期，就像您每天加载一次数据时所做的那样。这使它远离查询。

此外，它允许可变级别的层次结构。你不会被困在4点。

最后，它允许您在非叶节点中插入产品。许多目录在层次结构的更高级别创建“杂项”存储桶，以创建一个叶节点来附加产品。您不需要这样做，因为中间节点包含在闭包中。

就索引而言，我会在 ID/DescendantID 上做一个聚集索引。

现在为您的查询性能。这会取出一大块但不是全部。您提到了“前 10 名”。这意味着对您未提及的一组事实进行排名。我们需要细节来帮助调整这些。另外，这只会获得叶级部分，而不是产品。至少，您的 CatalogueProduct 上应该有一个按 SectionID/ProductID 排序的索引。我会根据您提供的基数强制部分到产品连接成为循环连接。目录部分的报告将转到关闭表以获取后代（使用聚集索引查找）。然后，该后代列表将用于通过循环索引查找使用索引从 CatalogueProduct 中获取产品。然后，使用这些产品，您将获得进行排名所需的事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T11:24:57.450

您也许可以使用角色和 treeId 解决客户组问题，但您必须向我们提供查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T15:18:04.170

是否可以在每天加载后计算 ProductCount 和 SubSectionCount？
如果数据每天只更改一次，那么计算这些数字肯定是值得的，即使需要进行一些非规范化。

# firefox - 多种密码形式+密码完成

> ID：355632
> 
> 赞同：0
> 
> 时间：2008-12-10T10:32:00.863
> 
> 标签：firefox, passwords

在我正在工作的网站上，我们有一个现场登录和一个私人登录，我遇到的问题是 Firefox 似乎无法区分这些登录表单。

有谁知道我如何明确这些是不同的登录名？

我已经尝试为表单字段提供不同的名称和 ID，例如：onsite_login 和 login，但没有成功。

**编辑：**我的表单标签没有混淆，它们甚至不在同一页面上

不同页面上的两种表格

```
<form method="post" action="/en/login/1">
<fieldset>
    <p>
        <input type="hidden" value="login" name="form"/>
        <input type="hidden" value="en" name="redirect"/>
        <label for="onsite_username">Username<abbr title="Required ">*</abbr></label>
        <input type="text" class="input-text" maxlength="255" value="" name="onsite_username" id="onsite_username"/>
        <label for="onsite_password">Password<abbr title="Required ">*</abbr></label>
        <input type="password" class="input-password" maxlength="255" value="" name="onsite_password" id="onsite_password"/>
        <input type="submit" value="Log in" name="submit" class="input-submit"/>
    </p>
</fieldset>
</form> 
```

和

```
<form method="post" action="">
<fieldset>
    <input type="hidden" value="login" name="form"/>
    <div>
        <label for="username">Username</label>
        <input type="text" class="input-text" value="" name="username" id="username"/>
    </div><div>
        <label for="password">Password</label>
        <input type="password" class="input-password" value="" name="password" id="password"/>
    </div>
    <input type="submit" value="Aanmelden" class="input-submit"/>
</fieldset>
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-03T11:00:19.470

显然，由于 Firefox 存储其密码的方式，这是不可能的。

密码管理器条目与以下数据一起存储

*   用户名（使用 Firefox 主密码加密和保护）。
*   密码（使用 Firefox 主密码加密和保护）。
*   包含登录表单的网页的主机名。
*   表单数据已提交到的网页的主机名。

因此 Firefox 不区分我页面上的两个登录字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T11:20:02.560

我还没有听说过 Firefox 中的多表单问题。但是，如果周围有另一个未正确关闭的标签，则可能是 Firefox 混淆了您的 2 个登录表单。我自己也遇到过`<p>`标签问题，并且没有正确关闭`<div>`它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T12:08:26.723

我不确定..但试着给他们一个不同的ID，比如`<form method="POST" action="#" id="login1">`

# ruby - Mixins 和/或 Traits 有哪些好的例子？

> ID：355633
> 
> 赞同：16
> 
> 时间：2008-12-10T10:32:04.013
> 
> 标签：ruby, language-agnostic, mixins, traits

我正在阅读 Ruby，并了解了它的 mixins 模式，但想不出很多有用的 mixin 功能（因为我很可能不习惯这样思考）。所以我想知道什么是有用的 Mixin 功能的好例子？

谢谢

编辑：一点背景。我来自 C++ 和其他对象语言，但我怀疑 Ruby 说它没有继承 mixins，但我一直将 mixins 视为多重继承，所以我担心我试图过早地将它们归类到我的舒适区，并没有真正理解什么是mixin。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-10T10:55:50.580

它们通常用于向类添加某种形式的标准功能，而无需重新定义它。您可能会认为它们有点像 Java 中的接口，但不仅仅是定义需要实现的方法列表，它们中的许多实际上*将*通过包含模块来实现。

标准库中有几个例子：

Singleton - 可以混入任何类以使其成为单例的模块。初始化方法是私有的，并添加了一个实例方法，以确保在您的应用程序中只有一个该类的实例。

Comparable - 如果你在一个类中包含这个模块，定义 <=> 方法，它将当前实例与另一个对象进行比较并说明哪个更大，足以提供 <、<=、==、>=、> 和之间？方法。

Enumerable - 通过在此模块中混合并定义**每个**方法，您可以获得对所有其他相关方法的支持，例如收集、注入、选择和拒绝。如果它也有 <=> 方法，那么它也将支持排序、最小值和最大值。

DataMapper 也是一个有趣的例子，它可以通过简单的 include 语句完成，采用标准类，并添加将其持久化到数据存储的能力。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-10T11:02:54.453

好吧，我认为通常的例子是持久性

```
module Persistence
    def load sFileName
            puts "load code to read #{sFileName} contents into my_data"
    end
        def save sFileName
        puts "Uber code to persist #{@my_data} to #{sFileName}"
    end

end

class BrandNewClass
    include Persistence
    attr :my_data

        def data=(someData)
        @my_data = someData
    end
end

b = BrandNewClass.new
b.data = "My pwd"
b.save "MyFile.secret"
b.load "MyFile.secret" 
```

想象一下这个模块是由一个 Ruby 忍者编写的，它将你的类的状态保存到一个文件中。
现在假设我编写了一个全新的类，我可以通过将其混合来重用持久性的功能`include ModuleILike`。您甚至可以在运行时包含模块。我只需将其混合即可免费获得加载和保存方法。这些方法就像您为自己的班级编写的方法一样。代码/行为/功能——无需继承即可重用！

所以你正在做的是将方法包含到你的类的方法表中（不是字面上正确但很接近）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T13:58:27.437

在 ruby​​ 中，mixin 不是多重继承的原因是组合 mixin 方法是一次性的。这不会是一个大问题，除了 Ruby 的模块和类可以修改。这意味着如果您将一个模块混合到您的类中，然后向该模块添加一个方法，则该方法*将不适*用于您的类；如果您以相反的顺序执行此操作，则可以。

这就像订购冰淇淋蛋筒一样。如果你得到巧克力糖屑和太妃糖碎作为你的混合物，然后带着你的蛋筒走开，如果有人在冰淇淋店的巧克力糖屑箱中添加彩色糖屑，你将不会改变什么样的冰淇淋蛋筒。当 mixin 模块，洒水箱被修改时，你的类冰淇淋蛋筒没有被修改。下一个使用该 mixin 模块的人将看到这些更改。

当您`include`在 ruby​​ 中使用模块时，它会调用`Module#append_features`该模块，该模块会将该模块的方法的副本添加到包含器中。

据我了解，多重继承更像是委托。如果您的班级不知道如何做某事，它会询问其父母。在开放班级环境中，班级的父母可能在班级创建后已被修改。

这就像 RL 的父子关系。你的母亲可能在你出生后就学会了如何玩杂耍，但如果有人要求你玩杂耍，而你要求她：教你怎么玩（当你需要的时候复制它）或为你做（纯粹的委托），那么她'LL能够在那一点，即使你在她的歌唱能力之前创造了。

您可以修改 ruby​​ 模块“include”，使其更像多重继承，方法是修改`Module#append_features`以保留包含器列表，然后使用`method_added`回调更新它们，但这将是标准 Ruby 的一个重大转变，并且可能导致与其他代码一起工作时的主要问题。您可能最好创建一个`Module#inherit`调用`include`和处理委托的方法。

至于一个真实世界的例子，`Enumerable`太棒了。如果您定义`#each`并包含`Enumerable`在您的类中，那么您就可以访问一大堆迭代器，而无需对每个迭代器进行编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T10:37:05.737

它主要用于在 C++ 中使用多重继承或在 Java/C# 中实现接口。我不确定您的经验在哪里，但是如果您以前做过这些事情，那么 mixin 就是您在 Ruby 中执行它们的方式。这是一种将功能注入类的系统化方式。

# windows - 如何将值直接从 Windows 应用程序传递到打开的网页中的字段？

> ID：355636
> 
> 赞同：1
> 
> 时间：2008-12-10T10:33:28.567
> 
> 标签：windows

我有一个问题，我觉得最好在独立的 Windows 应用程序中实现，但需要将数据传递到已经打开的网页。

是否可以将数据直接传递到网页？

如果是这样，最好的方法是什么？

（这是我的第一个问题，所以放轻松！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T10:55:53.780

这不是一个容易解决的问题，但我*认为*可以通过将网页托管在嵌入 .NET 应用程序的浏览器中。[这篇代码项目文章](http://www.codeproject.com/KB/cs/mshtml_automation.aspx)可能会有所帮助

[本文](http://blog.monstuff.com/archives/000052.html)还讨论了一些关于通过 C# 应用程序访问 DOM 的内容。

你对语言有什么要求吗？您能否添加更多关于您想要实现的目标的详细信息？

编辑 1：[Watij](http://sourceforge.net/projects/watij/)是 Java 的 Web 应用程序测试框架。您可以使用它来填写文本框、单击按钮等。我认为它可能适合您的需求，如果不适合，它是开源的，因此您可以破解它来工作。有一整套 Wati* 产品 - 用于 .NET 的 Watin、用于 Ruby 的 Watir 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T11:10:38.710

由于安全凭证，不允许访问外部网页。但是您可以通过 winInet API 打开和写入网页。请浏览文章

[http://www.informit.com/library/content.aspx?b=Visual_C_PlusPlus&seqNum=107](http://www.informit.com/library/content.aspx?b=Visual_C_PlusPlus&seqNum=107)

# jquery - Jquery 切换事件与复选框值混淆

> ID：355638
> 
> 赞同：42
> 
> 时间：2008-12-10T10:34:22.997
> 
> 标签：jquery, forms

当用户单击复选框时，我正在使用 Jquery 的切换事件来做一些事情，如下所示：

```
$('input#myId').toggle(
function(){
//do stuff  
},
function(){
//do other stuff    
}
); 
```

问题是当我单击复选框时未勾选该复选框。（我在切换事件中添加的所有内容都可以正常工作。）

我尝试了以下方法：

```
$('input#myId').attr('checked', 'checked'); 
```

和

```
$(this).attr('checked', 'checked'); 
```

甚至简单地

```
return true; 
```

但没有任何工作。谁能告诉我哪里出错了？

编辑 - 感谢所有回复的人。除了检查属性的部分之外，Dreas 的回答几乎对我有用。这完美地工作（虽然它有点hacky）

```
$('input#myInput').change(function ()
{
    if(!$(this).hasClass("checked"))
    {
        //do stuff if the checkbox isn't checked
        $(this).addClass("checked");
        return;
    }

    //do stuff if the checkbox isn't checked
    $(this).removeClass('checked');
}); 
```

再次感谢所有回复的人。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-10T10:51:35.457

使用`change`事件而不是`toggle`事件，如下所示：

```
$('input#myId').change(function () {
    if ($(this).attr("checked")) {
        //do the stuff that you would do when 'checked'

        return;
    }
    //Here do the stuff you want to do when 'unchecked'
}); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-10T19:40:13.247

虽然使用`change`Dreas Grech 建议的事件处理程序是合适的，但它在 IE 6 和 7 中效果不佳，在焦点模糊之前不会触发`change`事件（即，直到您单击复选框区域之外） . 正如[QuirksMode](http://www.quirksmode.org/dom/events/change.html)所说，“这是一个严重的错误”。

您可能想要使用`click`事件处理程序，但这不适用于键盘导航。您还需要注册一个`keyup`处理程序...

另请参阅[此相关问题](https://stackoverflow.com/questions/368807)。

我还没有找到一个好的跨浏览器解决方案，它既支持鼠标单击又支持复选框的键盘激活（并且不会触发太多事件）。

* * *

关于检查复选框是否被选中的解决方案，而不是添加自己的`checked`类，您可以使用 HTML 的`checked`属性：

```
$('input#myInput').change(function () {
    if ($(this).attr("checked")) {
        //do stuff if the checkbox is checked
    } else {
        //do stuff if the checkbox isn't checked
    }
}); 
```

如果复选框被选中，任何浏览器都会将元素的`checked`属性设置为值，如果复选框未选中，则将其设置为（或删除属性）。`input``"checked"``null`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-10-07T10:48:45.203

为什么不使用 $.is() ？

```
$('input#myId').change(
    function() {
        if ($(this).is(':checked')) {
            // do stuff here 
        } else {
            // do other stuff here
        }
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-01T22:04:06.260

这是 MorningZ 的答案（我在[这里](http://old.nabble.com/how-do-you-toggle-a-checkbox-value--td19695519s27240.html)找到了），这完全有道理：

您缺少的部分是“复选框”是一个 jQuery 对象，而不是一个复选框 DOM 对象

所以：

`checkbox.checked`肯定会出错，因为没有`.checked`jQuery 对象的属性

所以：

`checkbox[0].checked`会起作用，因为 jQuery 数组上的第一项是 DOM 对象本身。

所以在你的`change()`函数中你可以使用

```
$(this)[0].checked 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T10:55:05.420

```
$('input#myId').toggle(
  function(e){
    e.preventDefault();
    //do stuff      
    $(this).attr('checked', 'true');
  },
  function(e){
    e.preventDefault();
    //do other stuff        
    $(this).attr('checked', 'false');
  }
); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-13T06:30:00.850

**这对我有用............检查一下**

```
$(":checkbox").click(function(){
if($(this).attr("id").split("chk_all")[1])
 {
  var ty  = "sel"+$(this).attr("id").split("chk_all")[1]+"[]";
  if($(this).attr("checked"))
   {
    $('input[name="'+ty+'"]').attr("checked", "checked");
   }
  else
   {
    $('input[name="'+ty+'"]').removeAttr("checked");
   }
 }
}) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T12:54:01.563

我做了类似的方法，但只是使用选中的属性，例如

```
 //toggles checkbox on/off
    $("input:checkbox").change(
        function(){
           if(!this.checked){
             this.checked=true;
           }
           else{
             this.checked=false;
           }
         }
       );
 //end toggle 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-25T03:41:54.213

尝试使用非 jquery 函数：

```
function chkboxToggle() {
  if ($('input#chkbox').attr('checked'))
    // do something
  else
    // do something else
} 
```

然后以您的形式：

```
<input id="chkbox" type="checkbox" onclick="chkboxToggle()" /> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-13T07:04:29.923

尝试：

```
$(":checkbox").click(function(){
  if($(this).attr("checked"))
   {
    $('input[name="name[]"]').attr("checked", "checked");
   }
  else
   {
    $('input[name="name[]"]').removeAttr("checked");
   }
}) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-12-03T01:10:14.553

```
 $("input[type=checkbox][checked=false]")// be shure to set to false on ready
    $("input#Checkbox1").change(function() {
        if ($(this).attr("checked")) {
            $("#chk1").html("you just selected me")//the lable
        } else {$("#chk1").html("you just un selected me") }    
    }); 
```

# c++ - C++ HTML模板框架、模板化库、HTML生成器库

> ID：355650
> 
> 赞同：64
> 
> 时间：2008-12-10T10:41:54.027
> 
> 标签：c++, template-engine

我正在寻找类似于例如的 C++ 模板/生成器库。Ruby 的 Erb、Haml、PHP 的 Smarty 等。

如果我能提供一些基本功能，如循环、if/else、int 转换为字符串等，那就太好了。

如果我可以在哈希映射中传递所有参数而不是为每个参数调用某个函数，那么将参数传递给模板渲染引擎也很重要。

你有什么建议？

我还可以看到嵌入 Lua 等语言的可能性，但是我也没有找到一个模板库。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-05T12:35:45.487

对上述项目的快速回顾。

[http://rgrz.tumblr.com/post/13808947359/review-of-html-template-engines-in-c-language](http://rgrz.tumblr.com/post/13808947359/review-of-html-template-engines-in-c-language)

## 清银

*   网站：[http ://www.clearsilver.net](http://www.clearsilver.net)
*   项目：[https ://code.google.com/p/clearsilver/](https://code.google.com/p/clearsilver/)
*   组：[http ://tech.groups.yahoo.com/group/ClearSilver](http://tech.groups.yahoo.com/group/ClearSilver)
*   许可证：新 BSD 许可证
*   语言：C
*   最后更新：2011 年 11 月 28 日
*   上次发布：2007 年 7 月 12 日的 0.10.5
*   文件：丰富
*   社区：中等（每月少于 10 次讨论）

## 腾

*   网址：[http ://teng.sourceforge.net](http://teng.sourceforge.net)
*   代码：[http ://teng.svn.sourceforge.net/teng/](http://teng.svn.sourceforge.net/teng/)
*   群组：http: [//sourceforge.net/projects/teng/](http://sourceforge.net/projects/teng/)
*   许可证：新 BSD 许可证
*   语言：C++
*   绑定：php、python
*   最后更新：2011 年 3 月 8 日
*   最后发布：2011 年 3 月 8 日的 2.1.1
*   文件：丰富
*   社区：低（自 2010 年以来很少讨论）

## 模板化器

*   网站：[http ://www.lazarusid.com/libtemplate.shtml](http://www.lazarusid.com/libtemplate.shtml)
*   项目：只下载
*   组：无
*   许可证：免费使用
*   语言：C（低级）/C++（接口）混合
*   最后更新：未知
*   最后发布：未知
*   文件：无
*   社区：无

## HTML 模板 C++

*   网站： http: [//nulidex.com/code/docs/html_template/](http://nulidex.com/code/docs/html_template/)
*   项目：http: [//sourceforge.net/projects/htmltemplatec](http://sourceforge.net/projects/htmltemplatec)
*   组：http: [//sourceforge.net/projects/htmltemplatec](http://sourceforge.net/projects/htmltemplatec)
*   许可证：GPL
*   语言：C++
*   最后更新：2011 年 3 月 27 日
*   上次发布：Beta 0.7.4，2011 年 3 月 27 日
*   文件：中
*   社区：无

## ctpp

*   网站：[http ://ctpp.havoc.ru/en/](http://ctpp.havoc.ru/en/)
*   项目：只下载
*   组：无
*   许可证：BSD许可证
*   语言：C++ 和 C API
*   最后更新：2011 年 10 月 5 日
*   最后发布：2011 年 10 月 5 日版本 2.7.2
*   文件：丰富
*   社区：无

## 重量

*   网站：[http ://www.webtoolkit.eu/wt/](http://www.webtoolkit.eu/wt/)
*   项目：[http ://www.webtoolkit.eu/wt/](http://www.webtoolkit.eu/wt/)
*   组：[http ://www.webtoolkit.eu/wt/community](http://www.webtoolkit.eu/wt/community)
*   许可证：GPL 和商业
*   语言：C++
*   最后更新：2011 年 11 月 29 日
*   最后发布：2011 年 11 月 29 日 3.2.0
*   文件：丰富
*   社区：低（稀有活动）

## 平底锅

*   网站： http: [//flate.dead-inside.org/](http://flate.dead-inside.org/)
*   项目：无
*   组：无
*   许可证：LGPL v2.1
*   语言：C
*   最后更新：2010 年 9 月 4 日
*   上次发布：2.0 于 2010 年 9 月 4 日
*   文件：差
*   社区：无

## Jinja2C++

*   网站：[https ://jinja2cpp.dev](https://jinja2cpp.dev)
*   项目：[https ://github.com/jinja2cpp](https://github.com/jinja2cpp)
*   群组：[https ://gitter.im/Jinja2Cpp/Lobby](https://gitter.im/Jinja2Cpp/Lobby)
*   柯南包：[https ://bintray.com/beta/#/flexferrum/conan-packages/jinja2cpp:flexferrum?tab=overview](https://bintray.com/beta/#/flexferrum/conan-packages/jinja2cpp:flexferrum?tab=overview)
*   许可证：MPL-2.0
*   语言：C++14/17
*   最后更新：2019 年 10 月 1 日
*   最后发布：2019 年 10 月 1 日 1.0.0
*   文件：中等
*   社区：无

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-03-03T13:58:45.803

[Grantlee](https://github.com/steveire/grantlee)是一个基于 Django 模板系统的字符串模板引擎。它被移植到 C++/Qt。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-07T19:38:10.297

[NLTemplate](https://www.catnapgames.com/2013/04/09/nltemplate-html-template-library-for-c/)是一个小型 C++ 模板库，其语法类似于 Django。

*   变量替换
*   可重复或可选块
*   文件包括
*   麻省理工学院许可
*   没有外部依赖
*   单一源文件，易于添加到任何项目

*免责声明：我是作者。*

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-11T17:26:43.747

[Wt](http://www.webtoolkit.eu/wt)（读作“witty”）是一个用于开发和部署 Web 应用程序的 C++ 库和应用程序服务器。它不是一个强制编程方式的“框架”，而是一个库。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-02T11:20:26.057

[CTPP](http://ctpp.havoc.ru/en/)是用 C++ 编写的非常快速和强大的库。它具有 Perl、PHP 和 Python 的绑定。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-10T11:17:55.373

[ClearSilver](http://www.clearsilver.net/)可用于 c。[这](http://www.clearsilver.net/examples.hdf)是使用 clearsilver 的现有网站的列表。但我自己不使用它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-23T21:28:06.123

脸书的[格式](https://github.com/facebook/folly/blob/master/folly/docs/Format.md)：

```
std::cout << format("The answers are {} and {}", 23, 42); 
// => "The answers are 23 and 42"

std::map<std::string, std::string> m { {"what", "answer"}, {"value", "42"} }; 
std::cout << vformat("The only {what} is {value}", m); 
// => "The only answer is 42" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-06-01T04:28:24.647

我尝试过使用 ffead-cpp 框架提供的模板引擎和动态 C++ 页面，[wiki上显示了一个示例实现](http://code.google.com/p/ffead-cpp/wiki/ExampledcpFile)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-21T13:03:21.260

## 模板

[https://code.google.com/p/ctemplate/?redir=1](https://code.google.com/p/ctemplate/?redir=1)

新的 BSD 许可证

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-02-20T09:21:01.627

不知何故，我最初搜索时错过了 NLTemplate，并编写了自己的 C++ 模板引擎，显然与 NLTemplate 有类似的用例:-)

[https://github.com/hughperkins/Jinja2CppLight](https://github.com/hughperkins/Jinja2CppLight)

*   类似 Jinja2 的语法
*   轻量级，不依赖于 boost、qt 等，...
*   变量替换
*   for 循环
    *   包括嵌套的for循环:-)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-05-16T23:23:32.623

我[在这里](https://github.com/burner/sweet.hpp/tree/master/amber)开发了一些模仿[jade](http://jade-lang.com/) for c++的东西。它采用简单但功能强大的输入语言并创建一个将 HTML 写入流的单个 c++ 模板函数。

```
< html
  < h1 The title is ${{ params["title"] }}& >
    < ul >
    & for(int i = 0; i < boost::get<int>(params["items"]); ++i) {
      < li Item ${{ i }}$ >
    & }
> 
```

*   变量替换
*   用户定义的代码块
*   收获 c++ 的全部力量（循环、变量声明，随你怎么说）
*   超级容易集成到源代码构建中
*   一切可能在编译时完成
*   无中间格式（直接 c++）
*   易于调试（因为 c++ 输出）
*   没有外部依赖
*   不到 600 行的 c++ 超微小
*   GPL 许可

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-08-09T22:33:34.157

[Templtext](https://github.com/trodevel/templtext)是一个小型 C++ 文本模板处理库。它支持类似 bash 的变量（%VAR 或 %{VAR}）。但主要特点是支持**用户定义的功能**。图书馆是我创建的。

*   模板解析
*   变量替换
*   模板中的用户定义函数
*   C++11
*   GPL 许可证

需要 BOOST 正则表达式库，但下个版本将替换为 std::regex

示例 1：

```
using namespace templtext;

Templ * t = new Templ( "Dear %SALUTATION %NAME. I would like to invite you for %TEXT. Sincerely yours, %MYNAME." );

std::map<std::string, std::string> tokens01 =
{
        { "SALUTATION", "Mr." },
        { "NAME", "John Doe" },
        { "TEXT", "an interview" },
        { "MYNAME", "Ty Coon" }
};

std::map<std::string, std::string> tokens02 =
{
        { "SALUTATION", "Sweetheart" },
        { "NAME", "Mary" },
        { "TEXT", "a cup of coffee" },
        { "MYNAME", "Bob" }
};

std::cout << t->format( tokens01 ) << std::endl;
std::cout << t->format( tokens02 ) << std::endl; 
```

输出：

```
Dear Mr. John Doe. I would like to invite you for an interview. Sincerely yours, Ty Coon.
Dear Sweetheart Mary. I would like to invite you for a cup of coffee. Sincerely yours, Bob. 
```

示例 2：

```
using namespace templtext;

std::unique_ptr<Templ> tf1( new Templ( "You have got an $decode( 1 )." ) );
std::unique_ptr<Templ> tf2( new Templ( "You have got an $decode( 2 )." ) );
std::unique_ptr<Templ> tf3( new Templ( "English version - $decode_loc( 1, EN )." ) );
std::unique_ptr<Templ> tf4( new Templ( "German version  - $decode_loc( 1, DE )." ) );
std::unique_ptr<Templ> tf5( new Templ( "Flexible version - $decode_loc( 1, %LANG )." ) );

tf1->set_func_proc( func );
tf2->set_func_proc( func );
tf3->set_func_proc( func );
tf4->set_func_proc( func );
tf5->set_func_proc( func );

Templ::MapKeyValue map1 =
{
        { "LANG", "EN" }
};

Templ::MapKeyValue map2 =
{
        { "LANG", "DE" }
};

std::cout << tf1->format() << std::endl;
std::cout << tf2->format() << std::endl;
std::cout << tf3->format() << std::endl;
std::cout << tf4->format() << std::endl;
std::cout << tf5->format( map1 ) << std::endl;
std::cout << tf5->format( map2 ) << std::endl; 
```

输出：

```
You have got an apple.
You have got an orange.
English version - apple.
German version  - Apfel.
Flexible version - apple.
Flexible version - Apfel. 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-06-20T18:46:34.993

**Jinja2C++**

*   网站：[https ://jinja2cpp.dev](https://jinja2cpp.dev)
*   项目：[https ://github.com/jinja2cpp](https://github.com/jinja2cpp)
*   柯南包：[https ://bintray.com/beta/#/flexferrum/conan-packages/jinja2cpp:flexferrum?tab=overview](https://bintray.com/beta/#/flexferrum/conan-packages/jinja2cpp:flexferrum?tab=overview)
*   许可证：MPL-2.0
*   语言：C++14/17
*   最后更新：2019 年 10 月 1 日
*   最后发布：2019 年 10 月 1 日 1.0.0
*   文件：中等

**描述：**

*   C++14/17 库
*   支持主流编译器（Visual C++、gcc、clang）
*   易于使用的界面。
*   符合 Jinja2 规范[http://jinja.pocoo.org/docs/2.10/](http://jinja.pocoo.org/docs/2.10/)
*   支持模板和 - 参数的窄字符串和宽字符串。
*   针对 C++ 类型和流行的 json 库（nlohmann、RapidJson）的内置反射。
*   用户定义的可调用对象。
*   功能强大的全功能 Jinja2 表达式，带有过滤（通过“|”运算符）和“i​​f”表达式。
*   大量 Jinja2 标记包括宏和模板扩展。
*   丰富的错误报告。

# if-statement - 从函数中提前返回是否比 if 语句更优雅？

> ID：355670
> 
> 赞同：21
> 
> 时间：2008-12-10T10:54:21.537
> 
> 标签：if-statement, return

我和一位同事对以下哪个更优雅存在争议。我不会说谁是谁，所以是不偏不倚的。哪个更优雅？

```
public function set hitZone(target:DisplayObject):void
        {
            if(_hitZone != target)
            {
                _hitZone.removeEventListener(MouseEvent.ROLL_OVER, onBtOver);
                _hitZone.removeEventListener(MouseEvent.ROLL_OUT, onBtOut);
                _hitZone.removeEventListener(MouseEvent.MOUSE_DOWN, onBtDown);

                _hitZone = target;

                _hitZone.addEventListener(MouseEvent.ROLL_OVER, onBtOver, false, 0, true);
                _hitZone.addEventListener(MouseEvent.ROLL_OUT, onBtOut, false, 0, true);
                _hitZone.addEventListener(MouseEvent.MOUSE_DOWN, onBtDown, false, 0, true);
            }
        } 
```

...或者...

```
public function set hitZone(target:DisplayObject):void
        {
            if(_hitZone == target)return;

            _hitZone.removeEventListener(MouseEvent.ROLL_OVER, onBtOver);
            _hitZone.removeEventListener(MouseEvent.ROLL_OUT, onBtOut);
            _hitZone.removeEventListener(MouseEvent.MOUSE_DOWN, onBtDown);

            _hitZone = target;

            _hitZone.addEventListener(MouseEvent.ROLL_OVER, onBtOver, false, 0, true);
            _hitZone.addEventListener(MouseEvent.ROLL_OUT, onBtOut, false, 0, true);
            _hitZone.addEventListener(MouseEvent.MOUSE_DOWN, onBtDown, false, 0, true);

        } 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-10T10:58:54.023

在大多数情况下，提前返回会降低复杂性并使代码更具可读性。

这也是[斯巴达编程](http://ssdl-wiki.cs.technion.ac.il/wiki/index.php/Spartan_programming)中应用的技术之一：

> **最少使用控制**
> 
> 1.  通过使用诸如三元化、继承和类（如 Class Defaults、Class Once 和 Class Separator）之类的专门构造来最小化条件句的使用
> 2.  用 early 简化条件`return`。
> 3.  通过使用动作应用程序类（例如 Class Separate 和 Class FileSystemVisitor），最大限度地减少循环结构的使用。
> 4.  通过提前退出（通过 和 语句）简化迭代`return`逻辑 。`continue``break`

在您的示例中，我会选择选项 2，因为它使代码更具可读性。检查函数参数时，我使用相同的技术。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-10T12:11:07.137

这是可以打破规则（即最佳实践）的情况之一。通常，您希望函数中的返回点尽可能少。这样做的实际原因是它简化了您对代码的阅读，因为您总是可以假设每个函数都会接受它的参数，执行它的逻辑并返回它的结果。为各种情况添加额外的回报往往会使逻辑复杂化，并增加阅读和完全理解代码所需的时间。一旦您的代码进入维护阶段，那么多次返回可能会对新程序员的生产力产生巨大影响，因为他们试图破译逻辑（当注释稀疏且代码不清楚时尤其糟糕）。问题随着函数的长度呈指数增长。

那么为什么在这种情况下每个人都更喜欢选项 2？这是因为您正在设置一个合约，该函数通过验证传入数据或其他可能需要检查的不变量来强制执行。构造验证的最漂亮的语法是检查每个条件，如果条件无效，则立即返回。这样您就不必通过所有检查来维护某种 isValid 布尔值。

总结一下：我们真正关注的是如何编写验证代码而不是一般逻辑；选项 2 更适合验证代码。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-10T11:09:49.837

只要将早期返回组织为函数/方法体顶部的块，那么我认为它们比添加另一层嵌套更具可读性。

我尽量避免在身体中间提前返回。有时它们是最好的方法，但大多数时候我认为它们很复杂。

此外，作为一般规则，我尽量减少嵌套控制结构。显然你可以把这个做得太过分了，所以你必须谨慎行事。将嵌套的 if 转换为单个 switch/case 对我来说要清楚得多，即使谓词重复一些子表达式（并且假设这不是一种语言中的性能关键循环，因为它太愚蠢而无法消除子表达式）。特别是我不喜欢长函数/方法体中嵌套 if 的组合，因为如果你出于某种原因跳到代码中间，你最终会上下滚动以在心理上重建给定行的上下文。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-10T11:48:52.330

根据我的经验，在项目中使用早期回报的问题在于，如果项目中的其他人不习惯它们，他们就不会寻找它们。无论是否提前返回 - 如果涉及多个程序员，请确保每个人至少都知道他们的存在。

我个人编写代码以尽快返回，因为延迟返回通常会引入额外的复杂性，例如尝试安全地退出一堆嵌套循环和条件。

所以当我看到一个不熟悉的函数时，我做的第一件事就是寻找所有的`return`s。真正有帮助的是设置您的语法着色以提供`return`与其他任何东西不同的颜色。（我喜欢红色。）这样，`return`s 成为确定函数作用的有用工具，而不是为粗心的人隐藏绊脚石。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T11:03:38.133

啊守护者。

恕我直言，是的 - 它的逻辑更清晰，因为返回是明确的并且紧邻条件，并且可以很好地与相似的结构分组。这更适用于将“return”替换为“throw new Exception”的情况。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T11:40:17.433

如前所述，提前返回更具可读性，特别是如果函数体很长，您可能会发现在 3 页函数中错误地删除了 }（这本身不是很优雅）并尝试编译它可能需要几分钟的非自动化调试。

它还使代码更具声明性，因为这是您向另一个人描述它的方式，因此开发人员可能足够接近可以理解它。

如果稍后函数的复杂性增加，并且您有良好的测试，您可以简单地将每个替代方案包装在一个新函数中，并在分支分支中调用它们，这样您就可以保持声明式风格。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T11:01:04.220

在这种情况下（一个测试，没有其他子句）我喜欢测试和返回。它清楚地表明，在这种情况下，无需阅读函数的其余部分，无需执行任何操作。

然而，这正在分裂最好的头发。我相信你一定有更大的问题要担心:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-10T11:05:09.533

选项 2 更具可读性，但是当可能需要添加 else 时，代码的可管理性会失败。

因此，如果您确定，选项 2 没有其他选择，但如果可能有其他条件的范围，那么我更喜欢选项 1

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-10T11:29:25.630

选项 1 更好，因为您应该在程序中有最少数量的返回点。有例外，例如

```
  如果一个） {
    返回 x;
  }
  返回 y;

```

由于语言的工作方式，但总的来说，最好尽可能少地设置退出点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-10T12:04:12.207

我更喜欢避免在函数开头立即返回，并尽可能放置限定逻辑以防止在调用之前进入该方法。当然，这取决于方法的目的。

但是，我不介意在方法中间返回，只要方法简短易读。如果方法很大，在我看来，它已经不是很可读了，所以它要么被重构为具有内联返回的多个函数，要么我将显式地从控制结构中分离出来，最后只返回一个返回。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-10T12:43:31.597

我很想将其关闭为完全重复，因为我已经看到了一些类似的线程，包括[反转“if”语句以减少嵌套](https://stackoverflow.com/questions/268132/invert-if-statement-to-reduce-nesting "反转“if”语句以减少嵌套")，这有很好的答案。

我现在就让它活下去……^_^

为了回答这个问题，我相信作为保护子句的早期返回比深度嵌套的 if 更好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-10T13:06:09.290

我已经看过这两种类型的代码，我更喜欢第一种，因为它看起来很容易阅读和理解，但我读过很多早期存在的地方是更好的方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-11T01:03:22.557

至少还有另一种选择。将实际工作的细节与是否执行工作的决定分开。类似于以下内容：

```
public function setHitZone(target:DisplayObject):void
    {
        if(_hitZone != target)
            setHitZoneUnconditionally(target);

    }

public function setHitZoneUnconditionally(target:DisplayObject):void
    {
        _hitZone.removeEventListener(MouseEvent.ROLL_OVER, onBtOver);
        _hitZone.removeEventListener(MouseEvent.ROLL_OUT, onBtOut);
        _hitZone.removeEventListener(MouseEvent.MOUSE_DOWN, onBtDown);

        _hitZone = target;

        _hitZone.addEventListener(MouseEvent.ROLL_OVER, onBtOver, false, 0, true);
        _hitZone.addEventListener(MouseEvent.ROLL_OUT, onBtOut, false, 0, true);
        _hitZone.addEventListener(MouseEvent.MOUSE_DOWN, onBtDown, false, 0, true);

    } 
```

这三个（你的两个加上上面的第三个）中的任何一个对于像这样小的案件都是合理的。然而，拥有数百行长的函数并在其中散布多个“救助点”将是一件坏事。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-01-16T21:20:02.530

多年来，我一直在用我自己的代码进行辩论。我开始有利于一次回报的生活，然后慢慢地消失了。

在这种情况下，我更喜欢选项 2（一次返回），因为我们只讨论了由 if() 包装的 7 行代码，没有其他复杂性。它更具可读性和功能性。它从上到下流动。你知道你从顶部开始，在底部结束。

话虽如此，正如其他人所说，如果一开始有更多的警卫或更复杂的情况，或者如果函数增长，那么我更喜欢选项 1：在开始时立即返回以进行简单的验证。

# asp.net - 如何动态添加 ASP.NET 按钮来触发事件？

> ID：355673
> 
> 赞同：2
> 
> 时间：2008-12-10T10:55:06.247
> 
> 标签：asp.net

这可能是一个简单的问题，但我不是 ASP.NET 开发人员，我很困惑。

我有一个简单的搜索例程，它返回零到几百个结果。这些中的每一个都必须作为按钮添加到页面中，我想设置按钮的文本和 CommandArgument 属性，以便在单击按钮时可以读取 CommandArgument 并做出相应的反应。

但是，当我单击按钮时，事件根本不会运行。我怎样才能让它运行？

构建按钮列表的代码（为便于阅读而简化）如下：

```
 foreach (SearchResult sr in searchResults)
    {
        Button result = new Button();
        result.Text = sr.name;
        result.CommandArgument = sr.ID.ToString();
        AccountSearchResults.Controls.Add(result);
        result.Click += new EventHandler(SearchResultClicked);
        AccountSearchResults.Controls.Add(new LiteralControl("<br/>"));
    } 
```

在进行测试的那一刻，我在表单上弹出了一个标签，将 CommandArgument 放入其中。不过，这段代码永远不会执行。

```
 void SearchResultClicked(object sender, EventArgs e)
    {
        Label1.Text = ((Button)sender).CommandArgument;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T11:18:40.130

您在另一个答案中提到您在单击按钮时添加这些。查看您的代码，我建议您尝试为添加的每个按钮设置一个唯一 ID，然后确保在加载页面时重新加载具有相同 ID 和 CommandArgument 值的按钮。单击动态加载的按钮时，它必须在回发后仍然存在于页面上才能触发事件。

我认为 ID 是您所需要的，加上您对 CommandArgument 的要求）。如果没有长时间的搜索过程就无法重复，您可以将 ID 信息放在 ViewState 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T10:58:34.070

我认为您需要使用 OnCommand 事件处理程序，而不是 OnClick 即尝试更改此：

```
result.Click += new EventHandler(SearchResultClicked); 
```

对此：

```
result.Command += new EventHandler(SearchResultClicked); 
```

## 更新

尝试将事件处理程序的第二个参数的类型从*EventArgs*更改为**CommandEventArgs**。您可能还必须在按钮上设置 CommandName 属性，即

```
result.CommandName = "foo"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T11:11:13.063

你在哪里添加这个按钮？

如果您将它们添加到另一个控件中，则该事件可能会在父控件中引发。例如，这发生在 DataRepeaters 和 DataGrids 上。

# visual-studio-2008 - Visual Studio 2008 中的本地化

> ID：355685
> 
> 赞同：3
> 
> 时间：2008-12-10T10:59:14.210
> 
> 标签：visual-studio-2008, localization

我正在尝试在 VS2008 中本地化桌面应用程序 (C#)。

我已经掌握了多种语言的本地化表单，并且我还有一个用于通用字符串的项目资源文件，但我无法理解如何创建该文件的多种语言版本！

它似乎没有记录在任何地方。

结果似乎是，如果我想生成我的应用程序的德语版本，我必须编辑通用资源文件（Properties/Resources.resx），构建和部署应用程序，然后重新编辑通用资源文件回到英语。

每次我想制作一个新的德语版本时，我都必须这样做。与本地化表单的工具相比，这似乎很笨拙，我相信在 VS2008 中有更好的方法。有谁知道它是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T03:54:10.713

你是对的，我看错了这个问题。

在这种情况下，您可能想要尝试向项目中添加一个新项目，或者您添加现有资源文件的现有副本可能需要先在 VS 之外重命名它。

选择“资源文件”

将其命名为 Resource.de-DE.resx

创建完成后，您可以将其移至“属性”文件夹。

打开文件，将顶部的访问修饰符更改为内部，它将设置为“无代码生成”

将带有德语翻译的字符串添加到新资源文件中

编译，当语言或线程 UI 文化发生变化时，它应该使用语言资源文件中的正确值。

我的快速小测试运行良好并根据需要切换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T11:08:33.613

您可以使用[卫星资源 DLL](http://msdn.microsoft.com/en-us/library/ms165653.aspx)（注意：我只在 C++ 中使用过它们）。
这是一个系统，您可以在其中为您想要支持的每种语言提供不同的资源 DLL。应用程序内部将不再有资源（至少没有可能需要本地化的资源），因此翻译团队只需将资源 DLL 翻译成适当的语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T16:43:44.937

实际上，Visual Studio 已经内置了。在您希望本地化语言的表单上，将属性 Localizable 更改为 true。

然后将 Language 属性更改为您希望为其设置资源文件的语言。在你的情况下，选择德语。

将表单上的所有文本更改为德语文本。这将为您更改语言属性的每种语言创建一个额外的 resx 文件。

完成后，您可以为另一个翻译的表单资源文件更改为另一种语言或切换回默认值。

现在，当计算机在设置为使用不同语言的机器上运行时，它将查找 resx 文件以匹配并切换所有控件以使用资源文件中提供的文本。

您还可以通过更改 CurrentThread 上的 CurrentUICulture 来测试这一点

这也是 MSDN 上的一个很好的演练：http:
[//msdn.microsoft.com/en-us/library/y99d1cd3 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/y99d1cd3(VS.80).aspx)

# database - 如何在 db2 9.1 中删除过程/视图/表之前检查它是否存在？

> ID：355687
> 
> 赞同：1
> 
> 时间：2008-12-10T10:59:28.420
> 
> 标签：database, db2

我们如何在 db2 中编写下面的伪代码，

```
If (Proc exists)
  Drop Proc
  Create Proc
Else
 Create Proc 
```

我在谷歌搜索后发现的一种解决方案是忽略返回码。我们有更优雅的方式来做到这一点吗？

谢谢

* * *

更新：在下面的答案的帮助下，我们编写了一个如下的过程来删除程序

```
 CREATE PROCEDURE SVCASNDB.DROPSP(IN P_SPECIFICNAME VARCHAR(128))
        SPECIFIC DROPSP

        P1: BEGIN

        -- Drop the SP if it already exists
        if exists (SELECT SPECIFICNAME FROM SYSIBM.SYSROUTINES WHERE SPECIFICNAME = trim(upper(p_SpecificName))) then
            begin
                DECLARE v_StmtString VARCHAR (1024);
                SET v_StmtString = 'DROP SPECIFIC PROCEDURE SCHEMA.' || p_SpecificName;
                PREPARE stmt1 FROM v_StmtString ;
                EXECUTE stmt1;
            end;
        end if;

    END P1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T13:53:26.717

这个查询：

```
SELECT DISTINCT ROUTINENAME, RESULT_SETS, REMARKS 
FROM SYSIBM.SYSROUTINES 
WHERE ROUTINESCHEMA='<schema>' AND FUNCTION_TYPE NOT IN ('S', 'T') 
```

（您在占位符处指定架构名称）为您提供架构中的所有过程。所以 Proc 存在部分只是对该视图的 EXISTS 查询，具有正确的 proc 名称。

# c++ - Symbian C++ STOMP 库

> ID：355690
> 
> 赞同：1
> 
> 时间：2008-12-10T11:00:06.143
> 
> 标签：c++, symbian, s60

我希望我的 S60 应用程序使用 Stomp 协议。

虽然我自己实现起来相当简单（但没有什么比我希望的 Symbian 更简单）——我想知道是否有人已经有这方面的经验。

似乎几乎所有其他语言都存在 Stomp 库。Symbian 最接近的匹配项是[此处](http://stomp.codehaus.org/Clients)列出的 C++ 库，但它完全嵌入 ActiveMQ 源代码中。

任何人都可以提供任何建议/经验吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-20T17:06:34.440

如果这仍然相关 - 我刚刚完成了 Symbian STOMP 客户端的实现，完全使用 Active Scheduler 框架。一旦我在 Google Code 上设置了一些东西，我们就会将它作为开源发布。

正如 Adam 所说 - 实现需要完全在 Symbian 框架内，否则将无法使用（即，您要么需要线程化它 - arg - 要么它只会导致各种阻塞问题）。

我也想与 STOMP 的人取得联系并将其列在网站上，但无法找到联系方式 - 这里有人知道最好的方法吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T01:33:45.350

[对于非 Java 程序员来说，Stomp 消息传递](http://www.martynov.org/2009/03/stomp-messaging-for-non-java.html)可能会有所帮助。

# xml - 如何使用 XSLT 删除重复的 XML 节点

> ID：355691
> 
> 赞同：3
> 
> 时间：2008-12-10T11:00:07.470
> 
> 标签：xml, xslt

我有一个非常长的 XML 文件，比如

```
<Root>
   <ele1>
      <child1>context1</child1>
      <child2>test1</child2>
      <child1>context1</child1>
   </ele1>

   <ele2>
      <child1>context2</child1>
      <child2>test2</child2>
      <child1>context2</child1>
   </ele2>
   <ele3>...........<elen>
</Root> 
```

现在我想使用 xslt删除`<child1>`每个中的所有第二个，这可能吗？`<ele>`结果将是这样的：

```
<Root>
   <ele1>
      <child1>context1</child1>
      <child2>test1</child2>
   </ele1>

   <ele2>
      <child1>context2</child1>
      <child2>test2</child2>
   </ele2>
       <ele3>...........<elen>
</Root> 
```

谢谢你，BR

艾伦

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T02:50:32.323

**这个问题需要更详细的答案**，而不仅仅是指向一个好的[**Muenchian Grouping**](http://dpawson.co.uk/xsl/sect2/N4486.html#d6060e85)来源。

原因是**所需的分组需要识别“ele[SomeString]”元素的所有子元素及其父元素的名称**。[**这种分组**](http://dpawson.co.uk/xsl/sect2/N4486.html#d6060e238)需要定义一个由两个唯一源唯一定义的键，通常通过串联。

**这种转变**：

```
<xsl:stylesheet 版本="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:key name="kElByName" 匹配="*"
      use="concat(generate-id(..), '+',name())"/>

    <xsl:template match="node()|@*">
      <xsl:复制>
        <xsl:apply-templates select="node()|@*"/>
      </xsl:copy>
    </xsl:模板>

    <xsl:template match="*[starts-with(name(), 'ele')]">
      <xsl:复制>
        <xsl:copy-of select="@*"/>
        <xsl:应用模板选择=
         "*[生成-id()
           =
            生成ID（键（'kElByName'，
                        连接（生成 ID（..），'+'，名称（））
                        )[1])
            ]"
         />
      </xsl:copy>
    </xsl:模板>
</xsl:样式表>

```

**应用于此 XML 文档时**：

```
<根>
    <ele1>
        <child1>上下文1</child1>
        <child2>测试1</child2>
        <child1>上下文1</child1>
    </ele1>
    <ele2>
        <child1>上下文2</child1>
        <child2>test2</child2>
        <child1>上下文2</child1>
    </ele2>
    <ele3>
        <child2>上下文2</child2>
        <child2>test2</child2>
        <child1>上下文1</child1>
    </ele3>
</根>

```

**产生想要的结果**：

```
<根>
    <ele1>
        <child1>上下文1</child1>
        <child2>测试1</child2>
    </ele1>
    <ele2>
        <child1>上下文2</child1>
        <child2>test2</child2>
    </ele2>
    <ele3>
        <child2>上下文2</child2>
        <child1>上下文1</child1>
    </ele3>
</根>

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T02:23:51.073

如果 OP 提供的 XML 代表他/她的问题（并且每个元素中的*第二个* 应该被删除），那么 Muenchian Grouping 就不是必需的：`<child1>``<ele*>`

**XSLT：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output omit-xml-declaration="no" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <!-- Identity Template: copies everything as-is -->
  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <!-- Remove the 2nd <child1> element from each <ele*> element -->
  <xsl:template match="*[starts-with(name(), 'ele')]/child1[2]" />

</xsl:stylesheet> 
```

**针对提供的 XML 运行时：**

```
<?xml version="1.0" encoding="UTF-8"?>
<Root>
  <ele1>
    <child1>context1</child1>
    <child2>test1</child2>
    <child1>context1</child1>
  </ele1>
  <ele2>
    <child1>context2</child1>
    <child2>test2</child2>
    <child1>context2</child1>
  </ele2>
</Root> 
```

**...产生了预期的结果：**

```
<?xml version="1.0" encoding="UTF-8"?>
<Root>
  <ele1>
    <child1>context1</child1>
    <child2>test1</child2>
  </ele1>
  <ele2>
    <child1>context2</child1>
    <child2>test2</child2>
  </ele2>
</Root> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-10T11:07:24.647

您的 xml 和问题有点不清楚，但您正在寻找的通常称为[Muenchian 分组](http://www.jenitennison.com/xslt/grouping/muenchian.html)方法 - 这是另一种要求不同节点的方法。使用适当的键，这可以非常有效地完成。

# c# - 加载服务的 exe 不能“System.Diagnostics.Process.Start”一个 URL？

> ID：355697
> 
> 赞同：2
> 
> 时间：2008-12-10T11:02:26.153
> 
> 标签：c#, windows-services, system-tray

我有一个简单的托盘图标程序，可以使用

```
System.Diagnostics.Process.Start("URL") 
```

它可以独立工作，但是当服务加载它时，它会在尝试打开 URL 时给出一个找不到文件的异常，并且经过测试它可以打开正常的扩展，例如`.txt`（该服务已启用桌面交互）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T11:45:49.530

[如果您 Process.Start 一个 URL，它正在加载一个浏览器应用程序，该应用程序不会（对于 Vista/etc）显示服务（与您上一个问题](https://stackoverflow.com/questions/355579)的原因相同）。

如果您希望应用程序与用户/桌面交互，它不应该是服务 - 它应该在用户登录时运行。请注意，您的服务产生的任何子进程*也*将在服务的会话中。

如果您只想从站点获取数据（通过代码），请使用`WebClient`etc.

# java - JSF中每条记录多行？

> ID：355699
> 
> 赞同：1
> 
> 时间：2008-12-10T11:02:59.133
> 
> 标签：java, jsf, datatable

有一个 myfaces 数据表，每条记录可以有 2**行吗？**我的简单单行表如下所示：

```
<h:dataTable id="somelist" value="#{MyBean.somelist}" var="item">
    <h:column>
        <f:facet name="header">
            <h:outputText value="ID"/>
        </f:facet>
        <h:outputText value="#{item.id}"/>
    </h:column>
</h:dataTable> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T14:57:11.577

是的，在这种情况下。您可以通过自定义[DataModel](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/model/DataModel.html)控制绑定到*outputText*的值。

```
public class TwoRowModel extends DataModel {

    private List<Pair> values = initData();
    private int index = -1;

    private List<Pair> initData() {
        List<Pair> list = new ArrayList<Pair>();
        for (int i = 0; i < 5; i++) {
            Pair pair = new Pair();
            pair.key = "Key " + i;
            pair.value = "Value " + i;
            list.add(pair);
        }
        return list;
    }

    @Override
    public int getRowCount() {
        return values.size() * 2;
    }

    @Override
    public Object getRowData() {
        Pair pair = values.get(index / 2);
        if (index % 2 == 0) {
            return pair.key;
        } else {
            return pair.value;
        }
    }

    @Override
    public int getRowIndex() {
        return index;
    }

    @Override
    public Object getWrappedData() {
        throw new UnsupportedOperationException("Demo code");
    }

    @Override
    public boolean isRowAvailable() {
        int realIndex = index / 2;
        if (realIndex < 0) {
            return false;
        }
        if (realIndex >= values.size()) {
            return false;
        }
        return true;
    }

    @Override
    public void setRowIndex(int idx) {
        this.index = idx;
    }

    @Override
    public void setWrappedData(Object value) {
        throw new UnsupportedOperationException("Demo code");
    }

    class Pair {
        public String key;
        public String value;
    }

} 
```

在此演示代码中，返回的值就是要显示的值：

```
 <h:dataTable id="somelist" value="#{twoRowModel}" var="item">
        <h:column>
            <f:facet name="header">
                <h:outputText value="ID" />
            </f:facet>
            <h:outputText value="#{item}" />
        </h:column>
    </h:dataTable> 
```

# c# - ASP.NET MVC 公共替代 UrlHelper.GenerateUrl

> ID：355700
> 
> 赞同：13
> 
> 时间：2008-12-10T11:03:11.363
> 
> 标签：c#, asp.net-mvc

我想在我的页面中嵌入一个指向控制器操作的链接，以便我可以从 javascript 中使用它。就像是

```
var pollAction = '/Mycontroller/CheckStatus' 
```

现在我很乐意对其进行硬编码，但如果有一种方法可以用来创建 URL，那就太好了。AjaxHelper/HtmlExtensions 包含创建超链接的方法（.ActionLink(...) 等），但如果您深入了解它们，它们依赖于一个名为 UrlHelper.GenerateUrl() 的方法来解析控制器和动作到一个网址。这是内部的，所以我真的无法理解。

有人在框架中找到了一个很好的方法来做到这一点吗？还是我必须自己动手？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-10T11:21:53.853

你有没有尝试过这些方面的东西？

```
var pollAction = '<%=Url.Action("CheckStatus", "MyController") %>'; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-10T11:54:56.173

如果您的页面或控件继承自`ViewPage`or `ViewUserControl`，请使用该`Url.Action`方法。

如果没有，请改用它：

```
 String url = RouteTable.Routes.GetVirtualPath
              (
                ((MvcHandler) HttpContext.Current.CurrentHandler).RequestContext,
                new RouteValueDictionary
                (
                  new 
                  { 
                    controller = "MyController", 
                    action = "CheckState", 
                    id = idParameter 
                  }
                )
              ).VirtualPath; 
```

将它放在代码隐藏的方法中，然后从 HTML 视图中调用它。

# regex - 匹配 ssh 连接字符串的正则表达式

> ID：355723
> 
> 赞同：3
> 
> 时间：2008-12-10T11:14:31.277
> 
> 标签：regex, ssh

我徒劳地尝试编写一个正则表达式来匹配有效的 ssh 连接字符串。

我真的只需要识别格式的字符串：

*   用户@主机名：/一些/路径

但最好也匹配一个隐式主目录：

*   用户@主机名：

到目前为止，我已经想出了这个正则表达式：

```
/^[:alnum:]+\@\:(\/[:alnum:]+)*$/ 
```

这不能按预期工作。

在我的大脑爆炸之前，欢迎提出任何建议，我开始大声说话:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T11:26:12.127

您提供的正则表达式没有主机名部分。尝试：

```
/^[:alnum:]+\@[:alnum:\.]\:(\/[:alnum:]+)*$/ 
```

或者

```
/^[A-Za-z][A-Za-z0-9_]*\@[A-Za-z][A-Za-z0-9_\.]*\:(\/[A-Za-z][A-Za-z0-9_]*)*$/ 
```

因为我不相信没有双括号的 alnum 。

此外， :alnum: 可能不会为您的部分提供所需的范围。你可以有 ”。” 主机名中的字符，并且可能还需要允许使用“_”字符。我很少看到用户名或主机名以非字母开头。

顺便说一句，我尽量避免使用增强的正则表达式，因为它们不能在所有正则表达式引擎上运行（我已经使用 UNIX**很长时间**了）。不幸的是，这使我的正则表达式变得笨拙（见上文）并且没有过度国际化。对此表示歉意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T11:24:38.963

括号表达式放在自己的括号内。您正在匹配冒号、“a”、“l”、“m”、“n”或“u”中的任何一个。

就像 Pax 说的，你错过了主机名。但是括号表达式仍然是错误的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T11:28:02.967

sgm 在做什么，你在做什么

```
/^[:alnum:]+\@\:(\/[:alnum:]+)*$/ 
```

你应该在哪里做

```
/^[[:alnum:]]+\@\:(\/[[:alnum:]]+)*$/ 
```

Pax 的答案也很实用，但如果没有适当的双括号，它将无法工作。

```
my $at  = q{@};
my @res = (
    qr/^[:alnum:]+${at}[:alnum:]+:(\/[:alnum:]+)*$/,
    qr/^[[:alnum:]]+${at}[[:alnum:]]+:(\/[[:alnum:]]+)*$/,
    qr/^[a-z][[:alnum:]_]*${at}[a-z][[:alnum:]_.]*:(\/[^\/]*)*$/i,
);

my @u = qw{
  user@hostname:/some/path
  bob_foo@bobs.fish.stores.com:/foo/bar/baz/quux_
  9foo@9foo.org:/9foo/9foo
  baz@foo.org:/9foo/_#_numerics_are_fine_in_URI_and_so_is_anything_else_(virtually)
};

for my $str (@u) {
    for my $re (@res) {
        if ( $str =~ $re ) {
            print "$str =~ $re\n";
        }
        else {
            print "NOT $str =~ $re\n";
        }
    }
} 
```

```
POSIX syntax [: :] belongs inside character classes in regex; marked by <-- HERE in m/^[:alnum:] <-- HERE +@[:alnum:]+:(/[:alnum:]+)*$/ at /tmp/egl.pl line 27.
POSIX syntax [: :] belongs inside character classes in regex; marked by <-- HERE in m/^[:alnum:]+@[:alnum:] <-- HERE +:(/[:alnum:]+)*$/ at /tmp/egl.pl line 27.
POSIX syntax [: :] belongs inside character classes in regex; marked by <-- HERE in m/^[:alnum:]+@[:alnum:]+:(/[:alnum:] <-- HERE +)*$/ at /tmp/egl.pl line 27.
NOT user@hostname:/some/path =~ (?-xism:^[:alnum:]+@[:alnum:]+:(/[:alnum:]+)*$)
user@hostname:/some/path =~ (?-xism:^[[:alnum:]]+@[[:alnum:]]+:(/[[:alnum:]]+)*$)
user@hostname:/some/path =~ (?i-xsm:^[a-z][[:alnum:]_]*@[a-z][[:alnum:]_.]*:(/[^/]*)*$)
NOT bob_foo@bobs.fish.stores.com:/foo/bar/baz/quux_ =~ (?-xism:^[:alnum:]+@[:alnum:]+:(/[:alnum:]+)*$)
NOT bob_foo@bobs.fish.stores.com:/foo/bar/baz/quux_ =~ (?-xism:^[[:alnum:]]+@[[:alnum:]]+:(/[[:alnum:]]+)*$)
bob_foo@bobs.fish.stores.com:/foo/bar/baz/quux_ =~ (?i-xsm:^[a-z][[:alnum:]_]*@[a-z][[:alnum:]_.]*:(/[^/]*)*$)
NOT 9foo@9foo.org:/9foo/9foo =~ (?-xism:^[:alnum:]+@[:alnum:]+:(/[:alnum:]+)*$)
NOT 9foo@9foo.org:/9foo/9foo =~ (?-xism:^[[:alnum:]]+@[[:alnum:]]+:(/[[:alnum:]]+)*$)
NOT 9foo@9foo.org:/9foo/9foo =~ (?i-xsm:^[a-z][[:alnum:]_]*@[a-z][[:alnum:]_.]*:(/[^/]*)*$)
NOT baz@foo.org:/9foo/_#_numerics_are_fine_in_URI_and_so_is_anything_else_(virtually) =~ (?-xism:^[:alnum:]+@[:alnum:]+:(/[:alnum:]+)*$)
NOT baz@foo.org:/9foo/_#_numerics_are_fine_in_URI_and_so_is_anything_else_(virtually) =~ (?-xism:^[[:alnum:]]+@[[:alnum:]]+:(/[[:alnum:]]+)*$)
baz@foo.org:/9foo/_#_numerics_are_fine_in_URI_and_so_is_anything_else_(virtually) =~ (?i-xsm:^[a-z][[:alnum:]_]*@[a-z][[:alnum:]_.]*:(/[^/]*)*$) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T14:48:54.043

最后走：

```
/^\w+\@(\w|\.)+\:(\/(\w|.)+\/?)*$/ 
```

这也允许一个可选的尾部斜杠。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T11:44:50.873

经过一些修改后，我正在使用：

```
/^\w+\@(\w|\.)+\:(\/\w+)*$/ 
```

这似乎与我的测试用例和主机部分中的主机名、FQDN 和 IP 地址相匹配。它还使冒号后的路径可选，以允许隐式主目录。

感谢您到目前为止的帮助 - 在被指出之前，我没有发现缺少主机名。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T12:06:02.203

好的，进一步修改为：

```
/^\w+\@(\w|\.)+\:(\/(\w|.)+)*$/ 
```

占。可能存在于文件名中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-27T19:56:53.627

这些并不能满足*我*的需要。因为有些破产或不够自由。例如，如果您有一个名为`stackoverflow.com`没有点的文件夹会破坏它。实现的`\w`含义不一致，所以我不建议使用它，特别是因为我们非常清楚我们需要什么字符。

以下是构造正则表达式的 bash 示例：

```
#should match 99.9% of SSH users
user_regex='[a-zA-Z][a-zA-Z0-9_]+'
#match domains
host_regex='([a-zA-Z][a-zA-Z0-9\-]*\.)*[a-zA-Z][a-zA-Z0-9\-]*'
#match paths starting with / and empty strings (which is valid for our use!)
path_regex='(\/[A-Za-z0-9_\-\.]+)*\/?'
#the complete regex
master_regex="^$user_regex\@$host_regex\:$path_regex\$" 
```

如果需要，这提供了以后检查零件的模块化。要在匹配中启用 IP 地址，请添加`0-9`主机正则表达式的两个首字母匹配部分。

# c# - 在 Windows 窗体中嵌入 DOS 控制台

> ID：355724
> 
> 赞同：17
> 
> 时间：2008-12-10T11:14:34.770
> 
> 标签：c#, winforms, c#-2.0, dos

是否可以在 C# 2.0 中的 Windows 窗体或用户控件中嵌入 DOS 控制台？

我们有一个遗留 DOS 产品，我的 Windows 应用程序必须与之交互，并且要求遗留产品的一个实例应该在 Windows 应用程序中运行。

目前，我正在使用 user32.dll 来定位运行 DOS 产品的窗口，将窗口最小化然后最大化，然后在窗口中输入字符。这不是一个很好的解决问题的方法，因为这意味着我的应用程序必须在应用程序设置中存储窗口名称，并要求用户在使用交互功能之前返回到 DOS 应用程序的正确页面。

编辑：更多信息

旧版应用程序需要对用户可见，而不是在单独的窗口中。

我已经尝试了 TimothyP 的答案，它工作得很好，但是是否有可能实现相同的功能，但是 DOS 窗口可视地嵌入在 Windows 窗体或用户控件中，而不是在它自己的窗口中弹出？最好以 ShowDialog() 方式，这样用户就无法在他们处于“传统模式”时与应用程序交互，可以这么说。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-10T11:26:11.237

可以使用 Process 类重定向控制台/dos 应用程序的标准输入/输出。它可能看起来像这样：

```
var processStartInfo = new ProcessStartInfo("someoldapp.exe", "-p someparameters");

processStartInfo.UseShellExecute = false;
processStartInfo.ErrorDialog = false;

processStartInfo.RedirectStandardError = true;
processStartInfo.RedirectStandardInput = true;
processStartInfo.RedirectStandardOutput = true;
processStartInfo.CreateNoWindow = true;

Process process = new Process();
process.StartInfo = processStartInfo;
bool processStarted = process.Start();

StreamWriter inputWriter = process.StandardInput;
StreamReader outputReader = process.StandardOutput;
StreamReader errorReader = process.StandardError;
process.WaitForExit(); 
```

您现在可以使用流与应用程序交互。通过将 processStartInfo.CreateNoWindow 设置为 true，原始应用程序将被隐藏。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T13:16:19.563

关于如何在 Windows 应用程序中显示 DOS 应用程序的问题。

有几个解决方案。

*   第一个是简单地不显示 DOS 应用程序（使用 CreateNoWindow）并通过读取和写入流来“模拟”Windows 应用程序中 DOS 应用程序的 UI。

*   另一种解决方案是使用 Win32API，获取控制台/DOS 应用程序窗口的 Windows 句柄 (Whnd)，并将其父级设置为您的表单。我目前不在家，自从我这样做以来已经很久了，我不记得它是如何完成的。如果我没记错的话，您需要使用以下 Win32 API 调用：

    *   [查找窗口](http://www.pinvoke.net/default.aspx/user32/FindWindow.html)
    *   [获取窗口](http://www.pinvoke.net/default.aspx/user32/GetWindow.html)
    *   [设置父级](http://www.pinvoke.net/default.aspx/user32/SetParent.html)

如果我今天晚些时候还有时间，我会看看能不能找到更好的样品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T11:24:46.903

您可以使用 CreateProcess 函数和 STARTUPINFO 参数的 hStdInput、Output 和 Error 成员，这将允许您拦截应用程序的标准输入和输出。

# wpf - 如何将 Powershell 窗口嵌入到另一个 wpf 窗口或 windows 窗体中？

> ID：355727
> 
> 赞同：1
> 
> 时间：2008-12-10T11:16:07.297
> 
> 标签：wpf

是否可以将 powershell 应用程序嵌入到另一个 wpf 窗口或 windows 窗体中？

甚至是 DOS propmpt shell？

马尔科姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T08:16:38.967

看看：[http ://code.msdn.microsoft.com/PowerShellTunnel](http://code.msdn.microsoft.com/PowerShellTunnel)

# c# - 将类实例存储到文件/数据库的最佳方式

> ID：355730
> 
> 赞同：2
> 
> 时间：2008-12-10T11:19:07.680
> 
> 标签：c#, .net, serialization, persistence, object-oriented-database

将类的实例存储到文件/数据库的最佳方法是什么？

我们有一个名为 Command 的基类和大量派生类。用户通过向图形设计器添加命令来配置这些类的实例。（设置属性）。

然后我们需要一种方法将这些“命令”存储到文件中而不会丢失任何信息。

一个想法是使用 db4o，但 GPL 许可对于这个项目是不可接受的。

任何建议或代码示例？

更新：

（为了“去模糊”我的问题：p）

生成的代码可能类似于：

```
 command[i++] = new DelayInSecondsCommand(2);
    command[i++] = new DaliRequestCommand(1, false, 254);
    command[i++] = new DaliRequestCommand(2, false, 254);
    command[i++] = new DaliRequestCommand(3, false, 254);
    command[i++] = new WaitInSecondsCommand(2);             
    command[i++] = new DaliRequestCommand(1, false, 0);
    command[i++] = new DaliRequestCommand(2, false, 0);
    command[i++] = new DaliRequestCommand(3, false, 0);
    command[i++] = new JumpCommand(0); 
```

但随后有大量不同的命令。

我知道 .NET 序列化是可能的，虽然我以前从未使用过它，但我想知道是否有更好的选择，就像我说的 db4o 看起来不错但许可证不适合项目。

更新 2：

感谢您的答复。我现在可能会使用序列化解决方案，但我也会研究其他选项。FYI 数据存储在 SQL Compact 数据库中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T12:03:28.543

您是否尝试将数据保存在表格中？还是作为 blob/clob 数据？既然你提到了文件，我假设后者：任何标准的 .NET 序列化程序都应该没问题——它们都支持继承等。我会考虑 for `DataContractSerializer`，因为它结合了字段级支持（如`BinaryFormatter`）和程序集独立性的`XmlSerializer`。

您还可以考虑更深奥的东西，例如[protobuf-net](http://code.google.com/p/protobuf-net/)。

那么：您需要做什么才能在标准序列化程序下不起作用？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T11:52:07.927

序列化可以解决问题！序列化无非是将对象或对象的连接图转换为字节流（以保持对象的当前状态）。这可以是二进制流、XML 或其他。您不必自己进行此转换，因为 .Net 对序列化有很好的支持。序列化对象后，您可以自由地将这些数据存储到文件或数据库中。同样，表示序列化对象的字节流可以反序列化为与原始对象具有相同状态的对象。

顺便说一句：一旦你有一个序列化的字节流，你可以在它上面应用更多的功能，例如压缩或加密。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T11:26:39.130

相当模糊的问题，为什么不直接使用.NET 的内置序列化可能性（例如XmlSerializer）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T11:42:57.070

有[http://www.neodatis.org](http://www.neodatis.org)。它的 LGPL，但我使用的时间只有 Java 的实现。现在，有一个 C# 的“测试版”版本，但我没有测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-10T11:45:32.087

db40 还提供商业许可证，但它最近已被 versant 购买，因此您可能想看看。这种数据库被称为面向对象的数据库，是一种创建类的持久实例的方法，这与使用表工作的关系数据库非常不同。

[这个](http://en.wikipedia.org/wiki/ODBMS)（wikpedia.org）是面向对象数据库的好读物，[这个](http://en.wikipedia.org/wiki/List_of_object-oriented_database_management_systems)（也是维基百科）是一些可用选项的列表。

在我看来，对象数据库比关系数据库更好更强大，如果我真的需要（不是经常），我只会使用像 mysql 这样的关系数据库。

我建议您观看[这些视频](http://www.versant.com/developer/resources/objectdatabase/screencast)并下载试用版。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-10T11:59:43.683

序列化是存储此类数据的好方法。见[http://blog.paranoidferret.com/index.php/2008/06/20/csharp-tutorial-xml-serialization/](http://blog.paranoidferret.com/index.php/2008/06/20/csharp-tutorial-xml-serialization/)

# java - 使用子类化替换没有实现接口的 Java 类

> ID：355732
> 
> 赞同：3
> 
> 时间：2008-12-10T11:19:15.697
> 
> 标签：java, file, delegates, subclass

例如，java.io.File 只是一个具体的类。我的替代品支持解析 Windows 快捷方式。我需要预处理构造函数参数以解析可能的 .lnk 文件，因为无法访问在抽象路径上执行规范化/规范化/解析的 FileSystem 对象。预处理的需要排除了纯子类化 - 在调用 super(...) 之前不能进行预处理，并且 File 是不可变的。所以我扩展了 File 并使用了一个委托，覆盖了 File 的所有构造函数和方法（在所有构造函数中调用 super("")）。

这很好用，但显然并不理想——如果 File 发生变化，我将不会覆盖任何新方法或构造函数，这将暴露底层的空抽象路径名。我错过了一些明显的东西吗？似乎应该有一个更简单/更好的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-10T11:23:53.240

在您建议的特定情况下，在我看来，您最好使用一个单独的工厂类来做出有关规范化/规范化/解析的决定。

然后你可以让 File 成为 File。更简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-10T11:28:18.770

`super()`如果您真的想要子类路由，您可以通过将清理代码放在类之外或静态块中来欺骗调用必须是子类构造函数的第一行的要求：

```
public class MyFile extends File {

    public MyFile(String path) {

        // static blocks aren't ideal, this is just for demo purposes:
        super(cleanPath(path)); 
    }

    private static String cleanPath(String uncleanPath) {...}

} 
```

krosenvold 建议的工厂模式是另一个很好的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T11:32:25.187

> 这很好用，但显然并不理想——如果 File 发生变化，我将不会覆盖任何新方法或构造函数，这将暴露底层的空抽象路径名。我错过了一些明显的东西吗？

不，您已经发现了使用继承的问题——子类与超类及其内部紧密耦合，因此它可能很脆弱。这就是为什么 Effective Java 和其他人说如果可能的话，你应该在继承之前支持委托。

我认为 krosenvold 的解决方案听起来很干净。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T11:36:01.170

在我看来，krosenvold 的解决方案是可行的方法。

但是，如果您需要记录创建文件的原始路径，您可以实现一个包装类。

```
public class FileWrapper {

    private File file;
    private String path;

    private FileWrapper(String path) {
        this.path = path;
        file = new File(preProcess(path));
    }

    private String preProcess(String path) {
        // process
        return path;
    }

    public File getFile() {
        return file;
    }

    public String getPath() {
        return path;
    }
} 
```

# windows - Apache 轮换访问和错误日 志 Windows

> ID：355737
> 
> 赞同：9
> 
> 时间：2008-12-10T11:22:29.873
> 
> 标签：windows, apache, logging, logrotate

如何在 Window 2000 机器上轮换 Apache 访问和错误日​​志？

我在下面包含我的批处理文件作为答案。

有没有办法直接通过 Apache 配置文件做到这一点？我目前正在使用以下 customlog 命令来生成每日日志。

CustomLog '|" "*Apache-Path/bin/rotatelogs.exe" "*Apache-Path/logs/backup/internet_access_%d-%m-%y.log" 86400' 组合

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T12:08:42.540

这是DOS批处理文件，已按注释进行修改。我每周运行一次，它会保存 8 周的压缩备份。您需要安装 7 zip。

我没有参数化路径，随意。

* * *

```
@echo off

:: Name - svrlogmng.bat
:: Description - Server Log File Manager
::
:: History
:: Date         Authory    Change
:: 22-May-2005  AGButler   Original
:: 14-Jan-2008  AIMackenzie Changed net stops and paths where necessary

:: ========================================================
:: setup variables and parameters
:: ========================================================

:: generate date and time variables
for /f "tokens=2,3,4 delims=/ " %%i in ('date /T') do set trdt=%%k%%j%%i
for /f "tokens=1,2 delims=: " %%i in ('time /T') do set trtt=%%i%%j
set nftu=%trdt%%trtt%

:: set the Number Of Archives To Keep
set /a noatk=8

:: ========================================================
:: turn over log files
:: ========================================================

:: change to the apache log file directory
cd /D "D:\Program Files\Apache Software Foundation\Apache2.2\logs\"

:: stop Apache Service, Move log files and restart Apache Service
"D:\Program Files\Apache Software Foundation\Apache2.2\bin\httpd.exe" -k stop

echo %nftu% >> access.log
move "D:\Program Files\Apache Software Foundation\Apache2.2\logs\access.log" "D:\Program Files\Apache Software Foundation\Apache2.2\logs\%nftu%_access.log"

echo %nftu% >> error.log
move "D:\Program Files\Apache Software Foundation\Apache2.2\logs\error.log" "D:\Program Files\Apache Software Foundation\Apache2.2\logs\%nftu%_error.log"

"D:\Program Files\Apache Software Foundation\Apache2.2\bin\httpd.exe" -k start

:: ========================================================
:: zip todays Access and Error log files, then delete old logs
:: ========================================================

:: zip the files
"D:\Program Files\7-Zip\7z.exe" a -tzip %nftu%_logs.zip %nftu%_access.log %nftu%_error.log

:: del the files
del /Q %nftu%_*.log

:: ========================================================
:: rotate the zip files
:: ========================================================

:: make list of archive zip files
type NUL > arclist.dat
for /F "tokens=1,2 delims=[] " %%i in ('dir /B *_logs.zip ^| find /N "_logs.zip"') do echo  %%i = %%j>> arclist.dat

:: count total number of files
for /F "tokens=1 delims=" %%i in ('type arclist.dat ^| find /C "_logs.zip"') do set tnof=%%i

:: setup for and create the deletion list
set /a negtk=%noatk%*-1
set /a tntd=%tnof% - %noatk%

type NUL>dellist.dat
for /L %%i in (%negtk%,1,%tntd%) do find " %%i = " arclist.dat >> dellist.dat

:: del the old files
for /F "tokens=3 delims= " %%i in ('find "_logs.zip" dellist.dat') do del /Q %%i

:: remove temp files
del /Q arclist.dat
del /Q dellist.dat 
```

* * *

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-17T17:16:19.353

我稍微扩展了 bat 脚本。您可以将其用于英语和德语日期。您将需要 7za.exe 位于与脚本相同的目录中。用于轮换的 log-dir 和 -files 是可显式设置的。

```
@echo off
SETLOCAL ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION
:: ========================================================
:: setup variables and parameters
:: ========================================================

:: USE Service Display Name, Services are space-separated -> Syntax: "Display Name 1" "Display Name 2"
SET ROTATE_SERVICES="Apache2.2"

:: setting LOG-directory, log-files in this directory should be rotate
SET ROTATE_LOGDIR=F:\xampp\apache\logs

:: files which should rotate (space separated)
SET ROTATE_FILES=access.log error.log ssl_request.log

:: SET the Number Of Archives To Keep
SET /a keptarchives=5

:: SET delimiter for date format (english "/", german ".")
SET DATEDEL=.
:: ========================================================
:: DO NOT CHANGE ANYTHING
:: ========================================================

:: Check for existing Log-directory
IF NOT EXIST "%ROTATE_LOGDIR%" (
    CALL :LOG Please check your paths to Log Directory
    PAUSE
    GOTO :EOF
)

:: Check for existing Log-files
FOR %%d IN (%ROTATE_FILES%) DO (
    IF NOT EXIST "%ROTATE_LOGDIR%\%%d" (
        CALL :LOG File %ROTATE_LOGDIR%\%ROTATE_LOGFILES% does not exist!
        PAUSE
        GOTO :EOF
    )
)

:: generate date and time variables for execution
FOR /f "tokens=1,2,3 delims=%DATEDEL% " %%i IN ('date /T') DO SET execdate=%%k%%j%%i
FOR /f "tokens=1,2 delims=: " %%i IN ('time /T') DO SET exectime=%%i%%j
SET fullexectime=%execdate%_%exectime%
:: ========================================================

:: ========================================================
:: Operations
:: ========================================================

FOR %%d IN (%ROTATE_SERVICES%) DO (
    NET STOP %%d
)

FOR %%d IN (%ROTATE_FILES%) DO (
    cd /d %ROTATE_LOGDIR%
    IF NOT EXIST OLD (MKDIR OLD) 
    move %%d %ROTATE_LOGDIR%\OLD\%fullexectime%_%%d
)

FOR %%d IN (%ROTATE_SERVICES%) DO (
    NET START %%d
)

:: ========================================================
:: ZIP - LOGFILES
:: ========================================================
cd /d %ROTATE_LOGDIR%\OLD
CALL "%~dp0\7za.exe" a %ROTATE_LOGDIR%\OLD\%fullexectime%_log.zip %ROTATE_LOGDIR%\OLD\%fullexectime%_*.log
    IF %ERRORLEVEL% NEQ 0 (
        CALL :LOG Error while compressing log-file. Log will not deleted and not rotated. Check your OLD-directory!
        PAUSE
        GOTO :EOF
    )
del /Q %fullexectime%_*.log

:: ========================================================
:: ROTATE - ZIPPED LOGFILES
:: ========================================================

:: make list of archive zip files
type NUL > arclist.dat
for /F "tokens=1,2 delims=[] " %%i in ('dir /B *_log.zip ^| find /N "_log.zip"') do echo  %%i = %%j>> arclist.dat

:: count total number of files
for /F "tokens=1 delims=" %%i in ('type arclist.dat ^| find /C "_log.zip"') do set tnof=%%i

:: setup for and create the deletion list
set /a negtk=%keptarchives%*-1
set /a tntd=%tnof% - %keptarchives%

type NUL>dellist.dat
for /L %%i in (%negtk%,1,%tntd%) do find " %%i = " arclist.dat >> dellist.dat

:: del the old files
for /F "tokens=3 delims= " %%i in ('find "_log.zip" dellist.dat') do del /Q %%i

:: remove temp files
del /Q arclist.dat
del /Q dellist.dat

GOTO :EOF

:LOG
    SET MSG=[%DATE%, %TIME: =0%] %*
    ECHO.%MSG%
    SET MSG=
    GOTO :EOF
pause 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T12:45:41.750

我曾经为一个 Windows 2003 机器写过一个 vbs。它使用 zip.exe 进行压缩（可在 info-zip.org 找到）并旋转 apache 日志和 php 日志。日志在大于 MAX_SIZE 时旋转。如果日志计数超过 MAX_ROTATIONS，它将删除最旧的日志。

请提供有关脚本的反馈。

```
option explicit

const DEBUG_MODE = false
const MAX_ROTATIONS = 10
const MAX_SIZE = 2097152  ' 2MB
const WEB_LOGS = "c:\path\to\site\logs"
const PHP_LOG = "c:\path\to\phplog"
const APACHE_LOGS = "C:\path\to\Apache2\logs"
const APACHE_SERVICE ="Apache2.2" ' Name of the apache service for restart
const ZIP_APP = "c:\path\to\zip.exe"
const LOGROTATE_LOG = "c:\tmp\logrotate.log"

dim aLogs
aLogs = Array("\error.log","\transfer.log","\sec.log","\phperror.log") 

dim oFSO
set oFSO = CreateObject("Scripting.FileSystemObject")

if (not DEBUG_MODE) then
  dim oLogFile
  set oLogFile = oFSO.CreateTextFile(LOGROTATE_LOG, 2, True)
end if

dim bHasRotated
bHasRotated = false

Print "Starting log rotation"
Print "====================="
ManageWebLogs()
ManageApacheLogs()
ManagePhpLog()

if (bHasRotated = true) then
  Print "====================="
  RestartService APACHE_SERVICE
end if

Print "====================="
Print "Log rotation finished"

if (not DEBUG_MODE) then
  oLogFile.Close
  set oLogFile = nothing
end if
set oFSO = nothing

'*****************************************************************************
' Loop through all the subfolders in the weblog directory
sub ManageWebLogs()
  dim oLogDirs
  set oLogDirs = oFSO.GetFolder(WEB_LOGS)
  dim oLogDir
  for each oLogDir in oLogDirs.SubFolders
      Print "In " & oLogDir.Name
      RotateLogs(oLogDir)
  next 
  set oLogDir = nothing
end sub

'*****************************************************************************
' Loop through the log files in the Apache logs directory
sub ManageApacheLogs()
  dim oLogDir
  set oLogDir = oFSO.GetFolder(APACHE_LOGS)
  Print "In " & oLogDir.Name
  RotateLogs(oLogDir)
  set oLogDir = nothing
end sub

'*****************************************************************************
' Loop through the log files in the Apache logs directory
sub ManagePhpLog()
  dim oLogDir
  set oLogDir = oFSO.GetFolder(PHP_LOG)
  Print "In " & oLogDir.Name
  RotateLogs(oLogDir)
  set oLogDir = nothing
end sub

'*****************************************************************************
' Traverse through each of the log file types and check if they need rotation
sub RotateLogs(ByVal oFolder)
  dim sLog
  dim oLog
  for each sLog in aLogs
    if oFSO.FileExists(oFolder.Path & sLog) then
      set oLog = oFSO.GetFile(oFolder.Path & sLog)
      if (oLog.Size > MAX_SIZE) then
        RotateLog oFolder.Path & sLog
        ArchiveLog oFolder.Path & sLog
        bHasRotated = true
      end if
    end if
  next
  set oLog = nothing
end sub

'*****************************************************************************
' Rotates the given log, by incrementing the file name
sub RotateLog(ByVal sLog)
  dim i
  dim sOldFile, sNewFile
  for i = MAX_ROTATIONS to 1 step -1
    sOldFile = sLog & "." & i & ".zip"
    sNewFile = sLog & "." & (i+1) & ".zip"
    if oFSO.FileExists(sOldFile) and i = MAX_ROTATIONS then
      ' Delete zipfile        
      Print "-- Deleting " & sOldFile
      oFSO.DeleteFile(sOldFile)
    elseif oFSO.FileExists(sOldFile) then
      ' Rename zipfile
      Print "-- Renaming " & sOldFile & " to " & sNewFile
      oFSO.MoveFile sOldFile, sNewFile
    end if
  next
end sub

'*****************************************************************************
' Zips the current log
sub ArchiveLog(ByVal sLog)
  Dim oShell
  Set oShell = CreateObject("WScript.Shell")
  dim sZipFile 
  sZipFile = sLog & ".1.zip"
  Print "-- Archiving " & sLog & " to " & sZipFile
  oShell.Run "cmd /c " & ZIP_APP & " -jq " & sZipFile & " " & sLog, 0, true
  oFSO.DeleteFile(sLog)
  set oShell = nothing
end sub

' ****************************************************************************
' Restarts a given service (in our case Apache)
private sub RestartService( _
  ByVal sService _
)

  Dim oShell
  Set oShell = CreateObject("WScript.Shell")

  ' Service stopped with 'Net' command
  oShell.Run "cmd /c net stop " & sService, 0, true
  Print sService & " service stopped"

  ' Service started with 'Net' command
  oShell.Run "cmd /c net start " & sService, 0, true
  Print sService & " service restarted"

  set oShell = nothing
end sub

'*****************************************************************************
' Echoes out the given message if in debug mode
sub Print(ByVal sMsg)
  if (DEBUG_MODE) then
    wscript.echo sMsg
  else
    oLogFile.WriteLine sMsg
  end if
end sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T11:42:55.447

如前所述，我认为这不是一个严格的编程问题，但 AFAIK Apache 中没有支持日志轮换的内置功能。在 unix 系统上有一个名为 的标准实用程序`logrotate`，因此这些系统上的功能将是冗余的。

如果您改写您的问题以询问如何编写批处理文件来处理 Windows 2000 上的 Apache 日志轮换，然后用您的批处理文件源回答自己，这可能对其他人有帮助。

# database - 使用完全 REST Web 服务将数据写入数据库

> ID：355738
> 
> 赞同：3
> 
> 时间：2008-12-10T11:22:31.260
> 
> 标签：database, web-services, rest

如何创建一个 REST Web 服务来将一行写入数据库表。使用以下场景：

> 该表称为**客户**- 要插入行的数据将是姓名、地址、电话号码、电子邮件。

我认为用 Java 或 C# 端到端地描述整个事情是不可能的，我从没想过会这样，但这是我在准备编码时突然出现的问题：

*   URI 的外观如何（例如，如果您使用此 URL - [http://www.example.com/](http://www.example.com/)）？
*   什么信息会进入 HTTP 信封？
*   以这种方式写入数据库时​​，我会使用 POST 吗？
*   我是否使用资源来存储来自客户端的发布数据？如果数据正在写入数据库，这甚至是必要的吗？
*   当服务器接收到要写入数据库的数据时 - 我如何将其物理插入数据库 - 我是否调用服务器上的某些方法来实际写入数据（在 Java 中）？-*这似乎不适合真正的 REST 架构 - 回避 RPC 调用。*
*   我是否应该为写入数据库而烦恼 - 我应该将我的数据存储为资源吗？

正如你所看到的，我需要在脑海中清理一些问题。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T11:59:49.830

首先，我既不是 java 也不是 c# 专家，我不完全知道这些语言必须以什么方式支持 REST 设计，但总的来说：

1.  [http://www.example.com/customers](http://www.example.com/customers) - 客户是资源的集合，您想向该集合添加新资源

2.  这取决于各种事情 - 您可能应该设置内容类型标头（根据您发送表示的数据格式）并在需要时设置一些身份验证标头。

3.  是的，您总是使用 POST 在资源集合中创建新条目。

4.  老实说，我不完全理解这个问题。“立即将数据写入数据库”是什么意思？

5.  REST 主要只是服务器和客户端之间的一种通信方式。它没有说明您应该如何处理使用它接收到的数据。现代 Web 方法（MVC 样式框架）解决它的常用方法是将每个 REST 操作路由到某个类（通常是控制器实例）的方法，您可以在其中处理接收到的参数（例如，将它们保存到数据库中）并生成要发回的响应。

有关 REST 的非常简短和非常清晰的介绍，请查看此[短视频](http://www.youtube.com/watch?v=YCcAE2SCQ6k)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T11:39:11.023

*[由 O'Reilly and Associates 发布的RESTful Web Services](http://oreilly.com/catalog/9780596529260/#top)*似乎符合您的要求。

至于用 Java 做的，Sun[上有一个页面](http://java.sun.com/developer/technicalArticles/WebServices/restful/)。

# python - 将双端队列保存在文本文件中

> ID：355739
> 
> 赞同：3
> 
> 时间：2008-12-10T11:23:19.620
> 
> 标签：python, web-crawler

我正在用 Python 编写一个爬虫，为了使 Ctrl+C 不会导致我的爬虫在下次运行时重新开始，我需要将处理双端队列保存在一个文本文件中（每行一个项目）并在每次迭代时更新它，更新操作需要超快。为了不重新发明轮子，我问是否有一个既定的模块来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T11:29:20.390

作为替代方案，您可以设置退出函数，并在退出时腌制双端队列。

[退出函数](http://docs.python.org/library/sys.html#sys.exitfunc)
[Pickle](http://docs.python.org/library/pickle.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T11:30:32.307

您应该能够使用[pickle](http://docs.python.org/library/pickle.html)来序列化您的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T13:13:45.937

我不确定我是否理解了这个问题，我只是好奇，所以这里有几个问题和建议：

您是否打算捕获 Ctrl+C 中断并执行双端队列？如果爬虫由于某种任意原因（例如未处理的异常或崩溃）而崩溃会发生什么？您失去了队列状态并重新开始？从文档中：

> 笔记
> 
> 当程序被信号杀死、检测到 Python 致命内部错误或调用 os._exit() 时，不会调用 exit 函数。

当您碰巧再次访问相同的 URI 时会发生什么，您是在维护访问列表还是什么？

我认为您应该为您抓取的每个 URI 维护某种访问和会话信息/状态。您可以根据访问信息来决定下次访问同一个 URI 时是否抓取该 URI。与该 URI 的最后一个会话的其他信息 - 会话信息 - 将有助于仅拾取增量内容，如果页面未更改，则无需拾取它，从而节省一些 db I/O 成本、重复项等。

这样您就不必担心 ctrl+C 或崩溃。如果爬虫因任何原因出现故障，假设在爬取 60K 帖子后还剩 40K 时，下一次爬虫填充队列，虽然队列可能很大，但爬虫可以检查它是否已经访问了 URI 或不是，页面被抓取时的状态是什么 - 优化 - 页面是否需要新的拾取，因为它是否已更改。

我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T11:40:00.383

我想到的一些事情：

*   保持文件句柄打开（不要在每次写东西时关闭文件）
*   或每 n 项写入文件并捕获关闭信号以写入当前未写入的项

# ms-access - Access VBA：抑制的运行时错误

> ID：355746
> 
> 赞同：0
> 
> 时间：2008-12-10T11:24:53.783
> 
> 标签：ms-access, error-handling, vba, messagebox

在我开发我的 MS Access 应用程序时，我使用 shift click 打开它。当错误发生时，没有被捕获（由 ON ERROR ...），会弹出一个消息框，通知我该错误。这是一件好事。

当用户打开我的应用程序时，他不会移动单击，并且会打开相应的开始表单。但是，现在未捕获的错误不会显示，应用程序的行为就像用户单击消息框上的停止按钮一样。我不想要这种行为。

是否有选项/属性/变量在生产代码中提供与开发中相同的行为（最好即使应用程序 id 转换为 mde），即为每个未捕获的错误显示一个消息框？或者是否有必要在每个事件例程中捕获错误并通过程序弹出一个消息框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T16:37:40.937

事实证明，这是将 AllowSpecialKeys 属性设置为 False 的副作用。这可以通过编程方式完成，但我是在工具 > 启动下的菜单中完成的。

由于此属性允许用户打开代码编辑器，这有点道理，但描述的现象与此选项的关系让我感到困惑。

这是否意味着，如果我想隐藏我的代码，我需要编写所有这些错误处理程序？或者是否有一个可以调用错误处理程序的中心位置（如 Java 中的 main 方法）。或者，我可以允许使用特殊键并只用关键字保护代码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T22:09:17.413

您可以创建自己的错误处理程序并将其添加到所有 procs、subs 和函数中。你有这个非常好的[MZ Tools](http://www.mztools.com) VBA 插件，它允许你做很多事情，比如在你的代码中添加行号，“预编程”你的错误标签等。

如果您足够聪明，您将能够使用此插件生成标准的“错误管理”代码，显示诸如 err.number、err.description 和 undocument erl 值（即发生错误的行（您必须首先对行进行编号才能获得此值）。

编辑：我刚刚就类似的主题打开了[这个问题。](https://stackoverflow.com/questions/357822/ms-access-and-error-management)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T02:04:38.983

如前所述，MZ-Tools 3.0 是帮助快速添加错误处理程序的好工具。还要记住，在*没有*错误处理程序的过程中发生的错误会“冒泡”到最后调用的 On Error 语句。（如果不存在任何语句，您会看到灰色的小调试框。）这样做的最终效果是，您只需将错误处理程序添加到那些公共（或朋友）或由事件调用的过程中，就可以进行最少的错误处理。这将确保您始终调用至少 1 个“顶级”错误处理程序。如果您想在此之后为您的私人程序添加特殊处理，请随意。如果不是，当它们发生错误时，它们将“冒泡”到顶级错误处理程序。

# file - 如何合并/比较文件忽略顺序？

> ID：355763
> 
> 赞同：2
> 
> 时间：2008-12-10T11:30:17.830
> 
> 标签：file, merge, compare

我有两个不相同的属性文件，我需要找出不同之处。第二个文件按键排序。

有没有可以帮助我的工具？从我所见，每个合并工具都非常关心订单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T11:35:19.847

我已经在 Linux 上的 bash 中通过对两个文件进行排序然后合并它们来完成它。如果你在 Windows 上，你可以安装 Cygwin 来运行 Linux 程序。

但是，我认为最好通过创建一个小程序来为您服务，这可能比学习使用 Cygwin 花费的时间更少。

编辑：您可以将其视为一个学习新技术的小项目。我经常使用这样的项目来学习 Ruby 或 Python 之类的东西。虽然如果在工作中可能不会被接受。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T13:24:56.413

对一个或两个文件进行排序。

然后运行“差异”。

# apache-flex - 使用 WebOrb Ruby/Rails 创建 Flash 应用程序

> ID：355765
> 
> 赞同：1
> 
> 时间：2008-12-10T11:31:23.317
> 
> 标签：apache-flex, flash, weborb, remoteobject

好的，这似乎是一个愚蠢的问题（对于 Flash 开发人员），但我真的想不通。因此，我想为 Flash/Flex 应用程序创建某种 API，以便用户可以使用我的 lib 来连接到我的 WebOrb Rails 服务器。

我对导轨部分没有任何问题，但闪光部分有点困难。

因此，我从示例中看到 Flex 正在使用 RemoteObject 连接/检索数据。问题是如何创建一个从 WebOrb 连接/检索数据的 Flash 文件（我找不到 RemoteObject - 我应该做一个包含吗？）。

如果这是不可能的，我可以在 Flex 中创建某种库，可以在 Flash 中链接以获得相同的结果吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T23:38:08.647

您正在寻找的很可能是`NetConnection`Actionscript 类。不过取决于您的 API 的格式。如果它只是基于 HTTP 的 XML，那么您也可以轻松地使用`URLLoader`该类。

NetConnection [链接文本](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/NetConnection.html)

URLLoader [链接文本](http://tush.wordpress.com/2007/07/20/actionscript-3-using-urlloader-to-send-and-load-server-variables/)

# javascript - 如何使用 window.setTimeout() 在 JavaScript 中编写递归方法？

> ID：355775
> 
> 赞同：1
> 
> 时间：2008-12-10T11:36:10.453
> 
> 标签：javascript, recursion

我正在编写一个 JavaSCript 类，该类具有递归调用自身的方法。

```
Scheduler.prototype.updateTimer = function () {
    document.write( this._currentTime );
    this._currentTime -= 1000;
    // recursively calls itself
    this._updateUITimerHandler = window.setTimeout( arguments.callee , 1000 );
} 
```

物业说明：

```
_currentTime: the currentTime of the timer in miliseconds.
_updateUITimerHandler: stores the reference so can be used later with clearTimeout(). 
```

我的问题是我在 setTimeout() 中使用递归。我知道 setTimeout() 将接受一些要执行的字符串，或对函数的引用。由于这个函数是一个对象的方法，我不知道如何从外部调用它。所以我使用了 setTimeout() 的第二种格式，并传入了对方法本身的引用。但它不起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-10T11:55:39.133

试试这个：-

```
Scheduler.prototype.startTimer = function() {
  var self = this;
  function updateTimer() {
    this._currentTime -= 1000;
    self.hTimer = window.setTimeout(updateTimer, 1000)
    self.tick()
  }
  this.hTimer = window.setTimeout(updateTimer, 1000)
}
Scheduler.prototype.stopTimer = function() {
    if (this.hTimer != null) window.clearTimeout(this.hTimer)
  this.hTimer = null;
}
Scheduler.prototype.tick = function() {
  //Do stuff on timer update
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T11:42:13.890

首先要说的是，如果您调用 setTimeout 但不更改间隔，则应该使用 setInterval。

编辑（从评论更新）：如果用作类并且 setInterval/clearInterval 不需要重新引用，则可以保留闭包的引用。

编辑2：有人指出您编写的 calle *e*将非常正确且 100% 明确地工作。

出于完整性，这是有效的：

```
function f() 
{
  alert('foo');
  window.setTimeout(arguments.callee,5000);
}

f(); 
```

所以我尝试了 document.write 而不是 alert，这似乎是问题所在。doc.write 充满了这样的问题，因为打开和关闭 DOM 进行写入，所以也许您需要更改目标的 innerHTML 而不是 doc.write

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T11:55:10.417

你可以用指针指向它...

```
/* ... */
var func = arguments.callee;
this._updateUITimerHandler = window.setTimeout(function() { func(); }, 1000);
/* ... */ 
```

# xslt - 一个大的 xslt 比更小的更细的 xslt

> ID：355783
> 
> 赞同：2
> 
> 时间：2008-12-10T11:37:59.577
> 
> 标签：xslt, sitecore

我们有一个大型 xslt 可以呈现整个商店区域，包括产品、制造商，并在此基础上根据价格和类别进行过滤。我将 sitecore 用作 CMS，但我遇到了缓存问题。我有大约 9000 个项目，有些页面需要 20 秒才能呈现。将xslt分成更小的部分会更好吗？它会提高速度吗？

我认为 sitecore 使用的 xslt 引擎称为 Nexus。

更新：

我认为我们需要优化 xslt。尽管站点核心分析器显示大约有 9k 个项目，但我们实际上在进行各种检查时遍历了大约 250k 个项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T11:46:31.713

通过应用其他更改而不是拆分 XSLT 文件，您可能会获得更好的性能。如果没有看到 XSLT，很难发现瓶颈，但您会在此处找到 XSLT 性能的一些最佳实践：

[http://www.dpawson.co.uk/xsl/sect4/N9883.html#d15756e150](http://www.dpawson.co.uk/xsl/sect4/N9883.html#d15756e150)

此外，在这种情况下使用 XSLT 分析器可能会很有帮助。

一些性能技巧还取决于您使用的引擎，因此一些附加信息在这里也可能有用。

如果您可以发布您的 XSLT 代码，我可能会帮助您找到可能的瓶颈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T11:44:23.977

听起来问题在于 sitecore 而不是 XSLT（我已经对 10 行的 K 行进行了更快的转换），但我建议通常拆分以启用代码重用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T15:38:51.523

如果您使用 Sitecore 缓存，则将一个巨大的渲染分成较小的渲染会有所帮助。拥有多个渲染将允许对每个渲染应用单独的缓存设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T11:50:55.603

这里有两个不同的问题：

*   分离 XSLT 文件以获得更好的可读性、可维护性和代码重用
*   提高 XSLT 翻译的性能

第一个应该作为最佳实践完成，后者应该处理您获得的延长渲染时间

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T19:33:50.343

绝对使用有意义的小型 XSLT。那只是很好的做法，不会影响性能。

# asp.net - ASP.NET Imagemap 被卡巴斯基反病毒软件阻止

> ID：355785
> 
> 赞同：1
> 
> 时间：2008-12-10T11:39:23.130
> 
> 标签：asp.net, antivirus, imagemap

是否有人遇到过卡巴斯基反病毒软件阻止浏览器显示在 ASP.NET 应用程序中创建的图像映射的问题？如果是这样，有没有办法解决这个问题？

非常感谢，尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T12:07:09.283

尝试关闭防火墙。通常是造成问题的防火墙。

防火墙可能会阻止您网站的某些内容被访问，因此如果您在访问内容时遇到问题，请检查您的防火墙是否拒绝来自您网站的内容。

确保您的防火墙不会阻止您访问您的站点服务的最简单方法是使用您的防火墙控制面板来允许来自 *.(您的站点 url) 的数据

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T15:16:06.750

看来我的问题毕竟是无效的。问题在于图像地图上使用的特定 png 文件。卡巴斯基在任何情况下都不会显示它（尽管我找不到任何问题）。当我将其转换为 jpeg 时，一切正常。

# language-agnostic - 您将什么称为 Mixin/Traits 系统的对象级等价物，它有 Pattern 名称吗？

> ID：355786
> 
> 赞同：1
> 
> 时间：2008-12-10T11:39:32.740
> 
> 标签：language-agnostic, design-patterns, mixins, traits

我之前问过 Mixins 是什么，并且已经开始了解这种模式的含义。但这让我想知道是否有一个通用的模式名称可以在对象级别而不是类级别上执行诸如 Mixins 之类的操作。

伪代码（在一些不存在的语言中）：

```
 Class MyClass
  {
     function foo()
     {
        print("foo")
     }
  }

  function bar()
  {
     print("bar")
  }

  object = MyClass.new()
  object.xxxx(bar)

  object.bar() #output: bar 
```

我知道这样的事情可以用多种语言以一种或另一种方式完成，但我想知道 xxxx 所代表的功能的“标准”名称是什么，以及这种模式的名称是什么，如果有的话.

谢谢！

编辑：扩展 finnsson 的答案我想这样的事情可能是另一种情况：

```
 object.xxxx(OtherClass)
 object.otherfoo() 
```

串联合适吗？

> 引用：“串联：在纯原型下，也称为串联原型......” -wikipedia

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T12:02:31.837

这在基于原型的编程语言中很常见。我相信它在红宝石中被称为“导入”，但自从我上次编写红宝石以来已经有一段时间了，所以我不确定。

在 js/ruby 中你会写

```
object.bar = bar;
object.bar() // output: bar 
```

而且它不是真正的模式，因为它只是一个赋值（o.bar = bar），在基于原型的语言中非常有意义。我猜你的例子中的 xxxx 可以被称为原型或类似的东西（见[http://en.wikipedia.org/wiki/Prototype-based_programming](http://en.wikipedia.org/wiki/Prototype-based_programming)其中一种语言称为这个**原型**）。

# .net - 通过访问器或直接访问同一类的属性的最佳方法是什么？

> ID：355787
> 
> 赞同：4
> 
> 时间：2008-12-10T11:39:50.727
> 
> 标签：.net, class, properties, oop, accessor

这是我不太一致的事情，并且总是对其他人的所作所为感到好奇。

您如何访问内部属性（私有或公共）？

例如你有这个属性：

```
Private _Name As String

Public Property Name() As String
    Get
        Return _Name
    End Get
    Set(ByVal value As String)
        _Name = value
    End Set
End Property 
```

在另一个函数中的同一类中，您更喜欢哪一个？为什么？

```
_Name = "Johnny" 
```

或者

```
Name = "Johnny" 
```

**忽略我使用 Name 而不是 Me.Name 的事实。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-10T11:45:59.590

就个人而言，我更喜欢尽可能使用该物业。这意味着您仍然可以获得验证，并且您可以轻松地在属性访问上设置断点。这在您尝试更改相互验证的两个属性时不起作用 - 例如，“最小和最大”对，其中每个属性始终都有一个验证*约束*`min <= max`。你可能有（C#）：

```
public void SetMinMax(int min, int max)
{
    if (max > min)
    {
        throw new ArgumentOutOfRangeException("max";
    }
    // We're okay now - no need to validate, so go straight to fields
    this.min = min;
    this.max = max;
} 
```

在未来的某个时候，我希望看到 C# 能够在属性中声明支持字段，使其*仅对*属性私有：

```
public string Name
{
    string name;

    get { return name; }
    set
    {
        if (value == null)
        {
            throw new ArgumentNullException("value");
        }    
        name = value;
    }
} 
```

在财产之外，您根本无法获得`name`，只有`Name`。我们已经为自动实现的属性提供了这个，但它们不能包含任何逻辑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T11:46:08.857

我会说

```
Name = "Johnny" 
```

原因是我可能有一些验证（或触发器，或延迟初始化，或......），或者稍后可能决定在分配 Name 时插入一些验证，并且我想确保触发该代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T11:44:19.783

我更喜欢：

```
Name = "Johny" 
```

对我来说，原因很简单，如果 _Name 发生了不好的事情，你总是可以在 getter/setter 中放一些输出，找出导致问题的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T12:06:33.717

这很有趣，我想大多数人都在做我所做的事情

```
Me.Name = "Johnny" 
```

或者

```
Name = "Johnny" 
```

然而，我见过的大多数项目都在使用

```
_Name = "Jonny" 
```

风格。我认为这是一个坏主意，并且感谢您确认的答案。甚至大多数由几个工具自动生成的代码都使用直接访问。

有什么特别的性能影响吗？或者是编译器在 set 或 get 中没有额外代码时对其进行优化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T19:14:35.963

使用属性（名称）。我相信一个属性应该是基础字段（_name）的唯一“所有者”。

在属性下封装字段的优点：

*   可读性：只有一个代码区域在返回之前更改或处理了 _name。
*   易于设置断点，调试等。
*   DRY：就验证和处理而言，没有代码重复。
*   更改弹性：更改验证和处理不会影响使用属性的代码。

# c# - 如何确定（ASP.NET / MonoRail）网站用户所在的时区？

> ID：355795
> 
> 赞同：1
> 
> 时间：2008-12-10T11:43:57.847
> 
> 标签：c#, asp.net, localization, internationalization, castle-monorail

所以，我正在设置一个应该过期的cookie。但是，我希望这可以在世界范围内使用。所以我需要为用户的时区调整我的到期日期。

所以，我需要在服务器端找出用户的时区。

有没有办法在 BCL 中做到这一点？就像依靠正确设置 CultureInfo.CurrentUICulture 之类的东西（我相信 MonoRail LocalizationFilter 确实如此，但尚未正确检查），然后确定用户所在的时区（以及考虑夏令时）也有）基于此？

.NET 3.5 中有 System.TimeZoneInfo，但很少有关于 Id 是什么的文档——无论它们是 ISO 代码还是什么。

还是我要依靠客户端的某些东西从例如 Date.getTimezoneOffset() 推送这些信息？ **我宁愿避免这种情况**，因为客户端撒谎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T21:45:32.173

这很简单。在服务器上，放置一个 asp:hidden 字段并用当前服务器的日期/时间填充它。在客户端上，从客户端的当前日期（新日期（））中减去隐藏字段中的日期/时间，您就得到了与 GMT 的偏移量。在服务器上执行反向操作（例如，隐藏字段中的 new Date()，从隐藏字段值中减去服务器时间）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T03:02:26.933

除了 IP 地理位置（由于其他人提到的原因，这是一个坏主意）或 JavaScript（也不是很好，因为它太模糊（由于时区）），没有办法获取用户的时区。

您最好的选择是允许用户通过某种用户控制面板自己设置时区。这样您就可以确切地知道用户所在的时区，并允许用户确认时区。

未来应该会在浏览器中添加一些很棒的地理定位功能，但要在生产中使用还有很长的路要走。

如果您决定使用 JavaScript 进行自动检测，我建议您使用这些脚本，它们会扫描用户系统上的日期以找出 DST 何时发生并返回 GMT 偏移量（即使在 DST 内）。

[http://www.attackwork.com/BlogEntry/3/Time-zone-detect-and-ignore-Daylight-Saving-Time-DST/Default.aspx](http://www.attackwork.com/BlogEntry/3/Time-zone-detect-and-ignore-Daylight-Saving-Time-DST/Default.aspx) [http://www.attackwork.com/BlogEntry/11/Daylight -Saving-Time-DST-Detect/Default.aspx](http://www.attackwork.com/BlogEntry/11/Daylight-Saving-Time-DST-Detect/Default.aspx)

仍然不是一个好主意，但它确实有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T12:08:21.403

没有确定客户时区的真正好方法。您可以跟踪他们的 IP 地址，然后尝试为其附加位置，但这很棘手且容易出错（一些定位器将所有 AOL 使用都放在弗吉尼亚州）

我会说最好在客户端进行。

# oop - 你如何向新程序员解释面向对象？

> ID：355796
> 
> 赞同：30
> 
> 时间：2008-12-10T11:44:00.920
> 
> 标签：oop, language-agnostic

我的亲戚正在学习编程，很难理解课程。例如，他很难理解您需要实例化它，方法无法访问其他方法中的变量，并且如果您更改类的一个实例中的变量，则它不会针对其他实例而更改。

我试图使用类比定义就像房子的蓝图一样。实例是由该蓝图制成的房屋。

你一般如何解释类​​和面向对象？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-10T11:48:17.340

认真使用动物，效果很好。这就是几年前为我确定这个概念的原因。刚刚找到这个 C# 代码。看起来不错

```
 // Assembly: Common Classes
    // Namespace: CommonClasses

    public interface IAnimal
    {
        string Name
        { 
             get; 
        }
        string Talk();
    }

    // Assembly: Animals
    // Namespace: Animals

    public class AnimalBase
    {
        private string _name;
        AnimalBase(string name)
        {
           _name = name;
        }
        public string Name
        {
           get
           {
              return _name;
           }
        }
    }

    // Assembly: Animals
    // Namespace: Animals

    public class Cat : AnimalBase, IAnimal
    {
        public Cat(String name) :
            base(name)
        {
        }

        public string Talk() {
            return "Meowww!";
        }
    }

    // Assembly: Animals
    // Namespace: Animals

    public class Dog : AnimalBase, IAnimal
    {
        public Dog(string name) : 
            base(name)
        {
        }

        public string Talk() {
            return "Arf! Arf!";
        }
    }

    // Assembly: Program
    // Namespace: Program
    // References and Uses Assemblies: Common Classes, Animals

    public class TestAnimals
    {
        // prints the following:
        //
        // Missy: Meowww!
        // Mr. Bojangles: Meowww!
        // Lassie: Arf! Arf!
        //
        public static void Main(String[] args)
        {
            List<IAnimal> animals = new List<IAnimal>();
            animals.Add(new Cat("Missy"));
            animals.Add(new Cat("Mr. Bojangles"));
            animals.Add(new Dog("Lassie"));

            foreach(IAnimal animal in animals)
            {
                 Console.WriteLine(animal.Name + ": " + animal.Talk());
            }    
        }
    } 
```

一旦他确定了这一点，你就挑战他定义鸟（飞），然后定义企鹅（飞！？）

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-10T12:09:38.857

我把它告诉我的妻子（一名特许会计师）的最佳方式如下。

在“常规”编程中，您有数据（被操纵的东西）和代码（被操纵的东西），它们是分开的。有时你会因为某段代码试图操纵错误的东西而混淆。

在我妻子的案例中，我说收到了一张发票（其中不涉及实物货币易手）并且不小心更新了银行余额，她立即认为这是潜在的欺诈行为（她曾经做过法务会计，对她来说一切都是潜在的欺诈行为，包括大多数我的股票交易:-)。

你可以很容易地说，一段代码打算用大拖把擦地板决定用你的牙刷来做。

在 OO 编程中，操纵者和被操纵者密不可分。您不会将洗地过程应用到地板上，而是命令地板自己洗。它知道如何做到这一点，因为代码是对象的一部分，而不是外部的东西。

在上面的会计案例中，我认为我们最终将会计科目表作为对象，我们告诉它自己应用发票。由于它了解流程，因此它知道允许更新哪些账户（债权人责任账户和费用账户，如果我没记错的话）。

无论如何，这无关紧要，我现在只是在徘徊。我的意思是用你的目标受众能够理解的方式来表达它。我想这是大多数教学的秘诀。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-15T18:51:16.877

像所有的老屁一样，我想用我自己的生活故事来回答这个问题。

我开始在 VIC-20 上进行基础编程。我不知道其他任何事情，尽管这就是所有计算机的编程方式。我认为跟踪我使用过哪些变量名以及哪些仍然是免费的（范围问题）有点困难。我还认为使用 gosub-return 并设置和读取这些将使用的变量（缺少方法）很难将我的程序分成可重复的块。

然后我通过 MS-DOS 进入 Turbo C。现在我可以创建自己的方法和函数了！我不再拘泥于基本的旧有限命令集。我觉得我正在为我编写的每个程序创建一种新语言。C给了我更多的表现力。

C++ 是我听说的第一个面向对象的语言。对我来说重要的时刻是当我明白我可以创建自己的数据类型，甚至重载运算符时。再一次，感觉就像我可以创建自己的语言，包含新的函数和数据类型，以及运算符。

这就是我将 OO 卖给新程序员的方式。解释它赋予表达能力，因为他们可以定义自己的数据类型。我一直认为封装是比继承更好的卖点。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-11T00:34:17.450

我假设目标知道如何使用图形用户界面。我发现最好的方法是用它们真正用于的东西来描述 OOP。说

### 班级

Window 是一个类。它有类似的方法

*   显示一个窗口
*   启用窗口
*   设置窗口的标题

一个窗口有属性。那是与之相关的*数据。*它与对它们进行操作的函数一起*封装在类中*

*   一个窗口有尺寸。宽度和高度。
*   一个窗口可能有一个父窗口，也可能有子窗口。
*   一个窗口有一个标题

### 目的

有很多窗户。每个特定窗口都是类*Window*的一个对象。一个包含 10 个窗口的父窗口构成 11 个 Window 对象。

### 推导

一个*按钮* **就是一个**窗口。它有尺寸，有一个父窗口，有一个标题，一个按钮的标签。这是一种*特殊*的窗户。当您要求一个窗口对象时，有人可以给您一个*Button*。Button 可以添加特定于按钮的功能和数据：

*   一个按钮有一个状态。它可以处于按下状态和未按下状态。
*   Button 可以是 Window 中的默认按钮。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-10T12:26:58.323

当您用动物解释 OO 时，不要忘记说明与[**Stinger 导弹武装袋鼠**](http://www.snopes.com/humor/nonsense/kangaroo.asp)的“is-a”关系；-)

> 袋鼠如预料般四散而去，美国人赞赏地点点头。. . 然后当袋鼠从山后重新出现并向倒霉的直升机发射了一连串毒刺导弹时，做了双重拍摄。（显然程序员已经忘记了删除步兵编码的“那个”部分）。
> 
> 课程？对象是用某些属性定义的，任何根据旧对象定义的新对象都会继承所有属性。尴尬的程序员在重用面向对象的代码时学会了小心，而美国佬带着对澳大利亚野生动物的最大尊重离开了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-10T11:48:24.220

阅读[Java 教程](http://java.sun.com/docs/books/tutorial/java/concepts/index.html)，了解一些好的想法和真实世界的示例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-10T12:28:58.770

“每个造型都是使用模具构建的”，或者“每个模型都使用模板构建”，因此“每个对象都使用一个类构建”怎么样？

请注意，它适用于面向类的 OOP（这是您想要的），但不适用于面向原型的 OOP。

至于向程序员解释 OOP，我将添加示例说明：

### 将状态与行为分开

大多数时候，一个实例描述一个状态，一个类描述一个行为。

### 代表团

一个实例将它的行为委托给它的类，而类又可以把它的行为委托给它的超类（或 mixins 或 trait）

### 多态性

如果类 A 继承自类 B，则可以在任何可以使用类 B 的实例的地方使用 A 的实例。

### 消息和方法

消息（或通用函数，或虚函数）就像一个问题。大多数时候，几个班级可以回答这个问题。

相应的方法是问题的可能答案，它存在于一个类中。

当向实例发送消息时，实例会在其类中查找相应的方法。如果找到，它会调用它（将实例绑定到“self”或“this”。否则，它会在其 mixin、trait 或超类中查找相应的方法并调用它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-10T20:01:49.620

如果他们的年龄足以填写过税表，请给他们看一张 1040EZ，并解释一个类的实例就像一张填写好的表格：每个空白都是对象的一个​​成员变量，表格还包括关于如何处理成员变量的指令，这些指令是对象的成员函数。课程本身就像表格的主副本，您可以从中打印出无数的空白表格来填写。

在尝试向新程序员传达 OO 的概念时，我会建议**避免的一件事是仅使用对象（在 OO 意义上）代表真实世界物理对象的示例。**这实际上会使学生在遇到用于表示非物理对象的对象（例如配色方案，或“设计模式”中的大多数行为模式）或仅用作存储相关功能的有用方式的对象时**更加**困惑，相关数据在同一个地方（以 Java 的 java.lang.Math 为例。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-11T00:02:35.767

信不信由你，**运动**！

我在教学和指导方面取得了成功，例如，足球队的比赛是根据不同位置（中锋、四分卫、跑卫等）如何相互作用以实现特定目标来描述的。在一个版本中，职位对应于类别，而特定的人（Tony Romo、Johnny Unitas 等）是该类别的实例——表现出与职位定义的行为相同的个人。

这个比喻的第二个版本是解释位置可能是接口（在 Java 意义上）而不是类。接口实际上代表了由实现接口方法的任何对象所履行的角色。一个对象（通过它的类，在 Java 中）实现多个接口是完全合理的，就像一个有才华的人可以在运动队中担任多个职位一样。

最后，戏剧就像一个模式，因为它描述了一组角色如何相互作用以实现某些特定目标。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-11T00:27:06.200

一个物体是一个黑盒子，你看不透它。公共方法是它们上的按钮。受保护的方法是隐藏在底部的按钮，私有方法是内部的拨码开关。

让我们将洗衣机视为一个对象。我们不知道它是如何工作的。我们不在乎它是由天然气、柴油、电力还是钚驱动的。但是，机制和内部结构会根据能源的不同而有很大差异，例如某些人需要内燃机。我们不在乎，只要我们按下“Wash”按钮，它就会洗我们的衣服。

让我们把洗衣机变成不是面向对象的。通过将它们排列在顶部来暴露所有按钮。客户现在可以通过调整一些 DIP 开关来为发动机增压。使机箱透明。现在，您可以看到您的节能洗衣机实际上是混合动力的。里面有几只猴子。您将它们释放到野外，机器会像耗油机一样消耗您的水电费。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-10T12:19:19.773

面向对象编程是提高程序员与计算机通信的抽象级别的一种技术：从打开和关闭单个位的级别，从纸卡上打孔的级别，从非凡的级别基本指令代码的复杂序列，从对数据块和可重用代码块（结构和过程）的可重用模板的不太复杂的定义级别，到将程序员头脑中的概念转录成代码的级别，以便发生什么对程序员来说，计算机内部的发生类似于物理对象、无形资产和因果世界中计算机外部发生的事情。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-10T12:30:28.753

我读过的关于面向对象编程的最好的书是[Betrand 的“面向对象的软件构造”](https://rads.stackoverflow.com/amzn/click/com/0136291554) ——如果你真的想了解基础知识，那就没有办法了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-10T15:01:07.467

我解释说，过程程序是围绕系统的“动词”构建的，你希望系统做的事情，而面向对象编程是围绕“名词”构建的，系统中的事物，以及它们的能力，并且对于许多人来说，这允许从问题域到软件的更直接的映射。

例如，我使用汽车——“Honda Accord”是一个类，而坐在停车场的车辆是一个对象，是 Honda Accord 的一个实例。本田雅阁是轿车，是汽车，是汽车，是机动车辆，是交通工具等。在我有实体汽车可以使用之前，我无法对汽车做任何事情——本田雅阁的想法对我没有帮助。

它还有助于讨论接口和多态性——油门踏板意味着加速，不管汽车在幕后做了什么来实现这一点。作为用户，我无法访问汽车的“私人”部分——我不能直接应用单独的刹车。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-10T15:26:46.620

由于问题是向新程序员解释，而不是向母亲或妻子解释，我会直奔主题。OO 是关于三个主要概念：

1.  继承：狗是动物，亲子，is-a关系测试等。
2.  封装：public-private（受保护）、信息隐藏、内部底层细节对类的用户不重要，保护用户免受未来实现的更改。
3.  多态性：运行时绑定、后期绑定、被调用的方法取决于对象的类型，而不是对象的引用或指针。

此外，根据新程序员对程序语言的使用程度，我需要帮助他/她忘记函数或程序不再是核心。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-10T15:43:38.317

游戏很好。有游戏对象，从这堵墙，敌人和玩家继承。游戏对象应该是可渲染的，具有碰撞逻辑等。敌人具有 AI 逻辑，而玩家是键盘控制的。

一些 UI 元素也很好，有按钮、输入框等都继承自一些具有管理鼠标事件等代码的基本对象。

我不喜欢动物的例子，因为我从来没有见过一个“真实的”程序必须以这种方式使用动物。它只会让人们到处使用继承，你最终会得到继承自矩形的立方体，而矩形继承自线条（为什么这么多书坚持用这个作为例子？）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-11T00:18:25.547

OOP 是更高层次的抽象，程序员除非对正常（阅读：过程）的编程方式有很好的理解，否则无法真正掌握它，并且他必须能够编写一些有用的程序。

对我来说，我的一位大学教授做了一系列讲座，在那里他讨论了编程的许多理论方面，他试图让我们相信编程是关于操纵数据，而这些数据是“状态（s )”的程序，以及我现在忘记的其他一些抽象的东西！但关键是，如果不先进行一些理论上的抽象讨论，就很难理解 OOP，而且对于没有编写实际代码经验的人来说，这种讨论没有任何意义。

在理论讨论之后，你给出一个中等复杂的程序的例子，用过程式的方式编写，然后慢慢地将它一步一步地转换成面向对象的方式。在具体例子之后，你应该回到理论讨论，只是总结要点，直接将理论结构与具体例子联系起来，例如你可以谈论一个员工的姓名，年龄和工资如何代表他的状态。

# iphone - 在 iphone 应用程序中记录调试信息的最佳方式是什么？

> ID：355802
> 
> 赞同：12
> 
> 时间：2008-12-10T11:45:21.263
> 
> 标签：iphone, logging, debugging

有没有一些标准的方法或者有没有人写过一些东西可以让你记录一条消息并将它显示在 iphone 屏幕上的一个小滚动部分或 iphone 模拟器的一个单独的窗口中？

更新：对于像我这样的新手并且不知道，使用如下所述的 NSLog 方法并确保选择 Run->Console 来显示控制台。

仍然想知道是否有人编写了一个显示在 iphone 本身上的简单记录器....

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-11T01:50:02.320

我没有足够的“声誉”来为您的帖子添加直接评论，但是：不要忘记转到 XCode->Preferences->Debugging->On Start: 选择 Show Console & Debugger

您当然可以只选择控制台或其他任何东西，但您可能希望调试器这样做。要使用它，只需单击要中断的行的左侧。您还可以从“激活”切换到“停用”，因此如果您知道有一堆断点不需要在应用程序开始时命中，请将调试设置为停用（在调试窗口中），然后，在您点击要调试的应用程序中的 UI 元素之前，将同一个按钮切换为激活，以便您的断点变为活动状态。否则，您当然可以单击继续，直到进入您的部分。

另外，在 NSLog 上，如果你开始积累一堆日志语句，并且你需要特别“找到”一个，它会有所帮助：NSLog(@"\n\n\n我的语句\n\n\n ); 这将给出一堆换行符。此外，对于初学者：

```
NSLog(@"My int: %d my BOOL: %d", myInt, myBOOL);
NSLog(@"My object of any NSObject: %@", anObjectOfAnyKind);
NSLog(@"My float: %f",myFloat); 
```

如果我在调试位上偏离了轨道，希望所有这些都对我有所帮助和抱歉；）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-10T12:10:59.463

Objective-C（更正确，真的）方法是

```
NSLog(@"message"); 
```

但是标准的 C 方法也可以

```
printf("message"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T11:52:01.793

使用 NSLog(@"日志消息");

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-22T22:01:34.337

如果您有一个崩溃的应用程序，那么您可以向您的用户询问崩溃日志。崩溃日志包含有关应用程序崩溃时正在执行的操作和堆栈跟踪的信息。

iPhone 应用程序日志文件也存储在您的用户计算机上，并且每次同步 iPhone 时都会被复制。（请注意，DEVICE_NAME 将与您的 iPhone 在 iTunes 中的名称相同，并且每个日志文件都将以应用程序的名称开头。）

Mac OS X : /Library/Logs/CrashReporter/MobileDevice//

Windows XP：C:\Documents and Settings\Application Data\Apple 计算机\Logs\CrashReporter\

Windows Vista：C:\Users\AppData\Roaming\Apple 计算机\Logs\CrashReporter\MobileDevice\

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-16T23:55:35.867

对于 Swift 来说，这很简单

```
print("log msg") 
```

# c# - 抽象 UI 数据格式

> ID：355813
> 
> 赞同：1
> 
> 时间：2008-12-10T11:49:11.020
> 
> 标签：c#, asp.net, user-interface, design-patterns

我有一些具有十进制属性的实体。这些实体的属性显示在我的 UI 中的多个位置。

目前我发现自己在做：

```
litWeight.Text = person.Weight.ToString("0.00"); 
```

到处都是。现在我知道一个事实，在某些情况下，并且对许多其他情况持怀疑态度，即客户可能希望将值设为 3d.p。在将来。

是否有一些模式可以用来处理这个权重属性（和其他属性；不仅仅是小数，也许是日期等）的格式，以便我可以在一个地方拥有这种格式？

我知道可以在 webconfig 中使用格式字符串，或者在 UI 中编写一些扩展方法，但这些似乎不是非常优雅的解决方案。

拥有一些与我的实体相关联的格式化对象会很好，因此使用哪个格式化程序本质上是显而易见的。

谢谢，

安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T12:07:38.377

最简单的解决方案是使用静态方法创建一个实用程序类，这些方法可以适当地格式化不同类型的值并调用它们。例如：

```
litWeight.Text = Utility.FormatWeight(person.Weight); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T12:08:09.890

您不能向实体添加用于格式化主题的方法吗？然后每个对象都可以委托给一个“策略”对象来进行实际的格式化。

这样做的原因既是为了能够更改小数位等，也是为了允许国际化之类的事情——十进制格式取决于语言环境；某些国家/地区使用十进制逗号代替点，或将数字分组而不是三位数等。

编辑：评论是这将表示代码放在域层中。没错，所以对所有设计问题应用标准修复；添加更多的间接层:)

您可能不想拥有完整的 MVC，但 View 和 Model 的概念似乎仍然合适。也许，对于每个实体，定义一个 View 类，所以 PersonView 保留对 Person 对象的引用，并为每个感兴趣的 Person 属性提供名为 format_weight 的属性？它仍应使用策略模式进行实际格式化。

所以你的例子是

```
PersonView pv = new PersonView(person)

litWeight.Text = pv.format_weight(); 
```

（请原谅语法错误，我不会说 C#）

如果您愿意，您可以通过重新实现方法/属性并委托给引用的 Person 或在创建 PersonView 时从 Person 继承来使 PersonView 替代 Person？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T15:31:23.880

您可以创建一个非常基本的用户控件 - 派生自 label 或类似的 - 纯粹负责显示权重字符串，因此您可以：

```
weightValue.DisplayValue(person.Weight); 
```

设置器根据需要格式化小数。如果在显示重量时使用此选项，则只需更改用户控件即可更改所有重量显示。

一个基本版本可能是：

```
public void DisplayValue(decimal weight)
{
    this.Text = weight.ToString("0.00");
} 
```

# c# - C# mutex - 从 ASP.NET 和控制台应用程序调用错误

> ID：355816
> 
> 赞同：7
> 
> 时间：2008-12-10T11:51:17.817
> 
> 标签：c#, asp.net, mutex

我正在使用全局命名互斥锁在 ASP.NET 应用程序和控制台应用程序之间进行文件访问同步。

在运行 ASP.NET 应用程序时，控制台应用程序无法按预期获取互斥锁。运行控制台应用程序时，ASP.NET 应用程序抛出`UnauthorizedAccessException: Access to the path 'Global\TheNameOfTheMutex' is denied.`

我将尝试捕获异常并将其视为未能获取互斥锁，但我想知道它为什么会这样？如果从两个不同的浏览器访问 ASP.NET 应用程序，则它会按预期运行，并且控制台应用程序在运行多个实例时也会按预期运行。

**更新：**在 Windows XP 上，当 ASP.NET 应用程序运行并且我尝试启动控制台应用程序时，也会引发异常。

用于同步的代码在一个通用程序集中：

```
using (Mutex m = new Mutex(false, "Global\\TheNameOfTheMutex")) // exception thrown
{
  try
  {
    lock = m.WaitOne(0, false);
  }
  catch (AbandonedMutexException)
  {
    // ...
  }

  if(lock)
  {
    // ...

    m.ReleaseMutex();
  }
} 
```

环境：Windows Server 2008、IIS 7、ASP.NET 2.0

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-10T11:58:07.773

您是否设置了正确的用户来访问资源？使用

```
MutexSecurity and MutexAccessRule ? 
```

[尝试在 MSDN http://msdn.microsoft.com/en-us/library/system.security.accesscontrol.mutexsecurity.aspx](http://msdn.microsoft.com/en-us/library/system.security.accesscontrol.mutexsecurity.aspx)上查看这个

和[http://msdn.microsoft.com/en-us/library/system.security.accesscontrol.mutexaccessrule.aspx](http://msdn.microsoft.com/en-us/library/system.security.accesscontrol.mutexaccessrule.aspx)

ps 我正在等待 Jon Skeet 的回答，以表明我对此事的无知...=>

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-08-11T07:07:09.827

这里的示例来自[如何确定我的应用程序的先前实例是否正在运行？](https://stackoverflow.com/questions/778817/how-to-determine-if-a-previous-instance-of-my-application-is-running-c)（见[romkyns](https://stackoverflow.com/users/33080/romkyns)的回答）

```
 var sid = new SecurityIdentifier(WellKnownSidType.WorldSid, null);
    var mutexsecurity = new MutexSecurity();
    mutexsecurity.AddAccessRule(new MutexAccessRule(sid, MutexRights.FullControl, AccessControlType.Allow));
    mutexsecurity.AddAccessRule(new MutexAccessRule(sid, MutexRights.ChangePermissions, AccessControlType.Deny));
    mutexsecurity.AddAccessRule(new MutexAccessRule(sid, MutexRights.Delete, AccessControlType.Deny));
    _mutex = new Mutex(false, "Global\\YourAppName-{add-your-random-chars}", out created, mutexsecurity); 
```

# hql - 从 ScalarQuery 获取行计数 InvalidCast 异常

> ID：355818
> 
> 赞同：1
> 
> 时间：2008-12-10T11:51:50.767
> 
> 标签：hql, castle-activerecord

```
ScalarQuery<int> query = new ScalarQuery<int>(typeof(Role), 
                         "select count(role.RoleId) from Role as role");
return query.Execute(); 
```

它因 invalidcast 异常而失败，但在将 count 替换为 max 时成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T12:03:26.593

**编辑**：某些数据库将返回 long 进行计数查询。例如 SQL 服务器。

```
ScalarQuery<long> query = new ScalarQuery<long>(typeof(Role), 
                          "select count(r) from Role r");
return query.Execute(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T12:06:34.043

你用的是什么数据库？可能是 count 不返回 int。

您也可以尝试使用[http://api.castleproject.org/html/T_Castle_ActiveRecord_Queries_CountQuery.htm](http://api.castleproject.org/html/T_Castle_ActiveRecord_Queries_CountQuery.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T19:06:47.970

不完全是问题的答案，而是一个建议：如果您想避免自己不得不发出查询的麻烦，那么只需使用`ActiveRecordMediator<T>.Count()`（如果您想要条件计数，它具有采用标准/过滤字符串的重载）和all 返回`int`所有数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-27T13:23:12.690

根据对迄今为止给出的答案的测试，以下内容对我有用（包括 where 子句）：

```
// Option 1
int result = ActiveRecordMediator<Post>.Count("BlogId = ?", blogId);

// Option 2
CountQuery query = new CountQuery(typeof(Post), "BlogId = ?", blogId);
int result = ActiveRecordMediator.ExecuteQuery(query);

// Option 3
ScalarQuery<long> query= new ScalarQuery<long>(typeof(Post),
  "SELECT COUNT(*) FROM Post WHERE BlogId = ?", blogId);
long result = query.Execute(); 
```

# php - 使用 PHP 缓存 HTML 输出

> ID：355830
> 
> 赞同：4
> 
> 时间：2008-12-10T11:58:39.520
> 
> 标签：php, html, caching

我想在我的网站上为我的 php 页面创建一个缓存。我确实找到了太多解决方案，但我想要的是一个可以从我的数据库生成 HTML 页面的脚本，例如：

我有一个类别页面，它从数据库中获取所有类别，因此脚本应该能够生成一个 HTML 页面：my-categories.html。然后，如果我选择一个类别，我应该得到一个 my-x-category.html 页面，依此类推，以获取其他类别和子类别。

我可以看到一些网站的 URL 如下： wwww.the-web-site.com/the-page-ex.html

即使它们是动态的。

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-10T12:10:21.493

检查 ob_start() 函数

```
ob_start();
echo 'some_output';
$content = ob_get_contents();
ob_end_clean();

echo 'Content generated :'.$content; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-10T12:18:44.627

您可以使用 URL 重写获得类似的 URL。例如：对于 apache，请参阅 mod_rewrite

[http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)

您实际上不需要创建文件。您可以创建文件，但它更复杂，因为如果数据发生更改，您需要决定何时更新它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T16:53:13.730

手动缓存（创建 HTML 并将其保存到文件）可能不是最有效的方法，但如果您想沿着这条路走，我推荐以下方法（摘自我为此编写的一个简单的测试应用程序）：

```
$cache_filename = basename($_SERVER['PHP_SELF']) . "?" . $_SERVER['QUERY_STRING'];
$cache_limit_in_mins = 60 * 32; // this forms 32hrs
// check if we have a cached file already
if ( file_exists($cache_filename) )
{
    $secs_in_min = 60;
    $diff_in_secs = (time() - ($secs_in_min * $cache_limit_in_mins)) - filemtime($cache_filename);
    // check if the cached file is older than our limit
    if ( $diff_in_secs < 0 )
    {
        // it isn't, so display it to the user and stop
        print file_get_contents($cache_filename);
        exit();
    }
}

// create an array to hold your HTML output, this is where you generate your HTML
$output = array();
$output[] = '<table>';
$output[] = '<tr>';
// etc

//  Save the output as manual cache
$file = fopen ( $cache_filename, 'w' );
fwrite ( $file, implode($output,'') );
fclose ( $file );

print implode($output,''); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T12:08:55.693

我将[APC](http://uk3.php.net/apc)用于所有 PHP 缓存（在 Apache 服务器上）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-28T08:04:59.663

在我看来，这是最好的解决方案。我将它用于我的 Android 应用程序的缓存 JSON 文件。它可以简单地用于其他 PHP 文件。 **它将文件大小从 ~1mb 优化到 ~163kb (gzip)**。

[![在此处输入图像描述](https://i.stack.imgur.com/3Gme1.png)](https://i.stack.imgur.com/3Gme1.png)

## 在您的目录中创建`cache`文件夹

## 然后创建`cache_start.php`文件并粘贴此代码

```
<?php
header("HTTP/1.1 200 OK");
//header("Content-Type: application/json"); 
header("Content-Encoding: gzip");

$cache_filename = basename($_SERVER['PHP_SELF']) . "?" . $_SERVER['QUERY_STRING'];
$cache_filename = "./cache/".md5($cache_filename);
$cache_limit_in_mins = 60 * 60; // It's one hour

if (file_exists($cache_filename))
{
    $secs_in_min = 60;
    $diff_in_secs = (time() - ($secs_in_min * $cache_limit_in_mins)) - filemtime($cache_filename);
    if ( $diff_in_secs < 0 )
    {
        print file_get_contents($cache_filename);
        exit();
    }
}
ob_start("ob_gzhandler");
?> 
```

## 创建`cache_end.php`并粘贴此代码

```
<?php
$content = ob_get_contents();
ob_end_clean();
$file = fopen ( $cache_filename, 'w' );
fwrite ( $file, $content );
fclose ( $file );
echo gzencode($content);
?> 
```

## 然后创建例如`index.php`（要缓存的文件）

```
<?php
include "cache_start.php";
echo "Hello Compress Cache World!";
include "cache_end.php";
?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T21:12:17.420

如果您不反对框架，请尝试使用 Zend Frameworks 的[Zend_Cache](http://framework.zend.com/manual/en/zend.cache.html#zend.cache.introduction)。它非常灵活，并且（与某些框架模块不同）易于实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-19T15:47:51.130

可以使用 PEAR 中的 Cache_lite：

详情在这里 [http://mahtonu.wordpress.com/2009/09/25/cache-php-output-for-high-traffic-websites-pear-cache_lite/](http://mahtonu.wordpress.com/2009/09/25/cache-php-output-for-high-traffic-websites-pear-cache_lite/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-02T04:37:10.813

我是从加载数据库的角度考虑的，对数据带宽和加载速度收费。我有一些多年来不太可能改变的页面，（我知道使用基于数据库的 CMS 系统很容易）。与美国不同，这里的带宽成本可能很高。任何人对此都有任何看法，无论是创建 htmal 页面还是动态（php、asp.net） 到页面的链接无论如何都将存储在数据库中。

# c# - 在 C# 中使用 .NET 3.5 将数据集转换为 JSON

> ID：355833
> 
> 赞同：6
> 
> 时间：2008-12-10T11:59:59.907
> 
> 标签：c#, .net, json, dataset, .net-3.5

我一直在寻找一种简单的方法来将数据集从[PostgreSQL](http://en.wikipedia.org/wiki/PostgreSQL)数据库转换为 JSON，以便在我正在构建的项目中使用。

这是我第一次使用 JSON，我发现找到一个简单的方法来做这件事真的很棘手。目前我一直在使用 StringBuilder 从数据集中的信息创建 JSON 字符串，但我听说使用命名空间的[.NET](http://en.wikipedia.org/wiki/.NET_Framework) 3.5 可以非常简单地做到这一点`System.Runtime.Serialization`，尽管我还没有找到一个简单的关于如何做到这一点的文章或博客！最简单的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T12:07:00.267

使用 Newtonsofts [Json.Net](http://james.newtonking.com/pages/json-net.aspx)并查看*[JSON.NET 和 JavaScriptSerializer](http://www.west-wind.com/Weblog/posts/471835.aspx)*中的 DataTable JSON 序列化，它用于创建 DataSet-to-JSON 转换器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-07T13:39:47.353

对于其他关注此主题的人：

这是将数据集转换为 JSON 数组的最简单方法，就像`json_encode`( [PHP](http://php.net/manual/en/function.json-encode.php) ) 对 ASP.Net 所做的那样：

```
using Newtonsoft.Json;

public static string ds2json(DataSet ds) {
    return JsonConvert.SerializeObject(ds, Formatting.Indented);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-20T07:53:17.147

```
public static string GetJSONString(DataTable Dt)
{
    string[] StrDc = new string[Dt.Columns.Count];
    string HeadStr = string.Empty;

    for (int i = 0; i < Dt.Columns.Count; i++)
    {
        StrDc[i] = Dt.Columns[i].Caption;
        HeadStr += "\"" + StrDc[i] + "\" : \"" + StrDc[i] + i.ToString() + "¾" + "\",";
    }

    HeadStr = HeadStr.Substring(0, HeadStr.Length - 1);

    StringBuilder Sb = new StringBuilder();
    Sb.Append("{\"" + Dt.TableName + "\" : [");

    for (int i = 0; i < Dt.Rows.Count; i++)
    {
        string TempStr = HeadStr;
        Sb.Append("{");

        for (int j = 0; j < Dt.Columns.Count; j++)
        {
            TempStr = TempStr.Replace(Dt.Columns[j] + j.ToString() + "¾", Dt.Rows[i][j].ToString());
        }
        Sb.Append(TempStr + "},");
    }

    Sb = new StringBuilder(Sb.ToString().Substring(0, Sb.ToString().Length - 1));
    Sb.Append("]}");

    return Sb.ToString();
} 
```

* * *

```
var JObject = eval('(' + JSONString + ');');
for(var i = 0; i < JObject .Employees.length; i++)
{

var val1 = JObject.Employees[i].EmployeeID;

var val2 = JObject.Employees[i].NationalIDNumber;

var val3 = JObject.Employees[i].Title;

var val4 = JObject.Employees[i].BirthDate;

var val5 = JObject .Employees[i].HireDate ;

} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-10T12:45:28.380

也许您听说过新发布的[*.NET Framework 4.0*](http://www.microsoft.com/net/dublin.aspx)[中的system.runtime.serialization.json](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.aspx)命名空间。[](http://www.microsoft.com/net/dublin.aspx)

 ** * *

## 回答 #5

> 赞同：-2
> 
> 时间：2020-10-13T06:32:09.597

```
public static T WriteJson<T>(this System.Data.DataSet dataSet)
{
    try
    {
        XmlDocument doc = new XmlDocument();
        doc.LoadXml(dataSet.GetXml());
        return (T)Convert.ChangeType(JsonConvert.SerializeXmlNode(doc).Replace("null", "\"\"").Replace("'", "\'"), typeof(T));
    }
    catch (Exception ex)
    {
        throw ex;
    }
} 
```

# sharepoint - CAML 中的 SharePoint AZ groupby

> ID：355835
> 
> 赞同：2
> 
> 时间：2008-12-10T12:02:27.920
> 
> 标签：sharepoint, list, caml

我正在使用内容查询 Web 部件并将其导出到 Web 部件文件，以便我更改 queryoverride 和 groupby 元素。

我想按字母顺序对结果进行分组，所以我想我可以使用一个函数来获取列表项标题的第一个字母，然后按此分组，它可能会成功。问题是我在 webpart 文件中看不到任何这样做的方法，我可以使用 CAML 来执行此操作吗？

**一个** a.doc
aston.doc
aaa.doc

**B**
b.doc
box.doc
bbb.doc

将不胜感激任何人的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T12:32:41.480

为此，您需要在 CAML 查询中调用某种子字符串函数来获取第一个字母。不幸的是，这是不可能的。

我会使用 CAML 进行排序，例如..：

```
<Query>
   <OrderBy>
      <FieldRef Name='Title' />
   </OrderBy>
</Query> 
```

...然后使用内容查询 Web 部件中的 XSLT 功能按首字母分组。

# asp.net-mvc - ASP.Net MVC HandleError 抛出 500 内部服务器错误

> ID：355842
> 
> 赞同：2
> 
> 时间：2008-12-10T12:05:20.317
> 
> 标签：asp.net-mvc, handleerror

我的控制器上有以下 HandleError 过滤器：

```
[HandleError(ExceptionType = typeof(ArgumentException), View = "DestinationError")]
```

我已经设置了 Web.Config 以便开启 customErrors。我遇到的问题是 HandleError 过滤器工作正常，当我在 Visual Studio 本地运行应用程序时，但是当我将它部署到服务器时，我得到的只是 500 内部服务器错误，表明错误视图不能成立。

有没有人遇到过这个问题，我怀疑路由可能是问题的根本原因（hoho）。该站点被部署到 Web 根目录中的目录，而不是 wwwroot 本身，因此 IIS 可能无法找到错误文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T12:42:46.840

要回答我自己的问题，神奇的是关闭 IIS 中的 HTTP 错误。我对这种解决方法并不满意，所以如果有人有更好的想法，我很想听听。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-06T01:04:04.173

否则，您可以使用 Web.Config 配置并将其设置为预期的控制器操作。像这样：

```
 <customErrors mode="On" defaultRedirect="/Error">
        <error statusCode="404" redirect="/Error/NotFound"/>
    </customErrors> 
```

然后想象你有一个错误控制器（/错误），它指向一个索引操作

```
public class ErrorController : Controller
{
    [AcceptVerbs(HttpVerbs.Get)]
    public ActionResult Index()
    {
        Response.StatusCode = (int)HttpStatusCode.InternalServerError;
        return View("Index");
    }

    [AcceptVerbs(HttpVerbs.Get)]
    public ActionResult NotFound()
    {
        Response.StatusCode = (int)HttpStatusCode.NotFound;
        return View("NotFound");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-08T09:50:23.313

迁移到 MVC 3 RC 后我遇到了同样的问题。通过添加布局/母版页设法解决它。

```
@inherits System.Web.Mvc.WebViewPage<System.Web.Mvc.HandleErrorInfo>

@{
    View.Title = "Error";
    Layout = "~/Views/Shared/_Layout.cshtml";
} 
```

现在内部服务器错误消失了，但我认为这是某个地方的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-05T02:43:19.707

如果您尝试以下方法怎么办？

```
Response.TrySkipIisCustomErrors = true; 
```

# javascript - 如何在 JavaScript 中模拟“类”？（有或没有第三方库）

> ID：355848
> 
> 赞同：21
> 
> 时间：2008-12-10T12:06:39.020
> 
> 标签：javascript, oop

如何在 JavaScript 中模拟类（和命名空间）？

我需要创建一个 JavaScript 库并且对该语言的经验有限。我一直认为它对类有本机支持，但它与 Java 的相关性比我想象的要少。似乎 JavaScript 中的一切实际上都是一个函数。

到目前为止，我发现它很有意义，因为它是一种动态弱类型语言，但这对于习惯于使用强类型语言并使用编译器来发现我们的错误的人来说有点背离： )

我主要使用 C# 和 Java 工作，并希望有一些语法上相似的东西，这样库对于我们必须维护它的其他 C# 开发人员来说看起来很熟悉。

我有以下类型的代码可以工作，但我想知道其他开发人员对此有何看法。有哪些替代方案？有没有更好的方法？有没有更可读的方法？

我知道我想要的是类似于 C# 或 Java 的东西，而我应该只是接受这**是 JavaScript**的事实，但我的目标是通过让其他开发人员更熟悉和更直观来尝试缓解他们的学习曲线。

```
//Perform the namespace setup (this will actually be done with checking 
//in real life so we don't overwrite definitions, but this is kept short 
//for the code sample).
var DoctaJonez = new function();
DoctaJonez.Namespace1 = new function();

/**
 * Class description.
 */
DoctaJonez.Namespace1.SomeClass = function()
{
    /**
     * Public functions listed at the top to act like a "header".
     */
    this.publicFunction = privateFunction;

    /**
     * Private variables next.
     */
    var privateVariable;

    /**
     * Finally private functions.
     */
    function privateFunction()
    {

    }
}

//Create an instance of the class
var myClass = new DoctaJonez.SomeClass();

//Do some stuff with the instance
myClass.publicFunction(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-10T12:22:30.703

*   [定义 JavaScript 类的 3 种方法](http://www.phpied.com/3-ways-to-define-a-javascript-class/)
*   [面向对象的 JavaScript](http://www.xml.com/pub/a/2006/06/07/object-oriented-javascript.html)
*   [JavaScript 教程：函数和类](http://www.webdevelopersjournal.com/articles/jsintro3/js_begin3.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-10T14:54:37.963

对于 JavaScript 中的 OOP 的一般理解，您最好阅读[Douglas Crockford](http://javascript.crockford.com/)：

*   [JavaScript 中的经典继承](http://javascript.crockford.com/inheritance.html)
*   [JavaScript 中的原型继承](http://javascript.crockford.com/prototypal.html)
*   [JavaScript 中的私有成员](http://javascript.crockford.com/private.html)

对于 Dojo 粉丝（以及一般技术），[Neil Roberts](http://someclosure.com/)有很好的文章：

*   [按数字着色：dojo.delegate](http://dojocampus.org/content/2008/03/20/color-by-numbers-dojodelegate/)
*   [JavaScript 元类编程](http://www.sitepen.com/blog/2008/03/18/javascript-metaclass-programming/)

普通的[dojo.declare()](http://docs.dojocampus.org/dojo/declare)可能是主流库中最先进的 OOP 基础。我有偏见，但不要相信我的话。以下是有关如何使用它的示例。

一个普通的香草对象：

```
// Let's define a super simple class (doesn't inherit anything).
dojo.declare("Person", null, {
  // Class-level property
  answer: 42,

  // Class-level object property
  name: {first: "Ford", last: "Prefect"},

  // The constructor, duh!
  constructor: function(age){
    this.age = age; // instance-level property
  },

  // A method
  saySomething: function(verb){
    console.log("I " + verb + " " +
      this.name.first + " " + this.name.last + "!" +
      " -- " + this.answer);
  },

  // Another method
  passportControl: function(){
    console.log("I am " + this.age);
  }
}); 
```

使用示例：

```
// A fan of Ford Perfect
var fan = new Person(18);
fan.saySomething("love"); // I love Ford Perfect! -- 42
fan.passportControl();    // I am 18 
```

单继承很简单：

```
// Let's create a derived class inheriting Person
dojo.declare("SuperAgent", Person, {
  // Redefine class-level property
  answer: "shaken, not stirred",

  // Redefine class-level object property
  name: {first: "James", last: "Bond"},

  // The constructor
  constructor: function(age, drink){
    // We don't need to call the super class because
    // it would be done automatically for us passing
    // all arguments to it.

    // At this point "age" is already assigned.

    this.drink = drink; // Instance-level property
  },

  // Let's redefine the method
  saySomething: function(verb){
    // Let's call the super class first
    this.inherited(arguments);
    // Pay attention: no need for extra parameters, or any extra code,
    // we don't even name the class we call --- it is all automatic.
    // We can call it any time in the body of redefined method

    console.log("Yeah, baby!");
  },

  shoot: function(){ console.log("BAM!!!"); }
}); 
```

使用示例：

```
// Let's create a James Bond-wannabe
var jb007 = new SuperAgent(45, "Martini");
jb007.saySomething("dig");  // I dig James Bond! -- shaken, not stirred
                            // Yeah, baby!
jb007.passportControl();    // I am 45
jb007.shoot();              // BAM!!!

// Constructors were called in this order: Person, SuperAgent
// saySomething() came from SuperAgent, which called Person
// passportControl() came from Person
// shoot() came from SuperAgent. 
```

混合：

```
// Let's define one more super simple class
dojo.define("SharpShooter", null, {
  // For simplicity no constructor

  // One method to clash with SuperAgent
  shoot: function(){
    console.log("It's jammed! Shoot!");
  }
}); 
```

基于 Mixin 的多重继承：

```
// Multiple inheritance
dojo.declare("FakeAgent", ["SuperAgent", "SharpShooter"], {
  // Let's do it with no constructor

  // Redefine the method
  saySomething: function(verb){
    // We don't call super here --- a complete redefinition

    console.log("What is " + verb "? I want my " + this.drink + "!");
  },
}); 
```

使用示例：

```
// A fake agent coming up
var ap = new FakeAgent(40, "Kool-Aid");
ap.saySomething("hate"); // What is hate? I want my Kool-Aid!
ap.passportControl();    // I am 40
ap.shoot();              // It's jammed! Shoot!

// Constructors were called in this order: Person, SuperAgent
// saySomething() came from FakeAgent
// passportControl() came from Person
// shoot() came from SharpShooter. 
```

如您所见，`dojo.declare()`它通过简单易用的 API 提供了所有必需品：直接的单继承、基于 mixin 的多继承、构造函数的自动链接以及简单易用的超级方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T18:28:01.167

如果您（和您的团队）习惯于 Java，但需要为网站编写一些 JavaScript，也许您应该考虑使用[Google Web Toolkit](http://en.wikipedia.org/wiki/Google_Web_Toolkit) (GWT)。它允许您使用转换为 JavaScript 的 Java 编写 JavaScript。不过，我还没有尝试过。

JavaScript 实际上是一种很酷的语言。它有一些缺陷（包括允许你做非常愚蠢的事情），但只要有一点自律，你就可以做出伟大的事情。JavaScript 实际上是面向*对象*的，而不是面向*类*的，但你可以做很多相同的事情。您没有（AFAIK）继承，但它对打字一点也不严格（它强大但也很危险的功能之一），所以您会发现它没有限制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T12:27:36.217

例如，在[http://mckoss.com/jscript/object.htm](http://mckoss.com/jscript/object.htm)中。

在谷歌搜索“面向对象的 JavaScript”时，您会发现一堆示例。通过查看[Ext JS](http://en.wikipedia.org/wiki/Ext_JS)等流行的 JavaScript 框架，您将了解这些概念以及它们在实践中的应用方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T12:29:17.943

mepcotterell 提供了很好的链接，但我想补充一点，我个人更喜欢将命名空间视为对象，即`DoctaJonez.Namespace1 = {};`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T16:10:14.427

使用[MooTools](http://en.wikipedia.org/wiki/MooTools)。请参阅文章*[如何编写 Mootools 类](http://www.mootorial.com/wiki/mootorial/09-howtowriteamootoolsclass)*。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T15:14:42.197

请参阅[Mozilla 开发人员网络](http://en.wikipedia.org/wiki/Mozilla_Developer_Network)(MDC) 文章*[Class-Based vs. Prototype-Based Languages](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Class-Based_vs._Prototype-Based_Languages)*。

# php - JavaScript 函数没有响应

> ID：355865
> 
> 赞同：0
> 
> 时间：2008-12-10T12:15:10.297
> 
> 标签：php, javascript, ajax

我有以下代码，这是我的小型 AJAX 应用程序的核心部分。我没有收到任何错误，只是没有任何反应。我猜有一种更有效的方法来做我想做的事情。

这是代码：

```
var xmlHttp

var layername

function update(layer, part, pk, query)

{

if (part=="1")

{

$url  "get_auction.php?cmd=GetAuctionData&pk="+pk+"&sid="+Math.random()

}

else if (part=="2")

{

var url  "get_records.php?cmd=GetRecordSet&query="+query+"&sid="+Math.random()

}

xmlHttp=GetXmlHttpObject()

if(xmlHttp==null)

{

alert("Your browser is not supported?")

}

xmlHttp.onreadystatechange = function() {

        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {

            document.getElementById(layer).innerHTML=xmlHttp.responseText

        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {

            document.getElementById(layer).innerHTML="loading"

        }

    };

xmlHttp.open("GET",url,true)

xmlHttp.send(null)

}

function GetXmlHttpObject()

{

    var xmlHttp=null;

    try

    {

        xmlHttp=new XMLHttpRequest();

    }catch (e)

    {

        try

        {

                xmlHttp =new ActiveXObject("Microsoft.XMLHTTP");

        } 

        catch (e) {}

    }

return xmlHttp;

}

function makewindows(){

child1 = window.open ("about:blank");

child1.document.write(json_encode(<?php echo $row2["ARTICLE_DESC"]; ?>));

child1.document.close(); 

} 
```

以及我如何从 php 调用函数的示例

```
onclick="update(\'Layer3\',\'2\','.$pk.'\',\'0\',)">' 
```

pk 或 query 永远不会同时传递，只会传递其中一个。

编辑：我还想知道makewindows函数是否更有意义，或者保持原样。每种方法都有优点和缺点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T12:50:06.920

我会检查 PHP 正在生成的 HTML。假设 $pk 是一个字符串，看起来你缺少一个开引号。试试这个：

```
onclick="update(\'Layer3\',\'2\',\''.$pk.'\',\'0\',)"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T14:57:25.633

看起来您可能有一些 javascript 错误：

```
if (part=="1")
{
   $url  "get_auction.php?cmd=GetAuctionData&pk="+pk+"&sid="+Math.random()
}
else if (part=="2")
{
   var url  "get_records.php?cmd=GetRecordSet&query="+query+"&sid="+Math.random()
} 
```

使用 Firefox 并打开 javascript 控制台以获取 javascript 错误，然后尝试修复它抱怨的行。

Javascript 将在遇到错误时立即停止运行。

另外，如果您还没有结帐[萤火虫。](https://addons.mozilla.org/en-US/firefox/addon/1843)很棒的工具！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T14:39:19.913

**`json_encode`是一个 PHP 函数**，因此您需要像这样修改该特定行：

```
child1.document.write(<?php echo json_encode($row2["ARTICLE_DESC"]); ?>); 
```

# c# - 结合两个 LINQ 查询？

> ID：355875
> 
> 赞同：1
> 
> 时间：2008-12-10T12:22:10.563
> 
> 标签：c#, linq

我想我有一个心理障碍，但是有人可以告诉我如何将这两个 LINQ 语句组合成一个语句吗？

```
/// <summary>
/// Returns an array of Types that implement the supplied generic interface in the
/// current AppDomain.
/// </summary>
/// <param name="interfaceType">Type of generic interface implemented</param>
/// <param name="includeAbstractTypes">Include Abstract class types in the search</param>
/// <param name="includeInterfaceTypes">Include Interface class types in the search</param>
/// <returns>Array of Types that implement the supplied generic interface</returns>
/// <remarks>
/// History.<br/>
/// 10/12/2008      davide       Method creation.<br/>
/// </remarks>
public static Type[] GetTypesImplementingGenericInterface(Type interfaceType, bool includeAbstractTypes, bool includeInterfaceTypes)
{
    // Use linq to find types that implement the supplied interface.
    var allTypes = AppDomain.CurrentDomain.GetAssemblies().ToList()
                    .SelectMany(s => s.GetTypes())
                    .Where(p => p.IsAbstract == includeAbstractTypes  
                                    && p.IsInterface == includeInterfaceTypes);

    var implementingTypes = from type in allTypes
                            from intf in type.GetInterfaces().ToList()
                            where intf.FullName != null && intf.FullName.Contains(interfaceType.FullName)
                            select type;

    return implementingTypes.ToArray<Type>();
} 
```

我正在避免 IsAssignableFrom，因为它在不提供通用接口的特定类型时似乎会​​失败，因此我相信在 IsAssignableFrom 上使用 FullName caparison 就足够了，例如：

```
namespace Davide
{
    interface IOutput<TOutputType> { }

    class StringOutput : IOutput<string> { }
} 
```

typeof(IOutput<>).FullName 将返回“Davide+IOutput`1”

typeof(StringOutput).GetInterfaces()[0].FullName 将返回“Davide+IOutput`1[[System.String, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]”

因此使用 FullName.Contains 就足够了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T13:11:41.743

SelectMany 转换为第二个“来自”：

```
var implementors = from assembly in AppDomain.CurrentDomain.GetAssemblies()
                   from type in assembly.GetTypes()
                   where type.IsAbstract == includeAbstractTypes
                   where type.IsInterface == includeInterfaceTypes
                   from intf in type.GetInterfaces()
                   where intf.FullName != null && 
                         intf.FullName.Contains(interfaceType.FullName)
                   select type; 
```

顺便说一句，为了主观清楚，我将条件分成多个“where”子句。

这可以编译，但我没有测试它是否真的有效:) 正如另一个答案所示，您可以将“Any”与 GetInterfaces() 一起使用，而不是最终的“from”子句。

请注意，无需到处调用 ToList() - LINQ 旨在能够处理整个序列。

顺便说一句，我不确定你为什么要通过 type.GetInterfaces() 来检查。[与使用Type.IsAssignableFrom 相比](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx)，有什么不同（和可取的）吗？这将使它更简单：

```
var implementors = from assembly in AppDomain.CurrentDomain.GetAssemblies()
                   from type in assembly.GetTypes()
                   where type.IsAbstract == includeAbstractTypes
                   where type.IsInterface == includeInterfaceTypes
                   where interfaceType.IsAssignableFrom(type)
                   select type; 
```

您实际上在某个地方的不同程序集中具有相同的接口类型名称吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T12:50:25.700

这会做吗：

```
 public static Type[] GetTypesImplementingGenericInterface(Type interfaceType, bool includeAbstractTypes, bool includeInterfaceTypes)
    {
        // Use linq to find types that implement the supplied interface.
        var allTypes = AppDomain.CurrentDomain.GetAssemblies().ToList()
                                    .SelectMany(s => s.GetTypes())
                                    .Where(p => p.IsAbstract == includeAbstractTypes
                                           && p.IsInterface == includeInterfaceTypes
                                           && p.GetInterfaces().Any(i=>i.FullName != null && i.FullName.Contains(interfaceType.FullName))
                                           );

        //var implementingTypes = from type in allTypes
        //                        from intf in type.GetInterfaces().ToList()
        //                        where intf.FullName != null && intf.FullName.Contains(interfaceType.FullName)
        //                        select type;

        //return implementingTypes.ToArray<Type>();

        return allTypes.ToArray();
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T12:57:55.437

我可以建议另一种解决方案吗？

```
 public static Type[] GetTypesImplementingGenericInterface(Type interfaceType, bool includeAbstractTypes, bool includeInterfaceTypes)
    {
        // Use linq to find types that implement the supplied interface.
        var implementingTypes = AppDomain.CurrentDomain.GetAssemblies()
                                    .SelectMany(s => s.GetTypes())
                                    .Where(p => interfaceType.IsAssignableFrom(p)
                                              && (
                                                     (p.IsAbstract && includeAbstractTypes) 
                                                     || (p.IsInterface && includeInterfaceTypes)
                                                     || (!p.IsAbstract && !p.IsInterface)
                                                 )
                                          );

        return implementingTypes.ToArray<Type>();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T14:08:20.240

经过与 Jon Skeet 的简短讨论和更多思考后，我发布了以下答案。我更改了使用 GetGenericTypeDefinition 而不是 FullName.Contains 的方法，这将是一个更强大的解决方案。我还更改了 IsAbstract 和 IsInterface 的 LINQ 查询 Where 子句，因为它们没有按预期排除类型。感谢大家的反馈。

```
/// <summary>
/// Returns an array of Types that implement the supplied generic interface in the
/// current AppDomain.
/// </summary>
/// <param name="interfaceType">Type of generic interface implemented</param>
/// <param name="excludeAbstractTypes">Exclude Abstract class types in the search</param>
/// <param name="excludeInterfaceTypes">Exclude Interface class types in the search</param>
/// <returns>Array of Types that implement the supplied generic interface</returns>
/// <remarks>
/// History.<br/>
/// 11/12/2008      davide       Created method.<br/>
/// 11/12/2008      davide       Altered method to use a two LINQ query pass.<br/>
/// 11/12/2008      davide       Altered method to use optimised combined LINQ query.<br/>
/// 12/12/2008      davide       Altered method and replaced FullName criteria match with GetGenericTypeDefinition.<br/>
/// </remarks>
public static Type[] GetTypesImplementingGenericInterface(Type interfaceType, bool excludeAbstractTypes, bool excludeInterfaceTypes)
{
    if (!interfaceType.IsGenericType)
    {
        throw new ArgumentException("Supplied interface is not a Generic type");
    }

    if (interfaceType.ContainsGenericParameters)
    {
        interfaceType = interfaceType.GetGenericTypeDefinition();
    }

    // Use linq to find types that implement the supplied generic interface.
    var implementingTypes = from assembly in AppDomain.CurrentDomain.GetAssemblies()
                            from type in assembly.GetTypes()
                            where (type.IsAbstract != excludeAbstractTypes) || (!excludeAbstractTypes)
                            where (type.IsInterface != excludeInterfaceTypes) || (!excludeInterfaceTypes)
                            from intf in type.GetInterfaces()
                            where intf.IsGenericType && intf.GetGenericTypeDefinition() == interfaceType
                            select type;

    return implementingTypes.ToArray<Type>();
} 
```

# c# - 解决编译器错误 CS1519：类、结构或接口成员声明中的无效标记“,”

> ID：355876
> 
> 赞同：5
> 
> 时间：2008-12-10T12:22:21.857
> 
> 标签：c#, .net, asp.net

我正在开发一个 ASP .NET 2.0 站点，该站点使用 Web 应用程序项目文件，因此会编译为 dll，而不是像使用旧式网站项目那样部署源代码。

当它在网站的根目录中运行时，该站点在我的测试服务器（Windows Server 2003 R2、IIS6）上运行良好。但是我需要在虚拟目录下运行它。当我切换到该页面时，在浏览网站中的任何页面时出现以下错误

CS1519：类、结构或接口成员声明中的标记“,”无效

错误消息继续告诉我行号和代码文件，但是代码文件位于临时 ASP .NET 文件夹下，当我尝试找到它时，它不存在。

因此，我无法确定是哪个页面导致了问题，尽管我怀疑它可能是母版页，如果此错误发生在所有页面上。有没有其他人以前见过这个或找到解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T13:14:44.047

原来问题与在虚拟层次结构中继承我上面的站点的配置设置有关。

该站点使用自定义配置文件，其属性在配置文件中的 system.web、profile、properties 下定义。属性之一的类型以“Namespace.ClassName, AssemblyName”格式指定。

当我从最后删除“，AssemblyName”时，问题自行解决了，因为我去掉了作为无效标记的逗号。

我只能假设，当 ASP .NET 在运行时编译页面时，它一定也在编译配置文件类，并在代码生成期间使用配置文件中的属性定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T12:55:59.623

听起来您没有在 IIS 中将虚拟设置为**应用程序**，或者它运行的 ASP.NET 版本错误（即 1.1，而它应该是 2.0.blah）。

虚拟应该在 IIS 视图中具有 cog 图标，并且在属性窗格中，必须具有应用程序名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-10T20:39:32.000

我和我的队友一直有同样的问题。问题是，当您从某处复制代码并将其粘贴到 Visual Studio 中时，有时它会在行之间添加点。它们不会显示在 Visual Studio 中，但编译器会不断给你一个错误消息，这实际上是令人沮丧的。要摆脱它们，请将代码片段粘贴到一些在线编译器中。在在线编译器中会显示这些点，因此您可以轻松删除它们，然后复制并粘贴整洁的代码。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-02-12T18:45:42.447

```
namespace Rectangle
{
    class Name
    {
        int length1;
        int width1;
        int sum;

        Console.Write("Enter the length: ");
            length = int.Parse(Console.ReadLine());

        Console.Write("Enter the width: ");
            width = int.Parse(Console.ReadLine());

        sum = length1* width1;

        Console.WriteLine($"Sumis {sum}");

    }
} 
```

# reporting-services - SQL Reporting Services Express：外部服务器的数据源

> ID：355877
> 
> 赞同：1
> 
> 时间：2008-12-10T12:22:27.210
> 
> 标签：reporting-services

使用 SSRS 2008 **Express** Edition，是否可以创建连接到外部 SQL Server 的数据源，或者是否人为地将其限制为相同的 SQL Server 和该 Reporting Services 引擎的实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T14:06:09.043

我自己想通了。您不能定义外部数据源。

参见：[MSDN](http://msdn.microsoft.com/en-us/library/ms365166.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T07:13:10.827

您可以尝试使用链接服务器，您只需调用远程（链接）数据源中的过程。

# php - php和mysql搜索和传递变量问题

> ID：355879
> 
> 赞同：0
> 
> 时间：2008-12-10T12:22:48.753
> 
> 标签：php, javascript, sql, ajax

我有以下代码：

[http://www.nomorepasting.com/getpaste.php?pasteid=22615](http://www.nomorepasting.com/getpaste.php?pasteid=22615)

[由这个问题](https://stackoverflow.com/questions/355865/javascript-function-not-responsive)中提到的 javascript 调用：

我的问题是我似乎无法传递 $query，因为当我自己调用此文件时似乎没有发生任何事情。

我不确定控制信息流的最佳方式是什么。我的逻辑没问题吗？通过javascript将查询传递给php文件，然后用函数返回？

我也担心我对 $rows 的使用，因为它似乎不是必需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T13:47:34.057

我认为您想替换它（第 36 行）：

```
$rows = getRowsByArticleSearch($searchString, $table); 
```

有了这个：

```
$rows = getRowsByArticleSearch($query, $table); 
```

出于安全考虑，您至少应该做的是来自 spelley 帖子的 mysql_real_escape_string 内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T13:22:46.137

在您链接到的代码中，我看不到 $searchString 的声明位置？在前面提到的 PHP 中，我看到了这两个单独的部分：

```
$query ='';
if (isset($_GET["query"]))
$query = $_GET["query"]; 
```

您稍后在页面下方执行的代码是

```
$table = 'Auctions';
$rows = getRowsByArticleSearch($searchString, $table); 
```

据我在代码中看到的，没有任何地方声明过 $searchString。然而，更大的担忧是您在执行查询字符串之前没有对其进行清理。为了安全起见，我至少会替换：

```
$result = mysql_query("SELECT ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME 
                       FROM {$table} 
                       WHERE upper ARTICLE_NAME LIKE '%" . $searchString . "%'"); 
```

和

```
$result = mysql_query("SELECT ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME 
                       FROM {$table} 
                       WHERE upper ARTICLE_NAME LIKE '%" . mysql_real_escape_string($searchString) . "%'"); 
```

您还应该检查是否打开了魔术引号，以避免双重转义。

# security - IIS6 服务未注册的 MIME 类型

> ID：355883
> 
> 赞同：1
> 
> 时间：2008-12-10T12:25:37.390
> 
> 标签：security, iis, mime

我有一个 IIS6 Web 服务器（在 Win2003 上）有一个奇怪的行为，我猜这是一些未记录的“功能”......

它提供 SVG 文件（扩展名 .svg）而无需在 IIS 元数据库上注册。它也没有 * mime 类型。

对于这个请求：

```
GET /basic/file1.svg HTTP/1.1 
```

响应包含

```
HTTP/1.1 200 OK
Content-Length: 32817
Content-Type: image/svg+xml 
```

那么...... IIS 是从哪里获得这种`image/svg+xml`mime 类型的？

我发现它的唯一地方是在注册表中，位于`HKEY_CLASSES_ROOT\MIME\Database`. 但是根据我找到的所有 MS 信息，IIS 允许的 mime 类型的来源是它自己的元数据库。

有谁知道这种行为？这可能会导致 IIS 管理员产生错误的安全感......

最好的问候大家！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T20:22:29.830

IIS 合并来自 Metabase 和注册表 (HKCR\<extension>) 的 MIME 映射以获取允许的 Mime 类型列表。

要列出元数据库 mime 时间，您可以使用：

```
adsutil.vbs get /MimeMap/mimemap 
```

不幸的是，它打印出的 mime 地图很糟糕：

```
D:\Apps\Scripts>adsutil.vbs get /MimeMap/mimemap
Microsoft (R) Windows Script Host Version 5.6
Copyright (C) Microsoft Corporation 1996-2001\. All rights reserved.

MimeMap                         : (MimeMapList) ".asx,video/x-ms-asf" ".xml,text/xml" ".tsv,text/tab
-separated-values" ".ra,audio/x-pn-realaudio" ".sv4crc,application/x-sv4crc" ".spc,application/x-pkc
s7-certificates" ".pmc,application/x-perfmon" ".lit,application/x-ms-reader" ".crd,application/x-msc 
```

更改 ADSUtil.VBS 中的一行可以解决此问题（注意“ vbCRLF & ”）：

第 1655 行：

```
 MimeOutPutStr = MimeOutPutStr & """" & MimeEntry.Extension & "," & MimeEntry.MimeType & """ " 
```

到

```
 MimeOutPutStr = MimeOutPutStr & vbCRLF & """" & MimeEntry.Extension & "," & MimeEntry.MimeType & """ " 
```

产生如下输出：

```
D:\Apps\Scripts>adsutil.vbs enum  /MimeMap
Microsoft (R) Windows Script Host Version 5.6
Copyright (C) Microsoft Corporation 1996-2001\. All rights reserved.

KeyType                         : (STRING) "IIsMimeMap"
MimeMap                         : (MimeMapList)
".asx,video/x-ms-asf"
".xml,text/xml"
".tsv,text/tab-separated-values"
".ra,audio/x-pn-realaudio"
".sv4crc,application/x-sv4crc"
".spc,application/x-pkcs7-certificates"
".pmc,application/x-perfmon"
".lit,application/x-ms-reader"
".crd,application/x-mscardfile" 
```

# php - MySQL 和 PHP 的 unicode 问题

> ID：355897
> 
> 赞同：0
> 
> 时间：2008-12-10T12:32:42.600
> 
> 标签：php, javascript, mysql, html, ajax

我有以下从微软访问文件导出的 UTF-8 文件

[http://www.yousendit.com/download/TTZtT214SU84Q1FLSkE9PQ](http://www.yousendit.com/download/TTZtT214SU84Q1FLSkE9PQ)

我已确保我的 mysql 数据库是 utf8 的状态；客户端和服务器的命令。我使用以下命令将上述文件插入到我的数据库中：

```
LOAD DATA LOCAL INFILE 'tblAuction1.txt' INTO TABLE Auctions FIELDS TERMINATED BY ';' ENCLOSED BY '"' ESCAPED BY '\\'; 
```

一切似乎都还不错，据我所知，Unicode 字符显示在 html 中。数据库字段的直接内容在这里：

[http://www.nomorepasting.com/getpaste.php?pasteid=22622](http://www.nomorepasting.com/getpaste.php?pasteid=22622)

但是会显示生成的 html 代码：

[http://www.nomorepasting.com/getpaste.php?pasteid=22617](http://www.nomorepasting.com/getpaste.php?pasteid=22617)

显示为

费用清单

```
1.00 
<\/OBJECT>
');\n\t\t<\/SCRIPT>\n\t\t 
```

在浏览器中

我用来显示这一点的代码是：

[http://www.nomorepasting.com/getpaste.php?pasteid=22618](http://www.nomorepasting.com/getpaste.php?pasteid=22618)

在我更改编码之前工作正常。

作为一个附带问题，我想知道为什么从制表符分隔更改为分号分隔，并且封闭字段会将导出文件的大小减少一半。制表符是单个字符，就像 ; 字符，并添加引号括起来应该增加了大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T13:58:49.590

根据 Web 服务器的配置，您可能需要将编码显式设置为“text/html; charset=UTF-8”，其中`header()`：

```
header('Content-Type: text/html; charset=UTF-8'); 
```

这应该足以解决您的特定问题，但是 - 如果您还打算操作字符串 - 请注意 PHP 包含许多不安全地用于多字节字符的函数：您至少应该正确配置[mbstring 扩展](http://it2.php.net/manual/en/book.mbstring.php)。

我的书签里也有这个[备忘单](http://www.nicknettleton.com/zine/php/php-utf-8-cheatsheet)，我认为它仍然是相关的。

# java - 创建单例工厂

> ID：355899
> 
> 赞同：0
> 
> 时间：2008-12-10T12:32:46.563
> 
> 标签：java

```
 String fullName = PATH + "." + name;
        Class cl= Class.forName(fullName);
        if(name.equalsIgnoreCase("MobileSearch")){
            if(msearchType==null){
                msearchType=(SearchInterface)cl.newInstance();
            }
            return msearchType;

        }
        if(name.equalsIgnoreCase("BookSearch")){
            if(bsearchType==null){
                bsearchType=(SearchInterface)cl.newInstance();
            }
            return bsearchType;

        } 
```

我如何摆脱`if`这里的陈述。
我正在使用反射。
请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T12:45:32.077

使用地图：

```
if (!searchInstances.containsKey(name)) 
{
  searchInstances.put(
    name, 
    (SearchInterface)Class.forName(PATH + "." + name).newInstance()
  );
}

return searchInstances.get(name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T15:51:22.850

这会给你另一个视角

[http://en.wikipedia.org/wiki/Liskov_substitution_principle](http://en.wikipedia.org/wiki/Liskov_substitution_principle)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T12:45:12.467

你只是返回一个 SearchInterface 的实例吗？如果是这样，为什么不：

```
String fullName = PATH + "." + name;

Class cl= Class.forName(fullName);                
if(searchType==null){                                
     searchType=(SearchInterface)cl.newInstance();
}                        
return searchType; 
```

希望有帮助。

# redirect - IIS6 - 除了少数例外，如何将用户重定向到每个页面的另一个站点？

> ID：355903
> 
> 赞同：4
> 
> 时间：2008-12-10T12:35:23.203
> 
> 标签：redirect, iis-6

我在 IIS 6 中有一个网站设置，假设它被称为**[http://www.this.com](http://www.this.com)**。

我已经为这个网站设置了一个重定向到**[http://www.that.com](http://www.that.com)**，它维护了目录结构和查询参数，如下所示：

**[http://www.that.com](http://www.that.com) $S$Q - 使用选项“上面输入的确切 URL”**

这很好用，每当有人请求时，例如：

**[http://www.this.com/subfolder/page.aspx?Id=1](http://www.this.com/subfolder/page.aspx?Id=1)**

然后他们最终在：

**[http://www.that.com/subfolder/page.aspx?Id=1](http://www.that.com/subfolder/page.aspx?Id=1)**

现在，我有一个页面，实际上是一个处理程序**[http://www.this.com/image.axd](http://www.this.com/image.axd)**，我不想重定向它。

它的语法是什么？我已阅读[此处的](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/41c238b2-1188-488f-bf2d-464383b1bb08.mspx?mfr=true)**使用通配符重定向**部分，但我无法弄清楚如何做似乎是直截了当的事情。

请注意，**image.axd**是一个处理程序，因此我不能只是“右键单击”它并设置重定向属性，因为它实际上并不存在。

我在子文件夹中还有一些其他页面，我不想重定向，例如：

**[http://www.this.com/subfolder/donotredirectthispage.aspx](http://www.this.com/subfolder/donotredirectthispage.aspx)**

任何帮助，将不胜感激。

**编辑：**有几个人提到过使用 ISAPI_Rewrite，对此我很感激，但我真的不想在网站配置中引入另一个复杂性。IIS 似乎暗示我可以使用 ! 和 0 到 9 个变量。

使用 IIS 真的不可能做到这一点吗？

我目前的解决方法是在我想要重定向的所有文件夹和页面上设置重定向属性，但我不想重定向的页面除外，但这是管理方面的噩梦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T12:42:32.567

`page not found`您可以为为您执行重定向的错误 (404)实现自定义错误页面。您将关闭 IIS 中的重定向。在自定义错误页面中构建重定向逻辑。然后配置您的网站，以便 404 错误重定向到您的错误页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T12:52:37.710

如果您可以在 IIS 服务器上安装软件，我建议您使用工具来重写您的请求 URL。

对于 IIS 6.0，我使用了[ISAPI_Rewrite](http://www.isapirewrite.com/)，它运行良好。它是轻量级的并且非常可配置。有一个免费的“精简版”版本可以满足您的要求。

您可以使用包含与 HTTP 请求匹配的规则的文本文件来配置程序，然后在匹配规则后编写要执行的操作。您的实例可能需要通用重定向规则（类似于 IIS 中的规则）和例外规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T12:58:27.620

您应该研究使用标头重写模块的可能性，例如[ISAPI_rewrite](http://www.isapirewrite.com/)。有一个免费的“精简版”版本足以满足您的需求。

这可以为您做的如下：在服务器上执行实际页面之前，根据一组可配置的规则重写请求标头（或发出 HTTP 301/302 重定向）。底层服务器看到剩余的请求，就好像客户端真的以这种方式发出它们一样。

以下规则将不理会`image.axd`请求，同时重定向其他所有内容。

```
# image.axd stays unchanged ("L" is the "last rule" flag)
RewriteCond Host: www.\this\.com
RewriteRule ^.*?\bimage\.axd\b.* $0 [L]

# all requests that have not been stopped by an earlier rule
# end up here ("RP" is the "permanent redirect" flag)
RewriteCond Host: www.\this\.com
RewriteRule .* http://www.that.com$0 [RP,L] 
```

# c# - 如何加快在 VS 加载项中打开 WPF 窗口的速度？

> ID：355904
> 
> 赞同：1
> 
> 时间：2008-12-10T12:35:23.890
> 
> 标签：c#, wpf, visual-studio, add-in, vsx

我有一个 Visual Studio 加载项，它打开一个模式 WPF 窗口。

我的问题是，第一次出现窗口需要 4 秒钟，这对客户来说显然是一种伤害。所以我想知道是否有办法优化它？

当加载项启动时，而不是在实际使用时，是否有某种漂亮的代码来预加载 PresentationFramework（或任何减慢速度的东西）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T13:00:34.760

您可能需要检查 VS 中的输出窗口，以查看暂停是否实际上来自加载它尚未加载的 DLL。如果是这种情况，那么你可以试试这个：

当应用程序启动时，加载一个空白的隐藏 WPF 窗口并关闭它。

这应该“预加载”演示框架（如果这确实是问题所在——有时很难用这些情况来判断。），这样当您调用所需的窗口时，它就可以打开了。

不是最好的解决方案，但用户通常可以首先等待 4 秒。

# vim - 如何在 Vim 中对多行重复编辑？

> ID：355907
> 
> 赞同：137
> 
> 时间：2008-12-10T12:39:14.727
> 
> 标签：vim

我知道在 Vim 中我经常可以通过简单地在命令前面添加一个数字来重复命令。例如，可以通过以下方式删除 5 行：

```
5dd 
```

通常也可以指定一系列行来应用命令，例如

```
:10,20s:hello:goodbye:gc 
```

如何执行“垂直编辑”？例如，我想在给定的每一行的开头（跳过空格，即如果您在命令模式下的 Shift-I 之后键入逗号会得到什么）插入一个特定的符号，比如一个逗号范围。如何实现这一点（不诉诸down-period-down-period-down-period）？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2008-12-10T13:37:57.477

`Ctrl`-`v`逐块进入视觉模式。然后你可以移动（`h``j``k``l`-wise，正常），如果你想在多行上插入一些东西，使用`Shift`- `i`。

所以对于文本：

```
abc123abc
def456def
ghi789ghi 
```

如果你点击`Ctrl`-`v`将光标放在 1 上，点击`j`两次以向下两列，然后`Shift`- `i``,``ESC`，你的文本将如下所示：

```
abc,123abc
def,456def
ghi,789ghi 
```

（多行插入有一点滞后，直到你点击之后才会渲染`ESC`）。

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2008-12-10T12:45:07.973

`:10,20s/^/,/`

或使用宏，记录：

`q a i , ESC j h q`

与：

`@ a`

说明：`q a`开始录制宏到寄存器`a`，`q`结束录制。有可用的`a`寄存器。`z`

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2008-12-18T19:32:32.223

这就是 :norm(al) 命令的用途：

```
:10,20 正常 I,

```

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2011-11-09T11:53:09.120

如果您已经在使用“。” 重复你的最后一个命令，然后我发现[这](http://vim.wikia.com/wiki/VimTip84)是迄今为止最方便的解决方案。它允许您通过使用在可视块的每一行上重复上一个命令

```
" allow the . to execute once for each line of a visual selection
vnoremap . :normal .<CR> 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2009-11-28T11:21:59.483

我相信最简单的方法是

1）为一行录制一个宏，称之为'a'；在这种情况下，一种类型

> qa , ESC jq

2）选择要应用宏的行块

3）使用'norm'函数在这行代码块上执行宏'a'，即，

> ```
> :'<,'>norm@a 
> ```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2008-12-10T12:45:20.330

我认为最简单的方法是录制一个宏，然后根据需要多次重复该宏。例如，要在每一行的开头添加一个逗号，请键入：

```
q a I , ESC j q 
```

重复 5 次，你输入

```
5 @ a 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2019-02-14T16:47:52.293

将您的编辑保存在`.`运算符中后，请执行以下操作：

1.  使用可视模式选择要应用运算符的文本
2.  然后运行命令`:norm .`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-10T13:03:30.263

除了已经回答的宏之外，对于在一系列行中插入逗号的特定情况（例如从第 10 行到第 20 行），您可能会执行以下操作：

```
:10,20s/\(.*\)/,\1 
```

也就是说，您可以使用 \( 和 \) 创建编号组匹配，并在替换字符串中使用 \1 表示“替换为匹配的内容”。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-06T23:33:04.317

我使用[块视觉模式](http://en.wikibooks.org/wiki/Learning_the_vi_editor/Vim/Modes#block_visual_mode)。这允许您跨多行执行插入/编辑（又名“垂直编辑”）。

# user-interface - 如何设计一个好的“进度面板”

> ID：355908
> 
> 赞同：2
> 
> 时间：2008-12-10T12:40:02.913
> 
> 标签：user-interface, language-agnostic, logging, progress-bar

对于需要几秒钟以上的任务，我认为一个好的用户界面应该提供一个进度条以及有关操作进度的适当信息。（Microsoft 很乐意提供有关此主题的[用户界面指南](http://msdn.microsoft.com/en-us/library/aa511486.aspx)，但我想要一个更高级的状态面板。）

我正在使用的“任务”类能够记录消息，如果消息足够重要（警告或错误），我想在进度面板上显示它们。当出现警告或错误（可能是警告或错误图标）时，图形指示也会很好。如果有很多这样的消息，一个文本框、一个列表视图或者可能是一些[报告控件](http://www.codejock.com/products/reportcontrol/)在这里可能是合适的。

任务运行时可能有一个取消按钮，任务完成后，一个“查看日志”按钮也不错。

总而言之，我有一个好主意如何实现我的状态面板，但我真的很想对此有所了解。我错过了什么重要的事情吗？我在这方面做得太过分了吗？那里可能已经有类似的组件可用了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T14:56:54.137

对于日志记录，您可能实际上应该有另一个更高级别的错误。这些是我通常实现的级别（从 80 年代的 DEC 开始）。

1.  DEBUG - 一个非常低优先级的消息，开发人员刚刚输入它以帮助诊断发生了什么事情，以防出现问题。
2.  信息 - 没问题，只是报告用户可能感兴趣的进度。
3.  警告 - 在某些情况下可能会出现问题，但也可能很好。
4.  错误 - 一个明确的问题。必须通知用户，但程序会尝试继续运行。
5.  致命 - 一个严重到程序无法继续的问题。

第二个是，由于您将其称为“进度面板”，我假设您正计划实施某种进度条。实际上已经对[进度条](http://www.codinghorror.com/blog/archives/001058.html)进行了相当多的研究。最重要的是，无论你做什么，都不要让进度条随着进度变慢。这使它似乎永远拖下去。

最后，听起来您正在考虑某种状态消息行。如果您正在寻找一些好的状态消息，我建议您使用其中的[一些](http://aawiki.prixeon.com/index.php?title=Loading_Screen_Messages)。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T12:46:08.470

您在这里有一个[类似的状态面板规范](https://www.opends.org/wiki/page/StatusPanelUISpecification)，它可以为您提供一些关于可以包含在这种 GUI 中的内容的想法：

在列出设计细节之前，先定义此状态面板的目标和范围。

注意：如果选项太多，您会将其演变为“控制面板”；-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T18:40:17.837

您将希望在进行中查看日志消息，而不仅仅是在结束时。如果出现错误，通常是在任务完成之前，UI 认为一切仍在进行中。发现这种情况真的很烦人，但唯一可见的日志消息（无需转到某个外部文件）是一些与实际问题相去甚远的随机信息消息。

（我不知道你是否已经这样做了，因为你的问题并不清楚。如果你是，脱帽致敬。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T18:53:17.887

我认为你的主要进度条恰好填满一次是很重要的，并且总是有进度的迹象。

我最近在工作中做了一些非常相似的事情。任务很长，有很多子任务。我最终得到的界面是一个双进度条，实际上是一堆进度条中的第一个和最后一个。

API类似于

```
StartNewTask(Caption,NumberOfSubtasks)
EndTask 
SetProgress(Caption,NumberOfSubtasksFinished) 
```

`StartNewTask`在堆栈上压入一个新柱，并`EndTask`弹出一个。

SetProgress 设置最近推送的进度条的进度，并将更改波及父进度条。例如：

```
StartNewTask('Doing 2 things',2)
 SetProgress('Done 1 now',1)
 StartNewTask('Big Subtask',40)
  ...
  SetProgress('Done some subtasks',10) 
```

现在，显示了 2 个进度条，第二个显示为 25% (10/40)，第一个显示为 62.5% (1/2 + 10/40*2)

就像我上面说的，如果你在堆栈中有 >2 个任务，我只显示第一个和最后一个（第一个给出整体进度并且永远不会倒退，第二个给出当前活动的指示）

您可以通过为每个子任务赋予权重来扩展它，即

```
StartNewTask(Caption,[ListOfSubTaskWeightings]) 
```

使顶部进度条更平滑。

此外，开发人员可以显示所有进度条以查看为什么需要很长时间，我认为您可以从中制作出不错的日志。

# java - 在 java 中解析非常大的 XML 文档（以及更多）

> ID：355909
> 
> 赞同：19
> 
> 时间：2008-12-10T12:41:01.603
> 
> 标签：java, xml, memory-management, streaming, sax

（以下全部用Java编写）

我必须构建一个将可能非常大的 XML 文档作为输入的应用程序。该文档是加密的——不是使用 XMLsec，而是使用我的客户预先存在的加密算法——将分三个阶段进行处理：

首先，将根据上述算法对流进行解密。

其次，扩展类（由第三方编写到我提供的 API）将读取文件的某些部分。读取的数量是不可预测的——特别是它不能保证在文件的标题中，但可能出现在 XML 中的任何位置。

最后，另一个扩展类（同样处理）将输入 XML 细分为 1..n 个子集文档。这些可能会在某些部分与第二个操作处理的文档部分重叠，即：我相信我需要回退我用来处理这个对象的任何机制。

这是我的问题：

有没有一种方法可以做到这一点，而无需一次将整个数据读入内存？显然我可以将解密实现为输入流过滤器，但我不确定是否可以按照我描述的方式解析 XML；通过遍历尽可能多的文档以收集第二步的信息，然后通过倒回文档并再次将其传递以将其拆分为作业，理想情况下释放文档中不再使用的所有部分他们已经通过了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-10T13:41:26.440

税法是正确的方法。我建议看看[伍德斯托克斯](http://woodstox.codehaus.org/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-10T13:24:46.333

这听起来像是 StAX ( [JSR 173](http://jcp.org/en/jsr/detail?id=173) ) 的工作。StAX 是一个拉式解析器，这意味着它的工作方式或多或少类似于 SAX 等基于事件的解析器，但您可以更好地控制何时停止读取、拉取哪些元素，...

该解决方案的可用性在很大程度上取决于您的扩展类实际在做什么，如果您可以控制它们的实现等等......

要点是，如果文档非常大，您可能希望使用基于事件的解析器而不是基于树的解析器，因此您不会使用大量内存。

StAX 的实现可以从 SUN ( [SJSXP](https://sjsxp.dev.java.net/) )、[Codehaus](http://stax.codehaus.org/)或其他一些供应商处找到。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T12:59:38.193

您可以使用[`BufferedInputStream`](http://java.sun.com/javase/6/docs/api/java/io/BufferedInputStream.html)具有非常大缓冲区大小的 a 并`mark()`在扩展类工作之前和`reset()`之后使用。

如果扩展类需要的部分在文件中很远，那么这可能会变得非常占用内存，'尽管如此。

如果要缓冲的数据超过某个预设阈值，则更通用的解决方案是编写您自己的`BufferedInputStream`类似缓冲到磁盘的工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-10T13:57:56.580

我会编写一个自定义实现`InputStream`来解密文件中的字节，然后使用*SAX*解析来自流的结果 XML。

```
SAXParserFactory.newInstance().newSAXParser().parse(
  new DecryptingInputStream(), 
  new MyHandler()
); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T13:21:53.907

您可能对[XOM](http://xom.nu/ "XOM")感兴趣：

> XOM 相当独特，因为它是双流/基于树的 API。可以在文档仍在构建时处理树中的各个节点。这使 XOM 程序的运行速度几乎与底层解析器提供数据的速度一样快。您无需等待文档完全解析后即可开始使用它。
> 
> XOM 非常节省内存。如果将整个文档读入内存，XOM 会使用尽可能少的内存。更重要的是，XOM 允许您在构建文档时对其进行过滤，这样您就不必构建您不感兴趣的树部分。例如，您可以跳过构建仅代表边界空白的文本节点，如果这样的空白在您的应用程序中并不重要。您甚至可以逐个处理文档，并在完成后将其丢弃。XOM 已用于处理千兆字节大小的文档。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-10T21:16:24.267

查看[XOM](http://xom.nu "XOM")库。您要查找`StreamingExampleExtractor.java`的示例位于源代码分发的示例目录中。这显示了一种对大型 xml 文档执行流式解析的技术，它只构建特定节点、处理它们并丢弃它们。它与 sax 方法非常相似，但内置了更多解析功能，因此可以很容易地实现流解析。

如果您想在更高级别工作，请查看[NUX](http://acs.lbl.gov/software/nux/)。这提供了一个高级流式 xpath API，它只将评估 xpath 所需的数据量读入内存。

# nhibernate - 现在 MS 将不再支持 LINQ to SQL，我应该采取什么策略？

> ID：355916
> 
> 赞同：1
> 
> 时间：2008-12-10T12:43:32.237
> 
> 标签：nhibernate, linq-to-sql, entity-framework

如果您使用过 NHibernate 和实体框架，请对比您的经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T12:45:22.887

您还可以考虑查看[Castle ActiveRecord](http://www.castleproject.org/activerecord/index.html)，它是 NHibernate 之上的一个层。在我看来，它让整个 ORM 变得闪闪发光。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T12:53:35.117

我们是 LINQ to SQL 的早期采用者，但只是在有限的基础上等待实体框架。我们才刚刚开始使用 EF，但我最大的抱怨仍然是我对 LINQ to SQL 的抱怨，因为我的域模型仍然与数据源或框架结合，这意味着我的 POCO 并不是真正独立的正如他们应该的那样。

当然，在[Entity Framework Design](http://blogs.msdn.com/efdesign/archive/2008/11/20/n-tier-improvements-for-entity-framework.aspx)博客上，他们已经认识到持久性无知是一个非常受欢迎的请求特性（并且将在下一个版本中），并且这里至少有一个示例说明如何在使用真正的 POCO 时实现持久性[无知](http://blogs.msdn.com/jkowalski/archive/2008/09/09/persistence-ignorance-poco-adapter-for-entity-framework-v1.aspx).

我们还评估了 NHibernate。它非常坚固且易于使用。实际上，在所有其他条件相同的情况下，NHibernate 建立得更好，但我个人倾向于坚持使用 Microsoft 实现，除非我有正当理由不这样做 - 如果没有其他原因，除了我可以获得的支持质量水平。

# log4net - 当我的 Web 应用程序打包部署时 log4net 不记录

> ID：355917
> 
> 赞同：1
> 
> 时间：2008-12-10T12:43:46.870
> 
> 标签：log4net, deployment

我有一个使用 log4net 将错误记录到日志文件的 Web 应用程序。当我通过 xcopy 发布我的网站时，它运行良好，但是当我构建包安装程序时，当远程用户访问我的站点时，log4net 似乎不起作用。

我在 web.config 中使用*impersonate=true*并且 log4net 仅在我是登录用户时记录错误。

我有另一个应用程序在所有情况下都可以正常工作，但没有部署包。

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T15:34:11.347

毕竟这是一个权限问题，为每个人设置写权限 log4net 开始很好地记录，因为它使用当前登录的用户帐户

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T14:22:08.323

我不这么认为，因为在工作应用程序中使用了相同的配置

但在这里

log4net 在写入磁盘时使用什么用户？！是否需要添加写入日志文件夹的权限？因为我使用 impersonate=true 登录到该站点的用户是 log4net 用来写入文件系统的用户，对吧？！

```
 <!-- log4net -->
  <log4net debug="false">
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
      <file value="D:\\WSBank\\Solution\\Logs\\Solution.log" />
      <appendToFile value="true" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="10" />
      <maximumFileSize value="1024KB" />
      <staticLogFileName value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
      </layout>
    </appender>
    <root>
      <level value="ALL" />
      <appender-ref ref="RollingFileAppender" />
    </root>
  </log4net> 
```

# oslo - 什么是微软 OSLO？

> ID：355930
> 
> 赞同：2
> 
> 时间：2008-12-10T12:45:57.880
> 
> 标签：oslo

它是 DSL 生成工具还是自然查询语言？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T12:48:28.483

“奥斯陆”是微软即将推出的建模平台的代号。建模在广泛的领域中使用，允许更多的人参与应用程序设计，并允许开发人员以更高的抽象级别编写应用程序。“奥斯陆”包括：

*   一种帮助人们以丰富和可视化的方式定义模型并与之交互的工具
*   一种帮助人们创建和使用文本领域特定语言和数据模型的语言
*   使模型可用于工具和平台组件的关系存储库

[更多信息](http://www.microsoft.com/soa/products/oslo.aspx)

另请参阅：[奥斯陆常见问题解答](http://msdn.microsoft.com/en-us/library/dd129873.aspx)

# c# - 全局成员与传递参数

> ID：355933
> 
> 赞同：3
> 
> 时间：2008-12-10T12:49:09.213
> 
> 标签：c#

我有一个 ASP.NET 项目，其中有一个包含 10 个局部变量的方法。该方法调用了大约 10 个其他方法。3 个被调用的方法需要所有变量。将所有这些变量转换为全局成员是否被认为是一种好习惯，然后它们不必作为参数传递？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-10T12:58:22.520

如果您想传递复杂的状态，请将其打包在一个对象中 - 即

```
public class Foo {
     public string Key {get;set;}
     public decimal Quantity {get;set;}
     // etc
} 
```

并让方法接受这个对象作为参数。然后你只需创建一个 this 的实例并传递它。

全球是一个很大的禁忌。ASP.NET 是高度线程化的——这将是一场噩梦。每个请求的状态是可能的，但有点混乱。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-10T12:57:26.280

这些变量是否相互关联，或者全部关联，或者可能属于几个组？如果是这样，请将它们封装成一个类型。因此，您可能有一半的变量与用户相关，一半与请求的操作相关 - 突然间，您的方法采用 10 个变量只需要 2 个。

让事情全球化几乎总是错误的方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T13:07:57.680

而是创建一个结构并传递结构而不是传递这 10 个参数

例如：

```
public struct user 
{ 
    public string FirstName; 
    public string LastName; 
    public string zilionotherproperties; 
    public bool SearchByLastNameOnly; 
    public datetime date1;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T12:52:45.947

好吧，这完全取决于您所说的“全球成员”是什么意思。

如果，考虑到您正在编写一个 ASP.NET 应用程序，您的意思是基于会话/应用程序的缓存值，那么这取决于。存在性能影响，因此您应该衡量它是否对您的应用程序有任何影响。

如果你的意思是静态变量，那么没有。静态是针对每个应用程序的，因此适用于您的 Web 应用程序的所有用户，而不仅仅是一个人。线程静态也不是一个好主意，因为单个用户在应用程序的生命周期中可能会在线程之间浮动。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-10T13:00:32.483

如果您有真正作用于大量变量的方法，例如您提到的，您还可以考虑设计一个旨在充当数据容器的类。填充后，您可以将类传递给需要数据而不是十个参数的函数。

我不记得确切的例子，但是在微软的“框架设计指南”书中，他们明确地描述了像你这样的场景，以及他们如何在 .NET 框架中遵循相同的方法。

此外，如果您需要传递这么多参数，请退后一步，确保相关代码不需要重构。在某些情况下，一个方法需要大量数据，但我使用长方法签名作为一个标志，我需要查看方法内部以确保它只做它需要做的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T16:34:52.240

请务必注意拳击。如果您要传递 10 种 ref 类型，则取决于个人喜好。

但是，如果您传递 10 种值类型，如果您要将它们声明为类中的成员变量，它们将被装箱，然后它们必须由接收者拆箱。

如果您将它们限制为方法堆栈中的局部变量（作为参数传递），它们将完全保留在堆栈上，而不是被装箱到堆中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-10T16:50:51.690

对于纯粹的机械重构，将值打包在一起（如建议的那样）可能是最好的解决方案。

但是，您有大量的依赖方法，每个方法都作用于公共状态（至少 10 个值）。听起来您应该设计一个类来处理此操作。

该类将封装行为和相关状态，而不是简单的属性包（请参阅[贫血域模型](http://en.wikipedia.org/wiki/Anemic_Domain_Model)）。

# asp.net - 确定谁/什么在 w3wp.exe 中保留了 5.5 GB 的虚拟内存

> ID：355934
> 
> 赞同：8
> 
> 时间：2008-12-10T12:50:05.030
> 
> 标签：asp.net, iis, memory, virtual-memory

在我的机器（XP，64）上，ASP.net 工作进程（w3wp.exe）总是在启动时保留 5.5GB 的虚拟内存。无论它托管的 Web 应用程序如何（它可以是任何东西，甚至是 aspx 中的空网页），都会发生这种情况。

这个大的旧虚拟内存块在进程开始时被保留，所以这不是某种逐渐的内存“泄漏”。

对windbg 的一些窥探表明，内存问题是Private、Reserved 和RegionUsageIsVAD，这表明它可能是调用VirtualAlloc 的人的工作。它还表明，有问题的内存被分配/保留为 4 个大块，每个 1GB 和几个较小的块（每个 1/4GB）。

所以我想我需要弄清楚谁在调用 VirtualAlloc 并保留所有这些内存。我怎么做？

在分配内存之前将调试器附加到进程是很棘手的，因为 w3wp.exe 是由 svchost.exe（即 IIS/ASP.Net 过滤器）启动的进程，如果我尝试自己启动它以调试它它只是在没有所有这些大量内存保留的情况下关闭。此外，如果我重用它们，命令行参数是无效的（这是有道理的，因为它是由调用进程创建的管道）。

我可以在事后将它附加到进程中（这就是我找到有问题的内存区域的方式），但我不确定当时是否有可能确定谁分配了什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T13:17:49.423

David Wang[回答了一个类似的问题](http://blogs.msdn.com/david.wang/archive/2006/02/14/More-on-Virtual-Memory-Memory-Fragmentation-and-Leaks-and-WOW64.aspx#541133)：

> [...] ASP.Net 性能开发人员告诉我：
> 
> *   保留的虚拟内存无需担心。您可以将其视为 CLR 的性能/缓存先决条件。并且重载测试表明这没什么好担心的。
> *   System.Windows.Forms - 它不是由空的 hello world ASPX 页面拉入的。您可以使用 Microsoft 调试工具和“sx e ld system.windows.forms”来确定在运行时实际将其拉入的内容。或者您可以通过 ildasm 找到依赖项。
> *   mscorlib - 确保它是正确的 GAC'd 和 NGen'd。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T12:59:23.127

虚拟内存只是分配给进程的地址空间。它与内存使用无关。

看：

1.  [虚拟内存](http://lwn.net/Articles/253361/)
2.  [突破 Windows 的极限：虚拟内存](http://blogs.technet.com/markrussinovich/archive/2008/11/17/3155406.aspx)
3.  [http://support.microsoft.com/kb/555223](http://support.microsoft.com/kb/555223)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T13:18:34.443

*保留内存与**分配*的内存非常不同。保留内存只是分配地址空间。它不提交任何物理页面。

此地址空间可能由 IIS 为其堆分配。它只会在需要时提交页面。

如果您真的想从 windbg 启动 w3wp.exe，您可能需要使用有效的命令行参数启动它。您可以使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)来确定当前 w3wp.exe 进程的命令行是什么。例如，在我的服务器上，我的是：

> c:\windows\system32\inetsrv\w3wp.exe -a \.\pipe\iisipmeca56ca2-3a28-452a-9ad3-9e3da7b7c765 -t 20 -ap "DefaultAppPool"

我不确定那里的 UID 指定了什么，但看起来它可能是由 W3SVC 服务（这是启动 w3wp.exe 的内容）动态生成的，用于命名那里指定的管道。因此，在从 windbg 启动 w3wp 之前，您绝对应该查看您的命令行。

# ruby-on-rails - 按日期范围过滤 Sphinx 搜索结果

> ID：355937
> 
> 赞同：3
> 
> 时间：2008-12-10T12:50:30.087
> 
> 标签：ruby-on-rails, search, sphinx, thinking-sphinx

我有 Widget.title、Widget.publish_ at 和 Widget.unpublish_ at。这是一个运行着thinking_sphinx 的rails 应用程序，每晚索引一次。我想查找标题中包含“foo”并已发布的所有小部件（发布 _at < Time.now，取消发布 _at > Time.now）。

为了让分页正常工作，我真的想在狮身人面像查询中做到这一点。我有 'has :publish_at, :unpublish_at' 来获取属性，但是 'Widget.search("foo @publish_ at > #{Time.now}",:match _mode=>:extended' 的语法是什么？这是甚至可能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-10T13:25:19.220

是的，很容易，只要确保你在索引中覆盖了时间：

```
class Widget < ActiveRecord::Base
  define_index do
    indexes title
    has publish_at
    has unpublish_at
    ...
  end 
```

为了完全基于日期来拉它，由于 sphinx 需要有界的范围（x..y 而不是 x>=y），因此需要少量的技巧。使用最小值/最大值非常不雅，但目前我不知道有什么好的方法。

```
min_time = Time.now.advance(:years => -10)
max_time = Time.now.advance(:years => 10)
title = "foo"

Widget.search title, :with => {:publish_at => min_time..Time.now, :unpublish_at => Time.now..max_time} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T13:30:36.490

我还没有使用带有导轨的狮身人面像。但这可以通过 Sphinx API 实现。你需要做的是在你的 sphinx.conf 中设置一个 datetime 属性。并且不要忘记在您的索引选择中使用 UNIX_TIMESTAMP(publish_at)、UNIX_TIMESTAMP(unpublish_at)。

# apache-flex - 在 FlexBuilder 中显示所有编译错误？

> ID：355938
> 
> 赞同：0
> 
> 时间：2008-12-10T12:52:18.037
> 
> 标签：apache-flex, compiler-construction, intellij-idea, flexbuilder

是否可以让 FlexBuilder 显示所有文件中的所有编译错误？FlexBuilder 不会在未引用的动作脚本文件中显示错误。我也经常修复一个问题，只是为了在编译整个项目后看到新问题出现，尽管这些错误很久以前就存在了。

IntelliJ 显示了它可以找到的所有编译错误，我希望 FlexBuilder 的行为方式相同，因为 IntelliJ 还不够成熟，无法处理我们的复杂设置。是否有编译器开关来启用此功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T16:51:42.220

编译器可以（并且将）仅在您告诉它编译的代码中显示错误，并且就像您说的那样，您编译的代码中未引用的任何内容都不会被编译，因此由编译器检查。

所以如果你想让编译器检查你的代码的某些部分，你需要告诉它编译它。我不确定您的项目是如何设置的，但我假设您正在编译一堆较小的项目，这些项目都使用共享代码库的不同部分（或类似的东西）。在这种情况下，您可以：

*   设置某种“主”项目来引用你的所有代码，编译它然后检查到处的错误（也许你已经有了这个，在这种情况下，解决方案就是定期编译它）
*   为所有代码编译 AsDoc 文档设置工作/目标——然后您可以定期运行它，同时保持 API 文档是最新的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T22:24:02.283

以下 MXMLC 编译器参数可能有用：

**-包括*类名*[...]**

将一个或多个类链接到输出 SWF，无论它们在编译时是否需要。

**-include-libraries *swcPath* [...]**

将一个或多个 SWC 库的全部内容链接到输出 SWF，无论其类在编译时是否需要。

# vxworks - 如何在 VxWorks 5.5 和 6.x 之间设置兼容的代码环境？

> ID：355939
> 
> 赞同：1
> 
> 时间：2008-12-10T12:52:28.490
> 
> 标签：vxworks

我们有一个现有的 VxWorks 5.5 项目并希望将其移植到 VxWorks 6.6。
VxWorks 6.x 有很多新功能（MMU、RTP 等），我们现在不想使用这些功能，因为这会使移植工作复杂化。

我们如何指定我们想要一个 5.5 兼容的环境？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T12:57:22.647

当你创建你的 VxWorks 项目时，你可以指定 PROFILE_COMPATIBLE 来创建一个 5.5 兼容的环境。

在工作台中，这是在新项目创建对话框中完成的。这是标题为“配置文件”的第三个或第四个对话框屏幕

使用 vxprj 从命令行创建项目时，只需添加“-profile PROFILE_COMPATIBLE”参数。

# visual-c++ - 将 C++ 应用程序从 VC6 移植到 VS2005 后出现链接器错误

> ID：355942
> 
> 赞同：1
> 
> 时间：2008-12-10T12:52:57.663
> 
> 标签：visual-c++, visual-studio-2005, mfc, visual-c++-6

将我的应用程序从 VC6 移植到 Visual Studio 2005 时出现错误。

有谁知道这意味着什么？

> mfcs80.lib(dllmodul.obj)：错误 LNK2005：_DllMain@12 已在 MSVCRT.lib(dllmain.obj) 中定义

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T20:49:15.860

来自[http://support.microsoft.com/default.aspx?scid=kb;en-us;q148652](http://support.microsoft.com/default.aspx?scid=kb;en-us;q148652)

> 当 CRT 库和 MFC 库在 Visual C++ 中以错误的顺序链接时，会出现 LNK2005 错误

因为

> CRT 库对 new、delete 和 DllMain 函数使用弱外部链接。MFC 库还包含 new、delete 和 DllMain 函数。这些函数需要在链接 CRT 库之前链接 MFC 库。

所以

> 有两种方法可以解决此问题。第一个解决方案涉及强制链接器以正确的顺序链接库。第二种解决方案允许您找到导致问题的模块并进行更正。

任何一个

> 强制链接器以正确的顺序链接库
> 
> 1.  在项目菜单上，单击设置。
> 2.  在“项目设置”对话框的“设置”视图中，单击以选择出现链接错误的项目配置。
> 3.  在链接选项卡上，单击以选择类别组合框中的输入。
> 4.  在忽略库框中，插入库名称（例如，Nafxcwd.lib;Libcmtd.lib）。
>     
>     
>     
>     注意 /NOD: 中的链接器命令行等效项。
>     
>     
> 5.  在对象/库模块框中，插入库名称。您必须确保它们按顺序列出，并且作为该行中的前两个库（例如，Nafxcwd.lib Libcmtd.lib）。
> 
> 要在 Visual C++ .NET 中设置此选项，请阅读“设置 Visual C++ 项目属性”联机帮助主题。

或者

> 找到并更正问题模块 要查看当前库链接顺序，请执行以下步骤：
> 
> 1.  在项目菜单上，单击设置。
> 2.  在“项目设置”对话框的“设置”视图中，单击以选择出现链接错误的项目配置。
> 3.  在链接选项卡上，在项目选项框中键入 /verbose:lib。
> 4.  重建你的项目。在链接过程中，库将在输出窗口中列出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-19T11:33:40.967

我确信这可能发生的原因有很多——我发现的最糟糕的一个是在尝试集成一些最初是 DLLS 的静态库（我们的）时（事实上，我们将项目构建为 DLL 和静态图书馆）。

我们的 C++/CLI DLL 正在使用这些库的静态版本（为了避免在使用 C++/CLI Dll 时导致 ASP.NET 加载问题的 DLL 依赖问题）并且最初看到相同的链接器错误。

问题原来是使用 AFX_MANAGE_STATE(AfxGetStaticModuleState()) 宏，当代码构建为 DLL 时需要该宏，但静态库调用实际上不需要该宏。

为了解决这个问题，我最终将以下代码添加到每个项目的 stdafx.h 中。

```
#ifdef OMUTILITIES_LINK_STATIC
    #undef AfxGetStaticModuleState
    #define AfxGetStaticModuleState AfxGetModuleState
#endif 
```

当然，这可能不是您的具体问题。但我最终想到的方法是打开链接器的 /VERBOSE 选项，并查看它在运行时库中拉入的人员、内容、地点和时间。（vs2005中的项目属性/配置属性/链接器/显示进度）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-26T15:06:11.697

您可以将链接器输入设置为忽略项目属性中的麻烦库，但这可能会或可能不会起作用。

# c# - 查找列表中出现次数最多的数字

> ID：355945
> 
> 赞同：30
> 
> 时间：2008-12-10T12:55:29.403
> 
> 标签：c#, linq, list

有没有使用 linq 的快速又好方法？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-12-10T13:05:51.880

怎么样：

```
var most = list.GroupBy(i=>i).OrderByDescending(grp=>grp.Count())
      .Select(grp=>grp.Key).First(); 
```

或在查询语法中：

```
var most = (from i in list
            group i by i into grp
            orderby grp.Count() descending
            select grp.Key).First(); 
```

当然，如果你会重复使用这个，你可以添加一个扩展方法：

```
public static T MostCommon<T>(this IEnumerable<T> list)
{
    return ... // previous code
} 
```

然后你可以使用：

```
var most = list.MostCommon(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-10T13:08:37.910

不确定 lambda 表达式，但我会

1.  排序列表 [O(n log n)]

2.  扫描列表 [O(n)] 找到最长的游程。

3.  再次扫描 [O(n)] 报告具有该运行长度的每个数字。

这是因为可能有不止一个最常出现的数字。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-31T05:01:35.083

取自我[在这里](https://stackoverflow.com/a/16818909/661933)的回答：

```
public static IEnumerable<T> Mode<T>(this IEnumerable<T> input)
{            
    var dict = input.ToLookup(x => x);
    if (dict.Count == 0)
        return Enumerable.Empty<T>();
    var maxCount = dict.Max(x => x.Count());
    return dict.Where(x => x.Count() == maxCount).Select(x => x.Key);
}

var modes = { }.Mode().ToArray(); //returns { }
var modes = { 1, 2, 3 }.Mode().ToArray(); //returns { 1, 2, 3 }
var modes = { 1, 1, 2, 3 }.Mode().ToArray(); //returns { 1 }
var modes = { 1, 2, 3, 1, 2 }.Mode().ToArray(); //returns { 1, 2 } 
```

我在上述方法和[David B's](https://stackoverflow.com/a/356453/661933) `TakeWhile`之间进行了性能测试。

> 源 = { }，迭代 = 1000000
> 我的 - 300 毫秒，大卫的 - 930 毫秒
> 
> 源 = { 1 }，迭代 = 1000000
> 我的 - 1070 毫秒，大卫的 - 1560 毫秒
> 
> 源 = 100+ 具有 2 个重复的整数，迭代 = 10000
> 我的 - 300 毫秒，大卫的 - 500 毫秒
> 
> 源 = 10000 个随机整数，大约有 100 多个重复，迭代 = 1000
> 我的 - 1280 毫秒，大卫的 - 1400 毫秒

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-31T08:45:04.590

这是另一个答案，似乎很快。我认为[Nawfal 的答案](https://stackoverflow.com/a/16850071/659190)通常更快，但这可能会在长序列中遮蔽它。

```
public static IEnumerable<T> Mode<T>(
    this IEnumerable<T> source,
    IEqualityComparer<T> comparer = null)
{
    var counts = source.GroupBy(t => t, comparer)
        .Select(g => new { g.Key, Count = g.Count() })
        .ToList();

    if (counts.Count == 0)
    {
        return Enumerable.Empty<T>();
    }

    var maxes = new List<int>(5);
    int maxCount = 1;

    for (var i = 0; i < counts.Count; i++)
    {
        if (counts[i].Count < maxCount)
        {
            continue;
        }

        if (counts[i].Count > maxCount)
        {
            maxes.Clear();
            maxCount = counts[i].Count;
        }

        maxes.Add(i);
    }

    return maxes.Select(i => counts[i].Key);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T15:22:50.263

有人要求有联系的解决方案。这是一个尝试：

```
int indicator = 0

var result =
  list.GroupBy(i => i)
    .Select(g => new {i = g.Key, count = g.Count()}
    .OrderByDescending(x => x.count)
    .TakeWhile(x =>
    {
      if (x.count == indicator || indicator == 0)
      {
        indicator = x.count;
        return true;
      }
      return false;
    })
    .Select(x => x.i); 
```

# plugins - 为 Thunderbird 或 Zarafa 创建自己的插件？

> ID：355946
> 
> 赞同：3
> 
> 时间：2008-12-10T12:55:45.440
> 
> 标签：plugins, thunderbird

我想增强我的雷鸟（或 zarafa），以便我可以右键单击邮件，并获得一个对话框，我可以在其中填写一些信息（如文章参考、问题编号或发票）并按“发送” ，并且此信息连同电子邮件和（登录的）用户信息将被发送到另一个 Web 服务（即 XML-RPC 调用，但也可以执行其他任何操作），然后处理电子邮件（例如附加发票的内容，问题或文章的内容）？[我需要雷鸟/zarafa 部分]

感谢您的帮助（即使是“不可能”之类的答案）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:31:40.697

使用扩展名应该是很可能的。首先，您应该了解[创建 Thunderbird 扩展](https://developer.mozilla.org/en-US/docs/Mozilla/Thunderbird/Thunderbird_extensions/Building_a_Thunderbird_extension_2:_extension_filesystem)或[创建 Mozilla 扩展](https://developer.mozilla.org/en/docs/Building_an_Extension)的基础知识。

然后您要做的是为上下文菜单创建一个[覆盖](https://developer.mozilla.org/de/docs/Mozilla/Thunderbird/Thunderbird_extensions/Ein_Thunderbird_Addon_programmieren_5:_XUL)，这会添加一个打开您的自定义对话框的菜单项。如果您使用该`openDialog`方法，您可以将其他参数传递给对话框，例如当前选择的消息头 ( `gFolderDisplay.selectedMessage`)。

从那里您可以获取邮件标头， selectedMessage 的类型为[nsIMsgHdr](https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchTerm)。获取消息的正文有点复杂，因为您必须流式传输正文，然后解析 mime 正文，但仍然可以使用[js mime 发射器](http://mxr.mozilla.org/comm-central/source/mailnews/db/gloda/components/jsmimeemitter.js)。正在进行的一些更改可能会在将来使这更容易，因此请仔细检查是否没有更简单的方式来流式传输正文。

有了这些信息，您可以轻松地使用标准方法（即 XMLHttpRequest）将数据发送到 Web 服务。

# crystal-reports - 如何在 Crystal Reports 中显示阿拉伯语数据？

> ID：355950
> 
> 赞同：4
> 
> 时间：2008-12-10T12:56:44.440
> 
> 标签：crystal-reports, arabic

我正在使用 Crystal Reports 10。报表正在从 Oracle 10G 数据库中获取数据。我们有一些阿拉伯语数据。当我尝试显示阿拉伯语数据时，它显示为？。

关于我可以做些什么来正确显示这个的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T13:07:08.867

我从来没有用过水晶报告，我的预言知识有限，但是我用阿拉伯语做了一些工作。需要注意的事项。

数据库是否安装了阿拉伯语言环境，它可以显示从右到左的文本。

在 Windows 下检查语言设置并检查是否安装了包括对从左到右书写系统的支持的选项。

检查您的数据库是国际版本，而不是仅支持拉丁字符集的数据库。可能是 ASCII 和 Unicode 之间的转换存在问题。

阿拉伯字符与您的机器将习惯使用的拉丁字符集不在同一个 ASCII 代码页上，可能有一个特殊版本的水晶报表支持阿拉伯文。

检查您正在运行水晶报告的机器上是否安装了阿拉伯语语言环境/字体。

**更新**

我在网上快速浏览了一下，你可能想看看[这个链接](https://boc.sdn.sap.com/node/1212)

这是一个摘要：

> 这个问题可以在您创建报告时解决，而无需编写任何额外的代码。我没有测试过这个解决方案，因为我没有任何数据来测试它。
> 
> 首先，您要确保您使用的是 UNICODE 字体，我相信您可能已经在这样做了。然后要配置“从右到左”，您可以右键单击任何字段并选择“设置文本格式”或“设置字段格式”。您应该看到一个“段落”选项卡。在那里，您可以将内容设置为“从左到右”或“从右到左”。右侧的按钮允许您根据参数值或类似的值进行此设置。我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-04T17:11:43.107

右键单击字段>格式化对象>段落然后从右到左阅读顺序

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T13:13:17.427

right click on your data base and select properties then select options then change collation to Arabic_CI_AS

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T04:33:27.350

1.  确保您在 Windows 中安装了阿拉伯语支持。
2.  将正确的 LANG 和 NLS_LANG 添加到您的注册表（对我来说是 ARABIC__QATAR.AR8MSWIN1256）

# c# - C# 编程的 XML 注释技巧

> ID：355957
> 
> 赞同：15
> 
> 时间：2008-12-10T12:58:29.960
> 
> 标签：c#, documentation, documentation-generation, sandcastle, xml-comments

早上好，下午，晚上或晚上（取决于您的时区）。

这只是关于 C# 中 XML 注释的一般问题。我从来没有非常热衷于评论我的程序，我一直是一个冗长的变量/属性/方法命名器，让代码自己说话。如果我正在编写相当混乱的代码，我会写评论，但在大多数情况下，我不会写很多评论。

我正在阅读 .NET、Sandcastle 中的 XML 注释和 codeplex 上的帮助文件生成器，它让我走上了想要记录我的代码并为那些必须深入研究我的人生成一些很好、有用的文档的道路。当我不再在这里时的代码。

我的问题是关于标准和约定的。是否有“好的”XML 注释指南？你应该评论每一个变量和属性吗？每种方法？我基本上只是在寻找有关如何编写好的注释的提示，这些注释将由 sandcastle 编译成好的文档，这样其他程序员在最终不得不处理我的代码时就不会诅咒我的名字。

提前感谢您的意见和建议，Scott Vercuski

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-10T13:18:22.587

就个人而言，我们确保每个公共和受保护的方法都有 XML 注释。它还将为您提供 Intellisense，而不仅仅是最终用户帮助文档。过去，我们也将它包含在私有范围的声明中，但不认为它是 100% 必需的，只要方法简短且准确即可。

不要忘记有一些工具可以让您更轻松地完成 XML 注释任务：

*   [GhostDoc](http://www.roland-weigelt.de/ghostdoc/) - 注释继承和模板加载项。
*   [Sandcastle 帮助文件生成器](http://www.codeplex.com/SHFB)- 通过 GUI 编辑 Sandcastle 项目，可以从命令行运行（用于构建自动化），并且可以编辑 MAML 以获得不是从代码派生的帮助主题。（1.8.0.0 alpha版本很稳定，也有很大改进，用了一个月左右，超过1.7.0.0）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-21T20:24:15.550

评论经常过时。这一直是个问题。我的经验法则：更新评论所需的工作越多，评论过时的速度就越快。

XML 注释非常适合 API 开发。它们与 Intellisens 配合得非常好，它们可以让您立即生成 HTML 帮助文档。

但这不是免费的：维护它们会很困难（看看任何重要的例子，你就会明白我的意思），所以它们很快就会过时。因此，**审查 XML 注释应作为强制性检查添加到您的代码审查中，**并且每次更新文件时都应执行此检查。

好吧，由于维护起来很昂贵，因为许多非私有符号（在非 API 开发中）仅由 1 或 2 个类使用，而且由于这些符号通常是不言自明的，我永远不会强制执行这样的规则每个非私有符号都应该是 XML 注释的。**这将是矫枉过正和适得其反**。您将得到的是我在很多地方看到的：几乎是空的 XML 注释，对符号名称没有添加任何内容。以及可读性差的代码......

我认为关于普通（非 API）代码中注释的**非常非常重要的指导方针不应该是关于****它们应该如何编写**，而是关于**它们应该包含什么**。许多开发人员仍然不知道该写**什么。**对应该注释的内容的描述以及示例对您的代码来说会比简单的：“Do use XML Comments on each non-private symbole.”更好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T13:31:09.147

我记录了公共类和这些类的公共/受保护成员。

我不记录私人或内部成员或内部类。因此变量（我认为您的意思是字段）因为它们是私有的。

目标是为无法访问源代码的开发人员创建一些文档。

努力举一些用法不明显的例子。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T13:18:55.660

我很少评论方法变量，同样很少评论字段（因为它们通常被属性覆盖，或者如果使用自动实现的属性则根本不存在）。

一般来说，我会努力为所有公共/受保护的成员添加有意义的评论，这很方便，因为如果您在构建期间打开 xml 评论，您会收到缺少评论的自动警告。根据复杂性，我可能不会填写每个细节 - 即，如果每个参数*必须*做什么是 100% 明显的（即没有特殊的逻辑，并且只有一种解释变量的逻辑方式），那么我*可能*变得懒惰，不要添加有关参数的注释。

但我当然会尝试描述什么方法、类型、属性等代表/做什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T13:35:38.717

我们在我们的库中记录公共方法/属性/等。作为构建过程的一部分，我们使用 NDoc 创建类似 MSDN 的 Web 参考。这对于快速参考和查找非常有帮助。

这对 Intellisense 也非常有用，尤其是对于新团队成员，或者就像你说的，当原作者离开时。

我同意代码通常应该是不言自明的。对我来说，XML 文档更多的是关于在您没有打开源代码时的参考和查找。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-12T11:44:04.393

我个人的看法是避免评论。评论很危险。因为在行业中我们总是更新代码（因为业务和需求总是在变化），但我们很少更新我们的评论。这可能会误导程序员。

# c++ - 如何检测 Asio 库的死锁？

> ID：355958
> 
> 赞同：1
> 
> 时间：2008-12-10T12:58:50.740
> 
> 标签：c++, boost, boost-asio

我对 boost::asio 库没什么问题。我的应用程序异步接收和处理数据，它创建线程并在每个线程上运行 io_service.run()。

```
boost::asio::io_service io;
boost::thread_group thread_pool;
...
int cpu_cnt = get_cpu_count();
for (int i = 0; i < cpu_cnt; ++i)
{
    thread_pool.create_thread( boost::bind(&run_service, &io) );
}

void run_service(boost::asio::io_service* io)
{
    try
    {
        io->run();//make fun
    }
    catch(const std::exception& e)
    { //process error
    }
    catch(...)
    { //process error
    }
} 
```

一次又一次，我的应用程序从某个主管应用程序接收消息（通过 Windows 消息传递系统），该应用程序检查我的程序是否处于活动状态。如果我的应用程序没有回复，它将重新启动。这里棘手的部分是检查线程是否正在运行并且没有死锁。我可以像这样将处理程序发布到 io_service：

```
io.post( &reply_to_supervisor ); 
```

但这种方法只影响一个线程。如何检查所有线程是否正在运行并且没有死锁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T14:51:12.433

我可能错了，但是每个线程使用 io_service 会解决您的问题吗？

另一个想法：发布`cpu_cnt`时间`reply_to_supervisor`调用使用一点`sleep()`- 不好，但应该工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T15:38:41.233

[这让我觉得是Halting Problem](http://en.wikipedia.org/wiki/Halting_problem)的一个实例，但由于您似乎在 Windows 上，您可能想查看 Just Software Solution 的[just::thread](http://www.stdthread.co.uk/)库。它是草案 C++0x 线程库的实现，并在其自己的互斥锁中内置了死锁检测。

最终，尽管您最好在[asio 邮件列表](http://tenermerx.com/Asio/MailingList)上提出这个问题。该库的作者非常有帮助，他或其他一些铁杆 asio 用户可能能够在那里提供更好的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T17:23:19.787

我将假设您的 io->run() 执行某种循环来等待 asio 完成。我还将假设您对此 asio 操作有超时。一种肮脏的检查方法是运行状态线程并检查 asio 线程是否已在等待 asio 完成时超时或是否已发布 asio 事件。无论哪种方式，您都会设置某种变量或句柄来知道您的线程是“活动的”并且正在循环。然后，您的状态线程将检查每个变量/句柄并在检查后重置它们。

请注意，我敢肯定还有其他方法，但这是我现在想到的...... =）

# c# - 如何使用 C# 在 Visual Studio 2008 中获取当前编辑器

> ID：355963
> 
> 赞同：1
> 
> 时间：2008-12-10T13:00:12.407
> 
> 标签：c#, visual-studio-2008, add-in

我正在用 C# 为 VS 2008 编写插件，我想知道打开了哪种编辑器/设计器“范围”（例如 VS 编辑器/VB 编辑器“）。我可以捕捉范围更改的事件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T13:35:00.427

我现在不能尝试，所以要加一粒盐：

```
public class Connect : IDTExtensibility2, IDTCommandTarget
{
    public void OnConnection( object application, ext_ConnectMode connectMode, 
        object addInInst, ref Array custom )
    {
        _applicationObject = ( DTE2 ) application;
        _applicationObject.Events.SelectionEvents.OnChange += SelectionEvents_OnChange;
    }

    void SelectionEvents_OnChange()
    {
        vsWindowType type = _applicationObject.ActiveWindow.Type;
        // switch (type) { ... }
    }
} 
```

编辑：也许选择事件不是你需要的。我不知道是否还有其他可以挂钩的事件。反正线

```
vsWindowType type = _applicationObject.ActiveWindow.Type; 
```

告诉您当前活动窗口的类型。

# c - 如何使用 MSVC 内在函数来获得此 GCC 代码的等效项？

> ID：355967
> 
> 赞同：19
> 
> 时间：2008-12-10T13:00:57.177
> 
> 标签：c, visual-c++, intrinsics

以下代码在 GCC 中调用 clz/ctz 的内置函数，并且在其他系统上具有 C 版本。显然，如果系统具有内置的 clz/ctz 指令，如 x86 和 ARM，则 C 版本有点不理想。

```
#ifdef __GNUC__
#define clz(x) __builtin_clz(x)
#define ctz(x) __builtin_ctz(x)
#else
static uint32_t ALWAYS_INLINE popcnt( uint32_t x )
{
    x -= ((x >> 1) & 0x55555555);
    x = (((x >> 2) & 0x33333333) + (x & 0x33333333));
    x = (((x >> 4) + x) & 0x0f0f0f0f);
    x += (x >> 8);
    x += (x >> 16);
    return x & 0x0000003f;
}
static uint32_t ALWAYS_INLINE clz( uint32_t x )
{
    x |= (x >> 1);
    x |= (x >> 2);
    x |= (x >> 4);
    x |= (x >> 8);
    x |= (x >> 16);
    return 32 - popcnt(x);
}
static uint32_t ALWAYS_INLINE ctz( uint32_t x )
{
    return popcnt((x & -x) - 1);
}

#endif 
```

我需要调用哪些函数，需要包含哪些标头等，以便在此处为 MSVC 添加适当的 ifdef？我已经看过[这个页面](https://msdn.microsoft.com/en-us/library/wfd9z0bb.aspx)，但我不完全确定 #pragma 的用途（是否需要？）以及它对 MSVC 版本编译要求的限制。作为一个不真正使用 MSVC 的人，我也不知道这些内在函数在其他架构上是否具有 C 等价物，或者在 #defining 它们时我是否也必须 #ifdef x86/x86_64。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-12-09T10:23:48.750

从 sh0dan 代码中弹起，应该像这样更正实现：

```
#ifdef _MSC_VER
#include <intrin.h>

uint32_t __inline ctz( uint32_t value )
{
    DWORD trailing_zero = 0;

    if ( _BitScanForward( &trailing_zero, value ) )
    {
        return trailing_zero;
    }
    else
    {
        // This is undefined, I better choose 32 than 0
        return 32;
    }
}

uint32_t __inline clz( uint32_t value )
{
    DWORD leading_zero = 0;

    if ( _BitScanReverse( &leading_zero, value ) )
    {
       return 31 - leading_zero;
    }
    else
    {
         // Same remarks as above
         return 32;
    }
}
#endif 
```

如代码中所述，如果值为 0，则 ctz 和 clz 都是未定义的。在我们的抽象中，我们固定`__builtin_clz(value)`为`(value?__builtin_clz(value):32)`但它是一个选择

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T17:33:21.667

如果 MSVC 有一个内在的编译器，它会在这里：

[MSDN 上的编译器内在函数](https://msdn.microsoft.com/en-us/library/26td21ds.aspx)

否则，您必须使用 __asm 编写它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-05-03T16:35:40.763

1.  MSVC 中**int __builtin_ctz (unsigned int x)**的等效函数是**unsigned int _tzcnt_u32 (unsigned int a)**用于*32 位*整数并返回尾随零的计数。对于*64 位*使用**unsigned __int64 _tzcnt_u64 (unsigned __int64 a)** [1](https://software.intel.com/sites/landingpage/IntrinsicsGuide/#text=_tzcnt_u&expand=5972)。

2.  MSVC 中**int __builtin_clz (unsigned int x)**的等效函数是**unsigned int _lzcnt_u32 (unsigned int a)**用于*32 位*整数并返回前导零的计数。对于*64 位*使用**unsigned __int64 _lzcnt_u64 (unsigned __int64 a)** [2](https://software.intel.com/sites/landingpage/IntrinsicsGuide/#text=_lzcnt_u&expand=5972,3504)

C++ 头文件：immintrin.h

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-10-17T02:07:39.203

我在韩国网站[https://torbjorn.tistory.com/317](https://torbjorn.tistory.com/317)中找到它， 在 msvc 编译器中，您可以在 gcc 编译器中使用`__lzcnt(unsigned int)`替换。`__builtin_clz(unsigned int)`

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2014-09-13T12:17:42.713

在 linux 和 windows (x86) 上测试：

```
#ifdef WIN32
    #include <intrin.h>
    static uint32_t __inline __builtin_clz(uint32_t x) {
        unsigned long r = 0;
        _BitScanReverse(&r, x);
        return (31-r);
    }
#endif

uint32_t clz64(const uint64_t x)
{
    uint32_t u32 = (x >> 32);
    uint32_t result = u32 ? __builtin_clz(u32) : 32;
    if (result == 32) {
        u32 = x & 0xFFFFFFFFUL;
        result += (u32 ? __builtin_clz(u32) : 32);
    }
    return result;
} 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2011-03-29T06:44:51.343

有两个内在函数“_BitScanForward”和“_BitScanReverse”，它们适用于 MSVC 的相同目的。包括 。功能是：

```
#ifdef _MSC_VER
#include <intrin.h>

static uint32_t __inline ctz( uint32_t x )
{
   int r = 0;
   _BitScanReverse(&r, x);
   return r;
}

static uint32_t __inline clz( uint32_t x )
{
   int r = 0;
   _BitScanForward(&r, x);
   return r;
}
#endif 
```

有等效的 64 位版本“_BitScanForward64”和“_BitScanReverse64”。

在这里阅读更多：

[MSDN 上的 x86 内部函数](https://msdn.microsoft.com/en-us/library/hd9bdb82(v=vs.100).aspx)

# mysql - 'LOAD DATA INFILE' 在基于语句的复制中如何工作？

> ID：355969
> 
> 赞同：6
> 
> 时间：2008-12-10T13:01:34.680
> 
> 标签：mysql, replication, load-data-infile

在 MySQL 中，使用基于语句的复制，我假设每个 SQL 语句在从属服务器上的执行方式与在主服务器上的执行方式完全相同。但是，当我运行语句时：

```
LOAD DATA INFILE 'filename' INTO SomeTable; 
```

我不确定该文件是否需要以与主服务器相同的方式存在于从服务器上。有人可以指点我这个功能的文档吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T17:11:09.263

您在主服务器上加载的文件似乎是`LOAD DATA INFILE`通过复制日志从主服务器自动传输到副本的。`LOAD DATA INFILE`当副本到达基于语句的复制队列中时，它会加载这些文件。

我从文档中的几个陈述中推断出这一点：

16.1:[备份复制从站](http://dev.mysql.com/doc/refman/5.0/en/backup.html)

> 如果你的 MySQL 服务器是从属复制服务器，那么无论你选择哪种备份方式，在备份从属数据时，你还应该备份 master.info 和 relay-log.info 文件。恢复从属数据后，始终需要这些文件来恢复复制。如果您的从站需要复制 LOAD DATA INFILE 命令，您还应该备份 --slave-load-tmpdir 选项指定的目录中可能存在的任何 SQL_LOAD-* 文件。

16.1.2.3：[复制从属选项和变量](http://dev.mysql.com/doc/refman/5.0/en/replication-options-slave.html)

> 当从 SQL 线程复制 LOAD DATA INFILE 语句时，它会将要加载的文件从中继日志中提取到临时文件中，然后将这些文件加载​​到表中。如果 master 上加载的文件很大，slave 上的临时文件也很大。因此，建议使用此选项来告诉从属设备将临时文件放在位于某个文件系统中的目录中，该目录位于具有大量可用空间的文件系统中。在这种情况下，中继日志也很大，因此您可能还想使用 --relay-log 选项将中继日志放置在该文件系统中。

# ruby-on-rails - 有没有办法在部分内部运行视图

> ID：355971
> 
> 赞同：1
> 
> 时间：2008-12-10T13:03:47.173
> 
> 标签：ruby-on-rails, ruby

我知道这很奇怪。但我想不出其他方法来做我需要的事情。我有一个控制器：报告和一个视图：报告。此外，我还有一个充当仪表板的视图，我可以在其中看到多个区域（部分）。我需要将此报告视图添加到我的仪表板，但不知道如何。此报告视图利用来自控制器的复杂逻辑并显示结果。我怎么能将现有视图（报告）的（逻辑+表示）“卡”到我的部分中，所以我可以在我的仪表板上使用它？

谢谢你。阀门。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T14:44:45.597

（我希望我理解这个问题，在这里......）

这部分似乎很重要：

> 此报告视图利用来自控制器的复杂逻辑

作为一般规则，控制器应该很简单。真的很简单。经验法则是“瘦控制器，胖模型”（Rails Envy 就该[主题制作了一些有趣但有用的截屏视频](http://www.railsenvy.com/2008/6/3/mvc-videos)）

如果您创建了一个新模型（很可能不是从 ActiveRecord::Base 继承），它封装了您想要传递到部分的逻辑，会发生什么？然后不同的控制器/动作组合可以根据需要/需要将信息传递到您的视图中。

还是我完全错过了重点（并非不可能！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T13:36:47.667

不久前，当他们弃用 render_controller 时，我遇到了类似的问题。我当时找到的唯一解决方案是使用 ajax，将参数传递给要加载的页面，绕过布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T06:39:07.683

如果我没记错的话，你可以做一个render_component，但现在这完全不受欢迎。

这是解决问题的最简单方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T21:51:43.420

我建议从报表控制器重构代码（如果这是包含“复杂”逻辑的代码）并将其放入仪表板和报表视图可以使用的包装类中。

# java - 使用会话 bean 时出现 JSF 内存使用问题

> ID：355975
> 
> 赞同：1
> 
> 时间：2008-12-10T13:05:35.407
> 
> 标签：java, jsf, jakarta-ee

我正在开发一个具有导航树的应用程序，该导航树是会话 bean。每次我调用包含此 bean 的页面时，我的内存使用量都会增加。然而，经过几个小时的不活动，内存仍然没有被释放。是否有任何想法为什么会发生这种情况或解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T14:35:46.753

您可以在部署描述符中显式设置会话超时，或者以编程方式进行（尽管您可能不想在 JSF 应用程序中这样做）。

最终，这是由容器控制的——服务器管理何时释放资源，而不管逻辑到期设置如何。

您可以使用侦听器帮助诊断正在发生的事情。例如，您可以让您的 bean 类实现[HttpSessionBindingListener](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpSessionBindingListener.html)。在会话中添加或删除它时会收到通知。或者，您可以使用[HttpSessionAttributeListener](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpSessionAttributeListener.html)来查看所有会话事件（JSF 可以使用会话来管理视图状态，因此请期待一些您自己没有定义的条目）。HttpSessionAttributeListener 在 web.xml 中定义：

```
<listener>
    <display-name>MyListener</display-name>
    <listener-class>
        somepackage.MySessionDiagnosticListenerImpl
    </listener-class>
</listener> 
```

* * *

如果您只是让服务器处于非活动状态，则可能只是它依赖其他会话请求来触发过期会话清理，并且您正在观察实现细节。或者您可能正在泄漏内存，因为您在某个非托管类中设置了对该对象的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T15:14:16.380

您确实需要使用分析器来了解 Java 应用程序中的内存情况。日食分析器非常好。

如果它是一个会话 bean，则不应为同一会话内页面上的每次点击实例化它。

您还必须记住，GC 不会立即收集类。而且GC不一定依赖于时间。

# logging - 分析 log4net 日志的工具

> ID：355976
> 
> 赞同：2
> 
> 时间：2008-12-10T13:05:38.307
> 
> 标签：logging, statistics, log4net

是否有可用于分析 log4net 日志的工具。

特别是我想通过线程ID提取两个方法调用并分析两者之间的持续时间，以创建一些调用持续时间的统计信息。

再加上多个（100x10Mb）文件。

我想*grep*也会这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T13:09:11.607

好吧，这可能是一个坏答案，也可能不是一个坏答案，但是当您使用 log4j 时，有一个名为 Chainsaw（用 Java 编写）的工具，您可以使用它来过滤和检查类似 log4j 的日志文件。

注意：您可能需要参考这篇文章来配置电锯来读取您的日志文件文件：

[http://wiki.apache.org/logging-log4j/Configuring_a_log4j_RollingFileAppender_with_Chainsaw](http://wiki.apache.org/logging-log4j/Configuring_a_log4j_RollingFileAppender_with_Chainsaw)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T11:42:46.507

如果您使用的是 XML 日志格式。您可以处理日志文件。使用 xpath 提取所需的详细信息。但是你会自己写一个小应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T11:56:01.223

如果您使用 XML 日志，您可以编写一个 XSL 样式表并从 XML 中引用它。然后，您只需将浏览器指向 XML，它就会使用您的 XSL 样式表为 XML 设置样式，以便您以 HTML 格式查看数据（或其他任何东西，XSL 非常强大）。

# wpf - 具有数据绑定支持的 WPF 对接管理器

> ID：355978
> 
> 赞同：1
> 
> 时间：2008-12-10T13:06:01.067
> 
> 标签：wpf, data-binding, binding, controls, docking

有谁知道像 Visual Studio for WPF 这样的停靠控件，其中支持窗格的数据绑定？我尝试了 Infragistics 和 Actipro 的 DockManager，但他们缺乏这种支持。例如，内容的窗格需要通过数据绑定进行绑定，因此删除绑定另一侧的实体也会将其从 DocumentHost 中删除。

任何想法？或者任何控件的轻量级解决方法？每个控件的完整数据绑定支持对我的项目至关重要。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T19:27:39.673

You might consider [AvalonDock on Codeplex](http://www.codeplex.com/AvalonDock/). If it doesn't have the functionality you are looking for you can add it yourself since you get full source code!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-25T13:57:39.320

我知道这对原始海报没有帮助，但如果其他人遇到类似问题，有一篇[博客文章](http://blogs.infragistics.com/blogs/andrew_smith/archive/2010/01/12/itemssource-for-xamdockmanager-elements.aspx)，其中包含使用附加属性在 Infragistics XamDockManager 中实现绑定支持的示例。

# linq - 如何将 null 传递给 linq 中的 int 列

> ID：355986
> 
> 赞同：1
> 
> 时间：2008-12-10T13:09:24.913
> 
> 标签：linq, int, nullable

我们如何将空值分配给 LINQ 中的 int 列。例如。

```
 SQLDBDataContext sqlD = new SQLDBDataContext();
 var result = from p in sqlD.loadsRadius(Convert.ToInt32(Request["radius"]), ..... 
```

此处如果 Request["radius"] 为 null 则给出错误。

我可以通过这个传递 0，但我需要更改许多已经存在的程序。

提前致谢。
[阿尼尔](http://www.ade-technologies.com)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T05:34:42.413

您需要将 int 设置为 null，例如：

```
var result = from p in sqlD.loadsRadius(string.IsNullOrEmpty(Request["radius"]) ? (int?)null : int.Parse(Request["radius"]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T13:58:23.647

如果异常是 FormatException，我的猜测是 Request["radius"] 返回的值实际上是字符串“null”。如果 Request["radius"] 实际上返回 null，则 Convert.ToInt32() 将返回零。您可以尝试使用 int.TryParse() 来避免异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T14:09:18.757

正如 Codechef 所建议的那样。

```
int radius = -1;
int.TryParse(Request["radius"],out radius)
if(radius > 0) // you can remove this clause if you don't want this
{
SQLDBDataContext sqlD = new SQLDBDataContext();
 var result = from p in sqlD.loadsRadius(radius)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T14:35:21.467

查看可空类型：[这里。](http://blogs.msdn.com/ericgu/archive/2004/05/27/143221.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T05:34:14.787

你可以用[？？像这样的运算符](http://msdn.microsoft.com/en-us/library/ms173224.aspx)：

```
Convert.ToInt32(Request["radius"] ?? "0") 
```

如果 Request["radius"] 等于 null，它将返回 "0"。

# windows - 使用 cmd.exe 时如何处理引号字符

> ID：355988
> 
> 赞同：65
> 
> 时间：2008-12-10T13:10:23.663
> 
> 标签：windows, command-line

我正在尝试这样做：

```
cmd.exe /C "C:\Program Files\Somewhere\SomeProgram.exe" > "C:\temp\Folder Containing Spaces\SomeProgram.out" 
```

但是，我遇到的问题取决于 cmd.exe 的工作方式。如果您阅读了它的帮助，它会以特殊方式处理 " 字符。请参阅问题末尾的帮助。所以，这不能正确执行......我猜 cmd.exe 去掉了一些引号，这使得陈述格式错误。

我可以成功地做到这一点：

```
// quotes not required around folder with no spaces
cmd.exe /C "C:\Program Files\Somewhere\SomeProgram.exe" > C:\temp\FolderWithNoSpaces\SomeProgram.out 
```

但是，我真的需要第一个工作。cmd.exe 使用的奇怪报价处理是否存在？我希望它保留所有引号，但似乎没有一个选项可以让它这样做。

* * *

**从以下输出中获取帮助： cmd /?**

如果指定了 /C 或 /K，则切换后的命令行的其余部分作为命令行处理，其中使用以下逻辑处理引号 (") 字符：

```
1\.  If all of the following conditions are met, then quote characters
    on the command line are preserved:

    - no /S switch
    - exactly two quote characters
    - no special characters between the two quote characters,
      where special is one of: &<>()@^|
    - there are one or more whitespace characters between the
      the two quote characters
    - the string between the two quote characters is the name
      of an executable file.

2\.  Otherwise, old behavior is to see if the first character is
    a quote character and if so, strip the leading character and
    remove the last quote character on the command line, preserving
    any text after the last quote character. 
```

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-12-10T13:21:31.380

啊。多哈。认为我已经回答了我自己的问题。

如果您使用 /S，并将整个内容用引号括起来，它只会删除那些外部引号。

```
cmd.exe /S /C " do what you like here, quotes within the outermost quotes will be preserved " 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-18T18:36:38.147

我想您会发现您的示例完全可以正常工作。

```
cmd.exe /C "C:\Program Files\Somewhere\SomeProgram.exe" > "C:\temp\Folder Containing Spaces\SomeProgram.out" 
```

* * *

我在这里转载了你的例子 [http://pastebin.com/raw.php?i=YtwQXTGN](http://pastebin.com/raw.php?i=YtwQXTGN)

```
C:\>cmd /c "c:\Program Files\my folder\my long program.exe" > "c:\temp\spaces are here\a.a"

C:\>type "c:\temp\spaces are here\a.a"
my long program.exe has run

C:\>

further example demonstrating it works with "my long program.exe", removing cmd /c, it operates fine too.

C:\>"c:\Program Files\my folder\my long program.exe" > "c:\temp\spaces are here\
a.a"

C:\>type "c:\temp\spaces are here\a.a"
my long program.exe has run

C:\>

Another example, but with replace.  replace with no parameters says "source path required"  "no files replaced"

C:\>replace > a.a
Source path required

C:\>type a.a
No files replaced

Exactly the same effect when they're in folders with spaces.

C:\>cmd /c "c:\Program Files\my folder\replace.exe" > "c:\temp\spaces are here\r.r"
Source path required

C:\>type "c:\temp\spaces are here\r.r"
No files replaced

C:\>

further demonstration with replace
without cmd /c works fine too.

C:\>"c:\Program Files\my folder\replace.exe" > "c:\temp\spaces are here\r.r"
Source path required

C:\>type "c:\temp\spaces are here\r.r"
No files replaced

C:\> 
```

* * *

您的示例运行良好的原因

```
cmd.exe /C "C:\Program Files\Somewhere\SomeProgram.exe" > "C:\temp\Folder Containing Spaces\SomeProgram.out" 
```

以及它如何/为什么以它的方式工作，是因为 > 被 host.exe 解释为特殊所以这部分`cmd.exe /C "C:\Program Files\Somewhere\SomeProgram.exe"`- 我认为 - 首先被评估。即 cmd /c 看不到 > 和之后。

命令/？显示 2 个案例

案例 1 和案例 2。您的示例适合案例 1

```
If /C or /K is specified, then the remainder of the command line after
the switch is processed as a command line, where the following logic is
used to process quote (") characters:

    1\.  If all of the following conditions are met, then quote characters
        on the command line are preserved:

        - no /S switch
        - exactly two quote characters
        - no special characters between the two quote characters,
          where special is one of: &<>()@^|
        - there are one or more whitespace characters between the
          two quote characters
        - the string between the two quote characters is the name
          of an executable file.

    2\.  Otherwise, old behavior is to see if the first character is
        a quote character and if so, strip the leading character and
        remove the last quote character on the command line, preserving
        any text after the last quote character. 
```

您可以测试您的示例是否适合案例 1，因为如果您添加 /s（除了添加 /s 之外，不添加任何引号或对示例进行任何更改），那么您会得到不同的结果，因为它使您的示例命中案例 2。因此证明您的示例绝对是案例 1。它显然符合案例 1 的所有标准。如果您的示例是案例 2，并且您添加了 /s，那么它没有区别.

您的回答很有趣，因为它显示了获得结果的另一种方法，但在情况 2 中。通过添加额外的外部引号并添加 /s。

但实际上，当您添加这些额外的外引号时，您只是将其设置为案例 2，并且在此基础上添加 /s 不会有任何区别。

```
C:\>cmd /c "c:\Program Files\my folder\replace.exe"
Source path required
No files replaced

C:\>cmd /s /c "c:\Program Files\my folder\replace.exe"
'c:\Program' is not recognized as an internal or external command,
operable program or batch file.

C:\>cmd /c ""c:\Program Files\my folder\replace.exe""
Source path required
No files replaced

C:\>cmd /s /c ""c:\Program Files\my folder\replace.exe""
Source path required
No files replaced

C:\> 
```

* * *

您问题中的示例运行良好

```
cmd.exe /C "C:\Program Files\Somewhere\SomeProgram.exe" > "C:\temp\Folder Containing Spaces\SomeProgram.out" 
```

您提供的替代方案（带有 /S 和外引号）作为使示例工作的答案，也可以正常工作

```
cmd.exe /S /C ""C:\Program Files\Somewhere\SomeProgram.exe" > "C:\temp\Folder Containing Spaces\SomeProgram.out"" 
```

尽管您的答案是另一种选择，但实际上可以通过删除 /S 来简化，因为它已经是案例 2，因此添加 /s 不会有任何区别。因此，这将改善您的答案中给出的解决方案

```
cmd.exe /C ""C:\Program Files\Somewhere\SomeProgram.exe" > "C:\temp\Folder Containing Spaces\SomeProgram.out"" 
```

您在问题中描述为问题的示例以及您的解决方案产生了相同的良好结果。但是我想有一个很大的区别（我不确定如何测试它），但是你的例子的工作方式和你的答案中的解决方案的工作方式有一个区别，我认为在你的例子中，托管/调用 cmd.exe 重定向到文件。而在您的解决方案示例中，调用的 cmd.exe 通过主机 cmd.exe 传递 >，因此调用的 cmd.exe 执行重定向。当然，您的示例是案例 1，而您的解决方案是您所做的修改（非常好）以使其适用于案例 2。

我希望我没有在这里犯错，我可能有。但是您的问题和回答确实帮助我了解了 cmd 尤其是 cmd /c 是如何工作的！

也许您的示例过于简化了您的实际示例，而您的实际示例确实失败了，需要您进行修改。如果您的示例案例稍微复杂一点，例如，通过为程序提供一个带引号的参数，那么案例 1 将失败，您确实需要外引号（/S 不会改变结果，所以不需要 /S ，因为一旦添加了那些需要的外引号，它就已经是案例 2 了）。但是你在你的问题中给出的例子在我看来实际上工作正常。

**已添加**- 一个相关的 Q 和 A [`cmd /s` 是做什么用的？](https://stackoverflow.com/questions/9866962/what-is-cmd-s-for)

# domain-driven-design - 领域驱动设计与仅使用规范有何不同？

> ID：355990
> 
> 赞同：3
> 
> 时间：2008-12-10T13:11:47.297
> 
> 标签：domain-driven-design, specifications

我读到域驱动设计是关于专注于问题域而不是专注于软件。他们说解决问题领域的复杂性比解决软件的复杂性更容易，因为在解决了领域之后，您也更了解如何构建软件。他们还说，实际上域比软件的结构更复杂，或者如果你从树林里看不到森林，你就有麻烦了。

但是领域驱动设计与仅使用软件规范有何不同？我的意思是，我们当然应该在开始编码之前了解问题域。DDD 是在重新发明轮子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T13:20:36.063

领域驱动设计更多的是建立一个您和领域专家都可以使用的世界通用模型（以及相关的通用语言）。

从理论上讲，这意味着开发人员可以编写读起来像问题域描述的代码，而领域专家可以越过开发人员的肩膀，看看发生了什么。

规范没有对通用语言或世界模型做出这样的承诺，它只是说“我们将构建特定的东西”。您提出的高度指定的类模型可能有效，但它可能不能特别好地反映“现实”。

[这里有一本关于领域驱动设计的](http://www.infoq.com/minibooks/domain-driven-design-quickly)好书（不幸的是需要登录）。

# web-applications - 合并 2 个 GetText 文件

> ID：355994
> 
> 赞同：10
> 
> 时间：2008-12-10T13:14:03.190
> 
> 标签：web-applications, gettext

我有两个中型 Web 应用程序，我将它们合并为一个。它们都是本地化的`GetText`并且有大量的公共字符串，所以手动合并它们会非常烦人。合并这两个`PO`文件的最快方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-10-04T04:24:10.183

`msgcat`仅用于此目的：它连接和合并 PO 文件。 `msgmerge`用于将 PO 文件与更新的 POT 文件合并。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T13:17:38.970

我敢肯定`msgmerge`会被迫这样做。（我的意思是，连接你的两个 .po 文件，然后让它解决问题。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T13:25:50.590

“WinMerge”会很有帮助*