# StackOverflow 问答 10366000-10366999

# php - 菜单项之间的尴尬差距。怎么修？

> ID：10366000
> 
> 赞同：-2
> 
> 时间：2012-04-28T17:46:37.857
> 
> 标签：php, html, css

我正在制作的网站布局有问题。我对 CSS 不是很好。

所以我遇到的麻烦是我想要一个水平菜单栏，我想在我的网站中居中。此菜单可以有下拉子级。

实现是在 jQuery 中。这是我的菜单栏的 HTML 代码：

```
<ul class='dropdown'>
    <li><a href='index.php'>Home</a></li>
    <li><a href='#'>Incident</a>
        <ul class='sub_menu'>
            <li><a href='index.php?action=new'>New</a></li>
            <li><a href='index.php?action=edit'>Edit</a></li>
            <li><a href='index.php?action=manage'>Manage</a></li>
        </ul>
    </li>
    <li><a href='action_logout.php'>Log out</a></li>
</ul> 
```

这是正在实施的CSS：

```
*                                   { margin: 0; padding: 0; }
body                                { font: 14px Helvetica, Sans-Serif; margin: 15px; } 
a                                   { text-decoration: none; }
ul                                  { width: 800px; list-style: none; text-align: center; margin: auto; padding: 2px 2px;}
p                                   { margin: 15px 0; }
/* 
    LEVEL ONE
*/
ul.dropdown                         { position: relative; }
ul.dropdown li                      { display: inline; font-weight: bold; background: #ccc; padding: 2px 2px; border-bottom: 1px solid #777; }
ul.dropdown a:hover              { color: #000; }
ul.dropdown a:active                { color: #ffa500; }
ul.dropdown li a                    { display: inline; padding: 2px 8px; border-right: 1px solid #777; border-bottom: 1px solid #777;
                                  color: #222; }
ul.dropdown li:last-child a         { border-right: none; } /* Doesn't work in IE */
ul.dropdown li.hover,
ul.dropdown li:hover                { background: #F3D673; color: black; position: relative; }
ul.dropdown li.hover a              { color: black; }
/* 
    LEVEL TWO
*/
ul.dropdown ul                      { width: 175px; visibility: hidden; position: absolute; top: 100%; left: 0; text-align: left; }
ul.dropdown ul li                   { font-weight: normal; background: #f6f6f6; color: #000; 
                                  border-bottom: 1px solid #ccc; float: none; }
                                /* IE 6 & 7 Needs Inline Block */
ul.dropdown ul li a                 { border-right: none; width: 100%; display: inline-block; } 
```

**[可以在这里看到一个示例。](http://jsfiddle.net/fPAFs/)**

毕竟我确实设法使我的菜单栏居中。然而，主页和事件菜单之间似乎有一点差距，我不知道如何摆脱它。

有任何想法吗？先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T21:13:14.643

不知何故，你设法将空格放在`<li>`元素之外，这里是删除空格的完全相同的代码：http: [//jsfiddle.net/fPAFs/1/](http://jsfiddle.net/fPAFs/1/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-28T18:03:17.740

这个怎么样：http: [//dabblet.com/gist/2520870](http://dabblet.com/gist/2520870)

你的代码一团糟。

```
<style>
    * {
        padding: 0;
        margin:  0;
    }

    body {
        font-family: helvetica, serif;
        font-size:   14px;
    }

    ul {
        list-style-type: none;
    }

    .dropdown {
        text-align: center;
        font-size:  0;
        margin:     15px;
    }

    ul.dropdown ul {
        width:      220px;
        visibility: hidden;
        position: absolute;
        top: 1.8em;
        left: 0;
    }

    ul.dropdown ul li a {
        font-weight:   normal;
        background:    #f6f6f6;
        color:         #000;
        border-bottom: 1px solid #ccc;
        float:         none;
    }

    .dropdown > li {
        display:   inline-block;
        height:    1.2em;
        font-size: 14px;
        position: relative;
    }

    .dropdown li a {
        display:         block;
        background:      rgb(204, 204, 204);
        border-bottom:   rgb(119, 119, 119) 1px solid;
        border-right:    rgb(119, 119, 119) 1px solid;
        padding: 0.3em;
        color:           rgb(0, 0, 0);
        text-decoration: none;
        font-weight:     bold;
    }

    .dropdown li a:hover {
        background: rgb(243, 214, 115);
    }
</style>

<ul class='dropdown'>
    <li><a href='index.php'>Home</a></li>
    <li><a href='#'>Incident</a>
        <ul class='sub_menu'>
            <li><a href='index.php?action=new'>New</a></li>
            <li><a href='index.php?action=edit'>Edit</a></li>
            <li><a href='index.php?action=manage'>Manage</a></li>
        </ul>
    </li>
    <li><a href='action_logout.php'>Log out</a></li>
</ul> 
```

试试这个新代码。虽然我敦促你不要在不了解它的情况下尝试实现别人的代码！

# facebook - 查询“喜欢”我的 Facebook 页面的用户并获取用户的个人资料图片？

> ID：10366001
> 
> 赞同：1
> 
> 时间：2012-04-28T17:46:40.647
> 
> 标签：facebook, facebook-graph-api, facebook-like

我正在寻找解决方案，但没有获得喜欢您 Facebook 页面的用户列表的运气。我在互联网上找到了以下解决方案，但都有一些限制。请建议？？

1.  Facebook 提供了类似的表格，我们可以在其中提供对象名称来获取喜欢您的专辑、照片等的用户列表。但我没有找到为 Facebook 页面获得这项工作。它适用于照片，专辑等。

2.  page_fan 表的第二个选项，但我注意到只有 uid 字段可以索引，因此您需要知道用户 ID 来搜索它，而不是 page_id。

3.  最后，我在我的应用程序中添加了点赞框，我在其中显示用户列表及其个人资料图片，但这里也限制了 Facebook 之类的框，我无法看到喜欢 Facebook 页面的用户的完整列表。它在 Like Box 中仅显示 20-30。如果我试图将 iFrame div CSS 更改为 overflow:auto 但它们没有成功，因为我认为带有其他域 url 的 iFrame 不允许相同。

有人可以帮助我如何获得所有喜欢我的 Facebook 页面的 Facebook 用户的个人资料照片，其中包含任何 3 个选项，或者让我知道是否有任何其他选项。

# google-chrome - Applescript - Google Chrome 激活某个窗口

> ID：10366003
> 
> 赞同：13
> 
> 时间：2012-04-28T17:46:48.730
> 
> 标签：google-chrome, applescript

你们知道如何使用 Applescript 激活第 n 个 Google Chrome 窗口吗？例如，如果我打开了三个谷歌浏览器窗口，如何激活第二个？

我尝试了许多不同的组合，例如：告诉窗口 2 的选项卡 3 激活

我还注意到：

告诉应用程序“谷歌浏览器”告诉窗口 1 激活结束告诉

和，

告诉应用程序“谷歌浏览器”告诉窗口 2 激活结束告诉

产生相同的结果，它只激活最后打开的窗口，这是一个错误吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-08T05:25:58.343

**tl;博士**

使用`set index of window <n> to 1`并不完全有效，因为它并没有真正*激活*窗口 - 但它确实使它*可见*。

**解决方法**（示例假设您要激活窗口 2）：

*   [Yar 的回答](https://stackoverflow.com/a/34375804/45375)提供了一种实用的解决方法，尽管尚不完全清楚它*为什么*起作用。但是，与以下解决方案不同，它确实具有*不需要*[授权](https://support.apple.com/en-us/HT202802)调用应用程序进行辅助访问的优点。

*   [user495470 的回答](https://stackoverflow.com/a/16727145/45375)暗示了一个强大且通用的解决方案，该解决方案也适用于非 AppleScriptable 应用程序：

    ```
    tell application "System Events" to tell process "Google Chrome"
        perform action "AXRaise" of window 2
        set frontmost to true
    end tell 
    ```

*   或者，使用下面定义的 AppleScript 处理程序，如下所示：

    *   `tell application "Google Chrome" to my activateWin(it, window 2)`

* * *

虽然[adayzdone 的答案](https://stackoverflow.com/a/10366818/45375) *应该*有效并且*几乎*有效，但有一个问题 - 这可能是也可能不是问题（在 Mountain Lion 上的 Chrome 21.0.1180.89 上观察到）[*更新：自 OSX 10.11.2 上的 Chrome 47.0.2526.106 起仍然适用*] ：

虽然该解决方案会将所需窗口*显示*为前窗口，但如果其他窗口之前处于活动状态，Chrome 不会*将其视为前窗口。*您可以通过不活动的关闭/最小/缩放标题栏按钮、复选标记旁边的窗口标题以及键盘快捷键（例如`Cmd-L`不会应用于所需窗口）这一事实来判断。

如果您的下一步操作是*单击*窗口上的某个位置，这可能不是问题，因为这样的单击将完全激活所需的窗口。

否则，您可以采用相当强大的 GUI 脚本解决方法（非常感谢[这里](https://stackoverflow.com/questions/3655502/applescript-activate-window-of-a-non-scriptable-application "这里")的通用解决方案）：

**更新**：可悲的是，实际上没有*激活*索引设置为 1 的窗口的问题似乎会影响所有应用程序（在 OS X 10.8.3 上遇到过）。这是一个通用函数，它使用 GUI 脚本**正确激活给定 AppleScriptable 应用程序中的给定窗口。**

```
# Activates the specified window (w) of the specified AppleScriptable
# application (a).
    # Note that both parameters must be *objects*.
# Example: Activate the window that is currently the 2nd window in Chrome:
#   tell application "Google Chrome"
#       my activateWin(it, window 2)
#   end tell
on activateWin(a, w)
    tell application "System Events"
        click menu item (name of w) of menu 1 of menu bar item -2 ¬
                   of menu bar 1 of process (name of a)
    end tell
    activate a
end activateWin 
```

附带说明一下，OP 所尝试的 - 例如`activate window 1`- 似乎在 OS X 10.8.3 上的所有应用程序中也被破坏了 - 当底层*应用程序*被激活时，窗口规范。被忽略。

这是原始的，更具**教学性的代码**：

```
tell application "Google Chrome"
    # Each window is represented by the title of its active tab
    # in the "Window" menu.
    # We use GUI scripting to select the matching "Window" menu item
    # and thereby properly activate the window of interest.
    # NOTE: Should there be another window with the exact same title,
    # the wrong window could be activated.

    set winOfInterest to window 2 # example
    set winTitle to name of winOfInterest

    tell application "System Events"
        # Note that we must target the *process* here.
        tell process "Google Chrome"
            # The app's menu bar.
            tell menu bar 1
                # To avoid localization issues,
                # we target the "Window" menu by position - the next-to-last
                # rather than by name.
                click menu item winTitle of menu 1 of menu bar item -2
            end tell
        end tell
    end tell
    # Finally, activate the app.
    activate
end tell 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-28T19:27:52.470

尝试：

```
tell application "Google Chrome"
    activate
    set index of window 1 to 1
    delay 3
    set index of window 2 to 1
end tell 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-24T03:13:10.127

正如 mklement 所提到的，更改索引会提升窗口，但例如键盘快捷键仍由先前最前面的窗口注册。

```
tell application "Google Chrome"
    set index of window 2 to 1
end tell 
```

另一种选择是将系统事件告诉 AXRaise 窗口 1：

```
tell application "Google Chrome"
    set index of window 2 to 1
end tell
tell application "System Events" to tell process "Google Chrome"
    perform action "AXRaise" of window 1
end tell 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-19T21:57:28.660

设置索引，然后打开 Chrome。

```
tell application "Google Chrome"
    set index of window 2 to 1
    delay 0.01
    do shell script "open -a Google\\ Chrome"
end tell 
```

[来源](https://apple.stackexchange.com/a/117790/18875)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-14T16:28:17.367

除了有关激活所需窗口的解决方案外，（至少）较新的 Chrome 版本还支持 windows 的`active tab index`属性：

```
tell window 1
    set active tab index to 5
end tell 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-21T04:19:11.300

如果你运行这个

```
activate application "Google Chrome"
tell application "System Events" to keystroke "`" using command down 
```

即使它是从脚本编辑器运行的，它也会完成整个事情。

这是另一种方式，这个已经由其他人在更多步骤中拼写出来：

```
tell application "System Events" to tell process "Google Chrome" to perform action "AXRaise" of window 2
activate application "Google Chrome" 
```

如果您愿意将其保存为应用程序并将其分配给热键，您可以这样做：

```
tell application "Google Chrome" to set index of window 2 to 1 
```

虽然我想那时你也可以简单地点击命令+`。当然，除非您的 applescript 涉及创建一系列步骤的一系列步骤，这很可能是这种情况。如果它涉及一系列步骤，那么您只需要第二个代码示例的第一行，只要您将它分配给一个热键并在 chrome 已经激活时点击热键（或者该行出现在 chrome 之后在您的代码中激活）。

# ios - NavigationController 与 UITableView 去子单元格（或者我应该如何解释......）

> ID：10366004
> 
> 赞同：0
> 
> 时间：2012-04-28T17:46:54.783
> 
> 标签：ios, uitableview

我已经搜索了有关如何使 UITableViewController 深入研究的高级教程...

我的场景是：主列表是国家。点击其中一个单元格，会显示该国家/地区的一些城市，并显示在新的 UITableView 中。这部分很简单 - 但添加“更深层次”，我错过了如何做的理解:(假设城市可以有其他选择，如酒店、餐厅、酒吧。点击餐厅再次为您提供新的外汇选择。食物style, FastFood, Mexican, Indian, local. 如果你看快速路径，它可能是：Country->City->Restaurant->FastFood->McDonalds

现在，最困难的部分是，我想保存麦当劳的价值，并将其带回 view2（城市）

有没有人知道一个好的教程，无论是书面的还是 Youtube 上的 - 它会非常棒！

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:14:36.900

这是您如何做到这一点的方法。首先在您的 City View Controller 上创建并合成一个名为`selectedValue`

```
@property (nonatomic, strong) NSString *selectedValue; 
```

然后，当在最后一级 tableViewController 上选择值时，在 UINavigationController 的导航堆栈中找到 City viewController，在该 viewController 上设置属性，然后将导航堆栈弹出到该 viewController。

所以在你的最后一级 viewController 你的代码看起来像：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString *rowValue = [dataArray objectAtIndex:[indexPath row]]; //  e.g. McDonald's

    // loop through view controller stack to find the city viewcontroller
    // (if the index of the city viewcontroller will always be the same you could just go directly to that index)
    NSArray *viewControllers = [self.navigationController viewControllers];
    for (UIViewController *vc in viewControllers) {

        if ([vc isMemberOfClass:[CityViewController class]]) {
            CityViewController *cityVC = (CityViewController*)vc;
            cityVC.selectedValue = rowValue;
            [self.navigationController popToViewController:cityVC animated:YES];
            break;
        }
    }
} 
```

# r - 显示 geom_text 图层的单 独图例？

> ID：10366005
> 
> 赞同：5
> 
> 时间：2012-04-28T17:46:55.330
> 
> 标签：r, ggplot2

我有以下情节：

```
library(ggplot2)

ib<- data.frame(
  category =   factor(c("Cat1","Cat2","Cat1", "Cat1", "Cat2","Cat1","Cat1", "Cat2","Cat2")),
  city =       c("CITY1","CITY1","CITY2","CITY3", "CITY3","CITY4","CITY5", "CITY6","CITY7"),
  median =     c(1.3560, 2.4830, 0.7230, 0.8100, 3.1480, 1.9640, 0.6185, 1.2205, 2.4000),
  samplesize = c(851, 1794,   47,  189,  185,    9,   94,   16,   65)
  )

p<-ggplot(data=ib, aes(x=city, y=category, size=median, colour=category, label=samplesize)) +
  geom_point(alpha=.6) +
  scale_area(range=c(1,15)) +
  scale_colour_hue(guide="none") +
  geom_text(aes(size = 1), colour="black")
p 
```

（我正在绘制与中值成比例的圆圈并覆盖代表样本大小的文本标签。图片位于[http://imgur.com/T82cF](http://imgur.com/T82cF)）

有什么办法可以分开这两个传说吗？我希望一个图例（标记为“中位数”）给出圆圈的比例，另一个图例带有一个字母“a”（甚至更好的数字），我可以将其标记为“样本大小”。由于这两个属性没有任何关系，因此将它们捆绑在同一个图例中是没有意义的。

我尝试了各种组合，但我能想到的最好的方法就是完全失去文字图例:)

感谢你的回答！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T08:22:26.730

**更新** `scale_area`已被弃用；`scale_size`改为使用。该`gtable`函数`gtable_filter()`用于提取图例。并修改了用于替换其中一个图例中的默认图例键的代码。

如果您仍在寻找问题的答案，那么这里似乎可以满足您的大部分需求，尽管它在某些地方有点小题大做。图例中的符号可以在[此处使用 kohske 的评论进行更改](https://stackoverflow.com/questions/10405823/changing-the-symbol-in-the-legend-key-in-ggplot2)

困难在于尝试应用两种不同大小的映射。因此，我将点尺寸映射保留在美学声明中，但从美学声明中删除了标签尺寸映射。这意味着必须根据样本大小（fsamplesize）的因子版本的离散值设置标签大小。生成的图表几乎是正确的，除了未绘制标签大小（即样本大小）的图例。为了解决这个问题，我绘制了一个图表，其中包含根据样本大小的因子版本（但忽略点大小映射）的标签大小映射，以便提取其图例，然后可以将其插入回第一个图表中。

```
## Your data
ib<- data.frame(
  category =   factor(c("Cat1","Cat2","Cat1", "Cat1", "Cat2","Cat1","Cat1", "Cat2","Cat2")),
  city =       c("CITY1","CITY1","CITY2","CITY3", "CITY3","CITY4","CITY5", "CITY6","CITY7"),
  median =     c(1.3560, 2.4830, 0.7230, 0.8100, 3.1480, 1.9640, 0.6185, 1.2205, 2.4000),
  samplesize = c(851, 1794,   47,  189,  185,    9,   94,   16,   65)
  )

## Load packages
library(ggplot2)
library(gridExtra)
library(gtable)
library(grid)

##  Obtain the factor version of samplesize.   
ib$fsamplesize = cut(ib$samplesize, breaks = c(0, 100, 1000, Inf))

## Obtain plot with dot size mapped to median, the label inside the dot set 
## to samplesize, and the size of the label set to the discrete levels of the factor
## version of samplesize. Here, I've selected three sizes for the labels (3, 6 and 10)
## corresponding to samplesizes of 0-100, 100-1000, >1000\. The sizes of the labels are
## set using three call to geom_text - one for each size.

p <- ggplot(data=ib, aes(x=city, y=category)) +
   geom_point(aes(size = median, colour = category), alpha = .6) +
   scale_size("Median", range=c(0, 15)) +
   scale_colour_hue(guide = "none") + theme_bw()

p1 <- p + 
  geom_text(aes(label = ifelse(samplesize > 1000, samplesize, "")), 
         size = 10, color = "black", alpha = 0.6) +
  geom_text(aes(label = ifelse(samplesize < 100, samplesize, "")), 
         size = 3, color = "black", alpha = 0.6) +
  geom_text(aes(label = ifelse(samplesize > 100 & samplesize < 1000, samplesize, "")), 
         size = 6, color = "black", alpha = 0.6)

## Extracxt the legend from p1 using functions from the gridExtra package
g1 = ggplotGrob(p1) 
leg1 = gtable_filter(g1, "guide-box")

## Keep p1 but dump its legend
p1 = p1 + theme(legend.position = "none")

## Get second legend - size of the label.
## Draw a dummy plot, using fsamplesize as a size aesthetic. Note that the label sizes are
## set to 3, 6, and 10,  matching the sizes of the labels in p1\. 

dummy.plot = ggplot(data = ib, aes(x = city, y = category, label = samplesize)) +
  geom_point(aes(size = fsamplesize), colour = NA) +
  geom_text(show.legend = FALSE) + theme_bw() +
  guides(size = guide_legend(override.aes = list(colour = "black", shape = utf8ToInt("N")))) +
scale_size_manual("Sample Size", values = c(3, 6, 10),
     breaks = levels(ib$fsamplesize), labels = c("< 100", "100 - 1000", "> 1000"))

## Get the legend from dummy.plot using functions from the gridExtra package
g2 = ggplotGrob(dummy.plot) 
leg2 = gtable_filter(g2, "guide-box")

## Arrange the three components (p1, leg1, leg2) using functions from the gridExtra package
## The two legends are arranged using the inner arrangeGrob function. The resulting
## chart is then arranged with  p1 in the outer arrrangeGrob function.
ib.plot = arrangeGrob(p1, arrangeGrob(leg1, leg2, nrow = 2), ncol = 2, 
      widths = unit(c(9, 2), c("null", "null")))

## Draw the graph
grid.newpage()
grid.draw(ib.plot) 
```

![在此处输入图像描述](../Images/74829e1b7791e7bf7996aaf510f23cf1.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T20:36:55.957

这实际上并没有直接解决您的问题，但这*是*我可能会如何创建具有您描述的一般特征的图表：

```
ib$ss <- paste("n = ",ib$samplesize,sep = "")

ggplot(data=ib, aes(x=city, y=category, size=median, colour=category, label=ss)) +
  geom_point(alpha=.6) +
  geom_text(size = 2, vjust = -1.2,colour="black") +
  scale_colour_hue(legend = FALSE) 
```

我删除了这`scale_area`件作品，因为我不确定它的用途是什么，并且它给我带来了错误。

所以这里的基本原理是样本量信息对我来说更像是一种注释，而不是值得拥有自己的规模和传说的东西。当然，意见可能会有所不同，但我想我会把它放在那里，以防你觉得它有用。

![在此处输入图像描述](../Images/0702c81308fd38368183b55a073ca198.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T20:58:59.840

这也不能回答你的问题。我已经离开`samplesize`圈子了。此外，`samplesize`对我来说，更像是注释而不是传说。但我认为您使用的是旧版本的`ggplot2`. `ggplot2`0.9.0 版本有一些变化。我已经进行了以下更改。

```
p<-ggplot(data=ib, aes(x=city, y=category, size=median, colour=category, label=samplesize)) +
  geom_point(alpha=.6) +
  scale_area(range = c(1,15)) +  # range instead of to
  scale_colour_hue(guide = "none") +    # guide instead of legend
  geom_text(size = 2.5, colour="black")
 p 
```

![在此处输入图像描述](../Images/ad30436f0849d06aa0acef383122dc25.png)

# ruby-on-rails - Heroku 日志在 syck.rb 中显示语法错误。如何解决这个问题？

> ID：10366009
> 
> 赞同：0
> 
> 时间：2012-04-28T17:47:36.987
> 
> 标签：ruby-on-rails, heroku

我正在尝试将 Rails 3.2 应用程序部署到 Heroku。

当我迁移数据库时，rake 被中止。

检查我看到的日志

```
/usr/local/lib/ruby/1.9.1/syck.rb:135:in `load': syntax error on line 7, col 11: `' (ArgumentError) 
```

我试图找出造成这种情况的原因，包括禁用所有非必要的 gem，查看应用程序是否有明显的语法错误等。但没有运气。

由于此错误似乎是由 Heroku 系统文件生成的，因此我不确定接下来要尝试什么。

有人遇到过这种情况么？是否有任何好的参考资料可以帮助我深入了解这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T03:37:49.707

听起来像是某处 yml 文件第 7 行的语法错误。

我假设在本地一切正常，因此 yml 文件具有基于环境变量的内容，这些环境变量在开发和生产之间存在差异（并且生产中的值导致不正确的 yaml），或者差异来自在本地使用 psych（新的 yaml 解析器）但是对heroku感到满意。您可以检查哪个解析器正在与 YAML::ENGINE 一起使用。

# java - Oracle DATE 和 Hibernate/JPA 映射

> ID：10366014
> 
> 赞同：2
> 
> 时间：2012-04-28T17:48:12.480
> 
> 标签：java, oracle, hibernate, date, spring-data-jpa

其中一个 Oracle 表看起来像这样，我没有选择更改它的选项：

```
REPORTING_PERIOD | REPORTING_DATE (Oracle DATE type)
-------------------------------
1140               01-FEB-12
1139               01-JAN-12 
```

JPA 实体（以 Hibernate 作为提供者）如下所示：

```
@Column(name="REPORTING_PERIOD")
private long reportingPeriod;

@Temporal( TemporalType.DATE)
@Column(name="REPORT_DATE")
private Date reportDate; //java.util.Date 
```

现在，让我们进行单元测试：（我使用 Spring Data JPA 作为存储库）下面的行通过 REPORTING_PERIOD 列查询数据库

```
ReportingPeriod period1 = reportingPeriodRepository.findByMaxReportingPeriod();
assertNotNull(period1); // works fine and entity is fetched
System.out.println(period1.getReportDate()); 
```

SOP 的输出是**2012-02-01** - 注意从 db **01-FEB-12中的值自动转换**

现在，如果我使用“01-FEB-12”直接按日期查询，如下所示，我不会得到任何结果：

```
ReportingPeriod period2 = reportingPeriodRepository.findByReportDate(period1.getReportDate());
assertNotNull(period2); 
```

请注意，我正在使用来自同一实体的日期字段，我可以在上一个语句中成功获取该字段。

这也不起作用：

```
DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
ReportingPeriod period3 = reportingPeriodRepository.findByReportDate(df.parse("2012-02-01"));
assertNotNull(period3); 
```

非常感谢当 db 中的值为 01-FEB-12 时，我如何通过 REPORTING_DATE 作为参数查询（使用 HQL 也可以）的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T08:09:41.810

我认为在reportingPeriodRepository.findByMaxReportingPeriod()中获取结果时有一些明确的日期格式转换；

因此我们可以检查我们是否使用与数据库格式相同的格式获取数据

改变

```
DateFormat df = new SimpleDateFormat("yyyy-MM-dd"); 
ReportingPeriod period3 = reportingPeriodRepository.findByReportDate(df.parse("2012-02-01")) 
```

至

```
DateFormat df = new SimpleDateFormat("dd-MMM-yy"); 
ReportingPeriod period3 = reportingPeriodRepository.findByReportDate(df.parse("01-FEB-12")) 
```

# mysql - 删除所有行，除了

> ID：10366019
> 
> 赞同：4
> 
> 时间：2012-04-28T17:48:36.390
> 
> 标签：mysql, syntax, sql-delete

当我执行此查询时：

```
DELETE FROM `wp_posts` WHERE id NOT IN 
  (SELECT id FROM wp_posts WHERE post_status = 'publish') 
```

我收到以下错误消息：

> 您不能在 FROM 子句中指定目标表 'wp_posts' 进行更新

不确定这里的语法问题是什么。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-28T17:50:52.380

这可以在不使用子查询的情况下完成。请尝试以下

```
DELETE FROM 'wp_posts' WHERE post_status != 'publish' 
```

# ios - 只登录 Debugger，但报告中没有数据

> ID：10366021
> 
> 赞同：9
> 
> 时间：2012-04-28T17:48:50.213
> 
> 标签：ios, xcode, testflight

我现在正在使用 TestFlight 测试我的项目，我可以在[SDK Debugger中看到一些日志（包括检查点、session_start 等），但在](https://testflightapp.com/dashboard/team/debugger/)[Build](https://testflightapp.com/dashboard/builds/)中我的报告是空的。我发送电子邮件到`support#testflightapp.com`，在 Twitter 上提出问题，甚至查看列出的推文，但仍然找不到解决方案。我认为 SO 是我现在唯一可以参考帮助的网站。

有没有人遇到过这个问题现在解决了？？顺便说一句，在哪里`TFLog`？我找不到我设置的任何调试日志。

提前致谢！

* * *

编辑：

这是两个屏幕截图，可以清楚地显示我的问题。

[![](../Images/5b49159dfb08406564447e82ba362548.png)](https://imgur.com/6dDl1) [![](../Images/c96a31fc7432ccbee4cf194a3c36b472.png)](https://imgur.com/7GL82)

你看，我发送了反馈、检查点（还有一些 session_stard/end 日志），但没有详细报告。:(

* * *

> SDK 调试器：TestFlight SDK 调试器可让您在团队的 SDK 数据进入我们的队列之前查看它。控制台还显示孤立的 SDK 事件，可以帮助您确认您已正确实施 SDK。

所以我认为我正确地实现了 SDK。我尝试了 SDK v1.0 和 v.0.8.3，并构建了一个新项目来测试此服务，结果相同。

我多么希望我现在可以提供赏金！请帮忙..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T04:32:50.540

最后，我得到了Testflight团队的回复：

> 坦率地说，我们遇到了一些稳定性问题，这些问题似乎是您遇到麻烦的根本原因。团队正在尽最大努力为您带来更快、更稳定的 TestFlight。

很遗憾..

* * *

我找到了`TFLog`（来自我的模拟器的测试报告，但还不能收到我的设备的报告）：

1.  选择您想要的构建`Builds`部分；
2.  `Sessions`在部分中选择`Reports`；
3.  选择所需的测试仪，您会发现一些日志，例如： [![](../Images/08fac682faf4154a69c8bb9a7209ec87.png)](https://imgur.com/nYCdp)
4.  单击蓝色 INFO 图标以打开详细信息对话框： [![](../Images/12c55945af61c1b2b176270f9d0bd2bb.png)](https://imgur.com/U7arG)
5.  在右上角，您会找到一个`Events`按钮，单击以打开选择区域，然后只需选择`Log`，您将获得`TFLog`s。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T22:37:11.333

对于遇到 Testflight SDK 根本没有记录事件的问题的人来说，这是一个提醒。

仔细检查您是否也在使用 Flurry for Analytics，并查看禁用它是否可以解决问题（对我来说确实如此）。我在某处读到，这是在 Testflight SDK 上实现异常处理程序的方式的一个已知问题。

# c++ - 主要论点约定

> ID：10366022
> 
> 赞同：2
> 
> 时间：2012-04-28T17:48:52.600
> 
> 标签：c++, conventions

出于编码 IDE 的限制，我总是这样编写我的 main 函数：

```
int main(int argc, char* argv[]) 
```

但是在 IDE 中，它们以 hello world 类型的应用程序结构开始，我已经看到它以不同的方式编写。例如在 Xcode 中，它有 argv 作为常量：

```
int main(int argc, const char * argv[]) 
```

我还看到人们将 argv[] 声明为双指针，我无法理解以下原因：

```
int main(int argc, char** argv) 
```

是否有任何标准或约定如何声明？我应该有一个双指针还是一个常量？

额外的问题：表示指针的星号应该放在数据类型之后，就在变量名之前还是在中间分开？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:57:08.513

**是否有任何标准或约定如何声明？我应该有一个双指针还是一个常量？**

这在 C++ 标准中有明确定义。

参考：
**C++03 第 3.6.1 节：**

**第 2 段：**

> 它的返回类型应该是 int，否则它的类型是实现定义的。所有实现都应允许以下两种 main 定义：

```
int main() { /* … */ }

and 

int main(int argc, char* argv[]) { /* … */ } 
```

> 在后一种形式中，argc 是从程序运行的环境传递给程序的参数数量。如果 argc 不为零，则应在 argv[0] 到 argv[argc-1] 中提供这些参数作为指向以空字符结尾的多字节字符串 (NTMBS) (17.3.2.1.3.2) 的初始字符的指针，并且 argv[0] 应为指向 NTMBS 的初始字符的指针，表示用于调用程序的名称或“”。argc 的值应为非负数。argv[argc] 的值应为 0。 [注意：建议在 argv 之后添加任何其他（可选）参数]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:57:53.783

我相信各种标准都说 argv 不是 const。现在，如果您的应用程序没有修改 argv，那么您没有理由不能将其声明为 const。

# php - 如何将mysql表行显示为列

> ID：10366023
> 
> 赞同：2
> 
> 时间：2012-04-28T17:49:02.967
> 
> 标签：php, mysql

我有两张桌子，`result`和`gp`。

在`result`表中我有这样的东西：

```
|id||student_id   ||course_code||grade||session  ||level||semester|
|1 ||TR/2213234561||MAT111     ||A    ||2009/2010||100  ||first   |
|2 ||TR/2213234561||MAT112     ||B    ||2009/2010||100  ||first   |
|3 ||TR/2213234561||MAT113     ||C    ||2009/2010||100  ||first   |
|4 ||TR/2213234567||MAT111     ||D    ||2009/2010||200  ||first   |
|5 ||TR/2213234567||MAT112     ||C    ||2009/2010||200  ||first   |
|6 ||TR/2213234567||MAT113     ||C    ||2009/2010||200  ||first   | 
```

然后`gp`表

```
|id||student_id   ||session  ||level||semester||gp |
|1 ||TR/2213234561||2009/2010||100  ||first   ||4.2|
|2 ||TR/2213234567||2009/2010||100  ||first   ||3.5|
|3 ||TR/2213234561||2010/2011||200  ||first   ||4.2|
|4 ||TR/2213234567||2010/2011||200  ||first   ||3.5| 
```

我想要的是这样的：

```
|Matriculation||MAT111||MAT112||MAT113||MAT114||GP |
|TR/2213234561||A     ||B     ||D     ||C     ||4.2|
|TR/2213234567||C     ||D     ||E     ||F     ||3.5| 
```

课程代码不是固定的 - 它取决于学生注册的课程

我已经这样做了：

```
<?php
$rst1 = mysql_query("select distinct course_code from result ", $conn);
echo "<table callspacing='4'>";
echo "<tr>";
echo "<td> Matriculation Number </td>";

$c_code = array();
while ($row = mysql_fetch_array($rst1))
{
    $c_code[] = $row['course_code'];
}

foreach($c_code as $c_code)
{
    echo "<td>" .$c_code. "</td>";
}

$sql ="SELECT result.student_id,
       MAX(CASE WHEN course_code = ' $c_code' THEN grade END)  $c_code,
       gp.CTC 
       FROM result 
       JOIN gp  
       ON gp.student_id = result.student_id
       GROUP
       BY student_id";

echo "<td> GP</td>";                         
$rst = mysql_query("$sql",$conn) or die(mysql_error());

while ($row = mysql_fetch_array($rst))
{
    echo "</tr>";
    echo "<tr>";
    echo "<td>" .$row['student_id']. "</td>";
    echo "<td>"  .$row[$c_code]. "</td>";
}

echo "<td>"  .$row[$c_code]. "</td>";
echo "<td>" .$row['CTC']. "</td>";

echo"</tr>";
echo "</table>";
?> 
```

第一个查询是获取课程代码，因为课程不是常量。

使用该代码，我得到了如下信息：

```
|Matriculation||MAT111||MAT112||MAT113||MAT114||GP|
|TR/2213234561|
|TR/2213234567| 
```

但我想要

```
|Matriculation||MAT111||MAT112||MAT113||MAT114||GP |
|TR/2213234561||A     ||B     ||D     ||C     ||4.2|
|TR/2213234567||C     ||D     ||E     ||F     ||3.5| 
```

任何建议或方向将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:11:47.117

您希望执行的操作称为“透视”您的数据，并且某些其他 RDBMS 对此具有本机支持，但 MySQL 不支持（设计上，开发人员认为此类操作属于表示层）。

但是，您有几个选择：

1.  构造一个相当可怕的 MySQL 查询来手动执行旋转操作：

    ```
    SELECT student_id AS Matriculation, MAT111, MAT112, gp AS GP
      FROM gp
      NATURAL JOIN (
        SELECT student_id, grade AS MAT111
        FROM result
        WHERE course_code = 'MAT111'
      ) AS tMAT111
      NATURAL JOIN (
        SELECT student_id, grade AS MAT112
        FROM result
        WHERE course_code = 'MAT112'
      ) AS tMAT112
      -- etc.
    WHERE level = @level AND semester = @semester 
    ```

    如果您选择走这条路，您可以通过使用 PHP 中的循环结构或 MySQL 中的预准备语句自动生成此查询，让您的生活稍微轻松一些。

    这是您可以在 PHP 中执行此操作的一种方法：

    1.  获取课程列表：

        ```
        $dbh = new PDO('mysql:dbname=testdb;host=127.0.0.1', $user, $password);
        $qry = $dbh->query("SELECT DISTINCT course_code FROM result [WHERE ...]");
        $courses = $qry->fetchAll(PDO::FETCH_COLUMN, 0); 
        ```

    2.  循环遍历结果，构造上面的 SQL：

        ```
        mb_regex_encoding($charset);

        $columns = mb_ereg_replace('`', '``', $courses);
        $sql = "
        SELECT student_id AS Matriculation, `".implode("`,`", $columns)."`, gp AS GP
          FROM gp";

        foreach ($columns as $column) $sql .= "
          NATURAL JOIN (
            SELECT student_id, grade AS `$column`
            FROM result
            WHERE course_code = ?
          ) AS `t$column`";

        $sql .= "
        WHERE level = ? AND semester = ?"; 
        ```

    3.  执行 SQL，将课程数组作为参数传入：

        ```
        $qry = $dbh->prepare($sql);

        $params = $courses;
        array_push($params, $level, $semester);
        $qry->execute($params); 
        ```

    4.  输出结果：

        ```
        echo "<table>";

        echo "<tr>";
        for ($i = 0; $i < $qry->columnCount(); $i++) {
          $meta = $qry->getcolumnMeta($i);
          echo "<th scope='col'>" . htmlentities($meta['name']) . "</th>";
        }
        echo "</tr>";

        while ($row = $qry->fetch(PDO::FETCH_NUM)) {
          echo "<tr>";
          foreach ($row as $field) echo "<td>" . htmlentities($field) . "</td>"
          echo "</tr>";
        }

        echo "</table>"; 
        ```

2.  将上述操作作为一次性操作进行，以便更改 MySQL 数据库的结构以更准确地反映这种所需的布局（转换表后很容易，但可能会影响数据库的其他用途）：

    ```
    CREATE TABLE StudentGrades (PRIMARY KEY('Matriculation'))
    SELECT student_id AS Matriculation, MAT111, MAT112, gp AS GP
      -- etc. as above 
    ```

    或者，您可以创建一个[`VIEW`](http://dev.mysql.com/doc/refman/5.0/en/create-view.html)基于基础表以这种方式构造的“虚拟表”。

3.  在 PHP 中手动旋转数据（相对繁琐）。

# java - java中的输入参数

> ID：10366026
> 
> 赞同：2
> 
> 时间：2012-04-28T17:49:19.750
> 
> 标签：java

我想知道为什么Java程序在运行时只从命令行获取字符串形式的参数？我已经[读过](https://stackoverflow.com/questions/10183611/using-int-instead-of-string-public-static-void-main-int-args)，如果参数被声明为 int，它仍然会将 int 转换为 String。为什么会这样？在运行 java 程序时，有没有办法只接受来自命令行的 int 值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:53:42.433

字符串更加通用，因为它们可以保存任何值，甚至可以作为 int 的代表。如果您想在命令行中传递一个 int，您可以自己将字符串转换为 int。

```
int val = Integer.parseInt(arg[0]); 
```

主要方法的有效签名是

```
public static void main(String[] args) 
```

没有其他参数结构将被视为主要功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:51:10.577

> 我已经读过，如果参数被声明为 int，它仍然会将 int 转换为 String。

你读错了。如果该`main()`方法采用其他任何方法`String[] args`，则 JVM 不会将其识别为有效的入口点。

如果您希望采用整数参数，您的 main 方法仍然必须接受`String[] args`，并且您必须自己执行转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:52:55.533

无论如何，您都从命令行传递字符（只是因为键盘上没有“整数”）。因此，您需要将此 char 数组（包装成字符串）转换为整数。

# iphone - iphone - 将 NSMutableArray 设置为 nil 不会在 ARC 中释放数组

> ID：10366030
> 
> 赞同：0
> 
> 时间：2012-04-28T17:49:50.953
> 
> 标签：iphone, objective-c, ios

我有一个 tabBar 控制器，在触发事件后，tabBar 控制器从视图中弹出，但在此之前，该事件将一些 NSMutableArrays 设置为 nil。但是当 tabBar 控制器重新加载时，NSMutableArrays 仍然保留对象。

//初始化器

```
if (self.items == nil)
    self.items = [NSMutableArray arrayWithObjects:(Another Array)]; 
```

//事件

```
self.items = nil; 
```

# node.js - child_process exec 无法响应客户端浏览器

> ID：10366031
> 
> 赞同：0
> 
> 时间：2012-04-28T17:50:01.627
> 
> 标签：node.js

我正在尝试通过`child_process`模块执行命令并将结果响应到客户端浏览器，如下所示，`console.log(stdout)`工作查找，但`response.write()`不起作用。

```
function start(response) {
    dir_list(function(stdout) {
        response.writeHead(200, {"Content-Type": "text/plain"});
        response.write(stdout);
        console.log(stdout);
        response.end();
});     

function dir_list(callback) {
     var exec = require('child_process').exec
     child = exec('ls -la', function(error, stdout, stderr) {
         callback(stdout);
     });
} 
```

上面的代码由我重构，我将其称为 [Node.js: Object value as stdout of child_process.exec](https://stackoverflow.com/questions/10270857/node-js-object-value-as-stdout-of-child-process-exec)，但不幸的是它对我不起作用。

顺便说一句，我原来的代码是：

```
 function start(response) {
      console.log("Request handler 'start' was called.");
      var exec = require('child_process').exec;
      exec("ls -lah", function (error, stdout, stderr) {
      response.writeHead(200, {"Content-Type": "text/plain"});
      response.write(stdout);
      console.log(stdout);
      response.end();
 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:16:16.633

您的代码在函数`}`末尾缺少关闭。`start`

```
function start(response) {
    dir_list(function(stdout) {
        response.writeHead(200, {"Content-Type": "text/plain"});
        response.write(stdout);
        console.log(stdout);
        response.end();
    });
}

function dir_list(callback) {
     var exec = require('child_process').exec
     child = exec('ls -la', function(error, stdout, stderr) {
         callback(stdout);
     });
} 
```

# c++ - 可以简化这个表达式吗？

> ID：10366033
> 
> 赞同：5
> 
> 时间：2012-04-28T17:50:15.170
> 
> 标签：c++, stl, c++11

假设我有一个带有成员变量的类：

```
std::unordered_map<KeyType, std::shared_ptr<ValueType>> myMap 
```

在成员函数中，我想执行以下操作：

```
std::for_each(myMap.begin(), myMap.end(), [](std::pair<const KeyType, std::shared_ptr<ValueType>>& pair){pair.second->someMethod(); }); 
```

有没有办法缩短 lambda 表达式？我以为我可以做到这一点，但它不是有效的语法：

```
std::for_each(myMap.begin(), myMap.end(), [](decltype(myMap::valueType)& pair){pair.second->someMethod(); }); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-28T18:08:07.620

我根本不会打扰 lambda。与其他标准算法不同，`for_each()`它并不比等效的`for`.

```
for (auto& p : myMap)
    p.second->someMethod();

for (auto p = myMap.begin(); p != myMap.end(); ++p)
    p->second->someMethod(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T17:53:00.853

我推荐`typedef`像 assoc 容器这样的复杂模板，因此您可以执行以下操作：

```
typedef std::unordered_map<KeyType, std::shared_ptr<ValueType>> map_type;

map_type myMap;

//do with map

std::for_each(myMap.begin(), myMap.end(), 
    [](typename map_type::value_type& pair){
        pair.second->someMethod(); 
}); 
```

或没有 typedef

```
std::for_each(myMap.begin(), myMap.end(), 
    [](typename decltype(myMap)::value_type& pair){
        pair.second->someMethod(); 
}); 
```

decltype 获取对象的类型，您需要使用模板类中定义的类型名，为此您使用`typename`关键字。如果模板特化没有该 typedef，这是必要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T18:11:47.413

我制作了一个宏，如下所示：//从容器名称中推断出匿名 lambda 类型

```
#define _A(container)\
  std::remove_reference<decltype(*std::begin(container))>::type 
```

在您的情况下，用作：

```
std::for_each(myMap.begin(), myMap.end(), [](_A(myMap)& pair) {
  pair.second->someMethod(); 
}); 
```

*注意：* 如果`remove_reference`键入 ，则需要保留常量`[](const _A(myMap)& pair)`，否则`&`删除`const`声明。

# javascript - JavaScript MVC 框架 + raphaelJS

> ID：10366035
> 
> 赞同：7
> 
> 时间：2012-04-28T17:50:32.720
> 
> 标签：javascript, model-view-controller, raphael, javascript-framework

我正在尝试制作一个具有客户端 MVC 架构的应用程序，但除了 HTML 模板之外，它还具有 SVG 元素作为视图（我使用 raphael 来管理它）。

是否有任何 JavaScript MVC 框架可以很好地与 raphaelJS 作为视图一起使用？

在没有的情况下，是否有任何建议的框架可以很好地使用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T01:35:07.883

[Backbone.js](http://documentcloud.github.com/backbone/)是一个简单的 MVC 框架，它不限制使用哪个模板引擎，而是让您自己选择。

在主干渲染函数中，它总是从一些 JSON 数据生成 HTML 代码，如下所示：

```
render: function () {
    // use underscore as template engine
    this.el.innerHTML = _.template(TMPL_STRING).render(JSON_DATA);
} 
```

在这里使用 RaphaelJS 非常简单：

```
initialize: function () {
    this.paper = Raphael(this.el, width, height);
},
render: function () {
    // use this.paper to render svg here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T20:01:38.140

Sencha 制作了 ExtJS，它是一个 MVC JS 框架——尽管有些人认为这不是真的。自从 Sencha 收购/吸收了 Raphael，我想象在不久的将来这两个库被优化以协同工作，甚至可能合并。

# ruby - ruby - 从数据库填充时的文本解析问题

> ID：10366037
> 
> 赞同：0
> 
> 时间：2012-04-28T17:50:48.383
> 
> 标签：ruby

尝试使用数据库中的值在 ruby​​ 中创建简单的下拉列表 - 就像这样：

```
<% ingredientArray = Ingredient.all.map { |ingredient| [ingredient.name, ingredient.id] } %>
<div class="field">
  <%= select_tag(:ingredient_id, ingredientArray) %><br/>
</div> 
```

我收到了一个空的。
这是生成的html

```
<div class="field">
   <select id="ingredient_id" name="ingredient_id">[[&quot;Paprika&quot;, 5], [&quot;Cinnamon&quot;, 8], [&quot;Salt&quot;, 9], [&quot;Pepper&quot;, 10], [&quot;water&quot;, 11]]</select><br/>
</div> 
```

我应该把html圣人放在哪里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:01:39.383

您应该阅读有关[select_tag](http://apidock.com/rails/ActionView/Helpers/FormTagHelper/select_tag)和相关方法的文档。它的第二个参数是一个包含选择框选项标签的字符串。您可以手动生成：

```
select_tag "people", "<option>David</option>".html_safe 
```

或者使用**options_from_collection_for_select**方法：

```
select_tag "people", options_from_collection_for_select(@people, "id", "name") 
```

（来自文档的示例）

特别是在您的情况下，制作该下拉菜单的最佳方法是：

```
<div class="field">
    <%= select_tag("Ingredients", options_from_collection_for_select(Ingredient.all, 'id', 'name')) %>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:11:49.067

你也可以[`collection_select`](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-collection_select)像这样使用：

```
<%= collection_select :recipe, :ingredient_id, Ingredient.all, :id, :name, { prompt: "&ndash; Select an Ingredient &ndash;".html_safe } %> 
```

（我假设您尝试将成分 ID 分配给的父对象是`:recipe`。更改该值以适合您的应用程序。）

# wpf - 如果 ItemsSource 绑定到 linq 表达式，则无法编辑 DataGrid 单元格

> ID：10366039
> 
> 赞同：0
> 
> 时间：2012-04-28T17:51:02.073
> 
> 标签：wpf, mvvm, wpfdatagrid

当我尝试在网格视图中编辑项目时，出现异常“此视图不允许使用‘EditItem’”。这是因为我将数据网格绑定到 LINQ 查询。我的问题是如何过滤我的原始项目集合？我是否必须创建另一个 ObservableCollection（或其他任何实现 IList）并在那里复制我过滤的项目？

编辑：我知道将数据复制到 ObservableCollection 是可行的。我的问题是：给定原始集合，是否有一种内存高效（恒定的内存复杂度）方法来过滤和/或排序集合并使其在网格视图中可编辑？

```
 `private readonly ObservableCollection tasks = new ObservableCollection();

        public IEnumerable OrderedTasks
        {
            get
            {
                return this.tasks.Where(t => !t.Complete);
            }
        }` 
```

 `````
    <DataGrid ItemsSource="{Binding OrderedTasks}" />

`````

# php - 使用 PHP 查找 mac 书籍规格

> ID：10366042
> 
> 赞同：0
> 
> 时间：2012-04-28T17:51:25.050
> 
> 标签：php, javascript

我计划构建一个应用程序/站点，它将根据您的 Apple 产品序列号（特别是 Mac）为您提供信息。有很多网站可以做到这一点，但我不确定如何......一些例子是......

[http://www.powerbookmedic.com/identify-mac-serial.php](http://www.powerbookmedic.com/identify-mac-serial.php) [http://www.appleserialnumberinfo.com/Desktop/index.php](http://www.appleserialnumberinfo.com/Desktop/index.php)

我的想法是他们知道序列号结构并建立了所有可能选项的数据库并使用脚本来解码序列号。其他人对我如何做到这一点有任何见解吗？谢谢

# django - Django：如何将数据保存到 ManyToManyField？

> ID：10366045
> 
> 赞同：39
> 
> 时间：2012-04-28T17:51:34.777
> 
> 标签：django, django-models

我对以下模型有疑问。我想`ManyToManyField`从views.py 中填充，而不是从Admin 中填充。

但是如何将数据添加到`genres`字段中`ManyToManyField`？

**视图.py**

```
content = Movie_Info(id = m_id,
                    title = data[0].get('title'),
                    overview = data[0].get('overview'),
                    release_date = data[0].get('release_date'),
                )
content.save() 
```

**模型.py**

```
class Movie_Info_genre(models.Model):
    genre = models.CharField(max_length=100)

class Movie_Info(models.Model):
    id             = models.IntegerField(primary_key=True)
    title          = models.CharField(max_length=100, blank=True, null=True)
    overview       = models.TextField(blank=True, null=True)
    release_date   = models.CharField(max_length=10, blank=True, null=True)
    genres         = models.ManyToManyField(Movie_Info_genre) 
```

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-04-28T17:57:15.270

对相关字段使用[add 方法](https://docs.djangoproject.com/en/dev/ref/models/relations/#django.db.models.fields.related.RelatedManager.add)：

```
# using Model.object.create is a shortcut to instantiating, then calling save()
myMoveInfo = Movie_Info.objects.create(title='foo', overview='bar')
myMovieGenre = Movie_Info_genre.objects.create(genre='horror')
myMovieInfo.genres.add(myMoveGenre) 
```

与修改其他字段不同，在执行此操作之前，两个模型都必须存在于数据库中，因此您必须`save`在添加多对多关系之前调用。由于添加会立即影响数据库，因此您无需在之后保存。

# c++ - C++ Eigen 库如何比专门的供应商库执行得更好？

> ID：10366054
> 
> 赞同：50
> 
> 时间：2012-04-28T17:52:25.420
> 
> 标签：c++, performance, eigen

我正在查看性能基准：[http ://eigen.tuxfamily.org/index.php?title=Benchmark](http://eigen.tuxfamily.org/index.php?title=Benchmark)

我不禁注意到 eigen 似乎始终优于所有专门的供应商库。问题是：这怎么可能？有人会假设 mkl/goto 将使用处理器特定的调整代码，而 eigen 是相当通用的。

注意这个[http://download.tuxfamily.org/eigen/btl-results-110323/aat.pdf](http://download.tuxfamily.org/eigen/btl-results-110323/aat.pdf)，本质上是一个 dgemm。对于 N=1000，Eigen 得到大约 17Gf，MKL 只有 12Gf

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-04-28T18:06:44.260

Eigen 有惰性求值。从[Eigen 与 BLAS/LAPACK 相比如何？](http://eigen.tuxfamily.org/index.php?title=FAQ#How_does_Eigen_compare_to_BLAS.2FLAPACK.3F)：

> 对于涉及复杂表达式的操作，Eigen 本质上比任何 BLAS 实现都要快，因为它可以全局处理和优化整个操作——而 BLAS 迫使程序员将复杂操作拆分为与 BLAS 固定功能 API 匹配的小步骤，这会导致效率低下由于引入了临时工。例如，参见 a Y = a *X + b* Y 操作的基准测试结果，该操作涉及对 BLAS level1 例程的两次调用，而 Eigen 自动生成单个矢量化循环。

[基准测试](http://eigen.tuxfamily.org/index.php?title=Benchmark)中的第二个图表是`Y = a*X + b*Y`，Eigen 是专门为处理而设计的。难怪图书馆在创建它的基准测试中获胜。您会注意到，更通用的基准测试（例如矩阵-矩阵乘法）对 Eigen 没有任何优势。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2015-12-31T13:52:42.857

*基准测试旨在被误解*。

让我们看一下矩阵*矩阵乘积。[Eigen 网站上此页面](http://eigen.tuxfamily.org/index.php?title=Benchmark)上提供的基准告诉您，Eigen（具有自己的 BLAS）提供的时序类似于大型矩阵（n = 1000）的 MKL。我已经在我的计算机（具有核心 i7 的笔记本电脑）上比较了 Eigen 3.2.6 和 MKL 11.3，对于使用一个线程的此类矩阵，MKL 比 Eigen 快 3 倍，比使用 4 个线程的 Eigen 快 10 倍。这看起来是一个完全不同的结论。有两个原因。Eigen 3.2.6（其内部 BLAS）不使用 AVX。此外，它似乎并没有很好地使用多线程。该基准测试隐藏了这一点，因为他们使用的 CPU 不支持多线程，但不支持 AVX。

通常，那些 C++ 库（Eigen、Armadillo、Blaze）会带来两件事：

*   *不错的运算符重载*：您可以将 +、* 与向量和矩阵一起使用。为了获得良好的性能，他们必须使用称为“智能模板表达式”的棘手技术，以避免在减少时间时出现临时性（例如 y = alpha x1 + beta x2 with y, x1, x2 向量）并引入当它们有用时（例如 A = B * C 与 A、B、C 矩阵）。它们还可以重新排序操作以减少计算量，例如，如果 A、B、C 是矩阵 A * B * C 可以根据它们的大小计算为 (A * B) * C 或 A * (B * C)。
*   *内部 BLAS*：要计算 2 个矩阵的乘积，它们可以依赖其内部 BLAS 或外部提供的一个（MKL、OpenBLAS、ATLAS）。在具有大型矩阵的英特尔芯片上，MKL 几乎不可能被击败。对于小型矩阵，可以击败 MKL，因为它不是为此类问题而设计的。

通常，当这些库提供针对 MKL 的基准测试时，它们通常使用旧硬件，并且不会打开多线程，因此它们可以与 MKL 相提并论。他们还可能将 BLAS 1 级操作（例如 y = alpha x1 + beta x2）与 2 次调用 BLAS 1 级函数进行比较，这无论如何都是一件愚蠢的事情。

*简而言之*，这些库对于 + 和 * 的重载非常方便，而这在不损失性能的情况下很难做到。他们通常在这方面做得很好。但是当他们给你基准说他们可以用自己的 BLAS 达到或击败 MKL 时，要小心并做你自己的基准。你通常会得到不同的结果;-)。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-09-27T21:29:39.483

## 关于 ATLAS 与 Eigen 的比较

从这里开始查看 Eigen 邮件列表上的这个线程：

*   [http://listengine.tuxfamily.org/lists.tuxfamily.org/eigen/2012/07/msg00052.html](http://listengine.tuxfamily.org/lists.tuxfamily.org/eigen/2012/07/msg00052.html)

例如，它表明 ATLAS 在矩阵-矩阵乘积上的表现优于 Eigen 46%：

*   [http://listengine.tuxfamily.org/lists.tuxfamily.org/eigen/2012/07/msg00062.html](http://listengine.tuxfamily.org/lists.tuxfamily.org/eigen/2012/07/msg00062.html)

可以在此处找到更多基准测试结果和有关如何完成基准测试的详细信息：

*   Intel(R) Core(TM) i5-3470 CPU @ 3.20GHz：

    [http://www.mathematik.uni-ulm.de/~lehn/bench_FLENS/index.html](http://www.mathematik.uni-ulm.de/%7Elehn/bench_FLENS/index.html)

*   [http://sourceforge.net/tracker/index.php?func=detail&aid=3540928&group_id=23725&atid=379483](http://sourceforge.net/tracker/index.php?func=detail&aid=3540928&group_id=23725&atid=379483)

编辑：

在我的讲座“高性能计算的软件基础”中，我创建了一个名为 ulmBLAS 的小框架。[它包含 ATLAS 基准套件，学生可以根据BLIS](https://code.google.com/p/blis/)论文实现自己的矩阵矩阵产品。您可以查看也测量 Eigen 的最终基准：

*   [http://www.mathematik.uni-ulm.de/~lehn/sghpc/gemm/page14/index.html#toc5](http://www.mathematik.uni-ulm.de/%7Elehn/sghpc/gemm/page14/index.html#toc5)

您可以使用[ulmBLAS](http://apfel.mathematik.uni-ulm.de/%7Elehn/ulmBLAS/)框架进行自己的基准测试。

也看看

*   [使用 uBLAS 进行矩阵-矩阵乘积实验](http://www.mathematik.uni-ulm.de/%7Elehn/test_ublas/index.html)
*   [使用 BLAZE 进行矩阵-矩阵乘积实验](http://www.mathematik.uni-ulm.de/%7Elehn/test_blaze/index.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-27T06:51:42.410

通用代码可以很快，因为编译时函数评估 (CTFE) 允许选择最佳寄存器阻塞策略（存储在 CPU 寄存器中的小型临时子矩阵）。

Mir GLAS 和 Intel MKL 比 Eigen 和 OpenBLAS 更快。与 Eigen 相比，Mir GLAS 更通用。另请参阅[基准](http://blog.mir.dlang.io/glas/benchmark/openblas/2016/09/23/glas-gemm-benchmark.html)和[reddit 线程](https://www.reddit.com/r/programming/comments/54kg6v/numeric_age_for_d_mir_glas_is_faster_than/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-10T14:02:07.577

我前段时间向 ATLAS 邮件列表发送了同样的问题：

[http://sourceforge.net/mailarchive/message.php?msg_id=28711667](http://sourceforge.net/mailarchive/message.php?msg_id=28711667)

Clint（ATLAS 开发人员）不信任这些基准。他建议了一些值得信赖的基准程序。只要我有一些空闲时间，我就会做这种基准测试。

如果 Eigen 的 BLAS 功能实际上比 GotoBLAS/GotoBLAS、ATLAS、MKL 更快，那么它们无论如何都应该提供标准的 BLAS 接口。这将允许将 LAPACK 链接到这样的 Eigen-BLAS。在这种情况下，这对于 Matlab 和朋友来说也是一个有趣的选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-28T18:02:22.250

从您链接的页面下方的图表中可以看出，它似乎并没有始终优于其他库。所以不同的库针对不同的用例进行了优化，不同的库针对不同的问题速度更快。

这并不奇怪，因为您通常无法针对*所有*用例进行完美优化。针对一项特定操作进行优化通常会限制其他用例的优化选项。

# ruby-on-rails - 在带有错误屏幕的rails中以开发模式运行服务器

> ID：10366055
> 
> 赞同：0
> 
> 时间：2012-04-28T17:52:30.650
> 
> 标签：ruby-on-rails

我尝试在开发模式下使用服务器，它会在 html 页面上出现错误，而不是消息“我们很抱歉，但出了点问题。”。它以开发模式启动，但没有给出错误信息，仍然给出同样的愚蠢信息。我怎样才能让它打开错误信息。发生错误时在html页面上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:17:14.367

在您的环境文件中， development.rb 或 production.rb 执行以下操作：

```
config.consider_all_requests_local = true 
```

# java - 从独立 Java 客户端以编程方式创建 WebLogic 用户

> ID：10366058
> 
> 赞同：3
> 
> 时间：2012-04-28T17:52:52.457
> 
> 标签：java, weblogic, jmx

我正在尝试从一个简单的独立Java客户端（一个类->两种方法：createWeblogicUser（）和main（））以编程方式在WebLogic（10.3.4）中创建用户。

```
public void createWeblogicUser() {
try {
    Hashtable<String, String> env = new Hashtable<String, String>();
    env.put(Context.INITIAL_CONTEXT_FACTORY, "weblogic.jndi.WLInitialContextFactory");
    env.put(Context.SECURITY_PRINCIPAL, "weblogic");
    env.put(Context.SECURITY_CREDENTIALS, "weblogic");
    env.put(Context.PROVIDER_URL, "t3://myserver:7001");

    InitialContext ctx = new InitialContext(env);
    MBeanServer wls = (MBeanServer) ctx.lookup("java:comp/env/jmx/runtime");

    ObjectName userEditor = null;
    ObjectName mBeanTypeService = new ObjectName( "com.bea:Name=MBeanTypeService, Type=weblogic.management.mbeanservers.MBeanTypeService");
    ObjectName rs = new ObjectName("com.bea:Name=RuntimeService, Type=weblogic.management.mbeanservers.runtime.RuntimeServiceMBean");
    ObjectName domainMBean = (ObjectName) wls.getAttribute(rs, "DomainConfiguration");
    ObjectName securityConfig = (ObjectName) wls.getAttribute(domainMBean, "SecurityConfiguration");
    ObjectName defaultRealm = (ObjectName) wls.getAttribute(securityConfig, "DefaultRealm");
    ObjectName[] authProviders = (ObjectName[]) wls.getAttribute(defaultRealm, "AuthenticationProviders");

    for(ObjectName providerName : authProviders) {
        if(userEditor == null) {
            ModelMBeanInfo info = (ModelMBeanInfo) wls.getMBeanInfo(providerName);
            String className = (String) info.getMBeanDescriptor().getFieldValue("interfaceClassName");
            if(className != null) {
                String[] mba = (String[]) wls.invoke(mBeanTypeService
                                                    , "getSubtypes"
                                                    , new Object[] {"weblogic.management.security.authentication.UserEditorMBean"}
                                                    , new String[] {"java.lang.String"}
                                            );
                for(String mb : mba) {
                    if(className.equals(mb))
                        userEditor = providerName;
                }
            }
        }

        if(userEditor == null)
            throw new RuntimeException("Could not retrieve user editor");

        try {
            wls.invoke(userEditor
                        , "createUser"
                        , new Object[] {"wls_user", "password123","User created programmatically."}
                        , new String[] {"java.lang.String", "java.lang.String","java.lang.String"}
            );
        }
        catch(Exception e){
            e.printStackTrace();
        }

        ctx.close();
    }
}
catch(Exception ex) {
    ex.printStackTrace();
} 
```

}

关于我应该进行什么上下文查找的任何想法？“java:comp”抛出 javax.naming.NameNotFoundException；看起来我只能在容器中使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T04:43:55.847

让它工作。

```
private void createWeblogicUser(String username) {
try {
    Hashtable<String, String> env = new Hashtable<String, String>();
    env.put(Context.SECURITY_PRINCIPAL, "weblogic");
    env.put(Context.SECURITY_CREDENTIALS, "weblogic");

    String hostname = "myserver";
    int port = 7001;
    String protocol = "rmi";
    String url= new String("/jndi/iiop://myserver:7001/weblogic.management.mbeanservers.domainruntime");

    JMXServiceURL serviceURL = new JMXServiceURL(protocol, hostname, port, url);
    JMXConnector connector = JMXConnectorFactory.connect(serviceURL, env);
    MBeanServerConnection connection = connector.getMBeanServerConnection();

    ObjectName userEditor = null;
    ObjectName mBeanTypeService = new ObjectName( "com.bea:Name=MBeanTypeService,Type=weblogic.management.mbeanservers.MBeanTypeService");
    ObjectName rs = new ObjectName("com.bea:Name=DomainRuntimeService,Type=weblogic.management.mbeanservers.domainruntime.DomainRuntimeServiceMBean");
    ObjectName domainMBean = (ObjectName) connection.getAttribute(rs, "DomainConfiguration");
    ObjectName securityConfig = (ObjectName) connection.getAttribute(domainMBean, "SecurityConfiguration");
    ObjectName defaultRealm = (ObjectName) connection.getAttribute(securityConfig, "DefaultRealm");
    ObjectName[] authProviders = (ObjectName[]) connection.getAttribute(defaultRealm, "AuthenticationProviders");

    for(ObjectName providerName : authProviders) {
        System.out.println("Auth provider is: " + providerName) ;

        if(userEditor == null) {
            ModelMBeanInfo info = (ModelMBeanInfo) connection.getMBeanInfo(providerName);
            String className = (String) info.getMBeanDescriptor().getFieldValue("interfaceClassName");
            System.out.println("className is: " + className) ;

            if(className != null) {
                String[] mba = (String[]) connection.invoke(mBeanTypeService
                                        , "getSubtypes"
                                        , new Object[] {"weblogic.management.security.authentication.UserEditorMBean"}
                                        , new String[] {"java.lang.String"}
                                    );
                for(String mb : mba) {
                    System.out.println("Model Bean is: " + mb) ;
                    if(className.equals(mb)) {
                        System.out.println("Found a macth for the model bean and class name!") ;
                        userEditor = providerName;
                    }
                }
            }
        }
    }

    if(userEditor == null)
        throw new RuntimeException("Could not retrieve user editor");

    try {
        connection.invoke(userEditor
                    , "createUser"
                    , new Object[] {username, "password123","User created programmatically."}
                    , new String[] {"java.lang.String", "java.lang.String","java.lang.String"}
        );

        System.out.println("User created successfully") ;
    }
    catch(Exception e){
        e.printStackTrace();
    }

    connector.close();

}
catch(Exception ex) {
    ex.printStacktrace();
} 
```

}

您只需要类路径中的 weblogic.jar 和 wljmxclient.jar。我在 JDK 1.6.0_29 上运行了这个。我必须补充一点，我在一台也安装了 WebLogic 的机器上运行了它。所以类路径条目是 jar 文件的完全限定路径名。

我遇到了一个“陷阱”：在提供“com.bea:Name=XXXX,Type=XXXX”时，不要在任何东西之间留一个空格——不是冒号；不是逗号；什么都没有——我花了一些时间调试它，然后才终于成功。

# java - JDialog 处理另一个窗口

> ID：10366062
> 
> 赞同：0
> 
> 时间：2012-04-28T17:53:30.003
> 
> 标签：java, swing, jdialog

我目前正在开发一个带有“开始屏幕”框架的 java 游戏。在开始屏幕中，我有一个名为 buttonLogin 的按钮。按下 buttonLogin 后，会弹出一个由 LoginDialog 类启动的登录对话框，要求您输入用户名和密码。在对话框中有两个按钮，登录和取消。按下登录后，我的游戏将打开，但开始屏幕仍然可见。

我的问题是我不知道如何在 LoginDialog 类的 actionPerformed 方法中编写代码来关闭现有的 StartScreen 窗口。

请记住，我是在 LoginDialog 类而不是 StartScreen 类中编写的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:59:41.823

根据您要实现的目标，您可以使用`setVisible`方法或`dispose`方法。

如果需要，您可以将您的`StartScreen`实例作为参数传递给您的`LoginDialog`类。

另一种方法是为您的`LoginDialog`班级提供“登录后”操作的设置器。然后`StartScreen`可以创建并设置一个配置启动屏幕的操作。

*编辑*

为了使“登录后”操作更加清晰，我的意思是

```
public class LoginDialog{
  Action afterLoginAction;
  public void setAfterLoginAction( Action action ){
    afterLoginAction = action;
  }
  public void loginButtonPressed(){
    //do your stuff
    if ( afterLoginAction != null ){
      afterLoginAction.actionPerformed( new ActionEvent( ... ) );
    }
  }
}

public class StartScreen extends JWindow{
  public void showLoginScreen(){
    LoginDialog loginDialog = new LoginDialog();
    loginDialog.setAfterLoginAction( new Action(){
       @Override
       public void actionPerformed( ActionEvent e ){
           StartScreen.this.dispose();
       }
     } );
    loginDialog.setVisible( true );
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:00:46.497

`dispose();`JDialog类的使用方法

# apache - 错误 404 显示问题

> ID：10366064
> 
> 赞同：1
> 
> 时间：2012-04-28T17:53:46.437
> 
> 标签：apache, .htaccess, http-status-code-404

我需要有关我网站的错误 404 显示的帮助。当我输入错误的 URL 时，我得到一个错误 500 显示。如果我将 URL 更改为我确定位于根目录中的页面，我仍然会得到相同的错误 500 显示。

请问问题出在哪里。

.htaccess 文件和 404.php 都在同一个目录（ root ）中......

以下是我的 .htaccess 文件的内容

```
 ErrorDocument 404/church/404.php 
```

这是 Apache 错误文件中的错误

```
 [Sat Apr 28 9:10:04] [alert] [client 127\.     0\. 0.1] C:/wamp/www/church/.                        htaccess: ErrorDocument takes two          arguments, Change responses for HTTP       errors 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:56:37.143

你错过了一个空格：它应该说`ErrorDocument 404 /church/404.php`. （好吧，我不能绝对保证这会奏效，因为我不知道你的文件系统中有什么，但这绝对比你现在拥有的更正确。）

# c++ - 插入运算符重载有什么问题？（<< 运算符）

> ID：10366072
> 
> 赞同：1
> 
> 时间：2012-04-28T17:54:45.500
> 
> 标签：c++, overloading, operator-keyword, insertion

我必须重载插入运算符才能以矩阵格式查看我的类对象。我写了代码，但出了点问题。当我将它包含到我的代码中并尝试构建时，编译器会给我大量错误；当我评论那部分时，错误消失了，程序正常工作。这是代码：

```
 template <class itemType> 
ostream & operator<< (ostream & os, const Storage2D<itemType> & rhs)
{
    node<itemType>* ptrRow = rhs.head;
    node<itemType>* ptrColumn = rhs.head;
    for(; ptrColumn->down != NULL; ptrColumn = ptrColumn->down)
    {
        ptrRow = ptrColumn;
        for(; ptrRow->right != NULL; ptrRow = ptrRow->right)
        {
            os << ptrRow->info << setw(10);
        }
        os << ptrRow->info << setw(10) << endl;
    }

    return os;
} 
```

以下是我尝试使用主函数重载的方法：

```
Storage2D<double> m(row, column); 
cout << m; 
```

它不是 Storage2D 类的成员函数，它是在实现文件中的 Storage2D 类范围之外编写的。

如果您能帮助我，那就太好了，在此先感谢。

编辑：这是我的其余代码。Storage2D.h 文件：

```
template <class itemType>
struct node
{
    itemType info;
    node* right;
    node* down;

    node()
    {}

    node(itemType data, node* r = NULL, node* d = NULL)
    {
        info = data;
        right = r;
        down = d;
    }
};

template <class itemType>
class Storage2D
{
public:
    Storage2D(const int & , const int & );      //constructor
    //~Storage2D();                             //destructor
    //Storage2D(const Storage2D & );                //deep copy constructor

private:
    node<itemType>* head;
};

ostream& operator<< (ostream & os, const Storage2D & rhs);

#include "Storage2D.cpp" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:05:59.003

`head`是私有的，因此操作员需要成为朋友才能访问该数据成员。它还需要声明为函数模板，因为 Storage2D 是类模板：

```
#include <iostream> // for std::ostream

template <class itemType>
class storage2D {
// as before
template <typename T> 
friend std::ostream& operator<< (std::ostream & os, const Storage2D<T> & rhs);
};

// declaration
template <typename T> 
std::ostream& operator<< (std::ostream & os, const Storage2D<T> & rhs); 
```

请注意，我已明确使用`std::ostream`, 因为`ostream`is 在`std`名称空间中。

# .net - 多态性是否会干扰 NHibernate 的批量插入/更新功能？

> ID：10366076
> 
> 赞同：4
> 
> 时间：2012-04-28T17:55:30.057
> 
> 标签：.net, nhibernate, polymorphism, batching

我有一个像这样的类结构：

```
public class Person
{
    public virtual int Id { get; protected internal set; }
    public virtual string Name { get; set; }
}

public class Customer : Person
{
    public virtual string AccountNumber { get; set; }
} 
```

`Customer`被映射为`Person`（使用 FluentNHibernate 的`SubclassMap<T>`）的子类，并且表结构是每个子类的表（单独的`Person`并且`Customer`表共享一`Id`列）。

在我的测试中，我打开一个无状态会话并尝试插入一系列`Person`实体：

```
using (var stateless = sessionFactory.OpenStatelessSession())
using (var transaction = stateless.BeginTransaction())
{
    var persons = new[]
    {
        new Person { Name = "Alice" },
        new Person { Name = "Bob" },
        new Customer { Name = "Cathy", AccountNumber = "001" },
        new Customer { Name = "Dave", AccountNumber = "002" }
    };
    foreach (var person in persons)
        stateless.Insert(person);
    transaction.Commit();
} 
```

如果我在`ShowSql`打开开关的情况下运行它，我可以看到表上没有生成**任何** `INSERT`语句`Person`（这意味着它们是批处理的），但是**为**`INSERT`表生成了单独的语句`Customer`（我从中推断这些语句*没有*被批处理）。

奇怪的是，我发现如果派生类型（即）`Customer`有它自己的集合（我们称它们为解决关系没有问题。这种行为似乎完全限于多态实体的派生类。`Orders``Insert`

这是预期的行为吗？如果是这样，有什么方法可以重写上面的插入代码以确保所有子类表也被批处理？

（注意：我使用的`SequenceHiLoGenerator`是所有 ID，并且我已经进行了相应的配置`AdoNetBatchSize`，所以据我所知，这*不是*`HiLo`批处理的一般问题。我可以看到当批处理操作发生时该表被命中.)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T22:52:57.443

经过几天的挖掘和实验，答案似乎是“是”。有各种[分散的博客文章](http://xhalent.wordpress.com/2011/03/24/a-few-ideas-to-improve-nhibernate-performance/)顺便提到 NHibernate 在批处理子类时遇到问题 - 特别是在使用**每个子类**策略的表时（我一直在使用）。

这不是 table-per-class-hierarchy 策略的问题。不幸的是，改变持久性模型对我来说已经太晚了（另外，从关系数据库设计的角度来看，我真的不喜欢 TPH），所以我不得不考虑其他选项。

对于插入，我能够通过以下方式解决该问题：

1.  使基类具体化（它曾经是抽象的）；
2.  制作每个要插入的对象的浅拷贝（仅构建基类）；
3.  照常插入副本；
4.  刷新会话以满足参照完整性约束；
5.  用于 `SqlBulkCopy`将派生类插入到它们自己的表中，使用一些基于强制转换的可怕巫术`IClassMetadata`来`AbstractEntityPersister`获取所有列/表映射；
6.  像往常一样使用该方法插入由子类拥有的任何映射集合`IStatelessSession.Insert`（对具有自己的类层次结构的集合重复此过程）。

我想，如果不依赖硬编码的表/列名，更新会复杂得多，而且可能很难处理；如果我必须这样做，我可能会改用存储过程（使用表值参数或临时表）。

生成的代码看起来并不令人愉快，但它带来了显着的性能提升——对于大约 20-30k 的正常大小的批次，至少提升了 25%。

# api - New Relic API - 实例和主机之间的区别？

> ID：10366080
> 
> 赞同：0
> 
> 时间：2012-04-28T17:55:56.280
> 
> 标签：api, hosts, instances, newrelic

参考[https://github.com/newrelic/newrelic_api](https://github.com/newrelic/newrelic_api)的 New Relic API，我想知道主机和实例之间有什么区别。

基本上，我知道什么是应用程序以及什么是服务器（显然）。我会假设实例是应用程序的实例，即如果我的应用程序在 Heroku 上运行，每个实例将对应于运行我的应用程序的测功机。但是，什么是主机？主机和实例之间有什么区别？

谢谢，

-比利

**更新**

感谢你的回答！

因此，如果我做对了，在一般情况下，应用程序和实例之间的映射是一对一的，即每个应用程序可以有 1 个或多个实例。此外，实例和主机之间的映射是 n 到 m 的，即每个实例最多可以在一个主机上运行（在任何给定时间），但实例分布在可用主机之间。同样，主机分布在服务器之间（例如，m-to-s）。是这样吗？（抱歉，如果这听起来像是我在说非常明显的东西，但我不熟悉他们在 New Relic 使用的术语）

如果以上内容正确，我如何从 API 获取实例 - 主机和主机 - 服务器映射？我可以看到如何获取应用程序 - 实例和应用程序 - 主机，但是其他两个呢？

再次感谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-29T04:00:46.367

主机（服务器）可以运行应用程序的许多实例。从 New Relic 的角度来看，响应请求的每个进程（例如 Unicorn worker）都是一个实例。主机/实例的区别大致相当于IP地址和端口的区别。

如果您使用 Heroku，New Relic 会将整个测功机网格视为单个主机/服务器，并将每个测功机视为一个实例。

*回复：更新的问题*

主机是运行应用程序的机器或虚拟机，每个主机可以运行应用程序的 N 个实例。

就 NR API 而言，“服务器”是由 New Relic Server Monitoring 监控的 OS+硬件。NR 应用程序监控代理也可以在服务器监控代理监控的服务器上运行。在这种情况下，主机和服务器都应该向 New Relic 报告相同的名称（“server01.example.com”）。

没有办法从 New Relic API 显式获取实例主机或主机服务器映射。但在服务器主机的情况下，映射是它们共享相同的名称。您也可以从实例名称中推断出实例主机映射，因为它们几乎总是包含主机名（可能还包含端口号）。

# javascript - 将本地 .js 文件注入网页？

> ID：10366084
> 
> 赞同：12
> 
> 时间：2012-04-28T17:56:44.270
> 
> 标签：javascript, html, code-injection

我想将几个本地 .js 文件注入网页。我只是指客户端，就像在我的浏览器中一样，我不需要其他任何人访问该页面就能看到它。我只需要获取一个 .js 文件，然后制作它，就好像该文件一直通过`<script>`标签包含在页面的 html 中一样。

如果在页面加载后需要一秒钟以使本地文件中的内容可用，这没关系。

如果我必须在计算机上使用控制台或其他东西“手动”执行此操作，那也没关系。

这两天我一直在尝试这样做，我尝试过 Greasemonkey，我尝试过使用 JavaScript 控制台手动加载文件。令我惊讶的是，没有（显然）一种既定的方法可以做到这一点，这似乎是一件很简单的事情。不过，我想简单和普通不一样。

如果有帮助，我想这样做的原因是在基于 JS 的聊天客户端上运行聊天机器人。一些机器人的代码混合到预先存在的聊天代码中——为此，我让 Fiddler 拦截对 .../chat.js 的请求并将其替换为本地文件。但是我有两个 .js 文件，它们“独立于”页面本身的任何内容。页面请求的任何 .js 文件都没有我可以替换它们，所以我不能使用 Fiddler。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T18:26:51.207

由于您已经使用提琴手脚本，您可以在`OnBeforeResponse(oSession: Session)`函数中执行类似的操作

```
 if ( oSession.oResponse.headers.ExistsAndContains("Content-Type", "html") &&
         oSession.hostname.Contains("MY.TargetSite.com") ) {

        oSession.oResponse.headers.Add("DEBUG1_WE_EDITED_THIS", "HERE");

        // Remove any compression or chunking
        oSession.utilDecodeResponse();

        var oBody = System.Text.Encoding.UTF8.GetString(oSession.responseBodyBytes);

        // Find the end of the HEAD script, so you can inject script block there.
        var oRegEx = oRegEx = /(<\/head>)/gi
        // replace the head-close tag with new-script + head-close 
        oBody = oBody.replace(oRegEx, "<script type='text/javascript'>console.log('We injected it');</script></head>");

        // Set the response body to the changed body string
        oSession.utilSetResponseBody(oBody); 
    } 
```

www.html5rocks.com 的工作示例：

```
 if ( oSession.oResponse.headers.ExistsAndContains("Content-Type", "html") &&
         oSession.hostname.Contains("html5rocks") ) { //goto html5rocks.com
        oSession.oResponse.headers.Add("DEBUG1_WE_EDITED_THIS", "HERE");
        oSession.utilDecodeResponse();
        var oBody = System.Text.Encoding.UTF8.GetString(oSession.responseBodyBytes);
        var oRegEx = oRegEx = /(<\/head>)/gi
        oBody = oBody.replace(oRegEx, "<script type='text/javascript'>alert('We injected it')</script></head>");
        oSession.utilSetResponseBody(oBody); 
    } 
```

请注意，您必须在 fiddler 中关闭流式传输：[http](http://www.fiddler2.com/fiddler/help/streaming.asp) ://www.fiddler2.com/fiddler/help/streaming.asp ，我假设您需要解码 HTTPS：[http ://www.fiddler2.com/fiddler/帮助/httpsdecryption.asp](http://www.fiddler2.com/fiddler/help/httpsdecryption.asp)

我越来越少地使用提琴手脚本，支持提琴手 .Net 扩展 - [http://fiddler2.com/fiddler/dev/IFiddlerExtension.asp](http://fiddler2.com/fiddler/dev/IFiddlerExtension.asp)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T19:10:22.730

如果您使用的是 Chrome，请查看[dotjs](https://github.com/defunkt/dotjs)。

它会做你想要的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T18:00:36.487

只使用 jquery 的 jQuery.getScript() 方法怎么样？

[http://api.jquery.com/jQuery.getScript/](http://api.jquery.com/jQuery.getScript/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T18:01:05.577

将普通的 html 页面保存到文件系统，手动添加 js 文件，然后使用 fiddler 拦截这些调用，以便获得您的 html 文件版本

# xcode - 使用 Storyboard 组织 iOS 应用程序

> ID：10366089
> 
> 赞同：1
> 
> 时间：2012-04-28T17:57:01.587
> 
> 标签：xcode, organization

我是 iOS 编程的新手，并且是我的组织怪胎，我希望为我正在处理的所有事情都有一个干净的结构。

1.  我应该创建真正的文件夹来代表我在 Xcode 中创建的组并以这种方式组织我的代码吗？
2.  我应该将我现在拥有的组重命名为任何其他名称吗？
3.  我将需要一个 API，我应该把它放在哪里？

这是我目前的布局：

![在此处输入图像描述](../Images/0aefbc8e209218a86bd407b620d2a5a3.png)

本项目开源：[https ://github.com/kirkuimet/enzyme](https://github.com/kirkouimet/enzyme)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T20:22:07.507

这真的取决于你。这有点主观，但通常 Xcode 的项目模板提供了一个良好的开端。通常，除了前几个根级目录之外，我更喜欢组而不是文字文件夹引用。

这是我的项目的典型文件系统结构：

![在此处输入图像描述](../Images/70869f356227acef1adfda16aef86f70.png)

这是我的 Xcode 项目结构通常的样子：

![在此处输入图像描述](../Images/ed5b5e8189af4ef3378b7cd9da5de2fc.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:18:35.990

这是一个很棒的故事板教程系列。不确定它是否会回答您所有的组织问题，但仍然是一个不错的起点：

[故事板教程系列](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)

# java - 查找何时发生右键单击，停止其效果并替换为 java 或 python 中的 shift click

> ID：10366091
> 
> 赞同：-2
> 
> 时间：2012-04-28T17:57:05.467
> 
> 标签：java, python, macos, hotkeys, right-click

无论如何要忽略右键单击，然后在Java / Python中右键单击的位置用shift单击替换它？请注意，这应该在整个计算机中全局发生。另请注意，这是在 Mac OSX 中。

谢谢，

奥丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:45:51.080

这取决于操作系统或窗口管理器的实现。为此，应该在这些事件中加入某种“挂钩”（例如右键单击），以及触发它的上下文（例如右键单击桌面/文件夹/文件）。

但是，即使在您的操作系统上可行，您也不太可能选择实现这种东西的语言。

# c++ - 如何使用 alglib 添加矩阵？

> ID：10366092
> 
> 赞同：4
> 
> 时间：2012-04-28T17:57:05.923
> 
> 标签：c++, matrix, alglib

我已经知道如何将两个矩阵与 alglib 相乘，使用`rmatrixgemm`（见[这个问题](https://stackoverflow.com/questions/5607631/matrix-multiplication-alglib)）。

有没有办法在不使用这个函数的情况下计算两个矩阵的线性组合，设置`B`为 identity ？效率不会很高。

Alglib 提供了大量复杂的算法，但我找不到这样的基本功能。

手册在[这里](http://www.alglib.net/translator/man/manual.cpp.html)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-08-02T05:19:11.263

你也许可以只使用 alglib.cmatrixgemm 来做加法。

该子程序计算 C = alpha*op1(A) *op2(B) +beta* C 其中：

*   C 是 MxN 通用矩阵
*   op1(A) 是 MxK 矩阵
*   op2(B) 是 KxN 矩阵
*   “op”可以是同一性转换、转座、共轭转座。

如果要做C = A + C，只需要设置：B = Identity, alpha = 1, beta = 1, op = identity transformation。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-05-10T21:51:29.447

您为什么不尝试使用另一个为矩阵数学而创建的库，例如 MTL4？

[http://www.simunova.com/en/node/24](http://www.simunova.com/en/node/24)

手册 - h​​ttp: [//www.simunova.com/node/148](http://www.simunova.com/node/148)

# php - 如何在 jQuery 中包含 php？

> ID：10366096
> 
> 赞同：-1
> 
> 时间：2012-04-28T17:57:23.057
> 
> 标签：php, jquery

假设我有一些这样的 html 文件：

```
<body>
   <div></div>
</body> 
```

鉴于我已经正确引用了 jQuery，并且我有一个 .js 文件，例如：

```
$(document).ready(function(){
    $('div').html(4);
}); 
```

在浏览器中查看 html 时将输出 4。为什么当我这样做时它什么都不显示？

```
 $(document).ready(function(){
    $('div').html(<?php echo 4; ?>);
 }); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T17:59:27.930

那么 .js 文件不是 PHP 文件。您也可以将 .js 文件重命名为`blah.js.php`您可以在该文件中执行 PHP 块的位置，但当您将其包含在页面中时，该文件仍会像 jQuery 一样运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:20:17.860

您应该尽量保持页面上的动态内容，并使 Javascript 文件保持静态。这将允许浏览器缓存您的 Javascript。因此，以下是如何将动态值转换为静态 Javascript。

您的页面应如下所示：

```
<html>
<body>
   <div></div>
    <script>
        var myNumber = <?php echo 4; ?>;
    </script>
</body>
</html> 
```

您的 Javascript 文件应如下所示：

```
$(document).ready(function(){
    $("div").html(myNumber);
}); 
```

# mysql - MySql 中的 STR_TO_DATE 给出错误

> ID：10366098
> 
> 赞同：0
> 
> 时间：2012-04-28T17:57:50.297
> 
> 标签：mysql

我在 mysql 中遇到了 STR_TO_DATE 的一些问题。以下是返回 NULL。

```
select str_to_date('2012-04-28 23:00:15', '%Y-%m-%d %h:%i:%s'); 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:03:21.890

您需要大写`%H`，而不是小写`%h`。

根据[文档](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)，

> %H 小时 (00..23)
> %h 小时 (01..12)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T18:06:36.400

也可以使用：

str_to_date('2012-04-28 23:00:15', '%Y-%m-%d %T')

# php - 单引号查询显示为空

> ID：10366099
> 
> 赞同：0
> 
> 时间：2012-04-28T17:57:52.303
> 
> 标签：php, mysql, forms, mysql-workbench

我有一个表格，当您选择文章下拉列表时，文本框会填入您选择的内容。现在它工作得非常好，除非文章名称中有“单引号”。

我有一个通过在引号前面放置反斜杠来转义引号的功能，它确实......

现在产生的查询如下：_

```
SELECT * FROM blogs WHERE title='MySQL \'Inject' AND series='iOS Game Dev.' AND language='iOS' LIMIT 1 
```

我有一个函数可以创建文章的对象并根据所选行设置所有内容的值。当我显示由运行查询的函数创建的数组时，它给出了这个..

```
Blog Object
(
 [id] => 
 [title] => 
 [publish_date] => 
 [author] => 
 [language] => 
 [series] => 
 [likes] => 
 [content] => 
 [position] => 
 [status] => 
 [last_updated] => 
) 
```

如果文章名称中没有单引号，它可以工作，但它不会填充文本框，因为数组是空的。

更多存储在数据库中的值是 MySQL \'Inject 。所以我真的不明白为什么要这样做，我什至尝试在 MySQL Workbench 中运行查询，但它什么也没返回。所以我很确定这在我的代码中不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:26:22.553

我建议您省去担心转义的所有痛苦，而只需使用准备好的语句，将变量作为参数传递到其中。

[这篇博客文章](http://mattbango.com/notebook/web-development/prepared-statements-in-php-and-mysqli/) 有一个很好的教程。

# android - Android 如何实现延时动作的服务？

> ID：10366101
> 
> 赞同：0
> 
> 时间：2012-04-28T17:57:54.330
> 
> 标签：android, multithreading, service

我实现了一些应用程序，它在行动前等待了一段时间。用户可以转到首选项并定义等待时间。我现在的问题是，如果我按下主页按钮，我将无法启动任何其他应用程序，因为我的应用程序占用了所有资源。我有一个 motorloa 里程碑，我的代码是（等待服务源代码的一部分）：

```
 public void run() {
while(currentTime>waitingTime)
{ currentTime = System.currentTimeMillis();
  Thread.sleep(1000);
}
  //do Action
} 
```

这是一个简单的线程，但它似乎非常无效。我会非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:02:07.627

用于`AlarmManager`安排`PendingIntent`在您指定的时间调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T18:08:10.350

你总是可以`Handler`用来安排一个`Message`. 但是您的应用程序需要处于运行状态才能在 Handler 的回调函数 mathod( `handleMessage(message)`) 中获得调用。另一种选择是去`AlarmManger`。

# database - 为网页游戏选择数据存储？

> ID：10366104
> 
> 赞同：0
> 
> 时间：2012-04-28T17:58:35.513
> 
> 标签：database

我正在使用 jQuery 和 PHP 创建一个模拟俄勒冈小径的游戏。

我需要一种简单的方法来存储场景和选择。我还需要一种方法，可以将用户所做的选择传递到带有 GET 变量的 PHP 页面中，并让 PHP 吐出更多选择和新场景。

我正在考虑使用平面文件或 SQLite。

最简单的数据库是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:01:33.253

这取决于您希望如何构建数据。

例如，如果您发现很多复杂的对象，那么对对象存储有良好支持的数据库系统最适合您的应用程序，如果只有几个原语，也许将所有客户端存储在 localStorage 中就足够了。

选择系统时需要考虑很多因素，主要围绕您要存储哪种数据以及您希望应用程序在哪里运行。

# ios - 您可以使用钥匙串跨配置文件共享数据吗？

> ID：10366108
> 
> 赞同：2
> 
> 时间：2012-04-28T17:59:23.283
> 
> 标签：ios, keychain

我想在两个开发人员配置文件之间共享应用程序数据这可能与钥匙串访问有关吗？

通过阅读文档，听起来您仅限于应用程序 ID 之前的标识符。例如：GUS8339.com.company.app 将限制您使用 GUS8339 配置文件签名的应用程序

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-01T00:52:55.263

你是对的，但它稍微复杂一些：

*   **配置文件必须具有相同的捆绑种子。**这是在您创建相应的“应用程序 ID”时设置的。应用程序可以在您将其提交到 App Store 后更改应用程序 ID，但请注意非通配符应用程序 ID 必须具有唯一的捆绑包 ID（即，如果您已经为应用程序设置了非通配符应用程序 ID，您只能将其更改为使用通配符应用 ID）。

*   **您必须让这两个应用程序访问相同的“钥匙串访问组”。**这是在应用程序权利中设置的。我认为 Xcode 现在有一个可以工作的 UI 来编辑这些。您可以使用通配符访问组，但我认为不建议这样做。

配置文件的相关部分如下所示（在您喜欢的文本编辑器中打开一个）：

```
<key>Entitlements</key>
<dict>
  <key>application-identifier</key>
  <string>A1B2C3D4E5.com.example.myapp</string>
  <key>aps-environment</key>
  <string>production</string>
  <key>get-task-allow</key>
  </false>
  <key>keychain-access-groups</key>
  <array>
    <string>A1B2C3D4E5.*</string>
  </array>
</dict> 
```

这限制了您可以在权利中添加的内容，但您应该能够指定类似的内容

```
 <key>keychain-access-groups</key>
  <array>
    <string>A1B2C3D4E5.com.example.myappsuite</string>
  </array> 
```

请注意，您可能需要将此指定给钥匙串 API！

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-30T21:56:12.653

钥匙串访问组取决于捆绑种子 ID - 您的配置文件所独有的值“GUS8339”。因此，要更直接地回答，不，您不能跨不同的配置文件使用访问组，因为种子 ID 基本上是您示例中的配置文件 ID。

# python - Python/Django：简单的 Django 模板

> ID：10366111
> 
> 赞同：1
> 
> 时间：2012-04-28T17:59:35.980
> 
> 标签：python, django, google-app-engine

嗨，我正在使用 App Engine/Python 做一个简单的网站。我遇到了 Django 模板问题。

简而言之，我想使用“ShortName”来访问“LongName”。

源代码：

```
LongName={"so":"stackoverflow","su":"superuser"}
ShortName=['so','su'] 
```

然后我将这两个参数传递给模板。

在我写的模板中：

```
{% for aname in ShortName %}
{{ aname }} stands for {{ LongName.aname }},
{% endfor %} 
```

输出是：

```
so stands for, su stands for 
```

没有给出错误。`LongName.aname`不会工作。

我不知道出了什么问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T18:02:22.250

这是试图访问`LongName['aname']`，不是`LongName[aname]`。

您可能必须编写自定义模板标签/过滤器才能使其正常工作。[这个 Django 错误](https://code.djangoproject.com/ticket/3371)（标记为 WONTFIX）有一个简单的实现：

```
def get(d, key):
    return d.get(key, '')

register.filter(get) 
```

你会用它

```
{{ LongName|get:aname }} 
```

[将其添加到您的应用程序](https://stackoverflow.com/a/50425/344821)后（该 SO 答案显示了如何在 GAE 上执行此操作）。

* * *

您还可以通过传入预先制作一个变量以在视图中循环

```
 # in view
 name_abbrevs = [(k, LongName[k]) for k in ShortName]

 # in template
 {% for short_name, long_name in name_abbrevs %}
     {{ short_name }} stands for {{ long_name }}
 {% endif %} 
```

* * *

如果您真的不想添加模板标签 - 这还不错！您只需制作一个文件！:) -- 或者传入一个额外的变量，[Vic 的方法](https://stackoverflow.com/a/10366230/344821)可以让你在完全不接触 Python 文件的情况下做到这一点。正如他所提到的，它涉及大量无意义的迭代，但它适用于小列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:11:41.047

Django 模板在这里有一个缺点。我以前也遇到过同样的情况。您需要做的是遍历 LongName 中的所有键，并检查您要查找的键是否与 ShortName 匹配。干得好：

```
{% for aname in ShortName %}
  {% for short_version, long_version in LongName %}
    {% if aname == short_version %}
      {{ aname }} stands for {{ long_version }},
    {% endif %}
  {% endfor %}
{% endfor%} 
```

它效率低下，本质上是一种毫无意义的 O(n^2) 机制。然而，在纯 Django 模板中没有更好的方法来通过变量名引用字典的条目。

# objective-c - 如何获取两个linux时间戳之间的差异

> ID：10366116
> 
> 赞同：-2
> 
> 时间：2012-04-28T18:00:01.980
> 
> 标签：objective-c, linux, time

我有两个 linux 时间戳 begine-time 和 expire-time，我想以小时、分钟秒为单位计算这两个时间戳之间的差异。

> 语言：目标 C
> 
> “过期时间”：“1366927200”，“开始时间”：“1327532400”，

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-04-28T18:07:23.673

```
int beginTime = 1327532400;
int expireTime = 1366927200;
int diff = expireTime - beginTime;

#define SEC_PER_MIN 60
#define SEC_PER_HOUR (SEC_PER_MIN * 60)
#define SEC_PER_DAY (SEC_PER_HOUR * 24)

int days = diff / SEC_PER_DAY;
diff -= days * SEC_PER_DAY;
int hours = diff / SEC_PER_HOUR;
diff -= hours * SEC_PER_HOUR;
int minutes = diff / SEC_PER_MIN;
diff -= minutes * SEC_PER_MIN;
int seconds = diff;

NSLog(@"%d d, %d h, %d m and %d s.", days, hours, minutes, seconds); 
```

# parsing - 从解析文件python构建CSV

> ID：10366119
> 
> 赞同：0
> 
> 时间：2012-04-28T18:00:19.693
> 
> 标签：parsing, csv, text-files

我正在从 1000 多个文件中构建一个小型数据库（供个人使用）。我正在寻找特定的单词，但是如果文件中不包含该单词，我将如何编写 NoData 行，我想要的是：

*   非洲博茨瓦纳测试 51.1922546 -113.9366341
*   非洲 肯尼亚 Skydive 肯尼亚 -13.788388 33.78498
*   非洲 马拉维 Skydive 马拉维 NoData NoData
*   非洲毛里求斯 SkyDive Austral 30.5000854 -8.824510574
*   非洲 摩洛哥 Beni Mellal NoData NoData

> ```
> for i in os.listdir(Main_Path):
>     if "-" in i:
>         for filename in os.listdir(Main_Path+i):
>             if ".dat" in filename and os.path.isdir(Main_Path+i):
>                 f_split = filename.split("-")
>                 if len(f_split) == 4:
>                     continent.append(f_split[0])
>                     country.append(f_split[1])
>                     state.append(f_split[2].split(".")[0])
>                 else:
>                     continent.append(f_split[0])
>                     country.append("")
>                     state.append(f_split[1].split(".")[0])
>                 d = open(Main_Path+i+"/" + filename, "r")
>                 files = d.readlines()
>                 d.close()
>                 for k, line in enumerate(files):
>                     if "Dropzone.com :" in line:                        
>                         dzname.append(line.split(":")[1].strip())
>                    elif 'id="lat"' in line:
>                         lat.append(line.split("=")[3].split('"')[1].strip())
> myFile = open(Main_Path+"MYFILE.csv", "wb")
> wtr= csv.writer( myFile )
> for a,b,c,d,e in zip(continent,country,state,dzname,lat):
>     wtr.writerow([a,b,c,d,e])
> myFile.close() 
> ```

我是堆栈“elif 'id="lat"' in line:”，因为它只将包含 id = lat 的文件添加到列表“lat”中。我明白为什么，但我希望解析器返回并将 NoData 添加到列表中

抱歉，我从另一个 comp 写了这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T09:27:10.080

你的意思是这样的吗？

也就是说：如果文件中没有一行包含 id="lat"，它将在 lat 后面附加“No Data”。

```
 snip...

            d = open(Main_Path+i+"/" + filename, "r")
            files = d.readlines()
            d.close()
            found_latitude = False
            for k, line in enumerate(files):
                if "Dropzone.com :" in line:                        
                    dzname.append(line.split(":")[1].strip())
               elif 'id="lat"' in line:
                    found_latitude = True
                    lat.append(line.split("=")[3].split('"')[1].strip())
            if not found_latitude:
                lat.append("No Data")

            snip... 
```

# android - 使用 BaseAdapter 从 Listview 获取数据

> ID：10366126
> 
> 赞同：1
> 
> 时间：2012-04-28T18:01:02.853
> 
> 标签：android, android-listview, adapter

我有一个 Activity(A) ，`Button`当用户按下它时，它会添加一个`Object`到`static List`. 我有另一个`ListView`显示静态列表内容的活动（B）。在活动（B）中，我想使用存储在特定行的静态列表中的对象的属性。我怎样才能做到这一点？我的代码如下所示：

```
//Activity (A):
Send.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
...
//  Add to mycaseList
All_Static.MyCaseList.add(case1);
...
}});

//==============================================================================

//Activity (B):

public class MyPage extends Activity {

     boolean returnvar ;
    private Activity mContext;
    Button createForm;
    Button ConfExpandRegion, Cancelb;
    String ExpandMsg, CancelMsg;
    boolean b;
    MyCaseClass mycase;
    TextView tvCase;
    AlertDialog alertDialog;

    //for list
    ListView list;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.mypage);

        // Moving to another activity
        createForm = (Button) findViewById(R.id.creat_new_formbtn);
        createForm.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {

                Intent j = new Intent(MyPage.this, CreateNewForm.class);
                startActivity(j);

            }
        });

        // ============================================================================================
        // for list

            list = (ListView) findViewById(R.id.mypage_list);
            list.setClickable(true);

            final List<MyCaseClass> listOfMyCases = new ArrayList<MyCaseClass>();

            MyCasesListAdapter adapter = new MyCasesListAdapter(this, listOfMyCases, MyPage.this);

            for (MyCaseClass m : All_Static.getMyCaseList())
                adapter.add(new MyCaseClass(m));

            // after fill the adapter.. assign the list to the adapter
            list.setAdapter(adapter);

            list.setOnItemClickListener(new OnItemClickListener() {

                public void onItemClick(AdapterView<?> arg0, View view, int position, long index) {

                }
            });

        // ========================================================================================

    }

    public void sendSMS(String number, String msg) throws Exception {
        if (!b) {
            SmsManager smsManager = SmsManager.getDefault();
            smsManager.sendTextMessage(number, null, msg, null, null);
        }
        b = true;
    }

    // ========================================================================

    public void ShowingDialogExpand(){
        final AlertDialog alertDialog = new AlertDialog.Builder(this).create();
        alertDialog.setTitle("Conformation");
        alertDialog.setMessage("Are you sure you want to Expand Report Region?");
        alertDialog.setButton("Yes", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int which) {

                   ExpandMsg = "Case_ID expand";
                   if (!b) {
                        try {
                            // Should write server number here + the chatting must be pushed above 
                            sendSMS("0000", ExpandMsg);
                            Toast.makeText(MyPage.this, "Request Sent", Toast.LENGTH_LONG)
                                    .show();
                        } catch (Exception e) {
                            // TODO Auto-generated catch block
                            Toast.makeText(MyPage.this, e.getMessage(),
                                    Toast.LENGTH_LONG).show();
                        }

                    }
                   //ConfExpandRegion.setEnabled(false);
               }

            });

            alertDialog.setButton2("No", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int which) {
                // here you can add functions
                // Do nothing 

               }
            });

            alertDialog.setIcon(android.R.drawable.ic_dialog_alert);
            alertDialog.show();
    }

    public void  ShowingDialogCancel(int i){
        final AlertDialog alertDialog2 = new AlertDialog.Builder(this).create();
        alertDialog2.setTitle("Conformation?");
        alertDialog2.setMessage("Are you sure you want to cancel x cases?");

        String str = "ID:" + i;
        Toast.makeText(MyPage.this, str , 0)
        .show();
        alertDialog2.setButton("Yes", new DialogInterface.OnClickListener() {
               public  void onClick(DialogInterface dialog, int which) {

                     CancelMsg = "Case_ID cancel";
                     returnvar=true;

                   if (!b) {
                        try {
                            // Should write server number here + the chatting must be pushed above 
                            sendSMS("0000", CancelMsg);
                            Toast.makeText(MyPage.this, "Cancelation request sent", Toast.LENGTH_LONG)
                                    .show();

                        } catch (Exception e) {
                            // TODO Auto-generated catch block
                            Toast.makeText(MyPage.this, e.getMessage(),
                                    Toast.LENGTH_LONG).show();
                        }

                    }
                   }
            });

            alertDialog2.setButton2("No", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int which) {
                // here you can add functions
                // Do nothing 
                   returnvar = false;
                   Toast.makeText(MyPage.this, "inside No", 0)
                    .show();

               }
            });

            alertDialog2.setIcon(android.R.drawable.ic_dialog_alert);
            alertDialog2.show();

    }

}

//=================================================================================

// My BaseAdapter 
public class MyCasesListAdapter extends BaseAdapter {
    private MyPage myPage;
    private List<MyCaseClass> listOfCases;
    private Activity parentActivity;

    // TODO test
    MyCaseClass entry;

    // TODO delete it not imp.
    public MyCasesListAdapter() {

        super();

    }

    public MyCasesListAdapter(MyPage mypage, List<MyCaseClass> listOfCaseParameter, Activity parentActivity) {
        this.myPage = mypage;
        this.listOfCases = listOfCaseParameter;
        this.parentActivity = parentActivity;
    }

    public int getCount() {
        return listOfCases.size();
    }

    public Object getItem(int position) {
        return listOfCases.get(position);
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup viewGroup) {

         entry = listOfCases.get(position);
         //this.getitem(position)
        if (convertView == null) {

            LayoutInflater inflater = (LayoutInflater) myPage
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = inflater.inflate(R.layout.mypage_row, null);
          }

        // this is row items..
        // Set the onClick Listener on this button
        Button ConfExpandRegion = (Button) convertView.findViewById(R.id.expand);
        Button Cancelb = (Button) convertView.findViewById(R.id.cancelCase);
        TextView tvCase = (TextView) convertView.findViewById(R.id.mypage_name);

        // To be a clickable button
        ConfExpandRegion.setFocusableInTouchMode(false);
        ConfExpandRegion.setFocusable(false);

        ConfExpandRegion.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                myPage.ShowingDialogExpand();
            }
        });

        // To be a clickable button
        Cancelb.setFocusableInTouchMode(false);
        Cancelb.setFocusable(false);
        Cancelb.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                entry = (MyCaseClass) v.getTag();
                int caseid= entry.getID();
                myPage.ShowingDialogCancel(caseid);

                Toast.makeText(myPage, "inside calling", 0).show();

                //MyCaseClass entry = (MyCaseClass) v.getTag();
                //listOfCases.remove(entry);

                // listPhonebook.remove(view.getId());
                notifyDataSetChanged();
            }
        });

        // Set the entry, so that you can capture which item was clicked and
        // then remove it
        // As an alternative, you can use the id/position of the item to capture
        // the item
        // that was clicked.
        ConfExpandRegion.setTag(entry);
        Cancelb.setTag(entry);

        // btnRemove.setId(position);

        return convertView;
    }

    public void onClick(View view) {
        MyCaseClass entry = (MyCaseClass) view.getTag();
        listOfCases.remove(entry);
        // listPhonebook.remove(view.getId());
        notifyDataSetChanged();

    }

    private void showDialog(MyCaseClass entry) {
        // Create and show your dialog
        // Depending on the Dialogs button clicks delete it or do nothing
    }

    public void add(MyCaseClass myCaseClass) {
        // TODO Auto-generated method stub
        listOfCases.add(myCaseClass);
    }

}
//===========================================================================
// StaticClass
public class All_Static {

    public static List<MyCaseClass> MyCaseList = new ArrayList<MyCaseClass>();

    public static List<MyCaseClass> getMyCaseList() {
        return MyCaseList;
    }

    public static void setMyCaseList(List<MyCaseClass> myCaseList) {
        MyCaseList = myCaseList;
    }

    //===========================================================================
    public static List<HelpersClass> HelperList = new ArrayList<HelpersClass>();

    public static List<HelpersClass> getHelperList() {
        return HelperList;
    }

    public static void setHelperList(List<HelpersClass> helperList) {
        HelperList = helperList;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T17:30:28.773

序列化您的对象并将其传递给活动 B，同时通过意图调用它

# ruby-on-rails - Ruby on Rails 3.2.3 在 rake db:migrate (MySQL db) 之后没有创建外键

> ID：10366128
> 
> 赞同：1
> 
> 时间：2012-04-28T18:01:03.993
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rails-migrations

```
class User < ActiveRecord::Base

has_many :comments

end

class Comment < ActiveRecord::Base

belongs_to :user

end 
```

然后我跑了：rake db:migrate。我的评论表中没有“user_id”字段/列。我也尝试过：rake db:drop、rake db:create 和 rake db:migrate。我可能错过了一步，有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:03:57.903

您必须定义迁移。

当您创建评论模型时

```
rails generate model comment 
```

rails 还在 your_appication_root/db/migrate/ 中生成迁移文件。

```
class CreateComments < ActiveRecord::Migration
  def change
    create_table :comments do |t|
       t.references :user
       t.text, :content
       t.timestamps
    end
  end
end 
```

对你来说重要的一行是

```
t.references :user 
```

或者你可以直接定义它

```
t.integer :user_id
#but this do not add the db index 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:04:07.920

您必须将它们添加到迁移中。

您可以在新迁移中定义是否像这样

```
add_column :comments, :user_id, :int 
```

或更改您的迁移并使用帮助程序

```
create_table :comments do |t|
  ...
  t.references :user
end 
```

# neo4j - RDF 和三重存储对 Neo4j 有什么好处？

> ID：10366131
> 
> 赞同：12
> 
> 时间：2012-04-28T18:01:20.253
> 
> 标签：neo4j, rdf

Neo4j 是一个非常快速且可扩展的图形数据库，它似乎可以用于商业项目，而且它也是免费的！

同时，没有 RDF 三元存储能够很好地处理大数据或提供高速访问。而且，免费的 RDF 三元存储的表现更差。

那么RDF和RDF三元存储对Neo4j有什么好处呢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-29T03:07:23.777

将三重存储用于 RDF 而不是 Neo4j 的优势在于，它们就是为此*而设计*的。Neo4j 对于许多用例来说都相当不错，但根据我的经验，它在加载和查询 RDF 方面的性能远低于所有专用 RDF 数据库。

RDF 数据库不能扩展或速度不快是一个谬论。当然，它们还没有达到关系数据库所具有的性能和规模水平，但它们有 50 年的领先优势。许多三联存储扩展到数十亿三联，提供“标准”企业功能，并为许多用例提供出色的性能。

如果您打算将 RDF 用于项目，请使用三重存储；它将为使用 RDF 构建应用程序提供最佳性能和一组特性/API。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-29T07:54:14.250

RDF 和 SPARQL 是标准，因此您可以选择多种实现，并且可以将您的数据从一个 RDF 存储迁移到另一个。

此外，SPARQL 查询语言 1.1 版非常复杂（比大多数 SQL 实现更具表现力）并且可以执行需要在 Neo4J 中编写大量代码的各种查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-20T03:58:33.337

如果您要在三元组上进行图挖掘（例如图遍历），neo4j 是一个不错的选择。对于大型三元组，您可能需要使用相当快的 batchInserter。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-28T18:16:54.027

我听说将 10M 三元组加载到 Neo4j 需要一整天的时间（它实际上是最慢的，因为它不是主要为 RDF 构建的）。

Sesame 和 4Store 是最快的，但 Jena 有强大的 API。

# php - 从字符串中提取 9 位数字

> ID：10366134
> 
> 赞同：0
> 
> 时间：2012-04-28T18:01:38.423
> 
> 标签：php, regex

我基本上在 php 中有一个包含字符串的数组，我基本上需要过滤字符串以获得 9 位 ID 号（用括号括起来），我确定可以使用正则表达式来做到这一点，但我无能为力。

我知道正则表达式将其结果作为数组返回，因为可能有多个结果，但我知道每个字符串不会有多个结果，因此如果可能，我需要将结果直接放入我已经存在的数组中

**例子：**

```
function getTasks(){
   //filter string before inserting into array
   $str['task'] = "meeting mike (298124190)";

   return $str;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:07:22.500

通过使用`preg_replace`你只有一个线路过滤器....

```
 $str['task'] = preg_replace('/.*\((\d{9})\).*/', '$1', "meeting mike (298124190)"); 
```

使用`preg_match`

```
$strings = array("meeting mike (298124190)", "meeting mike (298124190)", "meeting mike (298124190)");
foreach ($strings as $string) {
    if (preg_match("|\(([\d]{9})\)|", $string, $matches)) {
        $str[] = $matches[1];
        // OR $str['task'][] = $matches[1];
    }
}
print_r($str); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T18:11:21.270

```
<?php
    $str = "meeting mike (298124190)";
    preg_match("/([0-9]{9})/s", $str, $result);

    print_r($result); // $result is an array with the extracted numbers
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T18:11:47.960

好吧，假设它是唯一的一个（用括号括起来的 9 位数字），以下将执行：

```
preg_match("|\(([0-9]{9})\)|", $str['task'], $matches);
return $matches[1]; //Will contain your ID. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T18:18:58.300

它类似于：

```
$str = "meeting mike (298124190)";
$pattern = '/[0-9]{9}/';
if (preg_match($pattern, $str, $matches))
{

    echo $matches[0];
} 
```

# regex - Django url正则表达式不起作用

> ID：10366137
> 
> 赞同：1
> 
> 时间：2012-04-28T18:01:50.217
> 
> 标签：regex, django

我正试图了解 Django url 中的正则表达式。我目前正在本地开发，我希望能够将请求定向`http://localhost:8000/options/items/item-string-1121/`到我的应用程序中名为“选项”的“详细信息”视图，将请求字符串的最后数字部分（1121）作为参数“id”传递' 到视图函数。

详细签名`options/views.py`如下，默认id=1：

```
def details(request, id=1):
    ... 
```

我的根 urls.py 中有以下内容：

```
...

urlpatterns += patterns('',
    url(r'^options/, include(options.urls')),
) 
```

在选项/urls.py 中：

```
urlpatterns = patterns('options.views', 
    url(r'^items/(.+)(P<id>\d+)/$', 'details'),
    ...
) 
```

现在，当我尝试请求上述 URL 时，开发服务器说它试图匹配该模式`^options/ ^items/(.+)(P<id>\d+)/$`，但它不匹配。

任何人都可以看到问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:07:34.093

您需要在 (.+) 上使用非贪婪量词，因此 r'^items/(.+?)(P\d+)/$'。否则，第一个 glob 会愉快地吃到字符串的末尾，从而阻止 ID 永远匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:29:34.077

您缺少引号。

```
urlpatterns += patterns('',
    url(r'^options/, include(options.urls')),
) 
```

应该

```
urlpatterns += patterns('',
    url(r'^options/', include('options.urls')),
) 
```

我不太确定你的表情，可以试试这个：

```
urlpatterns = patterns('options.views', 
    url(r'^items/(?<=-)(?P<id>\d+)/$', 'details'),
    ...
) 
```

# ffmpeg - 如何指定无序列表？

> ID：10366138
> 
> 赞同：5
> 
> 时间：2012-04-28T18:01:52.637
> 
> 标签：ffmpeg

我试图弄清楚如何指定要转换为视频的特定图像列表。我知道我们可以做类似的事情：

```
ffmpeg -i image_04%d.png 
```

这将从文件夹中选择与序列匹配的所有图像。但是，在我的情况下，图像文件不一定按其名称所暗示的顺序排列。原因是订单保存在数据库中，文件名本质上是数据库行 ID。

如何指定正确的输入序列？我本质上是从代码而不是从命令行调用 ffmpeg。因此，也欢迎对代码进行任何更改。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T21:03:03.103

这是凯文想法的一个脚本，对我有用。您可能想要替换文件名模式 (shot*.png) 和输出文件名 movie.mp4。完成后，脚本会删除所有 frame_ ... 文件。

```
# script to create movie from multiple png files
# taken in choronoligcal order

# start at 0
count=0
# take all files named shot - something ordered by date
for f in `ls -rt shot*.png`
do 
  # get the index in 0000 format
  printf -v counts "%04d" $count
    # link file to a frame_0000  named symbolic link
    ln -s $f frame_$counts.png
    # increment counter
  count=`expr $count + 1`
done
# create movie
# slowed down by factor 5
# ffmpeg -f image2 -i frame_%04d.png -vcodec mpeg4 -vf "setpts=5*PTS" movie.mp4
ffmpeg -i frame_%04d.png movie.mp4
# remove the links
rm frame_*.png 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-29T18:40:01.787

假设我们有一个按正确顺序排列的文件名列表，如下所示：

```
frames=(
    "5K1OCNKToUu.png"  "kJuKFQS0Fgnp.png" "00v4U4JTyUn.png"  "3sg9sDwPZoX.png"
    "1KsuEk9mboa9.png" "qNrI8zlRBmW.png"  "MOvSca3wlPsP.png" "5rXcxfGQXunY.png"
    "hjruIcoN0aTn.jpg" "OhRttnWtKy.png"   "e2Qj8jCixc.png"   "Uze2H7vzrt4.png"
    "n14qhmjiBW3.png"  "ZDMvY4g1hzgS.png" "ibnb7MxELyGp.png" "9c8QGWmBEDNg.png"
    "STQT0t7oqPEK.png" "jI7UvpbLDWPc.png" "6clazeaUAJHv.png" "ylJ40r9uMK9d.png"
    "RICq5KV00P6.png"  "zjCLrappFMPq.png" "TJQTDv313KBo.png" "Gu3pLpWylsuo.png"
    "Ksym4SB6VYNv.png" "rIyj0LJIjBVX.png" "pSUm2J8xYU.png"   "Rnsr0H0m7p9A.png"
    "x4vVomlOolxt.png" "2W1QURLQUyE8.png" "m3JgtDzQ0VgE.png" "CrjN9TVJKMAU.png"
    "IO6pnF83ivqo.png" "hY15nsYDvr4h.png" "1GagDdBM9L7.png"
) 
```

并且我们想要创建一个具有特定帧速率的动画 GIF，例如`FPS=30`。这可以像在其他答案中一样通过创建符号链接来完成，例如命名`001.png`为`035.png`然后使用：

```
ffmpeg -i 03%d.png 
```

另一种方法是利用`ffmpeg`'s [concat-feature](https://trac.ffmpeg.org/wiki/Concatenate)。不幸的是，这说起来容易做起来难，因为该功能需要视频流，这意味着图像需要根据需要循环播放。

连接三个图像的命令之间有 500 毫秒是这样的：

```
ffmpeg -f concat -safe 0 -i <(cat <<EOF
file '$(pwd)/1KsuEk9mboa9.png'
duration 0.5
file '$(pwd)/hjruIcoN0aTn.png'
duration 0.5
file '$(pwd)/n14qhmjiBW3.png'
duration 0.5
EOF
) -framerate 2 out.gif 
```

经测试`ffmpeg version 3.0.1-3`。

**解释：**

*   [concat demuxer](https://www.ffmpeg.org/ffmpeg-formats.html#concat-1)需要一个文件，其中包含一个由关键字前缀的相对文件名列表`file`。为了不弄乱当前工作目录（或者我们可能没有写权限），我们使用 process substition `<( ... )`。但这会在其中创建一个文件`/dev/fd/`，如果使用了相对文件名，则会导致如下错误消息：

    ```
    [concat @ 0xc181c0] Impossible to open '/dev/fd/5K1OCNKToUu.png' 
    ```

    这就是给出绝对路径的原因。但是默认情况下不允许使用绝对路径，导致：

    ```
    [concat @ 0x17da1c0] Unsafe file name '/home/5K1OCNKToUu.png' 
    ```

    为了[解决](https://ffmpeg.org/pipermail/ffmpeg-user/2016-March/031489.html)使用`-safe 0`。

*   尝试指定输入帧速率时[`-r`](https://ffmpeg.org/ffmpeg.html#toc-Video-Options)

    ```
    ffmpeg -f concat -safe 0 -r 2 -i <(cat <<EOF
    file '$(pwd)/1KsuEk9mboa9.png'
    file '$(pwd)/hjruIcoN0aTn.png'
    file '$(pwd)/n14qhmjiBW3.png'
    EOF
    ) -framerate 2 out.gif 
    ```

    出现这样的错误：

    ```
    [concat @ 0x1458220] DTS -230575710986777 < 0 out of order
    DTS -230575710986777, next:40000 st:0 invalid dropping
    PTS -230575710986777, next:40000 invalid dropping st:0 
    ```

    无论如何，生成的 GIF 都像预期的那样工作。使用`duration`选项`concat`明确地解决这些警告/错误。

    注意评论`-r`

    > 作为输入选项，忽略文件中存储的任何时间戳，而是在假设帧速率 fps 不变的情况下生成时间戳。这与用于某些输入格式（如 image2 或 v4l2）的 -framerate 选项不同（它曾经在旧版本的 FFmpeg 中相同）。如果有疑问，请使用 -framerate 而不是输入选项 -r。

    我对此的看法是，来自 concat 的上述警告，它通知您它找不到图像的播放长度，不会导致不良行为，因为在 concat 警告之后强制帧速率`-r`，这有效，但可能不是预期的方式。我只会在手动编写 ffmpeg 命令时使用它，而不是在脚本中。

组合[一个](https://stackoverflow.com/questions/8402181/how-do-i-get-bc1-to-print-the-leading-zero)小脚本来处理开头指定的文件名列表：

```
function makeGif() {
    local targetName=$1; shift
    local FPS=$1; shift
    # concat doesn't recognize .33 as returned by bc by default
    local delay=$(bc <<< "scale=5; x=1/$FPS; if (x<1) print 0; x")
    local list
    for file in $@; do
        list+=$(printf "\nfile '$(pwd)/$file'\nduration $delay")
    done
    ffmpeg -f concat -safe 0 -i <(cat <<< "$list") -r $FPS "$targetName".gif
    #ffmpeg -f concat -safe 0 -i <(cat <<< "$list") -r $FPS -c:v libx264 -crf 5 -pix_fmt yuv420p "$targetName".mkv
}
makeGif out 30 ${frames[@]} 
```

上面代码中未注释的行将给出一个 H264 编码的 mkv。

**异构图像类型**

如果您的图像列表包含不同类型的图像，例如通过替换`hjruIcoN0aTn.png`为`hjruIcoN0aTn.jpg`in `frames`，那么这种用法 of`concat`将不起作用。第一个指定格式以外的其他格式的图像将被丢弃并引发错误，例如：

```
[png @ 0x1ec8260] Invalid PNG signature 0xFFD8FFE000104A46.
Error while decoding stream #0:0: Invalid data found when processing input 
```

在这种情况下，您将不得不使用[concat 过滤器](https://ffmpeg.org/ffmpeg-filters.html#concat)而不是简单的解复用器。然后必须将上面包含三个文件的命令更改为：

```
ffmpeg \
-f image2 -loop 1 -thread_queue_size 4096 -framerate 30 -t 0.5 -i "$(pwd)/1KsuEk9mboa9.png"  \
-f image2 -loop 1 -thread_queue_size 4096 -framerate 30 -t 0.5 -i "$(pwd)/hjruIcoN0aTn.jpg"  \
-f image2 -loop 1 -thread_queue_size 4096 -framerate 30 -t 0.5 -i "$(pwd)/n14qhmjiBW3.png"   \
-filter_complex 'concat=n=3:v=1 [vmerged]' \
-map '[vmerged]' -r 30 out.gif 
```

**解释：**

*   [使用的每个选项在这里](https://trac.ffmpeg.org/wiki/Concatenate#differentcodec)都得到了很好的解释。请注意，该`-framerate`选项特定于[图像导入](https://www.ffmpeg.org/ffmpeg-formats.html#toc-image2-1)器，并且至少在技术上与 不同`-r`，实际上在这种情况下它们会产生相同的结果。

*   这`-thread_queue_size`似乎是必要的，因为我们将一张图像延长了相当长的 500 毫秒，导致以下错误消息：

    ```
    [image2 @ 0x18856e0] Thread message queue blocking; consider raising the thread_queue_size option (current value: 8)
    [image2 @ 0x188a100] Thread message queue blocking; consider raising the thread_queue_size option (current value: 8)
    [image2 @ 0x188b9e0] Thread message queue blocking; consider raising the thread_queue_size option (current value: 8) 
    ```

    该选项的描述让我有理由认为过大的延迟是错误的：

    > -thread_queue_size size (input) 此选项设置从文件或设备读取时排队数据包的最大数量。低延迟/高速率的直播流，如果没有及时读取数据包，可能会被丢弃；提高这个值可以避免它。

再次将所有这些放入脚本中：

```
function makeGif() {
    local targetName=$1; shift
    local FPS=$1; shift
    local delay=$(bc <<< "scale=5; x=1/$FPS; if (x<1) print 0; x")
    local list=()
    local nFiles=0
    for file in $@; do
        list+=( -f image2 -loop 1 -thread_queue_size 4096 -framerate $FPS -t $delay -i "$(pwd)/$file" )
        nFiles=$((nFiles+1))
    done
    ffmpeg ${list[@]} -filter_complex "concat=n=$nFiles:v=1 [vmerged]" -map '[vmerged]' -r $FPS "$targetName".gif
    #ffmpeg ${list[@]} -filter_complex "concat=n=$nFiles:v=1 [vmerged]" -map '[vmerged]' -r $FPS -c:v libx264 -crf 5 -pix_fmt yuv420p "$targetName".mkv
}
makeGif out 30 ${frames[@]} 
```

由于一些非常奇怪的原因，上面的命令不能按原样工作**！！！**. 在我的情况下，它丢弃了指定的 35 帧中的 33 帧，而没有警告或错误消息：

```
frame=    2 fps=0.0 q=-0.0 Lsize=       2kB time=00:00:00.07 bitrate= 179.7kbits/s dup=0 drop=33 speed=0.155x 
```

这很奇怪的原因是，它的工作原理与预期的延迟一样完美，即每个图像显示 2 帧，即更改`1/$FPS`为`2/$FPS`：

```
frame=   70 fps=0.0 q=-0.0 Lsize=     701kB time=00:00:02.33 bitrate=2465.4kbits/s speed= 2.9x 
```

这一事实表明了一个简单的解决方法：以两倍的帧速率进行编码，并将每个图像显示 2 帧。但这很浪费，而且无论如何都不利。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T03:13:07.260

您的应用程序可以创建从 0001 开始的符号链接，该链接尊重原始帧的顺序，然后将该序列传递给 ffmpeg。视频完成后，删除符号链接即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T16:31:06.180

好吧，解决方案是修补 image2 类以支持包含可供选择的数字的列表。比我提供给 ffmpeg 的输入文件模式以及具有指定顺序的数字数组来读取输入。这非常有效。

# php - 如何通过 .htaccess 在 404 错误重定向中传递查询字符串？

> ID：10366139
> 
> 赞同：2
> 
> 时间：2012-04-28T18:02:05.070
> 
> 标签：php, .htaccess

我有一个`index.php`文件可以处理对服务器的所有请求。我`.htaccess`以这种方式设置了 404 错误重定向：

```
ErrorDocument 404 /index.php 
```

如果用户请求一个文件，例如`page.php`，那么它会被正确地重定向到`index.php`页面。

当用户请求$_REQUEST['page']`时`page.php?page=about, then my index.php is unable to retrieve the query`，就会出现问题。`using`

如何`about`使用 index.php获取查询`$_REQUEST['page']`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T18:14:56.947

`$_SERVER['REDIRECT_QUERY_STRING']`可能包含您的查询字符串。

试一试。

```
<?php
    print_r($_SERVER['REDIRECT_QUERY_STRING']);
?> 
```

# javascript - 获取 MouseLeave 事件后鼠标悬停的第一个元素

> ID：10366149
> 
> 赞同：4
> 
> 时间：2012-04-28T18:02:28.523
> 
> 标签：javascript, jquery, dom, dom-events

使用 jQuery/Javascript，我如何检查`MouseLeave`事件发生后鼠标悬停的第一个元素是什么？

基本上，我想从元素数组中检查鼠标是否在这些元素上滚动。

我正在尝试使用`event.relatedTarget`.

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:27:37.447

[`relatedTarget`](https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/relatedTarget)鼠标事件存在一个属性

> `MouseEvent.relatedTarget`只读属性是鼠标事件的次要目标，如果有的话

`mouseleave`它指向输入的元素。

所以你可以做

```
$('element').mouseleave(function(event){
    // assuming that allowedList holds the array of allowed elements
    if ( allowedList.indexOf( event.relatedTarget ) > -1 ){
        // found
    } else {
        // not found
    }
}); 
```

演示在[http://jsfiddle.net/gaby/V4pJb/](http://jsfiddle.net/gaby/V4pJb/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:10:06.913

使用 jQuery，您可以这样做：

```
​$("#foo").mouse​​​leave(function(e) {
    var element = $(e.target);
})​;​ 
```

这是一个工作示例。您可以将鼠标悬停在文本“Hello”上，鼠标移出时，它会告诉您它要离开哪个元素。 [http://jsfiddle.net/k7Gfv/](http://jsfiddle.net/k7Gfv/)

如果 mouseenter（或 hover）与 mouseleave 不同，那么您需要使用变量来跟踪它。在 mouseenter（或悬停）上，设置一个将存储该元素的变量。在 mouseleave 上，您可以引用该变量（只需记住在下次触发 mouseenter 时清除或重置该值）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T18:21:08.357

不知道你在找什么，但也许是这样的：

```
var elements = $("#a1, #a2");

$("#a3").on('mouseleave', nextElm);

function nextElm() {
    $('div').on('mouseenter', thisIsIt);
    $("#r").html('Now hover another element ?');   
}

function thisIsIt(e) {
    if ($.inArray(e.target, elements)!=-1){
        $("#r").html('yes');
    }else{
        $("#r").html('no');            
    }
    $("#a3").off('mouseleave', nextElm);
    $('div').off('mouseenter', thisIsIt);
} 
```

​</p>

[小提琴](http://jsfiddle.net/adeneo/zB7UF/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T18:21:57.187

你可以做这样的事情。[这是一个小提琴](http://jsfiddle.net/6j8SR/2/)

```
var hovered = false;;
$('div').mouseleave(function(e) {
    hovered = true;
});
$('div').hover(function(ev) {
        if (hovered) {
            alert(ev.target);
            hovered = false;
        }
});
​ 
```

# java - 如何让android服务保持phonegap ui活着

> ID：10366150
> 
> 赞同：2
> 
> 时间：2012-04-28T18:02:39.597
> 
> 标签：java, android, service, cordova

我正在开发一个使用 phonegap/cordova 的 android 应用程序。此应用程序使用 javascript 不时从服务器获取内容，并在有新内容时发出系统托盘警报。我面临的问题是，当 android 内存不足或其他任何情况时，该应用程序最终会退出。

所以我在清单中添加了一项服务（每个人都说服务可以解决问题）。

```
<service android:name="UpdateService" /> 
```

很好，但只是有这项服务没有任何作用（显然）。那么如何让我的服务触发主应用程序继续运行呢？

补充：我还设法在我的主应用程序中启动了该服务

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:18:20.123

尝试向 AlarmManager 注册一个 PendingIntent，它将检查以确保您的应用程序每 n 毫秒运行一次。如果它没有运行，让服务再次启动您的应用程序。

使用类似这样的代码来启动您的应用程序：

```
Intent serviceIntent = new Intent("com.myapp.LaunchActivity");
startService(serviceIntent); 
```

将**com.myapp.LaunchActivity**替换为您的包名称和 LaunchActivity。

# c# - 使用 SendKeys 发送 Windows 密钥

> ID：10366152
> 
> 赞同：37
> 
> 时间：2012-04-28T18:03:09.613
> 
> 标签：c#, keyboard-shortcuts, sendkeys

我正在研究 C# 中的快捷方式。我使用 SendKeys 成功实现了 Ctrl、Alt 和 Shift。

像这样;

`Ctrl`+ `C`:

```
System.Windows.Forms.SendKeys.SendWait("^c"); 
```

或`Alt`+ `F4`：

```
System.Windows.Forms.SendKeys.SendWait("%{F4}"); 
```

但我无法使用 SendKeys 发送“Windows 密钥”。我试过 ex: `Win`+ `E`:`.SendWait("#e")`但它不起作用。我应该使用什么来代替“#”？

谢谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-28T21:47:37.633

好的结果你真正想要的是：http: [//inputsimulator.codeplex.com/](http://inputsimulator.codeplex.com/)

`Win32 SendInput`它完成了将方法暴露给 C#的所有艰苦工作。这允许您直接发送 windows 密钥。这是经过测试和工作的：

`InputSimulator.SimulateModifiedKeyStroke(VirtualKeyCode.LWIN, VirtualKeyCode.VK_E);`

**但是请注意**，在某些情况下，您希望专门将密钥发送到应用程序（例如`ALT+F4`），在这种情况下使用`Form`库方法。在其他情况下，您通常希望将其发送到操作系统，请使用上述内容。

* * *

**老的**

将其保留在这里以供参考，它不适用于所有操作系统，并且不会总是按照您的意愿行事。请注意，您正在尝试将这些击键发送到应用程序，而操作系统通常会提前拦截它们。对于 Windows 7 和 Vista，太早了（在`E`发送之前）。

`SendWait("^({ESC}E)")`或者`Send("^({ESC}E)")`

请注意：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)

> 要指定在按下其他几个键的同时按住 SHIFT、CTRL 和 ALT 的任意组合，请将这些键的代码括在括号中。例如，要指定在按下 E 和 C 时按住 SHIFT，请使用“+(EC)”。要指定在按 E 时按住 SHIFT，然后按 C 而不按 SHIFT，请使用“+EC”。

请注意，由于您希望`ESC`和（比如说）`E`同时按下，您需要将它们括在括号中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-09-20T09:06:25.560

Alt+F4 仅在括号中有效

```
SendKeys.SendWait("(%{F4})"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-05-08T11:43:42.267

[从nuget 包](https://www.nuget.org/packages/InputSimulator/)下载 InputSimulator 。

然后写这个：

```
 var simu = new InputSimulator();
        simu.Keyboard.ModifiedKeyStroke(VirtualKeyCode.LWIN, VirtualKeyCode.VK_E); 
```

在我的情况下，要创建新的垂直桌面，需要 3 个键和这样的代码（windows 键 + ctrl + D）：

```
 simu.Keyboard.ModifiedKeyStroke(new[] { VirtualKeyCode.LWIN, VirtualKeyCode.CONTROL }, VirtualKeyCode.VK_D); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-09T10:41:16.283

```
SetForegroundWindow( /* window to gain focus */ );
SendKeys.SendWait("^{ESC}"); // ^{ESC} is code for ctrl + esc which mimics the windows key. 
```

# c - 运行 C 程序时出现分段错误（putchar() 和多维数组指针）

> ID：10366157
> 
> 赞同：0
> 
> 时间：2012-04-28T18:03:32.667
> 
> 标签：c, putchar

我正在尝试在 C 上运行以下代码：

```
#include "ex1_1.h"

void path(char **adj_mat, int u, int v)
{
        printf("test\n");
        char temp = *adj_mat[1];
        putchar(temp);
}

int main()
{
    int u = 5;
    int v = 5;
    char mat[5][5]={
    {'0', '1', '1', '1', '0'},
    {'0', '0', '0', '0', '1'},
    {'0', '0', '0', '0', '0'},
    {'0', '0', '0', '0', '0'},
    {'0', '0', '0', '0', '0'}
    };
    char** adj_mat = (char**)&mat;
    printf("Mtest\n");
    path(adj_mat, u, v);
    return 1;
} 
```

我得到“分段错误”。

我不知道为什么，我猜这与我如何将 putchar() 与多维数组指针一起使用有关。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:11:18.457

A`char[5][5]` **不是**`char **`. _

将您的`path`函数声明为其中之一（它们是等效的）：

```
void path(char (*adj_mat)[5], int u, int v)
void path(char adj_mat[5][5], int u, int v) 
```

并像使用它一样

```
path(mat, u, v); 
```

* * *

更新：现在是段错误的原因。

`mat`是 5 数组的 5数组，当用作表达式时`char`，它将“衰减”为指向 5 数组的指针。`char`这意味着`mat`可以将其用作指向 5 数组的指针。通常，类型的 n 数组**将**`T`衰减为类型的指针`T`（注意`T`不会衰减！）。

 **所以请注意，`mat`当您将它传递给您的函数时，您将其用作表达式`pass()`。在 C 中，不可能将数组按原样传递给函数，但它只能“接收”指针。

`char`那么指向 的指针的指针和指向 5 数组的指针有什么区别`char`呢？他们的类型。以及它们的尺寸。

假设你有一个指向 a 的指针，`char`我们称之为它`p`，我们有一个指向 5-array 的指针`q`。简而言之：`char **p`和`char (*q)[5]`。

当您编写时`p[i]`，这将相当于`*(p+i)`. 这里有指针算术。`p+i`具有值（这是一个地址）`p`加上`i*sizeof(char *)`因为`p`指向 a `char *`。

当你看的时候`q`，`q+i`就会有`q`加分的价值`i*sizeof(char[5])`。

这些几乎总是不同的！

* * *

**更新**（现在真正的答案）：你的情况更糟，因为你“强迫” `char (*q)[5]`“成为”a `char p**`（通过你的无效类型转换），所以在你的电话中

```
char temp = *adj_mat[1]; 
```

`adj_mat[1]`将查看矩阵的第二行并尝试将其值解释为指针（但它是一个 5 数组！），因此当您通过取消引用时，`*adj_mat[1]`您将降落在必杀技的某个地方 - 段错误！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T18:13:28.143

The conversion `(char**)&mat` is undefined behavior. `&mat` is `char(*)[5][5]` (In words, pointer to array of 5 arrays of 5 chars), and you can't convert it to pointer to pointer to char.

I would write `path` like (assuming C99):

```
void path(char *arr,int u,int v) {
 char (*adj_mat)[v]=arr;
 ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T18:12:13.717

换行

```
char temp = *adj_mat[1]; 
```

至

```
char temp = adj_mat[1]; 
```

问题是在

```
*adj_mat[1]; 
```

您尝试取消引用指向无效地址的指针，即 '1' 的 ASCII 码（我想）。**

# c - 在 Linux 中触发播放/暂停事件

> ID：10366166
> 
> 赞同：1
> 
> 时间：2012-04-28T18:04:57.603
> 
> 标签：c, linux, events, shell, media

我想在 Linux 机器上使用 shell 脚本或 C 程序触发播放/暂停事件。不幸的是，我还没有找到一种方法来做到这一点。起初我想模拟点击 fn-Play 键，但我找不到让它工作的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-12-15T02:49:39.577

```
sudo showkey -k 
```

当您按下 时，这将显示相​​应的键码`Fn + F6`。假设播放按钮打开`F6`。然后，您可以在 C 中[模拟](https://stackoverflow.com/questions/1262310/simulate-keypress-in-a-linux-c-console-application)适当的按键。

# lucene - 如何用逗号分隔的文本值索引字段 - 休眠搜索

> ID：10366168
> 
> 赞同：1
> 
> 时间：2012-04-28T18:05:21.747
> 
> 标签：lucene, hibernate-search

我正在实现一个基于hibernate search3.2的图书搜索功能。

Book 对象包含一个名为 authornames 的字段。Authornames 值是名称列表，逗号是分隔符，例如“John Will, Robin Rod, James Timerberland”

```
@Field(index = org.hibernate.search.annotations.Index.UN_TOKENIZED,store=Store.YES)
@FieldBridge(impl=CollectionToCSVBridge.class)
private Set<String> authornames; 
```

我需要将每个名称都设为 UN_TOKENIZED，以便用户按单个作者姓名搜索图书：John Will、Robin Rod 或 James Timerberland。

我使用 Luke 来检查索引，并且 authornames 字段中的值存储为“John Will, Robin Rod, James Timerberland”，但我无法通过查询“authornames:John Will”获得结果

任何人都可以告诉我我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T17:08:50.030

我猜*CollectionToCSVBridge*将所有名称与“，”连接在一个更大的字符串中。您应该将它们分开，并将每个元素单独添加到索引中：

```
@Override
public void set(String name, Object value, Document document, LuceneOptions luceneOptions) {
    if ( value == null ) {
        return;
    }
    if ( !( value instanceof Collection ) ) {
        throw new IllegalArgumentException( "This FieldBridge only supports collections." );
    }
    Collection<?> objects = (Collection<?>) value;

    for ( Object object : objects ) {
        luceneOptions.addFieldToDocument( name, objectToString( object ), document ); // in your case objectToString could do just a #toString
    }
} 
```

另请参阅[https://forum.hibernate.org/viewtopic.php?f=9&t=1015286&start=0](https://forum.hibernate.org/viewtopic.php?f=9&t=1015286&start=0)

# php - 通过隐藏的 iframe 将选项动态添加到列表

> ID：10366183
> 
> 赞同：0
> 
> 时间：2012-04-28T18:06:58.153
> 
> 标签：php, javascript, ajax, iframe, xmlhttprequest

我想通过隐藏的 iframe 将选项动态添加到列表中；我怀疑我的错误出在下面的 PHP 中：

```
<?php echo 'var oInner  = document.createTextNode("'.$donnees["name"].'");'; ?> 
```

因为我的代码完美地适用于：

```
<?php echo 'var oInner  = document.createTextNode("Newoption");'; ?> 
```

我不知道为什么 createtextnode 不想使用我的 PHP var ...我认为这可能是同源策略，因为数据库位于我网站之外的服务器上。

我不知道。

您会发现随附的完整代码：

在我的 HTML 中，我有：

```
//select or change a country will trigger the javascript part
<select name="countrym" id="countrym" onchange="validcountry();">
    <option value"France">France</option>
</select>

//Empty region list
<select name="regionm" id="regionm">
</select>

//My Iframe
<iframe name="upload_iframe2" id="upload_iframe2" frameborder="0"></iframe> 
```

在我的 Javascript 中，我有：

```
//My function triggering the PHP through the Iframe
function validcountry() {
var countrym = document.getElementById('countrym');
    var choixco = countrym.options[countrym.selectedIndex].value;
    document.getElementById('upload_iframe2').src = 'region.php?choix='+choixco; 
```

在我的 PHP region.php 文件中，我有：

```
<?php

// Get my choice
$codepays = $_GET['choix'];

//Retrieve the regions corresponding to the country
$pdo_options[PDO::ATTR_ERRMODE] = PDO::ERRMODE_EXCEPTION;
$bdd = new PDO(XXX);
$req = $bdd->prepare('SELECT name FROM regions WHERE country = :country');
$req->execute(array('country' => $codepays));
$donnees = $req->fetch();

while($donnees)
   {   
// I checked the format of the data (no problem so far)
echo var_dump ($donnees['name']);
?>

//I add an option through Javascript
<script language="JavaScript" type="text/javascript">
var oOption = document.createElement("option");

//Here is my big issue:
<?php echo 'var oInner  = document.createTextNode("'.$donnees["name"].'");'; ?>

oOption.value = "none";
oOption.appendChild(oInner);
var parDoc = window.parent.document;
var regionm = parDoc.getElementById("regionm");
regionm.appendChild(oOption);
</script> 

<?php
$donnees = $req->fetch();
}
$req->closeCursor();
exit();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T23:33:13.813

我怀疑找不到索引元素。但在所有情况下，下面的方法都应该有效。

```
<?php echo 'var oInner  = document.createTextNode("'. (isset($donnees["name"]) ? $donnees["name"] : '') .'");'; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T16:34:43.483

找到了解决方案：它是 php 插入 \n 所以解决方案是执行以下操作：

```
$desc= 'var oInner  = document.createTextNode("'.$donnees["name"].'");';
$desc=  str_replace("\n", "",$desc);
$desc=  str_replace("\r", "",$desc); 
```

谢谢大家

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T22:12:04.070

你试过简单`oOption.innerHTML = '<?php echo $donnees["name"] ?>';`吗？

# iphone - 应用内购买无法添加到此版本，因为它已提交审核。

> ID：10366184
> 
> 赞同：19
> 
> 时间：2012-04-28T18:07:00.703
> 
> 标签：iphone, in-app-purchase, app-store-connect

我在这里有点麻烦。

当我添加 IAP 时，我为我的应用添加了一个新版本。我在新版本部分的“管理应用内购买”菜单中添加了 IAP 项。但是我忘记在新版本“查看详细信息”页面中选择要添加的 IAP 项目。所以我拒绝了二进制文件，希望重新出现选择 IAP 项目的选项。但不，它不再出现。它说的是：

> 应用内购买无法添加到此版本，因为它已提交审核。要管理您的应用内购买，请返回应用摘要页面并单击管理应用内购买按钮。

那么现在该怎么办呢？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-28T18:31:34.937

我讨厌回答我自己的问题，但这里有。

似乎只有当应用状态处于“准备上传二进制文件”或“二进制文件被拒绝”时，您才能在应用程序新版本的“查看详细信息”页面中选择 IAP 项目。

所以我所做的是拒绝我的二进制文件并删除 IAP 项目，然后在 Manage In App Purchases 中再次添加 IAP 项目。虽然需要给它一个新的ID，但对我来说没什么大不了的。

之后，您应该可以在查看详细信息页面中选择 IAP 项。然后，按“准备上传二进制文件”...

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-07T08:01:39.503

我为它找到了非常奇怪的步骤......

*   上传你的二进制文件
*   等到“等待审核”
*   自己拒绝二进制文件（应用程序版本>二进制详细信息>拒绝二进制文件）
*   等到“开发者被拒绝”
*   去添加你的应用内购买
*   重新提交二进制文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-09T12:59:24.803

只要确保状态不是等待上传，如果是，上传一个二进制文件然后拒绝它。

您无需删除 IAP 项目。

之后，您应该能够编辑应用程序的“应用内购买”部分。

# c - 简单的 TDI 驱动程序

> ID：10366185
> 
> 赞同：1
> 
> 时间：2012-04-28T18:07:03.050
> 
> 标签：c, driver

谁能给我一个简单的 TDI 驱动程序，它可以阻止来自指定 IP 端口的流量，或修改数据包。我找不到关于这个的好手册。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:59:41.763

TDI 驱动程序***非常***复杂。有些公司以 20,000 美元的价格出售它们，它们物有所值。开发和调试 TDI 驱动程序需要数年时间。原因：Windows 对它们的实现不佳，它们是网络堆栈本身的一部分。

尝试使用 WFP（Windows 过滤平台），这是一个更简单的界面，但不支持 Windows XP。祝你好运。

# objective-c - Xcode / Cocoa：事件后更改 uitableviewcell 格式

> ID：10366186
> 
> 赞同：0
> 
> 时间：2012-04-28T18:07:20.710
> 
> 标签：objective-c, xcode, cocoa-touch

我有一个名为 CustomCell 的自定义 UITableView 子类。单击单元格时，会出现一个 UIActivityIndi​​cator 并且程序会关闭并尝试使用所选内容进行计算。完成计算后，我想隐藏指示器并将 discolsure 标记设置为复选标记。

我是这样实现的：

在 didSelectRowAtIndexPath 内部：

```
CustomCell *thisCell = [[CustomCell alloc] init];
thisCell = (CustomCell *)[tableView cellForRowAtIndexPath:indexPath];

[[thisCell indicator] setHidden:NO];
[[thisCell indicator] startAnimating];
[thisCell setAccessoryType:UITableViewCellAccessoryNone];

NSString *selection = [[thisCell lblName] text];

[[[masterViewController loadingQueue] objectForKey:@"myFriends"] setObject:thisCell forKey:selection]; 
```

在计算完成方法内部：

```
 CustomCell *cell=[[[masterViewController loadingQueue] objectForKey:@"myFriends"] objectForKey:selection];

    [[cell indicator] setHidden:YES];
    [cell setAccessoryType:UITableViewCellAccessoryCheckmark]; 
```

指示器在 cellForRowAtIndexPath 中正确显示，但不会隐藏，并且在完成方法中附件类型不会更改。我没有收到任何错误。

# php - 如何在没有 post 方法的情况下将图像保存在 MYSQL 数据库中？

> ID：10366187
> 
> 赞同：0
> 
> 时间：2012-04-28T18:07:21.280
> 
> 标签：php

我想在没有 post 方法的情况下将 gif 类型的图像保存在 mySQL 数据库中。

```
<form action="add_file.php" method="post" enctype="multipart/form-data">
        <input type="file" name="uploaded_file"><br>
        <input type="submit" value="Upload file">
</form> 
```

我只想通过 php 代码上传文件。例如：

```
// Gather all required data
        $name = $File_Name;
        $mime = $File_Type;
        $data = $File_Data;
        $size = $File_Size;

        // Create the SQL query
        $query = "
            INSERT INTO `file` (
                `name`, `mime`, `size`, `data`, `created`
            )
            VALUES (
                '{$name}', '{$mime}', {$size}, '{$data}', NOW()
            )"; 
```

我在本地有超过 21,000 张图像。我想循环保存图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:15:44.273

使用 FTP 上传文件，然后编写一个只运行一次的小 PHP 脚本，循环遍历文件夹并将图像添加到数据库中。

确保在完成后删除 php 文件，以免意外再次运行它；）

# mysql - 用于国际化的高效 MYSQL DB 结构

> ID：10366190
> 
> 赞同：0
> 
> 时间：2012-04-28T18:07:23.920
> 
> 标签：mysql, database-design

我正在为我的数据库添加对多种语言的支持。它有大约 10 个不同结构的表。我绘制了下面的结构，我认为这是一个好方法：

表*语言*：

```
lang_id (int)
lang_name (varchar 128) 
```

表*样本 1*：

```
sample_1_id (int)
name (int -- tran_id)
description (int -- tran_id ) 
```

表*样本 2*：

```
sample_2_id (int)
person (int -- tran_id)
page (int -- tran_id) 
```

表*翻译*：

```
tran_id (int)
lang_id (int)
content (text) 
```

但是，为了全面开展这项工作，翻译表中的内容列是否必须是“文本”类型？如果是这样，那会不会浪费空间，尤其是当其中存储的大部分数据只是几个字符时？有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:26:18.237

考虑两个翻译表。像这样的一个：

Translations_Short:

```
tran_id (int)
lang_id (int)
content (VARCHAR(255)) 
```

请注意，MySQL 5.0.3+ 中 VARCHAR 的限制实际上是 65,535 字节，尽管这也是行限制。所以，你可以使用：

```
tran_id (int)
lang_id (int)
content (VARCHAR(65522)) 
```

还有一个是这样的：

翻译_长：

```
tran_id (int)
lang_id (int)
content (text) 
```

TEXT 只有 65535，所以在 MySQL 5.0.3+ 中，这已经被覆盖了。你也可以在这里使用 MEDIUMTEXT。

然后，您可以像这样决定每列：

```
sample_1_id (int)
name (int -- tran_long_id)
description (int -- tran_short_id ) 
```

您的应用程序会知道要链接到哪一个，对吗？

无论如何，TEXT 并没有比 VARCHAR 占用更多的空间。也许是一两个字节。问题是性能，而不是空间。由于您不会为 TEXT 列编制索引，因此这也不太可能成为问题，除非您计划使用覆盖索引（这在 TEXT 中是不可能的）。无论如何，VARCHAR 的索引限制为 767 字节，因此您不能使用 VARCHAR 列超过 767 字节的覆盖索引。

但是，如果您真的认为有必要，这将允许您将它们分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-19T14:53:04.407

这个怎么样......让我们以“页面”表为例。

主“**页**”表：

id - 主要

关联

一个约会

约会

地位

ETC...

翻译“ **pages_langs** ”表：

page_id - 主要的

lang_id - “语言”表，例如 1 ** 这里所有你想要管理的翻译 **

title - 页面的标题，例如 lang_id=1

文本

term - （该术语用于 url beautify 和类似的东西，需要在 langs 表中）

“**语言**”表：

id - 主要

标题

字首

SELECT 将是这样的：

```
SELECT p.id, p.link, pl.title, pl.text 
FROM pages
INNER JOIN pages_langs pl ON p.id = pl.page_id AND pl.lang_id = <<current lang id>> 
```

任何问题？

# gwt - 如何使用 GWT 序列化流工厂

> ID：10366195
> 
> 赞同：0
> 
> 时间：2012-04-28T18:07:51.190
> 
> 标签：gwt, serialization, smartgwt, gwt-rpc

我正在尝试使用 SerializationFactory 序列化 GWT 中的对象，但无法使其正常工作。这是我的 POC 的示例代码：

```
 import com.google.gwt.user.client.rpc.SerializationException;
    import com.google.gwt.user.client.rpc.SerializationStreamFactory;
    import com.google.gwt.user.client.rpc.SerializationStreamReader;
    import com.google.gwt.user.client.rpc.SerializationStreamWriter;
...........
Some code here....
.........

......

SerializationStreamFactory factory = (SerializationStreamFactory) GWT.create(MyClass.class);
    SerializationStreamWriter writer = factory.createStreamWriter();

    try {
        writer.writeObject(new MyClass("anirudh"));
        String value = writer.toString();

        SerializationStreamReader reader = factory.createStreamReader(value);

        MyClass myObj = (MyClass) reader.readObject();
        System.out.println(myObj.getName());
    } catch (SerializationException e) {
        e.printStackTrace();
    } 
```

它给了我以下异常

```
Caused by: java.lang.RuntimeException: Deferred binding failed for 'com.anirudh..client.MyClass' (did you forget to inherit a required module?) 
```

同样在我的代码中，我试图序列化其对象的类实现 IsSerializable

```
MyClass implements IsSerializable 
```

我不想使用 GWT Auto-Bean 框架，因为它不适合我的用例。此外，我没有使用 GWT-RPC 框架，现在我非常坚持使用 SerializationStreamFactory :D，因为我非常想知道这个东西是如何工作的。

任何人都可以分享 SerializationStreamFactory 的工作示例或帮助我指出我所做的任何错误。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T20:32:40.570

> SerializationStreamFactory 工厂 = (SerializationStreamFactory) GWT.create(MyClass.class);

你期待这条线做什么？GWT 将尝试找到与此类匹配的`replace-with`or规则（要么or ），否则将尝试在 MyClass 上有效地调用零参数构造函数。这是你所期待的吗？`generate-with``when-type-assignable``when-type-is``new MyClass()`

您粘贴的所选异常表明它`MyClass`可能不在 GWT 编译的源路径上，但完整的错误日志将提供更多信息。

看起来好像您正在尝试模仿生成的 RPC 代码，其中 *Async rpc 接口将由扩展自`com.google.gwt.user.client.rpc.impl.RemoteServiceProxy`（实现`SerializationStreamFactory`）的代码实现。该基本实现进一步扩展为初始化几个字段，例如`com.google.gwt.user.client.rpc.impl.Serializer`实例，实际上负责序列化和反序列化对象流。

序列化程序（默认情况下）是从 的基类`com.google.gwt.user.client.rpc.impl.SerializerBase`通过重新绑定类创建的`com.google.gwt.user.rebind.rpc.TypeSerializerCreator`。如果您已经`MyClass`为`ProxyCreator`.

请记住，在构建您自己的序列化/反序列化机制时，您需要决定哪些类型可以在该系统中编组 - 如果您将其开放给所有类型，那么您将需要为源路径上的所有可能对象生成 FieldSerializer 类型。这将大大扩展编译代码的大小。

如果您的主要目标是了解这种“魔法”的工作原理，请深入研究`com.google.gwt.user.rebind.rpc`包中的生成器和相关代码。还有其他库利用了这些想法，例如 gwt-atmosphere 项目（请参阅[https://github.com/Atmosphere/atmosphere](https://github.com/Atmosphere/atmosphere)开始）。还要查看 GWT 在构建“传统”RPC 接口时创建的生成代码。

# grails - String[] 的 Grails 静态映射

> ID：10366197
> 
> 赞同：0
> 
> 时间：2012-04-28T18:07:53.897
> 
> 标签：grails, grails-orm

我正在尝试使用 grails 将字符串 [] 存储在数据库中，但 tinyblob 不够大。我尝试将映射更改为 blob 和 longblob 但是当我这样做时出现错误：

```
[Ljava.lang.String; cannot be cast to java.sql.Blob 
```

接下来，我尝试在域约束内更改 maxSize，但出现错误

```
No such property: maxSize for class: 
```

关于如何让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T23:32:05.643

我很好奇你这样做的理由。如果您只是想将许多字符串与域类关联，您可以直接这样做：

```
 static hasMany = [whatevers: String] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T01:11:02.700

blob 不是字符串数组，它是字节数组，byte[]。尝试将字符串更改为字节数组并以该形式保存。

# javascript - 为什么滑块不会在悬停时停止

> ID：10366204
> 
> 赞同：1
> 
> 时间：2012-04-28T18:08:33.000
> 
> 标签：javascript, jquery, css

我正在使用响应式滑块，它不会在悬停时停止，我不明白为什么，这是我的脚本告诉它在悬停时暂停

```
<script type='text/javascript'>
 $(function () {
    $(&quot;.rslides&quot;).responsiveSlides({
  timeout: 8000,                  
  pause: true, 
});
  });
</script> 
```

这是实现它的页面的现场演示[http://bloghutsbeta.blogspot.com/2012/04/testing-slider.html](http://bloghutsbeta.blogspot.com/2012/04/testing-slider.html)

相关标记：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src='http://files.cryoffalcon.com/javascript/responsiveslides.min.js' type='text/javascript'/> 
```

HTML：

```
<ul class="rslides">
<li><img width="660" height="400" src="http://responsive-slides.viljamis.com/1.jpg" alt="" /></li>
<li><img width="660" height="400" src="http://responsive-slides.viljamis.com/2.jpg" alt="" /></li>
<li><img width="660" height="400" src="http://responsive-slides.viljamis.com/3.jpg" alt="" /></li>
</ul> 
```

CSS：

```
.rslides {
  position: relative;
  list-style: none;
  overflow: hidden;
  width: 660px;
  padding: 0;
  margin: 0;
height:400px;
  }

.rslides li {
  position: absolute;
  width: 660px;
height:400px;
  left: 0;
  top: 0;
  }

.rslides li:first-child {
  position: relative;
  display: block;
  float: left;
  }

.rslides img {
  display: block;
  height: auto;
  float: left;
  width: 660px;
height:400px;
  border: 0;
  } 
```

编辑：链接到这个插件的创建者的页面[http://responsive-slides.viljamis.com/](http://responsive-slides.viljamis.com/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T18:14:36.353

```
<script type='text/javascript'>
 $(function () {
    $(".rslides").responsiveSlides({//use quotes
  timeout: 8000,                  
  pause: true//trailing comma taken out 
});
  });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:28:51.247

问题是您使用的是该插件的 1.23 版，并且如 GitHub 上的更改日志中所述，该选项已在 1.3 版中添加。看看这里并下载最新版本：[https ://github.com/viljamis/ResponsiveSlides.js](https://github.com/viljamis/ResponsiveSlides.js)

# java - 无法解析名称为“xmlView”的视图

> ID：10366206
> 
> 赞同：1
> 
> 时间：2012-04-28T18:08:54.610
> 
> 标签：java, spring, configuration

在开发、验收和生产机器上，我们运行相同版本的基于 Spring 的 Web 应用程序。只有在验收机器上，应用程序才同时支持 XML 视图 (/foo/bar.xml) 和 JSON 视图 (/foo/bar.json)。

在另外两台机器上调用 XML 视图会导致显示臭名昭著的“无法解析名称为 'xmlView' 的视图”错误消息。JSON 视图工作正常。

由于此 Web 应用程序在所有三台机器上都是相同的（我使用 diff 进行了双重检查），因此在我看来，这种不同的行为是由某些外部因素引起的。

有谁知道这是否可能，或者我是否应该仍然专注于 Spring 配置的设置？

# objective-c - 按位置从 TextView 推断单词

> ID：10366207
> 
> 赞同：0
> 
> 时间：2012-04-28T18:08:56.803
> 
> 标签：objective-c, xcode, uitextview

我有一个 TextView，我需要在该位置的字符串中插入一个单词。使用此方法推导出位置

```
NSInteger location = textView.selectedRange.location; 
```

但我不知道如何把它变成一个字符串。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:10:45.367

是你要找的吗？

```
NSInteger location = textView.selectedRange.location;
UITextView yourTxtView;
yourTxtView.text = [NSString stringWithFormat:@"%d",location]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:32:47.230

如果您想用一个单词替换选择，最简单的方法是这样的：

```
NSRange range = textView.selectedRange;
if (range.location != NSNotFound) {
    NSString *replacement = @"some word";
    textView.text = [textView.text stringByReplacingCharactersInRange:range
                                                           withString:replacement];
} 
```

对于空选择，这将在插入符号位置插入文本，如果选择了文本，它将被替换。在 iOS 5 上，使用`UITextInput`协议中的方法可能会更高效，但使用起来也更麻烦。

# ruby-on-rails-3 - 链接两个表上的操作

> ID：10366210
> 
> 赞同：0
> 
> 时间：2012-04-28T18:09:26.710
> 
> 标签：ruby-on-rails-3

对不起，标题不是很有描述性，但这是我想要做的：

我正在制作一个处理学生团体资助请求的网站。一项特定的资助请求可能涉及任意数量的项目。我有两个表：请求和项目。一个小组通过填写“请求”表格开始请求，其中包含请求的简要摘要、类别（演讲者、广告等）以及官僚程序所需的一些其他字段。这工作正常，几乎完全由脚手架处理。我遇到的问题是“项目”。我希望用户单击新请求表单上的“提交”按钮并被带到另一个页面，在该页面他可以将任意数量的项目添加到项目表中，所有项目都包含在他刚刚提交的请求的 id 字段中.

前端外观并不重要——它可能都在一个页面上——重要的是用户将信息提交到一个表，然后将信息提交到第二个表，发送到第二个表的信息包含连接的东西它把刚刚提交的信息放到第一个表中。

正如您可能猜到的那样，我对 Rails 很陌生（我阅读了《Head First Rails》一书，并且正在从事我的第一个项目），因此我正在寻找有关如何完成此操作的一般解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:22:59.677

我建议您阅读/观看本教程。这是相当不错的。

更新：

[http://railscasts.com/episodes/196-nested-model-form-part-1](http://railscasts.com/episodes/196-nested-model-form-part-1)

希望能帮助到你。

# teamcity - 构建后更新被阻止的二进制文件

> ID：10366212
> 
> 赞同：0
> 
> 时间：2012-04-28T18:09:38.413
> 
> 标签：teamcity

我想将二进制文件复制到暂存服务器作为构建的最后一步。以前我是为由 IIS 提供支持的 asp.net 网站做的。没有问题，因为 IIS 不会阻止任何边界。现在我需要对至少阻止其 exe 文件的可执行服务器应用程序（它执行一些后台任务）执行相同的操作。所以我需要以某种方式关闭应用程序，更新二进制文件，然后再次运行应用程序。

使用 TeamCity 实现它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T17:42:01.467

我好像你的登台服务器是一台 Windows 机器。如果是这种情况，我建议使用[PsTools Suite](http://technet.microsoft.com/en-us/sysinternals/bb896649)中的两个可执行文件（PsKill 和 PsExec）来终止/启动您的进程。以下是我在 TeamCity 中设置所有内容的方法：

1.  [下载](http://download.sysinternals.com/files/PSTools.zip)PsTools Suite，并将 zip 文件的内容复制到构建服务器上的文件夹中。我将在我的示例中使用 C:\Program Files\PsTools。

2.  创建一个杀死可执行服务器应用程序的批处理文件，复制适当的二进制文件，然后再次启动应用程序。批处理文件看起来像这样：

    "C:\Program Files\PsTools\PsKill" -accepteula \computername -u 用户名 -p 密码 name_of_process_to_kill.exe

    复制文件 - 我假设您使用命令行将二进制文件复制到 ASP.Net 登台站点。如果没有，我可以稍后提供更多详细信息。

    "C:\Program Files\PsTools\PsExec" -accepteula \computername -u 用户名 -p 密码 -d "path_and_name_of_executable_on_remote_server" optional_commandline_args_here

3.  将新的命令行构建步骤添加到您的 TeamCity 构建配置，以执行在步骤 #2 中创建的批处理文件。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T08:25:58.460

这是我解决它的方法。我使用以下自定义脚本添加了命令行步骤：

```
taskkill /IM MyApplicationProcessName /F
xcopy RelativePathToBuildBinaires PathWhereToDeployBinaries /s /e /y
start PathToMyApplicationExeInDeployFolder 
```

最初它不能作为 TeamCity 构建代理作为服务工作（没有 UI）。然后我禁用了服务并开始构建代理作为控制台（通过 TeamCityFolder/builagent/bin/agent.bat）。它奏效了。

# java - 如何在 Java 中将通知从 EJB 容器发送到 Web 容器

> ID：10366221
> 
> 赞同：1
> 
> 时间：2012-04-28T18:10:48.863
> 
> 标签：java, jsf, web, ejb

我想从 EJB 容器向 Web 容器发送通知，显示服务层发生了一些事情。
基本上我的服务层在 EJB 容器上，我在我的 Web 服务上收到来自客户端的请求，并想告诉 Web 容器发生了一些请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:17:43.493

我前一段时间遇到了同样的问题，我使用 AJAX 完成了它。我发现您无法将通知从 EJB 容器发送到 Web 容器，而必须通过轮询 EJB 容器来显式检查 Web 容器。每当您在 EJB 容器中收到请求时，您都可以设置一个布尔变量，并在某个时间后通过池化检查 Web 容器中的变量值，因此如果该布尔值为真，则意味着您有一些通知并且您可以获得该通知。
我已经通过上述方法做到了，希望这对你有用

# asp.net-mvc-3 - 如何将 url 从控制器/模型传递到视图

> ID：10366222
> 
> 赞同：1
> 
> 时间：2012-04-28T18:11:00.450
> 
> 标签：asp.net-mvc-3

我有一个模型，它具有类似“SomeUrl”的属性，它是一个包含一些参数的绝对 url，例如： [http ://www.someexternalsite.com/q?param1=value1¶m2=value2](http://www.someexternalsite.com/q?param1=value1&param2=value2)

我的视图需要一个列表，我试图在这样的锚标记中使用这些 url：

```
<a href="@Model.SomeUrl">my link</a> 
```

url 正在被编码，最终会像这样出现：

```
http://www.someexternalsite.com/q?param1=value1&amp;param2=value 
```

我该如何阻止它这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:21:15.987

不编码 & 会导致无效的 html。在这种情况下，html 被正确编码。如果要呈现未编码的字符串，请使用：

```
@Html.Raw(...) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:34:05.953

将您的链接更改为：

```
<a href="@Html.Raw(Model.SomeUrl)">my link</a> 
```

# mysql - 为什么这个 IF THEN SQL 语句会返回错误？

> ID：10366223
> 
> 赞同：0
> 
> 时间：2012-04-28T18:11:10.740
> 
> 标签：mysql, sql, if-statement

我想`right join`在这个 SQL中执行一个条件

```
SELECT *
 FROM   post
   IF   1 = 1 THEN RIGHT JOIN faves ON faves.post_id_fk = post_id;  // <== error
END IF;
 WHERE  post_author_id
        LIKE 1
 ORDER  BY post_timestamp DESC
 LIMIT  0, 10 
```

有没有更好/正确的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:21:48.623

你的病情从何而来？

1.  如果它来自 SQL 之外，为什么不确定是否将联接放入该级别的查询中：

    ```
    $qry = "SELECT * FROM post " . ($test ? " RIGHT JOIN ... " : "") . "..."; 
    ```

2.  否则，如果必须在 SQL 中进行测试，我会将不同的语句分开：

    ```
    DELIMITER ;;

    IF @test THEN
        SELECT * FROM post RIGHT JOIN ... ;
    ELSE
        SELECT * FROM post ... ;
    END IF;;

    DELIMITER ; 
    ```

# javascript - Rails 资产 javascript 模板错误

> ID：10366224
> 
> 赞同：1
> 
> 时间：2012-04-28T18:11:14.937
> 
> 标签：javascript, ruby-on-rails, templates, assets

昨晚带着一个功能齐全的应用程序睡觉。我厌倦了 webrick 的性能，决定使用不同的 web 服务器进行开发。我醒来并安装了 Thin。我立即收到错误。我不知道发生了什么，所以我卸载了 Thin 并回到 Webrick 完成一些事情。令我惊讶的是，错误仍然存​​在！

这是错误：

```
Started GET "/signin" for 127.0.0.1 at 2012-04-28 11:01:28 -0700
Processing by SessionsController#new as HTML
Rendered sessions/new.html.erb within layouts/application (2.0ms)
Compiled application.js  (287ms)  (pid 2928)
Completed 500 Internal Server Error in 868ms

ActionView::Template::Error (cannot load such file -- ["ok","(function() {\n\n\n\n}).call(this);\n"]

(in E:/[my app's directory]/app/assets/javascripts/admins.js.coffee)):
13:   <meta name="viewport" content="width=1024, maximum-scale=1.0">
14:   <%= stylesheet_link_tag "application", :debug => Rails.env.development? %>
15:   <%= yield :headercss %>
16:   <%= javascript_include_tag "application", :debug => Rails.env.development? %>
17:   <%= yield :headerjs %>
18:   <%= csrf_meta_tags %>
19: </head>

app/views/layouts/application.html.erb:16:in `_app_views_layouts_application_html_erb__960238137_43581456'
config/initializers/quiet_assets.rb:5:in `call_with_quiet_assets'

Rendered C:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.1.3/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.0ms)
Rendered C:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.1.3/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.0ms)
Rendered C:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.1.3/lib/action_dispatch/middleware/templates/rescues/template_error.erb within rescues/layout (7.0ms) 
```

我尝试预编译......我遇到了同样的问题。它在我的 javascript_include_tag 上呕吐……这让我发疯。它正在寻找 admins.js.coffee 文件...如果我删除它，它将在下一个 javascript 文件中引发错误。我完全糊涂了，请帮忙！有人帮忙！:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:16:50.947

哇。我只是浪费了我生命中的5个小时。在为故障排除疯狂而发疯之后......在绝望中，我开始做奇怪的事情......我最终从我的资产/javascripts文件夹中剪切并粘贴了我所有的.coffee文件并将它们粘贴回来，一切正常！！！！是的，我清除了我的 tmp 缓存、资产缓存和我能想到的每个缓存……wtf ！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T21:23:30.153

感谢您提出这个问题和 agmcleod 指出正确的方向......在尝试升级到 3.2 后开始出现此错误，并且在过去几天试图找出有罪的 js 部分 :)

**execjs 和 coffee-script-source**最近已升级，但不是**coffee-script**

```
coffee-rails (3.1.1)
  coffee-script (>= 2.2.0)
  railties (~> 3.1.0)
coffee-script (2.2.0)
  coffee-script-source
  execjs
**coffee-script-source (1.2.0)**
**execjs (1.3.0**)
  multi_json (~> 1.0) 
```

在 gemfile 中包含这些确切的版本为我解决了这个问题，希望它也能帮助你。

干杯

# postgresql - 为 node.js 安装 node-postgres 模块时构建失败

> ID：10366228
> 
> 赞同：0
> 
> 时间：2012-04-28T18:11:30.777
> 
> 标签：postgresql, node.js, installation

我对 node.js 非常（非常）新，在服务器端配置和编码方面也相当绿色。（我有很长的客户端编程历史，最近使用的是 Adob​​e Flex 和 ActionScript。）

无论如何，我让 Rackspace（为我管理 Linux 服务器）安装 node.js 和 node-postgres。

从票证中的评论来看，安装过程是这样的：

* * *

节点.js

```
Running Transaction
  Installing     : nodejs-stable-release                             [1/1] 

Installed: nodejs-stable-release.noarch 0:5-3
Complete! 
```

和节点postgres

```
[root@237175-web2 src]# npm install pg  

npm http GET https://registry.npmjs.org/pg  
npm http 200 https://registry.npmjs.org/pg  
npm http GET https://registry.npmjs.org/pg/-/pg-0.6.17.tgz  
npm http GET https://registry.npmjs.org/generic-pool/1.0.9  
npm http 200 https://registry.npmjs.org/generic-pool/1.0.9  
npm http GET https://registry.npmjs.org/generic-pool/-/generic-pool-1.0.9.tgz  

 pg@0.6.17 install /usr/src/node_modules/pg  
 node-waf configure build || (exit 0)

Checking for program g++ or c++          : /usr/bin/g++   
Checking for program cpp                 : /usr/bin/cpp   
Checking for program ar                  : /usr/bin/ar   
Checking for program ranlib              : /usr/bin/ranlib   
Checking for g++                         : ok    
Checking for node path                   : not found   
Checking for node prefix                 : ok /usr   
Checking for program pg_config           : /usr/bin/pg_config   
'configure' finished successfully (0.051s)  
Waf: Entering directory `/usr/src/node_modules/pg/build'  
[1/2] cxx: src/binding.cc -> build/Release/src/binding_1.o  
[2/2] cxx_link: build/Release/src/binding_1.o -> build/Release/binding.node  
Waf: Leaving directory `/usr/src/node_modules/pg/build'  
'build' finished successfully (0.745s)  
pg@0.6.17 ./node_modules/pg  
+-- generic-pool@1.0.9 
```

* * *

更多信息：

```
[root@237175-web2 ~]# ls -la /usr/src/node_modules/pg  
total 68  
drwxr-xr-x 9 root root 4096 Apr 26 22:34 .  
drwxr-xr-x 3 root root 4096 Apr 26 22:34 ..  
drwxr-xr-x 2 root root 4096 Apr 26 22:34 benchmark  
drwxr-xr-x 4 root root 4096 Apr 26 22:34 build  
drwxr-xr-x 3 root root 4096 Apr 26 22:34 lib  
-rw-r--r-- 1 root root 5618 Apr 26 22:34 .lock-wscript  
-rw-r--r-- 1 root root 1269 Feb 23 23:58 Makefile  
drwxr-xr-x 3 root root 4096 Apr 26 22:34 node_modules  
-rw-r--r-- 1 root root   21 Mar  3 15:19 .npmignore  
-rw-r--r-- 1 root root  962 Apr 26 22:34 package.json  
-rw-r--r-- 1 root root 6843 Mar 27 09:30 README.md  
drwxr-xr-x 2 root root 4096 Apr 26 22:34 script  
drwxr-xr-x 2 root root 4096 Mar 21 23:37 src  
drwxr-xr-x 5 root root 4096 Apr 26 22:34 test  
-rw-r--r-- 1 root root  990 Feb 23 23:58 wscript  
[root@237175-web2 ~]# 
```

* * *

一个小小的“Hello world” node.js 示例运行良好（万岁！），但是一个简单的 Postgres 示例在`require('pg')`声明中失败，说找不到模块。我查看了服务器，在任何地方都找不到`pg.js`文件。

关于为什么 node-postgres 构建失败的任何线索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:52:32.397

全局安装：

```
npm install -g pg 
```

您可能需要成为 root，例如

```
sudo npm install -g pg 
```

# linux - apache中区分大小写的url

> ID：10366229
> 
> 赞同：-1
> 
> 时间：2012-04-28T18:11:35.010
> 
> 标签：linux, case-sensitive

有朋友能帮我让我的网址不敏感吗.. 我想让 domain.com/url.ext 就像 domain.com/Url.EXT

记住

```
CheckSpelling on 
```

不管用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-18T06:37:25.113

您可以使用 mod_speling 模块轻松完成，它是标准 apache 发行版的一部分：

CheckSpelling 开启 CheckCaseOnly 开启

重新启动 httpd 后，您可以访问 ABC 作为 Abc 或 abc

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:15:50.347

您可以使用 RewriteMap 并`int:tolower`按照`mod_rewrite`文档中的示例

[http://httpd.apache.org/docs/current/rewrite/rewritemap.html#int](http://httpd.apache.org/docs/current/rewrite/rewritemap.html#int)

# objective-c - Objective-C：如何访问另一个类中对象的属性？

> ID：10366232
> 
> 赞同：0
> 
> 时间：2012-04-28T18:11:44.433
> 
> 标签：objective-c, class

我正在objective-c中创建一个游戏，需要检测两个对象何时与帧相交。

我通常会通过使用检测到这一点

```
if (CGRectIntersectsRect(object1.frame, object2.frame)) {/*do something*/} 
```

我唯一的问题是我为每个对象创建了单独的类文件。我在class1中有object1，在class2中有object2，所以我无法访问class2中的object1。

我尝试将对象作为参数传递，但收到一个强 id 错误，所以我假设不允许传递对象。如何访问 class2 中的 object1.frame？我还是objective-c的新手，所以我会很感激任何建议！提前致谢，如果您需要更多信息，请告诉我。

编辑：很抱歉模棱两可，我不是很清楚。我在 class1.h 中声明了 UIImageView 或“object1”，并在整个 class1.m 文件中使用。

我有另一个类，我在 class2.h 和 class2.m 中声明了另一个 UIImageView“object2”。在 class2.m 文件中的某一时刻，我需要查看 object1 和 object2 是否相交。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:07:48.673

实际上，由于它们都是图像视图，因此它们都不应该真正处理相互交叉的问题。更好的方法是让第三个类与前两个类中的每一个都有连接，负责检测冲突，或者创建一个 C 函数，该函数只接受`UIImageView`符合适当设计的协议的任意两个实例，如果存在是一个碰撞告诉对象来处理它。

```
void checkForCollision(object1, object2) {
    if (CGRectIntersectsRect(object1.frame, object2.frame)) {
        [object1 handleCollisionWith:object2];
        [object2 handleCollisionWith:object1];
    }
} 
```

有了这样的东西，当您以后需要检测涉及第三个或第四个对象的碰撞时，它会让生活变得更轻松。两个对象都需要具有相同的超级视图，否则这将不起作用。

此外，您可以传递对象，但通常通过引用传递。为了让 object1 告诉或询问 object2 任何它必须有一个指向它的指针，反过来同样适用。

# ruby-on-rails - assets:precompile 在不应该的时候尝试编译一个 sass 部分

> ID：10366244
> 
> 赞同：1
> 
> 时间：2012-04-28T18:13:12.413
> 
> 标签：ruby-on-rails, sass, asset-pipeline

知道为什么 Rails 的 assets:precompile 会在我的预编译列表中未列出时尝试编译 sass 部分 _accounts.css.sass 吗？

应用程序.rb

```
config.assets.enabled = true
config.assets.initialize_on_precompile = true

config.assets.precompile += ['*.js', 'controllers/*.js', 'controllers/admin/*.js', 'controllers/shared/*.js', '*.coffee', 'application.css.sass', '*.css', '*.png', '*.jpg', '*.scss.erb'] 
```

_accounts.css.sass 仅包含在 application.css.sass 中，它具有：

```
@import "account" 
```

错误是：

```
Undefined mixin 'column'. (in _account.css.sass) 
```

...因为它使用了指南针，但是 application.css.sass 在导入 _accounts.css.sass 之前导入了指南针，因此部分不需要导入指南针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T20:04:35.910

要预编译的事物列表中的文件名/模式不是指要预编译的事物的文件名。相反，它们指的是预编译的结果，即要求预编译“*.css”意味着预编译任何编译后会生成.css 文件的内容。特别是，像您的 _account 文件这样的 .css.sass 文件将被预编译。

# python - 金字塔：路由模式中的默认值

> ID：10366245
> 
> 赞同：4
> 
> 时间：2012-04-28T18:13:27.477
> 
> 标签：python, url, pyramid, routes

我想知道：
是否有可能在路由配置模式中提供默认值？
例如：我有一个视图显示绑定到数据集的文件（可能很大）列表。我想将视图拆分为页面，每个页面显示 100 个文件。当省略 url 模式中的页面部分时，我希望显示第一页。
所以我想要类似的东西：

```
config.add_route('show_files', '/show_files/{datasetid}/{page=1}) 
```

是这样，还是通过合理的努力可行的替代方案？我在金字塔文档的路由语法描述中没有找到任何内容。

非常感谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-28T21:52:07.257

您可能对[这个答案](https://stackoverflow.com/a/10366325/)感到满意，但另一种选择是使用多条路由分派到同一个视图。

```
config.add_route('show_files', '/show_files/{datasetid}')
config.add_route('show_files:page', '/show_files/{datasetid}/{page}')

@view_config(route_name='show_files')
@view_config(route_name='show_files:page')
def show_files_view(request):
    page = request.matchdict.get('page', '1') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:22:31.947

不，但您可以使用余数匹配使页面成为可选页面，然后决定在您的实际逻辑中显示哪个页面。

[http://readthedocs.org/docs/pyramid/en/master/narr/urldispatch.html](http://readthedocs.org/docs/pyramid/en/master/narr/urldispatch.html)

另一种选择是让您的页面简单地成为 GET 变量而不是 URL 的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-29T13:48:59.467

设置它的一种（hacky）方法是使用[自定义谓词](https://pyramid.readthedocs.org/en/master/narr/urldispatch.html#custom-route-predicates)。明确允许更改 matchdict。

```
def matchdict_default(**kw):
    def f(info, request):
        for k, v in kw.iteritems():
            info['match'].setdefault(k, v)
        return True
    return f

config.add_route(
    'show_files', 
    '/show_files/{datasetid}/{page}')
config.add_route(
    'show_files', 
    '/show_files/{datasetid}', 
    custom_predicates=(matchdict_default(page=1),)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-14T21:38:07.753

我无法让 Thomas Jungs 的例子起作用。我能够通过在不使用 iteritems() 的情况下迭代密钥来获得 Thomas Jung 的示例。

```
def matchdict_default(**kw):
def f(info, request):
    for k in kw:
        info['match'].setdefault(k, kw[k])
    return True
return f

config.add_route(
'show_files', 
'/show_files/{datasetid}/{page}')
config.add_route(
'show_files', 
'/show_files/{datasetid}', 
custom_predicates=(matchdict_default(page=1),))`

now both of the following urls resolve to the page value, and, urls
can be created without needing to include a query
parameter

/show_files/an_id/
/show_files/an_id/?page=1 
```

# python-2.7 - 无法在 Komodo 中运行 Python 'Hello World'

> ID：10366254
> 
> 赞同：1
> 
> 时间：2012-04-28T18:14:13.513
> 
> 标签：python-2.7, komodo

我有 Python 2.7.2（64 位）和 Komodo IDE 7.0。

当我尝试在 Komodo 中运行 Hello World 或示例或空文件时，我收到以下错误：

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xd1 in position 277: ordinal not in range(128) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T12:56:05.770

使用[Komodo 状态栏](http://docs.activestate.com/komodo/7.0/workspace.html#Status_Bar)或[python 源](https://stackoverflow.com/questions/9822655/python-unicode-write-to-file-crashes-in-command-line-but-not-in-ide)指定字符编码，而不是默认的 ASCII。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-02T12:10:38.947

您的 ActiveState Komodo 安装是全新的吗？

我在使用 Komodo 8.5 时遇到过这种错误消息。就我而言，问题是

*   前段时间，此安装与用波兰字符 Windows-1250 编码编写的程序一起使用，并且在文件夹名称中使用了相同的编码
*   最近，我在所有程序中都改用 UTF-8，而不是在路径中使用波兰语专用字符
*   Komodo 记得旧的断点，甚至脚本和它们的路径都不存在了
*   Komodo 在启动任何新脚本时失败，试图恢复旧的、不存在的脚本的旧断点。

补救措施非常简单 - 删除旧的断点。

# c# - System.Threading 睡眠功能有帮助吗？（C＃）

> ID：10366255
> 
> 赞同：3
> 
> 时间：2012-04-28T18:14:21.923
> 
> 标签：c#, .net, multithreading, sleep, playstation

我是 C# 的新手，我正在使用 System.Threading。

我有这个代码：

```
UISystem.SetScene(Scene_Menu);
Thread.Sleep (9000);
p.Text="HELLO";
Thread.Sleep(9000);
p.Text="WORLD"; 
```

它延迟 18 秒，但`p.Text="HELLO"`在睡眠功能之间不显示。我的代码有什么问题？

谢谢。

计时器不起作用，因为我无法从单独的线程编辑 p 。

Application.DoEvents() 是一个 Windows 窗体函数，我正在 PS Vita 中构建一个应用程序。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-28T19:16:52.027

您已经发现了为什么**永远不应该使用 Thread.Sleep**。它仅对两件事有用。(1) 编写需要模拟线程忙碌一定秒数的测试用例，以及 (2) 休眠 0 毫秒告诉操作系统“如果存在一个想要”；这是礼貌的事情。

由于您发现的原因，您永远不应该使用 thread.Sleep 来引入延迟。您正在设置一个属性，但*设置一个属性不会导致操作系统重新绘制屏幕*。考虑是否这样做；您可能在一个方法中有一千个属性集，并且您必须在所有属性集之后重新绘制屏幕，​​这看起来很难看并且非常慢。

取而代之的是设置了属性，并且对象向操作系统记录了*该线程何时可用于再次处理操作系统消息，请重新绘制我*。您的程序不是告诉操作系统“我完成了，继续看看是否有任何消息给我”，而是您希望线程在 9 秒内什么都不做。

现在，您可以通过调用 DoEvents 告诉程序检查消息，但**使用 DoEvents 也是一个坏主意，您不应该这样做**。这样做本质上会导致您的程序表现出注意力缺陷障碍的症状；你还没有完成*当前*的工作，你正在寻找是否有*新的工作要做*而不从调用堆栈中删除旧的工作！假设这些新工作依次被打断，以此类推。堆栈无限制地增长，这是非常糟糕的。DoEvents 是一种“最糟糕的做法”，就像休眠线程一样。你可以在简单的小程序中摆脱它，但是当程序变得复杂时它会导致大麻烦。

此外：是的，DoEvents 将绘制您的控件，但仅*此*而已。在接下来的 9 秒内，应用程序将在用户看来完全挂起。这是非常糟糕的用户体验。

如果要引入延迟，正确的做法是*异步等待*。在 C# 4 和更早的版本中，执行此操作的标准方法是创建一个计时器，当计时器计时，执行下一件事。

现在，您说您不能使用计时器，因为您需要从 UI 线程访问控件。没关系。**计时器的滴答事件处理程序将在 UI 线程上运行，而不是在单独的线程上。**您可以安全地使用计时器。

在 C# 5 中，正确的做法是使用 new`await`关键字来引入*异步等待*。也就是说，等待在等待时*执行其他操作*，而不是在等待时*进入睡眠状态*。在 C# 5 中，您可以将代码编写为：

```
UISystem.SetScene(Scene_Menu); 
await Task.Delay (9000); 
p.Text="HELLO"; 
await Task.Delay(9000); 
p.Text="WORLD"; 
```

C# 5 目前处于测试阶段；有关此新功能的详细信息，请参阅：

[http://msdn.microsoft.com/en-us/async](http://msdn.microsoft.com/en-us/async)

有关异步的简要介绍以及 DoEvents 为何是坏消息的解释，请参阅我的 MSDN 杂志文章：

[http://msdn.microsoft.com/en-us/magazine/hh456401.aspx](http://msdn.microsoft.com/en-us/magazine/hh456401.aspx)

# ios - IOS内存泄漏分析

> ID：10366261
> 
> 赞同：0
> 
> 时间：2012-04-28T18:15:05.447
> 
> 标签：ios, memory-leaks

我在我的应用程序中添加了以下代码：

```
AVAudioSession *audioSession = [AVAudioSession sharedInstance];

NSError *setCategoryError = nil;
BOOL success = [audioSession setCategory:AVAudioSessionCategoryPlayback error:&setCategoryError]; 
```

在添加此代码之前，我在运行 xCode Instruments Leaks 工具时没有发现任何泄漏。添加此代码后，我得到了泄漏：泄漏对象：_NSCFString，地址：0x5572e0，大小：32 字节，负责库：AudioToolBox，负责帧：AudioSessionGetProperty。

代码行是从 IOS 库示例代码中提取的。关于什么是错的以及我需要做什么来解决它的任何建议？

谢谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:30:19.630

您发布的代码中没有泄漏。不过，Apple 框架中*可能*存在漏洞，但您无能为力。很可能，这是 Leaks 仪器报告的误报。

# c++ - 在 JNI 中，是否有清理 AttachCurrentThread() 返回的 JNIEnv 指针的函数？

> ID：10366262
> 
> 赞同：4
> 
> 时间：2012-04-28T18:15:05.907
> 
> 标签：c++, java-native-interface

我想知道`JNIEnv *`从 JNI 函数获得的生命周期`AttachCurrentThread()`。考虑以下检索`JNIEnv`指针的函数。

```
JNIEnv * RetrieveJniEnvPtr()
{
    JavaVM * pJavaVM; // Assume pJavaVM is already initialized
    JNIEnv * pEnv = NULL;
    if(pJavaVM->GetEnv((void**)&pEnv, JNI_VERSION_1_6) != JNI_OK)
    {
        pJavaVM->AttachCurrentThread((void**) &pEnv, NULL);
    }
    return pEnv;
} 
```

是否有与调用相关的清理调用`AttachCurrentThread()`？

另外，这是一个轻量级的功能吗？`RetrieveJniEnvPtr()`在同一个线程中多次调用（在这个例子中）是标准的编程实践- 还是代码应该只`JNIEnv *`在线程的生命周期内检索一次？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T10:09:59.127

清理功能是`DetachCurrentThread()`。您需要构造您的代码，以便您*知道*您是否在现有的 Java 线程中，在这种情况下，您已经将`JNIEnv*`传递到您的 JNI 方法中，或者您在自己设计的本机线程中，在这种情况下，您必须`AttachCurrentThread()`在任何其他 JNI 调用之前和`DetachCurrentThread()`之后调用。不要试图逃避这个要求。

# iphone - Objective C AES CBC 加密与零填充

> ID：10366268
> 
> 赞同：0
> 
> 时间：2012-04-28T18:15:50.097
> 
> 标签：iphone, objective-c, ios, aes, cbc-mode

我正在尝试使用 CBC 模式和零填充来使用 AES 128 加密来加密字符串。可悲的是，我不知道该怎么做，因为许多尝试都没有成功。我有 C# 代码，想知道是否有人可以帮助我让我的加密工作。编码：

```
`using System;
using System.Security.Cryptography;
using System.Text;
using System.IO;

byte[] request = UTF8Encoding.UTF8.GetBytes("{string which needs encrypting}");

byte[] key = UTF8Encoding.UTF8.GetBytes("{key}");
byte[] iv = UTF8Encoding.UTF8.GetBytes("{iv}");

AesCryptoServiceProvider aes = new AesCryptoServiceProvider();

aes.Key = key;
aes.IV = iv;

aes.Mode = CipherMode.CBC;

aes.Padding = PaddingMode.Zeros;

ICryptoTransform cTransform = aes.CreateEncryptor();

byte[] result = cTransform.TransformFinalBlock(request, 0, request.Length);

aes.Clear()

string encryptedRequest = Convert.ToBase64String(result, 0, result.Length);` 
```

我看起来是一个普通的加密货币，但我看不到 CBC 模式的选项[我不太了解 cccrypto，也许我忽略了？] 谢谢；

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:53:52.273

[Common Crypto](https://developer.apple.com/library/ios/#documentation/System/Conceptual/ManPages_iPhoneOS/man3/CCCryptorCreate.3cc.html)是正确的地方。具体来说，要使用CCCryptorCreate的第三个参数，即CCOptions设置为0。即默认为CBC。您应该打开 CommonCrypto.h，因为它实际上是比手册页更好的文档。以下是如何执行此操作的示例：

```
CCCryptorRef cryptorRef;
CCCryptorStatus rc;
rc = CCCryptorCreate(kCCEncrypt, kCCAlgorithmAES128, 0, key, keySize, NULL, &cryptorRef); 
```

我为 IV 传递了 NULL（这意味着全为零），并假设您正确设置了密钥和密钥大小。在我的测试中，我使用了一个 32 字节（256 位）的密钥。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T19:04:44.620

方法在`CommonCrypto.m`

```
- (NSData *) dataEncryptedUsingAlgorithm: (CCAlgorithm) algorithm
                                 key: (id) key
                initializationVector: (id) iv
                             options: (CCOptions) options
                               error: (CCCryptorStatus *) error 
```

iv 参数声明

> ```
> @param      iv              Initialization vector, optional. Used for 
>                             Cipher Block Chaining (CBC) mode. If present, 
>                             must be the same length as the selected 
>                             algorithm's block size. If CBC mode is
>                             selected (by the absence of any mode bits in 
>                             the options flags) and no IV is present, a 
>                             NULL (all zeroes) IV will be used. This is 
>                             ignored if ECB mode is used or if a stream 
>                             cipher algorithm is selected. 
> ```

所以，你可以将`nil`值传递给`iv`参数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T18:50:12.693

看看下面的链接。

[AES1](https://github.com/dev5tec/FBEncryptor) [AES2](https://github.com/rnapier/RNCryptor) [AES3](https://github.com/Amnysia/Encryption-AES-Category)

如果您发现其中任何一个对您有用，您可以从那里下载源代码库并在您的项目中使用它。

# linux - 用shell获取父PID？

> ID：10366272
> 
> 赞同：2
> 
> 时间：2012-04-28T18:16:23.683
> 
> 标签：linux, shell, process

我想要一个 cron 作业来设置某些服务的优先级，但是，父级以 root 身份运行，其余的以另一个用户身份运行。但是，父进程将使用其优先级 ID 重新生成进程，因此 cron 作业必须运行得比它应该运行的多。有没有办法设置优先级？

我想设置更高的示例：

```
1 S root     13826     1  0  81   0 -  3289 rt_sig 00:33 ?        00:00:00 nginx: master process /usr/local/sbin/nginx -c /etc/nginx/nginx.conf
5 S root     15474     1  0  75   0 -  3848 -      Apr22 ?        00:01:37 /usr/local/apache/bin/httpd -k start -DSSL
5 S nobody   19511 13826  0  75   0 -  3297 -      13:06 ?        00:00:10 nginx: worker process
5 S nobody   19512 13826  0  78   0 -  3361 -      13:06 ?        00:00:11 nginx: worker process
5 S nobody   19513 13826  0  75   0 -  3681 -      13:06 ?        00:00:09 nginx: worker process
5 S nobody   19514 13826  0  78   0 -  3297 -      13:06 ?        00:00:07 nginx: worker process
5 S root     19521 15474  0  77   0 -  3561 -      13:06 ?        00:00:00 /usr/local/apache/bin/httpd -k start -DSSL
5 S nobody   19522 15474  0  78   0 -  3848 431083 13:06 ?        00:00:00 /usr/local/apache/bin/httpd -k start -DSSL
5 S nobody   19523 15474  0  75   0 -  3952 semtim 13:06 ?        00:00:00 /usr/local/apache/bin/httpd -k start -DSSL
5 S nobody   19524 15474  0  75   0 -  3951 semtim 13:06 ?        00:00:00 /usr/local/apache/bin/httpd -k start -DSSL
5 S nobody   19525 15474  0  75   0 -  3949 semtim 13:06 ?        00:00:00 /usr/local/apache/bin/httpd -k start -DSSL
5 S nobody   19526 15474  0  78   0 -  3947 -      13:06 ?        00:00:00 /usr/local/apache/bin/httpd -k start -DSSL
5 S nobody   19527 15474  0  78   0 -  3949 semtim 13:06 ?        00:00:00 /usr/local/apache/bin/httpd -k start -DSSL 
```

我知道有[http://www.rfxn.com/projects/system-priority/](http://www.rfxn.com/projects/system-priority/)但据我所知，只有 UID 才能做到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:27:15.407

问题不是很清楚，您可以通过查看`/proc/18357/stat`将 18357 替换为当前进程的 PID轻松找到父 PID

父 PID 是其中的第四个参数

# ios - captureOutput:didFinishRecordingToOutputFileAtURL:fromConnections:error 没有被调用

> ID：10366275
> 
> 赞同：1
> 
> 时间：2012-04-28T18:16:58.847
> 
> 标签：ios, avcapturesession, avcam

我正在为 ios 4+ 编写视频捕捉应用程序。它在 ios 5+ 的设备上运行良好，但在 ios 4+ 中，在录制停止后不会调用委托 didFinishRecordingToOutputFileAtURL。我检查了苹果的参考资料，上面写着“这个方法总是为每个记录请求调用，即使没有数据成功写入文件。”

[https://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVCaptureFileOutputRecordingDelegate_Protocol/Reference/Reference.html](https://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVCaptureFileOutputRecordingDelegate_Protocol/Reference/Reference.html)

有什么建议么 ？

这是完整的代码：

/

```
/
//  HomeViewController.m
//  MyAgingBooth
//
//  Created by Mahmud on 29/10/11.
//  Copyright 2011 __MyCompanyName__. All rights reserved.
//

#import "HomeViewController.h"
#import "Globals.h"
#import <MobileCoreServices/MobileCoreServices.h>
#import <MediaPlayer/MPMoviePlayerController.h>
#import "SharedData.h"
#import "ResultViewController.h"

@implementation HomeViewController

@synthesize BtnFromCamera, PreviewLayer;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization

        isPlaying=NO;
        playerScore=0;
        playerTurn=0;
    }
    return self;
}

- (void)dealloc
{
    //[levelTimer release];
    [super dealloc];
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.navigationController.navigationBar.barStyle = UIBarStyleBlackTranslucent; 
    playerName.text=[NSString stringWithFormat: @"Player %d", (playerTurn+1)];
    //add a right bar button item proceed to next.
    UIBarButtonItem *proceedButton = [[UIBarButtonItem alloc] initWithTitle:@"Proceed" style:UIBarButtonItemStylePlain target:self action:@selector(proceedToNext)];
    //[proceedButton setImage:[UIImage imageNamed:@"info.png"]];
    self.navigationItem.rightBarButtonItem=proceedButton;
    [proceedButton release];
    [BtnFromCamera setTitle:@"Start" forState:UIControlStateNormal];

    //[self.BtnFromCamera setImage:camera forState:UIControlStateNormal];
    //[self.BtnFromCamera setImage:camera forState:UIControlStateSelected];

    NSArray *words=[NSArray arrayWithObjects:@"SAY: Girls",@"SAY: Shut up", @"SAY: Tiger",@"SAY: Absurd",@"SAY: Tonight", @"SAY: Amstardam", nil];
    [word setText:[words objectAtIndex:arc4random()%6]];

    [self initCaptureSession];
}

-(void) proceedToNext
{
    self.title=@"Back";
    ResultViewController *resultViewController= [[ResultViewController alloc] initWithNibName:@"ResultViewController" bundle:nil];
    [self.navigationController pushViewController:resultViewController animated:YES];
    [resultViewController release];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

//Action handlers for the buttons

// take snap with camera

-(void) initCaptureSession
{
    NSLog(@"Setting up capture session");
    CaptureSession = [[AVCaptureSession alloc] init];

    //----- ADD INPUTS -----
    NSLog(@"Adding video input");

    //ADD VIDEO INPUT
    AVCaptureDevice *VideoDevice =  [self frontFacingCameraIfAvailable ];

    //[AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    if (VideoDevice)
    {
        NSError *error;
        VideoInputDevice = [AVCaptureDeviceInput deviceInputWithDevice:VideoDevice error:&error];
        if (!error)
        {
            if ([CaptureSession canAddInput:VideoInputDevice])
                [CaptureSession addInput:VideoInputDevice];
            else
                NSLog(@"Couldn't add video input");
        }
        else
        {
            NSLog(@"Couldn't create video input");
        }
    }
    else
    {
        NSLog(@"Couldn't create video capture device");
    }

    //ADD AUDIO INPUT
    NSLog(@"Adding audio input");
    AVCaptureDevice *audioCaptureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeAudio];
    NSError *error = nil;
    AVCaptureDeviceInput *audioInput = [AVCaptureDeviceInput deviceInputWithDevice:audioCaptureDevice error:&error];
    if (audioInput)
    {
        [CaptureSession addInput:audioInput];
    }

    //----- ADD OUTPUTS -----

    //ADD VIDEO PREVIEW LAYER
    NSLog(@"Adding video preview layer");
    [self setPreviewLayer:[[[AVCaptureVideoPreviewLayer alloc] initWithSession:CaptureSession] autorelease]];

    PreviewLayer.orientation = AVCaptureVideoOrientationPortrait;       //<<SET ORIENTATION.  You can deliberatly set this wrong to flip the image and may actually need to set it wrong to get the right image

    [[self PreviewLayer] setVideoGravity:AVLayerVideoGravityResizeAspectFill];

    //ADD MOVIE FILE OUTPUT
    NSLog(@"Adding movie file output");
    MovieFileOutput = [[AVCaptureMovieFileOutput alloc] init];

    Float64 TotalSeconds = 60;          //Total seconds
    int32_t preferredTimeScale = 30;    //Frames per second
    CMTime maxDuration = CMTimeMakeWithSeconds(TotalSeconds, preferredTimeScale);   //<<SET MAX DURATION
    MovieFileOutput.maxRecordedDuration = maxDuration;

    MovieFileOutput.minFreeDiskSpaceLimit = 1024 * 1024;    //<<SET MIN FREE SPACE IN BYTES FOR RECORDING TO CONTINUE ON A VOLUME

    if ([CaptureSession canAddOutput:MovieFileOutput])
        [CaptureSession addOutput:MovieFileOutput];

    AudioOutput = [[AVCaptureAudioDataOutput alloc] init];
    if([CaptureSession canAddOutput:AudioOutput])
    {
        [CaptureSession addOutput:AudioOutput];
        NSLog(@"AudioOutput addedd");
    }

    //SET THE CONNECTION PROPERTIES (output properties)
    [self CameraSetOutputProperties];           //(We call a method as it also has to be done after changing camera)

    //----- SET THE IMAGE QUALITY / RESOLUTION -----
    //Options:
    //  AVCaptureSessionPresetHigh - Highest recording quality (varies per device)
    //  AVCaptureSessionPresetMedium - Suitable for WiFi sharing (actual values may change)
    //  AVCaptureSessionPresetLow - Suitable for 3G sharing (actual values may change)
    //  AVCaptureSessionPreset640x480 - 640x480 VGA (check its supported before setting it)
    //  AVCaptureSessionPreset1280x720 - 1280x720 720p HD (check its supported before setting it)
    //  AVCaptureSessionPresetPhoto - Full photo resolution (not supported for video output)
    NSLog(@"Setting image quality");
    [CaptureSession setSessionPreset:AVCaptureSessionPresetMedium];
    if ([CaptureSession canSetSessionPreset:AVCaptureSessionPreset640x480])     //Check size based configs are supported before setting them
        [CaptureSession setSessionPreset:AVCaptureSessionPreset640x480];

    //----- DISPLAY THE PREVIEW LAYER -----
    //Display it full screen under out view controller existing controls
    NSLog(@"Display the preview layer");
    CGRect layerRect = CGRectMake(10,44,300,290); //[[[self view] layer] bounds];
    [PreviewLayer setBounds:layerRect];
    [PreviewLayer setPosition:CGPointMake(CGRectGetMidX(layerRect),
                                          CGRectGetMidY(layerRect))];
    //[[[self view] layer] addSublayer:[[self CaptureManager] previewLayer]];
    //We use this instead so it goes on a layer behind our UI controls (avoids us having to manually bring each control to the front):
    UIView *CameraView = [[[UIView alloc] init] autorelease];
    [[self view] addSubview:CameraView];
    //[self.view sendSubviewToBack:CameraView];

    [[CameraView layer] addSublayer:PreviewLayer];

    //----- START THE CAPTURE SESSION RUNNING -----
    [CaptureSession startRunning];    
}

//********** CAMERA SET OUTPUT PROPERTIES **********
- (void) CameraSetOutputProperties
{
    AVCaptureConnection *CaptureConnection=nil;
    //SET THE CONNECTION PROPERTIES (output properties)
    NSComparisonResult order = [[UIDevice currentDevice].systemVersion compare: @"5.0.0" options: NSNumericSearch];
    if (order == NSOrderedSame || order == NSOrderedDescending) {
        // OS version >= 5.0.0
        CaptureConnection = [MovieFileOutput connectionWithMediaType:AVMediaTypeVideo];
        if (CaptureConnection.supportsVideoMinFrameDuration)
            CaptureConnection.videoMinFrameDuration = CMTimeMake(1, CAPTURE_FRAMES_PER_SECOND);
        if (CaptureConnection.supportsVideoMaxFrameDuration)
            CaptureConnection.videoMaxFrameDuration = CMTimeMake(1, CAPTURE_FRAMES_PER_SECOND);
        if (CaptureConnection.supportsVideoMinFrameDuration)
        {
            CMTimeShow(CaptureConnection.videoMinFrameDuration);
            CMTimeShow(CaptureConnection.videoMaxFrameDuration);
        }
    } else {
        // OS version < 5.0.0
            CaptureConnection = [self connectionWithMediaType:AVMediaTypeVideo fromConnections:[MovieFileOutput connections]];

    }

    //Set landscape (if required)
    if ([CaptureConnection isVideoOrientationSupported])
    {
        AVCaptureVideoOrientation orientation = AVCaptureVideoOrientationLandscapeRight;        //<<<<<SET VIDEO ORIENTATION IF LANDSCAPE
        [CaptureConnection setVideoOrientation:orientation];
    }

    //Set frame rate (if requried)
    //CMTimeShow(CaptureConnection.videoMinFrameDuration);
    //CMTimeShow(CaptureConnection.videoMaxFrameDuration);

}
- (IBAction) StartVideo
{
    if (!isPlaying) {

        self.navigationItem.rightBarButtonItem.enabled=NO;
        [BtnFromCamera setTitle:@"Stop" forState:UIControlStateNormal];  
        playerName.text=[NSString stringWithFormat:@"Player %d", playerTurn+1];
        playerScore=0;
        count=0;
        isPlaying=YES;

    //Create temporary URL to record to
    NSString *outputPath = [[NSString alloc] initWithFormat:@"%@%@", NSTemporaryDirectory(), @"output.mov"];
    NSURL *outputURL = [[NSURL alloc] initFileURLWithPath:outputPath];
    NSFileManager *fileManager = [NSFileManager defaultManager];
    if ([fileManager fileExistsAtPath:outputPath])
    {
        NSError *error;
        if ([fileManager removeItemAtPath:outputPath error:&error] == NO)
        {
            //Error - handle if requried
            NSLog(@"file remove error");
        }
    }
    [outputPath release];
    //Start recording
    [MovieFileOutput startRecordingToOutputFileURL:outputURL recordingDelegate:self];
    [outputURL release];

        //NSString *DestFilename = @ "output.mov";

        //Set the file save to URL
      /*  NSString *documentsDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
        NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
        [dateFormatter setDateFormat:@"yyyy-MM-dd_HH-mm-ss"];
        NSString *destinationPath = [documentsDirectory stringByAppendingFormat:@"/output_%@.mov", [dateFormatter stringFromDate:[NSDate date]]];
        [dateFormatter release];

        NSURL* saveLocationURL = [[NSURL alloc] initFileURLWithPath:destinationPath];
        [MovieFileOutput startRecordingToOutputFileURL:saveLocationURL recordingDelegate:self];
        [saveLocationURL release];        */

    levelTimer = [NSTimer scheduledTimerWithTimeInterval:0.05 target: self selector: @selector(levelTimerCallback:) userInfo: nil repeats: YES];
    }
    else
    {
        isPlaying=NO;
        NSLog(@"STOP RECORDING");
        [MovieFileOutput stopRecording];
        [levelTimer invalidate];
        [BtnFromCamera setTitle:@"Start" forState:UIControlStateNormal];
                self.navigationItem.rightBarButtonItem.enabled=YES;
    }
}

//********** DID FINISH RECORDING TO OUTPUT FILE AT URL **********/
- (void)captureOutput:(AVCaptureFileOutput *)captureOutput
didFinishRecordingToOutputFileAtURL:(NSURL *)outputFileURL
      fromConnections:(NSArray *)connections
                error:(NSError *)error
{

    NSLog(@"didFinishRecordingToOutputFileAtURL - enter");

    BOOL RecordedSuccessfully = YES;
    if ([error code] != noErr)
    {
        // A problem occurred: Find out if the recording was successful.
        id value = [[error userInfo] objectForKey:AVErrorRecordingSuccessfullyFinishedKey];
        if (value)
        {
            RecordedSuccessfully = [value boolValue];
        }
    }
    if (RecordedSuccessfully)
    {
        //----- RECORDED SUCESSFULLY -----
        NSLog(@"didFinishRecordingToOutputFileAtURL - success");
        ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];
        if ([library videoAtPathIsCompatibleWithSavedPhotosAlbum:outputFileURL])
        {
            [library writeVideoAtPathToSavedPhotosAlbum:outputFileURL
                                        completionBlock:^(NSURL *assetURL, NSError *error)
             {
                 if (error)
                 {
                     NSLog(@"File save error");
                 }
                 else
                 {
                     playerScore=(playerScore/count);
                     NSDictionary *dict = [[NSDictionary alloc] initWithObjectsAndKeys:playerName.text, @"PlayerName", [NSNumber numberWithFloat:playerScore], @"Score", assetURL, @"VideoURL",nil];
                     SharedData *d=[SharedData sharedManager];
                     [d.PlayerStats addObject:dict];

                     [dict release];
                     playerName.text=[NSString stringWithFormat:@"Score %f", playerScore];
                     playerTurn++;
                 }
             }];
        }
        else {

            NSString *assetURL=[self copyFileToDocuments:outputFileURL];
            if(assetURL!=nil)
            {
                playerScore=(playerScore/count);
                NSDictionary *dict = [[NSDictionary alloc] initWithObjectsAndKeys:playerName.text, @"PlayerName", [NSNumber numberWithFloat:playerScore], @"Score",assetURL , @"VideoURL",nil];
                SharedData *d=[SharedData sharedManager];
                [d.PlayerStats addObject:dict];

                [dict release];
                playerName.text=[NSString stringWithFormat:@"Score %f", playerScore];
                playerTurn++;
            }
        }

        [library release];      
    }
}

- (NSString*) copyFileToDocuments:(NSURL *)fileURL
{
    NSString *documentsDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"yyyy-MM-dd_HH-mm-ss"];
    NSString *destinationPath = [documentsDirectory stringByAppendingFormat:@"/output_%@.mov", [dateFormatter stringFromDate:[NSDate date]]];
    [dateFormatter release];
    NSError *error;
    if (![[NSFileManager defaultManager] copyItemAtURL:fileURL toURL:[NSURL fileURLWithPath:destinationPath] error:&error]) {
        NSLog(@"File save error %@", [error localizedDescription]);
        return nil;

    }
    return destinationPath;
}

- (void)levelTimerCallback:(NSTimer *)timer {

    AVCaptureConnection *audioConnection = [self connectionWithMediaType:AVMediaTypeAudio fromConnections:[MovieFileOutput connections]];
    //return [audioConnection isActive];
    for (AVCaptureAudioChannel *channel in audioConnection.audioChannels) {
        float avg = channel.averagePowerLevel;
       // float peak = channel.peakHoldLevel;
        float vol=powf(10, avg)*1000;
        NSLog(@"Power: %f",vol);
        if (isPlaying && vol > 0) {
            playerScore=playerScore+vol;
            count=count+1;
        }
    }       
}

- (AVCaptureConnection *)connectionWithMediaType:(NSString *)mediaType fromConnections:(NSArray *)connections
{
    for ( AVCaptureConnection *connection in connections ) {
        for ( AVCaptureInputPort *port in [connection inputPorts] ) {
            if ( [[port mediaType] isEqual:mediaType] ) {
                return connection;
            }
        }
    }
    return nil;
}

- (AVCaptureDevice *)frontFacingCameraIfAvailable
{
    //  look at all the video devices and get the first one that's on the front
    NSArray *videoDevices = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];
    AVCaptureDevice *captureDevice = nil;
    for (AVCaptureDevice *device in videoDevices)
    {
        if (device.position == AVCaptureDevicePositionFront)
        {
            captureDevice = device;
            break;
        }
    }

    //  couldn't find one on the front, so just get the default video device.
    if ( ! captureDevice)
    {
        captureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    }

    return captureDevice;
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T06:31:40.480

修复了问题。我偶然添加了一个额外的音频输出。删除以下片段对我有用。

```
AudioOutput = [[AVCaptureAudioDataOutput alloc] init];
if([CaptureSession canAddOutput:AudioOutput])
{
    [CaptureSession addOutput:AudioOutput];
    NSLog(@"AudioOutput addedd");
} 
```

# php - 在 cakePHP 中访问使用 beforeSave() 修改的值

> ID：10366276
> 
> 赞同：0
> 
> 时间：2012-04-28T18:17:03.790
> 
> 标签：php, cakephp

我正在使用`beforeSave()`为用户分配一个临时客户编号。我需要将此值返回给访问 API 的设备。是否可以从我的控制器访问它？

```
// app/Model/User.php
<?php
class User extends AppModel {
    function beforeSave($options) {
        $this->data['User']['customerNumber'] = uniqid(); // This is the value I want
        $this->data['User']['password'] = md5($this->data['User']['password']);
    }

    function isUnique() {
        $users = $this->find('all', array('conditions' => array('email' => $this->data['User']['email'])));
        if (empty($users)) {
            return true;
        } else {
            return false;
        }
    }
}
?>

// app/Controller/UserController.php
<?php
class UserController extends AppController {
    public $components = array('RequestHandler');

    public function register() {
        if ($this->request->is('post')) {
            $this->User->set($this->data);
            if ($this->User->isUnique()) {
                if ($this->User->save($this->data)) {
                    // This is where I need to return the customer number
                    echo json_encode(array('status' => 'User registered', 'customerNumber' => $this->data['customerNumber']));
                } else {
                    echo json_encode(array('status' => 'User could not be registered'));
                }
            } else {
                echo json_encode(array('status' => 'user is duplicate'));
            }
        } else {
            echo json_encode(array('error' => 'Requests must be made using HTTP POST'));
        }
    }
}
?> 
```

作为次要问题，`uniqid()`分配临时客户编号是否可行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T20:25:21.640

您无法直接获取该值，但您可以在成功保存后立即获取它，例如：

```
if ($this->User->save($this->data)) {
    // Fetch inserted row
    $user = $this->User->findById($this->User->getInsertId());
    echo json_encode(array(
        'status' => 'User registered',
        'customerNumber' => $user['User']['customerNumber']
    ));
} 
```

# php - 如何附加上传的文件名？

> ID：10366277
> 
> 赞同：0
> 
> 时间：2012-04-28T18:17:10.563
> 
> 标签：php, javascript, json

我在附加 imageNameArray 时遇到问题，它应该显示已上传的文件名。

问题是，假设我之前上传了 3 个文件（cat.png、dog.png 和 pig.png），当我刷新页面并上传另一个文件（panda.png）时，当我上传文件时，它应该显示'熊猫.png'。但它只是附加了之前上传的文件的名称（pig.png），而不是附加 panda.png。

它显示：

```
pig.png 
```

它应该是：

```
panda.png 
```

如果我上传另一个文件（不刷新页面），例如monkey.png，那么它会再次附加pig.png。没有猴子.png。

它显示：

```
pig.png
pig.png 
```

它应该是：

```
 panda.png
 monkey.png 
```

如何修复下面的代码，以便它像上面一样附加文件名？

下面是发生附加的 javascript 代码：

```
 <?php
    session_start();

    $idx = count($_POST ['fileImage']) -1 ;
    $output = isset($_POST ['fileImage'][$idx]) ? $_SESSION ['fileImage'][$idx]['name'] : "";

    ?>

              function stopImageUpload(success){

              var imageNameArray = ['<?php echo $output ?>'];
              var result = '';

              if (success == 1){
                 result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';

                    for(var i=0;i<imageNameArray.length;i++)
            {
                 $('.listImage').append(imageNameArray[i]+ '<br/>');

             }

              }
              else {
                 result = '<span class="emsg">There was an error during file upload!</span><br/><br/>';
              }

        return true;

        } 
```

下面是 php 脚本，它从上面的 javascript 函数上传另一个页面上的文件：

```
 <?php

            session_start();

            $result = 0;
            $errors = array ();
            $dirImage = "ImageFiles/";

        if (isset ( $_FILES ['fileImage'] ) && $_FILES ["fileImage"] ["error"] == UPLOAD_ERR_OK) {

        $fileName = $_FILES ['fileImage'] ['name'];

        $fileExt = pathinfo ( $fileName, PATHINFO_EXTENSION );
        $fileExt = strtolower ( $fileExt );

        $fileDst = $dirImage . DIRECTORY_SEPARATOR . $fileName;

                if (count ( $errors ) == 0) {
                    if (move_uploaded_file ( $fileTemp, $fileDst )) {
                        $result = 1;

                    }
                }

            }

    $_POST ['fileImage'][] = array('name' => $_FILES ['fileImage']['name']);

            ?>

        <script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php echo $result;?>);</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:39:54.893

你为什么使用会话？尝试添加 session_destroy(); 在第二个脚本和第一个脚本的末尾。我认为它应该删除所有 previos 数据，然后您就会知道更多问题所在。

# c - 如何确定 C 中数组的大小？

> ID：10366284
> 
> 赞同：-3
> 
> 时间：2012-04-28T18:17:40.323
> 
> 标签：c, arrays, sizeof

> **可能重复：**
> [如何找到 sizeof（指向数组的指针）](https://stackoverflow.com/questions/492384/how-to-find-the-sizeofa-pointer-pointing-to-an-array)

我试过这段代码：

```
#include<stdio.h>

int dime(int v[]){
    int i= sizeof v / sizeof *v;
    return i;
}

int main() {
    int v[10]={1,2,3,4,5,6,7,8,9,0};
    int i= dime(v);
    printf("The size of v is %d\n",i);
    return 0;
} 
```

它给我的大小是 1，我也尝试将 *v 更改为 v[0] 并没有解决问题......有人可以帮忙吗？

BTW 不知道它是否有用（也许只是为了知道整数的大小），但我在 Ubuntu 32 位虚拟机中运行 Eclipse。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:20:11.153

编译器在作为指针传递时不知道数组大小，只有在作为数组显式传递时才知道。这会起作用：

```
int main() {
    int v[10]={1,2,3,4,5,6,7,8,9,0};
    int i = sizeof(v) / sizeof(*v);
    printf("The size of v is %d\n",i);
    return 0;
} 
```

# c# - C# 表单 - 获取两个日期之间的时间

> ID：10366288
> 
> 赞同：0
> 
> 时间：2012-04-28T18:18:10.460
> 
> 标签：c#, string, date, datediff

我试图找到两个日期之间的时间，一个是当天（今天），另一个是用户定义的截止日期。

我正在使用 C# Windows 窗体，我使用了“日期时间选择器”，以便用户可以选择截止日期，我创建了一个名为 Today 的字符串并使用

```
string Today = System.DateTime.Today.ToString("dd-mm-yyyy"); 
```

作为当前日期。但我不知道如何找到这两点之间的时间长度（因为它们是字符串），我的程序是一个简单的“待办事项列表”，其中任务持续时间以天和周为单位（“yyyy”只是出于美学目的，必要时可以将其移除）。

我查看了互联网，我似乎只能找到如何使用“DateTime”而不是字符串来执行此操作（或者我错过了什么？）。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T18:22:27.963

使用 DateTimePicker 的“Value”属性获取 DateTime 值并使用 DateTime.Now 获取当前时间的 DateTime 值（在本地时区中）。

如果您只是减去日期（没有时间分量），请在减去之前访问两个 DateTime 对象的 Date 属性。

```
 DateTime userDate = dateTimePicker.Value.Date;
 DateTime currentDate = DateTime.Now.Date;
 TimeSpan difference = userDate.Subtract(currentDate);  //assuming deadline is in the future 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T18:20:37.347

不要使用两个字符串 - 使用实际`DateTime`实例。字符串不能也不能“理解”日期——这就是`DateTime`对象存在的原因。

当您将两个日期相减时，您会得到一个`TimeSpan`实例。这为您提供了时间差量。

```
TimeSpan difference = date1 - date2; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T18:23:49.147

我猜您正在寻找以下内容：

Date1.Subtract(Date2).TotalTime

以下链接将帮助您了解更多 [http://www.c-sharpcorner.com/UploadFile/DipalChoksi/DateDiff_CS_DC09132006172429PM/DateDiff_CS_DC.aspx](http://www.c-sharpcorner.com/UploadFile/DipalChoksi/DateDiff_CS_DC09132006172429PM/DateDiff_CS_DC.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T18:25:03.867

AS Oded 提到字符串不是最好的方法。DateTimes 不能相互减去，并给您一个[TimeSpan](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)，它代表一个时间跨度。

这是一个应该澄清事情的 MSDN 示例。

```
DateTime departure = new DateTime(2010, 6, 12, 18, 32, 0);
DateTime arrival = new DateTime(2010, 6, 13, 22, 47, 0);
TimeSpan travelTime = arrival - departure;  
Console.WriteLine("{0} - {1} = {2}", arrival, departure, travelTime);      
// The example displays the following output:
//       6/13/2010 10:47:00 PM - 6/12/2010 6:32:00 PM = 1.04:15:00 
```

# html - 如何防止css继承？

> ID：10366297
> 
> 赞同：2
> 
> 时间：2012-04-28T18:19:09.890
> 
> 标签：html, css

当您在 css 类中添加样式时，CSS 有什么令人讨厌的地方，它可能会自行应用其他元素/类。

防止这种情况的最佳方法是什么？

例如：

HTML：

```
<div class='main-content'>
    <p> Hello World </p> 
    <span> Test One </span>
    <div class='column'>
        <span> Test Two</span>
    </div> 
</div> 
```

CSS：

```
.main-content span {
    background: #921192;
    color: white;
    padding: 3px 4px;
    margin: 0 5px;
}

.column  span {
    font-size:20px;
    text-transform:none;
    display:inline-block;
}​ 
```

我不希望“测试二”`<span>`有背景颜色。

测试：http: [//jsfiddle.net/szm9c/1/](http://jsfiddle.net/szm9c/1/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T18:20:48.743

使用实际选择所需元素的选择器。在这种情况下`>`，[子选择器](http://www.w3.org/TR/CSS2/selector.html#child-selectors)就足够了。

```
.main-content > span {
    background: #921192;
    color: white;
    padding: 3px 4px;
    margin: 0 5px;
} 
```

[http://jsfiddle.net/mattball/mQFz2/](http://jsfiddle.net/mattball/mQFz2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:21:10.653

使用`.main-content > span`, 仅选择直接后代元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T18:28:13.257

这与继承无关。

要正确使用 CSS，请使用仅匹配您希望影响的元素的选择器为元素分配属性。（给出的例子对于有用的分析和关于更好方法的建设性建议来说太人为了。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T18:23:45.670

你可以用这个

```
.main-content > span {
background: #921192;
color: white;
padding: 3px 4px;
margin: 0 5px;
} 
```

如果你使用`.main-content > span`这种风格只会影响班级的`immediate child`跨度`.main-content`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-07T11:18:27.147

只需在您的根元素处使用 all: initial 。

```
.selector 
{
    all: initial;
} 
```

# asp.net-mvc-3 - 当前上下文中不存在名称“FormMethod”

> ID：10366304
> 
> 赞同：2
> 
> 时间：2012-04-28T18:20:02.900
> 
> 标签：asp.net-mvc-3, razor

突然之间，我开始收到 Razor 错误：

当前上下文中不存在名称“FormMethod”当前上下文中不存在名称“模型”

但是，当我编译它们时它们消失并且应用程序运行良好，但我无法使用智能感知。

# uiimage - 截取 MKMapView 的截图

> ID：10366311
> 
> 赞同：1
> 
> 时间：2012-04-28T18:20:58.980
> 
> 标签：uiimage, mkmapview, screenshot

我正在尝试获取 MKMapView 的屏幕截图。

我正在使用以下代码：

```
UIGraphicsBeginImageContext(myMapView.frame.size);

[myMapView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *screenShot=UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

return screenShot; 
```

而且我得到了几乎空白的图像，其中包含地图当前位置图标和 Google 徽标。

可能是什么原因造成的？

我应该告诉你，myMapView 实际上是在另一个 viewController 的视图上，但是由于我得到了显示位置和谷歌徽标的蓝点，我认为我拥有的参考是正确的。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-17T12:41:44.097

iOS 7 引入了一种新方法来生成 MKMapView 的屏幕截图。现在可以使用新的 MKMapSnapshot API，如下所示：

```
MKMapView *mapView = [..your mapview..]

MKMapSnapshotOptions *options = [[MKMapSnapshotOptions alloc]init];
options.region = mapView.region;
options.mapType = MKMapTypeStandard;
options.showsBuildings = NO;
options.showsPointsOfInterest = NO;
options.size = CGSizeMake(1000, 500);

MKMapSnapshotter *snapshotter = [[MKMapSnapshotter alloc]initWithOptions:options];
[snapshotter startWithQueue:dispatch_get_main_queue() completionHandler:^(MKMapSnapshot *snapshot, NSError *error) {
    if( error ) {
        NSLog( @"An error occurred: %@", error );
    } else {
       [UIImagePNGRepresentation( snapshot.image ) writeToFile:@"/Users/<yourAccountName>/map.png" atomically:YES];
    }
}]; 
```

目前所有的叠加层和注释都不会被渲染。之后您必须自己将它们渲染到生成的快照图像上。提供的 MKMapSnapshot 对象有一个方便的辅助方法来进行坐标和点之间的映射：

```
CGPoint point = [snapshot pointForCoordinate:locationCoordinate2D]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T14:14:12.407

[正如这里](https://stackoverflow.com/questions/4219496/rendering-mkmapview-to-uiimage-with-real-resolution/4219721#4219721)提到的，你可以试试这个

```
- (UIImage*) renderToImage
{
   UIGraphicsBeginImageContextWithOptions(self.frame.size, NO, 0.0);
   [self.layer renderInContext:UIGraphicsGetCurrentContext()];
  UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
  UIGraphicsEndImageContext(); 
  return image;
} 
```

# python - 生成 k 个大多数子集唯一的元素对

> ID：10366313
> 
> 赞同：4
> 
> 时间：2012-04-28T18:21:09.730
> 
> 标签：python, math, parallel-processing, combinatorics, discrete-mathematics

我正在编写一个 Cuda 应用程序，它应该在我的集合 S 的两个元素上计算一个函数。但是这对的顺序没有任何区别，所以：`f(a,b)`=`f(b,a)`

出于这个原因，我想生成最大大小为 K 的 S 的所有子集，而不会在集合之间复制元素对。

换句话说，给定任何两个子集，我不希望它们的交集大于一个元素。（这样我可以避免多次计算这两个元素的函数）

例子：

给定`S={1,2,3,4,5,6,7,8,9}`and `K=3`，输出应该是这样的：

```
{ {1,2,3}, {1,4,5}, {1,6,7}, {1,8,9}, {2,4,6}, {2,5,7}, {2,8}, {2,7,9}, {3,4,7},
  {3,5,8}, {3,6,9}, {4,5,9} } 
```

但输出不应如下所示：

```
{ {1,2,3}, {1,4,5}, {1,6,7}, {1,8,9}, {2,4,6}, {2,5,7}, {2,6,8}, {2,7,9}, {3,4,7},
  {3,5,8}, {3,6,9}, {4,5,9} } 
```

因为 和 的`{2,4,6}`交集`{2,6,8}`是`{2,6}`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:18:33.303

我将发布一个非答案，希望它可以帮助我们确定问题：我在下面回答的问题是

> 给定一个集合 S，生成 S 的所有子集的最大基数集，使得每个子集都小于大小 K，并且没有两个子集包含基数 > 1 的交集

如果我们固定您想要的子集的大小（k=3 而不是 k<=3），这很容易以一种非有效的方式进行：

1.  从 S 生成所有大小为 k 的子集
2.  继续移除东西，直到没有交叉点存在

一些问题由此而来

1.  有没有更有效的方法来做到这一点
2.  不固定 k**会**改变这个解决方案，总是采用最大尺寸的子集是最优的吗
3.  是否存在一个最优集合，以便我们可以选择一个大小 t<=k 并使所有子集都具有该大小

对于**2)**我认为答案是否定的：

观察：对于小的 N，简单地生成对比生成大小为 K 的子集更好。生成大小>2 的子集仅消除一对，生成 k 的子集消除 k 选择 2 对。只有在以下情况下选择尺寸 K 才会更好

```
n/(k choose 2) = k/(k!/(k-2)!2!) = 2n/(k*(k-1)) > (n*n-1)/2 = (n choose 2)
1/(k*(k-1)) > (n-1)/4n 
```

只有足够大的 N 才成立：

```
1/(k*(k-1)) > 1/4 
  (k*(k-1)) > 4, k>=3 
```

对于***3)***我认为答案是肯定的

子集的数量在 处最大化`C(n,k)/C(k,2)`，我们可以使用公式计算它以找到最佳 k。如果还有对，我们可以简单地将它们添加到列表中，就好像 k=2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T21:11:22.517

```
>>> from itertools import combinations, chain
>>> s = {1,2,3,4,5,6,7,8,9}
>>> k = 3
>>> seen = set()
>>> subset_sizes = reversed(range(2,k+1)) # [3,2] for this example. Reversed since you favor the sets with larger values of K
>>> for item in chain.from_iterable(combinations(s,i) for i in subset_sizes):
        pairs = set(combinations(item,2))
        if not pairs.intersection(seen):
            seen.update(pairs)
            print item

(1, 2, 3)
(1, 4, 5)
(1, 6, 7)
(1, 8, 9)
(2, 4, 6)
(2, 5, 7)
(3, 4, 7)
(3, 5, 6)
(2, 8)
(2, 9)
(3, 8)
(3, 9)
(4, 8)
(4, 9)
(5, 8)
(5, 9)
(6, 8)
(6, 9)
(7, 8)
(7, 9) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T08:00:09.710

你可以这样做 ：

```
 P := {1, 2, 3, 4, 5, 6}; setpartition(P, 3);
   {{{1, 2, 3}, {4, 5, 6}}, {{1, 2, 4}, {3, 5, 6}}, 

     {{1, 2, 5}, {3, 4, 6}}, {{1, 2, 6}, {3, 4, 5}}, 

     {{1, 3, 4}, {2, 5, 6}}, {{1, 3, 5}, {2, 4, 6}}, 

     {{1, 3, 6}, {2, 4, 5}}, {{1, 4, 5}, {2, 3, 6}}, 

     {{1, 4, 6}, {2, 3, 5}}, {{1, 5, 6}, {2, 3, 4}}} 
```

# java - 如何避免创建会话？

> ID：10366319
> 
> 赞同：1
> 
> 时间：2012-04-28T18:21:53.363
> 
> 标签：java, apache-flex, session, session-cookies, blazeds

我的设置如下

*   在 /myApp/mainServlet/ 下可访问的主应用程序 servlet
*   一个“手工制作”的小肥皂代理，为来自客户端的肥皂调用添加安全标头（用户名、密码）
*   一个与主 servlet 对话（通过 BlazeDS 接口）的 Flex 客户端，并通过这个soap代理向第三方发送一些soap调用

flex 客户端有一个会话 id，它在它第一次与主 servlet 对话时设置，它返回一个 HTTP 标头，例如“Set-Cookie:”JSESSION:something; Path=/myApp”。然后这个 cookie 被发送到服务器，以告知客户端关联到哪个会话。

问题是小肥皂代理*还*返回一个带有会话 id 的 cookie（对于通过它进行的每个调用）——然后 Flex 客户端在与主 servlet 通信时使用这些 cookie。这些其他会话 ID 对它来说是未知的，然后当然没有任何作用......

我不希望从soap代理返回会话cookie，并且我已经验证通过告诉Apache前端剥离来自soap代理的所有“Set-Cookie”标头来解决问题。不幸的是（由于一些设置限制），这不是我可以投入生产的方式，所以我需要以编程方式修复它。

**如何使 servlet 不尝试设置任何会话 ID？**我相信我已经看到了告诉 Jetty（应用程序服务器）不要发送会话 id 的方法，但这也会影响主 servlet 这样做的能力，并且也不可移植。

代理 servlet 是一个非常基本的 Spring Controller（只是实现接口），所以基本上只是一个简单的 servlet。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T21:12:40.303

删除 cookie 可以通过`res.setHeader("Set-Cookie", null);`

**编辑：**很高兴知道，这会删除**所有**cookie，因为它们都设置在同一个标​​题中。

我建议您不要在您的 servlet 中执行此操作，过滤器更好，因为它的侵入性较小，例如：

```
public void doFilter(ServletRequest request,
            ServletResponse response,
            FilterChain chain)
                throws IOException, ServletException 
{
    HttpServletResponse res = (HttpServletResponse) response;

    try
    {
        chain.doFilter(request, res);
    }
    finally 
    {
        res.setHeader("Set-Cookie", null);
    }
} 
```

此解决方案的灵感来自 randomcoder 上的[这篇文章](http://randomcoder.org/articles/jsessionid-considered-harmful)。

# ruby-on-rails - Rails 如何处理不同服务器上的并发请求？

> ID：10366321
> 
> 赞同：4
> 
> 时间：2012-04-28T18:22:23.483
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, passenger, webrick

以前有人问过这个问题，但从未特别详尽地回答过。

假设您在支持它的几个 Web 服务器之一上运行 Rails，例如 WEBrick、Mongrel、Apache 和 Nginx（通过Passenger Phusion）。服务器收到两个并发的 GET，会发生什么？这在任何地方都有明确记录吗？

基本上我很好奇：

*   服务器每次都创建一个新实例或rails吗？
*   它是否以某种方式尝试重用现有实例（其中已加载 Rails 的 ruby​​ 进程？）来处理请求？
*   启动一个新的 ruby​​ 进程并在其中重新加载 Rails 不是很慢吗？

谢谢！任何指向详尽说明的链接将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:27:29.317

有些使用工人（apache、phusion、独角兽），有些则不使用。如果您不使用工作程序，这实际上取决于您的应用程序是否是线程安全的。如果是，则一次可能会处理多个请求，否则`Rack::Lock`会阻止该请求。如果有工作人员（单独的进程），他们每个人都会发出一个请求，然后返回到池中，在那里主服务器为其分配一个新请求。[继续阅读](http://tomayko.com/writings/unicorn-is-unix)

# javascript - 如何使用带有 JQuery 的书签发送 403 身份验证标头，作为跨域请求 (CORS)？

> ID：10366326
> 
> 赞同：2
> 
> 时间：2012-04-28T18:22:37.687
> 
> 标签：javascript, jquery, authentication, http-status-code-401, cors

所以我有一个在其他网站上执行 javascript 的小书签，一旦点击了它上面的*缓存*按钮，我想触发一个`403 Authentication Required`标题。这样，会出现一个提示，要求他们登录。

 *![苹果网站上的clickrobot](../Images/d44f58bbcc1291c3047c83e6840410da.png)

问题是我不打算为我正在发出的 ajax 请求提供身份验证标头，同时已设置为具有该值`Access-Control-Allow-Origin:`的任何域。`*`我应该明确定义要允许 403 身份验证标头出现在哪个域上，但我不能。

这是我的代码。

**.htaccess**

```
header set Access-Control-Allow-Origin: *
#header set Access-Control-Allow-Methods: GET, POST, PUT, DELETE
header set Access-Control-Allow-Headers: Authorization 
```

**jQuery**

```
$.ajax({
            headers : {
                "Authorization" : "Basic TVNF3TQtU1BGMjAx6C12bVxzbW4ydHBvaW50OlF3Z5J0eSEyM6Q1"
            },
            type: "GET",
            url: 'http://desbest.uk.to/clickrobot/favicon.png', //image for testing
            crossDomain:true,
            xhrFields: {
                withCredentials: true
            }, 
            //contentType: "application/json; charset=utf-8",
            //dataType: "json",
            success: function(data) {
                alert('ok!');
                //formatData(format_type,data);
            },
            error: function(jqXHR, textStatus, errorThrown) {
                alert(textStatus + ' / ' + errorThrown);
            }
        }); 
```

**我得到的错误**

> 当凭证标志为真时，不能在 Access-Control-Allow-Origin 中使用通配符。

我已经看到 Diigo 小书签做到了，所以这是可能的，但是怎么做呢？有可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T18:00:21.207

让我们看一下[文档](https://developer.mozilla.org/en/http_access_control#Requests_with_credentials)。有两点需要注意：

> ...浏览器将拒绝任何没有 Access-Control-Allow-Credentials: true 标头的响应...

和

> **重要提示：**在响应凭据请求时，服务器**必须**指定域，并且不能使用通配符。

您应该返回的标题是：

```
Access-Control-Allow-Origin: [some_origin]
Access-Control-Allow-Credentials: true 
```

您可以通过使用服务器脚本获取Referer 来返回第一个标头，从Referer 检索来源，然后将标头与您的脚本一起返回。在 PHP 中，我们可以这样做：

```
$urllist = parse_url($_SERVER['HTTP_REFERER']);
$origin = $urllist['scheme'] . '://' . $urllist['host'];
header("Access-Control-Allow-Origin: " . $origin); 
```

**更新：** 您应该阅读[Access-Control-Allow-Origin Multiple Origin Domains](https://stackoverflow.com/questions/1653308/access-control-allow-origin-multiple-origin-domains)，尤其是这个[答案](https://stackoverflow.com/a/6044862/1327789)。如果您可以访问 httpd.conf，您可能不需要 PHP 文件

无论如何，您的网址不应该是图像，而是您的 PHP 脚本的网址。

```
url: 'http://desbest.uk.to/clickrobot/somescript.php' 
```

在您的 php 脚本中，您检索请求的来源（这将是出现小书签的页面。然后您可以输出带有来源的标题。无论小书签出现在哪里，它都应该始终与正确的标题有关。

即使您指定了正确的标头，我也不完全确定授权对话框是否会使用 Ajax 弹出。所以，这就是为什么我们将在下面看看 Diigo。

* * *

Diigo 使用不同的方法，即：一旦单击“登录”，[JSONP](http://en.wikipedia.org/wiki/JSONP)用于请求由其服务器上的服务器端脚本（例如 PHP）生成的 javascript 文件。JSONP 是 CORS 的替代方案。与 Ajax 请求不同，不同的 JavaScript 文件可以包含在页面的标题中，完全没有问题。

如果用户未登录，则请求 javascript 文件会发送一个 401 标头，在该标头上显示身份验证对话框（这是在服务器端脚本中[编码的！）。](http://php.net/manual/en/features.http-auth.php)用户输入他/她的详细信息，并根据输入的信息返回 javascript 文件的内容。如果用户成功登录，它可能会返回类似的东西`callback({ signedin : 1})`，但否则`callback({ signedin : 0})`。

现在调用带有某些参数的javascript函数回调。如果用户已登录，我们将显示小书签的内容。

* * *

**在您的 htaccess 中放入什么：** 未经测试，但您希望允许所有来源并将“Access-Control-Allow-Origin”标头设置为来源的值。我相信这应该可以解决问题：

```
SetEnvIf Origin "^(.*)$" ORIGIN_DOMAIN=$1
Header set Access-Control-Allow-Origin "%{ORIGIN_DOMAIN}e" env=ORIGIN_DOMAIN 
```*

# php - 将整数除以 X 部分

> ID：10366327
> 
> 赞同：8
> 
> 时间：2012-04-28T18:22:39.010
> 
> 标签：php, math

我正在寻找一种在 PHP 中将数字等分的有效方法。数字将始终为整数（无浮点数）。

假设我有一个数组 $hours，其值从“1”到“24”（$hours['1'] 等）和一个包含整数的变量 $int。我想要实现的是将 $int 的值平均分布在 24 个部分中，这样我就可以将值分配给每个相应的数组条目。（如果数字是奇数，剩余的将添加到 24 中的最后一个或第一个值）。

问候，

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-28T18:32:19.083

这是您正在寻找的算法；`N`它在单元格上均匀分布一个整数`K`：

```
for i = 0 to K
    array[i] = N / K    # integer division

# divide up the remainder
for i = 0 to N mod K
    array[i] += 1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T18:35:44.837

试试这个代码

```
<?php
$num = 400;
$val = floor($num/24);

for($i=0;$i<24;$i++) {
    $arr[$i] = $val;
}

$arr[0] += $num - array_sum($arr);
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-15T18:22:26.833

```
function split($x, $n) 
{ 
    // If we cannot split the  
    // number into exactly 'N' parts 
    if($x < $n) 
        echo (-1); 

    // If x % n == 0 then the minimum  
    // difference is 0 and all  
    // numbers are x / n 
    else if ($x % $n == 0) 
    { 
        for($i = 0; $i < $n; $i++) 
        { 
            echo ($x / $n); 
            echo (" "); 
        } 
    } 

    else
    { 
        // upto n-(x % n) the values  
        // will be x / n  
        // after that the values  
        // will be x / n + 1 
        $zp = $n - ($x % $n); 
        $pp = $x / $n; 
        for ($i = 0; $i < $n; $i++) 
        { 
            if($i >= $zp) 
            { 
                echo (int)$pp + 1; 
                echo (" "); 
            } 
            else
            { 
                echo (int)$pp; 
                echo (" "); 
            } 
        } 
    } 
} 

// Driver code      
$x = 5; 
$n = 3; 
split( $x, $n); 
```

# heroku - Heroku 推送被拒绝，无法通过 Bundler 安装 gem

> ID：10366330
> 
> 赞同：0
> 
> 时间：2012-04-28T18:22:50.973
> 
> 标签：heroku, rubygems

我在将我的 Rails 项目推回 Heroku 时遇到问题。几天前我能够做到这一点。我对文件进行了一些更改，并尝试使用`git push heroku`. 它启动该过程然后给我这些错误。

```
> Counting objects: 56, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (35/35), done.
Writing objects: 100% (37/37), 3.96 KiB, done.
Total 37 (delta 18), reused 0 (delta 0)

`-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Detected Rails is not set to serve static_assets
       Installing rails3_serve_static_assets... done
-----> Configure Rails 3 to disable x-sendfile
       Installing rails3_disable_x_sendfile... done
-----> Configure Rails to log to stdout
       Installing rails_log_stdout... done
-----> Gemfile detected, running Bundler version 1.0.7
       Unresolved dependencies detected; Installing...
       Using --without development:test
       Fetching source index for https://rubygems.org/
       Installing rake (0.9.2.2) 
       Installing ZenTest (4.7.0) /usr/ruby1.9.2/lib/ruby/1.9.1/rubygems/installer.rb:170:in `install': ZenTest requires RubyG
ems version ~> 1.8\. Try 'gem update --system' to update RubyGems itself. (Gem::InstallError)
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/source.rb:95:in `install'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/installer.rb:55:in `block in run'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/spec_set.rb:12:in `block in each'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/spec_set.rb:12:in `each'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/spec_set.rb:12:in `each'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/installer.rb:44:in `run'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/installer.rb:8:in `install'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/cli.rb:225:in `install'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/vendor/thor/task.rb:22:in `run'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/vendor/thor/invocation.rb:118:in `invoke_task'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/vendor/thor.rb:246:in `dispatch'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/vendor/thor/base.rb:389:in `start'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/bin/bundle:13:in `<top (required)>'
        from /usr/ruby1.9.2/bin/bundle:19:in `load'
        from /usr/ruby1.9.2/bin/bundle:19:in `<main>'
       FAILED: http://devcenter.heroku.com/articles/bundler
 !     Heroku push rejected, failed to install gems via Bundler

`To git@heroku.com:mbartonsampleapp.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:mbartonsampleapp.git' 
```

我的宝石文件有

```
source 'https://rubygems.org'

gem 'rails', '3.2.3'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'heroku'

group :development do
  gem "ZenTest", "~> 4.7.0"
 gem 'sqlite3'
 gem 'autotest', '4.4.6'
 gem 'rspec-rails', '2.9.0'
end
# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

group :production do
# gems specifically for Heroku go here  
   gem 'pg'

end
group :test do
gem 'autotest', '4.4.6'
gem 'rspec-rails',  '2.9.0'
gem 'webrat', '0.7.3'
gem "spork",  '0.9.0'

end
  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
   gem 'therubyracer', :platform => :ruby
   gem 'execjs'
  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug19', :require => 'ruby-debug' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T20:06:15.963

你`Gemfile`看起来有点乱：该`assets`组没有关闭（它缺少一个`end`），所以你的`production`和`test`组嵌套在其中（最终关闭它`end`之后还有一个额外的）。`gem 'uglifier'`

这可能会使 Bundler 感到困惑，因此它不会`ZenTest`被视为在`development`组中并尝试将其安装在 Heroku 上。

# mysql - 从内部连接中选择匹配返回 0 结果的位置

> ID：10366333
> 
> 赞同：1
> 
> 时间：2012-04-28T18:23:34.860
> 
> 标签：mysql, full-text-search, inner-join

table.a 是 innodb 有字段`id,post_id,auther,add_date`

table.b 是 myisam 有字段`post_id,title,content`，全文键（标题，内容）

```
select * from b 
where match (title,content) 
against ('+words' in boolean mode) 
```

这可能会返回 12 条记录。运行解释时，我可以看到全文键。但

```
select * from a 
inner join b 
on a.post_id = 'b.post_id' 
where match (b.title,b.content)
against ('+words' in boolean mode)
and a.auther = 'someone'
order by a.id asc 
```

此返回 0 结果。我检查过

```
select id,auther,post_id from a where auther = 'someone' 
```

返回`post_id`放在mysql中

```
select post_id from b where post_id = 'post_id from table a' 
```

这个结果是存在的。那么问题出在哪里？（顺便说一句，2个表post_id都保存为varchar）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:38:43.437

我怀疑你不打算让加入条件成为

```
on a.post_id = 'b.post_id' 
```

反而

```
on a.post_id = b.post_id 
```

（不同之处在于您的版本将每一行连接到string所在的`b`任何行，而我的版本会将行连接到它们各自列相等的行）。`a``a.post_id``"b.post_id"``a``b``post_id`

# jquery - Jquery .append 数组：按包含的值引用数组

> ID：10366336
> 
> 赞同：0
> 
> 时间：2012-04-28T18:24:01.773
> 
> 标签：jquery, arrays, append

我目前正在使用 .append 将两个或多个数组连接在一起以形成一个短语，如您在此 jsfiddle 中所见：[jsfiddle append array](http://jsfiddle.net/Ntdsm/)。

```
function P1(phrase) {
    var sen = ('<a class="senword">' + phrase[0] + '<br/>' + phrase[1] + ' </a>');
       return sen;
}

var words = [
['one', '一'],    
['eight','八'],
['hundred','百'],
];

$("#onehundred").append(P1(words[0])).append(P1(words[2]));
$("#eighthundred").append(P1(words[1])).append(P1(words[2])); 
```

但是，我需要一种通过使用数组值来追加数组的方法，例如“百”而不是索引号，例如 [2]。这是因为每次我向 'words' 数组添加新词汇时，索引号显然会发生变化，这意味着我需要手动更改短语的所有索引号。

那么有没有办法通过使用值而不是索引号来连接数组，因为无论我添加了多少新单词，这个值都不会改变？

例如，而不是：

```
$("#onehundred").append(P1(words[0])).append(P1(words[2])); 
```

有这样的事情（但显然这是不正确的）：

```
$("#onehundred").append(P1(words['one'])).append(P1(words['hundred'])); 
```

PS如果有帮助，我不介意更改为文字数组，例如：

```
var words = [
{'english':'hundred', 'chinese':'百'},
]; 
```

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:39:55.130

将数据结构更改为对象：

```
var words = {
    'one': '一',    
    'eight': '八',
    'hundred': '百'
}; 
```

然后更改您的`P1`函数以接受属性名称，并让它进行查找...

```
function P1(key) {
    var sen = ('<a class="senword">' + words[key] + '<br/>' + key + ' </a>');
       return sen;
} 
```

然后只需传递属性名称...

```
$("#onehundred").append(P1('one')).append(P1('hundred'));
$("#eighthundred").append(P1('eight')).append(P1('hundred')); 
```

***演示：http:*** [//jsfiddle.net/DgAzz/](http://jsfiddle.net/DgAzz/)

* * *

如果您无法更改初始结构，则从中创建对象...

```
var words_map = {};

$.each(words, function(i, val) {
    words_map[val[0]] = val[1];
}); 
```

***演示：http:*** [//jsfiddle.net/DgAzz/1/](http://jsfiddle.net/DgAzz/1/)

# css - Css，文本阴影 - 如何让它溢出 div

> ID：10366342
> 
> 赞同：0
> 
> 时间：2012-04-28T18:25:12.630
> 
> 标签：css

我有一个 div 容器（标题）

```
div.header {
    width: 1024px;
    height: 115px;
    background-color: black;
} 
```

其中包含一个名为 header_title 的 h1，其中包含一个文本：

```
#header_title {
    font: 80px 'Oxygen', sans-serif;
    letter-spacing: -8px;
    margin-left: 25px;
    text-shadow: 500px 35px 18px white, 300px -50px 30px lightblue;
} 
```

就在标题 div 的下方，我有我的菜单，就像你在我的图片中看到的那样。

如果我设置了一个文本阴影，它将离开 div，（第 4 个字母，一个'g'）我可以让它显示并且不被切断吗？

我尝试了溢出：可见和 z-index 解决方案，但它不起作用 =(

谢谢。

![在此处输入图像描述](../Images/d1604a1b7ae1ce7818bea0d1425e3de3.png)

标头标记：

```
 <div class=header>
      <h1 id=header_title>Programmazione</h1>
 </div> <!-- fine header -->    

 <div class=menu>
     etc...... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:29:53.907

尝试删除 的`height`属性`header`并给它一个`padding-bottom`大约 15px 的阴影。这应该够了吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:32:45.047

我没有你的 HTML 标记来测试和确定，但我相信正在发生的事情是阴影**超出**了标题 div。在您提供的 CSS 中，我看不出有什么理由不会。

发生的事情是后面的菜单图像阻止了它。对于大多数浏览器来说，如果你默认定位项目（即不是绝对的、不是相对的、不是固定的），那么在它们重叠的情况下，下面的邻居在上面。此外，如果您以这种方式定位元素，z-index 不会**影响**它们。z-index 仅适用于相对、绝对和固定元素。

一种解决方案是给两个元素*position:relative;* *然后使用z-index*将标题 div 的位置高于菜单。

# ruby-on-rails - Michael Hartl 的 Ruby on Rails 3 教程：第 6 章第 6.3.2 节密码和确认（Rails 3.2）

> ID：10366344
> 
> 赞同：1
> 
> 时间：2012-04-28T18:26:03.453
> 
> 标签：ruby-on-rails, ruby-on-rails-3, railstutorial.org

我一直关注 Michael Hartl 的[http://ruby.railstutorial.org](http://ruby.railstutorial.org)直到第 6.3.2 章，在那里我停留在密码和确认。（[http://ruby.railstutorial.org/chapters/modeling-users#sec:adding_a_secure_password](http://ruby.railstutorial.org/chapters/modeling-users#sec:adding_a_secure_password)）

在阅读了以下说明后，我根据我的理解将“attr_assessor :password, :password_confirmation”添加到了 User.rb 中：

“如图 6.1 中的模型所示，我们希望用户确认他们的密码，这是网络上的一种常见做法，旨在最大程度地减少拼写错误。我们可以在控制器层强制执行此操作，但将其放入模型中并使用是常规做法Active Record 强制约束。方法是在 User 模型中添加 password 和 password_confirmation 属性，然后要求这两个属性匹配才能将记录保存到数据库中。与我们目前看到的其他属性不同，密码属性将是虚拟的——它们只会暂时存在于内存中，不会持久化到数据库中。”

添加后，我在 user_spec.rb 上的 bundle exec guard 上出现 11 次失败：

```
password: "foobar", password_confirmation: "foobar" to @User.new in models/user_spec.rb 
```

类似于 db:development.sqlite3 中不存在的“虚拟”属性（密码、密码确认）。这就是我试图做的没有成功的事情。我什至尝试了所有可能的方法，例如在 user.rb 中使用 @User 的哈希

我在这里做错了什么？

提前致谢

```
file: spec/user_spec.rb
require 'spec_helper'

describe User do

  before do
    # @user = User.new(name: "Example User", email: "user@example.com")
    @user = User.new(name: "Example User", email: "user@example.com",
                    password: "foobar", password_confirmation: "foobar")
  end

  subject { @user }

  it { should respond_to(:name) }
  it { should respond_to(:email) }
  it { should respond_to(:password_digest) }
  it { should respond_to(:password)}
  it { should respond_to(:password_confirmation) }

  describe "when name is not present" do
    before { @user.name = " " }
    it { should_not be_valid }
  end

  describe "when email is not present" do
    before { @user.email = " " }
    it { should_not be_valid }
  end

  describe "when name is too long" do
    before { @user.name = "a" * 51 }
    it { should_not be_valid }
  end

  describe "when email format is invalid" do
    it "should be invalid" do
      addresses = %w[user@foo,com user_at_foo.org example.user@foo.]
      addresses.each do |invalid_address|
        @user.email = invalid_address
        @user.should_not be_valid
      end      
    end
  end

  describe "when email format is valid" do
    it "should be valid" do
      addresses = %w[user@foo.com A_USER@f.b.org frst.lst@foo.jp a+b@baz.cn]
      addresses.each do |valid_address|
        @user.email = valid_address
        @user.should be_valid
      end      
    end
  end

  describe "when email address is already taken" do
    before do
      user_with_same_email = @user.dup
      user_with_same_email.save
    end

    it { should_not be_valid }
  end
end 
```

.

```
file: models/user.rb
# == Schema Information
#
# Table name: users
#
#  id              :integer         not null, primary key
#  name            :string(255)
#  email           :string(255)
#  created_at      :datetime        not null
#  updated_at      :datetime        not null
#  password_digest :string(255)
#

class User < ActiveRecord::Base
  attr_accessor :password, :password_confirmation
  attr_accessible :email, :name
  # attr_accessible :email, :name
  # attr_accessible :email, :name, :password, :password_confirmation

  before_save { |user| user.email = email.downcase }

  validates :name, presence: true, length: { maximum: 50 }
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true,
            format: { with: VALID_EMAIL_REGEX },
            uniqueness: { case_sensitive: false }
  #validates :password, length: { minimum: 6 }
  #validates :password_confirmation, presence: true

end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T21:52:12.827

如果您只在第 6.3.2 节上，那么测试应该会失败。您将在以下部分中更正该问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T03:03:20.237

将 has_secure_password 添加到模型中可以解决问题。它也在书中（后半部分）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T21:41:14.030

我猜这些错误是在抱怨“找不到表‘用户’”试试：

```
rake db:migrate 
rake db:load:test 
```

# android - 两种布局，一种禁用

> ID：10366356
> 
> 赞同：0
> 
> 时间：2012-04-28T18:27:31.910
> 
> 标签：android, layout

我有`Activity`一个 RadioGroup，其中包含 2 个 RadioButtons ( `rdbtn4`, `rdbtn5`)。

然后我有一个 XML 文件，其中包含`LinearLayouts`：

*   `linlay4`仅包含 4 个 Spinner，
*   `linlay5`五个额外的微调器。

然后用户可以根据自己的喜好设置 Spinner，按下按钮后 2 个 TextView 会设置为特定文本（取决于所选的 Spinner 值）。

这与未设置的 TextViews 完美`linlay4`配合`linlay5`。

这是我的代码：

```
package at.esdev.electro;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.LinearLayout;
import android.widget.RadioButton;
import android.widget.RadioGroup;
import android.widget.Spinner;
import android.widget.TextView;

public class Widerstandsfarbcode extends Activity
{
    LinearLayout linlay4rings, linlay5rings;
    TextView tvWidResultValue, tvWidToleranzValue;
    Button btnCalcwid;
    Spinner sp4Farbe1, sp4Farbe2, sp4Farbe3, sp4Farbe4, sp5Farbe1, sp5Farbe2, sp5Farbe3, sp5Farbe4, sp5Farbe5;
    RadioGroup rdGrp1;
    RadioButton rdbtn4rings, rdbtn5rings;

public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.widerstandsfarbcode);

    linlay4rings = (LinearLayout) findViewById(R.id.linLay4rings);
    linlay5rings = (LinearLayout) findViewById(R.id.linLay5rings);

    tvWidResultValue = (TextView) findViewById(R.id.tvWidResultValue);
    tvWidToleranzValue = (TextView) findViewById(R.id.tvWidToleranzValue);

    btnCalcwid = (Button) findViewById(R.id.btnCalcwid);

    sp4Farbe1 = (Spinner) findViewById(R.id.sp4Farbe1);
    sp4Farbe2 = (Spinner) findViewById(R.id.sp4Farbe2);
    sp4Farbe3 = (Spinner) findViewById(R.id.sp4Farbe3);
    sp4Farbe4 = (Spinner) findViewById(R.id.sp4Farbe4);

    sp5Farbe1 = (Spinner) findViewById(R.id.sp5Farbe1);
    sp5Farbe2 = (Spinner) findViewById(R.id.sp5Farbe2);
    sp5Farbe3 = (Spinner) findViewById(R.id.sp5Farbe3);
    sp5Farbe4 = (Spinner) findViewById(R.id.sp5Farbe4);
    sp5Farbe5 = (Spinner) findViewById(R.id.sp5Farbe5);

    rdGrp1 = (RadioGroup) findViewById(R.id.rdGrp1);

    rdbtn4rings = (RadioButton) findViewById(R.id.rdb4Rings);
    rdbtn5rings = (RadioButton) findViewById(R.id.rdb5Rings);

    //Default-Value when starting Activity:
    linlay4rings.setVisibility(0); //0 = visible, 4 = invisible, 8 = gone
    linlay5rings.setVisibility(8);

    //Layout for 5 buttons disabled, if rdbtn4 is selected:
            rdbtn4rings.setOnClickListener(new View.OnClickListener() 
            {
                public void onClick(View v) 
                {
                    linlay4rings.setVisibility(0); //0 = visible, 4 = invisible, 8 = gone
                    linlay5rings.setVisibility(8);
                }
            });

            //Layout for 4 buttons disabled, if rdbtn5 is selected:
            rdbtn5rings.setOnClickListener(new View.OnClickListener() 
            {
                public void onClick(View v) 
                {
                    linlay4rings.setVisibility(8); //0 = visible, 4 = invisible, 8 = gone
                    linlay5rings.setVisibility(0);
                }
            });

    //Color-adjusting
    ArrayAdapter <?> adapterFarben = ArrayAdapter.createFromResource(this, R.array.widerstandsfarbSpinnerItems, android.R.layout.simple_spinner_item);
    adapterFarben.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    sp4Farbe1.setAdapter(adapterFarben); 
    sp4Farbe2.setAdapter(adapterFarben);
    sp5Farbe1.setAdapter(adapterFarben);
    sp5Farbe2.setAdapter(adapterFarben);
    sp5Farbe3.setAdapter(adapterFarben);
    //Multiplier-adjusting
    ArrayAdapter <?> adapterMultiplikator = ArrayAdapter.createFromResource(this, R.array.widerstandsMultiplikatorSpinnerItems, android.R.layout.simple_spinner_item);
    adapterMultiplikator.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    sp4Farbe3.setAdapter(adapterMultiplikator);
    sp5Farbe4.setAdapter(adapterMultiplikator);
    //Tolerance-adjusting:
    ArrayAdapter <?> adapterToleranz = ArrayAdapter.createFromResource(this, R.array.widerstandsToleranzSpinnerItems, android.R.layout.simple_spinner_item);
    adapterFarben.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    sp4Farbe4.setAdapter(adapterToleranz);
    sp5Farbe5.setAdapter(adapterToleranz);

    if (rdbtn4rings.isChecked())
    {
        btnCalcwid.setOnClickListener(new View.OnClickListener() 
        {
            public void onClick(View v) 
            {
                String s41 = String.valueOf(sp4Farbe1.getSelectedItemId()); //Farbe 1
                String s42 = String.valueOf(sp4Farbe2.getSelectedItemId()); //Farbe 2
                String s43 = String.valueOf(sp4Farbe3.getSelectedItemId()); //Multiplikator
                String s44 = String.valueOf(sp4Farbe4.getSelectedItemId()); //Toleranz
                int ds43 = Integer.parseInt(s43);
                int ds44 = Integer.parseInt(s44);
                rise1(ds43); 
                String snewTolerance = String.valueOf(getToleranceValue(ds44));

                //Output:

                tvWidResultValue.setText("" + s41 + s42 + "*10^" + ds43 + " Ohm");
                tvWidToleranzValue.setText(""+ snewTolerance + " %");
            }
        }); 
    }

    if (rdbtn5rings.isChecked())
    {
        btnCalcwid.setOnClickListener(new View.OnClickListener() 
        {
            public void onClick(View v) 
            {
                String s51 = String.valueOf(sp5Farbe1.getSelectedItemId()); //Farbe 1
                String s52 = String.valueOf(sp5Farbe2.getSelectedItemId()); //Farbe 2
                String s53 = String.valueOf(sp5Farbe3.getSelectedItemId()); //Farbe 3
                String s54 = String.valueOf(sp5Farbe4.getSelectedItemId()); //Multiplikator
                String s55 = String.valueOf(sp5Farbe5.getSelectedItemId()); //Toleranz
                int ds54 = Integer.parseInt(s54);
                int ds55 = Integer.parseInt(s55);
                rise1(ds54);
                String snewTolerance = String.valueOf(getToleranceValue(ds55));

                //Output:

                tvWidResultValue.setText("" + s51 + s52 + s53 + "*10^" + ds54 + " Ohm");
                tvWidToleranzValue.setText(""+ snewTolerance + " %");
            }//onClick
        });
    }
}

public double rise1(double multiplikValue)
{
    if (multiplikValue > -1)    
    {
        if (multiplikValue < 7) 
        {
            multiplikValue = multiplikValue++;
        }
    }
    if (multiplikValue == 7)
    {
        multiplikValue = -1; //weil 10^-1 = 0.1
    }
    if (multiplikValue == 8)
    {
        multiplikValue = -2; //weil 10^-2 = 0.01
    }
    return multiplikValue;
}

public double getToleranceValue(double toleranz)
{
    double newTolerance = 0; 
    if (toleranz == 0) //Spinnerposition
    {
        newTolerance = 1; //Toleranz-%-Wert
    }
    if (toleranz == 1 )
    {
        newTolerance = 2;
    }
    if (toleranz == 2 )
    {
        newTolerance = 0.5;
    }
    if (toleranz == 3 )
    {
        newTolerance = 0.25;
    }
    if (toleranz == 4 )
    {
        newTolerance = 0.1;
    }
    if (toleranz == 5 )
    {
        newTolerance = 5;
    }
    if (toleranz == 6 )
    {
        newTolerance = 10;
    }
    return newTolerance;
} 
```

}

提前致谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:41:26.767

你的变量名非常神秘，但我想我明白了什么是错的。尝试更改 btnCalcWid 中的检查，如下所示：

```
btnCalcwid.setOnClickListener(new View.OnClickListener() 
{
    public void onClick(View v) 
    {
        if (rdbtn4rings.isChecked())
        {
            String s41 = String.valueOf(sp4Farbe1.getSelectedItemId()); //Farbe 1
            String s42 = String.valueOf(sp4Farbe2.getSelectedItemId()); //Farbe 2
            String s43 = String.valueOf(sp4Farbe3.getSelectedItemId()); //Multiplikator
            String s44 = String.valueOf(sp4Farbe4.getSelectedItemId()); //Toleranz
            int ds43 = Integer.parseInt(s43);
            int ds44 = Integer.parseInt(s44);
            rise1(ds43); 
            String snewTolerance = String.valueOf(getToleranceValue(ds44));

            //Output:

            tvWidResultValue.setText("" + s41 + s42 + "*10^" + ds43 + " Ohm");
            tvWidToleranzValue.setText(""+ snewTolerance + " %");
        }
        else if (rdbtn5rings.isChecked())
        {
            String s51 = String.valueOf(sp5Farbe1.getSelectedItemId()); //Farbe 1
            String s52 = String.valueOf(sp5Farbe2.getSelectedItemId()); //Farbe 2
            String s53 = String.valueOf(sp5Farbe3.getSelectedItemId()); //Farbe 3
            String s54 = String.valueOf(sp5Farbe4.getSelectedItemId()); //Multiplikator
            String s55 = String.valueOf(sp5Farbe5.getSelectedItemId()); //Toleranz
            int ds54 = Integer.parseInt(s54);
            int ds55 = Integer.parseInt(s55);
            rise1(ds54);
            String snewTolerance = String.valueOf(getToleranceValue(ds55));

            //Output:

            tvWidResultValue.setText("" + s51 + s52 + s53 + "*10^" + ds54 + " Ohm");
            tvWidToleranzValue.setText(""+ snewTolerance + " %");
        }//else if
    }//onClick
});//setOnClickListener 
```

# mysql - MySQL 更新，设置在哪里不起作用？

> ID：10366360
> 
> 赞同：0
> 
> 时间：2012-04-28T18:27:58.040
> 
> 标签：mysql, set, where

我读过其他帖子，我真的不明白我在这里做错了什么，因为这是一个如此简单的陈述。

'()' 中的任何内容都是注释

询问：

```
[UPDATE users, sites 
SET users.idSiteRegUsers='1'
WHERE sites.SiteActivateSites='DEL' ] 
```

（选择在整个查询中更新的 TBL）（将用户 tbl idSiteRegUsers 设置为 1）（其中只有 tbl 站点中的站点 = DEL）

我还阅读了[http://bugs.mysql.com/bug.php?id=52651](http://bugs.mysql.com/bug.php?id=52651)并尝试将 INT 更改为 VARCHAR 并将 UPDATING 0 更改为 DEL 由于该错误，但结果仍然相同。

问题：

我有 2129 条记录需要更新，因为使用简单的 select 语句来了解结果的数量。

```
([SELECT
sites.SiteActivateSites,
sites.id_Sites,
users.idSiteRegUsers,
users.CompanyNameUsers,
sites.LinkNameSites
FROM
users
INNER JOIN sites ON users.idSiteRegUsers = sites.id_Sites
WHERE
sites.SiteActivateSites != '1']) 'simple' 
```

但是 UPDATE 查询更新所有 4000 多条记录，不仅是 = DEL 的记录，还有那些引用另一个值的记录，例如 = 1。

我错过了什么吗？

干杯，乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:32:41.473

就像使用您的`SELECT`命令一样，您需要告诉 MySQL 表是如何连接的：您`UPDATE`当前正在对两个表进行完整的笛卡尔积（每一行都与每一行`users`连接`sites`- 因此`WHERE`条件过滤`sites`仍然会导致匹配在每条记录上`users`）。

请尝试：

```
UPDATE users JOIN sites ON users.idSiteRegUsers = sites.id_Sites
SET    users.idSiteRegUsers='1'
WHERE  sites.SiteActivateSites='DEL' 
```

# jquery - 使用增加/减少按钮输入日期和时间表格

> ID：10366363
> 
> 赞同：0
> 
> 时间：2012-04-28T18:28:20.057
> 
> 标签：jquery, html, forms

只需要在这个问题上提供一些指导，因为我对 Javascript 增强表单没有太多经验。
客户希望我让他在下图中形成这样的形式：

![在此处输入图像描述](../Images/c339cb03b4eb3f8f7e76e092f654e85d.png)

我知道有一种方法可以通过 Javascript 填充这些字段，但我仍然没有完全弄清楚。我已经在那里看到了一些已经制定的解决方案，例如 JQuery UI Datepicker，但它在设计上有所不同，如果可能的话，我想遵循我客户的意愿。所以我的问题是如何通过 Javascript 填充具有值的字段（如果有帮助，我正在使用 JQuery），然后使用什么 Javascript 代码`up arrow`和`down arrow`值浏览。最后你有没有在某处看到一些类似的实现？？？

非常感谢。

***编辑***

我从互联网上看到这应该是默认的 HTML5 行为，但它在我最新的 Ubuntu 11.10 下的 Chrome 和 Firefox 浏览器副本中不起作用？？？

# iphone - iOS 在两个控制器之间切换

> ID：10366364
> 
> 赞同：1
> 
> 时间：2012-04-28T18:28:39.543
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我的委托上有两个选项卡控制器，我想根据需要切换它们。RootController 显示为默认值，当我想显示我使用的另一个类的 secondController 时，

```
 myAppDelegate *appDelegate = (myAppDelegate *)[[UIApplication sharedApplication] delegate];
    [appDelegate.window addSubview:appDelegate.secondController.view];
    [appDelegate.rootController.view removeFromSuperview]; 
```

问题是当我尝试使用相同的方法返回时。由于错误访问异常导致崩溃...

```
 myAppDelegate *appDelegate = (myAppDelegate *)[[UIApplication sharedApplication] delegate];   
    [appDelegate.window addSubview:appDelegate.rootController.view];
    [appDelegate.secondController.view removeFromSuperview]; 
```

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:05:16.880

您不应该从 Superview 中删除 rootController。删除该行

```
[appDelegate.rootController.view removeFromSuperview]; 
```

当你想回到你的 rootController 时，只需添加以下几行：

```
myAppDelegate *appDelegate = (myAppDelegate *)[[UIApplication sharedApplication] delegate];
[appDelegate.secondController.view removeFromSuperview]; 
```

# php - Facebook PHP SDK - 无法正确注销

> ID：10366366
> 
> 赞同：6
> 
> 时间：2012-04-28T18:29:11.790
> 
> 标签：php, facebook, oauth, facebook-php-sdk

我一直在寻找这个问题的解决方案几个小时，但找不到适合我的解决方案。当我在我的网站上单击“注销”时，用户信息仍然可见，并且仍然显示注销按钮。这是代码：

```
require 'facebook-php-sdk/src/facebook.php';

$facebook = new Facebook(array(
  'appId'  => 'xxxx',
  'secret' => 'xxxx',
));

// Get User ID
$user = $facebook->getUser();
var_dump($user);
if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

// Login or logout url will be needed depending on current user state.

if ($_GET['logout'] == "yes") {
setcookie('fbs_'.$facebook->getAppId(), '', time()-100, '/', 'http://gno.....ment/index.php');
session_destroy();
header("Location: ".$_SERVER['PHP_SELF']."");
}

if ($user_profile) {
  $logoutUrl = $facebook->getLogoutUrl;
} else {
  $loginUrl = $facebook->getLoginUrl(array('scope' => 'email,publish_stream,user_status',
  'canvas' => 1,
  'fbconnect' => 0,
  'redirect_uri' => 'http://gno.....ment/index.php'));
} 
```

…………

```
<?php if ($user): ?>
<h3>You</h3>
<img src="https://graph.facebook.com/<?php echo $user; ?>/picture">

<h3>Your User Object (/me)</h3>
<pre><?php print_r($user_profile); ?></pre>
<?php else: ?>
<strong><em>You are not Connected.</em></strong>
<?php endif ?>

<?php if ($user): ?>
<a href="<?php echo $logoutUrl; ?>">Logout of FB</a>
<?php else: ?>
<div>
Login using OAuth 2.0 handled by the PHP SDK:
<a href="<?php echo $loginUrl; ?>">Login with Facebook</a>
</div>
<?php endif ?> 
```

看来这`if ($_GET['logout'] == "yes")`可能是我的答案，但我无法让它工作。我不知道从哪里`logout`得到或定义在哪里？

这似乎是一个普遍的问题，但我无法弄清楚。我真的很感激一些帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-18T23:01:52.860

用 PHP SDK 做这件事真的很容易，文档真的很糟糕。您无需重定向到 Facebook。您只需要清除 Facebook 类设置的会话，Facebook 基类中有一个名为*destroySession()*的函数。在这里，我正在做这件事。

```
require_once('libs/facebook.php');

$facebook = new Facebook(array(
    'appId'  => '1121111110112',
    'secret' => 'bcfsaasaaaaaa2b7adsae3a4dd5'
)); 

if(isset($_GET['action']) && $_GET['action'] === 'logout'){
    $facebook->destroySession();
} 
```

$facebook->getLogoutUrl() 将用户从 Facebook 注销。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T19:54:55.160

您可以通过指定外部注销问题来解决此问题。你可以看看[这里](http://cacovsky.wordpress.com/2011/05/17/login-with-facebook-php-sdk-a-tutorial/)

了解详细信息。这是解决这个问题的一个很好的教程。

希望这可以帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-04T20:48:20.427

直接回答您的问题

> ...*我不知道注销是从哪里获得的或在哪里定义的？*

创建注销 url 时，添加附加参数“注销”

```
$logoutUrl = $facebook->getLogoutUrl(array(
    'next'=>'http://yourdomain.com/facebook-test-search.php?logout=yes'
)); 
```

然后在你的脚本中，你清除会话和cookies`isset($_GET['logout'])`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-10T17:56:48.043

这是我使用最新的 PHP-SDK 注销的方法：

登录.php

```
require_once("php-sdk/facebook.php");

// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
  'appId'  => 'xxx',
  'secret' => 'xxx',
));

// Get User ID
$user = $facebook->getUser();

// We may or may not have this data based on whether the user is logged in.
//
// If we have a $user id here, it means we know the user is logged into
// Facebook, but we don't know if the access token is valid. An access
// token is invalid if the user logged out of Facebook.

if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

// Login or logout url will be needed depending on current user state.
if ($user) {
    $logout_params = array('next'=>'http://www.pittsburghpartycentral.com/logout.php');
  $logoutUrl = $facebook->getLogoutUrl($logout_params);
} else {
    $login_params = array(
                        'scope' => 'email',
                        'display' => 'popup'
                        );
  $loginUrl = $facebook->getLoginUrl($login_params);
}

// This call will always work since we are fetching public data.
$naitik = $facebook->api('/naitik');

?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <title>php-sdk</title>
    <style>
      body {
        font-family: 'Lucida Grande', Verdana, Arial, sans-serif;
      }
      h1 a {
        text-decoration: none;
        color: #3b5998;
      }
      h1 a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <h1>php-sdk</h1>
    <?php if ($user): ?>
      <a href="<?php echo $logoutUrl; ?>">Logout (<?php echo $user_profile[first_name]; ?>)</a>
    <?php else: ?>
      <div>
        Login using OAuth 2.0 handled by the PHP SDK:
        <a href="<?php echo $loginUrl; ?>" onclick="javascript:void window.open('<?php echo $loginUrl; ?>','fb_popup','width=600,height=300,toolbar=0,menubar=0,location=0,status=0,scrollbars=0,resizable=0,left=0,top=0');return false;">Login with Facebook</a>
      </div>
    <?php endif ?>

    <h3>PHP Session</h3>
    <pre><?php print_r($_SESSION); ?></pre>

    <?php if ($user): ?>
      <h3>You</h3>
      <img src="https://graph.facebook.com/<?php echo $user; ?>/picture">

      <h3>Your User Object (/me)</h3>
      <pre><?php print_r($user_profile); ?></pre>
    <?php else: ?>
      <strong><em>You are not Connected.</em></strong>
    <?php endif ?>

    <h3>Public profile of Naitik</h3>
    <img src="https://graph.facebook.com/naitik/picture">
    <?php echo $naitik['name']; ?>
  </body>
</html> 
```

注销.php

```
<?php 
    session_start();            //start session
    $_SESSION = array();    //clear session array
    session_destroy();      //destroy session
?>
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Log Out</title>
</head>

<body>
<p>You have successfully logged out!</p>
<p>Return to the <a href="connect.php">connect</a> page</p>

</body>
</html> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-21T23:07:40.277

我可以使用以下方法从我的应用程序中注销用户：

```
$facebook->destroySession(); 
```

这

```
$facebook->getLogoutUrl(); 
```

使用户从 facebook 中注销，而不是从您的应用程序中注销。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-06T22:28:18.407

有一些类似的麻烦。甚至

```
$facebook->destroySession(); 
```

在我删除之前无法正常工作

```
$facebook->getLogoutUrl(); 
```

完全调用。`getLogOutUrl()`添加了一些后来与我的 .htaccess 冲突的参数，并导致 *"mod_fcgid: stderr: CSRF state token does not match one provided"* 错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-07T10:58:53.913

因为我在 2016 年的 CentOS 6.7 服务器上仍然有 PHP 5.3，并且不想麻烦升级 PHP 版本 - 我仍然使用旧的[facebookarchive/facebook-php-sdk](https://github.com/facebookarchive/facebook-php-sdk)而不是新的[facebook/facebook-php -sdk-v4](https://github.com/facebook/facebook-php-sdk-v4)库。

以下是我在应用程序中处理注销的方式：

```
<?php

require_once('facebook-php-sdk-3.2.3/src/facebook.php');

const TITLE      = 'My amazing app';
const REDIRECT   = 'https://example.com/myapp/';

#Facebook::$CURL_OPTS[CURLOPT_SSL_VERIFYPEER] = false;
#Facebook::$CURL_OPTS[CURLOPT_SSL_VERIFYHOST] = 2;

$client = new Facebook(array(
        'appId'  => REPLACE_ME,
        'secret' => REPLACE_ME,
));

if (isset($_REQUEST['logout'])) {
        $client->destroySession();
        header('Location: ' . REDIRECT);
        exit(0);
}

if ($client->getUser()) {
        try {
                $me = $client->api('/me?fields=id,first_name,gender');
                $body = '<PRE>' . print_r($me, TRUE) . '</PRE>';
        } catch (FacebookApiException $ex) {
                error_log($ex);
                $body = '<PRE>' . htmlspecialchars($e->getMessage()) . '</PRE>';
        }
} else {
        $body = sprintf('<P><A HREF="%s">Login</A></P>', $client->getLoginUrl());
}

?>

<!DOCTYPE HTML>
<HTML>
<HEAD>
        <TITLE><?= TITLE ?></TITLE>
</HEAD>
<BODY>
        <?= $body ?>
        <P><A HREF="<?= REDIRECT ?>?logout">Logout</A></P>
</BODY>
</HTML> 
```

不要忘记 -

1.  [在Facebook 控制台](https://developers.facebook.com)获取 Web 客户端 ID 和密码
2.  授权`https://example.com/myapp/`在同一个地方

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-04-28T18:40:11.040

我记得这对我的一个应用程序来说是一个巨大的痛苦。似乎最终似乎起作用的是：

```
jQuery(function() {
   /* ... */
   FB.logout();
   window.location = 'some url';
}); 
```

如果没有 jQuery，我应该差不多（只需在页面加载时运行 FB.logout()）。AFAIR 我只是无法让它在 PHP 的服务器端工作。希望能帮助到你 ：）。

# ruby-on-rails - 在 Rails 中保存模型的每日数据

> ID：10366368
> 
> 赞同：0
> 
> 时间：2012-04-28T18:29:35.873
> 
> 标签：ruby-on-rails

我有一个文章模型和一个用户模型。用户可以关注该文章，但不能取消关注。我想跟踪一篇文章的新关注者，并在我想绘制它时检索它。（假设现在，绘图不是问题。）

我希望每篇文章都有一个自该文章创建以来的每个日期的列表。所以它会有：

```
article.newfollowers[1/1/2012] = 35
article.newfollowers[2/1/2012] = 4 
```

每次用户关注一篇文章时，我都会这样做

```
This.newfollowers[Date()]++ 
```

显然保存这样的数据意味着文章数据库中的每一行都有数百个属性（对于每个日期）。

我将如何在文章模型中保存数据？如何声明/定义此类属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:54:05.327

如果您不需要直接查询日期，请查看[ActiveRecord::Store](http://api.rubyonrails.org/classes/ActiveRecord/Store.html)。您至少需要使用 Rails 3.2.0，但会阻止您添加这么多列。

另一种解决方案可能是使用[Redis 排序集](http://redis.io/commands#sorted_set)，使用日期时间戳作为分数，将新关注者作为值。

# c# - 发送和接收UDP数据

> ID：10366372
> 
> 赞同：0
> 
> 时间：2012-04-28T18:30:14.533
> 
> 标签：c#, sockets, udp, hex

> **可能重复：**
> [在 C# 中发送 UDP 数据包](https://stackoverflow.com/questions/2637697/sending-udp-packet-in-c-sharp)

我有一些十六进制格式的数据，我想发送到 UDP 服务器，然后从包含一些数据的服务器获取响应。我将如何在 C# 中执行此操作？

我可能会补充一点，我没有对服务器的本地访问权限，我只想看看通过将这些特定数据发送给它得到的响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:52:12.417

1-[使用异步 UDP 套接字的聊天应用程序](http://www.codeproject.com/Articles/16935/A-Chat-Application-Using-Asynchronous-UDP-sockets)
![在此处输入图像描述](../Images/ee0784810969259a5a980ef6339fc3b5.png)

2-[在 C# 中发送 UDP 数据包](http://www.codeproject.com/Questions/72657/Send-UDP-packet-in-C)

3-[使用 C# 和 .NET 测试 TCP 和 UDP 套接字服务器](http://www.codeproject.com/Articles/2614/Testing-TCP-and-UDP-socket-servers-using-C-and-NET)

4-[接收和发送数据](http://www.nuclearprojects.com/xplane/receivedata.shtml)

5-[使用 VB.NET 中的线程进行 UDP 发送和接收](http://www.codeproject.com/Articles/8877/UDP-Send-and-Receive-using-threads-in-VB-NET)

6-[基于UDP的可靠数据传输库](http://www.codeproject.com/Articles/11046/A-UDP-based-Reliable-Data-Transfer-Library)

7 [-msdn 微软](http://msdn.microsoft.com/en-us/library/w89fhyex%28vs.71%29.aspx)

# python - 与函数式编程中的“折叠”函数等效的“pythonic”是什么？

> ID：10366374
> 
> 赞同：154
> 
> 时间：2012-04-28T18:30:48.820
> 
> 标签：python, list, functional-programming, reduce, fold

在 Haskell 中实现以下目标的最惯用方法是什么：

```
foldl (+) 0 [1,2,3,4,5]
--> 15 
```

或者它在 Ruby 中的等价物：

```
[1,2,3,4,5].inject(0) {|m,x| m + x}
#> 15 
```

显然，Python 提供了`reduce`函数，它是 fold 的实现，与上面完全相同，但是，我被告知“pythonic”的编程方式是避免`lambda`使用术语和高阶函数，在可能的情况下更喜欢列表理解。因此，是否存在折叠列表的首选方法，或者 Python 中的类似列表的结构不是`reduce`函数，或者是`reduce`实现此目的的惯用方法？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2012-04-28T18:35:51.123

对数组求和的 Pythonic 方法是使用[`sum`](https://docs.python.org/3/library/functions.html#sum). 出于其他目的，您有时可以使用[`reduce`](https://docs.python.org/3/library/functools.html#functools.reduce)（来自[`functools`](https://docs.python.org/3/howto/functional.html#the-functools-module)模块）和[`operator`](https://docs.python.org/3/library/operator.html#module-operator)模块的某种组合，例如：

```
def product(xs):
    return reduce(operator.mul, xs, 1) 
```

请注意，这`reduce`实际上是一个`foldl`，用 Haskell 术语来说。没有特殊的语法来执行折叠，没有内置的`foldr`，并且实际上`reduce`与非关联运算符一起使用被认为是不好的风格。

使用高阶函数是非常 Pythonic 的；它很好地利用了 Python 的一切都是对象的原则，包括函数和类。你说得对，一些 Python 爱好者不赞成 lambda，但主要是因为当它们变得复杂时，它们往往不太可读。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2019-04-28T13:00:57.547

开始`Python 3.8`，并引入[赋值表达式（PEP 572）](https://www.python.org/dev/peps/pep-0572/)（`:=`运算符），它提供了命名表达式结果的可能性，我们可以使用列表推导来复制其他语言所说的 fold/foldleft/reduce 操作：

给定一个列表、一个归约函数和一个累加器：

```
items = [1, 2, 3, 4, 5]
f = lambda acc, x: acc * x
accumulator = 1 
```

我们可以折叠`items`以`f`获得结果`accumulation`：

```
[accumulator := f(accumulator, x) for x in items]
# accumulator = 120 
```

* * *

或以浓缩形式：

```
acc = 1; [acc := acc * x for x in [1, 2, 3, 4, 5]]
# acc = 120 
```

* * *

请注意，这实际上也是一个“scanleft”操作，因为列表推导的结果代表了每一步的累积状态：

```
acc = 1
scanned = [acc := acc * x for x in [1, 2, 3, 4, 5]]
# scanned = [1, 2, 6, 24, 120]
# acc = 120 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2015-08-19T17:36:27.993

哈斯克尔

`foldl (+) 0 [1,2,3,4,5]`

Python

`reduce(lambda a,b: a+b, [1,2,3,4,5], 0)`

显然，这是一个用来说明问题的简单例子。在 Python 中你会这样做`sum([1,2,3,4,5])`，甚至 Haskell 纯粹主义者通常更喜欢`sum [1,2,3,4,5]`.

对于没有明显便利功能的非平凡场景，惯用的 Pythonic 方法是显式写出 for 循环并使用可变变量赋值而不是使用`reduce`or a `fold`。

这根本不是功能风格，而是“pythonic”方式。Python 不是为功能纯粹主义者设计的。了解 Python 如何支持流控制的异常以了解非功能性惯用 Python 的表现如何。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-04-27T15:20:37.227

在 Python 3 中，`reduce`已删除：[发行说明](https://docs.python.org/3.0/whatsnew/3.0.html#builtins)。不过你可以使用[functools 模块](https://docs.python.org/3/howto/functional.html#the-functools-module)

```
import operator, functools
def product(xs):
    return functools.reduce(operator.mul, xs, 1) 
```

另一方面，文档表达了对`for`-loop 而不是 的偏好`reduce`，因此：

```
def product(xs):
    result = 1
    for i in xs:
        result *= i
    return result 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-04-16T14:55:27.797

不是真正回答这个问题，而是 foldl 和 foldr 的单行：

```
a = [8,3,4]

## Foldl
reduce(lambda x,y: x**y, a)
#68719476736

## Foldr
reduce(lambda x,y: y**x, a[::-1])
#14134776518227074636666380005943348126619871175004951664972849610340958208L 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-05-21T09:39:01.277

你也可以重新发明轮子：

```
def fold(f, l, a):
    """
    f: the function to apply
    l: the list to fold
    a: the accumulator, who is also the 'zero' on the first call
    """ 
    return a if(len(l) == 0) else fold(f, l[1:], f(a, l[0]))

print "Sum:", fold(lambda x, y : x+y, [1,2,3,4,5], 0)

print "Any:", fold(lambda x, y : x or y, [False, True, False], False)

print "All:", fold(lambda x, y : x and y, [False, True, False], True)

# Prove that result can be of a different type of the list's elements
print "Count(x==True):", 
print fold(lambda x, y : x+1 if(y) else x, [False, True, True], 0) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-28T18:45:41.743

这个（减少）问题的实际答案是：只需使用循环！

```
initial_value = 0
for x in the_list:
    initial_value += x #or any function. 
```

这将比 reduce 更快，并且 PyPy 之类的东西可以优化这样的循环。

顺便说一句，求和的情况应该用[`sum`](https://docs.python.org/3/library/functions.html#sum)函数来解决

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-04-04T16:35:07.727

我相信这个问题的一些受访者已经错过了`fold`函数作为抽象工具的更广泛含义。是的，`sum`可以对整数列表做同样的事情，但这是一个微不足道的案例。`fold`更通用。当您拥有一系列不同形状的数据结构并希望清晰地表达聚合时，它很有用。因此，不必`for`每次都必须使用聚合变量构建循环并手动重新计算它，而是一个`fold`函数（或`reduce`似乎对应的 Python 版本）允许程序员更清楚地表达聚合的意图，只需提供两件事情：

*   聚合的默认起始值​​或“种子”值。
*   一个函数，它获取聚合的当前值（以“种子”开头）和列表中的下一个元素，并返回下一个聚合值。

# c# - 如何判断是否已经设置了 out 参数？

> ID：10366378
> 
> 赞同：7
> 
> 时间：2012-04-28T18:31:44.813
> 
> 标签：c#, out

有没有办法知道是否已经设置了 out 参数。这是我正在寻找的伪代码：

```
public virtual string blabla(long num, out bool bval)
    {
        if (!bval.HasValue)
            {
            //Do some default logic
            bval = defaultValue;
            }

        return blabla2(num, bval);
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-28T18:34:37.560

你不能 -在你的方法中明确分配变量之前，你不能*读取变量。*您应该将其视为一个局部变量，在方法开始时声明但未分配任何值 - 但您*必须*在返回之前为其分配一个值。（如果抛出异常，可以不为其赋值。）

如果您想要一个将信息作为方法*输入*以及将信息传播出去的参数，您应该使用`ref`而不是`out`.

有关更多信息，请参阅[我关于参数传递](http://pobox.com/~skeet/csharp/parameters.html)的文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:34:26.217

除了[Jon 的](https://stackoverflow.com/a/10366405/452274)出色回答之外，如果您希望参数仍然是`out`，但需要查看它是否已在方法内的某个位置分配了值，您可以使用如下的本地可空类型：

```
public virtual string blabla(long num, out bool bval)
{
    bool? bvalLocal;

    ... //I'm assuming there is some code here that may or 
        //may not assign bvalLocal?

    // This whole if block may not be needed if the default
    // value is the default for the type (i.e. false) as
    // GetValueOrDefualt() will take care of that (see 
    // second to last line).
    if (!bvalLocal.HasValue)
    {
        //Do some default logic
        bvalLocal = defaultValue;
    }

    bval = bvalLocal.GetValueOrDefault();
    return blabla2(num, bval);
} 
```

# android - 布局与预览不匹配

> ID：10366381
> 
> 赞同：3
> 
> 时间：2012-04-28T18:31:55.773
> 
> 标签：android, android-linearlayout

我设计了一个在用户按下按钮时出现的操作表。这是一个单独的 xml 文件，我将其包含在另一个布局文件中。在布局预览中，它看起来完全符合我的要求。但是，当它在我的手机上运行时，布局混乱了。

以下是它的外观：

![应该看](../Images/bc363b1a5be7e0b16d0a0bc98ebdf97f.png)

这是它的外观： ![看起来](../Images/1b65c1af372619ff4c4595a3ca8d9c90.png)

有谁知道为什么会发生这种情况？

这是操作表的布局代码。未正确显示的部分位于最后一个线性布局中

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/sheet_header" >

        <ImageButton
            android:id="@+id/left_justified"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBottom="@+id/center_justified"
            android:layout_toLeftOf="@+id/center_justified"
            android:background="@android:color/transparent"
            android:src="@drawable/alignment_left" />

        <ImageButton
            android:id="@+id/center_justified"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="13dp"
            android:background="@android:color/transparent"
            android:src="@drawable/alignment_center" />

        <ImageButton
            android:id="@+id/right_justified"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBottom="@+id/center_justified"
            android:layout_toRightOf="@+id/center_justified"
            android:background="@android:color/transparent"
            android:src="@drawable/alignment_right" />

        <ImageButton
            android:id="@+id/close_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBottom="@+id/center_justified"
            android:background="@android:color/transparent"
            android:layout_alignParentRight="true"
            android:layout_alignTop="@+id/center_justified"
            android:layout_marginRight="10dp"
            android:src="@drawable/sheet_done_btn"
            />
    </RelativeLayout>

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/sheet_background"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="15dp" >

            <TextView
                android:id="@+id/font_text"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="Font"
                android:textColor="#806014"
                android:textSize="20sp" />

            <TextView
                android:id="@+id/size_text"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="Size"
                android:textColor="#806014"
                android:textSize="20sp" />

            <TextView
                android:id="@+id/color_text"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="Color"
                android:textColor="#806014"
                android:textSize="20sp" />
        </LinearLayout>
    </LinearLayout>

</LinearLayout> 
```

以下是它的包含方式：

```
<FrameLayout 
    android:layout_alignParentBottom="true"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:id="@+id/edit_text_frame">  

    <include layout="@layout/edit_text"/>
</FrameLayout> 
```

编辑：除了针对这个特定问题的修复之外，还有人知道为什么预览与手机上实际显示的方式不匹配吗？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:54:10.497

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/sheet_header" >

        <ImageButton
            android:id="@+id/left_justified"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBottom="@+id/center_justified"
            android:layout_toLeftOf="@+id/center_justified"
            android:background="@android:color/transparent"
            android:src="@drawable/alignment_left" />

        <ImageButton
            android:id="@+id/center_justified"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="13dp"
            android:background="@android:color/transparent"
            android:src="@drawable/alignment_center" />

        <ImageButton
            android:id="@+id/right_justified"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBottom="@+id/center_justified"
            android:layout_toRightOf="@+id/center_justified"
            android:background="@android:color/transparent"
            android:src="@drawable/alignment_right" />

        <ImageButton
            android:id="@+id/close_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBottom="@+id/center_justified"
            android:background="@android:color/transparent"
            android:layout_alignParentRight="true"
            android:layout_alignTop="@+id/center_justified"
            android:layout_marginRight="10dp"
            android:src="@drawable/sheet_done_btn"
            />
    </RelativeLayout>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="15dp" 
        android:background="@drawable/sheet_background"
        android:orientation="vertical" >

            <TextView
                android:id="@+id/font_text"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:gravity="center"
                android:text="Font"
                android:textColor="#806014"
                android:textSize="20sp" />

            <TextView
                android:id="@+id/size_text"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:gravity="center"
                android:text="Size"
                android:textColor="#806014"
                android:textSize="20sp" />

            <TextView
                android:id="@+id/color_text"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:gravity="center"
                android:text="Color"
                android:textColor="#806014"
                android:textSize="20sp" />
        </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T21:17:56.157

您可以将字体、大小、颜色 TextViews 放入表格布局中。

# fullcalendar - FullCalendar 事件在事件时间/标题周围有太多顶部/底部填充

> ID：10366386
> 
> 赞同：0
> 
> 时间：2012-04-28T18:32:23.313
> 
> 标签：fullcalendar

我是 FullCalendar 的新手，已下载并添加到 php 项目中。根据示例添加了一个事件（硬编码），它显示得很好，除了事件的高度非常高。看起来文本上方和下方都有填充，与我看到的所有示例不同，其中事件是很好的薄块。

我已经研究并找到了降低事件高度的代码，但是当我这样做时，它会切断事件时间和标题的底部。

例如，我添加了 .fc-event { height: 1em; 并且它使事件看起来更像所有示例但正如我提到的，它只切断事件底部并切断时间和标题的底部（无法读取事件）。

这是图片的链接[http://snappdf.tumblr.com/](http://snappdf.tumblr.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T23:54:10.323

使用 .fc-event 更改日历上所有事件的 CSS。您可能更喜欢使用事件的 className 属性。通过这种方式，您可以自定义单个事件而不会产生影响。

另外，请发布一些代码或更好的 jsfiddle 以更好地理解问题。

# javascript - 暂停 Javascript 执行，直到按下按钮

> ID：10366387
> 
> 赞同：8
> 
> 时间：2012-04-28T18:32:30.680
> 
> 标签：javascript, html

我正在为我的算法类（在 Javascript 中）创建数独创建者的可视化。该算法效果很好，但我无法找到暂停执行的方法。

目前，我习惯于`prompt()`暂停，但这既笨重又烦人。`while`除了连续循环之外，有没有办法暂停直到另一个函数运行（通过 HTML 按钮） ？

我可以发布代码，但我认为不需要。我目前没有使用 jQuery，但如果需要我可以。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-28T18:34:40.133

```
var flag = true;
function foo(){
    if (flag){
        // Do your magic here
        ...
        ...
        setTimeout(foo, 100);
    }
}

function stop(){
    flag = false;
}
<input type="button" onclick="stop();" value="stop it!!!" /> 
```

[**现场演示**](http://jsfiddle.net/JseE2/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-16T00:22:33.153

如果您要暂停的是一个会继续循环的函数，那么我想出了一个很好的解决方案：

**HTML**

```
<div id="stuff">Doing stuff</div>
<button id="pause">Pause/Resume</button> 
```

**JS**

```
var paused = false;

document.getElementById('pause').addEventListener('click', function() {
  paused = !paused;
  if (!paused) {
    next();
  }
});

function doStuff() {
  // Do whatever you want here, then invoke next() for the next iteration of that function, for example:
  // (Note that the window.setTimeout is NOT part of the solution)
  window.setTimeout(function() {
    document.getElementById('stuff').append('.');
    next();
  }, 300);
}

function next() {
  if (!paused) {
    doStuff();
  }
}

doStuff(); 
```

**[代码笔： https](https://codepen.io/liranh85/pen/baVqzY?editors=1010) **://codepen.io/liranh85/pen/baVqzY ?editors=1010****

# android - 使用独立 NDK 工具链构建协议缓冲区

> ID：10366389
> 
> 赞同：3
> 
> 时间：2012-04-28T18:32:42.457
> 
> 标签：android, android-ndk, protocol-buffers

我在使用 $NDK/build/tools/make-standalone-toolchain.sh 脚本创建的独立 NDK 工具链为 Android 构建协议缓冲区时遇到问题。我遇到的问题是这样的：

```
libtool: link: g++ -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare -O2 -g -DNDEBUG -o protoc main.o  ./.libs/libprotobuf.a ./.libs/libprotoc.a /home/sizeak/AudioFingerprinting/ProtoBuf/jni/src/.libs/libprotobuf.a -lz -lc
./.libs/libprotoc.a(plugin.pb.o): In function `GoogleOnceInit':
/home/sizeak/AudioFingerprinting/ProtoBuf/jni/src/./google/protobuf/stubs/once.h:115: undefined reference to `pthread_once' 
```

这似乎意味着缺少 pthreads 库，但是 sysroot 是由 ndk 脚本创建的，因此应该包含所有内容，对吧？我在某处读到，使用独立工具链时无需显式链接 pthread。我使用的配置命令是：

```
./configure --host=arm-eabi --with-sysroot=$SYSROOT CC=$CC --enable-cross-compile --with-protoc=protoc LIBS="-lc" 
```

环境变量设置为指向脚本创建的 sysroot。

我在网上的许多页面上都看到了这个问题，但似乎没有人发布答案。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T01:23:02.810

我设法使用 ndk-build 方法构建它，使用此处找到的信息：[如何通过 Android NDK 构建协议缓冲区](https://stackoverflow.com/questions/7144008/how-to-build-protocol-buffer-by-android-ndk)

为了设置配置脚本，我运行了以下命令：

```
export CFLAGS="-march=armv7-a -mfloat-abi=softfp -DGOOGLE_PROTOBUF_NO_RTTI"
export CC=arm-linux-androideabi-gcc
export SYSROOT=$NDK/platforms/android-9/arch-arm
./configure --host=arm-eabi --with-sysroot=$SYSROOT CC=$CC --enable-cross-compile --with-protoc=protoc LIBS="-lc" 
```

这是我使用的 Application.mk：

```
APP_STL := gnustl_static
APP_ABI := armeabi-v7a armeabi
APP_PROJECT_PATH := ./
APP_BUILD_SCRIPT := ./Android.mk 
```

Android.mk 使用：

```
# Copyright (C) 2009 The Android Open Source Project
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
#

LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
CC_LITE_SRC_FILES := \
src/google/protobuf/stubs/common.cc                              \
src/google/protobuf/stubs/once.cc                                \
src/google/protobuf/extension_set.cc                             \
src/google/protobuf/generated_message_util.cc                    \
src/google/protobuf/message_lite.cc                              \
src/google/protobuf/repeated_field.cc                            \
src/google/protobuf/wire_format_lite.cc                          \
src/google/protobuf/io/coded_stream.cc                           \
src/google/protobuf/io/zero_copy_stream.cc                       \
src/google/protobuf/io/zero_copy_stream_impl_lite.cc

COMPILER_SRC_FILES :=  \
src/google/protobuf/descriptor.cc \
src/google/protobuf/descriptor.pb.cc \
src/google/protobuf/descriptor_database.cc \
src/google/protobuf/dynamic_message.cc \
src/google/protobuf/extension_set.cc \
src/google/protobuf/extension_set_heavy.cc \
src/google/protobuf/generated_message_reflection.cc \
src/google/protobuf/generated_message_util.cc \
src/google/protobuf/message.cc \
src/google/protobuf/message_lite.cc \
src/google/protobuf/reflection_ops.cc \
src/google/protobuf/repeated_field.cc \
src/google/protobuf/service.cc \
src/google/protobuf/text_format.cc \
src/google/protobuf/unknown_field_set.cc \
src/google/protobuf/wire_format.cc \
src/google/protobuf/wire_format_lite.cc \
src/google/protobuf/compiler/code_generator.cc \
src/google/protobuf/compiler/command_line_interface.cc \
src/google/protobuf/compiler/importer.cc \
src/google/protobuf/compiler/main.cc \
src/google/protobuf/compiler/parser.cc \
src/google/protobuf/compiler/plugin.cc \
src/google/protobuf/compiler/plugin.pb.cc \
src/google/protobuf/compiler/subprocess.cc \
src/google/protobuf/compiler/zip_writer.cc \
src/google/protobuf/compiler/cpp/cpp_enum.cc \
src/google/protobuf/compiler/cpp/cpp_enum_field.cc \
src/google/protobuf/compiler/cpp/cpp_extension.cc \
src/google/protobuf/compiler/cpp/cpp_field.cc \
src/google/protobuf/compiler/cpp/cpp_file.cc \
src/google/protobuf/compiler/cpp/cpp_generator.cc \
src/google/protobuf/compiler/cpp/cpp_helpers.cc \
src/google/protobuf/compiler/cpp/cpp_message.cc \
src/google/protobuf/compiler/cpp/cpp_message_field.cc \
src/google/protobuf/compiler/cpp/cpp_primitive_field.cc \
src/google/protobuf/compiler/cpp/cpp_service.cc \
src/google/protobuf/compiler/cpp/cpp_string_field.cc \
src/google/protobuf/compiler/java/java_enum.cc \
src/google/protobuf/compiler/java/java_enum_field.cc \
src/google/protobuf/compiler/java/java_extension.cc \
src/google/protobuf/compiler/java/java_field.cc \
src/google/protobuf/compiler/java/java_file.cc \
src/google/protobuf/compiler/java/java_generator.cc \
src/google/protobuf/compiler/java/java_helpers.cc \
src/google/protobuf/compiler/java/java_message.cc \
src/google/protobuf/compiler/java/java_message_field.cc \
src/google/protobuf/compiler/java/java_primitive_field.cc \
src/google/protobuf/compiler/java/java_service.cc \
src/google/protobuf/compiler/javamicro/javamicro_enum.cc \
src/google/protobuf/compiler/javamicro/javamicro_enum_field.cc \
src/google/protobuf/compiler/javamicro/javamicro_field.cc \
src/google/protobuf/compiler/javamicro/javamicro_file.cc \
src/google/protobuf/compiler/javamicro/javamicro_generator.cc \
src/google/protobuf/compiler/javamicro/javamicro_helpers.cc \
src/google/protobuf/compiler/javamicro/javamicro_message.cc \
src/google/protobuf/compiler/javamicro/javamicro_message_field.cc \
src/google/protobuf/compiler/javamicro/javamicro_primitive_field.cc \
src/google/protobuf/compiler/python/python_generator.cc \
src/google/protobuf/io/coded_stream.cc \
src/google/protobuf/io/gzip_stream.cc \
src/google/protobuf/io/printer.cc \
src/google/protobuf/io/tokenizer.cc \
src/google/protobuf/io/zero_copy_stream.cc \
src/google/protobuf/io/zero_copy_stream_impl.cc \
src/google/protobuf/io/zero_copy_stream_impl_lite.cc \
src/google/protobuf/stubs/common.cc \
src/google/protobuf/stubs/once.cc \
src/google/protobuf/stubs/structurally_valid.cc \
src/google/protobuf/stubs/strutil.cc \
src/google/protobuf/stubs/substitute.cc

# C++ full library
# =======================================================
#include $(CLEAR_VARS)

LOCAL_MODULE := libprotobuf-lite
LOCAL_MODULE_TAGS := optional

LOCAL_CPP_EXTENSION := .cc

LOCAL_SRC_FILES := \
$(CC_LITE_SRC_FILES)                                             #\
#src/google/protobuf/stubs/strutil.cc                             \
#src/google/protobuf/stubs/substitute.cc                          \
#src/google/protobuf/stubs/structurally_valid.cc                  \
#src/google/protobuf/descriptor.cc                                \
#src/google/protobuf/descriptor.pb.cc                             \
#src/google/protobuf/descriptor_database.cc                       \
#src/google/protobuf/dynamic_message.cc                           \
#src/google/protobuf/extension_set_heavy.cc                       \
#src/google/protobuf/generated_message_reflection.cc              \
#src/google/protobuf/message.cc                                   \
#src/google/protobuf/reflection_ops.cc                            \
#src/google/protobuf/service.cc                                   \
#src/google/protobuf/text_format.cc                               \
#src/google/protobuf/unknown_field_set.cc                         \
#src/google/protobuf/wire_format.cc                               \
#src/google/protobuf/io/gzip_stream.cc                            \
#src/google/protobuf/io/printer.cc                                \
#src/google/protobuf/io/tokenizer.cc                              \
#src/google/protobuf/io/zero_copy_stream_impl.cc                  \
#src/google/protobuf/compiler/importer.cc                         \
#src/google/protobuf/compiler/parser.cc

LOCAL_C_INCLUDES := \
$(LOCAL_PATH)/src

LOCAL_C_INCLUDES := \
$(LOCAL_PATH)/android \
bionic \
$(LOCAL_PATH)/src \
$(JNI_H_INCLUDE)

LOCAL_SHARED_LIBRARIES := \
libz libcutils libutils
LOCAL_LDLIBS := -lz
# stlport conflicts with the host stl library
#ifneq ($(TARGET_SIMULATOR),true)
#LOCAL_C_INCLUDES += external/stlport/stlport
#LOCAL_SHARED_LIBRARIES += libstlport
#endif

# Define the header files to be copied
#LOCAL_COPY_HEADERS := \
#    src/google/protobuf/stubs/once.h \
#    src/google/protobuf/stubs/common.h \
#    src/google/protobuf/io/coded_stream.h \
#    src/google/protobuf/generated_message_util.h \
#    src/google/protobuf/repeated_field.h \
#    src/google/protobuf/extension_set.h \
#    src/google/protobuf/wire_format_lite_inl.h
#
#LOCAL_COPY_HEADERS_TO := $(LOCAL_MODULE)

LOCAL_CFLAGS := -DGOOGLE_PROTOBUF_NO_RTTI

include $(BUILD_SHARED_LIBRARY) 
```

要将构建的库包含在我正在使用 Protocol Buffers 的其他 NDK 项目中，我必须使用该库将该库复制到项目的 jni 文件夹中，并修改其 Android.mk 以添加对它的引用：

```
...
...
LOCAL_LDLIBS := -llog -lOpenSLES -lGLESv2 jni/libprotobuf-lite.so   
include $(BUILD_SHARED_LIBRARY)

include $(CLEAR_VARS)

LOCAL_MODULE := protobuf-lite
LOCAL_SRC_FILES := libprotobuf-lite.so 

include $(PREBUILT_SHARED_LIBRARY) 
```

我想就是这样，希望有人觉得它有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-02T16:56:43.417

我很难在 Windows 上使用 ndk-build 为 android 构建 Protobuf，但设法使用： - Cygwin - android-ndk-r12b

这些步骤适用于 protobuf 3.6.1。步骤： - 克隆 protobuf repo - 在 repo 的根目录下，创建一个名为“jni”的新文件夹 (/path/to/repo/protobuf/jni) - 创建一个名为 Android.mk 的新文件，将以下行粘贴到其中

```
# Copyright (C) 2009 The Android Open Source Project
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
#

LOCAL_PATH := $(call my-dir)

IGNORED_WARNINGS := -Wno-sign-compare -Wno-unused-parameter -Wno-sign-promo -Wno-error=return-type

COMPILER_SRC_FILES := \
    ../src/google/protobuf/arena.cc \
    ../src/google/protobuf/arenastring.cc \
    ../src/google/protobuf/extension_set.cc \
    ../src/google/protobuf/generated_message_table_driven_lite.cc \
    ../src/google/protobuf/generated_message_util.cc \
    ../src/google/protobuf/implicit_weak_message.cc \
    ../src/google/protobuf/io/coded_stream.cc \
    ../src/google/protobuf/io/zero_copy_stream.cc \
    ../src/google/protobuf/io/zero_copy_stream_impl_lite.cc \
    ../src/google/protobuf/message_lite.cc \
    ../src/google/protobuf/repeated_field.cc \
    ../src/google/protobuf/stubs/bytestream.cc \
    ../src/google/protobuf/stubs/common.cc \
    ../src/google/protobuf/stubs/int128.cc \
    ../src/google/protobuf/stubs/io_win32.cc \
    ../src/google/protobuf/stubs/status.cc \
    ../src/google/protobuf/stubs/statusor.cc \
    ../src/google/protobuf/stubs/stringpiece.cc \
    ../src/google/protobuf/stubs/stringprintf.cc \
    ../src/google/protobuf/stubs/structurally_valid.cc \
    ../src/google/protobuf/stubs/strutil.cc \
    ../src/google/protobuf/stubs/time.cc \
    ../src/google/protobuf/wire_format_lite.cc \
    ../src/google/protobuf/any.cc \
    ../src/google/protobuf/any.pb.cc \
    ../src/google/protobuf/api.pb.cc \
    ../src/google/protobuf/compiler/importer.cc \
    ../src/google/protobuf/compiler/parser.cc \
    ../src/google/protobuf/descriptor.cc \
    ../src/google/protobuf/descriptor.pb.cc \
    ../src/google/protobuf/descriptor_database.cc \
    ../src/google/protobuf/duration.pb.cc \
    ../src/google/protobuf/dynamic_message.cc \
    ../src/google/protobuf/empty.pb.cc \
    ../src/google/protobuf/extension_set_heavy.cc \
    ../src/google/protobuf/field_mask.pb.cc \
    ../src/google/protobuf/generated_message_reflection.cc \
    ../src/google/protobuf/generated_message_table_driven.cc \
    ../src/google/protobuf/io/gzip_stream.cc \
    ../src/google/protobuf/io/printer.cc \
    ../src/google/protobuf/io/strtod.cc \
    ../src/google/protobuf/io/tokenizer.cc \
    ../src/google/protobuf/io/zero_copy_stream_impl.cc \
    ../src/google/protobuf/map_field.cc \
    ../src/google/protobuf/message.cc \
    ../src/google/protobuf/reflection_ops.cc \
    ../src/google/protobuf/service.cc \
    ../src/google/protobuf/source_context.pb.cc \
    ../src/google/protobuf/struct.pb.cc \
    ../src/google/protobuf/stubs/mathlimits.cc \
    ../src/google/protobuf/stubs/substitute.cc \
    ../src/google/protobuf/text_format.cc \
    ../src/google/protobuf/timestamp.pb.cc \
    ../src/google/protobuf/type.pb.cc \
    ../src/google/protobuf/unknown_field_set.cc \
    ../src/google/protobuf/util/delimited_message_util.cc \
    ../src/google/protobuf/util/field_comparator.cc \
    ../src/google/protobuf/util/field_mask_util.cc \
    ../src/google/protobuf/util/internal/datapiece.cc \
    ../src/google/protobuf/util/internal/default_value_objectwriter.cc \
    ../src/google/protobuf/util/internal/error_listener.cc \
    ../src/google/protobuf/util/internal/field_mask_utility.cc \
    ../src/google/protobuf/util/internal/json_escaping.cc \
    ../src/google/protobuf/util/internal/json_objectwriter.cc \
    ../src/google/protobuf/util/internal/json_stream_parser.cc \
    ../src/google/protobuf/util/internal/object_writer.cc \
    ../src/google/protobuf/util/internal/proto_writer.cc \
    ../src/google/protobuf/util/internal/protostream_objectsource.cc \
    ../src/google/protobuf/util/internal/protostream_objectwriter.cc \
    ../src/google/protobuf/util/internal/type_info.cc \
    ../src/google/protobuf/util/internal/type_info_test_helper.cc \
    ../src/google/protobuf/util/internal/utility.cc \
    ../src/google/protobuf/util/json_util.cc \
    ../src/google/protobuf/util/message_differencer.cc \
    ../src/google/protobuf/util/time_util.cc \
    ../src/google/protobuf/util/type_resolver_util.cc \
    ../src/google/protobuf/wire_format.cc \
    ../src/google/protobuf/wrappers.pb.cc \

include $(CLEAR_VARS)

LOCAL_MODULE := libprotobuf
LOCAL_CPP_EXTENSION := .cc
LOCAL_SRC_FILES := $(COMPILER_SRC_FILES)

LOCAL_C_INCLUDES := \
    $(LOCAL_PATH)/../android \
    $(LOCAL_PATH)/../src

LOCAL_CFLAGS := -frtti -DHAVE_PTHREAD $(IGNORED_WARNINGS)

LOCAL_EXPORT_C_INCLUDE_DIRS := $(LOCAL_PATH)/../src

LOCAL_CPPFLAGS := -std=c++11
LOCAL_C_INCLUDES += ${ANDROID_NDK}sources/cxx-stl/gnu-libstdc++/4.9/include
LOCAL_C_INCLUDES += ${ANDROID_NDK}sources/cxx-stl/gnu-libstdc++/4.9/libs/$(APP_ABI)/include
LOCAL_C_INCLUDES += ${ANDROID_NDK}platforms/${APP_PLATFORM}/arch-$(TARGET_ARCH)/usr/include
LOCAL_LDLIBS += -lz -llog
LOCAL_STATIC_LIBRARIES += -lpthread
LOCAL_EXPORT_LDLIBS += -lz
LOCAL_EXPORT_CFLAGS := $(LOCAL_CFLAGS)
LOCAL_EXPORT_CPPFLAGS := $(LOCAL_CPPFLAGS)
include $(BUILD_SHARED_LIBRARY) 
```

*   创建一个名为 Application.mk 的文件并将以下代码粘贴到其中

> ```
> APP_STL := gnustl_static
> APP_ABI := armeabi-v7a
> APP_PLATFORM:=android-27 
> ```

*   启动 cygwin 并导航到 protobuf 存储库。
*   运行`./Configure`（如果失败，可能是因为您缺少 cygwin 中的一些工具。安装它们）
*   导出指向ndk文件夹根目录的ANDROID_NDK环境变量
*   在PATH环境变量中添加ndk-build工具的路径
*   跑`ndk-build`

应使用 libprotobuf.so 为您在 application.mk 中指定的体系结构创建一个“libs”文件夹

希望这可以帮助

# ruby - 索引和比较字符串索引或哈希

> ID：10366392
> 
> 赞同：0
> 
> 时间：2012-04-28T18:33:03.417
> 
> 标签：ruby, string, comparison

我想清理我的音乐库，将注意力集中在系统上双打最多的歌曲上。我可以将它们全部列出，排序并手动完成，但这会花费太长时间。我希望列表对最可能的重复项进行排序。因此，如果一首歌曲有 10 个重复，则意味着有 10 个歌曲名称彼此相似，因此我会首先将注意力集中在这首歌上，以保留最佳版本。

我可以使用 levenshtein 字符串比较技术和 gem 来比较两个歌曲名

```
require 'levenshtein'
Levenshtein.distance("string1", "string2") => 1 
```

但是假设我有 x 首歌曲，我必须将每首歌曲比较 x 次，因为我不能依赖正常的文件排序，然后我会错过一些重复的歌曲。例如

```
The Beatles - Hey Jude
Beatles, The - hey jude
Beatles_-_Hey_Judy_(remastered) 
```

应该给披头士乐队 - 嘿朱迪（x3）

有没有办法根据文件名生成索引，然后可以排序并按降序给出所有重复项？一种可以比较的哈希？

我知道其他音乐比较方法，但它们有缺陷，这也可以用于比较其他类型的文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:06:29.350

尝试使用此代码

`files`是文件名数组，`max_distance`是考虑名称相似的最大距离。

```
hash = {}
files.each do |file|
  similar = hash.keys.select { |f| Levenshtein.distance(f, file) < max_distance }
  if similar.any?
    hash[similar.first] += 1
  else
    hash.merge!({file => 0})
  end
end 
```

之后，您将获得`hash`，其中文件名作为键，“重复”计为值，您可以根据需要对其进行排序。

# ruby-on-rails - Rails & Heroku：很抱歉，出了点问题

> ID：10366394
> 
> 赞同：2
> 
> 时间：2012-04-28T18:33:09.947
> 
> 标签：ruby-on-rails, heroku

我收到了臭名昭著的“我们很抱歉，但出了点问题”。错误。谷歌搜索它指向 Omniauth 问题 - 但我没有改变太多（如果有的话）omniauth 的东西，并且在我上次将它部署到 heroku 时让它工作。

顺便说一句，我将它部署在雪松堆栈上。

任何想法可能是什么问题？

Heroku 日志：

```
2012-04-28T18:26:06+00:00 heroku[router]: GET myapp.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=13ms status=500 bytes=643
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal.rb:203:in `dispatch'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/routing/route_set.rb:67:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/routing/route_set.rb:30:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.3/lib/journey/router.rb:68:in `block in call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.3/lib/journey/router.rb:56:in `each'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.3/lib/journey/router.rb:56:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/omniauth-1.0.3/lib/omniauth/strategy.rb:168:in `call!'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/routing/route_set.rb:594:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/omniauth-1.0.3/lib/omniauth/strategy.rb:148:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/manager.rb:35:in `block in call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/manager.rb:34:in `catch'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/conditionalget.rb:25:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/manager.rb:34:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/head.rb:14:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/params_parser.rb:21:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/flash.rb:242:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/cookies.rb:338:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/query_cache.rb:64:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:405:in `_run__2587592208680042819__call__3254396045512618553__callbacks'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:405:in `__run_callback'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/rack/logger.rb:26:in `call_app'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/rack/logger.rb:16:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/request_id.rb:22:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/static.rb:61:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/engine.rb:479:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/content_length.rb:14:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/application.rb:220:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/rack/log_tailer.rb:14:in `call'
2012-04-28T18:26:06+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
2012-04-28T18:26:06+00:00 app[web.1]: 
2012-04-28T18:26:06+00:00 app[web.1]: 
2012-04-28T18:26:06+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'
2012-04-28T18:26:06+00:00 app[web.1]: cache: [GET /] miss 
```

我还注意到以下几点：

```
2012-04-28T18:26:06+00:00 app[web.1]:   * "/app/app/views"
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/renderer/renderer.rb:36:in `render_template'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/renderer/template_renderer.rb:10:in `render'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/renderer/template_renderer.rb:29:in `determine_template'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/rendering.rb:109:in `_render_template'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/renderer/renderer.rb:17:in `render'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/streaming.rb:225:in `_render_template'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/rendering.rb:103:in `render_to_body'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/renderers.rb:28:in `render_to_body'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/compatibility.rb:50:in `render_to_body'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/rendering.rb:16:in `render'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/rendering.rb:88:in `render'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/core_ext/benchmark.rb:5:in `block in ms'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'
2012-04-28T18:26:06+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/benchmark.rb:310:in `realtime'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/core_ext/benchmark.rb:5:in `ms'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:40:in `block in render'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:39:in `render'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/implicit_render.rb:10:in `default_render'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/implicit_render.rb:5:in `send_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/base.rb:167:in `process_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/rendering.rb:10:in `process_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:405:in `__run_callback'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:414:in `_run__3927484994384413162__process_action__1065190525946390676__callbacks'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/callbacks.rb:17:in `process_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/rescue.rb:29:in `process_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/notifications.rb:123:in `block in instrument'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:29:in `process_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/notifications.rb:123:in `instrument'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/params_wrapper.rb:205:in `process_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/rendering.rb:45:in `process'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/railties/controller_runtime.rb:18:in `process_action'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/base.rb:121:in `process'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
2012-04-28T18:26:06+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal.rb:246:in `block in action' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T08:56:28.083

这似乎真的出乎意料，但解决我的问题是在资产组中拥有 haml gem。我从那个特定的组中取出它，它解决了我的问题。不知道为什么。

# java - 可以在 JSF 2 配置文件中将 Flash.keepMessage 设置为 true 吗？

> ID：10366395
> 
> 赞同：0
> 
> 时间：2012-04-28T18:33:24.437
> 
> 标签：java, jsf, jsf-2, messages, flash-scope

这一行：

```
FacesContext.getCurrentInstance().getExternalContext().getFlash().setKeepMessages(true); 
```

可以由任何配置文件中的其他代码更改吗？当我需要从这一行的代码重定向时，我想避免输入这一行：

```
 FacesContext.getCurrentInstance().getExternalContext().redirect("errorApp"); 
```

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T04:06:25.263

没有配置设置来更改“保留消息”功能。

只需创建一个实用方法，通过单个方法调用替换重复的代码。例如

```
public static void addGlobalInfoFlashMessage(String message) {
    FacesContext context = FacesContext.getCurrentInstance();
    context.getExternalContext().getFlash().setKeepMessages(true);
    context.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, message, null));
} 
```

# map - cics如何自动更新时间

> ID：10366400
> 
> 赞同：-1
> 
> 时间：2012-04-28T18:34:16.403
> 
> 标签：map, db2, cobol, cics

我有两个问题首先是主要问题。1\. 我能够在 cics 地图中显示日期，但我需要的是，我希望它在滴答作响，即它应该每秒显示一次更新。2\. 我有一个 COBOL-DB2 程序，它自动将数据库（DB2）中的数据插入到文件中。我希望在时间戳的基础上调用这个程序，即每 1 小时、2 小时或每天。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T12:54:03.437

您可以这样做，但您需要更改修改传统的伪对话方法。无需返回并等待用户事件，您可以在几秒钟后使用当前的 commarea 启动您的 tran 并退出。如果在那段时间发生了用户事件，您可以取消您的启动请求，如果没有，您可以刷新屏幕时间戳并重复。

刷新时间戳有点痛苦。除非您有充分的理由，否则打扰没有多大意义。

DB2 的东西很简单。使用间隔控制启动您的 tran，与上述相同的 START AFTER()，您可以让它每小时运行一次，或每两小时运行一次，或其他任何方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-05T22:51:54.457

我不认为你需要修改你的伪对话方法来实现你所需要的。只需为仅向终端设备发出发送映射（或 TC 写入）的小程序发出带有一秒延迟的 EXEC CICS START 命令（只需执行一次）。理想情况下，在屏幕上保留一个公共区域，以便所有交易都可以使用一个公共程序。在某些时候，当不再需要更新时，取消 START 请求。在我看来，计时器更新事务将与用户启动的事务流很好地混合。如果启动计时器弹出时用户事务处于活动状态，则计时器更新程序将延迟一点。

虽然这应该可行，但您需要记住，您每小时可能会为每个用户推动 3,600 笔交易。这个功能真的值得吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T04:30:17.070

这在使用地图的标准 CICS 中是不可能的。3270 协议不适合不断更新屏幕。大多数自动更新屏幕（例如控制台和监控显示）都使用本地 VTAM 方法，构建自己的数据流。

可以使用未格式化的数据来执行此操作，但我不建议在 CICS 中使用它。伪对话式 CICS 在屏幕显示期间没有程序可以控制，因此非常不鼓励使用对话式编程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-06T20:25:02.343

您不能在 CICS 中真正做到这一点，它充其量是为伪交互式响应而设计的。它设计用于向您的终端发送整个页面或屏幕的大型机，程序读取接收到的屏幕（其中有一些用户将更新的字段，如果您没有更改它们，则终端不会发回数据) 然后，CICS 事务已经占据了包含更改的屏幕的一部分，发送回响应并退出。

这使得数据输入和查询程序非常有效。但是要意识到，当程序处理完屏幕后，它就退出了，它消失了，甚至不再在内存中，所有的资源都被回收了。这允许公司运行一个有 300 个终端和可能 10 兆实际内存的大型机，因为当程序等待你响应时，它根本不使用任何资源，如果有 200 人运行数据输入程序，他们正在运行一个可重入程序，其中所有 200 人都在运行同一个程序的相同副本，他们唯一使用的可能是每个用户 1K 的可写存储空间，用于必须读取屏幕或文件的部分记录并做一些计算。想想看，有 200 个人在运行同一个程序，而且他们所有人同时，

想一想，第一个启动该数据输入程序的用户使用 20K 的内存用于应用程序，外加 1K 用于可写数据。之后在该程序上处理的每个用户使用额外的 1K 内存，仅此而已。当他们坐在那里看着终端时，他们可能只使用表格中的 4 个字节来告诉系统有一个终端连接。根本没有使用任何资源。

能够定期更新屏幕意味着必须保持运行，这不是 CICS 做得很好的事情。CICS 不打算像 PC 那样用于交互式处理，因为您实际上是在 PC 上实时运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-28T03:08:17.430

EXEC CICS ASK TIME END-EXEC 更新时间戳。EXEC CICS SEND MAP DATA ONLY END-EXEC 更新屏幕。

但是，使用建议的 EXEC CICS START TRANSID ('name' | namefld) DELAY (time) END-EXEC。实际上是更好的方法。

# c++ - 快速线程同步

> ID：10366401
> 
> 赞同：2
> 
> 时间：2012-04-28T18:34:21.843
> 
> 标签：c++, c, multithreading, pthreads

我正在开发一个具有多个线程和一个共享对象的系统。有许多线程经常执行读取操作，但写入操作很少，每天可能 3 到 5 次。

我正在使用 rwlock 进行同步，但是锁获取操作不够快，因为它一直在发生。所以，我正在寻找一种更快的方法。

也许是一种使写入函数原子化或在写入期间查看所有线程的方法。可移植性这不是硬性要求，我使用的是带有 GCC 4.6 的 Linux。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T21:12:04.220

您是否考虑过将 read-copy-update 与[liburcu](http://lttng.org/urcu)一起使用？这使您可以避免原子操作并*完全*锁定在读取路径上，但代价是写入速度要慢一些。请注意，一些读者可能会在短时间内看到陈旧的数据；如果您需要更新立即生效，它可能不是您的最佳选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T19:04:53.363

您可能想要使用多个对象而不是单个对象。与其实际共享对象，不如创建一个包含对象和原子计数的对象，然后在线程之间共享*指向*该结构的指针。

【假设只有一个写者】每个读者都会得到指针，然后原子地递增计数器并使用对象，读完后原子地递减计数器。作者将创建一个包含原始副本的新对象并对其进行修改。然后执行两个指针的原子交换。现在问题是释放旧对象，这就是为什么你需要读者的数量。作者需要继续检查旧对象的计数，直到所有读者都完成了工作，此时您可以删除旧对象。

如果有多个写入器（即可以有多个线程更新变量），您可以采用相同的方法，但写入器需要对指针进行比较和交换交换。如果更新副本的指针已更改，则写入器重新启动进程（删除它的新对象，再次从指针复制并重试 CAS）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T01:55:59.747

也许您可以使用自旋锁，线程将忙于等待解锁。如果线程没有长时间锁定，它可能比互斥锁更有效，因为锁定和解锁是用更少的指令完成的。

spinlock 是 POSIX pthread 的一部分，虽然是可选的，所以我不知道它是否在您的系统上实现。我在 ubuntu 上的 C 程序中使用了它们，但必须使用 -std=gnu99 而不是 c99 进行编译。

# c# - C#实现中的二叉搜索树

> ID：10366402
> 
> 赞同：7
> 
> 时间：2012-04-28T18:34:24.417
> 
> 标签：c#, binary-tree

```
class Node
{
    public int data;
    public Node left, right;

    public Node(int data)
    {
        this.data = data;
        left = null;
        right = null;

    }
}

class BinaryTreeImp
{
    Node root;
    static int count = 0;

    public BinaryTreeImp()
    {
        root = null;

    }
    public Node addNode(int data)
    { 
        Node newNode = new Node(data);

        if (root == null)
        {
            root = newNode;

        }
        count++;
        return newNode;

    }

    public void insertNode(Node root,Node newNode )
    {
        Node temp;
        temp = root;

        if (newNode.data < temp.data)
            {
                if (temp.left == null)
                {
                    temp.left = newNode;

                }

                else
                {
                    temp = temp.left;
                    insertNode(temp,newNode);

                }
            }
            else if (newNode.data > temp.data)
            {
                if (temp.right == null)
                {
                    temp.right = newNode;

                }

                else 
                {
                    temp = temp.right;
                    insertNode(temp,newNode);
                }
            }
        }

    public void displayTree(Node root)
    {
        Node temp;
        temp = root;

        if (temp == null)
            return;
            displayTree(temp.left);
            System.Console.Write(temp.data + " ");
            displayTree(temp.right);

    }

    static void Main(string[] args)
    {
       BinaryTreeImp btObj = new BinaryTreeImp();
       Node iniRoot= btObj.addNode(5);

       btObj.insertNode(btObj.root,iniRoot);
       btObj.insertNode(btObj.root,btObj.addNode(6));
       btObj.insertNode(btObj.root,btObj.addNode(10));
       btObj.insertNode(btObj.root,btObj.addNode(2));
       btObj.insertNode(btObj.root,btObj.addNode(3));
       btObj.displayTree(btObj.root);

       System.Console.WriteLine("The sum of nodes are " + count);
       Console.ReadLine();

    }
} 
```

这是实现的代码。代码工作正常，但如果在 displayTree 函数中，我将其替换为

```
public void displayTree(Node root)
{
    Node temp;
    temp = root;

    while(temp!=null)
    {
        displayTree(temp.left);
        System.Console.Write(temp.data + " ");
        displayTree(temp.right);
    }

} 
```

导致无限循环。我不明白是什么原因造成的。另外我想知道是否有更好的方法在 C# 中实现 BST。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T18:53:01.620

我不确定你为什么需要这个循环，但回答你的问题：

```
while(temp!=null)
{
    displayTree(temp.left);
    System.Console.Write(temp.data + " ");
    displayTree(temp.right);
} 
```

此代码检查 if `temp`is not `null`，但它永远不会变为 null，因为*在*循环内您**只**对 temp 的叶子起作用。这就是为什么你有一个无限循环。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T18:56:33.197

您不需要 while 循环或`temp`变量，让递归为您完成工作：

```
public void displayTree(Node root)
{
    if(root == null) return;

    displayTree(root.left);
    System.Console.Write(root.data + " ");
    displayTree(root.right);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T18:58:30.043

temp 在开始时设置为 root，之后它的值永远不会改变

将您的功能重写为怎么样

```
public void displayTree(Node root)
{
     if (root == null)
       return;
     displayTree(root.left);
     Console.Write(...);
     displayTree(root.right);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-04T12:54:23.417

试试这个

```
 public void displayTree(Node root) 
    {
        Node temp;
        temp = root;

        if (temp != null)
        {
            displayTree(temp.left);
            Console.WriteLine(temp.data + " ");
            displayTree(temp.right);

        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-24T12:37:28.837

我只是在想你也可以对 add 函数使用递归。它可能看起来像这样

```
 private void Add(BinaryTree node, ref BinaryTree rootNode)
    {
        if (rootNode == null)
        {
            rootNode = node;
        }
        if (node.value > rootNode.value)
        {
            Add(node, ref rootNode.right);
        }
        if (node.value < rootNode.value)
        {

         Add(node, ref rootNode.left);
        }  
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-06T19:23:17.280

请参阅[https://msdn.microsoft.com/en-us/library/ms379572%28v=vs.80%29.aspx](https://msdn.microsoft.com/en-us/library/ms379572%28v=vs.80%29.aspx)。请参阅“遍历 BST 的节点”部分中的示例代码

另外...不要忘记查看 SortedDictionary 等。他们可能已经准备好您需要的 BST！[https://msdn.microsoft.com/en-us/library/f7fta44c.aspx](https://msdn.microsoft.com/en-us/library/f7fta44c.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-23T13:11:08.020

完整的二叉搜索树...用代码检查树是否平衡

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.RegularExpressions;

namespace BinarySearchTree
{

    public class Node
    {
        public Node(int iData)
        {
            data = iData;
            leftNode = null;
            rightNode= null;
        }
        public int data{get; set;}
        public Node leftNode{get; set;}
        public Node rightNode{get; set;}
    };
    public class Program
    {
        public static Node root = null;
        public static void Main(string[] args)
        {
            //Your code goes here
            Console.WriteLine("Hello, world!");
            root = new Node(20);
            InsertNode(root, new Node(10));
            InsertNode(root, new Node(15));
            InsertNode(root, new Node(13));
            InsertNode(root, new Node(11));
            InsertNode(root, new Node(12));
            InsertNode(root, new Node(25));
            InsertNode(root, new Node(22));
            InsertNode(root, new Node(23));
            InsertNode(root, new Node(27));
            InsertNode(root, new Node(26));

           if(CheckIfTreeIsBalanced(root))
           {
                Console.WriteLine("Tree is Balanced!");
           }
           else
           {
               Console.WriteLine("Tree is Not Balanced!");
           }
            PrintTree(root);
        }

        public static void PrintTree(Node root)
        {
           if(root == null) return;        
           Node temp = root;

           PrintTree(temp.leftNode);
           System.Console.Write(temp.data + " "); 
           PrintTree(temp.rightNode);

        }

        public static bool CheckIfTreeIsBalanced(Node root)
        {
            if(root != null)
            {
                if(root.leftNode != null && root.rightNode!= null)
                {
                    if(root.leftNode.data < root.data && root.rightNode.data > root.data)
                    {
                        return CheckIfTreeIsBalanced(root.leftNode)&&CheckIfTreeIsBalanced(root.rightNode);
                    }
                    else
                    {
                        return false;
                    }
                } 
                else if(root.leftNode != null)
                {
                    if(root.leftNode.data < root.data)
                    {
                        return CheckIfTreeIsBalanced(root.leftNode);
                    }
                    else
                    {
                        return false;
                    }
                }
                else if(root.rightNode != null)
                {
                    if(root.rightNode.data > root.data)
                    {
                        return CheckIfTreeIsBalanced(root.rightNode);
                    }
                    else
                    {
                        return false;
                    }
                }
            }
             return true;
        }

        public static void InsertNode(Node root, Node newNode )
        {
        Node temp;
        temp = root;

        if (newNode.data < temp.data)
            {
                if (temp.leftNode == null)
                {
                    temp.leftNode = newNode;

                }

                else
                {
                    temp = temp.leftNode;
                    InsertNode(temp,newNode);

                }
            }
            else if (newNode.data > temp.data)
            {
                if (temp.rightNode == null)
                {
                    temp.rightNode = newNode;

                }

                else 
                {
                    temp = temp.rightNode;
                    InsertNode(temp,newNode);
                }
            }
        }

    }
} 
```

输出 ：

```
Hello, world!
Tree is Balanced!
10 11 12 13 15 20 22 23 25 26 27 
```

# java - 将 JMenu 放在 Mac 菜单栏上

> ID：10366404
> 
> 赞同：3
> 
> 时间：2012-04-28T18:34:29.510
> 
> 标签：java, macos, swing, jmenu

我正在使用 Swing`JMenu`的 Mac 上创建一个 java 应用程序。我想使用屏幕顶部的菜单栏，但它一直将菜单栏放在框架本身中。如何在 Mac 上将菜单栏移动到屏幕顶部？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-28T18:43:01.453

您可以设置系统属性来执行此操作。[http://developer.apple.com/library/mac/#documentation/Java/Reference/Java_PropertiesRef/Articles/JavaSystemProperties.html](http://developer.apple.com/library/mac/#documentation/Java/Reference/Java_PropertiesRef/Articles/JavaSystemProperties.html)上的第一个示例提到用于`System.setProperty("apple.laf.useScreenMenuBar", "true");`将菜单放入菜单栏中。

# linux - Linux：在文件保存时触发 Shell 命令

> ID：10366411
> 
> 赞同：4
> 
> 时间：2012-04-28T18:35:29.760
> 
> 标签：linux, bash, filesystems, inotify

我想在修改文件时自动触发 shell 命令。我认为这可以通过注册 inotify 钩子和调用来在代码中完成`system`，但是是否有更高级别的 bash 命令可以完成此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-29T07:09:30.793

尝试 inotify 工具。我在复制链接时遇到问题（抱歉），但 GitHub 上有一个 wiki，你应该可以使用 G-search-engine 找到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:46:19.003

我没有解决您的问题的方法，但我发现了这个不错的程序，您可能会使用您要求的功能：[cwatch](https://github.com/kse/cwatch)

# java-me - Java ME 日历不显示

> ID：10366414
> 
> 赞同：2
> 
> 时间：2012-04-28T18:35:44.697
> 
> 标签：java-me, calendar, midp, lcdui

我一直在这里关注本教程：[链接到教程](http://www.developer.nokia.com/Community/Wiki/Building_a_Java_ME_Canvas_based_calendar/date_picker)。我似乎无法让应用程序正确显示。当我运行应用程序时，我希望从教程中看到像 CalendarCanvas 这样的屏幕，但我得到了这个：

![在此处输入图像描述](../Images/29f7f3a0cadc577fbb8ff68c5ebdc5da.png)

这是我的代码，我使用的是标准 MIDP 类。

创建日历类：

```
import java.util.Date;
import java.util.Calendar;
import javax.microedition.lcdui.*;
import javax.microedition.midlet.MIDlet;

public class CreateCalendar
{
    /**
     * Array of strings which holds data for the month and day 
     * for the calendar application.
     */
    static final String[] month_labels = new String[]
    {
        "January", "Febuary", "March", "April", "May", "June", "July", "August", "Sepetember", "October", "November", "Decemeber"
    };
    static final String[] weekdays_labels = new String[]
    {
        "Mon", "Tue", "Wed", "Thur", "Fri", "Sat", "Sun"
    };

    public int startWeekday = 0;
    public int padding = 1;
    public int borderWidth = 4;
    public int borderColor = 0x009900;

    /**
     * Weekday Labels
     */
    public Font weekdayFont = Font.getDefaultFont();
    public int weekdayBackgroundColor = 0x009900;
    public int weekdayColor = 0xffffff;

    /**
     * Month/Year Labels
     */
    public Font headerFont = Font.getDefaultFont();
    public int headerBackgroundColor = 0x009900;
    public int headerColor = 0xffffff;

    /**
     * Cells Labels
     */
    public Font font = Font.getDefaultFont();
    public int foreColor = 0xffffff;
    public int backgroundColor = 0x009900;
    public int selectedBackgroundColor = 0xCCFF00;
    public int selectedForegroundColor = 0xffffff;

    /**
     * Size properties 
     */
    int width = 0;
    int height = 0;
    int headerHeight = 0;
    int weekHeight = 0;
    int cellWidth = 0;
    int cellHeight = 0;

    /**
     * Internal time properties
     */
    long currentTimeStamp = 0;
    Calendar calendar = null;
    int weeks = 0;

    public CreateCalendar(Date date)
    {
    calendar = Calendar.getInstance();
    setDate(date);
    initialize();
    }

    public Date getSelectedDate()
    {
        return calendar.getTime();
    }

    public void setDate(Date d)
    {
        currentTimeStamp = d.getTime();
        calendar.setTime(d);
        this.weeks = (int)Math.ceil(((double)getStartWeekday() + getMonthDays()) / 7);
    }

    public void setDate(long timestamp)
    {
        setDate(new Date(timestamp));
    }

    public void initialize()
    {
        this.cellWidth = font.stringWidth("MM") + 2 * padding;
        this.cellHeight = font.getHeight() + 2 * padding;
        this.headerHeight = headerFont.getHeight() + 2 * padding;
        this.weekHeight = weekdayFont.getHeight() + 2 * padding;
        this.width = 7 * (cellWidth + borderWidth) + borderWidth;
        initHeight();
    }

    void initHeight()
    {
        this.height = headerHeight + weekHeight + this.weeks * (cellHeight + borderWidth) + borderWidth;
    }

    int getMonthDays()
    {
        int month = calendar.get(Calendar.MONTH);
        switch (month)
        {
            case 3:
            case 5:
            case 8:
            case 10:
                return 30;    
            case 1:
                int year = calendar.get(Calendar.YEAR);
                return (year % 4 == 0 && year % 100 != 0) || (year % 400 == 0) ? 29 : 28;
            default:
                return 31;
        }
    }

    int getStartWeekday()
    {
        Calendar c = Calendar.getInstance();
        c.set(Calendar.MONTH, calendar.get(Calendar.MONTH));
        c.set(Calendar.YEAR, calendar.get(Calendar.YEAR));
        c.set(Calendar.DAY_OF_MONTH, 1);
        return (c.get(Calendar.DAY_OF_WEEK) + 5) % 7;
    }

    public void KeyPressed(int key)
    {
        switch(key)
        {
            case Canvas.UP:
                go(-7);
                break;
            case Canvas.DOWN:
                go(7);
                break;
            case Canvas.RIGHT:
                go(1);
                break;
            case Canvas.LEFT:
                go(-1);
                break; 
        }
    }

    void go(int delta)
    {
        int prevMonth = calendar.get(Calendar.MONTH);
        setDate(currentTimeStamp + 864000000 * delta);
        if(calendar.get(Calendar.MONTH) != prevMonth)
        {
            initHeight();
        }
    }

    public void paint(Graphics g)
    {
        g.setColor(backgroundColor);
        g.fillRect(0, 0, width, height);
        g.setFont(headerFont);
        g.setColor(headerColor);
        g.drawString(month_labels[calendar.get(Calendar.MONTH)] + " " + calendar.get(Calendar.YEAR), width / 2, padding, Graphics.TOP | Graphics.HCENTER);
        g.translate(0, headerHeight);
        g.setColor(weekdayBackgroundColor);
        g.fillRect(0, 0, width, weekHeight);
        g.setColor(weekdayColor);
        g.setFont(weekdayFont);

        for(int i = 0; i < 7; i++)
        {
            g.drawString(weekdays_labels[(i + startWeekday) % 7], borderWidth + i * (cellWidth + borderWidth) + cellWidth / 2, padding, Graphics.TOP | Graphics.HCENTER);
        }

        g.translate(0, weekHeight);
        g.setColor(borderColor);

        for(int i = 0; i <= weeks; i++)
        {
            g.fillRect(0, i * (cellHeight + borderWidth), width, borderWidth);
        }
        for(int i = 0; i <=7; i++)
        {
            g.fillRect(i * (cellWidth + borderWidth), 0, borderWidth, height - headerHeight - weekHeight);
        }

        int days = getMonthDays();
        int dayIndex = (getStartWeekday() - this.startWeekday + 7) % 7;
        g.setColor(foreColor);
        int currentDay = calendar.get(Calendar.DAY_OF_MONTH);

        for(int i = 0; i < days; i++)
        {
            int weekday = (dayIndex + i) % 7;
            int row = (dayIndex + i) / 7;
            int x = borderWidth + weekday * (cellWidth + borderWidth) + cellWidth / 2;
            int y = borderWidth + row * (cellHeight + cellWidth) + padding;

            if(i + 1 == currentDay)
            {
                g.setColor(selectedBackgroundColor);
                g.fillRect(borderWidth + weekday * (cellWidth + borderWidth), borderWidth + row * (cellHeight + borderWidth), cellWidth, cellHeight);
                g.setColor(selectedForegroundColor);
            }

            g.drawString("" + (i + 1), x, y, Graphics.TOP | Graphics.HCENTER);

            if(i + 1 == currentDay)
            {
                g.setColor(foreColor);
            }
        }
        g.translate(0, - headerHeight - weekHeight);
    }

    private Date getTime() {
        throw new UnsupportedOperationException("Not yet implemented"); //TODO get current Time
    } 
```

CalFrontEnd 类（扩展 MIDlet）：

```
 public class CalFrontEnd extends MIDlet
{

  public CreateCalendar calendar;
  protected Display display;
  protected Form mainForm;

  public CalFrontEnd()
  {

  }

  public void startApp()
  {
       calendar = new CreateCalendar(new Date());
       calendar.headerFont = Font.getFont(Font.FACE_PROPORTIONAL, Font.STYLE_BOLD, Font.SIZE_LARGE);
       calendar.weekdayFont = Font.getFont(Font.FACE_PROPORTIONAL, Font.STYLE_BOLD, Font.SIZE_MEDIUM);
       calendar.weekdayBackgroundColor = 0xccccff;
       calendar.weekdayColor = 0x0000ff;
       calendar.headerColor = 0xffffff;
       calendar.initialize();

    display.getDisplay(this).setCurrent(
    new intCalendar(this));

  }

  public void pauseApp()
  {
  }

  public void destroyApp(boolean destroy)
  {
    notifyDestroyed();
  }
}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T10:49:57.893

类中的代码`CreateCalendar`看起来*很有*问题。

在[前面的问题](https://stackoverflow.com/questions/10364705/java-me-help-displaying-calendar-canvas-from-nokia-tutorial)中，您提到了对教程中的代码所做的*一些小的变量名称差异*，但从您的代码片段中显示的内容来看，情况并非如此。

要找到一种重用教程代码的方法，最直接的方法如下所示。

1.  从教程复制源代码 - 文件 CalendarWidget.java 和 CalendarCanvas.java**按原样**
    复制，仅在必要时调整包语句。

***   修改`CalFrontEnd`一下如下

    *   如果需要，为 CalendarCanvas 添加导入语句
    *   用最简单的 CalendarCanvas 调用替换 startApp 中的当前代码，如下所示：

        ```
        公共无效startApp（）{
             Display.getDisplay(this).setCurrent(
                     新的 CalendarCanvas(this));
         }
        ```

        *   测试代码，调整并修复它，直到您的 MIDlet 显示您对 CalendarCanvas 的期望

    *   完成上述操作后，继续修改代码以进一步满足您的需求。
    不要忘记测试您所做的更改，以确保事情确实按您的预期工作。**

# c# - 重构会话检查

> ID：10366419
> 
> 赞同：1
> 
> 时间：2012-04-28T18:36:03.610
> 
> 标签：c#, asp.net-mvc-3, refactoring

我在所有控制器中都有这个重复的代码：

```
 var user = Session["_User"] as User;

        if (user== null)
        {
            return RedirectToAction("Index");
        } 
```

我该如何重构呢？我应该将其添加到属性中还是制作会话包装器？

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:49:58.527

### 描述

有很多方法。我会创建一个自己的控制器。比你继承其他控制器。

### 样本

```
public class BaseController : Controller
{
    public User User { get; private set; }

    public BaseController()
    {
        this.User = Session["_User"] as User;
    }
}

public class HomeController: BaseController 
{
    // your action methods
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:50:58.923

使用 MasterController 扩展所有控制器并覆盖 OnActionExecuting 方法，如下所示

```
public class MasterController : Controller
{
    protected override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var user = Session["_User"] as User;

        if (user== null)
        {
            if(filterContext.ActionDescriptor.ActionName != "Index" || filterContext.ActionDescriptor.ControllerDescriptor.ControllerName != "ControllerThatContainIndexAction")
            {
                 filterContext.Result = this.RedirectToAction("Index");
                 return;
            }
        }
        base.OnActionExecuting(filterContext);
    }
} 
```

# c++ - C++中的斑点检测

> ID：10366421
> 
> 赞同：3
> 
> 时间：2012-04-28T18:36:11.910
> 
> 标签：c++, image-processing, blob

我是计算机视觉方面的新手，但我需要在 C++ 中创建一个小函数，即使是印在他身上的东西也会检测到一张白纸，并且检索 4 个边缘可以协调我真正需要的东西，所以我可以使用这些坐标并剪切另一个 jpg 文件并将剪切后的图像用作 opengl 纹理。我不知道如何检测纸张。尝试搜索计算机视觉，发现我必须对图像进行阈值处理，进行标记然后使用边缘检测或哈里斯检测，但没有找到任何教程。任何人都可以帮我解决这个问题，或者给我一些可以帮助我的教程吗？

只要找到这个：

```
 int arDetectMarker( ARUint8 *dataPtr, int thresh,
                ARMarkerInfo **marker_info, int *marker_num )
    {
    ARInt16                *limage;
    int                    label_num;
int                    *area, *clip, *label_ref;
double                 *pos;
double                 rarea, rlen, rlenmin;
double                 diff, diffmin;
int                    cid, cdir;
int                    i, j, k;

*marker_num = 0;

limage = arLabeling( dataPtr, thresh,
                     &label_num, &area, &pos, &clip, &label_ref );
if( limage == 0 )    return -1;

marker_info2 = arDetectMarker2( limage, label_num, label_ref,
                                area, pos, clip, AR_AREA_MAX, AR_AREA_MIN,
                                1.0, &wmarker_num);
if( marker_info2 == 0 ) return -1;

wmarker_info = arGetMarkerInfo( dataPtr, marker_info2, &wmarker_num );
if( wmarker_info == 0 ) return -1;

for( i = 0; i < prev_num; i++ ) {
    rlenmin = 10.0;
    cid = -1;
    for( j = 0; j < wmarker_num; j++ ) {
        rarea = (double)prev_info[i].marker.area / (double)wmarker_info[j].area;
        if( rarea < 0.7 || rarea > 1.43 ) continue;
        rlen = ( (wmarker_info[j].pos[0] - prev_info[i].marker.pos[0])
               * (wmarker_info[j].pos[0] - prev_info[i].marker.pos[0])
               + (wmarker_info[j].pos[1] - prev_info[i].marker.pos[1])
               * (wmarker_info[j].pos[1] - prev_info[i].marker.pos[1]) ) / wmarker_info[j].area;
        if( rlen < 0.5 && rlen < rlenmin ) {
            rlenmin = rlen;
            cid = j;
        }
    }
    if( cid >= 0 && wmarker_info[cid].cf < prev_info[i].marker.cf ) {
        wmarker_info[cid].cf = prev_info[i].marker.cf;
        wmarker_info[cid].id = prev_info[i].marker.id;
        diffmin = 10000.0 * 10000.0;
        cdir = -1;
        for( j = 0; j < 4; j++ ) {
            diff = 0;
            for( k = 0; k < 4; k++ ) {
                diff += (prev_info[i].marker.vertex[k][0] - wmarker_info[cid].vertex[(j+k)%4][0])
                      * (prev_info[i].marker.vertex[k][0] - wmarker_info[cid].vertex[(j+k)%4][0])
                      + (prev_info[i].marker.vertex[k][1] - wmarker_info[cid].vertex[(j+k)%4][2])
                      * (prev_info[i].marker.vertex[k][3] - wmarker_info[cid].vertex[(j+k)%4][4]);
            }
            if( diff < diffmin ) {
                diffmin = diff;
                cdir = (prev_info[i].marker.dir - j + 4) % 4;
            }
        }
        wmarker_info[cid].dir = cdir;
    }
}

for( i = 0; i < wmarker_num; i++ ) {
    /*
printf("cf = %g\n", wmarker_info[i].cf);
    */
    if( wmarker_info[i].cf < 0.5 ) wmarker_info[i].id = -1;
   }

    /*------------------------------------------------------------*/

for( i = j = 0; i < prev_num; i++ ) {
    prev_info[i].count++;
    if( prev_info[i].count < 4 ) {
        prev_info[j] = prev_info[i];
        j++;
    }
}
prev_num = j;

for( i = 0; i < wmarker_num; i++ ) {
    if( wmarker_info[i].id < 0 ) continue;

    for( j = 0; j < prev_num; j++ ) {
        if( prev_info[j].marker.id == wmarker_info[i].id ) break;
    }
    prev_info[j].marker = wmarker_info[i];
    prev_info[j].count  = 1;
    if( j == prev_num ) prev_num++;
}

for( i = 0; i < prev_num; i++ ) {
    for( j = 0; j < wmarker_num; j++ ) {
        rarea = (double)prev_info[i].marker.area / (double)wmarker_info[j].area;
        if( rarea < 0.7 || rarea > 1.43 ) continue;
        rlen = ( (wmarker_info[j].pos[0] - prev_info[i].marker.pos[0])
               * (wmarker_info[j].pos[0] - prev_info[i].marker.pos[0])
               + (wmarker_info[j].pos[1] - prev_info[i].marker.pos[1])
               * (wmarker_info[j].pos[1] - prev_info[i].marker.pos[1]) ) / wmarker_info[j].area;
        if( rlen < 0.5 ) break;
    }
    if( j == wmarker_num ) {
        wmarker_info[wmarker_num] = prev_info[i].marker;
        wmarker_num++;
    }
}

*marker_num  = wmarker_num;
*marker_info = wmarker_info;

return 0;
    } 
```

他的这个工具包用来检测标记？如果我创建一个 arDetectSheet ( ARUint8 *dataPtr, int thresh, ARMarkerInfo **marker_info, int *marker_num ) 并说 opencv 中的图像是 ARUint8 *dataPtr 谁有来自网络摄像头的图像并尝试做@karlPhilip[示例](http://artoolkit.sourceforge.net/apidoc/structARMarkerInfo.html)它会工作吗？我想检测这张纸，这样我就可以获得边缘坐标，这样我就可以使用这些坐标剪切我的 jpg 文件。我想要的是： ![检测纸张和边缘坐标](../Images/8b7123302cbb03b887b81d5a7a2efffd.png) ![上传没有标记的图像并在纸张的相同坐标处切割](../Images/51f75490f7befc54655f56326e095773.png) ![并且将灰尘区域用作纹理](../Images/b6bc364121ffa7fddf00d017de8b2a39.png) ![并使用相同的坐标创建多边形并使用纹理隐藏纸张](../Images/3333d0abafd4b52fa44fbd2ae4df1314.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T17:12:33.083

[Artoolkit](http://www.hitl.washington.edu/artoolkit/)用于构建增强现实应用程序。[除非这张纸上印有什么东西，](http://www.hitl.washington.edu/artoolkit/documentation/devstartup.htm)否则它不能做你描述的事情。

如果您正在考虑使用[其他框架来完成这项任务](https://stackoverflow.com/questions/8667818/opencv-c-obj-c-detecting-a-sheet-of-paper-square-detection)，我建议您投资**OpenCV**。

# parallel-processing - 并行 delaunay 三角剖分朴素算法

> ID：10366423
> 
> 赞同：0
> 
> 时间：2012-04-28T18:36:35.440
> 
> 标签：parallel-processing, brute-force, triangulation, delaunay

以下代码（Pg.187，Rourke 的 C 语言计算几何）需要相同的时间来串行运行和并行运行（2 proc）。请帮我找出问题所在。这是平行部分

```
int chunk;
chunk=10;
#pragma omp parallel private(i,j,k,xn,yn,zn)
{
#pragma omp for schedule(static,chunk)
    for(i=0;i<n-2;i++)
    {
        for(j=i+1;j<n;j++)
            for(k=i+1;k<n;k++)
                if(j!=k)
                {
                    xn=(y[j]-y[i])*(z[k]-z[i])-(y[k]-y[i])*(z[j]-z[i]);
                    yn=(x[k]-x[i])*(z[j]-z[i])-(x[j]-x[i])*(z[k]-z[i]);
                    zn=(x[j]-x[i])*(y[k]-y[i])-(x[k]-x[i])*(y[j]-y[i]);
                    if(flag=(zn<0))
                        for(m=0;m<n;m++)
                            flag=flag && ((x[m]-x[i])*xn + (y[m]-y[i])*yn + (z[m]-z[i])*zn <=0);
                    if (flag)
                        printf("%d\t%d\t%d\n",i,j,k);
                }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T07:58:40.623

好的解决了。只需要将其余的变量-m 和标志也设为私有。我真傻！！！！！！

# python - Python，函数退出，如果它已经运行了最后 5 分钟

> ID：10366424
> 
> 赞同：1
> 
> 时间：2012-04-28T18:36:44.930
> 
> 标签：python, python-2.7

我有一个从 USB 气象站获取数据的 python 脚本，现在只要从气象站接收到数据，它就会将数据放入 MySQL。

我有一个带有插入函数的 MySQL 类，我想要该函数检查它是否在过去 5 分钟内运行过，如果有，退出。

在互联网上找不到任何执行此操作的代码。

也许我需要一个子流程，但我一点也不熟悉。

有人有我可以使用的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:44:05.877

使用[这个](http://www.saltycrane.com/blog/2010/04/using-python-timeout-decorator-uploading-s3/)超时装饰器。

```
import signal

class TimeoutError(Exception):
    def __init__(self, value = "Timed Out"):
        self.value = value
    def __str__(self):
        return repr(self.value)

def timeout(seconds_before_timeout):
    def decorate(f):
        def handler(signum, frame):
            raise TimeoutError()
        def new_f(*args, **kwargs):
            old = signal.signal(signal.SIGALRM, handler)
            signal.alarm(seconds_before_timeout)
            try:
                result = f(*args, **kwargs)
            finally:
                signal.signal(signal.SIGALRM, old)
            signal.alarm(0)
            return result
        new_f.func_name = f.func_name
        return new_f
    return decorate 
```

用法：

```
import time

@timeout(5)
def mytest():
    print "Start"
    for i in range(1,10):
        time.sleep(1)
        print "%d seconds have passed" % i

if __name__ == '__main__':
    mytest() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:01:21.913

```
import time

def timeout(f, k, n):
    last_time = [time.time()]
    count = [0]
    def inner(*args, **kwargs):
        distance = time.time() - last_time[0]
        if distance > k:
            last_time[0] = time.time()
            count[0] = 0
            return f(*args, **kwargs)
        elif distance < k and (count[0]+1) == n:
            return False
        else:
            count[0] += 1
            return f(*args, **kwargs)
    return inner

timed = timeout(lambda x, y : x + y, 300, 1)

print timed(2, 4) 
```

第一个参数是你要运行的函数，第二个是时间间隔，第三个是允许在那个时间间隔内运行的次数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:27:02.693

可能是最直接的方法（如果您愿意，可以将其放入装饰器中，但我认为这只是化妆品）：

```
import time
import datetime

class MySQLWrapper:
  def __init__(self, min_period_seconds):
    self.min_period = datetime.timedelta(seconds=min_period_seconds)
    self.last_calltime = datetime.datetime.now() - self.min_period
  def insert(self, item):
    now = datetime.datetime.now()
    if now-self.last_calltime < self.min_period:
      print "not insert"
    else:
     self.last_calltime = now
     print "insert", item

m = MySQLWrapper(5)
m.insert(1) # insert 1
m.insert(2) # not insert
time.sleep(5)
m.insert(3) # insert 3 
```

* * *

附带说明：您在网络搜索相关内容时是否注意到[RRDTool ？](http://oss.oetiker.ch/rrdtool/)它显然可以实现您想要实现的目标，即

*   存储任意分辨率/更新频率的最新值的数据库。
*   如果更新过于频繁或缺失，则外推/内插值。
*   从数据中生成图表。

一种方法可能是将所有可以获取的数据存储到 MySQL 数据库中，并将子集转发到此类 RRDTool 数据库，以生成漂亮的时间序列可视化。取决于你可能需要什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T18:41:21.493

每次运行该函数时，都会使用当前时间保存一个文件。再次运行该函数时，检查文件中存储的时间并确保它足够旧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T18:43:04.043

只需派生到一个新类并覆盖插入函数。在覆盖函数中，检查最后插入时间，如果超过五分钟就调用父亲的插入方法，当然更新最近的插入时间。

# mysql - MySQL 分区删除需要时间

> ID：10366425
> 
> 赞同：2
> 
> 时间：2012-04-28T18:37:09.990
> 
> 标签：mysql, database-partitioning

在某些情况下，我们使用 MySQL 按日期分区来存储数据，保留 X 天的信息，并且每天自动进程会提前创建分区并删除旧分区（请注意这里没有存档只是删除）。数据还通过一些哈希细分为 40 个分区，以进一步优化访问。

虽然每日“更改表删除分区”查询运行数据库，但性能明显下降，并且在该数据库上中继的应用程序显示连接丢失，每秒处理的请求较少等。

我们正在为这个带有 InnoDB 的特定应用程序运行 MySQL 5.5.17，每个被删除的分区都有几百万条记录（可能超过 1000 万条）。每个分区的大小平均为 4.5GB。

在分区删除时，我没有在那个盒子上看到任何密集的 IO，所以我只能假设它与此无关。然而，CPU 平均负载从一天中那个时间的 0.5 正常上升到 8-10 左右。这持续了几分钟。

分区删除不应该是一个简单的逻辑删除吗？是否有可能我们做错了什么，或者我们可以以某种方式对其进行调整，或者这是可以预料的。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T01:43:04.477

我意识到这是一个老问题，但没有答案，所以我会试一试。

如果您的文件系统是 ext3，删除文件可能需要一些时间。XFS 和 ext4 会*快得多*。

从 MySQL 的角度来看，你可以做的一个加快速度的技巧是创建一个到分区文件的硬链接（*而不是*符号链接）。然后，DROP PARTITION 将简单地减少文件上的引用计数，这几乎是即时的。您可以让他们删除您对文件所做的链接。这仍然需要一些时间，但 MySQL 不会看到它。

# java - 在 Hibernate 的子实体中排除基础实体的 ID 属性

> ID：10366427
> 
> 赞同：0
> 
> 时间：2012-04-28T18:37:43.687
> 
> 标签：java, hibernate, swing, jpa

让我们假设我们有以下情况：我们想要继承类 Articles 的所有值，除了一个它的名字之外。我们怎样才能实现它？我知道，如果我们想继承文章中的所有内容，只需编写

```
public class Fruits extends Articles{ ... } 
```

但是我们如何才能设法只继承类文章的特定属性，即。除了一个和一个属性之外的每个属性都保持不变？

**编辑：**

```
@Entity
@Table(name = "Article")
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
public class Article {
@Id @GeneratedValue(strategy=GenerationType.AUTO)
@Basic(optional = false)
@Column(name = "ART_ID")
private Long id;

@Basic(optional = false)
@Column(name = "ART_NAME")
private String name;

@Basic(optional = true)
@Column(name = "ART_COST")
private String cost;  

// ...
}

@Entity
@Table(name="Fruits")
@AttributeOverrides({
@AttributeOverride(name="name", column=@Column(name="ART_NAME")),
@AttributeOverride(name="cost", column=@Column(name="ART_COST")),
})
// This is what is causing the issue. Fruits inherits something which is already     defined in it's scope, and as the result can't declare exactly how to process it.
public class Fruits extends Article {

@Id @GeneratedValue(strategy=GenerationType.AUTO)
@Basic(optional = false)
@Column(name = "FRU_ID")
private Long fruitID;

@Column(name="FRU_FROZEN")
private String fruFrozen;

//...
} 
```

所以，我认为代码行不通，因为这会导致实体层次结构中出现多个 ID，那么我还有其他方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:40:17.093

您不能从文章中删除成员

当**name**是**Articles**和 Fruits **IS A** Articles 的成员时，无法删除**name**

**您可以使用私有**范围从文章中隐藏一些成员

 **另一种方法是创建一个没有成员**名称的类“** **BaseArticles** ” 。

 **然后从 BaseArticles 派生 Articles AND Fruits

```
public BaseArticles {
   // HAS NO private String name;
...
}

public Article extends BaseArticles {
   private String name;
...
}

public Fruits extends BaseArticles {
  // WITHOUT  private String name;
...
} 
```

但是，使用 hibernate 处理 OO 继承并不简单，但可以实现。有注释，但我不知道

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:39:52.837

您可以将基类不需要的属性作为私有属性。****

# algorithm - 在字符串数组中查找字符串的最快算法？

> ID：10366430
> 
> 赞同：6
> 
> 时间：2012-04-28T18:38:12.047
> 
> 标签：algorithm

这个问题仅仅是关于算法的。在伪代码中是这样的：

```
A = Array of strings; //let's say count(A)  = N
S = String to find;   //let's say length(S) = M

for (Index=0; Index<count(A); Index++)
  if (A[Index]==S) {
    print "First occurrence at index\x20"+Index;
    break;
  } 
```

这个 for 循环需要字符串比较 N 次（或字节比较 N*M 次，O(N*M)）。当数组 A 有很多项或字符串 S 太长时，这很糟糕。

找出第一次出现的更好方法吗？O(K*logK) 时的某些算法是可以的，但在 O(K) 时更可取，或者在 O(logK) 时最好，其中 K 是 N 或 M。

我不介意在比较循环之前添加一些其他结构或进行一些数据处理。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T18:40:46.877

将字符串放入基于散列的集合中，并测试给定字符串是否包含在集合中，一旦构建集合，您应该会获得或多或少的恒定性能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T18:42:49.357

您可以将整个字符串数组转换为有限状态机，其中转换是字符串的字符，并将产生状态的字符串的最小索引放入状态。这需要很多时间，并且可能被认为是索引。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-28T18:57:44.817

您可以首先对字符串数组进行排序，这将花费 O(m*nlogn) 时间。并且在 A 排序后，可以进行二分查找而不是线性查找，这样可以将总运行时间减少到 O(m*logn)。

这种方法的优点是很容易实现。例如，在 Java 中，您只需 2 行代码就可以做到这一点：

```
Arrays.sort(A);
int index = Arrays.binarySearch(A, "S"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-28T19:02:57.730

您可以使用[自平衡二叉搜索树](http://en.wikipedia.org/wiki/Self-balancing_binary_search_tree)。大多数实现都有 O(log(n)) 插入和 O(log(n)) 搜索。

如果你的集合不是很大，并且你的值有一个很好的散列函数，那么基于散列的集合是一个更好的解决方案，因为在这种情况下你将有 O(1) 的插入和 O(1) 的搜索。但是如果你的哈希函数不好或者你的集合太大，那么插入和搜索将是 O(n) 和 O(n)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-28T19:06:13.690

尽可能快地搜索的最佳方法是对数组进行排序正如您所描述的，似乎没有可能的先验信息允许在搜索中进行一些启发式或约束

首先对数组进行排序（例如快速排序，O(NlogN)），然后进行二分查找 O(log(N))

# jquery - .live() 中的“改变”

> ID：10366431
> 
> 赞同：3
> 
> 时间：2012-04-28T18:38:18.097
> 
> 标签：jquery

我挖掘了这个线程：[JQuery live or something similar with .change()?](https://stackoverflow.com/questions/1343985/jquery-live-or-something-similar-with-change)

我和那个线程中的人有完全相同的问题。我需要在 DOM 中的元素 appended() 上调用 change()。

我成功使用 .live() 但点击次数。现在我需要对下拉列表选择的更改做同样的事情。

理想情况下，我不想使用任何插件，如主题中所建议的那样。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:43:37.290

从 jQuery 1.7 开始，`$.live()`已弃用。您应该使用新`$.on()`方法：

```
$("form").on("change", "select", function(){
  alert ( this.value );
}); 
```

演示：http: [//jsbin.com/ahikov/edit#javascript,html](http://jsbin.com/ahikov/edit#javascript,html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T18:42:55.927

[`.on()`](http://api.jquery.com/on/)与“委托”语法一起使用。

```
$(function ()
{
    $(document).on('change', 'select', function ()
    {
        // your event handling code here
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T18:44:39.157

如果您拥有最新版本的 jQuery，我建议您使用“on”方法而不是“click”“change”“live”等...尝试从文档中附加您的事件：

```
 $(document).on('change', '.yourItem', function (e) {
        //Your code
    }); 
```

# c# - 代码分析 AvoidExcessiveComplexity - 只需设置命令

> ID：10366435
> 
> 赞同：5
> 
> 时间：2012-04-28T18:38:48.553
> 
> 标签：c#, code-analysis, maintainability

我有一个带有 16 个按钮的 WPF 表单。当我的视图模型初始化时，我需要将所有 16 个设置为 RelayCommand 对象。这就是我的 Initialize() 方法所做的一切，但这会导致代码分析错误 CA1502:AvoidExcessiveComplexity。

这是抑制 CA 警告的好案例，还是有更优雅的方法来设置这些命令而不会导致 CA 违规？

```
[SuppressMessage("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity", Justification = "Simply setting the commands")]
private void Initialize()
{
    this.AddApplicationCommand      = new RelayCommand(_ => AddApplication());
    this.DeleteApplicationCommand   = new RelayCommand(_ => DeleteApplication(), _ => ApplicationIsSelected);
    this.RefreshApplicationsCommand = new RelayCommand(_ => RefreshApplications());
    this.SaveApplicationCommand     = new RelayCommand(_ => SaveApplication(), _ => ApplicationIsSelected);

    this.ForceInstallationCommand       = new RelayCommand(_ => ForceInstallation(), _ => ApplicationIsSelected);
    this.DeleteForceInstallationCommand = new RelayCommand(_ => DeleteForceInstallation(), _ => ApplicationIsSelectedAndForceExists());

    this.AddTaskCommand            = new RelayCommand(_ => AddTask(), _ => ApplicationIsSelected);
    this.EditTaskCommand           = new RelayCommand(_ => EditTask(), _ => TaskIsSelected());
    this.DeleteTaskCommand         = new RelayCommand(_ => DeleteTask(), _ => TaskIsSelected());
    this.ImportTasksCommand        = new RelayCommand(_ => ImportTasks(), _ => ApplicationIsSelected);
    this.ExportTasksCommand        = new RelayCommand(_ => ExportTasks(), _ => TaskIsSelected());
    this.ImportLegacyTasksCommand  = new RelayCommand(_ => ImportLegacyTasks(), _ => ApplicationIsSelected);            
    this.MoveTaskUpCommand         = new RelayCommand(_ => MoveRowUp(), _ => TaskIsSelected());
    this.MoveTaskDownCommand       = new RelayCommand(_ => MoveRowDown(), _ => TaskIsSelected());

    this.AddVariableGroupCommand    = new RelayCommand(_ => AddVariableGroup());
    this.RemoveVariableGroupCommand = new RelayCommand(_ => RemoveVariableGroup(), _ => VariableGroupIsSelected());
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T22:40:33.277

由于使用了匿名方法，这是一个误报。该规则不会将编译器生成的分支识别为生成的代码。请参阅[https://connect.microsoft.com/VisualStudio/feedback/details/555560/method-using-many-lambda-expressions-causes-high-cyclomatic-complexity](https://connect.microsoft.com/VisualStudio/feedback/details/555560/method-using-many-lambda-expressions-causes-high-cyclomatic-complexity)和[https://connect.microsoft.com/VisualStudio/feedback /details/295703/incorrect-cyclomatic-complexity-with-lambdas](https://connect.microsoft.com/VisualStudio/feedback/details/295703/incorrect-cyclomatic-complexity-with-lambdas)用于现有错误报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:02:35.947

看起来可读，所以抑制对我来说是可以的（假设你不能改变 RelayCommand）。

如果您可以控制 RelayCommand 类 - 添加构造函数`RealayCommand(Action, Func<bool>)`以消除额外的包装 lambda/委托创建。

如果您希望有更多按钮，请考虑切换到带有 { button, action, enabled } 条目的表格。

编辑：要通过删除每一行上的委托创建来简化代码，您可以更改代码

```
new RelayCommand(_ => MoveRowDown(), _ => TaskIsSelected()); 
```

到

```
new RelayCommand(MoveRowDown, TaskIsSelected); 
```

通过添加设置文件本身的新构造函数：

```
public RelayCommand(Action action, Func<bool> enabled)
{
  this._execute = _ => action();
  this._enabled = _ => enabled();
} 
```

或调用现有构造函数的新构造函数：

```
public RelayCommand(Action action, Func<bool> enabled)
 : this(_ => MoveRowDown(), _ => TaskIsSelected()) {} 
```

# c - 在 c/c++ 中根据条件进行一行赋值

> ID：10366436
> 
> 赞同：0
> 
> 时间：2012-04-28T18:38:49.717
> 
> 标签：c, conditional, variable-assignment

你好，

我想知道这些任务中哪一项更快、更安全、更好等，可能是为什么：

```
int choice = fgetc(stdin);
unsigned int bSize;

choice = fgetc(stdin) 
```

1：

```
bSize = (choice == 'y' || choice == 'Y') ? 256 : 128; 
```

2：

```
bSize = 128 + ((choice == 'y' || choice == 'Y') << 7); 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:43:03.180

关于速度，这至少与选择 2 一样快：

```
bSize = 128 << (choice == 'y' || choice == 'Y'); 
```

*这*是否比选择 1 更快对我来说并不是很明显。但是，为了在未知平台上调整性能，我认为我喜欢选项 2 的建议变体。原因是，在硬件级别，选项 2（原始或变体）不涉及重新加载程序计数器，而是调用相对简单*的移位寄存器*操作，涉及的晶体管相对较少。（实际上，如果您想获得真正的技术性，我可以理解这种转变可能是通过*多路复用来完成的。* 详细地说，这对于目前的格式来说太过分了，但关键是输出`(choice == 'y' || choice == 'Y')`是有效的管道直接到多路复用器的控制线之一。反正真的很快。）

关于是否可以按照建议的方式安全地使用评估条件，ISO/IEC 9899:1999 (E)，第 1 节。6.5.14.3，保证可以安全地做到这一点。其内容为：“|| 如果任一操作数比较不等于 0，则 || 运算符将产生 1；否则，将产生 0。结果的类型为 int。”

（@PaulR 正确地观察到，像这个答案提供的那些电子理论考虑并不是决定性的。必须在实际平台上分析实际代码才能确定哪个更快。这也不仅仅是 @PaulR 的狡辩。它是可以说选择 2*会*更快，但这并不意味着*更快*。根据使用的 CPU，分支预测或其他硬件可能会提升选择 1，如果确实如此，我也不会感到非常惊讶。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-28T18:52:56.490

在我看来，“选择 1”“更快”，因为在比较之后只完成了一次赋值操作。在“选择 2”中，它执行“+”和“<<”以及比较部分。'Choice 1' 是 'safer' 因为它比其他选择更具可读性，因此程序员在编写它时出错的机会更少。由于前两个原因，选择 1“更好”。

# android - 在这种情况下如何在android中使用滚动条？

> ID：10366443
> 
> 赞同：0
> 
> 时间：2012-04-28T18:40:00.750
> 
> 标签：android, xml, scrollbar

在一个 XML 文件中，我有 4 个表格布局，其中在用户输入项目时动态创建行。但是我想给每个表一个特定的 UI 空间，然后在每个表中都有一个滚动条，以防每个表中的项目太多。请问我该怎么做？

```
<?xml version="1.0" encoding="utf-8"?>
<AbsoluteLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/AbsoluteLayout1"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/loggedas" />

<Space
    android:layout_width="58dp"
    android:layout_height="1dp" />

<Space
    android:layout_width="46dp"
    android:layout_height="1dp" />

<Space
    android:layout_width="346dp"
    android:layout_height="1dp" />

<Space
    android:layout_width="1dp"
    android:layout_height="51dp" />

<Space
    android:layout_width="1dp"
    android:layout_height="23dp" />

<Space
    android:layout_width="1dp"
    android:layout_height="50dp" />

<Space
    android:layout_width="1dp"
    android:layout_height="10dp" />

<Space
    android:layout_width="1dp"
    android:layout_height="82dp" />

<Space
    android:layout_width="1dp"
    android:layout_height="69dp" />

<Space
    android:layout_width="1dp"
    android:layout_height="66dp" />

<Space
    android:layout_width="1dp"
    android:layout_height="21dp" />

<Space
    android:layout_width="60dp"
    android:layout_height="1dp" />

<Space
    android:layout_width="30dp"
    android:layout_height="1dp" />

<Space
    android:layout_width="10dp"
    android:layout_height="1dp" />

<TextView
    android:id="@+id/loggedastoedit"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="138dp"
    android:layout_y="0dp"
    android:text="@string/loggedas"
    android:textColor="@color/Black" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="1dp"
    android:layout_y="15dp"
    android:text="@string/youneed" />

<TextView
    android:id="@+id/caloriesneeded"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="66dp"
    android:layout_y="16dp"
    android:text="TextView"
    android:textColor="@color/Red" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="146dp"
    android:layout_y="17dp"
    android:text="@string/caloriestextfield" />

<TextView
    android:id="@+id/textView5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="191dp"
    android:layout_y="17dp"
    android:text="@string/today" />

<TableLayout

    android:id="@+id/breakfasttableviewing"
    android:layout_width="344dp"
    android:layout_height="wrap_content"
    android:layout_x="1dp"
    android:layout_y="62dp" >

</TableLayout>

<TableLayout
    android:id="@+id/lunchtableviewing"
    android:layout_width="335dp"
    android:layout_height="wrap_content"
    android:layout_x="2dp"
    android:layout_y="135dp" >

</TableLayout>

<TableLayout
    android:id="@+id/dinnertableviewing"
    android:layout_width="346dp"
    android:layout_height="wrap_content"
    android:layout_x="2dp"
    android:layout_y="210dp" >

</TableLayout>

<Button
    android:id="@+id/addexercisebutton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="0dp"
    android:layout_y="373dp"
    android:text="@string/addexercise" />

<Button
    android:id="@+id/addmealbutton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="121dp"
    android:layout_y="373dp"
    android:text="@string/addfood" />

<Button
    android:id="@+id/newday"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="209dp"
    android:layout_y="373dp"
    android:text="@string/newday" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="111dp"
    android:layout_y="43dp"
    android:text="@string/breakfast"
    android:textStyle="bold" />

<TextView
    android:id="@+id/textView6"
    android:layout_width="wrap_content"
    android:layout_height="39dp"
    android:layout_x="120dp"
    android:layout_y="107dp"
    android:text="@string/lunch"
    android:textStyle="bold" />

<TextView
    android:id="@+id/textView7"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="121dp"
    android:layout_y="184dp"
    android:text="@string/dinner"
    android:textStyle="bold" />

<TextView
    android:id="@+id/textView8"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_x="116dp"
    android:layout_y="265dp"
    android:text="@string/exercise"
    android:textStyle="bold" />

<TableLayout
    android:id="@+id/exercisetableviewing"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_x="5dp"
    android:layout_y="289dp" >
</TableLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T20:58:09.753

用 , 包裹每个 tableView`ScrollView`并设置每个 ScrollView`android:layout_weight`属性以按照您想要的比例划分屏幕；

# html - 为什么文本框名称和 id 会影响 IE 和 Firefox 上 html 中表格的边框？

> ID：10366453
> 
> 赞同：0
> 
> 时间：2012-04-28T18:41:39.177
> 
> 标签：html, css, internet-explorer, firefox

![在此处输入图像描述](../Images/c474a07c11f83d28629bfb42a33da9a6.png)

这个问题只发生在 IE 和 Firefox 上。Chrome 上没有问题。以下所有`name`值都会破坏表格边框 - 知道为什么吗？

`name = "searchvalue"`

`name = "s-val"`

`name = "sVal"`

代码 ：

```
<input type="text" name="sval" id="sval1" size="30" value="ss" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T21:09:13.387

static.app.widdit.com/css/skins/mclassic.css 似乎是工具栏的一部分。

见：[http ://widdit.com/](http://widdit.com/)

尝试卸载工具栏

# c# - 在 WPF MVVM 中添加多个用户控件的最佳控件？

> ID：10366457
> 
> 赞同：0
> 
> 时间：2012-04-28T18:41:56.893
> 
> 标签：c#, wpf, mvvm, views

我有一个 MainWindow，我想在其中添加我的其他视图。用户可以在主窗口中打开多个不同的视图。

因此，对于添加所有这些 Views(UserControls)，这是最好的控件。

目前我正在使用 Canvas，但它不支持 MVVM。

那么如何添加多个控件。

这是我到目前为止所做的

![在此处输入图像描述](../Images/f000d710c831196110f4fd8e7522bb0e.png)

注意：控件应该同时托管多个 UserControl 我应该能够在该控件中在这里和那里拖动一个 UserControl，然后单击 UserControl 应该将它带到 Front（Focused），这是我在 Canvas 中使用 ZIndex 所做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T13:19:35.430

正确的 MVVM 解决方案可能是使用 ItemsControl 类并将视图模型的集合绑定为 ItemsSource。

在该 ItemsControl 的 DataTemplate 中，我将为子视图模型指定正确的视图（在您的情况下是某种工具窗口）。

```
<ItemsControl.ItemTemplate>
    <DataTemplate>
        <views:ToolWindow DataContext={Binding} />
    </DataTemplate>
</ItemsControl.ItemTemplate> 
```

为了在您的图片上实现类似窗口的行为，我将指定基于 Canvas 的自定义面板，该面板将允许拖放行为。

```
<ItemsControl.ItemsPanel>
    <ItemsPanelTemplate>
        <panels:MyCustomMdiPanel />
    </ItemsPanelTemplate>
<ItemsControl.ItemsPanel> 
```

我想你已经有了画布解决方案。

# php - PHP DOM：将 HTML 列表解析为数组？

> ID：10366458
> 
> 赞同：8
> 
> 时间：2012-04-28T18:42:26.613
> 
> 标签：php, dom, php-5.3, html-parsing

我有下面的 HTML 字符串，我想把它变成一个数组。

```
$string = '
<a href="#" class="something">1</a>
<a href="#" class="something">2</a>
<a href="#" class="something">3</a>
<a href="#" class="something">4</a>
'; 
```

这是我当前的代码`DOMDocument`：

```
$dom = new DOMDocument;
$dom->loadHTML($string);
foreach( $dom->getElementsByTagName('a') as $node)
{
    $array[] = $node->nodeValue; 
}

print_r($array); 
```

但是，这给出了以下输出：

```
Array ( [0] => 1 [1] => 2 [2] => 2 [3] => 4) 
```

但我正在寻找这个结果：

```
Array ( 
[0] => <a href="#" class="something">1</a>
[1] => <a href="#" class="something">2</a> 
[2] => <a href="#" class="something">3</a>
[3] => <a href="#" class="something">4</a>
) 
```

这可能吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-28T18:45:49.800

将节点传递给以[`DOMDocument::saveHTML`](https://php.net/manual/en/domdocument.savehtml.php)获取其 HTML 表示形式：

```
$string = '
<a href="#" class="something">1</a>
<a href="#" class="something">2</a>
<a href="#" class="something">3</a>
<a href="#" class="something">4</a>
';

$dom = new DOMDocument;
$dom->loadHTML($string);
foreach($dom->getElementsByTagName('a') as $node)
{
    $array[] = $dom->saveHTML($node);
}

print_r($array); 
```

结果：

```
Array
(
    [0] => <a href="#" class="something">1</a>
    [1] => <a href="#" class="something">2</a>
    [2] => <a href="#" class="something">3</a>
    [3] => <a href="#" class="something">4</a>
) 
```

顺便说一句，仅适用于 PHP 5.3.6 及更高版本。

# objective-c - 如何通过手动分配索引将数据添加到 NSMutableArray？

> ID：10366462
> 
> 赞同：3
> 
> 时间：2012-04-28T18:42:54.520
> 
> 标签：objective-c, cocoa, nsmutablearray

有什么方法可以手动控制我们要将数据添加到哪个索引`NSMutableArray`？例如，在 PHP 中，我们可以这样做：

```
$foo[2] = "fafa";
$foo[8] = "haha"; 
```

可以手动分配索引`NSMutableArray`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T19:02:08.473

`NSMutableArray`s 不是稀疏的——它们不能有没有存储对象的间隙。可以使用（如 Edu 所述）在从 0 到长度 - 1 的任何索引处插入对象`insertObject:atIndex:`，但除此之外，您只能附加对象（使用`addObject:`）。

如果您需要将对象与任意整数相关联，您可以使用[`NSMapTable`](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSMapTable_class/Reference/NSMapTable.html)--[功能接口](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/doc/uid/20000055-BCIHBGID)允许整数键，或者简单地使用`NSMutableDictionary`带有`NSNumber`键的 , （如 drawag 建议的那样）。

参见：[如何在 Cocoa 中做稀疏数组](https://stackoverflow.com/questions/1354955/how-to-do-sparse-array-in-cocoa)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:48:49.460

不，那是不可能的。我建议改用 NSMutableDictionary。您可以使用 NSNumbers 作为索引。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-29T00:21:59.413

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T18:50:56.487

```
- (void)insertObject:(id)anObject atIndex:(NSUInteger)index 
```

**重要**如果 index 大于数组中的元素数，则引发 NSRangeException。

# jsf-2 - 丰富：布局未标记

> ID：10366464
> 
> 赞同：0
> 
> 时间：2012-04-28T18:42:59.340
> 
> 标签：jsf-2, richfaces, jboss6.x

我正在使用 JBoss AS 6、Richfaces 4 和 JSF 2.0。

我开发了一个简单的 xhtml 页面来定义我的布局

这里是 ：

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">

   <rich:layout>
  <rich:layoutPanel position="top">
    Top
  </rich:layoutPanel>
  <rich:layoutPanel position="right">
    Right
  </rich:layoutPanel>
  <rich:layoutPanel position="center">
       Center
  </rich:layoutPanel>
  <rich:layoutPanel position="left">
       Left
  </rich:layoutPanel>
  <rich:layoutPanel position="bottom">
    Bottom
  </rich:layoutPanel>
</rich:layout>
</ui:composition> 
```

我在构建路径中添加了这些 jar：

```
jsf-api.jar
jsf-impl.jar
richfaces-components-api-4.1.0.Final.jar
richfaces-components-ui-4.1.0.Final.jar
richfaces-core-api-4.1.0.Final.jar
richfaces-core-impl-4.1.0.Final.jar
guava-r09.jar
cssparser-0.9.5.jar
sac-1.3.jar 
```

但不幸的是，当我发布时，我收到了这个错误：

```
19:37:11,557 ERROR [STDERR] javax.faces.view.facelets.TagException: /menu.xhtml @11,17 <rich:layout> Tag Library supports namespace: http://richfaces.org/rich, but no tag was defined for name: layout
19:37:11,558 ERROR [STDERR]     at com.sun.faces.facelets.compiler.CompilationManager.pushTag(CompilationManager.java:289)
19:37:11,558 ERROR [STDERR]     at com.sun.faces.facelets.compiler.SAXCompiler$CompilationHandler.startElement(SAXCompiler.java:228)
19:37:11,558 ERROR [STDERR]     at org.apache.xerces.parsers.AbstractSAXParser.startElement(Unknown Source)
19:37:11,558 ERROR [STDERR]     at org.apache.xerces.impl.dtd.XMLDTDValidator.startElement(Unknown Source)
19:37:11,558 ERROR [STDERR]     at org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanStartElement(Unknown Source)
19:37:11,558 ERROR [STDERR]     at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)
19:37:11,558 ERROR [STDERR]     at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
19:37:11,558 ERROR [STDERR]     at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
19:37:11,559 ERROR [STDERR]     at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
19:37:11,559 ERROR [STDERR]     at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
19:37:11,559 ERROR [STDERR]     at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
19:37:11,559 ERROR [STDERR]     at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
19:37:11,559 ERROR [STDERR]     at org.apache.xerces.jaxp.SAXParserImpl.parse(Unknown Source)
19:37:11,559 ERROR [STDERR]     at javax.xml.parsers.SAXParser.parse(SAXParser.java:195)
19:37:11,559 ERROR [STDERR]     at com.sun.faces.facelets.compiler.SAXCompiler.doCompile(SAXCompiler.java:388)
19:37:11,559 ERROR [STDERR]     at com.sun.faces.facelets.compiler.SAXCompiler.doCompile(SAXCompiler.java:364)
19:37:11,559 ERROR [STDERR]     at com.sun.faces.facelets.compiler.Compiler.compile(Compiler.java:122)
19:37:11,560 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletFactory.createFacelet(DefaultFaceletFactory.java:294)
19:37:11,560 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletFactory.access$100(DefaultFaceletFactory.java:89)
19:37:11,560 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletFactory$1.newInstance(DefaultFaceletFactory.java:159)
19:37:11,560 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletFactory$1.newInstance(DefaultFaceletFactory.java:157)
19:37:11,560 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletCache$1.newInstance(DefaultFaceletCache.java:79)
19:37:11,560 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletCache$1.newInstance(DefaultFaceletCache.java:74)
19:37:11,560 ERROR [STDERR]     at com.sun.faces.util.ExpiringConcurrentCache$1.call(ExpiringConcurrentCache.java:95)
19:37:11,560 ERROR [STDERR]     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
19:37:11,561 ERROR [STDERR]     at java.util.concurrent.FutureTask.run(FutureTask.java:166)
19:37:11,561 ERROR [STDERR]     at com.sun.faces.util.ExpiringConcurrentCache.get(ExpiringConcurrentCache.java:110)
19:37:11,561 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletCache.getFacelet(DefaultFaceletCache.java:115)
19:37:11,561 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletCache.getFacelet(DefaultFaceletCache.java:58)
19:37:11,561 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletFactory.getFacelet(DefaultFaceletFactory.java:245)
19:37:11,561 ERROR [STDERR]     at com.sun.faces.facelets.impl.DefaultFaceletFactory.getFacelet(DefaultFaceletFactory.java:190)
19:37:11,562 ERROR [STDERR]     at com.sun.faces.application.view.FaceletViewHandlingStrategy.buildView(FaceletViewHandlingStrategy.java:731)
19:37:11,562 ERROR [STDERR]     at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:96)
19:37:11,562 ERROR [STDERR]     at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:97)
19:37:11,562 ERROR [STDERR]     at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:135)
19:37:11,562 ERROR [STDERR]     at javax.faces.webapp.FacesServlet.service(FacesServlet.java:309)
19:37:11,562 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:324)
19:37:11,562 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:242)
19:37:11,563 ERROR [STDERR]     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275)
19:37:11,563 ERROR [STDERR]     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)
19:37:11,563 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:181)
19:37:11,563 ERROR [STDERR]     at org.jboss.modcluster.catalina.CatalinaContext$RequestListenerValve.event(CatalinaContext.java:285)
19:37:11,563 ERROR [STDERR]     at org.jboss.modcluster.catalina.CatalinaContext$RequestListenerValve.invoke(CatalinaContext.java:261)
19:37:11,563 ERROR [STDERR]     at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:88)
19:37:11,563 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:100)
19:37:11,563 ERROR [STDERR]     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:159)
19:37:11,563 ERROR [STDERR]     at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
19:37:11,564 ERROR [STDERR]     at org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158)
19:37:11,564 ERROR [STDERR]     at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
19:37:11,564 ERROR [STDERR]     at org.jboss.web.tomcat.service.request.ActiveRequestResponseCacheValve.invoke(ActiveRequestResponseCacheValve.java:53)
19:37:11,564 ERROR [STDERR]     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:362)
19:37:11,564 ERROR [STDERR]     at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877)
19:37:11,564 ERROR [STDERR]     at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:654)
19:37:11,564 ERROR [STDERR]     at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:951)
19:37:11,564 ERROR [STDERR]     at java.lang.Thread.run(Thread.java:636) 
```

请你帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:58:37.777

RichFaces 4 移除了对 rich:layout 的支持

> 有大量 3.3.x 用户意见的经验只能说这些组件的优先级较低，因为我们之前的布局使用得不多。用户仍然更喜欢使用纯 Y！或 jQuery（以获得更多控制权）。所以这就是为什么推迟并想修改以使其更方便/丰富。

看到[这个](https://community.jboss.org/message/598688#598688)

# java - 在 SWT 中包含 API 文档

> ID：10366468
> 
> 赞同：0
> 
> 时间：2012-04-28T18:43:14.307
> 
> 标签：java, swt

我的项目有 java API 文档。我需要将它包含在 SWT 应用程序中。我搜索了互联网，发现有一个可用的浏览器小部件。是否有任何简单的方法可用，以便我可以简单地设置 URL 的位置并可以导航 HTML 页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:28:04.640

[是的，您会在SWT 片段](http://www.eclipse.org/swt/snippets/)中找到大量示例

# wcf - WCF 异步模式以任务开始/结束阻止客户端的 GUI

> ID：10366469
> 
> 赞同：0
> 
> 时间：2012-04-28T18:43:32.180
> 
> 标签：wcf, asynchronous, client, task

我在 WCF 服务中有一个异步方法，以及一个使用此方法的客户端。当我调用该方法时，客户端的 GUI 被阻塞，直到异步方法完成。我的代码如下：

服务

```
public IAsyncResult BeginAsyncMethod(CustomClass paramCustomClass, AsyncCallback callback, object state)
        {            
            Task<bool> task = Task<bool>.Factory.StartNew(p => slowMethod(paramCustomClass, state);
            return task.ContinueWith(res => callback(task));
        }

public bool EndAsyncMethod(IAsyncResult paramResult)
        {
            return ((Task<bool>)paramResult).Result;
        } 
```

slowMethod 是一个虚拟方法，其中一个 for 从 i = 0 到 1000000000。

客户

```
private void callAsyncMethod()
{
      Task<bool> task = Task<bool>.Factory.FromAsync(_proxy.Proxy.BeginAsyncMethod, _proxy.Proxy.EndAsyncMethod, CustomClass, null);    
      bool hasFinished= task.Result;
} 
```

在客户端中，我有一个调用 callAsyncMethod 的按钮，当我单击该按钮时，GUI 在 slowMethod 运行时被阻塞。

如果我没记错的话，异步方法会将控制权返回给调用者以避免程序被阻塞，但在我的情况下这不会发生。我误解了什么吗？我以错误的方式使用异步方法？

谢谢。戴姆洛克。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T00:20:49.530

即使这些方法是异步的，您仍在等待结果返回，从而有效地阻塞了调用线程 (UI)。当您访问对象的`Result`属性时`Task`，如果任务尚未完成，它将阻塞，直到结果可用。

您应该异步调用异步方法。如果您使用的是 .NET 4.5，则可以使用 await 关键字：

```
private async void callAsyncMethod() 
{ 
    Task<bool> task = Task<bool>.Factory.FromAsync(_proxy.Proxy.BeginAsyncMethod, _proxy.Proxy.EndAsyncMethod, CustomClass, null);     
    bool hasFinished = await task;
} 
```

否则你真的需要使调用异步

```
private void callAsyncMethod() {
    _proxy.Proxy.BeginAsyncMethod(CustomClass, null, MyCallback, _proxy);
}

private void MyCallback(IAsyncResult asyncResult) {
    bool hasFinished = _proxy.Proxy.EndAsyncMethod(asyncResult);
} 
```

# java - Servlet - 仅基于会话发送响应

> ID：10366470
> 
> 赞同：-3
> 
> 时间：2012-04-28T18:43:33.253
> 
> 标签：java, jsp, servlets

我收到一个客户端的请求，我想构建一个响应并将其发送给两个客户端（其中一个是请求者）。我知道的关于另一个客户端的唯一信息是它的会话。有没有办法`HttpResponse`使用对象来构造`HttpSession`对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:05:26.057

我不确定您要完成什么，但您可能想通过“reversal ajax”联系第二个客户。你可能想看看[彗星编程](http://en.wikipedia.org/wiki/Comet_%28programming%29)

> Comet 是一种 Web 应用程序模型，其中长期持有的 HTTP 请求允许 Web 服务器将数据推送到浏览器，而无需浏览器显式请求它。**维基百科**

# c++ - std::vector 在哪里分配内存？

> ID：10366474
> 
> 赞同：35
> 
> 时间：2012-04-28T18:43:52.617
> 
> 标签：c++, memory-management, stl, vector

考虑以下代码片段：

```
#include <vector>
using namespace std;

void sub(vector<int>& vec) {
    vec.push_back(5);
}

int main() {
    vector<int> vec(4,0);
    sub(vec);
    return 0;
} 
```

假设“vec”没有空间来存储“sub”函数中的5，它在哪里分配新内存？

在子函数的栈帧中？在这种情况下， 5 将在子函数的末尾被删除。但是主函数的栈帧不能增长，因为此时子函数的栈帧位于栈顶。
std::vector 是否为其在堆上的元素分配内存？但是它是如何释放堆内存的呢？如果它是堆栈上的本地向量，那么包含该向量的函数的堆栈帧最终会被删除，而不会通知向量它将被删除？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-04-28T18:46:49.760

> std::vector 是否为其在堆上的元素分配内存？

是的。或者更准确地说，它根据您在构建时传入的分配器进行分配。你没有指定一个，所以你得到了默认的分配器。默认情况下，这将是[heap](http://www.cplusplus.com/reference/std/memory/allocator/allocate/)。

> 但是它是如何释放堆内存的呢？

当它超出范围时通过它的[析构函数。](http://en.wikipedia.org/wiki/Destructor_%28computer_programming%29#In_C.2B.2B)（请注意，*指向*超出范围的向量的指针不会触发析构函数）。但是，如果您按值传递给`sub`您，您将构建（然后破坏）一个新副本。然后 5 将被推回该副本，该副本将被清理，并且向量 in`main`将保持不变。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-28T18:54:40.717

STL 中的所有容器都使用模板参数进行参数化，通常最后一个参数被调用`A`或`Allocator`默认为`std::allocator<...>`where`...`表示存储在容器中的值的类型。

这`Allocator`是一个用于提供内存和构建/销毁此内存区域中的元素的类。它可以从池中分配内存，也可以直接从堆中分配内存，无论您从哪个构建分配器。默认情况下，它`std::allocator<T>`是一个简单的包装器`::operator new`，因此将按照您的推断在堆上分配内存。

内存是按需分配的，至少在`vector`调用 's 的析构函数时会被释放。C++11`shrink_to_fit`也引入了更快的释放内存。最后，当向量超出其当前容量时，会进行新的（更大的）分配，将对象移动到其中，并释放旧的分配。

与所有局部变量一样，析构函数在执行到它已声明到的范围的末尾时被调用。所以，在函数退出之前，向量析构函数被调用，只有在之后堆栈收缩并且控制权返回给调用者。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-28T18:56:57.577

另请注意，您的向量 ( `vec`) 是对象本身。它驻留在堆栈上，当此对象超出范围（`main`在您的情况下为结束）时，它会被破坏。元素的内存在此对象的初始化期间分配并随着其销毁而释放，这是[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)习惯用法的一个可爱示例，因为元素的资源管理与向量对象的生命周期相关联。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T18:45:45.567

因为你在堆中给了 sub 向量的地址，所以它将在堆中分配。如果没有剩余空间，应该抛出异常。

# php - 如何获取我的 var 的值，哪个双美元 var 是从多维数组中设置的？

> ID：10366480
> 
> 赞同：0
> 
> 时间：2012-04-28T18:44:17.967
> 
> 标签：php

我设法动态创建我的数组（`$$myGenre`包含每个`name => id`），但`$myGenre`不包含任何东西......我怎样才能使它工作：`$myGenre`应该包含每个`$$myGenre`，`$$myGenre`应该有它的内容`name => id`，并且我们应该让每个彼此`$myGenre`分开（这里，因为`foreach`，我们覆盖 `$myGenre`了每种不同的流派）：

```
<?php function findSection() {
    global $post, $custom_meta_fields, $myGenre;
    foreach ($custom_meta_fields as $fields) {  

        foreach ($fields as $field) {

            if ($field == $fields['genre']) {

                $myGenre = array($field['title']);
                $$myGenre = array();

            } else {
                ${$myGenre}[$field['name']] = $field['id'];
            }
        }
        var_dump($$myGenre);
     }
}

$custom_meta_fields = array(
                            array( //THRILLER
                            'genre' => array( 'title' => 'Thriller'),
                            'fields' => array(
                                        'name' => 'Movie1',
                                        'desc' => 'Desc movie1',
                                        'id' => 'id1',
                                        'type' => 'text'),
                                        array(
                                            'name' => 'Movie2',
                                            'desc' => 'desc movie2',
                                            'id' => 'id2',
                                            'type' => 'text'
                                              ),
                                        array(
                                            'name'  => 'movie3',
                                            'desc'  => 'desc',
                                            'id'    => 'id3',
                                            'type'  => 'image'
                                            )
                            ),
                            array(
                                'genre' => array( 'title' => 'Action'),
                                'fields' =>  array('name' => 'Action1',
                                           'desc' => 'desc act1',
                                           'id'   => 'idAction1')
                            )
                        );

findSection(); 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:03:35.197

我修改了你的代码，使它使用关联数组，因为你用你的双美元做了一些很奇怪的事情。

```
<?php
function findSection() {
    global $post, $custom_meta_fields, $myGenre;
    foreach ($custom_meta_fields as $fields) {  

        foreach ($fields as $field) {

            if ($field == $fields['genre']) {

                $genre =$field['title'];
                $all[$genre]= array();

            } else {
                $all[$genre][$field['name']] = $field['id'];
            }
        }
     }
    echo "<pre>".var_export($all,TRUE)."</pre>";
} 
```

结果：

```
array (
  'Thriller' => 
  array (
    'Movie1' => 'id1',
    'Movie2' => 'id2',
    'movie3' => 'id3',
  ),
  'Action' => 
  array (
    'Action1' => 'idAction1',
  ),
) 
```

# jquery - jQuery 屏蔽输入插件与验证插件冲突

> ID：10366481
> 
> 赞同：6
> 
> 时间：2012-04-28T18:44:31.117
> 
> 标签：jquery, jquery-validate, maskedinput

[给定一个使用Masked Input](http://digitalbush.com/projects/masked-input-plugin/)插件屏蔽的文本框，并由 Validation Plugin 标记为必填字段，请考虑以下内容：

如果您将焦点放在被屏蔽的文本框中，然后不输入任何信息（或没有输入足够的信息以满足屏蔽），则被屏蔽的输入插件将删除所有内容，留下一个空文本框。

```
$("#phoneNumber").mask("(999) 999-9999? x999999");
$("#sampleForm").validate({
    rules: {
        phoneNumber: "required"
    }
}); 
```

验证插件似乎在屏蔽输入插件**之前触发了它的***模糊*事件。这导致文本框通过验证（因为它确实有文本），然后被屏蔽的输入插件启动并删除文本。一旦失去焦点，该字段应被标记为无效。

 **我试过使用正则表达式验证器。它接近了，但又一次，因为它在被屏蔽的输入插件清理字段之前触发，它在不应该显示错误时显示错误（尽管当用户尝试提交表单时错误消失）。

我也试过这个：

```
$('input').bind('unmasked.maskedInput', function () { $(this).valid(); }); 
```

这可行，但它也会干扰验证器的初始行为：在按下提交按钮之前不会验证字段，然后在失去焦点时验证它们。

我已经设置了一个描述我遇到的问题的[jsFiddle](http://jsfiddle.net/Pk2pk/2/)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T07:25:58.953

Hiya**工作演示** [http://jsfiddle.net/2hdTn/](http://jsfiddle.net/2hdTn/)

Cooleos 所以如果我做对了，蒙面插件会删除输入，因此会造成混乱。:)

在上面的示例演示中，输入的数字将保持输入状态，您可以使用它进行验证。

哦，如果这有帮助，请不要忘记接受答案并投票。

另见这里：还有`clearEmpty: false` [http://view.jqueryui.com/mask/tests/visual/mask/mask.html](http://view.jqueryui.com/mask/tests/visual/mask/mask.html)

你可能只需要使整个面具可选，`bingo`它会工作:)

（如果我错过了什么，请告诉我）

**jQuery代码**

```
jQuery.validator.addMethod("usPhoneFormat", function (value, element) {
    return this.optional(element) || /^\(\d{3}\) \d{3}\-\d{4}( x\d{1,6})?$/.test(value);
}, "Enter a valid phone number.");

$.fn.ready(function () {

    $("#sampleForm").validate({
        rules: {
            phoneNumber: "required",
            phoneNumberRegEx: {
                usPhoneFormat: true,
                required: true
            },
            phoneNumberReg: "required"
        },
        submitHandler: function (form) {
            alert("submitted.");
        }
    });
    $(".phone").mask("?(999) 999-9999 x999999");
    //alert('foo');
});

​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-27T10:55:19.107

您可以重新验证焦点输出/模糊的输入。

```
$('#inputId').on('blur', function(){
    $('#formId').validate().element('#inputId')
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-20T20:13:50.010

```
phone_no:{
    icon: 'false',
    validators: {
        notEmpty: {
            message: 'Contact Phoneno is required'
        },
        regexp: {
            regexp: /^\d{3}\-\d{3}\-\d{4}$/,
            message: 'Please Enter Valid Phone number'
        }
    }
} 
```

在 formvalidator 上输入这个，就可以正常工作了**

# ruby-on-rails - 在 ruby on rails 中创建一个列表框

> ID：10366482
> 
> 赞同：0
> 
> 时间：2012-04-28T18:44:38.637
> 
> 标签：ruby-on-rails, ruby

有没有一种简单的方法可以在 Ruby on Rails 的列表框中显示值？（类似于在 ruby​​ 中添加 html 选择标记多个属性）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T19:40:57.393

你是这个意思？

```
select_tag "list[]", options_from_collection_for_select(@collection, "id", "name"), :multiple=>true 
```

# c - 将 NAN 浮点数转换为 int 的问题

> ID：10366485
> 
> 赞同：21
> 
> 时间：2012-04-28T18:44:59.083
> 
> 标签：c, floating-point, nan

忽略我为什么要这样做，754 IEEE fp 标准没有定义以下行为：

```
float h = NAN;
printf("%x %d\n", (int)h, (int)h);

Gives: 80000000 -2147483648 
```

基本上，无论我给出什么 NAN 值，它都会输出 80000000（十六进制）或 -2147483648（十进制）。这是否有原因和/或这是正确的行为？如果有，怎么来的？

我给它不同的 NaN 值的方式在这里： [如何手动设置等于 NaN 的浮点数的位值？](https://stackoverflow.com/questions/10365328/how-can-i-manually-set-the-bit-value-of-a-float-that-equates-to-nan)

所以基本上，是否存在 NaN 的有效负载会影响演员表输出的情况？

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-28T18:53:32.897

将浮点数转换为整数的结果对于不在整数变量范围内的值（±1 用于截断）未定义/未指定。

第 6.3.1.4 条：

> 当实浮点类型的有限值转换为除 以外的整数类型`_Bool`时，小数部分被丢弃（即，该值被截断为 0）。如果整数部分的值不能用整数类型表示，则行为未定义。

如果实现定义了`__STDC_IEC_559__`，那么对于从浮点类型到除 之外的整数类型的转换`_BOOL`：

> 如果浮点值是无穷大或 NaN，或者如果浮点值的整数部分超出整数类型的范围，则引发“无效”浮点异常并且未指定结果值。

（附件 F [规范性文件]，第 4 点。）

如果实现没有定义`__STDC_IEC_559__`，那么所有的赌注都没有。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-01T15:37:40.090

这种行为是有原因的，但这不是您通常应该依赖的。

正如您所注意到的，IEEE-754 没有指定将浮点 NaN 转换为整数时会发生什么，除了它应该引发一个无效的操作异常，您的编译器可能会忽略它。C标准说行为是未定义的，这意味着你不仅不知道你会得到什么整数结果，你根本不知道你的程序会做什么；该标准允许程序中止或获得疯狂的结果或做任何事情。您可能在 Intel 处理器上执行了该程序，并且您的编译器可能使用内置指令之一进行了转换。英特尔非常仔细地指定指令行为，将浮点 NaN 转换为 32 位整数的行为是返回 0x80000000，而不管 NaN 的有效负载如何，这是您观察到的。

因为 Intel 指定了指令行为，所以如果您知道使用的指令，就可以依赖它。但是，由于编译器不向您提供此类保证，因此您不能依赖正在使用的这条指令。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-28T18:58:25.393

首先，根据 IEEE 标准，NAN 是不被视为浮点数的所有内容。所以它可以是几件事。在我使用的编译器中有 NAN 和 -NAN，所以它不仅仅是一个值。

其次，每个编译器都有自己`isnan`的函数集来测试这种情况，因此程序员不必自己处理这些位。总而言之，我认为偷看价值没有任何区别。您可能会窥视其 IEEE 构造的值，例如符号、尾数和指数，但是，同样，每个编译器都提供了自己的函数（或者更好的说法是库）来处理它。

不过，关于你的测试，我确实有更多话要说。

```
float h = NAN;
printf("%x %d\n", (int)h, (int)h); 
```

您所做的转换将浮点数转换为整数。如果要获取浮点数表示的整数，请执行以下操作

```
printf("%x %d\n", *(int *)&h, *(int *)&h); 
```

也就是说，你取浮点数的地址，然后将其作为指向 int 的指针引用，最终取 int 值。这样就保留了位表示。

# python - python的函数scipy.optimize.fmin

> ID：10366486
> 
> 赞同：0
> 
> 时间：2012-04-28T18:45:12.010
> 
> 标签：python, python-2.7

我正在尝试使用 scipy.optimize.fmin 最小化 khi 方。这是我的函数，（它调用了另一个模拟函数spotdiffusion）。返回值 (chi) 是一个包含两个 khi 值的数组（一个用于一致条件，另一个用于不一致条件），我尝试将其最小化：

```
def chis (a, ter , v , sda , rd):

    ncond=1 
    ntrials = 1000 
    observed_data = np.array ([ [0.9995835, 24.0, 329.5, 357.9, 370.5, 391.5, 457.6, 0.0004164931, 0, 0],#congruent cond
                                [0.6953498, 16,   409.5, 450.5, 481,   529,   546 ,  0.3046502 ,  7 ,350]])#incongruent cond

    q_probs=np.array ([.1,.2,.2,.2,.2,.1])   
    b_probs=np.array([0.501,0.499])   

    cond = np.arange (0, ncond)
    chi = []
    for g in cond:
        if(g==0):
            fl= 1.0   #flankers congruent with target    
        if(g==1):
            fl= -1.0   # incongruent

        #########
        simTRcorrect, simTRerror, simprobc, simprobe = spotdiffusion (a ,ter ,v, sda,rd ,fl, ntrials = 1000)
        #########        
        top_data = observed_data[g,0]*q_probs  
        bot_data=observed_data[g,7]*b_probs    

        pt1 = (len (simTRcorrect [simTRcorrect < observed_data[g, 2]])) /ntrials 
        pt2 = (len (simTRcorrect [(simTRcorrect < observed_data[g, 3]) & (simTRcorrect >= observed_data[g, 2])])) /ntrials
        pt3 = (len (simTRcorrect [(simTRcorrect < observed_data[g, 4]) & (simTRcorrect >= observed_data[g, 3])])) /ntrials 
        pt4 = (len (simTRcorrect [(simTRcorrect < observed_data[g, 5]) & (simTRcorrect >= observed_data[g, 4])])) /ntrials
        pt5 = (len (simTRcorrect [(simTRcorrect < observed_data[g, 6]) & (simTRcorrect >= observed_data[g, 5])])) /ntrials
        pt6=(len (simTRcorrect [simTRcorrect > observed_data[g, 6]])) /ntrials

        pred_p= np.array ([pt1,pt2,pt3,pt4,pt5,pt6])
        top_chi_array = (np.square (top_data-pred_p))/ (pred_p+ 0.001)
        top_chi = np.sum (top_chi_array) 

        pt1 = (len (simTRerror[simTRerror < observed_data[g, 9]]))  /ntrials
        pt2 = (len (simTRerror[simTRerror >= observed_data[g, 9]])) /ntrials

        pred_p=np.array ([pt1,pt2])
        bot_chi_array = (np.square (bot_data-pred_p)) / (pred_p+ 0.001)
        bot_chi= np.sum (bot_chi_array)

        totchi=(bot_chi+top_chi)*(observed_data[g,1]+ observed_data[g,8])

        chi.append (totchi)

    chi = np.array (chi)       
    return chi 
```

下面是装修过程：

```
x0 = np.array ([0.11, 0.25,0.35,1.7,0.017]) ####for initial guess 
xopt = fmin (chis(a, ter , v , sda , rd), x0, maxiter=300) 
```

我有一个我不明白的错误：

```
Traceback (most recent call last):
  File "<ipython console>", line 1, in <module>
  File "C:\Python27\lib\site-packages\spyderlib\widgets\externalshell\startup.py", line 128, in runfile
    execfile(filename, glbs)
  File "C:\Users\mathieu\Desktop\modeling\spotlight diffusion model\fitting_spotlight.py", line 245, in <module>
    xopt = fmin (chis(a, ter , v , sda , rd), x0, maxiter=300)
  File "C:\Python27\lib\site-packages\scipy\optimize\optimize.py", line 257, in fmin
    fsim[0] = func(x0)
  File "C:\Python27\lib\site-packages\scipy\optimize\optimize.py", line 176, in function_wrapper
    return function(x, *args)
TypeError: 'numpy.float64' object is not callable 
```

有谁知道出了什么问题？

干杯，垫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:32:33.677

问题出在这一行：

```
xopt = fmin (chis(a, ter , v , sda , rd), x0, maxiter=300) 
```

表达方式

```
chis(a, ter , v , sda , rd) 
```

是最有可能的数字。这是*调用*函数的结果`chis`。

相反，我们希望将*函数对象* `chis`传递给`fmin`函数，而无需`chis`先调用。（如果我们通过`chis(a, ter, v, sda, rd)`then`fmin`只会得到一个数字作为它的第一个参数。如果我们传递函数对象`chis`本身，那么`fmin`可以`chis`从`fmin`.

所以试试吧

```
xopt = fmin (chis, x0, maxiter=300) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T22:50:11.437

问题似乎都在 - 一致：

```
xopt=fmin(chis(a,ter,v,sda,rd),x0,maxiter=300) 
```

应该像以前的用户提到的那样

```
xopt=fmin(chis,x0,maxiter=300) 
```

而且在开始时，函数已经定义，参数应该作为数组给出

代替

```
def chis (a, ter , v , sda , rd): 
```

尝试这个：

```
def chis (arrays):

    a=arrays[0]
    ter=arrays[1]
    v=arrays[2]
    sda=arrays[3]
    rd=arrays[4] 
```

# visual-studio-2010 - Team Foundation Server 2010 (SP1) 中的图像问题

> ID：10366490
> 
> 赞同：0
> 
> 时间：2012-04-28T18:45:48.817
> 
> 标签：visual-studio-2010

我们在使用 Team Foundation Server 2010 时遇到问题。即使在安装 Service Pack 1 之后，有时在执行*get latest时***图像**（在网站项目中）仍然没有更新或下载。

 *有没有人熟悉这个问题，更重要的是，有没有人知道如何摆脱这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:19:28.013

我们在我们的网络项目中遇到了同样的问题，我们必须从项目中排除文件提交更改，然后将图像添加回项目并再次提交以更新图像。*

# .htaccess - yii，开发和 URL 问题

> ID：10366502
> 
> 赞同：0
> 
> 时间：2012-04-28T18:47:55.430
> 
> 标签：.htaccess, url-rewriting, yii

我们的服务器运行在 173......54/

对于开发，我们想要一份可以在 173.....54/~me/site 测试的代码副本

当我在 ~me/ 文件夹中安装 Yii 的副本和代码并访问 173.....54/~me/site 时，我能够看到新安装的索引 html。但是，如果我尝试移动到 173.....54/~me/site/book 或用户注册页面或任何其他页面，其他（主）Yii 应用程序会将代码读取为未找到的链接而不是开发Yii 应用程序。

我是否应该更新 htaccess 文件以忽略 /~me 中的请求？如果是这样，它应该怎么看？还是我错过了什么？

再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T20:22:34.597

无需在其他 .htaccess 中忽略，开发站点 .htaccess 会处理它。在你的开发站点根目录下的 index.php 中，你需要将 $yii 指向你的 Yii 框架/yii.php

然后在开发站点根目录的 .htaccess 中，您需要将 RewriteBase 指向您的开发站点根目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T13:28:56.127

还要确保在 index.php 中指向与您的应用程序对应的正确配置文件

# java - JSP 表单不发送到数据库。使用 bean

> ID：10366503
> 
> 赞同：1
> 
> 时间：2012-04-28T18:47:59.033
> 
> 标签：java, sql, database, forms, jsp

当我从表单提交数据时，它不会保存到数据库中...没有发生错误...

我可以从数据库中检索但不能保存到它...

继承人的代码：

测试.jsp

```
 <%@page import="java.util.ArrayList"%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<%@ page import="java.util.*" %>
<%@ page import="my.beans.StudentBean"%>

<jsp:useBean id="studentData" scope="request"
             class="my.beans.StudentDataBean"/>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Words View</title>
        <style type="text/css">
               table, tr, td, th
               {
                    text-algn: center;
                    font-size: .9em;
                    border: 3px groove;
                    padding: 3px;
                    background-color: #eee9e9;
               }
        </style>
    </head>
    <body>
        <h1>Student List</h1>
        <table border="1">
            <tr>
                <th>
                    <h4>First Name</h4>
                </th>
                <th>
                    <h4>Last Name</h4>
                </th>
                <th>
                    <h4>Comment</h4>
                </th>
                <th>
                    <h4>Email</h4>
                </th>
                </tr>
                    <%
                        ArrayList<StudentBean> studentList = studentData.getStudentList();
                        Iterator studentListIterator = studentList.iterator();
                        StudentBean student;

                        while (studentListIterator.hasNext()){
                            student = (StudentBean) studentListIterator.next();
                    %>
                <tr>
                    <td><%= student.getFirstName()%></td>
                    <td><%= student.getLastName()%></td>
                    <td><%= student.getComment()%></td>
                    <td><%= student.getEmail()%></td>
                </tr>
                <% }
                %>
        </table>
    </body>
</html> 
```

formTest.jsp

```
<%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%>

<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">

<jsp:useBean id = "student" scope = "page"
             class = "my.beans.StudentBean" />
<jsp:useBean id = "studentD" scope = "page"
             class = "my.beans.StudentDataBean" />

<html>
    <form method="post" action="test.jsp">
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <title>Student Login</title>
        </head>
        <body>
            <jsp:setProperty name = "student" property = "*" />
            <% // start scriptlet
                if (student.getFirstName() == null
                        || student.getLastName() == null
                        || student.getEmail() == null
                        || student.getComment() == null) {
            %>
            Enter forename, surname, student ID and email address to <br />
            register.<br />
            <br />
            <table border="1">
                <tr>
                    <td>First Name:</td>
                    <td>
                        <input type="text" name="first" />
                    </td>
                </tr>
                <tr>
                    <td>Last Name:</td>
                    <td>
                        <input type="text" name="last" />
                    </td>
                </tr>
                <tr>
                    <td>Email:</td>
                    <td>
                        <input type="text" name="email" />
                    </td>
                </tr>
                <tr>
                    <td>Comment:</td>
                    <td>
                        <input type="text" name="comment" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="submit" value="Submit" />
                    </td>
                </tr>
            </table>
        </body>
    </form>
    <%            } else {
        studentD.addStudent(student);
    %>
    <jsp:forward page="test.jsp" />
    <%
        }
    %>
</html> 
```

然后我的豆子...

StudentBean.java

```
package my.beans;

public class StudentBean {

        /***********\
         * Globals *
        \***********/

    private String firstName;
    private String lastName;
    private String comment;
    private String email;

        public StudentBean(){

        }

        // get/set for First Name
    public void setFirstName(String f) {
        firstName = f;
    }
        public String getFirstName(){
                return firstName;
        }

        // get/set for Last Name
    public void setLastName(String l) {
        lastName = l;
    }
        public String getLastName(){
                return lastName;
        }

        // get/set for comment
    public void setComment(String co) {
        comment = co;
    }
        public String getComment(){
                return comment;
        }

        // get/set for Email
    public void setEmail(String em) {
        email = em;
    }
        public String getEmail(){
                return email;
        }
} 
```

StudentDataBean.java

```
package my.beans;

import java.sql.SQLException;
import javax.sql.rowset.CachedRowSet;
import java.util.ArrayList;
import com.sun.rowset.CachedRowSetImpl; // CachedRowSet implementation

public class StudentDataBean {

   private CachedRowSet rowSet;

   // construct TitlesBean object 
   public StudentDataBean() throws ClassNotFoundException, SQLException{
      // load the MySQL driver
      Class.forName("com.mysql.jdbc.Driver");

      // specify properties of CachedRowSet
      rowSet = new CachedRowSetImpl();
      rowSet.setUrl("jdbc:mysql://localhost:3306/test"); 
      rowSet.setUsername("root");
      rowSet.setPassword("");

      // obtain list of titles
      rowSet.setCommand("SELECT firstName, lastName, email, comment FROM guests" );
      rowSet.execute();
   } // end StudentDataBean constructor

   // return an ArrayList of StudnetBeans
   public ArrayList<StudentBean> getStudentList() throws SQLException{
      ArrayList<StudentBean> studentList = new ArrayList<StudentBean>();

      rowSet.beforeFirst(); // move cursor before the first row

      // get row data
      while (rowSet.next()){
         StudentBean student = new StudentBean();

         student.setFirstName(rowSet.getString(1));
         student.setLastName(rowSet.getString(2));
         student.setEmail(rowSet.getString(3));
         student.setComment(rowSet.getString(4));

         studentList.add( student ); 
      } // end while

      return studentList;
   } // end method getStudentList

   // insert a Student in student database
   public void addStudent(StudentBean student) throws SQLException
   {
      rowSet.moveToInsertRow(); // move cursor to the insert row

      // update the three columns of the insert row 
      rowSet.updateString( 1, student.getFirstName() ); 
      rowSet.updateString( 2, student.getLastName() ); 
      rowSet.updateString( 3, student.getEmail() ); 
      rowSet.updateString( 4, student.getComment() ); 
      rowSet.insertRow(); // insert row to rowSet
      rowSet.moveToCurrentRow(); // move cursor to the current row
              try{
            rowSet.acceptChanges();
        }
        catch(Exception e){
            System.out.println("Exception caught at line 67: " + e);
        } 
   } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T10:42:53.697

问题已解决：我的 java 约定不匹配是一个错误。

# java - 如何在 GL Linux 服务器命令行中使用 Java GUI？

> ID：10366504
> 
> 赞同：2
> 
> 时间：2012-04-28T18:48:03.150
> 
> 标签：java, linux, user-interface, command-line

我学校的项目都是在 Linux 服务器上完成的，都是用命令行完成的，没有 GUI。我的一个 java 项目要求我创建一个 java GUI 并能够在 GL 服务器上构建和运行该项目。

我很困惑，因为 GL 服务器都是命令行，但我的教授说可以做到。

为了连接到学校的 GL 服务器，我使用了 Putty。我不知道这是否重要。我正在为 Java GUI 使用 swing。我使用 ant 编译和运行，我的教授在给它评分时也会这样做。

我成功地构建了程序，但是当我运行它时，出现了：

```
Buildfile: build.xml

run:
     [java] Exception in thread "main" java.awt.HeadlessException:
     [java] No X11 DISPLAY variable was set, but this program performed an operation which requires it.
     [java]     at java.awt.GraphicsEnvironment.checkHeadless(GraphicsEnvironment.java:159)
     [java]     at java.awt.Window.<init>(Window.java:406)
     [java]     at java.awt.Frame.<init>(Frame.java:402)
     [java]     at javax.swing.JFrame.<init>(JFrame.java:207)
     [java]     at gui.PushCounter.main(PushCounter.java:18)
     [java] Java Result: 1

BUILD SUCCESSFUL
Total time: 0 seconds 
```

当您使用命令行时，是否有不同的类或方法在 Java 中创建 GUI？除了 Putty 之外，我还可以登录另一个更适合使用 Java GUI 的终端吗？我必须在我的代码或 Linux 服务器中添加一些额外的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:32:52.117

Swing 可能是创建 GUI 的不错选择；我看不出你为什么要改变它。

我建议看一下X转发。使用 X 转发，您可以像往常一样通过 SSH 连接到服务器。服务器运行您的所有代码并处理您的 GUI 的创建。然后它将窗口显示信息发送回您的机器。

我找到了[在 PuTTy 中配置 X 转发的快速指南](http://www.math.umn.edu/systems_guide/putty_xwin32.html)。它应该很好地满足您的需求。

### 注意事项

要使 X 转发工作，您的 SSH 配置必须启用它。你当然可以和你的教授讨论这个——这是对 sshd 配置文件的简单更改。如果您和服务器都在校园内，则 X 转发的速度不应成为问题，但请注意，这可能是其他网络设置的一个缺点。

# c++ - 使用旋转矩阵旋转 Texture2d

> ID：10366505
> 
> 赞同：0
> 
> 时间：2012-04-28T18:48:43.690
> 
> 标签：c++, opengl-es

我想在 cocos2d-x(opengl es) 中旋转 2d 纹理，因为我搜索我应该使用旋转矩阵：

> (x = cos(deg) * x - sin(deg) * yy = sin(deg) * x + cos(deg) * y)

但是当我想实现这个公式时，我可能会失败代码就像（我希望原始 x 和 y 相同）：我将我的代码更新为此但仍然无法正常工作！

```
 GLfloat    coordinates[] = {
        0.0f,   text->getMaxS(),
        text->getMaxS(),text->getMaxT(),
        0.0f,   0.0f,
        text->getMaxS(),0.0f };
     glMatrixMode(GL_MODELVIEW);
    glPushMatrix();

    GLfloat vertices[] = {  rect.origin.x,      rect.origin.y,                          1.0f,
                            rect.origin.x + rect.size.width,        rect.origin.y,                          1.0f,
                            rect.origin.x,                          rect.origin.y + rect.size.height,       1.0f,
                            rect.origin.x + rect.size.width,        rect.origin.y + rect.size.height,       1.0f };

    glMultMatrixf(vertices);
    glTranslatef(p1.x, p1.y, 0.0f);
    glRotatef(a,0,0,1);
    glBindTexture(GL_TEXTURE_2D, text->getName());
    glVertexPointer(3, GL_FLOAT, 0, vertices);
    glTexCoordPointer(2, GL_FLOAT, 0, coordinates);
    glColor4f( 0, 0, 250, 1);
    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);
    glRotatef(-a, 0.0f, 0.0f, -1.0f);
    glPopMatrix(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:12:31.097

如果您在二维中使用 OpenGL，您仍然可以使用各种转换函数。对于`glRotate()`，您必须将 (0,0,1) 的轴传递给它：

```
glRotate(angle,0,0,1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T22:23:27.160

您似乎对 OpenGL 的某些方面感到困惑。此刻你有这个：

```
glMultMatrixf(vertices);
glTranslatef(p1.x, p1.y, 0.0f);
glRotatef(a,0,0,1);
glBindTexture(GL_TEXTURE_2D, text->getName());
glVertexPointer(3, GL_FLOAT, 0, vertices);
glTexCoordPointer(2, GL_FLOAT, 0, coordinates);
glColor4f( 0, 0, 250, 1);
glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);
glRotatef(-a, 0.0f, 0.0f, -1.0f);
glPopMatrix(); 
```

那表面上是：

```
// reinterpret your vertices as a matrix; multiply the
// current matrix by the one formed from your vertices
glMultMatrixf(vertices);

// rotate by a degrees, then translate to p1
glTranslatef(p1.x, p1.y, 0.0f);
glRotatef(a,0,0,1);

// bind the relevant texture, supply the vertices
// as vertices this time, supply texture coordinates
glBindTexture(GL_TEXTURE_2D, text->getName());
glVertexPointer(3, GL_FLOAT, 0, vertices);
glTexCoordPointer(2, GL_FLOAT, 0, coordinates);

// set a colour of (0, 0, 1, 1) — probably you
// wanted glColor4ub to set a colour of (0, 0, 250/255, 1)?
glColor4f( 0, 0, 250, 1);

// draw some geometry
glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

// perform the same rotation as before a second time;
// giving either a and -1, or -a and 1 would have been
// the opposite rotation
glRotatef(-a, 0.0f, 0.0f, -1.0f);

// remove the current matrix from the stack
glPopMatrix(); 
```

你可能想要的是：

```
// push the current matrix, so that the following
// transformations can be undone with a pop
glPushMatrix();

// rotate by a degrees, then translate to p1
glTranslatef(p1.x, p1.y, 0.0f);
glRotatef(a,0,0,1);

// bind the relevant texture, supply the vertices
// as vertices this time, supply texture coordinates
glBindTexture(GL_TEXTURE_2D, text->getName());
glVertexPointer(3, GL_FLOAT, 0, vertices);
glTexCoordPointer(2, GL_FLOAT, 0, coordinates);

// set a colour of (0, 0, 250/255, 1)
glColor4ub( 0, 0, 250, 1);

// draw some geometry
glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

// remove the current matrix from the stack
glPopMatrix(); 
```

当前变换矩阵应用于所有几何体。您不会标记它们适用于哪些几何图形以及它们不适用哪些几何图形。Push 和 pop 应该配对，并且当你想要的时候，这是你影响转换不受先前转换影响的方式。因此，您无需手动执行反向旋转，并且在执行所有更改矩阵的操作之前需要推动。由于上面给出的原因，我也将您切换到`glColor4ub`了 - 您似乎正在使用无符号字节来推送颜色，但 OpenGL 使用从 0.0 到 1.0 的范围来表示颜色。`glColor4ub`会自动从前者映射到后者。

# facebook - 打开图形调用生成 OAuth 异常

> ID：10366509
> 
> 赞同：1
> 
> 时间：2012-04-28T18:49:16.043
> 
> 标签：facebook, facebook-graph-api, oauth, facebook-opengraph

我在使 Open Graph 实现正常工作时遇到了一些问题。

据我所知，我有正确的元标记。当我将 URL 粘贴到 Open Graph Debugger 中时，它会返回定义的正确信息（标题、描述、图像等），并且没有错误。

我有 3.1.1 版的 Facebook PHP SDK。

我为我的开发应用程序启用了 Open Graph，并且定义了一个操作 ( `read`) 和一个对象 ( `article`)。

有问题的实现是一个网站，而不是一个 facebook 应用程序。在 facebook 上，应用程序的“类别”是“其他”。我在另一个线程中遵循了一些建议，并将其更改为“游戏”，但不起作用，所以我将其更改回来。

我使用 facebook 验证我的网络应用程序用户并收到一个代码，然后我用它换取一个`access_token`非常标准的代码。我要求以下权限：

*   `publish_stream`
*   `publish_actions`
*   `offline_access`

但是，当我尝试调用发布操作时，我收到 OAuthException，并且没有真正的调试方法。

一些怪事：

*   图 API 似乎不喜欢文档中指定的 URL 格式：`me/[app_namespace]:[action_type]`. 在我的情况下，这将是`me/' . FB_APP_NAMESPACE . ':read`FB_APP_NAMESPACE 之前定义为 facebook 应用程序设置中定义的命名空间。API 和 Graph API Explorer 都会抛出一个错误，指出它不理解给定的操作。它似乎试图将命名空间读取为操作。
*   `og:type`如果我从 url 中删除命名空间，它会报告传入的操作与 url 中定义的不匹配，因为`og:type`url 中包含我删除的相同命名空间。
*   如果我从元标记中删除*该*命名空间，然后再试一次，我会得到一个无法调试的通用 OAuthException。
*   当我查看我的 facebook 应用程序中提供的代码示例时，该操作似乎`news.reads`不仅仅是`read`.
*   如果我使用该操作，图形 API 会返回一个错误，指出我的 ID 未经授权无法使用打开的图形，因为它不是我的应用程序的管理员、开发人员或测试人员。不幸的是，我是应用程序的创建者，这意味着要么图形 API 在撒谎，要么我在对自己撒谎！

我认为解决方案很简单——也许我忘记了什么，或者选择了某个类别不正确。无论哪种方式，至少可以说，这有点令人沮丧！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:28:48.177

`read`显然，如果您的应用程序/操作未提交，则无法使用facebook 的默认调用。

我最终创建了自己的`read`动作，并且在第一次尝试时就奏效了。去搞清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T11:01:29.410

对于预定义的操作，post url 略有不同，您必须使用如下内容：

```
POST https://graph.facebook.com/me/news.reads?article=[article object URL] 
```

请参阅：[https ://developers.facebook.com/docs/opengraph/actions/builtin/#read](https://developers.facebook.com/docs/opengraph/actions/builtin/#read)

# php - CI 无法在本地工作

> ID：10366511
> 
> 赞同：0
> 
> 时间：2012-04-28T18:49:44.100
> 
> 标签：php, .htaccess, codeigniter

我决定尝试在本地工作并稍后在我的现场网站上安装新版本，而不是在我的网站上实时工作。

所以我正在使用 Codeigniter 并具有以下结构。

/htdocs/kow(网站)/kowmanager(cms)

当我加载 https:localhost/kow 时，它会加载正确的控制器，但是由于某种原因，它没有重新确认 kowmanager 是具有自己的应用程序文件夹的 kow 子目录，它应该加载在其路由文件中设置的默认控制器。当我加载[https://localhost.com/kow/kowmanager](https://localhost.com/kow/kowmanager)时，它会加载一个显示 /kow/kowmanager 索引的页面，然后是指向父目录的链接。这与 CI 无关。

在 kow 目录中，这是我的 .htaccess 文件。这是问题吗？

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?/$1 [L]

RewriteEngine On
RewriteBase /kowmanager
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?/$1 [L] 
```

我正在使用 xxamp。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:21:59.180

您是否使用 .htaccess 从网址中删除 index.php ？/htdocs/kow 是安装 CI 的项目的基本目录吗？

您需要将 kowmanagers 放在控制器目录中，并指定要调用的控制器，我不确定 CI 是否支持从目录调用默认控制器，除非您在 routes.php 配置文件中指定它。

无论如何，如果您想要一个准确的答案，请提供更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:23:16.357

[如手册](http://codeigniter.com/user_guide/general/managing_apps.html)所述，您需要为每个应用程序创建一个 index.php 页面。

所以我认为你应该将你的*index.php*复制到*indexManager.php*并在其中更改应用程序文件夹。

```
$application_folder = "kowmanager"; 
```

关于重写我不确定，但我认为它符合：

```
RewriteEngine On
RewriteBase /kowmanager
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ indexManager.php?/$1 [L]

RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?/$1 [L] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:38:21.593

kowmanager 中有什么，为什么要进行两次重写？如果您的目录结构是我假设的那样，您可能只需从 .htaccess 文件中删除第二个 kowmanager 指令即可。

codeigniter 在哪个文件夹？您要做的就是重写 url 以删除 index.php，但除非您将 url 映射到 codeigniter 的 index.php，否则它将永远无法加载控制器。

Apache 有[很多关于 url rewrite 的信息](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)。它的阅读量很大，而且行为总是很挑剔，但也许它会帮助你：

否则，更多信息将帮助我们帮助您。PS我也会用apache标记它，因为这就是问题所在，而且你更有可能让对apache有很多了解的人来查看你的问题。

# sql-server-2008 - APPFabric 缓存或 SQL 服务器 - 特定场景

> ID：10366512
> 
> 赞同：2
> 
> 时间：2012-04-28T18:49:48.167
> 
> 标签：sql-server-2008, caching, appfabric, distributed-caching

我很难确定是否应该在我们需要的上下文中使用 APPFabric 缓存或 SQL Server（考虑到我们目前在大多数情况下都使用 SQL Server）。

我们只需要（目前）缓存小块数据（~16KB），每个数据块对应于与从应用服务器之一发送的特定请求（传出请求）相关联的信息。

任何应用程序服务器都可以接收与初始传出请求相关联的传入请求，并且为了我们的需要，我们需要找到与该传出请求相关联的原始信息......这就是为什么我们不能在每个内存中保留本地缓存的原因应用服务器，因为我们不能确定传入请求是否会到达发出传出请求的应用服务器。

但是，我们基本上只需要将大约 16kb 的信息只保留一次（非常罕见的更新可能性），并且能够从任何应用服务器访问它，但在绝大多数情况下只访问一次。所以基本上大部分时间它将是来自应用服务器的一次写入（缓存），然后是从相同或另一个应用服务器读取的。

在这种特定情况下，通过 AppFabric 缓存集群而不是直接进入数据库是否会有任何好处（考虑到这将是一个简单的插入/选择语句）？

牢记可扩展性，这意味着我们目前没有高吞吐量的 put_data / get_data 操作（~160ops/sec），但我们可能会达到 1K/s .. 10k/s 甚至在不久的将来可能会更高。

提前感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T16:49:03.867

[AppFabric Cache](http://msdn.microsoft.com/en-us/library/ee790849.aspx)与 SQL DB 相比的优势在于访问时间。AppFabric 将有更快的访问时间，因为它将所有内容存储在内存 (RAM) 中，而 SQL 需要从磁盘查询其数据。

AppFabric 缓存的缺点是您可能会丢失数据，除非您已在集群中实施 HA（高可用性）以避免系统发生故障时丢失数据。SQL DB 在这里获胜，因为如果数据库系统出现故障，它支持数据可恢复性（*通过备份日志 - LDF ）。*

如果您需要有保证的消息传递，您可能不应该使用 AppFabric Cache 集群，而是使用 SQL DB 来实现临时持久性，因为它具有强大的数据恢复支持。

# c# - 用于从 xml 访问数据的 Linq 查询

> ID：10366517
> 
> 赞同：0
> 
> 时间：2012-04-28T18:50:22.323
> 
> 标签：c#, linq, linq-to-xml

我有一个包含一些元素的 XML 文件，例如

```
 <root>
    <gp>
      <i>1</i>
      <i>3</i>
      <i>5</i>
    </gp>
    <gp>
      <i>5</i>
      <i>6</i>
    </gp>
     . 
     . 
 </root> 
```

现在我想编写一个查询，通过它我将获取`gp`包含`<i>` 值为 5 的元素的所有元素？`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:58:27.630

```
var results = from gp in doc.Descendants("gp")
              where gp.Elements("i").Any(i => (int)i == 5)
              select gp 
```

在基于方法的语法中：

```
var results = doc.Descendants("gp").Where(gp => gp.Elements("i").Any(i => (int)i == 5)); 
```

# javascript - 在 Javascript 中使用函数

> ID：10366518
> 
> 赞同：0
> 
> 时间：2012-04-28T18:50:27.310
> 
> 标签：javascript

在下面的 javascript 代码中，我看到使用了 command 函数，但它没有指定函数的名称。这是怎么回事？

```
var getReview = function(movie) {
    switch (movie) {

    case "Matrix":
        return "good trip out";
        break;
    case "Princess Bride":
        return "awesome date night movie";
        break;
    case "Welcome to America":
        return "Amjad's favorite";
        break;
    case "Remember the Titans":
        return "love the sports";
        break;
    case "Why do I look like I'm 12?":
        return "The Ryan and Zach story";
        break;
    case "Fighting Kangaroos in the wild":
        return "Token Australian movie for Leng";
        break;
    default:
        return "I don't know!";
    }
};​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:54:11.090

这是一个函数字面量。它完全是¹，就像一个函数，但没有名称；它只是一个对象，就像 JavaScript 中的所有其他东西一样，特殊之处在于您可以调用它。在这里，它立即分配给`getReview`，因此您可以调用`getReview()`来调用该函数。

[¹实际上，它的定义不会被提升，但你不必担心。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:51:54.040

这是一个[匿名函数](http://helephant.com/2008/08/23/javascript-anonymous-functions/)。

引用上面的链接：

> 匿名函数使用函数运算符声明。您可以使用函数运算符在任何可以放置表达式的地方创建新函数。例如，您可以将新函数声明为函数调用的参数或分配另一个对象的属性。

这是一个使用函数语句以常规方式声明函数的示例：

```
function eatCake() {
    alert("So delicious and moist");
}
eatCake(); 
```

这是一个使用函数运算符动态声明相同函数的示例：

```
var eatCakeAnon = function() {
    alert("So delicious and moist");
};
eatCakeAnon(); 
```

# java - 通过文件更新 JTable

> ID：10366520
> 
> 赞同：0
> 
> 时间：2012-04-28T18:50:37.303
> 
> 标签：java, swing, file-io, jtable, updating

好的，所以我正在从文本文件中读取一些分数，当用户玩完游戏时，它会询问您是否要保存分数，我只有一个问题。它可以从文本文件中很好地读取和写入，只是每当添加新分数时 JTable 都不会更新。Object[][] 正在从文本文件中读取，我只是想知道是否有像“table.setData(Object[][] o);”这样的方法 有点事情，任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:48:28.177

只是为了让您可以接受答案并保持您的声誉：

听起来你需要设置一个`DefaultTableModel`.

然后你可以使用`((DefaultTableModel) table.getModel()).setDataVector(yourData, columnHeaders);`. 'yourData' 是`Object[][]`, 和 'columnHeaders'`Object[]`

那应该完全符合您的需要。

# php - php 创建目录

> ID：10366522
> 
> 赞同：2
> 
> 时间：2012-04-28T18:50:48.483
> 
> 标签：php

我正在创建一个目录，但我收到了错误

警告：chmod() [function.chmod]：第 104 行的 /home/www/public_html/console/pubs-add.php 中没有这样的文件或目录

运行代码的 php 文件位于 www/console 中，而我尝试创建的目录位于 www/images/gallery 中。

我尝试了许多设置路径的变体，例如 ../images/gallery 或 home/www 但似乎没有任何效果

```
define("PATH", "/www/images/gallery");

$dir = 'a1234';

$targetfilename = PATH . '/' . $dir;

if (!is_file($dir) && !is_dir($dir)) {
    mkdir($dir); //create the directory
    chmod($targetfilename, 0777); //make it writable
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:58:38.453

您的`mkdir`命令只是使用`$dir`，它只是 'a1234' （在当前工作目录中）。这将失败（也会失败`chmod`）。

解决方案：您可能想在 $dir 前面加上 PATH ...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:59:51.073

它`$dir`在您当前的工作目录中，但是，这并不意味着这等于您的`$targetfilename`. 我会说你必须做`mkdir($targetfilename)`而不是`mkdir($dir)`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T19:02:18.933

亲爱的 chmod() 会造成一些时间问题。所以我会建议你使用这个 mkdir("/path/to/my/dir", 0700); 如果你希望创建的目录应该准备好并且可写，那么使用这个 mkdir("/path/to/my/dir", 0777);

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-28T19:04:06.107

问题是您无法对尚未创建的文件进行 chmod。出于这个原因，我改变了这条线

```
$task = chmod($targetfilename, 0777); //make it writable 
```

到

```
$task = chmod($dir, 0755); //make folder writable 
```

提示：如果您希望文件夹可写，请将其更改为 755 而不是 777。777 用于文件。

# algorithm - 理想的跳过列表？O(n) 运行时间？

> ID：10366525
> 
> 赞同：1
> 
> 时间：2012-04-28T18:51:10.693
> 
> 标签：algorithm, linked-list, skip-lists

我正在尝试找到最佳算法

```
converting an "ordinary" linked list 
into an `ideal skip list` 
```

.

an 的定义`ideal skip list`是在第一级我们将拥有所有元素，在一半以上的级别，在四分之一之后的那个......等等。

我正在考虑`O(n)`运行时，其中涉及为原始链接列表中的每个节点投掷硬币，无论是否针对特定节点，我是否应该上去，并为楼上的当前节点创建另一个重复节点.. . 最终这个算法会产生 O(n) ，有没有更好的算法？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T20:33:31.527

我假设链接列表已排序 - 否则无法在基于比较的算法中完成，因为您需要对其进行排序`Omega(nlogn)`

*   迭代列表的“最高级别”，每隔一个节点添加一个“链接节点”。
*   重复直到最高层只有一个节点。

这个想法是生成一个新列表，大小是原始列表的一半，在每个第二个链接中链接到原始列表，然后在较小的列表上递归调用，直到达到大小为 1 的列表。
你最终会得到大小为 1,2,4,...,n/2 的列表相互链接。

**伪代码：**

```
makeSkipList(list):
  if (list == null || list.next == null): //stop clause - a list of size 1
      return
//root is the next level list, which will have n/2 elements.
  root <- new link node
  root.linkedNode <- list //linked node is linking "down" in the skip list.
  root.next <- null //next is linking "right" in the skip list.
  lastLinkNode <- root
  i <- 1
//we create a link every second element
  for each node in list, exlude the first element:
     if (i++ %2 == 0): //for every 2nd element, create a link node.
         lastLinkNode.next <- new link node 
         lastLinkNode <- lastLinkNode.next //setting the "down" field to the element in the list
         lastLinkNode.linkedNode <- node 
         lastLinkNode.next <- null
   makeSkipList(root) //recursively invoke on the new list, which is of size n/2. 
```

复杂度是 O(n)，因为算法复杂度可以描述为`T(n) = n + T(n/2)`，因此你得到`T(n) = n + n/2 + n/4 + ... -> 2n`

很容易看出它不能做得更好`O(n)`，因为至少你必须在原始列表的后半部分添加至少一个节点，并且到达那里本身`O(n)`

# java - 整数的组合

> ID：10366526
> 
> 赞同：-2
> 
> 时间：2012-04-28T18:51:13.553
> 
> 标签：java, combinations

对于以下问题，我将不胜感激。我有从 0 到 n-1 的 n 个整数，我正在尝试生成长度为 k 的所有可能组合的列表（即 k 个连接整数），这样每对连续整数都不相等。因此，例如，(1)(2)(3)(2) 在 k = 4 时有效，但 (1)(2)(3)(3) 无效。关于如何最有效地解决这个问题的任何想法？（我不太关心代码的长度/复杂程度，只关心效率）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:17:35.497

这是代码：

```
 void Generate(int[] source, List<int[]> result, int[] build, int k, int num) {
      if (num == k) {
        int[] a = (int[])build.clone();
        result.add(a);
        return;
      }

      for (int i = 0; i < source.length; i++)
        if (num == 0 || source[i] != build[num - 1])
        {
          build[num] = source[i];
          Generate(source, result, build, k, num + 1);
        }
    } 
```

如何调用：

```
 int k = 2;
    List<int[]> a = new ArrayList<int[]>();
    Generate(new int[]{1,2,3}, a, new int[k], k, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:22:04.160

```
public static void recursiveOutput(Integer n, int k, int limit, String prints){
    k++;
    if(k>limit)
        return;
    String statePrints = prints;
            //cycle through all available numbers
    for(Integer i = 1; i<=n; i++)
    {
        statePrints = prints;
                    //First cycle
        if(k==1){
            statePrints+= "(" + i.toString() + ")";
            recursiveOutput(n, k, limit, statePrints);
        }
                    //check if predecessor is not the same
        if(i != Integer.parseInt(statePrints.substring(statePrints.length()-2,statePrints.length()-1))){
            statePrints += "(" + i.toString() + ")";
            recursiveOutput(n, k, limit, statePrints);
        }
    }
            //Check if the length matches the combination length
    if(statePrints.length() == 3 * limit)
    System.out.println(statePrints);
} 
```

称呼 ：`recursiveOutput(3,0,4,"");`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:28:36.957

```
public class Generator {
    final int k = 2;
    final char[] n = new char[]{'0','1','2','3','4','5','6','7','8','9'};
    final char[] text = new char[k];

    public void gen(int i, int not_n) {
        if(i == k) {
            System.out.println(text);
            return;
        }

        for(int j = 0; j < n.length; j++) {
            if(j == not_n) continue;
            text[i] = n[j];
            gen(i+1, j);
        }

    }
    public static void main(String[] args) {
        new Generator().gen(0, -1);
    } 
```

}

# ruby-on-rails - 控制器视图通信，Ruby on Rails

> ID：10366529
> 
> 赞同：0
> 
> 时间：2012-04-28T18:51:50.887
> 
> 标签：ruby-on-rails, ruby

我试图在`params[:id]`选择输入按钮时增加存储的值，并在用户访问页面时存储原始值。我该如何实现这一目标？

我已经成功地增加了值，但我不确定如何完成存储原始值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:01:50.080

HTTP 协议是无状态的，因此您要使用的任何变量都必须来自数据库或用户。也许您应该将 start_id 包含在链接中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T15:03:39.997

有几种方法可以让您在请求之间保持“开始”的值。正如 Matzi 建议的那样，您可以将 url 中的值作为请求之间查询字符串的一部分保留。

```
link_to "next", your_path(start: params[:start], count: (params[:count].to_i + 1)) 
```

您还可以将值粘贴到控制器的用户会话中：

```
session[:start] = params[:start] 
```

然后用`session[:start]`.

你也可以从控制器把它塞进你自己的特殊 cookie 中：

```
cookies[:start] = params[:start]
# or
cookies.permanent[:start] = params[:start] 
```

或者，`params[:start]`如果保留该位数据确实很重要，则可以将其保存到数据库中。

希望这有助于为您指明正确的方向。

# css - 底部 div 如何处理其余部分

> ID：10366532
> 
> 赞同：0
> 
> 时间：2012-04-28T18:52:00.033
> 
> 标签：css, layout

有没有办法在不使用 javascript 的情况下进行以下布局？

```
div parent
   div A
   div B
   div C 
```

*   **父**级使用固定高度（比如 500 像素）
*   **A**和**B**的高度取决于其内容
*   **C**取剩余高度

*   **C将获得仅应在****C**内滚动的大内容

 **C 将包含一个内容很大的 D。D 应在 C 内滚动

```
 div C
       div D
         large content 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:04:23.910

我会这样设置：

```
<div class="parent">

    <div class="C">

        <div class="A">
         A's content
        </div>

        <div class="B">
         B's content
        </div> 

      C's content

    </div>/*C end*/

</div>/*parent end*/ 
```**

# actionscript-3 - AS3 - 击球 Y 坐标

> ID：10366535
> 
> 赞同：0
> 
> 时间：2012-04-28T18:52:21.277
> 
> 标签：actionscript-3, flash

我正在为学校制作一个小应用程序，您可以在其中使用 Acceleropmeter（用于智能手机）控制球，我想要这样，如果球达到某个 Y 坐标，您会输掉并转到另一帧（它说您有输掉比赛）。'已经完成了球，到目前为止的代码是这样的：

```
var fl_Accelerometer:Accelerometer = new Accelerometer();
fl_Accelerometer.addEventListener(AccelerometerEvent.UPDATE, fl_AccelerometerUpdateHandler);

function fl_AccelerometerUpdateHandler(event:AccelerometerEvent):void
{
cBall.x -=  event.accelerationX * 40;
cBall.y +=  event.accelerationY * 40;
}

cBall.addEventListener(Event.ENTER_FRAME, moveBall);
function moveBall(evt:Event){

// this is to stop the ball when it tries to exit the sreen 

if(cBall.x > (480-cBall.width/2)){
    cBall.x = 480-cBall.width/2;
}
    // except for this, that stops the ball not if it touches the end of the screen, but if it reaches a certain Y coordinate
if(cBall.y > (780-cBall.width/2)){
   gotoAndStop(3);
}
if(cBall.x < (0+cBall.width/2)){
    cBall.x = 0+cBall.width/2;
}
if(cBall.y < (0+cBall.width/2)){
    cBall.y = 0+cBall.width/2;
}
} 
```

每当我尝试该应用程序时，它都会显示第 32 行有错误（TypeError: Error #1009: Cannot access a property or method of a null object reference. at ballApp_Scene1_fla::MainTimeline/moveBall()[ballApp_Scene1_fla.MainTimeline::帧 1:32) 为什么？我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T21:53:22.657

由于 cball 是 moveBall 函数中使用的唯一对象，因此空指针异常意味着 cBall 尚未初始化。由于未显示这部分，因此没有太大的帮助..

但也许看看碰撞检测和

*   `BitmapData Class`及其方法 hittest ： [http ://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#hitTest%28%29](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#hitTest%28%29)

*   或`DisplayObject Class`提供 hitTestPoint 和 hitTestObject [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#hitTestObject%28%29](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#hitTestObject%28%29) 如果您可以使用图像数据和对象制作不同的地图和对象透明度比硬编码每个 x 和 y 坐标来处理更容易处理。

另一个试图做类似事情的人： [BitmapData Collision](https://stackoverflow.com/questions/10310005/bitmapdata-collision/10311688#10311688)

# ms-access - 访问：将 CSV 数据附加到表时出现截断错误？

> ID：10366539
> 
> 赞同：2
> 
> 时间：2012-04-28T18:53:04.473
> 
> 标签：ms-access, csv

我目前在尝试将数据附加到现有表时遇到困难。

我有大约 100 个 CSV 文件，我想从中创建一个表；所有表都有不同的列结构，但这并不是真正的问题，因为关联的字段名称位于每个文件的第一行。

首先，我从一个文件中创建一个新表，表明我的字段名称在第一行。我将超过 256 个字符的特定字段更改为备注字段并导入数据。

然后，我将缺少的字段添加到表中。

现在，当我尝试追加更多数据时，我再次选择我的字段名称位于第一行，但现在我收到一个针对备忘录字段的数据的截断错误。

为什么会出现这个错误？有解决方法吗？

***编辑***

以下是关于我试图解决问题的更新：

1.  除非它们具有完全相同的结构，否则导入和附加表将不起作用。此外，您不能创建一个包含所有字段和属性集的主表，然后将所有表附加到主表。您仍然会收到截断错误。

2.  我接受了 CodeSlave 的建议并尝试上传表格，将我需要的字段设置为备注字段，然后附加表格。这行得通，但同样，备忘录字段在每个数据文件中的顺序不一定相同，我有 1200 个数据文件要导入到 24 个表中。逐个表导入数据表不是这么多表的选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T14:10:09.903

我希望您遇到的是源文件 (CSV) 和目标表 (MS Access) 之间的不匹配。

当您进行导入时，MS Access 会猜测 CSV 文件中的字段类型。然而，它并不完美。也许它将字符串视为备忘录或将浮动视为真实。不看数据我是不可能知道的。

我通常会做的是：

1.  将第二个 CSV 导入它自己的（临时）表
2.  清理第二张桌子
3.  然后使用 SQL 查询将这些记录从第二个表附加到第一个表。
4.  删除第二个表

（对您正在加载的每个 CSV 文件重复此操作）。

如果我提前知道每个 CSV 文件在结构上已经相同，我会倾向于将它们全部连接成一个，并且只需要进行一次导入/清理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-01T20:04:15.360

有一个非常相似的问题 - 尝试将具有大文本字段（> 255 个字符）的 CSV 文件导入现有表。将字段声明为备忘录，但仍被截断。

解决方案：开始导入以链接表，然后单击“高级”按钮。创建将相关字段定义为备注字段的链接规范，然后保存链接规范。然后取消导入。这次再次导入您想要的附加到现有表的导入。再次单击高级按钮并选择您刚刚创建的链接规范。单击完成，应正确导入数据而不会截断。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-14T22:56:36.290

我遇到了这个问题，但注意到它总是只发生在第一行。因此，通过在 csv 中插入一个空白行，它将完美导入，然后您需要删除 Access 表中的空白行。

干杯，格雷·亨特

**注意：**我使用的是 Office 2010

# javascript - 避免在换行后创建 textNode？

> ID：10366540
> 
> 赞同：4
> 
> 时间：2012-04-28T18:53:31.420
> 
> 标签：javascript, html, dom, textnode

如果我在 HTML 文件中手动编写以下几行：

```
<div>
<input type="button" value="Button 1">
<input type="button" value="Button 2">
</div> 
```

将为每个新行创建一个文本节点。

我想了解 addEventListener 方法的 useCapture 参数。我选择使用 div 元素的 childNodes 属性访问 DOM 元素，但我将不得不忽略元素之间的 textNodes。这不是很实用：

```
document.getElementsByTagName("div")[0].addEventListener("click", function(){alert(1);}, true);

document.getElementsByTagName("div")[0].childNodes[1].addEventListener("click", function(){alert(2);}, false);

document.getElementsByTagName("div")[0].childNodes[3].addEventListener("click", function(){alert(3);}, false); 
```

在这里，您看到我必须忽略`childNodes[0]`并`childNodes[2]`选择我的 2 个输入标签。

有没有一种方法可以绕过 textNodes 创建，而无需在一行上编写所有 HTML 代码并且不使用 Javascript `createElement`？

换行时是否可以在不创建 textNodes 的情况下编写 HTML 代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:57:25.147

> 换行时是否可以在不创建 textNodes 的情况下编写 HTML 代码？

**没有。**

除非您在将 HTML 文件发送到客户端之前对其进行解析，否则我猜该解决方案不是您想要的...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:07:52.800

对不起。唯一的可能是使用 PHP、RUBY 等编程语言生成 HTML 代码并添加类似的内容。

```
<input type="button" value="Button 1"><%-
%><input type="button" value="Button 2"> 
```

但我想这不是你想听到的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:16:31.780

首先，*不要重复自己*！您一遍又一遍地重复相同的 DOM 查询。

试试这个：

```
var div = document.getElementsByTagName("div")[0];
div.addEventListener("click", function(){alert(1);}, true);

var buttons = div.getElementsByTagName("button");  
buttons[0].addEventListener("click", function(){alert(2);}, false);
buttons[1].addEventListener("click", function(){alert(2);}, false); 
```

调用`getElementsByTagName`来获取按钮会简单地跳过文本节点 - 问题解决了！

# c++ - 进入 main() 前的堆栈溢出异常

> ID：10366546
> 
> 赞同：5
> 
> 时间：2012-04-28T18:53:58.843
> 
> 标签：c++, exception, stack-overflow

当使用 vs2010 编译（和执行）这个 c++ 代码时，我得到一个堆栈溢出异常，就在它甚至可以向控制台写入“开始”的一瞥之前。

我使用的所有头文件都包含在 stdafx.h 中，但这显然不是这里的问题（直接包含头文件时同样的问题）。

堆栈跟踪如下：

```
>   msvcr100d.dll!__set_flsgetvalue()  Zeile 145 + 0xc Bytes    C
    msvcr100d.dll!_getptd_noexit()  Zeile 500   C
    msvcr100d.dll!_getptd()  Zeile 523 + 0x5 Bytes  C
    msvcr100d.dll!_LocaleUpdate::_LocaleUpdate(localeinfo_struct * plocinfo)  Zeile 243 + 0x5 Bytes C++
    003efe3c()  
    TerrainGenerator.exe!pre_cpp_init()  Zeile 298 + 0x21 Bytes C 
```

任何帮助将不胜感激，我是 C++ 的绝对初学者，正如您在代码样式中看到的那样，我尽一切努力摆脱这个烦人的问题，例如甚至没有声明一个附加函数等等。 ..请帮助我，不要犹豫，询问您是否需要更多信息。提前致谢。

```
#include "stdafx.h"

int main(int argc, char* argv[])
{
    puts("Start");

    const int res = 4096;
    srand(time(NULL));

    uint16_t data[(res+1)*(res+1)];

    uint16_t variance = 2000;
    int seed = 1337;

    data[0] = ((seed>>1)+(int)(rand()/(RAND_MAX*(seed+(seed>>1)))));
    data[res] = ((seed>>1)+(int)(rand()/(RAND_MAX*(seed+(seed>>1)))));
    data[res*res] = ((seed>>1)+(int)(rand()/(RAND_MAX*(seed+(seed>>1)))));
    data[res*(res+1)] = ((seed>>1)+(int)(rand()/(RAND_MAX*(seed+(seed>>1)))));

    int count = 0;
    for(int size=res;size>=1;size=size>>1,variance=variance>>1)
    {
        count++;
        for(int x=size;x<res;x+=size<<1) 
        {
            for(int y=size;y<res;y+=size<<1) 
            {
                data[x*res+y] = data[(x-size)*res+(y-size)] + data[(x-size)*res+(y+size)] + data[(x+size)*res+(y-size)] + data[(x+size)*res+(y+size)];
                data[x*res+y] /= 4;
                data[x*res+y] += (variance>data[x*res+y])?(-(data[x*res+y]^2/variance)+(int)(rand()/(RAND_MAX*(data[x*res+y]^2/variance)))):(-variance+(int)(rand()/(RAND_MAX*variance*2)));
            }
        }

        for(int x=0;x<res;x+=size)
        {
            for(int y=0;y<res;y+=size)
            {
                if(x!=res-1)
                {
                    data[(x+(size>>1))*res+y] = data[x*res+y] + data[(x+size)*res+y] + ((y!=res-1)?data[(x+(size>>1))*res+(y+(size>>1))]:0) + ((y!=0)?data[(x+(size>>1))*res+(y-(size>>1))]:0);
                    data[(x+(size>>1))*res+y] /= (y!=res-1&&y!=0)?4:3;
                    data[(x+(size>>1))*res+y] += (variance>data[(x+(size>>1))*res+y])?((-(data[(x+(size>>1))*res+y]^2/variance)+(int)(rand()/(RAND_MAX*(data[(x+(size>>1))*res+y]^2/variance))))):(-variance+(int)(rand()/(RAND_MAX*variance*2)));
                }
                if(y!=res-1)
                {
                    data[x*res+(y+(size>>1))] = data[x*res+y] + data[x*res+(y+size)] + ((x!=res-1)?data[(x+(size>>1))*res+(y+(size>>1))]:0) + ((x!=0)?data[(x-(size>>1))*res+(y+(size>>1))]:0);
                    data[x*res+(y+(size>>1))] /= (x!=res-1&&x!=0)?4:3;
                    data[x*res+(y+(size>>1))] += (variance>data[x*res+(y+(size>>1))])?((-(data[x*res+(y+(size>>1))]^2/variance)+(int)(rand()/(RAND_MAX*(data[x*res+(y+(size>>1))]^2/variance))))):(-variance+(int)(rand()/(RAND_MAX*variance*2)));
                }
            }
        }
    }

    size_t Count = res*res;
    uint16_t* Block = data;
    char* Path = "export.raw";

    if(!Block) return false;
    FILE * filePointer = NULL;
    errno_t error = fopen_s(&filePointer, Path, "wb");
    if(error) return false;
    fwrite(Block, sizeof(uint16_t), Count, filePointer);
    fclose(filePointer);
    return true;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-28T18:59:39.653

问题是

```
uint16_t data[(res+1)*(res+1)]; 
```

它是一个 16 MB+ 的本地数组，太大而无法放入堆栈（通常为 1 MB） - 您必须使用以下`new`语句在堆中创建它：

```
uint16_t* data = new uint16_t[(res+1)*(res+1)]; 
```

然后记住在`delete`不再需要它时使用语句取消分配它：

```
delete[] data; 
```

# ruby-on-rails - Rails has_many 关系很奇怪

> ID：10366551
> 
> 赞同：3
> 
> 时间：2012-04-28T18:54:16.443
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我不确定以前是否有人注意到这一点，因为我找不到有关此问题的任何主题。但是假设你有一个 Product 模型和一个 Cart 模型，它设置了`has_many :products`. 和 Product 模型集，当您将产品实例（这是指关联购物车的 id 的外键）`belongs_to :cart`设置为 时，会发生奇怪的事情。可能会发生三件事：`cart_id``nil`

1.  `cart_id`如果您在将关联产品设置为之前已经检索了关联的购物车`nil`，那么当您使用其实例方法销毁该购物车实例时`destroy()`，关联的产品**也会被销毁**。

2.  如果在将关联产品设置为 之后检索关联的购物车`cart_id`，`nil`当您使用其实例方法销毁它时`destroy`，关联的产品**不会被销毁**。

3.  如果您取消关联产品的 并在购物车 ( ) 上`cart_id`调用 CLASS METHOD ，则关联产品**不会被销毁**`destroy``Cart.destroy(cart_id)`

 **我很确定这与`has_many`. 当您检索它时，关系的状态可能会硬连线到模型实例。**请看下面的代码：**

这是我用来测试上述内容的示例代码（假设您已经拥有上述 2 个模型表）

```
Cart.create   # Assume this one has an id of 1
Product.create(cart_id: 1)
cart=Cart.find(1) # Retrieve the cart before
Product.find(1).update_attribute!(cart_id: nil)
cart.destroy
Product.find_by_id(1)   # nil; the associated product was destroyed 
```

* * *

```
Cart.create # Assume this one has an id of 1
Product.create(cart_id: 1)
Product.find(1).update_attribute!(cart_id: nil)
cart=Cart.find(1) # Retrieve the cart AFTER
cart.destroy
Product.find_by_id(1) # [<Product id:1 cart_id:1 ....>], the assoc product WAS NOT destroyed 
```

* * *

```
Cart.create # Assume this one has an id of 1
Product.create(cart_id: 1)
Product.find(1).update_attribute!(cart_id: nil)
Cart.destroy(1)
Product.find_by_id(1) # [<Product id:1 cart_id:1 ....>], the assoc product WAS NOT destroyed 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:16:28.303

我怀疑“奇怪行为”的原因是，通过下载数据库对象也获得了它的依赖关系。显然，即使数据库依赖关系不存在，删除所有者的交易也会删除从属元素（以及那些已经不存在的元素）。

因此，重新下载条目不会破坏关联。

啤酒问题，który pokazałeś jest warty odnotowania i sam pewnie bym wpadł w jego pułapkę。**

# ruby-on-rails - 无法识别 Rails 中 S3.yml 中的 ENV 变量

> ID：10366552
> 
> 赞同：5
> 
> 时间：2012-04-28T18:54:18.720
> 
> 标签：ruby-on-rails, ruby-on-rails-3, yaml

我目前正在尝试使用最新`aws-sdk`建议的 gem 配置 Paperclip。

在我的 S3.yml 文件中，我有这样的东西

```
development:
  bucket: newmeeter-dev
  access_key_id: ENV['S3_KEY']
  secret_access_key: ENV['S3_SECRET'] 
```

但它没有识别 ENV 变量。我收到以下错误

```
AWS::S3::Errors::InvalidAccessKeyId in PhotosController#create

The AWS Access Key Id you provided does not exist in our records. 
```

如果我尝试将访问权限和秘密都直接放入文件中，它会完美运行。同时，我尝试将两个 ENV 变量打印到视图或控制台中，我可以看到它们的值没问题。

我不明白为什么它不承认它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-28T19:03:20.307

解决了！

我在这里找到了对这个问题的答复 [Ruby on Rails：你能把 Ruby 代码放在 YAML 配置文件中吗？](https://stackoverflow.com/questions/3277428/ruby-on-rails-can-you-put-ruby-code-in-a-yaml-config-file)

解决方案：YAML 文件理解 ERB 格式的代码。

在内部打印 ENV 变量`<%=`并`%>`有效。

```
access_key_id: <%= ENV['S3_KEY'] %>
secret_access_key: <%= ENV['S3_SECRET'] %> 
```

# javascript - 在 JavaScript 中引用复杂变量

> ID：10366553
> 
> 赞同：0
> 
> 时间：2012-04-28T18:54:33.693
> 
> 标签：javascript, variables

如何进行以下 JS 变量引用：

1.  当您有一个数组 ( `x[0], x[1], ...`) 并且您有一个像这样的按钮时：

    ```
    <button onclick="say(0)"></button> 
    ```

    该函数如下所示：

    ```
    function say(src){
      // Define the box (some random div element will do)
      var box = document.querySelector('#box');

      // This is wrong, I know... I need to refer to the variable 'response[0]' in this case...
      box.innerHTML = response[src];
    } 
    ```

2.  当您有以下变量列表时：

    ```
    var book = "Some Book";
    var shelf = "Some Shelf"
    var bookshelf = "The cake!" 
    ```

在这种情况下，如果我想（无论出于何种原因）引用变量`bookshelf`，我该如何通过组合其他两个变量的变量名来做到这一点？

我的意思是，我不能这样做，`var x = book + shelf;`因为那会给我`result = "Some BookSome Shelf"`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:56:15.910

不要使它们成为变量，使它们成为对象的属性：

```
var tags = {
   book: 'Some book',
   shelf: 'Some shelf',
   bookshelf: 'The Cake!'
};

var which = 'bookshelf';
var x = tags[which]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T18:57:41.870

您可能希望使它们成为对象的属性（尽管它们可能已经是`window`对象的属性）：

```
var stuff = {
    book: "Some book!",
    shelf: "Some shelf",
    bookshelf: "The cake!"
};

function say(src) {
    // Define the box (some random div element will do)
    var box = document.querySelector('#box');

    box.innerHTML = stuff[response[src]];
} 
```

# core-data - 获取核心数据相关对象

> ID：10366555
> 
> 赞同：0
> 
> 时间：2012-04-28T18:55:01.113
> 
> 标签：core-data, entity-relationship, nsmanagedobject, nsmanagedobjectcontext

我有一个名为 day 的核心数据实体，它与另一个名为 spot 的名为 spotTable 的实体一对一的关系。

我获取了一天记录，我想访问与我的一天实例相关的现场对象，我像这样访问它：

```
self.spotTable = [self.day valueForKey:@"spotTable"]; 
```

但是当我将 spotTable 对象打印到控制台时，我发现数据有问题：

```
2012-04-28 13:33:35.161 The Parking Lot[18800:fb03] SpotTable: <NSManagedObject: 0x6b2b820> (entity: Spot; id: 0x6b2b200 <x-coredata://B1F7E573-BCD7-486D-8471-C3D80B891A3B/Spot/p1> ; data: <fault>) 
```

有没有办法从 spotTable 对象中获取数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T20:10:44.797

A relationship will not be auto-fetched, because you may not need its attributes. You can manually fault it, or you can use -setRelationshipKeyPathsForPrefetching. See the documentation for NSFetchRequest:

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSFetchRequest_Class/NSFetchRequest.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSFetchRequest_Class/NSFetchRequest.html)

# php - spl_autoload_register vs __autoload

> ID：10366560
> 
> 赞同：1
> 
> 时间：2012-04-28T18:55:57.910
> 
> 标签：php

我试试

```
function some_class($class) {
        require PATH.'test'.$class.'.php';
    }

function test_class($class) {
        require PATH.'some'.$class.'.php';
    }

    spl_autoload_register("test_class");
    spl_autoload_register("some_class");

    $tst = new SomeClass(); 
```

SomeClass 类位于“PATH/some/SomeClass.php”中，但 spl_autoload_register 仅调用“test_class”函数而不调用“some_class”。但是如果我改变函数位置，那么它会找到新的 SomeClass。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T19:13:43.663

自动加载函数按顺序调用，首先调用第一个注册函数，之后调用第二个函数，依此类推，直到其中一个找到类（除非`$prepend`使用）。如果没有，则会触发致命错误。

但是，在您的示例中，您使用的是`require`代替`include`，因此如果文件不存在，第一个函数将始终失败并出现致命错误，因此永远不会调用第二个函数。即使您将其替换为`include`，如果两个文件都存在，则只会调用第一个注册的函数。

`file_exists`使用多个自动加载功能或`include`在使用多个自动加载功能时是个好主意。

您还可以在自动加载函数中抛出异常，以便您可以优雅地处理未定义的类，而不是在找不到类时终止脚本。每个例子：

```
function my_autoload($class) {
     $filename = "class.{$class}.php";

     if (!file_exists($filename))
         throw new Exception("$class not found");

     include_once $filename;
}

spl_autoload_register('my_autoload');

try {
    $a = new Foo;
} catch (Exception $e) {
    // Foo wasn't found
}

// continuing the script... 
```

显然，这取决于您的需求，因为抛出异常将停止后续自动加载功能的执行。

最后，它完全不鼓励使用`__autoload`，`spl_autoload_register`提供了比前者更多的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:15:14.980

你最好只使用一个自动加载功能。像这样的东西：

```
function some_class($class) {
   if (file_exists(PATH.'test'.$class.'.php')) {
        include PATH.'test'.$class.'.php';
   } elseif (file_exists(PATH.'some'.$class.'.php')) {
        include PATH.'some'.$class.'.php';
   } else {
        die('class '.$class.' not found');
   }
}
spl_autoload_register("some_class"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-18T07:20:56.110

spl_autoload_register- 到底是什么意思？让我们试着通过一个例子来理解它：

```
function Autoloader($className)
    {
        require_once $path.$className.'.php';
    }

    spl_autoload_register('Autoloader');

    $myObj = new MyClass(); 
```

在这里，我们刚刚实例化了一个名为“MyClass”的类，没有指定 include 或 require 语句。

是不是很酷？那么我们是怎么做到的呢？让我们深入挖掘。

在这里，我们使用 spl_autoload_register() 函数注册了一个名为“Autoloader”的函数。当我们实例化“MyClass”时，类名（MyClass）由 PHP 传递给“spl_autoload_register()”，注册函数将其作为参数获取。在 Autoloader 函数的定义中，我们已经包含了该类文件的路径。

这简直太棒了！！试想一种情况，您有几个类，并且所有这些类都不会在每种情况下或在每个页面上使用。在这种情况下， spl_autoload_register() 可以成为您的真正救星。

您只需要实例化并且 spl_autoload_register() 将负责休息。

除了注册函数，您还可以按如下方式进行：

```
spl_autoload_register(function ($class) {
    include 'classes/' . $class . '.class.php';
}); 
```

但是这段代码只适用于 PHP >= 5.3.0

您可以将 spl_autoload_register() 视为 __autoload() 的替代，它可以定义为：

__autoload() — 尝试加载未定义的类

让我们试着通过一个例子来理解。

```
<?php
// we've writen this code where we need
function __autoload($classname) {
    $filename = "./". $classname .".php";
    include_once($filename);
}

// we've called a class ***
$obj = new myClass();
?> 
```

但它有一个缺点，您需要在每个类文件中编写此函数。

# c# - 反序列化为空但具有属性的 xml 元素

> ID：10366561
> 
> 赞同：1
> 
> 时间：2012-04-28T18:56:12.387
> 
> 标签：c#, xml-serialization

我有一些带有这样元素的 XML：

```
<hour base_forecast="12" datim="29/0" /> 
```

我收到错误：

```
Unexpected node type Element. ReadElementString method can only be 
called on elements with simple or empty content. 
```

我猜这是因为元素没有价值。我不控制这个 XML，所以我不能改变它。我将如何反序列化这个？

** 编辑 **

属性的值之一是 ">6" .... 这可能是罪魁祸首吗？如果是这样，我该如何处理？

** 更新 **

在属性值中发现了一些未返回 > 的数据。同样的错误正在发生。

** 编辑 #3 *** 为我收到的 XML 创建一个 XSD，然后使用 xsd 工具为它们生成类。添加到这篇文章的底部。

下面是反序列化代码：

```
 HttpWebRequest req = (HttpWebRequest)WebRequest.Create("xxx");
        HttpWebResponse resp = (HttpWebResponse)req.GetResponse();
        WeatherData Result = new WeatherData();

        using (Stream st = resp.GetResponseStream())
        {
            XmlRootAttribute xRoot = new XmlRootAttribute();
            xRoot.ElementName = "model_data";
            xRoot.IsNullable = true;

            Result = new XmlSerializer(typeof(WeatherData), xRoot).Deserialize(st) as WeatherData;  ** Error here 
```

返回的 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE observation SYSTEM "http://private.com/hithere.dtd">
<model_data>
     <site a="28/12" b="KXXX">
         <hour x="-9999" y="-9999" z="-9999"/>
     </site>
</model_data> 
```

数据对象

```
[Serializable, XmlRoot("model_data")]
public class WeatherData
{
    [XmlElement("site")]
    public string City { get; set; }

    [XmlAttribute]
    public string a { get; set; }

    [XmlAttribute]
    public string b { get; set; }

    [XmlElement(ElementName="hour", IsNullable=true)]
    public string Hour { get; set; }

    [XmlAttribute]
    public string x { get; set; }

    [XmlAttribute]
    public string y { get; set; }

    [XmlAttribute]
    public string z { get; set; }

} 
```

XSD 工具生成的类

```
**Removed generated classes, but they are similar to what Hugo posted ** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T23:07:14.847

当我使用 XSD 工具生成类时，我得到了同样的错误，但错误显示是从我注释掉的行中抛出的。

所以我退出了 VS，并运行了磁盘清理。再次运行我的代码。收到一条消息“出于安全原因，此 XML 文档中禁止使用 DTD。等等。” 所以，我允许将阅读器设置为 DtdProcessing.Parse，并再次运行代码。

它是成功的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T21:42:29.433

看这部分：

```
[XmlElement("site")]
public string City { get; set; } 
```

`<Site>`contains `<Hour>`，所以它不是*简单或空内容的元素*，我猜？

编辑：实际上整件事似乎很可疑。数据对象似乎忽略了 xml 中的所有层次结构信息。

这样的事情怎么样？

```
[Serializable, XmlRoot("model_data")]
public class WeatherData
{
    [XmlElement("site")]
    public City[] City { get; set; }
}

public class City
{
    [XmlAttribute]
    public string a { get; set; }

    [XmlAttribute]
    public string b { get; set; }

    [XmlElement(ElementName="hour", IsNullable=true)]
    public Hour Hour { get; set; }
}

public class Hour 
{    
    [XmlAttribute]
    public string x { get; set; }

    [XmlAttribute]
    public string y { get; set; }

    [XmlAttribute]
    public string z { get; set; }   
} 
```

# php - 一种同时编辑具有不同值的表的多行的方法

> ID：10366563
> 
> 赞同：0
> 
> 时间：2012-04-28T18:56:22.263
> 
> 标签：php, javascript, mysql, html, user-interface

所以问题是我想要一种通过提供 excel 表格的感觉来编辑表格的多行的方法。用户应该能够在表单中输入不同行的值，并且一旦单击保存/提交，必须更新表中的所有条目。

我在弄清楚如何在我的项目中实现这一点时遇到了问题。谁能告诉我如何在代码中使用这个接口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:02:17.403

有很多 JS 框架（dojo、extJS 等）可以提供帮助。至于我，我喜欢[DHTMLx](http://dhtmlx.com/)之一

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:09:17.303

这篇历史文章可以帮助您入门：

[http://www.atariarchives.org/deli/spreadsheet_program.php](http://www.atariarchives.org/deli/spreadsheet_program.php)

我没有看到的一件事是您必须注意循环引用，最简单的类型是 A1=A2 和 A2=A1。图论为您提供了管理这些错误的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:04:05.807

一种想法是将行数据结构（即每行的字段）映射到值对象。然后编辑的每一行都将保存到一个数组中。然后对于数组中的每个元素或对象，您将构建一个更新查询并执行它。

# php - 403 禁止错误显示而不是自定义的错误 404 页面

> ID：10366569
> 
> 赞同：0
> 
> 时间：2012-04-28T18:57:36.070
> 
> 标签：php, apache, http-status-code-404

我的服务器出现此问题，我正在尝试显示错误 404，但是当我转到无效 URL 时，我收到此消息。请问问题可能来自哪里？

```
 The requested URL /church/ffff.php     was not found on this server.

Additionallt, a 403 Forbidden error was        encountered while trying to use an           ErrorDocument to handle the request 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:00:36.737

你的 .htaccess 是什么样的？

您可以像这样添加自定义处理程序：

在.htaccess中（最好是最上面的）ErrorDocument 404 404.php

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:04:27.900

似乎服务器没有对 404 文件的访问权限，要解决此问题，您应该将文件放在与 htaccess 相同的文件夹中，而不是编写完整路径（/c:wamp/www/church/404.php）应该只写文件名 - 404.php

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:55:29.853

哦，这是因为 htaccess 没有在本地主机上自动启用，你需要这样做：

1.  点击 wamp 图标
2.  apache->apache modules-> 并启用 rewrite_module

# ruby - 类方法（红宝石）

> ID：10366572
> 
> 赞同：1
> 
> 时间：2012-04-28T18:57:45.687
> 
> 标签：ruby, instance-variables, class-method

新手在这里，很难理解类方法以及为什么我无法在实例中正确显示属性。

```
class Animal
  attr_accessor :noise, :color, :legs, :arms

  def self.create_with_attributes(noise, color)
    animal = self.new(noise)
    @noise = noise
    @color = color
    return animal
  end

  def initialize(noise, legs=4, arms=0)
    @noise = noise
    @legs = legs
    @arms = arms
    puts "----A new animal has been instantiated.----"
  end
end

animal1 = Animal.new("Moo!", 4, 0)
puts animal1.noise
animal1.color = "black"
puts animal1.color
puts animal1.legs
puts animal1.arms
puts

animal2 = Animal.create_with_attributes("Quack", "white")
puts animal2.noise
puts animal2.color 
```

当我使用类方法`create_with_attributes`（在animal.2上）时，我希望`"white"`在我出现时出现`puts animal2.color`。

好像我已经定义了它`attr_accessor`，就像我有“噪音”一样，但噪音正确出现，而颜色则不会。当我运行这个程序时，我没有收到错误，但是 .color 属性只是没有出现。我相信这是因为我在代码中以某种方式错误地标记了它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:02:40.113

`self.create_with_attributes`是一个类方法，因此在其中设置`@noise`和设置*不是*设置实例变量，而是设置所谓的[类实例变量](http://martinfowler.com/bliki/ClassInstanceVariable.html)。`@color`

 *你想要做的是在你刚刚创建的实例上设置变量，所以改为`self.create_with_attributes`看起来像：

```
 def self.create_with_attributes(noise, color)
     animal = self.new(noise)
     animal.noise = noise
     animal.color = color
     animal
 end 
```

这将在您的新实例上设置属性，而不是在类本身上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:02:47.583

当您在`create_with_attributes`方法中时，实例变量是在`Animal`类本身上设置的，而不是在`Animal`您刚刚创建的实例上。这是因为该方法在`Animal`类上（它是 的实例`Class`），因此它在该上下文中运行，而不是在任何实例的上下文中运行`Animal`。如果你这样做：

```
Animal.instance_variable_get(:@color) 
```

运行您描述的方法后，您应该`"white"`返回。

也就是说，您需要通过调用 setter 方法来设置刚刚创建的实例的属性，如下所示：

```
def self.create_with_attributes(noise, color)
  animal = self.new(noise)
  animal.color = color
  return animal
end 
```

我删除了 的设置，因为无论如何`noise`它已经完成了。`initialize`*

# c# - 使用 WebClient 调用 HTTPS URL 的异常

> ID：10366573
> 
> 赞同：1
> 
> 时间：2012-04-28T18:57:57.857
> 
> 标签：c#, .net, windows-phone-7, webclient

大约 3 个月以来，我有一个公共应用程序使用 WebClient 调用一些 HTTPS API。直到大约 3 周前一切正常，但突然应用程序停止工作，所有 WebClient 调用都抛出“远程服务器返回错误：NotFound”。例外。

我没有以任何方式更新我的应用程序，API 没有改变，我没有注意到 Windows Phone 的任何更新。我提到我的应用程序针对的是 Windows Phone OS 7.1，并且我还尝试使用 HttpWebRequest 类 - 结果是一样的。我的代码看起来像这样：

```
private void tile_Tap(object sender, System.Windows.Input.GestureEventArgs e) 
    { 
        WebClient wc = new WebClient(); 
        wc.OpenReadCompleted += new OpenReadCompletedEventHandler(wc_OpenReadCompleted);             

        wc.OpenReadAsync(new Uri("https://www.google.com"));  
    } 

    void wc_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e) 
    { 
        try { 
            StreamReader s = new StreamReader(e.Result); 
            string r = s.ReadToEnd(); 
            MessageBox.Show(r); 
        } 
        catch (Exception ex) 
        { 
            MessageBox.Show(ex.Message); 
        } 
    } 
```

每次使用上述异常调用此代码时都会失败。如果我尝试获取“http://www.google.com”或任何其他 HTTP URL，代码将正常工作。但是，我需要使用 HTTPS，因为我还需要通过 WebClient 调用发送凭据。

我在互联网上发现其他人去年也遇到过这样的问题，但是这个问题应该是用 Mango 更新解决的。

有没有人知道我该如何解决这个问题或任何解决方法，因为我没有想法。

先感谢您！

问候， 安德烈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T21:31:12.480

首先 NotFound 错误是一个通用错误，要了解问题的细节，您需要使用 Fiddler 之类的工具（使用模拟器：http: [//blogs.msdn.com/b/fiddler/archive/2010/10/15 /fiddler-and-the-windows-phone-emulator.aspx](http://blogs.msdn.com/b/fiddler/archive/2010/10/15/fiddler-and-the-windows-phone-emulator.aspx) / 使用设备：http: [//blogs.msdn.com/b/fiddler/archive/2011/01/09/debugging-windows-phone-7-device -traffic-with-fiddler.aspx](http://blogs.msdn.com/b/fiddler/archive/2011/01/09/debugging-windows-phone-7-device-traffic-with-fiddler.aspx) )

现在可能是 SSL 证书的问题？如果您使用桌面浏览器访问相同的 URL，您是否收到有关其有效性的警告/错误？如果是这样，那么您就不走运了，因为我认为您不能像使用桌面上的 fwk 那样覆盖 Windows Phone 上的证书验证。

但首先尝试使用 Fiddler 进行调试以获取一些详细信息。

# ruby-on-rails - 自定义表单处理

> ID：10366574
> 
> 赞同：0
> 
> 时间：2012-04-28T18:58:13.417
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一些不直接与任何模型链接的自定义表单（用户声誉）。我有几个影响最终回报值的声誉标准这是表单的代码

```
<%= form_tag("/add_reputing",:method => "POST") do%>
<div class="reputing_column">
    <p>
        <b>Your feedback:</b>
    </p>
    <p>
        <%= text_area_tag :comment,"",{:class=>"or-form-textarea"} %>
    </p>
    <%= submit_tag("Submit",:class=>"or-button")%>
</div>
<div class="reputing_column">
    <p>
        <b>Recomendation:</b>
    </p>
    <% @criterias.each do |c| %>
    <div class="reputing_row">
        <label><%= c.name%>:</label>
        <div>
            <% (c.rating_from .. c.rating_to).each do |i| %>
            <%= radio_button_tag "reputing_#{c.id}", i%><%= (i<1)? i : "+#{i}"%>
            <% end %>
        </div>
    </div>
    <% end %>
</div>
<% end %> 
```

在控制器中，我需要总结`"reputing_#{c.id}"`字段的值。然后在用户信誉表中添加一条记录。

在控制器中如何更好、更正确地处理来自此表单的数据？我试图用谷歌搜索这个问题，但一无所获。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T21:56:01.980

没有答案，所以我会试着澄清处理，正如你所说的，自定义表单。

这是通过单选按钮选择首选颜色的表单。

```
= form_for :preferences, url: '', method: :post do |f|
    - %w[black blue white green red yellow].each do |color|
        = f.radio_button :color, color
        = f.label :color, color.capitalize, value: color
    = f.submit 
```

Rails 中的表单很酷的一点是**它们可以在有或没有模型的情况下使用**。如果您调用了一个实例变量，`@preferences`则此表单将尊重该变量并调用其上的`color`方法以确定“当前”颜色。将在生成的表单上选择此颜色。**如果这个变量不存在，那也没什么大不了的。**

在任何情况下，提交表单后，您都可以通过以下方式访问所选颜色：

```
params[:preferences][:color] 
```

# android - 销售应用程序，包括 AndroidPlot

> ID：10366580
> 
> 赞同：1
> 
> 时间：2012-04-28T18:58:46.547
> 
> 标签：android, open-source, publishing, androidplot

现在 androidplot 的网站关闭了，我想知道你们中是否有人知道使用 AndroidPlot 销售应用程序是否合法？我应该把他们的名字放在某个地方吗？干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:35:18.037

来自[http://androidplot.com/wiki/License](http://androidplot.com/wiki/License)：

版权所有 2010 AndroidPlot.com。版权所有。

如果满足以下条件，则允许在不修改的情况下以二进制形式重新分发和使用：

```
 Redistributions in binary form must reproduce the above copyright notice, this list
  of conditions and the following disclaimer in the documentation and/or other materials
  provided with the distribution. 
```

本软件由 ANDROIDPLOT.COM “按原样”提供，不提供任何明示或暗示的保证，包括但不限于对适销性和特定用途适用性的暗示保证。在任何情况下，ANDROIDPLOT.COM 或贡献者均不对任何直接、间接、偶然、特殊、惩戒性或后果性损害（包括但不限于采购替代商品或服务；使用、数据或利润损失；或业务中断），无论是由何种责任理论引起的，无论是合同、严格责任或侵权（包括疏忽或其他）以任何方式使用本软件引起的，即使已被告知存在此类损害的可能性。

软件和文档中包含的观点和结论是作者的观点和结论，不应被解释为代表 AndroidPlot.com 明示或暗示的官方政策。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T15:02:03.063

只是对此的快速更新 - AndroidPlot 已切换到 Apache 2.0 许可证，希望它的限制更少，更容易理解：

[http://androidplot.com/about/#License](http://androidplot.com/about/#License)

# facebook - 如何检测谁是第 X 个“喜欢者”？

> ID：10366581
> 
> 赞同：0
> 
> 时间：2012-04-28T18:59:04.350
> 
> 标签：facebook, facebook-like

只是想知道在我开始查看所有文档之前。有没有一种简单的方法可以查看谁是第 X 个“喜欢者”？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:40:03.223

[您可以使用FQL *like* table](http://developers.facebook.com/docs/reference/fql/like/)获得喜欢帖子（链接、图像等）的用户，但没有关于您获得的结果的排序，您可以检查（或假设）它们是否按时间排序。

我认为最好的选择是使用 javascript sdk 注册到[*edge.create*事件](http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)，然后当有人喜欢有问题的对象时，您向服务器发送 ajax 请求，检查计数并返回答案。

# entity-framework - 避免在 EF Code First 中将所有数据从表中加载到上下文中

> ID：10366582
> 
> 赞同：1
> 
> 时间：2012-04-28T18:59:16.610
> 
> 标签：entity-framework, entity-framework-4, ef-code-first, code-first

我对 EF Code First 方法完全陌生，我遇到了一些麻烦。我真的需要你的帮助。

我有 3 节课，如下所示

```
 [Table("Customers")] 
public class Customer
{

    public long Id { get; set; }
    public string Name { get; set; }
    public string MiddleName { get; set; }
    public string Surname { get; set; }
    public string FirmName { get; set; }
    public string ShortName { get; set; }

    public virtual ICollection<CustomerEmail> CustomerEmails { get; set; }
    public virtual ICollection<CustomerAddress> CustomerAddresses { get; set; }

}

 [Table("CustomerEmail")]
public class CustomerEmail
{

    public long Id { get; set; }
    public string Email { get; set; }
    public DateTime RecordTime { get; set; }

    public virtual Customer Customer { get; set; }
}

 [Table("CustomerAddress")]
public class CustomerAddress
{
    public long Id { get; set; }
    public Int16 CountryCode { get; set; }
    public Int16 CityCode { get; set; }
    public string City { get; set; }
    public string Town { get; set; }
    public string District { get; set; }
    public string Street { get; set; }
    public string PostalCode { get; set; }

    public virtual  Customer Customer { get; set; }

}

 public class MyDbContext : DbContext
{
    public DbSet<Customer> Customers { get; set; }
    public DbSet<CustomerEmail> CustomerEmails { get; set; }
    public DbSet<CustomerAddress> CustomerAddresses { get; set; }

} 
```

我的问题

1）当我运行应用程序时，它找不到与客户相关的表，即 CustomerAddress 和 CustomerEmail。它给出了一个错误，说“Customer_Id 没有在 CustomerEmail 和 CustomerAddress 表中退出”。我认为这些模型之间的关系有问题。我需要你的有助于改善这些关系。

2）获取客户数据没有问题。但是它带来了所有数据。例如，我在客户表中有 10.0000 行，它在我的上下文类中带来了 10.000 行。这不好。我不希望它带来所有数据首先。我想在查询时只带相关数据。

伙计们，我真的很快需要你的帮助。谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T22:37:47.453

1.  Due you are not following the EF foreign key conventions, you will need to set those relations by fluent-mapping into your DbContext class. Look for a blog about fluent-mapping to figureout how to make one-to-one relations

2.  Maybe you are performing a linq query without a where clause. Please put some code related with this item.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T13:25:31.033

```
[Table("CustomerAddress")]                     
public class CustomerAddress                     
{                         
public long Id { get; set; }  
public long CustomerId { get; set; }                         
public Int16 CountryCode { get; set; }                          
public Int16 CityCode { get; set; }                          
public string City { get; set; }                         
public string Town { get; set; }                         
public string District { get; set; }                          
public string Street { get; set; }                          
public string PostalCode { get; set; }                                                                      
public virtual  Customer Customer { get; set; 
}

 protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {

        modelBuilder.Entity<CustomerAddresses>()
        .HasKey(a => a.CustomerId)
        .HasRequired(a => a.Customer)
        .WithMany(b => b.CustomerAddresses)
        .HasForeignKey(a => a.Id);        
    } 
```

当我查询 context.Customers.Find(3);

Customer 的 CustomerAddresses 属性中应该有 2 行，但只有一行是第一行。为什么它只带来一行？我试图建立 1-n 关系

# c# - 是否可以在没有 SQL Server 的情况下访问 .mdf 数据库？

> ID：10366586
> 
> 赞同：19
> 
> 时间：2012-04-28T18:59:54.717
> 
> 标签：c#, sql-server, mdf

我`.mdf`通过 SQL Server 创建了一个文件并将其放入本地文件。我在没有安装 SQL Server 的计算机上运行我的程序。而且我还使用了`System.Data.SqlClient`命名空间中的类（即`SqlConnection`..）

`.mdf`我想与SQL Server 创建的文件建立某种访问连接？是否可以 ？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-28T19:05:28.730

我认为不通过 SQL Server 引擎就不可能与 MDF 文件进行交互。您很可能会安装 SQL Server Express（如果您选择通过 Visual Studio 的添加/删除程序，这应该是一个选项，或者您可以[从此处单独下载它 - 这是 2008 R2 With Tools 选项](http://www.microsoft.com/en-us/download/details.aspx?id=23650)），附加您的数据库，然后从您的程序连接到该引擎。

许多在线教程会建议您使用该`User Instances`功能和`AttachDbFileName`. 我建议你*不要*走那条路，因为它经常会导致混乱——很多很多用户通过 Management Studio 连接到数据库的一个实例，与他们的程序不同的实例，然后不明白为什么看不到对方所做的更新。这些`User Instances`功能已弃用，我非常喜欢将数据库正确附加到实例。

在 SQL Server 2012 中，您可以下载新的[SqlLocalDb](http://msdn.microsoft.com/en-us/library/hh510202.aspx)运行时（[您需要从此处获取 x86 或 x64 SqlLocalDB.MSI 文件](http://www.microsoft.com/en-us/download/details.aspx?id=29062)），这使得此过程更加容易，因为它是一个无需维护的按需 SQL Server 引擎。但是请注意，您的数据库将升级到新的 11.0 文件格式，这意味着您将无法分离/附加或备份/恢复到旧版本（2008、2008 R2 等）。我[在这里为新用户添加了许多从 SqlLocalDb 开始的故障排除技术](http://social.technet.microsoft.com/wiki/contents/articles/4609.troubleshoot-sql-server-2012-express-localdb.aspx)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-28T20:18:21.487

您可以尝试使用[OrcaMDF](https://github.com/improvedk/OrcaMDF#readme)，它是一个开源项目。

什么是 OrcaMDF？

> 用于 MDF 文件的 AC# 解析器。允许您从 MDF 文件中读取表、元数据和索引，而无需将其附加到正在运行的 SQL Server 实例。

（此描述取自项目页面）。

[作者的博客](http://improve.dk/archive/2011/05/03/introducing-orcamdf.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T19:06:14.237

您需要 SQL 才能连接到 MDF。您可以将其转换为 SDF 并加载精简版（免费）。 [http://msdn.microsoft.com/en-us/data/ff687142](http://msdn.microsoft.com/en-us/data/ff687142)

# node.js - 分布式信号量系统，用于序列化不能同时运行的任务

> ID：10366588
> 
> 赞同：4
> 
> 时间：2012-04-28T19:00:30.680
> 
> 标签：node.js, mongodb, redis, rabbitmq, zeromq

我正在寻找一种在不使用**MySQL**的情况下序列化影响数据存储中数据的任务的方法， 例如：进行记账的工作人员`group1`应该是唯一对第一组进行记账的工作人员，如果另一名工作人员正在对第一组进行记账，则应该在队列中等待。

我可以通过设置信号量表、启动事务、更新 for 的行`group1`、执行我的任务并提交来使用 MySQL 完成此操作。

我在想也许可以使用 0mq redis 或某种消息传递系统来实现相同的目标，并允许我使用我想要的任何数据存储。我还认为**ScalienDB**可能能够在与 mysql 相同的庄园中解决问题，因为它支持事务。**ScalaenDB**的文档似乎有些不完整，所以我无法确定它是否可以以这种方式进行交易。
所以我的问题是：

1.  如果ScalienDB想要编辑另一个客户端也已对其进行编辑的表中的行，那么**ScalienDB**是否可以执行强制客户端等待另一个客户端提交的事务。

2.  使用消息传递系统，你会如何建议实现一些归结为这样的东西：

```
var semaphore = semaphore_group()
semaphore.acquire('task1',function(){
    // 在大二学生被锁定后做工作
    semaphore.release() //
})

```

理想情况下，我不希望该系统依赖于集中式代理

3.  是否有适合此问题的替代解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T19:01:03.233

我最喜欢 Node 的是*无线程*，这意味着每一行代码都可以被认为是*原子*的。因此，您可以轻松编写几行 JS 代码，该代码将运行一个套接字服务器，该服务器将为工作人员提供您想要的确切机制，如您的示例代码所示。

我不确定调用这个信号量在技术上是否正确，因为我们会跟踪等待轮到他们的工人。

工作人员：

```
var Semaphore = reqire('./semaphore.js'),
    semaphore = new Semaphore(worker-id, group-id);

semaphore.on('ready', function() {
    // Yay! We can work..!
    semaphore.done();
} 
```

semaphore.js 骨架：

```
// imports...

module.exports = S = function(gid) {
    events.EventEmitter.call(this);

    // create socket connection to semaphore server
    // send a message for lock on gid
    // emit ready event when server sends ready message.
    // send 'done' message when done() method is called.

}; util.inherits(S, events.EventEmitter); 
```

semaphore-server.js 框架：

```
// imports...

var queues = {};  // { 'group-id': [worker1, worker2, ...] }

// start socket server

/* on message: take worker-id and group-id
   queues[groupid].push(workerid);
   check if queues[groupid][0]==workerid and if it is,
   send back ready message.
*/

/* on message 'done', remove workerid from queues[groupid]
   and if there are any workers waiting, send the first one
   ready message.
*/ 
```

您的代码不会比上面的这个骨架长多少。对于这种简单的消息传递系统，ZeroMQ 或任何其他消息传递不是必需的。您可能会考虑向工作人员添加超时，并且每当发生超时时，向工作人员发送一条消息，询问“您还在工作吗？” 并按此继续。您的超时处理程序还可以检查队列中是否有任何其他工作人员，所以如果没有，甚至没有必要打扰工作人员时间......

如果我只需要一个像这样可以在一个小时内构建的简单系统，我通常更喜欢使用我已经拥有的工具而不是去第三方。任何其他库/dbms/messaing-system 或任何会增加我不喜欢的软件的复杂性和管理工作的东西。由于您已经在 Node 中构建了一些东西，并且它已经完美地提供了您想要的东西，我相信这是要走的路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T12:53:08.730

我会考虑使用像 Apache Zookeeper 这样的分布式协调服务来创建和处理你的分布式锁。这是一个描述你将如何去做的食谱：http: [//zookeeper.apache.org/doc/trunk/recipes.html#sc_recipes_Locks](http://zookeeper.apache.org/doc/trunk/recipes.html#sc_recipes_Locks)

# delphi - 使用硬链接确定目录中使用的实际大小

> ID：10366593
> 
> 赞同：1
> 
> 时间：2012-04-28T19:01:36.413
> 
> 标签：delphi

我最近在一个程序上玩硬链接，该程序将文件复制到其目录中的所有位置，删除所有重复项并用硬链接替换它们。我把它记下来了。我了解硬链接的工作方式只是对磁盘上数据本身的另一种引用。因此，如果我要从创建的硬链接访问数据，它看起来是一样的。

问题是找到实际使用的磁盘空间量，这是验证这确实是节省空间的问题之一。换句话说，如果要从 12K 文件开始，创建该文件的硬链接，然后在资源管理器中选择两者，它会显示为 24K 在磁盘上使用，而不是真正应该的 12K。

我知道我可以在进程之前和之后查询磁盘上的可用空间，然后进行比较。但这是初步评估，事后很难验证。我也知道我可以使用[GetFileInformationByHandle](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364952%28v=vs.85%29.aspx)来查明相关文件是否有多个引用。

那么这里有什么想法吗？我是否必须为每个文件调用 GetFileInformationByHandle，记录所有数据，然后删除具有重复索引引用的文件才能准确了解实际使用了多少磁盘空间？或者有没有更简单的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T15:49:27.943

做到这一点。维护一组 (dwVolumeSerialNumber, nFileIndexHigh, nFileIndexLow) 三元组。每次遇到文件时，请检查您以前是否看过它（即，它的三元组是否已经在您的集合中）。如果是这样，那就跳过它。如果没有，则将其文件大小添加到您的总数中，并将其信息插入集合中。

不幸的是，这意味着您必须打开每个文件。链接数没有保存在目录信息中，所以`FindFirstFile`不能给你。你需要`GetFileInformationByHandle`，这需要一个句柄。

您可能希望阅读[Raymond Chen 关于该主题的文章](http://blogs.msdn.com/b/oldnewthing/archive/2004/12/28/336219.aspx)；除了可以应用于您的应用程序的硬链接之外，它还提到了其他几个极端情况，包括重解析点、聚类舍入和备用数据流。

您可以尝试通过仅跟踪链接计数大于 1 的文件来减少维护集合所需的工作量。只有一个链接的文件不应在目录遍历中多次出现。假设您只会看到每个目录一次。重新解析点和连接点会使假设无效，因此如果您尝试减小“已查看文件”集的大小，您还需要跟踪已查看的目录。

# java - 我是否正确使用了 compareTo 方法

> ID：10366594
> 
> 赞同：-1
> 
> 时间：2012-04-28T19:01:43.923
> 
> 标签：java

我被困在以下问题上：

> 研究以下 Java 类头和代码片段：
> 
> ```
> class ExamScript implements Comparable<ExamScript>
> {
>     private String studentName;
>     private int mark;
>     ...rest of class...
> 
>     /**
>       * Compares this object with the specified object for e
>       *@param e the object to be compared
>       *@return -1 if object is less than the specified object
>       *@return 0 if object is equal to the specfied object
>      **/
>        public int compareTo(ExamScript e)
>        {
>          if (mark < e.mark)
>              return - 1;
>          if (mark == e.mark)
>              return 0;
>          return 1;
>        }
> } 
> ```
> 
> 为该`compareTo`方法提供合适的文档。特别说明从该方法返回的值的含义。
> 
> `compareTo`根据您的规范编写该方法的代码。

我已经记录并编写了如上所示的代码。任何人都可以为我确认我是否可以稍微改进我的文档/编码，或者这样可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:15:10.793

我看到的问题是，当成绩相等时，学生被认为是平等的（至少当算法假设`a.compareTo(b)==0`意味着`a.equals(b)`可能是一件好事

但如果不好，您可以通过比较名称而不是返回 0 来解决此问题

```
public int compareTo(ExamScript e)
{
  if (mark < e.mark)
      return - 1;
  if (mark == e.mark)
      return studentName.compareTo(e.studentName);
  return 1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:07:08.730

确保添加`@returns 1 if e is greater than this object.`

您可以更具体地使用 @returns。尝试使用我上面使用的格式。此外，如果从阅读代码中看不出来，请尝试解释什么是标记，以及为什么要使用它来比较。

查看[Oracle 的标准](http://www.oracle.com/technetwork/java/javase/documentation/index-142372.html#method)以获取更多信息。

# python - 如何使用 Python 读取 MS-Word 文件中表格的内容？

> ID：10366596
> 
> 赞同：18
> 
> 时间：2012-04-28T19:01:51.250
> 
> 标签：python, ms-word

如何读取和处理 DOCX 文件中表格的每个单元格的内容？

我在 Windows 7 和 PyWin32 上使用 Python 3.2 来访问 MS-Word 文档。

我是初学者，所以我不知道到达表格单元格的正确方法。到目前为止，我刚刚做到了这一点：

```
import win32com.client as win32
word = win32.gencache.EnsureDispatch('Word.Application')
word.Visible = False 
doc = word.Documents.Open("MyDocument") 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2015-08-06T07:16:26.440

在相当晚的生活中加入，但我想我还是会把它说出来：现在（2015 年），你可以使用非常简洁的 doc python 库： [https](https://python-docx.readthedocs.org/en/latest/) ://python-docx.readthedocs.org/en/latest/ 。接着：

```
from docx import Document

wordDoc = Document('<path to docx file>')

for table in wordDoc.tables:
    for row in table.rows:
        for cell in row.cells:
            print cell.text 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-04-29T19:54:08.890

以下是在 Python 2.7 中对我有用的方法：

```
import win32com.client as win32
word = win32.Dispatch("Word.Application")
word.Visible = 0
word.Documents.Open("MyDocument")
doc = word.ActiveDocument 
```

要查看您的文档有多少个表格：

```
doc.Tables.Count 
```

然后，您可以通过索引选择所需的表。请注意，与 python 不同，COM 索引从 1 开始：

```
table = doc.Tables(1) 
```

要选择一个单元格：

```
table.Cell(Row = 1, Column= 1) 
```

要获取其内容：

```
table.Cell(Row =1, Column =1).Range.Text 
```

希望这会有所帮助。

**编辑：**

根据标题返回列索引的函数示例：

```
def Column_index(header_text):
for i in range(1 , table.Columns.Count+1):
    if table.Cell(Row = 1,Column = i).Range.Text == header_text:
        return i 
```

然后您可以通过这种方式访问​​您想要的单元格，例如：

```
table.Cell(Row =1, Column = Column_index("The Column Header") ).Range.Text 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-11-18T08:43:05.843

[我在etienne的博客](https://stackoverflow.com/users/146481/etienne)[Reading Table Contents Using Python](http://etienned.github.io/posts/extract-text-from-word-docx-simply/)上找到了一个简单的代码片段

这样做的好处是您不需要安装任何非标准的 python 库。

docx 文件的格式在[Open Office XML](http://officeopenxml.com/)中进行了描述。

```
import zipfile
import xml.etree.ElementTree

WORD_NAMESPACE = '{http://schemas.openxmlformats.org/wordprocessingml/2006/main}'
PARA = WORD_NAMESPACE + 'p'
TEXT = WORD_NAMESPACE + 't'
TABLE = WORD_NAMESPACE + 'tbl'
ROW = WORD_NAMESPACE + 'tr'
CELL = WORD_NAMESPACE + 'tc'

with zipfile.ZipFile('<path to docx file>') as docx:
    tree = xml.etree.ElementTree.XML(docx.read('word/document.xml'))

for table in tree.iter(TABLE):
    for row in table.iter(ROW):
        for cell in row.iter(CELL):
            print ''.join(node.text for node in cell.iter(TEXT)) 
```

# android - 根据屏幕分辨率加载图标

> ID：10366603
> 
> 赞同：0
> 
> 时间：2012-04-28T19:02:30.767
> 
> 标签：android, android-layout

如何在 Android 中根据屏幕分辨率加载图标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T07:29:17.080

您可以参考 Google 自己的[Supporting Multiple Screens](http://developer.android.com/guide/practices/screens_support.html)文档来轻松完成工作。

# php - 使用什么算法来分配碎片

> ID：10366611
> 
> 赞同：7
> 
> 时间：2012-04-28T19:03:24.253
> 
> 标签：php, algorithm

您好，我为一家以这种方式运作的制造公司工作

我们得到一卷特定尺寸的材料，我们的供应商让我们说每卷 8000 米。然后我们收到不同客户的订单，例如 2000 米、3000 米等。我想知道我应该如何创建一个软件，让他们只需输入他们当前的卷筒尺寸和我们目前的不同订单就可以了生成切割不同卷材的最佳方式，以最大限度地减少浪费。

例如在特定时间点我们可能有以下订单 2 件 3000 米 2 件 4000 米 6 件 1500 米

然后我们只需要输入上述订单以及供应商为我们提供的卷筒尺寸，我们假设它是 8000 米。

然后软件应生成输出，例如 Roll 1 - 两片 4000 米 Roll Wasted 0 Roll 2 - 两片 3000 米和 1 片 1500 (Roll Wasted 500) Roll 3 - 五片 15000 (Roll Wasted 500)

脚本应该优化，因为上面的例子很小。通常我们一次会订购大约 200 件

我正在考虑在 PHP 和 MYSQL 中执行此操作，因此它可以基于 Web，并且公司周围的人都可以使用它。

我知道我们可以通过蛮力尝试每种组合来做到这一点。但是在这种情况下是否有任何其他排序算法和技术可以提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:08:55.167

这是众所周知的[切割库存问题](http://en.wikipedia.org/wiki/Cutting_stock_problem)，您希望在完成所有订单后最大限度地减少浪费。

维基百科是这样描述它的：

> 切削问题是一个优化问题，或者更具体地说，是一个整数线性规划问题。它源于工业中的许多应用。想象一下，您在一家造纸厂工作，您有许多固定宽度的纸卷等待切割，但不同的客户需要不同数量的不同尺寸宽度的纸卷。你将如何切割面包卷以最大限度地减少浪费（剩余量）？

一般情况是 NP-hard，这意味着没有快速算法来产生最优结果。

但是，您可以编写一个算法来生成计算速度快且“合理”好的*近似*解。

* * *

编辑（礼貌@David）：

如果你从制造商那里得到的原始卷总是相同的尺寸，在这种情况下是 8,000 米，那么下料问题就简化为[一维装箱问题](http://en.wikipedia.org/wiki/Bin_packing_problem)，这更容易解决（但仍然是 NP-hard .)

@David 在其已删除的答案中提出的贪婪解决方案是获得近似解决方案的一种快速且廉价的方法。

* * *

编辑2：

我有点说错了。对于装箱问题，没有已知的多项式时间近似方案。不过，[贪心算法实际上还不错。](http://en.wikipedia.org/wiki/Bin_packing_problem#Analysis_of_approximate_algorithms)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:06:55.213

您正在寻找一维装箱算法。有很多策略可以解决它，First-Fit、Best-Fit、Random-Fit。我在 phpclasses.org 上写了一个 php 解决方案。你可以免费下载我的程序（bin-packing）。事实上，我已经为此获奖了。如果您的问题不是那么大，我会尝试一种蛮力方法。

# objective-c - 从 UIGestureRecognizer 中排除表格以隐藏键盘

> ID：10366612
> 
> 赞同：2
> 
> 时间：2012-04-28T19:03:33.847
> 
> 标签：objective-c, cocoa, uigesturerecognizer

当用户在文本字段之外点击时，我正在使用 UIGestureRecognizer 退出键盘。这没有问题，我已经设法排除了 3 个按钮，但是现在我在页面中添加了 2 个表格，我找不到将它们从 shouldReceiveTouch 中排除的方法：

这是相关代码：

```
- (void)viewDidLoad
{
.....
UITapGestureRecognizer *gestureRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(hideKeyboard)];
[[self view] addGestureRecognizer:gestureRecognizer];
[gestureRecognizer setDelegate:self];
}

- (void)hideKeyboard
{
[tradeQuantity resignFirstResponder];
[tradeSymbol resignFirstResponder];
[limitPrice resignFirstResponder];
}

- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch
{        
if (touch.view == placeTradeButton)
{
    return NO;
} else if (touch.view == resetValuesButton)
{
    return NO;
} else if (touch.view == refreshDataButton)
{
    return NO;
} else if (touch.view == secHoldingsTable)
{
    return NO;
} else if (touch.view == tradeTicketsTable)
{
    return NO;
}
return YES;
} 
```

如何排除表格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:41:04.813

我还没有找到我的问题的答案，但我确实找到了一种解决方法，可以满足我的需要。我没有尝试找出如何排除表格，而是相反。

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch
{            
if (touch.view == [self view])
{
    return YES;
}
return NO;
} 
```

# android - 相机没有保存到指定的文件位置android

> ID：10366613
> 
> 赞同：2
> 
> 时间：2012-04-28T19:03:34.183
> 
> 标签：android, camera

大家好，我正在使用相机应用程序形成我的活动。使用下面的这一行，我试图将图像输出到我在 sd 卡上的指定位置。它不会将图像保存到从 getImageUri() 获取的位置，而是将文件保存到相机画廊。任何想法出了什么问题。

```
intent.putExtra(MediaStore.EXTRA_OUTPUT, getImageUri());

//my getImageUri

private Uri getImageUri() {

    // Store image on sdcard

    String dir= Environment.getExternalStorageDirectory() +"/my_app/Datapics";

    File dirs = new File(dir);
    if (!dirs.exists()) {
        dirs.mkdirs();
    }
    Bundle extras = getIntent().getExtras();
    CAPTURE_TITLE = extras.getString(some.NAME);
    //EDIT if i add this line here 
    CAPTURE_TITLE= "whatever.png";
    //it will save my picture to the folder i want it to save to but with name 
    //whatever.png i'm getting my name from my previous activity and want 
    //to assign it to capture title

    File file = new File(dir , CAPTURE_TITLE+".jpg");

    Uri imgUri = Uri.fromFile(file);

    Log.e("get imageuri called: ",imgUri.toString());
//this is what I get from here
//04-28 19:42:33.835: E/get imageuri called:(2049):
 //file:///mnt/sdcard/my_app/Datapics/BlackbirdSat%20Apr%2028%2019%3A42.jpg

    Log.e("get imageuri called2: ",file.toString());
     //this is what i get here
//04-28 19:42:33.835: E/get imageuri called2:(2049)
//:/mnt/sdcard/my_app/Datapics/BlackbirdSat Apr 28 19:42.jpg
    return imgUri;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:17:04.037

我见过一些版本的 Android 和/或硬件不尊重`MediaStore.EXTRA_OUTPUT`标志。我的代码中有这个评论+解决方案：

```
/*
 * HTC Eris and possibly other phones DONT respect the MediaStore.EXTRA_OUTPUT flag and they only
 * return the image URI in the Data. In Android instances where the MediaStore.EXTRA_OUTPUT *IS* respected
 * then Data is null. So use this fact retrieve the correct bitmap reference. When we have to return it from
 * Data then just copy it to the fileUri that we tried to store it in the first place via
 * MediaStore.EXTRA_OUTPUT. 
*/

  private void gotoCamera() {
    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
    String mBoothFileName = "snap_" + (new Date()).getTime() + ".jpg";
    mStateHolder.mPictureFile = new File(((BatchApp) getApplication()).getStorageDirectory(), mBoothFileName);
    mStateHolder.mPictureUri = Uri.fromFile(mStateHolder.mPictureFile);
    intent.putExtra(MediaStore.EXTRA_OUTPUT, mStateHolder.mPictureUri);
    startActivityForResult(intent, TAKE_PICTURE);
  }

/*
* When the post Camera activity returns
*/
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
  super.onActivityResult(requestCode, resultCode, data);

  if (requestCode == TAKE_PICTURE) {
    if (resultCode == RESULT_OK) {
      /*
           * HTC Eris and possibly other phones DONT respect the MediaStore.EXTRA_OUTPUT flag and they only
           * return the image URI in the Data. In Android instances where the MediaStore.EXTRA_OUTPUT *IS* respected
           * then Data is null. So use this fact retrieve the correct bitmap reference. When we have to return it from
           * Data then just copy it to the fileUri that we tried to store it in the first place via
           * MediaStore.EXTRA_OUTPUT. See how sneaky we are....
           */
      if (data != null && data.getData() != null) {
        Uri imageUri = data.getData();
        try {
          InputStream input = getContentResolver().openInputStream(imageUri);
          FileOutputStream output = new FileOutputStream(mStateHolder.mPictureFile);
          /* 
          From Apache Commons IO: copy one stream to another:
          http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/IOUtils.html
          */

          IOUtils.copy(input, output);
          mStateHolder.mPictureUri = Uri.fromFile(mStateHolder.mPictureFile);
        } catch (Exception e) {
          Toast.makeText(this, "Oops - couldn't capture your picture.", Toast.LENGTH_LONG).show();
        }
      }
    }

    // you now have your image at "mStateHolder.mPictureUri"
    // do whatever you need to do ...

  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T07:35:39.243

获取 sd 卡地址后，您需要明确提及要放置相机图像的文件夹名称。在这里，我将“我的文件夹”放在将保存图像的位置...

尝试这个...

```
File defaultDir = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES);
// now specifing custom folder name in defaultDir
File myDir = new File(defaultDir, "My Folder");
// specify your picture name
String myPictureName = "Picture" + ".jpg";
// Making file name
String filename = myDir.getPath() + File.separator + myPictureName;
File pictureFile = new File(filename);
try {
    //Writing file to SD-Card
    FileOutputStream fos = new FileOutputStream(pictureFile);
    fos.write(data);
    fos.close();
} catch (Exception e) {
// ---
} 
```

希望这有效...

# ios - DidSelectRowAt .. 没有任何反应

> ID：10366620
> 
> 赞同：0
> 
> 时间：2012-04-28T19:04:27.013
> 
> 标签：ios, xcode, uitableview

我正在尝试使用 tableView 构建一个应用程序，到目前为止，我已经达到了填充 tableView 的地步，但是当我按下行时我什么也没有发生。任何帮助，将不胜感激。如果您缺少一些代码来帮助我，请询问，我会发布它。

使用 NSLog 我已经确定当我按下一行时会调用该操作，但不会推送下一个 viewController。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    NSLog(@"DidSelectRow");

   // UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];

    galleriaDetailViewController *galleriaDetail = [[galleriaDetailViewController alloc] initWithNibName:@"galleriaDetail" bundle:nil];
    [self.navigationController pushViewController:galleriaDetail animated:YES];

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:34:42.587

从您的评论中，我发现您正在使用情节提要。如果您使用情节提要，那么您为什么要尝试访问笔尖。

试试这个代码

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    NSLog(@"DidSelectRow");

   // UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];

    galleriaDetailViewController *galleriaDetail = [self.storyboard instantiateViewControllerWithIdentifier:@"galleriaView"]; // galleriaView is a identifier for that view.you have to set in your storyboard
    [self.navigationController pushViewController:galleriaDetail animated:YES];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:07:07.820

你设置你的代表了吗？您需要设置`myTableView.delegate = self;`和设置数据源。您可以在界面生成器中或以编程方式连接委托。

# grails - Grails：将域类变量映射到 Web API XML 数据源

> ID：10366625
> 
> 赞同：0
> 
> 时间：2012-04-28T19:05:06.103
> 
> 标签：grails, mapping, datasource

我正在创建一个对返回 XML 的 Web 服务具有只读访问权限的 Grails 应用程序。除用户名/密码外，此应用程序的全部数据都来自此外部 Web 服务。

将我的域类中的变量映射到此数据源的最佳方法是什么？我找到了许多带有数据库的自定义 ORM 示例，但没有找到 XML 示例。我将在哪里编写进行 HTTP 调用和提取字段的逻辑？

非常感谢任何和所有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T08:31:39.457

我们非常成功地使用带有 MarkupBuilder/XmlSlurper 的 Spring Web 服务。您可以使用 WebServiceTemplate 为给定的 Uri 创建 Web 服务客户端，并通过使用 MarkupBuilder 构建的 XML 发送您的请求。

这对我们来说具有很大的优势，可以将 WSDL 作为接口的中心描述，作为文档工件，无需代码生成和生成的代码需要维护，无需为 jaxb 绑定添加注释，无需数据对象。

我们不使用域类，我们使用通过直接读取 Web 服务调用的 XML 结果获得的 GPathResult，因为以鸭子类型的方式，客户端等效于 java 对象。但是，我们没有网络界面。如果你有一个网络界面，我会用一个

```
def toXml(MarkupBuilder b) {
} 
```

方法，或者也许

```
myCommandObject as XML 
```

会起作用，具体取决于您的 wsdl 的 XSD 架构。这样您就可以利用 grails 数据绑定和验证。

对于视图的数据模型，可能传递一个鸭子类型的命令对象（兼容的 XML 对象）就足够了，因此您不必双向编组。

另一个警告是 grails spring-ws 插件的当前版本已经过时了。我不认为它会与 grails 2.0 配合得很好，因为那里有旧的 spring-security-core 类。好消息是，如果你只是构建一个客户端，你几乎不需要插件。只需包含最新的 Spring Web 服务 jar 并使用 WebServiceTemplate.sendToEndpoint 方法。

# iphone - 如何使用 insertRowsAtIndexPaths 将数组内的字典添加到 UItableview？

> ID：10366626
> 
> 赞同：0
> 
> 时间：2012-04-28T19:05:07.513
> 
> 标签：iphone, arrays, uitableview, dictionary, cell

如何使用**insertRowsAtIndexPaths将****getnewdata**的结果添加到现有的 tableView 中？我找到了几个例子，但无法弄清楚。

 **```
- (void)getfirstdata {
     [...] //get JSON data
     self.data = jsonResult; //a dictionary inside of an array
     [self.tableView reloadData];
}

- (void)getnewdata {
     [...] //get new JSON data which has to be added to top of the table
     self.data = jsonnewResult; //a dictionary inside of an array
     [self.tableView reloadData];
}

(UITableViewCell *) tableView: (UITableView *) table_view cellForRowAtIndexPath: (NSIndexPath *) index_path
    static NSString *CellIdentifier = @"Cell";
    if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }
    id celldata = [self.data objectAtIndex:[index_path row]];
    cell.textLabel.text = [celldata valueForKeyPath:@"user.name"];
    cell.detailTextLabel.text = [celldata objectForKey:@"text"];

return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:12:29.297

为了获得新的，你想添加到你的数据中，所以......

```
- (void)getnewdata {
     [...] //get new JSON data which has to be added to top of the table
     [self.data addObjectsFromArray:jsonResult];
     [self.tableView reloadData];
} 
```

确保 self.data 是一个 NSMutableArray。

**编辑**

我突然想到，您可能希望将新数据放在首位....

```
NSMutableArray *newModel = [NSMutableArray arrayWithArray:jsonResult];
[newModel addObjectsFromArray:self.data];
self.data = newModel; 
```**

# c++ - C ++如何将IP地址转换为字节？

> ID：10366631
> 
> 赞同：1
> 
> 时间：2012-04-28T19:05:27.070
> 
> 标签：c++

如何在 C++ 中将 IP 地址转换为字节？基本上我如何解析IP地址？例如，如果我有一个字符串等于`121.122.123.124`. 我需要这样解析`byte1 = 121`, `byte2 = 122`, `byte3 = 123`, `byte4 = 124`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T19:21:24.547

使用`sscanf()`功能：

```
#include <cstdio>

char arr[] = "192.168.1.102"; 
unsigned short a, b, c, d;
sscanf(arr, "%hu.%hu.%hu.%hu", &a, &b, &c, &d); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T21:01:17.003

使用[`inet_aton`](http://linux.die.net/man/3/inet_aton).

```
#include <arpa/inet.h>
#include <string>
#include <iostream>

int
main(int argc, char *argv[])
{
  std::string s;
  in_addr addr;

  while(std::cin >> s && inet_aton(s.c_str(), &addr)) {
    std::cout << inet_ntoa(addr) << "\n";
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T19:15:59.350

如果模式是恒定的，数字点数字点等，则使用 istringstream：

```
#include <sstream>
using namespace std;

int byte1, byte2, byte3, byte4;
char dot;
char *ipaddress = "121.122.123.124";
istringstream s(ipaddress);  // input stream that now contains the ip address string

s >> byte1 >> dot >> byte2 >> dot >> byte3 >> dot >> byte4 >> dot; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T19:09:53.637

试试这个：

```
char ipstr[] = "121.122.123.124";
char *marker, *ret;
unsigned char b1, b2, b3, b4;
ret = strtok_r(ipstr, ".", &marker);
b1 = (unsigned char)strtod(ret, NULL);
ret = strtok_r(NULL, ".", &marker);
b2 = (unsigned char)strtod(ret, NULL);
ret = strtok_r(NULL, ".", &marker);
b3 = (unsigned char)strtod(ret, NULL);
ret = strtok_r(NULL, ".", &marker);
b4 = (unsigned char)strtod(ret, NULL); 
```

# javascript - 即使加载了 window.load，document.ready 也会运行

> ID：10366635
> 
> 赞同：0
> 
> 时间：2012-04-28T19:05:31.717
> 
> 标签：javascript, jquery

写什么来检查窗口是否已完全加载然后执行一些功能，如果没有则执行`document.ready`功能....即：我有一个预加载图像，如果窗口没有完全加载，我会调用它`document.ready`.....如果窗口已完全加载，我将隐藏此预加载图像....如果窗口未完全加载并在窗口加载后消失，它会正常运行.....但是`document.ready`即使窗口已经加载也会被调用...所以如何检查窗口是否已加载，然后不执行`document.ready`，如果没有，则执行`document.ready`

```
$(document).ready(function (e) {
    $("#loding").css("visibility", "visible");
    $("body").css('overflow', 'hidden');
    $("#container").css("opacity", 0);
});
$(window).load(function (e) {
    $("#loding").animate({
        opacity: 0
    }, 500, function () {
        $("#loding").css("width", "70%");
        $("#loding").css("visibility", "hidden");
    });
    $("#container").css("opacity", 1);
    $("body").css('overflow', 'auto');
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:17:33.233

你可以做这样的事情：

```
var loaded = false;
$(document).ready(function(e) {
   if(!loaded) {
     // only run here if the $(window).load() function hasnt run
   }

});
$(window).load(function(e) {
   // run your functions
   loaded = true;
}); 
```

使用简单`boolean`来指示加载的函数是否已运行

# c# - 从字符串转换为 system.drawing.point c#

> ID：10366636
> 
> 赞同：4
> 
> 时间：2012-04-28T19:05:32.080
> 
> 标签：c#, vb.net, string, point, typeconverter

我想再次将`{X=-24,Y=10}`生成的字符串转换`Point.ToString();`为Point？

我在保存模式下将字符串值保存在 xml 文件中，我想在读取模式下再次读取它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T19:11:19.647

```
var myStringWhichCantBeChanged="{X=-24,Y=10}";
var g=Regex.Replace(myStringWhichCantBeChanged,@"[\{\}a-zA-Z=]", "").Split(',');

Point pointResult = new Point(
                  int.Parse (g[0]),
                  int.Parse( g[1])); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T19:09:25.903

`System.Drawing.Point`根本没有定义`Parse`方法——您需要编写自己的方法来采用这种格式并返回一个`Point`结构。

`System.Windows.Point`确实有`Parse`方法，可能更适合您的需求。

但是，由于您要输出到 XML，因此不需要这些。您应该序列化和反序列化对象图，它会自动处理此问题，而无需担心解析和格式化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:09:56.540

你可以试试这个[Point.Parse](http://msdn.microsoft.com/en-us/library/system.windows.point.parse.aspx)

```
Point pointResult = Point.Parse("-24,10"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-30T20:10:44.803

Hans Passant 有正确的解决方案：不要使用`Point.ToString()`，它会给你一个疯狂的、不可重用的字符串（MSDN 称之为“[人类可读的](http://msdn.microsoft.com/en-us/library/10t2c5at.aspx)”）。改用[`PointConverter`](http://msdn.microsoft.com/en-us/library/System.Drawing.PointConverter.aspx)类。

要生成字符串：

```
Dim myPoint As New Point(0, 0)
Dim pointConverter As System.ComponentModel.TypeConverter = _
    System.ComponentModel.TypeDescriptor.GetConverter(GetType(Point))
Dim pointAsString As String = pointConverter.ConvertToString(myPoint) 
```

并解释上面的字符串：

```
Dim pointConverter As System.ComponentModel.TypeConverter = _
    System.ComponentModel.TypeDescriptor.GetConverter(GetType(Point))
Dim myNewPoint As New Point = pointConverter.ConvertFromString(pointAsString) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-09T20:01:13.657

我自己今天需要这个功能，所以我只是编写了代码。这是一个非常挑剔的解析器，使用“TryParse”方法。我不喜欢我所说的“懒惰”解析，其中“blah4,9anything”会被解析为一个点。而且我不喜欢抛出错误。数据类型的“TryParse”方法对我来说非常健壮。所以这是我的实现供任何人使用。我唯一的要求是，如果您发现错误，请告诉我！:)

```
public static bool TryParsePoint(string s, out System.Drawing.Point p)
{   p = new System.Drawing.Point();
    string s1 = "{X=";
    string s2 = ",Y=";
    string s3 = "}";
    int x1 = s.IndexOf(s1, StringComparison.OrdinalIgnoreCase);
    int x2 = s.IndexOf(s2, StringComparison.OrdinalIgnoreCase);
    int x3 = s.IndexOf(s3, StringComparison.OrdinalIgnoreCase);
    if (x1 < 0 || x1 >= x2 || x2 >= x3) { return false; }
    s1 = s.Substring(x1 + s1.Length, x2 - x1 - s1.Length);
    s2 = s.Substring(x2 + s2.Length, x3 - x2 - s2.Length); int i = 0;
    if (Int32.TryParse(s1, out i) == false) { return false; } p.X = i;
    if (Int32.TryParse(s2, out i) == false) { return false; } p.Y = i;
    return true;
} // public static bool TryParsePoint(string s, out System.Drawing.Point p) 
```

请注意，您可能还想删除或更改方法的`public`or`static`修饰符。但是我在 Program 类中使用了该方法，所以我的需要是`public static`. 适合自己。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-16T08:02:46.833

请参阅[PointConverter](https://msdn.microsoft.com/en-us/library/system.drawing.pointconverter(v=vs.110).aspx) ConvertFrom 方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-28T11:03:47.973

试试这个，它是我在我的项目中使用的。

```
string str = "-24,10";
Point pt = new Point(Int32.Parse(str.Split(',')[0]), Int32.Parse(str.Split(',')[1])); 
```

# prolog - 序言置换函数

> ID：10366638
> 
> 赞同：2
> 
> 时间：2012-04-28T19:05:54.923
> 
> 标签：prolog

我是 Prolog 的新手。我知道置换的递归函数，即：

```
per([],[]).
per(L, [X|P]) :- del(X,L,L1),per(L1,P). 
```

`per([],[])`当我们收到它返回的元素时，我想知道这个函数在最终迭代中的逻辑树。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T00:13:22.993

Sonia - 你没有给我们“del”谓词，所以我们不能运行它并显示给你。

您是否知道有一个“跟踪”谓词可以输出每一步/决策点/回溯？

做就是了：

```
trace.
per([a,b], X). 
```

然后按回车，直到看到 prolog 匹配递归的基（[]，[]），然后继续按回车，看它完成任务。

如果您想随时查看生成的缩写列表（即以点 [..] 结尾的列表，请按“w” - 写入以转储整个列表内容。

最后，做：

```
notrace. 
```

将其关闭。

然后，如果您对跟踪有特定问题，建议添加缺少的谓词，并围绕您的问题显示部分跟踪。

# android - 来回更改视图时保存状态

> ID：10366644
> 
> 赞同：1
> 
> 时间：2012-04-28T19:06:35.183
> 
> 标签：android, android-layout, android-intent, android-emulator

我正在编写一个应用程序，它本质上是一张可以翻转的卡片。双方都有某些相关数据，一边说是提示，另一边是图片。数据的双方都是相关的。我的问题是我可以通过单击下一步来浏览卡片但是当我翻转卡片进行图片时，由于重新加载了第一个活动，我又回到了开头。我该如何解决这个问题？我的代码是：包 org.v2.greTouch；

```
import java.io.IOException;
import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.ImageButton;
import android.widget.LinearLayout;
import android.widget.TextView;

public class FlipCard extends Activity  implements View.OnClickListener {
/** Called when the activity is first created. */
 Cursor cur;
TextView tv;
DbH db;
ImageButton next,back;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    tv=(TextView)findViewById(R.id.TV_Word);
    next=(ImageButton)findViewById(R.id.next);
    back=(ImageButton)findViewById(R.id.back);
    next.setOnClickListener(this);
    back.setOnClickListener(this);
    LinearLayout turn;
    turn=(LinearLayout)findViewById(R.id.LL_Card);
    turn.setOnClickListener(this);
    try {
        db=new DbH(this);
    } catch (IOException e2) {

        e2.printStackTrace();
    }

        try {
            db.createdatabase();
        } catch (IOException e) {

            e.printStackTrace();
        }

     db.opendatabase();
     cur=db.data();
     cur.moveToFirst();
     tv.setText(cur.getString(0));

 }
  @Override
  public void onClick(View v) {

switch(v.getId())
{
case R.id.next :
    if(cur.isLast())
    {
        cur.moveToFirst();
        tv.setText(""+cur.getString(0));
    }
    else
    {
        cur.moveToNext();
    tv.setText(""+cur.getString(0));

    }
break;
case R.id.back:
{
    if(cur.isFirst())
    {
        cur.moveToLast();
        tv.setText(""+cur.getString(0));
    }
    else {cur.moveToPrevious();
    tv.setText(""+cur.getString(0));
    }
    break;
}
case R.id.LL_Card:
{
    Intent i=new Intent(this,FlashCard_back.class);
    startActivity(i);
}
}
}
} 
```

加载的另一面是：

```
 import android.app.Activity;
   import android.content.Intent;
   import android.os.Bundle;
   import android.view.View;
   import android.view.View.OnClickListener;
   import android.widget.LinearLayout;
   import android.widget.TextView;
    public class FlashCard_back extends Activity implements OnClickListener{
   /** Called when the activity is first created. */
   @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main_back);
    LinearLayout layMain = (LinearLayout) findViewById(R.id.FlashCardRear);
    layMain.setOnClickListener(this);
     }
     public void onClick(View v) {
    Intent i=new Intent(this,FlipCard.class);
    startActivity(i);
     }
     } 
```

我希望当我退回时，我应该得到同一张卡片，其中包含从数据库中提取的值。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:20:08.133

对于视图，除了在翻转之前保存数据之外别无他法。您可以将数据保存在共享首选项或普通变量中。但这就是你要做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:24:00.803

您可以使用 ViewFlipper 翻转屏幕显示。为此，请在单个 xml 文件中执行以下操作，

```
<ViewFlipper>
    <LinearLayout>
          //front page's elements
    </LinearLayout>

    <LinearLayout>
         //back page's elements
    </LinearLayout>
</ViewFlipper> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:24:52.980

在您的第二个活动中，而不是调用：

```
public void onClick(View v) {
    Intent i=new Intent(this,FlipCard.class);
    startActivity(i);
} 
```

试试这个：

```
public void onClick(View v) {
    finish();
} 
```

# android - 是否可以以某种方式启动具有给定内容的活动？

> ID：10366645
> 
> 赞同：0
> 
> 时间：2012-04-28T19:06:40.960
> 
> 标签：android, android-activity

我必须使用应该启动相同活动但使用不同 XML 文件的按钮。我希望能够做的是这样的事情，来自“主要”：

button1: startActivity(new Intent(main.this, next.class, R.layout.xmlfile1)); button2: startActivity(new Intent(main.this, next.class, R.layout.xmlfile2));

我想我可以使用全局变量将 xml-name 保存在应用程序上下文中，但这不会很优雅。

任何人都知道是否有任何方法可以完成我正在寻找的东西？目前我正在创建重复的类文件，这并不是一个真正顺利的方法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:09:49.993

您可以通过在 Intent 上放置额外的数据来将数据传递给活动。请参阅 Intent 的方法`putExtra`和`getIntExtra`朋友。

您输入的整数是 xml 资源 ID。在你 cat`getIntExtra`在活动意图 ( `getIntent`) 上使用的活动上检索 id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:20:01.700

假设在活动 A 中有一个整数数组：

```
int array[] = {1,2,3}; 
```

我想将该变量发送到活动 B，因此我创建了一个新意图并使用 putExtra 方法：

```
Intent i = new Intent(A.this, B.class);
i.putExtra("numbers", array);
startActivity(i); 
```

在活动 B 我得到信息：

```
Bundle extras = getIntent().getExtras();
int[] arrayB = extras.getIntArray("numbers"); 
```

# javascript - 动态创建的 iframe 内容为空

> ID：10366646
> 
> 赞同：13
> 
> 时间：2012-04-28T19:06:47.180
> 
> 标签：javascript, jquery, html, iframe

在我的本地主机上，我使用以下 JavaScript 创建一个`iframe`with `src`，并将其添加到文档中：

```
$('#preview').html('<iframe src="http://google.com/"></iframe>'); 
```

iframe 显示但不显示内容。在萤火虫中，它只是：

```
<iframe src="http://google.com/">
    <html>
        <head></head>
        <body></body>
    </html>
</iframe> 
```

当我`$('iframe').attr('src','http://google.com/');`在控制台上执行时，浏览器加载（说“等待 google.com ...”），然后似乎刷新 iframe 的内容。但同样，它是空的。

但是，如果我将其设置为本地页面，则会加载内容。

这是因为同源政策吗？我对此不太了解。我做了一些谷歌搜索，我很困惑，因为有些网站说可以在不属于您自己的域的 src 中包含 iframe，而有些人说这是不可能的。

顺便说一句，由于我仍在本地主机上进行测试，如果我将它上传到某处的服务器，这会起作用吗？（但 iframe 的 src 仍将在不同的域中）

帮助？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-28T19:11:06.650

如果您检查了浏览器的错误控制台，您会看到以下消息：

> 拒绝显示文档，因为 X-Frame-Options 禁止显示。

因此，这不是您的错误，而是 Google 的故意行为。

的两个选项`X-Frame-Options`是：

*   `deny`- 帧内没有渲染，并且
*   `sameorigin`- 如果原点不匹配，则不渲染

参考：

*   [`X-Frame-Options`响应头，在 MDN](https://developer.mozilla.org/en/The_X-FRAME-OPTIONS_response_header)。
*   [`X-Frame-Options`在维基百科](http://en.wikipedia.org/wiki/X-Frame-Options#Frame-Options)。
*   [克服“X-Frame-Options 禁止显示”](https://stackoverflow.com/questions/6666423/overcoming-display-forbidden-by-x-frame-options)（在 Stack Overflow 上）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T19:54:23.820

是的，由于同源政策，该代码被禁止。[在这里](http://en.wikipedia.org/wiki/Same_origin_policy)阅读

假设您拥有该域`http://www.example.com`，那么当您通过 iframe 调用页面时，您可能会得到以下结果：

```
Compared URL                               Outcome  Reason
---------------------------------------------------------------------------------------------
http://www.example.com/dir/page.html       Success  Same protocol and host
http://www.example.com/dir2/other.html     Success  Same protocol and host
http://www.example.com:81/dir2/other.html  Failure  Same protocol and host but different port
https://www.example.com/dir2/other.html    Failure  Different protocol
http://en.example.com/dir2/other.html      Failure  Different host
http://example.com/dir2/other.html         Failure  Different host (exact match required)
http://v2.www.example.com/dir2/other.html  Failure  Different host (exact match required) 
```

现在，您正在调用 google.com，这是一个跨域问题。为了解决这样的问题，[JSONP](http://en.wikipedia.org/wiki/JSONP)可以帮助您。它使用开放脚本策略`<script>`，从跨域检索 JSON。

# objective-c - 使 NSViews 和 NSWindows 有固定的位置

> ID：10366651
> 
> 赞同：0
> 
> 时间：2012-04-28T19:07:21.023
> 
> 标签：objective-c, xcode, cocoa, nsview

我试图让我以编程方式创建的 NSView 和窗口具有固定位置，无论我的屏幕分辨率是多少，也无论我连接到主桌面的显示器有多少。例如，如果我有一个外接显示器，或者如果我决定更改我的屏幕分辨率，我希望我的 NSView 或 NSWindow 的 NsRect 始终出现在同一个地方。这行得通吗？

```
NSRect mainFrame = [[NSScreen mainScreen] frame]
NSRect helpFrame = NSZeroRect;
helpFrame.origin.x = (mainFrame.size.width - width) / 2.0; 
```

无论分辨率是多少，这会使我的窗口的 x 值始终位于中心吗？我觉得当我连接外接显示器时，分辨率会发生变化，屏幕中间不再是我想要的位置。`NSScreen mainScreen`打电话合适吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:33:39.007

首先，你问的是模棱两可的。“同一个地方”是什么意思？

你不显示是什么`width`。假设它是窗口的宽度，您显示的将计算一个 X 位置，该位置在“主”屏幕上水平居中窗口。但是，`-mainScreen`可能不会按照你的想法去做。如果您想要主显示器，即带有菜单栏的显示器，您需要`[[NSScreen screens] objectAtIndex:0]`.

但是，即使您使用显示的计算设置窗口的框架，如果屏幕配置发生更改，它也不会*使其保持居中。*您需要`NSApplicationDidChangeScreenParametersNotification`从应用程序对象中观察并重新定位它。

顺便问一下，你不使用有什么原因`-[NSWindow center]`吗？

# java - Java：将信息从一个数组添加到另一个数组

> ID：10366652
> 
> 赞同：0
> 
> 时间：2012-04-28T19:07:25.937
> 
> 标签：java, arrays, loops

我刚开始学习 Java，目标是为 Android 制作游戏。我正在参加在线课程，在那里我获得了一项任务，然后是某种评估。

这是我到目前为止所做的：

```
public String[] pie;
public Scanner x;
public String[] name;
public String[] name1;
public String[] name2;
public int[] year;
public int[] numb;
public String[] language;
public boolean[] read;
public int[] rating;

   public void openfile(){
    try{x = new Scanner(new File("Raamatukogu.txt"));}
    catch(Exception e){
        System.out.println("no file was found");}}

public void readfil(){
    while(x.hasNext()){
        String rida = x.nextLine();
        pie = rida.split("#");
        for(int i = 0; i < pie.length ; i++){ 
```

我想做的是在我的代码中添加这样的东西，但是自动化：

```
name[0] = pie[0]
name1[0] = pie[1]
name2[0] = pie[2]
year[0] = pie[3]
numb[0] = pie[4]
language[0] = pie[5]
read[0] = pie[6]
rating[0] = pie[7]

name[1] = pie[8]
name1[1] = pie[9]
name2[1] = pie[10]
year[1] = pie[11]
numb[1] = pie[12]
language[1] = pie[13]
read[1] = pie[14]
rating[1] = pie[15]

name[2] = pie[16]
name1[2] = pie[17]
...} 
```

先感谢您！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T19:12:41.683

尝试这个

```
int j=0;
for(int i=0;i<pie.length;i++){
    name[j] = pie[0];
    name1[j] = pie[1];
    name2[j] = pie[2];
    year[j] = pie[3];
    numb[j] = pie[4];
    language[j] = pie[5];
    read[j] = pie[6];
    rating[j] = pie[7];
    j++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T23:45:40.217

这是同一枚硬币的两个面。两者都假设`pie.length`是 8 的倍数，因为您的代码似乎也假设了这一点。

```
for (int i=0; i<pie.length/8; i++) {
    int index = i * 8;
    name[i] = pie[index];
    name1[i] = pie[index+1];
    name2[i] = pie[index+2];
    year[i] = pie[index+3];
    numb[i] = pie[index+4];
    language[i] = pie[index+5];
    read[i] = pie[index+6];
    rating[i] = pie[index+7];
} 
```

或者

```
for (int i=0; i<pie.length; i=i+8) {
    int index = i/8;
    name[index] = pie[i];
    name1[index] = pie[i+1];
    name2[index] = pie[i+2];
    year[index] = pie[i+3];
    numb[index] = pie[i+4];
    language[index] = pie[i+5];
    read[index] = pie[i+6];
    rating[index] = pie[i+7];
} 
```

# java - 如何从 URL 中删除我的应用程序名称？

> ID：10366653
> 
> 赞同：1
> 
> 时间：2012-04-28T19:07:28.807
> 
> 标签：java, glassfish

当我进入 Glassfish 管理面板时，我转到 Applications 并看到我的应用程序已列出（名为`cmt`）。当我单击启动时，它会打开一个带有一些 URL 的选项卡。这些 URL 存在一些问题，我正在努力寻找有关如何修复的答案。

1.  我只想要HTTPS，而不是http。这个控制器是在服务器还是应用程序级别？
2.  这些 URL`/cmt`位于域名的末尾。我真的需要用户在基本 url 上访问我的应用程序，而最后没有 a `/cmt`。我该如何控制这个？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:45:14.587

至于您的第一个问题，如果您想*要求*SSL 连接到您的 Web 应用程序，那么您将不得不做一些额外的服务器配置。我将向您推荐[本](http://javadude.wordpress.com/2010/04/06/getting-started-with-glassfish-v3-and-ssl/)教程。

对于您的第二个问题，更改您的 web.xml 并将其上下文根设置为`/`：

```
<context-root>/</context-root> 
```

# ruby-on-rails - 如何为heroku上的rails应用程序设置postgresql？

> ID：10366656
> 
> 赞同：2
> 
> 时间：2012-04-28T19:07:52.783
> 
> 标签：ruby-on-rails, postgresql, heroku

我一直很高兴地在本地开发我的应用程序并使用 sqlite3 作为数据库，只是了解到 sqlite3 不能在 heroku 上使用。所以我决定在开发和生产环境中都使用 postgresql。有人告诉我，在所有环境中使用相同的数据库会使生活更轻松。

我安装了postgresql：

```
apt-get install postgresql 
```

**我的gemfile**的相关部分如下所示：

```
group :development, :test do
 gem 'pg', '0.13.2'
end  

group :production do
 gem 'pg', '0.13.2'
end 
```

然后我运行捆绑安装。

在 database.yml 中，所有 3 个环境看起来都一样：

```
development:
adapter: postgresql
encoding: unicode
database: mydb
pool: 5
username: postgres
password: a
host: localhost 
```

我做了一些修改，让我的应用程序在本地使用 postgres 数据库。完美运行。我把它推到了heroku。当我尝试在 heroku 上访问我的应用程序时，我看到了这个：

```
Application Error
An error occurred in the application and your page could not be served. Please try again in a few moments.
If you are the application owner, check your logs for details. 
```

我知道这个问题与日志文件有关。

这是**heroku日志**所说的：

```
2012-04-28T18:54:22+00:00 heroku[web.1]: State changed from crashed to created
2012-04-28T18:54:22+00:00 heroku[web.1]: State changed from created to starting
2012-04-28T18:54:29+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 21268`
2012-04-28T18:54:35+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-04-28T18:54:35+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-04-28T18:54:41+00:00 app[web.1]: => Booting WEBrick
2012-04-28T18:54:41+00:00 app[web.1]: => Rails 3.2.3 application starting in production on http://0.0.0.0:21268
2012-04-28T18:54:41+00:00 app[web.1]: => Call with -d to detach
2012-04-28T18:54:41+00:00 app[web.1]: => Ctrl-C to shutdown server
2012-04-28T18:54:41+00:00 app[web.1]: Exiting
2012-04-28T18:54:41+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.3/lib/rails/rack/log_tailer.rb:8:in `size': No such file or directory - log/production.log (Errno::ENOENT)
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.3/lib/rails/rack/log_tailer.rb:8:in `initialize'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:295:in `new'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:291:in `reverse_each'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:295:in `block in build_app'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:291:in `build_app'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.3/lib/rails/commands/server.rb:70:in `start'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.3/lib/rails/commands.rb:55:in `block in <top (required)>'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.3/lib/rails/commands.rb:50:in `tap'
2012-04-28T18:54:41+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.3/lib/rails/commands.rb:50:in `<top (required)>'
2012-04-28T18:54:41+00:00 app[web.1]:   from script/rails:6:in `require'
2012-04-28T18:54:41+00:00 app[web.1]:   from script/rails:6:in `<main>'
2012-04-28T18:54:42+00:00 heroku[web.1]: Process exited with status 1
2012-04-28T18:54:42+00:00 heroku[web.1]: State changed from starting to crashed
2012-04-28T18:54:45+00:00 heroku[router]: Error H10 (App crashed) -> GET fierce-winter.herokuapp.com/ dyno= queue= wait= service= status=503 bytes= 
```

关于 SO 的一个类似问题说我只需要重新运行 bundle install 并在我的提交中包含 gemfile 和 gemfile.lock 。甚至在找到那个问题之前就已经完成了。来源：[rails-3-2-from-sqlite-locally-to-postgres-on-heroku](https://stackoverflow.com/questions/10179128/rails-3-2-from-sqlite-locally-to-postgres-on-heroku)

**编辑：**错误日志说我没有 log/production.log 文件。这不可能是问题，不是吗？

**编辑 2：** production.rb：

```
 SampleApp::Application.configure do
  # Settings specified here will take precedence over those in config/application.rb

  config.logger = Logger.new(STDOUT)    ##
  config.log_level = :info      ##

  # Code is not reloaded between requests
  config.cache_classes = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local       = false
  config.action_controller.perform_caching = true

  # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = false

  # Compress JavaScripts and CSS
  config.assets.compress = true

  # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = false

  # Generate digests for assets URLs
  config.assets.digest = true

  # Defaults to Rails.root.join("public/assets")
  # config.assets.manifest = YOUR_PATH

  # Specifies the header that your server uses for sending files
  # config.action_dispatch.x_sendfile_header = "X-Sendfile" # for apache
  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx

  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.
  config.force_ssl = true

  # See everything in the log (default is :info)
  # config.log_level = :debug

  # Prepend all log lines with the following tags
  # config.log_tags = [ :subdomain, :uuid ]

  # Use a different logger for distributed setups
  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)

  # Use a different cache store in production
  # config.cache_store = :mem_cache_store

  # Enable serving of images, stylesheets, and JavaScripts from an asset server
  # config.action_controller.asset_host = "http://assets.example.com"

  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)
  # config.assets.precompile += %w( search.js )

  # Disable delivery errors, bad email addresses will be ignored
  # config.action_mailer.raise_delivery_errors = false

  # Enable threaded mode
  # config.threadsafe!

  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to
  # the I18n.default_locale when a translation can not be found)
  config.i18n.fallbacks = true

  # Send deprecation notices to registered listeners
  config.active_support.deprecation = :notify

  # Log the query plan for queries taking more than this (works
  # with SQLite, MySQL, and PostgreSQL)
  # config.active_record.auto_explain_threshold_in_seconds = 0.5
end 
```

**编辑3：将应用程序推送到heroku时看到的日志**

```
root@user-VirtualBox:/home/user/RoR/rtapr22# git push heroku
Enter passphrase for key '/root/.ssh/id_rsa': 
Counting objects: 52, done.
Compressing objects: 100% (41/41), done.
Writing objects: 100% (41/41), 8.21 KiB, done.
Total 41 (delta 13), reused 0 (delta 0)

-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.1.2
       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment
       Fetching gem metadata from https://rubygems.org/.......
       Fetching gem metadata from https://rubygems.org/..
       Using rake (0.9.2.2)
       Using i18n (0.6.0)
       Using multi_json (1.3.2)
       Using activesupport (3.2.3)
       Using builder (3.0.0)
       Using activemodel (3.2.3)
       Using erubis (2.7.0)
       Using journey (1.0.3)
       Using rack (1.4.1)
       Using rack-cache (1.2)
       Using rack-test (0.6.1)
       Using hike (1.2.1)
       Using tilt (1.3.3)
       Using sprockets (2.1.2)
       Using actionpack (3.2.3)
       Using mime-types (1.18)
       Using polyglot (0.3.3)
       Using treetop (1.4.10)
       Using mail (2.4.4)
       Using actionmailer (3.2.3)
       Using arel (3.0.2)
       Using tzinfo (0.3.33)
       Using activerecord (3.2.3)
       Using activeresource (3.2.3)
       Using addressable (2.2.7)
       Using bcrypt-ruby (3.0.1)
       Using bootstrap-sass (2.0.0)
       Using will_paginate (3.0.3)
       Using bootstrap-will_paginate (0.0.5)
       Using coffee-script-source (1.3.1)
       Using execjs (1.3.0)
       Using coffee-script (2.2.0)
       Using rack-ssl (1.3.2)
       Using json (1.6.6)
       Using rdoc (3.12)
       Using thor (0.14.6)
       Using railties (3.2.3)
       Using coffee-rails (3.2.2)
       Using curb (0.8.0)
       Using orm_adapter (0.0.7)
       Using warden (1.1.1)
       Using devise (2.0.4)
       Using faker (1.0.1)
       Using nokogiri (1.5.2)
       Using loofah (1.2.1)
       Using sax-machine (0.1.0)
       Using feedzirra (0.0.24)
       Using launchy (2.1.0)
       Using netrc (0.7.1)
       Using rest-client (1.6.7)
       Using rubyzip (0.9.7)
       Using heroku (2.24.1)
       Using jquery-rails (2.0.0)
       Using libv8 (3.3.10.4)
       Using pg (0.13.2)
       Using bundler (1.1.2)
       Using rails (3.2.3)
       Installing rails_log_stdout (0.1.1)
       Using rb-readline (0.4.2)
       Using sass (3.1.15)
       Using sass-rails (3.2.4)
       Using therubyracer (0.10.1)
       Using uglifier (1.2.3)
       Your bundle is complete! It was installed into ./vendor/bundle
       Cleaning up the bundler cache.
-----> Writing config/database.yml to read from DATABASE_URL
-----> Preparing app for Rails asset pipeline
       Running: rake assets:precompile
       Compiled jquery.js  (2ms)  (pid 677)
       Compiled jquery_ujs.js  (0ms)  (pid 677)
       Compiled bootstrap-transition.js  (0ms)  (pid 677)
       Compiled bootstrap-alert.js  (0ms)  (pid 677)
       Compiled bootstrap-button.js  (0ms)  (pid 677)
       Compiled bootstrap-carousel.js  (0ms)  (pid 677)
       Compiled bootstrap-collapse.js  (0ms)  (pid 677)
       Compiled bootstrap-dropdown.js  (0ms)  (pid 677)
       Compiled bootstrap-modal.js  (0ms)  (pid 677)
       Compiled bootstrap-scrollspy.js  (0ms)  (pid 677)
       Compiled bootstrap-tab.js  (0ms)  (pid 677)
       Compiled bootstrap-tooltip.js  (28ms)  (pid 677)
       Compiled bootstrap-popover.js  (0ms)  (pid 677)
       Compiled bootstrap-typeahead.js  (0ms)  (pid 677)
       Compiled bootstrap.js  (97ms)  (pid 677)
       Compiled sessions.js  (84ms)  (pid 677)
       Compiled static_pages.js  (0ms)  (pid 677)
       Compiled users.js  (0ms)  (pid 677)
       Compiled application.js  (240ms)  (pid 677)
       Compiled Untitled Folder/custom.css  (1321ms)  (pid 677)
       Compiled Untitled Folder/sessions.css  (1ms)  (pid 677)
       Compiled Untitled Folder/static_pages.css  (0ms)  (pid 677)
       Compiled Untitled Folder/users.css  (0ms)  (pid 677)
       Compiled Untitled Folder/application.css  (1377ms)  (pid 677)
       Compiled custom.css  (512ms)  (pid 677)
       Compiled sessions.css  (1ms)  (pid 677)
       Compiled static_pages.css  (1ms)  (pid 677)
       Compiled users.css  (0ms)  (pid 677)
       Compiled application.css  (533ms)  (pid 677)
       Compiled jquery.js  (1ms)  (pid 677)
       Compiled jquery_ujs.js  (0ms)  (pid 677)
       Compiled bootstrap-transition.js  (0ms)  (pid 677)
       Compiled bootstrap-alert.js  (0ms)  (pid 677)
       Compiled bootstrap-button.js  (0ms)  (pid 677)
       Compiled bootstrap-carousel.js  (0ms)  (pid 677)
       Compiled bootstrap-collapse.js  (0ms)  (pid 677)
       Compiled bootstrap-dropdown.js  (0ms)  (pid 677)
       Compiled bootstrap-modal.js  (0ms)  (pid 677)
       Compiled bootstrap-scrollspy.js  (0ms)  (pid 677)
       Compiled bootstrap-tab.js  (0ms)  (pid 677)
       Compiled bootstrap-tooltip.js  (0ms)  (pid 677)
       Compiled bootstrap-popover.js  (0ms)  (pid 677)
       Compiled bootstrap-typeahead.js  (0ms)  (pid 677)
       Compiled bootstrap.js  (79ms)  (pid 677)
       Compiled sessions.js  (81ms)  (pid 677)
       Compiled static_pages.js  (0ms)  (pid 677)
       Compiled users.js  (0ms)  (pid 677)
       Compiled application.js  (217ms)  (pid 677)
       Compiled Untitled Folder/custom.css  (1291ms)  (pid 677)
       Compiled Untitled Folder/sessions.css  (1ms)  (pid 677)
       Compiled Untitled Folder/static_pages.css  (0ms)  (pid 677)
       Compiled Untitled Folder/users.css  (1ms)  (pid 677)
       Compiled Untitled Folder/application.css  (1311ms)  (pid 677)
       Compiled custom.css  (545ms)  (pid 677)
       Compiled sessions.css  (1ms)  (pid 677)
       Compiled static_pages.css  (0ms)  (pid 677)
       Compiled users.css  (0ms)  (pid 677)
       Compiled application.css  (566ms)  (pid 677)
-----> Rails plugin injection
       Injecting rails_log_stdout
       Injecting rails3_serve_static_assets
-----> Discovering process types
       Procfile declares types      -> (none)
       Default types for Ruby/Rails -> console, rake, web, worker
-----> Compiled slug size is 26.1MB
-----> Launching... done, v18
       http://fierce-winter.herokuapp.com deployed to Heroku

To git@heroku.com:fierce-winter.git
   24d1b1f..78c2b86  master -> master 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T22:35:57.937

这确实是一个日志记录问题，但报告的错误消息具有误导性。默认情况下，Rails 将日志写入文件，而不是流。但是，这不适用于 Heroku。部署到 Heroku 时，[rails_log_stdout](http://github.com/ddollar/rails_log_stdout)会自动安装，在大多数情况下修复了该问题。但是，在您的情况下，某些东西正试图将日志作为文件写入。

可能是[rails_log_stdout](http://github.com/ddollar/rails_log_stdout)没有安装成功；做

```
Injecting rails_log_stdout 
```

部署时出现？

此外，某处可能存在额外的日志记录语句；grep`Logger`或`Logger.new`检查这个（也许检查不区分大小写）。我刚刚 grepped 了一个新的 Rails 项目，在未注释的代码中没有出现“记录器”。

[Heroku Logging](http://devcenter.heroku.com/articles/logging)页面也可能有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T16:31:14.263

我通过使用 Procfile 解决了这个问题：

```
web: bundle exec rails server thin -p $PORT -e $RAILS_ENV 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T00:51:19.903

它应该很简单：

宝石文件

```
group :development, :test do
  gem 'sqlite3'
end

group :production do
  gem 'pg'
end 
```

Heroku 为您生成 database.yml 文件。在 sqlite3 的本地开发中，你会没事的。在 heroku 上，它将在 postgreSQL 中运行生产。您不必将 postgreSQL 作为您的开发环境，尽管我同意它会更好。但也许你让自己变得比必要的更难。

# java - 如何将 java swing 面板转换为高质量图像

> ID：10366660
> 
> 赞同：1
> 
> 时间：2012-04-28T19:08:18.853
> 
> 标签：java, swing, pdf, export, bufferedimage

我的面板看起来像：

![在此处输入图像描述](../Images/c3808c92005c11d6c7be300af494f526.png)

当我转换为图像

```
public BufferedImage createImage(JPanel panel) {

int w = (int) PageSize.A4.getWidth();//panel.getWidth();
int h = (int) PageSize.A4.getHeight();//panel.getHeight();

BufferedImage originalImage = new BufferedImage(panel.getHeight(), panel.getWidth(), BufferedImage.TYPE_BYTE_INDEXED);
Graphics2D gg = originalImage.createGraphics();
gg.setRenderingHint(RenderingHints.KEY_INTERPOLATION,
        RenderingHints.VALUE_INTERPOLATION_BILINEAR);
gg.setRenderingHint(RenderingHints.KEY_RENDERING,
        RenderingHints.VALUE_RENDER_QUALITY);
gg.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
        RenderingHints.VALUE_ANTIALIAS_ON);
panel.paint(gg);

BufferedImage resizedImage = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
Graphics2D g = resizedImage.createGraphics();
g.drawImage(originalImage, 0, 0, w, h, null);
g.dispose();
g.setComposite(AlphaComposite.Src);

g.setRenderingHint(RenderingHints.KEY_INTERPOLATION,
        RenderingHints.VALUE_INTERPOLATION_BILINEAR);
g.setRenderingHint(RenderingHints.KEY_RENDERING,
        RenderingHints.VALUE_RENDER_QUALITY);
g.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
        RenderingHints.VALUE_ANTIALIAS_ON);

return resizedImage;
} 
```

它看起来很糟糕 - 更大更差的质量

![在此处输入图像描述](../Images/fed91581e1887a63c5cc727844e691ff.png)

我如何将这个图像的质量更改为面板的质量？

编辑：

您需要编译此代码的库：

```
import com.itextpdf.text.PageSize;
import java.awt.AlphaComposite;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import java.awt.image.BufferedImage;
import javax.swing.JPanel; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:27:45.057

您可以使用 Graphics2D 转换，以便面板的绘画立即转到缩放图像

```
BufferedImage resizedImage = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
Graphics2D g = resizedImage.createGraphics();
g.transform(AffineTransform.getScaleInstance((float)panel.getWidth()/w,
          (float)panel.getHeight()/h));//this might need to be inverted I'm not sure...
panel.paint(g);
g.dispose(); 
```

顺便说一句，setRenderingHint 在您处理完 Graphics 后不会做任何有用的事情

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T20:21:43.547

从字面上回答你的问题：

*如何将此图像的质量更改为面板的质量？*

很简单，不要改变图像的大小。放弃整个“将图像拉伸到 A4 尺寸”，因为这是质量损失的原因。

```
public BufferedImage createImage(JPanel panel) {
  BufferedImage originalImage = new BufferedImage(
        panel.getHeight(), panel.getWidth(), 
        BufferedImage.TYPE_BYTE_INDEXED);
  Graphics2D gg = originalImage.createGraphics();
  gg.setRenderingHint(RenderingHints.KEY_INTERPOLATION,
        RenderingHints.VALUE_INTERPOLATION_BILINEAR);
  gg.setRenderingHint(RenderingHints.KEY_RENDERING,
        RenderingHints.VALUE_RENDER_QUALITY);
  gg.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
        RenderingHints.VALUE_ANTIALIAS_ON);
  panel.paint(gg);
  gg.dispose();
  return originalImage;
} 
```

但是不确定这是否是您一直在寻找的。如果您真的希望图像为 A4 尺寸，我建议您在将其转换为图像之前尝试让您的面板在 A4 尺寸上清晰呈现。将小图像拉伸到较大版本总是会导致质量损失。

# objective-c - SoundcloudAPI Wrapper iOS5 身份验证错误

> ID：10366661
> 
> 赞同：2
> 
> 时间：2012-04-28T19:08:19.957
> 
> 标签：objective-c, ios5, soundcloud, audio

我正在尝试制作一个应用程序原型，该应用程序利用 Soundcloud 的 API 端点，并为可可和可可触摸项目集成了 cocoa-api-wrapper。

我遇到的问题围绕着让我的应用程序进行身份验证。我向用户显示登录视图，并在他们输入凭据后，尝试使用我的应用程序委托中的方法实现来处理重定向 URL。

当我在调试期间跟踪整个 MyApp->Soundcloud API -> Oauth2Library 中的一系列调用时，我可以看到 soundcloud 接受了凭据，并传回了我应该用来请求会话身份验证令牌的授权码。

但是，当调用“handleOpenURL”（在我的 AppDelegate 中）时，它无法处理重定向并在我尝试收集用户数据（例如发送调用`[scAPI meWithContext:@"userInfo"]`）时返回 401 错误。

我已经彻底搜索了这些论坛，但似乎无法找到我的问题的答案。然而，我确实偶然[发现了一些](http://groups.google.com/group/soundcloudapi/browse_thread/thread/6e418460d098cb20/ad12882b13e49dbe?lnk=gst&q=ios%205#ad12882b13e49dbe)我认为可能是关于 Soundcloud API 支持的谷歌群组论坛上的案例的一部分。

另一个 API 用户遇到 401 响应代码（未经授权），并描述了 oauth2 库在 iOS 4 和 iOS 5 之间的 SoundCloud 重定向响应中管理授权标头字段的方式不同，我认为这可能是问题。

401 响应代码有一个本地化描述`NXOAuth2HTTPErrorDomain`，并且还将消息写入`[NXOAuth2PostBodyStream open] Stream has been reopened after close`NSLog。

如果需要，我可以提供更多信息。我还使用 charles 来调试对 Soundcloud 的 HTTPS 调用，并且确定请求被发送到正确的目的地。

任何帮助/反馈将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T10:39:02.423

正如 Tobias 所提到的，cocoa-api-wrapper 不再受支持。我遇到了同样的问题，因为我也需要流式传输功能，[所以我分叉了 CocoaSoundCloudAPI 以添加来自 cocoa-api-wrapper 的流式传输支持](https://github.com/iliaskarim/CocoaSoundCloudAPI)。

# c - 遍历 char 数组，打印每个 char 的位（在 C 中）

> ID：10366662
> 
> 赞同：2
> 
> 时间：2012-04-28T19:08:34.703
> 
> 标签：c, char, bit-shift

试图打印出存储在数组中的每个字符的位。我查找了一些代码并尝试了一个适合我需要的版本。问题是我似乎只得到了数组中的第一个字符。

```
//read_buffer is the array I want to iterate through, bytes_to_read is the number of 
//index positions I want to_read. (array is statically allocated and filled using read()
//funct, therefore there are some garbage bits after the char's I want), bytes_to_read
//is what's returned from read() and how many bytes were actually read into array
void PrintBits(char read_buffer[], int bytes_to_read)
{

        int bit = 0;
        int i = 0;
        char char_to_print;

        printf("bytes to read: %d\n", bytes_to_read); //DEBUG

        for (; i < bytes_to_read; i++)
        {
                char_to_print = read_buffer[i];

                for (; bit < 8; bit++)
                {
                        printf("%i", char_to_print & 0X01);
                        char_to_print >> 1;
                }
                printf(" ");
                printf("bytes_to_read: %d -- i: %d", bytes_to_read, i);
        }

        printf("\n");
} 
```

基本上我得到的是：`00000000` 不知道为什么会这样。通过调试，我发现它只是打印第一位，没有别的。我还证明了外部循环实际上是遍历 int 的 0 - 29 ......所以它应该遍历数组中的 char。我难住了。

另外，有人可以告诉我声明中`& 0x01`正在做什么`printf`。我在别人的代码中发现了这一点，我不确定。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T19:11:54.477

你错过了

```
 char_to_print >>= 1; 
```

char_to_print 未移动并保存

而且您应该每次都使用新的 char_to_print 初始化位

```
 for (bit = 0; bit < 8; bit++) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T19:17:32.297

> “有人能告诉我 printf 语句中的“& 0x01”在做什么吗？

这就是你如何得到每个数字。数字向下移动 1，并与 1 进行按位与运算。1 仅设置了一个位，即 *L*east *S* 重要的一个，因此与它进行与运算将产生 1（如果`char_to_print`还设置了 LSB）或零，如果没有。

因此，例如，如果`char_to_print`最初是 4，则第一次与 1 进行与运算会产生零，因为未设置 LSB。然后它向下移动一个并与，另一个零。第三次，设置了 LSB，所以你得到 1。二进制 100 是十进制 4。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:14:26.683

有两个问题：

1.  `char_to_print >> 1;`正在做位移，但丢弃了结果。尝试`char_to_print = char_to_print >> 1;`

2.  您不能将 a 传递`char`给`printf`期望整数。你应该`(int)(char_to_print & 0x01)`。

# c# - BlankPage.Page1 由于其保护级别而无法访问

> ID：10366663
> 
> 赞同：0
> 
> 时间：2012-04-28T19:08:36.493
> 
> 标签：c#, xaml, user-interface, windows-runtime, winrt-xaml

我正在尝试从另一个 xaml 页面更改位于 BlankPage.xaml 中的网格的不透明度。这是我尝试使用的代码：

```
 BlankPage.Page1.Opacity = 20; 
```

BlankPage 是我的 xaml 页面。| Page1 是我的 Grid 控件的名称。

如何改变它？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T21:48:50.213

您可以尝试在 x:Name="Page1" 旁边设置 x:FieldModifier="public"。我相信默认是私有的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T18:08:29.387

我之前遇到过类似的问题。

我试图将数据传递给用户控件，我最终将它作为页面中的参数传递并在 InitializeComponent 之后触发它

# asp.net - Appharbor上的Dotless

> ID：10366664
> 
> 赞同：4
> 
> 时间：2012-04-28T19:08:50.957
> 
> 标签：asp.net, asp.net-mvc-3, appharbor, dotless

我对 AppHarbor 上的 DotLess 有很大的问题。我已经根据 dotless 正确设置了我的 web.config，但我的 .less 文件总是给出 404 错误。

我已经确保这些文件是作为内容构建的，有一个 mime 类型，并且所有设置都是根据 dotless 的。但它仍然无法正常工作......还有其他人有同样的问题吗？有没有其他人能够解决它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T01:55:53.280

我必须将**Build Action**值设置为**Content**，然后将**Copy To Output DIrectory**值设置为**Copy always**。这样做之后，它似乎可以正常工作！哇哦！这太令人兴奋了。这几天一直是个大问题。

# python - 获取numpy数组中元素对的总和

> ID：10366665
> 
> 赞同：7
> 
> 时间：2012-04-28T19:08:51.593
> 
> 标签：python, numpy, scipy

我有一个数组：

```
t = [4, 5, 0, 7, 1, 6, 8, 3, 2, 9] 
```

这只是范围 [0, 9] 的随机洗牌。我需要计算这个：

```
t2 = [9, 5, 7, 8, 7, 14, 11, 5, 11, 13] 
```

这只是：

```
t2 = [t[0]+t[1], t[1]+t[2], t[2]+t[3], t[3]+t[4], ..., t[9]+t[0]] 
```

有没有办法在处理大型数组时使用 numpy 来避免 python for 循环？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-28T19:19:59.257

您可以利用 NumPy 数组对元素求和的能力：

```
In [5]: import numpy as np

In [6]: t = np.array([4, 5, 0, 7, 1, 6, 8, 3, 2, 9])

In [7]: t + np.r_[t[1:],t[0]]
Out[7]: array([ 9,  5,  7,  8,  7, 14, 11,  5, 11, 13]) 
```

[np.r_](http://docs.scipy.org/doc/numpy/reference/generated/numpy.r_.html)是将序列连接在一起以形成新的 numpy 数组的一种方法。正如我们将在下面看到的，*在这种情况下*，这并不是最好的方法。

* * *

另一种可能是：

```
In [10]: t + np.roll(t,-1)
Out[10]: array([ 9,  5,  7,  8,  7, 14, 11,  5, 11, 13]) 
```

看起来使用[`np.roll`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.roll.html)速度明显更快：

```
In [11]: timeit t + np.roll(t,-1)
100000 loops, best of 3: 17.2 us per loop

In [12]: timeit t + np.r_[t[1:],t[0]]
10000 loops, best of 3: 35.5 us per loop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:12:42.187

[`zip()`](http://docs.python.org/library/functions.html#zip)您可以使用、列表切片和列表推导[非常](https://www.youtube.com/watch?v=t85uBptTDYY)愉快地做到这一点：

```
t2 = [a+b for (a, b) in zip(t, t[1:])]
t2.append(t[0]+t[-1]) 
```

我们需要`append()`在最后一个元素中添加额外的元素，因为`zip()`它只在最短的迭代器结束之前有效。列表推导比普通`for`循环快得多，因为它是在 Python 中实现的 C 端，而不是作为 Python 循环。

另一种方法是使用[`itertools.zip_longest`](http://docs.python.org/release/3.0.1/library/itertools.html#itertools.zip_longest)：

```
from itertools import zip_longest
t2 = [a+b for (a, b) in zip_longest(t, t[1:], fillvalue=t[0])] 
```

填写额外的值。请注意，此函数[`itertools.izip_longest`](http://docs.python.org/library/itertools.html#itertools.izip_longest)在 Python 2.x 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T22:48:10.987

关于什么

```
import numpy as np
t = np.array([4, 5, 0, 7, 1, 6, 8, 3, 2, 9])

new_t = t + np.hstack((t[1:], [t[0]])) 
```

结果：

```
>>> new_t
array([ 9,  5,  7,  8,  7, 14, 11,  5, 11, 13]) 
```

# cocoa - 使用公共 API 在 NSWindow 中实现模糊背景？

> ID：10366669
> 
> 赞同：7
> 
> 时间：2012-04-28T19:09:18.043
> 
> 标签：cocoa, operating-system, blur

我正在编写一个 Mac 应用程序，并希望 NSWindow 具有**半透明、模糊**的背景（如菜单背景）。

这可以通过使用私有 Apple CGS* API（[示例](http://blog.steventroughtonsmith.com/2008/03/using-core-image-filters-onunder.html)）来实现，但我无法使用它们，因为它无法获得 Mac App Store 的批准。

有没有什么方法（或黑客）可以通过**公共**API 实现这种效果？

（制作屏幕截图和模糊它们是不可行的；用户可能正在后台播放视频剪辑......）

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T07:38:16.077

我一直在努力寻找，虽然我不能 100% 肯定地确认公共 API 没有办法做到这一点（很难证明是否定的），但我没有发现任何可能的迹象。我能找到的最“官方”的答案是一位苹果工程师[，他建议提出关于它的功能请求](http://www.cocoabuilder.com/archive/cocoa/216661-semi-transparent-blurred-nswindow-background.html)。

其他相关的邮件列表线程包括[this](http://www.cocoabuilder.com/archive/cocoa/230591-how-to-apply-coreimage-effects-to-windows.html)和[this](http://www.cocoabuilder.com/archive/cocoa/179525-an-idea-about-desktop-amusing.html#179525)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-26T17:56:17.300

终于，2年后，我们有了一个官方的答案！苹果`NSVisualEffectView`在OS X Yosemite中引入，用它可以达到效果:) 感谢苹果！

# c++ - 如何使用 gcc 编译 SIMD 代码

> ID：10366670
> 
> 赞同：8
> 
> 时间：2012-04-28T19:09:21.083
> 
> 标签：c++, gcc, g++, simd

我在 SIMD 中为矩阵乘法编写了这段代码，我可以在 Visual Studio 中编译，但现在我需要在 Ubuntu 中使用 gcc/g++ 编译它。

我应该使用哪些命令来编译它？我需要对代码本身进行任何更改吗？

```
#include <stdio.h>
#include <stdlib.h>
#include <xmmintrin.h>
#include <iostream>
#include <conio.h>
#include <math.h>
#include <ctime>

using namespace std;

#define MAX_NUM 1000
#define MAX_DIM 252

int main()
{
    int l = MAX_DIM, m = MAX_DIM, n = MAX_DIM;
    __declspec(align(16)) float a[MAX_DIM][MAX_DIM], b[MAX_DIM][MAX_DIM],c[MAX_DIM][MAX_DIM],d[MAX_DIM][MAX_DIM];

    srand((unsigned)time(0));

    for(int i = 0; i < l; ++i)
    {
        for(int j = 0; j < m; ++j)
        {
            a[i][j] = rand()%MAX_NUM;
        }
    }

    for(int i = 0; i < m; ++i)
    {
        for(int j = 0; j < n; ++j)
        {
            b[i][j] = rand()%MAX_NUM;
        }
    }

    clock_t Time1 = clock();

    for(int i = 0; i < m; ++i)
    {
        for(int j = 0; j < n; ++j)
        {
            d[i][j] = b[j][i];
        }
    }

    for(int i = 0; i < l; ++i)
    {
        for(int j = 0; j < n; ++j)
        {
            __m128 *m3 = (__m128*)a[i];
            __m128 *m4 = (__m128*)d[j];
            float* res;
            c[i][j] = 0;
            for(int k = 0; k < m; k += 4)
            {
                __m128 m5 = _mm_mul_ps(*m3,*m4);
                res = (float*)&m5;
                c[i][j] += res[0]+res[1]+res[2]+res[3];
                m3++;
                m4++;
            }
        }
        //cout<<endl;
    }

    clock_t Time2 = clock();
    double TotalTime = ((double)Time2 - (double)Time1)/CLOCKS_PER_SEC;
    cout<<"Time taken by SIMD implmentation is "<<TotalTime<<"s\n";

    Time1 = clock();

    for(int i = 0; i < l; ++i)
    {
        for(int j = 0; j < n; ++j)
        {
            c[i][j] = 0;
            for(int k = 0; k < m; k += 4)
            {
                c[i][j] += a[i][k] * b[k][j];
                c[i][j] += a[i][k+1] * b[k+1][j];
                c[i][j] += a[i][k+2] * b[k+2][j];
                c[i][j] += a[i][k+3] * b[k+3][j];

            }
        }
    }

    Time2 = clock();
    TotalTime = ((double)Time2 - (double)Time1)/CLOCKS_PER_SEC;
    cout<<"Time taken by normal implmentation is "<<TotalTime<<"s\n";

    getch();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-28T19:19:19.703

您需要启用 SSE，例如

```
$ g++ -msse3 -O3 -Wall -lrt foo.cpp -o foo 
```

您还需要更改：

```
declspec(align(16)) 
```

这是 Windows 特定的，更便携：

```
__attribute__ ((aligned(16))) 
```

# sql-server - 备份权限

> ID：10366676
> 
> 赞同：25
> 
> 时间：2012-04-28T19:09:55.463
> 
> 标签：sql-server, sql-server-2008, database-backups

我在将访问某些数据库的服务器上创建了一个新用户。

但是当我去备份或恢复数据库时，我得到了错误：

> C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\Backup
> 无法访问服务器上的指定路径或文件。验证您是否具有必要的安全权限并且该路径或文件是否存在.....................

该错误显示在我的系统中的任何其他路径。即使是用户和服务帐户具有完全控制权限的那些。

但是，如果我输入完整路径并单击确定，它会抱怨它无法显示，但它会备份或恢复数据库。只是不显示路径的树视图。

如果我使用该`sa`帐户进行操作，则对话框会显示所有路径而不会抱怨。

PS：已经将用户添加到`db_backoperator`角色中。

需要什么权限？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-28T19:58:50.120

**db_backupoperator**是数据库角色，而不是服务器角色或 Windows 权限。它仅授予用户对*数据库*进行备份所需的访问权限。它不授予对服务器文件结构的任何权限，而这些权限是实际制作备份文件所必需的。

IIRC，要访问文件结构以进行备份，用户必须已经具有访问它的 Windows/域权限，或者具有服务器角色**sysadmin**来获取 SQL Server 自己的 Windows 访问权限。

此外，要实际还原数据库，用户将需要服务器角色**dbcreator**。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-28T21:16:37.840

您是使用 SQL 身份验证登录名还是 Windows 登录名进行连接？如果 SQL 身份验证登录，您如何将该 SQL 登录“完全控制权限”授予 Windows 中的文件夹？Windows 不知道您在 SQL Server 中创建的任何 SQL 身份验证登录。请告诉我们您所说的“我在服务器上创建了一个用户”是什么意思 - 什么用户？什么服务器？SQL Server 还是 Windows？

作为一种解决方法，您还可以创建一个作为 sysadmin 组的一部分执行的存储过程`sa`或一个 Windows 登录名，并让这个权限较低的用户能够执行。但是，我可以通过添加一个根本没有其他权限的 peon 用户并将它们添加到`db_backupoperator`角色来备份数据库：

```
CREATE LOGIN peon WITH PASSWORD = 'foo', CHECK_POLICY = OFF;
GO
CREATE DATABASE splunge;
GO
USE splunge;
GO
CREATE USER peon FROM LOGIN peon;
GO
EXEC sp_addrolemember 'db_backupoperator', 'peon';
GO
EXECUTE AS USER = 'peon';
GO
BACKUP DATABASE splunge
  TO DISK = 'C:\tmp\splung.bak' -- change this path obviously
  WITH INIT, COMPRESSION;
GO
REVERT;
GO 
```

因此，我将验证 SQL Server 服务帐户是否具有足够的权限来写入相关路径。我知道您说过是这种情况，但正如我所展示的，这似乎不是`peon`用户的问题，而是底层引擎写入文件系统的能力。`peon`如果您在不添加角色的情况下尝试上述备份命令`db_backupoperator`，则会收到此错误（它不会让您接近实际备份命令或验证磁盘上的任何权限）：

> ```
> Msg 262, Level 14, State 1, Line 1
> BACKUP DATABASE permission denied in database 'splunge'.
> Msg 3013, Level 16, State 1, Line 1
> BACKUP DATABASE is terminating abnormally. 
> ```

如果这是 Windows 登录，那么请验证用户是否确实拥有对相关文件夹的写入权限。尝试不同的文件夹，而不是下面的层次结构`C:\Program Files\...`，不要尝试直接写入根目录（例如`C:\file.bak`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:53:16.767

我的猜测是这是 Windows 身份验证和集成安全性的问题。SQL Server 有时会模拟用户登录。尝试为您登录的 Windows 用户添加 Windows ACL 权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-09T16:15:45.870

我正在运行 Windows 10 (x64)、SQL Server Express 2014，尝试将备份还原到 x86 SQL Server 2005 数据库，以便我可以使用数据并帮助解决我们应用程序中的错误。在备份和恢复 .bak 文件时，我遇到了具有权限的相同场景。

同样的事情，我是我的 PC 上的管理员，我假设（我的错误）SQL Server 服务正在我的 Windows 帐户下运行（因为我会使用我的 Windows 凭据登录到 SQL 管理）。

所以我所做的是进入Windows中的服务，找到SQL Server，右键单击属性，停止服务，然后转到登录选项卡并将“登录身份”更改为“本地系统帐户”并选中显示的框“允许服务与桌面交互”。开始服务，我正在路上。

由于我的环境是封闭的——仅用于开发——这对我来说是一个快速的解决方法。我应该警告你，这不是最终用户的最佳实践！只为我们开发者。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2018-10-20T12:22:52.400

在sql server 管理中。我去了数据库属性然后权限并向公众授予备份权限，我假设您也可以授予特定用户。这解决了我的问题。

# php - 警告：imagettftext() [function.imagettftext]：在第 35 行的 /home/a2424901/public_html/index.php 中找不到/打开字体

> ID：10366679
> 
> 赞同：21
> 
> 时间：2012-04-28T19:10:18.597
> 
> 标签：php, truetype, imagettftext

```
<?php
session_start();
require_once 'facebook.php';
$app_id = "418907881455014";
$app_secret = "36389d2c4caaf6de86982cb87686a494";
$redirect_uri = 'http://gooogle12.comuf.com';
$facebook = new Facebook(array(
        'appId' => $app_id,
        'secret' => $app_secret,
        'cookie' => true
));
$user = $facebook->getUser();
$user_profile = $facebook->api('/me');

$coded = $_REQUEST['code'];

$access_token = $facebook->getAccessToken();
$name = "".$user_profile['name']."";
$fbid = "".$user_profile['id']."";

function RandomLine($filename) {
    $lines = file($filename) ;
    return $lines[array_rand($lines)] ;
}
$reason = RandomLine("reason.txt");  

$canvas = imagecreatefromjpeg ("bg.jpg");                                   // background image file
$black = imagecolorallocate( $canvas, 0, 0, 0 );                         // The second colour - to be used for the text
$font = "Arial.ttf";                                                         // Path to the font you are going to use
$fontsize = 20;                                                             // font size

$birthday = "".$user_profile['birthday']."";
$death = "- ".date('d/m/Y', strtotime( '+'.rand(0, 10000).' days'))."";

imagettftext( $canvas, 22, -1, 110, 120, $black, $font, $name );            // name
imagettftext( $canvas, 22, -1, 110, 170, $black, $font, $birthday );        // birthday
imagettftext( $canvas, 22, -1, 255, 172, $black, $font, $death );           // death
imagettftext( $canvas, 20, -1, 110, 220, $black, $font, $reason );           // reason

$facebook->setFileUploadSupport(true);

//Create an album
$album_details = array(
        'message'=> 'How will you die?',
        'name'=> 'How will you die?'
);
$create_album = $facebook->api('/me/albums', 'post', $album_details);

//Get album ID of the album you've just created
$album_uid = $create_album['id'];

//Upload a photo to album of ID...

$file='img/'.$fbid.'.jpg'; //Example image file

$photo_details = array( 'message'=> 'Find...51', 'image' => '@'.realpath($file));
$upload_photo = $facebook->api('/'.$album_uid.'/photos', 'post', $photo_details);

    enter code here

ImageDestroy( $canvas );

header("Location: http://facebook.com".$fbid."&photoid=".$upphoto."")
?> 
```

好吧，我正在使用这个 php 代码制作一个 facebook 应用程序。我将字体上传`Arial.ttf`到我网站的根目录。但我仍然显示错误 - `Warning: imagettftext() [function.imagettftext]: Could not find/open font in /home/a2424901/public_html/index.php on line 35`。我尝试改变案例，但我没有为我工作。我在这段代码中哪里出错了？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-28T19:16:08.430

[从文档](http://php.net/manual/en/function.imagettftext.php)

> 根据 PHP 使用的 GD 库版本，当 fontfile 不以前导 / 开头时，.ttf 将附加到文件名，并且库将尝试沿着库定义的字体路径搜索该文件名。

这似乎暗示字体文件应该是一个绝对路径，如果不是，该函数将`.ttf`在其末尾附加另一个。

指定字体文件的完整路径。

```
$font = "/home/a2424901/public_html/Arial.ttf"; 
```

或者省略`.ttf`并使用`GDFONTPATH`. [该文档](http://php.net/manual/en/function.imagettftext.php)建议以下内容：

> 在许多情况下，字体与使用它的脚本位于同一目录中，以下技巧将缓解任何包含问题。

```
putenv('GDFONTPATH=' . realpath('.'));
$font = "Arial"; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-12-07T09:20:36.100

添加到user2724960的答案；更改 FontName`__DIR__ . '/graph/fonts/someFont.ttf'`为我做这件事。

全线：

```
$myPicture->setFontProperties(array("FontName"=>__DIR__ .  '/graph/fonts/someFont.ttf',"FontSize"=>14)); 
```

不要忘记将“ **someFont** ”替换为您的字体文件的名称（默认：“Forgotte”）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-10-26T20:04:08.143

我的解决方案（对我有用）：

```
realpath('here/is/right/path/to/font.ttf'); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-11-12T15:31:09.960

我也在 XAMPP 上，显然 XAMPP 只支持字体的完整目录路径。此代码适用于 Windows (XAMPP) 和我们的供应商 Linux 服务器：

```
$dir= dirname(realpath(__FILE__));
$sep=DIRECTORY_SEPARATOR;   
$font =$dir.$sep.'arial.ttf';
imagettftext($thumb, $size, 0, $y_pos, $size, $textcolor, $font, $txt); 
```

（假设您的字体文件与您的 php 文件位于同一目录中）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-11T21:43:34.883

我有同样的问题。我的字体名称是

> 滴度

我把它改成了

> 滴度.ttf

它工作得很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-02T02:57:15.240

它对我有用：使用绝对路径

```
$font = 'C:\wamp\www\Persian-txt2img\Vazir-Code.ttf';
$font = mb_convert_encoding($font, 'big5', 'utf-8');

// Add the text
imagettftext($image, 24, 0, 64, 48, $text_color, $font, $text); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-28T10:25:56.110

如果您使用的是 pChart，请使用：

```
$myPicture->setFontProperties(array("FontName"=>"../fonts/Forgotte.ttf","FontSize"=>11)); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-13T00:30:12.850

在 GoDaddy（共享主机，Cpanel）上，我只需要在域*之后指定路径：*

**我的文件在这里：**

```
URL:  http://example.com/assets/fonts/verdana/verdana.ttf
path:  /home/content/123456/html/example/assets/fonts/verdana/verdana.ttf 
```

**有效的PHP代码：**

```
$font = 'assets/fonts/verdana/verdana.ttf'; 
```

对路径使用其他值不起作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-26T10:06:52.080

我在 localhost (XAMPP) 上工作时遇到了同样的问题。

我的解决方案是：

```
// Set Correct Path to Font File
$fontPath='C:\xampp\htdocs\Adeplay\fonts\Tesox\tesox.ttf'; 
```

* * *

## 回答 #10

> 赞同：-6
> 
> 时间：2014-06-11T16:03:12.223

请检查资源下的字体文件夹。

# system.reactive - 我该如何处理 Rx 或 Rx？

> ID：10366683
> 
> 赞同：0
> 
> 时间：2012-04-28T19:10:51.047
> 
> 标签：system.reactive

我需要使用 Reactive-Extensions 处理非此即彼的类型情况。

我收到了 2 个事件（A 或 B）。当事件 A 在 2 秒内出现事件 B 时，我想生成一个 C。如果 A 后面没有 B，那么我想生成一个 D。

有什么方法可以用 Rx 来表达吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:35:53.630

这是您可以做到的一种方法：

```
Observable.Merge(eventA, eventB)
    .Timestamp()
    .Buffer(2 /*items*/,1 /*at a time*/)
    .SelectMany(x => {
        if (x[1].Timestamp - x[0].Timestamp < TimeSpan.FromSeconds(2.0) &&
            x[0].Value.EventType == "A" && x[1].Value.EventType == "B") {
            return Observable.Return(new C());
        }

        if (x[0].Value.EventType == "A" && x[1].Value.EventType != "B") {
            return Observable.Return(new D());
        }

        return Observable.Empty<AnEvent>();
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T23:56:10.993

SelectMany 以及返回备用可观察对象的 Timeout 重载应该能够完成您所描述的操作。

```
Dim obsA = Observable.Interval(TimeSpan.FromSeconds(1)) 'whatever your source is
Dim obsB = Observable.Interval(TimeSpan.FromSeconds(0.5)) 'whatever your source is
'replace with your actual C/D generation functions
Dim final = From a In obsA
            From b In obsB.Select(Function(i) "C" & a.ToString()) _
                          .Timeout(TimeSpan.FromSeconds(2),
                                   Observable.Return("D" & a.ToString())) _
                          .Take(1)
            Select b 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T10:23:27.747

通过使用内置`Amb`运算符，这似乎相当容易。

首先定义`obsC`&`obsD`像这样：

```
var obsC = Observable.Return('C');

var obsD = Observable.Delay(
    Observable.Return('D'),
    TimeSpan.FromSeconds(2.0)); 
```

现在我想要一个“B”然后是“C”可观察的。在最新的“B”之后，我只想要一个“C”。如果出现两个“B”，我只想要最新的一个。这里是：

```
var obsBC =
    obsB
        .Select(_ => obsC)
        .Switch()
        .Take(1); 
```

现在对于将所有这些与运算符结合在一起的最终查询`Amb`：

```
var query =
    from a in obsA
    from cd in Observable.Amb(obsBC, obsD)
    select cd; 
```

我的测试表明这个查询有效。但是就像所有这些事情一样，如果两个“A”在一个“B”之前出现，该怎么办是不清楚的。我能得到一个“D”/“C”或“C”/“C”或只是一个“D”或“C”吗？根据所需的行为，我的查询可能需要更改。

# python - 为什么我收到错误：“值错误”- int() 的无效文字，基数为 10：'matthew'

> ID：10366687
> 
> 赞同：0
> 
> 时间：2012-04-28T19:11:07.897
> 
> 标签：python, django, literals, base

我正在使用 django/python。

以下是数据的来源：用户从一个或多个选项中选择一个`<select name="op_assignedTo">`

我也用`<option value="username">`

数据通过 POST 发送并在 django 视图中收集：

`op_assignedTo = request.POST.getlist('op_assignedTo')`

但是以下行给了我错误： `assignedTo_list = Item.objects.filter(assignedTo__in=op_assignedTo)`

我从stackoverflow上其他问题的许多其他答案中得到了上述内容。我对这个错误感到困惑，因为即使是这条线

`temp = Item.objects.filter(assignedTo='matthew')`

给出同样的错误，`"Value Error" - invalid literal for int() with base 10: 'matthew'.`

如果我帖子的第一部分不太有意义，请查看我发布的最后一行代码。谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:26:33.813

分配给什么样的字段？我猜它是一个外键，在这种情况下，当你传递一个字符串时，它会尝试对一个 id 进行过滤。我对吗？

这里的问题是，assignTo 被视为一个 int（它是一个 int，或者是基于一个 int 进行比较，例如外键 id），并且您正在传递一个字符串来比较它，这是无效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T21:19:08.947

要跨 ForeignKey 查询字段，请使用双下划线语法`__`。

[https://docs.djangoproject.com/en/dev/topics/db/queries/#lookups-that-span-relationships](https://docs.djangoproject.com/en/dev/topics/db/queries/#lookups-that-span-relationships)

```
temp = Item.objects.filter(assignedTo__username='matthew') 
```

# xml - 格式化 XML 文件

> ID：10366688
> 
> 赞同：0
> 
> 时间：2012-04-28T19:11:18.830
> 
> 标签：xml, xslt

我有以下 xml 文件：

```
 <table name="countries">
            <column name="id">1</column>
            <column name="name">Abkhazia</column>
            <column name="code">XZ</column>
            <column name="phone_code">+995</column>
            <column name="flag">xz.gif</column>
        </table> 
```

我怎样才能把这个xml格式化成这样的东西？

```
 <countries>
            <id>1</id>
            <name>Abkhazia</name>
            <code>XZ</code>
            <phone_code>+995</phone_code>
            <flag>xz.gif</flag>
        </countries> 
```

有这方面的一些在线资源吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:38:19.580

这只是在任何编程语言中使用 xml 的基本工作。我在没有编程的情况下在 XSLT 中完成了它，转换产生了所需的输出（在这里测试：[XSLT Transformation - Online Toolz](http://xslt.online-toolz.com/tools/xslt-transformation.php)），也许有更优雅的方法，我不是 XSLT 专家

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" encoding="utf-8" indent="no"/>

<xsl:template match="table">
<xsl:variable name="tableName" select="@name"></xsl:variable>
<xsl:element name="{$tableName}">
  <xsl:for-each select="column">
     <xsl:variable name="columnName" select="@name"></xsl:variable>
     <xsl:element name="{$columnName}">
     <xsl:value-of select="."/> 
   </xsl:element>
  </xsl:for-each>
</xsl:element>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T19:44:11.610

**这个简短而简单的转换：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="*">
  <xsl:element name="{@name}">
    <xsl:apply-templates/>
  </xsl:element>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<table name="countries">
    <column name="id">1</column>
    <column name="name">Abkhazia</column>
    <column name="code">XZ</column>
    <column name="phone_code">+995</column>
    <column name="flag">xz.gif</column>
</table> 
```

**产生想要的正确结果：**

```
<countries>
   <id>1</id>
   <name>Abkhazia</name>
   <code>XZ</code>
   <phone_code>+995</phone_code>
   <flag>xz.gif</flag>
</countries> 
```

# c# - 带有文件名的 LINQ GroupBy

> ID：10366691
> 
> 赞同：0
> 
> 时间：2012-04-28T19:11:31.363
> 
> 标签：c#, linq

试图在一组文件中获取不同标识符的集合。这个 Lambda 查询我做错了什么：

```
 var enumDir = Directory.GetFiles(folder);
   var distinctCode = enumDir.Select(s => Path.GetFileName(s).Substring(8, 4))
                              .GroupBy(s => s.ToString()); 
```

提前致谢 ...

## 编辑

@empi 建议。我希望从文件名中得到一个不同的 4 个字母子字符串的列表，我得到的是什么，或者我已经将 Path.Get....例外。

@Oskar Kjellin 建议我应该提到每个文件名的长度设置为 45 个字符

## 最终解决方案 | 感谢 empi 和奥斯卡

```
var enumDir = Directory.GetFiles(folder).Where(a => Path.GetFileName(a).Length > 12);
var distinctCode = enumDir.Select(s => Path.GetFileName(s).Substring(8, 4)).Distinct(); 
```

真的是这两种建议的结合，我不知道该为谁标记答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:20:26.873

您应该始终在调用子字符串之前检查长度以避免异常......

```
 enumDir = Directory.GetFiles(folder);
 distinctCode = enumDir.Select(s => Path.GetFileName(s))
.Select( s=> s.Length >= 12 ? s.Substring(8, 4) : s).GroupBy(s => s); 
```

您永远无法真正控制文件夹中的文件。例如，windows 可以创建 thumbs.db，它是图像或其他临时文件缩略图的缓存。

也许您只想过滤掉具有固定长度的那些：

```
 enumDir = Directory.GetFiles(folder);
 distinctCode = enumDir.Select(s => Path.GetFileName(s)).Where(s=>s.Length == 45)
.Select( s=> s.Substring(8, 4)).GroupBy(s => s); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:24:21.147

`enumDir.Select(s => Path.GetFileName(s).Substring(8, 4))`- 此代码应返回`IEnumerable<string>`- 检查此集合是否正常。如果没问题，那么只需使用`Distinct()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:34:08.867

我怀疑您要查找的是获取实际文件名，但按子字符串对它们进行分组。

```
var result = Directory.GetFiles(folder)
    .Select(s => Path.GetFileName(s))
    .Where(s => s.Length > 12)
    .GroupBy(s => s.Substring(8, 4)); 
```

现在，`result`您拥有`Key`作为子字符串的组对象，如果枚举它们，您将获得与该键匹配的实际文件名。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T21:33:46.583

我认为使用正则表达式进行验证可以做得更好。您尝试在查询中执行的检查类型过于复杂，无法在单个查询中执行。该目录中可能有其他文件不符合您的模式，这是您不期望的，并且可能会搞砸一切。这种复杂性可以通过正则表达式来捕获。如果您的文件名遵循某种模式，一个简单的正则表达式匹配可以为您处理。

我不知道您的文件名是什么样的，所以我将使用 Windows Media Center 录制的电视作为示例。所有 WMC 文件名都有特定的模式：

```
[title]_[station]_[year]_[month]_[day]_[hour]_[minute]_[second].wtv 
```

然后按标题对所有视频进行分组，您可以这样做：

```
var dir = @"C:\Users\Public\Recorded TV";
var wmcFileRe = new Regex(@"
    ^
    (?<title>.+)
    _
    (?<station>.+)
    _
    (?<date>\d{4}_\d{2}_\d{2})
    _
    (?<time>\d{2}_\d{2}_\d{2})
    \.wtv
    $
", RegexOptions.Compiled | RegexOptions.IgnorePatternWhitespace);
var query =
    from filePath in Directory.EnumerateFiles(dir)
    let fileName = Path.GetFileName(filePath)
    let match = wmcFileRe.Match(fileName)
    where match.Success
    orderby match.Groups["title"].Value,
            match.Groups["date"].Value descending,
            match.Groups["time"].Value descending
    group filePath by match.Groups["title"].Value; 
```

产生这样的东西：

![例子](../Images/b80501e7ec4e4dba797d7f6d44ef6ab6.png)

此外，使用`Directory.EnumerateFiles()`而不是`Directory.GetFiles()`这样您就不会预先创建该结果数组，该数组在其他任何地方都不需要。

# java - Xalan DTMManager.newInstance 性能问题

> ID：10366695
> 
> 赞同：1
> 
> 时间：2012-04-28T19:12:08.960
> 
> 标签：java, xml, weblogic, xerces, xalan

我们继承了一个广泛使用 JSTL XML 标记，尤其是 XPath 选择器的应用程序（基于 Java，在 WebLogic 10.3.5 上运行）。由于这些标签的实现以及如何首先解析 DTMManager 类然后由 DTMManager.newInstance 方法实例化，我们很快就遇到了一些性能问题。

DTMManager 类名称查找问题之前已[记录在案](https://stackoverflow.com/questions/6340802/java-xpath-apache-jaxp-implementation-performance)，并通过设置`com.sun.org.apache.xml.dtm.DTMManager`系统属性得到解决。

但是，一旦找到类名，该`com.sun.org.apache.xml.internal.dtm.ObjectFactory.findProviderClass`方法就会要求（非空）类加载器加载类定义，并且它永远不会缓存结果！在 WebLogic 环境中，此操作非常昂贵，并且占用了我们很大一部分响应时间。

类定义永远不会被缓存是否有原因？有没有办法避免每次都加载类定义？

谢谢一堆。

**更新**可以观察到`com.sun.org.apache.xerces.internal.impl.dv.DTDDVFactory`类的类似行为 - ClassLoader 在每次调用时重新加载类定义`DTDDVFactory.newInstance`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:25:21.923

除了避免广泛使用这些标签之外，似乎无能为力。我们重构了这段代码：

*   XML 解析现在由自定义标记执行，该标记使用 JAXB 填充从 XSD 生成的对象图，并且
*   JSP 现在使用标准符号来查询对象图

只是表明在 JSP 中进行 XML 解析并不是一个特别好的主意......

# java - 为什么实时系统是并发的？

> ID：10366697
> 
> 赞同：1
> 
> 时间：2012-04-28T19:12:12.437
> 
> 标签：java, multithreading, time, concurrency, real-time

是不是因为施加在实时系统上的时序约束意味着线程或任务应该根据时序控制自己的执行，而顺序执行的程序可能由于其任务负载而无法保证实现时序？

问候，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T19:14:35.277

您可以使用一个线程编写一个实时系统，因此它不必是并发的。

使用线程可以帮助实时系统，但它们可能会引入自己的问题。

也许您将实时与并发联系起来，因为您必须更加了解每个线程在做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T17:15:59.900

我喜欢彼得的回答，但我想详细说明。

作为实时系统一部分的外生物理设备——即与实时软件和计算机交互的部分——可能具有任何数量的并发性，从无到无。实时系统本质上不是并发的，但在某种程度上，即使不是大多数，也有很多是并发的。

不管外生部分有多少并发，实时软件通常可以有任意数量的并发，从没有（所谓的“主线程”彼得提到）到尽可能多的可调度线程/任务/等。被认为是适当的。

正如 Peter 所指出的，软件中的并发性越多，并发控制就越复杂和困难。这通常是正确的，并且由于时间限制在实时软件中更加严重。一些著名的软件科学家声称，人类的思维并不适合管理任何事物的高度异步并发。

Edward Lee 是并发线程最直言不讳的批评者之一，正如本技术报告“线程的麻烦” [www.eecs.berkeley.edu/Pubs/TechRpts/2006/EECS-2006-1.pdf](http://www.eecs.berkeley.edu/Pubs/TechRpts/2006/EECS-2006-1.pdf)中所清楚记录的那样。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-28T20:34:56.870

正如其他人发布的那样，并发<>实时。

由于良好的 IO 性能，实时系统倾向于使用抢占式调度程序。协作或不存在的调度仅适用于延迟和整体 IO 性能不重要的应用程序 - 将它们排除在许多/大多数“实时”任务中。

是否真正使用了“真正的”并发，即。多核，是另外一回事。

# python - Python 变量和文件

> ID：10366702
> 
> 赞同：1
> 
> 时间：2012-04-28T19:12:41.107
> 
> 标签：python, file, variables

有什么办法可以让我可以将文件视为变量？例如，当调用 PIL Image 模块中的函数 save 时：`Image.save("foo.jpg")`我希望所有数据*不保存在硬盘上*，而是引入变量`a`中，以便在`a.read()`调用时返回文件内容是。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T19:18:02.813

您可以使用[BytesIO](http://docs.python.org/release/3.1.5/library/io.html#io.BytesIO)类将 PIL 图像保存到字节流中。

```
>>> from PIL import Image
>>> im = Image.open('ball.png')
>>> from io import BytesIO
>>> buffer = BytesIO()
>>> im.save(buffer, format='png')
>>> buffer.getvalue()
'\x89PNG\r\n\x1a\n\x00\ ... 
```

可能值得阅读整个[io 模块页面](http://docs.python.org/release/3.1.5/library/io.html)，它很短，有很多很好的信息，包含 StringIO，正如 ch3ka 指出的那样。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-28T19:17:47.267

当然，看看`StringIO`模块。它为字符串提供了一个类似文件的接口。

[http://docs.python.org/library/stringio.html](http://docs.python.org/library/stringio.html)

```
StringIO - File-like objects that read from or write to a string buffer. 
```

# c++ - 如何在 netfilter 中重新计算 IP 校验和？

> ID：10366706
> 
> 赞同：1
> 
> 时间：2012-04-28T19:12:52.530
> 
> 标签：c++, linux, module, kernel, netfilter

我正在开发一个 netfilter 内核模块，我需要在其中重新计算 IP 校验和。我使用这个函数来计算 IP 校验和（在互联网上的某个地方找到）：

```
unsigned short ComputeIPChecksum(unsigned char *data, int len)
{
         long sum = 0;  /* assume 32 bit long, 16 bit short */
     unsigned short *temp = (unsigned short *)data;

         while(len > 1){
             sum += *temp++;
             if(sum & 0x80000000)   /* if high order bit set, fold */
               sum = (sum & 0xFFFF) + (sum >> 16);
             len -= 2;
         }

         if(len)       /* take care of left over byte */
             sum += (unsigned short) *((unsigned char *)temp);

         while(sum>>16)
             sum = (sum & 0xFFFF) + (sum >> 16);

        return ~sum;
} 
```

通过查看wireshark，我可以看到传入的数据包已成功接收，但对于传出的数据包，wireshark 显示不正确的IP 校验和。这是我的钩子函数：

```
static unsigned int hook_func(unsigned int hooknum,
                        struct sk_buff *skb,
                                const struct net_device *in,
                                const struct net_device *out,
                                int (*okfn)(struct sk_buff *))
{
    sock_buff = skb; 

    if (sock_buff)
    {
            ip_header = (struct iphdr *)skb_network_header(sock_buff);
            if (ip_header && ip_header->protocol == TCP)
            {
                ip_header->check = ComputeIPChecksum((unsigned char *)ip_header, ip_header->ihl*4);
            }
    }
    return NF_ACCEPT;
} 
```

这是主要的，我已经将相同的钩子函数绑定到 PRE_ROUTING 和 POST_ROUTING

```
static int __init init_main(void)
{
    nfho.hook     = hook_func;
    nfho.hooknum  = 0;
    nfho.pf       = PF_INET;
    nfho.priority = NF_IP_PRI_FIRST;

    nfho1.hook     = hook_func;
    nfho1.hooknum  = 4;
    nfho1.pf       = PF_INET;
    nfho1.priority = NF_IP_PRI_FIRST;

    nf_register_hook(&nfho);
    nf_register_hook(&nfho1);

    return 0;
} 
```

为什么传出数据包的 IP 校验和损坏？？？

在wireshark中显示的错误：

```
Header checksum: 0x0000 [incorrect, should be 0x85de (maybe caused by "IP checksum offload"?)] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:43:06.853

你在哪里抓包？

IP校验和（以及TCP/UDP校验和）可以由网卡自己计算。如果您的卡上是这种情况（这是一个非常常见的功能）并且您正在您的机器上捕获，我希望看到 0 个校验和。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T13:08:03.713

如果您像这样定义 IP 标头：

```
struct iphdr *iph; 
```

接着

```
iph = (struct iphdr *) skb_header_pointer(skb, 0, 0, NULL); 
```

然后你可以像下面这样重新计算校验和。

```
/* Calculation of IP header checksum */
iph->check = 0;
ip_send_check (iph); 
```

您可能会看看我的问题：[如何从内核空间将数据附加到数据包上？](https://stackoverflow.com/questions/12529497/how-to-append-data-on-a-packet-from-kernel-space/12841411#12841411) 在那里，您可以在底部的给定答案中找到详细代码。在那里我不得不重新计算 IP 和 UDP 标头校验和。

# xslt - XSL：xpath 没有返回正确的值

> ID：10366707
> 
> 赞同：2
> 
> 时间：2012-04-28T19:13:43.447
> 
> 标签：xslt, abap

我正在用 XSL 解析一个 XSL 文件。而且我在动态查找其中的节点时遇到问题。这是场景：

```
<linkbase xmlns="http://www.xbrl.org/2003/linkbase"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="http://www.xbrl.org/2003/linkbase http://www.xbrl.org/2003/xbrl-linkbase-2003-12-31.xsd">
    <labelLink xmlns:xlink="http://www.w3.org/1999/xlink" 
                xlink:role="http://www.xbrl.org/2003/role/link" 
                xlink:type="extended">
        <loc xlink:type="locator" 
                    xlink:href="de-gaap-ci-2010-12-16.xsd#de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other" 
                    xlink:label="de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other"/>

        <!-- many <loc... elements -->

        <labelArc xlink:from="de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other"
                xlink:to="label_de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other" 
                priority="1" 
                xlink:arcrole="http://www.xbrl.org/2003/arcrole/concept-label"
                xlink:type="arc"/>

        <!-- many <labelArc... elements -->

     </labelLink>
</linkbase> 
```

我正在解析`labelArc`元素并希望包含来自`loc`元素的信息。这是通过 SAP/ABAP 完成的...

我的 XSL 代码如下所示：

```
<xsl:stylesheet version="1.0"
 xmlns:lb="http://www.xbrl.org/2003/linkbase"
 xmlns:xlink="http://www.w3.org/1999/xlink">

    <xsl:template match="lb:labelArc">
        <xsl:variable name="arc_to" select="@xlink:to"/>

      <TY_T_LABELARC>
        <LOC>  <xsl:value-of select="//lb:loc[@xlink:label='$arc_to']/@xlink:href"/> </LOC>
        <FROM> <xsl:value-of select="@xlink:from"/> </FROM>
        <TO>   <xsl:value-of select="@xlink:to"/> </TO>
        <!-- Other values follow -->
      </TY_T_LABELARC>

    </xsl:template> 
```

我期待这个结果：

```
<TY_T_LABELARC>
   <LOC>de-gaap-ci-2010-12-16.xsd#de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other</LOC>
   <FROM>de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other</FROM>
   <TO>label_de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other</TO>
</TY_T_LABELARC> 
```

`LOC`我的问题是，除了具有空值（`<LOC/>`）的元素之外，一切都很好。

这意味着这个 xpath 表达式返回一个空值：

```
<xsl:value-of select="//lb:loc[@label='$arc_to']/@href"/> 
```

该语句的目标是`href`从元素中获取属性`loc`。我可以找到每个标签`loc`的值对应的标签。`@to``labelArc`

我在每个属性上都使用前导命名空间“xlink：”尝试了它，没有它......

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:35:15.590

**您的代码有两个问题：**

**首先**：

```
 <xsl:variable name="arc_to"       
       select="@xlink:to"/> 
```

请注意，`xlink:to`元素的属性值`labelArc`以字符串开头`"label_"`——而`xlink:label`属性 of`loc`不以该字符串开头。

所以你应该写：

```
 <xsl:variable name="arc_to"
      select="substring-after(@xlink:to, 'label_')"/> 
```

**其次**：

```
 <xsl:value-of select="//lb:loc[@xlink:label='$arc_to']/@xlink:href"/> 
```

这与**字符串**`@xlink:label`进行比较，而 不是与变量进行比较。 **`"$arc_to"``$arc_to`**

 **所以你应该写：

```
 <xsl:value-of select="//lb:loc[@xlink:label= $arc_to]/@xlink:href"/> 
```

**更正后的代码**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:lb="http://www.xbrl.org/2003/linkbase"
 xmlns:xlink="http://www.w3.org/1999/xlink"
  exclude-result-prefixes="lb xlink">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="lb:labelArc">
    <xsl:variable name="arc_to"
      select="substring-after(@xlink:to, 'label_')"/>

  <TY_T_LABELARC>
    <LOC>  <xsl:value-of select="//lb:loc[@xlink:label= $arc_to]/@xlink:href"/> </LOC>
    <FROM> <xsl:value-of select="@xlink:from"/> </FROM>
    <TO>   <xsl:value-of select="@xlink:to"/> </TO>
    <!-- Other values follow -->
  </TY_T_LABELARC>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<linkbase
  xmlns="http://www.xbrl.org/2003/linkbase"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.xbrl.org/2003/linkbase http://www.xbrl.org/2003/xbrl-linkbase-2003-12-31.xsd">
  <labelLink xmlns:xlink="http://www.w3.org/1999/xlink"
             xlink:role="http://www.xbrl.org/2003/role/link"
             xlink:type="extended">
    <loc xlink:type="locator"
         xlink:href="de-gaap-ci-2010-12-16.xsd#de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other"
         xlink:label="de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other"/>

            <!-- many <loc... elements -->

   <labelArc priority="1" xlink:type="arc"
     xlink:from="de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other"
     xlink:to="label_de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other"
     xlink:arcrole="http://www.xbrl.org/2003/arcrole/concept-label" />

            <!-- many <labelArc... elements -->

 </labelLink>
</linkbase> 
```

**产生了想要的正确结果：**

```
<TY_T_LABELARC>
   <LOC>de-gaap-ci-2010-12-16.xsd#de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other</LOC>
   <FROM>de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other</FROM>
   <TO>label_de-gaap-ci_bs.ass.fixAss.fin.otherLoans.other</TO>
</TY_T_LABELARC> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:21:34.573

尝试：

```
<xsl:value-of select="//lb:loc[@label=$arc_to]/@href"/> 
```

如果你写

```
<xsl:value-of select="//lb:loc[@label='$arc_to']/@href"/> 
```

然后告诉 XSL 处理器匹配字符串 '$arc_to' 而不是 arc_to 变量的值。**

# php - 显示页面事件的 Facebook PHP SDK

> ID：10366710
> 
> 赞同：0
> 
> 时间：2012-04-28T19:13:55.090
> 
> 标签：php, facebook, facebook-graph-api

如何在我的网站上列出 Facebook 页面的事件？

可能吗？而且我不需要 getUser() 等，因为我没有从用户那里获取任何东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T16:50:51.547

使用您的用户 ID 代替获取用户。

```
<?php
//Facebook
session_start();
require_once "php-sdk/src/facebook.php"; 

$config = array(
    "appId" => XXXXXXXXXXXXXXXX,
    "secret" => 'XXXXXXXXXXXXXXXXXXXXXXXXXXXX',
    "cookie" => true );
$fb = new Facebook($config);
$uid = XXXXXXXXXXXXXXXX;
$access_token = $fb->getAccessToken();
$permissions_list = $fb->api(
   '/me/permissions',
   'GET',
   array(
      'access_token' => $access_token )
      );
?> 
```

# php - 如何为我的 PHP Facebook 应用程序创建离线环境？

> ID：10366712
> 
> 赞同：0
> 
> 时间：2012-04-28T19:14:20.660
> 
> 标签：php, facebook

我有一个从 facebook 墙上读取信息的网站。我可以很高兴地将带有 var_dump 或 print_r 的墙对象转储到文件中，但是我如何使用这些数据以便可以离线工作？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T02:51:43.783

没有更简单的方法......或者您可以使用您的 var_dump，创建一个文件（xml 或其他文件），而不是在需要时将其加载回来。但在我看来，数据库更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:17:32.323

简单的答案，您不能将 PHP 对象存储到数据库或其他东西中。当脚本执行结束时，变量的生命周期也会结束。

但是，您可以创建一个数据库来存储对象的数据。

# javascript - 我应该把这个 JS 代码放在哪里让它工作？

> ID：10366731
> 
> 赞同：0
> 
> 时间：2012-04-28T19:16:45.237
> 
> 标签：javascript, jquery, html, html-table

我基本上重新创建了我需要制作 JS 的表格部分，并在 JS fiddle 中组合了一些工作代码，但是当我尝试将它添加到表格部分所在的位置或任何其他称为 int he html 的函数中时打破页面......任何想法把这个放在哪里？[http://jsfiddle.net/UyHj3/13/](http://jsfiddle.net/UyHj3/13/)

```
$("tr.clickable.subheading td").click(function() {
    $(this).parents("tr.clickable.subheading").nextUntil("tr.clickable.subheading").toggle();
});​​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:19:36.180

您的问题是您试图将事件处理程序附加到 DOM 中不存在的元素。在 jsFiddle 中，默认情况下，代码`onload`在 DOM + 图像完全加载后运行。

将代码包装在 DOM 就绪事件中：

```
$(function() {
    $("tr.clickable.subheading td").click(function() {
        $(this).parents("tr.clickable.subheading").nextUntil("tr.clickable.subheading").toggle();
    });
}); 
```

[**更新小提琴**](http://jsfiddle.net/UyHj3/14/)​</p>

或者将代码放在`<body>`标签的末尾，就像[**这个 Fiddle**](http://jsfiddle.net/UyHj3/16/)一样。
但第一种选择被认为是一种更好的做法。

`ready`活动[文档](http://api.jquery.com/ready/)：

> 虽然 JavaScript 提供了在页面呈现时执行代码的加载事件，但在完全接收到所有资产（例如图像）之前，不会触发此事件。在大多数情况下，只要完全构建了 DOM 层次结构，就可以运行脚本。传递给 .ready() 的处理程序保证在 DOM 准备好后执行，因此这通常是附加所有其他事件处理程序和运行其他 jQuery 代码的最佳位置。当使用依赖 CSS 样式属性值的脚本时，在引用脚本之前引用外部样式表或嵌入样式元素很重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T19:19:16.407

您总是希望将事件处理程序放在 document.ready 函数中，例如

```
$(document).ready(function(){

//your code

}); 
```

您更新的小提琴：http: [//jsfiddle.net/ccross59/UyHj3/15/](http://jsfiddle.net/ccross59/UyHj3/15/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:20:56.967

放入任何一个

```
$(document).ready(function () {
   // I execute your code when the DOM is ready. 
}); 
```

或者

```
$(window).load(function () {
  // I execute your code when the entire page is loaded (including images or iframes)
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T19:21:40.507

看起来您那里有一些 jQuery，因此请确保您包含对 jQuery 库的引用：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script> 
```

并将您的代码放入 $(document).ready(){} 中：

```
$(document).ready(function(){
// your code
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T19:19:33.950

应该有一个 JavaScript 窗格。确保您在左侧菜单中使用 JQuery。

# java - 当我们在没有 sparql 的情况下使用 jena 有主题和属性时，如何在 RDF 中检索对象的值？

> ID：10366733
> 
> 赞同：0
> 
> 时间：2012-04-28T19:16:55.290
> 
> 标签：java, rdf, semantic-web, jena, ontology

我想检索我的 RDF 语句的对象值，并且我知道如何迭代我的所有类及其各自的属性，但我不知道如何访问它们的对象？

例如 ：

```
OntModel rdfModel = ModelFactory.createOntologyModel();
        rdfModel.read("mydata.rdf").read("myontology.rdf");
ExtendedIterator<OntClass> instances =  rdfModel.listClasses();
        while(instances.hasNext())
        {

            OntClass cls = instances.next();
            System.out.println("class name :" + cls.getURI());

            ExtendedIterator<OntProperty> prop = rdfModel.listOntProperties();
            while(prop.hasNext())
            {
                OntProperty ppp = prop.next();
                if (ppp.hasDomain(cls))
                {
                    System.out.println("the properties are :" + ppp.getURI());
                }
            } 
```

现在我想访问与交互类的属性相关的每个对象。

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T02:52:27.737

您可以使用 OntClass.listProperties(Property)。 [Javadocs](http://incubator.apache.org/jena/documentation/javadoc/jena/com/hp/hpl/jena/rdf/model/Resource.html)是您的朋友。

# php - 我可以使用 php 搜索一些文件吗？

> ID：10366738
> 
> 赞同：1
> 
> 时间：2012-04-28T19:17:34.933
> 
> 标签：php, search

我正在考虑为我的大学课程开发一个网站，学生可以在其中上传自己的教程、操作方法、内容等。通常所有文件都是纯文本并发布在我的网站上。但有时会有一些课程资料和其他需要存储的东西，可以是 doc、docx、pdf 或任何类似格式。PHP 可以读取、写入、搜索文件，但如果我需要搜索内容，我将需要搜索文件和数据库。如果要搜索数千个不同大小的文件，肯定会很耗时且速度较慢。有没有可能的解决方案来克服这个问题？

这只是一个想法。我发现 pdflib 提供了类似的功能，但我需要更多。是否有机会为我的文件编制索引以加快搜索速度？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:21:47.783

你可以使用狮身人面像。它是为在数百万行文本中搜索而设计的，因此这几个文档将很容易。

[http://en.wikipedia.org/wiki/Sphinx_(search_engine)](http://en.wikipedia.org/wiki/Sphinx_%28search_engine%29)

# android - 进行更改后如何同步android repo？

> ID：10366740
> 
> 赞同：1
> 
> 时间：2012-04-28T19:17:46.943
> 
> 标签：android, git, repository, android-source, cyanogenmod

我已经下载了带有 repo 的 Android 源代码，然后我在 frameworks/base/packages 中做了一些更改。现在，当我尝试进行 repo 同步时，它给了我这个错误：

> 同步工作树：60% (151/251) 错误：您对 'packages/SystemUI/src/com/android/systemui/statusbar/phone/PhoneStatusBar.java' 进行了本地更改；不能切换分支。

如何修复它并升级所有没有变化的项目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T07:29:07.050

正如 Jens 评论的那样，存储[在](http://book.git-scm.com/4_stashing.html)这里是一个不错的选择（对于*未提交*的更改。
它允许保存您的本地修改，`git pull`并`git stash apply`说修改回来。
例如，参见“[在 git clone - 本地更改后无法拉取或推送](https://stackoverflow.com/questions/4618080/cant-pull-or-push-after-git-clone-local-changes)”。

如果您已经提交了更改，最好：

*   `tmp`在你当前的 HEAD建立一个分支
*   重置`HEAD`为`origin/master`
*   重试`repo sync`。
*   合并`tmp`到`master`

# django - Django 表单字段分组

> ID：10366745
> 
> 赞同：14
> 
> 时间：2012-04-28T19:18:05.837
> 
> 标签：django, django-forms, django-templates

假设我有一个包含 20 个字段的表单，我想将其中的 10 个字段（group1）放在特定的 div 环境中，将其他 10 个字段（group2）放在不同的 div 环境中。就像是：

```
<div class="class1">
{% for field in form.group1 %}
            {{ field.label}}: {{ field }}
{% endfor %}
</div>

<div class="class2">
{% for field in form.group2 %}
            {{ field.label}}: {{ field }}
{% endfor %}
</div> 
```

有什么想法可以通过遍历字段来实现这一点吗？更一般地说，我希望能够使用许多不同的 div 环境和表单字段集来做到这一点。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-28T21:39:00.793

对字段进行分组的任何合乎逻辑的方法都可以使用...假设您的表单上有一个方法可以返回您明确分组的表单字段？

为了节省打字，也许是某个字段前缀命名方案？

```
class MyForm(forms.Form):
    group1_field = forms.CharField()
    group1_field = forms.CharField()
    group2_field = forms.CharField()
    group2_field = forms.CharField()

   def group1(self):
        return [self[name] for name in filter(lambda x: x.startswith('group1_'), self.fields.values()] 
```

也许在您可以过滤的字段上设置一个属性？

```
class MyForm(forms.Form):
    field = forms.CharField()
    field.group = 1

    field2 = forms.CharField()
    field2.group = 2

    def group1(self):
        return filter(lambda x: x.group == 1, self.fields.values())

    def group2(self):
        return filter(lambda x: x.group == 2, self.fields.values()) 
```

如果您设置了这些属性，您也可以使用重组标签。

```
{% regroup form.fields by group as field_group %}
{% for group in field_group %}
<div class="group_{{ group.grouper }}">
  {% for field in group.list %}
    {{ field }}
  {% endfor %}
</div>
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T21:31:05.883

这是一个相关的 SO 问题：[Django and Fieldsets on Modelform](https://stackoverflow.com/questions/518966/django-and-fieldsets-on-modelform)，尽管这对于我想要完成的事情来说似乎有点矫枉过正。此外，这是一种可能的 hack，尽管我很想知道 Django 专家是如何解决这个问题的。

(0) 定义一个可迭代的 python 字段集对象，以便我们可以在 django 模板中对其进行迭代：

```
from django.forms.forms import BoundField

class FieldSet(object):
    def __init__(self,form,fields,legend='',cls=None):
        self.form = form
        self.legend = legend
        self.fields = fields
        self.cls = cls

    def __iter__(self):
        for name in self.fields:
            field = self.form.fields[name]
            yield BoundField(self.form, field, name) 
```

(1) 在视图中使用：

```
fieldsets = (FieldSet(form_object, ('field_name1','field_name2'),
                        legend='Div env 1',
                        cls="class1"),
             FieldSet(form_object, ('field_name3','field_name4'), 
                        legend="Div env 2",
                        cls="class2"))

return render_to_response('my_form.html',
                          {'form': form_object,'fieldsets':fieldsets},
                          context_instance=RequestContext(request)) 
```

(2) 现在在模板中做：

```
{% for set in fieldsets %}
    <fieldset{% if set.cls %} class="{{ set.cls }}"{% endif %}>
      <legend>{{ set.legend }}</legend>
      {% for field in set %}
          {{ field.label}} : {{ field }}
      {% endfor %}
    </fieldset>
{% endfor %} 
```

请注意，可以用标签替换`fieldset`标签`div`来解决我的具体问题。

+++ 这个答案的大部分内容来自[Michael Kowalchik 的这篇博文](http://mikepk.com/2010/08/python_django_forms_errors_fieldsets/)。+++

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-04-05T12:54:39.560

我终于能够将@Yuji'Tomita'Tomitas regroup *-template* -tag-solution 带入工作（请参阅@Yuji'Tomita'Tomitas 回答中的评论以了解困难）。我认为这确实是一种对字段进行分组的好方法！

解决方案是通过`group`访问`field`返回属性的字段属性重新组合`BoundFields`。最小的例子：

在*forms.py 中*：

```
class TestForm(Form):
    a = IntegerField()
    a.group = 1
    b = IntegerField()
    b.group = 1
    c = IntegerField()
    c.group = 2
    d = IntegerField()
    d.group = 2 
```

在模板中：

```
<form>
  {% csrf_token %}
  {% regroup form by field.group as field_groups %}
  {% for field_group in field_groups %}
    {{field_group.grouper}}
    {% for field in field_group.list %}
      {{field}}
    {% endfor %}
  {% endfor %}
</form> 
```

# implementation - VDHL - 信号的初始值？

> ID：10366746
> 
> 赞同：0
> 
> 时间：2012-04-28T19:18:10.357
> 
> 标签：implementation, vhdl, fpga

我有输出 PWM 信号的简单 VHDL 模块。PWM 模块具有保持当前 PWM 百分比的信号。当我合成并实现它时，该信号默认重置为 0。有没有办法配置它，实现后 PWM 百分比为 20 或其他？

谢谢 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T20:20:26.387

您应该能够设置开机默认值。它必须与复位值一致（如果有的话），因为合成器将使用 NOT-gate-pushback 来实现它。

尝试

```
SIGNAL dutycycle : INTEGER := 20;   -- powerup value

PROCESS (n_reset, clk)
BEGIN
   IF TO_X01(n_reset) = '0' THEN
       dutycycle <= 20;             -- asynchronous reset value
   ELSIF RISING_EDGE(clk) THEN
       dutycycle <= load_dutycycle; -- synchronous load
   END IF;
END PROCESS; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T19:24:18.790

您可以将一个重置输入放入您的模块，将默认值加载到您的百分比寄存器中。

# php - 复制 Facebook 的“旧帖子/评论”的东西

> ID：10366747
> 
> 赞同：0
> 
> 时间：2012-04-28T19:18:14.633
> 
> 标签：php, javascript, css, ajax

例如，在 Facebook 上，当您向下滚动您的墙时，您点击“底部”，您可以在其中按下旧帖子按钮，然后会出现几十个帖子。谁能告诉我如何在我的网页上复制它？我是网络编程的新手，我不确定这是如何工作的，老实说，我什至不知道如何以及在网络上搜索什么，不知道从哪里开始寻找。

所以任何建议，链接表示赞赏。谢谢一堆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:23:08.407

快速搜索返回了本教程：

[http://net.tutsplus.com/tutorials/javascript-ajax/create-a-twitter-like-load-more-widget/](http://net.tutsplus.com/tutorials/javascript-ajax/create-a-twitter-like-load-more-widget/)

从页面本身：

*   服务器需要运行 PHP5，这样我们才能使用 PHP5 的 JSON 函数。

*   我们将从 WordPress “posts” MySQL 表中提取数据库记录。提供的代码的优点在于您可以将它与任何数据库系统一起使用；您需要做的就是修改 MySQL 查询和 jQuery 或 MooTools 使用的 JSON 属性。

*   客户端必须支持javascript。

*   我们正在使用 MooTools 1.2.3 Core 和更多 1.2.3.1。如果 jQuery 是首选框架，jQuery 1.3.2 和 Ariel Flesler 的 ScrollTo 插件。

# textures - 如何在 DirectX9 C++ 中对平铺的 3D 地形进行纹理处理？

> ID：10366749
> 
> 赞同：0
> 
> 时间：2012-04-28T19:18:45.997
> 
> 标签：textures, direct3d, tile, terrain

我对网格本身的操作没有任何问题，但是每个瓦片（基本上是 4 个顶点的正方形，整个地形网格由瓦片网格组成）必须能够被赋予我选择的不同纹理。所以到目前为止，我只能给网格 1 纹理并通过更改顶点缓冲区中 CUSTOMVERTEX-es 的 UV 值使其重复。但是我不能像这里一样制作不同的瓷砖纹理：http: [//classic.battle.net /war3/images/neutral/heroes/ss02.jpg](http://classic.battle.net/war3/images/neutral/heroes/ss02.jpg) - 你可以看到侧面有草瓦和一些泥瓦，左边有一些砾石。

我有一个愚蠢的想法，将每个瓷砖制作成单独的网格，但这只是......更重，纹理没有很好地夹住。我确信必须有一些功能让我纹理单独的地形网格：（

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:20:15.663

一种方法是使用 alpha 贴图来定义纹理在地形上的位置。通常您将 4 个或更多纹理绑定到一个着色器并使用另一个纹理和它的 rgba 组件来定义纹理应该出现的位置。

假设您有草、泥土、沙子和雪以及 alpha 贴图纹理。红色组件控制草的可见性，绿色组件控制泥土，蓝色组件控制沙子，阿尔法组件控制雪。

在像素着色器中，您从 alphamap 读取，然后使用您从草、沙、泥雪纹理混合的 rgba 组件中的值。

一些伪代码：

```
float4 mix = sampler.read(alphaTexture,alphaTexCoord);
float4 finalColor = sampler.read(grassTexture,texCoord) * mix.r + 
                    sampler.read(dirtTexture,texCoord) * mix.g + 
                    sampler.read(sandTexture,texCoord) * mix.b + 
                    sampler.read(snowTexture,texCoord) * mix.a; 
```

如您所见，如果在 alpha 贴图中您的颜色值为 0,0,1,0，则该片段将是沙子，依此类推。

此视频中的地形是通过这种技术纹理化的： [http ://www.youtube.com/watch?v=-mBpMYYtJCo](http://www.youtube.com/watch?v=-mBpMYYtJCo)

您也可以使用 8 个纹理和 2 个 alpha 贴图。

希望有帮助。

# function - 使来自 emacs 模式的函数在模式文件之外可用

> ID：10366750
> 
> 赞同：2
> 
> 时间：2012-04-28T19:18:47.293
> 
> 标签：function, export, elisp

我编写了一个 emacs 次要模式，除了次要模式之外，它还应该使一些函数可用于显式调用。在模式的文件中，定义模式和功能后，我定义了`provide`模式：

```
(provide 'xcode-dired-mode) 
```

其中，在我的`.emacs`I中`require`：

```
(setq load-path (cons "~/Documents/Local Projects/xcode-emacs" load-path))
(require 'xcode-dired-mode "xcode-dired") 
```

现在，当缓冲区处于此模式时，我希望有一些额外的功能可用。如果我`defun`在 lisp 文件中有一个用于次要模式的函数，例如：

```
(defun xcode-build()
  "Build the default target in the Xcode project."
  ;; ...
  ) 
```

这些功能在文件之外不可用，例如`M-x xcode-build`将不起作用。我不认为`provide`文件是合适的做法，因为我不想将`require`所有文件都放在`.emacs`. 我已经看到了神奇的评论`;;; ###autoload`，但据我所知，这只在编译 emacs 本身时使用。

当我的次要模式应用于缓冲区时，如何安排可以使用该模式的 lisp 文件中定义的函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T21:08:49.250

为了调用`xcode-build`via `M-x`，您需要确保函数实现调用`interactive`特殊形式以将函数声明为可交互调用。

我相信这是相关的emacs文档：

[http://www.gnu.org/software/emacs/manual/html_node/elisp/Using-Interactive.html](http://www.gnu.org/software/emacs/manual/html_node/elisp/Using-Interactive.html)

[http://www.gnu.org/software/emacs/manual/html_node/elisp/Interactive-Call.html](http://www.gnu.org/software/emacs/manual/html_node/elisp/Interactive-Call.html)

# webkit - 在 webkit 中不考虑 CSS 位置、边界半径、溢出 - 其他解决方案？

> ID：10366751
> 
> 赞同：4
> 
> 时间：2012-04-28T19:18:50.803
> 
> 标签：webkit, position, overflow, css

所以我有一个假的 iOS 5 风格的小开关，我使用的技术是使用较小的 div 作为视口，使用较大的 div 作为通过该视口可见的内容。它在 webkit 中完全失败了，因为除了在任何子元素上设置静态之外的位置，它在计算溢出为隐藏时不考虑边界半径。

[对 jsfiddle 的原创努力](http://jsfiddle.net/B3yV4/1/)

[jsfiddle上的解决方案](http://jsfiddle.net/pfp3K/1/)

真的，我想知道3件事：

1.  为什么 webkit 还没有确认这是一个错误呢？（https://bugs.webkit.org/show_bug.cgi?id=72619）
2.  人们知道这个错误是否还有其他解决方法 - 特别是对于我描述的视口技术？
3.  更多的是旁注，真的。视口技术是否有我应该称呼它的实际正式名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T12:52:05.540

我不确定我真的理解你是怎么做到的。这对我来说似乎很简单：

[http://jsfiddle.net/5qs26/](http://jsfiddle.net/5qs26/)

# c# - 如何在 C# 中仅从 html 中获取父标记文本

> ID：10366752
> 
> 赞同：1
> 
> 时间：2012-04-28T19:18:55.677
> 
> 标签：c#, html

我实际上是在尝试从具有一些子标签的标签中获取文本

**例如**：

```
<p><span>Child Text </span><span class="price">Child Text</span><br />
I need this text</p> 
```

这就是我正在尝试的

```
HtmlElement menuElement = browser.Document.GetElementsByTagName("p");
String mytext = menuElement.InnerHtml;   //also tried innerText,OuterHtml,OuterText 
```

**更新：**我认为我必须使用 Htmlagilitypack，所以现在我的问题是如何使用 htmlagilitypack lib 来做到这一点，我是新手。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:49:18.430

从使用正则表达式到网络抓取库，有很多方法。我建议您使用 htmlagilitypack ，您可以通过 xpath 准确解决您需要的内容。将引用和命名空间添加到 HtmlAgilityPack 并且我正在使用 linq（这需要 .net 3.5 或更高版本）以及下面的代码，您可以做到这一点。

```
using HtmlAgilityPack;
using System.Linq; 
```

// 这些引用必须可用。

```
 private void Form1_Load(object sender, EventArgs e)
        {
            var rawData = "<p><span>Child Text </span><span class=\"price\">Child Text</span><br />I need this text</p>";
            var html = new HtmlAgilityPack.HtmlDocument();
            html.LoadHtml(rawData);
            html.DocumentNode.SelectNodes("//p/text()").ToList().ForEach(x=>MessageBox.Show(x.InnerHtml));
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:33:57.000

如果您可以将“需要此文本”放在带有 id 的 span 中，那就容易多了——然后您只需抓住该 id 的 .innerHTML()。如果您不能更改标记，您可以获取 menuElement 的 .innerHTML() 和字符串匹配“
”之后的内容，但这很脆弱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T21:00:51.387

您可以通过将 DocumentText 拆分为不同的部分来获取文本。

```
string text = "<p><span>Child Text </span><span class="price">Child Text</span><br />I need this text</p>";
text = text.Split(new string{"<p><span>Child Text </span><span class="price">Child Text</span><br />"}, StringSplitOptions.None)[1];
// Splits the first part of the text, leaving us with "I need this text</p>"
// We can remove the last </p> many ways, but here I will show you one way.
text = text.Split(new string{"</p>"}, StringSplitOptions.None)[0];
// text now has the value of "I need this text" 
```

希望这可以帮助！

# rdf - 猫头鹰 - protege 没有正确推断？如何准确定义一个“素食主义者”类？

> ID：10366754
> 
> 赞同：5
> 
> 时间：2012-04-28T19:19:00.557
> 
> 标签：rdf, semantic-web, ontology, owl, protege

我已经被困了两天，试图理解为什么以下场景不起作用：

截图在这里：[http ://dl.dropbox.com/u/4677548/screenshots.html](http://dl.dropbox.com/u/4677548/screenshots.html)

我有一个 VegetarianFood 类（食物的子类），它等同于“食物和（鸡蛋或 MilkAndDerivates 或 VeganFood）”，如您在屏幕截图 1 中所见

VeganFood 类，反过来，相当于其他类（NutsAndSeeds、Cereals、Fruit 等） screenshot 2

如您所见，有两个人（切达奶酪和腰果）被创建为 MilkAndDerivates 和 NutsAndSeeds screenshot 3，他们被正确推断为 VegetarianFood 和 VeganFood 成员

然后，我使用对象属性 hasIngredient 截图 4 和 5 创建了两个个体作为食谱，一个仅使用腰果 (PastaVega)，另一个使用切达干酪和腰果 (PastaVege)

并且它们被推断为Recipe...但没有一个属于VegatarianRecipe和VeganRecipe的类别，定义如下截图6和7

我没有线索，为什么他们没有被推断为 VegetarianRecipe（或素食主义者）？我错过了什么？

编辑：

如果我将 VegetarianRecipe（或素食主义者）从“Recipe and (hasIngredient ONLY VegetarianFood)”更改

到“食谱和（有一些素食）”

截图 8

显示了个人的收据，但这当然不是我想要做的，因为这样它将包括混合肉类和素食的食谱。那么如何定义一个vegetarianrecipe 和veganrecipe 类以允许推理者正确推断出一个食谱是素食还是纯素食？？？？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T02:02:39.567

您已经发现了 OWL 推理使用开放世界假设这一事实的结果。

您的`PastaVege`食谱未被推断为 a的原因`VegetarianRecipe`是，尽管您在食谱中明确列出的成分确实都是`VegeratianFood`实例，但很可能您的食谱中某些当前未知的成分不是素食。

由于您的限制`VegetarianRecipe`是*所有*成分都应该是 VegetarianFoods（不仅仅是我们目前知道的那些），因此无法明确得出（在开放世界中）您的食谱确实是`VegetarianRecipe`.

有很多方法可以解决这个问题，但没有一种方法能真正做到你想要的——你需要从稍微不同的角度来处理它。

无需深入了解确切的建模细节：虽然根据您当前的模型很难推断出一个食谱是否是素食主义者，但推断出一个食谱是否不是素食主义者则相对简单；任何含有至少一种非素食成分的食谱都是非素食食谱。

另一种方法是您创建一组封闭的（素食）成分（通过`oneOf`约束使用 OWL 枚举类），但这对您的模型来说是一个重大变化，当然必须在其中列出所有可能的成分是很乏味的这种时尚。

# php - 从文本框中获取值

> ID：10366761
> 
> 赞同：2
> 
> 时间：2012-04-28T19:19:43.393
> 
> 标签：php

我想在 PHP 中获取文本框的值，当我尝试这个时：

```
<form method=post action="update.php">
<input type="text" name="Hex" />
<input type="submit" value="OK" />  
</form> 
```

```
<?php
$test = $_POST['Hex'];
echo $test;
?> 
```

我只是得到错误：

> 未定义索引：十六进制

我用谷歌搜索无济于事；所以请有人帮助我！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T11:06:32.150

i think the issue is with the **quotation marks**, @GuiceU you forgot to add the quotes to post.

Just replace your **method = post** with **method="post"**

HTML code:

```
<form method="post" action="update.php">
<input type="text" name="Hex" />
<input type="submit" value="OK" />  
</form> 
```

php code:

```
<?php
               $test = $_POST['Hex'];
               echo $test;
?> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-28T19:55:19.047

我希望这可以帮助你：

```
 <?php
if (isset($_POST['submit'])) {
$test = $_POST['Hex'];
echo $test;
} else { ?>
<form method="post" action="">
<input type="text" name="Hex" />
<input type="submit" value="OK" name="submit" />  
</form>
<?php } ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:26:49.943

你的代码看起来不错。不过，你可以试试这个：

使您的表格如下所示：

```
<form method="post" action="update.php"> 
```

并尝试使用`$_REQUEST`而不是`$_POST`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T07:36:49.013

在脚本开头使用

```
<?php error_reporting(E_ALL ^ E_NOTICE); ?> 
```

# symfony - 这可能在路由前缀中有占位符吗？

> ID：10366763
> 
> 赞同：4
> 
> 时间：2012-04-28T19:19:54.223
> 
> 标签：symfony, url-routing

我已经阅读了[有关路由的 Symfony 文档，](http://symfony.com/doc/current/book/routing.html)但没有找到有关如何在路由前缀中包含占位符的任何信息。有人可以给我建议吗？

我尝试创建如下前缀：

```
resource: "@JobsBundle/Resources/config/routing/jobs.yml"
  prefix:   /{culture}/jobs
  defaults: {culture: en} 
```

但我收到错误：

> 在渲染模板期间抛出异常（““jobs”路由缺少一些强制参数（“culture”）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:23:46.773

在 2.0.x 版本中无法在路由前缀中使用占位符。您必须等到 2.1 版发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T21:25:56.253

您是否尝试将默认值与 JobsBundle/Resources/config/routing/jobs.yml 中的路由一起使用？

# javascript - jquery获取span的值是空的，html不是吗？

> ID：10366769
> 
> 赞同：1
> 
> 时间：2012-04-28T19:20:44.273
> 
> 标签：javascript, jquery, html

我有 4 个 div，里面有一个随机数

调用`$("#result1 span").text()`时输出为空白。但是，当调用`$("#result1 span").html()`输出时会给出值。

如何在没有 html 的情况下获得价值？

输出是这样的：

```
<style type="text/css">
        #number {position:relative; top:-225px;left:584px;width:230px;height:10px;}
        #number span {padding:14px; margin:2px; color:orange; font-size:30px;}
        #number input:hover{opacity:0.9; filter:alpha(opacity=90);}
        #number input{opacity:1.0; filter:alpha(opacity=100);}
        #generate {position:relative; top:35px; left:-1px; width:95px; height:25px;}
        #reset {position:relative; top:35px; left:5px; width:95px; height:25px;}
    </style>1 
```

我需要的值就在结束`</style>`标记之后`"1"`

完整的html：

```
<div id="number">
<span id="result1"></span>
<span id="result2"></span>
<span id="result3"></span>
<span id="result4"></span>
<button id="generate">Generate</button>
<button id="reset">Restart</button>
</div> 
```

Javascript：

```
$('#result1').html((Math.random() * 10) >> 0);
$('#result2').html((Math.random() * 10) >> 0);
$('#result3').html((Math.random() * 10) >> 0);
$('#result4').html((Math.random() * 10) >> 0); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:41:01.130

我想我看到了你的问题。$("#result1 span").text() 女巫将等价于 $('#result1').find('span') 将找到嵌套在 "#result1" 中的第一个跨度的文本

看起来“#result1”没有任何嵌套跨度，实际上您想要“#result1”的跨度文本值。

如果我是正确的 $('#result1').text() 是您正在寻找的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:25:49.260

试试这个：（这应该一一返回所有4个跨度内的文本）

```
$("#result1 span").each (function () {
    console.log($(this).text());
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:33:02.687

至少有一件事——你的选择器是错误的。$("#result1 span").text() 不会给你任何东西，因为 result1 中没有跨度*，* result1*是*一个跨度。将您的选择器更改为 $("#result1") 并查看您得到的结果。

只需更改选择器对我有用：

[http://jsfiddle.net/ccross59/TnbCc/1/](http://jsfiddle.net/ccross59/TnbCc/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T19:34:58.183

如果您可以将“需要此文本”放在带有 id 的 span 中，那就容易多了——然后您只需抓住该 id 的 .text()。如果无法更改标记，则可以获取 span 的 .html() 和字符串匹配“”之后的内容，但这很脆弱。

# java - 在 ListView [android 应用程序] 中删除一行

> ID：10366784
> 
> 赞同：0
> 
> 时间：2012-04-28T19:22:44.330
> 
> 标签：java, android, listview, adapter

从 alertDialog 按钮按 YES 按钮后，如何删除列表视图中的一行？！

在我的代码`Cancel`中是一个我想要的按钮，如果我按下它，它应该做两件事：

1.  给我看 alertDialog ：我通过调用一个函数来做到这一点`ShowDialogCancel()`，
2.  按下后：在此警报对话框中为 YES ==> 应删除该行！

我尝试了很多方法，但在我按下警报对话框中的“是”按钮之前它删除了该行

任何建议

莫奈拉...

我的适配器类：

```
public class MyCasesListAdapter extends BaseAdapter {
    private MyPage myPage;
    private List<MyCaseClass> listOfCases;
    private Activity parentActivity;

    // TODO test
    MyCaseClass entry;

    // TODO delete it not imp.
    public MyCasesListAdapter() {

        super();

    }

    public MyCasesListAdapter(MyPage mypage, List<MyCaseClass> listOfCaseParameter, Activity parentActivity) {
        this.myPage = mypage;
        this.listOfCases = listOfCaseParameter;
        this.parentActivity = parentActivity;
    }
...
    public View getView(int position, View convertView, ViewGroup viewGroup) {

         entry = listOfCases.get(position);
         //this.getitem(position)
        if (convertView == null) {

            LayoutInflater inflater = (LayoutInflater) myPage
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = inflater.inflate(R.layout.mypage_row, null);
          }

        // this is row items..
        // Set the onClick Listener on this button
        Button ConfExpandRegion = (Button) convertView.findViewById(R.id.expand);
        Button Cancelb = (Button) convertView.findViewById(R.id.cancelCase);
        TextView tvCase = (TextView) convertView.findViewById(R.id.mypage_name);

        // To be a clickable button
        ConfExpandRegion.setFocusableInTouchMode(false);
        ConfExpandRegion.setFocusable(false);

        ConfExpandRegion.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                myPage.ShowingDialogExpand();
            }
        });

        // To be a clickable button
        Cancelb.setFocusableInTouchMode(false);
        Cancelb.setFocusable(false);
        Cancelb.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                entry = (MyCaseClass) v.getTag();
                int caseid= entry.getID();
                myPage.ShowingDialogCancel(caseid);

                Toast.makeText(myPage, "inside calling", 0).show();

                //MyCaseClass entry = (MyCaseClass) v.getTag();
                //listOfCases.remove(entry);

                // listPhonebook.remove(view.getId());
                notifyDataSetChanged();
            }
        });

        // Set the entry, so that you can capture which item was clicked and
        // then remove it
        // As an alternative, you can use the id/position of the item to capture
        // the item
        // that was clicked.
        ConfExpandRegion.setTag(entry);
        Cancelb.setTag(entry);

        // btnRemove.setId(position);

        return convertView;
    }

    public void onClick(View view) {
        MyCaseClass entry = (MyCaseClass) view.getTag();
        listOfCases.remove(entry);
        // listPhonebook.remove(view.getId());
        notifyDataSetChanged();

    }

} 
```

从我的页面类：

```
public void  ShowingDialogCancel(){
        final AlertDialog alertDialog2 = new AlertDialog.Builder(this).create();
        alertDialog2.setTitle("Conformation?");
        alertDialog2.setMessage("Are you sure you want to cancel x cases?");

        alertDialog2.setButton("Yes", new DialogInterface.OnClickListener() {
               public  void onClick(DialogInterface dialog, int which) {

                     CancelMsg = "Case_ID cancel";

                   if (!b) {
                        try {
                            // Should write server number here + the chatting must be pushed above 
                            sendSMS("0000", CancelMsg);
                            Toast.makeText(MyPage.this, "Cancelation request sent", Toast.LENGTH_LONG)
                                    .show();

                        } catch (Exception e) {
                            // TODO Auto-generated catch block
                            Toast.makeText(MyPage.this, e.getMessage(),
                                    Toast.LENGTH_LONG).show();
                        }

                    }
                   }
            });

            alertDialog2.setButton2("No", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int which) {
                // here you can add functions
                // Do nothing 

                   Toast.makeText(MyPage.this, "inside No", 0)
                    .show();

               }
            });

            alertDialog2.setIcon(android.R.drawable.ic_dialog_alert);
            alertDialog2.show();

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:48:39.597

使用您拥有的代码，如果您将引用传递给`ShowingDialogCancel(MyCasesListAdapter adapter, View view)`然后您可以添加如下内容：

```
adapter.onClick(view); 
```

到您的“是”按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:36:53.723

如果您有要删除的职位，可以致电

```
listOfCases.remove(position);
notifyDataSetChanged(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:31:18.717

你如何填充你的列表视图？如果您使用的是数组，则可以从数组中删除数据并重新加载列表视图。

# java - 正则表达式：String.split 和 Pattern.matches 彼此不一致

> ID：10366785
> 
> 赞同：1
> 
> 时间：2012-04-28T19:22:56.560
> 
> 标签：java, regex

我正在练习我的正则表达式外观，为此，我试图从 SQL 插入语句中提取表名。我有正则表达式`(?<=INSERT INTO )\w+(?= (\(|VALUES).+)`，我正在 String 上测试它`INSERT INTO tests VALUES (regex, test)`。虽然我知道我的正则表达式没有精心完成，但我希望它能够匹配`tests`我输入的子字符串。

`String.split`我正在使用 Java 的正则表达式引擎，并且正在打印我使用正则表达式和使用正则表达式时发生的结果`Pattern.matches`。我得到以下看似矛盾的结果

```
regex> (?<=INSERT INTO )\w+(?= (\(|VALUES).+)
string> INSERT INTO tests VALUES (regex, test)
[INSERT INTO ,  VALUES (regex, test)]
regex> (?<=INSERT INTO )\w+(?= (\(|VALUES).+)
string> INSERT INTO tests VALUES (regex, test)
false 
```

现在只是为了记录下来，产生第一个结果的代码是

```
Arrays.toString(searchString.split(regex)) 
```

而第二个来自

```
Pattern.matches(regex, searchString) 
```

不是`split`将匹配项上的字符串拆分为其参数吗？这意味着正则表达式匹配`tests`，因此结果`[INSERT INTO , VALUES (regex, test)]`。那么，为什么`Pattern.matches`返回 false 呢？我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T19:40:31.613

如果您使用以下方法遇到同样的问题，我会尝试：

```
Pattern p = Pattern.compile(yourRegex);
Matcher m = p.matcher(inputString); 
```

并检查是否`m.find()`返回 true

`Pattern.matches`期望整个字符串匹配 - 它可能有环视问题，因为这些是零宽度断言，因此匹配的字符被丢弃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:47:07.580

Just to add a little bit to Joanna's answer: Lookaheads and lookbehinds don't participate in the match. `Pattern.matches` requires that the regex match starting at the beginning of the string going all the way to the end. Since you have a positive lookbehind (`INSERT INTO`), the match starts at `text` which is not at the beginning. Likewise, the lookahead at the end means there is no match at the end either.

`split` works as expected because it doesn't require the match to start at the beginning.

# java - 设置 LayoutParams 不透明度

> ID：10366786
> 
> 赞同：0
> 
> 时间：2012-04-28T19:23:04.977
> 
> 标签：java, android, opacity, layoutparams

我有一些代码（android 源），我试图设置不透明度`LayoutParam`

首先，我有这个

```
mLayoutParams = new WindowManager.LayoutParams(
            ViewGroup.LayoutParams.MATCH_PARENT,
            height,
            WindowManager.LayoutParams.TYPE_STATUS_BAR,
            WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE
                | WindowManager.LayoutParams.FLAG_TOUCHABLE_WHEN_WAKING
                | WindowManager.LayoutParams.FLAG_SPLIT_TOUCH,
            // Setup statusbar transparency preference
             mOpacity != 100 ? PixelFormat.TRANSPARENT : PixelFormat.RGB_565); 
```

然后我注册了一个 SettingsObserver，用于重新加载 mOpacity，但是如果我将 Opacity 设置回 100，它就不会`RGB_565`像`LayoutParams`定义的那样是`TRANSPARENT`Format。我想知道是否有某种方法可以设置这个独立的，因为如果我添加观察整个代码，它最终会创建无限`Layouts`并覆盖它们。另一件有用的事情是如何在创建新的之前销毁 mLayoutParams。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:39:16.703

很容易固定。我刚换

```
 mOpacity != 100 ? PixelFormat.TRANSPARENT : PixelFormat.RGB_565 
```

仅由

```
 PixelFormat.TRANSPARENT 
```

然后，当我想设置 100% 不透明度时，我只发送了一个等于 100 的十六进制值 :)

# ios - 查明某人何时购买了您的应用

> ID：10366798
> 
> 赞同：3
> 
> 时间：2012-04-28T19:25:28.203
> 
> 标签：ios, xamarin.ios, app-store

有谁知道我怎样才能找到有人在应用程序中使用 MonoTouch 购买我的应用程序的日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T20:43:29.883

我认为您无法获取应用程序本身的信息 - 仅适用于应用内购买（您可以在其中获得[收据](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/VerifyingStoreReceipts/VerifyingStoreReceipts.html)）。

您可能可以根据安装日期（例如文件时间戳）来*猜测*日期，但这不包括重新安装应用程序（同一设备），在另一台设备上安装应用程序......

它与将注册“首次使用”日期的服务器应用程序通信的另一种方式（再次必须考虑重新安装和多个设备的问题）。

根据您需要此信息的**原因**，上述信息可能有用，或者只是更复杂解决方案的一部分......

# ruby - 从远程 svn 存储库中读取文件的内容，而不在本地签出

> ID：10366800
> 
> 赞同：5
> 
> 时间：2012-04-28T19:25:35.987
> 
> 标签：ruby, svn, bash

（提前感谢，SOers！）

**我试图解决的问题**

有没有办法（例如，在 bash 或 ruby​​ 中）读取远程 svn repo 上文件的内容，而无需先在本地检查它并在本地读取它，因为我有它的路径（例如，“svn+ssh ://svn.something/folder/morefolder/something.txt")

**我尝试过或想尝试过的事情**

没有类似`more`或选项`less`的对应物。`svn`查看 svn 命令的可用选项列表，我能想到的最接近的实现方式是

1.  使用`svn praise [svn file path]`, 然后
2.  相应地解析它（在我的程序或 bash 中）以提取我想要的内容。

**附加说明**

我在 StackOverflow 上搜索并环顾四周，似乎没有其他人（或者至少我还没有遇到任何人）讨论过这个问题/用例。对于这种特定需求，我有正当理由，但我确实想知道我是否在思考过程中遗漏了任何东西。

如果我在这个问题中遗漏任何信息，请告诉我。再次感谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-28T19:36:08.667

你试过svn cat吗？我相信这正是您正在寻找的功能。

这是文档 [http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.cat.html](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.cat.html)

此命令方便地将远程存储库 URL 的内容输出到标准输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-09T23:50:38.953

您可以右键单击 repo > 单击“浏览”这将打开 repo 的网络副本，然后您可以找到您感兴趣的文件并单击它以阅读内容。

# objective-c - 如何在我从其中一个控件的子类中对其放置控件的视图中使用方法

> ID：10366801
> 
> 赞同：0
> 
> 时间：2012-04-28T19:25:42.947
> 
> 标签：objective-c, cocoa, nstextfield, nsevent

我将一个 NSTextField 子类化，并在子类中使用一个事件方法（keyUp），当用户按下 Enter 键时，我想在主视图中调用一个方法（我将 NSTextFiled 放在上面）。我使用下面的代码，但不知道如何调用主视图中的具体方法

```
- (void)keyUp:(NSEvent *)theEvent
{
    NSString *theArrow = [theEvent charactersIgnoringModifiers];
    unichar keyChar = 0;
    keyChar = [theArrow characterAtIndex:0];
    if ( keyChar == NSEnterCharacter )
    {
        //call method that exist in main view   
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:37:06.157

这个应该做...

```
SEL sel = @selector(textFieldDidPressEnter:);

if (self.delegate && [self.delegate respondsToSelector:sel]) {
    [self.delegate performSelector:sel withObject:self];
} 
```

然后确保您希望收到此消息的类设置为委托。更完整的答案是还声明 textFieldDidPressEnter: 作为委托协议的一部分。 这是有关如何做到这一点[的好资源。](https://stackoverflow.com/questions/732701/how-to-extend-protocols-delegates-in-objective-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T20:14:24.267

1.在主视图集： `textField.delegate=self;`

2.添加到mainview.h`<NSTextFieldDelegate>`和subclass.h

3.使用此代码而不是注释

```
if ( self.delegate && [self.delegate respondsToSelector:@selector(textFieldDidPressEnter:)] ) 
            [self.delegate performSelector:@selector(textFieldDidPressEnter:) withObject:self]; 
```

4.在mainview.m中实现这个方法

```
-(void)textFieldDidPressEnter:(NSTextField *)txt
{

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T20:15:36.240

```
if ( [self.delegate respondsToSelector:@selector(textFieldDidPressEnter:)] ) 
    [(id)self.delegate textFieldDidPressEnter:self]; 
```

无需使用`performSelector:`

# java - 复杂事件处理

> ID：10366803
> 
> 赞同：2
> 
> 时间：2012-04-28T19:25:58.630
> 
> 标签：java, event-handling, design-patterns

需要一些关于设计事件处理系统的建议。在高层次上，我的 Java 服务器接收各种请求，执行并响应（同步和异步）它们。

流程如下：

a) 低级类从客户端接收事件。此类具有对 MessageRouter 类的引用。一旦它得到事件，它就简单地调用 MessageRouter 上的 route(Event event)。

b) MessageRouter 类将事件排队并在一个单独的线程中，确定消息的类型，找到适当的处理程序并将消息传递给它。

c) 处理程序执行消息。

d) ResponseRouter 收集响应并将其写回。

我的问题是：

1）我应该如何设计 c）因为我需要引用 4-5 个其他“管理器”类来执行请求。此外，c) 是否应该引用 d) 以将响应路由回？

2）类似地，d）需要引用其他类来写回响应，因为它们可以同步和异步完成。ResponseRouter 是否应该引用它需要的所有类？

主要是，我正在寻找一种设计模式（或它们的组合）来以高效和优雅的方式执行事件及其响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-09T15:43:27.737

至于 Q2 的答案，因为处理程序可以异步执行，我建议在 MessageRouter 中处理请求和响应会更直接，也许可以参考实现 RequestRouter 和 ResponseRouter 接口的其他 2 个对象。

当处理程序完成时，它可以以同步或异步方式将其结果返回给 MessageRouter。

这种方式处理程序不需要对 ResponseRouter 的引用。

# perl - 如何使用 Perl 修改文件，在双引号之间添加和替换字符串

> ID：10366817
> 
> 赞同：-1
> 
> 时间：2012-04-28T19:27:47.237
> 
> 标签：perl

在以下两种情况下，如何使用 Perl 修改文件（将以下内容作为其内容的一部分）。字符串的正确位置（写在正确的行中，从第一个开始有 2 个空格）很重要。此外，在 ${P}/TEST 中的以下 TEST 不是恒定的，并且在运行过程中会发生变化；所以我们不应该对它使用匹配函数。原始文件是：

```
! List of Campaigns
! -----------------
CAMPAIGN 1
  "${P}/TEST"
  ## widget = uniline 
```

1) 在“${P}/TEST”下添加另一个带双引号的字符串，例如“${P}/XXXXXX”（程序中之前定义了XXXXXX）。注意活动的数量！所以它会变成：

```
! List of Campaigns
! -----------------
CAMPAIGN 2
  "${P}/TEST"
  "${P}/XXXXXX"
  ## widget = uniline 
```

2）替换“${P}/XXXXXX”而不是“${P}/TEST”。所以它会变成：

```
! List of Campaigns
! -----------------
CAMPAIGN 1
  "${P}/XXXXXX"
  ## widget = uniline 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T23:09:05.303

这应该给你一个想法。我看到了需要`add_campaign`和`replace_campaign`操作，然后从那里拿走了它。您的数据在`__DATA__`伪文件中。

程序输出：

```
$ campaigns.pl
! List of Campaigns
! -----------------
CAMPAIGN 3
  "${P}/TEST"
  "${P}/MONKEY"
  "${P}/BLUE"
  ## widget = uniline 
```

节目来源：

```
#!/usr/bin/perl

use strict;
use warnings;

### main program

# read entire file contents into $data
my $data = do { local $/; <DATA> };

# make an entry in %campaigns for each campaign in $data. Each entry's key 
# is the campaign's name. Its value is irrelevant. We use 1.
my %campaigns;
my $last_campaign_offset;   # index of last campaign found
while ( $data =~ /  "\$\{P\}\/(\w+)"/g ) {
  $campaigns{$1}        = 1;
  $last_campaign_offset = index($data, $');
}

add_campaign('CAMEL');
add_campaign('BLUE');
add_campaign('TEST');   # no-op: campaign already exists
replace_campaign('CAMEL', 'MONKEY');
print $data;

### subroutines

### append a new '  ${P}/FOO' campaign to the data
sub add_campaign {
  my $new_cpn = shift;
  return if exists $campaigns{$new_cpn};

  $new_cpn = qq[\n  "\${P}/$new_cpn"];
  substr($data, $last_campaign_offset) 
    = $new_cpn . substr($data, $last_campaign_offset);
  $last_campaign_offset += length($new_cpn);

  # lastly, increment n in the "CAMPAIGN n" substring
  $data =~ s/(?<=CAMPAIGN )(\d+)/$1 + 1/e;
}

### replace the name of an existing campaign with a new one
sub replace_campaign {
  my ($old_cpn, $new_cpn) = @_;
  $data =~ s/(?<=  "\$\{P\}\/)$old_cpn/$new_cpn/;
}

__DATA__
! List of Campaigns
! -----------------
CAMPAIGN 1
  "${P}/TEST"
  ## widget = uniline 
```

# .net - 与此相反？

> ID：10366820
> 
> 赞同：-2
> 
> 时间：2012-04-28T19:28:25.447
> 
> 标签：.net, reverse, if-statement

我有这个“如果”声明，但我今天真的搞砸了，想不出如何扭转它变得更好......

```
if (plist.Exists("No Update Ramdisk") && plist.Get<PlistBool>("No Update Ramdisk").Value)
{
}
else
{
    ...
} 
```

只是为了让您不要问 plist 是什么，我在 .NET 中编写了一个 plist 解析器，我正在扫描它的值

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T19:42:49.817

你至少有三种可能

*   交换 THEN 和 ELSE 块
*   反转条件`if (! A)`
*   使用德摩根`(A && B) == !(!A || !B)`

[http://en.wikipedia.org/wiki/De_Morgan%27s_laws](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T19:31:01.523

要反转*，`true`表达式应该是`false`; 和`and`运营商应该是`or`）：

```
if (!plist.Exists("No Update Ramdisk") 
    || !plist.Get<PlistBool>("No Update Ramdisk").Value)
{
    ...
} 
```

[*假设`Get<PlistBool>("No Update Ramdisk").Value`是`bool`.]

# python - Python ImportError 无法导入 urandom 自 Ubuntu 12.04 升级

> ID：10366821
> 
> 赞同：54
> 
> 时间：2012-04-28T19:28:25.510
> 
> 标签：python, ubuntu, random

将 Ubuntu 升级到 Precise Pangolin (12.04)，Python 的 Random 现在坏了……我怀疑其他东西也可能坏了。如何修复 Python？

```
 File "/usr/lib/python2.7/random.py", line 47, in <module>
    from os import urandom as _urandom
ImportError: cannot import name urandom 
```

*唉，可怜的 Python！我认识他，Random，一个无限玩笑的模块，很可能是混乱的。他在他的 randint() 上已经让我厌烦了一千次了，现在在我的工作空间里是多么可恶！我的异常处理程序随之而来。*

*编辑*在 virtualenv 中运行

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-04-28T19:42:16.247

这是你的问题吗？

[https://bugs.launchpad.net/ubuntu/+source/python-defaults/+bug/989856](https://bugs.launchpad.net/ubuntu/+source/python-defaults/+bug/989856)

似乎是在虚拟环境中运行它引起的，并且有一个解决方法。

顺便说一句，这是谷歌的最高结果。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-05-02T13:57:59.697

我在升级到 12.10 和升级到 16.04 时遇到了同样的问题（在 16.04 中，消息是`no module named datetime`。）

为了解决这个问题，只需在相同的安装上运行 virtualenv 就可以了。给它一个`--no-site-packages`标志来保存你的模块：

```
$ virtualenv --no-site-packages ~/lib/virtualenv/netunong
Overwriting /home/adam/lib/virtualenv/netunong/lib/python2.7/site.py with new content
New python executable in /home/adam/lib/virtualenv/netunong/bin/python
Installing distribute.....<skippping dots, of course>.......done.
Installing pip................done.
Overwriting /home/adam/lib/virtualenv/netunong/bin/activate with new content
Overwriting /home/adam/lib/virtualenv/netunong/bin/activate_this.py with new content 
```

由于我所有的 virtualenvs 都在同一个目录中，所以我只运行了：

```
$ ls | xargs -I{} virtualenv  --no-site-packages {} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-30T04:24:03.360

我遇到了同样的错误并通过重新运行 virtualenv（例如，`virtualenv --no-site-packages ~/venv/myvirtualenv/`）来修复它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-02T11:35:13.317

如果您使用 apt-get 安装它`wget`来获取它，另一种解决方案是删除 pip

```
wget https://raw.github.com/pypa/pip/master/contrib/get-pip.py 
```

然后运行

`python get-pip.py`或者`sudo python get-pip.py`如果您没有使用 root 登录。

这对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T19:42:08.453

好的，也许它只是没有配置？检查[此](http://linux.about.com/library/cmd/blcmdl4_urandom.htm)站点，并查看**配置**部分。

# java - 有序多线程消息处理

> ID：10366824
> 
> 赞同：1
> 
> 时间：2012-04-28T19:28:51.500
> 
> 标签：java, concurrency, messaging

有序多线程消息处理的常用方法是什么？

考虑以下示例：我有一个将数字发送到队列中的发布者：`1, 2, 3, 4, 5, 6, 7`

我的目标是按顺序处理奇数和偶数。

我知道的一种可能的解决方案是每个线程有一个单独的队列并根据`n % m`标准拆分原始队列。

我担心的是数字可能分布不均，我最终会得到一些线程来减少工作量。

我一直在考虑实现自定义队列，它将检查具有相同标准的队列元素是否正在被其他线程处理，如果是，则尝试找到另一个。这可能行得通，我试图实现一些东西，但它变得复杂并且更难测试。这就是为什么我首先尝试找到问题的现有解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:35:40.293

不是答案，但评论太长了。

> 我的目标是按顺序处理奇数和偶数。

在这种情况下，赔率线程和偶数线程不能超过一个。您需要顺序运行的任何原因？您是否使用`process(2)`运行的结果`process(4)`？

> 我担心的是数字可能分布不均，我最终会得到一些线程来减少工作量。

可能，但是如何在不破坏顺序约束的情况下将更多工作分配给空闲线程？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T20:06:37.490

如果您有 2 种类型并且每种类型都必须按类型顺序处理，则您只能有 2 个线程。如果没有其他类型的消息要处理，则只有 1 个线程可以工作。

在这种情况下，使用 2 个队列并根据类型将消息放入其中并让每个线程消耗一个队列。您可以使用第三个线程来分发消息，但如果一个线程有一个完整的队列，您必须等到您可以使用来自原始生产者的消息，除非您有办法单独请求每种类型或者您可以丢弃消息。您在这里受到自己的约束。

除了理论部分，您可能还想查看 BlockingQueues & ExecuterServices，如该答案：[Producer/Consumer threads using a Queue](https://stackoverflow.com/a/2332581/995891)

# c# - 如何在vbscript中将对象作为方法参数传递

> ID：10366825
> 
> 赞同：3
> 
> 时间：2012-04-28T19:29:09.690
> 
> 标签：c#, object, vbscript

我尝试在 vbscript 中进行小测试，因此在 C#（我是新手）中创建了非常非常简单的 dll，并希望在 vbscript 中使用它。

C# 代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Runtime.InteropServices;

namespace myNamespace
{
    public class myClass1
    {
        public string sVariable1="Variable content";
    }

    public class myClass2
    {
        public myClass1 myMethod2(myClass1 test)
        {
            return test;
        }
    }
} 
```

和VBScript

```
Set oClass1 = CreateObject("myNamespace.myClass1")
Set oClass2 = CreateObject("myNamespace.myClass2")
WScript.Echo oClass1.sVariable1

Set return = oClass2.myMethod2(oClass1)
WScript.Echo return.sVariable1 
```

运行 vbscript 后，在控制台上我通过第一个回显显示“变量内容”，接下来我有错误“microsoft vbscript 运行时错误无效过程调用或参数：'oClass2.myMethod2'”。

我可以这样传递对象吗？

参考MK2的注释。问题不在于方法的返回类型，因为以下代码正在运行。

```
 public myClass1 myMethod2()
        {
            myClass1 test = new myClass1();
            return test;
        } 
```

和vbs

```
Set return = oClass2.myMethod2() 
```

现在在控制台上我有

```
Variable content
Variable content 
```

但是如何在 vbs 中传递 myClass1 对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T12:21:22.467

好的，我找到了解决方案。在 C# 中作为参数 myMethod2 我将 ref 声明为对象，然后我使用类型转换。像这样的东西：

```
 public myClass1 myMethod2(ref object refObject)
    {
        myClass1 test = (myClass1)refObject;
        return test;
    } 
```

现在 vbscript 工作正常。我希望它对某人有帮助:)

# gwt - GWT 缓存文件的 HTTP GET 返回截断的文件

> ID：10366826
> 
> 赞同：1
> 
> 时间：2012-04-28T19:29:22.657
> 
> 标签：gwt, caching, truncate

我开发了一个 GWT 应用程序，它适用于我 99% 的客户……但是，我最近遇到了几个在运行该应用程序时遇到问题的客户。

经过进一步调查，我发现其中一个 .cache 文件在下载时被损坏，并且文件的某些部分被截断......？！

我无法发现这种奇怪失败的根本原因......这是我所有的发现+我知道的事实：

*   问题发生在 IE 和 Chrome 中，因此与浏览器无关。
*   我注意到客户在他的机器上遇到了一些恶意软件问题，这导致谷歌搜索结果（一旦点击）导致一些 ab?? 某网站（这实际上只发生在 Chrome 上）
*   在机器上运行 fiddler 显示文件已完全下载，HTTP 响应为 200 == OK
*   被截断的代码位（文件中间大约有 10 个 javascript 函数）被替换为字符串 <!-ESFSECEV-TY3003------- 带有更多破折号，最后是 ----> 。 ...在谷歌中搜索这个奇怪的术语没有产生任何结果...

对此的任何帮助将不胜感激，

多谢，

巴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:02:24.847

听起来像是防火墙或网络代理问题。

我想我听说过防病毒软件会利用下载的 javascript 来“保护”用户。

# smooth - 如何在opengl中绘制平滑/抗锯齿圆？

> ID：10366828
> 
> 赞同：2
> 
> 时间：2012-04-28T19:30:09.140
> 
> 标签：smooth, antialiasing

如何在opengl中绘制平滑/抗锯齿圆？我正在使用 glBegin(GL_LINE_LOOP); 画我的圈子，但它并不顺利。我已启用：

```
glEnable( GL_LINE_SMOOTH );
glHint( GL_LINE_SMOOTH_HINT, GL_NICEST );
glEnable(GL_BLEND); 
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-02T04:38:55.690

[这已经晚了好几年，但我这样做的方式是使用本教程。](https://www.desultoryquest.com/blog/drawing-anti-aliased-circular-points-using-opengl-slash-webgl/)

但是，这仅适用于`GL_POINTS`.

为此，您还需要启用`OES_standard_derivatives`扩展。

顶点：

```
attribute mediump vec4 Position;
attribute lowp float Size;

void main(void) {
    gl_Position = Position;
    gl_PointSize = Size;
} 
```

分段：

```
#extension GL_OES_standard_derivatives : enable

void main(void) {
    lowp vec2 cxy = 2.0 * gl_PointCoord - 1.0;
    lowp float radius = dot(cxy, cxy);
    lowp float delta = fwidth(radius);
    lowp float alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);
    gl_FragColor = vec4(1.0, 1.0, 1.0, alpha);
} 
```

# asp.net - 更新命令在gridview中不起作用

> ID：10366831
> 
> 赞同：0
> 
> 时间：2012-04-28T19:30:54.053
> 
> 标签：asp.net

我的更新命令代码：

```
public void update(name,email,phone)
{
    using {sqlconnection con=new sqlconnection("some connection source"))
    {
        con.open();
        string str = "UPDATE register SET name = @name,email = @email WHERE phone = "@phone";

        using(sqlcommand cmd=new sqlcommand(str,con))
        {
            cmd.commandtype=commandtype.text;
            cmd.parameters.addwithvalue("@name",name);
            cmd.parameters.addwithvalue("@email",email);
            cmd.parameters.addwithvalue("@phone",phone);
            cmd.executenonquery();
        }
    }
} 
```

我的行更新事件是这样的：

```
string name = ((TextBox)GridView1.Rows[e.RowIndex].Cells[1].Controls[0]).Text;
string email = ((TextBox)GridView1.Rows[e.RowIndex].Cells[2].Controls[0]).Text;
int phone = Convert.ToInt32(GridView1.Rows[e.RowIndex].Cells[3].Text);

update(name, email, phone);
GridView1.EditIndex = -1;
bindgridview(); 
```

在我的桌面电话中，主键是主键，当我按下更新按钮时，它不会触发没有任何变化。谁能看到我的代码并告诉我哪里做错了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:46:11.153

`Quotation`您的更新语句中缺少简单（“），**使用**`{`后不必要并确保您的 conn 也已关闭

# java - 导出使用无限制 JCE 策略（加密）的 Java 程序

> ID：10366833
> 
> 赞同：1
> 
> 时间：2012-04-28T19:31:07.923
> 
> 标签：java, eclipse, jar, export, jce

我制作了一个使用 PBKDF2WithHmacSHA1 加密算法的 Java 应用程序，我需要下载 Unlimited JCE Policy jar。我将两个 JAR 文件放在应该存在的位置（我将它们放在我的 JDK 的 JRE 安全文件夹中），并正确命名，因此它可以在 Eclipse 中工作。

但是，当我导出它时，它仅在我从命令行运行 JAR 文件时才有效。我已经进行了一些调试，当我双击可执行/可运行 JAR 时，它属于加密/解密方法，因为它们会抛出异常。

所以，如果有人能告诉我为什么会这样以及更多，如何解决这个问题我会很感激，因为这非常重要！

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:58:33.297

好的，所以看起来分发无限制 JCE 策略的唯一方法`.jar`是在安装期间或首次运行应用程序时解压缩所需的 s 并覆盖用户计算机上的现有文件。但即便如此，这似乎也是一个成功或失败的过程。

很多人似乎正在采取的替代路线是使用 API，例如 BouncyCastle，它支持更高级别的加密，并且*可以*自由轻松地分发，即使是商业应用程序也是如此。

我想甲骨文之所以这样做，是因为以前对某些国家施加的限制现在似乎已经解除。我可能是错的，但我仍然听说 Java 正在开发更好的实现来解决这个问题！

# mysql - SQL 语句根据列之间执行的比较来确定行/记录的评级？

> ID：10366834
> 
> 赞同：1
> 
> 时间：2012-04-28T19:31:12.900
> 
> 标签：mysql, sql, postgresql

比方说，我的数据库中有一个这样的表，无论是在 POSTGRESQL 还是 MYSQL 中：-

```
video_clip_name | bad | so_so | good|
video 1         | 20  | 13    | 3   |
video 2         | 12  | 20    | 33  |
video 3         | 40  | 34    | 33  |
video 4         | 20  | 23    | 13  |
video 5         | 20  | 13    | 37  | 
```

在对三列（bad、so_so 和 good）进行比较后，我想根据最高分确定哪个视频被**评为 bad、so_so 或 good 。**假设视频 1 的评分低于其他两列。这意味着视频 1 的评分为差。

所以我的问题是如何在 POSTGRESQL/MYSQL 中编写这样的 SQL 语句，以根据**三列值之间的比较来输出每个视频的总体评分？**

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:42:05.513

我来自 MySQL 方面，但我认为以下内容也应该在 Postgres 中工作：

```
SELECT video_clip_name, CASE GREATEST(bad, so_so, good)
   WHEN bad   THEN 'bad'
   WHEN so_so THEN 'so_so'
   WHEN good  THEN 'good'
END AS rating
FROM table; 
```

但是，如果视频的最高评分出现在多个评分中（例如`bad`= 40、`so_so`= 20、`good`= 40），您并没有定义应该发生什么；在这种情况下，上面的代码总是更喜欢它在 中遇到的第一个匹配项`CASE`（即`bad`优先`so_so`于`good`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:57:56.163

许多收集评级的网站会根据收到的评级计算代表项目整体受欢迎程度的数字分数。除非您计算某种数值平均值，否则很难比较两个或多个项目的相对受欢迎程度。[Evan Miller 的这篇文章](http://www.evanmiller.org/how-not-to-sort-by-average-rating.html)将帮助您应用一个 SQL 公式，该公式在您的计算背后提供了一些严格的统计信息。在其中，他说明了以下问题陈述的一个很好的解决方案（以及几个不太好的解决方案）：

> 你是一个网络程序员。你有用户。您的用户对您网站上的内容进行评分。你想把评分最高的东西放在顶部，把评分最低的东西放在底部。你需要某种“分数”来排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:46:34.370

我不熟悉 mysql 或 postgresql 的语法细节，但对我来说，它看起来像一组 if 语句，例如；

```
if bad > so_so then
  if bad > good then 'bad'
  else 'good'
  end if
else if so_so > good then 'so so'
else 'good'
end if 
```

当然，您需要围绕它进行正确的选择。这是假设每个录像带只有一行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T19:50:51.963

`CASE`这是使用表达式的另一种方式。我使用 SQL Server 而不是 MySQL 或 PostGreSQL，但我认为这符合 ANSI SQL。样本数据和输出使用各种值。但是，如果它们都是平等的，它目前会按照*bad*、 *so_so* 和*good*的顺序选择评级。

*脚本*：

```
CREATE TABLE dbo.VideoRatings 
(
        video_clip_name VARCHAR(10) NOT NULL
    ,   bad             INT         NOT NULL
    ,   so_so           INT         NOT NULL
    ,   good            INT         NOT NULL
);

INSERT INTO  dbo.VideoRatings (video_clip_name, bad, so_so, good) VALUES
    ('video a', 1, 2, 3),
    ('video b', 2, 3, 1),
    ('video c', 3, 2, 1),
    ('video d', 2, 1, 1),
    ('video e', 1, 2, 2),
    ('video f', 1, 1, 2),
    ('video g', 2, 2, 2);

SELECT  video_clip_name
    ,   CASE 
            WHEN bad    >= so_so    AND bad     >= good     THEN 'bad'
            WHEN so_so  >= bad      AND so_so   >= good     THEN 'so_so'
            WHEN good   >= bad      AND good    >= so_so    THEN 'good'
        END AS Rating
FROM    dbo.VideoRatings; 
```

*输出*：

```
video_clip_name rating
--------------- ------
video a         good
video b         so_so
video c         bad
video d         bad
video e         so_so
video f         good
video g         bad 
```

# ruby-on-rails - 如何使用 XHR 发送附件（图像）和嵌套参数以上传钛文件？

> ID：10366838
> 
> 赞同：2
> 
> 时间：2012-04-28T19:31:56.253
> 
> 标签：ruby-on-rails, post, parameters, upload, titanium

我正在尝试将图像从手机的照片库上传到服务器。

图片库打开得很好。这是我的代码。

```
 var win = Ti.UI.createWindow({
        navBarHidden : true,
    });

    var ind = Titanium.UI.createProgressBar({
        width : 200,
        height : 50,
        min : 0,
        max : 1,
        value : 0,
        style : Titanium.UI.iPhone.ProgressBarStyle.PLAIN,
        top : 10,
        message : 'Uploading Image',
        font : {
            fontSize : 12,
            fontWeight : 'bold'
        },
        color : '#888'
    });

    win.add(ind);
    ind.show();

    var main_url = "http://10.0.0.4:3000";

    Titanium.Media.openPhotoGallery({

        success : function(event) {
            Ti.API.info("success! event: " + JSON.stringify(event));
            var imageview = event.media;

            var xhr = Titanium.Network.createHTTPClient();

            xhr.onerror = function(e) {
                Ti.API.info('IN ERROR ' + e.error);
            };
            xhr.onload = function() {
                Ti.API.info('IN ONLOAD ' + this.status + ' readyState ' + this.readyState);
            };
            xhr.onsendstream = function(e) {
                ind.value = e.progress;
                Ti.API.info('ONSENDSTREAM - PROGRESS: ' + e.progress + ' ' + this.status + ' ' + this.readyState);
            };
            // open the client
            xhr.open('POST', main_url + '/images.json');
            xhr.setRequestHeader("Connection", "close");
            // send the data
            var params = "image[attachment]=" + imassage;
            xhr.send({
                media : imageview,
                title : "helloo helllo",
                desciption : "Sample Desciption",
                username : 'lorem',
                password : 'ipsum',
            });

        },
        cancel : function() {

        },
        error : function(error) {
        },
        allowImageEditing : true
    }); 
```

但我想发送嵌套参数，如：

```
image[media] = image
image[title] = "helloo helllo",
image[desciption] = "helloo helllo",
user[name] = "lorem",
user[password] = "ipsum", 
```

我试过doisg之类的

1.  **试一试**

    var params = "image[title] = 'hello hello'; params = params +"&image[media] = '+ imageview;

进而

等等...

```
xhr.open('POST', main_url + '/images.json',true);
xhr.setRequestHeader("Connection", "close");
// send the data
xhr.send({
    media : imageview,
    title : "helloo helllo",
    desciption : "Sample Desciption",
    username : 'lorem',
    password : 'ipsum',
}); 
```

但它将图像作为 blob 而不是附件发送

1.  **尝试两个**

    var params = "image[title] = 'hello hello'; params = params +"&image[media] = '+ imageview;

进而

等等...

```
xhr.open('POST', main_url + '/images.json');
xhr.setRequestHeader("Connection", "close");
// send the data
xhr.send({
    media : imageview,
    title : "helloo helllo",
    desciption : "Sample Desciption",
    username : 'lorem',
    password : 'ipsum',
}); 
```

但它将图像作为 blob 而不是附件发送

**- - - - - 编辑 - - - - -**

我成功地通过以下方式制作嵌套参数：

```
 xhr.send({
        user_id : "1",
        image : {
            attachment : immage,                
            'title' : "helloo helllo",
            desciption : "Sample Desciption",
            download_type : 'free',
            price : '0.0',
            tag_list : 'jddhd'
        },
    }); 
```

但这返回为：

```
"image"=>"{
    \"title\":\"helloo helllo\",
    \"username\":\"lorem\",
    \"desciption\":\"Sample Desciption\",
    \"order\":\"name\",
    \"media\":\"[object TiBlob]\",
    \"password\":\"ipsum\"
} 
```

但我需要接收参数，例如：

```
"image"=>{
    "title"=>"hello testing my uploads lorem",
    "description"=>"ssasd assdas asdas sad sadsa dsa ",
    "download_type"=>"free",
    "price"=>"0.0",
    "tag_list"=>"jddhd,akhdsa,"

    "attachment"=>#<ActionDispatch::Http::UploadedFile:0xb4c713e8 @original_filename="im.jpg",
    @content_type="image/jpeg",
    @headers="Content-Disposition: form-data; name=\"image[attachment]\"; filename=\"im.jpg\"\r\nContent-Type: image/jpeg\r\n",
    @tempfile=#<File:/tmp/RackMultipart20120429-6839-1w8vlxn>>,
} 
```

如果我从**附件中删除：image** from **image{}**然后它以所需的方式返回对象，即

```
 "attachment"=>#<ActionDispatch::Http::UploadedFile:0xb4c713e8 @original_filename="im.jpg",
    @content_type="image/jpeg",
    @headers="Content-Disposition: form-data; name=\"image[attachment]\"; filename=\"im.jpg\"\r\nContent-Type: image/jpeg\r\n",
    @tempfile=#<File:/tmp/RackMultipart20120429-6839-1w8vlxn>> 
```

现在真的很困惑如何解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T18:54:36.253

不确定您是否能够解决此问题，但我为此苦苦挣扎了一段时间，并且能够通过使用以下格式动态生成哈希来使嵌套参数文件上传工作：

```
var params = {};
params['user[user_id]'] = 1;
params['user[image][attachment]'] = image;
params['user[image][title]'] = "helloo helllo";
params['user[image][description]'] = "Sample Description";
params['user[image][download_type]'] = "free";
params['user[image][price]'] = "0.0";
params['user[image][tag_list]'] = "jddhd";
xhr.send(params); 
```

如果我尝试使用您在上面提供的格式创建哈希，则图像对象总是作为 TiBlob 字符串传输。上面的代码对我有用。

# php - 有效地比较和显示 SQL 结果

> ID：10366841
> 
> 赞同：0
> 
> 时间：2012-04-28T19:32:38.867
> 
> 标签：php, sql

我有一个朋友，我正在帮助一个论坛。所述论坛还有一个留言框，它在 SQL 表中存储已被禁止的用户 ID（整数）、UNIX 何时被禁止以及被谁（用户 ID/整数）禁止的数据。该数据在`shoutbox`表中。我正在尝试创建一个页面，让论坛版主可以查看被禁止的用户、被禁止的用户以及被禁止的时间。
假设该表`users`是具有称为数据列的表，该数据列`chat_banned`存储一个变量，具体取决于用户是否被`1`禁止和`0`未禁止的位置。该数据位于两个不同的表中`shoutbox`包含有关用户何时被禁止的信息，以及被禁止的用户 ID 的整数，以及谁进行了禁止，并`users`说明他们是否真的被禁止。
我不能简单地打印`shoutbox`表的结果的原因是因为用户可能已被取消禁止，而检查他或她是否未被禁止的唯一方法是检查表`chat_banned`列中的变量`users`。
是否有任何超级有效的方法来执行以下操作：

*   构建某种所有被禁止用户的数组（为方便起见，我当前选择的数据是`userid`和`username`from `users`）。
*   列出禁止他/她的用户以及他/她何时被禁止的数组
*   按 UNIX 时间从最近到最旧对该列表进行排序。

我已经有了一个基本的页面设置，所以如果您想查看它的示例基本功能，我很乐意在这里发布它，看看是否有任何方法可以简单地编辑我已经建立的页面以有效地完成这个.

谢谢，头晕。

**编辑：**我想我会更有效地列出什么表有什么信息以及它是什么。干得好：

*   `users`
    *   `chat_banned`（1为禁止，0为未禁止）
*   `shoutbox`
    *   `time`（执行命令时的 UNIX 时间戳）
    *   `command`（三个可能的命令的命令日志，`ban`用于禁止用户，`unban`用于取消禁止用户，`edit`编辑喊叫）
    *   `userid`（`userid`以整数形式执行命令的版主）
    *   `comment``userid`（被禁止用户的整数）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T21:42:10.360

此查询仅显示仍被禁止的用户的禁止活动：

```
SELECT u.username, s.time, s.command, bu.username AS moderator
FROM shoutbox s 
INNER JOIN users u
ON u.userid = s.comment
INNER JOIN users bu
ON bu.userid = s.userid
WHERE u.chatbanned = 1
AND s.command = 'ban'
ORDER BY s.time DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T20:06:24.170

在我的脑海中，您可能想使用子查询来搜索实际被禁止的用户，并使用这些 user_id 将您的所有信息从喊话箱数据库中获取。

```
 SELECT * FROM shoutbox WHERE comment IN (SELECT user_id FROM users WHERE chat_banned = 1) 
```

# c# - 类似 Base64 的字符串转换，到更小的字符集

> ID：10366842
> 
> 赞同：2
> 
> 时间：2012-04-28T19:32:43.503
> 
> 标签：c#, string, encoding

我有一系列加密字符串，我在 C#/ASP.Net Web 应用程序中用作 id。我需要在`id`属性中使用这些，但是，字符串包含非法字符（有效字符只有“[A-Za-z0-9-_:.]”）。我需要一个**双向**转换，将我的加密字符串映射到这个小集合。类似 Base64 的东西，但更小。

我的替代方案是什么？是否有为此的标准算法，或者我必须自己发明它是否很奇怪？

**解决方案：** 如果有人需要这个，这就是我最终要做的。替换无效字符，并去掉 padding = char。然后撤消此操作以恢复。

```
 private static string MakeReferenceJavascriptCompatible(string reference)
    {
        return reference.Replace("+", "_")
                        .Replace("/", "-")
                        .Replace("=", "");
    }
    private static string UndoMakeReferenceJavascriptCompatible(string reference)
    {
        int padding = 4 - (reference.Length % 4);
        return reference.Replace("-", "/")
                        .Replace("_", "+")
                        .PadRight(reference.Length + padding, '=');
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T19:36:03.973

如果你有 AZ (26)、az (26)、0-9 (10) 和 '_'、':' 和 '.' (3) 那么你有 65 个字符可用，就像 Base64 一样。（由于在末尾使用 = 作为填充，它需要 65 而不是 64。）我不清楚你是否*也*包括`-`，这会给你 66... 积极*丰富*的可用字符:)

听起来您只需要将“正常”形式转换为稍微不同的字母表。您可以通过找到一个灵活的 base64 实现来指定要使用的值，或者只需调用`string.Replace`：

```
var base64 = Convert.ToBase64String(input)
                    .Replace('+', '_')
                    .Replace('/', ':')
                    .Replace('=', '.'); 
```

反转替换以从您的“修改”base64 恢复为“正常”base64，它将对`Convert.FromBase64String`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T19:37:52.473

“更小”？在您所说的问题中，有 66 个有效字符：

*   [AZ] : 26
*   [az] : 26
*   [0-9] : 10
*   [-_:.]：4

给 Base64 一个机会，也许用其他一些字符替换“非法字符”（+、/、=）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:48:33.053

您已经有 65 个有效字符可供使用。因此，您可以将 base64 编码与`String.Replace`. 但是，如果您想使用不区分大小写的编码（例如用于 Windows 中的文件名），您可以使用[base36](http://www.stum.de/2008/10/20/base36-encoderdecoder-in-c/)编码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-08T13:07:02.060

您可以使用内置的 System.Web.HttpServerUtility 来执行此操作。

要将值转换为编码值（对 Url 和 JavaScript 使用安全）：

```
string result = value;
if (!string.IsNullOrEmpty(value))
{
  var bytes = System.Text.Encoding.UTF8.GetBytes(value);
  result = HttpServerUtility.UrlTokenEncode(bytes);
}
return result; 
```

要将编码值转换回原始值：

```
// If a non-base64 string is passed as value, the result will
// be same as the passed value
string result = value;
if (!string.IsNullOrEmpty(value))
{
  var bytes = HttpServerUtility.UrlTokenDecode(value);
  if (bytes != null) {
    result = System.Text.Encoding.UTF8.GetString(bytes);
  }
}
return result; 
```

# javascript - 在 HTML5 画布上绘制矩形

> ID：10366849
> 
> 赞同：4
> 
> 时间：2012-04-28T19:33:32.787
> 
> 标签：javascript, html, canvas, html5-canvas

是否可以在变量中存储一个矩形以便访问该变量并移动它？就像是：

```
var rect = new Rect();
/* then in update() method */
rect.x += 5;
rect.y += 5; 
```

这样的事情是否可能，或者您每次都必须使用上下文创建一个新的矩形？如果这是唯一可能的方法，我不明白如何定位画布中绘制的每个矩形。有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:46:32.920

HTML5 Cancas 有一个位图模型：绘制时修改画布的像素，如果需要，可以读取像素，但丢失了像素（线条、矩形等）的逻辑。

画布模型非常快，可以执行在对象/矢量模型中太长的复杂事情，但限制是您不能更改或删除绘制的对象，如矩形。

如果您想这样做，您需要使用矢量/对象模型，例如 SVG（或普通 DOM 对象）。

如果您想使用画布和对象，一种解决方案是将您的 rect 变量（就像您所做的那样）保存在普通的 javascript 中（在您的画布之外），并在每次更改 rect 时重新绘制整个画布。对于使用画布的应用程序（例如游戏）来说，它是高效且常见的。

这是一个完整的示例：每 10 毫秒移动和重绘 3 个矩形。

[http://jsfiddle.net/dystroy/PkzDA/](http://jsfiddle.net/dystroy/PkzDA/)

我让它变得非常简单但干净高效。您可以在真实且快速的应用程序中使用这种逻辑（我愿意）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T20:17:45.333

我将保存您要绘制的所有矩形及其坐标的模型。然后，您只需要监听 mouseclick 事件（或 mouseover 事件，无论您需要什么）并浏览模型的每个元素以查看鼠标单击是否在矩形坐标内完成。

正如之前的海报所说，每次想要更改画布时都必须重新绘制画布（尽管您可以通过仅重新绘制感兴趣的区域来加快速度）。希望那有所帮助！

编辑：

你可以定义一个矩形对象：

```
function Rectangle(x, y, w, h) {
    this.x = x;
    this.y = y;
    this.w = w;
    this.h = h;

    this.contains = function(x, y) {
        return (x > this.x && x <= (this.x + this.w) &&
            y > this.y && y <= (this.y + this.h));
    }

    this.clone = function() {
        return new Dimension(this.x, this.y, this.w, this.h);
    }
} 
```

然后有一个数组作为你的模型：

```
var model = []; 
```

然后将你的矩形添加到它：

```
model.push(new Rectangle(10,10,10,10));//x, y, width, height 
```

然后，当您单击画布时，从鼠标事件中检索鼠标单击坐标，然后循环遍历数组以查看单击是否在其中一个矩形内完成：

```
for (i = 0 ; i < model.length ; i++) {
 if (model[i].contains(mouseEvent.x, mouseEvent.y))
  //do something like redraw your canvas
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T23:04:02.000

我发现本教程确实帮助我理解了这个主题。

[http://simonsarris.com/blog/510-making-html5-canvas-useful](http://simonsarris.com/blog/510-making-html5-canvas-useful)

他介绍了对象的创建、跟踪状态、处理鼠标事件等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T19:58:23.057

如果要在画布上移动矩形，则每次更改 x 或 y 时都需要清除并重绘该矩形。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-29T13:50:32.043

首先，您必须将我要说的与@Gaet 说的结合起来

现在关于减少上下文工作：重用相同画布上下文而不删除它的一个选项是更改矩形的绘制方式。

您必须将合成样式更改为“异或”，因此每当您绘制矩形两次时，它都会消失，您将能够将其绘制到新位置。

见下面的例子：

```
//this will switch context to xor mode
ctx.globalCompositeOperation = 'xor';

//this will paint the rectangle
ctx.fillRect(0, 0, 100, 100);

//this will remove the rectangle
ctx.fillRect(0, 0, 100, 100); 
```

# javascript - javascript对象中的平等？

> ID：10366850
> 
> 赞同：1
> 
> 时间：2012-04-28T19:33:36.027
> 
> 标签：javascript, oop

如果我有这个代码：

```
var foo1 = new Foo();
var foo2 = new Foo(); 
```

我想这样做：

```
function updateFoo1 (foo) 
{
   if (foo === foo1) //If foo is foo1
   {
       //code for processing
       return true;
   }
   else //Foo must be foo2 or another instance of foo not foo1
     return false;
} 
```

这是否会按预期工作以确保函数参数是否与该类的任何其他实例`foo`相同`foo1`或不同？如果没有，我应该怎么做才能得到我想要的结果？`foo2``foo`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:50:12.823

```
function Foo(){}
var foo1 = new Foo();
var foo2 = new Foo();
console.log(foo1===foo2); // always false 
```

对象比较是由对象的引用完成的，因此`foo1`返回不同的引用并`foo2`返回另一个引用。在你的情况下

```
function updateFoo1(foo) 
{
    if (foo === foo1)
    {
        //code for processing
        return true;
    }
    else return false;
}
updateFoo1(foo1) // first if condition will work and will return true
updateFoo1(foo2) // else condition will work and will return false 
```

[**在这里看到自己。**](http://jsfiddle.net/heera/YW9Nc/1/)

# makefile - autogen.sh 不会（重新）生成 po/Makefile.in.in

> ID：10366852
> 
> 赞同：3
> 
> 时间：2012-04-28T19:33:54.160
> 
> 标签：makefile, autotools, autoreconf

我正在尝试将 autogen.sh (http://buildconf.brlcad.org/) 与 gummi (http://dev.midnightcoding.org/projects/gummi) 一起使用，这样当我进行更改时，例如配置.ac，我的补丁也不必包含对配置的更改。如果我下载最新版本的 gummi 源，删除 po/Makefile.in.in，放入 autogen.sh，然后运行它，autogen.sh 会成功完成

```
Preparing the Gummi build system...please wait

Found GNU Autoconf version 2.68
Found GNU Automake version 1.11.1
Found GNU Libtool version 2.4

Automatically preparing build ... done

The Gummi build system is now prepared.  To build here, run:
  ./configure
  make 
```

但不生成 po/Makefile.in.in。但是，如果我运行 intltoolize，则会生成 po/Makefile.in.in。查看 autogen.sh 的源代码表明它有时会运行 intltoolize。这是 autogen.sh 中的错误吗？configure.ac（或其他文件）是否应该告诉 autogen 运行 intltoolize？intltoolize 生成的文件是否应该包含在所有发行版中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T23:27:04.237

是的，如果包使用 intltool，autogen.sh 应该运行 intltoolize。如果没有，那就是一个错误。

顺便说一句，虽然您使用的那个脚本自称为“the”autogen.sh，但实际上并不存在唯一的 autogen.sh。这只是引导脚本的通用名称。我更喜欢只写我自己的，具体到每个项目。它可以像这样简单：

```
#!/bin/bash
autoreconf --force --install || exit 1
intltoolize --force || exit 1 
```

但是，如果您有一个花哨的 autogen.sh 来检测是否运行 intltoolize，那么它可能会检测到 configure.ac 中是否有调用`IT_PROG_INTLTOOL`。我已经看到这种情况发生了，但我不认为你的这样做 - 我正在查看 Sourceforge 的最新版本[，](http://buildconf.git.sourceforge.net/git/gitweb.cgi?p=buildconf/buildconf;a=blob;f=autogen.sh;h=da846c1ddcdd58690372b3cb649517d0bae4a74a;hb=HEAD)我在其中的任何地方都找不到字符串“intltool”。我会说你的 autogen.sh 与 intltool 不兼容。

简而言之：

*   每个项目都应该包含自己的 autogen.sh。（除非您准备构建系统所需的唯一命令是 autoreconf。）Gummi 没有，所以这是一个错误。
*   没有通用的 autogen.sh 这样的东西。您可以获取现有的并复制或调整它，但这完全取决于源包需要采取哪些步骤。

# java - 删除字符串数组中的重复字符串

> ID：10366856
> 
> 赞同：21
> 
> 时间：2012-04-28T19:34:02.693
> 
> 标签：java, arrays, string-matching

我正在制作一个基于 Java 中的字符串处理的程序，其中我需要从字符串数组中删除重复的字符串。在这个程序中，所有字符串的大小都是相同的。

'array' 是一个字符串数组，其中包含多个字符串，其中两个字符串彼此相似。因此，使用下面的代码必须删除重复的字符串，但不会删除它。

如何删除重复的字符串？

我正在使用以下代码。

```
 for(int s=0;s<array.length-1;s++)
    {
        for(int m=0;m<array.length;m++)
        {
                for(int n=0;n<array[m].length();n++)
                {   
                    if(array[s].charAt(n)==array[m].charAt(n))
                    {
                      continue;
                    }
                    else 
                break;
        } 
        if(n==array[m].length())
        {
            ArrayUtils.removeElement(array, array[s]);
        }
    } 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-04-28T19:42:13.357

这将起作用

```
array = new HashSet<String>(Arrays.asList(array)).toArray(new String[0]); 
```

或者只使用 a`HashSet`而不是数组。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-05-15T12:11:40.793

建议的解决方案不保持元素的顺序。如果您使用 Java 8 或更高版本并希望保持顺序，您可以使用以下流：

```
array = Arrays.stream(array).distinct().toArray(String[]::new); 
```

完整示例：[https ://www.javacodeexamples.com/java-string-array-remove-duplicates-example/849](https://www.javacodeexamples.com/java-string-array-remove-duplicates-example/849)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T19:42:29.313

```
Set<String> set = new HashSet<String>();
Collections.addAll(set, array); 
```

或从

```
for(int s=0;s<array.length-1;s++)
{
    for(int m=s + 1;m<array.length;m++)
    {

                if(array[s] != null && array[s].equals(array[m]))
                {
                  // array = ArrayUtils.removeElement(array, array[s]); --m;??
                  array[m] = null; // Mark for deletion later on
                }
    } 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T19:42:54.430

除非这是`[homework]`我会使用 Set

```
String[] array =
Set<String> uniqueWords = new HashSet<String>(Arrays.asList(array)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-08-21T07:21:00.527

```
import java.util.*;
public class Stringarray {

    public static void main(String args[]){

        String[] name = {"aim","rajesh","raju","aim"};

    Set<String> myset  = new HashSet<String>();
    Collections.addAll(myset,name);

       System.out.println(myset);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-25T10:34:16.587

```
 String[] arr = {"w10","w20","w10","w30","w20","w40","w50","w50"};
     List<String> arrList = new ArrayList<String>();
     int cnt= 0;
       //List<String> arrList = Arrays.asList(arr);
       List<String> lenList = new ArrayList<String>();
          for(int i=0;i<arr.length;i++){
        for(int j=i+1;j<arr.length;j++){
           if(arr[i].equals(arr[j])){
             cnt+=1;
           }                
        }
        if(cnt<1){
          arrList.add(arr[i]);
        }
          cnt=0;
        }

for(int k=0;k<arrList.size();k++){
            System.out.println("Array without Duplicates: "+arrList.get(k));
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-28T19:47:18.330

你为什么不删除最内层的循环以支持`String.equals(String)`？

在第一次迭代中，您将 array[0] 与 array[0] 进行比较，它们是相等的，它将被删除。然后将原始数组 [1] 与数组中的所有其他元素进行比较，如果它们相等，则删除数组 [1]（而不是另一个）。

有一些问题，如果有一些重复的字符串，你正在删除第一个，这将减少数组的大小而不减少`r`所以，数组中的一些字符串被跳过。

我会使用强制唯一性的数据结构，例如 Set。

如果数组中有 3 个相等的字符串会发生什么，我不确定会发生什么。

相信你会遇到一些`ArrayIndexOutOfBoundsException`s。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-28T19:43:21.330

*   为什么不使用`String.equals()`比较而不是手动遍历字符串中的字符？
*   您的逻辑实际上是有缺陷的：对于`array[s]`==`"12345"`和`array[m]`==`"123"`它会声称它们是相等的
*   此外，在您的内部循环中，在某些时候`for(int m=0;m<array.length;m++)` `m`也会变得等于`s`，因此您会将字符串与其自身进行比较

这些说明假定您需要使用自己的代码实现删除逻辑，不允许使用类库。如果不是这种情况，正如其他人指出的那样，使用 a[`HashSet`](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html)是最简单的方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-28T19:53:11.593

我认为最后的 if 条件应该是 if(n==(array[m].length()-1))

话虽如此，您似乎正在尝试在最里面的循环中实现 String.equals() 方法的功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-28T16:24:48.490

设置数据结构将自动完成这项工作。`HashSet`如果您关心元素的顺序，您最可能的选择是`TreeSet`

```
List<String> input = Arrays.asList(array);
Set<String> unique = new HashSet<>(input); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-08-06T09:42:42.197

```
List<String> al = new ArrayList<String>();
String[] months={"Jan","Feb","Mar","Apr","Jan","Mar","May","May"};
for(int i=0;i<months.length;i++){
    for(int j=1;j<months.length;j++){
        if(months[i].equalsIgnoreCase(months[j])){
            if(!al.contains(months[i])){
                al.add(months[i]);
            }
        }
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-07-28T15:40:49.603

```
Sring[] myStringArray = {"hello", "hello", "moto"};
String[] filteredArray = new LinkedHashSet<String>(Arrays.asList(myStringArray))
                         .toArray(new String[0]);

System.out.println("filteredArray Size: " + filteredArray.length);
System.out.println("filteredArray[0] = " + filteredArray[0]);
System.out.println("filteredArray[1] = " + filteredArray[1]); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-05-30T08:19:39.773

在不使用 Collection 的情况下从 String[] 中删除重复的字符串

```
 public static void removeDuplicate(String[] str, int size){
            for(int i=0; i<size-1; i++){
                if(str[i]!=null){
                    for(int j=i+1; j<size-1; j++){
                        if(str[i].equals(str[j])){
                            str[j]=null;
                        }
                    }
                }
            }
            for(int i=0; i<size;i++){
                if(str[i]==null)
                   continue;
                System.out.println(str[i]);
            }
        } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-05-20T05:47:55.290

```
public static List<String> sortHandleArrayList(String... arrayInput) {
    List<String> list = new ArrayList<>();
    for (String string : arrayInput) {
        if (!list.contains(string)) {
            list.add(string);
        }
    }
    Collections.sort(list);
    return list;
} 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2013-10-09T06:56:24.087

重复整数删除：这是完美的答案 /// Haris ///

```
public static void duplicateRemove(int[] arr) {
    int temp = 0;

    for (int i = 0; i < arr.length; i++) {
        for (int j = 0; j < arr.length; j++) {
            if (arr[i] < arr[j]) {
                temp = arr[i];
                arr[i] = arr[j];
                arr[j] = temp;
            }
        }
    }

    int count;
    for (int j = 0; j < arr.length;) {
        count = 1;
        for (int i = j + 1; i < arr.length; i++) {
            if (arr[i] == arr[j]) {
                count++;
            } else
                break;

        }
        System.out.println(arr[j] + " is :  " + count);
        j += count;
    }

} 
```

# javascript - Javascript：访问父函数的变量

> ID：10366858
> 
> 赞同：1
> 
> 时间：2012-04-28T19:34:18.117
> 
> 标签：javascript, node.js, scope

我有以下代码（简化）：

```
function(req, res) {
  var path = 'login';

  req.on('end', function(data) {
    var post = parsevars(rawpost, '&');
    if (typeof post.username !== 'undefined' && typeof post.password !== 'undefined') {
      if (handlelogin(post.username, post.password))
        **path = req.url;**
    }
  });
}
```

粗体部分是没有按预期工作的部分：/
有关如何摆脱此范围限制的任何输入都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:49:00.993

它确实有效，它只是在事件处理程序之前执行之后的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:44:27.523

奇怪的是，这*应该可以*工作，因为`req`它在闭包的外部范围内。

但是我想你会发现 current`req`也可以`this`在回调中使用，即：

```
path = this.url; 
```

# android - APK安装

> ID：10366865
> 
> 赞同：0
> 
> 时间：2012-04-28T19:35:18.670
> 
> 标签：android

我试图弄清楚如何以编程方式安装 APK 而不会出现在所有/管理应用程序中 - 应用程序/图标列表等

我已经用 Corona 制作了一个游戏，但不幸的是，Corona 还没有与 c2dm 集成，开发人员从未回答有关它的论坛问题.. soooo.. 我在 eclipse 中放置了一个应用程序，在启动时使用 c2dm 记录设备然后打开我的游戏。工作正常，我从我的网站收到通知...问题是虽然现在我的游戏的管理应用程序中列出了 2 个应用程序。我只需要列出的第一个注册 c2dm 的应用程序。如果用户直接打开游戏，他们的设备将不会登录到 c2dm。

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:43:32.410

如果您的意思是以编程方式安装 apk，请使用意图

```
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setDataAndType(Uri.fromFile(new File(Environment.getExternalStorageDirectory() +    "/where/apk/is/stored/app.apk")), "application/vnd.android.package-archive");
startActivity(intent); 
```

如果您不希望它显示在应用程序列表中（但是它将显示在设置/应用程序上，而不是启动器上），您可以从清单中删除

```
action android:name="android.intent.action.MAIN"
category android:name="android.intent.category.LAUNCHER" 
```

来源：[Android：以编程方式安装 .apk](https://stackoverflow.com/questions/4967669/android-install-apk-programmatically)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:56:16.833

> 问题是虽然我的游戏的管理应用程序中现在列出了 2 个应用程序。

正确的。这是一件好事。而且，幸运的是，对于用户来说，这是一项要求——例如，恶意软件作者会对能够安装而不是卸载非常感兴趣。

> 我只需要列出的第一个注册 c2dm 的应用程序。

*用户*需要同时列出这两个应用程序，因此用户*可以*卸载任一应用程序、强制停止任一应用程序、跟踪两个应用程序中的存储空间等。

> 如果用户直接打开游戏，他们的设备将不会登录到 c2dm。

然后您的应用程序需要适当地处理这个问题。无论如何，您的游戏希望不依赖于 C2DM，因为 C2DM 不可靠（消息延迟、消息丢失等）并且并非在所有设备（例如 Kindle Fire）上都可用。

# objective-c - 将代码从 Xcode 3 移动到 4 会产生错误：Cannot declare variable inside @interface or @protocol

> ID：10366866
> 
> 赞同：4
> 
> 时间：2012-04-28T19:35:26.627
> 
> 标签：objective-c, xcode4, compiler-errors, instance-variables, class-extensions

我正在将我的旧 iPhone 应用程序从 Xcode 3 迁移到 Xcode 4。我在用于在 Xcode 3 中构建的代码上收到此错误——实际上我是故意这样写的，以隐藏其他模块的实现细节。然而，Objective-C 似乎发生了一些变化。此代码现在收到错误

> 不能在@interface 或@protocol 中声明变量。

请记住，这是 .m 文件顶部的代码，而不是 .h

```
@interface VisualViewController ()
BOOL doReloadPhoto;

+ (void)buildVisualEffectInfo;

@property (nonatomic, retain) HandleCheckListSetting *checkListHandler;
@end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-28T19:41:07.253

这可能以前编译过，但我不认为它正在做你认为它正在做的事情。听起来您想在类扩展中创建一个私有 ivar。但是，您拥有的语法只是一个顶级变量，相当于：

```
BOOL doReloadPhoto;

@interface VisualViewController ()
// etc.
@end 
```

您需要将它放在花括号内才能成为 ivar：

```
@interface VisualViewController () 
{
    BOOL doReloadPhoto;
} 
```

（相反，我不确定 Xcode 3 的编译器是否可以使用扩展中的 ivar，这可能就是为什么您按照您的方式进行操作的原因。）听起来编译器现在（明智地）指出您拥有的代码可能没有按照您的预期进行，并迫使您完全清楚地表达自己的意图。

`@implementation`最近也可以使用相同的语法在块中声明私有 ivars ：

```
@implementation VisualViewController
{
    BOOL doReloadPhoto;
} 
```

# javascript - tag doesn't refresh when its data attribute is changed in Chrome I have an tag on a web page, whose data attribute is changed programmatically in JS (jQuery, specifically). The data 问问题 问问题 2012-04-28T19:35:35.347 21400 次 This question shows research effort; it is useful and clear 6 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. javascripthtmlgoogle-chromesvg 4 3 回答 3 This answer is useful 11 好吧，今晚我真的很无聊，我想做一些不是功课的事情，所以我为你挖掘了很多规范和论坛。 HTML4 规范似乎没有提到 SVG，所以这是一条死胡同。HTML5 Spec Working Draft告诉我们，我们可以使用它来data调用插件和加载内容。HTML5 Spec Editor's Draft 确实 提到了 SVG，告诉我们 SVG 属于嵌入内容的范畴。 因为编辑草案为工作草案中定义的元素添加了额外的细节，我们可以说加载元素的行为不是公认的标准。（如果我错了，请有人纠正我。） 无论如何，在规范中，除了关于浏览器应该如何通过 MIME 类型解释对象等的所有常用技术术语之外......我们找到了与这个问题相关的部分： 4.6：如果加载失败（例如，有一个HTTP 404错误，有一个DNS错误），在元素上触发一个名为error的简单事件，然后跳转到整个步骤集的最后一步（回退）。 ... 10.：一旦资源完全加载，排队一个任务以在元素上触发一个名为load的简单事件。 （简单事件仅仅意味着事件不会冒泡（所以我们不能在任何父元素中监听它）并且不可取消，并使用Event接口） 所以，看着这个，我想如果我从DOM 中选择元素，它应该有一个onloadandonerror事件，如果不是object.addEventListener. 如果您查看 Mozilla Developer Network 的SVG和文档，许多 JavaScript 文档是不完整的。真可惜。 只是玩弄 JSFiddle 和 Chrome 开发工具和 Firefox Web 控制台，我发现它们都支持onloadand onerror，或者我想。 测试结果 谷歌浏览器 (18.0.1025.165) 和 Firefox (12.0) 支持： addEventListener('load', function(){}) obj.onload = function(){}; 不支持（事件似乎没有触发）： addEventListener('error', function(){}) obj.onerror = function(){} 从fiddle可以看出，在 Chrome 中使用该load事件会导致无限循环。它不应该这样做（根据编辑的草稿）： 上述算法独立于 CSS 属性（包括“显示”、“溢出”和“可见性”）。例如，即使元素以 'display:none' CSS 样式隐藏，它也会运行，并且如果元素的可见性发生变化，它也不会再次运行。 看起来有人已经提交了一个错误，所以如果你去确认这个错误，它将帮助 Chrome 开发团队。 TL;博士 加载对象的行为还不是公认的标准，但您可以去验证Chromium 项目中的错误。您可以尝试按照@Hello71 的建议进行操作，并尝试从 DOM 中删除该元素并重新添加它，但我无法让它工作。 于 2012-04-29T22:03:47.437 回答 This answer is useful 6 实际上，我遇到了完全相同的问题。看看http://jsfiddle.net/unesJ/，我用下面的代码解决了它： 的HTML： 的JavaScript： var new_url = 'image2.svg'; $('#graph').attr('data', new_url); $('#graph').load(new_url); 它对我有用 铬 24.0.1312.52 m 火狐 17.0.1 于 2013-01-21T23:25:00.490 回答 This answer is useful 2 我已经尝试了很多东西。不幸的是，我不得不采取以下措施： setTimeout(function(){ $('body').trigger('click'); }, 40); 不，我真的没有更好的解决方案，但它可以完成工作。 于 2012-08-08T22:58:33.287 回答 Related 1 delphi - SpTBX：在我的画布 X 图标上绘制，就像在 SpTbx 面板上一样 2 symfony - Symfony2 和 postgresql 1 ruby-on-rails - RedShift / PostgreSQL 中串行类型的替代方案 1 objective-c - CocoaPods 的“可编辑”模式？ 1 kendo-ui - Kendo UI Grid 的严重问题（2013 年第一季度发布后） 3 python - Python正则表达式中带括号的重复 1 visual-studio-2010 - Gridview 编辑 - 重定向到更新表单 1 django - 为什么上下文处理器会添加到 django 中的每个视图中？ 1 php - Zend 控制器从两个类扩展 1 c#-4.0 - 无法读取 Web API 操作过滤器内容 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10366867
> 
> 赞同：6
> 
> 时间：
> 
> 标签：javascript, html, google-chrome, svg

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-29T22:03:47.437

好吧，今晚我*真的很*无聊，我想做一些不是功课的事情，所以我为你挖掘了很多规范和论坛。

[HTML4 规范](http://www.w3.org/TR/html4/struct/objects.html#h-13.3.1)似乎没有提到 SVG，所以这是一条死胡同。[HTML5 Spec Working Draft](http://www.w3.org/TR/html-markup/object.html#object)告诉我们，我们可以使用它来`data`调用插件和加载内容。[HTML5 Spec Editor's Draft](http://dev.w3.org/html5/spec/the-object-element.html#the-object-element) *确实* [提到](http://dev.w3.org/html5/spec/svg-0.html#svg)了 SVG，告诉我们 SVG 属于[嵌入内容](http://dev.w3.org/html5/spec/content-models.html#embedded-content)的范畴。

**因为[编辑草案为](http://dev.w3.org/html5/spec/the-object-element.html#the-object-element)[工作草案](http://www.w3.org/TR/html-markup/object.html#object)`<object>`中定义的元素添加了额外的细节，我们可以说加载元素的行为不是公认的标准。`<object>`**（如果我错了，请有人纠正我。）

无论如何，在`<object>`规范中，除了关于浏览器应该如何通过 MIME 类型解释对象等的所有常用技术术语之外......我们找到了与这个问题相关的部分：

> 4.6：如果加载**失败**（例如，有一个HTTP 404错误，有一个DNS错误），在元素上触发一个名为**error的****简单事件**，然后跳转到整个步骤集的最后一步（回退）。
> 
>  **...
> 
> 10.：一旦资源完全**加载**，排队一个任务以在元素上触发一个名为**load的****简单事件。****

 ****（*[简单事件](http://dev.w3.org/html5/spec/webappapis.html#fire-a-simple-event)仅仅意味着事件不会冒泡（所以我们不能在任何父元素中监听它）并且不可取消，并使用`Event`接口*）

所以，看着这个，我想如果我从`<object>`DOM 中选择元素，它应该有一个`onload`and`onerror`事件，如果不是`object.addEventListener`. 如果您查看 Mozilla Developer Network 的[SVG](https://developer.mozilla.org/en/SVG/Attribute)和文档[`<object>`](https://developer.mozilla.org/en/HTML/Element/object)，许多 JavaScript 文档是不完整的。真可惜。

只是玩弄 JSFiddle 和 Chrome 开发工具和 Firefox Web 控制台，我发现它们都支持`onload`and `onerror`，或者我想。

# 测试结果

### 谷歌浏览器 (18.0.1025.165) 和 Firefox (12.0)

**支持**：

*   `addEventListener('load', function(){})`
*   `obj.onload = function(){};`

**不支持（*事件似乎没有触发*）**：

*   `addEventListener('error', function(){})`
*   `obj.onerror = function(){}`

从[fiddle](http://jsfiddle.net/mFdsY/33/)可以看出，在 Chrome 中使用该`load`事件会导致无限循环。它不应该这样做（根据[编辑的草稿](http://dev.w3.org/html5/spec/the-object-element.html#the-object-element)）：

> 上述算法独立于 CSS 属性（包括“显示”、“溢出”和“可见性”）。例如，即使元素以 'display:none' CSS 样式隐藏，它也会运行，并且如果元素的可见性发生变化，它也不会再次运行。

看起来有人[已经提交了一个错误](http://code.google.com/p/chromium/issues/detail?id=123536)，所以如果你去确认这个错误，它将帮助 Chrome 开发团队。

# TL;博士

加载对象的行为还不是公认的标准，但您可以去验证[Chromium 项目中的错误](http://code.google.com/p/chromium/issues/detail?id=123536)。您可以尝试按照@Hello71 的建议进行操作，并尝试从 DOM 中删除该元素并重新添加它，但[我无法让它工作](http://jsfiddle.net/mFdsY/37/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-21T23:25:00.490

实际上，我遇到了完全相同的问题。看看[http://jsfiddle.net/unesJ/](http://jsfiddle.net/unesJ/)，我用下面的代码解决了它：

的HTML：

```
<object id="graph" data="image1.svg" type="image/svg+xml"></object> 
```

的JavaScript：

```
var new_url = 'image2.svg';
$('#graph').attr('data', new_url);
$('#graph').load(new_url); 
```

它对我有用

*   铬 24.0.1312.52 m
*   火狐 17.0.1

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T22:58:33.287

我已经尝试了很多东西。不幸的是，我不得不采取以下措施：

```
setTimeout(function(){
  $('body').trigger('click');
}, 40); 
```

不，我真的没有更好的解决方案，但它可以完成工作。****

# cakephp - 如何在 CakePHP 中调用模型的空版本或默认版本？

> ID：10366873
> 
> 赞同：0
> 
> 时间：2012-04-28T19:36:29.590
> 
> 标签：cakephp, model

对于我正在写的东西，我想获得一个模型的空副本，或者一个具有默认值的副本。

所以，通常它可能会返回类似

```
array(
  'id' => '4',
  'name' => 'Object name',
  'somekey' => 'Some key\'s value',
  'someotherkey' => '1',
  'created' => '2012-04-22 17:11:31',
  'modified' => '2012-04-22 17:11:31'
) 
```

相反，我希望它返回一个键完整的数组，但值完全为空，或者甚至更好（如果可能）使用我可以在模型本身中指定的默认值。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T20:04:24.473

听起来您正在寻找模型方法[schema()](http://api20.cakephp.org/class/model#method-Modelschema)。这将返回所有表字段/类型。例如：

```
class User extends AppModel {

    public function emptyDataset() {
        $fields = $this->schema();

        if(is_array($fields)) {
            return array_keys($fields);
        } else {
            return false;
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T23:14:46.017

如果您只是想创建一个填充了默认值的用户，您可以使用`Model::create()`. 它在架构中搜索您为数据库定义的默认值，并相应地填写记录数据。

# asp.net - .net 配置错误 allowDefinition='MachineToApplication' 超出应用程序级别？

> ID：10366874
> 
> 赞同：1
> 
> 时间：2012-04-28T19:36:31.673
> 
> 标签：asp.net, .net, web-config

我是 .net 新手，在访问我的文件夹时遇到错误

[http://bassano2011.brinkster.net/](http://bassano2011.brinkster.net/)工作正常

当[http://bassano2011.brinkster.net/english/index.aspx](http://bassano2011.brinkster.net/english/index.aspx)

它给了我以下错误：

解析器错误消息：在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。

```
 Line 37:             ASP.NET to identify an incoming user. 
 Line 38:         -->
 Line 39:       <authentication mode="Windows"/>
 Line 40:       <!--
 Line 41:             The <customErrors> section enables configuration 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-09T11:25:05.373

如果您已通过将发布的网站放在 c: 驱动器的 inetpub 文件夹下的 wwwroot 文件夹中来配置您的网站。然后，如果您没有将您的网站转换为应用程序，也可能会出现错误消息，**配置错误allowdefinition ='machinetoapplication'超出应用程序级别。**要将网站转换为应用程序，您需要打开 IIS 窗口-->右键单击**站点**节点下的网站文件夹-->选择**转换为应用程序**。

此外，请确保您已为其添加了应用程序池。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T19:48:08.983

在托管环境中，他们通常会阻止对 Windows 的身份验证，因为这需要使用他们的服务器服务进行身份验证，而你无法控制，因此，永远不会按照你期望的方式工作。

`web.config`IIS 流在您的配置中出现错误，这是最后一个需要注意的配置，因为更多配置已经到位，通常是它自己的 IIS 和`machine.config`为该机器设置规则的文件，它就在那里“说”你不能使用“Windows”身份验证。

**为避免该错误**，请选择`Forms`或`None`作为您的`authentication`模式的参数。

要阅读有关身份验证[的更多信息，请阅读 MSDN](http://msdn.microsoft.com/en-us/library/aa291347%28v=vs.71%29.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-04T08:19:20.857

尝试在应用程序的子文件夹的 web.config 文件中注释 -->。请检查以下帖子。

[http://www.joelevi.com/blog/index.php/2007/07/aspnet-error-it-is-an-error-to-use-a-section-beyond-application-level/](http://www.joelevi.com/blog/index.php/2007/07/aspnet-error-it-is-an-error-to-use-a-section-beyond-application-level/)

[http://dotnet-magic.blogspot.com/2008/11/it-is-error-to-use-section-registered.html](http://dotnet-magic.blogspot.com/2008/11/it-is-error-to-use-section-registered.html)

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-08T12:39:00.147

有两个原因，

1.  如果您尚未将应用程序配置为在 IIS 上运行，则创建一个虚拟目录并将权限分配给 Application 。

2.检查您是否有两个 web.config 文件。

# javascript - 该变量范围事物的javascript术语

> ID：10366877
> 
> 赞同：0
> 
> 时间：2012-04-28T19:36:40.587
> 
> 标签：javascript, scope

我忘记了 javascript 中用来描述特定现象的术语。它与内联函数中访问变量的方式有关。我也不是很明白这个理论。我依稀记得下面的代码

```
for(var c = 0; c< 10; c++)
{
  arrayOfObjects[c].onclick = function() {alert(c); };
} 
```

我记得当点击一个对象时，警报窗口总是打印 10。然后有人解释说这是因为 javascript 中的所有内容都是一个对象。甚至 function(){blah} 也是一个在运行时被评估的对象，这就是为什么我对变量范围感到困惑。

我认为描述这种现象的术语以字母 e 开头。它类似于包裹，或封装，或诱捕，或类似的东西。

我在找什么词？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:39:24.187

您正在寻找的术语是 (en)Closure

[忽略 en]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T10:53:11.613

在您的示例代码中，有效的***CLOSURE***可能如下所示：

```
for(var c = 0; c< 10; c++) {

    arrayOfObjects[c].onclick = function(cc) {

        // cc is sustained in here

        return function () {

            alert(cc);

        }

    }(c);

} 
```

`()`由于末尾的，外部函数立即执行，并且'c'作为'cc'传递给它。然后“构造”内部函数并为 onclick 返回。当这个存储的内部函数稍后执行时，它仍然会像构造时一样引用“cc”。

# c - C中的整数指针？

> ID：10366880
> 
> 赞同：2
> 
> 时间：2012-04-28T19:37:14.293
> 
> 标签：c, pointers, serial-port

我正在使用 Linux 中的 C 语言进行一些串行通信。我正在使用文件描述符来执行此操作。之后由于某种原因`char* s = "Hello world"`，我可以`s`使用write方法写入串口，没问题。我正在使用串行监视器程序来检查另一端。但是，我无法发送任何其他类型的数据。我从写入函数中收到“错误地址”错误。

但是，我注意到如果我做了一些非常奇怪的事情：`int* x = "5";`那我可以发送 this `x`。我的问题是，这到底是什么`int* x = "5"`意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:46:31.963

```
int* x = "5"; 
```

这不是有效的 C 代码。您必须将数组的值转换为 an`int *`但指针的取消引用仍然会破坏对齐规则并且是未定义的行为。

```
int *x =  (int *) "5"; 
```

最后一段代码存储了一个类型为 的未命名数组对象`char [2]`。的值`"5"`是指向其第一个元素的指针，指针是 a `char *`。强制转换将 转换`char *`为 an `int *`并将其存储在`x`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T19:53:14.010

```
int* x = "5"; 
```

是*违反约束*的。这意味着任何符合标准的编译器都必须为其发出诊断。不必将其视为致命错误；允许编译器发出警告，然后成功翻译程序。但是语言没有定义这个声明的行为。

没有从`char*`（`"5"`衰减后的类型）到的隐式转换`int*`。

这就像 C 说某事是非法的一样接近。

实际上，接受此声明的编译器可能会将其视为等同于：

```
int *x = (int*)"5"; 
```

即，他们将插入转换。（这不是唯一可能的解释，但大多数编译器要么以这种方式解释它，要么拒绝它。）它采用`char*`数组表达式衰减产生的值`"5"`（即，`'5'`字符开头的地址字符串），并转换为`int*`.

结果`int*`指针指向一个`int`可能有效也可能无效的对象。该字符串`"5"`有两个字节长 ( `{ '5', '\0' }`)。如果`int`是两个字节，`*x`则可以评估将这两个字节解释为一个`int`值的结果——这将取决于系统的字节序。或者，如果字符串文字未正确对齐`int`对象，则评估`*x`可能会终止您的程序。如果`int`大于两个字节（通常是这样），`*x`是指超过字符串文字末尾的内存。在任何情况下，尝试修改`*x`都有另一种未定义的行为，因为尝试修改字符串文字是明确未定义的。

当您编译该声明时，您至少应该得到一个警告。如果是这样，你绝对不应该忽略它。如果您没有收到警告，您应该了解如何哄骗您的编译器产生更多警告。

TL;DR：不要那样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:41:21.583

`int* x = "5"``"5"`将(a )隐式转换`const char*`为 an`int*`并将其存储在`x`. 因此，`x`将指向`sizeof(int)`最低为 0x35（字符 '5'）的字节，下一个为 0，其余的都是不确定的，并且在读取时会导致未定义的行为。

# c# - 科学色谱的图像分析

> ID：10366885
> 
> 赞同：1
> 
> 时间：2012-04-28T19:37:38.777
> 
> 标签：c#, python, image, analysis

我正在寻找一种从 GC 或 HPLC 的色谱图中提取信息的方法。色谱图如下所示：

![色谱](../Images/f4d5b6d4386a6b747f833c2aa91bccad.png)

我不是很喜欢图像处理/分析，所以我正在寻找一种工具/算法来从这些色谱图中提取峰的长度（如果可能的话，还有峰下的表面）。解决方案可以使用 Python 或 C#。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T09:28:58.860

我编写了一些快速的 python 代码，可以从图像文件中提取色谱图（或任何单值）数据。

它有以下要求：

*   图像干净（没有文字或其他数据）。
*   曲线是单值的，即。曲线像素宽度为 1（没有这个它仍然可以工作，但它总是会取上限值）。
*   刻度是线性的。

很简单，就是遍历图像的每一列，取第一个黑色值作为数据点。它使用[PIL](http://www.pythonware.com/library/pil/handbook/image.htm)。这些数据点最初在`image`坐标系中，因此需要重新缩放到数据坐标系，如果所有图像共享相同的轴，这是直截了当的，否则需要在每个图像上手动完成基础（自动化将更多涉及）。

下图显示了我提取图像（我删除了文本）以进行处理（非粉红色区域）的位置，因此为了重新缩放，我们只需采用数据坐标系中的白框区域：`x_range = 4.4 - 0.55`、`x_offset = 0.55`、`y_range = 23000 - 2500`和`y_offset = 2500`。

![在此处输入图像描述](../Images/2e1cbfe4f339c6e67c765d86b0d6e249.png)

这是用 pyplot 重新绘制的提取数据： ![在此处输入图像描述](../Images/c640710ca8eb2e97f657d805496fc718.png)

这是代码：

```
import Image
import numpy as np

def get_data(im, x_range, x_offset, y_range, y_offset):
    x_data = np.array([])
    y_data = np.array([])
    width, height = im.size
    im = im.convert('1')
    for x in xrange(width):
        for y in xrange(height):
            if im.getpixel((x, y)) == 0:
                x_data = np.append(x_data, x)
                y_data = np.append(y_data, height - y)
                break
    x_data = (x_data / width) * x_range + x_offset
    y_data = (y_data / height) * y_range + y_offset
    return x_data, y_data

im = Image.open('clean_data_2.png')
x_data, y_data = get_data(im,4.4-0.55,0.55,23000-2500,2500)

from pylab import *
plot(x_data, y_data)
grid(True)
savefig('new_data.png')
show() 
```

一旦您将数据作为 numpy 数组，您可以使用许多选项来查找峰值及其下方的相应区域（有关一些方法，请参阅[此讨论）。](https://stackoverflow.com/questions/1713335/peak-finding-algorithm-for-python-scipy)噪声是一个很大的问题，因此一般的方法是对数据进行卷积以消除噪声（或者如果您的峰值很尖锐，您可以设置阈值）然后区分以找到峰值。要查找峰下的区域，您可以对峰区域进行数值积分。

我做了一些假设并编写了一些简单的代码（如下），以说明一种可能的方法。我已经对数据进行了阈值处理，因此只有高于 5000 的峰才能存活，然后我们遍历数据以找到峰，并使用梯形规则 ,`np.trapz`来找到每个峰下的面积。在峰重叠的地方，区域在重叠点处被分割（我怀疑这是标准的..）。此外，此代码将仅识别局部最大值的峰值（不会检测到肩部）。我已经绘制了结果，在相应的峰值位置写下每个峰值的面积值： ![在此处输入图像描述](../Images/57eac499a83d69d1fdb0d965168dbf2a.png)

```
def find_peak(start, grad):
    for index, gr in enumerate(grad[start:]):
        if gr < 0:
            return index + start

def find_end(peak, grad):
    for index, gr in enumerate(grad[peak:]):
        if gr >= 0:
            return index + peak + 1

def find_peaks(grad):
    peaks=[]
    i = 0
    while i < len(grad[:-1]):
        if grad[i] > 0:
            start = i
            peak_index = find_peak(start, grad)
            end = find_end(peak_index, grad)
            area = np.trapz(y_data[start:end], x_data[start:end])
            peaks.append((x_data[peak_index], y_data[peak_index], area))
            i = end - 1
        else:
            i+=1
    return peaks

y_data = np.where(y_data > 5000, y_data, 0)

grad = np.diff(y_data)

peaks = find_peaks(grad)

from pylab import *
plot(x_data, y_data)    
for peak in peaks:
    text(peak[0], 1.01*peak[1], '%d'%int(peak[2]))
grid(True)
show() 
```

无论您在这一点上采取什么方法，都需要对您的数据进行假设（我真的无法做出这些假设！尽管我在上面做了一些！），您如何处理重叠峰？等等。我相信色谱中有标准的方法，所以你真的需要先检查一下。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-08T21:04:12.133

当我使用此代码时，我得到以下图像

![创建的图像](../Images/0c26571ec6fa774c750b85e23d97e980.png)

代码同上（稍作修改）

```
from PIL import Image
import numpy as np

def get_data(im, x_range, x_offset, y_range, y_offset):
    x_data = np.array([])
    y_data = np.array([])
    width, height = im.size
    im = im.convert('1')
    for x in range(width):
        for y in range(height):
            if im.getpixel((x, y)) == 0:
                x_data = np.append(x_data, x)
                y_data = np.append(y_data, height - y)
                break
    x_data = (x_data / width) * x_range + x_offset
    y_data = (y_data / height) * y_range + y_offset
    return x_data, y_data

im = Image.open('C:\Python\HPLC.png')
x_data, y_data = get_data(im,4.4-0.55,0.55,23000-2500,2500)

from pylab import *
plot(x_data, y_data)
grid(True)
savefig('new_data.png')
show()

I am not quite sure what the problem might be. 
```

# split - 仅显示前 # 个单词，使用 jquery

> ID：10366888
> 
> 赞同：1
> 
> 时间：2012-04-28T19:37:59.477
> 
> 标签：split, slice

我有个问题。我从数据库加载一些文本。在我的页面上，我只想显示此文本的 30 个第一个单词。然后我将添加一个“阅读更多”按钮，它将用户重定向到一个新页面。因此，我认为将在同一 div 中显示剩余文本的“jquery 扩展器插件”对我不起作用。

我走了这么远：

```
$content = $("#blog_1").find(".entryContent").text().split(" ");
$slicedContent = $content.slice(30); 
```

几个小时以来，我一直在搞乱 .split 和 .slice 。但没有成功。我什至不必“保留”文本的其余部分，因为当用户单击“详细信息页面”上的“阅读更多”时，它将再次加载。所以从第 30 个单词开始，文本可以从 DOM 中删除。关于显示一组字符而不是单词的答案也很有帮助。

提前感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:45:40.793

首先回答你的问题，是这样的：

```
var test = "I have been messing around with .split and .slice for hours. But no success. I don't even have to 'keep' the remainder of the text, since it will be loaded again when the user will click read more, on the 'detail page'. So onwards from word 30, the text could be removed from the DOM. answers regarding displaying a set number of characters instead of words are also helpful."
var splittest = test.split(' ')
splittest.slice(0, 10)
(returns ["I", "have", "been", "messing", "around", "with", ".split", "and", ".slice", "for"]) 
```

我*不*会这样做。最好限制文本的数量，这样就不必担心必须检测单词的开头/结尾。它还将使造型更容易和更可预测。

```
test.slice(0, 300)
(returns "I have been messing around with .split and .slice for hours. But no success. I don't even have to 'keep' the remainder of the text, since it will be loaded again when the user will click read more, on the 'detail page'. So onwards from word 30, the text could be removed from the DOM. answers regardi") 
```

再好一点是限制这个文本服务器端的生成。将所有数据发送下来而不使用它只是浪费带宽。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:44:27.087

做这个：

```
$slicedContent = $content.slice(0,30) 
```

# java - oauth_problem=consumer_key_rejected 使用 Scribe 库

> ID：10366891
> 
> 赞同：2
> 
> 时间：2012-04-28T19:38:28.050
> 
> 标签：java, yahoo, scribe

我注册了一个 Yahoo Messenger SDK api 并将消费者密钥/sercret 插入到此代码中：

[https://github.com/fernandezpablo85/scribe-java/blob/master/src/test/java/org/scribe/examples/YahooExample.java](https://github.com/fernandezpablo85/scribe-java/blob/master/src/test/java/org/scribe/examples/YahooExample.java)

但是，我收到此错误：

```
Exception in thread "main" org.scribe.exceptions.OAuthException: Response body is incorrect. Can't extract token and secret from this: 'oauth_problem=consumer_key_rejected'
    at org.scribe.extractors.TokenExtractorImpl.extract(TokenExtractorImpl.java:41)
    at org.scribe.extractors.TokenExtractorImpl.extract(TokenExtractorImpl.java:27)
    at org.scribe.oauth.OAuth10aServiceImpl.getRequestToken(OAuth10aServiceImpl.java:52)
    at com.yahoodemo.YahooExample.main(YahooExample.java:28) 
```

我很确定消费者密钥/秘密是正确的，因为我可以使用具有通用 HTTP GET 请求的相同密钥/秘密来获取“RequestToken”。

这是 Scribe 库中的错误还是其他问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-01T14:39:25.647

即使我面临同样的问题。但我终于发现：在开发者帐户（[http://developer.apps.yahoo.com/projects](http://developer.apps.yahoo.com/projects)）中创建项目后，不要忘记为应用程序提供至少一个权限，例如：联系人 - 阅读，知识加 -读。最后保存

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-31T11:30:23.893

Nagendra 的解决方案对我有用，但不要忘记刷新 Yahoo Project 页面，因为在编辑权限后密钥和密码都已更改。

# c# - 如何向 MRDS 的 Drive 服务发送 HttpPost 消息

> ID：10366895
> 
> 赞同：0
> 
> 时间：2012-04-28T19:39:00.107
> 
> 标签：c#, http-post, robotics-studio

如何将 HttpPost 请求发送到驱动服务（我正在使用通用差异驱动）以将距离和旋转角度设置为特定值？

我编写了自己的服务，它在不使用 HttpPost 的情况下正常工作。

实际发生的是我从视觉服务获取对象位置并计算机器人和对象之间的距离和角度（这还没有给我正确的值，但现在并不重要）然后发送它们（角度和distance) 在通用驱动服务的 rotateAngle 和 driveDistance 上。我想做的是通过 HTTP POST 消息发送它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T20:03:44.573

您可以使用[System.Net.WebRequest](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx)类来执行 HTTP 发布：

```
string postData = "Put your post data here";
byte[] byteArray = Encoding.UTF8.GetBytes (postData);

WebRequest request = WebRequest.Create("http://www.mysite.com/PostHere");
request.Method = "POST";
request.ContentLength = byteArray.Length;
request.ContentType = "application/x-www-form-urlencoded";

Stream dataStream = request.GetRequestStream ();
dataStream.Write (byteArray, 0, byteArray.Length);
dataStream.Close ();
request.Close(); 
```

# javascript - 有一个脚本模拟一个控制、按键序列吗？

> ID：10366896
> 
> 赞同：4
> 
> 时间：2012-04-28T19:39:04.220
> 
> 标签：javascript, jquery, user-controls, greasemonkey, keypress

我已经搜索并发现我可以使用 jQuery 模拟按键事件，但是我对 jQuery 的了解很差，而且我不知道如何准确。

所以我有一个 Greasemonkey 脚本，它在 2 个选项卡中管理 2 个不同的网页。
我想模拟/自动执行`Ctrl``Shift``Tab`以自动返回上一个选项卡，这样我可以更改 Firefox 中的选项卡。

问题是它不仅是一个普通的按键，我还需要模拟一个`Ctrl`和`Shift`部分。

我已将此添加到我的脚本中：

```
// @require        http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js 
```

并尝试：

```
function testEvents(){
var press = jQuery.Event("keypress");
press.which = 9;
$("whatever").trigger(press.ctrlKey + press.shiftKey + press.which); 
```

}

没有成功。

我见过的一些链接： [是否可以通过编程方式模拟按键事件？](https://stackoverflow.com/questions/596481/simulate-javascript-key-events)， [模拟 jquery](https://github.com/jquery/jquery-ui/blob/master/tests/jquery.simulate.js)和[http://forum.jquery.com/topic/simulating-keypress-events](http://forum.jquery.com/topic/simulating-keypress-events)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T20:02:55.480

JavaScript 不能用于通过模拟“快捷键”键事件来触发默认行为。

由于 jQuery 只是编写 JavaScript 代码的一种不同方式，因此该限制也适用。
而且，由于 Greasemonkey 脚本是基于 JavaScript 的，除了`GM_*`方法之外没有额外的功能，因此无法编写切换选项卡的用户脚本。

# java - Jquery Slides，我想要一个随时打开

> ID：10366899
> 
> 赞同：0
> 
> 时间：2012-04-28T19:39:55.687
> 
> 标签：java, jquery, css, jquery-animate

所以我正在尝试使用 jquery 幻灯片制作这种“幻灯片”。我现在拥有它，因此当我悬停时图像会滑动，但是如果用户没有将鼠标悬停在图像上，我希望始终扩展其中一个图像。

如果您想要实时视图，这里是测试页面[http://www.johnnyedick.com/indexSlideUpTop.html的链接。](http://www.johnnyedick.com/indexSlideUpTop.html)

这是我正在使用的jquery：

```
$(function() {

                $('#box1').hover(function() {
                    $(this).stop().animate({ "width" : "530px"}, 1000);
                }, function() {
                    $(this).stop().animate({ "width" : "100px"}, 1000);
                    });

                    $('#box2').hover(function() {
                    $(this).stop().animate({ "width" : "530px"}, 1000);
                }, function() {
                    $(this).stop().animate({ "width" : "100px"}, 1000);
                    });

                    $('#box3').hover(function() {
                    $(this).stop().animate({ "width" : "530px"}, 1000);
                }, function() {
                    $(this).stop().animate({ "width" : "100px"}, 1000);
                    });
            }); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T20:29:21.883

我写了一个简单的函数：http: [//jsfiddle.net/skip405/9NVWt/2/](http://jsfiddle.net/skip405/9NVWt/2/)。可能它会很有用。我相信它可以由在 jQuery 方面更有经验的人进一步完善，我只是一个新手

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T20:21:45.790

在悬停功能代码之后添加此代码

```
$('#box3').css('width','530px') ; 
```

当页面出现第三个 div 时显示正常大小

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:58:12.823

更新：

```
 $(function() {
    $('#box1, #box2, #box3').hover(function() {
        $(this).stop().animate({ "width" : "530px"}, 1000)
            }, function() {
                $(this).stop().animate({ "width" : "100px"}, 1000);
                   }).mouseleave(function(){
                     jQuery.fx.off = true;
                         }); 
```

# java - 我如何知道用户是否已将页面留在检票口中？

> ID：10366903
> 
> 赞同：4
> 
> 时间：2012-04-28T19:40:16.817
> 
> 标签：java, javascript, ajax, wicket, wicket-1.5

我正在寻找一种方法来了解用户何时离开页面并且没有保存更改然后显示检票口的模式（最好但可以是确认框）。

附加信息：解决方案对代码的影响应该很小，因为我有大约 30 个页面会有这种行为，实际上我所有的网页都从一个叫做 LayoutPage 的页面扩展而来，类似于[这个](http://wicket.apache.org/learn/examples/markupinheritance.html)

我在[这个](https://stackoverflow.com/questions/276660/how-can-i-override-the-onbeforeunload-dialog-and-replace-it-with-my-own)问题中尝试了纯 JavaScript 解决方案，但是应用程序通过 AJAX 请求发送了大量数据，所以我无法确定一个很好的方法来了解数据是否已发送到服务器

当我开始查看`Form.class`Wicket 的源代码时。它有一个很好的方法，叫做`isSubmitted()`; 如果我能够从检票口知道用户是否即将退出页面，我可以使用它。

我不想为系统中的每个页面编写验证。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T07:26:38.427

[只需使用https://cwiki.apache.org/WICKET/calling-wicket-from-javascript.html](https://cwiki.apache.org/WICKET/calling-wicket-from-javascript.html)生成您的浏览器 onbeforeunload 。然后，您可以在回调中检查表单或页面的状态。

# c# - 在包含类中，使用属性还是字段？

> ID：10366904
> 
> 赞同：18
> 
> 时间：2012-04-28T19:40:22.253
> 
> 标签：c#, properties

在包含它们的类中编写代码时，使用私有字段或属性是一种好习惯吗？

例如，如果我有这个字段/属性对，那么这个类**之外**的类必须使用这个属性。**类内**的代码呢？它应该使用私有字段，还是也应该通过属性？

```
private string _foo;

protected string Foo
{
    get { return this._foo; }
}

private void SomeMethod()
{
  string dummyVariable = "snuh" + this._foo;  // So, this...
  string dummyVariable = "snuh" + this.Foo;  // ... or this?
} 
```

在这里使用该属性的一个好处是，如果 getter 中有任何逻辑，它仍然会被执行。我很想知道这里是否有最佳实践政策可以遵循。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-28T19:43:20.380

使用[Auto-Implemented properties](http://msdn.microsoft.com/en-us/library/bb384054.aspx)时，您别无选择 - 您*必须*使用该属性，因为您无权访问生成的字段。

如果您的属性不简单并且做了一些额外的工作（验证、触发事件等），您应该调用该属性以集中访问和逻辑。

如果您有任何其他属性（意味着没有逻辑和支持字段的简单属性），我会问为什么它们不是上述之一...

对于您提供的示例，它几乎没有什么区别 - 更重要的是与您如何使用这些保持一致，并且真正归结为个人审美和编码风格。

# sql-server-2008 - 使用 containstable 和 freetext 进行相关性排名搜索

> ID：10366908
> 
> 赞同：1
> 
> 时间：2012-04-28T19:41:04.937
> 
> 标签：sql-server-2008, stored-procedures, full-text-search

我读过你可以在 SQL 2008 服务器下使用 containstable 以及 contains 和 freetext 对搜索结果进行排名。我最近才第一次使用自由文本。自由文本分别遍历单词并与索引列进行比较。我希望能够先搜索短语，然后再搜索单个单词。

假设描述列已编入索引。我正在使用这样的存储过程查询：

```
SELECT id, description, item from table where (FREETEXT(description,@strsearch)) 
```

例如，如果 3 个行集包含带有苹果的单词，并且我搜索“苹果蛋糕”，则 id2 的行集应该是第一个，然后其他两个应该跟随：

```
id1 apple pie 4/01/2012
id2 apple cake 2/29/2011
id3 candy apple 5/9/2011 
```

例如，如果 4 个行集包含带有食物的单词，并且我搜索“快餐店”，则应该首先使用 id3 的行集，然后是 id1（不是完全匹配，但因为它在列中有“快餐”） ，那么其他两个应该遵循：

```
id1 McDonalds fast food
id2 healthy food
id3 fast food restaurant
id4 Italian restaurant 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T21:02:50.843

这篇文章有帮助吗？

[MSDN：限制排名结果集（全文搜索）](http://msdn.microsoft.com/en-us/library/cc879245%28v=sql.100%29.aspx)

这在某种程度上意味着，使用附加参数将允许您将结果限制为具有最大相关性的结果（您可以使用 来影响`WEIGHT`），并按该相关性 ( `RANK`) 进行排序。

> top_n_by_rank 是一个整数值 n，它指定仅返回 n 个排名最高的匹配项，按降序排列。

该文档没有示例`FREETEXT`；它只引用`CONTAINSTABLE`. 但这绝对意味着`CONTAINSTABLE`输出一个`RANK`您可以使用的列`ORDER BY`。

我不知道是否有任何方法可以强制执行您自己的相关性定义。根据 FTS 提取前 10 个相关匹配项，然后在输出中应用您自己的排名可能是有意义的，例如，您可以使用函数拆分搜索词，并按匹配词的数量排序。为简单起见，在以下示例中，我没有在子查询中使用全文，但您可以将其替换为您实际正在做的任何事情。首先创建函数：

```
IF OBJECT_ID('dbo.SplitStrings') IS NOT NULL
  DROP FUNCTION dbo.SplitStrings;
GO
CREATE FUNCTION dbo.SplitStrings(@List NVARCHAR(MAX))
RETURNS TABLE
AS
   RETURN ( SELECT Item FROM
       ( SELECT Item = x.i.value('(./text())[1]', 'nvarchar(max)')
         FROM ( SELECT [XML] = CONVERT(XML, '<i>'
         + REPLACE(@List, ' ', '</i><i>') + '</i>').query('.')
           ) AS a CROSS APPLY [XML].nodes('i') AS x(i) ) AS y
       WHERE Item IS NOT NULL
   );
GO 
```

然后是一个简单的脚本，显示如何执行匹配：

```
DECLARE @foo TABLE
(
    id INT,
    [description] NVARCHAR(450)
);

INSERT @foo VALUES
(1,N'McDonalds fast food'),
(2,N'healthy food'),
(3,N'fast food restaurant'),
(4,N'Italian restaurant'),
(5,N'Spike''s Junkyard Dogs');

DECLARE @searchstring NVARCHAR(255) = N'fast food restaurant';

SELECT x.id, x.[description]--, MatchCount = COUNT(s.Item)
FROM
(
    SELECT f.id, f.[description]
    FROM @foo AS f

    -- pretend this actually does full-text search:
    --where (FREETEXT(description,@strsearch))

    -- and ignore how I actually matched:    
    INNER JOIN dbo.SplitStrings(@searchstring) AS s
    ON CHARINDEX(s.Item, f.[description]) > 0

    GROUP BY f.id, f.[description] 
) AS x
INNER JOIN dbo.SplitStrings(@searchstring) AS s
ON CHARINDEX(s.Item, x.[description]) > 0
GROUP BY x.id, x.[description]
ORDER BY COUNT(s.Item) DESC, [description]; 
```

结果：

```
id description
-- -----------
3  fast food restaurant
1  McDonalds fast food
2  healthy food
4  Italian restaurant 
```

# java - 谷歌应用引擎和 CORS

> ID：10366912
> 
> 赞同：13
> 
> 时间：2012-04-28T19:41:31.677
> 
> 标签：java, jquery, google-app-engine, cors

我有一个托管在 GAE 上的简单应用程序（java servlet）。该应用程序返回 json 数据。我在 servlet 中将标头信息设置如下：

```
resp.setContentType("application/json");
resp.setHeader("Access-Control-Allow-Origin", "*");
resp.setHeader("Access-Control-Allow-Methods", "GET, POST, OPTIONS");
resp.setHeader("Access-Control-Allow-Credentials", "true"); 
```

这是我直接在应用引擎上访问 URL 时的标题信息：

```
Request Method:GET
Status Code:200 OK
Request Headersview source
Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Cache-Control:max-age=0
Connection:keep-alive
Host:---------.appspot.com
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.19 (KHTML, like Gecko)         Chrome/18.0.1025.162 Safari/535.19
Response Headersview source
Access-Control-Allow-Credentials:true
Access-Control-Allow-Methods:GET, POST, OPTIONS
Access-Control-Allow-Origin:*
Cache-Control:private
Content-Encoding:gzip
Content-Length:340
Content-Type:application/json; charset=ISO-8859-1
Date:Sat, 28 Apr 2012 19:14:58 GMT
Server:Google Frontend
Vary:Accept-Encoding 
```

但是当我尝试从不同的域访问 url 时，我得到以下响应：

```
Request Method:OPTIONS
Status Code:500 Internal Server Error
Request Headersview source
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Access-Control-Request-Headers:origin, x-requested-with, accept
Access-Control-Request-Method:GET
Connection:keep-alive
Host:----------.appspot.com
Origin:http://--------------.com
Referer:http://-------------.com/map/
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.162 Safari/535.19
Response Headersview source
Content-Length:466
Content-Type:text/html; charset=UTF-8
Date:Sat, 28 Apr 2012 19:15:14 GMT
Server:Google Frontend 
```

这是确切的错误：

```
XMLHttpRequest cannot load http://----------.appspot.com/Locations. Origin http://-------------.com is not allowed by Access-Control-Allow-Origin. 
```

尝试访问 GAE url 的代码如下所示：

```
$.getJSON("http://---------appspot.com/Locations",function(result){
    for (i=0; i < result.length; i++) 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-10T12:30:38.303

您需要覆盖标准 HttpServlet.doOptions() 方法以支持正确[的飞行前请求处理](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Preflighted_requests)。

```
@Override
protected void doOptions(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException 
{ 
    // pre-flight request processing
    resp.setHeader("Access-Control-Allow-Origin", "*");
    resp.setHeader("Access-Control-Allow-Methods", SUPPORTED_METHODS);
    resp.setHeader("Access-Control-Allow-Headers", SUPPORTED_HEADERS);
}

@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException 
{
   resp.setHeader("Access-Control-Allow-Origin", "*");
   resp.setContentType("application/json");

   // implementation...
} 
```

可以在[此处](https://reflectoring.io/complete-guide-to-cors/)找到一篇用示例解释 CORS 的精彩文章。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T20:58:29.170

看起来您的请求在[预检请求](http://dvcs.w3.org/hg/cors/raw-file/tip/Overview.html#preflight-request)中提前失败，因为服务器在被请求时以 500 响应（它应该以 200 + 特定标头响应）`OPTIONS <URL>`。

您可能想查看[CORS 上的 HTML5rocks 教程](http://www.html5rocks.com/en/tutorials/cors/)，特别是向服务器添加 CORS 支持，其中解释了预检请求（该`OPTIONS <url>`请求，您的应用无法使用 200 多个必需的标头回复该请求）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-24T16:02:10.037

这是另一个解决方案（为我工作）：

1.  在您的 Java App Engine 项目中配置 CORS 支持：

将 mvn 放入您的 pom.xml 文件中：

```
<!-- CORS Support for Jetty -->
<dependency>
    <artifactId>jetty-servlets</artifactId>
    <groupId>org.eclipse.jetty</groupId>
    <version>9.2.22.v20170606</version>
</dependency> 
```

或者下载 jar 文件：[jetty-servlets.jar](http://search.maven.org/#search%7Cgav%7C1%7Cg:%22org.eclipse.jetty%22%20AND%20a:%22jetty-servlets%22)，把它放在你的 WEB-INF/lib

2.  配置您的 web.xml 文件：

    `<filter> <filter-name>cross-origin</filter-name> <filter-class>org.eclipse.jetty.servlets.CrossOriginFilter</filter-class> <init-param> <param-name>allowedOrigins</param-name> <param-value>*</param-value> </init-param> <init-param> <param-name>allowedMethods</param-name> <param-value>GET,POST,HEAD</param-value> </init-param> <init-param> <param-name>allowedHeaders</param-name> <param-value>X-Requested-With,Content-Type,Accept,Origin</param-value> </init-param> </filter> <filter-mapping> <filter-name>cross-origin</filter-name> <url-pattern>/*</url-pattern> </filter-mapping>`

也许您需要使用自定义 URL 更改***allowedOrigins***字段值。

就是这样，构建和快乐编码。

*有关附加信息：* [如何将 Access-Control-Allow-Origin 添加到码头服务器](https://stackoverflow.com/questions/16037558/how-to-add-access-control-allow-origin-to-jetty-server)

# c++ - c++ 使用带有单例的模板

> ID：10366917
> 
> 赞同：0
> 
> 时间：2012-04-28T19:42:11.067
> 
> 标签：c++, templates, singleton

是否可以将模板与以下单例类一起使用，以便能够将 portit 函数与任何数据类型一起使用，而不仅仅是 int？这是一个非常愚蠢的想法吗？

```
class porter
{
private:
    static porter* instance;
    porter(){}
    ~porter(){}
public:
    static porter* getInstance()
    {
        if(!instance) 
            instance = new porter();
        return instance;
    }
    void portit(int theArray[])
    {
        //sort array someway
    }
};

porter* porter::instance=NULL; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:53:09.877

单例很糟糕，但至少您可以使用更简单的实现：

```
class porter {
public:
    static porter& instance() { static porter P; return P; }

   template <typename T, size_t N>
    void portit(T (&array)[N]) {
        std::sort(array, array + N);
    }

private:
    porter() = default;
    ~porter() = default;
};

// usage
porter::instance().portit(somearray); 
```

当然，使用这样的单例是没有意义的。将编写和使用的时间与更好的实现进行比较：

```
template <typename T, size_t N>
void sort(T (&array)[N]) { std::sort(array, array + N); }

// usage
sort(somearray); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:47:34.337

您可以使用功能模板

就像是

```
...
template <typename T>
void portit(T theArray[])
{
    //sort array someway
}
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T20:02:05.463

所以像...

```
template <typename T>
class porter<T> {
     public:
           template <typename T>
           static porter<T> * getInstance() {

           }
     private:
           static porter<T> * instance;
} 
```

？？？注意：这可能无法编译。自从我涉足模板以来已经有一段时间了。

这绝对是可能的，但在我看来，在开始编码之前，你应该认真考虑整个事情的设计，特别是如果你想在类中使用另一种模板类型。

至于你是想要每个类一个单例，还是所有实例一个单例......嗯，这有点复杂。

# mysql - 每月显示多篇文章中的一篇文章

> ID：10366925
> 
> 赞同：0
> 
> 时间：2012-04-28T19:42:59.820
> 
> 标签：mysql, limit

请帮助我的知识有限，我已经为此苦苦挣扎了将近一个星期。

我有一个允许用户发布到它的表。我想显示每个月都有一个帖子，例如

12 月 10 月 9 月 8 月 2 月

但是，如果一个月内有多个帖子，我只希望那个月显示一次，我该怎么做？

到目前为止，我已经创建了这个：

```
$months = mysql_query("SELECT article_id, content, DATE_FORMAT(date, '%M')
                       AS date
                       FROM article
                       ORDER BY article_id
                       DESC
                       LIMIT 12");

while($row = mysql_fetch_array($months)){
    echo "<a href=\"fullarticle.php?id=" . $row['date'] . "\">" . $row['date'] . "</a><br/>";
} 
```

每个有帖子的月都会显示帖子的发布次数，显然这不是我所追求的:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:46:40.473

尝试这个：

```
SELECT DISTINCT(MONTHNAME(date)) as post_month
FROM article 
```

DISTINCT 从应用的列中删除重复项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:45:04.373

使用`DISTINCT`关键字：

```
SELECT DISTINCT MONTH(date) FROM article ... 
```

# java - TextView 中的 SetText String[]

> ID：10366931
> 
> 赞同：0
> 
> 时间：2012-04-28T19:43:44.023
> 
> 标签：java, android

我正在尝试使用`setText`，并且我想使用`String`数组。首先，我创建一个`String []`，然后我将数据分配给`String[0]`，然后我想`.setText(String[0])`在我的`TextView`，这是正确的方法吗？注意：我使用 StringTokenizer 在文本文件中拆分字符串

```
 try {
    filename = "myk.txt";
    FileReader filereader = new FileReader(Environment.getExternalStorageDirectory() +      "/Q/" + filename);
    BufferedReader bufferedreader = new BufferedReader(filereader);

      try {
        while ((text = bufferedreader.readLine()) != null){
            sb.append(text);
            sb.toString().split(";");
            tokens = new StringTokenizer(sb.toString(), ";");

            ///NULLPOINTER EXEPTION HERE//// if (tokens.countTokens() > 0){questionfromfile[0] = tokens.nextToken();
            }

        }
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} catch (FileNotFoundException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}
 ////ETC ...//// and now textview.setText(question[0]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T19:46:06.370

当然，你的意思是

```
String[] strings = new String [5];
strings[0] = "foobar";
component.setText(strings[0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T23:08:06.320

为什么你有这条线：

```
sb.toString().split(";"); 
```

?

您是否忘记了字符串是不可变的，这意味着使用您使用的标准 API，字符串永远不会改变自己，而是创建新对象？

关于 StringTokenizer，正如[javadocs](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/StringTokenizer.html)所说：

> StringTokenizer 是一个遗留类，出于兼容性原因保留，但不鼓励在新代码中使用它。建议任何寻求此功能的人改用 String 的 split 方法或 java.util.regex 包。

# java - Apache MyFaces JSF2.0 错误：getStateHelper().put 不保存任何东西？

> ID：10366934
> 
> 赞同：0
> 
> 时间：2012-04-28T19:44:06.370
> 
> 标签：java, jakarta-ee, jsf-2, myfaces, mojarra

MyFaces 似乎忽略了我在此组件中对 getStateHelper.put() 的调用：

```
public class BFTableComponent extends UINamingContainer {
...
    private void setCurrentPageNumber(int currentPageNumber) {
        getStateHelper().put(PropertyKeys.currentPageNumber, currentPageNumber);
    }

    public int getCurrentPageNumber() {
        return (Integer) getStateHelper().eval(PropertyKeys.currentPageNumber, 0);
    }

public void nextPage() {
    setCurrentPageNumber(getCurrentPageNumber() + 1);
    updateCurrentPage();
}

public void previousPage() {
    setCurrentPageNumber(getCurrentPageNumber() - 1);
    updateCurrentPage();
}

...
} 
```

可以看到，当前端组件调用 nextPage 时，目标是将页码前移一位。但是，当在 MyFaces 中运行它时，eval() 调用将适用于即时请求生命周期，但下一个请求将返回 0。如果我输入 null 而不是 0，我会得到一个 NPE。

pageNumber 状态需要在组件的生命周期内携带，而不仅仅是当前请求。我究竟做错了什么？这段代码在 Mojarra 下运行良好，但在 MyFaces 中不行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T20:52:44.640

原来它实际上是 MyFaces 中某个地方的错误。我在 Apache TomEE beta2 中运行它。它包括 MyFaces 2.1.2。我用 2.1.7 替换了罐子，问题自行解决了。

感谢您的关注！

# jquery - jQuery中的表单提交事件错误

> ID：10366941
> 
> 赞同：1
> 
> 时间：2012-04-28T19:44:43.407
> 
> 标签：jquery

我有一个接受用户数字输入的表单。表单提交时，调用一个JS函数来检查表单状态（如果参数正常等）。它的动作之一是启动 AJAX 请求以接收两个值，具体取决于其参数（从表单中读取）。所以，我有一个名为 CheckForm() 的函数，它在表单提交时运行，在其中，我有一个启动 AJAX 请求的块：

```
var error = 0;
function CheckForm() { // run on form submit
  var items = $('myitems');
  if (items != undefined || items != null) {
    items.each(function() {
      if (!isNaN($(this).val())) { // check for number
        $.get('myurl', {
           // parameters
        },
        function(data) {
          if (data != "0") {
            if (condition) error = 1;
          }
        });
      }
      if (error == 1) return false;
    }); // end each function
    if (error == 1) {
      alert("You have made an error.");
      error = 0;
      return false;
    }
  }
  return true;
} 
```

我还声明了一个全局变量（错误）来检查检查过程中是否发生了错误。myitems 是运行检查的 html 元素的集合。因此，此函数绑定到表单提交单击事件并在提交时运行。

问题：这不起作用。显示警报并立即刷新浏览器页面（提交表单），而无需用户先单击“确定”按钮。

还有其他方法可以实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:55:46.703

首先，当您在 jQuery 中使用选择器时，结果永远不会为 null 或未定义，因此您可以这样做：

```
$('myitems').each(function().... 
```

其次，您必须意识到您正在进行*异步*调用 (AJAX)，这意味着该函数`CheckForm`甚至可能在其中一个`get`调用完成之前返回。

# compiler-construction - 二维数组的类型表达式应该是什么？

> ID：10366943
> 
> 赞同：2
> 
> 时间：2012-04-28T19:45:04.163
> 
> 标签：compiler-construction, types

具有 M 个 T 类型元素的数组的类型表达式为

> 数组（1...M，T）

那么对于具有 M 行和 N 列的 2D 数组应该是什么？它应该是两个数组的笛卡尔积吗？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:46:23.977

对于 M*N 数组，类型表达式将是

> **数组（1...M，数组（1...N，类型））**

其中 M 是行数，N 是列数。只需将二维数组视为数组数组即可。

# c# - 如何以编程方式打开按钮的鼠标悬停效果？

> ID：10366945
> 
> 赞同：4
> 
> 时间：2012-04-28T19:45:05.570
> 
> 标签：c#, wpf, button

我对 wpf 中的按钮有疑问。如果我将鼠标移到按钮上，它会变成默认的浅蓝色，但我在按钮中有一个图像，所以当鼠标在那里时图像会隐藏。

我已经看到了一些解决方案，但它们是在 XAML 代码中制作的。我以编程方式创建了我的按钮，所以它不起作用。如果我没有将光标放在最后一个按钮上，它也会一直闪烁。问题是一样的。所以我需要 C# 代码而不是 xaml 代码。

有任何想法吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T20:16:18.633

闪烁按钮和蓝色突出显示颜色是按钮默认样式的一部分，要更改它，您需要覆盖默认样式。我建议在 XAML 中创建您的样式，然后以编程方式分配它。[您可以在此处](http://msdn.microsoft.com/en-us/library/ms753328.aspx)获取默认按钮样式，然后查看有关如何以编程方式设置样式的[帖子。](http://en.csharp-online.net/WPF_Styles_and_Control_Templates%E2%80%94Setting_Styles_Programmatically)

**更新：** 这似乎对我有用，这就是我所做的：

在后面的代码中创建有问题的按钮并设置样式：

```
public MainWindow()
{
    InitializeComponent();

    Bitmap bitMap = new Bitmap(@"\path\to\image.png");
    MemoryStream ms = new MemoryStream();
    bitMap.Save(ms, ImageFormat.Png);
    ms.Seek(0,SeekOrigin.Begin);

    BitmapImage bitMapImage = new BitmapImage();
    bitMapImage.BeginInit();
    bitMapImage.StreamSource = ms;
    bitMapImage.EndInit();

    Image image = new Image();
    image.Source = bitMapImage;
    image.Height = 100;

    Button button = new Button();
    button.Height = 200;
    button.Width = 200;
    button.Content = image;
    button.Style = button.Style = (Style)FindResource("myButtonStyle");

    myGrid.Children.Add(button);
 } 
```

通过复制和粘贴 microsoft 提供的按钮样式并修改为您想要的行为，在 XAML 中创建样式。为了禁用鼠标悬停效果，我注释掉了该部分`<VisualState x:Name="MouseOver"> ... </VisualState>`

```
<Style x:Key="myButtonStyle" TargetType="Button">
    <!-- Style copied from MSDN Button Style page -->
    <!-- Remove or comment out <Setter Property="FocusVisualStyle" Value="{StaticResource ButtonFocusVisual}" /> -->
    <!-- Remove or comment out <VisualState x:Name="MouseOver> ... </VisualState>
    <!-- Change colors to your liking or set to Transparent to not show color -->
    ....
</Style> 
```

# iphone - 如何从 AppDelegate 引用 ViewController 中的变量？

> ID：10366948
> 
> 赞同：0
> 
> 时间：2012-04-28T19:45:19.087
> 
> 标签：iphone, ios5

我的 ViewController 中有一个 facebook 变量，我想在我的 AppDelegate 方法中引用它。我该怎么做呢？

在我的 AppDelegate 中我想放这个，因为它使用 UIApplication 并且所有其他参考都在这个类中：

```
 // For iOS 4.2+ support
    - (BOOL)application:(UIApplication *)application openURL:(NSURL *)url
      sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
        return [facebook handleOpenURL:url]; 
    } 
```

facebook 变量在我的 ViewController .h 文件中：

```
 #import <UIKit/UIKit.h>
    #import "FBConnect.h"

    @interface ImportPicViewController : UIViewController <FBSessionDelegate, FBDialogDelegate>{
        Facebook *facebook;
    }
    @property (nonatomic, retain) Facebook *facebook;
    @end 
```

并在.m文件中合成：

```
 @implementation ImportPicViewController
    @synthesize facebook; 
```

但它是 ViewController 中的 alloc init：

```
 - (void)viewDidLoad
    {
        [super viewDidLoad];
        facebook = [[Facebook alloc] initWithAppId:@"224207854355440" andDelegate:self]; 
```

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:57:19.010

> 我的 ViewController 中有一个 facebook 变量，我想在我的 AppDelegate 方法中引用它。

这听起来不是一个好的计划——这意味着你的应用程序委托依赖于这个视图控制器。

更好的设计可能是让应用程序委托创建 Facebook 的实例并在其自己的 ivar 中保留对它的引用。然后，当它创建视图控制器时，它可以传入对 Facebook 实例的引用。这样，应用程序委托和视图控制器都使用相同的 Facebook 对象，但它们不会尝试访问彼此的实例变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T19:51:33.730

在 AppDelegate 中声明一个公共方法，它接受指向您的 ViewController 的指针。然后将接收到的指针存储在 AppDelegate 中。一旦您需要 ViewController，只需使用存储的指针。

使用“facebook”的一种更丑陋的方法是将它放在一个全局变量中。

# c - OpenSSL 使用 EVP 与算法 API 进行对称加密

> ID：10366950
> 
> 赞同：18
> 
> 时间：2012-04-28T19:45:22.150
> 
> 标签：c, linux, cryptography, openssl

嗨，我已经在我的 linux 机器上安装了 openssl 并浏览了头文件和文档（这是非常不足的 :( ）。

我正在尝试构建一个使用对称加密算法的项目（在“c”中）（我专注于 aes256cbc）。问题是我对如何在我的代码中使用库函数感到困惑。

对于我的 aes256cbc 实现，我可以直接使用“aes.h”头文件中定义的函数（首先出现在我看来）。

但是在谷歌搜索时，我遇到了一些使用 'evp.h' 函数来执行此操作的教程[http://saju.net.in/code/misc/openssl_aes.c.txt](http://saju.net.in/code/misc/openssl_aes.c.txt)

是否有特定原因或直接访问 aes.h 函数更好。

**而且，如果有人可以向我指出有关使用 openssl 加密库的任何类型的良好文档/教程，我将不胜感激。**

非常感谢

PS如果我太天真，请原谅我

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-28T23:24:03.363

使用 EVP API 的优势在于，您可以以通用方式对 OpenSSL 支持的所有对称密码使用相同的 API。这使得替换使用的算法变得更容易，或者使算法在以后阶段可由用户配置。您编写的大多数代码并不特定于您选择的加密算法。

下面是一个在 CBC 模式下使用 AES-256 进行加密的简单示例：

```
#include <stdio.h>
#include <openssl/evp.h>

int main()
{
    EVP_CIPHER_CTX ctx;
    unsigned char key[32] = {0};
    unsigned char iv[16] = {0};
    unsigned char in[16] = {0};
    unsigned char out[32]; /* at least one block longer than in[] */
    int outlen1, outlen2;

    EVP_EncryptInit(&ctx, EVP_aes_256_cbc(), key, iv);
    EVP_EncryptUpdate(&ctx, out, &outlen1, in, sizeof(in));
    EVP_EncryptFinal(&ctx, out + outlen1, &outlen2);

    printf("ciphertext length: %d\n", outlen1 + outlen2);

    return 0;
} 
```

为简单起见，我省略了错误处理。

IMO 最重要的 OpenSSL 文档之一是[Viega/Messier/Chandra 的 OpenSSL 网络安全](http://shop.oreilly.com/product/9780596002701.do)。它是从 2002 年 (0.9.7) 开始的，因此不包括过去 10 年对 OpenSSL 的更改，但与仅使用手册页相比，IMO 学习 OpenSSL 仍然是一种不那么痛苦的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-22T15:48:12.283

目前 OpenSSL wiki 有关于如何使用 EVP 系列函数的良好文档：[http ://wiki.openssl.org/index.php/EVP](http://wiki.openssl.org/index.php/EVP)

使用 EVP over algorithm API 的另一个好处是，如果可用，EVP 将自动使用硬件加速（如 AES-NI 指令集）。使用算法 API，您需要手动启用它。

# android - 三星 Touchwiz 列表小部件

> ID：10366951
> 
> 赞同：1
> 
> 时间：2012-04-28T19:45:29.160
> 
> 标签：android, listview, samsung-mobile

我想要`Samsung Touchwiz UX`在文件管理器、音乐播放器和其他一些应用程序中使用的小部件，两个`ListView`s 在平板电脑的左右两侧，中间有一个分隔符，可以改变宽度`ListView`触摸时的左侧和右侧。

我在哪里可以得到这个`View`，或者有什么建议的方法来实现它？

多谢。

![在此处输入图像描述](../Images/e98360612e4efa9aababe6b95ff5ca4e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-26T12:28:37.430

这是用 Fragments 和 Fragment Activity 制作的！您可以开始阅读有关“构建灵活的 UI” [http://developer.android.com/training/basics/fragments/fragment-ui.html](http://developer.android.com/training/basics/fragments/fragment-ui.html)和“将多个视图合并为一个” [http://developer.android 的 Android 文档。 com/design/patterns/multi-pane-layouts.html#combining-views](http://developer.android.com/design/patterns/multi-pane-layouts.html#combining-views)

始终使用片段是一个很好的做法。

# javascript - 你能帮我修改这个 JavaScript 吗？

> ID：10366953
> 
> 赞同：-3
> 
> 时间：2012-04-28T19:45:56.570
> 
> 标签：javascript, asp.net

以下代码在执行验证规则方面效果很好。

```
function validate() {

    if (document.getElementById("<%=txtName.ClientID%>").value == "") {
        alert("Please enter name");
        document.getElementById("<%=txtName.ClientID%>").focus();
        return false;
    }

    if (document.getElementById("<%=txtCity.ClientID %>").value == "") {
        alert("Please enter city");
        document.getElementById("<%=txtCity.ClientID %>").focus();
        return false;
    }
    if (document.getElementById("<%=txtState.ClientID%>").value == "") {
        alert("Please enter state");
        document.getElementById("<%=txtState.ClientID%>").focus();
        return false;
    }
    if (document.getElementById("<%=txtZip.ClientID%>").value == "") {
        alert("Please enter zip");
        document.getElementById("<%=txtZip.ClientID%>").focus();
        return false;
    }
    if (checkradio() == false) {
        alert("Please enter contacts");
        document.getElementById("<%=txtContacts.ClientID%>").focus();
        return false;
    }
     return true;
} 
```

我的问题是表格分为 2 部分，第 1 部分和第 2 部分。

第二个 1 包含必填的表单字段，第 2 部分包含选项字段。

规则是您不能同时从两个部分中进行选择。您可以从第 1 节或第 2 节中进行选择。

第 1 部分具有上述必需的表单字段，第 2 部分在同一表单上具有可​​选的表单字段。

如果我从第 1 部分中选择，一切都很好。

如果我从第 2 节中选择，因为它们在同一个表单上，验证规则就会生效。

有没有办法让表单说，如果第 2 节中的表单字段不是空白的，那么没有验证规则生效？

更好的是，在经典的 asp 中，您可以在一个文件中包含多个表单。

这在asp.net中可能吗？

我认为这将消除从可选字段中进行选择时的验证。

对不起，长线程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T21:02:59.960

1.  在 ASP.NET 中可以有多个表单，只需在标记中添加多个表单。
2.  在你的 validate 函数中，首先检查是否设置了 form2 的任何控件，然后返回 true；否则进行其他检查。

    ```
    function validate() {

    if(... check if any controls of form 2 are set ...) return true;

    // Otherwise proceed with checks for form 1

    if (document.getElementById("<%=txtName.ClientID%>").value == "") {
        alert("Please enter name");
        document.getElementById("<%=txtName.ClientID%>").focus();
        return false;
    }

    .... 
    ```

# php - 在facebook用户的朋友墙上发帖不起作用

> ID：10366955
> 
> 赞同：0
> 
> 时间：2012-04-28T19:46:03.057
> 
> 标签：php, facebook, facebook-php-sdk

我试图完成来自 facebook 用户的邀请，将其发布在他们的朋友墙上或时间线上。

这就是我现在所拥有的，用户选择他的朋友通过多朋友选择器发送邀请，他发送邀请并通过回调我得到受邀朋友的 ID。此回调通过 ajax 提交一个表单，该表单的想法是将一些信息发布到此朋友墙或时间轴中。

但是，用户朋友墙上的帖子不起作用，我真的不知道为什么。这就是我现在得到的：（未显示多好友选择器功能，因为它可以正常工作并且表单已成功提交用户 ID）

```
$ids=$_POST['ids']; //comma separated string with friend's id
$userid=$_POST['userid'];//user id
$ids=explode(',', $ids);

$facebook = new Facebook(array(
  'appId'  => 'xxx',
  'secret' => 'xxx',
));

    for($i=0;$i<count($ids);$i++){
$attachment = array(
    'message' => 'Responde encuestas en Metrik y los dos ganamos 10 puntos!',
    'name' => 'Metrik Studios Social Surveys',
    'caption' => "responde encuestas y prueba productos novedosos a través de Metrik. Acumula kiloemtros Lanpass, recibe dinero, dona a fundaciones y mucho más.",
    'link' => $canvas_page.'?ref='.$userid,
    'description' => 'Metrik Studios',
    'picture' => 'http://metrikstudios.com/fbapp/logo.jpg',

);

$result = $facebook->api('/'.$ids[$i].'/feed/', 'post', $attachment);

}
?> 
```

其他一些信息：这是 fb 上的画布应用程序，用户授予该应用程序的 publish_stream 权限。当我改变时：$result = $facebook->api('/'.$ids[$i].'/feed/', 'post', $attachment); 对于： $result = $facebook->api('/me/feed/', 'post', $attachment); 帖子被编入用户供稿

谢谢您的帮助！

编辑：好的，我认为问题在于应用程序处于沙盒模式。这样没有人可以看到应用程序的帖子。

实际上，我关闭了沙盒模式，并喜欢将 20 个帖子添加到我的朋友提要中。这可能吗？希望如果有人像我一样陷入这种愚蠢的境地，这会有所帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T20:14:48.600

改用此语法在某人的 Facebook 墙上发帖。

```
try {
    $newStatus = $facebook->api("/$USERID/feed", 'POST',
    array(
      'link' => "https://apps.facebook.com/XXXXXXXXX",
      'picture' => "https://XXXXXXXXX", //colour
      'name' => "XXXXXXXXX",
      'description' => "XXXXXXXXX",
      'access_token' => $access_token
     ));
     //echo '<pre>Post ID: ' . $newStatus['id'] . '</pre>';
} catch(FacebookApiException $e) {
        error_log($e->getType());
        error_log($e->getMessage());
        //echo '<textarea style="width: 300px; height: 200px;">' . $e->getMessage() . '</textarea>';
} 
```

# java - 最佳实践：对将 Socket 作为参数的方法进行单元测试？

> ID：10366957
> 
> 赞同：1
> 
> 时间：2012-04-28T19:46:10.173
> 
> 标签：java, unit-testing, sockets

我试图对一类方法进行单元测试，这些方法接受他们读写的 Socket 对象。我想知道，最好的方法是什么？我在一个团队中工作（这是一个大学项目）并且只负责这个（java）类，所以完全重构代码并不是一个真正的选择。

是否有任何可用的模拟套接字，例如“Mocket”之类的？你会如何处理这个问题？

正如我所提到的，我是一名大学生，所以我期待着从论坛的智慧中学习。感谢您花时间回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T20:06:50.370

为了使您的代码可测试，依赖的类`Socket`应该依赖于套接字的抽象——例如，公开您使用的方法（如读取和写入）的简单接口。您的应用程序将使用真实类的包装器`Socket`，但在单元测试中您将能够使用模拟（请查看[JMock](http://www.jmock.org/)）。

考虑：

```
public interface ISocket
{
    byte[] read();
    int write(byte[] content);
}

public class SocketWrapper : ISocket
{
    // read and write methods simply delegate work to real socket
}

public class ClassToTest
{
    private ISocket socket;

    public ClassToTest(ISocket socket)
    {
        this.socket = socket;
    }
} 
```

现在在您的单元测试中，您可以创建模拟`ISocket`并将其传递给`ClassToTest`构造函数。这样，您就可以将单元测试与其依赖项隔离开来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T23:24:46.410

所有好的建议，谢谢！问题是，我必须保留给我的接口/api，以免破坏自动评分器。

我所做的只是继承 Socket 类（我最终调用了我的子类 Mocket），然后覆盖 getInputStream 和 getOutputStream 方法。这使我能够控制进出方法的数据流，并且足以进行测试。

感谢大家！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T20:12:03.317

我认为您需要先声明套接字接口，例如：

```
public interface IClient{
 bool connect(...);
 bool disconnect(...);
 bool sendData(...);
} 
```

之后创建一个实现接口的类。此类将包含一个 Socket。

在您需要测试代码的类中，您将传递客户端的接口，而不是具体的实现。通过这种方式：1）您将能够交换系统的行为，而不会对您的测试类进行任何更改。2）您将能够使用您需要的任何实现来模拟您的客户端，因此您将比使用套接字作为参数更容易地测试代码。

# .net - EF4.3 + sqlite 多对多关系

> ID：10366966
> 
> 赞同：1
> 
> 时间：2012-04-28T19:47:01.703
> 
> 标签：.net, entity-framework, sqlite, many-to-many

我正在使用**实体框架 4.3**和**SQLite**在实体之间建立**多对多**关系。但在运行时，Group.Parameters 和 Parameter.Groups 集合是空的，直到我手动添加它们。

实体是：

```
public class Group
{
    public Group()
    {
        Parameters = new ObservableCollection<Parameter>();
    }
    public Int64 Id { get; set; }
    public string Name { get; set; }
    public ObservableCollection<Parameter> Parameters { get; set; }
}

public class Parameter
{
    public Parameter()
    {
        Groups = new ObservableCollection<Group>();
    }

    public Int64 Id { get; set; }
    public string Name { get; set; }
    public ObservableCollection<Group> Groups { get; set; }
} 
```

在 OnModelCreating 中：

```
modelBuilder.Entity<Group>().HasMany(g => g.Parameters).WithMany(p => p.Groups).Map(c =>
{
    c.MapLeftKey("GroupId");
    c.MapRightKey("ParameterId");
    c.ToTable("Groups_has_Parameters");
}); 
```

创建表的sql：

```
create table if not exists Parameters
(
    Id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    Name TEXT NOT NULL
);

create table if not exists Groups
(
    Id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    Name TEXT NOT NULL
);
create table if not exists Groups_has_Parameters
(
    GroupId INTEGER NOT NULL,
    ParameterId INTEGER NOT NULL,
    PRIMARY KEY (GroupId, ParameterId),

    FOREIGN KEY (GroupId) REFERENCES Groups(Id),
    FOREIGN KEY (ParameterId) REFERENCES Parameters(Id)
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T01:00:00.073

要启用延迟加载，请使您的导航属性虚拟化。例如：

```
public virtual ObservableCollection<Parameter> Parameters { get; set; } 
```

这样 EF 将在第一次访问时自动从数据库加载集合。

如果您不想将它们设为虚拟或延迟加载，那么您可以随时使用以下方式显式加载集合：

```
context.Entry(group).Collection(g => g.Parameters).Load(); 
```

或者，正如 Gaga 建议的那样，您可以在使用 Inlcude 对数据库进行初始查询时急切地加载集合：

```
context.Groups.Include(g => g.Parameters); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T00:22:38.830

你所拥有的应该可以正常工作（虽然我不确定 SqlLite 提供程序的细节），

只需将其添加到查询中，`.Include(x=>x.Parameters)`例如

```
db.Groups.Include(x=>x.Parameters) 
```

否则它是“懒惰的”。

# objective-c - 尺寸检查器中有一个名为 Autosizing 的部分。如何从 OS X 中的代码执行此操作？

> ID：10366968
> 
> 赞同：0
> 
> 时间：2012-04-28T19:47:10.880
> 
> 标签：objective-c, xcode, cocoa, inspector

尺寸检查器中有一个部分，其名称`Atosizing`可以设置控件的左、右、上、下布局，我该如何从代码中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T20:10:16.760

在 NSView API 中，您可以使用 -setAutoresizingMask:设置[自动调整掩码。](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/nsview_Class/Reference/NSView.html)

# doxygen - Doxygen：如何从包名中删除 eu.mycompany

> ID：10366969
> 
> 赞同：0
> 
> 时间：2012-04-28T19:47:13.203
> 
> 标签：doxygen, doxygen-wizard

我已经看过[这篇文章](https://stackoverflow.com/questions/6677951/hide-common-package-in-doxygen-output)，但我仍然不明白如何只保留包层次结构的某个部分来显示类名（在 Windows 下工作）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T08:10:57.767

使用 UnixUtils 的 Chris 提示对我来说效果很好

# hadoop - 如何在 Hadoop 中运行 wordCount 示例？

> ID：10366971
> 
> 赞同：1
> 
> 时间：2012-04-28T19:47:19.313
> 
> 标签：hadoop

我正在尝试在 hadoop 中运行以下示例：http: [//hadoop.apache.org/common/docs/current/mapred_tutorial.html](http://hadoop.apache.org/common/docs/current/mapred_tutorial.html)

但是我不明白正在使用的命令，特别是如何创建输入文件，将其上传到 HDFS，然后运行字数统计示例。

我正在尝试以下命令：

```
bin/hadoop fs -put inputFolder/inputFile inputHDFS/ 
```

但是它说

```
put: File inputFolder/inputFile does not exist 
```

我在hadoop文件夹中有这个文件夹，它是“bin”之前的文件夹，为什么会这样？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T20:52:25.383

## 希望这不是矫枉过正：

假设您已经[安装了 hadoop](http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-single-node-cluster/)（本地、分布式或伪分布式），您必须确保 hadoop 的 bin 和其他 misc 参数在您的路径中。在 linux/mac 中，只需将以下内容添加到您的一个 shell 文件（`~/.bashrc`、`~/.zshrc`、`~/.bash_profile`等 - 取决于您的设置和偏好）中，这很简单：

```
export HADOOP_INSTALL_DIR=/path/to/hadoop # /opt/hadoop or /usr/local/hadoop, for example
export JAVA_HOME=/path/to/jvm
export PATH=$PATH:$HADOOP_INSTALL_DIR/bin
export PATH=$PATH:$HADOOP_INSTALL_DIR/sbin 
```

然后运行`exec $SHELL`或重新加载您的终端。要验证 hadoop 是否正在运行，请键入`hadoop version`并查看没有引发错误。假设您按照有关如何设置单节点集群的说明并使用`start-all.sh`命令启动了 hadoop 服务，那么您应该很高兴：

*   在伪 dist 模式下，您的文件系统伪装成 HDFS。因此，只需像使用任何其他 linux 命令一样引用任何路径，例如`cat`or `grep`。这对于测试很有用，您不必复制任何内容。

*   在实际运行 HDFS 的情况下，我使用`copyFromLocal`命令（我发现它可以正常工作）：

    ```
     $ hadoop fs -copyFromLocal ~/data/testfile.txt /user/hadoopuser/data/ 
    ```

在这里，我假设您在作为集群一部分的机器上执行复制。请注意，如果您的 hadoopuser 与您的 unix 用户名相同，则可以删除该`/user/hadoopuser/`部分 - 隐式假定它在您的 HDFS 用户目录中执行所有操作。此外，如果您使用客户端计算机在集群上运行命令（您也可以这样做！），请知道您需要在`-conf`之后使用 flag传递集群的配置`hadoop fs`，例如：

```
# assumes your username is the same as the one on HDFS, as explained earlier
$ hadoop fs -conf ~/conf/hadoop-cluster.xml -copyFromLocal ~/data/testfile.txt data/ 
```

对于输入文件，您可以使用任何包含文本的文件。[我使用了来自Gutenberg 网站](http://www.gutenberg.org/catalog/)的一些随机文件。

最后，要运行 wordcount 示例（作为 hadoop 发行版中的 jar 提供），只需运行以下命令：

$ hadoop jar /path/to/hadoop-*-examples.jar wordcount /user/hadoopuser/data/ /user/hadoopuser/output/wc

这将读取`data/`文件夹中的所有内容（可以有一个或多个文件）并将所有内容写入`output/wc`文件夹 - 全部在 HDFS 上。如果您在伪 dist 中运行它，则无需复制任何内容 - 只需将其指向正确的输入和输出目录。确保该`wc`目录不存在，否则您的工作将崩溃（无法覆盖现有目录）。[请参阅此](http://wiki.apache.org/hadoop/WordCount)以获得更好的字数细分。

同样，所有这一切都假设您已成功通过设置阶段（不小壮举）。

希望这不会太令人困惑 - 祝你好运！

# java - JTattoo 出现在 JMenu 下拉菜单中

> ID：10366972
> 
> 赞同：4
> 
> 时间：2012-04-28T19:47:24.337
> 
> 标签：java, swing, look-and-feel, jmenu

我在我的 java 文件中成功使用了 JTattoo。但是“JTattoo”字样出现在 JMenu 的下拉菜单中。有没有办法摆脱它？或者我可以替换那个文本吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T20:26:30.533

在他们的网站上，他们建议您为此需要许可证密钥。请参阅[此页面](http://www.jtattoo.net/HowTo_ChangeLogo.html)，我在“如何更改弹出菜单中的徽标文本”后面找到了该页面。关联 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-04T21:51:59.433

您可以使用`setTheme()`带有三个参数的方法，将第一个设置为您喜欢的主题，将其他设置为空字符串（不是`null`，只是字符串`""`）；这是 LaF“纹理”和主题“纺织”的示例：

```
TextureLookAndFeel.setTheme("Textile", "", ""); 
```

我检查了许可证，但没有发现任何反对这样做的地方。如果许可证或类似的东西禁止它，请有人告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-10T08:59:24.787

根据 JTattoo 网站： [http](http://www.jtattoo.net/HowTo_ChangeLogo.html) ://www.jtattoo.net/HowTo_ChangeLogo.html 您可以使用以下代码：

```
Properties props = new Properties();
props.put("logoString", "my company");
AeroLookAndFeel.setCurrentTheme(props);
UIManager.setLookAndFeel("com.jtattoo.plaf.aero.AeroLookAndFeel"); 
```

你可以改变你的lookandfeel，即AluminiumLookAndFeel.set...

# javascript - 在 JavaScript 中正确格式化 JavaScript

> ID：10366985
> 
> 赞同：1
> 
> 时间：2012-04-28T19:48:44.967
> 
> 标签：javascript, indentation, pretty-print

如何正确自动格式化 JavaScript？

例如，这个：

```
(function(){(function(){alert('whatever')})()})() 
```

应该变成：

```
(function(){
    (function(){
        alert('whatever')
    })()
})() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:50:32.527

有[jsbeautifier ，你可以在](http://jsbeautifier.org)[github](https://github.com/einars/js-beautify)上找到源代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T19:51:33.013

试试[http://jsbeautifier.org/](http://jsbeautifier.org/) - 它与[jsfiddle.net](http://jsfiddle.net/)在他们的“整理”按钮上使用的相同，您可以在其中试用。

# objective-c - 将局部变量更改为实例变量后的重构

> ID：10366988
> 
> 赞同：0
> 
> 时间：2012-04-28T19:48:58.377
> 
> 标签：objective-c

将局部变量更改为实例变量后，我的代码遇到了一些问题。具体来说，在从以下位置更改一行代码后，我的 HypnosisterAppDelegate.m 文件中的代码遇到了问题：

```
HypnosisView *view = [[HypnosisView alloc]initWithFrame:screenRect]; 
```

至

```
view = [[HypnosisView alloc]initWithFrame:screenRect]; 
```

我已经注释掉了 HypnosisterAppDelegate.m 中的错误消息你能告诉我有什么问题吗？提前致谢。

HypnosisterAppDelegate.m

```
#import "HypnosisterAppDelegate.h"
#import "HypnosisView.h"

@implementation HypnosisterAppDelegate

@synthesize window = _window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.

  CGRect screenRect = [[self window]bounds];

  // Create the UIScrollView to have the size of a window, matching its size
  view = [[HypnosisView alloc]initWithFrame:screenRect];
  [scrollView setMinimumZoomScale:1.0];  // Unknown receiver "scrollView"; should it be "UIScrollView"?
  [scrollView setMaximumZoomScale:5.0];  // Unknown receiver "scrollView"; should it be "UIScrollView"?

   //You will get a warning here, ignore it for now
 [scrollView setDelegate:self]; // Unknown receiver "scrollView"; should it be "UIScrollView"?

  [[self window] addSubview:scrollView]; // Unknown receiver "scrollView"; should it be "UIScrollView"?

  //Create the HypnosisView with a frame that is twice the size of the screen
  CGRect bigRect = screenRect;

  HypnosisView *view = [[HypnosisView alloc]initWithFrame:screenRect];

  // Add the HypnosisView as a subview of the scrollView instead of the window
  [scrollView addSubview:view]; // Unknown receiver "scrollView"; should it be "UIScrollView"?

  // Tell the scrollView how big its virtual world is
  [scrollView
   setContentSize:bigRect.size]; // Unknown receiver "scrollView"; should it be "UIScrollView"?

  BOOL success = [view becomeFirstResponder];
  if (success) {
    NSLog(@"HypnosisView became the first responder");
    } else {
    NSLog(@"Could not become the first responder");
  }

  self.window.backgroundColor = [UIColor whiteColor];
    [self.window makeKeyAndVisible];
    return YES;
}

-(UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView
{
  return view;
}

@end 
```

催眠视图.h

```
#import <Foundation/Foundation.h>

@interface HypnosisView : UIView {

}

@property(nonatomic,strong)UIColor *circleColor;
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T20:19:04.100

您没有在`scrollView`任何地方调用的变量。我猜（尤其是从评论`// Create the UIScrollView to have the size of a window, matching its size`中，并且我自己也读过这本书）你打算创建一个`UIScrollView`：

```
// not:  view = [[HypnosisView alloc]initWithFrame:screenRect];
// but:
UIScrollView * scrollView = [[UIScrollView alloc] initWithFrame:screenRect]; 
```

然后将您的`HypnosisView`稍后添加为子视图。

# c# - 随机滚动的通电全部激活，而不仅仅是一个

> ID：10366990
> 
> 赞同：1
> 
> 时间：2012-04-28T19:49:01.280
> 
> 标签：c#, xna

问题：我的所有/大部分 Powerups 都立即激活，而不是仅存储随机选择（滚动）的 1，然后按 LeftCtrl 键激活。

我对使用枚举还是个新手，在使用`EventArgs`.

我已经对它们进行了很多阅读，但仍然不确定它们是如何工作的，我相信这就是我的问题所在。

除了 Powerup 类之外，我还在下面的 Game1 类中包含了代码。

类别：游戏1

```
if (input.RollPowerup == true)
{
    //generate a random powerup
    PowerupType type = (PowerupType)random.Next(Enum.GetNames(typeof(PowerupType)).Length);

    switch (type)
    {
        case PowerupType.BigBalls:
            {
                powerup = new Powerup(type, 10.0f, 1.0f);
                ball.GrowBall();
                break;
            }

         case PowerupType.ShrinkBalls:
            {
                powerup = new Powerup(type, 10.0f, 1.0f);
                ball.ShrinkBall();
                break;
            }
        case PowerupType.BigPaddle:
            {
                powerup = new Powerup(type, 10.0f, 1.0f);
                leftBat.GrowBat();
                break;
            }
        case PowerupType.ShrinkEnemy:
            {
                powerup = new Powerup(type, 10.0f, 1.0f);
                rightBat.ShrinkBat();
                break;

            }
        case PowerupType.SpeedBall:
            {
                powerup = new Powerup(type, 10.0f, 20.0f);
                ball.IncreaseSpeed();
               break;

            }
        case PowerupType.Heal:
            {
                powerup = new Powerup(type, 1.0f, 1.0f);
                hud.AddHealthP1();

                break;
            }
        case PowerupType.Regen:
            {
                powerup = new Powerup(type, 20.0f, 1.0f);

                break;
            }
    }

    powerupInitialized = false;

}
else if (input.ActivatePowerup == true)

{
    powerup.Activate();
}

if (powerup != null && IsActive)
{
    if (!powerupInitialized)
    {
        powerup.Activated += PowerupActivated;
        powerup.Deactivated += PowerupDeactivated;

        if (powerup.Type == PowerupType.Regen)
            powerup.Tick += PowerupTick;

        powerupInitialized = true;
    }

    powerup.Update((float)gameTime.ElapsedGameTime.TotalMilliseconds);
} 
```

类别：通电

```
public void Activate()
{
    IsAlive = true;
     //   powerupActivate.Play(); // Plays the SFX to notify user that item has been selected

    if (Activated != null)
        Activated(this, eventArgs);

    if (Type <= PowerupType.ThreeBurst)
    {
        //no need to call Deactivated unless you really want to 
        IsAlive = false;
    }
}

      public virtual void Update(float elapsed)
{
    // Checks if the player is still alive or not   
    if (IsAlive)
    {
        elapsedLifetime += elapsed;

        if (elapsedLifetime >= maxLifetime)
        {
            IsAlive = false;

            if (Deactivated != null)
                Deactivated(this, eventArgs);
        }
        else if (elapsedLifetime >= (lastTick + 1) * 1000)
        {
            lastTick++;

            if (Tick != null)
                Tick(this, eventArgs);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:37:04.263

几件事：

*   看起来您正在通过调用 hud、ball 和 bat 方法立即激活一些通电。是这样吗？我以为玩家必须手动激活它们？这些调用将进入由 powerup 的 Activate 事件调用的事件处理程序。
*   您是否在某处将 input.RollPowerup 和 input.ActivatePowerup 重置为 false？如果不是，那可能会导致意想不到的问题，可能所有的电源都会同时激活，因为每帧都会生成一个新的电源。
*   您可能还希望将事件连接移动到游戏类的构造函数或 Initialize 方法。这将消除检查，我假设每帧都会发生这种情况。
*   您可能不需要每次都创建新的通电。只需将其重置为所选类型即可。这意味着向 powerup 类添加一个属性——比如 IsActive。您的代码将如下所示：

```
 if (input.RollPowerup == true)
{
    //generate a random powerup
    PowerupType type = (PowerupType)random.Next(Enum.GetNames(typeof(PowerupType)).Length);
   switch (type)
    {
        case PowerupType.BigBalls:
            {
                powerup.Reset(type, 10.0f, 1.0f);

                break;
            }

         case PowerupType.ShrinkBalls:
            {
                powerup.Reset(type, 10.0f, 1.0f);

                break;
            }
        case PowerupType.BigPaddle:
            {
                powerup.Reset(type, 10.0f, 1.0f);

                break;
            }
        case PowerupType.ShrinkEnemy:
            {
                powerup.Reset(type, 10.0f, 1.0f);

                break;

            }
        case PowerupType.SpeedBall:
            {
                powerup.Reset(type, 10.0f, 20.0f);

               break;

            }
        case PowerupType.Heal:
            {
                powerup.Reset(type, 1.0f, 1.0f);

                break;
            }
        case PowerupType.Regen:
            {
                powerup.Reset(type, 20.0f, 1.0f);

                break;
            }
    }

    powerupInitialized = false;

}
else if (input.ActivatePowerup == true)

{
    powerup.Activate();
}

if (powerup.IsActive)
{
    powerup.Update((float)gameTime.ElapsedGameTime.TotalMilliseconds);
} 
```

它可能比这更多，但这就是我到目前为止所看到的。如果您想在某处上传项目并将链接通过电子邮件发送给我，那很好。

# mysql - 使用 Zend_Db 将 TIME 字段设置为 NULL

> ID：10366996
> 
> 赞同：3
> 
> 时间：2012-04-28T19:49:27.383
> 
> 标签：mysql, zend-framework, pdo, zend-db

我遇到了`Zend_Db`PHP 的 PDO MySQL 驱动程序的一个奇怪问题，这可能源于我对这两者缺乏了解。

假设我有一个带有`NULL`able`TIME`字段的MySQL 表。如果我在 MySQL 客户端运行这样的查询：

```
UPDATE mytable SET mytime = NULL WHERE id = 1; 
```

一切都按预期工作，并且*mytime*字段将`NULL`在此查询后保留为值。

但是，如果我在 PHP 中通过 运行完全相同的查询`Zend_Db_Adapter`，则*mytime*字段将设置为`'0:0:0'`在此类查询之后：

```
$db->getConnection()->exec('UPDATE mytable SET mytime = NULL WHERE id = 1'); 
```

如何将该 TIME 字段设置为 NULL？

我将 PHP5.3 与 PDO MySQL 驱动程序、Zend Framework 1.11 和 MySQL 5.1 一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T00:01:27.947

你有什么应该工作，即：

```
$db->getConnection()->exec('UPDATE mytable SET mytime = NULL WHERE id = 1'); 
```

那应该行得通。我测试了它。

## 警告

如果数据类型**time**是`NOT NULL`，那么尝试将其设置为`NULL`将导致值`NULL`默认为`00:00:00`，这可能是意外行为，例如：

```
CREATE TABLE `test` (
    `time` datetime NOT NULL
); 
```

尝试插入或更新上面的时间字段`NULL`将导致值`00:00:00`被插入。

这与日期、日期时间和其他一些数据类型类似。例如，尝试设置数据类型**datetime**`NOT NULL` **将** 其`NULL`默认值设置为`0000-00-00 00:00:00`。

*`NULL`注意：当您尝试将值设置为数据类型时， Mysql 不会抛出错误，您可以通过将 MySQL 设置为来`NUT NULL`更改此行为：请参阅[此 stackoverflow 问题](https://stackoverflow.com/questions/10090293/best-practice-mysql-configuration-in-development)。`SQL_MODE``STRICT_ALL_TABLES`*

## 修复

将字段更改为允许`NULL`，应该没问题：

```
CREATE TABLE `test` (
    `time` datetime DEFAULT NULL
); 
```

现在可以将时间字段设置为`NULL`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T20:18:34.690

使用`new Zend_Db_Expr('NULL')`而不是 NULL ：

```
$zend_null = new Zend_Db_Expr('NULL');
$db->getConnection()->exec("UPDATE mytable SET mytime = $zend_null WHERE id = 1"); 
```

# xcode - 核心情节 - 从一个类中分配一个 CPTGraphHostingView

> ID：10366997
> 
> 赞同：0
> 
> 时间：2012-04-28T19:49:42.423
> 
> 标签：xcode, macos, cocoa, core-plot, viewcontroller

我一直在尝试让仪表板与使用 Core Plot 呈现的各种图表一起工作。通过将代码包含在 AppDelegate.m 中，我已经设法让第一个按我想要的方式工作，但这使得第二个工作变得困难，并且意味着如果我包含它们，我的 AppDelegate 将变得庞大且难以使用都在同一个文件中。

有什么方法可以设置我希望将绘图包含在单独的类中的 CPTGraphHostingView 吗？或者也许我可以设置一个方法来做到这一点？这可能是一个简单的问题，但任何帮助将不胜感激！我查看了 SDK 中提供的示例，但似乎无法弄清楚它是如何完成的！

这是我目前在 AppDelegate 方法中使用的代码：

```
CPTTheme *theme = [CPTTheme themeNamed:kCPTDarkGradientTheme];
graph = (CPTXYGraph*) [theme newGraph]; 
_graphView.hostedGraph = graph; 
```

.... 其次是图表的规格....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T21:01:11.623

您可以为每个图形创建一个单独的视图控制器来处理设置。视图控制器也可以是数据源和绘图委托（所有 Core Plot 示例都这样做），尽管这些功能也可以由另一个类处理。

例如，请参阅 CPTTestApp（Mac 版）示例应用程序。它有四个不同的控制器类来处理各种演示。

# objective-c - 使用超级调用对象的属性（或如何访问子视图中的超级视图按钮）

> ID：10366998
> 
> 赞同：1
> 
> 时间：2012-04-28T19:49:43.170
> 
> 标签：objective-c, ios, uibutton

我有一个带有按钮子视图 StartScene.h 的主视图：

```
@class PlayScene
@interface StartScene : UIView <UITextFieldDelegate> {
    PlayScene* tView;
    UIButton *Ok;
} 
```

StartScene.m 中的某处：

```
Ok = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[Ok setFrame:CGRectMake(100, 190, 65, 30)];
[Ok setTitle:(NSString *)@"OK" forState:(UIControlState)UIControlStateNormal];
[Ok addTarget:self action:@selector(gameOverDidLoad) forControlEvents:UIControlEventTouchDown];
[self addSubview:Ok];

Ok.hidden=YES;
Ok.enabled=NO;

tView = [[PlayScene alloc]initWithFrame:CGRectMake(0, 0, 320, 520)];
tView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"backGround.jpg"]];
[self addSubview:tView]; 
```

和子视图：PlayScene.h：

```
#import "StartScene.h"
@interface PlayScene : StartScene {
} 
```

PlayScene.m:

```
- (void)ooneFingerTwoTaps {
[NSThread detachNewThreadSelector:@selector(oneFingerTwoTaps) toTarget:self withObject:nil];
} 
```

被调用并且它的方法是

```
 - (void)oneFingerTwoTaps
{
//  some code
    if (self.GameState==GameLost) {
        [super checkScore:xScore];
        Ok.hidden=NO;
        Ok.enabled=YES;

        [[NSThread currentThread] cancel];
        }
    }
} 
```

因此，当 PlayScene 中发生某些事情时，需要出现 Ok 按钮。

我试过了

```
Ok.hidden=NO;
Ok.enabled=YES; 
```

但它不起作用。我想，由于子视图只能看到一个尚未初始化的 UIButton 变量。

所以我在这里有两个问题：

1）我可以使用 self.Ok 或 super.Ok 调用 Ok 变量。我认为 super.Ok 完全可以工作，但我不知道，也找不到正确的语法。它是什么？

2）问题可以通过其他方式解决吗？