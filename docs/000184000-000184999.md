# StackOverflow 问答 000184000-000184999

# groovy - Groovy：“def x = 0”中“def”的目的是什么？

> ID：184002
> 
> 赞同：187
> 
> 时间：2008-10-08T17:59:14.870
> 
> 标签：groovy, keyword

在下面的一段代码中（取自[Groovy Semantics Manual page](http://groovy-lang.org/semantics.html#_while_loop)），为什么要在赋值前加上关键字`def`？

```
def x = 0
def y = 5

while ( y-- > 0 ) {
    println "" + x + " " + y
    x++
}

assert x == 5 
```

`def`可以删除关键字，并且此代码段将产生相同的结果。那么关键字的**作用**`def`是什么？

* * *

## 回答 #1

> 赞同：287
> 
> 时间：2008-10-09T03:51:30.493

它是基本脚本的语法糖。省略“def”关键字会将变量放在当前脚本的绑定中，并且 groovy 将其（主要）视为全局范围的变量：

```
x = 1
assert x == 1
assert this.binding.getVariable("x") == 1 
```

使用 def 关键字不会将变量放在脚本绑定中：

```
def y = 2

assert y == 2

try {
    this.binding.getVariable("y") 
} catch (groovy.lang.MissingPropertyException e) {
    println "error caught"
} 
```

打印：“错误捕获”

在大型程序中使用 def 关键字很重要，因为它有助于定义可以找到变量的范围并有助于保持封装。

如果您在脚本中定义一个方法，它将无法访问在主脚本主体中使用“def”创建的变量，因为它们不在范围内：

```
 x = 1
 def y = 2

public bar() {
    assert x == 1

    try {
        assert y == 2
    } catch (groovy.lang.MissingPropertyException e) {
        println "error caught"
    }
}

bar() 
```

打印“错误捕获”

“y”变量不在函数的范围内。“x”在范围内，因为 groovy 将检查当前脚本的变量绑定。正如我之前所说，这只是一种语法糖，可以使快速而肮脏的脚本更快地输入（通常是一行）。

较大脚本中的良好做法是始终使用“def”关键字，这样您就不会遇到奇怪的范围问题或干扰您不打算使用的变量。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-11T16:37:21.043

[Ted 的回答](https://stackoverflow.com/a/185879/33311)非常适合脚本；[本的答案](https://stackoverflow.com/a/184023/33311)是标准的类。

正如 Ben 所说，将其视为“对象”——但它更酷，因为它不会将您限制在 Object 方法中。这对进口有很好的影响。

例如，在这个片段中，我必须导入 FileChannel

```
// Groovy imports java.io.* and java.util.* automatically
// but not java.nio.*

import java.nio.channels.*

class Foo {
    public void bar() {
        FileChannel channel = new FileInputStream('Test.groovy').getChannel()
        println channel.toString()
    }
}

new Foo().bar() 
```

例如，但在这里，只要所有内容都在类路径上，我就可以“使用它”

```
// Groovy imports java.io.* and java.util.* automatically
// but not java.nio.*
class Foo {
    public void bar() {
        def channel = new FileInputStream('Test.groovy').getChannel()
        println channel.toString()
    }
}

new Foo().bar() 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-10-08T18:02:25.770

根据这个[页面](http://www.groovy-lang.org/semantics.html#_variable_definition)，`def`是类型名称的替代品，可以简单地被认为是别名`Object`（即表示您不关心类型）。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-14T13:29:09.767

就这个单一的脚本而言，没有实际的区别。

但是，使用关键字“def”定义的变量被视为局部变量，即对于这个脚本来说是局部变量。前面没有“def”的变量在首次使用时存储在所谓的绑定中。您可以将绑定视为需要在“脚本之间”可用的变量和闭包的通用存储区域。

因此，如果您有两个脚本并使用相同的 GroovyShell 执行它们，则第二个脚本将能够获取在第一个脚本中设置的所有变量，而无需“def”。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-08-02T21:18:43.383

“def”的原因是告诉 groovy 你打算在这里创建一个变量。这很重要，因为您永远不想意外创建变量。

这在脚本中是可以接受的（Groovy 脚本和 groovysh 允许您这样做），但在生产代码中，这是您可能遇到的最大弊端之一，这就是为什么您必须在所有实际 groovy 代码中定义一个带有 def 的变量（任何在班级）。

这是一个为什么不好的例子。如果您复制以下代码并将其粘贴到 groovysh 中，这将运行（不会使断言失败）：

```
bill = 7
bi1l = bill + 3
assert bill == 7 
```

这类问题可能需要花费大量时间来查找和解决——即使它在你的一生中只咬过你一次，它仍然比在你的整个职业生涯中明确声明变量数千次要花费更多的时间。它在哪里被声明也变得一目了然，你不必猜测。

在不重要的脚本/控制台输入（如 groovy 控制台）中，这是可以接受的，因为脚本的范围是有限的。我认为 groovy 允许您在脚本中执行此操作的唯一原因是像 Ruby 那样支持 DSL（如果您问我，这是一个糟糕的权衡，但有些人喜欢 DSL）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-08T18:01:52.963

实际上，我**不**认为它会表现得一样...

Groovy 中的变量仍然需要声明，只是不需要 TYPED 声明，因为右侧通常包含足够的信息让 Groovy 键入变量。

当我尝试使用未使用 def 或类型声明的变量时，我收到错误“没有此类属性”，因为它假定我正在使用包含代码的类的成员。

# string - 如何在 Lotus Notes 公式语言（@ 命令）中执行 indexOf()？

> ID：184009
> 
> 赞同：0
> 
> 时间：2008-10-08T18:00:35.977
> 
> 标签：string, lotus-notes, lotus-formula

我在 Domino Designer 帮助中的任何地方都找不到这个。看起来很简单！

我需要做的就是找到一个字符在字符串中的位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-17T20:52:22.110

您可以使用@Left 或@Leftback。我认为在这种情况下它们的工作方式相同。

```
src:= {your field value to search};
char:= {your target character};
indexof:= @Length(@Left(src;char)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T21:48:26.070

searchResult:=@Left(SearchString;"C"); indexOf:=@If(searchResult="";0;@Length(searchResult)); 指数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-12T08:59:15.227

（已编辑）请改为查看 charles ross 的答案。 [https://stackoverflow.com/a/19437044/11293](https://stackoverflow.com/a/19437044/11293)

我的效率较低的方法如下。

* * *

如果您确实需要角色位置，尽管您可以这样做：

```
REM {
    S  Source string
    F  Character to find
    R  Location of character in string or 0
};

S := "My string";
F := "t";
LEN_S := @Length(S);
R := 0;

@For(I := 1; I < LEN_S; I := I + 1;
    @If(@Middle(S; I; 1) = F;
        @Do(R := I; I := LEN_S);
        @Nothing
    )
); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-13T15:55:57.767

@Length(src) - @Length(@ReplaceSubstring(src;srch;""))

# xml - XML 属性可以是空字符串吗？

> ID：184014
> 
> 赞同：12
> 
> 时间：2008-10-08T18:01:25.600
> 
> 标签：xml

XML 属性可以是空字符串吗？

换句话说，是

```
<element att="" /> 
```

有效的 XML？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-08T18:02:26.893

是的，这是格式良好的 XML。

一个简单的测试方法（在 Windows 上）是将示例保存在一个`test.xml`文件中并使用 Internet Explorer 打开它。如果文档格式不正确，IE 将显示错误消息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-08T18:06:54.810

您可以通过 attname="" 创建一个空属性

您可以通过创建一个空元素

```
<elementName></elementName> 
```

或者

```
<elementName/> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-08T18:03:28.340

这是一个 XML*属性*，而不是一个元素，这毫无价值。一个空元素将是：

```
</> 
```

这不是有效的 XML。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-24T05:45:39.913

这是有效的 xml 标记：

```
<mytag myattrib=""/> 
```

这不是：

```
<mytag myattrib/> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T18:06:04.670

还应该注意的是，一些 XML 解析器会在空字符串节点和属性上抛出错误，而不是返回 null 或空字符串。因此，即使它可能是有效的，最好将其完全排除在外。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T18:27:45.063

是的 - 元素内容可以是空的，正如您在问题中使用的那样，甚至还有特殊的 Empty-Element 标记符号：

```
<elementname /> 
```

除非需要与 SGML 互操作，否则以上等价于

```
<elementname></elementname> 
```

属性值也可以为空，但属性后面必须始终跟一个 '=' 和一个带引号的字符串，即使该字符串不包含任何字符。

* * *

此信息的最终位置是 XML 规范： [http ://www.xml.com/axml/testaxml.htm](http://www.xml.com/axml/testaxml.htm)

以下是 Annotated XML Reference 关于空元素的说明：

> 那么，这是：`<img src='madonna.gif'></img>`真的完全一样`<img src='madonna.gif'/>`吗？就 XML 而言，它们是。这一决定引发了许多宗教辩论，有人认为“点”和“容器”类型元素之间存在本质元素。正如下面的“为了互操作性”注释所明确指出的，如果您使用 1998 年之前的 SGML 软件来处理 XML，则存在很大差异。

**注意：**关于空元素的讨论是由于发布问题的原始措辞。

# testing - *管理*测试驱动和/或敏捷开发的最佳具体“操作手册”？

> ID：184025
> 
> 赞同：5
> 
> 时间：2008-10-08T18:02:54.007
> 
> 标签：testing, project-management, agile

### 我正在寻找一本易于理解的书来介绍给我的老板/团队。

* * *

**背景信息：** 我们越来越多的工作会议让我的老板/团队思考如何在这里实施更多的“最佳实践”。（“这里”= 一个很小的应用程序开发商店。4 个开发人员）

以下是我的整个团队都同意我们需要的项目：

*   每晚构建
*   将我们的错误跟踪器中的“错误”分解为更小、更具体的项目
*   自动化测试

## **我们面临的问题是如何开始。**

我相信，如果我的商店可以简单地选择***一个清晰而具体的计划***或一套规则，那么其他一切都会水到渠成。现在，我们陷入了关于模糊、感觉良好的想法和听起来不错的流行语的讨论中。

请向我推荐您最喜欢的书（或在线资源），其中包含用于实施指导 TDD 或敏捷团队/商店的管理方案的清晰、离散、连续的步骤。

我意识到除了 TDD 和敏捷之外还有其他范式也可以解决这些问题，但我自己的利益和偏见指向 TDD 和敏捷，所以我很想利用我的团队对变革的渴望，并朝那个方向“推动”它. 或者如果你强烈不同意我的观点，请随时扇我一巴掌！我不会冒犯的。:)

### 正如其他人所说，我认为当受访者每个答案只列出一本书推荐时，这些问题的回答最好。

* * *

谢谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T18:04:58.510

对于您的需要，我推荐[测试驱动开发：通过示例](https://rads.stackoverflow.com/amzn/click/com/0321146530)(Kent Beck)。它写得很清楚，比理论更实用，并规定了经过时间考验的配方，以采用敏捷的、测试驱动的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T02:45:49.550

在组合中加入另一个实用程序员的头衔：[Ship It！](http://pragprog.com/titles/prj/ship-it)

好书 - 看看，可能适合您的管理需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T18:56:05.520

我建议您从您同意的内容开始：夜间构建和自动化测试。每晚构建是不费吹灰之力的。对于自动化测试，我将从：

*   每个具有新功能的提交都应该至少有一个自动化测试
*   每个修复 bug 的提交都应该至少有一个自动化测试，没有修复就失败，修复成功

如果你这样做，你将开始获得经验。有了这种经验，就会更容易理解文献中的所有好的建议。

有很多关于良好实践的好书，但你必须弄清楚什么对你的团队有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T12:11:43.990

## 敏捷方法并不是真正的方法......

还有更多的精神。主要是关注：

*   沟通

*   对变化的反应

*   客户导向

这可以通过多种方式实现，更重要的是找到自己的方式来做到这一点。如果您想了解这种精神是什么，您可以阅读免费的 37signals 在线书籍[Getting Real](http://gettingreal.37signals.com/toc.php)。

## 但是您可以从一些步骤开始

它们不是您必须执行的大规则，但您可以尝试以下方法，看看它如何与您的团队一起使用：

*   快速站立会议。每天 5-15 分钟的会议，每个人都站起来，解释他已经完成了什么，需要做什么以及什么会阻止他这样做。保持在 15 分钟以内，人数最少。

*   为短期期限设定简单的目标，而不是几周内的大目标。

*   建立小团队（3 人）并在他们之间分工。把他们放在同一个房间里，确保他们有至少半天的时间工作而不会受到任何干扰。

*   与您的客户一起设置许多小的定期审查。不要写规范。草图、设计、原型、向客户展示、修复/调整/更改然后构建。然后再做一次。

*   测试、版本控制、错误跟踪是工具，而不是方法。没有人关心你是怎么做的，用什么软件只要你做。他们不是问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T18:38:21.703

这不是一本真正的循序渐进的书，而是充满了很好的建议并且易于消化：[敏捷开发人员的实践](http://www.pragprog.com/titles/pad/practices-of-an-agile-developer)。如果您想进行内部 TDD 培训，我推荐[netobjectives](http://www.netobjectives.com/)。我有他们的 TDD 课程，它真的让我大开眼界。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T21:01:19.713

可悲的是，即使是最明确和具体的计划也可能会引起争议。

我会告诉你什么是有效的。立即启动 TDD。它有界限。这相对容易。你仍然会有一百万个问题。

你可以自由地说，“但是夜间构建呢？” “使用错误跟踪器怎么样？”

大量的思考可能意味着两件事之一。

首先，这可能意味着有人用“担忧”和“问题”搅浑水。有时这真的是对改变的不满，表达为“担忧”。有时这真的很自负（“我以为我很敏锐，现在有人说我必须对我进行改进。”）

其次，这可能意味着这非常大。因此，不要将其视为“**许多新的最佳实践**”。将其视为一些增量改进。你并没有从根本上改变自己（好吧，这可能会发生，但不要一开始就把它作为你的计划。）

我的经验是，你一次只能做一件事。做 TDD 直到无聊为止。然后做点别的。拥有强大的测试套件后，夜间构建通常会变得很明显。然后当这很无聊时，做一些其他小的、增量的过程改进。

一心一意。婴儿步。避免将婴儿与洗澡水一起扔掉。你想要的只是下个月比这个月好一点。

如果担心采用一个小的增量改进，请找出根本原因。谁的自尊伤痕累累？谁担心变化？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-23T11:51:21.537

你可以打印Henrik Kniberg[的 Scrum and XP from the Trenches](http://www.crisp.se/henrik.kniberg/ScrumAndXpFromTheTrenches.pdf)，它更关注敏捷开发过程而不是 TDD，但它是一个简单快速的阅读。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-12-18T22:12:16.673

查看 Marty Cagan 的书籍。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-08T19:17:27.677

我最喜欢的是[规划极限编程](https://rads.stackoverflow.com/amzn/click/com/0201710919)

编辑：它完全替代了面向 XP/敏捷团队的传统项目管理

危险在于，采用现代开发方法，然后用过时的项目管理和行政实践扼杀它们！

# java - 对象的序列化：不能涉及线程状态，对吧？

> ID：184027
> 
> 赞同：8
> 
> 时间：2008-10-08T18:03:17.810
> 
> 标签：java, c++, multithreading, serialization, systemc

我正在研究将执行程序的状态存储到磁盘并再次将其带回的基本原则。在我们目前的设计中，每个对象（这是一个带有函数指针列表的 C 级事物，一种低级的自制面向对象——这样做有很好的理由）将是调用以将其显式状态导出为可写和可恢复的格式。使这项工作的关键属性是与对象相关的所有状态确实封装在对象数据结构中。

还有其他使用活动对象的解决方案，其中有一个用户级线程附加到某些对象。因此，程序计数器、寄存器内容和堆栈内容突然成为程序状态的一部分。据我所知，没有好的方法可以在任意时间点将这些东西序列化到磁盘上。线程必须将自己停放在程序计数器等不表示任何内容的特殊状态下，因此基本上将它们的执行状态机状态“保存”到显式对象状态。

我查看了一系列序列化库，据我所知，这是一个通用属性。

**核心问题是：或者事实并非如此？就线程在其代码中执行的位置而言，是否有可以包括线程状态的保存/恢复解决方案？**

请注意，在虚拟机中保存整个系统状态不算数，这并不是真正序列化状态，而只是冻结机器并移动它。这是一个明显的解决方案，但大多数时候有点重量级。

有些问题清楚地表明，我在解释我们如何做事的想法时不够清楚。我们正在开发一个模拟器系统，对于在其中运行的代码有非常严格的规则是允许编写的。特别是，我们完全区分了对象构造和对象状态。每次设置系统时都会重新创建接口函数指针，而不是状态的一部分。状态仅由特定指定的“属性”组成，每个“属性”都具有定义的获取/设置函数，该函数在内部运行时表示和存储表示之间进行转换。对于对象之间的指针，它们都被转换为名称。所以在我们的设计中，一个对象可能会像这样在存储中出现：

```
Object foo {
  value1: 0xff00ff00;
  value2: 0x00ffeedd;
  next_guy_in_chain: bar;
}

Object bar {
  next_guy_in_chain: null;
} 
```

链表从未真正存在于模拟结构中，每个对象代表某种硬件单元。

问题是有些人想这样做，但也有线程作为编码行为的一种方式。这里的“行为”实际上是模拟单元状态的突变。基本上，我们的设计说所有这些更改都必须在原子完整操作中进行，这些操作被调用、完成它们的工作并返回。所有状态都存储在对象中。你有一个反应模型，或者它可以被称为“运行到完成”或“事件驱动”。

另一种思考方式是让对象有活动的线程在它们上面工作，它们像经典的 Unix 线程一样处于一个永恒的循环中，并且永远不会终止。这是我试图查看它是否可以合理地存储到磁盘的情况，但是如果不在下面插入 VM，这似乎是不可行的。

*2009 年 10 月更新：*与此相关的论文发表在 2009 年的 FDL 会议上，请参阅[这篇](http://www.engbloms.se/jakob_publications.html)关于检查点和 SystemC 的论文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T18:48:22.680

我不认为仅序列化程序的“某些线程”可以工作，因为您会遇到同步问题（这里描述了一些问题[http://java.sun.com/j2se/1.3/docs/guide /misc/threadPrimitiveDeprecation.html](http://java.sun.com/j2se/1.3/docs/guide/misc/threadPrimitiveDeprecation.html)）。因此，坚持整个程序是获得一致状态的唯一可行方法。

您可能会研究的是正交持久性。有一些原型实现：

[http://research.sun.com/forest/COM.Sun.Labs.Forest.doc.external_www.PJava.main.html](http://research.sun.com/forest/COM.Sun.Labs.Forest.doc.external_www.PJava.main.html)

[http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.17.7429](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.17.7429)

但是它们都不再被维护或获得很多吸引力（afaik）。我想检查点毕竟不是最好的解决方案。在我自己的项目[http://www.siebengeisslein.org](http://www.siebengeisslein.org)我正在尝试使用轻量级事务来调度事件的方法，因此不必维护线程状态（因为在事务结束时，线程调用堆栈再次为空, 如果一个操作在事务中间停止，一切都会回滚，所以线程调用堆栈也很重要）。您可能可以使用任何 OODBMS 实现类似的东西。

另一种看待事物的方式是延续[（](http://jauvm.blogspot.com/)[http://en.wikipedia.org/wiki/Continuation，http://jauvm.blogspot.com/](http://en.wikipedia.org/wiki/Continuation)）。它们是一种在定义的代码位置暂停执行的方法（但它们不一定保持线程状态）。

我希望这能给你一些起点（但没有现成的解决方案来解决这个问题）。

编辑：阅读您的说明后：您绝对应该研究 OODBMS。在自己的事务中调度每个事件，而不关心线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T18:29:33.077

这听起来真的就像保存虚拟机的状态并能够以完全相同的方式恢复它正是您想要的。

如果您只需要能够使用先前执行所使用的相同数据来启动程序运行，那么您只需要保存并恢复持久数据，每个线程的确切状态并不重要，因为它无论如何都会变化得如此之快-下次事物的实际地址会有所不同。无论如何，使用数据库应该会给你这种能力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T18:58:11.053

比尝试序列化程序状态更好的方法是实现带有数据检查点的[Crash Only Software 。](http://en.wikipedia.org/wiki/Crash-only_software)您如何进行数据检查点将取决于您的实施和问题域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T21:47:51.133

JSR 323 中实际上为 Java 提出了这样的建议：

[http://tech.puredanger.com/2008/01/09/strong-mobility-for-java/](http://tech.puredanger.com/2008/01/09/strong-mobility-for-java/)

但不被接受为过于理论化：

[http://tech.puredanger.com/2008/01/24/jcp-votes-down-jsr-323/](http://tech.puredanger.com/2008/01/24/jcp-votes-down-jsr-323/)

如果您点击链接，您可以找到一些关于这个问题的有趣研究。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T18:22:22.717

您不应该尝试序列化您的程序必须存储的状态。因为除非操作系统允许，否则您的程序**将永远无法完全控制其状态**，在这种情况下......它是操作系统的一部分。

您**不能保证指向某个虚拟内存位置的指针将再次指向相同的虚拟内存位置**（除了 heap-begin/end、stack-begin 等属性），因为对于程序而言，操作系统对虚拟内存的选择是不确定的。您通过 sbrk 或更高级别的接口（例如 malloc）从操作系统请求的页面将在任何地方开始。

更好的：

*   清理代码并检查您的设计：其中包含哪些状态属性？
*   不要使用这种低级语言，因为创建您尝试做的事情的开销不值得结果。
*   如果您必须使用 C，请考虑使您的生活尽可能轻松的方法（考虑 offsetof 运算符和属性结构具有从偏移量 0 开始的第一个成员）。

我怀疑**您想缩短序列化/反序列化特定数据结构**（例如链表）所需的开发时间。请放心，**您尝试做的事情并非微不足道，而且需要做更多的工作**。如果您坚持这样做，请考虑查看操作系统的内存管理代码和操作系统的分页机制。;-)

**由于附加问题而进行编辑**：您陈述的设计听起来像是某种状态机；对象属性设置为可序列化，函数指针可以恢复。

首先，**关于对象中的线程状态：这些仅在可能存在典型的并发编程问题（例如竞争条件**等）时才重要。如果是这种情况，您需要线程同步功能，例如互斥锁、信号量等。然后您可以随时访问属性以进行序列化/反序列化并确保安全。

其次，关于对象设置：看起来很酷，不确定您是否有二进制或其他对象表示。假设二进制：如果您可以表示内存中的实际结构（这是一些编码开销），您可以轻松地序列化它们。**在对象的开头插入某种类 ID 值，并有一个指向实际装备的查找表**。查看第一个 sizeof(id) 字节，您就知道您拥有哪种结构。然后你就会知道哪个结构在那里铺设。

在序列化/反序列化时，请像这样处理问题：您可以查找假设打包（成员之间没有间距）结构的长度，分配该大小并一个接一个地读/写成员。考虑 offsetof，或者，如果您的编译器支持它，则只需使用打包结构。

**编辑由于大胆的核心问题:-)**不，没有；不适合 C。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T18:22:53.450

看起来你想在 C++ 中有一个[闭包。](http://en.wikipedia.org/wiki/Closure_(computer_science))正如您所指出的，语言中没有内置机制可以让您这样做。据我所知，这基本上不可能以完全通用的方式进行。一般来说，用没有 VM 的语言很难做到。你可以通过做一些你建议的事情来伪造它，基本上创建一个维护执行环境/状态的闭包对象。然后在它处于已知状态时让它自己序列化。

您还将在函数指针方面遇到麻烦。这些函数可以在每次加载时加载到不同的内存地址。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T18:58:10.977

我认为线程状态是一个可能不适合序列化的实现细节。你想保存你的对象的状态——不一定是它们是如何变成现在这样的状态的。

作为为什么要采用这种方法的示例，请考虑无中断升级。如果您正在运行版本 N 的应用程序并想要升级到版本 N+1，则可以使用对象序列化来执行此操作。但是，“版本 N+1”线程不会与版本 N 线程不同。

# javascript - 使用 PHP 代理绕过 XMLHttpRequest 的同源策略有哪些缺点？

> ID：184028
> 
> 赞同：3
> 
> 时间：2008-10-08T18:03:18.387
> 
> 标签：javascript, security, xmlhttprequest

[http://developer.yahoo.com/javascript/howto-proxy.html](http://developer.yahoo.com/javascript/howto-proxy.html)

这种技术有缺点吗？优点很明显，您可以使用代理通过 XMLHttpRequest 在另一个域上获取 XML 或 JavaScript，而不会遇到同源限制。但是，我没有听说过其他方法的缺点——是否存在，它们可能是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T18:33:12.087

开销 - 事情会有点慢，因为你正在通过中介。

如果您允许通过代理访问任何外部站点，则会出现安全问题 - 请务必将其锁定到您正在代理的资源的特定站点（可能还有特定的 URL）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T20:16:35.560

开销——对于用户（他们知道 hsa 等待您的服务器从代理源生成和接收数据）和您（因为您现在除了自己的服务器外还要承担其他服务器的所有流量）。

还有安全问题——如果你使用代理绕过浏览器安全检查来显示不受信任的内容，你就是在故意破坏浏览器安全模型——可能会让用户受到威胁——所以除非你绝对信任你正在通信的服务器使用（这意味着您正在代理的页面中没有随机广告，没有用户定义的内容）您不应该这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T18:16:14.430

我想可能会有安全方面的考虑，尽管其他人可能比我更有资格解决这个问题。我在我的个人网站上运行这样的代理已经有一段时间了，还没有遇到问题。

# .net - 在 windows.forms 之间传递信息的最佳实践

> ID：184034
> 
> 赞同：4
> 
> 时间：2008-10-08T18:04:00.510
> 
> 标签：.net, winforms

您如何在表单之间传递信息？Forward 使用 Properties 或者可能是 New() 或 DoStuff() 方法中的参数是直截了当的（对不起），但是当用户完成第二种形式时发送***回一些东西呢？***（IE.所选项目的ID）我们已经使用了所有这些：

*   **将调用表单作为引用传递给被调用表单，**以便被调用表单可以访问调用表单上的属性或方法。我真的不喜欢这样，因为这两种形式非常相互依赖。将调用表单作为对象传递只会稍微改善这一点。
*   **使用事件**这在某种程度上解耦了代码，但签名必须匹配事件处理程序。
*   **使用公共接口**我说的是内置的 .NET，但我想您可以创建自己的。这对我来说似乎是最好的。

现在提高标准，如果表单位于两个不同的 DLL 中怎么办？只要形式不相互依赖，我认为这不会是一大步。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-25T17:10:56.310

我发现，一旦您拥有设计良好的***域实体对象模型***或只是业务对象。这些任务变得容易得多。

如果您没有 Employee、Account、Location 等域实体，您会发现自己在编写具有大量属性的表单并创建大量尴尬的依赖项。随着时间的推移，这可能会非常混乱。

一旦你有了域实体，事情就会更容易处理。例如，要使用表单编辑您的 Employee，您可以简单地创建一个 Employee 属性，如下所示：

```
NewForm myForm = new NewForm();             
myForm.Employee = employeeToEdit; // This can have state 
myForm.ShowDialog(); 
Employee editedEmployee= myform.Employee;

EmployeeFacade.SaveEmployee(editedEmployee); // Or whatever 
```

关于事件，对于 Winform/WPF 应用程序，使用发布/订阅模式创建一个全局 EventManager 来处理表单之间的通信几乎没有帮助。我很少有一种形式直接与任何其他形式“交谈”。那是另一个话题，所以我不会详细介绍，如果您需要示例，我可以提供我做过的几个。

雷福德布鲁克郡

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T18:14:32.203

为表单创建公共属性，然后等待表单关闭并检查属性，然后再处理新表单。

```
NewForm myForm = new NewForm();
myForm.ShowDialog();
string x = myform.MyProperty; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T18:12:11.520

是否要访问第二种形式的 UI 元素？我认为更简洁的方法是使用共享对象将数据传递回调用表单。将对象作为参数传递给第二个表单构造函数，该构造函数可以填充实例字段并将该实例返回给调用表单。如果需要，此对象还可以引发任何事件（如属性更改事件）以通知调用表单（或订阅者）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T18:12:13.097

如果这是一个主表单创建另一个表单的实例，等待表单完成一些工作然后关闭并检查它的结果的问题，那么拥有公共属性或监听事件是最有意义的。将表单放在不同的程序集中都不会影响这些事情。您确实在两种表单之间获得了明确的约束契约，但是如果在公共接口中描述了属性（如您所建议的那样），那么只要每个人都同意接口的条款，您就可以了。

我不确定您希望它变得多复杂。过去，我使用静态单例对象来保存应用程序状态。app-state 对象将公开程序的其他部分可以侦听的事件处理程序。主窗体将创建应用程序状态（实际上只是获取对它的引用）并监听其上的某些事件。然后主窗体将创建子窗体和控件来完成工作。孩子们会改变 app-state 对象的属性，这反过来又会触发主窗体会监听的事件。通过这种方式，各种表单和控件彼此分离。缺点是它们与应用状态单例紧密耦合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-05T14:02:19.747

this.Hide(); 字符串[]名称=新字符串[]；new frmFormName = new frm(string what, string you, string going, string to, string put,搅拌); this.ShowDialog(); this.Show();

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T18:15:52.433

我成功做的一件事是在应用程序中创建了一个轻量级的发布/订阅事件系统。这是在 .net 1.1 中，不确定它会如何随着泛型而改变。本质上，我们有一个单例，其中包含一个带有字符串键的哈希表和多播委托。

单例具有 RegisterForEvent(string key, delegate handler), RaiseEvent(key,data) 等方法...

然后我们定义了一个标准委托，并说所有用户都必须实现这个模式，例如我们的处理程序必须是：void method(object sender, CustomEventArgs args)。发布者将定义他们自己的 CustomEventArgs 派生类。

好消息是这允许构建一个完全解耦的系统。我们有很多程序集，没有任何问题，只需要确保您的 eventargs 被定义在其他潜艇可以得到的地方。

我们有我们所谓的不同子系统，例如我们有一个监控互联网连接的子系统，当它引发事件时，UI 会更改以指示它们的连接状态，我们还有一个队列服务，可以将消息发布到服务器，当它看到连接断开时，我们将停止发布。

缺点是它非常松散耦合，至少我们的实现是这样，但有一些方法可以改进它。

# python - 新 web 2.0 网站的框架/语言（2008 年和 2009 年）

> ID：184049
> 
> 赞同：2
> 
> 时间：2008-10-08T18:07:42.950
> 
> 标签：python, ruby-on-rails, django, merb

我知道我会得到一千个“取决于你想要做什么”的答案，但说真的，网上还没有关于这个的可靠信息。以下是我的假设——我认为现在对很多人来说它们是相似的：

1.  现在是 2008 年 10 月。我想开始为 2009 年 1 月编写应用程序。我愿意使用 beta 代码等，但到 1 月，我想要一个没有“奇怪”问题的网站。话虽如此，如果一种语言只是比另一种语言慢 10%，只要问题是线性的，我就不会关心这些事情。我主要关心的是开发人员的生产力。
2.  我将在应用程序中使用 Linux、Apache、MySQL。
3.  我希望能够使用稳定的库来执行诸如运行 scp 和 ftp 客户端功能之类的事情（我只选择了这两个，因为它们与 Web 无关，但同时代表了任何大型应用程序都可能使用的非常常见的网络协议）。OpenID 和 Oauth 等技术也将被使用。
4.  经验丰富的 Web 开发人员很容易找到（即我不必从金融公司之类的人那里找人）。
5.  无论选择是什么都是常见的，并且会存在一段时间。
6.  这是一个踢球者。我希望能够使用类似于 HAML、SASS 的高级表示层工具/语言。我绝对想使用 JQuery。
7.  我将创建一个 Facebook 应用程序，并在某些时候做一些事情，比如处理 SMS 消息、iPhone 应用程序等......

此时，语言的选择是 PHP (Cake,Symfony,Zend), Python (Django), Ruby (Merb)。在这一点上，我真的介于 Django 和 Merb 之间，主要是因为其他人似乎都在这样做。

请不要在此处放置任何非主流技术。我知道 Merb 大部分都没有经过测试，但他们的既定目标是一个坚实的平台，而且它背后有很多动力，所以我相信它是可行的。请不要回答 Perl 或 .Net 有多棒。

供将来参考 - 已经做出了这些选择：

*   Debian (Lenny) - 用于将 CPU 周期转换为有用的东西。追踪
*   0.11 - 用于项目管理 Gliffy - 用于线框等
*   Google Docs/Apps - 用于文档、托管电子邮件等...
*   Amazon ec2/S3 - 用于托管、存储。

干杯，亚当

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-08T18:51:52.533

**姜戈！**

在 Google/Youtube 上查找 DjangoCon 演讲 - 特别是“可重用应用程序”(www.youtube.com/watch?v=A-S0tqpPga4)

在开始使用 Ruby/Rails 之后，我使用 Django 已经有一段时间了。我发现 Django 社区更容易进入（更好），语言记录了*优秀*的例子，而且它的模块化非常棒，特别是如果你想把自定义组件混入其中，而不是被迫在这里使用某些东西和那里。

我敢肯定，可能有一些方法可以让 Rails 或类似的东西一样灵活，但我强烈建议你仔细看看[http://www.djangoproject.com/上的 Django 介绍等](http://www.djangoproject.com/)

Eugene 提到它现在是 1.0 - 因此在 2009 年 1 月之前将保持稳定和向后兼容的代码库。

此外，它构建的自动管理界面可用于*生产*，并且非常灵活。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-08T18:51:26.637

对不起，但你的问题是错误的。人们可能会投票给我，但我还是想说：

我不希望得到一个客观的答案！为什么？这很简单：

*   所有 Ruby 倡导者都会告诉你使用 Ruby。
*   所有 Python 倡导者都会告诉你使用 Python。
*   所有 PHP 倡导者都会告诉你使用 PHP。
*   在此处插入其他语言。

明白了吗？

我建议您亲自尝试您提到的每种语言。每人至少几天。之后，您应该有更好的基础来做出最终决定。

也就是说，我会选择 Ruby（因为我是 Ruby 的拥护者）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-09T20:02:49.583

他们都将完成工作。

## 使用您和您的团队最熟悉的那个

与其他任何变量相比，这将对您的应用程序的交付时间和稳定性产生更大的影响。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-08T19:08:42.000

这取决于。

php - symfony 是一个很棒的框架。缺点：php，冗长且目录繁重。推进器使用起来很烦人。优点：php 无处不在，劳动力便宜。框架做得很好，支持很好。许多插件让您的生活更轻松

python - django 也是一个很棒的框架。缺点：python 程序员可能更难找到，django 更难。由于没有官方迁移，因此更改您的数据库架构可能会有些困难。不像你期望的那样做 mvc 。好处：做你需要的一切，并拥有出色的 python std 库和社区。

ruby - 我从未使用过merb，所以我将解决rails。好处：几乎任何你想做的事情都有一个插件、gem 或配方。便于使用。缺点：这些插件、宝石和配方有时无法以神秘的方式工作。猴子修补通常是邪恶的。社区是……声音。自以为是的软件，有时这些意见是错误的（*缺少外键*）。rails 本身就像是一座等待爆炸的纸牌塔，会夺走你数小时的生命。

综上所述，我是一名自由 php/symfony 和 ruby​​/rails 开发人员。我参与过多个语言和框架的项目。我最新的项目是在 Rails 中，完全是因为 ActiveMerchant。我一直在寻找开发 django 应用程序的理由。如果有一个类似于 django 的 ActiveMerchant 库，我可能会使用它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-08T18:19:25.297

如果您对 Python 解决方案感到满意，我会选择 Django。它现在是 1.0 版，并且非常成熟，拥有庞大的用户群和许多贡献者。集成 jQuery 没问题，我已经完成了，没有任何问题。

唯一的一点是，据我所知，如今 Ruby 在 Web 开发中更受欢迎，因此更容易找到 Ruby 开发人员。我从浏览最近的招聘广告中得到了这种印象——Python 或 Django 没有那么多。我对 Merb 了解不多，所以无法进行公平的比较。

我已经完成了足够多的 PHP，不建议用它开始一个新项目。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-08T18:26:52.100

根据您的原因，我会选择 Ruby。我看到您需要一些管理工具（scp、ftp 客户端），而 Ruby 拥有它（net/sftp 和 net/ftp 库）。

此外，还有像 God 用于监控您的系统，Vlad the Deployer 用于部署等。在 Merb 的领域中有很多替代品，只需使用您认为更适合您的需求的任何东西（Thin、Mongrel、ebb 等）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-09T10:55:29.907

要了解 Django 生态系统当前所处的位置，您可能需要查看

*   [djangopeople.net](http://djangopeople.net/) （在纽约州尝试[djangopeople.net/us/ny ）](http://djangopeople.net/us/ny/)
*   [djangogigs.com](http://djangogigs.com/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T20:13:03.697

我必须先同意 Orion Edwards 的观点，选择你的团队最熟悉的那个。

但是，我还必须注意您的列表中缺少 ASP.NET 语言。不是为了激怒伟大的狂热军队，而是牛肉在哪里？.NET 是一个稳定、快速的开发平台，劳动力资源每天都在增长。VB.NET 和 C# 是可移植的技能组合，当您建立一个开发人员团队来处理各种不同的任务时，这可能意味着很多。.NET 还允许您将表示层与后端代码分开，就像其他语言一样，还允许您将后端代码公开为 Web 服务，用于 iPhone 和 Facebook 应用程序等。

对每一个建议持保留态度，然后选择最适合应用程序的建议。做你的研究，设计功能而不是狂热者。

*免责声明：曾经是 PHP、ColdFusion 和 Perl 开发人员。Flex 狂热者和 Adob​​e 爱好者。现在正在编写企业 .NET 应用程序。;)*

不要忘记 Mono，它可以让您在 *nix 下运行 .NET。我并不是说它会是完美的，只是扮演魔鬼的拥护者。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-09T21:13:14.760

不要陷入服务器端页面布局的思维定势。考虑像 SproutCore、GWT 或 ExtJS 这样的技术，它们将布局代码完全放在客户端上，使服务器只负责数据编组和处理（并且很容易被替换）。

你真的，真的需要知道你想要哪个服务器平台。不要因为它是当月的味道而选择一种，而是因为你觉得它舒服而选择一种。味道不会持久，坚固的代码库会。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-16T15:07:01.753

在 Django 中构建应用程序后，我可以证明它的实用性。如果所有框架都一样优雅（是的，Spring，我在看着你）。

然而，在将农场押注于 Django 方面，您需要考虑的一件事是 Python 3 将很快发布。Python 3 不向后兼容，并且存在一种风险，即它会分叉语言并最终减缓所有 Python 项目在处理后果时的势头。公平地说，Ruby 2.0 也即将推出，但我认为它不会有那么大的破坏性。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T11:05:56.327

我在过去十年中对各种新技术的经验使我建议您将平台的稳定性作为一个严肃的标准。使用最新最好的框架开发一切都很好，但是当你发现它向前推进了一个单点版本时，突然间你所做的一切都被弃用了，这可能会导致额外的不必要的工作。这尤其是我在版本 1 之前使用 rails 的经验。仅出于这个原因，当您开始使用它时，我会避免使用任何至少不是 1.0 的平台。

Ruby 非常适合使用，并且可以让您的开发人员保持较高的工作效率，但如果 Django 是更稳定的平台，我肯定会支持它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-14T16:48:48.400

不要对您的服务器设置有偏见是值得的。任何在源代码中值得重视的现代 Web 框架都有某种 SQL 抽象层。PostgreSQL 获得了更好的性能，这来自前 MySQL 党派。

Apache 是一头野兽，无论是在配置上还是在服务器上的资源上。为什么不使用轻量级的东西，比如[nginx](http://nginx.net)或[lighttpd](http://www.lighttpd.net/)？

（作为记录，我是一个大 Django 用户，但正如公认的答案所说，无论你的团队知道什么。快速周转不是学习新框架的时候。如果你从头开始雇佣一个团队，和 Django 一起去吧。）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-05T21:09:13.457

更新：我最终使用并爱上了 Django。我已经完全用完了 PHP - 对此感到抱歉。未来的读者试图创建一个新的 web 2.0 站点（假设他们有编程背景），应该非常考虑这个设置：

用于托管的 Amazon ec2（每月 80 美元 - 不便宜，但如果你能负担得起的话，值得） Django/Python（Python 是地球上最强大的脚本语言 - Django 只是让它在网络上运行）

开发应该使用 SQLlite 和 Django 自带的开发服务器。不要在 Nginx、Apache、MySQL 上浪费时间，直到你有几周的测试版。

哦，我现在在 Mac 上开发，它非常适合本地 Django 开发。

最后，[Pinax](http://pinaxproject.com)是[Django](http://djangoproject.com)开发的一个很好的开始。

# php - Eclipse PDT 和 .yml 文件，无法打开？

> ID：184050
> 
> 赞同：3
> 
> 时间：2008-10-08T18:07:45.633
> 
> 标签：php, eclipse, yaml

我正在使用 Symphony 框架，并且在 Eclipse IDE 中有默认沙箱。当我双击 schema.yml 而不是在 Eclipse 中打开时，它要求 Windows 选择一个程序来选择。我是 Visual Studio 的人，我不明白为什么它不能在 Eclipse 中打开，我该怎么办？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-08T18:51:34.640

右键单击文件，选择打开方式>文本编辑器，它将在 IDE 中打开

# java - Java 应用程序安装程序

> ID：184060
> 
> 赞同：34
> 
> 时间：2008-10-08T18:09:53.337
> 
> 标签：java, installation, toolkit

我不是在寻找 java-web-start，而是在寻找一个胖客户端应用程序安装工具包。我有一个由多个文件（jar 文件、数据文件等）组成的独立应用程序，并且需要执行一些非常标准的安装任务，例如向用户询问目标目录，让他们找到系统的某些部分- 选择一些每台机器或每用户配置选项，并可能尝试为它们检测一些机器设置。

我正在寻找类似于 MSI 或其他向导驱动的安装应用程序的东西。什么是好的 Java 安装程序？如果它具有跨平台能力（Linux、Mac OSX 和 Windows）将是理想的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-08T20:34:07.197

不是 MSI 安装程序，而是跨平台： [izPack](http://izpack.org/)

它是基于 xml 文件的，具有自己的 GUI 或 ant 任务（无论您喜欢什么）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-08T19:57:55.677

Launch4j -- 开源 -- [http://launch4j.sourceforge.net/](http://launch4j.sourceforge.net/)

安装干扰器——http: [//www.installjammer.com/](http://www.installjammer.com/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-08T18:15:20.593

如果您正在寻找开源解决方案，请查看此处：http: [//java-source.net/open-source/installer-generators](http://java-source.net/open-source/installer-generators)

我使用过[InstallAnywhere](http://www.acresso.com/products/installation/installanywhere.htm)，我认为这也是一个很好的解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T07:38:08.353

[AntInstaller](http://antinstaller.sourceforge.net/)使您能够创建跨平台安装程序，其中安装本身是使用[ANT](http://ant.apache.org/)脚本执行的。GUI 使用 XML 配置文件进行配置。

我们用它来创建相当复杂的安装程序。然而，对于复杂的 GUI，配置会变得非常困难。下次我可能会尝试[izPack](http://izpack.org)，因为它似乎也支持 ANT，但具有更好的 GUI。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-20T08:56:34.340

我建议[izPack](http://izpack.org/) 和 [packJacket](http://packjacket.sourceforge.net/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-18T11:44:54.837

虽然它不是基于 Java 的，但我们大约一半的客户使用[BitRock InstallBuilder](http://bitrock.com)来打包 Java 应用程序。它是跨平台的，支持您需要的所有操作系统（Linux、Windows、Mac）。安装程序是原生的，因此它有一定的优势，例如不需要自解压步骤或需要捆绑 JRE，因此安装程序的大小往往更小

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T02:08:37.440

Nullsoft Scriptable Install System [NSIS](http://nsis.sourceforge.net/Main_Page)（最初用于winamp）为windows创建了非常好的安装程序，它非常强大。它有一个在 linux 下运行的编译器，但不幸的是，生成的安装程序仅适用于 Windows。

它相当重，但如果您在安装过程中可能需要做任何模糊复杂或非标准的事情，请记住这一点。

我使用它是因为它与我的 (linux) 构建系统很好地集成在一起，而且无论如何我都想使用软件包在 linux 上安装。

# visual-studio-2008 - VS 2008 的代码覆盖率工具

> ID：184063
> 
> 赞同：11
> 
> 时间：2008-10-08T18:10:19.247
> 
> 标签：visual-studio-2008, unit-testing, code-coverage

我们在 VS 2008 专业版中进行了单元测试，并且遇到了一个可能相当大的障碍：似乎无法确定这个特定 VS 版本中的代码覆盖率。似乎这仅在 VS Team System Development Edition 中可用。

换句话说，VS 2008 专业版允许您编写所有您想要的单元测试，但无法检查哪些代码没有关联的单元测试（或者测试覆盖了多少代码）。这个观察正确吗？

如果是这样，有人可以推荐一个第三方工具来确定代码覆盖率吗？我尝试了 TestMatrix，但完全不为所动（设置屏幕在 120 DPI 时隐藏了 OK 和 Cancel 按钮，运行我当前的一组测试导致完全 VS 锁定）。

一个附带问题：与其升级到 VS Team System Development Edition，不如使用 3rd 方覆盖工具，采用 NUnit 并找到免费/低成本的代码覆盖工具是否更有意义？我们还没有深入到单元测试中，我们希望选择一种不会妨碍我们努力的测试方法......并且不会破坏银行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T18:21:20.940

[无盖](http://www.ncover.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T18:19:57.857

我正在使用[PartCover](http://sourceforge.net/projects/partcover/)从我的 NUnit 测试中获取有关代码覆盖率的基本信息。虽然界面不是阳光下最流畅的体验，但它可以完成工作并且是开源的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T10:21:42.953

I've been using [NCover](http://www.ncover.com/) with [NUnit](http://www.nunit.org/) under VS2008 for a few days. I've found it so easy to find and fill gaps in my test coverage, I've giggled aloud when NCover pops up.

One tip: if your tests are in the same file as the code they're testing, don't bother running NCover unless all of your tests pass. Otherwise, it'll flag all the failing test methods' trailing braces as uncovered. Though, perhaps that's just a hint that I should be putting my tests in a different file…</p>

# iis - 如何在 .NET 和 CF 下运行 IIS 5.1 (WinXP Pro) 下的经典 ASP 脚本？

> ID：184066
> 
> 赞同：2
> 
> 时间：2008-10-08T18:12:03.253
> 
> 标签：iis, asp-classic, isapi-extension

我在设置开发环境时遇到问题。我一直在研究 ColdFusion 和 .NET 应用程序，直到最近我才需要接触 IIS。现在，我必须为一些一次性工作设置一个经典的 ASP 应用程序。

我在 IIS 中添加了一个虚拟目录，并将其指向我本地机器上的实际代码库。然后我将安全性设置为低（对于 ISAPI 扩展，即 ASP）并允许脚本执行。但是，由于某种原因，如果我点击任何 .asp 页面，它会说找不到该页面。但是，HTML 和静态文件加载得很好。

编辑： URLScan 修复似乎已经做到了。在另一个浏览器（即不是 IE6）中启动了应用程序，我得到了更好的错误报告。看起来我们缺少一些包含，但它正在执行脚本。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T18:25:10.763

您需要确保“Active Server Pages”网络服务扩展设置为允许状态。

查看：[http ://classicasp.aspfaq.com/general/why-does-iis-hang-and/or-stop-serving-asp-pages.html](http://classicasp.aspfaq.com/general/why-does-iis-hang-and/or-stop-serving-asp-pages.html)

此外，您应该知道，虚拟目录可能会影响 asp 页面本身中的包含文件路径。如果原始 asp 应用程序不使用虚拟目录，那么您的本地副本也不应该使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T18:24:29.813

查看您的 URL 扫描设置，看看 .asp 是否是允许的文件扩展名

在我的 XP 机器上，相关文件位于 C:\WINDOWS\system32\inetsrv\urlscan\urlscan.ini

# metrics - 什么时候，如果有的话，“代码行数”是一个有用的指标？

> ID：184071
> 
> 赞同：56
> 
> 时间：2008-10-08T18:13:27.557
> 
> 标签：metrics

有些人声称代码最大的敌人是它的大小，我倾向于同意。然而每天你都会听到诸如此类的事情

*   我一天就写了几行代码。
*   我拥有 x 行代码。
*   Windows 是 x 百万行代码。

问题：“#lines of code”什么时候有用？

ps：注意，这种说法的时候，语气是“越多越好”。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-10-08T18:14:48.927

我会说这是您**删除**代码以使项目运行得更好的时候。

说你删除了“X 行”是令人印象深刻的。而且比您添加的代码行更有帮助。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-08T19:03:37.283

我很惊讶没有人提到 Dijkstra 的名言，所以这里是：

> 我今天的观点是，如果我们想计算代码行数，我们不应该将它们视为“产生的行数”，而是“花费的行数”：当前的传统智慧是如此愚蠢，以至于将其计入错误的一边分类帐。

引用来自一篇名为“[论真正教授计算科学的残酷性](http://www.cs.utexas.edu/users/EWD/transcriptions/EWD10xx/EWD1036.html)”的文章。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-10-08T18:53:03.453

这是一个糟糕的指标，但正如其他人所指出的，它让您对系统的整体复杂性有一个（非常）粗略的了解。如果你比较两个项目，A 和 B，A 是 10,000 行代码，B 是 20,000 行代码，这并不能告诉你太多 - 项目 B 可能过于冗长，或者 A 可能被超级压缩。

另一方面，如果一个项目是 10,000 行代码，而另一个是 1,000,000 行，那么第二个项目通常要复杂得多。

当这个指标被用来评估生产力或对某个项目的贡献水平时，就会出现问题。如果程序员“X”写的行数是程序员“Y”的 2 倍，他可能会或可能不会做出更多贡献——也许“Y”正在解决一个更难的问题......

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-10-08T18:16:39.687

跟朋友吹牛的时候。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2010-09-13T08:09:41.473

至少，不是为了进步：

> “通过代码行来衡量编程进度就像通过重量来衡量飞机制造进度。” - 比尔盖茨

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2013-01-08T04:51:04.813

当我发现它非常宝贵时，有一个特殊情况。当你在面试时，他们告诉你，你的部分工作将是维护现有的 C++/Perl/Java/等。遗留项目。询问面试官有多少 KLOC（大约）参与了遗留项目，会让你更好地了解你是否想要他们的工作。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2008-10-08T18:48:07.673

它在加载行式打印机时很有用，这样您就知道要打印的代码列表将消耗多少页。;)

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2010-11-23T14:26:28.303

让我想起了这个：

> 这封信很长，只是因为我没有时间把它缩短。
> ——布莱斯·帕斯卡。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2008-10-08T19:10:45.070

像大多数指标一样，它们在没有上下文的情况下意义不大。所以简短的回答是：从不（除了行式打印机，这很有趣！这些天谁打印出程序？）

一个例子：

想象一下，您正在对遗留代码进行单元测试和重构。它以 50,000 行代码（50 KLOC）和 1,000 个可证明的错误（失败的单元测试）开始。该比率为 1K/50KLOC = 每 50 行代码 1 个错误。显然这是一个糟糕的代码！

现在，经过多次迭代，通过示例性重构，您已将*已知*错误减少了一半（未知错误也减少了一半以上），代码库减少了五倍。该比率现在是 500/10000 = 每 20 行代码 1 个错误。这显然更糟！

根据您想要给人的印象，这可以呈现为以下一项或多项：

*   错误减少 50%
*   代码少五倍
*   减少 80% 的代码
*   错误代码比恶化 60%

所有这些都是正确的（假设我没有搞砸数学），并且它们都无法*总结*这种重构工作必须实现的巨大改进。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2014-03-16T15:20:57.117

套用我大约 25 年前读过的一句话，

“使用代码行作为衡量标准的问题在于它衡量的是*解决方案*的复杂性，而不是*问题*的复杂性”。

我相信这句话出自 David Parnas 在 ACM 杂志上的一篇文章中。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-10-08T18:31:09.283

有很多不同的[软件指标](http://en.wikipedia.org/wiki/Software_metric)。代码行是最常用的，也是最容易理解的。

我很惊讶代码行数指标与其他指标相关的频率。我没有购买可以计算圈复杂度的工具来发现代码异味，而是寻找具有许多行的方法，它们也往往具有很高的复杂性。

使用代码行的一个很好的例子是指标：每行代码的错误。它可以让您直观地了解您应该在项目中找到多少错误。在我的组织中，我们通常每 1000 行代码大约有 20 个错误。这意味着，如果我们准备发布具有 100,000 行代码的产品，并且我们的错误数据库显示我们发现了 50 个错误，那么我们可能应该进行更多测试。如果我们每 1000 行代码有 20 个错误，那么我们可能正在接近我们通常的质量。

一个不好的使用示例是衡量开发人员的生产力。如果您通过代码行来衡量开发人员的生产力，那么人们往往会使用更多的代码来交付更少的代码。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-08T18:15:19.987

答：什么时候可以谈论负面的代码行。如：“我今天删除了 40 行无关的代码，程序仍然像以前一样运行。”

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-08T18:20:38.087

我同意获取项目中代码的总行数是衡量**复杂性**的一种方法。

这当然不是复杂性的唯一衡量标准。例如，调试一个 100 行的混淆 Perl 脚本与调试一个带有注释模板的 5,000 行 Java 项目有很大不同。

但是如果不查看源代码，您通常会认为代码行越多越复杂，就像您可能认为 10MB 源代码压缩包比 15kb 源代码压缩包更复杂一样。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-08T18:23:12.217

它在很多方面都很有用。

我不记得确切的 # 但微软有一个网络广播，平均每 X 行代码就有 y 个错误。您可以使用该语句并使用它为几件事提供基线。

*   代码审查员的工作做得如何。
*   通过比较他们在几个项目中的错误率来判断 2 名员工的技能水平。

我们要看的另一件事是，为什么它有这么多行？很多时候，当一个新程序员陷入困境时，他们只会复制和粘贴代码块，而不是创建函数和封装。

* * *

我认为我在一天内写了 x 行代码是一个可怕的措施。它没有考虑问题的难度，你的写作语言等等。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-08T18:24:31.607

在我看来，我可以从任何给定项目的头顶引用的代码行数是有限的。对于普通程序员来说，这个限制可能非常相似。因此，如果您知道您的项目有 200 万行代码，并且您的程序员能够理解错误是否与他们熟悉的 5K 行代码有关，那么您知道您需要雇用 400程序员可以很好地从某人的记忆中覆盖您的代码库。

这也会让你三思而后行，让你的代码库增长得太快，并可能让你考虑重构它以使其更易于理解。

注意我编造了这些数字。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-10-09T15:44:11.800

软件工程学院的软件社区流程成熟度概况：1998 年年终更新（不幸的是，我找不到链接）讨论了对大约 800 个软件开发团队（或者可能是商店）的调查。平均缺陷密度为每 1000 LOC 12 个缺陷。

如果你有一个有 0 个缺陷的应用程序（它在现实中不存在，但让我们假设一下）并且平均写了 1000 个 LOC，你可以假设你刚刚在系统中引入了 12 个缺陷。如果 QA 发现 1 或 2 个缺陷仅此而已，那么他们需要进行更多测试，因为可能还有 10 多个缺陷。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-08T20:02:54.277

当您想知道代码文件是否变得太大时，代码行很有用。嗯……这个文件现在有 5000 行代码。也许我应该重构这个。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-12-04T13:35:20.140

当您必须为需要订购的打孔卡数量进行预算时。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-10-08T18:15:40.593

它是生产力和复杂性的衡量标准。像所有指标一样，它需要谨慎评估。单个指标通常不足以提供完整的答案。

IE，一个 500 行的程序并不像 5000 行那么复杂。现在您必须提出其他问题才能更好地了解该程序……但是现在您有了一个指标。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-10-08T18:15:48.987

这是吓唬/打动人们的一个很好的指标。就是这样，绝对是我在所有这三个例子中看到的上下文。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2010-04-28T00:44:22.573

正如大多数人已经说过的那样，它可能是一个模棱两可的指标，尤其是在您比较使用不同语言编码的人时。

**5,000 行 Lisp ！= 5,000 行 C**

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-12-18T16:44:38.770

我写了 2 篇博文，详细说明了计算代码行数 (LoC) 的优缺点：

[您如何计算代码行数 (LOC) ？](http://codebetter.com/blogs/patricksmacchia/archive/2007/10/03/how-do-you-count-your-number-of-lines-of-code-loc.aspx)：这个想法是为了解释你需要计算代码的逻辑行数而不是物理计数。为此，您可以使用[NDepend](http://www.NDepend.com)等工具。

[为什么计算代码行数 (LOC) 很有用？](http://codebetter.com/blogs/patricksmacchia/archive/2007/10/05/why-is-it-useful-to-count-the-number-of-lines-of-code-loc.aspx): 这个想法是永远不应该使用 LoC 来衡量生产力，而更多地用于测试覆盖率估计和软件截止日期估计。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2017-10-04T20:41:49.407

总是。一堆新秀在这个问题上。大师们大量且密集地编写代码。好毕业生写了很多台词，但毛茸茸的太多了。垃圾复制代码行。所以，首先做一个 Tiles 分析或门，当然。

如果您的组织不进行任何复杂点、特征点/功能点、提交或其他分析，则必须使用 LoC。

任何告诉你不要用 LoC 衡量他或她的开发人员都是狗屎。任何大师级的曲柄都会像您一样编写我们的代码，您不会相信。我曾与少数人合作过，他们的工作效率是普通程序员的 20 倍到 200 倍。他们的代码非常、非常、非常紧凑和高效。是的，就像 Dijkstra 一样，他们有巨大的心智模型。

最后，在任何事业中，大多数人都不擅长，大多数人做的也不是很好。编程也不例外。

是的，对任何大型项目进行命中分析，发现 20% 以上是死代码。同样，高级程序员经常消灭死代码和垃圾代码。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-08T18:15:32.950

当您重构代码库并且可以显示您*删除*了代码行时，所有回归测试仍然通过。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-10-08T18:23:20.063

代码行实际上并没有那么有用，如果它被管理层用作衡量标准，它会导致程序员进行大量重构以提高他们的分数。此外，糟糕的算法不会被简洁的短算法取代，因为这会导致负 LOC 计数对您不利。老实说，不要为使用 LOC/d 作为生产力指标的公司工作，因为管理层显然对软件开发一无所知，因此您从第一天起就总是处于不利地位。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-10-08T18:29:58.320

当指出为什么改变需要这么长时间时。

“Windows 是 700 万行代码，测试所有依赖项需要一段时间……”

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-10-08T18:34:09.747

在比赛中。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2008-10-08T18:38:26.633

当编码人员不知道您在计算代码行数时，因此没有理由故意添加冗余代码来玩弄系统。当团队中的每个人都有相似的编码风格时（所以每行都有一个已知的平均“价值”。）只有当你没有更好的衡量标准时。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2008-10-08T19:09:36.523

查看维基百科的定义：[http ://en.wikipedia.org/wiki/Source_lines_of_code](http://en.wikipedia.org/wiki/Source_lines_of_code)

SLOC = '源代码行'

实际上，我在这些指标上投入了相当多的时间。计算 SLOC 也有不同的方法。

来自维基百科文章：

> 有两种主要类型的 SLOC 度量：物理 SLOC 和逻辑 SLOC。

另一个很好的资源：[http ://www.dwheeler.com/sloc/](http://www.dwheeler.com/sloc/)

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-10-08T19:51:03.117

它们可以帮助指示应用程序的大小 - 与质量无关！我的意思是，如果您指出您从事的应用程序有 1,000 行，而他们的应用程序有 500k 行（大约），那么潜在雇主可以理解您是否有大型系统经验与小型实用程序编程。

我完全同意沃伦的观点，即从系统中删除的代码行数比添加的行数更有用。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2014-03-07T18:26:36.043

在确定努力水平 (LOE) 时。如果您正在制定一个提案，并且您将有大致相同的工程师在新项目上工作，那么您可能能够确定需要多少工程师多长时间。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2012-05-16T09:08:17.140

当它与缺陷数量相关时，这是一个非常有用的想法。“缺陷”为您提供代码质量的衡量标准。“缺陷”越少，软件就越好；几乎不可能消除所有缺陷。在许多情况下，一个单一的缺陷可能是有害的和致命的。

但是，似乎不存在无缺陷的软件。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-10-09T04:09:50.583

除了前面提到的“吹牛”目的之外，从功能上讲永远不会。

行！=有效性。根据我的经验，这种关系通常是相反的（尽管不严格，尤其是极端情况，原因很明显）

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-10-09T15:36:50.083

代码行数取决于语言。

例如，1 行 C 代码平均相当于 x 行 ASM 代码。1 行 C++ -> C 等....

由于 VM 的背景支持，Java 和 C# 封装了相当多的代码行。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-10-08T18:18:41.367

我发现它在两种情况下很有用：

1.  当编码时间减少时，在我自己的新项目中衡量我自己的生产力。

2.  在与一家大公司合作并与一位真正每天只了解小部件的经理交谈时。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-10-08T18:19:48.200

首先，我将排除生成的代码并添加生成器输入的代码和生成器本身。

然后我会说（有点讽刺），每一行代码都可能包含一个错误并且需要维护。要维护更多代码，您需要更多的开发人员。从这个意义上说，更多的代码会产生更多的就业机会。

我想从上面的陈述中排除单元测试，因为较少的单元测试通常不会提高可维护性:)

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-10-08T18:27:45.063

为给定任务添加的代码数量很大程度上取决于编写代码的人。它不应该被用作生产力的衡量标准。一个给定的人可以产生 1000 行冗余和复杂的废话，而同样的问题可以由另一个人用 10 行简洁的代码来解决。在尝试使用添加的 LOC 作为指标时，还应考虑“谁”因素。

一个实际有用的指标是“发现的缺陷数量与添加的行数”。这将使您了解给定团队或个人的编码和测试覆盖能力。

正如其他人也指出的那样，删除的 LOC 比添加的 LOC 具有更好的吹牛权:)

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-10-08T18:44:54.343

这主要是对已经大量评论的补充。但基本上，代码行数（或者可能是 totalCharacterCount/60）表示怪物的大小。正如一些人所说，这为代码库的复杂性提供了线索。它的复杂程度有很大的影响。它在一定程度上影响了理解系统和做出改变的难度。

这就是为什么人们想要更少的代码行。从理论上讲，代码行数越少，复杂性就越小，出错的空间也就越小。我不确定知道预先知道对估计和计划以外的任何事情都非常有用。

例如：假设我有一个项目，经过粗略的检查，我意识到这将涉及在一个有 10,000 行的应用程序中修改多达 1000 行代码。我知道这个项目可能需要更长的时间来实现，不太稳定，并且需要更长的时间来调试和测试。

它对于理解两个构建之间的变化范围也非常有用。我写了一个小程序来分析任何两个 SVN 版本之间的变化范围。它将查看一个统一的差异，并从中找出添加、删除或更改了多少行。这有助于我了解在新版本之后的测试和 QA 中会发生什么。基本上，更大数量的变化意味着我们需要更密切地观察构建，通过完整的回归测试等。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2008-10-08T19:07:45.607

我听说微软过去每 6 个月解雇 5% 的人，我一直认为这将基于编写的代码行数，这就是为什么 Windows 如此庞大、缓慢和低效的原因;)。代码行数是衡量应用程序在粗略排序方面复杂性的有用指标，即 Basic 中的初学者程序可能是 10 行代码，100 行代码是玩具应用程序，50000 行是合理大小的应用程序，10百万行代码是一个叫做 Windows 的怪物。

代码行数不是一个非常有用的指标，我曾经用汇编语言（主要是 68000 行）编写游戏，它们的代码行数约为 50k，但我通过不将寄存器推送到堆栈并跟踪寄存器中包含的内容以减少代码大小（我认识的其他程序员将 d0-d7、a0-a6 的倍数推送到堆栈，这显然会减慢代码速度，但简化了跟踪有什么影响）。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2008-10-08T19:10:16.367

出于风险评估的目的，它可以很好地衡量复杂性 - 更改的行越多，引入错误的机会就越大。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2008-10-08T20:42:47.287

在向将代码行数视为产品大小一般指标的客户推销综合产品的广泛性时，代码行数非常有用。例如，当您试图说服某人您的产品处理许多极端情况时，或者当您试图进入开发工具的测试版时，工具供应商希望获得最大的代码覆盖率以进行测试。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-10-29T08:38:03.477

这在销售演示中经常使用。例如，KLoC（Kilo Lines of Code）或 LoC 用于展示供应商组织对大型/复杂系统的能力。当供应商试图展示他们维护复杂遗留系统的能力时，尤其如此。作为谈判的一部分，有时客户组织会提供代表代码块来与供应商一起执行概念证明，以测试供应商的能力。该代表代码将具有足够的复杂性供供应商公司处理，并且其关于“维护”的宣传具有数百万 LoC 的系统可能会受到关注。

所以，是的，代码行在销售演示中被使用和滥用，因此是销售中的一个有用指标。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2010-09-13T07:55:25.280

LOC 的数量在计算缺陷率（每 1,000 LOC 的错误等）时很有用

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2012-05-16T20:41:03.380

代码行数不是比较不同项目的有用指标。

但是，它可以在项目中用作移动图形，用于观察代码库的大小如何随时间变化。如果您生成一个图表作为 CI 过程的一部分，显示每次构建时的代码行，它将帮助您可视化项目的发展方式。

即使在这种情况下，我也认为确切的“代码行”数字本身并不重要。有用的是趋势的可视化 - 随着更多功能的添加，稳步向上攀升；大项目完成的跳跃；删除了一些冗余代码的下降。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2015-03-09T13:27:22.660

在比较语言时它可能很有用。我曾经用 Groovy 和 Clojure 写过一个小模块。Clojure 程序有大约 250 个 loc，而 Groovy 有 1000 个 loc。有趣的是，当我查看一个复杂函数并以类似的方式编写它时，它的行数完全相同。这表明 Groovy 代码被样板填满，并给了我一些开始使用 Clojure 的额外理由：)

正如其他人所说，查看提交时也很好。如果您引入的代码行数多于删除的代码行数，那么您需要意识到您增加了解决方案的复杂性。如果问题本身不会增加复杂性，这可能会让您重新考虑您的解决方案。与自己做一个很好的协议来鼓励重构，如果你添加更多的代码行，那么你应该花一些时间进行重构。

最后，尽管您可以通过努力减少 loc 来编写难以阅读的内容，但具有较少 loc 的解决方案几乎总是更容易阅读，因为阅读的内容更少。

# visual-studio - 为什么在 firefox 2.0x 中进行本地调试时，Visual Studio 不能始终正确呈现我的页面？

> ID：184074
> 
> 赞同：4
> 
> 时间：2008-10-08T18:14:07.570
> 
> 标签：visual-studio, debugging, firefox, localhost

当我在 fire fox 2.0x 中多次本地调试时，我的页面不会正确添加样式，或者页面不会完全呈现（结尾似乎被切断了）。有时需要多次刷新或换档刷新才能解决此问题。这是一个普遍的问题还是只是我？有什么解决办法吗？

我想补充一点，这也发生在我的火狐 3.x 中。我将我的 javascript 动态添加到页面中，这可能是问题的一部分。这是我在本地使用 Visual Studio 工作的时候。

更新：这确实发生在 IE 中，但在 Fire Fox 中更常见。问题似乎只是没有加载 javascript 和 CSS 文件。例如，我得到 jQuery 未定义，$ 未定义等。我认为我没有本地 IIS 来测试它，但从服务器上它总是可以完美运行。Fire Bug 显示了我要请求和接收的所有 css 和 javascript 文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T20:50:01.200

这可能是Firefox 浏览器的**IPv6 和 DNS 的问题。**已知此问题会*减慢*localhost:SOMEPORT 上的 Firefox。效果是某些外部文件（css、js 等）无法加载，从而导致页面部分呈现。

您可以通过简单地在 Firefox 中停用 IPv6 来解决此问题：

1.  `about:config`在 Firefox 地址栏中插入
2.  设置`network.dns.disableIPv6`为`true`或添加`localhost`到`network.dns.ipv4OnlyDomains`

解决此问题的另一种方法是通过以下方式从主机文件中删除 ipv6 地址：打开文件

```
C:\Windows\System32\drivers\etc\hosts 
```

（具有管理员权限）并删除（或注释掉#）：

```
 :: localhost 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T21:41:06.523

确保缩小问题的范围。问题只是在从 VS 调试时发生还是在本地 IIS 上也发生？使用基于服务器的 IIS？贵公司的其他开发人员是否会发生这种情况？它真的只是 FireFox 还是发生在 Chrome、Opera、IE 等上？

假设您已经解决了所有问题，我建议您安装一个名为“Tamper Data”的 FireFox 插件。打开它并刷新页面。您将看到从浏览器到服务器的每个连接的记录（对于每个 html 文件、图像、css 文件等）。查看它们中的任何一个是否非常慢或未完成（可能其中一个文件需要很长时间，而 FF 在加载其他重要文件之前正在等待它完成）。

假设所有文件都正确加载，您应该考虑检查语法是否有效（可能有一些未闭合的标签或引号导致 FF 混淆）。我使用一个名为“Web Developer”的插件，但还有很多其他选项。

您还可以使用一个名为 FireBug 的插件来查看页面各个部分背后的 HTML，看看是否有任何明显的问题。您启动 FireBug，转到 HTML 选项卡，单击 Inpsect，然后将鼠标移到页面上的某个内容上，它会向您显示其背后的 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T11:33:20.450

有什么进一步的关于这些人吗？

我使用 Firebug 检查了流量，似乎在查看样式表请求的响应时，响应只是空白。刷新（有时多次）后，年龄显示正确，响应信息包含样式表。我没有在任何其他浏览器中看到过这种情况，并且仅在从 Visual Studio 查看应用程序时才会出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T18:31:00.510

您是否将您在 Firefox 中看到的内容与 Visual Studio 设计器中显示的内容进行比较？如果是这种情况，那么他们使用 2 种不同的方法来呈现 html，并且可能不会显示相同的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T19:52:23.553

2！最近我有同样的问题。我使用 MVC 1.0，并在 Views/Share 文件夹中添加了一个新样式表。当我运行项目时，页面没有与 css 一起呈现。如果您的 Web 项目是 MVC 项目，请尝试将 css 文件放入 Content 文件夹。希望这有帮助。HaiVu.Doan。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T22:57:54.347

要做的一件事是检查相关页面的来源。我的猜测是 VS 运行的本地服务器并没有为您提供页面的整个源。验证这一点的一种方法是在调试环境中运行完全相同的代码，以及从像 IIS 6 这样的“真实”服务器。如果在从两台服务器加载页面时看到相同的行为，以及确保浏览器正在接收完整的页面源代码，那么它是 Firefox 中的一个错误，应该报告。如果其他浏览器尤其如此，即。IE、Chrome、Safari、Opera，完全渲染页面。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-16T16:20:23.067

万一其他人在较新版本的 Visual Studio 中发现了这一点，我必须以管理员身份运行 VS。这是我一直忘记做的事情，但是一旦我在打开 VS 时右键单击以管理员身份运行，问题就消失了。

最初的问题，当使用 Firefox 作为浏览器从 VS 2012 运行项目时，我无法渲染 CSS。（顺便说一句，IE 工作得很好。）内容会在那里，但没有 CSS。这是我在输入问题时发现的第一篇文章。

# c# - 如何强制 C# .net 应用程序在 Windows 中仅运行一个实例？

> ID：184084
> 
> 赞同：73
> 
> 时间：2008-10-08T18:15:35.947
> 
> 标签：c#, .net, windows, winforms

> **可能重复：**
> [创建单实例应用程序的正确方法是什么？](https://stackoverflow.com/questions/19147/what-is-the-correct-way-to-create-a-single-instance-application)

如何强制 C# .net 应用程序在 Windows 中仅运行一个实例？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2008-10-08T18:24:56.723

我更喜欢类似于以下的互斥锁解决方案。这样，如果它已经加载，它会重新关注应用程序

```
using System.Threading;

[DllImport("user32.dll")]
[return: MarshalAs(UnmanagedType.Bool)]
static extern bool SetForegroundWindow(IntPtr hWnd);

/// <summary>
/// The main entry point for the application.
/// </summary>
[STAThread]
static void Main()
{
   bool createdNew = true;
   using (Mutex mutex = new Mutex(true, "MyApplicationName", out createdNew))
   {
      if (createdNew)
      {
         Application.EnableVisualStyles();
         Application.SetCompatibleTextRenderingDefault(false);
         Application.Run(new MainForm());
      }
      else
      {
         Process current = Process.GetCurrentProcess();
         foreach (Process process in Process.GetProcessesByName(current.ProcessName))
         {
            if (process.Id != current.Id)
            {
               SetForegroundWindow(process.MainWindowHandle);
               break;
            }
         }
      }
   }
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2011-06-20T19:52:55.397

要强制在 .net (C#) 中仅运行一个程序的一个实例，请在 program.cs 文件中使用以下代码：

```
public static Process PriorProcess()
    // Returns a System.Diagnostics.Process pointing to
    // a pre-existing process with the same name as the
    // current one, if any; or null if the current process
    // is unique.
    {
        Process curr = Process.GetCurrentProcess();
        Process[] procs = Process.GetProcessesByName(curr.ProcessName);
        foreach (Process p in procs)
        {
            if ((p.Id != curr.Id) &&
                (p.MainModule.FileName == curr.MainModule.FileName))
                return p;
        }
        return null;
    } 
```

以及以下内容：

```
[STAThread]
    static void Main()
    {
        if (PriorProcess() != null)
        {

            MessageBox.Show("Another instance of the app is already running.");
            return;
        }
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form());
    } 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-08T18:38:20.127

这是我在我的应用程序中使用的：

```
static void Main()
{
  bool mutexCreated = false;
  System.Threading.Mutex mutex = new System.Threading.Mutex( true, @"Local\slimCODE.slimKEYS.exe", out mutexCreated );

  if( !mutexCreated )
  {
    if( MessageBox.Show(
      "slimKEYS is already running. Hotkeys cannot be shared between different instances. Are you sure you wish to run this second instance?",
      "slimKEYS already running",
      MessageBoxButtons.YesNo,
      MessageBoxIcon.Question ) != DialogResult.Yes )
    {
      mutex.Close();
      return;
    }
  }

  // The usual stuff with Application.Run()

  mutex.Close();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-13T02:43:49.803

另一种单一实例应用程序的方法是检查它们的哈希和。在弄乱了互斥锁（没有按我想要的那样工作）之后，我得到了它的工作方式：

```
 [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool SetForegroundWindow(IntPtr hWnd);

    public Main()
    {
        InitializeComponent();

        Process current = Process.GetCurrentProcess();
        string currentmd5 = md5hash(current.MainModule.FileName);
        Process[] processlist = Process.GetProcesses();
        foreach (Process process in processlist)
        {
            if (process.Id != current.Id)
            {
                try
                {
                    if (currentmd5 == md5hash(process.MainModule.FileName))
                    {
                        SetForegroundWindow(process.MainWindowHandle);
                        Environment.Exit(0);
                    }
                }
                catch (/* your exception */) { /* your exception goes here */ }
            }
        }
    }

    private string md5hash(string file)
    {
        string check;
        using (FileStream FileCheck = File.OpenRead(file))
        {
            MD5 md5 = new MD5CryptoServiceProvider();
            byte[] md5Hash = md5.ComputeHash(FileCheck);
            check = BitConverter.ToString(md5Hash).Replace("-", "").ToLower();
        }

        return check;
    } 
```

它仅按进程 ID 检查 md5 总和。

如果找到此应用程序的实例，它会聚焦正在运行的应用程序并自行退出。

你可以重命名它或对你的文件做你想做的事。如果 md5 哈希相同，它不会打开两次。

有人可以建议吗？我知道它已被回答，但也许有人正在寻找互斥锁的替代品。

# hash - 当今常用的最强哈希算法是什么？

> ID：184089
> 
> 赞同：10
> 
> 时间：2008-10-08T18:16:12.560
> 
> 标签：hash

我正在构建一个 Web 应用程序，并希望对密码使用最强的哈希算法。sha512、whirlpool、ripemd160 和tiger192,4 之间有什么区别（如果有的话）？哪一个会被认为在密码学上更强大？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-08T18:20:57.120

bCrypt - 为什么会有一个很长的解释，我推荐[彩虹表足够了：你需要知道的关于安全密码方案的知识](http://www.securityfocus.com/blogs/262)

基本上，它是安全的，它很慢，它已经实现了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T18:48:27.253

如果您真的关心系统的安全性（而不是算法的学术实力），那么您应该使用经过验证且成熟的实现而不是吹毛求疵的算法。

我会推荐[Ulrich Drepper 的 SHA-crypt implementation](http://people.redhat.com/drepper/SHA-crypt.txt)。此实现使用 SHA-512，一种 16 个字符的长盐，经过同行评审，并计划通过 glibc 2.7 进入所有主要的 Linux 发行版。

* * *

PS：一旦你达到了这个安全级别，无论如何都会有[黑色直升机来拜访你。](http://www.urbandictionary.com/define.php?term=black+helicopter)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T18:30:10.330

大卫，这些都是非常强大的功能。即使是大肆宣传的 MD5 冲突也不是密码破解类型，它们只是生成两个具有相同 MD5 的不同字符串（与找到一个生成给定 MD5 值的字符串非常不同的命题）。

如果您担心密码的安全性，则需要担心用于存储密码的协议、用于恢复用户忘记的密码的协议以及所有其他可能的攻击途径。与暴力破解密码分析相比，这些选项更常用于破解密码。

不过，请务必使用盐。

但首先阅读AviewAnew发布的文章

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T18:26:38.543

[这是一篇关于存储密码的恐怖编码](http://www.codinghorror.com/blog/archives/000953.html)的好帖子。简而言之，他建议使用随机唯一盐的 bcrypt 或 SHA-2。

# emacs - 在 Emacs 中导航重复标签定义的最佳方法是什么？

> ID：184092
> 
> 赞同：6
> 
> 时间：2008-10-08T18:16:44.087
> 
> 标签：emacs, tags

在 emacs 中，导航到名称可能出现在多个不同文件中的特定函数的最佳选择是什么？在 etags 中，您只能一次循环浏览标签，如果您要查找的函数名称很受欢迎，这可能需要一段时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T00:59:39.703

*铜米-。*循环相同标签的所有位置，但如果您想查看与您的函数名称匹配的所有标签的列表，您可以使用命令*tags-apropos*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T18:04:28.900

Etags-选择：

[http://www.emacswiki.org/cgi-bin/wiki/EtagsSelect](http://www.emacswiki.org/cgi-bin/wiki/EtagsSelect)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T18:59:38.583

如果您的编程语言是**C**，那么[cscope](http://cscope.sourceforge.net/)比 etags 好得多。它为您提供符号实例及其上下文的交互式列表。更多信息在[这个答案中](https://stackoverflow.com/questions/60367/the-single-most-useful-emacs-feature#218611)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-05T07:21:11.200

1.  [冰柱标签命令](http://www.emacswiki.org/emacs/Icicles_-_Emacs_Tags_Enhancements)

    特别是，使用 command`icicle-find-tag`来完成所有这些 vanilla 命令所做的事情：

    *   `find-tag`( `M-.`) 查找标签
    *   `tags-loop-continue`( `M-,`) 查找另一个匹配的标签
    *   `tags-apropos`列出与正则表达式匹配的所有标签
    *   `list-tags`显示给定源文件中的所有标签（定义）。

    `icicle-find-tag`是一个通用标签浏览器：作为一个多命令，您可以在一次调用中以任何顺序访问任意数量的标签。

2.  [Icicles imenu](http://www.emacswiki.org/emacs/Icicles_-_Other_Search_Commands#IciclesImenu) -- 跨文件或缓冲区的 Imenu。在选定的函数定义中搜索（作为搜索上下文）。

# c# - 将多行更新到 SQL 表中

> ID：184096
> 
> 赞同：2
> 
> 时间：2008-10-08T18:17:36.550
> 
> 标签：c#, asp.net, sql

假设有一个完全填充的数据数组 String[n][3] myData。

我想做这个：

```
for (String[] row : myData)
{
   SQL = "update mytable set col3 = row[2]
   where col1 = row[0] and col2=row[1];" 
} 
```

显然我遗漏了很多，但我想尽可能简洁地表达这个想法。

有没有一种简单的方法可以在单个 DB 命令中执行此操作？一个不那么简单的方法怎么样？

编辑：数据不是来自另一个表（它是一个网络表单提交 - 多项选择考试）
看到应用程序是面向网络的，它必须是注入证明。参数化查询是我的首选方式。
我正在使用 MS-SQL Server 2005

编辑：关闭并重新询问[多个数据库更新：](https://stackoverflow.com/questions/184471/multiple-db-updates)

编辑：重新打开，因为这似乎是一个流行的问题

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-08T18:48:59.233

这取决于您使用的数据库。如果您使用的是 SQL Server 2008，则可以使用存储过程[TABLE 参数](http://www.sqlteam.com/article/sql-server-2008-table-valued-parameters)。这允许您将所有值传递到单个表中的存储过程中，然后您可以执行以下操作：

```
update mytable set mytable.col1 = @tbl.col1
  from mytable 
  inner join @tbl on mytable.col2 = @tbl.col2 
```

如果您使用的是 SQL Server 2005，则可以使用 XML。将值格式化为 XML，然后使用 XQuery 语句（即“nodes”和“value”）解析出 XML。这也可以在单个 SQL 语句中完成，并且不需要存储过程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T18:36:00.833

如果您使用的是 Sql Server，则可以使用 SqlBulkCopy。您首先必须将数据放入 DataTable 中，这非常容易，因为您已经将它放在字符串数组中。

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T18:22:08.990

您可以制作一个大字符串，例如：

```
for (String[] row : myData)
{
   SQL += "update mytable set col3 = row[2]
   where col1 = row[0] and col2=row[1];" 
}

sqlDriver.doInsertQuery(SQL); // change this to your way of inserting into the db 
```

并且一次全部提交。我对 SQL 不是很好，所以我会这样做。

sql引擎只会用';'分割它 并自己进行单独的插入。不过，可以将其全部添加到字符串中。这就像你将一个带有多个更新/插入的大字符串复制到 sql 提示符中一样

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T18:23:02.203

这可能不是您想要的答案，但是从数据库的角度来看，打开一个事务、执行您的语句然后提交该事务将按照您的描述进行。

在事务完成之前，对于数据库的其他用户，数据库的状态不会改变，这可能是首选效果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T18:50:39.510

看起来您想在具有代码 B 和 C 的行上进行更新 A。（A、B、C）在 myData.xml 中存储为元组（行）。不是吗？

也许（如果您使用的是 Microsoft SQL Server……我不知道它是否存在于 Oracle 中，可能是）您可以使用带有 UPDATE 的 JOIN。您可以在与另一个连接的表上声明更新。如果 myData 来自另一个表，那么您可以这样做（这不是正确的语法）：

```
UPDATE whatchanges wc INNER JOIN changes c ON <yourcondition>
SET wc.col1 = c.newvalue
WHERE .... 
```

（如果您想应用“更改”表中的所有更改，您当然不必使用 WHERE，INNER JOIN 已经选择了正确的行）。

当然，这种更新是有限制的。它是 MS SQL 专有的。因此，如果是您的情况，我建议您在 MS 网络上查找它（关键字：UPDATE 和 JOIN）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T19:05:17.313

如果您在数据访问层中使用[企业库](http://www.codeplex.com/entlib)，您可以在 .Net 中创建事务，遍历您的过程调用，然后从 .Net 提交/回滚。

```
DbTransaction transaction = connection.BeginTransaction();
try
{
    for (String[] row : myData)
    {
        ListDictionary params = new Specialized.ListDictionary();
        params.add("@col3", row[2]);
        params.add("@col1", row[0]);
        params.add("@col2", row[1]);
        executeNonQuery("myUpdateProcedure", params);
    }

    transaction.commit();

}
catch(Exception ex)
{
    transaction.rollback();
    throw ex;
}
finally
{

    connection.close();
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-08T19:07:02.457

如果由于某种原因您无法使用上面建议的方法之一执行更新，那么下面的效率极低的方法可能对您有用。

```
SQL = "Update myTable Set Col3 = Case " 
for (String[] row : myData)
{
   SQL += "When Col1 = " + Row[0] + " and Col2 = " + Row[1] + " then " + row[2] + " "   
}
SQL + = "Else Col3 end" 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-08T18:22:38.333

并不真地。您可以使用相同的循环创建字符串，然后将您的值作为参数传递，但这仍然是多个数据库命令。

```
for each whatever
    sql += "UPDATE ... ;"
end for
execute (sql) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-08T18:25:23.710

我怀疑您将需要使用多个 SQL 语句。您可能会找到一个处理细节的包装器，但在下面我想它会为每个 UPDATE 迭代地运行一条 SQL 语句。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-08T19:32:50.580

发出一个针对值表的更新：

```
UPDATE myTable SET col3=c FROM myTable JOIN (
  SELECT 1 as a, 2 as b, 'value1' as c UNION ALL
  SELECT 3 as a, 4 as b, 'value2' as c -- etc...
) x ON myTable.col1=x.a AND myTable.col2=x.b 
```

所以你只需像这样把它放在一起：

```
// make one of these for each row
String.Format("SELECT {0} as a, {1} as b, '{2}' as c", 
  row[0], row[1], row[2].Replace("'","''")) 

// put it together
string expr = "UPDATE myTable SET col3=c FROM myTable JOIN (" +
  String.Join(stringformatarray, " UNION ALL ") +
  ") x ON myTable.col1=x.a AND myTable.col2=x.b" 
```

或者您可以使用 StringBuilder 将其放在一起。

and then, of course, you execute this one string.

# actionscript-3 - 有没有办法从对象中删除未知的事件监听器？

> ID：184099
> 
> 赞同：6
> 
> 时间：2008-10-08T18:17:59.997
> 
> 标签：actionscript-3

我想要一个可重用的按钮，可以为许多不同的回调之一注册，由外部源确定。设置新回调时，我想删除旧的。我还希望能够随时从外部清除回调。

```
public function registerButtonCallback(function:Function):void
{
  clearButtonCallback();

  button.addEventListener(MouseEvent.CLICK, function, false, 0, true);
}

public function clearButtonCallback():void
{
  if (button.hasEventListener(MouseEvent.CLICK) == true)
  {
    // do something to remove that listener
  }
} 
```

我在这里看到了在回调中使用“arguments.callee”的建议，但我不希望将该功能与回调绑定 - 例如，我可能希望能够单击该按钮两次。

建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-08T19:01:03.810

我假设您在任何给定时间都只需要一个回调函数。如果是这种情况，那么为什么不在按钮上与单击事件相关联的单个回调函数本身称为函数并让该函数可设置......

```
<mx:Button click="doCallback()" .../>

public var onClickFunction:Function = null;
private function doCallback():void
{
    if (onClickFunction != null)
    {
        onClickFunction(); // optionally you can pass some parameters in here if you match the signature of your callback
    }
} 
```

包含您的按钮的控件的使用者将使用适当的函数设置 onClickFunction。事实上，您可以随意设置它。

如果您想更进一步，您可以子类化 AS3 Button 类并将所有这些包装在其中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-20T16:15:31.500

不，您需要保留对侦听器的引用才能将其删除。除非您预先存储对侦听器函数的引用，否则没有记录的公共方法可用于从 EventDispatcher 检索此类引用。

```
addEventListener(type:String, listener:Function, useCapture:Boolean = false, priority:int = 0, useWeakReference:Boolean = false):void
dispatchEvent(event:Event):Boolean
hasEventListener(type:String):Boolean
removeEventListener(type:String, listener:Function, useCapture:Boolean = false):void
willTrigger(type:String):Boolean 
```

如您所见，有两种方法可以告诉您一种类型的事件是否注册了侦听器或其父事件中的一个是否注册了侦听器，但这些方法实际上都没有返回已注册侦听器的列表。

现在请去骚扰 Adob​​e 编写这样一个无用的 API。基本上，它们使您能够知道事件流“是否”发生了变化，但是它们使您无法对这些信息做任何事情！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T01:44:58.893

将监听器存储为道具。添加另一个事件时，检查监听器是否存在，如果存在，则调用 removeEventListener。

或者，覆盖按钮的 addEventListener 方法。调用 addEventListener 时，在将闭包添加到 Dictionary 对象中的事件之前存储闭包。再次调用 addEventListener 时，将其删除：

```
 var listeners:Dictionary = new Dictionary();

override public function addEventListener( type : String, listener : Function, useCapture : Boolean = false, priority : int = 0, useWeakReference : Boolean = false) : void {

```
 if( listeners[ type ] ) {

     if( listeners[ type ] [ useCapture ] {

        //snip... etc: check for existence of the listener

        removeEventListener( type, listeners[ type ] [ useCapture ], useCapture );

        listeners[ type ] [ useCapture ] = null;

        //clean up: if no listeners of this type exist, remove the dictionary key for the type, etc...

     }

  }

  listeners[ type ] [ useCapture ] = listener;

  super.addEventListener( type, listener, useCapture, priority, useWeakReference );

}; 
``` 
            回答 #4

赞同：2

时间：2010-08-01T13:38:03.110

为此，我编写了一个名为 EventCurb 的子类，请在此处查看我的[博客](http://thumbleaf.com)或在下面粘贴。

```
package
{
   import flash.events.EventDispatcher;
   import flash.utils.Dictionary;
   /**
    * ...
    * @author Thomas James Thorstensson
    * @version 1.0.1
    */
   public class EventCurb extends EventDispatcher
   {
      private static var instance:EventCurb= new EventCurb();
      private var objDict:Dictionary = new Dictionary(true);
      private var _listener:Function;
      private var objArr:Array;
      private var obj:Object;

      public function EventCurb() {
         if( instance ) throw new Error( "Singleton and can only be accessed through Singleton.getInstance()" );
      }

      public static function getInstance():EventCurb {
         return instance;
      }

      override public function addEventListener(type:String, listener:Function, useCapture:Boolean = false, priority:int = 0, useWeakReference:Boolean = false):void
      {
         super.addEventListener(type, listener, useCapture, priority, useWeakReference);
      }

      override public function removeEventListener(type:String, listener:Function, useCapture:Boolean = false):void
      {
         super.removeEventListener(type, listener, useCapture);
      }

      public function addListener(o:EventDispatcher, type:String, listener:Function, useCapture:Boolean = false, priority:int = 0, useWeakReference:Boolean = false):void {
         // the object as key for an array of its event types
         if (objDict[o] == null)  objArr = objDict[o] = [];
         for (var i:int = 0; i <  objArr.length; i++) {
            if ( objArr[i].type == type)
            trace ("_______object already has this listener not adding!")
            return
         }
         obj = { type:type, listener:listener }
         objArr.push(obj);
         o.addEventListener(type, listener, useCapture, priority, useWeakReference);
      }

      public function removeListener(o:EventDispatcher, type:String, listener:Function, useCapture:Boolean = false):void {
         // if the object has listeners (ie exists in dictionary)
         if (objDict[o] as Array !== null) {
            var tmpArr:Array = [];
            tmpArr = objDict[o] as Array;
            for (var i:int = 0; i < tmpArr.length; i++) {
               if (tmpArr[i].type == type) objArr.splice(i);
            }

            o.removeEventListener(type, listener, useCapture);
            if (tmpArr.length == 0) {
               delete objDict[o]
            }
         }else {
            trace("_______object has no listeners");
         }
      }

      /**
       * If object has listeners, returns an Array which can be accessed
       * as array[index].type,array[index].listeners
       * @param   o
       * @return Array
       */
      public function getListeners(o:EventDispatcher):Array{
         if (objDict[o] as Array !== null) {
            var tmpArr:Array = [];
            tmpArr = objDict[o] as Array;
            // forget trying to trace out the function name we use the function literal...
            for (var i:int = 0; i < tmpArr.length; i++) {
               trace("_______object " + o + " has event types: " + tmpArr[i].type +" with listener: " + tmpArr[i].listener);
            }
            return tmpArr

         }else {
            trace("_______object has no listeners");
            return null
         }

      }

      public function removeAllListeners(o:EventDispatcher, cap:Boolean = false):void {
         if (objDict[o] as Array !== null) {
            var tmpArr:Array = [];
            tmpArr = objDict[o] as Array;
            for (var i:int = 0; i < tmpArr.length; i++) {
               o.removeEventListener(tmpArr[i].type, tmpArr[i].listener, cap);
            }
            for (var p:int = 0; p < tmpArr.length; p++) {
               objArr.splice(p);
            }

            if (tmpArr.length == 0) {
               delete objDict[o]
            }
         }else {
            trace("_______object has no listeners");
         }
      }
   }
} 
```

            回答 #5

赞同：1

时间：2009-02-15T05:51:32.073

我喜欢做的是使用动态 Global 类并添加对内联侦听器函数的快速引用。这是假设您喜欢像我一样在 addEventListener 方法中使用监听器函数。这样，您可以在 addEventListener 中使用 removeEventListener :)

试试这个：

```
package {

import flash.display.Sprite;
import flash.events.Event;
import flash.text.TextField;

[SWF(width="750", height="400", backgroundColor="0xcdcdcd")]
public class TestProject extends Sprite
{   
    public function TestProject()
    {
        addEventListener(Event.ADDED_TO_STAGE, Global['addStageEvent'] = function():void {
            var i:uint = 0;
            //How about an eventlistener inside an eventListener?
            addEventListener(Event.ENTER_FRAME, Global['someEvent'] = function():void {
                //Let's make some text fields
                var t:TextField = new TextField();
                    t.text = String(i);
                    t.x = stage.stageWidth*Math.random();
                    t.y = stage.stageHeight*Math.random();
                addChild(t);
                i++;
                trace(i);
                //How many text fields to we want?
                if(i >= 50) {
                    //Time to stop making textFields
                    removeEventListener(Event.ENTER_FRAME, Global['someEvent']);
                    //make sure we don't have any event listeners
                    trace("hasEventListener(Event.ENTER_FRAME) = "+hasEventListener(Event.ENTER_FRAME));    
                }
            });

            //Get rid of the listener
            removeEventListener(Event.ADDED_TO_STAGE, Global['addStageEvent']);
            trace('hasEventListener(Event.ADDED_TO_STAGE) = '+hasEventListener(Event.ADDED_TO_STAGE));

        });
    }

} 
```

}

// 看这里！这是重要的位动态类 Global {}

秘诀是动态类 Global。有了它，您可以在运行时动态添加属性。

            回答 #6

赞同：0

时间：2010-09-28T06:58:27.100

```
private function callFunction(function:Function):void
{
     checkObject();
     obj.addEventListener(MouseEvent.CLICK,function);
}

private function checkObject():void
{
    if(obj.hasEventListener(MouseEvent.CLICK))
   {
      //here remove that objects
   }
} 
```

            回答 #7

赞同：0

时间：2011-08-18T05:47:40.963

K2xL EventManager 类
[http://k2xl.com/wordpress/2008/07/02/as3-eventmanager-class-removealllisteners/](http://k2xl.com/wordpress/2008/07/02/as3-eventmanager-class-removealllisteners/)

            回答 #8

赞同：0

时间：2010-10-04T00:48:11.023

以下内容并未解决删除未知事件侦听器的基本问题，但如果您需要禁用所有与鼠标相关的事件，包括未知事件，只需在事件目标上使用：mouseEnabled=false。

更多好东西在这里：
 [http ://www.thoughtprocessinteractive.com/blog/the-power-and-genius-of-mousechildren-and-mouseenabled](http://www.thoughtprocessinteractive.com/blog/the-power-and-genius-of-mousechildren-and-mouseenabled)

        c - 如何在 unix 控制台应用程序中捕获单个击键而不阻塞？

ID：184108

赞同：4

时间：2008-10-08T18:19:31.413

标签：c, unix, input, terminal

我有一个用 C 编写的非常简单的 TCP 服务器。它无限期地运行，等待连接。在 Windows 上，我`select`用来检查套接字上的活动，如果没有，我有以下代码允许我通过按键盘上的“q”退出：

```
if( kbhit() ) {
   char c = getch();
   if( c == 'q' ) break;
} 
```

这在 unix 上不起作用，因为`kbhit`不存在并且`getch`工作方式不同。我找到了一些用于更改终端设置并允许逐个字符输入的[示例代码。](http://www.linuxjournal.com/files/linuxjournal.com/linuxjournal/articles/011/1138/1138l2.html)`tcsetattr`调用 init 函数后，我打开 /dev/stdin （使用`O_NONBLOCK`）并读取一个字符，但`read( f, &c, 1 )`会阻塞直到命中一个字符。

我想我可以生成一个单独的线程并*让它*无限期地等待，然后如果用户点击“q”，则向第一个线程发出信号，但这似乎有点笨拙。肯定有更简单的方法吗？

            回答 #1

赞同：5

时间：2008-10-08T18:25:45.643

将标准输入添加到您的选择句柄列表中，如果它有数据，则调用 read 从中读取一个字符。

            回答 #2

赞同：1

时间：2008-10-08T19:02:57.533

相反，从您的

```
read( f, &c, 1 ) 
```

选择通话。当 f 准备好读取时，一个字符被按下，read() 不会阻塞。

            回答 #3

赞同：1

时间：2008-10-17T16:47:05.403

在 Unix 中，无论是在系统控制台还是在 X 终端窗口中，键盘 I/O 都通过虚拟终端。如今，设备 /dev/tty 是访问进程控制终端的常用方式。除了打开/关闭/读取/写入之外的设备操作都由该特定设备的 ioctl(2) 系统调用处理。你想要做的一般想法是

打开控制终端（可能是也可能不是标准输入）

更改该终端上的操作模式以返回而无需等待完整的输入行（这是正常默认值）

继续执行程序的其余部分，知道从该终端（可能是标准输入）读取可能会返回部分行甚至零个字符，而不会成为错误或终止条件。

[在C-programming faq](http://c-faq.com/osdep/cbreak.html)中可以找到有关如何执行第二步的详细答案。他们还指出这是一个操作系统问题，而不是语言问题。它们提供了九种可能性，但与这个问题相关的三个主要可能性是

1.  使用 curses(3) 库
2.  旧的 BSD 风格系统，使用 sgttyb 设置 CBREAK 或 RAW
3.  Posix 或旧 System V 风格的系统，使用 TCGETAW/TCSETAW 将 c_cc[VMIN] 设置为 1 并将 c_cc[VTIME] 设置为 0。

Following a couple of references in the C FAQ could lead to to [this page of kbhit code fragments](http://c-faq.com/osdep/kbhit.txt).

        encryption - 用户密码盐的最佳长度是多少？

ID：184112

赞同：134

时间：2008-10-08T18:20:25.297

标签：encryption, hash, salt

在对用户密码进行加盐和散列处理时，任何[加盐显然都会有所帮助。](http://en.wikipedia.org/wiki/Salt_%28cryptography%29)盐应该放多长时间有什么最佳做法吗？我会将盐存储在我的用户表中，因此我希望在存储大小和安全性之间进行最佳权衡。随机的 10 个字符的盐是否足够？还是我需要更长的时间？

            回答 #1

赞同：75

时间：2011-03-04T18:43:01.973

这些答案中的大多数都有点误导，并证明了盐和加密密钥之间的混淆。包含盐的目的是修改用于散列每个用户密码的函数，以便必须单独攻击每个存储的密码散列。唯一的安全要求是它们对每个用户都是唯一的，它们不可预测或难以猜测没有任何好处。

盐只需要足够长，以便每个用户的盐都是唯一的。即使有 10 亿注册用户，随机 64 位盐也不太可能重复，所以这应该没问题。单独重复的盐是一个相对较小的安全问题，它允许攻击者一次搜索两个帐户，但总的来说不会加快整个数据库的搜索速度。即使是 32 位的 salt 对于大多数用途来说也是可以接受的，在最坏的情况下，它会使攻击者的搜索速度提高约 58%。将盐增加到 64 位以上的成本并不高，但没有安全理由这样做。

在每个用户的 salt 之上使用站点范围的 salt 也有一些好处，这将防止可能与存储在其他站点的密码哈希发生冲突，并防止使用通用彩虹表，尽管即使是 32 位盐足以使彩虹表成为不切实际的攻击。

甚至更简单——开发人员总是忽略这一点——如果你有唯一的用户 ID 或登录名，它们就像盐一样完美。如果你这样做，你应该添加一个站点范围的盐，以确保你不会与另一个系统的用户重叠，他们有同样的好主意。

            回答 #2

赞同：36

时间：2008-10-08T18:33:35.253

目前[公认](http://en.wikipedia.org/wiki/Crypt_(Unix)#SHA-based_scheme)的密码散列标准为每个密码创建一个新的 16 个字符长的盐，并将盐与密码散列一起存储。

当然，应该采取适当的加密措施来创建真正随机的盐。

            回答 #3

赞同：25

时间：2009-09-08T18:49:17.777

编辑：我下面的答案回答了所问的问题，但“真正的”答案是：只需使用[bcrypt](https://en.wikipedia.org/wiki/Bcrypt)、[scrypt](https://en.wikipedia.org/wiki/Scrypt)或[Argon2](https://en.wikipedia.org/wiki/Argon2)。如果你问这样的问题，几乎可以肯定你使用的工具级别太低了。

老实说，没有理由不让盐与散列密码的长度完全相同。如果您使用的是 SHA-256，那么您有一个 256 位哈希。没有理由不使用 256 位盐。

从数学上讲，超过 256 位不会为您带来任何安全性改进。但是使用较短的盐可能总是会出现彩虹表赶上您的盐长度的情况 - 特别是使用较短的盐。

            回答 #4

赞同：8

时间：2012-03-12T14:39:44.323

[维基百科](http://en.wikipedia.org/wiki/Rainbow_tables#Defense_against_rainbow_tables)：

在 Linux、BSD Unix 和 Solaris 中使用的 SHA2-crypt 和 bcrypt 方法具有 128 位的盐。在可预见的未来，这些较大的盐值使得几乎任何长度的密码的预计算攻击都无法针对这些系统进行。

128 位（16 字节）盐就足够了。您可以将其表示为`128 / 4 = 32`十六进制数字序列。

            回答 #5

赞同：2

时间：2015-01-13T16:52:42.690

一个答案可能是使用您将要使用的哈希值在安全性方面提供的值作为盐的大小。

例如，如果您要使用 SHA-512，请使用 256 位盐，因为 SHA-512 提供的安全性是 256 位。

        asp.net - Databind 如何使用 DataReader

ID：184125

赞同：1

时间：2008-10-08T18:22:31.237

标签：asp.net, data-binding

如果我在将其数据源设置为 DataReader 的页面上有一个控件，该控件是否会在设置数据源时使用读取器，或者数据读取器是否会继续存在，直到 Databind 被执行？

执行 Databind 时，幕后究竟发生了什么？

            回答 #1

赞同：1

时间：2008-10-08T18:30:23.763

它应该在执行 DataBind 时使用。

            回答 #2

赞同：1

时间：2008-10-08T18:32:18.203

根据控件，DataBind() 将数据绑定到控件。它通过遍历 DataSource 并创建所需的 Html 和其他控件来做到这一点。

对于 DropDownList，DataBind() 将为 DataSet 中的每个记录或 ArrayList 中的每个元素创建 ListItem。

稍后在 DropDownList 上调用 Render 方法，该方法返回 Select 标记的 Html。它还通过在 Select 标记内返回 Option 标记为每个 ListItem 创建 Html。

对于标签，DataBind() 会将 Text 设置为您从数据库中提取的值（例如）。

如果不为特定控件调用 DataBind()，还可以确保为控件设置了 DataSource，然后调用 Page.DataBind()。这将遍历页面中的控件并调用每个控件的所有 DataBinds。

            回答 #3

赞同：0

时间：2008-10-08T18:55:25.367

数据绑定期间数据读取器的控件在做什么？它是否将其复制到其内部结构中并处理数据读取器然后渲染？

如果我在一个页面上有 10 个控件并将每个控件上的数据源设置为不同的数据读取器，然后称为 page.databind，数据读取器是否会一直存在（从创建点到 page.databind 完成处理） ?

        windows - Windows下的“Unix shell”类似脚本

ID：184132

赞同：1

时间：2008-10-08T18:23:26.600

标签：windows, unix, shell, scripting

我需要一些 shell 脚本专家的帮助。

我有一个 .txt 文件（日志），它在多行上跟踪客户端的 IP 地址，其格式与此类似：

```
Line1 - Client IP [192.168.0.1] Other data
Line2 - Client IP [192.168.0.2] Other data
Line3 - Client IP [192.168.0.3] Other data
Line4 - Client IP [192.168.0.2] Other data
Line5 - Client IP [192.168.0.1] Other data
... 
```

我需要创建脚本：

*   从此文件中提取 IP 地址
*   将 IP 地址分组（相同的 IP 地址只报告一次）
*   输出带有结果 IP 地址的文件

对于前面的示例，生成的文件将是：

```
192.168.0.1
192.168.0.2
192.168.0.3 
```

我在 Windows 操作系统上，但我可以使用[Cygwin](http://www.cygwin.com/)或[Unix Tools](http://unxutils.sourceforge.net/)之类的工具（在 Windows 下提供类似 Unix 的命令，如 grep、sort 等）。

没有脚本的解决方案也可能很好。

在此先感谢您的帮助。

            回答 #1

赞同：6

时间：2008-10-08T18:49:52.477

在 PowerShell 中：

详细的方式 -

```
$regex = '(?<IPAddress>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})'
get-content log.txt | where-object {if ($_ -match $regex){$matches.ipaddress}} | group-object -noelement 
```

较短的版本

```
gc log.txt | % {if ($_ -match $regex){$matches.ipaddress}} | group -n 
```

            回答 #2

赞同：4

时间：2008-10-08T18:28:21.100

这是一个简短的 sed 脚本，它提取方括号之间的部分，然后`sort -u`删除重复项：

```
sed -e 's/^.*\[\(.*\)\].*$/\1/g' < inputfile | sort -u 
```

            回答 #3

赞同：2

时间：2008-10-08T18:26:18.653

```
 cat yourfile.txt | sed 's/*\[//g' | sed 's/\]*//g' | sort | uniq > newfile.txt 
```

括号可能不需要转义符。我不记得了。这些工具*都应该*在 Cygwin 上可用。

            回答 #4

赞同：1

时间：2008-10-08T18:50:50.680

为了简洁，很难击败那些 sed 脚本。好吧，可读性是个问题...

您可以使用 Scripting.FileSystemObject 进行文件访问，使用 VBScript 的正则表达式和 Dictionary 对象，在 VBScript 中做一个更详细，也许更易读的版本，如下所示。

```
Option Explicit

Dim oFSO
Dim oRgx
Dim oMatch
Dim oMatches
Dim oStream
Dim sLine
Dim oDict
Dim sIP
Dim aKeys
Dim sKey

Set oFSO     = CreateObject( "Scripting.FileSystemObject" )
Set oDict    = CreateObject( "Scripting.Dictionary" )

Set oStream  = oFSO.OpenTextFile( "log.txt", 1, False )

Set oRgx     = new regexp
oRgx.Pattern = "\[(.+?)\]"
oRgx.Global  = True

Do While Not oStream.AtEndOfStream
  sLine        = oStream.ReadLine
  Set oMatches = oRgx.Execute(sLine)

  For Each omatch in omatches
    sIP         = oMatch.SubMatches(0)

    If Not oDict.Exists( sIP ) Then
      oDict.Add sIp,1
    End If

  Next

Loop

aKeys = oDict.Keys

For Each sKey in aKeys
  wscript.echo sKey
Next 
```

            回答 #5

赞同：0

时间：2008-12-18T18:58:35.973

如果您可以使用 Cygwin，则无需担心 Windows 脚本解决方案。

        java - CountDownLatch 与信号量

ID：184147

赞同：106

时间：2008-10-08T18:25:21.167

标签：java, multithreading, concurrency, semaphore, countdownlatch

使用有什么好处吗

[**java.util.concurrent.CountdownLatch**](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CountDownLatch.html) 

代替

[**java.util.concurrent.Semaphore**](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Semaphore.html) ?

据我所知，以下片段几乎是等价的：

**1.信号量**

```
final Semaphore sem = new Semaphore(0);
for (int i = 0; i < num_threads; ++ i)
{
  Thread t = new Thread() {
    public void run()
    {
      try
      {
        doStuff();
      }
      finally
      {
        sem.release();
      }
    }
  };
  t.start();
}

sem.acquire(num_threads); 
```

**2：倒计时锁存器**

```
final CountDownLatch latch = new CountDownLatch(num_threads);
for (int i = 0; i < num_threads; ++ i)
{
  Thread t = new Thread() {
    public void run()
    {
      try
      {
        doStuff();
      }
      finally
      {
        latch.countDown();
      }
    }
  };
  t.start();
}

latch.await(); 
```

除了在 #2 的情况下，闩锁不能被重用，更重要的是，您需要提前知道将创建多少线程（或者等到它们都启动后再创建闩锁。）

那么在什么情况下闩锁可能更可取呢？

            回答 #1

赞同：118

时间：2008-10-08T19:53:50.693

`CountDownLatch`经常用于与您的示例完全相反的情况。`await()`通常，当countown 达到零时，您会同时启动许多线程阻塞。

```
final CountDownLatch countdown = new CountDownLatch(1);

for (int i = 0; i < 10; ++ i) {
   Thread racecar = new Thread() {    
      public void run() {
         countdown.await(); //all threads waiting
         System.out.println("Vroom!");
      }
   };
   racecar.start();
}
System.out.println("Go");
countdown.countDown();   //all threads start now! 
```

您还可以将其用作 MPI 样式的“屏障”，它会导致所有线程等待其他线程赶上某个点，然后再继续。

```
final CountDownLatch countdown = new CountDownLatch(num_thread);

for (int i = 0; i < num_thread; ++ i) {
   Thread t= new Thread() {    
      public void run() {
         doSomething();
         countdown.countDown();
         System.out.printf("Waiting on %d other threads.",countdown.getCount());
         countdown.await();     //waits until everyone reaches this point
         finish();
      }
   };
   t.start();
} 
```

总而言之，`CountDownLatch`可以按照您在示例中显示的方式安全地使用。

            回答 #2

赞同：72

时间：2008-10-08T20:42:58.440

[CountDownLatch](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CountDownLatch.html)用于启动一系列线程，然后等待它们全部完成（或直到它们调用`countDown()`给定次数。

信号量用于控制正在使用资源的并发线程的数量。该资源可以是文件之类的东西，也可以是通过限制执行的线程数量的 cpu。`acquire()`信号量的计数可以随着不同线程的调用而上升和下降`release()`。

在您的示例中，您实际上是在使用信号量作为一种 Count *UP* Latch。鉴于您的意图是等待所有线程完成，使用`CountdownLatch`会使您的意图更清晰。

            回答 #3

赞同：31

时间：2015-11-10T07:12:55.063

*简短的摘要：*

1.  [`Semaphore`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Semaphore.html)并[`CountDownLatch`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CountDownLatch.html)服务于不同的目的。

2.  用于`Semaphore`控制线程对资源的访问。

3.  用于`CountDownLatch`等待所有线程完成

`Semaphore`来自 Javadocs 的定义：

A`Semaphore`维护一组许可证。`acquire()`如有必要，每个人都会阻止，直到获得*许可*，然后再接受。每个都`release()`添加一个许可证，可能会释放一个阻塞的收购方。

但是，没有使用实际的许可对象；只是对`Semaphore`可用数量进行计数并采取相应措施。
*它是如何工作的？*
信号量用于控制使用资源的并发线程的数量。该资源可以是共享数据、代码块（**临界区**）或任何文件。
a 的计数可以随着不同的线程调用和`Semaphore`而上下波动。但是在任何时候，您都不能拥有比信号量更多的线程数。`acquire()``release()`
*`Semaphore`用例：*

1.  限制对磁盘的并发访问（由于竞争磁盘寻道导致性能下降）
2.  线程创建限制
3.  JDBC 连接池/限制
4.  网络连接限制
5.  限制 CPU 或内存密集型任务

查看这篇[文章](http://www.javacodegeeks.com/2011/09/java-concurrency-tutorial-semaphores.html)以了解信号量的使用。
`CountDownLatch`来自 Javadocs 的定义：

一种同步辅助，允许一个或多个线程等待，直到在其他线程中执行的一组操作完成。

*它是如何工作的？*
`CountDownLatch`通过使用线程数初始化计数器来工作，每次线程完成其执行时该计数器都会递减。当计数为零时，意味着所有线程都已完成执行，等待锁存器的线程恢复执行。
*`CountDownLatch`用例：*

1.  实现最大并行度：有时我们希望同时启动多个线程以实现最大并行度
2.  在开始执行之前等待 N 个线程完成
3.  死锁检测。

看看这篇[文章](http://howtodoinjava.com/2013/07/18/when-to-use-countdownlatch-java-concurrency-example-tutorial/)可以清楚地理解`CountDownLatch`概念。
也可以在[本文中](http://tutorials.jenkov.com/java-util-concurrent/java-fork-and-join-forkjoinpool.html)查看[Fork Join Pool](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ForkJoinPool.html)。它与.`CountDownLatch`

            回答 #4

赞同：6

时间：2013-08-01T22:16:36.537

假设你走进高尔夫专卖店，希望找到一个四人组，

当您排队从专业店服务员那里获得开球时间时，基本上是您打电话`proshopVendorSemaphore.acquire()`，一旦您获得开球时间，您就打电话给`proshopVendorSemaphore.release()`。注意：任何免费服务员都可以为您服务，即共享资源。

现在你走到起动器，他开始一个`CountDownLatch(4)`并打电话`await()`等待其他人，对于你来说，你称之为签到即`CountDownLatch`。`countDown()`其余的四人组也是如此。当所有人都到达时，启动器继续前进（`await()`调用返回）

现在，在你们每个人休息九个洞之后，假设让先发球员再次参与，他使用“新”`CountDownLatch(4)`开球从第 10 洞开球，与第 1 洞相同的等待/同步。

但是，如果启动器使用 a`CyclicBarrier`开始，他可以在第 10 洞重置相同的实例，而不是使用 & throw 的第二个闩锁。

            回答 #5

赞同：2

时间：2008-10-08T19:31:35.450

查看免费提供的源代码，这两个类的实现没有什么神奇之处，因此它们的性能应该大致相同。选择一个让你的意图更明显的。

            回答 #6

赞同：0

时间：2008-10-08T19:25:10.157

`CountdownLatch`使线程等待该`await()`方法，直到计数达到零。因此，也许您希望所有线程等到 3 次调用某事，然后所有线程都可以运行。A`Latch`一般不能复位。

A`Semaphore`允许线程检索许可，这可以防止太多线程同时执行，如果无法获得继续执行所需的许可，则阻塞。可以将许可返回给`Semaphore`允许其他等待线程继续进行。

            回答 #7

赞同：0

时间：2021-08-16T11:21:36.160

信号量通过使用计数器来控制对共享资源的访问。如果计数器大于零，则允许访问。如果为零，则拒绝访问。计数器正在计算允许访问共享资源的许可。因此，要访问资源，线程必须从信号量中获得许可。
CountDownlatch 使线程等待一个或多个事件发生。countDownLatch 最初是使用在释放锁存器之前发生的事件数的计数创建的。每次发生事件时，计数都会递减。

        linden-scripting-language - 第二人生中有用的开发人员资源

ID：184153

赞同：6

时间：2008-10-08T18:25:55.567

标签：linden-scripting-language

Second Life 玩起来很有趣，一些开发人员正在那里创建内容，但我想知道 Second Life 中有哪些有用的资源（如果有的话）可供专业软件开发人员使用。

*   讨论组
*   教育/培训
*   供应商支持
*   与开发相关的演示或演示
*   专业联系人

澄清一下：我并不是真的在寻找有关开发用于第二人生的东西的信息（尽管这些答案是受欢迎的）。我正在寻找指向 SL 中的东西的指针，程序员会发现它们对他们的实际工作很有用。

            回答 #1

赞同：2

时间：2008-10-08T18:32:09.937

他们有一个关于其中一些用途的网站： http: [//secondlifegrid.net/programs/api/](http://secondlifegrid.net/programs/api/)
和一些关于他们发展的语言的页面：[http ://wiki.secondlife.com/wiki/LSL_Portal](http://wiki.secondlife.com/wiki/LSL_Portal)

            回答 #2

赞同：2

时间：2008-10-08T18:57:04.100

我隐约记得 Dobbs 博士正在 SL 中运行某种正在进行的“程序员岛”，但我现在找不到参考资料。

显然是软件开发人员的某种“虚拟会议”。

            回答 #3

赞同：2

时间：2008-10-08T19:03:04.057

和你一样，我发现玩 SL 对娱乐编码来说非常有趣。让我觉得其中有一些经验是尝试在沙箱（SL 中的一般建筑区域）中编写一个工作时钟。其他化身会走过并提出建议，因为周围有相当多的编码人员很快就变成了有趣的协作努力。如果 RL 就这么简单就好了。有些东西在 SL 中工作得非常好——我曾经使用一群“鸟”作为对象实现了一个集群算法（这给了 oops 一个全新的视角）。

至于资源 - 假设您超出了基本的编码水平，那么您应该能够从 LSL Wiki - [http://wiki.secondlife.com/wiki/LSL_Portal](http://wiki.secondlife.com/wiki/LSL_Portal)中找出大部分内容。

有一本电子书 - Jeff Heaton 的“第二人生的脚本食谱”，它以合理的布局方式涵盖了基础知识。它只有几美元，但只有在您没有在其他地方进行大量编码时才值得。世界上也有常规课程，但我相信其中大部分都处于非常基础的水平。

对于团体，我一直发现*第二*人生脚本组对很多人都非常有帮助。有一个叫做简单的*脚本*，它也很活跃。

警告几句，LSL，虽然图灵完备在几个方面非常糟糕，缺乏现代程序结构（以及一些较旧的 - 像数组！），并且 LSL 的大部分“黑魔法”都知道如何工作围绕限制，随着 Mono 的出现，尽管这可能是一个减少的问题。  

此外，Lindens 似乎确实有一个假设，即如果您想做任何“繁重的”代码，您将在服务器外的服务器上执行它，并调用和返回结果到/从 SL。尽管 HTTP 工作正常（并且通常比预期的要好），但 XMP-RPC 实现被严重破坏并没有帮助。

            回答 #4

赞同：1

时间：2009-03-22T20:30:44.153

IBM、Microsoft 和 Sun 在 Second Life 中非常活跃，有时可以看到有趣的演示/演示。其中一些非常适合与那些从事您感兴趣的产品的公司的人建立联系和结识。

除了 LSL 之外，还有 Java、PHP 和其他几种编程语言的几个组，但是 IMO 没有其他非 SL 资源那么好的资源。您可以在 StackOverflow 或 IRC 上更快地回答您的问题。

IBM 举办了几场有趣的编程比赛——IBM 有机器人在迷宫中寻找出路的东西，还有机器人大战和其他一些 SL 的编程比赛，但它们都是面向 LSL 的。

我想我曾经看过一个初级 PHP 课程，所以如果您有兴趣从头开始学习编程语言，请尝试搜索事件，您可能会找到一些东西；但是，根据我的经验，这些很少见。

            回答 #5

赞同：1

时间：2008-10-08T19:02:27.113

就我而言，我正在尝试为[OpenSim](http://opensimulator.org)项目做出贡献，该项目是 SecondLife 服务器基础架构的开源克隆，用 C# 和 Mono 编写。

OpenSim 与 SL 类似，增强了许多额外的脚本命令、开放网格协议、自定义模块和插件。如果您还没有听说过它，那绝对值得一看。

            回答 #6

赞同：1

时间：2008-10-08T19:46:21.957

ControlBreak 在评论中建议了这一点（我将其推广为答案）：

您可以访问微软岛。定期展示新产品 - [http://www.kzero.co.uk/blog/?p=663#more-663](http://www.kzero.co.uk/blog/?p=663#more-663)

            回答 #7

赞同：0

时间：2009-12-26T06:20:21.423

[Look & Feel 团队](http://swedenisland.se)脚本，这是我的。常见的 3D 问题是混淆了摄像机或演员之间的摄像机中心。设计师可能认为相机中心是世界，而它应该是演员。

        linux - 在 Linux 中使用“top”作为半永久性工具

ID：184162

赞同：2

时间：2008-10-08T18:27:47.090

标签：linux, monitor, instrumentation

我试图找到在开发运行嵌入式 Linux 的机器时使用“top”作为半永久性工具的最佳方法。（仪器将从最终测试和生产版本中删除。）

我的第一遍是简单地将其添加到 init.d：

```
top -b -d 15 >/tmp/toploop.out & 
```

这每 15 秒以“批处理”模式运行一次。假设 /tmp 有足够的空间……</p>

问题：

1.  15 秒是通用监控的好选择吗？
2.  除了磁盘空间，这对系统状态的干扰有多严重？
3.  像这样可以使用哪些其他（也许更好的）工具？

            回答 #1

赞同：5

时间：2008-10-08T18:54:02.983

看看[collectd](http://collectd.org/)。这是一个为性能而编码的非常轻量级的系统监控框架。

            回答 #2

赞同：2

时间：2008-10-08T18:42:51.913

我们使用[sysstat](http://pagesperso-orange.fr/sebastien.godard/documentation.html)来监控这样的事情。  

            回答 #3

赞同：1

时间：2008-10-08T20:58:08.537

可惜你没有说你在监视什么。

1.  您应该决定 15 秒是否可以。如果您愿意，可以随意降低它（并拥有一个快速的硬盘）
2.  除非您运行的是软实时系统，否则无需担心
3.  查看其他答案中建议的工具。我将添加另一个建议：“iotop”，用于回答“谁在敲打 HDD”的问题。

            回答 #4

赞同：1

时间：2008-10-08T18:32:17.410

您可能会发现带有延迟且没有重复计数器的 vmstat 和 iostat 是更好的选择。

            回答 #5

赞同：1

时间：2008-10-08T18:33:29.093

我怀疑 15 秒会绰绰有余，除非你真的想实时观看正在发生的事情，但这里似乎并非如此。

就负载而言，在运行 Ubuntu 的空闲 PIII 900Mhz w/768MB RAM（不确定哪个版本，但不超过一年）上，我每 0.5 秒进行一次最高更新，CPU 利用率约为 2%。在 15 秒更新时，我看到 CPU 利用率为 0.1%。

根据您的具体需求，您可以使用 uptime、free 和 ps 的输出来获取 top 的大部分信息（如果不是全部的话）。

            回答 #6

赞同：1

时间：2008-10-08T19:32:32.437

如果您正在寻找整体负载，正常运行时间可能就足够了。但是，如果您想了解有关进程的特定信息、喜欢冒险并且启用了 /proc 文件系统，则可能需要编写自己的工具。这种环境的主要好处是您可以准确地专注于您想要的内容，并将引入系统的负载降至最低。

proc 文件系统为您的应用程序提供对跟踪许多有趣变量的内核内存的读取访问权限。从 /proc 读取是获取此信息的最简单的方法之一。此外，您可能会获得比 top 提供的更多信息。我过去这样做是为了获得此过程在用户和系统上花费的时间。此外，您可以使用它来获取有关进程打开的文件描述符数量的信息。您也可以使用它来获取有关网络系统如何工作的详细信息。

这些信息中的大部分都由其他应用程序进行了预处理，如果您获得所需的信息，可以使用这些应用程序。但是，阅读原始信息相当简单。做一个`man proc`以获取更多信息。

            回答 #7

赞同：1

时间：2008-10-09T02:11:03.520

在压力测试期间的系统监控工作中，我们使用了一个名为[nmon](http://www.ibm.com/developerworks/aix/library/au-analyze_aix/)的工具。

我喜欢 nmon 的地方在于它能够导出到 XLS 并为您生成漂亮的图表。

它生成以下统计信息：

*   内存使用情况
*   CPU使用率
*   网络使用
*   磁盘 I/O

祝你好运 ：）

        open-source - 您使用什么“公式”来评估开源社区？

ID：184171

赞同：2

时间：2008-10-08T18:29:53.357

标签：open-source

我对开源的一个问题通常不是产品或文档，而是社区参与和支持的水平。官方论坛上的一些问题的回复时间可能会超过一周，老实说，这在选择商业服务使用平台时会有很大的不同。但是，我发现事先评估社区非常困难。我如何知道最常见的问题是什么，以及人们是否得到了支持？根据我的项目，我如何知道我个人可能会遇到哪些需要一定程度的社区支持的问题？您有执行此评估的公式吗？

            回答 #1

赞同：3

时间：2008-10-08T18:41:31.447

我通常发现，依靠社区支持来完成任何关键任务都是自找麻烦。所以我通常远离开源，除非我有信心我们可以在内部支持它或者有可用的商业支持服务。

            回答 #2

赞同：1

时间：2008-10-08T18:34:27.903

如果您的问题是因为您不想支付支持费用而提出的，那么我认为您最好的选择是在这样的中立论坛上询问有关特定项目的问题，看看其他人在支持和及时解决问题方面的经验问题。

如果您愿意为支持付费，有些公司会为开源项目提供商业支持，例如[OpenLogic](http://www.openlogic.com)，可以将其纳入您的公式。

            回答 #3

赞同：0

时间：2008-10-08T18:52:34.793

评估社区的唯一真正方法是尝试它，参与社区。大多数社区将以一种或另一种方式拥有良好的支持网络。此外，许多人也开始为各种框架提供支持服务，为那些寻找更专用资源来解决问题的人提供支持。

但我发现最好的方法是进入那里，问几个问题，四处寻找资源，真正看看那里有什么。

        ruby - Ruby：如何通过 HTTP 将文件作为 multipart/form-data 发布？

ID：184178

赞同：122

时间：2008-10-08T18:31:41.263

标签：ruby, http, post

我想做一个看起来像从浏览器发布的 HMTL 表单的 HTTP POST。具体来说，发布一些文本字段和一个文件字段。

发布文本字段很简单，net/http rdocs 中有一个示例，但我不知道如何发布文件。

Net::HTTP 看起来不是最好的主意。[路边](http://curb.rubyforge.org/)看起来不错。

            回答 #1

赞同：104

时间：2008-11-25T04:03:44.023

我喜欢[RestClient](https://github.com/rest-client/rest-client)。它用多部分表单数据等很酷的特性封装了 net/http：

```
require 'rest_client'
RestClient.post('http://localhost:3000/foo', 
  :name_of_file_param => File.new('/path/to/file')) 
```

它还支持流式传输。

`gem install rest-client`会让你开始。

            回答 #2

赞同：40

时间：2010-04-08T22:12:44.653

关于 Nick Sieger 的 multipart-post 库，我不能说太多好话。

它增加了对直接向 Net::HTTP 的多部分发布的支持，您无需手动担心边界或大型库的目标可能与您自己的目标不同。

下面是一个关于如何从[README](http://github.com/nicksieger/multipart-post/blob/master/README.txt)中使用它的小例子：

```
require 'net/http/post/multipart'

url = URI.parse('http://www.example.com/upload')
File.open("./image.jpg") do |jpg|
  req = Net::HTTP::Post::Multipart.new url.path,
    "file" => UploadIO.new(jpg, "image/jpeg", "image.jpg")
  res = Net::HTTP.start(url.host, url.port) do |http|
    http.request(req)
  end
end 
```

你可以在这里查看图书馆：http:
 [//github.com/nicksieger/multipart-post](http://github.com/nicksieger/multipart-post)

或安装它：

```
$ sudo gem install multipart-post 
```

如果您通过 SSL 连接，则需要像这样启动连接：

```
n = Net::HTTP.new(url.host, url.port) 
n.use_ssl = true
# for debugging dev server
#n.verify_mode = OpenSSL::SSL::VERIFY_NONE
res = n.start do |http| 
```

            回答 #3

赞同：36

时间：2017-10-10T14:29:55.020

另一个只使用标准库：

```
uri = URI('https://some.end.point/some/path')
request = Net::HTTP::Post.new(uri)
request['Authorization'] = 'If you need some headers'
form_data = [['photos', photo.tempfile]] # or File.open() in case of local file

request.set_form form_data, 'multipart/form-data'
response = Net::HTTP.start(uri.hostname, uri.port, use_ssl: true) do |http| # pay attention to use_ssl if you need it
  http.request(request)
end 
```

尝试了很多方法，但只有这对我有用。

            回答 #4

赞同：31

时间：2008-10-17T18:24:15.677

`curb`看起来是一个很好的解决方案，但如果它不能满足您的需求，您*可以*使用`Net::HTTP`. 多部分表单帖子只是一个经过仔细格式化的字符串，带有一些额外的标题。似乎每个需要编写多部分文章的 Ruby 程序员最终都会为它编写自己的小库，这让我想知道为什么这个功能不是内置的。也许是......无论如何，为了您的阅读乐趣，我会继续在这里给出我的解决方案。此代码基于我在几个博客上找到的示例，但我很遗憾再也找不到链接。所以我想我只需要为自己承担所有的功劳......

我为此编写的模块包含一个公共类，用于从`String`和`File`对象的哈希中生成表单数据和标题。例如，如果您想发布一个带有名为“title”的字符串参数和一个名为“document”的文件参数的表单，您将执行以下操作：

```
#prepare the query
data, headers = Multipart::Post.prepare_query("title" => my_string, "document" => my_file) 
```

然后你只需做一个正常`POST`的`Net::HTTP`：

```
http = Net::HTTP.new(upload_uri.host, upload_uri.port)
res = http.start {|con| con.post(upload_uri.path, data, headers) } 
```

或者你想做的其他事情`POST`。关键是`Multipart`返回您需要发送的数据和标头。就是这样！很简单，对吧？这是 Multipart 模块的代码（您需要`mime-types`gem）：

```
# Takes a hash of string and file parameters and returns a string of text
# formatted to be sent as a multipart form post.
#
# Author:: Cody Brimhall <mailto:brimhall@somuchwit.com>
# Created:: 22 Feb 2008
# License:: Distributed under the terms of the WTFPL (http://www.wtfpl.net/txt/copying/)

require 'rubygems'
require 'mime/types'
require 'cgi'

module Multipart
  VERSION = "1.0.0"

  # Formats a given hash as a multipart form post
  # If a hash value responds to :string or :read messages, then it is
  # interpreted as a file and processed accordingly; otherwise, it is assumed
  # to be a string
  class Post
    # We have to pretend we're a web browser...
    USERAGENT = "Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en-us) AppleWebKit/523.10.6 (KHTML, like Gecko) Version/3.0.4 Safari/523.10.6"
    BOUNDARY = "0123456789ABLEWASIEREISAWELBA9876543210"
    CONTENT_TYPE = "multipart/form-data; boundary=#{ BOUNDARY }"
    HEADER = { "Content-Type" => CONTENT_TYPE, "User-Agent" => USERAGENT }

    def self.prepare_query(params)
      fp = []

      params.each do |k, v|
        # Are we trying to make a file parameter?
        if v.respond_to?(:path) and v.respond_to?(:read) then
          fp.push(FileParam.new(k, v.path, v.read))
        # We must be trying to make a regular parameter
        else
          fp.push(StringParam.new(k, v))
        end
      end

      # Assemble the request body using the special multipart format
      query = fp.collect {|p| "--" + BOUNDARY + "\r\n" + p.to_multipart }.join("") + "--" + BOUNDARY + "--"
      return query, HEADER
    end
  end

  private

  # Formats a basic string key/value pair for inclusion with a multipart post
  class StringParam
    attr_accessor :k, :v

    def initialize(k, v)
      @k = k
      @v = v
    end

    def to_multipart
      return "Content-Disposition: form-data; name=\"#{CGI::escape(k)}\"\r\n\r\n#{v}\r\n"
    end
  end

  # Formats the contents of a file or string for inclusion with a multipart
  # form post
  class FileParam
    attr_accessor :k, :filename, :content

    def initialize(k, filename, content)
      @k = k
      @filename = filename
      @content = content
    end

    def to_multipart
      # If we can tell the possible mime-type from the filename, use the
      # first in the list; otherwise, use "application/octet-stream"
      mime_type = MIME::Types.type_for(filename)[0] || MIME::Types["application/octet-stream"][0]
      return "Content-Disposition: form-data; name=\"#{CGI::escape(k)}\"; filename=\"#{ filename }\"\r\n" +
             "Content-Type: #{ mime_type.simplified }\r\n\r\n#{ content }\r\n"
    end
  end
end 
```

            回答 #5

赞同：19

时间：2008-12-26T13:09:31.207

这是我在尝试了这篇文章中可用的其他解决方案后的解决方案，我正在使用它在 TwitPic 上上传照片：

```
 def upload(photo)
    `curl -F media=@#{photo.path} -F username=#{@username} -F password=#{@password} -F message='#{photo.title}' http://twitpic.com/api/uploadAndPost`
  end 
```

            回答 #6

赞同：10

时间：2017-08-31T08:00:31.037

快进到 2017 年，`ruby` `stdlib` `net/http`自 1.9.3 起内置此功能

Net::HTTPRequest#set_form)：添加以支持 application/x-www-form-urlencoded 和 multipart/form-data。

[https://ruby-doc.org/stdlib-2.3.1/libdoc/net/http/rdoc/Net/HTTPHeader.html#method-i-set_form](https://ruby-doc.org/stdlib-2.3.1/libdoc/net/http/rdoc/Net/HTTPHeader.html#method-i-set_form)

我们甚至可以使用`IO`which 不支持`:size`流式传输表单数据。

希望这个答案真的可以帮助某人:)

PS 我只在 ruby​​ 2.3.1 中测试过这个

            回答 #7

赞同：7

时间：2008-10-08T18:55:22.433

好的，这是一个使用遏制的简单示例。

```
require 'yaml'
require 'curb'

# prepare post data
post_data = fields_hash.map { |k, v| Curl::PostField.content(k, v.to_s) }
post_data << Curl::PostField.file('file', '/path/to/file'), 

# post
c = Curl::Easy.new('http://localhost:3000/foo')
c.multipart_form_post = true
c.http_post(post_data)

# print response
y [c.response_code, c.body_str] 
```

            回答 #8

赞同：3

时间：2010-01-14T23:05:43.527

            回答 #9

赞同：1

时间：2008-12-25T15:46:14.027

NetHttp 的解决方案有一个缺点，即在发布大文件时，它首先将整个文件加载到内存中。

在玩了一下之后，我想出了以下解决方案：

```
class Multipart

  def initialize( file_names )
    @file_names = file_names
  end

  def post( to_url )
    boundary = '----RubyMultipartClient' + rand(1000000).to_s + 'ZZZZZ'

    parts = []
    streams = []
    @file_names.each do |param_name, filepath|
      pos = filepath.rindex('/')
      filename = filepath[pos + 1, filepath.length - pos]
      parts << StringPart.new ( "--" + boundary + "\r\n" +
      "Content-Disposition: form-data; name=\"" + param_name.to_s + "\"; filename=\"" + filename + "\"\r\n" +
      "Content-Type: video/x-msvideo\r\n\r\n")
      stream = File.open(filepath, "rb")
      streams << stream
      parts << StreamPart.new (stream, File.size(filepath))
    end
    parts << StringPart.new ( "\r\n--" + boundary + "--\r\n" )

    post_stream = MultipartStream.new( parts )

    url = URI.parse( to_url )
    req = Net::HTTP::Post.new(url.path)
    req.content_length = post_stream.size
    req.content_type = 'multipart/form-data; boundary=' + boundary
    req.body_stream = post_stream
    res = Net::HTTP.new(url.host, url.port).start {|http| http.request(req) }

    streams.each do |stream|
      stream.close();
    end

    res
  end

end

class StreamPart
  def initialize( stream, size )
    @stream, @size = stream, size
  end

  def size
    @size
  end

  def read ( offset, how_much )
    @stream.read ( how_much )
  end
end

class StringPart
  def initialize ( str )
    @str = str
  end

  def size
    @str.length
  end

  def read ( offset, how_much )
    @str[offset, how_much]
  end
end

class MultipartStream
  def initialize( parts )
    @parts = parts
    @part_no = 0;
    @part_offset = 0;
  end

  def size
    total = 0
    @parts.each do |part|
      total += part.size
    end
    total
  end

  def read ( how_much )

    if @part_no >= @parts.size
      return nil;
    end

    how_much_current_part = @parts[@part_no].size - @part_offset

    how_much_current_part = if how_much_current_part > how_much
      how_much
    else
      how_much_current_part
    end

    how_much_next_part = how_much - how_much_current_part

    current_part = @parts[@part_no].read(@part_offset, how_much_current_part )

    if how_much_next_part > 0
      @part_no += 1
      @part_offset = 0
      next_part = read ( how_much_next_part  )
      current_part + if next_part
        next_part
      else
        ''
      end
    else
      @part_offset += how_much_current_part
      current_part
    end
  end
end 
```

            回答 #10

赞同：1

时间：2009-04-23T12:26:21.927

还有 nick sieger 的[multipart-post](http://github.com/nicksieger/multipart-post)添加到可能的解决方案的长列表中。

            回答 #11

赞同：0

时间：2009-02-05T19:01:03.767

我有同样的问题（需要发布到 jboss 网络服务器）。Curb 对我来说很好，除了当我在代码中使用会话变量时它导致 ruby​​ 崩溃（ubuntu 8.10 上的 ruby​​ 1.8.7）。

我深入研究了其余客户端文档，找不到多部分支持的迹象。我尝试了上面的 rest-client 示例，但 jboss 说 http 帖子不是多部分的。

            回答 #12

赞同：0

时间：2016-12-16T03:41:04.063

multipart-post gem 与 Rails 4 Net::HTTP 配合得很好，没有其他特殊的 gem

```
def model_params
  require_params = params.require(:model).permit(:param_one, :param_two, :param_three, :avatar)
  require_params[:avatar] = model_params[:avatar].present? ? UploadIO.new(model_params[:avatar].tempfile, model_params[:avatar].content_type, model_params[:avatar].original_filename) : nil
  require_params
end

require 'net/http/post/multipart'

url = URI.parse('http://www.example.com/upload')
Net::HTTP.start(url.host, url.port) do |http|
  req = Net::HTTP::Post::Multipart.new(url, model_params)
  key = "authorization_key"
  req.add_field("Authorization", key) #add to Headers
  http.use_ssl = (url.scheme == "https")
  http.request(req)
end 
```

[https://github.com/Feuda/multipart-post/tree/patch-1](https://github.com/Feuda/multipart-post/tree/patch-1)

            回答 #13

赞同：0

时间：2021-04-10T11:37:58.790

使用[http.rb](https://github.com/httprb/http)宝石：

```
HTTP.post("https://here-you-go.com/upload",
          form: {
            file: HTTP::FormData::File.new(file_path)
          }) 
```

[细节](https://github.com/httprb/http/wiki/Passing-Parameters#file-uploads-via-form-data)

        testing - 如何充分利用手动测试人员

ID：184180

赞同：3

时间：2008-10-08T18:31:56.240

标签：testing, qa, manual-testing

作为一名学生，我刚刚获得了作为手动测试员的第一份合作工作。我知道它和编码员一样聪明且要求很高，但我不禁反过来思考。我喜欢成为一名编码员，但这是我的第一份工作。因此，我想请您就如何充分利用手动黑盒测试工作提供任何建议*，*即如何使用它来提高我的编码技能。非常感谢。

            回答 #1

赞同：6

时间：2008-10-08T18:46:16.757

测试有时比开发更具挑战性和回报。在与我合作的团队中，很多优秀的开发人员都来自测试工程师背景。

首先，这项工作可以让您对发展前景有一个独特的看法。一些开发人员认为测试人员是刻薄而挑剔的，他们会在完美的代码中发现问题。一些测试人员认为开发人员是懒惰的人，并且对半熟的代码感到满意。

从篱笆两边看情况绝对是一次值得拥有的经历，因为它会减少你以后职业生涯中的误传和误解。

其次，测试人员可以编写测试用例。测试用例很棒，因为它们可以帮助您考虑系统的功能，而不是类及其方法和属性等。编写软件的目标是制作有用的软件，而不是用您的编码技能达到卓越. 因此，从这个角度考虑您的应用程序绝对是有帮助的。现在编写测试用例将帮助您以后编写好的架构文档。

您可以推动您的团队/公司走向测试自动化。有时这会失败，因为测试人员不知道如何编写自动化代码并尝试使用录制和播放接口。但是，如果您实际上可以编写测试代码，那么您成功的机会就会大得多。请注意，自动化是一项**重大**工作，不应掉以轻心。经典书籍说，工作量加倍，然后手动测试与自动化并行完成。我倾向于同意。

            回答 #2

赞同：6

时间：2008-10-08T18:52:54.420

将您在手动测试时经常做的简单事情自动化。这并不总是意味着实际测试，在大多数情况下，自动化功能测试变得更加困难，并且您离代码越远，离界面和人脑越近，您花费的时间就越少。

例如，例如；测试时是否需要复制文件并输入一些值来运行软件？自动化。您是否需要在数据库中填充数据以帮助您进行测试？自动化。一旦简单的事情被自动化并顺利运行，您就可以处理更难的事情。

另一个建议是阅读和理解源代码提交，如果可能的话，修复你发现的错误。你可以通过这种方式学到很多东西。

            回答 #3

赞同：4

时间：2008-10-09T05:24:05.550

规划期间：

*   花时间了解您指定区域的功能规范或更改请求。您的编程知识让您在这方面占据优势。
*   质疑矛盾和漏洞。希望您可以在开发仍在进行时访问设计文档。在测试开始之前，我经常通过质疑不清楚的设计文档来发现产品中的问题。
*   仔细考虑所有边界情况、负面条件和条件组合。如有疑问，请与开发合作。您不需要知道他们使用的实际代码，但您的编程背景将帮助您编写一个完整的测试模型。
*   不用担心自动化。每个新的测试人员都会看到一百种改进测试的方法，自动化通常是最重要的。黑盒测试唯一应该自动化的是一些测试设置，如果它是一个与被测试功能无关的耗时操作。（例如，在学习管理系统（LMS）中自动创建20门课程来测试自我注册场景。课程创建不是重点，因此节省几个小时的无脑工作是可取的。）问自动化是可以的，但不要以为你是第一个想到它的人。

测试期间：

*   编写清晰、详细的特定错误报告。如果有人在您的代码中发现错误，请考虑您想要的所有信息。将问题分解为持续解决问题的最小的具体行动。包括重新创建测试数据的步骤和示例。
*   当您发现问题时，尝试通过测试损坏功能的替代方案来缩小问题范围。（简单示例，在基于浏览器的产品中，使用关闭按钮关闭对话框时出现错误。使用窗口关闭按钮 (X) 关闭时是否也会出现错误？无论答案如何，将其包含在错误中报告。
*   对人好点。测试人员和程序员在同一个团队中。如果开发人员看起来像个白痴，不明白你在说什么，请备份并假设你是那个不明白的人。它可以节省很多痛苦并迅速改变您的态度。当你谦虚和受教时，沟通会更容易。

            回答 #4

赞同：4

时间：2008-10-08T18:45:32.017

尝试以编码员的身份打破它:)

Sql Injection, Script injection, etc,etc:) 它应该让它更有趣:)

            回答 #5

赞同：3

时间：2008-10-08T18:48:15.257

几年前我和你处于同样的位置，对我来说，作为测试员在编码时帮助了我很多，它会在你没有注意到的情况下发生。

大多数情况下，您会更加小心用户输入、孤立链接等，通常您会更加详细。根据我的经验，这是一个非常好的职位，我认为它确实改变了我的编程风格

            回答 #6

赞同：2

时间：2008-10-08T18:38:42.310

也许你可以尝试自动化一些测试？

编写一些脚本，为手动测试准备应用程序（启动、登录、加载测试数据集等），

编写一些回归脚本，将先前版本的输出与您正在测试的版本的输出进行比较。

            回答 #7

赞同：2

时间：2008-10-08T19:16:03.063

如果您被雇用进行手动测试，那么这就是您应该关注的。

自动化测试很棒，如果您的公司没有这样做，他们确实应该这样做。但是，您并不是要告诉他们如何经营他们的业务。任何工作的第一件事就是完成分配的工作。在入门级尤其如此。

对于如何使这成为一种学习体验，这将有助于您未来作为开发人员的职业，我的建议是注意您在其他人的代码中发现了哪些类型的问题。了解常见错误可以帮助您避免在自己的代码中犯同样的错误。

例如，一些错误只是编码错误，例如循环遍历数组时被关闭。其他是误解的需求、高级设计中的缺陷或未能检查意外/无效输入。

此外，在报告错误后尝试与开发人员联系，以尝试获取有关问题根本原因、他们如何修复它以及对项目的影响的更多信息。请注意这一点：程序员和 QA 测试人员往往存在逆向关系。他们不会喜欢你告诉他们他们的东西不起作用，尤其是高层的。确保他们知道您正在尝试从中学习，而不是批评。如果可能，请从开发人员中挑选一位“导师”来帮助完成这部分工作。这样一来，您就有一位主要联系人希望与您进行此类对话。

您可能从这个合作社中获得的主要内容是了解软件开发在现实世界中是如何完成的。作为测试人员，您将有机会看到比入门级开发人员更多的“大局”，这在您刚开始时是一件非常好的事情。

如果您认为自己在这家公司有前途，无论是在 QA 还是作为程序员，这是了解他们的产品和行业的好机会。最好的程序员不仅仅是低头的猴子。他们不仅知道他们的代码做了什么，还知道为什么以及如何使花钱使用它的人受益。

祝你好运。

            回答 #8

赞同：2

时间：2008-10-08T19:26:41.077

你可以：

*   学会隔离问题。当您发现错误时，请尝试找到重现此错误的最小操作子集 - 程序员会为此感谢您，并且您将学到一套重要的技能。

*   学会正确沟通技术问题。编写一份好的、详细的错误报告需要很多技巧。

*   学会从系统的极限情况和扭曲使用的角度来思考。这将使您以后编写更好的单元测试。

我真的相信所有程序员——包括资深程序员——每年都应该花一些时间进行手动测试，如果只是为了从不同的角度看待事物，并获得对他们一起工作的测试人员的一些尊重（我自己把它付诸实践） )

            回答 #9

赞同：1

时间：2008-10-08T18:46:39.423

除了关于自动化的内容之外，请确保您对整个生命周期表现出兴趣。很有可能您在测试中发现的任何内容都没有正确记录在需求中，并且在您看到它之前没有经过正确的单元或集成测试。您可以做的任何事情来帮助改善早期的事件链将有助于教育您并使每个人的生活更轻松。

当你发现它们时，请注意自我并小心行事。

            回答 #10

赞同：1

时间：2008-10-08T18:53:15.370

如果它与网络相关，请找到其中一个框架，您可以在其中编写击键和/或鼠标单击的脚本以进行某种虚假单元测试。它会提高你的工作效率，你可以用它成为一个忍者，用它来做你*真正*需要测试的东西，而不必处理它之前的 50 页。

它最终可能会让你踏入自动化测试的大门，如果你给人们留下深刻印象，你可能能够进入开发部门，因为很明显你可以很好地编写脚本。

            回答 #11

赞同：0

时间：2008-10-08T18:39:06.240

学习一个 *Unit 框架并随时插入不同的案例。

            回答 #12

赞同：0

时间：2008-10-08T21:04:14.513

多任务处理，并在您拥有的每一秒内练习编程。当我有一份无聊的工作来维护一些糟糕的旧 Perl 构建脚本时，只要我不工作，我就会学习更高级的 Perl，查找新算法，用 Haskell 编写原型等等。

            回答 #13

赞同：0

时间：2019-01-10T09:44:07.033

测试比开发更具挑战性，因为自动化测试人员是具有开发和测试知识的 SDET（测试中的软件开发工程师）。他们将更多地了解用例和场景。因此，请尝试实时自动化场景，例如，一个场景： 1\. 启动 Gmail 网站。2\. 登录 Gmail。3\. 点击撰写。4\. 起草一封带有附件的邮件并发送给某人。5\. 登出 所以到这里，你可能有几个问题：我应该使用哪个框架，我应该使用哪个自动化工具，以及在邮件中附加一些东西不是基于网络的，所以我们需要依赖其他一些自动化工具来处理非 html 或基于窗口的自动化。

这样您就可以开始切换到自动化。我们只是将我们手动重复执行的相同场景自动化。

当您开始编写测试脚本时，您的编码技能会自动得到提高。

这是我的经验。如果您想使用 Java 学习 Selenium，我可以为您提供资料。

            回答 #14

赞同：0

时间：2018-12-27T06:05:59.453

1) 学会彻底分析你的测试结果。不要忽略任何测试结果。最终的测试结果可能是“通过”或“失败”，但对“失败”的根本原因进行故障排除将为您提供问题的解决方案。如果测试人员不仅记录错误而且提供解决方案，他们将受到尊重。

2) 学习在每次测试任何应用程序时最大化测试覆盖率。100% 的测试覆盖率可能是不可能的，但您仍然可以尝试接近它。

3）为了确保最大的测试覆盖率，将您的被测应用程序（AUT）分解成更小的功能模块。在这些单独的单元模块上编写测试用例。如果可能的话，也可以将这些模块分成更小的部分。例如：假设您已将您的网站应用程序划分为模块，并且“接受用户信息”是模块之一。您可以将此“用户信息”屏幕分成更小的部分以编写测试用例：UI 测试、安全测试、“用户信息”表单的功能测试等部分。

对输入字段应用所有表单字段类型和大小测试、否定和验证测试，并编写所有此类测试用例以实现最大覆盖率。

4) 在编写测试用例时，首先为预期的功能编写测试用例，即根据要求为有效条件编写测试用例。然后为无效条件编写测试用例。这将涵盖被测应用程序的预期和意外行为。

5）积极思考。开始测试应用程序以发现错误/错误。不要事先认为应用程序中不会有任何错误。如果您测试应用程序的目的是发现错误，那么您肯定也会成功找到那些细微的错误。

6) 在需求分析和设计阶段编写测试用例。这样，您可以确保所有需求都是可测试的。

7) 在编码之前让开发人员可以使用您的测试用例。不要让您的测试用例等待获得最终的应用程序版本以进行测试，以为您可以记录更多错误。让开发人员彻底分析您的测试用例以开发高质量的应用程序。这也将节省返工时间。

8 ) 如果可能，识别并分组您的测试用例以进行回归测试。这将确保快速有效的手动回归测试。

9) 应彻底测试需要关键响应时间的应用程序的性能。性能测试是许多应用程序的关键部分。在手动测试中，由于在性能测试中缺乏所需的大数据量，这是测试人员最容易忽略的部分。找出测试应用程序性能的方法。如果无法手动创建测试数据，则编写一些基本脚本来创建测试数据以进行性能测试，或者请开发人员为您编写一个。

10) 程序员不应该测试自己的代码。正如我们在上一篇文章中所讨论的，开发应用程序的基本单元测试应该足以让开发人员为测试人员发布应用程序。但是您（测试人员）不应该强迫开发人员发布产品进行测试。让他们有自己的时间。从领导到经理，每个人都知道何时发布模块/更新进行测试，他们可以相应地估计测试时间。这是敏捷项目环境中的典型情况。

11) 超越需求测试。测试应用程序不应该做的事情。

12）在进行回归测试时，使用之前的错误图（错误图 - 针对不同模块发现的错误数量随时间变化）。此模块级错误图可用于预测应用程序中最可能出现的错误部分。

13) 记下您在测试时学到的新术语和概念。在测试任何应用程序时保持文本文件打开。记下其中的测试进度和观察结果。在准备最终测试发布报告时使用这些记事本观察。这个好习惯将帮助您提供完整明确的测试报告和发布细节。

14) 测试人员或开发人员多次对被测应用程序的代码库进行更改。这是开发或测试环境中的必需步骤，以避免像银行项目中那样执行实时交易处理。记下出于测试目的而进行的所有此类代码更改，并在最终发布时确保您已从最终客户端部署文件资源中删除所有这些更改。

15) 让开发人员远离测试环境。这是检测发布或部署文档中缺少的任何配置更改的必要步骤。有时开发人员会进行一些系统或应用程序配置更改，但忘记在部署步骤中提及这些。如果开发人员无法访问测试环境，他们将不会在测试环境上意外地进行任何此类更改，并且可以在正确的位置捕获这些缺失的内容。

16) 从软件需求和设计阶段就让测试人员参与进来是一种很好的做法。通过这些方式，测试人员可以了解应用程序的可靠性，从而获得详细的测试覆盖率。如果您没有被要求参与此开发周期，那么您可以向您的主管或经理提出请求，让您的测试团队参与所有决策制定过程或会议。

17) 测试团队应与组织中的其他团队分享最佳测试实践和经验。

18) 增加与开发人员的对话以了解更多关于产品的信息。尽可能进行面对面的沟通，以快速解决纠纷，避免任何误解。但是，当您了解要求或解决任何争议时，请确保通过电子邮件等书面沟通方式进行相同的沟通。不要保留任何口头上的内容。

19) 不要没时间去做高优先级的测试任务。将您的测试工作从高优先级到低优先级，并相应地计划您的工作。分析所有相关风险以确定您的工作的优先级。

20) 编写清晰、描述性、明确的错误报告。不仅要提供 bug 症状，还要提供 bug 的影响和所有可能的解决方案。

不要忘记测试是一项具有创造性和挑战性的任务。最后，这一切都取决于您如何应对这一挑战的技能和经验。

交给你：

在下面的评论中分享你自己的测试经验、技巧或测试秘诀，一定会让这篇文章更有趣、更有用！！

        python - 如何在 python 中从 perforce 中签出文件？

ID：184187

赞同：15

时间：2008-10-08T18:33:08.250

标签：python, scripting, perforce

我想在 python 中编写一些脚本，对源代码进行一些自动更改。如果脚本确定它需要更改文件，我想先将其从 perforce 中检查出来。我不关心签入，因为我总是想先构建和测试。

            回答 #1

赞同：21

时间：2008-10-08T19:02:38.783

Perforce 在其 C/C++ 工具周围有 Python 包装器，可用于 Windows 的二进制形式，以及其他平台的源代码：

[http://www.perforce.com/perforce/loadsupp.html#api](http://www.perforce.com/perforce/loadsupp.html#api)

您会发现他们的脚本 API 文档很有帮助：

[http://www.perforce.com/perforce/doc.current/manuals/p4script/p4script.pdf](http://www.perforce.com/perforce/doc.current/manuals/p4script/p4script.pdf)

Python API 的使用与命令行客户端非常相似：

```
PythonWin 2.5.1 (r251:54863, May  1 2007, 17:47:05) [MSC v.1310 32 bit (Intel)] on win32.
Portions Copyright 1994-2006 Mark Hammond - see 'Help/About PythonWin' for further copyright information.
>>> import P4
>>> p4 = P4.P4()
>>> p4.connect() # connect to the default server, with the default clientspec
>>> desc = {"Description": "My new changelist description",
...         "Change": "new"
...         }
>>> p4.input = desc
>>> p4.run("changelist", "-i")
['Change 2579505 created.']
>>> 
```

我将从命令行验证它：

```
P:\>p4 changelist -o 2579505
# A Perforce Change Specification.
#
#  Change:      The change number. 'new' on a new changelist.
#  Date:        The date this specification was last modified.
#  Client:      The client on which the changelist was created.  Read-only.
#  User:        The user who created the changelist.
#  Status:      Either 'pending' or 'submitted'. Read-only.
#  Description: Comments about the changelist.  Required.
#  Jobs:        What opened jobs are to be closed by this changelist.
#               You may delete jobs from this list.  (New changelists only.)
#  Files:       What opened files from the default changelist are to be added
#               to this changelist.  You may delete files from this list.
#               (New changelists only.)

Change: 2579505

Date:   2008/10/08 13:57:02

Client: MYCOMPUTER-DT

User:   myusername

Status: pending

Description:
        My new changelist description 
```

            回答 #2

赞同：7

时间：2008-10-08T18:33:51.570

这是我想出的：

```
import os

def CreateNewChangeList(description):
    "Create a new changelist and returns the changelist number as a string"
    p4in, p4out = os.popen2("p4 changelist -i")
    p4in.write("change: new\n")
    p4in.write("description: " + description)
    p4in.close()
    changelist = p4out.readline().split()[1]
    return changelist

def OpenFileForEdit(file, changelist = ""):
    "Open a file for edit, if a changelist is passed in then open it in that list"
    cmd = "p4 edit "
    if changelist:
        cmd += " -c " + changelist + " "
    ret = os.popen(cmd + file).readline().strip()
    if not ret.endswith("opened for edit"):
        print "Couldn't open", file, "for edit:"
        print ret
        raise ValueError 
```

            回答 #3

赞同：4

时间：2008-11-02T02:28:16.150

[另一个答案中提到的Perforce 的 P4 Python 模块](http://www.perforce.com/perforce/loadsupp.html#api)是可行的方法，但如果安装此模块不是一个选项，您可以使用 -G 标志来帮助解析 p4.exe 输出：

```
p4 [ options ] command [ arg ... ]
    options:
            -c client -C charset -d dir -H host -G -L language
            -p port -P pass -s -Q charset -u user -x file
    The -G flag causes all output (and batch input for form commands
    with -i) to be formatted as marshalled Python dictionary objects. 
```

            回答 #4

赞同：3

时间：2008-11-21T04:55:35.793

从 p4python 源构建需要下载并提取为该版本推荐的 p4 api。例如，如果为 activepython 2.5 构建 Windows XP x86 版本的 P4Python 2008.2：

*   下载并解压缩p4python 和p4api
*   修复 p4python 的 setup.cfg 以指向 p4api 目录。

要打开文件进行编辑（执行签出），请在命令行上查看“p4 help open”。

如果您将文件添加到默认更改列表，则可以在不创建更改列表的情况下签出文件，但最好先创建一个更改列表。

如果没有 Visual Studio 2008，P4Python 目前不能为 activepython 2.6 编译；提供的库是用 2005 或 2003 构建的。强制 p4python 针对 mingw 构建几乎是不可能的，即使使用 pexport 的 python26.dll 并将提供的 .lib 文件重新组合/重新组装成 .a 文件。

在这种情况下，您可能宁愿使用子进程，并将 p4 结果作为编组的 python 对象返回。您可以编写自己的命令包装器，它接受一个 arg 数组，构造并运行命令，并返回结果字典。

您可以尝试更改所有内容，测试并成功，打开与“p4 diff -se //...”等效的文件不同的文件

            回答 #5

赞同：2

时间：2008-10-08T18:45:24.340

您可能想查看 P4Python 模块。它在 perforce 网站上可用，它使事情变得非常简单。

            回答 #6

赞同：2

时间：2010-11-22T04:33:38.387

请记住，为 p4api 安装 Python 的开发包，否则它会抱怨缺少标头。在 Ubuntu 10.10 中，只需做一个简单的：

```
apt-get install python2.6-dev 
```

或者

```
apt-get install python3.1-dev 
```

        language-agnostic - 座位计划软件推荐（这样的野兽甚至存在吗？）

ID：184195

赞同：4

时间：2008-10-08T18:34:18.980

标签：language-agnostic

我马上要结婚了，忙着安排座位，遇到了谁坐在哪里的常见问题：X 和 Y*必须*坐在一起，但 A 和 B 不能互相站立等。

我处理的数字并不大（所以手动选项可以正常工作），但是由于极客的说服力，我想知道是否有任何软件可以为我做这件事？

如果没有完全匹配，我应该寻找什么（问题空间、书籍、参考代码）来调整我的目的？

            回答 #1

赞同：12

时间：2008-10-08T22:20:26.683

我是 PerfectTablePlan 的开发者。我在这里发布以及[Joel 的软件业务](http://discuss.joelonsoftware.com/?biz)。;0)

组合问题，例如座位分配，在算法上是相当讨厌的。[实际上是NP 难](http://en.wikipedia.org/wiki/Np_hard)的。60个座位能容纳60位客人的方式有60种！（60 阶乘），这比已知宇宙中的原子数还多。

PerfectTablePlan 允许您指定 A 必须坐在 B 旁边，但不能靠近 C。它使用遗传算法自动分配座位。这在实践中效果很好——它通常会在几秒钟内为 100 位客人找到合适的解决方案。您可能需要为 1000 多名客人煮咖啡。在实践中，通常还需要进行一些拖放微调，以应对多变的当地风俗和家庭政治（鲍勃叔叔有点耳聋，我们最好把他放在靠近顶桌的位置）。

[你可以在这里](http://www.perfecttableplan.com/html/genetic_algorithm.html)找到更多关于遗传算法的信息。

Ps/ 自动分配座位只是创建良好座位计划的一小部分。有关详细信息，请参阅 PerfectTablePlan[导览](http://www.perfecttableplan.com/html/manage_your_guest_list.html)和[提示](http://www.perfecttableplan.com/html/tips.html)页面。

            回答 #2

赞同：6

时间：2008-10-08T18:41:15.143

[http://www.perfecttableplan.com/](http://www.perfecttableplan.com/)

我相信这是来自一个经常在 Joel On Software 发帖的人。

虽然从未尝试过。希望能帮助到你。

            回答 #3

赞同：1

时间：2008-10-08T18:40:43.977

尝试使用 GLPK 对此进行建模。整数线性规划适合将约束引入具有多种可能结果的基于图的问题。

            回答 #4

赞同：1

时间：2008-10-08T18:41:22.337

我个人最喜欢的是不分配座位：让人们坐在他们想坐的任何地方。

这可能会导致 [un] 故意的小圈子，但这意味着你不必担心它。

            回答 #5

赞同：0

时间：2008-10-08T18:39:39.487

我希望这不是一个很好的答案，但你可以研究[植绒行为](http://en.wikipedia.org/wiki/Flocking_(behavior))

如果你消除每一步的随机抖动，羊群最终会安顿在每个成员相对于群体其他成员找到最佳位置的地方。

            回答 #6

赞同：0

时间：2008-10-08T18:40:45.207

前段时间我使用了一个程序，它非常适合这个……它是一个 Java 应用程序，你可以定义规则，它会创建满足规则的测试用例。文件扩展名为 .als

```
fact GateRules {
   all g:Gate | one g.loc // Gates have 1 Location 
```

我会继续为程序名称绞尽脑汁。

编辑：它是[合金](http://alloy.mit.edu/alloy/)
现在我想起来了，它可能并不理想——“固定配置的座椅”的概念很难建模。我以不同的方式使用它：定义规则（机场登机口在一个位置，只有一架飞机在跑道上），并测试功能的前后条件（在我降落飞机后，我什至可以在一个跑道？）。

            回答 #7

赞同：0

时间：2008-10-08T22:34:35.347

这听起来像是一个约束满足问题。您可能应该查看也配备了约束求解器的逻辑编程系统。它们通常就像序言，只是它们实际上是对求解器可解决的问题的声明。

希望有一个具有您喜欢的语言的简单界面，可以输入和输出数据。

        hessian - 开始使用 Hessian

ID：184199

赞同：9

时间：2008-10-08T18:35:15.360

标签：hessian

我有一个需要良好二进制协议的新项目。

我正在考虑使用[Hessian](http://hessian.caucho.com/)，除非有人有更好的想法。

我正在阅读他们的一些文档，但它并不像我想象的那么简单，所以我有几个简单的问题。

主页有一个标题为“文档”的部分，其中包含以下文档：

```
* Hessian Documentation
* Hessian 1.0.1 spec
* Hessian 2.0 Serialization Draft
* Hessian 2.0 Web Service Draft
* Taxonomy explaining Hessians relationship to CORBA, SOAP, RMI 
```

1）这些有什么区别？我假设 1.0.1 后来变成 2.0，而且今天用 2.0 是正确的，但我不确定。

2) 你希望有人使用 2.0 序列化或 2.0 网络服务吗？看起来 Web 服务只是作为创建新实现的参考，但我也不太清楚。

3) 使用 PHP 实现支持 Hessian 的服务器怎么样？您需要使用 Caucho 服务器，还是可以在 Fedora Core 上用 PHP 实现服务器并使用 Java 客户端连接？

            回答 #1

赞同：9

时间：2009-06-08T21:24:14.537

是的，Hessian 2.0 是可以使用的。协议指定数据结构如何以二进制表示，规范很简单。

Hessian web 服务建立在 Hessian 协议之上，它​​指定了许多 Hessian 格式的标头来描述例如 Hessian 协议中的请求/响应格式。它定义了请求的内容、应该调用的方法等等。它不是严格需要的，因为没有人使用它。您可以通过创建最适合您的“请求”类和“响应”类来自己定义，并使用 Hessian 协议对其进行序列化。

Hessian 是 Java 序列化的替代方案，它较慢，因为 Java VM 不直接支持，但它比 XML 解析快得多（！）。它可以以跨平台的方式使用，尽管您必须调整现有的实现以使它们一起工作，但规范已经在这里和那里发生了变化（例如长度规范），因此实现往往会有所不同。另一方面是它不是人类可读的，你总是需要一个工具来将 Hessian 转换为文本。

我在一个大型企业应用程序中使用了 Hessian，其中 Java 富客户端与后端通信，以使客户端 JVM 版本独立于服务器 JVM 版本。它就像一个魅力。

看看[Hessian4J](http://developer.berlios.de/projects/hessian4j/)的实现。它是开源的，因此您可以完全控制它。

            回答 #2

赞同：2

时间：2008-10-08T19:57:15.630

我过去没有使用过 Hessian，将来也不打算使用它，我的论点是：

对于 Web 服务，我会非常努力地将其保留在普通的旧 XML 中。如果我选择二进制 XML 表示，我可能会使用[Fast Infoset——](http://en.wikipedia.org/wiki/Fast_Infoset)它是一种标准，很可能由一组更大的 Web 服务客户端 API/库/框架支持。我知道[CXF](http://cxf.apache.org/)的人在他们的邮件列表上谈到了快速信息集，应该支持它，即使他们没有在他们的 wiki 上记录这一点。

如果速度是首要因素，我可能最终会使用[Protocol Buffers](http://code.google.com/p/protobuf/)。

        sharepoint - 如何更改 SharePoint 扩展 Web 应用程序的 web.config 文件

ID：184204

赞同：5

时间：2008-10-08T18:37:11.970

标签：sharepoint, web-config

使用 SharePoint API，如何修改扩展的 webapp web.config 文件？
我必须在此文件中进行一些更改以指定连接字符串、membershipprovider 等...以使用表单身份验证。
目前，我可以更改“主”webapplication web.config 文件，但不能更改扩展文件。

已编辑

我正在使用 Sp 2007。我已经在使用 SPWebConfigModification 类来修改父 webapp。这些修改会传播到扩展的 webapp。我只需要更改扩展的。但我找不到这样做的方法。

我想要实现的是编写一个小向导：

*   显示一个 WebApp 列表，以便用户可以选择一个

*   将该选定的 web 应用程序扩展到不同的区域

*   将该扩展区域配置为使用表单身份验证

谢谢

            回答 #1

赞同：2

时间：2008-10-10T13:35:56.870

我从博客中得到了答案。

在您的情况下，您需要编写一个 Web 应用程序范围的功能，在您使用 C# 应用程序配置您的站点后，它将部署到新配置的站点并在您注入所需 web.config 设置的功能的接收器中，因为在该上下文配置 API 是可获取的，但请再次牢记以下几点：

如果您不使用 SPWebConfigModification 类并且使用 ASP.NET 2.0 配置 API 或您自己的机制，则在整个场中传播更改是您的责任。如果这种情况发生在独立安装上，那么您不必担心这一点。

所以它不能在外部完成。为了实现这一点，我们必须做一个功能。

谢谢

            回答 #2

赞同：0

时间：2008-10-08T18:42:38.653

快速回答：查看 SPWebConfigModification 类。我假设您使用的是 SharePoint 2007。了解这一点的最佳方法是深入研究开源项目：

Google 代码搜索：[http](http://www.google.com/codesearch?q=spwebconfigmodification&hl=en&btnG=Search+Code) ://www.google.com/codesearch?q=spwebconfigmodification&hl=en&btnG= 
Search+Code CodePlex 上的这个项目看起来像是一个大型 SPWebConfigModification： http: [//www.codeplex.com/ajaxifymoss/Release/ ProjectReleases.aspx?ReleaseId=13360](http://www.codeplex.com/ajaxifymoss/Release/ProjectReleases.aspx?ReleaseId=13360)

        java - 打开字符串/实现按钮操作

ID：184216

赞同：1

时间：2008-10-08T18:38:52.373

标签：java, swing, awt

完全免责声明：我是一名 CS 学生，这个问题与最近分配的面向对象编程的 Java 程序有关。尽管我们已经完成了一些控制台的工作，但这是我们第一次使用 GUI 和 Swing 或 Awt。我们得到了一些代码，该代码创建了一个带有一些文本的窗口和一个旋转不同颜色的文本按钮。然后我们被要求修改程序以创建颜色的单选按钮——这也是为了让我们练习研究 API。我已经提交了作业，并获得了导师的许可，可以在此处发布我的代码。

在 Java 中实现按钮操作的最佳方式是什么？经过一番摆弄，我创建了这样的按钮：

```
class HelloComponent3 extends JComponent
    implements MouseMotionListener, ActionListener
{
    int messageX = 75, messageY= 175;

    String theMessage;
    String redString = "red", blueString = "blue", greenString = "green";
    String magentaString = "magenta", blackString = "black", resetString = "reset";

    JButton resetButton;
    JRadioButton redButton, blueButton, greenButton, magentaButton, blackButton;
    ButtonGroup colorButtons;

    public HelloComponent3(String message) {

    theMessage = message;

    //intialize the reset button
    resetButton = new JButton("Reset");
    resetButton.setActionCommand(resetString);
    resetButton.addActionListener(this);

    //intialize our radio buttons with actions and labels
    redButton = new JRadioButton("Red");
    redButton.setActionCommand(redString);
    ... 
```

并添加了动作监听器......

```
redButton.addActionListener(this);
blueButton.addActionListener(this);
... 
```

已经为 actionPerformed 方法创建了一个存根，让我们了解如何使用它，但是由于模板中只有一个按钮，因此不清楚如何实现多个按钮。我尝试打开一个字符串，但很快意识到，由于字符串不是原始类型，我不能将它用于 switch 语句。我本可以即兴使用 if-else 链，但这是我想出的。这似乎远非优雅，必须有更好的方法。如果有，它是什么？有没有办法打开字符串？或者以更可扩展的方式选择一个动作？

```
public void actionPerformed(ActionEvent e){

    if (e.getActionCommand().equals(resetString)) {
        messageX = 75; messageY = 175;
        setForeground(Color.black);
        blackButton.setSelected(true);
        repaint();
        return;
    }

    if ( e.getActionCommand().equals(redString) ) {
        setForeground(Color.red);
        repaint();
        return;
    }

    if ( e.getActionCommand().equals(blueString) ) {
        setForeground(Color.blue);
        repaint();
        return;
    }

    if ( e.getActionCommand().equals(greenString) ) {
        setForeground(Color.green);
        repaint();
        return;
    }

    if ( e.getActionCommand().equals(magentaString) ) {
        setForeground(Color.magenta);
        repaint();
        return;
    }

    if ( e.getActionCommand().equals(blackString) ) {
        setForeground(Color.black);
        repaint();
        return;
    }
} 
```

            回答 #1

赞同：1

时间：2008-10-08T19:08:01.580

而不是这样写：

```
resetButton.addActionListener(this); 
```

你也可以这样写：

```
resetButton.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent evt) {
        resetButtonActionPerformed(evt);
    }
}); 
```

而不是为所有动作编写一个大的 actionPerformed() ，你可以（然后必须）写这个：

```
public void resetButtonActionPerformed(ActionEvent evt) {
    messageX = 75; messageY = 175;
    setForeground(Color.black);
    blackButton.setSelected(true);
    repaint();
} 
```

我不知道这是否是最优雅的解决方案，但至少你不再有那么大的 if 构造。

            回答 #2

赞同：0

时间：2008-10-08T19:13:02.913

两种替代方法：

1.  创建一个实现 Action 接口并具有 Color 字段和设置颜色的 actionPerformed 方法的新类
2.  维护从命令名称到 Color 实例的 HashMap 并在地图中查找命令名称

            回答 #3

赞同：0

时间：2008-10-08T19:19:39.483

一种足够体面的方法是声明一个[枚举，其元素与您的字符串匹配](http://www.xefer.com/2006/12/switchonstring)并打开 valueOf(str) （链接的示例显示了如何在相当安全的情况下执行此操作）。

避免匿名内部类的原因可能是因为该类（还）没有那个构造，即使这可能是最好的解决方案。

            回答 #4

赞同：0

时间：2008-10-09T23:38:08.773

如前所述，您可以使用匿名内部类来实现 ActionListener 接口。作为替代方案，您不必使用匿名内部类，但可以使用简单的嵌套类代替：

```
resetButton = new JButton(new ResetAction());
redButton = new JButton(new ColorAction("Red", Color.red)); 
```

进而...

```
private class ResetAction extends AbstractAction {
    public ResetAction() {
        super("Reset");
    }

    public void actionPerformed(ActionEvent e) {
        messageX = 75; messageY = 175;
        setForeground(Color.black);
        blackButton.setSelected(true);
        repaint();
    }
}

private class ResetAction extends AbstractAction {
    private Color color;

    public ColorAction(String title, Color color) {
        super(title);
        this.color = color;
    }

    public void actionPerformed(ActionEvent e) {
        setForeground(color);
        repaint();
    }
} 
```

为什么这种方法 - 或任何涉及内部类的方法 - 比在外部类中实现 ActionListener 更好，请参阅“设计模式”：

“偏爱‘对象组合’而不是‘类继承’。” （四人帮 1995:20）

在匿名内部类和这些命名内部类之间进行选择在很大程度上是一种风格问题，但我认为这个版本更容易理解，并且在有很多动作时更清晰。

            回答 #5

赞同：-1

时间：2008-10-08T19:18:18.690

呃。不要在一个大型类中实现大量不相关的接口。相反，使用匿名内部类。它们有点冗长，但正是你想要的。每个事件使用一个，那么您将不需要大的 if-else 链。我建议在内部类中保留足够的代码来解码事件并调用对目标对象有意义的方法。此外，您可以参数化您的内部类。您可能会发现您不需要保留对实际小部件的引用。

在您的示例中，您似乎将 JComponent 用作 JPanel。没有太大区别，但使用 JPanel 来收集小部件块。此外，不太可能需要对其进行子类化，所以不要。

例如：

```
 addColorButton("Green" , Color.GREEN );
   addColorButton("Red"   , Color.RED   );
   addColorButton("Yellow", Color.YELLOW);
   addColorButton("Blue"  , Color.BLUE  );
   ...

private void addColorButton(String label, Color color) {
    JRadioButton button = new JRadioButton(label);
    button.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent event) {
            target.setForeground(color);
            target.repaint();
        } 
    });
    colorGroup.add(button);
    panel.add(button);
} 
```

        c++ - 从 MFC Feature Pack 将注册表访问转换为 db 调用

ID：184253

赞同：2

时间：2008-10-08T18:47:51.683

标签：c++, database, mfc, registry, mfc-feature-pack

我们可能会开始转换旧的 VS2003 MFC 项目以使用 MFC 功能包和 VS2008 提供的花哨的新功能。几个新的 UI 控件会非常好，除了一件事 - 它们会自动将信息保存到注册表。我的注册表没有问题，但是对于用户使用程序的多种环境，将用户数据保存到数据库要容易得多。

所以，我希望有一个主要的“访问注册表”功能可以重载以指向数据库。但简短的调查并没有发现任何问题。有没有其他人在做类似的事情上取得过成功？

            回答 #1

赞同：2

时间：2008-10-14T22:02:46.393

根据MSDN[此页面](http://msdn.microsoft.com/en-us/library/cc309001.aspx)上的信息，似乎应该可以按照您的建议进行操作。我自己没有尝试过，所以我不知道在实践中会有多困难。

根据文档，您应该创建一个继承[`CSettingsStore`](http://msdn.microsoft.com/en-us/library/bb982141.aspx)来读取和写入设置的类，并调用[`CSettingsStoreSP::SetRuntimeClass`](http://msdn.microsoft.com/en-us/library/cc309027.aspx)以便框架使用您的类而不是默认类。

            回答 #2

赞同：0

时间：2008-10-08T19:29:04.660

MFC 功能包使用 BCGSoft 提供的代码，他们早在 2001 年就添加了此功能（因此您可以将状态保存到 XML 文件、数据库等）。我在这台 PC 上没有功能包，但尝试寻找一个叫做类似的类`CMFCRegistrySP`。

明天我会检查自己。

`StateCollection`样本会这样做吗？

[http://msdn.microsoft.com/en-us/library/bb983406.aspx](http://msdn.microsoft.com/en-us/library/bb983406.aspx)

        asp.net - 类型“System.Web.UI.WebControls.SessionParameter”没有名为“DbType”的公共属性

ID：184254

赞同：0

时间：2008-10-08T18:48:00.857

标签：asp.net, sql, parameters, objectdatasource

我在 ObjectDataSource 上使用会话参数。它在本地开发机器上运行良好，但在将网站复制到生产服务器后出现此错误：

类型“System.Web.UI.WebControls.SessionParameter”没有名为“DbType”的公共属性。

            回答 #1

赞同：1

时间：2008-10-08T20:51:45.537

我找到了答案，但我不知道为什么会这样。

我刚刚删除了 DBType 属性，它工作正常。

            回答 #2

赞同：1

时间：2009-06-26T18:23:28.530

我将 DbType 更改为 Type，这使网站正常工作。

            回答 #3

赞同：1

时间：2012-01-18T19:59:42.010

解决方案是用类型替换 DBType。并找到 Ansi especification。

例如，我有以下代码：  

```
DBType ="AnsiString" 
```

改变它   

```
Type="String" 
```

并且工作正常。

            回答 #4

赞同：0

时间：2009-01-10T07:29:56.653

特拉维斯的回答给了我一个线索，但也许可以这样说更好：

不知何故，在将网站复制到生产服务器时，一些参数对象（特别是那些具有 GUID 类型的对象）将“Type”="Guid" 元素更改为“DBType”="Guid"。

例如参数应该是：

不是 

            回答 #5

赞同：0

时间：2009-01-13T19:10:04.303

又是我！

我给出的第一个答案是错误的！

正确答案是安装了.NET Framework v3.5，需要更新到.NET Framework 3.5 SP1

            回答 #6

赞同：0

时间：2009-02-25T20:48:24.837

已确认：这需要 .NET Framework 3.5 **SP1**更新。

            回答 #7

赞同：0

时间：2009-04-30T16:21:42.133

哇，我还删除了 DbType="Date" 并开始工作。甚至没有打扰发布，只是用记事本在服务器上更改它。谢谢

            回答 #8

赞同：0

时间：2009-07-17T05:47:37.967

好。你应该改变它。例如。如果是 DbType="Guid" 则将其更改为 Type="Object"

        version-control - 使用单独的 TFS 项目进行源代码控制和工作项跟踪，这是一件好事吗？

ID：184257

赞同：1

时间：2008-10-08T18:48:12.010

标签：version-control, tfs, team-project

我有一个客户，他使用一个 TFS 项目仅用于源代码控制，现在想要管理一个完全不同的 TFS 项目中的工作项，使用不同的流程模板，并打算将变更集链接到 TFS 项目中的工作项。

我知道这在 TFS 中是可能的，但不知道这种配置有什么限制或问题。例如构建摘要、报告等。

我更喜欢将代码分支到一个新的 TFS 项目中，并在一个项目中一起管理代码和工作项，但需要知道上述方法是如何叠加的。

            回答 #1

赞同：1

时间：2008-10-09T00:33:58.413

它会起作用 - 我偶尔不得不将签入与其他项目的工作项相关联。我没有注意到报告等有任何问题，这表明这似乎是一个过于复杂的安排，几乎没有什么好处。

            回答 #2

赞同：0

时间：2008-10-09T07:58:07.097

对我来说似乎是一个奇怪的设置。虽然它可以工作，但 TFS 设计用于将签入和工作项放在同一个团队项目中，因此您不会真正获得 TFS 功能的全部好处。客户是否知道他们可以修改现有团队项目的流程模板，或者照你说的做分支，甚至只是将源移动到新的团队项目中。

            回答 #3

赞同：0

时间：2014-09-15T22:43:26.673

我们使用此模型允许我们拥有单独的项目，但针对同一个源分支。它工作了一段时间，但一旦我们开始对分支更具冒险精神，模型就崩溃了。因此，正如其他人所指出的那样，从技术上讲，您没有理由不能这样做，这不是标准的。

        encryption - 您使用什么系统为一群人加密文件（首选操作系统无关）？

ID：184265

赞同：2

时间：2008-10-08T18:49:09.217

标签：encryption, pki

假设您有一堆文件。假设您可以将元数据存储到这些文件中。比如说，这些元属性之一被称为“加密” 假设每个人都可以查看这些文件，但由于它们是加密的，只有知道如何解密它们的人才能真正读取内容。比如说，对于每个给定的“加密”值，一群人分享如何解密标有该值的文件的知识。假设您希望能够以与操作系统无关的方式以编程方式执行此操作（如果可能）

您将用于“加密”的值是什么？您将如何存储密钥？您将如何组织对密钥的访问？

我目前倾向于以下实施：

*   “加密”字段的值包含密钥的名称，可能还表示使用的算法
*   每个用户都可以访问一堆密钥。这可以由用户在类似 LDAP/ActiveDirectory 的结构中的角色定义，或者它们可以只是用户配置文件/主目录中安全目录中的文件。
*   在查看文件时，查看器（我正在尝试构建文档管理系统）检查用户密钥并在找到匹配密钥时解密文件。

你会使用什么加密？对称（AES）？或不对称（什么是好的）？

使用非对称密钥还有一个额外的好处，那就是在读取文件和写入文件之间有所不同：写入文件需要访问私钥，访问公钥（仅半公开，因为只有某些角色可以访问它）将允许读取文件。我在这里完全错了吗？

在中小型企业中解决这些问题的常用系统是什么？

**编辑**：似乎没有通用的解决方案。因此，我将更清楚地说明我要解决的问题：

想象一个以分布式方式运行的文档管理系统：每个文档都被复制到（公司控制的、私有的）P2P 网络中的各个节点。确保文档冗余的算法用于确保所有文档（包括修订）的备份。该系统在后台作为服务/守护程序工作，并来回铲除文档。

这意味着，用户最终会得到可能不打算在他们的本地工作站（公司控制的 PC 或笔记本电脑或其他东西）上看到的文档 - 设置是这样的，SME IT 人员设置这一切并控制谁是其中的一部分P2P 网络）。

这排除了基于目录访问的方案，因为用户可能能够访问数据。我在这里弄错了吗？本地文件夹是否可以加密，使其只能由域用户访问？那有多安全？

我知道用户共享文件的解密版本——这在技术上很难压制。这不是我要解决的问题。

            回答 #1

赞同：2

时间：2008-10-08T19:19:50.950

加密不是困难的部分，在这里。了解业务需求，尤其是您要防范的威胁，是困难的部分。密钥管理不是一件小事。

我强烈推荐《[应用密码学](http://www.schneier.com/book-applied.html)》这本书，以帮助您更好地理解协议级别的问题。

            回答 #2

赞同：1

时间：2008-10-08T18:51:46.153

这是一个**难题**。如果这真的很严重，你不应该在互联网上使用业余密码学家的建议。  

            回答 #3

赞同：1

时间：2008-10-08T18:55:41.153

也就是说，这是我的想法：

我会使用 AES 使用随机对称密钥加密每个文件。这种加密会在一夜之间运行，因此密钥会在一夜之间发生变化。

我会用有权访问该文件的每个人的公钥加密每个文件的密钥。  

如果有人无法访问文件，他们第二天将无法读取新副本（他们仍然可以在本地拥有旧版本的副本）。  

我会使用 gpg（几乎可以在所有操作系统上愉快地运行）。  

您误解了非对称加密。公钥给大家，私钥你自己保管。如果 Alice 用 Bob 的公钥加密了一些东西，那么只有 Bob 可以解密它。如果 Bob 用他的私钥加密了一些东西 - 每个人都可以解密它，并且每个人都知道它来自 Bob，因为只有他有他的私钥。

编辑：但是，如果您忽略了我所说的一切并采取了不同的路线，并为每个文件提供了它自己的 pub/priv 密钥对......那么您将依赖公钥仅对您想要读取文件的人可用，并且您想要读/写的人可用的私钥。但这有点棘手，并且严重依赖于无法分发密钥的人。更改密钥的通宵工作可以缓解这个问题，但是您会遇到向用户分发新密钥的问题。

            回答 #4

赞同：1

时间：2008-10-08T19:04:01.167

如果我理解正确，您可以使用 GNU Privacy Guard。它是跨平台和开源的。基本上，每个用户都有一份 GPG 副本和一个带有“私钥”和“公钥”的本地“钥匙串”。当你想加密某些东西时，你使用这个人的公钥，结果只能用他们关联的私钥解密。一个用户可以拥有多个密钥对，因此您可以让所有管理员访问“管理员角色”私钥，并且每个持有的私钥都可以解密使用“管理员角色”公钥加密的文档。

很酷的部分是您可以使用多个公钥加密文件，然后可以使用任何一个相应的私钥对其进行解密。

            回答 #5

赞同：0

时间：2008-10-08T18:56:09.140

这个问题的难点在于为什么许多企业默认使用特定于操作系统的解决方案，例如 Active Directory。

对于与操作系统无关的情况，您必须重新创建特定操作系统和/或网络供应商已经构建的大量用户管理内容。

但这是可以完成的。对于加密本身 - 使用 AviewAnew 的答案。

            回答 #6

赞同：0

时间：2008-10-08T19:40:08.583

我必须同意马克的观点：

了解业务需求，尤其是您要防范的威胁，是最困难的部分

例如; 您是否担心未经授权的用户可能会访问敏感文件？您几乎可以在任何操作系统上使用文件级访问控制来限制用户或组访问文件/目录。

您是否担心授权用户可能会在本地复制文件，然后丢失他们的笔记本电脑？有许多操作系统级别的加密工具可以提供不同程度的保护。我个人推荐将 TrueCrypt 用于拇指驱动器和其他便携式媒体，Windows Vista 现在包括提供不同级别保护的 BitLocker。

丢失笔记本电脑主题的另一个变体是丢失备份主题，许多备份供应商现在都为您的磁带备份提供加密方案，正是出于这个原因。

最后，如果您担心授权用户可能会与未授权用户共享文件，那么您可能正在尝试解决错误的问题。可以解密这些文件的授权用户可以轻松共享同一文档的新未加密版本。

            回答 #7

赞同：0

时间：2008-12-20T09:06:39.093

What you need is public-key encryption using either OpenPGP or X.509 certificates. In both cases you can encrypt the single block of data for multiple "recipients" using their OpenPGP keys or X.509 certificates respectively. In X.509 the standards for encrypting the data this way are PKCS#7 and CMS (defined in some RFC, I forgot the number). You would need to employ some key revocation checking in order to prevent access for those people, who were given access before but don't have it now.

        language-agnostic - 当提到“提交补丁”时，补丁这个词到底是什么意思？

ID：184272

赞同：10

时间：2008-10-08T18:49:52.053

标签：language-agnostic, open-source, patch

当提到“提交补丁”时，补丁这个词到底是什么意思？

我已经看到它被大量使用，尤其是在开源世界中。这是什么意思以及提交补丁的具体内容是什么？

            回答 #1

赞同：18

时间：2008-10-08T18:51:19.820

它是一个文件，其中列出了已更改的代码文件之间的差异。它通常是通过对两个文件执行**diff -u生成的格式。**大多数版本控制系统允许轻松创建补丁，但通常采用相同的格式。

**这允许使用patch**命令轻松地将代码更改应用于其他人的源代码副本。

例如：

假设我有以下代码：

```
<?php
  $foo = 0;
?> 
```

我把它改成这样：

```
<?php
  $bar = 0;
?> 
```

补丁文件可能如下所示：

```
Index: test.php
===================================================================
--- test.php    (revision 40)
+++ test.php    (working copy)
@@ -3,7 +3,7 @@
         <?php
-            $foo = 0;
+            $bar= 0;
         ?> 
```

            回答 #2

赞同：6

时间：2008-10-08T18:58:09.900

Red Hat 的开发人员 Richard Jones 有一本关于向开源项目提交代码[的不错的入门读物，其中包括制作和提交补丁。](http://et.redhat.com/~rjones/how-to-supply-code-to-open-source-projects/)

            回答 #3

赞同：4

时间：2008-10-08T19:00:12.923

补丁通常是一个文件，其中包含如何更改某些内容的信息（通常用于修复错误，但也可能是增强功能）。有不同种类的补丁。

源代码补丁包含如何修改一个或多个源代码文件的信息。*您可以使用diff*命令轻松生成它们，也可以使用*patch*命令应用它们（在 Linux/UNIX 系统上，这些命令是标准的）。

但是，也有二进制补丁。二进制补丁包含如何更改二进制文件中某些字节的信息。当然，二进制补丁在开源世界中很少见，但在计算机的早期，我看到很多修改交付的二进制文件（通常是为了解决错误）。

提交补丁意味着您在本地修复了某些内容，现在您将文件发送给某人，因此他可以将此补丁应用到他的本地副本或网络上的公共副本，因此其他用户可以从修复中受益。

如果您有一些几乎可以在某个平台上编译的源代码，也经常使用补丁，但是需要进行一些微小的更改才能真正在那里编译。当然，您可以获取源代码，对其进行修改并提供修改后的代码以供下载。但是，如果原始源再次更改（例如错误得到修复或添加了小的增强功能）怎么办？然后您必须重新下载源代码，再次应用更改并提供新的修改版本。保持修改后的源代码是最新的需要做很多工作。您无需修改​​，而是创建一个*差异*在原始副本和修改后的副本之间，并将其存储在您的服务器上。如果现在用户想从源代码下载和编译应用程序，他可以首先下载原始源代码的最新和最好的版本，然后应用您的补丁（因此它会编译）并且始终具有最新版本，而无需您进行更改补丁。仅当您的补丁修改的地方之一的原始源已完全更改时，才会出现问题。在这种情况下，系统将拒绝应用补丁，需要制作新的补丁。

            回答 #4

赞同：1

时间：2008-10-08T18:52:08.603

补丁是一个文件，其中包含将维护者的源代码树转换为您自己的所有必要信息。它通常由`diff`or`svn diff`或之类的工具创建`git format-patch`。

传统上，开源项目以补丁的形式接受来自普通 schlub 的提交，因此他们不必授予其他人对其存储库的提交访问权限。

            回答 #5

赞同：1

时间：2008-10-08T18:52:56.010

补丁，通常采用 .patch 文件的形式，是一种常见的平面文件格式，用于传输两组代码文件之间的差异。因此，如果您正在开发一个开源项目，并对文件进行代码更改，并希望将其提交给项目所有者进行签入（通常是因为您没有签入权限），您可以通过补丁来完成.

WinMerge 内置了此功能，许多其他工具（如 TortoiseSVN）也是如此。

            回答 #6

赞同：1

时间：2008-10-08T18:53:11.330

补丁文件代表现有源代码和您修改的源代码之间的差异。它是在许多项目中添加功能或修复错误的主要方法。

您可以使用 diff 命令创建补丁（例如）。

然后，您可以将此补丁提交到开发邮件列表，如果收到良好，则提交者将应用补丁（从而自动应用您的更改）并提交代码。

使用 patch 命令应用补丁。

            回答 #7

赞同：1

时间：2008-10-08T18:53:17.553

通常它意味着提交一个统一的差异文件，其中包含一个特性的聚合变更集。您可以[在 Wikipedia 上阅读有关补丁的更多信息](http://en.wikipedia.org/wiki/Patch_(Unix))。几个版本控制系统（svn、git 等）会根据变更集为您创建一个补丁文件。

            回答 #8

赞同：1

时间：2008-10-08T18:53:37.397

```
 1\. n. A temporary addition to a piece of code, usually as a quick-and-dirty 
```

补救现有的错误或错误功能。补丁可能有效，也可能无效，最终可能会或可能不会永久合并到程序中。与 diff 或 mod 的区别在于补丁是通过比程序的其余部分更原始的方式生成的；经典示例是使用前面板开关修改的指令，以及直接对最初以 HLL 编写的程序的二进制可执行文件进行的更改。比较单行修复。

[在此处](http://catb.org/jargon/html/P/patch.html)查看行话文件中的完整定义

            回答 #9

赞同：1

时间：2010-06-17T02:54:30.203

补丁也用于更新系统二进制文件。微软一直在发送补丁，但它们不是源代码。它们是安装改进的二进制文件的 .msp 文件。与所有计算机科学术语一样，patch 是重载的。

            回答 #10

赞同：0

时间：2008-10-08T18:53:05.993

我一直认为这个词的意思是修复错误，就像妈妈用来穿在你的破洞牛仔裤上的膝盖补丁。

        session - 如何在 OC4J 上抑制 jsessionID？

ID：184289

赞同：1

时间：2008-10-08T18:52:53.437

标签：session, jsf, oc4j

我正在向 OC4J 部署一个 JSF（myfaces、restfaces 和 richfaces）应用程序。我不希望 jsessionid 出现在状态栏或 URL 地址中。我几乎在所有情况下都设法压制它。我仍然遇到问题的一种情况是，首次使用“干净”浏览器（没有缓存、历史记录等）访问该站点时。在这种情况下， jsessionid 出现在每个链接上，直到单击任何链接，然后它消失，并且在浏览器的缓存再次清除之前不会回来（即使在后续会话中）。

似乎其他人遇到了这个问题，但我没有找到任何解决方案或解决方法：

*   [Java Servlet - 如何从嵌入式 URL 中删除 jsessionid](http://forums.sun.com/thread.jspa?messageID=10125580&tstart=0)
*   [主题：如何在首页Url中隐藏JSESSIONID？](http://forums.oracle.com/forums/message.jspa?messageID=2632969)

            回答 #1

赞同：2

时间：2009-04-12T00:03:30.903

servlet 过滤器中的以下代码对我们有用。这个想法是通过使用自定义响应包装器来覆盖任何 URL 重写逻辑。

```
public void doFilter( 
    ServletRequest req, 
    ServletResponse resp, 
    FilterChain filterChain ) 
    throws IOException, ServletException
{
    if ( req instanceof HttpServletRequest && 
         resp instanceof HttpServletResponse )
    {
        doFilter( 
            (HttpServletRequest) req, 
            (HttpServletResponse) resp, 
            filterChain );
    }
    else
    {
        filterChain.doFilter( req, resp );
    }
}

private void doFilter( 
    HttpServletRequest request, 
    HttpServletResponse response, 
    FilterChain filterChain ) 
    throws IOException, ServletException
{
    RequestHandler requestHandler = getRequestHandler( request );

    HttpServletResponse wrappedResponse = getWrappedResponse( response );

    filterChain.doFilter( request, wrappedResponse );
}

private HttpServletResponse getWrappedResponse( 
    HttpServletResponse response )
{
    return
        new HttpServletResponseWrapper( response )
        {
            public String encodeRedirectUrl( String url ) { return url; }

            public String encodeRedirectURL( String url ) { return url; }

            public String encodeUrl( String url ) { return url; }

            public String encodeURL( String url ) { return url; }
        };
} 
```

        wpf - WPF 跨元素树分支路由事件

ID：184292

赞同：0

时间：2008-10-08T18:52:59.893

标签：wpf, routed-commands

我想知道在 WPF 中启用控件之间通信的正确机制是什么。我的目标是不使用常规事件，而必须手动连接它们。路由命令（隧道、冒泡）的默认行为似乎是正确的，但我想我错过了一些东西。

路由事件是 WPF 提供的一种新的基础结构，它允许事件沿着可视化树向下传送到目标元素，或者冒泡到根元素。当一个事件被引发时，它会向上或向下“移动”可视化树，在它在途中遇到的订阅该事件的任何元素上调用该事件的处理程序。  **注意这个树遍历并没有覆盖整个视觉树，只覆盖了祖先元素** 

那是来自这篇[WPF 文章](http://joshsmithonwpf.wordpress.com/2007/06/22/overview-of-routed-events-in-wpf/)

使用文章中的图像，我希望“立即元素 #1”启动（引发）一个事件，然后让“立即元素 #2”处理该事件。我想实现这一点，而不必在“根元素”中放置任何代码。

基本上从我的应用程序中的任何地方触发一个事件（保存、更新状态、更改选择等），然后让它在其他地方处理，而两方不知道彼此的任何信息。这可能吗？

我不相信数据绑定是答案。我想使用路由事件/命令，因为它们是在整个树中设计的，而不仅仅是在源代码管理的分支中。也许使用路由事件/命令无法完成，数据绑定就是答案。我只是不知道...

有任何想法吗？

            回答 #1

赞同：2

时间：2008-10-08T19:10:05.850

最好的机制是重构数据视图并将其与数据模型分离。

创建为每个数据点提供 DependencyProperty 属性（而不是标准 C# 属性）的数据模型，但不提供 UI。数据模型中的值在修改时会相互影响。

然后，您可以将每个 WPF 元素绑定到数据模型中的相应 DependencyProperty。修改一个元素中的值，并更新所有其他元素以反映绑定属性中的任何数据模型更改。

            回答 #2

赞同：1

时间：2008-10-08T18:58:04.283

如果要在元素之间传输数据，`Binding`是要走的路。网上有很多关于这方面的教程和书籍。

如果要实现`Style`更改，则可以使用`DataTriggers`，它也使用绑定。

如果不将其连接到公共根中，就无法在不相关的控件之间发送传统意义上的事件。

        .net - 如何使用 System.IO.Compression 读取/写入 ZIP 文件？

ID：184309

赞同：20

时间：2008-10-08T18:56:16.567

标签：.net, compression, zip

我知道那里[有用于处理 ZIP 文件的库](https://stackoverflow.com/questions/11737/net-library-to-unzip-zip-and-rar-files)。而且，您也可以[使用 Windows 内置的功能来处理 ZIP 文件](https://stackoverflow.com/questions/30211/windows-built-in-zip-compression-script-able)。

但是，我想知道是否有人研究过如何使用 .NET 中 System.IO.Compression 命名空间中内置的工具来读取/写入 ZIP 文件？或者，不能只使用这个命名空间吗？

更新：我似乎有人评论 System.IO.Packaging 命名空间也可能对此有用。有谁知道具体怎么做？

            回答 #1

赞同：17

时间：2008-10-08T19:04:05.397

MSDN 有一个使用 ZipPackage 类的完整[示例](http://msdn.microsoft.com/en-us/library/system.io.packaging.zippackage.aspx) [http://msdn.microsoft.com/en-us/library/system.io.packaging.zippackage.aspx 。](http://msdn.microsoft.com/en-us/library/system.io.packaging.zippackage.aspx)需要 .NET 3.5。

            回答 #2

赞同：7

时间：2008-10-08T19:13:06.627

戴夫，非常好！！我不知道那是在里面。

现在我知道要查找什么，我能够找到一篇关于如何使用它的小代码示例的文章：
 [http ://weblogs.asp.net/jgalloway/archive/2007/10/25/creating-zip -archives-in-net-without-an-an-external-library-like-sharpziplib.aspx](http://weblogs.asp.net/jgalloway/archive/2007/10/25/creating-zip-archives-in-net-without-an-external-library-like-sharpziplib.aspx)

在相关的说明中，我还发现[DotNetZip 项目](http://www.codeplex.com/DotNetZip)看起来非常易于使用。

            回答 #3

赞同：7

时间：2009-01-04T03:41:36.953

您将希望使用第三方库，例如[http://www.codeplex.com/DotNetZip](http://www.codeplex.com/DotNetZip)，而不是尝试使用 GZipStream 或 DeflateStream 来读取 zip 文件。

.NET 中的 ***Stream 类可以让您读取或写入压缩的字节流。这些类不读取或写入 zip 文件。zip 文件是由“信封”或标题包围的压缩数据。将其视为元数据——它包括文件名、时间戳、CRC 和一堆其他内容。**Stream类只产生压缩数据流，不知道如何产生或消费元数据，这在PKWare维护的PKZip格式规范中有描述。

DotNetZip 等第三方库处理 ZIP 存档中的元数据。他们可能会也可能不会使用 System.IO.Compression.DeflateStream() 类来生成压缩的字节流。例如，在以前的版本中，DotNetZip 使用内置的 DeflateStream。从 v1.7 开始，DotNetZip 包含自己的 DeflateStream，它比 .NET Framework 中提供的更高效。作为一个额外的好处，DotNetZip 中的嵌入式 DeflateStream 允许 DotNetZip 在缺少 System.IO.Compression.DeflateStream 的 .NET Compact Framework 2.0 上使用。（它是在 Compact Framework 3.5 中添加的）

如果您有更多问题，DotNetZip 网站上有一个很好的论坛。示例 C# 代码：

```
 try
    {
        using (ZipFile zip = new ZipFile())
        {
            zip.AddDirectory(DirectoryToZip); // recurses subdirs
            zip.Save(Filename);
        }
    }
    catch (System.Exception ex1)
    {
        System.Console.Error.WriteLine("exception: " + ex1);
    } 
```

            回答 #4

赞同：6

时间：2013-11-15T16:45:31.923

从 .NET 4.5 开始，Microsoft 已将[ZipArchive](http://msdn.microsoft.com/en-us/library/system.io.compression.ziparchive(v=vs.110).aspx)类提供给`System.IO.Compression`命名空间。但是，与该命名空间中的其他类不同，就像`GZipStream`和`Deflate`流一样，它`ZipArchive` *需要对 System.IO.Compression.dll*程序集的引用。

它使用起来相当简单，上面指向 MSDN 的链接提供了一些很好的示例。

此外，Microsoft 还创建了[Microsoft Compression NuGet 包](https://www.nuget.org/packages/Microsoft.Bcl.Compression/)，它`ZipArchive`为 Windows Phone 8 和其他可移植类库添加了对相关类的支持

            回答 #5

赞同：4

时间：2015-02-04T23:03:21.223

一个较旧的线程，我知道，但我想指出 .NET 4.5 对 system.io.compression 进行了广泛的改进。它现在可以很好地操作 .zip 文件，甚至可以将 zip 中的单个文件公开为能够读取和写入的流，而无需提取和压缩文件的步骤。

            回答 #6

赞同：1

时间：2008-10-08T19:46:16.120

[.NET Framework Zip / UnZip 工具使用打包命名空间](http://www.codeproject.com/KB/files/ZipUnZipTool.aspx)

            回答 #7

赞同：0

时间：2008-10-08T19:46:39.053

是的，我以前用过。[我将DataSet](http://msdn.microsoft.com/en-us/library/system.data.dataset.aspx)子类化一次以支持将自身持久化到文件中（通过[ReadXML](http://msdn.microsoft.com/en-us/library/system.data.dataset.readxml.aspx) / [WriteXML](http://msdn.microsoft.com/en-us/library/system.data.dataset.writexml.aspx)方法）。作为一个额外的好处，我决定允许它在需要时进行可选的压缩（正如你们都应该知道的，这对于像 XML 这样的文本数据非常有效）。

我使用了[GZipStream](http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx)类（当时我的理解是，相关的[DeflateStream](http://msdn.microsoft.com/en-us/library/system.io.compression.deflatestream.aspx)只是没有标头信息的 GZip，或者类似的东西——我相信有人可以纠正我）。它的工作原理非常简单，只需在另一个流之上捎带，因此您可以使用 GZipStream 代替它。就我而言，它是在 FileStream 上的捎带。

给定一个[MemoryStream](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx)的输出填充`myDataSet.WriteXML()`，我做了如下的事情：

```
if (CompressData)
{
    // Write to memory
    mStream = new MemoryStream();
    Save(mStream);
    mStream.Seek(0, SeekOrigin.Begin);

    // Filter that through a GZipStream and then to file
    fStream = new FileStream(Path.Combine(CacheFilePath, FileName + ".gz"),
                             FileMode.OpenOrCreate);
    zipStream = new GZipStream(fStream, CompressionMode.Compress, true);

    Pump(mStream, zipStream);
}
else
{
    // Write straight to file
    fStream = new FileStream(Path.Combine(CacheFilePath, FileName),
                             FileMode.OpenOrCreate);
    Save(fStream);
} 
```

Where`Save()`和`Pump()`are 简单的方法，如下所示：

```
private void Pump(Stream input, Stream output)
{
    int n;
    byte[] bytes = new byte[4096]; // 4KiB at a time

    while ((n = input.Read(bytes, 0, bytes.Length)) != 0)
    {
        output.Write(bytes, 0, n);
    }
}

public void Save(Stream stream)
{
    AcceptChanges();

    WriteXml(stream, XmlWriteMode.WriteSchema);
} 
```

            回答 #8

赞同：0

时间：2013-05-24T06:38:02.973

```
 public static void zIpDatabseFile(string srcPath, string destPath)
    {//This is for  Zip a File
        using (var source = new FileStream(srcPath, FileMode.Open, FileAccess.Read, FileShare.Read))
        using (var dest = new FileStream(destPath, FileMode.OpenOrCreate, FileAccess.Write))
        using (var zip = new GZipStream(dest, CompressionMode.Compress))
        {
            source.CopyTo(zip);
        }
    }
    public static void uNzIpDatabaseFile(string SrcPath, string DestPath)
    {// This is for unzip a files.
        using (var source = new FileStream(SrcPath, FileMode.Open, FileAccess.Read, FileShare.Read))
        using (var dest = new FileStream(DestPath, FileMode.OpenOrCreate, FileAccess.Write))
        using (var zip = new GZipStream(source, CompressionMode.Decompress))
        {
            zip.CopyTo(dest);
        }
    } 
```

        java - 如何让 Jetty 动态加载“静态”页面

ID：184312

赞同：28

时间：2008-10-08T18:57:28.217

标签：java, spring, jetty

我正在构建 Java Web 应用程序，我讨厌传统的“代码-编译-部署-测试”循环。我想输入一个微小的更改，然后立即查看结果，而无需编译和部署。

幸运的是，[Jetty](http://www.mortbay.org/jetty/)非常适合这一点。它是一个纯 Java 网络服务器。它带有一个非常好的[maven 插件](http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin)，它可以让您直接从构建树中启动 Jetty 读取 - 无需打包战争文件或部署。它甚至有一个 scanInterval 设置：将其设置为非零值，它会监视您的 java 文件和各种配置文件的更改，并在您进行更改几秒钟后自动重新部署。

只有一件事让我远离涅槃。我的 src/main/webapp 目录中有 javascript 和 css 文件，这些文件只是由 Jetty 提供的。我希望能够编辑*这些*并在我在浏览器中刷新页面时显示更改。不幸的是，Jetty 将这些文件保持打开状态，因此我无法（在 Windows 上）在它运行时修改它们。

有谁知道如何让 Jetty 释放这些文件，以便我可以编辑它们，然后为后续请求提供编辑后的文件？

            回答 #1

赞同：18

时间：2008-10-09T02:13:56.730

Jetty 使用内存映射文件来缓冲静态内容，这会导致 Windows 中的文件锁定。尝试`useFileMappedBuffer`设置`DefaultServlet`to `false`。
[Windows 上的锁定文件故障排除（来自 Jetty wiki）](http://www.eclipse.org/jetty/documentation/current/troubleshooting-locked-files-on-windows.html)有说明。

            回答 #2

赞同：16

时间：2011-02-13T17:37:01.500

虽然上面的答案之一完全适合通过 xml 配置码头，但如果您想在代码中配置此选项（对于嵌入式服务器），答案是不同的，并且在该页面上找不到。

您会在网上找到许多建议，包括

context.getInitParams().put("useFileMappedBuffer", "false");

或覆盖 WebAppContext，或为 init 参数使用完全限定名称。这些建议都不适合我（使用 Jetty 7.2.2）。部分问题是需要在 WebAppContext 用于提供静态文件的 servlet 上设置 useFileMappedBuffer 选项，而不是在上下文中设置。

最后我在一个简单的 ServletContextHandler 上做了这样的事情

```
// Startup stuff
final Server server = new Server(port);
ServletContextHandler handler = new ServletContextHandler();
handler.setResourceBase(path);

SessionManager sm = new HashSessionManager();
SessionHandler sh = new SessionHandler(sm);
handler.setSessionHandler(sh);

DefaultServlet defaultServlet = new DefaultServlet();
ServletHolder holder = new ServletHolder(defaultServlet);
holder.setInitParameter("useFileMappedBuffer", "false");
handler.addServlet(holder, "/");

server.setHandler(handler);
server.start();
server.join(); 
```

            回答 #3

赞同：10

时间：2012-06-12T20:34:41.480

虽然这是一个老问题，但我发现[这篇](http://false.ekta.is/2010/12/jettyrun-maven-plugin-file-locking-on-windows-a-better-way/)文章很有帮助，简而言之，只需将您的配置更改为

```
 <plugin>
                <groupId>org.mortbay.jetty</groupId>
                <artifactId>jetty-maven-plugin</artifactId>
                <configuration>
                <connectors>
                    <connector implementation="org.eclipse.jetty.server.bio.SocketConnector">
                        <port>8080</port>
                    </connector>
                </connectors>
                </configuration>
            </plugin> 
```

这会禁用 Jetty 中的 NIO 支持（但对于简单情况的调试目的来说，这应该不是问题）。

            回答 #4

赞同：7

时间：2015-05-21T20:45:29.580

[Jetty 9.2 文档](http://www.eclipse.org/jetty/documentation/9.2.10.v20150310/embedded-examples.html)`ResourceHandler`提供了一个 Jetty Embedded 示例来使用 a而不是 servlet来提供静态文件：

```
// Create a basic Jetty server object that will listen on port 8080\.  Note that if you set this to port 0
// then a randomly available port will be assigned that you can either look in the logs for the port,
// or programmatically obtain it for use in test cases.
Server server = new Server(8080);

// Create the ResourceHandler. It is the object that will actually handle the request for a given file. It is
// a Jetty Handler object so it is suitable for chaining with other handlers as you will see in other examples.
ResourceHandler resource_handler = new ResourceHandler();
// Configure the ResourceHandler. Setting the resource base indicates where the files should be served out of.
// In this example it is the current directory but it can be configured to anything that the jvm has access to.
resource_handler.setDirectoriesListed(true);
resource_handler.setWelcomeFiles(new String[]{ "index.html" });
resource_handler.setResourceBase(".");

// Add the ResourceHandler to the server.
HandlerList handlers = new HandlerList();
handlers.setHandlers(new Handler[] { resource_handler, new DefaultHandler() });
server.setHandler(handlers);

// Start things up! By using the server.join() the server thread will join with the current thread.
// See "http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#join()" for more details.
server.start();
server.join(); 
```

Jetty 使用 NIO（内存中文件映射），从而[锁定 Windows 操作系统上的文件](http://www.eclipse.org/jetty/documentation/current/troubleshooting-locked-files-on-windows.html)。这是一个已知问题，可以为 servlet 找到许多解决方法。

但是，由于此示例不依赖于 servlet，因此基于 webapp 参数（useFileMappedBuffer、maxCachedFiles）的相关答案不起作用。

为了防止内存中的文件映射，您需要添加以下配置行：

```
resource_handler.setMinMemoryMappedContentLength(-1); 
```

注意：如 Javadoc 中所写（并由 nimrodm 注意到）`the minimum size in bytes of a file resource that will be served using a memory mapped buffer, or -1 for no memory mapped buffers`：. 但是，我对 value 有相同的行为`Integer.MAX_VALUE`。

设置此参数后，您的 Jetty 可以在 Windows 上提供静态文件并且您可以编辑它们。

            回答 #5

赞同：5

时间：2013-05-27T14:40:55.970

在 webdefault.xml 中将 false 设置为 useFileMappedBuffer对我**不起作用**（Jetty 8.1.10.v20130312）。幸运的是，将 maxCachedFiles 设置为 0（也在 webdefault.xml 中）起到了作用。

            回答 #6

赞同：5

时间：2016-03-08T09:02:22.633

我也有这个问题。
**而且我不想创建任何额外的类并弄乱 web.xml**
所以这是你可以做的：
假设您的项目是基于 maven 的并且（可以说）称为“my-web-app”

1.  创建文件`my-web-app/jetty/jetty-config.xml`

2.  把这些东西放进去：

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <Configure class="org.eclipse.jetty.webapp.WebAppContext">
       <Call name="setInitParameter">
         <Arg>org.eclipse.jetty.servlet.Default.useFileMappedBuffer</Arg>
         <Arg>false</Arg>
       </Call>
    </Configure> 
    ```

3.  这是您的码头配置：

    ```
    <plugin>
        <groupId>org.eclipse.jetty</groupId>
        <artifactId>jetty-maven-plugin</artifactId>
        <configuration>
            <httpConnector>
                <host>localhost</host>
                <port>8801</port>
            </httpConnector>
            <webApp>
                <contextPath>/${project.artifactId}</contextPath>
            </webApp>
            <contextXml>${project.basedir}/jetty/jetty-config.xml</contextXml>
        </configuration>
    </plugin> 
    ```

此解决方案将向您的 servlet-context 添加一个属性，该属性将禁用静态资源锁定。
玩得开心 ：）

            回答 #7

赞同：4

时间：2014-09-01T15:14:50.527

类似于@kybernetikos 的答案，但无需重新创建 DefaultServlet：

```
// Startup stuff
final Server server = new Server(port);
WebAppContext webAppContext = new WebAppContext(path, "/")
webAppContext.setInitParam(
        "org.eclipse.jetty.servlet.Default.useFileMappedBuffer", "false");

server.setHandler(webAppContext);
server.start();
server.join(); 
```

DefaultServlet 将寻找它自己的 useFileMappedBuffer 副本，该副本似乎设置在 Jetty 的深处。但是通过在属性名称前面加上上述前缀，这个值是首选的。

            回答 #8

赞同：0

时间：2013-04-26T11:30:28.167

使用嵌入式 Jetty 8.1.10 时，“useFileMappedBuffer=false”设置在任何模式下都不起作用。我阅读了 的代码`DefaultServlet`，它读取了属性，但它没有用于任何事情。

相反，我查看了缓冲区创建的配置位置，发现我可以进行子类`SelectChannelConnector`化以获得 Continuation 的好处，但无需在 Windows 上锁定文件。如果您只是使用`org.mortbay.jetty.bio.SocketConnector`，那么您将无法获得持续支持。

这是我的例子：

```
import org.eclipse.jetty.io.Buffers.Type;
import org.eclipse.jetty.server.nio.SelectChannelConnector;

/**
 * A Connector that has the advantages NIO, but doesn't lock files in Windows by
 * avoiding memory mapped buffers.
 * <p> 
 * It used to be that you could avoid this problem by setting "useFileMappedBuffer" as described in 
 * http://stackoverflow.com/questions/184312/how-to-make-jetty-dynamically-load-static-pages
 * However that approach doesn't seem to work in newer versions of jetty.
 * 
 * @author David Roussel
 * 
 */
public class SelectChannelConnectorNonLocking extends SelectChannelConnector {

    public SelectChannelConnectorNonLocking() {
        super();

        // Override AbstractNIOConnector and use all indirect buffers
        _buffers.setRequestBufferType(Type.INDIRECT);
        _buffers.setRequestHeaderType(Type.INDIRECT);
        _buffers.setResponseBufferType(Type.INDIRECT);
        _buffers.setResponseHeaderType(Type.INDIRECT);
    }
} 
```

我已经测试了这个锁定问题，它解决了这个问题。我还没有测试过它是否可以与 Continuations 一起使用。

            回答 #9

赞同：-1

时间：2015-10-10T14:59:44.137

当使用带有 ResourceHandler 的 IntelliJ 和 Jetty 9 时，其中一种解决方案是编辑目标目录中的静态内容，而不是源文件。

            回答 #10

赞同：-16

时间：2008-10-08T19:44:02.430

可能是浏览器在坚持它。

在 IE 中：工具 | 互联网选项 | 临时 Internet 文件 > 设置，单击单选按钮“每次访问页面”。按确定。

在此之前，请删除所有临时 Internet 文件。

        .net - 正则表达式在右括号上失败

ID：184313

赞同：0

时间：2008-10-08T18:57:48.107

标签：.net, regex

我有这个 .NET 正则表达式：

```
^(?<prefix>("[^"]*"))\s(?<attrgroup>(\([^\)]*\)))\s(?<suffix>("[^"]*"))$ 
```

它正确匹配以下字符串：

```
"some prefix" ("attribute 1" "value 1") "some suffix"
"some prefix" ("attribute 1" "value 1" "attribute 2" "value 2") "some suffix" 
```

它失败了...

```
"some prefix" ("attribute 1" "value (fail) 1") "some suffix" 
```

...由于“失败”后的正确括号。

如何修改我的正则表达式以使`attrgroup`匹配组最终包含“ `("attribute 1" "value (fail) 1")`”？我已经看它太久了，需要一些新鲜的眼睛。谢谢！

**编辑：** `attrgroup`不会包含除双引号字符串对之外的任何内容。

            回答 #1

赞同：2

时间：2008-10-08T19:26:57.207

我的，未经测试的猜测：

```
^(?<prefix>("[^"]*"))\s(?<attrgroup>(\(("[^"]*")(\s("[^"]*")*)**\)))\s(?<suffix>("[^"]*"))$ 
```

在此我已更换

```
[^\)]* 
```

和

```
("[^"]*")(\s("[^"]*")*)* 
```

我假设括号内的所有内容都在双引号之间，或者是空格。

如果你想知道我是如何想到这个的，请阅读[Mastering Regular Expressions](https://rads.stackoverflow.com/amzn/click/com/0596528124)。

附言。如果我是正确的，那么这也会将属性组验证为带引号的字符串对。

            回答 #2

赞同：1

时间：2008-10-08T19:13:12.710

```
^(?<prefix>"[^"]*")\s+(?<attrgroup>\(.*\))\s+(?<suffix>"[^"]*")$ 
```

为我修好了。

我删除了无关的未命名组并简化（简化为“任何字符”）属性组。

JG Soft 的 RegexBuddy 是一项*非常*值得的投资

编辑：这不会将属性组验证为带引号的字符串对，但这应该/可以在单独的正则表达式/验证步骤中完成。

            回答 #3

赞同：0

时间：2008-10-08T19:18:00.610

Hometoasts 解决方案是一个很好的解决方案，尽管与任何自由正则表达式一样，它只应用于从您有合理保证格式正确且不用于验证的来源中提取数据。

            回答 #4

赞同：0

时间：2008-10-08T19:18:11.357

在不解决此正则表达式的细节的情况下，我建议使用正则表达式工具来帮助构建、测试和验证您的正则表达式。对于任何重要的东西，或者您可能需要维护/更新的表达式，这些工具都是必不可少的。

查看...

[正则表达式教练](http://www.weitz.de/regex-coach/)- 用 Lisp 编写，有点老，但我真的更喜欢这个。

[Rad Software Regex Designer](http://www.radsoftware.com.au/regexdesigner/) - .NET 和更“现代”的可能。有些人可能会喜欢这个。

            回答 #5

赞同：0

时间：2008-10-09T13:01:37.467

我建议使用能够处理此类结构的解析器。正则表达式失败，这是正确的，因为您尝试解析的语言看起来不规则——至少从上面给出的示例来看。每当您需要识别嵌套时，正则表达式要么会失败，要么会像上面那样发展成复杂的野兽。即使语言是正则的，那里的正则表达式对我来说也太复杂了。我宁愿使用这样的东西：

```
def parse_String(string):
    index = skip_spaces(string, 0)
    index, prefix = read_prefix(string, index)
    index = skip_spaces(string, index)
    index, attrgroup = read_attrgroup(string, index)
    index = skip_spaces(string, index)
    index, suffix = read_suffix(string, index)
    return prefix, attrgroup, suffix

def read_prefix(string, start_index):
    return read_quoted_string(string, start_index) 

def read_attrgroup(string, start_index):
    end_index, content = read_paren(string, start_index)

    index = skip_spaces(content, 0)
    index, first_entry = read_quoted_string(content, index)
    index = skip_spaces(content, index)
    index, second_entry = read_quoted_string(content, index)
    return end_index, (first_entry, second_entry)

def read_suffix(string, start_index):
    return read_quoted_string(string, start_index)

def read_paren(string, start_index):
    return read_delimited_string(string, start_index, '(', ')')

def read_quoted_string(string, start_index):
    return read_delimited_string(string, start_index, '"', '"')

def read_delimited_string(string, starting_index, start_limiter, end_limiter):
    assert string[starting_index] == start_limiter, (start_limiter 
                                                     +"!=" 
                                                     +string[starting_index])
    current_index = starting_index+1
    content = ""
    while(string[current_index] != end_limiter):
        content += string[current_index]
        current_index += 1

    assert string[current_index] == end_limiter
    return current_index+1, content

def skip_spaces(string, index):
    while string[index] == " ":
        index += 1
    return index 
```

是的，这是更多的代码，是的，按原始键数计算，这需要更长的时间。然而——至少对我来说——我的解决方案更容易验证。如果您通过将所有字符串移动到类中来删除一堆字符串和索引管道，这会增加更多，该类在其构造函数中解析此类字符串。此外，很容易使空格跳过隐式（使用一些神奇的 next-char 方法，它只是跳过字符直到出现非空格，除非它由于字符串而处于某种非跳过模式。这种模式可以设置为定界函数，例如）。这会将 parse_string 变成：

```
def parse_string(string):
    prefix = read_prefix()
    attrgroup = read_attr_group()
    suffix = read_suffix()
    return prefix, attrgroup, suffix. 
```

此外，可以更容易地扩展此功能以涵盖更复杂的表达式。任意嵌套的属性组？更改一行代码。嵌套括号？更多的工作，但没有真正的问题。

现在，请抨击我，因为我是一些正则表达式异端和一些解析器倡导者。>:)

PS：是的，该代码未经测试。据我所知，我没有看到 3 个错别字。

        security - 克隆虚拟机可以作为应用程序备份计划吗？

ID：184319

赞同：0

时间：2008-10-08T18:58:53.283

标签：security, backup, virtualization, clone

我是应用程序开发人员，对虚拟机 (VM) 了解不多。但是，我们的应用程序驻留在 VM 上。需要应用频繁的补丁来修复/更新此应用程序。对于灾难恢复，建议备份服务器上的所有内容。因此，一旦服务器恢复，无需重新安装和配置应用程序。

我们的网络管理员认为可以通过克隆虚拟机来完成。但是如果我们想将克隆备份到磁带上。它会将虚拟机暴露给备份驱动器。任何可以访问它的人都可以擦除虚拟机，并且一切都会消失。这是非常危险的。

如果您能告诉我您对此或任何建议的看法，我将不胜感激。

            回答 #1

赞同：2

时间：2008-10-08T19:01:31.000

克隆是完全可以接受的。

您不必备份到磁带上……例如，它可以在 NAS 上完成，并且通过适当的安全性和设置，未经授权的人无法删除备份。

            回答 #2

赞同：0

时间：2018-10-30T11:48:15.227

您可以使用任何 NAS 和 VM 复制软件，例如 Veeam、Acronis 或[Nakivo](https://www.nakivo.com/)。它将彻底解决您的问题。所有软件都有各种权限设置，因此您可以控制谁可以删除您的数据，谁不能删除您的数据。

        encryption - 混淆、散列和加密有什么区别？

ID：184328

赞同：36

时间：2008-10-08T19:00:45.323

标签：encryption, hash, obfuscation

混淆、散列和加密有什么区别？

以下是我的理解：  

*   散列是一种单向算法；无法逆转  
*   混淆类似于加密，但不需要任何“秘密”来理解（ROT13 就是一个例子）  
*   加密是可逆的，但这样做需要“秘密”

            回答 #1

赞同：33

时间：2008-10-08T19:07:29.990

散列是一种基于较大数据创建半唯一键的技术。在给定的散列中，您最终会发生“冲突”（例如，两个不同的数据计算相同的散列值），当您这样做时，通常会创建更大的散列键大小。

混淆通常涉及尝试删除有用的线索（即有意义的变量/函数名称），删除空格以使事情难以阅读，并且通常以复杂的方式做事以使跟踪正在发生的事情变得困难。它没有像“真正的”加密那样提供严格的安全级别。

加密可以遵循几种模式，其中一种是“秘密”方法，称为私钥加密，其中双方都有一个秘密密钥。公钥加密使用共享的单向密钥进行加密，使用私人收件人密钥进行解密。使用公钥，只有接收者需要知道秘密。

            回答 #2

赞同：11

时间：2008-10-08T19:06:56.090

这是一个高级别的解释。我将尝试完善它们：

散列 - 在一个完美的世界中，它是一个随机的预言机。对于相同的输入 X，您总是会收到相同的输出 Y，这与 X 没有任何关系。这在数学上是不可能的（或至少未经证明是可能的）。我们得到的最接近的是陷门函数。H(X) = Y 因为 H-1(Y) = X 很难做到，你最好尝试暴力破解一个 Z 使得 H(Z) = Y

混淆（我的观点） - 任何函数 f，例如 f(a) = b，你依赖 f 是秘密的。F 可能是一个散列函数，但“混淆”部分意味着通过模糊来实现安全性。如果您以前从未见过 ROT13，那将是令人困惑的

加密 - Ek(X) = Y, Dl(Y) = X 其中 E 众所周知。k 和 l 是密钥，它们可能相同（在对称中，它们是相同的）。Y 是密文，X 是明文。  

            回答 #3

赞同：8

时间：2008-10-08T21:06:16.350

**哈希**是一种**单向算法**，用于在**不影响参考的情况下将输入与参考进行比较。** 

它通常用于登录以比较密码，如果您使用信用卡购物，您也可以在收据上找到它。在那里你会找到隐藏了一些数字的信用卡号，这样你就可以*很有*可能证明你的卡被用来购买东西，而有人在你的垃圾中搜索将无法找到你的卡号.

一个非常天真和简单的哈希是*“字符串的前 3 个字母”*。这意味着“abcdefg”的哈希将是“abc”。这个函数显然不能反转，这是哈希的全部目的。但是，请注意“abcxyz”将具有完全相同的哈希值，这称为**冲突**。再说一遍：**哈希仅以一定的概率证明两个比较的值是相同的**。

另一个非常幼稚和简单的散列是数字的 5 模，在这里你会看到 6、11、16 等......都将具有相同的散列：1。

现代散列算法旨在将冲突的数量保持在尽可能低的水平，但它们永远无法完全避免。一条经验法则是：散列越长，冲突就越少。

            回答 #4

赞同：3

时间：2008-10-08T19:09:18.910

**密码学中的混淆**是在对输入数据进行散列或加密**之前**对其进行编码。

这使得蛮力攻击不太可行，因为确定正确的明文变得更加困难。

            回答 #5

赞同：3

时间：2008-10-08T19:10:05.227

这不是一个糟糕的高级描述。以下是一些额外的注意事项：

散列通常将大量数据减少到小得多的大小。例如，这对于验证文件的内容而无需比较两个副本很有用。

加密涉及存储一些秘密数据，而秘密数据的安全性取决于保持单独的“密钥”免受坏人的侵害。

混淆是隐藏一些没有单独密钥（或使用固定密钥）的信息。在这种情况下，将方法保密是保证数据安全的方式。

从这里，您可以了解哈希算法如何对数字签名和内容验证有用，如何使用加密来保护您的文件和网络连接，以及为什么将混淆用于数字版权管理。

            回答 #6

赞同：2

时间：2008-10-08T19:04:11.883

这就是我一直以来的看法。

*   散列是使用一组算法从另一个值派生出一个值。根据使用的算法，这可能是一种方式，也可能不是。

*   混淆是通过符号替换使某些东西更难阅读。

*   加密类似于散列，除了值取决于您提供算法的另一个值。  

            回答 #7

赞同：1

时间：2008-10-08T20:21:33.070

一个简短的回答：

散列 - 在某些数据上创建一个检查字段（以检测数据何时被修改）。这是一个单向函数，原始数据不能从散列中导出。典型的标准是 SHA-1、SHA256 等。

混淆 - 修改您的数据/代码以混淆其他任何人（没有真正的保护）。这可能会或可能不会丢失一些原始数据。对此没有真正的标准。

加密 - 使用密钥转换数据，以便只有拥有正确密钥的人才能理解它。加密后的数据可以解密得到原始数据。典型的标准是 DES、TDES、AES、RSA 等。

            回答 #8

赞同：0

时间：2008-10-08T19:03:32.277

一切都很好，除了混淆与加密并不真正相似 - 有时它甚至不涉及像 ROT13 这样简单的密码。

            回答 #9

赞同：0

时间：2008-10-08T19:08:02.283

混淆是隐藏或使某些东西更难理解。

散列接受一个输入，通过一个函数运行它，并生成一个可以作为输入引用的输出。它不一定是唯一的，一个函数可以为不同的输入生成相同的输出。

加密以独特的方式将输入转换为输出。存在一对一的相关性，因此没有潜在的数据丢失或混淆 - 输出始终可以毫无歧义地转换回输入。

            回答 #10

赞同：0

时间：2008-10-08T19:11:46.580

*   散列是从另一个值创建一个值的单向任务。该算法应尝试创建一个尽可能短且唯一的值。

*   混淆是在不改变语义的情况下使某些东西变得不可读。它涉及到值转换，去除空格等。某些形式的混淆也可以是单向的，因此不可能得到起始值

*   加密是双向的，总是有一些解密反过来。

所以，是的，你大多是正确的。

            回答 #11

赞同：0

时间：2008-10-08T19:15:35.450

混淆只是通过引入技术来混淆某人，从而使某些事情更难理解。代码混淆器通常通过重命名以从变量或方法名称中删除任何有意义的内容来做到这一点。它与加密不同，因为无需解密即可使用。

通常，散列和加密之间的区别在于，散列通常只使用一个公式将数据转换为另一种形式，其中加密使用需要密钥来加密/解密的公式。例如，base 64 编码是一种哈希算法，其中 md5 是一种加密算法。任何人都可以对 base64 编码的数据进行 unhash，但是没有密钥就不能对 md5 加密的数据进行解密。

        windows - Vista窗口焦点问题

ID：184340

赞同：0

时间：2008-10-08T19:01:55.383

标签：windows, winforms, windows-vista, usability

我有一个管理患者人口统计信息的应用程序。连同这些数据，用户可以扫描患者的图片并将该图片分配给患者。当用户单击扫描按钮时，将打开一个单独的应用程序作为对话框以扫描图像。在 XP 上运行它时一切正常。成像应用程序加载良好并获得焦点。然而，在 Vista 上，有时成像应用程序不会获得焦点，并且会在主应用程序后面弹出。当运行全屏或通过 2008 Application Server 时，您看不到应用程序，您只会看到锁定屏幕，并且似乎什么也没发生。有什么办法可以改变 Vista 上的窗口焦点管理以像 XP 那样工作？如果可能的话，我正在寻找一种方法来解决这个问题而不改变实际的应用程序。

            回答 #1

赞同：1

时间：2008-10-08T20:03:35.463

您可以尝试以下步骤：

1\. 右键单击​​ exe 

2\. 选择属性

3\. 选择兼容性选项卡

4\. 检查以兼容模式运行此程序：

5\. 选择 Windows XP (Service Pack 2)

            回答 #2

赞同：1

时间：2008-10-08T19:19:08.423

我认为您将不得不对您的应用程序进行更改，以使成像应用程序成为焦点。我将假设您的应用程序通过`ShellExecute`或启动成像应用程序`CreateProcess`。如果是这样，您可以通过`SHELLEXECUTEINFO.hProcess`(for `ShellExecute`) 或`PROCESS_INFORMATION.hProcess`(for `CreateProcess`) 获取已启动进程的进程句柄。启动成像应用程序后立即调用[AllowSetForegroundWindow](http://msdn.microsoft.com/en-us/library/ms632668(VS.85).aspx) API：

```
AllowSetForegroundWindow(GetProcessId(hProcess)); 
```

这将允许成像应用程序在启动时将其主窗口/对话框置于前台。

            回答 #3

赞同：0

时间：2008-10-08T19:07:04.267

您可以遍历所有顶级 HWND 并通过其窗口类识别扫描应用程序，然后发送适当的消息以引发窗口。

            回答 #4

赞同：0

时间：2008-10-14T13:48:15.253

我不相信这是与 Vista 与 XP 相关的。我认为只是这个成像应用程序需要更长的时间才能在 Vista 上启动。自 Windows 2000 以来，窗口管理器已阻止后台应用程序窃取前台。当应用程序启动时，它有机会创建并显示一个将占据前景的窗口。如果花费的时间太长，窗口管理器会认为当前窗口应该保持前台，并在最终启动时禁止其他应用程序占据前台。

我想不出任何具体的方法来避免这种情况......除了在启动应用程序后使用 FindWindow 搜索其他应用程序窗口。当您最终找到它时，在其上调用 SetForegroundWindow 以将其置于前台。

        sql - MS SQL的PK中顺序唯一标识符的目的是什么？

ID：184359

赞同：2

时间：2008-10-08T19:04:47.327

标签：sql, database, guid, uniqueidentifier

我知道基于 Guid 的主键没有最好的性能（由于碎片），但它们是全局唯一的并且允许复制场景。

另一方面，整体标识符以可伸缩性为代价具有更高的性能。

但是在什么情况下有人会想要使用顺序唯一标识符作为主键呢？我认为，它超出了 GUID 的目的，但我仍然不时看到提及后续事件。

我在这里想念什么？

            回答 #1

赞同：6

时间：2008-10-08T19:16:30.050

在 SQL Server 2005 中通常称为顺序 guid（由 NEWSEQUENTIALID() 生成）是为了克服普通 guid 的问题。

它们仍然**是**普遍独特的，但也总是在上升。这意味着它们可以用于复制**并且**具有比传统 GUID 更好的插入性能。

一个缺点是它们不是“安全的”，因为可以猜测下一个顺序 guid。

[http://msdn.microsoft.com/en-us/library/ms189786.aspx](http://msdn.microsoft.com/en-us/library/ms189786.aspx)

            回答 #2

赞同：1

时间：2009-01-06T18:40:06.200

使用顺序 guid 可确保您始终使用大于最后一个值的值。对于索引字段，这很重要。您不是在整个频谱中随机插入，而是始终在数据的最后一个“页面”的末尾插入，从而大大减少了页面拆分，尤其是在您的 uniqueidentifier 列也是您的聚集索引的情况下。

        php - 多用户 XDebug 和 PHP 调试

ID：184365

赞同：8

时间：2008-10-08T19:06:21.117

标签：php, xdebug

如何设置多开发人员 XDebug PHP 环境？

我有以下设置：

*   我有一台加载了 Apache 和 Xdebug 的 linux 机器和一个我认为正确的 php.ini 文件。
*   我找到了一个 python 代理脚本，我用它来代理来自我的开发人员正在使用的 PDT Eclipse IDE 的调用到在同一 Web 服务器上运行的 Apache/Xdebug。
*   我将 php.ini 中的 idekey 设置为“ECLIPSE_DBGP”并让 Xdebug 自动启动

从代理的日志信息中可以看出，没有密钥为“ECLIPSE_DBGP”的服务器，它停止了请求。

**有没有人遇到过这个或者有一步一步的设置来让它工作？**

我用谷歌搜索到的东西已经用尽了。

            回答 #1

赞同：19

时间：2008-10-08T20:43:04.900

您可以使用 ssh 将调试连接隧道传输回您的客户端计算机。例如。从您的客户端计算机，使用以下内容连接到服务器：

```
ssh -R 9000:localhost:9000 you@example.com 
```

然后启动您的（本地）调试器，并启动远程脚本。Xdebug（在服务器上）现在将建立到它的连接`localhost:9000`，但是由于这个端口被转发回你的本地机器，你的（本地）调试器将接收到连接。

如果你在客户端使用 Windows，你可以用 PuTTY 做同样的事情。

有关更多详细信息，[请参阅 Spectator 的文档。](http://code.google.com/p/spectator/w/list)

        c++ - 嵌入到应用程序中的最佳 HTML 渲染引擎是什么？

ID：184373

赞同：18

时间：2008-10-08T19:08:01.923

标签：c++, qt, webkit, gecko, rendering-engine

目前，我们的应用程序使用 Trident Win32 组件，但出于几个原因，我们想要摆脱它，其中最主要的原因是我们希望跨平台。

我们正在研究[WebKit](http://webkit.org/)和[Gecko](http://developer.mozilla.org/en/Gecko)，但我很想在做出决定之前得到一些反馈。以下是一些最重要的要求：

1.  它应该相对较快，占用空间小。理想情况下，我们可以毫不费力地修剪掉不需要的任何东西。

2.  体面的文档很重要。我预计不需要对它做任何不寻常的事情，但你永远不知道。

3.  我们正在使用 C++，如果可能的话，我们希望使用设计良好的面向对象架构。

4.  跨平台是必须的，从长远来看，良好的性能会有所帮助（我们最终可能会移植到移动平台）。

在做出决定之前，我需要考虑哪些因素？以前有没有人使用过 WebKit 或 Gecko？如果是这样，是否有任何我可能会觉得有用的文章或教程？

更新：

谢谢你们的回应。我们最终选择了包含 WebKit 的 Qt 4.5。到目前为止，我们对它非常满意，事实上我认为 Qt 可能是我用过的最好的 UI 框架；使用本机 Win32 API 进行编码之间的差异是惊人的。它也很容易学习，我们唯一遇到的主要问题是习惯了信号/插槽范例。

            回答 #1

赞同：8

时间：2008-10-08T19:16:34.823

一点历史可能会帮助您做出决定。当 Apple 考虑在制作 Safari 时使用哪种引擎时，他们查看了 Gecko，但决定使用 KHTML，将其分叉并命名为 WebKit。他们这样做的原因是 Gecko 仍然有大量遗留在 Netscape 的遗留问题，而且要复杂得多。

KHTML/WebKit 较新，因此遗留较少。它也更干净、更快、记录得更好。

Firefox 3 的目标之一是清理代码库并简化它。据我所知，他们确实这样做了，但我不知道它与当前的 WebKit 迭代相比如何。谷歌在制作 Chrome 时显然还不够，而且他们在 Firefox 中占有重要地位。

有关更多详细信息，请参见[此处](http://arstechnica.com/articles/paedia/mozilla-committed-to-gecko.ars/1)。

            回答 #2

赞同：5

时间：2009-03-17T23:02:23.527

I am biased, but if you do not mind using (LGPL-ed) Qt, what about using [QtWebKit](http://doc.trolltech.com/4.5/qtwebkit.html)? It is fairly easy to embed, cross-platform of course, has a nice web browser demonstration, and also other [related examples](http://labs.trolltech.com/blogs/category/labs/internet/webkit/).

            回答 #3

赞同：4

时间：2008-10-08T19:24:49.910

这取决于您的需求。如果您只想显示普通的 HTML，即使是 Webkit 也可能是矫枉过正。在我的一些应用程序中，我改用 wxHTML。它是 wxWidgets 库中的一个组件（但不确定是否可以在没有 wx 的情况下使用它）。它是轻量级的，只支持基本的 HTML 内容（一些 CSS 支持可能会在下一个版本中提供），并且有一个非常好的 wxHtmlEasyPrinting 控件，它提供了很好的打印预览并且打印效果也很好。至于跨平台，wxWidgets 可以在 Windows、Linux、Mac 和其他一些系统上运行，所以一定能满足您的要求。

我不建议沿着壁虎路走。集成它是可能的，但它比 KHTML/Webkit 更难实现 - 仅仅是因为 Gecko 在构建时并未考虑嵌入。

            回答 #4

赞同：3

时间：2008-10-08T19:08:52.483

我想我会推荐 Safari/Chrome 的 WebKit 引擎，它源自 KHTML，Konqueror 渲染引擎。

            回答 #5

赞同：2

时间：2009-02-11T17:32:45.997

尝试选择 Webkit，因为它被许多不同的浏览器（Konqueror、Safari 和 Google chrome）使用。这使得 Webkit 更通用，更能适应其他需求。

Gecko 的开发与 Firefox 密切相关。对 Gecko 进行了很多修改，因为 Firefox 规定了它们。例如，Firefox 3 决定出于安全目的阻止所有自签名证书。该实现已在 Gecko 的引擎中完成，这意味着任何决定嵌入 Gecko 的应用程序都会添加此安全约束。

如果您可以继续使用 Webkit，因为它主要是 HTML 页面的渲染引擎。这是为了在不同的网络浏览器中使用而开发的。而 Gecko 主要是单个浏览器的渲染引擎，它恰好提供了嵌入的 API。

            回答 #6

赞同：0

时间：2008-10-08T19:09:36.647

我的理解是 Webkit 比 Gecko 非常好而且更小。不过，壁虎最近应该进行了改造，这使得它具有相当的可比性。

        sql-server - 升迁拆分的 Access 数据库

ID：184406

赞同：7

时间：2008-10-08T19:16:06.697

标签：sql-server, ms-access, split, upsizing

我需要升级一个拆分的 Access 数据库，即当前在两个 mdb 文件、前端和后端之间拆分的数据库。我看到许多网页本质上说“运行升迁向导”。我的第一个非常基本的问题：

*我应该在前端 mdb 还是后端 mdb 中运行此向导？*

我假设我不想链接主 mdb -> 后端 mdb -> sql server。我是否应该在后端 mdb 上运行向导，然后在前端 mdb 中将链接表更改为指向 sql server 而不是后端 mdb？如果是这样，这是如何完成的？当我右键单击并进入前端表的链接表管理器（链接到后端 md）时，它似乎只让我选择一个新的 mdb 文件。

            回答 #1

赞同：4

时间：2008-10-08T19:32:44.277

我同意您的第一个猜测：您将希望在后端 mdb 上运行该向导。

一旦在 SQL Server 中，也如您所料，您需要链接前端以使用 SQL Server 数据。一种方法是为您的新 SQL Server 数据库设置一个 ODBC 数据源，并在链接表管理器中选择它。

1.  打开数据源 (ODBC) 快捷方式：在 XP Pro 中，它位于管理工具下的控制面板中。（如果您没有看到它，您可能没有创建数据源的权限，因此您必须与您的网络人员合作才能执行此操作。）这将打开 ODBC 管理器。
2.  在文件 DSN 选项卡上，单击添加...。您将看到可用驱动程序的列表。选择 SQL Server，然后单击下一步。（如果前端只在您的机器上使用，您可以创建一个系统 DSN。）
3.  找到一个公共位置并命名您的数据源。
4.  单击下一步并完成。这将设置数据源的第一部分，并将打开 SQL Server 数据源向导。
5.  命名数据源并选择您放置升级后的后端数据库的服务器。
6.  根据需要更改其余设置（您可能不需要更改太多，但这些更改的范围可能需要第二个问题），然后单击完成。

设置好数据源后，Get External Data 应该让您可以选择它作为您的数据源。（在 2007 年，您可以从“外部数据”功能区到达那里。ODBC 数据源在“更多”下可用。）

根据马特的后续问题进一步扩展：

你怎么做是一个设计选择。我建议扩大后端 mdb 的大小，因为这样您就可以保留 Access 中的任何表格等；如果您的数据在 SQL Server 中，我认为这不是一个过渡。

在升迁之前，您的表已链接到后端数据库，并且链接表管理器会显示这些链接。设置 ODBC 数据源并链接这些表后，它将显示该链接。您将以两种不同的方式查看链接，因为它们实际上是不同类型的链接（Access 与 ODBC），即使这些链接在您的前端 mdb 中可能看起来相同。

            回答 #2

赞同：1

时间：2008-10-08T19:39:35.667

就我个人而言，我发现升迁向导在确定正确的数据类型方面做得非常糟糕。我会使用我需要的数据类型在 SQL Server 中自己创建表，然后将数据从 Access 移动到现有表中。否则，当您真正需要小数时可以使用 varchar 或 float 时，您将被文本数据困住。

移动数据后，我将删除 Access 表并链接到 SQL Server 表。

如果没有数据库的备份副本，请不要做任何事情。

            回答 #3

赞同：0

时间：2008-10-08T19:25:34.963

作为一个标准的偏执狂，我只会制作现有文件的备份副本并在前端运行升迁向导。如果发生任何不希望的事情，只需通过使用备份副本覆盖来恢复更改。

            回答 #4

赞同：0

时间：2010-07-12T04:22:50.590

更新前端，它会在升迁之前导入后端表。一周前我做了这个，结果很成功。

但是，任何使用 -1 而不是 Yes 的查询都将失败。在没有主键的表上删除任何完整的表都将失败，并且您将获得与仅使用传递 SQL 查询截断表不同的行为。trunc 将删除所有行，Access 版本可能会留空。

此外，您需要在具有自动编号列数据类型的表上打开记录集的任何地方包含 dbSeeChanges。SQL 将这些更改为身份数据类型，然后在您尝试打开表之前抱怨。祝你好运。

            回答 #5

赞同：0

时间：2021-04-12T17:32:30.383

在前端做这一切
您可以简单地将表导出到 SQL Server。
然后，您可以删除前端中的链接表。
然后将连接链接到 SQL Server
查看：

*   当您打开表格时，您会获得记录
*   您的所有查询都运行
*   编译你的代码

您还必须考虑如何发布前端。如果您使用的是 dsn 文件，则需要将其提供给每个用户。
您将需要确定最终用户如何访问 SQL Server。您是否使用存储在连接中的用户名和密码进行单一登录？
您还可以将后端数据库拆分为多个 Access 数据库并将它们链接到前端。

        cocoa - NSOperation main 中的 NSAutoreleasePool？

ID：184409

赞同：25

时间：2008-10-08T19:16:18.087

标签：cocoa, cocoa-touch, multithreading

的文档`+[NSThread detachNewThreadSelector:toTarget:withObject:]`说：

对于非垃圾收集的应用程序，该方法`aSelector`负责为新分离的线程设置一个自动释放池，并在它退出之前释放该池。

`NSAutoreleasePool`我的问题是，我是否需要在我的方法覆盖中创建自己的`-[NSOperation main]`，或者是由`NSAutoreleasePool`处理的创建`NSOperation`？

            回答 #1

赞同：14

时间：2010-02-04T22:06:17.110

好问题，即使苹果自己的文档和示例代码对此也不是很清楚。我相信我已经找到了答案：

因为操作是 Objective-C 对象，你应该总是在你的任务代码实现的早期创建一个自动释放池。自动释放池可防止在任务执行期间自动释放的 Objective-C 对象泄漏。尽管在执行您的自定义代码时可能已经有一个池，但您永远不应依赖该行为，而应始终提供自己的行为。

基本上，即使大卫提到可能有一个池，您仍然应该创建自己的池。

            回答 #2

赞同：12

时间：2008-10-08T20:01:19.163

是的你是。您正在定义一个独立的工作， NSOperationQueue 将在“某个”线程上执行，因此您负责管理该工作中的内存。

            回答 #3

赞同：6

时间：2008-12-01T23:13:25.873

您无需在主程序中创建自己的 NSAutoreleasePool，系统会为您完成。要查看这一点，请使用 Xcode 菜单命令 Run > Show> Breakpoints 打开 Breakpoints 窗口并输入：-[NSAutoreleasePool init]

现在运行你的程序，你会看到在 NSOperation 中创建了一个自动释放池。

另请参阅 Apple 的示例，例如[http://developer.apple.com/Cocoa/managingconcurrency.html](http://developer.apple.com/Cocoa/managingconcurrency.html)不创建自己的自动释放池。

            回答 #4

赞同：2

时间：2008-10-09T04:39:17.713

是的，您需要`NSAutoreleasePool`在您的`[NSOperation main]`方法中创建一个，除非您正在创建一个“并发”（有点不幸的命名法）`NSOperation`子类，并且您的覆盖`[NSOperation start]`方法`NSAutoreleasePool`在调用 `[NSOperation main] 之前创建。

类文档对所有这些`NSOperation`都有很好的描述：http:
 [//developer.apple.com/documentation/Cocoa/Reference/NSOperation_class/Reference/Reference.html](http://developer.apple.com/documentation/Cocoa/Reference/NSOperation_class/Reference/Reference.html)。

            回答 #5

赞同：0

时间：2009-10-22T09:55:43.030

是的，你需要。

```
- (void) main
{
  NSAutoreleasePool *thePool = [[NSAutoreleasePool alloc] init];
  //your code here
  //more code
  [thePool release];
} 
```

如果你不创建自动释放池，任何方便的类初始化器（如 [NSString stringWithFormat:]）都会泄漏，因为这些初始化器返回自动释放的对象。

        delphi - 在 Delphi 中执行自动取消选中按钮的操作

ID：184414

赞同：3

时间：2008-10-08T19:17:03.107

标签：delphi, button, taction

当按下 TSpeedButton 时，我想执行一个操作，而当“未按下”同一个按钮时，我想执行另一个操作。我知道没有 onunpress 事件，但是当按下不同的按钮时，有什么简单的方法可以让我执行一个动作吗？

```
procedure ActionName.ActionNameExecute(Sender: TObject);
begin
  PreviousActionName.execute(Sender);
  //
end; 
```

显得太笨重了。

            回答 #1

赞同：5

时间：2008-10-08T19:45:01.663

没有 unpress，但是可以查询 Down 属性。

该示例采用了一些脏强制转换，但它对动作和 OnClick 都有效。

```
procedure Form1.ActionExecute(Sender: TObject);
var
  sb : TSpeedButton;
begin
  if Sender is TSpeedButton then
    sb := TSpeedButton(Sender)
  else if (Sender is TAction) and (TAction(Sender).ActionComponent is TSpeedButton) then
    sb := TSpeedButton(TAction(Sender).ActionComponent)
  else 
    sb := nil;

  if sb=nil then
    DoNormalAction(Sender)
  else if sb.Down then
    DoDownAction(sb)
  else 
    DoUpAction(sb);
end; 
```

            回答 #2

赞同：5

时间：2008-10-08T20:23:22.303

根据您的描述，我想您将您的速度按钮与 GroupIndex <>0 一起使用，但在同一组中没有其他按钮，或者至少不能用作 RadioButtons（AllowAllUp True）。  

您只有 1 个用于按下按钮的 onClick 事件，但如果按钮具有 GroupIndex，该怎么做取决于按钮的状态。

因此，您必须在 onClick 事件处理程序中测试 Down 是否为 False，因为 Down 在 onClick 处理程序被触发之前更新。  

前任：

```
procedure TForm1.SpeedButton1Click(Sender: TObject);
begin
  with Sender as TSpeedButton do
  begin
    if Down then
      showmessage('pressing')
    else
      showmessage('unpressing');
  end;
end; 
```

        c# - Outlook PropertyFrom MAPI Schema Property ID

ID：184427

赞同：0

时间：2008-10-08T19:20:01.633

标签：c#, outlook, exchange-server, mapi

I am looking to get the actual property name from a MAPI schema property. I'm obtaining the MAPI Schema property "[http://schemas.microsoft.com/mapi/proptag/0x67AA000B](http://schemas.microsoft.com/mapi/proptag/0x67AA000B)" but I would like to know what field this corresponds to (I.E. Anniversary, BusinessAddress, etc). Any insight would be appreciated.

            回答 #1

赞同：3

时间：2008-10-09T17:59:22.967

This link to MSDN provides a table which shows the allocation of particular tag range values to an assigned purpose [MAPI Property Tag Table](http://msdn.microsoft.com/en-us/library/ms527392(EXCHG.10).aspx).

The table indicates that 0x67aa000b is in the following range:

```
0x6600  0x67FF  Provider-defined internal non-transmittable property 
```

The value 0x000b indicates this is a Boolean type.

I presume the provider in this case is Exchange Server? Unfortunately I've been unable to locate a description of this property tag's meaning.

        xml - 将 XML 转换为纯文本 - 我应该如何忽略/处理 XSLT 中的空格？

ID：184431

赞同：36

时间：2008-10-08T19:22:47.463

标签：xml, xslt, whitespace, dokuwiki

我正在尝试使用 XSLT 将 XML 文件转换为 dokuwiki 使用的标记。这实际上在某种程度上有效，但是 XSL 文件中的缩进被插入到结果中。目前，我有两个选择：完全放弃这个 XSLT 东西，并找到另一种从 XML 转换为 dokuwiki 标记的方法，或者从 XSL 文件中删除大约 95% 的空白，使其几乎不可读并且是维护的噩梦。

有什么方法可以在不将所有空格传递到最终文档的情况下保留 XSL 文件中的缩进吗？

背景：我正在将一个 autodoc 工具从静态 HTML 页面迁移到 dokuwiki，因此每当应用程序团队遇到文档记录不佳的代码时，应用程序团队可以进一步记录由服务器团队开发的 API。逻辑是为自动文档工具留出每个页面的一部分，并允许在此块之外的任何地方进行评论。我使用 XSLT 是因为我们已经有 XSL 文件可以从 XML 转换为 XHTML，而且我假设重写 XSL 比从头开始推出我自己的解决方案要快。

*编辑：啊，对，愚蠢的我，我忽略了缩进属性。（其他背景说明：我是 XSLT 的新手。）另一方面，我仍然需要处理换行符。Dokuwiki 使用管道来区分表格列，这意味着表格行中的所有数据必须在一行中。有没有办法抑制输出换行符（只是偶尔），所以我可以以某种可读的方式为每个表格单元格做一些相当复杂的逻辑？*

            回答 #1

赞同：77

时间：2008-10-08T21:46:07.470

在 XSLT 转换的结果中出现不需要的空白有三个原因：

1.  来自源文档中节点之间的空白
2.  来自源文档中节点内的空格
3.  来自样式表的空格

我将讨论所有这三个，因为很难分辨空白的来源，因此您可能需要使用多种策略。

要解决源文档中节点之间的空白，您应该使用`<xsl:strip-space>`去除出现在两个节点之间的任何空白，然后使用`<xsl:preserve-space>`保留可能出现在混合内容中的重要空白。例如，如果您的源文档如下所示：

```
<ul>
  <li>This is an <strong>important</strong> <em>point</em></li>
</ul> 
```

那么你会想要忽略`<ul>`and 和 the之间`<li>`的空白，这并不重要，但保留and元素之间的空白，这*很*重要（否则你会得到“这是一个**重要的** *观点*”）。为此，请使用`</li>``</ul>``<strong>``<em>` *```
<xsl:strip-space elements="*" />
<xsl:preserve-space elements="li" /> 
```

`elements`on 属性`<xsl:preserve-space>`基本上应该列出文档中具有混合内容的所有元素。

> 另外： using`<xsl:strip-space>`还减少了内存中源树的大小，并使您的样式表更有效率，因此即使您没有此类空白问题，也值得这样做。

要解决源文档中节点内出现的空白，您应该使用`normalize-space()`. 例如，如果您有：

```
<dt>
  a definition
</dt> 
```

并且您可以确定该`<dt>`元素不会包含您想要使用的任何元素，那么您可以执行以下操作：

```
<xsl:template match="dt">
  ...
  <xsl:value-of select="normalize-space(.)" />
  ...
</xsl:template> 
```

前导和尾随空格将从`<dt>`元素的值中删除，您将只得到 string `"a definition"`。

要解决来自样式表的空白（这可能是您遇到的空白），是当您在模板中有这样的文本时：

```
<xsl:template match="name">
  Name:
  <xsl:value-of select="." />
</xsl:template> 
```

XSLT 样式表的解析方式与它们处理的源文档的解析方式相同，因此上述 XSLT 被解释为一棵树，其中包含`<xsl:template>`具有属性的元素，该元素`match`的第一个子节点是文本节点，第二个子节点是`<xsl:value-of>`具有属性的元素`select`。文本节点有前导和尾随空格（包括换行符）；由于它是样式表中的文字文本，因此它会被逐字复制到结果中，并带有所有前导和尾随空格。

但是XSLT 样式表中的*一些*空白会被自动去除，即节点之间的空白。您的结果中没有换行符，因为.`<xsl:value-of>`和`<xsl:template>`.

要在结果中仅获取您想要的文本，请使用如下`<xsl:text>`元素：

```
<xsl:template match="name">
  <xsl:text>Name: </xsl:text>
  <xsl:value-of select="." />
</xsl:template> 
```

XSLT 处理器将忽略出现在节点之间的换行符和缩进，并且只输出`<xsl:text>`元素内的文本。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T19:26:46.300

您在输出标签中使用 indent="no" 吗？

```
<xsl:output method="text" indent="no" /> 
```

此外，如果您使用的是 xsl:value-of，您可以使用 disable-output-escaping="yes" 来帮助解决一些空白问题。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2011-01-16T05:01:57.063

@JeniT 的回答很棒，我只想指出一个管理空白的技巧。我不确定这是最好的方法（甚至是好方法），但它现在对我有用。

（“s”代表空格，“e”代表空，“n”代表换行。）

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xsl:transform [
  <!ENTITY s "<xsl:text xmlns:xsl='http://www.w3.org/1999/XSL/Transform'> </xsl:text>" >
  <!ENTITY s2 "<xsl:text xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>  </xsl:text>" >
  <!ENTITY s4 "<xsl:text xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>    </xsl:text>" >
  <!ENTITY s6 "<xsl:text xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>      </xsl:text>" >
  <!ENTITY e "<xsl:text xmlns:xsl='http://www.w3.org/1999/XSL/Transform'></xsl:text>" >
  <!ENTITY n "<xsl:text xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>
</xsl:text>" >
]>

<xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema">
<xsl:output method="text"/>
<xsl:template match="/">
  &e;Flush left, despite the indentation.&n;
  &e;  This line will be output indented two spaces.&n;

      <!-- the blank lines above/below won't be output -->

  <xsl:for-each select="//foo">
    &e;  Starts with two blanks: <xsl:value-of select="@bar"/>.&n;
    &e;  <xsl:value-of select="@baz"/> The 'e' trick won't work here.&n;
    &s2;<xsl:value-of select="@baz"/> Use s2 instead.&n;
    &s2;    <xsl:value-of select="@abc"/>    <xsl:value-of select="@xyz"/>&n;
    &s2;    <xsl:value-of select="@abc"/>&s;<xsl:value-of select="@xyz"/>&n;
  </xsl:for-each>
</xsl:template>
</xsl:transform> 
```

应用于：

```
<?xml version="1.0" encoding="UTF-8"?>
<foo bar="bar" baz="baz" abc="abc" xyz="xyz"></foo> 
```

输出：

```
Flush left, despite the indentation.
  This line will be output indented two spaces.
  Starts with two blanks: bar.
baz The 'e' trick won't work here.
  baz Use s2 instead.
  abcxyz
  abc xyz 
```

'e' 技巧在包含至少一个非空白字符的文本节点之前起作用，因为它扩展为：

```
<xsl:template match="/">
  <xsl:text></xsl:text>Flush left, despite the indentation.<xsl:text>
</xsl:text> 
```

由于[去除空格的规则](http://www.w3.org/TR/xslt#strip)表明只有空格的文本节点会被去除，所以 <xsl:template> 和 <xsl:text> 之间的换行符和缩进会被去除（很好）。由于规则说至少保留一个空白字符的文本节点，因此包含的隐式文本节点`"  This line will be output indented two spaces."`保留其前导空白（但我想这也取决于剥离/保留/规范化的设置）。然后;” 在行尾插入换行符，但它也确保忽略任何后续空格，因为它出现在两个节点之间。

我遇到的问题是当我想输出一个以 <xsl:value-of> 开头的缩进行时。在这种情况下，“&e;” 不会有帮助，因为缩进空格没有“附加”到任何非空格字符。所以对于这些情况，我使用“&s2;” 或“&s4;”，取决于我想要多少缩进。

我敢肯定，这是一个丑陋的 hack，但至少我的 XSLT 中没有冗长的“<xsl:text>”标签，至少我仍然可以缩进 XSLT 本身，使其清晰易读。我觉得我在滥用 XSLT 来实现它不是为它设计的东西（文本处理），这是我能做的最好的事情。

* * *

**编辑：**
回应评论，这是没有“宏”的样子：

```
<xsl:template match="/">
  <xsl:text>Flush left, despite the indentation.</xsl:text>
  <xsl:text>  This line will be output indented two spaces.</xsl:text>
  <xsl:for-each select="//foo">
    <xsl:text>  Starts with two blanks: </xsl:text><xsl:value-of select="@bar"/>.<xsl:text>
</xsl:text>
    <xsl:text>    </xsl:text><xsl:value-of select="@abc"/><xsl:text> </xsl:text><xsl:value-of select="@xyz"/><xsl:text>
</xsl:text>
  </xsl:for-each>
</xsl:template> 
```

我认为这使得看到预期的输出缩进变得不太清楚，并且它搞砸了 XSL 本身的缩进，因为`</xsl:text>`结束标记必须出现在 XSL 文件的第 1 列（否则你会在输出文件中得到不需要的空格）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:07:49.547

关于您对新行的编辑，您可以使用此模板在另一个字符串中递归替换一个字符串，并且可以将其用于换行符：

```
<xsl:template name="replace.string.section">
  <xsl:param name="in.string"/>
  <xsl:param name="in.characters"/>
  <xsl:param name="out.characters"/>
  <xsl:choose>
    <xsl:when test="contains($in.string,$in.characters)">
      <xsl:value-of select="concat(substring-before($in.string,$in.characters),$out.characters)"/>
      <xsl:call-template name="replace.string.section">
        <xsl:with-param name="in.string" select="substring-after($in.string,$in.characters)"/>
        <xsl:with-param name="in.characters" select="$in.characters"/>
        <xsl:with-param name="out.characters" select="$out.characters"/>
      </xsl:call-template>
    </xsl:when>
    <xsl:otherwise>
      <xsl:value-of select="$in.string"/>
    </xsl:otherwise>
  </xsl:choose>
</xsl:template> 
```

如下调用它（此示例将 $some.string 变量中的换行符替换为空格）：

```
 <xsl:call-template name="replace.string.section">
        <xsl:with-param name="in.string" select="$some.string"/>
        <xsl:with-param name="in.characters" select="'&#xA;'"/>
        <xsl:with-param name="out.characters" select="' '"/>
    </xsl:call-template> 
```

# ruby-on-rails - Rails 应用程序的税务服务建议？

> ID：184435
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2008-10-08T19:24:08.723
> 
>         
> 
> 标签：ruby-on-rails, ruby, avalara

我正在开发一个需要计算税款的购物车，并且正在寻找第三方税务服务来处理计算。  

我在另一个应用程序中使用过 Avalara，但由于我必须将 Rjb gem 与他们的 java 库一起使用，所以有点悲惨。

有没有人推荐与 Rails 配合得很好的税务服务？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-10T20:18:45.280

我不知道库中有哪些税务计算功能，但 ActiveMerchant 是一个非常棒的电子商务应用程序实用程序。它有据可查，并且正在积极开发中。

它的各种支付处理器可能会为您提供所需的计算。

[http://www.activemerchant.org/](http://www.activemerchant.org/)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2011-07-30T15:35:52.890

我们在应用程序中使用[StrikeIron](http://strikeiron.com/)。

老实说，它*并不是*最棒的交互界面（除非你真的喜欢 SOAP）。当然，您仍然需要处理应用程序中的所有税收逻辑，但如果您需要按州、县和市划分的税率，它应该可以很好地满足您的需求。

话虽如此，我还没有找到与 Rails™ 相关的税务服务。我很想知道其他人对此会怎么说。

# ms-access - 访问更改表“允许零长度”

> ID：184436
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-08T19:24:35.900
> 
>         
> 
> 标签：ms-access

我正在使用旧的 Access 数据库（是的，它非常丑陋，我讨厌它）。我需要修改我正在创建的 VB 应用程序中的一些列。我已经正确设置了大部分修改，但我正在与将列修改为文本使其默认为“允许零长度”为假的事实作斗争。

SO ALTER TABLE [Applicant Table] ALTER COLUMN [Applicant ID] Text(255)

我需要该更改将“允许零长度”设置为真。

我试过 ALTER TABLE [Applicant Table] ALTER COLUMN [Applicant ID] Text(255) NULL

但这似乎也不起作用。我已经到处寻找解决方案，但似乎无法找到一个直接的答案。

有任何想法吗？

谢谢，瑞恩。

* * *

谢谢（你的）信息。我很高兴它是 Access 而不是我。

我想我只是想破解这个应用程序，因为无论如何整个数据模型都是垃圾。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T19:57:01.747

此选项不适用于 Jet sql。您可以在 Access gui 或使用 vba 代码中执行此操作。例子：

```
Public Function setAllowZeroLenStr()    
    On Error GoTo Proc_Err

    Dim db As Database
    Dim tbl As TableDef
    Dim fld As DAO.Field

    Set db = CurrentDb
    Set tbl = db.TableDefs![Applicant Table]
    Set fld = tbl.Fields![Applicant ID]
    fld.AllowZeroLength = True

Proc_Exit:    
    Set fld = Nothing
    Set tbl = Nothing
    Set db = Nothing

    Exit Function

Proc_Err:    
    MsgBox Err.Number & vbCrLf & Err.Description
    Err.Clear
    Resume Proc_Exit    
End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T20:37:31.230

我同意：此设置没有 ACE/Jet 语法。如果你仔细想想，SQL DLL 往往是标准的“可移植”东西，大多数 SQL 产品都可以实现。大多数 SQL 没有明确的 (Dis)AllowZeroLength 功能，因此它没有成为标准，因此不在 ACE/Jet 语法中。

FWIW 也适用于 ACE/Jet 的“便携式”解决方案是使用 CHECK 约束，例如：

```
ALTER TABLE [Applicant Table] ADD
   CONSTRAINT Applicant_ID__not_zero_length 
      CHECK (LEN([Applicant ID]) > 0); 
```

允许零长度值将不需要首先创建 CHECK 约束（!!），或者`DROP`如果它已经存在，则不需要创建它......但是你为什么要允许标识符（“申请人 ID”）无论如何都是零长度?

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T19:51:38.623

很久以前，我想做同样的事情，而 ISTR 认为它根本不可能从 DDL/SQL 中实现 - 但您可以通过定位字段 (table.fields) 并将 AllowZeroLength 设置为所需值从 VBA 中做到这一点

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2012-08-30T09:44:34.233

使用 Interop.ACCDBLIB

试试这个：

```
 DBLib dbLib = new DBLib();
    dbLib.ConnectionString = ConnectionString;
    dbLib.Initialize(); 
    dbLib.ModifyTextFieledSetAllowZeroLength(ref TableName, ref FiledName); 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2021-02-19T02:00:12.510

```
Sub SetUpTempDbExample()
' Set up a temp database for running report data into.
' Temp DB is killed and re-created on demand (saves having to compact and repair in primary DB).
' Temp table can be relinked to primary DB for further querying
Dim dbTemp As Database
Dim tblTemp As TableDef
Dim idxTemp As Index, idxTemp2 As Index
Const cTempPath = "C:\temp\"
Const cTempDB = "TempReportData"

    '  Delete old temp database (if db is in use, Kill will fail. Resume gracefully.)
    On Error Resume Next
    If Dir(cTempPath & cTempDB) <> "" Then Kill (cTempPath & cTempDB)

    On Error GoTo ErrHandler

    ' Create a new temp DB.
    Set dbTemp = CreateDatabase(cTempPath & cTempDB, dbLangGeneral)

    Set tblTemp = dbTemp.CreateTableDef("TEMP_SAMPLES")

    With tblTemp
        .Fields.Append .CreateField("SAMPLE_ID", dbDouble)
        .Fields.Append .CreateField("SITE_ID", dbText, 38)
        .Fields.Append .CreateField("SAMPLE_DATE_TIME", dbDate)
        .Fields.Append .CreateField("METHOD", dbText, 20)
        .Fields.Append .CreateField("MATRIX", dbText, 20)
        .Fields.Append .CreateField("COMMENT", dbText, 255)
        .Fields![COMMENT].AllowZeroLength = True
        Set idxTemp = .CreateIndex("SAMPLE_ID")
        idxTemp.Fields.Append .CreateField("SAMPLE_ID")
        idxTemp.Primary = True
        Set idxTemp2 = .CreateIndex("SITE_ID")
        idxTemp2.Fields.Append .CreateField("SITE_ID")
    End With
    dbTemp.TableDefs.Append tblTemp
    tblTemp.Indexes.Append idxTemp
    tblTemp.Indexes.Append idxTemp2

    Set tblTemp = Nothing
    Set idxTemp = Nothing
    Set dbTemp = Nothing

ExitSub:
    Exit Sub

ErrHandler:
    MsgBox Err.Description & " (" & Err.Number & ")"
    Resume ExitSub
End Sub 
```

# apache-flex - Mate actionscript 唯一版本，它存在吗？

> ID：184443
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-08T19:25:43.980
> 
>         
> 
> 标签：apache-flex, actionscript-3, mate

嘿，我正在考虑使用 Mate，但我从事的项目不需要 Flex 框架的大部分功能。我的同事说他听说过一个 Actionscript 版本，但我在主站点上找不到有关此的信息，只是他们删除了对 Flex 框架的一些依赖项。

有谁知道他们是否正在努力将 Mate 推向可以在没有 Flex 框架的情况下使用的状态？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-09T05:53:26.490

Mate 大量使用标签，因此它依赖于 Flex。有一些方法可以在没有 Flex 框架的情况下使用标签，但在 Mate 中有一些地方我们使用框架类。尝试删除这些依赖项需要一些努力，虽然这是我们想要调查的事情，但我认为它不会很快发生，除非其他人接管该任务:)

# c++ - EnumPorts() 在某些机器上返回奇怪的错误

> ID：184448
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T19:26:42.993
> 
>         
> 
> 标签：c++, winapi

我维护了一个应用程序，它使用 win32 EnumPorts() 函数来帮助确定计算机上安装的串行端口集。我在某些计算机上看到了获取此信息的调用失败的情况，GetLastError() 代码为 1722（RPC 服务器不可用）。我认为这与注册表设置或所需服务被禁用有关，但到目前为止我的搜索相当无结果。还有其他人遇到过这个问题吗？

回应 Euro Micelli 的评论。我特别试图填写一个允许用户选择可用选项列表的选项列表。首先，我完全依赖 EnumPorts() 来为我提供一个可能的串行端口名称列表。它已被证明是不可靠的，但在几个方面：它并不总是提供完整的端口名称集，而且，正如我最近看到的，当“RPC 服务不可用”时，它可能完全无法运行。为什么需要 RPC 来找出本地计算机上可用的端口完全超出了我的范围，但它确实存在。后一个问题是最后一根稻草。就完全依赖提供的名称列表而言，我使用 GetDefaultCommConfig() 函数过滤这些名称以确定我想出的每个名称的确切性质。

根据我的经验，前面提到的注册表项提供的名称列表是获取端口名称的最可靠方法。事实上，当我在设备设备管理器中禁用端口驱动程序时，我可以看到密钥得到更新。在正常经验下，我同意依赖特定密钥充满危险的评估。然而，在这种情况下，M$ 从来没有提供一个体面的机制来评估可用端口的名称。

我应该指出，我已经用扫描注册表项的算法替换了对 EnumPorts() 的调用：HKEY_LOCAL_MACHINE\HARDWARE\DEVICEMAP\SERIALCOMM 以获取串行端口名称。一旦我的软件发布，这应该可以解决问题。我所追求的是可以给目前正在使用已发布包的客户的指针。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-17T01:14:11.293

我不是 EnumPorts 方面的专家，但我强烈建议不要依赖注册表项。

*   未来的关键定义可能会发生变化。

*   关键定义可能不是你想的那样。

*   可能有一些方法可以“成为串行端口”，但不包括这些键。

*   密钥可能无法反映最新状态等。

您应该始终依赖可用的 API。

如果某个 API 不适合您，让我们尝试找出原因。也许通过一些额外的信息，我们可以提供更好的帮助：

您需要对串行端口做什么？

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T22:24:03.837

我知道这不是您问题的直接答案，但是您是否考虑过使用不同的方法来枚举串行端口？在我的应用程序中，我使用 Setup API，使用 PJ Naughter 网站的代码：http: [//www.naughter.com/enumser.html](http://www.naughter.com/enumser.html)，我发现它运行良好。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T19:42:25.957

现在有很多奇怪的串口：USB 串口线、蓝牙、带 GPS 的手机调制解调器……它可能是插在电脑上的东西，从那以后就被遗忘了。

要找出导致问题的端口，您可以尝试进入设备管理器，在“查看”选项卡中选择“显示隐藏的设备”并删除它们，直到问题消失。这可能会让你在问题上归零。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2014-08-11T01:39:57.710

我知道这个问题非常古老，但是我今天偶然发现了它，发现没有人给出解释。

使用 RPC 的原因是因为您正在调用后台处理程序函数 - 您要求打印后台处理程序返回打印机端口列表，在大多数情况下，该列表恰好包括 COM 端口。我相信这可以解释你稍微不可靠的结果。

RPC 用于将请求从您的进程传递到活动的后台处理程序进程，并且`RPC Server is unavailable`当后台处理程序服务未运行（或未正确响应）时出现消息。

# sql - MS-SQL 中是否有等效于 SHA1() 的方法？

> ID：184456
> 
>         
> 
> 赞同：37
> 
>         
> 
> 时间：2008-10-08T19:30:02.910
> 
>         
> 
> 标签：sql, mysql, sha1, tsql, sql-server

将几个存储过程从 MySQL 转换为 Microsoft SQL 服务器。一切都很顺利，除了一个程序使用了 MySQL`SHA1()`函数。我似乎在 MS-SQL 中找不到与此等效的东西。

有谁知道`SHA1()`MS-SQL 上的有效等效项？

* * *

## 回答 #1

> 赞同：51
> 
>             
> 
> 时间：2008-10-08T19:31:54.793

SQL Server 2005 及更高版本具有[HashBytes()](http://msdn.microsoft.com/en-us/library/ms174415.aspx)函数。

* * *

## 回答 #2

> 赞同：30
> 
>             
> 
> 时间：2012-08-31T01:44:03.540

如果你想得到一个 SHA1 哈希，就像 MySQL 生成的一样（即作为一个 varchar），你可以将 HashBytes 与 sys.fn_varbintohexsubstring 结合起来。例如

```
SELECT sys.fn_varbintohexsubstring(0, HashBytes('SHA1', 'password'), 1, 0) 
```

有关详细信息，请参阅[http://accessrichard.blogspot.co.nz/2010/12/sql-server-and-net-equivalent-to-php.html 。](http://accessrichard.blogspot.co.nz/2010/12/sql-server-and-net-equivalent-to-php.html)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T19:34:20.450

来自谷歌群组 -[一种可能性](http://groups.google.de/group/microsoft.public.sqlserver.programming/browse_thread/thread/caf7e350f09c5689/16b6f95a74eda0ce)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2011-02-07T13:02:19.957

您可能还想查看[http://www.stev.org/post/2011/01/30/MS-SQL-SHASum-Support.aspx](http://www.stev.org/post/2011/01/30/MS-SQL-SHASum-Support.aspx)您应该能够对其进行修改以生成您想要的任何内容。虽然可能需要一些 c# 编码。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2021-01-28T09:06:19.603

MSSQL 服务器

```
HASHBYTES('SHA1', CAST('abcd@#' as nvarchar(max)))
CONVERT(VARCHAR(MAX), HASHBYTES('SHA1', CAST('abcd@#' as nvarchar(max))) , 2)

/* result */
0x77DD873DBAB2D81786AB9AE6EA91B1F59980E48C  
77DD873DBAB2D81786AB9AE6EA91B1F59980E48C 
```

C＃

```
using (SHA1Managed sha1 = new SHA1Managed())
{
    string input = "abcd@#";
    var hash = sha1.ComputeHash(Encoding.Unicode.GetBytes(input));
    var sb = new StringBuilder(hash.Length * 2);

    foreach (byte b in hash)
    {
        sb.Append(b.ToString("X2")); // can be "x2" if you want lowercase
    }
    return sb.ToString();
}
//result "77DD873DBAB2D81786AB9AE6EA91B1F59980E48C" 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T19:34:39.937

我不相信有本地支持，但你可能想看看这个......

[http://blogs.msdn.com/sqlcat/archive/2005/09/16/469257.aspx](http://blogs.msdn.com/sqlcat/archive/2005/09/16/469257.aspx)

# c# - 多个数据库更新：

> ID：184471
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-08T19:33:11.717
> 
>         
> 
> 标签：c#, .net, sql-server

替换问题：[将多行更新到 SQL 表中](https://stackoverflow.com/questions/184096/update-multiple-rows-into-sql-table)

这是用于更新考试结果集的代码片段。数据库结构是给定的，但我可以提交存储过程以供包含（修改起来很痛苦，所以我把它保存到最后。）

问题：有没有更好的方法使用 SQL server v 2005.,net 2.0 ？

```
string update = @"UPDATE dbo.STUDENTAnswers 
                              SET ANSWER=@answer
                              WHERE StudentID =@ID and QuestionNum =@qnum";
            SqlCommand updateCommand = new SqlCommand( update, conn );
            conn.Open();

            string uid = Session["uid"].ToString();
            for (int i= tempStart; i <= tempEnd; i++)
            {
                updateCommand.Parameters.Clear();
                updateCommand.Parameters.AddWithValue("@ID",uid);
                updateCommand.Parameters.AddWithValue("@qnum",i);
                updateCommand.Parameters.AddWithValue("@answer", Request.Form[i.ToString()]);
                try
                {
                    updateCommand.ExecuteNonQuery();
                }
                catch { }
            } 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T20:14:23.757

有几件事很突出：

*   您没有显示 SqlConnection 的实例化位置，因此不清楚您是否正确处理它。

*   您不应该在循环中吞下异常 - 最好在顶级异常处理程序中处理它们。

*   您正在通过循环在每次迭代中实例化新参数 - 您可以重用这些参数。

把它放在一起它可能看起来像下面这样（如果你不想使用事务，即不关心某些但不是所有更新是否成功）：

```
using (SqlConnection conn = new SqlConnection(connectionString))
{
    conn.Open();
    using (SqlCommand updateCommand = new SqlCommand(update, conn))
    {
        string uid = Session["uid"].ToString();
        updateCommand.Parameters.AddWithValue("@ID", uid);
        updateCommand.Parameters.AddWithValue("@qnum", i);
        updateCommand.Parameters.Add("@answer", System.Data.SqlDbType.VarChar);
        for (int i = tempStart; i <= tempEnd; i++)
        {
            updateCommand.Parameters["@answer"] = Request.Form[i.ToString()];
            updateCommand.ExecuteNonQuery();
        }
    }
} 
```

或者使用事务来确保全部或全部：

```
using (SqlConnection conn = new SqlConnection(connectionString))
{
    conn.Open();
    using (SqlTransaction transaction = conn.BeginTransaction())
    {
        using (SqlCommand updateCommand = new SqlCommand(update, conn, transaction))
        {
            string uid = Session["uid"].ToString();
            updateCommand.Parameters.AddWithValue("@ID", uid);
            updateCommand.Parameters.AddWithValue("@qnum", i);
            updateCommand.Parameters.Add("@answer", System.Data.SqlDbType.VarChar);
            for (int i = tempStart; i <= tempEnd; i++)
            {
                updateCommand.Parameters["@answer"] = Request.Form[i.ToString()];
                updateCommand.ExecuteNonQuery();
            }
            transaction.Commit();
        }
    } // Transaction will be disposed and rolled back here if an exception is thrown
} 
```

Finally, another problem is that you are mixing UI code (e.g. Request.Form) with data access code.  It would be more modular and testable to separate these - e.g. by splitting your application into UI, Business Logic and Data Access layers.

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:14:04.427

对于 30 次更新，我认为您走在正确的轨道上，尽管关于需要使用周围的评论`updateCommand`是正确的。

我们发现进行批量更新（>100 行）的最佳执行方式是通过`SqlBulkCopy`类到临时表，然后调用存储过程来填充活动表。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T19:46:46.027

我看到的一个问题是您打开连接时。  

我至少会在每次更新之前调用打开，然后在更新后关闭连接。  

如果您的循环需要时间来执行，您的连接将打开很长时间。  

一个很好的规则是在你需要它之​​前永远不要打开你的命令。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T19:47:12.377

[您可以使用OpenXML](http://msdn.microsoft.com/en-us/library/aa276847(SQL.80).aspx)批量插入。创建一个包含所有问题和答案的 xml 文档，并使用它来插入值。

**编辑：**如果您坚持使用当前的解决方案，我至少会将您的 SqlConnection 和 SqlCommand 包装在 using 块中，以确保它们得到处理。

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2008-10-08T19:40:19.427

发出一个针对值表的更新：

```
UPDATE s SET ANSWER=a FROM dbo.STUDENTAnswers s JOIN (
  SELECT 1 as q, 'answer1' as a
  UNION ALL SELECT 2, 'answer2' -- etc...
) x ON s.QuestionNum=x.q AND StudentID=@ID 
```

所以你只需像这样把它放在一起：

```
using(SqlCommand updateCommand = new SqlCommand()) {
  updateCommand.CommandType = CommandType.Text;
  updateCommand.Connection = conn;
  if (cn.State != ConnectionState.Open) conn.Open();

  StringBuilder sb = new StringBuilder("UPDATE s SET ANSWER=a FROM dbo.STUDENTAnswers s JOIN (");
  string fmt = "SELECT {0} as q, @A{0} as a";
  for(int i=tempStart; i<tempEnd; i++) {
    sb.AppendFormat(fmt, i);
    fmt=" UNION ALL SELECT {0},@A{0}";
    updateCommand.Parameters.AddWithValue("@A"+i.ToString(), Request.Form[i.ToString()]);
  }
  sb.Append(") x ON s.QuestionNum=x.q AND StudentID=@ID");
  updateCommand.CommandText = sb.ToString();
  updateCommand.Parameters.AddWithValue("@ID", uid);
  updateCommand.ExecuteNonQuery();
} 
```

这具有作为所有其他无操作的优点（例如，如果您在事务中包装了多个更新）并且运行速度更快，因为：

*   表和相关的索引被查看/更新一次

*   您只需为应用程序和数据库服务器之间的延迟付费一次，而不是每次更新

# .net - PowerShell 泛型集合

> ID：184476
> 
>         
> 
> 赞同：37
> 
>         
> 
> 时间：2008-10-08T19:34:15.303
> 
>         
> 
> 标签：.net, powershell, powershell-1.0

我一直在 PowerShell 中推进 .NET 框架，但遇到了一些我不理解的东西。这工作正常：

```
$foo = New-Object "System.Collections.Generic.Dictionary``2[System.String,System.String]"
$foo.Add("FOO", "BAR")
$foo

Key                                                         Value
---                                                         -----
FOO                                                         BAR 
```

然而，这不会：

```
$bar = New-Object "System.Collections.Generic.SortedDictionary``2[System.String,System.String]"
New-Object : Cannot find type [System.Collections.Generic.SortedDictionary`2[System.String,System.String]]: make sure t
he assembly containing this type is loaded.
At line:1 char:18
+ $bar = New-Object <<<< "System.Collections.Generic.SortedDictionary``2[System.String,System.String]" 
```

他们都在同一个程序集中，所以我错过了什么？

正如答案中所指出的，这几乎只是 PowerShell v1 的一个问题。

* * *

## 回答 #1

> 赞同：83
> 
>             
> 
> 时间：2010-02-04T19:23:31.057

在 PowerShell 2.0 中，创建 a 的新方法`Dictionary`是：

```
$object = New-Object 'system.collections.generic.dictionary[string,int]' 
```

* * *

## 回答 #2

> 赞同：20
> 
>             
> 
> 时间：2008-10-09T03:54:42.190

Dictionary<K,V> 未在与 SortedDictionary<K,V> 相同的程序集中定义。一个在 mscorlib 中，另一个在 system.dll 中。

问题就在于此。PowerShell 中的当前行为是，在解析指定的泛型参数时，如果类型不是完全限定的类型名称，它会假定它们与您尝试实例化的泛型类型位于同一程序集中。

在这种情况下，这意味着它在 System.dll 中寻找 System.String，而不是在 mscorlib 中，因此它失败了。

解决方案是为泛型参数类型指定完全限定的程序集名称。它非常丑陋，但有效：

```
$bar = new-object "System.Collections.Generic.Dictionary``2[[System.String, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.String, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" 
```

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T22:30:19.487

PowerShell 中的泛型存在一些问题。PowerShell 团队的开发人员 Lee Holmes 发布了[这个脚本](http://www.leeholmes.com/blog/CreatingGenericTypesInPowerShell.aspx)来创建泛型。

# php - 在表中输入多个变量，分配给每个适当的记录

> ID：184482
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T19:35:08.810
> 
>         
> 
> 标签：php, mysql

我将数据显示到一个 html 表格中，带有一个带有场地列表的下拉框。每个志愿者将被分配一个场地。我设想能够通过 html 表向下走，并为每个志愿者分配一个场地。下拉框包含他们可以分配到的所有可能的场所。

```
<select>
<option value="1">Setup</option>
<option value="2">Check in</option>
etc...
</select> 
```

然后，一旦我完成了每个志愿者的分配，我想点击提交，它会为每个志愿者分配适当的值。

我该怎么做，我知道怎么做，但一次只能做一个。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T19:43:03.193

更改每个选择的名称，使其包含志愿者 ID：

```
<select name="venues[1]">
<option value="1">Setup</option>
etc...
</select>

<select name="venues[2]">
<option value="1">Setup</option>
etc...
</select>

<select name="venues[3]">
<option value="1">Setup</option>
etc...
</select> 
```

提交后，将在 $_POST 命名场所中有一个表，索引为：1、2、3（beeing 志愿者 id）和每个志愿者选择的值。

现在您可以迭代`$_POST['venues']`数组并保存每个值：

```
foreach ($_POST['venues'] as $volunteer_id => $venue) {
  save_venue_for_volunteer($volunteer_id, $venue);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T19:54:57.710

这是一个非常粗略的示例，说明您如何处理此问题。注意：你的 MySQL 表（假设 MySQL）必须是支持事务的类型（InnoDB 支持，MyISAM 不支持）。

```
<?php

if ( isset( $_POST['venuChoice'] ) )
{
    //  Create a transaction
    mysql_query( 'BEGIN' );

    $failure = false;

    //  Loop over the selections
    foreach ( $_POST['venuChoice'] as $employeeId => $venueId )
    {
        $sql = sprintf(
                'UPDATE table SET columns=%d WHERE id=%d'
            ,   intval( mysql_real_escape_string( $venueId ) )
            ,   intval( mysql_real_escape_string( $employeeId ) )
        );
        if ( ! @mysql_query( $sql ) )
        {
            $failure = true;
            break;
        }
    }

    //  Close out the transaction
    if ( $failure )
    {
        mysql_query( 'ROLLBACK' );
        //  Display and error or something
    } else {
        mysql_query( 'COMMIT' );
    //  Success!
    }
}

?>

<form>
    <select name="venueChoice[1]">
        <option value="1">Setup</option>
        <option value="2">Check in</option>
    </select>
    <select name="venueChoice[2]">
        <option value="1">Setup</option>
        <option value="2">Check in</option>
    </select>
    <select name="venueChoice[3]">
        <option value="1">Setup</option>
        <option value="2">Check in</option>
    </select>

</form> 
```

您还可以对其进行修改以跟踪每个员工当前的地点选择，将其与 POST 数据进行比较，然后仅对实际更改的地点执行 UPDATE 查询。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T19:43:00.123

我想不出任何办法。您可以将多个 SQL 语句放入 1 个 MySQL 查询中：

```
UPDATE volunteer SET venue = 1 WHERE id = 2;
UPDATE volunteer SET venue = 2 WHERE id = 3;
... 
```

我希望有一种方法，但我认为每个查询中的 where 将太不同而无法将其合并为一个。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T02:22:01.847

```
foreach ($_POST['venues'] as $volunteer_id => $venue) {
    save_venue_for_volunteer($volunteer_id, $venue);
}

function save_venue_for_volunteer($volunteer_id, $venue) {
    $result = mysql_query("UPDATE volunteers_2009 SET venue_id='$venue' WHERE id='$volunteer_id'") 
    or die(mysql_error());
} 
```

它将被保存到的表是志愿者_2009，所以它应该是这样的吗？

# .net - 将 XmlNode 从一个 XmlDocument 移动到另一个的直观方法是什么？

> ID：184486
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T19:35:41.103
> 
>         
> 
> 标签：.net, xml, system.xml

我有两个 XmlDocument，我想移动从其中一个文档中选择的 XmlNode 并将其附加到另一个文档中的特定位置。

在文档 2 的适当位置简单地调用 AppendNode(xmlNodeFromDocument1) 的天真直观的方法当然不起作用，因为该方法不负责操作拥有的文档。

在我写这个问题的时候，我终于找到了答案，但是由于我们花了很长时间才在 System.Xml 类中找到它，我想我会把它贴在这里帮助其他人搜索它。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-10-08T19:45:22.083

您需要调用`ImportNode`目标文档以获取与您的目标文档兼容的节点。以下代码说明了它是如何在 C# 中完成的。

```
public void CopyExample()
{

   XmlNode nodeFromDifferentDocument = SelectNodeFromSourceDocument();
   XmlDocument targetDocument = InitializeTargetDocument();
   XmlNode targetParentNode = SelectNodesParentWithinTargetDocument(targetDocument);
   bool shouldDodeepCopy = DoIWantADeepCopy();

   XmlNode copyThatBelongsToTargetDocument = 
      targetDocument.ImportNode(nodeFromDifferentDocument, shouldDoDeepCopy);
   targetParentNode.AppendChild(copyThatBelongsToTargetDocument);

} 
```

# .net - 如何将存储为 oracle blob 的图像存储到 Image 对象中

> ID：184489
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T19:36:49.293
> 
>         
> 
> 标签：.net, ado.net

我正在尝试检索存储在 oracle blob 中的图像并将其放置在新的 System.Drawing.Image 实例中。我知道我可以将流写入磁盘上的 temp.bmp 文件并从那里读取它，但这对我来说还不够 l33t。如何将 blob 对象直接转换为图像？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-09-18T10:04:20.727

假设 ：

*   您正在使用 Microsoft 客户端 ( `System.Data.OracleClient`)。

*   你有一个合适的`OracleConnection`实例（`connection`）。

*   你有一个`OracleCommand`准备好的（`command`，基于`SELECT my_blob FROM my_table WHERE id=xx`）。

这应该是这样的：

```
using (OracleDataReader odr=command.ExecuteReader())
{
    reader.Read();

    if (!dr.IsDBNull(0))
        using (Stream s=(Stream)dr.GetOracleValue(0))
            using (Image image=Image.FromStream(s))
                return Copy(image);
} 
```

副本在哪里

```
public static Image Copy(Image original)
{
    Image ret=new Bitmap(original.Width, original.Height);
    using (Graphics g=Graphics.FromImage(ret))
    {
        g.DrawImageUnscaled(original, 0, 0);
        g.Save();
    }

    return ret;
} 
```

请参阅[我的博客文章](http://macinsoft.blogspot.com/2009/09/beware-image-object.html)和/或[KB 814675](http://support.microsoft.com/?id=814675)，了解为什么需要复制。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T19:57:29.250

我知道这使用 sql 但它应该与您的需求相似

```
Dim cn As SqlConnection = Nothing
        Dim cmd As SqlCommand = Nothing
        Dim da As SqlDataAdapter = Nothing
        Dim ms As MemoryStream = Nothing
        Dim dsImage As Data.DataSet = Nothing
        Dim myBytes() As Byte = Nothing
        Dim imgJPG As System.Drawing.Image = Nothing
        Dim msOut As MemoryStream = Nothing

        Try
            cn = New SqlConnection(ConnectionStrings("conImageDB").ToString)
            cmd = New SqlCommand(AppSettings("sprocGetImage").ToString, cn)
            cmd.CommandType = Data.CommandType.StoredProcedure

            cmd.Parameters.AddWithValue("@dmhiRowno", irowno)

            da = New SqlDataAdapter(cmd)

            dsImage = New Data.DataSet
            da.Fill(dsImage, "image")

            If dsImage.Tables(0).Rows.Count = 0 Then
                Throw New Exception("No results returned for rowno")
            End If
            myBytes = dsImage.Tables(0).Rows(0)("Frontimage")

            ms = New MemoryStream
            ms.Write(myBytes, 0, myBytes.Length)

            imgJPG = System.Drawing.Image.FromStream(ms)

            'Export to JPG Stream
            msOut = New MemoryStream
            imgJPG.Save(msOut, System.Drawing.Imaging.ImageFormat.Jpeg)
            imgJPG.Dispose()
            imgJPG = Nothing
            ms.Close()
            sFrontImage = Convert.ToBase64String(msOut.ToArray())

            dsImage = New Data.DataSet
            da.Fill(dsImage, "image")
            myBytes = dsImage.Tables(0).Rows(0)("Backimage")

            ms = New MemoryStream
            ms.Write(myBytes, 0, myBytes.Length)

            imgJPG = System.Drawing.Image.FromStream(ms)
            sBackImage = Convert.ToBase64String(ms.ToArray)

        Catch ex As System.IO.IOException ' : An I/O error occurs.
            Throw ex
        Catch ex As System.ArgumentNullException ': buffer is null.
            Throw ex
        Catch ex As System.NotSupportedException ': The stream does not support writing. For additional information see System.IO.Stream.CanWrite.-or- The current position is closer than count bytes to the end of the stream, and the capacity cannot be modified.
            Throw ex
        Catch ex As System.ArgumentOutOfRangeException ': offset or count are negative.
            Throw ex
        Catch ex As System.ObjectDisposedException ' : The current stream instance is closed.
            Throw ex
        Catch ex As System.ArgumentException
            Throw ex
        Catch ex As System.Runtime.InteropServices.ExternalException ': The image was saved with the wrong image format
            Throw ex
        Catch ex As Exception
            Throw ex
        Finally
            If cn IsNot Nothing Then
                cn.Close()
                cn.Dispose()
                cn = Nothing
            End If

            If cmd IsNot Nothing Then
                cmd.Dispose()
                cmd = Nothing
            End If

            If da IsNot Nothing Then
                da.Dispose()
                da = Nothing
            End If

            If ms IsNot Nothing Then
                ms.Dispose()
                ms = Nothing
            End If

            If msOut IsNot Nothing Then
                msOut.Close()
                msOut.Dispose()
                msOut = Nothing
            End If

            If dsImage IsNot Nothing Then
                dsImage.Dispose()
                dsImage = Nothing
            End If

            If myBytes IsNot Nothing Then
                myBytes = Nothing
            End If

            If imgJPG IsNot Nothing Then
                imgJPG.Dispose()
                imgJPG = Nothing
            End If

        End Try 
```

此代码为前面的图像拉回一个 tiff 包装的 jpeg，因此代码与后面的图像有点不同。

# java - Java Applet、AWT Refresh、Mac OS X 10.4 上的问题

> ID：184491
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T19:37:14.347
> 
>         
> 
> 标签：java, macos, applet, awt, osx-tiger

我们有一个使用 AWT 构建的 Java Applet。此小程序可让您从硬盘驱动器中选择图片并将它们上传到服务器。该小程序包含一个可滚动的图片列表，可在 Windows、Linux 和 Mac OS X 10.5 中正常运行。我们通过 Java Web Start 或在网页中启动这个小程序。

无论 Java 版本如何（1.4 或 1.5），我们的小程序在 Mac OS X 10.4 中都无法正常运行。您可以在此处找到滚动时错误行为的屏幕截图：

[http://www.lavablast.com/tmp/ui_error.png](http://www.lavablast.com/tmp/ui_error.png)

简而言之，有时当滚动图片时，最终会与应用程序的页眉或页脚重叠。此行为在其他平台上不会发生。在 Mac OS X 10.4 上，它在滚动时会在错误的位置显示图片，如果在该位置绘制图像后刷新屏幕，这不会那么糟糕。但是，应用程序似乎并不知道它绘制不正确，因此不会刷新。

如果窗口被最小化、调整大小甚至移动，应用程序会被刷新，错误定位的元素会消失，应用程序会正常恢复。我花了很长时间试图强制刷新背景图像，但没有成功。（直接重新绘制图像，重新绘制几个面板的所有子项等。）因此，我正在寻找任何可以帮助我在 Mac OS X 10.4 下解决此问题的提示，或者在最坏的情况下，只是模拟一个完整的小程序刷新。

直到最近，一切都与 Java 1.1 兼容，但这在一些地方发生了变化，现在需要 1.4。我不认为这些更改造成了问题，我只是将其作为额外信息提供。如果您对滚动面板的实现细节感兴趣，我会进行调查，但我假设这是一个常见的平台错误，必须知道解决方法。

要重现该问题，请打开以下 Java Web Start 应用程序：
 [http ://www.lavablast.com/tmp/opal-webstart.php.jnlp](http://www.lavablast.com/tmp/opal-webstart.php.jnlp)

选择一个包含大量图像的文件夹并使用滚动条进行播放。在某个时候（相当快），您应该会遇到刷新问题。

编辑：我在这里遵循了第一个建议，并将所有具有背景图像的控件替换为 Swing 等效项，但问题仍然存在。（另外，我还需要做许多其他的修复来进行彻底的改变）。还有其他想法吗？强制完全刷新的简单的一行代码会很棒:)

Edit2：主线程创建面板并启动 X 线程。使用观察者/通知者模式，线程完成并通知主控件，主控件将面板添加到页面。这是通过 EventQueue.invokeLater 完成的，除非我弄错了，否则它应该在正确的线程上运行。即使没有额外的线程正在运行（如在加载期间），滚动时问题也最为严重。  

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-09T11:42:20.140

由于您已经需要 Java 1.4，您应该考虑进行一些小的更改来使用 SWING GUI，它解决了我们使用 AWT 刷新 Applet 的问题。（Mac、Linux 等）

如果您有例如 Panel，则需要将其替换为 JPanel 等。  

你需要这个：

```
import javax.swing.*; 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-13T22:19:01.337

它看起来确实像将轻量级（通常是 Swing）和重量级（AWT）组件混合在一起。转移到 Swing，您需要替换所有最后一个 AWT 组件 Swing 等效项（提示：避免导入 java.awt.*）。

线程通常是奇怪错误的潜在问题。在 EDT 上必须始终使用 Swing 组件（使用`java.awt.EventQueue.invokeLater`）。AWT 在理论上是线程安全的，但在实践中并非如此 - 也限制了 EDT 的使用。

# linux - 在 unix/linux 系统上，如何了解有关 mylib.a 存档的更多信息？

> ID：184502
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-08T19:40:12.763
> 
>         
> 
> 标签：linux, unix, archive

在这种特殊情况下，我试图发现 mylib.a 文件是 32 位还是 64 位兼容的。我对共享对象 (mylib.so) 的 ldd 很熟悉，但是如何检查常规的 .a 存档？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2008-10-08T19:43:49.653

“nm”和“ar”将为您提供有关图书馆档案的一些信息。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-10-08T20:04:15.163

```
$ objdump -G /usr/lib/libz.a
在存档 /usr/lib/libz.a 中：

adler32.o：文件格式elf32-i386

...

$ objdump -G /usr/lib64/libz.a
在存档 /usr/lib64/libz.a 中：

adler32.o：文件格式elf64-x86-64

...

$ objdump -G /ppc-image/usr/lib/libz.a
在存档 /ppc-image/usr/lib/libz.a 中：

adler32.o：文件格式 elf32-powerpc

...
```

需要一个 multilib-capable `binutils`，但它非常简单，不是吗？

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T19:52:29.243

标准的“nm”和“ar”实用程序将为您提供有关存档的信息。

要了解存档的 32/64 位功能，请使用“ar”提取 mylib.a 中的 .o 文件，然后在 .o 文件上运行“file”以发现它们的类型，包括 32/64 位用法。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T19:49:17.770

在一般情况下，我只使用“文件”实用程序。

# .net - 使用 WPF 创建类似于 Windows 资源管理器的 GUI

> ID：184511
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-08T19:41:50.217
> 
>         
> 
> 标签：.net, wpf, user-interface

您将如何实现类似于 Windows 资源管理器中“我的电脑”视图的 GUI？

特别是“图标”视图模式。包括不同项目类型的分组（如存储在此计算机上的文件/硬盘驱动器/Windows 资源管理器中具有可移动存储组的设备）

在 WinForms 中，我会使用 ListView 来做这件事，但在 WPF 中，唯一接近的是带有自定义 ControlTemplate 的列表框，但这似乎太费劲了！

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:00:37.497

为您的 FileSystem 类定义一个带有[HeirarchichalDataTemplate的 TreeView](http://www.dev102.com/2007/12/27/how-to-use-hierarchical-datatemplate-in-wpf/)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T14:42:20.233

输入很多（约 50 行），但是当您完成基本功能后，您可以轻松地执行更改项目显示或为组添加展开/折叠功能等操作，这里是一个示例（带有展开/折叠，仅适用于乐趣）：

首先我们的数据对象：

```
public class Item
{
    public string Type { get; set; }
    public string Name { get; set; }
    public ImageSource Icon { get; set; }
} 
```

在您的代码中创建它们并将它们的列表设置为以下窗口的 DataContext：

```
<Window x:Class="ListViewTest.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300" Name="W">
    <Window.Resources>
        <CollectionViewSource x:Key="Items" Source="{Binding}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="Type"/>
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
        <DataTemplate x:Key="ItemTemplate">
            <Grid Width="128">
                <Grid.RowDefinitions>
                    <RowDefinition Height="40"/>
                    <RowDefinition Height="12"/>
                </Grid.RowDefinitions>
                <Image Source="{Binding Icon}"/>
                <TextBlock Text="{Binding Name}" Grid.Row="1"/>
            </Grid>
        </DataTemplate>
        <ItemsPanelTemplate x:Key="ItemPanel">
            <WrapPanel Orientation="Horizontal" Width="{Binding ElementName=W, Path=ActualWidth}"/>
        </ItemsPanelTemplate>
        <DataTemplate x:Key="HeaderTemplate">
            <StackPanel Margin="0 15">
                <TextBlock Text="{Binding Name}"/>
                <Rectangle Height="1" Fill="Blue"/>
            </StackPanel>
        </DataTemplate>
        <Style x:Key="ContainerStyle" TargetType="{x:Type GroupItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Expander Header="{Binding Name}" IsExpanded="True">
                            <ItemsPresenter/>
                        </Expander>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <ListBox 
            ItemsSource="{Binding Source={StaticResource Items}}"
            ItemTemplate="{StaticResource ItemTemplate}"
            ItemsPanel="{StaticResource ItemPanel}">
            <ListBox.GroupStyle>
                <GroupStyle 
                    HeaderTemplate="{StaticResource HeaderTemplate}"
                    ContainerStyle="{StaticResource ContainerStyle}"/>
            </ListBox.GroupStyle>
        </ListBox>
    </Grid>
</Window> 
```

那里可能有一些错误，但这是一个好的开始。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T11:12:22.093

[查看Shell MegaPack.WPF](http://www.ssware.com/megapack.htm)中的 FolderView、FileView 等控件

它支持分组和图标模式（还有很多其他的东西）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2011-11-22T23:07:52.110

查看 Windows API 代码包： 
 http: [//archive.msdn.microsoft.com/WindowsAPICodePack](http://archive.msdn.microsoft.com/WindowsAPICodePack)

还有 FolderView 和 FileView： 
 [http](http://visualstudiogallery.msdn.microsoft.com/E544A5BA-49EF-469D-B926-6DF9E55D9D64/) ://visualstudiogallery.msdn.microsoft.com/E544A5BA-49EF-469D-B926-6DF9E55D9D64/和 
[http://visualstudiogallery.msdn.microsoft.com/0850E431-344D-4464-96A4-695D9A93E4A6/](http://visualstudiogallery.msdn.microsoft.com/0850E431-344D-4464-96A4-695D9A93E4A6/)

# c# - ListBox 在失去焦点后保持选择

> ID：184522
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-08T19:44:29.493
> 
>         
> 
> 标签：c#, .net, listbox

我有一个 ListBox，当我处于焦点时，当我选择一个项目时，它会返回一个有效的 SelectedIndex。如果我有一个有效的 SelectedIndex 并且我在同一个论坛上单击一个 TextBox，SelectedIndex 现在变为 -1。但是我希望它保持其 SelectedIndex 不变。我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T19:51:52.490

无论焦点如何，ListBox 都将保持其 SelectedIndex。

我在一个空白项目上对其进行了测试，其中一个 ListBox、一个 TextBox 和一个 Label 用于显示 ListBox 的 SelectedIndex。在 ListBox 的 SelectedIndexChanged 和 TextBox 的 TextChanged 事件下，我用 ListBox 的 SelectedIndex 更新了标签

一定有其他原因导致 Selected Index 变为 -1。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2010-06-07T19:01:46.957

我和原始海报有同样的问题。我无法完全弄清楚，但似乎当您将列表框绑定到可观察集合并且集合发生更改时，所选项目失去焦点。

我通过将所选索引保存在变量中并在所选索引为 -1 时将其重置（并且恢复它是有效的）来解决这个问题

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2013-11-25T21:24:48.583

这是一个老问题，但如果其他人遇到同样的问题，请检查您的 ListBoxItem 样式*，特别是如果您使用的是 WPF Themes 中的一种样式*。

WPF 主题的问题特别是包含控制模板之外的部分：

```
<Style d:IsControlPart="True" TargetType="{x:Type ListBoxItem}">
....
<Style.Triggers>
        <Trigger Property="Selector.IsSelected" Value="True">
            <Setter Property="Foreground">
                <Setter.Value>
                    <SolidColorBrush po:Freeze="True" Color="{DynamicResource BlackColor}" />
                </Setter.Value>
            </Setter>
        </Trigger>
        <Trigger Property="IsKeyboardFocusWithin" Value="true">
            <Setter Property="IsSelected" Value="true" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

删除 Style.Triggers 问题应该会消失

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T19:47:44.417

处理[SelectedIndexChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.selectedindexchanged.aspx)事件并保存选定的值，以便在控件重新获得焦点时恢复它。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T19:49:53.400

我尚未在我的应用程序中验证这一点，但如果当 LB 失去焦点时 SelectedIndex 属性发生变化，您可能必须自己处理这种情况，方法是缓存最后选择的索引并在控件重新获得焦点时重置它。您可以在包含表单中执行此操作，也可以在从 ListBox 派生的类中执行此操作。

您甚至可以在看到所选索引变为 -1 时尝试设置它。不知道会发生什么，但我很想知道......

编辑：刚刚对其进行了测试，就像其他海报一样，我也无法复制它。您的 LB 必须稍有不同

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:14:15.523

这些控件是在不同的对话框中，还是在选项卡式容器上的不同选项卡中？这是我能想到的唯一方法，当你改变焦点时你会失去你的 SelectedIndex 。否则，任何人将如何例如单击按钮对项目采取行动？当焦点转到您单击的按钮时，您将失去选择...

# c++ - 在什么情况下我使用 malloc 和/或 new？

> ID：184537
> 
>         
> 
> 赞同：558
> 
>         
> 
> 时间：2008-10-08T19:47:55.090
> 
>         
> 
> 标签：c++, memory-management, malloc, new-operator

我在 C++ 中看到有多种分配和释放数据的方法，我知道当你调用时`malloc`你应该调用`free`，当你使用`new`操作符时你应该配对，`delete`将两者混合是错误的（例如调用`free()`创建的东西与`new`操作员），但我不清楚何时应该在我的现实世界的程序中使用`malloc`/`free`以及何时应该使用`new`/ 。`delete`

如果您是 C++ 专家，请告诉我您在这方面遵循的任何经验法则或约定。

* * *

## 回答 #1

> 赞同：455
> 
>             
> 
> 时间：2008-10-08T19:48:43.073

除非你被迫使用 C，否则你**永远不应该使用** `malloc`. 始终使用`new`.

如果您需要大量数据，只需执行以下操作：

```
char *pBuffer = new char[1024]; 
```

尽管这是不正确的，但要小心：

```
//This is incorrect - may delete only one element, may corrupt the heap, or worse...
delete pBuffer; 
```

相反，您应该在删除数据数组时执行此操作：

```
//This deletes all items in the array
delete[] pBuffer; 
```

关键字是 C++的`new`执行方式，它将确保您的类型的**构造函数名为**. `new`关键字也更加**类型安全**，而根本`malloc`不是类型安全的。

我认为有益的唯一方法`malloc`是如果您需要**更改**数据缓冲区的大小。`new`关键字没有类似的方式，如`realloc`. 该`realloc`功能可能能够更有效地为您扩展一块内存的大小。

值得一提的是，您不能混合使用`new`/`free`和`malloc`/ `delete`。

注意：此问题中的某些答案无效。

```
int* p_scalar = new int(5);  // Does not create 5 elements, but initializes to 5
int* p_array  = new int[5];  // Creates 5 elements 
```

* * *

## 回答 #2

> 赞同：161
> 
>             
> 
> 时间：2011-11-01T17:04:54.523

简短的回答是：不要在没有`malloc`充分理由的情况下使用 C++。`malloc`与 C++ 一起使用时存在许多缺陷，这些缺陷`new`被定义为要克服。

## 新的 C++ 代码修复的缺陷

1.  `malloc`以任何有意义的方式都不是类型安全的。在 C++ 中，您需要从`void*`. 这可能会带来很多问题：

    ```
    #include <stdlib.h>

    struct foo {
      double d[5];
    }; 

    int main() {
      foo *f1 = malloc(1); // error, no cast
      foo *f2 = static_cast<foo*>(malloc(sizeof(foo)));
      foo *f3 = static_cast<foo*>(malloc(1)); // No error, bad
    } 
    ```

2.  虽然比这更糟。如果有问题的类型是[POD（普通旧数据）](https://stackoverflow.com/questions/146452/what-are-pod-types-in-c) ，那么您可以像第一个示例中那样，半明智地使用`malloc`它来为其分配内存。`f2`

    虽然类型是 POD，但它并不那么明显。给定类型有可能从 POD 更改为非 POD，而不会导致编译器错误并且可能很难调试问题，这一事实是一个重要因素。例如，如果某人（可能是另一个程序员，在维护期间，很久以后要进行导致`foo`不再是 POD 的更改，那么在编译时不会像您希望的那样出现明显的错误，例如：

    ```
    struct foo {
      double d[5];
      virtual ~foo() { }
    }; 
    ```

    在没有任何明显诊断的情况下，也会使`malloc`of变坏。`f2`此处的示例很简单，但可能会在更远的地方意外引入非 POD（例如，在基类中，通过添加非 POD 成员）。如果你有 C++11/boost，你可以`is_pod`用来检查这个假设是否正确，如果不正确，则会产生错误：

    ```
    #include <type_traits>
    #include <stdlib.h>

    foo *safe_foo_malloc() {
      static_assert(std::is_pod<foo>::value, "foo must be POD");
      return static_cast<foo*>(malloc(sizeof(foo)));
    } 
    ```

    尽管 boost[无法确定一个类型是否是](http://www.boost.org/doc/libs/1_47_0/libs/type_traits/doc/html/boost_typetraits/reference/is_pod.html)没有 C++11 或其他一些编译器扩展的 POD。

3.  `malloc``NULL`如果分配失败则返回。`new`会扔`std::bad_alloc`。稍后使用`NULL`指针的行为是未定义的。异常在抛出时具有清晰的语义，并且是从错误源抛出的。在每次`malloc`调用时都进行适当的测试似乎很乏味且容易出错。（您只需忘记一次即可撤消所有出色的工作）。可以允许异常传播到调用者能够明智地处理它的级别，而`NULL`有意义地传递回来要困难得多。我们可以扩展我们的`safe_foo_malloc`函数来抛出异常或退出程序或调用一些处理程序：

    ```
    #include <type_traits>
    #include <stdlib.h>

    void my_malloc_failed_handler();

    foo *safe_foo_malloc() {
      static_assert(std::is_pod<foo>::value, "foo must be POD");
      foo *mem = static_cast<foo*>(malloc(sizeof(foo)));
      if (!mem) {
         my_malloc_failed_handler();
         // or throw ...
      }
      return mem;
    } 
    ```

4.  从根本上说`malloc`，它是 C 特性，`new`也是 C++ 特性。结果`malloc`不能很好地与构造函数一起使用，它只考虑分配一块字节。我们可以`safe_foo_malloc`进一步扩展使用位置`new`：

    ```
    #include <stdlib.h>
    #include <new>

    void my_malloc_failed_handler();

    foo *safe_foo_malloc() {
      void *mem = malloc(sizeof(foo));
      if (!mem) {
         my_malloc_failed_handler();
         // or throw ...
      }
      return new (mem)foo();
    } 
    ```

5.  我们的`safe_foo_malloc`函数不是很通用——理想情况下，我们想要可以处理任何类型的东西，而不仅仅是`foo`. 我们可以使用非默认构造函数的模板和可变参数模板来实现这一点：

    ```
    #include <functional>
    #include <new>
    #include <stdlib.h>

    void my_malloc_failed_handler();

    template <typename T>
    struct alloc {
      template <typename ...Args>
      static T *safe_malloc(Args&&... args) {
        void *mem = malloc(sizeof(T));
        if (!mem) {
           my_malloc_failed_handler();
           // or throw ...
        }
        return new (mem)T(std::forward(args)...);
      }
    }; 
    ```

    现在，尽管在解决我们迄今为止发现的所有问题时，我们实际上已经重新发明了默认`new`运算符。如果您要使用`malloc`和放置，`new`那么您还不如从使用`new`开始！

* * *

## 回答 #3

> 赞同：57
> 
>             
> 
> 时间：2008-10-08T20:24:37.527

来自[C++ FQA Lite](http://yosefk.com/c++fqa/heap.html#fqa-16.4)：

> [16.4] 为什么我应该使用new而不是值得信赖的旧malloc()？
> 
>   
>   
> 
> FAQ：new/delete调用构造函数/析构函数；new 是类型安全的， malloc 不是；new 可以被一个类覆盖。
> 
>   
>   
> 
> FQA：FAQ 中提到的 new 的优点不是优点，因为构造函数、析构函数和操作符重载都是垃圾（看看没有垃圾收集会发生什么？），类型安全问题在这里真的很小（通常你有将 malloc 返回的 void* 转换为正确的指针类型，以将其分配给类型化的指针变量，这可能很烦人，但远非“不安全”）。
> 
>   
>   
> 
> 哦，使用可信赖的旧 malloc 可以使用同样可信赖的旧 realloc。太糟糕了，我们没有闪亮的新运营商更新或其他东西。
> 
>   
>   
> 
> 尽管如此，new 还不足以证明偏离整个语言使用的通用风格是合理的，即使该语言是 C++ 也是如此。特别是，如果您只是 malloc 对象，则具有非平凡构造函数的类将以致命的方式行为不端。那么为什么不在整个代码中使用 new 呢？人们很少重载 operator new，所以它可能不会妨碍你太多。如果他们确实超载了新的，你可以随时要求他们停下来。

对不起，我无法抗拒。:)

* * *

## 回答 #4

> 赞同：51
> 
>             
> 
> 时间：2008-10-08T19:54:11.533

始终在 C++ 中使用 new。如果你需要一块无类型的内存，你可以直接使用 operator new：

```
void *p = operator new(size);
   ...
operator delete(p); 
```

* * *

## 回答 #5

> 赞同：45
> 
>             
> 
> 时间：2015-11-26T10:06:05.297

**新 vs malloc()**

1)`new`是**运算符**，while`malloc()`是**函数**。

2）`new`调用**构造函数**，而`malloc()`没有。

3)`new`返回**确切的数据类型**，同时`malloc()`返回**void ***。

4)在返回 NULL时`new`从不返回**NULL**（将抛出失败）`malloc()`

`new`5) while`malloc()`可以重新分配未处理的内存

* * *

## 回答 #6

> 赞同：33
> 
>             
> 
> 时间：2008-10-08T19:51:13.320

**`malloc`**仅用于分配将由以 c 为中心的库和 API 管理的内存*。*对您控制的所有内容使用和（以及变体）。**`free`** ***`new`****`delete`****`[]`***

 ** * *

## 回答 #7

> 赞同：32
> 
>             
> 
> 时间：2017-07-29T07:20:05.430

要回答您的问题，您应该知道**和****之间的区别`malloc``new`**。区别很简单：

`malloc` **分配内存**，同时分配内存并调用您为其分配内存的对象`new` **的构造函数。**

因此，除非您仅限于使用 C，否则您永远不应该使用 malloc，尤其是在处理 C++ 对象时。那将是破坏您的程序的秘诀。

`free`和之间的区别`delete`也完全一样。不同之处在于`delete`，除了释放内存之外，它还会调用对象的析构函数。

* * *

## 回答 #8

> 赞同：15
> 
>             
> 
> 时间：2011-11-01T18:25:37.973

`malloc`和之间有一个很大的区别`new`。`malloc`分配内存。这对 C 来说很好，因为在 C 中，一块内存就是一个对象。

在 C++ 中，如果您不处理 POD 类型（类似于 C 类型），则必须在内存位置调用构造函数才能在其中实际拥有对象。非 POD 类型在 C++ 中非常常见，因为许多 C++ 特性使对象自动成为非 POD。

`new`分配内存*并*在该内存位置创建一个对象。对于非 POD 类型，这意味着调用构造函数。

如果你做这样的事情：

```
non_pod_type* p = (non_pod_type*) malloc(sizeof *p); 
```

您获得的指针无法取消引用，因为它不指向对象。您需要先调用它的构造函数，然后才能使用它（这是使用 placement 完成的`new`）。

另一方面，如果您这样做：

```
non_pod_type* p = new non_pod_type(); 
```

你得到一个始终有效的指针，因为`new`创建了一个对象。

即使对于 POD 类型，两者之间也存在显着差异：

```
pod_type* p = (pod_type*) malloc(sizeof *p);
std::cout << p->foo; 
```

这段代码将打印一个未指定的值，因为由其创建的 POD 对象`malloc`未初始化。

使用`new`，您可以指定要调用的构造函数，从而获得明确定义的值。

```
pod_type* p = new pod_type();
std::cout << p->foo; // prints 0 
```

如果你真的想要它，你可以使用 use`new`来获取未初始化的 POD 对象。有关更多信息，请参阅[this other answer](https://stackoverflow.com/questions/620137/do-the-parentheses-after-the-type-name-make-a-difference-with-new/620402#620402)。

另一个区别是失败时的行为。当它分配内存失败时，`malloc`返回一个空指针，同时`new`抛出一个异常。

前者要求您在使用它之前测试返回的每个指针，而后者总是会产生有效的指针。

由于这些原因，在 C++ 代码中您应该使用`new`，而不是`malloc`. 但即便如此，您也不应该使用`new`“公开”，因为它会获取您需要稍后发布的资源。使用`new`时，应立即将其结果传递给资源管理类：

```
std::unique_ptr<T> p = std::unique_ptr<T>(new T()); // this won't leak 
```

* * *

## 回答 #9

> 赞同：11
> 
>             
> 
> 时间：2018-12-22T18:08:38.900

仅当对象的生命周期与创建它的范围不同时才需要动态分配（这也适用于使范围变小或变大）并且您有特定的原因不按值存储它工作。

例如：

```
 std::vector<int> *createVector(); // Bad
 std::vector<int> createVector();  // Good

 auto v = new std::vector<int>(); // Bad
 auto result = calculate(/*optional output = */ v);
 auto v = std::vector<int>(); // Good
 auto result = calculate(/*optional output = */ &v); 
```

从 C++11 开始，我们`std::unique_ptr`处理已分配的内存，其中包含已分配内存的所有权。`std::shared_ptr`是为您必须共享所有权而创建的。（你需要的比你在一个好的程序中所期望的要少）

创建实例变得非常容易：

```
auto instance = std::make_unique<Class>(/*args*/); // C++14
auto instance = std::unique_ptr<Class>(new Class(/*args*/)); // C++11
auto instance = std::make_unique<Class[]>(42); // C++14
auto instance = std::unique_ptr<Class[]>(new Class[](42)); // C++11 
```

C++17 还添加了`std::optional`可以防止您需要内存分配的功能

```
auto optInstance = std::optional<Class>{};
if (condition)
    optInstance = Class{}; 
```

一旦“实例”超出范围，内存就会被清理。转让所有权也很容易：

```
 auto vector = std::vector<std::unique_ptr<Interface>>{};
 auto instance = std::make_unique<Class>();
 vector.push_back(std::move(instance)); // std::move -> transfer (most of the time) 
```

那么什么时候还需要`new`呢？从 C++11 开始几乎从来没有。您使用的大多数人都会使用`std::make_unique`，直到您遇到通过原始指针转移所有权的 API。

```
 auto instance = std::make_unique<Class>();
 legacyFunction(instance.release()); // Ownership being transferred

 auto instance = std::unique_ptr<Class>{legacyFunction()}; // Ownership being captured in unique_ptr 
```

在 C++98/03 中，您必须进行手动内存管理。如果您遇到这种情况，请尝试升级到该标准的更新版本。如果你被卡住了：

```
 auto instance = new Class(); // Allocate memory
 delete instance;             // Deallocate
 auto instances = new Class[42](); // Allocate memory
 delete[] instances;               // Deallocate 
```

确保您正确跟踪所有权，以免发生任何内存泄漏！移动语义也不起作用。

那么，我们什么时候需要 C++ 中的 malloc 呢？唯一有效的原因是分配内存并稍后通过placement new 对其进行初始化。

```
 auto instanceBlob = std::malloc(sizeof(Class)); // Allocate memory
 auto instance = new(instanceBlob)Class{}; // Initialize via constructor
 instance.~Class(); // Destroy via destructor
 std::free(instanceBlob); // Deallocate the memory 
```

即使以上是有效的，这也可以通过 new-operator 来完成。`std::vector`是一个很好的例子。

最后，我们还有房间里的大象：`C`。如果您必须使用在 C++ 代码中分配内存并在 C 代码中释放（或相反）的 C 库，您将被迫使用 malloc/free。

如果你在这种情况下，忘记虚函数、成员函数、类......只允许其中包含 POD 的结构。

规则的一些例外情况：

*   您正在使用适合 malloc 的高级数据结构编写标准库

*   您必须分配大量内存（在 10GB 文件的内存副本中？）

*   您有工具阻止您使用某些构造

*   您需要存储不完整的类型

* * *

## 回答 #10

> 赞同：6
> 
>             
> 
> 时间：2014-01-15T14:45:51.287

有一些事情`new`不会`malloc`：

1.  `new`通过调用该对象的构造函数来构造该对象

2.  `new`不需要对分配的内存进行类型转换。

3.  它不需要分配大量内存，而是需要构造多个对象。

所以，如果你使用`malloc`，那么你需要明确地做上面的事情，这并不总是实用的。此外，`new`可以重载但`malloc`不能重载。

* * *

## 回答 #11

> 赞同：5
> 
>             
> 
> 时间：2013-04-09T12:23:20.363

如果您使用不需要构造/销毁且需要重新分配的数据（例如，大量整数数组），那么我相信 malloc/free 是一个不错的选择，因为它为您提供了 realloc，这比 new-memcpy 快得多-delete（它在我的 Linux 机器上，但我想这可能取决于平台）。如果您使用非 POD 且需要构造/销毁的 C++ 对象，则必须使用 new 和 delete 运算符。

无论如何，我不明白为什么你不应该同时使用两者（前提是你释放你分配的内存并删除分配给新的对象）如果可以利用速度提升（如果你正在重新分配大型数组，有时是一个重要的提升）的POD）realloc可以给你。

除非你需要它，否则你应该坚持使用 C++ 中的 new/delete。

* * *

## 回答 #12

> 赞同：3
> 
>             
> 
> 时间：2014-04-02T09:13:02.607

如果您使用 C++，请尝试使用 new/delete 而不是 malloc/calloc，因为它们是运算符。对于 malloc/calloc，您需要包含另一个标头。不要在同一代码中混合使用两种不同的语言。他们的工作在各个方面都相似，都从哈希表中的堆段动态分配内存。

* * *

## 回答 #13

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T19:52:10.087

如果您有想要移植到 C++ 的 C 代码，您可能会在其中留下任何 malloc() 调用。对于任何新的 C++ 代码，我建议使用 new 代替。

* * *

## 回答 #14

> 赞同：2
> 
>             
> 
> 时间：2016-12-14T15:46:27.767

`new`将初始化结构的默认值并将其中的引用正确链接到自身。

例如

```
struct test_s {
    int some_strange_name = 1;
    int &easy = some_strange_name;
} 
```

所以`new struct test_s`将返回一个带有工作引用的初始化结构，而 malloc 的版本没有默认值，并且内部引用没有初始化。

* * *

## 回答 #15

> 赞同：1
> 
>             
> 
> 时间：2012-08-17T00:54:23.110

在下面的场景中，我们不能使用 new，因为它调用了构造函数。

```
class  B  {
private:
    B *ptr;
    int x;
public:
    B(int n)  {
        cout<<"B: ctr"<<endl;
        //ptr = new B;  //keep calling ctr, result is segmentation fault
        ptr = (B *)malloc(sizeof(B));
        x = n;
        ptr->x = n + 10;
    }
    ~B()  {
        //delete ptr;
        free(ptr);
        cout<<"B: dtr"<<endl;
    }
}; 
```

* * *

## 回答 #16

> 赞同：1
> 
>             
> 
> 时间：2011-08-14T20:31:35.713

从较低的角度来看，new 将在给予内存之前初始化所有内存，而 malloc 将保留内存的原始内容。

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:42:26.447

`new`and`delete`运算符可以对类和结构进行操作，而and`malloc`仅`free`适用于需要转换的内存块。

使用`new/delete`将有助于改进您的代码，因为您不需要将分配的内存转换为所需的数据结构。

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2022-01-06T22:00:22.693

顺便说一句，如果你有 malloc 的代码，请使用这个正则表达式：

搜索：

```
\((\w+)\*\)malloc\((\w+)\) 
```

用。。。来代替：

```
new \1[\2] 
```

* * *

## 回答 #19

> 赞同：0
> 
>             
> 
> 时间：2017-07-29T06:17:05.673

考虑使用 malloc/free 而不是 new/delete 的罕见情况是，当您使用 realloc 进行分配然后重新分配（简单的 pod 类型，而不是对象）时，因为在 C++ 中没有与 realloc 类似的功能（尽管可以使用更多 C++ 方法）。

* * *

## 回答 #20

> 赞同：-4
> 
>             
> 
> 时间：2012-07-26T05:41:38.067

malloc() 用于在 C 中动态分配内存，而在 c++ 中由 new() 完成相同的工作。因此，您不能混合使用 2 种语言的编码约定。如果你问 calloc 和 malloc() 之间的区别会很好

# flash - Flash CS3 中的模糊 .png

> ID：184538
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-08T19:48:22.233
> 
>         
> 
> 标签：flash, image, png

PNG 图像在 Flash CS3 中显得“模糊”。它们非常块状并且看起来没有抗锯齿（如果这是一个词）有没有人解决这个问题？我缺少一些设置吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T20:03:25.183

您是通过加载器将它们加载到您的 SWF 中吗？还是将它们作为位图符号导入您的库？如果它们已加载，请尝试调用 Bitmap.smoothing = true; 或者如果它们在您的库中，请转到位图的属性并单击允许平滑。

除此之外，我会检查以确保您没有超过 1 alpha 设置的疯狂，或者您在任何时候都不会在代码中弄乱它的规模。这两个选项往往会混淆位图图像的模糊性。

如果所有其他方法都失败了，您可能希望考虑将图像转换为基于矢量图的图形，那么无论缩放如何，它们都将始终如您所愿。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:04:22.513

如果您完全缩放位图图像，它们将是“模糊的”，这只是图形的本质。还要检查您的发布设置，它可能会将它们转换为低质量设置的 JPEG。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:44:26.580

如果您的 png 图像在 flash 中显示为“锯齿状”（或锯齿状而不是*抗锯齿**状*），但在 Photoshop 中看起来很好，则可能是由于它们被 A：调整大小，而 B：没有打开“**平滑**” （平滑本质上是动态抗锯齿）。

每当您将图像的大小从 1:1 像素与屏幕的比例调整时，渲染器必须计算出要剪切（在缩小的情况下）或复制（在放大的情况下）的像素。

如果没有进行平滑处理，您将看到锯齿状伪影，尤其是在高对比度的边缘区域。

您可以通过双击库中的位图并选中“**允许平滑**”复选框来在 IDE 中打开平滑。

您也可以像这样以编程方式打开它：

```
myBitmap.smoothing = true; 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2012-11-23T10:34:34.237

最简单的方法是右键单击图像，然后拆分。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-10-20T15:02:50.207

我遇到了同样的问题，结果我加载 PNG 的电影被设置为 100 的 alpha。这是不正确的，因为在 AS3 中它是一个介于 0 和 1 之间的值。当我设置电影到 1，PNG 清理得很好。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2011-09-30T17:37:52.640

我遇到了同样的问题，但是在发布属性中停用***JPG Degroup可以为我解决这个问题。***

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2011-10-25T20:46:42.480

在您的库中，右键单击导入的位图并选择“属性”，然后将压缩从照片 (JPEG) 更改为无损 (PNG/GIF)。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-09-18T15:37:32.173

好吧，我尝试使用 image.opaqueBackground = 0x000000; 并且看起来工作正常，抗锯齿效果要好得多，但是，这击败了在此过程中透明背景的想法。这真是令人愤怒，Adobe，做点什么吧！

# google-app-engine - 人们如何在自己的域中使用 Google App-Engine 应用程序？

> ID：184541
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2008-10-08T19:49:04.227
> 
>         
> 
> 标签：google-app-engine

几天来，我一直在玩弄 Google App Engine，并且我有一个小爱好应用程序，我想编写和部署。

但是，我想对其进行设置，以便用户**不会**直接通过appspot.com 访问该应用程序。

通过 Google Apps 托管它然后将其指向我自己的域是唯一的方法吗？我看了一点，实施起来似乎很痛苦，但也许我只是错过了一些东西。

我的另一个想法是将应用引擎部分编写为更通用的 Web 服务。  

然后我可以将面向用户的部分托管在任何地方，用任何语言编写，并让它查询appspot.com url。

任何人都对网络服务方法有任何运气吗？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2010-01-01T14:06:42.933

需要 Google Apps 的原因是因为您需要在某个地方 a) 验证您拥有该域（否则，您可能会将其指向应用引擎，然后我可能会通过将其添加到我的帐户来劫持它）和 b) 设置域映射（哪些子域指向您的哪个 appengine 应用程序）。

由于这些东西已经存在于应用程序中，在 AppEngine 中复制它似乎很愚蠢。

正如已经指出的那样，它不需要任何费用，并且您不需要将任何东西“移动”到 Google。您只需创建一个带有随机名称的 cname 记录来验证您拥有该域，并为您希望指向 App Engine 的子域创建一个 cname。这只需要几分钟，一旦完成，它就会永远完成。

注意：如果您在其他地方托管站点并使用 Web 服务，则需要扩展站点/前端。如果您在应用程序引擎上托管，您可以免费获得：-)

我在我的博客上写了一篇关于将 *.appspot.com 域重定向到您的自定义域以保持您的品牌的文章：

[http://blog.dantup.com/2009/12/redirecting-requests-from-appid-appspot-com-to-a-custom-domain](http://blog.dantup.com/2009/12/redirecting-requests-from-appid-appspot-com-to-a-custom-domain)

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2008-10-08T19:53:52.610

为此，我认为您需要使用[Google Apps](http://www.google.com/apps/intl/en/business/index.html)并为 Google Apps 设置自定义域。然后，您[将应用程序部署](https://developers.google.com/appengine/articles/domains)到您的 Google Apps 域中。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2010-08-29T16:26:46.200

这是谷歌关于如何做到这一点的官方说明：

[http://code.google.com/appengine/docs/domain.html](http://code.google.com/appengine/docs/domain.html)

我已经在几个网站上使用了这个过程，只要你可以控制你的域的 DNS 记录（你应该），它就很容易和无痛。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2011-04-17T19:04:25.240

使用方法可以很容易地完成`request.getRequestURI()`。如果 URL 不包含您的域，只需使用将其重定向到所需的 URL

```
resp.sendRedirect("<your domain>") 
```

否则使用加载错误页面

```
request.getRequestDispatcher("<error-page>").forward(request, response); 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2017-12-28T05:05:17.200

好的，我们现在是 2017 年底，App Engine 和自定义域的情况有很大不同。现在很容易！

转到您的应用程序的应用程序引擎仪表板并选择设置，然后转到自定义域选项卡。从那里，选择`Add custom domain`。

棘手的部分是谷歌需要验证你控制域，所以他们要求你在你的域的 DNS 中放置一个 TXT 记录。一旦你这样做并谷歌它，你就成为域的所有者“验证”。

在那之后，谷歌会给你一堆 A 和 AAAA（对于 IP6）记录来放入你的 DNS 中。一旦你这样做了，你应该很高兴。

# ruby-on-rails - 我需要做什么才能将应用程序升级到最新的 Rails 版本？

> ID：184550
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-08T19:51:24.053
> 
>         
> 
> 标签：ruby-on-rails, upgrade

我目前正在使用 Rails 2.1.0 并想升级到 Rails 2.1.1。发出以下命令后

```
gem update rails 
```

我想我需要改变这条线

```
RAILS_GEM_VERSION = '2.1.0' unless defined? RAILS_GEM_VERSION 
```

在环境中.rb

我应该采取哪些其他措施来确保我的应用程序使用的是最新版本？还有其他需要更新的文件吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-12T00:21:59.327

您还需要进入您的应用程序目录并运行以下命令：

耙轨：更新

然后运行您的测试并确保一切正常。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:04:53.290

据我所知，那里定义了您的应用程序作为一个整体将使用的 Rails 版本。我知道对于我现在参与的项目，我必须将其覆盖到 2.1.1 才能在我的 VM 上工作，因为我安装了最新版本，并且没有按照项目要求指定 2.1.0。

您需要注意的最重要的事情是可能会覆盖此设置的插件和扩展，以及可能因更改版本而导致的不兼容性。

2.1.1 还存在一些已知问题，除非您现在绝对需要某个功能，否则您可能需要等待。

# mysql - 如何监控 MySQL 空间？

> ID：184560
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2008-10-08T19:52:29.823
> 
>         
> 
> 标签：mysql, mysql-management, database-administration

我下载了一个使用 MySQL 的 Web 应用程序的 VM 映像。

如何监控其空间消耗并知道何时必须添加额外空间？

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2010-10-29T21:11:16.037

我有一些很棒的大问题要分享：

运行此命令以获取存储引擎的 MySQL 总数据和索引使用情况

```
SELECT IFNULL(B.engine,'Total') "Storage Engine",
CONCAT(LPAD(REPLACE(FORMAT(B.DSize/POWER(1024,pw),3),',',''),17,' '),' ',
SUBSTR(' KMGTP',pw+1,1),'B') "Data Size", CONCAT(LPAD(REPLACE(
FORMAT(B.ISize/POWER(1024,pw),3),',',''),17,' '),' ',
SUBSTR(' KMGTP',pw+1,1),'B') "Index Size", CONCAT(LPAD(REPLACE(
FORMAT(B.TSize/POWER(1024,pw),3),',',''),17,' '),' ',
SUBSTR(' KMGTP',pw+1,1),'B') "Table Size" FROM
(SELECT engine,SUM(data_length) DSize,SUM(index_length) ISize,
SUM(data_length+index_length) TSize FROM
information_schema.tables WHERE table_schema NOT IN
('mysql','information_schema','performance_schema') AND
engine IS NOT NULL GROUP BY engine WITH ROLLUP) B,
(SELECT 3 pw) A ORDER BY TSize; 
```

运行此命令以获取数据库的总 MySQL 数据和索引使用情况

```
SELECT DBName,CONCAT(LPAD(FORMAT(SDSize/POWER(1024,pw),3),17,' '),' ',
SUBSTR(' KMGTP',pw+1,1),'B') "Data Size",CONCAT(LPAD(
FORMAT(SXSize/POWER(1024,pw),3),17,' '),' ',SUBSTR(' KMGTP',pw+1,1),'B') "Index Size",
CONCAT(LPAD(FORMAT(STSize/POWER(1024,pw),3),17,' '),' ',
SUBSTR(' KMGTP',pw+1,1),'B') "Total Size" FROM
(SELECT IFNULL(DB,'All Databases') DBName,SUM(DSize) SDSize,SUM(XSize) SXSize,
SUM(TSize) STSize FROM (SELECT table_schema DB,data_length DSize,
index_length XSize,data_length+index_length TSize FROM information_schema.tables
WHERE table_schema NOT IN ('mysql','information_schema','performance_schema')) AAA
GROUP BY DB WITH ROLLUP) AA,(SELECT 3 pw) BB ORDER BY (SDSize+SXSize); 
```

运行此命令以获取数据库和存储引擎的总 MySQL 数据和索引使用情况

```
SELECT Statistic,DataSize "Data Size",IndexSize "Index Size",TableSize "Table Size"
FROM (SELECT IF(ISNULL(table_schema)=1,10,0) schema_score,
IF(ISNULL(engine)=1,10,0) engine_score,
IF(ISNULL(table_schema)=1,'ZZZZZZZZZZZZZZZZ',table_schema) schemaname,
IF(ISNULL(B.table_schema)+ISNULL(B.engine)=2,"Storage for All Databases",
IF(ISNULL(B.table_schema)+ISNULL(B.engine)=1,
CONCAT("Storage for ",B.table_schema),
CONCAT(B.engine," Tables for ",B.table_schema))) Statistic,
CONCAT(LPAD(REPLACE(FORMAT(B.DSize/POWER(1024,pw),3),',',''),17,' '),' ',
SUBSTR(' KMGTP',pw+1,1),'B') DataSize,CONCAT(LPAD(REPLACE(
FORMAT(B.ISize/POWER(1024,pw),3),',',''),17,' '),' ',
SUBSTR(' KMGTP',pw+1,1),'B') IndexSize,
CONCAT(LPAD(REPLACE(FORMAT(B.TSize/POWER(1024,pw),3),',',''),17,' '),' ',
SUBSTR(' KMGTP',pw+1,1),'B') TableSize FROM (SELECT table_schema,engine,
SUM(data_length) DSize,SUM(index_length) ISize,
SUM(data_length+index_length) TSize FROM information_schema.tables
WHERE table_schema NOT IN ('mysql','information_schema','performance_schema')
AND engine IS NOT NULL GROUP BY table_schema,engine WITH ROLLUP) B,
(SELECT 3 pw) A) AA ORDER BY schemaname,schema_score,engine_score; 
```

警告

在每个查询中，您将看到`(SELECT 3 pw)`. pw 代表 1024 的幂以显示结果。

*   `(SELECT 0 pw)`将以字节为单位显示报告

*   `(SELECT 1 pw)`将以千字节为单位显示报告

*   `(SELECT 2 pw)`将以兆字节显示报告

*   `(SELECT 3 pw)`将以千兆字节显示报告

*   `(SELECT 4 pw)`将以 TeraBytes 显示报告

*   `(SELECT 5 pw)`将以 PetaBytes 显示报告（如果您运行此报告，请与我联系）

这是一个格式较少的报表查询：

```
SELECT IFNULL(db,'Total') "Database",
datsum / power(1024,pw) "Data Size",
ndxsum / power(1024,pw) "Index Size",
totsum / power(1024,pw) "Total"
FROM (SELECT db,SUM(dat) datsum,SUM(ndx) ndxsum,SUM(dat+ndx) totsum
FROM (SELECT table_schema db,data_length dat,index_length ndx
FROM information_schema.tables WHERE engine IS NOT NULL
AND table_schema NOT IN ('information_schema','mysql')) AA
GROUP BY db WITH ROLLUP) A,(SELECT 1 pw) B; 
```

相信我，我在 4 年前提出了这些查询，并且今天仍在使用它们。

# 更新 2013-06-24 15:53 EDT

我有新东西。我已经更改了查询，因此您不必`pw`为不同的单位显示设置参数。每个单位显示都是为您计算的。

按存储引擎报告

```
SELECT
    IFNULL(ENGINE,'Total') "Storage Engine",
    LPAD(CONCAT(FORMAT(DAT/POWER(1024,pw1),2),' ',
    SUBSTR(units,pw1*2+1,2)),17,' ') "Data Size",
    LPAD(CONCAT(FORMAT(NDX/POWER(1024,pw2),2),' ',
    SUBSTR(units,pw2*2+1,2)),17,' ') "Index Size",
    LPAD(CONCAT(FORMAT(TBL/POWER(1024,pw3),2),' ',
    SUBSTR(units,pw3*2+1,2)),17,' ') "Total Size"
FROM
(
    SELECT ENGINE,DAT,NDX,TBL,
    IF(px>4,4,px) pw1,IF(py>4,4,py) pw2,IF(pz>4,4,pz) pw3
    FROM 
    (SELECT *,
        FLOOR(LOG(IF(DAT=0,1,DAT))/LOG(1024)) px,
        FLOOR(LOG(IF(NDX=0,1,NDX))/LOG(1024)) py,
        FLOOR(LOG(IF(TBL=0,1,TBL))/LOG(1024)) pz
        FROM
        (SELECT
            ENGINE,
            SUM(data_length) DAT,
            SUM(index_length) NDX,
            SUM(data_length+index_length) TBL
        FROM
        (
           SELECT engine,data_length,index_length FROM
           information_schema.tables WHERE table_schema NOT IN
           ('information_schema','performance_schema','mysql')
           AND ENGINE IS NOT NULL
        ) AAA GROUP BY ENGINE WITH ROLLUP
) AAA ) AA) A,(SELECT ' BKBMBGBTB' units) B; 
```

按数据库报告

```
SELECT
    IFNULL(DB,'Total') "Database",
    LPAD(CONCAT(FORMAT(DAT/POWER(1024,pw1),2),' ',
    SUBSTR(units,pw1*2+1,2)),17,' ') "Data Size",
    LPAD(CONCAT(FORMAT(NDX/POWER(1024,pw2),2),' ',
    SUBSTR(units,pw2*2+1,2)),17,' ') "Index Size",
    LPAD(CONCAT(FORMAT(TBL/POWER(1024,pw3),2),' ',
    SUBSTR(units,pw3*2+1,2)),17,' ') "Total Size"
FROM
(
    SELECT DB,DAT,NDX,TBL,
    IF(px>4,4,px) pw1,IF(py>4,4,py) pw2,IF(pz>4,4,pz) pw3
    FROM 
    (SELECT *,
        FLOOR(LOG(IF(DAT=0,1,DAT))/LOG(1024)) px,
        FLOOR(LOG(IF(NDX=0,1,NDX))/LOG(1024)) py,
        FLOOR(LOG(IF(TBL=0,1,TBL))/LOG(1024)) pz
    FROM
    (SELECT
        DB,
        SUM(data_length) DAT,
        SUM(index_length) NDX,
        SUM(data_length+index_length) TBL
    FROM
    (
       SELECT table_schema DB,data_length,index_length FROM
       information_schema.tables WHERE table_schema NOT IN
       ('information_schema','performance_schema','mysql')
       AND ENGINE IS NOT NULL
    ) AAA GROUP BY DB WITH ROLLUP
) AAA) AA) A,(SELECT ' BKBMBGBTB' units) B; 
```

按数据库/存储引擎报告

```
SELECT
    IF(ISNULL(DB)+ISNULL(ENGINE)=2,'Database Total',
    CONCAT(DB,' ',IFNULL(ENGINE,'Total'))) "Reported Statistic",
    LPAD(CONCAT(FORMAT(DAT/POWER(1024,pw1),2),' ',
    SUBSTR(units,pw1*2+1,2)),17,' ') "Data Size",
    LPAD(CONCAT(FORMAT(NDX/POWER(1024,pw2),2),' ',
    SUBSTR(units,pw2*2+1,2)),17,' ') "Index Size",
    LPAD(CONCAT(FORMAT(TBL/POWER(1024,pw3),2),' ',
    SUBSTR(units,pw3*2+1,2)),17,' ') "Total Size"
FROM
(
    SELECT DB,ENGINE,DAT,NDX,TBL,
    IF(px>4,4,px) pw1,IF(py>4,4,py) pw2,IF(pz>4,4,pz) pw3
    FROM 
    (SELECT *,
        FLOOR(LOG(IF(DAT=0,1,DAT))/LOG(1024)) px,
        FLOOR(LOG(IF(NDX=0,1,NDX))/LOG(1024)) py,
        FLOOR(LOG(IF(TBL=0,1,TBL))/LOG(1024)) pz
    FROM
    (SELECT
        DB,ENGINE,
        SUM(data_length) DAT,
        SUM(index_length) NDX,
        SUM(data_length+index_length) TBL
    FROM
    (
       SELECT table_schema DB,ENGINE,data_length,index_length FROM
       information_schema.tables WHERE table_schema NOT IN
       ('information_schema','performance_schema','mysql')
       AND ENGINE IS NOT NULL
    ) AAA GROUP BY DB,ENGINE WITH ROLLUP
) AAA) AA) A,(SELECT ' BKBMBGBTB' units) B; 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T20:24:47.307

如果只有 MySQL 可用，请使用 SHOW TABLE STATUS 命令，并查看每个表的 Data_length 列，以字节为单位。

如果您的机器上有其他可用的语言，其中任何一种语言的脚本都会定期运行（cron），检查磁盘可用空间或数据库目录的大小，并通过电子邮件或其他方式更新您。有太多的选择可以建议一个特定的解决方案——这取决于你的情况。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2014-05-12T08:01:58.237

您可以参考具有磁盘信息功能的[MONyog](https://www.webyog.com/product/monyog)，它可以让您在服务器级别、数据库级别和表级别查找磁盘空间分析

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:05:22.123

对于 MyISAM 表，我通常检查 /var/lib/mysql/mydatabasename/ 目录的大小。InnoDB 表使用单体文件，因此您必须使用 SHOW TABLE STATUS。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2010-11-19T20:23:02.513

由于您拥有虚拟机并且您并不真正关心空间的使用方式，因此我认为最简单的方法是检查 MySQL 数据目录的大小。默认情况下是`/var/lib/mysql`. 此外，在检查数据目录大小之前清理 mysql 二进制日志（如果可能）会很好。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2015-11-08T08:39:44.130

```
du -s /var/lib/mysql/* | sort -nr 
```

结果

```
34128   /var/lib/mysql/db_name1
33720   /var/lib/mysql/db_name2
29744   /var/lib/mysql/db_name3
26624   /var/lib/mysql/db_name4
16516   /var/lib/mysql/db_name5 
```

Thsi 将按 kb 降序显示

# java - Checkstyle 与 PMD

> ID：184563
> 
>         
> 
> 赞同：90
> 
>         
> 
> 时间：2008-10-08T19:52:55.717
> 
>         
> 
> 标签：java, static-analysis, findbugs, checkstyle, pmd

我们正在为我们的 Java 产品的构建系统中引入静态分析工具。我们使用的是 Maven2，所以[Checkstyle](http://checkstyle.sourceforge.net/)和[PMD](http://pmd.sourceforge.net/)集成是免费的。然而，在执行基本样式规则方面，这两个工具之间的功能似乎有很大的重叠。

使用这两者有什么好处吗？如果一个可以工作，我不想维护 2 个工具。如果我们选择一种，我们应该使用哪一种，为什么？

我们还计划使用 FindBugs。我们应该看看其他静态分析工具吗？

**更新：**共识似乎是 PMD 优于 CheckStyle。我看不出同时使用两者的充分理由，而且我不想维护两组规则文件，因此我们可能会专门针对 PMD。我们还将引入 FindBugs，也许最终还会引入 Macker 来执行架构规则。

* * *

## 回答 #1

> 赞同：78
> 
>             
> 
> 时间：2008-10-08T20:03:05.743

您绝对应该使用[FindBugs](http://findbugs.sourceforge.net/)。根据我的经验，误报率非常低，即使是它报告的最不重要的警告也值得在某种程度上解决。

至于 Checkstyle 与 PMD，我不会使用 Checkstyle，因为它几乎只与样式有关。根据我的经验，Checkstyle 会报告大量完全不相关的事情。另一方面，PMD 也能够指出有问题的编码实践，其输出通常更相关和有用。

* * *

## 回答 #2

> 赞同：41
> 
>             
> 
> 时间：2008-10-08T20:12:17.630

这两个软件都很有用。Checkstyle 将通过检查您的*编码风格*（即大括号、命名等）在您的编程过程中为您提供帮助。简单但数量众多的事情！

PMD 将通过检查更复杂的规则（如在类设计期间）或更特殊的问题（如正确实现克隆功能）来帮助您。简单地说，PMD 会检查你的*编程风格* 

但是，这两种软件都有类似的规则，有时解释不好。如果配置不好，您可能会检查两次或两次相反的事情，即“删除无用的构造函数”和“始终使用一个构造函数”。

* * *

## 回答 #3

> 赞同：25
> 
>             
> 
> 时间：2011-09-06T15:06:51.197

> 如果我们选择一种，我们应该使用哪一种，为什么？

这些工具不是相互竞争的，而是互补的，应该同时使用。

约定类型（Checkstyle）是一种粘合剂，它使人们能够一起工作并释放他们的创造力，而不是花费时间和精力来理解不一致的代码。

检查样式示例：

*   公共方法上有 javadoc 吗？

*   该项目是否遵循 Sun 命名约定？

*   代码是否以一致的格式编写？

而 PMD 提醒您不良做法：

*   捕获异常而不做任何事情

*   有死代码

*   太多复杂的方法

*   直接使用实现而不是接口

*   在不使用 not equals(Object object) 方法的情况下实现 hashcode() 方法

来源：
 http: [//www.sonarsource.org/what-makes-checkstyle-pmd-findbugs-and-macker-complementary/](http://www.sonarsource.org/what-makes-checkstyle-pmd-findbugs-and-macker-complementary/)

* * *

## 回答 #4

> 赞同：15
> 
>             
> 
> 时间：2008-10-08T20:12:42.683

我们同时使用：

*   Checkstyle 确保团队中的每个人都以类似的方式编写代码

*   PMD 查找有问题的代码区域和下一个重构目标

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2010-11-18T18:49:20.707

如果您的主要使用地点是在 Eclipse 中进行开发，那么来自 Instantiations 的 CodePro 将是最好的。早些时候它是一个商业工具，但现在 Google 购买了 Instantiations，因此 CodePro analytix 现在是免费的。

查看  [http://code.google.com/javadevtools/download-codepro.html](http://code.google.com/javadevtools/download-codepro.html) 

* * *

## 回答 #6

> 赞同：7
> 
>             
> 
> 时间：2011-12-14T10:04:19.577

如果您查看 Checkstyle、PMD 和 Findbugs 规则列表，您会发现这三个都提供了有价值的输出，并且所有三个都在一定程度上重叠，并且还带来了自己独特的规则。这就是为什么像 Sonar 这样的工具同时使用这三种工具的原因。

也就是说，Findbugs 具有最具体或最特殊的规则（例如“可疑捕获 IllegalMonitorStateException” - 您可能多久遇到一次？）因此它可以在很少或没有配置的情况下使用，并且应该认真对待它的警告。使用 Checkstyle 和 PMD，规则更通用且与样式相关，因此它们只能与自定义配置文件一起使用，以使团队免于大量无关反馈（“第 5 行的 Tab char”、“第 6 行的 Tab char”、 “第 7 行的 Tab char”......你明白了）。它们还提供强大的工具来编写您自己的高级规则，例如 Checkstyle [DescendentToken](http://checkstyle.sourceforge.net/config_misc.html)规则。

使用这三个时（尤其是使用 Sonar 之类的工具），应分别配置所有这些（至少需要几天时间才能涵盖所有规则），同时注意防止重复（所有三个工具都检测到 hashCode()例如，被覆盖和 equals() 不是）。

总而言之，如果您认为静态代码分析很有价值，那么拒绝这三个中的任何一个提供的值是没有意义的，但是要使用所有这三个，您必须花时间来配置它们，以便为您提供有用的反馈。

* * *

## 回答 #7

> 赞同：6
> 
>             
> 
> 时间：2011-06-25T15:19:08.673

Sonar (http://www.sonarsource.org/) 是一个非常有用的代码质量管理开放平台，包括 Checkstyle、PMD、Findbugs 等等。

这也表明所有 3 种工具都有其存在的权利……

* * *

## 回答 #8

> 赞同：5
> 
>             
> 
> 时间：2008-10-13T23:52:11.367

这两种工具都是可配置的，并且可以做几乎相同的事情。也就是说，如果我们谈论的是开箱即​​用的东西，会有很多重叠，但也有不同的规则/检查。例如，Checkstyle 对检查 Javadoc 和查找幻数有更强的支持，仅举几例。此外，Checkstyle 有一个“导入控制”功能，看起来类似于 Macker 的功能（我没有使用 Macker）。

如果有一些对您来说重要的事情，Checkstyle 开箱即用，而 PMD 没有，您可以考虑只包含这些检查的最小 Checkstyle 配置。然后制定一个 Checkstyle 配置无法增长的策略，只需在使用自定义 PMD 规则等实现类似功能时删除检查。

另请考虑，如果您决定 Checkstyle“导入控制”功能涵盖了您希望 Macker 提供的功能，那么您可以实现 PMD/Checkstyle 而不是 PMD/Macker。无论哪种方式，它都是两个工具，但使用 Checkstyle，您将获得 PMD 无法“免费”开箱即用的东西。

* * *

## 回答 #9

> 赞同：5
> 
>             
> 
> 时间：2009-02-20T09:40:55.247

Checkstyle 和 PMD 都擅长检查编码标准，并且易于扩展。但是 PMD 有额外的规则来检查圈复杂度、Npath 复杂度等，这使您可以编写健康的代码。

使用 PMD 的另一个优点是 CPD（复制/粘贴检测器）。它可以发现跨项目的代码重复，并且不受 JAVA 的限制。它也适用于 JSP。Neal Ford 有一篇关于[Metrics Driven Agile Development](http://www.nealford.com/downloads/conferences/canonical/Neal_Ford-Code_Metrics_and_Analysis.zip)的精彩演讲，其中谈到了许多有助于 Java/Java EE 开发的工具

* * *

## 回答 #10

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T21:27:25.420

我发现 Checkstyle 和 PMD 最适合执行样式问题和简单明显的编码错误。虽然我发现我喜欢使用 Eclipse 以及它为此目的提供的所有警告。我们通过使用共享偏好并将它们标记为实际错误来强制执行内容。这样一来，他们就永远不会被登记入住。  

我强烈而热情地推荐使用 FindBugs。因为它在字节码级别工作，所以它可以检查在源代码级别不可能的事情。虽然它吐出了相当多的垃圾，但它在我们的代码中发现了许多实际和重要的错误。  

* * *

## 回答 #11

> 赞同：4
> 
>             
> 
> 时间：2018-04-26T08:20:30.597

10 年后…… 2018 年，我全部使用 Checkstyle、PMD 和 FindBugs。

**从FindBugs**开始。也许稍后添加 PMD 和 Checkstyle。

**永远不要盲目执行默认规则**！

脚步：

*   在具有大量代码的项目上运行具有默认规则的工具

*   将规则适配到这个项目中，注释掉无用的规则，加上一些注释

*   专注于低悬的果实规则（NPE、记录器检查、未关闭的资源检查......）

*   对您认为有价值的规则进行一些修复（一次一个！）

*   为每个工具执行此操作，但不是一次全部执行！

*   重复这个过程

理想情况下，每个项目都可以有单独的规则。我喜欢通过构建（通过 maven 插件）运行规则，一旦我知道项目通过了我定义的所有规则，就会因规则错误而失败。这迫使开发人员采取行动，因为**报告是不够的**。从那时起，您的项目几乎是防弹的，您甚至可以稍后添加更多规则和/或编写自定义规则。

* * *

## 回答 #12

> 赞同：3
> 
>             
> 
> 时间：2011-10-24T08:44:41.433

到目前为止我还没有看到的一点是，IDE 的插件会在您的代码上强制执行 CheckStyle 规则集，而 PMD 插件只会报告违规行为。例如，在多个编程团队的多站点项目中，积极执行标准很重要，而不仅仅是报告标准。

这两种工具都有可用于 IntelliJ、NetBeans 和 Eclipse 的插件（在我看来，这涵盖了大多数使用情况）。我对 NetBeans 不是很熟悉，所以只能评论 IntelliJ 和 Eclipse。

无论如何，IntelliJ 和 Eclipse 的 PMD 插件将*根据需要*生成项目代码库中 PMD 违规的报告。

另一方面，CheckStyle 插件会即时突出显示违规行为，并且可以（至少对于 IntelliJ，我对 Eclipse 的经验较少）配置为自动转换一些问题（例如，对于“OneStatementPerLine”，将放置 CR-LF在语句之间，对于“NeedBraces”，将在缺少大括号的地方添加大括号等）。显然，只有更简单的违规可以自动修复，但它仍然有助于遗留项目或位于多个位置的项目。

PMD 的“按需”意味着开发人员必须有意识地决定运行报告。而 Checkstyle 违规会在开发过程中自动报告给他们。虽然 PMD*确实*包含更广泛的规则集，但在我看来，自动执行/报告 IDE 中的违规行为值得维护两套规则的麻烦。

因此，对于我从事的任何项目，我们都使用这两种工具，在 IDE 中强制执行 Checkstyle，在 IDE 中报告 PMD，并*在*构建中报告和测量（通过 Jenkins）。

* * *

## 回答 #13

> 赞同：3
> 
>             
> 
> 时间：2012-10-23T17:09:27.500

看看[qulice-maven-plugin](http://www.qulice.com/index.html)，它结合了 Checkstyle、PMD、FindBugs 和其他一些静态分析器，并预先配置了它们。这种组合的美妙之处在于您不需要在每个项目中单独配置它们：

```
<plugin>
  <groupId>com.qulice</groupId>
  <artifactId>qulice-maven-plugin</artifactId>
  <version>0.15</version>
  <executions>
    <execution>
      <goals>
        <goal>check</goal>
      </goals>
    </execution>
  </executions>
</plugin> 
```

* * *

## 回答 #14

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:04:15.163

我会回应这样的评论，即 PMD 是 Java 样式/约定检查的最新产品。对于 FindBugs，许多商业开发团体都在使用 Coverity。

* * *

## 回答 #15

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T19:59:25.923

PMD 是我发现更多人所指的。Checkstyle 是 4 年前人们所指的，但我相信 PMD 得到了更持续的维护，以及其他 IDE/插件选择使用的内容。

* * *

## 回答 #16

> 赞同：1
> 
>             
> 
> 时间：2015-07-01T18:43:13.290

我刚刚开始使用 Checkstyle 和 PMD。对我来说，PMD更容易为诸如是否存在System.gc()、Runtime.gc()之类的东西创建自定义规则，只要你会写XPath Query，这也一点都不难。但是，PMD 并没有向我展示它具有显示列号的功能。因此，对于检查列限制之类的事情。您可能想使用 Checkstyle。

* * *

## 回答 #17

> 赞同：-2
> 
>             
> 
> 时间：2010-10-05T07:17:13.590

与 checkstyles 相比，PMD 是最好的工具。Checkstyles 可能不具备分析代码的能力，而 PMD 提供了许多功能来分析代码！Offcourse PMD 尚未发布有关 javadoc、注释、缩进等的规则。顺便说一句，我计划实施这些规则......thanx

# asp.net - ASP.NET：如何将HtmlAnchor 或 HtmlAnchor 转换为静态文本？

> ID：184570
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-08T19:54:57.727
> 
>         
> 
> 标签：asp.net, html

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2008-10-08T19:57:56.083

使用 <asp:HyperLink > 控件，如果没有提供链接，它会正常显示文本。

* * *

编辑以包括示例：

```
<asp:repeater ... runat="Server">
   <itemtemplate>
      <asp:HyperLink ... runat="server" NavigateUrl="<%# GetItemLink(...) %>"> <%# GetItemText %></asp:HyperLink>
   <itemtemplate>
<asp:repeater> 
```

在上面的示例中，锚标记无论如何都会呈现为 html，但如果 NavigateUrl 属性是一个空字符串，则根本没有`href`，并且我曾经使用过的每个浏览器都以类似于 spans 的方式呈现文本（所以注意 <a > 上的自定义样式）。

# vbscript - 如何在 VBScript 中附加二进制值

> ID：184574
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T19:56:44.900
> 
>         
> 
> 标签：vbscript, binary

如果我有两个包含二进制值的变量，如何将它们作为一个二进制值附加在一起？例如，如果我使用 WMI 读取两个 REG_BINARY 值的注册表，那么我希望能够连接这些值。

当您尝试使用“&”运算符加入时，VBScript 会抱怨类型不匹配。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-09T08:03:39.207

REG_BINARY 值将作为字节数组返回。VBScript 可以引用变量中的字节数组，它可以将该字节数组作为变量传递给另一个函数或作为对字节数组的引用。然而 VBScript 本身不能对数组做任何事情。

您将需要一些其他组件来执行一些连接：-

```
Function ConcatByteArrays(ra, rb)
    Dim oStream : Set oStream = CreateObject("ADODB.Stream")
    oStream.Open
    oStream.Type = 1 'Binary'
    oStream.Write ra
    oStream.Write rb

    oStream.Position = 0

    ConcatByteArrays = oStream.Read(LenB(ra) + LenB(rb))
    oStream.Close

End Function 
```

在上面的代码中，我使用了在当前支持的平台上普遍存在的 ADODB.Stream 对象。

如果您实际上有多个要连接的数组，那么您可以使用以下类：-

```
Class ByteArrayBuilder
    Private moStream

    Sub Class_Initialize()
        Set moStream = CreateObject("ADODB.Stream")
        moStream.Open
        moStream.Type = 1
    End Sub

    Public Sub Append(rabyt)
        moStream.Write rabyt
    End Sub

    Public Property Get Length
        Length = moStream.Size
    End Property

    Public Function GetArray()
        moStream.Position = 0
        GetArray = moStream.Read(moStream.Size)
    End Function

    Sub Class_Terminate()
        moStream.Close
    End Sub

End Class 
```

只要有数组就调用 append 并使用 GetArray 检索结果数组。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-17T20:28:46.363

作为记录，我希望大型用户群的 VBScript 代码作为登录脚本失败的可能性最小。我喜欢 ADO 对象，但是有很多神秘的方式可以破坏 ADO，所以我回避了 ADODB.Stream。

相反，我能够编写转换代码将二进制转换为十六进制编码的字符串。然后，为了写回一个`REG_BINARY`值，我将其转换为整数数组并将其提供给`SetBinaryValue`WMI 方法。

注意：`WshShell`只能处理`REG_BINARY`包含 4 个字节的值，因此无法使用。

感谢您的反馈。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:45:43.307

也许...

```
result = CStr(val1) & CStr(val2) 
```

# windows-mobile - 紧凑框架图片框控件中的 System.NotSupportedException 错误。如何在 Compact 框架中制作图片按钮？

> ID：184585
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T20:00:49.447
> 
>         
> 
> 标签：windows-mobile, compact-framework

我正在尝试在紧凑的框架中制作图片按钮。我制作了一个用户控件并添加了一个图片框。我看到您可以覆盖普通 Windows 窗体的文本和字体。但似乎无法做到紧凑。它使VS2008崩溃。有人做过吗？  

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:08:40.117

考虑使用 OpenNETCF 的[智能设备框架](http://www.opennetcf.com/library/sdf/)。每当我尝试自定义 UI 并且紧凑的框架让我失望时，SDF 通常已经“修复”了它。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:14:06.690

谢谢，我们已经在使用它来选择 MAC 地址。我真的很惊讶紧凑的框架中遗漏了多少。

# regex - 是否有与 Perl 兼容的正则表达式来修剪字符串两侧的空格？

> ID：184590
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2008-10-08T20:02:27.167
> 
>         
> 
> 标签：regex, perl, whitespace, trim

有没有办法在一行中做到这一点？

```
$x =~ s/^\s+//;
$x =~ s/\s+$//; 
```

换句话说，从字符串中删除所有前导和尾随空格。

* * *

## 回答 #1

> 赞同：30
> 
>             
> 
> 时间：2008-10-08T20:48:56.463

我的第一个问题是……为什么？我没有看到任何单正则表达式解决方案比您开始使用的正则表达式更具可读性。而且他们肯定没有那么快。

```
#!/usr/bin/perl

use strict;
use warnings;

use Benchmark qw(:all);

my $a = 'a' x 1_000;

my @x = (
         "    $a   ",
         "$a   ",
         $a,
         "    $a"
        );

cmpthese(-5,
         {
             single => sub {
                 for my $s (@x)
                 {
                     my $x = $s;
                     $x =~ s/^\s+|\s+$//g;
                 }
             },
             double => sub {
                 for my $s (@x)
                 {
                     my $x = $s;
                     $x =~ s/^\s+//;
                     $x =~ s/\s+$//;
                 }
             },
             trick => sub {
                 for my $s (@x)
                 {
                     my $x = $s;
                     s/^\s+//, s/\s+$// for $x;
                 }
             },
             capture => sub {
                 for my $s (@x)
                 {
                     my $x = $s;
                     $x =~ s/\A\s*(.*?)\s*\z/$1/
                 }
             },
             kramercap => sub {
                 for my $s (@x)
                 {
                     my $x = $s;
                     ($x) = $x =~ /^\s*(.*?)\s*$/
                 }
             },
         }
        ); 
```

在我的机器上给出以下结果：

```
             率单捕获 Kramercap 技巧双倍
单 2541/s -- -12% -13% -96% -96%
捕获 2902/s 14% -- -0% -95% -96%
kramercap 2911/s 15% 0% -- -95% -96%
技巧 60381/s 2276% 1981% 1974% -- -7%
双 65162/s 2464% 2145% 2138% 8% --

```

**编辑**：runrig 是对的，但变化不大。我已经更新了代码以在修改之前复制字符串，这当然会减慢速度。我还在另一个答案中考虑了 brian d foy 的建议，即使用更长的字符串（尽管一百万似乎过大了）。然而，这也表明，在你选择技巧风格之前，你要弄清楚你的弦长是什么样的——短弦会削弱技巧的优势。尽管如此，我已经测试了所有长度，双赢。而且它仍然更容易在眼睛上。

* * *

## 回答 #2

> 赞同：26
> 
>             
> 
> 时间：2008-10-08T20:08:49.743

```
$x =~ s/^\s+|\s+$//g; 
```

或者

```
s/^\s+//, s/\s+$// for $x; 
```

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2008-10-08T21:31:52.693

有趣的是你应该提出这个！

我最近阅读[了一篇文章，分析了十二种（！）不同修剪实现的性能](http://blog.stevenlevithan.com/archives/faster-trim-javascript)。

虽然本文专门使用 JavaScript 正则表达式实现，但它使用 Perl 语法，所以我认为它适合这个讨论。

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2008-10-08T22:14:03.203

Tanktalus 展示了非常小的琴弦的基准，但随着琴弦变大，问题会变得更糟。在他的代码中，我更改了顶部：

```
my $a = 'a' x 1_000_000;

my @x = (
  "   $a   ",
  "$a    ",
  $a,
  "    $a"
  ); 
```

我得到这些结果：

```
 Rate  single capture   trick  double
single  2.09/s      --    -12%    -98%    -98%
capture 2.37/s     13%      --    -98%    -98%
trick   96.0/s   4491%   3948%      --     -0%
double  96.4/s   4512%   3967%      0%      -- 
```

随着字符串变大，使用“trick”和“double”几乎相同，并且大多数人都采用的常见解决方案，“single”（包括我，因为即使我知道这一点，我也无法打破这个习惯），真的开始很烂。

每当您查看基准时，请考虑它告诉您的内容。要查看是否理解，请更改数据并重试。使数组变长，标量变大，等等。使循环、grep 或正则表达式在开头、中间和结尾查找内容。看看新结果是否符合您的预测。弄清楚趋势是什么。性能会变得越来越好，接近极限，达到峰值然后开始下降，还是其他？

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T21:11:47.883

从异端争论，为什么要这样做？所有上述解决方案都是“正确的”，因为它们在一次通过中从字符串的两侧修剪空白，但没有一个非常可读（可能是[这个](https://stackoverflow.com/questions/184590/is-there-a-perl-compatible-regular-expression-to-trim-whitespace-from-both-side#184612)）。除非您的代码的受众是由专家级 Perl 编码人员组成，否则上述每个候选人都应该有一个评论来描述他们所做的事情（无论如何可能是个好主意）。相比之下，这两行代码完成了同样的事情，而无需使用前瞻、通配符、midichlorines 或任何对于中等经验的程序员来说并不明显的东西：

```
$string =~ s/^\s+//;
$string =~ s/\s+$//; 
```

（可以说）性能会受到影响，但只要您不关心执行时的几微秒，增加的可读性将是值得的。恕我直言。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T20:06:06.877

干得好：`$x =~ s/\A\s*(.*?)\s*\z/$1/;` 

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:06:19.577

$x =~ s/(^\s+)|(\s+$)//g;

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T23:02:20.750

我通常这样做：

```
($foo) = $foo =~ /^\s*(.*?)\s*$/; 
```

前导空格和尾随空格之间的所有内容都被分组并返回，因此我可以将其分配给同一个旧变量。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:07:23.020

或这个：`s/\A\s*|\s*\Z//g`

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:08:34.360

```
s/^\s*(\S*\S)\s*$/$1/ 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2020-08-05T13:13:49.147

在激活 PCRE 模式的 zsh 中：

```
function trim() {
    local out="$*"
    [[ "$out" =~ '^\s*(.*\S)\s*$' ]] && out="$match[1]" || out=''
    print -nr -- "$out"
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
>             
> 
> 时间：2009-11-10T19:40:50.580

```
$var1 =~ s/(^\s*)(.*?)(\s*$)+/$2/; 
```

* * *

## 回答 #13

> 赞同：-2
> 
>             
> 
> 时间：2008-10-08T20:07:04.393

```
$x =~ s/^\s*(.*?)\s*$/$1/; 
```

# sql - MySQL中的减号？

> ID：184592
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-08T20:02:41.190
> 
>         
> 
> 标签：sql, mysql

我有主题（id*）和标签（id*，名称）和链接表topic_tags（topicFk *，tagFk *）。

现在我想选择每一个主题，它包含所有好的标签（a、b、c）但没有坏标签（d、e、f）。

我怎么做？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T20:59:29.640

假设您的 Topic_Tags 表是唯一的，这可以回答您的*确切*问题 - 但可能无法推广到您的实际问题：

```
SELECT
  TopicId
FROM Topic_Tags
JOIN Tags ON
  Topic_Tags.TagId = Tags.TagId
WHERE
  Tags.Name IN ('A', 'B', 'C', 'D', 'E', 'F')
GROUP BY
  TopicId
HAVING
  COUNT(*) = 3 
  AND MAX(Tags.Name) = 'C' 
```

更通用的解决方案是：

```
SELECT 
    * 
FROM (
    SELECT
        TopicId
    FROM Topic_Tags
    JOIN Tags ON
        Topic_Tags.TagId = Tags.TagId
    WHERE
        Tags.Name IN ('A', 'B', 'C')
    GROUP BY
        TopicId
    HAVING
        COUNT(*) = 3 
) as GoodTags
LEFT JOIN (
    SELECT
        TopicId
    FROM Topic_Tags
    JOIN Tags ON
        Topic_Tags.TagId = Tags.TagId
    WHERE
        Tags.Name = 'D'
        OR Tags.Name = 'E'
        OR Tags.Name = 'F'
) as BadTags ON
    GoodTags.TopicId = BadTags.TopicId
WHERE
    BadTags.TopicId IS NULL 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T20:07:10.120

这是一个可行的解决方案，但需要为您需要的每个标签加入。  

> ```
> SELECT *
> FROM topics
> WHERE topic_id IN
>     (SELECT topic_id
>     FROM topic_tags a
>     INNER JOIN topic_tags b
>       on a.topic_id=b.topic_id
>       and b.tag = 'b'
>     INNER JOIN topic_tags c
>       on b.topic_id=c.topic_d
>       and c.tag = 'c'
>     WHERE a.tag = 'a')
> AND topic_id NOT IN
>     (SELECT topic_id
>     FROM topic_tags
>     WHERE tag = 'd' or tag = 'e' or tag = 'f') 
> ```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T21:10:46.217

这是另一个替代查询。也许将好标签和坏标签列表放在顶部会更清晰和方便。我在 MySQL 5.0 上对此进行了测试。

```
SELECT t.*, 
  SUM(CASE WHEN g.name IN ('a', 'b', 'c') THEN 1 ELSE 0 END) AS num_good_tags,
  SUM(CASE WHEN g.name IN ('d', 'e', 'f') THEN 1 ELSE 0 END) AS num_bad_tags
FROM topics AS t
 JOIN topic_tags AS tg ON (t.id = tg.topicFk)
 JOIN tags AS g ON (g.id = tg.tagFk)
GROUP BY t.id
HAVING num_good_tags = 3 AND num_bad_tags = 0; 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:17:30.223

正如所写的那样，还有其他 3 个答案出现了，但这是不同的，所以无论如何我都会发布它。

这个想法是选择所有带有 a,b,c 标签的主题，然后用左连接识别那些也有 d,e,f 的主题，然后用 where 子句过滤掉那些在那个连接上寻找空值的主题。 .

```
select distinct topics.id from topics 
inner join topic_tags as t1 
    on (t1.topicFK=topics.id)
inner join tags as goodtags 
    on(goodtags.id=t1.tagFK and goodtags.name in ('a', 'b', 'c'))
left join topic_tags as t2 
    on (t2.topicFK=topics.id)
left join tags as badtags 
    on(badtags .id=t2.tagFK and batags.name in ('d', 'e', 'f'))
where badtags.name is null; 
```

完全未经测试，但希望你能看到逻辑的来源。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:13:16.830

不完全确定我理解，我希望有更好的方法来做好的标签部分，但是：

```
select id from topic
    inner join topic_tags tta on topic.id=tta.topicFk and tta.tagFk=a
    inner join topic_tags ttb on topic.id=ttb.topicFk and ttb.tagFk=b
    inner join topic_tags ttc on topic.id=ttc.topicFk and ttc.tagFk=c
    left join topic_tags tt on topic.id=tt.topicFk and tt.tagFk in (d,e,f)
    where tt.topicFk is null; 
```

更新：是这样的：

```
select id from topic
    left join topic_tags tt on topic.id=tt.topicFk and tt.tagFk in (d,e,f)
    where tt.topicFk is null and
        3=(select count(*) from topic_tags where topicFk=topic.id and tagFk in (a,b,c)); 
```

我看到一个答案，假设 a、b、c、d、e、f 是名称，而不是 ID。如果是这样，那么这个：

```
select id from topic
    left join topic_tags tt on topic.id=tt.topicFk
        inner join tags on tt.tagFk=tags.id and tags.name in (d,e,f)
    where tt.topicFk is null and
       3=(select count(*) from tags inner join topic_tags on tags.id=topic_tags.tagFk and topic_tags.topicFk=topic.id where tags.name in (a,b,c)); 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:22:16.890

您可以使用`minus`关键字过滤掉带有不需要标签的主题。

```
-- All topics with desired tags.
select distinct T.*
from Topics T inner join Topics_Tags R on T.id = R.topicFK
              inner join Tags U on U.id = R.topic=FK
where U.name in ('a', 'b', 'c')

minus

-- All topics with undesired tags. These are filtered out.
select distinct T.*
from Topics T inner join Topics_Tags R on T.id = R.topicFK
              inner join Tags U on U.id = R.topic=FK
where U.name in ('d', 'e', 'f') 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-09T00:46:14.533

我自己使用 Pauls 和 Bills 想法的解决方案。

这个想法是用好的标签内部连接主题（丢弃没有好的标签的主题），然后计算每个主题的唯一标签（以验证所有好的标签都存在）。

同时，带有坏标签的外连接不应该有一个匹配项（所有字段都是 NULL）。

```
SELECT topics.id
FROM topics
  INNER JOIN topic_tags topic_ptags
    ON topics.id = topic_ptags.topicFk
  INNER JOIN tags ptags
    ON topic_ptags.tagFk = ptags.id
      AND ptags.name IN ('a','b','c')
  LEFT JOIN topic_tags topic_ntags
    ON topics.id = topic_ntags.topicFk
  LEFT JOIN tags ntags
    ON topic_ntags.tagFk = ntags.id
      AND ntags.name IN ('d','e','f')
GROUP BY topics.id
HAVING count(DISTINCT ptags.id) = 3
  AND count(ntags.id) = 0 
```

# ruby-on-rails - 与多个数据库有并属于许多关系

> ID：184600
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2008-10-08T20:03:45.713
> 
>         
> 
> 标签：ruby-on-rails, ruby, database, has-and-belongs-to-many

我有一种情况，我有两个模型，公司和权限，其中公司位于与我的权限数据库不同的数据库中。这是一个拥有和属于很多的关系，因为每个公司可以有很多权限，每个权限可以属于很多公司。

两个数据库分开的原因是公司数据库运行一个高需求的生产应用程序，而权限数据库控制另一个应用程序的权限。

使用 rails，它会在与主表相同的数据库中查找连接表。例如，如果我执行 company.permissions，它会在公司数据库中查找 company_permissions。如果我做 permission.companies 它会在权限数据库中查找。

使用与多个数据库具有和属于多个关系的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-10-08T20:50:48.237

拥有和属于许多是旧的、笨重的和有问题的。我建议改用 has_many。您可以使用“:through”选项指定关系表；只需选择您希望它驻留的数据库并创建一个模型来表示它。
[http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_many](http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_many)

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-10-09T07:52:51.147

有趣的问题。为了我自己的参考，让我尝试在这个问题的上下文中总结*Rails 食谱*书中提出的解决方案。

1）首先添加*database.yml*

```
permissions:
  adapter: mysql
  database: permissions
  username: root
  password: 
  socket: /tmp/mysql.sock 
```

2）制作权限模型调用外部数据库

```
class Permission < ActiveRecord::Base

  establish_connection :permissions

end 
```

3) 创建（迁移）具有*Permission Id*列的*Permission Reference 表*

 *4) 使用*PermissionReference*模型作为*Permission*模型的链接

```
class PermissionReference < ActiveRecord::Base

  belongs_to :permission
  has_and_belongs_to_many :companies,
                          :join_table => 'companies_permissions',
                          :foreign_key => 'permission_id'

end 
```

5）最后将公司关联到许可

```
class Company < ActiveRecord::Base

  has_and_belongs_to_many :permissions, 
                          :class_name => 'PermissionReference', 
                          :join_table => 'companies_permissions', 
                          :association_foreign_key => 'permission_id'

end 
```

您可能想考虑通过子类化调用外部数据库的模型来进行重构

```
class External < ActiveRecord::Base

  self.abstract_class = true
  establish_connection :permissions

end

class Permission < External
end 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:28:17.847

如果公司数据不经常变化，也许你可以将数据同步到权限数据库中，然后自然加入。我继承的 CMS 正在做类似的事情，其中​​用户身份验证位于其自己的数据库中，权限等都存储在那里，并且用户帐户与每个站点的本地数据库同步。通过这种方式，用户帐户可以通过 1 次登录在多个站点之间共享（尤其是用于管理）。

可能不是最好的，因为涉及同步。理想情况下，如果您无法将权限移出，您应该只将公司数据存储在权限数据库中。当然，除非你在其他地方加入公司。

# java - 在循环的每次迭代中重新分配变量会影响性能吗？

> ID：184609
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T20:05:40.840
> 
>         
> 
> 标签：java, optimization

考虑以下两种在 Java 中编写循环以查看列表是否包含给定值的方法：

### 样式 1

```
boolean found = false;
for(int i = 0; i < list.length && !found; i++)
{
   if(list[i] == testVal)
     found = true;
} 
```

### 风格 2

```
boolean found = false;
for(int i = 0; i < list.length && !found; i++)
{
   found = (list[i] == testVal);
} 
```

两者是等价的，但我总是使用样式 1，因为 1）我发现它更具可读性，以及 2）我假设重新分配`found`数百`false`次感觉需要更多时间。我想知道：第二个假设是真的吗？

### 挑剔者的角落

*   我很清楚这是一个过早优化的情况。这并不意味着知道它不是有用的东西。

*   我不在乎你认为哪种风格更具可读性。我只对一个与另一个相比是否有性能损失感兴趣。

*   我知道样式 1 的优点是允许您`break;`在块中也放置一个语句`if`，但我不在乎。同样，这个问题是关于性能，而不是风格。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-10-08T20:34:25.807

好吧，只写一个微基准：

```
导入 java.util.*；

公共类测试{
    私有静态 int[] list = new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9} ;
    私有静态int testVal = 6；

    公共静态布尔版本1（）{
        布尔发现=假；
        for(int i = 0; i < list.length && !found; i++)
        {
        如果（列表 [i] == testVal）
            找到=真；
        }
        发现退货；

    }

    公共静态布尔版本2（）{
    布尔发现=假；
    for(int i = 0; i < list.length && !found; i++)
        {
        找到 = (list[i] == testVal);
        }

    发现退货；
    }

    公共静态无效主要（字符串[]参数）{

        // 暖身
    对于 (int i=0; i<100000000; i++) {
        版本1（）；
        版本2（）；
    }

    长时间 = System.currentTimeMillis();
    对于 (int i=0; i<100000000; i++) {
        版本1（）；
    }

    System.out.println("Version1:" + (System.currentTimeMillis() - time));

    时间 = System.currentTimeMillis();
    对于 (int i=0; i@lt;100000000; i++) {
        版本2（）；
    }

        System.out.println("Version2:" + (System.currentTimeMillis() - time));
    }
}

```

在我的机器上 version1 似乎要快一点：

版本1：5236

版本 2：5477

（但在 1 亿次迭代中这是 0.2 秒。我不在乎这个。）

如果您查看生成的字节码，则版本 2 中还有两条指令可能会导致执行时间更长：

```
公共静态布尔版本1（）；
  代码：
   0：iconst_0
   1：istore_0
   2：iconst_0
   3：istore_1
   4：iload_1
   5：获取静态#2；//字段列表：[I
   8：数组长度
   9: if_icmpge 35
   12：iload_0
   13：如果 35
   16：获取静态#2；//字段列表：[I
   19：iload_1
   20：加载
   21：获取静态#3；//现场testVal:I
   24: if_icmpne 29
   27：图标st_1
   28: istore_0
   29: iinc 1, 1
   32：转到 4
   35: iload_0
   36：回归

公共静态布尔版本2（）；
  代码：
   0：iconst_0
   1：istore_0
   2：iconst_0
   3：istore_1
   4：iload_1
   5：获取静态#2；//字段列表：[I
   8：数组长度
   9: if_icmpge 39
   12：iload_0
   13：如果 39
   16：获取静态#2；//字段列表：[I
   19：iload_1
   20：加载
   21：获取静态#3；//现场testVal:I
   24: if_icmpne 31
   27：图标st_1
   28：转到 32
   31：图标st_0
   32: istore_0
   33: iinc 1, 1
   36：转到 4
   39: iload_0
   40：回归

```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T21:52:43.010

关于nitpicks角的评论：

如果您*真的*关心绝对性能，那么插入并删除“&& !found”理论上会给您在#1 上更好的性能。每次迭代都少了两个二进制操作。

如果您想在不使用中断的情况下真正了解优化，那么

```
boolean notFound = true;
    for(int i = 0; notFound && i < list.length; i++)
    {
       if(list[i] == testVal)
         notFound = false;
    } 
```

在平均情况下将比现有选项#1 运行得更快。

当然这是个人喜好，但我更喜欢永远不要在 for 循环的头部放置任何额外的评估。我发现它在阅读代码时会引起混乱，因为它很容易错过。如果我无法使用 break/continues 获得所需的行为，我将使用 while 或 do/while 循环。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:09:09.960

实际上，由于[pipeline](http://en.wikipedia.org/wiki/Pipeline_(computing))的原因，“if”会比分配更慢。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:08:51.677

这取决于您使用的编译器，因为不同的编译器可能会进行不同的优化。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:09:58.210

我相信样式 2 会稍微快一点——比如 1 个时钟周期左右。

不过，如果我正在处理它，我会将其重写为以下内容：

```
for(i=0; i<list.length && list[i]!=testval; i++);
boolean found = (i!=list.length); 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:38:14.003

在我看来，如果您希望在列表末尾之前找到您的值，那么使用 #2 会更好 - 因为它会在有条件的循环中使用 !found 短路检查。假设您插入第一个选项（唯一明智的事情，IMO），那么伪汇编看起来像：

选项1：

```
start:
  CMP i, list.length
  JE end
  CMP list[i], testval
  JE equal
  JMP start
equal:
  MOV true, found
end: 
```

选项 2：

```
start:
  CMP i, list.length
  JE end
  CMP true, found
  JE end
  CMP list[i], testval
  JE equal
  JNE notequal
equal:
  MOV true, found
  JMP start
notequal:
  MOV false, found
  JMP start
end: 
```

我想说选项 1 在这里更好，因为它的指令少了大约 1/3。当然，这没有优化——但这取决于编译器和特定情况（在此之后发现了什么？我们可以一起优化它吗？）。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-10-16T11:13:04.910

这是另一种风格

```
for(int i = 0; i < list.length; i++)
{
   if(list[i] == testVal)
     return true;
}

return false; 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-11-20T08:40:42.750

从性能的角度来看，我认为这两种选择都有不足之处。

想想每次迭代你做了多少测试（几乎总是跳跃），并尽量减少数量。

Matt 的解决方案是在找到答案时返回，将测试数量从三个（循环迭代器、循环中的发现测试、实际比较）减少到两个。基本上两次进行“找到”测试是浪费的。

我不确定经典但有点令人困惑的向后循环技巧是否是 Java 中的胜利，并且在阅读 JVM 代码方面也不够热，现在也无法弄清楚。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:08:58.557

我想说，在 98% 的系统中，这无关紧要。除非该循环是代码的主要部分并且运行了令人难以置信的次数，否则这种差异（如果有的话）几乎不会引起注意。

编辑：这当然是假设编译器尚未对其进行优化。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:09:47.290

任何体面的编译器都会在循环期间保持在寄存器中，因此成本绝对可以忽略不计。

如果第二种风格是在没有分支的情况下完成的，那么它会更可取，因为 CPU 的管道不会受到太多干扰......但这取决于编译器如何使用指令集。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:19:00.190

这只能在对性能极其敏感的代码（模拟器、仿真器、视频编码软件等）中测量，在这种情况下，您可能无论如何都需要手动检查生成的代码，以确保编译器确实生成了合理的代码。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:36:37.847

可以肯定的是，您应该编译这两个版本（比如使用 Sun 的最新编译器）并使用适当的工具检查生成的字节码......这是唯一可靠的确定方法，其他一切都是猜测。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:51:13.203

```
boolean found = false;
for(int i = 0; i < list.length && !found; i++)
{
   if(list[i] == testVal)
     found = true;
} 
```

我在块中没有看到 break 语句。

除此之外，我更喜欢这种风格。它提高了可读性，从而提高了维护者误读和错误修复它的机会。

# comments - 你在源代码中遇到过的最好的注释是什么？

> ID：184618
> 
>         
> 
> 赞同：360
> 
>         
> 
> 时间：2008-10-08T20:08:07.967
> 
>         
> 
> 标签：comments

你在源代码中遇到过的最好的注释是什么？

* * *

## 回答 #1

> 赞同：1460
> 
>             
> 
> 时间：2009-01-27T02:21:22.130

我对此感到特别内疚，在我的大多数项目中嵌入了非建设性的评论、代码诗和小笑话（尽管我通常有足够的意识在发布代码之前删除任何直接冒犯的东西）。这是我特别喜欢的一个，放置在一个设计不佳的“上帝之物”的很远很远的地方：

```
/**
* For the brave souls who get this far: You are the chosen ones,
* the valiant knights of programming who toil away, without rest,
* fixing our most awful code. To you, true saviors, kings of men,
* I say this: never gonna give you up, never gonna let you down,
* never gonna run around and desert you. Never gonna make you cry,
* never gonna say goodbye. Never gonna tell a lie and hurt you.
*/ 
```

**抱歉！！！！**我简直无法自拔……！

还有一个，我承认我并没有真正释放到野外，尽管我很想在我不太直观的课程中这样做*：*

```
// 
// Dear maintainer:
// 
// Once you are done trying to 'optimize' this routine,
// and have realized what a terrible mistake that was,
// please increment the following counter as a warning
// to the next guy:
// 
// total_hours_wasted_here = 42
// 
```

* * *

## 回答 #2

> 赞同：1054
> 
>             
> 
> 时间：2009-02-14T19:21:06.767

```
Exception up = new Exception("Something is really wrong.");
throw up;  //ha ha 
```

* * *

## 回答 #3

> 赞同：1051
> 
>             
> 
> 时间：2008-11-25T02:50:46.980

```
//When I wrote this, only God and I understood what I was doing
//Now, God only knows 
```

* * *

## 回答 #4

> 赞同：1048
> 
>             
> 
> 时间：2008-10-09T07:52:35.220

```
stop(); // Hammertime! 
```

* * *

## 回答 #5

> 赞同：1028
> 
>             
> 
> 时间：2009-04-11T18:42:40.363

这似乎阻止了白痴弄乱我的代码......

```
// Autogenerated, do not edit. All changes will be undone. 
```

* * *

## 回答 #6

> 赞同：944
> 
>             
> 
> 时间：2008-10-09T03:12:39.123

```
// sometimes I believe compiler ignores all my comments 
```

* * *

## 回答 #7

> 赞同：929
> 
>             
> 
> 时间：2008-10-09T12:07:26.453

```
// I dedicate all this code, all my work, to my wife, Darlene, who will 
// have to support me and our three children and the dog once it gets 
// released into the public. 
```

* * *

## 回答 #8

> 赞同：909
> 
>             
> 
> 时间：2008-10-08T20:17:24.310

> ```
> //Code sanitized to protect the foolish.
> using System;
> using System.Collections.Generic;
> using System.Text;
> using System.Reflection;
> using System.Web.UI;
> 
> namespace Mobile.Web.Control
> {
>     /// <summary>
>     /// Class used to work around Richard being a fucking idiot
>     /// </summary>
>     /// <remarks>
>     /// The point of this is to work around his poor design so that paging will 
>     /// work on a mobile control. The main problem is the BindCompany() method, 
>     /// which he hoped would be able to do everything. I hope he dies.
>     /// </remarks>
>     public abstract class RichardIsAFuckingIdiotControl : MobileBaseControl, ICompanyProfileControl
>     {
>         protected abstract Pager Pager { get; }
> 
>         public void BindCompany(int companyId) { }
> 
>         public RichardIsAFuckingIdiotControl()
>         {
>             MakeSureNobodyAccidentallyGetsBittenByRichardsStupidity();
>         }
> 
>         private void MakeSureNobodyAccidentallyGetsBittenByRichardsStupidity()
>         {
>             // Make sure nobody is actually using that fucking bindcompany method
>             MethodInfo m = this.GetType().GetMethod("BindCompany", BindingFlags.DeclaredOnly | 
>                 BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic);
>             if (m != null)
>             {
>                 throw new RichardIsAFuckingIdiotException("No!! Don't use the fucking BindCompany method!!!");
>             }
>             // P.S. this method is a joke ... the rest of the class is fucking serious
>         }
> 
>         /// <summary>
>         /// This returns true if this control is supposed to be doing anything
>         /// at all for this request. Richard thought it was a good idea to load
>         /// the entire website during every request and have things turn themselves
>         /// off. He also thought bandanas and aviator sunglasses were "fuckin' 
>         /// gnarly, dude."
>         /// </summary>
>         protected bool IsThisTheRightPageImNotSureBecauseRichardIsDumb()
>         {
>             return Request.QueryString["Section"] == this.MenuItemKey;
>         }
> 
>         protected override void OnLoad(EventArgs e)
>         {
>             if (IsThisTheRightPageImNotSureBecauseRichardIsDumb())
>             {
>                 Page.LoadComplete += new EventHandler(Page_LoadComplete);
>                 Pager.RowCount = GetRowCountBecauseRichardIsDumb();
>             }
>             base.OnLoad(e);
>         }
> 
>         protected abstract int GetRowCountBecauseRichardIsDumb();
>         protected abstract void BindDataBecauseRichardIsDumb();
> 
>         void Page_LoadComplete(object sender, EventArgs e)
>         {
>             BindDataBecauseRichardIsDumb();
>         }
> 
>         // the rest of his reduh-ndant interface members
>         public abstract string MenuItemName { get; set; }
>         public abstract string MenuItemKey { get; set; }
>         public abstract bool IsCapable(CapabilityCheck checker, int companyId);
>         public abstract bool ShowInMenu { get; }
>         public virtual Control CreateHeaderControl()
>         {
>             return null;
>         }
>     }
> } 
> ```

**更新：**  代码的原作者[已经出局了](http://mcfunley.com/438/from-the-annals-of-dubious-achievement)，所以我必须在应得的地方给予赞扬。[Dan McKinley](http://mcfunley.com/)在我刚开始工作后不久就离开了我所在的公司，他更多地谈论了代码，解释了一些背景和一些“Richard”写的“WTF”。

* * *

## 回答 #9

> 赞同：825
> 
>             
> 
> 时间：2009-04-22T17:11:20.923

```
// somedev1 -  6/7/02 Adding temporary tracking of Login screen
// somedev2 -  5/22/07 Temporary my ass 
```

* * *

## 回答 #10

> 赞同：727
> 
>             
> 
> 时间：2008-10-08T22:34:08.920

```
// drunk, fix later 
```

真希望我在开玩笑。并且了解编写代码的开发人员，我认为他是字面意思。

* * *

## 回答 #11

> 赞同：719
> 
>             
> 
> 时间：2008-10-08T22:07:17.740

```
// Magic. Do not touch. 
```

* * *

## 回答 #12

> 赞同：701
> 
>             
> 
> 时间：2009-04-21T10:30:48.493

 `#define TRUE FALSE
    //Happy debugging suckers` 

* * *

## 回答 #13

> 赞同：639
> 
>             
> 
> 时间：2008-10-08T20:21:34.397

```
// I'm sorry. 
```

* * *

## 回答 #14

> 赞同：635
> 
>             
> 
> 时间：2008-10-08T23:13:06.983

```
return 1; # returns 1 
```

* * *

## 回答 #15

> 赞同：590
> 
>             
> 
> 时间：2008-10-09T01:16:54.003

```
/* This is O(scary), but seems quick enough in practice. */ 
```

后跟四个嵌套的 for 循环

* * *

## 回答 #16

> 赞同：589
> 
>             
> 
> 时间：2009-04-19T23:20:36.537

```
// Replaces with spaces the braces in cases where braces in places cause stasis 
   $str = str_replace(array("\{","\}")," ",$str); 
```

* * *

## 回答 #17

> 赞同：542
> 
>             
> 
> 时间：2008-10-08T21:28:38.990

它充分说明了我们的职业，当被问及“最佳评论”时，我们都回答了我们能找到的最糟糕的评论......

* * *

## 回答 #18

> 赞同：525
> 
>             
> 
> 时间：2008-10-09T14:03:55.843

```
long john; // silver 
```

* * *

## 回答 #19

> 赞同：506
> 
>             
> 
> 时间：2008-10-08T20:19:08.253

```
Catch (Exception e) {
 //who cares?
} 
```

* * *

## 回答 #20

> 赞同：496
> 
>             
> 
> 时间：2008-12-23T18:45:16.927

```
/**
 * Always returns true.
 */
public boolean isAvailable() {
    return false;
} 
```

永远不要依赖评论...

* * *

## 回答 #21

> 赞同：457
> 
>             
> 
> 时间：2008-10-10T01:54:03.023

```
/*
 * You may think you know what the following code does.
 * But you dont. Trust me.
 * Fiddle with it, and youll spend many a sleepless
 * night cursing the moment you thought youd be clever
 * enough to "optimize" the code below.
 * Now close this file and go play with something else.
 */ 
```

* * *

## 回答 #22

> 赞同：429
> 
>             
> 
> 时间：2008-10-10T19:54:35.670

```
try {

} finally { // should never happen 

} 
```

* * *

## 回答 #23

> 赞同：411
> 
>             
> 
> 时间：2009-04-20T18:10:28.833

来自：[https ://github.com/zepouet/Xee-xCode-4.5/blob/master/XeePhotoshopLoader.m#L108](https://github.com/zepouet/Xee-xCode-4.5/blob/master/XeePhotoshopLoader.m#L108)

```
// At this point, I'd like to take a moment to speak to you about the Adobe PSD
// format. PSD is not a good format. PSD is not even a bad format. Calling it
// such would be an insult to other bad formats, such as PCX or JPEG. No, PSD
// is an abysmal format. Having worked on this code for several weeks now, my
// hate for PSD has grown to a raging fire that burns with the fierce passion
// of a million suns.
//
// If there are two different ways of doing something, PSD will do both, in
// different places. It will then make up three more ways no sane human would
// think of, and do those too. PSD makes inconsistency an art form. Why, for
// instance, did it suddenly decide that *these* particular chunks should be
// aligned to four bytes, and that this alignement should *not* be included in
// the size? Other chunks in other places are either unaligned, or aligned with
// the alignment included in the size. Here, though, it is not included. Either
// one of these three behaviours would be fine. A sane format would pick one.
// PSD, of course, uses all three, and more.
//
// Trying to get data out of a PSD file is like trying to find something in the
// attic of your eccentric old uncle who died in a freak freshwater shark
// attack on his 58th birthday. That last detail may not be important for the
// purposes of the simile, but at this point I am spending a lot of time
// imagining amusing fates for the people responsible for this Rube Goldberg of
// a file format.
//
// Earlier, I tried to get a hold of the latest specs for the PSD file format.
// To do this, I had to apply to them for permission to apply to them to have
// them consider sending me this sacred tome. This would have involved faxing
// them a copy of some document or other, probably signed in blood. I can only
// imagine that they make this process so difficult because they are intensely
// ashamed of having created this abomination. I was naturally not gullible
// enough to go through with this procedure, but if I had done so, I would have
// printed out every single page of the spec, and set them all on fire. Were it
// within my power, I would gather every single copy of those specs, and launch
// them on a spaceship directly into the sun.
//
// PSD is not my favourite file format. 
```

* * *

## 回答 #24

> 赞同：387
> 
>             
> 
> 时间：2008-10-09T02:29:17.557

```
const int TEN=10; // As if the value of 10 will fluctuate... 
```

* * *

## 回答 #25

> 赞同：364
> 
>             
> 
> 时间：2009-04-23T04:50:11.710

```
 #Christmas tree initializer  
    toConnect = []  
    toRead =   [  ]  
    toWrite = [    ]   
    primes = [      ]  
    responses = {}  
    remaining = {} 
```

* * *

## 回答 #26

> 赞同：362
> 
>             
> 
> 时间：2008-10-08T22:22:59.033

大约30页xslt的中间

```
<!-- Here be dragons  --> 
```

* * *

## 回答 #27

> 赞同：353
> 
>             
> 
> 时间：2009-03-05T17:53:46.060

```
long long ago; /* in a galaxy far far away */ 
```

* * *

## 回答 #28

> 赞同：352
> 
>             
> 
> 时间：2008-10-08T20:55:07.167

在完全未注释的 2000 行方法中

```
{ 
  { 
    while (.. ){ 
      if (..){
          }
      for (.. ){ 
          }
         .... (just putting in the control flow here, imagine another few hundred ifs)
      if(..)   {
            if(..)     {
                   if(..)   {
                ...
                (another few hundred brackets)
                       }
                  }
         } //endif 
```

（实际上，有一天我把所有的括号都找出来了，只是为了看看它有多糟糕，而且，没有格式化，得到了这个：

```
{{{{}}{}{}{}{}}{{}{{}{}{}{}{}{}{{}{}}{}{}{{}{}{}{}{}{}{}{}{}{}{}{{}}}{{}{{}}{{{}}}{{}{}{}{}{}{}{}{{}}{}{{{}}{}{{}{}}{{{}}{}{}{}{}}{{}}}{}{{}{}{}{{}{{}}{}}{{}}}{{}}{{}}{{}}{}{{}}{{}}{{}}{{}{}{}}{}{}{{{}}{{}}}{}{}{}{}}{{{}{{}{}{}{{}{}{}{}{}{}}{}}{{}}{{}{}}}{{}}{{}}}{{}}{{}}{}{}{}{}{{}}{{}{}{}{}}}}{}{}}{{}{{{}{}{}{}}}}{{}{{{}}}}{{}{{{}{{}}{}{{}}{}{{}{}}{{}}{}{{}}}{{}}}}{{}{}{}{}{}{{{}    {{{{}}{}{}{}{}}{{}{{}{}{}{}{}{}{{}{}}{}{}{{}{}{}{}{}{}{}{}{}{}{}{{}}}{{}{{}}{{{}}}{{}{}{}{}{}{}{}{{}}{}{{{}}{}{{}{}}{{{}}{}{}{}{}}{{}}}{}{{}{}{}{{}{{}}{}}{{}}}{{}}{{}}{{}}{}{{}}{{}}{{}}{{}{}{}}{}{}{{{}}{{}}}{}{}{}{}}{{{}{{}{}{}{{}{}{}{}{}{}}{}}{{}}{{}{}}}{{}}{{}}}{{}}{{}}{}{}{}{}{{}}{{}{}{}{}}}}{}{}}{{}{{{}{}{}{}}}}{{}{{{}}}}{{}{{{}{{}}{}{{}}{}{{}{}}{{}}{}{{}}}{{}}}}{{}{}{}{}{}{{{}{}{{}}{}}}{}}{{}}{{}{}}{{}{{}{{}}}}{{{}{{{}}}}}{{{{{}}}}}{}{}{}{{{{}}}{}{}}{{}{{}}}}{}{{}}{}}}{}}{{}}{{}{}}{{}{{}{{}}}}{{{}{{{}}}}}{{{{{}}}}}{}{}{}{{{{}}}{}{}}{{}{{}}}} 
```

endif 出现在第 800 行左右）

* * *

## 回答 #29

> 赞同：352
> 
>             
> 
> 时间：2008-10-09T01:03:58.990

```
//This code sucks, you know it and I know it.  
//Move on and call me an idiot later. 
```

* * *

## 回答 #30

> 赞同：324
> 
>             
> 
> 时间：2008-10-08T21:20:54.480

```
// If this comment is removed the program will blow up 
```

* * *

## 回答 #31

> 赞同：296
> 
>             
> 
> 时间：2009-04-20T20:30:06.330

```
double penetration; // ouch 
```

* * *

## 回答 #32

> 赞同：290
> 
>             
> 
> 时间：2009-03-05T13:43:05.150

```
/////////////////////////////////////// this is a well commented line 
```

* * *

## 回答 #33

> 赞同：269
> 
>             
> 
> 时间：2008-10-11T16:23:05.237

```
// I don't know why I need this, but it stops the people being upside-down

x = -x; 
```

* * *

## 回答 #34

> 赞同：254
> 
>             
> 
> 时间：2008-10-09T06:31:05.710

其中最经典的一条是皮埃尔·德·费马 (Pierre de Fermat) 对他著名的“最后定理”的评论：“这一页的页边距太小，无法写下证明”。

350 多年后才找到证据……

（根据[维基百科](http://en.wikipedia.org/wiki/Fermat's_Last_Theorem)，这是原文：）

> Cubum autem in duos cubos, aut quadratoquadratum in duos quadratoquadratos, et generaliter nullam infinitum ultra quadratum potestatem in duos eiusdem nominis fas est dividere cuius rei demoem mirabilem sane detexi。Hanc marginis exiguitas non caperet。

...并翻译成英文：

> （不可能将一个立方体分成两个立方体，或者将一个四次方分成两个四次方，或者一般来说，任何高于第二个的幂都分成两个类似的幂。我发现了一个真正奇妙的证明，这个边距是太窄而无法容纳。）

* * *

## 回答 #35

> 赞同：254
> 
>             
> 
> 时间：2008-10-10T03:43:18.030

```
// I am not sure if we need this, but too scared to delete. 
```

* * *

## 回答 #36

> 赞同：233
> 
>             
> 
> 时间：2008-10-11T19:23:56.153

从 Java 1.2 SwingUtilities：

```
doRun.run();  // ... "a doo run run". 
```

* * *

## 回答 #37

> 赞同：229
> 
>             
> 
> 时间：2008-11-23T06:18:28.217

```
# To understand recursion, see the bottom of this file 
```

在文件的底部：

```
# To understand recursion, see the top of this file 
```

* * *

## 回答 #38

> 赞同：223
> 
>             
> 
> 时间：2008-10-19T18:00:31.263

This one was a living proof, in production code, of micro-management effects in our team:

```
// I am not responsible of this code.
// They made me write it, against my will. 
```

... followed by less than optimal code, conceived by our beloved technical director, who was quite fond of forcing down both code and coding guidelines into developers' throats (*).

Of course, when the project leader searched for the cause of a bug, and found it was inside the "less than optimal code", he was less than amused...

*(*) I am, of course, mentioning the* Mighty VB King*... If you want to assess the full magnitude of the power of the * Mighty VB King*, you can read the following SO post: [What was the strangest coding standard rule that you were forced to follow?](https://stackoverflow.com/questions/218123/what-was-the-strangest-coding-standard-rule-that-you-were-forced-to-follow#220101) ...*

* * *

## 回答 #39

> 赞同：219
> 
>             
> 
> 时间：2008-10-09T03:05:38.230

我经历了一次睡眠不足的编码运行，开始只写引用搏击俱乐部的评论。

多年后我仍在翻阅代码，发现一条让我发笑的评论。他们中的大多数只是随机的想法。然而，我确实保持我的评论与线条的比例相当不错！

```
// This shouldn't happen. The only way this can happen is if the
// <code>JFileChooser</code> has returned a <code>File</code> that doesn't exist
// on the system. If this happens we can't recover, and there is more than likely
// a rip in the space time continuum that the user is too distracted by to notice
// anything else. 
```

* * *

```
 /**
   * This method leverages collective synergy to drive "outside of the box"
   * thinking and formulate key objectives into a win-win game plan with a
   * quality-driven approach that focuses on empowering key players to drive-up
   * their core competencies and increase expectations with an all-around
   * initiative to drive down the bottom-line. I really wanted to work the word
   * "mandrolic" in there, but that word always makes me want to punch myself in
   * the face.
   */
private void updateFileCountLabel() { 
```

* * *

## 回答 #40

> 赞同：217
> 
>             
> 
> 时间：2008-10-08T20:16:52.237

许多年前（大约 1994 年）我正在为您可能听说过的一家大型跨国软件公司开发 Oracle PRO*C 应用程序。我正在开发的应用程序是一个庞大的 Oracle 应用程序，他们有一个实用程序可以在一夜之间运行整理数据并进行各种聚合计算。每次需要将任何事情作为批处理作业执行时，它都会被塞进这个实用程序中，你可以想象它变成了一个绝对的怪物。值得注意的是，它对如此庞大的程序的评论数量很少。

它确实拥有的少数评论之一仍然是我见过的关于纯 WTF'ness 的最好评论......我试图在一个有数百行长的函数中找到一个错误，并且就在它的中间是**唯一**的函数中的注释：

```
/* I did this the other way */ 
```

直到今天，这仍然是我见过的最好的评论。

* * *

## 回答 #41

> 赞同：216
> 
>             
> 
> 时间：2008-10-08T20:12:26.957

```
/* Please work */ 
```

* * *

## 回答 #42

> 赞同：212
> 
>             
> 
> 时间：2009-03-29T13:45:24.303

```
//Dear future me. Please forgive me. 
//I can't even begin to express how sorry I am. 
```

我今天才发现这个：

```
//private instance variable for storing age
public static int age; 
```

* * *

## 回答 #43

> 赞同：207
> 
>             
> 
> 时间：2008-10-08T20:17:01.567

```
/* You are not meant to understand this */ 
```

* * *

## 回答 #44

> 赞同：192
> 
>             
> 
> 时间：2008-10-08T20:11:04.463

```
//I am not sure why this works but it fixes the problem. 
```

这是在一组代码在技术上确实解决了它本应解决的问题但破坏了其他 3 件事之前......

* * *

## 回答 #45

> 赞同：186
> 
>             
> 
> 时间：2009-04-25T22:08:28.037

```
// no comments for you
// it was hard to write
// so it should be hard to read 
```

* * *

## 回答 #46

> 赞同：178
> 
>             
> 
> 时间：2008-10-09T03:49:51.590

```
/* Halley's comment */ 
```

* * *

## 回答 #47

> 赞同：178
> 
>             
> 
> 时间：2008-12-01T16:53:59.023

```
options.BatchSize = 300; //Madness? THIS IS SPARTA! 
```

* * *

## 回答 #48

> 赞同：172
> 
>             
> 
> 时间：2009-04-20T20:46:03.373

我们的 DBA 在第三方编写的 3000 行存储过程中发现了这一点。

```
/* IF DOLPHINS ARE SO SMART, HOW COME THEY LIVE IN IGLOOS? */ 
```

* * *

## 回答 #49

> 赞同：172
> 
>             
> 
> 时间：2008-10-08T22:40:04.897

```
// I have to find a better job 
```

* * *

## 回答 #50

> 赞同：171
> 
>             
> 
> 时间：2009-01-28T17:54:58.640

关于js代码：

```
// hack for ie browser (assuming that ie is a browser) 
```

* * *

## 回答 #51

> 赞同：155
> 
>             
> 
> 时间：2008-10-11T05:39:51.137

```
/* Emits a 7-Hz tone for 10 seconds.
  True story: 7 Hz is the resonant frequency of a
  chicken's skull cavity. This was determined
  empirically in Australia, where a new factory
  generating 7-Hz tones was located too close to a
  chicken ranch: When the factory started up, all the
  chickens died.
  Your PC may not be able to emit a 7-Hz tone. */

main()
{
    sound(7);
    delay(10000);
    nosound();
} 
```

(the sound function in the Turbo C version 2.0 Reference Guide)

* * *

## 回答 #52

> 赞同：149
> 
>             
> 
> 时间：2009-03-06T13:17:14.643

... 要么死 // 婊子

* * *

## 回答 #53

> 赞同：147
> 
>             
> 
> 时间：2008-10-08T22:27:48.433

[试着在谷歌代码搜索](http://www.google.com/codesearch)中输入你最喜欢的脏话，它会消磨很多沉闷的小时。我最喜欢的一些例子：

```
/* These magic numbers are fucking stupid. */

/* Dear free software world, do you NOW see we are fucking
   things up?! This is insane! */

/* We will NOT put a fucking timestamp in the header here. Every
   time you put it back, I will come in and take it out again. */

# However, this only works if there are MULTIPLE checkboxes!
# The fucking JS DOM *changes* based on one or multiple boxes!?!?!
# Damn damn damn I hate the JavaScript DOM so damn much!!!!!!

/* TODO: this is obviously not right ... this whole fucking module
   sucks anyway */

/* FIXME: please god, when will the hurting stop? Thus function is so
   fucking broken it's not even funny. */ 
```

和我个人的最爱

```
 # code below replaces code above - any problems?
 # yeah, it doesn't fucking work. 
```

* * *

## 回答 #54

> 赞同：146
> 
>             
> 
> 时间：2009-01-10T20:42:31.047

关于链表的初始化：

```
last = first; /* Biblical reference */ 
```

简洁又搞笑。

* * *

## 回答 #55

> 赞同：145
> 
>             
> 
> 时间：2008-12-18T19:47:39.587

有人抱怨说，“最好的”评论提出了最差的评论。恕我直言，它们更有趣，所以“更好”，但这是我读过的最诚实的[评论](http://svn.python.org/view/python/trunk/Objects/dictobject.c?rev=53656&view=markup)：

```
/*
Major subtleties ahead:  Most hash schemes depend on having a "good" hash
function, in the sense of simulating randomness.  Python doesn't:  its most
important hash functions (for strings and ints) are very regular in common
cases:

>>> map(hash, (0, 1, 2, 3))
[0, 1, 2, 3]
>>> map(hash, ("namea", "nameb", "namec", "named"))
[-1658398457, -1658398460, -1658398459, -1658398462]
>>>

This isn't necessarily bad!  To the contrary, in a table of size 2**i, taking
the low-order i bits as the initial table index is extremely fast, and there
are no collisions at all for dicts indexed by a contiguous range of ints.
The same is approximately true when keys are "consecutive" strings.  So this
gives better-than-random behavior in common cases, and that's very desirable.

OTOH, when collisions occur, the tendency to fill contiguous slices of the
hash table makes a good collision resolution strategy crucial.  Taking only
the last i bits of the hash code is also vulnerable:  for example, consider
[i << 16 for i in range(20000)] as a set of keys.  Since ints are their own
hash codes, and this fits in a dict of size 2**15, the last 15 bits of every
hash code are all 0:  they *all* map to the same table index.

But catering to unusual cases should not slow the usual ones, so we just take
the last i bits anyway.  It's up to collision resolution to do the rest.  If
we *usually* find the key we're looking for on the first try (and, it turns
out, we usually do -- the table load factor is kept under 2/3, so the odds
are solidly in our favor), then it makes best sense to keep the initial index
computation dirt cheap.

The first half of collision resolution is to visit table indices via this
recurrence:

    j = ((5*j) + 1) mod 2**i

For any initial j in range(2**i), repeating that 2**i times generates each
int in range(2**i) exactly once (see any text on random-number generation for
proof).  By itself, this doesn't help much:  like linear probing (setting
j += 1, or j -= 1, on each loop trip), it scans the table entries in a fixed
order.  This would be bad, except that's not the only thing we do, and it's
actually *good* in the common cases where hash keys are consecutive.  In an
example that's really too small to make this entirely clear, for a table of
size 2**3 the order of indices is:

    0 -> 1 -> 6 -> 7 -> 4 -> 5 -> 2 -> 3 -> 0 [and here it's repeating]

If two things come in at index 5, the first place we look after is index 2,
not 6, so if another comes in at index 6 the collision at 5 didn't hurt it.
Linear probing is deadly in this case because there the fixed probe order
is the *same* as the order consecutive keys are likely to arrive.  But it's
extremely unlikely hash codes will follow a 5*j+1 recurrence by accident,
and certain that consecutive hash codes do not.

The other half of the strategy is to get the other bits of the hash code
into play.  This is done by initializing a (unsigned) vrbl "perturb" to the
full hash code, and changing the recurrence to:

    j = (5*j) + 1 + perturb;
    perturb >>= PERTURB_SHIFT;
    use j % 2**i as the next table index;

Now the probe sequence depends (eventually) on every bit in the hash code,
and the pseudo-scrambling property of recurring on 5*j+1 is more valuable,
because it quickly magnifies small differences in the bits that didn't affect
the initial index.  Note that because perturb is unsigned, if the recurrence
is executed often enough perturb eventually becomes and remains 0\.  At that
point (very rarely reached) the recurrence is on (just) 5*j+1 again, and
that's certain to find an empty slot eventually (since it generates every int
in range(2**i), and we make sure there's always at least one empty slot).

Selecting a good value for PERTURB_SHIFT is a balancing act.  You want it
small so that the high bits of the hash code continue to affect the probe
sequence across iterations; but you want it large so that in really bad cases
the high-order hash bits have an effect on early iterations.  5 was "the
best" in minimizing total collisions across experiments Tim Peters ran (on
both normal and pathological cases), but 4 and 6 weren't significantly worse.

Historical:  Reimer Behrends contributed the idea of using a polynomial-based
approach, using repeated multiplication by x in GF(2**n) where an irreducible
polynomial for each table size was chosen such that x was a primitive root.
Christian Tismer later extended that to use division by x instead, as an
efficient way to get the high bits of the hash code into play.  This scheme
also gave excellent collision statistics, but was more expensive:  two
if-tests were required inside the loop; computing "the next" index took about
the same number of operations but without as much potential parallelism
(e.g., computing 5*j can go on at the same time as computing 1+perturb in the
above, and then shifting perturb can be done while the table index is being
masked); and the dictobject struct required a member to hold the table's
polynomial.  In Tim's experiments the current scheme ran faster, produced
equally good collision statistics, needed less code & used less memory.

Theoretical Python 2.5 headache:  hash codes are only C "long", but
sizeof(Py_ssize_t) > sizeof(long) may be possible.  In that case, and if a
dict is genuinely huge, then only the slots directly reachable via indexing
by a C long can be the first slot in a probe sequence.  The probe sequence
will still eventually reach every slot in the table, but the collision rate
on initial probes may be much higher than this scheme was designed for.
Getting a hash code as fat as Py_ssize_t is the only real cure.  But in
practice, this probably won't make a lick of difference for many years (at
which point everyone will have terabytes of RAM on 64-bit boxes).
*/ 
```

* * *

## 回答 #56

> 赞同：128
> 
>             
> 
> 时间：2008-12-05T19:46:07.410

```
int MyFunction()
{
    // There once was a man named Dave
    int Result = 0;

    // Whose code just wouldn't behave
    MyObject *Ptr = new MyObject();

    // He left to go to a meetin'
    Result = Ptr->DoSomething();

    // And left his memory a leakin'
    return Result;
} 
```

C++ 注释

* * *

## 回答 #57

> 赞同：128
> 
>             
> 
> 时间：2008-10-10T04:39:27.900

```
if(m_measures =/*=*/ --index)
{
    .... 
```

* * *

## 回答 #58

> 赞同：126
> 
>             
> 
> 时间：2009-04-09T21:52:53.557

```
/*
This isn't the right way to deal with this, but today is my last day, Ron
just spilled coffee on my desk, and I'm hungry, so this will have to do...
*/

return 12; // 12 is my lucky number 
```

* * *

## 回答 #59

> 赞同：117
> 
>             
> 
> 时间：2008-10-12T07:30:02.600

```
 mov si, pCard      ; captain? 
```

* * *

## 回答 #60

> 赞同：109
> 
>             
> 
> 时间：2008-10-10T00:45:16.097

```
// I know the line below is wrong, but it came that way from our IP vendor, and 
// the driver won't work if you "fix" it. I've had to revert this change 4 times
// now. Leave it alone, or I will hunt you down and hurt you
if (r = 0) {
    /* bunch of code here */
}
else
{
   /* even more code here */
} 
```

* * *

## 回答 #61

> 赞同：108
> 
>             
> 
> 时间：2009-04-19T20:19:58.407

从 2004 年的 Windows 泄漏，

```
__inline BOOL
SearchOneDirectory(
                  IN  LPSTR Directory,
                  IN  LPSTR FileToFind,
                  IN  LPSTR SourceFullName,
                  IN  LPSTR SourceFilePart,
                  OUT PBOOL FoundInTree
                  )
{
    //
    // This was way too slow. Just say we didn't find the file.
    //
    *FoundInTree = FALSE;
    return(TRUE);
} 
```

* * *

## 回答 #62

> 赞同：107
> 
>             
> 
> 时间：2009-04-20T14:03:20.907

```
// this comment included for the benefit of anyone grepping for swearwords: shit. 
```

* * *

## 回答 #63

> 赞同：105
> 
>             
> 
> 时间：2009-03-12T13:43:36.197

```
} catch (PartInitException pie) {
    // Mmm... pie 
```

* * *

## 回答 #64

> 赞同：105
> 
>             
> 
> 时间：2008-12-30T13:08:53.327

我在某人的代码上看到了这条评论：

```
// This comment is self explanatory. 
```

我猜他的意思是说“变量”，但这个错误引起了一个有趣的评论......想想这里的循环逻辑，以及编写它的徒劳。

* * *

## 回答 #65

> 赞同：104
> 
>             
> 
> 时间：2009-03-05T18:35:34.120

```
try {

}
catch (SQLException ex) {
    // Basically, without saying too much, you're screwed. Royally and totally.
}
catch(Exception ex)
{
    //If you thought you were screwed before, boy have I news for you!!!
} 
```

* * *

## 回答 #66

> 赞同：104
> 
>             
> 
> 时间：2008-12-19T17:22:45.647

不是评论，而是 goto 标签

```
ICantBelieveImUsingAGoto: 
```

* * *

## 回答 #67

> 赞同：103
> 
>             
> 
> 时间：2009-03-05T18:31:26.813

```
class Act //That's me!!!
{

} 
```

* * *

## 回答 #68

> 赞同：102
> 
>             
> 
> 时间：2008-10-08T20:13:32.930

在必须声明的局部变量旁边，以便将常量传递给库函数：

```
// This only exists because Scott doesn't know how to use const correctly 
```

* * *

## 回答 #69

> 赞同：102
> 
>             
> 
> 时间：2008-10-09T14:40:48.360

```
virgin = 0;     /* you're not a virgin anymore, sweety */ 
```

* * *

## 回答 #70

> 赞同：100
> 
>             
> 
> 时间：2009-04-28T05:58:26.750

```
public boolean isDirty() {
    //Why do you always go out and
    return dirty;
} 
```

* * *

## 回答 #71

> 赞同：97
> 
>             
> 
> 时间：2008-10-09T22:51:36.310

```
 * ...and don't just declare it volatile and think you've solved
 * the problem. You young punks think you know what volatile
 * means... why in my day we had to cast it volatile uphill
 * both ways, and the code still didn't work! Whippersnappers... 
```

* * *

## 回答 #72

> 赞同：94
> 
>             
> 
> 时间：2008-10-08T21:47:45.627

最初的《毁灭战士》有一个带有无法移动的静态墙的引擎。结果是所有门都垂直打开；没有东西可以水平移动。当源代码发布后，我正在查看代码并在用于处理门的源文件中看到这一点时，我大笑起来，在一大块注释掉的代码的开头：

```
// UNUSED
// Separate into p_slidoor.c?

#if 0           // ABANDONED TO THE MISTS OF TIME!!!
//
// EV_SlidingDoor : slide a door horizontally
// (animate midtexture, then set noblocking line)
// 
```

* * *

## 回答 #73

> 赞同：94
> 
>             
> 
> 时间：2008-11-25T01:39:13.817

取自 Quake III 源，我在一些随机的斜线点发布中偶然发现了这一点。该文件的完整来源可以在[这里](http://www.google.com/codesearch?hl=en&q=quake+3+%22what+the+fuck%22+show:1s7s4Tr0knk:uJtln_6bKE0:1s7s4Tr0knk&sa=N&cd=2&ct=rc&cs_p=git://github.com/TTimo/iourt.git&cs_f=code/qcommon/q_math.c)找到。这是一种计算平方根倒数的特别快速的方法。至于最好的评论？可以肯定的是，这是一个常见的问题，但鉴于它与具有魔力的生产线相连，这就是它的伟大之处。

```
float Q_rsqrt( float number )
{
  long i;
  float x2, y;
  const float threehalfs = 1.5F;

  x2 = number * 0.5F;
  y  = number;
  i  = * ( long * ) &y;  // evil floating point bit level hacking
  i  = 0x5f3759df - ( i >> 1 ); // what the fuck?
  y  = * ( float * ) &i;
  y  = y * ( threehalfs - ( x2 * y * y ) ); // 1st iteration
  // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed

  #ifndef Q3_VM
  #ifdef __linux__
    assert( !isnan(y) ); // bk010122 - FPE?
  #endif
  #endif
  return y;
} 
```

* * *

## 回答 #74

> 赞同：92
> 
>             
> 
> 时间：2009-04-19T23:04:34.407

```
def format_ticket_content(text, recursive = true)
  if text.is_a?(TicketNote)
    note = text
    text = note.content
  else
    note = nil
  end

  ## Safety pig has arrived!
  text = h(text)
  ##                               _
  ##  _._ _..._ .-',     _.._(`))
  ## '-. `     '  /-._.-'    ',/
  ##    )         \            '.
  ##   / _    _    |             \
  ##  |  a    a    /              |
  ##  \   .-.                     ;  
  ##   '-('' ).-'       ,'       ;
  ##      '-;           |      .'
  ##         \           \    /
  ##         | 7  .__  _.-\   \
  ##         | |  |  ``/  /`  /
  ##        /,_|  |   /,_/   /
  ##           /,_/      '`-'
  ## 
```

* * *

## 回答 #75

> 赞同：91
> 
>             
> 
> 时间：2009-03-06T14:10:18.900

```
// John! If you'll svn remove this once more,
// I'll shut you, for God's sake!
// That piece of code is not “something strange”!
// That is THE AUTH VALIDATION. 
```

你觉得怎么样？下面的代码被安全地“删除了”。

* * *

## 回答 #76

> 赞同：78
> 
>             
> 
> 时间：2009-03-16T00:24:46.940

这在我自己的代码中出现了几次。显然我不止一次碰过它：

```
// TODO: Fix this.  Fix what? 
```

* * *

## 回答 #77

> 赞同：76
> 
>             
> 
> 时间：2009-02-03T20:36:33.297

```
//MailBody builders for two outgoing messages
StringBuilder hanz = new StringBuilder();
StringBuilder franz = new StringBuilder(); 
```

当我读到那个时，我仍然轻笑...

* * *

## 回答 #78

> 赞同：74
> 
>             
> 
> 时间：2008-10-09T13:19:37.570

```
Repeat
    ...
Until (JesusChristsReturn) ' Not sure 
```

* * *

## 回答 #79

> 赞同：74
> 
>             
> 
> 时间：2008-10-13T07:29:33.363

在离开我的上一份工作时，我在源代码中嵌入了一些 ascii 艺术......

```
                                      ,_-=(!7(7/zs_.             
                                   .=' ' .`/,/!(=)Zm。           
                     .._,,._... ,-`- `,\ ` -` -`\\7//WW。         
                ,v=~/.-,-\- -!|Vs.)iT-|s|\-.' `///mK%。        
              v!`i!-.e]-g`bT/i(/[=.Z/m)K(YNYi.. /-]i44M.       
            v`/,`|v]-DvLcfZ/eV/iDLN\D/ZK@%8W[Z..`/d!Z8m       
           //,c\(2(X/NYNY8]ZZ/bZd\()/\7WY%WKKW) -'|(][%4\.      
         ,\\i\c(e)WX@WKKZKDKWMZ8(b5/ZK8]Z7%ffVM, -.Y!bNMi      
         /-iit5N)KWG%%8%%%%W8%ZWM(8YZvD)XN(@.[\]!/GXW[      
        / ))G8\NMN%W%%%%%%%%%%8KK@WZKYK*ZG5KMi,- vi[NZGM[      
       i\!(44Y8K%8%%%**~YZYZ@%%%%%4KWZ/PKN)ZDZ7 c=//WZK%!      
      ,\v\YtMZW8W%%f`,`.t/bNZZK%%W%%ZXb*K(K5DZ -c\\/KM48       
      -|c5PbM4DDW%f v./c\[tMY8W%PMW%D@KW)Gbf -/(=ZZKM8[       
      2(N8YXWK85@K -'c|K4/KKK%@ V%@@WD8e~ .//ct)8ZK%8`       
      =)b%]Nd)@KM[ !'\cG!iWYK%%| !M@KZf -c\))ZDKW%`        
      YYKWZGNM4/Pb '-VscP4]b@W% 'Mf` -L\///KM(%W!         
      !KKW4ZK/W7)Z。'/cttbY)DKW% -` .',\v)K(5KW%%f          
      'W)KWKZZg)Z2/,!/L(-DYYb54% ,,`, -\-/v(((KK5WW%f           
       \M4NDDKZZ(e!/\7vNTtZd)8\Mi!\-,-/iv((tKNGN%W%%            
       'M8M88(Zd))///((|D\tDY\\KK-`/-i(=)KtNNN@W%%%@%[           
        !8%@KW5KKN4///s(\Pd!ROBY8/=2(/4ZdzKD%K%%%M8@%%           
         '%%%W%dGNtPK(c\/2\[Z(ttNYZ2NZW8W8K%%%%YKM%M%%.          
           *%%W%GW5@/%!e]_tZdY()v)ZXMZW%W%%%*5Y]K%ZK%8[          
            '*%%%%8%8WK\)[/ZmZ/Zi]!/M%%%%@f\\Y/NNMK%%!          
              'VM%%%%W%WN5Z/Gt5/b)((cV@f` - |cZbMKW%%|          
                 'V*M%%%WZ/ZG\t5((+)L\'-,,/-)X(NWW%%           
                      `~`MZ/DZGNZG5(((\, ,t\\Z)KW%@           
                         'M8K%8GN8\5(5///]i!v\K)85W%%f           
                           YWWKKKKWZ8G54X/GGMeK@WM8%@            
                            !M8%8%48WG@KWYbW%WWW%%%@             
                              VM%WKWK%8K%%8WWWW%%%@`             
                                ~*%%%%%%W%%%%%%%@~               
                                   ~*MM%%%%%%@f`                 
                                       '''''                     

```

* * *

## 回答 #80

> 赞同：72
> 
>             
> 
> 时间：2009-04-22T19:12:59.913

```
/*
after hours of consulting the tome of google
i have discovered that by the will of unknown forces
without the below line, IE7 believes that 6px = 12px
*/
font-size: 0px; 
```

* * *

## 回答 #81

> 赞同：71
> 
>             
> 
> 时间：2009-04-20T02:33:49.193

不记得我在哪里见过这些：

```
long time; /* know C */ 
```

和（在创建某种 UNIX 守护进程的代码中）：

```
/* Be a real daemon: fork myself and kill my parent */ 
```

* * *

## 回答 #82

> 赞同：70
> 
>             
> 
> 时间：2008-10-08T20:24:09.523

在头文件的顶部：

```
/* Project : XYZ (Please somebody shoot me!)
 *
 * File : $Id: defs.h,v 1.1 $
 *
 * Purpose : Create havoc rather than peace among many nations
 *
 * History : Back-ported changes that were not in CVS.  Please somebody,
 *  shoot us and put us all out of our misery.
 */ 
```

“XYZ 项目”（名称已更改）历时七年。最后一条评论是由一个从头到尾都参与其中的坚定灵魂撰写的。

* * *

## 回答 #83

> 赞同：67
> 
>             
> 
> 时间：2009-03-29T13:53:24.347

在驱动程序/net/sunhme.c（Linux 内核）中：

```
/* Welcome to Sun Microsystems, can I take your order please? */
if(!hp->happy_flags & HFLAG_FENABLE)
        return happy_meal_bb_write(hp, tregs, reg, value);

/* Would you like fries with that? */
hme_write32(hp, &tregs->frame,
            (FRAME_WRITE | (hp->paddr << 23) |
             ((reg & 0xff) << 18) | (value & 0xffff)));
while(!(hme_read32(hp, &tregs->frame) & 0x10000) && --tries)
        udelay(20);

/* Anything else? */
if(!tries)
        printk(KERN_ERR "happy meal: Aieee, transceiver MIF write bolixed\n");

/* Fifty-two cents is your change, have a nice day. */ 
```

* * *

## 回答 #84

> 赞同：67
> 
>             
> 
> 时间：2008-10-09T17:57:02.380

```
// Catching exceptions is for communists 
```

来自[Mike Duncan 的 SQLite 页面](http://www.mikeduncan.com/sqlite-on-dotnet-in-3-mins)。

* * *

## 回答 #85

> 赞同：66
> 
>             
> 
> 时间：2009-04-24T19:29:49.080

```
//
//3.4  JeK  My manager promised me a lap dance if I can fix this release
//3.5  JeK  Still waiting for that dance from my manager
//3.6  JeK  My manager got changed, the new manager is hairy, dont want the dance anymore
//3.7  Jek  Got that dance, yuck!
// 
```

* * *

## 回答 #86

> 赞同：63
> 
>             
> 
> 时间：2008-10-18T15:28:31.723

```
 /* Mark: If there's one thing you learn from this code, it is this...
   Never, ever fly Air France.  Their customer service is absolutely
   the worst.  I've never heard the words "That's not my problem" as 
   many times as I have from their staff -- It should, without doubt
   be their corporate motto if it isn't already.  Don't bother giving 
   them business because you're just a pain in their side and they
   will be sure to let you know the first time you speak to them.

   If you ever want to make me happy just tell me that you, too, will
   never fly Air France again either (in spite of their excellent
   cuisine). 

   Update by oej: The merger with KLM has transferred this
   behaviour to KLM as well. 
   Don't bother giving them business either...

   Only if you want to travel randomly without luggage, you
   might pick either of them.
   */ 
```

* * *

## 回答 #87

> 赞同：58
> 
>             
> 
> 时间：2008-10-16T21:45:36.287

我在不久前正在研究的 PHP CMS 中添加的评论。

```
if (/*you*/ $_GET['action']) { //celebrate 
```

* * *

## 回答 #88

> 赞同：58
> 
>             
> 
> 时间：2009-03-26T22:32:24.030

一旦我在另一个讨论中看到这样的事情：

```
// I can't divide with zero, so I have to divide with something very similar
result = number / 0.00000000000001; 
```

聪明的解决方案，不是吗:)？（如果有人不确定，这是一个笑话）

* * *

## 回答 #89

> 赞同：56
> 
>             
> 
> 时间：2008-10-09T13:10:23.160

为什么你不应该离开你的软件开发的一个经典案例：

```
public class Contact
{
    //...    

    /// <summary>
    /// Gets or sets the name of the first.
    /// </summary>
    /// <value>The name of the first.</value>
    public string FirstName
    {
        get { return _firstName; }
        set { _firstName = value; }
    }
} 
```

* * *

## 回答 #90

> 赞同：56
> 
>             
> 
> 时间：2009-03-05T18:13:38.417

在大学的家庭作业中，一位老师特别坚持我们评论我们的代码：

```
//I wonder if she actually reads these. 
```

当作业被退回时，用红笔在评论“是的，我愿意”旁边

* * *

## 回答 #91

> 赞同：55
> 
>             
> 
> 时间：2009-01-10T20:46:40.103

```
// If you're reading this, that means you have been put in charge of my previous project.
// I am so, so sorry for you. God speed. 
```

* * *

## 回答 #92

> 赞同：55
> 
>             
> 
> 时间：2008-12-01T17:18:37.680

来自泄露的 Windows 2000 源代码的伟大作品：

> !!!!!!!!!如果你将标签更改为空格，你将被杀死!!!!!!! * 
> 
>   !!!!!!!!!!!!!!!这样做会破坏构建过程！！！！！！！！！！！！！！！！！！* 
> 
>   ！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！ ！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！ ！！！！！！！！！！！！

[http://www.kuro5hin.org/story/2004/2/15/71552/7795](http://www.kuro5hin.org/story/2004/2/15/71552/7795)

* * *

## 回答 #93

> 赞同：54
> 
>             
> 
> 时间：2008-12-19T16:56:25.183

```
// The ratio of a circle's circumference to its diameter.  Remember to change
// this to 3.0 if you move to a site in Indiana.

#define Pi                                      3.1415927 
```

* * *

## 回答 #94

> 赞同：53
> 
>             
> 
> 时间：2009-04-19T20:31:32.137

我一直很喜欢 Paul DiLascia 在他的文件头中写的：

```
// If this code works, it was written by Paul DiLascia. If not, I don't know
// who wrote it 
```

* * *

## 回答 #95

> 赞同：53
> 
>             
> 
> 时间：2008-10-10T00:43:23.993

```
// human madable inconvenient. Way too sucks. 
```

我仍然不完全理解它的含义，但我发现很多代码都是如此。

* * *

## 回答 #96

> 赞同：53
> 
>             
> 
> 时间：2009-04-24T19:47:04.593

从嵌入式系统中的电池监控模块：

```
// batmon.c drives the rastamobile 
```

* * *

## 回答 #97

> 赞同：53
> 
>             
> 
> 时间：2009-04-15T20:45:09.957

```
// error codes
#define ERROR_SUCESS 0
#define ERROR_SUCCESS_IS_MISSPELLED 1 
```

未定义其他错误代码。

* * *

## 回答 #98

> 赞同：52
> 
>             
> 
> 时间：2009-04-20T17:25:37.350

从泄露的 Win2K 源代码中：

 `// The magnitude of this hack compares favorably with that of the national debt.` 

* * *

## 回答 #99

> 赞同：51
> 
>             
> 
> 时间：2008-10-10T01:52:54.180

Donald Knuth 的另一个经典之作：

注意上述代码中的错误；我只是证明它是正确的，没有尝试过。

* * *

## 回答 #100

> 赞同：49
> 
>             
> 
> 时间：2009-04-20T20:03:28.687

`// I put on my robe and wizard hat...`

* * *

## 回答 #101

> 赞同：49
> 
>             
> 
> 时间：2009-04-20T08:10:35.793

```
// if i ever see this again i'm going to start bringing guns to work 
```

* * *

## 回答 #102

> 赞同：49
> 
>             
> 
> 时间：2008-10-11T18:12:43.177

```
// Any maintenance developer who can't quote entire Monty Python
// movies from memory has no business being a developer. 
const string LancelotsFavoriteColor = "$0204FB"
```

* * *

## 回答 #103

> 赞同：49
> 
>             
> 
> 时间：2008-10-09T14:35:27.513

```
//There can Only Be one HIGHLAN....err..Singleton
public class SomeSingleton
{
...
} 
```

* * *

## 回答 #104

> 赞同：48
> 
>             
> 
> 时间：2008-10-09T23:12:13.897

```
// 下面的字符串很有趣。不要编辑这些字符串
// 除非你也很有趣。如果你不知道自己是否有趣，那你就是
// 不好笑。如果与您无关的人少于 2 人告诉您
// 你很有趣，你并不有趣。

```

* * *

## 回答 #105

> 赞同：47
> 
>             
> 
> 时间：2008-10-14T02:18:23.757

在 linux 1.0 内核调度程序 (sched.c) 上：

> Dijkstra 可能讨厌我。

```
/*
 *  'schedule()' is the scheduler function. It's a very simple and nice
 * scheduler: it's not perfect, but certainly works for most things.
 * The one thing you might take a look at is the signal-handler code here.
 *
 *   NOTE!!  Task 0 is the 'idle' task, which gets called when no other
 * tasks can run. It can not be killed, and it cannot sleep. The 'state'
 * information in task[0] is never used.
 *
 * The "confuse_gcc" goto is used only to get better assembly code..
 * Dijkstra probably hates me.
 */
asmlinkage void schedule(void) 
```

(...)

* * *

## 回答 #106

> 赞同：46
> 
>             
> 
> 时间：2009-04-23T16:30:26.227

```
//uncomment the following line if the program manager changes her mind again this week 
```

* * *

## 回答 #107

> 赞同：46
> 
>             
> 
> 时间：2008-10-08T21:40:13.053

```
using namespace std;            // So sue me 
```

* * *

## 回答 #108

> 赞同：46
> 
>             
> 
> 时间：2009-04-24T15:09:05.667

```
//I'm sorry, but our princess is in another castle. 
```

* * *

## 回答 #109

> 赞同：46
> 
>             
> 
> 时间：2008-10-09T12:12:23.650

```
//Abandon all hope ye who enter beyond this point 
```

* * *

## 回答 #110

> 赞同：46
> 
>             
> 
> 时间：2008-10-11T17:51:21.940

```
// This procedure is **really** good for your dorsolateral prefrontal cortex.
```

对于那些出于某种特殊原因不了解 DPC 的人来说，当你深入学习新事物时，它是你大脑中亮起的部分。

* * *

## 回答 #111

> 赞同：44
> 
>             
> 
> 时间：2008-10-08T20:09:45.730

```
//ALL YOUR BASE ARE BELONG TO US 
```

...这让我的老板认为有人入侵了。他不知道这个笑话。

* * *

## 回答 #112

> 赞同：44
> 
>             
> 
> 时间：2008-10-15T10:13:13.500

sqlite 源文件的顶部：

```
/*

** The author disclaims copyright to this source code.  In place of             
** a legal notice, here is a blessing:                                          
**                                                                              
**    May you do good and not evil.                                             
**    May you find forgiveness for yourself and forgive others.                 
**    May you share freely, never taking more than you give.

*/ 
```

* * *

## 回答 #113

> 赞同：44
> 
>             
> 
> 时间：2009-04-15T05:49:56.300

```
/**
 * If you don't understand this code, you should be flipping burgers instead.
 */ 
```

* * *

## 回答 #114

> 赞同：42
> 
>             
> 
> 时间：2009-04-20T16:37:09.010

我在我发布的 WordPress 模板中发布了这个“许可声明”。反正我觉得很好笑。

```
/* The License:
You (from this point on referred to as The You) are hereby 
granted by me (from this point on referred to as The Me) 
license to knock yourself silly with this template. 
By using this template The You implicitly accepts this 
license and pledges solemnly to never claim creative 
ownership of any graphics, code, concepts, eggs, bacon, ideas, 
colors, shapes, hypertext-transfer protocols or other conduits 
of the visual splendor thatis this template. 

The Me, in turn, pledges equally solemnly to be far too 
lazy to ever check up on you, so if you do manage to pull 
some chicks The Me won't have a cow. 
However The Me would be sorely disappointed if The You 
were to try and sell or distribute this work without 
acknowledging The Me. Seriously. The Me will come down on 
The You like a large quantitiy of hard and heavy objects 
that in large quantities may be harmful and possibly even 
lethal to The You; So don't even think about it, The Buster.
*/ 
```

* * *

## 回答 #115

> 赞同：41
> 
>             
> 
> 时间：2009-04-06T10:31:33.980

大约 10 年前，我从事图像处理工作，扫描显微镜视频帧以检测细胞运动。我在一个特别复杂的功能上工作，并决定出去和朋友一起喝一杯。当我回到家时，我工作了一点，但没有太多，因为我喝醉了。在我发现一个 10 行完全混乱的函数并带有以下评论（显然是我的另一个自己写的）的第二天早上：

```
/* Ah ah ah! You'll never understand why this one works. */ 
```

最奇怪的部分是它甚至可以*工作*。

* * *

## 回答 #116

> 赞同：41
> 
>             
> 
> 时间：2008-10-08T20:59:20.873

简单但有效的注释，在一些 C++ 代码中的安全破解之前

```
// yikes 
```

* * *

## 回答 #117

> 赞同：40
> 
>             
> 
> 时间：2008-11-05T14:38:59.747

来自我们的一个项目。

在一个源文件的末尾某处。

```
/*@ /\ /\
 * @ / \/ \ ----- | | ---- |---\ | | /--\ --- | | ---- /--\ /--\
 * @ / -- | | | | | / | | | | |\ | | | |
 * \---\ / \ | |---| ---- |--/ | | \ | | \ | ---- \ \
 * | \------------------------------------/ /-\ \ | | | | | \ | | -\ | | \| | -\ -\
 * | \-/ \ | | | ---- |---/ \--/ \--/ --- | \ ---- \--/ \--/
 * \ ------O
 * \ / --- | | ---- /--\ |--\ /--\ /--\
 * | | | | / | |\ | | | | | | | | |
 * | | | |----- -------- | | \ | ---- | | | | | | | /-\
 * | |\ /| | \ 万维网/ | | \| | | | | | | | | |
 * | | \ / | | \------- --- | \ | \--/ |--/ \--/ \--/
 * | | \--------------/ | |
 * / | / |
 * \ \ \ \
 * \-----/ \-----/
 */

```

* * *

## 回答 #118

> 赞同：40
> 
>             
> 
> 时间：2008-10-08T20:49:57.147

[`//You are not expected to understand this`](http://cm.bell-labs.com/who/dmr/odd.html)

经典的。

* * *

## 回答 #119

> 赞同：40
> 
>             
> 
> 时间：2008-10-08T20:21:00.247

当我对一个我不想记录的数学公式进行某种非显而易见的简化时，我不止一次使用过这个：

```
//this formula is right, work out the math yourself if you don't believe me 
```

* * *

## 回答 #120

> 赞同：39
> 
>             
> 
> 时间：2009-02-02T22:58:45.430

`.class {border:1px solid gold;} /* I pitty the fool */`

* * *

## 回答 #121

> 赞同：39
> 
>             
> 
> 时间：2009-04-23T11:43:30.110

在 GIGANTIC 800 line 'switch' 语句的中间某处：

```
// Joe is sorry 
```

几百行之后...

```
// Harry is sorry too 
```

* * *

## 回答 #122

> 赞同：38
> 
>             
> 
> 时间：2009-02-02T12:15:57.007

```
// Caveat implementor 
```

* * *

## 回答 #123

> 赞同：37
> 
>             
> 
> 时间：2008-12-02T16:23:42.500

```
//Mr. Compiler, please do not read this. 
```

* * *

## 回答 #124

> 赞同：37
> 
>             
> 
> 时间：2008-10-12T07:18:34.463

这是我曾经不得不支持的实际代码。在努力理解 AstaSaysGooGoo 和 AstaSaysGaaGaa（其中声明和使用了更多 astaTempVars ）中的逻辑之后，我准备放弃。我终于抬头看到了“@author”评论，整个事情开始变得有意义。

```
/*

* @author Andrew Asta
*/
public class AstaClass{

    private String astaVar1;    
    private String astaVar2;    
    private String astaVar3;    
    private String astaVar4;    
    private String astaVar5;    
    private String astaVar6;    
    private String astaVar7;    
    private String astaVar8;    
    private String astaVar9;    
    private String astaVar10;   

    public void AstaSaysGetData(){
        //JDBC statement to populate astavars 1 through 10
        //...
        String astaSqlStatment = "Select astaCol1, astaCol2, astaCol3... From AstaTable Where...";
        //..
        //...
    }

    //Perform data manipulation on astavars...
    public void AstaSaysGaaGaa(){
          [removed for sake of brevity]
    }

    //Perform more data manipulation on astavars...
    public void AstaSaysGooGoO(){
        [removed for sake of brevity]
    }

    public void AstaSaysPersist(){      
        //JDBC statement to save astavars to DB 
        String astaSqlStatment = "Update AstaTable set astaCol1 = @astaVar1
                                                  , set astaCol2 = @astaVar2
                                                  , set astaCol3 = astaCol3... 
                                                  Where...";
    }
} 
```

PS我更改了实际作者的真实姓名以避免我陷入任何争议等......

* * *

## 回答 #125

> 赞同：37
> 
>             
> 
> 时间：2008-10-13T14:58:34.410

来自 Netscape 网络浏览器的 UNIX 风格的源代码，大约在 1997 年：

```
/* HP-UX sucks wet farts from dead pigeons' asses */ 
```

不幸的是，在 Moz 开源之前，这些珍珠就被移除了……

* * *

## 回答 #126

> 赞同：36
> 
>             
> 
> 时间：2008-10-09T05:19:18.553

```
'NO COMMENT 
```

* * *

## 回答 #127

> 赞同：36
> 
>             
> 
> 时间：2009-04-23T01:39:11.013

```
long time; /* just seems that way */ 
```

* * *

## 回答 #128

> 赞同：35
> 
>             
> 
> 时间：2009-04-23T16:24:47.083

此注释位于包含接口的单元中，这些接口用于绑定主应用程序和各种第 3 方驱动程序之间的通信。

```
//**************************************
// Dear code maintainer:
//
// This source contains COM interfaces, not to be confused with interfaces 
// of any other sort, please do not just willy-nilly add additional methods 
// to these interfaces as they are truely immutable, unlike the interfaces 
// that other software vendors like Microsoft maintain.  IF you need to add 
// new functionality, then go thru the trouble of creating a NEW interface 
// and implement this functionality on only the objects you need.  
//
// While the money is good for fixing all of the problems caused by not 
// following the rules, I would rather work on things which actually have
// an impact on the future of the product rather than curse and yell 
// obsenities at the screen because someone didn't bother to understand the
// true meaning of IMMUTABLE.  
//************************************** 
```

* * *

## 回答 #129

> 赞同：35
> 
>             
> 
> 时间：2008-10-25T13:45:21.830

```
aComment = 'this is not aComment' # this is aComment
class T(object):
    def f(this):
        this is not aComment 
```

* * *

## 回答 #130

> 赞同：34
> 
>             
> 
> 时间：2008-10-12T07:30:35.080

There was some old javascript code, quite well written tho. Then was a comment line 

```
// and there is where the dragon lives 
```

followed by a function 4 people spent a day to understand what it's doing. Finally we realised it's not even used and does nothing.

* * *

## 回答 #131

> 赞同：34
> 
>             
> 
> 时间：2008-10-08T20:42:02.263

```
-- Comment this later 
```

那是 4000 多行 PL/SQL 过程的第 2 行。和唯一的评论。那个程序开发4年后，后来还没有来……

* * *

## 回答 #132

> 赞同：34
> 
>             
> 
> 时间：2009-04-09T22:19:39.077

我曾经想出一个我认为是解决一个特别棘手的问题的优雅解决方案，回想起来这有点让人费解，并且大量使用了宏编程。多年后，我从一位维护程序员那里找到了这条评论

```
/*
    描述：Total Perspective Vortex 导出了它的图片
                 外推物质原理的整个宇宙
                 分析。

                 解释一下——因为宇宙中的每一块物质
                 在某种程度上受到其他所有物质的影响
                 宇宙，理论上可以推断
                 整个造物——每一个太阳，每一个星球，他们的
                 轨道，它们的组成以及它们的经济和社会
                 比如说，一个小宏的历史。

                 发明全透视涡旋的人就是这样做的
                 基本上是为了惹恼IT部门。

                 Steve Weet——因为那是他的名字——是一个梦想家，一个
                 思想家，投机哲学家，或者像某些人所说的那样
                 它，一个懒鬼。

                 他们会不停地唠叨他完全
                 他花费过多的时间凝视着太空，
                 或者考虑切尔西足球俱乐部的机制，或者做
                 宏的光谱分析。

                 “有点分寸！” 他们会说，
                 有时一天之内多达三十八次。

                 所以他建造了总透视涡旋——只是为了展示
                 他们。

                 他把整个现实塞进了一端
                 从一个宏外推到另一个
                 最后他插上 IT 部门：这样当他打开它时
                 他们在一瞬间看到了整个无限的创造
                 和他们自己与它有关。

                 令史蒂夫威特感到恐惧的是，震惊完全消失了'
                 他们的大脑；但令他满意的是，他意识到他
                 已经确凿地证明，如果生命将存在于
                 这么大的宇宙，那是它买不起的一件事
                 拥有是一种分寸感。

*/

```

* * *

## 回答 #133

> 赞同：33
> 
>             
> 
> 时间：2008-10-10T16:02:04.890

```
catch (Ex as Exception)
{
     // oh crap, we should do something.
} 
```

没有什么比空的 catch 块更能让人觉得代码是健壮的了......

* * *

## 回答 #134

> 赞同：33
> 
>             
> 
> 时间：2009-04-22T23:33:38.523

*为了保护有罪的人，价值观已经改变*

这个是由一个承包商留下的，他一直在编写负责测试电子邮件登录的代码块。我们不敢相信，所以我们试了一下，这是对他个人帐户的有效登录；我们仔细检查了修订历史，他有两次签入编辑它：一次添加代码，第二次将其注释掉。

我们添加了艺术品，剩下的就不用管了；另一位开发人员认为从他未来的自己（ala The Office）向他发送电子邮件会很有趣，并表示在登录停止工作之前需要将近两周的每日电子邮件。

```
'    ROFL:ROFL:LOL:ROFL:ROFL
'        ______/|\____
'  L    /          [] \
' LOL===_      ROFL    \_
'  L     \_______________]
'            I      I
'        /---------------/

'TODO: REMOVE MY INFO AND REPLACE WITH USER CREDENTIALS
'Private TEST_LoginName As String = "DurgshA@Exmaple.org"
'Private TEST_Password As String = "Humsal892"
'Private TEST_Server As String = "imap.secureserver.net" 
```

我最喜欢的部分不是他做的，或者他不小心把它留在原处进行签到——而是当他回来看到它时，他只是评论了它而不是删除它。如果我们不知道它的存在，我们永远不会查看原始修订版：-D

* * *

## 回答 #135

> 赞同：32
> 
>             
> 
> 时间：2008-10-15T06:54:24.680

*我经常*看到这个：

```
// TODO make this work 
```

* * *

## 回答 #136

> 赞同：31
> 
>             
> 
> 时间：2009-04-23T08:35:11.217

显而易见？

```
/** Logger */
private Logger logger = Logger.getLogger(); 
```

* * *

## 回答 #137

> 赞同：31
> 
>             
> 
> 时间：2009-04-27T10:23:56.060

```
 $you = live("free") or die("hard"); 

```

* * *

## 回答 #138

> 赞同：30
> 
>             
> 
> 时间：2008-10-09T16:36:22.197

几年前写一些 Perl 时，我在顶部和底部添加了这些注释：

```
# <magic type="voodoo">

...

# </magic> 
```

下一个看它的人对 Perl 并没有那么热，他花了一段时间搜索文档以了解 'magic' 和 'voodoo' 做了什么。从那时起，我试图添加更多有用的评论......

* * *

## 回答 #139

> 赞同：30
> 
>             
> 
> 时间：2009-02-05T11:56:29.647

来自谷歌代码项目：

```
# This job would be great if it wasn't for the fucking customers. 
```

* * *

## 回答 #140

> 赞同：29
> 
>             
> 
> 时间：2009-04-19T23:08:11.403

```
when :orientation
## Avoid matching gay people with straight people - they hate it, they do, they really do.
query_parameter = "(users.orientation = 'Bi' OR (users.orientation = 'Straight' AND users.gender IN ('#{user.opposite_genders.join('\',\'')}')) OR (users.orientation = 'Gay' AND users.gender IN ('#{user.same_genders.join('\',\'')}')))" 
```

从约会网站...

* * *

## 回答 #141

> 赞同：28
> 
>             
> 
> 时间：2008-10-12T17:05:06.463

问：“你在源代码中遇到过的最好的注释是什么？”

A：很简单——那个帮助我解决了我当时遇到的任何问题，而且有很多这样的问题！

其次是那些有助于指导新开发避免已知陷阱的方法。

* * *

## 回答 #142

> 赞同：28
> 
>             
> 
> 时间：2009-04-19T09:53:59.533

```
//The following 1056 lines of code in this next method 
//is a line by line port from VB.NET to C#.
//I ported this code but did not write the original code.
//It remains to me a mystery as to what
//the business logic is trying to accomplish here other than to serve as
//some sort of a compensation shell game invented by a den of thieves.
//Oh well, everyone wants this stuff to work the same as before.
//I guess the devil you know is better than the devil you don't. 
```

* * *

## 回答 #143

> 赞同：28
> 
>             
> 
> 时间：2009-04-19T22:04:38.747

```
//        .==.        .==.          
//       //`^\\      //^`\\         
//      // ^ ^\(\__/)/^ ^^\\        
//     //^ ^^ ^/6  6\ ^^ ^ \\       
//    //^ ^^ ^/( .. )\^ ^ ^ \\      
//   // ^^ ^/\| v""v |/\^ ^ ^\\     
//  // ^^/\/ /  `~~`  \ \/\^ ^\\    
//  -----------------------------
/// HERE BE DRAGONS 
```

我无法访问原始文件，因为我不再在那里工作，但它与这张照片非常相似。它位于文件的顶部，总是引起麻烦，我们必须修复但不允许花时间真正修复。（大学政治）

* * *

## 回答 #144

> 赞同：27
> 
>             
> 
> 时间：2008-12-05T19:26:52.643

```
//Visual Studio Bug Workaround:
//http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=101677

//To fix 'CJumpToHelper::GetInstance()' : undeclared identifier compiler errors, change the number lines below
//until the file compiles correctly. (This needs to be done anytime a change is made to this file)

    //////////////////////////////////////: There should be 1-10 of these lines
    //////////////////////////////////////: There should be 1-10 of these lines
    //////////////////////////////////////: There should be 1-10 of these lines
    //////////////////////////////////////: There should be 1-10 of these lines
    //////////////////////////////////////: There should be 1-10 of these lines
    //////////////////////////////////////: There should be 1-10 of these lines
    //////////////////////////////////////: There should be 1-10 of these lines
    //////////////////////////////////////: There should be 1-10 of these lines
    //////////////////////////////////////: There should be 1-10 of these lines
    //////////////////////////////////////: There should be 1-10 of these lines 
```

* * *

## 回答 #145

> 赞同：26
> 
>             
> 
> 时间：2008-10-10T16:16:41.023

```
/// <summary>
/// The possible outcomes of an update operation (save or delete)
/// </summary>
public enum UpdateResult
{

    /// <summary>
    /// Updated successfully
    /// </summary>
    Success = 0,

    /// <summary>
    /// Updated successfully
    /// </summary>
    Failed = 1
} 
```

* * *

## 回答 #146

> 赞同：26
> 
>             
> 
> 时间：2009-03-05T19:30:38.670

```
//  If you delete the credits, I will fucking kill you. 
```

在 joomla 模块中找到。

* * *

## 回答 #147

> 赞同：25
> 
>             
> 
> 时间：2009-02-02T20:48:42.417

```
//Woulda
if(x) {}
//Shoulda
else if(y) {}
//Coulda
else {} 
```

* * *

## 回答 #148

> 赞同：24
> 
>             
> 
> 时间：2009-03-05T20:52:38.533

不知道是好笑还是悲伤……但是我和我一起工作的一位实习生有这个小宝石来计算每单位的价格

```
...

// get the units from the form 
int numUnits = Integer.parseInt(request.getParameter("num_pieces")); // this break at random times

//price 
float price = Float.parseFloat(request.getParameter("price")); // same as above

// Under certain conditions the following code blows up. I don't know those conditions.
float pricePerUnit = price / (float)numUnits;

... 
```

* * *

## 回答 #149

> 赞同：23
> 
>             
> 
> 时间：2008-10-19T20:44:06.610

```
//If you're reading this, then my program is probably a success 
```

* * *

## 回答 #150

> 赞同：23
> 
>             
> 
> 时间：2009-04-21T09:30:49.837

我的一位老老板总是在谈论我们必须如何在内部使用我们自己的产品，即“吃我们自己的狗粮……”

多年后，我发现嵌入在某个临时同事所做的某个资源中，他接触的每个功能都被标记为：

```
/* NOT FIT FOR HUMAN CONSUMPTION */ 
```

* * *

## 回答 #151

> 赞同：22
> 
>             
> 
> 时间：2008-10-09T05:06:25.727

经典 ASP：  

```
'Is it worth it, let me work it'
'I put my thing down, flip it and reverse it'
'Ti esrever dna ti pilf, nwod gniht ym tup I'

NextIP = StrReverse(UserRecordset.Fields.Item(0)) 
```

* * *

## 回答 #152

> 赞同：22
> 
>             
> 
> 时间：2008-10-09T16:27:44.633

```
//open lid

//take sh!t

//close lid 
```

对文件打开、数据转储、文件关闭的评论...

* * *

## 回答 #153

> 赞同：22
> 
>             
> 
> 时间：2008-10-15T09:48:09.107

生产源代码：

```
// Remove this if you wanna be fired 
```

* * *

## 回答 #154

> 赞同：22
> 
>             
> 
> 时间：2009-04-15T05:40:03.097

```
// (c) 2000 Applied Magic, Inc.
// Unauthorized use punishable by torture, mutilation, and vivisection. 
```

啊，我一直很喜欢那个...

* * *

## 回答 #155

> 赞同：22
> 
>             
> 
> 时间：2009-04-09T22:29:56.213

很久以前，我遇到了这个：

```
/************************************************* ******************************/
/* 深奥的魔法。请勿触摸。*/
/* */
/* 不认真。XXXXXX 我在看着你。如果你再搞砸这个 */
/* 我会用我的摆线订书机杀了你。*/
/* */
/* ... */

```

然后继续描述了一个特别毛茸茸的算法。

* * *

## 回答 #156

> 赞同：22
> 
>             
> 
> 时间：2009-04-22T12:24:37.977

```
public GetRandomNumber()
{
    // Chosen by a fairly rolen dice
    return 12;
} 
```

* * *

## 回答 #157

> 赞同：21
> 
>             
> 
> 时间：2008-10-08T20:11:12.967

迄今为止最好的一个：

```
"This code makes baby Jesus very sad!". 
```

它指的是这样的字符串初始化：

```
String blankSpaces="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "+ //100 whitespaces
                   "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "+ //200 Whitespaces
                   ...
                   "                                        " //100 whitespaces 
```

反正你懂这个意思。

* * *

## 回答 #158

> 赞同：21
> 
>             
> 
> 时间：2009-03-09T16:26:02.557

```
$this->getSelect()->where ('main_table.product_id = -1'); // Mom, Dad... sorry 
```

* * *

## 回答 #159

> 赞同：21
> 
>             
> 
> 时间：2009-04-22T11:18:42.830

前段时间我遇到过：

```
raise InvalidChild() # e.g. no legs 
```

~~这是怪诞的，因为“ *inwalida* ”在波兰语中的意思是残疾人。~~傻我:)

* * *

## 回答 #160

> 赞同：20
> 
>             
> 
> 时间：2008-10-11T01:42:40.600

我告诉学员至少做一些异常处理。这就是我在每次 db 调用时得到的回报......

```
Catch (Exception e) {
    //eat it
} 
```

* * *

## 回答 #161

> 赞同：20
> 
>             
> 
> 时间：2008-12-30T13:18:35.427

对上帝诚实：

```
// This is crap code but it's 3 a.m. and I need to get this working. 
```

* * *

## 回答 #162

> 赞同：19
> 
>             
> 
> 时间：2009-04-23T02:33:40.150

我最喜欢的是已故伟大的保罗·迪拉西亚：

`// Author: If this code works, it was written by Paul DiLascia.  If not then I don't know who wrote it.`

* * *

## 回答 #163

> 赞同：19
> 
>             
> 
> 时间：2009-01-27T02:44:23.143

```
//  Hey, your shoe's untied! 
```

Followed by some dubious code, and within that code,

```
//  Keep looking!  I think it was the other shoe! 
```

Finally,

```
//  How strange -- I must be seeing things.  Anyhow, I'm going to go take a shower, now... 
```

* * *

## 回答 #164

> 赞同：19
> 
>             
> 
> 时间：2008-12-08T21:07:14.950

当我为路透社工作时，我们的一个提要处理程序中有一条评论让一些人认为全能者正在帮助我们......

```
// Jesus told me to skip to the end of the message here 
```

后来我们发现有一个拉美联系人，名叫**耶稣**（HeyZus）。

* * *

## 回答 #165

> 赞同：19
> 
>             
> 
> 时间：2008-10-12T12:18:46.837

在一个著名的商业 DOS 电子表格应用程序中：

```
/* This comment was just added in order to check-in a file that was last 
checked in by [Insert Programmer FirstName] "Back-to-the-Future" [Insert 
Programmer LastName]. While testing for year 2000 problems, he accidentally 
checked-in this file while his machine clock was set forward to the year 2000\. 
This meant that the source code was always newer than the object file and 
compiled every time the code was built. I'm checking this file in again to 
fix that. */ 
```

* * *

## 回答 #166

> 赞同：19
> 
>             
> 
> 时间：2008-12-18T19:55:42.237

我曾经写过的最喜欢的评论：

```
//the XML returned from this request is *mind-bogglingly* bad. Terrifyingly bad.
//a completed batch looks like this:
//<Batch>batchid=363777811 status=Done dateandtime=09/18/2007 09:53:10 PDT activateditems=335 numberofwarnings=0 itemsnotacivated=17 </Batch>
//and an incomplete batch like:
//<Batch>batchid=363778361 status=In Progress </Batch>
//so we'll just parse each item as a regex. Thanks Amazon. 
```

是的，亚马逊实际上是这样返回 XML 的。

* * *

## 回答 #167

> 赞同：18
> 
>             
> 
> 时间：2009-04-21T03:23:02.217

```
// This should fix something that should never happen 
```

* * *

## 回答 #168

> 赞同：18
> 
>             
> 
> 时间：2008-10-20T09:54:23.177

> David S. Miller 添加的所有错误

* * *

## 回答 #169

> 赞同：18
> 
>             
> 
> 时间：2009-04-23T06:55:06.217

```
// some sport psychology
if (!focused)
    Focus(); 
```

* * *

## 回答 #170

> 赞同：18
> 
>             
> 
> 时间：2008-10-14T04:34:36.167

`// Houston, we have a problem`

* * *

## 回答 #171

> 赞同：18
> 
>             
> 
> 时间：2009-03-05T14:41:49.313

In a game where this object can be stepped on, or:

```
stepOff(); //bitch 
```

* * *

## 回答 #172

> 赞同：18
> 
>             
> 
> 时间：2009-04-20T04:24:21.517

> /*现在，让所有这些在浏览器家族的弱智继兄弟 Internet 他妈的浏览器中看起来有点像样 */

* * *

## 回答 #173

> 赞同：18
> 
>             
> 
> 时间：2009-04-23T00:26:48.007

```
# There is a bug in the next line.  $searchParameters != {} will always return true, because {} is creating
# a new hash reference on the fly, and the inequality operater is comparing the memory location of it
# to the memory location of $searchParameters, and they will always be different. 
# This means that the following code will always get executed as long as $nodes is defined.
# I'm leaving it there because it has always been there, and although I'm sure it was originally meant to
# mean %$searchParameters (essentially "is this hash not empty"), I'm afraid to change it.
if ( $nodes && $searchParameters != {} )
{ 
```

* * *

## 回答 #174

> 赞同：17
> 
>             
> 
> 时间：2009-04-23T04:03:57.563

在 VB.NET 中使用分号

```
TextBox2.Visible = True';
For Each row In data.Tables(0).Rows
    If row("Customers.Id").ToString <> customerId Then
        customerId = row("Customers.ID").ToString';
        name = "Customer Name: " & row("Name").ToString & CrLf';
        address = "Address: " & row("Address").ToString & CrLf & CrLf';
        TextBox2.Text += name & address ';s
    End If';
Next'; 
```

* * *

## 回答 #175

> 赞同：17
> 
>             
> 
> 时间：2009-04-23T17:39:01.337

早在 80 年代初，我在汇编程序中遇到了这个问题（引自昏暗的记忆）：

```
I don't understand how the following bit works, but it worked in the program I stole it from. 
```

* * *

## 回答 #176

> 赞同：17
> 
>             
> 
> 时间：2009-04-09T22:54:30.897

```
// This is a walkaround for bug #7812 
```

由我们的一位中国程序员撰写，英语不是他的第一语言。

我真的很喜欢这个。我碰巧认为“walkaround”几乎是一个比“workaround”更好的术语。

* * *

## 回答 #177

> 赞同：17
> 
>             
> 
> 时间：2009-04-20T03:23:13.113

```
// For the sins I am about to commit, may James Gosling forgive me 
```

* * *

## 回答 #178

> 赞同：17
> 
>             
> 
> 时间：2009-04-20T04:23:43.657

## 我在遗留代码中注意到的修改日志

> 2099 年 5 月 17 日**D 琼斯**     评论了血腥的 AUZIES 代码 (02/19/99)
> 
>   
>   
> 
> 99 年 5 月 17 日**K ROBINSON**  血腥德克萨斯人无法正确拼写澳大利亚语（没有代码更改 - 只是评论）

* * *

## 回答 #179

> 赞同：16
> 
>             
> 
> 时间：2009-02-02T13:21:06.360

From Apache Xalan source code:

```
/**
 * As Gregor Samsa awoke one morning from uneasy dreams he found himself
 * transformed in his bed into a gigantic insect. He was lying on his hard,
 * as it were armour plated, back, and if he lifted his head a little he
 * could see his big, brown belly divided into stiff, arched segments, on
 * top of which the bed quilt could hardly keep in position and was about
 * to slide off completely. His numerous legs, which were pitifully thin
 * compared to the rest of his bulk, waved helplessly before his eyes.
 * "What has happened to me?", he thought. It was no dream....
 */
protected static String DEFAULT_TRANSLET_NAME = "GregorSamsa"; 
```

Further reading on [The Daily WTF](http://thedailywtf.com/Articles/Who_is_Gregor_Samsa_0x3f_.aspx).

* * *

## 回答 #180

> 赞同：16
> 
>             
> 
> 时间：2009-04-23T15:16:39.287

```
//BELOW IS THE REAL CODE...JABRONI
        //
        // Yeah, but can you play the outtro to Bark At The Moon?
        //

        //|--------------------------------------------------|------------------------------------------------|
        //|--------------------------------------------------|------------------------------------------------|
        //|--17^16-16-16-17^16-17^16-16-16-17^16-17^16----16-|-19^16----16-19^16-19^16---16-19^16-19^16----17-|
        //|--------------------------------------------19----|-------17----------------17---------------17----|
        //|--------------------------------------------------|---------------------------------------------- 
```

* * *

## 回答 #181

> 赞同：16
> 
>             
> 
> 时间：2009-04-23T04:11:33.097

```
//todo: never to be implemented 
```

* * *

## 回答 #182

> 赞同：16
> 
>             
> 
> 时间：2009-04-20T12:45:02.967

名为 monitoring.sh 的文件的前两行：

```
#!/usr/bin/perl
# perl script disguised as a bash script 
```

* * *

## 回答 #183

> 赞同：16
> 
>             
> 
> 时间：2008-12-11T20:02:51.337

Linux内核中的一些：

```
/* Sun, you just can't beat me, you just can't.  Stop trying,
* give up.  I'm serious, I am going to kick the living shit
* out of you, game over, lights out.
*/ 
```

-

```
/* 2,191 lines of complete and utter shit coming up... */ 
```

-

```
#if 0 /* XXX No fucking way dude... */ 
```

* * *

## 回答 #184

> 赞同：16
> 
>             
> 
> 时间：2008-10-11T22:24:12.420

一些源代码中的德语评论，由机器翻译或非常疲惫的人工 + Google

```
; Rechnen ja ; have faith in yes 
```

我猜原来的意思是“假设这里是真的”......但自从我把它作为我生命的口头禅。

* * *

## 回答 #185

> 赞同：16
> 
>             
> 
> 时间：2009-03-26T18:05:09.430

```
// A Gorgon class - For the love of Zeus don't look directly at it! 
```

* * *

## 回答 #186

> 赞同：16
> 
>             
> 
> 时间：2009-04-04T17:31:08.090

```
 /**
   * Returns cookies according to the filters specified.
   * 
   * @return array  Cookies!  Nom nom nom nom nom.
   */
 public function data_getCookies($uid, $name) { 
```

来自[facebook api](http://www.google.com/codesearch/p?hl=en#gS-K-kM7dUU/com_rohea_facebook/facebook-client/facebookapi_php5_restlib.php&q=%22nom%20nom%20nom%22&l=902)的某个地方。

* * *

## 回答 #187

> 赞同：16
> 
>             
> 
> 时间：2009-04-23T23:13:15.730

```
Tweet tweet = (Tweet) tweets.get(i); // Poetic. 
```

* * *

## 回答 #188

> 赞同：15
> 
>             
> 
> 时间：2008-12-15T15:26:33.297

我在 Python 2.5 的“twisted”包中找到了这个（文件是 tcp.py，第 371 行）

```
# Limit length of buffer to try to send, because some OSes are too
# stupid to do so themselves (ahem windows)
return self.socket.send(buffer(data, 0, self.SEND_LIMIT)) 
```

* * *

## 回答 #189

> 赞同：15
> 
>             
> 
> 时间：2009-04-06T11:20:56.000

```
// If I from the future read this I'll back in time and kill myself. 
```

* * *

## 回答 #190

> 赞同：15
> 
>             
> 
> 时间：2008-10-08T22:09:02.590

```
// Okay, let's do the loop, yeah come on baby let's do the loop
// and it goes like this ... 
```

* * *

## 回答 #191

> 赞同：14
> 
>             
> 
> 时间：2008-10-08T20:43:58.783

在开发团队中的每个人都大量编辑过的代码文件的标题中：

```
'Avert your eyes, it may take on other forms! 
```

好老佛兰德斯。

* * *

## 回答 #192

> 赞同：14
> 
>             
> 
> 时间：2009-04-23T00:41:21.793

[这个](http://code.google.com/p/xee/source/browse/trunk/XeePhotoshopLoader.m?spec=svn28&r=11#107)，来自 Xee，一个图像浏览器。

```
 // At this point, I'd like to take a moment to speak to you about the Adobe PSD format.
    // PSD is not a good format. PSD is not even a bad format. Calling it such would be an
    // insult to other bad formats, such as PCX or JPEG. No, PSD is an abysmal format. Having
    // worked on this code for several weeks now, my hate for PSD has grown to a raging fire
    // that burns with the fierce passion of a million suns.
    // If there are two different ways of doing something, PSD will do both, in different
    // places. It will then make up three more ways no sane human would think of, and do those
    // too. PSD makes inconsistency an art form. Why, for instance, did it suddenly decide
    // that *these* particular chunks should be aligned to four bytes, and that this alignement
    // should *not* be included in the size? Other chunks in other places are either unaligned,
    // or aligned with the alignment included in the size. Here, though, it is not included.
    // Either one of these three behaviours would be fine. A sane format would pick one. PSD,
    // of course, uses all three, and more.
    // Trying to get data out of a PSD file is like trying to find something in the attic of
    // your eccentric old uncle who died in a freak freshwater shark attack on his 58th
    // birthday. That last detail may not be important for the purposes of the simile, but
    // at this point I am spending a lot of time imagining amusing fates for the people
    // responsible for this Rube Goldberg of a file format.
    // Earlier, I tried to get a hold of the latest specs for the PSD file format. To do this,
    // I had to apply to them for permission to apply to them to have them consider sending
    // me this sacred tome. This would have involved faxing them a copy of some document or
    // other, probably signed in blood. I can only imagine that they make this process so
    // difficult because they are intensely ashamed of having created this abomination. I
    // was naturally not gullible enough to go through with this procedure, but if I had done
    // so, I would have printed out every single page of the spec, and set them all on fire.
    // Were it within my power, I would gather every single copy of those specs, and launch
    // them on a spaceship directly into the sun.
    //
    // PSD is not my favourite file format. 
```

* * *

## 回答 #193

> 赞同：14
> 
>             
> 
> 时间：2008-10-09T21:36:02.123

我相信在某个地方的 JBoss 有一行写着

```
return null; //Not really null 
```

我一直很喜欢那条线。  

* * *

## 回答 #194

> 赞同：14
> 
>             
> 
> 时间：2008-10-09T14:50:49.710

```
i++; // increment variable i 
```

* * *

## 回答 #195

> 赞同：14
> 
>             
> 
> 时间：2008-10-08T20:24:54.093

来自[usenet 的经典](http://groups.google.com/group/alt.folklore.computers/msg/ff9be1845aa1797e?hl=en&dmode=source)：

> 在泰瑞达硬件建模器代码的深处，有一个例程将一大堆十六进制数字输入到 SYS$QIO 调用中。唯一的评论是“奇怪的魔法发生在这里”。

* * *

## 回答 #196

> 赞同：14
> 
>             
> 
> 时间：2008-10-09T02:32:04.883

```
//The following code is commented out
//(a load of commented out code followed) 
```

* * *

## 回答 #197

> 赞同：14
> 
>             
> 
> 时间：2009-02-06T09:55:12.870

有一次，我问一位同事如何使用我们的内部框架做某事（具体忘记了什么，一些晦涩的技术调用）。他说“简单，看这里”，然后在他的编辑器中打开一个 .java 文件，并在几页代码的中间向我展示了这条评论：

```
// HERE 
```

我刚刚检查过，这个文件中仍然有评论:)

* * *

## 回答 #198

> 赞同：13
> 
>             
> 
> 时间：2009-04-23T03:47:39.787

```
/**
 * Happy Javadoc haiku:
 *
 * Without Javadoc
 * Builds break in Maven site stage
 * This fixes the build.
 */ 
```

* * *

## 回答 #199

> 赞同：13
> 
>             
> 
> 时间：2008-10-27T15:50:10.063

展品一：

```
return 0; // Happy ending 
```

展品 B：

```
int32_t Interpolate1DSignal(
  Array1D<float64>::Handle hfInputSamples,         // samples to be interpolated
  Array1D<float64>::Handle hfInterpolationFilter,  // polyphase filter coefficients,
  int32_t iFilterInterpolationFactor,              // # of "rows" in polyphase filter
  int32_t iFilterLength,                           // Length of each row in filter
  float64 fInterpolationFactor,                    // Factor to interpolate the
                                                   // signal by
  float64 fTimingOffset,                           // Offset into the signal (units   
                                                   // of samples)
  Array1D<float64>::Handle hfOutputSamples         // left as an exercise for the reader
); 
```

* * *

## 回答 #200

> 赞同：13
> 
>             
> 
> 时间：2008-12-18T23:24:16.077

```
// This code was written by a genius so don't try to understand it with
// your tiny little brain. 
```

* * *

## 回答 #201

> 赞同：13
> 
>             
> 
> 时间：2009-04-21T12:56:04.273

```
else
{
    // rien, c'est parfait.
} 
```

* * *

## 回答 #202

> 赞同：13
> 
>             
> 
> 时间：2009-04-20T16:38:29.367

`// This will save us ~0.5 sec for every user and please the machine spirits.`

在很长的程序之前:)

* * *

## 回答 #203

> 赞同：12
> 
>             
> 
> 时间：2008-10-09T04:59:39.763

实际上在前几天看到了这一点，是在截止日期紧迫时编写的一些代码上。

```
//This was clearly written under duress 
```

* * *

## 回答 #204

> 赞同：12
> 
>             
> 
> 时间：2009-03-27T00:08:54.690

```
// this error could never happen 
```

然后——客户的电话说他看到一条错误消息说“这个错误永远不会发生”

* * *

## 回答 #205

> 赞同：12
> 
>             
> 
> 时间：2008-10-19T07:59:33.937

```
// Added because boss changed his mind : 20020111,20020501,20020820, ...
// Commented out because boss changed his mind : 20020201,20020614,20020908, ... 
```

在一个大部分被黑的 RPG 数据库和一个 SQL Server 之间的 ETL 脚本中。我有大约 10 或 20 次这样的评论......

* * *

## 回答 #206

> 赞同：12
> 
>             
> 
> 时间：2009-04-23T15:10:06.743

```
'Mind boggling, gibberish version of a SQL statement, but it work's, so dont touch it 
```

* * *

## 回答 #207

> 赞同：12
> 
>             
> 
> 时间：2009-04-20T14:04:54.913

```
// BEGIN HACK
...
// END HACK: I feel dirty. 
```

* * *

## 回答 #208

> 赞同：12
> 
>             
> 
> 时间：2008-12-19T16:03:26.680

在某些汇编程序中，在包含`&h723`

```
' RIP LVB 
```

（得到它？）

* * *

## 回答 #209

> 赞同：12
> 
>             
> 
> 时间：2009-04-20T00:52:43.023

我的一个同性恋朋友使用了我最喜欢的评论。他喜欢将他在 VB.NET 中的所有 TODO 注释标记为

```
'TODO: Matt Damon 
```

有时会提供额外的信息，但通常不会。

* * *

## 回答 #210

> 赞同：12
> 
>             
> 
> 时间：2008-10-09T21:34:33.767

```
// Hard to explain 
```

它也最终被打破了。难怪很难解释

* * *

## 回答 #211

> 赞同：12
> 
>             
> 
> 时间：2008-11-22T09:00:56.907

我想我有这样的东西：

```
 if (case1) { // trivial
...
}
else { // we are screwed
 /* fill in later */
} 
```

好的，所以我可能用了一个比螺丝钉更强大的词

* * *

## 回答 #212

> 赞同：12
> 
>             
> 
> 时间：2009-04-23T01:43:44.263

```
 rescue
    # silently, we fail
    # many validations fade
    # like tear drops in rain
  end 
```

这只是众多...

* * *

## 回答 #213

> 赞同：12
> 
>             
> 
> 时间：2009-03-06T13:20:19.033

```
/**---------START-----------**/

  //  IMPLEMENTATION GOES HERE

/**---------END-----------**/ 
```

**但没有代码；）**

* * *

## 回答 #214

> 赞同：12
> 
>             
> 
> 时间：2009-04-20T12:19:15.680

当我在高中上 CS 课时，我们在普通教室里上课——没有电脑。我们所有的测试都是在我们上交的纸上完成的——每张纸上一节课。我们的老师第一次用 C++ 教这门课，偶尔会在黑板上切换到 Pascal 模式。这很尴尬，因为我们当中很少有人对学习 Pascal 感兴趣。

对于比课堂更大的作业，我们会在家里完成并提交代码+输出打印输出以进行评分。在提交了一些代码 + 输出打印输出后，我们集体意识到老师实际上并没有阅读代码 - 只是打印输出。为了验证我们的理论，我在代码的第 3 页添加了一条评论——就在一些类声明之间：

```
// If you are reading this, please place a checkmark here [  ] 
```

当然，我把它拿回来了，前面有一个大大的蓝色“A”，没有找到复选标记。

* * *

## 回答 #215

> 赞同：12
> 
>             
> 
> 时间：2009-04-24T17:21:00.030

在makefile中找到这个

```
# ===== Never edit below this line. Ever. Or I'll kick your ass. ==== 
```

* * *

## 回答 #216

> 赞同：11
> 
>             
> 
> 时间：2009-04-22T15:24:36.453

```
v.bpc     := v.pc;  -- Remember to jump back
v.baccu   := accu;  -- Yo dawg, heard you like runing instructions
                    -- so I took backup of your accu so you can run
                    -- instructions while you run instructions.
v.flags.i := false; -- No more interupts 
```

* * *

## 回答 #217

> 赞同：11
> 
>             
> 
> 时间：2009-02-11T18:38:27.210

我猜它是病毒式的，我在一个阻止 OOM 杀手选择它的守护进程 (Linux) 中发现了以下内容：

```
/*
 * Don't OOM me, bro!
 */ 
```

这是在 mlockall() 之后防止进程交换，评论说：

```
/*
 * Don't swap me, bro!
 */ 
```

* * *

## 回答 #218

> 赞同：11
> 
>             
> 
> 时间：2009-03-24T00:47:28.520

```
/* FIXME This must absolutely be removed before 4.0.7 release
 * TODO really remove this */ 
```

我们已经发布了 4.0.7、4.0.8、4.0.9 和 4.1 版本...

* * *

## 回答 #219

> 赞同：11
> 
>             
> 
> 时间：2009-04-24T10:32:30.510

```
// need a coffee to fix this. 
```

* * *

## 回答 #220

> 赞同：11
> 
>             
> 
> 时间：2009-04-25T09:10:09.060

```
// Singleton object. Leave $me alone.
private static $me; 
```

* * *

## 回答 #221

> 赞同：11
> 
>             
> 
> 时间：2009-02-06T23:27:06.460

I like some of the comments in the GNU binutils. This one is from BFD som.c:

```
/* You'll never believe all this is necessary to handle relocations
   for function calls.  Having to compute and pack the argument
   relocation bits is the real nightmare.

   If you're interested in how this works, just forget it.  You really
   do not want to know about this braindamage.  */ 
```

This one too:

```
/* Don't ask about these magic sequences.  I took them straight
   from gas-1.36 which took them from the a.out man page.  */ 
```

...

```
/* Keep track of exactly where we are within a particular
   space.  This is necessary as the braindamaged HPUX
   loader will create holes between subspaces *and*
   subspace alignments are *NOT* preserved.  What a crock.  */ 
```

Another one:

```
/* We will NOT put a fucking timestamp in the header here. Every
   time you put it back, I will come in and take it out again. ... */ 
```

From gas:

```
/* Yes this is ugly (storing the broken_word pointer
   in the symbol slot).  Still, this whole chunk of
   code is ugly, and I don't feel like doing anything
   about it.  Think of it as stubbornness in action.  */ 
```

* * *

## 回答 #222

> 赞同：11
> 
>             
> 
> 时间：2008-10-09T21:26:57.667

在 XSLT 文件的标题中：

```
DON'T TOUCH THIS SCRIPT -> XSLT is like arcane, black magic 
```

* * *

## 回答 #223

> 赞同：11
> 
>             
> 
> 时间：2009-03-05T18:44:07.797

我最喜欢的（我必须承认我用过很多次）：

```
// Yes...I know this is repulsive and stupid.
// But <%CompanyOwnerOrManagerToken%>, not knowing a thing about code,
// demanded I do it anyways. SO, go crap on their desk, not mine.
// K THX BYE 
```

* * *

## 回答 #224

> 赞同：11
> 
>             
> 
> 时间：2009-04-20T00:45:44.773

```
/* Here I sit, Joe broken hearted, came to do some sh*t, but only just started. */ 
```

关于一些繁重的正则表达式输入验证。

* * *

## 回答 #225

> 赞同：11
> 
>             
> 
> 时间：2009-01-16T04:11:06.020

## Linux 评论

这里有很多好东西...

这些都是linux中的注释

[http://lwn.net/1998/1015/a/f-word.html](http://lwn.net/1998/1015/a/f-word.html)

我的最爱：

```
./arch/sparc/kernel/ptrace.c
/* Fuck me gently with a chainsaw... */

./drivers/scsi/qlogicpti.h
/* Am I fucking pedantic or what? */ 
```

* * *

## 回答 #226

> 赞同：11
> 
>             
> 
> 时间：2009-04-24T10:10:46.850

好吧，这是我[刚刚承诺](http://echoreply.us/hg/nexgent.hg/index.cgi/rev/4b0b3e693f3b)的一个：

```
/* Every time I re-visit this function, I feel like
 * I need to take a shower.
 *
 * Don't get too used to this function, its days are
 * numbered.
 */ 
```

有人可以创建类似 greatcodecomments.com 的网站并赚取一些现金。然而，那个人不是我。

* * *

## 回答 #227

> 赞同：11
> 
>             
> 
> 时间：2008-10-08T21:06:39.423

这实际上是我在将原型转换为真实代码时制作的：

```
// Abandon all hope you who needs to debug this 
```

是的，比我聪明的人事后实际上重构了代码（它必须有一个好的结局）。

* * *

## 回答 #228

> 赞同：11
> 
>             
> 
> 时间：2008-10-08T22:44:26.853

“这永远不会发生”。

著名的遗言我的朋友...

* * *

## 回答 #229

> 赞同：11
> 
>             
> 
> 时间：2009-02-02T21:52:23.037

不是代码注释，而是 SVN 在同一个文件上提交注释：

第一次提交（在测试人员返回结果后跟随其他几十个）：

```
Squashed some IPR mod bugs. The were big and juicy ones, too. 
```

第二次提交：

```
Squashed some more mod bugs. Those are some nasty bugs, them mod bugs... 
```

第三：

```
Squashed some more mod bugs. They are like cockroaches: they'll live through a nuclear war. 
```

第四：

```
Squashed some more John bugs. They too are like cockroaches: they appear anywhere John goes. Wait. That doesn't sound right. 
```

第五：

```
Same John bug. It didn't die, just played 'possum. 
```

是的，我厌倦了“固定错误”。

* * *

## 回答 #230

> 赞同：11
> 
>             
> 
> 时间：2009-04-15T07:55:56.810

我曾经在一个项目中发现这个评论：

```
// Cabbage fart? 
```

我不知道它应该是什么意思。很高兴我的立方体不在写它的人旁边。

* * *

## 回答 #231

> 赞同：11
> 
>             
> 
> 时间：2009-04-21T11:24:25.213

```
public function get state( /* of Palestine back */ ):Boolean 
```

* * *

## 回答 #232

> 赞同：11
> 
>             
> 
> 时间：2009-04-23T01:21:14.007

在一个完全任意的行之后的几千行 JScript 文件的中间......

```
// The world is a happy place. 
```

* * *

## 回答 #233

> 赞同：10
> 
>             
> 
> 时间：2009-04-19T21:13:15.813

```
/**
 * Not even your mum thinks you're special if you call this method
 */    
onlyYourMumThinksYoureSpecialIfYouCallThisMethod() {...} 
```

* * *

## 回答 #234

> 赞同：10
> 
>             
> 
> 时间：2008-10-10T08:40:20.613

我不记得确切，但这个想法是这样的：

```
Person p = new Person("John", "Doe", "male");
Collection women = new ArrayList();
women.insert(p.getTail()); 
```

这是肮脏的代码；）

* * *

## 回答 #235

> 赞同：10
> 
>             
> 
> 时间：2008-10-10T15:37:34.737

> `// Whoever put this here is an idiot...this doesn't work at all !`

但是代码还在...

* * *

## 回答 #236

> 赞同：10
> 
>             
> 
> 时间：2008-10-19T07:36:50.097

```
// fix for groupid > 9 
// if groupid ever gets to 100 everything will break (again)

if (groupid < 10) {
groupid = "0" + groupid;
} 
```

* * *

## 回答 #237

> 赞同：10
> 
>             
> 
> 时间：2008-10-09T13:05:52.123

```
// TODO - Comment this function 
```

* * *

## 回答 #238

> 赞同：10
> 
>             
> 
> 时间：2008-11-21T19:57:13.400

今天刚加了这个：

```
// Hardcoded this for time sake ... will make andrew fix later :) 
```

* * *

## 回答 #239

> 赞同：10
> 
>             
> 
> 时间：2008-10-09T08:56:49.020

在 LucasArts 的电脑游戏 'The Eidolon' 的源代码中看到（这本身就很奇怪和古怪）......

```
// He's dead, Jim! 
```

* * *

## 回答 #240

> 赞同：10
> 
>             
> 
> 时间：2008-10-13T14:53:00.270

来自一个显然一直在看巨蟒的小伙子：

> ```
> > // And now, for something completely
> > // different: 
> ```
> 
>   
>   
> 
> 类落叶松{

* * *

## 回答 #241

> 赞同：10
> 
>             
> 
> 时间：2008-10-11T22:08:40.720

```
'Do not optimize these next two lines. Compiler bugs lurk. 
```

他们做到了。将变量压缩到第二行的表达式中会导致跳转到堆的中间并尝试执行数据。

* * *

## 回答 #242

> 赞同：10
> 
>             
> 
> 时间：2009-02-05T10:57:23.713

此评论来自我必须调试的旧项目：

```
//Haleluya i can go home! 
```

* * *

## 回答 #243

> 赞同：10
> 
>             
> 
> 时间：2009-04-19T23:05:44.730

来自 UNIX 版本 6 源代码，大约 1975 年：

```
/* You are not expected to understand this. */ 
```

* * *

## 回答 #244

> 赞同：10
> 
>             
> 
> 时间：2009-04-20T02:17:07.157

```
// Fuck. 
```

那，还有……

```
// This code worked before, but my cat decided to take a trip across my keyboard... 
```

* * *

## 回答 #245

> 赞同：10
> 
>             
> 
> 时间：2008-10-08T20:32:50.910

```
int Q13Factor = 8125; // 2^13 for Q13 
```

* * *

## 回答 #246

> 赞同：10
> 
>             
> 
> 时间：2008-10-08T21:11:36.543

```
THIS PROGRAM HAS CODE THAT DOES NOT MEET STANDARDS 
```

该评论几乎出现在我们这里的每个程序中......

* * *

## 回答 #247

> 赞同：10
> 
>             
> 
> 时间：2008-10-09T07:41:53.120

在 JUnit API 中找到：

```
/**
 * ...as the moon sets over the early morning Merlin, Oregon
 * mountains, our intrepid adventurers type...
 */
public Test createTest(Class theClass, String name) {
    ...
} 
```

* * *

## 回答 #248

> 赞同：10
> 
>             
> 
> 时间：2009-03-05T20:41:10.527

```
 // Some wanker in ISO got rid of ifstream(int), ofstream(int), and
   // fstream(int).  Twit. 
```

* * *

## 回答 #249

> 赞同：10
> 
>             
> 
> 时间：2009-03-05T18:02:22.563

在我决定用脚本语言替换它之前，我不得不将它添加到我们旧的数据表驱动的规则引擎中。

```
 /************************************************************
        *                                                           *
        *  .=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-.       *
        *   |                     ______                     |      *
        *   |                  .-"      "-.                  |      *
        *   |                 /            \                 |      *
        *   |     _          |              |          _     |      *
        *   |    ( \         |,  .-.  .-.  ,|         / )    |      *
        *   |     > "=._     | )(__/  \__)( |     _.=" <     |      *
        *   |    (_/"=._"=._ |/     /\     \| _.="_.="\_)    |      *
        *   |           "=._"(_     ^^     _)"_.="           |      *
        *   |               "=\__|IIIIII|__/="               |      *
        *   |              _.="| \IIIIII/ |"=._              |      *
        *   |    _     _.="_.="\          /"=._"=._     _    |      *
        *   |   ( \_.="_.="     `--------`     "=._"=._/ )   |      *
        *   |    > _.="                            "=._ <    |      *
        *   |   (_/                                    \_)   |      *
        *   |                                                |      *
        *   '-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-='      *
        *                                                           *
        *      LASCIATE OGNI SPERANZA, VOI CH'ENTRATE               *
        *************************************************************/ 
```

* * *

## 回答 #250

> 赞同：9
> 
>             
> 
> 时间：2008-10-09T03:35:32.383

```
# absolutely foul heuristic code.
# ..it's dirty, but you want it. 
```

和：

```
# VERY USEFUL DEBUGGING AID, for when the above all goes pearshaped: 
```

* * *

## 回答 #251

> 赞同：9
> 
>             
> 
> 时间：2008-10-10T12:16:31.930

不是评论而是属性

```
[ThereBeDragons] 
```

我在 IHttpHandler 的实现中看到了一个

```
//What is this?
public bool IsReusable
{
    get{return false;}
} 
```

* * *

## 回答 #252

> 赞同：9
> 
>             
> 
> 时间：2009-04-20T18:11:14.947

在调试其他人的 JavaScript 时，我看到了以下评论：

```
// Notice: I feel so dirty doing this, but it's the only way to make it cross browser. 
```

但是在阅读 Scott Hanselmen 的一篇文章时，我发现了以下引用与我在代码中找到的评论非常吻合：

```
Every line of code you write that you feel gross about will ultimately come back to haunt you. Therefore, avoid writing code that makes you feel dirty. 
```

那很好笑 ：）

* * *

## 回答 #253

> 赞同：9
> 
>             
> 
> 时间：2008-10-24T22:43:01.643

这是我自己的代码中的一个，但它仍然很有趣，我想我不妨把它放上去，因为它在公共 SVN 中。

```
// These were orginally up and down. When it was clear the names were
// inapplicable, they were renamed to retain the joke.
// Sorry if you were hoping for useful variable names.
quantum strange, charm; 
```

* * *

## 回答 #254

> 赞同：9
> 
>             
> 
> 时间：2008-10-09T09:50:37.993

```
/* My lawyer told me not to reveal */ 
```

* * *

## 回答 #255

> 赞同：9
> 
>             
> 
> 时间：2009-04-15T19:35:41.607

```
public int hashCode() {
//sucks, but what're you gonna do

/*
int hash = 7;
for (int i = 0; i < array.length; i++)
    hash = hash * 31 * (null == array[i] ? 0 : array[i].hashCode());
return hash;
*/

return 0;
} 
```

* * *

## 回答 #256

> 赞同：8
> 
>             
> 
> 时间：2009-04-20T18:46:50.353

```
/**
 * This run through all the guipublisherbuyRecord , the records those have
 * diff. is buytotal and prior to buy isRecommendedBillingClickedWarning flag
 * is set if priously RB ran and this time not.
 * 
 * --What?
 * 
 * @return
 * @throws AppException
 */ 
```

* * *

## 回答 #257

> 赞同：8
> 
>             
> 
> 时间：2009-04-20T04:58:48.453

```
// TODO: not this 
```

由一位同事在迫切需要优化的查询上方编写。在他的辩护中，那时我们已经连续几个月每周工作 70 小时……

* * *

## 回答 #258

> 赞同：8
> 
>             
> 
> 时间：2009-03-26T23:43:23.737

```
// TODO: Drive an ashen stake through the foul heart of this function. 
```

这是一个犯规的函数。直到今天我都在做噩梦。

* * *

## 回答 #259

> 赞同：8
> 
>             
> 
> 时间：2008-10-08T20:11:04.403

```
// TODO: Implement this function! 
```

* * *

## 回答 #260

> 赞同：8
> 
>             
> 
> 时间：2009-01-28T17:52:27.817

我刚刚在一个非常简单的大学课程测试 C++ 程序中遇到了这个。

我在评论一堂课。

在析构函数...

```
// Choose! Choose the form of the Destructor!
// The choice is made! The Traveler has come! 
```

* * *

## 回答 #261

> 赞同：8
> 
>             
> 
> 时间：2008-10-12T06:41:25.130

这是我最喜欢的评论。

```
/// I intend to do this as shittily as possible because there are many better products that will totally blow this out of the water
/// and we don't have them so whatever 
```

稍后在文件中我们有更多的乐趣，比如

```
/// sidestep a bug in WCF (that we can't send types across)
/// or, depending on how you look at, this issue is a Feature 
```

稍后再

```
if( where == null)//be nice 
```

* * *

## 回答 #262

> 赞同：8
> 
>             
> 
> 时间：2009-04-22T20:14:14.930

```
// 待办事项：完成。

```

* * *

## 回答 #263

> 赞同：8
> 
>             
> 
> 时间：2009-04-22T20:08:53.320

```
//Dave chapelle reports errors.
function reporterror() {
  davechapelle.trace("FUCK!");
} 
```

* * *

## 回答 #264

> 赞同：8
> 
>             
> 
> 时间：2009-04-20T14:48:46.400

```
/*

 ____________________
/                    \
| Jean-Michel Bechet |
| 2002-2009          |
\___  _______________/
    |/
 (o_
 //\
 V_/_

*/ 
```

* * *

## 回答 #265

> 赞同：8
> 
>             
> 
> 时间：2009-04-19T03:45:18.983

```
// This condition can't happen. Call the police or something. 
```

* * *

## 回答 #266

> 赞同：8
> 
>             
> 
> 时间：2008-12-17T18:33:17.803

```
catch (Domain.ConcurrencyException)
{
    // somebody changed it between the time we loaded it and now.
    // weird, huh?
} 
```

* * *

## 回答 #267

> 赞同：8
> 
>             
> 
> 时间：2009-04-20T17:05:34.510

```
// This part is more difficult 
```

在方法的顶部。

那是大约 5 行长。

而且不是很困难。

这是唯一的评论。

在整个应用程序中。

* * *

## 回答 #268

> 赞同：8
> 
>             
> 
> 时间：2009-04-20T00:52:36.223

我在 Google 代码搜索中找到了这个

```
 // Constructs a tuple with 2 elements (fucking idiot, use std::pair instead!)
    template <typename T0,typename T1>
    inline tuple <T0,T1> make_tuple (const T0& t0,
            const T1& t1) {
            tuple <T0,T1> t;
            t.get<0>() = t0;
            t.get<1>() = t1;
            return t;
    } 
```

* * *

## 回答 #269

> 赞同：8
> 
>             
> 
> 时间：2009-04-06T11:48:13.810

好吧，这些是我的，所以 WTF 就是我，正如 CodingHorror 所说：

```
//#region Code for weird cases - do you really want to know? 
```

我曾经在一些 ASP 中留下这样的评论：

```
' Commented out following code, don't delete for when [CustomerName] changes his mind 
```

碰巧的是，[CustomerName] 并没有改变主意，但他确实可以访问 Web 服务器，并且他确实找到了那条线路......

* * *

## 回答 #270

> 赞同：8
> 
>             
> 
> 时间：2008-10-20T06:55:12.150

在一家要求记录和评论所有应用程序中断的大型投资银行中，我看到了

```
Without a crash 

Or mighty bang 

The sync disk 

Did it's process hang 
```

* * *

## 回答 #271

> 赞同：8
> 
>             
> 
> 时间：2009-04-19T13:06:24.127

```
var arbitraryNumber = 10;
//I don't know why. Just move on. 
```

* * *

## 回答 #272

> 赞同：8
> 
>             
> 
> 时间：2008-10-09T01:31:34.067

```
// Bad Christian, No cookie 
```

在此上下文中的 Cookie**不是**指浏览器 cookie

* * *

## 回答 #273

> 赞同：8
> 
>             
> 
> 时间：2008-10-13T07:36:59.543

```
// THE LOOP THAT DO EVERYTHING!!!!!!! 
```

* * *

## 回答 #274

> 赞同：8
> 
>             
> 
> 时间：2009-03-16T10:44:58.027

[我在查看TVNZ 网站早期版本](http://web.archive.org/web/20040609194213/tvnz.co.nz/view/tvnz_index_skin/tvnz_index_group)的 HTML 源代码时发现了这个宝石（如果你在家玩的话，从第 571 行开始）：

```
<!-- Hopfully we can do this otherwise the nav is going to be pretty plain and Hong will go postal. --> 
```

* * *

## 回答 #275

> 赞同：7
> 
>             
> 
> 时间：2008-10-09T05:16:38.263

我在重用我很久以前编写的 PHP 类时发现了这一点。我仍然不记得那里去了什么，我仍然发现它没有用......我什至不记得我写过那个评论；所以当我找到它时，我真的大声笑了出来。

```
try
{               
    // Some database logic
}
catch (Exception $ex)
{
    // sure, it looks silly and I honestly cant remember what code used to go here... but i swear i will
    // find a use for this code.... eventually....
    throw $ex;
} 
```

* * *

## 回答 #276

> 赞同：7
> 
>             
> 
> 时间：2009-01-10T20:49:03.840

```
i++; //increment i 
```

* * *

## 回答 #277

> 赞同：7
> 
>             
> 
> 时间：2009-03-10T02:59:12.580

```
// insert comment here 
```

* * *

## 回答 #278

> 赞同：7
> 
>             
> 
> 时间：2009-04-20T18:15:49.163

我最近看到了这个：

> // 你刚刚输掉了比赛

如果你不知道游戏是什么：
 [http://en.wikipedia.org/wiki/The_Game_(mind_game)](http://en.wikipedia.org/wiki/The_Game_(mind_game)) 
（这很傻，但在某种程度上很有趣）

* * *

## 回答 #279

> 赞同：7
> 
>             
> 
> 时间：2008-10-16T11:54:48.583

```
 // WARNING!!!
 // Very perversive code ahead!

... about a 20 lines of "very perversive" code ...

// Now you can call your grandmother back. ;) 
```

* * *

## 回答 #280

> 赞同：7
> 
>             
> 
> 时间：2008-10-09T08:24:16.683

一个文件中 5000 多行代码中的极少数评论中的一些

实际上我与为他的编码风格辩护的编码员发生了争执……

没有评论！

并且没有评论；-)（或很少）

可悲的是，这是生产代码。

```
offset=1;
for (i=0;i<=len;i++)
    {
    if ((i!=0)&&(i<len)) **//-3**
        {
        switch(mess[i])
            {
            case ETX:
            case ETB:
            case DLE:
                buf[offset]=DLE;
                offset++;
                break;
            }
        }
    buf[offset]=mess[i];
    offset++;
    } 
```

我喜欢开关！

```
for (n=0;n<offset;n++)
{
    Sleep(TR);  **//Modif A**
    Sleep(T);**//**
    FWriteFile(hCom,buf+n,1,&dwMot,NULL);
    if (ECHO)
        FReadFile(hCom,tab,1,&dwMot,NULL);
} 
```

不，没有注释解释标题中的“modif A”是什么。

```
if (GetFileSize(hSlotFile,NULL)==3600)   //5*720 
```

什么是720？

* * *

## 回答 #281

> 赞同：7
> 
>             
> 
> 时间：2008-10-09T08:42:59.750

在为某家芬兰移动网络设备制造商工作时，通过硬件抽象层探索，我发现芬兰语单词“puukko”出现了 100 多次。

“puukko”是每个芬兰人在他们的工具箱或房子周围都有的万能刀。它用于从削土豆到进行计算机维修的所有事情（我的观察）。我相信在这种情况下，它在芬兰语中相当于“Hack”这个词。

我的芬兰同事否认了这一点，并说这更像是“外科手术/干预”……我几乎相信他们，直到我找到评论：

```
/* Perkele ISO Puukko! */ -> Fucking Big Hack! 
```

* * *

## 回答 #282

> 赞同：7
> 
>             
> 
> 时间：2008-10-11T19:45:15.813

不是真的评论：

```
DvLog::Log("This silly log message fixes a PSCRIPT5.DLL gpf when printing to Adobe."); 
```

可悲的是，没有评论，PSCRIPT5.DLL 真的爆炸了......

* * *

## 回答 #283

> 赞同：7
> 
>             
> 
> 时间：2009-04-24T09:49:02.907

第一次在我们的应用程序中重新编译 FreeTextBox3，因为我们需要 IE8 支持......看看我发现了什么：

```
// IE7 update. this is still bad code, but IE8 is probably a long way off :) 
```

* * *

## 回答 #284

> 赞同：7
> 
>             
> 
> 时间：2009-04-03T13:16:30.007

```
catch (Exception ex)
{ 
    // just die already.
} 
```

* * *

## 回答 #285

> 赞同：7
> 
>             
> 
> 时间：2008-10-10T02:38:14.853

一个奇怪而恰当的有趣错字：

`assert(0); // should never shit this point`

* * *

## 回答 #286

> 赞同：7
> 
>             
> 
> 时间：2009-04-22T11:43:13.503

我在 FULL 的显式怪异强制转换函数中看到了这段代码：

```
// Since today's CPUs are really fast, this is dedicated to those who said:
// " You can't use Moore's Law as an excuse to write bad software. " 
```

代码太可怕了:)

* * *

## 回答 #287

> 赞同：7
> 
>             
> 
> 时间：2008-12-18T19:26:11.440

在 LKM 中：

```
/*
* Dear Richard Stallman,
*
* This one's for you.
*
* Sincerely,
* Me
*
*/
MODULE_LICENSE( "GPL" ); 
```

* * *

## 回答 #288

> 赞同：7
> 
>             
> 
> 时间：2009-04-22T10:13:10.383

```
// *** drunk -- fix later *** 
```

[直接链接](http://www.google.com/codesearch/p?hl=en#BNbNcRE4c0E/~wvereeck/h838/Transceiver_ver10.java&q=drunk%20fix%20later&l=617)

[谷歌代码搜索](http://www.google.com/codesearch?hl=en&lr=&q=+drunk+fix+later&sbtn=Search)更有趣......

* * *

## 回答 #289

> 赞同：7
> 
>             
> 
> 时间：2009-04-27T16:24:23.603

```
# dont question, i just felt like throwing some globals in
# this is actually quite pointless as youll soon see 
```

稍后在代码中

```
#draw the circles (complicated)...dont question 
```

甚至以后...

```
# complicated process of drawing the circles in a
# somewhat symmetrical, 3-d pattern
# dont question again 
```

甚至后来……

```
# will determine if user clicks on die
# i determined these values...dont worry about them 
```

* * *

## 回答 #290

> 赞同：6
> 
>             
> 
> 时间：2008-10-09T03:38:39.740

刚从大学毕业，我很想弄脏自己的手。我的第一个任务是……“为我评论这段代码”。

笨蛋。

过了一会儿，我厌倦了它...

```
// this function doesn't actually calculated the profit, like it says --it really signals the mothership orbiting saturn that the planet is ripe for takeover

[later]

// I don't think anyone is going to read this

[various permutations on that last one] 
```

* * *

## 回答 #291

> 赞同：6
> 
>             
> 
> 时间：2009-04-06T10:02:57.683

```
# Don use this. Never! 
```

* * *

## 回答 #292

> 赞同：6
> 
>             
> 
> 时间：2008-11-25T00:54:11.393

```
<!-- THIS IS THE MAIN CONFIGURATION FILE FOR THE ENTIRE BLOODY DIRECTORY    -->
<!--    WHATEVER YOU DO, DO NOT EDIT THIS FILE WITHOUT TALKING TO ME FIRST  -->
<!--                                I'M SERIOUS                             -->
<!-- (scroll down) --> 
```

* * *

## 回答 #293

> 赞同：6
> 
>             
> 
> 时间：2008-10-09T13:22:03.073

```
-- Change Log:  Not needed. The code is perfect 'cause I wrote it.
-- If you change it, it will break. 
```

我正在审查一些代码注释以检查它们是否有意义，并看到了上面的谦虚行。

* * *

## 回答 #294

> 赞同：6
> 
>             
> 
> 时间：2008-12-15T15:30:05.537

我没有确切的代码包了，但我清楚地记得那个评论。

```
// The code below needs to be changed immediately.
// I wish I was a little bit taller
// I wish I was a baller
// I wish I had a girl who looked good, I would call her. 
```

* * *

## 回答 #295

> 赞同：6
> 
>             
> 
> 时间：2009-04-24T00:04:35.853

```
// TODO: what the hell is this all about? 
```

然后一些注释掉的代码。

这是在我们今天早些时候工作的代码中发现的。不知道该笑还是该哭……

* * *

## 回答 #296

> 赞同：6
> 
>             
> 
> 时间：2009-02-11T18:19:15.120

我曾经研究过 Windows 3.0 的源代码。（不，作为微软员工，我赶紧补充一下！）在那里，我遇到了一个文件加载器，它多次重入，并且有一个讨厌的双关语的例子（只是为了显示作者有多聪明）。

这种可重入代码的混乱是使用英特尔汇编 jmp 指令（在 C 代码中间）执行的，该指令转到标签`"we_are_not_in_kansas_any_more_toto"`.

* * *

## 回答 #297

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T19:06:49.410

Control + A，重写

这是作为签入注释添加到先前项目的源代码管理中的注释。

* * *

## 回答 #298

> 赞同：6
> 
>             
> 
> 时间：2008-10-10T00:33:33.497

在被迫为贫血的领域对象编写单元测试时，这些对象只不过是一堆 getter 和 setter（我也被迫编写）：

```
// zzzzZZZZzzzz.... 
```

* * *

## 回答 #299

> 赞同：6
> 
>             
> 
> 时间：2008-10-11T18:45:10.677

```
Case 1:
   ...
   break;
   ...
//I don't want do do this but [my coworker] says it's part of the code standard
default:
   break; 
```

* * *

## 回答 #300

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T22:26:02.317

这是针对我们在大学宿舍中使用的自定义 DHCP 服务器，根据计算机是否注册/安装补丁和防病毒软件，将计算机放入“干净”或“脏”的 IP 地址池中：

```
public boolean getDirty (String MAC) // not as fun as it sounds 
```

* * *

## 回答 #301

> 赞同：6
> 
>             
> 
> 时间：2008-12-30T12:56:27.143

来自 C# 中的单元测试类：

```
#region quis custodiet ipsos custodes?

[Fact]
public void TestPositive()
{
    Assert.Equal(4, 2 + 2);
}

[Fact]
public void TestNegative()
{
    Assert.Equal(5, 2 + 2);
}

#endregion 
```

* * *

## 回答 #302

> 赞同：6
> 
>             
> 
> 时间：2009-04-20T02:17:06.893

```
#ifdef TRACE
#undef TRACE     /* All your trace are belong to us. */
#endif
#define TRACE .... 
```

* * *

## 回答 #303

> 赞同：6
> 
>             
> 
> 时间：2008-10-09T01:10:18.120

[在向朋友展示Coding Horror 的这篇文章](http://www.codinghorror.com/blog/archives/001137.html)几个小时后，我在他的代码上看到了这条评论：

> // MrValdez 是一个暴力的精神病患者。不要惹他生气。

* * *

## 回答 #304

> 赞同：6
> 
>             
> 
> 时间：2009-01-06T16:26:33.397

```
// I love the smell of dirty XML in the morning
xml = xml.Replace("xmlns=\"urn:bsd.orion/inventory\"", ""); 
```

* * *

## 回答 #305

> 赞同：6
> 
>             
> 
> 时间：2009-04-20T02:44:47.700

这整个功能非常棒（来自Linux sunhme.c 驱动程序，用于Sun 昵称为Happy Meal 的网卡。因为之前的网卡是“巨无霸”。明白了吗？明白了吗？）

```
static void happy_meal_tcvr_write(struct happy_meal *hp,
                              void __iomem *tregs, int reg,
                              unsigned short value)
{
    int tries = TCVR_WRITE_TRIES;

    ASD(("happy_meal_tcvr_write: reg=0x%02x value=%04x\n", reg, value));

    /* Welcome to Sun Microsystems, can I take your order please? */
    if (!(hp->happy_flags & HFLAG_FENABLE)) {
            happy_meal_bb_write(hp, tregs, reg, value);
            return;
    }

    /* Would you like fries with that? */
    hme_write32(hp, tregs + TCVR_FRAME,
                (FRAME_WRITE | (hp->paddr << 23) |
                 ((reg & 0xff) << 18) | (value & 0xffff)));
    while (!(hme_read32(hp, tregs + TCVR_FRAME) & 0x10000) && --tries)
            udelay(20);

    /* Anything else? */
    if (!tries)
            printk(KERN_ERR "happy meal: Aieee, transceiver MIF write bolixed\n");

    /* Fifty-two cents is your change, have a nice day. */ 
```

}

* * *

## 回答 #306

> 赞同：6
> 
>             
> 
> 时间：2009-04-20T02:52:15.420

`// This is confusing, I KNOW, so let me explain it to you.`

* * *

## 回答 #307

> 赞同：6
> 
>             
> 
> 时间：2009-04-20T22:21:46.357

 `// no comment` 

* * *

## 回答 #308

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T01:00:14.680

`# as you can see: I comment the code!`

* * *

## 回答 #309

> 赞同：6
> 
>             
> 
> 时间：2009-04-27T09:58:18.040

```
// *** AAAAAHAHAHAH!!  What is this?? 
```

* * *

## 回答 #310

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T16:29:06.620

> `/* This is a replica of a horrible hack - many moons ago, the legacy PortfolioServer was modified to return cash trades in an "optionTrade" block, because the client side developer was too lazy to get their XPaths right. Their laziness echoes through the ages, and means we need a similar hack here...*/`

* * *

## 回答 #311

> 赞同：5
> 
>             
> 
> 时间：2009-04-24T06:19:30.010

我们有一个小组项目，使用 Min-Max 树创建 Connect 4 AI。在我们的移动计分函数中，我们让它计算棋盘的分数，在代码块上方有这样的注释：

```
// This is kind of almost useless 
```

但它会变得更好。我们的导师给了我们一些他制作的粗略 AI 的示例代码，他留下了很好的评论：

```
// We also add/subtract some points based on what's going on, on the bottom
// row. (I think this is retarded, but apparently when I coded this up 
// back in 1999 I didn't.) 
```

* * *

## 回答 #312

> 赞同：5
> 
>             
> 
> 时间：2009-04-24T10:39:23.083

在内容管理网络应用程序的一堆糟糕的剪切和粘贴源代码中：

```
// load image 1 - JPEG 240x320
img = f1.getImage();
if (check(img))
{
   load(img, Constants.JPEG_240x320);
}

// load image 2 - JPEG 128x128
img = f2.getImage();
if (check(img))
{
   load(img, Constants.JPEG_128x128);
}

...

// load image 13 - GIF 256x256
img = f13.getImage();
if (check(img))
{
   load(img, Constants.GIF256x256);
}

// loaded all of the f**king images 
```

注意：大致翻译自意大利语:-)

* * *

## 回答 #313

> 赞同：5
> 
>             
> 
> 时间：2009-04-11T18:08:51.003

```
<!-- Here it is --> 
```

任何地方都没有其他评论。直到今天我都不知道“它”是什么。

* * *

## 回答 #314

> 赞同：5
> 
>             
> 
> 时间：2009-03-14T00:00:19.970

我只是在我自己的一些代码中遇到了这个问题。它位于用于类别选择的 magento 管理模板中：

```
 /*
         * OK; before you read the following code know what I am trying to do.
         * I needed to get the list of child catagories from the root node so that
         * the root node didn't appear in the selection box. But for some stupid
         * fucking reason the stupid fucking DBA wont let me access the items using
         * indicies and I instead have to use their stupid fucking Iterator
         * implementation. So there.
         */
        $firstList = $this->getRootNode()->getChildren();
        foreach ($firstList as $node)
        {
            $nodes = $node->getChildren();
            break;          // wtf?
        } 
```

我当然要从我们的旗舰产品中删除语言；但我记得我非常沮丧。如果我没有留下评论，我会尝试修改它，但会遇到我以前遇到的同样问题。

* * *

## 回答 #315

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T20:10:34.107

我找到了这个：

```
I'm not sure what I did 
```

* * *

## 回答 #316

> 赞同：5
> 
>             
> 
> 时间：2009-04-25T09:36:18.903

我最喜欢的是这样的

```
# 注释掉
 ...
 ### 以前未注释的结束 #2001-02-22 John Doe

```

* * *

## 回答 #317

> 赞同：5
> 
>             
> 
> 时间：2009-04-20T18:04:36.210

我个人最喜欢的是[打油诗形式的文档](http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.2.0/twisted/python/components.py#L154)：

```
 Subclassing made Zope and TR
        much harder to work with by far.
            So before you inherit,
            be sure to declare it
        Adapter, not PyObject* 
```

这可能有点破坏了这个笑话，但由于它有点晦涩，我将解释：

这里的“TR”指的是“扭曲现实”。Zope 2 和原始`twisted.reality`包大量使用了多重继承，不幸的是，当您看到方法调用时，可能很难理解发生了什么。Zope 3、Twisted 本身和`twisted.reality`的继任者（包括最近的[Imaginary](http://divmod.org/trac/wiki/DivmodImaginary)）通常更倾向于组件组合。

* * *

## 回答 #318

> 赞同：5
> 
>             
> 
> 时间：2008-11-24T19:11:28.200

在名为“Bar”的类中（这是一个 UI 控件，其名称不具描述性），类头：

```
/// <summary>I pity the "foo".</summary> 
```

和`Remove()`方法：

```
/// <summary>A "foo" and his money are soon parted.</summary> 
```

更糟糕的是，是一个商业伙伴从生成的文档中指出了这一点。更糟糕的是，这些可能是我们从这个家伙那里得到的最接近有用文档的东西。

* * *

## 回答 #319

> 赞同：5
> 
>             
> 
> 时间：2008-10-21T14:51:00.643

```
struct core_unlocker
{
    core_unlocker(lock)
    {
        m_lock = lock
        unlock(lock)  //Abandon All Locks, Ye Who Enter Core!
    }
    ~core_unlocker()
    {
        lock(m_lock)
    }  
    private:
    Corelock m_lock;
} 
```

* * *

## 回答 #320

> 赞同：5
> 
>             
> 
> 时间：2009-04-21T11:07:21.167

Many years ago I picked up the job to provide support to a project that ran real 
time on a Z80 and was in assembly (is there any other way to do Z80??)
Anyway, the original author was a Nigerian guy by the name of Moses. Maybe I should just 
stop there.
Anyway, scattered throughout the code was this:

```
XRA A    ;MT 
```

Took me awhile to figure out what this was. The instruction itself does nothing more
than clear the accumulator. It's a slick way, although I'm not sure if there is an 
advantage or not. you can just do:

```
LDA 0 
```

But maybe

```
XRA A 
```

saves a byte or something. What is does is exclusive or the accumulator with itself.
The result is, of course, always zero. 

Back to the MT - Empty (get it?)

That's the best I've run across.

* * *

## 回答 #321

> 赞同：5
> 
>             
> 
> 时间：2009-03-26T22:50:04.207

这比您在许多评论标题中看到的可怕的法律声明和免责声明要好得多。从[SQLite](http://www.sqlite.org/)。

```
/*
** The author disclaims copyright to this source code.  In place of
** a legal notice, here is a blessing:
**
**    May you do good and not evil.
**    May you find forgiveness for yourself and forgive others.
**    May you share freely, never taking more than you give.
*/ 
```

* * *

## 回答 #322

> 赞同：5
> 
>             
> 
> 时间：2009-03-15T23:45:12.837

```
// nobody read comments! 
```

* * *

## 回答 #323

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T00:39:27.457

```
try {
   doSomething();
} catch(err) {
   // Die quietly
   alert(err);
} 
```

* * *

## 回答 #324

> 赞同：5
> 
>             
> 
> 时间：2009-04-06T14:47:17.423

设法将这个糟糕的双关语插入到我们的代码中

```
for (bo_thans = 0 ; bo_thans < MAX ; bo_thans++)
{
    if(rs == thing[bo_thans])
    {
       found = true;
    }
}

if(!found)
{
   /* Failed to find rs with bo_thans */
   ...
} 
```

* * *

## 回答 #325

> 赞同：5
> 
>             
> 
> 时间：2009-03-05T18:53:28.633

不在代码中，而是在相关的错误跟踪系统中：

> 这不可能是我的代码中的错误。我非常仔细地编码。

* * *

## 回答 #326

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T20:26:01.750

```
// This code sucks. 
```

* * *

## 回答 #327

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T20:29:51.290

```
{
This is a gathering place for all unit tests.
Create a TUnitTestWrapper, then call "RunAllUnitTests".

This class will create an instance of each thing to be tested, and call each of
their unit tests.

It does not really do any testing on it's own; it just gives a common place from
which to call everyone else's tests.

This way, one day, we can automate our testing with each build. [Cue laughter]
} 
```

* * *

## 回答 #328

> 赞同：5
> 
>             
> 
> 时间：2009-02-02T11:45:20.313

刚刚在我们的一些 PHP 代码中找到了这个

```
$s=2; // chicken and bacon wrap for lunch 
```

多么有用，幸运的是 $s 是不言自明的

* * *

## 回答 #329

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T01:45:27.380

```
""".........................:~+?7$$$ZZZZZZZ$$$7I+=:,............................
........................~+7ZZZZZOZZOOZOZZOZOZOOZZZZZ7?~:........................
......................,~7$ZZOOOOOZOZOZOZZOOZZOZOOOOOZ$$I,.......................
...................,=I$OOZOZOZZOOOZZOZOOOOZOZZZOOZZZOZZOZI=:....................
.................:?$ZZOOZZOZOZZOOOZZZOOZOZOZZZZZZZOZZOZOOOZ$I~..................
................IZOOOZOOOZZZOZZZZOZZOZOOOOZOZZZOOZZZZOOZOZZZOZ7=................
...............~ZZOZZOZOOZOOZOZOZZOZOZOZZZZZOZOZZOZOOZOZZOOOOZZ7................
.............:IZOOZOZZZZOZOZZOZOOZOZOZOZZOZOOZOOOOZOZZZZZOZOZZOOI~..............
...........,+$ZOOZZOZOZOZOZOZZOZOZOOZZOZZOZZOZOOOOZOZZOZZOOZOOOOO$?:............
..........:IZZOOOZOZZZZOOZOOZOZOZZOZOZZZZOZOOZOZZOZOZOZOOOOOOOZZZOZ7~...........
..........+$OOZZZOZZOOZOOZZZZOZZOZOZZOZOOOZOZOZZOZOZOZOOOOOZ$$77I77$+:..........
........,?$OOZZZZZZZOZOOOZOZZOZZZOOZOZOOOOZOZZZOOZOOZOOO7?~:,.......,...........
........+ZOOZZZZZOZOOZOOZZZZOZZOOOZZZOZOZOOZZOZOZZZOOO$?........................
........$ZOZZZOZZZZOZOOZZZOZOZZOOOOOOOOOOOZOZOZZOZOO$?,.........................
.......:ZOOZOZOZZOOZZOZOZOZOOOZOOOOOOOOOOOOOOOZOZOOZI:..........................
.......+OOOZOOZOZOZOZZZOOZOOZOOO$I+=~:::~+I$OOOOOOZ?:........,:=,...............
......:7ZOOZOZZOOOZOZOZOOZOOZ$I=............:?$OOZ7:.......:IZOOZ?,.............
......=$OZOZOOZOOOOOZOZZOOZ7=,................:?O$+.......~7OOOOOZ+,............
.....,?$OOOOOZZZZOOOOOOZOZ?,....................ZZ=.......=$OOZOOZ+,............
.....:IZOZZ$777I7$ZOOOOOZ7~.....................$Z=.......~7OOOOO7=.............
.....:+?~:,.......,~IZOO7~........~+II?=........?$?,.......:I$ZZ?:..............
.....................+ZO=,......:IOOOOOZ:.......=7$~............................
.....................:IO~.......=OOZOZOO=,......~7O7~...........................
...........:~:.......:IO~.......+OOOOZOO=.......~78Z?,.................,:.......
..........:IZ7~......+ZO~.......:7OOOOO$,.......+$OOZ7=,.............:?$=.......
...........,,.....,=7ZOO+,.......,=II?=:........7OOOOOOZ=:,.....,:=I$ZOO=.......
....................,:+$7=.....................~OOOZZZOOOZZ$$7$$ZOOOOOOZ=.......
......................:?Z?,...................:?OZOOZOOZOOOOOOOOOOZOZOZO=.......
............,::,.......,OO7:................,+$OOZOZOOZOZZOZOZZOOZOZOZOO=.......
...........~$8OI........$OOZI~,.........,:=IZOOZOZOZOZOOOZOZOZOOOZZZOZOO=.......
...........:??=:.......:OOOOOZZ7+=~~==+?$ZOOOOZOOOZOZOZOOZOZOZZOZZOZOZZO=.......
............::,.......,+OOZOOOOO$7777$$ZOOOOOZOZZZZOZOZZZOOZOZZOOOZOOZOO=.......
.....................=7OOZOOZOOZOOOOOOOOOZZZOZOZZOZOZOZOOOZOZOZZOZOOZOOO=.......
................,:=I$OOOZZOOOZOOOOOZOZOZZZZZOOZZZOZOZZZOOZOOZOZOZOZOZOOZ=.......
...........:~+?7ZOOOOOOZZZOZOOZOZOOZOZOZZOZZOZOZZZZOZOZZOZOZOZZOZOOZOOOZ=.......
........$$ZOOOOOOOOZOZOZZZZOZOZOOOZZZOZZZOZOOZOZZZZZZZZOOOZOOZZZOZOOZOOZ=.......
.......~OOZOOZZOOZZZZZZOOZOZOZOZZOOZOOZZZOZZOZOZZOZZZOZOOOOOZOZOZOOZOOOZ=.......
.......~OOZOOZZOZZOZOZZOZZOZOOZOZOOZOZOZZOZOOZOZZOZOZOZOZOOZOZOOOZOOZOZO=.......
.......~OOZZZOZOOOZOZOZZOZOZOZOZOOZOOZOOOOZOZOOZOOOZOOOZOZZOZOZOOZZOOOOZ=.......
.......~OOZZOZOZZZOOZOOZOZOZOZZOZZZZOZZZZOZOZZOOOOZ$ZZZZZZOZZZOZZOZOZZZO=.......
.......~OOZZOO$??$OOZOOZZOOZOZOZ+~IZOOOZOZOOZZOOZI==IZOZZOZOOZOZZOZI~=7O=.......
.......~OOZO$I:..~IZZZOZOZOZOZ$+...=7ZOOZOOZZOZZ=,..,=$ZZOZZZZZOZI~...,?=.......
.......~OOOZI:....:IZOOOZZOOO$+:....~7ZOZOZOZOZ$,....,=$OOZOOOZOI~.....:~.......
.......~OZI~........~IZZZOZ$?:........=IOOZZZ$+,.......,$ZOOOZZ7................
.......=7~............~IOZI:............7ZO$+:..........,=7ZZ7=,................
.......,,...............=~...............~=:..............,~=...................
                                                               GlassGiant.com""" 
print "Hello World!" 
```

* * *

## 回答 #330

> 赞同：5
> 
>             
> 
> 时间：2008-12-04T01:43:44.133

很久以前，我遇到了一些连接脚本，虽然我不记得语法，但我记得那些评论，因为我是 Pink Floyd 的粉丝。

```
//Attempt Handshake: Hello? This is London calling. Are we reaching you?

//Handshake Failed: I don't understand...he just hung up. 
```

* * *

## 回答 #331

> 赞同：5
> 
>             
> 
> 时间：2008-12-18T11:35:20.173

一个可怕的解码补丁（意大利语翻译）：

```
/**
*@return the value 
*@param key: the id of the list of instruments
*@PS this function is a violation of all the laws of the 
*software engineering, 
*commons sense, highway code 
*and ONU decision about the coding.
That sh*t...
*/ 
```

* * *

## 回答 #332

> 赞同：5
> 
>             
> 
> 时间：2008-12-18T13:49:02.290

那是众所周知的，但我喜欢它（在 sys/ufs/ufs_vnops.c 中）：

```
/*
 * A virgin directory (no blushing please).
 */ 
```

在 FreeBSD 内核源代码树中（甚至更早，回到 4.xBSD）

* * *

## 回答 #333

> 赞同：5
> 
>             
> 
> 时间：2009-04-21T09:31:00.350

```
/**
 * As Gregor Samsa awoke one morning from uneasy dreams he found himself
 * transformed in his bed into a gigantic insect. He was lying on his hard,
 * as it were armour plated, back, and if he lifted his head a little he
 * could see his big, brown belly divided into stiff, arched segments, on
 * top of which the bed quilt could hardly keep in position and was about
 * to slide off completely. His numerous legs, which were pitifully thin
 * compared to the rest of his bulk, waved helplessly before his eyes.
 * "What has happened to me?", he thought. It was no dream....
 */
protected static String DEFAULT_TRANSLET_NAME = "GregorSamsa"; 
```

* * *

## 回答 #334

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T16:13:28.323

 `//Iterate by one

$i++;` 

不幸的是，在我的“必须评论一切阶段”期间，这是我的。

* * *

## 回答 #335

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T19:09:52.447

在一些网站上工作时，我在嵌入式 JS 的开头发现了这一点：

> 我觉得这样做很肮脏，但那个人想要在 .NET 中使用它

* * *

## 回答 #336

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T19:20:39.663

来自 C#

```
#region Hack - Shield Eyes Before Expanding

/// <summary>
/// A single uint with all of the bits set to represent the different tracing
/// </summary>
/// <remarks>
/// Ugly I know, so if you can think of a better way, feel free to rewrite.
/// </remarks>
[Browsable(false)]
public uint TraceBitfield
{
    // Snip
}

#endregion 
```

* * *

## 回答 #337

> 赞同：5
> 
>             
> 
> 时间：2009-04-09T22:28:35.563

来自英国银行申请中的承包商。

```
// i don't know how this works but it does so i'll leave it here anyway 
```

他还添加了 BNP（英国极右翼政党）作为测试的虚拟客户之一……我们的直接上司是亚裔。

* * *

## 回答 #338

> 赞同：5
> 
>             
> 
> 时间：2009-04-20T03:09:15.737

我没有要分享的代码，但想象一下这种情况。在我们的 Linux 系统管理员前往更绿色的牧场大约一两个月后，我有幸打开了他编写的 shell 脚本。我不记得为什么我需要编辑它，但这并不重要。重要的是脚本大约有 40 行长。我滚动了评论（其中有 37 行）以到达实际的工作代码（3 行）。代码很棒，但我很好奇——为什么要 37 行注释？所以，我滚动到顶部并继续阅读。令我惊讶的是，评论是关于三行代码的作用以及如何更改它的说唱。最好的部分 - 这是 Dr. Dre 和 Snoop DO DOUBLE G 对 Nothing But AG Thing 的部分抄袭。谢谢 Brian！

* * *

## 回答 #339

> 赞同：5
> 
>             
> 
> 时间：2009-04-20T14:14:15.327

```
/*
* TODO: Remove this function

function remove($customer_id)
    {
        $this->Customer->remove($id);
    }

*/ 
```

* * *

## 回答 #340

> 赞同：5
> 
>             
> 
> 时间：2009-04-21T09:38:01.940

```
catch
{     
    // you’re fucked
    // write out the file somewhere and start screaming “Connection down! Connection down!”
} 
```

* * *

## 回答 #341

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T19:35:55.580

```
//Time log says you've been here for 15 hours GO HOME, your code is hobo 
```

* * *

## 回答 #342

> 赞同：5
> 
>             
> 
> 时间：2009-04-27T09:15:24.227

```
// woot, global var. I havent done this for a long time. 
```

* * *

## 回答 #343

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T16:31:19.703

```
public static final void attachListener(Object listener) {

/* ======================= */

// This does nothing, continue searching

/* ======================= */

... 
```

让听众痛苦！

* * *

## 回答 #344

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T21:51:05.073

```
// but the "real" solution is much more complicated 
```

来自 jpgraph

* * *

## 回答 #345

> 赞同：4
> 
>             
> 
> 时间：2009-02-01T01:30:20.960

我看过一次：

```
//this used to be a comment 
```

* * *

## 回答 #346

> 赞同：4
> 
>             
> 
> 时间：2009-02-02T12:13:43.720

```
// HACK ! COPY/PASTE this and look for another job 
```

* * *

## 回答 #347

> 赞同：4
> 
>             
> 
> 时间：2008-10-10T14:18:44.430

> 注意上述代码中的错误；我只是证明它是正确的，没有尝试过。

那是唐纳德·克努斯（Donald Knuth）的作品。

* * *

## 回答 #348

> 赞同：4
> 
>             
> 
> 时间：2009-04-24T16:00:27.913

```
//too much log will kill you 
```

这条评论是我自己写的，当时降低了一些日志的优先级，否则这些日志会写入数百 MB 的垃圾并严重削弱应用程序的性能。

* * *

## 回答 #349

> 赞同：4
> 
>             
> 
> 时间：2008-10-22T11:48:07.207

at the end of a rather long and convoluted set of while loops and if blocks, the developer in question inserted this final comment:

```
else
{
    // wobbly wilson said this would *never* happen!!
} 
```

a laconic mixture of wit and sarcasm :)

* * *

## 回答 #350

> 赞同：4
> 
>             
> 
> 时间：2009-02-02T13:29:40.587

这对其他人来说很有趣，但对我来说却不那么有趣。我从自己继承的开发人员那里继承了代码（即 ASP）。第一位程序员创建了一些非常难以理解的代码。第二位开发人员添加了如下评论（隐藏名称以保护不那么无辜的人）：

```
'This code was written by **************.
'I haven't a clue what it does. He hasn't a clue what it does.
'Nobody else has a clue what it does or how it does it.
'It is something to do with data but **** knows what.
'The ******* still works so please do not change this code,
'even though it is a complete pile of ****. 
```

那我为什么不觉得有趣呢？嗯，它是客户内部网的 ASP 代码。

...是客户向我强调了评论。

:-(

* * *

## 回答 #351

> 赞同：4
> 
>             
> 
> 时间：2008-10-12T21:29:12.203

```
' Oh man I'm pissed. I think I better go home. 
```

哪里生气 = 喝醉了

* * *

## 回答 #352

> 赞同：4
> 
>             
> 
> 时间：2009-04-19T22:10:44.130

```
//FIXME: fix this before the 1.0 release 
```

他们在第 4 版

* * *

## 回答 #353

> 赞同：4
> 
>             
> 
> 时间：2008-10-30T14:45:04.513

从旧的 Perl CGI 脚本：

```
# This is convoluted and evil, sorry. 
```

* * *

## 回答 #354

> 赞同：4
> 
>             
> 
> 时间：2009-04-22T16:41:42.477

```
#!/usr/bin/sh
#       Copyright (c) 1984, 1986, 1987, 1988, 1989 AT&T
#         All Rights Reserved

#       THIS IS UNPUBLISHED PROPRIETARY SOURCE CODE OF AT&T
#       The copyright notice above does not evidence any
#       actual or intended publication of such source code.

#ident  "@(#)false.sh   1.6     93/01/11 SMI"   /* SVr4.0 1.3   */
exit 255 
```

取自 SunOS 5.9 aka Solaris 9 (/usr/bin/false)

* * *

## 回答 #355

> 赞同：4
> 
>             
> 
> 时间：2009-04-03T13:20:24.847

看到这个：

```
'On Error Goto Hell. 
```

* * *

## 回答 #356

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T22:25:58.280

```
/* logic */
#ifndef TRUE
# define TRUE 1
#endif /* TRUE */
#ifndef FALSE
# define FALSE 0
#endif /* FALSE */
#define EOF_OK TRUE
#define EOF_NOT_OK FALSE 
```

以及其他精彩的[mkenentry.c](http://www.ioccc.org/official/mkentry.c)在[IOCCC](http://www0.us.ioccc.org/main.html)页面上。每次阅读此来源时，我都无法继续大笑。

* * *

## 回答 #357

> 赞同：4
> 
>             
> 
> 时间：2008-10-10T01:56:19.807

```
// 在这里设置断点 - 你永远不会到达它

```

* * *

## 回答 #358

> 赞同：4
> 
>             
> 
> 时间：2008-10-13T05:29:08.037

```
//Not a bug, parameter position can change..., if you think this is wrong, you are in fact wrong. 
```

* * *

## 回答 #359

> 赞同：4
> 
>             
> 
> 时间：2009-04-03T15:56:28.123

伯克利数据库

```
/*
 * Chaos reigns within.
 * Reflect, repent, and reboot.
 * Order shall return.
 */
return (DB_RUNRECOVERY); 
```

* * *

## 回答 #360

> 赞同：4
> 
>             
> 
> 时间：2008-11-07T07:48:17.203

我没有直接遇到这个，但它是一个很好的故事（见我评论中的解释）：

```
#define MSGTAG_B33R     0x723 /* RIPLVB */ 
```

* * *

## 回答 #361

> 赞同：4
> 
>             
> 
> 时间：2009-04-20T15:13:41.347

```
/*
* After 36 hours, 2 holes in my wall and writing my code right beside the API
* this still doesn't work.
* function getMap():void takes in an event object @param: evt:mouseEvent
* I will now retire for the day with a bottle of rum and 2 hours of crying
*/ 
```

* * *

## 回答 #362

> 赞同：4
> 
>             
> 
> 时间：2009-04-20T15:16:41.450

直到最近，我一直在从事一个非常可爱的项目（是的，我承认，其中一些是我的，但我不会告诉你是哪一个）：

```
if(FAILED(hr))
{
    char fuck[256];
    sprintf(fuck, "GetBuffer() fucking fucked the fuck: %d", hr);
    MessageBoxA(0, fuck, fuck, MB_OK | MB_ICONERROR);
    return;
}

// This is for Chris, since he gets all hot and horny over "uint" instead of "unsigned int"
// ... or maybe he's just a lazy fuck. Who knows!?
using Ogre::uint; 
// movable texts, fucktory
MovableObjectTextFactory* m_pMovableObjectTextFactory;

// diarrhea... shitting CR from the string. complete run... 
```

他的意思是他用回车符分割字符串以分别渲染。

```
// unlock shit (duh, this comment is useless)
pixelBuffer->unlock();

// :HACK: remove me after demo is shipped
Of course, it's still in there ;)

// it's 4am and I can't think of a decent error message.
// my lead just fell asleep at his desk, so I can't ask him.
// [name] went home because he didn't want to get divorced.
// and so it's little ol' me, sitting here, comin up with an
// error message for something that should never ever happen.
ASSERT0(in_len == max_in, "http://www.youtube.com/watch?v=oHg5SJYRHA0"); 

// you want hungarian, you GET hungarian!
for(int fcknglpidxcntvrI = 0; fcknglpidxcntvrI &lt; len; fcknglpidxcntvrI++)

bool bKillSomethingAlive = false; // beating the dead horse instead 
```

当然，我们也有很多有趣的方式来表达“Hack”：

```
// HACKOMATIC 
// HMM... HACKXOR?
// HACK'O'ROONY
// AR; yeah I know it's HACKsoup
// HACK SHOT! DOMINATING!
// HACK'KIDO
// HACKku. sepukku. harakiri. kamikaze. ninja.
// HACK'o'NEIL
// HACKsaw 
```

* * *

## 回答 #363

> 赞同：4
> 
>             
> 
> 时间：2009-04-22T17:05:20.970

```
var something TBoolean; //Pickins 
```

* * *

## 回答 #364

> 赞同：4
> 
>             
> 
> 时间：2009-04-19T22:32:47.883

```
What do you think you're doing, Dave? 
```

* * *

## 回答 #365

> 赞同：4
> 
>             
> 
> 时间：2009-04-22T20:39:36.383

```
// All this code is yours, except gedit()...attempt no modifications there. 
```

* * *

## 回答 #366

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T19:56:08.713

```
/* Only break the connection if it actually exists. It is important to
 * check the timeslot saved in the SOURCE of the disconnect message. */ 
```

我写了这个评论，现在我不记得为什么它很重要......

* * *

## 回答 #367

> 赞同：4
> 
>             
> 
> 时间：2009-04-24T19:31:46.877

```
BEGIN.
// Here might be dragons
.
.
 IF...
 // Beware of the Jabberwocky
 .//user the force, luke
 .
 .
 ENDIF.
.
END. 
```

* * *

## 回答 #368

> 赞同：3
> 
>             
> 
> 时间：2009-04-19T19:53:50.340

```
private static final Logger lager = new Logger(); 
```

* * *

## 回答 #369

> 赞同：3
> 
>             
> 
> 时间：2009-04-19T20:27:44.610

```
/*
* Wirzenius wrote this portably, Torvalds fucked it up :-)
*/ 
```

* * *

## 回答 #370

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T21:31:24.693

```
If you have reached this part in the code, then this program sucks. 
```

* * *

## 回答 #371

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T21:52:15.757

```
// this is really complicated 
```

没有其他评论

* * *

## 回答 #372

> 赞同：3
> 
>             
> 
> 时间：2008-12-22T12:54:13.877

```
# let's pretend we are free, for a while 
```

在一堂课前发现了这个。接下来是（天真的）尝试实现 ORM。我还是不明白他为什么写这个。

* * *

## 回答 #373

> 赞同：3
> 
>             
> 
> 时间：2009-04-20T13:08:28.183

```
//ha, you thought I was lazy didnt ya?! 
```

* * *

## 回答 #374

> 赞同：3
> 
>             
> 
> 时间：2008-10-26T11:17:12.017

几年前，我在一个没有单元测试可言的大型代码库中工作。

代码深处有一种方法可以执行一些日历计算。它有点坏了，由于一些不幸的情况，不得不以一种非常笨拙的方式处理夏令时。

我们不得不修复它几次，每次，我们都会在几个月后发现有什么东西坏了。

在花了一整天的时间修复它并分析它之后，我将代码放入源代码管理中，并附上这样的评论：

```
// this code was written after a version trying to do {this} failed because of {reason},
// previously we were doing {this} which failed because of {reason}. This is 
// now written {this} way so that {lots of reasons here}. If you want to touch
// this code, please make sure that it produces the right answers when tested with:
//
// {some sort of unit test} 
```

最终，我的团队被外包了。有时候我想知道这段代码发生了什么:)

* * *

## 回答 #375

> 赞同：3
> 
>             
> 
> 时间：2009-03-18T11:16:24.917

```
//If the Current Record is Getting End Dated, We should not create New History Entry. 
//We Just need to Update the Previous History Entry
//If the History is already End Dated and the New Record is now removing End Date, Then 
//We should not update the Previous History End Date. 
//We Just need to Create the New History Record Only.
//Alright.. 
//Alright.... 
//Enough Comments. Code it. :-) 
```

* * *

## 回答 #376

> 赞同：3
> 
>             
> 
> 时间：2009-03-18T11:34:25.527

```
#define SHIT_HAPPENED (BASE + 1)   /* generic shit happened */ 
```

* * *

## 回答 #377

> 赞同：3
> 
>             
> 
> 时间：2009-04-20T12:45:08.990

```
// The freshest corpse at the back please.
m_DeadCharacters.push_back( std::make_pair(character, 0.0f) );
// Get rid of the rotting surplus
while( m_DeadCharacters.size() > 3 )
    m_DeadCharacters.pop_front(); 
```

* * *

## 回答 #378

> 赞同：3
> 
>             
> 
> 时间：2008-12-19T16:01:17.557

这是我们在前雇主购买的智能卡产品中发现的*唯一*评论。一堆由荷兰密码学博士编写的嵌入式 C 和汇编程序

```
// echt halmaal gek - no way! 
```

（这意味着像“真的完全愚蠢”......这也没有帮助我们）

* * *

## 回答 #379

> 赞同：3
> 
>             
> 
> 时间：2008-10-21T14:56:55.407

javascript函数的第一行：

```
// this part is more difficult 
```

怎么回事？

* * *

## 回答 #380

> 赞同：3
> 
>             
> 
> 时间：2008-10-12T07:29:27.110

Found in the main trigger code for transactions in an OLTP database:

```
-- This line negates the @inverseqty, which is the
-- negative of the @insertedquantity.  This works through the
-- magic of the trigger.  In fact, this code is a lot like
-- the bermuda triangle!
@negquantity = -1 * @inverseqty 
```

* * *

## 回答 #381

> 赞同：3
> 
>             
> 
> 时间：2009-04-06T11:33:15.687

```
//marco 2007.1.23
//I didn't do it 
```

* * *

## 回答 #382

> 赞同：3
> 
>             
> 
> 时间：2009-04-20T16:31:10.427

```
#define FUCK_VS6_CANT_COMPILE_TEMPLATES_WITHOUT_HANDHOLDING ((float*)0)

... 

SetPinsFromChannels`<float`>(&pinbuf, streambuf, &inmapper, FUCK_VS6_CANT_COMPILE_TEMPLATES_WITHOUT_HANDHOLDING); 
```

* * *

## 回答 #383

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T21:16:35.987

严格来说，这不是评论，但...

那是 1990 年代中期，我正在进行大规模迁移：小型软件供应商、**大**客户、巨大压力。我们有很多移动球门柱的东西。这个项目很难控制。我是主要开发人员，但对系统不熟悉，另一位开发人员是供应商的所有者/创始人。

在几个月没有完全确定最后期限并且不太让客户满意之后，所有者/创始人聘请了另一位远程工作的开发人员。（我会冒昧地说新开发人员的技能和经验比我少。）

好吧，新人对我已经处理过的代码进行了一些更改，然后一两个月后，我又回到了代码的同一区域，并且出现了我以前从未见过的变量。像`StupidMark`.

伙计，那是不对的。我的意思是，有团队合作的考虑，而且：在这种环境中，*变量名可以显示在运行时错误消息中。*我只是说。

在我当时看来，新人的代码并没有让我们更接近可交付的产品，这让侮辱更加刺痛了。

* * *

## 回答 #384

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T04:25:57.197

就在今晚，我们的团队发布了一个新版本的 CSS 文件，该文件从一个结构如下的文件中删除了注释：

```
@charset "UTF-8";
/* Who knew comments here could COMPLETELY ruin our page in Safari? */
body {
        /* Really important stuff here */
        /* Of course, comment or not, this will all get ignored by Safari because 
           its the first rule after the comments which break everything.
           see http://www.w3.org/International/questions/qa-css-charset for the exact details!
        */
} 
```

有趣的是在网上你会发现人们的解决方案是输入一个虚假元素作为字符集语句下方的第一条规则，以被忽略并正常进行......

深思：一个人把评论放在哪里不评论？

旁注：由于标题、元规则等，我知道这不应该是必需的。不幸的是，我们需要它作为一个包罗万象的:(

* * *

## 回答 #385

> 赞同：3
> 
>             
> 
> 时间：2009-03-05T18:57:16.750

```
try
{
...
}
catch(Exception ex)
{
//if this happens the world is going to end...
} 
```

现在猜猜发生了什么……

* * *

## 回答 #386

> 赞同：3
> 
>             
> 
> 时间：2009-04-19T12:57:12.777

```
On error resume next 'because nothing will ever go wrong! 
```

* * *

## 回答 #387

> 赞同：3
> 
>             
> 
> 时间：2008-12-08T01:40:37.317

我刚刚在 .net 的自定义 Linq 提供程序中找到了这个：

```
//select is a royal pain in the ass where 
//the parameter passed to CreateQuery isn't actually the one that goes in the call
//requiring this workaround.  Not sure how straight Linq to Objects does it. 
```

和这个

```
//expressions have to be compiled in order to work with the method call on 
//straight Enumerable somehow, LINQ to objects itself magically does this.  
//Reflector shows a mess, so I (Aaron) invented my own way.  God love unit tests! 
```

我也发现了这个……它变得更好了

```
 //ok, this is a hairy, dirty, and nasty piece of code
  //the alternatives are substantially worse than this though
  //i.e. when you do your own provider, LINQ assumes that
  //you are going to implement your own expression tree visitor and
  //do it all yourself.  Frankly, I still have xmas shopping to do
  //and I really don't want us to be foobared when we get
  //even more extension methods added to LINQ
  //therefore, we are pulling execute based on taking the calling the 
  //standard execute on enumerable, but using our own class
  //
  //optimization can occur from here on an as needed basis, that is
  //check for the value of mex.Method.Name, and write a handler for
  //that method
  //
  //also, it may not be a bad idea to rather than do this reflection 
  //each and every time somehow cache the reflected methodinfos and do 
  //lookups that way that said, we need a complete red/green/refactor 
  //cycle here before I am touching that one 
```

和这个

```
//Compile that mutherf-ker, invoke it, and get the resulting hash 
```

* * *

## 回答 #388

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T16:14:34.953

```
// good luck! 
```

* * *

## 回答 #389

> 赞同：3
> 
>             
> 
> 时间：2009-03-05T14:34:44.963

Something I saw in a .h file years ago.

```
// It may be a hack, but it works. 
```

* * *

## 回答 #390

> 赞同：3
> 
>             
> 
> 时间：2009-03-05T14:36:22.137

Something I saw in a COBOL program that paralyzed me with fear

```
* All comments pertain to the lines which follow. 
```

What does this mean?

1.  Someone was so uncomfortable with commenting that they had to write a meta-comment?

2.  Someone was in the habit of putting comments *below* the relevant code and had been told to put comments above?  How did that happen?

* * *

## 回答 #391

> 赞同：3
> 
>             
> 
> 时间：2009-03-05T17:41:16.607

对于一个项目，我们将 pwlib 作为依赖项，当时它的 FreeBSD 端口有点搞砸了，所以我不得不从源代码手动构建它。它没有立即解决，我不得不查看代码；有一些复杂的类层次结构，其中部分代码由宏生成，其父类声明以

```
// The root of all evil ... umm classes 
```

* * *

## 回答 #392

> 赞同：3
> 
>             
> 
> 时间：2009-03-05T18:06:52.457

对于我编写的 memcache 包装器/处理程序接口模式类，我实现了以下方法。

```
/**
*  Do not use, ever - left in place for testing purposes
*/
function  I_David_WillHuntYouDownAndHurtYou_Badly_IfIFindThisUsedAnyWhereInTheAppLibrary(){
...
} 
```

这基本上是一个超级核函数，告诉所有单独的内存缓存服务完全刷新自己，并从我用于键的各个名称空间计数器开始（例如 .{_counter_key value}_.{_counter_key value} ）

我写的另一篇小中篇小说是为一个数据供应商的自动下载器，详细描述了我是多么讨厌这个供应商，并竭尽全力假设他们的基础设施的批处理系统是由沙鼠运行的，在轮子上运行，经过这么多的革命轮子将启动下一个排队的任务。它是在 6 个月的时间里编写的，添加了额外的异常处理，像（如果我们有 768 字节的 \s 字符，这意味着对其数据库的查询超时，空格是空失败打印语句的结果。

* * *

## 回答 #393

> 赞同：3
> 
>             
> 
> 时间：2009-04-01T17:46:57.867

```
// Empty constructor to satisfy the stupid compiler
 Public ServletHandlerClass () { } 
```

* * *

## 回答 #394

> 赞同：3
> 
>             
> 
> 时间：2009-04-20T11:53:11.703

```
int main(void)
/* Program starts here */ 
```

* * *

## 回答 #395

> 赞同：3
> 
>             
> 
> 时间：2009-04-09T21:06:14.510

```
// haack, phil haack 
```

和：

```
/* hack, hack, hack, hack, hack hack, hack, hack
 * hackity hack, oh wonderful hacks
 * wonderful hacks, oh wonderful hack, hack, hack
 * hack hack hack... and spam 
 */ 
```

**编辑**：刚刚在我的一些代码中发现了这个（该项目希望保持匿名）：

```
// yikes, we need to:
/*
 *       o
 *      -|-     < US CROSSING PLATFORM
 *       |\ 
 ************************************************
 *       |          ^ PLATFORM           |
 *       |                           T   |
 *       |                      TROLL^   |
 */
// right now:
/*
 *   o ./_  | 
 *  -|-[]\  |  (_'_) () (\) | ) \|/ (S) < WALL
 *   |\     |    ^ FRIENDLY MESSAGE FROM YOUR FRIENDS AT MICROSOFT
 *  ***********************************************
 *        | ^PLATFORM                       |
 *      ^ SPRAY CAN (IN HAND)
 */
public static class DefaultFonts
{
    public static string SansSerifPath
    {
        get { return @"C:\Windows\Fonts\arial.ttf"; }
    }
    public static string SerifPath
    {
        get { return @"C:\Windows\Fonts\times.ttf"; }
    }
    public static string MonospacePath
    {
        get { return @"C:\Windows\Fonts\courier.ttf"; }
    }
} 
```

我多么喜欢双关语。

* * *

## 回答 #396

> 赞同：3
> 
>             
> 
> 时间：2009-04-20T10:02:27.587

```
//If only humans could leave things be.

//Please do not edit this code, 
//if you do you wont go to jail, you wont go directly to jail, 
//you wont pass go, you wont collect 200 dollars 
```

* * *

## 回答 #397

> 赞同：3
> 
>             
> 
> 时间：2009-04-20T12:18:34.093

当我在一个我被要求维护的项目中读到这篇文章时，我哭了。

```
//Write Code Here 
```

我仍然畏缩:)

* * *

## 回答 #398

> 赞同：2
> 
>             
> 
> 时间：2009-03-05T09:02:23.437

```
// Iced odnako
bool Iced{get;set;} 
```

* * *

## 回答 #399

> 赞同：2
> 
>             
> 
> 时间：2009-04-19T21:31:17.843

```
switch(value)
{
   [...]
default:
   ASSERT(**true**); // if this is triggered, something really bad is happening.
} 
```

* * *

## 回答 #400

> 赞同：2
> 
>             
> 
> 时间：2009-04-19T19:25:50.877

```
def leppard
# what, i cant have my own convention?
end 
```

* * *

## 回答 #401

> 赞同：2
> 
>             
> 
> 时间：2009-04-20T10:45:19.713

从 sendmail 配置文件。经过一页又一页的看起来像是简单的线路噪音。我找到了这颗宝石。

```
# insert this handy debugging line wherever you have problems
#R$*                $:$>99$1 
```

* * *

## 回答 #402

> 赞同：2
> 
>             
> 
> 时间：2009-02-02T12:06:14.887

```
-- Beyond this point, there'll be dragons 
```

I find it more pleasingly illustrative with the longer saying ^^

* * *

## 回答 #403

> 赞同：2
> 
>             
> 
> 时间：2009-04-20T04:36:28.400

[http://fxr.watson.org/fxr/source/pci/if_rl.c](http://fxr.watson.org/fxr/source/pci/if_rl.c)
是好的来源。

* * *

## 回答 #404

> 赞同：2
> 
>             
> 
> 时间：2009-04-20T04:51:21.407

```
//Please comment on your source code 
```

* * *

## 回答 #405

> 赞同：2
> 
>             
> 
> 时间：2008-10-09T16:22:53.147

在我们用于政府目的的企业级系统中发表评论

```
'RH 5/24/06 burn me if this dosn't work.. :) 
```

Good ole RH.....company Prez/Lead Developer

* * *

## 回答 #406

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T15:59:03.953

在 1983 年的一些 COBOL 中看到：

```
 C   I don't know what this next bit does so I'll jump around it
       GOTO DONE. 
```

* * *

## 回答 #407

> 赞同：2
> 
>             
> 
> 时间：2009-04-19T09:54:39.110

Best comment I ever saw was

```
/* 
  There is no accounting for pointers 
*/ 
```

* * *

## 回答 #408

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:09:58.540

```
Get This hack! 
```

在一行汇编代码上，在几页未注释的代码之后。

* * *

## 回答 #409

> 赞同：2
> 
>             
> 
> 时间：2009-04-24T08:20:15.460

我刚刚完成了一个日志框架（它使用 Trace，我不知道为什么不存在这样的东西）。我创建了一个继承自 TraceListener 的便利基类。它覆盖了所有 TraceListener 方法并将它们路由到一个方法中 - 所以这是很多文档评论：

```
// TODO: Need some codemonkey to doc comment this class. 
```

* * *

## 回答 #410

> 赞同：2
> 
>             
> 
> 时间：2009-04-20T07:47:08.330

```
/*
    FIXME:  why the fuck did anyone ever think this kind of expensive iteration
                    was a good idea? 
```

* * *

## 回答 #411

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T14:01:49.403

来自 Python/ceval.c：

```
/* This is gonna seem *real weird*, but if you put some other code between
   PyEval_EvalFrame() and PyEval_EvalCodeEx() you will need to adjust
   the test in the if statements in Misc/gdbinit (pystack and pystackv). */ 
```

* * *

## 回答 #412

> 赞同：2
> 
>             
> 
> 时间：2009-03-07T09:32:53.953

这是我今天在重构一些代码时发现的评论

```
if( year < 100 ): year += 2000 #lol, Y2K 
```

* * *

## 回答 #413

> 赞同：2
> 
>             
> 
> 时间：2008-10-22T06:31:23.633

在 SJ CA 的拍卖业务早期，我与一个名叫 Rick Dorin 的人一起工作。当你不得不整天戳卡片时，他会写回编译器。他的错误信息之一是

> 错误太多...减少！

* * *

## 回答 #414

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T10:49:10.593

```
// for 8 or 12 threads this does not affect much.
// Strange are the situations if not understood properly.
// Yoda strikes again 
```

在多线程模块中！:)

* * *

## 回答 #415

> 赞同：2
> 
>             
> 
> 时间：2009-03-15T12:15:00.673

Back around the time the Hitchhiker's Guide game was new, I had a case where I was testing whether something was scrollable and whether the user was trying to scroll, in a language that restricted variable length. So:

```
if (scroll and noScroll) # or tea and no tea 
```

* * *

## 回答 #416

> 赞同：2
> 
>             
> 
> 时间：2009-04-20T04:31:50.157

```
private int mousycounter = 0; //Not really a counter 
```

* * *

## 回答 #417

> 赞同：2
> 
>             
> 
> 时间：2009-04-20T05:24:56.457

```
//Do not continue reading if you dont want to die. 
```

这个差点要了我的命。

* * *

## 回答 #418

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T11:14:07.380

```
// simply copied from another code 
```

* * *

## 回答 #419

> 赞同：2
> 
>             
> 
> 时间：2009-04-20T00:52:54.647

我的热门歌曲汇编：

```
// Thats the end of the While loop
// Clean up last row.  I really must program better than this.

// Note: You can't immediately tell if the line below works.

// Rounding - blech.  It's assumed that all .5s are rounded up.

// Sort out predictions first.  Seems like the right place for a prediction, 'first'.

// Let's interpret! 
```

* * *

## 回答 #420

> 赞同：2
> 
>             
> 
> 时间：2009-04-20T02:05:05.017

在一些非常糟糕的 vb 代码中（我知道这很糟糕，但是）我在一个空的 if 控制块中发现了一个注释，上面写着：

```
If bFound Then
     'I love it when I write kick ass code like this
Else
  .
  . 
```

* * *

## 回答 #421

> 赞同：2
> 
>             
> 
> 时间：2008-12-22T08:11:35.320

来自 Joomla！资源：

```
// this is daggy?? 
```

* * *

## 回答 #422

> 赞同：2
> 
>             
> 
> 时间：2008-10-10T00:50:27.007

[Gosling 的 Emacs](http://en.wikipedia.org/wiki/Gosling_Emacs)源码中的 ascii-art 骷髅和交叉骨（这里很难重新创建）（警告他写的超热屏幕管理包不容易理解）。

* * *

## 回答 #423

> 赞同：2
> 
>             
> 
> 时间：2009-01-27T02:39:14.603

I just checked this in the other day...

```
/// <STERNLY-WORDED-WARNING>
/// Pay attention to this or I will hunt you down.
/// ...
/// </STERNLY-WORDED-WARNING> 
```

Where ("..." == "proprietary stuff that I can't post"). I just liked my STERNLY-WORDED-WARNING element.

* * *

## 回答 #424

> 赞同：2
> 
>             
> 
> 时间：2008-10-13T06:54:03.933

```
// Jay knows what's going on here, but will he remember in a year? Not very likely, this code sucks, but it works so do not change it. 
```

此评论发布在一个巨大的 while-if-for 块上方......哦，它操纵了一个对象数组的对象数组的对象数组的对象数组的字符串或数字，这取决于至少 3 个因素......（是的，我不得不调试这段代码并更改它，我写了评论，但是我没有写原始代码）。;)

* * *

## 回答 #425

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T00:33:29.520

> //下面的代码需要注释掉。

* * *

## 回答 #426

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T00:48:48.420

在 PeopleSoft Financials PeopleCode 的早期版本中：

```
/* I don't know how you can ever get here so I'll have to fix it later */ 
```

* * *

## 回答 #427

> 赞同：2
> 
>             
> 
> 时间：2009-02-05T11:59:08.533

一旦我发现这个：

```
// I wish (boss name) could do this by him self. 
```

* * *

## 回答 #428

> 赞同：2
> 
>             
> 
> 时间：2008-12-30T12:51:05.077

[Dennis M Ritchie 在这里](http://www.cs.bell-labs.com/who/dmr/odd.html)有一个关于一些古代 UNIX 评论的页面

* * *

## 回答 #429

> 赞同：2
> 
>             
> 
> 时间：2008-10-10T11:12:38.870

```
/*************************** Drag And Drop Section - Start (you should be me to mess with this section)*********************************************/ 
```

* * *

## 回答 #430

> 赞同：2
> 
>             
> 
> 时间：2009-03-26T23:12:03.593

来自旧的 netscape Mozilla 代码的[经典之作。](http://www.jwz.org/doc/censorzilla.html)我个人喜欢

> 就是不能乱搞。哦，无论如何，移动记忆也会毁灭我们，而且这一切都太他妈难以弄清楚了。所以，我放弃了，Mac 完全是一团糟

但还有很多其他有趣的。

* * *

## 回答 #431

> 赞同：2
> 
>             
> 
> 时间：2009-03-27T00:37:29.113

回到大学：

```
//why the f*** we have to move this here to make it work 
```

当我们与教授一起复习时，它在印刷资料中被突出显示。

原因：一些与缓冲区溢出相关的非常讨厌的错误，它影响了与代码其他位置的文件处理程序无关的变量。移动变量将使其再次工作。

* * *

## 回答 #432

> 赞同：2
> 
>             
> 
> 时间：2008-10-14T04:47:55.530

```
// No women, no children... What movie??? 
```

* * *

## 回答 #433

> 赞同：2
> 
>             
> 
> 时间：2009-03-26T16:39:10.777

刚刚在一些我必须更新的 Actionscript 中发现了这个...

```
/*
* spaghetty code in this module.
* hardcoded variables for load paths for the content window.
* Needs (vast) improvement.
*/ 
```

..伟大的 ：（

* * *

## 回答 #434

> 赞同：2
> 
>             
> 
> 时间：2009-04-07T14:57:00.620

```
// Keep prozac ready if things get ugly! 
```

* * *

## 回答 #435

> 赞同：2
> 
>             
> 
> 时间：2008-11-21T21:27:14.280

```
'""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
'
'  NOTE: DON'T SCREW WITH THIS CODE UNLESS YOU REALLY UNDERSTAND IT!
'
'"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""" 
```

* * *

## 回答 #436

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T10:48:41.293

```
// The hackiest hack that ever did hack 
```

它在[WordPress](http://wordpress.org/)博客引擎中（wp-admin/includes/user.php - 如果有人真的想看看这个 hacky hack 本身）。

* * *

## 回答 #437

> 赞同：2
> 
>             
> 
> 时间：2009-02-23T13:38:32.247

```
// barcore.cpp - MFC

//.....
HBRUSH CControlBar::OnCtlColor(CDC* pDC, CWnd* pWnd, UINT nCtlColor)
{
    LRESULT lResult;
    if (pWnd->SendChildNotifyLastMsg(&lResult))
        return (HBRUSH)lResult;     // eat it

//......

// Eat it - just like eat this. 
```

* * *

## 回答 #438

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T17:51:49.320

在一个艺术资产导出工具中，我偶然发现了一个从数字（阿拉伯）数字到罗马数字的完整翻译器。它看起来像这样：

```
/*
//You can tell I was bored
//I wanted to do this for a long time
char* ConvertToRoman(int number, int base)
{
... whole code here
}
*/ 
```

编写这段代码的团队已经工作了很长时间，我猜这影响了他们的理智。

* * *

## 回答 #439

> 赞同：2
> 
>             
> 
> 时间：2009-04-20T04:01:11.387

```
/* Jeez, this is an ugly mess */

...comment from the X11R6 internals source code circa 1991. 
```

* * *

## 回答 #440

> 赞同：2
> 
>             
> 
> 时间：2009-04-21T10:09:57.560

```
DataRow[] foundrows = FilterCalendarEntriesBecauseDotNETIsFuckedUp(tbtemp,CalDate); 
```

不是评论，而是一个有趣的函数名

* * *

## 回答 #441

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T09:26:20.167

我找到了这个

```
// This is a kind of magic... 
```

* * *

## 回答 #442

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T09:29:55.837

我经常发现这个

```
// fix it! 
```

* * *

## 回答 #443

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T09:53:14.377

```
// TODO: Delete 
```

* * *

## 回答 #444

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T10:25:41.677

在使用 Paradox 3.5 编写的大型预算系统工作多年后，我曾经接到客户的电话 -

“我们在调试时遇到了一些评论”-

```
// This shouldn't happen, if it does, then the bits that automagically 
// worked when I wrote it have stopped working 
```

……！

* * *

## 回答 #445

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T12:24:33.047

```
'Major changes: Everthing! - Removed all Cornoud's code ! 
```

* * *

## 回答 #446

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T12:27:47.703

发现了一个复杂的代码 -

//耶稣和这段代码有一个共同点：都复活了

* * *

## 回答 #447

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T15:00:31.907

```
// if the resultMap size is less than or equal to zero
// then the product is added
if (resultMap.size() <= 0) 
```

* * *

## 回答 #448

> 赞同：2
> 
>             
> 
> 时间：2009-04-22T17:14:32.677

```
%%return_median
hit_the_sweet_spot(Arg)->
.
. 
```

* * *

## 回答 #449

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T10:48:07.093

```
// now that's compact!
list->insert(list->end(),**pitch)->IdxOfSample=(pitch->pos-Offset)*SamplingRate; 
```

* * *

## 回答 #450

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T20:20:54.473

```
'I hate nested regions and will delete them along with any code found in them. 
```

* * *

## 回答 #451

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T23:38:13.797

在 Python 的模拟教程中可以看到以下代码。

```
# This is my rifle.
def rifle(type='hunting'):
    print('This is my (%s) rifle.' % type)

# This is my gun.
def gun(type='hand'):
    print('This is my (%s) gun.' % type)

# This is for fighting.
def fighting(type='illegal'):
    print('This is for (%s) fighting.' % type)

# This is for fun.
def fun(type='gaming'):
    print('This is for (%s) fun.' % type)
```

作者一定是全家福的粉丝。^_^

* * *

## 回答 #452

> 赞同：2
> 
>             
> 
> 时间：2009-04-25T04:23:46.783

```
// The following array may contain either TexturedObjects or ColoredObjects.
// I know, it sucks. 
```

* * *

## 回答 #453

> 赞同：1
> 
>             
> 
> 时间：2009-04-19T19:30:47.383

从 Linux 内核源代码：

linux/include/asm-i386/hw_irq.h：

```
/*
 * subtle. orig_eax is used by the signal code to distinct between
 * system calls and interrupted 'random user-space'. Thus we have
 * to put a negative value into orig_eax here. (the problem is that
 * both system calls and IRQs want to have small integer numbers in
 * orig_eax, and the syscall code has won the optimization conflict ;)
 *
 * Subtle as a pigs ear.  VY
 */ 
```

* * *

## 回答 #454

> 赞同：1
> 
>             
> 
> 时间：2009-04-19T19:52:21.670

```
double t = 0.0; /* that's generally my opinion of the diner, too. */ 
```

* * *

## 回答 #455

> 赞同：1
> 
>             
> 
> 时间：2009-03-29T13:16:23.140

```
// Sorry dirty code 
```

* * *

## 回答 #456

> 赞同：1
> 
>             
> 
> 时间：2009-01-30T16:35:16.780

我曾经使用 MS SQL Server Developer 2000（人工工作流的东西）实现了一些文档工作流。

它由一堆触发器组成，这些触发器将被添加到数据库中以使其遵循工作流规则。

在其中一个触发器中，微软的某个人写了一些类似的东西：

```
//Determine if the database has been "Grizzlified" 
```

（产品的内部名称是“Grizzly”，所以我觉得这很有趣）。

* * *

## 回答 #457

> 赞同：1
> 
>             
> 
> 时间：2009-04-19T21:08:30.910

```
$dnstime = time() + 60 * 60 * 24 * 7 * 2; //how long are you staying for vacation on mars? twooo weeeeeks. give dees people air 
```

* * *

## 回答 #458

> 赞同：1
> 
>             
> 
> 时间：2008-10-19T20:48:25.010

```
// GK Experimental 
```

（GK 是 coder 的首字母）

用于表示确实是实验性的代码部分。:)

一个很好的标志，知道当你在调试过程中点击它时，你可能会在接下来的几个小时内忙于修复黑客.. ;)

* * *

## 回答 #459

> 赞同：1
> 
>             
> 
> 时间：2008-10-27T16:26:32.940

我从事的一个大型项目在自动构建中使用了 StyleCop 和 FXCop，并使用规则来防止人们签入带有未注释字段、方法、属性等的代码。

**有人对必须将诸如“获取或设置全名”之类的注释添加到诸如****FullName**之类的自文档属性而感到非常生气，以至于他们努力编写宏来绕过规则。

该宏为方法、属性等插入了 XML 摘要标签，其中包含一个不显示的 Unicode 字符作为标签内容，这将愚弄构建规则，同时对他为了评论而盲目坚持评论内容进行了轻微的打击......

...至少在他们引入另一条规则来检查评论中的 Unicode 字符之前。

* * *

## 回答 #460

> 赞同：1
> 
>             
> 
> 时间：2009-04-20T04:44:40.157

在生成 HTML 的旧 perl 脚本中找到：

```
# I would be _very_ brain farting if I said this code didn't need reviewing.
# It will make babies cry, and hair grow on your back, so please don't use it 
```

* * *

## 回答 #461

> 赞同：1
> 
>             
> 
> 时间：2009-04-20T04:49:37.400

**从/System/Library/Frameworks/AppKit.framework/Versions/C/Headers/NSTextView.h：**

```
- (void)smartInsertForString:(NSString *)pasteString replacingRange:(NSRange)charRangeToReplace beforeString:(NSString **)beforeString afterString:(NSString **)afterString;
- (NSString *)smartInsertBeforeStringForString:(NSString *)pasteString replacingRange:(NSRange)charRangeToReplace;
- (NSString *)smartInsertAfterStringForString:(NSString *)pasteString replacingRange:(NSRange)charRangeToReplace;

/* Java note: The second and third methods are the primitives and are the 
methods exposed in Java.  The first method calls the other two.  All 
Objective-C code calls the first method.  In either Objective-C or Java any 
overriding should be done for the second and third methods, not the first 
method.  This will all work out correctly with the exception of existing code 
that overrides the first method.  Existing subclasses that do this will not 
have their implementations available to Java developers. Isn't Java wonderful? */ 
```

* * *

## 回答 #462

> 赞同：1
> 
>             
> 
> 时间：2009-04-06T10:29:47.930

```
else
{
    //error situation
} 
```

* * *

## 回答 #463

> 赞同：1
> 
>             
> 
> 时间：2009-04-20T20:13:54.357

来自[http://www.madore.org/~david/computers/callcc.html](http://www.madore.org/~david/computers/callcc.html)：

```
/* Yow!  DEMONS are flying through my NOSE! */ 
```

* * *

## 回答 #464

> 赞同：1
> 
>             
> 
> 时间：2008-10-19T07:08:10.687

```
Fix problem where Nulls don't work properly.  Stupid Microsoft! 
```

代码以迂回的方式逐行将 Null 转换为零长度字符串，因为愚蠢的程序员不了解 Null 是什么，也从未听说过 Nz() 函数。

* * *

## 回答 #465

> 赞同：1
> 
>             
> 
> 时间：2008-10-10T12:35:47.553

```
try {
  dataSource.close();
}
catch (SQLException ex) {
  // Do nothing, since we're going to trash this anyway
} 
```

当然，这种事情实际上是 JDBC（或至少是 Oracle 的 JDBC 驱动程序）中的一个 wtf，因为它可以在关闭连接时抛出 SQLExceptions ......

* * *

## 回答 #466

> 赞同：1
> 
>             
> 
> 时间：2008-12-10T00:08:03.680

单元顶部附近：

```
// Oh what a tangled web we weave
// When first we practice to deceive
// ASTA 
```

* * *

## 回答 #467

> 赞同：1
> 
>             
> 
> 时间：2008-10-10T15:55:26.450

今天早上我遇到的 VB.NET 中的一个不错的，笑了...

```
''' <summary>
''' Represents an exception that was logged.  Since System.Exception implements IDictionary, it can't be
''' serialized, so I had to write this.  Pretty fucking stupid thing to have to do, System.Exception should
''' be serializable right out of the box, IMHO.
''' </summary>
''' <remarks></remarks>
Public Class LogException 
```

* * *

## 回答 #468

> 赞同：1
> 
>             
> 
> 时间：2008-10-27T15:24:21.487

I've just placed this comment:

```
// this control (Resistance) is FUTILE! 
```

* * *

## 回答 #469

> 赞同：1
> 
>             
> 
> 时间：2009-02-14T19:29:59.117

```
'this next if statement - just how it is. don't try to understand it because you won't. :) 
```

这就是工作保障。

* * *

## 回答 #470

> 赞同：1
> 
>             
> 
> 时间：2009-03-18T11:38:32.773

在 eMule 的 Preferences.cpp 中，强制最小上传速度限制与您的下载速度限制成正比：

```
uint16 CPreferences::GetMaxDownload(){
//dont be a Lam3r :)
    uint16 maxup=(GetMaxUpload()==UNLIMITED)?GetMaxGraphUploadRate():GetMaxUpload();
    if( maxup < 4 )
        return (( (maxup < 10) && (maxup*3 < prefs->maxdownload) )? maxup*3 : prefs->maxdownload);
    return (( (maxup < 10) && (maxup*4 < prefs->maxdownload) )? maxup*4 : prefs->maxdownload);
} 
```

* * *

## 回答 #471

> 赞同：1
> 
>             
> 
> 时间：2009-04-15T05:12:37.890

这是我在不同时间放入代码中的一些内容。有些不是技术上的评论，但它们是同一种概念。

在一个跨平台项目中，只需要一个平台上的一些特殊代码：

```
//If defined, will include all the Windows-specific code.
#define LOSE

#ifdef LOSE
#include <windows.h> //WIN32\. Duh.
#endif

---------------------------------------------------

//Stolen from other_project_name.cpp

---------------------------------------------------

/*
 * These comments have been lifted from propagate() and, though they no longer apply to the code, they may still be of value somewhere. Original tabbing and structural elements have been preserved.
 */
    //CAUTION: This has a major Bobby Tables risk. Even if a rulebuilder is used, there's still the risk of something getting corrupted in the database itself.
    //Reading text from anywhere and simply slotting it into an SQL statement is a major security risk. (With thanks to xkcd for the name "Bobby Tables".)
    //Requirement: Eliminate one Bobby Tables by changing [redacted] to be not just straight SQL.
[lots more comments that are not as funny]
/*
 * End of lifted comments. There should not be any executable code between these markers.
 */

---------------------------------------------------

        /*
        Okay. It's unrecognized. Why is this a fatal error? It's actually very closely akin to the miswart of botched #includes being a fatal. When writing a C/C++
        program, you need your headers, and if you don't have one, chances are there'll be a million cascaded errors; so by making "unable to open asdf.h" a fatal,
        the compiler suppresses all those errors about undefined symbols and potentially misspelled type names.
        */

---------------------------------------------------

    //If someone tries to import 'id' as a field name, it won't work. (We already have our own id.) But I think the probability is so low that I can afford to be funny.
    if (!stricmp(ptr,"id")) {warn(0,"Import","","'id' is a reserved word and cannot be used as a column name. (Try 'ego' or 'superego'.)"); return;}

---------------------------------------------------

//Need a place to squirrel away SQL statements somewhere
char *uts[1024]; //Unified Temporary Storage. (Why? Because I said so.)
int nuts=0; //What is it that squirrels keep? Ha!
int utsid[sizeof uts/sizeof *uts];

---------------------------------------------------

        /**************************************\
         * NOTE: This sets tilde.action. If a *
         * tilde header does not exist in the *
         * import file (not the _content_, if *
         * the entire column isn't there), it *
         * will duplicate down through all of *
         * the rows. This is fine for ~id, as *
         * that will never be changed; and if *
         * ~Quantity is blank, that throws an *
         * error in 'Add'. With ~Action, I am *
         * not so certain. I THINK it'd be OK *
         * to dup-down most of the time... if *
         * the user only ever imports Adds or *
         * Revises, but never both at once in *
         * a single import. So for safety, to *
         * allow a blank ~Action to revise OR *
         * add, I'm breaking the check out to *
         * a new variable - the curaction. In *
         * most cases, it won't be needed, so *
         * it's a waste; but it isn't like it *
         * has to copy the entire tilde.*, so *
         * it's only a small waste. So it can *
         * waste a register... big deal. OK ! *
        \**************************************/

---------------------------------------------------

            //if (!response) // we're going to crash
            //if (!items) // we're going to crash
            //TODO: Don't crash

--------------------------------------------------- 
```

我的很多评论都包含对电影或音乐剧的晦涩参考，但如果你不了解这个节目，它们就不会那么有趣了。

* * *

## 回答 #472

> 赞同：1
> 
>             
> 
> 时间：2009-04-19T19:07:13.307

我没有源的副本，但我一直记得它：

// 如果你不明白，你不应该读这个

* * *

## 回答 #473

> 赞同：1
> 
>             
> 
> 时间：2009-04-06T11:04:47.003

```
#pragma region Crap that is kept for temporary reasons

    //  Huge chunk of commented code

#pragma endregion 
```

* * *

## 回答 #474

> 赞同：1
> 
>             
> 
> 时间：2008-12-19T16:48:24.717

> `// Description : !!! TODO`

* * *

## 回答 #475

> 赞同：1
> 
>             
> 
> 时间：2008-12-22T08:06:48.387

来自 Joomla！资源：

```
// fudge the group stuff 
```

* * *

## 回答 #476

> 赞同：1
> 
>             
> 
> 时间：2008-10-10T16:29:25.273

我只是注意到自己在写这个

```
// not brilliant solution, but fair enough heh. 
```

* * *

## 回答 #477

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T01:15:41.003

曾经有一位为我工作的程序员在他的代码中加入了“风格”注释，他在其中编纂了关于特定实现细节的内部辩论，并在他对特定编码决策被否决时采取了分镜。

例子：

'STYLE' 哪个更好是有争议的，但我传递图像句柄而不是简单地传递缩放值以保持调用代码更简单（通过一对声明语句）。或者，我可以直接从调用代码中传递这些数据成员，但这会违反封装。

'STYLE' 就像我在其他地方所做的那样，我将**注册我的正式抗议**（只需给我填写的表格）关于注释序列化的实现作为一个属性而不是一对加载/保存方法。再一次，这可能是一个“风格问题，非常值得商榷”。

* * *

## 回答 #478

> 赞同：1
> 
>             
> 
> 时间：2008-10-13T14:59:48.727

消毒：

```
//Forward declarations:

class X {}; // TODO: Remove {}  ! When we get X defined.... 
```

* * *

## 回答 #479

> 赞同：1
> 
>             
> 
> 时间：2008-12-19T16:55:52.330

拉丁文，`Abandon hope all ye who enter here`来自但丁的《神曲》。  

* * *

## 回答 #480

> 赞同：1
> 
>             
> 
> 时间：2009-02-05T10:51:05.677

最近在我们的代码中发现了这一点（我们开发企业软件）：

```
// Instance of excel
Excel excel = this.CreateExcelInstance();
excel.Open(stream); // how to close it?! 
```

在那之前，我确信我们已经摆脱了这些“有趣的东西”，而且我们正在以正确和意识形态正确的方式来做这件事……

* * *

## 回答 #481

> 赞同：1
> 
>             
> 
> 时间：2009-04-03T13:20:15.003

我们有一个文件，其中一半的程序员试图理解混乱，设法将所有无意义的代码移到底部，并留下如下评论：

```
I have no idea what this stuff does below here. 
```

另一位程序员留下了一系列嵌套的命名空间，这些命名空间的作用就像一本方向书，这样您就可以深入到想法中的命名空间并选择您的操作。

* * *

## 回答 #482

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T02:15:04.157

```
//Maybe you should make anyone knows your code's purpose. 
```

* * *

## 回答 #483

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T22:41:36.673

这里有 4 个，不分先后：

```
// Father, forgive me, for I am sinning

// heaven help me

// horse string-length into correctitude 
(from a textbook)

// what, me worry? 
```

* * *

## 回答 #484

> 赞同：1
> 
>             
> 
> 时间：2009-04-21T08:46:03.453

```
// repopulate, slight hax (or strong assumptions :P) below 
```

* * *

## 回答 #485

> 赞同：1
> 
>             
> 
> 时间：2009-04-06T15:15:44.950

当我注释掉我认为不再有用的代码块时*，*但我可能错了（因此不删除它们）我有时会在它们前面加上

```
// Wilted celery? 
```

想法是这就像芹菜枯萎了，但无论如何你还是把它放回冰箱。我只知道10年后其他人会发现这些评论并说WTF？

* * *

## 回答 #486

> 赞同：1
> 
>             
> 
> 时间：2008-10-10T11:13:41.427

```
if(count<0) count=0;    //don't get me wrong but this has to be done :p 
```

* * *

## 回答 #487

> 赞同：1
> 
>             
> 
> 时间：2009-02-03T19:35:49.630

```
// StupidCompilerDontInline(SCDI), in the test project where
// allcode was in a single cpp the compiler had inlined nearly
// everything which lead to nice stackoverflow.
// To prevent this the metods are made virtual
#define SCDI virtual 
```

* * *

## 回答 #488

> 赞同：1
> 
>             
> 
> 时间：2008-10-12T12:30:02.213

我继承了一个在没有任何 UAT 的情况下交付给客户的项目。它被踢过栅栏和要求的钱。

第一次用，自然就炸了。它是一个插入库，它覆盖了任何将文件名作为参数而不是文件描述符的系统调用。

许多系统调用已被遗忘。

当我上船时，代码中充满了这样的宝石：

```
/* core dumps around here but this is hardly ever called */ 
```

和

```
/* don't know why this works but it seeems to be ok */ 
```

哦，没有单元测试。一位同事已经开始添加缺少的系统调用和单元测试。

而且写代码的混蛋还在团队里，根本不在乎已经送来的垃圾！

* * *

## 回答 #489

> 赞同：1
> 
>             
> 
> 时间：2008-12-18T23:00:30.337

在 1980 年代初期的某个时候，我们正在为 PL/I 中的公用事业编写财务建模代码。接到客户的电话，评论后代码立即爆炸

```
/* Honest this works */ 
```

这家伙使用了我们的标准金融方程组，并做了大约 15 页的代数，将一堆代码组合成一个方程。在三英里岛之后，当公用事业公司不得不以巨额成本注销他们的核电站时，由于 FIXED BIN 15（整数）溢出，如果没有发生代数就不会发生这种等式失败。

* * *

## 回答 #490

> 赞同：1
> 
>             
> 
> 时间：2009-04-28T08:04:01.083

在编写 MAPPER 应用程序时，我们有*一些*标准，其中之一是在整个套件中使用的标准变量列表。其中之一——“V43”总是用来表示姓氏。所以想象一下，当我被要求修复的一大段神秘的 MAPPER 代码中*唯一的评论是：*

```
Here V43 contains the Surname 
```

* * *

## 回答 #491

> 赞同：1
> 
>             
> 
> 时间：2008-12-18T19:30:20.213

```
/* Hammer Time! */ 
```

我不知道他在写代码时为什么或是否穿着防撕裂尼龙降落伞裤

* * *

## 回答 #492

> 赞同：1
> 
>             
> 
> 时间：2009-04-27T19:14:58.450

```
TextBox1.Text = TextBox1.Text; //Point less yes, who writes this crap? 
```

* * *

## 回答 #493

> 赞同：1
> 
>             
> 
> 时间：2009-04-09T21:49:04.970

```
map(TimeZoneId.Romance, "Romance Standard Time"); //LULZ. 
```

* * *

## 回答 #494

> 赞同：1
> 
>             
> 
> 时间：2009-04-09T21:54:34.630

```
// This interface defines method signatures<br>
interface IWhatever { ... } 
```

* * *

## 回答 #495

> 赞同：1
> 
>             
> 
> 时间：2009-04-15T19:52:03.873

```
/* Look not upon this file lest your eyes be burnt from your head. */ 
```

我能说什么？我是实习生，暑假快结束了。容我们说，我对我的文件责任缺乏认真的承诺。

* * *

## 回答 #496

> 赞同：1
> 
>             
> 
> 时间：2009-04-21T09:42:56.780

```
//this is a crap way to do this but I ran out of patience

DelButton.click(); 
```

* * *

## 回答 #497

> 赞同：1
> 
>             
> 
> 时间：2009-04-21T12:53:17.353

```
/**
 * Hexadecimal digit
 */
protected $version = -1; 
```

* * *

## 回答 #498

> 赞同：1
> 
>             
> 
> 时间：2009-04-22T13:39:33.990

```
// Holy moses! I've never seen anything so ridiculous in all my life. 

// Why do we need to query the AlarmIDs table twice.

// Please tell me sir; I would really like to know. 

// This like all the other services have been mangled

// to the point where they are nearly impossible to determine what kind of side affects might occur.

// I am making the smallest changes I can to this code. 

// The GetAlarmId method gets the alarm id from the AlarmIDs table.

// Novel idea, why didn't we query for the values be get below all in the same place.

// This should be changed, but right now it will have to remain as is due to time constraints.

// This like all other services really don't do anything fantastically hard, but after the original coders got

// done with them; they are difficult to work with and have an acceptable comfort level. 
```

* * *

## 回答 #499

> 赞同：1
> 
>             
> 
> 时间：2009-04-22T18:44:46.893

首先在一个大对象的更新开始时：

```
/*General note to all who tread in the <ObjectName>() code...
 * The SetOriginals() method from the BaseEntity class should be called (and only called) right after the Get() method
 * call as seen above.  Calling the SetOriginals method elsewhere will result in bugs and all kinds of other nasty suprises.
 */ 
```

然后经过大约 200 行逻辑来更新对象：

```
//Attempt to explain this confusing mess of code:
//First time you save an actual absence this is what happens:
//0\. The first save saves to the <TableName> table (among other things). (Fig. A)
//1\. The <CalculationMethod> method is called next which inserts to the <OtherTableName> table. 
//(This is the table that keeps track of credits to the case.) (Fig. B)
//2\. So then you have to call <UpdateCalculations> to move the <TableName> records to the <ThirdTableName> table. (Fig. C)
//3\. Then you go back and run calculations since you have the debits table (<ThirdTableName>) populated. (Fig D.)
//4\. Then a final save to save the calculations back to the case. (Fig. E)
//Yeah, I know what you're thinking:  this sucks. 10/01/07 XXX 
```

开发人员是对的……这太难了！

* * *

## 回答 #500

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T12:11:11.557

```
[vrk:Cloud ID="cTags" runat="server" DataTextField="Tag" DataWeightField="Total"
    Width="100%" DataHrefField="Tag" DataHrefFormatString="~/tags.aspx?tag={0}"]
[/vrk:Cloud]

[!--if anybody would like to change the control's color contact with FLORJON--] 
```

* * *

## 回答 #501

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T19:21:14.443

我真的几乎比评论更喜欢 oh_my_gawd 标签...

```
    /*
     * IOC3 被操得令人难以置信......甚至不要给
     * 通用 PCI 代码有机会真正查看它...
     */
    if (cf == (PCI_VENDOR_ID_SGI | (PCI_DEVICE_ID_SGI_IOC3 b_type0_cfg_dev[slot].f[fn].c[其中 ^ (4 - size)];

    如果（大小 == 1）
        res = get_dbe(*value, (u8 *) addr);
    否则如果（大小 == 2）
        res = get_dbe(*value, (u16 *) addr);
    别的
        res = get_dbe(*value, (u32 *) addr);

    返回资源？PCIBIOS_DEVICE_NOT_FOUND：PCIBIOS_SUCCESSFUL；

oh_my_gawd：

    /*
     * IOC3 被操得令人难以置信......甚至不要给
     * 通用 PCI 代码有机会查看错误的寄存器。
     */
    如果（（哪里> = 0x14 &&哪里= 0x48））{
        *值 = 0;
        返回 PCIBIOS_SUCCESSFUL；
    }

```

* * *

## 回答 #502

> 赞同：1
> 
>             
> 
> 时间：2009-04-25T02:23:20.817

从技术上讲不是评论，而是在凌晨 2 点左右对某事进行编码：

```
consent = False 
```

...该变量永远不会再次使用，并且出现在套接字的侦听循环的开头。

* * *

## 回答 #503

> 赞同：0
> 
>             
> 
> 时间：2009-04-20T19:39:26.607

写得很好的 Lisp 是最容易阅读的语言之一，我喜欢它。但是写得不好的 Lisp 可能是一场噩梦，比糟糕的 Java 等糟糕得多。

在这里，如果存在以 a、b 和 c 后缀命名的原始文件的 3 个变体，我们需要创建一个“组文件”。我一直在试图找出一个奇怪的错误，我们得到了不必要的组文件......

```
 (let ((varianta (format nil "~aa" problem))
        (variantb (format nil "~ab" problem))
        (variantc (format nil "~ac" problem)))
    ;;if the A and B variants exist, create a group file
    ;;(why not just check for a? I don't know, this just feels right)
    (when (and (probe-file varianta)
               (probe-file variantb))
      ...))) 
```

*错误：1，肠道：0。*

显然，写这篇文章的人并没有想到检查所有三个变体可能是一个好主意。当然，这是我在最初编写这段代码十年后最终追踪到的错误（它早于第一个 SVN 日志）。

* * *

## 回答 #504

> 赞同：0
> 
>             
> 
> 时间：2009-04-22T15:27:15.777

重新吃自己的狗粮：我们的工作场所有相同的术语（当然，只是因为我介绍了它）。我的代码中充斥着“TODO”的注释，并指出最终应该完成的事情，但是“DOGFOOD”的注释（两个关键字总是在注释的开头，全部大写）意味着必须完成的事情在这个程序甚至可以在内部使用之前。搜索起来很方便，因为“dogfood”这个词永远不会出现在带引号的字符串中——如果出现了，我总是可以说“dog-food”之类的——所以即使是不区分大小写的搜索也会出现得到正确的结果。

关于将累加器归零：在对 Intel 80x86 进行编程时，我做了完全相同的事情（我从 8086 开始，然后从那里升级到现代 Pentium）。将寄存器与自身进行异或是清除它的最快和最严格的方法。使用“MOV AX,0”需要三个字节（操作码和两个字节的文字 16 位零），而“XOR AX,AX”只有两个；对于 386 及更高的扩展寄存器，这一点更加明显，其中“MOV EAX,0”需要五个字节（四个字节的 32 位零）。我的 C/C++ 编译器总是以这种方式将寄存器归零，所以我认为它仍然是最好的方式（尽管我已经很久没有研究过操作码时序表了，并且可能 XOR reg,reg 和 MOV reg,imm 都需要一个时钟） .

* * *

## 回答 #505

> 赞同：0
> 
>             
> 
> 时间：2009-02-02T12:10:25.020

```
// long live COM'n'Roll
public enum StatusCode
{
        //success codes
        S_OK                                            = 1,
        S_NONE                                          = 2,
        S_SQL_OPERATIONS_LISTS_EMPTY                    = 3,

        //error codes
        E_NO_MATCHING_END_FOUND                         = -1,
        E_SEQUENCE_NUMBER_NOT_FOUND_AT_BEGINNING        = -2,
        E_SEQUENCE_NUMBER_NOT_FOUND_AT_END              = -3,
        E_FORWARD_AND_BACKWARD_OPS_COUNT_DO_NOT_MATCH   = -4,
        E_FORWARD_AND_BACKWARD_IDS_DO_NOT_MATCH         = -5,
        E_IDS_DO_NOT_MATCH                              = -6
} 
```

* * *

## 回答 #506

> 赞同：0
> 
>             
> 
> 时间：2009-04-06T09:58:03.217

```
// Hack-er-ama 
```

* * *

## 回答 #507

> 赞同：0
> 
>             
> 
> 时间：2009-04-21T02:06:02.713

我看到的一些旧的fortran代码：

```
 integer *4 one,two,three;

c    asssign one to 100 before entering the loop
     one=100; 
```

* * *

## 回答 #508

> 赞同：0
> 
>             
> 
> 时间：2009-04-19T10:45:54.557

```
<cftry>
...code...
<cfcatch>
  <!--- Gobble --->
</cfcatch>
<cftry> 
```

It's all over my companies code base. It's ColdFusion and it simply ignores errors.

* * *

## 回答 #509

> 赞同：0
> 
>             
> 
> 时间：2008-12-20T18:03:45.907

```
REM Don't delete this print statement ****** will die 
```

有问题的过程是某些遗留代码中的服务

* * *

## 回答 #510

> 赞同：0
> 
>             
> 
> 时间：2009-03-24T06:57:43.200

Mine fave was a variable name inside some of the business logic of a school project written in java.

```
int StupidJava = -1; 
```

* * *

## 回答 #511

> 赞同：0
> 
>             
> 
> 时间：2008-10-11T13:23:21.200

```
[onload_1;block=begin;when 1=0]

Some of the techinques in this template are rather obscure, just trust me, they need to be there.
OTOH a better sollution would be to create a few seperate templates and pick one in the php-script...

[onload_1;block=end] 
```

* * *

## 回答 #512

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T22:53:55.713

```
(A bunch of code that's really weird looking)  //Kludge. 
```

* * *

## 回答 #513

> 赞同：0
> 
>             
> 
> 时间：2008-10-14T06:13:09.243

这是来自一个旧的 IOCCC 获奖条目，我必须下载整个获奖者档案 - 一个巨大的 1.4 M - 并且在找到之前我记得错误的几个短语。

从语法上讲，这可能不是评论。或者可能是这样。我还没弄清楚。它绝对没有注释分隔符，但也没有字符串分隔符。

```
C="Lint says "argument Manual isn't used."  What's that
mean?"; 
```

猜测 lint 的输出没有价格。

对于好奇的人，该条目就[在这里](http://www0.us.ioccc.org/1985/sicherman.c)。

* * *

## 回答 #514

> 赞同：0
> 
>             
> 
> 时间：2009-04-09T20:56:51.693

```
// now swap like a <explicative removed> 
```

* * *

## 回答 #515

> 赞同：0
> 
>             
> 
> 时间：2009-03-05T18:16:25.587

```
// Oh crap, i think i'm gonna yack 
```

紧随其后的是：

```
// TODO: end this lunacy 
```

* * *

## 回答 #516

> 赞同：0
> 
>             
> 
> 时间：2009-04-16T15:12:55.963

我刚刚在一些遗留代码中发现了这一点..  

```
'CANNOT JUST QUIT! 
```

* * *

## 回答 #517

> 赞同：0
> 
>             
> 
> 时间：2009-04-22T19:49:19.297

我在 Access 中做一个数据库，非常简单的事情 - 至少它应该在一开始或者我会在 Delphi 中完成。客户希望能够从数据库中获取客户信息，但他们不会输入足够的信息来可靠地识别客户。我告诉他们使用电话号码作为密钥，因为每个客户（他们的工作方式，不是每个人）都有不同的号码。在他们打了几个疯狂的电话后，（它不起作用，我们无法输入客户）我发现他们懒得从他们的旧系统中查找电话号码，并试图输入他们不知道的所有号码“不适用”。在试图为他们解决这个问题时，我最终在代码中检查了很多循环，并在一个结果旁边添加了注释“

他们还问我一次“即使我们输入了错误的地址，我们如何才能找到合适的客户？” 一切都是为了花生。

* * *

## 回答 #518

> 赞同：0
> 
>             
> 
> 时间：2009-04-22T21:30:13.233

回顾类的旧代码很有趣......

```
 cardDeck.push_back(*(new card((rank)r, (suit)s)));  // Push each card onto the deck
                                                        // Temp. objects are overrated 
```

在经历一些事情时，这让我希望我在凌晨 4 点在破解随机代码时留下更多评论......

# mysql - 在mysql中连接任意数量的字符串行（分层查询）

> ID：184641
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-08T20:11:16.803
> 
>         
> 
> 标签：mysql, string, tree, directory, concat

我有一个带有专辑的 mysql 表。每个相册可以是顶级相册，也可以是另一个相册的子相册。每个相册都有一个文件夹名称，它是其图片所在文件夹的名称。每个相册还有一个名为 parent 的字段，它是父相册的 id。所以，如果我有这样的图像路径：

```
root/album1/album2/image1.jpg 
```

那么数据库中的专辑表将如下所示：

```
id parent foldername
1  NULL   root
2  1      album1
3  2      album2 
```

那么问题来了，如何仅使用 mysql 从该表中获取先前打印的路径？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-10-08T23:16:34.310

我不确定在数据库中存储一棵树是个好主意......

为了让您的问题保持简单，也许只需将专辑的完整路径存储在表格的一列中......

```
id parent path           foldername
1  NULL   /              root
2  1      /root/         album1
3  2      /root/album1/  album2 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-08-29T07:42:54.253

DB2、SQL Server、PostgreSQL 和 Oracle 都支持通用表表达式 (CTE)，可以使用它来完成此操作。Oracle 还具有“CONNECT BY”关键字。

我知道这不能解决您的问题，但也许它会帮助其他人寻找 MySQL 以外的解决方案。

在您的情况下，出于性能考虑，我建议将完整路径存储在列中 - 插入/更新时对非规范化数据的管理可能会在读取性能方面获得多次回报。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T22:56:30.823

完全未经测试并在我的头顶上打字......

```
DECLARE @FOLDER VARCHAR(200)
DECLARE @TOPID AS INT
DECLARE @MYID As int

CREATE TABLE #tmp
(
    [id] INT,
    [path] VARCHAR(50)
)

DECLARE tempCursor CURSOR FOR SELECT id FROM albums ORDER BY id
OPEN tempCursor

FETCH NEXT FROM tempCursor INTO @TOPID

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @FOLDER = ''
    SET @MYID = @TOPID

    WHILE @MYID is not null
    BEGIN
        SELECT @MYFOLDER = foldername FROM albums WHERE id = @MYID
        SET @FOLDER = @MYFOLDER + '/' + @FOLDER
        SELECT @MYID = parent FROM albums WHERE id = @MYID
    END

    INSERT INTO #tmp
    SELECT @TOPID, @FOLDER

    FETCH NEXT FROM tempCursor INTO @TOPID
END
CLOSE tempCursor
DEALLOCATE tempCursor

SELECT * FROM #tmp
DROP TABLE #tmp 
```

这至少应该让您了解如何获取路径名称。您从未指定文件名的存储位置。

顺便说一句，这会很慢。我讨厌使用游标...

# python - 复制列表的最佳方法是什么？

> ID：184643
> 
>         
> 
> 赞同：64
> 
>         
> 
> 时间：2008-10-08T20:11:22.280
> 
>         
> 
> 标签：python

复制列表的最佳方法是什么？我知道以下几种方法，哪一种更好？还是有其他方法？

```
lst = ['one', 2, 3]

lst1 = list(lst)

lst2 = lst[:]

import copy
lst3 = copy.copy(lst) 
```

* * *

## 回答 #1

> 赞同：104
> 
>             
> 
> 时间：2008-10-08T20:14:50.340

如果您想要浅拷贝（不复制元素），请使用：

```
lst2=lst1[:] 
```

如果要进行深层复制，请使用复制模块：

```
import copy
lst2=copy.deepcopy(lst1) 
```

* * *

## 回答 #2

> 赞同：23
> 
>             
> 
> 时间：2008-10-08T20:18:55.573

我经常使用：

```
lst2 = lst1 * 1 
```

如果 lst1 它包含其他容器（如其他列表），您应该使用复制库中的 deepcopy，如 Mark 所示。

* * *

更新：解释深拷贝

```
>>> a = range(5)
>>> b = a*1
>>> a,b
([0, 1, 2, 3, 4], [0, 1, 2, 3, 4])
>>> a[2] = 55 
>>> a,b
([0, 1, 55, 3, 4], [0, 1, 2, 3, 4]) 
```

正如您可能看到的只有更改...我现在将尝试使用列表列表

```
>>> 
>>> a = [range(i,i+3) for i in range(3)]
>>> a
[[0, 1, 2], [1, 2, 3], [2, 3, 4]]
>>> b = a*1
>>> a,b
([[0, 1, 2], [1, 2, 3], [2, 3, 4]], [[0, 1, 2], [1, 2, 3], [2, 3, 4]]) 
```

不太可读，让我用for打印它：

```
>>> for i in (a,b): print i   
[[0, 1, 2], [1, 2, 3], [2, 3, 4]]
[[0, 1, 2], [1, 2, 3], [2, 3, 4]]
>>> a[1].append('appended')
>>> for i in (a,b): print i

[[0, 1, 2], [1, 2, 3, 'appended'], [2, 3, 4]]
[[0, 1, 2], [1, 2, 3, 'appended'], [2, 3, 4]] 
```

你看到了吗？它也附加到 b[1]，所以 b[1] 和 a[1] 是同一个对象。现在用 deepcopy 试试

```
>>> from copy import deepcopy
>>> b = deepcopy(a)
>>> a[0].append('again...')
>>> for i in (a,b): print i

[[0, 1, 2, 'again...'], [1, 2, 3, 'appended'], [2, 3, 4]]
[[0, 1, 2], [1, 2, 3, 'appended'], [2, 3, 4]] 
```

* * *

## 回答 #3

> 赞同：13
> 
>             
> 
> 时间：2008-10-08T20:31:22.333

你也可以这样做：

```
a = [1, 2, 3]
b = list(a) 
```

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2008-10-08T22:39:41.247

我喜欢做：

```
lst2 = list(lst1) 
```

优于 lst1[:] 的优点是相同的成语适用于 dicts：

```
dct2 = dict(dct1) 
```

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2013-02-11T21:45:13.217

短名单，[:] 是最好的：

```
In [1]: l = range(10)

In [2]: %timeit list(l)
1000000 loops, best of 3: 477 ns per loop

In [3]: %timeit l[:]
1000000 loops, best of 3: 236 ns per loop

In [6]: %timeit copy(l)
1000000 loops, best of 3: 1.43 us per loop 
```

对于较大的列表，它们都差不多：

```
In [7]: l = range(50000)

In [8]: %timeit list(l)
1000 loops, best of 3: 261 us per loop

In [9]: %timeit l[:]
1000 loops, best of 3: 261 us per loop

In [10]: %timeit copy(l)
1000 loops, best of 3: 248 us per loop 
```

对于非常大的列表（我尝试了 50MM），它们仍然大致相同。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:23:00.620

你也可以这样做：

```
import copy
list2 = copy.copy(list1) 
```

这应该与 Mark Roddy 的浅拷贝做同样的事情。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2012-01-18T21:23:09.613

在性能方面，调用`list()`与切片有一些开销。因此，对于短列表，`lst2 = lst1[:]`它的速度大约是`lst2 = list(lst1)`.

在大多数情况下，这可能被更具可读性的事实所抵消`list()`，但在紧密循环中，这可能是一个有价值的优化。

# process - 处理变更管理的最佳方式是什么？

> ID：184652
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-08T20:12:38.847
> 
>         
> 
> 标签：process, change-management, itil

我组织的主要项目于周一上线。那是我在这里的第三天。现在我已经在这里待了将近一周，我的任务是创建一个变更管理计划，用于维护应用程序并为“总有一天”开始的第 2 阶段做准备。我们是一家微软商店，但思想开放。

我正在寻找一些关于 CM 技术的建议，*尤其是*有助于解决这个问题的工具。我对 ITIL 很熟悉，并且一直在考虑如何将其 CM 概念应用于这个项目，但不可否认，这个项目比我习惯的要小得多（< 100 个用户对数千个用户）。我不确定如何或是否可以将 ITIL 缩减为如此小的项目。或者我想的太小了。

您的组织如何在系统级别管理变更？对你起作用吗？如何改进？

为了进一步澄清，任何人都可以推荐一个 CM 流程和工具，也许来自开源或敏捷世界？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-10T11:42:12.670

建立审查委员会，由开发、运营、QA、业务等部门的高级代表组成，CM 经理担任主席。所有更改都必须提交给董事会。

在我工作的一个地方，您需要一致批准才能实施更改。在另一种情况下，2/3 多数就足够了。但是，在这两个地方，您必须在提出更改时聚在一起。你真的不想毫无准备，看起来像个傻瓜。

CM 团队定义了通过控制门所需的“工件”，通常是一系列带有清单的表格作为指南。如果系统是“关键任务”，您可能还需要进行某种 CM 审计以确保遵循您的开发过程（运行单元测试、将文件置于版本控制之下、正确标记注释、签署 QA 测试等.)。

对于工具，一个简单的电子表格或数据库通常就足够了，您可以自己组装这些东西，为您的组织流程量身定制。把事情简单化。

CM 经理还必须有一些“牙齿”，并且能够执行审查委员会的决定。CM 是一个质量流程，用于确保维持质量标准，而不是满足最后期限。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:19:30.063

执行“变体”的概念。在每个阶段使流程正式化，并让他们填写表格，获得成本核算和批准等。这将消除很多“天哪，这不是很好......免费”，并且还将确定哪些变化是主要的并且不愧是自己的项目/子项目。保留风险登记册并公开讨论任何提议的变更可能如何影响整个项目。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-12-28T09:25:26.460

越来越多的英国公司似乎正在将 ITIL 用于变革管理。我工作的最后几个地方使用了一个名为 Sostenuto 的应用程序，它试图与事件、问题和变更管理等领域相匹配。不过，我不相信这是否是最好的处理方式。

# sql-server - SharePoint 列表与数据库表性能

> ID：184653
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-08T20:12:40.687
> 
>         
> 
> 标签：sql-server, performance, sharepoint, list

1.  我们希望将事务数据存储在 SharePoint 列表中。列表将轻松增长到 100,000 多个项目。

2.  查询性能如何与具有这些列的数据库表上的查询进行比较？

查询：按 Id 选择 Select Where ColumnValue = X Group By OrderId Group By Date

SP 列表将有 6 列宽：Id、Date、OrderId（查找）、Quantity、ItemName、Title

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2008-10-08T20:45:55.953

不要这样做。SharePoint 不擅长处理事务数据，并且表现不佳。

您可能必须在数据库级别提高性能的任何能力（如添加索引）都可能对 SharePoint 安装产生不利影响（尽管可以通过 SharePoint 对列表中的列进行“索引”。

本质上，SharePoint 是为特定目的（内容/文档）而设计的，试图让它做一些与众不同的事情意味着您必须与应用程序作斗争。

幸运的是，SharePoint 有多种方法可以将事务数据集成到其中。

首先（如果您拥有更昂贵的 Enterprise 许可证），您拥有 Business Data Catalog，它允许您导入类似于列表项的数据库值。

如果您没有企业许可证，我可以推荐自定义控件/webpart 或数据视图 Web 部件，以允许在 SharePoint 中的相关页面上“显示”该数据。

总而言之：与在传统数据库应用程序中托管数据并集成到 SharePoint 的其他应用程序设计相比，您将通过在 SharePoint 中存储事务数据来为自己做很多不必要的工作。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-09T01:20:15.353

我同意上述所有评论。我有丰富的客户经验，他们希望将 SharePoint 列表用于他们不适合的事情。如果您完全担心性能，那么 SharePoint 列表就不是好办法。如果只是出于存档目的，并且您不经常对数据进行搜索，并且 SharePoint 搜索功能对您来说就足够了，我可能会考虑它并且不会立即将其忽略（如果您使用的是 MOSS）。  

但我会仔细考虑这方面的所有方面。通过 Data Form Web Parts 和 BDC 将 SQL server 数据导入 SharePoint 环境并不太难，但将 SharePoint 数据导入其他平台或应用程序则比较困难。

再说一次，如果性能完全是一个要求，那就不要这样做。

有关 SharePoint 可扩展性和性能最佳实践的更多信息，请参阅：
 [http ://technet.microsoft.com/en-us/library/cc287790.aspx](http://technet.microsoft.com/en-us/library/cc287790.aspx)

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-10-09T03:54:03.343

经验法则是出于性能原因将 SharePoint 列表限制为 2000 个项目。

在 100k 时，性能会“从吸到吹”。

唯一可行的方法是将数据集分割成多个列表，每个列表少于 2000 个。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-06-27T07:35:12.937

当然，建议的方法是不推荐的。

但是，作为主题，[这里](http://go.microsoft.com/fwlink/?linkid=95450&clcid-0x409)是 WSS 中大型列表性能的好文档

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:17:00.397

SharePoint 列表会变慢。

更多开销=更差的性能。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T23:06:56.310

+1 没有

SharePoint 的主要功能是协作。在您的情况下，您只需将数据列为只读。在您的情况下，我建议将数据存储到 SQL DB 中，如果您需要在 SharePoint 门户中显示它，您可以使用 BDC 或 Bamboo Data View Web 部件之类的东西。[http://store.bamboosolutions.com/p-71-data-viewer-web-part.aspx](http://store.bamboosolutions.com/p-71-data-viewer-web-part.aspx)

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-23T13:29:38.983

我也同意上述人的观点但是 - 博客中讨论的许多性能问题是由于 SharePoint 对象模型没有正确使用。

您可以在 dynaTrace 博客上查看我关于 SharePoint 列表性能的博客系列。本系列研究 SharePoint 对象模型以突出显示 SharePoint 服务器和内容数据库之间的实际情况

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-08-14T02:39:36.053

我自己做了这个，我会说如果可能的话尽量避免它！这是一个雷区，尤其是在大约 100,000 行之后。

最终也可能会咬你的东西是，搜索爬虫可以开始超时尝试爬取非常大的列表 - 你可以增加超时，但这是一场失败的战斗的开始。

# performance - 如何快速保持自动化测试？

> ID：184661
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-08T20:14:50.540
> 
>         
> 
> 标签：performance, testing, continuous-integration, automated-tests

自动化测试必须快速反映实时项目状态。这个想法是：

1.  在执行任何对存储库自动构建的提交之后（尽可能快地完成）。

2.  如果构建成功自动测试开始。必须快。

这是我知道的最好的方法来确定你的更改是否会破坏任何东西。

起初，快速构建似乎很难，但我们设法将其保持在 100 秒左右。用于 105(!) 个项目的解决方案 (MSVS 2008 C#)。

测试似乎没有那么简单（我们使用 NUnit FW）。单元测试不是一个大问题。是集成测试杀死了我们。而不是它们更慢的事实（任何关于如何使它们更快的想法都非常感谢），而是必须设置的环境要慢得多（atm ~1000 秒）！

我们的集成测试使用需要重新部署的 web/win 服务（目前有 19 个）以反映最新的变化。这包括重新启动服务和大量 HDD R/W 活动。

任何人都可以分享如何组织/优化环境和工作流程以加快自动化测试阶段的经验。什么是“低级”瓶颈和解决方法。

欢迎 PS 书籍和广泛的文章，但更赞赏现实世界的工作解决方案。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-10T06:35:53.470

您可以采取许多优化策略来提高测试的吞吐量，但您需要问自己这个测试的目标是什么，以及为什么它需要快速。

有些测试需要时间。这是生活中的事实。集成测试通常需要时间，并且您通常必须设置一个环境才能执行它们。如果您设置了一个环境，您将希望拥有一个尽可能接近最终生产环境的环境。

你有两个选择：

1.  优化测试或测试的部署。

2.  不要经常这样做。

以我的经验，最好有一个正确的集成环境，发现错误，并充分代表最终的生产环境。我通常选择选项 2 (1)。

很容易说我们会一直测试所有内容，但实际上你需要一个策略。

(1) 除非有大量仅在集成中发现的错误，在这种情况下，忘记我所说的一切 :-)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T20:20:59.483

我们使用 .NET 和 NUnit，它们支持类别（您可以进行测试的属性）。然后我们进行长时间运行的测试并将它们放入 NightlyCategory 中，以便它们仅在夜间构建期间运行，而不是在我们想要快速运行的连续构建中运行。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-09T11:21:08.247

我整理了一个关于[Turbo-Charged Test Suites](http://www.slideshare.net/Ovid/turbo-charged-test-suites-presentation)的演示文稿。后半部分面向 Perl 开发人员，但前半部分可能对您有用。我对您的软件知之甚少，不知道它是否合适。

基本上，它涉及加速测试套件中的数据库使用和在单个进程中运行测试以避免不断重新加载库的技术。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-12-05T15:35:41.050

我建议进行一些高级别的端到端测试，如果其中任何一个失败，请运行“更高分辨率”测试。

考虑通过电话进行技术支持...

你的电脑能用吗？如果是，完成。如果没有，您的计算机是否完全打开？...

对于我的单元测试，我有一些快速测试，例如“我的计算机是否工作？” 如果这些通过，我不会执行我的套件的其余部分。如果这些测试中的任何一个失败，我将执行相关的低级别测试套件，让我可以更高分辨率地查看该失败。

我的观点是，运行一套全面的顶级测试应该不到半秒。

这种方法给了我速度和细节。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-12-05T16:32:41.013

> 事实上，必须设置慢得多的环境（atm ~1000 秒）！

好吧，至少你知道应该把重点放在哪里……你知道这些时间都花在了哪里吗？

显然，任何解决方案都将取决于这里的细节。

在这种情况下，我使用了三种解决方案：

1.  使用更多的机器。也许您可以将您的服务划分到两台机器上？这会让你的设置时间减少 1/2 吗？

2.  使用更快的机器？在我知道的一种情况下，团队通过升级硬件（多个 CPU、快速 RAID 存储、更多 RAM 等）将他们的集成测试执行时间从 18 小时缩短到 1 小时。当然，这花费了他们 1 万美元的订单，但这是值得的。

3.  使用内存数据库进行集成测试。是的，我知道您也希望对真实数据库进行测试，但也许您最初可以针对内存版本运行测试以获得快速反馈。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2012-11-12T10:50:41.950

这种情况的最佳解决方案是在重置环境之前备份环境的重影并恢复图像。这对所花费的时间更有意义。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:24:01.320

Buildbot：[http](http://buildbot.net/trac) ://buildbot.net/trac
如果你正在做持续集成（自动化测试），我推荐的还不够。通过快速配置，我们所有的单元测试都会在每次提交时运行，并且较长的集成测试会在一天中定期运行（我上次检查了 3 次，但这很容易改变）。  

# perl - 我应该将我的实用程序.pl 更改为实用程序.pm 模块吗？

> ID：184662
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-08T20:15:16.313
> 
>         
> 
> 标签：perl, perl-module

在我们的产品中，我们有一个很大的实用程序文件，我们`do`在很多文件的开头都需要（带有 ）。有没有理由*不*把它变成一个模块？例如，不要这样做：

```
do '../dbi_utilities.pl';
our ($db,$user,$pw,$attr);
my $Data = DBI->connect($db,$user,$pw,$attr) or die "Could not connect to database: $DBI::errstr"; 
```

我不能这样做吗？：

```
use AppUtil;
my $Data = AppUtil->connect(); 
```

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-10-08T20:40:26.760

不这样做的唯一原因是时间。

That is, it'll take time to clean up your interface, as well as all calling apps to use the new interface.

What it'll cost you in time now will be more than made up when you start using proper tests ("make test" or "./Build test" or just "prove ...") and be able to check that your changes won't break anything before checking it in.  So, by all means, convert.  Just be aware that it's not a free gain.

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2008-10-08T21:49:27.043

By making your code into a module with proper refactoring, you make it easy to test. I talk about this in my ["Scripts as Modules"](http://www.ddj.com/184416165) article for *The Perl Journal* as well as ["How a Script Becomes a Module"](http://www.perlmonks.org/index.pl?node_id=396759) on Perlmonks.

Good luck, 

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2008-10-08T20:20:40.950

使用do()，您每次都在加载和编译utilities.pl 文件，如果您多次do() 可能会导致问题。此外，`use`在编译时完成，这将使您的程序更快失败，甚至使用`perl -wc`.

最后，将它保存在一个包中可以保护它的命名空间，这会随着项目的增长而有所帮助。

我强烈建议将您的 utilites.pl 转换为加载了`use`.

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:20:31.747

用它制作一个模块将使它更加健壮。现在很多东西都非正式地相互依赖，但这些依赖关系并不是很明显。

此外，它还可以让您仅导入部分实用程序。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:23:32.600

您可以获得所有很酷的模块内容、封装、模块特定功能等等。

但是请注意，通过使用`use`您的语法。为 AppUtil 命名空间创建一个对象，并调用 connect 子例程。为您的公用事业。

你也必须有 1; 在文件的末尾。

* * *

坚持另一种方法意味着您不必更改任何代码，也不必在末尾添加 1。

所有“do”、“use”和“require”导入，但其中的范围代码（命名子例程除外，因为它们不能被隐藏）。

# xml - 如何使用模式基于属性值验证元素？

> ID：184663
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-08T20:15:18.323
> 
>         
> 
> 标签：xml, validation, schema, xsd

我要验证的 XML 如下：

```
<root>
    <element attribute="foo">
        <bar/>
    </element>
    <element attribute="hello">
        <world/>
    </element>
</root> 
```

如何使用 Schema 进行验证？

笔记：

**元素**只能在**attribute="foo"**时包含**bar**。

 ****元素**只能在**属性=“你好”**时包含**世界**

 *** * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-10-08T21:59:00.673

您不能在 XML Schema 1.0 中做到这一点。在 XML Schema 1.1 中，您将能够使用该[`<xs:assert>`元素](http://www.w3.org/TR/2008/WD-xmlschema11-1-20080620/#cAssertions)来执行此操作，但我猜您想要一些现在可以使用的东西。

您可以使用[Schematron](http://www.schematron.com/)作为第二层验证，它允许您测试关于您的 XML 文档的任意 XPath 断言。[有一篇关于在 XSD 中嵌入 Schematron](http://www.topologi.com/resources/schtrn_xsd_paper.html)的相当古老的文章，您可能会发现它很有帮助。

你会做这样的事情：

```
<rule context="element">
  <report test="@attribute = 'foo' and *[not(self::bar)]">
    This element's attribute is 'foo' but it holds an element that isn't a bar.
  </report>
  <report test="@attribute = 'hello' and *[not(self::world)]">
    This element's attribute is 'hello' but it holds an element that isn't a world.
  </report>
</rule> 
```

或者，您当然可以切换到[RELAX NG](http://relaxng.org/)，它会在睡眠中执行此操作：

```
<element name="element">
  <choice>
    <group>
      <attribute name="attribute"><value>foo</value></attribute>
      <element name="bar"><empty /></element>
    </group>
    <group>
      <attribute name="attribute"><value>hello</value></attribute>
      <element name="world"><empty /></element>
    </group>
  </choice>
</element> 
```

# tdd - 我应该练习“mockist”还是“经典”TDD？

> ID：184666
> 
>         
> 
> 赞同：45
> 
>         
> 
> 时间：2008-10-08T20:16:03.503
> 
>         
> 
> 标签：tdd, mocking

我已经阅读（并重新阅读）Martin Fowler 的[Mocks Aren't Stubs](http://martinfowler.com/articles/mocksArentStubs.html)。在其中，他定义了[两种不同的 TDD 方法：“Classical”和“Mockist”](http://martinfowler.com/articles/mocksArentStubs.html#ClassicalAndMockistTesting)。他试图回答“[那么我应该成为古典主义者还是模仿者？](http://martinfowler.com/articles/mocksArentStubs.html#SoShouldIBeAClassicistOrAMockist) ”这个问题，但他承认他从未在“除了玩具之外的任何东西”上尝试过模仿者 TDD。所以我想我会在这里问这个问题。好的答案可能会重复 Fowler 的论点（但希望更清楚）或添加自 Fowler 上次于 2007 年 1 月更新文章以来他没有想到的或其他人提出的论点。

* * *

## 回答 #1

> 赞同：42
> 
>             
> 
> 时间：2008-10-08T20:27:08.457

我认为您不需要选择其中之一。两者都有其优点和缺点，两者都是您工具箱的工具。“Mockist” tdd 使您在可以测试的内容上更加灵活，而经典 TDD 使您的测试不那么脆弱，因为它们倾向于更多地查看输入/输出而不是查看实际的实现。在进行模拟单元测试时，我似乎在更改实现时有更多测试中断。

我尽可能使用经典的 tdd（尽管我经常使用模拟框架来快速设置存根）。有时我注意到我一次开始测试太多，或者我需要太多对象来设置测试。那时，mockist 测试通常可以帮助您设置较小的测试。

这一切都很抽象，所以我希望我有意义

* * *

## 回答 #2

> 赞同：28
> 
>             
> 
> 时间：2008-10-20T21:10:32.767

关于 mockist 或经典 tdd 的问题很大程度上是关于您正在测试应用程序的哪一部分。如果您有一个“标准”分层架构（例如[DDD](http://www.domaindrivendesign.org "DDD")），那么域层通常适合经典的 tdd，您可以在其中通过设置被测对象进行单元测试，调用一些方法并检查结果和/或状态。

另一方面，当您测试应用程序服务、控制器或表示逻辑时，它们都进行更多的协调工作，通常需要模拟或存根来获得良好的测试。我的经验也是，这些类往往会调用您真正想要模拟或存根的其他层（webservice、datalayer...）。这些单元测试还需要更多设置代码，因此您应该只在必要时进行模拟。

我的建议是尽可能经典，必要时模仿。

* * *

## 回答 #3

> 赞同：17
> 
>             
> 
> 时间：2009-05-21T16:53:11.717

您可以考虑查看我们的书，网址为[http://www.growth-object-orientated-software.com/](http://www.growing-object-oriented-software.com/)。它包括一个扩展的工作示例。当我们写它时，我们发现状态与交互的区别在很大程度上是误导性的，它更多的是关于一个人的面向对象设计的方法。

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2014-03-24T18:50:50.670

Sandi Metz 揭露了一种非常务实的做法：

一个对象可以通过传出或传入消息与其他对象通信。消息可以是查询（返回某些内容）或命令（执行某些内容）。

有四种组合。不应测试传出查询消息（已作为外部类的传入查询进行测试）您可以对传出命令消息使用 mockist 测试方法，并对其余消息使用经典测试。

[![在此处输入图像描述](https://i.stack.imgur.com/sUNuO.png)](https://i.stack.imgur.com/sUNuO.png)

检查链接

[http://jnoconor.github.io/blog/2013/10/07/the-magic-tricks-of-testing-by-sandi-metz/](http://jnoconor.github.io/blog/2013/10/07/the-magic-tricks-of-testing-by-sandi-metz/)

[https://speakerdeck.com/skmetz/magic-tricks-of-testing-ancientcityruby](https://speakerdeck.com/skmetz/magic-tricks-of-testing-ancientcityruby)

[YouTube](https://www.google.co.ve/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&uact=8&ved=0CC4QtwIwAQ&url=http://www.youtube.com/watch?v=URSWYvyc42M&ei=QX4wU-eWCZLfkQeVlYCoBQ&usg=AFQjCNFO6zPppU9XMtWg-0HUONFvMA4sUA&sig2=N0KNUtM82wq3pV-tpSgSlw)

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-20T15:17:12.387

我在 TDD 方面还是比较新的——但我被教导/介绍差异的方式是从测试类之间的集成的角度来考虑它，这样你就不会依赖实时数据。例如，如果我有一个非常独立的类 - 不依赖于我为项目构建的其他类，并且它不会进入实时数据/开发环境进行输入（如 DB 或 API一个系统）然后我只会在 NUnit 或 JUnit 之类的东西中使用经典单元测试 - 但是当我开始测试构建类之间的交互时 - 那时它可以真正方便地模拟其他自定义类和/或外部交互 - 这样你可以挑出并测试您当前类的代码，而无需试图追查您正在调用的其他类中的潜在错误。

# windows - 如何使用 Visual Studio 进行修补程序部署？

> ID：184669
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T20:16:44.907
> 
>         
> 
> 标签：windows, deployment, hotfix

假设您有一个用 Visual Studio 编写的产品，并且您为您的客户和用户提供了该产品的安装程序。

然后，您有一些小的更改要部署给您的用户；您不希望您的用户必须经历卸载过程、备份配置、然后重新安装产品并恢复配置。

相反，您希望提供一个“热修复”，用户可以简单地复制已安装的产品。使用 Visual Studio 或一些微软工具，你会怎么做呢？

我不知道这是否重要，但可以说该产品是 1) 部分是 Web 应用程序，2) 部分是 Windows 服务，3) 部分是 Windows 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T20:32:59.037

使用[WiX](http://wix.sourceforge.net/)。

它可以处理所有这些事情（安装 Web 应用程序、服务等），而且它非常灵活、免费，并且是 Microsoft 用来构建其安装程序的工具。

您可以安装[Votive](http://wix.sourceforge.net/votive.html)以在 Visual Studio 中使用 WiX。

如何完全按照您的要求进行操作的细节有点复杂，并且取决于具体情况。通常，您需要构建初始 MSI 以获得升级代码。然后，后续的升级安装程序将使用相同的产品代码和升级代码，但会更改版本。[作为教程的第 4 部分，](http://www.tramontana.co.hu/wix/lesson4.php)您可以阅读有关如何使用 WiX 执行此操作的详细信息。

如果您有现有的安装，它们可能已经设置了升级代码，也可能没有。[您可以通过使用ORCA](http://msdn.microsoft.com/en-us/library/aa370557.aspx)检查它们来找出答案（[MSDN 如何在此处](http://support.microsoft.com/kb/255905)）。

这也可以通过 Visual Studio 中内置的 .Net Setup 项目来完成，但我不建议这样做。它们不如 WiX 灵活。如果您关心您的安装，并且有像您所描述的那样复杂的安装，那么 WiX 是最好的选择。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:34:47.023

您可以在 Visual Studio 中创建可以处理此问题的部署项目。这些导致可以在客户端计算机或服务器上运行并执行升级的 MSI（或可能的多个 MSI）。

# c - 我应该如何学习C？

> ID：184676
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-08T20:18:03.950
> 
>         
> 
> 标签：c, kernighan-and-ritchie

我对学习 C 很感兴趣。我读过[K & R](http://en.wikipedia.org/wiki/The_C_Programming_Language_(book))，甚至在 R 和 Python 中做了一些简单的 C 扩展工作。用 C 做一些更实质性的事情是什么有价值的项目想法？有什么好的在线资源，类似于[Dive Into Python](http://www.diveintopython.net/)吗？特别是，资源集中在那些已经知道正在尝试学习 C 的新语言的程序员上（其中提到了诸如“在 C 中询问数组的长度是无稽之谈，你这个懒惰的 Pythonista”）。  

我的背景：

数学/统计，Python、R 的日常编程，主要围绕自然语言处理、算法等。  

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2008-10-08T20:21:28.483

几年前，我的一个朋友问我同样的问题：“我如何学习 C？” 我告诉他写一个设备驱动程序。

想象一下，当他真正做到这一点时，我会感到惊讶。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2008-10-08T20:19:45.773

看看 
[After K&R 用什么书来学习纯 C 编程？](https://stackoverflow.com/questions/803522/after-kr-what-book-to-use-to-learn-programming-in-plain-c)

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T20:23:01.350

有点离题，但既然你提到你的背景是数学和统计，你应该尝试一下 Project Euler。有超过 200 个数学/统计相关问题可供解决。此外，一旦找到解决方案，您可以查看问题论坛以了解其他人如何解决相同的解决方案。非常方便查看其他人如何解决问题......而且很有趣！

[www.projecteuler.net](http://www.projecteuler.net)

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2008-10-09T00:52:25.567

我和你有相似的背景。我使用 Python 为我的博士研究以及网络编程进行大量数学和数据分析。不同之处在于我早在 90 年代就开始学习 C。

如果您可以为 Python 编写 C 扩展，那么我会说您非常了解 C 的优点。在我看来，今天的 C 语言最适合做两件事：

*   编写与硬件交互的低级软件。

*   编写重复、乏味、CPU 密集型工作（数学、XML 解析等）的代码……也许是对高级语言的扩展。

当然，许多高级应用程序也是用 C 编写的，尤其是在我发现的 Linux 下，但在很大程度上，这些应用程序并不是真正用 K&R 的“基本”C 或标准库编写的。相反，他们使用 Glib、wxWindows、Apache Portable Runtime 或其他框架，它们都使用某种面向对象的结构或约定，并且经常抽象出 C 的一些基本内存管理细节。

所以我认为让你的 C 技能*在当今的编程语言环境*中有用主要是为了做低级工作，或者熟悉这些高级框架之一。我个人非常喜欢 Glib 和 GTK 库，因为它们使用了一个非常**动态**的面向对象模型（很像 Python），而不会阻止您使用 C 的低级特性。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:22:39.340

您可以为一种简单的语言编写解释器。使用弹性/野牛。使其成为多线程等。这很有趣，并且往往会大量使用指针。我为一个[学校项目](http://code.google.com/p/sinavm/)写了类似的东西：一种简单的基于堆栈的语言，具有两个不同的垃圾收集器、TwoSpace 和一个并发版本。那很有趣。并且可以作为第一个比“你好，世界”更大的 c 程序！

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2012-06-01T15:45:03.170

看看Learn C the hard way，这是一本免费的电子书，它带你学习许多C代码示例和练习，以便你学习。

[http://c.learncodethehardway.org/](http://c.learncodethehardway.org/)

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:20:41.933

在您的日常工作中发现或定义一个问题，并强迫自己使用 C 而不是 Python 来解决它。这将迫使您学习语言，同时保持问题与您通常所做的事情相关。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:20:47.627

实现一个虚拟机（例如 JVM）。

# windows - 跨多个 Windows 平台收集 wifi bssid 和 rssi 数据的最有效方法

> ID：184677
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T20:18:27.460
> 
>         
> 
> 标签：windows, wifi, rssi, bssid

我正在尝试在 Windows 上收集 wifi Bssid 和 Rssi 信息，并且正在寻找在尽可能多的 Windows 版本中执行此操作的最可靠方法。在 Vista 中，通过无线 LAN API 可以轻松使用 Win32 调用。该 API 存在于 XP SP2（有时）和 SP3 上，但据我所知，它不支持在这些平台上收集 Bssid 信息。

理想情况下，我希望有一种方法可以在所有版本的 XP 上使用它。（我猜 Windows 95 / 98 / ME 根本没有希望）。任何编程语言或命令行工具都可以。任何指针？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-07-02T14:25:45.723

好吧，您无法从 Windows 获取该信息（据我所知）。我来自路由器本身。但 Wireshark 和 nmap 是我的猜测。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2012-05-23T12:45:23.393

这是不正确的，Windows 提供了获取这些信息的可能性。坏消息：没有一种这样的方法，而是必须根据操作系统使用不同的 API 和接口。

但是您不必重新发明轮子，libwlocate 已经包含您正在寻找的功能：[http ://libwlocate.git.sourceforge.net/git/gitweb.cgi?p=libwlocate/libwlocate;a=tree ;f=master;h=22427173ce6fa394bc6014d9f109f6ed12b9f25f;hb=HEAD](http://libwlocate.git.sourceforge.net/git/gitweb.cgi?p=libwlocate/libwlocate;a=tree;f=master;h=22427173ce6fa394bc6014d9f109f6ed12b9f25f;hb=HEAD)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2013-12-28T04:14:12.030

你可以试试这个命令行工具，“netsh wlan show networks mode=Bssid”，我试过了，它适用于这篇文章[https://stackoverflow.com/a/187867/1767800](https://stackoverflow.com/a/187867/1767800)
的我的Win7原版
  但是netsh wlan没有' t 工作在 windows xp 上。作为替代，您可以在 xp sp2 和 sp3 上尝试[http://www.symantec.com/connect/articles/how-capture-and-deploy-wlan-profiles 。](http://www.symantec.com/connect/articles/how-capture-and-deploy-wlan-profiles)

# java - 为什么解析此日期字符串会引发无法解析的日期异常？

> ID：184678
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T20:18:41.703
> 
>         
> 
> 标签：java, date

我将 SimpleDateFormat 与模式一起使用`EEE MM/dd  hh:mma`，传入日期字符串`Thu 10/9  08:15PM`，它抛出了一个不可解析的日期异常。为什么？我以前使用过各种模式，`SimpleDateFormat`所以我对它的用法相当熟悉。也许我因为盯着它太久而错过了一些明显的东西。

另一种可能性是时髦的（技术术语）空白。上下文是一个屏幕抓取应用程序，我在其中使用 HtmlCleaner 来整理凌乱的 html。虽然我发现 HtmlCleaner 总体上非常好，但我注意到一些奇怪的问题，例如，看起来像空格但不能被 StringTokenizer 识别的字符。我大部分时间都在解决它，并没有深入研究字符编码或类似的东西，但我开始怀疑。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:48:39.273

要测试它是否是日期格式，请编写一个测试类来证明它。对于这些类型的东西，我喜欢使用 bsh（beanshell）。这是我的测试：

```
sdf = new java.text.SimpleDateFormat("EEE MM/dd hh:mma");
System.out.println(sdf.format(sdf.parse("Thu 10/9 08:15PM"))); 
```

哪个输出：Fri 10/09 08:15PM

所以，至少对于我的 jdk / jre 版本（1.6），格式字符串似乎工作得很好。我认为下一步是确保您正在处理的字符串正是您认为的那样。您可以在代码中添加日志记录，并将输入字符串转储到日志文件中吗？然后你可以在一个漂亮的文本编辑器中查看它，在你的测试类中运行它，或者在十六进制编辑器中查看它以确保它只是普通文本。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-09T16:59:33.400

StackOverFlow 上的第一个问题，所以我不确定将其标记为已解决的正确方法是什么。大多数答案都在 Eric 答案的评论中。

根本原因是日期字符串中的“空格”字符未被识别。它是一个 'A0' 的十六进制字符，它是一个不间断的空格。我最终将日期字符串转换为 char 数组，使用 Character.isSpaceChar() 检查字符，并将返回 true 的字符替换为 " " 字符。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:20:55.677

试试这个代替你的模式：

```
EEE MM/d hh:mma 
```

区别在于 single`d`而不是 double `dd`，因为您的日期是 10/9 而不是 10/09。

# c# - is vs typeof

> ID：184681
> 
>         
> 
> 赞同：155
> 
>         
> 
> 时间：2008-10-08T20:19:03.793
> 
>         
> 
> 标签：c#, rtti

这些代码中哪一个更快？

```
if (obj is ClassA) {}

if (obj.GetType() == typeof(ClassA)) {} 
```

编辑：我知道他们不做同样的事情。

* * *

## 回答 #1

> 赞同：198
> 
>             
> 
> 时间：2008-10-08T20:23:38.403

如果他们不做同样的事情，哪个更快有关系吗？比较具有不同含义的语句的性能似乎是个坏主意。

`is`告诉您对象是否`ClassA`在其类型层次结构中的任何位置实现。  `GetType()`告诉你最衍生的类型。

不是一回事。

* * *

## 回答 #2

> 赞同：170
> 
>             
> 
> 时间：2008-10-08T20:21:03.617

[这应该回答这个问题，然后是一些。](https://docs.microsoft.com/en-us/archive/blogs/vancem/drilling-into-net-runtime-microbenchmarks-typeof-optimizations)

`if (obj.GetType() == typeof(ClassA)) {}`对于那些不想阅读文章的人来说，第二行更快。

*（请注意，他们不会做同样的事情）*

* * *

## 回答 #3

> 赞同：27
> 
>             
> 
> 时间：2008-10-08T20:22:51.647

他们不做同样的事情。如果 obj 是 ClassA 类型或 ClassA 的某个子类，则第一个有效。第二个将只匹配 ClassA 类型的对象。第二个会更快，因为它不必检查类层次结构。

对于那些想知道原因但不想阅读参考文章的人[是与 typeof](https://stackoverflow.com/questions/184681/is-vs-typeof#184697)。

* * *

## 回答 #4

> 赞同：18
> 
>             
> 
> 时间：2013-02-12T15:54:16.323

我做了一些基准测试，他们做同样的事情 - 密封类型。

```
var c1 = "";
var c2 = typeof(string);
object oc1 = c1;
object oc2 = c2;

var s1 = 0;
var s2 = '.';
object os1 = s1;
object os2 = s2;

bool b = false;

Stopwatch sw = Stopwatch.StartNew();
for (int i = 0; i < 10000000; i++)
{
    b = c1.GetType() == typeof(string); // ~60ms
    b = c1 is string; // ~60ms

    b = c2.GetType() == typeof(string); // ~60ms
    b = c2 is string; // ~50ms

    b = oc1.GetType() == typeof(string); // ~60ms
    b = oc1 is string; // ~68ms

    b = oc2.GetType() == typeof(string); // ~60ms
    b = oc2 is string; // ~64ms

    b = s1.GetType() == typeof(int); // ~130ms
    b = s1 is int; // ~50ms

    b = s2.GetType() == typeof(int); // ~140ms
    b = s2 is int; // ~50ms

    b = os1.GetType() == typeof(int); // ~60ms
    b = os1 is int; // ~74ms

    b = os2.GetType() == typeof(int); // ~60ms
    b = os2 is int; // ~68ms

    b = GetType1<string, string>(c1); // ~178ms
    b = GetType2<string, string>(c1); // ~94ms
    b = Is<string, string>(c1); // ~70ms

    b = GetType1<string, Type>(c2); // ~178ms
    b = GetType2<string, Type>(c2); // ~96ms
    b = Is<string, Type>(c2); // ~65ms

    b = GetType1<string, object>(oc1); // ~190ms
    b = Is<string, object>(oc1); // ~69ms

    b = GetType1<string, object>(oc2); // ~180ms
    b = Is<string, object>(oc2); // ~64ms

    b = GetType1<int, int>(s1); // ~230ms
    b = GetType2<int, int>(s1); // ~75ms
    b = Is<int, int>(s1); // ~136ms

    b = GetType1<int, char>(s2); // ~238ms
    b = GetType2<int, char>(s2); // ~69ms
    b = Is<int, char>(s2); // ~142ms

    b = GetType1<int, object>(os1); // ~178ms
    b = Is<int, object>(os1); // ~69ms

    b = GetType1<int, object>(os2); // ~178ms
    b = Is<int, object>(os2); // ~69ms
}

sw.Stop();
MessageBox.Show(sw.Elapsed.TotalMilliseconds.ToString()); 
```

用于测试泛型类型的泛型函数：

```
static bool GetType1<S, T>(T t)
{
    return t.GetType() == typeof(S);
}
static bool GetType2<S, T>(T t)
{
    return typeof(T) == typeof(S);
}
static bool Is<S, T>(T t)
{
    return t is S;
} 
```

我也尝试了自定义类型，结果是一致的：

```
var c1 = new Class1();
var c2 = new Class2();
object oc1 = c1;
object oc2 = c2;

var s1 = new Struct1();
var s2 = new Struct2();
object os1 = s1;
object os2 = s2;

bool b = false;

Stopwatch sw = Stopwatch.StartNew();
for (int i = 0; i < 10000000; i++)
{
    b = c1.GetType() == typeof(Class1); // ~60ms
    b = c1 is Class1; // ~60ms

    b = c2.GetType() == typeof(Class1); // ~60ms
    b = c2 is Class1; // ~55ms

    b = oc1.GetType() == typeof(Class1); // ~60ms
    b = oc1 is Class1; // ~68ms

    b = oc2.GetType() == typeof(Class1); // ~60ms
    b = oc2 is Class1; // ~68ms

    b = s1.GetType() == typeof(Struct1); // ~150ms
    b = s1 is Struct1; // ~50ms

    b = s2.GetType() == typeof(Struct1); // ~150ms
    b = s2 is Struct1; // ~50ms

    b = os1.GetType() == typeof(Struct1); // ~60ms
    b = os1 is Struct1; // ~64ms

    b = os2.GetType() == typeof(Struct1); // ~60ms
    b = os2 is Struct1; // ~64ms

    b = GetType1<Class1, Class1>(c1); // ~178ms
    b = GetType2<Class1, Class1>(c1); // ~98ms
    b = Is<Class1, Class1>(c1); // ~78ms

    b = GetType1<Class1, Class2>(c2); // ~178ms
    b = GetType2<Class1, Class2>(c2); // ~96ms
    b = Is<Class1, Class2>(c2); // ~69ms

    b = GetType1<Class1, object>(oc1); // ~178ms
    b = Is<Class1, object>(oc1); // ~69ms

    b = GetType1<Class1, object>(oc2); // ~178ms
    b = Is<Class1, object>(oc2); // ~69ms

    b = GetType1<Struct1, Struct1>(s1); // ~272ms
    b = GetType2<Struct1, Struct1>(s1); // ~140ms
    b = Is<Struct1, Struct1>(s1); // ~163ms

    b = GetType1<Struct1, Struct2>(s2); // ~272ms
    b = GetType2<Struct1, Struct2>(s2); // ~140ms
    b = Is<Struct1, Struct2>(s2); // ~163ms

    b = GetType1<Struct1, object>(os1); // ~178ms
    b = Is<Struct1, object>(os1); // ~64ms

    b = GetType1<Struct1, object>(os2); // ~178ms
    b = Is<Struct1, object>(os2); // ~64ms
}

sw.Stop();
MessageBox.Show(sw.Elapsed.TotalMilliseconds.ToString()); 
```

和类型：

```
sealed class Class1 { }
sealed class Class2 { }
struct Struct1 { }
struct Struct2 { } 
```

推理：

1.  **调用s 比较慢`GetType`。`struct`** `GetType`定义在`object`不能在子类型中覆盖的类上，因此`struct`需要将 s 装箱才能调用`GetType`。

2.  **在对象实例上，`GetType`速度更快，但非常有限。**

3.  **在泛型类型上， if `T`is `class`， then`is`快得多。如果`T`是`struct`，则比两者都`is`快得多，`GetType`但`typeof(T)`比两者都快得多。**在存在的情况下`T`，`class`不`typeof(T)`可靠，因为它与实际的底层类型不同`t.GetType`。

简而言之，如果您有`object`实例，请使用`GetType`. 如果您有泛型`class`类型，请使用`is`. 如果您有泛型`struct`类型，请使用`typeof(T)`. 如果您不确定泛型类型是引用类型还是值类型，请使用`is`. 如果您想始终与一种样式保持一致（对于密封类型），请使用`is`..

# .net - 使用 C# 从流中播放音频

> ID：184683
> 
>         
> 
> 赞同：102
> 
>         
> 
> 时间：2008-10-08T20:19:23.060
> 
>         
> 
> 标签：.net, audio, stream, mp3, naudio

[C# 中有没有办法直接从System.IO.Stream](http://msdn.microsoft.com/en-us/library/system.io.stream%28v=vs.110%29.aspx)播放音频（例如 MP3），例如从 WebRequest 返回而不将数据临时保存到磁盘？

* * *

### [NAudio](https://github.com/naudio/NAudio)解决方案

[在NAudio](https://github.com/naudio/NAudio) 1.3的帮助下，可以：

1.  将 MP3 文件从 URL 加载到 MemoryStream

2.  完全加载后将 MP3 数据转换为波形数据

3.  [使用NAudio](https://github.com/naudio/NAudio)的 WaveOut 类播放波形数据

能够播放半加载的 MP3 文件本来会很好，但由于[NAudio](https://github.com/naudio/NAudio)库的设计，这似乎是不可能的。

这是将完成工作的功能：

```
 public static void PlayMp3FromUrl(string url)
    {
        using (Stream ms = new MemoryStream())
        {
            using (Stream stream = WebRequest.Create(url)
                .GetResponse().GetResponseStream())
            {
                byte[] buffer = new byte[32768];
                int read;
                while ((read = stream.Read(buffer, 0, buffer.Length)) > 0)
                {
                    ms.Write(buffer, 0, read);
                }
            }

            ms.Position = 0;
            using (WaveStream blockAlignedStream =
                new BlockAlignReductionStream(
                    WaveFormatConversionStream.CreatePcmStream(
                        new Mp3FileReader(ms))))
            {
                using (WaveOut waveOut = new WaveOut(WaveCallbackInfo.FunctionCallback()))
                {
                    waveOut.Init(blockAlignedStream);
                    waveOut.Play();                        
                    while (waveOut.PlaybackState == PlaybackState.Playing )                        
                    {
                        System.Threading.Thread.Sleep(100);
                    }
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：58
> 
>             
> 
> 时间：2008-10-08T21:44:46.523

**编辑：更新答案以反映 NAudio 最新版本的变化**

可以使用我编写的[NAudio](https://github.com/naudio/NAudio)开源 .NET 音频库。它会在您的 PC 上查找 ACM 编解码器来进行转换。NAudio 提供的 Mp3FileReader 当前期望能够在源流中重新定位（它预先构建 MP3 帧的索引），因此它不适合通过网络进行流式传输。但是，您仍然可以使用 NAudio 中的`MP3Frame`和`AcmMp3FrameDecompressor`类即时解压缩流式 MP3。

我在我的博客上发表了一篇文章，解释[了如何使用 NAudio 播放 MP3 流](http://mark-dot-net.blogspot.com/2011/05/how-to-play-back-streaming-mp3-using.html)。本质上，您有一个线程下载 MP3 帧，解压缩它们并将它们存储在`BufferedWaveProvider`. `BufferedWaveProvider`然后另一个线程使用作为输入进行回放。

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2008-10-08T20:42:06.133

[SoundPlayer](http://msdn.microsoft.com/en-us/library/w5bfdtza.aspx)类可以做到这一点。看起来您所要做的就是将其*Stream*属性设置为流，然后调用`Play`.

*编辑*

我不认为它可以播放 MP3 文件；它似乎仅限于.wav。我不确定框架中是否有任何东西可以直接播放 MP3 文件。我发现的所有内容都涉及使用 WMP 控件或与 DirectX 交互。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-10-22T10:59:39.223

[Bass](http://www.un4seen.com/bass.html)可以做到这一点。从内存中的 Byte[] 播放或通过文件代表返回数据的位置，这样您就可以在有足够的数据开始播放时立即播放..

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2011-02-22T16:50:36.623

我稍微修改了主题启动器源，因此它现在可以播放未完全加载的文件。在这里（注意，这只是一个示例，是一个起点；您需要在此处进行一些异常和错误处理）：

```
private Stream ms = new MemoryStream();
public void PlayMp3FromUrl(string url)
{
    new Thread(delegate(object o)
    {
        var response = WebRequest.Create(url).GetResponse();
        using (var stream = response.GetResponseStream())
        {
            byte[] buffer = new byte[65536]; // 64KB chunks
            int read;
            while ((read = stream.Read(buffer, 0, buffer.Length)) > 0)
            {
                var pos = ms.Position;
                ms.Position = ms.Length;
                ms.Write(buffer, 0, read);
                ms.Position = pos;
            }
        }
    }).Start();

    // Pre-buffering some data to allow NAudio to start playing
    while (ms.Length < 65536*10)
        Thread.Sleep(1000);

    ms.Position = 0;
    using (WaveStream blockAlignedStream = new BlockAlignReductionStream(WaveFormatConversionStream.CreatePcmStream(new Mp3FileReader(ms))))
    {
        using (WaveOut waveOut = new WaveOut(WaveCallbackInfo.FunctionCallback()))
        {
            waveOut.Init(blockAlignedStream);
            waveOut.Play();
            while (waveOut.PlaybackState == PlaybackState.Playing)
            {
                System.Threading.Thread.Sleep(100);
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2012-02-11T23:52:20.863

我已经调整了问题中发布的来源，以允许使用 Google 的 TTS API，以便在[此处](https://stackoverflow.com/questions/9243560/how-can-i-use-google-text-to-speech-api-in-windows-form/9243705#9243705)回答问题：

```
bool waiting = false;
AutoResetEvent stop = new AutoResetEvent(false);
public void PlayMp3FromUrl(string url, int timeout)
{
    using (Stream ms = new MemoryStream())
    {
        using (Stream stream = WebRequest.Create(url)
            .GetResponse().GetResponseStream())
        {
            byte[] buffer = new byte[32768];
            int read;
            while ((read = stream.Read(buffer, 0, buffer.Length)) > 0)
            {
                ms.Write(buffer, 0, read);
            }
        }
        ms.Position = 0;
        using (WaveStream blockAlignedStream =
            new BlockAlignReductionStream(
                WaveFormatConversionStream.CreatePcmStream(
                    new Mp3FileReader(ms))))
        {
            using (WaveOut waveOut = new WaveOut(WaveCallbackInfo.FunctionCallback()))
            {
                waveOut.Init(blockAlignedStream);
                waveOut.PlaybackStopped += (sender, e) =>
                {
                    waveOut.Stop();
                };
                waveOut.Play();
                waiting = true;
                stop.WaitOne(timeout);
                waiting = false;
            }
        }
    }
} 
```

调用：

```
var playThread = new Thread(timeout => PlayMp3FromUrl("http://translate.google.com/translate_tts?q=" + HttpUtility.UrlEncode(relatedLabel.Text), (int)timeout));
playThread.IsBackground = true;
playThread.Start(10000); 
```

终止：

```
if (waiting)
    stop.Set(); 
```

请注意，我`ParameterizedThreadDelegate`在上面的代码中使用了 ，并且线程以`playThread.Start(10000);`. 10000 表示最多播放 10 秒的音频，因此如果您的流播放时间超过播放时间，则需要对其进行调整。这是必要的，因为当前版本的 NAudio (v1.5.4.0) 似乎在确定流何时完成播放时存在问题。它可能会在以后的版本中得到修复，或者可能有一个我没有花时间找到的解决方法。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-19T22:25:02.227

NAudio 封装了 WaveOutXXXX API。我还没有查看源代码，但是如果 NAudio 以一种不会在每次调用时自动停止播放的方式公开 waveOutWrite() 函数，那么您应该能够做您真正想做的事情，即开始播放在您收到所有数据之前的音频流。

使用 waveOutWrite() 函数允许您“预读”并将较小的音频块转储到输出队列中 - Windows 将自动无缝播放这些块。您的代码必须获取压缩的音频流并将其动态转换为小块 WAV 音频；这部分真的很难——我见过的所有库和组件一次将整个文件进行 MP3 到 WAV 的转换。可能您唯一现实的机会是使用 WMA 而不是 MP3 来执行此操作，因为您可以围绕多媒体 SDK 编写简单的 C# 包装器。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-11-12T20:18:25.783

我没有从 WebRequest 尝试过，但[Windows Media Player ](http://en.wikipedia.org/wiki/Windows_Media_Player) [ActiveX](http://en.wikipedia.org/wiki/ActiveX)和 MediaElement（来自[WPF](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)）组件都能够播放和缓冲 MP3 流。

我用它来播放来自[SHOUTcast](https://en.wikipedia.org/wiki/SHOUTcast)流的数据，效果很好。但是，我不确定它是否适用于您提出的方案。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2010-08-24T19:42:51.923

我包装了 MP3 解码器库，并将其作为[mpg123.net提供给](http://sourceforge.net/projects/mpg123net/)[.NET](http://en.wikipedia.org/wiki/.NET_Framework)开发人员。

包括将 MP3 文件转换为[PCM](https://en.wikipedia.org/wiki/Pulse-code_modulation)和读取[ID3](https://en.wikipedia.org/wiki/ID3)标签的示例。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-11-07T09:16:25.057

我一直将 FMOD 用于此类事情，因为它可以免费用于非商业用途并且运行良好。

也就是说，我很乐意改用更小（FMOD 约为 300k）和开源的东西。如果它是完全管理的，那么我可以将它与我的 .exe 编译/合并，而不必特别注意获得对其他平台的可移植性......

（FMOD 也具有可移植性，但您显然需要针对不同平台使用不同的二进制文件）

# asp.net - ASP.NET：w3wp 正在使用大量内存并且进程没有响应

> ID：184688
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-08T20:20:35.273
> 
>         
> 
> 标签：asp.net, .net, debugging, w3wp

有人可以给我一步一步的说明或以正确的顺序指向正确的参考吗

这样我就可以确定这个问题的根本原因？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:23:14.033

您可以获取进程的内存转储并查看 WinDbg。它至少会给你一个异常列表和线程的当前状态。这样做会回收该过程。也可以从 Visual Studio 以远程调试模式连接到 QA 风格的机器。但是我没有这样做，它会在您调试时挂起所有其他请求。

如果 w3wp 在本地运行，可以在任务管理器中右键单击该进程，选择调试，在 WinDbg 中查看。否则，您希望在生产/测试机器上使用 Debug Diag 之类的东西来创建完整的用户转储。请参阅： http: [//msdnrss.thecoderblogs.com/2008/05/21/debugdiag-11-or-windbg-which-one-should-i-use-and-how-do-i-gather-memory-dumps/](http://msdnrss.thecoderblogs.com/2008/05/21/debugdiag-11-or-windbg-which-one-should-i-use-and-how-do-i-gather-memory-dumps/)

我在二月份就做了这一切，从那以后就不需要了。由于获取 WinDbg 的符号和配置环境变量的存储位置等，整个步骤实际上有点痛苦。

有关为 ASP.NET 检查设置 WinDbg 的信息，请参阅本文：http:
 [//support.microsoft.com/kb/892277](http://support.microsoft.com/kb/892277)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:25:48.523

w3wp.exe 是与 ISS 中的应用程序池相关联的进程。如果您有多个应用程序池，您将运行多个 w3wp.exe 实例。

欲了解更多信息，请阅读[此](http://weblogs.asp.net/owscott/archive/2004/09/21/Which-w3wp.exe-process-belongs-to-which-App-Pool-in-IIS6.aspx)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-09T09:45:10.047

w3wp.exe 会因多种原因消耗大量内存。

*   处理大量请求

*   大量数据吞吐量（例如媒体处理）

*   内存泄漏

*   以上任意组合。

如果您怀疑前两个是问题，您将需要扩展系统（添加额外的服务器等）

随着时间的推移，内存泄漏会导致内存使用量逐渐增加。

如果您怀疑内存泄漏，可以考虑采取以下措施。

*   代码审查（特别关注静态对象和事件注册/注销）

*   分析：分析内存泄漏有时可能是一项艰巨的任务。确保在分析和检查长寿命对象时收集一段时间/请求的数据，并检查以确保它们的长寿命有效。

# php - 将 $_POST 中给出的字符串与 php 进行比较

> ID：184703
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-08T20:22:03.770
> 
>         
> 
> 标签：php, post, compare

我有一个发送大小东西的表格，我需要查看字符串等于什么，以便我可以相应地设置价格。当我尝试这样做时，它说它们不相等，并且我没有得到任何价格。这是我正在使用的代码：

```
if ($_POST['sizes'] == "Small ($30)"){$total = "30";}
if ($_POST['sizes'] == "Medium ($40)"){$total = "40";}
if ($_POST['sizes'] == "Large ($50)"){$total = "50";}
else {$total = $_POST['price'];} 
```

我在这里做错了什么？我可以回显 $_POST['sizes'] 它给了我这些东西之一。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-10-08T20:31:54.110

[Paul Dixon 说](https://stackoverflow.com/questions/184703/compare-strings-given-in-post-with-php/184737#184737)的是正确的。我是否还建议使用 switch 语句而不是笨重的 if 语句块（实际上其中有一个逻辑错误，我可能会添加 -不时`$total`总是相等）`$_POST['price']``'Large ($50)'`

```
<?php

switch ( $_POST['sizes'] )
{
    case 'Small ($30)' :
        $total = 30;
        break;
    case 'Medium ($40)' :
        $total = 40;
        break;
    case 'Large ($50)' :
        $total = 50;
        break;
    default:
        $total = $_POST['price'];
        break;
}

?> 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T20:34:52.390

这是 switch/case 语句的一个很好的候选，你的 'else' 是默认值。

此外，如果在 Medium 和 Large 上不使用 elseif，如果您的 $_POST['sizes'] 不是 Large，那么您的 $total 将始终为 $_POST['price']。这也可能让你失望。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:55:25.047

所以你知道，你的 if/else 的问题是最后一个 else 总是在发生。开关仍然更好，但您的代码应该是这样的：

```
if ($_POST['sizes'] == "Small ($30)") { $total = "30";
} else if ($_POST['sizes'] == "Medium ($40)") { $total = "40";
} else if ($_POST['sizes'] == "Large ($50)") { $total = "50";
} else { $total = $_POST['price']; } 
```

对于每个说问题在于 30 美元、40 美元等的人来说，事实并非如此。变量不能以数字开头，因此 PHP 将忽略 $40 等。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:27:12.840

尝试使用单引号

```
if ($_POST['sizes'] == 'Small ($30)'){$total = "30";}
elseif ($_POST['sizes'] == 'Medium ($40)'){$total = "40";}
elseif ($_POST['sizes'] == 'Large ($50)'){$total = "50";}
else {$total = $_POST['price'];} 
```

双引号字符串使用变量插值，因此 $ 符号变得有意义！有关如何在 PHP 中声明字符串文字的差异，请参阅[此手册页。](http://us2.php.net/manual/en/language.types.string.php)

（编辑以纠正逻辑错误 - 正如其他人指出的那样，这里的开关会更清晰）

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-04T00:01:58.717

或者，甚至比笨重的开关更好，您可以利用这个简单的逻辑并练习“数据驱动编程”：

```
$vals = array(
    'Small ($30)' => 30,
    'Medium ($40)' => 40,
    'Large ($50)' => 50
);

$total = array_key_exists($_POST['sizes'], $vals)
    ? $vals[$_POST['sizes']]
    : $_POST['price']; 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-04T00:13:50.583

除了此错误的实际原因之外，如果您使用了标签以外的其他值，则可以避免此错误，例如：

```
<select name="sizes">
    <option value="small">Small ($30)</option>
    <option value="meduim">Medium ($40)</option>
    <option value="large">Large ($50)</option>
</select> 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-03T23:51:38.490

$total 是一个字符串吗？

$total = "30"; 是字符串的语法。$总计 = 30; 对于数字是正确的。  

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-02-03T23:53:38.877

这里不是有安全漏洞吗？如果有人只是为默认条款提交他们想要的任何价格怎么办？

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-02-04T00:04:48.650

```
// remove any non-decimal characters from the front, then extract your value,
// then remove any trailing characters and cast to an integer
$total = (integer)preg_replace("/^\D*(\d+)\D.*/", "$1", $_POST['sizes']);
if (!$total) $total = $_POST['price']; 
```

# java - 是否可以在我进入 finally 块之前检测是否发生异常？

> ID：184704
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2008-10-08T20:22:05.817
> 
>         
> 
> 标签：java, exception-handling

在 Java 中，是否有一种优雅的方法可以在运行 finally 块之前检测是否发生异常？在处理“close()”语句时，通常需要在 finally 块中处理异常。理想情况下，我们希望维护两个异常并将它们向上传播（因为它们都可能包含有用的信息）。我能想到的唯一方法是在 try-catch-finally 范围之外有一个变量来保存对抛出异常的引用。然后将“已保存”异常与 finally 块中发生的任何异常一起传播。

有没有更优雅的方式来做到这一点？也许一个 API 调用会揭示这一点？

这是我正在谈论的一些粗略代码：

```
Throwable t = null; 
try {   
   stream.write(buffer); 
} catch(IOException e) {
    t = e;   //Need to save this exception for finally
    throw e;
} finally {   
    try {
       stream.close();   //may throw exception
   } catch(IOException e) {
      //Is there something better than saving the exception from the exception block?
      if(t!=null) {
         //propagate the read exception as the "cause"--not great, but you see what I mean.
         throw new IOException("Could not close in finally block: " + e.getMessage(),t);
      } else {
         throw e;  //just pass it up
      }    
   }//end close
} 
```

显然，还有许多其他类似的 kludges 可能涉及将异常保存为成员变量，从方法中返回它等等......但我正在寻找更优雅的东西。

也许类似`Thread.getPendingException()`或类似的东西？就此而言，其他语言是否有优雅的解决方案？

这个问题实际上是从[另一个问题](https://stackoverflow.com/questions/183499/is-there-a-preference-for-nested-trycatch-blocks#183572)的评论中产生的，该问题提出了一个有趣的问题。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2008-10-08T20:25:41.097

您关于在 try/catch/finally 范围之外设置变量的想法是正确的。

一次传播的异常不能超过一个。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-08-30T19:23:03.887

我不会使用布尔标志，而是存储对 Exception 对象的引用。这样，您不仅可以检查是否发生异常（如果没有发生异常，则对象将为 null），而且如果确实发生了异常，您还可以在 finally 块中访问异常对象本身。您只需要记住在所有 catch 块中设置错误对象（如果重新抛出错误）。

**我认为这是应该添加的缺少的 C# 语言功能。**  finally 块应该支持对基 Exception 类的引用，类似于 catch 块支持它的方式，以便对传播异常的引用可用于 finally 块。这**对编译器来说是一件容易的事**，**节省了我们****手动**创建本地异常变量的工作，并**记住**在重新抛出错误之前手动设置它的值，并防止我们在设置异常变量时**出错**不要重新抛出错误（请记住，这只是我们想让 finally 块可见的未捕获异常）。

```
finally (Exception main_exception)
{
    try
    {
        //cleanup that may throw an error (absolutely unpredictably)
    }
    catch (Exception err)
    {
        //Instead of throwing another error,
        //just add data to main exception mentioning that an error occurred in the finally block!
        main_exception.Data.Add( "finally_error", err );
        //main exception propagates from finally block normally, with additional data
    }
} 
```

如上所示......我希望 finally 块中可用的异常的原因是，如果我的 finally 块确实捕获了它自己的异常，那么不要**通过抛出新错误（坏）来覆盖主要异常**或者只是**忽略错误（也很糟糕）**，它可以将错误作为附加数据添加到原始错误中。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:23:20.353

你总是可以在你的捕获中设置一个布尔标志。我不知道有什么“巧妙”的方法可以做到这一点，但我更像是一个 .Net 人。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-10T09:21:12.357

使用日志...

```
try {   
   stream.write(buffer); 
} catch(IOException ex) {
    if (LOG.isErrorEnabled()) { // You can use log level whatever you want
        LOG.error("Something wrong: " + ex.getMessage(), ex);
    }
    throw ex;
} finally {   
    if (stream != null) {
        try {
            stream.close();
        } catch (IOException ex) {
            if (LOG.isWarnEnabled()) {
                LOG.warn("Could not close in finally block", ex);
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2010-12-21T18:32:20.890

在 vb.net 中，可以使用“Catch...When”语句来获取局部变量的异常，而无需实际捕获它。这有许多优点。其中：

1.  如果没有任何东西会“最终”捕获异常，则会从原始异常的位置触发未处理的异常陷阱。比在最后一次重新抛出时设置调试器陷阱要好得多，特别是因为调试可能需要的信息还没有超出范围或被“finally”语句清除。

2.  尽管重新抛出不会像“Throw Ex”那样清除堆栈跟踪，但它仍然经常会破坏堆栈跟踪。如果没有捕获到异常，堆栈跟踪将是干净的。

由于 vb 不支持此功能，因此编写 vb 包装器以在 C 中实现代码可能会有所帮助（例如，给定 MethodInvoker 和 Action(Of Exception)，在 "Try" 中执行 MethodInvoker，在 "最后”。

一个有趣的怪癖：Catch-When 可能会看到一个异常，该异常最终会被 finally 子句异常覆盖。在某些情况下，这可能是件好事；在其他情况下，它可能会令人困惑。无论如何，这是需要注意的。

# audio - 重复加载和保存压缩音频文件会降低质量吗？

> ID：184707
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T20:22:25.127
> 
>         
> 
> 标签：audio, compression

例如，jpeg 图像就是这种情况？mp3 或 ogg vorbis 音频文件怎么样？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-10-08T20:36:35.490

这一切都取决于“加载”和“保存”的定义。

如果有问题的程序实际上在加载时解码 mp3/ogg 并在保存时重新编码（这可以通过保存文件所需的明显时间来检测），那么是的 - 您可能会遇到质量下降。特别是如果编码使用不同的设置（较低的比特率等）。

另一方面，例如，无损 mp3 拆分器可以将 mp3 拆分为多个较小的 mp3，而无需重新编码。

所以你需要查阅相关软件的手册，没有通用的答案。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:42:21.640

如果您使用[有损编解码器](http://en.wikipedia.org/wiki/Lossy_compression)（ogg、mp3 和 jpeg 等都是有损的）并且您在保存时**重新编码**数据，那么是的，随着时间的推移（或者更确切地说是重复重新编码），将会质量损失。如果您只是“复制”文件，那么您将获得有损编码数据的精确副本，因此它应该与源文件相同。如果您担心音频保真度的损失，请考虑像[FLAC](http://en.wikipedia.org/wiki/FLAC)这样的无损格式。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:01:05.160

> 任何时候你使用有损压缩，你都会失去一些质量。如果你幸运的话，你第二次失去的大部分东西都已经在第一次失去了。

那是我的假设。每次的设置都是一样的。因此，例如，如果去除了高频，那么如果算法再次尝试去除它们，那么它应该没有任何区别。然而，音频压缩不仅仅是删除频率范围，这就是我问这个问题的原因。

是的，材料每次都重新编码。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:38:52.473

任何时候你使用有损压缩，你都会失去一些质量。如果你幸运的话，你第二次失去的大部分东西都已经在第一次失去了。

如果你很好奇，自己试试看 - 获取相同的 mp3 文件并反复加载和保存，然后与原始文件进行比较。我相信你很快就会知道的。

# language-agnostic - 深拷贝和浅拷贝有什么区别？

> ID：184710
> 
>         
> 
> 赞同：754
> 
>         
> 
> 时间：2008-10-08T20:22:42.850
> 
>         
> 
> 标签：language-agnostic, copy, deep-copy, shallow-copy

深拷贝和浅拷贝有什么区别？

* * *

## 回答 #1

> 赞同：973
> 
>             
> 
> 时间：2008-10-08T20:39:37.230

广度与深度；考虑以您的对象为根节点的引用树。

浅的：

![复制前](https://i.stack.imgur.com/49psq.png) ![浅拷贝](https://i.stack.imgur.com/qqE2L.png) ![浅完成](https://i.stack.imgur.com/cys27.png)

变量 A 和 B 指代不同的内存区域，当 B 分配给 A 时，这两个变量指代相同的内存区域。以后对其中一个内容的修改会立即反映在另一个内容中，因为它们共享内容。

深的：

![复制前](https://i.stack.imgur.com/DRLn7.png) ![深度复制](https://i.stack.imgur.com/yuURM.png) ![深度完成](https://i.stack.imgur.com/i6yAt.png)

变量 A 和 B 指的是不同的内存区域，当 B 分配给 A 时，A 指向的内存区域中的值被复制到 B 指向的内存区域中。以后对内容的修改对于 A 或 B 仍然是唯一的；内容不共享。

* * *

## 回答 #2

> 赞同：877
> 
>             
> 
> 时间：2008-10-08T20:29:36.737

浅拷贝尽可能少地重复。集合的浅拷贝是集合结构的副本，而不是元素的副本。使用浅拷贝，两个集合现在共享单个元素。

深拷贝复制一切。集合的深层副本是两个集合，其中原始集合中的所有元素都重复。  

* * *

## 回答 #3

> 赞同：173
> 
>             
> 
> 时间：2008-10-08T20:24:11.427

简而言之，这取决于什么指向什么。在浅拷贝中，对象 B 指向对象 A 在内存中的位置。在深拷贝中，对象 A 的内存位置中的所有内容都被复制到对象 B 的内存位置。

这篇 wiki 文章有一个很棒的图表。

[http://en.wikipedia.org/wiki/Object_copy](http://en.wikipedia.org/wiki/Object_copy)

* * *

## 回答 #4

> 赞同：172
> 
>             
> 
> 时间：2016-06-15T08:42:14.303

尝试考虑下图

[![在此处输入图像描述](https://i.stack.imgur.com/AWKJa.jpg)](https://i.stack.imgur.com/AWKJa.jpg)

例如**Object.MemberwiseClone**创建一个**浅**拷贝[链接](https://msdn.microsoft.com/en-us/library/system.object.memberwiseclone(v=vs.110).aspx)

并使用**ICloneable**接口，您可以获得**深度复制，如此**[处](https://stackoverflow.com/a/78612/1074179)所述

* * *

## 回答 #5

> 赞同：72
> 
>             
> 
> 时间：2013-01-23T11:43:08.917

**特别是对于 iOS 开发者：** 

如果`B`是 的**浅拷贝**，`A`那么对于原始数据来说它就像是`B = [A assign];`，对于对象它就像`B = [A retain]`;

*B 和 A 指向同一个内存位置*

如果`B`是 的**深拷贝**，`A`那么就像`B = [A copy];`

*B 和 A 指向不同的内存位置*

*B 内存地址与 A 相同*

*B 与 A 的内容相同*

* * *

## 回答 #6

> 赞同：67
> 
>             
> 
> 时间：2008-10-08T20:25:36.947

浅拷贝：将成员值从一个对象复制到另一个对象。

深度复制：将成员值从一个对象复制到另一个对象。

                     任何指针对象都会被复制和深度复制。

例子：

```
class String
{
     int   size;
     char* data;
};

String  s1("Ace");   // s1.size = 3 s1.data=0x0000F000

String  s2 = shallowCopy(s1);
 // s2.size =3 s2.data = 0X0000F000
String  s3 = deepCopy(s1);
 // s3.size =3 s3.data = 0x0000F00F
 //                      (With Ace copied to this location.) 
```

* * *

## 回答 #7

> 赞同：54
> 
>             
> 
> 时间：2014-03-19T06:15:12.810

只是为了便于理解，您可以关注这篇文章：
 [https ://www.cs.utexas.edu/~scottm/cs307/handouts/deepCopying.htm](https://www.cs.utexas.edu/~scottm/cs307/handouts/deepCopying.htm)

* * *

**浅拷贝：**

[![浅拷贝](https://i.stack.imgur.com/nJJ6K.gif)](https://i.stack.imgur.com/nJJ6K.gif) 

* * *

**深拷贝：**

[![深拷贝](https://i.stack.imgur.com/R6Jlg.gif)](https://i.stack.imgur.com/R6Jlg.gif)

* * *

## 回答 #8

> 赞同：50
> 
>             
> 
> 时间：2008-10-08T20:36:03.447

我在这里没有看到一个简短易懂的答案——所以我会试一试。

对于浅拷贝，源指向的任何对象也被目标指向（因此不会复制引用的对象）。

对于深拷贝，源指向的任何对象都会被拷贝，而目标指向的拷贝会被拷贝（所以现在每个被引用的对象都有 2 个）。这会沿着对象树递归。

* * *

## 回答 #9

> 赞同：38
> 
>             
> 
> 时间：2013-01-31T23:39:18.347

{想象两个对象：相同类型的 A 和 B _t（相对于 C++）并且您正在考虑将 A 浅/深复制到 B}

**浅拷贝：**
简单地将 A 的引用复制到 B 中。将其视为 A 的地址的副本。因此，A 和 B 的地址将相同，即它们将指向相同的内存位置，即数据内容。

**深拷贝：**
简单地对A的所有成员进行拷贝，在不同的位置为B分配内存，然后将拷贝的成员分配给B，实现深拷贝。这样，如果 A 变得不存在，B 在内存中仍然有效。使用的正确术语是克隆，您知道它们完全相同，但又不同（即在内存空间中存储为两个不同的实体）。您还可以提供克隆包装器，您可以在其中通过包含/排除列表决定在深度复制期间选择哪些属性。当您创建 API 时，这是很常见的做法。

**仅当**您了解所涉及的风险时，您才可以选择进行浅拷贝。当您在 C++ 或 C 中处理大量指针时，对对象进行浅拷贝**真的**是个坏主意。

**示例_OF_DEEP COPY_**一个示例是，当您尝试进行图像处理和对象识别时，您需要将“不相关和重复运动”从您的处理区域中屏蔽掉。如果您使用的是图像指针，那么您可能有保存这些蒙版图像的规范。现在...如果您对图像进行浅拷贝，当指针引用从堆栈中被 KILLED 时，您将丢失引用及其副本，即在某些时候会出现访问冲突的运行时错误。在这种情况下，您需要的是通过 CLONING 获得图像的深层副本。通过这种方式，您可以检索掩码以备将来需要时使用。

**示例_OF_SHALLOW_COPY**与 StackOverflow 中的用户相比，我的知识不是很丰富，所以请随意删除这部分并举一个很好的例子，如果你能澄清的话。但我真的认为，如果您知道您的程序将运行无限时间，即通过函数调用在堆栈上进行连续“push-pop”操作，那么执行浅拷贝不是一个好主意。如果您正在向业余或新手演示某些东西（例如 C/C++ 教程的东西），那么它可能没问题。但是，如果您正在运行诸如监视和检测系统或声纳跟踪系统之类的应用程序，则不应该对对象进行浅层复制，因为它迟早会杀死您的程序。

* * *

## 回答 #10

> 赞同：35
> 
>             
> 
> 时间：2008-10-08T20:32:49.210

```
char * Source = "Hello, world.";

char * ShallowCopy = Source;    

char * DeepCopy = new char(strlen(Source)+1);
strcpy(DeepCopy,Source); 
```

“ShallowCopy”指向与“Source”相同的内存位置。“DeepCopy”指向内存中的不同位置，但内容相同。

* * *

## 回答 #11

> 赞同：32
> 
>             
> 
> 时间：2014-12-18T06:55:14.283

**什么是浅拷贝？**

浅拷贝是对象的按位拷贝。创建一个新对象，该对象具有原始对象中值的精确副本。如果对象的任何字段是对其他对象的引用，则仅复制引用地址，即仅复制内存地址。![浅拷贝](https://i.stack.imgur.com/LnDQh.png)

在此图中，`MainObject1`具有`field1`int 类型和`ContainObject1`类型的字段`ContainObject`。当您执行 , 的浅拷贝时`MainObject1`，`MainObject2`创建时`field2`包含复制的值`field1`并仍指向`ContainObject1`自身。请注意，since `field1`is 是原始类型，它的值被复制到，`field2`但 since`ContainedObject1`是一个对象，`MainObject2`仍然指向`ContainObject1`. `ContainObject1`因此，对in所做的任何更改`MainObject1`都将反映在`MainObject2`.

现在如果这是浅拷贝，让我们看看什么是深拷贝？

**什么是深拷贝？**

深拷贝复制所有字段，并复制字段指向的动态分配内存。当一个对象连同它所引用的对象一起被复制时，就会发生深拷贝。 
![深拷贝](https://i.stack.imgur.com/kocda.png)

在此图中，MainObject1 具有`field1`int 类型和`ContainObject1`类型的字段`ContainObject`。当您对 进行深层复制时`MainObject1`，`MainObject2`会创建`field2`包含 的复制值`field1`和`ContainObject2`的复制值`ContainObject1`。`ContainObject1`请注意，对in所做的任何更改`MainObject1`都不会反映在`MainObject2`.

[好文章](http://www.jusfortechies.com/java/core-java/deepcopy_and_shallowcopy.php)

* * *

## 回答 #12

> 赞同：16
> 
>             
> 
> 时间：2008-10-08T20:57:01.737

在面向对象编程中，类型包括成员字段的集合。这些字段可以按值或按引用（即指向值的指针）存储。

在浅拷贝中，创建该类型的新实例并将值复制到新实例中。引用指针也像值一样被复制。因此，引用指向原始对象。对通过引用存储的成员的任何更改都会出现在原始和副本中，因为没有对引用的对象进行复制。

在深拷贝中，按值存储的字段像以前一样被复制，但指向按引用存储的对象的指针不会被复制。取而代之的是，对引用的对象进行深层复制，并存储指向新对象的指针。对这些引用对象所做的任何更改都不会影响该对象的其他副本。

* * *

## 回答 #13

> 赞同：14
> 
>             
> 
> 时间：2014-09-16T09:50:16.050

**深拷贝**

深拷贝复制所有字段，并复制字段指向的动态分配内存。当一个对象连同它所引用的对象一起被复制时，就会发生深拷贝。

**浅拷贝**

浅拷贝是对象的按位拷贝。创建一个新对象，该对象具有原始对象中值的精确副本。如果对象的任何字段是对其他对象的引用，则仅复制引用地址，即仅复制内存地址。

* * *

## 回答 #14

> 赞同：13
> 
>             
> 
> 时间：2011-02-21T13:44:43.870

“ShallowCopy”指向与“Source”相同的内存位置。“DeepCopy”指向内存中的不同位置，但内容相同。

* * *

## 回答 #15

> 赞同：12
> 
>             
> 
> 时间：2017-09-26T04:29:22.720

**浅克隆：**

定义：“对象的浅拷贝复制‘主’对象，但不复制内部对象。” 当自定义对象（例如 Employee）只有原始的字符串类型变量时，您可以使用浅克隆。

```
Employee e = new Employee(2, "john cena");
Employee e2=e.clone(); 
```

你返回`super.clone();`被覆盖的 clone() 方法，你的工作就结束了。

**深度克隆**：

定义：“与浅拷贝不同，深度拷贝是对象的完全独立拷贝。” 

表示当一个 Employee 对象持有另一个自定义对象时：  

```
Employee e = new Employee(2, "john cena", new Address(12, "West Newbury", "Massachusetts"); 
```

然后您必须编写代码来克隆“地址”对象以及覆盖的 clone() 方法。否则，Address 对象将不会克隆，并且当您更改克隆的 Employee 对象中的 Address 值时会导致错误，这也反映了原始对象。

* * *

## 回答 #16

> 赞同：12
> 
>             
> 
> 时间：2018-01-24T06:52:46.793

我想举个例子而不是正式的定义。

```
var originalObject = { 
    a : 1, 
    b : 2, 
    c : 3,
}; 
```

这段代码显示了一个**浅拷贝**：

```
var copyObject1 = originalObject;

console.log(copyObject1.a);         // it will print 1 
console.log(originalObject.a);       // it will also print 1 
copyObject1.a = 4; 
console.log(copyObject1.a);           //now it will print 4 
console.log(originalObject.a);       // now it will also print 4

var copyObject2 = Object.assign({}, originalObject);

console.log(copyObject2.a);        // it will print 1 
console.log(originalObject.a);      // it will also print 1 
copyObject2.a = 4; 
console.log(copyObject2.a);        // now it will print 4 
console.log(originalObject.a);      // now it will print 1 
```

这段代码显示了一个**深拷贝**：

```
var copyObject2 = Object.assign({}, originalObject);

console.log(copyObject2.a);        // it will print 1 
console.log(originalObject.a);      // it will also print 1 
copyObject2.a = 4; 
console.log(copyObject2.a);        // now it will print 4 
console.log(originalObject.a);      // !! now it will print 1 !! 
```

* * *

## 回答 #17

> 赞同：10
> 
>             
> 
> 时间：2008-10-08T20:34:11.390

```
var source = { firstName="Jane", lastname="Jones" };
var shallow = ShallowCopyOf(source);
var deep = DeepCopyOf(source);
source.lastName = "Smith";
WriteLine(source.lastName); // prints Smith
WriteLine(shallow.lastName); // prints Smith
WriteLine(deep.lastName); // prints Jones 
```

* * *

## 回答 #18

> 赞同：9
> 
>             
> 
> 时间：2015-05-07T07:12:45.217

**浅拷贝**- 原始对象和浅拷贝对象中的引用变量引用了**公共**对象。

**深度复制**- 原始对象和深度复制对象内的引用变量引用了**不同的**对象。

> 克隆总是做浅拷贝。

```
public class Language implements Cloneable{

    String name;
    public Language(String name){
        this.name=name;
    }

    public String getName() {
        return name;
    }

    @Override
    protected Object clone() throws CloneNotSupportedException {
        return super.clone();
    }
} 
```

主要课程如下 -

```
public static void main(String args[]) throws ClassNotFoundException, CloneNotSupportedException{

      ArrayList<Language> list=new ArrayList<Language>();
      list.add(new Language("C"));
      list.add(new Language("JAVA"));

      ArrayList<Language> shallow=(ArrayList<Language>) list.clone();
      //We used here clone since this always shallow copied.

      System.out.println(list==shallow);

      for(int i=0;i<list.size();i++)
      System.out.println(list.get(i)==shallow.get(i));//true

      ArrayList<Language> deep=new ArrayList<Language>();
      for(Language language:list){
          deep.add((Language) language.clone());
      }
      System.out.println(list==deep);
      for(int i=0;i<list.size();i++)
          System.out.println(list.get(i)==deep.get(i));//false

} 
```

以上的输出将是-

> 假 真 真
> 
> 假 假 假

对原始对象所做的任何更改都将反映在浅对象而不是深对象中。

```
 list.get(0).name="ViSuaLBaSiC";
  System.out.println(shallow.get(0).getName()+"  "+deep.get(0).getName()); 
```

**输出 - ViSuaLBaSiC** C

* * *

## 回答 #19

> 赞同：8
> 
>             
> 
> 时间：2015-05-29T00:41:37.543

想象一下，有两个数组称为 arr1 和 arr2。

```
arr1 = arr2;   //shallow copy
arr1 = arr2.clone(); //deep copy 
```

* * *

## 回答 #20

> 赞同：7
> 
>             
> 
> 时间：2011-12-02T00:55:15.720

简单来说，浅拷贝类似于按引用调用，深拷贝类似于按值调用

在引用调用中，函数的形参和实参都引用相同的内存位置和值。

在按值调用中，函数的形参和实参都指不同的内存位置但具有相同的值。

* * *

## 回答 #21

> 赞同：7
> 
>             
> 
> 时间：2018-01-20T07:37:56.130

浅拷贝构造一个新的复合对象并将其引用插入到原始对象中。

与浅拷贝不同，深拷贝构造新的复合对象并插入原始复合对象的原始对象的副本。

让我们举个例子。

```
import copy
x =[1,[2]]
y=copy.copy(x)
z= copy.deepcopy(x)
print(y is z) 
```

上面的代码打印 FALSE。

让我们看看如何。

原始复合对象`x=[1,[2]]`（称为复合对象，因为它在对象内部有对象（Inception））

[![在此处输入图像描述](https://i.stack.imgur.com/QtsjW.png)](https://i.stack.imgur.com/QtsjW.png)

正如您在图像中看到的，列表中有一个列表。

然后我们使用`y = copy.copy(x)`. python在这里所做的是，它将创建一个新的复合对象，但其中的对象指向原始对象。

[![在此处输入图像描述](https://i.stack.imgur.com/QLeDN.png)](https://i.stack.imgur.com/QLeDN.png)

在图像中，它为外部列表创建了一个新副本。但内部列表与原始列表相同。

现在我们使用`z = copy.deepcopy(x)`. python在这里所做的是，它将为外部列表和内部列表创建新对象。如下图所示（红色突出显示）。

[![在此处输入图像描述](https://i.stack.imgur.com/4fYHO.png)](https://i.stack.imgur.com/4fYHO.png)

最后打印代码`False`，因为 y 和 z 不是相同的对象。

HTH。

* * *

## 回答 #22

> 赞同：5
> 
>             
> 
> 时间：2011-08-26T06:33:10.730

```
struct sample
{
    char * ptr;
}
void shallowcpy(sample & dest, sample & src)
{
    dest.ptr=src.ptr;
}
void deepcpy(sample & dest, sample & src)
{
    dest.ptr=malloc(strlen(src.ptr)+1);
    memcpy(dest.ptr,src.ptr);
} 
```

* * *

## 回答 #23

> 赞同：4
> 
>             
> 
> 时间：2016-09-29T16:44:06.330

要为其他答案添加更多内容，

*   对象的浅拷贝对基于值类型的属性执行按值复制，对基于引用类型的属性执行按引用复制。

*   对象的深层复制对基于值类型的属性执行按值复制，以及对层次结构深处（引用类型的）基于引用类型的属性执行按值复制

* * *

## 回答 #24

> 赞同：4
> 
>             
> 
> 时间：2017-03-06T09:50:53.450

浅拷贝不会创建新引用，但深拷贝会创建新引用。

这是解释深拷贝和浅拷贝的程序。

```
public class DeepAndShollowCopy {
    int id;
    String name;
    List<String> testlist = new ArrayList<>();

    /*
    // To performing Shallow Copy 
    // Note: Here we are not creating any references. 
      public DeepAndShollowCopy(int id, String name, List<String>testlist)
       { 

       System.out.println("Shallow Copy for Object initialization");
       this.id = id; 
       this.name = name; 
       this.testlist = testlist; 

       }
    */  

    // To performing Deep Copy 
    // Note: Here we are creating one references( Al arraylist object ). 
    public DeepAndShollowCopy(int id, String name, List<String> testlist) {
        System.out.println("Deep Copy for Object initialization");
        this.id = id;
        this.name = name;
        String item;
        List<String> Al = new ArrayList<>();
        Iterator<String> itr = testlist.iterator();
        while (itr.hasNext()) {
            item = itr.next();
            Al.add(item);
        }
        this.testlist = Al;
    }

    public static void main(String[] args) {
        List<String> list = new ArrayList<>();
        list.add("Java");
        list.add("Oracle");
        list.add("C++");
        DeepAndShollowCopy copy=new DeepAndShollowCopy(10,"Testing", list);
        System.out.println(copy.toString());
    }
    @Override
    public String toString() {
        return "DeepAndShollowCopy [id=" + id + ", name=" + name + ", testlist=" + testlist + "]";
    }
} 
```

* * *

## 回答 #25

> 赞同：3
> 
>             
> 
> 时间：2014-03-07T08:39:42.833

取自[博客]：[http ://sickprogrammersarea.blogspot.in/2014/03/technical-interview-questions-on-c_6.html](http://sickprogrammersarea.blogspot.in/2014/03/technical-interview-questions-on-c_6.html)

**深拷贝**涉及使用一个对象的内容来创建同一类的另一个实例。在深拷贝中，两个对象可能包含相同的信息，但目标对象将拥有自己的缓冲区和资源。任何一个对象的破坏都不会影响剩余的对象。重载的赋值运算符将创建对象的深层副本。

**浅拷贝**涉及将一个对象的内容复制到同一类的另一个实例中，从而创建镜像。由于引用和指针的直接复制，两个对象将共享另一个对象的相同外部包含的内容，这是不可预测的。

**解释：**

使用复制构造函数，我们只需逐个复制数据值。这种复制方法称为浅拷贝。如果对象是一个简单的类，由内置类型和没有指针组成，这是可以接受的。这个函数将使用值和对象，并且它的行为不会被浅拷贝改变，只有作为成员的指针的地址被复制，而不是地址指向的值。然后对象的数据值会被函数无意中更改。当函数超出范围时，对象的副本及其所有数据都会从堆栈中弹出。

如果对象有任何指针，则需要执行深拷贝。使用对象的深层副本，为自由存储中的对象分配内存并复制指向的元素。深层副本用于从函数返回的对象。

* * *

## 回答 #26

> 赞同：3
> 
>             
> 
> 时间：2018-07-28T12:54:40.093

我从以下几行中了解到。

浅拷贝将对象**值类型**（int、float、bool）字段复制到目标对象中，并且对象的引用类型（字符串、类等）被复制为目标对象中的**引用**。在这个目标中，引用类型将指向源对象的内存位置。

深拷贝将对象的值和引用类型复制到目标对象的全新副本中。这意味着值类型和引用类型都将被分配一个新的内存位置。

* * *

## 回答 #27

> 赞同：2
> 
>             
> 
> 时间：2013-08-08T08:32:02.580

**浅**拷贝是创建一个新对象，然后将当前对象的非静态字段复制到新对象中。如果一个字段是一个值类型 --> 对该字段进行逐位复制；对于**引用类型**--> 引用被复制但被引用的对象不是；因此原始对象及其克隆引用同一个对象。

**深**拷贝是创建一个新对象，然后将当前对象的非静态字段复制到新对象。如果字段是**值类型**--> 将执行该字段的逐位复制。如果字段是**引用类型**--> 执行引用对象的新副本。要克隆的类必须标记为 [Serializable]。

* * *

## 回答 #28

> 赞同：1
> 
>             
> 
> 时间：2012-12-19T21:23:50.067

复制数组：

Array 是一个类，这意味着它是引用类型，因此 array1 = array2 导致两个变量引用同一个数组。

但是看看这个例子：

```
 static void Main()
    {
        int[] arr1 = new int[] { 1, 2, 3, 4, 5 }; 
        int[] arr2 = new int[] { 6, 7, 8, 9, 0 };

        Console.WriteLine(arr1[2] + " " + arr2[2]);
        arr2 = arr1;
        Console.WriteLine(arr1[2] + " " + arr2[2]); 
        arr2 = (int[])arr1.Clone();
        arr1[2] = 12;
        Console.WriteLine(arr1[2] + " " + arr2[2]);
    } 
```

**浅克隆**意味着只复制克隆数组所代表的内存。  

**如果数组包含值类型对象，则复制这些值**；

**如果数组包含引用类型，则仅复制引用 - 因此有两个数组的成员引用相同的对象**。

要创建深层副本——引用类型重复，您必须遍历数组并手动克隆每个元素。

* * *

## 回答 #29

> 赞同：1
> 
>             
> 
> 时间：2014-02-08T13:11:55.020

复制构造函数用于用先前创建的同一类的对象来初始化新对象。默认情况下，编译器写了一个浅拷贝。当不涉及动态内存分配时，浅拷贝工作正常，因为当涉及动态内存分配时，两个对象将指向堆中的相同内存位置，因此为了解决这个问题，我们编写了深拷贝，因此两个对象都有自己的属性副本记忆中。为了阅读带有完整示例和解释的详细信息，您可以查看文章[C++ 构造函数](http://www.hellgeeks.com/constructors-and-destructors/)。

* * *

## 回答 #30

> 赞同：1
> 
>             
> 
> 时间：2017-01-12T06:10:35.523

为了在浅拷贝和简单地为列表分配一个新的变量名之间增加一点混淆。

“假设我们有：

```
x = [
    [1,2,3],
    [4,5,6],
    ] 
```

此语句创建 3 个列表：2 个内部列表和一个外部列表。然后以名称 x 提供对外部列表的引用。如果我们这样做

```
y = x 
```

没有数据被复制。我们在内存中的某个地方仍然有相同的 3 个列表。所有这一切都是使外部列表在名称 y 下可用，除了它以前的名称 x。如果我们这样做

```
y = list(x) 
```

或者

```
y = x[:] 
```

这将创建一个与 x 具有相同内容的新列表。列表 x 包含对 2 个内部列表的引用，因此新列表还将包含对相同的 2 个内部列表的引用。只复制一个列表——外部列表。现在内存中有4个列表，两个内部列表，外部列表和外部列表的副本。原始外部列表在名称 x 下可用，而新外部列表在名称 y 下可用。

内部列表没有被复制！此时您可以从 x 或 y 访问和编辑内部列表！

如果您有一个二维（或更高）列表或任何类型的嵌套数据结构，并且您想要制作所有内容的完整副本，那么您想要使用复制模块中的 deepcopy() 函数。您的解决方案也适用于二维列表，因为迭代外部列表中的项目并制作每个项目的副本，然后为所有内部副本构建一个新的外部列表。”

来源：[https ://www.reddit.com/r/learnpython/comments/1afldr/why_is_copying_a_list_so_damn_difficult_in_python/](https://www.reddit.com/r/learnpython/comments/1afldr/why_is_copying_a_list_so_damn_difficult_in_python/)

* * *

## 回答 #31

> 赞同：0
> 
>             
> 
> 时间：2013-12-20T19:01:50.567

除了上述所有定义之外，还有一种最常用的深拷贝，位于类的拷贝构造函数（或重载赋值运算符）中。

浅拷贝 --> 是当您不提供拷贝构造函数时。在这里，只有对象被复制，而不是类的所有成员都被复制。

深拷贝——>当你决定在你的类中实现拷贝构造函数或重载赋值并允许拷贝类的所有成员时。

```
MyClass& MyClass(const MyClass& obj) // copy constructor for MyClass
{
          // write your code, to copy all the members and return the new object
}
MyClass& operator=(const MyClass& obj) // overloading assignment operator,
{
          // write your code, to copy all the members and return the new object
} 
```

# c# - 如何在 ac# 应用程序中显示大的 pdf？

> ID：184721
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T20:24:09.650
> 
>         
> 
> 标签：c#, pdf

我有一个 windows c# 应用程序，我想在添加到我的表单的 acrobat com 对象中显示一个位于网络服务器上的 pdf 文件。

```
pdf.loadfile(@"http://somewhere.com/nowwhere.pdf") 
```

由于我的 pdf 很大，应用程序似乎一直挂起，直到整个文件加载完毕。

我想读取大文件，而用户不会感觉到应用程序已挂起。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T20:30:32.460

我会做以下事情：

1.  创建另一个线程以导入 pdf。

2.  向用户显示某种进度条。也许有一个取消按钮。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:29:02.150

三个建议。

第一个是打破它并像一些在线书籍一样一次加载一个页面。这有点烦人，但可以节省加载时间。我认为 ItextSharp 有一些功能可以做到这一点。

第二次尝试压缩。再次，itextsharp 有允许这样做的工具

我的第三个建议是查看[This thread](https://stackoverflow.com/questions/182112/funny-loading-statements-to-keep-users-amused)。选择一些书呆子加载短语并使用动画 gif 来分散您的客户对长时间加载的注意力。显然这是最后的手段，但可能有用。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:29:26.317

使用工作线程。（以BackgroundWorker 为例）

[MSDN Link to BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:05:24.370

如果 PDF.LoadFile 必须从 UI 线程运行，您可以使用 HttpWebRequest 在 BackgroundWorker 中下载文件，将其保存在本地，然后在 Invoke'd（UI 线程）函数中调用 pdf.loadfile()。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:46:15.143

显然，如果您可以使用后台线程来进行加载 - 您将一切就绪：

```
Pdf pdf;

void ShowPdf() {
   if (this.InvokeRequired) {
     this.Invoke(() => this.ShowPdf());
   }
   // give pdf a window...
}

void LoadPdf() {
   System.Threading.ThreadPool.QueueUserWorkItem(() => {
      pdf.LoadFile("http://example.com/somelarge.pdf");
      this.ShowPdf();
   });
} 
```

*那里可能*出现的问题（我从未使用过 Acrobat 的 COM PDF 查看器）是 PDF 对象需要在 UI 线程上。在这种情况下，您最终会遇到问题。

# xml - 为什么我会选择在关系数据库中存储和操作 XML？

> ID：184727
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2008-10-08T20:24:52.737
> 
>         
> 
> 标签：xml, rdbms

现代 RDBMS 支持 XML 列类型和在存储过程中处理 XML 的功能。从历史上看，我总是将分层数据（无论是 OO 对象还是 XML）映射到关系表。鉴于对 XML 的广泛数据库支持，我应该改变我的方式吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T20:59:34.850

我有一个很好的现实生活例子。我的一个客户经常从他们的供应商那里收到一个包含一些重要数据的 XML 文件。它嵌套很深。他们需要将其与之前的 XML 文件进行比较，以了解发生了哪些变化。如果数据库中没有 XML 支持，我必须构建一个工具来遍历 XML 节点并在关系数据库的表中查找匹配项。我可以使用一些 XML-XML 比较工具，但其中一些检查与其他一些不是来自 XML 文件的数据相关，我需要将所有这些数据结合在一起。好的，所有这一切都不是什么大不了的事，但仍然 - 使用 XML 数据库，您可以获得开箱即用的功能。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T20:33:23.763

如果您没有看到需要，请不要更改！

有时您必须持久化不具有已知结构的数据，或者其结构非常不稳定。在这些情况下，无需创建表，只需将 XML 保存到现有表中

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-09-01T10:49:13.743

我会再次使用它的唯一原因是何时可扩展性和灵活性。

如果可以避免，xml（xpath）和维护（命名空间）的开销真的不值得麻烦。我们之前在 xml 中存储了大量数据，并使用标量函数来检索它，但是它太慢了，并且导致 xml 结构或命名空间更改的巨大头痛。

但是灵活性很棒。您可以随时添加新属性，您可以在其中包含不需要适当列的项目/客户/作业特定数据。XML 不必处于静态结构中 - 您只需要一个可以生成实例的工厂来处理不同的 XML（这需要与项目/客户端/作业相关）。

当向现有系统添加新表时，尤其是现有数据很多且不易修改的系统时，我将添加一个 XML 列。将来，如果我需要向该表中添加另一列，我可以简单地利用 XML 列，而不必感到沮丧并不得不进行大量返工。

总之，您不是从将基本属性放入 XML 开始的。但是，当您知道您的表可能需要扩展时，您应该添加 XML，正是因为它为您提供了扩展选项。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-10-20T13:31:33.583

这是我工作的系统中的一个真实示例。我们有一个核心系统，并在 java 中创建客户特定的代码。根据正在交易的客户，可能会调用不同的类。有时，此自定义代码需要存储一些内容，我们将其放入相关表的 XML 列中。这使我们免于对阳光下的一切进行建模。添加新客户通常只意味着编写和安装 java 代码。

缺点是在 XML 列上报告、查询和更新更加困难。没有像检查约束等通常的良好数据库功能。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-09-01T10:26:49.950

我使用 XML 列类型来存储我们从第三方服务接收到的所有关键业务消息的副本。由于几个原因，它非常方便。

1）在数据损坏的情况下，我们可以回溯以查看何时以何种格式输入了哪些数据。

2) 系统的未来开发工作可以基于来自日志表的真实数据 - 只需反序列化并使用数据，就好像它来自对 3p 服务的调用

3) 确保基础设施人员忙于为数据库分配磁盘空间服务器。;)

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:55:12.877

例如，您从某个其他系统获取 XML 文档，这些文档具有您想要存储的非常丰富或复杂的结构；但是您只需要一些定义明确的查询来检索该数据。在这种情况下，只需解析生成一些索引所需的数据，并将整个 XML 结构存储在单个字段中。

为此，您不需要数据库引擎上有太多特定于 XML 的支持，但它仍然有助于保持查询的表达性。

除此之外，我猜想一些具有良好 XML 支持的 DMBS 可以让您简单地存储 XML 文档，也许无需指定如何对其进行索引。您只需使用 XQuery 并希望它以某种方式优化以满足您的需求。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-10-20T13:41:41.113

到目前为止，我还没有存储 XML 的需要，但我经常使用从存储过程返回 XML 的能力。它使一些东西非常有用——主要是报告。我可以运行一个 SP 来生成报告，以 XML 格式发回结果，然后使用 XSLT 很容易地在网站上显示结果。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:32:02.487

假设您有一个具有属性的实体。您可以将所有这些属性存储在 XML 中，而不是创建单独的属性表。XML 会更灵活。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:39:56.513

您可以**直接在 SQL Server 中处理 XML 数据**。例如，您可以应用 XPath 表达式并将过滤后的结果集发送到客户端。SQL Server 功能以后可以建立在 XML 处理能力的基础上。

上述功能**来自 MS SQL Server 2000**或 2005。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:26:54.697

您可以在其中存储用户生成的 XML。

如果像 stackoverflow 这样的网站使用某种 XML 标记而不是标记，您可以将问题/答案作为 XML 存储在数据库中。您可能会发现自己试图解析这个用户生成的 XML 以寻找专有标签。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:36:17.503

灵活性是原因之一。

如果您的数据结构可以变化，那么您仍然可以保留一个通用的 RDBMS 表，以及查询等，这些表与结构有些可变的数据一起使用。

如果您需要在某个时候添加字段，您可以在不更改 RDMS 表结构的情况下执行此操作，从而不会破坏其他所有人的查询。

# tdd - 作为一名“mockist”TDD 从业者，我是否应该在与被测方法相同的类中模拟其他方法？

> ID：184729
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2008-10-08T20:25:11.503
> 
>         
> 
> 标签：tdd, mocking

在阅读 Martin Fowler 的[Mocks Aren't Stubs](http://martinfowler.com/articles/mocksArentStubs.html)之后，我发现我一直在以“mockist”的方式练习 TDD。

但我想知道，即使在 mockist TDD 中，如果一个人可以把嘲笑做得太过分。

这是Python 风格的伪代码的**更新示例：**

```
def sync_path(self):
    if self.confirm_or_create_connection():
        self.sync(self.dirpath) 
```

confirm_or_create_connection() 方法创建到服务器的连接。

我在两个测试中测试了与此类似的方法，这两个测试都模拟了 confirm_or_create_connection() 和 sync() （即使它们都是同一个类中的方法）。在一个测试中，mock confirm_or_create_connection() 返回 True 并且测试确认 sync() 被调用，而在另一个测试中 mock confirm_or_create_connection() 返回 False 并且测试确认 sync() 没有被调用。

这合理吗？或者我应该模拟 confirm_or_create_connection() 和 sync() 调用的对象？（我已经对这两种方法进行了其他测试。）

请不要通过解释我应该练习“经典” TDD 来回答这个问题。这是另一个问题的答案：[我应该练习 mockist 还是经典 TDD？](https://stackoverflow.com/questions/184666/should-i-practice-mockist-or-classical-tdd)

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-23T16:37:48.950

出于某种原因，该技术被称为“模拟对象”，而不是“模拟方法”。它鼓励将系统划分为易于组合、协作的对象并远离程序代码的设计。目的是提高抽象级别，以便您主要通过组合对象进行编程，而很少编写低级控制流语句。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T21:07:14.617

就我个人而言，我认为嘲笑自我几乎总是一种代码味道。它正在测试实现而不是行为。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-05-15T18:52:32.163

编辑更新样本：

我现在明白了。你在测试这个类时遇到了问题，因为它有设计缺陷。这个类违反了单一职责原则。它正在做两件事。首先，它管理与数据库的连接。它也在同步。

您需要一个单独的类来管理您的数据库连接。该类将成为被测类的依赖项。当您对被测类进行单元测试时，可以伪造数据库连接类。

以前：

> 作为一名交互测试人员，如果您需要这样做，请考虑重构。那堂课可能做得太多了。
> 
>   
>   
> 
> 让我这样告诉你：调用私有方法不会进行交互。
> 
>   
>   
> 
> 这是TDD的要点之一。当它受到伤害时，您的设计可以得到改进。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:43:54.430

**为新示例编辑对**

我来说，您似乎在存根confirm_or_create_connection，您只对定义返回调用感兴趣并且您正在模拟同步，在这里您有兴趣测试它是否真的被调用。（我必须检查我对 stubbing 或 mocking 的定义是否与您引用的 fowler 文章相同。我已经有一段时间没有阅读它了，我一直在 c# 中使用 rhinomocks 可能有它自己的定义这些条款:-)）

我认为对于您正在测试的内容，模拟和存根这些调用是正确的方法。如果其中一个功能出现错误，您不想测试失败，还有其他测试。您只是想测试sync_path 的操作。

我同意 Avdi 的观点，即这有点臭。测试还可以，但你的班级可能做得太多了。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-21T16:48:55.050

疯狂地猜测，看起来连接活动可能属于另一个应该委托给的对象，在这种情况下你可以模拟*那个*. 我通常建议不要模拟对象的一部分来测试另一部分。它表明有两个概念被栓在一起。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-11-17T00:39:15.047

你能把嘲弄过分吗？我不知道太远，但它可能做得很糟糕，以至于你实际上是在测试模拟而不是代码，或者更糟糕的是你有脆弱的测试。

但只要你编写好的测试——确认你预期行为的测试，帮助你编写代码的测试——然后模拟！

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2010-02-19T17:46:15.903

这是一个很好的阅读：“原则：不要修改 SUT”，位于[http://xunitpatterns.com/Principles%20of%20Test%20Automation.html#Don](http://xunitpatterns.com/Principles%20of%20Test%20Automation.html#Don)

通过模拟或存根部分实现来修改您正在测试的类是一种代码味道。摆脱它的重构是将您正在模拟/存根的部分移动到另一个类。也就是说，它并不总是一件可怕的事情。它是一种代码气味，但并不总是不合适的。对于像 C# 或 Java 这样的语言，你有很好的重构工具，很容易修复这种代码气味，我通常会（在 C# 中，假设 Java 是相似的）。不过，我在 Lua 和 Javascript 中做了很多开发，但情况有些不同。用这些语言创建和管理大量类更加困难，因此我更能容忍在测试中修改 SUT。一旦最初的测试覆盖率在那里，我总是可以稍后修复它。它确实需要额外的照顾。

# windows - Skype 和终端服务信息交换？

> ID：184759
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-08T20:34:07.537
> 
>         
> 
> 标签：windows, macos, skype, terminal-services

我们有销售代表通过终端服务访问我们的“系统”。在我们的系统中，我们希望能够单击客户端的号码并在其本地计算机上启动 Skype，而不是在终端服务会话中。

我们看到了这种工作的两种潜在方式......

1.  单击一个 URL（例如 skype:01234569?call ），它可以在本地工作，但我们需要在 TS 会话中单击该 URL，但要在本地计算机上打开该 URL。

2.  或者类似 skype@IP_address:01234569?call 让目标 Skype 客户端拨打电话？

最后一件事，本地机器可能是 Mac 或 Windows PC。

再次感谢

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-10T07:39:52.717

选项1根本不起作用！

选项 2 听起来很有趣，但您可能会从[https://developers.skype.com](https://developers.skype.com)或[http://forum.skype.com/index.php?showforum=16得到明确的答案](http://forum.skype.com/index.php?showforum=16)

# xml - 如何使用 Flex 从服务器读取 XML 数据？

> ID：184766
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-08T20:34:53.357
> 
>         
> 
> 标签：xml, apache-flex, web-applications

我相信以 XML 格式从服务器请求数据的最简单方法是拥有一个 PHP/JSP/ASP.net 页面，该页面实际上基于 HTTP GET 参数生成 XML，并以某种方式从 Flex 调用/加载此页面。

究竟如何使用 Flex 库类来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-09T06:10:08.780

我想补充一点，您也可以使用[mx:HTTPService](http://livedocs.adobe.com/flex/201/langref/mx/rpc/http/mxml/HTTPService.html)。如果您指定 returnFormat 属性，您将获得一个 XML 文档而不是简单文本：

```
<mx:HTTPService resultFormat="e4x" ..../> or <mx:HTTPService resultFormat="xml" .../> 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:50:40.300

我知道你已经找到了，但这里有一些示例代码：

```
public var dataRequest:URLRequest;
public var dataLoader:URLLoader;
public var allowCache:Boolean;

dataLoader = new URLLoader();
dataLoader.addEventListener(Event.COMPLETE, onComplete);
dataLoader.addEventListener(ProgressEvent.PROGRESS, onProgress);
dataLoader.addEventListener(IOErrorEvent.IO_ERROR, onIOError);
dataLoader.addEventListener(SecurityErrorEvent.SECURITY_ERROR, onSecurityError);
dataLoader.addEventListener(HTTPStatusEvent.HTTP_STATUS, onHTTPStatus);

dataRequest = new URLRequest();
dataRequest.url = "xmlfilelocation.xml" + ((this.allowCache) ? "" : "?cachekiller=" + new Date().valueOf());

dataLoader.load(dataRequest);

public function onComplete(event:Event):void{
    trace("onComplete");
}
public function onProgress(event:ProgressEvent):void{
    trace("onProgress");
}
public function onIOError(event:IOErrorEvent):void{
    trace("onIOError");
}
public function onSecurityError(event:SecurityErrorEvent):void{
    trace("onSecurityError");
}
public function onHTTPStatus(event:HTTPStatusEvent):void{
    trace("onHTTPStatus");
} 
```

我喜欢添加“allowCache”，因为 Flash/Flex 在您不希望缓存此类内容时非常糟糕。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:40:34.390

没关系，找到它： http: [//livedocs.adobe.com/flex/3/langref/flash/net/URLLoader.html](http://livedocs.adobe.com/flex/3/langref/flash/net/URLLoader.html)

# user-interface - UI 设计/工作流程：更改多个对象的相同属性

> ID：184773
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T20:36:58.517
> 
>         
> 
> 标签：user-interface, workflow, user-experience

我正在寻找一个通用的 UI 设计/工作流程来更改多个对象的相同属性。  

假设我有一个名为 Person 的对象类。Person 类有一个名为 City 的属性。我想在 UI 中的一个操作中选择 5 个 Person 对象并将所有 5 个对象的 City 属性更改为“New York”。

这并不难以编程方式完成，但我很难想出一个直观的 UI 工作流程。一种想法是使用类似于 iTunes 中使用的模式来更改有关多首选定歌曲的信息。我想提出另一个工作流程，因为这个想法已经在工作中得到了回击。

想法？想法？

**编辑：**我很欣赏到目前为止的答案。我想指出几点：

1.  以前的 City 值是否应该以某种方式显示？如果是这样，怎么做？或者组合属性屏幕应该如何通过颜色或其他指示器显示所有城市值当前相同或不同？

2.  应该如何显示布尔属性（例如 Person.IsAlive）？您是否使用三态切换/复选框？我们有一个包含三个值的下拉菜单？其他想法？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:52:11.043

采用 iTunes 解决方案，放弃模式窗口并将其显示在您的应用程序中，否则您将显示单个条目的编辑视图。请记住，iTunes 也有一个用于编辑单个条目的模式窗口。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:53:25.190

我可能会使用相当标准的列表视图来执行此操作 - 允许多项选择 - 当您更改任何选定记录（例如下拉列表）中的字段时选择了多个项目，它会将所有项目更新为相同的值。

有时您可能想要禁用此操作 - 因此在右侧有一个链接项目以指示所有项目将一起更新。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:28:52.310

如果此类字段的数量有限，则可以使用类似于 Word 或 Excel 中的“复制和粘贴格式”的范例。选择一个原型记录，右键单击，从菜单中选择“复制城市...”，然后粘贴其余部分。

但我更喜欢你原来的想法......

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:45:00.963

好吧，您确实需要手动挑选所有对象，因此多重选择似乎很自然。之后，您可以实现一个上下文菜单项（如果您已经有一个上下文菜单，请将其设为一个名为 Edit 的子菜单）并将所有现有属性作为子菜单项提供。像这样的东西：

*   编辑

    *   姓名

    *   城市

    *   等等

选择菜单项时，提示用户输入新值，然后更新所有记录。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:40:05.920

一种方法是拆分窗格设置，其中所有人员都在一侧，人员的所有属性都在另一侧。

显然，这对于编辑单身人士来说效果不佳。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-11-04T05:57:08.047

我通过编辑向导完成了类似的事情。我选择了 1-10000 个不同的行，然后右键单击以显示编辑向导屏幕。显示的第一个面板能够设置多达 8 个不同的字段。我允许更改的每个字段都将应用于所有行。我在每个字段旁边都有复选框来选择要更改的字段。然后在选中时显示一个文本框以在旁边捕获新值。如果行都具有相同的值，则它们以灰色显示，例如，如果同一城镇的所有行都以灰色显示城镇，如果其中一行与第一行没有相同的城镇，则以橙色突出显示城镇字段并显示橙色消息'警告 - 有与第一个选定行不同的行'。我做了一个确认页面来检查用户想要继续，然后是一个完成按钮。

```
Rows to update : 3

    ..........Old Value... Change?....New Value

    Field A   ABC
    Field B   123          Y          845
    Field C   BOB 

                       [<Back] [Next>] [Finish] 
```

<== 如果字段 C 中的某一行没有 BOB，则以橙色突出显示 BOB。

希望有帮助

# c# - 在 C++ (MFC) 应用程序和 C# 之间传递数据

> ID：184777
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-10-08T20:38:33.630
> 
>         
> 
> 标签：c#, c++, ipc

我们有一个单片 MFC GUI 应用程序，它在 C++ 中的生命周期已接近尾声。我们计划在 C# 中构建新功能并在每个应用程序之间传递数据。

问题是：在 C++ 和 C# 之间传递数据的最佳方法是什么？

注意：

两端都将有一个 GUI 前端，并且可能只需要传递简单的数据，如 Id，并且可能有一种机制，它可以向其他应用程序指示要使用的进程/功能。

例如，其中一个应用程序是 C# 中的 CRM 系统，当双击网格中的一行时，会传递 customerId 和一条消息，以在 MFC 应用程序的客户表单中打开该客户。

我做了一些研究，选项似乎是 Windows 消息传递、内存映射、命名管道或 Windows 套接字之类的东西。在这个阶段，我们倾向于命名管道，但非常感谢其他建议或技巧或其他人的经验。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-10-08T20:41:26.230

就我个人而言，我会考虑使用命名管道之类的东西，因为它们很容易从 C++ 端使用，而 System.IO.Pipes 在 .NET 端也很容易使用。

如果您打算随着时间的推移替换应用程序的其他非 .NET 位，这也可能是阻力最小的路径。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-10-08T20:47:22.690

任君挑选：

*   文件

*   命名管道 <-- 我的建议

*   共享内存

*   插座

*   通讯

*   窗口消息

为什么命名管道？

*   为您提供一种 FIFO 的免费工作方式（如套接字，但不像共享内存）

*   可以轻松地双向沟通

*   在所有平台上都得到很好的支持

*   便于使用

*   可靠的数据传递和交付

*   可以是阻塞和非阻塞

*   无需移除即可读取数据（与套接字不同）

*   可以轻松扩展以包含第三个应用程序。  

在 .Net 中只需使用 System.IO.Pipes。

在 C++ 中使用 CreateNamedPipe 和 CreateFile。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:40:57.977

您还可以从托管端使用 P/Invoke - 如果 MFC 应用程序具有 C API，这将很有用。您也可以从任一侧使用 COM。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:40:59.177

您列出的选项当然是有效的，但您也可以考虑 COM。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:54:18.917

我会使用套接字（TCP）——MFC 和 .NET 都直接支持它们。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:00:27.297

你真的需要两个过程吗？

非托管 C++ 和托管 C# 代码完全能够在同一进程中运行，并且通过一小层托管 C++/CLI，您可以用简单的函数调用来代替进程间通信的复杂性。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:57:12.780

我的选择是标准窗口消息（例如 WM_FOO）或 DCOM：

*   只要通信非常简单，消息就可以工作，并且设置它的开销很小。如果您可以将通信简化为每条消息一到两个整数，那么这可能是一个不错的起点。如果这两个应用程序都已经是窗口应用程序，那么它们都已经有消息循环，所以你已经完成了大部分的工作。

*   DCOM 需要更多的程序员开销，但它很好，因为您可以定义更丰富的接口并避免将复杂的消息转换为二进制形式/从二进制形式转换。如果你走这条路，CoRegisterClassObject 是通过 DCOM 发布对象的起点。我从未尝试过从 C# 应用程序执行此操作，但原则上它应该是完全可能的

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:08:37.140

假设您拥有旧版应用程序的源代码，请查看是否无法将所有“主力”代码编译为 DLL，然后从那里调用各个函数/窗口。一旦你完成了这项工作，你就可以简单地围绕你需要的函数编写托管 C++ 包装器，然后从你的 C# 代码中调用它们。如果幸运的话，整个过程可能需要不到一天的时间。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-10-09T05:20:33.700

如果您不必担心应用程序将运行的所有系统上存在的 .NET 框架，我会说 C++/CLI，否则会说 COM。不过，这真的取决于你最舒服和最熟悉的东西。我喜欢 C++/CLI 和 COM 的现有“函数调用”结构（而不​​是使用其他协议构建它），但这只是我。

我目前正在使用 COM 来添加一些 .NET 组件功能，主要是因为如果 .NET 不存在，仍然需要使用后备功能，但这是特定于我的需要，最好是最大部署。

# asp.net - ASP.NET 会话超时测试

> ID：184782
> 
>         
> 
> 赞同：36
> 
>         
> 
> 时间：2008-10-08T20:39:59.103
> 
>         
> 
> 标签：asp.net, testing, session, timeout

我正在对 ASP.Net 网站进行一些黑盒测试，我需要测试不同的会话超时场景。

我不确定他们是否完全封装了会话超时。除了将页面打开 20 分钟之外，还有没有更简单的方法来强制会话超时？

* * *

## 回答 #1

> 赞同：73
> 
>             
> 
> 时间：2008-12-17T17:09:37.767

**减少超时**

测试这一点的最简单和最非侵入性的方法可能是将超时减少到一个相当小的数字，例如 3 或 5 分钟。这样，您可以暂停几分钟以模拟更长的暂停，而不必担心应用程序重新启动或特殊的重置代码会对您的测试结果产生任何影响。

您可以在几个位置修改会话状态超时 - 全局（在适用的 .NET 框架版本的 config 文件夹中的 web.config 中），或仅针对您的应用程序。

要仅为您的应用程序修改超时，您可以将以下内容添加到应用程序的 web.config：

```
 <system.web>
    <sessionState timeout="60" /> 
  ... 
```

或者，您也可以通过 IIS 配置对话框为您的应用程序修改相同的设置（我相信您仍然需要为您的应用程序定义 web.config，否则编辑配置将被禁用）。

要访问它，请在 IIS 中右键单击您的 Web 应用程序，然后导航到 Properties | ASP.NET 选项卡 | 编辑配置 | 状态管理选项卡 | 会话超时（分钟）。

请注意，您还可以通过代码操作此设置 - 如果已完成此操作，则 web.config 文件中的设置将被有效地忽略，您将需要使用另一种技术。

**调用 Session.Abandon()**

一种比设置低超时稍微更具侵入性的技术是调用 Session.Abandon()。不过，请务必从与您的应用程序分开的页面调用它，因为在处理当前页面上的所有脚本命令之前，会话实际上并没有结束。

我的理解是，这将是一种相当干净的方式来测试会话超时，而无需实际等待它们。

**强制重新启动应用程序**

在会话状态的默认配置中，您可以通过重新启动应用程序来完全消除会话来模拟会话超时。这可以通过多种方式完成，下面列出了其中的一些：

*   通过回收应用程序池

    *   IIS MMC 管理单元

    *   命令行 (iisapp /a AppPoolID /r)

    *   修改 web.config、global.asax 或 bin 目录中的 dll

*   通过重启 IIS

    *   IIS MMC 管理单元

    *   services.msc 并重新启动 IIS Admin 服务

    *   命令行 (iisreset)

当我提到“默认配置”时，我指的是配置为使用“InProc”会话状态模式的 Web 应用程序。即使重新启动 Web 应用程序，也有其他模式可以实际保持会话状态（StateServer、SQLServer、自定义）。

**篡改状态跟踪机制**

假设您的 Web 应用程序未配置“无 cookie”模式（默认情况下，将使用 cookie），您可以从客户端浏览器中删除包含会话 ID 的 cookie。

但是，我的理解是，这并不是真正模拟超时，因为服务器仍然会知道会话，只是看不到任何人在使用它。没有会话 ID 的请求将被简单地视为需要新会话的看不见的请求，这可能是您想要测试的，也可能不是。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2008-10-08T20:40:32.643

向站点添加页面并调用 Session.Abandon()

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2013-09-02T14:18:43.680

最简单的方法是在两个不同的选项卡中打开页面，在其他选项卡中注销将自动使第一个选项卡中的会话过期。大多数浏览器跨选项卡共享会话。所以我发现它很容易，无需修改 web.config 中的任何内容。这样，即使会话到期时特定功能未处理重定向到登录，您也可以进行测试。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T20:41:19.910

反弹 AppPool 并且会话将丢失。

如果您没有直接的 IIS 访问权限，您可以打开并保存 Web.Config 来做同样的事情（不要使用记事本，它会破坏编码）。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T20:41:19.257

缩短超时时间。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T20:44:40.637

您可以在 webconfig 中更改超时

```
 <authentication mode="Forms">
      <forms timeout="10" protection="All" slidingExpiration="true" loginUrl="~/login.aspx" cookieless="UseCookies"/>
 </authentication> 
```

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T20:41:19.223

如果您将会话信息存储在 cookie 中，您可以尝试删除 cookie。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:40:26.653

回收服务器上的应用程序池。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2011-05-31T11:27:02.273

你有两个选择：-

1- 减少 web.config 中的会话超时。2-重新启动 IIS 或应用程序池。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2015-05-23T16:16:07.640

I usually use the ASP .NET session state server. Apart from other benefits during development, I can simply restart the ASP .NET state service to abandon the session. If you're using the state server, simply run services.msc and restart the "ASP .NET State Service".

# service - 添加到在实例化 JRun 服务器上运行的 ColdFusion 类路径

> ID：184804
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T20:43:35.787
> 
>         
> 
> 标签：service, coldfusion, web, classpath, jrun

我无法让我的 ColdFusion 服务器类路径识别我的自定义 Java jar。类路径没有正确读取我的 jvm.config 文件（我假设我的 JRun 服务器是 CF 实例用完的地方，它是一个连接了多个站点的生产服务器）。为此，我已经把头撞在墙上好几个小时了。我使用这些 jar 文件完美运行的所有其他站点。其中一个基本上是这个的克隆，但由于某种原因，这个不能只识别这个部分。该站点的其余部分工作正常，但是当它尝试访问这个 jar（它是一个图像调整器）时，它找不到它，当我查看 CF 管理员时，类路径没有显示 java 目录的路径（根本），就像所有其他网站。

也没有与此站点关联的服务（嗯，有一个正在运行的服务出现在 JRun 管理器上，但不在 Windows 的服务列表中）。当我手动添加一个并尝试启动它时，它说它已经在运行。我重新启动了 ColdFusion 服务器，但无济于事。我应该重新启动 JRun 服务器吗？（它将关闭生产站点）我可以在这里做什么才能让这件作品工作？

更新：2008 年 10 月 9 日 好的，为了删除那些卡住且无法正常工作的蹩脚的旧服务，我不得不重新启动服务器，即使手动删除也不起作用。所以现在我有一个运行良好的 ColdFusion 服务器实例，但 Java 自定义类仍未被读入 CF 实例。我想我必须为那个 ColdFusion 服务器实例编写一个自定义的 jvm.config 文件，我现在的问题是，我必须重新启动 JRun 还是我可以只做那个服务器实例？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-14T19:05:01.260

我最终回答了我自己的问题，这里是：

在控制台中，您必须使用以下行手动安装服务：

jrunsvc -install jrun_server service-name service-display service-description -config custom_jvm.config

“jrun_server”实际上是您正在安装的实例。因此，如果它是 production_02，那就是您安装到的 jrun 实例的名称。服务名称，显示和描述都是你可以自己填写的绒毛。如果您需要帮助编写自己的配置文件，也可以在 Internet 上找到许多配置文件。

# linux - 如何阻止访问者直接访问我网站中的目录？

> ID：184813
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T20:45:03.943
> 
>         
> 
> 标签：linux, apache, .htaccess

我有一个（由 Wordpress 驱动的）网站，Google 正在索引一些子目录。如何阻止 Apache 向用户显示目录列表？我知道我可以编辑 .htaccess 以对目录进行密码保护，但如果可能的话，我更喜欢 403 / 自定义重定向。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2008-10-08T20:47:04.673

您的文件中需要此条目`.htaccess`：

```
选项 - 索引
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T20:46:50.353

查看您的 robots.txt 规则，并确保 apache 没有提供目录列表。

见[http://httpd.apache.org/docs/2.0/howto/htaccess.html](http://httpd.apache.org/docs/2.0/howto/htaccess.html) && [http://www.webmasterworld.com/forum92/5272.htm](http://www.webmasterworld.com/forum92/5272.htm)

* * *

## 回答 #3

> 赞同：-2
> 
>             
> 
> 时间：2008-10-08T20:49:16.230

对 Apache 不太了解，但如果可以的话，您应该执行 404 而不是 403，因为 403 告诉某人他们可能发现了一些有趣的东西。

# performance - 对于不可接受的 webapp 响应时间，是否有一些行业标准？

> ID：184814
> 
>         
> 
> 赞同：46
> 
>         
> 
> 时间：2008-10-08T20:45:09.683
> 
>         
> 
> 标签：performance, scalability, duplication

有一个我正在定制的婴儿床（商业现成的）应用程序，其中几个页面需要很长时间才能加载某些数据分布。（在这种情况下，页面加载大约需要 3 分钟......而且时间呈指数增长）。

显然这是不可接受的，但是否有研究表明我可以指出可接受的响应时间是多少？

我想要一些很好的研究，可能会讨论响应时间。

* * *

## 回答 #1

> 赞同：60
> 
>             
> 
> 时间：2010-11-17T23:12:00.707

[Jakob Nielsen 的研究已经为](http://www.nngroup.com/articles/response-times-3-important-limits/)*任何*应用程序回答了这个问题（网络应用程序在这方面并不特别）：

*   **0.1 秒**：限制用户感觉他们正在**直接操作**UI 中的对象。

*   **1 秒**：限制用户感觉他们正在**自由导航**命令空间而不必过度等待计算机。

*   **10 秒**：限制用户**将注意力集中**在任务上。

因此，对于 Web 应用程序，您应该将页面响应时间平均保持在服务器附近最大 500 毫秒，以拥有一个即使网络延迟为 200-300 毫秒也能愉快使用的 Web 应用程序。

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2008-10-08T20:48:46.977

可接受的 UI 响应时间基于人类心理，因此对于 Web 应用程序与对于传统桌面应用程序的响应时间相同。

根据最终用户如何感知正在执行的操作，可接受的响应时间可能是 1 秒（例如，用于关闭“对话窗口”）或 10 秒（例如，用于显示计算结果）。

可用性专家 Jakob Nielsen 写了[一篇](http://www.useit.com/papers/responsetime.html)关于可接受的 Web 应用程序响应时间的好文章。

已发布的 UI 指南指定了相同的可接受响应时间，例如：

[Java 外观指南](http://java.sun.com/products/jlf/at/book/Responsiveness5.html)

[GNOME 用户界面文档](http://library.gnome.org/devel/hig-book/unstable/feedback-response-times.html.en)。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-09T08:12:31.060

是的，尼尔森的文章有一些关于心理学如何参与的很好的信息。 
[在这里](http://www.sapdesignguild.org/community/editorials/editorial_03_2008.asp)
，您可以找到有关“感知性能”为何重要的更多信息，而不仅仅是实际响应时间。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:47:47.307

我发布了一个相关问题，并得到了一些可能会有所帮助的有趣答案。看

[对于动态的、个性化的 Web 应用程序，什么被认为是好的响应时间？](https://stackoverflow.com/questions/164175/what-is-considered-a-good-response-time-for-a-dynamic-personalized-web-applicat)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:49:29.783

不久前，一位教授告诉我，普通用户在等待 10 秒后就放弃了，什么也没发生。看到某事发生可能会增加他们等待的倾向。但那是很久以前的事了……当时互联网速度较慢。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:15:04.303

[这里](http://www.webperformancematters.com/journal/2007/7/10/acceptable-response-times.html)有一篇不错的博客文章，认为确实**没有**行业标准。

也许没有什么好的方法可以做到这一点。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2020-01-23T21:27:29.567

这个问题的答案集中在 UI 行为上，其中许多假设网络响应时间和 UI 响应性之间总是存在硬联系。

虽然这在 11 年前发布最后一个答案时可能是正确的，但如今实现 Web 页面的策略已经发展，最佳实践意味着许多 XHR 调用独立于使页面立即对用户有价值。

我怀疑即使是这些答案中的人类心理部分也随着时间的推移而发生了变化——人们现在通常对网页有更高的期望和更低的耐心门槛。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2021-09-23T04:21:08.970

## Python**[请求](https://docs.python-requests.org/en/latest/)**

这可能更多地出现在服务器端，并且没有考虑到匹配的前端，但我仍然将此文档作为我的指导方针。

> 连接超时是请求将等待您的客户端在套接字上建立与远程机器的连接（对应于[connect()](https://www.hjp.at/doc/rfc/rfc2988.txt)）调用的秒数。*最好将连接超时设置为略大于**3 的倍数***，这是默认的 TCP 数据包重传窗口。

从这些[文档](https://www.hjp.at/doc/rfc/rfc2988.txt)

> (2.1) 在对发送方和接收方之间发送的段进行往返时间 (RTT) 测量之前，**发送方应设置 RTO <- 3**秒（根据 RFC 1122 [Bra89]），尽管“退避” （5.5）中讨论的重复重传仍然适用。

> 请注意，某些实现可能会使用**“心跳”**计时器，该计时器实际上会产生 2.5 秒到 3 秒之间的值。因此，2.5 秒的下限也是可以接受的，前提是计时器的到期时间永远不会超过 2.5 秒。使用粒度为 G 的心跳计时器的实现**不应将计时器设置为低于 2.5 + G 秒。**

* * *

## 回答 #9

> 赞同：-4
> 
>             
> 
> 时间：2008-10-08T20:58:44.383

∞ 是最不可接受的响应时间。

之后，用户期望花费的最长时间，这取决于您的服务。

动画区域将极大地增加用户的耐心，无论是沙漏、漩涡、圆圈，甚至是一个不断填满和清空自身的条形。只要问题显然不是他们的行动没有被听到，他们就会等待。

# winforms - Devexpress Xtragrid 如何将组合框编辑器添加到列

> ID：184823
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2008-10-08T20:47:44.953
> 
>         
> 
> 标签：winforms, user-interface, devexpress

我想在 Xtragrid 的一列中放置一个组合框。我可以将组合框绑定到数组值，但是如何将组合框绑定到列？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2008-11-11T08:17:09.843

使用列的 ColumnEdit 属性来分配查找编辑控件（新）。lookupedit 控件是您需要的组合框。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2011-04-12T09:53:10.727

这是一个如何将 ComboBox 添加到 GridColumn 的简单示例。

```
Dim xSunday As New DevExpress.XtraEditors.Repository.RepositoryItemComboBox
Me.GridView1.Columns("Sunday").ColumnEdit = xSunday
xSunday.TextEditStyle = DevExpress.XtraEditors.Controls.TextEditStyles.DisableTextEditor
xSunday.Items.Clear()
xSunday.Items.Add("Full")
xSunday.Items.Add("Half")
xSunday.Items.Add("Off") 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-25T20:11:15.500

在列的 ColumnEdit 属性中，添加一个（新的）ComboBoxEdit。如果您始终希望它可见，请将列上的 ShowButtonMode 设置为 always。

这将创建一个 repositoryItemComboBox1 对象（这是默认名称），如果您选择在下拉列表中显示，您可以将项目添加到该对象。即repositoryItemComboBox1.Items.add("My Text");

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-11-04T12:01:45.010

您可以使用 ColumnEdit 并放置正确的存储库。然后，您可以绑定到该存储库。

# java - 监视通过 JNI 用 Ja va 调用的 C DLL 的内存使用情况？

> ID：184825
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-08T20:48:04.467
> 
>         
> 
> 标签：java, c, memory, dll, java-native-interface

如何监视通过 JNI 从 Java 调用的本机 C DLL 正在使用的内存？使用标准 Java 监视工具和选项，我可以看到 Java 内存空间，但我无法查看 C DLL 使用的任何内存。Java 正在使用 ~70MB，但任务管理器中的任务显示 200Mb+，如果可能的话，我想看看额外的 130MB 中有什么。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-09T00:13:45.660

您可以使用性能监视器中的计数器监视本机堆。(perfmon32) 但是它不会在每个 DLL 的基础上为您分解它，甚至 jvm.dll 也会包含在此处。

大多数分析工具都可以附加到进程并捕获和跟踪内存分配和释放。这使他们能够推测泄漏的位置。我最近尝试追踪从 Java 调用的本机代码中的内存泄漏时发现的一个非常好的方法是[Memory Validator](http://www.softwareverify.com/cpp/memory/index.html)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:56:25.793

您是否尝试过使用[Process Viewer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)进行更深入的挖掘。

如果您有 DLL 的源代码，您可以使用调试库和可能的内存分配跟踪器重新构建 - 并使用可视 C++ 调试器进行调试（您需要告诉它使用 java 应用程序）。

如果您没有源 - 那么选项是有限的。

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2008-10-08T21:04:31.847

我相信即使在 C DLL 中这样做也不会很容易。  

据我了解，标准 Java 监控工具通过查询虚拟机来收集信息，因此即使该内存在同一个进程中，除非虚拟机知道如何检查您的动态链接库，否则它将无法看到任何内容. 我相信您需要使用外部工具或对 DLL 进行一些大规模修改才能跟踪其内存使用情况。

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2008-10-08T21:08:45.830

好吧，由于 DLL 并不是 Java 堆的一部分，我认为最准确的阅读方法是编写一个小型分析程序（小型 Java/JNI 程序或 C++/C# 等）来导入和使用DLL 以与您的应用程序类似的方式进行，并且不执行任何其他操作 - 只需像您一样使用 DLL - 此分析应用程序的结果内存配置文件应该很好地近似于 DLL 的内存配置文件。

您还应该测试是否存在 DLL 的*静态*或*动态*内存形状 - 在加载 DLL 之前和之后直接进行内存测量，以查看是否存在约 130MB 的一次性命中，或者内存是否缓慢上升时间。

在 Solaris / Linux 上，我听说 Sun Studio 收集器 / 分析器是一个很好的工具，但是你被困在 DLL 领域（或者说是 DLL 地狱）

# asp.net - ASP.NET 会话和存储使用 COM 互操作的对象

> ID：184840
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T20:51:18.923
> 
>         
> 
> 标签：asp.net, com, session, interop

我在一个asp.net 网站上工作。我们必须使用 com interop 与旧版 vb6 activex 组件进行交互。在许多情况下，组件依赖于接收一个上下文对象（它本身就是一个 vb6 activex 组件）作为参数。上下文对象的构建成本相当高。

因此，一个想法是一个上下文对象被构建一次并存储在 asp.net 会话中。但是，如果这个对象只是一个围绕 activex 组件的 .net 包装器，那么在会话中保留这样的对象是明智的还是可取的？

此外，上下文对象包含用户特定信息，因此可以使用 .net HttpRuntime 缓存进行持久化，但需要用户特定密钥。  

[我了解 asp.net session, aspnet-session question](https://stackoverflow.com/questions/133236/aspnet-session)的其他限制和需要注意的事项。

以稍微不同的方式问这个问题：他们在存储一个只是 com 对象的包装器的 .net 对象方面是否存在任何问题或问题？  

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T21:47:37.093

我认为你会很快遇到一个请求阻塞另一个请求的问题。

默认情况下，ASP.NET 在其线程上初始化 COM，以将线程置于多线程单元中。VB6 组件充其量只是公寓模型。这意味着，当 MTA 线程创建组件时，如果一个已经存在（对于 ASP.NET 工作进程，它不会），或者专门为 STA 创建一个新线程，它就会被放入主 STA。哪个 MTA 线程创建组件无关紧要，相同的 STA 始终用于无法处理 MTA 模型的组件。这意味着对这些组件的每次调用都使用同一个线程，因此并发调用必须排队等待。

要告诉 ASP.NET 为单线程组件初始化 COM，这至少会导致在与执行页面相同的线程上创建对象，请将`AspCompat`属性添加到[@Page](http://msdn.microsoft.com/en-us/library/ydy4x04a.aspx)指令。

我不会缓存这些对象，因为它们在重用时很可能会出现跨线程问题。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:52:40.870

我会将它保存在缓存中，这样它就不会为每个用户构建一次，除非这是预期的效果。

# javascript - 如何从 VB 组件获取错误代码到（服务器端）JScript

> ID：184850
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T20:54:03.020
> 
>         
> 
> 标签：javascript, asp-classic

我有一个普通的 asp 网站，它调用用 VB 6 编写的 dll 中的方法。如果出现问题，此方法会在 VB Err 对象中设置错误代码。现在我想从 javascript（我在其中调用 dll 方法）访问 Err 对象中设置的错误代码和描述。第一：可能吗？第二：如果可能的话，我该怎么做？提前致谢！

我的第一个想法是：

 `````
Function MyFunc()
{
  var obj = Server.CreateObject(“MyDll.MyClass”);

  try
  {
    obj.MyMethod();
  }
  catch(error)
  {
    // Here I want to get the error code and description from the VB Err object
  }
} 
````  `但是，当我尝试这个时，我得到的错误是错误的。（我试图制作一个收到相同错误的测试应用程序。）我得到一个错误代码，它在 JavaScript 中与在 VB 中不同。

任何人都知道如何做到这一点？

/L

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:57:52.327

在您的 MyClass 中，添加一个在发生错误事件时保存错误信息的属性，然后您应该能够查看 obj.MyErrorCode 并找出您需要的内容。

# x11 - Xterm 控制序列到 'T' 输出到文件

> ID：184853
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T20:54:59.663
> 
>         
> 
> 标签：x11, vnc, xterm

我发誓在 X 中曾经有一种方法可以开始将所有终端流量捕获到主机上的文件中。它可能是 HummingBird 的扩展，但我认为它是标准的。现在，我找不到诀窍了。我是幻觉（当你变老时发生），还是有可能？

我不是在谈论“三通”。我希望能够向标准输出发送一个 xterm 控制序列，给出一个文件名，并从那时起将窗口中显示的所有内容保存到文件中（直到发出书挡取消）。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T04:24:46.067

此功能称为日志记录并存在于源代码中，但出于安全原因默认禁用。您是否真的希望每个能够将控制序列写入您的终端的人（*例如*，您可能有一天会编写任何文件的作者`cat`）都能够将任意数据写入您帐户下的任意命名的文件？

例如，攻击者可以轻松地使用此功能修改您`~/.ssh/authorized_keys`以授予攻击者访问权限，并更改您`~/.profile`以使用您的 IP 地址 ping 攻击者。

也就是说，如果您使用`--enable-logging`AND you 编译 xterm `#define ALLOWLOGFILECHANGES`，那么根据[Xterm 控制序列](http://www.x.org/docs/xterm/ctlseqs.pdf)手册，您将可以访问以下控制序列：

```
^[[?46h            Start logging
^[[?46l            Stop logging
^[]46;filename\007 Change log file to `filename` 
```

默认情况下，将调用日志文件名`Xterm.log.hostname.yyyy.mm.dd.hh.mm.ss.XXXXXX`。

还有一个选项可以通过管道启用日志记录，如果您允许通过控制序列更改记录器，这也是非常危险的。这也将允许任何人在您的系统上执行他们的代码。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:01:54.907

问题比较模糊。

尝试查看：

1.  “ttyrec/ttyplay”用于录制终端会话的文本模式“电影”

2.  用于记录整个会话的注销标准输出的“屏幕”

3.  "tee" 用于记录单个命令的标准输出/标准错误

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:57:46.163

我对你问问题的方式有点困惑。首先你提到 Xterm 然后 X 然后是终端，你只是在寻找“tee”（`man tee`）命令吗？

# java - 如何以编程方式接收传真？最好在java中

> ID：184857
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-08T20:55:32.113
> 
>         
> 
> 标签：java, fax

我需要能够在 Java 应用程序中接收传真。我想知道有什么方法可以做到这一点。传真？使用传真到电子邮件提供商？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T21:41:56.183

我建议使用传真发送电子邮件。过去一年左右我一直在使用[RapidFax](http://www.rapidfax.com)，它相当便宜而且速度很快。我很高兴。

或者，还有一些基于 Web 服务的传真服务，例如[InterFax](http://www.interfax.net)。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:59:14.010

我们使用[Ringcentral.com](http://www.ringcentral.com)将传真以 PDF 格式发送到电子邮件地址。然后我们通过以编程方式访问 POP3 帐户 (sp?) 来访问 PDF。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T20:59:23.790

[我使用101Fax](http://101fax.com/)的传真到电子邮件功能，它非常可靠。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2011-03-07T22:39:27.013

这可以通过 Java 在 API 可访问的 Internet 传真服务（例如 Interfax）上完成。在他们的网站上有[Java 传真](http://www.interfax.net/en/dev/java)示例可供查看和下载。

注册入站传真服务（开发人员免费）后，从任一代码示例页面下载 jar 文件。将传真接收到您的应用程序的业务端是以下两个位。

[使用GetList](http://www.interfax.net/en/dev/webservice/reference/getlist)方法，让您的应用程序定期查询服务器是否有新的传真到达：

```
GetList parameters = new GetList(TestConstants.USERNAME,
                    TestConstants.PASSWORD,
                    ListType.AllMessages,    // Select the type of list you wish to return
                    10, // max items
                    new MessageItem[0]
                    ); 
```

在该服务上发送到您号码的任何传真都将在此方法返回的结构中显示为新记录。新传真可用后，您可以使用[GetImageChunk](http://www.interfax.net/en/dev/webservice/reference/getimagechunk)方法下载它：

```
GetImageChunk parameters = new GetImageChunk(TestConstants.USERNAME,
                        TestConstants.PASSWORD,
                        MESSAGE_ID,
                        MARK_AS_READ,
                        CHUNK_SIZE,
                        from,
                        new byte[0]
                        ); 
```

# javascript - 改变标签行为的正确方法是什么？

> ID：184858
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-08T20:55:52.597
> 
>         
> 
> 标签：javascript, ajax

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2008-10-08T21:05:20.423

通常，您应该始终有一个后备链接，以确保禁用 JavaScript 的客户端仍然具有某些功能。这个概念被称为不显眼的 JavaScript。示例...假设您有以下搜索链接：

```
<a href="search.php" id="searchLink">Search</a> 
```

您始终可以执行以下操作：

```
var link = document.getElementById('searchLink');

link.onclick = function() {
    try {
        // Do Stuff Here        
    } finally {
        return false;
    }
}; 
```

这样，禁用 javascript 的人会被定向到 search.php，而使用 JavaScript 的查看者会查看您的增强功能。

**编辑：**正如[nickf](https://stackoverflow.com/users/9021/nickf)在评论 #2 中指出的那样，如果您的处理程序中出现错误，try and catch 将阻止链接跟踪。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-10-08T20:58:41.903

只需确保`false`从您的 onclick 处理程序返回。例如`foo()`应该定义为：

```
function foo() {
  // ... do stuff
  return false;
} 
```

有人在评论中指出，您可能需要稍微更改 HTML 才能使其正常工作：

```
<a href="#" onclick="return foo()">Click</a> 
```

或者只是把它放在 HTML 中：

```
<a href="#" onclick="foo(); return false;">Click</a> 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T21:02:18.183

首先，有两种设置href的方法——你可以像上面所说的那样使用href引用'#'，或者你可以将href设置为引用“javascript:;”

其次，我总是建议将 JavaScript 保存在外部文件中，然后在那里管理事件处理程序。假设您想在页面加载时进行设置，您可以执行以下操作：

```
window.onload = {
    var myLink = document.getElementById('myLinkID');
    myLink.onclick = function(evt) {
        var evt = (evt) ? evt : ((event) ? event : null); // for cross-browser issues
        evt.preventDefault();
        evt.stopPropagation();
        foo();
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T21:01:42.100

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:58:37.833

```
<a href="javascript: foo()" >Click</a> 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T20:58:52.653

调用 foo() 后返回 false

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:28:17.430

很多混淆是围绕 a-tags 的使用，因为它们跨浏览器支持 :hover pseudo-css-selector ...

因此，使用 a-tag 通常很明显，因为它会根据鼠标悬停的不同阶段呈现不同的...

有些人会声称 :hover 伪标签中内置的功能根本不应该可用，因为 W3C 的意图是在动态 html 的三个部分中分离内容、视觉呈现和功能；html、css和javascript。

但是现在我们坚持使用它，并且暂时以多种方式使用 a-tags 是有用的，因为它们以简单的方式完成任务，而且它是正确的跨浏览器！-)

但这意味着您有时必须禁用这些链接标签的默认行为，这意味着您必须使 onclick-event 返回 false，而更改当前文档的内容没有意义.. .

However very good examples of using the dismissing of default behavior can be made, an example could be to provide a popup with certain properties even if the user has disabled the use of javascript:

```
<a href="http://en.wikipedia.org/wiki/Css" target="_blank" onclick="window.open(this.href,'_blank','width=600,height=450,status=no');return false;">Show wikipedia css</a> 
```

* * *

## 回答 #8

> 赞同：-1
> 
>             
> 
> 时间：2008-10-08T21:32:39.463

Beware just using 

`<a href="#">Click</a>`

as it can cause an obnoxious [IE6 problem](http://webbugtrack.blogspot.com/2007/09/bug-223-magical-http-get-requests-in.html). 

I always recommend using an anchor that points to nothing. I like to use this

`<a href="#MAGIC">Click</a>`

because it makes me laugh.

* * *

## 回答 #9

> 赞同：-2
> 
>             
> 
> 时间：2008-10-08T20:59:15.007

如果你包括

```
return false; 
```

从 onclick 事件中，页面将根本不会加载。例如：

```
<a href="#" onclick="foo();return false;">Click</a> 
```

或者在函数本身：

```
function foo() {
  // other stuff
  return false;
} 
```

* * *

## 回答 #10

> 赞同：-2
> 
>             
> 
> 时间：2008-10-08T20:59:39.610

设置 href 属性以执行 javascript。像这样：

 `<a href="javascript:foo()">Click</a>` 

这样，您所有的 a:hover CSS 样式都会按预期工作。

# java - 是否有 Java 标准的“null 或 equal”静态方法？

> ID：184863
> 
>         
> 
> 赞同：102
> 
>         
> 
> 时间：2008-10-08T20:57:24.807
> 
>         
> 
> 标签：java, null, equals

为了节省一些输入并澄清我的代码，是否有以下方法的标准版本？

```
public static boolean bothNullOrEqual(Object x, Object y) {
  return ( x == null ? y == null : x.equals(y) );
} 
```

* * *

## 回答 #1

> 赞同：196
> 
>             
> 
> 时间：2012-02-20T15:31:00.907

使用 Java 7，您现在可以直接执行 null 安全等于：

[Objects.equals(x, y)](http://docs.oracle.com/javase/7/docs/api/java/util/Objects.html)

（Jakarta Commons 库 ObjectUtils.equals() 在 Java 7 中已过时）

* * *

## 回答 #2

> 赞同：23
> 
>             
> 
> 时间：2008-10-08T21:10:40.350

如果您有机会访问 Jakarta Commons 库，那里有[ObjectUtils.equals()](http://commons.apache.org/lang/apidocs/org/apache/commons/lang3/ObjectUtils.html#equals(java.lang.Object,%20java.lang.Object))和许多其他有用的功能。

编辑：最初误读了这个问题

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2015-09-22T19:35:10.013

如果您使用 <1.7 但有 Guava 可用：[`Objects.equal(x, y)`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Objects.html#equal(java.lang.Object,%20java.lang.Object))

# java - 从 Java 访问 iSeries 上的 RPG

> ID：184864
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-08T20:57:31.767
> 
>         
> 
> 标签：java, java-native-interface, ibm-midrange, rpgle

有没有人从 Java 直接与运行在 V5R4 iSeries 机器上的 RPG 程序交谈的良好经验？如果是这样，社区的建议是什么，我应该尽量避免哪些陷阱？

从我尝试过的各种文献和尖峰解决方案来看，看起来我们可以使用 ProgramCallBeans（通过 PCML 或 xPCML）、与 DataQueues（用于异步通信）甚至 JNI 通信。

我正在寻找一种健壮、高性能、快速开发、易于维护和易于测试的东西（我们不都是！？！）。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2008-10-21T16:35:04.630

我建议使用 IBM 的 Java Toolbox for Java。将 JT400.jar 放入您的类路径（如果 Java 在 iSeries 上运行，则放入 JT400Ntv.jar）。我已经使用了 ProgramCall 类和 CommandCall 类。

com.ibm.as400.access.CommandCall 类易于使用。它有一个简单的构造函数，您可以将 com.ibm.as400.access.AS400 类传递给它。然后只需像这样使用 run 方法：

```
CommandCall command = new CommandCall(as400);
command.run("CPYF FROMFILE(BLAH) TOFILE(BLAHBLAH) CRTFILE(*YES)"); 
```

当然，你不会使用那个特定的 CL 命令，但你明白了。使用 CommandCall 类时，处理来自命令的任何消息总是一个好主意。在我使用它的一个程序中，我在屏幕上的文本框中向用户显示消息，如下所示：

```
AS400Message[] messageList = command.getMessageList();
for (int i=0;i < messageList.length;i++) {
String sMessageText = messageList[i].getText();
    sMessage+=sMessageText + "\n";
} 
```

com.ibm.as400.access.ProgramCall 类需要更多的工作，但它允许您访问返回的参数。我更经常使用这个，因为我通常调用现有的返回值的 RPG 工作程序。为此，定义一个 com.ibm.as400.access.ProgramParameter 数组。当您从 Java 向程序传递参数时，请记住使用 com.ibm.as400.access.AS400Text 之类的类将它们转换为 AS/400 友好的值。使用 IBM 的文档可以更好地研究 ProgramCall 命令的详细信息：http: [//publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp ?topic=/rzahh/page1.htm](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/rzahh/page1.htm)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-10T16:26:30.257

你应该看看[JTOpen](http://jt400.sourceforge.net/)。使用它来做你想做的事情是相当容易的。这是某人整理的一个示例：[program call to as400 using jtopen](http://codenewbie.com/forum/java/1921-program-call-as400-using-jtopen.html)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-09T13:25:25.377

直接从 RPG 调用 java 方法非常简单。我不确定您到底要做什么，我已经多次直接调用 java 方法。

有关如何完成此操作的示例。看看[RPGMail](http://mowyourlawn.com/html/RPGMail.php)。您可以查看源代码并了解 Aaron 如何使用 RPG 连接到 JavaMail。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T22:24:28.500

我们只使用 JDBC 和存储过程。存储过程调用 RPG 而不是运行 SQL。我不是 RPG 程序员，但它似乎是一个非常简单的界面。DataQueue 还可以，但是它们不如 JMS 之类的强大（没有保证交付）。  

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-11-04T19:34:05.297

我在 PCML 文档方面取得了一些成功。我决定使用 PCML，因为在将参数传递给 RPG 程序时将命令调用编码为字符串会变得非常难看。

PCML 允许您以某种方式透明地将 java 数据类型作为参数传递给 rpg 程序。缺点是 PCML 文档中的 xml 成为静态接口，如果程序更新，则必须更新。使用正确的构建工具，自动更新 pcml xml 可能非常简单，但现在我正在手动执行此操作。

当需要从java调用rpg程序时，我就使用过这种方法，并且逻辑流程由java程序控制。

在逻辑流程由 rpg 程序控制的情况下，我使用数据队列对 java 进行同步和异步调用。这需要编写大量代码来标准化如何以协调的方式从不同的编程语言读取和写入数据队列

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-11-05T05:51:06.583

嗯，我是新来的，会投票给 KC Baltz 回答，但还不能。存储过程是要走的路。我使用 JT open 来本地调用程序，发现可以传递的参数数量、数据类型等问题。一旦你的程序有一个 SQL 过程包装器，你会发现 Java 对 SQL 的支持远远优于java对本机400调用的支持。

# rdlc - RDLC 报告中的分页符？

> ID：184865
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-08T20:57:39.893
> 
>         
> 
> 标签：rdlc

我有一个 RDLC 报告我遇到了分页问题。该报告有一个组，该组包含许多不适合一页的记录。此报告在正常模式下呈现良好，但当我切换到打印模式时，会出现以前不存在的“额外”分页符。这会导致报告打印在不必要的页面上。我没有将组设置为保留在一页上，并且我一直在使用 Height 和 InteractiveHeight 的值，但似乎没有任何效果。

有没有办法解决这个问题？我需要正确打印这份报告，而这些神秘的分页符导致了这个问题。任何帮助或建议表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T21:06:36.660

确保在报告属性对话框中检查您的边距设置。我认为默认值为 1 英寸。这可能会影响印刷。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2011-02-08T01:31:10.587

如果您刚刚转换到 2010，这将解决您的问题（请参阅最后一个条目）
 [http://social.msdn.microsoft.com/Forums/en/vsreportcontrols/thread/9d493130-6683-4ec8-bbe0-9524df8859c5](http://social.msdn.microsoft.com/Forums/en/vsreportcontrols/thread/9d493130-6683-4ec8-bbe0-9524df8859c5)

> 查看 ReportViewer 设计器区域的底部，您应该会看到“行组”。我的报告表的名称是“Table_LineItems”，我看到“Table_LineItems_Details_Group”。我选择它并在我的属性窗口中将“保持在一起”设置为 false。然后它可以正确打印。我不能保证这对你有用，但我建议你用你在下面看到的任何东西玩。您还可以（在最右侧）单击未标记的下拉菜单并选择高级模式，然后不加选择地将更多“静态”项目设置为 KeepTogether = false。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2010-09-15T11:56:26.997

只需将您的页面大小属性设置为 ==8.5in, 3.625in，然后查看您的报告

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-11-04T14:37:28.063

选择表，右键单击，转到属性，在您拥有的任何组之后添加新组（在这种情况下，我称之为“PreviousGroupName”），表达式应为  **=(RowNumber("PreviousGroupName") - 1) \27+ 1**，检查**最后分页符**。它将适合网络中的 27 行，当导出到 .PDF 时，您应该会看到相同的 27 行。您可以将 27 更改为适合页面所需的任何数字，

然后您可以将查看器高度（在 .aspx 中）更改为任何大小，以避免滚动。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2015-09-25T16:55:15.380

`ConsumeContainerWhiteSpace = True`我在报告属性中设置了选项，它工作正常。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:09:21.180

尝试调整元素的宽度。您必须确保它们在打印布局的边缘内，否则您会得到额外的页面。确保你的边距不是很宽（我认为它们是默认的）。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2017-02-08T09:48:35.733

我使报告的正文大小（高度宽度）小于报告属性上的页面宽度和页面高度。

最后，空白页消失了。

# sql-server - 是否可能发生 GUID 冲突？

> ID：184869
> 
>         
> 
> 赞同：142
> 
>         
> 
> 时间：2008-10-08T20:58:04.603
> 
>         
> 
> 标签：sql-server, guid

我正在开发 SQL Server 2000 中的数据库，该数据库为使用它所绑定的应用程序的每个用户使用一个 GUID。不知何故，两个用户最终使用了相同的 GUID。我知道微软使用一种算法来生成一个随机 GUID，它导致碰撞的可能性极低，但碰撞仍然可能吗？

* * *

## 回答 #1

> 赞同：142
> 
>             
> 
> 时间：2008-10-08T21:00:41.027

基本上，没有。我想有人去弄乱你的数据库。根据您使用的版本 GUID，该值要么是唯一的（对于版本 1 GUID 之类的东西），要么是唯一且不可预测的（对于版本 4 GUID 之类的东西）。SQL Server 对其 NEWID() 函数的实现似乎使用 128 位随机数，因此您不会遇到冲突。

对于 1% 的碰撞几率，您需要生成大约[2,600,000,000,000,000,000](http://en.wikipedia.org/wiki/Birthday_attack)个GUID。

* * *

## 回答 #2

> 赞同：118
> 
>             
> 
> 时间：2008-10-08T21:25:46.700

基本上他们**是不可能的！**, 几率是**天文数字的低**。

但是......我是我所知道的世界上唯一一个**曾经有过 GUID 结肠炎的人**（是的！）。

我很确定，这不是一个错误。

它是如何发生的，在 Pocket PC 上运行的小型应用程序中，在操作结束时必须发出具有生成的 GUID 的命令。在服务器上执行后的命令与执行日期一起存储在服务器上的命令表中。有一天，当我调试时，我发出了模块命令（附加了新生成的 GUID），但什么也没发生。我又做了一次（使用相同的 guid，因为 guid 在操作开始时只生成一次），又一次，什么也没有，最后试图找出命令没有执行的原因，我检查了命令表，并且与当前 GUID 相同的 GUID 是在 3 周前插入的。不相信这一点，我从 2 周的备份中恢复了一个数据库，并且 guid 就在那里。检查代码，毫无疑问，新的 guid 是新生成的。

编辑：有一些因素可能会大大增加发生这种情况的机会，应用程序在 PocketPC 模拟器上运行，并且模拟器具有保存状态功能，这意味着每次恢复状态时也会恢复本地时间并且 guid 是基于内部计时器的......而且紧凑框架的 guid 生成算法可能不如 COM 的完整......

* * *

## 回答 #3

> 赞同：37
> 
>             
> 
> 时间：2008-10-08T21:06:54.197

它们在理论上是可能的，但有 3.4E38 个可能的数字，如果您在一年内创建数十万亿个 GUID，那么出现一个重复的机会是 0.00000000006（[来源](http://en.wikipedia.org/wiki/Uuid#Random_UUID_probability_of_duplicates)）。

如果两个用户最终使用相同的 GUID，我敢打赌程序中存在导致数据被复制或共享的错误。

* * *

## 回答 #4

> 赞同：22
> 
>             
> 
> 时间：2008-10-08T23:21:49.883

首先让我们看看两个 GUID 发生冲突的可能性。正如其他答案所述，由于[生日悖论](http://en.wikipedia.org/wiki/Birthday_paradox)，它不是 1 in 2^128 (10^38)，这意味着对于两个 GUID 碰撞的概率为 50% 的概率实际上是 1 in 2^64 (10^ 19) 这要小得多。但是，这仍然是一个非常大的数字，因此假设您使用合理数量的 GUID，发生冲突的可能性很低。

另请注意，GUID 不包含许多人似乎也相信的时间戳或 MAC 地址。这对于 v1 GUID 是正确的，但[现在使用 v4 GUID，它只是一个伪随机数](http://en.wikipedia.org/wiki/Globally_Unique_Identifier#Algorithm)，这意味着冲突的可能性可以说更高，因为它们不再是时间和机器独有的。

所以基本上答案是肯定的，碰撞是可能的。但它们极不可能。

编辑：固定为 2^64

* * *

## 回答 #5

> 赞同：18
> 
>             
> 
> 时间：2008-10-08T22:44:58.710

两个随机 GUID 发生冲突的几率（10^38 中约 1 个）低于未检测到损坏的 TCP/IP 数据包的几率（10^10 中约 1 个）。  [http://wwwse.inf.tu-dresden.de/data/courses/SE1/SE1-2004-lec12.pdf](http://wwwse.inf.tu-dresden.de/data/courses/SE1/SE1-2004-lec12.pdf)，第 11 页。磁盘驱动器、CD 驱动器等也是如此......

GUID 在统计上是唯一的，您从数据库中读取的数据仅在统计上是正确的。

* * *

## 回答 #6

> 赞同：13
> 
>             
> 
> 时间：2008-10-08T23:05:50.710

在这种情况下，我认为[奥卡姆剃刀](http://en.wikipedia.org/wiki/Occam%27s_razor)是一个很好的指南。您极不可能发生 GUID 冲突。您更有可能遇到错误，或者有人在弄乱您的数据。

* * *

## 回答 #7

> 赞同：11
> 
>             
> 
> 时间：2008-10-08T21:06:42.730

请参阅 Wikipedia 的[Globally Unique Identifier](http://en.wikipedia.org/wiki/Guid "全球唯一标识符")文章。有几种方法可以生成 GUID。显然，旧的（？）方式使用了 Mac 地址、一个非常短的单位的时间戳和一个唯一的计数器（用于管理同一台计算机上的快速生成），因此使它们重复几乎是不可能的。但是这些 GUID 被删除了，因为它们可以用来追踪用户......

我不确定微软使用的新算法（文章说可以预测一系列 GUID，看起来他们不再使用时间戳？上面链接的微软文章说了别的......）。

现在，GUID 被精心设计为，按名称，全球唯一，所以我敢冒险这是不可能的，或者概率非常非常低。我会去别处看看。

* * *

## 回答 #8

> 赞同：10
> 
>             
> 
> 时间：2020-09-12T17:56:33.553

你是数学家吗？好的。

你是工程师吗？那就不要。

* * *

## 回答 #9

> 赞同：9
> 
>             
> 
> 时间：2008-10-16T04:25:01.317

两台具有重复 MAC 地址的以太网卡的 Win95 机器将在严格控制的条件下发出重复的 GUID，尤其是当建筑物中的电源关闭并且它们同时启动时。

* * *

## 回答 #10

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T21:16:56.860

我会以“我不是网络人，所以我可能会在后面做出完全不连贯的句子。”作为开头。  

当我在伊利诺伊州立大学工作时，我们有两台戴尔台式机，订购时间不同。我们将第一个放在网络上，但是当我们尝试将第二个放在网络上时，我们开始收到疯狂的错误。经过多次故障排除后，确定两台机器都产生了相同的 GUID（我不确定究竟是为了什么，但它使它们都无法在网络上使用）。戴尔实际上将两台机器都更换为有缺陷的机器。

* * *

## 回答 #11

> 赞同：5
> 
>             
> 
> 时间：2010-10-27T07:40:38.517

我知道人们喜欢 GUID 是神奇的并且保证是唯一的，但实际上，大多数 GUID 只是 121 位随机数（其中 7 位浪费在格式化上）。如果您不习惯使用大随机数，那么您不应该习惯使用 GUID。

* * *

## 回答 #12

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T21:36:14.637

用于生成 GUID 的代码中是否有错误？是的，当然可以。但答案与编译器错误的答案相同 - 您自己的代码更有可能出现错误，所以先看看那里。

* * *

## 回答 #13

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T21:06:23.917

当然有可能……可能吗？不太可能，但有可能。

请记住，同一台机器正在生成每个 GUID（服务器），因此很多基于机器特定信息的“随机性”都会丢失。

* * *

## 回答 #14

> 赞同：2
> 
>             
> 
> 时间：2021-03-29T10:30:41.140

# 广义公式

有一个公式可以估计要生成多少个大小为 S 的值，以使它们中的两个以概率 P 发生碰撞。

变量：

*   位 - 您的数据类型中有多少位。

*   概率 - 碰撞的目标概率。

要发生碰撞，您必须生成：

![2^{\frac{bits + 1}{2}} * \sqrt{-log_2(1 - 概率)}](https://chart.googleapis.com/chart?cht=tx&chl=2%5E%7B%5Cfrac%7Bbits%2B1%7D%7B2%7D%7D*%5Csqrt%7B-log_2(1-probability)%7D)

或者在 Python 中：

```
from math import sqrt, log

def how_many(bits, probability):
    return 2 ** ((bits + 1) / 2) * sqrt(-log(1 - probability)) 
```

# GUID

对于 GUID（128 位），要以 1% (0.01) 的概率发生冲突，您需要：

```
In [2]: how_many(bits=128, probability=0.01)
Out[2]: 2.6153210405530885e+18 
```

...大约 2.6 * 10^18 个 GUID（即**42 EB**的 GUID）。

请注意，此概率会迅速增长。与位数无关，对于 99.99% 的概率，您只需要比 1% 多 30 倍的 GUID！

```
In [3]: how_many(bits=128, probability=0.9999)
Out[3]: 7.91721721556706e+19 
```

# 整数64

相同的数字，但对于 int64 数据类型：

```
In [4]: how_many(bits=64, probability=0.01)
Out[4]: 608926881

In [5]: how_many(bits=64, probability=0.9999)
Out[5]: 18433707802 
```

对于 1% 的冲突概率，您需要 5 GB 的 int64-s。仍然很多，但与 GUID 相比，这是一个更易于理解的数字。

* * *

这就是所谓的[生日问题](https://en.wikipedia.org/wiki/Birthday_problem)——在这篇维基百科文章中，您可以找到比这更精确的估计公式。

* * *

## 回答 #15

> 赞同：1
> 
>             
> 
> 时间：2008-10-31T15:02:09.267

只是为了笑，试试下面的脚本......（适用于 SQL 2005，不确定 2000）

```
declare @table table
(
    column1 uniqueidentifier default (newid()),
    column2 int,
    column3 datetime default (getdate())
)

declare @counter int

set @counter = 1

while @counter <= 10000
begin
    insert into @table (column2) values (@counter)
    set @counter = @counter + 1
end

select * from @table

select * from @table t1 join @table t2 on t1.column1 = t2.column1 and t1.column2 != t2.column2 
```

重复运行（不到一秒钟）从第一次选择产生相当大的范围，即使时间间隔非常短。到目前为止，第二个选择还没有产生任何东西。

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:00:18.407

如果用户有不同的机器和网卡，这是不可能的，即使没有，它仍然是一个非常边缘的几乎理论上的风险。

就我个人而言，我会寻找其他地方，因为它更有可能是一个错误而不是 GUID 冲突......

当然，前提是您不要从 GUID 上切掉一些位以使其更短。

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2016-01-18T20:16:00.077

`NEWID()`如果您通过SQL Server 中的函数之类的东西生成 GUID 冲突，那么您极不可能遇到 GUID 冲突（尽管当然有可能，正如其他答案所强调的那样）。他们没有指出的一件事是，如果您在野外浏览器的 JavaScript 中生成 GUID，实际上很可能会遇到冲突。不仅在不同浏览器中的 RNG 有时会出现问题，而且我还遇到了 Google 蜘蛛似乎缓存此类函数结果的问题，并最终将相同的 GUID 反复传递给我们的系统。

有关更多详细信息，请参见此处的各种答案：

[在 JavaScript 中生成 UUID 时发生冲突？](https://stackoverflow.com/questions/6906916/collisions-when-generating-uuids-in-javascript)

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2022-02-09T12:05:25.513

不要担心它是什么。让它成为不可能。将 GUID 的不可能性与顺序的不可能性混合在一起。只需将我想要的数据库顺序添加到 GUID 并调用它完成。您可能需要将数据类型从 GUID 更改为 String-ish，但它们在存储方面并没有那么不同。

* * *

## 回答 #19

> 赞同：-1
> 
>             
> 
> 时间：2008-10-08T21:11:00.880

当然有可能，甚至可能。并不是每个 GUID 都在可能的数字空间的随机部分中。如果两个线程试图同时生成一个线程，除非某种集中的 GUID 函数带有信号量，否则它们最终可能会得到相同的值。

# wpf - 我在 ControlTemplate 中有一个按钮。我如何获得它的参考？

> ID：184871
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T20:58:12.247
> 
>         
> 
> 标签：wpf, controltemplate

我只想为我正在使用的 WPF 编辑器启用或禁用 ControlTemplate 中的按钮。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2011-08-10T19:49:03.333

我建议通过 RoutedUICommands 轻松控制按钮 - 包括轻松启用和禁用它们。命令不需要对 Button 的任何类型的引用，因此这也解决了您的问题。

看这里：

```
<Window.CommandBindings>
    <CommandBinding 
        Command="{x:Static local:MyCommands.MyCommand}"
        Executed="CommandBinding_Executed"
        CanExecute="CommandBinding_CanExecute" />
</Window.CommandBindings>

<Window.Resources>
    <ControlTemplate x:Key="MyTemplate" TargetType="Label">
        <Button Command="{x:Static local:MyCommands.MyCommand}">
            <TextBlock>
                Click Me
                <TextBlock Text="{TemplateBinding Content}" />
            </TextBlock>
        </Button>
    </ControlTemplate>
</Window.Resources>

<StackPanel>
    <Label Template="{StaticResource MyTemplate}">1</Label>
    <Label Template="{StaticResource MyTemplate}">2</Label>
    <Label Template="{StaticResource MyTemplate}">3</Label>
    <Label Template="{StaticResource MyTemplate}">4</Label>
    <Label Template="{StaticResource MyTemplate}">5</Label>
</StackPanel> 
```

用这个：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void CommandBinding_CanExecute(object sender, System.Windows.Input.CanExecuteRoutedEventArgs e)
    {
        // your logic here
        int _Integer = -1;
        int.TryParse(e.Parameter.ToString(), out _Integer);
        e.CanExecute = _Integer % 2 == 0;
    }

    private void CommandBinding_Executed(object sender, System.Windows.Input.ExecutedRoutedEventArgs e)
    {
        // do something when clicked
    }
}

public static class MyCommands
{
    public static RoutedUICommand MyCommand = new RoutedUICommand();
} 
```

好像：

![截屏](https://i.stack.imgur.com/PqVWG.png)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-08T21:14:44.680

你真的不应该明确地这样做，而应该使用 Triggers`ControlTemplate`本身来设置它。这些触发器将对其他一些更改做出反应，并将设置`Enabled`.`Button`

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T23:06:36.637

我同意 Joel 的观点，首选方法是使用 xaml 标记触发按钮的 Enabled 属性的设置，通过触发器或通过将 Enabled 值绑定到可能在父元素上的另一个依赖项属性，可能借助 a值转换器。

但是，如果您必须在 C# 中显式执行此操作，则可以在按钮的模板属性上使用 FindName() 方法。这里有一个 MSDN 'how to'[链接](http://msdn.microsoft.com/en-us/library/bb613586.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2012-03-23T13:28:53.777

我对 controlTemplates 和 dataTemplates 中的按钮有疑问。我发现触发器通常过于繁琐，无法准确地提供我的客户想要的东西，我最终得到了太多的转换器。我第一次尝试的方法是内联定义这些更难的模板，以便它们可以绑定到我的屏幕 ViewModel 上的命令（和代码隐藏事件）。

如果您正在模板化自己的控件，我应该提到最简单的方法是简单地命名按钮，然后使用如下内容：

```
hourHand   = this.Template.FindName( "PART_HourHand",   this ) as Rectangle; 
```

然而，最近，我已经改变了技巧（回到单独的文件......重用！）但开始添加一个 ViewModel（各种各样的），我将它作为后缀`...TemplateCommandStore`添加到我的所有模板中，这些模板变得有点复杂。我什至在模板化我的自定义控件时使用它（主要是为了保持一致性）

```
public class BookingDetailsTemplateCommandStore
{
    public OpenWindowCommand_Command OpenWindowCommand_Command { get; set; }

    public BookingDetailsTemplateCommandStore()
    {
        OpenWindowCommand_Command = new OpenWindowCommand_Command( this );
    }       
} 
```

然后我可以愉快地在模板中使用这个命令。您还可以通过将（依赖关系？）属性绑定到命令存储来将控件引用传递到命令存储中，以捕获事件并对模板进行更精确的控制。

```
<DataTemplate DataType="{x:Type LeisureServices:BookingSummary}">
    <Border Height="50" otherStyling="xyz">
        <Border.Resources>
            <local:BookingDetailsTemplateCommandStore x:Key="CommandStore" />
        </Border.Resources>
        <DockPanel>
            <Button otherStyling="xyz"
                    Command="{Binding Source={StaticResource CommandStore},
                                      Path=OpenWindowCommand_Command}" /> 
```

*MVVM：*我发现只要图形逻辑就是这样，并且与业务逻辑完全不同，这种方法就不会干扰 MVVM。本质上，我为模板添加了一致的 C# 代码能力，任何在 winforms 上花费太多时间的人都可能会像我一样错过它。

# performance - 衡量应用程序性能的技术

> ID：184873
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-08T20:58:26.087
> 
>         
> 
> 标签：performance, concurrency, max

我维护了一个应用程序，在两年的时间里，由于插入的新用户/新数据的数量，它不断需要新硬件才能使用。然而，有时很难证明投资的合理性。

我开始想知道——如何确定 Web 应用程序当前支持的最大用户数？

我曾想过使用 JMeter 脚本，但是当必须模拟文件传输和决策树时，它们的实现会变得非常糟糕。你们都用什么？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T21:04:33.670

您可以使用此性能算法：

[http://i.msdn.microsoft.com/cc500561.fig02_L(en-us).gif](http://i.msdn.microsoft.com/cc500561.fig02_L(en-us).gif)

> **R**响应时间。从用户请求页面（通过单击链接等）到整个页面在用户计算机上呈现的总时间。通常以秒为单位。Payload 发送到浏览器的总字节数，包括标记和所有资源（例如 CSS、JS 和图像文件）。
> 
> **带宽**进出浏览器的传输速率。如果给定页面是从多个来源生成的，这可能是不对称的并且可能代表多种速度。通常，将其平均在一起以创建以每秒字节数表示的单个带宽。
> 
> **AppTurns**  给定页面需要的资源文件数。这些资源文件将包括 CSS、JS、图像以及浏览器在呈现页面过程中检索到的任何其他文件。在等式中，HTML 页面通过在 AppTurns 表达式之前添加往返时间 (RTT) 来单独说明。
> 
> **RTT 往返**   所需的时间，与传输的字节数无关。每个请求至少为页面本身支付一个 RTT。通常以毫秒为单位。
> 
> **并发请求**   数浏览器将对资源文件发出的同时请求数。默认情况下，Internet Explorer 执行两个并发请求。此设置可以调整，但很少调整。
> 
> **Cs**    在服务器上计算时间。这是代码运行、从数据库中检索数据以及编写发送到浏览器的响应所需的时间。以毫秒为单位。
> 
> **Cc**    在客户端计算时间。这是浏览器实际在屏幕上呈现 HTML、执行 JavaScript、实现 CSS 规则等所需的时间。

更多细节：

[http://msdn.microsoft.com/en-us/magazine/cc500561.aspx](http://msdn.microsoft.com/en-us/magazine/cc500561.aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:04:09.897

我们使用惠普的[LoadRunner](http://en.wikipedia.org/wiki/LoadRunner)。但它并不便宜，而且你仍然需要创建脚本、测试用例。

# wcf - 通过命名管道绑定公开 WCF 服务

> ID：184878
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2008-10-08T20:58:44.040
> 
>         
> 
> 标签：wcf, named-pipes, service-discovery, netnamedpipebinding

## 介绍：

几天前，我成功实现了托管在 Windows 服务中的 WCF 服务。StackOverflow 的社区在这里帮助我了解[了 WSDL](https://stackoverflow.com/questions/167852/wsdl-url-for-a-wcf-service-basichttpbinding-hosted-inside-a-windows-service)。我再次感谢你。但是最近我发现这次服务的另一个潜在客户端与该服务位于同一台机器上，这使我认为我应该使用 namedPipesBinding 添加另一个端点。

就我而言，命名管道似乎是机器内通信的最佳解决方案。**如果这是错误的，请**纠正我。

## 问题：

我需要为同一服务/合同公开另一个端点，但这次使用 netNamedPipeBinding。但是我真的不明白如何才能添加来自客户端的服务引用。添加后愚蠢

```
<endpoint address="net.pipe://localhost/OfficeService"
          binding="netNamedPipeBinding"
          contract="netBridge.Development.OfficeService.IWordService"
          bindingConfiguration="localBinding" /> 
```

我试图在位于同一台机器上的 Windows 窗体应用程序中添加服务引用，键入 net.pipe://.... url。它没有用。我必须提到我之前已经删除了 mex（元数据交换）端点，因为我认为没有必要。

1.  命名管道端点绑定发现是否需要此 mex 端点？

2.  我应该如何将客户端应用程序中的服务引用添加到命名管道端点？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2008-10-08T21:27:08.647

您的端点看起来不错，尽管我很好奇 localBinding 中的内容......

听起来最简单的选择就是更改命名管道客户端上的端点配置以匹配您的服务端点。只要它是客户端配置文件中的唯一端点，客户端就不应该关心它。否则，您必须向端点添加名称，并在您新建代理对象时让客户端选择一个特定的名称。

祝你好运！

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-06-19T12:06:56.217

mex 端点在开发过程中是必需的，因为它提供了构建 wsdl 的 http 位置。wsdl 向客户端描述如何通过命名管道、TCP/IP 或其他任何方式与服务器通信。一旦客户端应用程序构建了命名管道绑定的代理并设置了配置，就不再需要 mex 端点。因此，如果需要，可以在通过环境部署之前删除 mex 端点。

# .net - 哪个 Facebook .NET 库最好用？

> ID：184880
> 
>         
> 
> 赞同：27
> 
>         
> 
> 时间：2008-10-08T20:58:47.427
> 
>         
> 
> 标签：.net, asp.net, asp.net-mvc, facebook, facebooktoolkit

[这里](http://www.marketing-ninja.com/old-stuff/list-of-facebook-sdks-for-net/)有一个项目列表，主要是[Facebook Developer Toolkit](http://www.codeplex.com/FacebookToolkit)和[Facebook.NET](http://www.nikhilk.net/FacebookNET.aspx)。但是，我看到了很多关于该工具包的负面反馈，而且 Facebook.NET 似乎还没有升级到最新的 facebook API。

这些中的任何一个都值得使用吗？还有其他好的图书馆吗？

具体来说，我希望在 ASP.NET MVC 应用程序中使用该库。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2008-10-25T08:35:01.997

我也开始尝试使用 Facebook 开发者工具包 (FDT)，但在 Facebook.NET 中放弃了它。[在http://www.codeplex.com/fbnet](http://www.codeplex.com/fbnet)有后者的一个分支，它慢慢地涵盖了 Facebook API 的最新变化。看看这篇文章，因为它有一些有趣的 Facebook.NET 和 MVC 集成点[http://www.coderjournal.com/2008/06/mvc-facebook-wonderful-development-platform/](http://www.coderjournal.com/2008/06/mvc-facebook-wonderful-development-platform/)

FDT 主要是为 WebForms 制作的，你需要一些时间才能将它与 MVC 正确集成。Matt 是对的：FDT RC2 的文档（我上次检查时）已经过时且具有误导性。如果您打算使用它，请同时查看[http://corcoranpstech.blogspot.com/2008/06/facebook-mvc.html](http://corcoranpstech.blogspot.com/2008/06/facebook-mvc.html)

您还可以在此处找到一个很有前途的库（尽管仍处于 alpha 阶段）（Facebook API for .NET）：http: [//facebook.codeplex.com/](http://facebook.codeplex.com/)

最新添加：现在唯一应该检查的库是[http://facebooksdk.codeplex.com/](http://facebooksdk.codeplex.com/)

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-11-10T15:10:47.637

仅供参考，FDT 的 2.0 版本最近才正式发布，并且已经做了很多工作来修复错误并与当前的 API 更加兼容（完全公开 - 我是该项目的维护者之一）。

该项目已经死了一段时间，但我会尝试从现在开始让它保持最新状态，所以你可以试一试。此外，我们将尝试更好地评估和接受来自社区的补丁，因此，如果您发现某些内容不起作用，请随时提交补丁。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-10-30T17:06:34.400

我想我们已经很冷了。

CodePlex 工具包是一个彻头彻尾的噩梦，几乎所有尝试使用它的人都说。目前的状态是他们发布了一个 2.0 版本，它不向后兼容旧的东西，也不支持最新的 Facebook API 更改。旧版本（1.7 及更低版本）不再受支持，现在使用最新的 API 进行破坏。新版本有缺陷且不完整，已被开发者有效地抛弃，并且与最新的 API 不兼容。而且我知道的每个版本都只有 3.5，这意味着你还不能将它投入生产。

简而言之，这几乎是最坏的情况。在有人站出来推出一个工作库之前，你最好还是自己动手。我个人的基础是[facebook-c-sharp](http://code.google.com/p/facebook-c-sharp/)库，它是轻量级的，基本上可以工作。它仅适用于 winforms，因此您需要撕掉几乎所有内容并只使用 REST 包装器，但它会节省大量的入门工作。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2010-07-17T01:44:30.510

由 Facebook 工程师打造的那一款？
[http://developers.facebook.com/blog/post/395](http://developers.facebook.com/blog/post/395)

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2008-11-25T17:33:14.030

我已经将 FDT 用于几个小应用程序。有很多普遍的 borkyness，但据我所知，其中大部分源于 Facebook API 是一个高速移动的目标，并且文档很少（在引入新的配置文件设计时尤其如此）。我认为不应该因为 FDT 开发人员缺乏兼容性而责备它，因为这可能主要是由于 facebook 退休或更改核心功能。

（尽管我建议了一些补丁，但我不隶属于 FDT）。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2009-11-09T18:56:58.703

刚刚看到这是今天发布的：[Microsoft 的 Facebook SDK](http://msdn.microsoft.com/en-us/windows/ee388574.aspx)。

> 该工具包作为 Facebook 客户端库提供，类似于 Facebook 的 PHP 客户端库或 Facebook 的 JavaScript 库。目标是使 .NET 开发人员能够快速轻松地利用 Facebook 平台的各种功能。随着社区和 Microsoft 的投入，该工具包随着时间的推移而发展。最新版本 (v3.0) 包括新的体系结构改进，并提供了一个异步接口，用于使用 Silverlight 和 WPF 中的工具包。

对于 .NET 开发人员来说，这似乎是目前最好的选择。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2010-10-22T06:01:02.767

我建议直接使用 facebook 的 API。几个月前，当我调查 SDK 时，我发现它们都已经过时并且是一个难以驾驭的雷区。facebook 的 SDK 遵循 REST 标准，所以应该很容易上手。此外，使用 facebook 的 API 带来的所有痛苦（例如错误、API 一直在变化）在使用 SDK 时仍然存在，但如果您编写自己的代码，您会更容易处理他们。此外，当 facebook 进行更改时（他们一直在这样做，包括他们今天提出的另一项更改），您不必等待 SDK 更新。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T21:55:35.003

Facebook Developer Toolkit 对于我所需要的一切都很好。然而，值得一提的是，至少截至 9 月，Facebook 开发人员工具包的文档、示例和教程与其当前版本（Release Candidate 2）相比已经过时，对于新开发人员来说可能是一个雷区。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T15:43:46.403

Facebook 开发者工具包曾经非常糟糕。现在 2.0 版已经发布，看起来很棒。这是一篇文章。

[如何使用 Facebook 开发者工具包 2.0 - Devtacular](http://devtacular.com/articles/bkonrad/how-to-use-the-facebook-developer-toolkit-20/ "如何使用 Facebook 开发者工具包 2.0 - Devtacular")

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-02-03T22:37:59.013

我刚刚遇到的另一个选项是[Silverlight Facebook Client Side API v0.001](http://azurecoding.net/blogs/icbtw/archive/2009/01/22/silverlight-facebook-api.aspx)。仍处于演示/ poc 阶段，但看起来很有希望。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-03-02T02:13:58.560

不要在知道创建和支持它的咨询公司的情况下使用 Developer toolkit。我不信任创建该工具包的 Clarity Consulting 创建的任何东西（错误、方法太长、过度编码以及怪异且低效的编码实践）。请记住，Clarity 非常重视在他们的许多本土解决方案中使用数据集（优秀的开发人员和架构师不要使用数据集，无论应用程序有多大或多小……它们都是垃圾。）。当然，该框架中没有数据集（感谢上帝），但这就是该公司背后的心态。  

事实上，如果您想要完全控制，即使需要更多的工作，也可以为 Facebook 推出自己的包装器。否则，我会使用 Facebook.NET API，在我看来，它的编码非常好，并且是由一位 MS 大师完成的。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T16:11:43.757

以下页面提供了一个使用 mvc 的出色（且简单）端口。
[http://onishimura.com/2009/04/13/facebook-and-aspnet-mvc](http://onishimura.com/2009/04/13/facebook-and-aspnet-mvc)

在 FB Developer 页面中，它提供了一个指向 MVC 的 Addon 链接，我发现它仅适用于 toolkit 1.X 而不是 2.0。并且需要将 ViewPage 扩展到其他母版页，使得 FB API 无法访问 MVC 的控制器（我看不出 View 应该直接控制它）。上面提到的链接提供了这样一个端口来创建 api 对象并将其放入控制器可以访问的 TempData 字典中。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-10-26T16:59:05.770

Facebook Developer Toolkit 即将发布 3.0 版本（预计 10 月底）。请参阅此[博客文章](http://blogs.claritycon.com/blogs/kevin_marshall/archive/2009/10/06/facebook-developer-toolkit-3-0-asp-net-mvc-sample.aspx) 

我一直在为使用 ASP.NET MVC 的 Facebook 应用程序使用最新的 FDT 3.0 源代码，并且它非常易于使用。Codeplex 论坛中的示例代码、文档和过去的问题/答案涵盖了我在加速使用该库时遇到的所有问题。

.NET 的其他库根本没有得到维护，也没有足够的使用量或社区参与来帮助您作为开发人员取得成功。我花了很多时间试图让我的应用程序与“.NET Facebook API 客户端”一起工作，但该社区几乎没有生命迹象，这让我放弃了它。

我没有尝试 Facebook.NET，因为自 2008 年 1 月以来它没有任何源代码签入，这对于像 Facebook API 一样快速移动的目标来说并不是一个好兆头。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2010-10-12T14:13:49.140

正如我在[#3908765](https://stackoverflow.com/questions/3908765)上发布的那样，我发现[Facebook#](http://github.com/prabirshrestha/FacebookSharp)非常好，尽管我不得不解决一些问题。不完美，但肯定是一个很好的起点。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2011-04-19T17:39:56.167

您可能想在[这里](http://fbapi.blogspot.com)尝试我为社交图谱开发的新 API 。

它易于使用，虽然解锁需要花费 50 美元，但它可以轻松地为您节省数小时摆弄其他图书馆的时间。当我在我的核心网站上使用我自己的库时，它也会不断更新。这意味着您不必担心它会损坏，事实上它的设计方式是，如果 FB 更改了它们的对象，它仍然可以工作（不会损坏）。

请试一试，让我知道它对你有用。

# user-interface - 在可编辑表中通知用户输入验证失败的有效方法

> ID：184923
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-08T21:06:38.893
> 
>         
> 
> 标签：user-interface, validation

我正在寻找有关如何有效地通知用户他们对可编辑表的输入无效的想法。例如，如果表格的一列代表美国邮政编码，并且用户在单元格中输入邮政编码“85rr3”，您将如何通知用户该问题？  

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T21:08:01.573

输入后我可能会用红色突出显示它，然后可能会在表格顶部显示警告。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:13:03.433

键入时突出显示该字段是一种不错的方法，或者您可以走 MS Access 路线并等到移出单元格，通知用户，然后将他们带回单元格直到它被修复（或选择点击Esc 或其他操作撤消该单元格中的所有更改并离开“编辑模式”）

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-11T06:37:40.520

在 .net WinForms 中，您可以使用错误提供程序控件

[错误提供程序 http://pages.google.com/edit/tim.yen/ErrorProvider.png/ErrorProvider-full;init:.png](http://pages.google.com/edit/tim.yen/ErrorProvider.png/ErrorProvider-full;init:.png)

无效时将错误消息附加到控件

errorProvider1.SetError(textBox1,"错误信息");

并在消息有效时清除消息

errorProvider1.SetError (textBox1,"");

您可以使用图标对齐和填充字段来定位图标的位置

*   errorProvider1.SetIconAlignment (textBox1, ErrorIconAlignment.MiddleRight);

*   errorProvider1.SetIconPadding (textBox1, 2);

* * *

## 回答 #4

> 赞同：-4
> 
>             
> 
> 时间：2008-10-08T21:11:02.860

我认为如果它不是有效的邮政编码，只需删除该值就足够有效。

# firefox - window.resizeTo 影响后续的 Firefox 窗口

> ID：184927
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-08T21:07:14.540
> 
>         
> 
> 标签：firefox, user-interface, resize, user-experience

我有一个 webapp 可以调整其窗口大小以完全适合其内容：

```
window.resizeTo(200,300) 
```

人们确实喜欢以这种方式让页面适合其窗口。然而，对于 Firefox，用户打开的下一个浏览器窗口以相同的大小出现，这非常小。

有没有办法告诉 Firefox 调整当前窗口的大小，但不改变其后续窗口应该有多大的概念？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T21:14:51.170

> 人们确实喜欢以这种方式让页面适合其窗口。

*哪些*人？！如果一个网页对我的浏览器窗口大小有任何影响，我会非常恼火。幸运的是，FF 还允许用户禁用移动或调整现有窗口的大小，这是我多年来一直使用的功能。

您应该能够使用 以特定大小打开一个*新*[`window.open`](http://developer.mozilla.org/en/DOM/window.open)窗口，因此您可以使用它......或者更好的是，只允许您的文档调整大小/重排以适应用户喜欢的任何窗口大小。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-08T21:21:50.423

这里有两个不同的问题：

**1\. 指定窗口尺寸-**

**使用window.open**指定窗口属性不会影响其他窗口的尺寸。

您正在从 Firefox 获得关于 resizeTo 函数的**预期行为。**

**2.用户体验-**

用户最看重的是**保持**对他们的环境和您的产品的控制。让他们调整浏览器窗口的大小很重要。浏览器是他们桌面机器上的一个应用程序，大多数窗口操作系统让用户可以控制窗口的大小和位置。控制窗口的大小是进入他们**个人工作空间**的一个步骤。

我同意@Shog9，你应该重新考虑你对 window.resizeTo. 的使用。**强制窗口**为任何特定大小可能是不合适的，除非是在**popup**的情况下。使用[**Liquid 布局**](http://search.atomz.com/search/?sp-q=liquid+layout&x=0&y=0&sp-a=sp1002d27b&sp-f=ISO-8859-1&sp-p=All&sp-k=All)**可以帮助您为任何合理的窗口尺寸**实现可接受的设计。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T22:11:40.213

啊，我有一个天气网站这样做：尝试生成一个弹出窗口（最终成为一个新选项卡）并调整它的大小（从而调整整个 Firefox 浏览器的大小！）。

不用说我讨厌它。

一些弹出窗口被阻止，其他弹出窗口设法显示为弹出窗口，其他则转到新选项卡。这取决于生成它们的方法和浏览器/扩展设置。几乎不可能控制，更不用说跨浏览器的方式了。

现代的方式（对广告来说仍然很烦人！）是做 div 覆盖，少一点干扰。当然，它可能并不适合所有需求。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-09T00:05:32.433

只是想补充一点，您最好的办法是避免使用 window.open 并改用某种 LightWindow 框架 - 更好，在所有浏览器上的行为都相同，并且不受浏览器选项的影响。您可以在此处查看示例框架[http://www.stickmanlabs.com/lightwindow/](http://www.stickmanlabs.com/lightwindow/) 

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-12T06:01:18.720

强烈同意几乎在所有情况下，调整视口大小的网站都非常糟糕。

应用程序窗口的大小是由用户决定的，而不是由网站所有者来决定的。  

在极少数情况下，它可能有一个很好的论据，或者客户可能只是坚持它，因为“他们知道得更好”，但它总是很糟糕。  

对于大多数用户来说，这是一个巨大的烦恼，尤其是当您以 1600 像素宽打开 17 个标签时，并且一些印刷设计师规定您打开的下一个标签应强制所有其他标签为 300 像素宽。    

使用诸如厚/浅/灰色/细框技术之类的东西对用户来说更加友好。  

我只是找到其他网站，或者运行一个greasemonkey 脚本来避免网站这样做。  

只好为此吐槽。对不起。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T23:57:58.157

作为已经提到的海报之一，唯一的方法是在通过 window.open 打开新弹出窗口时设置宽度和高度 - window.open(' [http://www.google.com](http://www.google.com) ', 'Test', '宽度=800，高度=800'); Window.resizeTo 从未在 Firefox 中工作过，无论出于何种原因，政治或技术。显然，Firefox 开发人员设法在 Firefox 3.01 中破坏了 window.open()，请参阅此博客文章 - 
 [http://tough-to-find.blogspot.com/2008/07/firefox-301-breaks-windowopen-width。 html](http://tough-to-find.blogspot.com/2008/07/firefox-301-breaks-windowopen-width.html)  

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2011-12-08T01:34:50.557

以下是一些相关信息，可以帮助用户阅读这篇文章。

Firefox 一直被迫取消对 window.resizeTo 的支持，并且它出现了一段时间。请参阅
[http://kb.mozillazine.org/Resizing_oversize_window#JavaScript_no_longer_allowed_to_resize_windows](http://kb.mozillazine.org/Resizing_oversize_window#JavaScript_no_longer_allowed_to_resize_windows)

您可以在 Firefox 中禁用窗口大小调整：http:
 [//www.howtogeek.com/howto/internet/firefox/disable-web-site-window-resizing-in-firefox/](http://www.howtogeek.com/howto/internet/firefox/disable-web-site-window-resizing-in-firefox/)

如果您启用了 JavaScript 窗口大小调整但仍然无法正常工作，那么您可能安装了 Firebug。禁用 Firebug 并重新启动 Firefox，window.resizeTo 将再次起作用。见这里：[https ://bugzilla.mozilla.org/show_bug.cgi?id=565541#c47](https://bugzilla.mozilla.org/show_bug.cgi?id=565541#c47)

至于是否应该调整窗口大小，我想不出很多情况，但我知道一个，所以我会分享它。我编写了一个带有可选导航窗格的帮助窗口。我有一个按钮，允许用户显示/隐藏导航窗格。当他们显示它时，我会为他们调整窗口大小，以便为导航窗格留出空间。在这种情况下，它是用户发起的，所以它不会惹恼用户。但是，禁用 resizeTo 会使这变得不可能，从而降低用户体验（在这种情况下）。在大多数情况下归结为大多数工具可以用于好或坏。越体贴的人，使用酷工具的问题就越少。

# build - 构建服务器的推荐规范

> ID：184940
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-08T21:10:00.260
> 
>         
> 
> 标签：build, cruisecontrol.net

我们正在使用 CruiseControl.NET 来管理我们的构建，并且我们正在获取一个新的构建服务器。我的任务是提出新服务器的规范。

该服务器将需要尽可能高效地同时运行多个构建。

您认为该服务器的理想规格是什么？

任何与该主题相关的现有文章/博客的链接也将受到欢迎！

编辑：RAID 会有帮助吗？（奖励积分）

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:18:37.200

基本上，您正在寻找与在开发人员机器中寻找的相同的东西：

1.  尽可能多的 RAM（请记住，您需要运行 64 位操作系统才能利用超过 3gig 的优势）

2.  您能负担得起的最快的磁盘

3.  尽可能多的核心

如果您使用 MSBUILD 并且没有进行太多并发构建，我建议您使用并行构建开关（[http://www.hanselman.com/blog/FasterBuildsWithMSBuildUsingParallelBuildsAndMulticoreCPUs.aspx](http://www.hanselman.com/blog/FasterBuildsWithMSBuildUsingParallelBuildsAndMulticoreCPUs.aspx)）。对于并发构建，最好让构建坚持单个进程（和核心）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-09T16:52:51.230

我还要指出，上述所有建议都取决于您用于编译的内容。例如，如果您使用 VisualStudio 命令行，那么您第一次尝试并发构建时会非常难过。如果它们是并发的，还将进行多少构建。大多数人尝试过多地加强构建服务器，处理器很少是瓶颈。磁盘 I/O 通常是罪魁祸首。您还需要分析您的构建有多少可以并行运行，或者是订单类型的依赖重构建项目？通常，您应该让硬件专家分析当前的构建（构建），他们通常可以对它们提出建议。我们实际上使用虚拟化构建服务器 (6)，它们都运行在具有 4 GB RAM 的单个四核上，它的运行速度几乎与它们各自在服务器上直接运行时一样快。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-08T21:14:39.953

确保规格包括多核处理器和快速 HDD (10000RPM)。

# c# - Error with C# Partial classes

> ID：184970
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2008-10-08T21:16:15.347
> 
>         
> 
> 标签：c#, partial-classes

I am using partial classes to split some functionality between 2 files, but I am getting an error.  What am I doing wrong?

A1.cs:

```
private partial class A
{
    private string SomeProperty { get { return "SomeGeneratedString"; } }       
} 
```

A2.cs:

```
private partial class A
{
    void SomeFunction()
    {
        //trying to access this.SomeProperty produces the following compiler error, at least with C# 2.0
        //error CS0117: 'A' does not contain a definition for 'SomeProperty'
    }
} 
```

* * *

## 回答 #1

> 赞同：40
> 
>             
> 
> 时间：2008-10-08T21:17:43.347

Are the two partial classes in the same namespace? That could be an explanation.

* * *

## 回答 #2

> 赞同：35
> 
>             
> 
> 时间：2017-07-25T02:03:21.167

Same answer as @Andrey K but in simple terms

**Set the build action of all your partial classes to 'Compile' using the 'Properties' windows of each of those files**

[![Properties window -> Build action property](https://i.stack.imgur.com/eLv99.png)](https://i.stack.imgur.com/eLv99.png)

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T21:18:15.513

different namespace?

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-10-08T21:48:35.953

At first, I was unable to reproduce your error. 

When these partial classes are defined alone, inside a namespace, the private keyword causes the build to fail with "Elements defined in a namespace cannot be explicitly declared as private, protected, or protected internal"... 

If I keep them private and nest them within another class, everything works fine.

I can reproduce your error only when, in one file, I have part of the class nested inside another class, and in another file, I do NOT nest the class, and then remove the private keyword... like this:

Class1.cs:

```
namespace stackoverflow.answers
{
    public class Foo
    {
        private partial class Bar
        {
            private string SomeProperty { get { return "SomeGeneratedString"; } }
        }
    }
} 
```

Class2.cs:

```
namespace stackoverflow.answers
{
    partial class Bar
    {
        void SomeFunction()
        {
            string bar = this.SomeProperty;
        }
    }    
} 
```

I also get the error you described if the namespaces differ. 

Please post the entire code for the solution, because the provided code is invalid C# syntax, and can't be looked into without more context. 

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2015-08-05T12:01:55.887

**Edit:**

solution: build action -> Complile, nothing else

I'll try to be more specific:

I had a class shared among 3 partial classes in 3 different files. At one moment a function call (from one part, of a function declared in other part) started showing error "does not exist in current context". It took me long until some guy [helped](https://ru.stackoverflow.com/questions/439998/%D0%9D%D0%B5-%D0%B2%D0%B8%D0%B4%D0%BD%D0%B0-partial-%D1%81%D0%BE%D1%81%D1%82%D0%B0%D0%B2%D0%BB%D1%8F%D1%8E%D1%89%D0%B0%D1%8F-%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B0-namespase-%D0%BE%D0%B4%D0%B8%D0%BD-%D0%B8-%D1%82%D0%BE%D1%82-%D0%B6%D0%B5) me to figure out that accidentally i set the build action of the file with one part to "EmbeddedResourse" instead of "Compile".

To switch build action you should right click on file in solution explorer, then choose properties. Then change the build action.

This question is old, and my answer is not exactly helpful in this very case. But it may be helpful in one other very rare case related to partial classes. Sorry if my English is not clear.

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:21:02.123

I think it's because you're declaring your class as "private". Try changing the modifier to "internal" so that the two "halves" of the class can "see" each other within the same assembly.

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T21:21:52.950

The error I get is:

> Elements defined in a namespace cannot be explicitly declared as private, protected, or protected internal

I'm guessing it's a namespace issue as previously stated.

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2018-12-24T19:35:24.203

All the files should be in the same folder.

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2010-10-21T15:13:15.347

I analyze your code. you declared partial class as nested class this is cause to show error. why bcz partial class will not declare as nested class the parial keyword is split into ultiple files so, every file nae is same when you declared in nested class it will not recognize.

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2018-07-16T12:19:19.387

A corner case where additional help can save you time is if you are using a partial class to complement a Run-time Text Template's generated class.

Chances are that the problem is indeed that your partial class' namespace is different from the namespace of the generated part of that class. To check that, simply look at the generated code.

To fix that, you need to edit the `.csproj` file for your project, and in the section about that template, add the `<ClassNamespace>` tag:

```
<Content Include="MyTemplate.tt">
  <Generator>TextTemplatingFilePreprocessor</Generator>
  <ClassNamespace>My.Namespace</ClassNamespace>
  <LastGenOutput>MyTemplate.cs</LastGenOutput>
</Content> 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2021-12-07T22:07:46.187

Same namespace in textual context just a **different case** on the words; which actually puts them into different compiler namespaces.

* * *

## Example

Note the case of `O` in **overflow**.

### File 1:

```
namespace StackOverflow {
public partial class MyVM 
```

### File 2:

```
namespace Stackoverflow {
public partial class MyVM 
```

Turns out somewhere in the past ten years my default project name became different that my original project name, but only in case. Uggg.

* * *

## 回答 #12

> 赞同：-3
> 
>             
> 
> 时间：2020-10-01T14:25:16.840

Just for reference (VS 2020)... Error CS0103 => All same but different folder.

But classes should have same namespace AND ALSO BE in same folder !!!

Although they could be defined in the same namespace, both files should be in the same folder. I know that the folder structure should reflect the namespace but for clarity between the generated code and my added code, I wanted to separate by folder, but it does not works.

# java - Java 色彩空间支持

> ID：184983
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T21:19:07.730
> 
>         
> 
> 标签：java, color-scheme

我需要获取一个 BufferedImage 并将其转换为 YCbCr 格式，以便我可以对其进行更有效的亮度/对比度操作，但我不知道如何做到这一点。我已经尝试过 ColorConvertOp，但似乎没有适合 YCbCr 的 ColorSpace（尽管它有一个类型？）。  

我可以手动进行转换（转换并不困难），但这会立即将我的图像踢出“快速路径”。有谁知道解决方案？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-08T22:03:13.910

我对 YCbCr 不熟悉，我刚刚看到（在维基百科中）它被 Jpeg 图像使用......直觉上，如果我玩亮度，我会改用 HSB。

我看到这就是 Jerry 对他的[Java Image Filters](http://www.jhlabs.com/ip/filters/index.html "Java 图像过滤器") (HSBAdjustFilter) 所做的。来源是可用的，也许你可以在那里找到一个想法。

无论如何，向我们展示您迄今为止所做的尝试可能会帮助我们帮助您...

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-14T21:16:13.273

检查 JAI，[http://java.sun.com/javase/technologies/desktop/media/jai/](http://java.sun.com/javase/technologies/desktop/media/jai/)它可以做到这一点以及更多。

也许您可以使用普通的 java.awt.color.ColorSpace 进行转换，但我通常在需要处理图像处理时使用 JAI。

# iphone - 链接文件的所有者和视图控制器 [iPhone SDK]

> ID：184985
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-08T21:20:44.213
> 
>         
> 
> 标签：iphone, cocoa, xcode, interface-builder

就能够在 ViewController 和 View 窗口之间建立关系而言，我似乎遇到了 iPhone SDK 2.1 的问题。就 Cocoa Touch 类而言，我继续前进并添加了一个
`UIViewController`子类。我确保目标是现有项目的一部分。之后我添加了一个用户界面-> 查看 XIB。在`UIViewController`我有一些直接的代码，我从其他地方的示例代码中复制/粘贴：

编辑视图控制器.h：

```
@interface EditorViewController : UIViewController <UITextFieldDelegate> {
    UITextField *field;
}

@property(nonatomic, retain) IBOutlet UITextField *field;
@end 
```

编辑视图控制器.m

```
#import "EditorViewController.h"

@implementation EditorViewController

- (BOOL)shouldAutorotateToInterfaceOrientation:
         (UIInterfaceOrientation)interfaceOrientation {
   // Return YES for supported orientations
  return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
}

- (void)dealloc {
   [super dealloc];
}

@end 
```

如您所知，它没有多大作用。现在，当我单击我的新 xib 并使用 引用类标识时`EditorViewController`，不会发生自动完成，这对我来说意味着它没有对
`EditorViewClass`. 当我尝试控制并单击从视图到文件所有者时，我得到了 nada。

在这个过程中，我忽略了哪些可能的特性不允许我将视图输出到控制器？

除了将项目名称作为目标检查之外，我还如何确保我的用户界面视图 XIB 与项目相关联？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-08T21:49:35.217

（这似乎不是 iPhone 特有的——它是任何平台的一般问题。）

几乎不清楚这意味着什么：“现在，当我单击我的新 xib 并使用 EditorViewController 引用类标识时，不会发生自动完成，这对我来说意味着它没有对 EditorViewClass 的这种认识。”

您的意思是您选择了 File's Owner 并尝试将其类设置为 EditorViewController，但 Interface Builder 没有为您自动完成类名？

如果是这种情况，是否与项目关联的 xib 文件？

其他不直接相关的点：

最佳实践是现在将 IBOutlet 与属性关联：

```
@interface EditorViewController : UIViewController
{
    UITextField *field;
}
@property(nonatomic, retain) IBOutlet UITextField *field;
@end 
```

您还应该释放文本字段`dealloc`：

```
-(void)dealloc {
    [textField release];
    [super dealloc];
 } 
```

您的问题的格式使您很难看到您编写的代码。术语也是“奇怪的”——outlet 不是动词：

“在这个过程中，我忽略了哪些可能的特性不允许我将视图输出到控制器？” 你的意思是：“有什么我可能忽略的东西意味着我无法将控制器的视图出口连接到 Interface Builder 中的视图吗？”

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-29T21:39:54.810

它应该像选择文件所有者并在类框中输入类的名称一样简单（它应该自动完成并且也在下拉菜单中）。确保您没有尝试将类设置为视图本身。

# php - Zend 框架中的自定义过滤器/验证器

> ID：184996
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2008-10-08T21:22:55.677
> 
>         
> 
> 标签：php, zend-framework

我有一个 Zend Framework 应用程序结构如下：

```
/application
/library
    /Zend
    /Core
        /Filter
            /MyFilter.php
        /Validator
            /MyValidator.php 
```

我想将自定义过滤器和验证器放在各自的文件夹中，并在使用时自动加载它们。但是，我无法弄清楚如何最好地做到这一点。

我需要以这种方式使用 Zend_Filter_Input 的解决方案：

```
$filters = array(
    'month'   => 'Digits',
    'account' => 'StringTrim',
    'other'   => 'MyFilter'
);

$validators = array(
    'account' => 'Alpha',
    'other'   => 'MyValidator'
);

$inputFilter = new Zend_Filter_Input($filters, $validators); 
```

我已经知道的：

*   Core_Filter_MyFilter 实现 Zend_Filter_Interface

*   显然，过滤器和验证器已经在我的包含路径中。

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2008-10-08T22:46:17.227

我`Zend_Filter_Input`在 2007 年设计并实施。

您可以添加新的类前缀来帮助加载您的自定义过滤器和验证器类。默认情况下，`Zend_Filter_Input`搜索具有前缀`"Zend_Filter"`和的类`"Zend_Validate"`。试试这个：

```
$inputFilter->addNamespace('Core_Filter'); 
```

在运行`isValid()`对象或其他方法之前。  

或者，您也可以在 options 数组中传递一个新的类前缀字符串，即`Zend_Filter_Input`构造函数的第四个参数：

```
$options = array('inputNamespace' => 'Core_Filter');
$inputFilter = new Zend_Filter_Input($filters, $validators, $data, $options); 
```

[另请](http://framework.zend.com/manual/1.12/en/zend.filter.input.html#zend.filter.input.namespaces)参阅我为`Zend_Filter_Input`.``******* 
```