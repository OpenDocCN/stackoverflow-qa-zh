# StackOverflow 问答 000388000-000388999

# database - 可以重复应用并产生相同结果的数据库操作？

> ID：388007
> 
> 赞同：8
> 
> 时间：2008-12-23T02:24:54.270
> 
> 标签：database, computer-science, set-theory

我正在画一个空白，或者像某些人所说的那样，有一个高级的时刻。我知道这个概念有一个正式的定义和一个名称，如果重复运行，在数据库中运行的 db 操作（存储过程）将产生相同的结果。

这是数学家的自反、对称、传递等类型的东西。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-23T02:33:36.343

您的意思是“确定性” - 如果使用相同的输入调用，总是会返回相同的结果？

或者可能是“[幂等](http://en.wikipedia.org/wiki/Idempotence#In_computing)的”，这也意味着再次调用该函数不会对数据库产生进一步的**影响**。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-23T02:29:02.780

它被称为幂等

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-23T02:59:05.700

我认为您正在寻找的是**Idempotent**。幂等性是可以应用于任何类型的操作（不仅仅是数据库）的属性。这意味着多次执行该操作等于执行一次。即第一次之后的每个后续操作都保持状态不变。

例如，大多数 DVD 遥控器上的播放按钮在播放视频时是幂等的，因为无论您按多少次，它都会继续播放。但是，遥控器上的电源按钮通常不是幂等的，因为它每次都会打开和关闭机器。幂等性是一个很好的属性，因为在进行操作以尝试产生给定状态之前，您不必总是知道系统处于什么状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T02:31:38.720

或者也许是确定性的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T02:32:29.090

我很确定您正在考虑“确定性”工作。如果函数始终为相同的输入返回相同的答案，则该函数是确定性的。如果函数可以为相同的输入返回不同的答案，则该函数是不确定的。

# ruby-on-rails - 在 Rails 中旋转后台任务

> ID：388016
> 
> 赞同：12
> 
> 时间：2008-12-23T02:32:34.397
> 
> 标签：ruby-on-rails, ruby, unix

为 Rails 应用程序创建后台任务的首选方法是什么？我听说过 Starling/Workling 和优秀的脚本/跑步者，但我很好奇哪种方式正在成为满足这种需求的实际方式？

谢谢！

**澄清：**我喜欢 Rake in Background 的想法，但问题是，我需要持续运行或每 10 小时运行一次的东西。我不会奢侈地坐在 Web 请求上，它需要由服务器与我网站上发生的活动异步启动。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-23T02:50:11.350

Ryan Bates 创建了三个可能对您有帮助的精彩截屏视频：

1.  [在后台耙](http://railscasts.com/episodes/127-rake-in-background)
2.  [椋鸟和工作](http://railscasts.com/episodes/128-starling-and-workling)
3.  [自定义守护程序](http://railscasts.com/episodes/129-custom-daemon)

他谈到了使用每种方法的各种利弊。这应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-23T04:15:07.560

这取决于您的需求。

试用由 Shopify 创始人 Tobi [delayed_job](https://github.com/tobi/delayed_job)（最后更新于 2011 年）创建的 delay_job。

DHH [deleayed_job](https://github.com/dhh/delayed_job)（最后更新于 2008 年）和collectiveidea [delayed_job](https://github.com/collectiveidea/delayed_job)（最后更新于 20 天前，截至 2018 年 6 月 28 日）有分叉。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-23T05:19:43.777

我通常依赖[cronjob 调度](http://www.mkssoftware.com/docs/man1/crontab.1.asp)，因为它提供了灵活性，而无需编写单独的代码来调度它。任何可以从 shell 执行的东西，都可以被调度！无论是任何脚本（ruby / rake task / py / bash / 任何你喜欢的），cronjob 调度都可以轻松实现。

如果在 Windows 上运行，可以使用[计划任务](http://support.microsoft.com/kb/308569)

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T04:02:13.310

[async_observer](http://async-observer.rubyforge.org/)是最好的。它不会做各种愚蠢的忙等待事情，也不会因为像八哥、没有 DB 轮询等那样的工人崩溃而失去工作……而且它非常好地集成到了 Rails 中。

我通过它推动了*大量*的工作，它几乎不在乎。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T11:42:41.447

大多数已经提到的插件都可以完成这项工作，但如果您只需要按设定的时间表运行 Rake 任务，那么真的没有必要开始投入更多的架构。

只需添加一个执行的 cron 作业

“cd /path/to/rails/app;RAILS_ENV=production rake run:my:task”

当类 Unix 操作系统几十年来一直按计划运行任务时，为什么要重新发明轮子？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T02:45:47.597

我过去使用过守护进程插件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-23T03:59:42.973

虽然我不知道它是否正在成为标准，但我在[BackgroundRB](http://backgroundrb.rubyforge.org)方面取得了巨大成功。我有几个工作人员，一些是由用户操作触发的长时间运行的任务，而另一些是按计划启动的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-23T17:44:48.703

看看[Taskr](http://code.google.com/p/ruby-taskr/)。它基本上类似于 cron，但具有 RESTful Web 界面。您可以使用它来安排任务以定期连接到您的 Rails 应用程序并触发任意代码（通过 Taskr4rails 插件）。它旨在很好地适应围绕 RESTful 服务构建的系统，此外，它可以在任务返回错误、运行失败等情况下通知您。

# xcode - 从 xcode 部署资源文件

> ID：388024
> 
> 赞同：10
> 
> 时间：2008-12-23T02:39:51.493
> 
> 标签：xcode, build-process

如何将资源文件（配置/数据/图像）文件复制到 iPhone 上的应用程序主目录。

一个相关的问题[在 iPhone 上加载数据文件？](https://stackoverflow.com/questions/317959/loading-data-files-on-iphone)，收到一个答案“只需将它们添加到您的项目中；Xcode 将在构建您的应用程序时将它们复制到 .app 包中”。

如何做到这一点？（如果这是一个简单的问题，手动参考/page# 很好）

我希望能够将文件复制到 iPhone 模拟器上并在运行时打开它。我试图通过添加“复制文件”目标来做到这一点，尽管我无法在运行时找到这些文件。

我知道使用属性列表，或者 sql lite 数据库比文件 io 更受欢迎，但我仍然想了解如何实现这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-23T02:57:10.307

在我的应用程序中，我有一个 sql lite DB，我刚刚将它放在我的项目文件夹的根目录中并添加到我的项目的资源文件夹中，它最终在应用程序可访问的包中结束。

[http://img68.imageshack.us/img68/3047/xcoderesourceslw5.png](http://img68.imageshack.us/img68/3047/xcoderesourceslw5.png)

我认为这适用于任何文件。我不必编写任何特殊的目标或操作。

在您的应用程序中，此文件随后显示如下：

```
NSString *dbFilePath = [[NSBundle mainBundle] 
                            pathForResource:@"dictionary" 
                            ofType:@"db"]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T03:22:03.250

我刚刚找到这个站点，[Bundle Programming Guide](http://developer.apple.com/iphone/library/documentation/CoreFoundation/Conceptual/CFBundles/CFBundles.html)它解释了如何在运行时访问项目中设置的资源。我认为它同样易于使用单个文件。

# regex - 光明节正则表达式

> ID：388034
> 
> 赞同：15
> 
> 时间：2008-12-23T02:45:12.497
> 
> 标签：regex

光明节、光明节、光明节……由于从另一种语言和字符集音译而来，这个节日的名字有很多种拼写方式。你能想出多少个合法的拼写？

现在，编写一个能够识别所有这些的正则表达式。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-23T03:03:43.413

根据[http://www.holidays.net/chanukah/spelling.htm](http://www.holidays.net/chanukah/spelling.htm)，它可以拼写以下任何一种方式：

```
Chanuka
Chanukah
Chanukkah
Channukah
Hanukah
Hannukah
Hanukkah
Hanuka
Hanukka
Hanaka
Haneka
Hanika
Khanukkah 
```

这是我匹配所有这些的正则表达式：

```
/(Ch|H|Kh)ann?[aeiu]kk?ah?/ 
```

**编辑：**或者这个，没有分支：

```
/[CHK]h?ann?[aeiu]kk?ah?/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T03:00:03.420

为了可读性，称我为傻瓜。

在 Python 中：

```
def find_hanukkah(s):
   import re

   spellings = ['hannukah', 'channukah', 'hanukkah'] # etc...

   for m in re.finditer('|'.join(spellings), s, re.I):
      print m.group()

find_hanukkah("Hannukah Channukah, Hanukkah") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T02:52:41.000

试试这个：

```
 /^[ck]?hann?ukk?ah?$/i 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-25T01:48:33.220

像 C?hann?uk?kah? 匹配大多数常见情况。还有一堆奇怪的拼写 C?hann?uk?kah?|Han[aei]ka|Khanukkah 几乎匹配我能想到的所有拼写（在谷歌上至少有 50 万次点击）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T02:53:40.157

我认为唯一被批准的英语拼写是光明节和光明节，所以它有点像

```
/(Ch|H)anuk?kah/ 
```

或者甚至更好

```
/(Chanukah|Hanukkah)/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T03:19:12.633

我喜欢三联画的回答，但我会向前迈出一步......也在python中：

```
def valid(spelling):
    import re

    regex_spelling = re.compile(r'^[cCkK]{0,1}han{1,2}uk{1,2}ah$')
    valid = regex_spelling.match(spelling)

    if valid:
        print 'Valid spelling'
    else:
        print spelling, " is not a spelling for the word" 
```

使用它：

```
valid("hanukkah") 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-10T18:11:12.930

`((Ch|H|X|Х|Kh|J)[aа](н|n{1,2})(у|ou|[auei])(к|k|q){1,2}[aа]h?)|(חנו?כה)`

这个正则表达式更具包容性，涵盖了以下所有选项：

光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节光明节迦努卡光明节 Xanuka Ханука Ханука חנוכה חנכה

# gis - ArcGIS Server - 将点捕捉到线

> ID：388053
> 
> 赞同：1
> 
> 时间：2008-12-23T02:56:03.193
> 
> 标签：gis, arcgis

如果我有一个点和一个道路网络，我如何找到道路上最近的点？即这就像将点捕捉到一条线/道路。

我正在使用带有 Java 5 和 Oracle 10g 的 ArcGis 服务器 9.3。我正在通过 java api 使用 ST 函数和 NetworkAnalyst。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-30T22:40:31.457

使用[INALocator.queryLocationBypoint()](http://resources.esri.com/help/9.3/ArcGISengine/java/api/arcobjects/com/esri/arcgis/networkanalyst/NALocator.html)。你可以从你的 NAContext 创建一个 NALocator。将点传递给定位器，它会将点“捕捉”到道路网络。

URL 按钮不起作用。JavaDoc 的链接是[http://resources.esri.com/help/9.3/ArcGISengine/java/api/arcobjects/com/esri/arcgis/networkanalyst/INALocator.html#queryLocationByPoint(com.esri.arcgis.geometry.IPoint](http://resources.esri.com/help/9.3/ArcGISengine/java/api/arcobjects/com/esri/arcgis/networkanalyst/INALocator.html#queryLocationByPoint(com.esri.arcgis.geometry.IPoint) , com.esri.arcgis.networkanalyst.INALocation[], com.esri.arcgis.geometry.IPoint[], double[])

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T12:00:36.133

网络的各个部分应由直线或曲线创建。因此，它的每一个特性都必须继承`ICurve`实现方法的接口`queryPointAndDistance()`。使用该方法和您的观点，您应该在您想要的每个特征上获得最近的点。

如果你想找出最近的特征，你必须遍历特征的集合（例如你之前跟踪过的）并比较`distanceFromCurve`每个特征的参数。请参阅 JavaDoc： http: [//resources.esri.com/help/9.3/arcgisengine/java/api/arcobjects/com/esri/arcgis/geometry/ICurve.html](http://resources.esri.com/help/9.3/arcgisengine/java/api/arcobjects/com/esri/arcgis/geometry/ICurve.html)。

# clojure - Clojure - 无序发生的副作用

> ID：388057
> 
> 赞同：14
> 
> 时间：2008-12-23T03:02:10.013
> 
> 标签：clojure

在涉足 Clojure 时，我编写了一个非常基本的程序来回显用户输入的任何内容。然而，它并没有以我认为自然的方式运行。这是代码：

```
(defn goo []
  (print "echo> ")
  (def resp (read-line))
  (print resp)
) 
```

我希望代码像这样运行（对我来说`foo`作为输入输入`read-line`）：

```
user=> (goo)
echo> foo
foonil 
```

但取而代之的是， echo 和 read-line 被切换：

```
user=> (goo)
foo
echo> foonil 
```

为什么会这样？有没有我错过的微妙之处？

编辑：根据乔的回答，更新后的正确解决方案是：

```
(defn goo []
  (print "echo> ")
  (flush)
  (def resp (read-line))
  (print resp)
  (flush)
) 
```

此外，如果您使用`println`而不是`print`.

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-23T03:08:00.300

我对clojure一无所知，但这听起来像是缓冲区没有被刷新的情况。弄清楚如何在打印后冲洗标准。println 函数可能会在每行的末尾刷新。尝试：

```
(defn goo []
  (print "echo> ")
  (flush )
  (def resp (read-line))
  (print resp)
) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-20T11:08:36.097

另外，请不要使用“def”，除非您真的非常想定义一个全局变量。改用“让”：

```
(defn goo []
  (print "echo> ")
  (flush)
  (let [resp (read-line)]
    (print resp)
    (flush))) 
```

或者，更短

```
(defn goo []
  (print "echo> ")
  (flush)
  (print (read-line))
  (flush)) 
```

# gis - ArcGIS Server - 比较路线

> ID：388061
> 
> 赞同：0
> 
> 时间：2008-12-23T03:04:03.990
> 
> 标签：gis, arcgis, routes

我有一个点列表，以及外部提供商通过这些点生成的路线。

我想用我自己的道路网络使用相同的点生成一条路线。

然后我希望能够检测两条路线之间是否有任何显着差异。

一个建议是，对于 2 条路线，我们找出它们经过的路段，然后比较路段列表？

这是一种有效的方法吗？我们如何获取给定路线的路段列表？

我正在使用带有 Java 5 和 Oracle 10g 的 ArcGis 服务器 9.3。我正在通过 java api 使用 ST 函数和 NetworkAnalyst。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T22:29:44.193

使用您的点和道路网络计算路线。然后将生成的路线缓冲成一个多边形（缓冲半径应该是你的“公差”）。然后使用您的多边形剪裁外部路线。如果生成的折线不为空，则偏差超出了您的容差。

此方法不考虑任何“重大”偏差，例如回溯、掉头或走附近的平行道路。

或者，您可以比较生成的“方向”并检查那里的偏差——特别是使用街道名称。这使您无需检查每个路段。如果道路名称有任何偏差，请检查每个路段的各个路段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T13:45:16.613

我刚刚在我的应用程序中实现了类似的东西。我有一个来自 GPS 设备的纬度/经度坐标列表，需要根据这些数据创建路线。

我首先将每个 GPS 位置与街道网络中的一个节点进行匹配。然后我删除了“连续重复”节点以过滤掉位于同一节点的那些连续位置。然后，我开始在我的街道网络中“行走”，从第一个节点开始。我检查了第一个节点和第二个节点并检查了公共街道段。如果我找到了，那就太好了。如果没有，我会在 2 个节点之间创建一条最短路径，并改用这些路径。我继续这样做，直到我检查了所有节点。在这个过程结束时，我有一个车辆行驶的路段列表以及它们行驶的顺序。

不幸的是，我使用了不同的地图、不同的编程语言和不同的数据库。因此，共享代码对您毫无帮助。希望我上面描述的过程足以帮助您完成任务。

# release-management - 发布管理软件

> ID：388062
> 
> 赞同：2
> 
> 时间：2008-12-23T03:04:09.573
> 
> 标签：release-management, configuration-management

关于发布管理的主题，我正在研究我的软件选项，这些软件将基本上执行 WSUS 提供的功能，据我所知（远程安装、版本查询、每台机器/组设置等），但对于我的自定义软件。它还需要能够运行第三方可执行文件（例如图形驱动程序安装程序），在更新之前通知软件当前是否正在运行等。

更新：我主要查看要安装的 C#/C++.NET 代码，但我正在寻找一种解决方案，用于同时将更新从一台服务器推送到十几个客户端。这是我必须包装的东西，比如说，一个 NSIS 安装程序构建脚本，还是有混合管理/管理/安装工具？我目前正在将 NSIS/WiX 视为我的主要竞争者，并使用某种脚本来填补空白（关于语言的建议，也是吗？Windows PowerShell？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T07:24:27.630

由于您提到了多个平台和图形驱动程序，但没有提到 java/c#，我认为您有（可能有）特定平台的 exe。因此，Java Web Start 和 ClickOnce 选项不适合您...

[Hansel Minutes 最近与 Paint.Net 的](http://www.hanselminutes.com/default.aspx?showID=156)家伙进行了一次聊天，主要是关于他们的安装程序，这似乎是一个 3 或 4 层的东西。这可能值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T02:46:57.220

如果您希望提供类似 WSUS 的功能，您可以使用它吗？如果您已经在使用 Windows 安装程序玩得很好，从我所看到的情况来看应该不会太难。

有关将更新发布到 wsus 的方法，请参阅[此示例。](http://msdn.microsoft.com/en-us/library/aa970328.aspx)[这里](http://www.microsoft.com/technet/scriptcenter/scripts/sus/server/default.mspx?mfr=true)还有一个 powershell 脚本，演示了将 msp 发布到 wsus

看起来您需要制作自己的报告界面，但我不得不想象这比构建 wsus v4 更容易。

我假设这是用于“内部”分发（您可以在其中控制自动更新客户端）。如果你想提供一些“面向客户”的东西，那可能根本没有帮助；）

# linux - 准系统 Linux 服务器安装

> ID：388066
> 
> 赞同：4
> 
> 时间：2008-12-23T03:08:00.720
> 
> 标签：linux

安装准系统 linux 服务器的最简单方法是什么？准系统 = 足以获得 ssh 和包管理器。

目前我一直在使用 CentOS 进行服务器安装并删除我知道我不想安装的任何软件包。

但是有更好的方法吗？我只想从一个简单的 ssh shell + 包管理开始。硬件无关紧要，因为一切都发生在虚拟机中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-23T03:11:37.950

[Debian 稳定版网络安装。](http://www.debian.org/CD/netinst/)

安装并启动并运行它后，您可以 apt-get 或 aptitude 安装您想要的任何软件包。这就是我设置服务器的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T03:23:26.820

如果你有时间安装 Gentoo 只会给你想要的，而不是更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T07:34:01.643

拱刚

```
su -c 'pacman -S sshd' 
```

那么您将拥有尽可能多的准系统。Pacman 它的包管理系统非常容易使用，而且什么也不用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T03:26:13.087

你知道 SliceHost 的人有一些关于设置 Linux VM 的非常好的文档。[http://articles.slicehost.com/ubuntu-intrepid](http://articles.slicehost.com/ubuntu-intrepid)我正在使用他们的服务，我发现他们的文档非常好。特别是在启动和运行准系统 VM 时。我使用他们的文档作为在其他系统上设置 iptables 防火墙和其他基本系统任务的参考。希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T06:38:44.907

JEOS - Just Enough Operating System，一个 Ubuntu 项目，应该正是您正在寻找的。

# python - 由于旧的解释器版本，如何优雅地处理失败的未来功能（__future__）导入？

> ID：388069
> 
> 赞同：71
> 
> 时间：2008-12-23T03:10:51.370
> 
> 标签：python, python-import

您如何优雅地处理失败的未来功能导入？如果用户使用 Python 2.5 运行并且我的模块中的第一条语句是：

```
from __future__ import print_function 
```

为 Python 2.5 编译此模块将失败，并显示：

```
 File "__init__.py", line 1
    from __future__ import print_function
SyntaxError: future feature print_function is not defined 
```

我想通知用户他们需要使用 Python >= 2.6 重新运行程序，并且可能会提供一些有关如何执行此操作的说明。但是，引用[PEP 236](http://www.python.org/dev/peps/pep-0236/)：

> 可以出现在 future_statement 之前的唯一行是：
> 
> *   模块文档字符串（如果有）。
> *   评论。
> *   空行。
> *   其他future_statements。

所以我不能做这样的事情：

```
import __future__

if hasattr(__future__, 'print_function'):
    from __future__ import print_function
else:
    raise ImportError('Python >= 2.6 is required') 
```

因为它产生：

```
 File "__init__.py", line 4
    from __future__ import print_function
SyntaxError: from __future__ imports must occur at the beginning of the file 
```

PEP 中的这个片段似乎给了内联执行它的希望：

> 问：我想将 future_statements 包装在 try/except 块中，这样我就可以根据运行的 Python 版本使用不同的代码。为什么我不能？
> 
> 答：对不起！try/except 是一个运行时特性；future_statements 主要是编译时的噱头，您的 try/except 会在编译器完成后很久才发生。也就是说，当您尝试/排除时，对模块有效的语义已经完成。由于 try/except 不会完成它*看起来* 应该完成的事情，因此根本不允许这样做。我们还希望使这些特殊声明非常易于查找和识别。
> 
> 请注意，您*可以*直接导入 __future__，并使用其中的信息以及 sys.version_info 来确定您正在运行的版本与给定功能的状态相关的位置。

想法？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-12-23T03:20:03.067

“我想通知用户他们需要使用 Python >= 2.6 重新运行程序，并且可能会提供一些有关如何执行此操作的说明。”

这不是 README 文件的用途吗？

这是你的选择。“包装器”：在运行目标 aop 之前检查环境的一小段 Python。

文件：appwrapper.py

```
import sys
major, minor, micro, releaselevel, serial = sys.version_info
if (major,minor) <= (2,5):
    # provide advice on getting version 2.6 or higher.
    sys.exit(2)
import app
app.main() 
```

* * *

“直接进口”是什么意思。您可以检查`__future__`. 您仍然受制于 a`from __future__ import print_function`是编译器的信息这一事实，但您可以在导入执行实际工作的模块之前四处寻找。

```
import __future__, sys
if hasattr(__future__, 'print_function'): 
    # Could also check sys.version_info >= __future__. print_function.optional
    import app
    app.main()
else:
    print "instructions for upgrading" 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2010-06-14T12:36:33.363

我之前使用的一个相当老套但简单的方法是利用字节文字在 Python 2.6 中引入的事实，并在文件开头附近使用类似这样的东西：

```
b'This module needs Python 2.6 or later. Please do xxx.' 
```

这在 Python 2.6 或更高版本中是无害的，但`SyntaxError`在任何早期版本中都是如此。任何试图编译你的文件的人仍然会得到一个错误，但他们也会得到你想要给出的任何信息。

你可能会认为，因为你必须在你`from __future__ import print_function`之后有这一行，所以它将是生成的导入，`SyntaxError`你不会看到有用的错误消息，但奇怪的是后面的错误优先。我怀疑由于导入的错误本身并不是真正的语法错误，因此它不会在第一次编译传递时引发，因此首先会引发真正的语法错误（但我猜）。

这可能不符合您“优雅”的标准，并且它非常特定于 Python 2.6，但它快速且容易做到。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2011-08-31T05:10:18.390

只需在与 的同一行添加注释`"from __future__ import ..."`，如下所示：

```
from __future__ import print_function, division  # We require Python 2.6 or later 
```

由于 Python 显示包含错误的行，如果您尝试使用 Python 2.5 运行该模块，您将得到一个很好的描述性错误：

```
 from __future__ import print_function, division  # We require Python 2.6 or later
SyntaxError: future feature print_function is not defined 
```

# php - PHP的快速日食模式

> ID：388080
> 
> 赞同：1
> 
> 时间：2008-12-23T03:19:31.650
> 
> 标签：php, eclipse, editor, highlighting

有人知道 Eclipse 的快速 PHP 模式吗？我试过 Aptana PHP 模式和 PDT，但都不能在一秒钟内放置一个字符，这是没有办法编写代码的。

这可能是由于我在网络驱动器上进行的编辑，但编辑器如此依赖硬盘驱动器似乎很愚蠢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-10T01:17:14.113

尝试在 Window > Preferences > PHP > Editor > Code Folding 下禁用 Code Folding。如果文件大于 200 行代码，此功能会导致 Eclipse 运行非常缓慢！

他们说这个错误早在 2008 年就已修复。但我仍然有这个问题 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T16:12:09.653

Is Eclipse running from the network drive or is the file you are editing on the network drive. I run Eclipse with PHPEclipse all the time and the files I edit are on a network drive which mounts a Samba share on a Linux virtual machine and I have no problems. Eclipse depends on Java and it also takes a lot of memory. You may want to check that Java is working properly and that you aren't running out of memory. Or do an experiment and edit a file that is not on a network drive and see if it is any faster.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T04:47:06.153

我投票给 Netbeans-PHP。但我的预测是它会和 Eclipse 一样，因为这些 IDE 需要从 HDD 读取 PHP 源文件来创建自动完成数据库。而且由于您的文件在网络驱动器中，它肯定会很慢。也许您应该考虑使用一些可以从网络中提取源副本的版本控制软件。所以它不会减慢 IDE 的速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T04:08:04.267

我每天都使用 eclipse/PDT，它工作正常。我想我不知道“在一秒钟内放置一个字符”是什么意思，因为我根本看不到输入代码的任何延迟......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T03:22:21.330

我听说netbeans 有很好的PHP 支持。

# c# - 为什么 Func 和 Action Delegates 只接受 4 个参数？

> ID：388082
> 
> 赞同：2
> 
> 时间：2008-12-23T03:19:45.597
> 
> 标签：c#

为什么是4？我知道它在文档中为 4，但这看起来很奇怪。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T03:42:31.633

我会冒险说这是因为有人在框架中的某个地方需要一个带有 4 个参数的 Action 或 Func 委托，而目前还没有人需要一个带有 5 个参数的委托。或者，有人决定超过 4 个，你应该引入正如@chadmyers 所说，一个用来保存值的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T03:27:33.987

我不知道确切的答案，但我猜这与这样一个事实有关，即如果您传递具有 >4 个参数的委托，那是代码异味，您可能做错了什么。您应该考虑使用“ [Introduce Parameter Object](http://www.refactoring.com/catalog/introduceParameterObject.html) ”重构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T03:27:10.167

奇怪的是，人们需要消费四种类型的对象，封装它们，操纵它们，并在一个类中跟踪它们。

我什至会假设，除了三种不同的类型之外，你的泛型类已经走得太远了。通常你必须考虑你的类型如何相互交互的排列，例如，1 类型很好，1 x 2 很好，3 你有 6 种方式来操作你的类型，4 你有 24 种组合可供选择，所以你也应该考虑到这种复杂性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T04:01:38.100

首先，我同意其他人的观点，即带有 5 个参数的函数签名可能会有点长。话虽如此，在我作为开发人员的时间里，我已经编写了很多长函数签名。

您始终可以编写自己的重载泛型委托。您甚至可以将它们放在系统中（我不会）。

```
namespace System
{
  public delegate void Action<T1, T2, T3, T4, T5>(T1 arg1, T2 arg2, 
                                                  T3 arg3, T4 arg4, T5 arg5);
  public delegate ReturnT Action<ReturnT, T1, T2, T3, T4, T5>(T1 arg1, 
                                         T2 arg2, T3 arg3, T4 arg4, T5 arg5);
} 
```

编辑：自从我撰写这篇文章以来，.Net 4\. 已经到来，以及这些代表的更长版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-11T10:39:46.190

在 .NET 4.0 中，您可以获得更多 - 多达[16 个参数](http://msdn.microsoft.com/en-us/library/dd402872.aspx)。

尽管在可读性方面*经常*使用这种方法可能会有点远......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T07:02:38.483

因为拥有这么多参数的委托是一种糟糕的开发模式。它使您的代码极其耦合和复杂。

# cocoa - 如何为 NSTableView 设置默认排序顺序？

> ID：388088
> 
> 赞同：4
> 
> 时间：2008-12-23T03:23:28.847
> 
> 标签：cocoa

我有一个可可应用程序，它有一个通过 NSArrayController 绑定到模型的 TableView。

该应用程序按我的意愿工作，但表格的默认排序顺序是错误的。

[buildwatch http://public.west.spy.net/BuildWatch.png](http://public.west.spy.net/BuildWatch.png)

我通常启动程序并单击最后一个标题两次以使其正确排序。在 nib/bindings/whatever 中是否有办法指定默认排序顺序，或者以编程方式告诉它如果我单击两次会发生什么？或者甚至只记得以前的排序顺序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-23T04:23:35.700

查看[NSSortDescriptor](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSSortDescriptor_Class/Reference/Reference.html)。

您可以在 NSTableView 上使用 -setSortDescriptors: 进行设置。或者，您可以将排序描述符放在 ivar 中，并将它们与 IB 中的排序描述符绑定绑定。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-23T05:01:50.710

我通常在 -windowDidLoad 中做这种事情。假设您的`NSWindowController`子类将 IBOutlet _arrayController 设置为相关的 NSArrayController，并且您的模型拥有属性 buildETA：

```
NSSortDescriptor *buildETASortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"buildETA" ascending:NO];
[_arrayController setSortDescriptors:[NSArray arrayWithObject:buildETASortDescriptor]];
[buildETASortDescriptor release]; 
```

编辑：将 -awakeFromNib 更改为 -windowDidLoad 因为这是一个假设的`NSWindowController`子类

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-12T08:57:57.400

您还可以创建此自定义类，然后在 InterfaceBuilder 中选择您的 ArrayController 并将 Indentity Inspector 中的自定义类更改为您的 CustomArrayController

```
#import "CustomArrayController.h"
@implementation PatchbayArrayController

-(void)awakeFromNib
{
    [super awakeFromNib];
    NSSortDescriptor *mySortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"propertyNameHere" ascending:YES];
    [self setSortDescriptors:[NSArray arrayWithObject:mySortDescriptor]];
    [mySortDescriptor release]; 
}
@end 
```

# wpf - WPF ListBox 数据模板和图像问题

> ID：388099
> 
> 赞同：0
> 
> 时间：2008-12-23T03:35:24.223
> 
> 标签：wpf, image, listbox, mouseleave, mouseenter

我有一个带有 StackPanel 的 ListBox，其中包含图像和标签。

```
<ListBox.ItemsPanel>
    <ItemsPanelTemplate>
        <VirtualizingStackPanel Orientation="Horizontal" IsItemsHost="True" />
    </ItemsPanelTemplate>
</ListBox.ItemsPanel>
<ListBox.ItemTemplate>
    <DataTemplate>
        <StackPanel Orientation="Vertical">
            <Image Source="{Binding Image}" Cursor="Hand" Tag="{Binding Link}" MouseLeftButtonDown="Image_MouseLeftButtonDown" ToolTip="Click to see this product on adidas.com" VerticalAlignment="Top" HorizontalAlignment="Left"  />
            <Label Content="{Binding Name}" Cursor="Hand" Tag="{Binding Link}" MouseLeftButtonDown="Label_MouseLeftButtonDown" VerticalAlignment="Bottom" Foreground="White" Style="{StaticResource Gotham-Medium}" FontSize="8pt"  HorizontalAlignment="Center" />
        </StackPanel>
    </DataTemplate>
</ListBox.ItemTemplate> 
```

我想在当前鼠标悬停的图像后面显示第三张图像（glow.png）。我似乎无法向堆栈面板添加第二张图像，并将其可见性设置为隐藏。我什至还没有解决鼠标悬停部分。

是否在堆栈面板中添加另一个图像，然后将其可见性设置为在 mouseenter 上可见正确的方法，然后在 mouseleave 上换回？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T03:49:11.307

您当然可以将一张图片放在另一张图片后面。不要直接将图像添加到 StackPanel，而是添加一个 Grid，然后添加两个图像，如下所示：

```
<StackPanel Orientation="Vertical">
    <Grid>
        <Image Source="..." />
        <Image Source="{Binding Image}" ... />
    </Grid>
    <Label Content="{Binding Name}" ... />
</StackPanel> 
```

您可能还想查看[Bitmap Effects](http://msdn.microsoft.com/en-us/library/ms743435.aspx)，使用它可以在任何 WPF 元素上引入“发光”效果。

**编辑：**实现您想要的效果的另一种方法（我相信）是在触发器中换出图像的 Source 属性。我不打算在这里尝试从内存中编写 XAML，但您可以捕获图像本身的 IsMouseOver 属性，当它切换到 True 时，您可以将其 Source 设置为图像的“发光”版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T15:44:04.470

另一种可能性是为您的图像添加边框，将边框的颜色设置为您想要的任何颜色，并将不透明度设置为 0。在您的 MouseEnter 事件处理程序中，将不透明度设置为 1。

# common-lisp - 有哪些推荐的 Common Lisp Web 服务器选项？

> ID：388107
> 
> 赞同：6
> 
> 时间：2008-12-23T03:40:28.813
> 
> 标签：common-lisp, hunchentoot

到目前为止，我只尝试过 Hunchentoot 并听说过 AllegroServe、ABCLweb，尽管我不知道它们在性能方面的比较。我想知道，目前在生产环境中部署 Common Lisp Web 应用程序的最佳选择是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T12:41:19.580

[在CLiki](http://www.cliki.net/web)上有一个相当不错的与 Web 相关的 Common Lisp 软件列表。

扫描列表，这是他们列出的 Web 服务器（链接到 CLiki 描述页面），这些服务器似乎是相当完整的服务器：

*   [快板服务](http://www.cliki.net/AllegroServe)
*   [蜘蛛目](http://www.cliki.net/araneida)
*   [核心服务器](http://www.cliki.net/CoreServer)
*   [亨肯图特](http://www.cliki.net/hunchentoot)

还有一些其他选项自称为最小或实验性的，或者在 CLISP 而不是 Common Lisp 中实现。

我不是 Lisp 程序员，所以我无法评价其中任何一个的有效性，但从收集这些信息来看，**Hunchentoot**似乎是目前最受欢迎的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-09T21:54:23.690

[CL-HTTP](http://www.cl-http.org:8001)是一个功能齐全的 HTTP 服务器，其历史可以追溯到 Web 的早期。这是一个[CL-HTTP 入门](http://clhttp.typereview.com/)。

# database - 循环分配实现（数据库）

> ID：388109
> 
> 赞同：2
> 
> 时间：2008-12-23T03:41:26.877
> 
> 标签：database, scheduling, round-robin

我目前正在为`SalesLead`<-->`SalesPerson`情况实施许多不同的分配算法。总体思路很简单：

1.  A`SalesLead`在公共网站上注册

2.  代码自动将 分配`SalesLead`给`SalesPerson`使用循环调度（线索`SalesPersons`按相同顺序分配）

除了确保每次都以相同的顺序从数据库中提取代理并使用另一个表来存储分配了 SalesLead 的最后一个代理（这可能实际上对于构建报告很有用，或者至少在以后有一个追溯方法）。我离基地很远吗？

**澄清：** 代码当前无法将销售人员与潜在客户匹配。这是一个全新的功能。目前他们可以注册特定的销售人员，但我们希望他们能够自动分配。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-23T03:51:01.977

真的很简单：当一个销售人员被创建时，给他们一个 LastActivityDate。为他们分配 SalesLead 后，将该日期更新为当前日期。将销售线索（SalesLead）提供给活动日期最近的销售人员。

可以在 SQL 或代码中轻松完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T03:46:31.703

如果您有一个将 SalesLeads 和 SalesPersons 匹配在一起的表并为它添加时间戳，则不需要单独的表来跟踪最后选择的 SalesPerson。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T03:53:35.027

在 SQL Server 中，您实际上希望它是日期时间，而不是时间戳字段，但 @David 的想法是相同的。跟踪分配给销售人员的最后一个销售线索并记录分配时间。然后，您可以通过查找没有分配潜在客户的销售人员或最后分配的潜在客户是最老的销售人员来选择下一个要分配潜在客户的销售人员。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-17T07:02:17.863

查看 Salesforce 是如何做到的： [http ://forums.sforce.com/sforce/board/message?board.id=custom_formula&message.id=533](http://forums.sforce.com/sforce/board/message?board.id=custom_formula&message.id=533)

通过销售人员的数量 + 1 修改一个 ID，然后将 1 分配给 Joe，2 分配给 Tom，等等。

# c++builder - C++ Builder 中的 64 位支持

> ID：388116
> 
> 赞同：1
> 
> 时间：2008-12-23T03:46:44.747
> 
> 标签：c++builder

我正在考虑升级我们用于某些代码的 Borland/Codegear/Embarcadero C++ 构建器套件。我希望看到 64 位支持，但这似乎不是 2009 版的一个功能。我发誓我看到了一个路线图，表明将在 2009 年年中发布一个包含 x64 的新版本，但现在我丢失了该文档。有人知道 Commodore 的发布时间表或路线图吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:38:20.127

Embarcadero 刚刚发布了 2012 年 C++Builder 的新路线图：

[即将来到您附近的 RAD IDE，C++ 的未来 - 64 位、C++11、ARM、iOS 和 Android](http://dn.embarcadero.com/article/42275)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-05T11:22:12.510

我看到现在有一​​个新的“RAD Studio、Delphi 和 C++Builder 路线图”，于 2010 年 8 月在[此处](http://edn.embarcadero.com/article/39934)发布，上面写着“预计 2011 年上半年可用性”。

更新：在2011 年 9 月的[David Intersimone 的博客](http://blogs.embarcadero.com/davidi/2011/09/02/41169)中，他回答了“c++ builder 64 bit 怎么样？它已经停产了吗？”这个问题。“我们正在开发下一代新的 C++Builder 编译器。这将使我们能够使用 64 位和 ARM 芯片。编译器仍在构建中，因此它无法生成 XE2。它在我们的路线图上，我们会给你的。” 在其他地方，我看到（Embarcadero）预测这将出现在 XE3 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T04:20:20.123

每个人似乎都参考了同一个链接，[http://dn.codegear.com/article/36620](http://dn.codegear.com/article/36620)。但是现在，那里什么都没有。每个谈论该地址的人都提到了 2009 年第二季度的 64 位支持。所以你没记错。但是 Embarcadero 无法获得原始来源。

不过，它可以通过[Google 的缓存](http://dn.codegear.com/article/36620)获得。它将“Commodore”的发布放在“2009 年年中”，其功能包括针对来自 32 位 IDE 的本机 64 位代码的交叉编译。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-17T20:58:02.767

即将发布的 RAD Studio XE2 提供了对 Delphi 和 C++（C++ 构建器）的 64 位支持。

[查看 RAD Studio XE2 活动的链接](http://now.eloqua.com/es.asp?s=608&e=441997&elq=4118dee3c26b407dac6f3abdeeee43cd)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-13T17:22:12.997

XE2 已经发布，但我没有看到任何关于 C++ Builder 的 64 位支持，只有 Delphi。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-11T19:49:19.617

我在 David Intersimone 的博客中向 David Intersimone 询问了有关 BCC64 的问题，该博客由亲爱的 JV 评论。看来 64 位密件抄送迫在眉睫。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-09T14:03:15.143

C++ Builder 64bit 支持将在 2012 年第四季度发布。但是，C++ Builder XE3 已经发布，如果您同时购买支持服务，则有获得 64 位 beta 支持的促销活动。

我从 XE3 公路之旅中得到的信息是，他们仍然不知道 64 位是否会被视为“重大”升级。这意味着如果您现在购买 XE3，您必须（再次）购买升级才能在第四季度获得 64 位。如果它不是“主要”升级，您将免费获得它。

I was going to upgrade my XE2 to an XE3 but I'm waiting for the official 64bit release instead. If I have waited **several years** for the 64bit support, I can wait a few more month...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-23T04:23:06.327

[本文](http://www.itwriting.com/blog/259-codegear-puts-64-bit-on-the-roadmap.html)讨论了 Commodore (Delphi) 将于 2008 年冬季推出，支持 64 位。它提到了 Delphi Tiburon（2009 年到期），它具有额外的功能，随后是具有相同功能的 C++（并希望支持 64 位）。

然而，它链接到的“Borland”文章已经消失了，所以我猜所有的赌注都没有了。

说真的，我认为 IDE 空间中没有任何空间可以容纳两个成本较高的产品。我认为 Visual Studio 将永远是选择成本较高的产品，因为其他人都选择免费的解决方案，例如 Eclipse CDT 或准系统 GCC。

我认为 Borland 的产品在他们的时代非常出色（仅超过 TopSpeed/JPI 编译器，让微软的早期努力蒙羞）但他们已经完成了他们的冲刺，现在被归入博物馆（仅我个人认为，我一直错误之前，以及其他各种免责声明）。

# flash - 在 Flash 中缩放图像以匹配 html 中定义的大小

> ID：388123
> 
> 赞同：1
> 
> 时间：2008-12-23T03:49:46.067
> 
> 标签：flash, cs3

我有一个从 xml 文件动态加载图像的 flash 电影。我想在不同的页面上重新使用这个 .swf 文件，但是 page1 上的图像都是 400 x 200，page2 上的图像都是 745 x 422。当我尝试在另一个页面上重用它时，加载的图像会缩小（调整大小） - 我希望它们与宽度/高度中定义的内容相匹配，但它们会根据舞台的缩放方式进行缩放。

我对将它们放在容器（精灵）上的图像使用加载器（AS3）

```
slideLoader.load(new URLRequest(xmlSlideshow..image[intCurrentSlide].@src)); 
```

我已经尝试让舞台开始各种尺寸，但如果可能的话，我真的希望它是无关紧要的 - 即：50 x 50。然后在 html 中，宽度/高度将设置为正在加载的图像的宽度/高度。

我不是 Flash 向导，所以如果我不清楚，请原谅我，如果需要，我会尝试提供更多见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T04:17:33.903

几件事......首先，您需要指定您的应用程序不进行扩展。（AS3 代码）

```
stage.scaleMode = StageScaleMode.NO_SCALE;
stage.align = StageAlign.TOP_LEFT; 
```

然后，一旦您的图像被加载（向 slideLoader 对象添加一个侦听器），使用 flash 的 ExternalInterface 类执行一个 javascript 函数。

```
ExternalInterface.call('resizeFlashMovie', slideLoader.width, slideLoader.height); 
```

你的 javascript 函数将是这样的：

```
function resizeFlashMovie(width, height) {
    var flash = document.getElementById('yourFlashMovieId');
    flash.style.width = width+'px';
    flash.style.height = height+'px';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T03:58:10.900

很抱歉，我手头没有代码，但我知道您可以选择在启动时在画布上设置不调整大小。

理想情况下，您可以通过嵌入标签的属性传入高度/宽度，在画布上不调整大小并使用传入的尺寸来设置图像尺寸。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T04:00:07.400

我相信就是这样：

```
fscommand("allowscale","false"); 
```

# .net - 是否有 XRI 解析器的 .NET 实现？

> ID：388129
> 
> 赞同：0
> 
> 时间：2008-12-23T03:52:29.320
> 
> 标签：.net, openid, xri

为了避免将 XRI 解析委托给像 xri.net 这样的 XRI 解析器代理，是否有 XRI 解析器的开源 .NET 实现？

有一个可以移植到 .NET 的 xri4j 库，实际上我开始了这项工作，但看起来那里有很多代码可以被删除，因为 .NET 的库有很多功能（显然）Java 缺乏。但是要重构这一切需要做很多工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T23:26:34.850

[dot net openid 项目](http://code.google.com/p/dotnetopenid/)与您相关吗？

svn 更改日志似乎表明某种程度的 XRI 支持。

编辑：这个项目是预期的目标，它目前使用外部服务器！

# asp.net-mvc - 史蒂夫桑德森的“部分请求”

> ID：388136
> 
> 赞同：0
> 
> 时间：2008-12-23T03:56:50.560
> 
> 标签：asp.net-mvc

我关注了 Steve Sanderson 在[blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc)上写的博客文章。完全遵循它时一切正常，但我希望有人可能已经看过它并能够帮助我稍微适应它。

我基本上有这个从一个控制器到另一个控制器的“部分请求”调用，这工作正常。然后我想遍历数据并创建一个下拉列表。问题是我需要将其转换为 IEnumerable 才能执行此操作，但它无法告诉我无法将 void 转换为 IEnumerable。

lkine 失败在视图中并且是：

```
foreach (var category in (IEnumerable<MyObject>) ((PartialRequest)ViewData["ReturnedData"]).Invoke(ViewContext)) 
```

显然，不看代码就很难知道如何回答这个问题。这些都在前面提到的帖子中，但由于篇幅相当长，我不想在这里全部发布。我知道这使回答变得困难，并希望有人准备好该帖子并可以提供帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T04:13:44.753

PartialRequest Invoke 方法不返回任何内容，它将请求生成的 HTML 写入响应。这个想法是您可以调用一个控制器操作来呈现 MVC 视图用户控件而不是视图。您可以向此控制器操作发出部分请求，并让它直接将控件呈现到响应流中，而不是使用 Html.RenderPartial。由于控件直接写入响应，因此您没有机会与它的输出进行交互。

# sql-server - 清除 sql server 复制文件

> ID：388152
> 
> 赞同：0
> 
> 时间：2008-12-23T04:14:33.770
> 
> 标签：sql-server, replication

我们每晚都会对每个生产数据库进行完整备份。

我们还有一个小时的白天复制到报告数据库。

看来今天 unc 共享空间已用完。复制文件是否有自动删除功能？或者我是否需要手动删除不再需要保留的复制文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T05:04:48.520

根据我的经验，您只需要清理一些空间以确保有足够的空间用于 UNC 共享。然后再次开始复制。

# python - Python：通过终结器在程序终止之前刷新缓冲区

> ID：388154
> 
> 赞同：3
> 
> 时间：2008-12-23T04:15:05.453
> 
> 标签：python, buffer, destructor, finalizer

我保留事务缓存以在水印或对象完成的事件中刷新（到持久存储）。由于[不再保证](http://docs.python.org/reference/datamodel.html?highlight=__del__#object.__del__)在每个对象上都被调用，因此将类似函数（或自身）挂接到（在初始化期间）的适当方法`__del__`是什么？`__del__``atexit.register`

如果我没记错的话，这*将*导致该方法绑定到的对象一直存在，直到程序终止。这可能不是问题，但也许有更优雅的解决方案？

注意：我知道 using`__del__`是不理想的，因为[它可能会导致无法捕获的异常](http://docs.python.org/reference/datamodel.html?highlight=__del__#object.__del__)，但我想不出另一种方法来做这件事，除非`finalize()`在我的程序中一直进行级联调用。蒂亚！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T05:10:35.403

如果您必须处理资源，首选方法是显式调用 a `close()`or`finalize()`方法。看看`with`声明以抽象它。在您的情况下，`weakref`模块可能是一个选项。缓存的对象可以由系统进行垃圾收集，并`__del__()`调用它们的方法，或者如果它们仍然存在，您可以最终确定它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T14:21:43.777

我会说`atexit`或尝试看看您是否可以将代码重构为能够使用默认情况下在 2.5 和 2.6`with_statement`中的a 来表示。`__future__`2.5 包含一个模块 contextlib 来简化一些事情。我在使用 Canonical 的 Storm ORM 时做过类似的事情。

从**未来**导入 with_statement

```
@contextlib.contextmanager
def start_transaction(db):
  db.start()
  yield
  db.end()

with start_transaction(db) as transaction:
  ... 
```

对于非数据库情况，您可以只注册要使用全局刷新的对象，然后使用类似的东西。这种方法的好处是它使事情变得明确。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T10:46:14.743

将以下内容放入名为`destructor.py`

```
import atexit

objects = []

def _destructor():
    global objects
    for obj in objects:
        obj.destroy()
    del objects

atexit.register(_destructor) 
```

现在以这种方式使用它：

```
import destructor

class MyObj(object):
    def __init__(self):
        destructor.objects.append(self)
        # ... other init stuff
    def destroy(self):
        # clean up resources here 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-23T21:52:16.927

如果您在执行刷新时不需要对象处于活动状态，则可以使用[弱引用](http://docs.python.org/library/weakref.html)

这类似于您提出的解决方案，但不是使用真正的引用，而是存储弱引用列表，并带有一个回调函数来执行刷新。这样，引用不会使这些对象保持活动状态，并且您不会遇到任何`__del__`方法的循环垃圾问题。

如果需要保证在某个时间点完成，您可以遍历终止时的弱引用列表以手动刷新任何仍然活着的引用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T06:51:34.653

我认为这`atexit`是去这里的方式。

# php - PHP 和 Zend 框架

> ID：388163
> 
> 赞同：-1
> 
> 时间：2008-12-23T04:20:52.820
> 
> 标签：php, zend-framework

如何在 Zend 框架中轻松实现查询？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T04:36:18.920

检查这个文件：

[Zend 框架数据库快速入门](http://devzone.zend.com/content/zendcon_07_slides/Karwin_Bill_ZF-Db-ZendCon-20071009.pdf) *(PDF)*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-01T13:31:37.967

您可以使用doctrine2 [Doctrine 项目](http://www.doctrine-project.org/)。有一个与 ZF3 [DoctrineModule](https://github.com/doctrine/DoctrineModule)兼容的模块。您可以使用 QueryBuilder 将查询的创建带到对象操作中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-10T13:40:15.027

使用 Zend_Db 并使用 Zend_Db 工厂方法创建一个 $db 对象，然后使用 Zend_Db_Select 类创建 SQL 语句并将 $select SQL 语句传递给 fetch* (fetchRow, fetchAll...) 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T04:25:03.420

您可以像这样使用 Zend Db Adapter 对象：

```
$sql = 'SELECT * FROM bugs WHERE bug_id = ?';

$result = $db->fetchAll($sql, 2); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-20T18:41:51.083

1.配置：

配置/自动加载/dbAdapter.local.php

```
<?php
return array(
   'db' => array(
        'driver'   => 'Pdo',
        'dsn'      => 'mysql:dbname=name;host=localhost',
        'username' => 'root',
        'password' => 'root',    
   ),
   'service_manager' => array(
        'abstract_factories' => array(
            'Zend\Db\Adapter\AdapterAbstractServiceFactory',
        ),
    ),
); 
```

2.  执行：

> ```
> public function testAction()
> {
>   $username = 'user';
> 
>   $sql       = "SELECT email FROM users WHERE username = ?";
>   $statement = $this->getDbAdapter()->createStatement($sql, array($username));
>   $result   = $statement->execute()->current();
> }
> 
> protected function getDbAdapter()
> {
>     if($this->dbAdapter == null) {
>         $this->dbAdapter = $this->getServiceLocator()->get('Zend\Db\Adapter\Adapter');
>     }
> 
>     return $this->dbAdapter;
> } 
> ```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-23T11:28:47.677

Zend 框架有 abstract_factories，它允许我们处理多个 DB 查询：

Zend\Db\Adapter\AdapterAbstractServiceFactory

1.  需要设置服务管理器：

    'service_manager' => 数组（'abstract_factories' => 数组（'Zend\Db\Adapter\AdapterAbstractServiceFactory', ), ),

2.  在 config/autoload/local.php 中配置适配器

    db' => 数组（'适配器' => 数组（

    ```
     'database1' => array(
           'driver'         => 'Pdo',
           'dsn'             => 'mysql:dbname=userDB;host=localhost',
           'driver_options'  => array(
                PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES \'UTF8\''
            ),
        ),

        etc...
    ), 
    ```

    ),

3.  在 config/autoload/global.php 中配置适配器

    ```
    return array(
    'db' => array(
        'adapters' => array(
            'database1' => array(
            'username' => 'root',
            'password' => '',
            ),
        ),    
    ), 
    ```

    );

4.  呼叫适配器

    $dbmanager->get('database1');

5.  在模型中使用

    ```
    use Zend\Db\TableGateway\AbstractTableGateway;
    use Zend\Db\Adapter\Adapter;

    class UserTable extends AbstractTableGateway
    {
        protected $table ='user';

    public function __invoke(Adapter $adapter)
    {
        $this->adapter = $adapter;
        $this->initialize();
    }

    public function fetchAll()
    {
        $resultSet = $this->select();
        return $resultSet->toArray();
    } 
    ```

    }

# python - Lua 的科学库？

> ID：388172
> 
> 赞同：23
> 
> 时间：2008-12-23T04:25:07.537
> 
> 标签：python, lua, scipy, scientific-computing, torch

有没有可以和 Scipy 相媲美的 Lua 科学包？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-17T07:30:57.633

你应该试试**[Torch7](http://www.torch.ch)** ( [github](https://github.com/andresy/torch) )。

Torch7 有一个非常漂亮和高效的向量/矩阵/张量数值库，带有 Lua 前端。它还具有一系列用于计算机视觉和机器学习的功能。

它是最近的，但很快就会好起来。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-23T10:33:39.823

人们总是可以使用[Lunatic Python](http://labix.org/lunatic-python)并在 lua 中访问 scipy。

```
> require("python")
> numpy = python.import("numpy")
> numpy.array ... etc .. 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-13T01:33:04.577

你有一些选择：

*   [Numeric Lua](http://numlua.luaforge.net/) - Lua 5.1/5.2 的 C 模块，提供矩阵、FFT、复数等
*   [GSL Shell](http://www.nongnu.org/gsl-shell/) - 使用很好的语法修改 Lua（支持 Lua 库）。提供 Numeric Lua 所做的几乎所有功能，以及 ODE 求解器、绘图功能和其他好东西。有一个很棒的文档。
*   [SciLua](http://www.scilua.org/) - 纯 LuaJIT 模块。旨在成为 Lua 中科学计算的完整框架。提供向量和矩阵、随机数/分布、优化等。仍处于早期开发阶段。
*   [Lua Numerical Algorithms](https://bitbucket.org/lucashnegri/lna) - 纯 LuaJIT 模块（通过 LuaJIT FFI 使用 blas/lapack）. 提供矩阵/线性代数、FFT、复数、优化算法、ODE 求解器、基本统计（+ PCA、LDA）等。仍处于早期开发阶段，但有一些完整的文档和测试套件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-23T04:36:07.220

在[Numeric Lua](http://numlua.luaforge.net/)中有一个基础。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-13T01:20:28.603

我不确定它是否可以与 Scipy 相媲美，但有基于 LuaJIT 和 GNU Scientific Library的[GSL Shell ，它提供了许多数值算法和向量/矩阵线性代数运算。](http://www.nongnu.org/gsl-shell/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-02-12T22:52:02.930

Lua 有一个类似 Numpy 的扩展，它在没有依赖关系的情况下运行

[https://github.com/jzrake/lunum](https://github.com/jzrake/lunum)

未来它将提供 FFT 和线性代数，如 Numpy+Scipy。目前它支持像 Numpy 中的数字数组操作。

# python - 尝试从多个位置导入模块的更整洁的方式？

> ID：388173
> 
> 赞同：10
> 
> 时间：2008-12-23T04:25:09.363
> 
> 标签：python, refactoring, python-import

有没有办法整理以下代码，而不是一系列嵌套的 try/except 语句？

```
try:
    import simplejson as json
except ImportError:
    try:
        import json
    except ImportError:
        try:
            from django.utils import simplejson as json
        except:
            raise "Requires either simplejson, Python 2.6 or django.utils!" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-23T07:28:56.887

[我在http://mail.python.org/pipermail/python-list/2007-May/441896.html](http://mail.python.org/pipermail/python-list/2007-May/441896.html)找到了以下函数。它似乎工作得很好，而且我很确定它的导入方式不会影响您可能已经拥有的任何现有导入。

```
def module_exists(module_name):
    try:
        mod = __import__(module_name)
    except ImportError:
        return False
    else:
        return True

if module_exists('simplejson'):
    import simplejson as json
elif module_exists('json'):
    import json
elif module_exists('django.utils'):
    from django.utils import simplejson as json
else:
    raise ImportError('Requires either simplejson, Python 2.6 or django.utils') 
```

我知道这似乎是更多的代码，但是如果你做了很多这样的事情，这个函数可以在其他地方重用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T09:45:03.993

```
def import_any(*mod_list):
    res = None
    for mod in mod_list:
        try:
            res = __import__(mod)
            return res
        except ImportError:
            pass
    raise ImportError("Requires one of " + ', '.join(mod_list))

json = import_any('simplejson', 'json', 'django.utils.simplejson') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T10:45:05.743

我很欣赏这样做的漂亮功能，但您在原始问题中说明的模式是此要求最常用的模式。您可以看到它在许多开源项目中使用。

我建议你坚持下去。记住“丑”并不总是“坏”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-24T11:23:34.057

这避免了嵌套，但我不确定它是否更好:)

```
json = None

if json is None:
    try:
        import json
    except ImportError:
        pass

if json is None:
    try:
        import simplejson as json
    except ImportError:
        pass

if json is None:
    try:
        from django.utils import simplejson as json
    except ImportError:
        pass    

if json is None:
    raise ImportError('Requires either simplejson, Python 2.6 or django.utils') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-29T12:53:54.047

我想出了一个不依赖于定义函数的简单替代方案：

```
# Create a dummy enclosing
while True:
    try:
        import simplejson as json
        break
    except:
        pass

    try:
        import json
        break
    except:
        pass

    try:
        from django.utils import simplejson as json
        break
    except:
        pass

    raise ImportError('Requires either simplejson, Python 2.6 or django.utils') 
```

请注意，我不完全确定它是否比使用辅助函数的方法更漂亮。

# html - 如何在更大的 div 内制作图像中心（垂直和水平）

> ID：388180
> 
> 赞同：427
> 
> 时间：2008-12-23T04:32:38.053
> 
> 标签：html, css

我有一个 200 x 200 像素的 div。我想在 div 的中间放置一个 50 x 50 px 的图像。

如何做呢？

我可以通过使用`text-align: center`div 使其水平居中。但是垂直对齐是问题..

* * *

## 回答 #1

> 赞同：439
> 
> 时间：2012-09-18T06:30:00.623

*在旧浏览器中工作 (IE >= 8)*

绝对位置结合自动边距允许水平和垂直居中元素。元素位置可以基于使用相对定位的父元素位置。[查看结果](https://jsfiddle.net/stuttufu/sj2m0oo2/1/)

```
img {
    position: absolute;
    margin: auto;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
} 
```

* * *

## 回答 #2

> 赞同：333
> 
> 时间：2008-12-31T10:05:31.107

就个人而言，我会将它作为 div 中的背景图像，其中的 CSS 是：

```
#demo {
    background: url(bg_apple_little.gif) no-repeat center center;
    height: 200px;
    width: 200px;
} 
```

`id="demo"`（假设您已经指定了 div`height`并`width`添加 a`background`不应该是问题）

让浏览器承受压力。

* * *

## 回答 #3

> 赞同：108
> 
> 时间：2008-12-23T05:23:48.560

当然，另一种方法是创建一个`table`with `valign`。无论您是否知道 div 的高度，这都会起作用。

```
<div>
   <table width="100%" height="100%" align="center" valign="center">
   <tr><td>
      <img src="foo.jpg" alt="foo" />
   </td></tr>
   </table>
</div> 
```

`css`但你应该尽可能地坚持。

* * *

## 回答 #4

> 赞同：81
> 
> 时间：2008-12-23T04:41:17.803

我会`position:relative;`为您的图像设置较大的 div，然后执行以下操作：

```
img.classname{
   position:absolute;
   top:50%;
   left:50%;
   margin-top:-25px;
   margin-left:-25px;
} 
```

这仅适用于您知道图像和包含 div 的尺寸。这也将让您在包含的 div 中拥有其他项目......其中使用 line-height 等解决方案不会。

**编辑**：注意...您的边距是图像大小的负一半。

* * *

## 回答 #5

> 赞同：64
> 
> 时间：2014-01-13T21:49:26.977

这可以正常工作：

```
display: block;
margin-left: auto;
margin-right: auto 
```

如果以上仅给您水平居中，请尝试此操作：

```
.outerContainer {
   position: relative;
}

.innerContainer {
   width: 50px; //your image/element width here
   height: 50px; //your image/element height here
   overflow: auto;
   margin: auto;
   position: absolute;
   top: 0; left: 0; bottom: 0; right: 0;
} 
```

* * *

## 回答 #6

> 赞同：47
> 
> 时间：2017-10-11T08:30:31.607

使用[弹性盒](https://scotch.io/tutorials/a-visual-guide-to-css3-flexbox-properties)：

```
.outerDiv {
  display: flex;
  flex-direction: column;
  justify-content: center;  /* Centering y-axis */
  align-items :center; /* Centering x-axis */
} 
```

* * *

## 回答 #7

> 赞同：40
> 
> 时间：2013-10-06T07:28:39.910

这是另一种将所有内容集中在任何内容中的方法。

[**工作小提琴**](http://jsfiddle.net/avrahamcool/9VRxn/2/)

**HTML：（**一如既往的简单）

```
<div class="Container">
    <div class="Content"> /*this can be an img, span, or everything else*/
        I'm the Content
    </div>
</div> 
```

**CSS：**

```
.Container
{
    text-align: center;
}

    .Container:before
    {
        content: '';
        height: 100%;
        display: inline-block;
        vertical-align: middle;
    }

.Content
{
    display: inline-block;
    vertical-align: middle;
} 
```

## 好处

容器和内容高度未知。

在没有特定负边距的情况下居中，没有设置行高（因此它适用于多行文本）并且没有脚本，也适用于 CSS 过渡。

* * *

## 回答 #8

> 赞同：30
> 
> 时间：2012-09-09T21:18:47.520

这有点晚了，但这是我用来垂直对齐父 div 中的元素的解决方案。

**当您知道容器 div 的大小但不知道包含图像的大小时，这很有用。**（使用灯箱或图像轮播时经常出现这种情况）。

这是您应该尝试的样式：

```
 container div
 {
   display:table-cell;
   vertical-align:middle;

   height:200px;
   width:200px;
 }

 img
 {
   /*Apply any styling here*/        
 } 
```

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2012-02-09T02:42:40.640

我发现上面的 Valamas 和 Lepu 的答案是处理未知大小或已知大小的图像的最直接的答案，您不想硬编码到 CSS 中。我只是做了一些小的调整：删除不相关的样式，将其调整为 200px 以匹配问题，并添加 max-height/max-width 以处理可能太大的图像。

```
div.image-thumbnail
{
    width: 200px;
    height: 200px;
    line-height: 200px;
    text-align: center;
}
div.image-thumbnail img
{
    vertical-align: middle;
    max-height: 200px;
    max-width: 200px;
} 
```

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2008-12-23T04:48:40.033

在 div 中

```
style="text-align:center; line-height:200px" 
```

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2008-12-23T05:39:08.793

垂直对齐是最常被滥用的 CSS 样式之一。对于不是 td 或 css “display: table-cell”的元素，它不会像您期望的那样起作用。

这是一个关于这个问题的非常好的帖子。[http://phrogz.net/CSS/vertical-align/index.html](http://phrogz.net/CSS/vertical-align/index.html)

最常用的方法来实现你正在寻找的东西是：

*   填充顶部/底部
*   绝对位置
*   线高

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2012-05-15T09:41:04.780

在 CSS 中这样做：

```
img
{

  display:table-cell;
  vertical-align:middle;
  margin:auto;
} 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2017-08-11T11:56:31.897

我们可以很容易地使用`flex`. 不需要`background-image`。

```
<!DOCTYPE html>
<html>
<head>
   <style>
      #image-wrapper{
         width:500px;
         height:500px;
         border:1px solid #333;
         display:flex;
         justify-content:center;
         align-items:center;
      }
   </style>
</head>
<body>

<div id="image-wrapper">
<img id="myImage" src="http://blog.w3c.br/wp-content/uploads/2013/03/css31-213x300.png">
</div>

</body>
</html>
```

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2015-12-07T18:41:50.030

@sleepy 您可以使用以下属性轻松完成此操作：

```
#content {
  display: flex;
  align-items: center;
  width: 200px;
  height: 200px;
  border: 1px solid red;
}

#myImage {
  display: block;
  width: 50px;
  height: 50px;  
  margin: auto;
  border: 1px solid yellow;
}
```

```
<div id="content">
  <img id="myImage" src="http://blog.w3c.br/wp-content/uploads/2013/03/css31-213x300.png">
</div>
```

参考资料：[W3](http://www.w3.org/Style/Examples/007/center.en.html)

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2008-12-23T04:36:36.360

通常，我将设置`line-height`为 200px。通常会做到这一点。

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2009-09-23T23:36:38.453

我有一个图像库，我事先不知道图像的确切高度或宽度，我只知道它们比它们要包含的 div 小。

通过在容器上组合**行高设置并在图像元素上使用****垂直对齐：中间**，我终于使用以下 HTML 标记和以下 CSS 让它在 FF 3.5、Safari 4.0 和 IE7.0 上工作。

HTML 标记

```
<div id="gallery">
    <div class="painting">
        <a href="Painting/Details/2">
            <img src="/Content/Images/Paintings/Thumbnail/painting_00002.jpg" />
        </a>
    </div>
    <div class="painting">
        ...
    </div>
    ...
 </div> 
```

CSS

```
div.painting
{
    float:left;

    height:138px; /* fixed dimensions */
    width: 138px;

    border: solid 1px white;
    background-color:#F5F5F5;

    line-height:138px;    
    text-align:center;

}

    div.painting a img
    {
        border:none;
        vertical-align:middle;

    } 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2011-09-18T18:03:35.417

这对我有用：

```
<body>
  <table id="table-foo">
    <tr><td>
        <img src="foo.png" /> 
    </td></tr>
  </table>
</body>
<style type="text/css">
  html, body {
    height: 100%;
  }
  #table-foo {
    width: 100%;
    height: 100%;
    text-align: center;
    vertical-align: middle;
  }
  #table-foo img {
    display: block;
    margin: 0 auto;
  }
</style> 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2015-01-14T10:18:02.317

另一种方法（这里还没有提到）是使用[Flexbox](http://www.w3.org/TR/css3-flexbox/)。

只需在容器上设置以下规则`div`：

```
display: flex;
justify-content: center; /* align horizontal */
align-items: center; /* align vertical */ 
```

**[小提琴](http://jsfiddle.net/danield770/p6c5hcft/1/)**

```
div {
  width: 200px;
  height: 200px;
  border: 1px solid green;
  display: flex;
  justify-content: center;
  /* align horizontal */
  align-items: center;
  /* align vertical */
}
```

```
<div>
  <img src="http://lorempixel.com/50/50/food" alt="" />
</div>
```

开始使用 Flexbox 以了解它的一些功能并获得最大浏览器支持的语法的一个好地方是[flexyboxes](http://the-echoplex.net/flexyboxes/)

此外，现在的浏览器支持相当不错：[caniuse](http://caniuse.com/#feat=flexbox)

`display: flex`对于和的跨浏览器兼容性`align-items`，您可以使用以下内容：

```
display: -webkit-box;
display: -webkit-flex;
display: -moz-box;
display: -ms-flexbox;
display: flex;
-webkit-flex-align: center;
-ms-flex-align: center;
-webkit-align-items: center;
align-items: center; 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2012-02-23T15:42:05.327

[这是一个旧的解决方案](http://www.jakpsatweb.cz/css/css-vertical-center-solution.html)，但浏览器市场份额已经足够高，如果您不担心 IE7 的降级，您可以在没有 IE hack 部分的情况下度过难关。当您知道外部容器的尺寸但可能知道也可能不知道内部图像的尺寸时，这很有效。

```
.parent {
    display: table;
    height: 200px; /* can be percentages, too, like 100% */
    width: 200px; /* can be percentages, too, like 100% */
}

.child {
    display: table-cell;
    vertical-align: middle;
    margin: 0 auto;
} 
```

```
 <div class="parent">
     <div class="child">
         <img src="foo.png" alt="bar" />
     </div>
 </div> 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2016-04-08T06:51:03.680

简单的

```
img {
    transform: translate(50%,50%);
} 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2016-09-16T00:50:54.410

我一直在尝试使用 hmtl 和 css 使图像在圆形内垂直和水平居中。

在结合了这个线程的几点之后，这就是我想出的：[jsFiddle](https://jsfiddle.net/jord8on/0ku2z8sx/)

这是三列布局中的另一个示例：[jsFiddle](https://jsfiddle.net/jord8on/4044sa60/)

**CSS：**

```
#circle {
width: 100px;
height: 100px;
background: #A7A9AB;
-moz-border-radius: 50px;
-webkit-border-radius: 50px;
border-radius: 50px;
margin: 0 auto;
position: relative;
}

.images {
position: absolute;
margin: auto;
top: 0;
left: 0;
right: 0;
bottom: 0;
} 
```

**HTML：**

```
<div id="circle">
<img class="images" src="https://png.icons8.com/facebook-like-filled/ios7/50" />
</div> 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2016-11-17T07:03:43.527

您可以通过此设置图像的位置对齐中心水平

```
#imageId {
   display: block;
   margin-left: auto;
   margin-right:auto;
} 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2011-02-22T23:47:16.877

您可以使用下面的代码将图像水平和垂直居中（在 IE/FF 中工作）。它将图像的顶部边缘放置在浏览器高度的 50% 处，并且 margin-top（将图像的一半高度向上拉）将使其完美居中。

```
<style type="text/css">
    #middle {position: absolute; top: 50%;} /* for explorer only*/
    #middle[id] {vertical-align: middle; width: 100%;}
         #inner {position: relative; top: -50%} /* for explorer only */
</style>

<body style="background-color:#eeeeee">
    <div id="middle">
        <div id="inner" align="center" style="margin-top:...px"> /* the number will be half the height of your image, so for example if the height is 500px then you will put 250px for the margin-top */
            <img src="..." height="..." width="..." />
        </div>
    </div>
</body> 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2015-04-29T18:47:26.413

我喜欢跳上旧潮流！

**这是此答案的 2015 年更新**。我开始使用 CSS3`transform`来完成我的定位工作。这使您不必制作任何额外的 HTML，您不必做数学运算（查找事物的半角），您可以在任何元素上使用它！

这是一个例子（最后有小提琴）。您的 HTML：

```
<div class="bigDiv">
    <div class="smallDiv">
    </div>
</div> 
```

附带CSS：

```
.bigDiv {
    width:200px;
    height:200px;
    background-color:#efefef;
    position:relative;
}
.smallDiv {
    width:50px;
    height:50px;
    background-color:#cc0000;
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%);
} 
```

这些天我经常做的是，我会给我想要集中的东西上一堂课，并且每次都重复使用那个课。例如：

```
<div class="bigDiv">
    <div class="smallDiv centerThis">
    </div>
</div> 
```

css

```
.bigDiv {
    width:200px;
    height:200px;
    background-color:#efefef;
    position:relative;
}
.smallDiv {
    width:50px;
    height:50px;
    background-color:#cc0000;
}
.centerThis {
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%);
} 
```

这样，我将始终能够将某些东西放在它的容器中。你只需要确保你想要居中的东西在一个有`position`定义的容器中。

[这是一个小提琴](http://jsfiddle.net/98pcz3qL/)

顺便说一句：这也适用于在 SMALLER div 中居中 BIGGER div。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2017-09-23T01:55:04.540

```
div {
  position: absolute;

  border: 3px solid green;
  width: 200px;
  height: 200px;
}

img { 
  position: relative;

  border: 3px solid red;
  width: 50px;
  height: 50px;
}

.center {    
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%); /* IE 9 */
  -webkit-transform: translate(-50%, -50%); /* Chrome, Safari, Opera */
}
```

```
<div class="center">
  <img class="center" src="http://placeholders.org/250/000/fff" />
</div>
```

相关：[将图像居中](https://stackoverflow.com/questions/16702881/center-image-vertical-and-horizontal/46375063#46375063)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2011-07-27T05:52:21.177

感谢其他人的线索。

我用了这个方法

```
div.image-thumbnail
{
    width: 85px;
    height: 85px;
    line-height: 85px;
    display: inline-block;
    text-align: center;
}
div.image-thumbnail img
{
    vertical-align: middle;
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-03-24T08:31:54.897

使用定位。以下对我有用：

```
div{
    display:block;
    overflow:hidden;
    width: 200px; 
    height: 200px;  
    position: relative;
}
div img{
    width: 50px; 
    height: 50px;   
    top: 50%;
    left: 50%;
    bottom: 50%;
    right: 50%;
    position: absolute;
} 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2016-07-15T09:36:06.627

只需将图像边距设置为自动，如下所示。

```
img{
 margin:auto;
 width:50%;
 height:auto;
} 
```

检查这些**[示例](http://whats-online.info/science-and-tutorials/20/Responsive-web-design-using-CSS-Media-query-and-HTML/)**

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2017-01-23T12:24:58.783

```
.container {
height: 200px;
width: 200px;
float:left;
position:relative;
}
.children-with-img {
position: absolute;
width:50px;
height:50px;
left:50%;
top:50%;
transform:translate(-50%);
} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-12-23T05:26:07.900

如果您知道父 div 和图像的大小，则可以使用绝对定位。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2013-10-06T04:19:22.323

这对我有用。将此添加到图像 css：

```
img
{
   display: block;
   margin: auto;
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2013-12-05T03:01:39.007

我在使用 CSS3 的 HTML5 中遇到了这个问题，并且我的图像在 DIV 中居中......哦，是的，我不能忘记我必须如何添加高度来显示图像......有一段时间我想知道它在哪里直到我这样做。我不认为位置和显示是必要的。

```
background-image: url('../Images/01.png');    
background-repeat:no-repeat;
background-position:center;
position:relative;
display:block;
height:60px; 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2016-02-25T23:11:29.563

将图像垂直和水平居中的最佳方法是使用两个容器，并应用以下属性：

## 外容器

*   应该有`display: table;`

## 内部容器

*   应该有`display: table-cell;`
*   应该有`vertical-align: middle;`
*   应该有`text-align: center;`

## 演示

```
.outer-container {
    display: table;
    width: 80%; /* can be any width */
    height: 120px; /* can be any height */
    background: #ccc;
}

.inner-container {
    display: table-cell;
    vertical-align: middle;
    text-align: center;
}

.inner-container img {
    background: #fff;
    padding : 10px;
    border : 1px solid #000;
}
```

```
<div class="outer-container">
   <div class="inner-container">
     <img src="http://s.gravatar.com/avatar/bf4cc94221382810233575862875e687?r=x&s=50" />
   </div>
</div>
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2016-04-14T03:27:27.310

[https://www.w3.org/Style/Examples/007/center.en.html](https://www.w3.org/Style/Examples/007/center.en.html)

```
IMG.displayed {
  display: block;
  margin-left: auto;
  margin-right: auto 
}

<IMG class="displayed" src="..." alt="..."> 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2016-09-24T09:27:50.253

在这里试试这个。

```
.parentdiv {
 height: 400px;
 border: 2px solid #cccccc;
  background: #efefef;
 position: relative;
}
.childcontainer {
 position: absolute;
 left: 50%;
 top: 50%;
}
.childdiv {
 width: 150px;
 height:150px;
 background: lightgreen;
 border-radius: 50%;
 border: 2px solid green;
 margin-top: -50%;
 margin-left: -50%;
}
```

```
<div class="parentdiv">
  <div class="childcontainer">
     <div class="childdiv">
     </div>
  </div>
</div>
```

* * *

## 回答 #36

> 赞同：-1
> 
> 时间：2015-05-12T18:42:08.470

一个简单而优雅的解决方案，每次都适合我：

```
<div>
    <p style="text-align:center"><img>Image here</img></p>
</div> 
```

# perl - 在 Perl 中制作数据结构的深层副本的最佳方法是什么？

> ID：388187
> 
> 赞同：40
> 
> 时间：2008-12-23T04:38:32.923
> 
> 标签：perl, clone

给定一个数据结构（例如散列的散列），制作深层副本以供立即使用的干净/推荐方法是什么？假设合理的情况，数据不是特别大，不存在复杂的循环，可读性/可维护性/等。不惜一切代价比速度更重要。

我知道我可以使用[Storable](http://search.cpan.org/~ams/Storable-2.39/Storable.pm)、[Clone](http://search.cpan.org/~garu/Clone-0.34/Clone.pm)、 Clone::More、[Clone::Fast](http://search.cpan.org/~wazzuteke/Clone-Fast-0.97/lib/Clone/Fast.pm)、[Data::Dumper](http://search.cpan.org/~smueller/Data-Dumper-2.139/Dumper.pm)等。目前的最佳实践是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-24T03:54:24.230

`Clone`比 快得多`Storable::dclone`，但后者支持更多的数据类型。

`Clone::Fast``Clone::More`如果记忆对我有用的话，它们几乎是等价的，但功能的完整性甚至比克隆还要少，`Scalar::Util::Clone`支持的更少，但对于某些结构，IIRC 是最快的。

就可读性而言，这些都应该是一样的，它们实际上是可以互换的。

如果您没有特定的性能需求，我只会使用 Storable 的 dclone。

我不会`Data::Dumper`仅仅因为它太麻烦和迂回而使用它。它可能也会很慢。

对于它的价值，如果您想要可定制的克隆，那么`Data::Visitor`提供挂钩功能并且相当完整的深度克隆是默认行为。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-23T04:47:21.690

我的印象是这`Storable::dclone()`有点规范。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-23T06:08:03.417

[克隆](http://search.cpan.org/~rdf/Clone-0.30/Clone.pm)可能是您想要的。至少，这就是我见过的所有代码的用途。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-01T18:33:27.623

尝试`fclone`从[Panda::Lib](https://metacpan.org/pod/distribution/Panda-Lib/lib/Panda/Lib.pod)中使用，这似乎是最快的（用 XS 编写）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-12-01T11:26:04.170

如果您已经在处理 JSON 并在代码中使用 JSON 模块，那么快速而肮脏的 hack：将结构转换为 JSON，然后将 JSON 转换回结构：

```
use JSON;

my %hash = (
    obj => {},
    arr => []
);

my $hash_ref_to_hash_copy = from_json(to_json(\%hash)); 
```

唯一的缺点可能是必须处理散列引用而不是纯散列，但是，这对我来说已经派上用场了几次。

# apache-flex - 是什么让 Adob e Flex 比其前辈更“可接受”？

> ID：388189
> 
> 赞同：1
> 
> 时间：2008-12-23T04:41:05.370
> 
> 标签：apache-flex, activex, adobe, java-web-start

在过去的 10 年里，我一直在构建企业软件。在这段时间里，我们已经看到企业应用程序从客户端服务器转移到瘦客户端。我们还看到了向托管解决方案的转变，尽管名称并不多（asp、SaaS、云计算）。随着所有这些变化，浮躁主要来自 IT 部门而不是最终用户。在这些革命的第一轮中，以单点管理和减少桌面占用空间的名义降低了用户体验。

在此期间，已经进行了许多尝试来为用户提供丰富的体验，同时仍然满足古怪的 IT 部门。第一个是由行业领导者 Microsoft 以 ActiveX 控件的形式出现的。Sun 公司的人随后推出了 applet，最近又推出了 java webstart。所有这些解决方案似乎都可以解决问题，但从未获得更严格的 IT 部门的广泛期望。

然后 flex 从 Macromedia 出现。他们做了什么不同的事情？它是可持续的吗？微软对 Silverlight 的模仿是否证明他们已经改变了游戏规则？Web 编程会永远改变吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T05:32:30.727

1.  Adobe 之所以成功，是因为主要平台上主要浏览器的几乎所有用户都已经安装了 Flex 所需的唯一运行时组件；这是Flash播放器。Flash 播放器已经证明它不是 Bad Stuff 的载体。它在浏览器中自己的沙箱中运行，与硬件和操作系统隔离。所以没有安装新的（和潜在危险的）软件。

2.  Flash 技术存在一个庞大的开发者社区，Flash 中添加的一些新控件，以及用于编写软件的 ActionScript 的成熟度，已经使其超过了作为 RUI 完全有用的门槛。

    （Activex 仅适用于 Windows；Java 中的任何内容都被认为不稳定且过于繁重；而且 Java 还没有设法使其无处不在，也可能永远不会这样做。所以两者通常都由 edict 安装，而不是由用户安装选择。尽管 Adob​​e 可能是我们在生态系统中处理的未经请求的“更新检查器”和其他近乎恶意软件的最具破坏性的来源。）

3.  微软一开始就非常积极地使用 Silverlight，只需要安装等效的 Flash 运行时；但即使在 Windows 机器上它也不是无处不在；向其他平台渗透是未来的一条路；并且 MS 还没有被证明具有政治智慧以显得无害。但不要计算在内。我认为他们通过切换到 .NET 语言（具有有限的 CLR）进行开发而后退了一步。在我看来，这与他们的 WinCE 策略脱氧的策略相同；但我们会再次看到。但至少他们已经明显地从语言不可知论转向似乎想要强迫开发人员进入 .NETland。

4.  Web 编程正在以一种或另一种方式永远改变。用户将需要更好、更细粒度的 UI；目前还没有完美的答案，但至少有心灵和思想的竞争。我认为最令人鼓舞的迹象来自微软在 MVC、Iron Stuff 等平台中立的东西上的强势进军，以及越来越不受污染的浏览器代码流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T05:52:44.693

我对 Flex 成功的看法：

1- Adob​​e 在开源方面做出了正确的举措，不仅是 AIR，而且现在还开源了 Flex、Flash VM 和 PDF 标准。

2- Flex 丰富的 Flash 遗产（它可以在任何支持 Flash 的浏览器上运行）意味着绝大多数浏览器已经支持它并且不需要下载大型插件即可访问它。

3- Adob​​e 接受了所有主要的服务器端技术，并为它们提供支持，因此 PHP. MS 或 Java 商店都会对使用 Adob​​e 的客户端技术感到满意。

以前，Flex 是封闭源代码、昂贵的，甚至依赖于服务器端安装，即使 Flash 客户端如此广泛可用，这也否定了它的影响力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T20:29:17.357

*   YouTube 和 Flash 视频的普遍存在使 Flash 播放器在访问公共互联网的 95% 以上的浏览器中根深蒂固。
*   将用于表单设计的 Flex GUI 与小部件和精心设计的 GUI SDK 相结合是 Flash 播放器的主要转折点。Flex 2 和 Flashplayer 9 是这项技术真正成熟的转折点。企业开发人员开始很快意识到，这项技术正是执行其应用程序的正确方法。（在 2006 年的 JavaOne 上，Adobe Flex 2 是我在那里看到的最令人印象深刻和最重要的技术。）
*   Flash 运行时有足够的东西在 Web 浏览器沙箱设置中很好地运行 RIA GUI - Java 小程序需要完整的 JRE（大约 16 MB）。Flash 运行时的设计更加精简和智能。（Sun 现在才开始通过他们的 JavaFX 和重新设计的 JRE 为 Java 解决这个问题，它可以下载几 MB 足以运行一个 Web 小程序。不过，他们没有像 YouTube Flash 视频这样的东西来驱动他们的安装。）
*   与编写老式 Web HTML/JavaScript AJAX 应用程序相比，编写 Flex RIA 应用程序是一种非常有用的体验。可以实现更多而更少的努力来做到这一点。
*   Adobe 用其他重要的部分来支持 Flex，例如 BlazeDS（现在他们正在与 SpringSource 合作以使 BlazeDS 和 Spring-Framework 更顺畅地集成）。
*   单线程 GUI 结合异步服务调用（或消息传递）和 ActionScript3 闭包是很好的编程模型：

    [Flex 异步 I/O 与 Java 和 C# 显式线程](http://humbleblogger.blogspot.com/2008/05/flex-async-io-vs-java-and-c-explicit.html)

*   同样，Adobe Flex 具有出色的属性、事件和数据绑定实现。
*   声明性语言，比如 MXML，确实是描述表单的更好方法（本质上是 MVC 模式中的视图）。它比完成相同任务的等效命令式 ActionScript 代码更简洁，因此更清晰。MXML 脚本的层次结构也很自然地与视图的面板/小部件构造相匹配。
*   With Flex RIA approach, the MVC pattern can be implemented completely on the client tier. Web frameworks that implemented MVC in the middle-tier - with the presentation layer executing in the remote client-tier, was a fundamentally flawed approach to MVC. MVC should be done right at the tier that is directly user-facing. (Once again, Adobe Flex does things right architecturally.)
*   Despite that HTML/DOM/JavaScript is considered the pervasive standard of the Internet web, the Adobe Flash player is actually a more ubiquitous and consistent standard - spanning different browsers and operating system platforms. The HTML/DOM/JavaScript standard is in actuality a fragmented mess that grows more fragmented everyday as Google and Microsoft drive different directions on things regarding the web browser. Adobe Flash player ends up being a wonderful end-run around this dilemma. It's a great programming experience for the coders and has sufficient ubiquity for the business suits.
*   Adobe is smartly well supporting the major platforms of Windows, Mac OS X, and Linux. They pay special attention to the Linux platform. This will pay off in the long term as developers are already settling on Linux to do their development from, and it's used extensively for servers hosting their middle-tier. Adobe's recent 64-bit Flash player for Linux is just a marvel. They already have AIR 1.5 available on Linux. They are doing a decent job there of supporting the platform that the developers care about.

# iphone - iPhone上的NSSound

> ID：388192
> 
> 赞同：4
> 
> 时间：2008-12-23T04:44:39.293
> 
> 标签：iphone, cocoa-touch, core-audio

我一直在寻找如何在 iphone 上播放声音，我认为它是这样的：

```
[[NSSound soundNamed:@"cat.mp3"] play]; 
```

但是 NSSound 在 AppKit 上……有什么建议吗？我知道对此有一个非常简单的答案，但今天我的搜索没有呈现任何结果......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-23T09:37:51.387

新的 AVFoundation 类是在 iPhone 上播放声音的最简单方法，尽管它仅适用于固件 2.2：

```
AVAudioPlayer *audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:path] error:NULL];  
[audioPlayer play]; 
```

您只需要在使用它的类中进行此导入：

```
#import <AVFoundation/AVAudioPlayer.h> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-23T04:48:21.250

Audio Toolbox 系统声音非常适合短时间的异步播放。

```
// Initialize
CFBundleRef mainBundle;
mainBundle = CFBundleGetMainBundle ();

// Init each sound
CFURLRef      tapURL;
SystemSoundID tapSound;
tapURL = CFBundleCopyResourceURL(mainBundle, CFSTR("tap"), CFSTR("aif"), NULL);
AudioServicesCreateSystemSoundID(tapURL, &tapSound);

// Play the sound async
AudioServicesPlaySystemSound(tapSound); 
```

我还没有 MP3 可以使用`AudioServicesPlaySystemSound`。但它可以完美播放 AIF 文件。

# c++ - Linux 应用程序中的架构建议

> ID：388200
> 
> 赞同：1
> 
> 时间：2008-12-23T04:48:47.817
> 
> 标签：c++, c, linux, structure, ethernet

我在 Windows 上做了很多编程，但现在我必须编写我的第一个 Linux 应用程序。

我需要使用 UDP 与硬件设备通信。我必须每秒发送 60 个数据包，大小为 40 字节。如果我在 1 秒内发送的数据包少于 60 个，就会发生不好的事情。数据包的数据可能需要一段时间才能生成。但是，如果数据还没有准备好通过网络发送出去，那么可以发送上次发送的相同数据。计算机是仅命令行安装程序，将仅运行此程序。

我对 Linux 了解不多，所以我希望大致了解如何设置应用程序来满足这些要求。我希望得到这样的答案：

制作2个线程，一个用于发送数据包，另一个用于计算。

但我不确定它是否那么简单（也许是这样）。也许制作某种守护进程会更可靠，它只是从共享内存或其他东西发送数据包，然后让另一个应用程序进行计算？如果是多进程解决方案，您会推荐什么通信机制？有什么方法可以让我的应用程序比正常或类似的东西更优先？

PS：越防弹越好！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T05:15:40.870

我做过一个类似的项目：嵌入式 Linux 计算机上的一个简单软件，以常规速度发送 CAN 消息。

我会选择两个线程的方法。给发送线程稍高的优先级，如果另一个线程计算这些块的速度很慢，则让它再次发送相同的数据块。

在大多数系统（包括嵌入式系统）上，每秒 60 个 UDP 数据包非常轻松，因此我不会花太多精力来优化线程之间的数据共享和数据包的发送。

事实上，我想说：**保持简单**！我确实是系统中唯一的应用程序，并且您对该系统具有合理的控制权，您无法从复杂的 IPC 方案和其他技巧中获得任何收益。保持简单将帮助您在更短的时间内以更少的缺陷和更少的时间生成更好的代码，这实际上意味着更多的测试时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T05:01:55.030

您建议的两个线程将起作用。如果您在它们之间有一个 pipe()，那么您的计算线程可以在生成数据包时提供数据包，而您的通信线程使用 select() 来查看是否有任何新数据。如果没有，那么它只是从它的缓存中发送最后一个。

我可能已经过度简化了这个问题......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T05:19:12.843

只要执行计算的负担不太大，使用一对线程的建议听起来就可以解决问题。

`pipe()`我倾向于使用互斥锁来锁定一块用于包含计算线程输出的内存，而不是使用Cogsy 建议的 —— 将其用作线程之间的传输区域。

当您的计算线程准备好输出到缓冲区时，它将获取互斥体，写入传输缓冲区并释放互斥体。

当您的传输线程准备好发送数据包时，它会“尝试”锁定互斥锁。如果它获得锁，则获取传输缓冲区的副本并发送它。如果它没有得到锁，发送最后一个副本。

您可以通过使用“nice”并指定负调整数字来控制流程的优先级以赋予它更高的优先级。请注意，您需要以超级用户身份（root 用户或使用“sudo”）执行此操作才能指定负值。

* * *

编辑：忘记添加 -[这](http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html)是关于 Linux 上 pthreads 的一个很好的教程。还描述了互斥锁的使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T05:48:04.827

我不太明白你的 60 个数据包/秒的要求有多难。每秒 60 个数据包的突发是否满足要求？或者每个数据包之间是否需要一个尖锐的 1/60 秒间隔？

这可能有点跑题了，但另一个重要的问题是如何配置 Linux 机器。我自己会使用*实时*Linux 内核并禁用所有不需要的服务。否则，无论您选择哪种架构，您的应用程序都会在某个时候丢失数据包，这是一个真正的风险。

无论如何，两个线程应该可以正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T06:32:15.487

我发布了这个答案来说明一种与“显而易见”的方法完全不同的方法，希望有人发现它正是他们所需要的。没想到竟然被选为最佳答案！谨慎对待这个解决方案，因为存在潜在的危险和并发问题......

您可以使用[setitimer()](http://linux.die.net/man/2/setitimer)系统调用在指定的毫秒数后将 SIGALRM（警报信号）发送到您的程序。信号是异步事件（有点像消息），它会中断正在执行的程序以让信号处理程序运行。

当您的程序开始时，操作系统会安装一组默认信号处理程序，但您可以使用[sigaction()](http://linux.die.net/man/2/sigaction)安装自定义信号处理程序。

所以你只需要一个线程；使用全局变量，以便信号处理程序可以访问必要的信息并发送新数据包或根据需要重复上一个数据包。

这是一个对您有利的示例：

```
#include <stdio.h>
#include <signal.h>
#include <sys/time.h>
int ticker = 0;

void timerTick(int dummy)
{
    printf("The value of ticker is: %d\n", ticker);
}

int main()
{
    int i;

    struct sigaction action;
    struct itimerval time;

    //Here is where we specify the SIGALRM handler
    action.sa_handler = &timerTick;
    sigemptyset(&action.sa_mask);
    action.sa_flags = 0;

    //Register the handler for SIGALRM
    sigaction(SIGALRM, &action, NULL);

    time.it_interval.tv_sec = 1;       //Timing interval in seconds
    time.it_interval.tv_usec = 000000; //and microseconds
    time.it_value.tv_sec = 0;  //Initial timer value in seconds
    time.it_value.tv_usec = 1; //and microseconds

    //Set off the timer
    setitimer(ITIMER_REAL, &time, NULL);

    //Be busy
    while(1)
        for(ticker = 0; ticker < 1000; ticker++)
            for(i = 0; i < 60000000; i++)
                ;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T13:07:12.540

两个线程都可以工作，你需要确保你锁定你的共享数据结构，这样发送线程在更新过程中看不到它。

每秒 60 次听起来并不难。

如果您真的关心调度，请将发送线程的调度策略设置为 SCHED_FIFO 和 mlockall() 其内存。这样，没有什么可以阻止它发送数据包（尽管如果同时在线上发送其他东西，它们仍然可能会迟到）

设备必须有一定的容差——每秒 60 个数据包是可以的，但设备的容差是多少？每秒20个？如果设备在没有收到的情况下会出现故障，我会以所需速率的三倍发送它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-23T13:37:17.657

我会远离线程并使用进程和（也许）信号和文件。由于您说如果您不发送可能会发生“坏事”，因此您需要避免锁定和竞争条件。使用单独的进程和保存到文件的数据更容易做到这一点。

类似于一个进程将数据保存到文件，然后重命名并重新开始。而另一个进程拾取当前文件并每秒发送一次其内容。

与 Windows 不同，您**可以**在文件打开时复制（移动）文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-28T02:24:55.937

遵循长期的 Unix 最佳实践：保持简单和模块化，解耦操作，让操作系统为您做尽可能多的工作。

这里的许多答案都在正确的轨道上，但我认为它们可以更简单：

*   使用两个独立的进程，一个创建数据并将其写入标准输出，一个从标准输入读取数据并发送。让基本 I/O 库处理进程之间的数据流缓冲，让操作系统处理线程管理。

*   首先使用计时器循环和虚假数据缓冲区构建基本发送器，并使其以正确的频率发送到设备。

*   接下来让发件人从标准输入读取数据 - 您可以从文件重定向数据，例如“sender < textdata”

*   接下来构建数据生产者并将其输出通过管道传递给发送者，例如“生产者|发送者”。

现在，您可以根据需要创建新的生产者，而不会干扰发送方。这个答案假设单向通信。

让答案尽可能简单会让你获得更大的成功，特别是如果你对基于 Linux/Unix 的系统还不是很流利的话。这是学习新系统的好机会，但不要过度使用。当工具可用时，很容易跳到复杂的答案，但是当简单的镘刀足够时，为什么还要使用推土机。互斥体、信号量、共享内存等都是有用且可用的，但会增加您可能并不真正需要的复杂性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-28T03:11:28.773

我同意两个线程的方法。我还会有两个静态缓冲区和一个共享枚举。发送线程应该有这个逻辑。

```
loop
    wait for timer
    grab mutex
    check enum {0, 1}
    send buffer 0 or 1 based on enum
    release mutex
end loop 
```

另一个线程将具有以下逻辑：

```
loop
    check enum
    choose buffer 1 or 0 based on enum (opposite of other thread)
    generate data
    grab mutex
    flip enum
    release mutex
end loop 
```

这样，发送方在发送数据的整个过程中始终拥有一个有效的缓冲区。只有生成器线程可以更改缓冲区指针，并且只有在发送未进行时才能这样做。此外，枚举翻转不应该花费太多的周期，以至于将更高优先级的发送者线程延迟很长时间。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-08T10:30:10.713

谢谢大家，我会使用大家的建议。我希望我可以选择超过 1 个的答案！

对于那些好奇的人。我没有该设备的来源，它是一个专有的锁定系统。我还没有做足够的测试来看看每秒 60 个数据包有多挑剔。这就是他们所有有限的文档所说的“每秒 60 个数据包”。但是，由于设备的性质，数据包的爆发将是一件坏事。我想我可以通过每秒发送超过 60 个来弥补偶尔丢失的数据包。

# perl - 如何防止 GD 内存不足？

> ID：388201
> 
> 赞同：1
> 
> 时间：2008-12-23T04:49:49.080
> 
> 标签：perl, gdlib

我不确定内存是否是这里的罪魁祸首。我正在尝试从内存中的数据（它以前来自数据库）中实例化一个 GD 图像。我尝试这样的电话：

```
my $image = GD::Image->new($image_data); 
```

`$image`回来了`undef`。GD 的 POD 说构造函数将`undef`在内存不足的情况下返回，所以这就是我怀疑内存的原因。

图像数据为 PNG 格式。如果我调用 newFromPngData，也会发生同样的事情。

这适用于非常小的图像，例如 30K 以下。但是，稍微大一点的图像，比如 ~70K 会导致问题。我不认为 70K 的图像会导致这些问题，即使在它被瘪了之后。

这个脚本通过 Apache 2.0 在 CGI 下运行，在 OS 10.4 上，如果这很重要的话。

默认情况下，Apache 是否有任何内存限制？它们可以增加吗？

感谢您的任何见解！

**编辑：**为澄清起见， GD::Image 对象永远不会被创建，因此从内存中清除`$image_data`它并不是一个真正的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-28T19:19:25.047

GD 库每字节图像大小占用许多字节。这是一个远远超过10：1的比例！

当用户将图像上传到我们的系统时，我们首先检查文件大小，然后再将其加载到 GD 图像中。如果它超过阈值（1 兆字节），我们不会使用它，而是向用户报告错误。

如果我们真的很在意，我们可以将它转储到磁盘，使用命令行“convert”工具将其重新缩放到合理的大小，然后将输出加载到 GD 库中并删除临时文件。

```
convert -define jpeg:size=800x800 tmpfile.jpg -thumbnail '800x800' - 
```

将缩放图像，使其适合 800 x 800 正方形。它的最长边现在是 800 像素，应该可以安全加载。上面的命令会将缩小的 .jpg 发送到 STDOUT。size= 选项应该告诉 convert 不要费心在内存中保存巨大的图像，但足以缩放到 800x800。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T05:33:09.273

我遇到过同样的问题几次。

我的解决方案之一就是增加脚本可用的内存量。另一个是清除缓冲区：

原始脚本：

```
$src_img = imagecreatefromstring($userfile2);
imagecopyresampled($dst_img,$src_img,0,0,0,0,$thumb_width,$thumb_height,$origw,$origh); 
```

编辑脚本：

```
$src_img = imagecreatefromstring($userfile2);
imagecopyresampled($dst_img,$src_img,0,0,0,0,$thumb_width,$thumb_height,$origw,$origh);
imagedestroy($src_img); 
```

通过清除第一个 src_image 的内存，它释放了足够的空间来处理更多的处理。

# java - 运行时的 JPA 级联选项

> ID：388206
> 
> 赞同：5
> 
> 时间：2008-12-23T04:56:02.530
> 
> 标签：java, database, jpa, persistence, cascade

我正在尝试通过观察所有更改然后立即持久化有问题的对象来创建一个使对象模型与数据库保持同步的应用程序。模型中的许多对象在大型列表或树中都有子对象。

当我从数据库加载一个对象时，我依靠一种单向级联关系来检索它的所有子对象并将它们包含在应用程序中。

但是，可以更改需要持久性的父对象中的字段，并且我可以确定没有任何子对象受到影响。所以我想持久化父级，而不用所有级联子级持久化访问数据库。

例如

```
@Entity
public class Parent {

    @OneToMany(cascade=CascadeType.ALL)
    public List children;

} 
```

持久化父对象时如何覆盖级联选项？或者我应该将其设置为 REFRESH 并确保我永远不需要级联持久化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T06:16:55.580

从数据库中读取对象并将它们持久化依赖于两个不同的注释。

当您加载一个对象时，它还将获得任何急切 ( `FetchType.EAGER`) 关系的另一端，由关系上的 fetch 属性定义。

根据您的 JPA 提供程序，您可以选择覆盖此行为。EclipseLink，通过令人难以置信的有用`QueryHint.BATCH`，当然可以。

当您持久化、删除或刷新时，级联类型是相关的。

所以，失去级联，保持获取和问题解决。

我个人认为级联都是自找麻烦，但意见会有所不同。

一个体面的 JPA 提供者已经拥有一个相当复杂的（可配置的）缓存方案。也许您应该问为什么要重新发明那个特定的轮子？

纯粹是为了性能而异步更新的问题吗？还是另有原因？

# java - Tomcat 6 默认缓冲区大小

> ID：388208
> 
> 赞同：3
> 
> 时间：2008-12-23T04:56:45.337
> 
> 标签：java, jsp, tomcat

有没有办法在 Tomcat 中设置 JSP 的默认缓冲区大小？我知道我可以在每一页上设置它们，但我希望某处有一个全局选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T00:52:13.673

简短的回答：没有。

长答案：也许，通过一些黑客攻击......

*   编辑此类后，您必须自己构建 Tomcat：[Jasper 常量](http://tomcat.apache.org/tomcat-6.0-doc/api/constant-values.html#org.apache.jasper.Constants.DEFAULT_BUFFER_SIZE)
*   ...或者您可以做一个 Perl 饼图，并一次编辑所有 JSP。首先备份，因为这是在线编辑：

对于没有设置缓冲区的指令：

```
/usr/bin/perl -pi -e 's|<%@ page|<%@ page buffer="new" |g' `find . -type f -name '*.jsp'` 
```

对于已经设置的缓冲区：

```
/usr/bin/perl -pi -e 's|buffer="old"|buffer="new"|g' `find . -type f -name '*.jsp'` 
```

（如果您的指令与上述不一致，例如更多/更少的空格，请使用更多的正则表达式魔法使其工作）

您在网络上其他地方的问题：[http ://www.theserverside.com/discussions/thread.tss?thread_id=24768](http://www.theserverside.com/discussions/thread.tss?thread_id=24768)

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T08:28:26.360

编辑：将评论讨论提升到这个答案 - 这可能是你所追求的

如果即使没有分离处理（控制器）和视图（jsp），您仍被遗留应用程序困住，您应该将处理限制在 jsp 上的第一条指令上，例如就在顶部。在那里你甚至可以自由地重定向（例如发回响应代码 302），更不用说用正确的错误代码发出错误信号了。也就是说，无论如何，您都应该避免向您的客户呈现 500 个样式错误。而是提供一个漂亮的 html 页面 (200)，向客户显示有用的错误消息。应用程序应该在它们的级别上显示它们的错误，而不是在协议级别上。

我记得，早在上个世纪，我自己就曾开发过这样的应用程序。我们经历了一些平台差异：一个平台甚至没有缓冲第一个字节，而是立即将其发送回客户，导致我们的重定向尝试（代码 302）无用，因为 200 代码标头已经在路上了。唯一有帮助的是确保在处理之前不能发送一个字节。由于我们需要一些标记库，因此我们必须消除标记库指令之间的换行符。有两种方法可以做到这一点：

代替

```
<%@ taglib uri="http://java.sun.com/jstl/core_rt" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jstl/fmt_rt" prefix="fmt" %>
<% /* your processing instructions here */ 
   response.sendRedirect("somewhere.jsp") %> 
```

写

```
<%@ taglib uri="http://java.sun.com/jstl/core_rt" prefix="c" 
%><%@ taglib uri="http://java.sun.com/jstl/fmt_rt" prefix="fmt"
 %><% /* your processing instructions here */ 
   response.sendRedirect("somewhere.jsp") %> 
```

或者使用jsp注释消除换行符：

```
<%@ taglib uri="http://java.sun.com/jstl/core_rt" prefix="c" %><%-- 
--%><%@ taglib uri="http://java.sun.com/jstl/fmt_rt" prefix="fmt"%><%--
--%><% /* your processing instructions here */ 
   response.sendRedirect("somewhere.jsp") %> 
```

这可能看起来很难看，但大大降低了服务器刷新缓冲区的危险——不管它有多大。

希望这可以帮助。

* * *

这是在评论讨论之前/期间回答的内容

http 连接器的[Tomcat 文档](http://tomcat.apache.org/tomcat-6.0-doc/config/http.html)有 bufferSize、socketBuffer 和更多用于 nio 安装的选项 - 一些用于输入 - 一些用于输出流。[AJP 连接器](http://tomcat.apache.org/tomcat-6.0-doc/config/ajp.html)似乎不是那么可配置的（如果您使用 Apache/mod_jk，则需要 ajp 连接器）。

我希望您正在寻找的缓冲区是其中的...

编辑：（评论空间太小了，所以我选择添加更多关于您在此处使用 AJP 的评论的信息：）

关于缓冲区大小的智慧似乎在 org.apache.catalina.connector.OutputBuffer 和 org.apache.catalina.connector.Response 中实现（通过简要查看 tomcat 6.0.18 源代码）。特别感兴趣的是这段代码（来自响应）：

```
/**
 * Set the Connector through which this Request was received.
 *
 * @param connector The new connector
 */
public void setConnector(Connector connector) {
    this.connector = connector;
    if("AJP/1.3".equals(connector.getProtocol())) {
        // default size to size of one ajp-packet
        outputBuffer = new OutputBuffer(8184);
    } else {
        outputBuffer = new OutputBuffer();
    }
    outputStream = new CoyoteOutputStream(outputBuffer);
    writer = new CoyoteWriter(outputBuffer);
} 
```

根据我对这段代码的判断，增加缓冲区大小似乎并不能真正帮助您解决问题。并不是我想说它没有帮助...当您从 jsps 增加缓冲区大小时，您是否测量了实际性能？这样做有帮助吗？

有了这个联系点的知识，您可以通过修补 tomcat 源或向您的 Web 应用程序或 tomcat 容器配置添加一个过滤器来根据您的需要调整缓冲区大小就足够了。（我更喜欢过滤器而不是tomcat补丁）

我想到的另一个想法是：如果您使用任何模板系统（如瓷砖，正如您提到的 jsp，但想到速度或其他），您不应该有太多必须设置缓冲区的点来自 jsps 的大小。在我工作过的系统中，我可能会猜测大约 10 个基本布局模板会受到影响（与项目大小无关）。

我希望这个补充有助于...

# javascript - 实现监听器

> ID：388221
> 
> 赞同：0
> 
> 时间：2008-12-23T05:09:56.030
> 
> 标签：javascript, yui

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html;
charset=utf-8">
<title>YUI Calendar Control Example</title>
<link rel="stylesheet"
type="text/css"
href="yui/build/calendar/assets/skins/sam/calendar.css">
<script type="text/javascript"
src="yui/build/yahoo-dom-event/
yahoo-dom-event.js"></script>
<script type="text/javascript"
src="yui/build/calendar/calendar-min.js"></script>
<style type="text/css">
input {
margin:0px 10px 0px 10px;
}
</style>
</head>
<body class="yui-skin-sam">
<div>
<label>Please enter your date of birth:</label>
<input type="text" name="dobfield" id="dobfield">
<img id="calico" src="E:\HP_PROJECT\cal.png"
alt="Open the Calendar control">
</div>
<div id="mycal"></div>
<script type="text/javascript">
//create the namespace object for this example
YAHOO.namespace("yuibook.calendar");
//define the lauchCal function which creates the calendar
YAHOO.yuibook.calendar.launchCal = function() {
//create the calendar object, specifying the container
Var myCal = new YAHOO.widget.Calendar("mycal");
//draw the calendar on screen
myCal.render();

}
//define the showCal function which shows the calendar
Var showCal = function() {
//show the calendar
myCal.show();
}

//create calendar on page load
YAHOO.util.Event.onDOMReady(YAHOO.yuibook.calendar.launchCal);
 //attach listener for click event on calendar icon
YAHOO.util.Event.addListener("calico", "click", showCal);  
//myCal.hide();

</script>

</body>
</html> 
```

我已经使用了上面的代码。但是代码的问题是，当我单击图像图标时，什么都没有显示。我是 JavaScript 新手。请帮助我如何实现监听器。

请指导我在代码中的何处进行更改。

谢谢 Padmaja

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T05:19:05.697

问题是这`myCal`是`launchCal()`函数的局部变量。为 myCal 变量提供全局可访问的命名空间将使其可用于每个范围。

**这是您的原始代码**（其他人不小心将我的正确代码放在您的原始问题中=/）

```
YAHOO.namespace("yuibook.calendar"); 

//define the lauchCal function which creates the calendar 
YAHOO.yuibook.calendar.launchCal = function() { 

    //create the calendar object, specifying the container 
    var myCal = new YAHOO.widget.Calendar("mycal"); 

    //draw the calendar on screen 
    myCal.render(); 
}

//define the showCal function which shows the calendar
Var showCal = function() { 
    //show the calendar 
    myCal.show(); 
} 

//create calendar on page load
YAHOO.util.Event.onDOMReady(YAHOO.yuibook.calendar.launchCal); 

//attach listener for click event on calendar icon 
YAHOO.util.Event.addListener("calico", "click", showCal); 

//myCal.hide(); 
```

**现在看看我的变化。** 注意全局 YAHOO 命名空间的使用。

```
YAHOO.namespace("yuibook.calendar"); 

//define the lauchCal function which creates the calendar 
YAHOO.yuibook.calendar.launchCal = function() { 

    //create the calendar object, specifying the container 
    YAHOO.yuibook.calendar.myCal = new YAHOO.widget.Calendar("mycal"); 

    //draw the calendar on screen 
    myCal.render(); 
}

//define the showCal function which shows the calendar
Var showCal = function() { 
    //show the calendar 
    YAHOO.yuibook.calendar.myCal.show(); 
} 

//create calendar on page load
YAHOO.util.Event.onDOMReady(YAHOO.yuibook.calendar.launchCal); 

//attach listener for click event on calendar icon 
YAHOO.util.Event.addListener("calico", "click", showCal); 

//myCal.hide(); 
```

# html - IE 没有在图像周围环绕文字

> ID：388223
> 
> 赞同：1
> 
> 时间：2008-12-23T05:10:24.077
> 
> 标签：html, internet-explorer

我有一个带有这个 HTML 的页面：

```
<p>
    <img src="images/ih01.jpg" width="80" height="110" align="left" />
    This course overs basic human anatomy and physiology, including the major
    body systems and their functions. When you have completed this course you
    will be able to identify major body components and their core physiological
    functions.
</p> 
```

这就是它在 Firefox 3、Chrome 1.0 和 IE7 中的显示方式：（点击查看完整尺寸）

[http://fisher.spadgos.com/stuff/ie-align-fail.png](http://fisher.spadgos.com/stuff/ie-align-fail.png)

您可以看到 IE 没有将文本环绕在图像周围，即使它是左对齐的。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-23T05:12:43.200

采用：

```
<img src="images/ih01.jpg" style="float: left; height: 110px; width: 80px; " > 
```

而不是对齐。align 属性已[弃用](http://www.w3schools.com/tags/tag_IMG.asp)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T05:15:00.510

首先，不推荐使用“对齐”。您需要在此处使用 CSS 浮动属性。

```
<p>
    <img src="images/ih01.jpg" style="float:left;height:110px;width:80px" />    
    This course overs basic human anatomy and physiology, including the major
    body systems and their functions. When you have completed this course you
    will be able to identify major body components and their core physiological
    functions.
</p> 
```

是时候花点时间来[学习花车了](http://css.maxdesign.com.au/floatutorial/)！

# wpf - WPF ListBox Image Selected 传奇继续

> ID：388232
> 
> 赞同：8
> 
> 时间：2008-12-23T05:15:55.423
> 
> 标签：wpf, image, listbox, focus, selected

好的，在我的 ListBox 滚动图像和文本等中，传奇仍在继续。当我单击其中一个项目来选择它时，它会运行一个进程来打开 Web 浏览器并转到特定的 URL。我现在遇到的问题是，当 WPF 应用程序失去焦点并且 Web 浏览器打开时，在列表框中单击的项目变为白色。这是整个 ListBox XAML。我已将所选项目设置为透明，那么这与 WPF 应用程序失去焦点有关吗？

有什么我可以添加运行该过程的代码以打开 Web 浏览器以将焦点重新设置回 WPF 应用程序吗？

谢谢。

```
 <ListBox ItemsSource="{Binding Source={StaticResource WPFApparelCollection}}" Margin="61,-8,68,-18" ScrollViewer.VerticalScrollBarVisibility="Hidden" ScrollViewer.HorizontalScrollBarVisibility="Hidden" SelectionMode="Single" x:Name="list1" MouseLeave="List1_MouseLeave" MouseMove="List1_MouseMove" Style="{DynamicResource ListBoxStyle1}" Background="Transparent" BorderThickness="0">
        <ListBox.ItemContainerStyle>
            <Style TargetType="{x:Type ListBoxItem}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
                <Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
                <Setter Property="Padding" Value="20,10,20,10" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ListBoxItem}">
                            <Border x:Name="Bd" SnapsToDevicePixels="true" Background="Transparent" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected" Value="true">
                                    <Setter Property="Background" TargetName="Bd" Value="Transparent" />
                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsSelected" Value="true" />
                                        <Condition Property="Selector.IsSelectionActive" Value="false" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                                </MultiTrigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ListBox.ItemContainerStyle>
        <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <VirtualizingStackPanel Orientation="Horizontal" IsItemsHost="True" />
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Orientation="Vertical">
                    <Grid>
                        <Image Source="{Binding Image}" MouseLeave="Image_MouseLeave" MouseEnter="Image_MouseEnter" Cursor="Hand" Tag="{Binding Link}" MouseLeftButtonDown="Image_MouseLeftButtonDown"  VerticalAlignment="Top" HorizontalAlignment="Left"></Image>
                    </Grid>
                    <Label Content="{Binding Name}" Cursor="Hand" Tag="{Binding Link}" MouseLeftButtonDown="Label_MouseLeftButtonDown" VerticalAlignment="Bottom" Foreground="White" Style="{StaticResource Gotham-Medium}" FontSize="8pt" HorizontalAlignment="Center" />
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-12-23T06:38:26.583

我在 ListBox 中使用选择颜色时发现的一个技巧是使用系统画笔而不是与它们对抗。

当 ListBox 获得焦点并选择了一个项目时，该项目的背景是 SystemColors.HighlightBrush。但是，当 ListBox 失去焦点时，所选项目的背景变为 SystemColors.ControlBrush。

知道这一点后，您可以覆盖该*ListBox*的系统画笔，以便将其中的项目涂上您想要的颜色。

```
<ListBox>
    <ListBox.Resources>
        <!-- override the system brushes so that selected items are transparent
             whether the ListBox has focus or not -->
        <SolidColorBrush
            x:Key="{x:Static SystemColors.HighlightBrushKey}" 
            Color="Transparent" />
        <SolidColorBrush
            x:Key="{x:Static SystemColors.ControlBrushKey}" 
            Color="Transparent" />
        <SolidColorBrush
            x:Key="{x:Static SystemColors.HighlightTextBrushKey}" 
            Color="Black" />
    </ListBox.Resources>
    <!-- ... your items here ... -->
</ListBox> 
```

# python - 如何在 Django 中创建查找？

> ID：388233
> 
> 赞同：-1
> 
> 时间：2008-12-23T05:18:07.947
> 
> 标签：python, django, lookup

我有一个问题模型和表单，该模型中的一个字段是**userid=ForeignKey(User)**，这在问题模型上效果很好，能够从下拉列表中选择用户。

但是当我想从模型中列出问题时有点棘手，这是从用户表中**查找**用户名的最佳方法？因为此时我不能有下拉菜单！

我想要一个简单的东西，例如

提问者的问题标题：**查找用户名**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T18:35:56.277

您的字段名称（`userid`而不是`user`）让我认为您可能对 Django 的`ForeignKey`.

如果您定义这样的模型：

```
from django.contrib.auth.models import User
from django.db import models

class Question(models.Model):
    user = models.ForeignKey(User)
    title = models.CharField(max_length=100)
    ...

    def __unicode__(self):
        return self.title 
```

然后将 a 实例`Question`化为`question`：

```
>>> question.user # the `User` instance
<User: username>

>>> question.user_id # the user's primary key
1 
```

看起来您可能期望`question.userid`成为用户的主键，而不是实际的主键：`User`实例本身。当您访问 时`question.userid`，会执行数据库查找，但它是由 Django 使用 的值自动完成的`question.userid_id`。我会重命名该`userid`字段`user`以避免混淆。

顺便说一句，我认为您要做的是列出问题及其相关用户。如果是这种情况，请在您的模板中执行以下操作：

```
<ol>
{% for question in questions %}
    <li>{{ question }} asked by: {{ question.user }}</li>
{% endfor %}
</ol> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T06:20:27.900

我觉得你的问题含糊不清。如果要获取`Question`与给定 a 的特定`User`实例相关的所有实例，`user_name`可以这样做：

```
questions = Question.objects.filter( userid__username='user_name' ) 
```

如果您已经有一个`User`实例（例如，保存在一个名为 的变量中`user`）并且想要获取`Question`与其相关的所有对象，您可以通过以下方式获取这些对象：

```
questions = user.question_set.all() 
```

# ios - 在输入击键时获取 UITextField 的值？

> ID：388237
> 
> 赞同：107
> 
> 时间：2008-12-23T05:20:39.097
> 
> 标签：ios, objective-c, cocoa-touch, uitextfield

假设我有以下代码：

```
IBOutlet UITextField* nameTextField;
IBOutlet UILabel* greetingLabel; 
```

我想`greetingLabel`在用户按下任意键后立即阅读“Hello [nameTextField]”。

我需要的基本上是 Cocoa 委托方法的 iPhone 等价物`controlTextDidChange`。

`textField:shouldChangeCharactersInRange:`每次击键时都会调用委托方法：

```
- (BOOL)              textField:(UITextField *)textField
  shouldChangeCharactersInRange:(NSRange)range     
              replacementString:(NSString *)string 
```

字符串参数返回被按下的字符。然而，实际`textField`的值 ( `nameTextField.text`) 保持空白。

我在这里想念什么？（我想`nameTextField`反映用户到目前为止输入的确切字符串）。

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2008-12-23T10:26:52.737

事实证明，最简单的方法是使用 Interface Builder：

*   添加一个 IBAction（例如，在本例中添加到 ViewController）
*   在 Interface Builder 中的 UITextField 上按住 Ctrl 键单击（或右键单击）
*   将“Editing Changed”事件连接到第一步中添加的 File's Owner's IBAction。

像魅力一样工作:)（我不敢相信我在这上面花了很多天，现在意识到解决方案比我想象的要简单得多:P）

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2008-12-23T08:19:22.043

您可以在文本字段上为事件 UIControlEventEditingChanges 注册一个操作：

```
[nameTextField addTarget:self action:@selector(updateLabelUsingContentsOfTextField:) forControlEvents:UIControlEventEditingChanged]; 
```

...

```
// TODO: error checking

- (void)updateLabelUsingContentsOfTextField:(id)sender {

    greetingLabel.text = [NSString stringWithFormat:@"Hello %@", ((UITextField *)sender).text];

} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-23T09:34:31.890

`UITextField`有一个通知`UITextFieldTextDidChange`，如果您注册它，每次文本更改时都会触发该通知。只需注册该通知并在通知调用的方法中更改标签的文本。

除此之外，传递给您的通知处理程序的对象将具有`UITextField`.

希望有帮助。

# c# - 如何禁用 Response.Buffer

> ID：388238
> 
> 赞同：1
> 
> 时间：2008-12-23T05:20:56.443
> 
> 标签：c#, asp.net, buffer

这看起来很愚蠢 - 我一定错过了一些明显的东西。我有以下代码（仅作为测试）：

```
<%@ Page Language="C#" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<script runat="server">
    void page_load(object o, EventArgs e)
    {
        Response.Write(new string(' ', 255));
        Response.Flush();
        for (int i = 0; i < 10; i++)
        {
            Response.Write(i + "<BR>");
            Response.Flush();
            System.Threading.Thread.Sleep(500);
        }

    }
</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        main div
    </div>
    </form>
</body>
</html> 
```

当我在本地测试这个（vista x64，cassini）时，我得到了所需的输出.. 1，然后 2，然后 3 等都以非缓冲方式发送到浏览器。当我在开发服务器（2003，iis6）上尝试此操作时，它只是将所有内容缓冲并一次发送。有什么明显的我失踪了吗？我也尝试将 buffer=false 放在顶部，但这也不会改变这种行为。

为了进一步澄清，我用 fiddler 做了一个测试来比较两台服务器。第一个服务器是局域网上的本地服务器，第二个是公共服务器。fiddler 发现两者之间没有明显的区别，除了主机名。LAN服务器在页面加载完成之前没有写出响应，公共服务器在发生时写出响应。我还可以确认这种行为发生在 Firefox 和 ie 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T05:33:34.297

在 Page_Load 中试试这个：

```
Response.BufferOutput = false; 
```

[还可以获取Fiddler](http://www.fiddlertool.com/fiddler/)的副本并观察您的 HTTP 对话，以确保您的页面没有被缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-31T07:20:37.357

当您访问公共站点时，我花了 2 美分，您正在通过网络代理运行，这就是内容被缓存的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-14T01:28:07.477

您还可以以编程方式指示浏览器放弃所选页面的缓存（尽管实际上由浏览器决定是否遵守您的指令）。

```
Public Sub KillCache()
    Response.Cache.SetCacheability(System.Web.HttpCacheability.NoCache)
    Response.Cache.SetExpires(New Date(1900, 1, 1))
    Response.Cache.SetMaxAge(New TimeSpan(0, 0, 5))   '// 5 SECONDS'
    Response.Cache.SetNoServerCaching()
    Response.Cache.SetNoStore()
    Response.Cache.SetRevalidation(HttpCacheRevalidation.AllCaches)
End Sub 
```

# c++ - The Definitive C++ Book Guide and List

> ID：388242
> 
> 赞同：4235
> 
> 时间：2008-12-23T05:23:56.063
> 
> 标签：c++-faq, c++, c++-faq

这个问题试图收集每年出版的几十本糟糕的 C++ 书籍中的几颗珍珠。

与许多其他经常从 Internet 上找到的教程在旅途中学习的编程语言不同，很少有人能够在不学习写得很好的 C++ 书籍的情况下快速学习 C++。这样做太大太复杂了。事实上，它是如此庞大和复杂，以至于***有很多非常糟糕的 C++ 书籍***。而且我们不是在谈论糟糕的风格，而是在谈论*明显的事实错误*和*推广极其糟糕的编程风格*。

请编辑接受的答案以提供**高质量的书籍**和大致的技能水平 -*最好* **在** *[C++ 聊天室](https://chat.stackoverflow.com/rooms/10/loungec)**讨论您的添加*之后。（如果他们不同意推荐，常客可能会无情地撤销您的工作。）为您亲自阅读/受益的每本书添加简短的宣传/描述。随意讨论质量、标题等。符合标准的书籍将被添加到列表中。有 C 和 C++ 用户协会 (ACCU) 评论的书籍有评论链接。

[*注意：常见问题和其他资源可以在[C++ 标签信息](https://stackoverflow.com/tags/c%2b%2b/info)和[c++-faq](/questions/tagged/c%2b%2b-faq "显示标记为“c++-faq”的问题")下找到。]

* * *

## 回答 #1

> 赞同：5542
> 
> 时间：2008-12-23T05:52:48.530

## 初学者

### 入门级，无编程经验

| 书 | 作者 | 描述 | 审查 |
| --- | --- | --- | --- |
| [*C++ Primer*](https://rads.stackoverflow.com/amzn/click/com/0321714113) * 
^(* 不要与[*C++ Primer Plus*](https://rads.stackoverflow.com/amzn/click/com/0672326973) [(Stephen Prata) 混淆，评论](//accu.org/bookreviews/2002/glassborow_1744)明显不太好。) | Stanley Lippman、Josée Lajoie 和 Barbara E. Moo（**针对 C++11 更新**） | 这本书有 1k 页，是对 C++ 的非常全面的介绍，它以一种非常易于理解的格式和非常详细的方式涵盖了该语言中的几乎所有内容。第五版（2012 年 8 月 16 日发布）涵盖了 C++11。 | [[审查]](//accu.org/bookreviews/2012/glassborow_1848) |
| [*编程：使用 C++ 的原理与实践*](https://rads.stackoverflow.com/amzn/click/com/0321992784) | Bjarne Stroustrup，第 2 版 - 2014 年 5 月 25 日（**针对 C++11/C++14 更新**） | 由语言的创建者介绍使用 C++ 进行编程。一本好书，假设没有以前的编程经验，但不仅适用于初学者。 |  |

### 入门，有以前的编程经验

| 书 | 作者 | 描述 | 审查 |
| --- | --- | --- | --- |
| [*C++ 之旅*](https://rads.stackoverflow.com/amzn/click/com/B00F8CWGOS) | Bjarne Stroustrup（**[C++17 第 2 版](https://rads.stackoverflow.com/amzn/click/com/0134997832)**） | **“教程”是对所有标准 C++（语言和标准库，以及使用 C++11** ）的快速（大约 180 页和 14 章）教程概述，对于已经了解 C++ 或至少了解 C++ 的人来说，水平适中经验丰富的程序员。本书是构成《C++ 编程语言》第 4 版第 2-5 章材料的扩展版本。 |  |
| [*加速 C++*](https://rads.stackoverflow.com/amzn/click/com/020170353X) | Andrew Koenig 和 Barbara Moo，第 1 版 - 2000 年 8 月 24 日 | *这基本上涵盖了与C++ Primer*相同的基础，但只占用了四分之一的空间。这主要是因为它并不试图成为对*编程*的介绍，而是为以前用其他语言编程过的人介绍*C++ 。*它有一个更陡峭的学习曲线，但是，对于那些能够应付这一点的人来说，这是一个非常紧凑的语言介绍。（从历史上看，它是第一本使用现代方法教授语言的初学者书籍，从而开辟了新天地。）尽管如此，它所教授的 C++ 纯粹是 C++98。 | [[审查]](//accu.org/bookreviews/2000/glassborow_1185) |

### 最佳实践

| 书 | 作者 | 描述 | 审查 |
| --- | --- | --- | --- |
| [*有效的 C++*](https://rads.stackoverflow.com/amzn/click/com/0321334876) | Scott Meyers，第 3 版 - 2005 年 5 月 22 日 | 这本书的目的是成为 C++ 程序员应该阅读的最好的第二本书，它成功了。早期版本针对来自 C 的程序员，第三版改变了这一点，并针对来自 Java 等语言的程序员。它以一种非常容易理解（且令人愉快）的方式展示了大约 50 条易于记忆的经验法则及其基本原理。对于 C++11 和 C++14，示例和一些问题已经过时，应该首选有效的现代 C++。 | [[审查]](//accu.org/bookreviews/1998/glassborow_700) |
| [*有效的现代 C++*](https://rads.stackoverflow.com/amzn/click/com/1491903996) | 斯科特迈耶斯 | 本书面向从 C++03 过渡到 C++11 和 C++14 的 C++ 程序员。这本书可以看作是对前一本书《Effective C++》某些部分的延续和“修正”。它们不涵盖相同的内容，但保持类似的基于项目的主题。 |  |
| [*有效的 STL*](https://rads.stackoverflow.com/amzn/click/com/0201749629) | 斯科特迈耶斯 | 这旨在对来自 STL 的标准库的部分做同样的事情，就像*Effective C++*对整个语言所做的那样：它提出了经验法则及其基本原理。 | [[审查]](//accu.org/bookreviews/2019/floyd_1937) |

* * *

## 中间的

| 书 | 作者 | 描述 | 审查 |
| --- | --- | --- | --- |
| [*更有效的 C++*](https://rads.stackoverflow.com/amzn/click/com/020163371X) | 斯科特迈耶斯 | *比有效 C++*更多的经验法则。不如第一本书中的重要，但仍然很高兴知道。 |  |
| [*卓越的 C++*](https://rads.stackoverflow.com/amzn/click/com/0201615622) | 赫伯萨特 | 作为一组谜题，除了深入涵盖包括 pimpl 在内的各种其他主题外，它还通过资源获取即初始化 (RAII) 对 C++ 中的适当资源管理和异常安全进行了最佳和彻底的讨论之一成语、名称查找、良好的类设计和 C++ 内存模型。 | [[审查]](//accu.org/bookreviews/2000/griffiths_209) |
| [*更出色的 C++*](https://rads.stackoverflow.com/amzn/click/com/020170434X) | 赫伯萨特 | 除了讨论 C++ 中有效的面向对象编程和正确使用 STL 之外，还涵盖了*Exceptional C++*中未涵盖的其他异常安全主题。 | [[审查]](//accu.org/bookreviews/2002/glassborow_784) |
| [*卓越的 C++ 风格*](https://rads.stackoverflow.com/amzn/click/com/0201760428) | 赫伯萨特 | 讨论通用编程、优化和资源管理；这本书还很好地阐述了如何使用非成员函数和单一职责原则在 C++ 中编写模块化代码。 | [[审查]](//accu.org/bookreviews/2005/goodliffe_107) |
| [*C++ 编码标准*](https://rads.stackoverflow.com/amzn/click/com/0321113586) | Herb Sutter 和 Andrei Alexandrescu | 这里的“编码标准”并不意味着“我的代码应该缩进多少个空格？” 本书包含 101 个最佳实践、习语和常见陷阱，可帮助您编写正确、可理解和高效的 C++ 代码。 | [[审查]](//accu.org/bookreviews/2004/glassborow_1439) |
| [*C++ 模板：完整指南*](https://rads.stackoverflow.com/amzn/click/com/0201734842) | David Vandevoorde 和 Nicolai M. Josuttis | 这是*一*本关于 C++11 之前存在的模板的书。它涵盖了从非常基础到一些最先进的模板元编程的所有内容，并解释了模板如何工作的每一个细节（包括概念上的以及它们是如何实现的），并讨论了许多常见的陷阱。附录中对单一定义规则 (ODR) 和重载解决方案进行了出色的总结。涵盖 C++11、C++14 和 C++17的[第二版](https://rads.stackoverflow.com/amzn/click/com/0321714121)已经出版。 | [[审查]](//accu.org/bookreviews/2020/floyd_1946) |
| [*C++ 17 - 完整指南*](//leanpub.com/cpp17) | Nicolai M. Josuttis | 本书描述了 C++17 标准中引入的所有新特性，涵盖了从简单的“内联变量”、“constexpr if”等简单特性一直到“多态内存资源”和“使用过度对齐数据的新建和删除”的所有内容'。 | [[审查]](//accu.org/bookreviews/2020/floyd_1943) |
| [*C++ 20 - 完整指南*](//leanpub.com/cpp20) | Nicolai M. Josuttis | 本书介绍了 C++20 的所有新语言和库特性。它通过示例和背景信息涵盖了每个新功能的动机和背景。重点是这些特性如何影响日常编程，将它们结合起来意味着什么，以及如何在实践中从 C++20 中受益。（请注意，本书是**逐步出版的**。） |  |
| [*C++ 在行动*](http://www.worldcolleges.info/sites/default/files/C++_In_Action.pdf) | 巴托什·米列夫斯基 | 本书通过从头开始构建应用程序来解释 C++ 及其特性。 | [[审查]](//eli.thegreenplace.net/2003/09/12/book-review-c-in-action-by-bartosz-milewski) |
| [*C++ 中的函数式编程*](//www.manning.com/books/functional-programming-in-c-plus-plus) | 伊万·丘基奇 | 本书介绍了现代 C++（C++11 及更高版本）的函数式编程技术。对于那些想要将函数式编程范式应用于 C++ 的人来说，这是一本非常好的读物。 |  |

* * *

## 先进的

| 书 | 作者 | 描述 | 审查 |
| --- | --- | --- | --- |
| [*现代 C++ 设计*](https://rads.stackoverflow.com/amzn/click/com/0201704315) | 安德烈·亚历山德雷斯库 | 一本关于高级通用编程技术的开创性书籍。介绍基于策略的设计、类型列表和基本的泛型编程习惯用法，然后解释有多少有用的设计模式（包括小对象分配器、函子、工厂、访问者和多方法）可以使用泛型编程高效、模块化和干净地实现. | [[审查]](//accu.org/bookreviews/2001/glassborow_979) |
| [*C++ 模板元编程*](https://rads.stackoverflow.com/amzn/click/com/0321227255) | David Abrahams 和 Aleksey Gurtovoy |  |  |
| [*C++ 并发实战*](https://rads.stackoverflow.com/amzn/click/com/1933988770) | 安东尼·威廉姆斯 | 一本涵盖 C++11 并发支持的书，包括线程库、原子库、C++ 内存模型、锁和互斥锁，以及设计和调试多线程应用程序的问题。涵盖 C++14 和 C++17的[第二版](https://rads.stackoverflow.com/amzn/click/com/1617294691)已经出版。 | [[审查]](//accu.org/bookreviews/2012/glassborow_1850) |
| [*高级 C++ 元编程*](https://rads.stackoverflow.com/amzn/click/com/1460966163) | 戴维德·迪·热纳罗 | 一份 C++11 之前的 TMP 技术手册，更侧重于实践而非理论。本书中有大量片段，其中一些因类型特征而过时，但了解这些技术仍然很有用。如果你能忍受古怪的格式/编辑，它比 Alexandrescu 更容易阅读，而且可以说更有价值。对于更有经验的开发人员，您很有可能会发现一些关于 C++ 黑暗角落的东西（一个怪癖），而这通常只能通过丰富的经验来实现。 |  |
| [*大规模 C++ 第 I 卷，过程和架构*](//www.pearson.com/store/p/large-scale-c-volume-i-process-and-architecture/P100001343596/9780201717068)(2020) | 约翰·拉科斯 | 扩展旧书“大规模 C++ 设计”的三部分系列的第一部分。Lakos 解释了管理大型 C++ 软件项目的久经考验的技术。如果您在一个大型 C++ 软件项目中工作，这是一本很好的读物，详细介绍了物理和逻辑结构之间的关系、组件的策略以及它们的重用。 | [[审查]](//accu.org/bookreviews/2020/bruntlett_1953/) |

* * *

## 参考风格 - 所有级别

| 书 | 作者 | 描述 | 审查 |
| --- | --- | --- | --- |
| [*C++ 编程语言*](https://rads.stackoverflow.com/amzn/click/com/0321958322) | Bjarne Stroustrup（**针对 C++11 更新**） | 其创建者对 C++ 的经典介绍。与经典的 K&R 并行编写，这确实读起来非常喜欢，涵盖了从核心语言到标准库、编程范式到语言哲学的几乎所有内容。 | [[评论]注意：C++ 标准的所有版本都在问题“](//accu.org/bookreviews/2014/lenton_1853) [*[我在哪里可以找到当前的 C 或 C++ 标准文档？](/questions/81656/where-do-i-find-the-current-c-or-c-standard-documents)*] [”中进行跟踪。] |
| [*C++ 标准库教程和参考*](https://rads.stackoverflow.com/amzn/click/com/0321623215) | Nicolai Josuttis（**针对 C++11 更新**） | *C++标准库的*介绍和参考。第二版（2012 年 4 月 9 日发布）涵盖了 C++11。 | [[审查]](//accu.org/bookreviews/2012/glassborow_1849) |
| [*C++ IO 流和语言环境*](https://rads.stackoverflow.com/amzn/click/com/0201183951) | 安吉丽卡·兰格和克劳斯·克雷夫特 | 除了如果您想了解有关流和语言环境的任何信息，这本书几乎没有什么可说的，那么这里就是找到明确答案的地方。 | [[审查]](//accu.org/bookreviews/2000/glassborow_200) |

**C++11/14/17/… 参考资料：**

*   *C++ [11](//www.iso.org/standard/50372.html) / [14](//www.iso.org/standard/64029.html) / [17](//www.iso.org/standard/68564.html)标准 (INCITS/ISO/IEC 14882:2011/2014/2017)*当然，这是所有 C++ 的最终仲裁者。但是请注意，它仅供愿意花费大量时间和精力来理解它的有*经验的用户的参考。*C++17 标准以电子形式发布，价格为 198 瑞士法郎。

*   C++17 标准是可用的，但似乎不是一种经济的形式——[直接来自 ISO](//www.iso.org/standard/68564.html)，它的成本为 198 瑞士法郎（约 200 美元）。对于大多数人来说，[标准化之前的最终草案已经](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4659.pdf)足够了（而且是免费的）。许多人会更喜欢[更新的草稿](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/n4778.pdf)，记录可能包含在 C++20 中的新特性。

*   [*新 C++ (C++11/14) 概述（仅 PDF）*](//www.artima.com/shop/overview_of_the_new_cpp)（Scott Meyers）（**针对 C++14 更新**） 这些是由Scott Meyers，一位备受尊敬的 C++ 作家。尽管项目列表很短，但质量很高。

*   [*C++ 核心指南 (C++11/14/17/...)*](//github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md)（由 Bjarne Stroustrup 和 Herb Sutter 编辑）是一个不断发展的在线文档，其中包含一组用于使用现代 C++ 的指南。该指南侧重于相对更高级别的问题，例如接口、资源管理、内存管理以及影响应用程序架构和库设计的并发性。该项目[由 Bjarne Stroustrup 和其他人在 CppCon'15 上宣布，](//isocpp.org/blog/2015/09/bjarne-stroustrup-announces-cpp-core-guidelines)并欢迎社区的贡献。大多数指南都附有基本原理和示例以及对可能的工具支持的讨论。许多规则是专门为静态分析工具自动检查而设计的。

*   [*C++ 超级常见问题解答*](//isocpp.org/faq)（Marshall Cline、Bjarne Stroustrup 等）是标准 C++ 基金会的一项努力，旨在统一以前由 Marshall Cline 和 Bjarne Stroustrup 单独维护的 C++ 常见问题解答，并纳入新的贡献。这些项目主要解决中级问题，并且通常以幽默的语气书写。并非所有项目都完全符合最新版本的 C++ 标准。

*   [*cppreference.com (C++03/11/14/17/…)*](//cppreference.com)（由 Nate Kohl 发起）是一个总结基本核心语言功能的 wiki，并拥有 C++ 标准库的大量文档。该文档非常精确，但比官方标准文档更易于阅读，并且由于其 wiki 特性提供了更好的导航。该项目记录了 C++ 标准的所有版本，并且该站点允许过滤特定版本的显示。该项目[由 Nate Kohl 在 CppCon'14 上介绍](//isocpp.org/blog/2015/07/cppcon-2014-cppreference.com-documenting-cpp-one-edit-at-a-time-nate-kohl)。

* * *

## 经典/旧

**注意：**这些书中包含的某些信息可能不是最新的或不再被视为最佳实践。

*   [*C++ 的设计和演变*](https://rads.stackoverflow.com/amzn/click/com/0201543303)(Bjarne Stroustrup) 如果你想知道*为什么*这门语言是这样的，这本书就是你找到答案的地方。这涵盖了 C++*标准化之前的所有内容。*

*   [*关于 C++ 的思考*](https://rads.stackoverflow.com/amzn/click/com/0201423391)——（Andrew Koenig 和 Barbara Moo） [[评论]](//accu.org/bookreviews/1997/glassborow_776)

*   [*高级 C++ 编程风格和习语*](https://rads.stackoverflow.com/amzn/click/com/0201548550)(James Coplien) 模式运动的前身，它描述了许多 C++ 特定的“习语”。这当然是一本非常好的书，如果你能抽出时间，它可能仍然值得一读，但它已经很老了，而且与当前的 C++ 不兼容。

*   [*大规模 C++ 软件设计*](https://rads.stackoverflow.com/amzn/click/com/0201633620)(John Lakos) Lakos 解释了管理非常大的 C++ 软件项目的技术。当然，如果它只是最新的，那是一本好书。它是在 C++ 98 之前很久就编写的，并且遗漏了许多对大型项目很重要的特性（例如命名空间）。如果您需要处理一个大型 C++ 软件项目，您可能想阅读它，尽管您需要的不仅仅是一粒盐。不要与扩展后的系列大型 C++ 卷 I-III 混淆。

*   [*C++ 对象模型内部*](https://rads.stackoverflow.com/amzn/click/com/0201834545)（Stanley Lippman）找到对此类主题的彻底讨论。

*   [*The Annotated C++ Reference Manual*](https://rads.stackoverflow.com/amzn/click/com/0201514591) (Bjarne Stroustrup, Margaret A. Ellis) 这本书已经过时了，因为它探讨了 1989 年的 C++ 2.0 版本——模板、异常、命名空间和新的类型转换还没有引入。话虽如此，这本书贯穿了当时的整个 C++ 标准，解释了该语言的基本原理、可能的实现和特性。这不是一本学习 C++ 编程原理和模式的书，而是一本了解 C++ 语言各个方面的书。

*   [*用 C++ 思考*](https://rads.stackoverflow.com/amzn/click/com/0139798099)（Bruce Eckel，第 2 版，2000）。两卷；*是一套免费*的教程式入门级书籍。下载：[第 1](//ia800100.us.archive.org/10/items/TICPP2ndEdVolOne/TICPP-2nd-ed-Vol-one.zip)卷，[第 2 卷](//ia800108.us.archive.org/24/items/TICPP2ndEdVolTwo/TICPP-2nd-ed-Vol-two.zip)。不幸的是，它们被许多微不足道的错误所破坏（例如，保持临时变量是自动的`const`），没有正式的勘误表。[http://www.computersciencelab.com/Eckel.htm](http://www.computersciencelab.com/Eckel.htm)上提供了部分第 3^方勘误表，但显然没有维护。

*   [*科学与工程 C++：高级技术和示例介绍*](https://rads.stackoverflow.com/amzn/click/com/0201533936)（John Barton 和 Lee Nackman）这是一本全面且非常详细的书，试图在数值方法的背景下解释和利用 C++ 中可用的所有功能。它当时引入了几种新技术，例如奇怪重复模板模式（CRTP，也称为 Barton-Nackman 技巧）。它开创了多种技术，例如维度分析和自动微分。它附带了许多可编译且有用的代码，从表达式解析器到 Lapack 包装器。该代码[仍然可以在线获得](//www.informit.com/store/scientific-and-engineering-c-plus-plus-an-introduction-9780201533934). 不幸的是，这些书的风格和 C++ 特性已经有些过时了，然而，在当时（1994 年，STL 之前），它是一部令人难以置信的杰作。动态继承的章节理解起来有点复杂，也不是很有用。这本经典书籍的更新版本，包括移动语义和从 STL 中吸取的教训，将会非常好。

# c++ - 对象构造函数的 C++ 2D 数组

> ID：388258
> 
> 赞同：1
> 
> 时间：2008-12-23T05:39:29.073
> 
> 标签：c++, class, object, multidimensional-array

在我的 Dev C++ 中，我正在尝试创建一个 2D Array 类，它的作用类似于 Grid。但问题之一是我不确定对构造函数做了什么。

当我尝试编译时，出现以下错误： 在构造函数中 'Grid::Grid(int,int)': 'sqaures' 不是类型 'yPos' 不能出现在常量表达式中 [Build Error] [grid. o] 错误 1

这是头文件：

```
#ifndef GRID_H
#define GRID_H

using namespace std;

class Grid
{
      public:

      Grid(int xPos, int yPos);
      // Constructor
      // POST: Creates the squares of grid; (x,y) coordinates

      private:

      int squares;
      //2D Array
      //the squares; (x,y) coordinates of the grids      
};

#endif 
```

这是grid.h功能的.cpp文件

```
#include <iostream>
#include "grid.h"

using namespace std;

Grid::Grid(int xPos, int yPos)
{
    squares = new squares[xPos][yPos];
    //Trying to make squares into a 2D array, and turn the values into the arguments
    //into the the x,y coordinates 
} 
```

我在 .cpp 文件中的构造函数不起作用，我不确定该怎么做。有没有人有任何解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T05:47:41.647

与您的问题没有直接关系，但您不应该在头文件（.h/.hpp）文件中使用声明。

例如：

```
using namespace std;
```

这些属于 cpp 文件。

有关原因，请参阅[Herb Sutters GOTW（本周大师）#53](http://www.gotw.ca/gotw/053.htm)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T06:02:37.670

您的代码存在一些问题。首先，您的成员变量“squares”应该是**指向 int**的指针，而不是*int*：

```
int *squares; 
```

然后，以下行将给出错误：

```
squares = new squares[xPos][yPos]; 
```

您真正需要的是 2D 数组的一块内存：

```
squares = new squares[xPos * yPos]; 
```

此外，您应该将此数组的维度保存在成员变量中（例如， "sizeX" 和 "sizeY" ）

现在，您有一块内存，可以容纳一个二维正方形数组。我通常重载 () 运算符以访问此数组中的元素：

```
int &Grid::operator() (int x, int y)
{
      // you can check array boundaries here
      return squares[y + sizeX*x];
} 
```

如果您对操作符有疑问，只需创建一个成员函数：

```
int Grid::get(int x, int y)
{
     // check array bounds
     return squares[y + sizeX*x];
}
void Grid::set(int x, int y, int value)
{
     // check array bounds
     squares[y + sizeX*x] = value;
} 
```

最后，您需要一个析构函数来释放内存：

```
Grid::~Grid()
{
     delete [] squares;
} 
```

这就是我喜欢的方式（“C-with-classes”风格）。在另一个答案中，David Norman 给出了一个很好的“标准 C++”实现你的类的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T05:50:23.980

为避免大量内存问题，请使用向量向量。

在标题中

```
class Grid
{
    ...
    std::vector< std::vector<squares> > squares;
    ...
} 
```

在.cpp

```
Grid::Grid(int xPos, int yPos)
{
    squares.resize(xPos);
    for (int i = 0; i < xPos; i++) {
        squares[i].resize(yPos);
    }
} 
```

稍后的：

```
squares[2][3] = square(...); 
```

或者，如果您想新建正方形，请使用智能指针向量的向量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T05:42:26.337

你确定你的代码正确吗？您的正方形被定义为 int，而不是 int**？我不确定你是如何编译它的......

编辑：您从将正方形定义为 int 得到的错误消息。因此，它只能取一个整数。您的构造函数试图将整个数组分配给它。你对指针、数组、解引用和所有这些东西足够熟悉吗？二维数组通常很棘手。

如果你写好你的二维数组，你实际上可以使用一个数组，只需将二维地址映射到一个索引中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T06:07:40.343

```
Grid::Grid(int xPos, int yPos) {
    squares = new squares[xPos][yPos];
    //Trying to make squares into a 2D array, and turn the values into the arguments
    //into the the x,y coordinates 
} 
```

那当然是错误的。你必须做`new int[xPos][yPos]`。运算符要求您给它一个类型。但是，你还没有完成。`yPos`必须在编译时知道。在你的例子中它不是。原因是它成为新表达式返回的类型的一部分：

```
int (*squares)[yPos] = new int[xPos][yPos]; 
```

由于类型是静态的，因此无法在运行时确定 yPos。你真正想要的是一个 int 的向量。但是我认为您想自己进行内存管理，因为您想学习语言规则。所以去吧：

1.  制作正方形 a `int*`：`int *squares;`
2.  将构造函数中的行更改为`squares = new int[xPos * yPos];`
3.  `delete[] squares;`在你的析构函数中添加一行。
4.  添加复制构造函数和复制赋值运算符，当您的实例被复制时，它们会沿着您的内存进行复制。
5.  添加如下成员函数：

代码：

```
int & get(int x, int y) { return squares[y * yPos + x]; } 
```

这将为您提供给定位置的整数。当然，您也可以重载`operator[]`以使用 2d 索引进行自然访问：

```
class Grid {
    struct proxy {
        proxy(int *row):row(row) { }
        int & operator[](int x) {
            return row[x];
        }
        int * row;
    };

    int * squares;
public:
    proxy operator[](int y) {
        return proxy(squares + yPos * y); 
    }
}; 
```

外部索引将选择行，内部将选择列。如果您必须正确管理内存，则可以更改为更好的解决方案。对于您的任务，`boost::multi_array`是理想的：[Boost.MultiArray](http://www.boost.org/doc/libs/1_37_0/libs/multi_array/doc/user.html)

### 其他问题

永远不要`using namespace std;`在头文件中做。原因是间接或直接包含该文件的所有代码也将自动包含该行，因此可以看到*所有 std::*。只要代码尝试引用恰好由 C++ 标准库定义的名称，就会发生名称冲突。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-23T06:10:26.560

这不起作用：

```
squares = new squares[xPos][yPos]; 
```

你需要：

```
squares = new (int*)[xPos];
for (int x = 0; x < xPos; ++x) {
     squares[x] = new int[yPos];
} 
```

就个人而言，这是错误的做法。我更喜欢

```
class Grid {

     class Row {
         int* row; // this is a pointer into Grid::grid
         int size; // this equals Grid::col_count and is only here for bounds checking
     public:
         Row(int s, int* r) : size(s), row(r) {}

         int& operator[](int col) {
             if (col >=0 && col < size) return row[col];
             throw OutOfBoundsException();
         }
     };

     int row_count, col_count;
     int* grid;
     Row* rows;

  public:
     Grid(int x, int y) : row_count(x), col_count(y) {
         rows = new (Row*)[row_count];
         grid = new int[row_count*col_count];
         int* grid_walk = grid;
         for (int i = 0; i < row_count; ++i) {
             rows[i] = new Row(col_count, grid_walk);
             grid_walk += col_count;
         }
     }
     ~Grid() { delete[] rows; delete[] grid; }

     Row& operator[](int row) {
         if (row ?= 0 && row < row_count) return rows[row];
         throw OutOfBoundsException();
     }

     int rows() const { return row_count; }
     int cols() const { return col_count; }

};

Grid checkers(8,8);

for (r = 0; r < checkers.row_count(); ++r) {
    for (c = 0; c < checkers.col_count(); ++c) {
        if ((r + c) % 2 == 1) checkers[r][c] = -1; // red space
        else if (r < 3) checkers[r][c] = 1; // player 1
        else if (r >= 5) checkers[r][c] = 2; // player 2
        else checkers[r][c] = 0; // open square
    }
}
// etc. 
```

希望没有太多错别字。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-23T11:06:43.937

根据[大卫诺曼的回答](https://stackoverflow.com/questions/388258/c-2d-arrays-of-an-object-constructor/388278#388278)，使用`std::vector`. 但是他的回答中有一个错误，向量应该声明如下：

```
class Grid
{
...

    std::vector< std::vector<int> > squares;
}; 
```

您还可以使用带有大小和值的向量构造函数对其进行初始化：

```
Grid::Grid(int xPos, int yPos)
:   squares( xPos, std::vector<int>( yPos, 0 ) )
{
} 
```

# macos - 为程序员设置 Mac

> ID：388264
> 
> 赞同：16
> 
> 时间：2008-12-23T05:42:01.407
> 
> 标签：macos, development-environment

我最近换用了 MacBook Pro，所以我对 Mac 软件生态系统还是很陌生。什么是最好的指南，或者您有什么技巧可以快速熟练地使用 Mac 在 Mac/Unix 和 MS 平台（*.NET、SharePoint、SQL Server 等）上使用 VMWare Fusion 进行开发？例如，我设置了 NetBeans、FlexBuilder、Eclipse、TextMate、VMWare Fusion、OpenOffice、FireFox，将 Terminal.app 拖到我的 Dock 上，升级了 Ruby 安装和相关的 gem 等等......我还没有做过的事情，但是查看（基于其他人的经验）包括 QuickSilver（它与 SpotLight 有什么不同吗？）、MacPorts（或 Fink？）、iPhone 入门、Android 等等。你可以从我的缺乏经验中看出，我还不知道最好的做事方式是什么，并且不知道 不想养成只安装东西然后把文件和东西放在周围放慢系统速度的习惯。如果您对设置开发人员的 Mac 有任何非常酷的提示，请分享！

**更新：**我的工作性质是我一直在使用新的/不同的技术，有些是基于 Windows/MS 的，有些不是，对于 Mac（和 Fusion），即使是基于 MS 的东西对我来说也更有趣。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-23T05:46:22.053

我强烈推荐 MacPorts - 您可以通过简单的方式快速轻松地安装新软件包

```
sudo port install package-name 
```

无需浏览网站以查找发行版，下载磁盘映像并运行安装程序，或下载 tarball 并解压缩，运行配置脚本和运行 make 等。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-23T05:49:37.930

找到一些现金并为您的 Mac 投资额外的内存。我知道这可能不是您想听到的提示，但老实说，从长远来看，它会为您节省挫败感。苹果公司运送这些婴儿的内存比他们应得的要少得多，并为扩展收取了一条胳膊和一条腿的费用。我让 Mac Pro（四核 Xeon）爬行停止，直到我在那里获得了一些真实的记忆。

另一个提示是获得一个像样的键盘和鼠标。不要相信史蒂夫·乔布斯“一键搞定一切”的废话。它适用于 ichat，不适用于真正的编程。给自己一个真正的键盘和一个带有多个按钮的真正的鼠标。配置您的中间滚轮按钮以打开公开或显示所有窗口的任何内容。配置您的第四个按钮进行放大。

另外，从您的描述看来，您并不真正知道要开发什么。如果您正在做特定于 mac 的事情，请尽快习惯 XCode，然后放弃其余的。如果你想做windows编程，不知道为什么要使用mac。如果你想要 Java，你有 Eclipse，你准备好了。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-23T06:53:38.317

安装所有 Mac 开发的东西，XCode 等，这样你就可以得到编译器。

当然，麦克波特。查看他们的目录并从 Linux 或其他系统安装您习惯使用的所有常用软件包——包括与开发相关的东西，如 flex/bison、emacs、doxygen、m4、perl、python 等。

我更喜欢“iTerm”而不是内置终端。不要忘记“导出 COMMAND_MODE=unix2003”，这会使许多事情按照您习惯的方式工作。

我没有为我提到的任何事情提供 URL。这就是谷歌的目的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-23T05:45:14.897

首先，安装[XCode](http://developer.apple.com/Tools/xcode/)。这为您提供了 Mac OS X 开发环境，但最重要的是，它还安装了 GCC，因此您可以构建自己的项目和作为源代码分发的应用程序。之后，我建议查看[TextMate](http://macromates.com/)，这是一个流行的 Mac OS X 文本编辑器（如 Rails 截屏视频所示）。如果您是 Emacs/Vim 用户，则可以使用[Aquamacs](http://aquamacs.org/)和[MacVim](http://code.google.com/p/macvim/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-23T08:27:19.797

投资一个好的文本编辑器。请参阅以下问题：

[https://stackoverflow.com/questions/100084/what-is-a-good-gui-text-editor-for-the-mac](https://stackoverflow.com/questions/100084/what-is-a-good-gui-text-editor-for-the-mac) [Mac 文本/代码编辑器](https://stackoverflow.com/questions/20533/mac-textcode-editor)

“投资”是指金钱和/或学习时间。

XCode 对于 Objective-C 来说是一个足够好的编辑器，但我不会将它用作我所有的主要编辑器。

（MacVim 是我的选择）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-23T09:46:42.287

1.  安装最新版本的 Xcode（即使您不开发 macintosh/iphone 应用程序，您也将需要它）
2.  为大多数 OSS 工具安装[macports](http://www.macports.org/)（首先需要 Xcode）
3.  要运行不是 OSS 或 Windows 的工具，只安装[virtualbox](http://www.virtualbox.org/)我知道有替代方案（VM fusion 评价很高）但 virtual box 是免费的
4.  如果您不想使用 Xcode 作为 IDE（例如 eclipse 和 netbeans），请安装 IDE

最后，如果你有一些现金

1.  如果需要，升级 ram（软件开发人员喜欢 ram，特别是如果您正在运行 vm :)）
2.  第二个显示器，我无法想象少于两个显示器的开发

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-23T06:21:11.767

我在今年 8 月也做了同样的事情，我买了一台 Macbook Pro（其中较小的，但有 200Gb 7200rpm 和 4Gb 的 RAM），我可以告诉你我的经验。

我是一名 .NET 开发人员，并且担任 ASP 程序员已有 10 多年，所以我所做的只是与 Microsoft 相关，从来没有安装和使用 Ubuntu，我在 Linux 世界有经验。

但我的心思全在 iPhone SDK 开发上，我什至还为 iPhone 开发者计划付费，一切都很美好，我只是喜欢我的新 Mac！但是... Mac 编程对我来说是一种爱好，相信我，Fusion，即使是我的 4Gb 并为每个操作系统放置 2Gb，也不会像“普通”笔记本电脑那样运行得更好，所以经过 4 个月的挣扎后，我格式化我的笔记本电脑并创建了一个 Bootcamp 分区（哇，现在我可以将它用于 Windows！），Fusion 可以像虚拟机映像一样运行该 Boot Camp 分区，这对于我需要快速做一些事情的小时候很有用。

你所指的和 Uri 提到的那样，我不知道你会做什么，在笔记本电脑中有“一堆”应用程序确实说明了这一点，因为你所需要的只是 Eclipse 和 XCode 3.1使用 SDK for Mac 相关应用程序，仅此而已！

我和你一样，但我意识到我没有打开任何其他程序，除了编译 Objective-C 代码之外，Mac 是你更好的选择吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-23T11:38:48.897

virtualbox.org 不是 vmware fusion，而是免费的，值得一看。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-20T19:50:02.367

我选择一个出色的全能文本编辑器是[TextWrangler](http://www.barebones.com/products/textwrangler/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-23T05:48:47.167

确保从操作系统光盘安装开发者工具（XCode）（不要尝试在其顶部安装 GNU 版本：P）。

你已经完成了我所拥有的一切，除了我使用的是 Virtual Box 而不是 VMWare。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-23T07:02:21.573

我发现 OpenOffice 与实际的[Microsoft Office for Mac](http://www.microsoft.com/mac/products/Office2008/default.mspx)相比非常慢。如果您有一些预算，我建议您使用 OpenOffice。

我可以支持 QuickSilver 的推荐——它是我用过的最好的启动器之一。

对于 IM 客户端，如果您在 AIM 网络之外有联系人，那么您可能想要尝试[Adium](http://www.adiumx.com/) - 一个免费的多 IM 网络聊天客户端，具有方便的功能，例如可搜索的成绩单。

我强烈推荐的另一个通用实用程序是[iStat 菜单](http://islayer.com/apps/istatmenus/)- 它可以在菜单栏中为您提供 CPU、内存、磁盘等的实时监控。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-23T08:42:29.390

QuickSilver 是一个非常好的选择，是的，由于您可以拥有大量插件，它与 Spotlight 有点不同。如果您有 NetBeans，也许您不需要 Eclipse。我什至会说使用 TextMate（也是我选择的编辑器），您也不需要 NetBeans :)

我第二个 MacPorts，它比 fink 更新，更接近 FreeBSD 端口系统（我来自哪里）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-23T08:55:43.873

使用 Boot Camp 安装 Windows。然后，您可以在 OSX 和 Windows 之间进行双启动，正常使用 Windows 进行 MS 开发，使用 OSX 进行其他非 MS 的东西。

# visual-studio - 如何更改 Visual Studio 自动格式

> ID：388268
> 
> 赞同：36
> 
> 时间：2008-12-23T05:43:34.527
> 
> 标签：visual-studio, formatting

有什么方法可以更改 Visual Studio 自动格式化选项？与 VS 一样，默认情况下对 Javascript 使用右括号格式。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-23T05:45:39.733

工具 -> 选项 -> 文本编辑器 -> JavaScript

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-04-10T19:47:49.800

对于**Visual Studio 2013**：

```
Tools -> Options -> Text Editor -> JavaScript 
```

![在此处输入图像描述](https://i.stack.imgur.com/glTrQ.png)

您可以在此处更改 JavaScript 的格式选项。

对于函数的新行上的左大括号：

```
Tools -> Options -> Text Editor -> JavaScript -> Formatting -> New Lines 
```

# asp.net - 用于 ASP.Net 的免费 Ajax 框架 易于使用和编码

> ID：388293
> 
> 赞同：0
> 
> 时间：2008-12-23T06:16:52.163
> 
> 标签：asp.net, ajax

我想知道除了 AjaxPro 和 Microsoft Ajax Framework for ASP.Net 2.0 之外是否还有其他免费的 Ajax 框架。我正在寻找的功能是 Microsoft Ajax Framework 提供的易用性和 AjaxPro 提供的速度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T06:35:06.433

如果您所说的“Ajax 框架”是指“JavaScript 框架”，那么我将说明显而易见的情况并说[jQuery](http://jquery.com/)。他们最近也[收到了微软的祝福](http://www.microsoft.com/web/content.aspx?id=microsoft-adopts-open-source-jQuery-JavaScript-library)。

还有十几个其他免费的。我能想到的只有一个你必须付钱的。

# programming-languages - 是否有任何编程语言的函数末尾没有可变参数？

> ID：388295
> 
> 赞同：1
> 
> 时间：2008-12-23T06:19:18.587
> 
> 标签：programming-languages, function, arguments, variadic-functions

Python、C++、Scheme 和其他都允许您定义在参数列表末尾采用可变数量参数的函数......

```
def function(a, b, *args):
    #etc... 
```

...可以如下调用：

```
function(1, 2)
function(1, 2, 5, 6, 7, 8) 
```

等等......是否有任何语言允许您在其他地方使用参数列表执行可变参数函数？像这样的东西：

```
def function(int a, string... args, int theend) {...} 
```

所有这些都有效：

```
function(1, 2)
function(1, "a", 3)
function(1, "b", "c", 4) 
```

另外，参数列表中任何地方的可选参数呢？

```
def function(int a, int? b, int c, int... d) {}

function(1, 2) //a=1, c=2, b=undefined/null/something, d=[]
function(1,2,3) //a=1, b=2, c=3,d=[]
function(1,2,3,4,5) //a=1, b=2, c=3, d=[4,5] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T06:39:40.607

BASIC 已经有很多年了。

例如：

```
LOCATE [row%] [,[column%] [,[cursor%] [,start% [,stop%]]]] 
```

该命令设置游标的位置（行%、列%），以及指定游标大小（开始%、停止%）和是否实际可见（游标%）。在这里，方括号中的所有内容都可以省略，如果是，则该属性不会更改。

一个使用示例：

```
LOCATE , 5 
```

更改为第 5 列，或

```
LOCATE 1, , 0 
```

移动到第一行并使光标不可见。

另一个可以看到这种情况的命令是用于写入文件的 PUT 命令。如果中间参数（文件查找位置）被省略，则写入发生在前一次写入之后。

重要的是，参数省略只出现在内置语句中，而不是用户定义的过程和函数中。

在实现方面，这是 Microsoft Basic Compiler (BC) 似乎为调用 LOCATE 所做的：

1.  对于每个参数：
    *   如果省略参数，则按 0
    *   如果提供了参数，则按 1，然后按实际值
2.  推送参数计数
3.  调用库函数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T07:10:56.127

下一个 C++ 可以使用以下语法做到这一点：

```
void f(int a, std::initializer_list<int> b, int c) {
    // b.begin(), b.end(), b.size() allow to access them
}

void g() { 
    f(1, { 2, 3, 4, 5 }, 2);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T08:58:33.337

几种语言（perl，python，许多其他语言）可以做命名参数，这类似于在参数列表中的任何地方做可选参数......（命名参数可以以任何顺序出现，并且它们中的任何一个都可以成为可选的...... .) 它们并不完全相同，但它们很接近......

不确定可变参数，尽管它们通常可以替换为数组/哈希/列表对象...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T16:19:46.660

Ruby 的未来版本（1.9 及更高版本，Ruby 1.9 计划于 2009 年 1 月末发布）可以做到这一点。

然而，哪个值绑定到哪个参数并不总是很明显。

这是 Ruby 1.9 接受的：

0 个或多个强制参数，后跟 0 个或多个可选参数，后跟 0 个或多个强制参数，后跟其余参数，后跟 0 个或多个强制参数。

例子：

```
def meth mand1, opt1 = :def1, o2 = :d2, *args, m2, m3
  puts %w[mand1 opt1 o2 m2 args m3].inject('') { |s, arg|
    s << "#{arg} = #{(eval arg).inspect}, "
  }.gsub /, $/, ''
end

meth :arg1, :a2, :a3
# => mand1 = :arg1, opt1 = :def1, o2 = :d2, m2 = :a2, args = [], m3 = :a3
meth :arg1, :a2, :a3, :a4
# => mand1 = :arg1, opt1 = :a2, o2 = :d2, m2 = :a3, args = [], m3 = :a4
meth :arg1, :a2, :a3, :a4, :a5
# => mand1 = :arg1, opt1 = :a2, o2 = :a3, m2 = :a4, args = [], m3 = :a5
meth :arg1, :a2, :a3, :a4, :a5, :a6
# => mand1 = :arg1, opt1 = :a2, o2 = :a3, m2 = :a5, args = [:a4], m3 = :a6
meth :arg1, :a2, :a3, :a4, :a5, :a6, :a7
# => mand1 = :arg1, opt1 = :a2, o2 = :a3, m2 = :a6, args = [:a4, :a5], m3 = :a7 
```

如您所见，强制参数首先从左侧和右侧绑定。然后可选参数被绑定，如果有剩余的参数，它们被捆绑在一个数组中并绑定到其余参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T06:34:46.420

[Lisp 的关键字参数](http://www.psg.com/~dlamkins/sl/chapter21.html)可能就是你要找的。我认为在 Ruby 中也有类似的安排。另请参阅[Lisp 的函数参数概述](http://www.gigamonkeys.com/book/functions.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T06:35:50.660

我想PHP很重要。您可以这样做来模拟您正在寻找的内容。就个人而言，我认为这会令人困惑。

```
function foo() {
    $args = func_get_args(); // returns an array of args
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T22:26:54.943

R（统计语言）也有它，它可以在列表的中间，但有微妙的语义。

[http://cran.r-project.org/doc/manuals/R-intro.html#The-three-dots-argument](http://cran.r-project.org/doc/manuals/R-intro.html#The-three-dots-argument)

```
> f1 <- function(x,...,y) {  return(x+y) }
> f1(1,2)
Error in f1(1, 2) : argument "y" is missing, with no default
> f1(1,y=2)
[1] 3
> f1 <- function(x,...,y) {  return(x+y) }
> f1(1,2)
Error in f1(1, 2) : argument "y" is missing, with no default
> f1(1,y=2)
[1] 3
> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T17:04:59.617

它被称为 Rest Arguments，至少可以在 C++ 和 Java 中完成。谷歌“Rest Arguments”，你会发现很多关于这个主题的数据，比如一些例子，比如传递数字并返回输入数字的平均值，可能是传递的所有数字的最小值或最大值。如您所见，这些功能有很多用途，我在代码中使用它在 MYSQL 中输入数据，所以当我想添加一行时，我只需将表名称添加为第一个字符串，其余的都是列名称，然后是他们的数据，而不必坐在那里一遍又一遍地手动执行。祝你好运！

# iphone - iPhone 模拟器默认硬件版本

> ID：388298
> 
> 赞同：3
> 
> 时间：2008-12-23T06:21:17.710
> 
> 标签：iphone, ios-simulator

我最近一直在玩 iPhone SDK。起初我没有利用任何需要 SDK 2.2 版的东西。但是，我最近开始使用一些在 2.1 和 2.2 中添加或修改的功能。

我安装了新的 2.2 SDK 并将我的项目设置更改为目标 SDK 2.2。但是，当我在 Xcode 中点击“构建并运行”时，模拟器会启动并选择 2.0 版。我可以将其更改为 2.2 并且我的应用程序按预期工作，但是这样做会杀死必须重新附加的调试会话。

我是否在某处遗漏了会导致模拟器在选择 2.2 版的情况下启动的设置？

感谢您提供任何信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T07:08:18.583

也许我遗漏了一些东西，但你不能在概览选择菜单中选择“模拟器 - 2.2 | 调试”，然后选择“构建和调试”吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T00:44:02.880

按住 Control 键单击 Xcode 项目窗口工具栏并选择“Customize Toolbar...”。从那里，将“Active Build Configuration”和“Active SDK”拖到菜单中。为您的活动构建配置选择“调试”，为您的 SDK 选择“模拟器 - iPhone OS 2.2”，然后重试。

有时自动分组设置不能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T15:14:14.890

我遇到了同样的问题，上述答案都不适合我，除了我每次都手动设置它，很遗憾地将它从 Xcode 中分离出来。

# algorithm - 如何使用 MapReduce/Hadoop 实现特征值计算？

> ID：388302
> 
> 赞同：10
> 
> 时间：2008-12-23T06:29:45.260
> 
> 标签：algorithm, math, hadoop, mapreduce, eigenvalue

这是可能的，因为 PageRank 是特征值的一种形式，这就是引入 MapReduce 的原因。但在实际实现中似乎存在问题，比如每台从机都必须维护一份矩阵的副本？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-21T19:30:47.663

PageRank 通过迭代查找网络的稳态离散流条件来解决主导特征向量问题。

如果 NxM 矩阵 A 描述了从节点 n 到节点 m 的链接权重（流量），那么

```
p_{n+1} = A . p_{n} 
```

在 p 收敛到稳态的极限 (p_n+1 = p_n) 中，这是一个特征值为 1 的特征向量问题。

PageRank 算法不需要将矩阵保存在内存中，但在密集（非稀疏）矩阵上效率低下。对于密集矩阵，MapReduce 是错误的解决方案——您需要节点之间的局部性和广泛的交换——您应该转而查看 LaPACK 和 MPI 及其朋友。

您可以在 wukong[库](http://github.com/infochimps/wukong/tree/master/examples/pagerank)（用于 ruby​​ 的 hadoop 流）或[Heretrix pagerank 子模块](http://webteam.archive.org/confluence/display/Heritrix/Offline+PageRank+Analysis+Notes)中看到有效的 pagerank 实现。（heretrix 代码独立于 Heretrix 运行）

（免责声明：我是悟空的作者。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-24T00:02:06.883

**序言**：

给定正确的数据隔离，无需每台机器上的完整数据集就可以实现并行计算结果。

以下面的循环为例：

```
for (int i = 0; i < m[].length; i++)
{
    for (int j = 0; j < m[i].length; j++)
    {
        m[i][j]++; 
    }
} 
```

并给出以下布局的矩阵：

```
 j=0   j=1   j=2
 i=0  [   ] [   ] [   ]
 i=1  [   ] [   ] [   ]
 i=2  [   ] [   ] [   ] 
```

存在并行结构，以便可以将 J 列发送到每台计算机，并且并行计算单个列。当您有包含依赖项的循环时，并行化的困难部分就出现了。

```
for (int i = 0; i < m[].length; i++)
{
    for (int j = 0; j < m[i].length; j++)
    {
        //For obvious reasons, matrix index verification code removed
        m[i][j] = m[i/2][j] + m[i][j+7]; 
    }
} 
```

显然，像上面这样的循环变得非常有问题（注意矩阵索引器。）但是确实存在展开这些类型的循环和创建有效的并行算法的技术。

**答案**：

谷歌可能开发了一种解决方案来计算特征值，而无需在所有从属计算机上维护矩阵的副本。-或者- 他们使用[蒙特卡洛](http://en.wikipedia.org/wiki/Monte_Carlo_method)或其他一些[近似算法](http://en.wikipedia.org/wiki/Approximation_algorithm)来开发“足够接近”的计算。

事实上，我什至可以说，Google 将尽最大努力使他们的 PageRank 算法所需的任何计算尽可能高效。当您运行诸如此类的机器时[（](http://nomano.shiwaza.com/tnoma/blog/archives/20060218/m/dsc_4485.jpg)请[注意](http://nomano.shiwaza.com/tnoma/blog/archives/20060218/m/dsc_4483.jpg)以太网电缆），您不能传输大型数据集（100 个演出），因为考虑到商品 NIC 卡的硬件限制，这是不可能的。

话虽如此，谷歌擅长让程序员社区感到惊讶，他们的实现可能完全不同。

**邮差**：

一些用于并行计算的好资源包括[OpenMP](http://openmp.org/wp/)和[MPI](http://www.lam-mpi.org/)。两种并行实现都从非常不同的范式处理并行计算，其中一些源于机器实现（集群与分布式计算）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-24T00:47:47.040

我怀疑除了具有特殊结构的矩阵（例如稀疏矩阵或具有某些块模式的矩阵）之外，大多数矩阵都难以处理。矩阵系数和特征值之间的耦合太多了。

PageRank 使用特殊形式的非常[稀疏的矩阵](http://www.mathworks.com/company/newsletters/news_notes/clevescorner/oct02_cleve.html)，计算其特征值的任何结论几乎肯定不会扩展到一般矩阵。（编辑：这是[另一个](http://books.google.com/books?id=hxvB14-I0twC)看起来很有趣的参考）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-01T14:28:21.557

我现在可以回答自己了。PageRank 算法利用稀疏矩阵，它应该在特征值处收敛，并有几个自乘。因此，在 PageRank 实践中，Map/Reduce 过程是有效的。您可以在 Map 过程中执行矩阵乘法，并在 Reduce 过程中形成稀疏矩阵。但是对于一般的矩阵特征值查找，这仍然是一个棘手的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-08T23:53:46.343

apache [hama](http://incubator.apache.org/hama/)项目有一些有趣的 Jacobi 特征值算法实现。它在hadoop上运行。请注意，旋转发生在矩阵的扫描中，而不是在 map reduce 中。

# oop - 复制构造函数有什么问题？为什么要使用 Cloneable 接口？

> ID：388304
> 
> 赞同：14
> 
> 时间：2008-12-23T06:30:59.687
> 
> 标签：oop, class-design

在 C++ 编程时，我们曾经在需要时创建复制构造函数（或者我们被教导过）。几年前切换到 Java 时，我注意到现在正在使用 Cloneable 接口。C# 遵循定义 ICloneable 接口的相同路线。在我看来，克隆是 OOP 定义的一部分。但我想知道，为什么要创建这些接口，而复制构造函数似乎已被删除？

当我想到它时，我想到如果需要复制类型未知的对象（如引用基类型），复制构造函数将没有用。这似乎合乎逻辑。但我想知道是否还有其他我不知道的原因，Cloneable 接口比复制构造函数更受青睐？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-23T06:49:53.737

我认为这是因为在 Java 和 C# 中对于引用类型没有这种固有的复制构造函数需求。在 C++ 中，对象被命名。您可以（并且您通常会）复制（并且在 C++1x 中移动）它们，例如从函数返回时，因为返回指针需要您分配动态内存，这将是缓慢且难以管理的。语法是 T(x) 所以让构造函数接受 T 引用是有意义的。C++ 无法创建克隆函数，因为这需要再次按值返回对象（因此需要另一个副本）。

但是在 Java 中，对象是未命名的。只有对它们的引用，可以复制，但不能复制对象本身。对于您实际需要复制它们的情况，您可以使用 clone 调用（但我在其他答案中读到 clone 是有缺陷的。我不是 java 程序员，所以我不能对此发表评论）。由于返回的不是对象本身，而是对它的引用，因此克隆函数就足够了。还可以覆盖克隆功能。这不适用于复制构造函数。顺便说一句，在 C++ 中，当您需要复制多态对象时，`clone`也需要一个函数。它有一个名字，即所谓的*虚拟拷贝构造函数*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T06:42:53.343

因为 C++ 和 Java（和 C#）不是一回事。C++ 没有内置接口，因为接口不是语言的一部分。您可以使用抽象类来伪造它们，但它们不是您对 C++ 的看法。此外，在 C++ 中，赋值通常很深。

在 Java 和 C# 中，赋值只涉及将句柄复制到内部对象。基本上当你看到：

```
SomeClass x = new SomeClass(); 
```

在 Java 或 C# 中，有一个 C++ 中不存在的内置间接级别。在 C++ 中，您编写：

```
SomeClass* x = new SomeClass(); 
```

C++ 中的赋值涉及取消引用的值：

```
*x = *another_x; 
```

在 Java 中，您可以访问“真实”对象，因为没有像 *x 这样的取消引用运算符。所以要做一个深拷贝，你需要一个函数：clone()。Java 和 C# 都将该函数封装到一个接口中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-23T06:40:59.247

复制构造函数没有解决最终类型和通过超类级联克隆操作的问题 - 它们不可扩展。但是 Java 克隆机制也被广泛认为是严重损坏的；尤其是子类没有实现 clone()，而是从实现可克隆的超类继承的问题。

我强烈建议您仔细研究克隆，无论您选择什么路径 - 您可能会选择 clone() 选项，但请确保您确切知道如何正确执行。它很像 equals() 和 hashCode() - 表面上看起来很简单，但它必须完全正确地完成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-19T11:09:16.907

我认为你没有得到正确的观点。我给你我的两分钱。

根本上存在一个问题：在不知道确切的类类型的情况下创建一个类的克隆。如果您使用复制构造函数，则不能。

这是一个例子：

```
class A {
public A(A c) { aMember = c.aMember }
    int aMember;
}

class B : A {
public B(B c) : base(c) { bMember = c.bMember }
    int bMember;
}

class GenericContainer {
public GenericContainer(GenericContainer c) {
    // XXX Wrong code: if aBaseClass is an instance of B, the cloned member won't 
    // be a B instance!
    aBaseClass = new A(c.aBaseClass);
}
    A aBaseClass;
} 
```

如果声明为 virtual，则 Clone 方法可以创建泛型成员的正确类实例。

这个问题在每种语言中都很常见，C# C++ 或 Java...

也许这就是你的意思，但我无法从任何答案中理解这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-02T17:40:03.230

只是想补充一点，在 Java 中，复制构造函数并非完全没用。

在某些情况下，您的类有**一个可变非最终类型的私有实例变量**，例如`Date`，并且有一个用于该变量的 setter 和 getter。在 setter 中，您应该复制给定日期，因为调用者可以稍后修改它，从而操纵对象的内部状态（通常是偶然的，但也可能是故意的）。在吸气剂中，需要同样的预防措施。

防御性副本可以通过调用来实现`clone()`（该类`Date`是可克隆的），但是恶意调用者可以使用其子类调用 setter，该子类使用`Date`覆盖该`clone()`方法`{return this;}`，因此调用者可能仍然能够操纵您的对象。这就是复制构造函数发挥作用的地方：通过调用`new Date(theDate)`，您一定会得到一个`Date`与给定日期具有相同时间戳的新实例，而这两个日期实例之间没有任何联系。在 getter 中，您可以使用 clone 方法，因为您知道私有变量将属于 class `Date`，但为了保持一致性，通常也使用复制构造函数。

另请注意，如果`Date`类是最终的（调用`clone()`是安全的）或不可变的（不需要复制），则需要复制构造函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-11T04:14:52.660

我认为这只是因为一旦你定义了一个复制构造函数，你就再也不能传递引用本身了。（除非它有一个函数可以做到这一点……但这并不比使用 clone() 方法更容易。）在 C++ 中这不是问题：您可以传递整个对象或其引用。

# asp.net - 回发前的 ASP.NET TreeView javascript

> ID：388312
> 
> 赞同：4
> 
> 时间：2008-12-23T06:36:30.363
> 
> 标签：asp.net, javascript, ajax, treeview, updatepanel

我正在尝试使用 TreeViews 和 UpdatePanels 编写我认为是相当常规的 AJAX 模式。我的情况是这样的：

我在 UpdatePanel 中有一个 TreeView。我在另一个更新面板中有一个文字。当用户点击 TreeView 中的一个节点时，Literal 的内容就会更新。现在，由于整个事情是异步的，所以在点击和更新 Literal 内容之间当然存在时间延迟。在此期间，我想做两件事：

1) 显示一个 UpdateProgress，并且

2）清除Literal的内容

这样用户就不必在异步加载新文本时盯着旧内容。

我似乎无法找到一种简单的方法来完成（2）。我一直在阅读客户端回调并使用 GetCallbackEventReference，但对于看似简单的问题，这似乎是一种非常复杂的方法。

理想情况下，我想让 TreeView 独自完成它的工作。我不想自己获取内容并使用 JS 将它们添加到 TreeView。我只想在客户端检测节点更改事件，清除文字，然后让 TreeView 正常运行。

这可能吗？还是客户回电是我唯一的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T08:06:03.397

您会想要使用`PageRequestManager`来自 ASP.NET AJAX 库的。这是 PRM 的 MSDN 参考 - [http://msdn.microsoft.com/en-us/library/bb311028.aspx](http://msdn.microsoft.com/en-us/library/bb311028.aspx)。

请注意，Microsoft 已声明 TreeView 在 UpdatePanel 中可能存在问题，您还需要**非常小心性能**，特别是如果您有一个大 TreeView（请参阅我关于优化 UpdatePanel 性能的文章 - [http：/ /www.aaron-powell.com/blog.aspx?id=1195](http://www.aaron-powell.com/blog.aspx?id=1195)）。你真的应该看看类似 jQuery 插件的东西（例如：[http](http://bassistance.de/jquery-plugins/jquery-plugin-treeview/) ://bassistance.de/jquery-plugins/jquery-plugin-treeview/ ）。

但要真正回答你的问题，你需要：

*   有一个`BeginRequest`事件处理程序，它将清除你的文字，甚至可以显示加载（我不是 UpdateProgress 的粉丝，我更喜欢我自己做的更精细的控制）
*   使用`EndRequest`事件确保 Loading 组件消失

您还可以将 TreeView`AsyncPostbackTrigger`设为页面上第二个 UpdatePanel 的一个，或者在 TreeView 的异步回发期间仅调用其上的 Update 方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-25T08:45:27.820

我遇到了同样的问题，并通过创建一个与我要隐藏的区域重叠的隐藏 html 元素来修复它。我在回发期间显示它 onSubmit 并将其隐藏在 window.onload 中。它不漂亮，但它可以工作并且应该很快。

# language-agnostic - 什么是 Map/Reduce？

> ID：388321
> 
> 赞同：85
> 
> 时间：2008-12-23T06:48:07.157
> 
> 标签：language-agnostic, mapreduce

我听到了很多关于 map/reduce 的信息，尤其是在 Google 大规模并行计算系统的背景下。它到底是什么？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-12-23T07:00:18.457

来自谷歌[MapReduce](http://research.google.com/archive/mapreduce.html)研究发布页面的摘要：

> MapReduce 是一种用于处理和生成大型数据集的编程模型和相关实现。用户指定一个处理键/值对以生成一组中间键/值对的 map 函数，以及一个合并与同一中间键关联的所有中间值的 reduce 函数。

MapReduce 的优点是可以在多个处理节点（多个服务器）上并行执行处理，因此它是一个可以很好扩展的系统。

由于它基于[函数式编程](http://en.wikipedia.org/wiki/Functional_programming)模型，`map`并且`reduce`每个步骤都没有任何副作用（`map`流程的每个子部分的状态和结果不依赖于另一个），因此被映射和缩减的数据集可以各自分离在多个处理节点上。

Joel[你的编程语言能做到这一点吗？](http://www.joelonsoftware.com/items/2006/08/01.html)文章讨论了谷歌如何理解函数式编程以提出为其搜索引擎提供支持的 MapReduce。如果您不熟悉函数式编程以及它如何允许可扩展代码，那么这是一本非常好的读物。

另请参阅：[维基百科：MapReduce](http://en.wikipedia.org/wiki/MapReduce)

相关问题：[请简单解释一下mapreduce](https://stackoverflow.com/questions/28982/please-explain-mapreduce-simply)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-23T10:07:41.090

Map 是一个函数，它将另一个函数应用于列表中的所有项目，以生成另一个列表，其中包含所有返回值。（“将 f 应用于 x”的另一种说法是“调用 f，将其传递给 x”。所以有时说“应用”而不是“调用”听起来更好。）

这就是 map 可能是用 C# 编写的（它被称为`Select`并且在标准库中）：

```
public static IEnumerable<R> Select<T, R>(this IEnumerable<T> list, Func<T, R> func)
{
    foreach (T item in list)
        yield return func(item);
} 
```

由于您是 Java 哥们儿，而 Joel Spolsky 喜欢向 GROSSLY UNFAIR LIES 讲述 Java 是多么糟糕（实际上，他并没有撒谎，它很糟糕，但我试图赢得您的支持），这是我非常粗略的尝试一个 Java 版本（我没有 Java 编译器，我隐约记得 Java 版本 1.1！）：

```
// represents a function that takes one arg and returns a result
public interface IFunctor
{
    object invoke(object arg);
}

public static object[] map(object[] list, IFunctor func)
{
    object[] returnValues = new object[list.length];

    for (int n = 0; n < list.length; n++)
        returnValues[n] = func.invoke(list[n]);

    return returnValues;
} 
```

我相信这可以通过一百万种方式得到改善。但这是基本的想法。

Reduce 是一个将列表中的所有项目转换为单个值的函数。为此，需要为其提供另一个`func`将两个项目转换为单个值的函数。将前两项交给`func`. 然后是第三项的结果。然后是第四个项目的结果，依此类推，直到所有项目都消失了，我们只剩下一个值。

在 C# 中，reduce 被调用`Aggregate`并再次出现在标准库中。我将直接跳到 Java 版本：

```
// represents a function that takes two args and returns a result
public interface IBinaryFunctor
{
    object invoke(object arg1, object arg2);
}

public static object reduce(object[] list, IBinaryFunctor func)
{
    if (list.length == 0)
        return null; // or throw something?

    if (list.length == 1)
        return list[0]; // just return the only item

    object returnValue = func.invoke(list[0], list[1]);

    for (int n = 1; n < list.length; n++)
        returnValue = func.invoke(returnValue, list[n]);

    return returnValue;
} 
```

这些 Java 版本需要添加泛型，但我不知道如何在 Java 中做到这一点。但是您应该能够将匿名内部类传递给它们以提供函子：

```
string[] names = getLotsOfNames();

string commaSeparatedNames = (string)reduce(names, 
   new IBinaryFunctor {
       public object invoke(object arg1, object arg2)
           { return ((string)arg1) + ", " + ((string)arg2); }
   } 
```

希望泛型能够摆脱演员表。C# 中的类型安全等效项是：

```
string commaSeparatedNames = names.Aggregate((a, b) => a + ", " + b); 
```

为什么这很“酷”？将较大的计算分解为较小的部分的简单方法，以便它们可以以不同的方式重新组合在一起，总是很酷。Google 应用这个想法的方式是并行化，因为 map 和 reduce 都可以在多台计算机上共享。

但关键要求不是您的语言可以将函数视为值。任何 OO 语言都可以做到这一点。并行化的实际要求是`func`您传递给 map 和 reduce 的小函数不得使用或更新任何状态。它们必须返回一个仅依赖于传递给它们的参数的值。否则，当您尝试并行运行整个事情时，结果将完全搞砸。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-16T17:24:32.327

在对非常长的华夫饼或非常短的模糊博客文章感到最沮丧之后，我最终发现了这篇[非常好的严谨简洁的论文](http://theory.stanford.edu/~sergei/papers/soda10-mrc.pdf)。

然后我继续通过翻译成 Scala 使其更简洁，在这里我提供了最简单的情况，用户只需指定应用程序的`map`和`reduce`部分。在 Hadoop/Spark 中，严格来说，采用了更复杂的编程模型，需要用户明确指定此处概述的另外 4 个函数：[http ://en.wikipedia.org/wiki/MapReduce#Dataflow](http://en.wikipedia.org/wiki/MapReduce#Dataflow)

```
import scalaz.syntax.id._

trait MapReduceModel {
  type MultiSet[T] = Iterable[T]

  // `map` must be a pure function
  def mapPhase[K1, K2, V1, V2](map: ((K1, V1)) => MultiSet[(K2, V2)])
                              (data: MultiSet[(K1, V1)]): MultiSet[(K2, V2)] = 
    data.flatMap(map)

  def shufflePhase[K2, V2](mappedData: MultiSet[(K2, V2)]): Map[K2, MultiSet[V2]] =
    mappedData.groupBy(_._1).mapValues(_.map(_._2))

  // `reduce` must be a monoid
  def reducePhase[K2, V2, V3](reduce: ((K2, MultiSet[V2])) => MultiSet[(K2, V3)])
                             (shuffledData: Map[K2, MultiSet[V2]]): MultiSet[V3] =
    shuffledData.flatMap(reduce).map(_._2)

  def mapReduce[K1, K2, V1, V2, V3](data: MultiSet[(K1, V1)])
                                   (map: ((K1, V1)) => MultiSet[(K2, V2)])
                                   (reduce: ((K2, MultiSet[V2])) => MultiSet[(K2, V3)]): MultiSet[V3] =
    mapPhase(map)(data) |> shufflePhase |> reducePhase(reduce)
}

// Kinda how MapReduce works in Hadoop and Spark except `.par` would ensure 1 element gets a process/thread on a cluster
// Furthermore, the splitting here won't enforce any kind of balance and is quite unnecessary anyway as one would expect
// it to already be splitted on HDFS - i.e. the filename would constitute K1
// The shuffle phase will also be parallelized, and use the same partition as the map phase.  
abstract class ParMapReduce(mapParNum: Int, reduceParNum: Int) extends MapReduceModel {
  def split[T](splitNum: Int)(data: MultiSet[T]): Set[MultiSet[T]]

  override def mapPhase[K1, K2, V1, V2](map: ((K1, V1)) => MultiSet[(K2, V2)])
                                       (data: MultiSet[(K1, V1)]): MultiSet[(K2, V2)] = {
    val groupedByKey = data.groupBy(_._1).map(_._2)
    groupedByKey.flatMap(split(mapParNum / groupedByKey.size + 1))
    .par.flatMap(_.map(map)).flatten.toList
  }

  override def reducePhase[K2, V2, V3](reduce: ((K2, MultiSet[V2])) => MultiSet[(K2, V3)])
                             (shuffledData: Map[K2, MultiSet[V2]]): MultiSet[V3] =
    shuffledData.map(g => split(reduceParNum / shuffledData.size + 1)(g._2).map((g._1, _)))
    .par.flatMap(_.map(reduce))
    .flatten.map(_._2).toList
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-08T02:05:38.033

Map 是可以应用于数组的原生 JS 方法。由于某些函数映射到原始数组中的每个元素，它会创建一个新数组。因此，如果您映射了一个函数（元素）{ return element * 2;}，它将返回一个新数组，其中每个元素都加倍。原始数组不会被修改。

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map)

Reduce 是一种原生 JS 方法，也可以应用于数组。它将函数应用于数组并具有称为累加器的初始输出值。它遍历数组中的每个元素，应用一个函数，并将它们减少为一个值（从累加器开始）。它很有用，因为你可以有任何你想要的输出，你只需要从那种类型的累加器开始。因此，如果我想将某些东西简化为对象，我将从累加器 {} 开始。

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce?v=a](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce?v=a)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-10-23T08:08:19.310

在大数据的情况下：

```
1.MapReduce is a Hadoop framework used for writing applications
2.MapReduce provides analytical capabilities for analyzing huge volumes of 
   complex data
3.facilitates concurrent processing by splitting petabytes of data into smaller 
   chunks, and processing them in parallel on Hadoop commodity servers
4.used for querying and selecting data in the Hadoop Distributed File System
5.MapReduce programming enables companies to access new sources of data 
```

# javascript - javascript无法调用数组中的元素

> ID：388328
> 
> 赞同：0
> 
> 时间：2008-12-23T06:59:27.603
> 
> 标签：javascript, arrays

好的，让我解释一下……目标是如果选择有变化，则选中复选框。实际代码是：

```
function checkit(date)
{
  document.forms[0].date.checked = true;
}

<input type="checkbox" name="date[]" value="2008-08-14">Aug 14, 2008<br> 
 <select name="slot[]" size="1" onchange="checkit(date[]);"/>
 <option value="2008-08-15;0900;1700">9am to 5pm</option>       
 <option value="2008-08-15;1330;1730">1:30pm to 5:30pm</option>
 </select>

  <input type="checkbox" name="date[]" value="2008-08-15">Aug 14, 2008<br> 
 <select name="slot[]" size="1" onchange="checkit(date[]);"/>
 <option value="2008-08-15;0900;1700">9am to 5pm</option>       
 <option value="2008-08-15;1330;1730">1:30pm to 5:30pm</option>
 </select>

<input type="checkbox" name="date[]" value="2008-08-16">Aug 14, 2008<br> 
 <select name="slot[]" size="1" onchange="checkit(date[]);"/>
 <option value="2008-08-15;0900;1700">9am to 5pm</option>       
 <option value="2008-08-15;1330;1730">1:30pm to 5:30pm</option>
 </select> 
```

在 PHP 中，如果它看到带有 [ ] 的变量，它会自动创建一个数组。在 Javascript 中，我希望 Javascript 能够识别 [] 并根据当前元素执行。例如，如果我在第二个复选框中选择了一个值，它应该触发一个事件来检查该元素框。我不想将变量命名为 date1、date2、date3、date4 ... 我希望这能澄清更多。我知道我遗漏了一些东西......我尝试使用“this”关键字将其设为“当前元素”，但它似乎不起作用，但可能是我使用了不正确的语法。

我所期望的是 onchange 事件，它应该触发它的参数“date[]”，但我认为 Javascript 应该知道它将使用 date[] 中的哪个元素，而不是显式调用它 date[1] 等等。checkit 函数获取“date[]”名称并检查该 date[] 复选框。

顺便说一句，非常感谢您的补充答案（我学到了一些新东西！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T08:12:53.710

它不起作用，因为（正如[dreas](https://stackoverflow.com/users/44084/) [所说](https://stackoverflow.com/questions/388328/#388339)）您的 HTML 代码有错误，并且您以与 javascript 语法冲突的方式命名变量。

您输入的名称是**date[1]**并且**[**和**]**在 javascript 代码中具有特殊含义。

在这段代码中：

```
document.forms[0].date.checked = true; 
```

您正在尝试访问文档的第一个表单 (document.forms[0])，然后尝试访问名为**date**的字段，但没有任何字段。根据您的 HTML 标记，您有名为“date[1]”、“date[2]”和“date[3]”的字段。

但是您**不能**像这样访问它们：

```
document.forms[0].date[1].checked = true; 
```

为什么？因为**date[1]**尝试用**1索引****日期**，在这种情况下，您的**日期**不是数组。

 ****如果将其括在引号中，则**可以访问它：**

```
document.forms[0]["date[1]"].checked = true; 
```

请注意，现在 "date[1]" 用作字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T07:08:54.400

你到底想用这段代码做什么？

根据您的一段代码（其中有一些语法错误），您正在检查一个复选框，然后调用一个将再次检查该复选框的 js 函数......？

你到底想达到什么目的？

试试这个代码：

```
function checkit(date)
   {
    var date = document.getElementById(date);
    date.checked = true;
   }
<input type="checkbox" id="date[1]" value="2008-08-14" onchange="checkit('date[1]')");/>Aug 14, 2008<br /> 
<input type="checkbox" id="date[2]" value="2008-08-14" onchange="checkit('date[2]')");/>Aug 14, 2008<br /> 
<input type="checkbox" id="date[3]" value="2008-08-14" onchange="checkit('date[3]')");/>Aug 14, 2008<br /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T22:42:01.787

PHP 具有`arr[] = something`将某些内容放在数组中下一个可用索引处的语法。

Javascript 没有那种语法；如果您想在数组中的下一个可用索引处放置一些东西，请`arr.push(something)`改用。

但是您所指的示例部分是 HTML，而不是 Javascript。Javascript 可以访问它，但表单字段本身是用 HTML 创建的……所以你必须给它自己的名字，而不是一个自动递增的名字。

如果您通过 DOM 调用动态创建 HTML（例如，为每个输入元素`document.createElement('input')`分配属性，然后分配给`appendChild()`主表单），那么您可以自动命名表单字段......但这是生成 HTML 的另一种方法一堆需要注意的陷阱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T22:58:32.657

首先，您想在 Javascript 中使用特定于 PHP 的功能。不，据我所知，没有这样的功能。

其次，我强烈建议不要使用诸如“date[1]”之类的 HTML 输入名称......这*可能*是合法的 HTML（我必须在一些浏览器中尝试它以确保它被有效地允许），但它几乎 100% 可能是维护周期中的错误来源。

我假设此代码是为您自动生成的，或者您只是想在编辑器中复制/粘贴。如果是前者，我会在自动生成代码中将元素命名为“date_1”并完成它。如果是后者，那么您可以在代码中维护数字（即，手动输入 date_1 到 date_257）或使用 Javascript document.write 调用来轻松生成 HTML。如果真的没有其他方法，我只会做后者（document.write out HTML）。如果您谈论的是 10-25 份副本，那么手动处理它比使用 document.write 不太可能出现问题；如果你有超过 25 个这样的实例，那么自动化元素生成*可能*是有意义的。

# configuration - 如何确定在 Nant 中调用我当前目标的目标是什么？

> ID：388344
> 
> 赞同：1
> 
> 时间：2008-12-23T07:11:22.570
> 
> 标签：configuration, nant, build-script

我正在修改一个 Nant 构建脚本来运行一些单元测试。对于本地运行的测试和要在团队城市上运行的测试，我有不同的目标。

```
<target name="run-unit-tests">  
   <property name="test.executable" value="tools\nunit\nunit-console.exe"/>
   <call target="do-unit-tests"/>
</target>

<target name="run-unit-tests-teamcity"> 
   <property name="test.executable" value="${teamcity.dotnet.nunitlauncher}"/>      
   <call target="do-unit-tests"/>
</target> 
```

在目标**do-unit-tests 中**，我通过设置属性并调用 NCover 执行代码覆盖运行来设置运行哪些测试程序集，如下所示：

```
<target name="do-unit-test">
   <property name="test.assemblies" value="MyProject.dll">
   <call target="do-unit-test-coverage" />
</target>

<target name="do-unit-test-coverage">
   <ncover <!--snip -->
           commandLineArgs="${test.args}"
   <!--snip-->
   </ncover>
</target> 
```

正如您在 ncover 部分中看到的那样，我需要一个名为*"test.args"*的属性。此属性取决于*“test.assemblies”*

IE：`<property name="test.args" value="${test.assemblies} <!--snip -->" />`

test.args 需要*在本地运行的单元测试和团队城市的单元测试之间进行不同的设置*......所以我试图弄清楚如何设置它。

如果我将 test.args 的属性放在属性“test.assemblies”之后的“do-unit-test”中，如果 run-unit-tests 和另一个调用 do-unit-test，则我无法指定一个 test.args用于运行单元测试团队城市。

我一直在尝试在“do-unit-test”中执行以下操作：

```
<if test="${target::exists('run-unit-tests-teamcity')}">
 <property name="test.args" value="..." />
</if> 
```

但显然这不起作用，因为目标将永远存在。

然后我想要测试我当前的目标**do-unit-test**是否已被**run-unit-tests-teamcity 调用**

这可能吗？我在 Nant 文档中看不到它？由于它不存在，它要么意味着它将成为未来的一个功能，要么我不理解在 Nant 构建脚本中是如何指定事物的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T08:46:02.393

您可以在一个目标中定义属性，并在另一个目标中使用它们的值...例如，您可以定义

```
<target name="run-unit-tests">
   <property name="test.executable" value="tools\nunit\nunit-console.exe"/>
   <property name="test.extratestargs" value="foo,bar,baz"/>
   <call target="do-unit-tests"/>
</target>

<target name="run-unit-tests-teamcity">
   <property name="test.executable" value="${teamcity.dotnet.nunitlauncher}"/>         
   <property name="test.extrtestargs" value="foo,baz,quux,xyzzy"/>
   <call target="do-unit-tests"/>
</target>

<target name="do-unit-test-coverage">
   <property name="test.args" value="${test.assemblies} ${test.extratestargs} <!--snip -->" />
   <ncover <!--snip -->
           commandLineArgs="${test.args}" >
   <!--snip-->
   </ncover>
</target> 
```

或者，如果您需要它们的结构完全不同，而不仅仅是具有一些不同的值，请利用属性替换被延迟的事实：

```
 <?xml version="1.0"?>

<project name="nanttest">

        <target name="run-unit-tests">
           <property name="test.executable" value="tools\nunit\nunit-console.exe"/>
           <property name="test.args" value="foo bar -assembly ${test.assemblies} baz" dynamic="true"/>
           <call target="do-unit-test"/>
        </target>

        <target name="run-unit-tests-teamcity">
           <property name="test.executable" value="${teamcity.dotnet.nunitlauncher}"/>
           <property name="test.args" value="foo,baz,quux /a:${test.assemblies} xyzzy" dynamic="true"/>
           <call target="do-unit-test"/>
        </target>

        <target name="do-unit-test-coverage">
           <echo message="test.executable = ${test.executable}, test.args = ${test.args}" />
        </target>

        <target name="do-unit-test">
           <property name="test.assemblies" value="MyProject.dll"/>
           <call target="do-unit-test-coverage" />
        </target>

</project> 
```

```
user@host:/tmp/anttest$ nant run-unit-tests
[……剪断……]
运行单元测试：
做单元测试：
做单元测试覆盖：
     [echo] test.executable = tools\nunit\nunit-console.exe, test.args = foo bar -assembly MyProject.dll baz
构建成功
总时间：0秒。

user@host:/tmp/anttest$ nant -D:teamcity.dotnet.nunitlauncher=nunitlauncher run-unit-tests-teamcity
[……剪断……]
运行单元测试团队城市：
做单元测试：
做单元测试覆盖：
     [回声] test.executable = nunitlauncher, test.args = foo,baz,quux /a:MyProject.dll xyzzy
构建成功
总时间：0秒。

```

如果您真的，真的只需要知道您是否在 TeamCity 中运行，那么这应该会有所帮助：

```
<target name="run-unit-tests-teamcity">
   <property name="test.executable" value="${teamcity.dotnet.nunitlauncher}"/>         
   <property name="running.in.teamcity" value="true"/>
   <call target="do-unit-tests"/>
</target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T00:24:45.900

我已经设法解决了这个问题。我不知道这是否是最好的解决方案，但它是**一个**解决方案。

我设置了一个名为**test.type**的属性，然后使用 if 语句来确定它来自哪个目标。

```
<target name="run-unit-tests">  
   <property name="test.executable" value="tools\nunit\nunit-console.exe"/>
   <property name="test.type" value="unit-tests" />
   <call target="do-unit-tests"/>
</target>

<target name="run-unit-tests-teamcity"> 
   <property name="test.executable" value="${teamcity.dotnet.nunitlauncher}"/>          
   <property name="test.type" value="unit-tests-teamcity" />
   <call target="do-unit-tests"/>
</target>

<target name="do-unit-test">
   <property name="test.assemblies" value="MyProject.dll">
   <call target="do-unit-test-coverage" />
</target>

<target name="do-unit-test-coverage">

   <if test="${test.type=='unit-tests'}">
      <property name="test.args" value="${test.assemblies} ..."/>
   </if>

   <if test="${test.type=='unit-tests-teamcity'}">
      <property name="test.args" value="... ${test.assemblies}"/>
   </if>

   <ncover <!--snip -->
           commandLineArgs="${test.args}"
   <!--snip-->
   </ncover>
</target> 
```

# validation - 验证假名输入

> ID：388353
> 
> 赞同：5
> 
> 时间：2008-12-23T07:23:29.877
> 
> 标签：validation, language-agnostic, unicode, cjk

我正在开发一个允许用户输入日语字符的应用程序。我试图想出一种方法来确定用户的输入是否是日语假名（平假名、片假名或汉字）。

应用程序中的某些字段不适合输入拉丁文本，我需要一种方法将某些字段限制为仅限汉字或仅限片假名等。

该项目使用 UTF-8 编码。我不希望接受 JIS 或 Shift-JIS 输入。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T07:39:16.477

不确定一个完美的答案，但维基百科上列出了[片假名](http://en.wikipedia.org/wiki/Katakana)和[平假名的 Unicode 范围。](http://en.wikipedia.org/wiki/Hiragana)（我希望也可以从[unicode.org](http://unicode.org/)获得。）

*   平假名：Unicode：3040-309F
*   片假名：Unicode：30A0–30FF

根据输入检查这些范围应该以与语言无关的方式验证 Unicode 的平假名或片假名。

对于汉字，我希望它会稍微复杂一点，因为我希望中文和日文中使用的汉字都包含在同一个范围内，但话又说回来，我可能在这里错了。（我不能指望简体中文和繁体中文被包含在同一个范围内......）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-23T07:40:42.777

听起来您基本上只需要检查每个 Unicode 字符是否在特定范围内。[Unicode 代码图表](http://www.unicode.org/charts/)应该是一个很好的起点。

如果您使用的是 .NET，我的[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)库有一些 Unicode 范围支持——它是原始的，但它应该可以完成这项工作。我现在手头没有资源，但如果有帮助的话，稍后会用一个例子更新这篇文章。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T06:49:58.063

哦哦！我曾经有过这个......我有一个带有平假名的正则表达式，然后是片假名，然后是汉字。具体代码我忘记了，我去看看。

正则表达式很棒，因为您将问题加倍。我是用 PHP 做的，我选择了更强大的自动问题生成

- 编辑 -

```
$pattern = '/[^\wぁ-ゔァ-ヺー\x{4E00}-\x{9FAF}_\-]+/u'; 
```

我在[这里](http://forums.devshed.com/regex-programming-147/japanese-regex-php-getting-kanji-characters-586534.html)找到了这个，但它不是很好......我会继续寻找

--edit-- 我查看了我的便携式硬盘驱动器......我以为我保留了上一家公司的那个特定片段......对不起。

# .net - 温莎城堡有什么缺点吗？

> ID：388355
> 
> 赞同：35
> 
> 时间：2008-12-23T07:26:08.063
> 
> 标签：.net, asp.net, dependency-injection, inversion-of-control, castle-windsor

我一直在研究城堡项目，特别是温莎。我对这项技术的可能性印象深刻，拥有如此松散耦合的系统的好处是显而易见的。我唯一不确定的是使用这种方法是否有任何缺点，特别是在 asp.net 中？例如性能命中等。

我正试图让我的开发人员在这里看到这种方法的好处，并受到以下复出的打击：

1.  那是使用反射，每次从容器调用对象时，都必须使用反射，因此性能会很糟糕。（是这样吗？它是否在每次调用时都使用反射？）

2.  如果我依赖接口；如何处理具有附加到类上的额外方法和属性的对象？（通过继承）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-29T10:33:38.430

要回答您的问题：

> 1.  那是使用反射，每次从容器调用对象时，都必须使用反射，因此性能会很糟糕。（是这样吗？它是否在每次调用时都使用反射？）

*   不，不是的。大多数情况下，当您注册组件时，它很少使用反射。当你第一次从容器请求组件时，它也可能在生成代理类型时使用反射。

> 2.  如果我依赖接口；如何处理具有附加到类上的额外方法和属性的对象？（通过继承）

*   这都是设计问题。您不想让容器创建每个对象。您主要将其用于服务依赖项。在这种情况下，您并不关心实际上隐藏在接口后面的是什么类型（这就是它的全部意义，不是吗？）。

您也可以拥有类组件，但它们有限制，您必须了解这些限制（例如，您不能拦截对非虚拟方法的调用）。我发现 Windsor 是最成熟的，最适合我的开发容器风格。

除此之外，Performance，我还没有听说过因为不可接受的性能而不得不丢弃依赖容器的项目。Windsor 真的很聪明，它缓存了冗长操作的结果，这样你就不必付出两次代价。您可以在 Internet 上找到图表，比较许多 IoC 容器的速度。关于这些需要注意两点：所有容器都非常快。不要认为其他容器在这些图表上比 Windsor 更快的事实意味着它们更好。Windsor 为您做了很多其他容器没有的事情。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-23T15:45:35.217

我在几个高负载下的生产应用程序中使用了 IoC 容器（Spring.NET 和 StructureMap）（不是 Facebook/MySpace 高，但足以对一些服务器造成压力）。

根据我的经验，甚至在我开始使用 IoC 之前，最大的性能问题就是数据库以及与数据库的交互——优化查询、索引、使用二级缓存等。

如果您的应用程序涉及数据库，那么与数据库往返相比，Windsor 或任何其他容器可能导致的任何性能损失都将非常小。

这就像人们在 1-10 毫秒内比较 new() 运算符与 Activator.CreateInstance() 的性能影响，而单个数据库往返通常要贵一个数量级。

我建议你不要担心小事，而专注于大事。

另外，我想建议你看看 StructureMap，因为我相信它比 Windsor 有更多的功能，并且没有 Windsor 的很多缺点（即坚持引用并要求你发布它们等） .

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-23T08:38:08.150

我遇到的 Castle Windsor 的一个问题是它无法在 Medium Trust 中运行（没有我无法进行的重新编译）。所以我需要从 Windsor 切换到 Unity。

根据 DI/IoC 性能 - 我相信性能影响并不大，尤其是当您牢记它的强大功能时。

顺便说一句：如果您从 DI/IoC 开始，您应该阅读[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa973811.aspx)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-23T09:40:17.497

巨大的启动成本，在运行期间几乎没有性能损失（当然，没有对调用的反射——一切都是在实例化期间编译的）。温莎有点偏重，但是通过适当的生命周期管理应该不会造成任何问题。

一个更重要的缺点是在构建过程中没有发现集成问题，有些甚至在发布时都没有。如果没有仔细跟踪所有模块的版本和对整个系统的持续测试，很容易陷入困境。反射在这里有所帮助，因此 Windsor 在这方面比许多其他 DI 框架更好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-05T19:03:59.523

在我的经验中，IoC 容器的性能不可接受的一个例外是在尝试将 IoC 容器集成/包装为 IServiceProvider 以在 ComponentModel 中使用时——一个曾经常见的例子是在创建自己的托管 winforms 设计器时（通常构建某种自定义设计器，即工作流/流程图等）

由于许多 winforms 组件的行为方式，尤其是在设计时，解析组件的成本将物理上导致鼠标在拖动时“卡顿”，因为该框架每秒可以进行 30,000 次以上的服务解析调用 - 这更多尽管我认为是对组件本身的不良编码实践的反思，或者至少是由于对服务提供商实现快速/简单的假设。

在实践中，我从来没有发现即使在负载很重的商业应用程序中组件解析时间也是一个问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-23T10:00:21.323

关于性能，请参阅以下文章：

*   [http://www.codinginstinct.com/2008/04/ioc-container-benchmark-unity-windsor.html](http://www.codinginstinct.com/2008/04/ioc-container-benchmark-unity-windsor.html)
*   [http://www.codinginstinct.com/2008/04/ioc-benchmark-revisited-ninject.html](http://www.codinginstinct.com/2008/04/ioc-benchmark-revisited-ninject.html)
*   [http://www.codinginstinct.com/2008/05/ioc-container-benchmark-rerevisted.html](http://www.codinginstinct.com/2008/05/ioc-container-benchmark-rerevisted.html)

但请记住，其中一些容器具有更新（可能更快）的版本——尤其是 Unity。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-30T15:39:42.063

> 1.  那是使用反射，每次从容器调用对象时，都必须使用反射，因此性能会很糟糕。（是这样吗？它是否在每次调用时都使用反射？）

据了解，所有好的容器（这里包括温莎城堡）都使用反射来创建新实例。但是，这是提高性能。这是为了与慢得多的 Activator.CreateInstance 进行比较。其他一些容器虽然速度很快，但可以与新的运营商竞争。[在此处](http://www.palmmedia.de/blog/2011/8/30/ioc-container-benchmark-performance-comparison)查看比较基准。温莎城堡不是高性能的，但是速度并不是很重要。在应用程序中使用 IoC 时。90% 的类应该设置为单例，这意味着只在应用程序启动时工作。

> 2.  如果我依赖接口；如何处理具有附加到类上的额外方法和属性的对象？（通过继承）

试试这个[教程](http://www.slideshare.net/bbossola/geecon09-solid)和[这个](http://www.slideshare.net/jonkruger/advanced-objectorientedsolid-principles)教程。它将揭示您问题的答案。如果您想避免设计问题和易于维护的软件，我强烈建议您进行[SOLID 实践](https://en.wikipedia.org/wiki/SOLID_(object-oriented_design))

# javascript - 从 JS 代码中包含 JS 文件的最佳方法是什么？

> ID：388356
> 
> 赞同：8
> 
> 时间：2008-12-23T07:26:18.280
> 
> 标签：javascript

从另一个 Javascript 文件中包含 Javascript 文件的推荐方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T08:38:39.353

大多数人将 JavaScript 文件添加到文档的头部：

```
<script type="text/javascript">
  var newfile=document.createElement('script');
  newfile.setAttribute("type","text/javascript");
  newfile.setAttribute("src", '/myscript.js');
  document.getElementsByTagName("head")[0].appendChild(newfile);
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T07:32:53.103

有图书馆会为你做这件事。您还可以在文档中添加一个脚本标签，指向您要加载的文件（来自js），这是最简单的，但有问题。

[http://developer.yahoo.com/yui/yuiloader/](http://developer.yahoo.com/yui/yuiloader/)

[http://www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)

编辑：我看到很多答案都将脚本标签添加到文档的头部。正如我所说，这个简单的解决方案有一个问题，即您不知道浏览器何时完成加载您请求的脚本，因此您不知道何时可以调用此代码。如果您想使用这样的解决方案，您还应该以某种方式添加回调来告诉您何时加载所需的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T09:06:45.707

jQuery 有[getScript()](http://docs.jquery.com/Ajax/jQuery.getScript)函数。另请注意，上面提到的延迟加载仅适用于图像。不适用于 JavaScript 文件。

```
$.getScript(url, [callback]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T08:47:50.393

[Scriptaculous](http://script.aculo.us/)还内置了一个非常易于使用的功能。

```
Scriptaculous.require("path/to/script.js"); 
```

值得知道，因为 Scriptaculous 是当今非常常见的 javascript 库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T18:48:19.217

[Dojo](http://dojotoolkit.org/)使用`dojo.require()`：

```
dojo.require("your.module.name"); 
```

[通常这是使用XHR](http://en.wikipedia.org/wiki/XHR)完成的同步操作。但是，如果您使用 xDomain 构建，它将是异步的，并且`dojo.addOnLoad()`会在加载脚本时引发。

阅读更多相关信息：

*   [模块](http://dojotoolkit.org/book/dojo-book-0-9/part-3-programmatic-dijit-and-dojo/modules-and-namespaces)
*   [dojo.require 做什么](http://dojotoolkit.org/book/dojo-book-0-9/part-3-programmatic-dijit-and-dojo/modules-and-namespaces/what-does-dojo-require-)
*   [快速入门：自定义构建](http://docs.dojocampus.org/quickstart/custom-builds)（包括 xDomain 说明）
*   [跨域 Dojo](http://docs.dojocampus.org/quickstart/cross-domain)（专门用于 xDomain 的东西）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T07:32:36.693

这个怎么样：

（[原链接](http://www.cryer.co.uk/resources/javascript/script17_include_js_from_js.htm)）

```
<script type="text/javascript">
// Function to allow one JavaScript file to be included by another.
// Copyright (C) 2006-08 www.cryer.co.uk
function IncludeJavaScript(jsFile)
{
  document.write('<script type="text/javascript" src="'
    + jsFile + '"></scr' + 'ipt>'); 
}
</script> 
```

然后要包含第二个 JavaScript 文件，只需添加以下行：

```
IncludeJavaScript('secondJS.js'); 
```

来自的页面包含一些由此方法产生的陷阱，因此在使用该方法之前值得一看。

# tomcat - 在 Jfree 报告模板中使用静态图像的相对路径

> ID：388357
> 
> 赞同：0
> 
> 时间：2008-12-23T07:26:20.230
> 
> 标签：tomcat, jfreereport

我有一个 JfreeReport 应用程序，它在 jar 内的 Tomcat 下运行。在报告模板（存在于 jar 之外）中，我有以下内容：file:///var/lib/tomcat5.5/webapps/Reports/images/logo.gif 但随后出现异常：org.jfree.report。 modules.ModuleInitializeException：无法创建指定目录。然后我尝试使用相对路径但得到 FileNotFoundException。我无法提供该文件的 HTTP 链接。知道如何使用相对路径或文件 URL 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-23T15:06:37.510

模块初始化异常表示在报告引擎的引导/初始化期间出现错误。

我会说，您安装了一个安全管理器，它阻止对主目录（存储字体缓存的默认位置）的写访问。通过设置配置属性重新配置位置

```
org.jfree.report.modules.misc.configstore.filesystem.SystemTargetDir=your/path/here
org.jfree.report.modules.misc.configstore.filesystem.UserTargetDir=your/path/here 
```

通过将 config-property 设置为空字符串（如下所示），到您具有写访问权限或完全禁用缓存的位置（以较长的启动时间为代价，每次重新启动 Tomcat）：

```
org.jfree.report.modules.misc.configstore.filesystem.Module= 
```

可以通过在 WEB-INF/classes 目录中创建“jfreereport.properties”文件或通过 System-properties 设置属性（对于 Web.xml 文件中的实例）来设置配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T09:19:31.377

您的报告是如何要求的。如果是类似的请求

[http://example.com/Reports/some-report](http://example.com/Reports/some-report)

然后你需要使用 images/logo.gif

# javascript - H包括 Internet Explorer 上的缓存问题

> ID：388358
> 
> 赞同：2
> 
> 时间：2008-12-23T07:27:46.467
> 
> 标签：javascript, caching

我已经使用 HInclude ( [http://www.mnot.net/javascript/hinclude/](http://www.mnot.net/javascript/hinclude/) ) 有一段时间了，它工作得很好，但是有一个问题。每次我在 Internet Exploer（6.x + 和 7.0）中点击后退按钮时，使用 HInclude 获取的网站部分都不会刷新。它在其他浏览器上运行良好。我尝试将标头中的缓存控制和杂注控制设置为“无缓存”。但即使这样也行不通。我希望 HInclude 每次用户单击后退按钮或重新访问包含 hx 内容的页面时都能获取新内容。我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-23T08:47:35.853

您是否尝试在 JS 链接的末尾添加一些随机字符串？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-21T15:44:01.377

完整的流量捕获对于准确查看您的服务器正在发送的内容很有用。话虽如此，IE 团队[确实在 IE9 中进行了工作，](http://blogs.msdn.com/b/ie/archive/2010/07/14/caching-improvements-in-internet-explorer-9.aspx)以帮助确保按 RFC2616 和在其他浏览器中实现的那样，点击后退按钮不会击中服务器。

在 IE9 之前，后退行为非常棘手/错误，服务器是否受到攻击可能取决于页面是否具有显式缓存指令以及用户的 IE 缓存设置是什么（请参阅本[文档](http://msdn.microsoft.com/en-us/library/bb250442%28v=vs.85%29.aspx)的中间部分）。在实践中，服务器被击中的频率比它应该的要高得多（当然，从来没有）。

如果我没记错的话，我认为 IE9 之前的错误之一是，如果缓存标头包含必须重新验证，则客户端不会从缓存中提取文件。

-埃里克

# git - git 是否有等效的 bazaar automv 插件？

> ID：388359
> 
> 赞同：2
> 
> 时间：2008-12-23T07:28:00.977
> 
> 标签：git, dvcs, bazaar

我在项目中使用的唯一分布式修订控制系统是 bazaar。除了如何结账外，我对 git 和 mercurial 了解不多。我喜欢 bazaar 的原因是 automv 插件。它检测我何时手动移动/删除文件（从命令行/ide等），当我赶时间时，我倾向于做很多事情。但是 bazaar 真的很慢，我正在考虑转向 git。git 有类似这个功能的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-23T07:47:08.287

Git 在移动/重命名情况下的工作方式是完全不同的。Git 只跟踪内容，因此它知道文件 X 在一次提交时具有 SHA1 哈希值，而文件 Y在下一次提交时`abc123...`恰好具有相同的哈希值。`abc123...`因此，Git 工具在查看历史记录或其他内容时会得出结论，文件 X 必须在此时重命名为文件名 Y。

通过这种方式，Git 重构了从一个提交到下一个提交所采取的操作，而无需在提交时掌握这些知识。它可以事件检测您重命名文件*并*更改文件中某些内容的情况（当然，它不是通过比较 SHA1 哈希值来做到这一点，而是通过在提交中更改的文件之间进行文本比较）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T15:11:49.683

您可能正在寻找[`git add --all`](http://Kernel.Org/pub/software/scm/git/docs/git-add.html)：

> 更新 git 已经知道的文件（与 相同`--update`）并添加所有未被机制忽略的**未跟踪文件**`.gitignore`。

（强调我的。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-11T18:54:55.100

仅供参考，只有集市知道动作。SVN、Git、hg 只知道带版本的复制和删除。我认为那是[不同](http://automatthias.wordpress.com/2007/06/07/directory-renaming-in-scm/)的。但正如之前提到的，git 很好地处理了 automv（据我所知），只有在移动后非常聪明才能快速提交。我听说 egit 在你重命名一个类后会自动提交。

# linux - 如何使用 curl 命令行工具发布 LF？

> ID：388365
> 
> 赞同：7
> 
> 时间：2008-12-23T07:33:29.763
> 
> 标签：linux, curl

我正在尝试使用 Linux shell 脚本中的 CURL 发布到 SMS 提供程序（Sybase 365）的 HTTP 网关。

我需要传递以下数据（注意 [ ] 和 LF 字符）

```
[MSISDN]
List=+12345678
[MESSAGE]
Text=Hello
[END] 
```

如果我使用 -F 参数提交文件，CURL 会删除 LF，例如

```
curl -F @myfile "http://www.sybase.com/..." 
```

在服务器上导致这个（被拒绝）

```
[MSISDN]List=+12345678[MESSAGE]Text=Hello[END] 
```

我可以做些什么来避免这种情况，或者我需要替代工具吗？

我正在使用包含我的数据的文件进行测试，但我想在实践中避免这种情况并直接从脚本中发布。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-23T07:44:15.030

尝试使用`--data-binary`而不是`-d(ata-ascii)`.

从手册：

> --data-binary (HTTP) 这以与 --data-ascii 类似的方式发布数据，尽管使用此选项时，发布数据的整个上下文保持原样。
> 
> 如果你想发布一个没有 --data-ascii 选项的 strip-newlines 特性的二进制文件，这是给你的。如果多次使用此选项，则第一个后面的选项将附加数据。

ETA：哎呀，我应该更仔细地阅读这个问题。您使用的是-F，而不是-d。但`--data-binary`可能仍然值得一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T07:43:36.187

可能是一个愚蠢的想法，但我不认为它实际上需要 CRLF 而不仅仅是 LF？

或者，您是否尝试过使用[--data-binary](http://curl.haxx.se/docs/manpage.html#--data-binary)选项而不是 -F？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-23T09:28:23.900

我已经使用 -d 进行了这项工作

```
request=`printf "[MSISDN]\nList=$number\n[MESSAGE]\nText=$message\n[END]\n"`
response=`curl -s -u $username:$password -d "$request" http://www.sybase.com/...` 
```

奇怪的是，如果我使用 -d @myfile （其中 myfile 包含 LF 分隔的文本），它不起作用。

我也试过 --data-binary 没有成功。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-24T21:34:59.853

```
curl "url" --data-binary @myfile 
```

在数据中发布新行 [在 curl 7.12.1 上测试]

# database - 在 VB.NET 中初始化数据集

> ID：388375
> 
> 赞同：2
> 
> 时间：2008-12-23T07:48:29.593
> 
> 标签：database, vb.net

在 VB.NET 中初始化 DataSet 是否需要使用“Nothing”关键字？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T07:51:40.990

好吧，如果您将变量设置为“Nothing”，那么您根本不会初始化实际的 DataSet 对象 - 您只是将变量的值设置为空引用。

对于实例或静态变量，Nothing 将是默认值。对于局部变量，在 C# 中实际上没有默认值，因为编译器不允许您在未明确分配变量的情况下使用该变量 - VB 编译器是否允许您摆脱这一点取决于编译器设置。但是，如果它*确实*允许您使用未分配的变量，则默认情况下该值将为 Nothing。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T08:13:34.737

```
Dim ds as New DataSet 
```

（或者，如果已经定义，则 ds = New DataSet） ... 是您初始化实际 DataSet 对象所需的全部内容。创建对象是使用“New”关键字。稍后，在其中包含一些 DataTables 之后，您可以使用

```
ds.Tables.Clear 
```

正如乔恩所说，

```
Dim ds as Dataset = nothing 
```

... 不会创建 DataSet 的实例，无论是否初始化。它所做的只是将 'ds' 定义为一个必须引用 DataSet 类实例的变量，并将其显式设置为不指向任何内容。

```
Dim ds as DataSet 
```

..会达到同样的效果。再次，稍后，在你使用了你的 DataSet 之后，

```
ds = Nothing 
```

... 不会重新初始化 DataSet，它所做的只是将您的变量 'ds' 设置为不再引用任何内容。

# asp.net - 如何使用更新面板发布并重新路由其响应数据

> ID：388381
> 
> 赞同：0
> 
> 时间：2008-12-23T07:56:08.033
> 
> 标签：asp.net, ajax, asp.net-ajax

我使用更新面板实现了一个保存草稿技巧，我在服务器端处理更新面板的异步回发，然后为了避免重新发送相同的 html 数据，我将当前日期时间作为消息抛出异常，然后在客户端捕获它我做了一些转换和 html 注入，让用户知道他当前工作的草稿已被保存（可怕！）。

最初的想法是处理异步回发，然后覆盖更新面板的呈现方法以发送可以在客户端捕获和处理的 xml 或 javascript 数据，从而阻止更新面板刷新发生。

有没有人使用更新面板尝试过这种功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T08:14:30.213

我不认为 UpdatePanel*真的*是你想要的。如果您想获得响应并最好地控制响应，您应该查看标准 AJAX 请求。

UpdatePanel 不是您可以真正控制所有响应的东西，您可以绑定到 上的`endRequest`事件处理程序，在`PageRequestManager`那里您可以检查响应。这是您返回的 eventArgs 的详细信息 - [http://msdn.microsoft.com/en-au/library/bb384175.aspx](http://msdn.microsoft.com/en-au/library/bb384175.aspx)

但是抛出异常不是一个好主意，因为没有发生任何**异常**，这就是异常；）

# oracle - 在哪里下载和安装 Oracle Directory Manager？

> ID：388387
> 
> 赞同：0
> 
> 时间：2008-12-23T08:10:13.903
> 
> 标签：oracle, download-manager

有人能具体告诉我在哪里可以下载 Oracle Directory Manager 组件吗？我知道它在一张 Oracle 10g 光盘中，但是哪一张呢？数据库、客户端或配套 CD。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T08:25:08.740

如果您搜索*odm*或*oidadmin*，您会得到一些提示，例如[这个论坛帖子](http://forums.oracle.com/forums/message.jspa?messageID=1080457)。所以它似乎是客户端套件的一部分，可以在[这里下载](http://www.oracle.com/technology/software/products/database/oracle10g/htdocs/10201winsoft.html)

# java - 唯一标识 JSR-168 portlet 的实例

> ID：388394
> 
> 赞同：1
> 
> 时间：2008-12-23T08:16:22.703
> 
> 标签：java, portlet

我正在编写一个可以多次添加到容器中的 JSR-168 portlet。每个容器（Liferay、JBoss 等）都有自己的内部方法来区分同一 portlet 的多个实例。

但是，我想在`doView()`方法本身中唯一标识我的 portlet 实例。

是否有任何标准的 JSR-168 机制来检索对于我的 portlet 的每个实例都不同的唯一标识符？我见过各种解决方案，人们[随机](http://mus.purplecloud.net/portlets/portlet_messaging_1/documentation.php) [生成](http://www.archivum.info/jetspeed-dev@portals.apache.org/2008-08/msg00003.html)唯一 ID 并将它们保存在会话中，但如果存在标准机制，我更喜欢标准机制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T12:52:26.297

Portlet 1.0 (168) 提供了[RenderResponse.getNamespace()](http://portals.apache.org/pluto/portlet-1.0-apidocs/javax/portlet/RenderResponse.html)方法，每个 portlet 实例应该是唯一的。

来自规范：**PLT.12.3.4 命名空间编码**：

> getNamespace 方法必须为portlet 提供一种机制，以确保返回的字符串在整个门户页面中的唯一性。例如，getNamespace 方法将返回一个唯一的字符串，该字符串可以作为 portlet 生成的内容中的 JavaScript 变量名的前缀，从而确保其在整个页面中的 5 唯一性。如果在渲染请求中多次调用 getNamespace 方法，则必须返回相同的值。

如果您想在*processAction*中访问它，您可能希望将其存储在会话中或作为*actionURL*参数。

如果可以选择升级，Portlet 2.0 (286) 会更改底层*PortletResponse*接口以提供*getNamespace()*方法，并添加可能对您有用的*PortletRequest.getWindowID()方法。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T08:41:38.160

不，实例没有通用 ID。我自己实现了一个 portlet 容器，公共 api 中没有每个实例的 id - 容器有一个，原因。portlet 会话 ( `javax.portlet.PortletRequest#getPortletSession()`) 对于一个 portlet（由标记 in 定义`portlet.xml`）和一个用户 ( ) 是唯一的`javax.servlet.http.HttpSession`，这对您来说是不够的。

所以恕我直言，生成的 id（也可以是 portletl 类中的简单（同步）计数器）并存储在 portlet 会话中是唯一可移植的方式。portlet 类本身通常在实例之间共享，因此`java.lang.System#identityHashCode(Object x)`它也是无用的。

你为什么需要它？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-12T17:55:20.020

我很惊讶按照 Ame 似乎不存在这个唯一 ID。实例 ID 可用于将所有 portlet 首选项存储在我们自己的数据库中，而不是容器提供的数据库中。我们需要自己存储它的原因之一是容器提供的首选项不支持特定于区域设置的首选项。

即，一个portlet 实例可能对每个语言环境有不同的偏好。

我们正在尝试使用 Liferay 来满足我们的需求。

# delphi - Delphi - 显示所有图像格式

> ID：388409
> 
> 赞同：4
> 
> 时间：2008-12-23T08:32:08.383
> 
> 标签：delphi, image

我是 Delphi 的新手程序员。我需要帮助，我有一个小项目需要显示各种图像格式。

请建议我应该做什么或delphi中支持所有图像格式的任何组件？我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-23T09:21:20.763

[查看www.soft-gems.net](http://www.soft-gems.net)上提供的[GraphicEx](http://www.soft-gems.net/index.php?option=com_content&task=view&id=13&Itemid=33)库。这应该为您提供大多数（如果不是全部）您想要的格式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T02:38:47.560

我找到了一个适合我需要的图书馆。它称为[vampyre 库](http://imaginglib.sourceforge.net/)，效果惊人。它支持 TIFF、tif、动画 gif 等等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T08:56:56.133

您可以将多种图像类型与标准 TImage 组件一起使用。至少 bmp 和 jpg（如果您使用 Jpeg 单位）。

2009 版添加了更多内容。图像格式（我认为至少是 png 和 wmf）。

有很多第三方组件用于图像显示/处理。谷歌搜索将显示所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T09:23:40.337

[GraphicEx](http://www.soft-gems.net/index.php?option=com_content&task=view&id=13&Itemid=33#GraphicEx)应该是一个好的开始。它是免费的，并且包含最常用的格式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T10:25:13.427

[用于 Delphi 的ImageEn](http://www.hi-components.com/nimageen.asp) 和[Imaging Toolkit](http://www.mcm-design.com/index.php?section=products&product=ImagingDelphi)都 提供了广泛的支持格式

你可以在[tory](http://www.torry.net/pages.php?id=112)网站找到更多

# java - 将光标放在图形上时显示图形的值

> ID：388411
> 
> 赞同：1
> 
> 时间：2008-12-23T08:33:21.343
> 
> 标签：java, visualization, jfreechart

我正在使用 jfreechart 来绘制图表。当光标放在图表上时，我需要显示该值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T13:43:46.583

使用工具提示管理器。如果您可以将图形注册为组件，则可以为其分配特定的工具提示，该工具提示将自动显示。

如果您不能使用默认版本，也可以编写自定义 ToolTipManager，当光标在屏幕上的某些区域时显示工具提示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T13:42:42.750

我以前从未使用过 jfreechart 工具提示，但这可能是您正在寻找的。

org.jfreechart.labels 包中有一系列特定于图表的工具提示界面/类。例如，使用带有 XYItemRenderer 的[XyToolTipGenerator](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/renderer/xy/XYItemRenderer.html#setBaseToolTipGenerator(org.jfree.chart.labels.XYToolTipGenerator))可能会满足您的需求。

# linq-to-sql - 我怎样才能加速这个 linq to sql 函数？

> ID：388431
> 
> 赞同：1
> 
> 时间：2008-12-23T08:49:16.507
> 
> 标签：linq-to-sql, optimization

我有一个函数（称为“powersearch”，具有讽刺意味！）在一堆（〜5）字段中搜索一组字符串。单词以一个字符串形式出现，并由空格分隔。
有些字段可以有完全匹配，其他应该有“包含”。

（为简洁起见截取）

```
//Start with all colors
IQueryable<Color> q = db.Colors;
//Filter by powersearch
if (!string.IsNullOrEmpty(searchBag.PowerSearchKeys)){
    foreach (string key in searchBag.SplitSearchKeys(searchBag.PowerSearchKeys)
                                    .Where(k=> !string.IsNullOrEmpty(k))){
        //Make a local copy of the var, otherwise it gets overwritten
        string myKey = key;
        int year;
        if (int.TryParse(myKey, out year) && year > 999){
            q = q.Where(c => c.Company.Name.Contains(myKey)
                || c.StockCode.Contains(myKey)                                
                || c.PaintCodes.Any(p => p.Code.Equals(myKey))
                || c.Names.Any(n => n.Label.Contains(myKey))
                || c.Company.CompanyModels.Any(m => m.Model.Name.Contains(myKey))
                || c.UseYears.Any(y => y.Year.Equals(year))
            );
        }
        else{
            q = q.Where(c => c.Company.Name.Contains(myKey)
                || c.StockCode.Contains(myKey)
                || c.PaintCodes.Any(p => p.Code.Contains(myKey))
                || c.Names.Any(n => n.Label.Contains(myKey))                                
                || c.Company.CompanyModels.Any(m => m.Model.Name.Equals(myKey))
            );
        }
    }
} 
```

因为 useYear 计数相当大，所以我试图通过排除所有在这种情况下永远不可能是有意义的数字来尽可能少地检查它。在其他字段上不可能进行类似的检查，因为它们几乎可以包含任何可以想到的字符串。

目前，对于单个非年份字符串，此查询大约需要 15 秒。这太多了。我能做些什么来改善这一点？

**--Edit--**
Profiler 向我显示字符串不是年份的部分的以下信息：

exec sp_reset_connection 审核登录

```
exec sp_executesql N'
SELECT COUNT(*) AS [value]
FROM [dbo].[CLR] AS [t0]
INNER JOIN [dbo].[CO] AS [t1] ON [t1].[CO_ID] = [t0].[CO_ID]
WHERE 
    ([t1].[LONG_NM] LIKE @p0)
    OR ([t0].[EUR_STK_CD] LIKE @p1)
    OR (EXISTS(
        SELECT NULL AS [EMPTY]
        FROM [dbo].[PAINT_CD] AS [t2]
        WHERE ([t2].[PAINT_CD] LIKE @p2)
            AND ([t2].[CLR_ID] = [t0].[CLR_ID])
            AND ([t2].[CUSTOM_ID] = [t0].[CUSTOM_ID])
        )
    )OR (EXISTS(
        SELECT NULL AS [EMPTY]
        FROM [dbo].[CLR_NM] AS [t3]
        WHERE ([t3].[CLR_NM] LIKE @p3)
            AND ([t3].[CLR_ID] = [t0].[CLR_ID])
            AND ([t3].[CUSTOM_ID] = [t0].[CUSTOM_ID])
        )
    ) OR (EXISTS(
        SELECT NULL AS [EMPTY]
        FROM [dbo].[CO_MODL] AS [t4]
        INNER JOIN [dbo].[MODL] AS [t5] ON [t5].[MODL_ID] = [t4].[MODL_ID]
        WHERE ([t5].[MODL_NM] = @p4)
            AND ([t4].[CO_ID] = [t1].[CO_ID])
        )
    )
',N'@p0 varchar(10),@p1 varchar(10),@p2 varchar(10),@p3 varchar(10),@p4 varchar(8)',@p0='%mercedes%',@p1='%mercedes%',@p2='%mercedes%',@p3='%mercedes%',@p4='mercedes' 
```

（耗时 3626 毫秒）审核注销（3673 毫秒）执行 sp_reset_connection（0 毫秒）审核登录

```
exec sp_executesql N'
SELECT TOP (30) 
[t0].[CLR_ID] AS [Id],
[t0].[CUSTOM_ID] AS [CustomId],
[t0].[CO_ID] AS [CompanyId], 
[t0].[EUR_STK_CD] AS [StockCode], 
[t0].[SPCL_USE_CD] AS [UseCode], 
[t0].[EFF_IND] AS [EffectIndicator]
FROM [dbo].[CLR] AS [t0]
INNER JOIN [dbo].[CO] AS [t1] ON [t1].[CO_ID] = [t0].[CO_ID]
WHERE 
    ([t1].[LONG_NM] LIKE @p0)
    OR ([t0].[EUR_STK_CD] LIKE @p1)
    OR (EXISTS(
        SELECT NULL AS [EMPTY]
        FROM [dbo].[PAINT_CD] AS [t2]
        WHERE ([t2].[PAINT_CD] LIKE @p2)
            AND ([t2].[CLR_ID] = [t0].[CLR_ID])
            AND ([t2].[CUSTOM_ID] = [t0].[CUSTOM_ID])
        )
    )
    OR (EXISTS(
        SELECT NULL AS [EMPTY]
        FROM [dbo].[CLR_NM] AS [t3]
        WHERE ([t3].[CLR_NM] LIKE @p3)
            AND ([t3].[CLR_ID] = [t0].[CLR_ID])
            AND ([t3].[CUSTOM_ID] = [t0].[CUSTOM_ID])
        )
    )
    OR (EXISTS(
        SELECT NULL AS [EMPTY]
        FROM [dbo].[CO_MODL] AS [t4]
        INNER JOIN [dbo].[MODL] AS [t5] ON [t5].[MODL_ID] = [t4].[MODL_ID]
        WHERE ([t5].[MODL_NM] = @p4)
            AND ([t4].[CO_ID] = [t1].[CO_ID])
        )
    )'
,N'@p0 varchar(10),@p1 varchar(10),@p2 varchar(10),@p3 varchar(10),@p4 varchar(8)',@p0='%mercedes%',@p1='%mercedes%',@p2='%mercedes%',@p3='%mercedes%',@p4='mercedes' 
```

（耗时 3368 毫秒）

遗憾的是，数据库结构不在我的控制之下。它来自美国，出于兼容性原因必须保持完全相同的格式。尽管大多数重要字段确实都已编入索引，但它们在（不必要的）聚集主键中被编入索引。我对此无能为力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T08:59:03.493

好的，让我们分解一下 - 你首先感兴趣的测试用例是一个非年份，所以我们所拥有的是：

```
q = q.Where(c => c.Company.Name.Contains(myKey)
            || c.StockCode.Contains(myKey)
            || c.PaintCodes.Any(p => p.Code.Contains(myKey))
            || c.Names.Any(n => n.Label.Contains(myKey))
            || c.Company.CompanyModels.Any(m => m.Model.Name.Equals(myKey)) 
```

我对吗？如果是这样，SQL 是什么样的？在 SQL Profiler 中执行 SQL 语句需要*多*长时间？探查器说执行计划是什么样的？您是否在所有适当的列上都有索引？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T10:24:59.760

使用编译查询。

如果不这样做，您将损失高达 5-10 倍的性能，因为*每次*调用时 LINQ-to-SQL 都必须从查询中生成 SQL。

当您在 LINQ-to-SQL 中使用非常量时，情况会变得更糟，因为获取它们的值真的很慢。

这假设您已经拥有索引和健全的数据库架构。

顺便说一句，我不是在开玩笑 5-10 倍的部分。

# linux - linux fcntl - 取消设置标志

> ID：388434
> 
> 赞同：9
> 
> 时间：2008-12-23T08:50:44.133
> 
> 标签：linux, fcntl

如何使用 fcntl 取消设置已设置的标志？

例如，我可以使用将套接字设置为非阻塞模式

```
fcntl(sockfd, F_SETFL, flags | O_NONBLOCK) 
```

现在，我想取消设置 O_NONBLOCK 标志。

我试过 fcntl(sockfd, F_SETFL, flags | ~O_NONBLOCK)。它给了我错误 EINVAL

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-23T08:55:46.463

```
int oldfl;
oldfl = fcntl(sockfd, F_GETFL);
if (oldfl == -1) {
    /* handle error */
}
fcntl(sockfd, F_SETFL, oldfl & ~O_NONBLOCK); 
```

未经测试，但希望这会有所帮助。:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-10-07T06:30:35.303

```
val = fcntl(fd, F_GETFL, 0);
flags = O_NONBLOCK;
val &= ~flags;
fcntl(fd,F_SETFL,val); 
```

如果你这样做，已经设置的 O_NONBLOCK 将被取消设置。在这里，flags 包含您要取消设置的标志。完成 AND(&) 操作后，您必须再次使用 val 中的值设置标志。我希望这能帮到您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-22T10:32:35.187

以下代码将取消设置标志，例如 O_NONBLOCK 标志：

```
if ((flags = fcntl(fileno(sockfd), F_GETFL, 0)) < 0) {
    perror("error on F_GETFL");
}
else {
    flags &= ~O_NONBLOCK;
    if (fcntl(fileno(sockfd), F_SETFL, flags) < 0) {
        perror("error on F_SETFL");
    }
    else {
        /* O_NONBLOCK set without errors. continue from here */
        }
} 
```

问候

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T09:07:37.623

尝试取消设置所有标志：

```
fcntl(sockfd, F_SETFL, 0); 
```

此外，对标志进行或运算`~O_NONBLOCK`也没用，您需要对它进行与运算，因为您想要的是取消设置 O_NONBLOCK 位。

# jquery - jQuery Ajax：返回值给调用者？

> ID：388436
> 
> 赞同：3
> 
> 时间：2008-12-23T08:51:21.417
> 
> 标签：jquery, ajax, return-value, return

我有一些 jQuery 代码。我调用了一个 Ajax 函数文件 file.php，其中包含一些字段，例如：

```
<input type="radio" value="plz">Milk</input>. 
```

我会再次分配给 jQuery 函数吗？如果是这样，我该怎么做？我附上了一个示例文件：

```
<html>
    <head>
        <LINK REL=StyleSheet HREF="examples.css" TITLE="Contemporary" TYPE="text/css">
        <script src="jquery-1.2.6.js" type="text/javascript"></script>
        <script src="jquery-impromptu.1.6.js" type="text/javascript"></script>
        <script>
            $(document).ready(function(){
                $.ajax({
                    type:"GET",
                    url:"file.php",
                    data:id,
                    success:function(){
                        var txt=id;
                        $.prompt( txt,{ opacity: 0.2 });
                    },
                    error:function(){
                        window.location("ERRoR");
                    }
                });
            });
        </script>

    <body>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-23T09:04:14.590

该`success`函数接受一个参数，其中包含获取的数据。所以在你的例子中：

```
$(document).ready(
    function(){ $.ajax({
       type:"GET",
       url:"file.php",
       data:id,
       success:function(txt){
          $.prompt( txt,{ opacity: 0.2 });
       },
       // ... more ...
    }
}); 
```

更多示例在[jQuery 文档](http://docs.jquery.com/Ajax/jQuery.ajax#code)中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-05T22:24:05.877

```
jQuery.ajax({
     type:"POST",
     url:"file.php",
     data:"id1="+val1+"&id2="+val2,
     success:function(data){
       jQuery("#div_id").html(data);
    } 
```

# java - 为什么 Java 的可克隆接口不是通用的？

> ID：388439
> 
> 赞同：15
> 
> 时间：2008-12-23T08:55:27.897
> 
> 标签：java, generics

Java 5 引入了泛型，它们被添加到`java.lang`包中的许多接口中。但是，`Cloneable`没有得到泛型。我想知道为什么？

* * *

**编辑：**在回复@Jon 和@litb 的答案以及@Earwicker 的评论时，我想`Cloneable`可能是：

```
public interface Cloneable<T> {
    public T clone();
} 
```

这里`T clone();`overrides `Object.clone()`，给它一个协变类型。我相信这仍然是向后兼容的并增加了类型安全性。那为什么不呢？

* * *

**编辑2：**从下面的答案（和评论）中可以看出，上面建议的界面会破坏向后兼容性。既然`Object.clone()`是`protected`，在接口中重写它会迫使所有实现者提供一个`public`实现，而类设计者可能不希望这样做（即他们可能会选择保留它`protected`）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-23T09:00:15.673

Cloneable 接口不包含任何成员。让它通用有什么意义？

（如果 Cloneable 包含 clone() 方法，这将是有意义的 - 但这是在 java.lang.Object 中声明的。）

编辑：clone() 在 java.lang.Object 中，因为它有一个实现（它执行逐个字段的复制）。更好的设计是将 .NET 的[MemberwiseClone()](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)之类的东西作为 Object 中的受保护方法，然后在接口本身中使用公共 clone() 方法。我不知道为什么没有选择那个设计。

（在 .NET 中，[ICloneable](http://msdn.microsoft.com/en-us/library/system.icloneable.aspx)不是泛型的，因为它在泛型之前就存在——.NET 泛型的不同性质阻止了以前的非泛型类型变为泛型。）

然而，在 Java 和 .NET 中，“正常”克隆 API 通常被认为是一件坏事，因为它没有说明应该执行什么深度的克隆。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-06-23T23:12:37.690

如果`Cloneable`是`Cloneable<T>`，那么就不可能做到这一点：

```
class A extends B implements Cloneable<A>

class B implements Cloneable<B> 
```

不能用不同的参数实现同一个接口，类`A`实现`Cloneable<A>`和`Cloneable<B>`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-23T09:02:16.573

`java.lang.Cloneable`是一个标记界面。它仅用于目的，以便 Object.clone 可以抛出异常以指示类不支持克隆，例如

```
if(!(this instanceof Cloneable))
    throw...; 
```

从文档中：

> 类 Object 的方法 clone 执行特定的克隆操作。首先，如果该对象的类没有实现接口 Cloneable，则抛出 CloneNotSupportedException。

它没有任何方法。使它成为通用的将没有任何用处。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-24T18:36:35.837

这并没有解决您的理论问题，而是处理实际案例：

Java 5 具有协变返回值，并允许扩大方法的访问范围。因此，您可以在子类中适当地更改 clone() 的签名。

```
public class MyClass implements Cloneable {
    public MyClass clone(){ /* do the right stuff */ }
} 
```

`MyClass.clone()`是 的正确覆盖`Object.clone()`，您不必编写强制转换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T20:41:31.920

作为一个半相关的思考问题：创建一个将 clone() 公开为公共成员的接口（称为ReallyCloneable）有用吗？

我的论点是，不，它不会。可克隆性与具体的类实现密切相关。我想不出一个我可能会说“我有一个任意对象，我想要它的副本”的用例。直接的问题是：你为什么想要那个副本？

典型的答案是，您可以修改副本而不影响原件。但是，要做到这一点，你需要知道你持有什么类型的对象，否则你怎么知道调用什么来修改它？如果你知道这一点，你就会知道它是否提供了一个公共的 clone() 方法。

但是如果你正在对一个接口进行编程，比如 List 呢？智能（递归）克隆（相对于字节级对象数据复制）对于 Collections 框架将非常有用。但是可能有一些集合（比如由数据库支持的集合）不支持这样的操作，所以你不能要求 List 公开一个公共的 clone()。这驱使您实例化自己的具体 List 实现以复制源 List 的内容。

# javascript - 无法实现监听器

> ID：388456
> 
> 赞同：-2
> 
> 时间：2008-12-23T09:08:13.333
> 
> 标签：javascript

```
YAHOO.namespace("yuibook.calendar"); 

//define the lauchCal function which creates the calendar 
YAHOO.yuibook.calendar.launchCal = function() { 

    //create the calendar object, specifying the container 
    var myCal = new YAHOO.widget.Calendar("mycal"); 

    //draw the calendar on screen 
    myCal.render(); 
}

//define the showCal function which shows the calendar
Var showCal = function() { 
    //show the calendar 
    myCal.show(); 
} 

//create calendar on page load
YAHOO.util.Event.onDOMReady(YAHOO.yuibook.calendar.launchCal); 

//attach listener for click event on calendar icon 
YAHOO.util.Event.addListener("calico", "click", showCal); 

//myCal.hide(); 
```

代码的问题是当我单击图标时无法显示日历。任何人都可以帮忙。我认识这个听众

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T14:49:08.840

问题是该`myCal`变量在`showCal`函数中未定义。该`myCal`变量在函数中定义，`launchCal`并且仅在该函数的范围内可用。您需要存储对`myCal`变量的引用。

像下面这样的东西应该可以解决问题：

```
YAHOO.namespace("yuibook.calendar");

YAHOO.util.Event.onDOMReady(function() {
    YAHOO.yuibook.calendar.myCal = new YAHOO.widget.Calendar("mycal");
    YAHOO.yuibook.calendar.myCal.render();

    YAHOO.util.Event.addListener("calico", "click", YAHOO.yuibook.calendar.myCal.show); 
}); 
```

查看YUI 文档中的[弹出日历示例以获取更多详细信息。](http://developer.yahoo.com/yui/examples/calendar/popup.html)

# jboss - 你能在 OSGi 中运行 EJB 2.1 bean 吗？

> ID：388460
> 
> 赞同：1
> 
> 时间：2008-12-23T09:14:44.537
> 
> 标签：jboss, osgi, ejb-2.x, stateless-session-bean, entity-bean

我有一个使用 EJB 2.1 会话和实体 bean 的 J2EE 1.3 应用程序。目前，此应用程序在 JBoss 上作为 EAR 文件运行。由于 OSGi 提供的所有好处，我想切换到 SpringSource dm Application Server。

有谁知道是否有可以充当 EJB 容器的 OSGi 包？[OpenEJB](http://openejb.apache.org/)可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T09:30:51.843

希望它可以帮助你：

[http://darrylnelson.wordpress.com/2008/08/22/openejb-in-felix/#](http://darrylnelson.wordpress.com/2008/08/22/openejb-in-felix/#)

它对我有很大帮助:-)

# java - 如何在 Java 中填充字符串？

> ID：388461
> 
> 赞同：474
> 
> 时间：2008-12-23T09:15:23.740
> 
> 标签：java, string, padding

有没有一些简单的方法可以在 Java 中填充字符串？

似乎应该在一些类似 StringUtil 的 API 中，但我找不到任何这样做的东西。

* * *

## 回答 #1

> 赞同：691
> 
> 时间：2008-12-24T18:21:54.493

从 Java 1.5 开始，[`String.format()`](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#format-java.lang.String-java.lang.Object...-)可用于左/右填充给定字符串。

```
public static String padRight(String s, int n) {
     return String.format("%-" + n + "s", s);  
}

public static String padLeft(String s, int n) {
    return String.format("%" + n + "s", s);  
}

...

public static void main(String args[]) throws Exception {
 System.out.println(padRight("Howto", 20) + "*");
 System.out.println(padLeft("Howto", 20) + "*");
} 
```

输出是：

```
Howto               *
               Howto* 
```

* * *

## 回答 #2

> 赞同：275
> 
> 时间：2011-05-31T09:13:08.153

填充到 10 个字符：

```
String.format("%10s", "foo").replace(' ', '*');
String.format("%-10s", "bar").replace(' ', '*');
String.format("%10s", "longer than 10 chars").replace(' ', '*'); 
```

输出：

```
 *******foo
  bar*******
  longer*than*10*chars 
```

密码字符显示“*”：

```
String password = "secret123";
String padded = String.format("%"+password.length()+"s", "").replace(' ', '*'); 
```

输出与密码字符串的长度相同：

```
 secret123
  ********* 
```

* * *

## 回答 #3

> 赞同：200
> 
> 时间：2008-12-23T09:22:07.563

Apache有[`StringUtils`](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/StringUtils.html)几种方法：[`leftPad`](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/StringUtils.html#leftPad(java.lang.String,%20int))、[`rightPad`](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/StringUtils.html#rightPad(java.lang.String,%20int))和。[`center`](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/StringUtils.html#center(java.lang.String,%20int))[`repeat`](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/StringUtils.html#repeat(java.lang.String,%20int))

但请注意——正如其他人在[这个答案](https://stackoverflow.com/a/391978/1725096)中提到和展示的那样——JDK 中`String.format()`的`Formatter`类是更好的选择。在公共代码上使用它们。

* * *

## 回答 #4

> 赞同：88
> 
> 时间：2011-09-21T15:56:44.543

在[Guava](http://code.google.com/p/guava-libraries/)中，这很容易：

```
Strings.padStart("string", 10, ' ');
Strings.padEnd("string", 10, ' '); 
```

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2013-09-02T08:29:41.523

**一些简单的事情：**

该值应该是一个字符串。如果不是，将其转换为字符串。喜欢`"" + 123`或`Integer.toString(123)`

```
// let's assume value holds the String we want to pad
String value = "123"; 
```

子字符串从值长度 char 索引开始，直到填充的结束长度：

```
String padded="00000000".substring(value.length()) + value;

// now padded is "00000123" 
```

**更精确**

垫右：

```
String padded = value + ("ABCDEFGH".substring(value.length())); 

// now padded is "123DEFGH" 
```

垫左：

```
String padString = "ABCDEFGH";
String padded = (padString.substring(0, padString.length() - value.length())) + value;

// now padded is "ABCDE123" 
```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2008-12-23T09:24:38.683

看看`org.apache.commons.lang.StringUtils#rightPad(String str, int size, char padChar)`。

但是算法非常简单（填充到大小字符）：

```
public String pad(String str, int size, char padChar)
{
  StringBuilder padded = new StringBuilder(str);
  while (padded.length() < size)
  {
    padded.append(padChar);
  }
  return padded.toString();
} 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2008-12-23T09:24:20.493

除了 Apache Commons，还可以查看`String.format`哪些应该能够处理简单的填充（例如，使用空格）。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2012-02-09T17:22:06.493

```
public static String LPad(String str, Integer length, char car) {
  return (str + String.format("%" + length + "s", "").replace(" ", String.valueOf(car))).substring(0, length);
}

public static String RPad(String str, Integer length, char car) {
  return (String.format("%" + length + "s", "").replace(" ", String.valueOf(car)) + str).substring(str.length(), length + str.length());
}

LPad("Hi", 10, 'R') //gives "RRRRRRRRHi"
RPad("Hi", 10, 'R') //gives "HiRRRRRRRR"
RPad("Hi", 10, ' ') //gives "Hi        "
RPad("Hi", 1, ' ')  //gives "H"
//etc... 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2018-11-24T14:50:15.337

从 Java 11 开始，String.repeat(int) 可用于向左/向右填充给定的字符串。

```
System.out.println("*".repeat(5)+"apple");
System.out.println("apple"+"*".repeat(5)); 
```

输出：

```
*****apple
apple***** 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2010-10-28T14:34:48.523

我知道这个线程有点旧，最初的问题是一个简单的解决方案，但如果它应该非常快，你应该使用一个 char 数组。

```
public static String pad(String str, int size, char padChar)
{
    if (str.length() < size)
    {
        char[] temp = new char[size];
        int i = 0;

        while (i < str.length())
        {
            temp[i] = str.charAt(i);
            i++;
        }

        while (i < size)
        {
            temp[i] = padChar;
            i++;
        }

        str = new String(temp);
    }

    return str;
} 
```

格式化程序解决方案不是最佳的。只是构建格式字符串会创建 2 个新字符串。

apache的解决方案可以通过用目标大小初始化sb来改进，所以在下面替换

```
StringBuffer padded = new StringBuffer(str); 
```

和

```
StringBuffer padded = new StringBuffer(pad); 
padded.append(value); 
```

会阻止某人的内部缓冲区增长。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2010-10-29T20:58:09.183

我花了一点时间才弄清楚。真正的关键是阅读 Formatter 文档。

```
// Get your data from wherever.
final byte[] data = getData();
// Get the digest engine.
final MessageDigest md5= MessageDigest.getInstance("MD5");
// Send your data through it.
md5.update(data);
// Parse the data as a positive BigInteger.
final BigInteger digest = new BigInteger(1,md5.digest());
// Pad the digest with blanks, 32 wide.
String hex = String.format(
    // See: http://download.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html
    // Format: %[argument_index$][flags][width]conversion
    // Conversion: 'x', 'X'  integral    The result is formatted as a hexadecimal integer
    "%1$32x",
    digest
);
// Replace the blank padding with 0s.
hex = hex.replace(" ","0");
System.out.println(hex); 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2017-10-26T19:20:30.223

[在Dzone](https://dzone.com/articles/java-string-format-examples)上找到这个

用零填充：

```
String.format("|%020d|", 93); // prints: |00000000000000000093| 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2011-09-21T15:45:45.857

这是向右填充的另一种方法：

```
// put the number of spaces, or any character you like, in your paddedString

String paddedString = "--------------------";

String myStringToBePadded = "I like donuts";

myStringToBePadded = myStringToBePadded + paddedString.substring(myStringToBePadded.length());

//result:
myStringToBePadded = "I like donuts-------"; 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-12-23T14:25:42.257

您可以通过保留填充数据来减少每次调用的开销，而不是每次都重建它：

```
public class RightPadder {

    private int length;
    private String padding;

    public RightPadder(int length, String pad) {
        this.length = length;
        StringBuilder sb = new StringBuilder(pad);
        while (sb.length() < length) {
            sb.append(sb);
        }
        padding = sb.toString();
   }

    public String pad(String s) {
        return (s.length() < length ? s + padding : s).substring(0, length);
    }

} 
```

作为替代方案，您可以将结果长度作为`pad(...)`方法的参数。在这种情况下，在该方法中而不是在构造函数中调整隐藏的填充。

（提示：为了额外的功劳，让它线程安全！;-)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-12-23T14:58:42.737

`java.util.Formatter`将做左右填充。不需要奇怪的第三方依赖项（您是否想为如此琐碎的事情添加它们）。

[我省略了细节并将这篇文章设为“社区维基”，因为这不是我需要的。]

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2010-08-24T10:55:49.627

您可以使用内置的 StringBuilder append() 和 insert() 方法来填充可变字符串长度：

```
AbstractStringBuilder append(CharSequence s, int start, int end) ; 
```

例如：

```
private static final String  MAX_STRING = "                    "; //20 spaces

    Set<StringBuilder> set= new HashSet<StringBuilder>();
    set.add(new StringBuilder("12345678"));
    set.add(new StringBuilder("123456789"));
    set.add(new StringBuilder("1234567811"));
    set.add(new StringBuilder("12345678123"));
    set.add(new StringBuilder("1234567812234"));
    set.add(new StringBuilder("1234567812222"));
    set.add(new StringBuilder("12345678122334"));

    for(StringBuilder padMe: set)
        padMe.append(MAX_STRING, padMe.length(), MAX_STRING.length()); 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-05-11T14:30:17.743

这有效：

```
"".format("%1$-" + 9 + "s", "XXX").replaceAll(" ", "0") 
```

它将用空格填充您的 String XXX 最多 9 个字符。之后，所有空格都将替换为 0。您可以将空格和 0 更改为您想要的任何内容...

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-08-24T17:36:51.160

```
public static String padLeft(String in, int size, char padChar) {                
    if (in.length() <= size) {
        char[] temp = new char[size];
        /* Llenado Array con el padChar*/
        for(int i =0;i<size;i++){
            temp[i]= padChar;
        }
        int posIniTemp = size-in.length();
        for(int i=0;i<in.length();i++){
            temp[posIniTemp]=in.charAt(i);
            posIniTemp++;
        }            
        return new String(temp);
    }
    return "";
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2015-08-28T16:58:55.157

很多人都有一些非常有趣的技术，但我喜欢保持简单，所以我选择了这个：

```
public static String padRight(String s, int n, char padding){
    StringBuilder builder = new StringBuilder(s.length() + n);
    builder.append(s);
    for(int i = 0; i < n; i++){
        builder.append(padding);
    }
    return builder.toString();
}

public static String padLeft(String s, int n,  char padding) {
    StringBuilder builder = new StringBuilder(s.length() + n);
    for(int i = 0; i < n; i++){
        builder.append(Character.toString(padding));
    }
    return builder.append(s).toString();
}

public static String pad(String s, int n, char padding){
    StringBuilder pad = new StringBuilder(s.length() + n * 2);
    StringBuilder value = new StringBuilder(n);
    for(int i = 0; i < n; i++){
        pad.append(padding);
    }
    return value.append(pad).append(s).append(pad).toString();
} 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2016-08-11T05:09:33.957

对于某些需要在连接到另一个字符串之前提供左/右填充（或前缀/后缀字符串或空格）并且您不想测试长度或任何 if 条件的情况，让我留下一个答案。

与所选答案相同，我更喜欢`StringUtils`Apache Commons 但使用这种方式：

```
StringUtils.defaultString(StringUtils.leftPad(myString, 1)) 
```

解释：

*   `myString`: 我输入的字符串，可以为空
*   `StringUtils.leftPad(myString, 1)`: 如果 string 为 null，则此语句也将返回 null
*   然后使用`defaultString`给空字符串以防止连接 null

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2017-07-11T20:39:46.400

[@ck](https://stackoverflow.com/a/4043913/2133216)和[@Marlon Tarak](https://stackoverflow.com/a/7179819/2133216)的答案是唯一使用 a 的答案`char[]`，这对于每秒多次调用填充方法的应用程序是最好的方法。但是，它们没有利用任何数组操作优化，并且根据我的口味被覆盖了一些；这可以在*没有循环的情况下*完成。

```
public static String pad(String source, char fill, int length, boolean right){
    if(source.length() > length) return source;
    char[] out = new char[length];
    if(right){
        System.arraycopy(source.toCharArray(), 0, out, 0, source.length());
        Arrays.fill(out, source.length(), length, fill);
    }else{
        int sourceOffset = length - source.length();
        System.arraycopy(source.toCharArray(), 0, out, sourceOffset, source.length());
        Arrays.fill(out, 0, sourceOffset, fill);
    }
    return new String(out);
} 
```

简单的测试方法：

```
public static void main(String... args){
    System.out.println("012345678901234567890123456789");
    System.out.println(pad("cats", ' ', 30, true));
    System.out.println(pad("cats", ' ', 30, false));
    System.out.println(pad("cats", ' ', 20, false));
    System.out.println(pad("cats", '$', 30, true));
    System.out.println(pad("too long for your own good, buddy", '#', 30, true));
} 
```

输出：

```
012345678901234567890123456789
cats                          
                          cats
                cats
cats$$$$$$$$$$$$$$$$$$$$$$$$$$
too long for your own good, buddy 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2017-09-14T07:25:35.407

所有**字符串**操作通常都需要**非常高效**——尤其是在处理大量数据时。我想要一些快速灵活的东西，类似于你在 plsql pad 命令中得到的东西。另外，我不想只为一件小事包含一个巨大的库。考虑到这些考虑，这些解决方案中没有一个是令人满意的。这是我提出的解决方案，具有最好的基准测试结果，如果有人可以改进它，请添加您的评论。

```
public static char[] lpad(char[] pStringChar, int pTotalLength, char pPad) {
    if (pStringChar.length < pTotalLength) {
        char[] retChar = new char[pTotalLength];
        int padIdx = pTotalLength - pStringChar.length;
        Arrays.fill(retChar, 0, padIdx, pPad);
        System.arraycopy(pStringChar, 0, retChar, padIdx, pStringChar.length);
        return retChar;
    } else {
        return pStringChar;
    }
} 
```

*   注意它是用 String.toCharArray() 调用的，结果可以用 new String((char[])result) 转换为 String。这样做的原因是，如果您应用多个操作，您可以在 char[] 上执行所有操作，而不是继续在格式之间进行转换 - 在幕后，String 存储为 char[]。如果这些操作包含在 String 类本身中，效率会提高一倍 - 速度和内存方面。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2017-11-30T08:06:18.967

使用此功能。

```
private String leftPadding(String word, int length, char ch) {
   return (length > word.length()) ? leftPadding(ch + word, length, ch) : word;
} 
```

如何使用？

```
leftPadding(month, 2, '0'); 
```

输出：01 02 03 04 .. 11 12

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2020-07-25T17:12:44.150

这是一个**高效**的实用程序类，用于Java 中的**left pad**、**right pad**、**center pad**和**零填充**字符串。

```
package com.example;

/**
 * Utility class for left pad, right pad, center pad and zero fill.
 */
public final class StringPadding {

    public static String left(String string, int length, char fill) {

        if (string.length() < length) {

            char[] chars = string.toCharArray();
            char[] output = new char[length];

            int delta = length - chars.length;

            for (int i = 0; i < length; i++) {
                if (i < delta) {
                    output[i] = fill;
                } else {
                    output[i] = chars[i - delta];
                }
            }

            return new String(output);
        }

        return string;
    }

    public static String right(String string, int length, char fill) {

        if (string.length() < length) {

            char[] chars = string.toCharArray();
            char[] output = new char[length];

            for (int i = 0; i < length; i++) {
                if (i < chars.length) {
                    output[i] = chars[i];
                } else {
                    output[i] = fill;
                }
            }

            return new String(output);
        }

        return string;
    }

    public static String center(String string, int length, char fill) {

        if (string.length() < length) {

            char[] chars = string.toCharArray();

            int delta = length - chars.length;
            int a = (delta % 2 == 0) ? delta / 2 : delta / 2 + 1;
            int b = a + chars.length;

            char[] output = new char[length];
            for (int i = 0; i < length; i++) {
                if (i < a) {
                    output[i] = fill;
                } else if (i < b) {
                    output[i] = chars[i - a];
                } else {
                    output[i] = fill;
                }
            }

            return new String(output);
        }

        return string;
    }

    public static String zerofill(String string, int length) {
        return left(string, length, '0');
    }

    private StringPadding() {
    }

    /**
     * For tests!
     */
    public static void main(String[] args) {

        String string = "123";
        char blank = ' ';

        System.out.println("left pad:    [" + StringPadding.left(string, 10, blank) + "]");
        System.out.println("right pad:   [" + StringPadding.right(string, 10, blank) + "]");
        System.out.println("center pad:  [" + StringPadding.center(string, 10, blank) + "]");
        System.out.println("zero fill:   [" + StringPadding.zerofill(string, 10) + "]");
    }
} 
```

这是输出：

```
left pad:    [       123]
right pad:   [123       ]
center pad:  [    123   ]
zero fill:   [0000000123] 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2017-08-31T21:49:38.423

Java oneliners，没有花哨的库。

```
// 6 characters padding example
String pad = "******";
// testcases for 0, 4, 8 characters
String input = "" | "abcd" | "abcdefgh" 
```

垫左，不要限制

```
result = pad.substring(Math.min(input.length(),pad.length())) + input;
results: "******" | "**abcd" | "abcdefgh" 
```

垫右，不要限制

```
result = input + pad.substring(Math.min(input.length(),pad.length()));
results: "******" | "abcd**" | "abcdefgh" 
```

垫左，限制垫长度

```
result = (pad + input).substring(input.length(), input.length() + pad.length());
results: "******" | "**abcd" | "cdefgh" 
```

垫右，限制垫长度

```
result = (input + pad).substring(0, pad.length());
results: "******" | "abcd**" | "abcdef" 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2019-08-13T18:11:37.573

**使用递归怎么样？下面给出的解决方案与所有 JDK 版本兼容，并且不需要外部库:)**

```
private static String addPadding(final String str, final int desiredLength, final String padBy) {
    String result = str;
    if (str.length() >= desiredLength) {
        return result;
    } else {
        result += padBy;
        return addPadding(result, desiredLength, padBy);
    }
} 
```

**注意**：此解决方案将附加填充，稍加调整即可为填充值添加前缀。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-05-06T04:17:57.723

**没有任何 API**的简单解决方案如下：

```
public String pad(String num, int len){
    if(len-num.length() <=0) return num;
    StringBuffer sb = new StringBuffer();
    for(i=0; i<(len-num.length()); i++){
        sb.append("0");
    }
    sb.append(num);
    return sb.toString();
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2019-09-19T18:58:20.360

对于那些拥有很长字符串的人来说，这是一个并行版本:-)

```
int width = 100;
String s = "129018";

CharSequence padded = IntStream.range(0,width)
            .parallel()
            .map(i->i-(width-s.length()))
            .map(i->i<0 ? '0' :s.charAt(i))
            .collect(StringBuilder::new, (sb,c)-> sb.append((char)c), (sb1,sb2)->sb1.append(sb2)); 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2012-01-19T12:24:53.450

一个简单的解决方案是：

```
package nl;
public class Padder {
    public static void main(String[] args) {
        String s = "123" ;
        System.out.println("#"+("     " + s).substring(s.length())+"#");
    }
} 
```

* * *

## 回答 #30

> 赞同：-2
> 
> 时间：2013-03-28T11:53:39.633

这怎么样

字符串为“hello”，所需的填充为 15，左填充为“0”

```
String ax="Hello";
while(ax.length() < 15) ax="0"+ax; 
```

# c# - 'ref' 和 'out' 关键字有什么区别？

> ID：388464
> 
> 赞同：971
> 
> 时间：2008-12-23T09:16:43.613
> 
> 标签：c#, reference, keyword, out, ref

我正在创建一个函数，我需要在其中传递一个对象，以便该函数可以修改它。有什么区别：

```
public void myFunction(ref MyClass someClass) 
```

和

```
public void myFunction(out MyClass someClass) 
```

我应该使用哪个，为什么？

* * *

## 回答 #1

> 赞同：1254
> 
> 时间：2008-12-23T09:18:03.860

`ref`告诉编译器对象在进入函数之前被初始化，而`out`告诉编译器对象将在函数内部被初始化。

所以while`ref`是双向的，`out`是out-only。

* * *

## 回答 #2

> 赞同：594
> 
> 时间：2008-12-23T12:40:41.767

`ref`修饰符意味着：

1.  该值已设置并且
2.  该方法可以读取和修改它。

`out`修饰符意味着：

1.  *该值未设置，并且在设置之前*无法由该方法读取。
2.  该方法*必须*在返回之前设置它。

* * *

## 回答 #3

> 赞同：152
> 
> 时间：2010-03-23T19:33:41.770

假设 Dom 出现在 Peter 的隔间，内容是关于 TPS 报告的备忘录。

如果 Dom 是一个 ref 参数，他将有一份备忘录的打印副本。

如果 Dom 是个吵架者，他会让 Peter 打印一份新的备忘录，让他随身携带。

* * *

## 回答 #4

> 赞同：65
> 
> 时间：2010-09-23T17:55:58.487

我将尝试解释：

我认为我们了解值类型如何正确工作？值类型是（int、long、struct 等）。当您将它们发送到没有 ref 命令的函数时，它会复制**数据**。您对函数中的数据所做的任何事情都只会影响副本，而不是原始数据。ref 命令发送 ACTUAL 数据，任何更改都会影响函数外的数据。

好的，进入令人困惑的部分，引用类型：

让我们创建一个引用类型：

```
List<string> someobject = new List<string>() 
```

当您新建*someobject*时，会创建两个部分：

1.  *保存someobject*数据的内存块。
2.  对该数据块的引用（指针）。

现在，当您将*someobject*发送到没有 ref 的方法时，它会复制**引用**指针，而不是数据。所以你现在有这个：

```
(outside method) reference1 => someobject
(inside method)  reference2 => someobject 
```

指向同一个对象的两个引用。如果您使用 reference2 修改某个对象的属性，它将影响 reference1 指向的相同数据 *。*

```
 (inside method)  reference2.Add("SomeString");
 (outside method) reference1[0] == "SomeString"   //this is true 
```

如果您将 reference2 清空或将其指向新数据，则不会影响 reference1 也不会影响 reference1 指向的数据。

```
(inside method) reference2 = new List<string>();
(outside method) reference1 != null; reference1[0] == "SomeString" //this is true

The references are now pointing like this:
reference2 => new List<string>()
reference1 => someobject 
```

现在，当您通过 ref将*someobject发送给方法时会发生什么？*对*someobject*的**实际引用**被发送到该方法。所以你现在只有一个对数据的引用：

 *```
(outside method) reference1 => someobject;
(inside method)  reference1 => someobject; 
```

但是，这是什么意思？它的作用与不通过 ref 发送 someobject 完全相同，除了两个主要的事情：

1）当您将方法内的引用清空时，它将使方法外的引用清空。

```
 (inside method)  reference1 = null;
 (outside method) reference1 == null;  //true 
```

2) 您现在可以将引用指向一个完全不同的数据位置，函数外部的引用现在将指向新的数据位置。

```
 (inside method)  reference1 = new List<string>();
 (outside method) reference1.Count == 0; //this is true 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2008-12-23T09:17:32.783

[ref 是 in**和**out](http://luisabreu.wordpress.com/2010/09/02/parameters-by-reference/)。

`out`只要能满足您的要求，您就应该优先使用它。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2016-04-01T18:31:04.407

## 出去：

在 C# 中，一个方法只能返回一个值。如果你想返回多个值，你可以使用 out 关键字。out 修饰符以引用返回的形式返回。最简单的答案是关键字“out”用于从方法中获取值。

1.  您不需要在调用函数中初始化值。
2.  必须在被调用函数中赋值，否则编译器会报错。

## 参考：

在 C# 中，当您将 int、float、double 等值类型作为参数传递给方法参数时，它是按值传递的。因此，如果修改参数值，不会影响方法调用中的参数。但是如果你用“ref”关键字标记参数，它会反映在实际变量中。

1.  您需要在调用函数之前初始化变量。
2.  不必为方法中的 ref 参数分配任何值。如果不改变值，有什么必要将其标记为“ref”？

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-05-19T13:35:17.917

扩展狗，猫的例子。带有 ref 的第二个方法更改调用者引用的对象。因此“猫”！

```
 public static void Foo()
    {
        MyClass myObject = new MyClass();
        myObject.Name = "Dog";
        Bar(myObject);
        Console.WriteLine(myObject.Name); // Writes "Dog". 
        Bar(ref myObject);
        Console.WriteLine(myObject.Name); // Writes "Cat". 
    }

    public static void Bar(MyClass someObject)
    {
        MyClass myTempObject = new MyClass();
        myTempObject.Name = "Cat";
        someObject = myTempObject;
    }

    public static void Bar(ref MyClass someObject)
    {
        MyClass myTempObject = new MyClass();
        myTempObject.Name = "Cat";
        someObject = myTempObject;
    } 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2014-12-06T19:21:51.323

**ref**表示 ref 参数中的值已经设置，方法可以读取和修改它。使用 ref 关键字相当于说调用者负责初始化参数的值。

* * *

**out**告诉编译器对象的初始化是函数的责任，函数必须分配给 out 参数。不允许将其保留为未分配状态。

[https://www.codemaggot.com/ref-and-out-keywords/](https://www.codemaggot.com/ref-and-out-keywords/)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2014-02-10T16:29:27.487

`ref`并且`out`行为相似，除了以下差异。

*   `ref`变量必须在使用前初始化。`out`变量可以不赋值使用
*   `out`使用它的函数必须将参数视为未分配的值。因此，我们可以`out`在调用代码中使用初始化参数，但函数执行时该值会丢失。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-12-25T21:16:51.400

对于那些通过例子来学习的人（比如我），这就是[Anthony Kolesov 所说的](https://stackoverflow.com/a/388781/653939)。

我已经创建了一些 ref、out 和其他的最小示例来说明这一点。我没有介绍最佳实践，只是举例来了解差异。

[https://gist.github.com/2upmedia/6d98a57b68d849ee7091](https://gist.github.com/2upmedia/6d98a57b68d849ee7091)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-12-23T10:57:23.423

由于您传递的是引用类型（类），因此无需使用`ref`，因为默认情况下只传递对实际对象的**引用**，因此您总是更改引用后面的对象。

例子：

```
public void Foo()
{
    MyClass myObject = new MyClass();
    myObject.Name = "Dog";
    Bar(myObject);
    Console.WriteLine(myObject.Name); // Writes "Cat".
}

public void Bar(MyClass someObject)
{
    someObject.Name = "Cat";
} 
```

`ref`只要您传入一个类，如果您想更改方法中的对象，您就不必使用它。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-12-23T13:40:23.143

“贝克”

那是因为第一个将您的字符串引用更改为指向“贝克”。更改引用是可能的，因为您通过 ref 关键字（=> 对字符串引用的引用）传递了它。第二个调用获取对字符串的引用的副本。

字符串起初看起来有些特别。但是字符串只是一个参考类，如果你定义

```
string s = "Able"; 
```

那么 s 是对包含文本“Able”的字符串类的引用！通过对同一变量的另一个赋值

```
s = "Baker"; 
```

不会更改原始字符串，只是创建一个新实例并让 s 指向该实例！

您可以使用以下小代码示例进行尝试：

```
string s = "Able";
string s2 = s;
s = "Baker";
Console.WriteLine(s2); 
```

你能指望什么？您将得到的仍然是“Able”，因为您只是将 s 中的引用设置为另一个实例，而 s2 指向原始实例。

编辑：字符串也是不可变的，这意味着根本没有修改现有字符串实例的方法或属性（您可以尝试在文档中找到一个，但您不会找到任何 :-)）。所有字符串操作方法都返回一个新的字符串实例！（这就是为什么在使用 StringBuilder 类时通常会获得更好的性能）

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2019-11-26T07:49:35.183

**对于那些寻找简洁答案的人。**

> `ref`和关键字都`out`用于传递 - `reference`。
> 
> * * *
> 
> 关键字的变量`ref`必须有一个值或必须引用一个对象或`null` **在**其传递之前。
> 
> * * *
> 
> 与 不同`ref`的是，关键字的变量`out`必须有值或必须引用对象或`null` **在**其传递之后以及在传递**之前**不需要有值或引用对象。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2014-10-25T16:57:43.860

**Out：** return 语句可用于从函数中仅返回一个值。但是，使用输出参数，您可以从函数返回两个值。输出参数与引用参数类似，不同之处在于它们将数据从方法中传输出来而不是传入方法中。

以下示例说明了这一点：

```
using System;

namespace CalculatorApplication
{
   class NumberManipulator
   {
      public void getValue(out int x )
      {
         int temp = 5;
         x = temp;
      }

      static void Main(string[] args)
      {
         NumberManipulator n = new NumberManipulator();
         /* local variable definition */
         int a = 100;

         Console.WriteLine("Before method call, value of a : {0}", a);

         /* calling a function to get the value */
         n.getValue(out a);

         Console.WriteLine("After method call, value of a : {0}", a);
         Console.ReadLine();

      }
   }
} 
```

**ref：** 引用参数是对变量内存位置的引用。通过引用传递参数时，与值参数不同，不会为这些参数创建新的存储位置。引用参数表示与提供给方法的实际参数相同的内存位置。

在 C# 中，使用 ref 关键字声明引用参数。以下示例演示了这一点：

```
using System;
namespace CalculatorApplication
{
   class NumberManipulator
   {
      public void swap(ref int x, ref int y)
      {
         int temp;

         temp = x; /* save the value of x */
         x = y;   /* put y into x */
         y = temp; /* put temp into y */
       }

      static void Main(string[] args)
      {
         NumberManipulator n = new NumberManipulator();
         /* local variable definition */
         int a = 100;
         int b = 200;

         Console.WriteLine("Before swap, value of a : {0}", a);
         Console.WriteLine("Before swap, value of b : {0}", b);

         /* calling a function to swap the values */
         n.swap(ref a, ref b);

         Console.WriteLine("After swap, value of a : {0}", a);
         Console.WriteLine("After swap, value of b : {0}", b);

         Console.ReadLine();

      }
   }
} 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2015-03-15T08:49:40.000

ref 和 out 就像 C++ 中的引用传递和指针传递一样工作。

对于 ref，参数必须声明和初始化。

对于 out，参数必须声明，但可能会或可能不会被初始化

```
 double nbr = 6; // if not initialized we get error
        double dd = doit.square(ref nbr);

        double Half_nbr ; // fine as passed by out, but inside the calling  method you initialize it
        doit.math_routines(nbr, out Half_nbr); 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2017-05-29T16:10:11.487

**创作时间：**

(1)我们创建调用方法`Main()`

(2) 它创建一个 List 对象（它是一个引用类型对象）并将其存储在变量中`myList`。

```
public sealed class Program 
{
    public static Main() 
    {
        List<int> myList = new List<int>(); 
```

**在运行时：**

(3) 运行时在 #00 的堆栈上分配内存，足够宽以存储地址（#00 = `myList`，因为变量名实际上只是内存位置的别名）

（4）运行时在内存位置#FF的堆上创建一个列表对象（所有这些地址都是为了举例）

(5) 然后运行时将对象的起始地址 #FF 存储在 #00 处（或者换句话说，将 List 对象的引用存储在指针中`myList`）

**返回创作时间：**

(6) 然后我们将 List 对象作为参数`myParamList`传递给被调用的方法`modifyMyList`，并为其分配一个新的 List 对象

```
List<int> myList = new List<int>();

List<int> newList = ModifyMyList(myList)

public List<int> ModifyMyList(List<int> myParamList){
     myParamList = new List<int>();
     return myParamList;
} 
```

**在运行时：**

(7) 运行时启动被调用方法的调用例程，并作为其中的一部分检查参数的类型。

(8) 找到引用类型后，它会在#04 的堆栈上分配内存，用于给参数变量起别名`myParamList`。

(9) 然后它也将值#FF 存储在其中。

(10) 运行时在内存位置#004的堆上创建一个list对象，并用这个值替换#04中的#FF（或者在这个方法中取消引用原来的List对象并指向新的List对象）

#00 中的地址不会改变，并保留对#FF 的引用（或原始`myList`指针不受影响）。

* * *

***ref***关键字是一个编译器指令，用于跳过 (8) 和 (9) 的运行时代码的生成，这意味着不会为方法参数分配堆。它将使用原始的#00 指针对#FF 处的对象进行操作。如果原始指针未初始化，则运行时将停止抱怨它无法继续，因为变量未初始化

***out***关键字是一个编译器指令，它与 ref 几乎相同，只是在 (9) 和 (10) 处稍作修改。编译器希望参数未初始化，并将继续使用 (8)、(4) 和 (5) 在堆上创建对象并将其起始地址存储在参数变量中。不会抛出未初始化的错误，并且之前存储的任何引用都将丢失。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2019-08-14T14:52:33.987

除了允许您将其他人的变量重新分配给类的不同实例、返回多个值等，**使用`ref`或`out`让其他人知道您需要他们做什么以及您打算如何处理他们提供的变量**

*   您**不需要** `ref`，或者`out`您要做的只是修改在参数中传递的实例*内*的内容。`MyClass``someClass`

    *   调用方法将看到更改，例如`someClass.Message = "Hello World"`您是否使用或什么都不使用`ref``out`
    *   写入`someClass = new MyClass()`inside只`myFunction(someClass)`换出方法`someClass`范围内的对象`myFunction`。调用方法仍然知道`MyClass`它创建并传递给您的方法的原始实例
*   您**需要** `ref`或者`out`如果您计划将其换成`someClass`一个全新的对象并希望调用方法看到您的更改

    *   `someClass = new MyClass()`在内部写入`myFunction(out someClass)`会更改调用方法看到的对象`myFunction`

## 存在其他程序员

他们想知道你将如何处理他们的数据。想象一下，您正在编写一个将被数百万开发人员使用的库。当他们调用您的方法时，您希望他们知道您将如何处理他们的变量

*   使用`ref`声明“在调用我的方法时传递分配给某个值的变量。请注意，我可能会在我的方法过程中完全将其更改为其他内容。不要期望您的变量指向旧对象当我完成”

*   Using`out`声明“将占位符变量传递给我的方法。它是否有值无关紧要；编译器会强制我将其分配给新值。我绝对保证您所指向的对象在你调用我的方法之前的变量，在我完成时*会*有所不同

## 顺便说一句，在 C#7.2 中也有一个`in`修饰符

这可以防止该方法将传入的实例换成不同的实例。可以将其想象为对数百万开发人员说“将您的原始变量引用传递给我，我保证不会将您精心制作的数据换成其他东西”。`in`有一些特殊性，在某些情况下，例如可能需要隐式转换以使您的 short 与编译器兼容，`in int`编译器将暂时生成一个 int，将您的 short 扩大到它，通过引用传递它并完成。它可以做到这一点，因为你已经宣布你不会搞砸它。

* * *

微软使用`.TryParse`数字类型的方法做到了这一点：

```
int i = 98234957;
bool success = int.TryParse("123", out i); 
```

通过标记参数，因为`out`他们在这里积极声明“我们*肯定*会将您精心设计的 98234957 值更改为其他值”

当然，对于解析值类型之类的事情，他们有点不得不这样做，因为如果不允许解析方法将值类型换成其他东西，它就不会很好地工作。但是想象一下，有些方法中有一些虚构的方法您正在创建的库：

```
public void PoorlyNamedMethod(out SomeClass x) 
```

您可以看到它是一个`out`，因此您可以知道，如果您花费数小时处理数字，则可以创建完美的 SomeClass：

```
SomeClass x = SpendHoursMakingMeAPerfectSomeClass();
//now give it to the library
PoorlyNamedMethod(out x); 
```

好吧，那是浪费时间，花所有这些时间来制作完美的课程。它肯定会被扔掉，取而代之的是PoorlyNamedMethod

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2019-10-10T09:46:34.863

为了说明许多出色的解释，我开发了以下控制台应用程序：

```
using System;
using System.Collections.Generic;

namespace CSharpDemos
{
  class Program
  {
    static void Main(string[] args)
    {
      List<string> StringList = new List<string> { "Hello" };
      List<string> StringListRef = new List<string> { "Hallo" };

      AppendWorld(StringList);
      Console.WriteLine(StringList[0] + StringList[1]);

      HalloWelt(ref StringListRef);
      Console.WriteLine(StringListRef[0] + StringListRef[1]);

      CiaoMondo(out List<string> StringListOut);
      Console.WriteLine(StringListOut[0] + StringListOut[1]);
    }

    static void AppendWorld(List<string> LiStri)
    {
      LiStri.Add(" World!");
      LiStri = new List<string> { "¡Hola", " Mundo!" };
      Console.WriteLine(LiStri[0] + LiStri[1]);
    }

    static void HalloWelt(ref List<string> LiStriRef)
     { LiStriRef = new List<string> { LiStriRef[0], " Welt!" }; }

    static void CiaoMondo(out List<string> LiStriOut)
     { LiStriOut = new List<string> { "Ciao", " Mondo!" }; }
   }
}
/*Output:
¡Hola Mundo!
Hello World!
Hallo Welt!
Ciao Mondo!
*/ 
```

*   `AppendWorld``StringList`: 一个named的副本`LiStri`通过了。在方法开始时，此副本引用原始列表，因此可用于修改此列表。稍后在方法中`LiStri`引用另一个`List<string>`不影响原始列表的对象。

*   `HalloWelt`:`LiStriRef`是已经初始化的别名 `ListStringRef`。传递的`List<string>`对象用于初始化一个新对象，因此`ref`是必要的。

*   `CiaoMondo`:`LiStriOut`是一个别名，`ListStringOut`必须初始化。

所以，如果一个方法只是修改了传递变量引用的对象，编译器不会让你使用`out`，你也不应该使用`ref`，因为它不会混淆编译器而是代码的读者。如果该方法将使传递的参数引用另一个对象，请使用`ref`已初始化的对象和`out`必须为传递的参数初始化新对象的方法。除此之外，`ref`行为`out`相同。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2013-06-20T16:06:52.977

它们几乎相同——唯一的区别是作为输出参数传递的变量不需要初始化，使用 ref 参数的方法必须将其设置为某个值。

```
int x;    Foo(out x); // OK 
int y;    Foo(ref y); // Error 
```

Ref 参数用于可能被修改的数据，out 参数用于作为函数（例如 int.TryParse）的附加输出的数据，这些数据已经在使用返回值。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2015-07-26T23:22:38.197

Ref： ref 关键字用于将参数作为引用传递。这意味着当该参数的值在方法中更改时，它会反映在调用方法中。使用 ref 关键字传递的参数必须在调用方法中初始化，然后才能传递给被调用方法。

Out：out 关键字也用于传递参数，如 ref 关键字，但参数可以在不分配任何值的情况下传递。使用 out 关键字传递的参数必须在被调用方法中初始化，然后才能返回调用方法。

```
public class Example
{
 public static void Main() 
 {
 int val1 = 0; //must be initialized 
 int val2; //optional

 Example1(ref val1);
 Console.WriteLine(val1); 

 Example2(out val2);
 Console.WriteLine(val2); 
 }

 static void Example1(ref int value) 
 {
 value = 1;
 }
 static void Example2(out int value) 
 {
 value = 2; 
 }
}

/* Output     1     2 
```

方法重载中的引用和输出

ref 和 out 不能同时用于方法重载。但是， ref 和 out 在运行时的处理方式不同，但在编译时它们的处理方式相同（CLR 在为 ref 和 out 创建 IL 时不会区分两者）。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2013-06-25T11:18:27.427

下面我展示了一个同时使用**Ref**和**out**的示例。现在，你们都将被清除关于 ref 和 out 的信息。

在下面提到的示例中，当我评论**//myRefObj = new myClass { Name = "ref outside called!! " };** 行，将收到一条错误**消息“Use of unassigned local variable 'myRefObj'”**，但**out**中没有此类错误。

**在哪里使用 Ref**：当我们使用 in 参数调用过程时，相同的参数将用于存储该过程的输出。

**在哪里使用 Out：**当我们调用没有 in 参数的过程时，将使用相同的参数从该过程返回值。还要注意输出

```
public partial class refAndOutUse : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        myClass myRefObj;
        myRefObj = new myClass { Name = "ref outside called!!  <br/>" };
        myRefFunction(ref myRefObj);
        Response.Write(myRefObj.Name); //ref inside function

        myClass myOutObj;
        myOutFunction(out myOutObj);
        Response.Write(myOutObj.Name); //out inside function
    }

    void myRefFunction(ref myClass refObj)
    {
        refObj.Name = "ref inside function <br/>";
        Response.Write(refObj.Name); //ref inside function
    }
    void myOutFunction(out myClass outObj)
    {
        outObj = new myClass { Name = "out inside function <br/>" }; 
        Response.Write(outObj.Name); //out inside function
    }
}

public class myClass
{
    public string Name { get; set; }
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-11-13T09:17:21.130

```
 public static void Main(string[] args)
    {
        //int a=10;
        //change(ref a);
        //Console.WriteLine(a);
        // Console.Read();

        int b;
        change2(out b);
        Console.WriteLine(b);
        Console.Read();
    }
    // static void change(ref int a)
    //{
    //    a = 20;
    //}

     static void change2(out int b)
     {
         b = 20;
     } 
```

您可以检查此代码，当您使用“ref”时，它将向您描述其完全不同之处，这意味着您已经初始化了该 int/string

但是当您使用“out”时，它在两种情况下都有效，无论您是否初始化该 int/string，但您必须在该函数中初始化该 int/string

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2021-05-29T11:25:45.507

我想举例说明两个主要区别：

1.  `ref`并`out`通过引用传递，hense；

```
 class Program
    {
        public static void Main(string[] args)
        {
            var original = new ObjectWithMememberList(3);
            Console.WriteLine(original.MyList.Capacity); // 3
            ChangeList(original.MyList);
            Console.WriteLine(original.MyList.Capacity); // 3
        }

        static void ChangeList(List<int> vr)
        {
            vr = new List<int>(2);
        }
} 
```

但：

```
 class Program
    {
        public static void Main(string[] args)
        {
            var original = new ObjectWithMememberList(3);
            Console.WriteLine(original.MyList.Capacity); // 3
            ChangeList(ref original.MyList);
            Console.WriteLine(original.MyList.Capacity); // 2
        }

        static void ChangeList(ref List<int> vr)
        {
            vr = new List<int>(2);
        }
} 
```

和一样`out`。2.`ref`参数必须是可赋值的变量。感觉：

```
ChangeList(ref new List<int>()); // Compile Error [might not be initialized before accessing] 
```

但：

```
List<int> xs;
ChangeList(out xs); // Compiles 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-02-11T22:51:21.360

`ref`从接收参数的方法的角度来看，和之间的区别在于`out`C# 要求方法必须在返回之前写入每个`out`参数，并且不能对这样的参数做任何事情，除了将其作为`out`参数传递或写入它, 直到它作为`out`参数传递给另一个方法或直接写入。请注意，其他一些语言没有这样的要求；在 C# 中使用参数声明的虚拟或接口方法`out`可以用另一种语言覆盖，该语言不对此类参数施加任何特殊限制。

从调用者的角度来看，在许多情况下，C# 会假设当调用带有`out`参数的方法时，会导致传递的变量在没有被读取的情况下被写入。当调用用其他语言编写的方法时，这种假设可能不正确。例如：

```
struct MyStruct
{
   ...
   myStruct(IDictionary<int, MyStruct> d)
   {
     d.TryGetValue(23, out this);
   }
} 
```

如果`myDictionary`识别出`IDictionary<TKey,TValue>`用 C# 以外的语言编写的实现，即使`MyStruct s = new MyStruct(myDictionary);`看起来像一个赋值，它也可能保持`s`不变。

请注意，用 VB.NET 编写的构造函数与 C# 中的构造函数不同，它不会假设调用的方法是否会修改任何`out`参数，并且会无条件地清除所有字段。上面提到的奇怪行为不会发生在完全用 VB 或完全用 C# 编写的代码中，但会在用 C# 编写的代码调用用 VB.NET 编写的方法时发生。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2016-12-05T09:57:33.137

如果要将参数作为 ref 传递，则应在将参数传递给函数之前对其进行初始化，否则编译器本身将显示错误。但在 out 参数的情况下，您无需在将对象参数传递给之前初始化它方法。您可以在调用方法本身中初始化对象。

* * *

## 回答 #26

> 赞同：-3
> 
> 时间：2010-04-14T23:15:39.813

请注意，在函数内部传递的引用参数是直接处理的。

例如，

```
 public class MyClass
    {
        public string Name { get; set; }
    }

    public void Foo()
    {
        MyClass myObject = new MyClass();
        myObject.Name = "Dog";
        Bar(myObject);
        Console.WriteLine(myObject.Name); // Writes "Dog".
    }

    public void Bar(MyClass someObject)
    {
        MyClass myTempObject = new MyClass();
        myTempObject.Name = "Cat";
        someObject = myTempObject;
    } 
```

这将写狗，而不是猫。因此，您应该直接在 someObject 上工作。

* * *

## 回答 #27

> 赞同：-4
> 
> 时间：2011-12-08T18:36:51.027

我可能不太擅长这个，但是字符串（即使它们在技术上是引用类型并且存在于堆上）肯定是按值传递的，而不是引用？

```
 string a = "Hello";

        string b = "goodbye";

        b = a; //attempt to make b point to a, won't work.

        a = "testing";

        Console.WriteLine(b); //this will produce "hello", NOT "testing"!!!! 
```

这就是为什么您需要 ref 如果您希望更改存在于创建它们的函数范围之外，否则您不会传递引用。

据我所知，您只需要结构/值类型和字符串本身的 ref，因为字符串是一种假装它是但不是值类型的引用类型。

不过，我在这里可能完全错了，我是新手。

# asp.net - 如何从（对象发送者，ListViewItemEventArgs e）投射对象

> ID：388468
> 
> 赞同：5
> 
> 时间：2008-12-23T09:18:17.883
> 
> 标签：asp.net, listview

我将 ListView 控件与以下数据源一起使用`List<MyObject>`

在我的 listview 控件上，我有一个 OnItemDataBound

我的问题是如何获取 MyObject 的当前值。即 myObj[5].FirstName

protected void ItemsListViewDataBound(object sender, ListViewItemEventArgs e) { // 我想在这里进行某种类型的转换

}

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-23T09:44:37.440

```
protected void MyListView_DataBind(object sender, ListViewItemEventArgs e){
  if(e.Item.ItemType == ListViewItemType.DataItem){
    MyObject p = (MyObject)((ListViewDataItem)e.Item).DataItem;
  }
} 
```

您需要进行类型检查，以免在处理标题项目时尝试进行强制转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T09:53:36.893

这可能会有所帮助：

```
void listview1_ItemDataBound(object sender, ListViewItemEventArgs e)
{
    ListViewItem listItem = (ListViewItem)e.Item;
    //or 
    ListViewDataItem listDataItem = (ListViewDataItem)e.Item;

    Label mylabelinItem = listItem.FindControl("labelId") as Label;
} 
```

# c# - Stacktrace信息保存原始源路径

> ID：388470
> 
> 赞同：14
> 
> 时间：2008-12-23T09:19:08.413
> 
> 标签：c#, .net, stack-trace

我正在使用 C#.net 进行应用程序开发。

要记录和调试异常，我使用堆栈跟踪。

我在另一台机器上执行了我的应用程序，但是当发生错误时，它指的是我的开发机器的路径。

```
Ex:   D:\Projects\xyz.CS line no :12 _Error_message_here. 
```

为什么即使我在另一台机器上运行应用程序，它也会追溯到我的*开发机器路径上的路径？*

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-23T09:27:06.633

原始编译路径存储在 PDB 文件中的调试信息中。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-23T11:19:23.850

因为它告诉您在*源代码*中哪里可以找到问题。所以当你看到这个时，你可以到你的机器上打开报告的文件（例如“D:\Projects\xyz.cs”），转到报告的行（例如12）并修复问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-25T13:36:40.447

## 解释

当您进行调试构建时，它会在编译文件中包含源信息以启用调试，例如暂停、跳过等。

## 解决方案

如果您不希望包含源信息，请执行 Release 构建并将其部署到另一台计算机。

# c# - 如何从 ASP.NET MVC 中的枚举创建下拉列表？

> ID：388483
> 
> 赞同：718
> 
> 时间：2008-12-23T09:25:43.313
> 
> 标签：c#, asp.net, asp.net-mvc

我正在尝试使用`Html.DropDownList`扩展方法，但无法弄清楚如何将它与枚举一起使用。

假设我有一个这样的枚举：

```
public enum ItemTypes
{
    Movie = 1,
    Game = 2,
    Book = 3
} 
```

如何使用`Html.DropDownList`扩展方法创建包含这些值的下拉列表？

还是我最好的选择是简单地创建一个 for 循环并手动创建 Html 元素？

* * *

## 回答 #1

> 赞同：885
> 
> 时间：2009-03-29T09:11:16.723

## 对于 MVC v5.1 使用 Html.EnumDropDownListFor

```
@Html.EnumDropDownListFor(
    x => x.YourEnumField,
    "Select My Type", 
    new { @class = "form-control" }) 
```

* * *

## 对于 MVC v5，使用 EnumHelper

```
@Html.DropDownList("MyType", 
   EnumHelper.GetSelectList(typeof(MyType)) , 
   "Select My Type", 
   new { @class = "form-control" }) 
```

* * *

## 对于 MVC 5 及更低版本

我将 Rune 的答案转换为扩展方法：

```
namespace MyApp.Common
{
    public static class MyExtensions{
        public static SelectList ToSelectList<TEnum>(this TEnum enumObj)
            where TEnum : struct, IComparable, IFormattable, IConvertible
        {
            var values = from TEnum e in Enum.GetValues(typeof(TEnum))
                select new { Id = e, Name = e.ToString() };
            return new SelectList(values, "Id", "Name", enumObj);
        }
    }
} 
```

这允许您编写：

```
ViewData["taskStatus"] = task.Status.ToSelectList(); 
```

经过`using MyApp.Common`

* * *

## 回答 #2

> 赞同：370
> 
> 时间：2011-03-10T03:27:31.357

我知道我迟到了，但我想你可能会发现这个变体很有用，因为这个变体还允许你在下拉列表中使用描述性字符串而不是枚举常量。为此，请使用 [System.ComponentModel.Description] 属性装饰每个枚举条目。

例如：

```
public enum TestEnum
{
  [Description("Full test")]
  FullTest,

  [Description("Incomplete or partial test")]
  PartialTest,

  [Description("No test performed")]
  None
} 
```

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web.Mvc;
using System.Web.Mvc.Html;
using System.Reflection;
using System.ComponentModel;
using System.Linq.Expressions;

 ...

 private static Type GetNonNullableModelType(ModelMetadata modelMetadata)
    {
        Type realModelType = modelMetadata.ModelType;

        Type underlyingType = Nullable.GetUnderlyingType(realModelType);
        if (underlyingType != null)
        {
            realModelType = underlyingType;
        }
        return realModelType;
    }

    private static readonly SelectListItem[] SingleEmptyItem = new[] { new SelectListItem { Text = "", Value = "" } };

    public static string GetEnumDescription<TEnum>(TEnum value)
    {
        FieldInfo fi = value.GetType().GetField(value.ToString());

        DescriptionAttribute[] attributes = (DescriptionAttribute[])fi.GetCustomAttributes(typeof(DescriptionAttribute), false);

        if ((attributes != null) && (attributes.Length > 0))
            return attributes[0].Description;
        else
            return value.ToString();
    }

    public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression)
    {
        return EnumDropDownListFor(htmlHelper, expression, null);
    }

    public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression, object htmlAttributes)
    {
        ModelMetadata metadata = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
        Type enumType = GetNonNullableModelType(metadata);
        IEnumerable<TEnum> values = Enum.GetValues(enumType).Cast<TEnum>();

        IEnumerable<SelectListItem> items = from value in values
            select new SelectListItem
            {
                Text = GetEnumDescription(value),
                Value = value.ToString(),
                Selected = value.Equals(metadata.Model)
            };

        // If the enum is nullable, add an 'empty' item to the collection
        if (metadata.IsNullableValueType)
            items = SingleEmptyItem.Concat(items);

        return htmlHelper.DropDownListFor(expression, items, htmlAttributes);
    } 
```

然后，您可以在您的视图中执行此操作：

```
@Html.EnumDropDownListFor(model => model.MyEnumProperty) 
```

希望这对你有帮助！

** 2014 年 1 月 23 日编辑：微软刚刚发布了 MVC 5.1，它现在具有 EnumDropDownListFor 功能。遗憾的是，它似乎不尊重 [Description] 属性，因此上面的代码仍然有效。请参阅Microsoft 的 MVC 5.1 发行说明中的[​​ Enum 部分。](https://docs.microsoft.com/en-us/aspnet/mvc/overview/releases/mvc51-release-notes#Enum)

**更新：虽然它确实支持[Display](https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.dataannotations.displayattribute)属性`[Display(Name = "Sample")]`，所以可以使用它。**

[更新 - 刚刚注意到这一点，代码看起来像这里代码的扩展版本：[https ://blogs.msdn.microsoft.com/stuartleeks/2010/05/21/asp-net-mvc-creating-a- dropdownlist-helper-for-enums/](https://blogs.msdn.microsoft.com/stuartleeks/2010/05/21/asp-net-mvc-creating-a-dropdownlist-helper-for-enums/)，并添加了一些内容。如果是这样，归属似乎是公平的;-)]

* * *

## 回答 #3

> 赞同：213
> 
> 时间：2014-03-10T08:35:01.930

在**[ASP.NET MVC 5.1](https://docs.microsoft.com/en-us/aspnet/mvc/overview/releases/mvc51-release-notes#Enum)**中，他们添加了`EnumDropDownListFor()`帮助程序，因此不需要自定义扩展：

*型号*：

```
public enum MyEnum
{
    [Display(Name = "First Value - desc..")]
    FirstValue,
    [Display(Name = "Second Value - desc...")]
    SecondValue
} 
```

*查看*：

```
@Html.EnumDropDownListFor(model => model.MyEnum) 
```

*使用标签助手（ASP.NET MVC 6）*：

```
<select asp-for="@Model.SelectedValue" asp-items="Html.GetEnumSelectList<MyEnum>()"> 
```

* * *

## 回答 #4

> 赞同：135
> 
> 时间：2009-01-11T11:48:20.517

我碰到了同样的问题，发现了这个问题，并认为Ash提供的解决方案不是我想要的；与内置`Html.DropDownList()`函数相比，必须自己创建 HTML 意味着灵活性较低。

原来 C#3 等使这很容易。我有一个`enum`叫`TaskStatus`：

```
var statuses = from TaskStatus s in Enum.GetValues(typeof(TaskStatus))
               select new { ID = s, Name = s.ToString() };
ViewData["taskStatus"] = new SelectList(statuses, "ID", "Name", task.Status); 
```

这创建了一个很好的 ol' `SelectList`，可以像您在视图中习惯的那样使用：

```
<td><b>Status:</b></td><td><%=Html.DropDownList("taskStatus")%></td></tr> 
```

匿名类型和 LINQ 使这更加优雅恕我直言。无意冒犯，阿什。:)

* * *

## 回答 #5

> 赞同：67
> 
> 时间：2013-04-18T17:18:17.837

这是一个更好的封装解决方案：

[https://www.spicelogic.com/Blog/enum-dropdownlistfor-asp-net-mvc-5](https://www.spicelogic.com/Blog/enum-dropdownlistfor-asp-net-mvc-5)

说这里是你的模型：

![在此处输入图像描述](https://i.stack.imgur.com/LhPGx.png)

**样品用法：**

![在此处输入图像描述](https://i.stack.imgur.com/4YeEG.png)

**生成的用户界面：** ![在此处输入图像描述](https://i.stack.imgur.com/3eEC0.png)

**并生成 HTML**

![在此处输入图像描述](https://i.stack.imgur.com/QESvd.png)

**助手扩展源代码快照：**

![在此处输入图像描述](https://i.stack.imgur.com/m3loZ.png)

您可以从我提供的链接下载示例项目。

编辑：这是代码：

```
public static class EnumEditorHtmlHelper
{
    /// <summary>
    /// Creates the DropDown List (HTML Select Element) from LINQ 
    /// Expression where the expression returns an Enum type.
    /// </summary>
    /// <typeparam name="TModel">The type of the model.</typeparam>
    /// <typeparam name="TProperty">The type of the property.</typeparam>
    /// <param name="htmlHelper">The HTML helper.</param>
    /// <param name="expression">The expression.</param>
    /// <returns></returns>
    public static MvcHtmlString DropDownListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper,
        Expression<Func<TModel, TProperty>> expression) 
        where TModel : class
    {
        TProperty value = htmlHelper.ViewData.Model == null 
            ? default(TProperty) 
            : expression.Compile()(htmlHelper.ViewData.Model);
        string selected = value == null ? String.Empty : value.ToString();
        return htmlHelper.DropDownListFor(expression, createSelectList(expression.ReturnType, selected));
    }

    /// <summary>
    /// Creates the select list.
    /// </summary>
    /// <param name="enumType">Type of the enum.</param>
    /// <param name="selectedItem">The selected item.</param>
    /// <returns></returns>
    private static IEnumerable<SelectListItem> createSelectList(Type enumType, string selectedItem)
    {
        return (from object item in Enum.GetValues(enumType)
                let fi = enumType.GetField(item.ToString())
                let attribute = fi.GetCustomAttributes(typeof (DescriptionAttribute), true).FirstOrDefault()
                let title = attribute == null ? item.ToString() : ((DescriptionAttribute) attribute).Description
                select new SelectListItem
                  {
                      Value = item.ToString(), 
                      Text = title, 
                      Selected = selectedItem == item.ToString()
                  }).ToList();
    }
} 
```

* * *

## 回答 #6

> 赞同：50
> 
> 时间：2010-11-03T17:39:10.213

Html.DropDownListFor 只需要一个 IEnumerable，因此 Prise 的解决方案的替代方案如下。这将允许您简单地编写：

```
@Html.DropDownListFor(m => m.SelectedItemType, Model.SelectedItemType.ToSelectList()) 
```

[其中 SelectedItemType 是您模型上的 ItemTypes 类型字段，并且您的模型是非空的]

此外，您实际上不需要泛化扩展方法，因为您可以使用 enumValue.GetType() 而不是 typeof(T)。

编辑：在这里也集成了 Simon 的解决方案，并包含了 ToDescription 扩展方法。

```
public static class EnumExtensions
{
    public static IEnumerable<SelectListItem> ToSelectList(this Enum enumValue)
    {
        return from Enum e in Enum.GetValues(enumValue.GetType())
               select new SelectListItem
               {
                   Selected = e.Equals(enumValue),
                   Text = e.ToDescription(),
                   Value = e.ToString()
               };
    }

    public static string ToDescription(this Enum value)
    {
        var attributes = (DescriptionAttribute[])value.GetType().GetField(value.ToString()).GetCustomAttributes(typeof(DescriptionAttribute), false);
        return attributes.Length > 0 ? attributes[0].Description : value.ToString();
    }
} 
```

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2010-10-26T17:13:06.190

因此，如果您正在寻找简单易用的扩展功能，那么没有扩展功能。这就是我所做的

```
<%= Html.DropDownListFor(x => x.CurrentAddress.State, new SelectList(Enum.GetValues(typeof(XXXXX.Sites.YYYY.Models.State))))%> 
```

其中 XXXXX.Sites.YYYY.Models.State 是一个枚举

可能更好地执行辅助功能，但是当时间很短时，这将完成工作。

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2010-03-12T02:02:12.003

扩展 Prize 和 Rune 的答案，如果您希望选择列表项的 value 属性映射到 Enumeration 类型的整数值，而不是字符串值，请使用以下代码：

```
public static SelectList ToSelectList<T, TU>(T enumObj) 
    where T : struct
    where TU : struct
{
    if(!typeof(T).IsEnum) throw new ArgumentException("Enum is required.", "enumObj");

    var values = from T e in Enum.GetValues(typeof(T))
                 select new { 
                    Value = (TU)Convert.ChangeType(e, typeof(TU)),
                    Text = e.ToString() 
                 };

    return new SelectList(values, "Value", "Text", enumObj);
} 
```

我们可以不将每个 Enumeration 值视为一个 TEnum 对象，而是将其视为一个对象，然后将其转换为整数以获得未装箱的值。

**注意：** 我还添加了一个泛型类型约束来限制此扩展仅可用于结构（Enum 的基本类型）的类型，以及确保传入的结构确实是 Enum 的运行时类型验证。

**2012 年 10 月 23 日更新：** 为基础类型添加了泛型类型参数，并修复了影响 .NET 4+ 的非编译问题。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2010-06-02T21:48:03.053

解决使用 Prise 的扩展方法获取数字而不是文本的问题。

```
public static SelectList ToSelectList<TEnum>(this TEnum enumObj)
{
  var values = from TEnum e in Enum.GetValues(typeof(TEnum))
               select new { ID = (int)Enum.Parse(typeof(TEnum),e.ToString())
                         , Name = e.ToString() };

  return new SelectList(values, "Id", "Name", enumObj);
} 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2011-12-04T13:32:31.760

我为此找到的最佳解决方案是将[这个博客](https://blog.bennymichielsen.be/2011/05/21/entity-framework-4-1-supporting-enums/)与[Simon Goldstone 的回答](https://stackoverflow.com/a/5255108/590558)结合起来。

这允许在模型中使用枚举。本质上，这个想法是使用整数属性以及枚举，并模拟整数属性。

然后使用 [System.ComponentModel.Description] 属性用显示文本注释模型，并在视图中使用“EnumDropDownListFor”扩展。

这使得视图和模型都非常可读和可维护。

模型：

```
public enum YesPartialNoEnum
{
    [Description("Yes")]
    Yes,
    [Description("Still undecided")]
    Partial,
    [Description("No")]
    No
}

//........

[Display(Name = "The label for my dropdown list")]
public virtual Nullable<YesPartialNoEnum> CuriousQuestion{ get; set; }
public virtual Nullable<int> CuriousQuestionId
{
    get { return (Nullable<int>)CuriousQuestion; }
    set { CuriousQuestion = (Nullable<YesPartialNoEnum>)value; }
} 
```

看法：

```
@using MyProject.Extensions
{
//...
    @Html.EnumDropDownListFor(model => model.CuriousQuestion)
//...
} 
```

扩展（直接来自[Simon Goldstone 的回答](https://stackoverflow.com/a/5255108/590558)，为了完整起见，包括在此处）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.ComponentModel;
using System.Reflection;
using System.Linq.Expressions;
using System.Web.Mvc.Html;

namespace MyProject.Extensions
{
    //Extension methods must be defined in a static class
    public static class MvcExtensions
    {
        private static Type GetNonNullableModelType(ModelMetadata modelMetadata)
        {
            Type realModelType = modelMetadata.ModelType;

            Type underlyingType = Nullable.GetUnderlyingType(realModelType);
            if (underlyingType != null)
            {
                realModelType = underlyingType;
            }
            return realModelType;
        }

        private static readonly SelectListItem[] SingleEmptyItem = new[] { new SelectListItem { Text = "", Value = "" } };

        public static string GetEnumDescription<TEnum>(TEnum value)
        {
            FieldInfo fi = value.GetType().GetField(value.ToString());

            DescriptionAttribute[] attributes = (DescriptionAttribute[])fi.GetCustomAttributes(typeof(DescriptionAttribute), false);

            if ((attributes != null) && (attributes.Length > 0))
                return attributes[0].Description;
            else
                return value.ToString();
        }

        public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression)
        {
            return EnumDropDownListFor(htmlHelper, expression, null);
        }

        public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression, object htmlAttributes)
        {
            ModelMetadata metadata = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
            Type enumType = GetNonNullableModelType(metadata);
            IEnumerable<TEnum> values = Enum.GetValues(enumType).Cast<TEnum>();

            IEnumerable<SelectListItem> items = from value in values
                                                select new SelectListItem
                                                {
                                                    Text = GetEnumDescription(value),
                                                    Value = value.ToString(),
                                                    Selected = value.Equals(metadata.Model)
                                                };

            // If the enum is nullable, add an 'empty' item to the collection
            if (metadata.IsNullableValueType)
                items = SingleEmptyItem.Concat(items);

            return htmlHelper.DropDownListFor(expression, items, htmlAttributes);
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2014-03-24T16:05:50.007

完成这项工作的一种超级简单的方法 - 没有所有看起来过分的扩展内容是这样的：

你的枚举：

```
 public enum SelectedLevel
    {
       Level1,
       Level2,
       Level3,
       Level4
    } 
```

在控制器内部将枚举绑定到列表：

```
 List<SelectedLevel> myLevels = Enum.GetValues(typeof(SelectedLevel)).Cast<SelectedLevel>().ToList(); 
```

之后将其放入 ViewBag 中：

```
 ViewBag.RequiredLevel = new SelectList(myLevels); 
```

最后简单地将其绑定到视图：

```
 @Html.DropDownList("selectedLevel", (SelectList)ViewBag.RequiredLevel, new { @class = "form-control" }) 
```

*这是迄今为止我发现的最简单的方法，不需要任何扩展或任何疯狂的东西。*

**更新**：见下面的安德鲁斯评论。

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2018-08-12T22:26:29.947

在 .NET Core 中，您可以使用它：

```
@Html.DropDownListFor(x => x.Foo, Html.GetEnumSelectList<MyEnum>()) 
```

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2008-12-23T10:36:23.593

你想看看使用类似的东西[`Enum.GetValues`](https://docs.microsoft.com/en-us/dotnet/api/system.enum.getvalues)

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2014-01-24T00:53:33.147

```
@Html.DropDownListFor(model => model.Type, Enum.GetNames(typeof(Rewards.Models.PropertyType)).Select(e => new SelectListItem { Text = e })) 
```

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2014-01-29T15:17:47.973

现在这个特性在 MVC 5.1 中得到了开箱即用的支持。`@Html.EnumDropDownListFor()`

检查以下链接：

[https://docs.microsoft.com/en-us/aspnet/mvc/overview/releases/mvc51-release-notes#Enum](https://docs.microsoft.com/en-us/aspnet/mvc/overview/releases/mvc51-release-notes#Enum)

根据上面的投票，微软花了 5 年时间才实现了如此需要的功能，真是太可惜了！

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2011-12-01T12:23:03.203

这是 Rune & Prize 答案，已更改为使用 Enum`int`值作为 ID。

示例枚举：

```
public enum ItemTypes
{
    Movie = 1,
    Game = 2,
    Book = 3
} 
```

扩展方法：

```
 public static SelectList ToSelectList<TEnum>(this TEnum enumObj)
    {
        var values = from TEnum e in Enum.GetValues(typeof(TEnum))
                     select new { Id = (int)Enum.Parse(typeof(TEnum), e.ToString()), Name = e.ToString() };

        return new SelectList(values, "Id", "Name", (int)Enum.Parse(typeof(TEnum), enumObj.ToString()));
    } 
```

使用示例：

```
 <%=  Html.DropDownList("MyEnumList", ItemTypes.Game.ToSelectList()) %> 
```

记得导入包含 Extension 方法的命名空间

```
<%@ Import Namespace="MyNamespace.LocationOfExtensionMethod" %> 
```

生成的 HTML 示例：

```
<select id="MyEnumList" name="MyEnumList">
    <option value="1">Movie</option>
    <option selected="selected" value="2">Game</option>
    <option value="3">Book </option>
</select> 
```

请注意，您用来调用`ToSelectList`on 的项目是所选项目。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2011-12-12T06:52:12.007

这是 Razor 的版本：

```
@{
    var itemTypesList = new List<SelectListItem>();
    itemTypesList.AddRange(Enum.GetValues(typeof(ItemTypes)).Cast<ItemTypes>().Select(
                (item, index) => new SelectListItem
                {
                    Text = item.ToString(),
                    Value = (index).ToString(),
                    Selected = Model.ItemTypeId == index
                }).ToList());
 }

@Html.DropDownList("ItemTypeId", itemTypesList) 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2013-05-24T19:52:16.630

基于 Simon 的回答，类似的方法是从资源文件中获取 Enum 值以显示，而不是在 Enum 本身的描述属性中。如果您的网站需要以一种以上的语言呈现，并且如果您要为 Enums 提供特定的资源文件，这将很有帮助，您可以更进一步，在您的 Enum 中只包含 Enum 值，并从扩展名中引用它们诸如 [EnumName]_[EnumValue] 之类的约定 - 最终减少打字！

然后扩展看起来像：

```
public static IHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> html, Expression<Func<TModel, TEnum>> expression)
{            
    var metadata = ModelMetadata.FromLambdaExpression(expression, html.ViewData);

    var enumType = Nullable.GetUnderlyingType(metadata.ModelType) ?? metadata.ModelType;

    var enumValues = Enum.GetValues(enumType).Cast<object>();

    var items = from enumValue in enumValues                        
                select new SelectListItem
                {
                    Text = GetResourceValueForEnumValue(enumValue),
                    Value = ((int)enumValue).ToString(),
                    Selected = enumValue.Equals(metadata.Model)
                };

    return html.DropDownListFor(expression, items, string.Empty, null);
}

private static string GetResourceValueForEnumValue<TEnum>(TEnum enumValue)
{
    var key = string.Format("{0}_{1}", enumValue.GetType().Name, enumValue);

    return Enums.ResourceManager.GetString(key) ?? enumValue.ToString();
} 
```

Enums.Resx 文件中的资源类似于 ItemTypes_Movie : Film

我喜欢做的另一件事是，与其直接调用扩展方法，我宁愿用@Html.EditorFor(x => x.MyProperty) 调用它，或者理想情况下只使用一个简洁的@ Html.EditorForModel()。为此，我将字符串模板更改为如下所示

```
@using MVCProject.Extensions

@{
    var type = Nullable.GetUnderlyingType(ViewData.ModelMetadata.ModelType) ?? ViewData.ModelMetadata.ModelType;

    @(typeof (Enum).IsAssignableFrom(type) ? Html.EnumDropDownListFor(x => x) : Html.TextBoxFor(x => x))
} 
```

如果您对此感兴趣，我会在我的博客上提供更详细的答案：

[http://paulthecyclist.com/2013/05/24/enum-dropdown/](http://paulthecyclist.com/2013/05/24/enum-dropdown/)

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2013-11-08T12:44:00.077

好吧，我真的迟到了，但值得一提的是，我已经在博客上写了这个主题，我创建了一个`EnumHelper`可以轻松转换的课程。

[http://jnye.co/Posts/4/creating-a-dropdown-list-from-an-enum-in-mvc-and-c%23](http://jnye.co/Posts/4/creating-a-dropdown-list-from-an-enum-in-mvc-and-c%23)

**在您的控制器中：**

```
//If you don't have an enum value use the type
ViewBag.DropDownList = EnumHelper.SelectListFor<MyEnum>();

//If you do have an enum value use the value (the value will be marked as selected)    
ViewBag.DropDownList = EnumHelper.SelectListFor(MyEnum.MyEnumValue); 
```

**在您看来：**

```
@Html.DropDownList("DropDownList")
@* OR *@
@Html.DropDownListFor(m => m.Property, ViewBag.DropDownList as SelectList, null) 
```

**助手类：**

```
public static class EnumHelper
{
    // Get the value of the description attribute if the   
    // enum has one, otherwise use the value.  
    public static string GetDescription<TEnum>(this TEnum value)
    {
        var fi = value.GetType().GetField(value.ToString());

        if (fi != null)
        {
            var attributes = (DescriptionAttribute[])fi.GetCustomAttributes(typeof(DescriptionAttribute), false);

            if (attributes.Length > 0)
            {
                return attributes[0].Description;
            }
        }

        return value.ToString();
    }

    /// <summary>
    /// Build a select list for an enum
    /// </summary>
    public static SelectList SelectListFor<T>() where T : struct
    {
        Type t = typeof(T);
        return !t.IsEnum ? null
                         : new SelectList(BuildSelectListItems(t), "Value", "Text");
    }

    /// <summary>
    /// Build a select list for an enum with a particular value selected 
    /// </summary>
    public static SelectList SelectListFor<T>(T selected) where T : struct
    {
        Type t = typeof(T);
        return !t.IsEnum ? null
                         : new SelectList(BuildSelectListItems(t), "Text", "Value", selected.ToString());
    }

    private static IEnumerable<SelectListItem> BuildSelectListItems(Type t)
    {
        return Enum.GetValues(t)
                   .Cast<Enum>()
                   .Select(e => new SelectListItem { Value = e.ToString(), Text = e.GetDescription() });
    }
} 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2013-02-04T11:01:30.653

我在这方面已经很晚了，但我刚刚找到了一种非常酷的方法，只需一行代码，如果您愿意添加[Unconstrained Melody](https://github.com/jskeet/unconstrained-melody) NuGet 包（Jon Skeet 的一个不错的小型库）。

这个解决方案更好，因为：

1.  它确保（使用泛型类型约束）该值确实是一个枚举值（由于 Unconstrained Melody）
2.  它避免了不必要的拳击（由于不受约束的旋律）
3.  它缓存所有描述以避免在每次调用时使用反射（由于不受约束的旋律）
4.  它的代码比其他解决方案少！

因此，以下是使其正常工作的步骤：

1.  在包管理器控制台中，“Install-Package UnconstrainedMelody”
2.  在模型上添加一个属性，如下所示：

    ```
    //Replace "YourEnum" with the type of your enum
    public IEnumerable<SelectListItem> AllItems
    {
        get
        {
            return Enums.GetValues<YourEnum>().Select(enumValue => new SelectListItem { Value = enumValue.ToString(), Text = enumValue.GetDescription() });
        }
    } 
    ```

现在您已经在模型上公开了 SelectListItem 列表，您可以使用 @Html.DropDownList 或 @Html.DropDownListFor 将此属性用作源。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2014-03-20T22:53:25.367

[我在这里](https://blogs.msdn.microsoft.com/stuartleeks/2010/05/21/asp-net-mvc-creating-a-dropdownlist-helper-for-enums/)找到了答案。但是，我的一些枚举具有`[Description(...)]`属性，因此我修改了代码以提供支持：

```
 enum Abc
    {
        [Description("Cba")]
        Abc,

        Def
    }

    public static MvcHtmlString EnumDropDownList<TEnum>(this HtmlHelper htmlHelper, string name, TEnum selectedValue)
    {
        IEnumerable<TEnum> values = Enum.GetValues(typeof(TEnum))
            .Cast<TEnum>();

        List<SelectListItem> items = new List<SelectListItem>();
        foreach (var value in values)
        {
            string text = value.ToString();

            var member = typeof(TEnum).GetMember(value.ToString());
            if (member.Count() > 0)
            {
                var customAttributes = member[0].GetCustomAttributes(typeof(DescriptionAttribute), false);
                if (customAttributes.Count() > 0)
                {
                    text = ((DescriptionAttribute)customAttributes[0]).Description;
                }
            }

            items.Add(new SelectListItem
            {
                Text = text,
                Value = value.ToString(),
                Selected = (value.Equals(selectedValue))
            });
        }

        return htmlHelper.DropDownList(
            name,
            items
            );
    } 
```

希望有帮助。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2010-10-10T01:27:31.263

此扩展方法的另一个修复 - 当前版本没有选择枚举的当前值。我修复了最后一行：

```
public static SelectList ToSelectList<TEnum>(this TEnum enumObj) where TEnum : struct
    {
        if (!typeof(TEnum).IsEnum) throw new ArgumentException("An Enumeration type is required.", "enumObj");

        var values = from TEnum e in Enum.GetValues(typeof(TEnum))
                       select new
                       {
                           ID = (int)Enum.Parse(typeof(TEnum), e.ToString()),
                           Name = e.ToString()
                       };

        return new SelectList(values, "ID", "Name", ((int)Enum.Parse(typeof(TEnum), enumObj.ToString())).ToString());
    } 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2010-11-12T12:09:18.383

如果您想添加本地化支持，只需将 s.toString() 方法更改为如下所示：

```
ResourceManager rManager = new ResourceManager(typeof(Resources));
var dayTypes = from OperatorCalendarDay.OperatorDayType s in Enum.GetValues(typeof(OperatorCalendarDay.OperatorDayType))
               select new { ID = s, Name = rManager.GetString(s.ToString()) }; 
```

在这里 typeof(Resources) 是您要加载的资源，然后您将获得本地化的字符串，如果您的枚举器具有多个单词的值，这也很有用。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2010-12-07T11:07:10.653

这是我的辅助方法版本。我用这个：

```
var values = from int e in Enum.GetValues(typeof(TEnum))
             select new { ID = e, Name = Enum.GetName(typeof(TEnum), e) }; 
```

取而代之的是：

```
var values = from TEnum e in Enum.GetValues(typeof(TEnum))
           select new { ID = (int)Enum.Parse(typeof(TEnum),e.ToString())
                     , Name = e.ToString() }; 
```

这里是：

```
public static SelectList ToSelectList<TEnum>(this TEnum self) where TEnum : struct
    {
        if (!typeof(TEnum).IsEnum)
        {
            throw new ArgumentException("self must be enum", "self");
        }

        Type t = typeof(TEnum);

        var values = from int e in Enum.GetValues(typeof(TEnum))
                     select new { ID = e, Name = Enum.GetName(typeof(TEnum), e) };

        return new SelectList(values, "ID", "Name", self);
    } 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2011-10-28T08:29:48.063

您还可以在 Griffin.MvcContrib 中使用我的自定义 HtmlHelpers。以下代码：

```
@Html2.CheckBoxesFor(model => model.InputType) <br />
@Html2.RadioButtonsFor(model => model.InputType) <br />
@Html2.DropdownFor(model => model.InputType) <br /> 
```

生成：

![在此处输入图像描述](https://i.stack.imgur.com/kDr3Z.png)

[https://github.com/jgauffin/griffin.mvccontrib](https://github.com/jgauffin/griffin.mvccontrib)

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2013-05-30T10:10:44.373

```
@Html.DropdownListFor(model=model->Gender,new List<SelectListItem>
{
 new ListItem{Text="Male",Value="Male"},
 new ListItem{Text="Female",Value="Female"},
 new ListItem{Text="--- Select -----",Value="-----Select ----"}
}
) 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2017-09-11T09:20:58.600

我想以不同的方式回答这个问题，用户不需要做任何事情`controller`或`Linq`表达。这边走...

我有一个`ENUM`

```
public enum AccessLevelEnum
    {
        /// <summary>
        /// The user cannot access
        /// </summary>
        [EnumMember, Description("No Access")]
        NoAccess = 0x0,

        /// <summary>
        /// The user can read the entire record in question
        /// </summary>
        [EnumMember, Description("Read Only")]
        ReadOnly = 0x01,

        /// <summary>
        /// The user can read or write
        /// </summary>
        [EnumMember, Description("Read / Modify")]
        ReadModify = 0x02,

        /// <summary>
        /// User can create new records, modify and read existing ones
        /// </summary>
        [EnumMember, Description("Create / Read / Modify")]
        CreateReadModify = 0x04,

        /// <summary>
        /// User can read, write, or delete
        /// </summary>
        [EnumMember, Description("Create / Read / Modify / Delete")]
        CreateReadModifyDelete = 0x08,

        /*/// <summary>
        /// User can read, write, or delete
        /// </summary>
        [EnumMember, Description("Create / Read / Modify / Delete / Verify / Edit Capture Value")]
        CreateReadModifyDeleteVerify = 0x16*/
    } 
```

现在我可以简单地`dropdown`使用 this创建一个`enum`.

```
@Html.DropDownList("accessLevel",new SelectList(AccessLevelEnum.GetValues(typeof(AccessLevelEnum))),new { @class = "form-control" }) 
```

或者

```
@Html.DropDownListFor(m=>m.accessLevel,new SelectList(AccessLevelEnum.GetValues(typeof(AccessLevelEnum))),new { @class = "form-control" }) 
```

如果你想选择一个索引，那么试试这个

```
@Html.DropDownListFor(m=>m.accessLevel,new SelectList(AccessLevelEnum.GetValues(typeof(AccessLevelEnum)) , AccessLevelEnum.NoAccess ),new { @class = "form-control" }) 
```

在这里，我使用`AccessLevelEnum.NoAccess`了一个额外的参数来默认选择下拉菜单。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2011-10-28T08:21:09.493

@Simon Goldstone：感谢您的解决方案，它可以完美地应用于我的案例。唯一的问题是我必须将它翻译成 VB。但是现在它已经完成并且为了节省其他人的时间（以防他们需要它）我把它放在这里：

```
Imports System.Runtime.CompilerServices
Imports System.ComponentModel
Imports System.Linq.Expressions

Public Module HtmlHelpers
    Private Function GetNonNullableModelType(modelMetadata As ModelMetadata) As Type
        Dim realModelType = modelMetadata.ModelType

        Dim underlyingType = Nullable.GetUnderlyingType(realModelType)

        If Not underlyingType Is Nothing Then
            realModelType = underlyingType
        End If

        Return realModelType
    End Function

    Private ReadOnly SingleEmptyItem() As SelectListItem = {New SelectListItem() With {.Text = "", .Value = ""}}

    Private Function GetEnumDescription(Of TEnum)(value As TEnum) As String
        Dim fi = value.GetType().GetField(value.ToString())

        Dim attributes = DirectCast(fi.GetCustomAttributes(GetType(DescriptionAttribute), False), DescriptionAttribute())

        If Not attributes Is Nothing AndAlso attributes.Length > 0 Then
            Return attributes(0).Description
        Else
            Return value.ToString()
        End If
    End Function

    <Extension()>
    Public Function EnumDropDownListFor(Of TModel, TEnum)(ByVal htmlHelper As HtmlHelper(Of TModel), expression As Expression(Of Func(Of TModel, TEnum))) As MvcHtmlString
        Return EnumDropDownListFor(htmlHelper, expression, Nothing)
    End Function

    <Extension()>
    Public Function EnumDropDownListFor(Of TModel, TEnum)(ByVal htmlHelper As HtmlHelper(Of TModel), expression As Expression(Of Func(Of TModel, TEnum)), htmlAttributes As Object) As MvcHtmlString
        Dim metaData As ModelMetadata = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData)
        Dim enumType As Type = GetNonNullableModelType(metaData)
        Dim values As IEnumerable(Of TEnum) = [Enum].GetValues(enumType).Cast(Of TEnum)()

        Dim items As IEnumerable(Of SelectListItem) = From value In values
            Select New SelectListItem With
            {
                .Text = GetEnumDescription(value),
                .Value = value.ToString(),
                .Selected = value.Equals(metaData.Model)
            }

        ' If the enum is nullable, add an 'empty' item to the collection
        If metaData.IsNullableValueType Then
            items = SingleEmptyItem.Concat(items)
        End If

        Return htmlHelper.DropDownListFor(expression, items, htmlAttributes)
    End Function
End Module 
```

你这样使用它：

```
@Html.EnumDropDownListFor(Function(model) (model.EnumField)) 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2012-10-01T19:14:51.303

我最终创建了扩展方法来做本质上是接受答案的事情。Gist 的后半部分专门针对 Enum。

[https://gist.github.com/3813767](https://gist.github.com/3813767)

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2013-10-23T09:57:03.390

```
@Html.DropDownListFor(model => model.MaritalStatus, new List<SelectListItem> 
{  

new SelectListItem { Text = "----Select----", Value = "-1" },

new SelectListItem { Text = "Marrid", Value = "M" },

 new SelectListItem { Text = "Single", Value = "S" }

}) 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2014-04-13T19:00:53.270

这是 Martin Faartoft 的变体，您可以在其中放置非常适合本地化的自定义标签。

```
public static class EnumHtmlHelper
{
    public static SelectList ToSelectList<TEnum>(this TEnum enumObj, Dictionary<int, string> customLabels)
        where TEnum : struct, IComparable, IFormattable, IConvertible
    {
        var values = from TEnum e in Enum.GetValues(typeof(TEnum))
                     select new { Id = e, Name = customLabels.First(x => x.Key == Convert.ToInt32(e)).Value.ToString() };

        return new SelectList(values, "Id", "Name", enumObj);
    }
} 
```

在视图中使用：

```
@Html.DropDownListFor(m => m.Category, Model.Category.ToSelectList(new Dictionary<int, string>() { 
          { 1, ContactResStrings.FeedbackCategory }, 
          { 2, ContactResStrings.ComplainCategory }, 
          { 3, ContactResStrings.CommentCategory },
          { 4, ContactResStrings.OtherCategory }
      }), new { @class = "form-control" })
@Html.ValidationMessageFor(m => m.Category) 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2016-01-02T21:01:38.697

我已经完成了以下操作并成功运行：

*   在 view.cshtml 中：

@model MyModel.cs

```
@Html.EnumDropDownListFor(m=>m.MyItemType ) 
```

*   在模型中：MyModel.cs

> `public ItemTypes MyItemType { get; set; }`

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2016-07-20T19:44:43.947

在 MVC4 中，我会这样做

```
@Html.DropDownList("RefType", new SelectList(Enum.GetValues(typeof(WebAPIApp.Models.RefType))), " Select", new { @class = "form-control" })

public enum RefType
    {
        Web = 3,
        API = 4,
        Security = 5,
        FE = 6
    }

    public class Reference
    {
        public int Id { get; set; }
        public RefType RefType { get; set; }
    } 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2016-11-30T05:37:32.683

```
 ////  ViewModel

        public class RegisterViewModel
          {

        public RegisterViewModel()
          {
              ActionsList = new List<SelectListItem>();
          }

        public IEnumerable<SelectListItem> ActionsList { get; set; }

        public string StudentGrade { get; set; }

           }

       //// Enum Class

        public enum GradeTypes
             {
               A,
               B,
               C,
               D,
               E,
               F,
               G,
               H
            }

         ////Controller action 

           public ActionResult Student()
               {
    RegisterViewModel vm = new RegisterViewModel();
    IEnumerable<GradeTypes> actionTypes = Enum.GetValues(typeof(GradeTypes))
                                         .Cast<GradeTypes>();                  
    vm.ActionsList = from action in actionTypes
                     select new SelectListItem
                     {
                         Text = action.ToString(),
                         Value = action.ToString()
                     };
              return View(vm);
               }

         ////// View Action

   <div class="form-group">
                            <label class="col-lg-2 control-label" for="hobies">Student Grade:</label>
                            <div class="col-lg-10">
                               @Html.DropDownListFor(model => model.StudentGrade, Model.ActionsList, new { @class = "form-control" })
                            </div> 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2014-01-15T07:08:41.597

1-创建你的枚举

```
public enum LicenseType
{
    xxx = 1,
    yyy = 2
} 
```

2-创建您的服务类

```
public class LicenseTypeEnumService
    {

        public static Dictionary<int, string> GetAll()
        {

            var licenseTypes = new Dictionary<int, string>();

            licenseTypes.Add((int)LicenseType.xxx, "xxx");
            licenseTypes.Add((int)LicenseType.yyy, "yyy");

            return licenseTypes;

        }

        public static string GetById(int id)
        {

            var q = (from p in this.GetAll() where p.Key == id select p).Single();
            return q.Value;

        }

    } 
```

3-在控制器中设置 ViewBag

```
var licenseTypes = LicenseTypeEnumService.GetAll();
ViewBag.LicenseTypes = new SelectList(licenseTypes, "Key", "Value"); 
```

4-绑定你的下拉列表

```
@Html.DropDownList("LicenseType", (SelectList)ViewBag.LicenseTypes) 
```

* * *

## 回答 #36

> 赞同：-7
> 
> 时间：2008-12-23T11:51:31.287

**更新**- 我建议使用下面符文的建议而不是这个选项！

* * *

我假设您想要类似以下内容：

```
<select name="blah">
    <option value="1">Movie</option>
    <option value="2">Game</option>
    <option value="3">Book</option>
</select> 
```

您可以使用类似以下的扩展方法来执行此操作：

```
public static string DropdownEnum(this System.Web.Mvc.HtmlHelper helper,
                                  Enum values)
{
    System.Text.StringBuilder sb = new System.Text.StringBuilder();
    sb.Append("<select name=\"blah\">");
    string[] names = Enum.GetNames(values.GetType());
    foreach(string name in names)
    {
        sb.Append("<option value=\"");
        sb.Append(((int)Enum.Parse(values.GetType(), name)).ToString());
        sb.Append("\">");
        sb.Append(name);
        sb.Append("</option>");
    }
    sb.Append("</select>");
    return sb.ToString();
} 
```

**但是**这样的事情是不可本地化的（即很难翻译成另一种语言）。

注意：您需要使用枚举的实例调用静态方法，即`Html.DropdownEnum(ItemTypes.Movie);`

可能有一种更优雅的方法可以做到这一点，但上述方法确实有效。

# unicode - 如何在 Windows 命令行中使用 unicode 字符？

> ID：388490
> 
> 赞同：336
> 
> 时间：2008-12-23T09:30:59.323
> 
> 标签：unicode, command-line, input, windows-console

我们在 Team Foundation Server (TFS) 中有一个项目，其中包含非英文字符 (š)。在尝试编写一些与构建相关的内容时，我们偶然发现了一个问题——我们无法将**š**字母传递给命令行工具。命令提示符或其他什么都搞砸了，**tf.exe**实用程序找不到指定的项目。

我尝试了 .bat 文件的不同格式（ANSI、UTF-8 有和没有[BOM](http://en.wikipedia.org/wiki/Byte_order_mark)）以及用 JavaScript 编写脚本（本质上是 Unicode） - 但没有运气。如何执行程序并将其传递给**Unicode**命令行？

* * *

## 回答 #1

> 赞同：410
> 
> 时间：2008-12-23T09:39:44.253

尝试：

```
chcp 65001 
```

这会将代码页更改为 UTF-8。此外，您需要使用 Lucida 控制台字体。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2017-12-16T07:29:15.320

我的背景：多年来，我在控制台中使用 Unicode 输入/输出（并且每天都这样做。此外，我为这个任务开发了支持工具）。就您了解以下事实/限制而言，问题很少：

*   `CMD`和“控制台”是不相关的因素。 `CMD.exe`只是准备好在控制台中“工作”的程序之一（“控制台应用程序”）。
*   AFAIK，`CMD`完美支持 Unicode；*当任何*代码页处于活动状态时，您可以输入/输出所有 Unicode 字符。
*   Windows 的控制台对 Unicode 有很多支持——但它并不完美（只是“足够好”；见下文）。
*   `chcp 65001`非常危险。除非某个程序是专门为解决 Windows API 中的缺陷而设计的（或使用具有这些解决方法的 C 运行时库），否则它不会可靠地工作。 [Win8 修复了其中 ½ 的问题`cp65001`，但其余的仍然适用于 Win10](https://stackoverflow.com/a/39745938/9106292)。
*   我在`cp1252`. 正如我已经说过的：**要在控制台中输入/输出 Unicode，不需要设置 codepage**。

# 细节

*   要将 Unicode 读/写到控制台，应用程序（或其 C 运行时库）应该足够智能，可以使用`File-I/O`API，而不是`Console-I/O`API。（例如，看看[Python 是如何做到](https://www.python.org/dev/peps/pep-0528/)的。）
*   同样，要读取 Unicode 命令行参数，应用程序（或其 C 运行时库）应该足够智能以使用相应的 API。
*   控制台字体渲染仅支持 BMP 中的 Unicode 字符（换句话说：下面`U+10000`）。仅支持简单的文本呈现（因此欧洲语言——和一些东亚语言——应该可以正常工作——只要使用预先组合的形式）。[这里对东亚和字符 U+0000、U+0001、U+30FB有一个[小字体。]](https://stackoverflow.com/a/47852866/9106292)

# 实际考虑

*   Window 上的**默认值**不是很有帮助。为了获得最佳体验，应该调整 3 项配置：

    *   用于输出：综合控制台字体。为了获得最佳效果，我推荐[我的 builds](http://ilyaz.org/software/fonts/)。（安装说明在那里 - 并且也在此页面上的其他答案中列出。）
    *   对于输入：有能力的键盘布局。为了获得最佳效果，我推荐[我的 layouts](http://k.ilyaz.org/)。
    *   对于输入：[允许 Unicode 的 HEX 输入](https://www.google.com/search?num=100&hl=en&pws=0&q=enable-hex-unicode-entry+windows+registry)。
*   将“粘贴”到控制台应用程序的另一个问题（非常技术性）：

    *   十六进制输入提供一个字符`KeyUp`; *所有*其他传达角色的方式都发生在；这么多应用程序还没有准备好看到一个字符。（仅适用于使用API 的应用程序。）`Alt`*`KeyDown``KeyUp``Console-I/O`*
    **   结论：许多应用程序不会对 HEX 输入事件做出反应。*   此外，“粘贴”字符会发生什么取决于当前的键盘布局：如果可以在不使用前缀键的情况下键入字符（但可以使用任意复杂的修饰符组合，如`Ctrl-Alt-AltGr-Kana-Shift-Gray*`），那么它会在模拟按键上传递。这是任何应用程序所期望的——因此粘贴仅包含此类字符的任何内容都可以。*   但是，“其他”字符是通过**模拟 HEX 输入**来传递的。* ****结论***：除非您的键盘布局支持在没有前缀键的情况下输入大量字符，通过控制台的 UI:*时，一些有问题的应用程序*可能会跳过字符。（**这**就是为什么我建议使用我的键盘布局！）`Paste``Alt-Space E P`* 

 ***还应该记住，Windows 的“替代的、‘功能更强大’的控制台”**根本不是控制台**。它们不支持`Console-I/O`API，因此依赖这些 API 工作的程序将无法运行。（不过，仅使用“控制台文件句柄的 File-I/O API”的程序可以正常工作。）

此类非控制台的一个示例是 Microsoft 的`Powershell`. 我不用这个; 进行实验，按下并释放`WinKey`，然后键入`powershell`。

* * *

（另一方面，有诸如[`ConEmu`](https://en.wikipedia.org/wiki/ConEmu)or之类的程序[`ANSICON`](http://adoxa.altervista.org/ansicon/)试图做更多的事情：它们“试图”拦截`Console-I/O`API 以使“真正的控制台应用程序”也可以工作。这绝对适用于玩具示例程序；在现实生活中，这可能或可能无法解决您的特定问题。实验。）

# 概括

*   设置字体、键盘布局（并且可选地，允许 HEX 输入）。

*   仅使用通过`Console-I/O`API 并接受 Unicode 命令行参数的程序。例如，任何`cygwin`-compiled 程序都应该没问题。正如我已经说过的，`CMD`也很好。

**UPD：**最初，对于 中的一个错误`cp65001`，我混合了内核和 CRTL 层（**UPD²：**和 Windows 用户模式 ​​API！）。 *另外：* Win8修复了这个bug的一半；我澄清了关于“更好的控制台”应用程序的部分，并添加了对 Python 是如何做到这一点的参考。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2010-08-24T12:31:30.023

我有同样的问题（我来自捷克共和国）。我有一个英文版的 Windows，我必须处理共享驱动器上的文件。文件的路径包括捷克语特有的字符。

对我有用的解决方案是：

在批处理文件中，更改字符集页面

我的批处理文件：

```
chcp 1250
copy "O:\VEŘEJNÉ\ŽŽŽŽŽŽ\Ž.xls" c:\temp 
```

批处理文件必须保存在 CP 1250 中。

请注意，控制台不会正确显示字符，但它会理解它们......

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2013-04-07T04:18:53.557

检查非 Unicode 程序的语言。如果您在 Windows 控制台中遇到俄语问题，则应在此处设置俄语：

![更改非 Unicode 程序的语言](https://i.stack.imgur.com/45C5G.png)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2015-11-02T10:23:16.830

更改 Windows 控制台的默认代码页非常困难。当您在网上搜索时，您会发现不同的建议，但其中一些可能会完全破坏您的 Windows，即您的 PC 不再启动。

最安全的解决方案是这个：转到您的注册表项`HKEY_CURRENT_USER\Software\Microsoft\Command Processor`并添加 String value `Autorun`= `chcp 65001`。

或者，您可以将这个小批处理脚本用于最常见的代码页。

```
@ECHO off

SET ROOT_KEY="HKEY_CURRENT_USER"

FOR /f "skip=2 tokens=3" %%i in ('reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\CodePage /v OEMCP') do set OEMCP=%%i

ECHO System default values:

ECHO.
ECHO ...............................................
ECHO Select Codepage 
ECHO ...............................................
ECHO.
ECHO 1 - CP1252
ECHO 2 - UTF-8
ECHO 3 - CP850
ECHO 4 - ISO-8859-1
ECHO 5 - ISO-8859-15
ECHO 6 - US-ASCII
ECHO.
ECHO 9 - Reset to System Default (CP%OEMCP%)
ECHO 0 - EXIT
ECHO.

SET /P  CP="Select a Codepage: "

if %CP%==1 (
    echo Set default Codepage to CP1252
    reg add "%ROOT_KEY%\Software\Microsoft\Command Processor" /v Autorun /t REG_SZ /d "@chcp 1252>nul" /f
) else if %CP%==2 (
    echo Set default Codepage to UTF-8
    reg add "%ROOT_KEY%\Software\Microsoft\Command Processor" /v Autorun /t REG_SZ /d "@chcp 65001>nul" /f
) else if %CP%==3 (
    echo Set default Codepage to CP850
    reg add "%ROOT_KEY%\Software\Microsoft\Command Processor" /v Autorun /t REG_SZ /d "@chcp 850>nul" /f
) else if %CP%==4 (
    echo Set default Codepage to ISO-8859-1
    add "%ROOT_KEY%\Software\Microsoft\Command Processor" /v Autorun /t REG_SZ /d "@chcp 28591>nul" /f
) else if %CP%==5 (
    echo Set default Codepage to ISO-8859-15
    add "%ROOT_KEY%\Software\Microsoft\Command Processor" /v Autorun /t REG_SZ /d "@chcp 28605>nul" /f
) else if %CP%==6 (
    echo Set default Codepage to ASCII
    add "%ROOT_KEY%\Software\Microsoft\Command Processor" /v Autorun /t REG_SZ /d "@chcp 20127>nul" /f
) else if %CP%==9 (
    echo Reset Codepage to System Default
    reg delete "%ROOT_KEY%\Software\Microsoft\Command Processor" /v AutoRun /f
) else if %CP%==0 (
    echo Bye
) else (
    echo Invalid choice
    pause
) 
```

每次启动新的命令行窗口时，使用`@chcp 65001>nul`而不是抑制输出“活动代码页：65001”。`chcp 65001`

您可以从[代码页标识符中获得的所有可用号码的完整列表](https://msdn.microsoft.com/en-us/library/windows/desktop/dd317756(v=vs.85).aspx)

请注意，这些设置仅适用于当前用户。如果您想为所有用户设置它，请将 line 替换`SET ROOT_KEY="HKEY_CURRENT_USER"`为`SET ROOT_KEY="HKEY_LOCAL_MACHINE"`

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-04-14T13:03:27.330

实际上，诀窍在于命令提示符实际上可以理解这些非英文字符，只是无法正确显示它们。

当我在命令提示符中输入包含一些非英语字符的路径时，它显示为“?? ?????? ?????”。当您提交命令时（在我的情况下 cd "??? ?????? ?????"），一切都按预期工作。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2016-08-01T09:07:06.807

在 Windows 10 x64 机器上，我通过以下方式使命令提示符显示非英文字符：

打开提升的命令提示符（以管理员身份运行 CMD.EXE）。通过以下方式在您的注册表中查询可用的 TrueType 字体到控制台：

```
 REG query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Console\TrueTypeFont" 
```

您将看到如下输出：

```
 0    REG_SZ    Lucida Console
    00    REG_SZ    Consolas
    936    REG_SZ    *新宋体
    932    REG_SZ    *ＭＳ ゴシック 
```

现在我们需要添加一个支持您需要的字符的 TrueType 字体，例如 Courier New。我们通过向字符串名称添加零来做到这一点，因此在这种情况下，下一个将是“000”：

```
 REG ADD "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Console\TrueTypeFont" /v 000 /t REG_SZ /d "Courier New" 
```

现在我们实现 UTF-8 支持：

```
 REG ADD HKCU\Console /v CodePage /t REG_DWORD /d 65001 /f 
```

将默认字体设置为“Courier New”：

```
 REG ADD HKCU\Console /v FaceName /t REG_SZ /d "Courier New" /f 
```

将字体大小设置为 20：

```
 REG ADD HKCU\Console /v FontSize /t REG_DWORD /d 20 /f 
```

如果您愿意，可以启用快速编辑：

```
 REG ADD HKCU\Console /v QuickEdit /t REG_DWORD /d 1 /f 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-01-02T09:15:07.863

一个非常简单的选择是安装 Windows bash shell，例如[MinGW](https://sourceforge.net/projects/mingw-w64/)并使用它：

[![在此处输入图像描述](https://i.stack.imgur.com/o6phE.png)](https://i.stack.imgur.com/o6phE.png)

有一点学习曲线，因为您需要使用 Unix 命令行功能，但您会喜欢它的强大功能，并且可以将控制台字符集设置为 UTF-8。

[![在此处输入图像描述](https://i.stack.imgur.com/G51mw.png)](https://i.stack.imgur.com/G51mw.png)

当然，您还可以获得所有常见的 *nix 好东西，例如 grep、find、less 等。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2019-04-14T11:28:59.343

我发现这种方法在新版本的 Windows 10 中很有用：

打开此功能：“Beta：使用 Unicode UTF-8 获得全球语言支持”

> 控制面板->区域设置->管理选项卡->更改系统区域设置...

[![区域设置](https://i.stack.imgur.com/6D4ut.png)](https://i.stack.imgur.com/6D4ut.png)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2016-04-07T01:49:58.680

由于我还没有看到 Python 2.7 的任何完整答案，我将概述两个重要步骤和一个非常有用的可选步骤。

1.  您需要支持 Unicode 的字体。Windows 自带 Lucida Console，可以通过**右键单击**命令提示符的标题栏并单击`Defaults`选项来选择。这也可以访问颜色。请注意，您还可以通过选择`Properties`来更改以某些方式（例如，在此处打开、Visual Studio）调用的命令窗口的设置。
2.  您需要将代码页设置为`cp65001`，这似乎是 Microsoft 为命令提示符提供 UTF-7 和 UTF-8 支持的尝试。**`chcp 65001`通过在命令提示符**下运行来做到这一点。一旦设置，它就会保持这种状态，直到窗口关闭。每次启动 cmd.exe 时都需要重新执行此操作。

有关更永久的解决方案，请参阅超级用户上的[此答案。](https://superuser.com/a/269857/576775)简而言之，`REG_SZ`使用 regedit at 创建一个（字符串）条目`HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor`并将其命名`AutoRun`。将其值更改为`chcp 65001`。如果您不想看到命令的输出消息，请`@chcp 65001>nul`改用。

一些程序在与这种编码交互时遇到了麻烦，MinGW 是一个值得注意的程序，它在编译时会出现无意义的错误消息。尽管如此，这非常有效，并且不会导致大多数程序出现错误。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2019-05-06T20:36:30.377

从 2019 年 6 月开始，使用 Windows 10，您无需更改代码页。

请参阅“[介绍 Windows 终端](https://devblogs.microsoft.com/commandline/introducing-windows-terminal/)”（来自[**Kayla Cinnamon**](https://twitter.com/cinnamon_msft)）和[**Microsoft/Terminal**](https://github.com/Microsoft/Terminal)。
通过使用 Consolas 字体，将提供*部分Unicode 支持。*

如[`Microsoft/Terminal`问题 387](https://github.com/Microsoft/Terminal/issues/387#issuecomment-471926057)中所述：

> 目前 Unicode 中有 87,887 个表意文字。你也需要它们吗？
> 我们需要一个边界，超出该边界的字符应该由字体回退/字体链接/其他处理。
> 
> Consolas 应涵盖的内容：
> 
> *   现代 OSS 程序在 CLI 中用作符号的字符。
> *   这些角色应遵循 Consolas 的设计和指标，并与现有的 Consolas 角色正确对齐。
> 
> Consolas 不应涵盖的内容：
> 
> *   拉丁文、希腊文和西里尔文以外的字符和标点符号，尤其是需要复杂造型的字符（如阿拉伯语）。
> *   这些字符应使用字体回退处理。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-01-22T06:02:11.637

这个问题很烦人。我的文件名和文件内容中通常有中文字符。请注意，我使用的是 Windows 10，这是我的解决方案：

显示**文件名**，例如`dir`或者`ls`如果您在 Windows 10 上安装了 Ubuntu bash

1.  设置区域以支持非 utf 8 字符。

2.  之后，控制台的字体将更改为该语言环境的字体，并且还更改了控制台的编码。

完成前面的步骤后，为了使用命令行工具显示 UTF-8 文件的**文件内容**

1.  通过以下方式将页面更改为 utf-8`chcp 65001`
2.  改成支持utf-8的字体，比如Lucida Console
3.  使用`type`命令查看文件内容，或者`cat`如果您在 Windows 10 上安装了 Ubuntu bash
4.  请注意，将控制台的编码设置为utf-8后，我无法使用中文输入法在cmd中输入汉字。

最懒惰的解决方案：只需使用控制台模拟器，例如[http://cmder.net/](http://cmder.net/)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2012-12-02T12:41:56.643

对于类似的问题，（我的问题是在命令提示符下显示来自 MySQL 的 UTF-8 字符），

我是这样解决的：

1.  我将命令提示符的字体更改为 Lucida Console。（此步骤必须与您的情况无关。它仅与您在屏幕上看到的内容有关，与真正的角色无关）。

2.  我将代码页更改为 Windows-1253。您可以通过“chcp 1253”在命令提示符下执行此操作。它适用于我想查看 UTF-8 的情况。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-08-31T14:53:20.170

我在这里看到了几个答案，但它们似乎没有解决这个问题 - 用户希望从命令行获取 Unicode 输入。

Windows 使用 UTF-16 对两个字节字符串进行编码，因此您需要从程序中的操作系统获取这些字符串。有两种方法可以做到这一点 -

1) 微软有一个扩展允许 main 采用宽字符数组： int wmain(int argc, wchar_t *argv[]); [https://msdn.microsoft.com/en-us/library/6wd819wh.aspx](https://msdn.microsoft.com/en-us/library/6wd819wh.aspx)

2) 调用windows api获取命令行的unicode版本 wchar_t **win_argv = (wchar_t** )CommandLineToArgvW(GetCommandLineW(), &nargs); [https://docs.microsoft.com/en-us/windows/desktop/api/shellapi/nf-shellapi-commandlinetoargvw](https://docs.microsoft.com/en-us/windows/desktop/api/shellapi/nf-shellapi-commandlinetoargvw)

请阅读： [http](http://utf8everywhere.org) ://utf8everywhere.org 了解详细信息，尤其是在您支持其他操作系统的情况下。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-05-31T12:19:42.487

更清洁的做法：只需安装可用的免费 Microsoft 日语语言包。（其他东方语言包也可以，但我测试过日语包。）

这为您提供了具有更大字形集的字体，使它们成为默认行为，更改各种 Windows 工具，如 cmd、写字板等。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-02-12T07:18:24.747

将代码页更改为 1252 对我有用。对我来说，问题是符号 double doller § 正在 Windows Server 2008 上由 DOS 转换为另一个符号。

我在 BCP 声明中使用了 CHCP 1252 和前面的上限 ^§。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-04-09T08:52:08.057

如果您的计算机在 DOS 窗口中键入时显示路径/文件名正确，则可以快速决定 .bat 文件：

1.  ***复制 con temp.txt*** [按 Enter]
2.  输入路径/文件名 [按 Enter]
3.  按***Ctrl-Z*** [按 Enter]

这样您就可以创建一个 .txt 文件 - temp.txt。在记事本中打开它，复制文本（不要担心它看起来不可读）并将其粘贴到您的 .bat 文件中。在 DOS 窗口中执行以这种方式创建的 .bat 对我有用（西里尔文，保加利亚文）。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-12-02T13:39:36.693

我通过在批处理文件中通过它们的短（8 点 3）名称引用它们来解决删除 Unicode 命名文件的类似问题。

可以通过做查看短名称`dir /x`。显然，这只适用于已知的 Unicode 文件名。

# css - 当通过外部 CSS 或内联样式缩放时，Firefox 会模糊图像。

> ID：388492
> 
> 赞同：23
> 
> 时间：2008-12-23T09:33:45.043
> 
> 标签：css, image, firefox, resize

当我在视觉上缩放图像时，Firefox 3 会模糊它。Firefox 2 和其他浏览器没有，这是我期望的行为。这对于使用 png 或 gif 精灵创建基于 Web 的游戏尤其糟糕。

例如，在 Firefox 3 中显示 100x100 图像时，如下所示：

```
<img src="sprite.gif" width="200" /> 
```

或者

```
<img src="sprite.gif" style="width:200px; height:200px;" /> 
```

它在 FF3 中看起来很模糊，而不是在 IE 中。

关于如何防止这种情况的任何想法？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-20T10:15:45.103

我发现了 FireFox 的这个新功能：

[http://developer.mozilla.org/En/CSS/Image-rendering](http://developer.mozilla.org/En/CSS/Image-rendering)

所以把它放在你的 CSS 中会修复它：

```
image-rendering: -moz-crisp-edges; 
```

以为我会分享这个信息。很抱歉回答我自己的问题；）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-23T12:07:56.043

我自己只是想知道这个，但它似乎在 ff3 中被硬编码:( [http://forums.mozillazine.org/viewtopic.php?f=7&t=752735&p=5008845](http://forums.mozillazine.org/viewtopic.php?f=7&t=752735&p=5008845)

ff2 没有做任何插值

IE 默认没有，但是你可以打开它： [http ://www.joelonsoftware.com/items/2008/12/22.html](http://www.joelonsoftware.com/items/2008/12/22.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-23T09:39:42.067

您正在将图像从其原始大小放大 - 所需的效果*通常*是平滑缩放，并且看起来 FFX3 已经开始这样做（我假设双线性过滤）。我认为如果您查看 Safari 和 Opera，您会发现它们也会过滤图像。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T10:32:16.890

[http://developer.mozilla.org/En/CSS/Image-rendering](http://developer.mozilla.org/En/CSS/Image-rendering)仅适用于当前的 Firefox 主干版本（Minefield/3.6a1pre/Gecko 1.9.2）。此功能不在 Firefox 3.0 中，也不会出现在即将发布的 3.5 版本中。带有该选项的第一个版本将是 3.5 之后的下一个主要版本，目前处于早期规划阶段，预计在 2010 年发布。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-04T04:58:18.160

默认情况下，Internet Explorer 8 在缩放图像时也会“模糊”图像。这实际上是一件好事。大多数图像在使用双三次采样而不是最近邻采样进行缩放时看起来更好。

如果您希望 Internet Explorer 8 像以前的版本一样缩放图像，请将其放在您的 CSS 中：

```
-ms-interpolation-mode: nearest-neighbor; 
```

如果您希望 Internet Explorer 7 像 IE 8 一样缩放图像，请使用以下命令：

```
-ms-interpolation-mode: bicubic; 
```

除了图像的外观，您还必须考虑性能。我发现 IE 7 和 IE 8 在使用双三次采样时需要比 Firefox 3.6 更多的 CPU 能力来缩放图像。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-23T09:40:44.327

我实际上更喜欢 FF 这样做的方式，因为它在缩放图像时使用插值，在大多数情况下，这会使图像看起来比在 IE 中更好。但是我想在某些情况下它可能不好，比如使用精灵时。

我不认为有办法绕过它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-18T11:11:01.247

不幸的是，我对此没有解决方案，但对于大量用户（例如像素艺术家）来说，这是一个彻底的破坏者。如果您受到此影响，请将反馈发送至[http://hendrix.mozilla.org/并为](http://hendrix.mozilla.org/)[相应的错误](https://bugzilla.mozilla.org/show_bug.cgi?id=423756)投票。

令人失望的是 Mozilla 忽略了这个问题。对于许多受影响的用户来说，这意味着除了切换浏览器别无选择。IE 有一个[CSS 属性](http://msdn.microsoft.com/en-us/library/ms530822.aspx)来选择调整大小过滤器，所以这似乎是最好的选择。

这是 Google Chrome 的[错误报告](http://code.google.com/p/chromium/issues/detail?id=1502)，它与 Firefox 有相同的问题。我不了解 Opera，但我听说他们使用一些启发式方法来实现更明智的自动缩放。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-12T09:13:14.183

我想知道如果您以您希望它们被查看的最大尺寸创建精灵，然后根据需要缩小它们，您是否会获得更好的结果？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-23T09:41:58.710

您应该避免在客户端缩放图像。向上缩放图像就像缩放一样，浏览器没有图像信息以比实际分辨率更高的分辨率显示，所以你不能在不模糊图像的情况下这样做，也许它在 IE 中并不明显，试试将 200 像素更改为 400 像素。

# asp.net - ASP.NET 中的母版页和回发

> ID：388493
> 
> 赞同：0
> 
> 时间：2008-12-23T09:34:07.040
> 
> 标签：asp.net, ajax, master-pages

我们如何避免母版页回发整个页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T14:22:39.487

只是为了澄清 - 更新面板不会阻止整个页面回发或整个页面生命周期。它只是导致该过程在用户“看不见”的后台完成。唯一的区别是，在回发完成后，只有更新面板声明包裹的部分被刷新，从而造成只有部分页面被回发的错觉。

如果触发器控件位于更新面板内，则应将 ChildrenAsTriggers 属性设置为 True。如果触发更新的控件在更新面板之外，那么您应该将 Triggers 部分添加到控制面板并添加异步触发器。如果是组合，那么你可以将两者结合起来以获得最佳效果。

如果触发更新的控件包含在更新面板中：

```
<asp:UpdatePanel id="MyUpdatePanel" runat="server" ChildrenAsTriggers="True">
  <ContentTemplate>
    ...Stuff you want updated
  </ContentTemplate>
</asp:UpdatePanel> 
```

或者，如果控件不包含在更新面板中：

```
<asp:UpdatePanel id="MyUpdatePanel" runat="server">
  <ContentTemplate>
    ...Stuff you want updated
  </ContentTemplate>
  <Triggers>
    <asp:AsyncPostBackTrigger ControlID="MyButtonControl" EventName="Click" />
  </Triggers>
</asp:UpdatePanel> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T14:10:09.153

使用母版页对整个页面是否回发实际上没有任何影响。一个没有母版和标准的简单 ASPX 页面也可以进行整个页面的回发。

不过从字里行间看，我猜您的母版页上已经有一些 UpdatePanel（可能围绕内容占位符），当其中的某些内容导致回发时，它们会阻止整个页面刷新。

无论哪种方式，防止整个页面刷新（无论是否使用母版页）的关键是确保导致回发的控件位于 UpdatePanel 中，或者使用一些 JavaScript 回调服务器并异步处理响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T09:51:44.307

母版页不负责 PostBack，这就是 HTML 表单的用途。

阻止页面回发的唯一方法是*将整个内容包装在 UpdatePanel 中。*但这本身就是个**坏主意！！**

# sql - T-sql命名时如何切换sql-2005选择大小写？

> ID：388497
> 
> 赞同：0
> 
> 时间：2008-12-23T09:37:40.667
> 
> 标签：sql, sql-server, sql-server-2005, tsql

```
select 
(Case Remark01
When 'l1' then type1
when 'l2' then type2
end) AS [?] --Remark .....want to switch name in here
from mytable 
```

例子 ....

```
select 
(Case level
When 'l1' then type1 ('l1' mean check constant string)
when 'l2' then type2(('l2' mean check constant string))
end) AS **(Case when 'l1' then [type01] Else [type02])**
from mytable 
```

```
select level,type1,type2 from mytable 
```

我使用两个程序这个 mytable
一个程序只想显示菜单 type1 只有
一个程序只想显示菜单 type2
我使用一个视图使用两个程序..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T11:36:16.093

每行切换列的名称是没有意义的。行本身没有自己的列名，包含的数据集有。

另一方面，如果您需要根据输入的数据更改列的名称，那么只需在两个名称下选择两次数据将是最简单的。例如：

```
SELECT  col1 AS alias1,
        col1 AS alias2
FROM    myTable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T10:40:56.220

您想动态命名*每行*的列吗？不幸的是，这是无法做到的。但是，如果您只有一行，那么您可以使用动态 SQL`EXEC (@sqlstring)`

但是，您的客户如何知道期望的列名？

在动态 SQL 之外或不止一行，那么您可以将名称作为另一列传递...

```
select
    Case level
      When 'l1' then type1
      when 'l2' then type2
   end AS columnvalue,
    Case level
      When 'l1' then type1
      when 'l2' then type2
   end AS outputcolumnname,
from
   mytable 
```

# multithreading - 主线程忙时在Delphi中显示启动画面

> ID：388506
> 
> 赞同：13
> 
> 时间：2008-12-23T09:42:12.327
> 
> 标签：multithreading, delphi, delphi-2007, splash-screen

我想在应用程序加载时显示启动画面。然而，一些第 3 方组件在初始化期间阻塞了主线程几秒钟，这导致所有表单不更新。是否可以使用自己的线程进行启动画面，以便在主线程忙时也会更新？

该应用程序是win32和Delphi 2007版。

编辑：我试图避免“未绘制的启动画面”效果，如果其他一些窗口（来自其他应用程序）位于启动画面的顶部，例如 alt-tabbing 到另一个应用程序并返回，就会发生这种情况。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-23T13:27:15.587

您可以在另一个线程中运行启动画面，但随后您将需要使用原始 Windows API 调用或实现类似 VCL 的类的第三方库（如[Key Objects Library ）。](http://kolmck.net/)但是不要从启动线程访问 VCL 内容。

如果你走那条路（我认为你不应该这样做，因为它做了大量工作却收效甚微），请务必遵守有关从多个线程访问 Windows API 的规则。谷歌例如“用户界面线程”以获取更多信息。

**编辑：**

我以前不知道，但实际上有一个组件在[CodeCentral 上为 Delphi 实现了一个线程启动](http://cc.embarcadero.com/Item/20139)画面。使用这个组件，它可能（还没有尝试过）实际上很容易在不同的线程中显示启动画面，但是对从辅助线程访问 VCL 的警告仍然存在。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-08-02T15:54:44.143

其实WinApi方式很简单，只要使用对话框资源即可。检查这个（即使在 D7 和 XP 上也能工作）：

```
type
  TDlgThread = class(TThread)
  private
    FDlgWnd: HWND;
    FCaption: string;
  protected
    procedure Execute; override;
    procedure ShowSplash;
  public
    constructor Create(const Caption: string);
  end;

{ TDlgThread }

// Create thread for splash dialog with custom Caption and show the dialog
constructor TDlgThread.Create(const Caption: string);
begin
  FCaption := Caption;
  inherited Create(False);
  FreeOnTerminate := True;
end;

procedure TDlgThread.Execute;
var Msg: TMsg;
begin
  ShowSplash;
  // Process window messages until the thread is finished
  while not Terminated and GetMessage(Msg, 0, 0, 0) do
  begin
    TranslateMessage(Msg);
    DispatchMessage(Msg);
  end;
  EndDialog(FDlgWnd, 0);
end;

procedure TDlgThread.ShowSplash;
const
  PBM_SETMARQUEE = WM_USER + 10;
  {$I 'Dlg.inc'}
begin
  FDlgWnd := CreateDialogParam(HInstance, MakeIntResource(IDD_WAITDLG), 0, nil, 0);
  if FDlgWnd = 0 then Exit;
  SetDlgItemText(FDlgWnd, IDC_LABEL, PChar(FCaption));           // set caption
  SendDlgItemMessage(FDlgWnd, IDC_PGB, PBM_SETMARQUEE, 1, 100);  // start marquee
end;

procedure TForm1.Button3Click(Sender: TObject);
var th: TDlgThread;
begin
  th := TDlgThread.Create('Connecting to DB...');
  Sleep(3000); // blocking wait
  th.Terminate;
end; 
```

当然，您必须准备对话框资源 ( `Dlg.rc`) 并将其添加到您的项目中：

```
#define IDD_WAITDLG 1000
#define IDC_PGB 1002
#define IDC_LABEL 1003

#define PBS_SMOOTH  0x00000001
#define PBS_MARQUEE 0x00000008

IDD_WAITDLG DIALOGEX 10,10,162,33
STYLE WS_POPUP|WS_VISIBLE|WS_DLGFRAME|DS_CENTER
EXSTYLE WS_EX_TOPMOST
BEGIN
  CONTROL "",IDC_PGB,"msctls_progress32",WS_CHILDWINDOW|WS_VISIBLE|PBS_SMOOTH|PBS_MARQUEE,9,15,144,15
  CONTROL "",IDC_LABEL,"Static",WS_CHILDWINDOW|WS_VISIBLE,9,3,144,9
END 
```

请注意这些`PBS_*`定义。我不得不添加它们，因为 Delphi 7 对这些常量一无所知。以及常量的定义 ( `Dlg.inc`)

```
const IDD_WAITDLG = 1000;
const IDC_PGB = 1002;
const IDC_LABEL = 1003; 
```

（我使用自动生成包含文件的 RadAsm 资源编辑器）。

我们在 XP 下得到了什么 [![](https://i.stack.imgur.com/CumIC.png)](https://i.stack.imgur.com/CumIC.png)

与 VCL 技巧（表单创建顺序等）相比，这种方式更好的是，当您的应用程序需要一些时间思考时，您可以多次使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-23T13:04:24.590

首先在 DPR 中创建启动画面，但不要使用**Application.CreateForm**方法。这是一些简单的代码：

```
begin
  Application.Initialize;
  SplashForm := TSplashForm.Create(nil);
  try
    SplashForm.FormStyle := fsStayOnTop;
    SplashForm.Show;
    Application.ProcessMessages;
    Application.CreateForm(TForm14, Form14);
    // Other Form Creation here . . . .
    Application.Run;
  finally
    if assigned(SplashForm) then
      SplashForm.Release;
  end;
end. 
```

然后将以下代码放入 MainFrom（在本例中为 Form14）的 Show 事件处理程序中（或稍后 - 当您的初始化完成时）：

```
SplashForm.Close;
SplashForm.Release;
SplashForm := nil; 
```

（您在表单上调用 Release 而不是 Free，并将其分配给 nil，这样 DRP 就不会再次调用 release。DRP 中的发布是为了以防您的 mainform 创建失败。）

由于您的初始表单是**FormStyle := fsStayOnTop**，因此当您的主线程阻塞时它没有收到绘制消息应该不是问题。然后，当主线程解除阻塞时，您向它发送一条更新消息（更改进度条等）。尽管我同意 Gamecat 的观点，您可能希望联系您的第 3 方组件供应商并让他们停止阻塞您的主线程。

或者，您可以在单独的线程中创建您的 3rd 方组件（前提是它们不是可视的，因为这会更困难一些。）

这也适用于将**Application.MainFormOnTaskBar**设置为 true 的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T12:03:52.730

我在启动代码中创建启动代码，始终设置在顶部，然后在适当的位置使用 frmSplash.Update 以确保它可见和更新。主窗体 create 就是这样一种称呼它的地方。

问题是Delphi 2007假定第一个窗体现在是主窗体，在核心代码中没有办法替换主窗体，所以飞溅不再那么好。也许拥有一个快速的小飞溅应用程序然后运行主应用程序的旧视觉基本解决方案实际上可能更好！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T12:09:25.527

通过在单独的线程中运行启动屏幕并不能解决阻塞主线程的问题，因为它需要主线程来进行屏幕更新。

如果启动画面没有改变，这不是问题。

也许您应该联系您的第 3 方组件供应商，因为这样的长块是一个真正的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T22:10:46.560

吉姆·麦基思（Jim McKeeth）有一个好主意，但他没有解决一件可能是也可能不是问题的事情。您谈到需要很长时间才能初始化的组件。你的意思是**初始化**部分，还是稍后发生的事情，比如在创建表单时？因为所有初始化部分都在 DPR 中的任何代码运行之前运行。这部分需要很长时间，你必须做一些棘手的事情才能让你的启动画面出现在所有它的前面：

将表单的单元尽可能靠近 .DPR 的顶部。（但不是在需要先做的事情之前，比如 FastMM）。将代码显示在该单元的初始化部分中以显示启动画面。并确保您的初始屏幕不使用任何具有较长初始化周期的单元（或使用它的单元使用......或依赖关系树中的任何位置。）然后希望它有效。

但是，如果在初始初始化堆栈完成之后才开始出现减速问题，那么请按照 Jim 所说的进行。

# c# - 在另一个程序集中读取 .config 文件

> ID：388510
> 
> 赞同：0
> 
> 时间：2008-12-23T09:44:39.717
> 
> 标签：c#, configuration, assemblies

是否有可能在 dll 程序集中读取 .config 文件？目前，我在 Assembly.Location 属性上使用 OpenExeConfiguration，这似乎有效。但我想为不同的用途创建单独的 .config 文件，如 ConfigModuleA.config、ConfigModuleB.config 等。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T09:49:08.257

您是想读取另一个应用程序配置文件还是只将配置文件的某些部分放在一个单独的文件中（例如，使其更易于管理）？

如果后者只是`configSource`在要放在其他地方的配置部分上提供一个属性。

请参阅 - [http://msdn.microsoft.com/en-us/library/ms228167.aspx](http://msdn.microsoft.com/en-us/library/ms228167.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T11:51:29.447

好的，我简化了很多。我将配置数据存储在简单的结构化 xml 文件中，并将它们嵌入到 dll 中。现在我可以毫无压力地使用 XML 序列化从 dll 中读取配置。

谢谢你的答案！

# c# - 使用 Process.Start 启动 Firefox：设置用户名和密码时 Firefox 未启动

> ID：388513
> 
> 赞同：3
> 
> 时间：2008-12-23T09:46:33.817
> 
> 标签：c#, firefox, exception, process.start, processstartinfo

当我尝试使用 Process.Start 和 ProcessStartInfo (.NET) 启动 Firefox 时，一切似乎都正常。但是当我指定另一个帐户（用户的成员）的用户名和密码时，似乎什么也没发生。相同的代码适用于 Calc.exe 或 IE。这很奇怪。有任何想法吗？

这是代码：

```
System.Diagnostics.ProcessStartInfo pInfo = new System.Diagnostics.ProcessStartInfo();
pInfo.CreateNoWindow = false;
pInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Normal;
pInfo.WorkingDirectory = "{WorkingDirectory}";
pInfo.Arguments = "{CommandLineArgs}";
pInfo.FileName = "{ExecutableAddress}";
pInfo.ErrorDialog = true;
pInfo.UseShellExecute = false;
pInfo.UserName = "{LimitedAccountUserName}";
pInfo.Password = "{SecureLimitedAccountPassword}";
System.Diagnostics.Process.Start(pInfo); 
```

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-12T12:18:17.370

为了加载具有不同凭据的应用程序，如果该应用程序使用用户配置文件，则 ProcessStartInfo 的 LoadUserProfile 属性应设置为 true。

# configuration - IntelliJ 配置目录

> ID：388517
> 
> 赞同：21
> 
> 时间：2008-12-23T09:47:03.520
> 
> 标签：configuration, intellij-idea

有没有办法配置 IntelliJ IDEA（版本 8.0.1）存储所有配置文件的目录？

默认情况下，这些文件存储在*%home%* \.IntelliJIdea80... （或 .IdeaIC12 等），但我想定义另一个位置...

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-23T10:00:58.000

你可以在你身上改变这一点`%idea installation directory%\bin\idea.properties`。就地编辑此文件或将整个文件复制到您的`%home%`目录，以在不同版本的想法中保留设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-15T14:45:54.277

可以通过编辑以下文件来更改位置：

> IDE_HOME\bin\idea.properties

按照idea.properties 文件中的注释更改默认值，确保取消注释定义这些属性的行：

*   idea.config.path
*   想法.系统.路径
*   idea.plugins.path
*   idea.log.path

[可能需要更改IDE 文件的默认位置的](https://intellij-support.jetbrains.com/entries/23358108)常见情况：

*   用户配置文件驱动器空间不足
*   磁盘很慢，您想使用更快的 HDD 或 SSD 进行缓存
*   默认用户配置文件指向 IDE 不支持的 UNC 路径
*   主目录位于网络驱动器上 未正确检测到用户配置文件目录
*   您想在 USB 记忆棒上创建便携式安装
*   主目录被加密并减慢 IDE 或导致缓存损坏
*   缓存应该从主目录中排除
*   备份防病毒或搜索索引器正在扫描影响 IDE 性能的主目录

# asp.net-mvc - MVC 在哪里渲染菜单视图

> ID：388518
> 
> 赞同：0
> 
> 时间：2008-12-23T09:47:52.597
> 
> 标签：asp.net-mvc

这就是我想要做的：

在一个页面上，我将有一个独立于页面的 LeftMenu，以及一个取决于用户当前所在页面的 RightMenu。

我想使用来自 asp.net 的 MVC。我可以使用 RenderPartial 来呈现菜单，但另一方面，视图不应该真正处理这个问题 - 所以在我看来，我认为 WinForms 比 MVC 更多。

另外，RightMenu 必须对当前显示的内容有所了解，才能根据上下文显示正确的菜单项。

你会如何处理这种情况。此外，任何有关此内容的链接将不胜感激。

**编辑**当我说视图不应该处理这个问题时，我在每个视图中都在考虑 RenderPartial，这有点令人讨厌 - 我猜是母版页方法，然后每个控制器都在 ViewModel 中放置一些东西，以便 RightMenu 知道要渲染的内容可能成为我正在寻找的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T09:50:43.183

您最好的选择是将菜单放在母版页中，并将该母版页分配给需要菜单的任何视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T23:20:47.870

在 MVC CTP 的早期，我们详细讨论了这个问题。

我不认为控制器应该将各种无关的数据（与其任务）填充到 ViewModel 中以驱动菜单。

早期的提议之一是只使用 AJAX 在控制器上调用不同的操作来获取菜单数据，我认为这太可怕了。

I haven't been working with MVC much since the CTP, but I believe a compromise was developed called RenderAction, which allows a View (or a master page) to call to a controller and spawn a partial view.

This an area where the idea of MVC really breaks down, because you start getting too much logic in your view.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T23:14:28.960

对于左侧菜单，将其放在母版页中并使用部分（用户控件）。

对于右侧菜单，请查看使用 RenderAction HtmlHelper 扩展。这允许局部视图启动自己的控制器并独立于主视图的控制器返回 ViewData。此外，您可以将数据从主视图页面的 ViewData 传递到操作方法以自定义要显示的数据。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-23T10:14:02.747

假设像框架这样的图块，您可以将左侧有菜单，右侧是正文。因此，当您创建模板时，请使用右侧部分插入独立加载的页面。您可以查找 [ [http:// tiles.apache.org/index.html][1]](http://tiles.apache.org/index.html][1])

# sharepoint - 是否可以让不同的 SharePoint Web 应用程序针对 AD 中的不同子域进行身份验证？

> ID：388541
> 
> 赞同：0
> 
> 时间：2008-12-23T10:05:24.060
> 
> 标签：sharepoint, configuration

我们正在尝试让不同的 SharePoint Web 应用程序针对不同的子域进行身份验证。
我们有三个 Web 应用程序：

*   [http://customers.xyz.com](http://customers.xyz.com)*   [http://internal.xyz.com](http://internal.xyz.com)*   [http://partners.xyz.com](http://partners.xyz.com)

我们的活动目录中有三个子域。现在我们希望这三个 Web 应用程序针对不同的子域进行身份验证。这可能吗？

亲切的问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-23T10:59:02.783

以下是我将如何解决这个问题：

*   将配置文件从整个域导入 SharedServices 提供
*   对于每个应用程序 X 仅向来自子域 X 的用户授予访问权限

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-25T02:02:23.347

我认为 Toni 建议的方案可行，但有一些警告。

1.  授予“所有经过身份验证的用户”组访问权限会破坏您的安全模型。这可能会有问题，因为高级用户有时可以授予对 SharePoint 中项目的权限。
2.  如果您不想手动将新用户输入到每个网站集（在 Web 应用程序中）的 SharePoint 用户组中，则需要制定一些 AD 组方案，从而将每个子域中的用户添加到一个安全组，每个安全组都被授予对网站集的基线权限。

或者，您可以创建 3 个共享服务提供者，每个子域一个，并将它们与适当的 Web 应用程序相关联。

jt

# eclipse - Eclipse/CDT 中的包

> ID：388552
> 
> 赞同：3
> 
> 时间：2008-12-23T10:09:09.917
> 
> 标签：eclipse, packages, projects, eclipse-cdt

在 Eclipse 中使用 CDT 项目时是否有可能拥有某种包（项目集）？

我们已经将我们的软件分离在这些包中，并使用 VS2005 和 .sln 文件作为 Windows 部分。目前我只看到两种在 Eclipse 中管理项目的方法：

*   将所有内容放在一个工作区中并放松包装订购
*   使用单独的工作区（每个包一个）并将我的自定义键/语法/...设置存储在每个工作区中（并保持它们同步！）

分离项目的主要原因是，如果您在依赖包中工作，则不需要编译（或检查是否需要编译，这也需要一段时间）所有基础项目。

如果没有我当前两种解决方案的缺点，我将不胜感激第三种解决方案:-)

吕迪格

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T12:29:17.540

查看 Eclipse 用于对项目进行分组和管理的**[工作集](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.user/concepts/cworkset.htm)**特性。

您可以从**Window** → **Working Sets** → **Edit...**菜单创建工作集。完成后，单击项目列表视图（*项目资源管理器*或*C/C++ 项目*视图）中的三角形按钮，并将**顶级元素**选项更改为工作集而不是项目。*然后，您可以从此处将项目从项目列表中的Other Projects*文件夹拖放到您定义的工作集中。然后，您可以从那里打开或关闭工作集中包含的所有项目，方法是右键单击工作集并选择**Open Project**或**Close Project**。

我不完全确定仅此一项是否能解决您的情况，但它确实帮助我在单个 Eclipse 工作区中管理我的所有 Java 项目。

# .net - 列出进程中的 AppDomain

> ID：388554
> 
> 赞同：61
> 
> 时间：2008-12-23T10:09:49.700
> 
> 标签：.net, process, appdomain

是否有可能如何在 Process 中枚举 AppDomains？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-12-23T10:25:50.353

你可能想看看[这篇文章](https://docs.microsoft.com/en-us/archive/blogs/jackg/enumerating-appdomains)

```
using System.Runtime.InteropServices;
// Add the following as a COM reference - C:\WINDOWS\Microsoft.NET\Framework\vXXXXXX\mscoree.tlb
using mscoree;                              

        public static IList<AppDomain> GetAppDomains()
        {
            IList<AppDomain> _IList = new List<AppDomain>();
            IntPtr enumHandle = IntPtr.Zero
            CorRuntimeHostClass host = new mscoree.CorRuntimeHostClass();
            try
            {
                host.EnumDomains(out enumHandle);
                object domain = null;
                while (true)
                {
                    host.NextDomain(enumHandle, out domain);
                    if (domain == null) break;
                    AppDomain appDomain = (AppDomain)domain;
                    _IList.Add(appDomain);
                }
                return _IList;
            }
            catch (Exception e)
            {
                Console.WriteLine(e.ToString());
                return null;
            }
            finally
            {
                host.CloseEnum(enumHandle);
                Marshal.ReleaseComObject(host);
            }
        } 
    } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-02-19T03:51:04.267

**更新**

您可以将接口添加`ICorRuntimeHost`为：

```
using System;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

namespace mscoree
{
    [CompilerGenerated]
    [Guid("CB2F6722-AB3A-11D2-9C40-00C04FA30A3E")]
    [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
    [TypeIdentifier]
    [ComImport]
    [CLSCompliant(false)]
    public interface ICorRuntimeHost
    {
        void _VtblGap1_11();

        void EnumDomains(out IntPtr enumHandle);

        void NextDomain([In] IntPtr enumHandle, [MarshalAs(UnmanagedType.IUnknown)] out object appDomain);

        void CloseEnum([In] IntPtr enumHandle);
    }
} 
```

并添加一个方法：

```
private static ICorRuntimeHost GetCorRuntimeHost()
{
    return (ICorRuntimeHost)Activator.CreateInstance(Marshal.GetTypeFromCLSID(new Guid("CB2F6723-AB3A-11D2-9C40-00C04FA30A3E")));
} 
```

那么您不需要 mscoree.tlb 参考。并进行一些更改：

```
using mscoree;
ICorRuntimeHost host = null;
host = GetCorRuntimeHost(); 
```

这是我当前解决此问题的代码。

* * *

**原始答案**

我将其细化为：

```
using System.Runtime.InteropServices;
using mscoree;

public static IEnumerable<AppDomain> EnumAppDomains()
{
    IntPtr enumHandle = IntPtr.Zero;
    CorRuntimeHostClass host = null;

    try
    {
        host = new CorRuntimeHostClass();
        host.EnumDomains(out enumHandle);
        object domain = null;

        host.NextDomain(enumHandle, out domain);
        while (domain != null)
        {
            yield return (AppDomain)domain;
            host.NextDomain(enumHandle, out domain);
        }
    }
    finally
    {
        if (host != null)
        {
            if (enumHandle != IntPtr.Zero)
            {
                host.CloseEnum(enumHandle);
            }

            Marshal.ReleaseComObject(host);
        }
    }
} 
```

这样称呼它：

```
foreach (AppDomain appDomain in EnumAppDomains())
{
    // use appDomain
} 
```

请记住引用 COM 对象 \WINDOWS\Microsoft.NET\Framework\vXXX\mscoree.tlb，将引用 mscoree“Embed Interop Types”设置为“False”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-27T07:24:15.490

VB.NET：

```
<System.Runtime.CompilerServices.CompilerGenerated>
<System.Runtime.InteropServices.Guid("CB2F6722-AB3A-11D2-9C40-00C04FA30A3E")>
<System.Runtime.InteropServices.InterfaceType(Runtime.InteropServices.ComInterfaceType.InterfaceIsIUnknown)>
<System.Runtime.InteropServices.ComImport>
<System.CLSCompliant(False)>
Interface ICorRuntimeHost
    Sub _VtblGap1_11()
    Sub EnumDomains(<System.Runtime.InteropServices.Out> ByRef enumHandle As IntPtr)
    Sub NextDomain(<System.Runtime.InteropServices.[In]> ByVal enumHandle As IntPtr, <System.Runtime.InteropServices.Out> <System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.IUnknown)> ByRef appDomain As Object)
    Sub CloseEnum(<System.Runtime.InteropServices.[In]> ByVal enumHandle As IntPtr)
End Interface

Private Function GetCorRuntimeHost() As ICorRuntimeHost
    Return CType(Activator.CreateInstance(System.Type.GetTypeFromCLSID(New Guid("CB2F6723-AB3A-11D2-9C40-00C04FA30A3E"))), ICorRuntimeHost)
End Function

Public Function GetAppDomains() As List(Of AppDomain)
    Dim ls As List(Of AppDomain) = New List(Of AppDomain)
    Dim enumHandle As IntPtr = IntPtr.Zero

    Dim host As ICorRuntimeHost = GetCorRuntimeHost()

    Try
        host.EnumDomains(enumHandle)
        Dim domain As Object = Nothing

        While True
            host.NextDomain(enumHandle, domain)
            If domain Is Nothing Then Exit While
            Dim appDomain As AppDomain = CType(domain, AppDomain)
            ls.Add(appDomain)
        End While

        Return ls
    Catch e As Exception
        Console.WriteLine(e.ToString())
        Return Nothing
    Finally
        host.CloseEnum(enumHandle)
        Runtime.InteropServices.Marshal.ReleaseComObject(host)
    End Try
End Function 
```

用法：

```
Dim ls As List(Of AppDomain) = GetAppDomains()
System.Console.WriteLine(ls) 
```

# vbscript - 运行脚本时的下一次迭代

> ID：388555
> 
> 赞同：1
> 
> 时间：2008-12-23T10:10:03.177
> 
> 标签：vbscript, qtp

在脚本中出现错误时，我只是使用“EXITGLOBALITERATION”命令，但它不会进入下一次迭代......还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-28T06:01:33.977

QTP 的文档有这样的说法`ExitGlobalIteration`：

> 此声明已过时。请改用 ExitTest 语句。ExitTest 语句提供 ExitRun 语句的所有功能，并且同样适用于 QuickTest 测试和 Quality Center 业务流程测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T17:44:53.353

看起来他正在谈论QTP！

我相信你应该使用 ExitActionIteration 但不知道你的测试脚本的设置很难最好地知道你想要什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T14:37:12.217

您必须在每个命令之后测试错误，就像这样

```
 On Error Resume Next
For i = 0 To 10
  'Command1
  If Err.Number = 0 Then
    'Command2
     If Err.Number = 0 Then
       'Command3
     End If
  End If
Next 
```

# asp.net-mvc - 使用 POST 对 asp.net-mvc 页面进行分页的最佳方式

> ID：388556
> 
> 赞同：2
> 
> 时间：2008-12-23T10:10:03.707
> 
> 标签：asp.net-mvc, post, paging

我有一个在表单的 POST 请求之后返回 PagedList<> 的操作方法。
我想向这个页面添加分页，但所有分页方案似乎只适用于 GET 请求。

目前添加分页控件的唯一方法是添加一堆带有一个按钮的表单来导航页面。这看起来很丑（所有表单按钮）并且会带来很多开销，因为每个表单都需要一堆隐藏字段（大约 10 个）来传输所需的参数。

有没有一种干净的方法可以向 GET 请求添加大约 12 个可选参数？或者也许有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T17:39:04.520

每个分页按钮都有一个唯一值，您需要与其他表单值一起提交。所以你真的只需要这样的东西：

```
function GoToPage(pageNumber)
{
    // submit form along with pageNumber

    return false;
}

<a href="javascript:GoToPage(1);">1</a>
<a href="javascript:GoToPage(2);">2</a>
<a href="javascript:GoToPage(3);">3</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T14:22:51.543

向 GET 请求添加许多可选参数的方法是使用查询字符串参数。使您的控制器操作的参数可以为空，如果用户提供它们，MVC 框架将用查询字符串参数填充它们，否则将它们保留为空。

我不认为使用 POST 进行分页通常是合适的。POST 旨在更新服务器资源。分页不会那样做。

# c# - 何时将 xml 与 xsl 一起使用而不是 HTML？

> ID：388557
> 
> 赞同：3
> 
> 时间：2008-12-23T10:11:32.877
> 
> 标签：c#, .net, php, xml, xslt

我喜欢 .NET webcontrols 并且你操纵事物，这是普遍的共识，但是 XML 和 XSL 非常棒，因为你有独立于平台和语言的 UI 逻辑，所以有一天我将应用程序更改为 php、java 或其他任何东西，我可以重用所有的表示逻辑。此外，XSL 可以在渲染之前调用 .NET（或其他）方法。

什么时候正常使用 XML/XSL？为什么不更频繁地使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T10:55:54.520

而不是 HTML？

我经常使用它来代替 asp.net 控件，因为它提供了 2.0 中 V 和 C 的关注点分离，而 .NET 2.0 开箱即用。

显然，还有一百万种与 asp.net 控件无关的其他用途。

* * *

编辑：实现的草图

```
public class xsltmanager
{
    /* constructor (singleton) which defines a file watcher for *.xsl in the path of your choice */

    //just a mutex for thread safety
    private object Mutex = new object();

    //caching XslCompiledTransforms
    private Dictionary<string, XslCompiledTransform> cTransforms = new Dictionary<string, XslCompiledTransform>();

    public XslCompiledTransform fetch(string identifier)
    {       
        if (!this.cTransforms.ContainsKey(identifier))
        {
            lock (this.Mutex)
            {
                if (!this.cTransforms.ContainsKey(identifier))
                {
                    XslCompiledTransform xslDoc = new XslCompiledTransform();
                    xslDoc.Load(/* file path based on identifier */);

                    this.cTransforms.Add(identifier, xslDoc);
                }
            }
        }
        return this.cTransforms[identifier];
    }

    /* other util xslt methods - namespace wash, doc merge, whatever */
}

public class myPage : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        //get source data
        XPathDocument xPathDoc = myGetXMLMethod();

        //transform params
        XsltArgumentList oArgs = new XsltArgumentList();

        /* add params as required */

        //fetching and executing the transform directly to the Response here
        xsltmanager.instance.get(@"foo\bar\baz").Transform(xPathDoc, oArgs, Response.OutputStream);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-27T07:46:51.573

大致来说，每当我需要将信息呈现为 HTML 时，我都会使用 XSLT。在过去的七年里，几乎每次我偏离这一点时，我都会后悔。我在 Python 中生成 HTML 的简短经验是我遇到的唯一可能能够替代它的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T10:44:56.773

在 ASP.NET 方面并没有那么多，但在此之前（使用 VB6）我过去几乎只使用它（在服务器上）将 xml 转换为 html。我一直发现它非常多才多艺。我还在我的“ [protocol buffers](http://code.google.com/p/protobuf-net/) ”项目中使用它作为代码生成器引擎：主框架生成 xml，然后我使用 xsl 转换生成 C#。我听人说他们不觉得 xsl 直观，但我真的很喜欢它，它是我处理 xml 时的默认 ttool。

现在，我在看很多 ASP.NET MVC，它不一定很适合 xsl - 尽管在某些方面，`<%=foo.Name%>`和`<xsl:value-of select="Name"/>`.

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-12-23T12:57:48.173

使用 XML/XSL 的开销很大，并且有很多缺点。

1.  您需要一个完整的 XML 数据集以确保 XSL 仅用作逻辑引擎。
2.  二是XSL逻辑控制差，版本间不一致。
3.  第三，组合过程相当繁重，不适合大型站点。

如果您关心逻辑分离，请使用一些模板语言（不是 XSL）。

# javascript - 一个关于javascript中eval的问题

> ID：388561
> 
> 赞同：1
> 
> 时间：2008-12-23T10:12:21.910
> 
> 标签：javascript

谢谢你。这是正确的问题：

```
{
    "VID":"60",
    "name":"\u4f1a\u9634",
    "requireLevel":"20",
    "levelMax":"5",
    "venationRequirement":"0",
    "description":"\u6c14\u6d77\u4e0a\u9650\u63d0\u9ad8[Affect1]\u70b9",
    "cost":{"1":"240","2":"360","3":"400","4":"600","5":"720"},
    "difficult":{"1":"1024","2":"973","3":"921","4":"870","5":"819"},
    "affect":{"1":"200","2":"500","3":"900","4":"1400","5":"2000"},
    "descriptions":{
        "1":"\u6c14\u6d77\u4e0a\u9650\u63d0\u9ad8200\u70b9",
        "2":"\u6c14\u6d77\u4e0a\u9650\u63d0\u9ad8500\u70b9",
        "3":"\u6c14\u6d77\u4e0a\u9650\u63d0\u9ad8900\u70b9",
        "4":"\u6c14\u6d77\u4e0a\u9650\u63d0\u9ad81400\u70b9",
        "5":"\u6c14\u6d77\u4e0a\u9650\u63d0\u9ad82000\u70b9"
    }
} 
```

我在 php 中使用 json_encode() 和 ajax 请求来获取响应文本。

## 但是当我使用 eval() 来解析响应文本时。这是错的。

Moonshadow 和 james gregory 在下面的评论中回答了这个问题。再次感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T10:17:15.207

你的第二个是错误的，因为你正在评估一个哈希，为了让它工作，你需要将它重写为：

```
var s = '{"first": {"a":1}, "second": {"b":2}}'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T10:46:18.797

Javascript 对它在什么上下文中解析什么感到有点困惑。在将字符串传递给 eval() 之前添加一个 '(' 并附加一个 ')' 以强制它将整个内容解析为一个表达式。

（正如其他人所指出的，您提出的问题也缺少外部关联数组的标签，但是您[提供](https://stackoverflow.com/questions/388561/a-question-about-eval-in-javascript#388575)的示例数据澄清了实际问题）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T10:17:50.230

如果您的第二个示例是尝试创建具有两个嵌套对象的对象，则您缺少外部对象属性的名称，例如

var s = '{ "FirstSubObject" : {"a":1}, "SecondSubObject":{"b":2}}';

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T10:14:15.913

[] 语法明确用于创建数组，而 {} 具有完全不同的含义（它认为您正在尝试创建函数/块）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T10:47:45.940

使用 json 是一个更好的解决方案。

# iframe - IE7中的目标属性

> ID：388565
> 
> 赞同：0
> 
> 时间：2008-12-23T10:14:22.967
> 
> 标签：iframe, internet-explorer-7, frames, frameset

我们有一些网页有两个框架，其中一个框架位于 IE 6 搜索栏中（使用`open("path.htm", "_search");`调用创建）。搜索栏框架中显示的页面包含按钮，单击这些按钮我们会更新右侧框架。在迁移到 IE 7 时，两个框架都在各自的窗口中打开，即，我现在打开了两个窗口。

在网上搜索时，我发现 IE 7 出于安全考虑禁用了 IE 搜索栏。我猜这是因为他们现在将搜索文本框移到了右上角，*就像*Firefox。

我的问题是，我仍然需要这两个框架。那么我应该怎么做——我一直在玩弄使用`<frameset>`标签的想法，但只是想我会在社区发帖，看看还有什么其他的选择。

注意：我*确实*搜索了互联网，但真的想不出其他选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-23T10:25:27.903

真的没有 - IE6 搜索栏显然永远不会跨浏览器工作，所以如果你坚持使用框架，你的选择是框架集和 iframe。

我建议的一个更好的选择是将您拥有的任何搜索内容简单地放在同一个页面中，它只是*看起来*像另一个框架，并让 ajax（降级为 noscripts 的页面重新加载）进行搜索和响应处理以更改其余部分页面，但这取决于搜索的性质。你能解释更多吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T12:12:05.647

有一些选择和优点和缺点。

1.)`<frameset>`如果您尝试使用页面缩放功能，IE7（及更高版本）中的会严重失败。

2.)`<frameset>`不允许任何内容悬停在框架边界上或离开框架边界（例如菜单、日历等将在框架集边界下滑动，而不是超出）

因此，我个人发现这些天框架集相当庞大且无用。

我的建议是包含所有“搜索框架”内容的一页（称为 index.html ），`<iframe>`并且右侧有一个大的用于加载内容的页面。这将解决您的问题而不会遇到太多麻烦。

```
+--------------------+
|      +------------+|
|      |            ||
|      |  iframe    ||
|      |            ||
|      |            ||
|      +------------+|
+--------------------+ 
```

总而言之，如果您可以让当前的“静态”右侧页面仅拉入内容，那将是“搜索框架”内容，这会更好，因为您不会失去书签等功能。

您可以在这里使用服务器端语言吗？例如 PHP 或类似的东西会使这个任务变得非常简单，只需使用`require_once('left_buttons');`类型调用。

# mbunit - 带有 Gallio、MbUnit 和 NCover 问题的 TestDriven.net

> ID：388570
> 
> 赞同：9
> 
> 时间：2008-12-23T10:17:29.997
> 
> 标签：mbunit, gallio, testdriven.net, ncover

为什么 TestDriven.Net 不能与我的 Gallio/mbunit 测试一起使用？

我已经将 TDD.Net 与 MbUnit v2 一起使用并且没有任何问题，但是在我的新电脑上发布的新 Gallio 版本中，它什么也没做。

从解决方案资源管理器中的 tdd 右键单击​​菜单，如果我执行“使用调试器测试”，我会在屏幕底部的 VS 状态栏中得到“0 通过，0 失败，0 跳过”。

如果我右键单击我的夹具并做同样的事情，我会得到

```
"The target type doesn't contain tests from a known test framework or a 'Main' method." 
```

如果我在单个测试中执行此操作，看起来它没有运行 SetUp，因此测试失败（但至少它运行）

我知道这听起来像[这个](https://stackoverflow.com/questions/3984/testdrivennet-is-not-running-my-setup-methods-for-mbunit)问题，但我的注册表看起来是正确的。

如果我尝试从 TDD.Net 菜单运行 NCover，则没有任何反应（除了输出窗口闪烁）

当我使用 resharper 进行“运行单元测试”时，它会将它们全部拾起并正确运行。

我正在使用 Gallio/MbUnit 3.0.5.546、TDD.Net 2.18.2268、Resharper 4.1、VS 2k8 Pro 9.0.30729.1 SP、.Net 3.5 SP1、Windows Server 2k8 (x86)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-06T23:24:48.140

你只需要确保在 Gallio 之前安装 TestDriven.Net。否则，Gallio 安装程序将不会为 TestDriven.Net 安装其扩展。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-07T03:14:47.500

还要检查您没有在夹具设置中抛出异常。这会导致*完全相同*的错误消息。

有关详细信息，请参阅错误消息之前的“测试报告”超链接（我通常忽略此链接！）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T08:57:16.690

大量卸载，重新启动和重新安装似乎已经解决了它：s

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-03T18:36:55.900

当我的测试规范类位于测试项目/命名空间以外的项目中时，我收到此错误。

# apache - 有条件的 .htaccess RewriteRule 参数

> ID：388585
> 
> 赞同：0
> 
> 时间：2008-12-23T10:27:11.740
> 
> 标签：apache, .htaccess, mod-rewrite

我的 .htaccess 中有很多 RewriteRules，看起来像这样

```
RewriteRule ^something/(\d+)/start    /index.php?ix=$1
RewriteRule ^embed/something/(\d+)/start    /index.php?ix=$1&fEmbed=1 
```

这两者之间的唯一区别是领先的“嵌入/”，所以我认为将它们组合成一个 RewriteRule 是有益的。我的尝试停留在

```
RewriteRule ^(embed/)?something/(\d+)/start    /index.php?ix=$2&fEmbed=$1 
```

其中设置了“&fEmbed=embed/”，这真的不是我想要的。我想评估 $1 的内容，并输出不同的东西（即“1”）。

在将前两个 RewriteRule 组合成一个 RewriteRule 时如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T10:44:30.503

我认为这应该是两个规则，但他们不应该做同样的事情。以下内容未经测试，但希望意图很明确，如果它不能“开箱即用”：

```
RewriteRule ^(embed/)?something/(\d+)/start$    /index.php?ix=$2
RewriteRule ^embed/(.*)    $1&fEmbed=1 
```

我假设“/start”总是在 URL 的末尾。如果没有，那就有点困难了。

**编辑：**阅读 Vegard 的评论我认为也许可以通过交换规则来处理：

```
RewriteRule ^embed/(.*)    $1&fEmbed=1
RewriteRule ^something/(\d+)/start    /index.php?ix=$1 
```

但是，这仍然取决于实际应用程序是否可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T13:04:54.963

使用 PEZ 的想法，这就是我想出的：

```
RewriteRule ^something/(\d+)/start(&fEmbed=1)?    /index.php?ixQuiz=$1&fStart=1$2
RewriteRule ^embed/(.*)                         $1&fEmbed=1 
```

不是很漂亮，但它有效。我现在可以有多个以“something/”开头的规则，并且所有这些规则都可以使用“embed/”作为前缀。

# c# - 如何为存储在 .config 文件中的数据执行计划？

> ID：388591
> 
> 赞同：0
> 
> 时间：2008-12-23T10:37:01.063
> 
> 标签：c#, asp.net, scheduler

在我的应用程序中，数据存储在一个 .config 文件中（以 XML 格式）。用户可以设置他想要邮件的日期（例如通过邮件提醒）。所以应该有一个调度程序，它将每天执行以在目标日期向用户发送邮件。由于没有数据库交互，如何运行调度程序？

我对这项任务完全空白。谁能帮我？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T10:44:34.043

您可以让应用程序在后台运行，定期检查是否需要执行任务。Windows 服务是我经常用于此类任务的。或者您可以通过编程方式创建一个 Windows 计划任务来运行您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T10:45:53.247

只需使用将运行任何 exe 的 Windows 调度程序服务，或者如果该过程非常复杂，您可以创建自己的服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T16:56:31.813

you can use the window scheduler or service which suits you best but apart from that you have the option in web application also through which you can run the scheduled task. For that you have to use the goabal.asax file .It will run after every 60 minutes . global.asax code is as follows ::

```
<code>
<%@ Application Language="C#" %>

<script runat="server">

    private const string DeliveryPageUrl = "http://put any test url of your application";

    private const string DummyCacheItemKey = "Any hard coded value";  // you can put any name here DummyCacheItemKey = "gigigagagugu";

    void Application_Start(object sender, EventArgs e) 
    {
        // Code that runs on application startup
        RegisterCacheEntry();
    }

    protected void Application_BeginRequest(Object sender, EventArgs e)
    {
        // If the dummy page is hit, then it means we want to add another item
        // in cache
        if (HttpContext.Current.Request.Url.ToString() == DeliveryPageUrl)
        {
            // Add the item in cache and when succesful, do the work.
            RegisterCacheEntry();
        }
    }
    /// <summary>
    /// Register a cache entry which expires in 60 minute and gives us a callback.
    /// </summary>
    /// <returns></returns>
    private void RegisterCacheEntry()
    {
        // Prevent duplicate key addition
        if (null != HttpContext.Current.Cache[DummyCacheItemKey]) return;

        HttpContext.Current.Cache.Add(DummyCacheItemKey, "Test", null, DateTime.MaxValue,
                                        TimeSpan.FromMinutes(60), CacheItemPriority.NotRemovable,
                                        new CacheItemRemovedCallback(CacheItemRemovedCallback));
    }
    /// <summary>
    /// Callback method which gets invoked whenever the cache entry expires.
    /// We can do our "service" works here.
    /// </summary>
    /// <param name="key"></param>
    /// <param name="value"></param>
    /// <param name="reason"></param>
    public void CacheItemRemovedCallback(string key, object value, CacheItemRemovedReason reason)
    {
        // We need to register another cache item which will expire again in one
        // minute. However, as this callback occurs without any HttpContext, we do not
        // have access to HttpContext and thus cannot access the Cache object. The
        // only way we can access HttpContext is when a request is being processed which
        // means a webpage is hit. So, we need to simulate a web page hit and then 
        // add the cache item.
        HitPage();
    }

    /// <summary>
    /// Hits a local webpage in order to add another expiring item in cache
    /// </summary>
    private void HitPage()
    {
        System.Net.WebClient client = new System.Net.WebClient();
        client.DownloadData(DeliveryPageUrl);
    }
    void Application_End(object sender, EventArgs e) 
    {
        //  Code that runs on application shutdown

    }

    void Application_Error(object sender, EventArgs e) 
    { 
        // Code that runs when an unhandled error occurs

    }

    void Session_Start(object sender, EventArgs e) 
    {
        // Code that runs when a new session is started

    }

    void Session_End(object sender, EventArgs e) 
    {
        // Code that runs when a session ends. 
        // Note: The Session_End event is raised only when the sessionstate mode
        // is set to InProc in the Web.config file. If session mode is set to StateServer 
        // or SQLServer, the event is not raised.

    }

</script>

   </code> 
```

# apache - 为什么对 Apache 提供的文本文件使用 deflate 而不是 gzip？

> ID：388595
> 
> 赞同：216
> 
> 时间：2008-12-23T10:40:12.103
> 
> 标签：apache, compression, gzip, lamp, deflate

对于 LAMP 服务器提供的 html、css 和 javascript 文件，这两种方法都有哪些优势。有更好的选择吗？

服务器使用 Json 向地图应用程序提供信息，因此需要大量的小文件。

**另请参阅[在 http 压缩中选择 gzip 而不是 deflate 是否会对性能造成影响？](https://stackoverflow.com/questions/211284/is-there-any-performance-hit-involved-in-choosing-gzip-over-deflate-for-http-co)**

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2012-03-25T00:20:09.613

> 为什么对 Apache 提供的文本文件使用 deflate 而不是 gzip？

简单的答案是**不要**。

* * *

[RFC 2616](http://www.ietf.org/rfc/rfc2616.txt)将 deflate 定义为：

> deflate RFC 1950 中定义的“zlib”格式与 RFC 1951 中描述的“deflate”压缩机制相结合

zlib 格式在[RFC 1950](http://www.ietf.org/rfc/rfc1950.txt)中定义为：

```
 0   1
     +---+---+
     |CMF|FLG|   (more-->)
     +---+---+

       0   1   2   3
     +---+---+---+---+
     |     DICTID    |   (more-->)
     +---+---+---+---+

     +=====================+---+---+---+---+
     |...compressed data...|    ADLER32    |
     +=====================+---+---+---+---+ 
```

所以，一些标头和一个 ADLER32 校验和

RFC 2616 将 gzip 定义为：

> gzip 由文件压缩程序“gzip”（GNU zip）产生的一种编码格式，如 RFC 1952 [25] 中所述。此格式是具有 32 位 CRC 的 Lempel-Ziv 编码 (LZ77)。

[RFC 1952](http://www.ietf.org/rfc/rfc1952.txt)将压缩数据定义为：

> 该格式目前使用 DEFLATE 压缩方法，但可以轻松扩展以使用其他压缩方法。

CRC-32[比 ADLER32 慢](http://en.wikipedia.org/wiki/Adler-32)

> 与相同长度的循环冗余校验相比，它以可靠性换取速度（更喜欢后者）。

所以......我们有 2 种压缩机制，它们使用**相同**的压缩算法，但对标头和校验和使用**不同**的算法。

现在，底层的 TCP 数据包已经[相当可靠](http://en.wikipedia.org/wiki/Transmission_Control_Protocol#TCP_checksum_for_IPv4)了，所以这里的问题不是 GZIP 使用的 Adler 32 vs [CRC-32](http://www.gzip.org/zlib/rfc-gzip.html)。

* * *

事实证明，多年来许多浏览器实施了不正确的放气算法。他们不期望 RFC 1950 中的 zlib 标头，而是期望压缩的有效负载。同样，各种网络服务器也犯了同样的错误。

因此，多年来，浏览器开始实现**模糊逻辑**deflate 实现，他们尝试 zlib 标头和 adler 校验和，如果失败，他们尝试有效负载。

具有这样复杂逻辑的结果是它经常被破坏。Verve Studio 有一个[用户贡献的测试](https://web.archive.org/web/20120321182910/http://www.vervestudios.co/projects/compression-tests/results)部分，显示情况有多糟糕。

例如：deflate 在 Safari 4.0 中工作，但在 Safari 5.1 中被破坏，它在 IE 上也总是有问题。

* * *

所以，最好的办法是完全避免放气，轻微的速度提升（由于 adler 32）不值得冒有效载荷损坏的风险。

* * *

## 回答 #2

> 赞同：172
> 
> 时间：2008-12-23T11:00:12.857

GZip 只是简单地放气加上校验和和页眉/页脚。不过， Deflate**更快**，因为[我学到了很多东西。](http://blog.codinghorror.com/youre-reading-the-worlds-most-dangerous-programming-blog/)

![gzip与放气图](https://codinghorror.typepad.com/.a/6a0120a85dcdae970b0120a86df584970b-pi)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-12-12T10:49:21.407

您可能无法实际选择放气作为选项。与您可能期望的相反， *mod_deflate*不是使用 deflate 而是 gzip。因此，虽然提出的大多数观点都是有效的，但它可能与大多数人无关。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-23T10:54:31.060

主要原因是 deflate 比 gzip 编码更快，并且在繁忙的服务器上可能会有所作为。对于静态页面，这是一个不同的问题，因为它们可以很容易地预压缩一次。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-23T10:56:58.013

我认为 deflate 和 gzip 之间没有太大的区别，因为 gzip 基本上只是一个包裹 deflate 的标头（参见 RFC 1951 和 1952）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-23T11:05:46.670

mod_deflate 在您的服务器上需要较少的资源，尽管您可能会在压缩量方面付出一点代价。

如果您要提供许多小文件，我建议您对压缩和未压缩的解决方案进行基准测试和负载测试 - 您可能会发现在某些情况下启用压缩不会带来节省。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-20T15:51:27.480

gzip 和 deflate 解压缩应该没有任何区别。Gzip 只是压缩了几十个字节的标头，包括一个校验和。校验和是压缩速度较慢的原因。但是，当您预压缩大量文件时，您希望将这些校验和作为文件系统中的健全性检查。此外，您可以利用命令行工具获取文件的统计信息。对于我们的网站，我们预压缩了大量静态数据（整个开放目录、13,000 款游戏、数百万关键字的自动完成等），我们的 Alexa 排名比所有网站快 95%。 [传真搜索](http://faxo.com/). 但是，我们确实使用了自制的专有网络服务器。Apache/mod_deflate 只是没有削减它。当这些文件被压缩到文件系统中时，您不仅会以最小的文件系统块大小对文件进行打击，而且还会在管理文件系统中的文件时产生所有不必要的开销，而 Web 服务器可能不太关心。您关心的应该是总磁盘占用空间和访问/解压缩时间，其次是能够预压缩此数据的速度。占用空间很重要，因为即使磁盘空间很便宜，您也希望尽可能多地放入缓存中。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-22T14:18:30.497

在已安装 Apache2 和 deflate 模块（默认情况下）的 Ubuntu 上，您可以通过两个简单的步骤启用~~deflate~~ gzip 压缩：

```
a2enmod deflate
/etc/init.d/apache2 force-reload 
```

而你走了！我发现通过我的 adsl 连接提供的页面加载速度更快。

**编辑：**根据@GertvandenBerg 的评论，这启用了gzip 压缩，而不是放气。

* * *

## 回答 #9

> 赞同：-6
> 
> 时间：2008-12-23T10:56:34.020

如果我没记错的话

*   gzip 会比 deflate 压缩一点
*   放气更有效

# communication - 汉明码是如何工作的？

> ID：388599
> 
> 赞同：15
> 
> 时间：2008-12-23T10:42:56.620
> 
> 标签：communication, hamming-code

传输数据时，汉明码显然允许您重新创建已通过线路损坏的数据（纠错码）。

这是如何工作的，如果有的话，它的局限性是什么？

有没有更好的纠错解决方案（而不是重传）？是否存在重传更好的情况？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-23T11:28:25.610

让我们试着解释一下：

我们有一个 3 位数字。可能性可以表示为一个立方体，其中每个位代表一个轴。八种可能性都在拐角处。

```
000 --------001
 | \         | \
 | 100---------101
 |  |        |  |
 |  |        |  |
010-|-------011 |
   \|          \|
   110---------111 
```

每个缺陷（例如 101 被读取为 100）都会导致立方体上的一条线发生偏移。

如果我们将两位用于数据，第三位用于奇偶校验（例如偶校验）。我们丢失了 4 个数据点。但它的优点是我们可以检测到单个位故障（它将偶数个 1 转换为奇数个 1）。奇数标有*。我们看到每个奇数（错误传输的）单词都被偶数（正确传输的）单词逼入绝境。因此，如果我们收到 100，我们可以确定它是错误的。

但是（有一个位失败）正确的表示可能是 000、101 或 110。所以我们可以检测到错误，但我们无法检测到错误：

```
 000 -------*001
  | \         | \
  |*100---------101
  |  |        |  |
  |  |        |  |
*010-|-------011 |
    \|          \|
    110--------*111 
```

这称为一位错误检测码。

如果我们使用另一位进行检查，从而为数据删除一位。我们剩下 1 个数据位和 2 个“校验位”。在这种情况下，假设 000 和 111 是有效的数据表示，而其他六个不是。现在我们有一个有趣的情况，如果在传输过程中损坏了一个位。如果我们发送 000 并接收 010，我们会看到 010 有一个有效邻居（000）和两个无效邻居（110 和 011）。所以现在我们知道我们打算发送 000 并且能够更正它：

```
 000 -------*001
  | \         | \
  |*100--------*101
  |  |        |  |
  |  |        |  |
*010-|------*011 |
    \|          \|
   *110---------111 
```

这称为一位纠错码。

请注意，一位纠错码也是两位错误检测码。

更笼统地说。

如果您有 n 个校验位，则您有一个位错误检测代码。如果您有 2n 个校验位，则您有一个位纠错码。

当然，您应该订购“有效”代码，以免它们彼此相邻。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-23T13:58:17.897

这是真正的高级概述。

```
Suppose that every time I send a message, I send thrie copies of the text.
Suppose that every time I send z message, I send three copies of the teyt.
Suppose that every tyme I send a message, I send three copies if the tezt. 
```

通过比较字符并在每个位置进行简单多数表决，您可以更正单个错误字符。然而，这种方案的成本（必须发送的数据量）很高，并且它没有捕捉到不同副本的相应位置出现*两个*错误的不太可能但可能的情况（如上面示例的最后一个字） ）。

汉明码（和其他类型的纠错码，如 Reed-Solomon）基于计算额外数据的公式（而不是简单的重复）。添加的位取决于数据位的组合，当在接收端重复计算时，复制中的错误会产生可检测的变化模式。

为了说明起见，让我们从简单的奇校验开始，添加一个位以确保消息中的总位数是奇数。因此消息`10110110`变为`101101100`（五个 1，不需要额外的 1）并且消息`10010110`变为`100101101`（四个 1，需要额外的 1）。如果你收到一个 的消息，`101101101`看到有六个 1，你就知道有错误，但不知道在哪里。假设我们添加更多奇偶校验位，每个奇偶校验位仅取决于消息的**一部分**，如下所示，通过复制所考虑的位并使用“-”表示忽略的位：

```
10110110
1-1-0-1- => 0
-0-1-1-0 =>  1
10--01-- =>   1
--11--10 =>    0
1011---- =>     0
----0110 =>      1 
```

所以完整的信息是`10110110011001`。现在假设一个传输错误改变了消息中的第三位，所以它读为`10010110011001`。当接收方重新运行错误检查计算时，匹配失败：

```
10010110
1-0-0-1- => 1*
-0-1-1-0 =>  1
10--01-- =>   1
--01--10 =>    1*
1001---- =>     1*
----0110 =>      1 
```

而不匹配的校验位正是受第三个数据位影响的校验位。这**不是**一个真正的、稳健的纠错方案；这只是一个草图，用于说明构建冗余如何帮助识别错误的确切性质。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-23T10:45:14.730

[您将在此处](http://en.wikipedia.org/wiki/Hamming_code)找到有关其工作方式的详细信息

有关纠错码的更多一般信息可[在此处获得](http://en.wikipedia.org/wiki/Error-correcting_code)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-23T11:05:24.250

有关汉明码的信息可[在此处](http://users.cs.fiu.edu/~downeyt/cop3402/hamming.html)和[此处](http://en.wikibooks.org/wiki/Data_Coding_Theory/Hamming_Codes)获得。

至于适用性，[这](http://www.cit.gu.edu.au/teaching/3142CIT/slides/ch3/node3.html)解释了原因：

1.  像汉明这样的纠错码适用于不能请求重传的单工信道。

2.  错误检测加重传通常是首选，因为它更有效。

为了比较，考虑每比特错误率的通道。让块大小为 1000 位。

为了纠正单个错误（通过汉明码），每个块需要 10 个校验位。要传输 1000 个块，需要 10,000 个校验位（开销）。为了检测单个错误，每个块一个奇偶校验位就足够了。要传输 1000 个块，只需要重新传输一个外部块（由于每比特的错误率），从而仅产生 2001 (= 1000 + 1001) 比特的开销。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T11:22:32.703

汉明码是一种数学技巧，可以纠正串行传输中多达 4 个丢失的位。它还用于支持现代存储芯片中的“奇偶校验位”。

限制在可以恢复的比特数，最多不超过4。如果丢失超过4比特，则需要重传。

不同的情况需要不同的纠错技术。其中一些技术列在此处的其他帖子中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-08T15:50:57.033

@GameCat 以及 2 位错误检测代码。

在这种情况下，假设 111 已更改为 100。那么我们可以确定有 2 位错误并且我们知道这一点，因为 111 和 100 之间的距离是 2 位，而 000 和 100 之间的距离是 1 位。因此，如果我们知道存在 2 位错误，我们就可以确定什么是正确的值。

# c - 是否有任何好的免费库可以用 C 开发 Web 应用程序？

> ID：388602
> 
> 赞同：12
> 
> 时间：2008-12-23T10:43:58.757
> 
> 标签：c

我在网上搜索了一下，但我发现的都是废弃的项目，只有 CGI 支持。

编辑：C 不仅仅用于编写驱动程序或嵌入式系统。我们有邮件阅读器、新闻阅读器、编辑器等，都是用 C 语言编写的。我在上个世纪编写了两个 BBS，当时网络还没有流行起来。图书馆越来越好，您不必一遍又一遍地重新发明轮子。在 C 中很容易实现良好的数据结构和字符串处理。但是，Web 开发中并没有太多进展。

我想回到我的根并尝试用 C 编写 Web 应用程序。

至于*糟糕的语言*：人们将 C++、Perl 和 PHP 用于 Web 应用程序。这并没有阻止他们对这些语言的普遍看法不是很好。

编辑 2：我用 C 编写了 BBS 软件，没有人认为这是一个疯狂的想法，尽管当时其他人已经在 GfA BASIC 中完成了它。我不明白为什么今天它应该被认为是一个坏主意。查看您正在使用的软件或开源软件中最常见的编程语言。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-02-04T17:29:50.047

如果您喜欢冒险并愿意使用新的 Web 服务器，请查看[G-WAN](http://gwan.com/en_faqs.html)。它使用 ANSI-C 脚本提供动态内容。它体积小、[速度快](http://gwan.com/index.html)、免费（虽然不是开源的）。浏览[带有源代码的运行示例，](http://gwan.com/en_developers.html)了解 G-WAN 开发。

如果您花时间在 G-WAN 站点上，您会注意到它的开发人员 Pierre Gauthier 对当今的软件开发状态有强烈的看法。同意或不同意，鉴于我们每天使用的工具的规模和复杂性不断增加，他的观点很有趣。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-23T12:42:10.733

正如其他人所指出的，C 不是开发 Web 应用程序的最佳语言。但是，如果应用程序的核心已经用 C 语言编写，并且当时只有一个用户可以访问应用程序，并且您可以信任该用户（例如，因为应用程序只能在防火墙后面使用） ，那么[泔水库](http://sourceforge.net/projects/swill/)是一个有趣的选择。它是一个嵌入式 Web 服务器，只需几行代码就可以为任何 C 应用程序提供 Web 界面。我已经使用了两次，用于[CScout 重构浏览器](http://www.spinellis.gr/cscout)和为遗留生产线优化代码提供用户界面，它就像一个魅力。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-31T21:21:01.040

我使用过[GNU libmicrohttpd](http://www.gnu.org/software/libmicrohttpd/)，它非常棒：清晰的 API；轻的; 开源且仍在积极开发中；它很好地嵌入到我们现有的 C 应用程序中。重要的是，它是在 LGPL 下获得许可的，但[Hughes libhttpd](http://www.hughes.com.au/products/libhttpd/)有双重许可，这对于商业项目来说可能是个问题。（归功于雅各布·埃里克森（Jakob Eriksson）首先到达那里的答案。）

编辑：这里也提到[了](https://stackoverflow.com/questions/298113/how-can-i-implement-a-restful-webservice-using-c/604745#604745)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-23T13:32:51.693

clearsilver 应该可以很好地完成工作 [http://www.clearsilver.net/docs/](http://www.clearsilver.net/docs/)

如果你需要一些 GC 的东西，你总是可以使用 boehm weisser gc。

问候弗里德里希

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T10:38:11.223

除了 Swill，我还会看[GNU libmicrohttpd](http://www.gnu.org/software/libmicrohttpd/)和[Hughes libhttpd](http://www.hughes.com.au/products/libhttpd/)。两者都旨在将 Web 服务器嵌入程序中。我几乎决定选择[Hughes](http://www.hughes.com.au/products/libhttpd/)为[Berkeley DB](http://www.oracle.com/technology/products/berkeley-db/index.html)提供各种 Web 前端，但可能会改用 Python 路线。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-02T16:32:51.897

你可以试试[libevent](http://www.monkey.org/~provos/libevent/)。它有一个[HTTP 服务器](http://www.monkey.org/~provos/libevent/doxygen-1.4.9/evhttp_8h.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-16T14:22:14.320

我没试过，也许有人会觉得它有用：[klone](http://www.koanlogic.com/klone/)。它是一个用于构建独立 Web 服务器和使用嵌入式 C 进行 html 模板的框架。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-19T17:21:39.327

忽略那些说 C 是不可接受或不可取的反对者。他们做出的假设是他们正在编写您的应用程序。这对你来说可能是一次很好的学习经历。

与其他模块相比，C 具有一些非常具体的优势。您可以轻松地为它编写一个框架，为您的应用程序完成大量繁重的工作，而无需太多努力。

危险在于代码的安全性和健全性。我的建议是尝试 Django 或 Rails，看看他们是如何“做到”的，然后将他们最好的想法带回 C。

您的开发时间可能“较慢”，但另一方面，您将对您的堆栈和框架有深入的了解。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-23T11:12:14.330

我不确定图书馆，但如果你可以访问这个网站 [vijaymukhi.com](http://www.vijaymukhi.com/) ，你可以找到一些使用 C 开发的学习项目。

您可以具体查看“机票预订”和“电子商务模块”。

注意：这只是一个带有 c 和 cgi 的学习项目。

请检查树形菜单上的“项目（带有源代码）”部分。

PS：我不建议将其用于生产/现场站点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-23T12:34:16.333

除非您对使用 C 有非常具体的要求，否则您可能应该重新考虑您的语言选择。即使有一个框架（正如你已经注意到的，这些天很难实现），C 语言的 web 应用程序也可能非常容易出错，尤其是缓冲与不受信任的用户输入相关的溢出。

如果您有一些需要访问的 SDK 或 C 中的遗留代码，并且别无选择，只能使用它，您仍然可以从另一种语言以各种方式获得这一点。

例如在 Java 中有 JNI。而且您始终可以将 SDK 包装在一个 CLI 程序中，该程序可以满足您的需求，并从您的 web 应用程序（然后可以用任何语言编写）运行它。关于缓冲区溢出等的相同警告将适用，但至少您可以在 CLI 程序中进行防御性编程（即不要相信您的参数并在使用前对其进行清理）。

另一种选择可能是将 IPC 用于提供对“C”SDK 或遗留代码功能的访问的进程。关于防御性编程的相同论点也适用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-23T13:14:30.903

很难想象 C 是开发 Web 应用程序的最佳语言的任何情况。就像您不想在 FORTRAN 中编写 GUI 应用程序或在 COBOL 中编写设备驱动程序一样。

为什么不试试 PHP？语法与 C 非常相似。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-23T13:17:57.370

嗯，几年前我写了一个“CSP”编译器，一个非常基本的等价于 JSP，但是用 C 语言。它生成 CGI C 代码。我想您可以将其用作基础或进行简单的实验。我从来没有对它做过任何事情，所以如果你想的话（如果我能找到的话）你可以拥有它……只要给我留言。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-04-20T13:50:56.503

请参阅[C 超文本库](http://hackersden.ml/chl)。

它是一个用于用 C 编写 Web 应用程序的库。它为您提供了创建出色的 Web 应用程序所需的所有功能，并支持 HTML 文件中的内联函数。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-02-24T10:48:07.360

为什么不将您遗留的 C 代码转换为 php / apache 插件？然后，您将拥有两全其美的优势，现代基于 Web 的语言/服务器，但利用了遗留应用程序中的所有现有代码。

# unix - BSD 上 tcp 数据包的大小

> ID：388615
> 
> 赞同：0
> 
> 时间：2008-12-23T10:48:27.187
> 
> 标签：unix, tcp, freebsd

如果我需要在 BSD 上找出 tcp 数据包的大小.....我们需要做什么？

是否有一些实用程序允许这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T10:51:45.043

你的意思是最大可能的尺寸？如果是这样，请谷歌搜索[MTU](http://en.wikipedia.org/wiki/Maximum_transmission_unit)（最大传输单元）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T10:52:52.903

试试空灵。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T11:15:00.893

我认为使用`tcpdump`将是最简单的解决方案。

# c# - Asp.NET ListView 数据控件动态数据绑定

> ID：388624
> 
> 赞同：2
> 
> 时间：2008-12-23T10:54:43.087
> 
> 标签：c#, asp.net, data-binding, listview

我正在尝试实现一个 ListView 数据控件来显示和编辑查找表/应用程序级变量。ListView有多个实体类可以绑定，所以ItemTemplate需要动态绑定到选中的实体对象。

例如我有：

```
AddressType { AddressTypeId, AddressTypeDescription}, 
PhoneType { PhoneTypeId, PhoneType}, 
MarriageStatusType { MarriageStatusId, marriageStatusType} 
```

这些生成的实体对象使我无法简单地执行以下代码段之类的操作，因为每个业务对象的 ID 和 Type 属性都不同。

```
<ListView>
...

<itemTemplate>
    <tr> 
       <td runat="server" id="tdId"> <%# Eval("ID") %> </td> 
       <td runat="server" id="tdType"> <%# Eval("TypeNameDescription") %> </td> 
    </tr>
</itemTemplate>

...
</ListView> 
```

我试图发现： 1.如何遍历 ListView 项目以将适当的属性值插入服务器端 html td 标记。2\. 如何在 ListView 项目上使用 Databinder.Eval 来插入该属性值。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T11:42:48.590

好的回答你的问题：

*   您可以使用父 ListView 中的 OnItemDataBound 事件来迭代 ListViewItems。然后，您可以使用它来对嵌套的子 ListView 进行数据绑定（或插入 Html 或以您需要的任何方式操作列表的内容）。确保您在处理程序后面的代码中使用 ListViewItemEventArgs，以便您可以轻松访问数据绑定项...
*   您可以使用 Databinder.Eval 使用类似这样的方法在 ListView 中动态填充中继器（注意 'GetChildCategoryData' 是代码隐藏方法）：

希望能帮助到你..

```
<asp:ListView ID="parentList" runat="server">
   <ItemTemplate>
      <asp:Repeater ID="childData" runat="server" DataSource='<%# GetChildCategoryData(DataBinder.Eval(Container.DataItem, "parentcategoryID")) %>'>.. </asp:Repeater>
   </ItemTemplate>
</asp:ListView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T11:03:41.977

也许你的答案是在 itemTemplate 中绑定一个中继器

中继器将获得 <%# Eval("DataDictionary") %> 的数据源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-09T22:30:41.940

好的，我找到了在列表视图中呈现转发器的方法，我不知道是否可以粘贴整个代码，因为它很长。结果html如下：

*   时间1 [评论：以下是列表视图中的转发器] 场景名称组名称1组名称2 S1g1Conc1g2Conc1 S2g1Conc2g2Conc2 S3g1Conc1g2Conc3
*   时间2 [评论：以下是列表视图中的转发器] 场景名称组名称1组名称2 S1g1Conc1g2Conc1 S2g1Conc2g2Conc2 S3g1Conc1g2Conc3
*   时间3 [评论：以下是列表视图中的转发器] 场景名称组名称1组名称2 S1g1Conc1g2Conc1 S2g1Conc2g2Conc2 S3g1Conc1g2Conc3

困难的部分是组的数量可以不同

我的aspx页面如下：

...嗯...论坛我不能逐字使用代码，预块不适用于某些字符

```
 KeyValuePair<string, List<scenarioItem>> myData = (KeyValuePair<string, List<scenarioItem>>)(((System.Web.UI.WebControls.ListViewDataItem)(e.Item)).DataItem);
    Repeater repeater = (Repeater)e.Item.FindControl("childData");
    repeater.HeaderTemplate = new MyTemplate(ListItemType.Header);
    repeater.ItemTemplate = new MyTemplate(ListItemType.Item);
    repeater.AlternatingItemTemplate =
       new MyTemplate(ListItemType.AlternatingItem);
    repeater.FooterTemplate = new MyTemplate(ListItemType.Footer);
    repeater.DataSource = myData.Value;
    repeater.DataBind();

public class MyTemplate : System.Web.UI.ITemplate 
```

{ System.Web.UI.WebControls.ListItemType 模板类型；public MyTemplate(System.Web.UI.WebControls.ListItemType type) { templateType = type; }

```
static void Item_DataBinding(object sender, System.EventArgs e)
{
    PlaceHolder ph = (PlaceHolder)sender;
    RepeaterItem ri = (RepeaterItem)ph.NamingContainer;
    scenarioItem myDataItem = (scenarioItem)ri.DataItem;

    if (ri.ItemIndex == 0) { 
        //create the header column part once
        //Add ScenarioName
        ph.Controls.Add(new LiteralControl("<tr><td>ScenarioName</td>"));

        //Add group concentration part
        foreach (recGroupConcItem concItem in myDataItem.mGroupConcList)
        {
            ph.Controls.Add(new LiteralControl("<td>" + concItem.groupName + @"</td>"));
        }
        ph.Controls.Add(new LiteralControl("</tr>"));

    }

    //Add ScenarioName
    ph.Controls.Add(new LiteralControl("<tr><td>"+myDataItem.scenarioName+@"</td>"));

    //Add group concentration part
    foreach (recGroupConcItem concItem in myDataItem.mGroupConcList) {
        ph.Controls.Add(new LiteralControl("<td>" + concItem.groupConc.ToString() + @"</td>"));
    }
    ph.Controls.Add(new LiteralControl("</tr>"));
}

static void ItemAlt_DataBinding(object sender, System.EventArgs e)
{
    PlaceHolder ph = (PlaceHolder)sender;
    RepeaterItem ri = (RepeaterItem)ph.NamingContainer;
    scenarioItem myDataItem = (scenarioItem)ri.DataItem;

    //Add ScenarioName
    ph.Controls.Add(new LiteralControl("<tr bgcolor=\"lightblue\"><td>" + myDataItem.scenarioName + @"</td>"));

    //Add group concentration part
    foreach (recGroupConcItem concItem in myDataItem.mGroupConcList)
    {
        ph.Controls.Add(new LiteralControl("<td>" + concItem.groupConc.ToString() + @"</td>"));
    }
    ph.Controls.Add(new LiteralControl("</tr>"));
}

static void ItemHeader_DataBinding(object sender, System.EventArgs e)
{
    PlaceHolder ph = (PlaceHolder)sender;
    RepeaterItem ri = (RepeaterItem)ph.NamingContainer;
    scenarioItem myDataItem = (scenarioItem)ri.DataItem;

    //Add ScenarioName
    ph.Controls.Add(new LiteralControl("<tr><td>ScenarioName</td>"));

    //Add group concentration part
    foreach (recGroupConcItem concItem in myDataItem.mGroupConcList)
    {
        ph.Controls.Add(new LiteralControl("<td>" + concItem.groupName + @"</td>"));
    }
    ph.Controls.Add(new LiteralControl("</tr>"));
}

public void InstantiateIn(System.Web.UI.Control container)
{
    PlaceHolder ph = new PlaceHolder();
    Label item1 = new Label();
    Label item2 = new Label();
    item1.ID = "item1";
    item2.ID = "item2";

    switch (templateType)
    {
        case ListItemType.Header:
            ph.Controls.Add(new LiteralControl("<table border=\"1\">"));
            //    "<tr><td><b>ScenarioName</b></td>" +
            //    "<td><b>Group1</b></td> <td><b>Group2</b></td> <td><b>Group3</b></td> <td><b>Group4</b></td> </tr>"));
            //ph.DataBinding += new EventHandler(ItemHeader_DataBinding);
            break;
        case ListItemType.Item:
            ph.DataBinding += new EventHandler(Item_DataBinding);
            break;
        case ListItemType.AlternatingItem:
            ph.DataBinding += new EventHandler(ItemAlt_DataBinding);
            break;
        case ListItemType.Footer:
            ph.Controls.Add(new LiteralControl("</table>"));
            break;
    }
    container.Controls.Add(ph);
} 
```

}

# c# - 空字面问题

> ID：388642
> 
> 赞同：0
> 
> 时间：2008-12-23T11:09:00.750
> 
> 标签：c#, asp.net, casting, literals

我有一个转发器，只有当它存在时才应该显示绑定的字段值。阅读[了这篇文章后](https://stackoverflow.com/questions/368169/conditional-logic-in-aspnet-page)，我决定在我的转发器中使用文字并使用 OnItemDatabound 触发器填充我的文字，但我的文字似乎无法从后面的 c# 代码访问，我不明白为什么！

这是aspx页面

```
 <asp:Repeater runat="server" ID="rpt_villaresults" OnItemDataBound="checkForChildren">
    <HeaderTemplate>

    </HeaderTemplate>
    <ItemTemplate>       
//.................MORE CODE HERE......................                           
<div class="sleeps"><h4>To Sleep</h4><h5><%#Eval("sleeps")%> <asp:Literal ID="sleepsChildrenLit" runat="server" /> </h5></div>
//.............MORE CODE HERE........................ 
```

以及背后的代码

```
public void checkForChildren(object sender, RepeaterItemEventArgs e)
{
    Literal childLit = e.Item.FindControl("sleepsChildrenLit") as Literal; 
    //this is null at runtime
    String str = e.Item.DataItem.ToString();
    if (e.Item.DataItem != null)
    {
        if (Regex.IsMatch(str, "[^0-9]"))
        {
            if (Convert.ToInt32(str) > 0)
            {
                childLit.Text = " + " + str;
            }
        }         
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T11:20:01.100

正如您所说的那样，您可能已经知道：`as Literal`它可以返回`null`值。如果您进行了正确的强制转换，您将在运行时收到一个异常，该异常将为您提供有关问题所在和/或哪个元素导致您出现问题的更多信息。

如果您总是期望“chilLit”有一个值并且您不检查空值，那么您应该使用

```
Literal childLit = (Literal)e.Item.FindControl("sleepsChildrenLit"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T11:21:05.203

好吧，使用您当前的代码，我们不知道这是因为 e.Item.FindControl 返回 null，还是因为它不是文字。这就是为什么你应该使用强制类型转换而不是“as”，如果你确定它确实应该是那种类型的话。

将代码更改为：

```
Literal childLit = (Literal) e.Item.FindControl("sleepsChildrenLit"); 
```

看看会发生什么。如果你得到一个强制转换异常，你就会知道这是因为它是错误的类型。如果您仍然获得 NRE，则 FindControl 返回 null。

编辑：现在，除此之外，让我们看看它之后的代码：

```
String str = e.Item.DataItem.ToString();
if (e.Item.DataItem != null)
{
    ...
} 
```

如果`e.item.DataItem`为 null，则对 ToString() 的调用将引发异常 - 因此下一行的检查毫无意义。我怀疑你*实际上*想要：

```
if (e.Item.DataItem != null)
{
    String str = e.Item.DataItem.ToString();
    ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T11:31:39.220

还将为转发器的 HeaderItem 调用 OnItemDataBound 事件处理程序 checkForChildren()。但在这种情况下， e.Item.DataItem 将为空。当然 FindControl() 也将返回 null，因为在 HeaderTemplate 中没有 ID 为“sleepsChildrenLit”的 Literal 控件。

您可以使用 e.Item.ItemType 属性来检查当前 Item 是 FooterItem 的 HeaderItem，还是“普通”Item，例如：

```
if (e.Item.ItemType == ListItemType.Header)
{
...
}
else if (...)
{
...
} 
```

# sql-server - 无法恢复 SQL Server 数据库 - '文件或文件组 不能为此操作选择。

> ID：388643
> 
> 赞同：7
> 
> 时间：2008-12-23T11:09:20.750
> 
> 标签：sql-server, sql-server-2005, sql-server-express

将完整数据库备份还原到不同的 SQL Server 2005 Express 服务器时，我收到以下消息：

> 无法为此操作选择文件或文件组“mydatabase_log”。RESTORE DATABASE 异常终止。（Microsoft SQL Server，错误：3219）

我检查了恢复选项以确保文件名是它可以恢复到的有效位置。

有什么建议么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-23T11:36:20.117

我通过使用还原数据库而不是还原文件来修复它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T11:26:57.140

您是否已选中选项中的“强制还原”框？

# javascript - 在 Safari for Windows 中调试 javascript

> ID：388646
> 
> 赞同：32
> 
> 时间：2008-12-23T11:14:12.313
> 
> 标签：javascript, windows, windows-vista, safari, cross-browser

有没有办法在 Windows Vista 中使用 Safari 3.2 调试 javascript？

我找到了一个名为 Drosera 的调试器的[链接](http://pietschsoft.com/post/2007/12/Safari-3-for-Windows-Enable-JavaScript-Debugging.aspx)，但我无法让它工作，因为信息接缝已经过时。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-23T11:22:59.253

好吧，除了可以从开发菜单打开的**错误控制台**（反过来可以在（首选项/高级/在菜单栏中显示开发菜单）中启用）之外，Safari AFAIK 中没有很多 javascript 调试选项。

尽管如此，错误控制台还是非常有用的，因为它显示了 javascript 错误，还允许您执行任意 Javascript 语句。

由于您使用的是 Windows，您可以尝试使用[Google Chrome](http://www.google.com/chrome)的内置 Javascript 调试器，这是一个与 Safari 非常相似的浏览器（尽管 Javascript 引擎不同）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-09-12T13:33:18.443

我通过谷歌偶然发现了这个问题 - 虽然它相当古老，但没有一个答案是完全正确的，（由于自从提出这个问题以来，safari 已更新到 5.1）

启用`develop menu`DrJokepu 提到的：

> 首选项/高级/在菜单栏中显示开发菜单

现在您将在页面菜单中看到一个选项`Show Web Inspector`，它为您提供了与 chrome 中的工具非常相似的工具，（[详情请点击此处](http://developer.apple.com/technologies/safari/developer-tools.html)）。您也可以直接从开发菜单开始调试 javascript。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-01-27T10:47:03.230

是的，您可以-> `CTRL`+ `ALT`+ `I`：[链接](https://webmasters.stackexchange.com/questions/8525/how-to-open-the-javascript-console-in-different-browsers)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-03T12:27:35.587

您可以通过在 Safari 上运行以下 JS 代码来使用[Visual Event 脚本：](http://www.sprymedia.co.uk/article/Visual+Event+2)

```
(function() {var protocol = window.location.protocol === 'file:' ?'http:' : '';var url = protocol+'//www.sprymedia.co.uk/VisualEvent/VisualEvent_Loader.js';if( typeof VisualEvent!='undefined' ) {if ( VisualEvent.instance !== null ) {VisualEvent.close();}else {new VisualEvent();}}else {var n=document.createElement('script');n.setAttribute('language','JavaScript');n.setAttribute('src',url+'?rand='+new Date().getTime());document.body.appendChild(n);}})(); 
```

或者将右侧的*可视事件*（包含在上面的链接中）拖到书签栏，然后您可以从使用受支持的 Javascript 库之一的网页上的书签栏触发它。

上述方法将查看附加到文档元素的事件处理程序。

* * *

JS 调试的另一个解决方案是使用[Firebug Lite](https://getfirebug.com/firebuglite)。这是 HTML 示例：

```
<html><header></header>
<script type="text/javascript" src="http://getfirebug.com/firebug-lite.js">{overrideConsole: false, startOpened: true, enableTrace: true}</script>
<body>Example</body>
</html> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T11:23:57.757

可以让 Drosera 运行——IIRC 您需要启用开发者菜单（通过首选项）并在 safari 首选项文件中设置一个标志。

也就是说，Drosera 很慢（由于架构的原因）并且总是有问题。如果您从[http://nightly.webkit.org](http://nightly.webkit.org)下载 nightlies，您将获得带有集成调试器的更新检查器。一个不（希望）吸的：D

[编辑：如果您确实在调试器中发现了任何错误（啊，讽刺的是：D），如果您可以将它们提交到[http://bugs.webkit.org，那就太好了]](http://bugs.webkit.org])

# javascript - 只允许数字的正则表达式

> ID：388650
> 
> 赞同：0
> 
> 时间：2008-12-23T11:16:59.767
> 
> 标签：javascript, regex

我想用正则表达式检查以下内容

```
{Today,Format} 
```

今天 - 将保持原样。在 Format 的地方，我们可以允许从 0 到 12 的数字。

例如：我们必须允许

```
{Today,0}
{Today,1}
{Today,2}
...
{Today,12} 
```

并且还必须允许

```
{Today,}
{Today,Format} 
```

请帮助我并推荐我到一些网站来发展我的正则表达式技能。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-23T11:26:54.770

```
\{Today,(\d|1[012]|Format)?\} 
```

意义：

*   打开花括号；
*   '今天​​，';
*   可选以下之一：数字 (0-9)，1 后跟 0、1 或 2 (10,11,12)，“格式”；接着
*   闭合花括号。

至于资源，我可以推荐[这个关于正则表达式](http://www.regular-expressions.info/)的网站和《[掌握正](https://rads.stackoverflow.com/amzn/click/com/0596528124)则表达式》一书。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T11:20:40.553

[txt2re.com](http://txt2re.com/)是一个出色的基于 Web 的正则表达式生成器...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T00:37:39.337

[这](http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/)是正则表达式的简短备忘单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T12:05:18.420

您可能还会发现这个[正则表达式软件列表](http://en.wikipedia.org/wiki/List_of_regular_expression_software)非常有用。[Rubular](http://rubular.com/)是我的最爱。

# service - 在 .NET 应用程序中接收 SMS 消息

> ID：388657
> 
> 赞同：2
> 
> 时间：2008-12-23T11:22:45.153
> 
> 标签：service, sms

我需要编写一个 .NET 应用程序来监听 SMS 消息，然后对其做出反应。

我假设我需要一个 SMS 网关来连接我的应用程序和 SMS 的发送者。

我怎么能实现这个。监听程序需要是网络服务还是其他？

请给我你的想法。

谢谢，查克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T11:26:58.030

您将需要一个 SMS 网关。

许多 SMS 网关允许您将回复从 SMS 发送到电子邮件。然后，您需要做的就是通过 POP 检索消息并做一些事情。

SharpWebMail 是开源的。应该是如何在某个地方做到这一点的样本。

[http://csharp-source.net/open-source/web-mail](http://csharp-source.net/open-source/web-mail)

希望有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T11:42:22.430

一种简单的方法（如果它适合您的架构）是简单地使用手机并在其上安装代码来拦截消息并将其转发到您的应用程序。

如果您想使用 .net，您可以使用 Windows Mobile 手机并将[MessageInterceptor](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.pocketoutlook.messageinterception.messageinterceptor.aspx)类与 .NET Compact Framework 一起使用。然后，当您收到消息时，使用您想要将其转发到您的应用程序的任何方法（套接字、串行端口、Web 服务......）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T11:27:21.803

您首先需要找到一个[SMS 提供商](http://www.google.com/search?rlz=1C1GGLS_nbNO293NO303&sourceid=chrome&ie=UTF-8&q=sms+provider)，然后询问他们如何集成。没有标准的方法可以做到这一点，每个人都使用自己的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T11:27:53.003

您至少需要*一些*可以为您接收 SMS 的东西。这可能是一个 GSM 调制解调器或某种形式的 SMS 网关。您如何实现“接收短信”的技术部分取决于您使用的工具。您可以通过串行端口（或 TCP）与 GSM 调制解调器通话，SMS 网关通常使用 SMPP 或 HTTP 来传输 SMS。

# .net - 从 ms-access 客户端界面切换到可执行文件

> ID：388672
> 
> 赞同：2
> 
> 时间：2008-12-23T11:33:39.077
> 
> 标签：.net, vb.net, ms-access

**在 VB、.NET 或其他微软技术中是否有任何类似于 ms-access 表单的对象？**

在过去的 2 年中，我们现在一直在使用 Access 开发客户端界面并取得了一些成功。我们正在使用一系列开发工具，充分利用元模型（我们有用于表单、本地查询、菜单、控件、连接等的表格）并坚持使用一些强大的编程技术，例如，所有的 Visual Basic 代码都是位于模块或类模块中。

因此，以表单形式保存的 VB 代码已成为标准，其生产是完全自动化的，根据控件的类型向控件添加预定义的事件（这已在[此处](https://stackoverflow.com/questions/47400/best-way-to-test-a-ms-access-application#70572)简要公开）。

除了这些形式之外，我们使用的所有其他对象都可以以某种方式从 Access/mdb 文件中取出：本地表可以保存为 xml 文件，模块可以导出为 Visual Basic 文件/用另一种语言重写. 我们不使用任何宏（“autoexec”除外）、报表（我们使用 Crystal Reports 插件）或查询（存储在“查询”表中）

然后，在另一种技术中找到类似的“表单”对象将使我们能够分发独立的/.exe 运行时文件，而不是我们当前的 .mdb 文件和 ms-access 运行时的组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T11:48:08.953

我想我误解了这个问题，但在我看来，你好像在问 WinForms 和/或 WPF。基本的 .NET Windows 客户端窗体。

这将是开始的地方。

[http://windowsclient.net/getstarted/](http://windowsclient.net/getstarted/)

至于用哪一个，我自己也不是很清楚。所以我问

[Windows 窗体何时是 WPF 的正确选择？](https://stackoverflow.com/questions/388711/when-is-winforms-the-correct-choice-vs-wpf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T11:52:59.617

在我看来，主要答案必须是常规的 Windows 窗体，或者如果您更喜欢（并且是最新的）WPF。两者都对数据绑定等有很好的支持，但是，它们都不能直接与 ms-access 表单相提并论。而且这样的表格不能单独存储，而只能作为程序集的一部分真正存在。好吧，WPF 可以像 xaml 一样独立存在*，*但即便如此，也几乎总是有大量的代码隐藏（这是程序集的一部分，不可分离）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-27T13:06:28.513

您会发现无论您做什么都需要重新编码这些表单，因为没有其他应用程序具有与 MS Access 相同的体系结构。VB.NET 中的 WinForms 并不完全一样，对于有经验的 MS Access 开发人员来说，WinForms 有几个陷阱。

实际上，您可能会发现最好的想法是使用 WPF 之类的东西，仅仅是因为它是如此不同，以至于它可以帮助您的开发人员专注于他们需要做的事情，而不是尝试移植逻辑。

无论如何，尚不清楚这些形式中会存在哪些业务逻辑。它们应该是简单的前端验证代码，最坏的情况是一些数据绑定和事件处理。您还需要能够根据您的表格自动化您的表单吗？在这种情况下，某种形式的代码生成器会有所帮助（尽管这不是一个很好的 GUI 设计策略）。

# php - PHP日期计算

> ID：388673
> 
> 赞同：2
> 
> 时间：2008-12-23T11:33:50.793
> 
> 标签：php, windows, date, format

PHP中计算指定格式的两个日期之间的天数差异的最佳（日期格式独立方式）是什么。

我尝试了以下功能：

```
function get_date_offset($start_date, $end_date)
{
  $start_time = strtotime($start_date);
  $end_time = strtotime($end_date);
  return round(($end_time-$start_time)/(3600*24));
} 
```

它在 linux 机器上工作正常，但是在 windows 下运行时 strtotime 返回 ''。

**编辑**：

输入日期为**mm/dd/yyyy**格式，但我想让它接受 $format 作为参数。

我只需要几天的差异。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T14:56:41.960

如果您不想要或无法使用 Zend Framework 或 Pear 包，请尝试此功能，我希望这会有所帮助：

```
function dateDifference($date1, $date2)
{
    $d1 = (is_string($date1) ? strtotime($date1) : $date1);
    $d2 = (is_string($date2) ? strtotime($date2) : $date2);

    $diff_secs = abs($d1 - $d2);
    $base_year = min(date("Y", $d1), date("Y", $d2));

    $diff = mktime(0, 0, $diff_secs, 1, 1, $base_year);

    return array
    (
        "years"         => abs(substr(date('Ymd', $d1) - date('Ymd', $d2), 0, -4)),
        "months_total"  => (date("Y", $diff) - $base_year) * 12 + date("n", $diff) - 1,
        "months"        => date("n", $diff) - 1,
        "days_total"    => floor($diff_secs / (3600 * 24)),
        "days"          => date("j", $diff) - 1,
        "hours_total"   => floor($diff_secs / 3600),
        "hours"         => date("G", $diff),
        "minutes_total" => floor($diff_secs / 60),
        "minutes"       => (int) date("i", $diff),
        "seconds_total" => $diff_secs,
        "seconds"       => (int) date("s", $diff)
    );
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T11:54:28.910

PEAR Date 类提供了各种功能来查找日期之间的差异以及大约 1000 种其他事物。它的文档在[这里...](http://pear.php.net/package/Date/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-23T11:53:21.673

PHP 的问题在于它没有明确的 DateTime 类型。您可以使用 Unix 时间戳或内置的 DateTime 类，但它们的功能非常有限。我希望应该有一些 3rd 方类对日期时间计算有更广泛的支持，但我没有寻找它。

使用 Unix 时间戳进行日期（而不是时间）计算也很棘手。您必须放弃时间部分，但由于夏令时 (DST)，简单地重置为 00:00 并不安全。DST 的效果是每年有两天不完全是 24 小时。因此，在添加/减去日期时，您最终可能会得到一个不能与 3600*24 均分的值。

我建议寻找一些对所有这些东西有适当支持的第 3 方类。日期/时间计算的丑陋令人敬畏。:P

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-23T13:40:10.833

Zend 框架有[Zend_Date](http://framework.zend.com/manual/en/zend.date.html)类来处理“日期数学”。它通过使用 BCMath 扩展来解决系统特定的时间戳限制，或者如果不可用，则通过系统的最大浮点值限制时间戳。

```
// example printing difference in days
require('Zend/Date.php');

$date1 = new Zend_Date();
$date1->set(2, Zend_Date::MONTH);
$date1->set(27, Zend_Date::DAY);
$date1->set(2008, Zend_Date::YEAR);

$date2 = new Zend_Date();
$date2->set(3, Zend_Date::MONTH);
$date2->set(3, Zend_Date::DAY);
$date2->set(2008, Zend_Date::YEAR);

echo ($date2->getTimestamp() - $date1->getTimestamp()) / (3600*24); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T11:40:29.780

我不确定什么是*最好*的，因为 PHP 中没有内置函数可以做到这一点，但有些人使用了[gregoriantojd()](http://no.php.net/manual/en/function.gregoriantojd.php)，例如在[这个论坛帖子](http://no.php.net/manual/en/function.date.php#84942)中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T23:51:39.693

gregoriantojd() 给出的结果与使用 strtotime() 的结果相同，请参阅此博客文章了解如何操作：

[http://www.phpro.org/examples/Calculate-Age-With-PHP.html](http://www.phpro.org/examples/Calculate-Age-With-PHP.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T00:04:37.083

以下对我有用。相信我在某个地方的 php.net 文档中找到了它。

*编辑 - 糟糕，没有看到 csl 的帖子。这是他链接中的确切功能，一定是我找到它的地方。;)

```
//Find the difference between two dates
function dateDiff($startDate, $endDate)
{
    // Parse dates for conversion
    $startArry = date_parse($startDate);
    $endArry = date_parse($endDate);

    // Convert dates to Julian Days
    $start_date = gregoriantojd($startArry["month"], $startArry["day"], $startArry["year"]);
    $end_date = gregoriantojd($endArry["month"], $endArry["day"], $endArry["year"]);

    // Return difference
    return round(($end_date - $start_date), 0);
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-09-05T06:55:13.093

为了显示事件的持续时间，我试图计算两个日期的差异。如果事件的持续时间为周五 17:00 到周日 15:00，则针对该问题给出的大多数函数都会失败。我的目标是找出日期之间的差异，例如：

```
date('Ymd',$end)-date('Tmd',$begining); 
```

但这很可能会失败，因为一年没有 99 个月，一个月没有 99 天。我可以将日期字符串转换为 UNIX 时间戳并除以 60*60*12，但有些日子的小时数或多或少，有时甚至是闰秒。因此，我使用 getdate() 创建了自己的函数，该函数返回有关时间戳的信息数组。

```
/*
 * datediff($first,$last)
 * $first - unix timestamp or string aksepted by strtotime()
 * $last - unix timestamp or string aksepted by strtotime()
 * 
 * return - the difference in days betveen the two dates
 */
function datediff($first,$last){
 $first = is_numeric($first) ? $first : strtotime($first);
 $last  = is_numeric($last ) ? $last  : strtotime($last );
 if ($last<$first){
  // Can't calculate negative difference in dates
  return -1;
 }
 $first = getdate($first);
 $last =  getdate($last );
 // find the difference in days since the start of the year
 $datediff = $last['yday'] - $first['yday'];
 // if the years do not match add the appropriate number of days.
 $yearCountedFrom = $first['year'];
 while($last['year'] != $yearCountedFrom ){
  // Take leap years into account
  if( $yearCountedFrom % 4 == 0 && $yearCountedFrom != 1900 && $yearCountedFrom != 2100 ){
   //leap year
   $datediff += 366;
  }else{
   $datediff += 365;
  }
  $yearCountedFrom++;
 }
 return $datediff;
} 
```

关于 GregorianToJD() 函数，它可能会起作用，但我有点不安，因为我不明白它是如何工作的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-23T18:57:47.543

伙计们，我们不要过度设计。

```
$d1 = strtotime($first_date);
$d2 = strtotime($second_date);
$delta = $d2 - $d1;
$num_days = ($delta / 86400); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-06T06:38:21.887

使用 PHP 计算两个日期（和时间）之间的差异。以下页面提供了一系列不同的方法（总共 7 种），用于使用 Php 执行日期/时间计算，以确定两个日期之间的时间（小时、分钟）、天、月或年的差异。

请参阅[PHP 日期时间 - 计算 2 个日期之间差异的 7 种方法](http://forums.webmasterhub.net/viewtopic.php?f=23&t=1831)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-01-30T02:12:17.660

PHP 5.2 引入了[DateTime](http://www.php.net/manual/en/class.datetime.php)和[DateInterval](http://www.php.net/manual/en/class.dateinterval.php)类，这使得这很容易：

```
function get_date_offset($start_date, $end_date)
{
    $start_time = new DateTime($start_date);
    $end_time   = new DateTime($end_date);
    $interval   = $end_time->diff($start_time);
    return $interval->format('%a days');
} 
```

# c# - 你能用C#制作一个透明的透明PNG吗？

> ID：388677
> 
> 赞同：34
> 
> 时间：2008-12-23T11:38:11.767
> 
> 标签：c#, .net, gdi+

我有一个显示垂直文本的多浏览器页面。

作为让文本在所有浏览器中垂直呈现的丑陋技巧，我创建了一个自定义页面处理程序，它返回一个带有垂直绘制文本的 PNG。

这是我的基本代码（C#3，但对任何其他版本进行了小改动，直到 1）：

```
Font f = GetSystemConfiguredFont();
//this sets the text to be rotated 90deg clockwise (i.e. down)
StringFormat stringFormat = new StringFormat { FormatFlags = StringFormatFlags.DirectionVertical };

SizeF size;
// creates 1Kx1K image buffer and uses it to find out how bit the image needs to be to fit the text
using ( Image imageg = (Image) new Bitmap( 1000, 1000 ) )
    size = Graphics.FromImage( imageg ).
        MeasureString( text, f, 25, stringFormat );

using ( Bitmap image = new Bitmap( (int) size.Width, (int) size.Height ) )
{
    Graphics g = Graphics.FromImage( (Image) image );
    g.FillRectangle( Brushes.White, 0f, 0f, image.Width, image.Height );
    g.TranslateTransform( image.Width, image.Height );
    g.RotateTransform( 180.0F ); //note that we need the rotation as the default is down

    // draw text
    g.DrawString( text, f, Brushes.Black, 0f, 0f, stringFormat );

    //make be background transparent - this will be an index (rather than an alpha) transparency
    image.MakeTransparent( Color.White );

    //note that this image has to be a PNG, as GDI+'s gif handling renders any transparency as black.
    context.Response.AddHeader( "ContentType", "image/png" );
    using ( MemoryStream memStream = new MemoryStream() )
    {
        image.Save( memStream, ImageFormat.Png );
        memStream.WriteTo( context.Response.OutputStream );
    }
} 
```

这会创建一个看起来像我想要的图像，除了透明度是基于索引的。当我返回 PNG 时，它可以支持适当的 alpha 透明度。

有没有办法在.net中做到这一点？

* * *

感谢 Vlix（见评论）我做了一些改变，虽然它仍然不正确：

```
using ( Bitmap image = new Bitmap( (int) size.Width, (int) size.Height, PixelFormat.Format32bppArgb ) )
{
    Graphics g = Graphics.FromImage( (Image) image );
    g.TranslateTransform( image.Width, image.Height );
    g.RotateTransform( 180.0F ); //note that we need the rotation as the default is down

    // draw text
    g.DrawString( text, f, Brushes.Black, 0f, 0f, stringFormat );

    //note that this image has to be a PNG, as GDI+'s gif handling renders any transparency as black.
    context.Response.AddHeader( "ContentType", "image/png" );
    using ( MemoryStream memStream = new MemoryStream() )
    {
        //note that context.Response.OutputStream doesn't support the Save, but does support WriteTo
        image.Save( memStream, ImageFormat.Png );
        memStream.WriteTo( context.Response.OutputStream );
    }
} 
```

现在 alpha 似乎可以工作了，但文本看起来是块状的 - 好像它仍然有锯齿状的边缘，但在黑色背景下。

这是 .Net/GDI+ 的一些错误吗？我已经发现它甚至无法用于 gif 的索引透明胶片，所以我对它没有多大信心。

此图像显示了出错的两种方式：

![垂直文本比较](https://i.stack.imgur.com/ONFOT.png)

顶部图像显示它没有白色背景或`MakeTransparent`呼叫。第二个用背景填充白色然后`MakeTransparent`调用添加索引透明度。

这些都不正确 - 第二个图像有我不想要的白色锯齿锯齿，第一个图像似乎与黑色完全混叠。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-04T14:44:05.483

要修复文本“块状”，你不能这样做......

```
g.TextRenderingHint = System.Drawing.Text.TextRenderingHint.ClearTypeGridFit; 
```

在这条线之后...

```
Graphics g = Graphics.FromImage( (Image) image ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-23T11:41:43.320

IIRC 您需要在位图构造函数中指定 PixelFormat。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-23T12:22:19.243

您可以使用 Bitmap 上的 LockBits 方法返回一个 BitmapData 对象，并自己设置每个像素的 Alpha（您也可以使用 GetPixel 和 SetPixel，但这些方法非常慢）。看到[这个答案](https://stackoverflow.com/questions/337631/how-to-access-each-byte-in-a-bitmap-image#337859)。

我知道这肯定有效，因为当我第一次开始使用该技术时，我将 alpha 值设置为 0，所以我设置的颜色都不可见。

编辑：这是鱼眼镜头效果的示例，完全在 .NET 中完成（使用 LockBits）：

[替代文字 http://www.freeimagehosting.net/uploads/21ca8300cc.jpg](http://www.freeimagehosting.net/uploads/21ca8300cc.jpg)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-23T12:49:06.070

对于文本抗锯齿，请使用 Graphics.TextRenderingHint 中的值。我建议不要使用 ClearType，因为它只会在 LCD 显示器（而不是 CRT）上显示得很好，并且可能由于旋转而无法工作。

**PS**这是 Vilx-，不是 Vlix。:D

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T11:47:33.247

或许你可以在这篇 CodeProject 文章的源码中找到答案：

[C# 中的每像素 Alpha 混合](http://www.codeproject.com/KB/GDI-plus/perpxalpha_sharp.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-24T13:40:27.620

对不起，我没有仔细阅读你的问题。

我知道我已经成功地在彩色背景上绘制了旋转文本，而在您的示例中没有看到任何锯齿效果。当我回去查看我的代码时，我意识到我正在使用一种逻辑字体绘制旋转的文本，该字体很好地包装在 Microsoft.WindowsCE.Forms 命名空间中。此技术将绘制角度设置为逻辑字体的属性（因此您无需调用 TranslateTransform 或 RotateTransform）。

在 Windows CE 世界之外，您必须 PInvoke 来创建逻辑字体（我从未这样做过，而且我无法快速找到一个好的示例）。我不知道这会表现如何，但我确信它会绘制旋转文本，而不会出现您所看到的奇怪的锯齿效果。我认为这肯定是 GDI+ 中的一个错误（或者只是他们认为没有人会真正使用的东西）。

另一种可能比逻辑字体表现更好的替代方法是在彩色矩形背景上正常绘制文本（刚好足以容纳文本），然后将矩形旋转并复制到主图像上。Graphics.DrawImage 似乎无法进行旋转，但使用 LockBits 很容易实现此效果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-24T11:15:51.123

事实证明，作为 CodePlex 上 Asp.Net 内容的一部分，Microsoft 有一个新的 Web 动态图像库：

[http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=16449](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=16449)

不幸的是，我想要的有点多。使用不安全的代码，我可以滚动自己的 alpha 透明度，但考虑到此代码用作高使用率 Web 应用程序的一部分，这太慢了。

这只是 MS 的 GDI+ .Net 实现中的一个错误吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-24T12:39:55.213

创建位图时至少应指定 32 位像素格式（例如：PixelFormat.Format32bppArgb），否则 GDI+ 无法管理透明度。

要在保存时调整生成的文件，可以将 Save 与 ImageCodecInfo 和 EncoderParameters 一起使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-24T14:18:05.187

或者，您可以只将文本呈现为不透明的 PNG，但使用与单元格背景颜色匹配的背景颜色（而不是白色）。

# c# - 这看起来有什么问题？

> ID：388686
> 
> 赞同：0
> 
> 时间：2008-12-23T11:43:38.590
> 
> 标签：c#, .net, oledbparameter

私有 int DBUpdate() {

```
DAL dal = new DAL();
string upd = "UPDATE [RPform] SET [ProjectName] = '@pname', [ProjectCode] = '@pcode', [Country] = @cnt, ";
upd += "[StartDate] = '@startdate', [FinishDate] = '@finishdate', [TotalParticipants] = @totpart, [ArrivalDate] = '@arrivedate', ";
upd += "[AirportTransfer] = @airtran, [AirportDate] = '@airdate', [AirportHours] = @airhour, [AirportMinutes] = @airmin, ";
upd += "[Problems] = '@problems', [FirstDayActivities] = '@fdayact' ";
upd += "WHERE [UserID]=@usid";

    OleDbParameter[] parm = new OleDbParameter[] { 
    new OleDbParameter("@pname",projname.Text),
    new OleDbParameter("@pcode",projcode.Text),
    new OleDbParameter("@cnt",countries.SelectedIndex),
    new OleDbParameter("@startdate",datestart.Text),
    new OleDbParameter("@finishdate",datefinish.Text),
    new OleDbParameter("@totpart",totalparticipants.Text),
    new OleDbParameter("@arrivedate",datearrival.Text),
    new OleDbParameter("@airtran",RadioButtonList1.SelectedValue),
    new OleDbParameter("@airdate",dateairport.Text),
    new OleDbParameter("@airhour",airporthours.SelectedIndex),
    new OleDbParameter("@airmin",airportminutes.SelectedIndex),
    new OleDbParameter("@problems",problems.Value),
    new OleDbParameter("@fdayact",firstday.Value),
    new OleDbParameter("@usid",user.ID)
    };
 return (dal.UpdateRow(upd,false,parm));
} 
```

/// 它不会导致异常，但返回 0 行受影响。当从 MS Access 中执行相同的查询时，它工作正常。因此，我认为问题在于参数的处理......但是什么？谢谢

* * *

Sergio：这样可以明确设置 OleDbTypes 吗？

```
///whatever ...
        new OleDbParameter("@problems",problems.Value),
        new OleDbParameter("@fdayact",firstday.Value),
        new OleDbParameter("@usid",user.ID)
        };
//then telling each one what they will be ... 
        parm[0].OleDbType = OleDbType.VarWChar;
        parm[1].OleDbType = OleDbType.VarWChar;

///
     return (dal.UpdateRow(upd,false,parm)); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T11:54:13.467

检查**user.ID**的值是否设置正确。

在您的**upd**命令字符串中，您用引号将参数括起来，如下所示：

```
[StartDate] = '@startdate' 
```

删除所有参数中的引号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T15:51:17.137

只是评论一下，而不是连接，如果您使用多行字符串文字，它更具可读性（并且更容易复制/粘贴）。此外，您不应将参数名称用单引号括起来，即使对于字符串参数也是如此（仅对文字使用单引号）。因此，您的原始 SQL 可能类似于：

```
string upd = @"
UPDATE [RPform] SET [ProjectName] = @pname, [ProjectCode] = @pcode, [Country] = @cnt, 
[StartDate] = @startdate, [FinishDate] = @finishdate, [TotalParticipants] = @totpart, [ArrivalDate] = @arrivedate, 
[AirportTransfer] = @airtran, [AirportDate] = @airdate, [AirportHours] = @airhour, [AirportMinutes] = @airmin, 
[Problems] = @problems, [FirstDayActivities] = @fdayact 
WHERE [UserID]=@usid
"; 
```

正如其他人指出的那样，OleDb 不使用命名参数，因此您实际上应该使用以下内容，确保按照它们在 SQL 语句中出现的相同顺序将参数添加到 OleDbCommand：

```
string upd = @"
UPDATE [RPform] SET [ProjectName] = ?, [ProjectCode] = ?, [Country] = ?, 
[StartDate] = ?, [FinishDate] = ?, [TotalParticipants] = ?, [ArrivalDate] = ?, 
[AirportTransfer] = ?, [AirportDate] = ?, [AirportHours] = ?, [AirportMinutes] = ?, 
[Problems] = ?, [FirstDayActivities] = ? 
WHERE [UserID]=?
"; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-23T13:37:03.213

抱歉，我忽略了 OleDb 提供程序**。**如果您的 SQL 命令语法用于 SQL 提供程序，则它是正确的。

因此，您的命令应如下所示：

```
string upd = "UPDATE [RPform] SET [ProjectName] = ?, [ProjectCode] = ?, [Country] = ?, ";
upd += "[StartDate] = ?, [FinishDate] = ?, [TotalParticipants] = ?, [ArrivalDate] = ?, ";
upd += "[AirportTransfer] = ?, [AirportDate] = ?, [AirportHours] = ?, [AirportMinutes] = ?, ";
upd += "[Problems] = ?, [FirstDayActivities] = ? ";
upd += "WHERE [UserID]=?"; 
```

然后你应该像你已经拥有的一样添加你的 OleDb 参数，但是你必须小心按照它们在 SQL 命令中出现的顺序添加它们。

还有一件事，但这与您的问题无关：您不应该连接字符串，因为该操作在性能方面不是很好。

相反，为了很好地布置你的 SQL 命令，试试这个：

```
StringBuilder upd = new StringBuilder();
upd.Append("UPDATE [RPform] SET [ProjectName] = ?, [ProjectCode] = ?, [Country] = ?, ");
upd.Append("[StartDate] = ?, [FinishDate] = ?, [TotalParticipants] = ?, [ArrivalDate] = ?, ");
upd.Append("[AirportTransfer] = ?, [AirportDate] = ?, [AirportHours] = ?, [AirportMinutes] = ?, ");
upd.Append("[Problems] = ?, [FirstDayActivities] = ? ");
upd.Append("WHERE [UserID]=?"); 
```

然后，要获取您的命令字符串，您只需要：

```
upd.ToString(); 
```

希望这可以帮助你。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-23T16:38:13.283

在这种情况下不要使用 StringBuilder。将逐字字符串 (@) 与格式良好的 SQL 代码一起使用：

```
var updateStatement = @"
    UPDATE [RPform]
    SET     [ProjectName]        = @pname     ,
            [ProjectCode]        = @pcode     ,
            [Country]            = @cnt       ,
            [StartDate]          = @startdate ,
            [FinishDate]         = @finishdate,
            [TotalParticipants]  = @totpart   ,
            [ArrivalDate]        = @arrivedate,
            [AirportTransfer]    = @airtran   ,
            [AirportDate]        = @airdate   ,
            [AirportHours]       = @airhour   ,
            [AirportMinutes]     = @airmin    ,
            [Problems]           = @problems  ,
            [FirstDayActivities] = @fdayact
    WHERE   [UserID]             =@usid"; 
```

但我必须注意**+= 不会被优化**！简单的 + 将在编译时执行。例如

```
string s = "A" + "B" + C"; 
```

将导致“ABC”没有性能命中但是

```
string s = "A" + variable + C"; 
```

不会优化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-23T11:52:22.987

如果在每个新的 OleDbParameter 中设置参数类型，则不需要在 sql 上放置单引号，从而使指令更不容易出现键入错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-23T12:35:29.280

顺便说一句，您可能希望使用 StringBuilder 而不是字符串来创建 upd。每次使用 += 时，您都会丢弃旧字符串并创建一个新字符串。

尝试

```
StringBuilder upd = new StringBuilder();
upd.Append("UPDATE [RPform] SET [ProjectName] = '@pname', [ProjectCode] = '@pcode', [Country] = @cnt, ");
upd.Append("[StartDate] = '@startdate', [FinishDate] = '@finishdate', [TotalParticipants] = @totpart, [ArrivalDate] = '@arrivedate', ");
upd.Append("[AirportTransfer] = @airtran, [AirportDate] = '@airdate', [AirportHours] = @airhour, [AirportMinutes] = @airmin, ");
upd.Append("[Problems] = '@problems', [FirstDayActivities] = '@fdayact' ");
upd.Append("WHERE [UserID]=@usid"); 
```

要使用它，只需

```
upd.ToString(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-23T16:16:06.683

Aight! I solved it listening to Deltron 3030 .. it always works :)

This OleDbParameter object sets its oledbtype internally, according to the type I have passed (as object to the ctor) .. so I have passed an integer coming from a TextBox (client side validated but still text, so it crashes) .. also the bool one was radiobutton.Value .. which sends True but still text so it assumes as string and encapsulates it in single quotes ... But I cannot see what names to give these params since they are nameless ...

Sorry I hate reading long articles, instead I use one of the great virtues of a programmer which is lazyness .. So I ask here :)

Thank you all for your time and efforts .. Wish you guys all the success

# sql - 产品标签关系的 SQL 查询

> ID：388687
> 
> 赞同：1
> 
> 时间：2008-12-23T11:44:20.007
> 
> 标签：sql

我有一个电子商务店面的数据库。微软 SQL 2008。

我有一个名为 Products 的表和一个名为 Tags 的表。这是由名为 ProductTags 的表绑定在一起的多对多关系。

产品：
id、名称、价格

标签：
id、name、sortorder、parentid（允许空值）

产品标签：
productid, tagid

我正在尝试在 SQL 中创建一个视图，但我完全不擅长编写 SQL。

视图应包括：
Tags.id、Tags.Name、Tags.sortorder、Tags.parentid、ProductCount、ChildTagCount

ProductCount 是与此标签关联的产品数量。ChildTagCount 是以该 Tag 的 id 作为其 parentid 的 Tag 的数量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T11:49:01.697

```
SELECT Tags.ID, Tags.Name, Tags.SortOrder, Tags.ParentID,
       COUNT(DISTINCT ProductTags.ProductID) AS ProductCount, 
       COUNT(DISTINCT ChildTags.ID) AS ChildTagCount
FROM Tags
LEFT OUTER JOIN ProductTags ON Tags.ID = ProductTags.TagID
LEFT OUTER JOIN Tags ChildTags ON Tags.ID = ChildTags.ParentID
GROUP BY Tags.ID, Tags.Name, Tags.SortOrder, Tags.ParentID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T11:48:30.233

```
Select T.id, T.Name, T.sortorder, T.parentid, 
(select count(*) from productstags where tagid=T.TagId) as ProductCount,
(select count(*) from Tags where parentid=T.TagId) as ChildTagCount
from Tags T 
```

那行得通吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T12:08:23.530

Both suggestions work. Is there any performance benifit/pain in either of them?

To be honest. The view I created myself was exactly the same as devio's - only I forgot the DISTINCT in the two COUNTs - which saw the values explode!

# excel - 将网站数据复制到 XL 2003

> ID：388688
> 
> 赞同：0
> 
> 时间：2008-12-23T11:44:25.063
> 
> 标签：excel, excel-2003, vba

我正在尝试将网站数据复制到 XL 2003 有人告诉我使用“发送密钥”，但它不起作用。请有人帮助我。

```
Sub CopyInternetDoc()

Dim IntApp As Object
Set IntApp = CreateObject("InternetExplorer.Application")
With IntApp
'       Change file name to suit
.Visible = True
.Navigate "http://test/"

CODE TO COPY data from "http://test/" to Excel   

End With
ActiveSheet.Cells.Select
Selection.ClearContents
ActiveSheet.range("A1").Select
ActiveSheet.Paste
IntApp.Quit
Set IntApp = Nothing

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-23T11:52:38.837

如果它适合您的数据源，您可以尝试改用“网络查询”。基本上，您只需设置一个带有 URL 参数的 QueryTable；有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/aa203721.aspx 。](http://msdn.microsoft.com/en-us/library/aa203721.aspx)

# .net - .NET 平台的安全漏洞？

> ID：388699
> 
> 赞同：7
> 
> 时间：2008-12-23T11:49:35.240
> 
> 标签：.net, security

我正在对 .NET 安全性进行一些研究。大多数资料只描述了 .NET 安全机制，但没有提及可能存在的漏洞或需要注意的事项。您知道.NET 平台上的任何安全问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T12:30:47.497

.NET 世界中安全问题的主要来源是使用它的开发人员。使用任何框架编写应用程序都很容易，.NET 框架也好不到哪里去。

除此之外，我能想到的唯一主要问题是所有使用 String 而不是 SecureString 来存储密码等敏感数据的控件。.NET 框架的每个版本都比这里的上一个版本好，但我认为仍然有几个常用控件不使用它们。

SecureString 可以被认为是存储在加密内存中并在使用后从内存中删除的字符串。由于 .NET 中的字符串是不可变的，因此任何新字符串都将存储在内存中的共享位置，以便具有相同值的新字符串可以共享该内存位置。这意味着存储在字符串中的敏感数据相对容易获取。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T11:54:17.677

你可以看看[Secunia](http://secunia.com/advisories/product/6456/)。它们显示了 .NET 2.0 的 14 个漏洞，零个未修补。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-23T12:04:31.090

你真的需要看看 Keith Brown[关于这个主题的优秀书籍](https://rads.stackoverflow.com/amzn/click/com/0321228359)，这是一个很好的起点。此时它已经 10 岁了，但概念没有改变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-30T23:01:13.700

对于一个非常有趣但不一定可利用的内容（因为无论如何您都需要 root 访问权限），请查看Erez Metula[在今年的 Blackhat](http://www.blackhat.com/html/bh-usa-09/bh-usa-09-speakers.html#Metula)（嗯，现在正在进行中）上关于使用一些技术破解 .NET Framework 的演讲并实现“.NET Rootkits”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-19T04:26:37.473

这是[MS09-061](http://weblog.ikvm.net/CommentView.aspx?guid=d1c6348b-acb9-4997-82b0-10a85d70e22a)的漏洞利用。

> 在我的示例类型安全漏洞利用中，我使用联合来绕过类型安全。这不是一个实际的安全漏洞，因为这样的联合需要完全信任。但是，如果我们可以组合两种不同的委托类型，我们也可以这样做，并且由于缺少类型检查，这是可能的。
> 
> 如果您使用 TypeSafetyExploitPoC.cs 并将 TypeSystemHole 方法替换为以下内容，并添加对包含 CombinePoCHelper.il 的程序集的引用（用 MSIL 编写，因为这是编写您自己的可以调用受保护的 CombineImpl 方法的 MulticastDelegate 子类的最简单方法）。

```
delegate void AnotherDelegate(Union1 u2); 

    static Union1 TypeSystemHole(Union2 u2)
    {
      Union1 u1 = null;
      CombineHelper del1 = delegate { };
      AnotherDelegate del2 = delegate(Union1 u) { u1 = u; };
      del1 = (CombineHelper)CombineHelper.CombineHack(del1, del2);
      del1(u2);
      return u1;
    } 
```

这种情况再次发生的可能性很低，恕我直言。

# c# - LINQ 中的升序/降序 - 可以通过参数更改顺序吗？

> ID：388708
> 
> 赞同：84
> 
> 时间：2008-12-23T11:52:58.990
> 
> 标签：c#, linq

我有一个方法，它给出了参数“bool sortAscending”。现在我想使用 LINQ 根据这个参数创建排序列表。我得到了这个：

```
var ascendingQuery = from data in dataList
                      orderby data.Property ascending
                      select data;

var descendingQuery = from data in dataList
                      orderby data.Property descending
                      select data; 
```

如您所见，这两个查询仅在“升序”方面有所不同。“下降”。我想合并这两个查询，但我不知道如何。有人有答案吗？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2008-12-23T12:12:11.933

您可以轻松地在 IEnumerable 或 IQueryable 上创建自己的扩展方法：

```
public static IOrderedEnumerable<TSource> OrderByWithDirection<TSource,TKey>
    (this IEnumerable<TSource> source,
     Func<TSource, TKey> keySelector,
     bool descending)
{
    return descending ? source.OrderByDescending(keySelector)
                      : source.OrderBy(keySelector);
}

public static IOrderedQueryable<TSource> OrderByWithDirection<TSource,TKey>
    (this IQueryable<TSource> source,
     Expression<Func<TSource, TKey>> keySelector,
     bool descending)
{
    return descending ? source.OrderByDescending(keySelector)
                      : source.OrderBy(keySelector);
} 
```

是的，您在这里失去了使用查询表达式的能力 - 但坦率地说，在这种情况下，我认为您实际上并没有从查询表达式中受益。查询表达式非常适合复杂的事情，但如果你只做一个操作，那么只做一个操作会更简单：

```
var query = dataList.OrderByWithDirection(x => x.Property, direction); 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2008-12-23T11:56:51.153

就如何实现而言，这改变了*方法*- 从 OrderBy/ThenBy 到 OrderByDescending/ThenByDescending。但是，您可以将排序单独应用于主查询...

```
var qry = from .... // or just dataList.AsEnumerable()/AsQueryable()

if(sortAscending) {
    qry = qry.OrderBy(x=>x.Property);
} else {
    qry = qry.OrderByDescending(x=>x.Property);
} 
```

有什么用？您可以动态创建整个“订单”，但涉及更多...

另一个技巧（主要适用于 LINQ-to-Objects）是使用 -1/1 的乘数。这仅对数字数据真正有用，但却是实现相同结果的一种厚颜无耻的方式。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-03-28T15:53:52.127

按所需属性排序 desc 怎么样，

```
 blah = blah.OrderByDescending(x => x.Property); 
```

然后做类似的事情

```
 if (!descending)
  {
       blah = blah.Reverse()
  }
  else
  {
      // Already sorted desc ;)
  } 
```

是 Reverse() 太慢了吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-07-19T11:36:49.230

除了@Jon Skeet 给出的漂亮解决方案，我还需要 ThenBy 和 ThenByDescending，所以我根据他的解决方案添加它：

```
 public static IOrderedEnumerable<TSource> ThenByWithDirection<TSource, TKey>(
         this IOrderedEnumerable<TSource> source, 
         Func<TSource, TKey> keySelector,  
         bool descending)
    {
        return descending ? 
               source.ThenByDescending(keySelector) :
               source.ThenBy(keySelector);
    } 
```

# .net - Windows 窗体何时是 WPF 的正确选择？

> ID：388711
> 
> 赞同：120
> 
> 时间：2008-12-23T11:54:11.000
> 
> 标签：.net, wpf, winforms, windows-client

> **可能重复：**
> [WPF 与 Windows 窗体](https://stackoverflow.com/questions/202079/wpf-versus-windows-forms)

我认为 WPF 旨在最终完全取代 Windows 窗体，但目前，它们都在发货。

我的问题是，什么时候比另一个更合适？我们是否应该将 Windows 窗体留给旧版并仅在 WPF 中创建新的 Windows 客户端？

免责声明：我通常不是 Windows 客户端开发人员。

# vba - 如何在 Excel 工作簿之间复制和粘贴工作表？

> ID：388715
> 
> 赞同：4
> 
> 时间：2008-12-23T11:56:44.710
> 
> 标签：vba, excel

如果您使用 VBA 打开了两个 excel 应用程序，如何将工作表从一个 excel 应用程序 (1) 传输到另一个 (2)？

问题是，程序员使用 JavaScript，当您单击将 Web 数据传输到 xl 工作簿的按钮时，它会打开一个新的 Excel 应用程序。

我知道部分代码是：

```
Workbooks.Add
ActiveSheet.Paste    
' Once I returned to the original , i.e. excel app(1). 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T12:20:50.060

未经测试，但类似：

```
Dim sourceSheet As Worksheet
Dim destSheet As Worksheet

'' copy from the source
Workbooks.Open Filename:="c:\source.xls"
Set sourceSheet = Worksheets("source")
sourceSheet.Activate
sourceSheet.Cells.Select
Selection.Copy

'' paste to the destination
Workbooks.Open Filename:="c:\destination.xls"
Set destSheet = Worksheets("dest")
destSheet.Activate
destSheet.Cells.Select
destSheet.Paste

'' save & close
ActiveWorkbook.Save
ActiveWorkbook.Close 
```

请注意，这假定目标工作表已经存在。如果没有，创建一个非常容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T20:35:16.300

你可以用 API 做点什么。

```
Private Const SW_SHOW = 5
Private Const GW_HWNDNEXT = 2

Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" _
(ByVal lpClassName As String, ByVal lpWindowName As String) As Long

Private Declare Function ShowWindow Lib "user32" _
(ByVal hWnd As Long, ByVal nCmdShow As Long) As Long

Private Declare Function GetWindow Lib "user32" _
(ByVal hWnd As Long, ByVal wCmd As Long) As Long

Private Declare Function GetClassName Lib "user32" Alias "GetClassNameA" _
(ByVal hWnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long

Private Declare Function GetWindowText Lib "user32" Alias "GetWindowTextA" _
(ByVal hWnd As Long, ByVal lpString As String, ByVal cch As Long) As Long

Function FindWindowPartialX(ByVal Title As String) As Long
    Dim hWndThis As Long
    hWndThis = FindWindow(vbNullString, vbNullString)
    While hWndThis
        Dim sTitle As String, sClass As String
        sTitle = Space$(255)
        sTitle = Left$(sTitle, GetWindowText(hWndThis, sTitle, Len(sTitle)))
        sClass = Space$(255)
        sClass = Left$(sClass, GetClassName(hWndThis, sClass, Len(sClass)))
        If InStr(sTitle, Title) > 0 Then
            FindWindowPartialX = hWndThis
            Exit Function
        End If
        hWndThis = GetWindow(hWndThis, GW_HWNDNEXT)
    Wend
End Function

Sub CopySheet()
Dim objXL As Excel.Application

' A suitable portion of the window title such as file name '
WinHandle = FindWindowPartialX("LTD.xls")

ShowWindow WinHandle, SW_SHOW

Set objXL = GetObject(, "Excel.Application")

objXL.Worksheets("Source").Activate
objXL.ActiveSheet.UsedRange.Copy

Application.ActiveSheet.Paste
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-02T19:40:07.253

我正在使用此代码，希望对您有所帮助！

```
Application.ScreenUpdating = False
Application.EnableEvents = False

Dim destination_wb As Workbook
Set destination_wb = Workbooks.Open(DESTINATION_WORKBOOK_NAME)

worksheet_to_copy.Copy Before:=destination_wb.Worksheets(1)
destination_wb.Worksheets(1).Name = worksheet_to_copy.Name
'Add the sheets count to the name to avoid repeated worksheet names error
'& destination_wb.Worksheets.Count

'optional
destination_wb.Worksheets(1).UsedRange.Columns.AutoFit

'I use this to avoid macro errors in destination_wb
Call DeleteAllVBACode(destination_wb)

'Delete source worksheet
Application.DisplayAlerts = False
worksheet_to_copy.Delete
Application.DisplayAlerts = True

destination_wb.Save
destination_wb.Close

Application.EnableEvents = True
Application.ScreenUpdating = True 
```

* * *

```
' From http://www.cpearson.com/Excel/vbe.aspx           

Public Sub DeleteAllVBACode(libro As Workbook)
    Dim VBProj As VBProject
    Dim VBComp As VBComponent
    Dim CodeMod As CodeModule

    Set VBProj = libro.VBProject

    For Each VBComp In VBProj.VBComponents
        If VBComp.Type = vbext_ct_Document Then
            Set CodeMod = VBComp.CodeModule
            With CodeMod
                .DeleteLines 1, .CountOfLines
            End With
        Else
            VBProj.VBComponents.Remove VBComp
        End If
    Next VBComp
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T01:14:24.600

我只是要发布python的答案，以便人们参考。

```
from win32com.client import Dispatch
from win32com.client import constants
import win32com.client

xlApp = Dispatch("Excel.Application")
xlWb = xlApp.Workbooks.Open(filename_xls)
ws = xlWb.Worksheets(1)
xlApp.Visible=False
xlWbTemplate = xlApp.Workbooks.Open('otherfile.xls')
ws_sub = xlWbTemplate.Worksheets(1)
ws_sub.Activate()
xlWbTemplate.Worksheets(2).Copy(None,xlWb.Worksheets(1))
ws_sub = xlWbTemplate.Worksheets(2)
ws_sub.Activate()

xlWbTemplate.Close(SaveChanges=0)
xlWb.Worksheets(1).Activate()
xlWb.Close(SaveChanges=1)
xlApp.Quit() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-23T10:33:03.560

此代码将所有工作表（不是单元格值）从一个源工作簿复制并粘贴到目标工作簿：

```
Private Sub copypastesheets()

Dim wbSource, wbDestination As Object
Dim nbSheets As Integer

Set wbSource = Workbooks("your_source_workbook_name")
Set wbDestination = Workbooks("your_destination_workbook_name")
nbSheets = wbDestination.Sheets.Count - 1

For Each sheetItem In wbSource.Sheets

    nbSheets = nbSheets + 1
    sheetItem.Copy after:=wbDestination.Sheets(nbSheets)

Next sheetItem

End Sub 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-23T13:38:00.900

您也可以完全不使用任何代码来执行此操作。如果您右键单击工作表底部的小工作表选项卡，然后选择“移动或复制”，您将看到一个对话框，让您选择将工作表传输到哪个打开的工作簿。

有关更详细的说明和屏幕截图，请参阅[此链接](http://www.officearticles.com/excel/copy_sheets_to_another_workbook_in_microsoft_excel.htm)。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-12-23T17:32:20.943

老实说，我不知道你能做到。如果您只是设置了一个测试实例并打开 Excel 两次，因为这就是您所说的发生的情况，如果您将一个工作簿命名为“test1”，如果您尝试移动一个工作簿，甚至是一个工作表他们完全不知道彼此的两个应用程序。我还注意到奇怪的行为，而只是从 Excel 实例 1 和 Excel 实例 2 手动剪切和粘贴。

您可能必须编写两个宏，类似于下车，然后从您在它们之间共享的位置上取车。也许是工具栏上的命令按钮。

也许这里的超级精英之一有更好的答案。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-01-20T17:02:11.780

当您粘贴到 Word 中时，excel 的格式/公式仍然存在。只需单击剪贴板并选择“仅保留文本”选项。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-11-11T11:58:56.443

最简单的方法：

```
Dim newBook As Workbook  
Set newBook = Workbooks.Add

Sheets("Sheet1").Copy Before:=newBook.Sheets(1) 
```

# c# - 如何使 .Net 泛型方法对值类型和引用类型表现不同？

> ID：388718
> 
> 赞同：3
> 
> 时间：2008-12-23T11:57:25.270
> 
> 标签：c#, generics

我有两种方法实现，一种用于值类型，另一种用于引用类型：

```
public static Result<T> ImplRef(T arg) where T : class {...}
public static Result<T> ImplVal(T arg) where T : struct {...} 
```

我想编写一个调用正确实现的方法，像这样

```
public static Result<T> Generic(T arg) {
    if (typeOf(T).IsValueType)
         return ImplVal(arg);
    else
         return ImplRef(arg);
} 
```

显然，上述实现无法编译。我怎样才能以最少的反射做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T12:07:30.523

泛型的想法通常是对给定的任何输入执行相同的逻辑，尽管显然您需要实用。就个人而言，我可能会使用两种不同的方法，而不是将它们强制使用相同的方法，但这会使仅知道`T`. 没有办法满足静态代码的`: class`/ `: struct`，尽管该`MakeGenericMethod`方法可能有效，但速度会慢一个数量级。

```
 // slow; use with caution
    public static Result<T> Generic<T>(T arg) {
        if (typeof(T).IsValueType)
            return (Result<T>)typeof(Program).GetMethod("ImplVal")
                .MakeGenericMethod(typeof(T))
                .Invoke(null, new object[] {arg});
        else
            return (Result<T>)typeof(Program).GetMethod("ImplRef")
                .MakeGenericMethod(typeof(T))
                .Invoke(null, new object[] { arg });
    } 
```

（替换`typeof(Program)`为承载方法的类型）

另一种方法（如 Jon 所说）是将（类型化的）委托缓存到方法中：

```
public static Result<T> Generic<T>(T arg) {
    return Cache<T>.CachedDelegate(arg);
}

internal static class Cache<T>
{
    public static readonly Func<T, Result<T>> CachedDelegate;
    static Cache()
    {
        MethodInfo method;
        if (typeof(T).IsValueType)
            method = typeof(Program).GetMethod("ImplVal")
                .MakeGenericMethod(typeof(T));
        else
            method = typeof(Program).GetMethod("ImplRef")
                .MakeGenericMethod(typeof(T));
        CachedDelegate = (Func<T, Result<T>>)Delegate.CreateDelegate(
            typeof(Func<T, Result<T>>), method);
    }
} 
```

更多的工作，但会很快。静态构造函数（或者你可以使用属性/空检查）确保我们只做一次艰苦的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T12:04:54.757

你真的*使用*`ImplRef`and中的约束`ImplVal`吗？如果不是（即，如果只是为了让您可以表现得不同），您可以放弃约束，将方法设为私有，然后适当地从以下位置调用它们`Generic`- 或者可能有：

```
public static Result<T> ImplRef(T arg) where T : class 
{
    return ImplRefImpl(arg);
}

private static Result<T> ImplRefImpl(T arg)
{
    // Real code
}

public static Result<T> ImplVal(T arg) where T : struct
{
    return ImplValImpl(arg);
}

private static Result<T> ImplValImpl(T arg)
{
    // Real code
} 
```

顺便说一下，如果是可空类型，您应该考虑该怎么做`T`- 它实际上并不满足`class`or`struct`约束。

顺便说一句，另一种测试 T 作为值类型的方法（可能更有效 - 不确定）是：

```
if (default(T) == null) 
```

请注意，与您对 IsValueType 的测试不同，这将“通过”可空类型，因此行为并不相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T12:02:45.243

您是否有理由不能使用两个单独的实现（可能都使用第三种通用实现）？

Using`typeof`意味着您正在执行[RTTI](http://en.wikipedia.org/wiki/RTTI)，这将使您的应用程序变慢。使用编译器（通过对类和结构使用单独的实现）会快得多，因为所有关于类型的决定都将在 JIT 编译期间由编译器处理。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-08-28T11:25:16.307

为什么不让编译器选择呢？

```
public static Result<T> ToResult<T>(this T arg) where T: class
{ return new ImplRef(arg); }

public static Result<T> ToResult<T>(this T arg) where T: struct
{ return new ImplVal(arg) 
```

像这样使用：

```
"hi".ToResult();
3.ToResult(); 
```

# .net - .NET 从运行代码生成序列图

> ID：388738
> 
> 赞同：4
> 
> 时间：2008-12-23T12:09:33.247
> 
> 标签：.net, sequence-diagram, auto-generate

是否有可以从运行的 .NET 代码生成序列图的工具？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T14:12:13.483

[Enterprise Architect](http://www.sparxsystems.com/)将从运行代码中生成序列图。您在希望图表开始和结束的位置设置断点，然后运行代码，它将为您提供运行代码的序列图。我已经用 C# 代码成功地做到了这一点。

[以下是用户指南中的说明。](http://www.sparxsystems.com/uml_tool_guide/visual_execution_analyzer/generating_sequence_diagrams.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-20T19:13:08.433

Sparx Systems 制造的 Enterprise Architect 非常适合从代码生成序列图。它基本上记录（基于您的起点/终点）运行时并吐出一个序列图。他们甚至在他们网站的某个地方有一个视频演示。我认为 EA 的价格在 200 美元到 300 美元之间，但仍然是一个很棒的工具。

[该视频演示展示了如何在 EA 中设置源代码/调试，最后您将看到如何生成序列图。](http://www.sparxsystems.com/resources/demos/ASP_Net/ASP_NET.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T12:17:11.983

我自己不久前对此进行了研究，[我认为 SDE 可以满足您的需要](http://www.visual-paradigm.com/product/sde/vs/demos/umlsupport/sequence.jsp)（我无法说服管理层继续进行研究，但演示看起来不错）

编辑：哦，也试试[visual uml](http://www.visualobject.com/default.htm)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-23T14:05:23.937

你什么意思？从运行时执行路径确定时序图？我不相信这是可能的。

如果您打算从代码和数据**创建序列图，那么**[Northwoods 的 GoDiagram 工具](http://www.nwoods.com/)可以创建非常复杂的图表，我相信序列图肯定是可行的。而且，顺便说一句，收集正确的诊断数据也可以解决第一个问题......

# vba - SSRS 中的惰性评估

> ID：388748
> 
> 赞同：4
> 
> 时间：2008-12-23T12:18:57.130
> 
> 标签：vba, reporting-services, switch-statement, iif

我正在使用 SSRS 2005 生成报告，报告中的一列是简单的平均值计算。我不想除以零，所以对于我输入的文本框值：

`=Switch(Fields!Count.Value=0,0,Fields!Count.Value>0,Fields!Sum.Value/Fields!Count.Value)`

这仍然计算第二个表达式。

也是如此：

`=IIF(Fields!Count.Value=0,0,Fields!Sum.Value/Fields!Count.Value)`

我不希望我的报告显示错误。我该如何克服这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T14:13:26.603

不幸的是，因为 IIF 实际上只是一个函数，所以在调用函数之前所有参数都会被评估（导致你被零除）。

在表达式中嵌入复杂逻辑的一种方法是在报表中嵌入函数。您可以编写一个 VB 函数以在报告属性的代码选项卡中返回您喜欢的任何内容。

```
Public Function GetMeanValue(ByVal Sum as Decimal, ByVal Count As Int) As Decimal
    'your logic in plain old vb syntax here

End Function 
```

在文本框文本表达式属性中：

```
=Code.GetMeanValue(Fields!Sum.Value, Fields!Count.Value) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T13:43:50.680

尝试这个：

`=IIf(Fields!Count.Value = 0, 0, Fields!Sum.Value / IIf(Fields!Count.Value = 0, 1, Fields!Count.Value))`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-13T10:59:29.953

在检查零时，我总是否定这样的表达式：

```
=IIF(Fields!Count.Value<>0,Fields!Sum.Value/Fields!Count.Value,0) 
```

`Count`如果字段为空/空，这具有避免除法的额外好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-05T15:11:29.683

这是一直对我有用的解决方案： [避免除以零错误](http://blogs.msdn.com/bwelcker/archive/2006/09/26/End-of-Amnesia-_2800_Avoiding-Divide-By-Zero-Errors_2900_.aspx)。

如果报告有太多的部门，它会变得乏味。我更喜欢一些 vb 代码来进行除法并处理除以零。不确定过多的 vb 代码是否会降低报告的性能。

以下是[如何使用 vb](https://web.archive.org/web/20090601092626/http://blogs.digineer.com/blogs/jasons/archive/2006/08/18/374.aspx) 将他的链接替换为 archive.org 链接。以下是该链接的相关内容：

> 我没有将该计算放入所有进行除法的文本框中，而是进入报告>>报告属性>>代码并放入以下代码：
> 
> 公共共享函数 Divide(Num1 as double, Num2 as double) AS 对象
> 
> ```
>  IF ISNOTHING(Num2) Or Num2 = 0 Then
>         Divide = "n/a"
>     ELSEIF Num1 = 0 THEN
>         Divide = 0
>     ELSE
>         Divide = Num1  / Num2
>     END IF
> End Function 
> ```
> 
> 然后在报告中我需要进行除法的每个文本框中，我调用这样的函数：
> 
> ```
> =Code.Divide(1, 0) 
> ```

# php - 用于 openID 的 PHP 库

> ID：388749
> 
> 赞同：20
> 
> 时间：2008-12-23T12:19:07.113
> 
> 标签：php, openid

哪个是用于 openID 集成的最佳 PHP 库？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-23T12:23:23.890

对于 PHP，我发现**[Zend Framework OpenID 组件](http://framework.zend.com/manual/en/zend.openid.html)**非常好。

您还可以在[**此链接中查看所有可用的 OpenID 库**](http://wiki.openid.net/Libraries)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T12:21:43.457

[PHP OpenID 库](http://openidenabled.com/php-openid/)很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-23T15:49:37.173

我推荐[JanRain 的图书馆](http://openidenabled.com/files/php-openid/docs/2.1.2/)，他们说 80% 的启用 OpenID 的用户都使用它（可能是最早的用户之一），但您也可以使用他们的 RPX 服务将它们作为服务提供商用于 OpenID 身份验证，或者只是让他们通过他们的[myOpenID 域工具](https://www.myopenid.com/new_domain)为您完成所有工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-23T12:21:33.880

看看[OpenID 的库列表](http://wiki.openid.net/Libraries)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-15T22:04:10.447

PEAR 还有一个不错的[OpenId 包](http://pear.php.net/package/OpenID)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T16:52:57.167

市场上有很多库，只需要根据您的需要测试最好的库，但如果您正在考虑提供身份作为 OPENID 提供者，那么它们只有三个库，只有 PHPOPENID 库、Zend 和 NetMesh InfoGrid LID。大多数人选择 Zend 是因为他们提供了其他类型的框架并且易于实现。

# postgresql - SELECT 可空引用

> ID：388763
> 
> 赞同：0
> 
> 时间：2008-12-23T12:29:39.730
> 
> 标签：postgresql, select, foreign-keys

我在两个表、作者和样式之间有关系。每个作者都与一种风格相关联，在特殊情况下作者没有风格（IS NULL）。

将引用设置为 NULL 没有问题，但是执行查询以选择作者和样式时出现问题。

例如，查询：

```
SELECT "authors"."id", "authors"."name", "styles"."name", "authors"."comments" FROM 
"authors" , "styles" WHERE "authors"."style" = "styles"."id" 
```

只是忽略具有 NULL 样式的作者（如预期的那样）。

我需要做一个选择，它还列出了具有 NULL 样式的作者，就像左连接一样（由于某些原因，我不能使用 LEFT JOIN）。

有一个不包括显式连接的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T12:35:26.083

最明显的解决方案是 LEFT OUTER JOIN。

见：[http ://www.postgresql.org/docs/8.1/static/tutorial-join.html](http://www.postgresql.org/docs/8.1/static/tutorial-join.html)

如果您不想使用显式连接，您应该能够使用 UNION

```
SELECT "authors"."id", "authors"."name", "styles"."name", "authors"."comments" FROM 
"authors" , "styles" WHERE "authors"."style" = "styles"."id"
UNION
SELECT "authors"."id", "authors"."name", "", "authors"."comments" FROM 
"authors" WHERE "authors"."style" IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T12:45:21.757

我认为如果你不能使用 LEFT JOIN，你应该使用 UNION。
查看来自 Coding Horror 的链接，它非常有趣。 [SQL 连接的可视化解释](https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T12:35:37.643

```
SELECT "authors"."id", "authors"."name", "styles"."name", "authors"."comments" FROM    "authors" , "styles" WHERE "authors"."style" = "styles"."id" OR "authors"."style" = null 
```

你试过吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T12:38:44.373

据我了解，您只需要扩展查询以包含 NULL：

```
SELECT "authors"."id", "authors"."name", "styles"."name", "authors"."comments" 
FROM "authors" , "styles" 
WHERE "authors"."style" = "styles"."id" OR "authors"."style" IS NULL 
```

# c# - 如何从 C# (2.0) 中的属性中获取属性的名称

> ID：388775
> 
> 赞同：6
> 
> 时间：2008-12-23T12:37:10.197
> 
> 标签：c#, reflection, properties

我知道我可以有一个属性，但这比我想做的工作要多……而且不够笼统。

我想做类似的事情

```
class Whotsit
{
    private string testProp = "thingy";

    public string TestProp 
    {
        get { return testProp; }
        set { testProp = value; }
    }

}

...

Whotsit whotsit = new Whotsit();
string value = GetName(whotsit.TestProp); //precise syntax up for grabs.. 
```

我希望值等于“TestProp”

但我一辈子都找不到正确的反射方法来编写 GetName 方法......

编辑：我为什么要这样做？我有一个类来存储从“名称”、“值”表中读取的设置。这是由基于反射的通用方法填充的。我很想写反...

```
/// <summary>
/// Populates an object from a datatable where the rows have columns called NameField and ValueField. 
/// If the property with the 'name' exists, and is not read-only, it is populated from the 
/// valueField. Any other columns in the dataTable are ignored. If there is no property called
/// nameField it is ignored. Any properties of the object not found in the data table retain their
/// original values.
/// </summary>
/// <typeparam name="T">Type of the object to be populated.</typeparam>
/// <param name="toBePopulated">The object to be populated</param>
/// <param name="dataTable">'name, 'value' Data table to populate the object from.</param>
/// <param name="nameField">Field name of the 'name' field'.</param>
/// <param name="valueField">Field name of the 'value' field.</param>
/// <param name="options">Setting to control conversions - e.g. nulls as empty strings.</param>

public static void PopulateFromNameValueDataTable<T>
        (T toBePopulated, System.Data.DataTable dataTable, string nameField, string valueField, PopulateOptions options)
    {
        Type type = typeof(T);
        bool nullStringsAsEmptyString = options == PopulateOptions.NullStringsAsEmptyString;

        foreach (DataRow dataRow in dataTable.Rows)
        {
            string name = dataRow[nameField].ToString();
            System.Reflection.PropertyInfo property = type.GetProperty(name);
            object value = dataRow[valueField];

            if (property != null)
            {
                Type propertyType = property.PropertyType;
                if (nullStringsAsEmptyString && (propertyType == typeof(String)))
                {
                    value = TypeHelper.EmptyStringIfNull(value);
                }
                else
                {
                    value = TypeHelper.DefaultIfNull(value, propertyType);
                }

                property.SetValue(toBePopulated, System.Convert.ChangeType(value, propertyType), null);
            }
        }
    } 
```

进一步编辑：我只是在代码中，有一个 Whotsit 实例，我想获取“TestProp”属性的文本字符串。我知道这似乎有点奇怪，我可以只使用文字“TestProp” - 或者在我的类到数据表函数的情况下，我会在 PropertyInfos 的 foreach 循环中。我只是好奇而已...

原始代码有字符串常量，我发现它很笨拙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T12:45:32.613

不，没有什么可做的。该表达式`whotsit.TestProp`将评估该属性。您想要的是神话般的“infoof”运算符：

```
// I wish...
MemberInfo member = infoof(whotsit.TestProp); 
```

事实上，您只能使用反射来按名称获取属性 - 而不是从代码中获取。（当然，或者获取所有属性。但它仍然对您的样本没有帮助。）

一种替代方法是使用表达式树：

```
Expression<Func<string>> = () => whotsit.TestProp; 
```

然后检查表达式树以获取属性。

如果这些都没有帮助，也许您可​​以告诉我们更多关于您为什么需要此功能的信息？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T13:11:58.380

这是可能的（没有反射），但仅限于最新的 C# 3.0

**快速且非常肮脏**

```
class Program
{
    static void Main()
    {
        string propertyName = GetName(() => AppDomain.CurrentDomain);
        Console.WriteLine(propertyName); // prints "CurrentDomain"
        Console.ReadLine();
    }

    public static string GetName(Expression<Func<object>> property)
    {
        return property.Body.ToString().Split('.').Last();
    }
} 
```

**更新：**我刚刚意识到[**Jon Skeet**](https://stackoverflow.com/questions/305223/jon-skeet-facts)（有人惊讶吗？:) 已经涵盖了这种可能性，但我会在这里保留我的答案，以防有人对某个示例感兴趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T12:47:29.490

你试图做的事情是不可能的。使用反射，您可以：

*   从字符串名称中获取属性、字段或方法的详细信息。
*   获取给定类型的所有属性、字段或方法的列表。

您的 GetName 方法在调用时会传递一个字符串。GetMethod 将知道该字符串，但不保留源属性元数据。

出于兴趣，你为什么要这样做？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T12:53:03.363

我认为这是不可能的，唯一的方法是迭代属性：

```
class TestClass
{
    private string _field;

    public string MyProperty
    {
        get { return _field; }
    }
}
class Program
{
    static void Main(string[] args)
    {
        TestClass test = new TestClass();
        PropertyInfo[] info = test.GetType().GetProperties();
        foreach(PropertyInfo i in info)
            Console.WriteLine(i.Name);
        Console.Read();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T13:30:03.740

Kpollack，你在之前的评论中说：

> 这仍然不会让我能够从它的实例中获取属性的名称。

这使我相信您以某种方式引用了属性。你是怎么得到这个参考的？它的类型是什么？你能提供一个代码示例吗？如果它是一个 PropertyInfo 对象，你已经拥有了你需要的东西；由于情况似乎并非如此，我们正在处理其他事情，我很想看看你必须处理的是*什么*。

PS 请原谅我看起来迟钝：现在还早，我还没有喝足够的咖啡，而且我面前没有我的 IDE。：-/

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T13:35:56.133

仅供参考，我尝试对其进行序列化，以查看是否偶然包含属性名称，但没有运气。

下面的非工作代码：

```
Whotsit w = new Whotsit();
XmlSerializer xs = new XmlSerializer(w.TestProp.GetType());
TextWriter sw = new StreamWriter(@"c:\TestProp.xml");
xs.Serialize(sw, w.TestProp);
sw.Close(); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-23T12:44:29.387

Type 类的[GetProperties](http://msdn.microsoft.com/en-us/library/kyaxdd3x.aspx)将为您提供该类型的属性列表。

```
Type t = whotsit.GetType();
PropertyInfo[] pis = t.GetProperties(); 
```

# vb.net - 解析文件以设置对象的数据 - 一个设计问题

> ID：388776
> 
> 赞同：0
> 
> 时间：2008-12-23T12:37:50.057
> 
> 标签：vb.net, oop, parsing

我最近不得不编写一些代码来解析文件以在对象中设置数据。由于这里涉及到几个对象和相应的文件，我决定将解析代码分开。

所以我有一个类用于解析文件，`CommandFileParser`每个文件/对象类型有两个类：一个用于实际对象本身，一个用于可用于在对象中设置数据的可能命令。例如`VectorDrawing`和`VectorDrawingCommands`。后者的方法将通过`CommandFileParser`使用反射来调用，因为它在输入文件中找到它们，并将数据应用于前者。

但对我来说，这似乎是一种非常混乱的方式。我最终重复了大量的样板代码，就像`dataobject.value = value`在所有`-Commands`类中一样。而且我不喜欢每个主要数据类都有一个辅助类来设置数据。

任何人都可以提出更清洁、更合适的 OO 方法的任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T12:45:56.420

“我最终重复了大量的样板代码来做类似的事情`dataobject.value = value`。”

赋值语句并不是真正的“样板”。这是您拥有的最重要的陈述；事实上有很多意味着你正在做很多重要的事情。

但是，其他“样板”可以是任何东西。您能否提供您反对的特定样板的示例？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T07:21:06.463

也许您希望每个类都继承 CommandFileParser 而不是将其分离出来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T07:23:53.120

为什么不能直接使用反射来设置字段或属性的值并删除**-Commands**类的整个概念？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T13:42:05.840

如果您的所有命令都只涉及直接分配，那么您可能不需要命令对象。你能直接对对象本身进行反射并完全摆脱命令对象吗？

另一种可能是您有两类命令：一类是由对象直接实现的，例如简单的属性设置，另一类是由外部命令对象实现的，例如需要进行计算或设置多个属性的命令。您执行与以前相同的反射，但只检查两个对象。

顺便说一句，我喜欢使用反射来查找命令的想法。它使添加新命令变得异常容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-25T21:22:19.370

我不了解 VB.Net，但在我熟悉的所有 OO 语言中，通常的方法是让可变对象包含设置其自身属性值的方法，而不是将这项工作放在第二个班级。

是否有某些原因您不会`VectorDrawingCommands`直接将方法放入当前类中`VectorDrawing`并完全消除`VectorDrawingCommands`？

# plsql - 我如何将一个sql变量分成2

> ID：388778
> 
> 赞同：0
> 
> 时间：2008-12-23T12:39:48.430
> 
> 标签：plsql

我在 sql 中有一个名为 address 的字段，它是 80 个字符。我想将此字段放入 2 个字段 addr1 和 addr2，每个字段 40 个字符。我该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T12:42:01.140

这适用于 T-SQL，但对于 PL/SQL 来说并没有太大的不同

```
declare @yourVar varchar(80)
select substring(@yourVar, 1, 40), substring(@yourVar, 40, 40) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T12:45:57.620

对于plsql，它是substr()，所以选择substr(addr, 1, 40) as addr1, substr(addr, 40) as addr2 from ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T14:34:37.463

在第 40 位暴力砍掉 80 个字符的值会冒着在单词中间中断的风险。您可能想要执行以下操作：

1.  用一个空格替换所有运行的空格。
2.  找到位置 40 或之前的最后一个空白。
3.  将所有内容放在第一个结果字段中该空白之前的所有内容。
4.  将该空白之后的所有内容放在第二个结果字段中。

上述操作的具体细节将取决于您可以使用哪些工具（例如，仅 SQL，或从一个 DB 读取并使用单独的程序写入另一个 DB 等）

80 个字符的值可能会以这样一种方式填充，即“单词”之间的中断将要求结果值之一的长度超过 40 个字符以避免截断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T12:46:17.557

如果您将该表更改为具有两列而不是一列，我认为您的架构会更好。我更喜欢该解决方案来解析当前值。

# profiling - 分析从 .NET 应用程序使用的 COM 库

> ID：388779
> 
> 赞同：1
> 
> 时间：2008-12-23T12:39:51.237
> 
> 标签：profiling

我正在寻找能够分析从 .NET 应用程序调用的 C++ 库的性能分析器。

我尝试了 Purify+ 没有成功（我没有得到 COM 库的调用）和其他一些。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-03T12:16:30.420

[时间](http://www.automatedqa.com/products/aqtime/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T14:09:02.023

您是否尝试过 IBM 或 AMD 工具？它们非常低级（由处理器制造商制造！），因此也许它们可以分析您的组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T18:31:27.497

这是一个可能对您有用的线程： [Decent profiler for Windows？](https://stackoverflow.com/questions/170036/decent-profiler-for-windows)

xperf 可能很好。

我知道在以前的工作中，我的团队成功地使用了 vtune。

# .net - 将字符串解析为具有“，”和“。”的浮点数的最佳方法 作为分数分隔符？（对于小于 5 的数字）

> ID：388789
> 
> 赞同：3
> 
> 时间：2008-12-23T12:43:52.320
> 
> 标签：.net, parsing, internationalization, floating-point

这有点与[我之前](https://stackoverflow.com/questions/147801/best-way-to-parse-float)的问题有关，但不是真的。我有一个我不了解文化的输入。所以它可以同时使用 ',' 和 '.' 作为分数的分隔符。但是这个数字永远不会大于 5，所以我们可以确定是否有分隔符，它将用于分数。

我在看`TryParse`方法。它接受一个`NumberStyles`论点。但我没有看到任何关于分数分隔符之类的东西..

我又错过了什么，还是有更好的方法来实现我的目标？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-23T12:48:53.137

试试这个：

```
float.TryParse(myString.Replace(',', '.'), out myfloat); 
```

**编辑**：正如乔恩所提到的，建议采用以下方式：

```
float.TryParse(myString.Replace(',', '.'), 
               System.Globalization.NumberStyles.Float, 
               System.Globalization.NumberFormatInfo.InvariantInfo, 
               out myFloat); 
```

# sql-server - nHibernate 主从删除

> ID：388799
> 
> 赞同：3
> 
> 时间：2008-12-23T12:47:30.753
> 
> 标签：sql-server, nhibernate

我配置了主从关系。hbm 文件如下。当我运行这样的代码时

```
Favourite favourite = favourites.Find(f => f.Id== id);
user.Favourites.Remove(favourite);
m_UserRepository.Save(ref user); 
```

我收到错误消息

**NHibernate.Exceptions.GenericADOException：无法删除集合行：[Model.Entities.User.Favourites#249][SQL：SQL 不可用] ---> System.Data.SqlClient.SqlException：无法将值 NULL 插入列' UserId'，表'BE.Favourite'；列不允许空值。更新失败。**

有关这意味着什么的任何建议，请提供帮助。

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="Model.Entities" schema="BE" assembly="Model" default-lazy="false">
  <class name="Model.Entities.User, Model" table="Users" >
    <id name="UserId" column="UserId" type="int" unsaved-value="0">
      <generator class="native" />
    </id>
    <property name="UserName" column="UserName" type="string" />

    <bag name="Favourites" cascade="all" lazy="true">
      <key column="UserId"/>
      <one-to-many class="Model.Entities.Favourite, Model"/>
    </bag>

  </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T14:42:25.873

你试过`inverse="true"`在你的包上设置吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-05T02:27:51.860

在这种情况下，您实际上需要多对多关系：

```
<class name="User">
  <id name="Id">
    <generator class="native">
      <param name="sequence">object_sequence</param>
    </generator>
  </id>
  <version name="Version" />
  <property name="Name" />
  <set name="Roles" table="User_Favourite">
    <key column="UserId"/>
    <many-to-many column="FavouriteId" class="Favourite"/>
  </set>
</class> 
```

另一边也一样：(*note the inverse="true")

```
<class name="Favourite">
  <id name="Id">
    <generator class="native">
      <param name="sequence">object_sequence</param>
    </generator>
  </id>
  <version name="Version" />
  <property name="RoleName" />
  <set name="Users" table="User_Favourite" inverse="true">
    <key column="FavouriteId"/>
    <many-to-many column="UserId" class="User"/>
  </set>
</class> 
```

[从 NHibernate 2.0 文档](http://nhforge.org/doc/nh/en/index.html#collections-onetomany "来自 NHibernate 2.0 文档")：

**非常重要的注意事项**：如果声明了关联的`<key>`列，NHibernate 在创建或更新关联时可能会导致违反约束。为防止此问题，**您必须使用**与标记为 的多值端（集合或包）的双向关联。请参阅本章后面对双向关联的讨论。`<one-to-many>``NOT NULL`**`inverse="true"`**

 **最后，我不确定你是否真的想在这里使用一个包。一个用户可以有两次或多次相同的收藏？

PS：另外，请注意，lazy="true" 是自 NHibernate 1.2 以来的默认行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T13:04:03.480

尝试将您的级联规则更改为：

```
<bag name="Favourites" cascade="all,delete-orphan" lazy="true">
  <key column="UserId" not-null="true"/>
  <one-to-many class="Model.Entities.Favourite, Model"/>
</bag> 
```

# python - 如何在我自己的模板中使用内置的密码重置/更改视图

> ID：388800
> 
> 赞同：96
> 
> 时间：2008-12-23T12:47:32.110
> 
> 标签：python, django, passwords

例如，我可以在上下文`url '^/accounts/password/reset/$'`中`django.contrib.auth.views.password_reset`使用我的模板文件名指向 ，但我认为需要发送更多上下文详细信息。

我需要确切地知道要为每个密码重置和更改视图添加什么上下文。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-12-23T13:21:11.403

如果您查看[django.contrib.auth.views.password_reset](http://code.djangoproject.com/browser/django/trunk/django/contrib/auth/views.py)的来源，您会发现它使用[`RequestContext`](http://code.djangoproject.com/browser/django/trunk/django/template/__init__.py). 结果是，您可以使用上下文处理器来修改上下文，这可能允许您注入所需的信息。

b-list 很好[地介绍了上下文处理器](http://www.b-list.org/weblog/2006/jun/14/django-tips-template-context-processors/)。

编辑（我似乎对实际问题感到困惑）：

您会注意到它`password_reset`采用了一个名为的命名参数`template_name`：

```
def password_reset(request, is_admin_site=False, 
            template_name='registration/password_reset_form.html',
            email_template_name='registration/password_reset_email.html',
            password_reset_form=PasswordResetForm, 
            token_generator=default_token_generator,
            post_reset_redirect=None): 
```

检查[password_reset](https://docs.djangoproject.com/en/1.9/topics/auth/default/#django.contrib.auth.views.password_reset)以获取更多信息。

...因此，使用 urls.py 如下：

```
from django.conf.urls.defaults import *
from django.contrib.auth.views import password_reset

urlpatterns = patterns('',
     (r'^/accounts/password/reset/$', password_reset, {'template_name': 'my_templates/password_reset.html'}),
     ...
) 
```

`django.contrib.auth.views.password_reset`将调用`'/accounts/password/reset'`与关键字参数匹配的 URL `template_name = 'my_templates/password_reset.html'`。

否则，您不需要提供任何上下文，因为`password_reset`视图会自行处理。如果您想查看可用的上下文，可以触发`TemplateSyntax`错误并查看堆栈跟踪，找到具有名为 的局部变量的帧`context`。如果你想修改上下文，那么我上面所说的上下文处理器可能是要走的路。

总而言之：您需要做什么才能使用自己的模板？`template_name`在调用视图时为视图提供关键字参数。您可以通过将字典作为 URL 模式元组的第三个成员来为视图提供关键字参数。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-02-14T05:52:07.483

强烈推荐这篇文章。

我刚插上它就可以了

[http://garmoncheg.blogspot.com.au/2012/07/django-resetting-passwords-with.html](http://garmoncheg.blogspot.com.au/2012/07/django-resetting-passwords-with.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-23T18:27:06.573

你只需要包装现有的函数并传入你想要的模板。例如：

```
from django.contrib.auth.views import password_reset

def my_password_reset(request, template_name='path/to/my/template'):
    return password_reset(request, template_name) 
```

要查看这一点，只需查看内置视图的函数声明：

[http://code.djangoproject.com/browser/django/trunk/django/contrib/auth/views.py#L74](http://code.djangoproject.com/browser/django/trunk/django/contrib/auth/views.py#L74)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-04-24T13:20:44.197

您可以执行以下操作：

1.  添加到您的 urlpatterns (r'^/accounts/password/reset/$', password_reset)
2.  把你的模板放在'/templates/registration/password_reset_form.html'
3.  让你的应用在 INSTALLED_APPS 中的 'django.contrib.auth' 之前出现

解释：

加载模板后，将在 settings.py 的 INSTALLED_APPS 变量中搜索它们。顺序由定义在 INSTALLED_APPS 中的排名决定，因此由于您的应用位于“django.contrib.auth”之前，因此您的模板已加载（参考：[https ://docs.djangoproject.com/en/dev/ref/templates/api /#django.template.loaders.app_directories.Loader](https://docs.djangoproject.com/en/dev/ref/templates/api/#django.template.loaders.app_directories.Loader)）。

方法的动机：

1.  我想要更干一点，不要为任何视图（由 django 定义）重复模板名称（它们已经在 django 中定义）
2.  我想要一个最小的 url.py

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-11-26T22:35:09.407

另一个可能更简单的解决方案是将覆盖模板目录添加到 settings.py 中 TEMPLATES 设置的 DIRS 条目。（我认为这个设置在 Django 1.8 中是新的。在以前的 Django 版本中它可能被称为 TEMPLATE_DIRS。）

像这样：

```
TEMPLATES = [
   {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        # allow overriding templates from other installed apps                                                                                                
        'DIRS': ['my_app/templates'],
        'APP_DIRS': True,
}] 
```

然后将您的覆盖模板文件放在`my_app/templates`. 所以覆盖的密码重置模板将是`my_app/templates/registration/password_reset_form.html`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-23T12:54:28.010

[文档](http://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.django.contrib.auth.views.password_change)说只有一个上下文变量`form`.

如果您在登录时遇到问题（这很常见），[文档](http://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.views.login)说有三个上下文变量：

*   `form`: 表示登录表单的 Form 对象。有关 Form 对象的更多信息，请参阅表单文档。
*   `next`: 成功登录后重定向到的 URL。这也可能包含一个查询字符串。
*   `site_name`：当前站点的名称，根据 SITE_ID 设置。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-04T14:11:37.483

我在 url 和来自管理员的模板中使用了这两行我正在改变我的需要

```
url(r'^change-password/$', 'django.contrib.auth.views.password_change', {
    'template_name': 'password_change_form.html'}, name="password-change"),
url(r'^change-password-done/$', 'django.contrib.auth.views.password_change_done', {
    'template_name': 'password_change_done.html'
    }, name="password-change-done") 
```

# datepicker - iPhone Web 应用程序的日期选择器

> ID：388814
> 
> 赞同：51
> 
> 时间：2008-12-23T12:59:17.267
> 
> 标签：datepicker, iphone

为基于 iPhone 的 Web 应用程序显示日期选择器的最佳方式是什么。我们能否在 Web 应用程序中显示类似 iPhone 原生日期选择器的内容，如下所示：

![iOS 日期选择器](https://i.stack.imgur.com/ms5tX.png)

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-01-08T01:50:37.853

最简单的方法（可以说是最好的方法）是使用 safari 的内置日期选择器为您的输入框使用 HTML5 type="date"

```
<input type="date" /> 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-10-29T20:30:43.627

有一个在浏览器中运行的 iPhone 原生风格的日期选择器 - [http://cubiq.org/spinning-wheel-on-webkit-for-iphone-ipod-touch/11](http://cubiq.org/spinning-wheel-on-webkit-for-iphone-ipod-touch/11)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-09-05T12:05:17.063

我知道这是一篇旧文章，但对于未来的观众：如果您使用的是 jQuery，您可以尝试[Mobiscroll](http://mobiscroll.com)，这是一个针对触摸设备优化的可定制日期选择器。它还附带 iOS 和 android 皮肤。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T02:39:53.223

你不能。日期选择器是本机控件，在 Mobile Safari 中不可用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-02T17:29:50.370

尽管可能不喜欢注册的需要，[但 Mobiscroll](http://mobiscroll.com/component/datetime)看起来值得评估，如果您想为旧的 ios（5.x 之前）和 android（4.x 之前）设备提供一致的回退 - 可能还有其他一些平台，正如它所承诺的那样支持 jQMobi（现为 Intel appframework）和 Zepto。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-04T13:05:42.370

[在Next-Point](http://www.next-point.ro/Transport/App/Adauga "下一点")有一个 iPhone 风格的 HTML5 日期选择器。也许您可以更改它以满足您的需求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-02T02:25:46.727

好吧，如果它对您来说真的很重要，您可以自己编写代码。

通过足够的工作，您可能会使其看起来/感觉很像 Apple 的原生控件。

感觉在直觉层面上，这将是有限回报的大量工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-10T10:05:58.437

```
<input type="date" /> 
```

上面的代码不会在 mozilla 上工作。

firefox 不支持输入类型日期。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-02-01T09:21:36.650

在 ASP.Net 中，您可以使用 type="date" 的 TextBox。

```
<asp:TextBox type="date" runat="server" /> 
```

在兼容 Html5 的浏览器中，您将拥有一个日期字段。在 Html5 不兼容的浏览器中，您将拥有简单的文本字段。

# php - PHP：使用 PEAR 写入 excel 文件

> ID：388816
> 
> 赞同：4
> 
> 时间：2008-12-23T13:01:19.133
> 
> 标签：php, export-to-excel, pear

我已经安装了 PEAR`Spreadsheet_Excel_Writer`和 OLE。示例程序已成功执行，但是当我尝试读取文件时，它显示垃圾值。我也试过`$workbook->setVersion(8);`了`$worksheet->setInputEncoding('UTF-8');`

我正在使用本教程和谷歌来解决这个问题。
[http://www.sitepoint.com/article/getting-started-with-pear/3/](http://www.sitepoint.com/article/getting-started-with-pear/3/)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T16:54:25.980

I try to use PEAR only when I really need to...you can easily generate an excel spreadsheet( assuming it's just data) with something like this:

```
$header = "Last Name\tFirst Name\tAge\tJob\n"; // new line is start of new row, tab is next column

//ideally you would get this from a DB and just loop through it and append on
$row1 = "Smith\tBob\t25\tManager\n";
$row2 = "Anderson\tTrent\t32\tCEO\n";

$excel = $header.$row1.$row2;

$xlsfile = "excel_example".date("m-d-Y-hiA").".xls";
header('Content-type: application/vnd.ms-excel');
header("Content-Disposition: attachment; filename=$xlsfile");
echo $excel; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-16T22:36:59.827

不过，这只是一个制表符分隔值文件，您发送的标题建议浏览器将该数据视为 excel 文件。所以没有海报可能需要的数据格式。

# c# - 是否可以将 VBA 转换为 C#？

> ID：388819
> 
> 赞同：13
> 
> 时间：2008-12-23T13:02:13.860
> 
> 标签：c#, vba, ms-access

我在 VBA 中有几个代码块模块可以在几个 Access 数据库上运行。如果我想将编码转换为 C# 环境，我想知道我应该如何进行。是否有可能实现并获得与现在使用 Access 和 VBA 相同的结果？在这一点上，我对 C# 完全陌生。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-23T13:27:22.013

目前无法进行自动转换，但手动进行也有助于提高您的 C# 技能。这里有一篇 Top 10 文章，带您了解常见差异：

[http://msdn.microsoft.com/en-us/library/aa164018%28office.10%29.aspx](http://msdn.microsoft.com/en-us/library/aa164018%28office.10%29.aspx)

您可能还会发现以下链接很有用：

使用 C# 开发 Office 解决方案的 MSDN 页面：

[http://msdn.microsoft.com/en-us/library/ms228286.aspx](http://msdn.microsoft.com/en-us/library/ms228286.aspx)

MSDN Visual C# 应用程序开发页面（用于开始 C# 开发）：

[http://msdn.microsoft.com/en-us/library/aezdt881.aspx](http://msdn.microsoft.com/en-us/library/aezdt881.aspx)

祝你好运，我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T15:26:40.060

需要注意的一件事是，当您在 VBA 中编码时，会自动包含一些对象名称空间和库引用。在 C# 中工作时需要显式添加这些。例如，

```
Selection.TypeText("foo") 
```

在 VBA 中变成

```
using Microsoft.Office.Interop.Word;

Application word = new Application();
word.Selection.TypeText("foo"); 
```

在 C# 中。可以通过右键单击解决方案资源管理器中的引用文件夹并选择“添加引用”来添加库引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T13:04:55.587

通常，您应该可以手动转换代码。您不会找到任何可以做到这一点的自动代码转换器。

话虽如此，用于访问数据的框架在 C# 和 VBA 世界中是完全不同的（它们甚至在 VB.NET 和 VBA 之间也完全不同！）。因此，在开始之前，您需要阅读 ADO.NET。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-02T20:14:46.300

鉴于 VBA 与 vb.net 非常相似，那么我建议您转换为 VB.net。实际上，您通常可以剪切 + 粘贴代码，尤其是如果此类代码来自代码模块。如果您的代码有 DAO.Recordsets，那么我建议在 VB.net 中创建一个“模仿”dao.recordset 的类。因此，大多数 VBA 代码可以接近 100% 进入 vb.net 代码模块。所以这表明您不需要转换，只需将 VBA 代码移至 VB.net。事实上，VBA 中 99% 的命令在 VB.net 中以相同的语法存在。

# .net - 访问 clr 的实习字符串列表

> ID：388822
> 
> 赞同：5
> 
> 时间：2008-12-23T13:03:33.060
> 
> 标签：.net, string, clr

我刚刚回答了一个[问题](https://stackoverflow.com/questions/388699/security-problems-with-net-platform#388764)，我说虽然字符串实习很好，但它可能是一个安全问题，因为稍后可以轻松访问字符串值。

虽然我很确定这是真的 :-) 我不确定这真的很容易。我试着用谷歌搜索这个话题，但没有得到相关的结果（google-fu 在这方面很弱），所以我在 SO 上试试你们。

您知道访问应用程序域中的 intered 字符串列表的任何“简单”方法吗？我必须使用内存转储之类的东西还是有像 AppDomain.GetInteredStringsList() 这样的方法？

与此相关：从 intered 字符串中获取任何有用的数据真的很容易。将敏感数据存储在字符串中真的是一个安全漏洞吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T13:07:49.073

这不是特别容易 - 但它是可行的。

基本上，如果您有任何可以进行内存转储的东西，您可以找到看起来像是字符串对象的内存位。（特别是，它们在开始时都会有相同的“类型信息指针”，所以如果你有一个示例字符串，你就离开了。）

顺便说一句，这与实习字符串无关。并非*所有*字符串都被实习 - 只有字符串常量和用户明确实习的字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T13:30:15.207

> 将敏感数据存储在字符串中真的是一个安全漏洞吗？

是的，绝对是的！

sensitive security data should be stored using the [SecureString](http://msdn.microsoft.com/en-us/library/system.security.securestring.aspx) class.

Edit:

because even interned strings are stored in the managed heap, using a tool to dump the heap, will reveal all strings in the application.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T13:12:24.353

在一个明智的应用程序中，密码存储在字符数组中，以便在不再需要时可以覆盖它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T13:48:46.853

Not impossible to do... although not necessarily through managed code. Anything that has access to a process dump (windb / sos / etc) will have no difficulty looking for strings.

# database - 架构设计

> ID：388837
> 
> 赞同：0
> 
> 时间：2008-12-23T13:10:34.763
> 
> 标签：database, schema

假设您是 GM dba，您必须围绕 GM 模型进行设计

这样做更好吗？

*   表模型
    *   {凯迪拉克、土星、雪佛兰}

或这个？

*   table_cadillac_model
*   table_saturn_model
*   table_chevrolet_model

假设业务线对于模型具有相同的列，并且每个子类型有超过一百万条记录。

编辑：

*   有很多 CRUD
*   有很多处理器密集型报告
*   在任一模式中，都有一个 model_detail 表，其中包含每个模型的 3-5 条记录，并且每个模型的详细信息不同（您不能将凯迪拉克详细信息添加到土星模型）
*   开发团队对数据库复杂性没有任何问题
*   我不太确定这是一个标准化问题。即使结构相同，它们也可能被认为是不同的实体。

编辑：

将结构划分为多个表的原因 - 业务线可能对部分有不同的业务规则 - 每个业务线的 addModelDetail() 可能不同（即使数据格式相同） - 高添加/更新活动 - 分区性能更好结构而不是单一结构（我在这里猜测并且不确定）？

我认为这是 EAV 问题的一种变体。当作为 EAV 设计提出时，单表结构通常被认为是一个坏主意。当以这种方式提出时，单表结构通常被认为是一个好主意。有趣的...

我认为最有趣的答案是有两种不同的结构——一种用于 crud，一种用于报告。我想我会尝试用于报告的连接/扁平视图和用于 crud 的多个表，看看它是如何工作的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-23T13:13:44.100

绝对是前一个例子。每当您将新模型添加到您的产品系列时，您是否希望将表添加到您的数据库中？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-24T07:24:27.347

对于有大量写入的数据（例如 OLTP 应用程序），最好有更多、更窄的表（例如具有较少字段的表）。由于您只是将少量数据写入不同的表，因此锁争用会减少。

因此，根据您描述的标准，我将拥有的表结构是：

```
Vehicle
  VehicleType
  Other common fields

CadillacVehicle
  Fields specific to a Caddy

SaturnVehicle
  Fields specific to a Saturn 
```

对于报告，我将在没有标准化结构的完全不同的服务器上拥有一个完全不同的数据库（例如，只有 CadillacVehicle 和 SaturnVehicle 表，其中 Vehicle 表中的所有字段都复制到其中）。

有了适当的索引，即使是 OLTP 数据库也可以在您的 SELECT 中运行，而不管有几千万行。但是，由于您提到存在处理器密集型报告，这就是为什么我将拥有一个完全独立的报告数据库。

最后一条评论。关于业务规则......数据存储不关心业务规则。如果模型之间的业务规则不同，那真的不应该考虑到您关于数据库模式的设计决策（除了帮助决定哪些字段可以为空及其数据类型）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T13:24:53.610

使用前者。为专业设置单独的表会使您的代码复杂化，并且不会带来任何其他方式无法实现的优势。它还将大大简化您的报告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T13:24:02.833

如果表确实具有相同的列，那么前者是最好的方法。即使它们有不同的列，您可能仍希望将公共列放在它们自己的表中，并存储类型指示符。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-24T00:56:25.977

您可以尝试拥有两个独立的数据库。

一种是OLTP（OnLine Transaction Processing）系统，它应该高度规范化，以便数据模型高度正确。报告性能一定不是问题，您可以根据具体情况使用索引/非规范化等处理非报告查询性能。数据模型应尽量与概念模型紧密匹配。

另一个是报告系统，它应该定期从 OLTP 系统中提取数据，并以使报告生成更容易和更高性能的方式对数据进行处理和重新排列。数据模型不应*试图*与概念模型过于紧密地匹配。您应该能够随时从主数据库中当前的数据重新生成报告数据库中的所有数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-24T01:28:47.190

我会说第一种方式看起来更好。

您是否有理由要采用第二种方式？

第一种方式更好地遵循规范化，并且更接近于大多数关系数据库模式的开发方式。

第二种方式似乎更难维护。

除非有充分的理由采用第二种方法，否则我会采用第一种方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-23T13:13:43.400

鉴于您给我们的描述，答案是要么。

换句话说，你没有给我们足够的信息来给出一个体面的答案。请描述您希望对数据执行什么样的查询。

[话虽如此，我认为答案将是第一个 ;-) 当我成像时，即使它们是不同的模型，每个模型的数据可能会非常相似。

但目前这是一个完整的猜测。]

编辑：鉴于您更新的编辑，我肯定会说第一个。由于它们具有所有相同的数据，因此它们应该进入同一张表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-23T13:19:10.020

在定义“更好”时要考虑的另一件事是最终用户会直接查询这些数据吗？最终用户很难使用高度规范化的数据。当然，这可以通过视图来克服，但在您完成设计时仍然需要考虑。

我同意另外两个人的回答：哪种形式“更好”是主观的，取决于您希望达到的目标。如果您希望实现非常快速的查询，那是一回事。如果您希望实现程序员的高生产力——这又是一个不同的目标，并且可能与快速查询相冲突。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-23T14:00:01.683

选择取决于所需的性能。最好的数据库是规范化数据库。但是规范化数据库中可能存在性能问题，然后您必须对其进行非规范化。原则“首先规范化，为了性能而去规范化”效果很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-24T01:02:23.140

这取决于数据模型和用例。如果您需要报告希望从“模型”中获取数据的查询，那么前者更可取，因为否则（使用后者）您每次添加时都必须更改查询（以包括新表）新模式。

哦，“前者”是指这个选项：

```
table_model
* type {cadillac, saturn, chevrolet} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-24T13:49:13.873

@mson 提出了一个问题[“当一个问题在 SO 上没有得到令人满意的回答时，你会怎么做？](https://stackoverflow.com/questions/390516/) ”，这是对这个问题的现有答案的直接引用。

我为该讨论提供了以下答案，主要是批评提出问题的方式。

* * *

引用（逐字）：

> 我昨天看了原来的问题，决定不提供答案。
> 
> 一个问题是在“通用汽车模型”中使用“模型”一词 - 它引用“雪佛兰、土星、凯迪拉克”作为“模型”。据我了解，这些根本不是模型。它们是“品牌”，尽管它们可能还有一个我不熟悉的业内术语，例如“部门”。模型将是“Saturn Vue”或“Chevrolet Impala”或“Cadillac Escalade”。事实上，很可能会有比这更详细的模型——例如，土星 Vue 的不同变体。
> 
> 所以，我不认为起点是很好的框架。我没有批评它；它不够引人注目，并且有答案出现，所以我让其他人尝试。
> 
> 下一个问题是不清楚您的 DBMS 将存储什么数据。如果您为每个“模型”（“品牌”）存储一百万条记录，那么您要处理哪些类型的数据？潜伏在背景中的是一个不同的场景——真实的场景——你的问题使用了一个不够现实的类比。这意味着答案的“取决于”部分比“这就是如何做”的部分要多得多。可悲的是，关于要建模的数据的背景信息太少了，无法让我们猜测什么可能是最好的。
> 
> 最终，这将取决于人们对数据的用途。如果信息要向所有不同的方向传播（不同品牌的不同数据结构；汽车模型级别的不同数据结构；不同经销商的不同结构——雪佛兰经销商的处理方式与土星经销商和凯迪拉克经销商不同）经销商），那么集成结构提供的收益有限。如果一切都一样，那么集成结构提供了很多好处。
> 
> 隔离数据是否有法律理由（或好处）？不同品牌在多大程度上是独立的法人实体，共享记录可能是一种责任？是否存在隐私问题，如果单独存储不同品牌的数据，则更容易控制对数据的访问？
> 
> 如果没有关于所建模场景的更多细节，没有人可以给出可靠的一般答案——至少，不会超过投票最多的那个已经给出（或没有给出）的答案。
> 
> *   数据建模并不容易。
> *   没有足够信息的数据建模是不可能可靠地进行的。

* * *

我在这里复制了材料，因为它更直接相关。我确实认为要令人满意地回答这个问题，应该给出更多的背景信息。并且可能需要足够的额外上下文来使 SO 成为错误的地方来询问它。SO 有其局限性，其中之一是它无法处理需要长时间解释的问题。

从 SO 常见问题页面：

> ### 我可以在这里问什么样的问题？
> 
> 当然是编程问题！只要你的问题是：
> 
> *   详细而具体
> *   写得清楚简单
> *   至少在某个地方的其他程序员感兴趣
> 
> ...
> 
> ### 我不应该在这里问什么样的问题？
> 
> 避免提出主观的、争论的或需要扩展讨论的问题。这是一个可以回答问题的地方！

这个问题是，IMO，接近“*需要扩展讨论*”的限制。

# html - 您将如何使用语义 HTML 标记建筑计划/地图？

> ID：388843
> 
> 赞同：0
> 
> 时间：2008-12-23T13:13:01.187
> 
> 标签：html, markup, semantics

该建筑（博物馆）有 7 层（+3 到 -3），每层分为不同的房间/区域。将鼠标悬停在某个区域上将显示一个描述该区域的弹出窗口。

我正在寻找一些能够准确代表 7 个级别及其区域的标记。该计划应该是有意义的，并且在没有任何 CSS/JS 的情况下是“可导航的”。

编辑：澄清一下，标记只需要代表建筑物的“语义结构”，而不是空间布局（CSS 将添加到布局和图形中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T13:23:50.150

对我来说闻起来像一个嵌套的无序列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T14:03:12.473

看看[微格式](http://microformats.org/wiki/Main_Page)，特别是[XOXO 微格式](http://microformats.org/wiki/XOXO)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T13:17:21.100

听起来像是 SVG 的工作？（[圣何塞的 Adob​​e 大楼示例](http://www.adobe.com/svg/demos/vbs/html/frameset.html)）

我意识到这确实使用了 JavaScript，但如果你有 7 层楼 * 10 多个房间？使用纯 CSS 会变得相当麻烦。您可以使用一些`<ul>`元素来制作嵌套级别的房间，但如果建筑物这么大，我认为列表（即使呈现为块）对查看没有意义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T09:39:46.717

使用 HTML5（但如果您想使用 HTML 4.01，应该不会有太大区别）：

如果您想用图像表示建筑物，您可以使用由和组成的[Image Map](http://www.w3.org/TR/html5/image-maps.html#image-maps)。(属性)可以链接到包含房间详细描述的页面。该属性可以包含房间的简短描述，例如“草莓房间（4 级）”。[`map`](http://www.w3.org/TR/html5/the-map-element.html#the-map-element)[`area`](http://www.w3.org/TR/html5/the-area-element.html#the-area-element)`area``href``alt`

如果标记更像是替代文本（例如，如果您使用`object`，`canvas`或类似的东西），我会使用标题结构：

```
<section>
 <h1>The building</h1>

 <section id="level-1">
  <h1>Level 1</h1>

   <section id="level-1-room-1">
    <h1>Room 1</h1>
    <p>description of room 1</p>
   </section>

   <section id="level-1-room-2">
    <h1>Room 2</h1>
    <p>description of room 2</p>
   </section>

 </section> <!-- #level-1 -->

 <section id="level-2">
  <h1>Level 2</h1>

   <section id="level-2-room-1">
    <h1>Room 1</h1>
    <p>description of room 1</p>
   </section>

   <section id="level-2-room-2">
    <h1>Room 2</h1>
    <p>description of room 2</p>
   </section>

 </section> <!-- #level-2 -->

</section> 
```

（对于 HTML 4.01，您将使用`div`代替`section`并相应地调整标题级别）

# blackberry - 黑莓 8330 的声音问题

> ID：388848
> 
> 赞同：0
> 
> 时间：2008-12-23T13:14:48.140
> 
> 标签：blackberry, java-me, mp3, mmapi, cdma

似乎在 CDMA Blackberry 8330 上，我尝试使用 J2ME 播放的几乎每个 mp3 文件都会在实际结束前几秒钟被剪切。有人有线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T19:09:47.707

这可能无济于事，但大多数 CDMA 网络使用 Qcelp 格式和 QCP 文件。例如，我使用过的所有 sprint 手机都最好地支持 QCP。所以你可以试试这种格式，看看它是否有效。

# javascript - 使用 javascript 检查 Flash 文件加载

> ID：388850
> 
> 赞同：0
> 
> 时间：2008-12-23T13:16:32.503
> 
> 标签：javascript, flash, download, load

有没有办法检查在显示之前将多少 Flash 文件（下载）加载到页面？我们的团队不能将加载指示器放在 flash 文件中，因为 swf 文件是由我们的客户端上传的。xmlhttprequest 上是否有某种属性可以用来指示下载了多少？或任何其他建议在屏幕上指示加载百分比？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T13:38:17.127

您是否可以控制文件在浏览器中的加载方式？我有一个理论，您可以创建第二个 Flash 电影，将客户端电影加载到其中，并且在此过程中您可以显示进度指示器。

Flash 支持加载外部 .swf 文件，看[这里](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14190)看看如何。

# c# - 获取从不同程序集执行的打开窗口窗体实例的列表

> ID：388859
> 
> 赞同：4
> 
> 时间：2008-12-23T13:22:06.643
> 
> 标签：c#, window, instance

我有一个加载菜单的“加载器应用程序”，当用户单击菜单图像按钮时，会根据文本打开一个列表视图

```
(if text = employee)  
(Go to class A) 
(Go to class B) 
    ...
    ...
    (Show List View Window) 
```

如果他再次点击它再次打开的同一个按钮，我想阻止这种情况。即，但这适用于 WPF 应用程序

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-23T13:33:11.393

如果您想要打开表单的列表，那就是`Application.OpenForms`. 您可以迭代它，使用 GetType() 并检查`.Assembly`以从不同的程序集中找到它们。除此之外，我对这个问题并不完全清楚......

```
 Assembly currentAssembly = Assembly.GetExecutingAssembly();
        List<Form> formsFromOtherAssemblies = new List<Form>();
        foreach (Form form in Application.OpenForms) {
            if (form.GetType().Assembly != currentAssembly) {
                formsFromOtherAssemblies.Add(form);
            }
        } 
```

如果您只想跟踪自己打开的表单，请缓存该实例。或者，如果您使用“拥有的表格”，您可以按名称检查：

```
 private void button1_Click(object sender, EventArgs e) {
        foreach (Form form in OwnedForms) {
            if (form.Name == "Whatever") {
                form.Activate();
                return;
            }
        }
        Form child = new Form();
        child.Name = "Whatever";
        child.Owner = this;
        child.Show(this);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T12:23:53.440

```
 NewProduct newproduct;
    private void button1_Click(object sender, EventArgs e)
    {

        if(!isOpened())
        {
            newproduct = new NewProduct();
            newproduct.Show();
        }

    }
    private bool isOpened()
    {
        foreach (Form f in Application.OpenForms)
        {
            if (f == newproduct)
            {
                return true;
            }
        }
        return false;
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-30T06:53:46.357

另一个简单的例子

```
private Boolean FindForm(String formName)
    {
        foreach (Form f in Application.OpenForms)
        {
            if (f.Name.Equals(formName))
            {

                f.Location = new Point(POINT.X, POINT.Y + 22);
                return true;
            }
        }

        return false;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T14:51:16.527

您可以使用命令模式。加载程序集将在加载的程序集中搜索命令。对于每个命令，加载程序都会创建菜单项（或您想要的任何其他内容），并且单击事件将运行具体命令。

该命令必须知道是否应该创建新表单或使用一些已经存在的表单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-02T09:27:15.193

Mark Garvell 的回答帮助我弄清楚我应该做什么，但它需要针对 WPF 进行调整。

（就我而言，我想在主窗口关闭时关闭任何不属于主窗口的窗口，但原理是一样的。）

```
private void EmployeeMenuItemClick(object sender, RoutedEventArgs e)
{
    bool found = false;
    foreach(Window w in Application.Current.Windows)
    {
        if(w.GetType() == typeof(EmployeeListViewWindow)
        {
            found = true;
            break;
        }
    }
    if(!found)
    {
        EmployeeListViewWindow ew = new EmployeeListViewWindow();
        ew.Show();
    }
} 
```

# actionscript-3 - 在 AS3 (Action Script 3.0) 中查找（加载）图像大小

> ID：388868
> 
> 赞同：5
> 
> 时间：2008-12-23T13:29:04.460
> 
> 标签：actionscript-3, image, size, dimension

我目前使用以下函数来加载图像，但是我无法找到一种方法来找到加载图像的宽度，我打算在使用相同的函数放置下一个图像之前使用它。

请注意，q 是一个变量（一个数字），用于加载不同的图像。

=X 我需要帮助来获取加载的图像宽度...

```
function LoadImage(q)
{
    var imageLoader:Loader = new Loader();
    var image:URLRequest = new URLRequest("GalleryImages/Album1/"+q+".jpg");
    imageLoader.load(image);
    addChild (imageLoader);
    imageLoader.x = 0 + CurrentXLength;
    imageLoader.y = 0;
    imageLoader.name = "image"+q;
    trace(imageLoader.x)
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-23T16:24:07.260

You can't know the width of the bitmap until it's actually loaded:

```
function LoadImage(q)
{
    var imageLoader:Loader = new Loader();
    var image:URLRequest = new URLRequest("GalleryImages/Album1/"+q+".jpg");
    imageLoader.contentLoader.addEventListener(Event.COMPLETE, ImageLoaded);
    imageLoader.load(image);
    addChild (imageLoader);
    ...

private function ImageLoaded(e:Event):void
{
    var imageLoader:Loader = Loader(e.target.loader);
    var bm:Bitmap = Bitmap(imageLoader.content);
    var CurrentXLength = bm.width;
    .... 
```

Alternativly [this link](http://www.anttikupila.com/flash/getting-jpg-dimensions-with-as3-without-loading-the-entire-file/) might be helpful? Haven't tried it myself ...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-20T10:02:27.290

我只是要求加载器对象的宽度属性：

```
var loader:Loader;

function loadImage(dir:String):void {
    loader = new Loader();
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, placeImage);
    var urlReq:URLRequest = new URLRequest(direccion);
    loader.load(urlReq);
}

function placeImage(o:Event):void {
    loader.x = (1360 - loader.width)/2;
    loader.y = (768 - loader.height)/2;
    addChild(loader);
} 
```

其中 1360 和 768 是画布尺寸...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T16:00:14.657

To access the width you must do it within the function assigned to handle Event.COMPLETE.

"You will want an array containing the items you wish to load. You should probably load this data in with XML so it is dynamic and scalable. Once the xml data is loaded it should be assigned to an array in whatever fashion you like. The reason that we must use an array in this situation, rather then just using the XML object, which is essentially an array, is because you need the know an objects width so that you can base the next objects X position off of the last objects X position plus its WIDTH.

With XML it is common to use a for loop and just iterate through "x" amount of times. We do not want this, in this case. To obtain the "WIDTH" property of the loaded asset, it must be accessed from within the function assigned to fire when the loader fires Event.COMPLETE. Once the image has completed it will remove the item from the array, set a variable as to the lastX and lastWidth, and then get the next item in the array and start all over. Eventually the array is empty and the process is complete.

-Note: I will skip loading the XML and just inject the data into the array myself.

```
package
{
    import flash.display.Sprite;
    import flash.display.Loader;
    import flash.net.URLRequest;

    public class DocumentClass extends Sprite
    {
        private var _array:Array;
        private var _lastX:Number;
        private var _lastWidth:Number;

        public function DocumentClass():void
        {
            _array = new Array();
            //Add Items to an array however you wish.  I did it
            //this way to make it easier to read on this site.

            _array.push({name: "image1", path: "path/to/image1"});
            _array.push({name: "image2", path: "path/to/image2"});
            _array.push({name: "image3", path: "path/to/image3"});

            loadImage();
        }
        private function loadImage():void
        {
            if(_array.length > 0)
            {
                var loader:Loader = new Loader();
                addChild(loader);

                var request:URLRequest = new URLRequest(_array[0].path); //Loads first item in the array each time.
                loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onImageLoaded);
                loader.x = _lastX + _lastWidth;
                laoder.load(request);

                _lastX = loader.x; //We set after so we are ready for the next.

                _array.shift(); //Remove the first item from the array.
            }
        }
        function onImageLoaded(e:Event):void
        {
            _lastWidth = e.target.width;
            loadImage(); //Attempt to load another image if the array isn't empty.
        }
    }
} 
```

I hope this helps, the code isn't tested, but the concept seems valid.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-28T02:57:13.963

是的，我使用了 scott 的答案，但值得注意的是 LoadImage() 函数中的 'imageLoader.contentLoader' 应该是 'imageLoader.contentLoaderInfo'。为我解决了宽度问题——感谢 mang

# algorithm - 如何可靠地检测异常资源消耗？

> ID：388874
> 
> 赞同：2
> 
> 时间：2008-12-23T13:35:09.440
> 
> 标签：algorithm, sysadmin, false-positive, resource-monitor

这个问题是关于一整类类似的问题，但我会作为一个具体的例子来问它。

我有一个带有内容波动的文件系统的服务器。我需要监视此文件系统上的可用空间，以确保它不会被填满。为了争论，我们假设如果它填满，服务器就会宕机。

它是什么并不重要——例如，它可能是一个“工作”队列。

在“正常”操作期间，可用空间在“正常”范围内变化，但可能会出现以下问题：

*   增加工作的其他一些（可能是外部的）组件可能会失控
*   一些删除工作的组件卡住了，但仍未被发现

该过程的统计特征基本上是未知的。

我正在寻找的是一种算法，该算法将可用空间的定时定期测量作为输入（欢迎对输入的替代建议），并在事情“异常”并且文件系统为“可能会填满”。避免误报显然很重要，但几乎同样重要的是避免误报，以避免使接到警报的系统管理员的大脑麻木。

我很欣赏有替代解决方案，例如在潜在问题上投入更多存储空间，但我实际上经历过 1000 次还不够的情况。

考虑存储的历史测量值的算法很好，尽管最小化历史数据量的动态算法是首选。

* * *

我已经接受了弗兰克的回答，现在我要回到绘图板上深入研究他的参考资料。

我认为，有三种情况很有趣，但不按顺序排列：

1.  “Harrods's Sale 刚刚开始”情景：以一秒的分辨率出现的活动高峰“脱离了表盘”，但并不代表资源枯竭的真正危险；
2.  “全球变暖”情景：需要规划（相对）稳定的增长；和
3.  “Google 主动向我发送了一份索引副本”场景：这将在相对较短的时间内耗尽我的所有资源，除非我采取措施阻止它。

从系统管理员的角度来看，这是（我认为）最有趣和最具挑战性的最后一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-23T14:03:08.853

如果它实际上与工作队列有关，那么排队论可能是获得答案的最佳途径。

对于一般情况，您也许可以尝试对历史数据进行（多重？）线性回归，以检测资源使用是否存在统计上显着的上升趋势，如果继续下去可能会导致问题（您也可以预测这种技术必须持续多长时间导致问题 - 只需为“问题”设置阈值并使用趋势的斜率来确定需要多长时间）。您将不得不玩弄这个和您收集的变量，看看是否有任何统计显着的关系，您可以首先发现。

虽然它涵盖了一个完全不同的主题（全球变暖），但我发现 tamino 的博客 (tamino.wordpress.com) 是一个非常好的资源，可以对充满已知和未知的数据进行统计分析。例如，请参阅[这篇](http://tamino.wordpress.com/2008/03/22/autocorrelation/)文章。

*编辑：根据我的评论，我认为这个问题有点类似于 GW 问题。您有短期的活动爆发，平均为零，并且您感兴趣的长期趋势叠加。此外，可能有不止一个长期趋势，并且不时变化。Tamino 描述了一种可能适用于此的技术，但不幸的是我找不到我想要的帖子。它涉及沿数据滑动回归（想象多条线适合噪声数据），并让数据选择拐点。如果你能做到这一点，那么你也许可以识别出趋势的重大变化。不幸的是，它可能只能在事后才能识别，因为您可能需要积累大量数据才能获得意义。但它可能仍然及时阻止资源枯竭。*

# c++ - 在 C++ 中注册派生类

> ID：388878
> 
> 赞同：2
> 
> 时间：2008-12-23T13:36:29.080
> 
> 标签：c++, design-patterns, templates, abstract-class, factory

编辑：小修复（虚拟打印；返回 mpInstance）在答案中的注释之后。

我正在尝试创建一个系统，在该系统中我可以从任何基类派生一个子类，并且它的实现应该替换基类的实现。

所有创建和使用基类对象的对象都不应改变它们创建或调用对象的方式，即即使它们实际创建了子类，也应继续调用 BaseClass.Create()。基类知道它们可以被覆盖，但它们不知道覆盖它们的具体类。

我希望所有子类的注册都在一个地方完成。

这是我的实现：

```
class CAbstractFactory
{
public:
    virtual ~CAbstractFactory()=0;
};

template<typename Class>
class CRegisteredClassFactory: public CAbstractFactory
{
public:
    ~CRegisteredClassFactory(){};
    Class* CreateAndGet()
    {
        pClass = new Class;
        return pClass;
    }
private:
    Class* pClass;
};

// holds info about all the classes that were registered to be overridden
class CRegisteredClasses
{
public:
    bool find(const string & sClassName);
    CAbstractFactory* GetFactory(const string & sClassName)
    {
        return mRegisteredClasses[sClassName];
    }
    void RegisterClass(const string & sClassName, CAbstractFactory* pConcreteFactory);
private:
    map<string, CAbstractFactory* > mRegisteredClasses;

};

// Here I hold the data about all the registered classes. I hold statically one object of this class.
// in this example I register a class CChildClass, which will override the implementation of CBaseClass, 
// and a class CFooChildClass which will override CFooBaseClass
class RegistrationData
{
    public:
        void RegisterAll()
        {
            mRegisteredClasses.RegisterClass("CBaseClass", & mChildClassFactory);
            mRegisteredClasses.RegisterClass("CFooBaseClass", & mFooChildClassFactory);
        };
        CRegisteredClasses* GetRegisteredClasses(){return &mRegisteredClasses;};
    private:    
        CRegisteredClasses mRegisteredClasses;
        CRegisteredClassFactory<CChildClass> mChildClassFactory;
        CRegisteredClassFactory<CFooChildClass> mFooChildClassFactory;
};

static RegistrationData StaticRegistrationData;

// and here are the base class and the child class 
// in the implementation of CBaseClass::Create I check, whether it should be overridden by another class.
class CBaseClass
{
public:
    static CBaseClass* Create()
    {
        CRegisteredClasses* pRegisteredClasses = StaticRegistrationData.GetRegisteredClasses();
        if (pRegisteredClasses->find("CBaseClass"))
        {
            CRegisteredClassFactory<CBaseClass>* pFac = 
                dynamic_cast<CRegisteredClassFactory<CBaseClass>* >(pRegisteredClasses->GetFactory("CBaseClass"));

            mpInstance = pFac->CreateAndGet();
        }
        else
        {
            mpInstance = new CBaseClass;
        }
        return mpInstance;
    }
    virtual void Print(){cout << "Base" << endl;};
private:
    static CBaseClass* mpInstance;

};

class CChildClass : public CBaseClass
{
public:
    void Print(){cout << "Child" << endl;};
private:

}; 
```

使用此实现，当我从其他类执行此操作时：

```
StaticRegistrationData.RegisterAll();
CBaseClass* b = CBaseClass::Create();
b.Print(); 
```

我希望在输出中得到“孩子”。

你觉得这个设计怎么样？我是不是把事情复杂化了太多，可以做得更容易？我可以创建一个从抽象类继承的模板吗？

我不得不使用 dynamic_pointer （否则没有编译） - 是否暗示有问题？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T14:29:17.897

这种模式相当普遍。我不是 C++ 专家，但在 Java 中你随处可见。动态转换似乎是必要的，因为编译器无法判断您在地图中存储了哪种工厂。据我所知，目前的设计对此无能为力。了解这些对象的用途将有所帮助。让我举一个例子，说明如何在 Java 的数据库库 (JDBC) 中完成类似的任务：

系统有一个知道 JDBC 驱动程序的 DriverManager。必须以某种方式注册驱动程序（细节不重要）；每当您请求数据库连接时，一旦注册，您就会得到一个 Connection 对象。通常这个对象将是一个 OracleConnection 或一个 MSSQLConnection 或类似的东西，但客户端代码只看到“连接”。要获得一个 Statement 对象，你可以说 connection.prepareStatement，它返回一个 PreparedStatement 类型的对象；除了它实际上是一个 OraclePreparedStatement 或 MSSQLPreparedStatement。这对客户端是透明的，因为 Statements 的工厂位于 Connection 中，而 Connections 的工厂位于 DriverManager 中。

如果您的类具有相似的相关性，您可能希望有一个返回特定类型类的函数，就像 DriverManager 的 getConnection 方法返回一个 Connection。无需铸造。

您可能要考虑的另一种方法是使用一个工厂，该工厂对您需要的每个特定类都有一个工厂方法。那么您只需要一个 factory-factory 即可获得 Factory 的实例。示例（对不起，如果这不是正确的 C++）：

```
class CClassFactory
{
  public:
    virtual CBaseClass* CreateBase() { return new CBaseClass(); }
    virtual CFooBaseClass* CreateFoo() { return new CFooBaseClass();}
}

class CAImplClassFactory : public CClassFactory
{
  public:
    virtual CBaseClass* CreateBase() { return new CAImplBaseClass(); }
    virtual CFooBaseClass* CreateFoo() { return new CAImplFooBaseClass();}
}

class CBImplClassFactory : public CClassFactory // only overrides one method
{
  public:
    virtual CBaseClass* CreateBase() { return new CBImplBaseClass(); }
} 
```

至于批评使用继承的其他评论：在我看来，接口和公共继承之间没有区别；所以继续在有意义的地方使用类而不是接口。从长远来看，纯接口可能更灵活，但可能不会。如果没有有关您的类层次结构的更多详细信息，就不可能说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T14:49:46.390

通常，当您在基类中有一个接口并且该接口在派生类中实现（IS-A 关系）时，使用基类/派生类模式。在您的情况下，基类似乎与派生类没有任何联系 - 它也可能是 void*。

如果基类和派生类之间没有联系，为什么要使用继承？如果工厂的产出不能以通用方式使用，那么拥有工厂有什么好处？你有

```
class CAbstractFactory
{
public:
    virtual ~CAbstractFactory()=0;
}; 
```

这是完全错误的。工厂必须制造可以立即使用的东西：

```
class CAbstractFactory
{
public:
    virtual ~CAbstractFactory(){};
public:
    CBaseClass* CreateAndGet()
    {
        pClass = new Class;
        return pClass;
    }
private:
    CBaseClass* pClass;

protected:
    CBaseClass *create() = 0;

}; 
```

通常，您以不应该混合的方式混合继承、虚函数和模板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T13:40:48.867

在没有阅读所有代码或进入细节的情况下，您似乎应该执行以下操作：

*   类型为`b`CChildClass，
*   做`CBaseClass::Print`一个虚函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T14:06:45.883

也许我错了，但我没有在您的 CBaseClass::Create() 方法中找到任何返回语句！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T14:21:54.433

就个人而言，我认为这种设计过度使用了继承。

“我正在尝试创建一个系统，在该系统中我可以从任何基类派生一个子类，并且它的实现应该替换基类的实现。” - 我不知道 IS-A 关系*应该*那么灵活。

我想知道您是否最好使用接口（C++ 中的纯虚拟类）和混合行为。如果我用 Java 编写它，我会这样做：

```
public interface Foo
{
    void doSomething();
}

public class MixinDemo implements Foo
{
    private Foo mixin;

    public MixinDemo(Foo f)
    {
        this.mixin = f;
    }

    public void doSomething() { this.mixin.doSomething(); }
} 
```

现在我可以通过更改传递给 MixinDemo 的 Foo 实现来根据需要更改行为。

# sql-server - 克服 sql server 存储过程参数的 8k 限制

> ID：388883
> 
> 赞同：1
> 
> 时间：2008-12-23T13:39:24.173
> 
> 标签：sql-server

我最近解决了我的 VB6 应用程序在使用 ADO 2.8 和 Recordset.Field 的 AppendChunck 方法将大型二进制对象保存到 sql server 时遇到的问题。如果数据太大，我会在 for 循环中得到“无效句柄”或“没有足够的系统存储空间来执行此操作”。我通过将块发送到存储过程并使用“updatetext”解决了这个问题。但是，由于 8k 的限制，我现在一次只能发送 8k 个字符。有人知道一个好的解决方法吗？下面是我的sproc。

```
@chunck binary(8000),  
@result_id int

as

declare @pointer binary(16),  
        @imagelength int,  
        @datalength int  

--get the pointer and length to the image column    
select @pointer = textptr(result_image),  
       @imagelength = datalength(result_image)  
from dbo.dash_result  
where result_id = @result_id

if @pointer is null

update dbo.dash_result  
set result_image = @chunck  
where result_id = @result_id  

else

begin

  --append the chunck of data to the end  
  set @datalength = datalength(@chunck)  
  updatetext dbo.dash_result.result_image @pointer @imagelength 0 @chunck

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T13:47:44.610

如果您使用的是 SQL Server 2005，则可以使用 varbinary(MAX) 数据类型或 varchar(MAX) 数据类型，具体取决于您存储的数据类型。我相信这些可以容纳多达 2 Gig 的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T14:01:11.183

对于 sql server 2000，将参数声明为文本。请注意，它必须是参数而不是本地变量，只有参数可以是文本，不能是本地变量。

# sharepoint - Sharepoint 自定义个性化

> ID：388889
> 
> 赞同：0
> 
> 时间：2008-12-23T13:41:08.430
> 
> 标签：sharepoint, preferences, personalization

我正在创建共享点自定义解决方案，该解决方案将显示页面中的下拉数量。下拉数据在可能的页面中共享。

我想保留用户的选定值，这样当他访问该页面或具有相同下拉列表的任何其他页面时，他应该能够看到在下拉列表中预先选择的已保存值。

为了实现这一点，我有很多选择。请建议最适合 SharePoint 1)Sharepoint 用户配置文件 2)Sharepoint 列表 3) Cookie 4) 隔离存储？

这里的选项 3 和 4 是客户端。但我正在寻找 SharePoint 提供的任何其他方式来保存用户首选项/个性化信息。

哪一种是在 SharePoint 中执行此操作的正确方法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-28T15:45:33.213

我的直觉告诉我为此使用 cookie，如果这是一个相当简单的状态，你需要坚持下去。这似乎是 UI 逻辑的一部分，我不会将其绑定到配置文件存储。

页面和 Web 部件也有个性化存储，但它们通常不在实例之间共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-25T01:46:37.030

对于用户配置文件，您应该注意的一个问题是它们仅适用于 MOSS（而不是 WSS）。在 WSS 中，每个站点都有自己的用户信息列表。如果您正在构建的解决方案需要在 MOSS 和 WSS 环境中运行，您应该相应地进行计划。

jt

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T20:53:36.623

我会使用配置文件存储，因为这就是它的用途，尽管通常当您在 SharePoint 中编写自定义代码时，最佳实践的想法会被抛到窗外。

# image - 如何在 Java ME 中发送图片？

> ID：388897
> 
> 赞同：2
> 
> 时间：2008-12-23T13:44:58.563
> 
> 标签：image, java-me

如何在 Java ME 中发送图片？也许使用并通过请求`base64 decode`以邮寄形式发送`http`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-07-06T10:23:44.347

我想你在 J2me 中寻找这个[图像 base64 编码](http://www.java-n-me.com/2011/02/taking-picture-base64-encoding-in.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T09:42:58.593

您是否考虑过使用“multipart/form-data”编码类型？如果是这样，那么就不需要 Base64 编码。有关如何构建请求的说明，请参见[此处](http://chxo.com/be2/20050724_93bf.html)和[此处。](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.2)

如果您仍然想做 Base64 编码，那么您将能够在 Web 上轻松找到许多源代码实现。如果您同时开发服务器端和客户端，则可以在两端使用自己的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T09:48:41.577

Base64 for Java 中有很多编码器。[Apache commons](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html)有一个，这里是[一个独立的](http://www.source-code.biz/snippets/java/2.htm)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T11:26:50.633

是的，我用它来发送base64，放入

```
// write your picture data to os

os.write (data); 
```

其中 data = String with a base64 image ，问题是我没有在 java 和 asp 中以相同方式工作的 base64 库。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-23T16:39:15.967

```
HttpConnection connection = (HttpConnection) Connector.open("http://www.myserver.com");
connection.setRequestMethod(HttpConnection.POST);
connection.setRequestProperty("Content-Type","image/png");
OutputStream os = connection.getOutputStream();
// write your picture data to os
os.flush();

if (connection.getResponseCode() == HttpConnection.HTTP_OK)
{ 
```

# performance - 使用 _win32_winnt=0x0501 而不是 0x400 编译时性能下降

> ID：388904
> 
> 赞同：1
> 
> 时间：2008-12-23T13:48:31.567
> 
> 标签：performance, winapi

有没有人知道将 _win32_winnt 从 0x400 更改为 0x0501 对性能的影响？

我在 VS2005 上编译 C++。我的应用程序非常面向通信，做了很多 Winsock 工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-07-26T15:30:08.770

0x0400 的值针对 _WIN32_WINNT_NT4，它是针对 Windows 2000 的 Windows SDK 的较小子集。这意味着您正在排除、忽略和丢弃大量本应编译到可执行文件中的代码。所以是的，它会执行得更快。

因此，当您定义 0x0501 时，您是在说，是的，请给我 Windows XP 的头文件所提供的所有额外的好处。但是，由于导入失败，您的应用程序很可能无法在 Windows 2000 上运行。由于你带来了所有额外的脂肪，你的编译时间会更慢，你的代码会更大，你的可执行文件会更大，而且很可能会更慢。

您可以在此处找到有关这些主题的更多信息：

[http://blogs.msdn.com/b/oldnewthing/archive/2007/04/11/2079137.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2007/04/11/2079137.aspx)

[http://msdn.microsoft.com/en-us/library/aa383745.aspx](http://msdn.microsoft.com/en-us/library/aa383745.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T14:05:23.623

我不知道任何特定的与性能相关的问题，但如果您可以提供有关您的性能如何受到影响的更具体的细节，那么有人可能会提供帮助。

例如，您的网络吞吐量是否比您认为的要低？

# c# - 提高 .NET 中多线程 HttpWebRequest 的性能

> ID：388908
> 
> 赞同：30
> 
> 时间：2008-12-23T13:50:07.023
> 
> 标签：c#, .net, multithreading, httpwebrequest

我正在尝试测量 Web 服务的吞吐量。

为了做到这一点，我编写了一个小工具，它可以连续发送请求并从多个线程读取响应。

每个线程的内部循环的内容如下所示：

```
public void PerformRequest()
{
  WebRequest webRequest = WebRequest.Create(_uri);

  webRequest.ContentType = "application/ocsp-request";
  webRequest.Method = "POST";
  webRequest.Credentials = _credentials;
  webRequest.ContentLength = _request.Length;
  ((HttpWebRequest)webRequest).KeepAlive = false;

  using (Stream st = webRequest.GetRequestStream())
    st.Write(_request, 0, _request.Length);

  using (HttpWebResponse httpWebResponse = (HttpWebResponse)webRequest.GetResponse())
  using (Stream responseStream = httpWebResponse.GetResponseStream())
  using (BufferedStream bufferedStream = new BufferedStream(responseStream))
  using (BinaryReader reader = new BinaryReader(bufferedStream))
  {
    if (httpWebResponse.StatusCode != HttpStatusCode.OK)
      throw new WebException("Got response status code: " + httpWebResponse.StatusCode);

    byte[] response = reader.ReadBytes((int)httpWebResponse.ContentLength);
    httpWebResponse.Close();
  }      
} 
```

它似乎工作正常，除了似乎限制了该工具的某些东西。如果我以每 40 个线程运行该工具的两个实例，我获得的吞吐量比一个具有 80 个线程的实例要高得多。

[我找到了 ServicePointManager.DefaultConnectionLimit 属性，我将其设置为 10000 （如果我按照 Jader Dias 的建议](https://stackoverflow.com/a/436477/5542)通过 app.config 设置它没有区别）。

.NET 或我的机器上是否有任何其他设置会影响性能？（我正在运行 Vista，但我在 Windows Server 2003 上看到了同样的问题）。

也许对单个进程可以建立多少个连接有一些限制？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-12T18:32:52.883

您必须在 app.config 或 web.config 文件中设置 maxconnection 参数：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.net>
    <connectionManagement>
      <add address="*" maxconnection="80"/>
    </connectionManagement>
  </system.net>
</configuration> 
```

最高 100 的值在 Windows XP 中运行良好。

**更新：**我刚刚发现上面的方法是设置 System.Net.ServicePointManager.DefaultConnectionLimit 的另一种方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T16:43:16.067

您是否尝试过在网络设置中增加最大连接数？

[http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx](http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T14:09:22.507

这可能是最近施加的连接限制。

[http://www.speedguide.net/read_articles.php?id=1497](http://www.speedguide.net/read_articles.php?id=1497)

和

[http://www.mydigitallife.info/2007/04/09/windows-vista-tcpipsys-connection-limit-patch-for-event-id-4226/](http://www.mydigitallife.info/2007/04/09/windows-vista-tcpipsys-connection-limit-patch-for-event-id-4226/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T17:17:35.733

请记住，多线程代码总是会导致任何共享资源的争用，即使您没有明确共享任何内容，您也可能正在使用在幕后共享资源的类。

如果您确实使用 2 40 线程 exe 获得比 1 80 线程 exe 更好的性能，那么您需要从共享资源开始调查。如果是这样的话，你引用的代码远没有创建和管理线程的代码那么有趣。

我要抛出的另一件事是，您可以获得几种工具，它们通常可以为您完成此类事情。请参阅[http://support.microsoft.com/kb/231282](http://support.microsoft.com/kb/231282)。Visual Studio 中也包含（我不确定是什么 skus）是新一代的 Web 应用程序性能测试工具。我敢肯定，如果你看的话，你也能找到一些非 MS 的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-22T04:21:48.457

性能有两个重要方面：

1.  一方面，正如所有人所建议的那样，客户端使用**的 TCP 连接数**（如果这些连接被持久化（保持活动状态 = true），通常会更好）详情请参阅：http: [//msdn.microsoft.com/en-us /library/system.net.servicepoint.connectionlimit(v=vs.110).aspx，httpwebrequest](http://msdn.microsoft.com/en-us/library/system.net.servicepoint.connectionlimit(v=vs.110).aspx)中[TCP 连接是如何以及在哪里创建的，它与 servicepoint 有什么关系？](https://stackoverflow.com/questions/22800216/how-and-where-the-tcp-connection-has-been-created-in-httpwebrequest-and-how-is)，[当客户端连接到“localhost”上的服务时，为什么 System.Net.ServicePoint.ConnectionLimit 使用“7FFFFFFF”（Int32.MaxValue/2147483647）？](https://stackoverflow.com/questions/22930486/why-system-net-servicepoint-connectionlimit-uses-7fffffff-int32-maxvalue-2147?lq=1), [System.Net.ServicePointManager.DefaultConnectionLimit 和 .MaxServicePointIdleTime](https://stackoverflow.com/questions/3363183/system-net-servicepointmanager-defaultconnectionlimit-and-maxservicepointidleti?lq=1) )

2.  第二个方面不是使用多个新线程/或使用工作线程在代码片段中使用同步调用（如 httpwebrequest.getrequeststream）并行工作，**完全采用异步模型**（例如，begin/endrequeststream 或新任务变体） . 这样 CPU 会一直很忙，让 I/O 完成端口线程通过调用回调在工作（线程池）线程中简单地发送响应。（您可以参考：[.NET 如何使用 IO Threads 或 IO Completion Ports？](https://stackoverflow.com/questions/539940/how-does-net-make-use-of-io-threads-or-io-completion-ports)、[http](http://blog.marcgravell.com/2009/02/async-without-pain.html) : [//blog.marcgravell.com/2009/02/async-without-pain.html、HttpWebRequest 和 I/O 完成端口](https://stackoverflow.com/questions/4779579/httpwebrequest-and-i-o-completion-ports))

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-23T16:51:47.140

How are you creating your threads? I assume that since you know you have 80 threads, you're not using the threadpool manager, because with the threadpool manager you can ask for as many threads as you like and you'll only get 25 active threads at a time. If you create the threads manually with an array then you'll actually get as many as you need, however they are still in the same process space, so that might limit them over threads running in separate processes.

You might also look into which apartment style the threads are getting created with, I believe the Thread class ctor uses STA by default. Try MTA and see if they affects performance.

# c# - NHibernate 映射 - 一对一（或一对零）

> ID：388914
> 
> 赞同：7
> 
> 时间：2008-12-23T13:57:05.480
> 
> 标签：c#, nhibernate, nhibernate-mapping

冬眠者！

我有一个表 [dbo].[Wibble] 和另一个表 [dbo].[WibbleExtended]。

[Wibble] 是主表，[WibbleExtended] 是一个可选表，其中存储了一些其他字段。[WibbleExtended] 表中的条目比主 [Wibble] 表中的条目少得多。我认为这是为了解决一些空间问题（Wibble 有很多行，而 WibbleExtened 有很多列）。

每个表的 ID 都是相同的，并且来自外部源。

IE

```
[dbo].[Wibble].[WibbleId] 
```

和

```
[dbo].[WibbleExtended].[WibbleId] 
```

是相同的，并且这两个表是如何关联的。

注意我无法更改架构。我把它硬塞到一个我几乎无法控制的遗留系统上。

搜索似乎一对一的映射是有问题的，流行的智慧是使用两个多对一的映射。

我目前的映射是：

```
<class name="Wibble" table="Wibble" >
   <id name="Id" column="WibbleId" type="Int32">
      <generator class="assigned"/>
   </id>

   <many-to-one name="WibbleExtended" class="WibbleExtended" column="WibbleId" not-null="false" cascade="all"/>
</class> 
```

和

```
<class name="WibbleExtended" table="WibbleExtended" >
   <id name="Id" column="WibbleId" type="Int32">
        <generator class="assigned" />
   </id>

   <many-to-one name="Wibble" class="Wibble" column="WibbleId" not-null="true" />     
 </class> 
```

问题是我遇到了错误，例如

```
System.IndexOutOfRangeException: Invalid index n for this SqlParameterCollection with Count=n. 
```

我环顾四周，这看起来确实是正确的策略，它只是落在了最后的障碍上。

问题是 id 生成器吗？映射的其他方面？

免费肉馅饼以获得正确答案。

编辑：好的 - 这是我通过@James Gregory 解决这个问题的方法。

1.  将单元测试从 WibbleExtended 测试移至 Wibble 测试类并进行了必要的修改。

2.  将以下内容添加到 Wibble.hbm.xml

    ```
    <join table="WibbleExtended" optional="true">
         <key column="WibbleId"/>
         <property name="Blah1" column="Blah1" type="String" length="2000" not-null="false" />
         <property name="Blah2" column="Blah2" type="String" length="1000" not-null="false" />    
    </join> 
    ```

3.  在 Wibble POCO 中添加了相应的属性。

4.  删除了所有与 WibbleExtended 相关的代码。

5.  运行测试，全部通过，签入。构建通过。去喝圣诞啤酒（因此我已经过了几天才更新这个！:-)）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-24T09:30:19.800

你得到的错误：

> 此 SqlParameterCollection 的索引 n 无效，Count=n。

是由于**两个属性映射到同一列**。在两者之一中使用 insert=false 和 update=false 。

参考[http://groups.google.com/group/nhusers/browse_thread/thread/84830b1257efd219](http://groups.google.com/group/nhusers/browse_thread/thread/84830b1257efd219)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-23T14:25:27.467

您是否考虑过使用NHibernate 2.0 中引入的[Join 元素？](http://nhibernate.info/doc/nhibernate-reference/mapping.html#mapping-declaration-join)此元素允许您连接多个表以形成一个实体；这种关系也可以是可选的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T14:47:28.703

查看此链接： [http ://www.hibernate.org/hib_docs/nhibernate/html/inheritance.html](http://web.archive.org/web/20080511185911/http://www.hibernate.org/hib_docs/nhibernate/html/inheritance.html)

特别是“加入的子类”映射，我认为您会发现它很有帮助（假设 WibbleExtended 继承自 Wibble）。

# linux - 有没有办法检查USB驱动器是否停止？

> ID：388928
> 
> 赞同：1
> 
> 时间：2008-12-23T14:06:03.700
> 
> 标签：linux, shell, hardware, usb, opensuse

我已经编写了一个脚本来每天晚上备份我的服务器的 HD。在脚本结束时，我同步，等待几分钟，同步，然后我发出`sg_start --stop`停止设备的命令。这个想法是通过在十分钟的增量备份后关闭 HD 来延长设备的使用寿命（桌面磁盘可以承受数千个开/关循环，但只能持续运行几百小时）。

这并不总是有效。我经常发现第二天早上驱动器仍在旋转。是否有一个 shell 命令可用于检查驱动器是否已停止（因此我可以再次发出停止命令 [EDIT2] 或编写脚本以在驱动器运行时创建进程列表，以便我可以调试它[/EDIT2 ]）？

[编辑] 我试过[sg_inq](http://linux.die.net/man/8/sg_inq)（如 sg_start 手册页所建议的那样），但这个命令总是返回 0。

我已经尝试过[hdparm](http://sourceforge.net/projects/hdparm/)，但它总是为 USB 驱动器（通过 /dev/sdX 连接）返回“驱动器状态为：未知”，并且在尝试降低驱动器时，我得到“HDIO_DRIVE_CMD（setidle1）失败：输入/输出错误” .

[sdparm](http://sg.danny.cz/sg/sdparm.html)似乎支持在驱动器上设置空闲计时器（请参阅“电源模式条件页面”），但 IDLE 选项具有“可更改：n”，我还没有找到告诉我驱动器电源状态的选项。

`sg_start --stop`[EDIT2] 注意：我可以从控制台停止驱动器。这总是有效的；它并不总是一直待到午夜。服务器在地下室（那里又好又酷），我宁愿有办法从温暖的客厅检查驱动器是否启动:) 如果我有一个命令告诉我驱动器的状态，我可以编写一个脚本在它启动时提醒我（每分钟检查一次），然后我可以尝试找出可能导致这种情况的原因。

如果这很重要：我使用的是 openSUSE 11.1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T22:42:28.120

当您说您尝试过 hdparm 时，您还没有说出**您**尝试过的内容。我在一个机箱中有一些 USB 硬盘驱动器，一些命令适用于它，而另一些则没有，但我想这完全取决于传输机制的各个方面。

```
 hdparm  -S 120  /dev/sda 
```

应该告诉驱动器在大约 10 分钟不活动后自行休眠。

我猜你已经尝试过这个，但它并不明显，写这个作为*答案*可能会对未来的读者有所帮助。

```
Nothing accesses the drive but the backup script. 
```

这在理论上很好，但我偶尔发现这还不够。有很多进程和任务，如果他们甚至*查看*驱动器，如果查找由于某种原因超出磁盘缓存，则可能会发生旋转。

常见的罪魁祸首是诸如`updatedb`扫描所有挂载文件之类的工具，`fam`或者`gamin`做一些时髦的事情来监控磁盘的变化。

如果有疑问，请通过在执行脚本之前安装设备并在完成后卸载它来增加确定性。

**看到可能导致唤醒的事物**

```
 lsof +D /mountpoint 
```

在尝试卸载之前，您可能还应该解析它的输出，以确保没有任何东西仍在尝试使用它。

**您可能还应该做一个懒惰的 umount**，

```
 umount -l /mountpoint 
```

所以如果在你做`lsof| grep`和打电话之间有任何东西访问它`umount`，它仍然会卸载驱动器并阻止东西能够读取它。

**HAL 和朋友们**

HAL 和朋友也可能正在唤醒驱动器以探测连接/移除状态。我真的希望它不是，但它在某些设备类型上会这样做。这似乎是一个不太可能的原因，但我会考虑任何可能的事情。

尝试有趣的东西，比如

```
lsof /dev/devicehere 
```

和

```
lsof /dev/devicehere1 
```

这似乎获得了将直接或间接访问句柄的所有事物的完整列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-10T07:42:08.687

You also need to check the mount options and use "noatime" as a mount option, otherwise the kernel still updates the access times periodically. So this may be the cause of your problem too.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-19T20:06:34.883

如果`hdparm`返回这个：

```
 drive state is:  unknown 
```

并`smartctl`返回：

```
CHECK POWER MODE: incomplete response, ATA output registers missing
CHECK POWER MODE not implemented, ignoring -n option 
```

那么就无法获取U盘休眠状态。我[尝试了多种创造性的东西](https://forums.unraid.net/bug-reports/stable-releases/683-usb-hdds-randomly-spin-up-but-status-stays-unchanged-r1091/)，例如 USB 功耗或监视文件访问，但我没有发现可以验证驱动器的状态。

唯一的解决方案是将 USB SATA 适配器（或外壳）替换为具有不同 USB 桥接芯片的适配器。对我不起作用的那个使用了 JMicron JMS567 (152d:0578 / 0x152d 0x0578)，它可能会被[更新](https://wiki.odroid.com/odroid-xu4/software/jms578_fw_update)，但我无法测试它，因为更新工具需要一个 ARM CPU。现在我正在使用两个不同的适配器，它们都使用 Asmedia ASM1051E / ASM1053E / ASM1153 / ASM1153E 并且它们通过所有命令。

您可以检查您的 USB SATA 适配器/外壳的桥接芯片，如下所示：

```
lsusb -v | grep -E ': ID |idVendor|idProduct' 
```

它返回如下内容：

```
Bus 002 Device 003: ID 174c:55aa ASMedia Technology Inc. ASM1051E SATA 6Gb/s bridge, ASM1053E SATA 6Gb/s bridge, ASM1153 SATA 3Gb/s bridge
  idVendor           0x174c ASMedia Technology Inc.
  idProduct          0x55aa ASM1051E SATA 6Gb/s bridge, ASM1053E SATA 6Gb/s bridge, ASM1153 SATA 3Gb/s bridge 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T14:41:33.580

我经常发现第二天早上驱动器仍在旋转。

这难道不是因为它在服务器时再次启动，例如。在夜间写入日志文件或其他内容？您可以尝试 sdparm，它可以返回驱动器的状态信息。但我认为最好在 BIOS 中设置一个选项，让你的 HD 在一段时间不活动后自动降速，这样更容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T16:41:35.020

Have you tried stopping the drive with the following command:

```
eject -t /dev/yourHD 
```

This works quite good for my USB hard drives.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-15T16:37:40.553

如果`hdparm -C /dev/sda`说它`drive state is: unknown`不支持您的驱动器并且无法判断

您的其他问题（其他人已经回答）

*   什么是使用驱动器？
    *   lsof
    *   定影器
    *   触发器
*   如何强制驱动器保持睡眠？
    *   hdparm
    *   卸载
    *   您的设备在卸载时仍然可以被唤醒，但可能只能通过您执行的操作（smartctl、blkid 等）

相关：如果您的驱动器变热，您还可以自动暂停备份或其他一个小时。

# c - 在 IPv6 中使用 resolv.h 的名称解析器

> ID：388930
> 
> 赞同：3
> 
> 时间：2008-12-23T14:07:40.747
> 
> 标签：c, dns, ipv6

我编写或修改执行名称解析并需要对过程进行良好控制的程序。所以我不使用`getaddrinfo()`，我更深入地使用`res_query()`/ `res_send()`/ etc in `resolv.h`，在resolver（3）中记录。

虽然没有记录，但设置使用的解析器的常用方法是更新`_res.nsaddr_list`. 但是这个在 resolv.h 中定义的数组 `struct sockaddr_in`只存储了 IPv4 地址。（IPv6 地址是`struct sockaddr_in6`，独立于家庭的系统将使用`struct sockaddr`。）

我正在寻找一种方法（最好是可移植的，至少在各种 Unix 中）来告诉`_res`我我也想要 IPv6 地址。

显然，很久以前，FreeBSD 中就有`_res_ext`这种能力，但我在最近的 FreeBSD 7 中找不到它（`grep _res_ext /usr/include/resolv.h`什么也没找到）。您仍然可以找到 [使用它的代码（](http://www.squid-cache.org/~hno/changesets/squid3/patches/5775.patch)[使用 Google Codesearch](http://www.google.com/codesearch?hl=en&lr=&q=)自己尝试）。

感谢Alnitak，我注意到它显然是现在`_res._ext`而不是`.res_ext`。我想知道这些事情是在哪里记录或宣布的……我不知道便携`_res._ext`性如何。我可以在 Debian 和 FreeBSD 上找到它。似乎很少有程序使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T14:32:04.910

Stéphane - 如果您`resolv.h`不包含对 then 的任何支持，`sockaddr_in6`则表明在您的特定 O/S 上，解析器本身不支持 IPv6 传输。

我在这里检查了我的一些系统：

*   MacOS X 10.5.6 - 支持 BIND 9 库，该库具有*可以*接受 IPv6 地址的`res_setservers()`功能，无需扩展。*`_res._ext`*

**   CentOS 5.2 - 有`_res._ext`扩展，虽然在手册页中没有提到 IPv6，`resolv.conf`除了有一个设置告诉解析器在查找 A 记录之前返回 AAAA 记录`gethostbyname()`。* 

 *编辑 - 此外，FreeBSD 的[CVS 存储库](http://www.freebsd.org/cgi/cvsweb.cgi/src/include/resolv.h)表明 FreeBSD 7.0（请参阅标签`FREEBSD_7_0_0_RELEASE`）也支持`res_setservers()`Bind 9。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-28T22:10:43.520

glibc：

```
res_setservers: no
__res_state._u._ext.nsaddrs
__res_state._u._ext.nsmap 
```

根据以下设置将后者设置为 MAXNS+1：

[http://sourceware.org/ml/libc-hacker/2002-05/msg00035.html](http://sourceware.org/ml/libc-hacker/2002-05/msg00035.html)

BSD-libc：

```
res_setservers: yes
__res_state._u._ext.__res_state_ext 
```

对我来说似乎很乱，你可能需要autoconf。

# c++ - 按模板类型对齐成员变量

> ID：388934
> 
> 赞同：2
> 
> 时间：2008-12-23T14:11:58.913
> 
> 标签：c++, templates

我想根据类模板类型对齐我的成员变量，但我不确定它是否真的可能。

以下是我想做的一个（非常）简单的例子

```
template<int Align>
class MyClass
{
private:
  struct MyStruct
  {
    // Some stuff
  } __declspec(align(Align));

  __declspec(align(Align)) int myAlignedVariable;
}; 
```

因此，我希望 Align 成为每个实例的变量，并且只有这样才能确定类内容的 align 值。

不幸的是，我总是收到以下错误

```
error C2975: 'test::MyClass' : invalid template argument for 'Align', expected compile-time constant expression 
```

那么，这实际上是可能的还是只能使用固定的编译时间常数才能进行对齐？如果没有，任何人都可以想办法解决这个问题吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T14:56:31.197

自定义对齐不在标准中，因此编译器如何处理它取决于他们 - 看起来 VC++ 不喜欢将模板与 __declspec 组合。

我建议使用专业化的解决方法，如下所示：

```
template<int A> struct aligned;
template<> struct aligned<1> { } __declspec(align(1));
template<> struct aligned<2> { } __declspec(align(2));
template<> struct aligned<4> { } __declspec(align(4));
template<> struct aligned<8> { } __declspec(align(8));
template<> struct aligned<16> { } __declspec(align(16));
template<> struct aligned<32> { } __declspec(align(32)); 
```

然后从您的代码中派生：

```
template<int Align>
class MyClass
{
private:
  struct MyStruct : aligned<Align> {
    // stuff
  };
}; 
```

不幸的是，这打破了 MyStruct 的 POD 特性。它也不适用于内置/现有类型，因此您必须为这些类型使用包装器。

```
aligned_t<int, 4> myAlignedVariable; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-23T15:56:00.513

Boost 已经解决了这个问题。他们在[boost::optional](http://www.boost.org/doc/libs/1_35_0/libs/optional/doc/html/index.html) ([链接到 header](http://www.boost.org/doc/libs/1_32_0/boost/optional/optional.hpp) ) 中使用该技术，它必须为对齐的任意类型保留足够的空间，但不能（不会）在构造时实际实例化该对象。

他们的解决方案是分配一个简单的字节池（char 数组）并使用 in-place new 在所需位置构造对象。给就地新的地址可以是任意对齐的。

That being said, you're saying that you're giving a very simple example in your question. What is the actual problem that you're trying to solve by implementing a class where every member has a user-specified alignment that doesn't vary per member but can vary per class instance?

# c# - 根据 Winforms/C# 中的文本数量和字体大小确定标签大小

> ID：388937
> 
> 赞同：45
> 
> 时间：2008-12-23T14:12:22.877
> 
> 标签：c#, .net, winforms

我想知道是否有更好的方法来解决这个问题。我想（垂直）调整标签的大小以容纳一定数量的文本。我的标签有一个固定的宽度（在它必须换行之前大约 60 个字符宽），大约 495 像素。字体也是固定大小（12points afaik），但文本不是。

我想要做的是在有“NewLine”或文本必须换行时增加标签高度；这个想法是文本在标签中完全可见。AutoSize 不起作用，因为它会增加宽度，而不是高度。

当然，我可以计算 NewLines 的数量并添加：Newlines * LineHeight，然后 - 假设我设法每行放置 60 个字符，只需将字符数相除并根据需要添加尽可能多的 LineHeight 像素。

我想知道是否有更专业的方法来做到这一点。我的方法太“蹩脚”了吗？

提前致谢。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-12-23T14:22:04.620

怎么样`Graphics.MeasureString`，使用接受字符串、字体和最大宽度的重载？这将返回 a `SizeF`，因此您可以四舍五入`Height`。

```
 using(Graphics g = CreateGraphics()) {
            SizeF size = g.MeasureString(text, lbl.Font, 495);
            lbl.Height = (int) Math.Ceiling(size.Height);
            lbl.Text = text;
        } 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-12-23T14:22:43.323

System.Drawing.Graphics 具有可用于此目的的 MeasureString 方法。使用带有字符串、字体和 int "width" 参数的重载；最后一个参数指定字符串允许的最大宽度 - 将此参数使用标签的设置宽度。

MeasureString 返回一个 SizeF 对象。使用此返回对象的 Height 属性设置标签的高度。

注意：要为此目的获取一个 Graphics 对象，可以调用 this.CreateGraphics。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-23T14:21:49.893

Graphics.MeasureString() 可能会帮助你。

这也是使用 Control.CreateGraphics() 调用的唯一用例之一！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-07T10:37:28.897

```
Size maxSize = new Size(495, int.MaxValue);
_label.Height = TextRenderer.MeasureText(_label.Text , _label.Font, maxSize).Height; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-26T07:25:13.403

这个“答案”供将来参考，并与 AutoSize = true 暗示它（WinForms 标签）永远不会增长的初始假设作斗争。

以下链接显示了 AutoSize = true 与其他属性（例如 MaximumSize）的各种效果。根据问题的预期用途，采用其中一种方法可能是合适的。

[http://blogs.msdn.com/jfoscoding/articles/478299.aspx](http://blogs.msdn.com/jfoscoding/articles/478299.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-30T13:27:23.547

我在此处接受的答案中发布了一个解决此问题的用户控件： [TextBox 控件中的自动缩放字体，使其尽可能大并且仍然适合文本区域边界](https://stackoverflow.com/questions/791830/autoscale-font-in-a-textbox-control-so-that-its-as-big-as-possible-and-still-fit)

该控件扩展了 RichTextBox。它有一个方法：ScaleFontToFit，它会自动调整字体大小以使所有文本适合。

整洁的是它尊重多行属性。如果它是真的，它允许单词换行，否则它不会。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-04-06T19:49:00.727

我想提出一个替代方案，因为它是我们正在谈论的*标签*，而不仅仅是文本渲染：`GetPreferredSize`. 我尝试了马克的回答，问题是它*几乎*可以工作：标签在文本周围有一些“填充”，这需要`width`在`MeasureString`. 我找不到任何明显的方法来获得这个填充。在挖掘时，我发现[了这个答案](https://stackoverflow.com/a/22230310/1303323)，海报建议将其设置`FlatStyle`为`System`. 这行得通，但不幸的是打破了`TextAlign`我想要的`MiddleLeft`。

我查看了`Label`代码，发现`GetPreferredSize`它考虑了所有奇怪的设置（`FlatStyle`等`UseCompatibleTextRendering`），并且可以为每种情况提供正确的结果。所以`g.MeasureString(text, lbl.Font, 495);`你可以代替

```
lbl.GetPreferredSize(new Size(495, 0)); 
```

甚至像这样，因为标签大小是已知的：

```
lbl.GetPreferredSize(new Size(lbl.Width, 0)); 
```

如果您想知道，0 和 1 将被视为`int.MaxValue`.

我不知道什么时候`GetPreferredSize`介绍的，所以早在 2008 年马克写他的答案时，上面的内容可能不相关。但是如果你在 2021 年仍然需要​​类似的东西，`GetPreferredSize`可能会更方便一些——它返回 a`Size`而不是 a `SizeF`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-23T14:23:19.517

好吧，这 60 个字符可能对您的测试文本有效，但并非所有字符都具有相同的宽度。例如，比较
llllllllllllllllllllllllllllllllllllllllllllllllllllllllllll
和
wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww

它们都有 60 个字符，但宽度却大不相同。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-31T15:09:00.513

[使用TextRenderer](http://msdn.microsoft.com/en-us/library/system.windows.forms.textrenderer.aspx)类来测量字符串（如在 Marc 的响应中）而不是通过工作来创建 Graphics 对象等有什么缺点吗？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-09T18:20:03.343

根据[这篇文章](https://stackoverflow.com/questions/6704923/textrenderer-measuretext-and-graphics-measurestring-mismatch-in-size)，如果您打算使用 Windows 窗体控件进行最终输出，您应该使用 TextRenderer。TextRenderer 和 Graphics.MeasureString 将给出不同的结果，因此请使用与您的最终输出模式相匹配的结果。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-12-28T12:13:54.297

在某些情况下，您必须使用紧凑的框架，它没有任何 MeasureString() 的覆盖方法，您可以考虑自己计算高度。

```
private int YukseklikAyarla(string p, Font font, int maxWidth)
    {
        int iHeight = 0;
        using (Graphics g = CreateGraphics())
        {
            var sizes = g.MeasureString(p, font); // THE ONLY METHOD WE ARE ALLOWED TO USE
            iHeight = (int)Math.Round(sizes.Height);
            var multiplier = (int)Math.Round((double)sizes.Width) / maxWidth; // DIVIDING THE TEXT WIDTH TO SEE HOW MANY LINES IT CAN HAS
            if (multiplier > 0)
            {
                iHeight = (int)(iHeight * (multiplier + 1)); // WE ADD 1 HERE BECAUSE THE TEXT ALREADY HAS A LINE
            }
        }
        return iHeight;
    } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-27T05:31:50.273

虽然，它是一个旧线程，但认为它可能会帮助新访客。

在 C# 中，您可以使用 control.width

# sql - 用于 CSV 文件的快速、免费的桌面 SQL 工具

> ID：388941
> 
> 赞同：4
> 
> 时间：2008-12-23T14:14:34.010
> 
> 标签：sql, csv

我有一堆非常大的 CSV（逗号分隔值）文件，我想分析它们。SQL 查询非常适合这种情况。到目前为止，我一直在使用 MS Access 导入 CSV 文件并对其执行查询。然而，除了有一个非常糟糕的 SQL 编辑器和关于何时可以打开/编辑/删除查询/表的愚蠢的任意规则之外，它非常慢。执行查询时，我可以忍受最初的缓慢，但我真的很讨厌每当我尝试对另一列上的表进行排序、等待 5 分钟或尝试滚动时，它似乎会重新执行它。

有没有更好的（免费）工具来完成这项工作？（如果需要，我愿意手动编写脚本将 CSV 转换为其他内容）

谢谢！

编辑：感谢所有答案！我将尝试 SQL Server，如果成功，我会接受这个答案。只是澄清一下：导入数据文件对我来说不一定是问题（尽管当然欢迎使用简单的方法）。我需要的是一些程序，它随后允许我快速有效地执行（相当复杂的）查询。FileHelpers 不会帮助我，因为首先我不知道任何 .NET 语言，其次，我有 Java 中的数据，但我认为使用 SQL 分析它会容易得多。不过感谢您的回答！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T14:18:51.910

为什么不直接将它们导入 MySQL，这很容易。

```
LOAD DATA LOCAL INFILE 'file.csv' 
INTO TABLE some_table 
FIELDS TERMINATED BY ',' 
LINES TERMINATED BY '\n' 
(field1, filed2, field3); 
```

然后你可以轻松运行任何复杂的查询......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T14:31:59.637

你没有说你使用什么 DBMS，但[PostgreSQL](http://www.postgresql.org/)有一个[COPY](http://www.postgresql.org/docs/current/interactive/sql-copy.html)命令可以这样做，有很多选项：

```
COPY billing.contact FROM '/foo/bar/contact.csv' WITH DELIMITER AS ','; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-23T14:26:59.197

SQL Server Express 2008 与工具[在这里](http://www.microsoft.com/downloads/details.aspx?FamilyId=7522A683-4CB2-454E-B908-E805E9BD4E28&displaylang=en)。它包括 Management Studio，效果很好。

请注意，它确实需要 .net framework 3.5 sp1、MS Installer 4.5 和 Powershell 1.0，但如果您也需要这些链接，下载页面上也有链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T15:21:06.077

稍微开箱即用，您可能会查看[LINQ to CSV](http://www.codeproject.com/KB/linq/LINQtoCSV.aspx)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T18:46:10.843

还有一个 Oracle Express Edition。

我想这取决于您已经精通的地方。或者也许你**想**精通的地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T18:52:00.033

如果您可以将它们获取到 Access，那么只需将 Access 表导出到 SQL Server。或者，如果 csv 有一个通用架构，则创建表是 SQL Server，从 Access 远程附加，然后直接导入 SQL Server。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-18T13:16:04.293

[logparser](http://www.microsoft.com/technet/scriptcenter/tools/logparser/default.mspx)可以做到...您可以在 csv 和其他分隔文件上创建 sql 查询

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-18T13:19:43.833

Oracle SQL Developer（和 Oracle Express Edition - 感谢 Mark）都是免费的、轻量级的，并且 SQl Developer 可以将 csv 文件加载到完整的关系数据库中：Oracle XE> 然后您可以运行 SQL 语句，甚至可以通过拖放界面创建它们。你也可以看看松鼠

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-23T15:47:16.053

如果您想对数据进行一些处理，我可以推荐[http://www.filehelpers.com/](http://www.filehelpers.com/)上的 FileHelpers 库。它几乎包括您导入、处理和导出分隔或固定长度数据文件所需的一切。

您可以使用 SQL Server Express 作为免费数据库来代替 Access。在这里阅读：

[http://www.microsoft.com/express/sql/default.aspx](http://www.microsoft.com/express/sql/default.aspx)

您可以使用 SQL Server 的 Management Studio Express 来查询您的数据，或者您可以通过 Visual Studio Express 版本访问许多相同的工具，所有这些都是免费的 - 您甚至可以通过“添加新项目”菜单选项创建新的 MDF。

我希望这有帮助。

# build - 如何弥补开发机器和构建服务器之间的环境差异？

> ID：388944
> 
> 赞同：2
> 
> 时间：2008-12-23T14:14:47.113
> 
> 标签：build, nunit, continuous-integration

我在“C:\Program Files\NUnit 2.4.8\”的机器上安装了 NUnit，但在我的集成服务器（运行 CruiseControl.Net）上，我将它安装在“D:\Program Files\NUnit 2.4.8\”中. 问题是在我的开发机器上我的 NAnt 构建文件可以正常工作，因为在任务中我使用路径“C:\Program Files\NUnit 2.4.8\bin\NUnit.Framework.dll”来添加对'的引用NUnit.Framework.dll' 程序集，但这个相同的构建文件无法在我的集成服务器上构建文件（因为引用路径不同）。我是否必须将 NUnit 安装在与集成服务器相同的位置？这个解决方案对我来说似乎太严格了。有没有更好的？这类问题的一般解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T14:17:34.503

通常，我将 NUnit 和任何其他依赖项与我的项目一起分发到某个公共位置（对我来说，这是顶层的*libs目录）。*

```
/MyApp
  /libs
    /NUnit
    /NAnt
    /etc...
  /src
    /etc... 
```

然后，我只需从我的应用程序中引用这些库，它们相对于项目解决方案始终位于相同的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T14:19:24.110

通常，应避免对绝对路径的依赖。就 CI 而言，您应该能够在干净的机器上完全从 scatch 构建和运行您的解决方案，只使用通过自动化脚本在源代码控制中找到的资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T14:21:29.270

“终极”解决方案可以是将整个工具链存储在您的源代码控制中，并存储您在源代码控制中构建的任何库/二进制文件。正确设置，这可以确保您能够从任何时间点重建任何版本，与发布时完全相同，但此外，您不需要这样做，因为您生成的每个二进制文件都是源头控制。

然而，达到这一点是一项严肃的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T14:18:09.137

我会使用两种方法：

1）使用具有不同路径的两个不同的暂存脚本（开发构建/集成构建）。

2）将所有需要的可执行文件放在你的路径文件夹中并直接调用它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T14:58:33.563

我同意绝对路径是邪恶的。如果您无法绕过它们，您至少可以在您的脚本中设置一个默认为 C:... 的 NUNIT_HOME 属性，并在您的 CI 服务器中调用您的脚本，在命令行中传递 NUNIT_HOME 属性。

或者，您可以将脚本设置为需要设置 NUNIT_HOME 环境变量才能使 NUNIT 工作。现在，您的脚本不要求运行它的机器在某个确切位置具有 nUnit，而是要求 nunit 在环境变量中存在且可用。

任何一种方法都允许您更改正在使用的 nunit 版本，而无需修改构建脚本，这是您想要的吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T15:31:59.533

将工具链中的所有工具都置于版本控制之下的想法是一个很好的想法。但是，在您的路径上，您可以使用几种不同的技术来指定每台机器的不同路径。

NAnt 让您[定义一个`<property>`](http://nant.sourceforge.net/release/0.85-rc1/help/tasks/property.html)可以覆盖的`-Dname=value`. 您可以使用它为您在 CI 系统中覆盖的开发机器设置默认位置。

[`environment::get-variable`](http://nant.sourceforge.net/release/latest/help/functions/environment.get-variable.html)您还可以使用更改每台机器的位置来获取环境变量的值。

# firefox - 火狐是如何工作的？源代码遍历？

> ID：388946
> 
> 赞同：41
> 
> 时间：2008-12-23T14:15:49.017
> 
> 标签：firefox

我想了解 FireFox 如何在幕后工作。我想了解源代码和不同的组件，但代码库相当大，我不知道从哪里开始。

我想知道是否有一些来自 Firefox 团队或社区外部的人写的步行。

我看了一点：[https](https://developer.mozilla.org/En) ://developer.mozilla.org/En ，但我没有看到任何尖叫“从这里开始”的东西。我只是出于 [自我] 教育的原因而尝试查看他们的代码库。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-12-23T14:32:43.177

多伦多的塞内卡学院有一个专门针对这一点的项目——Mozilla 开发的初学者。

查看其中一些链接：

[真实世界的Mozilla](http://zenit.senecac.on.ca/wiki/index.php/Real_World_Mozilla)

[2008年秋季每周时间表](http://zenit.senecac.on.ca/wiki/index.php/DPS909_and_OSD600_Fall_2008_Weekly_Schedule)

如果您想直接进入一些实验室：

[实验室：学习协作发展（2008 年秋季）](http://zenit.senecac.on.ca/wiki/index.php/Learning_Collaborative_Development_Lab_Fall_2008)

[实验室：构建开源项目（2008 年秋季）](http://zenit.senecac.on.ca/wiki/index.php/Building_Open_Source_Projects_Lab_Fall_2008)

[实验室：真实世界的 Mozilla - 源代码阅读](http://zenit.senecac.on.ca/wiki/index.php/Real_World_Mozilla_Source_Code_Reading_Lab)

[实验室：使用补丁](http://zenit.senecac.on.ca/wiki/index.php/Fall_2008_Working_with_Patches_Lab)

[实验室：深入了解 Mozilla - 调试 Mozilla](http://zenit.senecac.on.ca/wiki/index.php/Dive_into_Mozilla_Debugging_Mozilla_Lab)

[实验室：Thunderbird 错误修复](http://zenit.senecac.on.ca/wiki/index.php/Thunderbird_Bug_Fix_Lab)

[实验室：修改浏览器](http://zenit.senecac.on.ca/wiki/index.php/Modifying_the_Browser_Lab)

[实验室：使用扩展修改 Firefox](http://zenit.senecac.on.ca/wiki/index.php/Dive_into_Mozilla_Modifying_Firefox_using_an_Extension_Lab)

[实验室：真实世界的 Mozilla - 第一个 XPCOM 组件](http://zenit.senecac.on.ca/wiki/index.php/Real_World_Mozilla_First_XPCOM_Component)

[Lab: Real World Mozilla - 将 chrome 添加到第一个 XPCOM 组件](http://zenit.senecac.on.ca/wiki/index.php/Real_World_Mozilla_Adding_Chrome_to_FirstXpcom_Lab)

如果您需要任何帮助，请使用 IRC：irc.mozilla.org 上的 #seneca。如果您不是（Seneca）学生，请不要担心，世界各地的很多人（来自 Seneca 的人、来自 Mozilla 的人和其他人）都在这个频道中，目的是对开发人员进行一般性的开源教育和特别是 Mozilla 项目。

祝你好运！

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-12-23T16:51:23.180

这是一个自上而下的答案（其他大多数都是自下而上的）：

Firefox 是一个[XUL](http://www.mozilla.org/projects/xul/)应用程序（另见：[XUL](http://en.wikipedia.org/wiki/XUL)）；XUL 是 XML 的一种变体，用于描述由渲染器解释的 GUI，与在浏览器中渲染 HTML 的方式非常相似，但 XUL 包括浏览器的菜单、按钮、状态栏、键盘快捷键等。它非常简洁; 我已经能够在 XUL 中比在其他框架中更快地组合一些简单的 GUI 应用程序（而且它与平台无关！）。

如果您查看 Firefox 应用程序目录（无论您在系统上安装它的哪个位置），您会看到一个“chrome”目录，其中包含一堆 .jar 文件。这些只是具有特定结构（包括清单）的 .zip 文件，您可以自己查看它们。

大部分 Firefox 浏览器实际上是 XUL + Javascript。它确实利用了许多用 C++ 编写的低级库，并且可以通过 XPCOM 访问 Javascript，但是如果您想了解（和修改）更高级别的行为，XUL+Javascript 部分可能是开始的地方。

编辑：ps 这里有一些 XUL: [1](http://www.xulplanet.com/tutorials/xultu/) [2](https://developer.mozilla.org/En/XUL_Tutorial)的教程/参考资料以及[O'Reilly 的书](http://oreilly.com/catalog/9780596102432/)

编辑：XUL 文档在与用户+事件交互的方式上与 HTML 文档非常相似（只是更是如此！）。[有用于动态修改](https://developer.mozilla.org/en/Dynamically_modifying_XUL-based_user_interface)XUL的文档模型，并且有具有事件侦听器的[事件模型。](https://developer.mozilla.org/En/XUL_Event_Propagation)两者都像 HTML + DOM + 它的事件模型一样，但具有更丰富的内置对象/接口/事件/等。`onclick="blah()"`事件处理程序是特定类型的接口，可以由Javascript对象（在 XUL`addEventListener()`中用可以使用适当的接口实现 XPCOM 对象的语言。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-23T14:20:01.847

开始的一种方法是查看 Firefox 中最近修复的一些错误（请参阅[Bugzilla](http://bugzilla.mozilla.org)）并查看它们是如何修复的。

那就是说。Firefox 代码库非常大，可能没有人了解所有内容，因此最好从一小部分（比如收藏夹）开始，然后尝试找到它的代码并查看它是如何实现的作品。同样，已解决的错误及其影响的文件将是识别一些相关代码的好方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-23T14:40:50.773

我使用 mozilla 代码（确切地说是 mozilla/nss/security）。就我对 Mozilla 的理解而言：

它遵循分层架构，底部有 NSPR 层（Netscape Portable Runtime），与操作系统交互。

从
[https://developer.mozilla.org/En/Download_Mozilla_Source_Code](https://developer.mozilla.org/En/Download_Mozilla_Source_Code)获取源代码并在您的工作环境中构建它（据我所知，它支持多种平台/架构）

加入 Mozilla 开发者社区/尝试通过测试一些组件来提供帮助。

要为 mozilla 编写代码，请通过： [http](http://www.mozilla.org/hacking/) ://www.mozilla.org/hacking/ （如果您是 C++ 程序员，C++ 可移植性标准是必须的）。

希望以上一些内容可以帮助您入门。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-27T19:43:04.490

最近发布了一组视频（截至 2015 年初），这些视频介绍了 Mozilla Firefox 的一些组件。也许你会对他们感兴趣。

[https://air.mozilla.org/search/?q=tag%3A+TorontoBootcamp](https://air.mozilla.org/search/?q=tag%3A+TorontoBootcamp)

他们不是新手，但我认为仍然可以提供帮助。

# file - 复制数百万个文件

> ID：388955
> 
> 赞同：4
> 
> 时间：2008-12-23T14:20:03.000
> 
> 标签：file

我需要通过公司的 SAN 将大约 300 万个文件从一个文件夹复制到另一个文件夹。对我来说最好的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-23T14:21:52.997

如果直接复制太慢（尽管具有回写缓存的 SAN 与此类操作的速度差不多），您可以将文件压缩为一个或多个存档，然后在目标位置展开存档。这将稍微减少磁盘抖动。

在更聪明的层面上，您可以使用 tar 或 cpio 来做一个技巧，在其中存档文件并将它们写入标准输出，然后通过管道传输到另一个 tar/cpio 进程以在其目的地解开它们。

使用 tar 执行此操作的示例命令如下所示：

```
tar cf - * | (cd [destination dir] ; tar xf - ) 
```

一些 SAN 也会直接克隆磁盘卷。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-23T14:26:00.993

如果您在 Windows 上，请使用 robocopy。它非常健壮，适合这种情况。它支持死链接检测，如果一个被中断，它可以被告知重试副本。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-23T14:21:51.937

您是否考虑过使用[rsync](http://samba.anu.edu.au/rsync/)？这是一个使用[算法的工具，该算法涉及计算文件块的哈希值，](http://www.samba.org/rsync/tech_report/node2.html)以比较两个站点并在站点之间发送增量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-23T14:45:45.243

根据我的经验， Microsoft [SyncToy](http://www.microsoft.com/downloads/details.aspx?familyid=C26EFA36-98E0-4EE9-A7C5-98D0592D8C52&displaylang=en)非常擅长处理数量惊人的文件。它非常易于使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T14:22:25.023

我认为 Teracopy 会做到这一点。

[http://www.codesector.com/teracopy.php](http://www.codesector.com/teracopy.php)

或者，如果在 *nix 上，请尝试 cutftp。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-23T14:23:53.743

如果你问我，它只是使用最整洁的系统软件进行复制的最佳方式。

就像：

```
cp -pvr /pathtoolddir /pathtonewdir 
```

在 linux 机器上会做得很好。两者之间的任何压缩只会减慢该过程。

# vb.net - 在 Visual Basic.Net 中点击 URL（我不需要响应）的最佳方式

> ID：388956
> 
> 赞同：3
> 
> 时间：2008-12-23T14:20:45.620
> 
> 标签：vb.net

我基本上是在发送一个 URL 来控制 IP 摄像机的倾斜和平移，所以我需要做的就是发送请求，我不担心收到任何东西。目前我正在使用：

```
Dim Request As HttpWebRequest = WebRequest.Create("http://xxx.xxx.xxx.xxx/nphControlCamera?Direction=TiltDown&Resolution=320x240&Quality=Standard&RPeriod=0&Size=STD&PresetOperation=Move&Language=3")
Dim Response As HttpWebResponse = Request.GetResponse 
```

我的问题是，如果我击中它两到三遍，它就会锁定我的程序。那么我做错了什么，或者发送此 URL 的最佳方式是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T14:27:01.363

您可能会更幸运地异步调用它，并阻止用户再次发送请求，直到相机自行定位？

基本上你会使用 BeginGetResponse 而不是 GetResponse。

这可能有用： [如何在 VB.NET 中调用异步 Web 请求？](https://stackoverflow.com/questions/128282/how-do-you-call-an-asynchronous-web-request-in-vbnet)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T14:27:01.113

您是否从相机返回任何响应？似乎您的程序正在等待响应而一无所获。

# asp.net - 为什么 VS 2008 SP1 不允许我编辑 global.asax？

> ID：388971
> 
> 赞同：3
> 
> 时间：2008-12-23T14:23:33.243
> 
> 标签：asp.net, visual-studio-2008, global-asax

通常我创建 Web 应用程序项目并使用代码隐藏，但我需要使用内联代码创建一个小型一次性演示应用程序。

我在应用程序中添加了一个 global.asax 文件，但出于某种奇怪的原因，Visual Studio 2008 SP1 不允许我编辑脚本标记之间的任何代码，即向事件处理程序添加代码，`Application_Start`例如`Session_Start`. 然而，VS 确实让我在脚本标签之外进行编辑。

这只是一个使用内置 Web 服务器的简单的基于文件的 Web 应用程序。

有什么想法吗？

这是内联代码 global.asax VS 创建：

```
<%@ Application Language="C#" %>

<script runat="server">
    void Application_Start(object sender, EventArgs e) 
    {
        // Code that runs on application startup
    }

    void Application_End(object sender, EventArgs e) 
    {
        //  Code that runs on application shutdown
    }

    void Application_Error(object sender, EventArgs e) 
    { 
        // Code that runs when an unhandled error occurs
    }

    void Session_Start(object sender, EventArgs e) 
    {
        // Code that runs when a new session is started
    }

    void Session_End(object sender, EventArgs e) 
    {
        // Code that runs when a session ends. 
        // Note: The Session_End event is raised only when 
        // the sessionstate mode
        // is set to InProc in the Web.config file. 
        // If session mode is set to StateServer 
        // or SQLServer, the event is not raised.
    }
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T14:40:52.303

好的，所以这是答案：

[您可以在此处](http://support.microsoft.com/default.aspx/kb/937095)和[此处](http://www.dotnetjunkies.com/WebLog/davetrux/archive/2008/02/06/433008.aspx)查看部分说明。

基本上 global.asax 文件实际上并没有被编译，因此 VS2008 进行了修复以防止您对其进行修改，因为您的修改将无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T14:33:09.120

我认为 VS 不允许在 Global.asax 中使用内联脚本。您需要将代码放在 Global.asax.cs 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T14:30:38.033

我唯一一次看到这种事情是在我处于调试模式时，我没有意识到。看起来很基本，但你检查过吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T14:35:45.090

尝试右键单击-> 查看代码？

# javascript - 在灯箱中播放 Flash 电影

> ID：388976
> 
> 赞同：4
> 
> 时间：2008-12-23T14:25:49.387
> 
> 标签：javascript, jquery, flash, prototype, lightbox

我正在开发的这个 Web 应用程序中使用 JQuery 和 Prototype。我正在寻找一种使用 Lokesh Dhakar 的 Lightbox v2.04 播放 Flash 电影的方法。如果使用 Lightbox v2.04 无法实现，那么我可以通过 jquery 和/或 Prototype 完成阴影覆盖 Flash 视频弹出窗口的其他方式吗？我设置在 v2.04 上的原因是因为我已经将它用作图片库。如果有帮助，我正在使用 flv 类型的 flash 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-28T23:53:24.260

另一种选择是使用 JQuery 的[Thickbox 插件](http://jquery.com/demo/thickbox/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T15:18:12.773

我以前使用[LightWindow](http://www.stickmanlabs.com/lightwindow/)显示任意 HTML，但我的经验表明 flash 和 LightWindow 不能很好地混合。

我们在后台有一个 FLV 播放器（不是在 LightWindow 中），LightWindow 在某些浏览器中会导致闪烁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-11T17:09:15.543

三种支持 swf 和 flv 格式的商业免费灯箱方法是[PrettyPhoto](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/)、TopUp 和 Bumpbox。 [这](http://planetozh.com/projects/lightbox-clones/)是其他选项的列表。抱歉，作为新用户，我只能提供两个超链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-02T07:30:15.347

[Highslide](http://www.highslide.com)、[Prettyphoto](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone)和 multibox 最适合这个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T14:37:28.800

查看[Lightbox Gone Wild](http://particletree.com/features/lightbox-gone-wild/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-24T00:37:52.223

我使用 lightwindow 2.0 成功地为 www.brainclippings.com 的投资组合部分显示了 Flash 电影。

b

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T11:29:52.377

FlashInLightbox 用于在灯箱中显示闪光灯
[http://code.google.com/p/flashinlightbox/](http://code.google.com/p/flashinlightbox/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T16:18:55.820

[PrettyPhoto](http://www.no-margin-for-errors.com/projects/prettyPhoto/)是一个很棒的 jQuery 插件，它同时支持 flash 和图片库。请注意，在我写这篇文章的时候，版本 2.2.5 不支持 flash，但仍然可以下载 vesion 2.2.2，它支持 flash。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-05-10T17:08:54.227

我遇到了同样的问题并选择了[multibox](http://phatfusion.net/multibox/)。

除了图像和 flvs，它还适用于 wmvs、quicktime、realmedia 和 mp3。

文档很少，但足以让您快速集成。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-11-03T00:09:51.350

我将投票给[fancybox](http://fancybox.net/)。我已经将它用于许多项目，并且它踢了一些严重的$$。

# mysql - MySQL 5.0 索引 - 唯一与非唯一

> ID：388982
> 
> 赞同：62
> 
> 时间：2008-12-23T14:27:27.493
> 
> 标签：mysql, indexing

MySQL唯一索引和非唯一索引在性能方面有什么区别？

假设我想在 2 列的组合上创建索引，并且组合是唯一的，但我创建了一个非唯一索引。这会对 MySQL 使用的性能或内存产生重大影响吗？

*同样的问题，主*键和*唯一*索引之间有区别吗？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2008-12-23T19:25:31.543

UNIQUE 和 PRIMARY KEY 是*约束*，而不是索引。尽管大多数数据库通过使用索引来实现这些约束。除了索引之外，约束的额外开销是微不足道的，特别是当您计算跟踪和纠正意外重复（而不是如果）发生时的成本时。

如果您有较高的*选择性*，索引通常会更有效。这是不同值的数量与总行数的比率。

例如，在社会安全号码的列中，您可能有 100 万行具有 100 万个不同的值。所以选择性是 1000000/1000000 = 1.0（尽管历史上很少有例外，但 SSN 的目的是唯一的）。

但该表中的另一列“性别”可能只有两个不同的值，超过 100 万行。2/1000000 = 非常低的选择性。

具有 UNIQUE 或 PRIMARY KEY 约束的索引保证具有 1.0 的选择性，因此它将始终与索引一样有效。

您询问了主键和唯一约束之间的区别。主要是每个表只能有一个主键约束（即使该约束的定义包括多个列），而您可以有多个唯一约束。具有唯一约束的列可能允许 NULL，而主键约束中的列不得允许 NULL。否则，主键和唯一键的实现和使用非常相似。

您在评论中询问是否使用 MyISAM 或 InnoDB。在 MySQL 中，他们使用术语*存储引擎*。这两个存储引擎之间存在许多细微的差异，但主要的差异是：

*   InnoDB 支持事务，因此您可以选择回滚或提交更改。MyISAM 实际上总是自动提交。
*   InnoDB 强制执行外键约束。MyISAM 不强制甚至不存储外键约束。

如果这些功能是您在应用程序中需要的东西，那么您应该使用 InnoDB。

* * *

回复你的评论，没那么简单。在很多情况下，InnoDB 实际上比 MyISAM 快，所以它取决于您的应用程序的选择、更新、并发查询、索引、缓冲区配置等的组合。

有关存储引擎的非常彻底的性能比较，请参阅[http://www.mysqlperformanceblog.com/2007/01/08/innodb-vs-myisam-vs-falcon-benchmarks-part-1/](http://www.mysqlperformanceblog.com/2007/01/08/innodb-vs-myisam-vs-falcon-benchmarks-part-1/)。InnoDB 频繁地战胜了 MyISAM，显然不可能说一个比另一个快。

与大多数与性能相关的问题一样，*为您的应用程序*回答它的唯一方法是使用您的应用程序和代表性数据样本测试这两种配置，并测量结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T14:33:57.683

在恰好是唯一的非唯一索引和唯一索引上？我不确定，但我猜不会很多。优化器应该检查索引的基数并使用它（对于唯一索引，它始终是行数）。

就主键而言，可能很多，但这取决于您使用的引擎。

InnoDB 引擎（被许多人使用）总是将行聚集在主键上。这意味着 PK 本质上是与实际行数据相结合的。如果您通过 PK（或者实际上，范围扫描等）进行大量查找，这是一件好事，因为这意味着它不需要从磁盘中获取尽可能多的块。

非 PK 唯一索引永远不会聚集在 InnoDB 中。

另一方面，其他一些引擎（尤其是 MyISAM）不会对 PK 进行聚类，因此主键就像一个普通的唯一索引。

# sql - 是否可以在 sql 数据库级别防止批量更新？

> ID：388985
> 
> 赞同：1
> 
> 时间：2008-12-23T14:28:46.150
> 
> 标签：sql, sql-server, database, security

一个简单的愚蠢的“ `UPDATE table SET something=another WHERE (always true)`”意外将很容易破坏数据库中的所有内容。这可能是人为错误、SQL 注入/溢出/截断攻击，或构建 WHERE 原因的代码中的错误。

流行的数据库是否提供了通过限制可以在一个 SQL 语句中更新的最大行数来保护表的功能？

我的意思是某种适用于数据库前表访问权限的防御性设置：无法绕过，更少的编程代码，没有人为错误（除非授予自己太多的访问权限）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T14:34:13.440

您可以添加一个触发器来检查正在更新的行数（计算 Inserted 魔术触发器表），如果行数过多，则添加 RAISEERROR。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T14:32:42.867

我什么都不知道。

我不确定这是否能解决任何问题。数据库如何区分 SQL 注入攻击和碰巧超出限制的夜间批量更新？

一个假设是自动提交设置为真。如果 SQL 注入攻击没有被提交，你总是有机会回滚它，假设你正在查看日志等。

我认为真正的答案是更好地分层应用程序、验证、绑定等。如果这些措施到位，你就不能进行 SQL 注入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T16:06:10.150

最简洁的答案是不”...

Oracle 允许您设置可分配给用户的定义[配置文件，以限制 CPU、逻辑读取等资源的使用。](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_6010.htm#i2065930)但是，它不是为您的目的而设计的，它更多地是关于在多用户环境中管理资源。

也许更重要的是，它还具有[闪回表](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_9012.htm#i2172752)，因此可以轻松撤消意外更改。

您的大多数情况应通过其他方式处理：

*   人为错误：不应授予大多数用户对表的更新权限，他们应该被迫调用 API（通常通过应用程序）来执行更新。DBA 在访问实时数据库时必须非常小心——别管行限制，他们可以**完全删除表**！
*   注入攻击：这些可以而且应该防止发生
*   代码错误：这些应该通过适当的测试来发现

如果您的数据很重要，则应按上述方式对其进行适当的保护和照顾，并且不需要最大行更新限制；如果您的数据不够重要，无法按上述方式进行保护，那何必担心呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T16:33:24.620

正如 David B 首先指出的那样，您可以使用触发器来执行此操作。无论如何，使用@@ROWCOUNT 测试启动触发器是一个好习惯。所以想象一下：

```
CREATE TRIGGER dbo.trg_myTrigger_UD ON dbo.myTable FOR UPDATE, DELETE
AS
IF @@ROWCOUNT <> 1 RETURN 
```

这将排除任何试图影响不止一行的更新和/或删除。

作为一般规则，我从 <> 0 的行数测试开始我的。关键是如果触发器是由实际上不影响行的东西启动的（UPDATE table SET col1 = 'hey' WHERE 1 = 0），那么就没有指向运行触发代码，因为它无论如何都不会做任何事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T14:43:15.793

我理解你的理由，但你想如何处理合法的批次？

如果您手动进行了一些更改，并且希望能够“撤消”更改，请使用事务。如果您希望能够重建数据，请使用更改存档。但是您不能仅从具有 100% 正确结果的批次中创建“这是正确/不正确批次”的检查。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T14:57:25.907

您只需要编写存储过程并且只向用户公开这些过程。在正常情况下，您不会在特权帐户中工作。仅在需要时以管理员身份连接。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-23T14:32:46.923

您可以将更新包装在事务中并在提交之前提示用户（让他们知道要更新多少行）。

# javascript - Javascript 的正则表达式只允许字母数字

> ID：388996
> 
> 赞同：297
> 
> 时间：2008-12-23T14:32:10.247
> 
> 标签：javascript, regex

我需要找到一个只允许字母数字的 reg ex。到目前为止，我尝试的每个人都只适用于字符串是字母数字的，意思是同时包含字母和数字。我只想要一个既允许又不需要两者的东西。

* * *

## 回答 #1

> 赞同：605
> 
> 时间：2008-12-23T14:41:29.773

```
/^[a-z0-9]+$/i

^         Start of string
[a-z0-9]  a or b or c or ... z or 0 or 1 or ... 9
+         one or more times (change to * to allow empty string)
$         end of string    
/i        case-insensitive 
```

**更新（支持通用字符）**

如果您需要此正则表达式支持通用字符，您可以[在此处找到 unicode 字符列表。](https://en.wikipedia.org/wiki/List_of_Unicode_characters)

例如：`/^([a-zA-Z0-9\u0600-\u06FF\u0660-\u0669\u06F0-\u06F9 _.-]+)$/`

这将支持波斯语。

* * *

## 回答 #2

> 赞同：182
> 
> 时间：2011-03-07T00:52:49.297

如果您想返回替换的结果，那么这将起作用：

```
var a = 'Test123*** TEST';
var b = a.replace(/[^a-z0-9]/gi,'');
console.log(b); 
```

这将返回：

```
Test123TEST 
```

请注意，gi 是必要的，因为它意味着全局（不仅仅是在第一个匹配项上），并且不区分大小写，这就是我使用 az 而不是 a-zA-Z 的原因。括号内的 ^ 表示“不在这些括号内的任何内容”。

警告：如果这正是您想要的，那么字母数字非常好。但是，如果您在国际市场上使用它，例如一个人的姓名或地理区域，那么您需要考虑 unicode 字符，这是不会做的。例如，如果你有一个像“Âlvarö”这样的名字，它会变成“lvar”。

* * *

## 回答 #3

> 赞同：99
> 
> 时间：2008-12-23T15:05:39.493

使用单词字符类。以下等价于 a `^[a-zA-Z0-9_]+$`：

```
^\w+$ 
```

解释：

*   ^ 字符串开头
*   \w 任何单词字符（AZ、az、0-9、_）。
*   $ 字符串结尾

`/[^\w]|_/g`如果您不想匹配下划线，请使用。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2011-08-29T03:16:40.910

```
/^([a-zA-Z0-9 _-]+)$/ 
```

上面的正则表达式允许字符串中的空格并限制特殊字符。它只允许 az、AZ、0-9、空格、下划线和破折号。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-12-23T14:35:47.273

```
^\s*([0-9a-zA-Z]*)\s*$ 
```

或者，如果您想要至少一个字符：

```
^\s*([0-9a-zA-Z]+)\s*$ 
```

方括号表示一组字符。^ 是输入的开始。$ 是输入的结尾（或换行符，取决于您的选择）。\s 是空格。

前后的空格是可选的。

括号是分组运算符，允许您提取所需的信息。

编辑：删除了我对 \w 字符集的错误使用。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-07-01T07:22:31.183

这将起作用

```
^(?=.*[a-zA-Z])(?=.*[0-9])[a-zA-Z0-9]+$ 
```

它只接受字母数字字符：
**已通过测试用例：**

```
dGgs1s23 - valid
12fUgdf  - valid,
121232   - invalid, 
abchfe   - invalid,
 abd()*  - invalid, 
42232^5$ - invalid 
```

**或者**

你也可以试试这个。此表达式至少满足一个数字和一个字符且不满足其他特殊字符

```
^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$ 
```

角度可以测试如下：

```
$scope.str = '12fUgdf';
var pattern = new RegExp('^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$');
$scope.testResult = pattern.test($scope.str); 
```

**[柱塞演示](http://plnkr.co/edit/GNOD9w3uNTZVExzqIjvx?p=preview)**

参考：[Angularjs中字母数字的正则表达式](https://stackoverflow.com/questions/38138189/regular-expression-for-alphanumeric-in-angularjs/38139319#38139319)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-10-18T21:29:32.873

您可以通过检查字符串中的任何无效字符来间接实现此目的，而不是检查有效的字母数字字符串。通过检查与有效字母数字字符串的*补码*匹配的任何内容来执行此操作。

```
/[^a-z\d]/i 
```

这是一个例子：

```
var alphanumeric = "someStringHere";
var myRegEx  = /[^a-z\d]/i;
var isValid = !(myRegEx.test(alphanumeric)); 
```

注意逻辑非运算符 at `isValid`，因为我正在测试字符串是否为假，而不是它是否有效。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2021-03-23T14:48:19.223

对于多语言支持：

```
var filtered = 'Hello Привет 你好 123_456'.match(/[\p{L}\p{N}\s]/gu).join('')
console.log(filtered) // --> "Hello Привет 你好 123456" 
```

这匹配大多数语言中的任何字母、数字或空格。

*   [...] -> 匹配条件
*   [ab] -> 匹配“a”或“b”
*   \p{L} -> 匹配任何语言的任何字母
*   \p{N} -> 匹配任何语言的任何数字
*   \s -> 匹配一个空格
*   /g -> 第一场比赛后不要停止
*   /u -> 支持 unicode 模式匹配

参考：[https ://javascript.info/regexp-unicode](https://javascript.info/regexp-unicode)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2020-02-15T12:35:39.107

我有类似于**三星 Galaxy A10s 6.2-Inch (2GB,32GB ROM) Android 9.0, (13MP+2MP)+ 8MP Dual SIM 4000mAh 4G LTE Smartphone - Black (BF19) 的字符串**

以下是我所做的：

```
string.replace(/[^a-zA-Z0-9 ,._-]/g, '').split(',').join('-').split(' ').join('-').toLowerCase() 
```

请注意，我允许`,._-`然后分别使用`split()`and`join()`替换`,`to`-`和 space to `-`。

我最终得到了这样的东西： `samsung-galaxy-a10s-6.2-inch-2gb-32gb-rom-android-9.0-13mp-2mp-8mp-dual-sim-4000mah-4g-lte-smartphone-black-bf19-20`这就是我想要的。

可能有更好的解决方案，但这就是我发现对我来说很好的解决方案。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-01-28T18:27:07.747

扩展字符串原型以在整个项目中使用

```
 String.prototype.alphaNumeric = function() {
        return this.replace(/[^a-z0-9]/gi,'');
    } 
```

用法：

```
 "I don't know what to say?".alphaNumeric();
    //Idontknowwhattosay 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-01-05T17:39:01.493

似乎许多用户已经注意到，除非我们严格使用英语，否则这些正则表达式几乎肯定会失败。但我认为有一个简单的前进方式，不会受到如此限制。

1.  以全部大写形式复制您的字符串
2.  以小写形式制作第二份副本

在这些字符串中匹配的任何字符本质上绝对不是字母。

```
let copy1 = originalString.toUpperCase();
let copy2 = originalString.toLowerCase();
for(let i=0; i<originalString.length; i++) {
    let bIsAlphabetic = (copy1[i] != copy2[i]);
} 
```

或者，您还可以通过仅查找数字 0 到 9 来检测数字。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-07-16T06:10:53.100

将这些代码输入到您的 SCRATCHPAD 并查看操作。

```
var str=String("Blah-Blah1_2,oo0.01&zz%kick").replace(/[^\w-]/ig, ''); 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-07-28T12:44:42.293

**JAVASCRIPT 仅接受数字、字母和特殊字符**

```
document.getElementById("onlynumbers").onkeypress = function (e) {
	onlyNumbers(e.key, e)
};

document.getElementById("onlyalpha").onkeypress = function (e) {
	onlyAlpha(e.key, e)
};

document.getElementById("speclchar").onkeypress = function (e) {
	speclChar(e.key, e)
};

function onlyNumbers(key, e) {
	var letters = /^[0-9]/g; //g means global
	if (!(key).match(letters)) e.preventDefault();
}

function onlyAlpha(key, e) {
	var letters = /^[a-z]/gi; //i means ignorecase
	if (!(key).match(letters)) e.preventDefault();
}

function speclChar(key, e) {
	var letters = /^[0-9a-z]/gi;
	if ((key).match(letters)) e.preventDefault();
}
```

```
<html>
   <head></head>
   <body>
      Enter Only Numbers: 
      <input id="onlynumbers" type="text">
      <br><br>
      Enter Only Alphabets: 
      <input id="onlyalpha" type="text" >
      <br><br>
      Enter other than Alphabets and numbers like special characters: 
      <input id="speclchar" type="text" >
   </body>
</html>
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-03-12T18:05:17.350

甚至比`Gayan Dissanayake`指出的要好。

```
/^[-\w\s]+$/ 
```

现在`^[a-zA-Z0-9]+$`可以表示为`^\w+$`

> 您可能想要使用**\s**而不是空格。请注意，**\s**负责处理空格，而不仅仅是一个空格字符。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-02-08T04:56:40.887

试试这个......用#name替换你的字段ID...... az（a到z），AZ（A到Z），0-9（0到9）

```
jQuery(document).ready(function($){
    $('#name').keypress(function (e) {
        var regex = new RegExp("^[a-zA-Z0-9\s]+$");
        var str = String.fromCharCode(!e.charCode ? e.which : e.charCode);
        if (regex.test(str)) {
            return true;
        }
        e.preventDefault();
        return false;
    });
}); 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-05-01T14:06:44.050

保存这个常量

```
const letters = /^[a-zA-Z0-9]+$/ 
```

现在，检查零件使用 .match()

```
const string = 'Hey there...' // get string from a keyup listner
let id = ''
// iterate through each letters
for (var i = 0; i < string.length; i++) {
  if (string[i].match(letters) ) {
    id += string[i]
  } else {
    // In case you want to replace with something else
    id += '-'  
  }
}
return id 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-11-20T19:55:28.780

区分大小写的字母数字：

```
if (/^[a-zA-Z0-9]+$/.test("SoS007")) {
  alert("match")
} 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2021-02-18T19:59:28.470

有点晚了，但这对我有用：

```
/[^a-z A-Z 0-9]+/g 
```

az ：从 a 到 z 的任何内容。

AZ ：从 A 到 Z 的任何内容（大写）。

0-9 ：从 0 到 9 的任意数字。

它将允许方括号内的任何内容，因此假设您要允许任何其他字符，例如“/”和“#”，正则表达式将是这样的：

```
/[^a-z A-Z 0-9 / #]+/g 
```

该站点将帮助您在编码之前测试您的正则表达式。 [https://regex101.com/](https://regex101.com/)

随意修改并将您想要的任何内容添加到括号中。问候 ：）

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-04-29T10:00:45.297

此外，如果您只查找字母字符，您可以使用以下正则表达式：

```
/[^a-zA-Z]/gi 
```

**打字稿中的示例代码：**

```
let samplestring = "!#!&34!# Alphabet !!535!!! is safe"

let regex = new RegExp(/[^a-zA-Z]/gi);
    let res = samplestring.replace(regex,'');

    console.log(res); 
```

注意：如果您对 RegEx 语法感到好奇，请访问[regexr](https://regexr.com/)并使用备忘单或使用正则表达式。

编辑：字母数字->字母

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-07-26T20:26:00.927

**Jquery 只接受数字、字母和特殊字符**

```
<html>
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
Enter Only Numbers: 
<input type="text" id="onlynumbers">
<br><br>
Enter Only Alphabets: 
<input type="text" id="onlyalpha">
<br><br>
Enter other than Alphabets and numbers like special characters: 
<input type="text" id="speclchar">

<script>
    $('#onlynumbers').keypress(function(e) {
      var letters=/^[0-9]/g; //g means global
      if(!(e.key).match(letters)) e.preventDefault();
	});

    $('#onlyalpha').keypress(function(e) {
      var letters=/^[a-z]/gi; //i means ignorecase
      if(!(e.key).match(letters)) e.preventDefault();
	});

    $('#speclchar').keypress(function(e) {
      var letters=/^[0-9a-z]/gi; 
      if((e.key).match(letters)) e.preventDefault();
	});
    </script>
</body>
</html>
```

```
**JQUERY to accept only NUMBERS , ALPHABETS and SPECIAL CHARACTERS **

<!DOCTYPE html>
    $('#onlynumbers').keypress(function(e) {
      var letters=/^[0-9]/g; //g means global
      if(!(e.key).match(letters)) e.preventDefault();
    });

    $('#onlyalpha').keypress(function(e) {
      var letters=/^[a-z]/gi; //i means ignorecase
      if(!(e.key).match(letters)) e.preventDefault();
    });

    $('#speclchar').keypress(function(e) {
      var letters=/^[0-9a-z]/gi; 
      if((e.key).match(letters)) e.preventDefault();
    }); 
```

```
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"> 
```

仅输入数字：

仅输入字母：

输入除字母和数字以外的特殊字符：

```
</body>
</html> 
```***********