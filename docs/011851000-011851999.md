# StackOverflow 问答 11851000-11851999

# java - 使用 EasyMock 和 PowerMock 捕获私有方法参数

> ID：11851004
> 
> 赞同：2
> 
> 时间：2012-08-07T17:23:25.477
> 
> 标签：java, capture, easymock, powermock, private-methods

对于公共方法调用，EasyMock 的 capture() 允许您拦截和检查传递给方法的参数。对于私有方法调用，PowerMock 的 expectPrivate 允许您模拟私有方法调用。

有没有办法以某种方式组合这些并将参数传递给私有方法调用？例子：

```
public class Program
{
    public FancyReturnType PublicMethod()
    {
        ArbitraryType localInstance = new ArbitraryType();
        localInstance.setFoo(somePrivateHelperMethod());
        localInstance.setBar(increasinglyComplexMagic());

        long aLongValue  = 11235L;
        // more variables, more work

        SomeType worker = privateHelperToIntercept(localInstance, aLongValue, otherVariables);

        if (worker.something)
        {
            return retVal.aFancyReturnType;
        }
        else
        {
            return retVal.anotherFancyReturnType;
        }
    }
} 
```

在这种情况下，我想检查调用`localInstance`消耗的对象`privateHelperToIntercept()`。

我找到了很多模拟私有方法调用的例子；PowerMock 的`expectPrivate(partiallyMockedObject, "nameOfPrivateMethod", arg1, arg2)`效果很好。我还找到了拦截​​传递给公共方法调用的参数的示例；`Capture<Type> myTestCapture = new Capture<Type>()`结合`someMockedObject.PublicMethod(capture(myTestCapture))`.

不幸的是，我既不能让两者一起工作，也不能找到将它们结合起来的例子。有没有人看到这样做的方法？

FWIW，我怀疑 Mockito 可以做到这一点，但它不包含在我们的源/构建/测试系统中。如果可能，我想避免在我们的系统中支持新库的过程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:08:29.440

如果您询问如何获取对 localInstance 的引用，那么以下代码就足够了。

```
@PrepareForTest(Program.class)
public class Test {
    @Test
    public void testMethod() {
        ArbitraryType passedLocalInstance = new ArbitraryType();
        PowerMock.expectNew(ArbitraryType.class).andReturn(passedLocalInstance );

        //remainder of the test method

        assertEquals(14.2, passedLocalInstance .getValue());
    }
} 
```

由于 java 是按引用传递的，passedLocalInstance 将是传递给方法调用的参数。这回答了你的问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T20:52:36.090

`new`任何类型的只是一个静态方法。以同样的方式处理它......将它包装在一个方法中，存根该方法。在这种情况下，您想在测试中返回一个模拟，然后您可以测试与该对象的所有交互（并在您的测试中删除对您正在创建的对象中的代码的依赖，该对象应该有自己的测试）

```
public Program {

    // your above code up to object creation
    ArbitraryType localInstance = createArbitraryType();
    // rest of your above code here

  ArbitraryType createArbitraryType() {
    return new ArbitraryType();
  }
} 
```

在你的测试中...

```
public class MyTest {
  TestableProgram extends Program {
    @Override 
    ArbitraryType createArbitraryType() {
      return this.arbitraryTypeMock; 
    }
  }

  private ArbitraryType arbitraryTypeMock;
  private TestableMyClass objectToTest = new TestableProgram();

  // rest of your tests...

} 
```

鉴于您的限制，我就是这样做的。

如果可以稍微改变您的约束，我会放松私有方法，我通常会取消私有方法，转而使用包默认值以使测试更容易。如果您包中的人行为不端，通常是您的代码如此私密，无论如何主要是保护您免受自己的伤害。（但我知道这不是您提出的问题的有效答案......）。

# haskell - 为什么 numCapabilities 是一个纯函数？

> ID：11851005
> 
> 赞同：21
> 
> 时间：2012-08-07T17:23:25.763
> 
> 标签：haskell, standard-library

在并发库 GHC.Conc 中有一个名为[`numCapabilities`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/GHC-Conc.html#v%3anumCapabilities). 它的类型是`numCapabilities :: Int`并且它实际上返回您通过命令行标志传递的一些数字（例如`5`，如果选项是`+RTS -N 5`）。

但是，[`getArgs`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-Environment.html#v%3agetArgs)(type: `IO [String]`) 本质上是相同的（它返回未解析的非运行时参数），但不是纯函数。

如果唯一的借口是`numCapabilities`纯代码中经常需要它，那么纯代码中不需要其他命令行选项的方式是*什么*？

我是否缺少某些东西，或者是`numCapabilities`设计缺陷还是允许我编写以下怪物？

```
myGetArgs = unsafePerformIO getArgs 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-07T17:34:21.383

对于在这种情况下该怎么做，我看到了非常不同的看法。有些人认为**编译**之间可能不同的值不应该是纯粹的，有些人认为只要在程序的本地运行时（即在某些“配置”中“设置”后`main`）没有改变，它应该是纯净的。

该`base`包裹似乎已处于中间立场。`numCapabilities` *不会*（据我所知）在运行时更改，但`getArgs` *可能*.

这是因为有一个[`withArgs`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-Environment.html#v:withArgs)函数可以更改您通过`getArgs`. 所以，这就回答了。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-17T09:18:16.570

哦，*亲爱*的。如果您查看 的定义`numCapabilities`，您会发现它只是：

```
numCapabilities :: Int
numCapabilities = unsafePerformIO $ getNumCapabilities 
```

以下 ghci 会话说明了这个问题：

```
[ben@euler ~]$ ghci
GHCi, version 7.4.2: http://www.haskell.org/ghc/  :? for help
Loading [...]
ghci> :m +GHC.Conc
ghci> numCapabilities
1
ghci> setNumCapabilities 2
ghci> numCapabilities
1
ghci> :q
Leaving GHCi.

[ben@euler ~]$ ghci
GHCi, version 7.4.2: http://www.haskell.org/ghc/  :? for help
Loading [...]
ghci> :m +GHC.Conc
ghci> setNumCapabilities 2
ghci> numCapabilities
2 
```

这*绝对*是不好的 - 的值`numCapabilities`取决于何时对`setNumCapabilities`程序中可能存在的任何调用进行评估。请注意，在第一个会话中，`numCapabilities`保持一致，因为`IO`仅在第一次评估时才执行。但是，在存在内联的情况下（名称未标记为 NOINLINE 或其他任何内容），即使这可能不是真的 - 原则上您可以从两次出现中获得两个不同的值`numCapabilities`（尽管实际上我无法做到这一点发生）。

所以答案是它`numCapabilities` *不是*一个纯函数，而是被臭名昭著的`unsafePerformIO`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-17T04:23:38.533

我会说这是一个错误，但这取决于一个人认为纯度是什么。请参阅[*Haskell 中的纯度概念*](http://conal.net/blog/posts/notions-of-purity-in-haskell/)及其讨论。简单地说，帖子的论点是类型是有意义的，并且`Int`对于类似的东西的含义没有空间`numCapabilities`，这是依赖于执行上下文的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-28T11:24:56.687

[`numCapabilities`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Conc.html#v%3anumCapabilities)给出 的初始值`getNumCapabilities`，无论是否存在 RTS -N 标志参数，因此类型应该相同。

您是否尝试过比计算机最大数量更高的数字。同时线程？

```
$ ghci +RTS -N99
GHCi, version 7.4.2: http://www.haskell.org/ghc/  :? for help
Prelude> :m +GHC.Conc
Prelude GHC.Conc> numCapabilities
99
Prelude GHC.Conc> getNumCapabilities
99   !!! 
```

# php - PHP文本到图像

> ID：11851006
> 
> 赞同：0
> 
> 时间：2012-08-07T17:23:27.340
> 
> 标签：php, gdlib

我在 PHP/GD 中将文本写入图像模板得到了很好的结果，文本换行很好但不是“平滑”，这是我正在使用的代码：

```
<?php

header("Content-type: image/png");

$text = "go to school go to school go to school go to school go to school go to school go to school go to school go to school go to school go to school ";
$arrText=explode("\n",wordwrap($text,60,"\n"));

$im = imagecreatefrompng("template.png");
$y = 15; //vertical position of text
foreach($arrText as $arr)
{
    $white = imagecolorallocate($im,0,0,0); //sets text color
    imagestring($im,5,15,$y,trim($arr),$white); //create the text string for image,added     trim() to remove unwanted chars
    $y = $y+20;

}
imagepng($im);
imagedestroy($im);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:55:27.217

请试试这个： -

记住：为字体设置正确的路径 $font = 'arial.ttf';

```
 header('Content-type: image/png');

    // Create the image
    $im = imagecreatetruecolor(400, 30);

    // Create some colors
    $white = imagecolorallocate($im, 255, 255, 255);
    $grey = imagecolorallocate($im, 128, 128, 128);
    $black = imagecolorallocate($im, 0, 0, 0);
    imagefilledrectangle($im, 0, 0, 399, 29, $white);

    // The text to draw
    $text = 'go to school go to school go to school go to school go to school go to school go to school go to school go to school go to school go to school';

   // Replace path by your own font path
    $font = 'arial.ttf';

    // Add some shadow to the text
    imagettftext($im, 20, 0, 11, 21, $grey, $font, $text);

    // Add the text
    imagettftext($im, 20, 0, 10, 20, $black, $font, $text);

    // Using imagepng() results in clearer text compared with imagejpeg()
    imagepng($im);
    imagedestroy($im); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:40:35.160

尝试打开抗锯齿：

```
imageantialias($im, true); 
```

这会让它看起来更好吗？

或者尝试使用 truetype 字体的 imagettftext：

```
imagettftext ( $im, 15, 0, 15, $y, $white, 'fontfile.ttf', trim($arr)); 
```

# vim - 为什么 vim 会认为 $HOME 是 U:\ 驱动器？

> ID：11851007
> 
> 赞同：3
> 
> 时间：2012-08-07T17:23:29.227
> 
> 标签：vim, windows-7

当我运行`echo $HOME` `gvim`报告`$HOME`时`U:\`，当我退出时，它会尝试写入驱动器，但它不能，因为...我没有 U: 驱动器。我得到错误`Can't write viminfo file U:\_viminfo`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-25T07:06:58.527

这里同样的问题。

我办公室的 Windows 网络策略自动映射到 Z: 驱动器的共享网络，并将其添加为 homedrive。映射在命令行中正常工作，一些应用程序使用它没有问题。其他人没有。

后来我发现那些有问题的应用程序是那些以管理员权限运行的应用程序。看起来驱动器映射取决于用户。以普通用户身份运行 Vim 解决了这个问题。

# html - 将 CSS 形状附加到我的 物品？

> ID：11851011
> 
> 赞同：-1
> 
> 时间：2012-08-07T17:23:39.150
> 
> 标签：html, css

我正在尝试在合适的地方使用 css 形状而不是图像。

`<li>`目前我的目标是在我的链接末尾添加一个白色三角形，如下所示：

![在此处输入图像描述](../Images/231cbe07dbfa0e0888deb2c8d78ecf1c.png)

[这是一个 JSFiddle](http://jsfiddle.net/UDwaK/)供您调整。

我已经使用它一段时间了，但作为一个新手开发人员，我一直无法找到一种方法！导航栏的内容位于 css 和 html 的底部。我试图通过在可能的情况下使用 em 和 percent 来保持结果的响应性，实际上这个三角形的高度需要与 nav_option 类相同（如果文本被窗口调整到下一行，它的高度可以加倍）

有什么建议/解决方案吗？非常感激！

编辑：如果由于我的相对字体大小而无法做到这一点，那么请详细说明替代解决方案？建议使用 Javascript 很有帮助，但对于像我这样的新手来说有点含糊。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:14:32.003

字体大小与上升元素的字体大小相关，与父元素的宽度或高度无关。因此，要使用响应式字体大小，请尝试使用一些 jquery 插件（FitText）或构建您的 JS。

[http://fittextjs.com/](http://fittextjs.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:30:56.650

因为您正在使用边框 hack 来制作此形状，所以您需要使用的尺寸（字体大小）无法应用。您将需要一个 JavaScript 解决方案来检测换行并相应地调整边框尺寸。

# php - 如何验证上传的文件是否为视频？

> ID：11851016
> 
> 赞同：4
> 
> 时间：2012-08-07T17:23:52.723
> 
> 标签：php, php-5.3

我有一台服务器，上面有一些非常敏感的信息，所以安全性是一个大问题。用户需要能够上传视频。我知道允许用户上传文件会构成安全威胁，因为没有 100% 的方法可以阻止他们上传非视频。但我显然可以选择服务器将保留哪些文件。

我知道检查文件扩展名是不够的。检查 MIME 类型更好，但仍然可以伪造。那么我该如何检查文件是否是视频呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T17:36:53.333

玩！

唯一可以确定的方法是使用一些代码来解码相关类型的视频，看看它（并检查是否有合理的结果，比如非零持续时间）。

否则，您的风险很低：

非恶意场景：

1.  Uploader 上传视频，内容类型为 video/*。
2.  您存储八位字节和内容类型。
3.  下载器下载视频，您使用收到的内容类型。
4.  下载者观看视频（或抱怨编解码器等）

恶意场景一：

1.  Uploader 上传一个讨厌的木马，内容类型为 video/*。
2.  您存储八位字节和内容类型。
3.  下载器下载讨厌的木马，而您使用您收到的内容类型。
4.  下载器在视频播放器中打开讨厌的木马。讨厌的木马什么都不做，因为它不是视频。用户抱怨编解码器。更糟糕的情况是，他们在 ubuntu 论坛上发表关于缺乏对专有格式的支持的咆哮，在您的页面上添加关于网站如何因为视频无法正常工作而糟糕的评论等等。

恶意场景2：

1.  Uploader 上传恶意木马，该木马被写入视频，利用流行视频播放器的一些缓冲区溢出问题。
2.  你存...
3.  下载器...
4.  可能只是上述情况之一，但也可能是他们受到了攻击（如果他们正在使用受影响的玩家）。

关于场景 2 需要注意的三件事：

1.  测试它是一个视频并不能保证安全，因为它很可能在某些播放器中也能正常工作。
2.  如果漏洞在 ffmpeg 中，测试它是一个视频可能会使您的服务器容易受到攻击！
3.  这种类型的漏洞利用既罕见又难做。一般风险与上传和下载 jpeg 或 png 相同。实际上它有点小（确实存在这种类型的漏洞利用一段时间影响常用的 jpeg 库）。

总之，只要确保你只输出你接受的内容类型，并强制文件扩展名匹配它们；如果用户上传了一个名为 haha​​ha.exe 的视频/mpeg，则将其重命名为 haha​​ha.mpg

编辑：哦，还有：

恶意场景3：

Uploader 上传的视频以占用大量资源的方式利用某些播放器。在这种情况下，下载器只会 kill-9/ctrl-alt-delete/your-OSs-kill-them-all-of-choice，但是如果您的服务器正在测试它是一个视频，那么它最终可能会遇到麻烦，因为有没有人介入并杀死它试图解释的 200 个（并且随着脚本小子的脚本不断上传更多）“视频”。

仅仅进行正常的视频处理就足以引入 DoS 的能力（毕竟视频处理相对繁重），因此测试文件可能会带来更多的危险，而不是它可以为您节省的风险。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:35:15.223

您可以`ffmpeg`通过 php 扩展程序调用：

[https://github.com/char0n/ffmpeg-php/](https://github.com/char0n/ffmpeg-php/)

它基本上包装了 的输出`ffmpeg`，然后您可以在 php.ini 中检查它。但是，您应该首先熟悉[ffmpeg](http://ffmpeg.org/about.html)，这本身就是一个完整的主题。如果您不想使用该库，您可以通过[exec](http://de3.php.net/manual/en/function.exec.php)自行执行 ffmpeg 。

此外，我会检查 mimetype。您还可以通过 JS 在文件输入中检查客户端的文件（并非在所有浏览器中，这**不能替代**真正的验证）。

lg,

弗洛

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:32:02.400

用户可以安全地上传任何内容，只要它进入正确的目录并且服务器上没有任何内容尝试运行它（如果它应该是视频，则不会尝试）。除非受害者以某种方式激活恶意软件，否则它什么也做不了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T07:03:53.027

我同意，除非视频播放器存在可以通过某些损坏的视频文件加以利用的问题，否则我不会太担心。但是，出于不一定安全的原因，必须检查您拥有的文件是否是视频文件并且所有文件都有效，您可以执行以下步骤

1.  在不带参数的文件上运行 ffprobe。它将提供有关该文件的一些信息。编解码器、容器、持续时间、帧速率、比特率。
2.  现在使用 -show_packets 运行 ffprobe。它应该逐帧给出有关文件的信息。您应该获得与第一个命令给出的 duration*frame_rate 一样多的视频帧。可以检查这一点，因为有人可以只提供精心制作的标题或文件的初始部分可能是有效的视频（ffmpeg 和 ffprobe 只会测试视频的前几秒钟以验证其类型），其余部分可能已损坏。
3.  使用 -show_frames 运行 ffprobe。这将尝试解码每个帧的标头，以确保每个帧都是有效的视频帧。这是一个额外的步骤，因为某些容器只是有一个可用于 show_packets 的表。因此 ffprobe 可以简单地读取该表并且它指向的数据可能已损坏。

现在理论上，一个文件有可能对每一帧都有所有有效的标题，但数据错误，但没有解码实际内容并在播放器上查看它，这是你能做的最好的 afaik。我会说这已经足够好了，而且速度非常快。

# c# - 在 C# Visual Studio 项目中，如何配置执行时运行哪个测试？

> ID：11851017
> 
> 赞同：0
> 
> 时间：2012-08-07T17:23:54.567
> 
> 标签：c#

我在项目中有多个测试文件，我可以通过右键单击并说“运行测试”来运行特定文件。但是右键单击时上下文菜单中没有“调试”选项。如何让它出现在这里，或者如何设置在按 F5 时运行哪个测试用例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:25:48.813

使用测试菜单。测试 => 调试 => [选择选项]

您也可以打开测试工具栏，它有运行和调试按钮。

从这些菜单中，您也可以通过将光标放在方法中并使用“上下文”选项来运行单个测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:29:13.440

如果要在按F5时选择运行哪个项目，可以右键单击要默认运行的项目，选择“设置为启动项目”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:37:54.210

使用测试视图窗口（在测试=>Windows=>测试视图中）查看解决方案中的所有测试。我一直用*这个*。

如果您有大量测试并且只想在特定区域运行测试，请使用“测试视图”中的“分组依据”选项。我通常按​​班级名称或项目分组。然后，您可以轻松导航到您关心的测试。

测试视图还可以让您通过“运行选择”工具栏按钮上的下拉菜单轻松选择是否运行带有或不带有调试的测试。

如果你有条不紊，你可以用同样的方式打开测试列表编辑器。通过这种方式，您可以管理和运行特定的测试列表。（我通常觉得这一步走得太远了，而且测试列表对于源代码控制/配置管理没有一个好的故事）

# android - 检测phonegap webview何时完成加载android

> ID：11851018
> 
> 赞同：3
> 
> 时间：2012-08-07T17:23:59.390
> 
> 标签：android, cordova, android-webview

PhoneGap（更具体地说是适用于 Android 的 DroidGap）是否有办法判断其 webview 何时加载。我想为 PhoneGap 找到类似以下的内容：

**正常 WebView 客户端创建：**

```
mWebView.setWebViewClient(new WebViewClient() {

   public void onPageFinished(WebView view, String url) {
        // do your stuff here
    }
}); 
```

**像这样创建我的 PhoneGap Webview：**

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main_activity);

    if (isOnline() == true) {

         WebSettings settings = mWebView.getSettings(); 
        settings.setAllowFileAccess(true);
        settings.setAppCacheEnabled(true);
        settings.setJavaScriptEnabled(true); 

        mWebView.loadUrl("http://myurl.com");

        mWebView.setWebViewClient(new WebViewClient() {

           public void onPageFinished(WebView view, String url) {
               //hide loading image
               findViewById(R.id.imageLoading1).setVisibility(View.GONE);
               //show webview
               findViewById(R.id.mWebView).setVisibility(View.VISIBLE);
            }
        });
    }
    else {
       //hide loading image
        findViewById(R.id.imageLoading1).setVisibility(View.GONE);
        //show webview
        findViewById(R.id.mWebView).setVisibility(View.VISIBLE);

        Intent myIntent = new Intent(getContext(), LoadScreen.class);

        startActivity(myIntent);
        finish();
    } 
```

}

**我的 Main_Activity.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

     <ImageView android:id="@+id/imageLoading1"
        android:layout_height="fill_parent"
        android:layout_width="fill_parent"
        android:visibility="visible"
        android:src="@drawable/splash"
        />

      <WebView android:id="@+id/mWebView"
        android:layout_height="fill_parent"
        android:layout_width="fill_parent"
        android:visibility="gone"
        />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:32:23.617

DroidGap 没有方法，因为它是一个活动，而不是一个视图。相反，当页面完成加载时，CordovaWebViewClient 使用其 onPageFinished 方法向所有插件发送消息。这是插件可以用来确定页面是否完成的。相反，您可以在 Javascript 中检查 deviceready 事件，该事件应在页面加载后触发。

如果您需要知道 WebView 何时在 Java 中加载了插件以外的任何内容，我强烈建议您切换到使用 CordovaWebView 并自己实现生命周期事件，因为这将使您能够更好地控制增强视图。这也意味着您必须确保正确处理使用活动的插件，否则它们会损坏。

# python - 像 QTextEdit 这样的 QWidget 会自动将其高度包装到其内容中吗？

> ID：11851020
> 
> 赞同：9
> 
> 时间：2012-08-07T17:24:13.103
> 
> 标签：python, qt4, pyqt4, qtextedit

我正在创建一个带有一些 QTextEdit 小部件的表单。

QTextEdit 的默认高度超过单行文本，并且当内容的高度超过 QTextEdit 的高度时，它会创建一个滚动条来滚动内容。

我想重写此行为以创建一个 QTextEdit，它宁愿将其高度包装到其内容中。这意味着默认高度将为一行，并且在换行或输入新行时，QTextEdit 将自动增加其高度。每当内容高度超过 QTextEdit 的高度时，后者不应创建滚动条而只是增加高度。

我该怎么做呢？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T06:25:56.643

这几乎就像我前几天回答的关于使 QTextEdit 调整其高度以响应内容更改的问题：[PySide Qt：TextEdit Widget 的自动垂直增长](https://stackoverflow.com/questions/11677499/pyside-qt-auto-vertical-growth-for-textedit-widget-and-spacing-between-widgets/11764475#11764475)

我正在回答而不是标记重复，因为我怀疑您可能想要对此进行更改。如果您希望我扩展此答案，请告诉我：

另一个问题有多个部分。这是不断增长的高度小部件的摘录：

```
class Window(QtGui.QDialog):

    def __init__(self):
        super(Window, self).__init__()
        self.resize(600,400)

        self.mainLayout = QtGui.QVBoxLayout(self)
        self.mainLayout.setMargin(10)

        self.scroll = QtGui.QScrollArea()
        self.scroll.setWidgetResizable(True)
        self.scroll.setVerticalScrollBarPolicy(QtCore.Qt.ScrollBarAlwaysOn)
        self.mainLayout.addWidget(self.scroll)

        scrollContents = QtGui.QWidget()
        self.scroll.setWidget(scrollContents)

        self.textLayout = QtGui.QVBoxLayout(scrollContents)
        self.textLayout.setMargin(10)

        for _ in xrange(5):
            text = GrowingTextEdit()
            text.setMinimumHeight(50)
            self.textLayout.addWidget(text)

class GrowingTextEdit(QtGui.QTextEdit):

    def __init__(self, *args, **kwargs):
        super(GrowingTextEdit, self).__init__(*args, **kwargs)  
        self.document().contentsChanged.connect(self.sizeChange)

        self.heightMin = 0
        self.heightMax = 65000

    def sizeChange(self):
        docHeight = self.document().size().height()
        if self.heightMin <= docHeight <= self.heightMax:
            self.setMinimumHeight(docHeight) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-28T06:33:32.403

以下代码将 QTextEdit 小部件设置为内​​容的高度：

```
# using QVBoxLayout in this example
grid = QVBoxLayout()
text_edit = QTextEdit('Some content. I make this a little bit longer as I want to see the effect on a widget with more than one line.')

# read-only
text_edit.setReadOnly(True)

# no scroll bars in this example
text_edit.setVerticalScrollBarPolicy(Qt.ScrollBarAlwaysOff) 
text_edit.setHorizontalScrollBarPolicy(Qt.ScrollBarAlwaysOff) 
text_edit.setSizePolicy(QSizePolicy.Fixed, QSizePolicy.Fixed)

# you can set the width to a specific value
# text_edit.setFixedWidth(400)

# this is the trick, we nee to show the widget without making it visible.
# only then the document is created and the size calculated.

# Qt.WA_DontShowOnScreen = 103, PyQt does not have this mapping?!
text_edit.setAttribute(103)
text_edit.show()

# now that we have a document we can use it's size to set the QTextEdit's size
# also we add the margins
text_edit.setFixedHeight(text_edit.document().size().height() + text_edit.contentsMargins().top()*2)

# finally we add the QTextEdit to our layout
grid.addWidget(text_edit) 
```

我希望这有帮助。

# iphone - 访问 Plist 文件数组中的字符串值？

> ID：11851026
> 
> 赞同：-1
> 
> 时间：2012-08-07T17:24:33.987
> 
> 标签：iphone, arrays, string, plist

我的项目中有一个 Plist 文件，其中包含许多不同的数组；每个数组是一个不同的类别，然后包含针对单个问题的附加数组。我遇到的问题是访问这些数组中的节点及其值。

*我正在使用的代码：*

```
-(IBAction)nextleft {

    if (questionCounter > 1) {
        questionCounter -= 1;
    }

    [self nextQuestion];

}

-(IBAction)nextright {

    if (questionCounter < 20) {
        questionCounter += 1;
    }

    [self nextQuestion];

}

-(void)nextQuestion {

    NSArray *pair;

    pair = [categories objectAtIndex:questionCounter]; 

    plistQuestion = [pair objectAtIndex:0];
    plistAnswer = [pair objectAtIndex:1];

    abbreviation.text = plistQuestion;

} 
```

*我的类别数组是从我的 Plist 文件中用这一行填充的；*

```
categories = [NSArray arrayWithContentsOfFile:@"questions.plist"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T17:38:13.510

您可以创建一个类，其中有两个 NSString 实例（问题和答案），它们包含问题和答案的值。创建一个由该类的对象组成的类别数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:34:43.480

解决方案：

```
NSArray *categories = [NSArray arrayWithContentsOfFile:@"questions.plist"];

for (NSArray *pair in categories)
{
    NSString *q = [pair objectAtIndex:0];
    NSString *a = [pair objectAtIndex:1];

    // process q and a
} 
```

# python - Python 多处理 - 无法加入当前线程

> ID：11851031
> 
> 赞同：6
> 
> 时间：2012-08-07T17:24:46.707
> 
> 标签：python, multithreading, multiprocessing

我正在分割大型 ctype 数组并并行处理它们。我收到下面的错误并相信它，因为数组的一部分正在完成另一部分的处理。我尝试使用 process.join() 让第一组进程等待，但这不起作用。想法？

```
Exception RuntimeError: RuntimeError('cannot join current thread',) in <Finalize object, dead> ignored 
```

使用：

```
 ....

        with closing(multiprocessing.Pool(initializer=init(array))) as p:
            del array #Since the array is now stored in a shared array destroy the array ref for memory reasons

            step = y // cores
            if step != 0:
                jobs =[]
                for i in range (0, y, step):
                    process = p.Process(target=stretch, args= (shared_arr,slice(i, i+step)),kwargs=options)
                    jobs.append(process)
                    process.start()

                for j in jobs:
                    j.join()

    del jobs
    del process 
```

更新：

```
 #Create an ctypes array
        array = ArrayConvert.SharedMemArray(array)
        #Create a global of options
        init_options(options) #options is a dict
        with closing(multiprocessing.Pool(initializer=init(array))) as p:
            del array #Since the array is not stored in a shared array destroy the array ref for memory reasons

            step = y // cores
            if step != 0:
                for i in range (0, y, step):
                    #Package all the options into a global dictionary

                    p.map_async(stretch,[slice(i, i+step)])

                    #p.apply_async(stretch,args=(shared_arr,slice(i, i+step)),kwargs=options)

        p.join()        

def init_options(options_):
    global kwoptions
    kwoptions = options_ 
```

我传递给 map_async 的函数存储在不同的模块中，因此我很难将全局 kwoptions 传递给该函数。在这样的模块之间传递全局变量似乎不正确（unpythonic）。这是能够通过 map_async 传递 kwargs 的方式吗？

我应该使用不同的东西（应用或处理）重新处理多处理吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:14:31.873

所以我通过重新编写代码并删除池来完成这项工作（根据 JF Sebastian 的评论）。

在伪代码中：

```
initialize the shared array
determine step size
create an empty list of jobs
create the process, pass it the kwargs, and append it to the job list
start the jobs
join the jobs 
```

如果这对任何谷歌人有帮助，这里是代码：

```
#Initialize the ctypes array
        init(array)
        #Remove the reference to the array (to preserve memory on multiple iterations.
        del array

        step = y // cores
        jobs = []
        if step != 0:
            for i in range(0,y,step):        
                p = multiprocessing.Process(target=stretch,args= (shared_arr,slice(i, i+step)),kwargs=options)
                jobs.append(p)

            for job in jobs:
                job.start()
            for job in jobs:
                job.join() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T10:28:27.683

`initializer``Pool()`接受函数的参数；替换`initializer=init(array)`为`initializer=init, initargs=(array,)`

要将关键字参数传递给与family 一起`f()`使用的函数，`pool.*map*`您可以创建一个包装器`mp_f()`：

```
#!/usr/bin/env python
import logging
import multiprocessing as mp
from contextlib import closing

def init(shared_array_):
    # globals that should be available in worker processes should be
    # initialized here
    global shared_array
    shared_array = shared_array_

def f(interval, a=None, b=None):
    mp.get_logger().info("interval=%r, a=%r, b=%r" % (interval, a, b))
    shared_array[interval] = [a + interval.start]*b # fake computations

def mp_f(arg_kwargs):
    try:
        arg, kwargs = arg_kwargs
        return f(arg, **kwargs) # pass keyword args to f()
    except Exception:
        mp.get_logger().error("f%r failed" % (arg_kwargs,))

def main():
    mp.log_to_stderr().setLevel(logging.INFO)

    N = 10**6
    array = mp.RawArray('i', N) # create shared array

    # create workers pool; use all available CPU cores
    with closing(mp.Pool(initializer=init, initargs=(array,))) as p:
        options = dict(a=5, b=N//4) # dummy options
        step = options['b']
        args = ((slice(i, i+step), options) for i in range(0, N, step))
        for _ in p.imap_unordered(mp_f, args): # submit jobs
            pass
    p.join()
    mp.get_logger().info(array[::step])

if __name__=="__main__":
    mp.freeze_support() # for py2exe and the-like on Windows
    main() 
```

# php - php正则表达式问题

> ID：11851032
> 
> 赞同：0
> 
> 时间：2012-08-07T17:24:46.873
> 
> 标签：php, regex

我正在做一个能够自动捕获关键字的简单教程，代码如下：-

```
$content = "#abc i love you #def #you , and you?";
preg_match_all("/[\n\r\t]*\#(.+?)\s/s",$content, $tag_matches);
print_r($tag_matches);

output:-
Array ( [0] => Array ( [0] => #abc [1] => #def [2] => #you ) [1] => Array ( [0] => abc [1] => def [2] => you ) )

'#' symbol with words are the keywords 
```

输出是正确的，但是如果我在关键字旁边插入任何标点符号，例如：#you, ，输出将变为 you, ，请问我如何在关键字后面过滤标点符号？

除此之外，如果我将任何关键字像#def#you, 一样插入在一起，输出是def#you，有没有人可以帮我分开它/

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:30:30.477

尝试使用[单词边界](http://www.regular-expressions.info/wordboundaries.html) `\b`而不是空格`\s`。当匹配到除单词字符（即，`[a-zA-Z0-9_]`）以外的任何内容时，它将停止匹配。

```
/[\n\r\t]*\#(.+?)\b/s 
```

从概念上讲，这就是您通过在此处放置空格（即，表示词尾）来尝试做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:41:37.090

你可以试试：

```
 /[\n\r\t]*\#([\w]*)\s/s 
```

* 实际上与 +? 具有相同的行为。通过匹配 . 你是每一个角色。如果您有带连字符的标签，您可能需要在括号内添加 - 。

# php - 多个动态url重写重定向到404页面

> ID：11851035
> 
> 赞同：0
> 
> 时间：2012-08-07T17:24:55.833
> 
> 标签：php, apache, url, web-applications, url-rewriting

我正在做一个从数据库中获取数据的项目。我使用的是 URL 重写方法。我正在使用重写方法它会重定向到错误页面

动态网址

```
http://www.sample.com/?cat=kk 
```

重写的网址

```
http:/www.sample.com/kk 
```

`.htaccess`为此 URL 重写编写的文件

```
RewriteEngine On
RewriteRule ^([^/]*)$ /?cat=$1 [L] 
```

.htaccess 文件还包含另一个 url 重写

```
 RewriteRule ^([^/]*)/([^/]*)/([^/]*)/([^/]*)\.html$ /?cat=$1&sub=$2&year=$3&page=$4 [L]

 RewriteRule ^([^/]*)/([^/]*)$ /?cat=$1&sub=$2 [L]

 RewriteRule ^([^/]*)/([^/]*)$ /?cat=$1&sub=$2 [L]

 RewriteRule ^([^/]*)/([^/]*)/$ /?cat=$1&sub=$2 [L]

 RewriteRule ^([^/]*)/([^/]*)/([^/]*)\.html$ /?cat=$1&sub=$2&pag=$3 [L]

 RewriteRule ^([^/]*)/$ /?cat=$1 [L]

  RewriteCond %{REQUEST_FILENAME} !-f

  RewriteCond %{REQUEST_FILENAME} !-d 
```

我遇到的问题是，当我访问任何页面时，它将重定向到服务器默认错误页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T19:42:26.990

我很抱歉这么说，但你的重写规则很乱。

总是从最复杂的开始到最简单的。

而且您忘记了最重要的指令之一：`QSA`. 我让你用谷歌搜索这个；）

也许接下来的内容仍然不起作用，但它更干净。我们需要日志文件来了解发生了什么。

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/([^/]*)\.html$ /?cat=$1&sub=$2&year=$3&page=$4 [QSA,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)/([^/]*)/([^/]*)\.html$ /?cat=$1&sub=$2&page=$3 [QSA,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)/([^/]*)/?$ /?cat=$1&sub=$2 [QSA,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)/?$ /?cat=$1 [QSA,L] 
```

# asp.net-mvc-3 - Unobtrusive JS (MVC3) 导致延迟的 DOMContentLoaded 事件

> ID：11851044
> 
> 赞同：1
> 
> 时间：2012-08-07T17:25:36.497
> 
> 标签：asp.net-mvc-3, performance, unobtrusive-validation

尽管从 $.Ready() 中删除了我的所有代码，但它似乎`jquery.validate.unobtrusive.js`调用了一些加载代码，这导致我们的 DOMContentLoaded 事件需要 300 毫秒的前置时间才能触发。

我们确实有一个相当大的 DOM，但肯定不会花那么长时间吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:25:36.497

在解决我正在开发的产品上的一些性能问题时，我的 DOMContentLoaded 事件似乎在 IE 9 中花费了 700 毫秒（我们有一个非常大的 DOM - 这也在我的列表中）

禁用我所有的 OnReady 代码后 - 我缩小了范围

`parse(selector)`在`jquery.validate.unobtrusive.js`

找到后：

`$(selector).find(":input[data-val=true]").each(function () {...}`我立即知道 Find() 方法中选择器的结构，这将进入嘶嘶声引擎，而不是使用`Document.QuerySelectorAll()`.

--根据@CharlesC 的评论进行编辑--

选择器的微小更改为：

`$(selector).find("input, select, textarea").filter("[data-val=true]")`在 IE 中导致 300 毫秒的性能提升。

# java - 将自定义密钥库与 Jetty 的 WebSocketClientFactory 一起使用

> ID：11851051
> 
> 赞同：7
> 
> 时间：2012-08-07T17:25:53.417
> 
> 标签：java, security, ssl, jetty, cometd

我有一个 Java 项目，它通过使用自签名证书的安全 WebSocket 传输连接到 CometD 服务器。我正在`WebSocketClientFactory`通过以下方式配置：

```
wssFactory.getSslContextFactory().setKeyStorePath("/path/to/my/custom.jks");
wssFactory.getSslContextFactory().setKeyStorePassword("mypass"); 
```

然后像这样创建我`BayeuxClient`的：

```
BayeuxClient client = new BayeuxClient(
        "wss://myserver.com/cometd",
        WebSocketTransport.create(clientOptions, wssFactory)); 
```

事实上，当第一次加载时，事情似乎配置正确：

```
[DEBUG] 2012-08-07 12:58:05,786 : starting org.eclipse.jetty.websocket.WebSocketClientFactory@75cfa3d2
[DEBUG] 2012-08-07 12:58:05,786 : starting qtp2005556553{8<=0<=0/254,-1}
[DEBUG] 2012-08-07 12:58:05,788 : STARTED qtp2005556553{8<=7<=8/254,0}
[DEBUG] 2012-08-07 12:58:05,788 : starting org.eclipse.jetty.websocket.WebSocketClientFactory$WebSocketClientSelector@50c8c3b8
[DEBUG] 2012-08-07 12:58:05,795 : STARTED org.eclipse.jetty.websocket.WebSocketClientFactory$WebSocketClientSelector@50c8c3b8
[DEBUG] 2012-08-07 12:58:05,795 : Starting Thread[qtp2005556553-33 Selector0,5,main] on org.eclipse.jetty.io.nio.SelectorManager$1@346fe350
[DEBUG] 2012-08-07 12:58:05,797 : starting SslContextFactory@4240eca3(/Users/apetresc/Downloads/infrastructure.jks,null)
[INFO ] 2012-08-07 12:58:05,981 : Enabled Protocols [SSLv2Hello, SSLv3, TLSv1] of [SSLv2Hello, SSLv3, TLSv1]
[DEBUG] 2012-08-07 12:58:05,981 : Enabled Ciphers   [SSL_RSA_WITH_RC4_128_MD5, SSL_RSA_WITH_RC4_128_SHA, TLS_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_256_CBC_SHA, SSL_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA, SSL_RSA_WITH_DES_CBC_SHA, SSL_DHE_RSA_WITH_DES_CBC_SHA, SSL_DHE_DSS_WITH_DES_CBC_SHA, SSL_RSA_EXPORT_WITH_RC4_40_MD5, SSL_RSA_EXPORT_WITH_DES40_CBC_SHA, SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA, SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA, TLS_EMPTY_RENEGOTIATION_INFO_SCSV] of [SSL_RSA_WITH_RC4_128_MD5, SSL_RSA_WITH_RC4_128_SHA, TLS_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_256_CBC_SHA, SSL_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA, SSL_RSA_WITH_DES_CBC_SHA, SSL_DHE_RSA_WITH_DES_CBC_SHA, SSL_DHE_DSS_WITH_DES_CBC_SHA, SSL_RSA_EXPORT_WITH_RC4_40_MD5, SSL_RSA_EXPORT_WITH_DES40_CBC_SHA, SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA, SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA, TLS_EMPTY_RENEGOTIATION_INFO_SCSV, SSL_RSA_WITH_NULL_MD5, SSL_RSA_WITH_NULL_SHA, SSL_DH_anon_WITH_RC4_128_MD5, TLS_DH_anon_WITH_AES_128_CBC_SHA, TLS_DH_anon_WITH_AES_256_CBC_SHA, SSL_DH_anon_WITH_3DES_EDE_CBC_SHA, SSL_DH_anon_WITH_DES_CBC_SHA, SSL_DH_anon_EXPORT_WITH_RC4_40_MD5, SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA, TLS_KRB5_WITH_RC4_128_SHA, TLS_KRB5_WITH_RC4_128_MD5, TLS_KRB5_WITH_3DES_EDE_CBC_SHA, TLS_KRB5_WITH_3DES_EDE_CBC_MD5, TLS_KRB5_WITH_DES_CBC_SHA, TLS_KRB5_WITH_DES_CBC_MD5, TLS_KRB5_EXPORT_WITH_RC4_40_SHA, TLS_KRB5_EXPORT_WITH_RC4_40_MD5, TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA, TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5]
[DEBUG] 2012-08-07 12:58:05,981 : STARTED SslContextFactory@4240eca3(/Users/apetresc/Downloads/infrastructure.jks,/Users/apetresc/Downloads/infrastructure.jks)
[DEBUG] 2012-08-07 12:58:05,981 : STARTED org.eclipse.jetty.websocket.WebSocketClientFactory@75cfa3d2 
```

而且，确实，**实际使用了`BayeuxClient`作品**。但是，即使我根本没有指定密钥库，它也可以工作——它只是将其视为未签名的证书。而且，确实，这似乎是正在发生的事情，从我每隔几秒钟就会收到的错误日志来看：

```
[DEBUG] 2012-08-07 13:20:37,348 : State update: CONNECTED -> CONNECTED
[DEBUG] 2012-08-07 13:20:37,348 : Connecting, transport org.cometd.websocket.client.WebSocketTransport@53ddbcb1
[DEBUG] 2012-08-07 13:20:37,348 : [Session-1, SSL_NULL_WITH_NULL_NULL] SslConnection@79c190a2 SSL NOT_HANDSHAKING i/o/u=0/0/0 ishut=false oshut=false {WebSocketClientConnection p=WebSocketParserRFC6455@5266db4e state=START buffer= g=WebSocketGeneratorRFC6455@5ec80825 closed=false buffer=-1} NOT_HANDSHAKING filled=0/0 flushed=0/0
[DEBUG] 2012-08-07 13:20:37,348 : Sending messages [{id=50, connectionType=websocket, channel=/meta/connect, clientId=2u16ol79fcq7hqe1wu52pr0ws4aw}]
[DEBUG] 2012-08-07 13:20:37,348 : Registering WebSocketExchange {id=50, connectionType=websocket, channel=/meta/connect, clientId=2u16ol79fcq7hqe1wu52pr0ws4aw}
[DEBUG] 2012-08-07 13:20:37,348 : [Session-1, SSL_NULL_WITH_NULL_NULL] SslConnection@79c190a2 SSL NOT_HANDSHAKING i/o/u=0/0/0 ishut=false oshut=false {WebSocketClientConnection p=WebSocketParserRFC6455@5266db4e state=OPCODE buffer= g=WebSocketGeneratorRFC6455@5ec80825 closed=false buffer=-1} NOT_HANDSHAKING filled=0/0 flushed=0/0
[DEBUG] 2012-08-07 13:20:37,348 : Sending messages [{"id":"50","connectionType":"websocket","channel":"/meta/connect","clientId":"2u16ol79fcq7hqe1wu52pr0ws4aw"}]
[DEBUG] 2012-08-07 13:20:37,348 : [Session-1, SSL_NULL_WITH_NULL_NULL] SslConnection@79c190a2 SSL NOT_HANDSHAKING i/o/u=0/0/0 ishut=false oshut=false {WebSocketClientConnection p=WebSocketParserRFC6455@5266db4e state=OPCODE buffer= g=WebSocketGeneratorRFC6455@5ec80825 closed=false buffer=116} NOT_HANDSHAKING filled=0/0 flushed=0/0
[DEBUG] 2012-08-07 13:20:37,349 : [Session-1, SSL_NULL_WITH_NULL_NULL] SslConnection@79c190a2 SSL NOT_HANDSHAKING i/o/u=0/0/0 ishut=false oshut=false {WebSocketClientConnection p=WebSocketParserRFC6455@5266db4e state=OPCODE buffer=null g=WebSocketGeneratorRFC6455@5ec80825 closed=false buffer=116} NOT_HANDSHAKING filled=0/0 flushed=0/0
[DEBUG] 2012-08-07 13:20:37,349 : [Session-1, SSL_NULL_WITH_NULL_NULL] wrap OK NOT_HANDSHAKING consumed=116 produced=137
[DEBUG] 2012-08-07 13:20:37,349 : [Session-1, SSL_NULL_WITH_NULL_NULL] SslConnection@79c190a2 SSL NOT_HANDSHAKING i/o/u=0/0/0 ishut=false oshut=false {WebSocketClientConnection p=WebSocketParserRFC6455@5266db4e state=OPCODE buffer=null g=WebSocketGeneratorRFC6455@5ec80825 closed=false buffer=0} NOT_HANDSHAKING filled=0/0 flushed=137/0
[DEBUG] 2012-08-07 13:20:37,349 : [Session-1, SSL_NULL_WITH_NULL_NULL] SslConnection@79c190a2 SSL NOT_HANDSHAKING i/o/u=0/0/0 ishut=false oshut=false {WebSocketClientConnection p=WebSocketParserRFC6455@5266db4e state=OPCODE buffer=null g=WebSocketGeneratorRFC6455@5ec80825 closed=false buffer=0} NOT_HANDSHAKING filled=0/0 flushed=0/0
[DEBUG] 2012-08-07 13:20:37,349 : [Session-1, SSL_NULL_WITH_NULL_NULL] handle SslConnection@79c190a2 SSL NOT_HANDSHAKING i/o/u=0/0/0 ishut=false oshut=false {WebSocketClientConnection p=WebSocketParserRFC6455@5266db4e state=OPCODE buffer=null g=WebSocketGeneratorRFC6455@5ec80825 closed=false buffer=-1} progress=false 
```

对我来说，这意味着*CometD*握手正在完成，但*SSL*握手尚未完成。不过，我不知道为什么会这样。一种类似的方法适用于我的 HTTPS 调用。只有WSS让我头疼。

值得一提的是，我可以在各种不同的环境中重现这一点，包括 Android 应用程序和 Jetty servlet 容器。

有没有人成功使用带有自签名证书的 WSS？想弄清楚我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T19:04:18.400

在第二个代码块中，您没有收到任何“错误”。这是 unconfigured 的正常输出`SslContextFactory`，它提供空密码套件和始终批准的证书验证程序。另请参阅此处了解更多`SslContextFactory` [配置](http://wiki.eclipse.org/Jetty/Reference/SSL_Connectors)。

从日志中，您可以在两种情况下都使用它。

对于您的问题的更通用的答案，当您使用自签名证书时，您可能希望`SslContextFactory`使用信任库配置 ，以便证书验证可以使用它来验证自签名证书。

除此之外，在我看来，您已经正确设置了代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T19:18:15.627

我不太了解`WebSocketClientFactory`，但据我了解，它用于客户端配置，您实际上是在尝试连接到配置有自签名证书的服务器，该证书的副本存储在您的`custom.jks`文件中在客户端。

在客户端接受自签名证书所需的不是设置其密钥库（用于从该端进行客户端证书身份验证），而是设置其信任库。

尝试替换`setKeyStore*`为`setTrustStore*`.

# java - 最好的 Java 学习框架

> ID：11851053
> 
> 赞同：0
> 
> 时间：2012-08-07T17:26:04.023
> 
> 标签：java, frameworks

对于想要学习的人来说，探索什么是一个好的 Java 框架？我玩过 Android api，但有人问我使用过哪些其他框架，所以我想我应该花一些时间与另一个框架一起工作。我这个时代最好的爆炸是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:28:37.983

对于网络框架，我建议：Spring、Hibernate、Struts、Primefaces（很酷的东西）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T04:00:12.283

有许多 java 框架，但我们可以将其分为两部分。

标准框架

*   JSF
*   JSP 和小服务程序
*   JPA
*   EJB

非标准框架

*   春天
*   支撑
*   便门
*   GWT
*   休眠
*   接缝
*   玩
*   其他

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:33:57.540

这实际上取决于您要获得的经验是什么。如果你正在寻找 web 框架，gaspyr 列举了一些你应该尝试的不错的框架（我自己使用过 Spring）。如果您只想开发桌面应用程序或嵌入式解决方案，我将只处理标准 JRE，并特别注意应用程序、applet 和 servlet 运行方式之间的差异。了解底层库本身总是很好的，而不是仅仅了解语法并尝试使用框架来解决所有问题而不了解它们如何在幕后工作。

但这是一个非常开放的问题，很难确切地知道你在寻找什么以及为什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T17:41:18.887

框架的选择取决于许多因素，良好的文档也不是最不重要的。

如果您决定从 Spring 开始，那么有一本令人难以置信的书[“Spring in Action” 。](http://www.manning.com/walls4/)

# php - PHP MAMP 和服务器冲突

> ID：11851055
> 
> 赞同：0
> 
> 时间：2012-08-07T17:26:23.097
> 
> 标签：php, command-line-interface, mamp

我有一个调用 php 脚本的页面。在 MAMP 上一切正常，但是当我将其上传到服务器时，出现以下错误：

```
Call Request failed! Status code: 4000
Reason - Caught an HttpRequestValidationException due to some bad characters in the request. Make sure your post request is encoded as xml, preferable as UTF-8 ('Content-Type: text/xml; charset=utf-8'). Exception: A potentially dangerous Request.Form value was detected from the client (<?xml version="..."utf-8"?> <uclassify xmlns="ht..."). 
```

有没有人见过这样的东西？

你可以[在这里](http://stackoverflowsearch.comeze.com/)自己查一下，只要放一个像php或ios这样的词

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:38:13.013

尝试更改`charset=utf-8`为`charset=UTF-8`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:41:51.230

看起来您的服务器正在根据`content-type`标头进行验证。它似乎想要`text/xml`，而您正在发送`application/x-www-form-urlencoded`（这是 的默认值`$.ajax`）。

尝试`text/xml`在您的`$.ajax`通话中明确设置内容类型。（[参考](http://api.jquery.com/jQuery.ajax/)）

# c# - 图像在过渡期间的表情混合模糊

> ID：11851056
> 
> 赞同：0
> 
> 时间：2012-08-07T17:26:28.200
> 
> 标签：c#, wpf, xaml, expression-blend

我正在处理状态之间的表达式混合转换中的 WPF 应用程序，图像看起来像移动了几个像素，看起来有点模糊。我检查了我所有的状态，它们看起来一切都很好。所有元素都包含在网格和画布中，它们在我添加的状态中出现和消失。有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:10:58.793

“图像必须是 96 dpi 才能在 Blend 中正确使用，因此它是 1:1。这应该在文档中真正指出。如果图像不是 96dpi，那么它会在 Blend 中被拉伸并使图像模糊，这不是好的。”

[http://expression.microsoft.com/en-us/dd282881.aspx](http://expression.microsoft.com/en-us/dd282881.aspx)

# c# - HttpPost 上的 ModelState 验证文化

> ID：11851063
> 
> 赞同：3
> 
> 时间：2012-08-07T17:26:52.813
> 
> 标签：c#, asp.net, asp.net-mvc-3

有谁知道您是否可以控制 ModelState 对象的文化，我在我的多语言应用程序中面临一个问题，其中语言基于您访问该站点的子域，例如：

> italia.domain.com - “将文化更改为意大利语”
> 
> German.domain.com -“将文化更改为德语”

问题是提交表单时 ModelState 对象上的语言似乎由客户端浏览器控制，而不是当前线程文化。

因此，我正在寻找一个解决方案，我可以修改此行为或覆盖它，以便我的意大利语子域上的语言始终是意大利语，而不是客户端浏览器的语言。

编辑

**我已经完成了根据子域更改语言的部分：**

```
var HttpHost = HttpContext.Request.ServerVariables["HTTP_HOST"];
var _hostname = (HttpHost.Split(':').Length > 1) ? HttpHost.Substring(0, HttpHost.IndexOf(':')) : HttpHost;

var allowedHostnames = "italiansubdomain.domain.com|it,frenchsubdomain.domain.com|fr,germansubdomain.domain.com|de,englishsubdomain.domain.com|en".Split(',');
foreach (var hostname in allowedHostnames)
{
    if (hostname.StartsWith(_hostname.ToLower()))
    {
        var lang = hostname.Split('|').Last();
        if (lang == "en") lang = "uk";
        // Updates the cultures for the dynamic language
        var ci = new CultureInfo(lang);
        System.Threading.Thread.CurrentThread.CurrentCulture = ci;
        System.Threading.Thread.CurrentThread.CurrentUICulture = ci;
    }
} 
```

所以我的问题是，当我像这样使用 Modelstate 验证时：

```
public class Email {
    [Required(ErrorMessageResourceName = "validation_required", ErrorMessageResourceType = typeof(Resources.Master)), StringLength(50, MinimumLength = 2, ErrorMessageResourceName = "validation_string_length_2_50", ErrorMessageResourceType = typeof(Resources.Master))]
    public string SenderName { get; set; }
    [Required(ErrorMessageResourceName = "validation_required", ErrorMessageResourceType = typeof(Resources.Master)), Email(ErrorMessageResourceName = "validation_email_invalid", ErrorMessageResourceType = typeof(Resources.Master))]
    public string SenderEmail { get; set; }
    [Required(ErrorMessageResourceName = "validation_required", ErrorMessageResourceType = typeof(Resources.Master)), StringLength(50, MinimumLength = 2, ErrorMessageResourceName = "validation_string_length_2_50", ErrorMessageResourceType = typeof(Resources.Master))]
    public string ReceiverName { get; set; }
    [Required(ErrorMessageResourceName = "validation_required", ErrorMessageResourceType = typeof(Resources.Master)), Email(ErrorMessageResourceName = "validation_email_invalid", ErrorMessageResourceType = typeof(Resources.Master))]
    public string ReceiverEmail { get; set; }
    public string Comment { get; set; }
} 
```

以及检查模型状态验证部分：

```
if (!ModelState.IsValid) {
  var keys = ModelState.Keys.ToList();
  var values = ModelState.Values.ToList();

  for (var i = 0; i < keys.Count; i++)
  {
      var value = values[i];
      if (value.Errors.Count > 0)
      { 
          response.AddError(keys[i], value.Errors[0].ErrorMessage);
      }
  }
} 
```

然后，当我通过 Ajax 响应结果或仅通过调试我根据浏览器语言设置接收错误消息来访问错误时，这就是我想将其更改为当前活动的语言的地方。

编辑

提前致谢， bsthomsen

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T07:16:58.170

我通过将更改文化的代码从 Controller.OnActionExecuting 移动到 Controller.ExecuteCore 解决了这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:34:51.500

这个 libk 应该有助于[如何：为 ASP.NET 网页全球化设置文化和 UI 文化](http://msdn.microsoft.com/en-us/library/bz9tc508.aspx)

将全球化部分添加到 Web.config 文件

```
<globalization uiCulture="es" culture="es-MX" /> 
```

或以编程方式，覆盖`InitializeCulture`页面的方法（WebForms）

```
protected override void InitializeCulture()
{

        UICulture = selectedLanguage ;
        Culture = selectedLanguage ;

        Thread.CurrentThread.CurrentCulture = 
            CultureInfo.CreateSpecificCulture(selectedLanguage);
        Thread.CurrentThread.CurrentUICulture = new 
            CultureInfo(selectedLanguage);

    base.InitializeCulture();
} 
```

或查看这个问题[Set Culture in an ASP.Net MVC app](https://stackoverflow.com/questions/1560796/set-culture-in-an-asp-net-mvc-app)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:38:17.553

我曾在一个不完全相同但相似的情况下工作。您应该能够将当前线程的 UICulture 设置为特定语言，并且事情应该可以按您期望的那样工作。因此，确定请求的子域并相应地设置文化。查看更多：http: [//msdn.microsoft.com/en-us/library/system.threading.thread.currentuiculture.aspx](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentuiculture.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T17:43:36.467

您可以轻松地覆盖每个请求的文化`Global.asax.cs`

在您的情况下，您可以检查传入的 URL 并相应地设置文化。

```
protected void Application_AcquireRequestState(object sender, EventArgs e)
{
     //Create culture info object 
     CultureInfo ci = new CultureInfo("en");

     if(Request.Url.Host.Equals("italia.domain.com",
                                    StringComparison.InvariantCultureIgnoreCase))
     {
          ci = new CultureInfo("it");
     }

     System.Threading.Thread.CurrentThread.CurrentUICulture = ci;
     System.Threading.Thread.CurrentThread.CurrentCulture =
                                      CultureInfo.CreateSpecificCulture(ci.Name);
} 
```

# ios - CLLocationManager - 在位置服务提示后加载 MKAnnotation

> ID：11851067
> 
> 赞同：0
> 
> 时间：2012-08-07T17:27:26.810
> 
> 标签：ios, mkmapview, cllocationmanager

我有一个应用程序需要检测用户的位置`MKAnnotations`并在`MKMapView`. 如何获得有关用户是否在位置服务提示上选择了“是”的通知，以便随后调用我的方法来获取用户位置并添加注释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:31:18.763

这将在位置管理器委托 didUpdateToLocation 中发生；

```
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
    MyAnnotation * annotation = [[MyAnnotation alloc] initWithCoordinate:coordinate];
    [self.mapView addAnnotation:annotation];
} 
```

您将需要创建一个 MyAnnotation 类。看看这里：[https ://stackoverflow.com/a/2878806/1535038](https://stackoverflow.com/a/2878806/1535038)

# asp.net-mvc - 如何在 MVC Grid 的 Kendo UI 中将焦点设置为单元格

> ID：11851071
> 
> 赞同：1
> 
> 时间：2012-08-07T17:27:45.117
> 
> 标签：asp.net-mvc, kendo-ui

我需要在 DataBound 事件期间的第一行将 Kendo UI Grid 的焦点设置为特定单元格。我将 Kendo 用于 MVC，这是我的专栏的定义：

columns.Bound(o => o.QtyCurrentlyReceived).Width(75).Title("Qty Curr Rx");

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T17:14:50.650

好吧，那么这是应该为您完成工作的代码：

```
var theCell = $('#Grid tbody td:eq(3)');//sample selector for a cell
$('#Grid').data('tGrid').editCell(theCell);//ask the Grid to put that cell in edit mode 
```

# php - PHP强制下载和刷新解决方案不起作用

> ID：11851072
> 
> 赞同：5
> 
> 时间：2012-08-07T17:27:47.283
> 
> 标签：php, javascript, session, download, refresh

最终目标：单击页面 1 上的链接，最终下载文件并刷新页面 1\. 使用 PHP 提供不在公共 html 中的下载。

方法：

**第 1 页。** 链接转移到第 2 页，获取我正在使用的文件的变量引用。

**第 2 页。** 使用刷新第 1 页之前需要更新的信息更新相关 SQL 数据库。设置“firstpass”会话变量。从获取变量中设置会话变量“getvariablereference”。重定向到第 1 页。

**第 1 页。** 如果第一次通过会话变量集。设置第二遍会话变量。取消设置第一遍变量。刷新页面。重新加载时，页面将使用更新的 SQL 数据库信息重建（在第 2 页更改。）。

**刷新第 1 页。** 如果设置了第二遍会话变量。运行下载服务标头序列。

这是第 1 页。我没有显示第 1 页中具有初始链接的部分。既然无所谓。

```
// REFERSH IF FIRSTPASS IS LIVE
if ($_SESSION["PASS1"] == "YES"){
    $_SESSION["PASS1"] = "no";
    $_SESSION["PASS2"] = "YES";
    echo "<script>document.location.reload();</script>";
    }
if ($_SESSION["PASS2"] == "YES"){
    // Grab reference data from session:
        $id = $_SESSION['passreference'];
                // Serve the file download
                        //First find the file location
                        $query = "SELECT * from rightplace
                              WHERE id = '$id'";
                        $result = mysql_query($query);
                        $row = mysql_fetch_array($result);
                        $filename = $row['file'];
                        $uploader = $row['uploader'];   
                            // Setting up download variables
                                $string1 = "/home/domain/aboveroot/";
                                $string2 = $uploader;
                                $string3 = '/';
                                $string4 = $filename;
                                $file= $string1.$string2.$string3.$string4;
                                $ext = strtolower (end(explode('.', $filename)));
                                //Finding MIME type
                                    if($ext == "pdf" && file_exists($file)) {
                                        header("Content-disposition: attachment; filename= '$filename'");
                                        header('Content-type: application/pdf');
                                        readfile($file);
                                        }                                   
                                    if($ext == "doc" && file_exists($file)) {
                                        header("Content-disposition: attachment; filename= '$filename'");
                                        header('Content-type: application/msword');
                                        readfile($file);
                                        }                   
                                    if($ext == "txt" && file_exists($file)) {
                                        header("Content-disposition: attachment; filename= '$filename'");
                                        header('Content-type: text/plain');
                                        readfile($file);
                                        }                   
                                    if($ext == "rtf" && file_exists($file)) {
                                        header("Content-disposition: attachment; filename= '$filename'");
                                        header('Content-type: application/rtf');
                                        readfile($file);
                                        }
                                    if($ext == "docx" && file_exists($file)) {
                                        header("Content-disposition: attachment; filename= '$filename'");
                                        header('Content-type: application/vnd.openxmlformats-officedocument.wordprocessingml.document');
                                        readfile($file);
                                        }
                                    if($ext == "pptx" && file_exists($file)) {
                                        header("Content-disposition: attachment; filename= '$filename'");
                                        header('Content-type: application/vnd.openxmlformats-officedocument.presentationml.presentation');
                                        readfile($file);
                                        }
                                    if($ext == "ppt" && file_exists($file)) {
                                        header("Content-disposition: attachment; filename= '$filename'");
                                        header('Content-type: application/vnd.ms-powerpoint');
                                        readfile($file);
                                        }
                                        } 
```

第 2 页上的脚本工作正常。它会更新 sql 数据库并正确重定向到主页。我还检查了它是否设置了“$_SESSION['passreference'];” 正确，第 1 页上的任何内容都不会取消它。

所以，这就是对这种情况的全部长解释。我难住了。正如我所说，第 2 页工作正常。然后它踢到第 1 页，刷新然后不推送任何下载。我知道下载脚本有效，并且可以下载文件（在没有整个刷新序列的情况下进行检查）。

我基本上有两个问题：

1.  谁能发现出了什么问题？

2.  任何人都可以概念化更好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T01:07:45.823

即使给定代码，也很难远程调试这样的东西，你发布的部分就像你说的那样工作。你检查过你的错误日志吗？`header()`最可能的罪魁祸首是在完成其他输出后发送问题。

在处理文件下载时，我认为在新页面/窗口上启动下载更容易，因此不会有破坏标题的风险。可能使用启动实际下载的第三页稍微改变了顺序：

1.  第 1 页链接到第二页做魔术，它重定向回第 1 页
2.  然后第 1 页在新窗口中生成第 3 页，这将启动下载。

[在这个答案](https://stackoverflow.com/questions/1066452/easiest-way-to-open-a-download-window-without-navigating-away-from-the-page/1066461#1066461)中有一个很好的示例代码，用于加载新窗口以供下载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-09T20:55:39.000

查看您的代码，下载问题可能是该`$ext`变量包含一个意外的值，或者该`$file`变量包含一个确实不存在的文件的名称。
在这两种情况下，您的“如果”条件都不成立，因此下载不会开始。我的建议是在 " " 注释行
之前添加以下语句：`//Finding MIME type`

```
$log  = "file='".$file."'\n";
$log .= "ext='".$ext."'\n";
@file_put_contents("/tmp/page1.log", $log, FILE_APPEND); 
```

这样，查看“/tmp/page1.log”文件，您应该能够检查`$file`和`$ext`变量是否有效地包含预期值。
我使用“/tmp/page1.log”作为日志文件名，因为我认为您正在使用 linux；如果没有，请使用您环境的有效路径和文件名调整“file_put_contents”函数的第一个参数。
另外，我会用以下代码替换“if”测试的序列：

```
$content_types = array(
    "pdf"  => "application/pdf",
    "doc"  => "application/msword",
    "txt"  => "text/plain",
    "rtf"  => "application/rtf",
    "docx" => "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
    "pptx" => "application/vnd.openxmlformats-officedocument.presentationml.presentation"
);

if (isset($content_types[$ext])) {
    if (file_exists($file)) {
        header("Content-disposition: attachment; filename= '$filename'");
        header('Content-type: '.$content_types[$ext]);
        readfile($file);
        die("");
    } else {
        die("** '".$file."' does not exist **");
    }
} else {
    die("** Unhandled '".$ext."' extension **");
} 
```

显然，您应该以更健壮的方式实现错误处理，而不是像我一样简单地使用“die()”函数，但这只是一个示例。
最后，请注意，还有更好的方法来获取与文件扩展名对应的内容类型；例如，一种解决方案是使用 PHP [Fileinfo](http://www.php.net/manual/en/ref.fileinfo.php)函数。
查看[此答案](https://stackoverflow.com/questions/1232769/how-to-get-the-content-type-of-a-file-in-php)以获取有关此主题的更多信息。
还要记住，在[安全模式下](http://it2.php.net/manual/en/features.safe-mode.php)，file_exists 函数总是返回 FALSE，并且 file_exists 函数的结果会被缓存；有关详细信息，请参阅 PHP 手册中的[clearstatcache()](http://it2.php.net/manual/en/function.clearstatcache.php)函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:56:07.917

我只是稍微修改了你的 PHP 代码。尤其是您将获得有关问题所在的更多信息。只需尝试此代码并阅读以下注释，如果您收到新的错误消息之一，这些注释会解释发生了什么。另请阅读下面的注释部分，它解释了为什么您可能无法从 PHP 访问文件，即使它存在并且位于正确的目录中。

1.  使用 window.location.reload(); 而不是 document.location ...
2.  我添加了一个 error() 函数。您可以向其中添加更多 HTML，因此它会以您想要的布局生成页面。您也可以将错误记录到本地文件中。有一个私有信息参数用于将敏感信息作为数据库错误（可以包含 SQL）传递给函数。对于生产性用途，您不应将其显示给用户。相反，您可以将其登录到文件中或只为特权用户（例如管理员）显示它。
3.  检查天气 $id 是否已设置。如果不是，则返回 error() 消息；如果会话未正确更新，可能会发生。
4.  我添加了“$id = addlashes($id);” 出于安全原因。例如，如果您的 id 可以设置为 $id = "' OR 1" (SQL-Injection) 之类的值，您可能会遇到麻烦。如果您确定这不会发生，您可以将其删除。
5.  它在 DB 查询之后检查 $result 变量。例如，如果您的数据库连接未建立或脚本无法连接，这将产生一个错误（）输出，通知您。如果您的 SQL 语法有错误，例如错误的表名，也会发生同样的情况。
6.  它还检查天气是否从数据库中获取了有效的 $row。如果没有返回一行，您的 $id 可能是错误的（您的数据库中没有这样的条目）。
7.  我将您的字符串操作重写为 $filepath = $rootpath 。“/”。$上传者。“/”。$文件名；其中 $rootpath 之前设置，末尾没有“/”；这更容易阅读......
8.  扩展和 MIME 类型现在被放入一个数组中，而不是使用大量的“if-then”块，这样更容易维护。这些块中的代码也相似......所以我们只需要编写一次。
9.  如果文件扩展名未知，则发送默认 MIME 类型（Content-Type:"application/octet-stream）。
10.  我们检查 file_exists() 并输出错误消息，并给出 $filename 以允许检查天气路径是否正确......

所以这里是源代码：

```
<?php 

function error($message, $info = "") {
  echo "ERROR: $message<br>";
  echo "PRIVATE-INFO: $info"; // probably you only want to log that into a file?
  exit;
}

// REFERSH IF FIRSTPASS IS LIVE
if ($_SESSION["PASS1"] == "YES") {
  $_SESSION["PASS1"] = "no";
  $_SESSION["PASS2"] = "YES";
  echo "<script>window.location.reload();</script>";
  exit;
}

if ($_SESSION["PASS2"] == "YES") {
  // Grab reference data from session:
  $id = $_SESSION['passreference'];

  if (!$id) error("Internal Error ('id' not set)");

  // Select file location from DB
  $id = addslashes($id);
  $query = "SELECT * from rightplace WHERE id = '$id'";
  $result = mysql_query($query);

  if (!$result) error("DB-query execution error", mysql_error());

  $row = mysql_fetch_array($result);
  mysql_free_result($result);

  if (!$row) error("File with ID '$id' was not found in DB.");

  $filename = $row['file'];
  $uploader = $row['uploader'];

  // Setting up download variables
  $rootpath = "/home/domain/aboveroot";
  $filepath = $rootpath . "/" . $uploader . "/" . $filename;
  $ext = strtolower(end(explode('.', $filename)));

  // Serve the file download

  // List of known extensions and their MIME-types...
  $typelist = array(
      "pdf"  => "application/pdf",
      "doc"  => "application/msword",
      "txt"  => "text/plain",
      "rtf"  => "application/rtf",
      "docx" => "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
      "pptx" => "application/vnd.openxmlformats-officedocument.presentationml.presentation",
      "ppt"  => "application/vnd.ms-powerpoint"
  );

  // set default content-type
  $type = "application/octet-stream";

  // for known extensions, assign specific content-type
  if (!isset($typelist[$ext])) $type = $typelist[$ext];

  if (file_exists($filepath)) {
    header("Content-disposition: attachment; filename= '$filename'");
    header("Content-type: $type");
    readfile($filepath);
  } else {
    error("Error: File '$filepath' was not found!", $filepath);
  }
}

?> 
```

## 笔记：

1.  即使文件存在，也可能发生文件未找到错误。如果发生这种情况，这很可能是一种防止 PHP 脚本访问 HTML 根目录之外的文件的安全机制。例如，php 脚本可以在“chrooted”环境中执行，其中根目录“/”被映射到例如“/home/username/”。因此，如果您想访问“/home/username/dir/file”，则需要在 PHP 脚本中写入“/dir/file”。如果您的根设置为“/home/username/html”，则情况可能更糟；那么您将无法访问“html”目录下的目录。要解决这个问题，您可以在 HTML 根目录中创建一个目录，并在其中放置一个名为“.htaccess”的文件。在里面写“拒绝所有人”，这可以防止通过浏览器请求访问目录（只有脚本可以访问它）。这仅适用于 apache 服务器。但是对于其他服务器软件也有类似的解决方案......更多信息可以在下面找到：[http://www.php.net/manual/en/ini.core.php#ini.open-basedir](http://www.php.net/manual/en/ini.core.php#ini.open-basedir)

2.  另一种可能性是您的文件访问权限（对于上传的文件）未设置为允许您的脚本访问它们。启用某些安全设置（在 linux 服务器上）后，您的 PHP 脚本只能访问与为脚本文件设置的“所有者”相同的用户所拥有的文件。通过“ftp”上传后，这很可能是 ftp 用户的用户名。如果在 shell 上编辑，这将是当前用户的用户名。=> 但是：上传的文件有时会分配给运行网络服务器的用户（例如“www-data”、“www-run”或“apache”）。所以找出它是什么并将你的脚本分配给这个所有者。

3.  对于文件上传，您应该使用 move_uploaded_file(...) ，此处解释为：www.php.net/manual/en/function.move-uploaded-file.php；如果您不这样做，文件访问权限可能是错误的，或者您可能无法访问该文件。

# android - PC 无法识别 Viewsonic Viewpad 10s（通过 USB）

> ID：11851073
> 
> 赞同：1
> 
> 时间：2012-08-07T17:27:58.000
> 
> 标签：android, windows, eclipse, debugging

我即将开始编写一些 Android 应用程序，我已经下载了 Jave/Android 和 Eclipse。

我有一个测试 Android 平板电脑（Viewsonic Viewpad 10s），我将在上面运行该软件。

我希望能够将 Android 设备直接插入我的 PC，以便我在平板电脑上调试/运行应用程序。

我已经购买了一根公头->公头 USB 电缆并将其插入两个设备，但没有任何反应，它甚至没有在“设备”窗口中显示“未知设备”。我还需要做些什么来让 Windows 识别这个设备吗？（我正在运行 Windows 7（64 位））。

或者，这是在平板电脑上运行/调试的最佳方式吗？我在想可能有一个网络调试应用程序，因为两个设备都在网络上？

我对 Android 完全陌生，所以可能会遗漏一些明显的东西。虽然我在“开发”菜单中设置了“USB 调试”。

提前致谢。
富有的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:37:52.740

1.  从您的机器上拔下设备
2.  为您的设备安装驱动程序：http: [//www.viewsonic.com/support/downloads/drivers/_download/tablet/viewpad10s/ViewPad_10s_USB_driver.zip](http://www.viewsonic.com/support/downloads/drivers/_download/tablet/viewpad10s/ViewPad_10s_USB_driver.zip)
3.  插入您的设备
4.  查看设备是否有通知说调试已启用。

如果不这样做，则需要打开设备管理器，找到您的计算机认为该设备的列表，然后右键单击并卸载它。然后拔掉插头重新插上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:35:58.567

这是 Windows 的问题，Windows 无法自行识别您的平板电脑，您需要为您的设备安装适当的 USB 驱动程序，以便在平板电脑连接到 PC 时使用它。

在像 Ubuntu 这样的 GNU/linux 发行版下，一切都变得更加容易，您只需插入设备而无需安装任何东西，您只需为设备设置一次正确的权限。

# django - 将什么传递给模板、对象或字段？

> ID：11851074
> 
> 赞同：2
> 
> 时间：2012-08-07T17:28:17.807
> 
> 标签：django, django-templates, django-views

将数据发送到 Django 模板层的最佳方式是什么？

我应该把整个对象放在模板的上下文中，还是应该把它的每个字段都放在里面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:36:41.773

您应该传入整个对象，并且您将能够正常访问它们的属性。话虽如此，我建议您使用[RequestContext](https://docs.djangoproject.com/en/dev/ref/templates/api/#subclassing-context-requestcontext)，特别是如果您所指的模板是用于 html 的。

一个例子：

```
from django.template import RequestContext
from django.shortcuts import render_to_response

# define object somehow....
my_object = {'some_stuff': some_value}

def YourView(request):
  context = RequestContext(request, {
    'a_variable_you_would_like_to_pass': 'variable_value',
    'obj' : my_object
  })

  return render_to_response('your_template.html', context_instance = context) 
```

然后，在 your_template.html ...

```
<div>{{ a_variable_you_would_like_to_pass }}</div>
<div>{{ obj.some_stuff }}</div><!-- Would insert some_value --> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:32:03.810

通常你会放置一个完整的对象，然后使用 django 模板语言对其进行迭代。但是，如果您有未连接的变量，则无需将它们组合成一个对象。它们都将在上下文对象中。

# java - 如何在 Java 中访问 .tar 文件中的文件

> ID：11851075
> 
> 赞同：0
> 
> 时间：2012-08-07T17:28:24.003
> 
> 标签：java, tar

> **可能重复：**
> [如何在 Java 中提取 tar 文件？](https://stackoverflow.com/questions/315618/how-do-i-extract-a-tar-file-in-java)

我正在开发一个需要访问 .tar 中文件的应用程序。最简单的方法是什么？大约一周前，我刚开始使用 C/C++ 背景的 Java，所以我不确定我是否可以实现复杂的解决方案。

另外，您可以将 .tgz 文件视为 zip 条目吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T17:39:51.587

Java 包含用于处理 bot 压缩和 gzip 压缩库的内置函数。 [http://docs.oracle.com/javase/6/docs/api/java/util/zip/package-summary.html](http://docs.oracle.com/javase/6/docs/api/java/util/zip/package-summary.html)。

这可以用来把你`.tgz`变成一个普通的`.tar`没有太多麻烦。不，您不能将`.tgz`其视为普通拉链。它们首先在 tar 中实现，然后用 gzip 压缩。即使您对它进行压缩，您仍然需要解压缩 tar 存档以从中获取任何文件。

处理 tar 文件有点困难。上一个问题可能会有所帮助： [如何在 Java 中提取 tar 文件？](https://stackoverflow.com/questions/315618/how-do-i-extract-a-tar-file-in-java)

从这些解决方案中，我强烈推荐 apache commons 解决方案： [http ://commons.apache.org/vfs/filesystems.html](http://commons.apache.org/vfs/filesystems.html)

它将允许您从 tar 中读取，就好像它是一个文件系统一样，而无需对您的硬盘驱动器进行任何写入。在你开始之前，你必须知道你在寻找什么，但我怀疑这会阻碍你

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T17:36:10.703

可以使用Apache Commons 库中的[TarArchiveEntry来访问 Tar 文件。](http://commons.apache.org/compress/examples.html)

# java - 在 UTF-8 MySQL 数据库和 BoneCP 中插入日语字符串

> ID：11851082
> 
> 赞同：2
> 
> 时间：2012-08-07T17:28:52.603
> 
> 标签：java, mysql, sql, encoding, utf-8

我在 MySQL 中的 Java 应用程序中插入日文字符时遇到问题。
如果我插入这个字符串“今日は”，我会得到这个“？？？”。

我的表和它的字段使用 UTF-8。我不认为涉及表结构，因为当我从 PHP 插入相同的字符串时，它可以工作。

```
CREATE TABLE `pool` (
  `id` int(8) NOT NULL AUTO_INCREMENT, 
  `message` varchar(160) COLLATE utf8_bin NOT NULL DEFAULT ''
  PRIMARY KEY (`id`),
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin; 
```

我正在使用为我管理连接池的库“BoneCPConfig”连接到数据库：

```
Class.forName("com.mysql.jdbc.Driver");

Properties props = new Properties();
props.setProperty("characterEncoding", "UTF-8");
props.setProperty("useUnicode", "true");

BoneCPConfig config = new BoneCPConfig(props);
config.setJdbcUrl("jdbc:mysql://" + MYSQL_HOST_NAME + "/" + MYSQL_BASE_NAME);
config.setMinConnectionsPerPartition(MIN_CONNEXION_PER_PARTITION); 
config.setPartitionCount(PARTITION_COUNT); 
config.setUsername(MYSQL_LOGIN);
config.setPassword(MYSQL_PASSWORD); 
```

我这样插入：

```
String query = "INSERT INTO pool (message) VALUES(?) ";

PreparedStatement insertStatement = connection.prepareStatement(query, Statement.RETURN_GENERATED_KEYS);
insertStatement.setString(1, "今日は");
insertStatement.execute(); 
```

我认为我的问题出在连接配置中，但我不知道该怎么做：-/你有想法吗？

* * *

# 编辑 ：

问题解决，见下图

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:11:58.713

问题是不使用传入参数的属性的lib BoneCP ...我通过替换：

```
Properties props = new Properties();
props.setProperty("characterEncoding", "UTF-8");
props.setProperty("useUnicode", "true");

BoneCPConfig config = new BoneCPConfig(props);
config.setJdbcUrl("jdbc:mysql://" + MYSQL_HOST_NAME + "/" + MYSQL_BASE_NAME); 
```

和 ：

```
BoneCPConfig config = new BoneCPConfig();
config.setJdbcUrl("jdbc:mysql://" + MYSQL_HOST_NAME + "/" + MYSQL_BASE_NAME + "?user=" + MYSQL_LOGIN + "&password=" + MYSQL_PASSWORD + "&characterEncoding=utf-8"); 
```

# layout - css布局属性clear和clearfix

> ID：11851085
> 
> 赞同：0
> 
> 时间：2012-08-07T17:28:56.667
> 
> 标签：layout, clearfix

我已经清楚地阅读了 CSS 布局属性

但是 clearfix 它的 css 属性或其他什么。

它可以用于浮动布局。

但我想解释一下 css clearfix 是 css 的这个属性还是用户定义的类或什么

我知道我提出问题的方式令人困惑

但我想知道是 clearfix iscss 类还是用户定义的

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:51:27.583

在网上搜索后，我找到了这篇文章

[http://thinkvitamin.com/design/everything-you-know-about-clearfix-is-wrong/](http://thinkvitamin.com/design/everything-you-know-about-clearfix-is-wrong/)

# ehcache - 使用分布式缓存解决方案的开源应用程序

> ID：11851086
> 
> 赞同：2
> 
> 时间：2012-08-07T17:28:57.930
> 
> 标签：ehcache, distributed-computing, distributed-caching, hazelcast, infinispan

我正在寻找使用分布式缓存解决方案（如 ehcache、infinispan、Hazelcast 等）的开源 Java 应用程序列表？

对于我的研究，我正在更改这些缓存的锁定行为并尝试了解性能变化。为了证实我的结果，我想使用一些生产级别的真实世界应用程序，而不是一些虚拟缓存访问模式生成器。有人可以提供 5-6 个在分布式环境中使用这些产品的优秀开源项目的列表吗？

否则有人可以提供需要高并发性的基于开源分布式计算的 Java 项目的列表吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T12:06:06.543

以下是使用 Infinispan 的一些开源项目的列表：

*   JBoss 应用服务器 7
*   休眠 ORM (2LC)
*   休眠 OGM
*   模式形状
*   阿帕奇骆驼
*   海角矮人

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T11:37:29.877

以下是使用 Hazelcast 的几个开源项目的列表

*   阿帕奇托斯卡纳
*   露天
*   东方数据库
*   顶点x
*   Mozilla 指标：几个项目，如 baghera、socorro 等。

# c# - 如何打开在屏幕中间以一定大小打开的文件夹

> ID：11851088
> 
> 赞同：0
> 
> 时间：2012-08-07T17:29:03.587
> 
> 标签：c#, windows, resize, directory

如果“TotalFileCount”== 0，此代码将打开一个文件夹。我想打开该文件夹并将其置于屏幕中央，并且我希望它具有特定的大小。有没有办法在 C# 中做到这一点？

```
if (TotalFileCount == 0)
{
    MessageBox.Show("There are no files in this directory. Please add pictures to this folder: " + AppVars.PolicyImagesDirectory + " and try again.", "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error);
    btnBrowse.Focus();

    System.Diagnostics.Process process = new System.Diagnostics.Process();
    process.StartInfo.FileName = AppVars.PolicyImagesDirectory;
    process.Start(); 
 } 
```

当新的 Windows 资源管理器窗口打开时，我可以将其设置为特定大小并在屏幕上居中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:39:52.203

从进程中获取句柄，然后从 win32 api 调用本机 SetWindowPos

```
process.handle //to get the handle of the window.

[DllImport("user32.dll", SetLastError=true)]
public static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int W, int H, uint uFlags); 
```

# ruby-on-rails - 在 Ruby on Rails 中将变量从视图传递到控制器

> ID：11851090
> 
> 赞同：1
> 
> 时间：2012-08-07T17:29:08.977
> 
> 标签：ruby-on-rails, ruby

这是控制器中的方法：

```
def sort
    case params[:order_param]
    when "title"  
    @cars = Movie.find(:all, :order => 'title')
    when "rating"
    @cars = Movie.find(:all, :order => 'rating')
else "release"
    @cars = Movie.find(:all, :order => 'release_date')
end
    redirect_to cars_path
end 
```

这是视图：

```
%th= link_to "Car Title", :action => 'sort', :order_param => 'title'
%th= link_to "Rating", :action => 'sort', :order_param => 'rating'
%th= link_to "Release Date", :action => 'sort', :order_param => 'release' 
```

如果我打开索引页面，则会出现以下错误消息：

```
No route matches {:action=>"sort", :order_param=>"title", :controller=>"cars"} 
```

“rake routes”命令的结果

```
cars      GET    /cars(.:format)          {:action=>"index", :controller=>"cars"}
          POST   /cars(.:format)          {:action=>"create", :controller=>"cars"}
new_car   GET    /cars/new(.:format)      {:action=>"new", :controller=>"cars"}
edit_car  GET    /cars/:id/edit(.:format) {:action=>"edit", :controller=>"cars"}
car       GET    /cars/:id(.:format)      {:action=>"show", :controller=>"cars"}
      PUT    /cars/:id(.:format)      {:action=>"update", :controller=>"cars"}
      DELETE /cars/:id(.:format)      {:action=>"destroy", :controller=>"cars"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:43:45.410

首先把它擦干。不需要那个开关/外壳。

```
def sort
  @cars = Movie.order(params[:order_param])
  redirect_to cars_path
end 
```

其次，您的文件中似乎没有`sort`定义路由`routes.rb`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T19:15:06.827

您根本不需要排序方法（或重定向）。您可以将该代码放入您的 index 方法中，因为您想显示 index.html.haml （排序“汽车”不应该将您发送到新页面，对吗？）

```
def index                                                                      
  order_param = params[:order_param]                              
  case order_param                                                                
  when 'title'                                                                 
    ordering = {:order => :title}
  when 'release_date'                                                          
    ordering = {:order => :release_date}
  end

  @cars = Movie.find_all(ordering)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T21:22:30.333

感谢大家的帮助，这是我正在寻找的解决方案（与 mehtunguh 解决方案非常相似）。很抱歉造成误解，我是rails新手。

```
 def index
    case params[:order_param]
    when "title"  
          @cars = Movie.find(:all, :order => 'title')
    when "rating"
          @cars = Movie.find(:all, :order => 'rating')
    when "release"
          @cars = Movie.find(:all, :order => 'release_date')
    else
          @cars = Movie.all
      end
  end 
```

# twitter - 带有 OAuth2 的 Twitter API

> ID：11851097
> 
> 赞同：0
> 
> 时间：2012-08-07T17:29:33.160
> 
> 标签：twitter, oauth-2.0

我正在尝试使用 Twitter API，我按照[http://code.google.com/p/python-twitter/](http://code.google.com/p/python-twitter/)的指示 安装了所有必需的项目，当我测试它时出现 17 个错误。当我尝试导入 twitter 时，它给了我：

```
File "C:\Python27\lib\site-packages\twitter.py", line 65, in <module>
import oauth2 as oauth
ImportError: No module named oauth2 
```

我已经查看了有关此主题的各种问题，但没有一个对我有用，或者可能是因为我做错了什么。非常迷茫，因为我似乎安装了所有正确的文件等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T16:33:43.107

使用`easy_install`绕过了我在依赖项和安装方面遇到的所有问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:32:27.483

你的 python 环境中安装了 oauth2 吗？

[http://pypi.python.org/pypi/oauth2/](http://pypi.python.org/pypi/oauth2/)

也许还可以查看适用于您的操作系统的 python-oauth2 包？（[Ubuntu](https://launchpad.net/ubuntu/+source/python-oauth2/) | [Debian](http://packages.debian.org/sid/python-oauth2) | [Fedora](https://admin.fedoraproject.org/pkgdb/acls/name/python-oauth2?_csrf_token=8dcebc90e3cd0bc2e47f04fef4558c02999ff57c)）

# cocos2d-iphone - 确定附着在绳索上的物体何时移动了特定距离

> ID：11851098
> 
> 赞同：0
> 
> 时间：2012-08-07T17:29:46.027
> 
> 标签：cocos2d-iphone, box2d, physics, game-physics, box2d-iphone

使用 Cocos2d 和 Box2d，我制作了一根由旋转关节段组成的绳索，其主体连接到我使用鼠标关节移动的最低段（weldJoint）。绳子垂下来。我如何设置条件来判断附加的身体何时覆盖了它在相反方向滑动的距离的两倍（mouseJoint）。例如，如果我将身体（附在绳子上）向左滑动 45 度，我应该知道（可能通过某些消息或其他东西）它何时向右摆动 45 度。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T21:49:51.203

也许我过于简单化了，但是您是否尝试在发布时添加传感器（[Box2dManual](http://www.box2d.org/manual.html)的第 6.3 节）？如果你的物理非常简单，你应该能够在与释放点相同的 Y 上添加它，并使其 X 围绕关节位置翻转。

# java - 在不合并两个数组的情况下对显示的结果进行排序

> ID：11851099
> 
> 赞同：0
> 
> 时间：2012-08-07T17:29:49.990
> 
> 标签：java, jsp, sorting, servlets, struts

我的表单中有两个数组，如下所示，我正在使用 jsp 向用户显示数组的值。

```
Trip[] tripArray = new Trip[];
Route[] routeArray = new Route[];

Trip Class: 
public class Trip{
    private String name; 
    private String address; 
    private String job; 
}

Route class: 
public class Route{
    private String myName; 
    private String myAddress;
    private String myJob; 
} 
```

我的jsp文件：

```
<logic: notEmpty name="myForm" property="tripArray">
<logic:iterate id="data" name="myForm" property="tripArray" type="com.example.Trip">
    <td><bean:write name="data" property="name" /></td>
    <td><bean:write name="data" property="address"/></td>
    <td><bean:write name="data" property="job"/></td>
</logic:iterate>
</logic:notEmtpty>

<logic: notEmpty name="myForm" property="routeArray">
<logic:iterate id="data" name="myForm" property="routeArray" type="com.example.Route">
    <td><bean:write name="data" property="myName" /></td>
    <td><bean:write name="data" property="myAddress"/></td>
    <td><bean:write name="data" property="myJob"/></td>
</logic:iterate>
</logic:notEmtpty> 
```

我希望能够对正在显示的结果进行排序。由于我有两个数组，我可以合并这两个数组，对其进行排序并使用新的合并数组显示结果。

但这也需要我更改我的 jsp 文件。而且我相信这样做的工作量太大了。

有没有另一种方法可以做到这一点而无需更改我的 jsp 文件并且无需合并数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:33:23.747

使用 Arrays.sort 对数组进行排序：

```
 String[] examples = new String[] {"test", "a", "long one", "", "one was blank (this is longest)"};
    Arrays.sort(examples, new Comparator<String>() {

        @Override
        public int compare(String arg0, String arg1) {
            if(arg0.length() < arg1.length())
                return -1;
            if(arg0.length() > arg1.length())
                return 1;
            return 0;
        }

    });
    System.out.println(Arrays.toString(examples)); 
```

会有输出：

```
[, a, test, long one, one was blank (this is longest)] 
```

我在那里设置的比较器设置为先有最短的，最后有最长的；您可以根据需要调整比较器。

# wordpress - 会话变量不工作 Firefox 和 Wordpress

> ID：11851100
> 
> 赞同：2
> 
> 时间：2012-08-07T17:30:25.610
> 
> 标签：wordpress, session-variables

好的，这是绝望，我已经尝试了所有我能找到的修复方法，但没有运气。我在 wordpress 中使用会话变量，它在除 Firefox 之外的所有浏览器中都能正常工作。我已经清除了缓存、cookies、以安全模式启动等，但没有任何乐趣。启用了 Cookie，我也在不同的电脑上尝试过。

我在我的主题函数文件中启动会话，如下所示：

```
function myStartSession() {
if(!session_id()) {
    session_start();
 }
}
add_action('init', 'myStartSession', 1); 
```

然后在我的个人页面模板上创建会话变量，如下所示： $_SESSION['hq'] = 1;

我可以确认 sessionid 在每个浏览器中都保持不变并且工作正常，包括 Firefox，但是在 FF 中，会话变量没有正确地从一个页面传递到另一个页面，结果是不可预测的。

非常欢迎任何解决方案/建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T02:11:42.003

这不是一个全新的问题，但由于我一直在寻找解决方案并来到这里，我会回答它以帮助其他程序员。

我开发的 WordPress 主题也有类似的问题，我在 StackExchange 的这篇文章中找到了解决方案：[https ://wordpress.stackexchange.com/questions/40271/2-different-post-ids-for-single-page -load-only-in-firefox](https://wordpress.stackexchange.com/questions/40271/2-different-post-ids-for-single-page-load-only-in-firefox)

由于 Firefox 的预取，下一篇文章/页面会在后台加载，并且会话会受到此行为的影响。

至少有两种可能的解决方案来解决这个问题：

1.  `<head>`使用以下函数调用删除在页面中插入下一页/帖子的操作：

    ```
    remove_action('wp_head', 'adjacent_posts_rel_link_wp_head'); 
    ```

    它可以添加到您的主题`functions.php`文件中。

2.  检查请求标头以处理（或忽略）预取。所有预取请求都使用特殊的标头发送到服务器，如下所示：

    ```
    X-moz: prefetch 
    ```

    您可以查找此标头并以不同的方式处理请求。

# hibernate - Hibernate 在多对一中生成 m + 1 个查询

> ID：11851101
> 
> 赞同：8
> 
> 时间：2012-08-07T17:30:29.697
> 
> 标签：hibernate, lazy-loading

我的问题很简单，但我不知道如何让 Hibernate 以我想要的方式运行： - 表 MainTable 有 Many-2-One 和 ParentTable（有 100 行）。MainTable 指向 ParentTable 中 100 行中的 m=26 行

```
@ManyToOne(fetch = FetchType.EAGER)
@JoinColumn(name = "PARENT_ID")
@Fetch(FetchMode.JOIN) 
```

当我简单地查询“来自 MainTable”时

它将生成 26 + 1 个查询

当我跟踪查询时，第一个查询仅加载 26 个后续查询使用的 PARENT_ID。我想它应该有办法在第一个查询中加载整个 PARENT_TABLE ..

请帮助假设：

*   FetchType.EAGER 是必须的
*   使用**from MainTable mt left join fetch mt.parent parent**是可以的，但我们有很多关联

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-08-13T13:48:49.893

```
 // Annotate ParentTable Persistance class file with a batch Size 
 @BatchSize(size=100)
 class ParentTable{
     ..
 } 
```

* * *

```
@ManyToOne
@JoinColumn(name = "PARENT_ID") 
```

这将使查询次数减少 n/100+1。

这个问题的原因是，休眠将在内部以惰性模式获取数据，（*我不是在谈论`FetchMode.Lazy`*）。使用 可以排除 Lazy 模式`FetchMode.SUBSELECT`，该模式仅适用于集合。当涉及到 时`@ManyToOne`，您可以`batch`通过指定`batchSize`.

**关于 Fetch Startegies 的简短描述**

`FetchMode.SUBSELECT`

> 一个查询父表，一个查询相关表。仅适用于 Collections 框架。仅触发了 2 个查询。

`FetchMode.SELECT`

> 一次查询父项，N 次查询子项。

`FetchMode.JOIN`

> 一个父查询，N 个子查询，但数据库检索在 JOIN 中预先进行。

`FetchType.Batch`

> 一个父查询和 n/batchSize + 1 个已触发的查询数。

* * *

**根据应该执行查询的时间，有两种类型的获取。**

`FetchType.EAGER`：

> 查询会立即触发。

`FetchType.LAZY`：

> 访问子对象时会触发查询。因此，执行的查询数量将取决于访问的子对象的数量。

[**Fetch Strategies 的工作原理在这里得到了更好的解释**](https://stackoverflow.com/a/18605401/1844148)。

# c++ - “错误：在使用 std::string 时不匹配 'operator<<”

> ID：11851104
> 
> 赞同：5
> 
> 时间：2012-08-07T17:30:46.030
> 
> 标签：c++, string, iostream

您能否帮我找出以下代码中的问题（代码类似于[重载 operator<< 时作为参数的 C++ 流](https://stackoverflow.com/questions/2803403/c-stream-as-a-parameter-when-overloading-operator)）：

```
#include <iostream>
#include <string>

class logger
{
  public:
    void init( std::ostream& ostr )
    {
        stream = &ostr;
    }

    template< typename t >
    logger& operator <<( t& data )
    {
        *stream << data;
        return *this;
    }

    logger& operator <<( std::ostream& (*manip)(std::ostream &) )
    {
        manip( *stream );
        return *this;
    }

    logger& operator <<( std::ios_base& (*manip)(std::ios_base&) )
    {
        manip( *stream );
        return *this;
    }

  private:
    std::ostream* stream;
};

int main( int argc, char* argv[] )
{
    logger log;
    log.init( std::cout );
    log << "Hello" << std::endl;
    //log << std::string( "world" ) << std::endl;

    return 0;
} 
```

一切正常，直到我取消注释包含“世界”的行。在这种情况下，GCC 会产生错误：no match for 'operator<<' in ...

有趣的是VS2008对这段代码没有任何问题。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-07T17:32:52.663

`std::string( "world" )`创建一个不能绑定到非常量引用的临时对象。将 const 添加到参数中：

```
template< typename t >
logger& operator <<( t const& data )
{
    *stream << data;
    return *this;
} 
```

编辑：刚刚注意到您提到这在 MSVS 中有效。那是因为 MS 语言扩展，可以关闭它也会显示错误。每当我使用 MSVS 时，我都会关闭语言扩展。

# javascript - 原型设计“论据”

> ID：11851107
> 
> 赞同：3
> 
> 时间：2012-08-07T17:30:53.003
> 
> 标签：javascript, jquery, prototypejs, mootools

**介绍**

我们都知道这些愚蠢`arguments`的 JavaScript 函数对象。

> 但为什么反对？不是数组吗？

不，不是，这就是为什么很多人称其为 JavaScript 概念的失败：

```
(function () {
    return arguments.slice(); // TypeError: arguments.slice is not a function
}()); 
```

* * *

**意图**

好的，这只是我想问的真实情况的介绍，但在问之前您需要更多信息：

在最后几天阅读不同的代码时，在很多地方看到以下代码行时，我感到非常害怕。

```
args = Array.prototype.slice(arguments); 
```

所以，它的作用是简单地将`arguments`对象“转换”为包含所有原型和内容的数组。

* * *

**我的解决方案**

我想到的是：虽然 JavaScript 都是关于原型设计的，但我们为什么不扩展`arguments`对象`prototype`本身呢？我检查了一些网站的现有脚本，但没有发现任何我想要找到的东西，最后我自己写了：

```
(function () {
    var i, methods;

    arguments.constructor.prototype = Array.prototype;
    methods = ['concat', 'join', 'pop', 'push', 'reverse', 'shift', 'slice', 'sort', 'splice', 'toString', 'unshift'];

    for (i = 0; i < methods.length; i += 1) {
        if (arguments.constructor.prototype.hasOwnProperty(methods[i]) === false) {
            arguments.constructor.prototype[methods[i]] = Array.prototype[methods[i]];
        }
    }
}()); 
```

压缩后它只需要 260 字节，并`arguments`通过`prototype`使用`Array.prototype`.

所以最后我可以像处理`arguments`“真实”数组一样处理对象。

* * *

**问题**

在检查了最著名的 JavaScript 框架后，我完成了以下操作：没有使用这种结构并扩展了`arguments`对象的`prototype`.

但为什么？有什么问题吗，我现在没有想到？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T17:40:11.773

`arguments`对象不是类型，它是泛型的`Object`。为了扩展它的原型，您必须扩展 的原型`Object`，这通常不是一个好主意。

`arguments`使用 . 转换为 Array没有任何问题`Array.prototype.slice`。

假设我要扩展`arguments`原型：

```
arguments.constructor.prototype.foo = 'bar'; 
```

这里的问题是这`arguments.constructor`不是某个`Argument`对象，它只是`Object`. 现在，如果我尝试做一些应该正常工作的事情，那就太可怕了：

```
var someNewObject = {
    someProperty: 'someValue'
};

for (var item in someNewObject) {
    console.log(item);  // logs someProperty AND foo, not good
} 
```

[您可以在这里](http://jsfiddle.net/JYpPS/)看到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:37:44.010

通常，大多数人都回避更改 ECMAScript/JavaScript 原生对象。就个人而言，我喜欢你的方法（它聪明而有用）；但是，当您将代码引入更大的项目时，就会引入问题。当浏览器对 Array（本机）对象的实现不同于标准并且其他代码库（如 jQuery）以特定的期望处理该对象时，可能会出现意想不到的后果。但是，如果 jQuery 期望函数的参数属性 (/object) 是某种类型并且它已被更改，例如被您的代码更改，那么您很可能会破坏像 jQuery 这样的广泛使用的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:39:57.700

它有效吗？;-)

如果是这样，我认为你已经实现了你想要的。但是，arguments 不是数组的一个原因可能是 arguments 变量并不意味着像普通变量一样四处传播。它只能在函数体内访问，然后被丢弃。因此，我不知道当它突然变成一个数组*时会发生什么。*

除此之外，聪明的解决方案！

# spring-batch - Spring批处理编写器，处理器在跳过时调用了两次？

> ID：11851111
> 
> 赞同：1
> 
> 时间：2012-08-07T17:30:59.013
> 
> 标签：spring-batch

我有一个关于跳过的非常基本的问题。我正在使用 spring 示例提供的 spring-batch-simple-cli 项目，并试图了解跳过行为。这有一个非常基本的示例阅读器，它从字符串数组中读取（我已将其修改为从从 Hellowworld 1 到 Hellowworld 10 的 10 个字符串列表中读取）和一个记录到控制台的基本编写器。writer 在每次写入时抛出 java.lang.Exception。我在作业配置中添加了 4 的跳过限制。一旦到达 Hellowworld 5，作业就会按预期停止。但是每当 writer 抛出异常时，都会立即用相同的项目回调 writer。我的问题为什么作家被称为两次？我期待这个项目被跳过？有什么我想念的吗？

```
<job id="job1" xmlns="http://www.springframework.org/schema/batch" incrementer="jobParametersIncrementer">
    <step id="step1" parent="simpleStep">
        <tasklet>
            <chunk reader="reader" writer="writer" skip-limit="4" >
                <skippable-exception-classes>
                    <include class="java.lang.Exception" />
                </skippable-exception-classes>
            </chunk>
        </tasklet>
    </step>
</job> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T13:19:13.687

这很可能是由默认功能引起的，其中 Spring Batch 回滚块并再次重试每个块项目（在这种情况下只有一个项目）。

[https://stackoverflow.com/a/6730807/1627688](https://stackoverflow.com/a/6730807/1627688)

# sql - Microsoft Access 在具有已知值的表中查找字段

> ID：11851114
> 
> 赞同：1
> 
> 时间：2012-08-07T17:31:11.163
> 
> 标签：sql, vba, ms-access, odbc

我们有一个相当大的 Oracle 数据库，我们可以通过 Microsoft Access 和 ODBC 以只读访问权限进行连接。我们使用的前端系统与幕后结构不匹配，我经常需要通过 Microsoft Access 查询系统。问题是我们没有提供任何关于结构的文档，结构需要认真注意。搜索我需要的字段非常耗时。

使用我们的前端，我可以查看我想要查询的值，并且我知道关键字段，但我需要找到包含已知值的字段。

如果我有一条我知道字段“A”的值的记录，并且有字段“X”的值，是否可以查询字段“X”？

前端展示

```
Student ID: 12345678
Payments: 23456 
```

后端

```
TechID: 12345678
???: 23456 
```

我可以查询“？？？”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:39:54.207

您可以通过迭代表的集合以及每个表的字段集合来完成此操作。

```
Open Database
Get all Tables
For Each Table
   Get all Fields
   For Each Field
       If Field type is text ... and
       If Field size is not TOO Long ...
           Search for string
           If found, write to a results bucket
   Next
Next 
```

这是编目表的代码示例（来源[here](http://www.profinvent.com/index.php/ms-office-reports-and-apps?id=97)）

```
Public Function GenerateDataDictionary(aDataDictionaryTable As String)
'***       Usage: GenerateDataDictionary("MyDataDictionaryTable")
'*** Extracts the information about the tables for the data dictionary 
'*** and inserts it to a table named aDataDictionaryTable

    Dim tdf As TableDef, fldCur As Field, colTdf As TableDefs
    Dim rstDatadict As Recordset
    Dim i As Integer, j As Integer, k As Integer
    Set rstDatadict = CurrentDb.OpenRecordset(aDataDictionaryTable)
    Set colTdf = CurrentDb.TableDefs

    'Go through the database and get a tablename   
    For Each tdf In CurrentDb.TableDefs
    'Do what you want with the table names here.
    rstDatadict.AddNew
    rstDatadict.Update   
rstDatadict.AddNew
    rstDatadict![Table] = tdf.NAME
    rstDatadict![Field] = "----------------------------"
    rstDatadict![Display] = "----------------------------"
    rstDatadict![Type] = ""
    rstDatadict.Update
    rstDatadict.AddNew
    rstDatadict![Table] = "Table Description:"
    For j = 0 To tdf.Properties.Count - 1
          If tdf.Properties(j).NAME = "Description" Then
              rstDatadict![Field] = tdf.Properties(j).Value
          End If
    Next j

    rstDatadict.Update 
    rstDatadict.AddNew
    rstDatadict.Update

For i = 0 To tdf.Fields.Count - 1
          Set fldCur = tdf.Fields(i)          
          rstDatadict.AddNew
          rstDatadict![Table] = tdf.NAME
          rstDatadict![Field] = fldCur.NAME
          rstDatadict![Size] = fldCur.Size

          Select Case fldCur.Type
            Case 1
              FieldDataType = "Yes/No"
            Case 4
              FieldDataType = "Number"
            Case 8
              FieldDataType = "Date"
            Case 10
              FieldDataType = "String"
            Case 11
              FieldDataType = "OLE Object"
            Case 12
              FieldDataType = "Memo"
            Case Else    ' Other values.
              FieldDataType = fldCur.Type
          End Select

          rstDatadict![Type] = FieldDataType                                
                For j = 0 To tdf.Fields(i).Properties.Count - 1
                    If fldCur.Properties(j).NAME = "Description" Then
                        rstDatadict![DESCRIPTION] = fldCur.Properties(j).Value
                    End If

                    If fldCur.Properties(j).NAME = "Caption" Then
                        rstDatadict![Display] = fldCur.Properties(j).Value
                    End If

                    If fldCur.Properties(j).NAME = "Rowsource" Then
                        rstDatadict![LookupSQL] = fldCur.Properties(j).Value
                    End If
                Next j

            rstDatadict.Update

    Next i
    Debug.Print "  " & tdf.NAME
    Next tdf

End Function 
```

您可以通过制作一个连接到表名表的字段名表来在 Access 中对您的发现进行分类。然后您的搜索将基于目录而不是原始集合。

我以这种方式对 MAS 90（带有 JobOps 插件）的架构进行了逆向工程。没有地图，但我有一个只读的 ODBC 连接，我完全按照您建议的方式使用它。采购会计师会给我一个独特的产品编号，我会通过这个综合引擎运行它。随着时间的推移，我成功地将 700 个表从 18k 个字段中提取到 20 个表和几百个字段。这使我们能够导出我们的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:20:57.857

你的问题的答案很简单。不，你不能那样做。

我能想到两种解决方案。第一种是手动将所有值连接在一起，然后查找包含该值的行。这是不完美的，但可能有效：

```
select *
from (select t.*, ('|'""col1||'|'||col2+'|' . . .||'|') as allcols
      from t
     ) t
where instr('|23456|', allcols) > 0 
```

这将在列中找到具有该值的任何行。可能足够接近你想要的。

第二个是使用 UNPIVOT 做基本相同的事情。

我强烈建议您花一点时间来查找字段之间的映射，然后在 Oracle 中创建一个视图，该视图具有在应用程序中看到的字段名称。听起来这会在中期为您节省很多精力。

# jquery - 使用jquery调用json数组中的空白页highchart

> ID：11851122
> 
> 赞同：0
> 
> 时间：2012-08-07T17:31:54.177
> 
> 标签：jquery, highcharts, json

我有一个 php 页面（array.php）。在浏览器上，array.php 产生 ff 结果

```
[{"name":"London","data2":["70","19"]},{"name":"Tokyo","data2":["60","18"]}] 
```

array.php 页面

```
<?php
//header("Content-type: text/json");
header("Content-type: application/json");

$db = mysql_connect("localhost", "username", "userpasswd"); 
mysql_select_db("weather",$db);
$query = "SELECT * FROM measures";

$result = mysql_query($query,$db);

while($row = mysql_fetch_array($result))
{
$h = $row["humidity"];
$w = $row["windspeed"];
$t = $row["temperature"];
$c = $row["city"];
$ar1[] = array("name" =>$c,"data2"=>[$h,$t]);
}
echo json_encode($ar1);

?> 
```

jquery页面的代码是

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="./js/highcharts.js"></script>

<script type="text/javascript">

var chart = null;      // global
$(document).ready(function() {
chart = new Highcharts.Chart({
    chart: {
        renderTo: 'container',
        defaultSeriesType: 'column',
        events: {
            load: requestData
        }
    },
    title: {
        text: 'Real time data from database'
    },
    xAxis: {
            categories: []
        },
    yAxis: {
        minPadding: 0.2,
        maxPadding: 0.2,
        title: {
            text: 'Value',
            margin: 80
        }
    },
    series: []
});        
});

/**
 * Request data from the server
 */
function requestData() {

$.ajax({
    url: 'array.php',
    success: function(point) {

    $.each(point, function(i,item){
        var series_name = item.name;
        var series_data = item.data2;

        var series = {data: []};

        chart.xAxis.categories.push(series_name);
        //chart.series.data.push(item.data2);

        $('body').append( "Name: " + series_name);
        alert(series_data);

    });

    },
    cache: false
});
}

</script>

</head>

<body>

<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
</body>
</html> 
```

虽然代码不完整。但在错误修复之前，我无法继续前进。如果我运行 html 代码，alert 函数通过循环并警告来自 array.php 的每个数据来很好地工作。但是如果我取消注释

```
//chart.xAxis.categories.push(series_name); or //chart.series.data.push(item.data2); 
```

然后警报功能不再起作用。我有一种感觉，它无法识别变量（图表）。我之前已经声明过

```
$(document).ready(function() { 
```

所以它将是一个全局变量，但似乎并非如此。

拜托，我真的需要帮助。我已经为此工作了几天，但没有成功。我将深深感激。提前致谢 - 艾玛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:37:43.903

您真的需要进行 Ajax 调用吗？php页面处理过程中不能推送数据吗？我没有看到您对图表进行任何循环或实时更新，您只是想在加载时加载数据，而不是 Ajax，我建议直接使用 php。

就您的问题而言，是的图表在您尝试访问它时没有实例化。我试图重现您的问题@ [http://jsfiddle.net/jugal/Zjket/](http://jsfiddle.net/jugal/Zjket/)以下是我的发现

![在此处输入图像描述](../Images/73c88ccf49e81a5e3e724081a101e7ae.png)

`requestData`在调用 Highchart 的构造函数期间调用该方法。所以？这意味着构造函数调用尚未完成，因此对象 ( `chart`) 尚未实例化。Highchart 还支持将回调方法作为其构造函数的第二个参数，它在构造后调用它（但仍然来自构造函数，只是你的图表现在在内部准备好了，但构造函数调用尚未返回给它的调用者）作为`chart = new Highcharts.Chart({...},requestData)`但同样的问题仍然存在。奇怪的？并非如此，requestData 方法是使用图表对象作为其上下文来调用的，这意味着虽然您不能使用该`chart`变量引用“图表”，但您可以访问它，`this`因为它`chart`是 requestData 的调用者。

不幸的是，您的问题现在刚刚达到下一个级别，但图表仍然不会显示数据，因为现在新的错误是，您的 json 格式不正确`[{"name":"London","data2":["70","19"]},{"name":"Tokyo","data2":["60","18"]}]`，数字不应该在引号内，而应该是`[{"name":"London","data2":[70,19]},{"name":"Tokyo","data2":[60,18]}]`您需要转换在将它们传递给 json_encode 之前将值转换为数字。修复此问题后，又遇到了一些错误。**此外，您实际上不应该将系列推送到`chart.series`对象，而是使用`chart.addSeries(...)`**@ [http://www.highcharts.com/stock/ref/#series](http://www.highcharts.com/stock/ref/#series)

更多的摆弄和调试让我找到了这个解决方案 [http://jsfiddle.net/jugal/JfgxX/](http://jsfiddle.net/jugal/JfgxX/)

```
 function requestData() {
 chart=this;
 $.ajax({
url: 'array.php',
success: function(point) {
    $.each(point, function(i,item){
    var series_name = item.name;
    var series_data = item.data2;
    var series = {data: item.data2,name:series_name};
    chart.addSeries(series);
});

},
cache: false
});
  } 
```

**编辑** 您的方法的另一种替代方法可以像@wergeld 提到的那样，首先进行 Ajax 调用，然后在该调用成功时创建图表，如下所示。小提琴@http [://jsfiddle.net/jugal/j4ZYB/](http://jsfiddle.net/jugal/j4ZYB/)

```
 var chart=null;
$(function() {
   requestData();
});

function requestData() {
     $.ajax({
    url: 'array.php',
     success: function(point) {
      var chartSeriesData=[];
         $.each(point, function(i,item){
         var series_name = item.name;
         var series_data = item.data2;     
         var series = {data: item.data2,name:series_name};
        chartSeriesData.push(series);
        });
     chart = new Highcharts.Chart({
    chart: {
        renderTo: 'container',
        defaultSeriesType: 'column'      ,      

    },
    title: {
        text: 'Real time data from database'
    },
    xAxis: {
            categories: []
        },
    yAxis: {
        minPadding: 0.2,
        maxPadding: 0.2,
        title: {
            text: 'Value',
            margin: 80
        }
    },
    series: chartSeriesData
});         
},
cache: false
});
  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:41:30.780

看起来您正试图在创建图表之前将数据推送到图表。您将图表声明为 NULL，是的，但是当图表 var 不知道它是什么时，它如何知道它应该将数据推送给它？似乎您的页面执行顺序是：

1.  声明图表
2.  通过ajax获取数据
3.  将数据推送到图表
4.  将图表声明为 Highcharts.Chart

为什么不从 ajax 调用中获取数据，然后在`$(document).ready(function() {`调用中推送到数据图表。这样您的操作顺序将是：

1.  通过ajax获取数据
2.  将图表声明为 Highcharts.Chart
3.  将数据推送到图表

# javascript - 将“snnnoooowww”匹配到“snow”的正则表达式

> ID：11851123
> 
> 赞同：2
> 
> 时间：2012-08-07T17:31:56.400
> 
> 标签：javascript, regex

我正在尝试编写一个正则表达式，它将匹配特定字符顺序内任意数量的特定字符。例如：

“ssssnnnowww”会匹配到“snow”，但“sssnnnsssooooowwww”不会匹配到“snow”

我尝试了以下方法：

```
/[s][n][o][w]/g // no luck
/s*n*o*w*/ // no luck 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-07T17:32:52.897

试试这个正则表达式：

```
/s+n+o+w+/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T13:28:05.373

永远记住，`*`它用于零次出现。所以你的正则表达式`/s*n*o*w*/`也会通过`now`, `sow`，甚至只是`o`。因此，在您的情况下，您需要`+`查找一个或多个事件。
正确的正则表达式：

```
/s+n+o+w+/ 
```

您的正则表达式`[s][n][o][w]`也会失败，因为它会以正确的顺序查找恰好出现的一次，因此会 pass `s` `n` `o`，但不会 pass 。`w``snow``snnoooow`

# ant - 如何从 Ant 确定 Jenkins 构建目录？

> ID：11851128
> 
> 赞同：8
> 
> 时间：2012-08-07T17:32:11.493
> 
> 标签：ant, jenkins

我正在尝试迁移我编写的 Ant 脚本，以从 Jenkins 框架内构建和部署项目（而不是从 SVN 提交后挂钩触发，这是我们最初处理事情的权宜之计）。一切都很好，除了我需要为部署步骤暂存文件，并且我想将它们填充到 Jenkins 为该工作创建的“构建”目录中（并且由于我的 build.xml 位于非项目特定的位置，${ basedir} 和 ${user.dir} 不指向所需的位置）。

在 Jenkins 配置中，我设置了以下内容：

[Jenkins] 构建记录根目录：E:/builds/${ITEM_FULLNAME}

[作业特定] 构建文件：C:\vc-tools\shadow\build.xml

运行构建时，会适当地启动脚本并创建特定于作业的构建目录，例如

E:\builds\Test\2012-08-07_12-51-21

我想从构建脚本中获取这个目录，但不知道如何。我尝试过的一些事情：

```
 [echo] ${basedir}: C:\vc-tools\shadow
 [echo] ${user.dir}: C:\vc-tools
 [echo] ${env.workspace}: C:\Program Files (x86)\Jenkins\workspace\Test
 [echo] ${env.build_id}: 2012-08-07_12-51-21
 [echo] ${jenkins_home}: C:\Program Files (x86)\Jenkins
 [echo] ${BuildDir}: E:/builds/${ITEM_FULLNAME} 
```

注意：对于最后一个，我尝试传入：

```
 BuildDir=E:/builds/${ITEM_FULLNAME} 
```

作为从 Jenkins 中的作业配置的属性（显然 ${} 扩展不会在这种情况下发生）。

根据[文档](https://wiki.jenkins-ci.org/display/JENKINS/Building+a+software+project#Buildingasoftwareproject-JenkinsSetEnvironmentVariables)，没有设置为完整构建目录路径的特定环境变量——我可以通过硬编码 E:\builds 根目录并添加 ${env.build_id} 来伪造它，但希望会有一种从 Jenkins 公开的内容（Ant 属性和环境变量）访问完整路径的更简单方法，以使脚本更加灵活。

我正在使用 Jenkins 版本 1.476。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-07T19:59:43.517

对于您的项目来说，在源代码旁边包含其构建逻辑的副本总是一个好主意。它使您的构建更易于跨机器移植。

话虽如此，设置包含通用共享构建逻辑的构建文件也很常见。ANT 定义了以下任务来支持此类活动：

*   [包括](http://ant.apache.org/manual/Tasks/include.html)
*   [进口](http://ant.apache.org/manual/Tasks/import.html)

因此，一个可能的解决方案是在项目目录的根目录中存储一个简单的 build.xml 文件：

```
<project name="my project" default="build">

  <include file="C:\vc-tools\shadow\common-build-1.0.xml" as="common"/>

  <target name="build" depends="common.build"/>

</project> 
```

**笔记：**

*   在通用构建文件名中使用修订号是个好主意。这有助于保持与使用旧逻辑的其他构建的向后兼容性。

# 更新

Jenkins 运行作业时会设置许多[环境变量](https://wiki.jenkins-ci.org/display/JENKINS/Building+a+software+project)。

以下 ANT 逻辑将打印 Jenkins 工作区目录的位置：

```
<property environment="env"/>

<target name="run">
    <echo message="Jenkins workspace: ${env.WORKSPACE}"/>
    <echo message="Job directory: ${env.WORKSPACE}../../jobs/${env.JOB_NAME}"/>
    <echo message="Build data: ${env.WORKSPACE}../../jobs/${env.JOB_NAME}/build/${env.BUILD_ID}"/>
</target> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-02T09:25:28.713

这些天（Jenkins v. 1.484）上面答案中的“运行”目标应该如下所示：

```
<target name="run">
    <echo message="Jenkins workspace: ${env.WORKSPACE}"/>
    <echo message="Job directory: ${env.WORKSPACE}/../../${env.JOB_NAME}"/>
    <echo message="Build data: ${env.WORKSPACE}/../../${env.JOB_NAME}/builds/${env.BUILD_ID}"/>
</target> 
```

# spring - 在 Tomcat 上安装基于 spring 的应用程序

> ID：11851132
> 
> 赞同：0
> 
> 时间：2012-08-07T17:32:42.413
> 
> 标签：spring, jakarta-ee, tomcat, spring-security

我已经在 ROOT 和管理上下文中安装了应用程序。这两个应用程序都是在 Spring Framework 3.1.2 和 Maven 结构上创建的。当我尝试运行应用程序时出现错误：

```
Aug 7, 2012 5:20:54 PM org.apache.catalina.core.StandardContext loadOnStartup
SEVERE: Servlet  threw load() exception
java.lang.ClassNotFoundException: org.springframework.web.context.support.StandardServletEnvironment
    (...)
INFO: Initializing Spring root WebApplicationContext
Aug 7, 2012 5:21:08 PM org.apache.catalina.core.StandardContext filterStart
SEVERE: Exception starting filter springSecurityFilterChain
org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'springSecurityFilterChain' is defined
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:529)
    (...) 
```

我的类路径中有spring-web。我的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:root-context.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <listener>
        <listener-class>
            org.springframework.web.context.request.RequestContextListener
        </listener-class>
    </listener>
    <filter>
        <filter-name>sitemesh</filter-name>
        <filter-class>org.sitemesh.config.ConfigurableSiteMeshFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>sitemesh</filter-name>
        <url-pattern>/*</url-pattern>
        <dispatcher>FORWARD</dispatcher>
        <dispatcher>REQUEST</dispatcher>
    </filter-mapping>
    <filter>
        <filter-name>SetCharacterEncodingFilter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF8</param-value>
        </init-param>
        <init-param>
            <param-name>forceEncoding</param-name>
            <param-value>true</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>SetCharacterEncodingFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <filter>
        <filter-name>hibernateFilter</filter-name>
        <filter-class>org.springframework.orm.hibernate4.support.OpenSessionInViewFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>hibernateFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>appServlet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
    <error-page>
        <error-code>404</error-code>
        <location>/error/404.html</location>
    </error-page>
    <error-page>
        <error-code>500</error-code>
        <location>/error/500.html</location>
    </error-page>
    <session-config>
        <session-timeout>30</session-timeout>
    </session-config>
</web-app> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:49:12.103

在您的应用程序上下文中（或通过注释），您没有使用名称 springSecurityFilterChain 定义的 bean。

# bash - 从 groovy 运行外部进程

> ID：11851137
> 
> 赞同：2
> 
> 时间：2012-08-07T17:33:08.600
> 
> 标签：bash, groovy, external-process

我有一个 bash 脚本，我想从 groovy 中执行它

```
some_shell_script.sh param1 "report_date=`some_function 0 \"%Y%m%d\"`" 
```

该脚本从命令行成功运行，但是当我尝试从 Groovy 执行它时

```
def command = "some_shell_script.sh param1 "report_date=`some_function 0 \"%Y%m%d_%H%M%S\"`""
def sout = new StringBuffer()
def serr = new StringBuffer()
//tried to use here different shells /bin/sh /bin/bash bash 
ProcessBuilder pb = new ProcessBuilder(['sh', '-c',command])
Process proc = pb.start()
proc.consumeProcessOutput(sout, serr)

def status = proc.waitFor()

println 'sout: ' + sout
println 'serr: ' + serr 
```

我有以下错误

```
serr: sh: some_function: command not found 
```

同时

```
which some_function 
```

返回函数定义，如

```
some_function ()
{
;some definition here
} 
```

看起来当我从 groovy 运行外部脚本时，它会在没有父进程上下文的情况下启动不同的进程。我的意思是不存在父进程的函数定义。

任何人都知道如何应对这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:27:36.727

您应该用单引号替换命令定义中的双引号。

`def command = 'some_shell_script.sh param1 "report_date=`some_function 0 "%Y%m%d_%H%M%S"`'`

添加：

```
println command 
```

以确保您正在执行正确的命令。

还要打开一个新的 bash shell 并确保`some_function`已定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:41:21.320

这似乎是一个路径问题。您可以将完整路径放入脚本并重试吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T22:30:31.687

一定要查看@Reimeus 指出的那些引号。我对这些有些怀疑。

此外，当您以交互方式运行 bash 时，`some_function()`可以在其中定义或在其中任何一个来源的文件中定义。如果您运行脚本，则不会发生这种情况。（这有利于使脚本以可预测的方式运行 - 你不能让你的脚本依赖于人们的登录环境。）`~/.bashrc``/etc/bash.bashrc`

如果是这种情况，请将 some_function() 移动到另一个文件，并将其完整路径放在 BASH_ENV 变量中，以便 bash 在处理脚本时选择它。

男子重击：

```
 When  bash  is  started  non-interactively,  to run a shell script, for
   example, it looks for the variable BASH_ENV in the environment, expands
   its  value if it appears there, and uses the expanded value as the name
   of a file to read and execute.  Bash behaves as if the  following  com-
   mand were executed: 
```

```
 if [ -n "$BASH_ENV" ]; then . "$BASH_ENV"; fi 
```

```
 but  the  value of the PATH variable is not used to search for the file
   name.
   [Manual page bash(1) line 158] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T20:51:58.557

**免责声明：***此*解决方案存在局限性，**并且**在部署之前应正确测试 shell 子脚本命令。但是，如果不需要多线程，*例如*该*函数*立即提供一些简短的结果，那么我在[此处](http://code.google.com/p/blu-strglr-grovecell/source/browse/Grovecell/src/net/strglr/blu/doctool/taglet_module.groovy#564 "这里")实现了另一种选择。

*例如*，如果结果`mycmd`取决于设置的环境变量，`~/.bashrc`我可以显示它的结果：（作为 groovy-script/v1.8.1 尝试，是的，这是一个愚蠢的例子，它可能有风险！）

```
commands = '''source ~/.bashrc; cd ~/mytest; ./mycmd'''
"bash".execute().with{
  out << commands
  out << ';exit $?\n'
  waitFor()
  [ok:!exitValue(), out:in.text, err:err.text]
}.with{ println ok?out:err } 
```

# php - php: 非对象错误 - 数组输出到表 - PHP 5.3 之前的准备好的语句

> ID：11851138
> 
> 赞同：0
> 
> 时间：2012-08-07T17:33:09.087
> 
> 标签：php, mysql

非对象错误错误：在非对象上调用成员函数 fetch_assoc()

我的代码：

```
 if($stmt = $dbc->prepare($query)) {
    $stmt->bind_param('s', $search_term);
    $stmt->execute();
    $stmt->bind_result($bookid, $title, $author, $genre, $isbn, $url);

echo '<table><tr>
<th><a href="browse.php?sort=bi">ID</th>
<th><a href="browse.php?sort=t">Title</a></th>
<th><a href="browse.php?sort=a">Author</th>
<th><a href="browse.php?sort=g">Genre</th>
<th>ISBN</th>
<th>URL</th>
</tr>';

 // array to hold all rows 
    $rowset = array(); 

   // All results bound to output vars 
   while ($stmt->fetch()) { 
       // Append an array containing your result vars onto the rowset array 
            $rowset[] = array( 
            'bookid' => $bookid, 
            'title' => $title, 
            'author' => $author, 
           'genre' => $genre,
          'isbn' => $isbn,
          'url' => $url 
           );
    } // End Fetch

    $size = count($rowset);

    for ($i=0; $i <$size; $i++){
            $row = $rowset->fetch_assoc();  // Error is on this line 
```

我是准备好的陈述的新手，但那部分正在工作。我读到： [使用准备好的语句编写查询的分页结果集，](https://stackoverflow.com/questions/10806038/paginate-result-set-having-written-the-query-with-prepared-statements) .

因为我的服务器有 PHP 5.2.17，所以我不能使用 get_result()。所以我按照文章所说的建立了一个数组。我可以 var_dump 它（所以查询有结果），但我想输出到表中。我尝试了不同的方法来输出查询，一切似乎都回到了这个非对象错误。在网上搜索时，我感到很困惑，因为 OOP 文章涉及的主题比我目前所能做的更高级。所以我希望有人能指出我正确的方向。

预先感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:35:22.540

错误消息说明了一切。`$rowset`不是对象，因此没有名为 的成员函数`fetch_assoc()`。

此代码设置`$rowset`为关联数组的数组。

```
$rowset = array(); 

// All results bound to output vars 
while ($stmt->fetch()) { 
   // Append an array containing your result vars onto the rowset array 
        $rowset[] = array( 
        'bookid' => $bookid, 
        'title' => $title, 
        'author' => $author, 
       'genre' => $genre,
      'isbn' => $isbn,
      'url' => $url 
       );
} // End Fetch 
```

`fetch_assoc()`是`mysqli_result`对象的成员函数。（[文档在这里](http://php.net/manual/en/mysqli-result.fetch-assoc.php)。）

由于您已经将数据存储在数组 ( `$rowset`) 中，因此您可以使用循环遍历每个索引`foreach`：

```
foreach ($rowset as $row) {
    // do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:36:35.520

构建变量 $rowset 时：

```
$rowset[] = array(...); 
```

它是**数组**类型。fetch_assoc() 方法是从数据库返回的 MySqli 或 PDO 结果对象的一部分。

要完成您要执行的操作，请尝试以下操作：

```
foreach($rowset as $row)
{
   // Do something with $row
} 
```

# java - 使用 Scala 装饰 Java 库对象

> ID：11851139
> 
> 赞同：0
> 
> 时间：2012-08-07T17:33:11.290
> 
> 标签：java, scala

我依赖于一个旧的 Java API，它有点糟糕，并且喜欢在数据丢失时抛出空指针异常。我想创建一个具有选项类型访问器但保留旧访问器的子类，直到我决定需要为它们创建安全访问器。有没有一种从原始对象的副本创建子类的好方法？我想实现以下目标：

```
SafeIssue extends Issue {
  def safeMethod: Option[Value] = { //... }
}

val issue = oldapi.getIssue()
val safeIssue = SafeIssue(issue)

//Preserves issue's methods and data if I need them
val unsafeVal = safeIssue.unsafeMethod
val maybeVal  = safeIssue.safeMethod 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:41:22.060

为什么不尝试隐式转换呢？这更适用于喜欢创建自己的对象的 Java API。所以你会

```
class SafeIssue(issue: Issue) {
  def original = issue
  def safeFoo = Option(issue.foo)
  // ...  You must write any of these you need
}
implicit def make_issues_safe(issue: Issue) = new SafeIssue(issue) 
```

然后你可以——只要你提供了方法——写出类似的东西

```
val yay = Issue.myStaticFactoryMethodThing.safeFoo.map(x => pleaseNoNull(x)) 
```

（然后，您可以决定是否要在代码中携带`SafeIssue`或四处走动，并且您始终可以使用公开的方法`Issue`取回`Issue`from （或者您可以将参数设为 a 。）`SafeIssue``original``issue``val`

# c# - 查询队列和线程安全

> ID：11851147
> 
> 赞同：4
> 
> 时间：2012-08-07T17:33:51.367
> 
> 标签：c#, c#-4.0, thread-safety

线程安全不是我担心的一个方面，因为我编写的简单应用程序和库通常只在主线程上运行，或者不直接修改我之前需要担心的任何类中的属性或字段。

但是，我已经开始从事一个个人项目，我正在使用它`WebClient`从远程服务器异步下载数据。有一个`Queue<Uri>`包含一系列 URI 的预构建队列来下载数据。

所以考虑下面的代码片段（这不是我真正的代码，但我希望能说明我的问题：

```
private WebClient webClient = new WebClient();
private Queue<Uri> requestQueue = new Queue<Uri>();

public Boolean DownloadNextASync()
{
    if (webClient.IsBusy)
        return false;

    if (requestQueue.Count == 0)
        return false

    var uri = requestQueue.Dequeue();

    webClient.DownloadDataASync(uri);

    return true;

} 
```

如果我理解正确，则此方法不是线程安全的（假设此对象的此特定实例为多个线程所知）。我的推理是在检查和方法调用`webClient`之间的时间里可能会变得很忙。而且，在检查和下一个项目出队 之间可能会变空。`IsBusy``DownloadDataASync()``requestQueue``Count`

我的问题是处理这种情况以使其成为线程安全的最佳方法是什么？

这更像是一个抽象的问题，因为我意识到对于这种特定方法，必须有一个非常不方便的时间才能真正引起问题，并且为了涵盖这种情况，我可以适当地包装该方法，`try-catch`因为这两个部分都会抛出异常。但是还有其他选择吗？`lock`声明是否适用于此处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:55:03.573

我强烈推荐阅读 Joseph Albahari 的“Threading In C#”。我已经看了一下它，为我第一次（错误）冒险进入线程做准备，它非常全面。

你可以在这里阅读：[http ://www.albahari.com/threading/](http://www.albahari.com/threading/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:57:16.810

如果您的目标是 .Net 4.0，您可以使用任务并行库寻求帮助：

```
var queue = new BlockingCollection<Uri>();
var maxClients = 4;

// Optionally provide another producer/consumer collection for the data
// var data = new BlockingCollection<Tuple<Uri,byte[]>>();

// Optionally implement CancellationTokenSource

var clients = from id in Enumerable.Range(0, maxClients)
              select Task.Factory.StartNew(
    () =>
    {
        var client = new WebClient();
        while (!queue.IsCompleted)
        {
            Uri uri;
            if (queue.TryTake(out uri))
            {
                byte[] datum = client.DownloadData(uri); // already "async"
                // Optionally pass datum along to the other collection
                // or work on it here
            }
            else Thread.SpinWait(100);
        }
    });

// Add URI's to search
// queue.Add(...);

// Notify our clients that we've added all the URI's
queue.CompleteAdding();

// Wait for all of our clients to finish
clients.WaitAll(); 
```

* * *

要使用这种方法来指示进度，您可以使用它`TaskCompletionSource<TResult>`来管理基于事件的并行性：

```
public static Task<byte[]> DownloadAsync(Uri uri, Action<double> progress)
{
    var source = new TaskCompletionSource<byte[]>();
    Task.Factory.StartNew(
        () =>
        {
            var client = new WebClient();
            client.DownloadProgressChanged
                += (sender, e) => progress(e.ProgressPercentage);
            client.DownloadDataCompleted
                += (sender, e) =>
                {
                    if (!e.Cancelled)
                    {
                        if (e.Error == null)
                        {
                            source.SetResult((byte[])e.Result);
                        }
                        else
                        {
                            source.SetException(e.Error);
                        }
                    }
                    else
                    {
                        source.SetCanceled();
                    }
               };
        });

    return source.Task;
} 
```

像这样使用：

```
// var urls = new List<Uri>(...);
// var progressBar = new ProgressBar();

Task.Factory.StartNew(
    () =>
    {
       foreach (var uri in urls)
       {
           var task = DownloadAsync(
               uri,
               p =>
                   progressBar.Invoke(
                       new MethodInvoker(
                       delegate { progressBar.Value = (int)(100 * p); }))
               );

           // Will Block!
           // data = task.Result;
       } 
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T03:25:22.487

您提出的两个线程安全问题都是有效的。此外，WebClient 和 Queue 都被记录为不是线程安全的（在 MSDN 文档的底部）。例如，如果两个线程同时出队，它们实际上可能会导致队列内部不一致或可能导致无意义的返回值。例如，如果 Dequeue() 的实现类似于：

```
1\. var valueToDequeue = this._internalList[this._startPointer];
2\. this._startPointer = (this._startPointer + 1) % this._internalList.Count;
3\. return valueToDequeue; 
```

并且两个线程在继续执行第 2 行之前分别执行第 1 行，那么两者都将返回相同的值（这里还有其他潜在问题）。这不一定会引发异常，因此您应该使用 lock 语句来保证一次只能有一个线程在方法内：

```
private readonly object _lock = new object();

...

lock (this._lock) { 
    // body of method
} 
```

如果您知道没有其他人会在它们上同步，您也可以锁定 WebClient 或队列。

# java - 处理多次按键忽略重复键

> ID：11851155
> 
> 赞同：1
> 
> 时间：2012-08-07T17:34:20.807
> 
> 标签：java, swing, keypress, keylistener, keyrelease

我在另一个问题的评论部分提出了这个问题（>[如何在 Java 中处理同时按下的按键？](https://stackoverflow.com/questions/752999/how-do-i-handle-multiple-key-press-in-java/753078#comment15702382_753078)），并被要求完全提出一个新问题。

我的问题是，当我创建按键的 ArrayList 时，如果用户按住按键，它们不会通过 keyReleased 事件足够快地删除。我希望运动与“asdf”和北，东，南，西，东北......等一起。

这是我的两个事件的代码：

```
@Override
public void keyPressed(KeyEvent e) {
    if(chatTextField.isFocusOwner() == true){
        //do nothing - don't walk
    } else {
        logger.debug("Key Pressed: " + e.getKeyChar());
        lastKey = keysPressed.get(keysPressed.size()-1);

        for (String key : keysPressed){
            if (!key.contains(String.valueOf(e.getKeyChar())) && !lastKey.contains(String.valueOf(e.getKeyChar()))){
                keysPressed.add(String.valueOf(e.getKeyChar()));
                System.out.println("ADDED: " + keysPressed);
            }
        }

        String keysList = keysPressed.toString();
        if (keysList.contains("w")){
            if (keysList.contains("d")){
                requestCharacterMove("NorthEast");
            } else if(keysList.contains("a")){
                requestCharacterMove("NorthWest");
            } else{
                requestCharacterMove("North");
            }
        } else if (keysList.contains("s")){
            if (keysList.contains("d")){
                requestCharacterMove("SouthEast");
            } else if(keysList.contains("a")){
                requestCharacterMove("SouthWest");
            } else{
                requestCharacterMove("South");
            }
        } else if (keysList.contains("d")){
            requestCharacterMove("East");
        } else if (keysList.contains("a")){
            requestCharacterMove("West");
        }
    }
}

@Override
public void keyReleased(KeyEvent e) {
    if(chatTextField.isFocusOwner() == true){
        //do nothing - don't walk
    } else {
        logger.debug("Key Released: " + e.getKeyChar());
        for (String key : keysPressed){
            if (key.contains(String.valueOf(e.getKeyChar()))){
                keysPressed.remove(String.valueOf(e.getKeyChar()));
                System.out.println("REMOVED: " + keysPressed);
            }
        }
    }
}

@Override
public void keyTyped(KeyEvent arg0) {
    // TODO Auto-generated method stub

} 
```

直到我通过 lastKey(String) 变量在那里添加第二次检查，金字塔创建的规模是巨大的。即使进行第二次检查，列表也会增加，并且几乎总是有两到三个重复项。由于我的角色笨拙地移动，因此对此的任何帮助都会很棒。:(

此外，任何删除对 char、string、arrayList 的重复转换的方法都会很棒，因为我很紧张我为“简单”的东西使用了太多类型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:54:32.777

您认为事情处理得很慢很可能是由于许多*System.out.println* () 语句引起的。

您没有得到对角线移动的问题源于您的检查逻辑有些错误 - 而不是明确检查（例如）键 A*和*B 是否被按下，只需独立检查它们 - 键 A 将字符移动到一个方向，B 移动到另一个方向. 总的来说（例如），通过向 WEST*和*NORTH 移动，您将有效地向 NORTHWEST 移动。

您可以使用 java.util.BitSet 并为当前按下的每个键设置位，而不是按下键的列表。这也应该大大减少您需要编写的代码量（keyPressed 只是设置键代码指示的位，keyReleased 清除它）。要检查是否按下了某个键，请询问 BitSet，然后询问当前是否设置了代码的位。

编辑：使用 BitSet 而不是列表的示例

```
public class BitKeys implements KeyListener {

    private BitSet keyBits = new BitSet(256);

    @Override
    public void keyPressed(final KeyEvent event) {
        int keyCode = event.getKeyCode();
        keyBits.set(keyCode);
    }

    @Override
    public void keyReleased(final KeyEvent event) {
        int keyCode = event.getKeyCode();
        keyBits.clear(keyCode);
    }

    @Override
    public void keyTyped(final KeyEvent event) {
        // don't care
    }

    public boolean isKeyPressed(final int keyCode) {
        return keyBits.get(keyCode);
    }

} 
```

我让示例实现了 KeyListener，因此您甚至可以按原样使用它。当您需要知道某个键是否被按下时，只需使用 isKeyPressed()。您需要决定是喜欢使用原始密钥代码（就像我一样）还是使用关键字符（就像您目前所做的那样）。在任何情况下，您都会看到如何使用 BitSet 类来记录键的代码量减少到几行 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T21:21:03.577

作为替代方案，该[游戏](http://robotchase.sourceforge.net/)使用数字键盘通过单次击键来实现每个（半）基本方向。默认排列显示在*设计*部分。可以单独重新分配按键以在键盘上的任何位置映射类似的玫瑰花结。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T18:16:14.263

看起来您没有正确处理 Java 中的线程。任何 Java 程序都有三个线程（最少）。它们是主程序线程，事件调度线程，还有一个我现在不记得了。

每当您收到一个事件时，它都会通过一个特殊的线程传递给您（我相信它是事件调度线程，但这不是重点）。你不能在这个线程上做任何事情（这需要时间），这会冻结你的输入并导致你错过事件，使 Java 看起来没有响应。所以发生的事情是你破坏了java中的事件系统。您应该做的是将结果存储在某种缓冲区中，这是您可以期望对事件执行的禁食操作，然后按照我将描述的方式稍后处理。

[旁白：一个有趣的应用程序是制作一个简单的 gui，并在按下按钮调用线程上等待 5 秒钟。您的整个 gui 将冻结，直到延迟结束！]

您应该在旁边运行一个不同的线程（可能是您的主线程）。它将运行某种循环，控制程序中的帧，每个游戏循环完成一次。在每个周期，该线程读取存储在输入缓冲区中的结果并处理它们。这背后的理论很简单，但执行可能有点混乱，因为您需要确保没有输入事件被丢弃或读取一次以上。不管怎样，祝你的游戏好运！

# java - 使用 freemarker 重新定位光标

> ID：11851157
> 
> 赞同：3
> 
> 时间：2012-08-07T17:34:36.240
> 
> 标签：java, freemarker

我正在使用免费的标记和 java。我必须在 txt 文件中输出结果。假设我必须打印 3 列作为

```
`A     B      C` 
```

在类似的模式。所有三个属性都作为字符串。条件是，如果引用 A 的字符串长度大于 3，则应该在下一行打印。也就是说，如果长度为 8，那么前 3 个字符将在第一行，4 到 6 在第二行，其余两个在第三行。现在，当我必须为 B 打印时，我必须回到第一行，但 A 的当前位置将是第 3 行。

我该怎么做呢？

例子

```
Hi,                          (required cursor position to print for B).
Hel
lo(current cursor position) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:02:06.847

我查看了[字符串的 FreeMarker 内置](http://freemarker.sourceforge.net/docs/ref_builtins_string.html)函数，我认为没有直接解决此问题的函数，但您可以执行以下操作：

我假设您有 3 个列表，其中包含您传递给模板的 Java 属性。在模板中创建另外 3 个列表，这些列表将用作存储剩余字符的缓冲区列表。

使用函数[字符串函数](http://freemarker.sourceforge.net/docs/ref_builtins_string.html#ref_builtin_substring) `substring(0, 3)`，您可以计算可以直接为 A 列输出多少属性字符串，如果仍有字符，则将它们添加到第一个缓冲区列表中。

然后对 B 列和 C 列重复相同的过程。之后，A 列再次转动（这次是第二行）。这次您不查看 from Java 传递的列表，而是查看缓冲区列表：是否还有前一个属性的剩余字符或者可以使用传递的列表？

如果还有剩余字符，则再次应用`substring(0, 3)`并将可能的剩余字符再次推送到第一个缓冲区列表的前面。等等等等...

我知道这很乏味，但我能想到的唯一解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:11:01.087

我不知道freemarker，这是一种仅使用字符串操作的方法：

1.  拿一个`StringBuilder`
2.  而 A、B 或 C 还剩下任何字符
3.  对于 A，追加提取最多 3 个字符
4.  追加空格直到 8 个字符
5.  对于 B，追加提取最多 3 个字符
6.  追加空格直到 8 个字符
7.  对于 C，追加提取最多 3 个字符
8.  追加空格直到 8 个字符
9.  追加换行符

这是代码示例，可能未优化但有效：

```
public static void main(String[] args) {
  System.out.println(formatOutput("Hello", "How are you?", "Wassup"));
}

public static String formatOutput(String textA, String textB, String textC) {
    StringBuilder output = new StringBuilder("");

    int beginIndex = 0, endIndex = 3;
    String snippet;
    while (textA.length() > 0 || textB.length() > 0 || textC.length() > 0) {
        if (textA.length() > endIndex) {
            snippet = textA.substring(beginIndex, endIndex);
            textA = textA.substring(endIndex);
        } else {
            snippet = textA.substring(beginIndex);
            textA = "";
        }
        output.append(snippet);
        for (int i = snippet.length(); i <= 8; i++)
            output.append(" ");
        ;

        if (textB.length() > endIndex) {
            snippet = textB.substring(beginIndex, endIndex);
            textB = textB.substring(endIndex);
        } else {
            snippet = textB.substring(beginIndex);
            textB = "";
        }
        output.append(snippet);
        for (int i = snippet.length(); i <= 8; i++)
            output.append(" ");

        if (textC.length() > endIndex) {
            snippet = textC.substring(beginIndex, endIndex);
            textC = textC.substring(endIndex);
        } else {
            snippet = textC.substring(beginIndex);
            textC = "";
        }
        output.append(snippet);
        for (int i = snippet.length(); i <= 3; i++)
            output.append(" ");
        output.append("\n");    
    }
    return output.toString();
} 
```

输出：

```
Hel      How      Was 
lo        ar      sup 
         e y          
         ou? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T06:40:55.867

纯粹在 FreeMarker 中实现有点尴尬，但它的完整语言足以做到这一点。假设这是在`myutils.ftl`：

```
<#function safeSubstring s start end>
  <#if s?length < start><#return ''></#if>
  <#if s?length < end>
    <#return s?substring(start)>
  <#else>
    <#return s?substring(start, end)>
  </#if>
</#function>

<#macro printColumns cols>
    <#list 0..999999 as i>
      <#local start = i * 3>
      <#local printedSomething = false>
      <#list cols as col>
        <#if start < col?length>
          <#local printedSomething = true>
          <#lt><#list cols as col>${safeSubstring(col, start, start + 3)?right_pad(8)}</#list>
          <#break>
        </#if>
      </#list>
      <#if !printedSomething><#break></#if>
    </#list>
</#macro> 
```

然后你可以这样做：

```
<#import "myutils.ftl" as u>
...
<@u.printColumns ['Helo', "How are you?", "Wassup"] /> 
```

如果您想要更高的性能，您可以考虑在 Java 中将其实现为 a `TemplateDirectiveModel`（或 a `TemplateMethodModelEx`），然后`myutils.ftl`更改为`<#assign printColumns = "com.whatever.PrintColumnsDirective"?new()>`.

# generator - MyBatis Generator 移除 useGeneratedKeys="true"

> ID：11851158
> 
> 赞同：3
> 
> 时间：2012-08-07T17:34:42.523
> 
> 标签：generator, mybatis

我在 Eclipse Helios 中使用 MyBatis Generator（MyBatis Generator 1.3.1.201101032122），但每次我自动生成持久类时，生成器都会删除属性 useGeneratedKeys="true"。

例如，我的 AdresseMapper.xml 中有标签。在我更改了数据库中的某些内容并运行“生成 MyBatis Artifacts”后，此标签被覆盖并且 useGeneratedKey 不再存在...当我删除警告 - @mbggenerated 时，新生成的插入（没有属性）之间存在冲突) 和旧版本...

你能帮帮我吗？我在官方文档中没有找到任何东西..

非常感谢法比奥

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-09T20:29:51.003

MyBatis Generator 必须知道哪一列生成了键。您可以使用`generatedKey`标签内的`table`标签来做到这一点。

例子：

```
 <table tableName="adresse" alias="adresse">
        <generatedKey column="id" sqlStatement="MySql" identity="true" />
    </table> 
```

# c# - 实体框架代码优先 - 虚拟属性列命名

> ID：11851160
> 
> 赞同：6
> 
> 时间：2012-08-07T17:34:45.423
> 
> 标签：c#, .net, entity-framework-4

我在个人 ASP.NET MVC 3 项目上使用 EF Code First (4.3.1)，具有非常简单的域模型，并且我几乎处于 EF 将以我想要的方式生成 DB 模式的地步.

域模型有两个类：`Painting`和`Gallery`。每个都`Painting`属于一个`Gallery`，并且`Gallery`有两个虚拟属性指向`Painting`：一个指示哪幅画是它的封面图像，一个指示哪幅画是主页上显示的滑块图像。

课程如下。我删除了一些注释和不相关的属性以使其可读。

```
public class Gallery
{
    public Gallery()
    {
        Paintings = new List<Painting>();
    }

    [ScaffoldColumn(false)]
    [Key]
    public int GalleryId { get; set; }

    public string Name { get; set; }

    [ScaffoldColumn(false)]
    [Column("LaCover")]
    public Painting Cover { get; set; }

    [ScaffoldColumn(false)]
    [Column("ElSlider")]
    public Painting Slider { get; set; }

    [ScaffoldColumn(false)]
    public virtual List<Painting> Paintings { get; set; }
} 
```

和绘画：

```
public class Painting
{
    [ScaffoldColumn(false)]
    [Key]
    public int PaintingId { get; set; }

    public string Name { get; set; }

    public int GalleryId { get; set; }

    [Column("GalleryId")]
    [ForeignKey("GalleryId")]
    [InverseProperty("Paintings")]
    public virtual Gallery Gallery { get; set; }

    public string Filename { get; set; }
} 
```

它为类及其关系生成正确的数据库模式，我唯一的小问题是我还没有找到一种方法来控制它赋予表`Cover`和表`Slider`中的虚拟属性的列名`Gallery`。

它会将它们命名为`Cover_PaintingId`和`Slider_PaintingId`。

我尝试使用该`[Column("columnNameHere")]`属性，但这根本不影响它。如“我输入了某个不相关的单词，但它没有出现在架构中”。

我想命名它`CoverPaintingId`，不带下划线。

任何帮助是极大的赞赏。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T18:27:47.200

[ForeignKey](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.foreignkeyattribute%28v=vs.110%29.aspx)属性允许您定义将充当外键的属性，如果您希望它存在于您的模型中：

```
[ForeignKey("CoverPaintingId")]
public virtual Painting Cover { get; set; }
public int? CoverPaintingId { get; set; } 
```

请注意，您可以将属性放在外键上的虚拟属性上 - 只需指定“另一个”的名称。

*但是*，由于您将在同一组实体之间建立两种关系，因此如果不对其中一个或两个实体禁用级联删除，您将无法执行此操作。这只能使用[Fluent Configuration API](http://msdn.microsoft.com/en-us/data/hh134698.aspx)来完成。

```
public class Gallery
{
    public int GalleryId { get; set; }

    [ForeignKey("CoverPaintingId")]
    public virtual Painting Cover { get; set; }
    public int? CoverPaintingId { get; set; }

    [ForeignKey("SliderPaintingId")]
    public virtual Painting Slider { get; set; }
    public int? SliderPaintingId { get; set; }

}

public class Painting
{
    public int PaintingId { get; set; }
}

public class MyContext : DbContext
{
    public DbSet<Gallery> Galleries { get; set; }
    public DbSet<Painting> Paintins { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Gallery>().HasOptional(g => g.Cover).WithMany().WillCascadeOnDelete(false);
        modelBuilder.Entity<Gallery>().HasOptional(g => g.Slider).WithMany().WillCascadeOnDelete(false);
    }
} 
```

如果您不希望代码模型中存在外键属性，也可以在.Map(...)之前使用[.Map(...)配置这些属性。](http://msdn.microsoft.com/en-us/library/system.data.entity.modelconfiguration.configuration.foreignkeynavigationpropertyconfiguration.map%28v=vs.103%29)[API 的WillCascadeOnDelete(false)](http://msdn.microsoft.com/en-us/library/gg679204%28v=vs.103%29.aspx)部分，而不是使用 ForeignKey。我更喜欢使用外键，但如果你想这样做，代码如下所示：

```
public class Gallery
{
    public int GalleryId { get; set; }
    public virtual Painting Cover { get; set; }
    public virtual Painting Slider { get; set; }
}

public class Painting
{
    public int PaintingId { get; set; }
}

public class MyContext : DbContext
{
    public DbSet<Gallery> Galleries { get; set; }
    public DbSet<Painting> Paintins { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Gallery>().HasOptional(g => g.Cover).WithMany().Map(m => m.MapKey("CoverPaintingId")).WillCascadeOnDelete(false);
        modelBuilder.Entity<Gallery>().HasOptional(g => g.Slider).WithMany().Map(m => m.MapKey("SliderPaintingId")).WillCascadeOnDelete(false);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:44:08.530

你可以尝试使用 [inverseproperty] 装饰来实现这一点。

# python - 如何使用 Paramiko 传输文件夹

> ID：11851168
> 
> 赞同：4
> 
> 时间：2012-08-07T17:35:09.670
> 
> 标签：python, sftp, paramiko

我正在尝试从远程服务器下载一个 80 MB 的文件夹到我的本地机器上。我知道文件路径是正确的，并且我知道该文件夹存在。我当前的工作代码（在单个文件上工作）是这样的：

```
import paramiko

def begin():
    tran=paramiko.Transport(('dns.server.name', 22))
    tran.connect(username='**',password='**')
    sftp=paramiko.SFTPClient.from_transport(tran)
    sftp.get('/remote/file/path', '/local/file/path')
    sftp.close()
    tran.close() 
```

我已经尝试添加 sftp.listdir，但恐怕我找不到足够的关于该主题的文档以使其易于理解或对我有用。有没有看起来像 os.walk 的东西？

我的问题是 - 如何通过 paramiko 中可用的 ssh2 协议下载小文件夹？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T04:37:30.013

What I suggest instead of transferring whole folder, you should first make a temporary compressed `tar` file on server programmetically and transfer that tar file using `sftp` over network - may reduce bandwidh / will work faster and will be less error prone.

# sql - 通过关系表获取两个表之间现有和不存在的组合

> ID：11851173
> 
> 赞同：0
> 
> 时间：2012-08-07T17:35:25.697
> 
> 标签：sql, sql-server

我需要这方面的帮助。

我有 3 个表（FROM、TO 和 DISTANCE）：

```
FROMs(Id, Name)
1 - London
2 - Beijing
3 - Athens

TOs(Id, Name)
1 - New York
2 - Madrid
3 - Paris

DISTANCEs(Id,FROMid,TOid,km,obs)
1 - 2 - 3 - 400 - distance between Beij. and Paris 
```

我需要一个返回这个的查询：

```
1    - 2 - 3 - 400 - distance between Beij. and Paris
NULL - 1 - 1 - NULL - NULL 
```

对于所有不存在的组合，依此类推。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:58:36.103

这样的事情应该做：

这是[SQLFiddle的链接](http://sqlfiddle.com/#!3/08c10/18)

```
select a.id, b.fromId, b.toId, a.km, a.obs from distances a
right join(
select a.id as fromId, 
       a.name as fromName,
       b.id as toId,
       b.name as toName
from froms a
join tos b
on 1=1) b
on a.fromId = b.fromId
   and a.toId = b.toId 
```

# objective-c - 奇怪的视图行为

> ID：11851174
> 
> 赞同：0
> 
> 时间：2012-08-07T17:35:29.270
> 
> 标签：objective-c, uiview

我的应用程序中有一个功能可以在显示键盘时向上移动视图。不幸的是，有一个错误；第一次加载视图时一切正常，但如果切换到另一个视图，然后切换回来，视图不再移动:(

我在代码中添加了一些`NSLog`语句来尝试跟踪问题。我正在使用 NSNotification，这很好，因为每次都会调用该方法。

然后我想可能是视图的坐标有问题，所以我添加了打印出视图原点的语句。他们打印出正确的原点（“移动”的原点），即使视图肯定没有移动。

所以看起来 Xcode 认为它已经移动了视图，但它没有。有没有其他人遇到过这种行为？

* * *

编辑：这是一些代码

设置通知：

```
 //register for keyboard notifications
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillShow:) name:UIKeyboardWillShowNotification object:self.view.window];

        //if the keyboard is already being shown because someone was entering a comment, and then they switch to a textfield, this will move the view back down.
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillHide:) name:UITextFieldTextDidBeginEditingNotification object:self.view.window];

        //hide the keyboard
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillHide:) name:UIKeyboardWillHideNotification object:self.view.window];

        //hide the keyboard if we're done with the textview
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillHide:) name:UITextViewTextDidEndEditingNotification object:self.view.window];

        keyboardIsShown = FALSE;

        tempDelegate.keyboardIsInitialized = TRUE; 
```

显示键盘和移动视图的方法：

```
-(void)keyboardWillShow:(NSNotification *)notif{

    NSLog(@"keyboardWillShow");
    NSLog(@"type: %@, keyboardIsShown: %@", sender, keyboardIsShown);

    //double check
    if (keyboardIsShown || !sender) {
        NSLog(@"return");
        return;
    }

    //only adjust screen for comment box (which is a textview)
    if(![sender isEqualToString:@"text field"] && [sender isEqualToString:@"text view"]){

        NSLog(@"if");

        NSDictionary* userInfo = [notif userInfo];

        // get the size of the keyboard
        CGSize keyboardSize = [[userInfo objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

        [UIView beginAnimations:@"ResizeForKeyboard" context:NULL];
        [UIView setAnimationBeginsFromCurrentState:YES];
        [UIView setAnimationDuration:0.3];

        NSLog(@"regular BEFORE: %@", NSStringFromCGRect(regularView.frame));

        regularView.frame = CGRectMake(0, - keyboardSize.height, CGRectGetWidth(imageView.bounds)*scrollView.zoomScale, CGRectGetHeight(imageView.bounds)*scrollView.zoomScale);

        NSLog(@"regular AFTER: %@", NSStringFromCGRect(regularView.frame));

        [UIView commitAnimations];

        keyboardIsShown = YES;

    }
} 
```

以及隐藏键盘并将视图移回的方法：

```
-(void)keyboardWillHide:(NSNotification *)notif{

    NSLog(@"keyboardWillHide");

    if (!keyboardIsShown) {
        NSLog(@"return");
        return;
    }

    [UIView beginAnimations:@"ResizeForKeyboard" context:NULL];
    [UIView setAnimationBeginsFromCurrentState:YES];
    [UIView setAnimationDuration:0.3];

    NSLog(@"regular BEFORE: %@", NSStringFromCGRect(regularView.frame));

    self.regularView.frame = CGRectMake(0, 0, CGRectGetWidth(imageView.bounds)*scrollView.zoomScale, CGRectGetHeight(self.imageView.bounds)*scrollView.zoomScale);
    [UIView commitAnimations];

    NSLog(@"regular AFTER: %@", NSStringFromCGRect(regularView.frame));

    keyboardIsShown = NO;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:57:29.307

你正在用吗：

```
-(void) viewWillDisappear:(BOOL)animated {
    NSLog (@"Unregister for keyboard events");
    [[NSNotificationCenter defaultCenter]
                removeObserver:self];
} 
```

如果不是这样，请尝试在 viewWillAppear 上检查视图的位置。如果它显示键盘已启动.. 不使用动画将其关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:48:55.903

你是`regularView`在`viewWillAppear:`or中初始化`viewDidAppear:`吗？如果是这种情况，您应该将初始化移至`viewDidLoad`。

正如您所确认的那样，解释是`viewWillAppear:`在视图的生命周期内可能会被多次调用，因此通常不适合在其中构造 UI 层次结构，`viewWillAppear:`因为您最终会得到重复的视图层次结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:40:24.080

您是否随时添加或删除 NSNotification？

另外，您可以发布您的代码以了解如何移动您的视图吗？那里可能有一些问题。

编辑：

因此，从看起来您的通知在某个时候被删除并且没有被添加回来。

将通知初始化移动到您的`viewDidAppear`方法中并在您的方法中删除它们`viewDidDissappear`。这将确保无论何时您的视图出现或消失，都会分别添加或删除通知。

您可能正在做的是将它们添加到您的 viewDidLoad 中，该方法仅在第一次加载视图时被调用（所以只有一次）。因此，如果您推送一个新视图然后弹回，它们可能会被删除而不是添加回来。

编辑：

这是我需要用键盘制作动画时通常使用的一些代码。

```
#define kOFFSET_FOR_KEYBOARD 80.0

-(void)keyboardWillShow {
    // Animate the current view out of the way
    if (self.view.frame.origin.y >= 0)
    {
        [self setViewMovedUp:YES];
    }
    else if (self.view.frame.origin.y < 0)
    {
        [self setViewMovedUp:NO];
    }
}

-(void)keyboardWillHide {
    if (self.view.frame.origin.y >= 0)
    {
        [self setViewMovedUp:YES];
    }
    else if (self.view.frame.origin.y < 0)
    {
        [self setViewMovedUp:NO];
    }
}

-(void)textFieldDidBeginEditing:(UITextField *)sender
{
    if ([sender isEqual:mailTf])
    {
        //move the main view, so that the keyboard does not hide it.
        if  (self.view.frame.origin.y >= 0)
        {
            [self setViewMovedUp:YES];
        }
    }
}

//method to move the view up/down whenever the keyboard is shown/dismissed
-(void)setViewMovedUp:(BOOL)movedUp
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3]; // if you want to slide up the view

    CGRect rect = self.view.frame;
    if (movedUp)
    {
        // 1\. move the view's origin up so that the text field that will be hidden come above the keyboard 
        // 2\. increase the size of the view so that the area behind the keyboard is covered up.
        rect.origin.y -= kOFFSET_FOR_KEYBOARD;
        rect.size.height += kOFFSET_FOR_KEYBOARD;
    }
    else
    {
        // revert back to the normal state.
        rect.origin.y += kOFFSET_FOR_KEYBOARD;
        rect.size.height -= kOFFSET_FOR_KEYBOARD;
    }
    self.view.frame = rect;

    [UIView commitAnimations];
}

- (void)viewWillAppear:(BOOL)animated
{
    // register for keyboard notifications
    [[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(keyboardWillShow)
                                             name:UIKeyboardWillShowNotification
                                           object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(keyboardWillHide)
                                             name:UIKeyboardWillHideNotification
                                           object:nil];
}

- (void)viewWillDisappear:(BOOL)animated
{
    // unregister for keyboard notifications while not visible.
    [[NSNotificationCenter defaultCenter] removeObserver:self
                                             name:UIKeyboardWillShowNotification
                                           object:nil];

    [[NSNotificationCenter defaultCenter] removeObserver:self
                                             name:UIKeyboardWillHideNotification
                                           object:nil];
} 
```

# c# - C#让程序在后台运行直到计算机完全关闭

> ID：11851175
> 
> 赞同：0
> 
> 时间：2012-08-07T17:35:55.300
> 
> 标签：c#, shutdown

基本上，我正在制作一个在晚上 11 点之后阻止互联网访问的程序。但我唯一的问题是有很多方法可以绕过它，例如关闭计算机，用户只需要等到操作系统本身关闭进程然后取消关机操作（Windows 7）。

有什么方法可以确保程序在电脑关机或其他任何事情之前不会终止？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:57:34.083

如果您的目标是阻止 Internet 访问，我建议在您的路由器而不是您的 PC 上执行此规则。这将是一个更简单、更可靠的解决方案。您的路由器可能已经支持该功能，但如果不支持，您可以购买新的消费级路由器（便宜）和/或安装支持的自定义固件（请参阅Linksys WRT-54GL 和公司的[番茄](http://www.polarcloud.com/firmware)固件） .

如果路由器方法对您不起作用，并且您必须在软件中阻止 Internet 访问，我建议首先调查 Windows 的“本地策略”或“组策略”，看看它们是否可以做你想做的事。

如果这对您的口味来说太复杂了，请尝试寻找现成的解决方案。查看 ZoneAlarm 或 NetNanny，看看其中一个是否可以解决问题。

但是，如果你一心想编写一个 C# 程序来为你做这件事，你可能想要考虑[编写一个 Windows 服务](http://msdn.microsoft.com/en-us/library/zt39148a%28v=vs.100%29.aspx)。服务的编写和部署更复杂，但它们可以配置为在启动时运行，并且不像常规桌面应用程序那样从属于用户会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:44:02.713

这实际上有些复杂。就像病毒一样——你如何让它一直运行？

您可能想阅读有关驱动程序的信息。驱动程序对操作系统具有最高的“信任”。他们可以物理访问计算机中的任何内容。除了驱动程序或核心文件之外的任何东西都可以由用户手动关闭，以某种方式关闭。

您可以做的另一件事是将文件“刻录”到`Kernal.DLL`此类文件中。您可以使用计算机上的不同操作系统（例如 Linux）或通过物理写入硬盘（而不是通过 Windows 的 API）来执行此操作。要物理访问驱动程序，[请查看此内容。](https://stackoverflow.com/questions/4223246/how-can-i-access-the-file-sytem-and-sector-of-harddisk-by-c)

# ruby-on-rails - Faye on Heroku：跨域问题

> ID：11851182
> 
> 赞同：5
> 
> 时间：2012-08-07T17:36:07.910
> 
> 标签：ruby-on-rails, heroku, cors, faye

我目前在 Heroku 上托管我的 rails 应用程序和 faye-server 应用程序。faye 服务器已从此处 ( [https://github.com/ntenisOT/Faye-Heroku-Cedar](https://github.com/ntenisOT/Faye-Heroku-Cedar) ) 克隆，并且似乎运行正常。我禁用了 websocket，因为 Heroku 不支持它们。尽管在 Faye 的网站上声称：

“Faye 客户端和服务器透明地支持跨域通信，因此您的客户端可以连接到您喜欢的任何域上的服务器，而无需进一步配置。”

当我尝试发布到 faye 频道时，我仍然遇到此错误：

```
 XMLHttpRequest cannot load http://MYFAYESERVER.herokuapp.com. Origin http://MYAPPURL.herokuapp.com is not allowed by Access-Control-Allow-Origin. 
```

我已阅读有关 CORS 并尝试实施此处概述的一些解决方案：[http](http://www.tsheffler.com/blog/?p=428) ://www.tsheffler.com/blog/?p=428但到目前为止还没有运气。我很想听听以下人士的意见：

1）在 Heroku 上托管了一个 rails 应用程序 2）在 Heroku 上托管了一个 faye 服务器 3）他们两个成功地相互通信！

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T22:23:09.940

在过去一个小时左右的时间里，我刚刚在 heroku 上托管了我的 faye 和 rails 应用程序……这是我的观察结果：

1.  如果您使用环境变量，请确保您的所有服务器上都设置了 FAYE_TOKEN。

2.  禁用您已经完成的 websockets...`client.disable(...)`对我不起作用，我使用`Faye.Transport.WebSocket.isUsable = function(_,c) { c(false) }`了。

3.  这可能适用于您，也可能不适用于您，但对我来说是最难追踪的事情......在我的开发环境中，我的应用程序运行的端口将被添加到我的 faye 服务器的指定主机名的末尾...... . 但这似乎导致生产中的通信失败。我通过在 application_controller.rb 中创建一个 broadcast_server_uri 方法来解决这个问题，该方法在必要时处理包含一个端口，然后在我启动新频道的任何地方使用它。

……

```
class ApplicationController < ActionController::Base
  def broadcast_server
      if request.port.to_i != 80
        "http://my-faye-server.herokuapp.com:80/faye"
      else
        "http://my-faye-server.herokuapp.com/faye"
      end            
  end
  helper_method :broadcast_server

  def broadcast_message(channel, data)
    message = { :ext => {:auth_token => FAYE_TOKEN}, :channel => channel, :data => data}
    uri = URI.parse(broadcast_server)
    Net::HTTP.post_form(uri, :message => message.to_json)
  end

end 
```

在我的应用程序 javascript 中，包括

```
<script>
  var broadcast_server = "<%= broadcast_server %>"
  var faye;
$(function() {
    faye = new Faye.Client(broadcast_server);
    faye.setHeader('Access-Control-Allow-Origin', '*');
    faye.connect();
    Faye.Transport.WebSocket.isUsable = function(_,c) { c(false) }

      // spin off your subscriptions here
  });
</script> 
```

FWIW，我不会强调设置 Access-Control-Allow-Origin ，因为它似乎没有任何区别 - 我看到`XMLHttpRequest cannot load http://...`无论如何，但这应该仍然可以很好地让你畅通无阻。（虽然我很想学习更清洁的解决方案......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:39:33.737

不能说我在 Heroku 上使用过 Rails/Faye，但是您是否尝试过将`Access-Control-Allow-Origin`标题设置为类似的东西`Access-Control-Allow-Origin: your-domain.com`？

对于测试，您还`Access-Control-Allow-Origin: *`可以查看是否有帮助

> 自定义标题
> 
> 某些服务需要使用额外的 HTTP 标头来连接到它们的 Bayeux 服务器。您可以使用 setHeader() 方法添加这些标头，如果底层传输支持用户定义的标头（当前仅长轮询），它们将被发送。
> 
> client.setHeader('Authorization', 'OAuth abcd-1234');

来源： http: [//faye.jcoglan.com/browser.html](http://faye.jcoglan.com/browser.html)

所以试试`client.setHeader('Access-Control-Allow-Origin', '*');`

# html - 内容未集中在 IE 中的一页上

> ID：11851188
> 
> 赞同：0
> 
> 时间：2012-08-07T17:36:39.690
> 
> 标签：html, css, internet-explorer, web

我已经从以前的开发人员那里接手了维护[这个](http://www.stonemanor.ca)网站。

每个页面的内容都在“ct”类的 div 容器内，该容器在左右两侧有一个自动边距（使页面居中）。

出于某种原因，[此](http://www.stonemanor.ca/contact-us.php)页面并未将所有 IE 版本（最多并包括 9）中的内容居中。

在所有其他浏览器中，这工作正常。

我查看了它并通过 W3C Validator 运行了该页面，但没有任何标记错误会导致此问题。

此页面似乎与其他页面构建相同。请注意，我没有开发这个网站，它不是我的标记。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:41:57.093

这都是关于怪癖模式。

单击 F12，您将看到它以 quirks 模式呈现。

通过设置有效的文档类型和内容居中来禁用怪癖。

**更新**

```
<!--  DUMP REQUEST 

Array
(
    [__utma] => 6046321.1674104794.1344361223.1344361223.1344361223.1
    [__utmb] => 6046321.1.10.1344361223
    [__utmc] => 6046321
    [__utmz] => 6046321.1344361223.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
)
 --> 
```

此代码是在设置 doctype 之前打印的，因此没有 doc-type。文档类型必须是第一行。

# asp.net-mvc - MVC 未加载完整视图

> ID：11851189
> 
> 赞同：0
> 
> 时间：2012-08-07T17:36:40.330
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3, razor

我创建了一个自定义`AuthorizeAttribute`，如果用户无权查看所请求的控制器，则会将其发送到错误页面。

重定向它们的代码如下：

```
Protected Overrides Sub HandleUnauthorizedRequest(filterContext As AuthorizationContext)
    Dim result = New ViewResult()
    result.ViewName = "Error"
    result.ViewBag.ErrorMessage = "oops, you are not allowed"
    filterContext.Result = result
End Sub 
```

它会将它们重定向到`~/Shared/Error.vbhtml`，就像它应该的那样；但是，该页面仅加载我的布局并包含标题`"Error"`，但不加载错误页面的任何内容。

错误页面内容如下：

```
@ModelType System.Web.Mvc.HandleErrorInfo

@Code
    ViewData("Title") = "Error"
End Code

@ViewBag.ErrorMessage

<h2>
    Sorry, an error occurred while processing your request.
</h2> 
```

为什么它不加载“*对不起，发生错误......* ”消息，我该如何让它这样做？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:48:43.380

> 它将它们重定向到 ~/Shared/Error.vbhtml，就像它应该的那样

不，我怀疑情况并非如此。您可能还有其他一些正在呈现的视图`Error.cshtml`。`Error.vbhtml`在您的网站上搜索其他地方是否存在此类文件。例如`~/Views/XXX/Error.vbhtml`，其中 XXX 是当前正在执行的控制器。

或者您也可以明确指定要加载的视图，而不是依赖于已建立的探测位置：

```
result.ViewName = "~/Views/Shared/Error.vbhtml" 
```

# oauth - 无需登录即可获取谷歌分析 API 数据

> ID：11851195
> 
> 赞同：4
> 
> 时间：2012-08-07T17:36:58.247
> 
> 标签：oauth, google-analytics, google-api, google-analytics-api

> **可能重复：**
> [带有 Google Analytics API v3 的 OAuth 2.0](https://stackoverflow.com/questions/10057928/oauth-2-0-with-google-analytics-api-v3)

我今天一直在阅读有关 Google API 以及它如何需要 Oauth2.0 的大量页面

谷歌自己网站上的文档是无用的，并且不断地让你转圈，所以我希望这里的人可以提供帮助。

我正在尝试构建一个简单的测试网页（在 http://localhost 上），它从 Analytics API 获取数据，始终来自同一个帐户。

所以，我有一个 API 密钥，想从这个 1 帐户获取数据，而不需要我网站的用户登录（他们无论如何都不能这样做，这是我的帐户）。

那么，有没有办法通过 HTTP 或其他方式以编程方式在 localhost 上验证我的应用程序。除非我的用户访问他们自己的帐户，否则我似乎不需要使用 Oauth？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T14:58:08.190

看起来只有当您让一些用户首先登录并使用“刷新令牌”时才有可能，根据上面 Jan 发布的链接

# php - 使用 Doctrine 实体和 JMSserializer 避免递归

> ID：11851197
> 
> 赞同：17
> 
> 时间：2012-08-07T17:37:17.863
> 
> 标签：php, symfony, doctrine-orm, fosuserbundle

我正在使用 Symfony2、Doctrine、FOSRestBundle 和 JMSSerializer 构建一个 REST API。

我遇到的问题是在序列化我的实体时，序列化程序会引入任何相关实体。例如，对于作为故事一部分的任务，该故事是董事会的一部分，因此在序列化任务时，我得到的输出包括包含董事会的故事，然后包括董事会上的所有其他故事。

有没有一种简单的方法来限制这一点，而只包含foreignIds？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-14T16:25:33.413

使用 JMS 排除策略。

在类别实体上使用注释的示例，您不想在其中包含要包含的子实体和产品相关实体：

```
use ...
    JMS\SerializerBundle\Annotation\ExclusionPolicy,
    JMS\SerializerBundle\Annotation\Exclude,
    ...;

/**
 * ...
 * @ExclusionPolicy("none")
 */
class Category
{
   /**
    * ...
    * @Exclude
    */
   private $children;

   /**
    * ...
    * @Exclude
    */
   private $products;

} 
```

查看[**JMSSerializer 文档**](http://jmsyst.com/bundles/JMSSerializerBundle/master/reference/annotations#exclude)以获取更多信息。

**编辑：**

例如，您可以使用 partial 关键字来仅选择您需要的数据。尽管如果我将实体对象传递给序列化程序（即使在 DoctrineProxyHandler 中禁用加载），我终其一生都无法禁用完整相关实体的加载（向下两层），但如果我使用数组，则比它通过代理不使用原则延迟加载（正如预期的那样）。

使用您的示例实体的示例：

```
$dql = "SELECT t, s, partial b.{id}, partial ss.{id}
        FROM Acme\AppBundle\Entity\Task t
        JOIN t.story s
        JOIN s.board b
        JOIN b.stories ss"

$q = $this->_em-createQuery($dql);

$result = $q->getArrayResult(); 
```

这样你会得到类似的东西：

```
[
{
    id: 33,
    title: "My Task",
    story: [
    {
        id: 554,
        board: [
        {
            id: 14,
            stories: [
            {
                id: 554
            },
            {
                id: 3424
            },
            {
                id: 3487
            }
            ]
        }
        ]
    }
    ]

}
] 
```

PS我实际上对这个“问题”很感兴趣。无论如何，我会看到如何在不使用数组结果的情况下序列化实体对象的解决方案。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-05-29T00:40:48.927

只是最新版JMSSerializer的更新，该看的地方是

JMS\Serializer\EventDispatcher\Subscriber\DoctrineProxySubscriber

代替

序列化程序\处理程序\DoctrineProxyHandler

要覆盖默认的延迟加载行为，应该定义自己的事件订阅者。

在你的 app/config.yuml 添加这个：

```
parameters:
    ...
    jms_serializer.doctrine_proxy_subscriber.class: Your\Bundle\Event\DoctrineProxySubscriber 
```

您可以将类从 JMS\Serializer\EventDispatcher\Subscriber\DoctrineProxySubscriber 复制到 Your\Bundle\Event\DoctrineProxySubscriber 并注释掉 $object->__load(); 线

```
public function onPreSerialize(PreSerializeEvent $event)
{
    $object = $event->getObject();
    $type = $event->getType();

    // If the set type name is not an actual class, but a faked type for which a custom handler exists, we do not
    // modify it with this subscriber. Also, we forgo autoloading here as an instance of this type is already created,
    // so it must be loaded if its a real class.
    $virtualType = ! class_exists($type['name'], false);

    if ($object instanceof PersistentCollection) {
        if ( ! $virtualType) {
            $event->setType('ArrayCollection');
        }

        return;
    }

    if ( ! $object instanceof Proxy && ! $object instanceof ORMProxy) {
        return;
    }

     //$object->__load(); Just comment this out

    if ( ! $virtualType) {
        $event->setType(get_parent_class($object));
    }
} 
```

更新：我最终编写了自己的简化版本的序列化工具：[https ://github.com/dlin-me/array-converter-bundle](https://github.com/dlin-me/array-converter-bundle)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-15T05:57:11.460

检查 JMSSerializerBundle 上的[Serializer/Handler/DoctrineProxyHandler.php](https://github.com/schmittjoh/JMSSerializerBundle/blob/master/Serializer/Handler/DoctrineProxyHandler.php)文件。现在，如果您评论这一行：

```
public function serialize(VisitorInterface $visitor, $data, $type, &$handled)
    {
        if (($data instanceof Proxy || $data instanceof ORMProxy) && (!$data->__isInitialized__ || get_class($data) === $type)) {
            $handled = true;

            if (!$data->__isInitialized__) {
                //$data->__load();
            } 
```

它将停止延迟加载您的实体。如果这是您正在寻找的内容，那么请继续[创建您自己的处理程序](http://jmsyst.com/bundles/JMSSerializerBundle/master/cookbook/custom_handlers)，您不会在其中延迟加载。

如果这不正确，我建议您在根据自己的喜好将实体发送到 JMSSerializerBundle 之前对其进行自定义。例如，在任何相关实体中，我都需要 ID，而在其他实体中，我需要自定义列名，如代码、名称或任何内容。

我只是创建我的实体对象的副本，然后开始获取我需要的关系字段。然后，我序列化该副本。JMSSerializerBundle 不会延迟加载，因为我已经提供了正确的字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-09T17:54:53.117

这是一个以通用方式选择一对一或一对多关联实体的 ID 而不使用连接的函数。

```
function selectWithAssociations($doctrine, $className) {

    $em = $doctrine->getManager();
    $meta = $em->getClassMetadata($className);

    //explicitly get IDs of associated entities
    $assocClauses = array();
    foreach ($meta->getAssociationMappings() as $assocName => $assoc) {
        if (isset($assoc['joinTable'])) {
            //todo: doesn't handle many to many associations
        } else {
            $assocClauses[] = ", IDENTITY(e.$assocName) AS $assocName";
        }
    }

    //run custom DQL query
    $q = $em->createQuery('SELECT e AS _d' . implode('', $assocClauses) . ' FROM ' . $className . ' e');
    $result = $q->getArrayResult();

    return $result;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-24T15:15:18.057

这是防止延迟加载一个或多个关联的类，可用作 JMS Serializer ExclusionStrategy。

```
use Doctrine\ORM\PersistentCollection;
use Doctrine\ORM\Proxy\Proxy;
use JMS\Serializer\Context;
use JMS\Serializer\Exclusion\ExclusionStrategyInterface;
use JMS\Serializer\Metadata\ClassMetadata;
use JMS\Serializer\Metadata\PropertyMetadata;
use JMS\Serializer\SerializationContext;

/**
 * Class OnlyLoadedAssociationsExclusionStrategy
 *
 * http://stackoverflow.com/questions/11851197/avoiding-recursion-with-doctrine-entities-and-jmsserializer
 */
class OnlyLoadedAssociationsExclusionStrategy implements ExclusionStrategyInterface
{
    public function shouldSkipClass(ClassMetadata $metadata, Context $context)
    {
    }

    public function shouldSkipProperty(PropertyMetadata $property, Context $context)
    {
        if ($context instanceof SerializationContext){
            $vistingSet=$context->getVisitingSet();

            //iterate over object to get last object
            foreach ($vistingSet as $v){
                $currentObject=$v;
            }

            $propertyValue=$property->getValue($currentObject);

            if ($propertyValue instanceof Proxy){
                // skip not loaded one association
                if (!$propertyValue->__isInitialized__){
                    return true;
                }
            }

            if ($propertyValue instanceof PersistentCollection){
                // skip not loaded many association
                if (!$propertyValue->isInitialized()){
                    return true;
                }
            }
        }
        return false;
    }
} 
```

使用示例：

```
$serializationContext->addExclusionStrategy(
     new OnlyLoadedAssociationsExclusionStrategy()
); 
```

# layout - 面板中的 MFC 功能区 CEdit 文本框对齐

> ID：11851201
> 
> 赞同：0
> 
> 时间：2012-08-07T17:37:29.823
> 
> 标签：layout, mfc, controls, ribbon, cedit

我试图将两个文本框与面板中的两个按钮对齐，但我找不到任何关于如何在 MFC 功能区面板内强制定位的信息。

这是我目前拥有的图片。

[http://i.imgur.com/ofD0b.jpg](http://i.imgur.com/ofD0b.jpg) （对不起，我还不能发布图片，必须链接。）

Change View Date 框下方有与之关联的框，更改系统日期框位于控件的第二“列”的右上角。我想解决这个问题，所以带有旋转控件的框位于更改视图日期旁边，而没有控件的框位于更改系统日期旁边。

想法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T21:29:45.060

我认为你做不到。您可以做的是在带有旋转控件的框之后放置一个功能区分隔符，然后在面板上设置属性“垂直居中列”。

希望它可以提供帮助。

# c# - 防止属性在 Web API 中被序列化

> ID：11851207
> 
> 赞同：185
> 
> 时间：2012-08-07T17:38:06.820
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-web-api

我正在使用 MVC 4 web API 和 asp.net web forms 4.0 来构建一个 rest API。它工作得很好：

```
[HttpGet]
public HttpResponseMessage Me(string hash)
{
    HttpResponseMessage httpResponseMessage;
    List<Something> somethings = ...

    httpResponseMessage = Request.CreateResponse(HttpStatusCode.OK, 
                                 new { result = true, somethings = somethings });

    return httpResponseMessage;
} 
```

现在我需要防止一些属性被序列化。我知道我可以在列表上使用一些 LINQ 并只获取我需要的属性，通常这是一个很好的方法，但是在目前的场景中，`something`对象太复杂了，我需要不同方法中的一组不同的属性，所以它是在运行时更容易标记要忽略的每个属性。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：251
> 
> 时间：2012-08-07T17:56:06.770

ASP.NET Web API[`Json.Net`](https://github.com/JamesNK/Newtonsoft.Json)用作默认格式化程序，因此如果您的应用程序仅使用 JSON 作为数据格式，您可以使用`[JsonIgnore]`忽略属性进行序列化：

```
public class Foo
{
    public int Id { get; set; }
    public string Name { get; set; }

    [JsonIgnore]
    public List<Something> Somethings { get; set; }
} 
```

但是，这种方式不支持 XML 格式。因此，如果您的应用程序*必须更多地*支持 XML 格式（或仅支持 XML），而不是使用`Json.Net`，您应该使用`[DataContract]`同时支持 JSON 和 XML 的：

```
[DataContract]
public class Foo
{
    [DataMember]
    public int Id { get; set; }
    [DataMember]
    public string Name { get; set; }

    //Ignore by default
    public List<Something> Somethings { get; set; }
} 
```

更多了解，可以阅读[官方文章](https://docs.microsoft.com/en-us/aspnet/web-api/overview/formats-and-model-binding/json-and-xml-serialization)。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2012-10-05T07:22:31.043

根据[ASP.NET Web API 中的 Web API 文档页面 JSON 和 XML 序列化](http://www.asp.net/web-api/overview/formats-and-model-binding/json-and-xml-serialization)显式防止对可以`[JsonIgnore]`用于 Json 序列化程序或`[IgnoreDataMember]`默认 XML 序列化程序的属性进行序列化。

但是在测试中我注意到这会`[IgnoreDataMember]`阻止 XML 和 Json 请求的序列化，所以我建议使用它而不是用多个属性装饰属性。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2013-08-16T12:53:05.690

您可以采用“选择加入”的方法，而不是让**所有内容默认序列化。**在这种情况下，只允许序列化您指定的属性。您可以使用[System.Runtime.Serialization](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization)命名空间中的[`DataContractAttribute`](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.datacontractattribute)and来执行此操作。[`DataMemberAttribute`](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.datamemberattribute)

`DataContactAttribute`应用于类，并且`DataMemberAttribute`应用于您要序列化的每个成员：

```
[DataContract]
public class MyClass {

  [DataMember]
  public int Id { get; set;} // Serialized

  [DataMember]
  public string Name { get; set; } // Serialized

  public string DontExposeMe { get; set; } // Will not be serialized
} 
```

我敢说这是一种更好的方法，因为它迫使您明确决定什么会或不会通过序列化实现。它还允许您的模型类自己存在于一个项目中，而不会仅仅因为您碰巧在其他地方使用 JSON.net 序列化它们而依赖于 JSON.net。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2013-10-17T20:35:47.467

这对我有用：创建一个自定义合同解析器，它有一个名为 AllowList 的字符串数组类型的公共属性。在您的操作中，根据操作需要返回的内容修改该属性。

**1.**创建自定义合约解析器：

```
public class PublicDomainJsonContractResolverOptIn : DefaultContractResolver
{
    public string[] AllowList { get; set; }

    protected override IList<JsonProperty> CreateProperties(Type type, MemberSerialization memberSerialization)
    {
        IList<JsonProperty> properties = base.CreateProperties(type, memberSerialization);

        properties = properties.Where(p => AllowList.Contains(p.PropertyName)).ToList();
        return properties;
    }
} 
```

**2.**使用自定义合约解析器

```
[HttpGet]
public BinaryImage Single(int key)
{
    //limit properties that are sent on wire for this request specifically
    var contractResolver = Configuration.Formatters.JsonFormatter.SerializerSettings.ContractResolver as PublicDomainJsonContractResolverOptIn;
    if (contractResolver != null)
        contractResolver.AllowList = new string[] { "Id", "Bytes", "MimeType", "Width", "Height" };

    BinaryImage image = new BinaryImage { Id = 1 };
    //etc. etc.
    return image;
} 
```

这种方法允许我允许/禁止特定请求，而不是修改类定义。如果您不需要 XML 序列化，请不要忘记在您的中将其关闭，`App_Start\WebApiConfig.cs`否则如果客户端请求 xml 而不是 json，您的 API 将返回被阻止的属性。

```
//remove xml serialization
var appXmlType = config.Formatters.XmlFormatter.SupportedMediaTypes.FirstOrDefault(t => t.MediaType == "application/xml");
config.Formatters.XmlFormatter.SupportedMediaTypes.Remove(appXmlType); 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2015-09-22T22:06:01.237

我将向您展示两种方法来完成您想要的：

**第一种方式：使用 JsonProperty 属性装饰您的字段，以便在该字段为空时跳过该字段的序列化。**

```
public class Foo
{
    public int Id { get; set; }
    public string Name { get; set; }

    [JsonProperty(NullValueHandling = NullValueHandling.Ignore)]
    public List<Something> Somethings { get; set; }
} 
```

**第二种方式：如果您正在与一些复杂的场景进行协商，那么您可以使用 Web Api 约定（“ShouldSerialize”）以便根据某些特定逻辑跳过该字段的序列化。**

```
public class Foo
{
    public int Id { get; set; }
    public string Name { get; set; }

    public List<Something> Somethings { get; set; }

    public bool ShouldSerializeSomethings() {
         var resultOfSomeLogic = false;
         return resultOfSomeLogic; 
    }
} 
```

WebApi 使用 JSON.Net 并且它使用反射来序列化，因此当它检测到（例如）ShouldSerializeFieldX() 方法时，名称为 FieldX 的字段将不会被序列化。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2014-03-07T18:48:33.980

我玩游戏迟到了，但是匿名对象可以解决问题：

```
[HttpGet]
public HttpResponseMessage Me(string hash)
{
    HttpResponseMessage httpResponseMessage;
    List<Something> somethings = ...

    var returnObjects = somethings.Select(x => new {
        Id = x.Id,
        OtherField = x.OtherField
    });

    httpResponseMessage = Request.CreateResponse(HttpStatusCode.OK, 
                                 new { result = true, somethings = returnObjects });

    return httpResponseMessage;
} 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2015-05-12T11:55:30.787

尝试使用`IgnoreDataMember`属性

```
public class Foo
    {
        [IgnoreDataMember]
        public int Id { get; set; }
        public string Name { get; set; }
    } 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2019-08-17T13:09:01.397

只需添加以下内容即可正常工作： **[IgnoreDataMember]**

在 propertyp 之上，例如：

```
public class UserSettingsModel
{
    public string UserName { get; set; }
    [IgnoreDataMember]
    public DateTime Created { get; set; }
} 
```

这适用于 ApiController。编码：

```
[Route("api/Context/UserSettings")]
    [HttpGet, HttpPost]
    public UserSettingsModel UserSettings()
    {
        return _contextService.GetUserSettings();
    } 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2017-02-22T03:13:19.980

几乎与 greatbear302 的答案相同，但我根据请求创建 ContractResolver。

1）创建自定义ContractResolver

```
public class MyJsonContractResolver : DefaultContractResolver
{
    public List<Tuple<string, string>> ExcludeProperties { get; set; }

    protected override JsonProperty CreateProperty(MemberInfo member, MemberSerialization memberSerialization)
    {
        JsonProperty property = base.CreateProperty(member, memberSerialization);

        if (ExcludeProperties?.FirstOrDefault(
            s => s.Item2 == member.Name && s.Item1 == member.DeclaringType.Name) != null)
        {
            property.ShouldSerialize = instance => { return false; };
        }

        return property;
    }
} 
```

2) 使用自定义合约解析器

```
public async Task<IActionResult> Sites()
{
    var items = await db.Sites.GetManyAsync();

    return Json(items.ToList(), new JsonSerializerSettings
    {
        ContractResolver = new MyJsonContractResolver()
        {
            ExcludeProperties = new List<Tuple<string, string>>
            {
                Tuple.Create("Site", "Name"),
                Tuple.Create("<TypeName>", "<MemberName>"),
            }
        }
    });
} 
```

**编辑：**

它没有按预期工作（每个请求隔离解析器）。我将使用匿名对象。

```
public async Task<IActionResult> Sites()
{
    var items = await db.Sites.GetManyAsync();

    return Json(items.Select(s => new
    {
        s.ID,
        s.DisplayName,
        s.Url,
        UrlAlias = s.Url,
        NestedItems = s.NestedItems.Select(ni => new
        {
            ni.Name,
            ni.OrdeIndex,
            ni.Enabled,
        }),
    }));
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-08-07T17:42:01.867

您也许可以使用 AutoMapper 并使用`.Ignore()`映射，然后发送映射的对象

```
CreateMap<Foo, Foo>().ForMember(x => x.Bar, opt => opt.Ignore()); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2020-09-28T04:36:50.017

对于 .NET Core 3.0 及更高版本：

> ASP.NET Core 的默认 JSON 序列化程序现在`System.Text.Json`是 .NET Core 3.0 中的新功能。尽可能考虑使用 System.Text.Json。它是高性能的，不需要额外的库依赖。

[https://docs.microsoft.com/en-us/aspnet/core/migration/22-to-30?view=aspnetcore-3.1&tabs=visual-studio#newtonsoftjson-jsonnet-support](https://docs.microsoft.com/en-us/aspnet/core/migration/22-to-30?view=aspnetcore-3.1&tabs=visual-studio#newtonsoftjson-jsonnet-support)

**样品**（感谢cuongle）

```
using System.Text.Json.Serialization;

public class Foo
{
    public int Id { get; set; }
    public string Name { get; set; }

    [JsonIgnore]
    public List<Something> Somethings { get; set; }
} 
```

如果您已经安装`Newtonsoft.Json`并选择使用它，默认情况下`[JsonIgnore]`将无法按预期工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-02-18T08:04:24.013

由于某种原因`[IgnoreDataMember]`并不总是对我有用，我有时会得到`StackOverflowException`（或类似的）。所以相反（或另外）我已经开始使用一个看起来像这样的模式，当`POST`我`Objects`进入我的 API 时：

```
[Route("api/myroute")]
[AcceptVerbs("POST")]
public IHttpActionResult PostMyObject(JObject myObject)
{
    MyObject myObjectConverted = myObject.ToObject<MyObject>();

    //Do some stuff with the object

    return Ok(myObjectConverted);
} 
```

所以基本上我传入一个`JObject`并在收到它后将其转换为避免由内置序列化程序引起的问题，这些问题有时会在解析对象时导致无限循环。

如果有人知道这是一个坏主意的原因，请告诉我。

可能值得注意的是，导致问题的 EntityFramework 类属性的以下代码（如果两个类相互引用）：

```
[Serializable]
public partial class MyObject
{
   [IgnoreDataMember]
   public MyOtherObject MyOtherObject => MyOtherObject.GetById(MyOtherObjectId);
}

[Serializable]
public partial class MyOtherObject
{
   [IgnoreDataMember]
   public List<MyObject> MyObjects => MyObject.GetByMyOtherObjectId(Id);
} 
```

# objective-c - Objective-C，Buzztouch 编码警报 - 格式字符串和语义问题未使用数据参数。有人可以解释发生了什么吗？

> ID：11851209
> 
> 赞同：0
> 
> 时间：2012-08-07T17:38:15.597
> 
> 标签：objective-c, ios, xcode, buzztouch

我目前正在运行安装了 Xcode 4.4 的 Mountain Lion OS X 10.8。我正在运行 iOS 5.1 模拟器。我在学习 Objective-C 和 Xcode 时使用 Buzztouch 作为学习工具。编译时收到以下警报，但构建成功。但是，我想确切地知道发生了什么以及如何补救这种情况。感谢您提供的任何帮助。这是我收到的代码和警报：

BT_fileManager.m

1.  格式字符串未使用数据参数 [BT_debugger showIt:self:[NSString stringWithFormat:@"readTextFileFromBundleWithEncoding ERROR using encoding NSUTF8StringEncoding, try NSISOLatin1StringEncoding", @""]];

2.  格式字符串未使用数据参数 [BT_debugger showIt:self:[NSString stringWithFormat:@"readTextFileFromCacheWithEncoding ERROR using encoding NSUTF8StringEncoding, try NSISOLatin1StringEncoding", @""]];

BT_camera_email.m

1.  语义问题将“BT_camera_email *”发送到不兼容类型“id”的参数

if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]) { NSLog(@"is camera ok"); UIActionSheet *photoSourceSheet = [[UIActionSheet alloc] initWithTitle:@"Select Image Source" delegate:self

再次，谢谢。

格雷格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:54:28.933

但是，我不知道 Buzztouch 可能是什么...... :-)

第一个警告相当简单。在格式字符串中，有以“%”符号开头的占位符来指示应替换数据值的位置。例如，要替换一个字符串，可以使用 '%@'。在您展示的示例中，没有占位符，但有**数据**值——空字符串。编译器警告说，您表示要放入由创建的新字符串中的东西`stringWithFormat:`不会。

为了确定第二个，我想查看声明的 .h 文件，`BT_camera_email`但我最好的猜测是它不采用`UIActionSheetDelegate`协议。的描述`initWithTitle:...`说第二个参数应该是`id<UIActionSheetDelegate>`，这可能是被抱怨的。

# jsf-2 - JSF 2 和基本 HTTP 身份验证

> ID：11851212
> 
> 赞同：1
> 
> 时间：2012-08-07T17:38:20.730
> 
> 标签：jsf-2, basic-authentication

我们有一个使用基本 HTTP 身份验证的 Web 应用程序。

web.xml

```
...
<login-config>
    <auth-method>BASIC</auth-method>
    <realm-name>file</realm-name>
</login-config>
... 
```

在深层代码空间的某个地方间接使用......

```
User getLogedUser(HttpServletRequest request) 
```

而且我必须在 JSF 2 中重写它，但我不知道如何在 JSF 2 中使用这种身份验证方法。（我找不到如何获得“HttpServletRequest 请求”的方法）

谷歌没有在他的首页上打出任何有用的信息

感谢您提前回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:58:18.170

我猜您正在寻找 返回用户名的[ExternalContext.getRemoteUser() 。](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#getRemoteUser%28%29)

用法：

```
FacesContext.getCurrentInstance().getExternalContext().getRemoteUser(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:22:07.747

原始`HttpServletRequest`文件在 JSF 中，由[`ExternalContext#getRequest()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#getRequest%28%29).

```
ExternalContext ec = FacesContext.getCurrentInstance().getExternalContext();
HttpServletRequest request = (HttpServletRequest) ec.getRequest();
// ... 
```

但是，我认为最好将`getLoggedUser()`方法更改为使用远程用户。

```
User getLoggedUser(String remoteUser) 
```

这样你就可以喂它[`ExternalContext#getRemoteUser()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#getRemoteUser%28%29)或喂它[`HttpServletRequest#getRemoteUser()`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getRemoteUser%28%29)。这也将方法与任何 Servlet API 或 JSF API 依赖项分离。

# ubuntu - 命令开始的颜色终端线

> ID：11851215
> 
> 赞同：0
> 
> 时间：2012-08-07T17:38:48.567
> 
> 标签：ubuntu, command-line, terminal

有什么方法可以在 Ubuntu 下为终端的输入行着色。我的用例是如果我运行一个输出大量行的命令，例如堆栈跟踪，那么能够看到我输入命令的位置会很好，这样我就可以很容易地看到它从哪里开始。终端的设置方式现在是全黑的，这使得很难看到上次运行的输出在哪里停止以及当前输出从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T01:35:36.917

在 .bashrc 中，取消注释“force_color_prompt=yes”行

# sql-server - Grails dbCreate='validate' 无法识别现有表

> ID：11851217
> 
> 赞同：2
> 
> 时间：2012-08-07T17:38:59.563
> 
> 标签：sql-server, grails, datasource, grails-orm

我的数据源配置如下：

```
development {
    dataSource {
        dbCreate = "validate"
        url = "jdbc:sqlserver://myservername"
    }
} 
```

我的 SQL Server“myservername”有一个数据库“products”，其中有一个“dbo”拥有的表“inventory”。这是我的 Inventory 类映射：

```
static mapping = {
    table 'products.dbo.inventory'
    version false
    columns {
        id column: 'itemKey'
        itemId column: 'itemId'
        inactive column: 'inactive'
    }
} 
```

当我尝试运行该应用程序时，我收到此错误：

*嵌套异常是 org.hibernate.HibernateException: Missing table: products.dbo.inventory*

**此外，当我将 dbCreate 从“验证”更改为“更新”或任何其他时，它工作正常。**

任何想法为什么？

在此先感谢，
斯库德

编辑以回答问题 -

我将更改合并到我的对象中，但仍然出现错误。这是我的对象：

```
class Inventory {

Integer id
String itemId
String description
Boolean inactive

static mapping = {
    table 'products.dbo.inventory'
    version false
    columns {
        id column: 'itemKey'
        itemId column: 'itemId'
        description column: 'description'
        inactive column: 'inactive'
    }
}

static constraints = {
    itemId (maxSize: 30)
    description (maxSize: 100)
}

static hasMany = [productInventoryDefaults: ProductInventoryDefaults, productTreeNodes: ProductTreeNodes]

String toString() {
    return this.itemId
}

} 
```

和表：

```
CREATE TABLE [dbo].[inventory](
[itemKey] [int] NOT NULL,
[itemId] [varchar](30) NOT NULL,
[description] [varchar](100) NOT NULL,
[inactive] [bit] NOT NULL,
 CONSTRAINT [PK_Inventory] PRIMARY KEY CLUSTERED 
(
[itemKey] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T07:11:11.517

我相信这里Hibernate没有办法看到如何生成主键。

我会尝试：

*   `id`将字段更改为`IDENTITY`；
*   或/和调整[`id`字段映射](http://grails.org/doc/latest/ref/Database%20Mapping/id.html)以使用 Java 端`generator`；
*   或者，甚至更简单，尝试连接到具有`dbCreate = "create"`适当权限的测试数据库，查看 Hibernate 将创建什么表结构，然后将您的表更改为该表结构。

如果需要保持表结构不变，那么只有第二种方式了。

# javascript - 取消 iframe 中具有 target="_parent" 属性的链接事件

> ID：11851218
> 
> 赞同：1
> 
> 时间：2012-08-07T17:39:09.730
> 
> 标签：javascript, jquery

我有一个 iframe，它显示另一个域上的网站，其中包含具有`target="_parent"`属性的链接。因此，它不是在 iframe 中加载链接，而是重定向整个页面。有没有办法捕捉这个事件，取消它，并使用 jQuery 或直接使用 javascript 将 iframe 的 url 设置为该链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:57:52.450

对于支持它的浏览器，你能做的最好的就是使用[`sandbox`-attribute](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-iframe-element.html#attr-iframe-sandbox)：

```
<iframe sandbox="allow-forms allow-scripts allow-same-origin"></iframe> 
```

`"allow-top-navigation"`除非您在属性中列出，否则现在不允许 iframe 更改顶部位置。

但是链接在 iframe 中不起作用，链接根本不起作用，并且在控制台中记录了安全错误：

[http://jsfiddle.net/rRT6S/3/](http://jsfiddle.net/rRT6S/3/)

# javascript - tinymce 列宽可调整大小的表格

> ID：11851219
> 
> 赞同：2
> 
> 时间：2012-08-07T17:39:12.087
> 
> 标签：javascript, tinymce

我正在使用 tinymce，它提供了创建表的表插件。表格绘制在 textarea 中，并且由于 contenteditable 属性，表格可以使用句柄调整大小。当我调整表格大小或合并两个单元格时，单元格的宽度会丢失。

即使是合并单元格或正常单元格，宽度也永远不会计算正确。在萤火虫上，我使用了各种 jquery stmt，例如

$(td).width() - 给出 0px $(td).attr("style") - 样式的宽度与插入期间设置的宽度相同，因此没有变化 $(td).css("width") -给 0px 或有时非常少的值。$(td)[0].offsetWidth - 给出 0px

我确实看到 tbl 宽度和高度在样式属性中具有正确的值，并且根据拖动句柄的方式自动设置，但从未设置列宽高度，尽管我看到它们已正确调整大小。

# regex - 匹配 vi 中包含一组字符串的任何排列的行

> ID：11851220
> 
> 赞同：3
> 
> 时间：2012-08-07T17:39:30.990
> 
> 标签：regex, perl, vim

我正在尝试搜索包含一组单词的任何排列的行（不区分大小写）。例如，如果我对`foo`and感兴趣`bar`，我想匹配前四行，而不是下面的最后四行`file`：

```
Foo and bar.
Bar and foo.
The foo and the bar.
The bar and the foo.
Foobar.
Barfoo.
The foobar.
The barfoo. 
```

看过[这篇文章后](https://stackoverflow.com/q/2219830/873757)，我意识到我可以在以下位置构建类似的东西`perl`：

```
perl -n -e 'print if (/\bfoo\b.*?\bbar\b/i || /\bbar\b.*?\bfoo\b/i)' file 
```

仅正确匹配前四行。或者，使用[本文](https://stackoverflow.com/q/469913/873757)建议的前瞻结构，可以使用更简洁的代码进行匹配：

```
perl -n -e 'print if (/(?=.*\bfoo\b)(?=.*\bbar\b)/i)' file 
```

但是，我无法弄清楚如何用`vim`正则表达式语法编写这些，我发现它比`perl`正则表达式语法更加拜占庭式。我在`vim`使用搜索功能（`/`或`?`）时尝试了许多不同的表达式，但没有一个能产生成功的匹配。我意识到，而不是使用的`(?=string)`语法`perl`，`vim`使用`\(string\)\@=`和`string\&`。

然而，各种尝试，例如：

*   `\c\(foo\)\@=\(bar\)@=`
*   `\c\(foo\)\@=\.*\(bar\)@=`
*   `\cfoo\&bar\&`

（where`\c`用于不区分大小写的匹配）都失败了。

有人可以演示正确的`vim`语法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T17:45:53.570

试试：`\c.*\<foo\>.*\&.*\<bar\>.*`。这应该与前四行中的每一行匹配。

您与 最接近`\c\(foo\)\@=\(bar\)@=`，但由于您不希望 eg`foobar`进行`barfoo`匹配，因此有必要使用单词匹配的开头/结尾：`\<\>`。

使用`\&`稍微简化了模式。

如果您不需要该模式的*整*行匹配，只需点击匹配的任何行，您可以通过消除模式中的尾随`.*`部分来进一步简化此正则表达式：`\c.*\<foo\>\&.*\<bar\>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:46:07.657

尝试以下操作：

```
/^\c\(.*\<foo\>\)\@=\(.*\<bar\>\)\@=/ 
```

这与 Perl 的前瞻版本相同，`\@=`使前一个元素或组成为正前瞻。 `\<`和`\>`是 vim 等价于`\b`, 并`\c`启用不区分大小写的匹配。我添加了`^`锚点，因此它只会匹配每一行一次。

# postgresql - PL/Python 或 Psycopg2

> ID：11851223
> 
> 赞同：-1
> 
> 时间：2012-08-07T17:39:44.527
> 
> 标签：postgresql, psycopg2, plpython

我有一个 Postgresql 9.1 服务器，我想在 Python 上编写一些函数。

有 2 种方法：`plpy`或`psycopg2`。对我来说，在 plpy 中编写函数就像一场噩梦，大量的“准备”和“执行”方法……使用起来更舒服`psycopg2`，但我关心的是效率。

在服务器上使用 psycopg2 是否正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:23:22.727

They are 2 different things. plpy (PL/Python) is a stored procedure language like PLpgSQL and psycopg2 is a client library which allows Python code to access a PostgreSQL database. With PL/Python, you will need to make a connection to the database and then call your function from the database. With psycopg2, you would write Python code to call the database. Unless you have specific requirements of writing a Python function that runs from within PostgreSQL itself, use pysocpg2\.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T19:48:22.873

> 对我来说，用 plpy 编写函数就像一场噩梦

你已经下定决心了。即使您使用 pl/python，代码中的任何错误都将归因于语言或其环境。一段时间后，您将能够放弃您的 pl/python 代码并以您一直想要的方式重新实现它^*。

它的美妙之处在于，正如 Jim 上面所说，这两个接口做了完全不同的事情——一个在单个事务中在数据库内部运行，另一个作为普通客户端代码在外部运行。两种语言的用例之间几乎没有重叠。不知何故，即使您在决定哪个是“好”或“坏”时也错过了这一点。

^*我们都有自己的编程偏见，但我不确定用大胆的陈述来打开一个问题是否有什么意义。

# mysql - 将外部/未经身份验证的用户存储在数据库中的正确方法是什么？

> ID：11851226
> 
> 赞同：-1
> 
> 时间：2012-08-07T17:40:04.390
> 
> 标签：mysql, sql, database, postgresql, activerecord

我的网站支持注册用户和非注册用户之间的通信。我正在尝试确定在数据库中存储非注册用户的最佳实践。我的初始架构如下：

```
Users
------------
user_id
device_id *Unique* (this is for mobile app users)
email *Unique*
phone *Unique*
first_name
last_name
image_url
date_joined

UserNames  (Users have custom names for each group potentially)
-------------
name_id
user_id
group_id
first_name
last_name 
```

该应用程序如何工作的更多详细信息：

*   用户注册并创建包括注册和非注册用户的组/列表
*   然后将消息发送给组/列表的成员
*   注意：注册用户可以在未经他们明确批准的情况下将非注册用户添加到列表中。

我选择上面列出的设计是因为电子邮件、电话号码和设备 ID 是唯一的。但是，用户可能对每个用户有不同的名称/昵称，因此 UserNames 表。但是，我不清楚存储非注册用户是否应该存储在用户表中，因为他们在技术上不是网站的注册用户。

我应该将未注册/外部用户存储在单独的表中吗？如果您需要我澄清任何事情，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:44:23.540

您是否将未注册用户隔离到他们自己的表中是一个设计决策，可能只有您可以回答。这可能取决于在整个应用程序中如何使用这些不同的用户类型。它可能很简单，例如使用带有 0 或 1 值的 tinyint 字段来指示用户已注册。

# java - 如何在安卓模拟器上运行相机依赖程序

> ID：11851232
> 
> 赞同：0
> 
> 时间：2012-08-07T17:40:32.107
> 
> 标签：java, android, eclipse

我制作了一些程序，其中我需要使用笔记本相机拍摄照片并通过电子邮件发送。问题是我既不能发送电子邮件，也不能通过模拟器使用相机拍摄照片。我已经通过了一些建议的解决方案，例如“tomgibara”，但像大多数人一样，在使用相机时它对我不起作用。而且我还没有找到通过 emulaotr 发送电子邮件的任何解决方案，因为没有选项。我没有安卓设备来运行这些程序。有什么办法可以解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:32:12.897

在我的模拟器上，你不能使用相机或发送邮件，你要么必须在手机、平板电脑或安卓设备上测试它（不是模拟器）。打开调试模式，或者只是假设它可以工作......

# javascript - 图像滑块计时器的单击事件

> ID：11851236
> 
> 赞同：0
> 
> 时间：2012-08-07T17:40:40.293
> 
> 标签：javascript, jquery, html

我只是在使用计时器处理图像滑块。但是有一些问题...

1.  图片与文字不同步
2.  我需要一个缩略图计时器的点击事件，点击该图像应该以明确的间隔发生变化。

这是我正在尝试的链接：

[http://jsfiddle.net/alex_ball/UgQJG/](http://jsfiddle.net/alex_ball/UgQJG/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T06:48:41.650

我注意到同步。问题是在显示图像完整循环后解决的，所以它与图像的下载速度有关。假设您在幻灯片放映中使用 1.jpg、2.jpg、3.jpg 和 4.jpg。因此，您将首先将它们包含在您使用的 div 面板之前显示的 none div 中。

```
 <div style="display:none">
    <img src='1.jpg' />
    <img src='2.jpg' />
    <img src='3.jpg' />
    <img src='4.jpg' />
    </div>

    <div id="panel">
      <div id="title">
      </div>
      <img id="imageSlide" alt="" src="" width="250px"/>
      <div id="desc">
      </div>
    </div>
<script>
//JavaScript slide initiation code here.
</script> 
```

这将允许页面在呈现幻灯片之前下载图像，因此图像将准备好以与文本相同的速度进行维护。

# c# - 从 C++ 调用 C#

> ID：11851237
> 
> 赞同：3
> 
> 时间：2012-08-07T17:40:40.867
> 
> 标签：c#, c++, visual-c++

我一直在寻找一种方法来从 C++ DLL 项目中调用用 C# EXE 项目（VS 2008）编写的函数。如果可能的话，我可以将 C# 代码作为 C++ 项目本身的一部分。我所能找到的只是从 C++ 调用 C# DLL。

最终我想从 VB6 调用 C# 代码，但我以这种方式提出问题，因为我不相信没有中间步骤就可以采用后一种方式。

谢谢，

伊恩

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T17:43:22.167

> 最终我想从 VB6 调用 C# 代码，但我以这种方式提出问题，因为我不相信没有中间步骤就可以采用后一种方式。

您可以将 C# 类注册为对 COM 可见，然后直接从 C++ 或 VB6 调用它们。

有关详细信息，请参阅 MSDN 上的[示例 COM 类](http://msdn.microsoft.com/en-us/library/c3fd4a20.aspx)以及[互操作性](http://msdn.microsoft.com/en-us/library/ms173184.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:45:17.050

您可以使用 /CLR 选项编译您的 c++ 项目，然后在其中调用 C#。为此，您需要包含 vcclr.h，然后为需要调用的每个 dll 添加一条 using 语句。

```
#include <vcclr.h>
#using <System.dll> 
```

# c# - 为什么没有在 Page_Load 事件处理程序中设置 Label 控件的文本属性？

> ID：11851238
> 
> 赞同：-2
> 
> 时间：2012-08-07T17:40:41.390
> 
> 标签：c#, asp.net, .net

**标记：**

```
<%@ Page Language="C#" AutoEventWireup="false" CodeBehind="Files.aspx.cs" Inherits="WebModules.Web.Files" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">

</head>
<body>
    <form id="form1" method="post" runat="server">
        <asp:Label ID="Status" runat="server" />
    </form>
</body>
</html> 
```

**代码背后：**

```
using System;
using System.Collections;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Web;
using System.Web.SessionState;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;
using System.IO;

namespace WebModules.Web
{
    public partial class Files : System.Web.UI.Page
    {
        private void Page_Load(object sender, EventArgs e)
        {
            Status.Text="Hello";
        }

        private void Page_Init(object sender, EventArgs e)
        {
            InitializeComponent();
        }

        private void InitializeComponent()
        {
            this.Load += new System.EventHandler(this.Page_Load);
        }
    }
} 
```

当我在浏览器中运行页面时，标签上没有显示文本“Hello”。

有谁知道为什么这不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:46:04.273

您可能想尝试将方法上的访问修饰符从**private**更改为**protected**：

```
//I'm assuming that Files is the class of your page, and not just another class. Make sure that your markup inherits from this class
public partial class Files : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        Status.Text="Hello";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:56:43.823

我将您的标签和页面加载代码复制粘贴到我当前的应用程序中，它显示正常。

做这个：

protected void Page_Load(object sender, EventArgs e)

```
{
Status.Text="Hello";          
} 
```

然后将标签 ID 放在您的源代码中：

```
<asp:Label ID="Status" runat="server" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:04:37.950

我已经修好了！我刚刚将属性更改`AutoEventWireup="false"`为`AutoEventWireup="true"`. 现在工作正常

# arrays - R中的匹配范围合并

> ID：11851240
> 
> 赞同：1
> 
> 时间：2012-08-07T17:40:47.090
> 
> 标签：arrays, r, merge, range, match

我想合并/合并两个文件，这样如果我的第一个文件的 B 列中的条目落入我的第二个文件中的 B 列和 C 列的范围内，则输出将包含两个文件中包含的所有信息。

像这样：

文件 1

```
 A      B
    rs10    23353
    rs100   10000
    rs234   54440 
```

文件 2

```
 A        B      C
    E235    20000   30000
    E255    50000   60000 
```

其中，因为 23353 介于 20000 和 30000 之间，而 54440 介于 50000 和 60000 之间，所以输出文件如下所示：

```
rs      23353   E235    20000   30000
rs234   54440   E255    50000   60000 
```

并且 rs100 将被删除（从输出文件中），因为它不在文件 2 中任何行的范围内。

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:24:25.797

像这样的东西应该可以解决问题。您可能可以使其更简洁，但为了阐明所有步骤，我将其变得过于明显。

```
NewMatrixCol1 <- c()
NewMatrixCol2 <- c()
NewMatrixCol3 <- c()
NewMatrixCol4 <- c()
NewMatrixCol5 <- c()

for (i in 1:length(file1$A)) {
    for (j in 1:length(file2$A)) {
        LowNumber <- file2$B[j]
        HighNumber <- file2$C[j]
        if (LowNumber <= file1$B[i] & file1$B[i]  <= HighNumber) {
            append(NewMatrixCol1, file1$A[i])
            append(NewMatrixCol2, file1$B[i])
            append(NewMatrixCol3, file2$A[j])
            append(NewMatrixCol4, file2$B[j])
            append(NewMatrixCol5, file2$C[j])
        } else {}
    }
}

dataframe <- data.frame(Col1 = NewMatrixCol1, Col2 = NewMatrixCol2, Col3 = NewMatrixCol3, Col4 = NewMatrixCol4, Col5 = NewMatrixCol5) 
```

EDIT1：我误解了这个问题，现在正在研究它。

EDIT2：这个新的解决方案应该按指示工作。

EDIT3：`)`如 mfk534 所示，缺少 .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T19:44:26.490

我看到您已经接受了答案，但这是另一种可能的解决方案。

这个功能只是被组合在一起，但可以进行更多工作以使其更通用。

```
myfun = function(DATA1, DATA2, MATCH1, MIN, MAX) {
  temp = sapply(1:nrow(DATA2), 
                function(x) DATA1[[MATCH1]] >= DATA2[[MIN]][x] &
                  DATA1[[MATCH1]] <= DATA2[[MAX]][x])
  if (isTRUE(any(rowSums(temp) == 0))) {
    temp1 = DATA1[-(which(rowSums(temp) == 0)), ]
  }
  OUT = cbind(temp1[order(temp1[[MATCH1]]), ], 
              DATA2[order(DATA2[[MIN]]), ], row.names=NULL)
  condition = ((OUT[4] <= OUT[2] & OUT[2] <= OUT[5]) == 0)
  if (isTRUE(any(condition))) {
    OUT[-which(condition), ]
  } else {
    OUT
  }
} 
```

以下是该函数的作用：

1.  它首先逐行比较 first 的第二列中的`data.frame`值与 second 的第二列和第三列中的值`data.frame`。
2.  然后，它会检查其中是否有任何一个`FALSE`同时满足这两个条件，并将它们从第一个`data.frame`.
3.  然后，它按`data.frame`第二列对第一个排序，第二个`data.frame`按“min”匹配列排序。
4.  最后，它再次检查以确保第一个数据集中的值在提供的值之间；如果不是，则删除该行。

现在，这里有一些示例数据。`A`并且`B`与您提供的数据相同。`X`并`Y`已为进一步测试目的进行了更改。在 和 之间的合并中`X`，`Y`应该只有一行。

```
A = read.table(header=TRUE, text="A      B
    rs10    23353
    rs100   10000
    rs234   54440")

B = read.table(header=TRUE, text="A        B      C
    E235    20000   30000
    E255    50000   60000")

X = A[c(3, 1, 2), ]
X[1, 2] = 57000
Y = B
Y[2, 3] = 55000 
```

以下是您将如何使用该函数以及您将获得的输出。

```
myfun(A, B, 2, 2, 3)
#       A     B    A     B     C
# 1  rs10 23353 E235 20000 30000
# 2 rs234 54440 E255 50000 60000
myfun(X, Y, 2, 2, 3)
#      A     B    A     B     C
# 1 rs10 23353 E235 20000 30000 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T00:38:29.710

更新：这个问题比这里指出的要复杂。解决方案可以在这里找到：[Merge by Range in R - Applying Loops](https://stackoverflow.com/questions/11892241/merge-by-range-in-r-applying-loops)`GenomicRanges` ，并使用Bioconductor中的包交付。非常有用的包！

# c++ - 音频处理 C++ - FFT

> ID：11851245
> 
> 赞同：6
> 
> 时间：2012-08-07T17:41:08.763
> 
> 标签：c++, algorithm, math, fft

我可能会错误地问这个问题，让自己看起来很愚蠢，但这里是：

我正在尝试对 .wav 文件进行一些音频操作和处理。现在，我可以读取所有数据（包括标题），但需要数据频率，为此我需要使用 FFT。

我在网上到处搜索，找到了一个，示例是从“C 中的数字食谱”一书中取出的，但是，我将其修改为使用向量而不是数组。好的，这就是问题所在：

我已经得到（作为一个例子使用）一系列数字和采样率：

```
X = {50, 206, -100, -65, -50, -6, 100, -135} 
```

采样率：8000 样本数：8

因此应该回答这个问题：

```
 0Hz     A=0       D=1.57079633
  1000Hz     A=50      D=1.57079633
  2000HZ     A=100     D=0
  3000HZ     A=100     D=0
  4000HZ     A=0       D=3.14159265 
```

我重新编写的代码可以编译，但是，当尝试将这些数字输入到方程（函数）中时，我得到一个分段错误。我的代码有问题，还是采样率太高？（当使用小得多的采样率时，该算法不会分段）。这是代码：

```
#include <iostream>
#include <math.h>
#include <vector>
using namespace std;

#define SWAP(a,b) tempr=(a);(a)=(b);(b)=tempr;
#define pi 3.14159

void ComplexFFT(vector<float> &realData, vector<float> &actualData, unsigned long sample_num, unsigned int sample_rate, int sign)
{
    unsigned long n, mmax, m, j, istep, i;
    double wtemp,wr,wpr,wpi,wi,theta,tempr,tempi;

    // CHECK TO SEE IF VECTOR IS EMPTY;

    actualData.resize(2*sample_rate, 0);

    for(n=0; (n < sample_rate); n++)
    {
        if(n < sample_num)
        {
            actualData[2*n] = realData[n];
        }else{
            actualData[2*n] = 0;
            actualData[2*n+1] = 0;
        }
    }

    // Binary Inversion
    n = sample_rate << 1;
    j = 0;

    for(i=0; (i< n /2); i+=2)
    {
        if(j > i)
        {
            SWAP(actualData[j], actualData[i]);
            SWAP(actualData[j+1], actualData[i+1]);
            if((j/2)<(n/4))
            {
                SWAP(actualData[(n-(i+2))], actualData[(n-(j+2))]);
                SWAP(actualData[(n-(i+2))+1], actualData[(n-(j+2))+1]);
            }
        }
        m = n >> 1;
         while (m >= 2 && j >= m) {
          j -= m;
          m >>= 1;
         }
         j += m;
     }
     mmax=2;

     while(n > mmax) {

        istep = mmax << 1;
        theta = sign * (2*pi/mmax);
        wtemp = sin(0.5*theta);
        wpr = -2.0*wtemp*wtemp;
        wpi = sin(theta);
        wr = 1.0;
        wi = 0.0;

        for(m=1; (m < mmax); m+=2) {
            for(i=m; (i <= n); i += istep)
            {
                j = i*mmax;
                tempr = wr*actualData[j-1]-wi*actualData[j];
                tempi = wr*actualData[j]+wi*actualData[j-1];

                actualData[j-1] = actualData[i-1] - tempr;
                actualData[j] = actualData[i]-tempi;
                actualData[i-1] += tempr;
                actualData[i] += tempi;
            }
            wr = (wtemp=wr)*wpr-wi*wpi+wr;
            wi = wi*wpr+wtemp*wpi+wi;
        }
        mmax = istep;
    }

    // determine if the fundamental frequency
    int fundemental_frequency = 0;
    for(i=2; (i <= sample_rate); i+=2)
    {
        if((pow(actualData[i], 2)+pow(actualData[i+1], 2)) > pow(actualData[fundemental_frequency], 2)+pow(actualData[fundemental_frequency+1], 2)) {
            fundemental_frequency = i;
        }

    }
}
int main(int argc, char *argv[]) {

    vector<float> numbers;
    vector<float> realNumbers;

    numbers.push_back(50);
    numbers.push_back(206);
    numbers.push_back(-100);
    numbers.push_back(-65);
    numbers.push_back(-50);
    numbers.push_back(-6);
    numbers.push_back(100);
    numbers.push_back(-135);

    ComplexFFT(numbers, realNumbers, 8, 8000, 0);

    for(int i=0; (i < realNumbers.size()); i++)
    {
        cout << realNumbers[i] << "\n";
    }
} 
```

另一件事，（我知道这听起来很愚蠢）但我真的不知道通过 ComplexFFT 函数传递的“int 符号”的预期是什么，这就是我可能出错的地方。

有没有人对这个问题有任何建议或解决方案？

谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:30:43.193

我认为问题在于您如何翻译算法的错误。

*   您的意思是初始化`j`为`1`而不是`0`？

*   `for(i = 0; (i < n/2); i += 2)`应该是`for (i = 1; i < n; i += 2)`。

*   你`SWAP`的 s 应该是

    ```
    SWAP(actualData[j - 1], actualData[i - 1]);
    SWAP(actualData[j], actualData[i]); 
    ```

*   下面`SWAP`的 s 是干什么用的？我不认为他们是必要的。

    ```
    if((j/2)<(n/4))
    {
        SWAP(actualData[(n-(i+2))], actualData[(n-(j+2))]);
        SWAP(actualData[(n-(i+2))+1], actualData[(n-(j+2))+1]);
    } 
    ```

*   如果您打算进行位反转，则in`j >= m`可能*应该*`while (m >= 2 && j >= m)`是。*`j > m`*

**   在实现 Danielson-Lanczos 部分的代码中，您确定`j = i*mmax;`不应该是一个附加项，即`j = i + mmax;`？* 

 ** * *

除此之外，您还可以做很多事情来简化代码。

`SWAP`当您可以使用时不鼓励使用您的宏[`std::swap`](http://www.cplusplus.com/reference/algorithm/swap/)... 我本来打算建议[`std::swap_ranges`](http://www.cplusplus.com/reference/algorithm/swap_ranges/)，但后来我意识到您只需要交换实部，因为您的数据都是实数（您的时间序列虚部都是`0`）：

```
std::swap(actualData[j - 1], actualData[i - 1]); 
```

您也可以使用 来简化整个事情[`std::complex`](http://www.cplusplus.com/reference/std/complex/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:57:54.510

我认为它取决于您的矢量的重新调整大小。

一种可能性：也许重新调整大小会在我认为将它们移回堆之前在堆栈上创建临时对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T18:29:28.590

*C 中的数值配方中*的 FFT使用[Cooley-Tukey 算法](http://en.wikipedia.org/wiki/Cooley%E2%80%93Tukey_FFT_algorithm)，因此在最后回答您的问题时，`int sign`传递的允许使用相同的例程来计算正向 ( `sign=-1`) 和逆 ( `sign=1`) FFT。这似乎与`sign`您定义`theta = sign * (2*pi/mmax)`.*

# actionscript-3 - flash as3 如何删除部分字节数组？

> ID：11851251
> 
> 赞同：3
> 
> 时间：2012-08-07T17:41:23.117
> 
> 标签：actionscript-3, flash, bytearray

var fData:ByteArray = new ByteArray();

我需要删除此数组中的一些字节，但在 Flash 中找不到任何公共方法来执行此操作。我搜索了类似 fData.remove(start,length) 但没有成功。

这是一个代码

```
 function _dlProgressHandler(evt:ProgressEvent):void { //this is progressEvent for URLStream

............... ///some code

var ff:ByteArray = new ByteArray();

stream.readBytes(ff,0,stream.bytesAvailable);
fileData.writeBytes(ff,0,ff.length); //stream writes into fileData byteArray

//and here is cutter:

fileData.position=0;
fileData.writeBytes(ff,100,fileData.length);
fileData.length=fileData.length-100);

} 
```

所以，fileData 有时会出人意料地自我切割。有时旧块会被找到两次，有时它们根本找不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:57:11.543

您始终可以只读取您想要的字节，这与丢弃您不想要的字节具有相同的效果。作为一个非常简单的示例，假设您有一个 10 字节长的 ByteArray，并且您想要丢弃前 3 个字节：

```
var newBytes:ByteArray = new ByteArray();
newBytes.writeBytes(fData, 2, 7); 
```

因此，与其从 fData 中删除您不想要的字节，您只需创建一个新的 ByteArray 并仅从 fData 中获取您想要的字节。

显然，如果您要删除的字节序列不仅仅是从 fData 的开头或结尾开始的序列，它会稍微复杂一些，但方法保持不变：读取您想要的字节，而不是删除那些你没有。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-07T22:41:20.650

AS-3 有时实际上非常好。这会从您想要的任何位置从数组中删除字节。开头、中间或结尾。只需要检查索引以避免`IndexOutOfBounds`

```
var array: ByteArray = ...; // create the byte array or load one
var index: int = 4;
var count: int = 5;

array.position = index;
array.writeBytes(array, index + count, array.length - (index + count));
array.length = array.length - count; 
```

*   我对此进行了测试，效果很好，只是缺少检查
*   字节数组**可以**写入自身

# java - CreateProcess 错误 = 5，拒绝访问

> ID：11851253
> 
> 赞同：-2
> 
> 时间：2012-08-07T17:41:34.360
> 
> 标签：java

//编辑：我不知道我这样做的原因，但它适用于插入 y.toString() 作为路径的突起

:(

不管怎么说，还是要谢谢你

如果我尝试执行文件并将路径作为变量，它不起作用，我不断收到“拒绝访问”错误。但是当硬编码完全相同的字符串时，程序可以正常启动

```
File[] files = dir.listFiles();

for(File x : files){
    File[] childfiles = x.listFiles();
    for (File y: childfiles){

    if(y.toString().endsWith(".exe")){

        String fstring ="\"\\\"";
        String lstring ="\\\"\"";

       Process p = Runtime.getRuntime().exec(
                fstring+y.toString().replace("\\","/")+lstring;
                p.waitFor();

    }
} 
```

在我直接输入文件路径时，它工作正常（看起来完全一样）与我在 exec 中插入的字符串相同

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:35:27.770

假设您正在执行“abc.exe”。

根据`fstring+abc.exe+lstring`表格 to`"\"abc.exe\""`和替换后的表格`/`to `"/"abc.exe/""`。这是执行的错误输入。

直接执行`.exe`为：

```
Process p = Runtime.getRuntime().exec(y.getName());
int responseCode = p.waitFor(); 
```

# c# - 分组下拉列表并将它们应用于一组方程

> ID：11851257
> 
> 赞同：1
> 
> 时间：2012-08-07T17:41:40.527
> 
> 标签：c#, asp.net, drop-down-menu, grouping

我对使用这个网站和 C# .Net 很陌生，所以要温柔！

**我的项目是什么？** 我正在为我父母的副业创建一个时间表，医生可以在线填写。我创建了通话时间和常规时间，用于将通话时间和常规时间等同起来。

**我想完成什么？** 我希望用户单击一个提交按钮，并让与每一天相对应的每组下拉列表通过方程式运行并给出总数。

**我的问题是什么**？我如何首先关闭 - 对一组下拉列表进行分组，然后 - 代码看起来如何像“对于某些标签（LabelMondayCALL.Text），使用该组（DDL_In_Monday、DDL_OutBreak_Monday 等）的下拉列表找出标签是什么。”

**我为什么要这样做？**为了避免在每一天复制和粘贴代码页面，并尝试保持事情的清洁和简单，以应对未来可能的变化。

这是一些代码：

```
 DateTime MondayDDL4 = DateTime.Parse(DDL_Out_Monday.SelectedValue);
    DateTime MondayDDL3 = DateTime.Parse(DDL_InBreak_Monday.SelectedValue);
    DateTime MondayDDL2 = DateTime.Parse(DDL_OutBreak_Monday.SelectedValue);
    DateTime MondayDDL1 = DateTime.Parse(DDL_In_Monday.SelectedValue);

else if ((MondayDDL1 <= FromCompHours) & (MondayDDL4 <= FromCompHours)) //comp time earlier than 6:30
    {
        LabelMondayREG.Text = "00:00:00";//works
        LabelMondayCALL.Text = MondayDDL4.Subtract(MondayDDL1).ToString();//works

        if ((BreakStart != "00:00:00") & (BreakEnd != "00:00:00"))
        {
            LabelMondayREG.Text = "00:00:00";

            String CompTimeBreakHours = (BreakEndDT.Subtract(BreakStartDT)).ToString();
            LabelMondayCALL.Text = ((DateTime.Parse(LabelMondayCALL.Text)) - (DateTime.Parse(CompTimeBreakHours))).ToString();
        } 
    } 
```

感谢您提供的任何帮助，如果您看到其他可以简化的内容，请告诉我，就像我说我对这些东西还很陌生。

* * *

**这是更多代码**和实际站点的图片，但这里是对我正在做的事情的更多描述：基本上这些方程式决定了医生休息的时间（通话时间或常规时间）应该减去来自，一周中的一天，来自一排下拉菜单。但是，我不希望为每组下拉列表复制此代码。所以我想知道是否有一种方法可以创建一个实例，让通话时间和常规时间标签仅使用与它们被标记的日期相对应的下拉菜单。

所以MondayDDL1, 2, ,3 和4 贯穿等式，它们的答案填写在LabelMondayCall 和LabelMondayReg

接着

TuesdayDDL1, 2, ,3 和 4 贯穿等式，它们的答案填写在 LabelTuesdayCall 和 LabelTuesdayReg

没关系没有形象我没有足够的声誉

这里有一些布局的样子

星期一DDL1 星期一DDL2 星期一DDL3 星期一DDL4 LABELmondayREG LABELmondayCALL

星期二DDL1 星期二DDL2 星期二DDL3 星期二DDL4 LABELtuesdayREG LABELtuesdayCALL

```
protected void ButtonCalculate_Click(object sender, EventArgs e)
{
    //DropDownList2.Items.Clear();
    //DropDownList2.SelectedValue = null;

    //DropDownList3.Items.Clear();
    //DropDownList3.SelectedValue = null;
    if (DDL_OutBreak_Monday.SelectedValue == "----")
    {
        DDL_OutBreak_Monday.SelectedValue = DateTime.Parse("00:00:00").ToShortTimeString();
    }

    if (DDL_InBreak_Monday.SelectedValue == "----")
    {
        DDL_InBreak_Monday.SelectedValue = DateTime.Parse("00:00:00").ToShortTimeString();
    }

    DateTime MondayDDL4 = DateTime.Parse(DDL_Out_Monday.SelectedValue);
    DateTime MondayDDL3 = DateTime.Parse(DDL_InBreak_Monday.SelectedValue);
    DateTime MondayDDL2 = DateTime.Parse(DDL_OutBreak_Monday.SelectedValue);
    DateTime MondayDDL1 = DateTime.Parse(DDL_In_Monday.SelectedValue);

    //DDL1 = DateTime.Parse(DDL_In_Tuesday.SelectedValue);// END POINT---------------------------END POINT

    String BreakStart = DDL_OutBreak_Monday.SelectedValue;
    String BreakEnd = DDL_InBreak_Monday.SelectedValue;

    DateTime BreakStartDT = DateTime.Parse(BreakStart);
    DateTime BreakEndDT = DateTime.Parse(BreakEnd);

    DateTime FromCompHours = DateTime.Parse("6:30:00");
    DateTime ToCompHours = DateTime.Parse("16:30:00");

    Label1.Text = "";
    Label2.Text = ""; 
    Label3.Text = "";
    LabelMondayREG.Text = "";
    LabelMondayCALL.Text = "";

    //int result = DateTime.Compare(DDL1, DDL2);

    if ((MondayDDL1 <= FromCompHours) & (MondayDDL4 >= ToCompHours))//Comp time at both ends
    {
        Label2.Text = FromCompHours.Subtract(MondayDDL1).ToString(); //finds comp hours before 6:30 WORKS
        Label3.Text = MondayDDL4.Subtract(ToCompHours).ToString(); //finds comp hours after 16:30 WORKS
        LabelMondayREG.Text = ("10:00:00");
        //LabelHolder.Text = (DateTime.Parse(Label2.Text)) + (DateTime.Parse(Label3.Text)).ToString(); //adds the two comp hours together
        //TimeSpan SubtractReg = DDL2.Subtract(DDL1); //finds the difference of from minus to
        DateTime To = DateTime.Parse(Label2.Text);//convert text to datetime of earlier time
        DateTime From = DateTime.Parse(Label3.Text);//convert text to datetime of later time

        LabelMondayCALL.Text = (To.TimeOfDay + From.TimeOfDay).ToString();
        //LabelMondayCALL.Text = "10:00:00";

        if ((BreakStartDT != DateTime.Parse("00:00:00")) & (BreakEndDT != DateTime.Parse("00:00:00")))
        {
            //DateTime MondayBreak = MondayDDL3.Subtract(MondayDDL2);

            if ((MondayDDL2 <= FromCompHours) & (MondayDDL3 <= FromCompHours)) //Start before 6:30 end after 16:30 w/ break before 6:30
            {
                LabelMondayCALL.Text = TimeSpan.Parse(LabelMondayCALL.Text).Subtract(MondayDDL3.Subtract(MondayDDL2)).ToString();
                //LabelMondayCALL.Text = "error1"; //(DateTime.Parse(LabelMondayCALL.Text)).ToString();
            }
            if ((ToCompHours >= MondayDDL2) & (MondayDDL2 >= FromCompHours) & (ToCompHours >= MondayDDL3) & (MondayDDL3 >= FromCompHours)) //Start before 6:30 end after 16:30 /w break between 6:30 and 16:30
            {
                LabelMondayREG.Text = TimeSpan.Parse(LabelMondayREG.Text).Subtract(MondayDDL3.Subtract(MondayDDL2)).ToString();
            }
            if ((MondayDDL2 >= ToCompHours) & (MondayDDL3 >= ToCompHours))  //Start before 6:30 end after 16:30 /w break after 16:30
            {
                LabelMondayCALL.Text = TimeSpan.Parse(LabelMondayCALL.Text).Subtract(MondayDDL3.Subtract(MondayDDL2)).ToString();
            }
            if ((MondayDDL2 <= FromCompHours) & (MondayDDL3 >= FromCompHours) & (MondayDDL3 <= ToCompHours))
            {
                LabelMondayCALL.Text = TimeSpan.Parse(LabelMondayCALL.Text).Subtract(FromCompHours.Subtract(MondayDDL2)).ToString();
                LabelMondayREG.Text = TimeSpan.Parse(LabelMondayREG.Text).Subtract(MondayDDL3.Subtract(FromCompHours)).ToString();
            }
            if ((MondayDDL2 <= ToCompHours) & (MondayDDL2 >= FromCompHours) & (MondayDDL3 >= ToCompHours))
            {
                LabelMondayCALL.Text = TimeSpan.Parse(LabelMondayCALL.Text).Subtract(ToCompHours.Subtract(MondayDDL2)).ToString();
                LabelMondayREG.Text = TimeSpan.Parse(LabelMondayREG.Text).Subtract(MondayDDL3.Subtract(ToCompHours)).ToString();
            }
        } 
```

# xslt - 如何匹配在 xslt/xpath 中具有某个同级元素的元素

> ID：11851258
> 
> 赞同：4
> 
> 时间：2012-08-07T17:41:47.237
> 
> 标签：xslt, xpath, xslt-2.0

我正在尝试匹配所有`a/c`具有`b`兄弟姐妹的元素。我试过了：

```
<xsl:template match="a/b/../c"> 
```

但我从撒克逊人那里得到“无法将表达式 {..} 转换为模式”。

我的 XSLT/XPath 技能充其量是基本的......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T19:55:43.633

```
<xsl:template match="a[b]/c"> 
```

说明：匹配作为具有子元素的子元素的任何`c`元素。`a``b`

您还应该能够`..`在谓词中使用：

```
<xsl:template match="a/c[../b]"> 
```

这与您尝试的类似。

您不能`..`直接在匹配模式中使用（即在谓词之外）的原因是模式不是 XPath 表达式，即使它们看起来和行为非常相似。特别是，模式中只允许直接使用“向下”轴（ `child::`、`descendant::`和）。`attribute::`（规范允许的唯一显式轴是`child::`and `attribute::`.是通过[模式步骤](http://www.w3.org/TR/xslt#NT-RelativePathPattern)之间`descendant::`隐式允许的。撒克逊人似乎在这里稍微改变了规则，允许显式轴，甚至！）`//``descendant::``descendant-or-self::`

对轴进行限制的原因是 (a) 模式中很少需要其他轴，并且 (b) 这允许 XSLT 处理器在测试匹配时更加高效。

But **predicates** in patterns *are* defined with the [same syntax rules](http://www.w3.org/TR/xslt#NT-StepPattern) as in XPath expressions (with some restrictions in XSLT 1.0, like not allowing variable references or `current()`). So you can use other axes, like `parent::`, or the abbreviation `..`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:12:19.597

这个 XPath 表达式似乎可以完成这项工作（可能不是最佳的）：

```
//a|//c[following-sibling::b or preceding-sibling::b] 
```

编辑：

如果 LarsH 是正确的，它应该`//a/c`代替`//a|//c`.

# mono - 在 Mountain Lion 上安装“mono for android”失败并出现“OSStatus 错误 -67053”

> ID：11851259
> 
> 赞同：2
> 
> 时间：2012-08-07T17:41:48.343
> 
> 标签：mono, xamarin.android

我昨晚安装了“Mountain Lion”，导致 XCode 失败。当我安装新的 XCode 版本时，“Monotouch”和“Mono for android”消失了……

我可以很快地重新安装 monotouch，但我无法安装“mono for android”。单击“Install MonoForAndroid”后，我得到“Der Vorgang konnte nicht abgeschlossen werden (OSstatus-Fehler -67053)”，意思是“无法完成此操作，(OSstatus-error -67053)”

我在谷歌上能找到的只是[1]，它说这可能意味着“errSecCSResourceRulesInvalid”。

无论如何，我现在仍然不知道该怎么办。有人能告诉我我能做些什么来让 Mono4Android 再次运行吗？多谢！！

[1] = [https://developer.apple.com/library/mac/#documentation/Security/Reference/CodeSigningRef/Reference/reference.html](https://developer.apple.com/library/mac/#documentation/Security/Reference/CodeSigningRef/Reference/reference.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T14:39:00.373

错误 -67053 表示：

```
invalid resource specification rule(s) 
```

我找到了解决此错误的一种方法：编辑应用程序包中的文件 Info.plist 并删除 CFBundleResourceSpecification 属性。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-08T12:13:27.710

在设置中有一个选项，您只能从 Mac App Store 安装应用程序。似乎默认情况下打开了此选项。要解决问题，您只需将其关闭。

# postgresql - 具有两个备用服务器的 PostgreSQL 故障转移

> ID：11851262
> 
> 赞同：0
> 
> 时间：2012-08-07T17:41:57.813
> 
> 标签：postgresql

我通过流式复制（postgresql 9.0.5）设置了一台主服务器和两台备用服务器。现在，如果主失败，我会通过创建触发文件将其中一个备用从恢复模式中取出。假设我在 recovery.conf 文件中修复了 recovery_target_timeline = latest ，那么辅助备用服务器是否会跟随新的主服务器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T20:05:10.517

不，因为新主人不知道它有一个奴隶。新的奴隶不知道它有一个新的主人。您必须更改相应的配置文件才能获得所需的情况。

检查[repmgr](http://www.repmgr.org/)，也许这就是你要找的。

# javascript - 关于用户界面：运动研究中的目标跟踪和时间

> ID：11851264
> 
> 赞同：0
> 
> 时间：2012-08-07T17:42:04.000
> 
> 标签：javascript, css, html, tracking, usability

我想知道是否有人知道如何或者是否可以仅使用 CSS、HTML5 和 Javascript 来跟踪鼠标光标移动、按钮点击和对非站点数据库的点击时间？我问这个关于可用性研究的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T21:11:14.580

我建议您只使用现成的产品而不是创建自己的产品。搜索热图。最大的是 CrazyEgg，但它不是免费的。查看[此站点](http://www.paulolyslager.com/heatmap-hot-or-not/)以比较其他替代方案，包括免费选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:08:35.353

Javascript 或 JQuery 可用于跟踪鼠标位置，但您需要 PHP 将信息发送到数据库。看看[这篇文章](http://css-tricks.com/tracking-clicks-building-a-clickmap-with-php-and-jquery/)。

# html - 在 JSP 应用程序中基于 CSS 实现参数化外观的最佳方式是什么？

> ID：11851265
> 
> 赞同：1
> 
> 时间：2012-08-07T17:42:15.207
> 
> 标签：html, css, jsp, tomcat, servlets

我正在开发一个 jsp Web 应用程序，没有框架（可悲......），它将用于不同的客户。每个客户都有自己的一套颜色和公司标志。

css布局不会改变，只有一些div颜色、字体颜色、按钮颜色等等。

我尝试解决这个问题，实现一个接收一般请求的过滤器，然后根据客户将请求重定向到正确的文件夹。

例如，index.jsp 请求 css/index.css，然后过滤验证客户，然后将请求更改为“customer1_css/index.css”。这工作正常，现在...

但是，当我需要添加或修改一些 css 元素时，我必须在每个客户的每个 css 文件中进行。

我想为我们和网页设计师简化这个过程。所以，我虽然在使用[FreeMarker](http://freemarker.sourceforge.net/)，对所有动态元素进行参数化，并制作了一个数据库表，我在其中放置了每个参数值。但是很麻烦。

我知道我不是第一个遇到这个问题的开发人员。

请给我一些解决这个问题的想法。

提前致谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:49:39.183

我会远离动态生成 CSS。如果您更改页面布局以使其需要更改 CSS，那么您只能在 CSS 文件中进行所有更改。您将如何通过动态生成 CSS 来避免这种情况？您仍然只能更改您预先决定的属性（类名、ID）。

更好的解决方案涉及编写语义 HTML，即改进您的 HTML，以便更改其布局不需要对 CSS 进行太多更改 请参阅[如何避免在使用 jQuery 创建丰富的客户端体验时锁定我的 HTML 结构？](https://stackoverflow.com/questions/10743682/how-to-avoid-locking-my-html-structure-when-using-jquery-to-create-rich-client-e/10743766#10743766)

# javascript - 测试光标是否在文本区域的第一行（使用软换行符）

> ID：11851266
> 
> 赞同：8
> 
> 时间：2012-08-07T17:42:17.307
> 
> 标签：javascript, jquery, html, dom, textarea

给定一个内容像这样流动的文本区域

```
     ––––––––––––––––––––––––––
    | 这是一些文本，其中 |
    | 像这样包裹。|
     ––––––––––––––––––––––––––

```

如何判断文本光标是否在文本区域的第一行？

显然，如果想要查看光标是否出现在第一个换行符之前，检查换行符 ( `\n`) 是有效的，但测试“软”换行符似乎更具挑战性。

这是一个[用于试验的示例 jsFiddle](http://jsfiddle.net/bmh_ca/h46jh/26/)。

我还没有想出一个策略，但我怀疑它可能涉及将文本复制到光标位置到克隆的文本区域（或 div）中，并根据需要设置宽度，这样它就不会换行. 如果克隆区域的宽度小于原始区域的宽度，则光标似乎必须位于第一行。可能有更简单的选择，更优雅的选择，或者（最重要的是）现有且经过良好测试的解决方案。

目标浏览器是 Webkit (Chrome/Safari) 和 Firefox。即，IE 兼容性目前不是问题（如果这有什么不同的话）。

谢谢阅读。

### 编辑：寻找文本插入符号的行号，而不是鼠标光标。

falsarella 给出了一个很好的答案，突出了这个问题的歧义。我正在寻找的是文本光标（“插入符号”可能是一个更好的词）是否在第一行。我已经更新了问题和[jsFiddle](http://jsfiddle.net/bmh_ca/h46jh/26/)来反映。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:42:26.820

我只知道一种“工作方法”。该方法需要使用`textarea`“cols”属性。长话短说，将cols设置为您想要的宽度，然后将光标位置和地板分开，看看它是否小于1，因此它=第1行！

如果我只是向您展示一个代码示例，可能会更容易解释。

```
$("textarea").live("keyup", function(e) {
    if ($("textarea").attr("cols")) {
        var cols = parseInt($("textarea").attr("cols")),
            curPos = $('textarea').prop("selectionStart"),
            result = Math.floor(curPos/cols);
        var msg = (result < 1) ? "Cursor is on the First line!" : "Cursor is on the line #"+(result+1);
        console.log($("p").text(msg).text());
    };
});​ 
```

但是，这可能仍然需要一些有线数学，因为当光标仅位于第一行的末尾时，某些 col 大小可能仍会显示“第 2 行”（这在技术上仍然是正确的，因为任何字符都会掉到第 2 行）

# [jsFiddle](http://jsfiddle.net/SpYk3/zkmJa/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T17:59:00.913

有 15 是行高，这有效（在 Firefox 中测试）：

[http://jsfiddle.net/h46jh/12/](http://jsfiddle.net/h46jh/12/)

```
$("textarea").click(function (evt) {
  cursor_position = evt.pageY - $('textarea').offset().top;
  if (cursor_position <= 15) {
    alert("first line");
  } else {
    alert("other line");
  }
}); 
```

学分：

[查找相对于元素的鼠标位置](https://stackoverflow.com/questions/3234256/find-mouse-position-relative-to-element)

# python - 覆盖来自不同应用程序的 Django 表单字段

> ID：11851267
> 
> 赞同：2
> 
> 时间：2012-08-07T17:42:18.813
> 
> 标签：python, django, django-widget

Django Guardian 在 admin.py、GroupManage 和 UserManage 中定义了两种形式：[https ://github.com/lukaszb/django-guardian/blob/master/guardian/admin.py#L368](https://github.com/lukaszb/django-guardian/blob/master/guardian/admin.py#L368)

我想为这两种表单添加自动完成功能，我认为实现这一点的最佳方法是覆盖组和用户的字段小部件（我的第一次尝试使用 django autocomplete_light。）目标是不需要 fork django监护人。

所以在我的应用程序的models.py中，我添加了以下代码

```
GroupManage.__class__.group = forms.CharField(max_length=81,
    error_messages={'does_not_exist':
    "This group does not exist!"}, widget=ChoiceWidget(True)) 
```

我也尝试使用 setattr 无济于事。在 django shell 中，它的行为应该可以正常工作，但是当加载管理页面时，旧的组变量会恢复，并使用默认的 CharField 小部件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:48:03.267

为类定义的字段存储在字典中`base_fields`。

```
GroupManage.base_fields['group'] = forms.CharField(max_length=81,
error_messages={'does_not_exist':
"This group does not exist!"}, widget=ChoiceWidget(True)) 
```

有时，更改字段属性可能比替换整个字段更容易：

```
GroupManage.base_fields['group'].help_text = "New help text" 
```

# regex - mongodb正则表达式大写五个字母

> ID：11851268
> 
> 赞同：2
> 
> 时间：2012-08-07T17:42:20.217
> 
> 标签：regex, mongodb

我在尝试编写一个返回 mongodb 中所有大写五个字母代码的查询时遇到了麻烦。到目前为止我有这个：

```
db.foo.find({f : {$regex : [/[A-Z]{5}/] } }).count() 
```

这是不正确的，因为它返回的结果是整个集合的大小，我知道至少有 4000 个条目不是大写的。我没有太多使用正则表达式的经验，所以我很难知道出了什么问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T17:50:43.653

我认为您的正则表达式是错误的，请尝试：

```
db.foo.find({f : {$regex : /[A-Z]{5}/ } }).count() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T17:53:08.800

`$regex`除非您尝试一次执行多个 $ 操作，否则您不需要运算符。

```
db.foo.find({f: /[A-Z]{5}/}) 
```

会工作得很好。

# imagemagick - ImageMagick：减少图像中所有像素的 RGB 值

> ID：11851270
> 
> 赞同：2
> 
> 时间：2012-08-07T17:42:31.607
> 
> 标签：imagemagick

具体来说，对于给定的图像，我试图将每个像素的 RGB 值减少 100。

例如，如果一个像素有 R: 232, G: 40, B: 120，那么我希望新的 RGB 值是 R: 132, G: 0, B: 20。

我已经尝试过在 ImageMagick 论坛上找到的解决方案：

```
convert input.jpg -channel R -evaluate subtract 25700 \
-channel G -evaluate subtract 25700 \
-channel B -evaluate subtract 25700 output.jpg 
```

编辑：我使用 25700 的原因是因为显然您需要将 rgb 值乘以 257。100 * 257 = 25700。

虽然它一开始似乎可以工作（显然使图像变暗），但某些像素似乎不会改变，对于我正在做的事情来说，它们所做的至关重要（我正在对生成的图像进行修剪，试图修剪掉像素值为 0 的边框）。

一个常见的问题是我最终会得到一个 RGB 值为 3、0、0 的像素，但我希望该像素的 RGB 值为 0 并增加我减去的常数 - 但它没有似乎不起作用。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T19:00:01.033

老实说，我真的不明白`25700`你的命令行中的价值应该达到什么。

但是，我建议您使用更强大的`-fx`运算符来使用不同的命令行。看起来有点复杂，但希望更直观地理解......

但首先，我正在查看您的描述，发现您想`120`从当前的 R、G 和 B 颜色值中减去固定数量的 。所以这是一个灰色像素颜色......你可以在 ImageMagick 的颜色内置颜色列表中查找，它的名称是`gray47`：

```
convert -list color | grep '(120,120,120)'
  gray47                srgb(120,120,120)                             X11 XPM 
  grey47                srgb(120,120,120)                             SVG X11 
```

这导致我执行以下命令：

```
 convert \
       input.jpg \
      -channel red   -fx 'r - gray47' \
      -channel green -fx 'g - gray47' \
      -channel blue  -fx 'b - gray47' \
       output.jpg 
```

这种方式或编写命令可能会让您看到一些容易衍生的修改，如果您将来需要这些修改......

要立即弹出结果的预览窗口（不将其写入文件），您还可以将`-show:`其用作输出，如下所示：

```
 convert \
       input.jpg \
      -channel red   -fx 'r - gray47' \
      -channel green -fx 'g - gray47' \
      -channel blue  -fx 'b - gray47' \
      -show: 
```

* * *

## 更新

如果要检查每个像素的真实差异，可以让 ImageMagick 打印出每个像素的颜色值：

```
convert  input.jpg   input.txt
convert  output.jpg  output.txt 
```

.txt 文件的格式很容易理解，一旦您知道第一列给出了从零开始的像素坐标：`123,456:`表示：第 124 (!) 列，第 457 () 行。

现在，即使是自动化的脚本版本，您也可以将这两个 .txt 文件与您心中的内容进行比较，而无需求助于 Gimp。:-)

您甚至可以使用`input.txt`Perl-、Ruby-、Python- 或 Shellscript 并将其应用于每个像素值，以分散`120`每个通道的值，将其保存为 output2.txt，然后将其转换回 JPEG：

```
convert  output2.txt  output2.jpg 
```

然后寻找两个输出图像之间的像素差异：

```
compare  output.jpg  output2.jpg  delta.jpg
compare  output.jpg  output2.jpg  view: 
```

全白平面意味着*“没有差异”*，任何红色像素都会暗示某种增量。

现在，如果*这个*答案没有为我赢得投票，我不知道哪个会...... :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T20:32:49.917

肯，不，你不需要写一个大的解析器。使用一些 shell 命令很容易完成。首先测试它们，然后将它们放入 Shell 或 Batch 脚本中。像这样的东西（作为 Bash 脚本）：

```
#!/bin/bash

echo " 注意：这个脚本可能需要很长时间才能完成......"
echo " (此脚本用于转换带有 Alpha 通道的 PNG 文件。"
echo " 对于其他类型的图片，需要稍微修改一下。)"
回声
echo " 此脚本采用 8 位 RGBA 输入图像并创建更暗的输出图像。"
echo " 它的方法是：每个颜色通道的数值减去 100 的值。"
回声

输入="${1}"

_im_header=$(identify -format "%W,%H" "${input}")

echo "# ImageMagick 像素枚举：${_im_header},255,rgba" > input-minus-120.txt

转换 "${input}" input.txt

猫输入.txt \
   | \
     sed 's#) .*$#)#; s###g; s#:#:#; s#(##; s#)##; s#,##g; s##,#'\
   | \
     同时读取坐标红绿蓝阿尔法；做
        回声 -n "${坐标}";
        回声-n“（”；
        echo -n "$(($red - 100)),";
        echo -n "$(($green - 100)),";
        echo -n "$(($blue - 100)),";
        回声 -n "$(($alpha))";
        回声-n“）”；
        回声;
     完毕 \
   | sed 's#-[0-9]*#0#g' \
>> 输入-减-120.txt

转换 input-minus-120.txt output-minus-120.jpg

```

该脚本需要 153 秒才能在 MacBook Pro 上运行，处理 750 kByte 的 1080x889 像素 PNG 文件。

生成的 input.txt 有 960120 行（PNG 中的像素数）。

所以这个蛮力 shell 脚本的性能大约是 6275 像素/秒。

# iphone - iOS 应用程序在流式传输视频时被 mediaserverd 内存问题（泄漏？）杀死（抛弃）

> ID：11851271
> 
> 赞同：8
> 
> 时间：2012-08-07T17:42:38.357
> 
> 标签：iphone, ios, memory-leaks, video-streaming, drm

我们看到一个奇怪的崩溃，其中似乎 iOS 在收到 2 级内存警告后抛弃了我们的应用程序和 mediaserverd。它发生在播放 DRM 内容（包括但不限于 PlayReady 加密内容）大约 7-8 分钟后，即使我们在后台没有运行其他应用程序的情况下重新启动设备。然而，这种情况并非始终如一，我们有时可以在后台使用大量内存繁重的应用程序完成相同的内容（整个 2 小时的电影），而不会出现任何问题。

我们在运行 iOS 5.1 和 5.1.1 的 iPhone 3GS、4 和 4S 设备上看到了这一点，尽管它似乎在 3GS 上最为突出。应用程序以“segmentation fault 11”或“signal 9”终止。分段错误 11 可以指内存访问错误或内存不足，信号 9 指内存不足终止。

我们已经使用静态分析仪和仪器来查找和修复任何泄漏，并且泄漏仪器中没有出现任何警报。

在使用 Memory Monitor 工具分析回放时，我们发现在开始流式传输时可用物理内存急剧减少，这在一定程度上是可以预料的。当应用程序/操作系统正常运行时，其他应用程序会在内存变得太低时从后台删除，但偶尔可用的物理内存会继续下降，直到操作系统杀死我们的应用程序。尽管我们偶尔会收到内存不足的日志，但不会生成崩溃日志，如下所示：

```
Incident Identifier: 13839D5B-D280-40D8-8C67-6EE3D61394C3
CrashReporter Key:   d3746ff556543d6a94e067d82c8fb379a285f543
Hardware Model:      iPhone2,1
OS Version:          iPhone OS 5.1.1 (9B206)
Kernel Version:      Darwin Kernel Version 11.0.0: Sun Apr  8 21:50:49 PDT
2012; root:xnu-1878.11.10~1/RELEASE_ARM_S5L8920X
Date:                2012-06-28 14:09:56 -0400
Time since snapshot: 104 ms

Free pages:        712
Active pages:      1433
Inactive pages:    1012
Throttled pages:   49925
Purgeable pages:   0
Wired pages:       11870
Largest process:   SpringBoard

Processes
         Name                 UUID                    Count resident pages
         launchd <5fec01c378a030a8bd23062689abb07f>      79
securekeyvaultd. <78f602d3604c3bf487a27a288dec3bbb>     156
           MYAPP <285e46965a91381dad0661443c8be3eb>    4035 (jettisoned) (active)
     MobilePhone <8f3f3e982d9235acbff1e33881b0eb13>     749 (jettisoned)
    mediaserverd <f03b746f09293fd39a6079c135e7ed00>    3670 (jettisoned)
        networkd <80ba40030462385085b5b7e47601d48d>     145
            apsd <e7a29f2034083510b5439c0fb5de7ef1>     260
     SpringBoard <c74dc89dec1c3392b3f7ac891869644a>    4615 (active)
         notifyd <f6a9aa19d33c3962aad3a77571017958>     170
        BTServer <31e82dfa7ccd364fb8fcc650f6194790>     259
CommCenterClassi <041d4491826e3c6b911943eddf6aaac9>     421
      aggregated <a12fa71e6997362c83e0c23d8b4eb5b7>     329
         configd <ee72b01d85c33a24b3548fa40fbe519c>     324
   fairplayd.N88 <ecb9495b29543b35a1f2e6c2b432528c>     168
       fseventsd <914b28fa8f8a362fabcc47294380c81c>     164
            iapd <0a747292a113307abb17216274976be5>     284
         imagent <9c3a4f75d1303349a53fc6555ea25cd7>     412
       locationd <cf31b0cddd2d3791a2bfcd6033c99045>     493
   mDNSResponder <86ccd4633a6c3c7caf44f51ce4aca96d>     182
    mediaremoted <327f00bfc10b3820b4a74b9666b0c758>     208
       lockdownd <b06de06b9f6939d3afc607b968841ab9>     315
          powerd <133b7397f5603cf8bef209d4172d6c39>     143
         syslogd <7153b590e0353520a19b74a14654eaaa>      90
           wifid <3001cd0a61fe357d95f170247e5458f5>     285
  UserEventAgent <dc32e6824fd33bf189b266102751314f>     322
         launchd <5fec01c378a030a8bd23062689abb07f>     120

End 
```

根据我在这里看到的一些较早的问题，似乎 mediaserverd 在以前的 iOS 版本中存在严重的内存泄漏问题。

这可能与问题有关吗？

我们怎样才能防止这种情况发生？

任何想法、理论、反馈或类似问题将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T12:47:48.840

这只是一个盲目的猜测，但你用的不是AVFoundation的AVPlayer吗？我遇到了这样的问题，结果证明我没有正确发布 AVPlayers。所以对于每首歌我都创建了一个新的 AVPlayer，如果你发布旧的，这很好，但我没有。我通过在 Instruments 中进行分配测试发现了这一点，并看到 AVPlayer 在它们应该被释放后仍然存在。

# c# - 我使用枚举的方式有问题

> ID：11851272
> 
> 赞同：0
> 
> 时间：2012-08-07T17:42:43.930
> 
> 标签：c#

```
public enum RelationType { Subclass, HasArm, HasLeg };
public RelationType RelationShipType { get; set; }

public static IOwlRelation AddSubClassRelation(IOwlClass parent, IOwlClass child)
{
    return new OwlRelation
    {
        Parent = parent,
        Child = child,
        RelationShipType = RelationType.Subclass
    };
} 
```

因此，假设这是在**OwlRelation**类中，现在在消费者类中，我首先创建一个 OwlRelation 对象，如下所示

```
OwlRelation r1 = OwlRelation.AddSubClassRelation( someParent, someChild); 
```

并且还有一个像**AddRelation(OwlRelation)** 这样的方法，我可以将**r1**对象传递给它，现在在这个方法的主体中，我可以检查并查看这个对象的枚举值是什么以及基于该值的一些东西。

**这**就是我在 OwlRelation 类中定义 Enumeration 类型的原因。但我认为这不是实现这一目标的正确方法，而且我可能没有足够的专业知识来解决这个问题。那么您认为正确的做法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:54:59.113

您可以将不同的关系类型实现为不同的类。

```
public abstract class OwlRelation : IOwlRelation
{
    // Implement infrastructure common to all relation types
}

public SubclassOwlRelation : OwlRelation
{
    // Implement things specific to Subclass-relations
}

public HasArmOwlRelation : OwlRelation
{
    // Implement things specific to HasArm-relations
}

... 
```

通过您的实现，您可能会遇到这样的代码

```
switch (relation.RelationshipType) {
    case RelationshipType.Subclass:
        DoSomeSubclassStuff(relation);
        break;
    case RelationshipType.HasArm:
        DoSomeArmStuff(relation);
        break;
    case RelationshipType.HasLeg:
        DoSomeLegStuff(relation);
        break;
} 
```

使用面向对象的方法，相应的代码如下所示

```
relation.DoSomeStuff(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:09:12.450

我认为这是一个典型的问题，通过应用策略模式来解决。`RelationStrategy`因此，正如@Olivier 所建议的那样 ，它将是不同的子类。[你可以在这里读到它](http://tinyurl.com/yd5puao)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:54:12.497

我不确定您要做什么。从另一个方向来看，使用 an 的两种正确方法`enum`是：

1.  您有一组互斥的值，其总数小于您所基于的整数类型`enum`（`int`是默认值，`long`是最大可能的），并且您可以合理地列出它们中的每一个（或期望由于某些外部标准，用户知道与缺失项目对应的数字）。

2.  您有一组非互斥的值，您可以将其与二元运算符结合使用，这样如果例如`Read`为 1、`Write`为 2 和`Execute`为 4，则读取和执行但不能写入的能力为 5 ( `1 | 4`)。

现在，我已经很长时间没有看过 Web Ontology Language（我猜这就是你的意思的那种 OWL），但我根本不知道 Arm 和 Subclass 是如何适应这个的（也不记得任何关于OWL 中的武器）。但我也看不到它如何适合其他任何东西——我也看不到“它是手臂还是子类？”的问题。是有道理的（这将适合枚举使用 1），也没有问题“它是一个手臂、一个子类，还是两者兼而有之，或者两者都不是？” 是有道理的（这将适合枚举使用 2）。

所以，没有太多的答案，但希望足以`enum`帮助一点。

# three.js - Three.js 椭圆

> ID：11851276
> 
> 赞同：5
> 
> 时间：2012-08-07T17:43:03.593
> 
> 标签：three.js

如何在three.js 中创建一个椭圆？

我看过这个： [在 THREE.js 中绘制一个椭圆](https://stackoverflow.com/questions/11419896/drawing-an-ellipse-in-three-js)

但是，如果有人可以提供一个工作示例，那就太酷了。

我试过这个：

```
ellipse = new THREE.EllipseCurve(0,0,200,400,45,45,10); 
```

但这对我不起作用。我不知道参数是什么意思，所以我只是盲目地去做。

编辑：当我尝试创建椭圆曲线时，出现错误**“定义不是函数” 。**

编辑2：发现我必须包含 Curves.js 才能使其工作，但在某个地方有一个工作示例对我和其他人来说仍然非常好，因为我之前粘贴的 stackoverflow 链接没有示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:55:16.630

我不熟悉 THREE.js，但是查看[代码](https://github.com/mrdoob/three.js/blob/dev/src/extras/core/Curve.js#L439)，参数似乎是
`(Center_Xpos, Center_Ypos, Xradius, Yradius, StartAngle, EndAngle, isClockwise)` 您的定义不起作用的一个原因，因为您将开始和结束角度都设置为相同的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-31T07:51:24.380

[这里](https://code.google.com/p/freality/source/browse/trunk/space/war/scene.js?r=105)有一个例子，下面是我的例子：

```
var scene = new THREE.Scene();
var material = new THREE.LineBasicMaterial({color:0x000000, opacity:1});
var ellipse = new THREE.EllipseCurve(0, 0, 1, 5, 0, 2.0 * Math.PI, false);
var ellipsePath = new THREE.CurvePath();
ellipsePath.add(ellipse);
var ellipseGeometry = ellipsePath.createPointsGeometry(100);
ellipseGeometry.computeTangents();
var line = new THREE.Line(ellipseGeometry, material);
scene.add( line ); 
```

注意：这不是一个完整的示例，`<script src="js/three.min.js"></script>`如果您想查看结果，您应该添加其余代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-25T13:23:15.887

您可以直接设置一个圆形几何体并将其比例设置为：object.scale.setY(2.5); 这可以很容易地形成一个椭圆形，而无需使用任何形状或曲线。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-28T02:37:01.447

[这是一个完整的工作示例](http://jsfiddle.net/2UDm2/)。

```
<!doctype html>
<html>
<head>
<title>example</title>
<script src="threejs/build/three.min.js"></script>
<script src="threejs/src/core/Curve.js"></script>
<script src="threejs/examples/js/controls/OrbitControls.js"></script>
</head>

<body>
<script>
var parent, renderer, scene, camera, controls, pivot1, pivot2, pivot3;

init();
animate();

function init() {

    // info
    info = document.createElement( 'div' );
    info.style.position = 'absolute';
    info.style.top = '30px';
    info.style.width = '100%';
    info.style.textAlign = 'center';
    info.style.color = '#fff';
    info.style.fontWeight = 'bold';
    info.style.backgroundColor = 'transparent';
    info.style.zIndex = '1';
    info.style.fontFamily = 'Monospace';
    info.innerHTML = 'Drag your cursor to rotate camera';
    document.body.appendChild( info );

    // renderer
    renderer = new THREE.CanvasRenderer();
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.physicallyBasedShading = true;
    document.body.appendChild( renderer.domElement );

    // scene
    scene = new THREE.Scene();

    // camera
    camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 0.1, 100 );
    camera.position.set( 20, 20, 20 );

    // controls
    controls = new THREE.OrbitControls( camera );

    // axes
    scene.add( new THREE.AxisHelper( 20 ) );

    var material = new THREE.LineBasicMaterial({color:0x000000, opacity:1});
    var ellipse = new THREE.EllipseCurve(0, 0, 1, 4, 0, 2.0 * Math.PI, false);
    var ellipsePath = new THREE.CurvePath();
    ellipsePath.add(ellipse);
    var ellipseGeometry = ellipsePath.createPointsGeometry(100);
    ellipseGeometry.computeTangents();
    var line = new THREE.Line(ellipseGeometry, material);
    scene.add( line );
}

function animate() {
    requestAnimationFrame( animate );
    controls.update();
    renderer.render( scene, camera );

}

</script>
</body>
</html> 
```

# iphone - iOS - 将 iPhone Build 转换为 iPad

> ID：11851281
> 
> 赞同：1
> 
> 时间：2012-08-07T17:43:18.310
> 
> 标签：iphone, ios, ipad, ios5

我有一个我构建的应用程序，该应用程序将构建为仅限 iPhone 的应用程序。

现在，我被告知现在必须使该应用程序具有通用性。我也必须让它与 iPad 兼容（仅在纵向模式下）。我现在一直在寻找我的选择，因为这个项目中的 XIB 负载了大量的对象，所以以编程方式分配坐标将是一件痛苦的事情。

我正在寻找最好的、最快的方法，以使这个 iPhone 应用程序也成为与 iPad 兼容的应用程序。

PS：没有 mainwindow.xib 文件，因为应用程序是使用 XCode 4.3 构建的，它不会创建 MainWindow.xib 文件。

先感谢您。

编辑：我为所有 XIB 制作了 iPad 的重复 XIB。现在，我正在尝试使用命名约定，它告诉我将文件名后缀更改为 MyiPadXIB~ipad.xib，当应用程序在 iPad 上运行时，它将自动采用该 XIB。这似乎没有发生。

当我在 iPad 中打开应用程序时，只出现一个小窗口（仅 iPhone 应用程序在 iPad 上运行时出现的窗口）。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:04:17.397

我采用了一种非常简单的方法，我只需通过构建设置 > 目标（iPhone）> 右键单击​​并选择重复来创建所有 XIB 的重复 XIB。

然后我会以这种格式更改重复 xib 的名称：“iPhone XIB 名称”~ipad.xib。

然后系统会根据使用的设备自动选择 XIB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:08:10.300

据我所知（可能有我不知道的更快/更好的方法）

您将为 ipad 创建单独的 xib 文件

当你初始化你的视图控制器时，你会检查你在什么设备上，就像这样

```
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        self.serverSettingsViewController = [[ServerSettingsViewController alloc] initWithNibName:@"ServerSettingsViewController_iPhone" bundle:nil];
        self.motionJpegViewController = [[MotionJpegViewController alloc] initWithNibName:@"MotionJpegViewController_iPhone" bundle:nil];
    } else {
        self.serverSettingsViewController = [[ServerSettingsViewController alloc] initWithNibName:@"ServerSettingsViewController_iPad" bundle:nil];
        self.motionJpegViewController = [[MotionJpegViewController alloc] initWithNibName:@"MotionJpegViewController_iPad" bundle:nil];
    } 
```

并加载您的 iphone 或 ipad xib 文件（仅供参考，请确保 xib 视图对于 ipad 来说足够大）

# python - 用 numpy 和 pylab 绘图

> ID：11851297
> 
> 赞同：1
> 
> 时间：2012-08-07T17:44:31.807
> 
> 标签：python, numpy, matplotlib

我有一些数据，我已经加载到了`numpy`，我没有`csv`加载我需要的日期范围的文件或任何文件，但是我知道这个数组长度是多少。

目前我这样做只是为了打印一个简单的图表：

```
t = numpy.arange(0.0, len(data), 1)
pylab.plot(t, data) 
```

是否可以在`t`此处替换以便我可以指定开始和结束日期并打印实际日期？说，我的数据集中有 365 天，它会给出情节的实际日期，例如 DD/MM/YYYY ，1/1/1999.1/2/1999.....12/31/1999？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:34:23.640

您可能想看看[plot_date()](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.plot_date) 和[matliplot dates api](http://matplotlib.sourceforge.net/api/dates_api.html)。

# iphone - 得到 [Not A Type class]: message sent to deallocated instance 错误？

> ID：11851298
> 
> 赞同：1
> 
> 时间：2012-08-07T17:44:31.833
> 
> 标签：iphone, ios, user-interface, cgcolor

我在这个问题上工作了很长时间，无法得到答案，希望有人能帮助我。

我有一个基于 ios ARC 的应用程序。奇怪的是，我只在 iphone 中从下面的代码中得到“[Not A Type class]: message sent to deallocated instance”然后应用程序就崩溃了，尽管它在模拟器中运行良好。我知道这可能是内存问题，但不知道为什么。搜索论坛后，似乎与CGColorRef有关，但我找不到类似的案例。

```
self.backgroundColor =  CMConstants.greyColor;
CGContextRef context = UIGraphicsGetCurrentContext();
CGColorRef separatorColor = [UIColor colorWithRed:12/255.0 green:12/255.0 blue:12/255.0     alpha:1.0].CGColor;
CGRect paperRect = self.bounds; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T19:53:31.190

那是因为 UIColor 在调用后被释放，`colorWithRed:green:blue:`因为未使用，它导致您的 CGColorRef 没有任何支持。

做这个：

```
CGColorRef separatorColor = CGColorRetain([UIColor colorWithRed:12/255.0 green:12/255.0 blue:12/255.0     alpha:1.0].CGColor); 
```

完成后：

```
CGColorRelease (separatorColor); 
```

# ios - CoreData 一对多关系

> ID：11851301
> 
> 赞同：0
> 
> 时间：2012-08-07T17:44:40.153
> 
> 标签：ios, core-data

我有一个具有一对多关系的 Food 实体：

```
- (void)addIngredientsObject:(Ingredient *)value;
- (void)removeIngredientsObject:(Ingredient *)value;
- (void)addIngredients:(NSSet *)values;
- (void)removeIngredients:(NSSet *)values; 
```

成分实体具有：

```
@class Food;

@interface Ingredient : NSManagedObject

@property (nonatomic, strong) NSNumber * quantity;
@property (nonatomic, strong) NSString * recordUUID;
@property (nonatomic, strong) Food *foodItem;

@end 
```

我认为食物就像一个食谱，如果有 Food.ingredients 的项目，它就是一个食谱，否则不是。

现在，当我尝试在我的（食物）食谱中添加配料时：

```
 Ingredient *recipeIngredient = [[Ingredient alloc] init];
recipeIngredient.foodItem = ingredient;
NSLog(@"ingredient: %@", ingredient.name);
recipeIngredient.quantity = q;

[addRecipeController.items addObject:recipeIngredient]; 
```

和

```
 recipe = [[Food alloc] init];

// Controllare che il nome sia univoco
recipe.name = nameTextField.text;

// Compute
for(Ingredient *ingredient in items) {
    [recipe addValuesFromFood:ingredient.foodItem withQuantity:ingredient.quantity];
    [recipe addIngredientsObject:ingredient];
}

// Defaults
recipe.bookmark = [NSNumber numberWithBool:NO];
recipe.complex = [NSNumber numberWithBool:YES];
recipe.dirty = [NSNumber numberWithBool:NO];
recipe.lookback = [NSNumber numberWithBool:YES];
recipe.userAdd = [NSNumber numberWithBool:YES];

NSLog(@"pro: %f", recipe.pro.floatValue);
NSLog(@"items: %d", [recipe.ingredients count]); 
```

它保存成功。

但是当我进入细节并尝试检查我食谱的成分时......

```
 NSMutableSet *foods = [item mutableSetValueForKey:@"ingredients"];
for(Ingredient *ing in foods) {
    NSLog(@"Class: %@", NSStringFromClass([ing.foodItem class]));
    NSLog(@"Name: %@", ing.foodItem.name);
} 
```

我知道所有成分的名称都等于配方成分...这是错误的...如果我尝试在此循环中记录名称：

```
 // Compute
for(Ingredient *ingredient in items) {
    // NSLOG for food name here
    [recipe addValuesFromFood:ingredient.foodItem withQuantity:ingredient.quantity];
    [recipe addIngredientsObject:ingredient];
} 
```

一切都是正确的，但是在 [recipe addIngredientsObject:ingredient] 之后出现问题...

这是怎么回事？！无法逃避这个问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:22:05.877

修复了从一对多（Ingredients.foodItem）中删除反向关系

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:23:50.193

我不完全理解您在代码中尝试做什么，但有一个基本问题：托管对象喜欢`Food`并且`Ingredient`必须正确初始化`initWithEntity:insertIntoManagedObjectContext:`，您不能只分配 + 初始化它们。（嗯，你可以，但它更复杂。）

例如，参见*Core Data Programming Guide*中的[创建、初始化和保存托管对象](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdCreateMOs.html%23//apple_ref/doc/uid/TP40001654-208209)。

# objective-c - 无法从 uitextfield 读取多个单词

> ID：11851302
> 
> 赞同：1
> 
> 时间：2012-08-07T17:44:45.473
> 
> 标签：objective-c

我正在尝试读取用户在文本字段中输入的产品名称，然后将其添加到字符串中。当用户只输入一个词时，这很好用，但是当产品超过一个词时，程序就会崩溃。当我运行调试器时，NSString 产品的值被列为“变量不是 nsstring”。当用户在输入产品名称后点击返回时触发此方法：

```
-(IBAction)textFieldReturn3:(id)sender
{
    [sender resignFirstResponder];
    product = inputtext.text;
} 
```

这是当用户在两个场景后点击 twitter 按钮时触发的方法的一部分（我的目标是在用户决定要发什么推文时已经显示了某个消息）[是的，选择设置为 0或 3]

```
- (IBAction)twitter:(id)sender
{
TWTweetComposeViewController *twitter = [[TWTweetComposeViewController alloc] init];
[fmt5 setNumberStyle:NSNumberFormatterDecimalStyle];
[fmt5 setMaximumFractionDigits:2];
[fmt5 setMinimumFractionDigits:2];
if (choice == @"0" || choice == @"3")
{
    str = @"I just bought a new ";
    str = [str stringByAppendingString:product]; // line where it crashes
    str = [str stringByAppendingString:@" for $"];
    str = [str stringByAppendingString:[fmt5 stringFromNumber:[NSNumber numberWithDouble:myDouble]]];
    [twitter setInitialText:str];
} 
```

我该如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:51:56.413

很多问题。让我们从真正的原因开始。

```
product = inputtext.text; 
```

不好。如果您稍后使用它，当您的视图已经被释放时，它的 text 属性将不再有效。您必须保留它才能引用它。因此，将上面的行更改为如下所示：

```
[product release];
product = [inputtext.text retain]; 
```

也不要忘记初始化`product`为 nil 以避免与第一次发布调用相关的崩溃。

其次，你的比较不好。

```
choice == @"0" || choice == @"3" 
```

不做你认为它做的事。采用

```
if ([choice isEqualToString:@"0"] || [choice isEqualToString:@"3"]) { 
```

等等

编辑：也是一个次要的设计点。不要通过按顺序附加部分文本来重新发明轮子 - 这是非常不可读的。浏览 NSString 的类引用，你会很快找到以下方法：

```
str = [NSString stringWithFormat:@"I just bought a new %@ for $%.2lf", product, myDouble]; 
```

# javascript - 在 Javascript / jQuery 中获取对象的长度

> ID：11851306
> 
> 赞同：3
> 
> 时间：2012-08-07T17:44:59.967
> 
> 标签：javascript, arrays

我正在尝试在 jQuery 中设置一个数组，然后我需要对其进行 for 循环。但似乎由于某种原因我不能使用关联数组？

```
var items = new Array();
items['foo'] = 123456;
items['bar'] = 789012;
items['baz'] = 345678;
items['bat'] = 901234;
alert(items.length); 
```

这只是一个测试，但它返回 0？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-07T17:45:58.493

你不能`associative array`像你想要的那样在 JavaScript 中制作，而是可以使用**[Object](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object)**。

例如：

```
var items = {
  foo : 123456,
  bar : 789012,
  baz : 345678,
  bat : 901234
} 
```

并计算你可以做的长度：

```
var getObjectSize = function(obj) {
    var len = 0, key;
    for (key in obj) {
        if (obj.hasOwnProperty(key)) len++;
    }
    return len;
}; 
```

采用：`getObjectSize(items); // output: 4`

有关更多信息，请参见[此处](https://stackoverflow.com/questions/5223/length-of-javascript-object-ie-associative-array)。

另一个是：

```
Object.keys(items).length; 
```

### *但并非所有浏览器都支持。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:52:48.870

```
var items = new Array();
items['foo'] = 123456; 
```

问题出在第一行。您认为您正在向数组的索引处添加一项`foo`，但实际上您正在向`items`具有键`foo`和值的变量添加属性`123456`。如果您要键入`items.foo`它，它将返回您的`123456`.

这种方法的问题是向数组添加属性不会神奇地增加它的长度。

如果要使用非数字索引，则需要使用对象而不是数组：

```
var items = {
    foo: 123456,
    bar: 789012,
    baz: 345678,
    bat: 901234
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T17:55:09.750

另一种方法可能是设置两个不同的数组，您可以并行构建它们：

```
var items = [], items2 = [];
items.push('foo');
items2.push(123456);
// etc.
alert(items2.length);​ 
```

这种方法的效率取决于您将如何使用它。如果您只想遍历项目列表并对每个项目做一些事情，那么这种方法可能更有效。但是，如果您需要像关联数组 ( ) 一样*使用*`items['foo']`它，那么您最好构建一个对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T17:53:40.297

.length 属性返回*数组的最高数字索引*。因此，在您的情况下，没有数字索引，它返回 0。尝试

```
items[98] = "something"; 
```

items.length 将是 98 ..！谨慎使用 .length 属性，如果您还想计算非数字索引，请遍历对象（数组也是对象）并计算其 ownProperties。

# sharepoint-2010 - SharePoint 2010 连接到 Oracle 数据库

> ID：11851307
> 
> 赞同：0
> 
> 时间：2012-08-07T17:45:05.257
> 
> 标签：sharepoint-2010, oracle11g, bcs

我希望从 Oracle 数据库中检索数据，获取查询的信息并将其放入 SharePoint 2010。有没有办法在没有 BCS metaman 的帮助下实现这一目标？我遇到的所有教程似乎都引用了这个软件。在我的情况下，BCS metaman 不是一个选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T11:40:58.677

查看这篇[MSDN 文章 - How to: Connect to an Oracle Database Using Business Connectivity Services](http://msdn.microsoft.com/en-us/library/ff464424%28office.14%29.aspx)和这篇[SharePoint Journal 博客文章 - Business Connectivity Services (BCS) with Oracle using Visual Studio 2010](http://sharepointjournals.wordpress.com/2011/06/06/business-connectivity-services-bcs-with-oracle-using-visual-studio-2010-part-1/)

# qt - 为 QMenu 创建自定义槽

> ID：11851310
> 
> 赞同：-1
> 
> 时间：2012-08-07T17:45:15.283
> 
> 标签：qt, qt-creator, slot, qmenubar

我是 Qt 世界的新手）
我在 MSVC 2008 中创建了一个新的 Qt 应用程序，
使用 Qt Creator 添加了我需要的控件，其中一个是 QMenuBar
因为我理解 CallBack(C#) 的等价物是 Qt 中的插槽。
我找不到任何信息如何使用 Qt Creator 为 QMenu 创建自定义插槽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:07:12.907

1.  子类 QMenuBar，并随心所欲地调用新类，例如`FancyMenuBar`.
2.  `Q_OBJECT`在 fancymenubar.h 中的类定义中添加宏（谷歌获取更多信息）。
3.  在您的类定义中添加该行`public slots:`，例如，在 和 之间的`public:`某处`private:`。
4.  在该行下添加插槽定义，例如`void fancySlot();`.
5.  实现槽定义，例如，

（在fancymenubar.cpp 中）

```
void FancyMenuBar::fancySlot()
{
    // type code here
} 
```

现在您可以通过`QObject::connect()`函数使用插槽，或者像使用普通公共函数一样使用插槽。

# ruby-on-rails - Rails Engine：如何根据每个请求自动重新加载类？

> ID：11851315
> 
> 赞同：3
> 
> 时间：2012-08-07T17:45:33.070
> 
> 标签：ruby-on-rails, ruby

我正在开发一个 Rails 引擎，它允许实现者将类放入`app/snippets`.

在引擎内部，我想指示主机 Rails 应用程序`app/snippets`在每次请求时自动重新加载类，这样实施者在进行更改时就不必重新启动服务器。

我知道有一个`config.to_prepare`可以挂钩的初始化事件，但是我无法访问块中的`app.root`类似内容`initializer`。换句话说：

```
initializer 'something' do |app|
  # I need app.root to derive app/snippets
end

config.to_prepare do
  # Can't get app.root from here
end 
```

如何`app/snippets`在每次请求时自动重新加载类？

# php - 使用 Google_Client 的 Google Analytics API 中的 OAUTH2 签名错误

> ID：11851316
> 
> 赞同：1
> 
> 时间：2012-08-07T17:45:36.237
> 
> 标签：php, oauth-2.0, google-analytics-api, google-api-client

尝试使用 OATH2 对 Google Analytics API (v3) 进行身份验证时出现以下错误：

警告：openssl_sign() 期望参数 4 很长，字符串在第 60 行的 google-api-php-client/src/auth/Google_P12Signer.php 中给出

Google_AuthException：无法在第 61 行的 google-api-php-client/src/auth/Google_P12Signer.php 中签署数据

这是我的 PHP 代码：

```
// api dependencies
require_once(dirname(__FILE__) . '/../../vendor/google-api-php-client/src/Google_Client.php');
require_once(dirname(__FILE__) . '/../../vendor/google-api-php-client/src/contrib/Google_AnalyticsService.php');

session_start();

// create client object and set app name
$client = new Google_Client();
$client->setApplicationName(APP_NAME);

// set assertion credentials
$client->setAssertionCredentials(
  new Google_AssertionCredentials(
    'xxxxxxx@developer.gserviceaccount.com',
    array('https://www.googleapis.com/auth/analytics.readonly'),
          file_get_contents('xxxxxxxxxx-privatekey.p12')  // keyfile
));

// other settings
$client->setClientId('xxxxxxx.apps.googleusercontent.com');
$client->setAccessType('offline_access');

// create service
$service = new Google_AnalyticsService($client);

$properties = $service->management_webproperties->listManagementWebproperties("~all");
print_r($properties); 
```

如果我 print_r($service) 我得到一个没有错误的有效对象。生成错误的是 listManagementWebproperties() 调用。

请问有人有解决办法吗？看起来 Google_Client 可能在不断变化，因为它是在几天前编辑的。我通过 SVN 从主干获得它，而不是通过下载页面获得它，我相信它有一个不支持服务帐户的旧版本。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:54:23.457

根据`openssl_sign()`PHP 文档，第四个参数应该是**int**。

[http://php.net/manual/en/function.openssl-sign.php](http://php.net/manual/en/function.openssl-sign.php)

```
bool openssl_sign ( string $data , string &$signature , mixed $priv_key_id [, int $signature_alg = OPENSSL_ALGO_SHA1 ] ) 
```

在[Google_P12Signer](http://code.google.com/p/google-api-php-client/source/browse/trunk/src/auth/Google_P12Signer.php)的代码中，他们像这样使用它：

```
if (!openssl_sign($data, $signature, $this->privateKey, "sha256")) {
  throw new Google_AuthException("Unable to sign data");
} 
```

传递显然不是 INT 的“sha256”。没有根据以下内容为**sha256**定义 OPENSSL_ALGO_* ：[http](http://www.php.net/manual/en/openssl.signature-algos.php) ://www.php.net/manual/en/openssl.signature-algos.php这意味着它不起作用。

你需要做的是定义你自己的 OPENSSL_ALGO_SHA256，有点像你在这段代码中看到的：http: [//pastebin.com/qdCyC0Pe](http://pastebin.com/qdCyC0Pe)

有人还写了一个补丁来帮助：http: [//php.it2y.info/missing-sha256-sha512-families-of-signature-algorithms.html](http://php.it2y.info/missing-sha256-sha512-families-of-signature-algorithms.html)

# delphi - 致命错误：无法创建输出文件“project1.exe”

> ID：11851318
> 
> 赞同：16
> 
> 时间：2012-08-07T17:45:43.703
> 
> 标签：delphi, windows-7, delphi-7, delphi-xe2

所以一段时间以来，我一直遇到这个问题：

在 Windows 7（64 位）上，使用 Delphi 7 和 Delphi XE2，如果从 IDE 中编译一个程序，运行它，停止它，更改它并重新运行它，我会收到以下错误消息：

[致命错误] 无法创建输出文件“project1.exe”

我不知道是什么原因造成的。我搜索了更多信息，但找不到解决方案。

有两种解决方法：等待一两分钟，或者手动删除 project1.exe。不用说，这是行不通的。

我没有病毒扫描程序，也没有病毒。拥有对相关文件夹的完全访问权限。以管理员身份运行一切。

那么是什么原因造成的呢？我能做些什么来解决它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-08T07:34:59.147

我找到了解决方案。似乎禁用服务“应用程序体验”导致了这种情况。禁用时，“系统”任务将锁定“任何”可执行文件一段时间。

重新启用“应用程序体验”是解决方案。

通过以下方式找到：

[https://superuser.com/questions/260375/why-would-system-continue-locking-executable-file-handles-after-the-app-has-exit](https://superuser.com/questions/260375/why-would-system-continue-locking-executable-file-handles-after-the-app-has-exit)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T18:01:09.420

我感觉当您尝试重建应用程序时，project1.exe 仍在运行。也许它需要更长的时间才能关闭。您可以通过打开任务管理器轻松检查，并在关闭应用程序后查看进程*project1.exe*是否仍处于活动状态。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-17T10:45:37.913

我在 XE7 上，偶尔会遇到“*无法创建输出文件*”问题[f2039](/questions/tagged/f2039 "显示标记为“f2039”的问题")。使用 sysinternals 的 Process Explorer，我发现一个 android 调试进程 (adb.exe) 对已编译的二进制文件有一个留置权。不知道为什么；我正在构建的这个特定的 win32 项目中没有 android 配置。无论如何，杀死 adb.exe 之后一切都很好。

一些点。目标输出目录从未被索引。该线程中其他地方提到的“应用程序体验”一直在运行。大多数时候，尽管 XE7 抱怨，我还是可以手动删除输出二进制文件。然而，我注意到，我无法通过 shell 删除二进制文件，这提供了通过 Process Explorer 找到有问题的 adb.exe 的机会。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-29T08:00:27.820

我遇到了同样的问题，我解决了。似乎在某些未知情况下，exe 应用程序仍在运行。
解决方法很简单。您必须按照以下步骤操作：

1.  打开windows任务管理器
2.  转到“进程”选项卡
3.  单击“显示所有用户的进程”，您的 exe 将出现
4.  选择它并按“结束进程”按钮

一切都会好起来的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-29T00:41:30.483

如果您正在使用 Castalia，请尝试删除它。我花了 3 天时间试图解决这个问题，我能想到的一切......文件权限，用进程资源管理器查看文件句柄。如果我安装 Castalia 2013.3.4，就会出现问题（我有重现的步骤），卸载它会使问题消失。

此外，如果您设置了“默认调试桌面”，IDE 将崩溃，并尝试使用任何其他保存的布局在调试器下运行。（在切换到调试桌面时发生崩溃）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-07T16:17:54.643

我右键单击应用程序（在项目组窗口中），然后选择 CLEAN。

然后我就可以编译应用程序了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-12-08T07:21:04.727

在我的情况下，通过从防病毒实时保护中排除项目文件夹来解决问题。

你可以手动删除EXE文件吗？如果没有，进程在内存中，打开任务管理器，选择你的项目，结束任务。您的代码中有一些错误会阻止应用程序终止。

如果它不在进程列表中，请尝试：

1-从 Windows 索引或索引文件的 3rd 方文件搜索应用程序中排除文件夹

2-在windows 7中激活应用程序体验服务

3-从防病毒实时保护中排除项目文件夹

**更新**

我注意到，即使你按照我上面所说的去做，你可能会在**Windows 7**中随机出现这个错误。特别是当你多次编译项目时......第一次编译会好的，但十次或更多次后这个问题会发生

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-11-30T15:42:32.480

观看此链接：
[如何修复错误：[dcc32 致命错误] F2039 无法创建输出文件 X](https://youtu.be/kfMF3Ox0bgs)

只有你最常把这个命令放到所有项目中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-21T12:35:40.127

有时 Microsoft Security Essentials 在 Delphi 中构建文件后会保留该文件，您需要关闭实时保护。

要检查哪个进程保存该文件，请使用 Sysinternals Process Explorer: [link](https://technet.microsoft.com/pl-pl/sysinternals/bb896653.aspx)。使用“查找句柄”并输入您的 exe 名称。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-23T13:50:17.247

在我的情况下，这是由于输出文件夹不存在。

因此，您可以尝试转到项目-> 选项并在目录选项卡下，将输出目录更改为存在的文件夹，然后重试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-11-14T04:22:15.133

1.  尝试打开windows任务管理器
2.  如果您在此处找不到您的应用程序，请前往处理
3.  然后转到详细信息选项卡，您会找到它。

我遇到了同样的问题，然后我在详细信息选项卡上找到了它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-01-29T14:12:02.163

2020 年 1 月 29 日：在过去的一周里，我经历了这样的事情：在 Win 10 机器上加载 Delphi 7 项目，编译它（成功），从 D7 内部运行项目（成功），重新编译项目并得到一个“无法创建 ....project1.exe”。重启后，可以成功编译执行，但第二次编译失败如上。我发现 Dell Support Assist 在 8 天前（大约开始时间）有更新，所以我将其卸载。之后，D7就没有问题了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-04-22T07:04:56.863

一个对我有用的解决方案，更改项目选项 - >链接并保持原样，然后手动删除可执行文件并解决。[项目选项 -> 链接](https://i.stack.imgur.com/Qs8wl.jpg)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-16T10:06:25.403

只需将项目保存在另一个地方即可。这个对我有用。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2015-11-04T09:53:03.757

我似乎通过将兼容模式设置为 XP SP3 来修复它。这也解决了另一个使 Alt-P 无法打开项目菜单的烦恼。

**编辑：**我不必重新启用我的应用程序体验。仍然死在它应该在的地方:)

右键单击您的 Delphi 快捷方式，属性，然后选择兼容性选项卡。选择以兼容模式运行程序：Windows XP (Service pack 3)。

（我还选中了以管理员身份运行此程序框，但您可以选择不这样做。）

（根据 OP 的问题，这适用于 Delphi 7，而不适用于 XE7，尽管它也可能适用。）

[![兼容性设置](../Images/16b7822b92eab65a113635ab6198a412.png)](https://i.stack.imgur.com/5uT8C.jpg)

# vim - Matchit 跳到 HTML 中的下一个列表项而不是结束标记

> ID：11851320
> 
> 赞同：2
> 
> 时间：2012-08-07T17:45:48.720
> 
> 标签：vim, tabs

我下载了 Matchit 插件并将其用于我的 HTML 文件。一切都按预期工作，直到我在我的清单上使用它。

```
<ol>
    <li id="link-1"><a href="http://www.reddit.com/">reddit</a></li>
    <li id="link-2"><a href="http://www.vim.org/">vim</a></li>
    <li id="link-3"><a href="http://www.w3schools.com/">w3schools</a></li>
</ol> 
```

如果`o`当我按下 tab 时光标在第一个，则光标会跳到第一个列表项而不是关闭`ol`。当我位于`l`第一个列表项的第一个时，光标会跳转到`l`下一个列表项标记的第一个。但是，如果我将光标移动到链接标签的第一个 a 并点击选项卡，那么 Matchit 就可以正常工作并跳转到结束标签。Matchit 适用于除列表项之外的所有标签？如何解决此行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:58:32.787

首先，matchit 是随 Vim 分发的，没有被激活。您不需要下载它，只需按照 中的说明进行操作即可`:help matchit-install`。

Matchit 使用一个缓冲区变量`b:match_words`来定义成对的匹配标签：打开一个 HTML 文件并输入`echo b:match_words`. 这里的值是：

```
<:>,<\@<=[ou]l\>[^>]*\%(>\|$\):<\@<=li\>:<\@<=/[ou]l>,<\@<=dl\>[^>]*\%(>\|$\):<\@<=d[td]\>:<\@<=/dl>,<\@<=\([^/][^ \t>]*\)[^>]*\%(>\|$\):<\@<=/\1> 
```

如果我正确理解`:help matchit`这些模式，那么这`<\@<=[ou]l\>[^>]*\%(>\|$\):<\@<=li\>:<\@<=/[ou]l>`部分就是“问题”所在。请注意，定义列表的行为是相同的：matchit 不是跳转到结束标记，而是跳转到中间标记。

我猜想将其粘贴到 HTML ftplugin 中并进行一些自定义可以解决问题。

***编辑***

这条线似乎完全解决了这个问题：

```
autocmd FileType html let b:match_words='<:>,<\@<=\([^/][^ \t>]*\)[^>]*\%(>\|$\):<\@<=/\1>' 
```

我刚刚删除了 and 的两个完全不必要的模式定义`<ul|ol>`，`<dl>`只留下了基本匹配项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T18:52:34.153

尝试使用`g%`. Matchit 有不好的行为：它不是跳转到结束标记，而是在相关匹配列表上进行迭代。我不知道它是否是为 HTML 编码的，但是在编辑 vimscript 时它会迭代`for`-> `continue/break`-> `endfor`。`g%`使 matchit 朝相反的方向迭代，因此，如果您在第一个项目上，它将带​​您到最后一个项目（在我的示例中为`for`-> `endfor`）。

顺便说一句，matchit 几年前就被包含在 vim 发行版中了。你不需要下载它，我什至不能说它是否在任何地方更新，除了在 vim 发行版中。

# linux - 嵌入式系统：我的记忆在哪里？

> ID：11851325
> 
> 赞同：2
> 
> 时间：2012-08-07T17:46:05.077
> 
> 标签：linux, memory, linux-kernel

我有一个基于 ARM 的嵌入式系统。我只是调出内核（2.6.34）。下面是一些命令输出。我无法计算整个 RAM (128 M)。

内核似乎正在使用 128 MB - 124368 kB = 6704 kB。

```
Cache = 1672 kB
Slab = 3000 kB 
```

但 MemFree 只有 100812 kB。我如何计算剩余的内存（大约 18.5 MB）？

还有 1512 kB 的 Committed_AS 值表示什么？

```
# cat /proc/meminfo
MemTotal:         124368 kB
MemFree:          100812 kB
Buffers:               0 kB
Cached:             1672 kB
SwapCached:            0 kB
Active:             1692 kB
Inactive:            284 kB
Active(anon):        304 kB
Inactive(anon):        0 kB
Active(file):       1388 kB
Inactive(file):      284 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:                 4 kB
Writeback:             0 kB
AnonPages:           328 kB
Mapped:              856 kB
Shmem:                 0 kB
Slab:               3000 kB
SReclaimable:       1116 kB
SUnreclaim:         1884 kB
KernelStack:         248 kB
PageTables:           48 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:       62184 kB
Committed_AS:       1512 kB
VmallocTotal:     876544 kB
VmallocUsed:        1848 kB
VmallocChunk:     873908 kB

# free
             total         used         free       shared      buffers
Mem:        124368        23584       100784            0            0
-/+ buffers:              23584       100784
Swap:            0            0            0

# lsmod
Module                  Size  Used by    Not tainted

# ps
  PID USER       VSZ STAT COMMAND
    1 0         1556 S    init
    2 0            0 SW   [kthreadd]
    3 0            0 SW   [ksoftirqd/0]
    4 0            0 SW   [watchdog/0]
    5 0            0 SW   [events/0]
    6 0            0 SW   [khelper]
   10 0            0 SW   [async/mgr]
  200 0            0 SW   [sync_supers]
  202 0            0 SW   [bdi-default]
  203 0            0 SW   [kblockd/0]
  209 0            0 SW   [ata/0]
  210 0            0 SW   [ata_aux]
  211 0            0 SW   [pxa2xx-spi.2]
  218 0            0 SW   [khubd]
  221 0            0 SW   [kseriod]
  234 0            0 SW   [kmmcd]
  253 0            0 SW   [rpciod/0]
  261 0            0 SW   [khungtaskd]
  262 0            0 SW   [kswapd0]
  264 0            0 SW   [aio/0]
  265 0            0 SW   [nfsiod]
  267 0            0 SW   [crypto/0]
  414 0            0 SW   [mtdblockd]
  457 0            0 SW   [ubi_bgt0d]
  537 0            0 SW   [usbhid_resumer]
  563 0            0 SW   [ubifs_bgt0_0]
  581 0         1556 S    telnetd -l /bin/sh
  586 0         1948 S <  udevd -d
 2956 0         1560 S    -/bin/sh
 3986 0            0 SW   [flush-ubifs_0_0]
 3990 0         4216 R    ps 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:18:01.170

（这是渴望评论）

```
Committed_AS: An estimate of how much RAM you would need to make a
              99.99% guarantee that there never is OOM (out of memory)
              for this workload. Normally the kernel will overcommit
              memory. That means, say you do a 1GB malloc, nothing
              happens, really. Only when you start USING that malloc
              memory you will get real memory on demand, and just as
              much as you use. So you sort of take a mortgage and hope
              the bank doesn't go bust. Other cases might include when
              you mmap a file that's shared only when you write to it
              and you get a private copy of that data. While it normally
              is shared between processes. The Committed_AS is a
              guesstimate of how much RAM/swap you would need
              worst-case. 
```

[http://lwn.net/Articles/28345/](http://lwn.net/Articles/28345/)

# crystal-reports - Crystal Reports - 某些字段未显示在数据上下文中

> ID：11851326
> 
> 赞同：2
> 
> 时间：2012-08-07T17:46:05.067
> 
> 标签：crystal-reports

***编辑：我发现字段资源管理器中未显示的所有字段都是非 varchar 的数据类型。没有出现的三个是“money”、“numeric”和“datetime2”类型。我仍然不知道如何解决它，但我认为这可能有助于回答我的问题！***

我正在使用我没有创建的数据库（SQL Server）进行项目，所以我可以用它做的事情是有限的。我创建了一个视图并选择了我需要的字段，但是当我使用 Database Expert 并选择视图时，实际上只显示了 6 个字段中的 3 个，不幸的是，这是我最不需要的 3 个字段。我尝试通过 Database Expert 添加几个不同的表，但我测试的每一个表都缺少字段。我会说这个数据库充满了空值并且设计得很糟糕，但是因为我为此创建了一个视图，所以我专门排除了其中包含空值的任何行，只是为了看看这是否是问题所在。不幸的是，它根本没有帮助。

我已经在谷歌上搜索了大约一个小时，我发现一些人有类似的问题，但并不完全相同，到目前为止，没有一个修复程序真正有帮助。看起来它应该是相对简单的东西，但我对水晶报表很陌生。

非常感谢任何帮助，谢谢！

EDIT2：我已经删除了所有的图片，因为我不想在发布这个项目的东西时遇到任何麻烦。我不认为他们有什么重要的，但安全第一！对不起，如果这给未来的读者带来任何不便:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T22:24:35.497

如果您使用单个表，这些字段是否显示数据？如果 Xtal 无法识别您的类型，您始终可以将它们转换为“更好”的类型。

这将有助于查看您的实际视图定义 - 您的示例不够具体并且令人困惑，指示单个输出列，并且逻辑显示测试（和输出）单个静态值。查看您的实际表定义也可能会有所帮助。使用现有表格和 DB Expert 设计报告可能有更好的方法（再说一遍......也许不是，但我们怎么知道？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-23T06:21:55.647

我使用数据类来创建我的报告。当字段资源管理器中未显示字段时，请转到您的数据类并更改未显示的字段类型`nullable = false`或仅更改数据类中的数据类型。我做到了，它有效。我希望这可以帮助你。有时您还需要在 SQL 表或视图中更改它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-03T20:51:25.930

只需转到放置数据表的 dataset.xsd，选择您需要的列并从属性中更改其数据类型。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-09-18T01:59:17.293

我做了一些测试，我发现它不会让我用一个带有变量的公式制作图表。

但是，我可以在另一个公式中引用“变量评估”公式，并且该公式会显示在图表数据视图中。

例如：

```
formula Blah
shared numbervar Myvariable:=10

formula ChartUse
{Blah}+1 
```

希望这可以帮助某人

# asp.net-mvc-3 - ASP.NET MVC 中如何调用 Error.cshtml？

> ID：11851328
> 
> 赞同：82
> 
> 时间：2012-08-07T17:46:16.423
> 
> 标签：asp.net-mvc-3

我在 StackOverflow 上阅读了十几个类似的问题，但我似乎无法理解这一点。关于 web.config 和 HandleErrorAttribute 中的自定义错误节点，Error.cshtml 是如何被调用的？最终，这个问题的答案可能是已经存在的关于 ASP.NET MVC 错误处理的几个问题之一的答案。但是，事实是，我不知道是哪一个。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-08-07T17:53:53.130

在您的 Global.asax 中，您有以下方法：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new HandleErrorAttribute());
} 
```

这会将 HandleErrorAttribute 注册为全局操作过滤器。这意味着此处理程序会自动应用于所有控制器操作。现在我们通过查看源码来看看这个属性是如何实现的：

```
[SuppressMessage("Microsoft.Performance", "CA1813:AvoidUnsealedAttributes", Justification = "This attribute is AllowMultiple = true and users might want to override behavior.")]
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, Inherited = true, AllowMultiple = true)]
public class HandleErrorAttribute : FilterAttribute, IExceptionFilter {

    private const string _defaultView = "Error";

    private readonly object _typeId = new object();

    private Type _exceptionType = typeof(Exception);
    private string _master;
    private string _view;

    public Type ExceptionType {
        get {
            return _exceptionType;
        }
        set {
            if (value == null) {
                throw new ArgumentNullException("value");
            }
            if (!typeof(Exception).IsAssignableFrom(value)) {
                throw new ArgumentException(String.Format(CultureInfo.CurrentCulture,
                    MvcResources.ExceptionViewAttribute_NonExceptionType, value.FullName));
            }

            _exceptionType = value;
        }
    }

    public string Master {
        get {
            return _master ?? String.Empty;
        }
        set {
            _master = value;
        }
    }

    public override object TypeId {
        get {
            return _typeId;
        }
    }

    public string View {
        get {
            return (!String.IsNullOrEmpty(_view)) ? _view : _defaultView;
        }
        set {
            _view = value;
        }
    }

    public virtual void OnException(ExceptionContext filterContext) {
        if (filterContext == null) {
            throw new ArgumentNullException("filterContext");
        }
        if (filterContext.IsChildAction) {
            return;
        }

        // If custom errors are disabled, we need to let the normal ASP.NET exception handler
        // execute so that the user can see useful debugging information.
        if (filterContext.ExceptionHandled || !filterContext.HttpContext.IsCustomErrorEnabled) {
            return;
        }

        Exception exception = filterContext.Exception;

        // If this is not an HTTP 500 (for example, if somebody throws an HTTP 404 from an action method),
        // ignore it.
        if (new HttpException(null, exception).GetHttpCode() != 500) {
            return;
        }

        if (!ExceptionType.IsInstanceOfType(exception)) {
            return;
        }

        string controllerName = (string)filterContext.RouteData.Values["controller"];
        string actionName = (string)filterContext.RouteData.Values["action"];
        HandleErrorInfo model = new HandleErrorInfo(filterContext.Exception, controllerName, actionName);
        filterContext.Result = new ViewResult {
            ViewName = View,
            MasterName = Master,
            ViewData = new ViewDataDictionary<HandleErrorInfo>(model),
            TempData = filterContext.Controller.TempData
        };
        filterContext.ExceptionHandled = true;
        filterContext.HttpContext.Response.Clear();
        filterContext.HttpContext.Response.StatusCode = 500;

        // Certain versions of IIS will sometimes use their own error page when
        // they detect a server error. Setting this property indicates that we
        // want it to try to render ASP.NET MVC's error page instead.
        filterContext.HttpContext.Response.TrySkipIisCustomErrors = true;
    }
} 
```

源代码包含注释并且不仅仅是自我解释。它检查的第一件事是您是否在 web.config (ie `<customErrors mode="On">`) 中启用了自定义错误。如果你没有，它什么都不做=> YSOD。如果您启用了自定义错误，则它会呈现错误视图，并向其传递一个包含异常堆栈跟踪和其他有用信息的模型。

# jakarta-ee - 单个 Java EE 服务器可以处理多少个远程 EJB 客户端？

> ID：11851329
> 
> 赞同：0
> 
> 时间：2012-08-07T17:46:17.207
> 
> 标签：jakarta-ee, numbers, ejb, capacity

我们有一种情况，大约有 450 个远程 EJB 客户端需要连接到 Java EE 服务器（OpenEJB 3.1.4 容器）。不存在 HTTP 服务器。

我们注意到，在一些客户端上线后，服务器开始抛出 javax.ejb.ConcurrentAccessTimeoutException。

文档说这是由于尝试在方法中同时访问有状态会话 bean 或单例 bean 时超时引起的。我们实际上都使用了两者，但很难弄清楚超时的好值可能是多少。

如果该值很高，我们会得到更少的 ConcurrentAccessTimeoutExceptions，但很多客户端只是开始永远挂在那里。如果该值较低，则会引发大量 ConcurrentAccessTimeoutExceptions。

所有 450 个客户端在启动时建立与服务器的连接（因为连接时间太长而无法按需建立）并永远保持它。

现在，除此之外，还有另一个问题。每个客户端以 2 秒的间隔不断地轮询服务器。我们可以改变这种行为，但我们必须调整架构。

是否有研究或任何有许多客户端连接到 Java EE 服务器的经验的人？

我们可以设计任何需要的东西，但我们希望有一个更具体的目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T04:51:25.003

在 StackOverflow 上回答可能是一个棘手的问题，因为最终这是一个与 EJB 无关的线程问题。这个问题或多或少等同于“我有在同步块中执行的代码，我应该能够使用多少线程并保持快速？”

真正的问题是同步块中的代码在做什么？（即`@Stateful`bean 或`@Lock(WRITE)`方法`@Singleton`）。目标是消除同步的需要或至少缩短同步代码运行的持续时间。

有一些具体的方法可以获取这些信息。

一种技术是将超时增加到接近无穷大，然后当事情挂起时，`kill -3 12345`在命令行上发出 a ，其中 12345 是服务器的进程 ID。这将导致线程转储被吐出到服务器的 System.out 上。

该输出将准确显示每个线程正在做什么以及我们当前调用的方法以及该线程是否处于等待状态。您需要多次选择该输出。

它应该为您提供一些线索，让您了解代码的哪些区域可能最阻碍演出。要回答的问题是导致其他线程必须等待的代码是什么。

# javascript - ExtJS Panel中的三个.js场景

> ID：11851330
> 
> 赞同：1
> 
> 时间：2012-08-07T17:46:25.170
> 
> 标签：javascript, extjs, three.js

我没有设法在 ExtJS 面板中呈现 Three.js 场景。有谁知道一些演示代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T08:12:22.423

我想通了，所以我将回答我自己的问题，因为这可能对其他人有所帮助。

像这样定义 ExtJS 面板：

```
xtype : 'panel',
id : '3dviewer',
region : 'center',
layout : 'fit' 
```

Three.js WebGL 渲染器是这样的：

```
renderer = new THREE.WebGLRenderer({
    antialias : true
});
renderer.setSize(width, height); 
```

渲染器 dom 元素可以像这样添加到面板中：

```
Ext.getCmp('3dviewer').body.appendChild(renderer.domElement); 
```

# magento - 与magento ORM建立一对多或多对多关系

> ID：11851333
> 
> 赞同：0
> 
> 时间：2012-08-07T17:46:28.850
> 
> 标签：magento, entity-relationship, magento-1.5

我有一个我正在处理的 magento 扩展的自定义模型/对象。我需要设置与另一个对象的关系（例如，与产品的关系）。

我将需要一对多和多对多的关系。如何使用 magento 实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T23:40:28.387

Magento 的 ORM 没有内置管理传统的一对多或多对多关系。您需要为此类事情开发自己的查询策略。

# vb.net - Powershell 脚本适用于 Powershell，但不适用于 VB.Net

> ID：11851334
> 
> 赞同：3
> 
> 时间：2012-08-07T17:46:30.823
> 
> 标签：vb.net, powershell, exchange-server

我有一个简单的 powershell 脚本来启用 Exchange 中名为 test.ps1 的邮箱。这是脚本：

add-pssnapin microsoft.exchange.management.powershell.admin Enable-Mailbox -Identity 'gi joe' -database 'myserver\myserver 邮箱数据库 17'

如果我去 Powershell 控制台并输入

./test.ps1

它将成功运行。但是，如果我在 VB.net 中使用

Process.Start("powershell", "test.ps1")

终端闪得太快，我看不到它在说什么，而且它没有创建邮箱。为什么会发生这种情况，或者如何在读取错误之前阻止终端消失？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:50:57.320

要查看出了什么问题，请尝试以下方法：

```
Process.Start("powershell", "-noexit -file c:\<path>\test.ps1") 
```

我怀疑你得到的错误是因为你没有提供 test.ps1 的完整路径。

另一种可能性是您的 32 位 VB 应用程序需要启动 64 位 Powershell（可能仅在该处可用）。在这种情况下，您需要通过路径调用 PowerShell，并且必须`SysNative`在路径中使用才能看到 64 位 PowerShell 目录。

```
var powerShellPath = "C:\Windows\SysNative\WindowsPowerShell\v1.0\powershell.exe"
Process.Start(powerShellPath , "-noexit -file c:\<path>\test.ps1") 
```

抱歉，这可能不是正确的 VB 语法，但应该可以帮助您。

# c - 为什么int在printf中不转换为double？

> ID：11851335
> 
> 赞同：1
> 
> 时间：2012-08-07T17:46:35.267
> 
> 标签：c, int, double, printf

> **可能重复：**
> [如何在 printf 中处理 float/double 到 int 的转换？](https://stackoverflow.com/questions/2398791/how-is-conversion-of-float-double-to-int-handled-in-printf)

```
main()
{
    printf("%f",1);
} 
```

我期望的输出是`1.000000`，即*int 1*被向上转换为*1.000000 的两倍*，但它给出了`0.000000`。为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:47:52.423

当为格式化指令（在本例`int`中为 a `%f`）提供不匹配的参数时，结果行为是***undefined***。

这个问题或它的一些变体会定期出现，请参阅 [将 int 打印为浮点数时 printf 的行为是什么？](https://stackoverflow.com/questions/8203754/what-is-printfs-behaviour-when-printing-an-int-as-float?rq=1)[printf函数有问题吗](https://stackoverflow.com/questions/7232603/problem-with-printf-function?rq=1)？示例/更多信息。

# c - 如何自省 Perl API 中的正则表达式

> ID：11851336
> 
> 赞同：11
> 
> 时间：2012-08-07T17:46:35.090
> 
> 标签：c, regex, perl, introspection, xs

我正在处理一些需要序列化 ​​Perl 正则表达式的代码，包括任何正则表达式标志。仅支持标志的子集，因此我需要检测不支持的标志（如`/u`regex 对象中的时间）。

当前版本的代码是这样做的：

```
static void serialize_regex_flags(buffer *buf, SV *sv) {
  char flags[] = {0,0,0,0,0,0};
  unsigned int i = 0, f = 0;
  STRLEN string_length;
  char *string = SvPV(sv, string_length); 
```

然后手动处理`string`char-by-char 以查找标志。

这里的问题是正则表达式标志的字符串化（我认为在 Perl 5.14 中）从 eg`(?i-xsm:foo)`更改为`(?^i:foo)`，这使得解析很痛苦。

我可以检查 的版本`perl`，或者只是编写解析器来处理这两种情况，但有些事情告诉我必须有一种更好的自省方法可用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T18:25:08.113

在 Perl 中，您将使用`re::regexp_pattern`.

```
 my $re = qr/foo/i;
 my ($pat, $mods) = re::regexp_pattern($re);
 say $pat;   # foo
 say $mods;  # i 
```

从 的源码可以看出，[`regexp_pattern`](http://perl5.git.perl.org/perl.git/blob/5286555350c911f136a6b28b3bbca509249d1f94:/universal.c#l1250)API 中没有获取该信息的函数，因此我建议您也从 XS 中调用该函数。

[perlcall](http://perldoc.perl.org/perlcall.html)涵盖了从 C 调用 Perl 函数。我想出了以下未经测试的代码：

```
/* Calls re::regexp_pattern to extract the pattern
 * and flags from a compiled regex.
 *
 * When re isn't a compiled regex, returns false,
 * and *pat_ptr and *flags_ptr are set to NULL.
 *
 * The caller must free() *pat_ptr and *flags_ptr.
 */ 
```

```
static int regexp_pattern(char ** pat_ptr, char ** flags_ptr, SV * re) {
   dSP;
   int count;
   ENTER;
   SAVETMPS;
   PUSHMARK(SP);
   XPUSHs(re);
   PUTBACK;
   count = call_pv("re::regexp_pattern", G_ARRAY);
   SPAGAIN;

   if (count == 2) {
      /* Pop last one first. */
      SV * flags_sv = POPs;
      SV * pat_sv   = POPs;

      /* XXX Assumes no NUL in pattern */
      char * pat   = SvPVutf8_nolen(pat_sv); 
      char * flags = SvPVutf8_nolen(flags_sv);

      *pat_ptr   = strdup(pat);
      *flags_ptr = strdup(flags);
   } else {
      *pat_ptr   = NULL;
      *flags_ptr = NULL;
   }

   PUTBACK;
   FREETMPS;
   LEAVE;

   return *pat_ptr != NULL;
} 
```

用法：

```
SV * re = ...;

char * pat;
char * flags;
regexp_pattern(&pat, &flags, re); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T18:19:12.080

```
use Data::Dump::Streamer ':util';
my ($pattern, $flags) = regex( qr/foo/i );
print "pattern: $pattern, flags: $flags\n";
# pattern: foo, flags: i 
```

但是，如果您试图限制更新的功能，那么除了检查 /u 之外，您还有很多工作要做。

# ruby-on-rails - 使用分解的条件过滤器在 ruby on rails 中显示记录

> ID：11851339
> 
> 赞同：0
> 
> 时间：2012-08-07T17:46:57.767
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

如果没有发送，如何显示表中的所有记录`params[:subject_id]`，或者过滤发送时将显示的记录`params[:subject_id]`？

到目前为止，我在 pages 控制器中有一个 before 过滤器来检查是否`params[:subject_id]`已发送并创建一个实例变量。

```
 private

  def find_subject
    if params[:subject_id]
      @subject = Subject.find_by_id(params[:subject_id])
    else
      @subject = Subject.all
    end
  end 
```

问题出在这样的操作中，`@pages`仅存储最后一条记录，但不会破坏视图中的任何内容。

```
 before_filter :find_subject

  def list
    @subject.each do |subject|
      @pages = Page.order("pages.position ASC").where(:subject_id => subject.id)
    end
  end 
```

但是，如果我这样做

```
 def list
      @pages = Page.order("pages.position ASC").where(:subject_id => @subject.id)
  end 
```

根本没有返回任何记录，当我在 webrick 控制台中检查输出时，我看到了这个

```
Subject Load (0.2ms)  SELECT `subjects`.* FROM `subjects` 
Page Load (0.4ms)  SELECT `pages`.* FROM `pages` WHERE `pages`.`subject_id` = 2186859380 ORDER BY pages.position ASC 
```

我不知道它是如何获得这个 id 的`2186859380`

我也是这样累的

```
 def list
    if @subject.object_id.nil?
      @pages = Page.order("pages.position ASC")
    else
      @pages = Page.order("pages.position ASC").where(:subject_id => @subject.object_id)
    end
  end 
```

然而，这也会引发一些错误并打破我的看法。

这是我的观点，所以你可以得到一个完整的图片

```
<div class="page list">
    <h2>Pages</h2>
<%= link_to "Add a new Page", {:action => "new", :subject_id => @subject.id}, :class => "action new" %>
    <table class="listing" summary="Pages List">
        <tr class="header">
            <th>&nbsp;</th>
            <th>Subject</th>
            <th>Page</th>
            <th>Visible</th>
            <th>Sections</th>
            <th>Permalink</th>
            <th>Actions</th>
        </tr>
        <% @pages.each do |page| %>
        <tr class="<%= cycle("odd", "even") %>">
            <td><%= page.position %></td>
            <td><%= page.subject.name %></td>
            <td><%= page.name %></td>
            <td class="center"><%= page.visible ? "Yes" : "No" %></td>
            <td class="center"><%= page.sections.size %></td>
            <td><%= page.permalink %></td>
            <td class="actions">
                <%= link_to("Sections", {:controller => "sections", :action => "list", :page_id => page.id}, :class => "action delete")%>
                <%= link_to("Show", {:action => "show", :id => page.id, :subject_id => @subject.id}, :class => "action show")%>
                <%= link_to("Edit", {:action => "edit", :id => page.id, :subject_id => @subject.id}, :class => "action edit")%>
                <%= link_to("Delete", {:action => "delete", :id => page.id, :subject_id => @subject.id}, :class => "action delete")%>
            </td>
        </tr>
        <% end %>
    </table>
</div> 
```

对我做错的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:44:57.880

我认为您应该像这里一样在主题中添加一个“s”：

```
 private

  def find_subject
    if params[:subject_id]
      @subject = Subject.find_by_id(params[:subject_id])
    else
      @subjects = Subject.all
    end
  end 
```

所以现在，你可以这样做：

```
def list
  if subjects
    @subject.each do |subject|
      @pages = Page.order("pages.position ASC").where(:subject_id => subject.id)
    end
  else
    @pages = Page.order("pages.position ASC").where(:subject_id => @subject.id)
  end
end 
```

在您看来，您可以做类似的事情...

# c - 要求输入数字并存储在数组中但检查它是否已经存在

> ID：11851340
> 
> 赞同：0
> 
> 时间：2012-08-07T17:47:01.150
> 
> 标签：c, arrays

我正在为一个程序编写一个函数，该程序要求用户输入一个“学生证号码”并将其存储在数组中。在存储函数之前，必须检查数组中是否还没有该数字，因为学生编号必须是唯一的。它还包括一个指向 int 的指针，该指针表示到目前为止已存储了多少学生编号。我已经写了一些代码，但它不工作:( 有人能说明一下吗？这是我的代码：

```
void update_student_id(int a[], int*pnum)
{
        int temp,h;
        for (h=0;h<=*pnum;h++){
                printf(">>>Student ID:");
                scanf("%d",&temp);
                        if (temp==a[h]){
                                printf("ERROR:%d has already been used!\n",temp);
                                h=*pnum+1;
                        }
                        else
                            h=*pnum+1;
            }
        a[*pnum]=temp;
        *pnum++; 
```

好的，带有 2 个 for 循环的新版本，改进但还没有工作:(

```
void update_student_id(int a[], int*pnum)
{
    int temp,h,i;
    for (h=0;h<=*pnum;h++){
            printf(">>>Student ID:");
            scanf("%d",&temp);

            for(i=0;i<=*pnum;i++)
                    if (temp==a[i]){
                            printf("ERROR:%d has already been used!\n",temp);
                            i=*pnum+1;
                    }
                    else    i++;
            }
        a[*pnum]=temp;
        (*pnum)++;
} 
```

在丹尼斯的帮助下解决了问题，最终代码：

```
void update_student_id(int a[], int*pnum)
{
    int temp,h,i,canary;
    for (h = 0; h <= *pnum; h++) {
            printf(">>>Student ID:");
            scanf("%d", &temp);

    canary = 0;
    for (i = 0; i < *pnum; i++) {
            if (temp == a[i]) {
            printf("ERROR:%d has already been used!\n",temp);
            canary = 1;
            break;
            }
    }
    if (canary == 0) {
            a[*pnum] = temp;
            (*pnum)++;
            break;
        }
}

return;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:56:08.137

~~因此，我看到的主要内容是，在您扫描数字之后，您实际上并没有检查该数字是否已经在数组中。您只是检查它是否在特定索引处。~~

~~更具体地说，您需要的不仅仅是 for 循环中的 if 语句；也许是另一个循环查看到目前为止已使用的索引。~~

编辑：最大的问题是在 else 子句中，不要增加`i`. 其次，您需要一些金丝雀变量来让您知道您是否已对 printf 进行了调用。

例如，这是我对这些循环的想法：

```
for (h = 0; h < *pum; h++) {
    printf(">>>Student ID:");
    scanf("%d", &temp);

    canary = 0; // assuming you initialize this at beginning of function
    for (i = 0; i < *pnum; i++) {
        if (temp == a[i]) {
            printf("ERROR:%d has already been used!\n",temp);
            canary = 1;
            break;
        }
        // DON'T INCREMENT i, LOOP IS ALREADY DOING IT
    }

    // if canary is still 0, we know we haven't called that printf
    // and can add in the element. Only then do we increment the count.
    if (canary == 0) {
        a[*pnum] = temp;
        (*pnum)++;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T20:09:59.257

如果 - 如果 - 您可以按排序顺序维护您的 ID，那么您可以获得许多重大优化。这几乎肯定会涉及远离作为容器的简单数组。像堆这样的东西会很合适。如果您想继续使用数组并且不介意插入是 O(n)，那么您可以保持排序顺序并使用二进制搜索进行存在性检查。不幸的是，标准库`bsearch()`函数没有告诉你*应该在哪里*如果找不到匹配项，则插入一个元素。编写你自己的二分搜索是一件非常困难的事情，但如果你这样做，它是很好的可重用代码。您想要的是一个函数，如果元素存在则返回 true 或 false，并且如果它不存在则返回匹配元素的指针或立即较低的值（或者如果没有元素更小，则返回数组指针本身。）然后在如果找不到匹配项，您会将所有较大的元素移到一个位置并插入新元素。

由于这是一个家庭作业问题，我猜您仅限于 C，但是 C++ STL`set<int>`将您必须做的工作减少到几行。

# android - SQLite 按非日历月分组（从一个月的 10 号到下个月的 10 号）

> ID：11851341
> 
> 赞同：0
> 
> 时间：2012-08-07T17:47:00.893
> 
> 标签：android, database, sqlite, group-by

我是一名 Android 程序员，我在我的应用程序中使用 SQLite（没有太多选择:)）。我有一个表，其中包含一个 unix 时间戳字段。现在，如果我想对这个表中的某个字段求和，并按月分组，我只是这样做：

SELECT 月、年、sum(x) FROM GROUP BY 月、年

（当然，月份和年份是日期函数）。

但我想按非日历月对它进行分组，比如从一个月的 10 号到他之后的 10 号。

我对 SQL 有非常基本的了解，所以我不知道如何去做。有人告诉我我需要使用 PARTITION BY 但 SQLite 不支持它。我很确定有办法做到这一点。

提前致谢， 埃拉德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:08:26.727

要处理月份的十号，您可以从日期中减去 10 天：

```
select strftime("%y %m", tendaysbefore), <whatever>
from (select foo.*,
             date(thedate, '-10 days') as tendaysbefore
      from foo
     ) t
group by strftime("%Y-%m", tendaysbefore)
order by 1, 2 
```

您可以将年份和月份放在不同的列中。此示例将它们放在一列中。

# python - 在 Python 中，如何体素化 3D 网格

> ID：11851342
> 
> 赞同：11
> 
> 时间：2012-08-07T17:47:04.680
> 
> 标签：python, 3d, mesh, .obj, voxel

我需要帮助才能开始使用 Python（我几乎一无所知）来体素化从 Rhino 生成的 3D 网格。数据输入将是一个 .OBJ 文件，输出也是如此。这种用法的最终目的是找到建筑物内两点之间的最短距离。但那是以后的事了。至于现在，我需要先体素化一个 3D 网格。体素化原语可能只是一个简单的立方体。

到目前为止，我可以从 OBJ 文件解析器中读取已解析的 obj，并去除 V、VT、VN、F 前缀，并使用这些坐标查找 3D 对象的边界框。体素化网格的正确方法应该是什么？

```
import objParser
import math

inputFile = 'test.obj'
vList = []; vtList = []; vnList = []; fList = []

def parseOBJ(inputFile):
list = []
vList, vtList, vnList, fList = objParser.getObj(inputFile)
print 'in parseOBJ'
#print vList, vtList, vnList, fList
return vList, vtList, vnList, fList

def findBBox(vList):
   i = 0; j=0; x_min = float('inf'); x_max = float('-inf'); y_min = float('inf');
   y_max =  float('-inf'); z_min = float('inf'); z_max = float('-inf');
   xWidth = 0; yWidth = 0; zWidth =0

print 'in findBBox'
while i < len(vList):
        #find min and max x value
        if vList[i][j] < x_min:
            x_min = float(vList[i][j])
        elif vList[i][j] > x_max:
            x_max = float(vList[i][j])

        #find min and max y value
        if vList[i][j + 1] < y_min:
            y_min = float(vList[i][j + 1])
        elif vList[i][j + 1] > y_max:
            y_max = float(vList[i][j + 1])

        #find min and max x value
        if vList[i][j + 2] < z_min:
            z_min = vList[i][j + 2]
        elif vList[i][j + 2] > z_max:
            z_max = vList[i][j + 2]

        #incriment the counter int by 3 to go to the next set of (x, y, z)
        i += 3; j=0

xWidth = x_max - x_min
yWidth = y_max - y_min
zWidth = z_max - z_min
length = xWidth, yWidth, zWidth
volume = xWidth* yWidth* zWidth
print 'x_min, y_min, z_min : ', x_min, y_min, z_min
print 'x_max, y_max, z_max : ', x_max, y_max, z_max
print 'xWidth, yWidth, zWidth : ', xWidth, yWidth, zWidth
return length, volume

def init():
    list = parseOBJ(inputFile)
    findBBox(list[0])

print init() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T11:48:42.170

我没用过，但你可以试试这个：[http ://packages.python.org/glitter/api/examples.voxelization-module.html](http://packages.python.org/glitter/api/examples.voxelization-module.html)

或者这个工具： http: [//www.patrickmin.com/binvox/](http://www.patrickmin.com/binvox/)

如果您想自己执行此操作，您有两种主要方法：

*   当您考虑到网格内部时，“真正的”体素化 - 相当复杂，您需要大量的 CSG 操作。那里我帮不了你。
*   一个“假”的 - 只需体素化网格的每个三角形。这要简单得多，您需要做的就是检查三角形和轴对齐立方体的交集。然后，您只需执行以下操作：

    ```
    for every triagle:
        for every cube:
            if triangle intersects cube:
                set cube = full
            else:
                set cube = empty 
    ```

您需要做的就是实现一个 BoundingBox-Triangle 相交。当然，您可以稍微优化一下 for 循环:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-04-01T09:53:36.467

对于每个仍然有这个问题的人。我已经编写了一个文件，该文件制作了一个 STL 3d 文件的体素（您可以将 .obj 文件另存为 stl）。我使用了 kolenda 建议的方法来解决这个问题。这是为了所谓的“假”体素化。仍在努力填充这个体素。我使用 numpy.stl 来导入文件，并且只为文件的其余部分导入标准包。我为我的程序使用了以下链接。

[对于线平面碰撞](https://gist.github.com/TimSC/8c25ca941d614bf48ebba6b473747d72)

[检查点是否在三角形中](https://blackpawn.com/texts/pointinpoly/#:%7E:text=A%20common%20way%20to%20check,triangle%2C%20otherwise%20it%20is%20not.)

它可能不是最有效的，但它确实有效。

```
import numpy as np
import os
from stl import mesh
from mpl_toolkits import mplot3d
import matplotlib.pyplot as plt
import math

if not os.getcwd() == 'path_to_model':
    os.chdir('path_to model')

your_mesh = mesh.Mesh.from_file('file.stl') #the stl file you want to voxelize

## set the height of your mesh
for i in range(len(your_mesh.vectors)):
    for j in range(len(your_mesh.vectors[i])):
        for k in range(len(your_mesh.vectors[i][j])):
            your_mesh.vectors[i][j][k] *= 5

## define functions
def triangle_voxalize(triangle):
    trix = []
    triy = []
    triz= []
    triangle = list(triangle)

    #corners of triangle in array formats
    p0 = np.array(triangle[0])
    p1 = np.array(triangle[1])
    p2 = np.array(triangle[2])

    #vectors and the plane of the triangle
    v0 = p1 - p0
    v1 = p2 - p1
    v2 = p0 - p2
    v3 = p2 - p0
    plane = np.cross(v0,v3)

    #minimun and maximun coordinates of the triangle
    for i in range(3):
        trix.append(triangle[i][0])
        triy.append(triangle[i][1])
        triz.append(triangle[i][2])
    minx, maxx = int(np.floor(np.min(trix))), int(np.ceil(np.max(trix)))
    miny, maxy = int(np.floor(np.min(triy))), int(np.ceil(np.max(triy)))
    minz, maxz = int(np.floor(np.min(triz))), int(np.ceil(np.max(triz)))

    #safe the points that are inside triangle
    points = []

    #go through each point in the box of minimum and maximum x,y,z
    for x in range (minx,maxx+1):
        for y in range(miny,maxy+1):
            for z in range(minz,maxz+1):

                #check the diagnals of each voxel cube if they are inside triangle
                if LinePlaneCollision(triangle,plane,p0,[1,1,1],[x-0.5,y-0.5,z-0.5],[x,y,z]):
                    points.append([x,y,z])
                elif LinePlaneCollision(triangle,plane,p0,[-1,-1,1],[x+0.5,y+0.5,z-0.5],[x,y,z]):
                    points.append([x,y,z])
                elif LinePlaneCollision(triangle,plane,p0,[-1,1,1],[x+0.5,y-0.5,z-0.5],[x,y,z]):
                    points.append([x,y,z])
                elif LinePlaneCollision(triangle,plane,p0,[1,-1,1],[x-0.5,y+0.5,z-0.5],[x,y,z]):
                    points.append([x,y,z])

                #check edge cases and if the triangle is completly inside the box
                elif intersect(triangle,[x,y,z],v0,p0):
                    points.append([x,y,z])
                elif intersect(triangle,[x,y,z],v1,p1):
                    points.append([x,y,z])
                elif intersect(triangle,[x,y,z],v2,p2):
                    points.append([x,y,z])

    #return the points that are inside the triangle
    return(points)

#check if the point is on the triangle border
def intersect(triangle,point,vector,origin):
    x,y,z = point[0],point[1],point[2]
    origin = np.array(origin)

    #check the x faces of the voxel point
    for xcube in range(x,x+2):
        xcube -= 0.5
        if LinePlaneCollision(triangle,[1,0,0], [xcube,y,z], vector, origin,[x,y,z]):
            return(True)

    #same for y and z
    for ycube in range(y,y+2):
        ycube -= 0.5
        if LinePlaneCollision(triangle,[0,1,0], [x,ycube,z], vector, origin,[x,y,z]):
            return(True)
    for zcube in range(z,z+2):
        zcube -= 0.5
        if LinePlaneCollision(triangle,[0,0,1], [x,y,zcube], vector, origin,[x,y,z]):
            return(True)

    #check if the point is inside the triangle (in case the whole tri is in the voxel point)
    if origin[0] <= x+0.5 and origin[0] >= x-0.5:
        if origin[1] <= y+0.5 and origin[1] >= y-0.5:
            if origin[2] <= z+0.5 and origin[2] >= z-0.5:
                return(True)

    return(False)

# I modified this file to suit my needs:
# https://gist.github.com/TimSC/8c25ca941d614bf48ebba6b473747d72
#check if the cube diagnals cross the triangle in the cube
def LinePlaneCollision(triangle,planeNormal, planePoint, rayDirection, rayPoint,point, epsilon=1e-6):
    planeNormal = np.array(planeNormal)
    planePoint = np.array(planePoint)
    rayDirection = np.array(rayDirection)
    rayPoint = np.array(rayPoint)

    ndotu = planeNormal.dot(rayDirection)
    if abs(ndotu) < epsilon:
        return(False)

    w = rayPoint - planePoint
    si = -planeNormal.dot(w) / ndotu
    Psi = w + si * rayDirection + planePoint

    #check if they cross inside the voxel cube
    if np.abs(Psi[0]-point[0]) <= 0.5 and np.abs(Psi[1]-point[1]) <= 0.5 and np.abs(Psi[2]-point[2]) <= 0.5:
        #check if the point is inside the triangle and not only on the plane
        if PointInTriangle(Psi, triangle):
            return (True)
    return (False)

# I used the following file for the next 2 functions, I converted them to python. Read the article. It explains everything way better than I can.
# https://blackpawn.com/texts/pointinpoly#:~:text=A%20common%20way%20to%20check,triangle%2C%20otherwise%20it%20is%20not.
#check if point is inside triangle
def SameSide(p1,p2, a,b):
    cp1 = np.cross(b-a, p1-a)
    cp2 = np.cross(b-a, p2-a)
    if np.dot(cp1, cp2) >= 0:
        return (True)
    return (False)

def PointInTriangle(p, triangle):
    a = triangle[0]
    b = triangle[1]
    c = triangle[2]
    if SameSide(p,a, b,c) and SameSide(p,b, a,c) and SameSide(p,c, a,b):
        return (True)
    return (False)

##
my_mesh = your_mesh.vectors.copy() #shorten the name

voxel = []
for i in range (len(my_mesh)): # go though each triangle and voxelize it
    new_voxel = triangle_voxalize(my_mesh[i])
    for j in new_voxel:
        if j not in voxel: #if the point is new add it to the voxel
            voxel.append(j)

##
print(len(voxel)) #number of points in the voxel

#split in x,y,z points
x_points = []
y_points = []
z_points = []
for a in range (len(voxel)):
    x_points.append(voxel[a][0])
    y_points.append(voxel[a][1])
    z_points.append(voxel[a][2])

## plot the voxel
ax = plt.axes(projection="3d")
ax.scatter3D(x_points, y_points, z_points)
plt.xlabel('x')
plt.ylabel('y')
plt.show()

## plot 1 layer of the voxel
for a in range (len(z_points)):
    if z_points[a] == 300:
        plt.scatter(x_points[a],y_points[a])

plt.show() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-09T23:41:26.910

可以通过[pymadcad实现这一点](https://pymadcad.readthedocs.io/en/latest/guide.html)[PositionMap](https://pymadcad.readthedocs.io/en/latest/reference/hashing.html#madcad.hashing.PositionMap) 类有一个非常优化的方法，可以将点、线和三角形栅格化为体素。

这只是填充网格表面上的体素，而不是填充内部。但是使用这些功能，内部将始终与外部分开；）

这里应该是什么：

```
from madcad.hashing import PositionMap
from madcad.io import read

# load the obj file in a madcad Mesh
mymesh = read('mymesh.obj')
# choose the cell size of the voxel
size = 1

voxel = set()    # this is a sparse voxel
hasher = PositionMap(size)   # ugly object creation, just to use one of its methods
for face in mymesh.faces:
    voxel.update(hasher.keysfor(mymesh.facepoints(face))) 
```

是的，它不是那么漂亮，因为即使这些功能存在，madcad 还没有（还）任何惯用的方式来做到这一点。

## 解释

*   `set`我们使用 a仅存储非零单元格的位置，而不是 3d 布尔数组（存储大部分零的成本非常高且过大）
*   该方法`hasher.keysfor`生成输入基元（此处为三角形）到达的体素单元的所有位置
*   a`set`是一个哈希表，允许非常有效地检查元素是否在内部（例如，可以非常有效地检查单元格是否被原语占用）
*   所以循环只是用图元占据的单元格更新体素，占据的单元格然后是网格表面上的单元格

## 另一种执行寻路的方法

您似乎正在尝试使用一些寻路来找到您在这座建筑物内的最短距离。体素化区域是一个很好的方法。如果您需要尝试，还有另一个：

寻路（如 A* 或 dikstra）通常适用于图。它可以是体素中的连接单元，也可以是任何不规则间隔的单元。

**因此，另一种解决方案是通过生成四面体来对建筑物墙壁之间的**3d 空间进行三角测量。**不是将您的算法从体素单元传播到体素单元，而是从四面体传播到四面体。四面体确实具有从随机网格生成速度更快的优点，而且不需要与区域体积成比例的内存，并且不会丢失任何障碍物精度（四面体具有自适应大小）。**

 **你可以在[这里](https://www.aaai.org/Papers/AAAI/2006/AAAI06-148.pdf)看看它的样子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-17T16:48:58.020

对于任何仍然感兴趣的人，您可以尝试 似乎正是为此目的而制作的[voxeltool 。](https://github.com/arendvw/voxeltools)

从文档：

> 体素工具为 Rhino 提供轻量级体素几何。它允许您从网格、brep、曲线和点快速生成和操作体素化几何体，并提供体素网格之间的布尔运算。它可以将体素网格转换为实体网格外壳。**

# android - 为 opengl \game 将 android 平板电脑上的 fps 提高到 60 以上

> ID：11851343
> 
> 赞同：2
> 
> 时间：2012-08-07T17:47:17.983
> 
> 标签：android, opengl-es, frame-rate

我的问题是：我有一部 android 手机和平板电脑，都运行 android 4.0。在手机上我的游戏以 120 fps 运行，在平板电脑上以 60 运行。我知道更高的分辨率可能是一个因素，但 60 fps 对安卓游戏有好处吗？无论如何要在平板电脑上实现更高的fps？

我已经尝试在我的游戏中使用 AndEngine 和 E3Droid（因为它们分别是 open gl 2.0 和 1.0/1.1），但两者都产生了相同的结果。

有小费吗？也许 60fps 对于安卓游戏来说已经绰绰有余了？我来自 XNA，我通常有超过 100 fps，因此我很担心。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T19:49:07.927

不管什么对游戏有好处，这完全不在你的掌控之中。在许多设备上，渲染速度上限为 60，甚至 30 fps。不用担心，它完全取决于设备！

如果您还没有，请查看在游戏逻辑中实现固定时间步长。[这](http://gafferongames.com/game-physics/fix-your-timestep/)是一篇关于这个主题的精彩博客文章。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:01:35.243

我认为 60 fps 还不错 我玩很多 PC 游戏，如果你的 fps 太多，它会开始撕裂图像，但是当我使用垂直同步化时，帧速率会下降到 60 FPS，并且不会出现撕裂，因此手机和平板电脑使用 60hz屏幕你不应该担心 60 FPS 帧速率实际上它可能使用 vsync。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T18:07:42.657

每秒60帧应该绰绰有余！每秒 30 帧通常被认为是正常且可接受的帧速率。60 fps 可能会产生更好的结果，但你走得越高，你实际上注意到的任何改进就越少。

# javascript - 基于onclick的隐藏，只打开一个

> ID：11851347
> 
> 赞同：0
> 
> 时间：2012-08-07T17:47:47.243
> 
> 标签：javascript, html-table, onclick

我有这个我试图操纵的小 javascript 代码：

```
<script type="text/javascript" language="JavaScript"><!--
function HideContent(d) {
document.getElementById(d).style.display = "none";
}
function ShowContent(d) {
document.getElementById(d).style.display = "block";
}
function ReverseDisplay(d) {
if(document.getElementById(d).style.display == "none") { document.getElementById(d).style.display = "block"; }
else { document.getElementById(d).style.display = "none"; }
}
//--></script> 
```

我试图用它做一个带有多个答案的小问题，并每次点击显示一条消息......

所以我构建了这段代码：

```
<table class="hovertable">
<tr class="hovertable">
<td colspan="4" class="deep">What is the Generic Name of this Medication?</td>
</tr>
<tr onclick="javascript:ReverseDisplay('question1a');">
<td class="age">A.</td><td colspan="3" class="notes" onmouseover="this.style.backgroundColor='#ffba74';" onmouseout="this.style.backgroundColor='#FFFFFF';">
Lovastatin.</td>
</tr>
<tr onclick="javascript:ReverseDisplay('question1b');">
<td class="age">B.</td><td colspan="3" class="notes" onmouseover="this.style.backgroundColor='#ffba74';" onmouseout="this.style.backgroundColor='#FFFFFF';">
Atorvastatin.</td>
</tr>
<tr onclick="javascript:ReverseDisplay('question1c');">
<td class="age">C.</td><td colspan="3" class="notes" onmouseover="this.style.backgroundColor='#ffba74';" onmouseout="this.style.backgroundColor='#FFFFFF';">
Simvastatin.</td>
 </tr>
 <tr onclick="javascript:ReverseDisplay('question1d');">
<td class="age">D.</td><td colspan="3" class="notes" onmouseover="this.style.backgroundColor='#ffba74';" onmouseout="this.style.backgroundColor='#FFFFFF';">
Pravastatin</td>
 </tr>
 </table> 
```

这是显示消息的部分。

```
<div id="question1a" style="display:none;">
<table class="hovertable">
<tr>
<td class="age">Answer</td><td colspan="3" class="notes" onmouseover="this.style.backgroundColor='#ffba74';" onmouseout="this.style.backgroundColor='#FFFFFF';">
This is Correct.</td>
</tr>
</table></div>
<div id="question1b" style="display:none;">
<table class="hovertable">
<tr>
<td class="age">Answer</td><td colspan="3" class="notes" onmouseover="this.style.backgroundColor='#ffba74';" onmouseout="this.style.backgroundColor='#FFFFFF';">
This is Not Correct</td>
</tr>
</table></div>
<div id="question1c" style="display:none;">
<table class="hovertable">
<tr>
<td class="age">Answer</td><td colspan="3" class="notes" onmouseover="this.style.backgroundColor='#ffba74';" onmouseout="this.style.backgroundColor='#FFFFFF';">
This is Not Correct</td>
</tr>
</table></div>
<div id="question1d" style="display:none;">
<table class="hovertable">
<tr>
<td class="age">Answer</td><td colspan="3" class="notes" onmouseover="this.style.backgroundColor='#ffba74';" onmouseout="this.style.backgroundColor='#FFFFFF';">
This is Not Correct</td>
</tr>
</table></div> 
```

我想弄清楚的是如何一次只显示一条消息。因此，在您单击其中一个答案之前，什么都没有，但如果您单击一个，则会显示消息。但是，如果您单击另一个它会消失，并且您单击的那个消息会出现。我希望这不会令人困惑。

谁能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:51:43.763

您最好使用 jQuery 之类的东西进行 DOM 操作。

它会像

```
$("#question1").show().siblings().hide(); 
```

除其他外，请参阅[http://api.jquery.com/siblings/](http://api.jquery.com/siblings/)

# exception-handling - 使用 Wrap Handler 添加额外的异常信息

> ID：11851353
> 
> 赞同：0
> 
> 时间：2012-08-07T17:48:08.497
> 
> 标签：exception-handling, enterprise-library

Enterprise Library 5.0 异常处理包括 Wrap Handler。这将一个异常包装在另一个异常中并抛出包装异常。

我想向我的包装器异常添加其他信息，例如有关在发生错误时生效的参数和设置的一些信息。这对于故障排除很方便（因为这个包装异常将被更高级别的处理程序捕获和记录）。

我正在使用以下代码：

```
ExceptionManager em = EnterpriseLibraryContainer.Current.GetInstance<ExceptionManager>();
em.Process(() => { DoSomething(); }, "WrapPolicy"); 
```

这样做的结果是一个异常，它被包装在我的自定义异常中并被抛出。这是干净和简单的，但由于我的代码从未看到包装异常实例，我无法用其他信息来扩充它。

除了将动作包装在传统的 Try...Catch 中并手动执行 HandleException 方法之外，还有没有办法将额外的信息注入到包装异常实例中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:57:02.440

您可以在配置包装处理程序时提供异常消息。

```
 var builder = new ConfigurationSourceBuilder();

    builder.ConfigureExceptionHandling()
               .GivenPolicyWithName("MyPolicy")
               .ForExceptionType<NullReferenceException>()
                 .WrapWith<InvalidOperationException>()
                   .UsingMessage(messageBasedOnSomeRuntimeInfo)
                 .ThenNotifyRethrow();

    var configSource = new DictionaryConfigurationSource();
    builder.UpdateConfigurationWithReplace(configSource);
    EnterpriseLibraryContainer.Current 
          = EnterpriseLibraryContainer.CreateDefaultContainer(configSource); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T05:26:29.180

我不确定您要添加什么样的附加信息，但如果您想保持 Process 方法的优雅，那么您可以创建一个自定义 WrapHandler ，将适当的信息添加到包装器异常中。一个不错的选择是将附加信息添加到 Exception.Data IDictionary。

如果您正在寻找方法参数，那么可能唯一的方法是创建自己的“上下文”，在其中设置值，然后从上下文中提取它们以添加到包装异常中。

另一种更优雅的方法是使用策略注入。调用处理程序可以访问方法参数以及抛出的异常。您可以修改现有的 ExceptionCallHandler 以将您的信息添加到原始或新异常中。如果您将上下文信息添加到原始异常，则该信息将由异常策略（可能包括日志记录）处理。

# ruby-on-rails - 如何同时查看纯文本和 html 版本的电子邮件？

> ID：11851354
> 
> 赞同：2
> 
> 时间：2012-08-07T17:48:11.877
> 
> 标签：ruby-on-rails, ruby, email, html-email, email-client

我正在开发发送电子邮件的 Ruby on Rails 应用程序的一部分。

我为两种不同的输出格式创建了两个文档——纯文本和 html。

如何调整我的电子邮件客户端（例如 gmail）以显示每种格式 - 两种格式，一个接一个，或者只显示一种格式，但指定哪种格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:00:46.430

在 gmail 中，您可以通过单击回复按钮旁边的小箭头来执行此操作。在箭头打开的菜单中，单击“显示原件”。[来源](http://www.electrictoolbox.com/gmail-view-raw-email-message/)

# c# - 如何使用 LINQ 连接三个数据源？

> ID：11851357
> 
> 赞同：0
> 
> 时间：2012-08-07T17:48:30.073
> 
> 标签：c#, linq

我有以下内容：

```
var questions = questionService.Details(pk, rk);
var topics = contentService.GetTitles("0006000")
                .Where(x => x.RowKey.Substring(2, 2) != "00");
model = (
    from q in questions
    join t in topics on q.RowKey.Substring(0, 4) equals t.RowKey into topics2
    from t in topics2.DefaultIfEmpty()
    select new Question.Grid {
        PartitionKey = q.PartitionKey,
        RowKey = q.RowKey,
        Topic = t == null ? "No matching topic" : t.Title,
        ... 
```

现在我需要添加以下内容：

```
var types = referenceService.Get("07"); 
```

`questions.type`和之间有联系的地方`types.RowKey`

如果类型表中没有任何匹配项，有没有办法可以链接这第三个数据源并让它给出一条消息“没有匹配的类型”？我的问题是我不太确定如何进行下一次加入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:25:50.053

```
 var questions = questionService.Details(pk, rk);
        var topics = contentService.GetTitles("0006000")
                        .Where(x => x.RowKey.Substring(2, 2) != "00");
        var types = referenceService.Get("07");
        model = (from q in questions
            join t in topics on q.RowKey.Substring(0, 4) equals t.RowKey into topics2
            from t in topics2.DefaultIfEmpty())
            select new Question.Grid {
                PartitionKey = q.PartitionKey,
                RowKey = q.RowKey,
                Topic = t == null ? "No matching topic" : t.Title,
                ...
            }).Union
            (from a in types
             join q in questions on q.type equals a.RowKey 
             where a.ID != null
             select new Question.Grid {
                    PartitionKey = q.PartitionKey,
                    RowKey = q.RowKey,
                    Topic = t == null ? "No matching topic" : t.Title,
                    ...
            }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T20:39:25.547

我相信您可以将第一次连接的结果与第三个数据源连接起来：

```
var questions = questionService.Details(pk, rk);
var topics = contentService.GetTitles("0006000")
                .Where(x => x.RowKey.Substring(2, 2) != "00");
var  types = referenceService.Get("07");

model = (
    from q in questions
    join t in topics on q.RowKey.Substring(0, 4) equals t.RowKey into topics2
    from t in topics2.DefaultIfEmpty()
    join type in types on q.type equals type.RowKey into types2
    from type in types2.DefaultIfEmpty()
    select new Question.Grid {
        PartitionKey = q.PartitionKey,
        RowKey = q.RowKey,
        Topic = t == null ? "No matching topic" : t.Title,
        Type = type == null ? "No matching type" : type.Title,
        ... 
```

# css - 允许广告屏蔽插件为访问者屏蔽整个 div，以使网站看起来不完整？

> ID：11851364
> 
> 赞同：1
> 
> 时间：2012-08-07T17:49:10.790
> 
> 标签：css, html, ads, adblock

这听起来适得其反，但事实并非如此：我有一个只包含广告的 div 元素 - 这基本上只是给广告一些填充并用漂亮的边框/框包围它。

我知道我的潜在用户中有一定比例会使用 adblock，所以当他们访问该网站时，他们会看到主要内容和其下方看似毫无意义的奇怪拉长 div。是否有此类广告拦截器在 div 中查找的任何关键字，我可以使用这些关键字来确保如果广告被阻止，整个 div 是不可见的？

如果没有，也许有一种方法可以显示一条消息，让广告拦截者知道 div 通常是做什么用的？我正在避免这种情况，因为它似乎有点被动攻击性，如果用户想要屏蔽广告，他们应该拥有与大多数用户一样好的体验。

感谢您的任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:53:19.720

可以使用 JS 来测试广告容器的高度。如果它是折叠的（正如您所期望的，如果其中没有广告），那么您可以隐藏它。

所以用开发者工具看看有广告的容器的高度，没有广告的高度。在 JS 中，如果高度与“无广告”相同，则您知道广告拦截器处于活动状态。

[如何阻止 Adblock](http://thepcspy.com/read/how_to_block_adblock/)有关于此的更多信息。您可能不想阻止它，但想法是一样的。

# knockout.js - 淘汰映射示例不适用于 IE9

> ID：11851366
> 
> 赞同：0
> 
> 时间：2012-08-07T17:49:15.233
> 
> 标签：knockout.js, internet-explorer-9, knockout-mapping-plugin

这是 jsfiddle 上一个相当基本的淘汰映射示例。几乎适用于除 IE9 以外的所有浏览器。有人知道为什么吗？谢谢。

[http://jsfiddle.net/KXhem/16/](http://jsfiddle.net/KXhem/16/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:10:49.393

看起来脚本没有在 IE9 上加载：

由于 mime 类型不匹配，来自[https://raw.github.com/SteveSanderson/knockout.mapping/master/build/output/knockout.mapping-latest.debug.js](https://raw.github.com/SteveSanderson/knockout.mapping/master/build/output/knockout.mapping-latest.debug.js)的脚本被阻止

您能否将文件链接到不同于 github 的另一台服务器中，将“text/javascript”指定为 mime 类型。或尝试链接不是调试版本：请参阅此讨论：[https ://github.com/SteveSanderson/knockout/issues/585](https://github.com/SteveSanderson/knockout/issues/585)

原始文件未使用来自 Github 的正确 mime 类型提供，因为它们可能不打算成为内容的服务器。

# heroku - Padrino - 将 heroku 的 RACK_ENV 更改为暂存崩溃应用程序

> ID：11851370
> 
> 赞同：0
> 
> 时间：2012-08-07T17:49:38.060
> 
> 标签：heroku, staging, padrino

我在heroku上有一个登台应用程序。如果我将 RACK_ENV 设置为生产，该应用程序可以工作，但如果我将其设置为暂存应用程序崩溃（错误 H10（应用程序崩溃）） - 这就是我得到的所有信息......

我的应用程序是 Padrino 应用程序，我正在使用 RACK_ENV 设置一些内容，例如在电子邮件中使用的基本 url 等。我在我的代码中搜索了 RACK_ENV，看起来一切都根据不同的可能设置正确价值观。

我在日志中看到它说“找不到：staging 的日志配置，回退到：production” - 我不知道这是否与问题有关，因为该消息不在失败消息附近。

有谁知道可能会发生什么？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:58:04.837

没错，您需要使用新环境更新配置。我的生产环境有问题，所以我添加了这个：

```
# config/database.rb
postgres = URI.parse(ENV['DATABASE_URL'] || '')

ActiveRecord::Base.configurations[:production] = {
  :adapter  => 'postgresql',
  :encoding => 'utf8',
  :database => postgres.path[1..-1], 
  :username => postgres.user,
  :password => postgres.password,
  :host     => postgres.host
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:54:26.077

好的......我收回了 - 结果我错过了我的一个数据库配置......失败了！

# java - 我想知道（带有示例！）是否有一种方法可以搜索列表（不是文件），如果找到替换它

> ID：11851373
> 
> 赞同：-1
> 
> 时间：2012-08-07T17:50:02.617
> 
> 标签：java

我想知道（通过示例！）是否有办法搜索列表（不是文件），如果找到替换它。

背景：制作服务器，但我希望它能够审查脏话，而我拥有的系统运行起来效率不够。

当前代码：

```
 String impmessage = message.replaceAll("swearword1", "f***");
     String impmessage2 = impmessage.replaceAll("swearword2", "bi***");
     String impmessage3 = impmessage2.replaceAll("swearword3", "b***");
     String impmessage4 = impmessage3.replaceAll("swearword4", "w***");
     ...
     String impmessage8 = impmessage7.replace('%', '&'); 
```

整个沙浜。但是当我想在过滤器中添加一个新词时，我必须在那里添加另一个词。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:58:46.940

您的基本解决方案如下：

```
Map<String, String> mapping = new HashMap();
mapping.put("frak","f***");

String censoredMsg = message;
for (String word : mapping.KeySet()) {
  censoredMsg = censoredMsg.replaceAll(word, mapping.get(word));
} 
```

如何创建映射取决于您。这是另一个更全面的解决方案，包括从随机文件中提取：

```
public class TheMan {
  private Set<String> uglyWords;

  public TheMan() {
    getBlacklist();
  }

  private void getBlacklist() {
    Scanner scanner = new Scanner(new File("wordsidontlike.txt"));
    while (scanner.hasNext()) {
      String word = scanner.nextLine();
      uglyWords.add(word);
    }
  }

  public String censorMessage(String message) {
    String censoredMsg = message;
    for (String word : uglyWords) {
      String replacement = word.charAt(0);
      StringUtils.rightPad(replacement, word.length(), '*');
      censoredMsg = censoredMsg.replaceAll(word, replacement);
    }
    return censoredMsg;
  }
} 
```

# tomcat - 在 Apache Tomcat 中使用 Log4j 进行 Mule 日志记录

> ID：11851375
> 
> 赞同：0
> 
> 时间：2012-08-07T17:50:09.657
> 
> 标签：tomcat, logging, log4j, mule

我在 Apache Tomcat 中运行 Mule 并使用 Log4j 进行日志记录。但我无法将每个应用程序记录到不同的文件中。我知道当 Mule 以独立模式运行时可以完成。在这种情况下是否可以为每个应用程序创建一个日志文件？

这是我使用的 log4j.xml 配置：

```
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/" debug="false">
        <appender name="CONSOLE" class="org.apache.log4j.ConsoleAppender">
                <layout class="org.apache.log4j.PatternLayout">
                     <param name="ConversionPattern"
                        value="[%d{dd-MM-yyyy hh:mm:ss:sss}] %5p %c{2}: %m%n" />
                </layout>
        </appender>

        <appender name="ASYNC" class="org.apache.log4j.AsyncAppender">
                <appender-ref ref="FILE"/>
        </appender>

        <appender name="FILE" class="org.apache.log4j.RollingFileAppender">
                <param name="File" value="${catalina.base}/logs/MYAPP.log"/>
                <param name="MaxFileSize" value="100MB"/>
                <param name="MaxBackupIndex" value="100"/>
                <layout class="org.apache.log4j.PatternLayout">
                     <param name="ConversionPattern"
                        value="[%d{dd-MM-yyyy hh:mm:ss:sss}] %5p %c{2}: %m%n"/>
                </layout>
        </appender>

        <root>
                <priority value="INFO"/>
                <appender-ref ref="CONSOLE"/>
                <appender-ref ref="ASYNC"/>                
        </root>
</log4j:configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T09:28:47.930

每个应用程序的 OOTB 日志记录功能是仅由 mule Standaone 提供的功能之一（如此[处](http://www.mulesoft.org/documentation/display/MULE3USER/Logging+With+Mule+ESB+3.x)所述）

话虽如此，您可以利用 log4j 配置来实现类似的结果。为此，您必须将自定义 log4.properties（或 log4.xml）文件添加到使用[FileAppender](http://wiki.apache.org/logging-log4j/FileAppender)的 webapp并根据您的需要进行配置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-10T08:38:27.680

在您的示例中，您只声明了一个附加程序“文件”。

当您运行多个应用程序时，您可以声明附加的附加程序，以根据包名称显示信息。您仍然会在主日志文件中保留一些信息，这些信息与 org.mule... 包中的错误有关。我想这就是你所做的。

# javascript - jQuery淡入淡出/动画不透明度到不同的显示类型然后阻止

> ID：11851377
> 
> 赞同：0
> 
> 时间：2012-08-07T17:50:23.770
> 
> 标签：javascript, jquery, html, css

我有几个 div 我垂直对齐`display: table`并`display: table-cell`用于内部。`fadeTo()`无论如何，问题是，当我通过或使用 jQuery 为不透明度设置动画时`fadeIn`，它总是添加`display: block`内联。如何防止显示类型在不透明动画期间和之后发生变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:51:49.167

没关系，看来我可以添加`.fadeTo(300, 1.0).css('display', 'table-row')`，这解决了问题

# ios - 在 iOS 中删除内存映射文件 - 幕后发生了什么？

> ID：11851380
> 
> 赞同：5
> 
> 时间：2012-08-07T17:50:30.010
> 
> 标签：ios, nsdata, memory-mapped-files

我有一个文件，我用 NSData 进行内存映射。然后我通过 NSFileManager 删除此文件而没有任何错误，并继续检查该文件是否确实不存在（就 NSFileManager 和 ls 而言）。但是，我仍然可以从之前从 NSData 获得的字节指针读取数据！

在模拟器中，我有时会遇到看似无关的崩溃。在设备上，一切似乎都运行良好。我很想知道发生了什么，以及我应该期待什么（我过去的预期是在尝试删除文件时出现错误，或者在删除文件后尝试访问它时崩溃）。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T18:16:28.157

如果您没有取消映射内存，那么您使用文件指针创建的 mmap 会阻止文件被删除（即使您看不到它）。在删除引用的文件之前，您应该始终取消映射内存。

[这与一个古老的 UNIX 技巧有关——打开一个文件，一旦你有一个文件描述符然后取消链接该文件——你有一个文件你可以用它做事但没有人能看到，如果你崩溃文件完全消失了！]

# html - 如何删除从网络上看不到的文件？

> ID：11851381
> 
> 赞同：0
> 
> 时间：2012-08-07T17:50:31.237
> 
> 标签：html, web-applications

几天前，我开始在一个巨大的网站上工作，该网站是在我之前作为静态网站开发的。

它是使用dreamweaver 及其模板系统制作的，但最终都是静态的html+css。

我想在使用 CVS 之前清理网站，所以我打算删除无法从外部链接访问的文件。这包括未链接的 html、未使用的 css 文件、未使用的图像、javascript 和 pdf，可能还有一些 .exe 或 .ppt/.pps。

有什么方法可以检查哪些文件没有被使用？（即未链接）

编辑：这个网站很大，大约 10.000 个文件中的 10Gib。显然，其中三分之一没有被使用。因此，解决方案将是自动或半自动工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:57:49.057

我确信有更好的方法，但我曾经使用过 IIS SEO（搜索引擎优化）实用程序并删除了报告中没有出现的文件。如果您需要，它还提供其他有用的信息。

[搜索引擎优化工具包](http://www.iis.net/download/seotoolkit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:57:37.740

获得一个好的 HTML 编辑器，它具有查找/替换功能，可以搜索指定目录中的所有文件。Notepad++ 很好地满足了这些要求。

然后为文件名运行 Find-In-Files（在 NOtepad++ 中，即 ctr+shift+f）命令。小心，有时 href 不指定目录（例如，它是从同级页面链接的），有时会指定根目录的部分或全部路径。所以只能按文件名搜索。如果没有结果，则没有链接。如果有结果，但其他目录中的其他文件具有相同的文件名，则需要仔细检查。

# mysql - mySQL 查询优化（LEFT JOIN & SUBQUERY）

> ID：11851383
> 
> 赞同：0
> 
> 时间：2012-08-07T17:50:34.597
> 
> 标签：mysql, optimization, join, subquery

```
SELECT table1.waypoint,table1.latitude,
       table1.longitude,table1.airway
FROM 
  airways table1
JOIN 
   (SELECT * FROM airways
    WHERE waypoint='KORED') AS table2
  ON table1.airway = table2.airway 
WHERE table1.sequence=table2.sequence+1 
   OR table1.sequence=table2.sequence-1 
```

你好，

我正在尝试优化上述查询。目前查询时间相当长（大约 0.9 秒）。我只使用一个表（约 100k 个条目），将其与自身连接。IN 语法在我的 Synology MYSQL 5.1 中不起作用。（不知何故使它崩溃使用`SELECT s1 FROM t1 WHERE s1 IN (SELECT s1 FROM t2);`查询时间大约为 0.2 秒，而不使用其中的 WHERE 部分。我已经在`sequence`和上索引了表`waypoint`。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:47:53.543

不确定这是否会像我将这些字段实际添加到表本身并对其进行索引的建议一样有帮助，但您可以尝试将数学从 where 移到 select 中：

```
SELECT table1.waypoint,table1.latitude,
       table1.longitude,table1.airway
FROM 
  airways table1
JOIN 
   (SELECT *,sequence + 1 as sequence_inc, sequence - 1 as sequence_dec FROM airways
    WHERE waypoint='KORED') AS table2
  ON table1.airway = table2.airway 
WHERE table1.sequence=table2.sequence_inc
   OR table1.sequence=table2.sequence_dec 
```

**编辑** 好的，所以这无济于事，但根据您的解释，我认为真正的问题是您用来加入的气道表的气道字段缺少索引。添加该索引并查看是否可以提高您的性能。

# gradle - pmd gradle 基本配置

> ID：11851384
> 
> 赞同：4
> 
> 时间：2012-08-07T17:50:35.960
> 
> 标签：gradle, pmd

我想在我的 gradle 构建中添加一个 PMD 任务，这会给我一个 csv 格式的 pmd 报告。我发现 pmd gradle 文档太微妙了，无法弄清楚如何实现这一点。有人可以发布一个简单的例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T21:25:55.543

想通了：

```
task pmd << {
    println 'Running PMD static code analysis'
    ant {
        taskdef(name:'pmd', classname:'net.sourceforge.pmd.ant.PMDTask', classpath: configurations.pmdConf.asPath)

        pmd(shortFilenames:'true', failonruleviolation:'true', rulesetfiles:'conf/pmd-rules.xml') {
            formatter(type:'csv', tofile:'myreport.csv', toConsole:'true')
            fileset(dir: "src/main/java") {
                include(name: '**/*.java')
            }
            fileset(dir: "src/test/java") {
                include(name: '**/*.java')
            }        
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T23:51:24.870

Gradle [PMD 插件](http://www.gradle.org/docs/current/userguide/pmd_plugin.html)，我相信只会创建 XML 和 HTML 报告。您可以查看 DSL 参考以获取有关[PMD 任务](http://www.gradle.org/docs/current/dsl/org.gradle.api.plugins.quality.Pmd.html#org.gradle.api.plugins.quality.Pmd%3areports)的更多信息。

# css - 如何显示前 3 个列表项并使用 CSS nth-child 隐藏其余项？

> ID：11851395
> 
> 赞同：44
> 
> 时间：2012-08-07T17:51:48.710
> 
> 标签：css, css-selectors

是否可以使用 CSS 选择器选择多个超过定义数字的子级？

我想隐藏 #3 之后的所有列表项：

```
<ul>
  <li>1</li>
  <li>2</li>
  <li>3</li>
  <li>4</li> <!-- hide this -->
  <li>5</li> <!-- hide this -->
</ul>

<style>
  ul li:nth-child(X) {
    display: none;
  }
</style>
```

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-08-07T17:56:14.847

我不知道哪个浏览器支持这个，但你可以将一个公式传递给:nth-of-type()：

```
ul li:nth-of-type(1n+4) {display: none;} /* should match your case */ 
```

更多详情：[http ://www.w3schools.com/cssref/sel_nth-of-type.asp](http://www.w3schools.com/cssref/sel_nth-of-type.asp)

**编辑**

我将它从 (n+4) 更改为 (1n+4)，因为第一个版本有效但无效。我在媒体查询中使用它来隐藏较小屏幕上的缩减项目。

* * *

## 例子：

```
b:nth-of-type(1n+4){ opacity:.3; }
```

```
<b>1</b>
<b>2</b>
<b>3</b>
<b>4</b>
<b>5</b>
```

# python - 使用 git 跟踪对保管箱的更改？

> ID：11851402
> 
> 赞同：10
> 
> 时间：2012-08-07T17:52:28.507
> 
> 标签：python, git, version-control, dropbox

> 跳到 TLDR 的底部。

**问题：**

在我们的环境中，每个人都使用 Dropbox 来协作开发一个大型编码项目。它解决了每个人都及时了解其他人所做更改的问题，并且还提供了一些关于“谁更改了什么，何时更改”的简单版本控制。

Dropbox 没有提供的，这正是我正在寻找的，是 Git 的很棒的酱汁，就版本控制、责任、内容差异等而言

**我现在正在使用的内容：**

我仍在使用 Dropbox 作为我们的“版本控制”，因为其他“开发人员”可能无法弄清楚 git，*我知道这很容易，但他们讨厌更改*。

为了让我看到“真正发生了什么，谁在做”，我正在使用 Git跟踪该*项目的整个 Dropbox 文件夹。*

我必须每隔一段时间*代表其他开发*人员手动提交一次，以跟踪 Git 令人敬畏的酱汁发生了什么。

**我在找什么：**

有人对我所处的环境有经验吗？我想在 Dropbox 中找到可以注意到更改的内容，使用 Dropbox 的 API 提取进行更改的用户名，然后将更改自动提交到 git。

我还没有找到任何这样的解决方案，并且已经开始用 Python 编写一个应用程序来做我想做的事情，*我可能不得不在 github 上托管它并寻求帮助*，空闲时间很少，而且对 Python 来说相对较新。

我能够从 Dropbox API 中提取 RSS 提要并解析出文件是什么以及谁更改了它，但还不足以将其挂接到 Git Commit 中，*应该是微不足道*的。我只是不想重新发明任何轮子。

> **TLDR：**
> 
> 我想自动跟踪 Dropbox 文件夹中发生的更改，并让它们 Git 提交，包括更改 Dropbox 中文件的人的姓名、使用 Dropbox 的 API 或类似的。可能使用 Python，但欢迎使用任何东西。

**提前致谢。**

Git Repo，以防您想提供帮助！ [https://github.com/haqthat/git-drop](https://github.com/haqthat/git-drop)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:32:47.323

老实说，您的团队需要一周的 git 练习，然后将受益于更强大的工作流程。不要尝试自动化提交。那就是通往地狱的道路。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T18:04:55.557

如果您可以在 linux 上托管它，那么使用[iwatch](http://iwatch.sourceforge.net/index.html)怎么样？每当通过保管箱同步更新保管箱文件夹中的文件时，iwatch 可以在碰巧拉动用户时运行 python 脚本。然后使用[envoy](https://github.com/kennethreitz/envoy/)运行两个 git 命令，`git add 'filename'`然后`git commit -m "autocommit by system for user X changes"`.

当然它不是很漂亮，但它会完成这项工作，除非有更新，否则它不会运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T18:17:17.253

[我按照http://tumblr.intranation.com/post/766290743/using-dropbox-git-repository](http://tumblr.intranation.com/post/766290743/using-dropbox-git-repository)的内容将 dropbox 用作 git repo

因此，我能想到的最简单的方法是：

1）在您的保管箱文件夹中**初始化一个回购**（这将在您与之共享的每个人之间自动同步）

2)使用 github 上的遥控器或您自己的 git 服务器（如果有）**对其进行配置。**这样，跨文件和用户的所有更改都将在远程进行跟踪。

3) 将脚本编写为 cron 作业，定期从本地保管箱提交，然后针对**远程 git 服务器**运行并**查找 deltas 和 revisions**。您可以从这里开始的 Dropbox API 参考中获得它 - [https://www.dropbox.com/developers/reference/api#revisions](https://www.dropbox.com/developers/reference/api#revisions)

4) 完成上述操作后，您可能希望包含对[https://www.dropbox.com/developers/reference/api#metadata](https://www.dropbox.com/developers/reference/api#metadata)的调用，该调用根据 dropbox 返回可用于跟踪更改的哈希，然后调用您的轮询脚本。到目前为止，除了每隔几分钟轮询一次遥控器之外，Dropbox 似乎没有办法通知您更改。

```
hash Each call to /metadata on a folder will return a hash field, generated by hashing all of the metadata contained in that response. On later calls to /metadata, you should provide that value via this parameter so that if nothing has changed, the response will be a 304 (Not Modified) status code instead of the full, potentially very large, folder listing. This parameter is ignored if the specified path is associated with a file or if list=false. A folder shared between two users will have the same hash for each user. 
```

# java - 将两位数格式的整数保存在Java中的变量中

> ID：11851403
> 
> 赞同：25
> 
> 时间：2012-08-07T17:52:31.000
> 
> 标签：java, numbers

如何在 Java 中以两位数格式存储整数？我可以设置吗

```
int a=01; 
```

并将其打印为`01`? `int b=a;`此外，如果我说，不仅打印，`b`还应该将其值打印为`01`.

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-08-07T18:42:32.877

我想这就是你要找的：

```
int a = 1;
DecimalFormat formatter = new DecimalFormat("00");
String aFormatted = formatter.format(a);

System.out.println(aFormatted); 
```

或者，更简单地说：

```
int a = 1;
System.out.println(new DecimalFormat("00").format(a)); 
```

int 只存储一个数量，01 和 1 代表相同的数量，因此它们的存储方式相同。

[DecimalFormat](http://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html)构建一个以特定格式表示数量的字符串。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-09-28T13:23:22.490

```
// below, %02d says to java that I want my integer to be formatted as a 2 digit representation
String temp = String.format("%02d", yourIntValue);
// and if you want to do the reverse
int i = Integer.parse(temp);

// 2 -> 02 (for example) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-07T17:57:19.870

这是不可能的，因为整数就是整数。但是您可以根据需要格式化整数（[DecimalFormat](http://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html)）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-08-13T04:43:20.530

看看下面的格式它上面的格式可以为我工作

System.out.printf("%02d", myNumber)

# db2 - WSO2 数据服务服务器 DS 通信错误

> ID：11851404
> 
> 赞同：0
> 
> 时间：2012-08-07T17:52:32.287
> 
> 标签：db2, wso2, datasource, wso2carbon, wso2dss

从昨天开始，我一直面临 WSO2 数据服务服务器中的 DB2 数据源问题。每天晚上我都有一个计划 shell 脚本脚本，它在数据库中进行维护，但是在某些时候我必须删除 DB2 上的所有连接，然后我希望 WSO2 必须再次绑定连接池，但是完成后我得到了这个错误：

> 嵌套异常：- com.ibm.db2.jcc.c.DisconnectException：[ibm][db2][jcc][t4][2030][11211] 检测到通信错误。使用的通信协议：TCP/IP。正在使用的通信 API：SOCKETS。检测到错误的位置：T4Agent.sendRequest()。检测错误的通信函数：OutputStream.flush()。协议特定错误代码 Broken pipe, *, 0\. Message: Broken pipe
> 
> 原因：javax.xml.stream.XMLStreamException：DS 错误消息：“SQLQuery.processNormalQuery”中的错误

连接断开后我是否错误地期望或自然会出现此错误？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T09:01:07.877

是的，您得到的错误是可以预料的，因为当 DB2 丢弃连接时，连接池中的数据库连接变得无效。所以第一个去数据服务的请求会失败。要处理此问题，请使用数据源中的“validationQuery”选项来解决此问题。您可以使用“从 sysibm.sysdummy1 中选择 1”之类的查询作为验证查询，每次使用连接池中的连接之前都会调用该查询。

干杯，安佳娜。

# sql - 违反 UNIQUE KEY 约束“UK_XXX”。无法在对象“dbo.YYY”中插入重复键

> ID：11851405
> 
> 赞同：1
> 
> 时间：2012-08-07T17:52:33.277
> 
> 标签：sql, sql-server-2005

我正在尝试将 SQL Server 2005 中的一个字段从一个表更新到另一个表中的另一个字段，并且我完全违反了 UNIQUE KEY 约束，我似乎无法弄清楚我的脚本哪里出了问题. 这是我到目前为止所拥有的：

```
UPDATE table1
SET column1 = (SELECT table2.column2
FROM         table2 INNER JOIN
                  table1 ON table1.id = table2.id) 
```

我对 SQL 很陌生，并且肯定会喜欢有关这种情况的一些输入。非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:55:01.450

这种语法看起来更简洁一些，但您需要验证 table2.column2 中的值是否唯一。

```
UPDATE t1 
  SET column1 = t2.column2
    FROM dbo.table1 AS t1
    INNER JOIN dbo.table2 AS t2
    ON t1.id = t2.id; 
```

假设 table1.column1 具有唯一约束，并且该 id 是每个表中的主键，您可以先检查潜在的违规行为。这将告诉您源表的 column2 中是否存在欺骗：

```
SELECT column2
  FROM dbo.table2
  WHERE id IN (SELECT id FROM dbo.table1)
  GROUP BY column2
  HAVING COUNT(column2) > 1; 
```

这将告诉您 table2 中是否存在与两个表之间不常见的*其他行冲突的单个值：*

```
SELECT t2.column2
  FROM dbo.table2 AS t2
  WHERE EXISTS (SELECT 1 FROM dbo.table1 AS t1
    WHERE t1.column1 = t2.column2
    AND t2.id <> t1.id); 
```

# mysql - 如何在 innodb 表中合并 2 行

> ID：11851408
> 
> 赞同：0
> 
> 时间：2012-08-07T17:52:42.513
> 
> 标签：mysql, sql, merge, duplicates, innodb

我已经接管了使用 mysql innodb 数据库的 Web 应用程序的开发。客户端意外在数据库中有很多重复记录。我正在构建一个合并工具来保留一条记录并将另一条的关联数据推送到它。

因此，例如，由于拼写错误，我可能有。

```
entity_id    entity_cat    common_name
--------------------------------------
abcdefg      customer      John Doe
hijklmn      customer      Jon Doe 
```

然后我有一堆链接到 entity_id 的表。我想删除“hijklmn”，并让其他表中的所有关联数据将它们的“customer_entity_id”更改为“abcdef”。

问题是，所有关系都具有删除级联。我有什么办法可以合并这两条记录而不会丢失任何数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:55:24.063

关于您的`ON DELETE CASCADE`问题，您可以使用以下脚本模板暂时禁用所有外键约束以进行查询：

```
ALTER TABLE `entities` NOCHECK CONSTRAINT ALL

-- commit query here

ALTER TABLE `entities` CHECK CONSTRAINT ALL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:56:11.860

如果在删除之前更新所有记录，则根本不应该有任何级联：

```
update other_table_1 set entity_id='abcdefg' where entity_id='hijklmn';
update other_table_2 set entity_id='abcdefg' where entity_id='hijklmn';
update other_table_3 set entity_id='abcdefg' where entity_id='hijklmn';
...
delete from user_table where entity_id='abcdefg' 
```

# c++ - wxListBox - 分段错误

> ID：11851413
> 
> 赞同：0
> 
> 时间：2012-08-07T17:52:51.540
> 
> 标签：c++, linux, segmentation-fault, wxwidgets

几个小时以来，我一直在尝试从*wxWidgets*学习如何使用**wxListBox**。我的“应用程序”基于官方[教程](http://zetcode.com/tutorials/wxwidgetstutorial/widgetsII/)，但即使我的代码与原始代码没有什么不同，我也无法让它工作。

 *我想向 wxListBox 添加一个新项目，但我得到**Segmentation fault**。这是我的代码：

```
class CWindow : public wxFrame {
    wxBoxSizer      *hbox, *vbox;
    wxListBox           *list;
    wxButton            *btnAdd, *btnRemove;

public:
    CWindow(int w = 640, int h = 480) : wxFrame(NULL, -1, wxT("Test"), wxDefaultPosition, wxSize(w, h)) {
        list = new wxListBox(this, wxID_ANY, wxDefaultPosition, wxSize(w-100, h));
        btnAdd = new wxButton(this, -1, wxT("Add"));
        btnAdd->Connect(wxEVT_COMMAND_BUTTON_CLICKED, (wxObjectEventFunction) &CWindow::OnNew);
        btnRemove = new wxButton(this, -1, wxT("Remove"));

        vbox = new wxBoxSizer(wxVERTICAL);
        vbox->Add(btnAdd, 1, wxALL | wxEXPAND, 0);
        vbox->Add(btnRemove, 1, 0, 0);

        hbox = new wxBoxSizer(wxHORIZONTAL);
        hbox->Add(list, 1, 0, 0);
        hbox->Add(vbox, 0, 0, 0);

        SetSizer(hbox);
    }

    void OnNew(wxCommandEvent &event) {
        wxString str = wxGetTextFromUser(wxT("New item:"));
        if (str.Len() > 0) list->InsertItems(1, &str, 0); //this line is suspected of causing segfault
    }
}; 
```

任何想法是什么导致我的问题？

PS。教程示例工作得很好，所以库错误是不可能的。

编辑： *gdb*调试器报告这个：

```
0x00007ffff7a8e492 in wxListBoxBase::InsertItems(unsigned int, wxString const*, unsigned int) () from /usr/lib/x86_64-linux-gnu/libwx_gtk2u_core-2.8.so.0 
```

EDIT2：更多*gdb*转储之前：

```
 Breakpoint 1, CWindow::OnNew (this=0x725cd0, event=...) at listbox.cpp:32
    32 if (str.Len() > 0) list->InsertItems(1, &str, 0);
(gdb) print list
    warning: can't find linker symbol for virtual table for `CWindow' value
    $1 = (wxListBox *) 0x0
(gdb) up
    #1  0x00007ffff7586d35 in wxEvtHandler::ProcessEventIfMatches(wxEventTableEntryBase         const&, wxEvtHandler*, wxEvent&) ()
    from /usr/lib/x86_64-linux-gnu/libwx_baseu-2.8.so.0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:12:36.480

从您发布的调试输出来看，您的问题不在于使用列表框，而在于使用 wxFrame。我猜你在你的 wxApp 实例中搞砸了 wxFrame 的处理。

我建议您重新开始，从最小的示例开始，然后从那里逐步构建您的应用程序。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-08T12:23:13.237

感谢许多建议，我能够成功地解决这个问题。它是由直接将按钮连接到功能引起的。似乎每个按钮*都必须有一个对应的*标识符。

所以这是错误的：

```
button = new wxButton(this, wxID_ANY, wxT("label"));
(...)
button->Connect(wxEVT_COMMAND_BUTTON_CLICKED, (wxObjectEventFunction) &CWindow::OnClick); 
```

这很好：

```
button = new wxButton(this, EVT_OnClick, wxT("label"));
(...)
Connect(EVT_OnClick, wxEVT_COMMAND_BUTTON_CLICKED, (wxObjectEventFunction) &CWindow::OnClick); 
```*

# version-control - 如何撤消 git svn dcommit？

> ID：11851423
> 
> 赞同：7
> 
> 时间：2012-08-07T17:53:41.673
> 
> 标签：version-control, git-svn

我在 a 中犯了一个错误，`git svn dcommit`并想撤消提交。（我实际上是想推到一个分支，但推到了主干。）我怎么能用 git-svn 做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-17T16:15:11.800

Subversion 没有提供像 Git 那样*撤销*提交的方法。最近我了解到，使用 TortoiseSVN 可以追溯修改 Subversion 提交消息，但 Subversion 提交本身或多或少是最终的。

所以你需要的是一个新的提交，它使用 你在评论中已经指出`git revert <commit_hash>`的那样来恢复你的更改。`git svn dcommit`

不幸的是，这无助于避免修改后的文件与其他人发生冲突，即使这两个提交实际上什么都不做。

# php - 在表单字段旁边显示表单失败

> ID：11851429
> 
> 赞同：-2
> 
> 时间：2012-08-07T17:53:56.047
> 
> 标签：php, forms, field, messages

这是[由 TonyMancini 组建的](https://stackoverflow.com/questions/11850019/why-does-the-php-not-work-for-my-form)，但我现在需要帮助。表单确实验证了，但是，它出现了一个新页面，看起来像

您提交的内容有 57 个错误，请更正。

请输入您的名字

您提交的内容有 57 个错误，请更正。

请输入您的姓氏

您提交的内容有 57 个错误，请更正。

请输入您的 9 位社会保险号

您提交的内容有 57 个错误，请更正。

请输入您的电话号码

您提交的内容有 57 个错误，请更正。

请输入您的地址

您提交的内容有 57 个错误，请更正。

请输入您的城市

等等

是否可以在我的表单字段旁边显示错误？或不？

```
<?php
// Create a dynamic array for the error messages and validate everything before sending them back to the form that shows them
// Here is a sample of your code with the dynamic array built in

$error_msgs = array ();
$error = 0; //Error flag

if ($_POST['first_name']){
$first_name = $_POST['first_name'];
} else {
$error_msgs[] = "Please enter your first name";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['last_name']){
$last_name = $_POST['last_name'];
} else {
$error_msgs[] = "Please enter your last name";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['ssn']){
$ssn = $_POST['ssn'];
} else {
$error_msgs[] = "Please enter your 9 digit social security number";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['phone']){
$phone = $_POST['phone'];
} else {
$error_msgs[] = "Please enter your phone number";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['address']){
$address = $_POST['address'];
} else {
$error_msgs[] = "Please enter your address";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['city']){
$city = $_POST['city'];
} else {
$error_msgs[] = "Please enter your city";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['state']){
$state = $_POST['state'];
} else {
$error_msgs[] = "Please select your state";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['zip']){
$zip = $_POST['zip'];
} else {
$error_msgs[] = "Please enter your 5 digit zip code";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['position']){
$position = $_POST['position'];
} else {
$error_msgs[] = "Please enter position desired, or type N/A if open for discussion";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['wage']){
$wage = $_POST['wage'];
} else {
$error_msgs[] = "Please enter 0.00 if open for discussion";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['Emergencycontactname']){
$Emergencycontactname = $_POST['Emergencycontactname'];
} else {
 $error_msgs[] = "Please enter your emergency contact's name";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['Emergencycontactaddress']){
$Emergencycontactaddress = $_POST['Emergencycontactaddress'];
} else {
 $error_msgs[] = "Please enter your emergency contact's address";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['Emergencycontactcity']){
$Emergencycontactcity = $_POST['Emergencycontactcity'];
} else {
 $error_msgs[] = "Please enter your emergency contact's city";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['Emergencycontactstate']){
$Emergencycontactstate = $_POST['Emergencycontactstate'];
} else {
 $error_msgs[] = "Please select your emergency contact's state";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['Emergencycontactzip']){
$Emergencycontactzip = $_POST['Emergencycontactzip'];
} else {
 $error_msgs[] = "Please enter your emergency contact's 5 digit zip code";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['Emergencycontactphone']){
$Emergencycontactphone = $_POST['Emergencycontactphone'];
} else {
 $error_msgs[] = "Please enter your emergency contact's phone number";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['highest']){
$highest = $_POST['highest'];
} else {
 $error_msgs[] = "Please enter your highest level of education";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['degree']){
$degree = $_POST['degree'];
} else {
 $error_msgs[] = "Please enter N/A if none";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['age']){
$age = $_POST['age'];
} else {
 $error_msgs[] = "Please enter yes or no";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['problems']){
$problems = $_POST['problems'];
} else {
 $error_msgs[] = "Please enter yes or no";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['shiftwork']){
$shiftwork = $_POST['shiftwork'];
} else {
 $error_msgs[] = "Please enter yes or no";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['apprenticeship']){
$apprenticeship = $_POST['apprenticeship'];
} else {
 $error_msgs[] = "Please enter yes or no";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['disabilities']){
$disabilities = $_POST['disabilities'];
} else {
 $error_msgs[] = "Please enter yes or no";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['ifyes']){
$ifyes = $_POST['ifyes'];
} else {
 $error_msgs[] = "If you answered no to above question, type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['accommodate']){
$accommodate = $_POST['accommodate'];
} else {
 $error_msgs[] = "Type N/A if you answered N/A for above question";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['experience']){
$experience = $_POST['experience'];
} else {
 $error_msgs[] = "Please enter yes or no";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['ifyes2']){
$ifyes2 = $_POST['ifyes2'];
} else {
 $error_msgs[] = "If you answered no to above, type N/A, otherwise describe";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cname']){
$cname = $_POST['cname'];
} else {
 $error_msgs[] = "Please enter company name";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['caddress']){
$caddress = $_POST['caddress'];
} else {
 $error_msgs[] = "Please enter company address";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cphone']){
$cphone = $_POST['cphone'];
} else {
 $error_msgs[] = "Please enter company phone number";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['ccperson']){
$ccperson = $_POST['ccperson'];
} else {
 $error_msgs[] = "Please enter company contact person's name";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['ctype']){
$ctype = $_POST['ctype'];
} else {
 $error_msgs[] = "Please enter type of work";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cwage']){
$cwage = $_POST['cwage'];
} else {
 $error_msgs[] = "Please enter wage earned";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cstart']){
$cstart = $POST['cstart'];
} else {
 $error_msgs[] = "Please enter date started";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cend']){
$cend = $POST['cend'];
} else {
 $error_msgs[] = "Please enter date ended";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['reason']){
$reason = $_POST['reason'];
} else {
 $error_msgs[] = "Please enter reason for leaving";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cname2']){
$cname2 = $_POST['cname2'];
} else {
 $error_msgs[] = "Please enter company name or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['caddress2']){
$caddress2 = $_POST['caddress2'];
} else {
 $error_msgs[] = "Please enter company address or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cphone2']){
$cphone2 = $_POST['cphone2'];
} else {
 $error_msgs[] = "Please enter company phone number or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['ccperson2']){
$ccperson2 = $_POST['ccperson2'];
} else {
 $error_msgs[] = "Please enter company contact person's name or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['ctype2']){
$ctype2 = $_POST['ctype2'];
} else {
 $error_msgs[] = "Please enter type of work or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cwage2']){
$cwage2 = $_POST['cwage2'];
} else {
 $error_msgs[] = "Please enter wage earned or type 0.00 if N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cstart2']){
$cstart2 = $POST['cstart2'];
} else {
 $error_msgs[] = "Please enter date started or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cend2']){
$cend2 = $POST['cend2'];
} else {
 $error_msgs[] = "Please enter date ended or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['reason2']){
$reason2 = $_POST['reason2'];
} else {
 $error_msgs[] = "Please enter reason for leaving or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cname3']){
$cname3 = $_POST['cname3'];
} else {
 $error_msgs[] = "Please enter company name or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['caddress3']){
$caddress3 = $_POST['caddress3'];
} else {
 $error_msgs[] = "Please enter company address or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cphone3']){
$cphone3 = $_POST['cphone3'];
} else {
 $error_msgs[] = "Please enter company phone number or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['ccperson3']){
$ccperson3 = $_POST['ccperson3'];
} else {
 $error_msgs[] = "Please enter company contact person's name or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['ctype3']){
$ctype3 = $_POST['ctype3'];
} else {
 $error_msgs[] = "Please enter type of work or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cwage3']){
$cwage3 = $_POST['cwage3'];
} else {
$error_msgs[] = "Please enter wage earned or type 0.00 if N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cstart3']){
$cstart3 = $POST['cstart3'];
} else {
$error_msgs[] = "Please enter date started or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['cend3']){
$cend3 = $POST['cend3'];
} else {
$error_msgs[] = "Please enter date ended or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['reason3']){
$reason3 = $_POST['reason3'];
} else {
$error_msgs[] = "Please enter reason for leaving or type N/A";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['maywe']){
$maywe = $_POST['maywe'];
} else {
$error_msgs[] = "Type names of companies you do not want us to contact, or type, ok all";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['additional']){
$additional = $_POST['additional'];
} else {
$error_msgs[] = "Type N/A if you do not have any additional information";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['electronicsignfn']){
$electronicsignfn = $_POST['electronicsignfn'];
} else {
$error_msgs[] = "Please enter your full name";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['electronicsignssn']){
$electronicsignssn = $_POST['electronicsignssn'];
} else {
$error_msgs[] = "Please enter your 9 digit social security number";
$errors++; //Flag to let the code know that there are errors, used in every case
}

if ($_POST['emailaddress']){
$emailaddress = $_POST['emailaddress'];
} else {
$error_msgs[] = "Please enter your email address";
$errors++; //Flag to let the code know that there are errors, used in every case
}

// Finally at the end, check to see if there are any errors and display them all
if ($errors > 0) {
// Display your error array
foreach (    $error_msgs as &$msg) {
echo "There were " . $errors . " errors in your submission, please correct them.<br/>";
echo $msg . "<br/>";
}
} else {
// Add code here to submit the form however you'd like
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:57:33.387

您的条件测试很可能每次都会评估为假。您可能需要像这样使用 isset() 或 empty() 进行测试：

```
if (isset($_POST['field'])) {
    // a value was posted
} else {
    // error
} 
```

或者

```
if (!empty($_POST['field'])) {
    // a value was posted
} else {
    // error
} 
```

错误可能会显示在您的输入字段旁边，但您需要首先处理第一件事，即让您的表单正常工作。

# jquery - 通过 animate() 加载外部 div 后，如何更新父 div 高度

> ID：11851436
> 
> 赞同：0
> 
> 时间：2012-08-07T17:54:31.293
> 
> 标签：jquery

我将不胜感激您对此的所有意见。我正在将一个外部 div 从另一个 html 页面加载到一个名为“pageLoader”的 div 中。加载 div 后，我想根据外部 div 的高度为“pageLoader”高度设置动画。因此，如果外部 div 的高度为 800px，那么我希望“pageLoader”高度相同。我在这方面找到了几个线程，但据我所知，在加载外部 div 之前我无法获得它的高度，只有这样我才能获得它的尺寸。

这是我的代码。我希望高度不要被硬编码。我想要一个函数来计算外部 div 的高度，然后更新“.animate 块”中的高度。我尝试了很多组合，但一直无法实现。

```
 $("#pageLoader").load("xxxx.html #content").css(
        {                           
             display:"block",
             opacity:0,

        }).animate({

            opacity:1.0,
            top:0,
            easing: 'easOutBack',
            height: 

        },500, function()
        {
            //alert("DONE");
        }); 
```

这是通过调用“回调”函数为我提供外部 div 高度的代码：

```
 $('#pageLoader').load('xxxx.html', function() {
           $('#pageLoader').height($('#content').height());
        }); 
```

任何方向将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:57:19.547

简要显示 div，获取它的高度，然后再次隐藏它。然后动画到适当的高度。

# php - 分配 html 和 var 值 smarty php

> ID：11851440
> 
> 赞同：1
> 
> 时间：2012-08-07T17:54:41.383
> 
> 标签：php, smarty

我需要为 smarty var 赋值，但它需要与一些 html 或文本混合

```
 {assign var="heading1" value='Hello $user <a href="#">logout</a>'} 
```

HTML 有效，但`$user`变量无效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:19:58.400

在 Smarty2 中，您会（对于“复杂变量”之类的`$foo.bar.baz`）编写类似

```
{assign var="heading1" value="Hello `$user` <a href='#'>logout</a>"} 
```

在 Smarty3 你可以做

```
{$heading1 = "Hello {$user} <a href='#'>logout</a>"} 
```

* * *

如果您希望该变量被转义（是的，您想要），您可以使用[{capture}](http://www.smarty.net/docs/en/language.function.capture.tpl)：

```
{capture assign="heading1"}Hello {$user|escape} <a href='#'>logout</a>{/capture} 
```

在 Smarty3 你可以做

```
{$heading1 = "Hello {$user|escape} <a href='#'>logout</a>"} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:56:54.563

为了嵌入您的 PHP 变量，您必须在`smarty`.

例如：

```
{assign var="heading1" value="Hello $user <a href='#'>logout</a>"} 
```

应该为您连接 $user 。

# silverlight - SignalR 在本地 IIS Web 服务器中不起作用

> ID：11851441
> 
> 赞同：2
> 
> 时间：2012-08-07T17:54:43.490
> 
> 标签：silverlight, signalr

我们正在使用 SignalR 将通知推送到 Silverlight 前端。它在 ASP.NET 开发服务器下运行时运行顺畅，但在切换到本地 IIS Web 服务器时，消息永远不会到达前端。在 HubProxy 的事件处理程序上设置了一个断点，并且永远不会被调用。

顺便说一句，我已经检查了这个问题 - [Signalr/Hub 未在 IIS 7 中加载，但在 Visual Studio 中正常工作](https://stackoverflow.com/questions/8053229/signalr-hub-not-loading-in-iis-7-but-working-correctly-in-visual-studio)- 我们的 web.config 文件中已经有了这些设置。

有任何想法吗？

谢谢。

编辑：它也在 IIS Express 下工作，但不是 IIS 7.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T01:58:06.657

我假设您在 Windows 7 上使用 IIS 7.5，这限制了您可以拥有的并发连接数（[Ultimate 上最多 10 个](http://www.jpelectron.com/sample/WWW%20and%20HTML/IIS-%20OS%20Version%20Limits.htm)）。但是在 IIS Express 上，没有限制。这是我现在能想到的唯一区别，为什么它适用于 Express 但不适用于 IIS 7.5。

# c# - 是否有任何替代 OleDb 来提高性能的方法？

> ID：11851442
> 
> 赞同：0
> 
> 时间：2012-08-07T17:54:45.867
> 
> 标签：c#, sql-server, winforms

我有一个 ms sql 2012 服务器，我使用这个函数来添加/记录：

```
static String conString = "Provider=SQLOLEDB;Data Source = " + ecommerceServer + "; Initial Catalog = " + eCommercedbName + "; User Id = " + eCommerceUsername + "; Password = " + eCommercepassword + ";";

    public bool InsertSQL(String query, String Tablename)
    {
        OleDbConnection conn = new OleDbConnection(conString);
        try
        {
            conn.Open();
            OleDbCommand command = new OleDbCommand(query, conn);
            int count = command.ExecuteNonQuery();
            return (count > 0) ? true : false;
        }
        catch
        {
            if (conn.State.ToString() == "Open")
            {
                conn.Close();
            }
        }
        return false;
    } 
```

该功能很慢（例如，我对 MySQL 有类似的执行，它的工作速度要快得多。有没有比这更快的方法`OleDb`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:27:43.440

如果您担心它的性能，请查看[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)

[这是](http://www.4guysfromrolla.com/articles/102109-1.aspx)一个示例（尽管在 VB.Net 中），它可以让您了解所涉及的速度增加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:14:16.663

下面的 Andrew 是一个示例，说明您如何使用 SQL 客户端以及在查询中执行事务。您可以将其用作指南/学习示例，也可以替换变量以适合您当前的示例。还要注意我是如何从 app.config 文件中读取连接字符串的

```
 private void SomeMethod()
 {
    SqlCommand sqlcmd = new SqlCommand();
    using (SqlConnection sqlConn = new SqlConnection(ConfigurationSettings.AppSettings["strConnectionString"]))//strConnectionString
    {
       sqlConn.Open();
       sqlcmd.Connection = sqlConn;
       SqlTransaction transaction;
       // Start a local transaction.
       transaction = sqlConn.BeginTransaction("DeleteRecs");
       sqlcmd.Transaction = transaction;
       sqlcmd.CommandTimeout = 60;
       sqlcmd.CommandText = "uf_DeleteWeeks";
       sqlcmd.CommandType = System.Data.CommandType.StoredProcedure;
       try
       {
          sqlcmd.ExecuteNonQuery();
          sqlcmd.Transaction.Commit();
       }
       catch (SqlException sqle)
       {

        try
        {
           transaction.Rollback("DeleteRecs");
        }
        catch (Exception ex)
        {

        }
       Console.WriteLine(sqle.Message);
       }
      }
      ((IDisposable)sqlcmd).Dispose();
   } 
```

# c# - WCF 服务如何处理大量请求？

> ID：11851443
> 
> 赞同：-1
> 
> 时间：2012-08-07T17:54:47.153
> 
> 标签：c#, .net, wcf

因此，如果我有一个 WCF 服务正在运行，我怎么知道该服务可以处理多少个请求。还有没有内置的排队机制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:57:34.927

这取决于您的硬件。要监视 WCF，您可以使用系统计数器[WCF Performance Counters](http://msdn.microsoft.com/en-us/library/ms735098)。

# regex - 使用正则表达式验证日期

> ID：11851444
> 
> 赞同：0
> 
> 时间：2012-08-07T17:54:48.793
> 
> 标签：regex

我发现的所有示例都在检查字符串是否遵循某种模式并且是数字，例如`"\d{4}-\d{2}-\d{2}"`. 我想检查日期是否晚于给定日期，例如，检查日期是否遵循模式“yyyy-mm-dd”并且晚于“2009-03-01”。如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T17:57:59.377

不要为此使用正则表达式。这就像试图用锯子敲钉子一样。

使用您的语言为您提供的任何日期解析并使用它来执行检查。

如果您需要从字符串中提取日期以执行此操作，请务必使用正则表达式，但仅限于该部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:59:43.587

试试这个：

[http://www.regular-expressions.info/dates.html](http://www.regular-expressions.info/dates.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:04:12.767

我绝对同意塞巴斯蒂安的回答，即正则表达式不是正确的工具。这里所说的是一个我认为可能有效的正则表达式：

```
2009-(?:03-(?:0[2-9]|[1-9]\d)|(?:0[4-9]|1\d)-\d\d)|(?:20[1-9]\d|2[1-9]\d\d|[3-9]\d{3})-\d\d-\d\d 
```

这只是为了向您展示阅读此类问题的正则表达式解决方案有多么困难，您最好使用正则表达式提取日期，然后使用语言工具将其与目标日期进行比较。

# node.js - Node v0.8.5 REPL：需要 npm 安装模块时找不到模块

> ID：11851448
> 
> 赞同：7
> 
> 时间：2012-08-07T17:55:05.640
> 
> 标签：node.js, npm

我有一个节点应用程序，其中包含一个`package.json`声明我的依赖项的文件。

我已经运行`npm install`将这些 deps 安装到本地`node_modules`文件夹，当我运行我的应用程序时，一切正常。

问题是当我尝试通过启动节点 REPL 来激发一些新功能时：

```
$ node           
> require('hubot');
Error: Cannot find module 'hubot' 
```

在 REPL 中，似乎不知道往里看`node_modules`。这是预期的行为，还是hubot很奇怪？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T20:58:37.507

您可以设置 env 变量`NODE_DEBUG`以查看节点尝试的路径：

```
export NODE_DEBUG=module
> require('toto')
Module._load REQUEST  toto parent: repl
looking for "toto" in ["/Users/laurent/repl/node_modules","/Users/laurent/node_modules","/Users/node_modules","/node_modules","/lusr/local/bin/node","/Users/laurent/.node_modules","/Users/laurent/.node_libraries","/usr/local/lib/node"] 
```

# javascript - $.ui 在自动完成和 ui 插件中未定义

> ID：11851451
> 
> 赞同：4
> 
> 时间：2012-08-07T17:55:14.493
> 
> 标签：javascript, jquery, jquery-ui, autocomplete, jquery-autocomplete

我正在尝试在文本字段上使用 jquery 自动完成功能，以允许用户选择多个标签，如[本示例所示](http://jqueryui.com/demos/autocomplete/#multiple)，但出现错误`Uncaught TypeError: Cannot read property 'autocomplete' of undefined`。这是导致问题的代码，大部分是从链接中复制的。

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script>
<script type="text/javascript">
var tags = [<?php
foreach($this->tags as $tag){
    echo "\"{$tag['name']}\",";
}
?>""];

$( "textarea:[name='tags']" ).autocomplete({
    minLength: 0,
    source: function( request, response ) {
        // delegate back to autocomplete, but extract the last term
        alert($.ui);
        $.noConflict();
        alert($.ui);
        response( $.ui.autocomplete.filter(
            tags, extractLast( request.term ) ) );
    },
    focus: function() {
        // prevent value inserted on focus
        return false;
    },
    select: function( event, ui ) {
        var terms = split( this.value );
        // remove the current input
        terms.pop();
        // add the selected item
        terms.push( ui.item.value );
        // add placeholder to get the comma-and-space at the end
        terms.push( "" );
        this.value = terms.join( ", " );
        return false;
    }
}); 
```

错误来自`response( $.ui.autocomplete.filter(`源内部的行。出于某种原因`$( "textarea:[name='tags']" ).autocomplete`，它完全可以定义，但 $.ui.autocomplete 不是。

我在这个脚本上方包含了 jQuery 和 jQuery UI。这可能是什么原因造成的？

编辑：

我注意到，如果我把`alert($.ui);`它显示在自动完成功能之外`[Object object]`，但是如果我把相同的警报放在自动完成的源属性中，它是未定义的。用 $ 做同样的事情表明 $ 是在内部定义的，但 $.ui 不是。我在页面上也有一个日期选择器，它显示的是同样的东西，$.ui 没有在插件中定义。为什么在这些插件中未定义 jQuery UI？

编辑2：

将源属性放在`$.noConflict()`响应函数的正上方可以让它工作足够长的时间让我输入一个标签，然后它会使自动完成崩溃，尽管日期选择器仍然有效。我尝试将它放在创建函数中，这样它只会执行一次，但这只会禁用页面上的所有其他 jQuery。

我对 jQuery 或 Javascript 不是很有经验，但似乎 jQuery UI 插件正在删除别名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:01:20.057

将您的代码包装在

```
$(document).ready(function() {
    // code here
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:59:16.953

如果您还没有，您可能还应该包含 jQuery it self。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T20:55:23.953

我仍然不知道是什么原因造成的，但是设置了一个计数器和一个 if 语句，以便 $.noConflict 仅在解决问题后才执行。

# spring - 如何使用 maven-war-plugin 在项目之间共享类、配置文件和 Web 工件...？

> ID：11851454
> 
> 赞同：1
> 
> 时间：2012-08-07T17:55:16.733
> 
> 标签：spring, web-applications, maven, spring-security, maven-war-plugin

有人可以帮我配置 maven-war-plugin 吗？

出于安全原因，我想在两台服务器上为两个不同的用户组运行两个非常相似的 Web 应用程序，而不是只为所有用户组部署一个。因此，我想在他们之间共享尽可能多的代码。

我打算创建一场战争，它也可以独立运行以进行开发，并在两个单独的 Web 项目中重用其大部分项目。我想重用例如 spring 配置文件 (applicationContext-XX.xml)、jspx、css、...和 ​​Java 代码。但我还需要编写一些扩展共享类的 Java 类。

我想使用 spring roo 生成的测试项目来试用 maven-war-plugin。我已经尝试了几件事，但部署仍然存在问题。

如果我只使用战争，那么我不能扩展任何 Java 类，因为代码无法编译：

```
<dependency>
    <groupId>com.test.pizzashop</groupId>
    <artifactId>PizzaShopCommons_WEB</artifactId>
    <scope>compile</scope>
    <version>0.1.0.BUILD-SNAPSHOT</version>
    <type>war</type>
</dependency>
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-war-plugin</artifactId>
    <version>2.2</version>
    <configuration>
        <overlays>
            <overlay>
                <groupId>com.test.pizzashop</groupId>
                <artifactId>PizzaShopCommons</artifactId>
            </overlay>
        </overlays>
    </configuration>
</plugin> 
```

即使我没有扩展任何 Java 类，我的 Tomcat (mvn tomcat:run) 也不会启动，因为它没有找到正确位于 lib 文件夹中的 jar。
我还尝试使用第二个共享项目，它只包含 Java 类和 Spring 配置文件以及所有依赖项，然后打包为 jar。在 Tomcat 中运行主 Web 应用程序仍然会导致异常：
org.springframework.beans.factory.BeanDefinitionStoreException: IOException parsing XML document from ServletContext resource [/WEB-INF/spring/webmvc-config.xml]；嵌套异常是 FileNotFoundException：无法打开 ServletContext 资源 [/WEB-INF/spring/webmvc-config.xml] 这个文件 webmvc-config.xml 位于它应该在战争中的位置（由 maven 战争插件复制在那里）。

```
<dependency>
    <groupId>com.test.pizzashop</groupId>
    <artifactId>PizzaShopCommons_WEB</artifactId>
    <scope>compile</scope>
    <version>0.1.0.BUILD-SNAPSHOT</version>
    <type>war</type>
</dependency>
<dependency>
    <groupId>com.test.pizzashop</groupId>
    <artifactId>PizzaShopCommons_SpringConf_Classes_Dependencies</artifactId>
    <scope>compile</scope>
    <version>0.0.1-SNAPSHOT</version>
    <type>jar</type>
</dependency>
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-war-plugin</artifactId>
    <version>2.2</version>
    <configuration>
        <overlays>
            <overlay>
                <groupId>com.test.pizzashop</groupId>
                <artifactId>PizzaShopCommons_WEB</artifactId>
                <excludes>
                    <exclude>*.java</exclude>
                </excludes>
                <excludes>
                    <exclude>*.jar</exclude>
                </excludes>
            </overlay>
        </overlays>
    </configuration>
    <!-- <executions> <execution> <phase>generate-resources</phase> </execution> </executions> -->
</plugin> 
```

生成的战争中的文件结构如下所示：

```
+---pizzashop-1.0.0-BUILD-SNAPSHOT
|   +---images
|   |       add.png ...       
|   +---META-INF
|   |   |   MANIFEST.MF   
|   |   \---maven
|   |       \---com.test.pizzashop
|   |           \---PizzaShop
|   |                   pom.properties
|   |                   pom.xml                 
|   +---styles
|   |       standard.css ...   
|   \---WEB-INF
|       |   web.xml
|       +---classes
|       |   |   builddef.lst ...  
|       |   +---com
|       |   |   \---test
|       |   |       \---pizzashop   
|       |   |           +---domain
|       |   |           |       Pizza.class ...
|       |   |           +---service
|       |   |           |       PizzaService.class ...      
|       |   |           \---web
|       |   |                   PizzaController.class ...                  
|       |   \---META-INF
|       |       |   aop-ajc.xml
|       |       |   persistence.xml  
|       |       \---spring
|       |               applicationContext-security.xml
|       |               applicationContext.xml
|       |               database.properties             
|       +---i18n
|       |       application.properties ...    
|       +---layouts
|       |       default.jspx ...  
|       +---lib
|       |       antlr-2.7.6.jar ...      
|       +---spring
|       |   |   root-context.xml
|       |   |   webmvc-config.xml 
|       |   \---appServlet
|       |           xx_servlet-context_xx.xml         
|       +---tags
|       |   |   create.tagx ...        
|       \---views
|           |   dataAccessFailure.jspx ... 
```

我怎样才能让它运行？是否有可能仅通过一个共享项目（一个罐子或战争）来实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T16:55:15.743

我集成了项目继承和聚合，因为两者都是有意义的。

希望能得到一些反馈，我将描述我如何尝试两个解决这两个问题（a）将公共代码分成一个战争和一个 jar 项目，b）由于 spring 配置文件而无法运行）：

我尝试了一些更多的 Maven 选项，但仍然没有找到令人满意的解决方案：

我在 PizzaShopCommons_WEB 的 pom.xml 中的**maven-war-plugin中添加了一个带有****attachClasses**的配置元素，以直接从 commons 代码创建一个 jar 和一个战争覆盖：

 **```
 <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-war-plugin</artifactId>
         <version>2.1.1</version>
         <configuration>  
                <attachClasses>true</attachClasses>
         </configuration>   
 </plugin> 
```

弹簧资源的问题似乎是现在它们被加载了两次（一次来自 jar，一次来自战争）。这尤其不适用于弹簧安全性。

这基本上是我的下一个问题。

***我已经尝试过但不起作用的是：***
**1.**在上面的配置中添加包装排除有问题的弹簧配置文件。但这导致在没有 applicationContext 文件但包含它们的 jars 的情况下构建战争。现在无法再将 commons 项目作为独立项目部署，所以我没有尝试运行它：

```
 <packagingExcludes>**/applicationContext*</packagingExcludes> 
```

**2.**自定义 maven-jar-plugin 以仅包含在构建 jar 时有效的类文件，但在使用额外 jar 构建战争时不包含，如上所示。

```
 <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-jar-plugin</artifactId>
         <version>2.3.1</version>
         <configuration>
           <includes>
            <include>com/**</include>
           </includes>
         </configuration>
  </plugin> 
```

**3.**从最终战争中排除生成的jar并使用覆盖层中的类文件。但我还是

***我得到的例外：*** 无论出于何种原因，无论我改变什么跑步

> mvn tomcat:运行

总是导致相同的异常：

> DispatcherServlet - 上下文初始化失败 org.springframework.beans.factory.BeanDefinitionStoreException: IOException parsing XML document from ServletContext resource [/WEB-INF/spring/webmvc-config.xml]; 嵌套异常是 java.io.FileNotFoundException: 无法打开 ServletContext 资源 [/WEB-INF/spring/webmvc-config.xml]

所以我尝试将它直接部署在 Tomcat 7 上，结果是

> 创建名为 'org.springframework.security.filterChainProxy' 的 bean 时出错：调用 init 方法失败；嵌套异常是 java.lang.IllegalArgumentException：通用匹配模式 ('/**') 在过滤器链中的其他模式之前定义，导致它们被忽略。请检查您的命名空间或 FilterChainProxy bean 配置中的排序

使用 eclipse WTP 来部署代码根本不起作用，因为不知何故覆盖的工件被忽略了。在这种情况下的错误信息是

> org.springframework.beans.factory.NoSuchBeanDefinitionException：没有定义名为“springSecurityFilterChain”的bean II手动复制必要的代码，我得到了与直接在Tomcat 7上部署相同的异常。

Commons 项目始终可以部署并正常工作。任何对 Maven 和 Spring 有更多经验的人的想法绝对值得赞赏！**

# android - 在 GridView 中使用图像选择器时膨胀类选择器时出错

> ID：11851458
> 
> 赞同：0
> 
> 时间：2012-08-07T17:55:26.710
> 
> 标签：android, gridview, selector

我正在使用 GridView 和图像选择器，以便我的图像在按下时与未按下时不同。一切都可以编译，但是当我运行应用程序时，我收到一个错误“二进制 XML 文件第 9 行：错误膨胀类选择器”。

是否可以在 gridview 中使用图像选择器？当我将选择器从 xml 中取出时，它运行良好。

这是每个网格项的 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout    xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:padding="5dp" >
<selector   
     xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/status_button_down"
          android:state_pressed="true" />
    <item android:drawable="@drawable/status_button_down"
          android:state_focused="true" />
    <item android:drawable="@drawable/status_button_up" />
</selector>
<TextView
    android:id="@+id/grid_item_label"

        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Status"    
        android:textSize="9pt"
        android:typeface="sans"
        android:textColor="#000000"  
        android:gravity="center_horizontal"
        android:layout_gravity="center_horizontal|bottom"

         />
</LinearLayout> 
```

这是网格视图适配器的代码：

```
public class ImageAdapter extends BaseAdapter {
private Context mContext;

public ImageAdapter(Context c) {
    mContext = c;
}

public int getCount() {
    //return mThumbIds.length;
    return 16;
}

public Object getItem(int position) {
    return null;
}

public long getItemId(int position) {
    return 0;
}

// create a new ImageView for each item referenced by the Adapter
public View getView(int position, View convertView, ViewGroup parent) {

    LayoutInflater inflater = (LayoutInflater) mContext
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        View gridView;
        //ImageView imageView;
    if (convertView == null) {  // if it's not recycled, initialize some attributes

        gridView = new View(mContext);

        // get layout from mobile.xml
        gridView = inflater.inflate(R.drawable.status_button, null);

        // set value into textview
        TextView textView = (TextView) gridView
                .findViewById(R.id.grid_item_label);

        textView.setText("Status");

    } else {
        //imageView = (ImageView) convertView;
        gridView = (View) convertView;

    }

    return gridView;

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:46:52.467

选择器实际上应该在您的“drawables”文件夹中设置为它自己的 .xml 文件。然后你可以这样称呼它：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout    xmlns:android="http://schemas.android.com/apk/res/android"
android:background="@drawable/my_selector" 
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:padding="5dp" > 
```

# iphone - UIGestureRecognizers vs touchesBegan/touchesMoved/touchesEnded（准确度）

> ID：11851464
> 
> 赞同：14
> 
> 时间：2012-08-07T17:56:12.643
> 
> 标签：iphone, ios, ipad, uigesturerecognizer, touchesbegan

我正在打印使用这两种触摸跟踪方法获得的点列表。

手势识别器更易于使用，但如果您将获得的点与 touchesBegan 过程进行比较，识别器会避开一些点，特别是在动作开始时。

有谁知道这两个程序之间的准确性是否存在差异？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-07T18:13:07.777

我相信手势识别器最初需要一些时间来断言它已经检测到正确的手势。例如，如果我们进行滑动手势，ios 会首先等待确认它不是轻击手势。

因此，手势识别器可能不会在动作开始时打印点。

[正如此处](https://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizers/GestureRecognizers.html#//apple_ref/doc/uid/TP40009541-CH6-SW1)的开发人员文档所述：

> 手势识别器在识别手势时可能会延迟将触摸对象传递到视图，并且默认情况下，一旦识别到手势，它们就会取消将剩余触摸对象传递到视图。

可以在[此链接](https://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizers/GestureRecognizers.html#//apple_ref/doc/uid/TP40009541-CH6-SW20)中找到有用的详细示例。

希望这可以帮助。

# sql-server-2008-r2 - sql server ALL关键字

> ID：11851467
> 
> 赞同：0
> 
> 时间：2012-08-07T17:56:20.500
> 
> 标签：sql-server-2008-r2

假设我有下表：

```
ID  Value
--  ----
1   1
1   1
1   0
2   1
2   1 
```

让我们取 1 的 ID。我需要检查所有 1 的 ID 的值是否为 1。如果没有，我需要返回“N/A”。在这种情况下，由于第 3 行的值为 0，我需要返回 'N/A'

```
 select * from tbl1 where ID = 1 and value = 1 
```

不会完全做到。

我知道 SQL 有 ALL 关键字，但不知道在这种情况下如何使用它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:02:51.557

```
DECLARE @id INT;
SET @id = 1;

SELECT CASE 
  WHEN EXISTS (SELECT 1 FROM dbo.tablename WHERE ID = @id AND Value <> 1) THEN 'N/A'
  WHEN EXISTS (SELECT 1 FROM dbo.tablename WHERE ID = @id) THEN 'All are equal to 1'
  ELSE 'No values present with this ID.'
END 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-07T17:58:13.870

我假设您也在测试 ID = 2 那么值是否也 = 2 依此类推，即 ID = 值，如果是这样：

```
SELECT 
      ID, 
      Value, 
      CASE WHEN ID=Value THEN 'Equal' ELSE 'N/A' END AS TheStatus 
 FROM 
      MyTable 
```

# c++ - Visual Studio - 未能返回值时没有编译错误

> ID：11851468
> 
> 赞同：1
> 
> 时间：2012-08-07T17:56:24.120
> 
> 标签：c++, visual-studio-2008

**问题。** 请参阅下面的代码...我错过了该`return field;`语句，并且在几次调试运行中没有发现它。我永远不会想到这样的事情会在没有错误的情况下通过编译器！为什么这样做？

**描述** 我有一个解析器对象，用于`std::tr1::function`在构造时接收翻译算法。翻译从字符串转换为 类型的对象`TransportableMessage`，该对象由 组成`TMFields`，可以容纳不同的类型。所以无论如何我做了一个工厂函数来创建字段，因为字段的类型是基于一个字符串（来自 XML），虽然现在只有几个，但将来可能会有更多。

该`tstring`对象是基于`UNICODE`并且基本上解析为的类型转换`std::wstring`。也因为我使用的是 VS2008`unique_ptr`不存在所以我隐藏`std::auto_ptr`在后面`ScopedPtr_t`以使升级更容易，因此更有可能发生。

```
namespace arc
{
    namespace util
    {

        int internalTest()
        {
            std::cout << "Any error?" << std::endl;
        }

        ScopedPtr_T<TMField> TmFieldFactory( const tstring& name, const tstring& typeName, const tstring& value )
        {
            ScopedPtr_T<TMField> field;
            int a = internalTest();
            if( typeName == _T("int") || typeName == _T("long") )
            {
                field.reset( new TMNumericField( name, boost::lexical_cast<__int64>(value) ) );
            }
            else if( typeName == _T("string") )
            {
                field.reset( new TMStringField( name, value ) );
            }
            else if( typeName == _T("timestamp") )
            {
                field.reset( new TMTimeField( name, boost::lexical_cast<__int64>(value) ) );
            }
            else
            {
                std::string info( __FILE__ " :: " __FUNCTION__ " : Unrecognized TmField type ");
                std::string type( typeName.begin(), typeName.end() );
                info += type;
                throw ARC_Exception( info.c_str() );
            }
            return field; // I WAS MISSING THIS!
        }
    }
} 
```

基本上我想知道其他人是否对此有问题？我介绍了该功能`internalTest`以查看问题是否特定于`scoped_ptr`s 但似乎不是。我也尝试`internalTest`在 GCC 中使用，但它返回了一个错误。为什么 Visual Studio 没有标记这个？我是否缺少可以打开的编译设置？标准允许吗？抱歉，如果这是众所周知的事情，我做了谷歌并在这里寻找答案。

**编辑:: 调用代码**- 只需添加这个以获得更多上下文。

```
SharedPtr_T<TransportableMessage> strToTmConvFunc_Default_Apc7_0(const std::string& tm_str)
{
    pugi::xml_document xmlDoc;
    if( false == xmlDoc.load( tm_str.c_str() ) )
    {
        ARC_LOG(LOG_WARN, "The passed TM object was malformed. %s", tm_str.c_str() );
        throw ARC_Exception( "Malformed Transportable Message XML" );
    }

    pugi::xml_node tmBase = xmlDoc.first_child();
    std::string xmlRootName( tmBase.name() );
    if( xmlRootName.compare("TM") != 0 )
    {
        ARC_LOG(LOG_WARN, "The passed TM object was malformed. %s", tm_str.c_str() );
        throw ARC_Exception( "Malformed Transportable Message XML" );
    }

    std::string tmname = tmBase.child("N").child_value();
    std::string entity = tmBase.child("E").child_value();
    ARC_LOG(LOG_INFO, "TM message received for parsing. TM name is %s", tmname.c_str() );

    tstring t_tmname( tmname.begin(), tmname.end() );
    SharedPtr_T<TransportableMessage> tm_obj( new TransportableMessage( t_tmname, 0 ) );

    pugi::xml_node fields = tmBase.child("FS");
    for( pugi::xml_node field = fields.first_child(); field; field = field.next_sibling("field") )
    {
        tm_obj->addField( arc::util::TmFieldFactory( field.child_value("N"), field.child_value("T"), field.child_value("V") ) );
    }

    return tm_obj;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T18:17:33.203

从函数体中掉下来而不返回某些东西不是错误，而是未定义的行为；见 6.3.3`return`语句 [stmt.return] §3：

> 从函数的末尾流出相当于没有值的返回；这会导致值返回函数中的未定义行为。

# windows-phone-7 - 获取错误“system.xml.xmldictionaryreader 不包含 CreateTextReader 的定义”

> ID：11851470
> 
> 赞同：0
> 
> 时间：2012-08-07T17:56:30.340
> 
> 标签：windows-phone-7

我收到错误 system.xml.xmldictionaryreader does not contain a definition for the VS2010 Express for Windows phone 上的“CreateTextReader”。该代码用于网页，它可以工作，然后我复制到我的手机应用程序中。我添加了“System.Runtime.Serialization”和“使用 System.xml”作为参考。有人会告诉我如何解决这个问题。谢谢。

有类使用：

```
using System;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using System.IO;
using System.Xml.Serialization;
using System.Runtime.Serialization;
using System.Collections.Generic;
using System.Xml;
using System.Text;
using System.IO.IsolatedStorage;

   public static T Deserializer<T>(Stream s)
    {
        //Get results   
        var ser = new DataContractSerializer(typeof(T));
        var reader = XmlDictionaryReader.CreateTextReader(s,
            new System.Xml.XmlDictionaryReaderQuotas());
        ser = new DataContractSerializer(typeof(T));
        var deserializedItem = (T)ser.ReadObject(reader, true);
        reader.Close();
        return deserializedItem;
    }
    #endregion 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:16:25.147

手机不[支持这种过载。](http://msdn.microsoft.com/en-us/library/aa346766)

首先读取 byte[] 数组中的流，然后将其提供给[CreateBinaryReader](http://msdn.microsoft.com/en-us/library/aa346742)重载

# matlab - GUIDE 中的句柄变量未更新

> ID：11851476
> 
> 赞同：0
> 
> 时间：2012-08-07T17:56:56.833
> 
> 标签：matlab, user-interface, matlab-guide, handles

我有一个使用 MATLAB GUIDE 创建的 GUI。我正在尝试从 GUI 返回一个值。以下是代码的相关部分（完整代码可以在[这里](http://paste.ideaslabs.com/show/3L45QfKTL)找到）：

```
function varargout = test(varargin)

% --- Outputs from this function are returned to the command line.
function varargout = test_OutputFcn(hObject, eventdata, handles) 

    % Get default command line output from handles structure
    varargout{1} = handles.output;
    varargout{2} = handles.test;

% --- Executes on button press in pushbutton1.
function pushbutton1_Callback(hObject, eventdata, handles)

    handles.test = 'ok';

    % Update handles structure
    guidata(hObject, handles); 
```

一旦我执行 GUI，我就会收到以下错误消息：

![http://s11.postimage.org/5trvp5c83/Captura_de_tela_2012_08_06_a_s_12_25_55.png](../Images/a47d388e5d41baf9d2b6e2bb8e83963a.png)

我在 MATLAB 新闻组上发现了一个[类似](http://www.mathworks.com/matlabcentral/newsreader/view_thread/259633)的问题，但我没有找到解决方案（我阅读了所有 guidata 的文档，就像建议的那样）。

我的问题是我在一个 GUIDE 的函数中的“句柄”结构中记录了一条信息，而我无法在另一个函数中检索此信息。

我[试图](http://paste.ideaslabs.com/show/6QQr4NqA4A)取消注释`test_OpeningFcn`函数中的 UIWAIT 调用，以等待用户关闭窗口。

```
% --- Executes just before test is made visible.
function test_OpeningFcn(hObject, eventdata, handles, varargin)

    % Choose default command line output for test
    handles.output = hObject;

    % Update handles structure
    guidata(hObject, handles);

    % UIWAIT makes test wait for user response (see UIRESUME)
    uiwait(handles.figure1); 
```

在我单击按钮后，然后尝试获取句柄变量。但它也不起作用，并且[失败](http://s7.postimage.org/5s6lk8tyj/Captura_de_tela_2012_08_06_a_s_12_31_31.png)并显示类似的错误消息。

欢迎任何帮助。感谢您的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T22:52:42.697

问题是，当您将 GUI 调用为：

```
>> [a,b] = test() 
```

此调用立即返回，因此在您尝试访问`handles.test`尚不存在的输出函数中，导致错误。

Doug Hull的[截屏视频](http://blogs.mathworks.com/videos/2010/02/12/advanced-getting-an-output-from-a-guide-gui/)展示了如何从 GUI 返回值。以下是从该页面复制的更改列表：

```
%%% OpenignFCN
uncomment uiwait

%%%OutputFCN
varargout{1} = handles.output;
% The figure can be deleted now
delete(handles.figure1);

%%%CloseReqFCN
if isequal(get(hObject, 'waitstatus'), 'waiting')
    % The GUI is still in UIWAIT, us UIRESUME
    uiresume(hObject);
else
    % The GUI is no longer waiting, just close it
    delete(hObject);
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-18T05:20:49.640

您需要添加

```
 handles = guidata(gcf); 
```

更新不同功能的句柄。希望我是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T21:14:39.840

在初始化代码中，您必须声明该字段。

```
handles.test = []; 
```

所以你可以稍后调用它。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-12-21T16:48:32.013

```
global test
handles.test = 'ok'; 
```

# javascript - 在 IE8 运行时插入 JavaScript

> ID：11851484
> 
> 赞同：1
> 
> 时间：2012-08-07T17:57:24.080
> 
> 标签：javascript, internet-explorer-8, runtime, appendchild

我正在使用脚本从库（一个大文件）中加载脚本，它的工作原理如下：

1.  通过 xmlhttprequest 加载脚本
2.  创建一个新的脚本标签元素，其中包含脚本（新文本节点、innerText 或 innerHTML）
3.  在头部追加新元素

没有什么很复杂的。但是 IE8 只是没有完成这项工作！它不允许通过任何方法将脚本插入脚本元素标签中！所以我尝试了另一种方法：

```
<script type="text/javascript" language="javascript">
function teste(){
    var elemScript = document.createElement('script');
    elemScript.type = 'text/javascript';
    elemScript.language = 'javascript';
    elemScript.src = 'http://somewhere/somecode.js';
    var headTag = document.getElementsByTagName('head')[0];
    headTag.appendChild(elemScript);
}
window.onload = teste;
</script> 
```

IE8 什么也没说。我不知道它是否正在加载，但我确定没有执行代码（测试警报）。我知道 jQuery 和其他库可以做到这一点，并且可以使其在所有浏览器中工作（IE8+ 对我来说很好）。他们是如何做到这一点的？有没有一种简单的方法可以用纯 JavaScript 解决这个问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-07T18:07:28.537

ajax 不会触发 onload 事件：

```
window.onload = teste; 
```

因此，只需将其更改为调用该方法：

```
teste(); 
```

# c# - ListBox 知道它在某个遥远的 ScrollViewer 中吗？

> ID：11851491
> 
> 赞同：2
> 
> 时间：2012-08-07T17:57:39.120
> 
> 标签：c#, wpf, layout, listbox, scrollviewer

下面的代码是问题的完整表示。本质上，当我在 ScrollViewer 中有一个 ListBox 时，ListBox 不会显示它自己的滚动条。相反，它依赖于父 ScrollViewer 的滚动条。在我的情况下，我将整个控件包装在 ScrollViewer 中，以便在违反 MinHeight/MinWidth 时获得滚动条。ListBox 只是我的 UserControl 中的众多控件之一，我不希望我的 UserControl 跳到很大的比例以匹配 ListBox 中的项目。你会在下面的代码中添加什么来强制 ListBox 使用它自己的滚动条？

```
using System;
using System.Windows;
using System.Windows.Controls;

namespace TestExpanderWidth
{
    class Program
    {
        [STAThread]
        static void Main()
        {
            var listbox = new ListBox { Margin = new Thickness(10.0), MinWidth = 400 };
            listbox.Items.Add(new string('c', 3000));

            var sv = new ScrollViewer {HorizontalScrollBarVisibility = ScrollBarVisibility.Auto, VerticalScrollBarVisibility = ScrollBarVisibility.Auto};
            sv.Content = listbox; // remove for test

            var window = new Window { Width = 600, Height = 400 };
            window.Content = sv; // remove for test
            //window.Content = listbox; // add for test

            var application = new Application();
            application.Run(window);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T04:13:01.927

布局对话

`ScrollViewer`to `ListBox`: 你可以有*尽可能多的空间，你想要*多少？
`ListBox`to `ScrollViewer`：准确地说，我需要展示我所有的物品`<X, Y>`。
`ScrollViewer`to `ListBox`：当然，拿这个`<X, Y>`。
`ListBox`to `ScrollViewer`：K thx，我将扩展到`<X, Y>`（现在我不需要任何滚动条）。

如果您**限制它的大小**，您将只能`ListBox`使用它，如果您将它放在 a中并将对齐设置为 ，则不会发生这种情况。`ScrollViewer`**`ScrollViewer``Stretch`**

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T09:56:44.070

我不确定这是否是最好的方法，但出于所有强烈和目的，它似乎提供了您要求的功能。

```
public MainWindow()
    {

        InitializeComponent();

    }

    public void WindowLoaded(object sender, EventArgs e) 
    {
        listbox = new ListBox { Margin = new Thickness(10.0), MinWidth = 400, MinHeight = 400 };
        listbox.Items.Add(new string('c', 3000));

        var sv = new ScrollViewer { HorizontalScrollBarVisibility = ScrollBarVisibility.Auto, VerticalScrollBarVisibility = ScrollBarVisibility.Auto };
        sv.Content = listbox; // remove for test

        this.Width = 600;
        this.Height = 400;
        this.Content = sv;

    }

    protected override void OnRenderSizeChanged(SizeChangedInfo sizeInfo)
    {

        base.OnRenderSizeChanged(sizeInfo);
        if (listbox != null)
            listbox.MaxWidth = this.RenderSize.Width - (int.Parse(listbox.Margin.Right.ToString()) * 4);

    } 
```

基本上，我已经为 ListBox 分配了一个基于窗口的渲染宽度的 MaxWidth，并且为了触发我已经覆盖 OnRenderSizeChanged 事件处理程序的事件。

希望这可以帮助您并按照您的意愿工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:01:27.407

我自己只是在学习 WPF，但到目前为止我的理解是 ListBox 没有 ScrollBars。如果您想赋予该控件 ScrollBars，则需要将其包装在 ScrollViewer 中。所以在你的情况下——如果我理解正确的话——你需要添加第二个只包含 ListBox 的 ScrollViewer。**

# html - 如何禁用对 HTML 中的大字进行大小调整的表格

> ID：11851495
> 
> 赞同：3
> 
> 时间：2012-08-07T17:57:48.800
> 
> 标签：html, css, html-table

我有这个 DIV

```
<div style="width:500px;"> </div> 
```

我在里面插入了一张桌子

```
<table style="width:100%;">
<tr>
<td> </td>
</tr>
<tr>
<td> </td>
</tr>
</table> 
```

如果`<td></td>`包含普通单词，即使 100 个单词之间有空格，那么 table 将在 div 内保持其大小，但如果一个单元格包含 1 个单词，大约 100 个字母，那么 table 将在其父 div 之外采用更大的大小，`overflow:hidden;`是很好地隐藏表格的放大，但我希望大小保持不变，并且单元格要增长`height`，就像它通常对普通单词所做的那样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:21:07.047

`word-wrap`是较旧的 IE 特定 CSS 规则。要在现代浏览器中自动换行，请使用`white-space`. 此外，设置`max-width`似乎有助于使事情正常进行。

```
td {
  border: 1px solid black;
  width: 100px;
  max-width: 100px;
  white-space: pre-wrap; /* css-3 */
  white-space: -moz-pre-wrap; /* Mozilla, since 1999 */
  white-space: -pre-wrap; /* Opera 4-6 */
  white-space: -o-pre-wrap; /* Opera 7 */
  word-wrap: break-word; /* Internet Explorer 5.5+ */
} 
```

[**jsFiddle 演示**](http://jsfiddle.net/wXwkr/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:00:29.977

将表设置`max-width`为绝对值，由`parent div`.

尝试：

```
<table style="width:100%; max-width:500px;">
    <tr>
        <td></td>
    </tr>
    <tr>
        <td></td>
    </tr>
</table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:02:06.767

使用 CSS[`word-wrap`](https://developer.mozilla.org/en-US/docs/CSS/word-wrap)属性：

```
td {
     word-wrap: break-word;
} 
```

# python - GDB 自动加载 Python 脚本

> ID：11851499
> 
> 赞同：6
> 
> 时间：2012-08-07T17:58:03.200
> 
> 标签：python, gdb

我正在尝试设置一个系统，我可以在其中将 python 脚本添加到目录中，并且下次加载`gdb`时它们将可以访问*（重点是将其放在版本控制中并允许其他工程师简单地访问我的帮助脚本）*。对于初学者，我已经编写了一个`hello.py`文件，当我输入**`source /path/to/hello.py`**,`gdb`然后输入`hello`它时，它会按预期工作。

如何让 GDB 自动执行此操作？文档建议使用数据目录，并将脚本放在`data-directory/python/gdb/command`. 将我的`hello.py`文件放在这个目录中没有任何作用（但它最终会创建一个`hello.pyc`文件）。

我还尝试将此目录添加到我的目录列表中`dir /path/to/hello/`，然后希望能够输入`source hello.py`，但这也失败了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T18:05:15.277

创建一个`.gdbinit`文件，然后将所有`source`命令放在您将要开始的同一目录中`gdb`。我相信该文件将如下所示：

**.gdbinit**

```
source /path/to/hello.py
source /path/to/foobar.py
etc, etc 
```

[参考](http://sourceware.org/gdb/onlinedocs/gdb/Startup.html)

编辑：`.gdbinit`在版本控制中包含文件将确保包含文件，而与全局`gdb`设置无关。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-22T20:13:25.030

我今天正在寻找同样问题的答案。最终我想出了以下几点：

**.gdbinit**

```
python
import glob

python_dir = "/path/to/python"

# Search the python dir for all .py files, and source each
py_files = glob.glob("%s/*.py" % python_dir)
for py_file in py_files:
    gdb.execute('source %s' % py_file)
end 
```

注意`.gdbinit`可以是`~/.gdbinit`或`./.gdbinit`; 见[`gdbinit(5)`](http://man7.org/linux/man-pages/man5/gdbinit.5.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T18:04:37.523

您需要`auto-load`使用以下命令进行设置：

```
set auto-load python-scripts on 
```

**参考**：http: [//sourceware.org/gdb/current/onlinedocs/gdb/Python-Auto_002dloading.html#Python-Auto_002dloading](http://sourceware.org/gdb/current/onlinedocs/gdb/Python-Auto_002dloading.html#Python-Auto_002dloading)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T20:43:14.720

似乎必须有更好的方法，但现在我做了以下。在 .gdbinit 中，我添加了：`source /path/to/setup_python.py`

然后我将文件 setup_python.py 写为：

```
#!/usr/bin/python
import glob
import os

# Search the python dir for all .py files, and source each
setup_dir = os.path.dirname(__file__)
python_dir = os.path.join(setup_dir, "python")
py_files = glob.glob("%s/*.py" % python_dir)

for py_file in py_files:
    gdb.execute('source %s' % py_file) 
```

这将获取 python 子目录中的所有文件，并且 setup_python.py 和这些文件都可以签入源代码控制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-26T04:11:45.090

不同但相似的问题：我告诉大家，在他们的主目录“~/.gdbinit”文件中，他们必须通过绝对路径加载一个常见的 python 模块。这只是一行，并不复杂。

你应该注意：有些人会称之为安全威胁，这是一种平衡行为——我必须信任我的团队，他们必须信任我。我是这样想的：我们都在处理尖锐的事情，我们必须了解我们在做什么。每个团队都是独一无二的，请使用您的判断力。

我还必须处理多个版本的 GDB，但需要处理一个通用的单个 .gdbinit 文件。例子; AndroidOLD(GDB)、AndroidNEW(GDB)、LinuxHost(GDB) 和 SomeOther(GDB)

人们整天使用不同的东西在项目之间切换，常见的脚本目录问题。我的主目录中有我自己的脚本

我依赖 GDB-Python 扩展

```
import os
import gdb 
```

在 Linux 上，我可以通过查看可执行文件的绝对路径来确定 GDB 的*确切*版本，因此：AndroidOLD(gdb) vrs AndroidNEW(gdb) 可以通过在路径中查找版本号来确定。

```
exename = os.readlink( '/proc/self/exe' ) 
```

我还可以使用这些项目来确定主机类型（cygwin、linux、mac 等）以及有关目标架构的更多详细信息（即：哪个 android cpu 目标？）

```
print (gdb.HOST_CONFIG)
# gives: x86_64-linux-gnu
# Alternates: MACOS, or CYGWIN32 or CYGWIN64
print (gdb.TARGET_CONFIG)
# Gives: 64bit android, 32bit android, or something else 
```

现在，更多的是原始海报问题：一个包含大量脚本的公共目录

1.  我有多个“公共目录”
2.  我必须处理不同的架构
3.  我的人在项目之间切换
4.  并在版本之间切换

一些项目系统有一个项目或模块的公共根目录（即：Android），所有子组件都是该公共目录的子目录。使用 python - 您可以从当前目录开始，然后一次爬上目录树，直到找到一些能告诉您更多信息的神奇文件（例如，一些标识 android 构建的根目录的文件）

现在我知道了所有这些，我可以遍历我需要通过以下方式加载的文件：

```
import gdb
gdb.execute('source %s' % filename) 
```

问题解决了。

# java - 检测由某些单词组成的段落的可能性

> ID：11851500
> 
> 赞同：2
> 
> 时间：2012-08-07T17:58:11.770
> 
> 标签：java, machine-learning, data-mining

这是一个家庭作业。我不一定要寻找确切的解决方案，而是寻找开放的答案和可能的策略。我有一组段落和一组单词。我需要检测这些段落中的哪些可能包含**某些关键字**并输出这些段落的标题

蛮力方法是进行简单的字符串匹配并检查段落是否包含所需的字符串，但我认为这根本不是一个很好的解决方案。此外，作业要求我确定文章是否**可能**包含关键字，这基本上意味着将涉及某种机器学习/数据挖掘。

您的所有意见都受到高度重视，非常感谢！

PS：如果重要的话，我将使用 Java 编程语言来解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T21:44:47.857

我不确定我是否正确理解了您的任务，但您可以使用 Bloom 过滤器。

布隆过滤器是一种概率数据结构：它告诉我们元素要么肯定不在集合中，要么可能在集合中。

[在guava 库页面](http://code.google.com/p/guava-libraries/wiki/HashingExplained)上查看它的解释或[玩一个简单的实现](http://llimllib.github.com/bloomfilter-tutorial/)来看看它是如何工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:05:55.953

您可以通过使用 Lucene 来做到这一点。

以下是一些稍微高级的参考：

[http://www.cnlp.org/apachecon2005/AdvancedLucene.ppt](http://www.cnlp.org/apachecon2005/AdvancedLucene.ppt)

[http://www.cs.nmsu.edu/~tphan/publications/trec07.pdf](http://www.cs.nmsu.edu/~tphan/publications/trec07.pdf)

[http://stp.ling.uu.se/~joerg/paper/tema05-final.pdf](http://stp.ling.uu.se/~joerg/paper/tema05-final.pdf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:06:32.727

机器学习/数据挖掘方法将需要您没有提到的大量数据（训练数据）。

**可能**的词可能建议使用某种形式的模式匹配（更轻松的一种，而不是确切的词）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T18:28:53.003

我曾经有一项任务，其中包括为一组给定的文档构建一个搜索引擎。我们将解析它们并构建一个倒排索引，然后使用余弦度量来执行使用关键字的查询。我们还有一个停用词列表，并将所有关键词转为小写。

[这是一些基本理论](http://www.slideshare.net/mcjenkins/the-search-engine-index-presentation)，并参考了更高级的材料。

# arrays - PowerBuilder - 字符串到数组的转换

> ID：11851501
> 
> 赞同：3
> 
> 时间：2012-08-07T17:58:11.567
> 
> 标签：arrays, string, powerbuilder

我在 PowerBuilder 中有字符串：

```
string test_string = "1,2,3,4,5" 
```

我想将其转换为数组：

```
 string array[] = {'1','2','3','4','5'} 
```

怎么做？

// 感谢帮助 ：）

我这样做：

```
 string string_to_edit = "1,2,3,4"
    string array[], string_now
    long arraylen, stringlen, place_nbr, i, place_tt

    stringlen = len(string_to_edit)
    DO WHILE  stringlen > 0 
        place_nbr = pos(string_to_edit, ",")
            IF place_nbr > 0 THEN
                place_tt = place_nbr - 1
                string_now = Mid(string_to_edit,0,place_tt)
                string_to_edit = RIGHT(string_to_edit,stringlen - place_nbr)
                stringlen = stringlen - place_nbr
            ELSE
                string_now = string_to_edit
                string_to_edit = RIGHT(string_to_edit,stringlen - place_nbr)
                stringlen = 0
            END IF
        string_now = trim(string_now)
        arraylen = UpperBound(array)
        array[arraylen+1] = string_now
    LOOP 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T00:59:54.687

您可以通过查看它在 PFC 中的完成方式（of_parsetoarray() 函数）获得灵感：

[https://pfc.svn.codeplex.com/svn/12.0/pfcapsrv/pfc_n_cst_string.sru](https://pfc.svn.codeplex.com/svn/12.0/pfcapsrv/pfc_n_cst_string.sru)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T18:40:01.870

您可以对字符串使用任何 gettoken 算法。PB 中的数组会自动增长。例如

```
string array[]
array[UpperBound(array)+1] = NextToken(test_string,',') 
```

自己写`NextToken`函数，或者循环`Pos(test_string, ',', iFrom)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-12T16:56:15.767

1) 使用由单个文本列组成的外部数据源创建一个数据窗口。

2) 声明一个创建数据存储并将数据窗口对象从上面的 1 分配给它。

3) 使用 Importstring 方法将字符串插入数据存储区。此方法接受逗号分隔的字符串（CSV 的 ImportType！）。它还返回插入的行数。

4) Loop through the rows in the datastore and insert the values into the array.

# javascript - 使用 Google Chart 在条形图中设置颜色

> ID：11851503
> 
> 赞同：2
> 
> 时间：2012-08-07T17:58:13.730
> 
> 标签：javascript, google-visualization

我正在寻找一种根据值在条形图上显示不同颜色的方法。

我有这样的事情：

```
 for(var i=0; i<table.length;i++){
        colors[i]=new Object();
        if (table[i][1]<=300){
            colors[i].color='blue';
        }
        else if (table[i][1]<=800){
            colors[i].color='yellow';
        }
        else{
            colors[i].color='red';
        }
    } 
```

所以“颜色”是一个对象数组，每个对象都有一个色域。然后我这样做：

```
 var options = { series: colors}; 
```

但这不起作用。所以我做了如下更简单的测试：

```
 colors: ['black','blue','white','blue','blue','blue','blue'] 
```

不起作用：整个图表只采用第一种颜色。

```
 series: [{color:'black'},{color:'blue'}] 
```

一样的效果。

任何人都可以帮我做吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T19:26:24.770

我刚刚找到了这段代码：http: [//jsfiddle.net/asgallant/QHJA6/](http://jsfiddle.net/asgallant/QHJA6/)

# c++ - 保护 C++ RPG 游戏中的存储数据

> ID：11851506
> 
> 赞同：2
> 
> 时间：2012-08-07T17:58:39.137
> 
> 标签：c++, storage, sfml, data-protection

我目前正在 Windows 上使用 C++ 和 SFML 开发 RPG 游戏。目前它运行良好，但是当我检查所有内容时，我意识到由于所有数据（如物品、库存、生物、战斗、NPC、商店等）都存储在文本文件中，因此使用任何文本都可以非常简单地操作它们编辑。

我想至少防止这些数据被轻易操纵。显然，只要数据与版本一起存储，就会有人通过并能够对其进行编辑。

我想知道保护这些数据的最佳途径是什么，同时仍然保持使用将来构建的工具（例如地图编辑器、项目编辑器、NPC 编辑器等）以及引擎对其进行编辑的能力本身。

我非常喜欢自己写，并就如何最好地完成它获得一些想法，因为我主要使用它来更好地学习语言。如果有人真的认为这是愚蠢的，请告诉我，以便我考虑使用可选库。

如果您稍后再做，我将不胜感激任何可以推荐一个好的供我使用的人。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T18:04:00.807

> 我想知道保护这些数据的最佳途径是什么，同时仍然保持使用将来构建的工具（例如地图编辑器、项目编辑器、NPC 编辑器等）以及引擎对其进行编辑的能力本身。

我认为没有最好的解决方案。最简单的一种可能是加密文件，硬编码密钥以在游戏中解密它们。不过，这不会阻止对二进制文件进行逆向工程以恢复密钥。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T18:07:34.770

让您的游戏引擎以文本和二进制格式读取文件。二进制格式可以像在文件目录上使用 zip 压缩一样简单。然后您可以对二进制文件实施校验和。

对于开发，您将使用文本版本，但在现场游戏中，您只允许读取二进制格式，并且您拒绝校验和失败的文件。

这不是超级安全，因为有人会对校验和进行逆向工程。但它会阻止临时用户编辑您的游戏数据。您可以通过让游戏客户端根据服务器上已知的良好校验和验证游戏数据校验和来使这更加安全。

# php - Amazon FPS CBUI 返回 URL 验证 - PHP

> ID：11851508
> 
> 赞同：0
> 
> 时间：2012-08-07T17:58:46.637
> 
> 标签：php, amazon, amazon-fps

我正在尝试浏览 PHP 的 Amazon FPS 快速入门指南，但无法验证 CBUI 提供的返回 url。

这是网址：

```
http://local-screen.com/wp-content/plugins/lclscrn_projects/amazon_fps/FPS/ReturnUrlVerificationSampleCode.php?tokenID=N1G9E5I7BH72563866UZ23YZ1X1AL9AZ2A9291Q1PKDATS8R7BLZ6Y7LEHY2QRHS&signatureMethod=RSA-SHA1&status=SC&signatureVersion=2&signature=WbBPFQku5BA67CR9vWr664eLNDahErYWZM6GrOYTnlDmLZf0rBm0XATrGPLgj5V94GsP0n%2BJ0uye%0A0MRZ3gastZX9M0cjbaPBcCjW1ydt%2BtCiatd%2BjQA6ZRs7XD%2BmWMqHVT3b4eY5WXKHHHQIvp4xLjJY%0AxuwtLf4MaYuiATtdnCY%3D&certificateUrl=https%3A%2F%2Ffps.sandbox.amazonaws.com%2Fcerts%2F090911%2FPKICert.pem%3FrequestId%3Dbjyk7pqb789b33qxg4h9lx8kn8ijplnc5pow0ycey00olslowmv&expiry=01%2F2018&callerReference=%241%24yo8s 
```

这是我得到的错误：

```
Verifying return url signed using signature v2 .... 
Fatal error: Uncaught exception 'Amazon_FPS_SignatureException' with message 'Certificate could not be verified by the FPS service' in /home/content/85/9687085/html/wp-content/plugins/lclscrn_projects/amazon_fps/FPS/SignatureUtilsForOutbound.php:103 Stack trace: #0 /home/content/85/9687085/html/wp-content/plugins/lclscrn_projects/amazon_fps/FPS/SignatureUtilsForOutbound.php(50): Amazon_FPS_SignatureUtilsForOutbound->validateSignatureV2(Array, 'http://local-sc...', 'GET') #1 /home/content/85/9687085/html/wp-content/plugins/lclscrn_projects/amazon_fps/FPS/ReturnUrlVerificationSampleCode.php(93): Amazon_FPS_SignatureUtilsForOutbound->validateRequest(Array, 'http://local-sc...', 'GET') #2 /home/content/85/9687085/html/wp-content/plugins/lclscrn_projects/amazon_fps/FPS/ReturnUrlVerificationSampleCode.php(97): Amazon_FPS_ReturnUrlVerificationSampleCode::test() #3 {main} thrown in /home/content/85/9687085/html/wp-content/plugins/lclscrn_projects/amazon_fps/FPS/SignatureUtilsForOutbound.php on line 103 
```

这是获取变量并调用验证页面的函数：

```
public static function test() {

                $aws_access_key = self::$aws_access_key;
                $aws_secret_key = self::$aws_secret_key;

                $utils = new Amazon_FPS_SignatureUtilsForOutbound($aws_access_key, $aws_secret_key);

                /* Verification of an return url signed using signature version 2.*/

                // New parameters sent in return url signed using signature v2
                $params["certificateUrl"] = self::$certificate_url;
                $params["signature"] = self::$signature;
                $params["signatureMethod"] = self::$signature_method;
                $params["signatureVersion"] = self::$signature_version;

                // foreach ($params as $param) {
                //         echo $param;
                //         echo '<br/><br/>';
                // }
                // echo self::$return_url;
                // return;

                $urlEndPoint = self::$return_url; //Your return url end point. 
                print "Verifying return url signed using signature v2 ....\n";
                //return url is sent as a http GET request and hence we specify GET as the http method.
                //Signature verification does not require your secret key
                print "Is signature correct: " . $utils->validateRequest($params, $urlEndPoint, "GET") . "\n";
    } 
```

我还有 foreach 循环的输出，如果有人需要，我可以在上面进行 PM。我只是不明白为什么我不能验证这个网址。任何帮助将不胜感激。

缺口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-03T07:20:52.773

我也在使用来自 Amazon 的 PHP 示例代码，并且遇到了完全相同的错误消息。

**解决方案**

**要求 1：**您在 VerifySignature 请求中传递的值`HttpParameters`必须具有与亚马逊 UI 传递给您的返回 URL 的顺序相同的参数。因此，无需像亚马逊的示例代码那样手动获取每个 GET 参数，只需将对象`$_GET`用作.`$parameters``SignatureUtilsForOutbound.php`

**要求 2：**您需要从可在 Internet 上访问的盒子中进行测试。如果您从 localhost 进行测试，您将始终收到此错误。

# jquery - Jquery 嵌套动态创建的 Droppables

> ID：11851509
> 
> 赞同：0
> 
> 时间：2012-08-07T17:58:46.770
> 
> 标签：jquery, jquery-ui-sortable, jquery-ui-draggable, jquery-ui-droppable

我正在尝试创建一个页面，您可以在其中将可放置的 div（类间距 2）拖放到可放置的 div（类间距 1）中，然后将控件拖动到间距 2 中。我可以将控件放入间距中，但无法将任何内容放入间距2。

[http://jsfiddle.net/dan2012/FCT3m/](http://jsfiddle.net/dan2012/FCT3m/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:41:51.393

我将 droppables 更改为 sortables，并且一次只启用其中一个。

# javascript - 如何水平对齐 div，例如其中的文本被省略

> ID：11851511
> 
> 赞同：0
> 
> 时间：2012-08-07T17:58:55.767
> 
> 标签：javascript

我有 2 个 div，其中有一些文本。它们被封装在具有固定高度和宽度的父 Div 中。如果文本溢出到父 div 之外，我想省略文本。

这是我的 HTML

```
<html>
<head>
    <style>

    .pDiv {
        width:50px;
        height:20px;
        border: 1px  solid red;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .div1 {
        position: relative;
        float: left;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    .div2 {
        position: relative;
        float: left;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    </style>
</head>
<body>
    <div class ='pDiv'>
        <div class ='div1'>test testing</div>
        <div class ='div2'>test1</div>
    </div>

</body>
</html> 
```

如果 div1 文本很长或 div2 文本很长，我希望文本被省略。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:09:54.110

省略号没有显示，因为 div1 和 div2 没有分配给它们的宽度，因此它们不知道从什么时候开始截断/缩写。也许您可以为每个分配 100% 的宽度。也就是说，如果您同时添加 `width:100%` 这两个类，您会在文本中看到省略号。

我建议查看以下链接：[http](http://www.quirksmode.org/css/textoverflow.html) ://www.quirksmode.org/css/textoverflow.html ，其中描述了问题及其要求。

# linux - xampp linux中的虚拟主机设置

> ID：11851513
> 
> 赞同：1
> 
> 时间：2012-08-07T17:59:05.070
> 
> 标签：linux, apache, phpmyadmin, xampp, vhosts

有人可以帮我在 XAMPP、Linuxmint 中配置虚拟主机。

Xampp 启动正确，我看到 xampp 橙色启动页面.. 没关系。**我在' /opt/lampp/etc/extra** '目录中打开了vhosts文件并添加了以下代码

```
<VirtualHost 127.0.0.2:80>
    DocumentRoot "/opt/lampp/htdocs/test/public_html"
    ServerName test.dev
</VirtualHost> 
```

还打开了“ **etc/hosts** ”并添加了这个：

```
127.0.0.2 test.dev 
```

重新启动 XAMPP...

但是结果，当我去 test.dev 或 127.0.0.2 是相同的橙色启动页.. 所以它显示 127.0.0.1..

还有 http://localhost/phpmyadmin/

说：

```
Access forbidden!

New XAMPP security concept:

Access to the requested object is only available from the local network.

This setting can be configured in the file "httpd-xampp.conf".

If you think this is a server error, please contact the webmaster.

Error 403

localhost
Apache/2.4.2 (Unix) OpenSSL/1.0.1c PHP/5.4.4 
```

任何帮助将不胜感激！

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T14:46:52.553

解决了。

刚刚取消注释 httpd.conf 中的字符串：

```
# XAMPP 
#Include etc/extra/httpd-vhosts.conf 
```

# ruby-on-rails - jQuery 从不同页面提交 AJAX 表单

> ID：11851519
> 
> 赞同：0
> 
> 时间：2012-08-07T17:59:51.903
> 
> 标签：ruby-on-rails, ajax, jquery

我有一个 Rails 3.0 应用程序，它具有完美的 AJAX 化表单。对于每个输入字段，我使用 jQuery 绑定表单的 submit() 操作：

```
$("#profile_form :input").live('change', function() {
$("#profile_form").submit();
}); 
```

在这个表格的另一部分，我有一个弹出对话框；它在新窗口中打开。当它的工作完成后，我希望它命令这个表单提交。但是，它没有按预期工作：

```
var doc = window.opener.document;
$("#profile_form", doc).submit(); 
```

它不是将表单作为 JS 提交，而是作为 HTML 提交，并且页面在后台刷新为空白而不是原位（值得注意的是，在这两种情况下，操作都已完成并保存了新数据。所以无论如何） .

我尝试强制表单本身作为 Javascript 提交（在表单操作的 :url 哈希中使用 :format => :js），但随后页面刷新以显示更新操作中的原始 Javascript。

我理解有一些我可能违反的安全策略，试图从不同的页面提交表单。但我不禁想到有办法解决这个问题。有什么建议么？

# matlab - 内存错误：乘以大矩阵

> ID：11851520
> 
> 赞同：0
> 
> 时间：2012-08-07T18:00:09.020
> 
> 标签：matlab, matrix, out-of-memory, matrix-multiplication

A、B、C 和 D 是 361x361x120 双矩阵。当我尝试执行以下计算时出现内存不足错误：

```
Result = (A.*B)+(C.*D); 
```

不幸的是，这些必须是双倍的，我需要以下结果来进行其余的计算。我试过分离加法步骤，但它卡在第一个乘法（A * .B）上。有没有办法进一步分解这些步骤以避免内存问题？

谢谢！

-N。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T00:02:53.103

您的命令似乎等同于：

```
 C = nan(361,361,120);
    for i = 1:361;
      for j = 1:361;
         C(i,j,:) = rand(120,1) .* rand(120,1);
      end
    end 
```

除了这个命令使用更少的内存

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T21:38:12.683

发生的情况是，您的每个`A`、`B`、`C`和`D`矩阵都需要：`361*361*120*8`bytes (or `119`MB) of **contiguous memory**。当您执行`Result = (A.*B)+(C.*D);`时，两个中间结果和最终结果中的每一个也将需要相同数量的内存（尽管中间结果会在之后立即释放）。在高峰期，它需要 6 到 7 个连续内存块的空间，每个内存块大小为 119MB。（请记住，*碎片*如何影响任何时间点的最大可能分配矩阵的大小）

如果您没有足够的内存来保存以上所有内容，请`clear`尽快重写表达式以重用现有变量和不再需要的变量。

否则，不要一次在内存中加载/存储所有数据。新版本的 MATLAB 允许您使用新`matfile`函数加载/保存部分 MAT 文件。您将使用 for 循环在块中计算结果。

其他想法：如果您的数据包含很多零，请考虑使用稀疏矩阵。您还真的需要双精度吗，您可以改用`single`类型将所需的内存减半。

当然，您总是可以转移到安装了 MATLAB 的 64 位机器上，并购买尽可能多的 RAM :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:42:19.570

因为您正在执行逐个元素的乘法，所以您可以使用循环简单地拆分操作。下面是如何将 A 和 B 相乘并将结果保存到矩阵 C 的示例：

```
A = rand(361, 361, 120);
B = rand(361, 361, 120);
C = nan(361,361,120);

for i = 1:size(A,1);
  for j = 1:size(A,2);
     C(i,j,:) = A(i,j,:) .* B(i,j,:);
  end
end 
```

您应该能够使其与单个循环而不是两个嵌套循环一起工作。

我不确定您为什么会出现内存不足错误，因为以下在我的机器上执行得很好。此外，乘法不需要太多内存。

```
A = rand(361, 361, 120);
B = rand(361, 361, 120);
C = rand(361, 361, 120);
D = rand(361, 361, 120);

E = (A.*B) + (C.*D); 
```

# c# - jQuery在列和顺序内自动完成搜索

> ID：11851523
> 
> 赞同：0
> 
> 时间：2012-08-07T18:00:26.797
> 
> 标签：c#, jquery, autocomplete, ashx

我有 jQuery Autocomplete（不是 jQueryUI）来在我的数据库中搜索 fname 和 lname。现在它可以搜索名字然后过滤掉并搜索姓氏，这很棒。但是有没有办法反过来呢？

IE。搜索 Crystal 会出现 Crystal Santos、Crystal Wickers、Crystal Hayes 等，
但搜索 Santos 会出现 Santos Rameros、Santos Riveria 等（假设 Santos 是 fname）

有没有办法改变这个？让它过滤 fname 和 lname。

我也可以让它在列中搜索吗？我有一个过滤部门，但有些部门有多个值。它只会在移动到第二个之前搜索第一个。

IE。搜索医疗办公室控制器，您必须先搜索 MEDICAL。您无法搜索 Controller 或 Office 并让它显示该结果。

请告诉我是否需要澄清。

处理程序 ASHX

```
public void ProcessRequest (HttpContext context) {
    string prefixText = context.Request.QueryString["q"];
    using (SqlConnection conn = new SqlConnection())
    {
        conn.ConnectionString = ConfigurationManager.ConnectionStrings["Rollup2ConnectionString"].ConnectionString; 
        using (SqlCommand cmd = new SqlCommand())
        {
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.CommandText = "SP_AUTOCOMPLETE";                           
            cmd.Parameters.Add(new SqlParameter("@SearchText", SqlDbType.VarChar));      
            cmd.Parameters["@SearchText"].Value = prefixText;             
            cmd.Connection = conn;           
            StringBuilder sb = new StringBuilder();      
            conn.Open();           
            using (SqlDataReader sdr = cmd.ExecuteReader())           
            {               
                while (sdr.Read())   
                {                    
                    sb.Append(sdr["NUID"].ToString() + " ").Append(sdr["FNAME"].ToString() + " ").Append(sdr["LNAME"].ToString() + " ")                       
                        .Append(Environment.NewLine);          
                }        
            }            
        conn.Close();            
        context.Response.Write(sb.ToString());  
        }

    }
}

public bool IsReusable {
    get {
        return false;
    }
} 
```

这是当前 fname lname 的一个，除字段更改外，department 的一个完全相同。

存储过程名称

```
@SearchText VARCHAR(255)
AS
BEGIN

SET NOCOUNT ON;
SELECT RTRIM(NUID) NUID, RTRIM(FNAME) FNAME, RTRIM(LNAME) LNAME 
FROM T_USER 
WHERE NUID like @SearchText + '%' OR FNAME like @SearchText + '%' OR LNAME like @SearchText + '%'

END 
```

存储过程部

```
@SearchText VARCHAR(255)
AS
BEGIN

SET NOCOUNT ON;
SELECT RTRIM(DEPT_DESC) DEPT_DESC, RTRIM(DEPT_ID) DEPT_ID
FROM T_ROLLUP_DEPT
WHERE DEPT_ID like @SearchText + '%' OR DEPT_DESC like @SearchText + '%' 
```

结尾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:12:15.757

这更像是一个数据库问题。你需要回到你的存储过程并添加一个 OR 子句是 WHERE 说

```
WHERE (FNAME LIKE '%SearchText%') OR (LNAME LIKE '%SearchText%') 
```

调整好SQL语句后，当你输入“Santos”时，你现在会得到Crystal Santos、Santos Rameros、Santos Riveria等。

您问题的第二部分还需要调整您的 SQL 存储过程。只需将 LIKE '%%' 添加到您的 WHERE 子句中。因此，如果您的用户搜索“Controller”，就会出现医疗控制官。

# twisted - twistd 不会给我一个 shell 提示或日志

> ID：11851525
> 
> 赞同：1
> 
> 时间：2012-08-07T18:00:29.937
> 
> 标签：twisted

我正在调用一个扭曲的python程序：

```
twistd -l twisted.log -y controller.py 
```

根据我读过的所有文档：

*   l 应该将 STDERR 的输出定向到日志文件
*   你应该守护它，并给我一个shell提示符

反而：

*   日志文件保持不变
*   所有调试内容都转到 stderr（来自“导入日志记录”）
*   该应用程序不会守护进程（所以我必须保持登录状态）

有人可以指出我正确的方向吗？谢谢。

* * *

编辑：

tac 包含以下内容：

```
from twisted.internet import protocol, reactor  
from twisted.application import service  

application = service.Application('myapp daemon')  

dbUpdateService= DbUpdater_UpdateService()  
dbUpdateService.setServiceParent(application)  
dbUpdateService.startService()  

# repeat with 3x services  

reactor.run() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:04:41.167

看起来你使用不`twistd`正确。

1.  该`-y`选项读取`.tac`文件，而不是`.py`文件。从技术上讲，a`.tac`也是 Python 源代码，但它有一些额外的规则，它不应该是一个模块。[这里](http://twistedmatrix.com/documents/current/core/howto/application.html)有一些解释。
2.  该选项从而不是`-l`发送输出。`twisted.python.log``logging`
3.  您的应用程序可能没有守护进程，因为您正在执行不应该执行的随机 crud `controller.py`（该文件在守护进程之前执行），但您没有附加`controller.py`，所以我真的不知道。

请就您将来实际在做什么提出更详细的问题。如果您的应用程序没有任何代码，以上内容大多是猜测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T20:48:15.343

这可能不会解决守护进程问题，但是关于您的日志文件，您使用的是 twisted.python.log 吗？将 log.msg 和 log.err 用于与日志相关的输出。查看[http://twistedmatrix.com/documents/current/core/howto/logging.html](http://twistedmatrix.com/documents/current/core/howto/logging.html)

哦，如果你使用的是 twistd，你也不需要调用 log.startLogging。

# c# - WindowsIdentity.Impersonate 我需要本地管理员权限吗？

> ID：11851533
> 
> 赞同：1
> 
> 时间：2012-08-07T18:01:19.617
> 
> 标签：c#, .net-3.5, permissions

我有一个以 FullTrust 权限运行的 .NET 3.5 应用程序。我想使用模拟来读取网络共享上的文件。应用程序在登录用户的上下文中运行，并且该用户不是管理员。我的同事说，为了使用不同的凭据登录服务器，需要本地管理员权限。它是否正确？

到目前为止有用的链接：

[http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:12:19.223

我不这么认为，当您尝试连接到共享驱动器时，大多数共享驱动器都会要求进行身份验证。我记得我从公司域中取出我的计算机，然后通过 C# 应用程序使用另一个凭据（不是管理员，但有权访问驱动器）连接共享驱动器。为此，我只使用了`PrincipalContext(ContextType.Domain)`凭据 UI 弹出。

因此，您的第一个检查清单是确保您的帐户有权访问网络共享。

# asp.net-mvc-4 - 返回部分视图的 Web API 方法

> ID：11851535
> 
> 赞同：2
> 
> 时间：2012-08-07T18:01:19.593
> 
> 标签：asp.net-mvc-4, partial-views, asp.net-web-api

我正在阅读一个在线项目的要求。这是关于 asp.net Web API 的。要求是一个 api 方法 /ui/echo/，它回显作为参数传递给它的任何字符串，当调用它时，将响应 UI HTML partial `<b>Put echo string here</b>`。

我在互联网上阅读了有关[RazorMediaTypeFormatter](https://gist.github.com/1926431)的信息。web api还有其他方法可以返回部分视图吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T15:07:36.943

我会查看开源项目[MvcMailer](https://github.com/smsohan/MvcMailer)，了解如何将 Razor 视图呈现为字符串，然后将其放入对 REST 请求的响应中。MvcMailer 使用 Razor 视图将电子邮件正文呈现为 HTML。由于 ASP.NET Web API 是 MVC 4 的一部分，它应该很好地集成。我在 MVC 4 项目中使用了 MvcMailer，它工作正常。查看[StringResult.ExecuteResult](https://github.com/smsohan/MvcMailer/blob/master/Mvc.Mailer/StringResult.cs)。这似乎是将 View 呈现为字符串的代码的核心。从未尝试在 REST 结果中返回 HTML，[通常不鼓励这样做](http://broadcast.oreilly.com/2011/06/the-good-the-bad-the-ugly-of-rest-apis.html)。根据[此 QA](https://stackoverflow.com/questions/652997/in-jquery-i-am-returning-html-in-a-json-result-what-do-i-have-to-escape)，您需要在将结果作为 JSON 发送回之前对 HTML 进行编码。[这里有一些关于如何返回 HTML 结果](https://stackoverflow.com/questions/1148266/ajax-html-vs-xml-json-responses-perfomance-or-other-reasons)的很好的讨论。

# select - 如何使用 Selenium IDE 在表中选择一行

> ID：11851537
> 
> 赞同：0
> 
> 时间：2012-08-07T18:01:22.973
> 
> 标签：select, selenium, row, selenium-ide

我想在表格中选择一行，然后继续使用表单的下一步按钮，但是当我执行该行时

```
click  |  //div[@id='grilleRepresentant']/table/tbody/tr/td[1]/span 
```

我有一个错误。

# c# - C# @ 运算符（不适用于字符串文字）

> ID：11851540
> 
> 赞同：16
> 
> 时间：2012-08-07T18:01:32.603
> 
> 标签：c#

这意味着什么`@`（我知道它使用的是过时的 .NET Framework 1.1 ConfigurationSettings.AppSettings）？

```
@ConfigurationSettings.AppSettings["some_setting"]; 
```

这不是字符串文字：[将文字“@”与字符串变量一起使用](https://stackoverflow.com/questions/120763/using-the-literal-with-a-string-variable)

实际代码：

```
_scale_id_regex = @ConfigurationSettings.AppSettings["ScaleIdRegEx"]; 
```

在作为 Windows 服务一部分的常规 .cs 文件中，它`_scale_id_regex`只是类中的私有字符串，因此不涉及 ASP.NET 和 Razor。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-07T18:03:58.430

它被称为*逐字标识符*。它允许您在保留字之后命名变量。例如

```
string @string = string.Empty;
object @object = new object();
int @int = 1;
... 
```

您拥有的代码是有效的，但我不相信`@`那里有任何真正的目的。由于这比我刷新页面的速度更快，这就是 ECMA C# 语言规范第 9.4.2 节所说的内容。

> 前缀“@”允许使用关键字作为标识符，这在与其他编程语言交互时很有用。字符 @ 实际上不是标识符的一部分，因此标识符在其他语言中可能被视为普通标识符，没有前缀。带有@ 前缀的标识符称为逐字标识符。

您发布的代码是有效的，因为语言规范允许这样做，尽管不鼓励这样做。

> [注意：允许对不是关键字的标识符使用 @ 前缀，但出于风格考虑，强烈建议不要这样做。尾注]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T18:04:36.547

您可以为标识符添加前缀，`@`以便将它们与保留字等区分开来：

```
var @class = 1; 
```

（@class，例如，os主要用于razor视图中指定css类。否则，避免使用这样的名称:)

在 LINQ 中也很有用，例如`from @group in...`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T18:06:04.247

## 前体：

**不要对此投反对票，**因为问题说这是在普通`.cs`班级。在我写这篇文章的时候，问题中没有任何内容表明这不包括在剃刀视图中。在没有上下文的情况下，这种情况会**更有**意义。

我在这里保留这个答案，以防其他用户到这里寻找`@`可能会做的事情。

## 回答：

`.cshtml`它是一种从剃刀视图 ( )访问服务器端变量和方法的方法。它非常常用于：

1.  读取会话变量：

    `@Session["something"]`

2.  访问 Html 辅助方法

    `@Html.RenderPartial("someview","somecontroller");`

3.  完全按照您的问题去做（尽管我个人认为这是不好的做法）

    `@ConfigurationManager.AppSettings["whatever"];`

4.  启动代码块并使用类似的东西`foreach`

    ```
    @{
        foreach(var item in Model)
        {
            <span class="modelProperty">@Model.SomeTextProperty</span>
        }
    } 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T18:06:56.977

这里的“@”符号实际上根本不是 C# 运算符。它标志着 ASP.NET [Razor 语法](http://haacked.com/archive/2011/01/06/razor-syntax-quick-reference.aspx)代码块的开始。（但是，当然，您的代码块中有 C#。）

# javascript - JavaScript 中的竞争条件

> ID：11851541
> 
> 赞同：0
> 
> 时间：2012-08-07T18:01:33.160
> 
> 标签：javascript, jquery, jquery-events, race-condition

在我的 Web 应用程序中，我为文本框定义了一个更改事件，该事件正在调用 ajax 方法并将文本框值存储到会话中。我有一个名为“test”的按钮，它将检查文本框中输入文本的验证，它从会话中获取字符串并进行验证。

```
<html>
<head>  
<script type="text/javascript">
$(document).ready(function(){    
    $("input", form).change(function() {
            //using ajax to store the text value to session
        });

    $("#validateAmt").click(function() {
            //using another ajax to check the value stored in session
        });
});
</script>
</head>
<body>
  <input type="text" id="amount">
  <input type="button" id="validateAmt" value="validate"/>
</body>
</html> 
```

但是有时发生的情况是，当我在文本框中输入内容并且没有单击外部任何地方时，如果我直接单击“测试”按钮，则按钮事件首先触发（在会话中使用旧值进行验证）和文本框更改事件触发。所以目前我想在 JavaScript 中使用布尔标志并调用第一个文本框更改事件。这种情况有什么有效或好的解决方案吗？以及这些方法将如何执行？它会并行发生还是一个接一个地发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T22:42:07.687

默认情况下，Ajax 请求是异步执行的，因此您无法保证哪个请求将在何时发送。由于`change`应该在之前触发`click`并且所有 javascript 都在单个上执行，因此您可以：

*   `$.ajax`使用该选项拨打电话`{ async : false }`，但这会使您的电话阻塞

*   您跟踪正在运行的 Ajax 查询，并在前一个 ajax 查询完成时执行剩余的 ajax 查询

这是保持异步行为的可能解决方案：

```
​Service=new function(){
  var onGoingAjax = null;
  var onComplete = null;

  this.change = function () {
    // Cancel previous call
    if (onGoingAjax) onGoingAjax.abort();
    // Run the new Ajax call
    onGoingAjax = $ajax( { /* options */ });
    onGoingAjax.done( function() {
      // mark the ajax call as finished
      onGoingAjax=null;
      // process the second call (if any)
      processComplete();
    });
  };

  this.click = function (){
    endFunc = function() { $ajax( { /* options */ }); };
    processComplete();
  };

  function processComplete()
  {
    // check if ajax still executing => the skip this call
    if (onGoingAjax != null) return;
    // check if a complete function is set => call it
    if (onComplete) onComplete();
    // reset the complete function
    onComplete = null;
  };
}()​;

$(document).ready(function(){
  $("input", form).change(Service.change);
  $("#validateAmt").click(Service.click); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:13:26.510

不要依赖更改事件总是在其他事情发生之前触发。在发送到服务器之前始终验证您的数据（并且始终在服务器上进行验证）。

如果验证成本很高（例如，它需要一个 ajax 调用），那么您可以添加一个优化来跟踪特定值是否已经过验证，但这只是性能优化，而不是您的核心逻辑的一部分。

# django - 在Django中导航时如何防止浏览器重新填充表单数据

> ID：11851545
> 
> 赞同：4
> 
> 时间：2012-08-07T18:01:50.330
> 
> 标签：django, forms, caching, django-forms

我有一个将数据提交到数据库的 django 表单。成功填写表单并提交数据后，表单将重定向到另一个页面。但是，当用户点击浏览器上的后退按钮时，数据会返回。

有没有办法防止数据返回？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T18:05:25.510

将此添加到您的 HTML 中，它不会缓存：

```
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, post-check=0, pre-check=0" /> 
<meta http-equiv="Pragma" content="no-cache" /> 
```

如果你想要一个 Django 特定的答案。试试这个，虽然结果应该是一样的：

```
response = HttpResponse()  # Created a HttpResponse
response['Cache-Control'] = 'no-cache'  # Set Cache-Control Header 
```

# random - 在具有给定均值的二项分布上生成整数

> ID：11851550
> 
> 赞同：1
> 
> 时间：2012-08-07T18:02:31.260
> 
> 标签：random, statistics

我正在编写代码来创建模拟行为。作为其中的一部分，我知道我想每分钟模拟 X 个事件。我不想每秒只做 x/60 个事件。相反，我想将这些事件分布在最终平均为 x/60 的二项分布中。

这些是事件，所以我们只处理整数。当然，分发不一定是完美的。只是比全天一致的 N-per-second-every-second-all 更现实的东西。

两个问题：

1）是否有任何伪代码或公式可以帮助我更好地计算这些数据集，而不仅仅是我自己在 excel 中的调整？

2) 是否有任何我误用的术语（可能全部）可以帮助我更好地找到答案？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:01:23.350

您（可能）实际上要求泊松过程（不是二项式）-当每单位时间发生事件的概率一致时出现的分布。这种分布在排队论中出现了很多，所以那里的参考资料可以提供帮助。

生成这些最简单的方法是生成事件之间的时间间隔：

```
generate_time_interval_in_seconds( X=mean_events_per_minute )
    dt=-(60.0/X)*log( random_number_generator() )
    return dt 
```

`random_number_generator()`在 中返回一个伪随机数`0-1`。取`-log(.)`它会产生一个呈指数分布的随机数，其平均值为`1`。缩放这个`60.0/X`给我们一个指数分布的变量，其平均值是事件之间的平均间隔。

然后确定这一分钟发生了多少次：

```
count=0
T=generate_time_interval_in_seconds(X)
while( T<60.0)
   ++count
   T+=generate_time_interval_in_seconds(X)
return count 
```

# r - 用...函数参数制作一个列表

> ID：11851552
> 
> 赞同：4
> 
> 时间：2012-08-07T18:02:40.523
> 
> 标签：r

这是我刚刚遇到的一个难题：

```
x <- data.frame(a="hi",b="lo")
y <- data.frame(a="hi",b="lo")

getCommonNames <- function(...) {
  l <- list(...)
  sapply( l, names )
} 
```

对比

```
getCommonNames2 <- function(...) {
  sapply( list(...), names )
}

> getCommonNames2(x,y)
Error in lapply(X = X, FUN = FUN, ...) : 
  argument "X" is missing, with no default
> getCommonNames(x,y)
     [,1] [,2]
[1,] "a"  "a" 
[2,] "b"  "b" 
```

为什么`list(...)`在存储到某个东西（或用作返回值）时正确地将其内容强制转换为列表，但在没有先存储它的情况下在表达式中使用时却不行？

这似乎是一件小事，但它有点打破了我对 R 解析的心理模型，在这个模型中，一切都得到解决，然后存储或传递给下一个参数。我学会了不要忽视这样的时刻，因为重新构建我的心智模型以考虑新信息通常会导致对事物的更深入理解。

那么……这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:47:33.530

这可能是您的 R 版本中的错误或当前环境中的某些不匹配。

我的版本没有重现同样的问题，它只是按预期进行。

```
> x <- data.frame(a="hi",b="lo")
> y <- data.frame(a="hi",b="lo")
> 
> getCommonNames <- function(...) {
+   l <- list(...)
+   sapply( l, names )
+ }
> 
> 
> getCommonNames2 <- function(...) {
+   sapply( list(...), names )
+ }
> 
> getCommonNames2(x,y)
     [,1] [,2]
[1,] "a"  "a" 
[2,] "b"  "b" 
> getCommonNames(x,y)
     [,1] [,2]
[1,] "a"  "a" 
[2,] "b"  "b" 

version.string R version 2.14.0 (2011-10-31) 
```

# javascript - 是否有任何用 Javascript 编写的开源 JSDoc 解析器？

> ID：11851556
> 
> 赞同：8
> 
> 时间：2012-08-07T18:03:21.243
> 
> 标签：javascript, jsdoc

我正在寻找可以在我的项目中使用的 JSDoc 解析器。我正在寻找可以传递 JSDoc 注释并接收该注释含义的结构化描述的东西。我见过的大多数工具似乎都能够将 JSDoc 注释转换为 HTML 或其他格式。我正在寻找可以提供可用于输入其他工具的评论的中间表示的东西。

有没有我可以使用的工具或库？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-08T17:30:51.837

Doctrine 项目正是我正在寻找的：

[http://eslint.org/doctrine/demo/](http://eslint.org/doctrine/demo/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-09T08:38:59.437

如果您只需要解析功能并且不关心标签[的含义，那么评论解析器](https://github.com/yavorskiy/comment-parser)可能会有所帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-03T10:18:55.323

还有一个dojo项目： [https ://github.com/wkeese/js-doc-parse](https://github.com/wkeese/js-doc-parse)

见 [http://www.sitepen.com/blog/2013/01/18/generating-and-viewing-custom-api-docs/](http://www.sitepen.com/blog/2013/01/18/generating-and-viewing-custom-api-docs/)

它看起来像 dojo 文档 ( [http://dojotoolkit.org/api/](http://dojotoolkit.org/api/) )

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-06T01:44:16.900

jsdoc 本身呢？- 使用命令行 jsdoc yourfile.js -X > parsed.json 。这样你就有了官方的东西。

# unit-testing - 在 ASP.NET WebApi 中测试路由配置

> ID：11851558
> 
> 赞同：39
> 
> 时间：2012-08-07T18:03:30.217
> 
> 标签：unit-testing, routes, asp.net-web-api

我正在尝试对我的[WebApi](http://www.asp.net/web-api)路由配置进行一些单元测试。我想测试路线是否`"/api/super"`映射到`Get()`我的`SuperController`. 我已经设置了以下测试并且遇到了一些问题。

```
public void GetTest()
{
    var url = "~/api/super";

    var routeCollection = new HttpRouteCollection();
    routeCollection.MapHttpRoute("DefaultApi", "api/{controller}/");

    var httpConfig = new HttpConfiguration(routeCollection);
    var request = new HttpRequestMessage(HttpMethod.Get, url);

    // exception when url = "/api/super"
    // can get around w/ setting url = "http://localhost/api/super"
    var routeData = httpConfig.Routes.GetRouteData(request);
    request.Properties[HttpPropertyKeys.HttpRouteDataKey] = routeData;

    var controllerSelector = new DefaultHttpControllerSelector(httpConfig);

    var controlleDescriptor = controllerSelector.SelectController(request);

    var controllerContext =
        new HttpControllerContext(httpConfig, routeData, request);
    controllerContext.ControllerDescriptor = controlleDescriptor;

    var selector = new ApiControllerActionSelector();
    var actionDescriptor = selector.SelectAction(controllerContext);

    Assert.AreEqual(typeof(SuperController),
        controlleDescriptor.ControllerType);
    Assert.IsTrue(actionDescriptor.ActionName == "Get");
} 
```

我的第一个问题是，如果我没有指定完全限定的 URL，则会`httpConfig.Routes.GetRouteData(request);`引发`InvalidOperationException`异常，并显示“相对 URI 不支持此操作”的消息。

我的存根配置显然遗漏了一些东西。我更喜欢使用相对 URI，因为使用完全限定的 URI 进行路由测试似乎不合理。

我上面的配置的第二个问题是我没有按照 RouteConfig 中的配置测试我的路由，而是使用：

```
var routeCollection = new HttpRouteCollection();
routeCollection.MapHttpRoute("DefaultApi", "api/{controller}/"); 
```

如何使用`RouteTable.Routes`在典型 Global.asax 中配置的分配：

```
public class MvcApplication : HttpApplication
{
    protected void Application_Start()
    {
        // other startup stuff

        RouteConfig.RegisterRoutes(RouteTable.Routes);
    }
}

public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        // route configuration
    }
} 
```

此外，我上面提到的可能不是最好的测试配置。如果有更精简的方法，我会全力以赴。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-17T01:04:34.003

我最近正在测试我的 Web API 路由，这就是我的做法。

1.  首先，我创建了一个助手来将所有 Web API 路由逻辑移到那里：

```
 public static class WebApi
    {
        public static RouteInfo RouteRequest(HttpConfiguration config, HttpRequestMessage request)
        {
            // create context
            var controllerContext = new HttpControllerContext(config, Substitute.For<IHttpRouteData>(), request);

            // get route data
            var routeData = config.Routes.GetRouteData(request);
            RemoveOptionalRoutingParameters(routeData.Values);

            request.Properties[HttpPropertyKeys.HttpRouteDataKey] = routeData;
            controllerContext.RouteData = routeData;

            // get controller type
            var controllerDescriptor = new DefaultHttpControllerSelector(config).SelectController(request);
            controllerContext.ControllerDescriptor = controllerDescriptor;

            // get action name
            var actionMapping = new ApiControllerActionSelector().SelectAction(controllerContext);

            return new RouteInfo
            {
                Controller = controllerDescriptor.ControllerType,
                Action = actionMapping.ActionName
            };
        }

        private static void RemoveOptionalRoutingParameters(IDictionary<string, object> routeValues)
        {
            var optionalParams = routeValues
                .Where(x => x.Value == RouteParameter.Optional)
                .Select(x => x.Key)
                .ToList();

            foreach (var key in optionalParams)
            {
                routeValues.Remove(key);
            }
        }
    }

    public class RouteInfo
    {
        public Type Controller { get; set; }

        public string Action { get; set; }
    } 
```

1.  假设我有一个单独的类来注册 Web API 路由（它默认在 Visual Studio ASP.NET MVC 4 Web 应用程序项目中创建，在 App_Start 文件夹中）：

```
 public static class WebApiConfig
    {
        public static void Register(HttpConfiguration config)
        {
            config.Routes.MapHttpRoute(
                name: "DefaultApi",
                routeTemplate: "api/{controller}/{id}",
                defaults: new { id = RouteParameter.Optional }
            );
        }
    } 
```

1.  我可以轻松地测试我的路线：

```
 [Test]
    public void GET_api_products_by_id_Should_route_to_ProductsController_Get_method()
    {
        // setups
        var request = new HttpRequestMessage(HttpMethod.Get, "http://myshop.com/api/products/1");
        var config = new HttpConfiguration();

        // act
        WebApiConfig.Register(config);
        var route = WebApi.RouteRequest(config, request);

        // asserts
        route.Controller.Should().Be<ProductsController>();
        route.Action.Should().Be("Get");
    }

    [Test]
    public void GET_api_products_Should_route_to_ProductsController_GetAll_method()
    {
        // setups
        var request = new HttpRequestMessage(HttpMethod.Get, "http://myshop.com/api/products");
        var config = new HttpConfiguration();

        // act
        WebApiConfig.Register(config);
        var route = WebApi.RouteRequest(config, request);

        // asserts
        route.Controller.Should().Be<ProductsController>();
        route.Action.Should().Be("GetAll");
    }

    .... 
```

下面的一些注释：

*   是的，我使用的是绝对 URL。但我在这里没有看到任何问题，因为这些是假 URL，我不需要配置任何东西就可以让它们工作，它们代表对我们 Web 服务的真实请求。
*   如果它们是在具有 HttpConfiguration 依赖项的单独类中配置的（如上面的示例中），则无需将路由映射代码复制到测试中。
*   在上面的示例中，我使用了 NUnit、NSubstitute 和 FluentAssertions，当然，对任何其他测试框架进行同样的操作是一件容易的事。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-04-07T07:21:03.643

ASP.NET Web API 2 的迟到答案（我只测试了那个版本）。我使用了来自 Nuget 的 MvcRouteTester.Mvc5，它为我完成了这项工作。您可以编写以下内容。

```
[TestClass]
public class RouteTests
{
    private HttpConfiguration config;
    [TestInitialize]
    public void MakeRouteTable()
    {
        config = new HttpConfiguration();
        WebApiConfig.Register(config);
        config.EnsureInitialized();
    }
    [TestMethod]
    public void GetTest()
    {
        config.ShouldMap("/api/super")
            .To<superController>(HttpMethod.Get, x => x.Get());
    }
} 
```

我不得不将 nuget 包 Microsoft Asp.Net MVC 版本 5.0.0 添加到测试项目中。这不太漂亮，但我没有找到更好的解决方案，这对我来说是可以接受的。您可以在 nuget 包管理器控制台中安装这样的旧版本：

`Get-Project Tests | install-package microsoft.aspnet.mvc -version 5.0.0`

它也适用于 System.Web.Http.RouteAttribute。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-09-16T22:16:19.993

此答案适用于 WebAPI 2.0 及更高版本

通读Whyleee的回答，我注意到该方法基于耦合且脆弱的假设：

1.  该方法尝试重新创建操作选择，并假设 Web API 中的内部实现细节。
2.  当有一个众所周知的公共可扩展点允许替换它时，它假定正在使用默认控制器选择器。

另一种方法是使用轻量级功能测试。这种方法的步骤是：

1.  使用您的 WebApiConfig.Register 方法初始化测试 HttpConfiguration 对象，模仿在现实世界中初始化应用程序的方式。
2.  将自定义身份验证过滤器添加到捕获该级别的操作信息的测试配置对象。这可以通过开关直接在产品代码中注入或完成。2.1 身份验证过滤器将短路任何过滤器以及操作代码，因此无需担心在操作方法本身中运行的实际代码。
3.  使用内存服务器 (HttpServer)，并发出请求。这种方法使用内存中的通道，因此不会影响网络。
4.  将捕获的动作信息与预期信息进行比较。

```
[TestClass]
public class ValuesControllerTest
{
    [TestMethod]
    public void ActionSelection()
    {
        var config = new HttpConfiguration();
        WebApiConfig.Register(config);

        Assert.IsTrue(ActionSelectorValidator.IsActionSelected(
            HttpMethod.Post,
            "http://localhost/api/values/",
            config,
            typeof(ValuesController),
            "Post"));
    }
 } 
```

该助手执行管道，并验证身份验证过滤器捕获的数据，也可以捕获其他属性，或者可以实现一个客户过滤器，通过在初始化时将 lambda 传递到过滤器，直接在每个测试中进行验证。

```
 public class ActionSelectorValidator
 {
    public static bool IsActionSelected(
        HttpMethod method,
        string uri,
        HttpConfiguration config,
        Type controller,
        string actionName)
    {
        config.Filters.Add(new SelectedActionFilter());
        var server = new HttpServer(config);
        var client = new HttpClient(server);
        var request = new HttpRequestMessage(method, uri);
        var response = client.SendAsync(request).Result;
        var actionDescriptor = (HttpActionDescriptor)response.RequestMessage.Properties["selected_action"];

        return controller == actionDescriptor.ControllerDescriptor.ControllerType && actionName == actionDescriptor.ActionName;
    }
} 
```

此过滤器运行并阻止过滤器或操作代码的所有其他执行。

```
public class SelectedActionFilter : IAuthenticationFilter
{
    public Task AuthenticateAsync(
         HttpAuthenticationContext context,
         CancellationToken cancellationToken)
    {
        context.ErrorResult = CreateResult(context.ActionContext);

       // short circuit the rest of the authentication filters
        return Task.FromResult(0);
    }

    public Task ChallengeAsync(HttpAuthenticationChallengeContext context, CancellationToken cancellationToken)
    {
        var actionContext = context.ActionContext;

        actionContext.Request.Properties["selected_action"] = 
            actionContext.ActionDescriptor;
        context.Result = CreateResult(actionContext); 

        return Task.FromResult(0);
    }

    private static IHttpActionResult CreateResult(
        HttpActionContext actionContext)
    {
        var response = new HttpResponseMessage()
            { RequestMessage = actionContext.Request };

        actionContext.Response = response;

        return new ByPassActionResult(response);
    }

    public bool AllowMultiple { get { return true; } }
} 
```

导致执行短路的结果

```
internal class ByPassActionResult : IHttpActionResult
{
    public HttpResponseMessage Message { get; set; }

    public ByPassActionResult(HttpResponseMessage message)
    {
        Message = message;
    }

    public Task<HttpResponseMessage> 
       ExecuteAsync(CancellationToken cancellationToken)
    {
       return Task.FromResult<HttpResponseMessage>(Message);
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-02-05T05:48:03.137

我采用了 Keith Jackson 的解决方案并将其修改为：

a) 使用 asp.net web api 2 - 属性路由**以及**老派路由

    和

b) 不仅要验证路由参数名称，还要验证它们的值

例如对于以下路线

```
 [HttpPost]
    [Route("login")]
    public HttpResponseMessage Login(string username, string password)
    {
        ...
    }

    [HttpPost]
    [Route("login/{username}/{password}")]
    public HttpResponseMessage LoginWithDetails(string username, string password)
    {
        ...
    } 
```

  您可以验证路由匹配正确的 http 方法、控制器、操作和参数：

```
 [TestMethod]
    public void Verify_Routing_Rules()
    {
        "http://api.appname.com/account/login"
           .ShouldMapTo<AccountController>("Login", HttpMethod.Post);

        "http://api.appname.com/account/login/ben/password"
            .ShouldMapTo<AccountController>(
               "LoginWithDetails", 
               HttpMethod.Post, 
               new Dictionary<string, object> { 
                   { "username", "ben" }, { "password", "password" } 
               });
    } 
```

  对 Keith Jackson 对Whyleee 解决方案的修改的修改。

```
 public static class RoutingTestHelper
    {
        /// <summary>
        ///     Routes the request.
        /// </summary>
        /// <param name="config">The config.</param>
        /// <param name="request">The request.</param>
        /// <returns>Inbformation about the route.</returns>
        public static RouteInfo RouteRequest(HttpConfiguration config, HttpRequestMessage request)
        {
            // create context
            var controllerContext = new HttpControllerContext(config, new Mock<IHttpRouteData>().Object, request);

            // get route data
            var routeData = config.Routes.GetRouteData(request);
            RemoveOptionalRoutingParameters(routeData.Values);

            HttpActionDescriptor actionDescriptor = null;
            HttpControllerDescriptor controllerDescriptor = null;

            // Handle web api 2 attribute routes
            if (routeData.Values.ContainsKey("MS_SubRoutes"))
            {
                var subroutes = (IEnumerable<IHttpRouteData>)routeData.Values["MS_SubRoutes"];
                routeData = subroutes.First();
                actionDescriptor = ((HttpActionDescriptor[])routeData.Route.DataTokens.First(token => token.Key == "actions").Value).First();
                controllerDescriptor = actionDescriptor.ControllerDescriptor;
            }
            else
            {
                request.Properties[HttpPropertyKeys.HttpRouteDataKey] = routeData;
                controllerContext.RouteData = routeData;

                // get controller type
                controllerDescriptor = new DefaultHttpControllerSelector(config).SelectController(request);
                controllerContext.ControllerDescriptor = controllerDescriptor;

                // get action name
                actionDescriptor = new ApiControllerActionSelector().SelectAction(controllerContext);

            }

            return new RouteInfo
            {
                Controller = controllerDescriptor.ControllerType,
                Action = actionDescriptor.ActionName,
                RouteData = routeData
            };
        }

        #region | Extensions |

        public static bool ShouldMapTo<TController>(this string fullDummyUrl, string action, Dictionary<string, object> parameters = null)
        {
            return ShouldMapTo<TController>(fullDummyUrl, action, HttpMethod.Get, parameters);
        }

        public static bool ShouldMapTo<TController>(this string fullDummyUrl, string action, HttpMethod httpMethod, Dictionary<string, object> parameters = null)
        {
            var request = new HttpRequestMessage(httpMethod, fullDummyUrl);
            var config = new HttpConfiguration();
            WebApiConfig.Register(config);
            config.EnsureInitialized();

            var route = RouteRequest(config, request);

            var controllerName = typeof(TController).Name;
            if (route.Controller.Name != controllerName)
                throw new Exception(String.Format("The specified route '{0}' does not match the expected controller '{1}'", fullDummyUrl, controllerName));

            if (route.Action.ToLowerInvariant() != action.ToLowerInvariant())
                throw new Exception(String.Format("The specified route '{0}' does not match the expected action '{1}'", fullDummyUrl, action));

            if (parameters != null && parameters.Any())
            {
                foreach (var param in parameters)
                {
                    if (route.RouteData.Values.All(kvp => kvp.Key != param.Key))
                        throw new Exception(String.Format("The specified route '{0}' does not contain the expected parameter '{1}'", fullDummyUrl, param));

                    if (!route.RouteData.Values[param.Key].Equals(param.Value))
                        throw new Exception(String.Format("The specified route '{0}' with parameter '{1}' and value '{2}' does not equal does not match supplied value of '{3}'", fullDummyUrl, param.Key, route.RouteData.Values[param.Key], param.Value));
                }
            }

            return true;
        }

        #endregion

        #region | Private Methods |

        /// <summary>
        ///     Removes the optional routing parameters.
        /// </summary>
        /// <param name="routeValues">The route values.</param>
        private static void RemoveOptionalRoutingParameters(IDictionary<string, object> routeValues)
        {
            var optionalParams = routeValues
                .Where(x => x.Value == RouteParameter.Optional)
                .Select(x => x.Key)
                .ToList();

            foreach (var key in optionalParams)
            {
                routeValues.Remove(key);
            }
        }

        #endregion
    }

    /// <summary>
    ///     Route information
    /// </summary>
    public class RouteInfo
    {
        public Type Controller { get; set; }
        public string Action { get; set; }
        public IHttpRouteData RouteData { get; set; }
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-30T11:04:07.470

感谢whyleee上面的回答！

我已经将它与 WebApiContrib.Testing 库中我在语法上喜欢的一些元素相结合，这对我来说无法生成以下帮助程序类。

这使我可以编写像这样的真正轻量级的测试......

```
[Test]
[Category("Auth Api Tests")]
public void TheAuthControllerAcceptsASingleItemGetRouteWithAHashString()
{
    "http://api.siansplan.com/auth/sjkfhiuehfkshjksdfh".ShouldMapTo<AuthController>("Get", "hash");
}

[Test]
[Category("Auth Api Tests")]
public void TheAuthControllerAcceptsAPost()
{
    "http://api.siansplan.com/auth".ShouldMapTo<AuthController>("Post", HttpMethod.Post);
} 
```

我还稍微增强了它以允许在需要时测试参数（这是一个 params 数组，因此您可以添加您喜欢的所有内容，它只是检查它们是否存在）。这也适用于最小起订量，纯粹是因为它是我选择的框架......

```
using Moq;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Web.Http;
using System.Web.Http.Controllers;
using System.Web.Http.Dispatcher;
using System.Web.Http.Hosting;
using System.Web.Http.Routing;

namespace SiansPlan.Api.Tests.Helpers
{
    public static class RoutingTestHelper
    {
        /// <summary>
        /// Routes the request.
        /// </summary>
        /// <param name="config">The config.</param>
        /// <param name="request">The request.</param>
        /// <returns>Inbformation about the route.</returns>
        public static RouteInfo RouteRequest(HttpConfiguration config, HttpRequestMessage request)
        {
            // create context
            var controllerContext = new HttpControllerContext(config, new Mock<IHttpRouteData>().Object, request);

            // get route data
            var routeData = config.Routes.GetRouteData(request);
            RemoveOptionalRoutingParameters(routeData.Values);

            request.Properties[HttpPropertyKeys.HttpRouteDataKey] = routeData;
            controllerContext.RouteData = routeData;

            // get controller type
            var controllerDescriptor = new DefaultHttpControllerSelector(config).SelectController(request);
            controllerContext.ControllerDescriptor = controllerDescriptor;

            // get action name
            var actionMapping = new ApiControllerActionSelector().SelectAction(controllerContext);

            var info = new RouteInfo(controllerDescriptor.ControllerType, actionMapping.ActionName);

            foreach (var param in actionMapping.GetParameters())
            {
                info.Parameters.Add(param.ParameterName);
            }

            return info;
        }

        #region | Extensions |

        /// <summary>
        /// Determines that a URL maps to a specified controller.
        /// </summary>
        /// <typeparam name="TController">The type of the controller.</typeparam>
        /// <param name="fullDummyUrl">The full dummy URL.</param>
        /// <param name="action">The action.</param>
        /// <param name="parameterNames">The parameter names.</param>
        /// <returns></returns>
        public static bool ShouldMapTo<TController>(this string fullDummyUrl, string action, params string[] parameterNames)
        {
            return ShouldMapTo<TController>(fullDummyUrl, action, HttpMethod.Get, parameterNames);
        }

        /// <summary>
        /// Determines that a URL maps to a specified controller.
        /// </summary>
        /// <typeparam name="TController">The type of the controller.</typeparam>
        /// <param name="fullDummyUrl">The full dummy URL.</param>
        /// <param name="action">The action.</param>
        /// <param name="httpMethod">The HTTP method.</param>
        /// <param name="parameterNames">The parameter names.</param>
        /// <returns></returns>
        /// <exception cref="System.Exception"></exception>
        public static bool ShouldMapTo<TController>(this string fullDummyUrl, string action, HttpMethod httpMethod, params string[] parameterNames)
        {
            var request = new HttpRequestMessage(httpMethod, fullDummyUrl);
            var config = new HttpConfiguration();
            WebApiConfig.Register(config);

            var route = RouteRequest(config, request);

            var controllerName = typeof(TController).Name;
            if (route.Controller.Name != controllerName)
                throw new Exception(String.Format("The specified route '{0}' does not match the expected controller '{1}'", fullDummyUrl, controllerName));

            if (route.Action.ToLowerInvariant() != action.ToLowerInvariant())
                throw new Exception(String.Format("The specified route '{0}' does not match the expected action '{1}'", fullDummyUrl, action));

            if (parameterNames.Any())
            {
                if (route.Parameters.Count != parameterNames.Count())
                    throw new Exception(
                        String.Format(
                            "The specified route '{0}' does not have the expected number of parameters - expected '{1}' but was '{2}'",
                            fullDummyUrl, parameterNames.Count(), route.Parameters.Count));

                foreach (var param in parameterNames)
                {
                    if (!route.Parameters.Contains(param))
                        throw new Exception(
                            String.Format("The specified route '{0}' does not contain the expected parameter '{1}'",
                                          fullDummyUrl, param));
                }
            }

            return true;
        }

        #endregion

        #region | Private Methods |

        /// <summary>
        /// Removes the optional routing parameters.
        /// </summary>
        /// <param name="routeValues">The route values.</param>
        private static void RemoveOptionalRoutingParameters(IDictionary<string, object> routeValues)
        {
            var optionalParams = routeValues
                .Where(x => x.Value == RouteParameter.Optional)
                .Select(x => x.Key)
                .ToList();

            foreach (var key in optionalParams)
            {
                routeValues.Remove(key);
            }
        }

        #endregion
    }

    /// <summary>
    /// Route information
    /// </summary>
    public class RouteInfo
    {
        #region | Construction |

        /// <summary>
        /// Initializes a new instance of the <see cref="RouteInfo"/> class.
        /// </summary>
        /// <param name="controller">The controller.</param>
        /// <param name="action">The action.</param>
        public RouteInfo(Type controller, string action)
        {
            Controller = controller;
            Action = action;
            Parameters = new List<string>();
        }

        #endregion

        public Type Controller { get; private set; }
        public string Action { get; private set; }
        public List<string> Parameters { get; private set; }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-20T02:18:00.543

由于一些我无法弄清楚的细节，所有其他答案对我来说都失败了。

这是一个完整的使用示例`GetRouteData()`：[https](https://github.com/JayBazuzi/ASP.NET-WebApi-GetRouteData-example) ://github.com/JayBazuzi/ASP.NET-WebApi-GetRouteData-example ，创建如下：

1.  在 VS 2013 中，新建项目 -> Web，ASP.NET Web 应用程序
2.  选择 WebAPI。选中“添加单元测试”。
3.  添加以下单元测试：

    ```
    [TestMethod]
    public void RouteToGetUser()
    {
        var request = new HttpRequestMessage(HttpMethod.Get, "http://localhost:4567/api/users/me");

        var config = new HttpConfiguration();
        WebApiConfig.Register(config);
        config.EnsureInitialized();

        var result = config.Routes.GetRouteData(request);

        Assert.AreEqual("api/{controller}/{id}", result.Route.RouteTemplate);
    } 
    ```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-09T01:25:26.737

要从路由集合中获取路由数据，您需要在这种情况下提供完整的 URI（只需使用“http://localhost/api/super”）。

要测试来自 RouteTable.Routes 的路由，您可以执行以下操作：

```
var httpConfig = GlobalConfiguration.Configuration;
httpConfig.Routes.MapHttpRoute("DefaultApi", "api/{controller}/"); 
```

幕后发生的事情是 GlobalConfiguration 将使 RouteTable.Routes 适应 httpConfig.Routes。因此，当您将路由添加到 httpConfig.Routes 时，它实际上会添加到 RouteTable.Routes。但要使其工作，您需要托管在 ASP.NET 中，以便填充诸如 HostingEnvironment.ApplicationVirtualPath 之类的环境设置。

# c++ - 头文件礼仪

> ID：11851565
> 
> 赞同：7
> 
> 时间：2012-08-07T18:04:01.020
> 
> 标签：c++, c

当我创建一个将由多个开发人员使用的头文件时，是否认为是一种良好的编程习惯，使该头文件在其中使用的所有定义和声明方面自给自足。

例如：

头文件 1：types.h

```
#ifndef TYPES_H
#define TYPES_H
typedef unsigned int uint16
#endif 
```

头文件2：myheader.h

```
#ifndef MYHEADER_H
#define MYHEADER_H
uint16 myfunc(void);
#endif 
```

我在 myheader.h 中使用了 uint16 ，但不包括 types.h 。因此，如果有人想在他们的源文件中包含 myheader.h，他们应该首先包含“types.h”，然后包含“myheader.h”。所以这实际上是在迫使开发人员以特定的顺序包含头文件。我一直认为这是不好的做法，但今天我在公司遇到了一些代码，在其中获取在一个文件中声明的函数，您需要包含至少 4 个其他头文件。所以现在我很困惑，我是否遗漏了什么，是否有任何地方可以将其视为预期行为。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T18:06:55.853

用不必要的类型污染全局命名空间是不好的做法。您能做的最好的事情是尽可能提供前向声明，并`include`在必要时提供其他文件。`uint16`在您的简化情况下，您应该包含在使用它的每个标头中定义的标头。

例如，如果您可以前向声明类型，则这是首选。基本原理是，如果您实际上不使用该类型，则前向声明就足够了。如果您确实使用了该类型，则**应该**在显式声明它的地方包含标头。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T18:06:47.773

你最好只创建一些包含守卫，然后`#include "types.h"`进入 myheader.h。不要让别人思考（至少不是这样）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-07T18:11:28.487

具体回答您的问题：是的，头文件应该是自给自足的。*它应该包括允许它编译*所需的每个头文件。

通常，大多数现代库都有适当的保护措施，以便编译器只能“看到”一次头文件。先到先得。所以不要太在意这一点（尽管验证它永远不会有坏处）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T18:31:58.937

公共标头应提供使用其公开的接口所需的所有定义，仅此而已。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T18:08:21.750

这可能是一个惯例问题，但在几乎所有类似的情况下， `myheader.h`#include`types.h`一开始就包含。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-07T20:56:30.370

所有标头都应该是自给自足的，除非用#error 明确说明，除非定义了某些定义。

我总是将 CPP 文件的匹配标头作为第一个包含，以确保它们始终是可编译的。

# ruby - 如何在 sublime-text-2 中运行 ruby 文件

> ID：11851566
> 
> 赞同：2
> 
> 时间：2012-08-07T18:04:03.490
> 
> 标签：ruby, ubuntu, sublimetext2

当我按 ctrl+b 运行简单的代码时，例如：

```
puts "asdasd" 
```

结果是空白字段。Ruby 路径是 /home/yukke/.rvm/rubies/default/bin/ruby 和 ruby​​ -v => ruby​​ 1.9.3p194（2012-04-20 修订版 35410）[x86_64-linux]。

所以我尝试将 Ruby.sublime-build 更改为

```
{
    "cmd": ["/home/yukke/.rvm/rubies/default/bin/ruby", "-u","$file"],
    "file_regex": "^(...*?):([0-9]*):?([0-9]*)",
    "selector": "source.ruby"
} 
```

但这并没有改变什么。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T07:28:13.443

试试这个，去掉“-u”，然后使用 rvm

```
"cmd": ["/home/yukke/.rvm/bin/rvm-auto-ruby", "$file"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T16:23:02.853

您需要先保存文件，然后它才能工作。它不如 TextMate 的那么好`Command``R`，而且如果那是您所期望的，它的工作方式也不一样。

# c# - 使用 Delphi 使用 WCF - 最大字符串内容长度配额 (8192) 错误

> ID：11851575
> 
> 赞同：4
> 
> 时间：2012-08-07T18:04:36.590
> 
> 标签：c#, wcf, delphi, soap, web-config

我有一个 Delphi 应用程序正在使用的 WCF。有时在向服务器发送大请求时会出现此错误：

```
---------------------------
Debugger Exception Notification
---------------------------
Project Project43.exe raised exception class ERemotableException with message 'The formatter threw an exception while trying to deserialize the message: Error in deserializing body of request message for operation 'Log'. The maximum string content length quota (8192) has been exceeded while reading XML data. This quota may be increased by changing the MaxStringContentLength property on the XmlDictionaryReaderQuotas object used when creating the XML reader. Line 58, position 140.'.
---------------------------
Break   Continue   Help   
--------------------------- 
```

我在服务器端配置了 web.config 如下：

* * *

## 网页配置

```
<?xml version="1.0" ?>
<configuration>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>

    <bindings>
      <basicHttpBinding>
        <binding name="basicHttpBinding">
          <readerQuotas maxDepth="32" maxStringContentLength="5242880" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
        </binding>
      </basicHttpBinding>
    </bindings>

    <services>
      <service name="NewServiceType">
        <clear />
        <endpoint address="http://localhost" binding="basicHttpBinding" bindingConfiguration="" contract="IRoboConsultaLog" />
      </service>
    </services>

    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

但我一直收到这个错误。网上有人建议客户端的app.config也应该修改，但我不知道怎么做，因为我使用的是Delphi。

我还注意到我不知道如何正确配置`<endpoint>`标签，也许这就是我所有麻烦的原因。下面是我的 Web 服务的接口和类（简化为更清晰）：

* * *

## 界面：

```
namespace RoboConsultaLogServer
{
    [ServiceContract]
    public interface IRoboConsultaLog
    {
        [OperationContract]
        void Log(string key, string numeroSerial, string nomeTarefa, int qtdProcessos, float uptime, float duracaoTarefa,
                 int qtdSucesso, int qtdInsucesso, int qtdCancelado, bool servico, bool notificarResponsaveis, string logProcessos);
    }
} 
```

* * *

## 班级

```
public class RoboConsultaLog : IRoboConsultaLog 
{
    ...
} 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:39:27.607

正如您所注意到的，这是因为端点配置：

```
<endpoint address="http://localhost" binding="basicHttpBinding" bindingConfiguration="" contract="IRoboConsultaLog" /> 
```

基本上没有使用您的读者配额配置。

Binding 参数仅定义绑定类型，如果要传递绑定配置，则必须填写 BindingConfiguration 参数。绑定类型与您的案例中的配置名称相同（“basicHttpBinding”）只是一个巧合。所以试试这个（为了清楚起见，我更改了名称）：

```
 <bindings>
      <basicHttpBinding>
        <binding name="myBindingConfiguration">
          <readerQuotas maxDepth="32" maxStringContentLength="5242880" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
        </binding>
      </basicHttpBinding>
    </bindings> 
```

和

```
 <endpoint address="http://localhost" binding="basicHttpBinding" bindingConfiguration="myBindingConfiguration" contract="IRoboConsultaLog" /> 
```

编辑：另外，如果您发送了这么多数据，也许最好将其作为文件发送，将其保存在 Session 中，然后在 WCF 方法中使用它。数据将在没有 WCF 开销的情况下发送，并且 WCF 调用会更快，从而使应用程序更具响应性。此外，它不会那么容易出现 WCF 超时。

# java - UTF-8 不适用于原始文件夹中的西里尔文文本

> ID：11851579
> 
> 赞同：1
> 
> 时间：2012-08-07T18:04:40.543
> 
> 标签：java, android

我在西里尔文的 res/raw 文件夹中有一个文本文件。

```
InputStream ints = getResources().openRawResource(R.raw.h9);
input = new BufferedReader(new InputStreamReader(getResources().openRawResource(R.raw.h1), "UTF8"));

while (( line = input.readLine())  )
{
...
} 
```

然而，当我尝试在“UTF8”中逐行阅读时，它给了我奇怪的字符。

任何想法可能有什么问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:25:05.780

您对文件的编码方式有误。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-07T18:21:10.970

got it, it was encoded in **CP-1251** !

# java - How to list locally-modified/unversioned files using svnkit?

> ID：11851584
> 
> 赞同：5
> 
> 时间：2012-08-07T18:05:10.587
> 
> 标签：java, svn, svnkit

I'm writing a piece of code that, once executed anywhere inside an SVN working copy, locates the root:

```
File workingDirectory = new File(".").getCanonicalFile();
File wcRoot = SVNWCUtil.getWorkingCopyRoot(workingDirectory, true); 
```

gets the repository url given this root, builds an `SVNClientManager` given this info and now I'm stuck at how to get a list of anything in the working copy that is not in the repository - this includes locally-modified files, unresolved merges, unversioned files and I'll be happy to hear any anything else I might have missed.

How do I do that ? This snippet seems to require access to the repository itself, not the WC:

```
clientManager.getLookClient().doGetChanged(...) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-23T03:56:35.017

```
public static List<File> listModifiedFiles(File path, SVNRevision revision) throws SVNException {
    SVNClientManager svnClientManager = SVNClientManager.newInstance();
    final List<File> fileList = new ArrayList<File>();
    svnClientManager.getStatusClient().doStatus(path, revision, SVNDepth.INFINITY, false, false, false, false, new ISVNStatusHandler() {
        @Override
        public void handleStatus(SVNStatus status) throws SVNException {
            SVNStatusType statusType = status.getContentsStatus();
            if (statusType != SVNStatusType.STATUS_NONE && statusType != SVNStatusType.STATUS_NORMAL
                    && statusType != SVNStatusType.STATUS_IGNORED) {
                fileList.add(status.getFile());
            }
        }
    }, null);
    return fileList;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T18:43:26.390

This gives you local modifications, i.e. it doesn't look at things that have changed in the repository that are not in your working copy

```
static def isModded(SvnConfig svn, File path, SVNRevision rev) {
    SVNClientManager mgr = newInstance(null, svn.username, svn.password)
    logger.debug("Searching for modifications beneath $path.path @ $rev")
    mgr.statusClient.doStatus(path, rev, INFINITY, false, false, false, false, { SVNStatus status ->
        SVNStatusType statusType = status.contentsStatus
        if (statusType != STATUS_NONE && statusType != STATUS_NORMAL && statusType != STATUS_IGNORED) {
            lmodded = true
            logger.debug("$status.file.path --> lmodded: $statusType")
        }
    } as ISVNStatusHandler, null)
    lmodded
} 
```

The code I have for this is in groovy but hopefully the use of the svnkit api is obvious enough to work with. SvnConfig is just a local value object containing various details about the repository itself.

# java - JFreeChart 没有重新缩放

> ID：11851585
> 
> 赞同：0
> 
> 时间：2012-08-07T18:05:13.327
> 
> 标签：java, jfreechart

我生成了一个自定义数据集，然后将其传递给 JFreeChart 的工厂方法以获取图表组件。此外，我将它包装在一个面板中并将其放置在应用程序的主 UI 部分中。我有一组过滤器，可以选择要显示的特定系列。我使用标准渲染器的方法 setSeriesVisible 处理它。不幸的是，隐藏系列后，两个轴都不会在图表上重新缩放。任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T13:17:56.547

回答我自己的问题：

这是库问题，已在 1.0.13+ 版本中解决

# actionscript-3 - 基本动作语句

> ID：11851586
> 
> 赞同：0
> 
> 时间：2012-08-07T18:05:13.863
> 
> 标签：actionscript-3, flash, actionscript

我以前从未做过任何动作脚本，但下面标记的行是做什么的？

```
var s:Object = {};

for (var i:int = 0; i < 1000; i++)
{
    s[i] ? s[i]++ : s[i] = -1; //this line
} 
```

它看起来类似于 C# 速记`If...Else`，但我不明白这种情况下的条件是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:10:43.313

它是[三元运算符](http://en.wikipedia.org/wiki/Ternary_operator)，又名[条件运算符](http://en.wikipedia.org/wiki/Conditional_operator)。

```
if(s[i]){
    s[i]++
}else{
    s[i] = -1;
} 
```

# domain-driven-design - 如何为在一个上下文中为聚合根但在另一个上下文中不为聚合根的实体编写命令？

> ID：11851589
> 
> 赞同：4
> 
> 时间：2012-08-07T18:05:14.893
> 
> 标签：domain-driven-design, cqrs, command-pattern

我正在为一家寻找供应商为员工搬迁提供服务的公司开展一个项目。这些服务是搬运工不具备专业知识的事情，例如准备钢琴或运输或为贵重物品建造板条箱。

在这个域中，一个订单有 1:many Locations。

在搬家行业中，订单经常在不断变化，直到供应商执行要求他提供的服务。因此，在我们的模型中，我们有一些适用于订单和地点的状态（例如已提交、已取消、暂停）。

有一些非常简单的业务规则适用于此。这是一个示例：

1.  当订单被搁置时，所有位置都被搁置。
2.  如果其父订单处于暂停状态，则不能取消暂停位置。

等等。从这些规则中，对我来说很明显这形成了一个聚合根边界。因此，我有一个`MyClient.Statuses.Order`聚合，`Statuses`上下文/服务的名称/您想调用的名称在哪里：

```
public class Order {
    private Guid _id;
    private OrderStatus _status;

    public void PlaceOnHold() {
        if (_status == OrderStatus.Cancelled)
            // throw exception

        _status = OrderStatus.OnHold;
        Locations.ForEach(loc => loc.PlaceOnHold());
    } 

    public void PlaceLocationOnHold(Guid id) {
        if (_status == OrderStatus.Cancelled)
            // throw exception
        Locations.Single(loc => loc.Id == id).PlaceOnHold();
    }

    // etc...

        private Location[] Locations;
}

internal class Location { 
    public Guid Id;
    public LocationStatus Status;

    public void PlaceOnHold() {
        // It's ok for a cancelled location on a non-cancelled order,
        // but a Location cannot be placed On Hold if it's Cancelled so 
        // just ignore it
        if (Status == LocationStatus.Cancelled)
            return; 

        Status = LocationStatus.OnHold;
    }
} 
```

这两个对象（订单、位置）在其他上下文中都有 GUID id（例如，对于没有状态转换的基于 CRUD 的属性）。所以现在我们终于解决了我的问题：

## 如何编写命令和处理程序以暂停位置？

我想保持这个东西 DRY 和面向服务以最小化耦合，但是在一个地方保持两个实体之间的父子关系真的很困难。

### 选项 1 - 单一位置 ID：

```
public class PlaceLocationOnHold_V1 {
    public readonly Guid Id;
}

public class PlaceLocationOnHold_V1Handler {
    public void Handle(PlaceLocationOnHold_V1 command) {
        // This is typically a no-no.  Should only fetch by OrderId:
        var aggregate = _repository.GetByLocationId(command.Id);  

        aggregate.PlaceLocationOnHold(command.Id);
        _repository.Save();
    }
} 
```

### 选项 2 - 订单 ID 和位置 ID：

```
public class PlaceLocationOnHold_V2 {
    public readonly Guid OrderId; // This feels redundant
    public readonly Guid LocationId;
}

public class PlaceLocationOnHold_V2Handler {
    public void Handle(PlaceLocationOnHold_V2 command) {
        var aggregate = _repository.GetById(command.OrderId);
        aggregate.PlaceLocationOnHold(command.LocationId);
        _repository.Save();
    }
} 
```

### 选项 3 - 具有封装“一个位置，属于一个订单”的类的单个参数

```
public class LocationIdentity {
    public Guid Id;
    public Guid OrderId;
}

public class PlaceLocationOnHold_V3 {
    public readonly LocationIdentity Location;
}

public class PlaceLocationOnHold_V3Handler {
    public void Handle(PlaceLocationOnHold_V3 command) {
        var aggregate = _repository.GetById(command.Location.OrderId);  
        aggregate.PlaceLocationOnHold(command.Location.Id);
        _repository.Save();
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T18:48:05.310

查看有关[有效聚合设计](http://dddcommunity.org/library/vernon_2011)的 Vaughn Vernon 文章。具体来说，[第 2 部分](http://dddcommunity.org/sites/default/files/pdf_articles/Vernon_2011_2.pdf)- 有一些关于建模相互通信的聚合的好信息。

您的设计中缺少的要点是，正如您已经提到的，它们都是 AR——它们是全球可识别的。所以他们应该通过ID相互引用。订单不应包含位置的子集合。

因此，您的 Order 类将有一个 LocationIds 的集合，而您的 Location 将有一个 OrderId。

```
public class Order
{
    private Guid _id;
    private OrderStatus _status;
    private Guid[] _locationIds;
    //...
}

public class Location
{
    private Guid _id;
    private Guid _orderId;
    //...
} 
```

一旦你正确地打破了这一点，选项 #1 就有意义了。由于 Location 本身就是一个 AR，因此您可以实例化它并直接在其上调用 PlaceOnHold，而无需通过 Order AR。

至于一个 AR 的变化会渗透到其他 AR 的情况（即暂停订单也会使所有位置也暂停），您可以使用域事件或最终一致性。

```
public class Order
{
    //... private instance variables

    public void PlaceOnHold()
    {
        if (_status == OrderStatus.Cancelled)
          // throw exception

        _status == Orderstatus.OnHold;

        DomainEvents.Handle(new OrderPlacedOnHold(_id)); // handle this, look up the related locations and call PlaceOnHold on each of them)
    }
} 
```

对于您可能试图删除对某个位置的保留，但订单处于保留状态而导致该操作非法的情况，您可以在命令处理程序中实例化 Order 对象并将其传递给该位置的 RemoveFromHold 方法。Vernon 提到了这一点并重申了这一点，即每笔交易只能 ALTER 一个 AR 并不意味着您不能在该交易中实例化多个 AR。

```
public class RemoveHoldFromLocation : IHandler<RemoveHoldFromLocationCommand>
{
    public void Execute(RemoveHoldFromLocationCommand cmd)
    {
        var location = locationRepo.Get(cmd.LocationId);
        var order = orderRepo.Get(location.GetOrderId());

        location.RemoveHold(order.GetStatus());
    }
}

public class Location
{
    //... private instance variables, etc.

    public void RemoveHold(OrderStatus orderStatus)
    {
        if (orderStatus == OrderStatus.OnHold)
            // throw Exception

        _status == LocationStatus.OnHold;
    }
} 
```

这只是伪代码，所以请原谅拼写错误等。类似的代码示例在 Vernon PDF 中。

# objective-c - 避免在文字字符串中使用转义字符

> ID：11851597
> 
> 赞同：1
> 
> 时间：2012-08-07T18:05:46.620
> 
> 标签：objective-c, syntax, string-literals

有没有办法可以避免 Objective-C 中文字字符串中的转义序列？

例如，在 C# 中，我可以为字符串添加前缀`@`并正常键入字符串，例如：`@"C:\Users"`，而不使用双反斜杠`"C:\\Users"`

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:17:33.920

在 Objective-C 中没有办法做到这一点。像这样的构造会`@"string"`生成`NSString`从 plain 构建的对象`"string"`。据我所知，你无法避免在 C 语言中转义。

# mysql - mysql_fetch_assoc() 返回的空值

> ID：11851599
> 
> 赞同：1
> 
> 时间：2012-08-07T18:05:48.370
> 
> 标签：mysql, null

我正在调用`mysql_fetch_assoc($res)`查询的结果。查询很好，同一行还有其他结果返回。最后一列始终为空。为什么是这样？

代码（已缩写，因此请不要对样式发表评论）：

```
$qy = "SELECT * FROM `entries` WHERE `dag`=".$_POST['day'];
        $res = mysql_query($qy, $sql);

        $d = '';
        $row = mysql_fetch_assoc($res);
        $d .= $row['text'];
        $e = json_encode($row);

        echo json_encode(array("status" => "success", "data" => $d, "error" => $e)); 
```

`$d`will equal`null`和`$e`will equal正确的数据`{"status":"success","data":null,"error":"{\"dag\":\"DATA\",\"afstand\":\"DATA\",\"tijd\":\"DATA\",\"max\":\"DATA\",\"tottijd\":\"DATA\",\"odo\":\"DATA\",\"van\":\"DATA\",\"naar\":\"DATA\",\"weer\":\"DATA\",\"text\":null}"}`在哪里。`DATA`列`text`是`null`。

该`text`列具有`VARCHAR`类型，最多 5000 个字符。我要检索的字段中的文本长度为 1800 个字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-02T09:01:03.693

我已经找到了两年前我自己的问题的答案。

问题是编码：该`text`列包含不是 UTF-8 编码的文本。当我包装代码以获取`text`a`utf8_encode()`时，一切都按预期工作。

# ios - 带有GLKit的GLPaint：绘图时闪烁

> ID：11851600
> 
> 赞同：3
> 
> 时间：2012-08-07T18:05:49.963
> 
> 标签：ios, opengl-es, opengl-es-2.0, glkit

我在一个类似于 GLPaint 的项目中遇到了 GLKit 的问题。

首先，我没有使用 GLKViewController，而只是添加到我的班级中的 GLKView。

我的问题是，当我在 GLKView 中绘图时，内容会闪烁。看起来好像我在第一次调用 GLKViewDelegate 的 drawRect 时在某个帧缓冲区中绘制，下一次调用它是一个不同的帧缓冲区，然后下一次调用它回到第一个，等等。我已经测试了这种可能性并且确实如此似乎并非如此，渲染缓冲区和帧缓冲区在所有绘图中都是相同的。

以下是我的绘图工作方式（类似于 GLPaint 示例代码）：

在触摸事件上，我调用 renderStroke 来生成在绘图中用于应用纹理并呈现线条的点。我正在使用自定义着色器，因此我将包含这些点的缓冲区放在预先指定的位置，以便着色器可以访问它：

```
// Give the vertex positions to the vertex shader
glVertexAttribPointer(ATTRIB_POSITION, 2, GL_FLOAT, 0, 0, vertexBuffer);
glEnableVertexAttribArray(ATTRIB_POSITION); 
```

然后，在draw方法中，我调用glDrawArrays：

```
- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {
    glDrawArrays(GL_POINTS, 0, self.verticesCount);
} 
```

这是我初始化 GLKView 的方式：

```
self.glView = [[GLKView alloc] initWithFrame:self.frame];
self.glView.context = _context;
self.glView.delegate = self;
self.glView.drawableColorFormat = GLKViewDrawableColorFormatRGBA8888;
self.glView.drawableStencilFormat = GLKViewDrawableStencilFormat8;
self.glView.enableSetNeedsDisplay = NO;
self.glView.userInteractionEnabled = NO;
[self addSubview:self.glView]; 
```

纹理，modelViewProjection 矩阵似乎工作正常，因为我可以看到正确的纹理应用于每个点。

我一直在寻找调试方法，但我看到的一切似乎都很正常。有什么我想念的吗？

谢谢！

**编辑：**

我想知道，当调用 drawRect 时，color_render_buffer 和 stencil_buffer 是否意味着在进一步绘制完成之前被清除？我在这里的目标是保留我之前完成的绘图并在其上绘制其他内容。如果没有 GLKit，这通常使用 kEAGLDrawablePropertyRetainedBacking 来完成。我使用以下方法在 glView 层上设置了它：

```
CAEAGLLayer * const eaglLayer = (CAEAGLLayer*) self.glView.layer;
eaglLayer.opaque = NO;
eaglLayer.drawableProperties = @{kEAGLDrawablePropertyRetainedBacking : @(YES)}; 
```

然而，这似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T09:49:17.670

是否在每帧重绘时对颜色和深度缓冲区执行 glClear()？我在上面的代码中没有看到它。

# java - 如何将 hashMap 转换为 Json 文件

> ID：11851603
> 
> 赞同：6
> 
> 时间：2012-08-07T18:05:57.350
> 
> 标签：java, gwt

我正在学习 Java。

我必须使用 rpc 将 Hashmap 传输到服务器。

哈希映射

```
Map<String, String> testMap = new HashMap<String, String>();
testMap .put("1", "abc");
testMap .put("2", "ezc");
testMap .put("3", "afc");
testMap .put("4", "cvc");
.. 
```

怎么做。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-07T18:12:09.490

看看[Jackson JSON 处理器](http://jackson.codehaus.org)。特别是代码看起来像：

```
Map map = your map
ObjectMapper mapper = new ObjectMapper();
String json = mapper.writeValueAsString(map); 
```

如果您想要漂亮的 JSON（多行）进行调试，请使用：

```
String json = mapper.defaultPrettyPrintingWriter().writeValueAsString(map); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-07T18:08:27.770

如果有帮助，请参阅此链接..

[http://www.mkyong.com/java/how-to-convert-java-map-to-from-json-jackson/](http://www.mkyong.com/java/how-to-convert-java-map-to-from-json-jackson/)

```
import com.fasterxml.jackson.databind.ObjectMapper;

ObjectMapper mapper = new ObjectMapper();
Map<String, String> testMap = new HashMap<String, String>(); 
testMap .put("1", "abc"); 
testMap .put("2", "ezc"); 
testMap .put("3", "afc"); 
testMap .put("4", "cvc"); 

      mapper.writeValue(new File("c:\\user.json"), testMap); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-07T19:14:49.130

你也可以试试`GSON`图书馆。它快速且易于使用。下面的包装类将使您的工作更加轻松

```
public class ConvertJsonToObject {

    private static Gson gson = new GsonBuilder().create();

    public static final <T> T getFromJSON(String json, Class<T> clazz) {
        return gson.fromJson(json, clazz);
    }

    public static final <T> String toJSON(T clazz) {
        return gson.toJson(clazz);
    }
} 
```

你需要做的就是

```
Map<String, String> testMap = new HashMap<String, String>();
testMap .put("1", "abc");
testMap .put("2", "ezc");
testMap .put("3", "afc");
testMap .put("4", "cvc");
String json = ConvertJsonToObject.toJSON(testMap); 
```

你可以很容易地得到你`original Object`的支持`other side`

```
Map<String, String> newTestMap = ConvertJsonToObject.getFromJSON(json,Map.class); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-07T19:55:50.637

我不明白：HashMap 是可序列化的，所以应该能够在客户端和服务器之间使用？

# php - 动态绑定参数 mysqli

> ID：11851617
> 
> 赞同：0
> 
> 时间：2012-08-07T18:07:00.383
> 
> 标签：php, oop, dynamic, mysqli, prepared-statement

我明白那个：

```
call_user_func_array(array(&$stmt, 'bindparams'), $array_of_params); 
```

是我需要做的，但我被困住了。

首先，我想他们仍然需要 s 和 i 对于您绑定的每个变量，如果是这样，我完全不知道如何实际执行它。我曾尝试使用`is_int`and读取变量`is_string`，但它只是不起作用并且正在切断我的实际变量值，我需要它来动态读取它至少是字符串还是 int。

如果有人可以给我一些示例或将我指向一个带有示例的站点，我将不胜感激。我已经搜索了谷歌，但似乎真的找不到任何东西，我已经找了几天了......

`MySQLi`如果需要，我可以提供我的课程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T20:05:57.443

[好的例子](http://www.devmorgan.com/blog/2009/03/27/dydl-part-3-dynamic-binding-with-mysqli-php/) 这就是我真正能找到的。除非它是一个大于 1 值的数组，否则它无法准备和绑定语句，因此您必须解决它以检查您在 $params 中传递的值是否是一个数组，除非我完全错了。不管怎样，我得到了它的工作。

# php - 从矩形图像创建新的方形图像而不进行裁剪

> ID：11851618
> 
> 赞同：0
> 
> 时间：2012-08-07T18:07:02.020
> 
> 标签：php, image, gd

我想允许用户上传一个图像文件，然后我想对其进行处理，使其最终成为一个正方形，除非不裁剪它。假设有人上传了一张 1400 宽和 800 像素高的图片，我想将其转换为 1400x1400 的图片，上传的图片居中位于顶部和底部的两个白条之间，以弥补额外的高度。

我该怎么做呢？到目前为止，我发现的所有解决方案都涉及裁剪，或者使用不同的语言。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:12:24.820

您需要做的就是：

1.  加载图像和数据。
2.  获取图像数据（`MIME`, `height`, `width`）并取高度和宽度的最大值来确定整体尺寸。
3.  `imagecreatetruecolor`使用步骤 2 中获得的最大值创建图像标识符。
4.  使用一些简单的数学将图像粘贴到正确的位置（使用左右距离：`(MAX_VALUE - MIN_VALUE) / 2`，在您的示例中`MAX_VALUE`为 1400px 和`MIN_VALUE`800px ）
5.  使用 GD 函数保存图像标识符。

**参考**：[http ://www.php.net/manual/en/book.image.php](http://www.php.net/manual/en/book.image.php)

# facebook - 让用户从 Facebook 应用程序发布到页面墙

> ID：11851619
> 
> 赞同：1
> 
> 时间：2012-08-07T18:07:08.230
> 
> 标签：facebook, facebook-graph-api, facebook-apps

我在 Facebook 页面 iFrame 选项卡中编写了一个 Facebook 应用程序。该应用程序包含几个图片谜语。现在我希望用户有机会将谜语和一些文字发布到页面墙上，以便向其他粉丝寻求谜语的帮助。我知道在用户墙上发帖没有问题，但我找不到上述问题的解决方案（应用到页面）。

有任何想法吗？我非常感谢有关该主题的任何帮助。

# css - 使图像元素固定位置并且不会在滚动时移动

> ID：11851627
> 
> 赞同：0
> 
> 时间：2012-08-07T18:07:35.923
> 
> 标签：css

我正在尝试将图像贴在页面左侧，例如“提供反馈”按钮：

[http://www.hotscripts.com/category/scripts/php/](http://www.hotscripts.com/category/scripts/php/)

我有以下 HTML 代码（我有其他代码，但只是为了展示一个示例）：

```
<img id="btn" class="btn" src="cl.png" height="161" width="34" alt="clear" /> 
```

和以下CSS：

```
#btn {
    display: block;
    position: fixed;
    left: 0;
    top: 54%;
    z-index: 100001;
    width: 34px;
    height: 168px;
    margin: -45px 0 0;
    padding: 0;
    cursor: pointer;
} 
```

由于某种原因，当我滚动页面时它不会产生相同的效果。我必须使用另一个 DIV 并包装按钮吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:24:14.530

您是否在标记中指定了 DOCTYPE 声明？这应该有效：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"> 
```

将此添加到文档的顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-22T14:17:28.267

另一种解决方案是使用“粘性”位置。

您可以在[此处查看 CodePen 上的代码。](https://codepen.io/haim1993/pen/eLoJwv)或以下：

```
.outer { 
  display: flex;
  height: 100vh;
  width: 100%;
}
.inner {
  height: 100px;
  width: 60px;
  position: sticky;
  top: 54px;
  left: 0;
}

<div class="outer style-one">
  <div class="inner style-two">
    <div class="style-three">
      <a href="#">Feedback</a>
    </div>
  </div>
<div> 
```

# dynamics-crm - CRM 2011 中自定义实体工作流的安全角色问题

> ID：11851630
> 
> 赞同：1
> 
> 时间：2012-08-07T18:07:43.843
> 
> 标签：dynamics-crm, dynamics-crm-2011, crm

我在 CRM 2011 中有一个自定义实体，用户可以创建一个实例。

创建该实例后，将启动一个工作流，该工作流会向用户发送电子邮件，要求他们批准该实例。

用户收到电子邮件并转到他们将其标记为已批准的实体的表单。

此时的工作流程正在等待做出批准决定（现在就是这样），但与用户安全角色有关的事情正在阻止工作流程继续进行。对于等待直到，工作流保持在“等待”状态。

如果我以管理员身份再次执行相同的步骤，则它可以正常工作。

为了不破坏工作流程，批准用户需要哪些权限？

我给了他们创建/写入/读取到实体，以及 WriteActivity、ReadQueue 但它不起作用

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T19:54:34.457

恐怕我能提供的只是这里的建议：

1.  工作流程实际上还在等待吗？还是它失败并处于等待状态？查看系统作业底部的部分中是否有错误。
2.  工作流实际上是以谁的身份运行的？- 看看系统作业 - 我相信重要的是该用户的权限。
3.  考虑这里的业务单位以及授予的实际权限，例如，记录是否由与工作流所有者不同的业务单位中的某个人拥有？
4.  如果缺少权限，您可能能够在 crm 跟踪日志中看到哪个权限，请查看异步日志。
5.  尝试授予用户以下权限：执行工作流作业、读取和写入系统作业、读取进程（如果您发现不需要它们，您可以稍后将它们删除）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T12:45:38.913

您是否确认工作流已在整个组织范围内发布？听起来这不应该是导致问题的原因，但我之前遇到过。

# magento - Magento 无法识别自定义 Topmenu.php

> ID：11851631
> 
> 赞同：0
> 
> 时间：2012-08-07T18:07:44.173
> 
> 标签：magento, navigation, rewrite

我已经构建了一个自定义模块，可以根据后端的自定义属性更改 Topmenu 链接文本。

该模块在 Magento CE 1.7.02 上进行了测试，并且可以 100% 运行。现在我正在 Magento EE 1.12.02 上进行测试，并且菜单无法识别重写的 Topmenu 类（因为，我可以从文件中删除所有内容，和/或在 XML 中拼错类名并且没有错误，并且网站加载正常）。

有些东西告诉我，企业版从与社区版不同的位置提取此菜单，但我找不到该位置。

这是我的配置 XML 的相关部分：

```
<blocks>
    <page>
        <rewrite>
            <html_topmenu>WorldSynergy_Seoadditions_Block_Html_Topmenu</html_topmenu>
        </rewrite>
    </page>
</blocks> 
```

这是 Topmenu.php 类：

```
class WorldSynergy_Seoadditions_Block_Html_Topmenu extends Mage_Page_Block_Html_Topmenu
{

    /**
 * Recursively generates top menu html from data that is specified in $menuTree
 *
 * @param Varien_Data_Tree_Node $menuTree
 * @param string $childrenWrapClass
 * @return string
 */
protected function _getHtml(Varien_Data_Tree_Node $menuTree, $childrenWrapClass)
{
    $html = '';

    $children = $menuTree->getChildren();
    $parentLevel = $menuTree->getLevel();
    $childLevel = is_null($parentLevel) ? 0 : $parentLevel + 1;

    $counter = 1;
    $childrenCount = $children->count();

    $parentPositionClass = $menuTree->getPositionClass();
    $itemPositionClassPrefix = $parentPositionClass ? $parentPositionClass . '-' : 'nav-';

    foreach ($children as $child) {

        $child->setLevel($childLevel);
        $child->setIsFirst($counter == 1);
        $child->setIsLast($counter == $childrenCount);
        $child->setPositionClass($itemPositionClassPrefix . $counter);

        $outermostClassCode = '';
        $outermostClass = $menuTree->getOutermostClass();

        if ($childLevel == 0 && $outermostClass) {
            $outermostClassCode = ' class="' . $outermostClass . '" ';
            $child->setClass($outermostClass);
        }

        $childId = explode( "-" , $child->getId() );
        $childId = $childId[2];

        $attrs = Mage::getModel("catalog/category")->getAttributes();
        $altName = $attrs['ws_menutitle']->getFrontEnd()->getValue( Mage::getModel("catalog/category")->load( $childId ) );

        if( empty($altName) ){ $altName = $child->getName(); }

        $html .= '<li ' . $this->_getRenderedMenuItemAttributes($child) . '>';
        $html .= '<a href="' . $child->getUrl() . '" ' . $outermostClassCode . '><span>ABC'
            . $this->escapeHtml($altName) . '</span></a>';

        if ($child->hasChildren()) {
            if (!empty($childrenWrapClass)) {
                $html .= '<div class="' . $childrenWrapClass . '">';
            }
            $html .= '<ul class="level' . $childLevel . '">';
            $html .= $this->_getHtml($child, $childrenWrapClass);
            $html .= '</ul>';

            if (!empty($childrenWrapClass)) {
                $html .= '</div>';
            }
        }
        $html .= '</li>';

        $counter++;
    }

    return $html;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T20:06:19.847

我在 1.11.1.0，但我相信同样的事情正在发生。

如果您查看`app/design/frontend/base/default/layout/page.xml`，您会发现该`top.menu`块缺少`page/html_topmenu`CE 拥有的块。

```
<block type="core/text_list" name="top.menu" as="topMenu" translate="label">
    <label>Navigation Bar</label>
</block> 
```

然后，在 中`app/design/frontend/base/default/layout/catalog.xml`，他们将目录导航块插入到`top.menu`块中：

```
<reference name="top.menu">
    <block type="catalog/navigation" name="catalog.topnav" template="catalog/navigation/top.phtml"/>
</reference> 
```

奇怪的是，他们做了这一切`app/design/frontend/base`，而不是`app/design/frontend/enterprise`。

# mysql - 给定一个 MySQL 事务 id，有没有办法查看已运行的查询的日志？

> ID：11851632
> 
> 赞同：3
> 
> 时间：2012-08-07T18:07:45.667
> 
> 标签：mysql

我有一个 MySQL 事务 ID，和一个可爱的 MySQL 控制台。有没有办法从中获取已在该事务中运行的查询列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:15:19.143

我假设“事务 id”是指“线程 id”。

这只有在您启用通用查询日志时才有可能。这会记录服务器上运行的每个查询。它增加了足够的开销，以至于大多数人不会在生产中使用它。但是，如果您碰巧在您的环境中使用`general_log = 'ON'`和`log_output = 'TABLE'`，那么您可以查看给定线程 id 的查询历史记录，如下所示：

```
select * 
from mysql.general_log
where thread_id = <your_thread_id>
order by event_time desc 
```

id 最终会翻转，因此您可能应该将查询限制在适当的时间窗口（过去一小时、过去一天等）。例如，将其限制为过去一天：

```
select * 
from mysql.general_log
where thread_id = <your_thread_id>
and event_time >= now() - interval 1 day
order by event_time desc 
```

# asp.net-mvc - 团队如何在 VB ASP.NET MVC 站点上工作？

> ID：11851633
> 
> 赞同：0
> 
> 时间：2012-08-07T18:07:53.170
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3

在 PHP 中，您只需登录 FTP 并查看所有文件。当我发布一个不包含控制器或模型的站点时，我注意到在 VB ASP.NET MVC 中。相反，它似乎将它们编译成 DLL。如何在无法访问原始文件的情况下修改文件？开发人员是否必须在单独的目录中发布文件，然后其他开发人员将它们拉下来并在 Visual Studio 中打开项目？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T18:09:20.487

将您的源代码保存在 SVN /GIT /TFS 等**版本控制系统中。每当您想要进行更新时，获取您想要更新的特定版本并对其进行更新。**

拥有版本控制会给你带来很多好处

**1）协同工作**。团队的许多成员可以在相同的代码库上工作而不会覆盖冲突

**2）恢复到以前的版本**：当前的生产动作有问题吗？。只需获取运行良好（并且在 prod 中运行）的先前版本（标签）并回滚到该版本，直到您解决问题。

保留以前版本的代码将在程序员/团队的生活中节省大量时间。

这个 SO question 关于[为什么我们应该使用版本控制](https://stackoverflow.com/questions/1408450/why-should-i-use-version-control)有很好的观点。

**版本控制不仅适用于 Teams**。个人开发人员可以将他们的代码保存在版本控制中并睡得很好

顺便说一句，您的 MVC 项目的模型类和控制器类被编译到 DLL 文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:11:47.667

我见过很多使用 Visual Studio 的公司实施 Visual Source Safe。

信息可以在这里找到[http://msdn.microsoft.com/en-us/library/3h0544kx%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/3h0544kx%28v=vs.80%29.aspx)

否则这几乎就是Shyju所说的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:15:04.393

在专业环境中，编辑源代码和部署到生产环境之间有非常明显的区别。你似乎没有区别。

通常，开发人员使用 SVN 等源代码控制系统在仔细控制下进行更改。

然后由专门的团队成员单独完成构建和部署。开发人员不会随意接触生产服务器。

> 如何在无法访问原始文件的情况下修改文件？

我不明白。如果您希望开发人员能够完全访问生产环境，为什么不让他们也完全访问源代码呢？在您的 PHP 示例中，这是给定的。

# erlang - 为什么 Dialyzer 没有发现此代码错误？

> ID：11851639
> 
> 赞同：6
> 
> 时间：2012-08-07T18:08:14.737
> 
> 标签：erlang, static-analysis, dialyzer

我根据[本](http://learnyousomeerlang.com/dialyzer#polymorphic-types)教程创建了下面的代码片段。最后两行 (`feed_squid(FeederRP)`和`feed_red_panda(FeederSquid)`) 显然违反了定义的约束，但 Dialyzer 发现它们没问题。这非常令人失望，因为这正是我想要使用执行静态分析的工具捕获的错误类型。

教程中提供了一个解释：

> 在使用错误类型的馈线调用函数之前，首先使用正确的类型调用它们。从 R15B01 开始，Dialyzer 不会发现此代码有错误。观察到的行为是，只要在函数体内成功调用给定函数，Dialyzer 就会忽略同一代码单元中的后续错误。

这种行为的理由是什么？我知道成功打字背后的哲学是“永远不要哭狼”，但在当前情况下，Dialyzer 显然忽略了有意定义的函数规范（在它看到函数已被正确调用之后）。我了解该代码不会导致运行时崩溃。我能以某种方式强迫 Dialyzer 始终认真对待我的功能规范吗？如果没有，是否有工具可以做到这一点？

```
-module(zoo).
-export([main/0]).

-type red_panda() :: bamboo | birds | eggs | berries.
-type squid() :: sperm_whale.
-type food(A) :: fun(() -> A).

-spec feeder(red_panda) -> food(red_panda());
            (squid) -> food(squid()).
feeder(red_panda) ->
    fun() ->
            element(random:uniform(4), {bamboo, birds, eggs, berries})
    end;
feeder(squid) ->
    fun() -> sperm_whale end.

-spec feed_red_panda(food(red_panda())) -> red_panda().
feed_red_panda(Generator) ->
    Food = Generator(),
    io:format("feeding ~p to the red panda~n", [Food]),
    Food.

-spec feed_squid(food(squid())) -> squid().
feed_squid(Generator) ->
    Food = Generator(),
    io:format("throwing ~p in the squid's aquarium~n", [Food]),
    Food.

main() ->
    %% Random seeding
    <<A:32, B:32, C:32>> = crypto:rand_bytes(12),
    random:seed(A, B, C),
    %% The zoo buys a feeder for both the red panda and squid
    FeederRP = feeder(red_panda),
    FeederSquid = feeder(squid),
    %% Time to feed them!
    feed_squid(FeederSquid),
    feed_red_panda(FeederRP),
    %% This should not be right!
    feed_squid(FeederRP),
    feed_red_panda(FeederSquid). 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T10:40:03.363

尽量减少这个例子，我有这两个版本：

Dialyzer 可以捕获的第一个：

```
-module(zoo).
-export([main/0]).

-type red_panda_food() :: bamboo.
-type squid_food()     :: sperm_whale.

-spec feed_squid(fun(() -> squid_food())) -> squid_food().
feed_squid(Generator) -> Generator().

main() ->
    %% The zoo buys a feeder for both the red panda and squid
    FeederRP = fun() -> bamboo end,
    FeederSquid = fun() -> sperm_whale end,
    %% CRITICAL POINT %%
    %% This should not be right!
    feed_squid(FeederRP),
    %% Time to feed them!
    feed_squid(FeederSquid) 
```

然后是没有警告的：

```
 [...]
    %% CRITICAL POINT %%
    %% Time to feed them!
    feed_squid(FeederSquid)
    %% This should not be right!
    feed_squid(FeederRP). 
```

Dialyzer 对它可以捕获的版本的警告是：

```
zoo.erl:7: The contract zoo:feed_squid(fun(() -> squid_food())) -> squid_food() cannot be right because the inferred return for feed_squid(FeederRP::fun(() -> 'bamboo')) on line 15 is 'bamboo'
zoo.erl:10: Function main/0 has no local return 
```

......并且是一个更愿意相信自己的判断而不是用户更严格的规范的案例。

对于它没有捕捉到的版本，Dialyzer 假定`feed_squid/1`参数的类型`fun() -> bamboo`是`fun() -> none()`（一个会崩溃的闭包，如果没有在内部调用`feed_squid/1`，它仍然是一个有效的参数）的超类型。在推断出类型之后，Dialyzer 无法知道传递的闭包是否在函数中实际被调用。

如果使用该选项，Dialyzer 仍会发出警告`-Woverspecs`：

```
zoo.erl:7: Type specification zoo:feed_squid(fun(() -> squid_food())) -> squid_food() is a subtype of the success typing: zoo:feed_squid(fun(() -> 'bamboo' | 'sperm_whale')) -> 'bamboo' | 'sperm_whale' 
```

...警告没有什么可以阻止此功能处理其他馈线或任何给定的馈线！如果该代码**确实**检查了闭包的预期输入/输出，而不是通用的，那么我很确定 Dialyzer 会抓住滥用。从我的角度来看，如果您的实际代码检查错误输入而不是依赖类型规范和 Dialyzer（它们从未承诺会找到所有错误）会好得多。

## 警告：以下是深奥的部分！

第一种报错，第二种报错，与module-local细化进度有关。最初，该功能`feed_squid/1`已成功键入`(fun() -> any()) -> any()`。在第一种情况下，该函数`feed_squid/1`将首先仅使用`FeederRP`和肯定会返回`bamboo`，立即伪造规范并停止对 的进一步分析`main/0`。在第二种情况下，该函数`feed_squid/1`将首先使用`FeederSquid`and 肯定会返回`sperm_whale`，然后使用`FeederSquid`and`FeederRP`和 return `sperm_whale`OR进行优化`bamboo`。然后使用预期的返回值调用时，`FeederRP`成功类型为`sperm_whale`OR `bamboo`。然后规范承诺它将是`sperm_whale`Dialyzer 接受它。另一方面，论点应该是`fun() -> bamboo | sperm_whale`成功键入的，`fun() -> bamboo`所以它只剩下`fun() -> bamboo`. 当根据规范 ( `fun() -> sperm_whale`) 检查时，Dialyzer 假定参数可能是`fun() -> none()`. 如果您从未在其中调用传递的函数`feed_squid/1`（Dialyzer 的类型系统不会将其作为信息保存），并且您在规范中承诺您将始终返回`sperm_whale`，那么一切都很好！

可以“修复”的是类型系统被扩展以记录作为参数传递的闭包何时在调用中实际使用，并在“生存”类型推断的某些部分的唯一方法是警告的情况下发出警告成为`fun(...) -> none()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T09:42:44.640

（注意，我在这里推测了一下。我没有详细阅读透析器代码）。

“Normal”成熟的类型检查器的优点是类型检查是可确定的。当类型检查器终止时，我们可以询问“这个程序的类型是否正确”并返回是或否。透析器不是这样。它本质上是在解决停机问题。结果是会有一些明显错误的程序，但仍然会从透析器的控制中溜走。

但是，这不是其中一种情况:)

问题有两个方面。成功类型表示“如果此函数*正常*终止，它的类型是什么？”。在上面，我们的函数终止于与任意类型`feed_red_panda/1`匹配的任何参数。我们可以打电话，它也应该工作。因此，我们对函数 in 的两次调用不会产生问题。他们都终止了。`fun (() -> A)``A``feed_red_panda(fun erlang:now/0)``main/0`

问题的第二部分是“您是否违反了规范？”。请注意，通常情况下，透析器中并未使用规格作为事实。它推断类型本身并使用推断模式而不是您的规范。每当调用函数时，都会使用参数对其进行注释。在我们的例子中，它将使用两种生成器类型进行注释：`food(red_panda()), food(squid())`. 然后根据这些注释进行*函数局部*分析，以确定您是否违反了规范。由于注释中存在正确的参数，我们必须假设该函数在*某些情况下正确使用*部分代码。它也被 squids 调用可能是由于其他情况而从未调用过的代码工件。由于我们是函数本地的，我们不知道并给程序员带来怀疑的好处。

如果您将代码更改为仅使用 squid-generator 进行错误调用，那么我们会发现规范差异。因为我们知道唯一可能的调用站点违反了规范。如果您将错误的调用移至另一个函数，也*不会*找到它。因为注释仍在函数上，而不是在调用站点上。

可以想象透析器的未来变体，它解释了每个呼叫站点都可以单独处理的事实。由于透析器会随着时间的推移而发生变化，因此将来它可能能够处理这种情况。但目前，这是会漏掉的错误之一。

关键是要注意透析器不能用作“类型良好的检查器”。你不能用它来强制你的程序结构。你需要自己做。如果您想要更多的静态检查，可能会为 Erlang 编写一个类型检查器并在您的部分代码库上运行它。但是你会遇到代码升级和分发的麻烦，这些都不容易处理。

# spring - Spring-data-rest 和 Spring-jpa

> ID：11851645
> 
> 赞同：2
> 
> 时间：2012-08-07T18:08:34.950
> 
> 标签：spring, rest, spring-data-rest

数据休息和 jpa。

我使用@EmbeddedId 创建了一个具有复合键的实体

并且存储库使用 findById 查询参数扩展 CrudRepository

当我输入网址时

[链接] ( [http://localhost:8080/data/person/search/findById?findById=1,2&name=abc](http://localhost:8080/data/person/search/findById?findById=1,2&name=abc) )

我收到错误，无法将字符串转换为 Long。

有什么方法可以使用 Spring JPA 将字符串转换为 Long 列表？

请帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T22:12:13.023

实际上，我今天只是在研究这个功能。

在最新的快照版本中，有一个新的注解：`@ConvertWith`. [您将Spring Core Converter](http://static.springsource.org/spring-framework/docs/3.1.2.RELEASE/javadoc-api/org/springframework/core/convert/converter/Converter.html)实现的类名放在该注释中，导出器将使用该转换器将`String[]`查询参数值转换为查询方法的参数。

有一个[如何在测试中的存储库中使用它](https://github.com/SpringSource/spring-data-rest/blob/master/spring-data-rest-webmvc/src/test/java/org/springframework/data/rest/test/webmvc/PersonRepository.java#L33)的示例（我将很快更新 wiki，但还没有机会，因为这些新快照上的墨水甚至还没有变干 :)。要在 URL 查询字符串中传递多个值，请多次引用同一个名称：

```
http://localhost:8080/people/search/findById?id=1&id=2&id=3 
```

当然，您可以选择将多个值编码为单个参数值（例如，以逗号分隔）并在您自己的转换器中进行转换。`String[]`无论如何，您仍然会被传递给您的自定义转换器。

# jqgrid - struts 2 jquery grid - 双击子网格行上的editGridRow不显示数据

> ID：11851646
> 
> 赞同：2
> 
> 时间：2012-08-07T18:08:47.867
> 
> 标签：jqgrid

我正在使用 struts2 jquery grid 3.1.0 版本。我需要在双击时显示行详细信息。我使用以下代码来显示已编辑的行。但是对话框在双击时显示一个空对话框。对此的任何帮助将不胜感激。代码附在下面

```
 var parentSelRow = jQuery(gridFn.$id).jqGrid('getGridParam',
                'selrow');
        var grid = $(gridFn.$id);
        var gridSub = $(gridFn.$id + "_" + parentSelRow + "_table");
        gridSub.dblclick(function(e) {
            var td = e.target;
            var ptr = $(td, gridSub[0].rows).closest("tr.jqgrow");
            if ($(ptr).length === 0) {
                return false;
            }
            var ri = ptr[0].rowIndex;
            var ci = $.jgrid.getCellIndex(td);
            var rowId = $(ptr).attr("id");
            alert(rowId);
            var selectedRow = gridSub.jqGrid('getGridParam', ('selrow'));
            if (selectedRow != null && selectedRow.length > 0) {
                gridSub.jqGrid('editGridRow', rowId, {
                    editCaption : "View Record",
                    width : 660,
                    recreateForm : true,
                    recreateFilter : true,
                    viewPagerButtons : true,
                    onInitializeForm : gridFn.initializeViewForm,
                    beforeShowForm : gridFn.beforeViewForm,
                    afterShowForm : gridFn.afterViewForm,
                    onClose : gridFn.onCloseViewForm,
                    closeAfterAdd : true,
                    closeOnEscape : true,
                    errorTextFormat : gridFn.errorTextFormat});     } 
```

# c# - Httpwebrequest--使用文本文件的POST方法

> ID：11851650
> 
> 赞同：0
> 
> 时间：2012-08-07T18:08:53.487
> 
> 标签：c#, .net, httpwebrequest, couchdb

我正在尝试使用 .NET 类而不是 curl 命令行来复制 Couch 数据库。我以前从未使用过 WebRequest 或 Httpwebrequest，但我正在尝试使用它们通过下面的脚本发出发布请求。

这是用于 couchdb 复制的 JSON 脚本（我知道这可行）：

```
{ ""_id"":"database_replicate8/7/12", "source":sourcedb, ""target"":"targetDB", ""create_target"":true, ""user_ctx"": { ""roles"": ["myrole"] } } 
```

上面的脚本被放入一个文本文件 sourcefile.txt 中。我想采用这条线并将其放入使用 .NET 功能的 POST Web 请求中。

经过研究，我选择使用 httpwebrequest 类。以下是我目前所拥有的——我从[http://msdn.microsoft.com/en-us/library/debx8sh9.aspx得到的](http://msdn.microsoft.com/en-us/library/debx8sh9.aspx)

```
 HttpWebRequest bob = (HttpWebRequest)WebRequest.Create("sourceDBURL");
 bob.Method = "POST";
 bob.ContentType = "application/json";
 byte[] bytearray = File.ReadAllBytes(@"sourcefile.txt");
 Stream datastream = bob.GetRequestStream();
 datastream.Write(bytearray, 0, bytearray.Length);
 datastream.Close(); 
```

我这样做对吗？我对网络技术相对较新，并且仍在学习 http 调用的工作原理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:21:08.850

Here is a method I use for creating POST requests:

```
 private static HttpWebRequest createNewPostRequest(string apikey, string secretkey, string endpoint)
 {
    HttpWebRequest request = WebRequest.Create(endpoint) as HttpWebRequest;
    request.Proxy = null;
    request.Method = "POST";
    //Specify the xml/Json content types that are acceptable. 
    request.ContentType = "application/xml";
    request.Accept = "application/xml";

    //Attach authorization information
    request.Headers.Add("Authorization", apikey);
    request.Headers.Add("Secretkey", secretkey);
    return request;
 } 
```

Within my main method I call it like this:

```
HttpWebRequest request = createNewPostRequest(apikey, secretkey, endpoint); 
```

and I then pass my data to the method like this:

```
string requestBody = SerializeToString(requestObj);

byte[] byteStr = Encoding.UTF8.GetBytes(requestBody);
request.ContentLength = byteStr.Length;

using (Stream stream = request.GetRequestStream())
{
    stream.Write(byteStr, 0, byteStr.Length);
}

//Parse the response
using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
{
    //Business error
    if (response.StatusCode != HttpStatusCode.OK)
    {
        Console.WriteLine(string.Format("Error: response status code is{0}, at time:{1}", response.StatusCode, DateTime.Now.ToString()));

        return "error";
    }
    else if (response.StatusCode == HttpStatusCode.OK)//Success
    {
        using (Stream respStream = response.GetResponseStream())
        {
            XmlSerializer serializer = new XmlSerializer(typeof(SubmitReportResponse));
            reportReq = serializer.Deserialize(respStream) as SubmitReportResponse;
        }

     }
... 
```

In my case I serialize/deserialize my body from a class - you will need to alter this to use your text file. If you want an easy drop in solution, then change the `SerializetoString` method to a method that loads your text file to a string.

# mysql - phpMyAdmin 说 2.2GB，但 mysqldump 是 25GB，有什么想法吗？

> ID：11851651
> 
> 赞同：0
> 
> 时间：2012-08-07T18:08:55.137
> 
> 标签：mysql, phpmyadmin, mysqldump

我试图弄清楚为什么我的数据库转储如此之大。

phpMyAdmin 声明数据库总大小为 2.2GB

MySql DUMP 为 25GB

为什么转储比 phpMyAdmin 中规定的大小大得多？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:12:51.957

MySQL 转储是纯文本文件，带有重新创建表及其内容所需的 SQL 命令。

而不是这个，phpMyAdmin 显示数据库的二进制大小。

# ruby - 使用 Bundler 获取 git 文件时出错

> ID：11851652
> 
> 赞同：1
> 
> 时间：2012-08-07T18:08:56.967
> 
> 标签：ruby, git, gem, bundler

宝石文件：

```
source "http://rubygems.org"
gem "nokogiri", :git => "git://github.com/tenderlove/nokogiri.git" 
```

当我运行时`bundle`，出现以下错误：

```
Fetching git://github.com/tenderlove/nokogiri.git
Unfortunately, a fatal error has occurred. Please see the Bundler troubleshooting documentation at http://bit.ly/bundler-issues. Thanks!
C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.4/lib/bundler/source.rb:592:in ``': No such file or directory - git clone "git://github.com/tenderlove/nokogiri.git" "C:/Ruby193/lib/ruby/gems/1.9.1/cache/bundler/git/nokogiri-d4bf05cb9e65f144f074351e5ebe3a0e44c00952" --bare --no-hardlinks (Errno::ENOENT) 
```

我该如何解决？

它不仅可以用这种宝石重现，还可以用其他宝石重现：黄瓜、水豚

我使用 Windows。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-09T15:01:12.363

这是因为我没有安装 Git。

我安装了 Git 并将其添加到 PATH 系统变量中。`bundle`在那之后开始工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T01:49:31.273

对于其他任何新手，我使用[msysgit](http://msysgit.github.com/)在 Windows 7 上安装了 Git 。

然后在命令`msysgit`窗口（`MINGW32`

谢谢你帮我解决这个安德烈。

# time - 离线机器中的 NTP 时间同步

> ID：11851653
> 
> 赞同：0
> 
> 时间：2012-08-07T18:08:58.587
> 
> 标签：time, synchronization, offline, ntp

我在集群中有几个离线节点。我希望他们的时间同步，所以我将其中一个节点配置为 NTP 服务器。

这是我的 NTP 服务器的配置文件：

`# node's ip:192.168.17.11`

`driftfile /etc/ntp.drift`
`server 192.168.17.11`
`fudge 192.168.17.11 stratum 1`
`restrict 192.168.17.0 mask 255.255.255.0 nomodify notrap`
`restrict -4 default kod notrap nomodify nopeer noquery`

问题是其他机器无法与这台机器同步时间。此配置文件是否适合用作 NTP 服务器？

谢谢你，阿里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:17:08.993

使用 127.0.0.1 作为服务器 IP，您不允许 LAN 中的其他计算机与 NTP 服务器通信。

尝试通过配置文件中服务器的 LAN IP 更改 127.0.0.1。

# javascript - 使用jQuery单击其缩略图时如何显示主图像

> ID：11851654
> 
> 赞同：-1
> 
> 时间：2012-08-07T18:09:08.057
> 
> 标签：javascript, jquery

我的 DOM 看起来像这样......

```
<div id="leftPan">
    <div id="leftmemberPan">
        <a href="#"><img src="/MyApp/images/${article.images[0].imageName}" alt="/MyApp/img/image_unavailable.jpg" class="testingMain"/></a>    
    </div>
    <div id="thumbnailPan">
        <c:forEach items="${article.images}" var="image">                       
            <a href="#"><img src="/MyApp/images/${image.imageName}" alt="/MyApp/img/image_unavailable.jpg" class="testing"/></a>                        
        </c:forEach>
    </div>
</div> 
```

`leftmemberPan`正在显示主图像并`thumbnailPan`正在显示缩略图列表

`<c:forEach items="${article.images}" var="image">`只是一个保存缩略图数组的 JSTL 标记。

请注意，我是 jQuery 新手，并且是第一次使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:16:01.493

您可以在缩略图的 alt 标记中保存主图像 src 的列表，然后修改 leftmemberPan src 以显示主图像。

前任：

```
<img id="leftmemberPan" src="myplace_holder.jpg" />
<img class="thumbnail myimg.jpg" src="myimg_thumbnail.jpg" />

<script type="text/javascript">
    $(".thumbnail").click(function()
    {
        var class_array = $(this).attr("class").split(' ');
        var newsrc = class_array[class_array.length-1]; // Pull new src from the class tag (assuming it's the last one)
        $("#leftmemberPan").attr('src', newsrc);
    });
</script> 
```

请记住，这只是一种方法。您还可以通过许多其他方式存储主图像。

希望这可以帮助！

编辑：更新了代码示例以利用类属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:17:36.980

我会将您的图像路径放入每个缩略图的数据路径标签中，然后当您单击缩略图时，从数据路径中获取该路径并将`src`主图像的路径设为该路径。

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:30:24.173

修改以前的帖子/答案（使用 jQuery 1.7）...

```
<img class="thumbnail" data-file="myimg.jpg" src="myimg_thumbnail.jpg" />

<script type="text/javascript">
    var mainImage = $("img","#leftmemberPan")[0];
    $("#thumbnailPan").on("click", ".thumbnail", function(event){
        mainImage.src = $(this).data("file");
    });
</script> 
```

*   对主文件图像路径使用数据属性。
*   在页面加载后执行一次（-time）DOM 查找以引用主图像元素。
*   只需使用缩略图的数据属性设置图像元素的 src 属性。

# visual-studio-2008 - 如何创建自定义 SSRS 报告形状？

> ID：11851656
> 
> 赞同：0
> 
> 时间：2012-08-07T18:09:11.533
> 
> 标签：visual-studio-2008, reporting-services, reporting-services-map

我正在尝试在 Visual Studio 中创建一个简单的 SSRS 地图报告。我使用内置地图功能来创建一个，但我需要创建自定义区域，然后我将覆盖美国的位图图像。我该如何创建这些自定义区域？我需要根据销售数据对它们进行动态着色。真的迷路了，所以我很感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T04:05:45.910

对于自定义形状，您需要将形状作为 ESRI 文件获取，或者将形状转换为 SQL Server 空间数据多边形。我在这里有一些提示：

[http://blog.datainspirations.com/2010/05/11/sql-server-2008-r2-reporting-services-the-word-is-but-a-stage-t-sql-tuesday-006/](http://blog.datainspirations.com/2010/05/11/sql-server-2008-r2-reporting-services-the-word-is-but-a-stage-t-sql-tuesday-006/)

[http://blog.datainspirations.com/2011/03/24/multi-state-maps-in-reporting-services/](http://blog.datainspirations.com/2011/03/24/multi-state-maps-in-reporting-services/)

底线 - 您唯一的选择是 US、ESRI Shapefile 或 SQL Server 空间数据的内置地图。

# c# - 使用不断变化的命名空间前缀

> ID：11851657
> 
> 赞同：0
> 
> 时间：2012-08-07T18:09:19.190
> 
> 标签：c#, sql-server, xpath, xquery, xml-namespaces

假设我使用相同的模式从两个不同的供应商处获得了两个不同的 xml 文档。他们各自选择了不同的命名空间前缀。如何在 C# 和 SQL Server 中使用 XPATH 以通用方式查询“Foo”和“Bar”的值？为简洁起见，XML 大致如下所示：

文件 1

```
<a:Item xmlns:a="http://kakridge.com/schema">Foo</a:Item> 
```

文件 2

```
<b:Item xmlns:b="http://kakridge.com/schema">Bar</a:Item> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T20:18:07.510

XPath 不关心源文档中出现的前缀，它只关心名称空间 URI。如果前缀 z 绑定到命名空间[http://kakridge.com/schema](http://kakridge.com/schema)，那么 //z:Item 将在这两个文档中找到 Item 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:30:09.633

我猜你正在寻找 , 和`Item`的`Foo`值`bar`？如果您的元素的本地名称相同，通配符应该可以帮助您：

```
//*:Item/text() 
```

# http-status-code-403 - Google Weather API 返回 HTTP 403 错误

> ID：11851659
> 
> 赞同：0
> 
> 时间：2012-08-07T18:09:34.763
> 
> 标签：http-status-code-403, weather-api, google-weather-api

我在我的网站中使用 Google 天气 API，今天我收到一个错误，即 API 链接不返回任何数据。

当我直接检查链接时，我得到一个（错误 403）。

[这是链接](http://www.google.com/ig/api?weather=Cairo-Egypt&hl=en)。

谁能告诉我一个解决方案并为我提供另一个 API 链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T08:49:39.783

API 有时会在短时间内停止工作，最后几天更经常出现 403。对于我的网站，昨晚发生了 13 次。但是该站点立即再次尝试，第二次或第三次，数据加载没有问题。由于 API 是非官方的，因此不确定导致 403 的原因。

确保您缓存数据，因为当您发出过多请求时，API 会暂时阻止您的 IP。就我而言，我缓存了 20 分钟，如果无法检索到数据，该站点将不会尝试超过 10 次来重新加载 API。一旦我在调试后忘记打开缓存并且我的网站做了数百个请求（每个访问者），IP 在一个小时内就被阻止了。如果记得正确，则错误不是 403。幸运的是，该块持续了不到半天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T19:48:45.423

当前对您正在使用的 Google Weather API 有间歇性的 403 Forbidden 响应。请参阅[Google Weather API 403 错误](https://stackoverflow.com/questions/11878143/google-weather-api-403-error/)

间歇性 403 响应的原因尚不清楚，但自 2012 年 8 月 7 日以来一直存在问题。

# javascript - 谷歌图表折线图

> ID：11851663
> 
> 赞同：0
> 
> 时间：2012-08-07T18:09:43.363
> 
> 标签：javascript, google-visualization

我是谷歌图表的新手，似乎无法弄清楚我将如何做以下事情：

我想制作一个包含我的 xcord、ycord、legendlabel 的数据表。我正在尝试以下操作：

```
var data = google.visualization.arrayToDataTable([]);   

            data.addColumn("number","reps");
            data.addColumn("number","weight");
            data.addColumn("string","legendlabel")

            data.addColumn("string","workoutname");

            data.addRows([[150, 10,"workoutA"],
                          [300, 2,"workoutB"], //format [xcord,ycord,legendlabel] 

                        ]); 
```

但是，它显然不起作用，因为我们有两种不同的类型，数字和字符串。

有没有办法我可以指定xcord，ycord然后为这一点设置一个标签，然后如果有多个相同的标签，它会形成一个折线图？

提前谢谢各位！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-31T18:46:30.453

使用折线图，每条数据线都必须为域上的每个点都有一个值，否则线会被破坏，你想要的是[散点图](https://google-developers.appspot.com/chart/interactive/docs/gallery/scatterchart)

然后，您的图表数据应如下所示：

```
var data = google.visualization.arrayToDataTable([]);   

data.addColumn("number","reps");
data.addColumn("number","workout1");
data.addColumn("number","workout2");

data.addRows([
    [150, 10, null],
    [300, null, 2,]
]); 
```

您将需要设置**lineWidth**以查看趋势曲线

```
chart.draw(data, {
    lineWidth: 2,
    vAxis: {title: "reps"},
    hAxis: {title: "weight"}
} 
```

# c++ - osgDB/FileUtils 在我的代码中导致编译器错误

> ID：11851666
> 
> 赞同：0
> 
> 时间：2012-08-07T18:10:01.690
> 
> 标签：c++, compiler-errors, kde, opensuse, openscenegraph

我正在尝试使用 OSG 编译我的项目，并在 OpenSUSE 12.1 中为它安装了所有必要的 rpm。我不确定发生了什么，因为我所做的只是#include，而我的编译器（gcc 4.6.2）在其中崩溃说：

'（'令牌之前的预期标识符'

问题是当我单击错误时，它会将我带到 FileUtils 中

枚举值 {

好的，

SOURCE_EQUALS_DESTINATION,

... 等等

};

我不明白发生了什么，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:32:26.847

显然这是某个地方的语法错误，因为预处理器遇到了一些意想不到的东西。`enum Value { ... };`您发布的小片段已经有一个：在枚举 ( )的结尾大括号之后应该有一个分号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T19:45:28.167

如果我使用多个 API 和一个 #defines 常量而不是像 OSG 那样使用命名空间很好的枚举，有时我会遇到奇怪的交互。也许您在 FileUtils 之前包含的内容是#define-ing“OK”或“Value”，这些是我在给您错误的行中可以看到的最通用的。在包含之前尝试#undef OK 和#undef Value，或者避免对常量使用预处理器命令。

# ruby - 1-200之间的Ruby数字范围正则表达式

> ID：11851667
> 
> 赞同：1
> 
> 时间：2012-08-07T18:10:04.853
> 
> 标签：ruby, regex, range, gsub

我正在尝试使用 1-200 之间的 gsub 函数来实现一个数字范围，但我找不到任何好的例子。我正在实现一个 bbcode 系统，用户应该能够输入类似的内容

1.  `[size=80]Hello world[/size]`=> 有效
2.  `[size=200]Hello world[/size]`=> 有效
3.  `[size=201]Hello world[/size]`=> 无效

这是目前我被输入 gsub 方法的内容，它接受 1-999 之间的任何内容：

```
\[size=(\d{1,3})\](.+?)\[\/size\] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:14:03.963

试试这个：`/\[size=(?:200|1\d{2}|[1-9]\d?)\](.+?)\[\/size\]/`

我的测试程序：

```
if '[size=80]Hello world[/size]' =~ /\[size=(?:200|1\d{2}|[1-9]\d?)\](.+?)\[\/size\]/ 
    puts 'valid'
else    
    puts 'invalid'
end        

if '[size=200]Hello world[/size]' =~ /\[size=(?:200|1\d{2}|[1-9]\d?)\](.+?)\[\/size\]/     
    puts 'valid'
else    
    puts 'invalid'
end          

if '[size=201]Hello world[/size]' =~ /\[size=(?:200|1\d{2}|[1-9]\d?)\](.+?)\[\/size\]/     
    puts 'valid'
else    
    puts 'invalid'
end 
```

输出：

```
valid
valid
invalid 
```

# jquery - jQuery检查XML中是否存在元素

> ID：11851668
> 
> 赞同：0
> 
> 时间：2012-08-07T18:10:05.190
> 
> 标签：jquery, xml, forms

我有一个包含邮政编码列表的 XML 文件：

```
<zipcodes>
    <zipcode>29102265</zipcode>
    ... more Zip Codes ...
</zipcodes> 
```

我正在尝试，在表单验证结束时，表单输入的值用于检查邮政编码是否在列表中。我正在使用这个插件进行验证：[http ://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

我也在使用这个插件来处理表单提交：[https ://github.com/malsup/form](https://github.com/malsup/form)

我的 jQuery 函数如下所示：

```
submitHandler: function(form){
  var zipCode = $(input).val()
  $.ajax({
    type: 'get',
    url: 'xml/zips.xml',
    dataType: 'xml',
    succes: function(xml) {
      $(xml).find('zipcodes').children().each( function() {
        if ( $(this).content === zipCode ) {
          console.log( 'okay' )
        }
      });
    }
  })
} 
```

我知道 XML 并且有点迷失。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:27:44.137

看起来你快到了。试试这个：

```
$(this).text() // -> 29102265, ..., ..., 
```

这样，您将获得 xml 标记的值

# c# - c#枚举反射，多个名字时获取名字

> ID：11851669
> 
> 赞同：1
> 
> 时间：2012-08-07T18:10:09.457
> 
> 标签：c#, reflection, enums

考虑以下

```
public enum E
{
  A = 1,
  B = 1  
}

public string F(E input)
{
 return input.ToString();
}

F(E.B); //returns "A" 
```

现在我知道你不应该这样做`((E)1).ToString()`，因为它可以解决`A`或`B`（[http://msdn.microsoft.com/en-us/library/16c1xs4z.aspx](http://msdn.microsoft.com/en-us/library/16c1xs4z.aspx)）。
但是当它是一个明确选择的值（例如`B`）时，为什么会`ToString()`表现得很奇怪（返回`A`）？

调试时可能会看到，`input`是否`B`可以在代码中获取所选字段？

**编辑**
这个问题与调试器如何知道传递给哪个值有关`F()`，而在代码中似乎无法检测到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:18:41.293

枚举实际上只是一个整数值。发生的情况是，当您调用 时`input.ToString()`，枚举会执行以下操作：

*   获取输入的值，在这种情况下，`1`
*   将此传递给内部格式化例程，该例程会找到匹配的名称（如果没有用 装饰`[Flags]`）
*   返回名称

当它去查找匹配的名称时，它会找到*第*一个值为 1 的匹配项，在本例中为`E.A`，并打印“A”。

通常，这不是问题，因为每个名称通常只有一个枚举值。

> 调试时可能看到输入是 B，是否可以在代码中获取所选字段？

问题是`input`不是“B” - 输入是 1 包装在`E`变量中的值，这意味着输入是`E.A` **and** `E.B`。

为了演示，运行：

```
using System;
class Program
{
    public enum E
    {
        A = 1,
        B = 1
    }

    static void Main(string[] args)
    {
        E value = E.B;

        Console.WriteLine(value == E.B);
        Console.WriteLine(value == E.A);

        Console.ReadKey();
    }

} 
```

这将打印`True`两次，`value`和.`E.A``E.B`

如果你 break on `Console.ReadKey`，调试器也将显示`value`为“A”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:19:43.130

问题在于两个可能的枚举值`A`和`B`都有一个整数值`1`，因此无法区分`A`和`B`因为 C# 只是将值`1`作为参数传递给方法。

# c# - 活动工作簿更改时的事件

> ID：11851672
> 
> 赞同：4
> 
> 时间：2012-08-07T18:10:27.057
> 
> 标签：c#, .net, excel

我正在写一个*Excel AddIn*。它使用*功能区*，其中根据工作簿的属性启用/禁用某些*控件。*

为此，我想我应该在活动*工作簿*更改时更新功能区控件的状态。

*Chip Pearson 的网站*解释了[如何在*VBA*](http://www.cpearson.com/excel/AppEvent.aspx)中执行此操作，[这里](https://stackoverflow.com/questions/8738314/c-sharp-excel-addin-get-the-active-excel-workbook)解释了如何获取活动的 Excel 工作簿，但是我无法在我的 C# *AddIn*中触发此事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T19:29:59.720

在需要时将以下代码添加到事件*类*`ThisAddIn` *似乎*会引发。

 *```
 void Application_ActiveWorkbookChanges(Excel.Workbook Wb)
    {
        // TODO: Active Workbook has changed. Ribbon should be updated.    
    }

    private void ThisAddIn_Startup(object sender, System.EventArgs e)
    {
        this.Application.WorkbookActivate   += 
            new Excel.AppEvents_WorkbookActivateEventHandler
                (Application_ActiveWorkbookChanges);
        this.Application.WorkbookDeactivate += 
            new Excel.AppEvents_WorkbookDeactivateEventHandler
                (Application_ActiveWorkbookChanges);
    } 
```*

# dojo - 在 Dojo 中返回数组

> ID：11851673
> 
> 赞同：0
> 
> 时间：2012-08-07T18:10:30.983
> 
> 标签：dojo

我是 Dojo 的新手，很难使用以下代码。我不明白为什么chartData 最后是空的。我基于 Dojo 站点上的示例创建了此方法。

代码如下：

```
 function(xhr, json, arrayUtil, number, Chart, theme) {

            var chartData = [];

            var def = xhr.get({
                url: "cpuusage.json",
                handleAs: "json"
            });

            def.then(function(res){
                var data = [];

                    arrayUtil.forEach(res.chart, function(chart){
                        data[chart.x] = number.parse(chart.y);
                    });
                chartData = data;
                console.info("chartData1: ", chartData);
            }, function(err){
                console.error("Failed to load JSON data");
            }); 
```

def.then 中的第一个 console.info 表示 chartData 具有正确的值。然而，当我在 def.then 方法完成后打印 chartData 的值时，它是空的。

如何确保 chartData**在 def.then 调用中和之后具有相同的值**。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:23:12.180

the, methods in the xhr are all async by nature, but they return a promise. if you want to execute some code after the xhr method it should look like this:

```
 function(xhr, json, arrayUtil, number, Chart, theme) {

        var chartData = [];

        xhr.get({
            url: "cpuusage.json",
            handleAs: "json",
            load: function(jsonData) {
                arrayUtil.forEach(jsonData.chart, function(chart){
                    chartData[chart.x] = number.parse(chart.y);
                });
                console.info("JSON loaded from server:  ", chartData);
            },
            error: function() {
                console.error("Failed to load JSON data");
            }
        }).then(function(jsonData){
             console.info("chartData: ", chartData);
        }); 
```

by using the then function of the promise, you make sure your code executes after the AJAX call

# php - PHP IF/Else 不工作

> ID：11851678
> 
> 赞同：1
> 
> 时间：2012-08-07T18:10:53.853
> 
> 标签：php, if-statement

我有什么应该是一个非常简单的问题。我正在使用以下简单的 PHP if/else 语句。当`nomobile`未定义或不等于“true”时，应该执行下面显示的 javascript。如果它等于 true，那么它不应该执行。但是，即使`nombobile`=true，javascript 也会执行。可能有一个小错字搞砸了一切，但我让自己发疯，试图找出问题所在，却无法弄清楚。

```
<?php
  if ($_GET["nomobile"]!="true")
    {echo '
    <script type="text/javascript">
    if (screen.width <= 699) {
    document.location = "http://www.heliohost.org/m/";
    }
    </script>';}
  else {} ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:16:28.580

可能是您没有检查是否设置了 $_GET 值？把你的这个陈述转换成代码应该会产生这样的结果：

> 当 nomobile 未定义或不等于“true”时

```
if (!isset($_GET["nomobile"]) || $_GET["nomobile"] != "true"){ ... } 
```

如果未设置，可能会出现问题。

我希望这会有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:29:47.293

我认为问题出在您的 Javascript 上。通过警告它（或记录它或您选择这样做）来验证其`screen.width`评估为小于或等于 699 的*数字。*

澄清一下，当我尝试浏览[http://www.heliohost.org/?nomobile=true](http://www.heliohost.org/?nomobile=true)时，我在您的代码中看到了 Javascript。如果我尝试浏览[http://www.heliohost.org/](http://www.heliohost.org/)或[http://www.heliohost.org/?nomobile=foo](http://www.heliohost.org/?nomobile=foo)，则 Javscript 不存在。这告诉我您的 Javascript 没有按照您的预期执行，而不是您的 PHP 代码有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:17:00.243

```
if(!isset($_GET['nomobile']) || (isset($_GET['nomobile']) && $_GET['nomobile'] != "true")){
    echo '<script type="text/javascript">
    if (screen.width <= 699) {
        document.location = "http://www.heliohost.org/m/";
    }
    </script>';
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-07T18:17:58.197

删除双引号。

```
<?php
    if ($_GET["nomobile"]!=true) {
        echo '<script type="text/javascript"> if (screen.width <= 699) {  document.location = "http://www.heliohost.org/m/"; } </script>';
    }
    else {}
?> 
```

# vb.net - 应用程序忽略 MyApplication.exe.config 中的设置

> ID：11851680
> 
> 赞同：1
> 
> 时间：2012-08-07T18:10:58.847
> 
> 标签：vb.net, winforms, windows-xp

我正在使用在 Windows XP 下运行的具有应用程序设置的 vb.net Windows 窗体应用程序。

vs 2010 解决方案创建了一个 MyApplication.exe.config 但是当我使用记事本编辑文件时，即使在重新启动后应用程序也会忽略更改。即使我删除了 exe.config 文件，应用程序仍然使用编译时的设置。所以我决定用十六进制编辑器查看 exe 文件，显示设置被编码到 exe 中。

用户范围的设置正确保留，但它们的默认值不是来自 exe.config 而是来自其他地方。

我的应用程序是否有问题，或者这是 VB.Net Windows 窗体应用程序通常的工作方式？

通常，我使用 C# 开发控制台或服务应用程序，在那里我可以毫无问题地编辑 exe.config。

有问题的行：

```
If My.Settings.UseLocalOrGlobalSettingForOutputFolder.ToUpper.Equals("LOCAL") Then 
```

exe.config 文件看起来很正常

```
<applicationSettings>
    <DHModule.My.MySettings>
        <setting name="UseLocalOrGlobalSettingForOutputFolder" serializeAs="String">
            <value>Local</value>
        </setting> 
```

这是一个 Visual Studio 2010 解决方案，其中包含大约 20 个项目，包括一个安装项目。我已经删除并重建了有问题的项目。

我已经用完了这个项目的时间，所以......

注意：我将通过不使用任何应用程序范围的设置来解决这个问题。

注意：我将通过不使用任何应用程序范围的设置来解决这个问题。

注意：我将通过不使用任何应用程序范围的设置来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:37:40.580

在 app.config 中查看**正在运行的可执行文件**`<configuration> <configSections> <sectionGroup>`并确保该部分存在：`<section name="DHModule.My.MySettings"`...

# javascript - 使用 getElementsByName 更改文本的值

> ID：11851682
> 
> 赞同：9
> 
> 时间：2012-08-07T18:11:02.410
> 
> 标签：javascript, html, forms, getelementsbytagname

我有`firstName`文字想要更改他的值，但它不起作用 -

```
<input type="text" name="firstName" />
<script LANGUAGE="JavaScript" TYPE="text/javascript">
      document.getElementsByName("firstName").[0].value = "New Value " ;
</script> 
```

如何更改此值？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-07T18:13:21.200

[这不是语法上有效的 JS。](http://www.jshint.com/reports/657103)删除多余的`.`：

```
//                                    ↓↓
document.getElementsByName("firstName")[0].value = "New Value " ;
//                                    ↑↑ 
```

其余[的将起作用](http://jsfiddle.net/mattball/uYxdY/)。

# c# - Windows 窗体：“输入字符串的格式不正确”错误

> ID：11851685
> 
> 赞同：-1
> 
> 时间：2012-08-07T18:11:27.787
> 
> 标签：c#, winforms, input, int, user-input

我正在创建一个网页重新加载器，我正在尝试使用来自用户的输入来获取重新加载的数量，但我无法从用户那里获得输入的数量。

我正在尝试获取用户输入`textBox2.Text`，但出现此错误：

```
input string was not in a currect format 
```

这个错误在这一行`kkk = System.Int32.Parse(textBox2.Text);`

请帮助我如何正确获取用户输入的`int`值。

这是我的程序代码：

```
public partial class Form1 : Form
{
    public  int kkk;

    public Form1()
    {
        InitializeComponent();
    }

    private void progressBar1_Click(object sender, EventArgs e)
    {

    }

    private void button1_Click(object sender, EventArgs e)
    {
        if (progressBar1.Value != kkk)
        {
            do
            {
                try
                {
                    webBrowser1.Navigate(textBox1.Text);
                    while (webBrowser1.ReadyState != WebBrowserReadyState.Complete)
                    {
                        Application.DoEvents();
                        if(webBrowser1.ReadyState == WebBrowserReadyState.Complete)
                        {
                            progressBar1.Value = progressBar1.Value + 1;
                        }
                    }
                    MessageBox.Show("Loaded");
                }
                catch(Exception)
                {
                    MessageBox.Show("failed");
                }
            }
            while(progressBar1.Value !=kkk);
        }   
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        kkk = System.Int32.Parse(textBox2.Text);
        progressBar1.Maximum = kkk;        
    }

    private void textBox1_TextChanged(object sender, EventArgs e)
    {

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:23:23.177

The line:

```
kkk = System.Int32.Parse(textBox2.Text); 
```

is giving an error maybe because it is an empty string which is unable to get parsed to integer. Change it to:

```
kkk = textBox2.Text.Trim();
if( kkk.Length > 0 ) {
    try {
        kkk = System.Int32.Parse(kkk);
    }
    catch { }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:16:12.910

在表单加载事件中，您获取 textbox2 的内容。文本并将其分配给 kkk。但是此时 textBox2 内没有任何内容，因此它会引发错误，并且由于文本框是空的，所以如果它没有值，它如何解析为 Int32 呢？

`kkk`您应该在此过程中稍后的某个时间分配 的值。您始终可以在异常发生之前处理它：

```
 int number;
  bool result = Int32.TryParse(txtBox2.Text, out number);
  if (result)
  {
    //good conversion you can use number
  }
  else
  {
    //not so good
  } 
```

但是您再次在表单加载事件中执行此操作，我非常怀疑在加载事件完成时基于您的代码的文本框中是否有任何内容。

# xcode - 使用 XCode4.4 设置环境变量以在 Mountain Lion 上编译节点

> ID：11851686
> 
> 赞同：0
> 
> 时间：2012-08-07T18:11:31.210
> 
> 标签：xcode, macos, gcc, xcode4, g++

在升级到 Mountain Lion (10.8) 和 XCode 4.4，并从 XCode Preferences 窗格安装 XCode 命令行实用程序后，我无法从源代码编译 node.js (0.8.5)。具体来说，配置脚本认为我没有安装 C 编译器。

在我看来，命令行工具所需的环境变量在途中丢失了。

我试过`sudo xcode-select --switch /Applications/Xcode.app`了，但这似乎并没有解决问题。

我必须执行这些步骤才能使节点构建系统满意：

*   `export PATH=$PATH:/Applications/Xcode.app/Contents/Developer/usr/bin`
*   `export CC='gcc --sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.8.sdk/'`
*   `export CXX='g++ --sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.8.sdk/'`

之后，我能够编译和链接。

那么...为什么我必须这样做？我是否错过了一些可以自动为我完成此操作的简单步骤？还是因为我在升级到 Mountain Lion 之前安装了 XCode 并且 XCode 更新程序脱轨而处于某种糟糕的状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:22:24.760

Once you've updated to Mountain Lion and updated XCode 4.4, you have to reinstall the command line tools inside XCode.

Go to XCode/Preferences/Downloads/Components and click install on "Command Line Tools" and once it has downloaded and installed, you should once again have gcc and g++ in your (normal) path.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T22:35:03.627

正确的做法是从 Xcode 内部重新安装命令行工具。

这暂时是不可能的，因为 Apple 提供了格式错误的下载列表，但问题已得到解决。通过在控制台中检查 Xcode 的输出可以检测到该畸形。

重新安装工具后，编译工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-25T01:39:50.047

[http://docwiki.embarcadero.com/RADStudio/XE4/en/Installing_the_Xcode_Command_Line_Tools_on_a_Mac](http://docwiki.embarcadero.com/RADStudio/XE4/en/Installing_the_Xcode_Command_Line_Tools_on_a_Mac)

请参考上面的链接并尝试从苹果开发者门户安装命令行

# javascript - dust.js：在作用域部分中使用路径

> ID：11851691
> 
> 赞同：4
> 
> 时间：2012-08-07T18:12:06.683
> 
> 标签：javascript, internationalization, dust.js

这个问题是关于使用dust.js 模板系统和子上下文中的数据路径。我的意图是使用字符串的键映射来支持 i18n。

给定这样的数据：

```
{i18n : { firstname : "First Name" },
 people : [
    {"name" : "Moe"},
    {"name" : "Curly"}
 ]} 
```

在尘土中，您可以使用部分来列出每个人：

```
{#people}
    {name}
{/people} 
```

您可以使用路径来访问 firstname i18n 字符串：

```
{i18n.firstname} 
```

但以下不起作用：

```
{#people}
    {i18n.firstname}: {name}
{/people} 
```

事实上，文档特别说：

> 为了避免脆弱和混乱的引用，路径永远不会回溯上下文堆栈。如果您需要深入了解父上下文中可用的键，请将键作为参数传递。

所以我尝试将密钥作为参数传递：

```
{#people i18n=i18n}
    {i18n.firstname}: {name}
{/people} 
```

但这不起作用。当我在[灰尘主页](http://akdubya.github.com/dustjs/ "dust homepage")上对此进行实验时，我看到编译后的模板有以下代码：

```
"i18n": ctx.get("i18n") 
```

Which makes me think the above example should work fine.

So what gives? How can I make this work?

**Note:** The following *does* work:

```
{#people firstname=i18n.firstname}
    {firstname}: {name}
{/people} 
```

But this doesn't work well if you need to access a lot of i18n keys within the *people* context.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T18:37:36.260

Paths can be used in keys and in sections to specify where you want Dust to look for keys. To understand how and when to use paths, you should first understand how Dust looks for keys when there are no paths. You might want to sit down.

When searching for keys, Dust first looks in the current context, then looks in each parent context until there are no more parents to search in. If no key is found, Dust does nothing (unless you are using an Exists or Not Exists Section). If Dust finds the key, it stops searching and uses the given value. That's not too foreign, right? That's how JavaScript looks for variables in execution environments.

However, instead of looking up the tree toward root, when a path is used, Dust only looks at children. This is best illustrated with an example.

```
JSON:

{
  "i18n": {
    "firstname": "First Name"
  },
  "name": "My Dust Template",
  "firstname": "Surprise!",
  "people": [
    {
      "name": {
        "firstname": "Moe",
        "lastname": "Howard"
      }
    },
    {
      "name": {
        "firstname": "Curly",
        "lastname": "Howard"
      }
    }
  ]
} 
```

And the Dust:

```
Dust Template:

{! Show the name of the template !}
{name}{~n}
{#people}

  {! 
     As you noted, the following will not work, because 
     when using a path, Dust only searches
     deeper into the JSON. The output will be:
     ": Surprise!"
  !}
  {i18n.firstname}: {firstname}{~n}

  {!
     To get your i18n string, you need to look up the 
     stack instead of down. This can be done by using a
     section without a path, as follows. The output will be:
     "First Name: Moe"
     "First Name: Curly"
  !}
  {#i18n}{firstname}{/i18n}: {name.firstname}{~n}

  {! 
     Note that we successfully used the path to 
     get the firstname of each of the people.
  !}
{/people} 
```

[EDIT]: For more info, check out this wiki page from the LinkedIn fork of Dust: [https://github.com/linkedin/dustjs/wiki/Where-else-does-Dust-search-if-the-value-is-not-defined%3F-A.K.A.-Dust-Scoping](https://github.com/linkedin/dustjs/wiki/Where-else-does-Dust-search-if-the-value-is-not-defined%3F-A.K.A.-Dust-Scoping)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T12:54:04.460

if this is your template:

```
{#people i18n=i18n}
  {i18n.firstname}: {name}
{/people} 
```

here's how your context stack looks like as it iterates through your 'name' array

```
{ your original context}
i18n -> firstname: "First Name"
name -> "Moe" 
```

what happens is, when you define a parameter, dust pushes into the context stack all the parameters you defined. then when it finds an array in your context, dust pushes into the stack, one at a time, all the items in the array.

so now when you define a path context within the section, even though you've passed i18n in as a parameter, the i18n context is still up in the context stack, and when you try to access i18n with a path, like {i18n.firstname}, dust wouldn't find it, coz it has to backtrack to find it, and getPath doesn't do backtracks. the get method, on the other hand does backtrack, so that's why, when you do this:

```
{#people firstname=i18n.firstname}
  {firstname}: {name}
{/people} 
```

it works, because it's accessing the firstname within the section with a get method. hope you understand what i'm trying to say.

what i'd do is define a helper method that takes in a section like so:

```
{#people}
  {#i18n}{firstname}{/i18n}: {name}{~n}
{/people} 
```

and define the method in your context (or push it to your global context [defined with makeBase] to make it a global helper) like so:

```
i18n: function(chunk, context, bodies, params){
  var trans = context.get(translation); //or whatever name you give to your i18n list
  chunk.render(bodies.block, context.push(trans));
  return chunk;
} 
```

tested this on the dust website and it works. the advantage to this approach is you can now format your i18n output within the confines of the section. also, it would be good to define both the helper and the i18n list in your global context, so do use makeBase for that. all the best.

# meta-tags - 无法为 Facebook 评论设置管理员

> ID：11851692
> 
> 赞同：0
> 
> 时间：2012-08-07T18:12:07.537
> 
> 标签：meta-tags, facebook-comments

我们的网站上出现了一个奇怪的问题，其中包含 facebook 评论。看起来 facebook 抓取工具错误地解析了（至少一个）我们的网页，因此它不会让管理员来审核评论。

如果你去这个链接：

[http://www.beliefnet.com/Espanol/10-Atletas-olimpicos-mas-inspiradores.aspx](http://www.beliefnet.com/Espanol/10-Atletas-olimpicos-mas-inspiradores.aspx)

并查看源代码，您会看到我们在头部有适当的标签，包括一个用于 fb:admins 的标签。如果我使用该帐户登录 facebook，我将没有版主选项。

通过 facebook 对象调试器运行页面，我收到一个错误，我们在正文中有元标记。具体来说，这个错误：

```
Meta Tags In Body:  You have tags ouside of your . This is either because 
your was malformed and they fell lower in the parse tree, or you accidentally
put your Open Graph tags in the wrong place. Either way you need to fix it 
before the tags are usable. 
```

查看该页面底部的抓取 URL，我看到 Facebook 已经“重新组织”了我们的 html，并将元标记从头部放置到了正文中。

有谁知道是什么原因造成的？我想也许我们在页面的某个地方有一些格式不正确的 html，导致一切都失败了，但我浏览了那个页面的 html，它看起来不错。我在这里还缺少其他东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T22:36:31.550

通过 validator.w3.org 运行您的 URL 会显示一些警告信号：

```
Line 77, Column 14: document type does not allow element "noscript" here; assuming missing "object" start-tag
Line 154, Column 699: document type does not allow element "meta" here 
```

我能够将（潜在的）问题缩小到您页面中的这些行：

```
document.write('<a href="' + OAS.config.url + 'click_nx.ads/' + OAS.config.sitepage + '/1' + OAS.config.rns + '@' + OAS.config.listpos + '!' + pos + '?' + OAS.config.query + '" target=' + OAS.config.target + '>');
document.write('<img src="' + OAS.config.url + 'adstream_nx.ads/' + OAS.config.sitepage + '/1' + OAS.config.rns + '@' + OAS.config.listpos + '!' + pos + '?' + OAS.config.query + '" border=\"0\" /></a>'); 
```

这些 document.write() 行也未能通过 w3.org 验证器：

```
Line 53, Column 197: character "+" is not allowed in the value of attribute "target" 
```

此外，我认为使用 document.write() 插入 DOM 是不好的（因为它会导致页面渲染阻塞）。你能改成使用 js 对象和 DOM 操作吗？

在 FB 获取您的 URL 后，它会通过一个 DOM 解析器运行它，当它遇到那些 document.write() 行时可能会窒息。这些行有一个跨越两个 document.writes() 的 <a> 元素这一事实可能会使解析器感到困惑。解析器可能认为它已到达页面的 <body>，因此出现“正文中的元标记”错误。

作为一个快速测试，尝试将 fb:admins 元标记放在这些 document.write() 行之上。虽然，如果解析器仍然阻塞，我不会感到惊讶，但值得一试。

为了测试您页面的 html 源代码，我使用了此 php.net 页面末尾的评论中提供的简单脚本： [http ://www.php.net/manual/en/class.domxpath.php](http://www.php.net/manual/en/class.domxpath.php)

它产生了错误：

```
Unexpected end tag : a in /home/dlee/tmp/tmp.html, line: 54
Unexpected end tag : head in /home/dlee/tmp/tmp.html, line: 183
htmlParseStartTag: misplaced <body> tag in /home/dlee/tmp/tmp.html, line: 184 
```

其中 tmp.html 是保存到文件的页面的 html。第 54 行是前面提到的 document.write() 行。

如果上述任何结果正在进行中，请告诉我，我将相应地编辑此答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T20:40:20.253

所以问题最终是`<noscript>...</noscript>`头部有一个嵌套，它试图为没有启用 javascript 的浏览器包含一个跟踪像素，作为我们使用的广告服务的一部分。

从 facebook 给我们的“他们如何看待你的页面”的输出来看，这个问题应该很明显。正文在脚本之后立即开始，但在标记开始的位置之前。显然，当 facebook 解析器在头部中看到应该在身体中的元素时，它会吓坏了，所以它立即从那里开始身体。

... 脸书输出 ...

```
 console.log(OAS);
    })();
</script><!-- End OAS Setup --><!-- Begin comScore Tag --><script>
      var _comscore = _comscore || [];
      _comscore.push({ c1: "2", c2: "8428430" });
      (function() {
        var s = document.createElement("script"), el = document.getElementsByTagName("script")[0]; s.async = true;
        s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
        el.parentNode.insertBefore(s, el);
      })();
    </script>
</head>
<body>
<noscript>

    </noscript>
    <!-- End comScore Tag --> 
```

...我们的html ...

```
<head>   
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <asp:PlaceHolder id="OASHeader" runat="server" />

    <!-- Begin comScore Tag -->
    <script type="text/javascript">
      var _comscore = _comscore || [];
      _comscore.push({ c1: "2", c2: "8428430" });
      (function() {
        var s = document.createElement("script"), el = document.getElementsByTagName("script")[0]; s.async = true;
        s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
        el.parentNode.insertBefore(s, el);
      })();
    </script>    
    <!-- End comScore Tag -->
    <noscript>
        <img src="http://b.scorecardresearch.com/p?c1=2&c2=8428430&cv=2.0&cj=1" alt="" />
    </noscript>

    <script type="text/javascript">
    ....
    <body>
    .... 
```

所以在未来，无效的头部元素肯定会导致这个问题。

# mysql - MySQL: SHOW PROFILES - 想要查看超过 100 条记录

> ID：11851702
> 
> 赞同：1
> 
> 时间：2012-08-07T18:12:41.780
> 
> 标签：mysql, performance

我正在对查询进行性能分析，并且需要能够看到比最后 100 个查询更多的内容。Max profiling_history_size 为 100，但我看到调试工具以某种方式设法保存超过最后 100 个查询（例如，django 调试工具）。

我愿意

```
SET profiling=1;
set profiling_history_size = 100;
SHOW PROFILES; 
```

如果我可以将记录移动到另一个表中，那就太好了。或者也许我需要完全寻找其他地方？

我的程序多次运行相同的查询，所以我真正想要的是执行特定查询的所有时间的汇总。完成所有查询后，我打算进行某种 GROUP BY，但也许还有其他地方可以查看？（我并不是要问 2 个问题，但也许知道我最终需要什么会改变上述问题的答案。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-18T18:20:44.903

如果您需要超过最后 100 个查询的信息，您只需每 100 个查询收集一次现有数据。我已经在 PHP PDO 中实现了后一个特性。

[https://github.com/gajus/doll](https://github.com/gajus/doll)

这是一个应用层解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:52:01.513

在 MySQL 5.6 中，语句（查询）由性能模式检测。

你得到一个查询所花费的时间，加上更多的属性，比如返回的行数等，你得到了许多不同的聚合。

看

[http://dev.mysql.com/doc/refman/5.6/en/statement-summary-tables.html](http://dev.mysql.com/doc/refman/5.6/en/statement-summary-tables.html)

[http://dev.mysql.com/doc/refman/5.6/en/performance-schema-statements-tables.html](http://dev.mysql.com/doc/refman/5.6/en/performance-schema-statements-tables.html)

一个特别有用的聚合是按摘要聚合，将几个“相似查询”分组在一起，其中相似表示相同的结构但可能有不同的文字值（“select * from t1 where id = 1”和“select * from t1 where id = 2" 将被聚合为 "select * from t1 where id = ?")

# php - 带有 jquery 的 Json

> ID：11851703
> 
> 赞同：2
> 
> 时间：2012-08-07T18:12:50.050
> 
> 标签：php, jquery, json

我只想知道如何在 phtml 文件中获取 json 数据。下面是我的 php 控制器。

```
foreach($result AS $row) {  
    $arrValues[] = array("firstname"=>$row['firstname'], 
                         "emailid"=>$row['emailid'],
                         "lastname"=>$row['lastname']); 
}
header("Content-type: application/json", true);             
echo json_encode(array('rows'=>$arrValues)); 
```

这是我的 phtml 文件。

```
var emailid=$(this).data('emailid');   

//alert(emailid);  

$.ajax({
    url: 'http://localhost/feedback/public/index/email/',
    type: 'POST',                                    
    data: {emaildata: emailid }, 
    dataType: 'json',
    success: function(data) { 
        var emailid = data[0];              
        var vname = data[1];
        var vlaname=data[2];
        var w = window.open('', 'Feedback', 'width=400,height=400,resizeable,scrollbars');
        w.document.write("FirstName"+data[0]);
    }
}); 
```

我试图在弹出窗口中写入这些值。但它说对象。请你帮我如何获取 json 数据并将其写入弹出窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:23:52.017

```
success: function(data) { 
    var emailid = data.rows[0].emailid;              
    var vname = data.rows[0].firstname;
    var vlaname=data.rows[0].lastname;
    var w = window.open('', 'Feedback', 'width=400,height=400,resizeable,scrollbars');
    w.document.write("FirstName"+data.rows[0].firstname);
} 
```

# tsql - 基于时间窗口查找彼此附近的记录的 SARGable 方法？

> ID：11851707
> 
> 赞同：6
> 
> 时间：2012-08-07T18:13:14.073
> 
> 标签：tsql

我们将事件插入到表中 - 一个开始事件和一个结束事件。相关事件具有相同的 internal_id 编号，并在 90 秒的窗口内插入。我们经常在表上进行自联接：

```
create table mytable (id bigint identity, internal_id bigint, 
internal_date datetime, event_number int, field_a varchar(50))

select * from mytable a inner join mytable b on a.internal_id = b.internal_id
and a.event_number = 1 and b.event_number = 2 
```

但是，我们每天可以有数百万个关联事件。我们的聚集键是 internal_date，所以我们可以过滤到一个分区级别，但性能仍然可以平庸：

```
and a.internal_date >='20120807' and a.internal_date < '20120808'
and b.internal_date >='20120807' and b.internal_date < '20120808' 
```

有没有一种 SARGable 方法可以进一步缩小范围？添加这个不起作用 - 非 SARGable：

```
and a.internal_date <= b.internal_date +.001 --about 90 seconds
and a.internal_date > b.internal_date - .001 --make sure they're within the window 
```

这不适用于点查询，因此一次性执行也无济于事 - 我们正在搜索数千条记录，并且需要开始事件和结束事件的事件详细信息。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:52:29.580

使用此索引，您的查询会便宜得多：

```
CREATE UNIQUE INDEX idx_iid on mytable(event_number, internal_id)
INCLUDE (id, internal_date, field_a); 
```

该索引允许您查找`event_number`而不是执行聚集索引扫描，并且使您能够执行合并连接`internal_id`而不是哈希连接。唯一性约束通过消除多对多连接的可能性使合并连接更加便宜。

有关合并连接的更详细说明，请参阅[此内容。](http://blogs.msdn.com/b/craigfr/archive/2006/08/03/merge-join.aspx)

# ruby-on-rails - 使用来自另一个控制器的模型信息填充 Rails 表单

> ID：11851711
> 
> 赞同：0
> 
> 时间：2012-08-07T18:13:39.087
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, ruby-on-rails-3.2

**我已将 SessionsController 和 Session Model 重命名为 Periods/Period，因为它与 Devise 冲突，因此您将在更新中看到这一点**

我有一个会话和事件模型/控制器。创建新会话时，它需要与特定事件相关联。

在我的会话模型中，我有一个 event_id，但我希望在填充有非过去事件名称的表单上有一个下拉列表。选择后，表单应该能够将正确的 event_id 分配给创建的会话。

这样做的正确方法是什么？

这是我的 schema.rb，可帮助您更清楚地了解模型的外观：

```
ActiveRecord::Schema.define(:version => 20120807154707) do

  create_table "events", :force => true do |t|
    t.string   "name"
    t.date     "date"
    t.string   "street"
    t.string   "city"
    t.string   "state"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  create_table "sessions", :force => true do |t|
    t.string   "name"
    t.integer  "event_id"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  create_table "users", :force => true do |t|
    t.string   "email",               :default => "",    :null => false
    t.string   "encrypted_password",  :default => "",    :null => false
    t.datetime "remember_created_at"
    t.integer  "sign_in_count",       :default => 0
    t.datetime "current_sign_in_at"
    t.datetime "last_sign_in_at"
    t.string   "current_sign_in_ip"
    t.string   "last_sign_in_ip"
    t.datetime "created_at",                             :null => false
    t.datetime "updated_at",                             :null => false
    t.boolean  "admin",               :default => false
  end

  add_index "users", ["email"], :name => "index_users_on_email", :unique => true

end 
```

这是我的表格：

```
<%= form_for(@period)  do |f| %>

  <%= f.label :Name %>
  <%= f.text_field :name%>

  <%= f.label :Event %>
  <%= f.collection_select(:period, :event_id, Event.all, :id, :name)%>

  <%= f.label :time %>
  <%= f.text_field :time, id: "timepicker" %>

  <%= f.submit "Create Event" %>

<% end %> 
```

我不断收到以下错误：`undefined method`merge' for :name:Symbol`

分解集合选择的各种参数：`f.collection_select(:period, :event_id, Event.all, :id, :name)`

```
:period -> The object
:event_id -> the method I want to set on the object.
Event.All -> The collection (for now I'll take all of them)
:id -> the value of the html element option
:name -> the value displayed to the user 
```

我这样做对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:38:58.353

要显示带有来自另一个模型（不是另一个控制器）的选项的选择菜单，请尝试[collection_select](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-collection_select)。

在您的新会话表单中，这可能如下所示：

```
collection_select(:event, :id, Event.where("date > :date", date: Time.now.strftime("%m/%d/%Y")) 
```

在 Sessions 控制器的`create`操作中，像这样构建关联：

```
@session.event = Event.find(params[:event][:id]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-12T05:26:06.287

我发现这种结构对我有用：

```
 <%= f.label :event %>
        <%= f.collection_select :event_id, Event.all, :id, :name, {:prompt=> "Pick an Event"}, {:class => "form-control"} %> 
```

最后一点是我用来设置 Bootstrap 类的 html 部分。

`:name`这里可能是`:date`或`:street`等等......

# python - 我可以在没有 GUI 的情况下使用 OS X 10.8 的语音识别/听写吗？

> ID：11851713
> 
> 赞同：8
> 
> 时间：2012-08-07T18:14:00.150
> 
> 标签：python, macos, cocoa, speech-recognition, osx-mountain-lion

理想情况下，我想在没有 GUI 的情况下使用 Python 中的 10.8/Mountain Lion 的听写功能。据我所知，目前仅使用[UITextInput 协议](https://developer.apple.com/documentation/uikit/uitextinput)支持听写，这意味着 GUI（正确？）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T12:24:12.467

您可以创建一个虚拟文本字段并通过模拟按键以编程方式开始听写（在此处成功尝试）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-11T17:14:33.877

我想你想要[Speech Framework](https://developer.apple.com/documentation/speech)。`SFSpeechRecognizer`等。我不相信这需要 macOS 上的窗口会话，因为这是 的一部分`AVFoundation`，尽管我不是 100% 确定。试试看。:-)

# javascript - 有没有 JSDoc 标准？

> ID：11851722
> 
> 赞同：16
> 
> 时间：2012-08-07T18:14:48.760
> 
> 标签：javascript, standards, jsdoc

我知道周围有各种各样的 JSDoc。似乎每个 JSDoc 解析器的实现都可以识别自己的一组标签。例如，考虑[http://usejsdoc.org/](http://usejsdoc.org/)和[http://www.techrepublic.com/blog/programming-and-development/create-useful-relevant-javascript-documentation-with-jsdoc/之间的标签差异451](http://www.techrepublic.com/blog/programming-and-development/create-useful-relevant-javascript-documentation-with-jsdoc/451) .

在这一点上，我只是感到困惑。是否有 JSDoc 的规范实现或广泛认可的核心标签集？是否有JSDoc 的*最佳*实现？

* * *

编辑

正如下面评论中所问的，这个问题的原因是我需要解析 JSDoc 评论以与我们正在创建的工具一起使用。看到这个问题”：[有没有用 Javascript 编写的开源 JSDoc 解析器？](https://stackoverflow.com/questions/11851556/are-there-any-open-source-jsdoc-parser-written-in-javascript)

我担心我将不得不推出自己的解析器，如果这样做，我需要知道需要支持哪些标签。

但是，在更深层次上，我担心没有一致的规范（或参考实现）。这让 JSDoc 对我来说有点特别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T18:19:39.653

我认为功能最完整的是[谷歌闭包编译器使用的那个](https://developers.google.com/closure/compiler/docs/js-for-compiler)

使用 google 闭包编译器的一件很酷的事情是它会对你的函数进行类型检查，这些函数已经标记了类型信息。

我感觉到你的痛苦，我整天都在处理这件事。这是我必须编写代码/文档的非标准功能的示例。[Ext-JS](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.grid.Panel)用于`@cfg`记录传递给小部件的初始化对象的属性。我使用的 IDE IntelliJ 使用 JSDoc 来提供更好的代码建议，它甚至可以理解 Ext 的方言。对于大多数事情，它运作良好。但是，很多时候我必须以某种方式复制文档以使我的 IDE 和 doc 工具（Ext 的 jsdoc 版本）都能理解它，而不是很干燥。这是一个例子：

```
...
/** 
 * @cfg {string} title // Ext-JS grabs the type from this line
 * @type string // My IDE grabs the type from this line
 */
 title: null // My IDE requires this line to recognize the cfg
             // as a property of the object even though all cfgs
             // are available in the object
... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-27T23:02:17.570

我也分担你的痛苦。令人讨厌的是，这不是标准化的。虽然我同意 Juan Mendes 先生的观点，即 Closure Compiler 的功能是最完整的（并且可能是最棒的！），

我一直认为在这里找到的标签列表[http://code.google.com/p/jsdoc-toolkit/w/list](http://code.google.com/p/jsdoc-toolkit/w/list)是我们拥有的最接近真实规范的东西。它可能已经过时了，但它仍然可能更接近许多解析器和 IDE 实现的东西，比 Closure Compiler 更接近。

另请参阅 Wikipedia，以了解关于应该存在哪些标签的最低限度的共识。[http://en.wikipedia.org/wiki/JSDoc](http://en.wikipedia.org/wiki/JSDoc)

尽管如果您的产品支持 JSDoc 的 Closure Compiler 风格，那将使它更接近成为事实上的标准。:D

# sql - 如何快速比较多个字符串？

> ID：11851739
> 
> 赞同：1
> 
> 时间：2012-08-07T18:16:24.640
> 
> 标签：sql, sql-server, regex, database, tsql

在 SQL Server 中，我有一个包含数字的字符串列。我需要的每个条目只有一个数字，因此不需要解析。我需要一些方法来查找包含从 400 到 450 的数字的所有行。而不是这样做：

```
...where my stringcolumn like '%400%' or stringcolumn like '%401%' or stringcolumn like '%402%' or ... 
```

有没有更好的方法可以节省一些打字？

这些行中还有其他值，例如：'5335154'、test4559@me.com'、'555-555-5555'。需要考虑将这些过滤掉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:27:48.993

```
...where stringcolumn like '4[0-4][0-9]' OR stringcolumn = '450' 
```

如果要限制为 3 位数字，则不需要通配符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T18:18:29.233

使用正则表达式来完成此操作。

```
...where stringcolumn like '4[0-4][0-9]' OR stringcolumn like '450' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:20:00.613

单程

```
WHERE Column like '%4[0-4][09]%'
OR Column LIKE '%500%' 
```

请记住，这将选择其中包含数字的任何内容，因此也会返回 5000

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T18:34:56.797

我会做以下事情：

```
select t.*
from (select t.*,
             (case when charindex('4', col) > 0
                   then substrint(col, charindex('4', col), charindex('4', col) + 2)
              end) as col4xx
      from t
     ) t
where (case when isnumeric(col4xx) = 1
            then (case when cast(col4xx as int) between 400 and 450 then 'true'
                  end)
       end) = 'true' 
```

I'm not a fan of having case statements in WHERE clauses. However, to ensure conversion to a number, this is needed (or the conversion could become a column in another subquery). Note that the following is not equivalent:

```
where col4xx between '400' and '450' 
```

Since the string '44A' would match.

# c++ - __restrict 指针别名，只有一个指针

> ID：11851740
> 
> 赞同：7
> 
> 时间：2012-08-07T18:16:26.670
> 
> 标签：c++, visual-c++, gcc

`__restrict`如果函数指针参数是唯一的指针参数，那么在函数指针参数上指定 MSVC/GCC 非标准限定符有什么好处 ？例如，

```
int longCalculation(int a, int* __restrict b) 
```

我的猜测是它应该允许更好的优化，因为它暗示`b`不指向`a`，但是我看到的所有示例都有`__restrict`两个指针来指示它们之间没有别名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:48:03.453

正如评论中提到的那样，无论如何`b`都不能指向`a`，所以无论如何都没有混叠的可能性。因此，如果该函数是纯粹的，即它仅在其参数上起作用，则不应该有任何真正的好处。

但是，如果函数在内部使用*全局变量*，那么`__restrict`可能会再次提供好处，因为它清楚地表明`b`它并不指向任何这些全局变量。

一个有趣的情况可能是您在函数内部分配和释放内存的情况。编译器理论上可以确定它`b`不指向该内存，但是它是否意识到我不确定并且可能取决于如何调用分配。

但是，就我个人而言，我更喜欢`__restrict`避开签名并做这样的事情

```
int longCalculation(int a, int* b){ 
   assert(...);//ensure that b doesn't point to anything used
   int* __restrict bx = b;
   ...
} 
```

IMO 这具有以下优点：

*   `__restrict`函数签名不暴露使用的非标准
*   确保变量实际上符合`__restrict`using 的能力`assert`，因为将别名指针传递给期望它们是非别名的函数可能会导致难以追踪错误。

# javascript - 使 JS 对象从 typeof="object" 变为 typeof="undefined"

> ID：11851743
> 
> 赞同：2
> 
> 时间：2012-08-07T18:16:28.453
> 
> 标签：javascript, typeof

这一定很容易，但我找不到解决方案。我有一个我想现在未定义的对象。如何将 typeof 更改为未定义？谢谢！

凯尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T18:17:23.600

您不能制作对象本身`undefined`，但可以制作引用它的变量`undefined`。

```
 var myObj = { ... };
  myObj = undefined; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:18:09.157

您应该可以使用关键字“删除”将其删除。那么它的引用将是未定义的。

```
delete myObj; 
```

# java - 从文件数组的每个循环中为每个循环生成一个线程

> ID：11851744
> 
> 赞同：-1
> 
> 时间：2012-08-07T18:16:39.990
> 
> 标签：java, multithreading

我有一个文件数组的每个循环。对于每个文件，都会执行某些常见的操作。有很多这样的文件需要处理并且很耗时。我在想java线程是否可以帮助我实现更高的性能。我是java线程编程的新手。需要任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T19:00:15.593

假设 FileReader 类包含处理单个 File 的逻辑

```
public class FileReader implements Runnable {

String fileName;

public FileReader(String fileName) {
   this.fileName = fileName;
}

public void run() {

 processFile(fileName);

}

private void processFile(String fileName) {
  // Your logic of processing the file.
}

} 
```

然后添加以下代码来处理目录中的文件

您应该始终使用线程池来确保优雅地使用系统资源

```
private static final int THREAD_COUNT = 10;
private static final ThreadPoolExecutor pool = new ThreadPoolExecutor(
        THREAD_COUNT, THREAD_COUNT, 10, TimeUnit.SECONDS,
        new LinkedBlockingQueue<Runnable>()); 
```

对于您要处理的每个文件

```
 FileReader reader = new FileReader(file.getAbsolutePath());
  pool.execute(reader); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:22:03.253

这实际上取决于您必须为每个文件做什么，以及处理的瓶颈在哪里。如果您正在处理的是受 CPU 限制的（您必须对从文件中读取的数据进行大量计算），那么创建更多线程然后您有 CPU 内核来运行它们不会对您有所帮助。

另一方面，如果您的处理恰好是“将文件数据提交到服务器，等待响应”，并且同时提交您的请求不会减慢服务器速度，那么每个文件都有一个线程可能会有所帮助。

如果不了解更多关于处理涉及的内容，则无法给出具体的建议。

# android - 如果全屏，Webview 不显示进度条

> ID：11851747
> 
> 赞同：3
> 
> 时间：2012-08-07T18:16:46.997
> 
> 标签：android, webview, progress-bar

目前我的 webview 有一个进度条。但是我想删除标题栏，当我这样做时，我再也看不到进度条了。当我将其设为全屏时，我会得到相同的结果。

这是我在 onCreate 中的代码：

```
// Adds Progrss bar Support
        this.getWindow().requestFeature(Window.FEATURE_PROGRESS);

        setContentView(R.layout.activity_main);

        // Setup Webview
        webView = (WebView) findViewById(R.id.webView1);
        webView.setVerticalScrollBarEnabled(false);
        webView.setHorizontalScrollBarEnabled(false);
        WebSettings webSettings = webView.getSettings();
        webSettings.setJavaScriptEnabled(true);

        // Setting to private class for overriding redirect
        // Forces the app to use the market app to open
        final Activity MyActivity = this;
        webView.setWebChromeClient(new WebChromeClient() {
            public void onProgressChanged(WebView view, int progress) {
                MyActivity.setProgress(progress * 100);
            }
        });
        webView.setWebViewClient(new MyWebViewClient());
        webView.loadUrl("http://engadget.com"); 
```

当我使应用程序全屏时，如何使进度条保持不变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T13:07:51.253

好吧，基本上这是您问题的答案

[Android：窗口标题中的进度条不显示](https://stackoverflow.com/questions/3092291/android-the-progress-bar-in-the-windows-title-does-not-display)

取自上面的链接：

**如果您使用 Theme.NoTitleBar （这基本上是您想要做的），标题栏将不会显示，并且由于进度条在标题栏中，它也不会显示。**

还有一些关于 NO_TITLE 使用的提示可以在这里找到[http://www.vogella.com/blog/2011/02/28/android-hidding-the-status-and-title-bar/](http://www.vogella.com/blog/2011/02/28/android-hidding-the-status-and-title-bar/)

只是一个想法，也许您想`ProgressDialog`改用它，并且可以将您的 NO_TITLE 装饰与它一起使用。

* * *

希望它能回答你的问题。谢谢

# javascript - 使用 POST 方法通过 ajax 发送的数据在发送到服务器之前是否必须进行 URL 编码？

> ID：11851758
> 
> 赞同：0
> 
> 时间：2012-08-07T18:17:32.537
> 
> 标签：javascript, jquery, ajax

发布数据不作为查询字符串发送，那么在发送之前对其进行 URL 编码有什么好处吗？或者，在发送数据之前通过 Jquery 序列化数据会更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:28:12.690

我不这么认为。

我尝试使用它为我工作的相同方式。你能提到ajax吗

[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

# c - VB.Net 使用 C DLL

> ID：11851761
> 
> 赞同：2
> 
> 时间：2012-08-07T18:17:39.787
> 
> 标签：c, vb.net, visual-studio, dll

将用 C 编写的 DLL 放入 VB.NET（Express Edition 2010）项目的最佳方法是什么？我现在有定位绝对路径的外部函数的声明，如下所示：

C:\Users\Kyle\Documents\Pelles C Projects\ROBOLIB\ROBOLIB.dll

因为 Visual Basic 创建了许多不同的目录，程序可以从这些目录运行（调试、发布、发布）。有什么办法可以告诉 VB.NET 将某些文件放入程序的目录中？或者我应该以某种方式自定义安装程序，以便将我需要的 DLL 放在特定位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:27:55.093

您可以将 DLL 添加到您的项目中（通过拖放或鼠标右键单击 -> 添加 -> 现有元素）。如果您右键单击该文件并选择属性，您可以定义“复制到输出目录”。

当然，您应该确保安装程序（如果您创建一个）复制文件。

# c# - 如何防止用户错误地初始化变量？

> ID：11851762
> 
> 赞同：4
> 
> 时间：2012-08-07T18:17:49.537
> 
> 标签：c#, visual-studio-2010

我正在研究一个名为 PByte 的类，它应该表示 32 到 126 之间的 int 值。（PByte = Printable Byte。）现在我想防止该类的用户错误地初始化一个对象，但我不想要抛出异常，我只希望 Visual Studio 不编译，就像您尝试执行此操作时发生的那样：`byte b = 256;`

```
sealed class PByte : IEquatable<PByte>, IComparable, IComparable<PByte>
{
    public PByte(int value)
    {
        /* if (value < 32 || value > 126)
            throw new ArgumentException("\"" + value + "\" is not a valid PByte-value"); */ 
        this._value = value;
    }

[...] 
```

我也实现了这个：

```
[...] 

    public static implicit operator PByte(int value)
    {
    /*  if (value < 32 || value > 126)
            throw new ArgumentException("\"" + value + "\" is not a valid PByte-value"); */
        return new PByte(value);
    }
} 
```

所以这也应该是不可能的： `PByte p = 2000;`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T18:20:18.497

如果不使用代码合同，您将无法在编译时强制执行该操作。即便如此，我认为代码合同只会产生警告，并且通常会将问题的所有权放在调用范围内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:26:30.400

您主要可以使用[Code Contracts](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx)和编辑器扩展（可在 Extensions Gallery 中获得）来完成此操作。不过，我不确定它是否会完全执行每一种情况。`Code Contracts`（编辑：在项目的属性部分打开静态检查。）

所以，粗略地说，你可以做这样的事情：

```
public PByte(int value)
{
    Contract.Requires<ArgumentException>(value >= 32 && value <= 126, "\"" + value + "\" is not a valid PByte-value");
    this._value = value;
} 
```

# java - 一个 JSP 文件看不到另一个

> ID：11851765
> 
> 赞同：0
> 
> 时间：2012-08-07T18:17:58.887
> 
> 标签：java, html, jsp, web-applications, servlets

我在从一个 JSP 文件转发到另一个 .

一开始我在`adminSuccess.jsp`，我想搬到`adminPage.jsp`。

**更新 - 这是项目的层次结构树：**

![在此处输入图像描述](../Images/4993f78cf04dda1be064a89e16f28acf.png)

这就是**adminSuccess.jsp**的代码：

```
<!DOCTYPE html>
<html>
<head><title>System Administrator Page</title>
<link rel="stylesheet"
      href="./css/styles.css"
      type="text/css"/>
</head>
<body>

<h1>Hello ${name.firstName} ${name.lastName} , You've logged in successfully!</h1>
<h1>
Please choose one of the following options
</h1>

<fieldset>
  <legend>Add a new manager to the bank system</legend>
  <form action="adminAdds1"> 
    <a href="results/adminAddNewManager.jsp">Press here to continue</a>
  </form>
</fieldset>

<fieldset>
  <legend>Add a new employee to the bank system</legend>
  <form action="adminAdds2"> 
    <a href="results/adminAddNewEmployee.jsp">Press here to continue</a>
  </form>
</fieldset>

</body></html> 
```

出去：

```
HTTP Status 404 - /WebBank/results/adminAddNewManager.jsp

--------------------------------------------------------------------------------

type Status report

message /WebBank/results/adminAddNewManager.jsp

description The requested resource (/WebBank/results/adminAddNewManager.jsp) is not available. 
```

显然，一个 jsp 看不到另一个，所以我该如何解决这个问题，而不需要从库中取出一个 jsp 文件，因为它需要更改很多其他代码。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:20:19.153

WEB-INF 下的资源不是可公开访问的资源，如果你想访问那些你需要从你的 servlet 或 JSP 转发请求的资源

```
request.getRequestDispatcher("/WEB-INF/results/adminPage.jsp").forward(request, response); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T18:25:00.897

将您的 JSP 文件移出 WEB-INF。

问题不在于一个 JSP 文件不能“看到”另一个 - 您有一个链接，其中包含指向无法通过 Web 浏览器直接访问的资源（即 JSP 文件）的 URL（因为 WEB-INF 中的资源不能以这种方式访问​​）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T03:22:16.117

您的代码中既有好工作也有坏工作。

您将 JSP 放入`/WEB-INF/`其中，这在 Model-2 应用程序中是一件好事，它可以防止直接访问 JSP。

但是随后您尝试在不访问 Servlet 的情况下从另一个视图访问 JSP，这不太好，而且它是 Model-1（不适合大型应用程序）。

# ruby-on-rails - 在一页加载中执行两个安静的动作

> ID：11851766
> 
> 赞同：0
> 
> 时间：2012-08-07T18:18:06.060
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rest

我有两个模型，`File`和`Download`。在同一个页面加载中，我想读取一个`File`（提供给用户）并创建一个`Download`.

我可以这样做：

1.  `GET /file/:id`
2.  `PUT /file/:id/download`
3.  2 重定向到 1

有没有正确的方法来处理这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T21:28:32.607

让您的文件下载链接指向 :download 操作，您可以在其中记录下载然后呈现您的文件：

```
def download
  DownloadLog.create(...)
  render :file => ......
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T22:03:41.740

我怀疑您需要的只是`after_filter`文件控制器上的一个。类似于以下内容：

```
 after_filter :log_download, :only => :show

  protected
  def log_download
    # code to log a download after the show action
  end 
```

这比尝试将请求链接在一起以获得相同的效果要简单得多。

# tsql - 如何将 Lambda 表达式转换为 SQL Server 查询语法？

> ID：11851769
> 
> 赞同：-2
> 
> 时间：2012-08-07T18:18:14.997
> 
> 标签：tsql, linq-to-sql

这是 lambda 表达式，我想将其转换为 SQL Server 查询语法。

```
{x => ((True AndAlso x.Name.ToLower().Contains("_")) AndAlso Not(x.IsDeleted))} 
```

注意：lambda 表达式相当于 Sql server 的 Where 子句。我想将其转换为 sql 语法，然后将其传递给 sql server 存储过程。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T19:33:38.717

通常，您可以使用LINQ 语句返回`ToString`的对象上的方法`IQueryable`来查找将在数据库上执行的确切查询。但是，在这种情况下，我猜想可能会为 WHERE 生成类似的东西：

```
WHERE CONTAINS(Name, '_') AND NOT IsDeleted 
```

但是，您没有提供任何可以让我验证的细节。

如果您没有全文，那么以下内容可能更适用：

```
WHERE Name like '%_%' AND NOT IsDeleted 
```

# python - 用 Python 进行样条插值

> ID：11851770
> 
> 赞同：14
> 
> 时间：2012-08-07T18:18:25.147
> 
> 标签：python, interpolation, spline, cubic

我编写了以下代码来执行样条插值：

```
import numpy as np
import scipy as sp

x1 = [1., 0.88,  0.67,  0.50,  0.35,  0.27, 0.18,  0.11,  0.08,  0.04,  0.04,  0.02]
y1 = [0., 13.99, 27.99, 41.98, 55.98, 69.97, 83.97, 97.97, 111.96, 125.96, 139.95, 153.95]

x = np.array(x1)
y = np.array(y1)

new_length = 25
new_x = np.linspace(x.min(), x.max(), new_length)
new_y = sp.interpolate.interp1d(x, y, kind='cubic')(new_x) 
```

但我得到：

```
ValueError: A value in x_new is below the interpolation range. 
```

在`interpolate.py`

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-07T18:47:51.833

从[scipy.interpolate.interp1d 上的 scipy 文档](http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html)：

> scipy.interpolate.interp1d(x, y, kind='linear', axis=-1, copy=True, bounds_error=True, fill_value=np.nan)
> 
> x：array_like。单调递增实数值的一维数组。
> 
> ...

问题是 x 值不是[单调递增](http://planetmath.org/MonotonicallyIncreasing.html)的。事实上，它们是单调递减的。让我知道这是否有效，以及它是否仍然是您正在寻找的计算。：

```
import numpy as np
import scipy as sp
from scipy.interpolate import interp1d

x1 = sorted([1., 0.88, 0.67, 0.50, 0.35, 0.27, 0.18, 0.11, 0.08, 0.04, 0.04, 0.02])
y1 = [0., 13.99, 27.99, 41.98, 55.98, 69.97, 83.97, 97.97, 111.96, 125.96, 139.95, 153.95]

new_length = 25
new_x = np.linspace(x.min(), x.max(), new_length)
new_y = sp.interpolate.interp1d(x, y, kind='cubic')(new_x) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-06-09T15:18:11.850

您可以通过以下方式获得此信息：

```
import numpy as np
import scipy as sp
from scipy.interpolate import interp1d

x1 = [1., 0.88,  0.67,  0.50,  0.35,  0.27, 0.18,  0.11,  0.08,  0.04,  0.04,  0.02]
y1 = [0., 13.99, 27.99, 41.98, 55.98, 69.97, 83.97, 97.97, 111.96, 125.96, 139.95, 153.95]

# Combine lists into list of tuples
points = zip(x1, y1)

# Sort list of tuples by x-value
points = sorted(points, key=lambda point: point[0])

# Split list of tuples into two list of x values any y values
x1, y1 = zip(*points)

new_length = 25
new_x = np.linspace(min(x1), max(x1), new_length)
new_y = sp.interpolate.interp1d(x1, y1, kind='cubic')(new_x) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-31T20:46:08.163

我刚刚收到上述错误并通过删除 X 和 Y 数组中的重复值来修复它。

```
x = np.sort(np.array([0, .2, .2, .4, .6, .9]))
y = np.sort(np.sort(np.array([0, .1, .06, .11, .25, .55])) 
```

⬇将*0.2*更改为*0.3*或任何数字。

```
x = np.sort(np.array([0, .2, .3, .4, .6, .9]))
y = np.sort(np.sort(np.array([0, .1, .06, .11, .25, .55])) 
```

# java - 数组文本字段

> ID：11851772
> 
> 赞同：0
> 
> 时间：2012-08-07T18:18:29.757
> 
> 标签：java, arrays, swing, jtextfield

Na是一个参数。我确信这个参数是正确的。我已经声明了一个 Na JTextField 数组，我想使用其中的一个。但是当我运行我的代码时，有一个异常......

那是我的代码：

```
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;

class Panneau_fenetre1A extends JPanel                      
{   
    public Panneau_fenetre1A(int Na)
    {
        JTextField[] allField = new JTextField [Na];
        for(int i = 0;i<Na;i++)
        {
            allField[i].setText(String.valueOf(0));
            allField[i].setBounds(150, 350+i*25,20, 20);
        }
    }

} 
```

那是个例外：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at Panneau_fenetre1A.<init>(Panneau_fenetre1A.java:18)
    at Cadre_fenetre1A.<init>(Cadre_fenetre1A.java:13)
    at Panneau_fenetre$ecout1.actionPerformed(Panneau_fenetre.java:64)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2012)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2335)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:404)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252)
    at java.awt.Component.processMouseEvent(Component.java:6268)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3267)
    at java.awt.Component.processEvent(Component.java:6033)
    at java.awt.Container.processEvent(Container.java:2045)
    at java.awt.Component.dispatchEventImpl(Component.java:4629)
    at java.awt.Container.dispatchEventImpl(Container.java:2103)
    at java.awt.Component.dispatchEvent(Component.java:4455)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4633)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4297)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4227)
    at java.awt.Container.dispatchEventImpl(Container.java:2089)
    at java.awt.Window.dispatchEventImpl(Window.java:2517)
    at java.awt.Component.dispatchEvent(Component.java:4455)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:649)
    at java.awt.EventQueue.access$000(EventQueue.java:96)
    at java.awt.EventQueue$1.run(EventQueue.java:608)
    at java.awt.EventQueue$1.run(EventQueue.java:606)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:105)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:116)
    at java.awt.EventQueue$2.run(EventQueue.java:622)
    at java.awt.EventQueue$2.run(EventQueue.java:620)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:105)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:619)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:275)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:200)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:190)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:185)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:177) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:21:12.180

You've failed to properly initialize your array. Therefore, `allField[i] = null` for all `i < Na`. Hence the `NullPointerException`. The following will work,

```
for(int i = 0;i < Na;i++)
{
    JTextField textField = new JTextField(String.valueOf(0));
    textField.setBounds(150, 350 + i * 25, 20, 20);
    allField[i] = textField;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:26:04.190

这条线...

```
JTextField[] allField = new JTextField [Na]; 
```

初始化一个新的 ARRAY，它将保存 JTextField 对象。数组中有 -Na- 空格，但每个空格仍然是空的。您仍然需要创建 JTextField 对象才能进入空数组空间。

像这样的东西应该工作......

```
for(int i = 0;i < Na;i++)
{
    allField[i] = new JTextField(String.valueOf(0));
    allField[i].setBounds(150, 350 + i * 25, 20, 20);

} 
```

# jquery - JQuery 名称名称属性在 IE9 中不起作用

> ID：11851775
> 
> 赞同：2
> 
> 时间：2012-08-07T18:18:41.480
> 
> 标签：jquery, internet-explorer-9, attr

我正在尝试克隆表的最后一行并使用 jquery 指定新的名称和 ID 属性。

查询函数

```
function addTableRow(table){

    var $tr = $(table).find("tbody tr:last").clone();
    $tr.find("input,select,textarea").attr('name', 'test');
    $tr.find("input,select,textarea").attr('id', 'test');
    $(table).find("tbody tr:last").after($tr);

} 
```

表格行（在 PHP 中）

```
echo '<tr onclick="alert(this.innerHTML);">';
echo '<td>Home: </td>';
echo '<td colspan="6"><input type="text" name="home'.$i.'" id="home'.$i.'" value="'.$row['homePhone'].'" style="width: 90px;"></td>';
echo '</tr>'; 
```

按钮（PHP 之外）

```
<button onclick="addTableRow(document.getElementById('tableID'));">Add</button> 
```

上面的代码在 chrome 和 firefox 中完美运行。然而，在 IE9 中，只有 id 属性发生了变化，而名称始终保持不变。

是什么导致了这种行为，我怎样才能让我的代码工作？

# php - 停止会话在 PHP 上超时

> ID：11851776
> 
> 赞同：0
> 
> 时间：2012-08-07T18:18:42.503
> 
> 标签：php, session, timeout

我在 PHP 上做一个项目，它几乎不涉及任何人为干预，换句话说，我正在制作一个应该运行很长时间的特殊脚本（用户访问我的网站并且脚本一直运行直到用户退出...）。与我有关的一个问题是：

当脚本像这样运行一段时间时会话不会过期吗？如果是这样，我怎么能绕过它，所以它可以运行很长时间？

哦，还有一个问题：我的 PHP 脚本可以在没有任何用户干预的情况下自行启动吗？如果是这样，我该如何配置它呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:23:33.013

You can run PHP from the command line. Those scripts do not have a timeout like user-called scripts. Otherwise, you can set the timeout with set_time_limit like

```
 set_time_limit(0); // 0 means no limit 
```

See [http://php.net/manual/en/function.set-time-limit.php](http://php.net/manual/en/function.set-time-limit.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T20:06:14.283

1.  您可以使用[set_time_limit(0)](http://php.net/manual/en/function.set-time-limit.php)来避免超时。
2.  要让 PHP 脚本自行启动，您可以使用[cron](http://www.adminschoice.com/crontab-quick-reference)

# google-chrome-extension - 拦截 chrome-extension://*/?q=在 chrome 扩展中

> ID：11851779
> 
> 赞同：1
> 
> 时间：2012-08-07T18:18:51.470
> 
> 标签：google-chrome-extension

所以我在我的扩展中使用多功能框，当用户在多功能框中输入内容后，它成为扩展“历史”的一部分（这将是一个很好的功能）。但是，当单击历史记录条目时，它会转到“chrome-extension//?q=，并返回错误 6 (net::ERR_FILE_NOT_FOUND)。有没有办法纠正这种情况，或者允许这样做像第一次那样行事，还是仅仅通过禁用历史？

编辑：所以事实证明不能将内容脚本注入 chrome 扩展（即使[文档说你可以](http://code.google.com/chrome/extensions/match_patterns.html)（[他们希望能解决这个问题](https://groups.google.com/a/chromium.org/forum/?fromgroups#!topic/chromium-extensions/fd2OREQ_byA%5B1-25%5D)）

任何其他建议仍然值得赞赏，但我已经不太希望这样做了。

# php - 在 php 中运行的单个脚本中，所有 xml 标记都不会被删除

> ID：11851780
> 
> 赞同：1
> 
> 时间：2012-08-07T18:18:51.590
> 
> 标签：php, xml

我有以下xml：

```
<?xml version="1.0" encoding="utf-8"?>
<server>
  <gcm regId="APA91-yySYdx_Ydvkl2pQNB54yDpJRq4SnWvJCpsaCm6hT3LlXqP1S-3uTiXlXwylPKmrFSZbsA" email="mozi"/>
  <conversation ip="mozi1" email="mozi">
    <chat>abc</chat>
  </conversation>
  <conversation ip="mozi1" email="mozi">
    <chat>abc</chat>
  </conversation>
  <conversation ip="mozi1" email="mozi">
    <chat>abc</chat>
  </conversation>
  <conversation ip="mozi1" email="mozi">
    <chat>abc</chat>
  </conversation>
  <conversation ip="mozi1" email="mozi">
    <chat>abc</chat>
  </conversation>
</server> 
```

我想删除所有`conversation`标签`email=mozi`。

我正在从以下代码中执行此操作。

```
public function DeleteConversation()
{
    $conv=$this->xmlDom->getElementsByTagName("conversation");

    foreach ($conv as $conversation) 
    {
        if ($conversation->getAttribute('email') == $this->adminEmail) 
        {
            $this->xmlDom->documentElement->removeChild($conversation);
        }
    }
    $this->SaveChanges();
} 
```

现在，当我运行脚本并调用此函数时。循环只工作 3 次。即它只删除`3 records`。当我下次运行脚本时，它会删除一条记录，下一次删除一条记录。所以这就是所有五条记录都被删除的方式。为什么会这样？

我希望它们一次全部删除。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:38:02.027

`foreach`与从 a 中删除元素结合使用很麻烦`DOMNodeList`。当元素被删除时，列表会就地更改，但`foreach`不会对此进行补偿。

> DOM 中的 NodeList 和 NamedNodeMap 对象是活动的；也就是说，对底层文档结构的更改会反映在所有相关的 NodeList 和 NamedNodeMap 对象中。
> 
> – [DOM 结构模型](http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/core.html#ID-1590626202)

两种常见的方法是：

1.  **构建要移除的元素集合，然后移除它们**

    ```
    foreach ($conv as $conversation) 
    {
        if ($conversation->getAttribute('email') == $this->adminEmail) 
        {
            $to_delete[] = $conversation;
        }
    }

    foreach ($to_delete as $conversation)
    {
        $conversation->parentNode->removeChild($conversation);
    } 
    ```

2.  **从列表中删除第一个元素，直到不再有**

    ```
    $conv = $xpath->query('/server/conversation[@email="'.$this->adminEmail.'"]');
    while ($conv->length > 0)
    {
        $conv->item(0)->parentNode->removeChild($conv->item(0));
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:27:16.600

我认为这是由于您操纵了您正在循环的集合。尝试像这样创建数组的副本：

```
public function DeleteConversation()
{
    $conv=$this->xmlDom->getElementsByTagName("conversation");
    $copy = $conv;

    foreach ($copy as $conversation) 
    {
        if ($conversation->getAttribute('email') == $this->adminEmail) 
        {
            $this->xmlDom->documentElement->removeChild($conversation);
        }
    }
    $this->SaveChanges();
} 
```

# wpf - 需要在样式为 ToggleButton 的 RadioButton 中将 TextBlock 的文本居中

> ID：11851782
> 
> 赞同：1
> 
> 时间：2012-08-07T18:18:59.510
> 
> 标签：wpf, xaml

也尝试使用标签。

按钮中的文本左对齐。

```
<ItemsControl ItemsSource="{Binding ButtonLinks}">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <RadioButton Style="{StaticResource {x:Type ToggleButton}}"                                 
                             Margin="5"
                             Background="{x:Null}"
                             Height="40"
                             FontSize="14"
                             GroupName="Views"
                             FontWeight="Normal"
                             cal:Message.Attach="ShowPage">
                    <TextBlock Text="{Binding BtnText}"
                               TextAlignment="Center"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
                </RadioButton>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl> 
```

预计到达时间：

我正在使用 MahApps.Metro 覆盖，当我删除 App.xaml 中的控件资源时它可以工作，基本上有没有办法覆盖你拉入的资源上的对齐等属性？

我从 app.xaml 中删除的行：

```
<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:55:38.567

我必须为在 mahapps 库中设置为“Left”的 RadioButton 覆盖 Horizo​​ntalAlignment。

# java - 执行 mouselistener 的 java 代码中的错误

> ID：11851785
> 
> 赞同：0
> 
> 时间：2012-08-07T18:19:26.893
> 
> 标签：java, swing

嗨，我正在我的程序中执行鼠标侦听器操作，当用户单击面板时，我正在制作一个颜色 jpanel，它会更改其颜色，但是一行代码会给出一些错误，例如在您的代码中创建一个类 e，但 e 已经被声明为事件类请帮助我这里是我的代码下面。错误在这一行“ **panel.addMouseListener(e);** ”。

```
'import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class randomcolor extends JFrame{
    JPanel panel;
    public randomcolor (){
        panel=new JPanel();
        panel.setBackground(rancolor());
        add(panel);
    }

    event e =new event();
    panel.addMouseListener(e);

    public Color rancolor(){
        int r= (int) (Math.random()*256);
        int g= (int) (Math.random()*256);
        int b= (int) (Math.random()*256);
        return (new Color(r,g,b));
    }

    public class event implements MouseListener{
        public void mouseClicked(MouseEvent e) {
            panel.setBackground(rancolor());
        }
        public void mousePressed(MouseEvent e) {
        }
        public void mouseReleased(MouseEvent e) {
        }
        public void mouseEntered(MouseEvent e) {
        }
        public void mouseExited(MouseEvent e) {
        }
    }

    public static void main (String args[]){
        randomcolor gui=new randomcolor();
        gui.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        gui.setVisible(true);
        gui.setSize(300, 300);
        gui.setTitle("color panel");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:21:06.953

大写中的事件`event e = new event()`。应该是`Event e = new Event()`。~~代码中的格式看起来很奇怪；这也可能隐藏其他格式错误~~.

现在代码格式正确，我可以看到另一个问题；你可能本来打算

```
Event e = new Event();
panel.addMouseListener(e); 
```

在你的构造函数中，而不是*在*那个右花括号之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-17T07:21:20.087

将语句移动`panel.addMouseListener(e);`到构造函数`randomcolor()`。这将解决问题。

# ios - ios - 无法使 UITableView 单元格高度与文本量成正比

> ID：11851789
> 
> 赞同：0
> 
> 时间：2012-08-07T18:19:39.527
> 
> 标签：ios, ios5, uitableview

我试图让 UITableView 单元格适合文本。到目前为止，我有这样的事情：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UILabel *label = nil;

    UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:(UITableViewCellStyleDefault)
            reuseIdentifier:@"business"];

    NSString *comment = [[items_array objectAtIndex:[indexPath row]] objectForKey:(@"comment")];

cell.textLabel.numberOfLines = 0;
        cell.textLabel.lineBreakMode = UILineBreakModeWordWrap;

        CGSize constraint = CGSizeMake(320 - (10 * 2), 20000.0f);

        CGSize size = [comment sizeWithFont:[UIFont systemFontOfSize:14] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];

        label = [[UILabel alloc] initWithFrame:CGRectZero];

        [label setText:comment];
        [label setFrame:CGRectMake(10, 10, 320 - (10 * 2), MAX(size.height, 44.0f))];

        cell.textLabel.text = comment;  
    } 
```

我也有这个功能

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath;
{    
    NSString *comment = [[items_array objectAtIndex:[indexPath row]] objectForKey:(@"comment")];

    CGSize constraint = CGSizeMake(320 - (10 * 2), 20000.0f);

    CGSize size = [comment sizeWithFont:[UIFont systemFontOfSize:14] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];

    CGFloat height = MAX(size.height, 44.0f);

    return height + (10 * 2);
} 
```

但它没有为 UITableViews 的单元格分配正确的高度。我认为我在分配标签和单元格文本的方式/位置方面犯了一些错误。

请帮助我理解它应该是怎样的。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:24:06.673

You need to set height of a cell using `-tableView:heightForRowAtIndexPath`.

* * *

**With the new code posted**

Here is how I did it (I used a prototype cell so things may be different for you).

I set the the autosizing of the cell to auto size the height of the label (this may already be set for the textLabel).

Then in `-tableView:heightForRowAtIndexPath` I did the following:

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath;
{    
    CGSize size = CGSizeMake(WIDTH_OF_PROTOTYPE_LABEL, CGFLOAT_MAX);
    size = [TEXT_AT_INDEX_PATH sizeWithFont:FONT_OF_PROTOTYPE_LABEL constrainedToSize:size lineBreakMode:UILineBreakModeWordWrap];

    CGFloat height = size.height + (HEIGHT_OF_PROTOTYPE_CELL - HEIGHT_OF_PROTOTYPE_LABEL);
    return MAX(height, HEIGHT_OF_PROTOTYPE_CELL);
} 
```

* * *

**Update 2**

In looking at your code again, I see two possible problems. 1) You have the width of the textLabel wrong. 2) You should compute the do MAX as the last thing after you compute the final new height.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:46:15.713

这会让你更亲近吗？

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{ 
 UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"business"]; 

 if (cell == nil)
 {  
  cell = [[UITableViewCell alloc] initWithStyle:(UITableViewCellStyleDefault)reuseIdentifier:@"business"]; 
 }

 NSString *comment = [[items_array objectAtIndex:[indexPath row]] objectForKey:(@"comment")]; 

 CGSize constraint = CGSizeMake(320 - (10 * 2), 20000.0f); 

 CGSize size = [comment sizeWithFont:[UIFont systemFontOfSize:14] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap]; 

 UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 300, MAX(size.height, 44.0f) + 20.0f)]; 
 label.numberOfLines = 0; 
 label.lineBreakMode = UILineBreakModeWordWrap; 
 label.text = comment;  

 [cell.contentView addSubview:label]; 

} 
```

# java - Java/Android - 崩溃 - Apache commons-io-2.4.jar

> ID：11851795
> 
> 赞同：0
> 
> 时间：2012-08-07T18:19:55.140
> 
> 标签：java, android, apache-commons

我正在尝试使用`org.apache.commons.io.FileUtils`静态方法将字符串中的值保存到本地系统上的文件中`writeStringToFile`。

因此，首先我下载了​​ commons-io-2.4.jar 及其 javadocs 和源代码，并通过 Java Build Path 将其导入到我的 Eclipse 项目中。一切都编译得很好。

但是，当我添加简单的行时：

```
org.apache.commons.io.FileUtils.writeStringToFile(new java.io.File(Environment.getExternalStorageDirectory().toString() + "/logt.txt"), rslt.toString()); 
```

程序崩溃。但是，它不会在该声明附近崩溃。相反，它在包含调用此函数的方法的 Object 的构造函数处崩溃。

换句话说

*   在我的代码前面，我创建了一个对象 TranslateTask，
    *   其中恰好包含一个函数调用 doTranslate()。
    *   writeStringToFile 调用是在 doTranslate() 调用中进行的，
*   然而，当我实例化一个 TranslateTask 对象时，实际的崩溃就发生了。
*   但是，当我注释掉对 writeStringToFile() 的调用时，崩溃永远不会发生
    *   即使崩溃没有发生在 doTranslate() 调用中......
    *   所以，当我实例化一个包含它的对象时，仅仅提到 writeStringToFile() 就会使我的程序崩溃。

为了让它更简单，我在一个`Try, catch (RejectedExecutionException e)`块中实例化了对象，但程序在这部分崩溃了：

```
PathClassLoader.findClass(String) line: 243 **Last call in the stack**
PathClassLoader(ClassLoader).loadClass(String, boolean) line: 573   
PathClassLoader(ClassLoader).loadClass(String) line: 532    
Translate$4.run() line: 159  **Crash happens here where I instantiate a TranslateTask object** 
```

所以 PathClassLoader... 不知道如何调试这个。我所知道的是，如果我取消`org.apache.commons.io.FileUtils.writeStringToFile()`调用，则错误永远不会发生，并且代码在任何地方都可以正常运行。

使用 Eclipse Indigo 在 Android 的 API8/10 上运行它。

编辑-Logcat：

> 08-07 18:40:11.409：I/System.out(1395)：调试器已解决 (1363)
> 
> 08-07 18:40:14.399: W/KeyCharacterMap(1395): id 0 没有键盘
> 
> 08-07 18:40:14.399：W/KeyCharacterMap(1395)：使用默认键盘映射：/system/usr/keychars/qwerty.kcm.bin

不要认为它给出了任何提示，但这就是 logcat 在调试器稳定后给出的全部内容。

EDIT2 - 为了更好地衡量，我刚刚添加 `<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />` 但仍然不行

EDIT3 - 我开始认为 apache commons-io-2.4.jar 本身不适用于 Android。会是这样吗？

EDIT4 - 如果有人想破解它，这是我的代码。它是在 Windows 7 Eclipse Indigo 中制作的。该代码基于“Hello Android”翻译部分。我要做的就是将一些 JSON 提取到一个字符串中并将其保存到我的 sdcard 中。但是，它在这里演变成了这个谜...... [https://dl.dropbox.com/u/10790286/Translate.zip](https://dl.dropbox.com/u/10790286/Translate.zip)（参见 TranslateTask.java 第 111 行）

EDIT5 - 有趣的更新。`FileUtils.writeStringToFile(new java.io.File("/mnt/sdcard/logt.txt"), "test");`当我在调试期间手动放入eclipse 表达式框中时，出现以下错误

> 发生异常：java.lang.NoSuchMethodError

我不明白为什么会出现此错误，因为 1) WriteStringToFile() 函数位于 commons-io 源中。2）我可以实例化一个 FileUtils 对象 3）我将它导入到我的程序中。

这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:24:59.260

写入路径`"c:\\temp\\logt.txt"`不会在 Android 上运行。您可以使用诸如`Environment.getExternalStorageDirectory().toString() + "/log.txt"`写入 SD 卡之类的东西。

**编辑：** 以下在我的 Galaxy Nexus 上工作：

```
try {
  FileUtils.writeStringToFile(new File(Environment.getExternalStorageDirectory(),"log2.txt"), "HelloNow");
} catch (IOException e) {
  Log.e(TAG,e.getMessage())
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:58:37.127

虽然程序在编译器中成功运行，但程序在 android 设备中运行时崩溃。因为在运行时它只检查 android 依赖项中的 jar 文件。我也有类似类型的问题。我在首选项/属性 - > java build 中解决了它。勾选外部 jar 文件。

# java - 在 Wicket 中验证图像尺寸

> ID：11851801
> 
> 赞同：0
> 
> 时间：2012-08-07T18:20:19.343
> 
> 标签：java, image, web-applications, wicket

我正在开发一个 webbapp，它从用户那里接收图像资源，但我想验证这些要上传的图像是否具有特定的尺寸，如 600X800 等。

我试图找到答案，但我没有选择:)。

如果有人以前这样做过，那就太好了。

感谢您的帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T13:46:25.093

尝试

```
BufferedImage bi = ImageIO.read (file);
bi.getWidth();//width
bi.getHeight ();//height 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T22:07:24.857

最后我确实找到了方法：我们首先得到它要上传的文件，然后我使用一个创建的类，我在堆栈溢出时在这里找到，找到尺寸的宽度和高度，我只是玩 if's then ，这是代码，希望对某人有所帮助！

```
public class AddPromo extends WebPage {

/**
 * 
 */

private FileUploadField fileUpload;
private String UPLOAD_FOLDER = "..\\Promociones\\";

private static final long serialVersionUID = 1L;
@SuppressWarnings({ "rawtypes", "unchecked" })
public AddPromo(){
    add(new Label("user",ActiveUser.USER));

    //Add Feedback panel
    add(new FeedbackPanel("feedback_2"));

    //LOGOUT LINK
    Logout logoutLink = new Logout("logout");
    add(logoutLink);

    //Add backlink to SuccesPage
    add(new Link("link_atras"){
        /**
         * 
         */
        private static final long serialVersionUID = 1L;

        @Override
        public void onClick(){
            SuccesPage nueva = new SuccesPage("",1);
            setResponsePage(nueva);
        }
    });

    //Definitions for date attributes
    final Locale selectedLocale = Session.get().getLocale();

    add(new StaticImage("image_test",new Model("http://1-ps.googleusercontent.com/h/www.bizreport.com/2011/02/03/200x200xandroid-logo-200x200.jpg.pagespeed.ic.SONOBLzFc5.jpg")));

    Form<?> form = new Form<Void>("form") {
         /**
         * 
         */
        private static final long serialVersionUID = 1L;

        @Override
         protected void onSubmit() {
            JPEGDim dims = new JPEGDim();
            final FileUpload uploadedFile = fileUpload.getFileUpload();
            if (uploadedFile != null) {

                // write to a new file
                File newFile = new File(UPLOAD_FOLDER
                    + uploadedFile.getClientFileName());

                try {
                    final Dimension d = dims.getJPEGDimension(newFile);
                    if (d.getWidth()==1024 || d.getHeight()==768 ) {
                        try {
                            if (newFile.exists()) {
                                newFile.delete();
                            }
                            newFile.createNewFile();
                            uploadedFile.writeTo(newFile);
                            info("saved file: " + uploadedFile.getClientFileName());
                            info("Imagen cumple con dimensiones " + d.getHeight() + " x " + d.getWidth());

                        } catch (Exception e) {
                            throw new IllegalStateException("Error "+e.toString());
                        }
                    } else {
                        error("Archivo no valido... " +  + d.getHeight() + " x " + d.getWidth());
                    }

                } catch (IOException e1) {
                    // TODO Auto-generated catch block
                    error(e1.toString());

                }

             }

            }

        };

        // Enable multipart mode (need for uploads file)
        form.setMultiPart(true);
        // max upload size, 10k
        form.setMaxSize(Bytes.megabytes(10));
        form.add(fileUpload = new FileUploadField("fileUpload"));

    add(form);
}

class JPEGDim {

    public Dimension getJPEGDimension(File f) throws IOException {
            FileInputStream fis = new FileInputStream(f);

            // check for SOI marker
            if (fis.read() != 255 || fis.read() != 216)
                    throw new RuntimeException("SOI (Start Of Image) marker 0xff 0xd8 missing");

            Dimension d = null;

            while (fis.read() == 255) {
                    int marker = fis.read();
                    int len = fis.read() << 8 | fis.read();

                    if (marker == 192) {
                            fis.skip(1);

                            int height = fis.read() << 8 | fis.read();
                            int width = fis.read() << 8 | fis.read();

                            d = new Dimension(width, height);
                            break;
                    }

                    fis.skip(len - 2);
            }

            fis.close();

            return d;
    }

} 
```

}

# javascript - How to submit drag and drop images without Ajax to servlet?

> ID：11851814
> 
> 赞同：3
> 
> 时间：2012-08-07T18:21:12.893
> 
> 标签：javascript, forms, html, servlets, drag-and-drop

I've an array of images got from drag and drop using HTML5 and previously was submitting those through ajax.
But now I want to send these in a form WITHOUT using ajax. What would be the approach? thanks in adv.!!

```
function upload(file) { // image file from drag n drop 

    var formData = new FormData();
    formData.append("file", file);

    var xhr = new XMLHttpRequest();
    xhr.open("POST", "uploadServlet", true); 
    xhr.send(formData);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:08:40.897

选项之一是查看画布，因为您指定了 HTML5。
这在移动设备上也受支持。

然后将图像加载到画布中，然后让画布输出图像数据。

这个图像数据（如 base64，或 png，或...）然后可以是这样的表单内隐藏输入字段的值：
`document.getElementById("hiddenInputField").value=canvas.toDataURL("image/png");`

如果您喜欢这种方法，我相信我们可以为您找到一些工作示例或自定义代码。

祝你好运！

# c - OpenCV cvFindContours 只找到一个轮廓

> ID：11851815
> 
> 赞同：0
> 
> 时间：2012-08-07T18:21:17.320
> 
> 标签：c, opencv, computer-vision, contour, feature-detection

我正在继续我的 openCV 工作，这是我[在这里](https://stackoverflow.com/questions/11816245/detecting-small-circles-with-opencv-bad-image-quality/11816747#comment15709116_11816747)描述的第一次冒险。它进行得很好，但我偶然发现了另一件棘手的事情。我想在已应用自适应阈值的图像上找到轮廓：

![在此处输入图像描述](../Images/828791c9b3cc0822af30d82f80c2aada.png)

所以这`cvFindContours`似乎工作得很好，结果如下：

![在此处输入图像描述](../Images/25b0dfb588fa8d7990a78f5dbde1318b.png)

问题是，当我尝试遍历找到的计数时，它说只有一个轮廓（`contours->total`在下面的代码中等于 1）。这是代码：

```
IplImage* img;
if((img = cvLoadImage( "photos/img-000012.ppm", 1)) == 0 )
{
    perror("cvLoadImage");
    return 1;
}
cvNamedWindow( "Image view", 1 );
cvShowImage( "Image view", img );

IplImage* gray = cvCreateImage( cvGetSize(img), 8, 1 ); // allocate a 1 channel byte image
cvCvtColor( img, gray, CV_BGR2GRAY );
cvShowImage( "Image view", gray );
cvWaitKey(0);

cvAdaptiveThreshold(gray, gray,
        255,    //  Non-zero value assigned to the pixels for which the condition is satisfied
        CV_ADAPTIVE_THRESH_MEAN_C, // adaptiveMethod
        CV_THRESH_BINARY_INV,   // thresholdType
        11, // blockSize
        5); // Constant subtracted from the mean or weighted mean
cvShowImage( "Image view", gray );
cvWaitKey(0);

IplConvKernel *se = cvCreateStructuringElementEx(3, 3, 1,  1,  CV_SHAPE_RECT, NULL);
cvErode(gray, gray, se, 1);
cvShowImage( "Image view", gray );
cvWaitKey(0);

IplImage *canny_out = cvCreateImage(cvGetSize(gray), 8, 1);
cvCanny(gray, canny_out, 50, 100, 3);
cvShowImage( "Image view", canny_out );
cvWaitKey(0);

CvMemStorage *storage = cvCreateMemStorage(0);
CvSeq *contours = cvCreateSeq(0, sizeof(CvSeq), sizeof(CvPoint), storage);
cvFindContours(gray, storage, &contours, sizeof(CvContour), CV_RETR_LIST,
        CV_CHAIN_APPROX_SIMPLE, cvPoint(0,0));
printf("contours->total = %d\n", contours->total);

cvDrawContours(img, contours, CV_RGB(0,255,0), CV_RGB(0,0,255),
        2, 1, 8, cvPoint(0, 0));
cvShowImage( "Image view", img );
cvWaitKey(0); 
```

应该是这样，只有一个轮廓吗？也许我不明白openCV对轮廓的定义？我会很感激你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T19:13:17.233

实际上`cvFindContours`返回已建立轮廓的数量（我测试了你的图片，它返回>1）。请参阅[文档](http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#findcontours)。但我不知道为什么`total`等于一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T06:33:16.470

1.  你不需要`cvCreateSeq()`之前`cvFindContours()`
2.  而不是轮廓->总计，遍历它们。

    `for (; contours != 0; contours = contours->h_next)`

# iphone - Xcode reuse detail view for multiple table views

> ID：11851816
> 
> 赞同：0
> 
> 时间：2012-08-07T18:21:17.730
> 
> 标签：iphone, xcode, uitableview, didselectrowatindexpath

I have multiple table views that display different items. The detail view for each cell though should have the same layout. I want to use the same detail view for all the cells of each table without having to implement a different detail view class for each table since it'll pretty much be the same code. How do I do this?

The following method is in one of the table views. This displays the detail view when a cell is selected:

```
-(void)tableView:(UITableView *)tv didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"didSelectRowAtIndexPath");
    AppDelegate *delegate =
        (AppDelegate *)[[UIApplication sharedApplication] delegate];

    Detail *detail=
        [[Detail alloc] initWithIndexPath:indexPath];

    [delegate.navController pushViewController:detail animated:YES];

    [tv deselectRowAtIndexPath:indexPath animated:YES];
} 
```

The following is the viewDidLoad method in the Detail view class:

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    AppDelegate *delegate =
    (AppDelegate *)[[UIApplication sharedApplication] delegate];

    PokemonInfo *thisPokemon = [delegate.allArray objectAtIndex:index.row];
    self.title = thisPokemon.name;

    nameView.text = thisPokemon.name;
    typeView.text = thisPokemon.type;
    attackView.text = thisPokemon.attack;
    attackView.editable = NO;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:39:27.067

创建视图并将其布置在笔尖中。在视图中给每个元素一个唯一的标签。当您需要使用 nib (UINib) 实例化视图时，然后在您想通过使用“viewWithTag”询问来填充它时访问每个元素。假设您正在回收单元格，您总是使用适当的数据设置任意视图的元素。

如上所述，更传统的方法是在 nib 中实例化一个单元格，然后执行相同操作 - 您要访问的每个元素都有一个唯一的标签。

# wcf-data-services - Get the Last page in an odata Query

> ID：11851817
> 
> 赞同：0
> 
> 时间：2012-08-07T18:21:26.097
> 
> 标签：wcf-data-services, odata

How could one get the last page of data using skip/take/inlinecount in a single odata query (Wcf Data Services)?

Fx.. With page size 25...

```
http://server:8000/Html5Controls/Services/SampleDBService.svc/Offices?$format=json&$top=25&$skip=0&$orderby=city 
```

Would get the first page. Is there a way to combine the count to get the last page in a single query?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T11:01:25.430

不，目前没有办法做到这一点。（您需要一种方法来引用查询中的总计数，但这样的函数不存在）。您可以在两个查询中执行此操作：请求具有内联计数的第一页，获取该计数并计算最后一页的 $skip 值并请求该值。

# c++ - C++ 中的 Softimage 访问参数

> ID：11851818
> 
> 赞同：0
> 
> 时间：2012-08-07T18:21:26.563
> 
> 标签：c++, xsi

我在这里有点绝望......我正在尝试访问 Softimage 中的一个灯光参数。

首先，当我们这样做时：

```
light.GetParameterValue(L"LightExponent") 
```

有用！

但是当我们尝试：

```
light.GetParameterValue(L"soft_light.atten") 
```

它完全失败了！

我试图查找文档，但我能找到的唯一代码是 Python 中的代码，并且没有指示 C++ 中的等效代码。在 python 中，他们设法执行以下操作：

```
xsi = Application
test = xsi.GetValue("LightName.point.soft_light.atten") 
```

但是我不知道什么是Application，它和API中的XSI::Application不一样。

那么，知道如何访问这个值吗？另外，如果我能在 C++ 中找到 Application.GetValue 的等价物（*在脚本中，您可以看到 Application.SetValue... 所以我想 GetValue 以某种形式存在！*），那就太好了...我可以简单地使用灯光的名称，然后添加我需要访问该值的信息，例如：

```
SomeUnknownClassForNow::GetValue(light.GetName() + ".point.soft_light.atten"); 
```

任何的想法 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:53:02.137

在我们一位客户的帮助下，我终于设法找到了一个合适的解决方案。

首先，有一些直接参数，例如“LightExponent”。但是还有其他与对象相关的参数，例如灯光，在其他称为着色器的类别中。

对于光源，或者至少是点光源，只有一个着色器，称为“soft_light”。可以通过以下方式访问它：

```
light.GetShaders()[0] 
```

可以使用 GetName() 验证其名称。在这种情况下，它将是“LightName.point.soft_light”。

最后，访问“soft_light.atten”参数：

```
light.GetShaders()[0].GetParameterValue("atten") 
```

因此，在 Softimage 中，对象中有某种层次结构，所有这些都作为着色器分离。对于更复杂的对象，只需找到正确的着色器并提取其参数即可。

# python - 如何在 python 中从 Twitter 授权 url 中提取 PIN/验证器值

> ID：11851819
> 
> 赞同：0
> 
> 时间：2012-08-07T18:21:27.860
> 
> 标签：python, twitter, oauth

我试图找到从 python 中的[https://dev.twitter.com/docs/api/1/get/oauth/authorize](https://dev.twitter.com/docs/api/1/get/oauth/authorize)响应中提取 PIN 值的最佳方法。我知道这不是最佳做法，我需要使用回调 url 选项，但我正在为我的想法做一个 POC，我试图节省一些时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T12:09:11.967

如果您在您控制的 web 视图中进行授权，则可以对其进行筛选。但是，正如 jterrace 在上面的评论中提到的那样，整个想法是用户必须将其复制并粘贴到您的应用程序中。

否则，您将没有选择（出于充分的理由），并且您最好使用真正的回调来获取 oauth_verifier（实际上是 PIN）发送给它。这样您就可以存储和使用 oauth_verifier 来获取 access_token。

然而，我认为 Twitter 并没有严格遵循引入 oauth_verifier 的 OAuth1.0a 规范。因此，您可以为您的请求令牌打开一个授权窗口，等待一分钟，然后检查请求令牌是否已被用户授权。您可以通过尝试将其交换为访问令牌来做到这一点。如果我错了，请纠正我。

# css - twitter bootstrap：如何跨越导航栏中的链接？

> ID：11851820
> 
> 赞同：2
> 
> 时间：2012-08-07T18:21:43.833
> 
> 标签：css, twitter-bootstrap, navbar

我尝试了一些选项，但我无法让 4 个链接跨越导航栏。我认为将`span3`类添加到每个`<li>`. 这是我的 HTML：

```
 <div class="navbar center">
      <div class="navbar-inner">
        <div class="container row">
            <ul class="nav span12">
              <li class="active span3">
                <a href="#">Home</a>
              </li>
              <li class="span3"><a href="#">Link</a></li>
              <li class="span3"><a href="#">Link</a></li>
              <li class="span3"><a href="#">Link</a></li>
            </ul>
        </div>
      </div>
    </div> 
```

为了使链接居中，我使用了此处描述的解决方案：[修改 twitter bootstrap navbar](https://stackoverflow.com/questions/10568103/modify-twitter-bootstrap-navbar)

这是CSS：

```
.navbar-inner { 
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
}

.center.navbar .nav,
.center.navbar .nav > li {
    float:none;
    display:inline-block;
    *display:inline; /* ie7 fix */
    *zoom:1; /* hasLayout ie7 trigger */
    vertical-align: top;
}

.center .navbar-inner {
    text-align:center;
} 
```

我设法得到的是：[![](../Images/720b8b896837b9f4045811500192983b.png "由 imgur.com 主办")](https://imgur.com/DXcSO) 我怎样才能让这四个链接跨越同一行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:44:24.017

在这里使用`spanX`不是最好的解决方案（除非您使用的是 bootstrap-resonsive.css，请参见下文）。您可以使用百分比，只要您愿意在导航栏中的项目数量发生变化时修改您的 CSS。

您可以使用默认导航栏标记使其工作：

```
<div class="navbar">
    <div class="navbar-inner">
        <div class="container">
            <ul class="nav">
                <li><a href="#">Home</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
            </ul>
        </div>
    </div>
</div> 
```

还有两个 CSS 规则。第一个删除`<ul class="nav">`了`<div class="container">`.`<div class="navbar-inner">`

第二条规则将每个的宽度设置为宽度的`<li>`一定百分比`<ul>`。如果您有四个项目，则将其设置为`25%`. 如果你有五个，那就是`20%`，依此类推。

```
.navbar-inner ul.nav {
  margin-right: 0;
  float: none;
  width: 100%;
}
.navbar-inner ul.nav li {
  width: 33%;
  text-align: center;
} 
```

[**jsFiddle 演示**](http://jsfiddle.net/pHRc9/)

**更新**

如果您使用的是响应式引导 CSS，则可以使用内置`spanX`类，如下所示：

```
<div class="navbar">
    <div class="navbar-inner">
        <div class="container">
            <ul class="nav row-fluid">
                <li class="span4"><a href="#">Home</a></li>
                <li class="span4"><a href="#">Link</a></li>
                <li class="span4"><a href="#">Link</a></li>
            </ul>
        </div>
    </div>
</div> 
```

然后，您需要的所有 CSS 是：

```
.navbar-inner ul.nav li {
    text-align: center;
} 
```

[**jsFiddle 演示**](http://jsfiddle.net/vYYSX/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T19:00:14.643

你做了一个好的开始，但你的标记没有反映真实的网格：

*   你不放`.spanX`一个`.span12`
*   `.container`并且`.row`可能具有冲突的属性

它似乎适用于此：

```
<div class="navbar center">
  <div class="navbar-inner">
    <div class="container">
        <div class="row">
            <ul class="nav">
              <li class="active span3">
                <a href="#">Home</a>
              </li>
              <li class="span3"><a href="#">Link</a></li>
              <li class="span3"><a href="#">Link</a></li>
              <li class="span3"><a href="#">Link</a></li>
            </ul>
        </div>
    </div>
  </div>
</div> 
```

[演示（jsfiddle）](http://jsfiddle.net/Sherbrow/L5g8g/)和[全屏](http://fiddle.jshell.net/Sherbrow/L5g8g/show/)

# java - How I use a custom font with the Batik SVG library?

> ID：11851821
> 
> 赞同：10
> 
> 时间：2012-08-07T18:21:45.530
> 
> 标签：java, svg, truetype, batik

I'm working on a Java program which creates templates for clothes. The user enters the word they want to see on the item of clothing and the system creates a PDF template. To create the template I create an SVG document programatically then use Batik to transcode the SVG to the PDF format.

My client now wants to be able to use custom fonts to create the templates. I was wondering if it's possible to use fonts like a TTF with the Batik transcoder? If so how do you go about setting up the SVG?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T21:43:28.163

首先，您需要使用 batik 的 ttf2svg 将字体文件从 TTF 转换为 SVG，一旦您拥有转换后的文件，您必须在 SVG 文档的“defs”部分添加参考。我就是这样做的：

```
Element defs = doc.createElementNS(svgNS, "defs");

Element fontface = doc.createElementNS(svgNS, "font-face");
fontface.setAttributeNS(null, "font-family", "DroidSansRegular");

Element fontfacesrc = doc.createElementNS(svgNS, "font-face-src");
Element fontfaceuri = doc.createElementNS(svgNS, "font-face-uri");

fontfaceuri.setAttributeNS(svgNS, "xlink:href", "fonts/DroidSans-webfont.svg#DroidSansRegular");

Element fontfaceformat = doc.createElementNS(svgNS, "font-face-format");
fontfaceformat.setAttributeNS(svgNS, "string", "svg");

fontfaceuri.appendChild(fontfaceformat);
fontfacesrc.appendChild(fontfaceuri);
fontface.appendChild(fontfacesrc);
defs.appendChild(fontface);
svgRoot.appendChild(defs); 
```

创建文本元素时，像设置任何其他字体一样设置字体系列

```
Element txtElem = doc.createElementNS(svgNS, "text");

txtElem.setAttributeNS(svgNS, "style", "font-family:DroidSansRegular;font-size:" + fontsize + ";stroke:#000000;#fill:#00ff00;");
txtElem.setTextContent("some text");
svgRoot.appendChild(txtElem); 
```

我从这篇文章中得到了信息：http: [//frabru.de/c.php/article/SVGFonts-usage](http://frabru.de/c.php/article/SVGFonts-usage)希望它有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-06T20:06:21.197

只需添加以下元素作为子元素`<svg/>`：`<style type="text/css">`然后，类似于 HTML...

# java - AbstractApplicationContext 与 ApplicationContext

> ID：11851829
> 
> 赞同：13
> 
> 时间：2012-08-07T18:22:38.443
> 
> 标签：java, spring

`AbstractApplicationContext`和有什么区别`ApplicationContext` ？我们可以打电话吗

```
context.registerShutdownHook() 
```

使用`ApplicationContext`？

我在浏览示例代码时看到了这一点 -

```
public static void main(String[] args) {
    AbstractApplicationContext context =new ClassPathXmlApplicationContext("Beans.xml");
    context.registerShutdownHook();
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-07T18:27:35.373

与抽象类 (AbstractApplicationContext ) 和接口 (ApplicationContext) 之间的差异相同。

**我们可以使用 ApplicationContext 调用 context.registerShutdownHook() 吗？**

不，因为`registerShutdownHook()`是`ConfigurableApplicationContext`接口的一部分，没有被扩展`ApplicationContext`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-28T05:34:15.177

registerShutdownHook() 优雅地关闭 bean 并像调用destroy方法一样进行预制完成。这是接口ConfigurableApplicationContext中声明的方法，由AbstractApplicationContext实现，它不是ApplicationContext实现的，所以只能从AbstractApplicationContext的对象调用registerShutdownHook()

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-21T22:30:04.873

registerShutdownHook() 不是 ApplicationContext 的一部分。所以，我们不能使用应用程序上下文。

可以使用 ConfigurableApplicationContext 或 AbstractApplicationContext 的引用调用此方法。

As 方法可以从具有实现的接口或类中调用。因为，我们实际上是使用 AbstractApplicationContext 的引用为 ClassPathXmlApplicationContext 创建对象。

Difference: ConfigurableApplicationContext is an interface where the methods are implemented in AbstractApplicationContext class.

# mysql - 对 mysql 表中的项目进行排序，其中顺序取决于特定 [可变] 列的值

> ID：11851831
> 
> 赞同：1
> 
> 时间：2012-08-07T18:22:53.450
> 
> 标签：mysql

假设示例：您有一个名为 HOUSES 的表，并且您希望按最后更新的顺序显示每一行。
- 最近的在前，最近的在后。
-您还想先订购未售出的，最后订购所有已售出的库存。

- 管理员还必须能够将未售出的更改为已售出，并让该更改将一件物品放到底部，而另一件已售出。如果需要，可以手动更改特定房屋的显示顺序。

我该怎么做？这些是我必须使用的列：

```
  -ID（我想可以用来按添加日期订购它们），
  -PRICE（vals 是：未售出的价格或已售出的“已售出”）
  -DISP_ORDER（具有真实显示顺序的整数字段）

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:39:17.613

尝试以下操作：

```
SELECT * FROM (
    SELECT
        ID, PRICE, DISP_ORDER,
        CASE WHEN PRICE = 'SOLD' THEN 1 ELSE 0 END AS soldOrder,
        CASE WHEN DISP_ORDER > 0 THEN DISP_ORDER ELSE -ID END AS customOrder
    FROM HOUSES
) AS q
ORDER BY
   soldOrder, customOrder 
```

内部查询构建两个自定义排序列。`soldOrder`将使所有已售商品值为 1，所有未售商品值为 0。如果设置了该值，则该`customOrder`列将使用该`DISP_ORDER`值，否则将使用该值`-ID`（以获取“按降序创建的日期”实现）。
外部查询将选择所有字段并`sortOrder`首先排序（将所有未售出的商品放在顶部，已售出在底部），然后按照它们的`customOrder`值对两半中的每一半进行排序（`DISP_ORDER`首先是值，然后是最近的所有商品-更改优先顺序）。

# c# - C# EmguCV/OpenCV“cvThreshold”异常行为 - 没有预期的阈值结果

> ID：11851832
> 
> 赞同：2
> 
> 时间：2012-08-07T18:22:57.183
> 
> 标签：c#, opencv, emgucv, image-recognition, threshold

有一个识别图像上的红色区域的任务，它需要最大的准确性。但是源图像的质量很差。我正在尝试使用 cvThreshold 最小化检测到红色区域的面具上的噪音。不幸的是，没有预期的效果 - 灰色伪影仍然存在。

```
//Converting from Bgr to Hsv
Image<Hsv, Byte> hsvimg = markedOrigRecImg.Convert<Hsv, Byte>();
Image<Gray, Byte>[] channels = hsvimg.Split();

Image<Gray, Byte> hue = channels[0];
Image<Gray, Byte> saturation = channels[1];
Image<Gray, Byte> value = channels[2];

Image<Gray, Byte> hueFilter = hue.InRange(new Gray(0), new Gray(30));
Image<Gray, Byte> satFilter = saturation.InRange(new Gray(100), new Gray(255));
Image<Gray, Byte> valFilter = value.InRange(new Gray(50), new Gray(255));

//Mask contains gray artifacts        
Image<Gray,Byte> mask = (hueFilter.And(satFilter)).And(valFilter);

//Gray artifacts stays even if threshold (the third param.) value is 0...
CvInvoke.cvThreshold(mask, mask, 100, 255, THRESH.CV_THRESH_BINARY);

mask.Save("D:/img.jpg"); 
```

同时在这里它工作正常 - 保存的图像是纯白色的：

```
#region test

Image<Gray,Byte> some = new Image<Gray, byte>(mask.Size);
some.SetValue(120);
CvInvoke.cvThreshold(some, some, 100, 255, THRESH.CV_THRESH_BINARY);
some.Save("D:/some.jpg");

#endregion 
```

阈值前的掩码示例： [http ://dl.dropbox.com/u/52502108/input.jpg](http://dl.dropbox.com/u/52502108/input.jpg)

阈值示例后的掩码：http: [//dl.dropbox.com/u/52502108/output.jpg](http://dl.dropbox.com/u/52502108/output.jpg)

先感谢您。康斯坦丁 B.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T18:06:59.633

应用任何类型的阈值后，在保存的图像上出现灰色伪影的原因是... ***.JPG**标准保存格式`Image<TColor, TDepth>`！更准确地说，是它应用的 jpeg 压缩。所以阈值本身没有问题。只是一个被破坏的输出图像。不过，这令人困惑。保存此类图像（无伪影）的正确方法是，例如：`Image<TColor,TDepth>.Bitmap.Save(your_path, ImageFormat.Bmp)`

# fancybox - Fancybox one-time popup

> ID：11851835
> 
> 赞同：1
> 
> 时间：2012-08-07T18:23:01.333
> 
> 标签：fancybox

I used your suggestions on [Delay pop-up for 10 seconds, only pop up once](https://stackoverflow.com/questions/8298886/delay-pop-up-for-10-seconds-only-pop-up-once/8305703), however it's not working. Do I need to do something like `<body onload='$("#various1").trigger("click");'>` Thanks.

# .htaccess - .htacess to redirect main domain but not redirect a subfolder

> ID：11851837
> 
> 赞同：1
> 
> 时间：2012-08-07T18:23:11.983
> 
> 标签：.htaccess, redirect

I want to be able to use an .htacess file to allow the main domain only to be redirected, but not a subfolder of that domain.

Example; somesite.com redirects to something.somesite.com but allow somesite.com/example through to what is in the /example directory.

I did see a question similar to this one but could not understand the answer well enough to want to use the code.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:29:10.007

尝试将此添加到`somesite.com`的文档根目录中的 htaccess 文件中：

```
RedirectMatch 301 ^/$ http://something.somesite.com/ 
```

如果您更愿意使用 mod_rewrite：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} somesite\.com$ [NC]
RewriteRule ^/?$ http://something.somesite.com/ [L,R=301] 
```

# actionscript-3 - AIR mobile 的精益和均值表

> ID：11851841
> 
> 赞同：0
> 
> 时间：2012-08-07T18:23:35.330
> 
> 标签：actionscript-3, flash, mobile, air

我相信很多人都需要这个，但到目前为止我还没有找到一个好的解决方案。

环境：使用 Flash CS6 创建的适用于 iOS 和 Android 的 AIR 应用程序。

我正在尝试做的事情：显示一个表格（5 列，200 行）。没什么花哨的，只是文本数据。表格应该是可排序的并且可以平滑地滚动以响应滑动手势。

DataGrid 组件太“重”，不推荐用于移动设备。有一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:37:06.420

我还没有尝试过，但是[Mad Components](http://code.google.com/p/mad-components/)（技术上它是 Extended Mad Components lib）有一个[UIDataGrid](http://madskool.wordpress.com/2011/04/06/madcomponents-update/)类。

除此之外，由于您的网格/表格只打算显示文本，您可能想尝试一下 Adob​​e 的组件。他们的网格很灵活，因此可能很“重”。

由于您只想渲染文本，因此您不会为尝试在网格内渲染较重的对象（复选框、按钮等）付出代价。性能（仅在网格内呈现文本时）可能是可以接受的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T08:27:13.007

对于表格显示（甚至是花哨的），我会使用 StageWebView，当然，如果您负担得起不能在其上覆盖任何东西的话。下面的快速示例：

```
webView = new StageWebView();
webView.viewPort = new Rectangle(0, 44, 480, 756);
webView.loadString('<html><head><style type="text/css">tr:nth-child(odd)    { background-color:#eee; } tr:nth-child(even)    { background-color:#fff; } .header_button { width:100%;}</style></head><body><table width="200" border="1"><tr><td><input name="Name" type="button" value="Name" class="header_button"></td><td>Id</td></tr><tr><td>Mark</td><td>0</td></tr><tr><td>Bob</td><td>1</td></tr></table></body></html>');

webView.stage = stage; 
```

您应该通读文档，因为 loadString 非常有限:) 以查看使用此类的所有可能方式，但是现在应该将这个想法植入您的心中:) 例如可以使用 CSS、JQuery 等，并且滚动非常快： )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T06:29:46.917

忘记 Flex DataGrid，即使使用静态文本，您也无法获得可接受的滚动性能（我得到了大约 5fps 的实时数据网格）。

要走的路是正常`List`的，带有标题的自定义`LabelItemRenderer`和按钮组。您可以很容易地使渲染器看起来像一个网格。

我还没有测试过[Alex Harui 的基于列表的 grid](http://blogs.adobe.com/aharui/2009/12/spark_list_spark_list_spark_da.html)，但它应该可以开箱即用。如果没有，你应该明白了。只需滚动您自己的基于 AS3 的渲染器，即使快速滚动，性能也应超过 25fps。我在 iPad2 上得到大约 30。

# hbase - Table scan with Camel on a remote HBase

> ID：11851844
> 
> 赞同：0
> 
> 时间：2012-08-07T18:23:41.817
> 
> 标签：hbase, apache-camel

I know in the first place that this question is dummy, yet I could not find a regarding documentation. Which is the way to have Apache camel scan a table on a remote HBase?

Apache camel's [documentation](http://camel.apache.org/hbase.html) doesn't help a lot. It only works when hbase is locally installed.

Thx in advance!

**EDIT:**

I tried the example of @cexbrayat, yet I am getting the following exception.

```
8071 [Camel (camel-1) thread #1 - stream://in] ERROR org.apache.camel.processor.DefaultErrorHandler - Failed delivery for (MessageId: ID-1344429030688-0-1 on ExchangeId: ID-1344429030688-0-2). Exhausted after delivery attempt: 1 caught: java.lang.NullPointerException
java.lang.NullPointerException
    at org.apache.camel.component.hbase.HBaseProducer.process(HBaseProducer.java:105)
    at org.apache.camel.util.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:61)
    at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
    at org.apache.camel.processor.SendProcessor$2.doInAsyncProducer(SendProcessor.java:120)
    at org.apache.camel.impl.ProducerCache.doInAsyncProducer(ProducerCache.java:292)
    at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:115)
    at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
    at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
    at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
    at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:73)
    at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
    at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
    at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
    at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:91)
    at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
    at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:330)
    at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:220)
    at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:45)
    at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
    at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:303)
    at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
    at org.apache.camel.processor.Pipeline.process(Pipeline.java:117)
    at org.apache.camel.processor.Pipeline.process(Pipeline.java:80)
    at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:45)
    at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
    at org.apache.camel.processor.UnitOfWorkProcessor.processAsync(UnitOfWorkProcessor.java:150)
    at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:117)
    at org.apache.camel.processor.RouteInflightRepositoryProcessor.processNext(RouteInflightRepositoryProcessor.java:48)
    at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
    at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
    at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
    at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
    at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:73)
    at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:99)
    at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:86)
    at org.apache.camel.component.stream.StreamConsumer.processLine(StreamConsumer.java:198)
    at org.apache.camel.component.stream.StreamConsumer.readFromStream(StreamConsumer.java:159)
    at org.apache.camel.component.stream.StreamConsumer.run(StreamConsumer.java:100)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T07:17:20.420

您必须在 xml 文件中将 hbase 配置为 hbase-site.xml。您将在官方 hbase[文档](http://hbase.apache.org/configuration.html#config.files)中找到方法。

然后您将能够在 Camel 中使用此配置文件：为此，您将在 camel-hbase 组件[源中找到一个示例](https://github.com/apache/camel/tree/trunk/components/camel-hbase/src/test/resources)

使用 java DSL，路由将如下所示：

```
public class FournisseurRoute extends RouteBuilder {
    @Override
    public void configure() throws Exception {
        from("direct:scan")
            .to("hbase:mytable?operation=CamelHBaseScan")
            .log("${body}");
    }
} 
```

# javascript - getItem localstorage 包含一个字符串

> ID：11851853
> 
> 赞同：5
> 
> 时间：2012-08-07T18:24:28.417
> 
> 标签：javascript, html, local-storage

我的本地存储中有多个键：`task-1,task-2, task-3 ...`我正在寻找一种方法来获取以字符串“tasks-”开头的键的总数，以便将它放在我的循环中而不是`localStorage.length`.

事实上，如果我有另一个使用本地存储的应用程序，我的循环会返回一个与本地存储中所有键相对应的长度，包括相关应用程序之外的键。

```
 i=0;

   if(localStorage.getItem("task-"+i) != null){

     for( i = 0; i < localStorage.length; i++){ 

       console.log(i)

     }
  } 
```

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:28:55.343

如果您控制这些项目的创建，将它们存储在一个对象中并使用 JSON 在对象和字符串之间进行转换会更有意义：

```
var tasksObject = {
    task1: ...,
    task2: ...,
    ...
};

window.localStorage.setItem('tasks', JSON.stringify(tasksObject));

... later ...

var tasks = JSON.parse(window.localStorage.getItem('tasks'));

for (var task in tasks) {
    // do stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-02T07:03:06.490

```
var i, e, tasks=[];
for (i=0; (e=localStorage["task-"+i])!==undefined; i++) {
   console.log(e);
   tasks.push(e);
} 
```

怎么样

```
localStorage['num-tasks'] = tasks.length; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:29:20.803

语句应该切换。循环遍历所有内容，看看每个项目是否符合您的条件。

```
var count = 0;
for(i = 0; i < localStorage.length; i++){ 
    if(localStorage.getItem("task-"+i) != null){
        console.log(i)
        count++;
    }
}
// count contains number of items beginning with task 
```

# qt - QTableWidget通过userdata找一行

> ID：11851854
> 
> 赞同：2
> 
> 时间：2012-08-07T18:24:37.887
> 
> 标签：qt, find, row, qtablewidget, user-data

QTableWidget 有一种方法可以用用户数据搜索一行吗？

就像是：

```
//set user data
row->setData(0, Qt::UserRole, "ID001");

//find row by user data
int rowIndex = table->findByData("ID001"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:35:28.593

您可以使用`QAbstractItemModel::match()`

```
QAbstractItemModel *model = table->model();
QModelIndexList matches = model->match( model->index(0,0), Qt::UserRole, "ID001" )

foreach( const QModelIndex &index, matches )
{
    QTableWidgetItem *item = table->item( index.row(), index.column() )
    // Do something with your new-found item ...
} 
```

# html - Internet Explorer 8 中的 HTML 提交按钮定位问题

> ID：11851855
> 
> 赞同：1
> 
> 时间：2012-08-07T18:24:43.833
> 
> 标签：html, internet-explorer, internet-explorer-8, submit, form-submit

这在 Chrome 和 firefox 上几乎是正确的，但问题是 IE 上的提交按钮的位置如果比 css 太正确。请尽快检查代码并提供帮助。

您可以在链接[http://jsfiddle.net/7vUW6/上找到 HTML 和 CSS 代码](http://jsfiddle.net/7vUW6/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T19:17:48.583

如果要居中，请删除 class="submit" 并将其替换为 style="text-align: center;"。这将使按钮在行中居中。

同样对于 IE，不要忘记在标记中指定 DOCTYPE 声明。用这个：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:57:22.733

我看到了你的编码并解决了问题，你有一些错误，因为输入框没有设置正确的宽度。然后提交按钮也是我修复问题，我检查所有浏览器现在对齐是否正确。编辑编码如下。请复制此代码并运行您的系统。

## 完整的编码：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Customer Advance and Project Registration System | Ymoff Technologies Pvt. Ltd.</title>
    <meta name="description" content="This is Project Registration and Customer Advance Payment Recept System designed and developed for Ymoff Technologies." />
    <link type="text/css" rel="stylesheet" href="stylesheets/style.css" />
    <link rel="shortcut icon" href="favicon.ico" />
    <script src="js/jquery-1.6.4.js"></script>
      <script type="text/javascript" src="js/jquery.validate.js"></script>
      <script>
      $(document).ready(function(){
        $("#form1").validate();
      });
      </script>
    <script type="text/javascript">
        function clearThis(target){
            target.value= "";
        }
        </script>
    <script type="text/javascript">
    function autoGrow (oField) {
      if (oField.scrollHeight > oField.clientHeight) {
        oField.style.height = oField.scrollHeight + "px";
      }
    }
    </script>

    <style>
    /*-- Reset CSS --*/
    .wraper{
            width:70%;
            margin: 0px auto;
            padding:0;
        }

        #field {

        }
        #ftext{
            font-family: 'Capriola', sans-serif;
        }
        #btext{
            font-family: 'Quando', serif;
            font-weight:400;
        }
        #space{
            padding-left:5%;
        }
        .submit{
            padding-left:54%;
            padding-right:60%;
            clear:both;
        }
        #value{
            color:#999;
        }
        textarea {
      resize: none;
    }
    #noscrollbars {
        overflow:hidden;
    }
    #inform{
        color:#C00;
        font-size:12px;
        text-align:justify;
    }
    select{
        color:#00F;
    }
    textarea{
        border-right: #a9a9a9 1px solid;
      border-top: #a9a9a9 1px solid;
      border-left: #a9a9a9 1px solid;
      border-bottom: #a9a9a9 1px solid;
      color:#00F;
    }
    #show1{
        color:#10e684;
        font-size:18px;
        font-weight:600;
    }
    #show2{
        color:#9e2a28;
        font-size:18px;
        font-weight:600;
    }
    #show3{
        color:#9e2a28;
        font-size:10px;
    }
    fieldset{
        width:400px;
        padding-top:5px;
    }
    legend{
        font-family: "Quando", serif;
    }

    .umame
    {

        text-align:right;
        float:left;
        padding-bottom:5px;
        padding-right:8px;
    }
    .umame1
    {

        text-align:left;
        float:left;
        padding:0px;
        margin:0px;
        padding-bottom:5px;
    }

    </style>
    </head>

    <body class="wraper">
    <div>
        <img src="images/dashboardlogin.png" style="padding-top:10px; padding-left:15%;"  />
        <br />
        <br />
        <div class="container">
        <center>
        <br  /><br  /><br  />
        <h2 id="btext">Please perfectly enter the following fields :</h2>
           <form name="login" action="" method="post">
           <fieldset>
           <table width="337" cellpadding="0" cellspacing="0" border="0">
           <tr>
               <td width="169" class="umame">
               <span id="ftext">Client Registration ID <span style="color:#C00;">*</span></span>
               </td>
                   <td width="156" class="umame1">
                   <input type="text" name="userid" value="Cleint Registraion ID" style="color:#999; width:156px;" onfocus="if(this.value==this.defaultValue){this.value='';}this.style.color='#000';" onblur="if(this.value==''){this.value=this.defaultValue;this.style.color='#999';}" />
                   </td>
           </tr>
           <tr>
               <td class="umame" width="169">
               <span id="ftext">Temporary Password <span style="color:#C00;">*</span></span>
               </td>
                    <td width="156" class="umame1">
                   <input type="password" name="password" value="***************" style="color:#999; width:156px;" onfocus="if(this.value==this.defaultValue){this.value='';}this.style.color='#000';" onblur="if(this.value==''){this.value=this.defaultValue;this.style.color='#999';}" />
                   </td>
           </tr>
           <tr>
               <td class="umame" width="169"> &nbsp;</td>
               <td width="156" class="umame1">
               <input type="submit" name="ok" value="Login" />
               </td>
           </tr>
           </table>
           </fieldset>
           </form>
           <table width="337">
           <tr>
                   <td ><span id="inform"><br />
                     * Marks fields are sent to you by E-Mail when your project has been registered with us. If any how if you lost our mail and want to get your Password, please visit this link <a href="#">Get Password</a> with your YMOFF Registration ID. </span>
                   </td>
           </tr>
           </table>

          </center>
      </div>
    </div>

    </body>
    </html> 
```

# plpgsql - postgresql 真空分析许多表

> ID：11851860
> 
> 赞同：1
> 
> 时间：2012-08-07T18:25:06.140
> 
> 标签：plpgsql, postgresql-8.4, vacuum

我有一个由大约 200 个子表组成的中型表（大约 150 亿行）（即每个子表继承母表，并且有约束 CHECKS 来优化分区）。

加载每个表的 plpgsql 代码也会在每个子表上生成索引，但不幸的是（因为它是一个函数），它也不能`vacuum analyze subtable;`为它刚刚加载和索引的子表执行 a。

因此，`vacuum analyze`在整个数据库的下一个完成之前，母表上的所有查询都很糟糕并且不使用索引（正如解释所揭示的那样）。

请注意，这是 PostgreSQL 8.2.14 的全部内容。

**问题**

1.  有没有办法让 plpgsql 函数说，请在上面加糖，结束事务块并执行`vacuum analyze subtable`？
2.  有没有办法使用一些通配符（）一次清理/分析许多表`vacuum analyze schema.subtables*`？
3.  或者，是否可以只真空/分析一个模式？
4.  有没有其他方法可以从 postgresql 中以编程方式清理/分析 200 个子表（是的，我可以将所有子表的名称、折腾和季节转储到 psql 脚本中，然后执行那个，但它有点难看）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T20:20:37.070

> 请注意，这是 PostgreSQL 8.2.14 的全部内容。

经过五年的运行，8.2 去年停止了支持，并且 8.2.14 缺少许多在 2009-03-16 之后发现的安全漏洞和错误的修复。您迫切需要从这十年开始使用一个版本。

> 有没有其他方法可以从 postgresql 中以编程方式清理/分析 200 个子表（是的，我可以将所有子表的名称、折腾和季节转储到 psql 脚本中，然后执行那个，但它有点难看）。

您可以在其中创建条目`pg_autovacuum`并将其留给 autovacuum 守护进程。当然，该守护进程近年来已经变得*更好*，所以这是更新的另一个原因。

# ruby-on-rails - Rails Thinking Sphinx Indexing Self Join Associations 树结构

> ID：11851864
> 
> 赞同：1
> 
> 时间：2012-08-07T18:25:19.180
> 
> 标签：ruby-on-rails, tree, indexing, associations, thinking-sphinx

我有属于某个类别的产品。类别通过使用自连接的父子节点构成树结构：

协会：

```
class Category < ActiveRecord::Base
  has_many :children, class_name: "Category", foreign_key: "parent_id"
  belongs_to :parent, class_name: "Category"
end

class Product < ActiveRecord::Base
  belongs_to :category
end 
```

例如，

```
Fruits & Vegetables     =>    "High" Category 
Fresh Fruits            =>    "Intermediate" Category
Citrus                  =>    "Low" Category
Limes Large             =>    Product 
```

我想使用 Thinking Sphinx 来索引产品的“低”类别名称和“高”类别名称，甚至可能是树层次结构中的所有类别名称。

我可以轻松索引低类别父名称，如下所示：

```
class Product < ActiveRecord::Base
  indexes :name
  indexes category.parent.name, as: :low_category
end 
```

注意：“高”和“低”类别之间的节点数是可变的。我需要一种动态添加分层名称的方法。

但是如何在树中进一步索引类别名称呢？我知道我不能在 TS 索引中使用方法，那么我该如何设置数据库呢？

最重要的是，如何索引“高”类别名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:36:30.667

你能做这个吗 ？

```
class Product < ActiveRecord::Base
  indexes :name

  category = category.parent
  indexes category.name, as: :low_category

  while category.parent do
    if category.parent
      indexes category.name, as: :root_category
    elsif category.parent
      indexes category.name, as: :high_category
    else
      indexes category.name
    end

    category = category.parent
  end
end 
```

# asp.net-mvc - 从 View 访问 POST 值

> ID：11851865
> 
> 赞同：3
> 
> 时间：2012-08-07T18:25:27.730
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

有没有办法从视图访问 POST 值（不通过控制器）

```
@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        @Html.TextBox("SomeValue")    
        <input type="submit" value="Submit" />
    </fieldset>
}

The value being posted is @SomeValue 
```

**@SomeValue**的正确语法是什么

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:32:20.033

我认为可以通过以下方式访问表单集合：

```
HttpContext.Current.Request.Form 
```

...但为什么？它违背了 MVC 的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:32:05.457

如果你需要一些客户端的东西，你应该使用 JavaScript 而不是将逻辑放在视图中。观点应该是愚蠢的。

更换线路：

```
@Html.TextBox("SomeValue") 
```

和

```
@Html.TextBox("SomeValue", new {Id = "somevalue"}) 
```

一旦使用 JQuery 呈现视图，将允许您访问该值，如下所示：

```
$("#somevalue").val() 
```

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:32:06.247

如果您想知道 TextBox 的值是什么，在它进入控制器之前，您可以通过 javascript 获取它。

将您的 HTML 更改为具有 Span 以便我们稍后可以更改它的内容

发布的价值是

覆盖您的提交行为并获取它

```
<script type="Text/javascript">
  $(function(){
        $("form").submit(function(e){
           e.preventDefault();
           $("#spanVal").html($("#YourTextBoxID").val());
        });
  });

</script> 
```

这不会真正将表单提交给`HTTPPOST`控制器的操作方法，而是在跨度内的文本框中显示值。**

# jquery - JQuery：单击链接时无法显示隐藏

> ID：11851874
> 
> 赞同：0
> 
> 时间：2012-08-07T18:26:35.390
> 
> 标签：jquery, row, show

我有以下代码正在运行（单击链接将显示下一个隐藏的表格行）：

HTML：

```
<table>

<a href="#" class="showrows">Add row</a>

<tr class="cache">
<td><input type="text"  size="15"></td>
<td><input type="text"  size="15"></td>
</tr>

<tr class="cache">
<td><input type="text"  size="15"></td>
<td><input type="text"  size="15"></td>
</tr>

</table> 
```

和我的 JS：

```
$(document).ready(function() {

$('tr.cache').css("display","none");

$('.showrows').live('click',function(e){
   e.preventDefault();
   $('tr:hidden:first').show("fast");   
});

}); 
```

但是现在我需要在同一页面上有几个像当前表（见上文）一样的表，每个表都有自己的“showrows”功能。实际上我需要我的 JQuery 代码来查找链接属于哪个表，然后找到该表的第一个隐藏行，并显示它...

我已经一一尝试了以下所有解决方案：

```
$(this).closest('tr.cache').show("fast");
$(this).closest('tr:hidden:first').show("fast");
$(this).closest('table').find('tr:hidden:first').show("fast");
$(this).closest('tr').show("fast");
$(this).parents('table').next('tr:hidden:first').show("fast"); 
```

没有一个工作！在你看来是什么问题？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:32:05.003

在链接周围添加表格行和表格单元格，您的 HTML 标记无效

浏览器（大多数）浏览器会做什么，他们会给你这个标记：

```
<a class="showrows" href="#">Add row</a>
<table>
    <tbody>
        <tr class="cache">
            <td><input type="text" size="15"></td>
            <td><input type="text" size="15"></td>
        </tr>
        <tr class="cache">
            <td><input type="text" size="15"></td>
            <td><input type="text" size="15"></td>
        </tr>
    </tbody>
</table> 
```

所以你需要稍微改变你的标记：

```
<table>
  <tr>
    <td colspan="2">
      <a href="#" class="showrows">Add row</a>
    </td>
  </tr>
  <tr class="cache">
    <td><input type="text"  size="15"></td>
    <td><input type="text"  size="15"></td>
  </tr>

  <tr class="cache">
    <td><input type="text"  size="15"></td>
    <td><input type="text"  size="15"></td>
  </tr>

</table> 
```

并使用 jQuery 代码： $(document).ready(function() {

```
 $('tr.cache').css("display","none");

  $('.showrows').live('click',function(e){
    e.preventDefault();
    var table = $(this).closest("table");
    $('tr:hidden:first', table).show("fast");   
  }); 
```

});

演示：

[http://jsbin.com/owefew/1/edit](http://jsbin.com/owefew/1/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:32:15.367

```
$('.showrows').live('click', function(e) {
    e.preventDefault();

    var table = $(this).parent();
    $('tr:hidden:first', table).show("fast");   
}); 
```

试试这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:35:15.960

**带标识符（可以更改 HTML 结构）**

您必须将链接“附加”到表格。例如，您可以使用 data-... 属性，但 id 也可以。注意：您不能直接在 a 中放置锚点`table`，因此 Vadym Petrychenko 的解决方案仍然是无效的 HTML。

```
<a href="#" class="showrows" data-table="table1">Add row to table 1</a>
<table id="table1">
    <tr class="cache">
        <td><input type="text"  size="15">Table 1 cell 1</td>
        <td><input type="text"  size="15">Table 1 cell 2</td>
    </tr>
    <tr class="cache">
        <td><input type="text"  size="15">Table 1 cell 3</td>
        <td><input type="text"  size="15">Table 1 cell 4</td>
    </tr>
</table>

<a href="#" class="showrows" data-table="table2">Add row to table 2</a>
<table id="table2">
    <tr class="cache">
        <td><input type="text"  size="15">Table 2 cell 1</td>
        <td><input type="text"  size="15">Table 2 cell 2</td>
    </tr>
    <tr class="cache">
        <td><input type="text"  size="15">Table 2cell 3</td>
        <td><input type="text"  size="15">Table 2 cell 4</td>
    </tr>
</table> 
```

jQuery代码：

```
$(document).ready(function() {
    $('tr.cache').css("display","none");
    $('.showrows').live('click',function(e) {
        e.preventDefault();
        $('table#' + $(this).attr('data-table') + ' tr:hidden:first').show("fast");   
    });
}); 
```

见[http://jsfiddle.net/Mikey/KnRFf/](http://jsfiddle.net/Mikey/KnRFf/)

**无标识符**

我你真的在使用这种 HTML 结构，也可以在锚点之后链接到表格`$(this).next('table').find('tr:hidden:first').show("fast");`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T18:37:04.787

稍微改变一下 HTML。

### 将您的锚标记放在表格之外以进行有效标记。

***HTML***

```
<!-- First table -->

<a href="#" class="showrows">Add row</a>
<table>
  <tr class="cache">
    <td><input type="text"  size="15"></td>
    <td><input type="text"  size="15"></td>
  </tr>
  <tr class="cache">
    <td><input type="text"  size="15"></td>
    <td><input type="text"  size="15"></td>
  </tr>
</table>

<!-- Second table -->

<a href="#" class="showrows">Add row</a>
<table>
  <tr class="cache">
    <td><input type="text"  size="15"></td>
    <td><input type="text"  size="15"></td>
  </tr>
  <tr class="cache">
    <td><input type="text"  size="15"></td>
    <td><input type="text"  size="15"></td>
  </tr>
</table>

<!-- More tables --> 
```

***jQuery***

```
$('tr.cache').css("display", "none");

$('.showrows').live('click', function(e) {
    e.preventDefault();
    var table = $(this).next('table');
    table.find('tbody tr:hidden:first').show("fast");
}); 
```

**[演示](http://jsfiddle.net/Dx4Ez/5/)**

### 一件事

如果可能，使用, 而不是 ,处理**[`.on()`](http://api.jquery.com/on)**委托事件*（又名实时事件）*，***因为它已弃用***.`jQuery 1.7+``.live()`

# probability - 条件独立硬币

> ID：11851876
> 
> 赞同：0
> 
> 时间：2012-08-07T18:26:44.760
> 
> 标签：probability, bayesian

我一直在思考这个问题一段时间，我在概率图形模型的一个讲座中遇到了这个问题。[https://class.coursera.org/pgm/lecture/preview](https://class.coursera.org/pgm/lecture/preview)

问题很简单：

有两枚硬币，一枚是正常的，另一枚偏向正面 10 枚中的 9 枚。

我们捡了一枚硬币扔了，老师的说法是如果第一次出现正面，那么正面再次出现的概率会很高。

我们只能说第二枚硬币更有可能被贝叶斯选中。但在我看来，两者都应该是独立的

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:53:00.670

为了完全定义这个过程，让我们补充一点，每个硬币都有 1/2 的被挑选概率。

让 X1 和 X2 成为前两次投掷。“正面出现第一次”写成“X1=H”。

我们有：

P(X2=H | X1=H) = P(X2=H & X1=H) / P(X1=H)

P(X1=H) = 1/2 × 1/2 + 1/2 × 9/10 = 14/20 = 0.7

P(X1=H & X2=H) = 1/2 × (1/2)² + 1/2 × (9/10)² = 53/100

因此，P(X2=H | X1=H) = 53/70 ≃ 0.757 > 0.7

这意味着 P(X2=H | X1=H)，即在第一次出现正面出现的情况下，第二次出现正面出现的概率高于第一次出现正面出现的概率。

为了支持直觉，你可以考虑另一种情况：我们选择一个硬币并扔它，Tails 第一次出现。所以你认为它“可能”不是被选中的有偏见的硬币。相反，如果正面出现，则更有可能选择有偏见的硬币。如果是这样，那么获得正面的可能性更大。

或者另一个过程：你挑选一枚硬币，但不是随机的：你挑选有偏见的硬币的概率更高。然后你做一个单一的折腾。本次抛头更有可能出现正面。

# iphone - ActionSheet 中的 Action Sheet

> ID：11851879
> 
> 赞同：0
> 
> 时间：2012-08-07T18:27:04.277
> 
> 标签：iphone, xcode, uiactionsheet

我是 Objective C 和 iPhone 开发的新手。请告诉我如何在操作表中添加操作表。就像当我点击一个按钮时，一个动作表被打开，然后我单击第一个 ButtonIndex 动作，另一个动作表出现。请提及完整的代码。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:34:35.473

使用`UIActionSheet`委托方法：

```
-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {

    if (buttonIndex == 0) { // Add an action sheet for one of these buttons -> maybe here if you want...

     NSLog(@"You clicked the first button...");

     UIActionSheet *popupQuery = [[UIActionSheet alloc] initWithTitle:@"Another action sheet"
     delegate:self cancelButtonTitle:@"Cancel Button" destructiveButtonTitle:@"Destructive" 
     otherButtonTitles:@"Other Button 1", nil];

    popupQuery.actionSheetStyle = UIActionSheetStyleBlackOpaque;

    [popupQuery showInView:self.view];

    [popupQuery release];

    } 

    else {

        NSLog(@"Dismissing action sheet");

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:40:47.887

您要做的就是关闭第一个 UIActionSheet 并在其位置显示另一个 UIActionSheet。换句话说，您不想*在*另一个 UIActionSheet 中显示 UIActionSheet - 您希望在解除不同的 UIActionSheet 后显示 UIActionSheet。

要了解何时关闭操作表，您应该实现[UIActionSheetDelegate](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIModalViewDelegate_Protocol/UIActionSheetDelegate/UIActionSheetDelegate.html#//apple_ref/occ/intf/UIActionSheetDelegate)协议。例如：

```
- (void)actionSheet:(UIActionSheet *)actionSheet didDismissWithButtonIndex:(NSInteger)buttonIndex {
// first action sheet is dismissed
// show a new action sheet here
} 
```

# linker - HPUX Itanium 的包装器链接选项

> ID：11851881
> 
> 赞同：1
> 
> 时间：2012-08-07T18:27:14.727
> 
> 标签：linker, wrapper, hp-ux, itanium

对于 PA-RISC 版本，链接器为函数符号别名提供了 +afs 标志，而 GCC 提供了 -wrap 选项。

我正在寻找与 HPUX 11iv3 Itanium 类似的包装挂钩方法。任何建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:14:32.707

HPUX 11iv3 确实支持 PA Risc 链接器选项 +afs，它在 11iv3 中没有记录，因此如果您想尝试它，请查看 PA Risc 手册页。

它们是有区别的。

在 IPF 上，如果定义与引用在同一个翻译单元中，则绑定默认在编译时进行。这是 PA（SOM 和 ELF）的相反情况。

在编译时绑定某些东西时，指令顺序不同，绑定不走链接表路线。可能这就是 +afs 在 IPF 上未记录的原因。

但是，如果我们使用“-Bextern=symbol”编译器选项，那么编译器的行为就像在 PA 上一样，即所有对符号的引用都将通过链接表，上面的测试用例也将在 IPF 上工作。

但是，如果将 -Bextern 应用于在同一加载模块中解析的符号，则会出现性能损失。

# ios - 在 Core Data 中存储 CLRegion 属性

> ID：11851883
> 
> 赞同：0
> 
> 时间：2012-08-07T18:27:25.710
> 
> 标签：ios, core-data, core-location

我需要将 CLRegion 添加到我的核心数据实体中，但我没有为它选择什么类型。

我阅读了这个[文档](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdNSAttributes.html#//apple_ref/doc/uid/TP40001919-SW1)，但我仍然对如何正确设置它感到困惑。如果有人可以提供解释，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:40:52.370

对于 CLRegion 的实体属性类型，选择“Transformable”，然后定义 Core Data 为您生成的 NSManagedObject 中的对象是什么。（见下方位置）

```
@interface Person : NSManagedObject
{
}

@property (nonatomic, retain) NSString * firstName;
@property (nonatomic, retain) NSString * lastName;

@property (nonatomic, retain) CLRegion * location;

@end

@implementation Person

@dynamic firstName;
@dynamic lastName;

@dynamic location;

@end 
```

# javascript - 请解释为什么“更改数字的值甚至没有意义”

> ID：11851892
> 
> 赞同：4
> 
> 时间：2012-08-07T18:27:47.427
> 
> 标签：javascript, computer-science

我只是在阅读David Flanagan[的 JavaScript：权威指南](http://shop.oreilly.com/product/9780596805531.do)。我真的很喜欢，我很高兴我的第一本 Javascript 书就是这本。:)

但是，我无法理解这一段（3.7 Immutable Primitive Values and Mutable Object References）：

> `undefined`JavaScript 中的原始值（ 、 `null`、布尔值、数字和字符串）和对象（包括数组和函数）之间存在根本区别。原语是不可变的：没有办法改变（或“变异”）原语值。这对于数字和布尔值是显而易见的——<strong>改变数字的值甚至没有意义。然而，对于字符串来说，它并不那么明显。由于字符串类似于字符数组，因此您可能希望能够更改任何指定索引处的字符。

可能由于我缺乏CS背景（自学和所有......），我只是错过了一些东西，但是有人可以帮我解释一下吗？

特别是我强调的部分：为什么改变数字的值没有意义？

* * *

到目前为止我的想法：

*   也许他正在严格区分（在其他语言中可以称为）“变量”和“值”的概念。那么好吧，将 3 的值更改为 4 的值确实没有意义（这样`3 == 4`），但是下一句这样的解释失败了：这样的操作对字符串比对数字更有意义......？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T18:33:53.180

你说得对，改变字符串文字的*值*是没有意义的——这就是他实际上所说的；他只是说这可能不像这种情况那么*明显*`3 == 4`，因为您可以引用字符串中的单个字符（然后可能会认为您可以通过更改特定字符来更改字符串）。

考虑这个例子：

```
var s = 'hello world';
s[0] = 'H'; 
```

直观上看，这似乎是将单词大写，但字符串是*不可变*的，因此**不起作用**。

检查`s`我们仍然看到的输出：`s > 'hello world'`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T18:31:30.763

这正是你如何诠释它。例如，更改 3 的值是没有意义的`3 == 4`。

就字符串而言，在某些语言（如 C）中可以看到其值的可变性，但在其他语言（如 Java）中则不然。因此，它们是不可变的并不一定那么明显。这两种选择都有支持和反对的论据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T18:31:07.233

基本上，你对区别的把握比作者强，或者至少比作者给你的功劳要强。您的“到目前为止的想法”是完全正确的，但他认为许多新用户也希望能够更改字符串原语。你没有，这意味着你的期望与语言的实际行为方式相匹配，而不是与他认为你会期望的事情相匹配。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T18:32:22.743

字符串在 JavaScript 中是不可变的。他说字符串“不太清楚”，因为它对许多人来说没有多大意义（也许它对你有用，很明显）。我能提供的最佳解释是您定义字符串：“Bob”。您可以将整个东西重命名为“Cob”，但您不能将“B”物理更改为“C”，因为在内部，“B”只是一个数字（字符表示）。所以你基本上是在做“B”=“C”。或 SomeNumber = AnotherNumber。

# php - PHP PDO 无法打开流

> ID：11851895
> 
> 赞同：0
> 
> 时间：2012-08-07T18:27:55.213
> 
> 标签：php, pdo, yii

我敢肯定这是我忽略的一些简单的事情，但这让我有点发疯。我在运行 LAMP 的 Ubuntu 机器上。我在这台机器上运行了几个站点，使用 Php/MySql 毫不费力。我最近开始使用 Yii 框架建立一个站点，但我不认为这是一个 Yii 问题。也许是的。反正...

我的其他站点使用 mysqli，所以 Yii 的 PDO 要求对我来说是新的。我在 PDO 上做了一个快速的 -i|grep，它在安装/启用时返回，所以不用担心。我安装了框架，创建了一个快速测试站点和数据库。但是，当我尝试通过该站点连接到数据库时，我收到一条错误消息，告诉我 PDO 失败。具体来说，打开流失败。因此，即使安装了 PDO，它也没有找到 PDO。Yii 站点与其他站点位于同一 web 文件夹中，因此不会存在路径问题。

从 Yii 的角度来看，如果这就是问题所在……我能够为 Gii 中的各种数据库表创建控制器，但是当我尝试为这些表生成 CRUD 时，出现了同样的无法打开流错误。

作为记录，是的，MySql 在 Yii main.php 文件中启用。是的，连接字符串是正确的。如果 PDO 列为已启用，为什么它无法打开，我有点不知所措。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:05:33.880

仅针对搜索引擎发布此内容。我仍然不知道到底是什么问题。正如我提到的，PDO 显示从 CLI 启用，但不是从 phpinfo。这是可能的，因为 CLI 使用的 php.ini 与 apache2 不同。但是，在完全重新安装 php 后，我仍然遇到了同样的问题。我再次在 gedit 中打开了两个 .ini 文件，并在“pdo”上使用不区分大小写的查找逐行查找。它们绝对、完全相同。最后，我放弃了试图理解这个问题，而只是简单地解决了这个问题。我从 Apache2 中删除了 .ini 并用 cli 中的那个替换了它，瞧！我在 Apache2 中启用了 PDO。我仍然完全不知道问题是什么，但至少它已经解决了。

# jquery - $.seralize() 识别 jQuery UI 对话框中的表单元素变化

> ID：11851896
> 
> 赞同：1
> 
> 时间：2012-08-07T18:28:07.307
> 
> 标签：jquery, jquery-ui

但是，当我将任何表单元素包含到 jqueryui 对话框使用的 div 中时，我使用 `$('#myForm').seralize()`将参数传递给服务器端组件，但无法识别该 div 中的任何表单元素更改。`$.ajax()``$('#myForm').seralize()`

请参阅我的[jsfiddle](http://jsfiddle.net/vXLve/4/)示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:34:42.290

当您使用 jQuery UI 对话框时，它实际上会再次包装您的 $('#myForm') 并将其直接移动到关卡下方。

您可以通过对话框上的 firebug/chrome devtool 执行“检查元素”，您会发现对话框元素不再属于表单元素，因此缺少复选框数据。

您可以绑定回调或制作另一种形式并获得这样的序列化字符串；

```
$('#form_1').serialize() + '&' + $('#form_2').serialize(); 
```

希望它有帮助，干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:35:58.570

jQuery UI 对话框被放置在 body 标记的开头或结尾（我忘了是哪个），这意味着这些元素不再是表单的一部分。如果您使用的是 HTML5，则可以通过为这些输入提供新属性来解决此问题：`form="myForm"`

演示：http: [//jsfiddle.net/vXLve/7/](http://jsfiddle.net/vXLve/7/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T18:42:39.990

那是因为通过`$('#dialog').dialog()`将其完全克隆到另一个位置（我相信是页面底部）来`#dialog`移出。`#myform` `<div>`

您可以使用以下命令在对话框中找到输入：

```
$('#dialog :input').serialize(); 
```

也许您可以将这两组分开并将它们一起发送回服务器：

```
...
data: { 
    common: $('#myForm').serialize(),
    dialog: $('#dialog :input').serialize();
},
... 
```

或者，也许您可​​以将它们组合起来，如下所示：

```
...
data: $('#myForm').serialize() + '&' + $('#dialog :input').serialize(),
... 
```

更新的[jsFiddle](http://jsfiddle.net/consultcory/vXLve/8/)。

# c# - Powershell 脚本适用于一个 .NET 解决方案，而不是另一个

> ID：11851898
> 
> 赞同：0
> 
> 时间：2012-08-07T18:28:12.067
> 
> 标签：c#, powershell

我正在使用一个 C# 库，我[发现](http://archive.msdn.microsoft.com/psoutlooklive)它为 Outlook Live 运行一些远程 Powershell 脚本。作为它工作的概念验证，我做了一个单元测试，我可以运行（并逐步调试），它只调用`public static`这个库中的一个方法，它在后台打开一个远程 Powershell 会话并运行一个脚本。

这在我们的一个解决方案中非常有效，但是当我在另一个解决方案中运行它时它不起作用，即使两个解决方案都有相同的两个项目和测试类。一个解决方案给了我一个例外

> 加载格式数据文件时出错：Microsoft.PowerShell, , `C:\Users\xxxx.xxxx\AppData\Local\Temp\tmp_8c84e626-4399-420b-b874-9feeb3b1e195_tjlxhzzr.rlr\tmp_8c84e626-4399-420b-b874-9feeb3b1e195_tjlxhzzr.rlr.format.ps1xml`: 由于以下验证异常而跳过文件：`C:\Users\xxxx.xxxx\AppData\Local\Temp\tmp_8c84e626-4399-420b-b874-9feeb3b1e195_tjlxhzzr.rlr\tmp_8c84e626-4399-420b-b874-9feeb3b1e195_tjlxhzzr.rlr.format.ps1xml`无法加载文件，因为在此系统上禁用了脚本的执行。有关更多详细信息，请参阅“get-help about_signing”。

我所做的一项尝试是修改`PSCommand`C# 库的内部`Unrestricted`设置，但这并没有解决问题。但是，如果我打开 x86 Powershell 并运行`set-executionpolicy Unrestricted`我的测试将在两个解决方案中运行。在 x64 版本的 Powershell 中更改执行策略对任一解决方案都没有影响。

是否有某种特定于解决方案的权限设置？Web.Config 或 Global.asax 都不重要，因为我没有加载任何页面，所以我不知道还有什么会生效，因为我在两个解决方案中使用相同的测试运行器运行相同的单元测试（Testdriven 。网）。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T19:35:13.220

以管理员身份运行通常设置 hklm，否则在 64 位操作系统上的 hkcu 中设置您需要分别为 32 位和 64 位 PSH 运行 Set-ExecutionPolicy

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell

检查 cd "hklm:\Software\Microsoft\Powershell\1\ShellIds\Microsoft Powershell" 目录

# extjs - Sencha 导出图表可以吗？

> ID：11851899
> 
> 赞同：1
> 
> 时间：2012-08-07T18:28:26.950
> 
> 标签：extjs

在 sencha (http://www.sencha.com/products/extjs/) 中，我想知道是否可以有条形图或饼图并导出数据？我想从图表返回到我手中的打印数据。

** 如果我有一个条形图，上面已经绘制了数据，现在我想在一列中获取 x 轴，在另一列中获取 y 轴，但我希望将其导出以便我可以打印出来。我不想打印图表。

我的问题是：有没有办法做到这一点？如果是这样，需要或使用的代码是什么？

我也可以在 ZINGCHARTS.COM 上做吗

那么 zingcharts 呢？我做了我的研究，发现他们有这个代码叫做 zingchart.exec("yourChartId", "exportdata"); 我只是不知道如何将它准确地放入我的 zingcharts.rendering 函数中，我可以得到帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-02T21:51:35.243

我看到这是一个较老的问题，但希望这会对您或其他有类似问题的人有所帮助。

ZingChart exportdata 方法实际上并没有进入 zingchart.render 方法，它是它自己的 API 方法。

```
zingchart.exec('myChartDiv', 'exportdata', {
    url : 'www.zingchart.com/resources/exportdataurl.php'
}); 
```

'myChartDiv' 是指在您的图表呈现的页面中提供给 div 的 id。您可以像我在上面所做的那样在导出数据方法选项中设置“url”选项，也可以设置“exportdataurl”。数据通过 HTTP 作为 POST 数据发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T20:55:07.027

您可能可以使用在 Sencha 论坛上发布的[Export store to Excel 用户扩展。](http://www.sencha.com/forum/showthread.php?136598-Export-store-to-Excel)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T20:22:30.203

只是为了获取数据？当然。

图表由一个`store`对象填充，该对象是一个包含所有数据的容器。

将数据从存储中取出是非常先进的。

例如：

`store.each(function(store,record,e){console.log(record);});`

# javascript - 当窗口不可见时选择/剪切/粘贴到

> ID：11851903
> 
> 赞同：1
> 
> 时间：2012-08-07T18:28:55.127
> 
> 标签：javascript, adobe-indesign, extendscript

我正在编写一个脚本，我在其中设计名片并使用它来生成一张纸，上面有十张卡片，以匹配模板以打印临时卡片。这里棘手的部分是流血。它们会在中间重叠，所以我需要为每一个制作剪贴蒙版。

我想出了一个系统，在其中制作将成为剪贴蒙版的框架，复制卡片并将其移动到需要去的地方，然后或多或少地做了以下事情：

```
dupCard[i].select();
app.cut();

frameGroupFront[i].select();
app.pasteInto(); 
```

这很好用。但是因为它有点占用资源，我试图在创建时隐藏工作文件并使用 workingFile.windows.add(); 最后就像我过去所做的那样。但是当没有窗口时， select() 不起作用！我收到错误 90886，指出“没有打开任何文档窗口”。

如何选择我想要的项目，以便在没有可见窗口的情况下剪切和粘贴它？如果不可能，是否有解决该问题的替代方案？

### 编辑：

我被要求提供一个脚本示例，所以这是我可以提供的最基本的示例：

```
var newPage = app.documents.add();

var myRectangle = newPage.rectangles.add({geometricBounds:[1, 1, 5, 5]});
var myRectangle2 = newPage.rectangles.add({geometricBounds:[1, 1, 3, 3]});

myRectangle.select();
app.cut();

myRectangle2.select();
app.pasteInto(); 
```

该脚本有效。但是，取第一行并改为执行 app.documents.add(false) ，它不起作用，因为没有打开文档窗口。在此示例中，我希望能够将一个矩形放在另一个矩形内，而没有可见的窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T17:04:56.583

您可以像这样操作矩形对象本身，而不是使用复制和粘贴：

```
var doc = app.documents.add(); // Add a new doc

var page = doc.pages[0];       // Get the first page

var rect = page.rectangles.add({geometricBounds:[30,30,6,6]})    // Make a new rect

var rect2 = rect.rectangles.add({geometricBounds:[20,20,6,6]});  // Add a new rect inside 
```

这一切都可以在不打开窗口的情况下完成，因为您直接操作对象。希望这可以帮助！

# google-chrome - 部署不在 chrome webstore 中的 chrome 扩展

> ID：11851905
> 
> 赞同：0
> 
> 时间：2012-08-07T18:29:04.827
> 
> 标签：google-chrome, plugins, browser, google-chrome-extension, chrome-web-store

我发现 chrome webbrowser 最近禁用了部署不是来自[chrome webstore](https://chrome.google.com/webstore/category/home)的扩展的功能。我尝试直接打开我的extension.crx intro chrome，它不再工作了，它只是下载文件。

我知道我可以使用“加载解压扩展”，但我需要在大约 50 台计算机上执行此操作，所以这不是一个非常实用的方法。

有谁知道部署不在网上商店中的扩展的任何其他方法？

也许从 .exe 或类似的东西以编程方式“加载解压缩的扩展”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T19:11:02.357

您是否尝试过将其从下载栏或操作系统上的文件浏览器拖到 Chrome 上？我记得之前好像有这个问题。。。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-01-25T20:30:58.683

有关如何在 Chrome Dev 网站上完成此操作的更多信息：

[https://developer.chrome.com/extensions/crx](https://developer.chrome.com/extensions/crx)

看起来好像您需要创建一个 zip 文件，然后在该文件的开头添加其他标题，然后将文件扩展名从“.zip”更改为“.crx”

如果从网络服务器提供此文件，您应该使用标题“application/x-chrome-extension”让 Chrome 浏览器了解这是一个可安装的主题/应用程序/扩展。

# facebook - Facebook Graph API：用户拥有的所有照片

> ID：11851907
> 
> 赞同：0
> 
> 时间：2012-08-07T18:29:11.590
> 
> 标签：facebook, facebook-graph-api

我想形成一个图表请求来获取用户拥有的所有照片（由该用户发布）。现在我可以通过 获取所有专辑`/uid/albums`，然后通过 查询每个专辑`/aid/photos`，但这是很多请求。

我以前可以在 fql 中做到这一点，但现在 fql 很糟糕。有什么办法可以做到这一点，还是我必须迭代？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:34:03.733

如果您使用 Graph 调用，您将不得不进行迭代。FQL 将是更容易（如果不是更快）的选择。如果调用有问题，请提交错误。

# c# - 突出显示所有搜索词

> ID：11851908
> 
> 赞同：12
> 
> 时间：2012-08-07T18:29:17.087
> 
> 标签：c#, winforms, find, richtextbox, highlight

在我的`RichtextBox`，如果我写如下。

> 这是我的笔，
> 他的笔很漂亮。

现在我搜索单词“is”然后输出如下。

所有“是”都应突出显示。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-07T18:49:17.130

关于什么：

```
static class Utility {
    public static void HighlightText(this RichTextBox myRtb, string word, Color color) {  

       if (word == string.Empty)
            return;

       int s_start = myRtb.SelectionStart, startIndex = 0, index;

       while((index = myRtb.Text.IndexOf(word, startIndex)) != -1) {
           myRtb.Select(index, word.Length);
           myRtb.SelectionColor = color;

           startIndex = index + word.Length;
       }

       myRtb.SelectionStart = s_start;
       myRtb.SelectionLength = 0;
       myRtb.SelectionColor = Color.Black;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:35:04.467

看起来这样就可以了。

[http://www.dotnetcurry.com/ShowArticle.aspx?ID=146](http://www.dotnetcurry.com/ShowArticle.aspx?ID=146)

```
int start = 0;
int indexOfSearchText = 0;

    private void btnFind_Click(object sender, EventArgs e)
    {
        int startindex = 0;

        if(txtSearch.Text.Length > 0)
            startindex = FindMyText(txtSearch.Text.Trim(), start, rtb.Text.Length);

        // If string was found in the RichTextBox, highlight it
        if (startindex >= 0)
        {
            // Set the highlight color as red
            rtb.SelectionColor = Color.Red;
            // Find the end index. End Index = number of characters in textbox
            int endindex = txtSearch.Text.Length;
            // Highlight the search string
            rtb.Select(startindex, endindex);
            // mark the start position after the position of
            // last search string
            start = startindex + endindex;
        }
    }

    public int FindMyText(string txtToSearch, int searchStart, int searchEnd)
    {
        // Unselect the previously searched string
        if (searchStart > 0 && searchEnd > 0 && indexOfSearchText >= 0)
        {
            rtb.Undo();
        }

        // Set the return value to -1 by default.
        int retVal = -1;

        // A valid starting index should be specified.
        // if indexOfSearchText = -1, the end of search
        if (searchStart >= 0 && indexOfSearchText >=0)
        {
            // A valid ending index
            if (searchEnd > searchStart || searchEnd == -1)
            {
                // Find the position of search string in RichTextBox
                indexOfSearchText = rtb.Find(txtToSearch, searchStart, searchEnd, RichTextBoxFinds.None);
                // Determine whether the text was found in richTextBox1.
                if (indexOfSearchText != -1)
                {
                    // Return the index to the specified search text.
                    retVal = indexOfSearchText;
                }
            }
        }
        return retVal;
    }

// Reset the richtextbox when user changes the search string
    private void textBox1_TextChanged(object sender, EventArgs e)
    {
        start = 0;
        indexOfSearchText = 0;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-05T15:15:59.240

这将同时显示所有搜索的条件。

使用：1 个文本框（用于输入要搜索的文本）和 1 个按钮（用于运行搜索）。

在文本框中输入您的搜索条件，然后按搜索按钮。

```
 // On Search Button Click: RichTextBox ("rtb") will display all the words inside the document
    private void btn_Search_Click(object sender, EventArgs e)
    {
        try
        {
            if (rtb.Text != string.Empty)
            {// if the ritchtextbox is not empty; highlight the search criteria
                int index = 0;
                String temp = rtb.Text;
                rtb.Text = "";
                rtb.Text = temp;
                while (index < rtb.Text.LastIndexOf(txt_Search.Text))
                {
                    rtb.Find(txt_Search.Text, index, rtb.TextLength, RichTextBoxFinds.None);
                    rtb.SelectionBackColor = Color.Yellow;
                    index = rtb.Text.IndexOf(txt_Search.Text, index) + 1;
                    rtb.Select();
                }
            }
        }

        catch (Exception ex) { MessageBox.Show(ex.Message, "Error"); }
    }
} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-07T18:34:07.970

```
 private void button3_Click(object sender, EventArgs e)
    {
        if (textBox1.Text != "")
        {
            for (int i = 0; i < richTextBox1.TextLength; i++)
            {
                richTextBox1.Find(textBox1.Text, i, RichTextBoxFinds.None);
                richTextBox1.SelectionBackColor = Color.Red;
            }
        }
        else
        {
            for (int i = 0; i < richTextBox1.TextLength; i++)
            {
                richTextBox1.SelectAll();
                richTextBox1.SelectionBackColor = Color.White;
            }
        }
    }[lets make it!][1] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-08T10:46:41.827

如果您只想匹配整个单词，您可以使用它，请注意，这会忽略大小写，而且 |s\b 表示复数会突出显示，例如 Cat 匹配猫但不匹配 caterpiller ：

```
 public static void HighlightText(RichTextBox myRtb, string word, Color color)
    {
        if (word == string.Empty)
            return;
        var reg = new Regex(@"\b" + word + @"(\b|s\b)",RegexOptions.IgnoreCase);

        foreach (Match match in reg.Matches(myRtb.Text))
        {
            myRtb.Select(match.Index, match.Length);
            myRtb.SelectionColor = color;
        }

        myRtb.SelectionLength = 0;
        myRtb.SelectionColor = Color.Black;
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-05T11:56:54.027

我会这样做，因为所有其他答案都会突出显示文本，但在您再次搜索后不会将其更改回来。

使用 RichText 查找方法查找搜索词的起始索引。

```
public int FindMyText(string searchText, int searchStart, int searchEnd)
    {
        int returnValue = -1;

        if (searchText.Length > 0 && searchStart >= 0)
        {
            if (searchEnd > searchStart || searchEnd == -1)
            {
                int indexToText = richTextBox1.Find(searchText, searchStart, searchEnd, RichTextBoxFinds.MatchCase);
                if (indexToText >= 0)
                {
                    returnValue = indexToText;
                }
            }
        }

        return returnValue;
    } 
```

使用 Button 或 TextChangeListener 并搜索您的单词。

```
private void button1_Click(object sender, EventArgs e)
{
        // Select the first char in your Richtextbox
        richTextBox1.SelectionStart = 0;

        richTextBox1.SelectionLength = richTextBox1.TextLength;
        // Select until the end
        richTextBox1.SelectionColor = Color.Black;
        // Make the Text Color black

        //Use an Inputfield to add the searching word
        var word = txtSearch.Text;
        //verify the minimum length otherwise it may freeze if you dont have text inside
        if (word.Length > 3)
        {
          int s_start = richTextBox1.SelectionStart, startIndex = 0, index;
          while ((index = FindMyText(word, startIndex, richTextBox1.TextLength)) != -1)
            {
            // goes through all possible found words and color them blue (starting index to end)
                richTextBox1.Select(index, word.Length);
                richTextBox1.SelectionColor = Color.Blue;
                startIndex = index + word.Length;
            }
            // Color everything between in color black to highlight only found words       
            richTextBox1.SelectionStart = startIndex;
            richTextBox1.SelectionLength = 0;
            richTextBox1.SelectionColor = Color.Black;
        }
} 
```

我强烈建议设置最小字长以避免冻结和高内存分配。

# r - 动态拆分数据框

> ID：11851913
> 
> 赞同：1
> 
> 时间：2012-08-07T18:29:49.010
> 
> 标签：r, split, dataframe

我想有一个功能来拆分这样的数据帧：

```
q1  q2  q3  q4
1   4   0   33
8   5   33  44
na  na  na  na
na  na  na  na
3   33  2   66
4   2   3   88
6  44   5   99 
```

我们将获得 2 个数据帧：

```
d1
q1  q2  q3  q4
1   4   0   33
8   5   33  44 
```

和

```
d2
3   33  2     66
4   2   3     88
6   44  5     99 
```

d1 和 d2 中的 obs 不固定。这意味着我们不知道数据框中的 obs 以及有多少 obs 是 NA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T18:24:07.823

假设`DF`是数据框。由于没有准确地指定分割标准是什么，我们假设任何带有所有`NA`s 的行都是分割行。如果它的一些其他标准适当地改变了第一行：

```
isNA <- apply(is.na(DF), 1, all)
split(DF[ !isNA, ], cumsum( isNA )[ !isNA ]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T18:11:39.190

首先，读入您的数据，以便将“na”转换为实际`NA`值。

```
mydf <- read.table(
  header = TRUE, 
  na.strings="na", 
  text = "q1 q2 q3 q4
          1 4 0 33
          8 5 33 44
          na na na na
          3 33 2 66
          4 2 3 88
          6 44 5 99") 
```

其次，弄清楚在哪里分割你的`data.frame`：

```
# Find the rows where *all* the values are `NA`
RLE <- rle(rowSums(is.na(mydf)) == ncol(mydf))$lengths
# Use that to create "groups" of rows
RLE2 <- rep(seq_along(RLE), RLE)
# Replace even numbered rows with NA -- we don't want them
RLE2[RLE2 %% 2 == 0] <- NA 
```

三、拆分你的`data.frame`

```
split(mydf, RLE2)
# $`1`
#   q1 q2 q3 q4
# 1  1  4  0 33
# 2  8  5 33 44
# 
# $`3`
#   q1 q2 q3 q4
# 4  3 33  2 66
# 5  4  2  3 88
# 6  6 44  5 99 
```

但是，这一切都有些猜测，因为您所说的“这意味着我们不知道数据框中的 obs 以及有多少 obs 是 NA”并不是很清楚。在这里，我假设您希望在遇到一整行`NA`值时拆分数据。

# java - 在什么情况下你更喜欢没有方法的抽象类？

> ID：11851914
> 
> 赞同：1
> 
> 时间：2012-08-07T18:29:48.933
> 
> 标签：java, oop

我正在浏览一些 Java 代码，我看到很多抽象类，其中不包含任何内容。

例如。像这样的东西 -

```
public abstract class Processor
 {

 } 
```

他们虽然有具体的实现类。在什么情况下这样的抽象类才有意义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:39:53.580

IMO，当您想要创建具有所有子类共有的行为和状态的基类时，抽象类优于接口。我不确定空抽象类是否比接口更有用。通常，标记接口是空的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T18:50:17.720

`Abstract`当您有一些对所有可能的实现类都通用的逻辑时，将使用类。

编写一个`Abstract class`内部没有任何内容并且扩展它的不同类几乎没有用。唯一`difference`的是您可以`handle`对所有具体类使用相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:33:46.270

在一些库中，他们会使用反射来寻找这些标记抽象类的实现。这也是一种通过抽象类名本身为您的代码提供的文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T18:30:30.630

一种情况是，如果您不希望使用`new`关键字实例化您的类，那么您可以将其定义为抽象的。

# java - 按下按钮时，应用程序崩溃

> ID：11851915
> 
> 赞同：0
> 
> 时间：2012-08-07T18:30:07.547
> 
> 标签：java, android

我一直在使用 Android 按钮时遇到问题。我尝试设置一个 onClick 侦听器，但它失败、崩溃并且不打印任何帮助错误消息。这是我的代码：

```
Button button;
button = (Button) findViewById(R.id.button1);
button.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {

        setContentView(R.layout.choose_level);

    }
}); 
```

我试过放入一个 try catch 语句，这样它就不会显示烦人的错误，但按钮仍然不起作用。会不会是因为布局没有加载？或者是别的什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:43:41.873

您必须在调用按钮`setContentView(R.layout.XML_LAYOUT);`之前调用方法。`findViewById`

这里 XML_LAYOUT 必须是包含您的按钮 ID 的布局。

*注意*：- 不建议多次调用*setContentView方法。*如果您想显示不同的布局/屏幕，请将其添加到另一个活动中并在单击按钮时启动该活动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T19:06:47.507

您在按钮 onClick 侦听器中调用 setContentView(R.Layout.XML_LAYOUT) ，因为它应该在 oncreate 方法中

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    /
    Button play = (Button)findViewById(R.id.play);
    play.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            show ur text here

        }
    }); 
```

我想你想要做的是为一个 XML 文件设置视图，这是一些布局文件，我想检查一下充气机和意图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:33:58.073

> 我把它放在一个 try, catch 语句中，这样它就不会出现烦人的错误......

一个`catch`块不会神奇地阻止你的错误*发生*——你不能用它来阻止应用程序“提出恼人的错误”。

当可以从这些情况中恢复时，您可以使用它们来处理错误（例如等待并重试，退回到较慢的替代方案等）

你的 catch 块的实现是什么？如果你只是吞下错误，你的应用程序仍然会失败——只是你没有任何诊断信息来处理它。

你需要回到原来的“恼人的错误”，找出它发生的原因，然后*修复它，*而不是仅仅抑制它的输出。

# java - 带有 Java 谓词的“SELECT INTO”

> ID：11851922
> 
> 赞同：0
> 
> 时间：2012-08-07T18:30:46.773
> 
> 标签：java, jdbc

我正在使用 JDBC-ODBC 桥来处理 Access 数据库。我试图从一个数据库中选择与给定多边形相交的所有多边形，并将它们放在不同数据库的新表中。我想做这样的事情：

```
SELECT * 
INTO Polygons IN targetDB
FROM Polygons
WHERE intersects(givenPolygon, Polygons.SHAPE) 
```

其中 Polygons 是一个多边形表，其中 BLOB（SHAPE 列）表示形状， intersects() 是我在 Java 中的一个谓词，它将 BLOB 读入我自己的 Polygon 类并决定形状是否相交。Polygon 表有一个 ID 列，我可以对其进行选择。获得相同效果的有效方法是什么？

编辑：似乎 JDBC-ODBC 不支持跨数据库的 SELECT INTO，需要另一个库（我使用了 jackcess）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T23:36:37.103

我最终使用了[jackcess](http://jackcess.sourceforge.net/)。我使用 JDBC 选择所有内容，然后在数据库之间复制行时使用 jackcess 过滤行。

```
Polygon givenPolygon = getInputPolygon();

// open source and get data with JDBC
Connection c = DriverManager.getConnection(src);
Statement s = c.createStatement();
ResultSet results = s.executeQuery("SELECT * FROM " + table);

// open dest and copy/filter with jackcess
Database destDB = Database.open(dest);
destDB.copyTable(table, results, new ImportFilter() {
    @Override
    public List<Column> filterColumns(List<Column> cols,
                                      ResultSetMetaData metadata)
    throws SQLException, IOException {
        // get all columns
        return cols;
    }

    @Override
    public Object[] filterRow(Object[] row) throws SQLException,
    IOException {
        byte[] blob = row[1]; // or whatever your schema requires
        Polygon p = new Polygon(blob);
        if givenPolygon.intersects(p)
            return row;
        return null;
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T08:41:30.727

来自任何 JDBC 驱动程序的批量插入结果集位于[http://www.hxtt.com/access/advanced.html#insertresultset](http://www.hxtt.com/access/advanced.html#insertresultset)

# mysql - MySQL 查询数据库大小

> ID：11851925
> 
> 赞同：10
> 
> 时间：2012-08-07T18:31:07.603
> 
> 标签：mysql, sql, database, size, storage

是否有可用于确定 MySQL 中数据库大小的查询或函数？如果不是，在 MySQL 中查找数据库大小的典型方法是什么？

我在谷歌上搜索，发现`SELECT CONCAT(sum(ROUND(((DATA_LENGTH + INDEX_LENGTH - DATA_FREE) / 1024 / 1024),2))," MB") AS Size FROM INFORMATION_SCHEMA.TABLES where TABLE_SCHEMA like '%YOUR_DB_NAME%' ;`

它返回一个我知道是 400MB 的数据库`474989023196466.25 MB`！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-07T18:33:56.050

试试这个查询：

```
SELECT table_schema AS "Data Base Name", 
sum( data_length + index_length ) / 1024 / 1024 AS "Data Base Size in MB" 
FROM information_schema.TABLES GROUP BY table_schema ; 
```

或者有了这个，如果你想 ROUND ：

```
SELECT table_schema AS "Data Base Name", 
ROUND(SUM( data_length + index_length ) / 1024 / 1024, 2) AS "Data Base Size in MB" 
FROM information_schema.TABLES GROUP BY table_schema ; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T18:34:43.140

尝试：

```
SELECT table_schema, sum(data_length + index_length) FROM information_schema.TABLES GROUP BY table_schema; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-01T10:35:17.817

```
SELECT table_schema "DB Name", 
       Round(Sum(data_length + index_length) / 1024 / 1024, 1) "DB Size in MB" 
FROM   information_schema.tables 
GROUP  BY table_schema; 
```

# java - 从java中的套接字读取未格式化的数据

> ID：11851926
> 
> 赞同：0
> 
> 时间：2012-08-07T18:31:13.063
> 
> 标签：java

我有一个侦听特定 ip 和端口的服务器套接字应用程序。然后我有客户端套接字，它从服务器读取输入并给出响应。但我的问题是服务器最后没有给出格式化的行终止字符。因此，当我使用缓冲阅读器 readline 方法时，它会挂起。那么我应该如何读取服务器发送的数据。这里的服务器基本上是一个 API（METER）。

这是服务器和客户端之间的示例请求/响应序列。

```
Request: 8/2/2012 3:28:24 PM.60764 (+0.0000 seconds)
 53 0D                                             S.              
Answer: 8/2/2012 3:28:24 PM.87364 (+0.2656 seconds)
 53 50 31 39 35 30 34 37 38 34 0D                  SP19504784\.     
Request: 8/2/2012 3:28:24 PM.92064 (+0.0000 seconds)
 53 48 0D                                          SH.             
Answer: 8/2/2012 3:28:24 PM.02964 (+0.1094 seconds)
 53 48 0D                                          SH.             
Request: 8/2/2012 3:28:24 PM.02964 (+0.0000 seconds)
 53 0D                                             S.              
Answer: 8/2/2012 3:28:24 PM.13964 (+0.1094 seconds)
 53 50 31 39 35 30 34 37 38 34 0D                  SP19504784\.     
Request: 8/2/2012 3:28:24 PM.20164 (+0.0000 seconds)
 53 48 0D                                          SH.             
Answer: 8/2/2012 3:28:24 PM.31164 (+0.1094 seconds)
 53 48 0D                                          SH.             
Request: 8/2/2012 3:28:24 PM.31164 (+0.0000 seconds)
 80                                                ?               
Answer: 8/2/2012 3:28:24 PM.46764 (+0.1563 seconds)
 FC                                                ü               
Request: 8/2/2012 3:28:24 PM.46764 (+0.0000 seconds)
 F1                                                ñ               
Answer: 8/2/2012 3:28:25 PM.84264 (+0.3750 seconds)
 8A 31 39 35 30 34 37 38 34 88                     ?19504784?      
Request: 8/2/2012 3:28:25 PM.90464 (+0.0000 seconds)
 F1                                                ñ               
Answer: 8/2/2012 3:28:25 PM.02964 (+0.1250 seconds)
 8A 01 41 32 4D 47 30 31 42 B1                     ?.A2MG01B±      
Request: 8/2/2012 3:28:26 PM.81164 (+0.0000 seconds)
 CA F0 00 00 00 00 00 00 00 3A                     Êð.......:      
Answer: 8/2/2012 3:28:26 PM.02964 (+0.2188 seconds)
 C4 00 05 00 C9 31 36 38 C4 B7 B7 3F 2E C9 74 5A   Ä...É168Ä··?.ÉtZ
 02 00 02 00 FE FC C9 A1 0D 07 00 FB FF FD FC C9   ....þüÉ¡...ûÿýüÉ
 1E 0E FD FF FE FF FD FC C9 B8 FE 4E FF FA 01 FF   ..ýÿþÿýüÉ¸þNÿú.ÿ
 FF B9 D0 F9 F0 3F D0 BF 50 9F                     ÿ¹Ðùð?Ð¿P? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:38:27.097

`readline()`如果服务器不发送行尾，则不能使用。但是，原始协议中的某些内容必须指示响应何时完成。这可以是一项或多项

1.  特定的字符序列
2.  对每个命令（示例中的“请求”）的响应具有已知的固定长度
3.  每个响应都包含嵌入其中的长度，距离开始的固定偏移量

您必须自己进行缓冲并自己检测每条消息的结尾。如果没有对正在使用的协议的详细描述，那么这就是您所期望的那样具体的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:39:53.237

您可以尝试使用 BufferedReader 的一种读取方法，并自己处理数据中的任何中断。这可能是您将拥有的最佳控制权。

# sql - Microsoft Access SQL 语句在比较两个表时查找一个字段的唯一值

> ID：11851929
> 
> 赞同：1
> 
> 时间：2012-08-07T18:31:25.800
> 
> 标签：sql, ms-access

这应该不会太难，但我是 SQL 的初学者。

我有两张表，都有很多字段，但重要的是它们都有一个名为 CODE 的字段。该字段 CODE 有数字，但数据类型为 Text。

表 1 包含“吨”的 CODE 值。表 2 包含“适量”的 CODE 值。需要注意的是，如果在 Table2 中找到了 CODE 值，那么它肯定在 Table1 中。

我想做的是创建一个查询，该查询创建一个表，其中列出了 Table1 中而不是 Table2 中的所有 CODE 值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:36:11.867

```
SELECT Table1.CODE
FROM Table1 
LEFT OUTER JOIN Table2 ON Table1.CODE = Table2.CODE
WHERE Table2.CODE IS NULL 
```

正如所指出的，如果要将其添加到全新的表中，而不是简单地查询结果，请使用`SELECT ... INTO`：

```
SELECT Table1.CODE
INTO Table3
FROM Table1 
LEFT OUTER JOIN Table2 ON Table1.CODE = Table2.CODE
WHERE Table2.CODE IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:37:09.413

```
SELECT 
   t1.code
INTO
   new_table
FROM
   table1 t1
LEFT OUTER JOIN
   table2 t2
ON
   t1.code = t2.code
WHERE 
   t2.code is null 
```

请尝试一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T18:38:29.167

试试这个...编辑所以创建了一个带有值的新表

```
SELECT T1.Code
  INTO new_table
  FROM Table1 T1
 wHERE T1.Code NOT IN (SELECT T2.Code
                         FROM Table1 T2) 
```

你也可以用`LEFT JOIN`，但我更喜欢`NOT IN`

# iphone - 你如何预加载 UIweb 视图？

> ID：11851931
> 
> 赞同：0
> 
> 时间：2012-08-07T18:31:29.280
> 
> 标签：iphone, ios, xcode

我的应用程序当前的加载时间非常糟糕，有没有办法预加载 UIWeb 视图，在将内部 .html 文件加载到 UIwebview 之前，我会一直看到大约 15 秒的白色空白屏幕。

编辑：在下面添加了更多信息：

例如，我目前正在使用：

```
[webView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"Leadership" ofType:@"html"] isDirectory:NO]]]; 
```

所有的 HTML 都是本地的，图片在应用程序中，只有很少的 css 在 html 的标题中。

但是，我不认为是实际的 HTML 显示了白色的 web 视图......我认为应用程序在加载 UIWebView 类时非常慢，因为一旦将 Webview 加载到一个选项卡上，它就会非常快在使用 webview 的其他选项卡上。

# c# - 链接按钮不会触发

> ID：11851935
> 
> 赞同：0
> 
> 时间：2012-08-07T18:31:40.840
> 
> 标签：c#, asp.net

这从[转发器中的链接按钮继续传递会话变量](https://stackoverflow.com/questions/11849539/link-button-in-repeater-to-pass-session-variable)，但是当我尝试单击添加到转发器的链接按钮时没有任何反应。这是我所拥有的

```
<asp:Repeater ID="rptList" runat="server"
    EnableViewState="false"
    OnItemCommand="rptList_ItemCommand"
    DataSourceID="SqlDataSource3">
    <ItemTemplate>
        <div>
        <p>
        <b>Title: </b> <asp:LinkButton ID="lbnCookieVar" CommandName="click" CommandArgument='<%# Eval("Job_Title")%>' Text='<%# Eval("Job_Title")%>' runat="server" /> <br />
        <b>Status: </b><%# Eval("Status")%><br />
        <b>Department: </b><%# Eval("Department")%><br />
        <b>Date Position Available: </b><%# Eval("Date_Position_Available")%><br />
        </p>
        </div>
    </ItemTemplate>
</asp:Repeater> 
```

代码背后：

```
protected void rptList_ItemCommand(object sender, CommandEventArgs e)
{
    if (e.CommandName == "click")
    {
        Session["Data"] = e.CommandArgument.ToString();
        Response.Redirect("default.aspx");
    }
} 
```

我为新帖子道歉，但无论出于何种原因，我都不允许在最后一个帖子上发帖，一直说“不允许用户对此帖子发表评论”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:34:08.610

1 你有错配

CommandText -> 你的 aspx 中的 CommandName

尝试使用此代码

```
 <asp:LinkButton ID="lbnCookieVar" CommandName="click" CommandArgument='<%# Eval("Job_Title")%>' Text='<%# Eval("Job_Title")%>' runat="server" /> <br /> 
```

2 添加`OnItemCommand`中继器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:34:53.397

绑定转发器的代码是什么以及在哪里。在这些情况下，大多数情况下，填充转发器的数据尚未绑定到回发。检查它是。

# iframe - 打开 iframe Colorbox 时出现白色闪烁

> ID：11851937
> 
> 赞同：2
> 
> 时间：2012-08-07T18:31:41.153
> 
> 标签：iframe, colorbox

打开 iframe 颜色框时出现白色闪光。如何防止 iframe 先显示白色背景，然后再显示假定的 iframe？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T22:19:23.890

尝试传入`fastIframe: false`颜色框配置。它使颜色框等到 iframe 的所有内容都加载完毕后再尝试显示任何内容。

```
$('a').colorbox({ iframe: true, fastIframe: false }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T22:09:52.403

白色闪烁是 colorbox 动态生成 iframe 的结果。在加载 iframe 时，您会看到颜色框窗口本身的背景颜色。

解决此问题的一种方法是使用[此 jsfiddle](http://jsfiddle.net/XSzq5/4/embedded/result/)中演示的“黑色”颜色框 css 样式。[下载 colorbox](http://www.jacklmoore.com/colorbox)时，您可以在“示例 3”文件夹中找到此 colorbox.css 文件。使用这种样式，您当然会看到黑色闪光而不是白色闪光，但它与彩盒覆盖层的半透明黑色更好地融合在一起。

或者，您可以自定义最适合您需求的 colorbox.css 文件。有 5 种预建样式，您可以在官方彩盒网站上看到演示。

# applescript - AppleScript 单击确定并从 Firefox 链接保存文件

> ID：11851938
> 
> 赞同：0
> 
> 时间：2012-08-07T18:31:48.780
> 
> 标签：applescript

所以我有一个页面，上面有大约 60 个链接，带有随机 URL，每个链接都需要单独单击和下载。

我正在编写基本脚本以切换到下一个链接，按 Enter，然后单击“确定”下载到桌面。

我是新手，但似乎无法弹出“浮动”窗口，让我击键“返回”或单击“确定”。我希望将文件保存到桌面，但我似乎无法在应用程序中按标题引用窗口，或者猜测索引号或窗口 ID。

任何帮助深表感谢..

我还在脚本编辑器中看到了字典，以及 Firefox 的“窗口”的许多属性，引发了语法和其他错误。

```
tell application "System Events"
tell application "Firefox" to activate
tell window "$thewindowtitle"
    keystroke tab
    delay 1.0
    keystroke return
end tell
tell application "Firefox"
    tell window visible
    click button "OK"
    end tell
end tell
end tell
end tell 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T14:53:54.733

Firefox 似乎不支持运行 JavaScript，但在 Safari 中，您可能会使用这样的脚本来获取所有链接的 URL：

```
set l to {}
tell application "Safari" to tell document 1
    set n to do JavaScript "document.links.length"
    repeat with i from 0 to (n - 1)
        set end of l to (do JavaScript "document.links[" & i & "].href")
    end repeat
end tell
set text item delimiters to linefeed
set the clipboard to l as text 
```

然后在默认浏览器中打开它们：

```
IFS=$'\n' for u in $(pbpaste); do open "$u"; done 
```

或使用卷曲：

```
cd ~/Desktop/; IFS=$'\n'; for u in $(pbpaste); do; curl "$u" -O; done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-01T06:53:10.000

从另一端看这个。在首选项 > Firefox 首选项 > 常规 > 应用程序中，我从询问更改为保存位置，选择 Firefox 处理您下载的文件的方式。它只是拯救了他们。就我而言，我在 Automator 中创建了一个工作流来从 url 下载图像。这对我很有用。

# jquery-ui - 带有包含的 JQuery UI 可拖动图像。如何将图像拖出其父（包含）元素

> ID：11851946
> 
> 赞同：1
> 
> 时间：2012-08-07T18:32:12.167
> 
> 标签：jquery-ui, draggable, droppable

用户上传图片，然后他们将上传的图片拖到页面上的占位符中。他们基本上是在模板网格中设计不同图像的布局。

我已经编写了代码来使用可拖动的图像和可放置的占位符。这使我可以轻松地将图像放入占位符中。一旦图像位于占位符中，就可以移动/拖动图像，以便可以在占位符内看到图像的不同部分。图像（一旦放在占位符中）成为一个新的可拖动对象，受约束，因此用户只能将图像移动到其边缘。

问题是：一旦图像在它们的占位符中，我想将它们从一个占位符拖到另一个占位符。但是因为它们位于将它们剪辑成占位符形状的父元素中，所以并不是那么简单。我最初的想法是：

1.  检测鼠标位置（拖动时）何时在占位符之外 10 像素
2.  克隆图像并将克隆附加到body标签
3.  使克隆的图像跟随鼠标
4.  当用户停止在占位符上拖动（鼠标上移）时，在两个占位符之间交换图像（开始原始拖动的那个和触发鼠标上移的那个）。

沿着这些思路，我写了一些在占位符上使用 mouseup 的东西，并在全局变量中跟踪当前拖动的图像。我在这里有一个例子：http: [//goo.gl/0cXCM](http://goo.gl/0cXCM)

我正在重写该示例，因此我还可以在可能的情况下使用 Jquery UI droppable 将新图像拖到占位符中。可放置的代码比该示例中的代码更容易使用，并且允许我“还原”图像并将其动画回列表，如果它没有放在占位符上。

上面的第 1-3 点很简单，但是因为克隆的图像不是通过实际拖动初始化的真正可拖动的，所以它不会“拖放”到可拖放的占位符上。这就是为什么我最初在没有 droppable 的情况下编写它的原因。

我努力了：

1.  使克隆的图像可拖动并使用触发器在克隆上触发 mousedown/dragstart 事件。（不工作）
2.  在 Stack Overflow 上搜索有关开始拖动的问题，但我发现主要是关于从单击另一个元素开始拖动。我没有点击可以使用。

更多信息：单击鼠标，然后移动并开始拖动占位符中的图像。当鼠标仍然向下并在占位符之外移动 10 px 时，克隆的图像会附加到页面上。在 mousemove 上，克隆图像的位置会更新。一直以来，鼠标仍然向下。唯一可以在删除克隆图像时识别它的（我认为）是占位符上的 mouseup 事件。

有没有更好的方法来让它工作？可以连接克隆的图像以使用一些合理的标准可放置代码吗？

# php - 代码点火器分页

> ID：11851948
> 
> 赞同：0
> 
> 时间：2012-08-07T18:32:14.917
> 
> 标签：php, codeigniter, pagination

我的链接：`http://asdasd.com/*****/****/urunler?kategori=5`

我需要为我的页面添加分页。

我的代码：

```
$config['base_url'] = base_url().'index.php/asd/urunler?kategori='.$kateg;
$config['total_rows'] = $this->anime_model->kategorisayi($kateg);
$config['per_page'] = 3; 
$config['first_link'] = '<a href="#" class="prevposts">Önceki</a>';
$config['last_link'] = '<a href="#" class="nextposts">Sonraki</a>';
$config['cur_tag_open'] = '<a href="#" class="activeposts">';
$config['cur_tag_close'] = '</a>';
$this->pagination->initialize($config); 
```

当我点击分页链接时，页面没有改变。

```
http://asdasd.com/yenianimesatis/index.php/anime/urunler?kategori=5/3 
```

我该如何解决？

**编辑：**当我使用此代码时

```
$config['suffix'] = '/?'.http_build_query($_GET, '', "&"); 
```

第 2 页：`http://asasgs/yenianimesatis/index.php/anime/urunler/5/?kategori=5`，但第 1 页：`http://asgasg/yenianimesatis/index.php/anime/urunler/`

它必须是这样的：`http://asgasg/yenianimesatis/index.php/anime/urunler/?kategori=5`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T12:34:04.847

我不确定我是否明白你的问题。但有两点需要注意：

1) CI 分页将简单地将 /# 添加到您的基本网址的末尾，因此您声称它没有改变的地方 - [http://asdasd.com/yenianimesatis/index.php/anime/urunler?kategori=5](http://asdasd.com/yenianimesatis/index.php/anime/urunler?kategori=5) **/3**，它实际上确实将 /# 添加到末尾。也许您需要将分页 $config['enable_query_strings'] 设置为 TRUE？在此处阅读**enable_query_strings ：** [http](http://codeigniter.com/user_guide/libraries/pagination.html) ://codeigniter.com/user_guide/libraries/pagination.html 。

2) 你说你使用 $config['suffix']，但我不确定它是干什么用的。你的意思是 $config['url_suffix'] 吗？如果是这样，可能有一个错误：[http ://codeigniter.com/forums/viewthread/161875/](http://codeigniter.com/forums/viewthread/161875/)

# android - 更新 Widget 中的 Android ListView

> ID：11851957
> 
> 赞同：3
> 
> 时间：2012-08-07T18:32:33.347
> 
> 标签：android, listview, service, widget

当我尝试更新内容时，我的 App-Widget 出现问题。

小部件看起来像这样：http: [//i.stack.imgur.com/tEGLv.jpg](http://i.stack.imgur.com/tEGLv.jpg)

Widget 由一个 Header (Buttons + TextViews) 和一个 ListView 组成。如果用户按下按钮，ListView 会显示第二天的内容，一切正常。但问题是，如果我尝试从我的应用程序更新小部件或 ListView 不会更新的自动时间段。

这是我的代码。

应用小部件提供者：

```
public class StudyWidgetProvider extends AppWidgetProvider{

private static String BUTTON_BACK = "BUTTON_BACK";
private static String BUTTON_FORWARD = "BUTTON_FORWARD";

@Override
public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {  
    context.startService(new Intent(context, UpdateService.class));
}

@Override
public void onReceive(Context context, Intent intent) {
    super.onReceive(context, intent);
    if(WidgetViewsFactory.currentDate == null){
        WidgetViewsFactory.currentDate = Calendar.getInstance();
    }

    String action = intent.getAction();
    if(action != null){
        if(action.equals(BUTTON_BACK)){
            WidgetViewsFactory.currentDate.add(Calendar.DATE, -1);
        }
        if(action.equals(BUTTON_FORWARD)){
            WidgetViewsFactory.currentDate.add(Calendar.DATE, 1);
        }
    }

    context.startService(new Intent(context, UpdateService.class));
}   
 } 
```

处理 Widget 更新的 UpdateService。

```
 @Override
@Deprecated
public void onStart(Intent intent, int startId) {
    super.onStart(intent, startId);
    Log.i(LOG_TAG, "Update-Service started");

    RemoteViews widget = buildUpdate(this);
    ComponentName thisWidget = new ComponentName(this, StudyWidgetProvider.class);
    AppWidgetManager manager = AppWidgetManager.getInstance(this);

    manager.notifyAppWidgetViewDataChanged(manager.getAppWidgetIds(thisWidget), R.id.words);
    manager.updateAppWidget(thisWidget, widget);

    Log.i(LOG_TAG, "The Content!");
    if(widgetObjects == null){
        Log.i(LOG_TAG, "WidgetObjects sind NULL");
    } else {
        Log.i(LOG_TAG, "WidgetObjects sind NICHT-NULL");

        for(int i=0; i<widgetObjects.size(); i++){
            Log.i(LOG_TAG, "--- " + widgetObjects.get(i).getName());
        }
    }

    Log.i(LOG_TAG, "Update-Service ended");
}

public RemoteViews buildUpdate(Context context){
    RemoteViews retVal = new RemoteViews(context.getPackageName(), R.layout.widget);

    if(WidgetViewsFactory.currentDate == null){
        WidgetViewsFactory.currentDate = Calendar.getInstance();
    }

    AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(context);
    ComponentName thisAppWidget = new ComponentName(context.getPackageName(), StudyWidgetProvider.class.getName());
    int[] appWidgetIds = appWidgetManager.getAppWidgetIds(thisAppWidget);

    loadSDCardContent(context, appWidgetManager, appWidgetIds);

    //Setzen des Widget-UIs
    Intent intent = new Intent(context, WidgetService.class);
    intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetIds);
    intent.setData(Uri.parse(intent.toUri(Intent.URI_INTENT_SCHEME)));

    retVal.setRemoteAdapter(R.id.words, intent);

    SimpleDateFormat dateFormater = new SimpleDateFormat("EEEE");
    retVal.setTextViewText(R.id.widget_day, dateFormater.format(WidgetViewsFactory.currentDate.getTime()));
    dateFormater = new SimpleDateFormat("dd.MM.yyyy");
    retVal.setTextViewText(R.id.widget_date, dateFormater.format(WidgetViewsFactory.currentDate.getTime()));

    //Button-Actions
    Intent backIntent = new Intent(context, StudyWidgetProvider.class);
    backIntent.setAction(BUTTON_BACK);
    Intent forwardIntent = new Intent(context, StudyWidgetProvider.class);
    forwardIntent.setAction(BUTTON_FORWARD);
    PendingIntent backPendingIntent = PendingIntent.getBroadcast(context, 0, backIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    PendingIntent forwardPendingIntent = PendingIntent.getBroadcast(context, 0, forwardIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    retVal.setOnClickPendingIntent(R.id.widget_but_back, backPendingIntent);
    retVal.setOnClickPendingIntent(R.id.widget_but_forward, forwardPendingIntent);

    Intent clickIntent = new Intent(context, WidgetActivity.class);
    PendingIntent clickPI=PendingIntent.getActivity(context, 0, clickIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    retVal.setPendingIntentTemplate(R.id.words, clickPI);

    return retVal;
} 
```

下面是我如何从我的应用程序更新小部件：

```
public RemoteViews buildUpdate(Context context){
    RemoteViews retVal = new RemoteViews(context.getPackageName(), R.layout.widget);

    if(WidgetViewsFactory.currentDate == null){
        WidgetViewsFactory.currentDate = Calendar.getInstance();
    }

    AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(context);
    ComponentName thisAppWidget = new ComponentName(context.getPackageName(), StudyWidgetProvider.class.getName());
    int[] appWidgetIds = appWidgetManager.getAppWidgetIds(thisAppWidget);

    loadSDCardContent(context, appWidgetManager, appWidgetIds);

    //Setzen des Widget-UIs
    Intent intent = new Intent(context, WidgetService.class);
    intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetIds);
    intent.setData(Uri.parse(intent.toUri(Intent.URI_INTENT_SCHEME)));

    retVal.setRemoteAdapter(R.id.words, intent);

    SimpleDateFormat dateFormater = new SimpleDateFormat("EEEE");
    retVal.setTextViewText(R.id.widget_day, dateFormater.format(WidgetViewsFactory.currentDate.getTime()));
    dateFormater = new SimpleDateFormat("dd.MM.yyyy");
    retVal.setTextViewText(R.id.widget_date, dateFormater.format(WidgetViewsFactory.currentDate.getTime()));

    //Button-Actions
    Intent backIntent = new Intent(context, StudyWidgetProvider.class);
    backIntent.setAction(BUTTON_BACK);
    Intent forwardIntent = new Intent(context, StudyWidgetProvider.class);
    forwardIntent.setAction(BUTTON_FORWARD);
    PendingIntent backPendingIntent = PendingIntent.getBroadcast(context, 0, backIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    PendingIntent forwardPendingIntent = PendingIntent.getBroadcast(context, 0, forwardIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    retVal.setOnClickPendingIntent(R.id.widget_but_back, backPendingIntent);
    retVal.setOnClickPendingIntent(R.id.widget_but_forward, forwardPendingIntent);

    Intent clickIntent = new Intent(context, WidgetActivity.class);
    PendingIntent clickPI=PendingIntent.getActivity(context, 0, clickIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    retVal.setPendingIntentTemplate(R.id.words, clickPI);

    return retVal;
} 
```

奇怪的是，当我按下小部件的按钮时，一切都按我的意愿工作。我的列表视图的 onDatasetChanged 方法被调用并且内容正在改变，但是如果我从我的应用程序中尝试这个，没有任何反应

我希望你们中的某个人知道为什么这不起作用。我现在坚持了2天，我不知道......

感谢您的帮助！

**编辑** 我发现这不适用于我的设备（带有 miui v4 的 htc），而是在模拟器上。

**编辑 2** 我在我的设备上安装了 Android 4（带有 Sense 4），之后它也可以工作了。看起来 MIUI 是问题所在。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T02:53:37.920

我要解决这个问题，因为我遇到了同样的问题并找到了解决方案。

```
 manager.notifyAppWidgetViewDataChanged 
```

这将调用 RemoteViewsFactory 中的 onDataSetChanged()。添加调用以在该方法中构建您的视图。这解决了我所有的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T19:08:57.587

仅通过广播与小部件通信。不要这样直接调用。如果需要，使用stickyBroadcasts。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-04T08:40:22.397

这有效

```
 @Override
public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
    super.onUpdate(context, appWidgetManager, appWidgetIds);
    for (int widgetId : appWidgetIds) {
        RemoteViews mView = initViews(context, appWidgetManager, widgetId);
        appWidgetManager.updateAppWidget(widgetId, mView);
    }

    super.onUpdate(context, appWidgetManager, appWidgetIds);
}

@SuppressWarnings("deprecation")
@SuppressLint("NewApi")
private RemoteViews initViews(Context context,
                              AppWidgetManager widgetManager, int widgetId) {

    RemoteViews mView = new RemoteViews(context.getPackageName(),
            R.layout.widget_layout);

    Intent intent = new Intent(context, WidgetService.class);
    intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, widgetId);

    intent.setData(Uri.parse(intent.toUri(Intent.URI_INTENT_SCHEME)));
    mView.setRemoteAdapter(widgetId, R.id.widgetCollectionList, intent);

    return mView;
} 
```

# javascript - Safari 6 调试控制台慢

> ID：11851959
> 
> 赞同：3
> 
> 时间：2012-08-07T18:32:39.893
> 
> 标签：javascript, safari

我最近更新到 Mountain Lion 和 Safari 6.0。我正在开发一个 javascript 项目并将信息写入控制台。自从搬家后，响应时间变得非常慢。现在将消息写入控制台至少需要几秒钟。Safari 5 或最新版 Chrome 中的相同应用程序几乎实时显示。关于解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T03:43:25.863

我在 Safari 版本 6.0 (7536.25) 中进行调试，打印到控制台非常慢。很抱歉这么说，但让我想起了我在 IE6 应用程序中安装 firebug lite 的日子。

无论如何，你会很高兴知道你可以在这里构建 webkit：http: [//nightly.webkit.org](http://nightly.webkit.org)

一旦我获得了最新版本的 webkit，我就能够获得与 Safari 5 中相同的调试器。要获得它，请单击“开发”->“使用 WebKit Web Inspector”。

[http://screencast.com/t/db3v9EpbeN](http://screencast.com/t/db3v9EpbeN)

回归常态！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T21:38:45.197

Lion 上的 Safari 6.0 占用了大量的真实和虚拟内存，并减慢了我的 MacBook Air 第 2 代上的所有内容。我想知道精简版浏览器的概念发生了什么。

# android - 首选项更改后刷新片段

> ID：11851962
> 
> 赞同：2
> 
> 时间：2012-08-07T18:32:57.067
> 
> 标签：android, android-fragments

我在一个 Fragment 中有一个 ViewPager，它包含三个我们称为 V1、V2 和 V3 的 Fragment。此外，在 ActionBar 中有一个将用户发送到 SharedPreferencesActivity 的按钮。

该活动仅包含两个选项，一个 IP 和一个端口。我想控制是否实际指定了首选项，一些控件将在 V1、V2 和 V3 上启用，但如果不是，它们将保持禁用状态。

我怎样才能做到这一点？现在我检查了这个，`onCreateView()`但是如果用户写一个 IP/主机和一个端口，当他们按下并返回到带有 PageViewer 的主片段时，我该怎么做，它的嵌入片段重新检查这个首选项并表现得很好？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T18:37:26.457

将启用/禁用这些控件的代码移到它自己的方法中，然后在 onCreateView() 和 onResume() 中调用该方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:38:10.467

尝试将代码放入`onResume()`. 从开发者的页面关于`Fragments`：

> **onCreateView():**
> 
> 当片段第一次绘制其用户界面时，系统会调用它。要为您的 Fragment 绘制 UI，您必须从此方法返回一个 View，它是 Fragment 布局的根。如果片段不提供 UI，您可以返回 null。

如果您只是从另一个窗口返回 Fragment，那么在`onResume()`.

更多信息：http: [//developer.android.com/guide/components/fragments.html#Lifecycle](http://developer.android.com/guide/components/fragments.html#Lifecycle)

# jquery - 使用 jquery 更新表格布局

> ID：11851963
> 
> 赞同：0
> 
> 时间：2012-08-07T18:32:57.190
> 
> 标签：jquery, html

我有一个部分将助教列为下拉列表，其他输入字段很少：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<dynamic>" %>

<%@ Import Namespace="Student.Models" %>

<div>
<table>
        <tr>
            <th>
                Teaching Assistant
            </th>
            <th>
                Course ID
            </th>
            <th>
                Day
            </th>
            <th>
                Delete Row
            </th>
        </tr>
</table>
</div>

<div>
<table id="StudentAction">
        <tr>
            <td>
                <select>
                  <option value="TA1">TA1</option>
                  <option value="TA2">TA2</option>
                  <option value="TA3">TA3</option>
                  <option value="TA4">TA4</option>
                  <option value="TA5">TA5</option>
                  <option value="TA6">TA6</option>
                </select>
            </td>
            <td>
                <select>
                  <option value="Course1">Course1</option>
                  <option value="Course2">Course2</option>
                  <option value="Course3">Course3</option>
                  <option value="Course4">Course4</option>
                  <option value="Course5">Course5</option>
                  <option value="Course6">Course6</option>
                </select>
            </td>
            <td>
                <select>
                  <option value="Monday">Monday</option>
                  <option value="Tuesday">Tuesday</option>
                  <option value="Wednesday">Wednesday</option>
                  <option value="Thursday">Thursday</option>
                  <option value="Friday">Friday</option>
                </select>
            </td>
             <td>
            <input id="delete" name="delete" type="image" src="/Content/delete.png"/>
            </td>
        </tr>

</table>
</div> 
```

每次选择 TA、Course 和 Day 时，都会使用 jquery 插入一个新行：

```
 var clone = $("#StudentAction tr:first").clone();
    $("#StudentAction tr").first().after(clone); 
```

单击事件处理程序：

```
 $('input[name="delete"]').click(function () {

        $(this).remove();

    }); 
```

编辑主视图：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<dynamic>" %>
<%@ Import Namespace="Student.Models" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    Test Form
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

<div class="StudentInfo">
<table>
<tr>
    <th>Student Id</th>
    <td><input type="text" name="StudentId" id="StudentId"/></td>
</tr>
<tr>
    <th>Student Type</th>
    <td><select name="StudentType" id="StudentType"></select></td>
</tr>
</table>

<div class="TeachingAssistant">
<% Html.RenderPartial("TeachingAssistant",(object)Model); %>
</div>

<br/><br/>

<input type="button" id="SaveStudent" name="SaveStudent" value="Save Student" />
</div>

</asp:Content> 
```

现在，当用户单击删除图像时，我想从显示中删除该特定行。我怎样才能做到这一点？

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:35:18.703

你可以试试这个：

```
$('#delete').click(function () {
    $(this).parent().remove();
}); 
```

# exception - ARM7 TDMI未定义指令异常手动生成

> ID：11851976
> 
> 赞同：1
> 
> 时间：2012-08-07T18:33:53.663
> 
> 标签：exception, exception-handling, arm, opcode

我正在尝试测试一些在 ARM7 TDMI 处理器上运行的异常处理代码。我想手动创建一个指令操作码，它将生成“未定义指令”异常。到目前为止，我已经这样做了：

```
void createUndefinedException()
{    
    static const int instr = 0x26889912; // bad opcode
    ((void(*)(void))instr)();
} 
```

我之所以看到上面的操作码，是因为我今天在网上找到了一个[参考页面](http://www.wss.co.uk/pinknoise/ARMinstrs/ARMinstrs.html)，该页面在最底部讨论了未定义的指令操作码。

上面的代码生成了预取中止异常，而不是未定义的指令异常。

任何人都知道如何轻松创建它？

我只是想验证我对这个异常的处理是否能够正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:51:27.383

创建一个asm文件

```
.globl test_function
test_function:
.word 0x26889912
bx lr 
```

组装它

```
arm-none-linux-gnueabi-as fun.s -o fun.o 
```

从你的 C 代码中调用它

```
extern void test_function ( void );

...

test_function(); 
```

然后将其添加到您要链接的对象列表中

```
arm-none-linux-gnueabi-gcc myprogram.c fun.o -o myprogram 
```

并运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-05T20:14:58.333

您需要根据 int 的地址创建一个函数：

```
typedef void (*Exception)(void)
static unsigned long illegalOpcode=0x26889912;
Exception e=(Exception)&illegalOpcode;
e(); 
```

# linq - 使用具有由其他方法创建的子对象的实体从 RIA 服务调用查询

> ID：11851980
> 
> 赞同：1
> 
> 时间：2012-08-07T18:34:04.390
> 
> 标签：linq, entity-framework, wcf-ria-services

我有这段代码不起作用，因为 Entity Framework 无法识别该`CreateItemDC`方法。 是为给定实体`CreateItemDC`创建数据契约的模块化私有方法。`Item`每当我需要返回项目数据合同时，我会在整个服务中使用`CreateItemDC`所有功能，但我不能在这里使用它。我可以实现`ProjectItems`数组或可枚举的序列，因为我必须对`ProjectItem`数据库中的所有实体执行此操作，因为查询条件是在客户端上指定的，而我在这里无权访问它。我在这里有更好的选择吗？似乎 RIA 服务不值得麻烦。我真的希望我在这个项目中使用了普通的 WCF。

```
 [Query]
    public IQueryable<ProjectItemDC> GetProjectItems()
    {
        return from projectItem in ObjectContext.ProjectItems
               select new ProjectItemDC
               {
                   ID = projectItem.ID,
                   LibraryItem = CreateItemDC(projectItem.LibraryItem),
                   LibraryItemID = projectItem.LibraryItemID,
                   ProjectID = projectItem.ProjectID,
                   Quantity = projectItem.Quantity,
                   Width = projectItem.Width,
                   Height = projectItem.Height,
                   Depth = projectItem.Depth,
                   SheetMaterialID = projectItem.SheetMaterialID,
                   BandingMaterialID = projectItem.BandingMaterialID,
                   MaterialVolume = projectItem.MaterialVolume,
                   MaterialWeight = projectItem.MaterialWeight
               };
    } 
```

PS 我确实喜欢 LINQ 和 EF。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T10:58:56.510

好吧，如果你想使用普通的 WCF，你可以，没问题，只需将代码更改为

```
[Query(IsComposable=false)]
public IEnumerable<ProjectItemDC> GetProjectItems(string myParm1, string myParm2) 
    { 
        return from projectItem in ObjectContext.ProjectItems 
               select new ProjectItemDC 
               { 
                   ID = projectItem.ID, 
                   LibraryItem = CreateItemDC(projectItem.LibraryItem), 
                   LibraryItemID = projectItem.LibraryItemID, 
                   ProjectID = projectItem.ProjectID, 
                   Quantity = projectItem.Quantity, 
                   Width = projectItem.Width, 
                   Height = projectItem.Height, 
                   Depth = projectItem.Depth, 
                   SheetMaterialID = projectItem.SheetMaterialID, 
                   BandingMaterialID = projectItem.BandingMaterialID, 
                   MaterialVolume = projectItem.MaterialVolume, 
                   MaterialWeight = projectItem.MaterialWeight 
               }.ToArray(); 
    } 
```

编写你自己的过滤/排序逻辑，你就完成了。是的，您已经失去了 WCF Ria 服务动态查询功能，但这几乎就是您使用普通的旧 WCF 所获得的，不是吗？

如果您需要 WCF Ria 动态排序/过滤/分组，则必须采取一些额外的步骤，包括访问 WCF Ria 服务为您创建的表达式。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:31:21.903

您可以调用`ToArray()`反对`ObjectContext.ProjectItems`以强制 EF 加载所有项目，但是，您的查询将不再可在客户端上组合。

```
[Query]
public IQueryable<ProjectItemDC> GetProjectItems()
{
    return from projectItem in ObjectContext.ProjectItems.ToArray()
           select new ProjectItemDC
           {
               ID = projectItem.ID,
               LibraryItem = CreateItemDC(projectItem.LibraryItem),
               LibraryItemID = projectItem.LibraryItemID,
               ProjectID = projectItem.ProjectID,
               Quantity = projectItem.Quantity,
               Width = projectItem.Width,
               Height = projectItem.Height,
               Depth = projectItem.Depth,
               SheetMaterialID = projectItem.SheetMaterialID,
               BandingMaterialID = projectItem.BandingMaterialID,
               MaterialVolume = projectItem.MaterialVolume,
               MaterialWeight = projectItem.MaterialWeight
           };
} 
```

**编辑：**

正如您在评论中提到的，它一次将所有数据从数据库中取出，这并不理想。为了`LibraryItem`使用您的私有方法创建，您不能在客户端上编写查询。相反，您应该在查询方法中进行过滤，然后创建数组。

```
[Query]
public IQueryable<ProjectItemDC> GetProjectItems(int id, string filter, object blah)
{
    var projectItems = ObjectContext.ProjectItems.Where(...).ToArray();
    return projectItems.Select(projectItem => new ProjectItemDC{...};
} 
```

# php - 如何在两个字符串之间找到第二个字符串

> ID：11851981
> 
> 赞同：1
> 
> 时间：2012-08-07T18:34:05.683
> 
> 标签：php

我一直在研究从某个网站提取信息的脚本。所述网站从数据库中提取信息并以用户可以轻松阅读的方式显示（像往常一样）。

想象一下它看起来像这样：

**变量**1： 结果 1 变量 2 **：**结果 **2 变量 3：**结果 3

我的脚本所做的是它读取页面的源代码并通过获取两个字符串之间的文本来检索“result1”、“result2”和“result3”。

示例代码：

```
<?php

    function get_string_between($string, $start, $end) {

        $string = " ".$string;
        $ini = strpos($string,$start);
        if ($ini == 0) return "";
        $ini += strlen($start);
        $len = strpos($string,$end,$ini) - $ini;
        return substr($string,$ini,$len);

    }

    function check($url) {

        // usually, $fullstring = file_get_contents($url);
        $fullstring = "<string1>result1</string1><string1>result2</string1><string1>result3</string1>";

        $result = get_string_between($fullstring, "<string1>", "</string1>");

        echo "<b>Result: </b>".$result;

    }

    check("random");    // just to execute the function

?> 
```

如果你想知道为什么我有 check() 函数，那是因为这段代码是更大的一部分，我需要一个在这种情况下有效的解决方案，所以我试图让它保持完美。

现在，我可以很容易地得到“result1”，因为它是第一次出现，但是我怎样才能得到“result2”和“result3”呢？

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:39:31.587

使用正则表达式提取所有匹配项，然后选择您想要的匹配项：

```
function get_string_between($string, $start, $end) 
{
    preg_match_all( '/' . preg_quote( $start, '/') . '(.*?)' . preg_quote( $end, '/') . '/', $string, $matches);
    return $matches[1];
} 
```

正则表达式将捕获`$start`和`$end`变量之间的任何内容。

现在该函数返回一个包含所有结果值的数组，您可以从中选择您想要的：

```
list( $first, $second, $third) = get_string_between( $string,  "<string1>", "</string1>"); 
```

[您可以在此演示](http://viper-7.com/MBiV8k)中看到它的工作原理。

# debugging - 我可以在核心转储文件中使用“反向调试”吗？

> ID：11851991
> 
> 赞同：5
> 
> 时间：2012-08-07T18:34:48.530
> 
> 标签：debugging, gdb, coredump, reverse-debugging

在 GDB 7.0 之后，支持反向调试。

生成核心转储时，我可以使用反向调试命令吗？

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:42:52.550

你不能。核心文件是程序在某个时间点的状态的快照。要在该状态下向后移动，您需要早期的程序状态快照。GDB 可以通过在调试实时程序时保留此历史记录来做到这一点，但此信息不存在于核心文件中。

[有关反向调试如何在 GDB](https://stackoverflow.com/a/1535497/185819)中工作的完整描述，请参阅此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T18:24:18.763

有关反向执行的更深入讨论，请参见[http://jakob.engbloms.se/archives/1547 。](http://jakob.engbloms.se/archives/1547)从根本上说，您需要看到过去才能回到过去，您无法从语义上逆转计算机程序。也就是说，给定一个比 gdb 更强大的逆向系统，您确实可以逆向执行以摆脱程序崩溃甚至系统崩溃。这只是在运行失败案例时应用可逆调试器的问题。

# java - 如何防止杰克逊输出漂亮的打印 JSON？

> ID：11851996
> 
> 赞同：9
> 
> 时间：2012-08-07T18:35:05.113
> 
> 标签：java, json, jackson

我想确保杰克逊生成的 JSON 文件永远不会被打印出来。我是一个正在从事现有项目的初级人员，因此我需要向后工作以找出可以将 JSON 配置为输出为漂亮打印的所有方式。我可以确认项目中有 0 个对 .defaultPrettyPrintingWriter() 的引用，以及对 .setSerializationConfig 的 0 个引用，我相信它们也可以用于启用漂亮的打印。

那么这怎么可能呢？或者，是否有一种可靠的方法来确保 JSON 文件打印不美观？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:44:04.640

根据您使用的 Spring 版本，`MappingJacksonHttpMessageConverte‌​r`应该有一个布尔属性`prettyPrint`，用于在序列化 JSON 时配置打印机。

所以这个 XML 配置应该可以解决问题（如果您使用的是 Spring 3 的最新版本）

```
<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAda‌​pter">
  <property name="messageConverters">
    <list>
      <ref bean="jsonConverter" />
    </list>
  </property>
</bean>

<bean id="jsonConverter" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverte‌​r">
  <property name="supportedMediaTypes" value="application/json" />
  <property name="objectMapper" ref="jacksonObjectMapper" />
  <property name="prettyPrint" value="false" />
</bean> 
```

你可以在 github 上看到[相关的 commit](https://github.com/SpringSource/spring-framework/commit/db289495e546f09b7ad55426001b56f52e67c173)介绍该属性。还有这个类的[主干版本](https://github.com/SpringSource/spring-framework/blob/master/spring-web/src/main/java/org/springframework/http/converter/json/MappingJacksonHttpMessageConverter.java)，包括这个属性。最后，这是与先前提交相关的 Spring Jira 问题[SPR-7201 。](https://jira.springsource.org/browse/SPR-7201)

或者您可以尝试将您的 Jackson 版本更新为更新的版本，其中包括Alexander Ryzhov 提到的`useDefaultPrettyPrinter`和方法`setPrettyPrinter`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-19T08:16:44.363

最优雅的解决方案是将漂亮/非漂亮的开关放入过滤器中，并重用静态配置对象。这可以防止无用的垃圾收集。

```
/**
 * Evaluate the "pretty" query parameter. If given without any value, or with "true": pretty JSON output.
 * E.g. /test?pretty or /test?pretty=true
 * Otherwise output without any formatting.
 *
 * @see https://stackoverflow.com/questions/10532217/jax-rs-json-pretty-output
 */
@Provider
@Produces(MediaType.APPLICATION_JSON)
public class RestPrettyJsonFilter implements ContainerResponseFilter {

  public static final String QUERYPARAM_PRETTY = "pretty";

  private static final IndentingModifier INDENTING_MODIFIER_PRETTY = new IndentingModifier(true);
  private static final IndentingModifier INDENTING_MODIFIER_NOT_PRETTY = new IndentingModifier(false);

  @Override
  public void filter(ContainerRequestContext reqCtx, ContainerResponseContext respCtx) throws IOException {

    boolean pretty = false;

    UriInfo uriInfo = reqCtx.getUriInfo();
    //log.info("prettyFilter: "+uriInfo.getPath());

    MultivaluedMap<String, String> queryParameters = uriInfo.getQueryParameters();
    if(queryParameters.containsKey(QUERYPARAM_PRETTY)) {
      // Pretty query parameter is present
      String prettyParam = queryParameters.getFirst(QUERYPARAM_PRETTY);

      // Pretty is present without any value, or value is set to "true"?
      if (prettyParam == null || "".equals(prettyParam) || "true".equals(prettyParam)) {
        pretty = true;
      }
    }

    // Prevent recreation of objects over and over again
    //ObjectWriterInjector.set(new IndentingModifier(pretty));
    if (pretty) {
      ObjectWriterInjector.set(INDENTING_MODIFIER_PRETTY);
    } else {
      ObjectWriterInjector.set(INDENTING_MODIFIER_NOT_PRETTY);
    }
  }

  /**
   * Used to switch on / off pretty output for each response.
   */
  public static class IndentingModifier extends ObjectWriterModifier {

    private final boolean indent;

    /** Minimal pretty printer is not printing pretty. */
    private final static PrettyPrinter NOT_PRETTY_PRINTER = new com.fasterxml.jackson.core.util.MinimalPrettyPrinter();

    public IndentingModifier(boolean indent) {
      this.indent = indent;
    }

    /* (non-Javadoc)
     * @see com.fasterxml.jackson.jaxrs.cfg.ObjectWriterModifier#modify(com.fasterxml.jackson.jaxrs.cfg.EndpointConfigBase, javax.ws.rs.core.MultivaluedMap, java.lang.Object, com.fasterxml.jackson.databind.ObjectWriter, com.fasterxml.jackson.core.JsonGenerator)
     */
    @Override
    public ObjectWriter modify(EndpointConfigBase<?> endpointConfigBase, MultivaluedMap<String, Object> multivaluedMap, Object o, ObjectWriter objectWriter, JsonGenerator jsonGenerator) throws IOException {
      if(indent) {
        // Pretty
        jsonGenerator.useDefaultPrettyPrinter();
      } else {
        // Not pretty
        jsonGenerator.setPrettyPrinter(NOT_PRETTY_PRINTER);
      }
      return objectWriter;
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T06:31:05.500

不确定您使用的是哪个版本的 Jackson，但在最新版本 (1.9.10) 中，JsonGenerator 的默认行为并不漂亮。打开它的最简单方法是调用`generator.useDefaultPrettyPrinter()`或`generator.setPrettyPrinter(new DefaultPrettyPrinter())`。尝试搜索`useDefaultPrettyPrinter`并`setPrettyPrinter`删除这些语句。