# StackOverflow 问答 11058000-11058999

# python - Python - 对元组列表进行分组和求和

> ID：11058001
> 
> 赞同：12
> 
> 时间：2012-06-15T20:48:38.843
> 
> 标签：python, group-by, list-comprehension

给定以下列表：

```
[
    ('A', '', Decimal('4.0000000000'), 1330, datetime.datetime(2012, 6, 8, 0, 0)),
    ('B', '', Decimal('31.0000000000'), 1330, datetime.datetime(2012, 6, 4, 0, 0)),
    ('AA', 'C', Decimal('31.0000000000'), 1330, datetime.datetime(2012, 5, 31, 0, 0)),
    ('B', '', Decimal('7.0000000000'), 1330, datetime.datetime(2012, 5, 24, 0, 0)),
    ('A', '', Decimal('21.0000000000'), 1330, datetime.datetime(2012, 5, 14, 0, 0))
] 
```

我想按元组中的第一列、第二列、第四列和第五列对这些进行分组，并对第三列求和。对于此示例，我将列命名为 col1、col2、col3、col4、col5。

在 SQL 中，我会做这样的事情：

```
select col1, col2, sum(col3), col4, col5 from my table
group by col1, col2, col4, col5 
```

有没有一种“酷”的方式来做到这一点，或者这一切都是手动循环？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-15T20:54:17.733

你想要[`itertools.groupby`](http://docs.python.org/library/itertools.html#itertools.groupby)。

请注意，`groupby`需要对输入进行排序，因此您可能需要事先执行此操作：

```
keyfunc = lambda t: (t[0], t[1], t[3], t[4])
data.sort(key=keyfunc)
for key, rows in itertools.groupby(data, keyfunc):
    print key, sum(r[2] for r in rows) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-15T20:56:39.563

```
>>> [(x[0:2] + (sum(z[2] for z in y),) + x[2:5]) for (x, y) in
      itertools.groupby(sorted(L, key=operator.itemgetter(0, 1, 3, 4)),
      key=operator.itemgetter(0, 1, 3, 4))]
[
  ('A', '', Decimal('21.0000000000'), 1330, datetime.datetime(2012, 5, 14, 0, 0)),
  ('A', '', Decimal('4.0000000000'), 1330, datetime.datetime(2012, 6, 8, 0, 0)),
  ('AA', 'C', Decimal('31.0000000000'), 1330, datetime.datetime(2012, 5, 31, 0, 0)),
  ('B', '', Decimal('7.0000000000'), 1330, datetime.datetime(2012, 5, 24, 0, 0)),
  ('B', '', Decimal('31.0000000000'), 1330, datetime.datetime(2012, 6, 4, 0, 0))
] 
```

（注意：输出重新格式化）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T21:16:43.033

如果您发现自己经常使用大型数据集执行此操作，您可能想查看[pandas](http://pandas.pydata.org/)库，它有很多很好的工具可以执行此类操作。

# android - Long.parselong 数字格式异常

> ID：11058003
> 
> 赞同：0
> 
> 时间：2012-06-15T20:48:46.100
> 
> 标签：android, sqlite

我在市场上有一个应用程序，并收到一些指向同一行的错误。问题是，我无法确定错误是什么，因为我在模拟器和几部手机中都没有遇到过。我在模拟器中针对 ldpi、mdpi、hdpi 密度以及 2.1 和 4.0.3 进行了测试。我在 2.2、2.3.5 和 4.0.3 的手机上试用过。

这是代码和错误行：

```
 Log.i("REFRESH d1 | d2", d1 + "|" + d2); //null | null

 if ((d1 == null) && (d2 == null))
            {
                String dA = "";
                HotOrNot infod = new HotOrNot(Calllogs.this);
                infod.open();
                Cursor cursorA = infod.getAllTitles_DateLimit1("DESC");
                 if (cursorA.moveToFirst())
                 {
                 do{
                    dA = cursorA.getString(5);
                }while (cursorA.moveToNext());
                }

                d1= dA;
                infod.close();

                 String dB = "";
                HotOrNot infodd = new HotOrNot(Calllogs.this);
                infodd.open();
                Cursor cursorB = infodd.getAllTitles_DateLimit1("ASC");
                if (cursorB.moveToFirst())
                {
                   do{
                    dB = cursorB.getString(5);
                }while (cursorB.moveToNext());
                }

                d2=dB;
                infodd.close();
            }
            else
            {

            }

            Log.i("REFRESH2 d1 | d2", d1 + "|" + d2);  // 1339789896078|1339790132268

                Calendar cal1 = Calendar.getInstance();
                cal1.setTimeInMillis(Long.parseLong(d1)); //NumberFormatException
                cal1.set(cal1.get(Calendar.YEAR), cal1.get(Calendar.MONTH), cal1.get(Calendar.DATE), 0, 0, 0);
                GlobalVars.setD1(String.valueOf(cal1.getTimeInMillis()));

                Calendar cal2 = Calendar.getInstance();
                cal2.setTimeInMillis(Long.parseLong(d2));
                cal2.set(cal2.get(Calendar.YEAR), cal2.get(Calendar.MONTH), cal2.get(Calendar.DATE), 23, 59, 59);
                GlobalVars.setD2(String.valueOf(cal2.getTimeInMillis())); 
```

错误

> java.lang.NumberFormatException：在 java.lang.Long.parseLong(Long.java:337) 在 java.lang.Long.parseLong(Long.java:311) 在 com.b2creative.b2callstats.Calllogs$14.run(Calllogs. java:1416) 在 java.lang.Thread.run(Thread.java:1019)

d1 和 d2 是声明的字符串，并且来自数据库的数据是字符串很好（我将日期存储为字符串（如 longs：1339789896078））。除了用户在呼叫日志中没有呼叫，因此数据库为空之外，我想不出其他原因导致此异常。

也许`long.decode`更好？

我在想可能是用户没有 sdcard，但它在 2 部没有 sd 卡的手机上运行流畅。问题的根源可能是什么？

# vim - 如何使用 vi 保存文件名中带有空格的任何文件？

> ID：11058017
> 
> 赞同：14
> 
> 时间：2012-06-15T20:50:01.433
> 
> 标签：vim

**我主要通过vi**命令从终端使用 vim 。

我想创建并保存一个名为**getting started.txt**的文件（两个单词之间有空格）。我尝试了两种方法：

## 方法#1

```
:sav getting started.txt 
```

但我得到一个错误：*`E172: Only one file name allowed`*

## 方法#2

```
:sav "getting started.txt" 
```

这次我得到了：*`E471: Argument required`*

我怎样才能达到我想要的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-15T20:51:56.253

转义空格字符：

```
:sav getting\ started.txt 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-04-06T21:22:25.343

评论者@ib 提到`fnameescape`，这里是你如何使用它：

1.  输入`:save`和一个空格。
2.  按`Ctrl`-`R`然后`=`进入表情模式。
3.  输入`fnameescape("Your spacey, special character'y file name")`。`Tab`扩展工作，所以你可能可以做`fn``Tab``e``Tab`.
4.  按`Enter`将转义的文件名插入命令行。

海报[iler.ml 建议](http://vim.1045645.n5.nabble.com/How-to-auto-escape-space-in-filename-when-write-td1149064.html)使用一个函数来轻松执行此操作（我稍微修改了他的代码）。把它放在你的*.vimrc*中：

```
" :W and :Save will escape a file name and write it
command! -bang -nargs=* W :call W(<q-bang>, <q-args>) 
command! -bang -nargs=* Save :call Save(<q-bang>, <q-args>) 

function! W(bang, filename) 
    :exe "w".a:bang." ". fnameescape(a:filename) 
endfu 

function! Save(bang, filename) 
    :exe "save".a:bang." ". fnameescape(a:filename) 
endfu 
```

# google-apps-script - 如果该行中的单元格值为 0 或空白，则删除 Google 电子表格中的一行

> ID：11058019
> 
> 赞同：32
> 
> 时间：2012-06-15T20:50:21.077
> 
> 标签：google-apps-script, google-sheets

如果在该行中为“C”列输入的值为 0 或空白，我希望能够删除 Google 电子表格中的整行。有没有我可以编写的简单脚本来完成此操作？谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2015-05-29T08:41:42.053

我可以在不使用脚本的情况下提出一个简单的解决方案！

假设您要删除 C 列中带有空文本的行。对工作表中的 C 列中的数据进行排序（数据菜单 -> 按 C 列排序，A-> Z），因此所有空文本行将一起可用.

只需选择这些行并右键单击 -> 删除行。然后你可以根据你需要的列重新排序你的数据。完毕。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-11-16T04:35:36.183

```
function onEdit(e) {
  //Logger.log(JSON.stringify(e)); 
  //{"source":{},"range":{"rowStart":1,"rowEnd":1,"columnEnd":1,"columnStart":1},"value":"1","user":{"email":"","nickname":""},"authMode":{}}
  try {
    var ss = e.source; // Just pull the spreadsheet object from the one already being passed to onEdit
    var s = ss.getActiveSheet();

    // Conditions are by sheet and a single cell in a certain column
    if (s.getName() == 'Sheet1' &&  // change to your own 
        e.range.columnStart == 3 && e.range.columnEnd == 3 &&  // only look at edits happening in col C which is 3
        e.range.rowStart == e.range.rowEnd ) {  // only look at single row edits which will equal a single cell
      checkCellValue(e); 
    }
  } catch (error) { Logger.log(error); }
};

function checkCellValue(e) {
  if ( !e.value || e.value == 0) {  // Delete if value is zero or empty
    e.source.getActiveSheet().deleteRow(e.range.rowStart);
  }
} 
```

这现在只查看单个单元格编辑中的值，而不是整个工作表中的值。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-03-11T20:31:55.660

我编写了这个脚本来为我的一个 Google 电子表格做同样的事情。我希望能够在所有数据都在电子表格中之后运行脚本，所以我让脚本添加了一个菜单选项来运行脚本。

```
/**
 * Deletes rows in the active spreadsheet that contain 0 or
 * a blank valuein column "C". 
 * For more information on using the Spreadsheet API, see
 * https://developers.google.com/apps-script/service_spreadsheet
 */
function readRows() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var rows = sheet.getDataRange();
  var numRows = rows.getNumRows();
  var values = rows.getValues();

  var rowsDeleted = 0;
  for (var i = 0; i <= numRows - 1; i++) {
    var row = values[i];
    if (row[2] == 0 || row[2] == '') {
      sheet.deleteRow((parseInt(i)+1) - rowsDeleted);
      rowsDeleted++;
    }
  }
};

/**
 * Adds a custom menu to the active spreadsheet, containing a single menu item
 * for invoking the readRows() function specified above.
 * The onOpen() function, when defined, is automatically invoked whenever the
 * spreadsheet is opened.
 * For more information on using the Spreadsheet API, see
 * https://developers.google.com/apps-script/service_spreadsheet
 */
function onOpen() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet();
  var entries = [{
    name : "Remove rows where column C is 0 or blank",
    functionName : "readRows"
  }];
  sheet.addMenu("Script Center Menu", entries);
}; 
```

* * *

# 之前测试电子表格：

![在此处输入图像描述](../Images/0d87181cbd0862910cd143cceddbead7.png)

# 从菜单运行脚本：

![在此处输入图像描述](../Images/da8854fb67734785426a184748a394d3.png)

# 运行脚本后：

![在此处输入图像描述](../Images/a38ae755cb4ca311346ada28fcf68b48.png)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-06-28T16:37:53.187

我在使用脚本时遇到了一些问题，所以我的解决方法是使用“过滤器”工具。

1.  选择所有电子表格数据
2.  单击过滤器工具图标（看起来像酒杯）
3.  单击要搜索的列的第一个单元格中的新可用过滤器图标。
4.  选择“按条件过滤”>设置条件（我使用的是“文本包含”>“单词”）

这将留下包含您搜索的单词的行，并且可以通过在按住 shift 键 > 右键单击​​ > 删除行的同时批量选择它们来删除它们。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-30T15:45:11.513

这就是我设法完成的工作。您可以看到我在工作表中向后循环，以便在删除一行时不会跳过下一行。我希望这对某人有所帮助。

```
 function UpdateLog() {

  var returnSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('RetLog');
  var rowCount = returnSheet.getLastRow();

  for (i = rowCount; i > 0; i--) {
    var rrCell = 'G' + i;
    var cell = returnSheet.getRange(rrCell).getValue();
    if (cell > 0 ){
      logSheet.
      returnSheet.deleteRow(i);
    }
  }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-04-29T14:36:46.987

有一个更简单的方法：

1.  使用[过滤](https://support.google.com/docs/answer/3540681?hl=en)仅显示要删除的行。例如，我要删除行的列上有类别，A，B，C。通过过滤界面，我只选择了要删除的A和B。
2.  选择所有行并删除它们。在我的示例中，这样做有效地选择了所有 A 行和 B 行并将它们删除；现在我的电子表格没有显示任何行。
3.  关闭过滤器。这会取消隐藏我的 C 行。完毕！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-11-15T21:52:27.907

很简单的要求。尝试这个 ：

```
 function try_It(){
 deleteRow(2); //// choose col = 2 for column C
 }

 function deleteRow(col){ // col is the index of the column to check for 0 or empty
 var sh = SpreadsheetApp.getActiveSheet();
 var data = sh.getDataRange().getValues();
 var targetData = new Array();
 for(n=0;n<data.length;++n){
 if(data[n][col]!='' && data[n][col]!=0){ targetData.push(data[n])};
 }
 Logger.log(targetData);
 sh.getDataRange().clear();
 sh.getRange(1,1,targetData.length,targetData[0].length).setValues(targetData);
 } 
```

**编辑**：*重新阅读问题我不确定问题是在编辑功能上要求“实时”还是在输入数据后应用功能（如上）......这对我来说不是很清楚。 ..因此，如有必要，请随时更准确；）*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-16T19:49:57.407

仔细阅读你的问题，我想出了这个解决方案：

```
function onOpen() {
  // get active spreadsheet
  var ss = SpreadsheetApp.getActiveSpreadsheet();

  // create menu
  var menu = [{name: "Evaluate Column C", functionName: "deleteRow"}];

  // add to menu
  ss.addMenu("Check", menu);
}

function deleteRow() {
  // get active spreadsheet
  var ss = SpreadsheetApp.getActiveSpreadsheet();

  // get active/selected row
  var activeRow = ss.getActiveRange().getRowIndex();

  // get content column C
  var columnC = ss.getRange("C"+activeRow).getValue();

  // evaluate whether content is blank or 0 (null)
  if (columnC == '' || columnC == 0) {
    ss.deleteRow(parseInt(activeRow));
  }
} 
```

此脚本将在文件加载时创建一个菜单，并使您能够根据 C 列中设置的标准删除一行，或者**不**删除。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-26T16:30:44.560

有一种简短的方法可以解决这个问题，而不是脚本。选择整个数据>转到菜单>单击数据选项卡>选择创建过滤器>单击列标题旁边的过滤器>将出现弹出窗口，然后检查要删除的值>单击确定并将过滤后的数据复制到不同的工作表>完成

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-22T21:50:16.870

这个简单的代码为我完成了这项工作！

```
 function myFunction() {

      var ss = SpreadsheetApp.getActiveSpreadsheet();  // get active spreadsheet

      var activeRow = ss.getActiveRange().getRowIndex();  // get active/selected row

var start=1;
var end=650;
var match='';
var match2=0;   //Edit this according to your choice.

     for (var i = start; i <= end; i++) {
      var columnC = ss.getRange("C"+i).getValue();
      if (columnC ==match  || columnC ==match2){ ss.deleteRow(i); }
     }
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-09-19T07:18:12.757

下面的代码能够在特定列 G 中删除包含今天之前 50 多天的日期的行，将这些行值移动到备份表并从源表中删除行。

该代码更好，因为它一次删除行而不是一一删除。运行得更快。

它不会像一些建议的解决方案那样复制回值（通过推入数组并复制回工作表）。如果我遵循这个逻辑，我就会丢失这些单元格中包含的公式。

我每天晚上（预定）运行该功能，当时没有人使用该表。

```
function delete_old(){
  //delete > 50 day old records and copy to backup
  //run daily from owner login
  var ss = SpreadsheetApp.getActiveSpreadsheet();  
  var bill = ss.getSheetByName("Allotted");
  var backss = SpreadsheetApp.openById("..."); //backup spreadsheet
  var bill2 = backss.getSheetByName("Allotted");
  var today=new Date();
  //process allotted sheet (bills)
  bill.getRange(1, 1, bill.getMaxRows(), bill.getMaxColumns()).activate();
  ss.getActiveRange().offset(1, 0, ss.getActiveRange().getNumRows() - 1).sort({column: 7, ascending: true});
  var data = bill.getDataRange().getValues();
  var delData = new Array();
  for(n=data.length-1; n>1; n--){
    if(data[n][6] !=="" &&  data[n][6]  < today.getTime()-(50*24*3600*1000) ){  //change the condition as per your situation
      delData.push(data[n]);
    }//if
   }//for
   //get first and last row no to be deleted
   for(n=1;n<data.length; n++){
    if(data[n][6] !=="" &&  data[n][6]  < today.getTime()-(50*24*3600*1000) ){ 
      var strow=n+1 ; //first row
      break
    }//if
   }//for
   for(n=data.length-1; n>1; n--){
    if(data[n][6] !=="" &&  data[n][6]  < today.getTime()-(50*24*3600*1000) ){ 
      var ltrow=n+1 ; //last row
      break
    }//if
   }//for
   var bill2lr=bill2.getLastRow();
   bill2.getRange((bill2lr+1),1,delData.length,delData[0].length).setValues(delData);
   bill.deleteRows(strow, 1+ltrow-strow);
   bill.getRange(1, 1, bill.getMaxRows(), bill.getMaxColumns()).activate();
   ss.getActiveRange().offset(1, 0, ss.getActiveRange().getNumRows() - 1).sort({column: 6, ascending: true}); //get back ordinal sorting order as per column F
}//function 
```

# javascript - 加载时无法检测选择/下拉列表选择事件

> ID：11058021
> 
> 赞同：1
> 
> 时间：2012-06-15T20:50:54.677
> 
> 标签：javascript, razor, jquery

每当用户从下拉菜单中选择某些内容时，我都想捕获所选项目并执行某些操作：

```
$("#user-list").live("change", function() {
    var selecteduser = $(this).find(":selected").text();

    ....do something with the selected user
   }); 
```

伟大的！这行得通！但是，有时我想加载页面，其中一个已预选为预选列表项的项目作为模型的一部分传入：

```
@model RoleUsers

@Html.DropDownListFor(model => model.SelecteUserId, Model.Users) 
```

不幸的是，更改事件不会触发。

我有一种感觉，我错过了一个不同的事件......

当在页面加载时而不是用户选择列表项时，如何激活我的操作？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T20:51:49.097

准备好文件后，只需触发`change()`

```
$(function() { $("#user-list").change(); }); 
```

PS，`live()`已弃用，考虑使用[`on()`](http://api.jquery.com/on/)

# elasticsearch - 在弹性搜索结果中获取每页的第一个结果

> ID：11058022
> 
> 赞同：0
> 
> 时间：2012-06-15T20:50:56.470
> 
> 标签：elasticsearch, tire

我想在搜索中取回每个页面的第一个结果的标题，以便我可以在分页 ui 上显示它们。有没有一种简单的方法可以用 ElasticSearch 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T00:40:10.037

您可以进行搜索`"fields" : []`以检索所有匹配文档 ID 的列表 [1]，然后执行多重获取请求以检索文档，包括显示它们所需的任何信息 [2]。

1.  [http://www.elasticsearch.org/guide/reference/api/search/fields.html](http://www.elasticsearch.org/guide/reference/api/search/fields.html)
2.  [http://www.elasticsearch.org/guide/reference/api/multi-get.html](http://www.elasticsearch.org/guide/reference/api/multi-get.html)

# linq - GroupBy 丢失 ThenBy 排序顺序

> ID：11058023
> 
> 赞同：1
> 
> 时间：2012-06-15T20:51:02.650
> 
> 标签：linq, linq-to-entities

如何构建将保留 ThenBy 顺序的表达式？下面的表达式生成按 Bowler.Number 排序的组，但每个组的匹配项未排序。

```
public class Match
{
   public int Id { get; set; }
   public virtual Bowler Bowler { get; set; }
   public byte GameNumber { get; set; }
   public int Score { get; set; }
   ...
}

public class Bowler
{
   public int Id { get; set; }
   public int Number { get; set;}
   ...
}

var GroupedMatches = db.Matches.OrderBy(m=>m.Bowler.Number).ThenBy(m=>m.GameNumber).GroupBy(m => m.Bowler.Number) 
```

这是我想要的输出：

```
1
  game1 295
  game2 199
  game3 202
  game4 178
2
  game1 177
  ... 
```

目前我使用两个 foreach 之类的

```
foreach (var item in TheGroups){
    ... do some stuff with the Group
    foreach (var x in item.OrderBy(a =>a.Number)) { //<-- can I get rid of this OrderBy?
    ... do some stuff with the Matches in this group
   }
} 
```

没什么大不了的，我只是认为 LINQ 能够在构建组时帮助我对组中的匹配项进行排序，而不是稍后在我处理它们时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:10:00.493

我不确定您希望输出是什么，因为按游戏编号排序键入保龄球号码的组列表有点不合情理。

假设您想要一个有序的投球手号码列表，每个号码都包含一个有序的游戏列表，这样的事情可能会起作用

```
var GroupedMatches = db.Matches
    .GroupBy(m => m.Bowler.Number)
    .OrderBy(g => g.Key)
    .Select (g => new 
            { 
                BowlerNumber = g.Key, 
                Matches = g.OrderBy(m => m.GameNumber).ToList() 
            }); 
```

以下是您获得所需输出的具体方法

```
foreach(var group in GroupedMatches) {
    Console.WriteLine(group.BowlerNumber);
    foreach(var match in group.Matches) {
        Console.WriteLine("game{0} {1}", match.GameNumber, match.Score);
    }
} 
```

# apache - seo 自定义域

> ID：11058024
> 
> 赞同：0
> 
> 时间：2012-06-15T20:51:08.017
> 
> 标签：apache, dns

我正在尝试执行以下操作：

我有像 apartments.com 这样的网站。

有时，我想扩展到不同的城市，因此出于 SEO 的目的，我可能会为波士顿和纽约的公寓创建一个单独的域，例如 bostonapartments.com 或 newyorkapartments.com。

bostonapartments.com 和主域 apartments.com 都托管在一台服务器上。我所做的是使用虚拟主机 apache 配置将 bostonapartments.com 定向到该服务器上的目录，然后使用 iframe 从 apartments.com 加载 bostonapartments.com 的内容。因此，所有内容都将托管在 apartments.com 上，但 bostonapartments.com 将从 apartments.com 获取内容。

如何使用 php、apache、mysql 以可扩展的方式有效地完成此任务？

顺便说一句，我不拥有 apartments.com，我只是以它为例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:14:46.297

如果它们都是相同的，由于重复的内容，它弊大于利，但正如@lanzz 所说，ServerAlias 会做同样的事情。

我建议使用单独的虚拟服务器并使用关键字、写作等优化每个站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:06:04.100

为什么会有这样一个人为的解决方案？只需`ServerAlias`直接在`apartments.com`虚拟主机中为您的所有域添加指令。

# c# - C#：运算符“>=”不能应用于“System.DateTime？”类型的操作数？和'int'

> ID：11058025
> 
> 赞同：0
> 
> 时间：2012-06-15T20:51:25.973
> 
> 标签：c#

我正在尝试执行以下操作：

```
where wt.Rqstcmpldt_dttm >= dueDate.Year - 3 && wt.Rqstcmpldt_dttm >= 2006 
    && wt.Rqstcmpldt_dttm < timeframe 
```

并得到上述错误信息。然后我尝试了这个：

```
where (wt.Rqstcmpldt_dttm ?? new DateTime(3000,1,1).Year >= dueDate.Year - 3) 
    && (wt.Rqstcmpldt_dttm ??  new DateTime(3000,1,1).Year >= 2006) 
    && (wt.Rqstcmpldt_dttm ??  new DateTime(3000,1,1).Year < timeframe) 
```

但我得到一个“操作员”？？不能应用于“System.DateTime？”类型的操作数？和“布尔””错误。

我该如何执行这些操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T20:52:41.417

`&& wt.Rqstcmpldt_dttm >= 2006`

正如消息中明确指出的，您不能将日期与数字进行比较。

你可能想要`.Year`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T20:54:13.663

`dueDate.Year - 3`返回年份的整数。您不能将整数与日期时间进行比较。你需要做这样的事情：

```
where wt.Rqstcmpldt_dttm >= dueDate.AddYears(-3) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T20:54:11.023

运算符比运算`>=`符绑定得更紧密`??`。这意味着您正在隐式进行此比较：

```
where (wt.Rqstcmpldt_dttm ?? (new DateTime(3000,1,1).Year >= dueDate.Year - 3)) 
   && (wt.Rqstcmpldt_dttm ?? (new DateTime(3000,1,1).Year >= 2006)) 
   && (wt.Rqstcmpldt_dttm ?? (new DateTime(3000,1,1).Year < timeframe)) 
```

其中左侧`??`是 DateTime，右侧是布尔值（通过比较返回）；这与您现在收到的错误消息相匹配。

你实际上想要这种行为：

```
where ((wt.Rqstcmpldt_dttm ?? new DateTime(3000,1,1).Year) >= dueDate.Year - 3) 
   && ((wt.Rqstcmpldt_dttm ?? new DateTime(3000,1,1).Year) >= 2006) 
   && ((wt.Rqstcmpldt_dttm ?? new DateTime(3000,1,1).Year) < timeframe) 
```

像下面的例子一样添加括号。

# iphone - 从选定的注释发送数据（InfoBoule 按钮）

> ID：11058032
> 
> 赞同：0
> 
> 时间：2012-06-15T20:51:50.277
> 
> 标签：iphone, ios, xcode

我有一个 mapView，它在 Web 服务的帮助下加载注释。我在一个数组中解析 json 中的数据并获取每个注释的值。

但是现在，我想在选择中发送注释的信息。正如我所想，它更像是 UITableView 中称为 DidSelectRow 的部分......

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T23:57:53.173

如果你的意思是当用户点击 mapView 中的一个注释时，你有一个委托方法。来自 MKMapViewDelegate 协议参考

```
mapView:didSelectAnnotationView: 
```

将您的视图控制器设置为您的 mapView 的委托，然后只需使用此委托方法在用户点击您的注释之一时收到通知。

[链接到关于 MKMapViewDelegate 协议的 Apple 文档](http://developer.apple.com/library/ios/#DOCUMENTATION/MapKit/Reference/MKMapViewDelegate_Protocol/MKMapViewDelegate/MKMapViewDelegate.html)

# mysql - 如何判断一个字符串是否包含在 MySQL 中的另一个文本元素中

> ID：11058039
> 
> 赞同：0
> 
> 时间：2012-06-15T20:52:36.547
> 
> 标签：mysql

我之前问过这个问题：

[如何获得两个文本项之间的增量](https://stackoverflow.com/questions/11057597/determine-how-many-characters-in-text-are-within-another-text-entry-in-mysql/11057686#11057686)

但我还需要一个更二元的答案。也就是说，有没有办法判断一个文本条目是否包含另一个。再举个例子：

```
This is a line. 
```

和

```
This is a line.  And another. 
```

MySQL中是否有一种简单的方法来告诉第一个包含在第二个中？这两项都是文本类型的列中的条目。

更新：

我的桌子看起来像这样

id INT，mytext 文本

所以，我真正想做的是编写一个查询来回答以下问题：

查找此表中 mytext 包含在 mytext_for_another_record 中的所有记录，其中 id=SOMENUMBER。

也许更好的说法是：查找记录中包含 id=123 和 mytext(for id 123) 的所有记录。

因此，我正在扫描整个表以查找包含 id=123 条目的文本的记录。

示例数据：

## 编号 | 文本

1 | 这是第 2 行 | 这是一条线，这里是另一个 3 | 随机 4 | 随机这是一条线

现在，假设文本非常长，而不是短文本条目，比如 1000 个字符。假设我想在数据库中查找包含记录 1 中的文本的所有记录。这样做是唯一的方法`LIKE '%this is a line%'`吗？有没有办法通过给出记录的ID来查看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T20:56:12.637

检查[INSTR(haystack, needle)](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_instr)函数，并将其与 0 进行比较。如果为 0，`haystack`则不包含`needle`. 您也可以使用`LIKE`运算符和通配符 ( `%`) 来执行此操作，但您必须避开这些`%`符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T20:55:44.237

这应该会返回包含给定文本的所有行：

```
SELECT id, line FROM lines WHERE line LIKE '%This is a line.%'; 
```

小提琴就[在这里](http://sqlfiddle.com/#!2/5451f/3)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T20:57:46.130

您可以使用该功能`LOCATE`。如果 1 字符串出现在另一个字符串中，您将得到一个数字，否则为 0。

功能是`LOCATE(substr,str)`。详情请看[这里](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_locate)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-23T15:43:11.663

你也可以使用 concat()：

```
SELECT id, searched,text FROM table_name WHERE text LIKE concat('%', searched, '%'); 
```

# c - 之间的差异 和

> ID：11058045
> 
> 赞同：10
> 
> 时间：2012-06-15T20:52:52.513
> 
> 标签：c, posix, semaphore

`<semaphore.h>`和中包含的功能有什么区别`<sys/sem.h>`？是否存在更好地使用标题或其他的情况？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-16T02:19:29.300

`<sys/sem.h>`为 XSI（最初是 Unix System V）信号量提供接口。这些不是基本 POSIX 标准的一部分（它们在 XSI 选项中，主要是为了传统的 Unix 兼容性），虽然它们还没有被认为是过时/弃用的，但许多程序员认为它们已弃用，POSIX 建议：

> 应用程序使用
> 
> POSIX 实时扩展定义了用于进程间通信的替代接口。需要使用 IPC 的应用程序开发人员应该设计他们的应用程序，以便可以轻松修改使用 XSI 进程间通信中描述的 IPC 例程的模块以使用替代接口。

XSI 信号量的优点和缺点在于它们是，并且必须由于它们的接口工作方式，内核空间对象。这给您带来的主要好处是能够设置它们，以便在进程退出或意外终止时内核可以退出操作。主要成本是每个操作都是到内核空间的往返，即它们非常慢。使用它们的接口也非常晦涩难学，而且它们必然是进程共享资源，这意味着您必须处理共享命名空间和资源清理问题。

`<semaphore.h>`定义了 POSIX 信号量，它们的设计方式使得它们可以完全在用户空间中实现，除非在有争议的情况下，进程将调用内核进入睡眠状态。它们的性能应该接近最佳（即几乎不可能击败您自己的），但它们的功能不如 XSI 信号量。POSIX 信号量还为您提供了选择是否需要进程本地信号量（用于多线程环境，甚至在某些情况下，单线程程序中的信号处理程序）或进程共享信号量，在后一种情况下，您还可以选择是让系统按名称在共享命名空间中分配它，还是自己获取共享内存并在共享内存中初始化它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T21:09:56.263

它们彼此不同/替代，而是两种不同的实现并提供不同的功能集。`semaphore.h`是posix实现，`sys/sem.h`是sysV的实现。POSIX 被[认为](http://www.cs.cf.ac.uk/Dave/C/node26.html#ch:semaphores)更轻量级并被广泛使用。

# sql - Codeigniter SQL 多用途查询

> ID：11058046
> 
> 赞同：0
> 
> 时间：2012-06-15T20:52:55.737
> 
> 标签：sql, codeigniter

目前我正在使用下面的代码从数据库中调用一个标题，它工作正常，但我想`options`在我的管理区域中为我的网站的主要选项实现一个查看所有区域（从表中拉出其他行）。

最好的方法是什么？只为标题创建另一个函数？因为我不想只为标题运行一个 foreach 循环。

```
function systemOptions()
{   

    $query = $this->db->get('options');

    if($query->num_rows() > 0)
    {
        $row = $query->row_array();

        $row['cms_name'];
    }

    return $row;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T20:14:09.973

我会做这样的事情；

```
<?php 

/*

CREATE TABLE `options` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(64) DEFAULT NULL,
  `value` text,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
);

INSERT INTO `options` (`id`, `name`, `value`)
VALUES
(1, 'generic_keywords', 'This,is,my,generic.keywords'),
(2, 'generic_description', 'This is a brief site summary'),
(3, 'page_status_active', '1'),
(4, 'page_status_draft', '2'),
(5, 'page_status_invisible', '2'),
(6, 'page_status_archived', '4'),
(7, 'listing_length', '20'),
(8, 'page_status_deleted', '9');

*/

function systemOptions() { 

    $options = FALSE;
    $query = $this->db->get('options');

    if($query->num_rows() > 0) {
        foreach($query->result() as $row) {
            $data = new StdClass;
            $data->{$row->name} = $value;
            $options[] = $data;
        }
    }

    return $options;
}

function systemOption($name) {

    $query = $this->db->get_where('options', array('name' => $name), 1);
    return ($query->num_rows() == 1) ? $query->row() : FALSE;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T07:43:40.997

我认为您最好返回模型中的所有结果并将其提取到您需要对象的任何地方，如 Colin 所说：

```
function systemOptions()
{   

    $query = $this->db->get('options');

    if($query->num_rows() > 0)
    {
        $row = $query->result();
    }

    return $row;
} 
```

如果你想在控制器的 index 方法中使用它：

```
public function index()
{
    $data[row] = $this->example_model->systemOptions();
    $this->load->view('example_view', $data);
} 
```

并在视图文件中需要该对象的任何地方使用下面的代码：

```
echo $row->cms_name;
echo $row->title; 
```

# javascript - 使用 getElementByID 返回 DOM obj

> ID：11058051
> 
> 赞同：-3
> 
> 时间：2012-06-15T20:53:23.710
> 
> 标签：javascript, dom

```
var vehicleType = document.getElementById('Vehicle_Type');
var obj = vehicleType;
var objVal = obj.value;
var node = obj.parentNode; 
```

我相信 obj.value 存在一些问题....有什么方法可以让我在页面上获取名为“Vehicle Type”的元素的 DOM 对象？

丹科，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T20:59:39.087

两者都`vehicleType`引用`obj`实际的 DOM 元素，但是调用`.value`可能不合适。

根据这是什么类型的元素，您可能实际上没有`.value`属性。该`.value`属性通常出现在各种表单元素上。

如果您想获取元素的文本内容，您应该尝试使用`.textContent`or`.innerText`代替。

此外，请确保您正确设置了元素的 id 属性。如果您正在运行以下命令：

```
document.getElementById('Vehicle_Type') 
```

这将寻找具有属性的元素`id='Vehicle_Type'`。

# c++ - C++ "|=" 赋值运算符

> ID：11058052
> 
> 赞同：-2
> 
> 时间：2012-06-15T20:53:28.067
> 
> 标签：c++, variable-assignment, operator-keyword

我的问题是，C++ 中的“|=”是什么？我知道他们是按位运算符，但我不明白他们在这里做什么：

```
gObj->Variable |= 0x1000000; 
```

另外，在这种情况下，“&”运算符是什么意思？

```
if ((gObj->Variable & 2) == 2)
{
    do stuff
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T20:56:21.027

这些是[按位运算](http://en.wikipedia.org/wiki/Bitwise_operation)。

`|`代表[OR 操作](http://en.wikipedia.org/wiki/Logical_disjunction)并`&`代表[AND 操作](http://en.wikipedia.org/wiki/Logical_conjunction)。

```
x |= y 
```

相当于

```
x = x | y 
```

将这些操作与十六进制值一起使用是很常见的，因为它更容易且非常直观。例如：

```
0x10 | 0x01 = 0x11
0x10 & 0x01 = 0x00
0x10 & 0x11 = 0x10 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T20:55:54.383

我不是 C++ 专家，但我相信这些被视为 += 或 *=。也就是说，它将按位或该变量的位与您提到的十六进制数。此外，Variable & 2 与 10（二进制）进行按位与。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T08:33:10.667

它是按位或运算符，上面的语句将变量的第一位设置为 1。

# c++ - 这会导致引用超出范围后指向任何内容吗？

> ID：11058054
> 
> 赞同：0
> 
> 时间：2012-06-15T20:53:48.393
> 
> 标签：c++, reference, constructor, scope

下面的代码安全吗？

```
class B {
  public:
    int& b;
    B (int& _b) :
      b(_b) {}
};

B* foo() {
  int a;
  return new B(a);
} 
```

foo 返回的对象中的引用会指向任何内容（因为 int a 超出范围）还是编译会解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T20:58:00.480

编译器可能会警告您，但新创建的对象肯定包含一个悬空的无效引用，因为该对象`a`在`foo`.

# sql - 当 COUNT(*) 在 DB2 中返回 NULL 时如何替换 NULL

> ID：11058062
> 
> 赞同：0
> 
> 时间：2012-06-15T20:54:26.193
> 
> 标签：sql, db2

我有一个查询：

```
SELECT A.AHSHMT AS SHIPMENT, A.AHVNAM AS VENDOR_NAME, D.UNITS_SHIPPED, D.ADPON AS PO, B.NUMBER_OF_CASES_ON_TRANSIT, C.NUMBER_OF_CASES_RECEIVED FROM AHASNF00 A
      INNER JOIN (SELECT IDSHMT, COUNT(*) AS NUMBER_OF_CASES_ON_TRANSIT FROM IDCASE00 WHERE IDSTAT = '01' GROUP BY IDSHMT) B 
        ON (A.AHSHMT = B.IDSHMT) 
      LEFT JOIN (SELECT IDSHMT, (COUNT(*) AS NUMBER_OF_CASES_RECEIVED FROM IDCASE00 WHERE IDSTAT = '10' GROUP BY IDSHMT) C 
        ON (A.AHSHMT = C.IDSHMT) 
       INNER JOIN (SELECT ADSHMT, ADPON, SUM(ADUNSH) AS UNITS_SHIPPED FROM ADASNF00 GROUP BY ADSHMT, ADPON) D 
        ON (A.AHSHMT = D.ADSHMT) 
    WHERE A.AHSHMT = '540041134'; 
```

在第一个 JOIN 语句中，我有一个 COUNT(*)，在这个计数上，有时我会得到 NULL。我需要用“0-零”替换它，我知道我知道如何在 SQL 中做到这一点

```
ISNULL(COUNT(*), 0) 
```

但这不适用于 DB2，我该如何实现呢？您的所有帮助都非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T23:35:15.713

将 COALESCE 包裹在 SELECT 列表中的每个可为空的总数周围：

```
SELECT A.AHSHMT AS SHIPMENT, 
A.AHVNAM AS VENDOR_NAME, 
COALESCE( D.UNITS_SHIPPED, 0 ) AS UNITS_SHIPPED,
D.ADPON AS PO, 
COALESCE( B.NUMBER_OF_CASES_ON_TRANSIT, 0 ) AS NUMBER_OF_CASES_ON_TRANSIT, 
COALESCE( C.NUMBER_OF_CASES_RECEIVED, 0 ) AS NUMBER_OF_CASES_RECEIVED
FROM ... 
```

您为表达式 B 和 D 使用的内连接意味着您将只接收来自 A 的行，这些行在传输中具有一个或多个案例（表达式 B）并且在表达式 D 中具有一个或多个 PO。这就是您想要的方式吗？查询工作？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:27:26.787

而不是使用`ISNULL(COUNT(*), 0)`,

尝试使用`COALESCE(COUNT(*),0)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T12:56:45.103

用于`IFNULL(COUNT(*), 0)`DB2

# android - android.database.sqlite.SQLiteException：无法识别的令牌：

> ID：11058063
> 
> 赞同：4
> 
> 时间：2012-06-15T20:54:26.100
> 
> 标签：android, database, sqlite

我尝试更新数据库表，这是我的代码：

```
public void updatefiletable(String filename, String v1, String v2){
  AndroidOpenDbHelper androidOpenDbHelperObj = new AndroidOpenDbHelper(this);
  SQLiteDatabase sqliteDatabase = androidOpenDbHelperObj.getWritableDatabase();

  ContentValues values = new ContentValues();
  values.put(AndroidOpenDbHelper.COLLUMN_NAME_FILE_CLOUD, v1);
  values.put(AndroidOpenDbHelper.COLLUMN_NAME_FILE_DATE_UPLOADING, v2);
  sqliteDatabase.update(AndroidOpenDbHelper.TABLE_FILE, values, AndroidOpenDbHelper.COLUMN_NAME_FILE_NAME+"="+filename, null);

  sqliteDatabase.close();    
} 
```

当我用 file_name 值 egal priv_priv_secondfile_2012-06-15.pdf 调用我的方法时，我在 logcat 中得到了它：

```
android.database.sqlite.SQLiteException: unrecognized token: "15.pdf": ,
while compiling: UPDATE file_table SET file_cloud_column=?, 
file_date_upload_column=? 
WHERE file_name_column=priv_priv_secondfile_2012-06-15.pdf 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-15T20:57:25.553

您需要转义文件名参数。文件名中的标点符号使 SQLite 感到困惑。您可以通过`'single quotes'`在传递给 SQLite 的字符串中将文件名括起来来做到这一点，但是将其作为单独的参数传递会更干净、更安全，如下所示：

```
sqliteDatabase.update(AndroidOpenDbHelper.TABLE_FILE, values,
        AndroidOpenDbHelper.COLUMN_NAME_FILE_NAME+"=?", new String[] {filename}); 
```

# android - Android - 将图像从 App 上传到 IIS 服务器

> ID：11058067
> 
> 赞同：-1
> 
> 时间：2012-06-15T20:54:32.123
> 
> 标签：android, asp.net-mvc-3, web-services, wcf-data-services

我已经在 Android 中开发了一段时间的应用程序，现在我需要从这个应用程序将图像上传到服务器。问题是我真的不知道如何在后端（这是服务器端）执行此操作。我已经阅读了很多关于通过`httpmime`库发送图像和使用`multipart`的信息，但没有太多关于接收图像的服务器端服务。

我需要使用 MVC3 或 WCF 之类的东西，因为我们这里的服务器是 IIS，我还没有找到太多关于如何使用这个模型来做的事情。因此，我需要任何有关如何使用此模型完成此任务的教程或指南，任何帮助也将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:20:50.367

您可以通过 HTTP POST 发布文件

```
public String sendFilePost(String urlServer, String pathToOurFile){
                   HttpURLConnection connection = null;
                   DataOutputStream outputStream = null;
                   DataInputStream inputStream = null;
                   String lineEnd = "\r\n";
                   String twoHyphens = "--";
                   String boundary =  "*****";
                   int bytesRead, bytesAvailable, bufferSize;
                   byte[] buffer;
                   int maxBufferSize = 1*1024*1024;
                   try
                   {
                   FileInputStream fileInputStream = new FileInputStream(new File(pathToOurFile) );
                   URL url = new URL(urlServer);
                   connection = (HttpURLConnection) url.openConnection();
                   connection.setDoInput(true);
                   connection.setDoOutput(true);
                   connection.setUseCaches(false);
                   connection.setRequestMethod("POST");
                   connection.setRequestProperty("Connection", "Keep-Alive");
                   connection.setRequestProperty("Content-Type", "multipart/form-data;boundary="+boundary);

                   outputStream = new DataOutputStream( connection.getOutputStream() );
                   outputStream.writeBytes(twoHyphens + boundary + lineEnd);
                   outputStream.writeBytes("Content-Disposition: form-data; name=\"uploadedfile\";filename=\"" + pathToOurFile +"\"" + lineEnd);
                   outputStream.writeBytes(lineEnd);

                   bytesAvailable = fileInputStream.available();
                   bufferSize = Math.min(bytesAvailable, maxBufferSize);
                   buffer = new byte[bufferSize];

                   // Read file
                   bytesRead = fileInputStream.read(buffer, 0, bufferSize);

                   while (bytesRead > 0)
                   {
                   outputStream.write(buffer, 0, bufferSize);
                   bytesAvailable = fileInputStream.available();
                   bufferSize = Math.min(bytesAvailable, maxBufferSize);
                   bytesRead = fileInputStream.read(buffer, 0, bufferSize);
                   }

                   outputStream.writeBytes(lineEnd);
                   outputStream.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);

                   // Responses from the server (code and message)
                   String serverResponseMessage = connection.getResponseMessage();
                   InputStream is = connection.getInputStream();
                   BufferedReader rd = new BufferedReader(new InputStreamReader(is));
                   String line;
                   StringBuffer response = new StringBuffer(); 
                   while((line = rd.readLine()) != null) {
                        response.append(line);
                   }
                   String rrrr = response.toString();
                   rd.close();
                   fileInputStream.close();
                   outputStream.flush();
                   outputStream.close();
                    return rrrr;
                   }
                   catch (Exception ex)
                   {
                       return "Something went wrong!";
                   }
               } 
```

# excel - 基于/在字段中的excel上的拆分行

> ID：11058068
> 
> 赞同：0
> 
> 时间：2012-06-15T20:54:32.277
> 
> 标签：excel, openoffice-calc, vba

假设 B 列有数据，例如 Data1/Data2/Data3-1/Data3-7 - 所有其他行都有各种数据。

我需要获取具有 B 列的每一行（有些可能没有），并为每个单独的值创建 1 行，并为所有这些值复制该行中的所有其他数据。

数据可能有符号、破折号和其他随机的东西，但实际数据本身不会有/，只有/用于指定分割线

Any1知道最好的方法吗？Excel 07 和 OO 可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:26:15.993

VBA 解决方案好吗？

```
Sub DuplicateRows()
    Dim r As Range

    Set r = Cells(Rows.Count, 2).End(xlUp)

    Do While r.Row > 1
        TestRow r
        Set r = r.Offset(-1, 0)
    Loop
    TestRow r

End Sub

Sub TestRow(r As Range)
    Dim i As Long, n As Long
    Dim a() As String

    i = InStr(r, "/")
    If i > 0 Then
        n = Len(r) - Len(Replace(r, "/", ""))
        r.EntireRow.Copy
        r.Offset(1, 0).Resize(n).EntireRow.Insert Shift:=xlDown
        a = Split(r, "/")
        For i = 0 To n
            r.Offset(i, 0) = a(i)
        Next
    End If
    Application.CutCopyMode = False
End Sub 
```

# r - 创建一个渐变色的箭头

> ID：11058072
> 
> 赞同：5
> 
> 时间：2012-06-15T20:55:15.923
> 
> 标签：r, gradient

如何使用 R 创建具有渐变颜色的箭头或线段？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T22:04:38.757

我认为 Jim Lemon 应该自动获得 10K 甚至 20K 的 SO 代表点数，这要归功于他多年来创建基本图形解决方案的所有工作。这家伙很了不起。一次又一次，有人会在 Rhelp 上要求一些东西，他会想出一个解决方案。这是帮助页面提供的“随机彩虹”：

```
require(plotrix)
x<-c(0,cumsum(rnorm(99)))
 y<-c(0,cumsum(rnorm(99)))
 xydist<-sqrt(x*x+y*y)
 plot(x,y,main="Random walk plot",xlab="X",ylab="Y",type="n")
 color.scale.lines(x,y,c(1,1,0),0,c(0,1,1),colvar=xydist,lwd=2) 
```

![在此处输入图像描述](../Images/83c7ae61cd6c8b9c3495a007965abc13.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-15T22:20:09.503

试试这个，

```
library(grid)

png("mask.png")
grid.polygon(c(-0.06, 0.06, 0.06, 0.15, 0, -0.15, -0.06),
             c(-5, -5, 2.5, 2, 5, 2, 2.5), gp=gpar(fill="black"),
             def="native",
             vp=viewport(xs=c(-0.15, 0.15), ys=c(-5, 5)))
dev.off()

library(png)
m <- readPNG("mask.png", native=FALSE)
mask <- matrix(rgb(m[,,1],m[,,2],m[,,3]),
               nrow=nrow(m))

rmat <- matrix(rgb(colorRamp(c("blue","white","red"))(seq(0,1,length=nrow(m))), maxColorValue=255),
               nrow=nrow(m), ncol=ncol(m))
rmat[mask == "#FFFFFF"] <- NA
grid.newpage()
grid.raster(rmat) 
```

![浏览器](../Images/9fb98da8f3b345ef6b224f300e88903d.png)

**编辑**：您可以在情节中重复使用它，例如

```
library(ggplot2)
ggplot(iris) + geom_path(aes(Sepal.Length, Petal.Length, colour = Petal.Width)) +
  guides(colour = guide_colourbar()) +
  annotation_custom(rasterGrob(rmat, width=unit(1,"npc"), height=unit(1, "npc")),
                    x = 6, xmax=6.2, y=2.5, ymax=4) 
```

![在此处输入图像描述](../Images/5a6828145161b33eb330a0f8f984948f.png)

# jquery - 使用 jQuery 和 CodeIgniter 进行表单验证和 AJAX 表单提交

> ID：11058074
> 
> 赞同：0
> 
> 时间：2012-06-15T20:55:29.743
> 
> 标签：jquery, jquery-validate, codeigniter-2

我正在使用以下代码插入评论：

```
<div id="2" class="789678">
    <div id="dynamic2">
        <span class="error" style="display:none">Please Enter Valid Data</span>
        <span class="success" style="display:none">Submitted Successfully</span>
        <form action="http://localhost/ci/index.php/#"
        method="post" accept-charset="utf-8" name="commentform" id="commentform">
            <div style="display:none">
                <input type="hidden" name="token" value="552e5dab8e50b8263c8b7ba548adaf5b">
            </div>
            <p>
                <label for="Name">Name</label>
                <br>
                <input type="text" name="name" value="" id="name" size="30" placeholder="Please Enter Name or Nick name"
                class="required">
            </p>
            <p>
                <label for="email">Email Address</label>
                <br>
                <input type="text" name="email" value="" id="email" size="30" placeholder="Enter Email Address"
                class="required">
            </p>
            <p>
                <label for="comment">comment</label>
                <br>
                <textarea name="content" cols="40" rows="5" id="content" col="180" placeholder="Post Your Comment"
                class="required"></textarea>
            </p>
            <input type="hidden" id="post_id" name="post_id" value="2">
            <input type="hidden" id="num" name="num" value="789678">
            <button name="button" type="reset" id="button" value="true">Add Comment</button>
        </form>
    </div>
    <input type="button" id="adcom" value="Add Comment" style="display: none; ">
</div> 
```

以下是我在不刷新页面的情况下提交页面的 jQuery 代码。它工作正常，但我需要添加无效的验证，并且它也没有显示任何错误：

```
<script>
    $("#button").live("click", function (e) {
        e.preventDefault();
        $("#commentform").validate();
        var currentId = $(this).parent().parent().parent().attr('id');
        var num = $('#num').val();
        var email = $('#email').val();
        var post_id = $('#post_id').val();
        var name = $('#name').val();
        var content = $('#content').val();
        var token = $('input[name="token"]').val();
        var dataString = 'num=' + num + '&email=' + email + '&content_id=' + post_id + '&name=' + name + '&content=' + content + '&token=' + token;
        $.ajax({
            type: "POST",
            url: "http://localhost/ci/index.php/mobiles/mobile_insert_comment/",
            data: dataString,
            success: function (result) {
                $("#commentform").remove();
                //$("#dynamic"+currentId).text(' successfully submitted');
                $('.success').fadeIn(200).show();
                $('.error').fadeOut(200).hide();
            }
        });
        return false;
    });
</script> 
```

我正在使用以下 jQuery 验证插件：

```
 <script type="text/javascript"
 src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:04:45.770

如果您可以将 php 端托管在公共而不是 localhost 上，则可以使用[jsFiddle](http://jsfiddle.net/83MAG/)模拟您的问题，我会探索类似的东西

```
$.ajax({

        type: "POST",

            url: "http://localhost/ci/index.php/mobiles/mobile_insert_comment/",

            data: dataString,

        success: function(result) {

            $("#commentform").remove();

            //$("#dynamic"+currentId).text(' successfully submitted');

            $('.success').fadeIn(200).show();

             $('.error').fadeOut(200).hide();

                            }

        }).done(function (response) {

            console.log(response);

        }); 
```

如果您的响应以 JSON 编码形式出现，则可能使用 jQuery.parseJSON(response) 。查看此 AJAX 调用的结果很可能会为您指明下一步的正确方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:51:25.327

codeigniter 有一个表单验证类。这里有一个很好的教程：http://codeigniter.com/user_guide/libraries/form_validation.html 我建议你看一下。请记住，要验证每个字段的表单必须通过验证并出现在表单验证规则中。

*   查看您的代码，您的按钮 id='button' 类型 'reset' 看起来很奇怪。只需添加评论，然后使用您的 javascript/ajax 处理程序来形成帖子数据并发送到您的网站。

*   使用 javascript 对象表示法将 ajax 帖子的数据对象作为数据对象发送并不是一个坏主意。例如 var data = {'email':$('#email').val(),'name':$('#name').val()} 等您的字符串看起来像是格式化为 GET 字符串，而不是 POST。

# hibernate - EntityNotFoundException：已删除的实体传递到 EntityManager.remove 上持久化

> ID：11058085
> 
> 赞同：2
> 
> 时间：2012-06-15T20:56:16.160
> 
> 标签：hibernate, jpa

我有一个 ContactEntity（父）和 PhoneNumberComponent（子）关系。当我尝试 EntityManager.remove() 孩子时，我得到下面的异常。

另外，我注意到，如果我在 AbstractContactEntity 的 phoneNumbers 映射中删除 CascadeType.Persist 或将 FetchType.EAGER 更改为 LAZY，我的 JUnit 就会通过。

有人能告诉我我错过了什么吗？

使用：休眠，hsqldb

## 堆栈跟踪

```
javax.persistence.EntityNotFoundException: deleted entity passed to persist: [com.bb.sc.contact.jpa.entity.PhoneNumberComponent#<null>]
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1329)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1280)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1286)
    at org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:969)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)
    at $Proxy35.flush(Unknown Source)
    at test.bb.sc.contact.jpa.entity.PhoneNumberComponentJUnit.testCRUD(PhoneNumberComponentJUnit.java:98)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:82)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:240)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:180)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

## 联系实体（父）

```
@Entity
@Table (name="CONTACT")
@Inheritance (strategy=InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn (name="CONTACT_DISCRIMANATOR")
public abstract class AbstractContactEntity implements Auditable {
    @Column (name="CONTACT_ID", nullable=false)
    @Id @GeneratedValue (strategy=GenerationType.IDENTITY)
    private Long id;
    @OneToMany (mappedBy="contact", cascade=CascadeType.ALL, fetch=FetchType.LAZY, targetEntity=PostalAddressComponent.class)
    private Collection<PostalAddressComponent> postalAddresses;
    @OneToMany (mappedBy="contact", targetEntity=PhoneNumberComponent.class, cascade={CascadeType.DETACH, CascadeType.MERGE, CascadeType.REFRESH, CascadeType.REMOVE, CascadeType.PERSIST}, fetch=FetchType.EAGER)
    private Collection<PhoneNumberComponent> phoneNumbers;
    @OneToMany (mappedBy="contact", cascade=CascadeType.ALL, fetch=FetchType.LAZY, targetEntity=EmailAddressComponent.class)
    private Collection<EmailAddressComponent> emailAddresses;
    @Embedded
    private DbAudit dbAudit; 
```

## ContactDetail（抽象的孩子）

```
@MappedSuperclass
public abstract class AbstractContactDetail implements Auditable{
    @Id @GeneratedValue (strategy=GenerationType.IDENTITY)
    private Long id;
    @OneToOne @JoinColumn (name="CONTACT_TYPE_ID", nullable=false)
    private ContactDetailTypeEntity type;
    @ManyToOne (targetEntity=AbstractContactEntity.class) @JoinColumn (name="CONTACT_ID", nullable=false)
    private AbstractContactEntity contact;
    @Embedded
    private DbAudit dbAudit; 
```

## ContactDetail impl（具体的 impl child）

```
@Entity
@Table (name="PHONE_NUMBER")
@AttributeOverride (name="id", column=@Column(name="PHONE_NUMBER_ID"))
public class PhoneNumberComponent extends AbstractContactDetail {

    @Column (name="AREA_CODE", nullable=false)
    private Integer areaCode;
    @Column (name="PREFIX", nullable=false)
    private Integer prefix;
    @Column (name="SUFFIX", nullable=false)
    private Integer suffix;
    @Column (name="EXTENSION")
    private Integer ext; 
```

## JUnit

```
@Before
public void setup () {
    contact = new ContactPersonEntity();
    type = new ContactDetailTypeEntity();

    type.setCode("CODE");
    type.setType("TYPE");
    em.persist(contact);
    em.persist(type);
    em.flush();

    // Before each test, make sure the EntityManager has a clean persistence context.
    em.clear();
}   
@Test
public void testDelete () {
    PhoneNumberComponent p = new PhoneNumberComponent(111, 222, 3333, 44, contact, type);
    em.persist(p);
    em.flush();
    assertNotNull (p.getId());

    em.clear();
    PhoneNumberComponent found = em.find(PhoneNumberComponent.class, p.getId());
    assertNotNull (found);
    em.remove(found);
    em.flush();
} 
```

您在我的 JUnit 中看到的最后一个 em.flush 上的 JUnit 炸弹。另一个观察结果是，如果我用下面的代码替换 JUnit 中的 em.remove(foundUpd) 行，则测试通过。但是，我宁愿不必加载父对象图、遍历它并显式断开父子链接以删除记录。谢谢。

```
 AbstractContactEntity c = em.find(AbstractContactEntity.class, 1L);
    c.getPhoneNumbers();
    Iterator<PhoneNumberComponent> it = c.getPhoneNumbers().iterator();
    while (it.hasNext()) {
        PhoneNumberComponent p = it.next();
        em.remove(p);
        it.remove();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T11:59:27.190

在 FetchType.EAGER 映射中，在持久性上下文中加载子级也会加载父级。在我的 JUnit 中，我在找到孩子之前执行了 EntityManager.clear 。认为孩子是持久性上下文中唯一的实体是一个糟糕的假设。

在调试中，我执行了

```
PhoneNumberComponent found = em.find(PhoneNumberComponent.class, p.getId()); 
```

并注意到它生成的*一对*SQL。

```
Hibernate: select phonenumbe0_.PHONE_NUMBER_ID as PHONE1_3_2_, phonenumbe0_.CONTACT_ID as CONTACT10_3_2_, phonenumbe0_.CREATE_TIMESTAMP as CREATE2_3_2_, phonenumbe0_.CREATE_USER as CREATE3_3_2_, phonenumbe0_.UPDATE_TIMESTAMP as UPDATE4_3_2_, phonenumbe0_.UPDATE_USER as UPDATE5_3_2_, phonenumbe0_.CONTACT_DETAIL_TYPE_ID as CONTACT11_3_2_, phonenumbe0_.AREA_CODE as AREA6_3_2_, phonenumbe0_.EXTENSION as EXTENSION3_2_, phonenumbe0_.PREFIX as PREFIX3_2_, phonenumbe0_.SUFFIX as SUFFIX3_2_, abstractco1_.CONTACT_ID as CONTACT2_0_0_, abstractco1_.CREATE_TIMESTAMP as CREATE3_0_0_, abstractco1_.CREATE_USER as CREATE4_0_0_, abstractco1_.UPDATE_TIMESTAMP as UPDATE5_0_0_, abstractco1_.UPDATE_USER as UPDATE6_0_0_, abstractco1_.ORGANIZATION_NAME as ORGANIZA7_0_0_, abstractco1_.FRIST_NAME as FRIST8_0_0_, abstractco1_.LAST_NAME as LAST9_0_0_, abstractco1_.CONTACT_DISCRIMANATOR as CONTACT1_0_0_, contactdet2_.CONTACT_DETIAL_TYPE_ID as CONTACT1_1_1_, contactdet2_.CODE as CODE1_1_, contactdet2_.DESCRIPTION as DESCRIPT3_1_1_, contactdet2_.TYPE as TYPE1_1_ from PHONE_NUMBER phonenumbe0_ inner join CONTACT abstractco1_ on phonenumbe0_.CONTACT_ID=abstractco1_.CONTACT_ID inner join CONTACT_TYPE contactdet2_ on phonenumbe0_.CONTACT_DETAIL_TYPE_ID=contactdet2_.CONTACT_DETIAL_TYPE_ID where phonenumbe0_.PHONE_NUMBER_ID=?
Hibernate: select phonenumbe0_.CONTACT_ID as CONTACT10_0_2_, phonenumbe0_.PHONE_NUMBER_ID as PHONE1_2_, phonenumbe0_.PHONE_NUMBER_ID as PHONE1_3_1_, phonenumbe0_.CONTACT_ID as CONTACT10_3_1_, phonenumbe0_.CREATE_TIMESTAMP as CREATE2_3_1_, phonenumbe0_.CREATE_USER as CREATE3_3_1_, phonenumbe0_.UPDATE_TIMESTAMP as UPDATE4_3_1_, phonenumbe0_.UPDATE_USER as UPDATE5_3_1_, phonenumbe0_.CONTACT_DETAIL_TYPE_ID as CONTACT11_3_1_, phonenumbe0_.AREA_CODE as AREA6_3_1_, phonenumbe0_.EXTENSION as EXTENSION3_1_, phonenumbe0_.PREFIX as PREFIX3_1_, phonenumbe0_.SUFFIX as SUFFIX3_1_, contactdet1_.CONTACT_DETIAL_TYPE_ID as CONTACT1_1_0_, contactdet1_.CODE as CODE1_0_, contactdet1_.DESCRIPTION as DESCRIPT3_1_0_, contactdet1_.TYPE as TYPE1_0_ from PHONE_NUMBER phonenumbe0_ inner join CONTACT_TYPE contactdet1_ on phonenumbe0_.CONTACT_DETAIL_TYPE_ID=contactdet1_.CONTACT_DETIAL_TYPE_ID where phonenumbe0_.CONTACT_ID=? 
```

然后我添加了以下行，并注意到控制台中没有 SQL。不需要 DB 操作，因为 EntityManager 能够在持久性上下文中找到父级。

```
AbstractContactEntity c = em.find(AbstractContactEntity.class, 1L); 
```

如果我将 AbstractContactEntity 中的 phoneNumbers 映射更改为 FetchType.LAZY，我只会得到第一个 SQL。

## 编辑

我不知道[为什么 Hibernate](https://stackoverflow.com/questions/11065974/why-does-hibernate-load-the-parent-entity-when-finding-a-child-in-fetchtype-eage)会这样做，但现在我只是接受这种行为并进行相应的设计。

这是 Hibernate 中可能发生的情况的说明。

当我 find() 我的子实体时，父实体也加载到持久性上下文中。然后 remove() 将删除指令标记给子节点，并将更新指令标记给父节点。最后，当我 flush() 时，子级被删除，父级被推回数据库。但是由于该父级仍然具有对已删除子级的引用，因此我被 EntityNotFoundException 踢了：已删除的实体传递给了持久化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T05:27:17.170

ContactEntity（父）和 PhoneNumberComponent（子）

您在 ContactEntity 中有 PhoneNumberComponent 的列表。要删除孩子，请按照下列步骤操作：

1.  从数据库中获取 PhoneNumberComponent。
2.  从 DB 中获取相应的 ContactEntity。
3.  从 ContactEntity 列表中删除相应的 PhoneNumberComponent。
4.  现在删除 PhoneNumberComponent

# javascript - 使用原型时如何引用父对象？

> ID：11058089
> 
> 赞同：1
> 
> 时间：2012-06-15T20:56:31.150
> 
> 标签：javascript, arrays, oop, function, prototype

我创建了一个实用函数，我编写的几乎所有 Javascript 代码中都包含它。所述函数的目的是简单地从数组中删除一个元素。它接受一个数组和一个索引作为参数，并返回删除了所需元素的数组。

这是功能：

```
sliceHere = function(array, i)
{
    buffOne = array.slice(0, i);
    buffTwo = array.slice(i + 1);

    return buffOne.concat(buffTwo);         
} 
```

它工作得很好。如果我有一个数组`a = ["a", "b", "c"]`，并且我想从中删除`"a"`它，我会简单地做`a = sliceHere(a, 0);`.

虽然这**确实**有效，但我想用更“优雅”的东西来代替它。我想做的是使该函数成为我拥有的**所有**数组`sliceHere`的方法。所以我可以简单地做并达到同样的效果。这只是感觉像是一种更好的做事方式，如果我错了，请纠正我。**`a.sliceHere(0)`**

 **我所做的是这样的：

```
sliceHere = function(i)
{
    buffOne = this.slice(0, i);
    buffTwo = this.slice(i + 1);

    this = buffOne.concat(buffTwo);         
}

Array.prototype.sliceHere = sliceHere 
```

这似乎根本行不通。因为我知道“this”可能不是实际的数组。**如何从方法内部引用数组？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T21:02:49.203

为什么要重新发明轮子？[`Array.prototype.splice`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)已经做了同样的事情：

```
var array = [1, 2, 3];
var i = 1;
array.splice(i, 1);
array; // [2, 3] 
```

好吧，让我们重新发明轮子：

带接头：

```
Array.prototype.sliceHere = function(i) {
    this.splice(i, 1);
}; 
```

无拼接：

```
Array.prototype.sliceHere = function(i) {
     var i_want_you = this.slice(0, i).concat(this.slice(i + 1));
     this.length = 0;
     this.push.apply(this, i_want_you);  // <-- Modifies all keys, indirectly
}; 
```

如果您不希望该方法出现在`for(.. in ..)`循环中，请使用[`Object.defineProperty(Array.prototype, 'sliceHere', {value: /*function here*/});`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/defineProperty).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T21:02:27.713

`this`始终是只读的，因此您不能为其分配新数组，您应该返回一个更新的值。这是您的示例的更新版本：

```
sliceHere = function(i)
{
    buffOne = this.slice(0, i);
    buffTwo = this.slice(i + 1);

    return buffOne.concat(buffTwo);
}

Array.prototype.sliceHere = sliceHere;

var arr = [1, 2, 3];
arr = arr.sliceHere(1); 
```**

# android - PopupWindow z 排序

> ID：11058093
> 
> 赞同：14
> 
> 时间：2012-06-15T20:56:45.423
> 
> 标签：android, popupwindow, android-windowmanager

我使用 PopupWindow 玩菜单，它与 EditText 重叠。

它工作正常，除了我的 PopupWindow 与来自 EditText IME 系统的某些项目（选择标记、粘贴按钮）重叠。

我的问题是：如何强制对 PopupWindow 进行 z 排序，使其显示在这些装饰上方？

这是正在发生的事情的图像。我需要将我的 PopupWindow（菜单）绘制在所有内容之上，从而以某种方式告诉 WindowManager 如何订购窗口。谢谢。

![在此处输入图像描述](../Images/751df848d552c644387fd703a66b8879.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-15T23:03:24.440

我自己找到了答案。

这些装饰是普通的 PopupWindow-s，由 EditText 管理。

[WindowManager.LayoutParams.type](http://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#type)定义了任何 Window 的 Z 顺序，实际上它定义了 Window 的用途。弹出窗口的有效范围是 FIRST_SUB_WINDOW - LAST_SUB_WINDOW。

应用程序通常不能更改[PopupWindow](http://developer.android.com/reference/android/widget/PopupWindow.html)的“类型” ，除了使用 Java 反射调用隐藏函数 PopupWindow.setWindowLayoutType(int) 并设置所需的窗口类型。

结果：

![在此处输入图像描述](../Images/f9d11566ee848bc48f079afccf0aab0f.png)

**编辑：** 这样做的代码：

```
 Method[] methods = PopupWindow.class.getMethods();
  for(Method m: methods){
     if(m.getName().equals("setWindowLayoutType")) {
        try{
           m.invoke(getPopupWindow(), WindowManager.LayoutParams.TYPE_APPLICATION_SUB_PANEL);
        }catch(Exception e){
           e.printStackTrace();
        }
        break;
     }
  } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-09-18T00:14:15.480

```
import android.support.v4.widget.PopupWindowCompat;

PopupWindowCompat.setWindowLayoutType(popupWindow, WindowManager.LayoutParams.TYPE_APPLICATION_SUB_PANEL); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-21T02:52:10.360

```
public void compatibleSetWindowLayoutType(int layoutType) {
    if (Build.VERSION.SDK_INT >= 23) {
        setWindowLayoutType(layoutType);
    } else {
        try {
            Class c = this.getClass();
            Method m = c.getMethod("setWindowLayoutType", Integer.TYPE);
            if(m != null) {
                m.invoke(this, layoutType);
            }
        } catch (Exception e) {
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-09T12:19:14.160

使是互补的。该`PopupWindowCompat.setWindowLayoutType` API 必须在 show popWindow 之前调用。

# ios - 进程间 SQLite 线程安全（在 iOS 上）

> ID：11058098
> 
> 赞同：10
> 
> 时间：2012-06-15T20:57:19.173
> 
> 标签：ios, sqlite, thread-safety, jailbreak

我正在尝试确定我对数据库的 sqlite 访问是否在 iOS 上是线程安全的。我正在编写一个非 App Store 应用程序（或者可能是一个启动守护程序），因此 Apple 的批准不是问题。有问题的数据库是内置的[sms.db](http://theiphonewiki.com/wiki/index.php?title=IMessage)，所以操作系统肯定也在访问这个数据库进行读写。我只想能够安全地阅读它。

我读过[这篇关于使用 sqlite 从多个进程中](http://www.sqlite.org/faq.html#q5)读取的内容：

> 多个进程可以同时打开同一个数据库。多个进程可以同时执行 SELECT。但是，任何时候只有一个进程可以对数据库进行更改。

我知道线程安全可以从 sqlite 编译出来，并且`sqlite3_threadsafe()`可以用来测试这一点。在 iOS 5.0.1 上运行

```
int safe = sqlite3_threadsafe(); 
```

结果为 2。 [据此](http://www.sqlite.org/threadsafe.html)，这意味着互斥锁是*可用*的。但是，这并不一定意味着它正在使用中。

我并不完全清楚线程安全是否在每个连接、每个数据库或全局基础上动态启用。

[我也读过这个](https://stackoverflow.com/questions/7795973/setting-sqlite-config-sqlite-config-serialized-returns-sqlite-misuse-on-ios-5)。看起来`sqlite3_config()`可以用来启用安全的多线程，但当然，我无法控制或了解操作系统本身可能如何使用此调用（是吗？）。如果我要在我的应用程序中再次进行该调用，是否可以安全地读取数据库，或者它是否只会解除**我的应用程序**中使用相同`sqlite3`数据库句柄的多个线程的并发访问冲突？

无论如何，我的问题是...

**我可以安全地读取这个也被 iOS 访问的数据库吗？如果可以，如何？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-07T01:15:56.570

我从未使用过 SQLite，但我花了相当多的时间阅读它的文档，因为我计划在未来使用它（而且文档很有趣）。我想说线程安全与多个进程是否可以同时访问同一个数据库文件无关。SQLite，无论处于何种线程模式，都会[锁定数据库文件](http://www.sqlite.org/lockingv3.html)，这样多个进程可以同时从数据库中读取，但只有一个可以写入。

[线程安全](http://www.sqlite.org/threadsafe.html)仅影响您的进程如何使用 SQLite。没有任何线程安全，您只能从一个线程调用 SQLite 函数。但它仍然应该在写入之前获得一个独占锁，这样其他进程就不会破坏数据库文件。如果您使用多个线程，线程安全只是保护进程内存中的数据不被损坏。因此，我认为您不必担心另一个进程（在本例中为 iOS）对 SQLite 数据库的操作。

**编辑：**澄清一下，任何时候你写入数据库，包括一个普通的`INSERT`// `UPDATE`，`DELETE`它都会自动获取一个独占锁，写入数据库，然后释放锁。（实际上它在写入之前需要一个共享锁，然后是保留锁，然后是挂起锁，然后是排他锁。）默认情况下，如果数据库已经被锁定（比如来自另一个进程），那么 SQLite 将返回 SQLITE_BUSY 而无需等待. 你可以打电话[`sqlite3_busy_timeout()`](http://www.sqlite.org/c3ref/busy_timeout.html)告诉它等待更长时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:45:59.380

我不认为这对你来说是新闻，但有一些想法：

在启用多线程（序列化或多线程）方面，一般建议是可以调用`sqlite3_config()`（但您可能必须首先按照[文档](http://sqlite.org/c3ref/config.html)中的建议或在此处讨论的[SO](https://stackoverflow.com/questions/8872278/which-threading-mode-is-sqlite-for-ios-compiled-in)进行关闭）以启用排序你想要的多线程。不过，这在这里的用处可能会降低，因为您无法控制 iOS 请求 sqlite 和/或此数据库的访问类型。

因此，我会认为，从学术角度来看，读取这个系统数据库是不安全的（因为正如你所说，你不能保证操作系统在做什么）。但如果 iOS 使用默认模式打开数据库，我不会感到惊讶，所以从更务实的角度来看，你可能会没事。

显然，对于大多数关注单个应用程序中的多线程访问的用户来说，最好的建议是绕过`sqlite3_config()`愚蠢的做法，只需确保通过您自己的 GCD 串行队列进行协调访问（即，拥有一个专用队列，所有数据库交互都通过该队列进行）通过，优雅地完全消除了多线程问题）。遗憾的是，这不是一个选项，因为您正在尝试协调数据库与 iOS 本身的交互。

# java - 使列表视图项目可点击

> ID：11058099
> 
> 赞同：0
> 
> 时间：2012-06-15T20:57:25.223
> 
> 标签：java, listview, wicket, listviewitem, wicket-1.5

我想让列表视图的项目，即表格单元格，可点击，以便它们发送到另一个页面。谁能让我知道我的问题是什么？提前致谢。

那是html： http: [//pastebin.com/qUaPzTwv](http://pastebin.com/qUaPzTwv)

这就是我正在尝试的

```
 Application app = (Application) getApplication();
    MovieCollection col = app.getCollection();
    List<Movie> movies = col.getMovies();

    add(new ListView("movie_list", movies) {

        @Override
        protected void populateItem(ListItem item) {
            final Movie movie = (Movie) item.getModelObject();
            item.add(new Label("title", movie.getTitle()));
            item.add(new Label("year", Integer.toString(movie.getYear())));
            item.add(new Link("movie_link") {

                @Override
                public void onClick() {
                    setResponsePage(new MoviePage(movie));
                }
            });
        }
    }); 
```

这就是输出：

```
Last cause: Unable to find component with id 'title' in [ [Component id = movie_link]]
Expected: 'movie_list:0:movie_link.title'.
Found with similar names: 'movie_list:0:title', movie_list:1:title', movie_list:2:title' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:36:31.057

正如所评论的，发生这种情况是因为您的层次结构在 html 和 java 之间不匹配，这意味着如果您有一个带有 wicket:id 的元素，而其子元素带有 wicket:id，则必须将子元素添加到它们的父元素中。最终这就是您的页面的工作方式：页面只不过是一个带有子组件的组件，这就是您的 ListView 的工作方式。

```
 add(new ListView("movie_list", movies) {

    @Override
    protected void populateItem(ListItem item) {
        final Movie movie = (Movie) item.getModelObject();
        Link link = new Link("movie_link") {

            @Override
            public void onClick() {
                setResponsePage(new MoviePage(movie));
            }
        };
        item.add(link);
        link.add(new Label("year", Integer.toString(movie.getYear())));
        link.add(new Label("year", Integer.toString(movie.getYear())));
    }
}); 
```

您收到的错误为您提供了问题的答案。它为您提供组件路径，该路径是从组件返回页面的 wicket:id 列表。在这种情况下，它告诉您它期望“title”是“movie_link”的孩子，但发现它是 ListItem 的孩子（“0”代表 ListView 孩子的索引...... ListItems）

# c# - 如何从 HTML 网站调用 WCF 操作？

> ID：11058107
> 
> 赞同：0
> 
> 时间：2012-06-15T20:58:21.603
> 
> 标签：c#, wcf, web-services

我被困在一个小问题上，该问题停止了我正在尝试实现的功能的开发。

我目前有一个使用以下代码创建的 WCF Web 服务：

```
 [ServiceContract(Namespace = "http://Sinvise.Service/")]
    public interface ISinvise
    {
        [OperationContract]
        void Output(string value);
    }

    class SinviseService : ISinvise
    {
        second sec = new second();

        public void Output(string value)
        {
            sec.message(value);
        }
    } 
```

主要方法：

```
var ip = getIP();
            Uri baseAddr = new Uri("http://"+ip+":60185/Sinvise");
            ServiceHost localHost = new ServiceHost(typeof(SinviseService), baseAddr);
            Console.WriteLine("Current System IP: " + getIP());
            try
            {
                Process.Start(baseAddr.AbsoluteUri);
                localHost.AddServiceEndpoint(typeof(ISinvise), new BasicHttpBinding(), "SinviseService");

                ServiceMetadataBehavior smb = new ServiceMetadataBehavior();
                smb.HttpGetEnabled = true;
                localHost.Description.Behaviors.Add(smb);

                localHost.Open();
                Console.WriteLine("Service initialized.");
                Console.WriteLine("Press the ENTER key to terminate service.");
                Console.ReadLine();

                localHost.Close();
            }
            catch (CommunicationException ex)
            {
                Console.WriteLine("Oops! Exception: {0}", ex.Message);
                localHost.Abort();
            } 
```

应用程序设置要在我的应用程序中调用的 Web 服务，现在我要做的是使用 HTML 页面来调用操作。它们是将值传递给应用程序的简单操作。

现在我知道 HTML 自己无法做到这一点，并且 PHP 不会成为这方面的选择，因为它需要我在我的应用程序部署中打包一个 Web 服务器和 PHP（我不能这样做应用程序需要付费，因此不能包含开源软件）。

我在使用 jQuery 时遇到问题，因为它不能以跨域方式使用。

Web 服务与 ASP.NET 无关，但我需要一些允许我的软件用户能够使用 HTML 页面来调用 Web 服务的东西。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:05:43.570

如果我的理解是正确的并且基于此：

> 我在使用 jQuery 时遇到问题，因为它不能以跨域方式使用。

您的服务在另一个域中，然后以最简单的方式进行，在**您的域中**创建一个 REST 服务，然后**包装对外部服务的调用**

看到这个问题

这是创建 REST 服务的演练（没有 SVC 文件，可以在 ASP.Net 或 MVC 应用程序中使用）

[使用页面方法实现 Datalist 删除命令事件](https://stackoverflow.com/q/10893954/1268570)

这是一个完整的应用程序，您可以下载它使用 REST 服务

[http://sdrv.ms/LJJz1K](http://sdrv.ms/LJJz1K)

例子：

```
[ServiceContract]
public interface IMyService
{
    [OperationContract]
    [WebInvoke(
        ResponseFormat = WebMessageFormat.Json, 
        RequestFormat = WebMessageFormat.Json,
        UriTemplate = "/DeleteFromService",
        Method = "DELETE")]
    void Delete(int id);
}

[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class MyService : IMyService
{
    public void Delete(int id)
    {
        // wrap here the call to your external service
        // simulate a long process
        Thread.Sleep(5000);
    }
} 
```

在页面中

```
<script type="text/javascript" language="javascript">
        function deleteFromService() {
            $.blockUI();
            $.ajax({
                cache: false,
                type: "DELETE",
                async: true,
                url: "/DeleteFromService",
                data: "3", // get your id to delete
                contentType: "application/json",
                dataType: "json",
                success: function () {
                    $(document).ajaxStop($.unblockUI); 
                    alert("done");
                },
                error: function (xhr) {
                    $(document).ajaxStop($.unblockUI); 
                    alert(xhr.responseText);
                }
            });
        }
        jQuery().ready(function () {
                        $("#myButton").click(deleteFromService);
        });
    </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:01:50.933

如果您希望它不需要服务器端代码，您至少需要使用客户端代码。（JavaScript）。

以下是如何使用 JavaScript 直接调用 Web 服务的示例：http: [//dotnetbyexample.blogspot.com/2007/10/calling-asmx-web-services-directly-from.html](http://dotnetbyexample.blogspot.com/2007/10/calling-asmx-web-services-directly-from.html)

（比这更多的结果是一个[简单的搜索](http://www.bing.com/search?q=javascript%20calls%20to%20asp.net%20web%20service&qs=n&form=QBRE&pq=javascript%20calls%20to%20asp.net%20web%20service&sc=0-40&sp=-1&sk=)。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T21:04:47.303

如你所说：-

`I am having a problem using jQuery as it can not be used in a cross domain manner`

但是，这个问题似乎通过使用`ScriptManager`[ **Not Triedthough** ] 得到了解决。请参阅此处以逐步了解完整示例

*   [http://pranayamr.blogspot.co.uk/2011/06/calling-cross-domain-wcf-service-using.html](http://pranayamr.blogspot.co.uk/2011/06/calling-cross-domain-wcf-service-using.html)在标题下`Solution 2 : Call WCF Service by Javascript`

但是，请参考这两种解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T21:06:00.623

如果你现在真的想使用 HTML。你应该看看 REST 服务。看看 WCF 数据服务或 Asp.net WebApi。您可以找到许多教程，这些教程将帮助您轻松实现服务并让您在 HTML 中使用 jquery 进行查询。

# android - 从列表中删除项目

> ID：11058110
> 
> 赞同：0
> 
> 时间：2012-06-15T20:58:36.643
> 
> 标签：android, list, view, listitem

我正在创建一个扫描条形码、将它们保存在数据库中并通过列表管理它们的应用程序。所以，这些是对我的问题感兴趣的课程

主要的

```
@Override
  public void onCreate (Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.scanner_menu);

      Button addButton = (Button) findViewById (R.id.addMenuButton);
      addButton.setOnClickListener (new OnClickListener(){
          public void onClick (View v){
              startActivity(new Intent(CodiceBarreActivity.this, AggiungiCodiceActivity.class));
          }
          });

      Button listButton = (Button) findViewById (R.id.ViewlistButton);
      listButton.setOnClickListener (new OnClickListener(){
          public void onClick (View v){
              startActivity(new Intent(CodiceBarreActivity.this, ProdottiSelectionActivity.class));
          }
          });

  }   

static final class ProductData {
    long _id;
    String barcode;
    String format;
    String title;
    String price;
} 
```

}

帮手

```
 private SQLiteDatabase db;

public ProductDatabaseHelper(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
}

@Override
public void onCreate(SQLiteDatabase db) {
    StringBuilder sql = new StringBuilder();

    sql.append("create table ")
        .append(PRODUCT_TABLE)
        .append("(  ")
        .append("   _id integer primary key,")
        .append("   barcode text,")
        .append("   format text,")
        .append("   title text,")
        .append("   price text")
        .append(")  ");

    db.execSQL(sql.toString());    

    Log.d(TAG, PRODUCT_TABLE + "table created");
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
      db.execSQL("drop table if exists " + PRODUCT_TABLE);       
      Log.d(TAG, PRODUCT_TABLE + "table dropped");
        onCreate(db);
} 
```

D b

```
private static final String PRODUCT_TABLE = "products"; 
    private static final BigDecimal ONE_HUNDRED = new BigDecimal("100");
    private SQLiteDatabase db;

    public CodiciDatabase(Context context) {
        ProductDatabaseHelper helper = new ProductDatabaseHelper(context);
        db = helper.getWritableDatabase();
    }

    public boolean insert(ProductData product) {
        ContentValues vals = new ContentValues();
        vals.put("_id", product._id);
        vals.put("barcode", product.barcode);
        vals.put("format", product.format);
        vals.put("title", product.title);
        vals.put("price", product.price);

        return db.insert(PRODUCT_TABLE, null, vals) != -1;
    } 
```

感兴趣的班级

```
private ProductDatabaseHelper dbHelper;
private static final String PRODUCT_TABLE = "products"; 
ProductData product = new ProductData();

@Override
 protected void onCreate (Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    dbHelper = new ProductDatabaseHelper(this);
    }

@Override
protected void onResume(){
    super.onResume();
    SQLiteDatabase db = dbHelper.getReadableDatabase();

        Cursor cursor = db.rawQuery("select * from " + PRODUCT_TABLE, null);

        setListAdapter(new CursorAdapter(this, cursor, true) {
        @Override
        public View newView(Context context, Cursor cursor, ViewGroup parent){
            TextView textView = new TextView(ProdottiSelectionActivity.this);
            return textView;
        }

        @Override
        public void bindView (View view, Context context, Cursor cursor){

            TextView textView = (TextView) view;
            textView.append(cursor.getString(1));
            textView.append("\n");
            textView.append(cursor.getString(2));
            textView.append("\n");
            textView.append(cursor.getString(3));
            textView.append("\n");
            textView.append(cursor.getString(4));
            registerForContextMenu(textView); 
            }

        });
    }

@Override
protected void onDestroy(){
    super.onDestroy();
    dbHelper.close();
    }
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {

} 
```

}

我需要实现 onListItemClick 方法，以便您删除所选项目。我正在疯狂寻找正确的语法，希望您能帮助我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:04:13.620

像这样的东西应该工作：

```
db.delete("products", "barcode" + "="+ barcodeToDelete, null); 
```

将barcodeToDelte 替换为要从表中删除的条形码值。如果您不知道条形码的值，您也可以根据数据库中的任何其他字段将其删除，方法是在上述方法中将它们替换为“条形码”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:17:19.637

在我看来，您可能在“感兴趣的课程”中遇到错误。您的代码在某些地方有点混乱，我不确定您是否使用列表视图。但是使用列表视图并将其绑定到 onItemClickListener 会很有帮助。您将`extends ListActivity`在要显示项目的布局中使用，确保在列表视图布局中放置一个列表视图元素。然后填充您的列表视图，您将拥有：

```
 String[] tableColumnNames = new String[] {
                "TABLE COLUMN NAMES SEPARATED BY COMMAS" };
        int[] textViewLabelNames = new int[] { "NAMES OF TEXT VIEW LABELS IN XML ROW LAYOUT" };

        SimpleCursorAdapter stuff = new SimpleCursorAdapter(this,
                R.layout.your_created_xml_row_layout, cursor, tableColumnNames,
                textViewLabelNames);
        this.setListAdapter(stuff); 
```

然后绑定你的 onClickListener：

```
 listView.setOnItemClickListener(new OnItemClickListener() {

        //ListView item is clicked
        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

    }
    }); 
```

回顾您的代码：

当`onListItemClick is triggered`您需要从数据库中删除与传递给 onListItemClick 方法的 id 对应的行时。然后，您需要使用 更新光标以反映视图上的更改`cursor.requery()`。

因此，为了从具有特定 id 的数据库中删除项目，您可以执行以下操作：

```
ProductDatabaseHelper helper = new ProductDatabaseHelper(context);
SQLiteDatabase database = helper.getWritableDatabase();
database.delete("TABLE NAME HERE", "NAME OF ID COLUMN HERE" + "=" + id, null);
database.close(); 
```

您还可以查看[SQLiteDatabase 文档](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#delete%28java.lang.String,%20java.lang.String,%20java.lang.String%5B%5D%29)以获取有关方法签名的有用描述。

# php - FullCalendar 显示详细信息

> ID：11058111
> 
> 赞同：0
> 
> 时间：2012-06-15T20:58:55.693
> 
> 标签：php, javascript, jquery, fullcalendar

我真的很喜欢 fullcalendar 和它提供的各种功能。当视图在议程周或议程月上时，我想用它来显示每个事件的更多/自定义信息。检查这些不是问题。我可以使用轻松过滤视图表单

```
eventRender: function(event, element,view) { 
    if(view.name!="month"){
       //my code to come here        
    } 
```

问题是：我正在构建一个系统来跟踪用户的活动。例如，一天可能包含用户应该执行的 3 个活动。也许活动 1 从上午 9 点开始，活动 2 在上午 11:30 开始，最后活动 3 在下午 3 点开始。因此，该活动从上午 9 点到下午 3 点在一个街区内举行。我想自定义这个块并在每个活动开始时显示它们，也许要指示一个活动需要多长时间，我可能必须为每个活动包括不同的背景颜色。

注意：我只想创建一个事件，并设置样式以显示此活动。就像在现实生活中的会议一样，您有一个会议（事件）和多个议程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T03:57:24.680

看看下面的代码（[小提琴可用](http://jsfiddle.net/100thGear/Un6xs/)）。这向您展示了如何在渲染之前和之后编辑事件 DOM。

```
<div style="border:solid 2px red;">
    <div id='calendar'></div>
</div>
<script>
$(document).ready(function() {

    var date = new Date();
    var d = date.getDate();
    var m = date.getMonth();
    var y = date.getFullYear();

    $('#calendar').fullCalendar({
        header: {
            left: 'prev,next today',
            center: 'title',
            right: 'month,agendaWeek,agendaDay'
        },
        defaultView: 'agendaDay',
        editable: true,
        events: [
        {
            id: 1,
            title: "Meeting",
            start: new Date(y, m, d, 9, 0),
            end: new Date(y, m, d, 15, 0),
            allDay: false}
        ],
        eventRender: function(event, element, view) {
            element.find('.fc-event-content').append('<div class="fc-sub-event">9am - 11:30am</div>');
            element.find('.fc-event-content').append('<div class="fc-sub-event">11:30am - 1pm</div>');
            element.find('.fc-event-content').append('<div class="fc-sub-event">1pm - 3pm</div>');
        },
        eventAfterRender: function(event, element, view) {
            var eleHgt = element.height()/3.5;
            $('.fc-sub-event').height(eleHgt);
        }
    });
});
</script> 
```

然后，检查此代码（[小提琴](http://jsfiddle.net/100thGear/9BAZv/)）。这显示了如何格式化事件数据以概括此概念。

```
<div style="border:solid 2px red;">
    <div id='calendar'></div>
</div>
<script>
$(document).ready(function() {

    var date = new Date();
    var d = date.getDate();
    var m = date.getMonth();
    var y = date.getFullYear();

    $('#calendar').fullCalendar({
        header: {
            left: 'prev,next today',
            center: 'title',
            right: 'month,agendaWeek,agendaDay'
        },
        defaultView: 'agendaDay',
        editable: true,
        events: [
        {
            id: 1,
            title: '<div class="fc-event-title">Meeting</div><div class="fc-sub-event">9am - 11:30am</div><div class="fc-sub-event">11:30am - 1pm</div><div class="fc-sub-event">1pm - 3pm</div>',
            start: new Date(y, m, d, 9, 0),
            end: new Date(y, m, d, 15, 0),
            allDay: false}
        ],
        eventRender: function(event, element, view) {
            element.find('.fc-event-content').html(element.find('.fc-event-content').text());
        },
        eventAfterRender: function(event, element, view) {
            var eleHgt = element.height()/3.5;
            $('.fc-sub-event').height(eleHgt);
        }
    });
});
</script> 
```

# asp.net-mvc - 为位于子域上的图像在 http 和 https 之间切换

> ID：11058122
> 
> 赞同：4
> 
> 时间：2012-06-15T21:00:07.050
> 
> 标签：asp.net-mvc, asp.net-mvc-3, ssl

我的 ASP.NET MVC3 站点 www.mysite.com 从 images.mysite.com 中提取图像。当我没有登录我的网站并使用 SSL 时，它可以完美运行。但是，当登录时，它会得到

> 仅显示安全内容。

IE9 中的消息。我明白那个。为我的图像处理切换 URL 的最佳方法是什么？我是否应该检查我当前是否正在使用 SSL 并将我的图像指向[https://images.mysite.com](https://images.mysite.com)，否则指向[http://images.mysite.com](http://images.mysite.com)？

编辑：这是一个电子商务网站，所以大多数时候网站的浏览都是不安全的。但是登录后，我仍然需要提取一些相同的图像，当然，如果他们浏览回常规目录页面，则需要访问图像。也许我只需要始终使用[https://images.mysite.com](https://images.mysite.com)。只是看起来有点矫枉过正。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:05:30.183

我相信只有当您在通过 http 访问内容的安全页面中时才会出现问题。因此，对于可以在 http 或 https 中看到的页面，无论您使用的是 http 还是 https，都可能像使用 https 获取图像一样简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:06:19.393

如果您在通过 SSL 查看时从非 SSL 站点提取内容，您将始终收到该消息。如果您的站点主要受 SSL 保护，请始终从[https://images.mysite.com](https://images.mysite.com)拉取图像，因为如果您将 SSL 内容拉入非 SSL 站点，您不会收到错误消息。

否则，您将需要知道哪些页面只能通过 SSL 查看，哪些不能，并进行适当的链接。

最后，如果您的站点在两者上都可用，您可能需要查看[HTTPS 服务器变量](http://msdn.microsoft.com/en-us/library/ms524602%28v=vs.90%29.aspx)以确定您是否使用 SSL，并使用它来确定您的链接（http 或 https）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-13T17:40:45.780

您是否尝试使用 ~ 而不是 ../ 或 / 作为前缀？这对我有用。

# ruby-on-rails - 关于 Rails 渲染调用的问题

> ID：11058123
> 
> 赞同：0
> 
> 时间：2012-06-15T21:00:10.707
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在代码中看到以下行时：

```
<%= render :partial => 'ingredients/form',
           :locals => {:form => recipe_form} %> 
```

我想知道实际发生了什么。

1.  我注意到`render`是`RenderingHelper`. 我如何知道在写作时可以使用哪个对象？我怎样才能`RenderingHelper`像在Java（即`RenderingHelper.render`）中那样使用它而不使用前缀。我是否在表单视图中继承了它？

2.  由于我知道Java和C#，所以我在代码中搜索`ingredients/form`并找不到它。我猜这是配置规则约定的一部分。它是什么？它在哪里定义？

3.  关于`:locals => {:form => recipe_form}`线路，是发送到的参数`render`吗？是双重任务吗？`=>`操作员在这里实际上做了什么？

4.  如果它是一个参数，从`render`签名中很难理解：

    > 返回由选项哈希指定的渲染结果。主要选项是：
    > 
    > *   `:partial`- 见`ActionView::PartialRenderer`。
    > *   `:file`- 渲染一个显式模板文件（这曾经是旧的默认值），添加`:locals`以传递那些。
    > *   `:inline`- 呈现一个内联模板，类似于它在控制器中的完成方式。
    > *   `:text`- 渲染传入的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:11:47.250

以后，请尝试在每个帖子中提出一个问题。

1.  `RenderingHelper`是一个模块，它的方法可以通过某个`include`地方获得。阅读有关 Ruby[模块](http://www.rubycentral.com/pickaxe/tut_modules.html)如何工作的更多信息。
2.  部分文件名始终带有下划线前缀，您的部分文件名将位于`app/views/ingredients/_form.html.erb`
3.  `:form`和都是`:locals`传递给渲染的选项哈希中的键；对应的值`:locals`是一个嵌套散列，其中包含一个键，`:form`其值是一个名为 的局部变量`recipe_form`。如果您明确指定一些可选的标点符号，这可能会更明显：

    ```
    <%= render({:partial => 'ingredients/form', :locals => {:form => recipe_form}}) %> 
    ```

4.  Ruby（尤其是 Rails）使用键/值散列形式的可变长度参数列表。一旦您了解了基本语法，它们就不难使用或理解

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:12:07.793

**2.** `"ingredients/form"`不是代码——它是一个字符串。它指的`_form`是模型的部分`ingredient`。它位于`app/views/ingredients/_form.erb.html`.

**3.** `:locals => { ... }`表示该`render`函数正在获取一个以符号`:locals`为键的地图条目。`render`知道如何处理该地图。

这不是“双重赋值”，而是`:locals`键的值*也是*一个映射。`=>`，或“散列火箭”，是 Ruby 1.8/1.9 语法，用于将映射值分配给映射键。在 Ruby 1.9 中，您可以使用快捷方式`locals: { ... }`.

^(*（更具可读性的 IMO 取决于值——当值是键时，我认为新语法是令人发指的，否则我喜欢它。）*)

**4.**签名难懂怎么办？参数是选项的散列。

# c# - 为什么任务没有执行？

> ID：11058126
> 
> 赞同：0
> 
> 时间：2012-06-15T21:00:36.703
> 
> 标签：c#, multithreading, task

我有以下代码：

```
class Program
{
    static void Main(string[] args)
    {

        Task[] tasks = new Task[3]
                        {
                            Task.Factory.StartNew(() => Console.WriteLine("Hello A")),
                            Task.Factory.StartNew(() => Console.WriteLine("Hello B")),
                            Task.Factory.StartNew(() => Console.WriteLine("Hello C"))
                        };
        Task.WaitAll(tasks); 
        Console.WriteLine("Hi ABC");
    }
} 
```

我构建并运行上面的代码，它给出了输出：
Hello C
Hello B
Hello A
Hi ABC

但如果我评论 Task.WaitAll(tasks)，输出之一是：
Hi ABC
Hello B
Hello C

这是否意味着当 Console.WriteLine("Hi ABC") 完成执行时，执行 Console.WriteLine("Hello A") 的线程没有机会完成执行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T21:03:41.620

对，那是正确的。您的主线程在子线程完成之前终止进程 - 或在某些情况下启动。如果你不做任何事情来保持主线程忙碌，那么当主线程终止时（在“Hi ABC”之后），进程终止将杀死所有未完成的线程。如果 A 线程（或任何子线程）还没有被调度，那么它根本没有机会输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T21:02:51.750

如果您不等待任务，则所有四个线程（三个任务加上主线程）同时运行。

由于主线程不需要启动，它很可能首先到达 print 语句。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-15T21:03:48.200

这意味着线程结束或在程序完成后被杀死。您应该添加 Console.ReadLine(); 手动等待，您会看到它们都结束了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-15T21:03:57.393

没有`WaitAll`，执行将正常继续。在您的 last 之后`Console.WriteLine`，应用程序将终止，因为它已到达程序的末尾。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-15T21:10:17.787

您在这里拥有的是所谓的“竞争条件”。换句话说， 、 、 和 的顺序`Hello A`是`Hello B`任意`Hello C`的`Hi ABC`，并且可以根据哪个线程先完成而改变。所以不同的运行可能会产生不同的结果。

发生的事情是您正在关闭这些线程，然后继续执行程序。在这种情况下，您的竞争条件是哪些线程可以在主执行线程死亡（程序结束）被杀死之前打印它们的输出。主线程的输出不能保证是第一个，但是因为它从启动开始的开销较小，所以它很可能是第一个。`Task.WaitAll`您可以通过将 更改为 a来测试这一点，并在修改传递给该方法`System.Threading.Thread.Sleep(200)`的毫秒数时查看输出结果。`Sleep`

无需等待，主线程就会杀死子线程，无论它们处于何种状态。在您提到的情况下，线程 B 和 C 已`Console.WriteLine('Hi ABC')`在程序结束之间完成。线程 A 没有完成，所以它还没来得及输出就被杀死了。

# fonts - CoronaSDK 更改字体样式

> ID：11058127
> 
> 赞同：1
> 
> 时间：2012-06-15T21:00:52.300
> 
> 标签：fonts, lua, coronasdk

我一直在查看 Corona 文档，但没有看到任何可以更改 display.newText 对象的字体样式的内容。我知道当你第一次创建对象时，你可以将字体参数设置为你喜欢的任何值。我知道您还可以通过将字体名称添加到构建设置文件来进行自定义字体。但是，我想要做的是在 display.newText 已经声明之后更改文本的字体样式。我正在尝试的是：

```
local text = display.newText("title", display.contentWidth/2, display.contentHeight/2, native.systemFont, 12)

text.font = "Comic Sans MS" 
```

上面的代码在终端中没有给出任何错误，但字体没有改变。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T05:10:26.223

请参阅这篇关于如何使用自定义字体 [http://www.coronalabs.com/blog/2011/07/13/custom-fonts-corona/](http://www.coronalabs.com/blog/2011/07/13/custom-fonts-corona/)

编辑

行。我没有完全阅读你的问题。您想即时更改字体。我想唯一的方法是删除显示对象并用新字体重新插入它。

就像是

```
local text = display.newText("title", display.contentWidth/2, display.contentHeight/2, native.systemFont, 12)

--After some time
local txt = text.text
local size = text.size
local left = text.contentBounds.xMin
local top  = text.contentBounds.yMin 

text:removeSelf()
text = display.newText(txt, left, top, "Comic Sans MS",size) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T23:13:02.983

[Text 对象不支持这一点。](http://developer.anscamobile.com/content/text-display-objects). 它通常有一个贫乏的界面（您可以在该页面上看到 5 个月前的相关投诉）。[也见这里。](http://developer.anscamobile.com/forum/2010/03/03/set-font-text-object-iterate-over-obejct-properties)

（旁注：如果您是一位相当有经验的开发人员并且还没有深入到某个项目中，那么另一种选择是切换到 MOAI，它是免费的、开源的，具有更重要的、灵活的 API。您会完全控制文本（[MOAITextBox](http://getmoai.com/docs/class_m_o_a_i_text_box.html)，[MOAITextStyle](http://getmoai.com/docs/class_m_o_a_i_text_style.html)，[MOAIFont](http://getmoai.com/docs/class_m_o_a_i_font.html)）等等。但是，它也*不太*用户友好。）

# nltk - 由于 JVM 参数，nltk 中的斯坦福标记器无法正常工作

> ID：11058128
> 
> 赞同：1
> 
> 时间：2012-06-15T21:00:54.933
> 
> 标签：nltk, stanford-nlp, jvm-arguments

运行以下示例代码片段时出现有线错误

```
st = StanfordTagger('bidirectional-distsim-wsj-0-18.tagger')
st.tag('What is the airspeed of an unladen swallow ?'.split()) 
```

第一行工作正常，但第二行出现以下错误。

```
Could not create the Java virtual machine.

Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "/usr/local/lib/python2.6/dist-packages/nltk-2.0.1rc1-   py2.6.egg/nltk/tag/stanford.py", line 51, in tag
return self.batch_tag([tokens])[0]
File "/usr/local/lib/python2.6/dist-packages/nltk-2.0.1rc1-py2.6.egg/nltk/tag/stanford.py", line 77, in batch_tag
stdout=PIPE, stderr=PIPE)
File "/usr/local/lib/python2.6/dist-packages/nltk-2.0.1rc1-py2.6.egg/nltk/internals.py", line 166, in java
raise OSError('Java command failed!')
OSError: Java command failed! 
```

我尝试将 .usr/lib/jvm 添加到路径中，但仍然无法正常工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T07:11:37.443

它也不适合我。所以我尝试了以下方法，它工作得很好。

```
st = POSTagger('path-to/stanford-postagger-full-2012-07-09/models/wsj-0-18-left3words.tagger','path-to/stanford-postagger-full-2012-07-09/stanford-postagger.jar') 
```

并使用 nltk 的 tokenize 方法而不是 Python 的 split()

```
taggedSentence= st.tag(nltk.word_tokenize(sentence)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-27T23:02:34.900

*我看到这个问题已经过时了，但是这几天我因为未知原因遇到了同样的错误。这让我很头疼。**但我找到了解决方案。***

首先，我安装了 Oracle Java（这里是说明：[如何在 Debian 或 Ubuntu VPS 上手动安装 Oracle Java](https://www.digitalocean.com/community/tutorials/how-to-manually-install-oracle-java-on-a-debian-or-ubuntu-vps)）

现在，我的 python 脚本告诉了我更多关于错误的信息。它输出如下内容：

```
Forking JVM: error=12, Cannot allocate memory or error=12, Not enough space 
```

在这里您可以阅读有关此类问题的更多信息：[Forking the JVM](http://bryanmarty.com/2012/01/14/forking-jvm/)

为了避免那个烦人的错误，我需要编辑`/etc/sysctl.conf`并添加以下内容：

```
vm.overcommit_memory = 1 
```

然后重新启动系统以使更改生效。

# symfony - KnpPaginator 和原生查询

> ID：11058130
> 
> 赞同：5
> 
> 时间：2012-06-15T21:01:05.020
> 
> 标签：symfony, doctrine-orm, bundle, nativequery, knppaginator

我在 Symfony2 项目中使用 KnpPaginatorBundle。当我尝试将 Doctrine 2 本机查询传递给分页器实例时，出现错误：

```
One of listeners must count and slice given target 
```

有没有人为一些本机查询正确实现这个的一些例子？

在捆绑的文档中，我看到了示例（[https://github.com/KnpLabs/KnpPaginatorBundle/blob/master/Resources/doc/custom_pagination_subscribers.md](https://github.com/KnpLabs/KnpPaginatorBundle/blob/master/Resources/doc/custom_pagination_subscribers.md)），但仅适用于文件系统，我不知道如何将其转换为数据库查询。

你能帮我吗？

**编辑**

我的查询：

```
SELECT a.*, highest_rated_book.*
  FROM authors a
  LEFT JOIN (SELECT * FROM books b ORDER BY b.rate DESC) AS highest_rated_book
  ON a.id = highest_rated_book.author_id
  GROUP BY highest_rated_book.author_id
  ORDER BY a.id; 
```

和表格：

```
author (id, first_name, last_name)
books (id, title, rate, author_id) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-24T01:12:57.613

不幸的是，该捆绑包不适用于本机查询。最好的解决方案（尽管它加载了许多不需要的行）是从查询中获取结果并对结果数组进行分页。

我大约五分钟前遇到了这个问题，参考：[https ://groups.google.com/forum/#!msg/symfony2/cgYHeKej7jc/y9dHX-qvTU4J](https://groups.google.com/forum/#!msg/symfony2/cgYHeKej7jc/y9dHX-qvTU4J)

# javascript - 使用 JavaScript 绑定到 OPOS MSR DataEvent？

> ID：11058132
> 
> 赞同：1
> 
> 时间：2012-06-15T21:01:06.530
> 
> 标签：javascript, activex, opos

我已经实现了一个 MSR OPOS ActiveX 控件，用于基于 IE 的 Web 应用程序。我已经测试了该设备并且可以正常工作；但是，我正在尝试将[此处](http://www2.clearlake.ibm.com/store/support/tools/msrexample.html)找到的 VBScript 代码移植到 JavaScript，以便于维护。

不过，我在绑定到`DataEvent`with JavaScript 时遇到了麻烦——当我将卡片放到读卡器上时，数据肯定会出现，因为我可以通过控制台直接查询对象`ReaderControl.Track1Data`并看到那里实际上有数据。

在 VBScript 版本中，似乎有一个调用方法`[control]_DataEvent`，您可以简单地覆盖它以绑定到事件。我已经尝试过了，由于某种原因，`ReaderControl.attachEvent("DataEvent", function() { alert(ReaderControl.Track1Data); })`它似乎*确实有效，***只有**在随后设置时才有效`ReaderControl.DataEventEnabled = true;`。

有任何想法吗？

# php - mysql_query 错误

> ID：11058137
> 
> 赞同：1
> 
> 时间：2012-06-15T21:01:59.230
> 
> 标签：php, mysql

我对这个 mysql_query 有一个问题：

```
$selectNewsComments = mysql_query("
SELECT user_id, comment, time_add 
FROM news_comments 
ORDER BY id DESC 
LIMIT " .($pageNum - 1) * $numberOfNewsInPage . ", ".$numberOfNewsInPage." 
WHERE news_id = '".$nid."'
") or die(mysql_error()); 
```

那是错误信息：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'WHERE news_id = '18'' 附近使用正确的语法

有人能告诉我这个问题是从哪里来的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T21:03:55.673

你`ORDER BY id DESC LIMIT`应该去追求`WHERE`

> 警告：问题的示例代码使用 PHP 的 mysql 扩展，该扩展在 PHP 5.5.0 中已被弃用，并在 PHP 7.0.0 中完全删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:04:08.333

该`WHERE`子句应该放在前面`ORDER BY`。

```
mysql_query("SELECT user_id, comment, time_add FROM news_comments WHERE news_id = '".$nid."'ORDER BY id DESC LIMIT " .($pageNum - 1) * $numberOfNewsInPage . ", ".$numberOfNewsInPage) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-08T07:18:00.753

改用这个

```
$selectNewsComments = mysql_query("
SELECT user_id, comment, time_add 
FROM news_comments 
LIMIT " .($pageNum - 1) * $numberOfNewsInPage . ", ".$numberOfNewsInPage." 
WHERE news_id = '".$nid."'
ORDER BY id DESC 
") or die(mysql_error()); 
```

我改变的是：
我放在`ORDER BY id DESC`查询的末尾应该在哪里，这样它就可以工作了

# ruby-on-rails - 只用神来杀人

> ID：11058139
> 
> 赞同：11
> 
> 时间：2012-06-15T21:02:03.913
> 
> 标签：ruby-on-rails, ruby, god

我使用乘客服务我的软件。它产生了许多 ruby​​ 进程。

有时，其中一颗红宝石变得臃肿，我希望它死掉。

我希望用上帝来达到这个目的。我的想法是监控所有这些红宝石，如果它在 3 个周期内消耗超过 500MB 的内存，上帝应该尝试优雅地杀死它。如果它存活超过 5 分钟，那么上帝应该不会优雅地杀死它。

在我看来，上帝总是试图再次运行该服务，因此它迫使我们提供启动命令。是否可以只使用上帝来杀死行为不良的进程并让乘客产卵器在必要时让它们恢复活力？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T21:49:02.427

你的问题的答案在于问题本身。[你可以使用god gem](https://rubygems.org/gems/god)杀死 ruby​​ 进程，这是 github 家伙的 ruby​​ 进程监控框架。

基本上，这是它的工作原理：

1.  配置上帝来监控进程，它可以是 apache、passenger、mongrel 中的任何内容，也可以是执行长时间运行任务的简单文件。
2.  在上帝的配置文件中设置条件，根据哪个上帝将执行一些预定义的代码。

这是一个简单的例子（取自[docs](http://godrb.com/)）。将其视为文件长时间运行的进程，我们要监视它的内存使用情况，我们要监控它的内存使用情况，让我们称之为`simple.rb`

```
loop do
  puts 'Hello'
  sleep 1
end 
```

现在，我们安装`god`gem 并将其配置为以超级用户身份运行，以便它可以杀死/生成进程并接下来创建一个配置文件。示例（也取自[文档](http://godrb.com/)）：

```
God.watch do |w|
  w.name = "simple"
  w.start = "ruby /full/path/to/simple.rb"
  w.keepalive(:memory_max => 500.megabytes)
end 
```

在这里，您可能已经知道如果进程内存使用量超过 500 兆字节，上帝会重新启动它。如果您开始使用`god`gem 进行流程管理，这里有一些资源可能会有所帮助：

*   [示例要点 - 乘客工作监视器以杀死使用过多 RAM 的工作人员](https://gist.github.com/213628)（不要使用上帝，而是产生一个新的乘客工作人员）
*   [项目主页](http://godrb.com/)
*   [Github 页面](https://github.com/mojombo/god)
*   [使用 God 与 Rails & Passenger 的深入教程](http://www.tatvartha.com/2010/09/monitoring-rails-processes-apache-passenger-delayed_job-using-god-and-capistrano-2/)

现在，请记住*所有*配置`god`实际上是合法的 ruby​​ 代码，这样您就可以发挥创意并做各种事情。

最后，如果您经常发现自己运行长时间运行的进程，我建议您尝试[JRuby](http://jruby.org/)，由于 JVM 和 LOT 比 MRI 更快，它更适合长时间运行的进程

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T16:01:51.910

I use the same setup on many of my projects and had the same memory leaking issues. After messing around with monitoring, we decided to use the passenger features to tackle it. Specifically it allows the setting (e.g.) `PassengerMaxRequests 300` which shuts down any instance when it has served that number of requests.

If you use it, make sure that `PassengerMinInstances` is set to 0 because it preceedes the setting for max requests.

# sugarcrm - SugarCrm 与其他应用程序同步

> ID：11058140
> 
> 赞同：1
> 
> 时间：2012-06-15T21:02:05.327
> 
> 标签：sugarcrm

我是 SugarCRM 的新手，我在我的网站上创建了 SugarCRM 的网络引导表单，该表单有四个字段，即名字、姓氏、地址和电话。提交此信息后，将在潜在客户列表中的 SugarCRM 中更新。现在的要求是，每当 SugarCRM 上发生任何更新时，我都必须更新其他数据源，在本例中为 marklogic。我想保留有关糖和标记逻辑的相同数据。

每当任何更新触发 SugarCRM 时，它都应该向 marklogic 发送一些带有更新信息的 web 服务或其他方法，以便 marklogic 数据应该是同步的。

我怎样才能做到这一点？任何建议都会有很大帮助。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T18:24:19.067

查看 MarkLogic 6 中的新 REST 接口，特别是 CRUD API。使用这些，您应该能够非常轻松地对数据库进行 Web 服务更新，而无需编写任何 xQuery。

[http://developer.marklogic.com/try/rest/index](http://developer.marklogic.com/try/rest/index)

# box-api - 文件夹对象的文件大小信息

> ID：11058154
> 
> 赞同：2
> 
> 时间：2012-06-15T21:02:56.673
> 
> 标签：box-api

对于 Folder 对象，它列出了该文件夹 (item_collection) 下的文件，以及文件名和文件 ID。还包括文件大小会很有帮助，因为目前需要查询每个文件以获取大小。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T23:42:53.397

感谢您的反馈。我们收到了很多过滤在 GET /folders 调用中返回的项目集合的请求，因此这将有助于告知我们最终构建的内容。

# twitter-bootstrap - 响应式设计（使用 Twitter Bootrstap）在浏览器宽度变化时发生变化，但在 iPhone 4s 上没有

> ID：11058155
> 
> 赞同：1
> 
> 时间：2012-06-15T21:03:00.367
> 
> 标签：twitter-bootstrap, responsive-design, media-queries

我在这里设计了一个响应式网站：http: [//zarin.me/cce/](http://zarin.me/cce/)

我使用 Twitter Bootstrap 进行响应式设计。响应式断点之一位于 641px（请参阅[http://zarin.me/cce/css/responsive.css](http://zarin.me/cce/css/responsive.css)），当我更改笔记本电脑上的浏览器宽度时，它非常有用。

但是，当我在 iPhone 4s 上访问该网站时，响应式设计并没有改变。我还将断点设置为 480px，但没有运气。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:05:48.327

您需要一个视口元标记来通知移动浏览器该网站与移动设备兼容，否则移动设备会尝试显示 900 像素，而 css 会认为设备是 900 像素

在你的脑海里试试这个

```
<meta content="width=device-width, initial-scale=1.0" name="viewport"> 
```

# c# - 我的第一个 c# 应用程序和第一个空对象异常

> ID：11058158
> 
> 赞同：4
> 
> 时间：2012-06-15T21:03:36.803
> 
> 标签：c#, oop

总菜鸟在这里。这是我第一次尝试 C#，它是一个控制台应用程序，可以模拟一个名为“Left Right Center”的饮酒游戏。在控制台中，我收到以下信息：

**安慰**

```
Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object
at LeftRightCenter.MainClass.Main (System.String[] args) [0x00038] in     /Users/apple/Projects/LearningC/LearningC/Main.cs:80 
[ERROR] FATAL UNHANDLED EXCEPTION: System.NullReferenceException: Object reference not set to an instance of an object
 at LeftRightCenter.MainClass.Main (System.String[] args) [0x00038] in /Users/apple/Projects/LearningC/LearningC/Main.cs:80 
```

**C＃**

```
 using System;

    namespace LeftRightCenter
    {
        class Player
        {
            //fields        
            private int _quarters = 4;

            public int Quarters {
                get{ return _quarters; }
                set{ _quarters += value; }
            }

            public Player (string name)
            {

            }   

        }
        class Dice
        {
            Random random = new Random();
            public int Roll ()
            {
                random = new Random ();
                int diceSide;
                diceSide = random.Next (0, 6);
                diceSide = (diceSide > 2) ? 3 : diceSide;
                return diceSide;            
            }
        }
        class MainClass
        {
            static int activePlayer = 0;
            static int theCup       = 0;

            static Player[] thePlayers = { 
                new Player ("Jessica"), 
                new Player ("Isaac"), 
                new Player ("Ed"), 
                new Player ("Bella"),
                new Player ("Elisa"),
                new Player ("Fake RedHead"),
                new Player ("Linda"),
                new Player ("MJ"),
                new Player ("Irene"),
                new Player("Devin")
            };

            static Dice[] theDice = new Dice[2];

            private static void MoveQuarter (int direction)
            {
                int numberOfPlayers = thePlayers.Length - 1;
                switch (direction) {
                case 0: 
                    thePlayers [activePlayer].Quarters = -1;
                    theCup++;
                    break;
                case 1:
                    thePlayers [activePlayer].Quarters = -1;
                    int leftPlayer = (activePlayer == 0) ? numberOfPlayers : activePlayer - 1;
                    thePlayers [leftPlayer].Quarters = +1;
                    break;
                case 2:
                    thePlayers [activePlayer].Quarters = -1;
                    int rightPlayer = (activePlayer == numberOfPlayers) ? 0 : activePlayer + 1;
                    thePlayers [rightPlayer].Quarters = +1;
                    break;                          
                }           
            }

            public static void Main (string[] args)
            {
                int cupEndPoint = thePlayers.Length * 4 - 1;
                while (theCup < cupEndPoint) {
                    foreach (Dice rattle in theDice) {
                        if (thePlayers [activePlayer].Quarters > 0) {
                            MoveQuarter (rattle.Roll ()); // this line seems to be the problem  
                        }                   
                    }
                    Console.WriteLine ("{0} Quarters In the Cup", theCup);
                }

            }
        }
    } 
```

我不知道问题是什么或为什么，而且我的谷歌搜索证明更多的使用令人困惑而不是有用。

**对于那些好奇的人，我现在很少做实验**

[http://pastebin.com/jxCCW2cd](http://pastebin.com/jxCCW2cd)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T21:07:44.613

这条线

```
static Dice[] theDice = new Dice[2]; 
```

声明了一个数组，允许存储 Dice 类的 2 个对象，但该数组中的每个值仍然为空。

在 Main 方法内的 foreach 循环中使用它之前，您需要在数组的每个插槽上创建一个 Dice。

```
theDice[0] = new Dice();
theDice[1] = new Dice(); 
```

如果你停止调试器就行了

```
 MoveQuarter (rattle.Roll ()); 
```

您将看到`rattle`Dice 为空。

编辑：查看您的代码，我发现有问题的情况在 Roll 方法中，您重新创建了 Random 生成器，这对随机性没有好处。[（请参阅此问题中已接受的答案）](https://stackoverflow.com/questions/2706500/how-to-generate-random-int-number-c)
最后，可以按照您已经为 thePlayers 数组所做的相同方式创建和初始化 theDice 数组

```
static Dice[] theDice = new Dice[2] {new Dice(), new Dice()}; 
```

这是您的 Dice 课程的完整修订版

```
class Dice 
{
    private static Random random;
    public  Dice()
    {
           // create the static random generator only on the first instance
        if(random == null) random = new Random();
    }

    public int Roll () 
    { 
        int diceSide; 
        diceSide = random.Next (1, 7); 
        diceSide = (diceSide > 2) ? 3 : diceSide; 
        return diceSide;             
    } 
} 
```

# php - PHP - ssh2 读取输出流

> ID：11058165
> 
> 赞同：1
> 
> 时间：2012-06-15T21:04:04.477
> 
> 标签：php, ssh

我无法在 PHP 中显示 SSH 流的输出。这是我的代码：

```
$output = ssh2_exec($sshCon, $sshCommand);

stream_set_blocking($output, true);

echo stream_get_contents($output); 
```

输出为空白。该命令肯定正在运行。我也尝试了这里给出的解决方案： [Empty PHP SSH2 stream contents, even with stream_set_blocking?](https://stackoverflow.com/questions/1548675/empty-php-ssh2-stream-contents-even-with-stream-set-blocking)

输出应该是进程 ID，只是为了让您知道。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T20:41:41.633

试试[phpseclib，一个纯 PHP SSH 实现](http://phpseclib.sourceforge.net/)：

```
<?php
include('Net/SSH2.php');

$ssh = new Net_SSH2('www.domain.tld');
if (!$ssh->login('username', 'password')) {
    exit('Login Failed');
}

echo $ssh->exec($sshCommand);
?> 
```

# objective-c - DrawRect 添加文字阴影

> ID：11058167
> 
> 赞同：0
> 
> 时间：2012-06-15T21:04:13.377
> 
> 标签：objective-c, ios, drawrect, dropshadow

我第一次在自定义中使用 -drawRect `UITableViewCell`，我想知道如何将 1px dropShadows 添加到所有正在绘制的文本和图像（`self.image`）中。

提前致谢。

```
- (void) drawRect:(CGRect) rect {

    CGContextRef context = UIGraphicsGetCurrentContext();
    [[UIColor clearColor] set];
    CGContextFillRect(context, rect);

    if (shouldDrawImage == YES) {
        CGContextDrawImage(context, CGRectMake(10, 10, 40, 40), self.image.CGImage);
    }

    CGContextDrawImage(context, CGRectMake(self.frame.size.width - 16, 0, 16, self.frame.size.height), [UIImage imageNamed:@"right_bar_including_holes"].CGImage);      
    NSString *authorName = [[self.info objectForKey:@"user"] objectForKey:@"full_name"];

    [RGB(219, 240, 73) set];

    CGSize maximumLabelSize = CGSizeMake(self.frame.size.width - 10 - 55 - 16,9999);
    CGSize authorsize = [authorName sizeWithFont:[UIFont boldSystemFontOfSize:15]
                                     constrainedToSize:maximumLabelSize 
                                         lineBreakMode:UILineBreakModeWordWrap]; 
    [authorName drawInRect:CGRectMake(60, 10, self.frame.size.width - 60, authorsize.height) withFont:[UIFont boldSystemFontOfSize:15]];

    [RGB(249,249,249) set];

    NSString *description = [self.info objectForKey:@"description"];
    CGSize descriptionSize = [description sizeWithFont:[UIFont systemFontOfSize:14] constrainedToSize:maximumLabelSize lineBreakMode:UILineBreakModeWordWrap];

    [description drawInRect:CGRectMake(60, authorsize.height + 15, descriptionSize.width, descriptionSize.height) withFont:[UIFont systemFontOfSize:14]];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:06:53.513

采用：

```
CGContextSaveGState(context);
CGContextSetShadow(context, CGSizeMake(1,1),1);
//draw text here
CGContextRestoreGState(context); 
```

第一个参数是context，第二个参数是offset，第三个参数是blur。

[Quartz2d 阴影文档](https://developer.apple.com/library/mac/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_shadows/dq_shadows.html)

# rspec - NoMethodError：未定义的方法“描述”主要：textmate中的对象错误

> ID：11058170
> 
> 赞同：0
> 
> 时间：2012-06-15T21:04:23.070
> 
> 标签：rspec

我正在尝试运行 rspec 测试，但我似乎无法让它在我的 Mac 上运行？

该`player_spec.rb`文件包含：

```
require 'player'

describe Player do

end 
```

所有其他相关文件都在同一个文件夹中

`rspec player_spec.rb`从命令行运行会产生以下错误：

```
/Users/lloyd_treleven/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in
`require': cannot load such file -- player (LoadError)
  from
/Users/lloyd_treleven/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in
`require'
  from /Users/lloyd_treleven/studio_game/player_spec.rb:1:in `<top
(required)>'
  from
/Users/lloyd_treleven/.rvm/gems/ruby-1.9.3-p194/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in
`load'
  from
/Users/lloyd_treleven/.rvm/gems/ruby-1.9.3-p194/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in
`block in load_spec_files'
  from
/Users/lloyd_treleven/.rvm/gems/ruby-1.9.3-p194/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in
`map'
  from
/Users/lloyd_treleven/.rvm/gems/ruby-1.9.3-p194/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in
`load_spec_files'
  from
/Users/lloyd_treleven/.rvm/gems/ruby-1.9.3-p194/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:22:in
`run'
  from
/Users/lloyd_treleven/.rvm/gems/ruby-1.9.3-p194/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:69:in
`run'
  from
/Users/lloyd_treleven/.rvm/gems/ruby-1.9.3-p194/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:10:in
`block in autorun' 
```

我安装了以下 rspec gem

```
rspec (2.10.0)
rspec-core (2.10.1)
rspec-expectations (2.10.0)
rspec-mocks (2.10.1) 
```

目前我已经`rvm 1.13.4`安装

目前我正在跑步`ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin10.8.0]`

当我通过 textmate 运行时，我收到以下错误消息：

```
NoMethodError: undefined method ‘describe’ for main:Object 
```

我安装了 RSpec textmate 包：

```
mkdir -p ~/Library/Application\ Support/TextMate/Pristine\ Copy/Bundles
cd ~/Library/Application\ Support/TextMate/Pristine\ Copy/Bundles
git clone git://github.com/rspec/rspec-tmbundle.git RSpec.tmbundle
osascript -e 'tell app "TextMate" to reload bundles' 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T15:22:22.107

找到我需要在 ruby​​ 文件顶部添加 require_relative 'player' 的答案了吗？一旦我这样做了，我就可以从命令行运行 rspec player_spec.rb 并执行测试。TextMate 仍然抛出 NoMethodError 错误。我将检查 textmate rspec bundle 安装，看看这是否正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-28T21:00:28.893

我最近遇到了类似的事情，看起来你有两个问题：

1.  文件加载错误：rspec 找不到您的`player.rb`文件
2.  缺少方法错误：rspec 对谁负责该`describe`块感到困惑

由于我不确定您的文件树是如何设置的，我们就说它看起来像这样：

```
/studio_game
  /lib
    player.rb
  /spec
    player_spec.rb
    spec_helper.rb
  Gemfile
  Gemfile.lock
  .rspec 
```

要解决您的问题`LoadError`，您需要确保您的`player_spec.rb`文件可以找到您的`player.rb`文件。你可以这样做...

```
# like this:
require_relative '../lib/player'

# or like this:
require 'player' 
```

现在开始解决您缺少的`describe`方法错误。当我遇到这个问题时，我发现我的`.rspec`文件需要`spec_helper`，如下所示：

```
--require spec_helper  #<-- problematic for me
--color
--format doc 
```

一旦我删除它，我的 rspec 套件就可以正确运行。

```
--color
--format doc 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-05-04T18:24:42.900

您必须使用终端访问当前子文件夹：例如“lib”或“spec” 我得到了同样的错误，并且花了很长时间才发现：`cd spec` 然后`rspec 00_hello_spec.rb` 为我工作！

# java - 每秒更新 GUI 的 Java 秒表？

> ID：11058172
> 
> 赞同：5
> 
> 时间：2012-06-15T21:04:30.853
> 
> 标签：java, swing, user-interface, stopwatch

我是一名 Java 初学者，我正在尝试构建一个简单的秒表程序，以在摆动 GUI 上显示时间。制作秒表很容易，但是我找不到一种方法让 GUI 每秒更新一次并在秒表上显示当前时间。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T21:13:16.580

沿着这些路线的东西应该这样做：

```
import java.awt.EventQueue;
import java.util.Timer;
import java.util.TimerTask;
import javax.swing.JFrame;
import javax.swing.JLabel;

/** @see https://stackoverflow.com/a/11058263/230513 */
public class Clock {

    private Timer timer = new Timer();
    private JLabel timeLabel = new JLabel(" ", JLabel.CENTER);

    public Clock() {
        JFrame f = new JFrame("Seconds");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(timeLabel);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
        timer.schedule(new UpdateUITask(), 0, 1000);
    }

    private class UpdateUITask extends TimerTask {

        int nSeconds = 0;

        @Override
        public void run() {
            EventQueue.invokeLater(new Runnable() {

                @Override
                public void run() {
                    timeLabel.setText(String.valueOf(nSeconds++));
                }
            });
        }
    }

    public static void main(String args[]) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                final Clock clock = new Clock();
            }
        });
    }
} 
```

将`timeLabel`始终显示计时器已运行的秒数。

1.  您需要正确格式化它以显示“hh:mm:ss”；[这里](https://stackoverflow.com/a/2705674/230513)展示了一种方法。

2.  创建一个容器并向其添加标签，以便您可以将其显示为 GUI 的一部分。

3.  使用将结果与此[替代](https://stackoverflow.com/a/5529043/230513)进行比较`javax.swing.Timer`。

# wpf - 无法设置 SelectionChangedCommand.Command

> ID：11058173
> 
> 赞同：1
> 
> 时间：2012-06-15T21:04:36.620
> 
> 标签：wpf, mvvm, telerik, prism

我尝试使用此 xaml 将事件应用于命令绑定：

```
 <telerik:RadGridView x:Name="xRadGridView"

                            prismcommands:SelectionChangedCommand.Command="{Binding SelectPersonCommand}"

                             ItemsSource="{Binding GridItems, Mode=TwoWay}">
        </telerik:RadGridView> 
```

我得到错误：

> “SelectionChangedCommand.Command”属性是只读的，不能从标记中设置。

我可以毫无问题地绑定到 prismcommands:RowEditEndedCommand.Command。是否有机会绑定到 SelectionChangedCommand.Command？

我在 Silverlight 项目中使用相同的 PrismCommands，它在那里工作。

```
namespace RadEventToCommand.WPF.PrismCommands
{
    public class RowEditEndedCommandBehavior : CommandBehaviorBase<RadGridView>
    {
        public RowEditEndedCommandBehavior(RadGridView gridView)
            : base(gridView)
        {
            gridView.RowEditEnded +=new EventHandler<GridViewRowEditEndedEventArgs>(gridView_RowEditEnded);
        }

        void gridView_RowEditEnded(object sender, GridViewRowEditEndedEventArgs e)
        {
            CommandParameter = e;

            ExecuteCommand();
        }
    }
} 
```

--

```
namespace RadEventToCommand.WPF.PrismCommands
{
    public static class SelectionChangedCommand
    {
        private static readonly DependencyProperty SelectionChangedCommandBehaviorProperty
            = DependencyProperty.RegisterAttached(
            "SelectionChangedCommandBehavior",
            typeof(SelectionChangedCommandBehavior),
            typeof(SelectionChangedCommand),
            null);

        public static readonly DependencyProperty CommandProperty
            = DependencyProperty.RegisterAttached(
            "Command",
            typeof(ICommand),
            typeof(SelectionChangedCommand),
            new PropertyMetadata(OnSetCommandCallback));

        public static readonly DependencyProperty CommandParameterProperty
            = DependencyProperty.RegisterAttached(
           "CommandParameter",
           typeof(object),
           typeof(SelectionChangedCommand),
           new PropertyMetadata(OnSetCommandParameterCallback));

        public static ICommand GetCommand(RadGridView gridView)
        {
            return gridView.GetValue(CommandProperty) as ICommand;
        }

        public static void SetCommandParameter(RadGridView gridView, object parameter)
        {
            gridView.SetValue(CommandParameterProperty, parameter);
        }

        public static object GetCommandParameter(RadGridView gridView)
        {
            return gridView.GetValue(CommandParameterProperty);
        }

        private static void OnSetCommandCallback
            (DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
        {
            RadGridView gridView = dependencyObject as RadGridView;
            if (gridView != null)
            {
                SelectionChangedCommandBehavior behavior = GetOrCreateBehavior(gridView);
                behavior.Command = e.NewValue as ICommand;
            }
        }

        private static void OnSetCommandParameterCallback
            (DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
        {
            RadGridView gridView = dependencyObject as RadGridView;
            if (gridView != null)
            {
                SelectionChangedCommandBehavior behavior = GetOrCreateBehavior(gridView);
                behavior.CommandParameter = e.NewValue;
            }
        }

        private static SelectionChangedCommandBehavior GetOrCreateBehavior(RadGridView gridView)
        {
            SelectionChangedCommandBehavior behavior =
                gridView.GetValue(SelectionChangedCommandBehaviorProperty) as SelectionChangedCommandBehavior;
            if (behavior == null)
            {
                behavior = new SelectionChangedCommandBehavior(gridView);
                gridView.SetValue(SelectionChangedCommandBehaviorProperty, behavior);
            }
            return behavior;
        }
    }
} 
```

--

```
namespace RadEventToCommand.WPF.PrismCommands
{
    public class RowEditEndedCommandBehavior : CommandBehaviorBase<RadGridView>
    {
        public RowEditEndedCommandBehavior(RadGridView gridView)
            : base(gridView)
        {
            gridView.RowEditEnded +=new EventHandler<GridViewRowEditEndedEventArgs>(gridView_RowEditEnded);
        }

        void gridView_RowEditEnded(object sender, GridViewRowEditEndedEventArgs e)
        {
            CommandParameter = e;

            ExecuteCommand();
        }
    } 
```

}

--

```
namespace RadEventToCommand.WPF.PrismCommands
{
    public static class RowEditEndedCommand
    {
        private static DependencyProperty RowEditEndedCommandBehaviorProperty
            = DependencyProperty.RegisterAttached(
            "RowEditEndedCommandBehavior",
            typeof(RowEditEndedCommandBehavior),
            typeof(RowEditEndedCommand),
            null);

        public static DependencyProperty CommandProperty
            = DependencyProperty.RegisterAttached(
            "Command",
            typeof(ICommand),
            typeof(RowEditEndedCommand),
            new PropertyMetadata(OnSetCommandCallback));

        public static DependencyProperty CommandParameterProperty
            = DependencyProperty.RegisterAttached(
           "CommandParameter",
           typeof(object),
           typeof(RowEditEndedCommand),
           new PropertyMetadata(OnSetCommandParameterCallback));

        public static ICommand GetCommand(RadGridView gridView)
        {
            return gridView.GetValue(CommandProperty) as ICommand;
        }

        public static void SetCommand(RadGridView gridView, object parameter)
        {
            gridView.SetValue(CommandProperty, parameter);
        }

        public static void SetCommandParameter(RadGridView gridView, object parameter)
        {
            gridView.SetValue(CommandParameterProperty, parameter);
        }

        public static object GetCommandParameter(RadGridView gridView)
        {
            return gridView.GetValue(CommandParameterProperty);
        }

        private static void OnSetCommandCallback
            (DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
        {
            RadGridView gridView = dependencyObject as RadGridView;
            if (gridView != null)
            {
                RowEditEndedCommandBehavior behavior = GetOrCreateBehavior(gridView);
                behavior.Command = e.NewValue as ICommand;
            }
        }

        private static void OnSetCommandParameterCallback
            (DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
        {
            RadGridView gridView = dependencyObject as RadGridView;
            if (gridView != null)
            {
                RowEditEndedCommandBehavior behavior = GetOrCreateBehavior(gridView);
                behavior.CommandParameter = e.NewValue;
            }
        }

        private static RowEditEndedCommandBehavior GetOrCreateBehavior(RadGridView gridView)
        {
            RowEditEndedCommandBehavior behavior =
                gridView.GetValue(RowEditEndedCommandBehaviorProperty) as RowEditEndedCommandBehavior;
            if (behavior == null)
            {
                behavior = new RowEditEndedCommandBehavior(gridView);
                gridView.SetValue(RowEditEndedCommandBehaviorProperty, behavior);
            }
            return behavior;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T19:42:17.933

我从 Silverlight 项目中复制了行为的来源。它在那里工作。由于 WPF 中的某些原因，我需要 SelectionChangedCommand 中的附加方法

```
 public static void SetCommand(RadGridView gridView, object parameter)
        {
            gridView.SetValue(CommandProperty, parameter);
        } 
```

我复制了代码以检查是否可以为 Silverlight 和 WPF 使用通用代码库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T15:13:44.840

对于 RadGridView，我们使用交互触发器。下面的代码对我们有用。

```
<i:Interaction.Triggers>
   <i:EventTrigger EventName="SelectionChanged">
      <i:InvokeCommandAction Command="{Binding SelectedItemChangedCommand}"/>
   </i:EventTrigger>
</i:Interaction.Triggers> 
```

# hibernate - Hibernate：是否可以通过一个连接获取两个字段？

> ID：11058177
> 
> 赞同：0
> 
> 时间：2012-06-15T21:05:01.930
> 
> 标签：hibernate, join, collections

我有一个`Subject`有两个字段`Collection<Ownership> ownershipFrom`和`Collection<Ownership> ownershipTo`. 该类`Ownership`有两个字段，`Subject owner`并且`Subject owned`

要获取主题及其集合，我目前正在执行以下操作：

`from Subject s left join fetch s.ownershipFrom left join fetch s.ownershipTo`.

这可行，但对我来说似乎效率不高，因为我访问同一张表（所有权）两次，我相信我只能访问一次。有没有更好的方法来获取这些类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:21:24.043

我将从`Ownership`对象而不是`Subject`. 例子：

```
select own
from Ownership own, Subject s
where own.ownershipFrom = s
or own.ownershipTo = s 
```

类似的东西。

查看以下链接可能有用：http: [//docs.jboss.org/hibernate/orm/3.3/reference/en/html/queryhql.html](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/queryhql.html)

# c - 定义函数指针数组的正确方法是什么？

> ID：11058181
> 
> 赞同：1
> 
> 时间：2012-06-15T21:05:13.943
> 
> 标签：c, arrays, function-pointers

假设我有一个函数指针数组。换句话说，我可能想像这样调用矩阵转置函数，具体取决于我的矩阵是什么 dtype：

```
Transp[dtype][index_dtype](A.ia, A.a, B.ia, B.a); 
```

Transp 中的函数可能如下所示：

```
void transp_i64_i8(const int64_t* ia, const int8_t* a, int64_t* ib, int8_t* b) {
  // transpose here
  return;
} 
```

除了改变指针类型。

在我看来，我应该像这样声明我的函数指针数组：

```
void (**Transp)(const void* ia, const void* a, const void* ib, const void* b)[DTYPES_MAX][INDEX_TYPES_MAX] = {
  {transp_i8_i8, transp_i8_i16, transp_i8_i32, /* ... */ },
  {transp_i16_i8, transp_i16_i16, /* ... */ },
  {transp_i32_i8, transp_i32_i16, /* ... */ },
  /* ... */
} 
```

不幸的是，这似乎不起作用：

```
error: called object ‘Transp[(int)self_m->storage->dtype][(int)((struct YALE_STORAGE *)self_m->storage)->index_dtype]’ is not a function
../../../../ext/nmatrix/nmatrix.c: In function ‘nm_complex_conjugate_bang’:
../../../../ext/nmatrix/nmatrix.c:1910:32: error: subscripted value is neither array nor pointer nor vector 
```

我找到[了一个相当有用的参考资料](http://ieng9.ucsd.edu/~cs30x/rt_lt.rule.html)，但我确实需要一个示例来了解和应用我的确切用例。

那么，究竟什么是定义函数指针数组的正确方法呢？具体来说，声明部分是怎么写的？

（我意识到这可以使用 typedef 更轻松地完成，但我正在编写代码生成器，并且宁愿不使用 typedef。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:13:00.120

您以与使用它的方式类似的方式声明它，例如：

```
void (*Transp[DTYPES_MAX][INDEX_TYPES_MAX])(const int64_t*,
                                            const int64_t*,
                                            const int64_t*,
                                            const int64_t*); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T21:11:47.250

所以函数指针的类型是

```
ReturnType (*)(Args); 
```

函数指针数组的类型是

```
ReturnType (*[n])(Args); 
```

所以函数指针数组的数组将是

```
ReturnType (*[n][m])(Args); 
```

将此与您所拥有的进行比较，看起来您将数组声明为

```
ReturnType (**)(Args)[n][m]; 
```

即，指向返回数组数组的函数的指针。如果您从变量声明中删除其中一颗星并将数组移动到括号内，我认为这将解决问题。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T21:20:03.477

If your function pointers all have a fixed number of parameters but different number of parameters or different parameter types, you cannot anyway portably use a single type of function pointers to represent all the function pointers.

In POSIX system you can use an array of array of `void *` as POSIX guarantees the representation of function pointers and `void *` is the same. In C actually there is no conversion between function pointers and `void *` but compilers usually support it.

# visual-studio-2008 - 如何在 Visual C# 2008 Express 中添加项目

> ID：11058183
> 
> 赞同：0
> 
> 时间：2012-06-15T21:05:17.740
> 
> 标签：visual-studio-2008

我正在开发一个应用程序，我必须将一个单独的项目添加到正在开发的项目中，以便将其添加为参考。问题是在visual c#2008 express中，我找不到：

```
 “Add...”, “Existing Project” 
```

当我右键单击 IDE 中的“文件”菜单时的选项。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:08:45.267

这很可能是 Visual Studio Express 版本的固有限制。

编译原始项目，然后添加对生成的 DLL 的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:10:09.683

我认为这是 Visual Studio Express 的强制限制。[您可以在这个SO question](https://stackoverflow.com/questions/86562/what-is-missing-in-the-visual-studio-2008-express-editions)中看到更多关于限制的信息。

# google-maps - 将现有的 Google Map V3 放入表单以更改地址

> ID：11058195
> 
> 赞同：0
> 
> 时间：2012-06-15T21:06:35.513
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers

我正在构建一个应用程序，其中用户提交的帖子通过他们的位置作为谷歌地图上的标记放置。用户当前能够查看与他们当前位置相关的地图上的标记/帖子。

我的目标是允许用户更改地图的位置，以便用户可以查看与另一个地址相关的标记/帖子，特别是通过允许他们输入地址并更改位置的表格地图。

我发现了一个 YouTube 视频，它非常接近我的目标，但不幸的是它没有提供任何代码或说明 ( [http://www.youtube.com/watch?v=4uyIawlsvzU](http://www.youtube.com/watch?v=4uyIawlsvzU) )。

有没有办法有效地将现有的谷歌地图和现有的标记包装成这样的形式？我一直在寻找解决方案，但似乎找不到实现此目标的正确方法。非常感谢您的任何反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:23:19.730

您需要通过用户指定的地址搜索 LatLng 并显示它。我认为根本没有问题 :) 为此研究[Google Geocoding API](https://developers.google.com/maps/documentation/javascript/geocoding)（似乎是您案例的最佳解决方案）和[这个例子](https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-simple)

# jquery - 按钮以 HTML/JQuery 形式填充（多个）字段

> ID：11058197
> 
> 赞同：1
> 
> 时间：2012-06-15T21:06:47.880
> 
> 标签：jquery, html, forms

我正在为我的公司重新设计一个注册表单。不幸的是，我觉得我在这个问题上不知所措。哈哈。

我需要做的是为移动主题网站创建一个 Web 表单。目前，我已经或多或少地使用 JQuery Mobile 使该网站正常运行，但我正在努力处理这一切的表单输入方面。此表单需要做的一件事是能够在用户点击按钮时填充 3 个字段。

例如，如果我有一个按钮，上面写着“土耳其，土豆泥和葡萄酒”......当用户点击该按钮时，它下面的 3 个字段将填充值“土耳其”、“土豆泥”和“葡萄酒” ”。

有什么办法可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:11:26.887

我会这样做，只要我做对了。

*HTML*：

```
<form>
    <input type="text">
    <input type="text">
    <input type="text">
</form>
<button data-val="Turkey|Mashed Potato|Wine">Turkey, Mashed Potato & Wine</button> 
```

*JavaScript*：

```
$("button").on("click", function() {
    var val = $(this).data("val").split("|");
    $("form input").val(function(i) {
        return val[i] || "";
    });
}); 
```

**演示：http:** [//jsfiddle.net/8aHtP/](http://jsfiddle.net/8aHtP/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:12:49.543

尝试这个：

```
$(function(){
  $('#my_button').on('click', function(e){
    $('#field_one').val('Turkey');
    $('#field_two').val('Mashed Potato');
    $('#field_three').val('Wine');
  });
}); 
```

但是，我假设您需要它根据按钮的文本动态工作。如果是这样，您必须进行一些字符串操作才能获取值：

```
$(function(){
  $('#my_button').on('click', function(e){
    var parts = $(this).attr('value').split(',');

    // do some more work here to clean up the values, 
    // you'd need the values separated with commas all
    // the way through (ie: Turkey, Mashed Potato, Wine)

    $('#field_one').val(parts[0]);
    $('#field_two').val(parts[1]);
    $('#field_three').val(parts[2]);
  });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T21:35:38.093

是的，这是可能的。一种方法是将值放在数据属性中并附加它们。

工作示例：http: [//jsfiddle.net/vj3Zg/](http://jsfiddle.net/vj3Zg/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-15T21:10:31.350

您可以使用 jQuery[`.val()`](http://api.jquery.com/val/)设置文本框的值。

```
<div id="pop">Turkey, Mashed Potato &amp; Wine</div>
<input type="text" id="f1" />
<input type="text" id="f2" />
<input type="text" id="f3" />​

$("#pop").click(function() {
    $("#f1").val("Turkey");
    $("#f2").val("Mashed Potato");
    $("#f3").val("Wine");
});​ 
```

[演示](http://jsfiddle.net/kknTm/)

# python - 为什么 SciPy 的 loadmat 在读取 200 MB Matlab 结构时会抛出 MemoryError

> ID：11058199
> 
> 赞同：2
> 
> 时间：2012-06-15T21:07:03.940
> 
> 标签：python, matlab, file-io, scipy, mat-file

我正在使用以下代码尝试在 Python 中加载 MAT 文件。我可以在 MATLAB 中毫无问题地加载它。

```
from scipy.io import loadmat
test_filename = 'test_data.mat' #This is a struct
data =loadmat(test_filename, struct_as_record=True) 
```

运行该代码会产生此错误：

```
Traceback (most recent call last):
  File "C:\Users\mac389\workspace\nexUtils\src\qA.py", line 16, in <module>
data =loadmat(test_filename, struct_as_record=True)
  File "C:\Python27\lib\site-packages\scipy\io\matlab\mio.py", line 175, in loadmat
matfile_dict = MR.get_variables(variable_names)
  File "C:\Python27\lib\site-packages\scipy\io\matlab\mio5.py", line 272, in get_variables
hdr, next_position = self.read_var_header()
  File "C:\Python27\lib\site-packages\scipy\io\matlab\mio5.py", line 224, in read_var_header
stream = BytesIO(dcor.decompress(data))
MemoryError 
```

作为参考，test_data.mat 是具有以下字段的结构体（来自 MATLAB 控制台）：

```
 version: 101
 comment: 'molecular layer 4/17'
    freq: 40000
    tbeg: 0
    tend: 1.3950e+003
  events: {3x1 cell}
 neurons: {50x1 cell}
   waves: {102x1 cell}
contvars: {64x1 cell} 
```

Test_data.mat 为 217 MB。我有 4 GB 的 RAM。我正在使用 SciPy 0.10.0 和 NumPy 1.6.1。更改 'struct_as_record' 字段没有任何作用。

如何加载字段为元胞数组的结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T22:26:41.567

我找到了答案。

Loadmat 无法处理重度嵌套的结构。在给定的数据集中，三个结构字段“waves、neurer、contvars”是元胞数组。该单元数组的每个成员都是一个结构。这些结构的一些字段本身就是元胞数组。这些元胞数组有一个包含数据的字段。这种组织数据的非标准方式加上缺乏文档造成了问题。

我想这是一个警示故事，尽可能接近文本文件格式，如果您正在创建数据存储格式，如果您选择一种非常非标准的格式，请对您的继任者留心并记录这一事实......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T11:30:06.177

我认为由于解压的实现方式，它在 Python 中需要更多的内存。尝试在不压缩的情况下保存在 Matlab 中（使用`-v6`，版本 6 格式没有压缩功能）。

# git - 如何让 Git 将本地目录从 PUSH 排除到远程，但仍然是本地存储库的一部分

> ID：11058207
> 
> 赞同：8
> 
> 时间：2012-06-15T21:08:00.560
> 
> 标签：git

使用 git，我希望能够将某个文件夹保留为我的本地项目的一部分（在分支中使用它等），但我不希望这个目录被推送到公共 git 服务器。

有问题的文件夹有一些项目不需要的 CLI Java 东西，但我想与将要上线的分支工作保持同步。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:32:00.280

**一个非常简短的答案是否定的**。原因如下：当你的本地 git 分支被推送到服务器时，它会按原样推送，没有任何例外。由于提交包含文件，如果某些文件不会被推送，它会在内部弄乱 git。不支持这种选择性行为，我想它永远不会支持，因为大多数情况下，当您需要这些东西时，您会错误地使用 git。

但是，有很多方法：

1.  第一个只是简单地将这些东西添加到 repo 中。您显然需要它并且希望它受版本控制，所以从我的角度来看，这就是将文件添加到 git 所需的全部内容。
2.  您可以尝试 git-submodules，但这也会将文件添加到您的存储库中。您的 java cli 将是另一个存储库，您的原始存储库将跟踪版本。
3.  你可以告诉 git 忽略子文件夹，而不是在那里创建你的 java-cli 存储库，并且只创建两个而不进行任何交互。

我肯定会选择 1 因为当我需要项目的东西时，它属于 repo，即使它是 java cli。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-11-14T15:06:45.137

# 如果您**根本不需要跟踪**这些文件...

...你可以让 git**[忽略](https://git-scm.com/docs/gitignore)**它们。

# 如果您**想在**本地跟踪它们...

...但在远程仓库中没有它们我只能给你一些**我从未尝试过**的东西的提示/想法，但你最终可能会拥有不同的存储库，事情可能会**变得有点讨厌**。

我会**看看**（从*可能还*可以到*可能相当混乱和一个坏主意*）：

*   **嵌套存储库**
    *   [子树](https://git-scm.com/book/en/v1/Git-Tools-Subtree-Merging)、子[模块](https://git-scm.com/book/en/v1/Git-Tools-Submodules)、或类似[`git-repo`](https://gerrit.googlesource.com/git-repo/)[`git-subrepo`](https://github.com/ingydotnet/git-subrepo)
    *   手动嵌套存储库：让 git[忽略](https://git-scm.com/docs/gitignore)子文件夹，设置自己的存储库，确保提交以某种方式对齐
*   **推送时删除**：（缺点：您可能无法正确区分，因为历史仅与临时存储库匹配。您当然也***可以***以某种方式破解您的差异，使设置更加混乱。）
    *   脚步：
        *   在将存储库克隆到临时文件夹之前
        *   从新创建的克隆中的整个历史记录中删除您的子文件夹（获取另一个具有不同提交哈希的存储库）
        *   推送新创建的仓库
    *   选项： 触发器：
        *   [`pre-push`](https://git-scm.com/docs/githooks#_pre_push) [钩](https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks)
        *   手动执行上述操作，而不是使用`git push`
    *   选项： 移除：
        *   [BFG-Repo-Cleaner 之](https://rtyley.github.io/bfg-repo-cleaner/)类的工具
        *   [`git-filter-branch`](https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History#_removing_file_every_commit)用手

* * *

再说一遍：我**没有使用它们中的任何一个，**也不**知道它们的缺点、陷阱等，**但对我来说，[子树](https://git-scm.com/book/en/v1/Git-Tools-Subtree-Merging)似乎是迄今为止最好的解决方案。

其余的大部分在我看来**确实**很混乱，但归根结底，**唯一重要的是什么对你有用**。

> [运送糟糕的东西，但是运送。](http://99u.com/articles/6249/seth-godin-the-truth-about-shipping)

...无论是[芥末](https://blog.codinghorror.com/has-joel-spolsky-jumped-the-shark/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-26T07:16:54.513

晚会迟到了，但问题仍然很好。您正在尝试仅使用所需工具的一半来解决部署问题：为了实现您的目标，您必须在部署链中同时使用 git 和依赖项管理器。

使用 git，您可以对所有代码以及 CLI Java 内容进行版本跟踪，但使用 DM，您的 CLI Java 内容将被标记为“开发”包。

在生产中部署您应该排除所有“开发”包。

在 Java 中我认为正确的工具应该是 Maven，在 PHP 中有 Composer，在 Javascript 中最著名的是 NPM。

我的两（晚）美分

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-02T21:33:27.563

**一个更简短的答案是肯定的！**
它现在是 github 中的一个功能。您可以使用 gitignore 排除文件类型。
[https://help.github.com/articles/ignoring-files/](https://help.github.com/articles/ignoring-files/)
我个人通过将以下内容添加到我的全局 gitignore 文件中，将名为 ASSETS 的文件目录从我的所有存储库中排除：
ASSETS/*
示例：

```
# Compiled source #
###################
*.com
*.class
*.dll
*.exe
*.o
*.so

# Packages #
############
# it's better to unpack these files and commit the raw source
# git has its own built in compression methods
*.7z
*.dmg
*.gz
*.iso
*.jar
*.rar
*.tar
*.zip

# Logs and databases #
######################
*.log
*.sql
*.sqlite

# OS generated files #
######################
.DS_Store
.DS_Store?
._*
.Spotlight-V100
.Trashes
ehthumbs.db
Thumbs.db

# Audio Files #
###############
*.wav
*.mp3
*.wma

# Video Files #
###############
*.wmv
*.mpg
*.mpeg
*.mp4
*.mov
*.flv
*.avi
*.ogv
*.ogg
*.webm

# Image Files #
###############
*.jpg
*.gif
*.png
*.svg
*.ico

# Folders #
###########
ASSETS/*

# Documents #
#############
*.pdf
*.doc 
```

我的 arch linux 机器上的上述文件位于 ~/.gitignore_global

# perl - 如何在 Perl 中将带有重音符号、变音符号等的字母转换为对应的 ASCII 字符？

> ID：11058211
> 
> 赞同：14
> 
> 时间：2012-06-15T21:08:19.400
> 
> 标签：perl, ascii, diacritics, data-conversion

我正在编写一个使用 Perl 处理文档的程序，并且很多文档都有诸如`ä, ö, ü, é, etc`（大写和小写）之类的字符。我想用 ASCII 对应物替换它们`a, o, u, e, etc`。我将如何在 Perl 中做到这一点？

我想到的解决方案之一是有一个哈希，键是变音符号和重音字符，值是 ASCII 对应物，但这需要我有一个我没有的所有变音符号和重音字符的列表，如果我建立一个列表，我肯定会错过很多，因为我不熟悉所有可能有变音符号、重音符号和其他变音符号的字符。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-15T21:19:15.620

像往常一样，如果你想到一个肯定不是你唯一的问题，CPAN 上已经有了解决方案。) 在这种情况下，它被称为[Text::Unidecode](https://metacpan.org/module/Text::Unidecode)

```
use warnings;
use strict;
use utf8;
use Text::Unidecode;
print unidecode('ä, ö, ü, é'); # will print 'a, o, u, e' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T21:18:44.440

[`Text::Unidecode`](http://search.cpan.org/perldoc?Text%3a%3aUnidecode)

请参阅许多免责声明，但如果您只有带有变音符号的拉丁文本，这可能正是您所需要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-18T18:19:30.180

使用`s///` *(=Search&Replace)*而不是`m//` *(=Match)*

例如`$name =~ s/\x00c0/A/g;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-22T18:03:48.217

我做了这个子程序，并通过它输入每个单词。这可能很慢。

```
sub store_utf82_encoding{
##see file UTF8vowels.txt
#converts  UTF8 Euro vowels to nearest English equivant  

  my $name=$_[0];
  $name =~m/\x00c0/A/g; #Agrav
  $name =~m/\x00c1/A/g; # Aacute
  $name =~m/\x00c2/A/g; # Acap
  $name =~m/\x00c3/A/g; # Atilde
  $name =~m/\x00c4/A/g; # Auml
  $name =~m/\x00c5/A/g; # Aring
  $name =~m/\x00c6/AE/g; # AE
  $name =~m/\x00c7/Ch/g; # Ccedilla
  $name =~m/\x00c8/E/g; #Egrav
  $name =~m/\x00c9/E/g; # Eacute
  $name =~m/\x00ca/E/g; # Ecap
  $name =~m/\x00cb/E/g; # Euml
  $name =~m/\x00cc/I/g; # Igrav
  $name =~m/\x00cd/I/g; # Iacut
  $name =~m/\x00ce/I/g; # Icap
  $name =~m/\x00cf/I/g; # Iuml
  $name =~m/\x00d0/Th/g; #CapEth
  $name =~m/\x00d1/NY/g; # Ntild
  $name =~m/\x00d2/O/g; # Ograv
  $name =~m/\x00d3/O/g; # Oacute
  $name =~m/\x00d4/O/g; # Ocap
  $name =~m/\x00d5/Th/g; # Otilde
  $name =~m/\x00d6/O/g; # Ouml
  $name =~m/\x00d8/O/g; # Ostroke 
  $name =~m/\x00d9/U/g; # Ugrav
  $name =~m/\x00da/U/g; # Uacute
  $name =~m/\x00db/U/g; # Ucap
  $name =~m/\x00dc/U/g; # Uuml
  $name =~m/\x00dd/Y/g; # Yacute
  $name =~m/\x00de/Th/g; # CapThorn
  $name =~m/\x00df/SS/g; # GermanUCss Ezette
  $name =~m/\x00e0/a/g; # agrav
  $name =~m/\x00e1/a/g; # aacute 
  $name =~m/\x00e2/a/g; # acap
  $name =~m/\x00e3/a/g; # atilde
  $name =~m/\x00e4/a/g; # auml
  $name =~m/\x00e5/a/g; # aring
  $name =~m/\x00e6/ae/g; # ae
  $name =~m/\x00e7/ch/g; # ccedilla 
  $name =~m/\x00e8/e/g; # egrav
  $name =~m/\x00e9/e/g; # eacute
  $name =~m/\x00ea/e/g; # ecap
  $name =~m/\x00eb/e/g; # euml
  $name =~m/\x00ec/i/g; # igrav
  $name =~m/\x00ed/i/g; # iacute
  $name =~m/\x00ee/i/g; # icap
  $name =~m/\x00ef/i/g; # iuml
  $name =~m/\x00f0/th/g; # lowercase eth
  $name =~m/\x00f1/ny/g; # ntilde
  $name =~m/\x00f2/o/g; # ograv
  $name =~m/\x00f3/o/g; # oacute 
  $name =~m/\x00f4/o/g; # ocap
  $name =~m/\x00f5/th/g; # otilde
  $name =~m/\x00f6/o/g; # ouml
  $name =~m/\x00f8/o/g; # ostroke
  $name =~m/\x00f9/u/g; # ugrav
  $name =~m/\x00fa/u/g; # uacute
  $name =~m/\x00fb/u/g; # ucap
  $name =~m/\x00fc/u/g; # uuml
  $name =~m/\x00fe/th/g; # lowercase thorn
  $name =~m/\x00fd/y/g; # yacute
  $name =~m/\x00ff/y/g; # yuml

return $name;

} #endsub store_utf82_encoding 
```

# ios - 是否可以使用 UIButton 在 iOS 应用程序中嵌入 Vimeo 视频？

> ID：11058213
> 
> 赞同：3
> 
> 时间：2012-06-15T21:08:23.020
> 
> 标签：ios, video, uibutton, vimeo

是否可以使用 UIButton 而不是使用 UIWebView 在 iOS 应用程序中嵌入 Vimeo 视频？

我的想法是单击 UIButton 在应用程序内播放 Vimeo 视频，而无需启动 Safari。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:19:11.243

Is it possible to start a video by click of a UIButton - yes.

Is it possible to embed a video in UIButton - no. Video still needs to be hosted within a UIWebView.

Hosting UIWebView in an app is not the same as starting Safari. UIWebView is a part of your app, Safari is a whole another app. You have complete control over what's going on inside a UIWebView.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T00:33:00.350

商店里有一个 Vimeo 应用程序，还有一个 API 和 Vimeo.com 上的文档。上次我检查第三方无法并允许将剪辑直接嵌入应用程序中，因为他们无权访问 Vimeos 内容交付网络上的 mp4 文件。

但是 Vimeo 本身就是这样做的，所以如果您知道自己在做什么，您可以想出监控 Vimeos 应用程序网络流量并逆向工程他们如何访问 mp4 的想法。但在你这样做之前，你最好联系他们的支持。

# javascript - 跨 HTML、CSS 和 Javascript 跟踪代码执行

> ID：11058215
> 
> 赞同：0
> 
> 时间：2012-06-15T21:08:39.153
> 
> 标签：javascript, html, css, flash

无论如何，我是否可以跟踪/查看跨 html、css 和 javascript 处理网站的确切顺序？

我有一个在第一遍时没有触发的函数，我很确定它与执行顺序有关。而且，在处理各个步骤时（缓慢地）查看它们会非常有用

感谢您的任何建议。

这与这个问题有关： [flashMovie.Play is not a function](https://stackoverflow.com/questions/11038529/flashmovie-play-is-not-a-function)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T21:34:06.217

听起来好像您想在代码中设置[断点](http://en.wikipedia.org/wiki/Breakpoint)，然后单步执行执行路径。

1.  点击 Chrome 屏幕右上角的扳手符号，选择工具，然后选择开发者工具
2.  单击 Chrome 屏幕底部窗格中的脚本选项卡
3.  单击 Chrome 屏幕底部窗格左上角的文件夹
4.  单击要调试的脚本
5.  单击要设置断点的行

Chrome 开发者工具官方文档也可以在这里找到：[https ://developers.google.com/chrome-developer-tools/docs/scripts](https://developers.google.com/chrome-developer-tools/docs/scripts)

一旦你点击了所需的断点（可能只是脚本的第一行），点击右上角的“Step into next function call”（它看起来像一个指向点的向下箭头）按钮Chrome 屏幕的底部窗格。

![Chrome 脚本调试器的屏幕截图](../Images/ce00e4ef94e226642cc632b73f494b42.png)

这些问题也应该有所帮助：

*   [如何在 Google chrome javascript 调试器中单步执行代码](https://stackoverflow.com/questions/1576467/how-to-step-through-code-in-google-chrome-javascript-debugger)
*   [如何在 Google Chrome 的内联 Javascript 中设置断点？](https://stackoverflow.com/questions/5156388/how-to-set-breakpoint-in-inline-javascript-in-google-chrome-browser-for-linux)
*   [Javascript 断点在 Chrome 开发者工具中不起作用](https://stackoverflow.com/questions/9797911/javascript-breakpoint-setting-in-chrome-developer-tools)
*   [在 Chrome 中的 XHR 中设置断点](https://stackoverflow.com/questions/3249696/set-a-breakpoint-in-xhr-in-chrome)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:11:27.593

在 Chrome 中，使用**开发者工具栏**。按键盘键：F12。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T21:16:54.330

在你的 JS 中放置一个`alert(1);`or`console.log(2)`看看会发生什么。如果您使用 Firefox，请先打开其 Web 控制台，然后查看是否有任何错误。`Ctrl+Shift-K`打开 Web 控制台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-15T21:27:22.213

开发者工具按 F12 或 Ctrl+Shift-K，它几乎可以在任何浏览器中使用。您将调试您的代码并使用 consol

# php - 加载 CMSMS 网站时出错

> ID：11058216
> 
> 赞同：-4
> 
> 时间：2012-06-15T21:08:44.160
> 
> 标签：php, content-management-system

我刚刚上传了一个 CMSMS 网站，但无法查看该网站。我收到错误：

> 警告：需要（/home/inkbran1/public_html/century21nigeria/lib/smarty/Smarty.class.php）[function.require]：无法打开流：/home/inkbran1/public_html/century21nigeria/include 中没有这样的文件或目录.php 在第 153 行
> 
> 致命错误：require() [function.require]: 无法打开所需的 '/home/inkbran1/public_html/century21nigeria/lib/smarty/Smarty.class.php' (include_path='.:/usr/lib/php:/usr /local/lib/php') 在第 153 行的 /home/inkbran1/public_html/century21nigeria/include.php

请问，我能做什么？我是一个 PHP 假人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:15:07.760

确保文件 Smarty.class.php 位于错误消息中列出的目录中。

# objective-c - 设计操作 (a,b) -> (c,d)

> ID：11058219
> 
> 赞同：1
> 
> 时间：2012-06-15T21:09:00.317
> 
> 标签：objective-c, oop

我有一个需要设计的操作。该操作采用某个类 X 的两个对象，并返回同一类的两个新对象（我以后可能需要原始对象）。指示选择该对象的逻辑包含在 Y 类中。一方面，我不希望 Y 类知道有关 X 类实现的细节；另一方面，我不希望 X 类知道有关选择不同对象来执行此操作的详细信息。

如果这就是问题的全部，我只需在 A 类上创建一个静态方法。但是，我正在使用的语言中的方法只返回一个对象。此外，该操作需要是健壮的，并且两次调用操作以分别获得 C 和 D 是不可能的，因为 C 和 D 都依赖于单个随机数。

我应该如何设计这样的操作？

更新：我正在使用 Obejctive C。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:26:37.280

我决定只用静态方法修改给定的对象 A 和 B。在调用此方法之前，我必须复制它们，但我认为它不会比创建新方法慢；无论如何，对象 C 和 D 中的大部分信息都是从 A 和 B 派生的。

（我仍然认为这是一个丑陋的解决方案，并将欢迎更合格的答案）。

# java - 访问控制异常 - 拒绝访问

> ID：11058220
> 
> 赞同：0
> 
> 时间：2012-06-15T21:09:43.223
> 
> 标签：java, security, applet, text-files, accesscontrolexception

我对此很陌生-我从未尝试过将小程序放到网上，而且我是一个相当新的程序员。

我试图把一个小程序放到一个网页上；我尝试的第一个小程序不起作用（谷歌站点文件文件柜上的托管类，因为 FTP 是 ASCII 并且对于导致幻数错误的类而不起作用）

所以我找到了一个可以托管我的文件的地方，所以 FTP 是二进制的（这是一个小程序类工作所必需的）。我做了这个改变，小程序很好，完全在浏览器中工作，我很高兴。

所以现在我试图让一个访问文本文件（与类文件托管在同一位置）的小程序工作，但无论我尝试什么，它都无法访问它们。

从我到目前为止所读到的，似乎我必须创建一个签名的小程序，以便我可以访问其他文件，但这意味着我必须制作一个我无法做的 jar 文件，因为这是一个小程序，没有主要方法.

简而言之：我有一个试图访问其他文本文件的小程序，但它不工作（标题错误）

我可能在某处犯了错误，如果是这样 - 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T14:21:33.047

> 从我到目前为止所读到的，似乎我必须创建一个签名的小程序，以便我可以访问其他文件，......

问题是`File`在客户端上运行的applet 代码创建的a***永远不能***指向远程服务器上的位置。 `File`对象只是不那样工作。

该资源需要通过**URL**访问。要形成 URL，请使用代码库或文档库（HTML 所在的位置）的相对路径。请注意，小程序可以“打电话回家”以从其自己的代码库或文档库中获取资源——即使在沙盒中也是如此。

# android - 仅从 Google Play（市场）下载应用程序的图标

> ID：11058221
> 
> 赞同：2
> 
> 时间：2012-06-15T21:09:44.943
> 
> 标签：android, google-play

有没有办法从 Google Play/Market 只下载存储在特定应用程序中的图标，而无需下载整个 APK 并安装它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-16T01:52:34.593

你可以这样做，但它需要下载他的页面源然后解析它。

你可以做的是首先下载网页，我喜欢JSoup。喜欢

```
Document d = null;
try {
    d  = Jsoup.connect("https://play.google.com/store/apps/details?id=" + packageName).get();
} catch (IOException e1) {
    // TODO Auto-generated catch block
    e1.printStackTrace();
} 
```

然后您应该解析该文档以获取以下标记“”

```
Elements div = d.getElementsByAttributeValueContaining("class", "doc-banner-icon");
String path = div.get(0).attr("src"); 
```

此路径变量应该是要下载的图像的路径。我没有测试过这个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T21:15:40.117

没有

市场内容没有官方 API。无论是检索图标还是其他任何东西。

如果您只是对获取图像文件感兴趣，您可以通过 Web 前端手动将它们下载到 Market。但我不会编写代码来执行此操作，因为他们很可能会对 Web 前端进行更改，从而导致您的代码中断。ps 我不是律师，但我认为即使您确实下载了这些图像（当然未经每个开发人员的许可），您也不会被“允许”处理这些图像

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-21T22:37:03.190

Jug6ernaut 的答案将不再有效。这适用于 2016 年 11 月：

```
@WorkerThread public static String scrapeGooglePlayIcon(@NonNull String packageName) throws IOException {
  return Jsoup.connect("https://play.google.com/store/apps/details?id=" + packageName).get()
      .select("div[class=details-info] > div[class=cover-container] > img[class=cover-image]")
      .attr("abs:src");
} 
```

我创建了一个小型库，可以通过网络抓取 Google Play 商店。如果将来停止工作，请在 GitHub 项目上发表评论或创建问题：[https ://github.com/jaredrummler/GooglePlayScraper](https://github.com/jaredrummler/GooglePlayScraper)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-01T11:02:03.617

您可以创建一个像[http://kcy.me/hylg](http://kcy.me/hylg)这样的 Yahoo Pipes ，它会为您解析页面并提取 JSON，您可以在其中读取单个图像 URL。

[http://kcy.me/hylj](http://kcy.me/hylj)

您可以参数化管道，以便接收到要提取图像的应用程序的链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-17T16:02:28.393

简单的解决方案是，只需在 Chrom 浏览器中右键单击应用程序的图标并将图像另存为，这将使用 webp 扩展名保存图标，现在使用此[Conver webp to png](https://ezgif.com/webp-to-png) 将图标转换为 PNG。

# c# - 引用文本和特殊字符的正则表达式

> ID：11058222
> 
> 赞同：0
> 
> 时间：2012-06-15T21:09:49.987
> 
> 标签：c#, .net, xml, regex

我试图找出.NET 中的正则表达式，它可以检测用引号括起来的 XML 特殊字符。它们也可以包含其他字符，但必须存在以下至少一个`< > & ' "`

火柴

```
"Hello &"
"& Something"
"Testing <>" 
```

不匹配

```
"foo bar" 
```

我试过`"[&<>\"\'\w\s]+"`这样的表达式，但是这个正则表达式确实接受没有特殊字符的字符串。

此表达式的目的是清除所有可能使解析器崩溃的特殊字符中的 XML 属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:19:07.807

您的正则表达式表示任何这些字符（例如`\w`）的任何字符串都应该匹配。试试这个：

```
 ^.*[&<>\"\'].*$ 
```

不过，您不需要转义这些引号。

我希望您使用 DOM 解析器来检索属性值...

# c - 编辑 char* 数组

> ID：11058223
> 
> 赞同：0
> 
> 时间：2012-06-15T21:09:53.117
> 
> 标签：c, string, char

我有一个这样的数组`char *`：

```
char * gradient_xpm[] = {"abc", "def", "ghi"}; 
```

我需要更改这些字符串的值。

我已经尝试`strcpy`过`=`操作员，但它给了我一个分段错误。

例如：

```
strcpy(gradient_xpm[1],"jkl");
gradient_xpm[1][2] = 'x'; 
```

我什至无法编辑一个字符。如何编辑这些值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T21:11:06.873

您的数组中有字符串常量，并且无法更改。这是您的段错误的原因。

您需要在不使用字符串常量的情况下设置数组，然后将字符串常量复制到数组中。

就像是：

```
char *gradient_xpm[3];

gradient_xpm[1] = (char *) malloc(sizeof(char) * (MAX_STR_LEN + 1));
strncpy(gradient_xpm, "jkl", MAX_STR_LEN);

// now this will work:
gradient_xpm[1][2] = 'x'; 
```

同样对于`gradient_xpm[0]`, `gradient_xpm[2]`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T21:20:31.843

在 C 中修改字符串文字是未定义的行为。所以任何事情都可能发生，不一定是段错误。

从[C99 标准](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)，6.4.5 字符串文字 6.4.5/6：

> 如果它们的元素具有适当的值，则未指定这些数组是否不同。如果程序尝试修改这样的数组，则行为未定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T21:15:09.423

您不能修改标记为禁止使用的字符串常量。但是，您可以修改在堆或堆栈上分配的内存。也就是说，如果您使用 C++，请考虑使用[类](http://www.cplusplus.com/reference/string/string/)[的`string`](http://www.cplusplus.com/reference/string/string/)数组，而不是管理`char *`数组。内存管理问题更容易处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T21:13:48.183

您已经使用字符串文字实现了这一点，并且无法更改它们

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-15T21:14:38.467

不要编辑内容 - 这是一个坏主意。在某些编译器中，这将是一个编译时错误，因为字符串常量是`const char *`，而不是`char*`.

相反，翻转指针：

```
gradient_xpm[1] = "jkl"; 
```

# .htaccess - Vary Accept-Encoding 标头不起作用

> ID：11058227
> 
> 赞同：2
> 
> 时间：2012-06-15T21:10:16.487
> 
> 标签：.htaccess, header, vary

我在 .htaccess 中添加了下一行，我在这里找到了[如何在 htaccess 中指定不同的接受编码标头](https://stackoverflow.com/questions/3641197/how-to-specify-vary-accept-encoding-header-in-htaccess)

```
 <IfModule mod_headers.c>
       <FilesMatch "\.(js|css|xml|gz)$">
         Header append Vary Accept-Encoding
       </FilesMatch>
     </IfModule> 
```

但它不起作用，我还检查了 phpinfo（加载的模块：mod_headers ...）。我使用 Page Speed 插件，但在我的 css 文件中看不到这个标题。为什么它不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T23:35:37.213

也许你想用这个：

```
<IfModule mod_headers.c>
   <FilesMatch "\.(js|css|xml|gz)$">
     Header append Vary: Accept-Encoding
   </FilesMatch>
</IfModule> 
```

带分号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-22T09:40:06.700

在 .htaccess 文件中添加这个，它将起作用

```
<IfModule mod_headers.c>
    <FilesMatch ".(js|css|xml|gz|html)$">
        Header append Vary: Accept-Encoding
    </FilesMatch>
</IfModule> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-23T20:13:15.133

如果其他示例不起作用，请尝试以下操作：

```
<IfModule mod_headers.c>
    Header set Vary "Accept-Encoding"
</IfModule> 
```

# c# - C# 正则表达式 - 匹配和替换，自动增量

> ID：11058229
> 
> 赞同：6
> 
> 时间：2012-06-15T21:10:24.207
> 
> 标签：c#, asp.net

我一直在努力解决一个问题，任何帮助将不胜感激。

问题：我有一个段落，我想替换一个出现多次的变量（Variable = @Variable）。这是简单的部分，但我遇到困难的部分是尝试用不同的值替换变量。

我需要每次出现都有不同的值。例如，我有一个对每个变量进行计算的函数。到目前为止我所拥有的如下：

```
private string SetVariables(string input, string pattern){

    Regex rx = new Regex(pattern);
    MatchCollection matches = rx.Matches(input);
    int i = 1;
    if(matches.Count > 0)
    {
        foreach(Match match in matches)
        {
            rx.Replace(match.ToString(), getReplacementNumber(i));
            i++
        }
    } 
```

我可以用 getReplacementNumber(i) 函数返回的数字替换我需要的每个变量，但是如何按照匹配集合中的相同顺序将其放回原始输入中？

提前致谢！

马库斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-15T21:14:07.497

使用[`Replace`](http://msdn.microsoft.com/en-us/library/cft8645c)将 a[`MatchEvaluator`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.matchevaluator)作为其第二个参数的重载。

```
string result = rx.Replace(input, match => { return getReplacementNumber(i++); }); 
```

我假设这里`getReplacementNumber(int i)`返回一个`string`. 如果没有，您将不得不将结果转换为字符串。

在线查看它：[ideone](http://ideone.com/xk36L)

# c# - 在 asp.net 中读取自定义配置文件

> ID：11058235
> 
> 赞同：1
> 
> 时间：2012-06-15T21:10:43.730
> 
> 标签：c#, asp.net, configuration, config, webconfigurationmanager

如何使用 asp.net 的 C# 代码中的 WebConfigurationManager 从自定义配置文件（比如 abc.config）中读取连接字符串？

```
Configuration conf = WebConfigurationManager.OpenWebConfiguration("~/abc.config"); 
```

这似乎不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-17T09:23:35.983

你可以使用这个技巧：它是我的自定义方法——使用 web 根目录中的 webapp.config。读取所有应用程序设置并返回；

```
//Read WebAppConfiguration
public static AppSettingsSection ReadAllWebappConfig()
{
    string physicalWebAppPath = "";
    AppSettingsSection appSettings;

    ExeConfigurationFileMap fileMap = new ExeConfigurationFileMap();
    physicalWebAppPath = System.Web.Hosting.HostingEnvironment.MapPath("~/webapp.config");

    if (System.IO.File.Exists(physicalWebAppPath))
    {
        fileMap.ExeConfigFilename = physicalWebAppPath;
        Configuration config = ConfigurationManager.OpenMappedExeConfiguration(fileMap, ConfigurationUserLevel.None);
        appSettings = (AppSettingsSection)config.GetSection("appSettings");
    }
    else
        appSettings = null;

    return appSettings;
} 
```

webapp.config 示例：

```
<configuration>
  <appSettings>
    <add key="WebApp-FixedTopMenu" value="true"/>
    <add key="WebApp-FixedTopMenuThickness" value="true"/>
  </appSettings>
</configuration> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:19:30.583

我认为您无法使用 webconfigurationmanager 阅读它。你会像阅读任何 xml 文件一样阅读它，因为它是一个 xml 文件

```
public static string GetSingleValue(string strXPathExpression, string strAttributeName)
        {
            XmlNode node = GetNode(strXPathExpression);
            if (node != null)
            {
                XmlAttribute attribute = node.Attributes[strAttributeName];
                if (attribute != null)
                    return attribute.Value;
            }

            return string.Empty;

        } 
```

# java - 为 Java 和 .NET 集成身份验证 [在两个地方单点登录]

> ID：11058237
> 
> 赞同：1
> 
> 时间：2012-06-15T21:10:54.683
> 
> 标签：java, .net, authentication, single-sign-on, spnego

我们希望实现以下登录机制，以便在托管在不同应用程序容器中的 Java 和 .NET 应用程序之间针对 AD 对用户进行身份验证。

我们的服务器设置是

*   一台带有 Tomcat 的 linux Web 服务器 - 这是我们的 Java 应用程序所在的位置

*   一台带有 IIS 的 Windows Web 服务器 - 这是旧版 .net 应用程序所在的位置。[身份验证可以通过 Windows 集成身份验证来完成——我们不想改变这一点——除非别无他法]

*   一个域控制器 - win 2008

我们的目标是实现身份验证机制，任何用户都可以通过 AD [Active Directory] ​​凭据通过表单登录到我们托管在 .NET 或 Java 上的登录页面。身份验证成功完成后，用户应该浏览页面，而不会再次询问他/她的凭据。

我们需要它的原因是我们有几个 .Net 应用程序，它们设计为使用与 IIS 的集成身份验证 - 我们正在设计新的 Java 接口，我们希望通过登录表单集中身份验证，用户可以在其中再次登录 AD 并在 .NET 和身份验证在过期之前仍然有效的 Java 应用程序等。

我听说过 SPNEGO 项目，但不确定我们需要什么样的设置来实现上述场景。

如果我们不需要修改 .NET 站点设置，那就太好了，因为我们不想再维护这些应用程序了。欢迎并非常感谢所有帮助。

提前致谢，

ED

# python - 在 Windows XP 上的 Python 上安装 Spynner

> ID：11058250
> 
> 赞同：1
> 
> 时间：2012-06-15T21:12:16.797
> 
> 标签：python, windows, spynner

我在 Windows XP 上运行 Python 2.7。我正在尝试安装 Spynner 作为支持 Javascript 的 Mechanize 的替代方案。当我运行`easy_install spynner`时，安装 lxml 时出现错误：

`Make sure the development packages of libxml2 and libxlst are installed`

我在哪里可以找到这些文件？我找到了适用于 linux 的说明，但没有找到适用于 Windows 的说明。我也尝试了easy_install，但找不到软件包。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T22:43:30.120

由于您运行的是 Windows，请尝试从预编译的二进制包安装 lxml。[pypi.python.org](http://pypi.python.org/pypi/lxml/2.3)托管您可以使用的[二进制文件。](http://pypi.python.org/packages/2.7/l/lxml/lxml-2.3.win32-py2.7.exe)下一次运行`easy_install`应该会检测到新的 lxml 发行版并且安装应该可以工作。

# css - 浏览器对齐兼容性问题

> ID：11058260
> 
> 赞同：0
> 
> 时间：2012-06-15T21:13:02.700
> 
> 标签：css, cross-browser

我的 jsfiddle 在这里[http://jsfiddle.net/pedz/YG3bv/](http://jsfiddle.net/pedz/YG3bv/)

完整页面是[http://jsfiddle.net/pedz/YG3bv/14/embedded/result/](http://jsfiddle.net/pedz/YG3bv/14/embedded/result/)

这是我第一次尝试发布 jsfiddle 页面，所以如果我搞砸了，请告诉我。

如果您使用 Chrome 或 Safari 查看此内容，小三角形左端的最左侧像素位于下划线最右侧像素的正下方。这就是我要的。

如果使用 Firefox（我使用的是 13）查看，小三角形会向右移动两个像素。

有人告诉我，当用 IE9 查看时，它会向左移动一个像素。

几天来，我一直在摆弄这个，主要是比较 Chrome 和 FF。如果您在各种元素中添加边框，那么您可以确定我的一些结论。

FF 和 Chrome 同意左下角，但他们不同意父容器的顶部和右侧。与 Chrome 相比，FF 在右侧多出一列或两列像素。这就是为什么箭头在右边一两个像素的原因。

当您在 foo 跨度周围添加边框时，与 Chrome 相比，FF 会将文本向上移动一个像素。FF 中的下降器不会触及边框，而 Chrome 中它们会（或几乎会）。同样，Chrome 中文本上方（边框内）的空白区域比 FF 中多一些。这个我不关心的特殊问题......这只是我观察到的。

我想我需要“重置”一些 CSS 属性，但我还没有弄清楚我需要哪一个。这真的是我的最终目标......了解浏览器之间的 CSS 属性有什么不同。

我的次要目标是想出一种方法，在不同的浏览器中将小三角形放在同一个地方......或者一种技术来做到这一点。我可以添加浏览器特定的 Javascript 以一种或另一种方式推动事情，但从网络上看，这听起来是一个非常糟糕的主意。

**预览：**

![在 Chrome19 中预览](../Images/0e242e55111638e6e286d1d31a394b72.png) [在 Chrome 19 中预览]

![在 IE9 中预览](../Images/f7b45e8ed9669b99bf727994dacf596e.png) [在 Internet Explorer 9 中预览]

![在 Firefox13 中预览](../Images/4546b4eab26cf22d87e854b10f50ed3f.png) [在 Firefox 13 中预览]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:31:29.427

这当然是一个非常有趣的场景。

看起来 Firefox在 <span>*之后用三角形渲染了一个***不间断的空间** ，这当然不是你的意图。这是因为带三角形的跨度嵌套在另一个跨度内。

 *您代码中的*tbody如下所示：*

```
<td class='upd_apar_def-defect upd_apar_def_dual_button'>
  <span class='foo'>
<a href='some/path' class='upd_apar_def_link'>123456</a><span class='upd_apar_def_span'></span>
  </span>
</td>
<td class='upd_apar_def-apar upd_apar_def_dual_button'>
  <span class='foo'>
<a href='some/path' class='upd_apar_def_link'>987654</a><span class='upd_apar_def_span'></span>
  </span>
</td> 
```

尝试将其替换为解决问题：

```
<td class='upd_apar_def-defect upd_apar_def_dual_button'>
  <span class='foo'>
<a href='some/path' class='upd_apar_def_link'>123456</a><span class='upd_apar_def_span'></span></span>
</td>
<td class='upd_apar_def-apar upd_apar_def_dual_button'>
  <span class='foo'>
<a href='some/path' class='upd_apar_def_link'>987654</a><span class='upd_apar_def_span'></span></span>
</td> 
```

CSS 和 DOM 的其余部分没有问题，但显然 Firefox 似乎做了正确的事情（imo）.. 虽然它值得商榷！:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:22:38.250

乍一看，我看到的是没有设置 font-size 或 font-family 值。内容在不同的浏览器中似乎具有不同的默认字体大小和/或字体系列，这可能是导致布局因浏览器而异的部分原因。

**编辑：**

添加 font-size 和 font-family 后，我仍然看到 FF 和 Chrome 之间的区别。添加传统的[reset.css](http://meyerweb.com/eric/tools/css/reset/)似乎没有任何效果。我怀疑差异主要在于尝试将 CSS 布局样式（位置：绝对等）应用于 HTML 表格元素（td 等）。无论您做什么，这种组合都可能产生不可预知的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T15:48:11.603

修复了火狐问题。

![已在 Firefox 上修复](../Images/f7bb617e2cb1bbe36a8bed6369dda524.png)

[已在 Firefox 上修复]

我已经用额外的*CSS 重置代码*更新了你的 Fiddler 帖子，以实现跨浏览器的[兼容性](http://meyerweb.com/eric/tools/css/reset/reset.css)。制作此文件的本地副本或嵌入到您现有的 CSS 文件中。

我在上面的行添加了以下 CSS 重置代码`/* your CSS starts here */`：

```
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video {
    border:0;
    font-size:100%;
    font:inherit;
    vertical-align:baseline;
    margin:0;
    padding:0;
}

article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section {
    display:block;
} 
```

*   可编辑：http: [//jsfiddle.net/YG3bv/31/](http://jsfiddle.net/YG3bv/31/)
*   全屏结果：http: [//jsfiddle.net/YG3bv/31/embedded/result/](http://jsfiddle.net/YG3bv/31/embedded/result/)

希望这有帮助。*

# mysql - MySQL左外连接，排除第二个表中属于用户的项目

> ID：11058262
> 
> 赞同：10
> 
> 时间：2012-06-15T21:13:07.590
> 
> 标签：mysql, join, left-join

我的 MySQL 数据库中有两个表，一个是数据库中所有书籍的库，另一个包含与用户图书馆中的书籍相对应的各个行。

例如：

**图书馆表**

```
 `id`        `title`...
=====        ===========
  1          Moby Dick
  2          Harry Potter 
```

**收集表**

```
 `id`        `user`      `book`
=====        ======      =======
  1            1            2
  2            2            2
  3            1            1 
```

我想要做的是运行一个查询，该查询将显示所有*不在*用户收藏中的书籍。我可以运行此查询来显示不在*任何*用户收藏中的所有书籍：

```
SELECT * 
FROM  `library` 
LEFT OUTER JOIN  `collection` ON  `library`.`id` =  `collection`.`book` 
WHERE  `collection`.`book` IS NULL 
```

据我所知，这很好用。在 PHPMyAdmin 中运行它会导致所有不在收藏表中的书籍。

但是，如何将其限制为特定用户？例如，对于上面的虚拟数据，如果用户运行查询，我希望得到第 1 本书，如果用户`2`运行查询，我希望没有书籍`1`。

仅添加 a`AND user=[id]`是行不通的，而且由于我对`JOIN`语句的了解极为有限，我真的一无所获。

此外，返回的结果的 ID（显示的查询，它不做我想要的但确实起作用）是 0 - 我如何确保返回的 ID 是`library.id`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-15T21:20:39.840

您必须将`LEFT JOIN`选择范围缩小到特定用户拥有的书籍，*然后*连接表中的任何内容都`NULL`将是用户在他/她的收藏中没有的行（书籍）：

```
SELECT
    a.id,
    a.title
FROM
    library a
LEFT JOIN
    (
        SELECT book
        FROM collection
        WHERE user = <userid>
    ) b ON a.id = b.book
WHERE 
    b.book IS NULL 
```

另一种选择是：

```
SELECT
    a.id,
    a.title
FROM
    library a
WHERE 
    a.id NOT IN
    (
        SELECT book
        FROM collection
        WHERE user = <userid>
    ) 
```

但是，第一个解决方案更优化，因为 MySQL 将为`NOT IN`每一行执行一次子查询，而不是对整个查询执行一次。直观地说，您会期望 MySQL 执行一次子查询并将其用作列表，但 MySQL 不够聪明，无法区分相关子查询和非相关子查询。

[如此处](http://dev.mysql.com/doc/refman/5.6/en/subquery-restrictions.html)所述：

> *“问题在于，对于使用 IN 子查询的语句，优化器将其重写为相关子查询。”*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T21:30:37.577

这个怎么样？这只是我的想法 - 我现在无法访问要测试的数据库。（对不起）

```
SELECT 
   * 
FROM 
   library lib 
WHERE 
   lib.id NOT IN (
      SELECT 
         book 
      FROM 
         collection coll 
      WHERE 
         coll.user =[id]
   )
; 
```

# scala - 如何在 SBT 中使用 Scala 解释器选项？

> ID：11058266
> 
> 赞同：0
> 
> 时间：2012-06-15T21:13:27.803
> 
> 标签：scala, sbt

使用 Scala 解释器时，可以使用以下选项启动它：

```
C:\Users\John>scala -unchecked
Welcome to Scala version 2.9.2 (Java HotSpot(TM) Client VM, Java 1.6.0_32).
Type in expressions to have them evaluated.
Type :help for more information.

scala> 
```

使用 sbt 时，如何使用选项启动 Scala 解释器？以下尝试将不起作用：

```
C:\Users\John\Test Scala Project 1>sbt
[...]
[info] Loading global plugins from C:\Users\John\.sbt\plugins
[info] Set current project to default-8d4ecc (in build file:/C:/Users/John/Tes
t%20Scala%20Project%201/)
> console -unchecked
[error] Expected end of input.
[error] console -unchecked
[error]        ^ 
```

使用 Google & Co，我无法从 sbt shell 中弄清楚如何做到这一点。有人知道吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:50:17.580

```
dcs@shadowfax:~/github/ConwayLife (master *)$ sbt
[info] Loading global plugins from /home/dcs/.sbt/plugins/project
[info] Loading global plugins from /home/dcs/.sbt/plugins
[info] Loading project definition from /home/dcs/github/ConwayLife/project
[info] Set current project to default-0d85ea (in build file:/home/dcs/github/ConwayLife/)
default-0d85ea:master>set scalacOptions += "-unchecked"
[info] Reapplying settings...
[info] Set current project to default-0d85ea (in build file:/home/dcs/github/ConwayLife/) 
```

# python - python 3自我类字典

> ID：11058268
> 
> 赞同：0
> 
> 时间：2012-06-15T21:13:37.923
> 
> 标签：python, methods, dictionary

我正在尝试在 python 3 中创建自己的字典类，它有一个 dict 变量字段以及 setitem 和 getitem 方法。虽然，由于某种原因它不起作用。试图环顾四周，但找不到答案。

```
class myDictionary:
    def __init(self):
        self.myDic={}

    def __setitem__(self, key, value):
        self.myDic[key]=value 
```

我越来越：

```
'myDictionary' object has no attribute 'myDic' 
```

有任何想法吗？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:17:10.567

You forgot the trailing underscores on `__init__()`, try the following:

```
class myDictionary:
    def __init__(self):
        self.myDic={}

    def __setitem__(self, key, value):
        self.myDic[key]=value 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:17:50.070

You've a typo within your `__init__` method. Change it:

```
class myDictionary:
   def __init__(self):
      self.myDic={}

   def __setitem__(self, key, value):
      self.myDic[key]=valu 
```

# ruby-on-rails - 打印出僵尸的名字和墓地。僵尸导轨

> ID：11058271
> 
> 赞同：0
> 
> 时间：2012-06-15T21:14:02.503
> 
> 标签：ruby-on-rails, rails-for-zombies

如何打印出僵尸的名字和墓地

您可以在不添加字符串的情况下将其连接起来吗？

```
z = zombie.find(3)

puts z.name
puts z.graveyard 
```

这是错的吗？它只输出最后一个，墓地。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:23:45.900

`puts "#{z.name} #{z.graveyard}"`

它被称为字符串[插值](http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Literals#Interpolation)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T21:23:56.457

你应该使用

```
puts "#{z.name} #{z.graveyard}" 
```

您可能想知道如何评估它！你应该看看[Interpolation](http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Literals#Interpolation)。表达式的结果`z.name`并被`z.graveyard`连接/插入到字符串中。任何进入的表达式都会`#{ }`被评估并插入到字符串中

# api - 通过 API 检索 Amazon EC2 实例的许可证类型（linux/windows/windows+sqlserver）？

> ID：11058273
> 
> 赞同：0
> 
> 时间：2012-06-15T21:14:03.657
> 
> 标签：api, amazon-ec2, amazon-web-services, billing

我需要计算我的 Amazon EC2 实例的每小时运行成本。这甚至在具有相同硬件配置（实例类型）的实例之间也会有所不同，因为我使用不同的亚马逊映像（AMI）：一些普通的 windows 服务器和一些带有 sql server 的 windows 服务器（与普通的 linux 实例相比，它们都有额外的成本）

EC2 Java API 有一个 describeInstances() 方法，该方法返回带有元数据的 Instance 对象，例如实例 ID、实例类型 (m1.small/large...)、状态 (running、stopped..) public ip 等。

此 Instance 对象还有一个 .getLicense().getPool() ，根据 Java API 应返回“使用此许可证的许可证池（例如：'windows'）。” 我认为这是它也可以提供'windows + sqlserver'或类似效果的东西。

但是 getLicense() 方法确实返回 null..

我在 EC2 Web 控制台中导航，找不到此信息，但我希望这是可能的 - 否则这意味着您无法确定特定实例的真实小时成本，除非您知道哪个 AMI用于首先创建它（普通的 windows server 或带有 sql server 的 windows server）。

任何人？

谢谢 ：）

/盖尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:17:30.273

Have you considered monitoring your actual billing information via [CloudWatch](http://docs.amazonwebservices.com/AmazonCloudWatch/latest/DeveloperGuide/monitor_estimated_charges_with_cloudwatch.html)? It's a relatively new feature...

# jquery - 通过 ASP.NET、jQuery 和 Phonegap 连接到 TFS

> ID：11058276
> 
> 赞同：0
> 
> 时间：2012-06-15T21:14:15.640
> 
> 标签：jquery, asp.net, json, mobile, cordova

我想开发一个移动应用程序，让用户能够运行一套位于 TFS 中的自动化测试用例。这是我今天早上想到的，所以这一切还很初步。但我很好奇这样的事情的最佳路线是什么？或者如果它甚至可能？

因为用户的移动设备从 iphone 到 droid 会有所不同，所以我可能想要合并诸如 Phonegap 之类的东西，因为它具有跨平台功能。

我最初的想法是在 ASP.net/C# 中开发（将存储在远程服务器上），并让 jQuery 调用该服务器。不确定这是否是最合适的处理方式。我对 JSON 不太熟悉，但我认为它是各种网站上处理返回数据的建议。

任何想法或建议表示赞赏。谢谢。

# objective-c - 在自定义位置的 UIView 上放置文本

> ID：11058284
> 
> 赞同：0
> 
> 时间：2012-06-15T21:15:09.843
> 
> 标签：objective-c, ios

我正在尝试计算在屏幕上放置标签的位置。目标是在第一个方块的右下角放置“单词”标签

如果淡黄色方块定义为

```
myView = [[UIView alloc] initWithFrame:CGRectMake(100, 100, 70, 70)];
[self.view addSubview:myView];
[myView setBackgroundColor:[UIColor colorWithHexString:@"FFFFEC"]]; 
```

使用它，我想在它的右下角放置一个标签

```
l1 = [[UILabel alloc] init];
[l1 setText:@"word"];
[l1 setFrame:CGRectMake(myView.frame.origin.x + myView.frame.size.width, 
                        myView.frame.origin.y + myView.frame.size.height,
                       700, 700)];
[l1 setFont:[UIFont fontWithName:@"Arial" size:10.0]];
[l1 setBackgroundColor:[UIColor colorWithHexString:@"CCFFFEC"]];
[l1 setTextAlignment:UITextAlignmentRight];
[l1 sizeToFit]; 
```

这就是发生的事情：

显然，这里的问题是正确的偏移量。**知道文本的字体和大小，如何正确计算呢？**

![在此处输入图像描述](../Images/02528d98e64a5dbc096ed4690226856d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:24:01.793

UIView 的原点映射到左上角。您遇到的问题与您计算标签框架的方式有关。您需要在调用 sizeToFit 后计算框架，以确保在更改标签宽度和高度后将其放置在正确的位置。

您需要在致电后致电`[l1 sizeToFit];`

```
[l1 setFrame:CGRectMake((myView.frame.origin.x + myView.frame.size.width)-li.frame.size.width, 
                            (myView.frame.origin.y + myView.frame.size.height)-l1.frame.size.height,
                           l1.frame.size.width, l1.frame.size.height)]; 
```

你从父视图的宽度加上它的 x 原点减去标签的宽度，并在 y 轴上用高度做同样的事情。这样视图的左上角被放置在正确的位置。

# javascript - 如何使工具提示在mouseenter上保持可见？

> ID：11058285
> 
> 赞同：0
> 
> 时间：2012-06-15T21:15:12.643
> 
> 标签：javascript, jquery, html, events, tooltip

我有一些工具提示的玩具代码。它可以正常工作，只是当您将鼠标移入工具提示时，它会被此逻辑隐藏。

我正在努力寻找一种干净的方法来让工具提示在您将鼠标移入其中时保持可见，并在您将鼠标移出两个区域时消失。有人有建议吗？

[请参阅示例。](http://jsfiddle.net/gNZfG/10/)

**HTML**

```
<div id="container">
    <div id="div1"></div>
    <div id="div2"></div>
</div> 
```

**Javascript**

```
var div1 = $("#div1");
var div2 = $("#div2").hide();

var hoverTimer;
div1.mouseenter(function(e) {
    var x = e.pageX;
    var y = e.pageY;
    div1.mousemove(function(e) {
        x = e.pageX;
        y = e.pageY;
    });
    hoverTimer = window.setTimeout(function() {
        div2.css("left", x);
        div2.css("top", y);
        div2.show();
    }, 400);
});

div1.mouseleave(function(e) {
    window.clearTimeout(hoverTimer);
    div2.hide();
}); 
```

**CSS**

```
#container {
    position: relative;
}
#div1 {
    float: left;
    clear: none;
    width: 200px;
    height: 200px;
    background-color: green;
}
#div2 {
    position: absolute;
    width: 100px;
    height: 100px;
    background-color: blue;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T21:19:18.693

您创建了`mousemove`事件，但除了设置两个变量之外，您实际上从未移动工具提示。试试[这个](http://jsfiddle.net/gNZfG/12/)。注意我在鼠标位置上添加了一个 16 像素的“边距”——这是为了使它更符合实际的工具提示，并防止闪烁效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-23T17:23:42.723

显示工具提示的最佳方式是仅使用 css。

例如

假设我有我必须提供 tooltip 的元素。我将为该元素提供数据属性，然后使用 css 我将访问该属性，然后将显示如下所示的工具提示

```
<a data-tool-tip="my tool tip"> my link goes here</a> this is other text 
```

和 css 将如下所示

```
a[data-tool-tip]{
   position:relative;
}

a[data-tool-tip]::after {
    content: attr(data-tool-tip);
    display:block;
    position:absolute;
    background:gray;
    padding:10px;
    color:white
    border-radius:5px
    font-size:0.8em;
    bottom:100%;
    left:0;
     white-space:nowrap; 
     transform:scale(0);
transition:transform ease-out 150ms;
    }

 a[data-tool-tip]:hover::after {
 transform:scale(1);
} 
```

由于使用选择器附加到元素本身的工具提示，`::before` 它也将在鼠标进入后可见；

**输出将如下所示**

[![在此处输入图像描述](../Images/3561c34e88d8494dc2d09315728b2890.png)](https://i.stack.imgur.com/cGNWG.png)

# scala - Scala 中的双包语句

> ID：11058286
> 
> 赞同：7
> 
> 时间：2012-06-15T21:15:15.253
> 
> 标签：scala, package

我在一些库中看到过，例如 Spray，双包规范是这样的：

```
package cc.spray
package http

// code 
```

这只是 cc.spray.http 包的养眼，还是像这样将两者分开是否有功能上的好处？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T21:47:42.403

这相当于：

```
package cc.spray.http
import cc.spray._
// implicitly, import cc.spray.http._ 
```

也就是说，包`cc.spray`和包的每个成员`cc.spray.http`都是可见的。另一方面，包的成员`cc`是*不*可见的。

通过这种方式，人们可以安全地`java`在其包层次结构中使用名称，而不会造成麻烦，同时，可以轻松地使希望可见的包范围可见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T21:24:08.510

单独的包语句将两者都`cc.spray`放在`cc.spray.http`范围内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-17T08:20:30.713

我们不要忘记从这种方法中获得的一次不错的胜利

```
// Foo.scala
package cc.spray
package http

class Foo {
  ...
}

// Bar.Scala
package cc.spray
package bar

import http._ // concise imports relative to cc.spray

class Bar {
  ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-16T13:24:48.683

与许多其他事情一样，这是在 Scala 2.8 中引入的：其他答案为您提供“什么”（将多个包范围暴露给当前上下文），官方 Scala 文档有[更多详细信息](http://www.scala-lang.org/docu/files/package-clauses/packageclauses.html)，以及详细的理由该功能。

# c# - in c#, how can i acces on remote registry with a specific user?

> ID：11058307
> 
> 赞同：0
> 
> 时间：2012-06-15T21:17:57.643
> 
> 标签：c#, .net, windows-forms-designer, remote-access, remote-registry

Here is the code that i use to reach for remote registry :

```
 private void getAllOdbc(string pc)
    {
        RegistryKey regKey;

        regKey = RegistryKey.OpenRemoteBaseKey(RegistryHive.CurrentUser, pc.ToString(), RegistryView.Registry64).OpenSubKey("SOFTWARE\\ODBC\\ODBC.INI\\ODBC Data Sources");
    } 
```

I would like to access to the remote registry with a specific user that has the permission to the remote computer.

When i launch this windows form application from my own computer, it works because i am already logged in with this specific user that has permission on the remote computer, but i will have to use this application on other computers that are not logged in with this specific user.

So i would like to insert in my code something that will tell my application to access the remote registry with this specific user, like this anyone can use my application without been logged with this specific user.

I already permitted the Remote Registry services on the remote computer.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:29:50.407

您可能必须让您的线程[模拟用户](http://msdn.microsoft.com/en-us/library/w070t6ka.aspx)，然后才能在远程主机上打开他们自己的注册表数据。

# java - Checking if Schema exists in Java Derby

> ID：11058308
> 
> 赞同：1
> 
> 时间：2012-06-15T21:17:59.637
> 
> 标签：java, sql, derby

I am trying to check if a schema that I have created exists. I am trying to use this line to check. I get an error saying " Lexical error at line 1, column 23\. Encountered: "\" (92), after : "". "

Here is the line of code that I use:

```
statement.execute("SELECT " + schema + " FROM "+ dbName + ".SCHEMATA WHERE SCHEMA_NAME = " + "'" + schema + "'"); 
```

I am making a connection just fine and the Database defiantly exists. The dbName is :

```
"C:/.testing/DerbyDB/AssetDB" 
```

What am I doing wrong here?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-15T16:30:50.457

老问题，但这是第一个结果，所以我不妨回应一下。

> 从 SYS.SYSSCHEMAS 中选择 *

而且 Derby 确实支持模式，至少在我正在使用的 v10.8 上。

# python - 将 int 转换为仅包含小写字母和数字并返回的字符串（python）

> ID：11058310
> 
> 赞同：0
> 
> 时间：2012-06-15T21:18:14.067
> 
> 标签：python, string, int

蟒蛇2.7

您如何获取任何数字并能够将其压缩为小写字母和数字？以及如何获取结果字符串并将其放回数字？

对每个 3 个数字的数字块做类似 chr() 的操作是行不通的，因为如果数字块大于 255，它会抛出一个错误，我只想要小写数字和字母。

编辑：

它的主要目的是压缩一个数字。用户将看到并输入它，因此它需要易于输入（不能有 ascii 支持但不在标准键盘上的奇怪字符）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T21:26:09.690

使用[base 36](http://en.wikipedia.org/wiki/Base_36)，以下是您可以在 Wikipedia 上找到的 Python 实现的改编版本：

```
def base36encode(number, alphabet='0123456789abcdefghijklmnopqrstuvwxyz'):
    """Converts an integer to a base36 string."""
    if not isinstance(number, (int, long)):
        raise TypeError('number must be an integer')

    base36 = '' if number != 0 else '0'
    sign = ''
    if number < 0:
        sign = '-'
        number = -number

    while number != 0:
        number, i = divmod(number, len(alphabet))
        base36 = alphabet[i] + base36

    return sign + base36

def base36decode(number):
    return int(number, 36)

>>> print base36encode(1412823931503067241)
aqf8aa0006eh
>>> print base36decode('aqf8aa0006eh')
1412823931503067241 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:26:23.617

`str.lower()` makes a string str lowercase. Alternatively, you could use [regex](http://docs.python.org/library/re.html) to only find letters/words and numbers, but the question is not very clear, so I'm not sure what you mean.

# python - 当一些主机不存在时爬取主机列表

> ID：11058311
> 
> 赞同：0
> 
> 时间：2012-06-15T21:18:14.763
> 
> 标签：python, ssh, paramiko

我正在使用 Paramiko 尝试爬取主机列表。该代码将一直有效，直到列表中的主机之一不可用。它会产生此错误。

```
 File "remote.py", line 12, in <module>
  ssh.connect(i, username='user', password='pass')
  File "/usr/local/lib/python2.7/dist-packages/paramiko/client.py", line 296, in connect  
  sock.connect(addr)
  File "/usr/lib/python2.7/socket.py", line 224, in meth
  return getattr(self._sock,name)(*args) 
  socket.error: [Errno 113] No route to host 
```

我的代码：

```
#!/usr/bin/python
import paramiko

host = ['cpu1','cpu2','cpu3']

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

for i in host:
    str(i)
    ssh.connect(i, username='user', password='pass')
    stdin, stdout, stderr = ssh.exec_command('w')
    print stdout.readlines()
    ssh.close() 
```

我希望脚本运行并执行命令。如果它无法连接到主机，则跳过并转到下一个。我是否缺少带有某些 Paramiko 参数的 if 语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:25:05.910

如果您愿意，您可以尝试捕获异常、处理并可能继续。

```
import paramiko

host = ['cpu1','cpu2','cpu3']

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

for i in host:
    str(i)
    try:
        ssh.connect(i, username='user', password='pass')
        stdin, stdout, stderr = ssh.exec_command('w')
        print stdout.readlines()
        ssh.close()
    except Exception as ex:
        print "Excetion: %s" % str(ex) 
```

始终正确处理异常不要盲目地使用 来逃避它们`pass`，这可能会导致难以发现错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:27:17.377

您缺少任何错误处理；正如[文档解释](http://www.lag.net/paramiko/docs/)的那样，该`connect`方法引发了 4 个不同的异常。在你的情况下，你击中了`socket.error`.

当您想忽略任何连接错误并跳到下一个主机时，您可以使用该[`pass`语句](http://docs.python.org/reference/simple_stmts.html#grammar-token-pass_stmt)忽略这些错误并继续。重要的是，并非`pass`每个例外都只有您想要的例外。

```
import paramiko

hosts = ['cpu1','cpu2','cpu3']

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

for i in hosts:

    try:    
        ssh.connect(i, username='user', password='pass')
        stdin, stdout, stderr = ssh.exec_command('w')
        print stdout.readlines()
        ssh.close()
    except socket.error as e:
        pass 
```

# git - 如何在不需要强制推送的情况下使用 git rebase？

> ID：11058312
> 
> 赞同：113
> 
> 时间：2012-06-15T21:18:30.790
> 
> 标签：git, git-rebase

为了实现 git 必杀技，我花了一天时间学习如何在我目前合并的情况下利用 rebase。

当运行我认为是 git 101 流（我在下面详细说明）`push --force`时，我必须将我的更改推回原点。

我不是唯一一个 - 我知道这是被覆盖的地面（见[1](https://stackoverflow.com/questions/7163457/the-correct-way-of-git-rebase%20-%20dupe) , [2](https://stackoverflow.com/questions/1627906/rebase-push-cycles-for-git-branches) , [3](https://stackoverflow.com/questions/559917/git-rebase-and-git-push-non-fast-forward-why-use) , [4](https://stackoverflow.com/questions/9661059/git-pull-rebase-upstream-git-push-origin-rejects-non-fast-forward) , [5](https://stackoverflow.com/questions/9591141/git-rebase-on-long-lived-remote-feature-branches)），并且我理解*为什么*需要使用武力的技术原因。我的问题是——有许多（许多）博客文章歌颂 rebase 以及它如何改变了他们的生活（参见[1](http://blog.woobling.org/2009/05/git-rebase-considered-awesome.html)、[2](http://gitguru.com/2009/02/03/rebase-v-merge-in-git/)、[3](http://gitready.com/intermediate/2009/01/31/intro-to-rebase.html)、[4](http://darwinweb.net/articles/the-case-for-git-rebase)列出一些），但没有一个提到这`push --force`是他们的流量。然而，几乎所有对现有 stackoverflow 问题的回答都说“是的，如果你要变基，你必须使用`push --force`”。

鉴于 rebase 拥护者的数量和宗教信仰，**我必须相信使用“push --force”不是 rebase 流程的固有部分，如果一个人经常不得不强迫他们推动，他们做错了什么**。

`push --force`是一件[坏事](http://www.randyfay.com/node/89)。

所以这是我的流程。 **在没有力量的情况下我可以通过什么方式获得相同的结果？**

**简单示例**

两个分支：

*   **v1.0** - 发布分支，仅包含补丁
*   **master** - 下一个主要版本的一切。

我有一些补丁提交和下一个版本的一些提交。

![合并前](../Images/5e584ed4cd2c7dcffc36f7059693a5d1.png)

我想将补丁合并到我的 master 中，这样它们就不会在下一个版本中丢失。启蒙前我只想：

```
git checkout master
git merge v1.0 
```

但现在我正在尝试

```
git checkout master
git rebase v1.0 
```

所以现在我在这里：

![在此处输入图像描述](../Images/46c80bdc5097f01819d2432c0aa94273.png)

的时间：

```
git push 
```

没有骰子。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-06-15T21:26:09.217

变基是一个很棒的工具，但是当您使用它来创建主题分支到主分支的快进合并时，它的效果最好。例如，您可以针对 master 重新设置 add-new-widget 分支：

```
git checkout add-new-widget
git rebase -i master 
```

在执行分支的快进合并到 master 之前。例如：

```
git checkout master
git merge --ff-only add-new-widget 
```

这样做的好处是您的历史不会有很多复杂的合并提交或合并冲突，因为您的所有更改都将在合并之前重新基于 master 的提示。第二个好处是您已经重新定位，但您不必使用`git push --force`，因为您没有破坏主分支上的历史记录。

这当然不是变基的唯一用例，也不是唯一的工作流程，但它是我见过的更明智的用途之一。YMMV。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-06-21T12:11:07.670

@CodeGnome 是对的。您不应该在 v1.0 分支上重新设置 master 基础，而是在 master 上重新设置 v1.0 分支，这将产生重大影响。

```
git checkout -b integrate_patches v1.0
git rebase master
git checkout master
git merge integrate_patches 
```

创建一个指向 v1.0 的新分支，将该新分支移动到 master 之上，然后将新版本的 V1.0 补丁集成到 master 分支。你最终会得到类似的东西：

```
o [master] [integrate_patches] Another patch on v1.0
o A patch on v1.0
o Another change for the next major release
o Working on the next major release
|  o [v1.0] Another path on v1.0
|  o A patch on v1.0
| /
o Time for the release 
```

[官方 git 文档](http://git-scm.com/book/en/Git-Branching-Rebasing)推荐这种使用 rebase 的方式。

我认为你是对的`git push --force`：只有当你犯了错误并推动了你不想要的东西时，你才应该使用它。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-06-15T21:20:35.980

如果你变基，你必须强制推送，*并且*你已经发布了你的更改，对吗？

我使用 rebase 一大堆，但我要么发布到强制推送无关紧要的私有内容（例如：我自己在 GitHub 上的克隆，作为拉取请求的一部分），要么我在第一次推送之前 rebase。

这是您使用 rebase 的工作流程的核心，但不要强制推送太多：在它们准备好之前不要发布东西，不要在推送后 rebase。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-06-24T14:45:33.343

我认为这种 rebase-then-force-push 模式有一个很好的用例，这不是错误推送的结果：您自己从多个位置（计算机）处理功能分支。我经常这样做，因为我有时在办公室的桌面上工作，有时在我的笔记本电脑上的家庭/客户站点上工作。我需要偶尔重新设置基准以跟上主分支和/或使合并更清晰，但是当我离开一台机器去另一台机器上工作时（我只是拉动），我还需要强制推送。只要我是唯一一个在分支上工作的人，就可以像魅力一样工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-01-21T23:53:15.407

这是我使用的（假设您的分支名称是*foobar*）：

```
git checkout master              # switch to master
git rebase   foobar              # rebase with branch
git merge -s ours origin/master  # do a basic merge -- but this should be empty
git push origin master           # aaand this should work 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-11T08:25:28.703

tl;dr 与共享分支合并，与各个分支合并。`--force-with-lease`是一种更安全的武力替代方案，应该可以帮助您在没有武力破坏性的情况下实现所说的 git 必杀技。

我见过的适用于各种团队工作流程的一般经验法则是`merge`用于共享分支（即主分支或开发分支）并`rebase`在处理您自己的功能分支时使用。这是一个特征分支的典型生命周期

```
git checkout master
git checkout -b new-feature
git commit -am "commit new work"
git push -u origin new-feature
# have code reviewed, run CI, etc.,
# meanwhile master has new commits
git checkout master
git pull origin
git checkout new-feature
git rebase -i master # -i for interactive rebase allows you to squash intermediate commits
git push --force-with-lease
git merge master 
```

我们在这里所做的简单英文版：

1.  从 master 创建了一个新分支
2.  在分支上完成工作并推送到远程
3.  重新调整主控
4.  将工作推送到远程`force-with-lease`
5.  使用非常干净的 git log 合并到 master 中，减少来自我们共享分支的多次合并的混乱，以使我们的分支“赶上”最新的 master（共享分支）

第四步非常重要，也是我开始提倡使用 rebase 的主要原因之一。`force-with-lease`检查远程以查看是否添加了任何新提交。如果你`git push`被证明是破坏性的，它不会推动！

我希望这能让某人更有信心使用 rebase。

# c# - 故事板 c# 动画

> ID：11058323
> 
> 赞同：0
> 
> 时间：2012-06-15T21:19:42.563
> 
> 标签：c#, xaml, silverlight-4.0, storyboard

好吧，我希望房子图像从 to 旋转`-5°`，`5°`我写了以下代码

```
 Duration duration2 = new Duration(TimeSpan.FromSeconds(1));

        Storyboard sb2 = new Storyboard();
        sb2.Duration = duration2;

        DoubleAnimation da2 = new DoubleAnimation();
        da2.Duration = duration2;

        sb2.Children.Add(da2);

        RotateTransform rt2 = new RotateTransform();

        Storyboard.SetTarget(da2, rt2);
        Storyboard.SetTargetProperty(da2, new PropertyPath("Angle"));
        da2.From = 5;
        da2.To = -5;

        HouseImg.RenderTransform = rt2;
        HouseImg.RenderTransformOrigin = new Point(0.5, 0.5);

        sb2.RepeatBehavior = RepeatBehavior.Forever;
        sb2.Begin(); 
```

但是当它结束时它会迅速进入开始（`5°`），我想要的也是动画。所以总结一下：我想动画从`5°`到`-5°`和从`-5°`到`5°`也。

Tnx :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:22:38.343

将[`AutoReverse`](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.storyboard%28v=vs.95%29.aspx)属性设置为`true`。

```
sb2.AutoReverse = true; 
```

# jar - Tomcat6 moving libraries onto external disk array

> ID：11058326
> 
> 赞同：1
> 
> 时间：2012-06-15T21:19:53.477
> 
> 标签：jar, tomcat6, nfs, catalina

The `catalina.properties` entry for Tomcat6 is as follows:

```
common.loader=${catalina.base}/lib,${catalina.base}/lib/*.jar,${catalina.home}/lib,${catalina.home}/lib/*.jar,/raid/java/lib/*.jar,/raid/java/lib/spring/spring-security-3.1.0.RE
LEASE/dist/*.jar,/raid/java/lib/spring/spring-framework-3.1.0.RELEASE/dist/*.jar,/raid/java/lib/hibernate/*.jar,/raid/java/lib/jstl/*.jar 
```

`server.loader=`

```
shared.loader= 
```

where /raid/.. is a disk array mount point attached to another server. Now, am wondering if i can move the ${catalina.base}/lib and ${catalina.home}/lib libs over to /raid/java/..somewhere as well?

# c# - Select collection of entities based on value of most recent related entity

> ID：11058330
> 
> 赞同：3
> 
> 时间：2012-06-15T21:20:05.763
> 
> 标签：c#, sql-server, entity-framework, tsql

I keep coming across the same type of difficulty in several places in my current project.

The simplest instance is as follows:

I have two related entities, Request and RequestAction. Each RequestAction has a status and a timestamp and points back to a Request.

I need to query a collection of Requests based on the status of the most recent related RequestAction.

Example: Get all Requests where the status of the most recent RequestAction is "Open".

Denormalizing the database to make the most recent status a property of the Request entity is not an option.

I need need the same type of filtering in many other places in my application; I keep track of many versions of items for history and auditing, but I usually only want to look at the most recent version of each item.

I can think of two solutions, but neither is particularly appealing.

1) I can write the SQL manually. The raw SQL answer to this problem involves joining the table to itself with an outer join on the timestamp of one instance of the table being larger than the other, then looking for the records where the second table is null, indicating that no larger timestamp could be found. This is how I handeled the scenario in the past. It is efficient in the database as it uses indexes, unlike a subquery with a max in it. However, my development team is being strongly pushed to use entity going forward to talk to the database, so this solution is being strongly discouraged.

2) I can use entity to load all the values into memory and loop through manually in my code to find the values I am looking for. The code would look something like this:

```
var openRequests = new List<Request>();
var allRequests = context.Requests;
foreach (var request in allRequests)
{
    var recentAction = request.RequestActions
        .OrderByDescending(c => c.ActionTimestamp)
        .First();
    if (recentAction.Status == "Open")
    {
        openRequests.Add(request);
    }
} 
```

While this would provide me with the results I want, it is horribly inefficint and a huge waste of resources and execution time. The database I am querying against is very large and iterating through each record is really not feasable.

Is there an efficient way to do this using entity? I find it hard to imagine that I am the only one who has ever needed this type of functionality.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:24:20.557

SQL 端识别任何打开请求操作的最新时间戳不会是：

```
;WITH MostRecentActions AS 
(
  SELECT RequestID, ActionTimestamp,
    /* other relevant RequestAction columns, */
    rn = ROW_NUMBER() OVER (PARTITION BY RequestID ORDER BY ActionTimestamp DESC)
  FROM dbo.RequestActions
  WHERE Status = 'Open'
)
SELECT RequestID, ActionTimestamp /* , other columns */ 
  FROM MostRecentActions
  WHERE rn = 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T00:28:05.467

您可以在单个数据库查询中使用 LINQ to Entities 进行查询：

```
var openRequests = context.Requests
    .Where(r => r.RequestActions
        .OrderByDescending(ra => ra.ActionTimestamp)
        .Select(ra => ra.Status)
        .FirstOrDefault() == "Open")
    .ToList(); 
```

生成的 SQL 如下所示：

```
SELECT 
[Extent1].[Id] AS [Id], 
[Extent1].[SomeProp1] AS [SomeProp1], 
[Extent1].[SomeProp2] AS [SomeProp2], -- ...etc.
FROM  [dbo].[Requests] AS [Extent1]
CROSS APPLY  (SELECT TOP (1) [Project1].[Status] AS [Status]
    FROM ( SELECT 
           [Extent2].[Status] AS [Status], 
           [Extent2].[ActionTimestamp] AS [ActionTimestamp]
           FROM [dbo].[RequestActions] AS [Extent2]
           WHERE [Extent1].[Id] = [Extent2].[RequestId]
    ) AS [Project1]
    ORDER BY [Project1].[ActionTimestamp] DESC ) AS [Limit1]
WHERE N'Open' = [Limit1].[Status] 
```

我不知道这是否是一个“好”和高性能的 SQL。

# javascript - Javascript and css file search path while running python SimpleHTTPServer

> ID：11058331
> 
> 赞同：1
> 
> 时间：2012-06-15T21:20:09.800
> 
> 标签：javascript, python

I am running a python SimpleHTTPServer and serving a html file. That html file includes couple of javascript files. When the html file is served by the server I get the following errors.

```
1.0.0.127.in-addr.arpa - - [15/Jun/2012 13:42:54] code 404, message File not found
1.0.0.127.in-addr.arpa - - [15/Jun/2012 13:42:54] "GET /lib/jquery-ui/jquery-ui.min.js 
```

Html file contents (only relevant lines shown):

```
<script type="text/javascript" src="../../lib/jquery-ui/jquery-ui.min.js"></script> 
```

Python command used to run the server. It is run in the directory where index.html is present

```
python -m SimpleHTTPServer 8000 
```

I have the files jquery-ui-min.js in my local filesystem. But the search somehow is stripping the ../.. and searching in /lib/jquery-ui/jquery-ui.min.js

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:26:24.240

如果你从一个目录运行 SimpleHTTPServer，它不会超过你运行它的根目录。这是一项安全功能。

例如，假设以下布局：

```
/foo/bar/baz/index.html
/foo/lib/jquery-ui/jquery-ui.min.js 
```

如果您从 运行 SimpleHTTPServer `/foo/bar/baz`，您将无法访问上面的任何文件`/foo/bar/baz`。您可以改为从中运行服务器`/foo/`，它会工作。您还可以在 baz 目录中将符号链接添加到要包含的 JavaScript。

# css - Positioning Images inside that are inside a div around text

> ID：11058332
> 
> 赞同：0
> 
> 时间：2012-06-15T21:20:18.507
> 
> 标签：css, styles, word-wrap

I have an array of div tags that hold images (and captions):

array

```
1 <div style="padding:5px;border:solid black 1px;width:320"><img src="http://local/photos/3645/thumb/320/tj3645_070206_134731_160020_tn320.JPG" id="tnImg160020_320"></div>
2 <div style="padding:5px;border:solid black 1px;width:490"><img src="http://local/photos/3645/thumb/490/tj3645_060406_025416_151917_tn490.JPG" id="tnImg151917_490"></div>
3 <div style="padding:5px;border:solid black 1px;width:170"><img src="http://local/photos/3645/thumb/170/tj3645_061006_042104_153889_tn170.JPG" id="tnImg153889_170"></div> 
```

Then I have a variable that contains the text of an article. The array of images is generated on the fly from settings in a database. The plan is to allow the users to decide where they'd like to position the images (top, right, left, bottom, middle, etc.)

My questions is, what's the best way to wrap the text around the these images? The whole content is currently wrapped inside a main container div:

```
<div id="mainDiv"><div>Images1<div><div>Images2<div><div>Images3<div> Text</div> 
```

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:57:05.000

如果不使用一些 JavaScript，就没有真正的方法。

查看这个[JsFiddle](http://jsfiddle.net/ZMQ73/)，获取一个免费的 JavaScript 示例。我看到的主要问题是文本不会在底部图像之间换行，如果这与您想要做的任何地方接近，请告诉我，我会尝试更多。干杯!

# c - negating characters in C

> ID：11058333
> 
> 赞同：5
> 
> 时间：2012-06-15T21:20:23.223
> 
> 标签：c

Is this undefined behavior? It prints `-128` as the result:

```
#include<stdio.h>
int main()
{
    char i=-128;
    i=-i;
    printf("%d",i);
} 
```

Please explain.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T21:23:53.170

8 位有符号值中 -128 的二进制补码是 -128。

查看二进制值：

原值：10000000

补码：01111111

增量：10000000

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T21:25:07.063

这不是未定义的行为。假设 type`char`在您的平台上签名，它是实现定义的行为。（C99，6.3.1.3p3）

`i = -i`;

`i`in`-i`首先被提升为，然后`int`被整数转换转换为`-i`。`128``128``char`

这是标准的段落，它说 to 的转换`128`是`char`实现定义的：

> (C99, 6.3.1.3p3) 否则，新类型是有符号的，值不能在其中表示；结果是实现定义的，或者引发了实现定义的信号。

**编辑**：虽然它是实现定义的，但大多数实现之间存在共同的实现行为。以下是`gcc`（和大多数其他编译器所做的）文档要做的事情：

> 为了转换为宽度为 N 的类型，该值以 2^N 为模减少到该类型的范围内；没有发出信号

[http://gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html](http://gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html)

请注意，并非所有编译器都以这种方式运行。一些（DSP）编译器刚刚饱和。在这种情况下（并且仍然假设一个有符号的`char`），在`i = -i;`的值之后`i`是`127`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T21:26:45.533

[2的赞美](http://en.wikipedia.org/wiki/Two%27s_complement)

-128 = 0b10000000

所以你想找到：-（-128）：

## 第 1 步（否定）：

`~(-128) = 0b01111111`

## 第2步（加1）：

`0b01111111 + 0b1 = 0b10000000 = -128`

因此，对于 8 位数字，-(-128) = -128！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T21:23:38.840

您正在使用签名的字符。有符号正单字节的最大值为 127。通过否定 -128 以尝试达到 +128，您最终会溢出到 -128。这种行为很可能取决于操作系统和编译器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-15T21:25:07.080

这不是未定义的行为。

乘以 -1 相当于取反位然后加 1。因此，你真的在​​做，

```
~10000000+1 = 01111111+1 = 10000000 
```

这仍然是`-128`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-15T21:25:53.927

我得到相同的结果。

这是程序集（Microsoft Visual Studio）：

```
; File tmp.c
; Line 5
    push    ebp
    mov ebp, esp
    push    ecx
; Line 6
    mov BYTE PTR _i$[ebp], -128         ; ffffff80H
; Line 7
    movsx   eax, BYTE PTR _i$[ebp]
    neg eax
    mov BYTE PTR _i$[ebp], al
; Line 8
    movsx   ecx, BYTE PTR _i$[ebp]
    push    ecx
    push    OFFSET FLAT:$SG775
    call    _printf
    add esp, 8
; Line 9
    xor eax, eax
; Line 10
    mov esp, ebp
    pop ebp
    ret 0
_main   ENDP 
```

注意二进制值。

记住你的“二进制补码”算术。

是否有意义？

====== 附录 ======

这真的，真的很简单。这是一个稍作修改的示例，可能有助于澄清：

```
#include <stdio.h>

int
main (int argc, char *argv[])
{
  int i=-128, j, k, l;
  char c = i;
  printf("i: %d == 0x%x; c: %d == 0x%x\n", i, i, c,c);

  j=-i;
  k=~i;
  l=0-i;
  i=-i;
  c=-c;
  printf("%d, %d, %d, %d, %d\n",i,j,k,l,c);
  printf("0x%x, 0x%x, 0x%x, 0x%x, 0x%x\n",i,j,k,l,c);
  return 0;
} 
```

结果：

```
i: -128 == 0xffffff80; c: -128 == 0xffffff80
128, 128, 127, 128, -128
0x80, 0x80, 0x7f, 0x80, 0xffffff80 
```

# php - Create and write an excel file on server using phpexcel?

> ID：11058339
> 
> 赞同：-2
> 
> 时间：2012-06-15T21:20:38.760
> 
> 标签：php, excel, file, rewrite

How i can create a excel file `.xlsx` into a folder like `'/temp'` , like the creation of text file, than i want to use this file after open to write data into it using PHP, it's that possible??? using `phpexcel` library? The second question is how proceed to write data into cell in a excel file automatic format? how proceed to save data into this file destination??? how to use `::load()` instead of new creation? Can be existed some instruction to writer in phpexcel instead pf reader like this:

```
$objReader = new PHPExcel_Reader_Excel2007();
$objPHPExcel = $objReader->load("05featuredemo.xlsx"); 
```

-->

```
$objReader = new PHPExcel_Writer_Excel2007();
$objPHPExcel = $objReader->load("05featuredemo.xlsx"); 
```

To write directly into existing excel file (safe memory and time)...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T09:15:32.423

不！没有这样的生物！如果不首先使用我知道的任何工具或库（甚至不是 MS Excel 本身）加载它，您就无法编辑 Excel 文件。PHPExcel 也不例外：您将文件加载到内存中（单元格缓存减少了内存需求），根据需要设置单元格值，然后保存文件。所有这些都有完整的文档，有很多示例代码演示了它是如何完成的。

如果您真的想自己编写一些可以“就地”编辑文件的东西，而不使用任何内存并且速度非常快，那么 OfficeOpenXML (xlsx) 文件的结构已被完整记录并可供从 ECMA[公开下载。](http://www.ecma-international.org/news/TC45_current_work/TC45_available_docs.htm)

需要解压缩 .xlsx 文件，这会创建跨多个文件夹的 XML 文件集合。然后，您可以编写一个脚本来单独编辑这些 XML 文件，添加您需要的任何内容。然后重新压缩文件夹和文件以重新创建 .xlsx 文件。显然，您是一位经验丰富的编码员，因此您应该不会觉得这太难了，现在我已经向您介绍了详细说明 OfficeOpenXML 结构的文档。

或者，使用允许您直接调用 Excel COM 或 Open/Libre Office 的包装器来加载、根据需要操作数据，然后保存......但即使这些仍然会在您允许之前加载工作簿操纵它。

# android - Location not accurate and geting an exception in the DDMS

> ID：11058343
> 
> 赞同：0
> 
> 时间：2012-06-15T21:20:58.460
> 
> 标签：android, mapping, location, emulation

I am using osmdroid to display a map from MAPNIK and set the center of the map at aspecific location the applcation works with no errors, but the map is center at a location that is far from the point that I especified in the code, I set the location(lat and long) from the code I needed that way I don't want to send them from the DDMS, My code is:

```
Double latitude = 15.610793;
Double longitude =  32.540152;
int lat = (int) (latitude * 1E6); 
int lng = (int) (longitude * 1E6); 
GeoPoint myPoint = new GeoPoint(lat, lng); 
// show first message
Toast toast = Toast.makeText(getBaseContext(),
    "latitude is :"+lat+"lng is: "+lng, Toast.LENGTH_LONG);
toast.show();

    mapView = (MapView) this.findViewById(R.id.mapView); 
    mapView.setTileSource(TileSourceFactory.MAPNIK); 
    mapView.setBuiltInZoomControls(true); 
    mapView.setMultiTouchControls(true);
    mapController = mapView.getController();
    mapController.setCenter(myPoint);
    mapController.setZoom(15); 
```

and I also have this error in the emulator:

```
[2012-06-16 00:05:21 - ddms] null
java.lang.NullPointerException
at com.android.ddmlib.Client.sendAndConsume(Client.java:573)
at com.android.ddmlib.HandleHello.sendHELO(HandleHello.java:142)
at com.android.ddmlib.HandleHello.sendHelloCommands(HandleHello.java:65)
at com.android.ddmlib.Client.getJdwpPacket(Client.java:672)
at com.android.ddmlib.MonitorThread.processClientActivity(MonitorThread.java:317)
at com.android.ddmlib.MonitorThread.run(MonitorThread.java:263)

[2012-06-16 00:05:21 - ddms] null
java.lang.NullPointerException
at com.android.ddmlib.Client.sendAndConsume(Client.java:573)
at com.android.ddmlib.HandleHello.sendHELO(HandleHello.java:142)
at com.android.ddmlib.HandleHello.sendHelloCommands(HandleHello.java:65)
at com.android.ddmlib.Client.getJdwpPacket(Client.java:672)
at com.android.ddmlib.MonitorThread.processClientActivity(MonitorThread.java:317)
at com.android.ddmlib.MonitorThread.run(MonitorThread.java:263) 
```

sory I ment error not exception and as I said it is in the console labled: DDMS, so the app works fine and does not crash

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T23:56:27.420

我遇到了类似的问题。尝试颠倒以下语句的顺序：

```
mapController.setCenter(myPoint);
mapController.setZoom(15); 
```

希望有帮助！

# javascript - 在 JavaScript 中的 ClickEvent 上选择图像

> ID：11058346
> 
> 赞同：0
> 
> 时间：2012-06-15T21:21:37.040
> 
> 标签：javascript, javascript-events

我需要 JavaScript、HTML、HTML DOM 和 DHTML 方面的帮助。我对 JavaScript 不太熟悉，但我正在尝试使用 JavaScript 和 HTML 创建网站。情况是这样的，

```
div                          div
main image                   main image

image1                       image1
image2                       image2
image3                       image3 
                             image4 
```

默认情况下，它会在页面加载时显示 image1 作为主图像，当用户单击该 div 下的任何图像时，它应该替换主图像。

```
function ChangesSrc()
{
    if(x == 0)
    {
        x = 1;
        document.getElementById('image1').src = "";
        document.getElementById('image1').style.width = "306px";
        document.getElementById('image1').style.height = "230px";   
    }
    else if(x == 1)
    {
        x = 2;
        document.getElementById('image1').src = "";
        document.getElementById('image1').style.width = "306px";
        document.getElementById('image1').style.height = "230px";       
    }
    else if(x == 2)
    {
        x = 0;
        document.getElementById('image1').src = "";
        document.getElementById('image1').style.width = "306px";
        document.getElementById('image1').style.height = "230px";           
    }
    else
    {
        x = 0;
        document.getElementById('image1').src = "";
        document.getElementById('image1').style.width = "306px";
        document.getElementById('image1').style.height = "230px";       
    }

}
</script> 
```

我的问题是我必须在点击事件中为每个图像指定图像 src，并且它还按顺序显示图像（如果我首先单击最后一个图像；仍然它仅将第一个图像显示为主图像）。

谁能指导我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:09:23.220

I'd suggest the following, though it may lack some of your particulars, since I've used CSS to style the smaller images (`.thumbs`) and the main image (`#main`):

```
function show(el) {
    if (!el) {
        // function requires a reference to the clicked element, here 'el'
        return false;
    }
    else {
        // finds the element with id="main"
        var showIn = document.getElementById('main'),
            // sets the sISrc variable with the src of the showIn element
            sISrc = showIn.src,
            // sets the variable 'elSrc' with the src value of the clicked element
            elSrc = el.src;
        // re-sets the src of the 'main' element with the src of the clicked element
        showIn.src = elSrc;
        // sets the clicked element's src to the (previous) value of the 'main' element
        el.src = sISrc;
    }
}

// finds all the images
var images = document.getElementsByTagName('img');

for (var i = 0, len = images.length; i < len; i++) {
    // iterates through all the images and assigns an 'onclick' event-handler
    images[i].onclick = function() {
        // passes the current image into the show() function when clicked
        show(this);
    };
}​ 
```

[JS Fiddle demo](http://jsfiddle.net/davidThomas/LwQwd/).

* * *

**Edited** above code revised to allow for multiple instances of the...gallery thing, this version will only affect the `.main` element (as there are, or may be, multiple elements with the same identifier I've switched to `class` names, though in the current version this requires that the images are within the same (immediate) parent (`el.parentNode`):

```
function show(el) {
    if (!el) {
        return false;
    }
    else {
        var showIn = el.parentNode.getElementsByClassName('main')[0],
            sISrc = showIn.src,
            elSrc = el.src;
        showIn.src = elSrc;
        el.src = sISrc;
    }
}

var images = document.getElementsByTagName('img');

for (var i = 0, len = images.length; i < len; i++) {
    images[i].onclick = function() {
        show(this);
    };
}​ 
```

[JS Fiddle demo](http://jsfiddle.net/davidThomas/LwQwd/1/).

References:

*   [`document.getElementById()`](https://developer.mozilla.org/en/DOM/document.getElementById).
*   [`document.getElementsByTagName()`](https://developer.mozilla.org/en/DOM/document.getElementsByTagName).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:34:53.643

```
function openimage(mainimageurl)
{

        document.getElementById('Idofthebimage').src =mainimageurl;
        //set the width height once in css  

 } 
```

现在说在每张图片上写下这个`onclick="openimage(this.src)"`，或者如果更大的图片网址不同`onclick="openimage('theurlofthebiggerimage')"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:08:03.720

I put together the following demo which shows how you can have a series of image elements and swap them with a main one at the top of the group.

I have included the `window.onload` event handler, as well, since you cannot attach element event handlers until that element has been parsed and added to the DOM, which (in most cases) helps to prevent errors occurring from within your Javascript.

This isn't the only way to handle the problems associated with running scripts before or during page loads (for instance, the script call run inline and access elements that have already been parsed *before* `window.onload` fires). But it is a common, mostly durable solution for smaller, more procedural scripts.

```
<div id="imgs">
    <div>
        <img id="mainimg" src="http://goo.gl/UohAz"/>
    </div>
    <img src="http://www.gravatar.com/avatar/f893555be713a24dee52230712cdde3a?s=128&d=identicon&r=PG"/>
    <img src="http://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG"/>
    <img src="http://www.gravatar.com/avatar/db5a61382c2ba7309071c323edb4013b?s=128&d=identicon&r=PG"/>
</div>

window.onload = function() {
    var imgs = document.getElementById('imgs').getElementsByTagName('img'),
        mainimg = document.getElementById('mainimg'),
        i = imgs.length,
        lastimg;

    var swap = function() {
        var old = mainimg.src;

        mainimg.src = this.src;
        this.src = old;
    };

    while (i--) {
        img = imgs[i];
        img.id = 'img-' + i;

        if (img.parentNode.id == 'main-img') {
            lastimg = img.id;
        }

        img.onclick = swap;
    }
}; 
```

[http://jsfiddle.net/userdude/yq9Fq/](http://jsfiddle.net/userdude/yq9Fq/)

# python - CherryPy server stopped when i run my Turbogear application

> ID：11058347
> 
> 赞同：0
> 
> 时间：2012-06-15T21:21:42.437
> 
> 标签：python, turbogears

When i run my application, it is getting stopped and reports the following error:

> ```
>  2012-06-16 02:40:51,767 turbogears.startup INFO Binding metadata for SQLAlchemy...
>  2012-06-16 02:40:51,785 cherrypy.error ERROR [16/Jun/2012:02:40:51] ENGINE Error in 'start' listener <function start_turbogears at 0x02CE2BF0>
>  Traceback (most recent call last):
>    File "C:\Python27\lib\site-packages\cherrypy-3.2.2-py2.7-win32.egg\cherrypy\process\wspbus.py", line 197, in publish
>      output.append(listener(*args, **kwargs))
>    File "C:\Python27\lib\site-packages\turbogears-1.5.1-py2.7.egg\turbogears\startup.py", line 201, in start_turbogears
>      database.bind_metadata()
>    File "C:\Python27\lib\site-packages\turbogears-1.5.1-py2.7.egg\turbogears\database.py", line 80, in bind_metadata
>      metadata.bind = sqlalchemy.create_engine(dburi, **alch_args)
>    File "C:\Python27\lib\site-packages\sqlalchemy-0.4.4-py2.7.egg\sqlalchemy\engine\__init__.py", line 160, in create_engine
>      return strategy.create(*args, **kwargs)
>    File "C:\Python27\lib\site-packages\sqlalchemy-0.4.4-py2.7.egg\sqlalchemy\engine\strategies.py", line 62, in create
>      dbapi = dialect_cls.dbapi(**dbapi_args)
>    File "C:\Python27\lib\site-packages\sqlalchemy-0.4.4-py2.7.egg\sqlalchemy\databases\mysql.py", line 1420, in dbapi
>      import MySQLdb as mysql
>    File "C:\Python27\lib\site-packages\mysql_python-1.2.2-py2.5-win32.egg\MySQLdb\__init__.py", line 19, in <module>
>      import _mysql
>    File "C:\Python27\lib\site-packages\mysql_python-1.2.2-py2.5-win32.egg\_mysql.py", line 7, in <module>
>    File "C:\Python27\lib\site-packages\mysql_python-1.2.2-py2.5-win32.egg\_mysql.py", line 6, in __bootstrap__
>  ImportError: DLL load failed: The specified module could not be found.
> 
>  2012-06-16 02:40:51,845 cherrypy.error INFO [16/Jun/2012:02:40:51] ENGINE Started monitor thread 'Autoreloader'.
>  2012-06-16 02:40:51,854 cherrypy.error INFO [16/Jun/2012:02:40:51] ENGINE Started monitor thread '_TimeoutMonitor'.
>  2012-06-16 02:40:52,118 cherrypy.error INFO [16/Jun/2012:02:40:52] ENGINE Serving on 127.0.0.1:8087
>  2012-06-16 02:40:52,127 cherrypy.error ERROR [16/Jun/2012:02:40:52] ENGINE Shutting down due to error in start listener:
>  Traceback (most recent call last):
>    File "C:\Python27\lib\site-packages\cherrypy-3.2.2-py2.7-win32.egg\cherrypy\process\wspbus.py", line 235, in start
>      self.publish('start')
>    File "C:\Python27\lib\site-packages\cherrypy-3.2.2-py2.7-win32.egg\cherrypy\process\wspbus.py", line 215, in publish
>      raise exc
>  ChannelFailures: ImportError('DLL load failed: The specified module could not be found.',)
> 
>  2012-06-16 02:40:52,161 cherrypy.error INFO [16/Jun/2012:02:40:52] ENGINE Bus STOPPING
>  2012-06-16 02:40:52,270 cherrypy.error INFO [16/Jun/2012:02:40:52] ENGINE HTTP Server cherrypy._cpwsgi_server.CPWSGIServer(('127.0.0.1', 8087)) shut down
>  2012-06-16 02:40:52,285 cherrypy.error INFO [16/Jun/2012:02:40:52] ENGINE Stopped thread '_TimeoutMonitor'.
>  2012-06-16 02:40:52,296 turbogears.startup INFO TurboGears has already been stopped.
>  2012-06-16 02:40:52,301 cherrypy.error INFO [16/Jun/2012:02:40:52] ENGINE Stopped thread 'Autoreloader'.
>  2012-06-16 02:40:52,308 cherrypy.error INFO [16/Jun/2012:02:40:52] ENGINE Bus STOPPED
>  2012-06-16 02:40:52,312 cherrypy.error INFO [16/Jun/2012:02:40:52] ENGINE Bus EXITING
>  2012-06-16 02:40:52,318 cherrypy.error INFO [16/Jun/2012:02:40:52] ENGINE Bus EXITED
> 
>  System information:
>  OS: Windows 7, Python 2.7, Turbogears: 1.5.1, 
>  dev.cfg: sqlalchemy.dburi = 'mysql://root:mysql@localhost:3306/VistaDB' 
> ```

What may be causing this error?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T00:08:33.427

错误消息是“DLL 加载失败：找不到指定的模块。”

这是一个mysql安装问题

# facebook-php-sdk - 如何获取 Facebook 应用程序的名称及其应用程序 ID 和密码？

> ID：11058349
> 
> 赞同：6
> 
> 时间：2012-06-15T21:22:11.603
> 
> 标签：facebook-php-sdk, facebook-apps

假设我有要使用的应用程序 ID 和应用程序密码，如何使用 Facebook PHP SDK获取应用程序的*名称？*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T21:37:21.287

[https://graph.facebook.com/[APP](https://graph.facebook.com/[APP) ID]

示例：[https](https://graph.facebook.com/102452128776) ://graph.facebook.com/102452128776 ：

```
{
   "id": "102452128776",
   "name": "FarmVille",
   "description": "Join your friends in FarmVille, the world\u2019s biggest farming game! Grow hundreds of crops, trees, and animals! More added every day",
   "category": "Games",
   "subcategory": "Simulation",
   "link": "https://www.facebook.com/apps/application.php?id=102452128776",
   "namespace": "onthefarm",
   "icon_url": "http://photos-g.ak.fbcdn.net/photos-ak-snc7/v85005/144/102452128776/app_2_102452128776_798621234.gif",
   "logo_url": "http://photos-f.ak.fbcdn.net/photos-ak-snc7/v85005/144/102452128776/app_1_102452128776_1417137715.gif",
   "company": "Zynga",
   "daily_active_users": "4200000",
   "weekly_active_users": "10000000",
   "monthly_active_users": "21400000",
   "mobile_web_url": "http://express.farmville.com/fx/"
} 
```

在 PHP SDK 中，应该是 $facebook->api('/'.$APP_ID);

# ios - 在 iCloud 中使用预先存在的 NSFileManager 代码

> ID：11058350
> 
> 赞同：2
> 
> 时间：2012-06-15T21:22:23.133
> 
> 标签：nsfilemanager, ios, objective-c, file, icloud, nsfilemanager

我刚刚写了几百行代码，用于在我的 iOS 应用程序中保存文件、打开文件和删除文件……然后我意识到我可能应该探索 iCloud 并在编写代码时集成它。

**有没有办法将 iCloud 集成到预先存在的 Documents 结构、[nsfilemanager](/questions/tagged/nsfilemanager "显示标记为“nsfilemanager”的问题")类等中？**还是我必须从头开始重写我的大部分代码？

此外，无论哪种方式，是否有任何 iCloud 项目（[类似于这个](https://github.com/MugunthKumar/MKiCloudSync)）可以让我轻松集成 iCloud 文档同步？

* * *

只是我正在使用的一些代码的快速示例：

```
//Begin saving file
NSLog(@"Began Saving File");
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *filePath = [documentsDirectory stringByAppendingPathComponent:filetitle];

//Get the user's keyword preference
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
BOOL enabled = [defaults boolForKey:@"completeFile"];

[[NSString stringWithFormat:@"Message:%@", MessageText] writeToFile:filePath atomically:TRUE encoding:NSUTF8StringEncoding error:NULL]; 
```

* * *

编辑：我在 GitHub 上创建了一个名为[iCloud Document Sync](http://www.github.com/iRareMedia/iCloudDocumentSync)的项目，它允许开发人员轻松地将 iCloud 与其基于文档的 iOS 应用程序集成。问题是它并没有真正遵循普通 iCloud 文件所经历的设计/结构：

1.  文件复制到 iCloud
2.  然后在本地编辑文件并将更改上传到 iCloud
3.  不知何故，我们必须检查本地文件是否比 iCloud 中的文件旧

我的 GitHub 项目在一定程度上解决了这个问题，但我不知道如何从本地目录**复制文件而不是***移动*它们。我遇到的第二个问题是弄清楚如何编辑该本地文件并推送更改 - 当我尝试将更改推送到云中的文件时，我收到一个 Cocoa 错误，上面写着：

> Cocoa 错误 516：文件存在

最后，我不确定如何检查本地文件和云文件之间的差异/冲突。我认为问题在于代码的设计和流程 - 但是我认为由于场景需要代码的布局。

* * *

编辑：我读了这个[SO question](https://stackoverflow.com/questions/14391781/how-do-i-properly-manage-icloud-files-via-nsfilemanager?rq=1)，这似乎是我要问的一部分，但是我想提供一个赏金以获得更清晰和更明确的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T08:52:55.333

这可能会有所帮助。这就是苹果在他们的文档中描述的方式。[https://developer.apple.com/library/mac/#documentation/General/Conceptual/iCloudDesignGuide/Chapters/DesigningForDocumentsIniCloud.html#//apple_ref/doc/uid/TP40012094-CH2-SW1](https://developer.apple.com/library/mac/#documentation/General/Conceptual/iCloudDesignGuide/Chapters/DesigningForDocumentsIniCloud.html#//apple_ref/doc/uid/TP40012094-CH2-SW1)

# c++ - 如何从文本文件c ++中读取具有一定长度空格的输入字符串

> ID：11058351
> 
> 赞同：0
> 
> 时间：2012-06-15T21:22:28.407
> 
> 标签：c++

我的问题是我试图从文本文件中输入字符、字符串然后是 int。我知道如何使用 getline() 进行输入，但是在使用 getline() 函数之后，不再有输入字符串后面的其余整数的选项。我的问题是，如何输入一个字符，然后是一个字符串（带空格），后跟 3 个整数？

data.txt 看起来像这样

```
a   New York    5    7   9
b   Virginia    10   2   5
c   Los Angeles 25   15  6 
```

这是我的代码：

```
 int main()
   {
    string city;
    double price;
    int amt1, amt2, amt3;
    char orderStatus;

    ifstream warehouse;
    ofstream output;
    warehouse.open("data.txt");
    output.open("dataOut.txt");

    while (warehouse.good()) 
    {
        warehouse >> orderStatus;
        output << orderStatus << "\t";

        getline(warehouse, city, '\t');
        //warehouse >> city;
        output << city << endl;

        //warehouse >> amt1;
        //output << amt1 << "\t";

        //warehouse >> amt2;
        //output << amt2 << "\t";

        //warehouse >> amt3;
        //output << amt3;
    }

    warehouse.close();
    output.close();

    return 0;
   } 
```

感谢您非常需要的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:56:44.403

一个快速的解决方案是使用[`atoi`](http://www.cplusplus.com/reference/clibrary/cstdlib/atoi/)（链接到文档）。这听起来像家庭作业，所以我不想为你解决它（这有什么乐趣？）但你可以将值作为字符串拉入。如果您愿意，您还可以一次手动将字符转换为整数并重建数字，但`atoi`会处理所有这些。我猜这些是 std::string，所以你必须调用[`c_str()`](http://www.cplusplus.com/reference/string/string/c_str/)它们，因为 atoi 只接受 C 字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:22:17.180

这是我对您的代码的编辑。我添加了一个`warehouse >> noskipws >> orderStatus >> skipws;`跳过第一个制表符分隔符。此外，`if(!warehouse.good()) break;`在每次读取后添加一个以防数据不完整。如果是C，我会做`fscanf(file, " %c %[^\t]s %d %d %d", ...)`的。

```
#include <iostream>
#include <fstream>
#include <string>

using namespace std;

int main()
{
    string city;
    double price;
    int amt1, amt2, amt3;
    char orderStatus;

    ifstream warehouse;
    ofstream output;
    warehouse.open("data.txt");
    output.open("dataOut.txt");

    while (warehouse.good()) 
    {
        warehouse >> orderStatus; 
        if(!warehouse.good()) break;
        output << orderStatus << "\t";
        // to skip the tab delimiter
        warehouse >> noskipws >> orderStatus >> skipws;
        if(!warehouse.good()) break;

        getline(warehouse, city, '\t');
        if(!warehouse.good()) break;
        output << city << "\t";

        warehouse >> amt1;
        if(!warehouse.good()) break;
        output << amt1 << "\t";

        warehouse >> amt2;
        if(!warehouse.good()) break;
        output << amt2 << "\t";

        warehouse >> amt3;
        if(!warehouse.good()) break;
        output << amt3 << endl;
    }

    warehouse.close();
    output.close();

    return 0;
} 
```

# java - 当相应地设置目标和最小 sdk 时，为什么 LayoutParams.MATCH_PARENT 没有运行时异常？

> ID：11058359
> 
> 赞同：0
> 
> 时间：2012-06-15T21:22:56.803
> 
> 标签：java, android, layout

处理使用 match_parent 2.2 之前的其他问题的答案说明应该使用 fill_parent 以实现安全的向后兼容性。

我注意到的是，当您的 targetsdk 设置为 8 或更高且 minsdk 设置为 7 或更低时，使用 match_parent 或 fill_parent 是无关紧要的。我猜这是 b/c，xml 被编译成二进制 blob，因此一旦将应用程序打包到 apk 中，使用任何一个都无关紧要。

我觉得好奇的是为什么`LayoutParams.MATCH_PARENT`在 2.1 设备上使用 java 代码没有运行时错误。在尝试访问代码中的 LayoutParams.MATCH_PARENT 时，我希望看到 NoSuchClassMember 的某种 RuntimeException。

我猜这可能涉及如何在java中编译类文件。任何见解表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:27:17.633

可以使用任何一个。[**两者具有相同的价值**](http://developer.android.com/reference/android/view/ViewGroup.LayoutParams.html#FILL_PARENT)。在代码上，它会警告你它已被弃用，但它们都是完全相同的东西。

不知道为什么谷歌会做出如此奇怪的改变。我喜欢以前的名字，因为这意味着它填充了 parent 的剩余空间，而不是匹配它，但这是我的意见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:28:29.527

据我所知，这两个是完全一样的。在[文档](http://developer.android.com/reference/android/view/ViewGroup.LayoutParams.html#attr_android:layout_height)中，它转换为相同的值（-1），我认为更改实际上只是适当的命名。

您还可以查看其他问题：[match_parent 和 fill_parent 有什么区别？](https://stackoverflow.com/questions/5761960/what-is-the-difference-between-match-parent-and-fill-parent-property-in-android)

请注意，在 2.2 之前的设备上运行使用 match_parent 的应用程序可以正常工作，但 SDK 会触发错误...

在您发表评论后...无论您在什么上运行它都无关紧要，而只有您使用什么 SDK 来编译...尝试使用 1.6 或 2.1 SDK 进行构建，它会给您这个错误：

```
Description Resource    Path    Location    Type
error: Error: String types not allowed (at 'layout_width' with value 'match_parent').   main.xml    /MyProject/res/layout   line 7  Android AAPT Problem 
```

在 Eclipse 中，您可以通过进入项目的属性，进入“Android”页面并更改“项目构建目标”来更改您正在使用的 SDK。我可以向您保证，如果您尝试使用 2.2 之前不存在的“match_parent”，它将打印一个错误。

![在此处输入图像描述](../Images/2f5bf40073e812bf699cb7ff6ec5435d.png)

# cocoa - 将 NSTask 的输出直接传输到文件？

> ID：11058360
> 
> 赞同：3
> 
> 时间：2012-06-15T21:23:04.420
> 
> 标签：cocoa, pipe, nstask

将 NSTask 的输出直接通过管道传输到文件的最佳方法是什么？我想通过尽可能少的内存缓冲区。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T01:53:30.763

在启动之前，`NSTask`将标准输出和标准错误 ( `setStandardOutput:`, `setStandardError:`) 设置`NSFileHandle`为输出文件（或文件，如果您希望每个输出使用不同的文件）。

An`NSFileHandle`只是底层 OS 文件描述符的包装器，它`NSTask`会做适当的工作以将其连接到指定的输出（即它很可能会执行 dup(2)）。不应引入中间内存缓冲区。

一旦`NSTask`启动，您可以（并且应该）关闭`NSFileHandle`代码中的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-16T13:47:13.680

我将回顾 CRD 的正确答案，添加一个演示代码片段。

这是一个启动`NSTask`收集一些日志的片段（使用“日志显示”命令行工具，将标准输出重定向到文件而不分配和维护缓冲区来执行此操作。

```
NSString *logFilePath = [@"~/Desktop/MyLog.log" stringByStandardizingPath];
NSFileHandle *outFileHandle = [NSFileHandle fileHandleForWritingAtPath:logFilePath];
if(outFileHandle == nil) {
    [[NSFileManager defaultManager] createFileAtPath:logFilePath contents:nil attributes:nil];
    outFileHandle = [NSFileHandle fileHandleForWritingAtPath:logFilePath]; // create the file if needed
} else {
    [outFileHandle seekToEndOfFile]; // append to file if it already exists
}

NSTask *task = [[NSTask alloc] init];
[task setLaunchPath:@"/usr/bin/log"];
[task setArguments: @[@"show", @"--predicate", @"process == \"myProcessName\""]];
[task setStandardOutput: outFileHandle];

@try {
    [task launch];
    [outFileHandle closeFile];  // task already holds it, we need not.
    [task waitUntilExit];
    int status = [task terminationStatus];
    switch (status) {
        case EXIT_SUCCESS: {
            if ([[NSFileManager defaultManager] fileExistsAtPath:logFilePath] == NO)  {
                NSLog(@"Log file not created for some reason, but task succeeded.");
            }
            break;
        }
        case EXIT_FAILURE:
        default:
            NSLog(@"Failed to extract logs. Error:%d", status);
            break;
    }
} @catch (NSException *exception) {
    NSLog(@"Exception occurred running task: %@", exception);
} 
```

# assembly - .-main 表达式的含义

> ID：11058361
> 
> 赞同：4
> 
> 时间：2012-06-15T21:23:10.343
> 
> 标签：assembly, gnu-assembler

这个表达是什么意思：

```
.-main 
```

在以下情况下：

```
.size   main, .-main 
```

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T11:53:05.177

这里，点的`.`意思是“当前位置”。

然后`.-main`是到主要起点的距离。如果放在 main 的末尾，它也将是 main 的*大小*。

# symfony1 - “完整性约束违规：1062 重复条目”与 Symfony 学说版本能够

> ID：11058370
> 
> 赞同：2
> 
> 时间：2012-06-15T21:24:10.110
> 
> 标签：symfony1, doctrine

通过 Symfony 原则更新表时，我偶尔会收到“违反完整性约束：1062 Duplicate entry ... for key 'PRIMARY'”错误。该表是使用相应的历史表创建的。错误不是来自更新表本身，而是来自在历史表中插入记录。我正在使用 Symfony 1.4，学说 1.2。知道是什么原因造成的吗？谢谢。

```
$this->computer = $computerTable->findOneByMacAddress($this->props['mac_address']);
$this->computer->ip_address = $this->ip;
$this->computer->setLastCheckinAt(date('Y-m-d H:i:s')) ;
$this->computer->save();

schema.yml
Computer:
    actAs:
    Timestampable: ~
    History:
        className: %CLASS%History
        auditLog: true
        deleteVersions: false
        cascadeDelete: false
columns:
    mac_address:            { type: string(13), notnull: true, }
    last_checkin_at:        { type: string(60), }
    ip_address:             { type: string(40), fixed: false, notnull: false, }
    ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:17:53.607

在某些情况下很可能`findOneByMacAddress`找不到现有记录，并且您有一个要保存到数据库中的空列 mac 地址。

尝试这样的事情：

```
if(!$this->computer = $computerTable->findOneByMacAddress($this->props['mac_address']))
{
   $this->computer = new Computer();
}
/*do logic here*/
$this->computer->save(); 
```

# clojure - Clojure 代理模型的历史

> ID：11058371
> 
> 赞同：4
> 
> 时间：2012-06-15T21:24:16.913
> 
> 标签：clojure, theory

## 语境

不会向 Clojure 代理发送新值。他们被发送一个应用于旧值的函数。在编程的最初几天，我发现这个反直觉，并且经常编写以下形式的代码：

```
(send some-atom (fn [old] new_value)) 
```

然后，逐渐地，我意识到发送一个更新函数而不是一个新值是多么棒。

## 问题：

这个想法最初来自哪里？发送更新函数（而不是新值）叫什么？这个想法是用于处理并发的不同方式的更通用技术集的一部分吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:33:45.520

Rich Hickey 将此称为[此视频](http://www.infoq.com/presentations/Are-We-There-Yet-Rich-Hickey)中的**功能时间模型**。转述；在传统的 OO 语言中，身份是一个对象，它通过锁定对象从时间 1 的一个状态到时间 2 的另一个状态，然后编辑该对象，使其有效地始终处于它当时所处的状态 - 2、然后解锁。您必须锁定它以确保没有人在状态之间查看它。在该视频中的棒球比赛示例中，这类似于每次球移动时让体育场内的每个人都闭上眼睛并清醒头脑。值得花时间观看原始视频。

原则是**“未来是过去的函数”**

标识是一系列状态，函数定义这些状态之间的转换

哦，为了回答最初的问题，Rich 将这个想法归功于 Alfred North Whitehead

# java - iPhone 到 Android NSMutableDictionary NSArray 到 HashMap ArrayList

> ID：11058374
> 
> 赞同：0
> 
> 时间：2012-06-15T21:24:34.313
> 
> 标签：java, android, objective-c, hashmap, nsmutabledictionary

我在这里的第一篇文章:)

我有一份暑期工作要做一些编码 - 我绝对不是专业人士，但！

我正在将此 iPhone 应用程序转换为 Android，它几乎完成了。只是在努力转换这件作品。

“参与者”数组通过 JSON 传递到服务器。对我来说，在 Android 中，它看起来像是一个 HashMap 数组。那是对的吗？

这是目标C：

```
NSMutableArray *participants = [[NSMutableArray alloc] init];

NSArray *listOfParticipants = [[game getListOfGameParticipants]allValues];

for (Player *playerObj in listOfParticipants)
{
    NSMutableDictionary *playerToAdd = [[NSMutableDictionary alloc] init];
    if ([playerObj.email length] == 0) {
        [playerToAdd setValue:playerObj.phoneNumber forKey:@"Id"];
    }
    else
    {
        [playerToAdd setValue:playerObj.email forKey:@"Id"];
    }

    [playerToAdd setValue:playerObj.firstName forKey:@"FirstName"];
    [playerToAdd setValue:playerObj.lastName forKey:@"LastName"];
    [playerToAdd setValue:playerObj.phoneNumber forKey:@"PhoneNumber"];

    [participants addObject:playerToAdd];

    [playerToAdd release];
} 
```

getListOfGameParticipants 是：

```
- (NSDictionary*) getListOfGameParticipants
{
return participants ;
} 
```

我尝试过的Android代码是：

```
ArrayList<Map<String, String>> list = new ArrayList<Map<String, String>>();
Map<String, String> playersObject = new HashMap<String, String>();
            playersObject.put("Id", "test@test.net");
            playersObject.put("FirstName", "Test Firstname");
            playersObject.put("LastName", "Test Surname");
            playersObject.put("PhoneNumber", "Test Number");
            list.add(playersObject);
json.put("ParticipantIds", list); 
```

请帮忙 ：）

编辑：它不起作用。服务器报告：

```
The server encountered an error processing the request. The exception message is 'Expecting state 'Element'.. Encountered 'Text'  with name '', namespace ''. '. See server logs for more details. 
```

预期的数据类型是：

```
[DataMember]
public Player[] ParticipantIds { get; set; } 
```

编辑：进一步更新：

我现在将我的哈希图数组解析为格式良好的 JSON 字符串。我需要将该 JSON 字符串解析为 JSONObject 并将该 JSONObject 放入 JSONArray。

以下代码不起作用：

```
Map<String, String> playersObject = new HashMap<String, String>();
            playersObject.put("PhoneNumber", "TestNumber");
            playersObject.put("Id", "test@test.net");
            playersObject.put("FirstName", "Test Firstname");
            playersObject.put("LastName", "Test Surname");
            ArrayList<Map<String, String>> list = new ArrayList<Map<String, String>>();
            list.add(playersObject);
            String jsonValue = org.json.simple.JSONValue.toJSONString(list);
            JSONObject hashMapObject = new JSONObject();
            hashMapObject.getString(jsonValue);
            JSONArray hashMapArray = new JSONArray(jsonValue);
            hashMapArray.put(hashMapObject); 
```

它给出了错误：

```
org.json.JSONException: No value for [{"LastName":"Test Surname","FirstName":"Test Firstname","Id":"test@test.net","PhoneNumber":"TestNumber"}] 
```

帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:04:05.797

Android 代码与 iPhone 代码做的事情不同，但就数据结构而言，它似乎是正确的。只需比较这两种方法生成的 JSON，就知道哪里出了问题。

这是 iPhone 生成的 JSON 代码：

```
[
    {
        "Id" : "value",
        "FirstName" : "value",
        "LastName" : "value",
        "PhoneNumber" : "value"
    },
    {
        "Id" : "value",
        "FirstName" : "value",
        "LastName" : "value",
        "PhoneNumber" : "value"
    },
    {
        "Id" : "value",
        "FirstName" : "value",
        "LastName" : "value",
        "PhoneNumber" : "value"
    }
] 
```

只需确保 Android 代码生成相同的内容即可。

**编辑：**

在 Java 中手动生成 JSON 的代码如下所示：

```
String json = "[";

for (Player player : participants) {
    json += "{";
    json += "\"Id\":\"" + (player.email.length() > 0 ? player.email : player.phoneNumber) + "\",";
    json += "\"FirstName\":\"" + player.firstName + "\",";
    json += "\"LastName\":\"" + player.lastName + "\",";
    json += "\"PhoneNumber\":\"" + player.phoneNumber + "\"";
    json += "},";
}

json = json.substring(0, json.length()-1) + "]"; 
```

我不经常编写 Java 代码，但我认为上面生成的 JSON 与您发布的 Objective-C 代码相同。它没有缩进，但我认为服务器不会关心。

# windows-phone-7 - jquery mobile windows phone 7多页不工作

> ID：11058375
> 
> 赞同：1
> 
> 时间：2012-06-15T21:24:40.030
> 
> 标签：windows-phone-7, jquery-mobile, cordova

在 windows phone 模拟器中，简单的 jquery 移动多页导航不起作用。有没有人有办法解决吗？

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, height=device-height, initial-      
scale=1.0, maximum-scale=1.0, user-scalable=no;" />
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="css/custom.min.css" />
<link rel="stylesheet" href="css/jquery.mobile.structure-1.1.0.min.css" />
<link rel="stylesheet" href="css/master.css" />
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/phonegap-1.3.0.js"></script>
<script type="text/javascript" charset="utf-8" src="js/jq.mob-1.1.0.min.js"></script>
<script type="text/javascript" charset="utf-8" src="js/data.js"></script>
<script type="text/javascript" charset="utf-8" src="js/knockout.js"></script>         
<script type="text/javascript">

    document.addEventListener("deviceready", onDeviceReady, false);

    // PhoneGap is loaded and it is now safe to make calls PhoneGap methods
    //
    function onDeviceReady() {

    }

</script>
</head>
<body>
<!-- Home Page -->
<div data-role="page" id="home" data-theme="a">
    <div data-role="header">
        <h1>Menu</h1>
    </div>
    <div data-role="content">
        <h2>Menu</h2>
        <a href="#page1">page 1</a>
    </div>
</div>
<!-- Home Page End -->
<!-- Page 1 -->
<div data-role="page" id="page1" data-theme="a">
    <div data-role="header">
        <h1>Page 1</h1>
    </div>
    <div data-role="content">
        <h2>Page 1</h2>
    </div>
</div>
<!-- Page 1 End -->
</body> 
```

编辑：为了更清晰，我添加了头部部分。

我认为 Windows 手机的多页导航必须被打破，所以如果有人知道替代方案，我将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T13:11:21.897

您可以使用自己的函数来显示和隐藏 div，方法是使用 display 属性和 document.getElementById('')

# c# - 创建 ODBC 连接字符串时的困惑

> ID：11058376
> 
> 赞同：0
> 
> 时间：2012-06-15T21:24:40.717
> 
> 标签：c#, odbc

我正在尝试创建一个连接字符串，以便在 C# 控制台应用程序中使用 ODBC。

![在此处输入图像描述](../Images/cef980c543f56a29b7405f0ed99a0d35.png)

```
var dbConnection = new OdbcConnection("DRIVER={Relativity Client};ServerName=192.168.1.5;Port=21060;Database=Analyzar;UID=USER;PWD=PASSWORD;"); 
```

当然，用户和密码具有正确的值。但我不断收到此错误

***错误 [08S01] [Liant][Relativity][Client][Client LNA]Client 无法访问数据源，因为 RelServer 未在指定的端口号上运行。请联系您的系统管理员寻求帮助。***

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T18:03:36.577

嗨，我自己在寻找我现在已经解决的问题时发现了你的问题。这是您使用示例查找的连接字符串。

```
var dbConnection = new OdbcConnection("DRIVER={Relativity Client};ServerName=192.168.1.5.21060;ServerDSN=Analyzar;UID=USER;PWD=PASSWORD;"); 
```

# xpath - 通过 SoapUI xml 响应解析并遍历节点

> ID：11058377
> 
> 赞同：2
> 
> 时间：2012-06-15T21:24:41.460
> 
> 标签：xpath, xml-parsing, soapui

我目前正在尝试编写一个脚本来断言来自 REST 服务的响应。该服务从数据库中检索日历事件的多个实例，即日历事件的重复实例。soapui 响应如下所示：

```
<Response>
    <items>
        <e>
            <summary>blah blah</summary>
            <start>blah blah</start>
        </e>
        <e>
            <summary>blah blah</summary>
            <start>blah blah</start>
        </e>
        <e>
            <summary>blah blah</summary>
            <start>blah blah</start>
        </e>
    </items>
</Response> 
```

我想遍历每个节点 //Response/items/e 并断言服务器返回的值。我尝试使用 getValueNodes 并将数组返回到变量中，但我似乎无法让它工作。非常感谢您的帮助。

阿萨内

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T07:47:32.037

使用`XmlSlurper`读取 XML 数据并将其转换为对象 - 请参阅此页面以供参考：

[http://groovy.codehaus.org/Reading+XML+using+Groovy%27s+XmlSlurper](http://groovy.codehaus.org/Reading+XML+using+Groovy%27s+XmlSlurper)

您需要添加一个`Script`测试步骤才能使用它。

# c# - 用于自动更新 C# 应用程序的 ClickOnce 或 Windows 安装程序？

> ID：11058382
> 
> 赞同：3
> 
> 时间：2012-06-15T21:25:11.057
> 
> 标签：c#, windows-installer, clickonce

我应该使用 ClickOnce 还是 Windows 安装程序来让我的应用程序自动更新？

我的情况是，我有一个 C# Windows 应用程序，它正在对我通过网络托管服务 (webmasters.com) 维护的数据库运行[MySQL查询。](http://en.wikipedia.org/wiki/MySQL)

该程序现在由三个不同的人使用，我只是将发布文件夹复制粘贴到他们的计算机上，并在他们的计算机上安装 MySQL 连接器和[.NET](http://en.wikipedia.org/wiki/.NET_Framework) Framework 4 客户端，然后运行可执行文件 (.exe)。这听起来不太专业，我在想，既然我喜欢与这个项目一起工作，为什么不做一些正确和专业的事情而不是补丁和修复并从我的经验中学习呢？

所以我正在考虑创建一个设置和部署项目，用于将程序安装到其他计算机上。同样在这个设置和部署项目中，mysql 连接器和 .NET 框架将被包括在内，并将与软件一起安装。一个安装程序供所有人使用。

此外，我在想程序需要更新服务，这样每次我更改代码中的某些内容时，我就不必跑到别人家来更改程序。所以我创建了一个[FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol)站点，我可以在其中上传文件，当程序运行时，它将检查 FTP 站点上的更新，如果上传了任何新文件，它将下载它们并继续使用新版本。我阅读了有关 ClickOnce 应用程序的信息，但我不太了解它是如何工作的。

我已经阅读了*[Deploying C# Applications](http://msdn.microsoft.com/en-us/library/ms173084%28v=vs.80%29.aspx)* (MSDN)，但是我应该选择什么来完成这项工作并使我的程序更专业，而不仅仅是学生的家庭作业？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T21:45:01.770

需要注意的一件事是 ClickOnce 始终安装在当前用户的上下文中。如果他们需要让任何登录到该机器的人都可以使用这个应用程序，那么这个模型就会失败。

使用 Visual Studio 中的安装工具的 MSI 安装程序肯定会为您提供更灵活的安装体验。除了您定义进入应用程序文件夹的内容以及启动文件夹的外观这一事实之外，它还允许自定义安装程序组件。因此，如果您需要让人们安装您的应用程序，但要根据他们的位置输入服务器路径。

您跳过的一个元素是其他安装工具。市场上主要有两种：Wise 和 Install Shield。这些也是很好的工具，我知道您至少可以在 Visual Studio 中构建您的 Install Shield。专业版可以更轻松地合并路径安装程序，从而避免 David Stratton 提到的卸载/安装问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-15T21:34:53.660

完成这三个操作后，我更喜欢通过拖放 ( [XCOPY](http://en.wikipedia.org/wiki/XCOPY_deployment) ) 部署来部署 Windows 应用程序，这意味着首先手动安装先决条件。

*   ClikOnce 很好 - 直到您需要停用它托管的服务器，或者证书过期，或者我必须处理的其他一些小问题。除此之外，它是一种非常强大且简单的方法，可以让您的用户的应用程序保持更新。
    *   公平地说，我遇到的所有问题都有答案，并且可以避免它们，但是文档并没有告诉您“要避免这种情况，请执行此操作”。对我来说，这一切都是“边走边学”。有一个计划指南来预先解释常见的陷阱会很有帮助。
*   [MSI](http://en.wikipedia.org/wiki/Windows_Installer)安装程序也不错，但这意味着卸载/重新安装以进行更新。
*   拖放 - 简单且不那么华而不实，但如果我想进行小更新，我可以复制新文件。

综上所述，所有方法都有优点和缺点，但在我 95% 的部署中，*在公司环境中，部署到我们自己的用户*，我更喜欢 XCOPY 部署。

*如果我要向外部客户提供软件*，我会选择使用专业工具构建的安装程序。

也就是说，Microsoft 提供了[一篇关于在 ClickOnce 或 MSI Installer 之间进行选择的好文章](http://msdn.microsoft.com/en-us/library/ms973805.aspx)。它根本不涉及 XCOPY，但话又说回来，XCOPY 很容易理解，可能没有必要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T21:50:32.457

如果您可以开源您的代码，那么[CodePlex](http://www.codeplex.com/)会为您的安装程序提供 ClickOnce 托管。*[ClickOnce Releases](http://codeplex.codeplex.com/wikipage?title=ClickOnce)*解释了如何设置它。我将它用于[我的示例项目](http://localdbcompanion.codeplex.com/)，效果很好。在我发布更新后，所有客户端都会在第一次启动时自动更新。

# javascript - 如何从javascript中的foreach循环中删除特定的数组元素

> ID：11058384
> 
> 赞同：8
> 
> 时间：2012-06-15T21:25:28.817
> 
> 标签：javascript, arrays

```
var fruit = ["apple","pear","pear","pear","banana"]; 
```

如何从该阵列中删除所有“梨”水果？
我尝试了以下方法，但仍然有一个梨：

```
for(var f in fruit) {
    if ( fruit[f] == "pear" ) {
        fruit.splice(f, 1);
    }
}

for(var f in fruit) {
    document.write(fruit[f]+"<br>");        
} 
```

输出：

```
apple 
pear 
banana 
```

​我做错了什么？现场演示：http: [//jsfiddle.net/SbxHc/](http://jsfiddle.net/SbxHc/)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-15T21:27:21.633

```
var fruit = ["apple", "pear", "pear", "pear", "banana"],
    i;

for (i = 0; i < fruit.length; ++i) {
    if (fruit[i] === "pear") {
        fruit.splice(i--, 1);
    }
}

console.log(fruit);
//["apple", "banana"] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-15T21:28:27.140

```
for (var i = fruit.length - 1; i > -1; i--) {
    if (fruit[i] == "pear")
        fruit.splice(i, 1);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-15T21:34:16.207

当您在遍历数组时从数组中删除项目时，通常会向后迭代，以便当前索引在您删除项目时不会跳过它们：

```
var fruit = ["apple","pear","pear","pear","banana"];
var i;

for (i = fruit .length - 1; i >= 0; i--) {
    if (fruit [i] === "pear") {
        fruit .splice(i, 1);
    }        
}

console.log(fruit ); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-15T21:32:46.263

如果原始数组中有很多“错误”元素，我建议至少考虑不使用就地数组，而是将所有“正确”元素收集到一个新数组中：

```
var rightFruits = [];
for (var i = 0, len = fruit.length; i < len; ++i) {
  if (fruit[i] !== 'pear') {
    rightFruits.push(fruit[i]);
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-15T21:33:45.327

```
var i;
for (i = 0; i < fruits.length; i += 1) {
   if (fruits[i] == "pear") {
      fruits.splice(i, 1);
      i -= 1;
   }
} 
```

# 6.4\. 枚举

由于 JavaScript 的数组实际上是对象，因此该`for in`语句可用于遍历数组的所有属性。不幸的是，`for in`它不能保证属性的顺序，并且大多数数组应用程序都希望元素按数字顺序生成。此外，仍然存在从原型链中挖掘出意外属性的问题。

幸运的是，传统的 for 语句避免了这些问题。JavaScript 的 for 语句与大多数类 C 语言中的语句相似。它由三个子句控制：第一个初始化循环，第二个是 while 条件，第三个执行增量：

```
var i;
for (i = 0; i < myArray.length; i += 1) {
   document.writeln(myArray[i]);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-15T16:39:54.727

您还可以使用`filter`：

```
let noPears = fruits.filter(fruit => fruit != 'pear') 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-12T03:05:22.743

```
var i; while ((i = fruit.indexOf("pear")) > -1) fruit.splice(i,1); 
```

请注意，IE8 及以下版本不支持 Array.indexOf。-_-

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-24T21:38:00.050

为什么不向后迭代列表？这样，当您从列表中删除一个元素并且长度发生变化时，它不会破坏循环逻辑：

```
var fruit = ["apple","pear","pear","pear","banana"];
for (var i = fruit.length - 1; i >= 0; i--) {
    if (fruit[i] === "pear") {
        fruit.splice(i, 1);
    }
}

console.log(fruit); // ["apple", "banana"] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-29T06:59:26.877

如果它不关心迭代反向，你可以使用 while 和数组的 pop-function 的组合

```
var daltons = [ 
  { id: 1, name: "Joe" }, 
  { id: 2, name: "William" }, 
  { id: 3, name: "Jack" }, 
  { id: 4, name: "Averell" } 
];

var dalton;
while (dalton=daltons.pop()) {
  console.log(dalton.name);
}

console.log(daltons); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-06-15T21:29:02.773

```
for(var f in fruit) {
    if ( fruit[f] == "pear" ) {
        fruit.splice(f-1, 1);
    }
}

for(var f in fruit) {
    document.write(fruit[f]+"<br>");        
} 
```

请享用

# php - jquery序列化，获取参数和图片

> ID：11058386
> 
> 赞同：0
> 
> 时间：2012-06-15T21:25:45.677
> 
> 标签：php, jquery, ajax, serialization, get

好的，这个很奇怪，我有这个代码：

```
$('#nps').submit(function(e) {
    e.preventDefault();
    var images = 'pic='+$('img[name="pic"]').attr('src');
    var inputs = $(this).serialize();
    $.ajax({
      url: "pages/"+page+".php?"+inputs+'&'+images+'&action='+param,
      cache: false
    }).done(function( html ) {
        update(html);
    }).fail(function (){
        window.location = "/";
    });
}); 
```

我想要做的是将一些带有表单输入的获取参数和名称为 pic 的图像的 src 传递到 php 页面。

问题是图片参数并不是一直都通过，一次是，另一次不是，随机...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:30:15.990

您没有正确编码您的请求参数。确保使用以下[`encodeURIComponent`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent)函数对它们进行 url 编码：

```
$('#nps').submit(function(e) {
    e.preventDefault();
    var images = encodeURIComponent($('img[name="pic"]').attr('src'));
    var inputs = $(this).serialize();
    $.ajax({
        url: 'pages/' + page + '.php?pic=' + images + '&action=' + encodeURIComponent(param),
        type: 'POST',
        data: inputs,
        cache: false
    }).done(function( html ) {
        update(html);
    }).fail(function (){
        window.location = "/";
    });
}); 
```

现在在您的 php 脚本中，您将能够使用`$_GET['pic']`然后（对于表单元素）。`$_GET['action']``$_POST['someFormElementName']`

# tsql - 如何将计算列添加到表中？

> ID：11058387
> 
> 赞同：66
> 
> 时间：2012-06-15T21:25:49.573
> 
> 标签：tsql, ddl

如何将计算列添加到已经存在的表中？SO 有[计算列帮助 - TSQL](https://stackoverflow.com/q/5841876/456188)但没有关于添加它们的信息。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-06-15T21:26:07.077

我正在寻找的语法是：

```
alter table TABLE_NAME
add [column_name] as (**COLUMN-SQL**) 
```

# regex - Find & Replace 只保留三个中间词

> ID：11058397
> 
> 赞同：1
> 
> 时间：2012-06-15T21:26:26.537
> 
> 标签：regex, replace, openoffice-calc

`data1/data2/data3`

我怎样才能找到并替换这种格式的所有单元格，只导致：

`data2`

始终保持中间项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T06:32:13.467

`More Options...`在搜索框中使用此正则表达式选择“正则表达式”（请参阅​​ ）进行搜索/替换：

```
^.*/(\<[:alnum:]*\>)/.*$ 
```

这是替换：

```
$1 
```

这假设每个单元格中只有三个“dataX”部分。如果单元格包含 data1/data2/data3/data4，则其内容将被替换为 data3。不是数据2-

![在此处输入图像描述](../Images/ed264ea203f2094073770d51988fdd3b.png)

# java - 休眠条件查询 - 任何直接的代码示例？

> ID：11058398
> 
> 赞同：1
> 
> 时间：2012-06-15T21:26:29.930
> 
> 标签：java, hibernate, criteria, hibernate-criteria

我参考了本手册中的[“第 12 章。标准” 。](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/ch12.html)

他们很好地解释了这一点：

> javax.persistence.criteria。**CriteriaBuilder**接口是您开始使用条件查询时需要熟悉的第一件事。它的作用是为标准的所有单独部分提供工厂。您获得了 javax.persistence.criteria。**CriteriaBuilder**实例通过调用 javax.persistence 的 **getCriteriaBuilder**方法。**EntityManagerFactory**或 javax.persistence。**实体管理器**。

但是，没有人说**我在哪里/如何获得这些 EntityManager/EntityManagerFactory 对象**。抱歉，只是不清楚。

我觉得它与我的 Hibernate 会话有关，所以这是我的会话代码，让我知道是否/如何更改它以获取`EntityManager`对象以便我可以继续，我必须在这里遗漏一些东西。

```
import java.io.Serializable;

import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;
import org.hibernate.service.ServiceRegistry;
import org.hibernate.service.ServiceRegistryBuilder;

import x.Debug;

public class HibernateUtil {

    private static final int            DEFAULT_TRANSACTION_TIMEOUT = 3;

    private static final HibernateUtil  m_instance;

    private final SessionFactory        m_session_factory;
    private final ServiceRegistry       m_service_registry;

    private Session                     m_session;

    static {
        m_instance = new HibernateUtil();
    }

    public static HibernateUtil get() {
        return m_instance;
    }

    public HibernateUtil() {
        Configuration configuration = new Configuration();
        configuration.configure();
        this.m_service_registry = new ServiceRegistryBuilder().applySettings(
                configuration.getProperties()).buildServiceRegistry();
        this.m_session_factory = configuration
                .buildSessionFactory(this.m_service_registry);

        this.open_session();
    }

    public void open_session() {
        this.m_session = this.m_session_factory.openSession();
    }

    public void close_session() {
        this.m_session.close();
    }

    public Session get_session() {
        if (!this.m_session.isOpen())
            this.open_session();
        return this.m_session;
    }

    public void save_or_update_objects(final Object[] objects) {
        final Session session = this.get_session();

        try {
            // session.beginTransaction();
            session.getTransaction().setTimeout(DEFAULT_TRANSACTION_TIMEOUT);
            session.getTransaction().begin();

            for (final Object object : objects)
                session.saveOrUpdate(object);

            session.getTransaction().commit();
        } catch (RuntimeException e) {
            session.getTransaction().rollback();
            throw e;
        }
    }

    public Object get_object(final Class<?> clazz, final Serializable id) {
        final Session session = this.get_session();

        if (Debug.DEBUG)
            session.clear();

        final Object ret = session.get(clazz, id);

        return ret;
    }
} 
```

我确实发现了如何简单地构建一个`EntityManagerFactory`与 Hibernate 无关的代码，下面是代码：

```
final EntityManagerFactory entity_manager = Persistence.createEntityManagerFactory("persistenceUnitName"); 
```

但我不确定它是否可以，关于“persistenceUnitName”——它是从哪里来的？！我应该只是发明一个名字吗？

最重要的是，我想要的只是搜索具有特定条件的对象——Hibernate 显然让它变得非常复杂！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:40:30.097

`EntityManager`并且`EntityManagerFactory`是提供者实现的接口。在 Spring 的情况下，您注入一个（参见[Spring ORM JPA](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/orm.html#orm-jpa)）。

在 Hibernate 中，您可以使用[此处](http://docs.jboss.org/hibernate/entitymanager/3.6/reference/en/html_single/#setup-configuration-bootstrapping)描述的引导技术。从那个参考：

```
EntityManagerFactory emf = Persistence.createEntityManagerFactory("manager1"); 
```

# iphone - 带有试用聊天期和后续订阅的免费 iPhone 应用程序？

> ID：11058401
> 
> 赞同：0
> 
> 时间：2012-06-15T21:26:37.360
> 
> 标签：iphone, objective-c, xmpp, in-app-purchase

是否有可能拥有一个免费的 iPhone 应用程序，该应用程序具有初始 3 个月的聊天能力，然后在 3 个月到期后，用户购买不可续订的订阅以获得额外的聊天时间？EG 一个月、四个月还是一年？具体来说，我要问的是，在免费应用程序中是否可以拥有最初可以使用的功能，但在固定的时间段后不再起作用，除非您付费？

使用 Mac 应用程序可以有一个试用期。请参阅此[链接](https://stackoverflow.com/questions/7256360/how-to-implement-a-trial-period-for-a-objective-c-cocoa-mac-osx-app)。所以我认为人们可以为 iPhone 应用程序做同样的事情。尽管过去在 InAppPurchase 可用之前，我知道 iPhone 应用程序的这种试用期行为是不受欢迎的。

我无法通过谷歌得到任何澄清，所以有人知道是否可以试用免费的 iPhone 应用程序聊天？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:29:23.303

这样做应该没问题，因为那里有很多免费的应用程序，但某些用途需要付费。苹果需要的是，所有付款都必须通过他们的支付系统才能获得分成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T15:33:49.097

[在应用内购买和试运行？](https://stackoverflow.com/questions/7865658/in-app-purchases-and-trial-runs)

或者

[http://www.submitiphoneapps.com/app-store-submission-tips/](http://www.submitiphoneapps.com/app-store-submission-tips/) （阅读“恰到好处的“精简版”部分）

我想说的不是权威，而是一些东西。

# c++ - std::list of pointers 在条目删除时变得无效

> ID：11058402
> 
> 赞同：1
> 
> 时间：2012-06-15T21:26:38.317
> 
> 标签：c++, pointers, segmentation-fault, stdlist

我有一个指针列表，这些指针引用了我的游戏中需要转弯的时间对象。此示例`TimeObject*`在列表中有两个。此代码一直有效，直到从列表中删除一个项目：当发生这种情况时，另一个指向的地址将变为无效地址。发生这种情况时，两者都不会`TimeObject`被删除；只有指针从列表中删除。这是什么原因造成的？

`TimeUnlink()`中调用`TimeObject::Tick()`。它不是静态的，但列表是。

我在 Linux 上使用 GCC 4.6.2。该程序没有线程。

```
void TimeObject::TimeUnlink()
{
    printf("Time unlink\n");

    TimeObject::list_.remove(this);

    timeobject_flags_.linked_ = 0;
}

void GameTime::GameTurn(uint16_t _time)
{
    tick_ += _time;

    for(std::list<TimeObject*>::iterator it = TimeObject::list_.begin(); it != TimeObject::list_.end(); ++it)
    {
        TimeObject *timeobject = *it;

        printf("GameTurn %p\n", timeobject);

        if(timeobject == NULL) { printf("continue\n"); continue; }

        timeobject->time_ += _time;

        if(timeobject->speed_ && timeobject->time_ >= timeobject->speed_)
        {
            while(timeobject->timeobject_flags_.linked_ && timeobject->time_ - timeobject->speed_ > 0)
            {
                timeobject->time_ -= timeobject->speed_;

                if(timeobject->mapobject_)
                {
                    timeobject->mapobject_->Tick();
                }
            }
        }
    }
} 
```

错误输出：

```
GameTurn 0xc1e048
GameTurn 0x696828
GameTurn 0xc1e048
GameTurn 0x696828
GameTurn 0xc1e048
GameTurn 0x696828
GameTurn 0xc1e048
Time unlink
GameTurn (nil)
continue
GameTurn 0xc1e030

Program received signal SIGSEGV, Segmentation fault.
0x00000000004059a1 in GameTime::GameTurn(unsigned short) () 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T21:51:10.393

`0xc1e048`在您的输出序列中，指针在和之间交替`0x696828`，这意味着它`0xc1e048`是列表中的第一项并且`0x696828`是第二项。基于此，看起来 at 的对象在循环中间`0xc1e048`时被取消链接`GameTurn::GameTurn`，很可能是在对 的调用`timeobject->mapobject_->Tick()`或@hmjd 提到的另一个线程中。从列表中删除一个对象会使指向该对象的迭代器无效。

假设代码是单线程的并且调用`Tick`导致问题，那么这样的事情可能会起作用：

```
void GameTime::GameTurn(uint16_t _time)
{
    tick_ += _time;

    for(std::list<TimeObject*>::iterator it = TimeObject::list_.begin(); it != TimeObject::list_.end(); )
    {
        TimeObject *timeobject = *it;
        ++it;

        printf("GameTurn %p\n", timeobject);

        if(timeobject == NULL) { printf("continue\n"); continue; }

        timeobject->time_ += _time;

        if(timeobject->speed_ && timeobject->time_ >= timeobject->speed_)
        {
            while(timeobject->timeobject_flags_.linked_ && timeobject->time_ - timeobject->speed_ > 0)
            {
                timeobject->time_ -= timeobject->speed_;

                if(timeobject->mapobject_)
                {
                    timeobject->mapobject_->Tick();
                }
            }
        }
    }
} 
```

（唯一的区别是在分配给之后`it`从`for`语句移动到循环体的增量。在它失效之前推进应该可以解决问题。`it``timeobject``it`

如果您的代码是多线程的，您将需要一个互斥锁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T21:43:35.650

当您从 list_ 中删除对象时，您需要注意迭代器，因为在您删除列表条目后它变得无效

一种方法是在删除项目之前，记住列表中的下一个条目，并在删除对象后继续。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-15T21:43:43.653

是否调用：

```
timeobject->mapobject_->Tick(); 
```

导致 TimeUnlink() 被调用然后 remove 被调用？

当您从列表中删除时，被删除元素的迭代器将变为无效，但您的代码可能会继续尝试通过执行 ++it 来使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-15T21:48:08.947

看起来你正在删除 s.th。在 GameTurn 方法的迭代循环期间从列表中获取。这使得迭代器无效。您必须记住要从列表中删除的项目，并在循环结束后从列表中删除这些项目。

# eclipse - 无法在 Eclipse 中加载属性文件 - JUnit 测试

> ID：11058403
> 
> 赞同：1
> 
> 时间：2012-06-15T21:26:42.123
> 
> 标签：eclipse, maven, properties, junit, classpath

我在 Mac 10.7.4 上运行 Eclipse Indigo。我在 Eclipse 中设置了一个 Maven (3.0.3) 项目，但是当我从 Eclipse 中运行 JUnit 测试时，它无法在我的 src/main/resources 目录中加载属性文件。但是，在 Maven 命令行上运行相同的测试通过了，所以我想知道我的设置有什么问题。这是测试......</p>

```
@Before
public void setUp() throws IOException { 
    ...
    stateService = new StateService("states.properties");
    ...
}   // setUp

@Test
public void testPositive() { 
    final String stateName = stateService.getStateFromAbbrev("TX");
    Assert.assertEquals("Texas", stateName);
}   // testPositive 
```

以下是我加载属性文件的方式……</p>

```
public StateService(final String propertiesFile) {
    abbrevToWordsProps = new Properties();
    InputStream in = null;
    try{
        in = this.getClass().getClassLoader().getResourceAsStream(propertiesFile);
        abbrevToWordsProps.load(in);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace(System.err);
    } finally {
        if (in != null) { 
            try {
                in.close();
            } catch (IOException e) {
            }
        }   // if
    }
} 
```

当我通过 Eclipse 运行测试时（通过右键单击 Package Explorer 中的 Java 测试文件并转到 Run As -> JUnit Test），它会因这个异常而死掉……</p>

```
java.lang.NullPointerException
    at java.util.Properties$LineReader.readLine(Properties.java:418)
    at java.util.Properties.load0(Properties.java:337)
    at java.util.Properties.load(Properties.java:325)
    at org.mainco.myco.dido.service.StateService.<init>(StateService.java:16)
    at org.mainco.myco.dido.test.AbstractDIDOTest.setUp(AbstractDIDOTest.java:29)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T20:26:55.387

确保 'src/main/resources' 目录位于您的 eclipse JUnit 测试类路径中（请参阅 参考资料`Run configuration -> classpath tab`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-17T17:32:09.447

请使用以下代码：-

```
 this.getClass().getResourceAsStream(propertiesFile); 
```

请不要使用“ ***getClassLoader()*** ”。

我希望这可能会有所帮助。

# css - /**/ 在 css 中是什么意思？

> ID：11058404
> 
> 赞同：1
> 
> 时间：2012-06-15T21:26:42.513
> 
> 标签：css

我在一些 CSS 中包含以下内容，可能是由 Sylizer 引入的（新版本现在抱怨它）：

```
/*Disabling quote effect in IE5 +*/
   background /**/: url("bungalow_copy(1).css"); 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T21:28:58.043

这是一条注释，请参阅[CSS3 语法：4.10。评论](http://www.w3.org/TR/css3-syntax/#comments)。

您可以在评论中添加其他信息，例如提醒您某些浏览器的某些修复或一些难以实现的特殊效果：

```
/* The basic class for styling */
.basic{
   color: blue;
   border: 1px solid; /* take text color */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T21:27:35.657

包含的任何内容`/**/`都是注释，它什么也不做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T21:28:25.100

这意味着它是一个评论。因此，如果您环绕`/**/`某些内容，则会将其注释掉。

例如：`/* You are awesome */`它将显示为灰色或您的编辑器为评论设置的任何颜色

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-15T21:29:54.023

通常，介于`/*`和之间`*/`的任何内容都是注释，因此被浏览器完全忽略。

至少，它应该是。在这种情况下，看起来空评论被设计为一种浏览器黑客，以使某些东西“工作”。

# python - Python 和 Matlab 使用的最简单的数据库是什么？

> ID：11058409
> 
> 赞同：4
> 
> 时间：2012-06-15T21:27:04.387
> 
> 标签：python, database, matlab

我需要处理大量的数字/文本数据，比如总共 100 亿个条目，理论上可以组织为 1000 个 10000*1000 个表。大多数计算每次都需要对一小部分数据（特定的行或列）执行，这样我就不需要一次所有的数据。

因此，我有兴趣将数据存储在某种数据库中，这样我就可以轻松地搜索数据库，检索符合定义条件的多行/列，进行一些计算并更新数据库。数据库应该可以通过 Python 和 Matlab 访问，我主要使用 Python 创建原始数据并将其放入数据库和 Matlab 进行数据处理。

整个项目在 Windows 7 上运行。我可以为此目的使用的最好且主要是最简单的数据库是什么？我完全没有数据库方面的经验。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T21:32:33.520

我会推荐[SQLite](http://docs.python.org/library/sqlite3.html)。默认的 Python 安装已经有它的绑定。

要使用安装适当的[SQLite Windows](http://www.sqlite.org/download.html)安装程序。

要创建数据库，您可以执行以下操作（来自 sqlite3 文档）：

```
import sqlite3

conn = sqlite3.connect('example.db')

c = conn.cursor()

# Create table
c.execute('''CREATE TABLE stocks
             (date text, trans text, symbol text, qty real, price real)''')

# Insert a row of data
c.execute("INSERT INTO stocks VALUES ('2006-01-05','BUY','RHAT',100,35.14)")

# Save (commit) the changes
conn.commit()

# We can also close the cursor if we are done with it
c.close() 
```

要导入 Matlab，您可以使用[mksqlite](https://github.com/AndreasMartin72/mksqlite)。

有关更多信息，您可能需要结帐： http: [//labrosa.ee.columbia.edu/millionsong/pages/sqlite-interfaces-python-and-matlab](http://labrosa.ee.columbia.edu/millionsong/pages/sqlite-interfaces-python-and-matlab)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T21:41:02.380

IMO 只需将文件系统与您可以在 MATLAB 和 Python 中读/写的文件格式一起使用。数据库通常意味着关系模型（不包括 No-SQL 模型），这只会增加这里的复杂性。

`scipy.io.loadmat`由于更倾向于 MATLAB，您可以使用/`scipy.io.savemat`函数直接在 SciPy 中操作 MAT 文件。这是用于存储数据的原生 MATLAB 格式，带有`save`/`load`函数。

除非您确实需要数据库，否则请忽略我的回答:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-16T20:06:59.780

SQLite 很容易设置，但我对 MySQL 没有任何问题。有可用的连接器，并且可以无缝地工作。

[http://www.mathworks.com/matlabcentral/fileexchange/8663-mysql-database-connector](http://www.mathworks.com/matlabcentral/fileexchange/8663-mysql-database-connector)

我正在运行一个类似的项目，我使用 Matlab 来获取和分析，并使用 Ruby on Rails 发布大量股票市场数据。使用非常大的数据集，这个解决方案似乎运作良好。从历史上看，对于大型数据集，SQLite3 的性能不如 MySQL 或 PostgreSQL，这就是我建议切换的原因。

# android - 如何在 Eclipse 中支持支持较旧的 android 版本

> ID：11058415
> 
> 赞同：2
> 
> 时间：2012-06-15T21:27:29.373
> 
> 标签：android, eclipse, android-3.0-honeycomb, backwards-compatibility, android-2.2-froyo

我的应用程序需要针对 API 级别 7 及更高级别，但是我想在新版本可用时有选择地使用新版本的功能。例如，我可能有这样的代码：

```
if (Build.VERSION.SDK_INT >= 8) {
    base64String = android.util.Base64.encodeToString(bytes, android.util.Base64.DEFAULT);
} else {
    base64String = MyCustomBase64.encodeBytes(bytes);
} 
```

但是，当我在 Eclipse 中将项目配置为以“Android 2.1”（API 7）为目标时，找不到类 android.util.Base64，因为它仅适用于 API 8 及更高版本。然后 Eclipse 将该行指定为编译错误（红色“x”），因为该类不在构建路径上。

我的问题：在使用 Eclipse 进行 Android 开发时，处理此类开发（支持目标环境中实际上不存在的功能）的“正确”方式是什么？

我总是可以将 Eclipse 中的目标更改为 2.2 (API 8)，但这也不理想。它造成了这样一种情况，即我可能会在不知不觉中使用仅存在于 8+ 中的功能，而 Eclipse 不会通知该事实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:32:51.773

你已经回答了你自己的问题。

> 我总是可以将 Eclipse 中的目标更改为 2.2 (API 8)

这就是它的完成方式。您仍然可以将清单中的 minSDK/targetSDK 设置为 7。AFAIK 您只需要使用 if 语句，就像您在任何来自更高 API 级别的代码中显示的那样。

# c - Xcode初学者 - 编译问题

> ID：11058416
> 
> 赞同：0
> 
> 时间：2012-06-15T21:27:33.693
> 
> 标签：c, xcode

我对 Xcode 环境很陌生。我想编译一些 .c 和 .cpp 文件。所以我用通用的 c++ 插件创建了一个项目（这是正确的选择吗？）。它成功构建了文件，但我没有显示结果，即使是“hello world”printf 文件也是如此。任何人都可以帮忙吗？如果有人可以推荐一些好的教程，那就太好了！

这是我的示例代码：

```
#include <stdio.h>

int main (){
    printf("Hello World");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:58:17.100

您应该创建一个`Command Line Tool`项目，而不是通用 C++ 插件。

完成此操作后，您的输出将显示在 xcode 的控制台窗口中。

# c++ - 映射运算符 [] 和 bool 作为值

> ID：11058422
> 
> 赞同：29
> 
> 时间：2012-06-15T21:28:01.280
> 
> 标签：c++, stl, map

我们知道，如果我们尝试使用`std::map`运算符 [] 访问一个不存在的键，该函数将使用该键插入一个新元素。

我们有：`std::map<std::string, bool> map_xxx;`

是否保证在访问不存在的键后`map_xxx["nonexistent_key"]`，第二个参数的值将始终为`false`？

附言。如果没有，任何想法如何有这种行为？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-15T21:30:52.350

**是的。保证要插入的值是`false`.**

* * *

在 C++98 中，该机制被称为默认初始化，指定为非类的零初始化；那是`false`布尔值。

从 C++03 开始​​，该机制称为值初始化，仍然指定为非类的零初始化；因此仍然`false`适用于布尔值。例如，让我们看看 C++14 对此有何评论。

从§23.4.4.3；只需替换`bool`“T”即可。

> **T** & operator[](const key_type& x);
> 
> 1.  效果：如果映射中没有与 x 等效的键，则将 value_type(x, **T()** ) 插入映射中。
> 2.  要求：key_type 应为 CopyInsertable，mapped_type 应为 DefaultInsertable 到 *this。

从第 8.5 节开始，自下而上消化段落：

> 对 T 类型的对象或引用进行零初始化意味着：
> 
> — 如果 T 是标量类型（3.9），则将对象初始化为通过**将**整数文字**0**（零）转换为 T 获得的值；
> 
> ...
> 
> 对T 类型的对象进行**值初始化**意味着：
> 
> — 如果 T 是（可能是 cv 限定的）类类型（第 9 条），没有默认构造函数（12.1）或用户提供或删除的默认构造函数，则对象被默认初始化；
> 
> — 如果 T 是一个（可能是 cv 限定的）类类型，没有用户提供或删除的默认构造函数，则该对象为零初始化并检查默认初始化的语义约束，如果 T 具有非平凡的默认值构造函数，对象是默认初始化的；
> 
> — 如果 T 是一个数组类型，那么每个元素都是值初始化的；
> 
> — 否则，对象是**零初始化的**。
> 
> ...
> 
> 初始值设定项为空括号集的对象，即**()**，应进行**值初始化**。

从§4.12：

> 算术、无范围枚举、指针或指向成员类型的指针的纯右值可以转换为 bool 类型的纯右值。零**值**、空指针值或空成员指针值**转换为 false**；任何其他值都将转换为 true。对于直接初始化 (8.5)，std::nullptr_t 类型的纯右值可以转换为 bool 类型的纯右值；结果值为假。

# windows - Windows 命令脚本通配符问题

> ID：11058429
> 
> 赞同：0
> 
> 时间：2012-06-15T21:28:32.880
> 
> 标签：windows, scripting, cmd, wildcard

所以我想将文件夹中的所有文件复制到具有不同扩展名的文件夹中。我在 Windows 7 上，我认为最简单的方法是使用 .cmd 脚本。（我决定反对 .bat，因为这似乎是一个较旧的解决方案）

我的文件遵循这种模式

```
BrettFavre.nunit.config
JohnElway.nunit.config
TimTebow.nunit.config 
```

我想让他们看起来像这样

```
BrettFavre.dll.config
JohnElway.dll.config
TimTebow.dll.config 
```

我的解决方案是 `copy *.config *.dll.config`

结果不是以 .dll.config 结尾，而是以 .nunit.dll.config 结尾。任何想法，如果您知道 cmd 脚本的良好参考，请告诉我。我很难确定指南是用于 .bat 还是用于 .cmd 。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T03:39:53.147

从命令行：

```
for %A in (*.config) do for %B in ("%~nA") do copy "%A" "%~nB.dll.config" 
```

从批处理文件中，将百分比加倍

```
for %%A in (*.config) do for %%B in ("%%~nA") do copy "%%A" "%%~nB.dll.config" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:36:57.440

从命令行使用 powershell（当然你也可以把它放到脚本中）：

```
PS> $files = Get-ChildItem *.nunit.config
PS> foreach($file in $files) {
>> $newname = [regex]::replace($file, "nunit", "dll")
>> Copy-Item $file -destination $newname
>> }
>> 
PS> 
```

您可以将其压缩为单行命令，如下所示：

```
gci *.nunit.config | % {copy $_ -dest ($dest = [regex]::replace($_, "nunit", "dll"))} 
```

@Joey 提出了一个很好的观点。您可以使用 -replace 运算符简化此操作：

```
gci *.nunit.config | % {copy $_ -dest ($_ -replace "nunit", "dll")} 
```

# bash - 修复域列表的 Bash 脚本

> ID：11058430
> 
> 赞同：1
> 
> 时间：2012-06-15T21:28:34.410
> 
> 标签：bash, sed, awk

我知道这对你们中的一位大师来说真的很容易！

我有一个这样的列表：

```
 www.google.com
 ebay.com
 yahoo.com
 www.bing.com
 www.buy.com
 woot.com
 news.google.com
 images.google.com 
```

我正在尝试编写一个 bash/sed/awk 脚本来清理这个列表。我需要列表看起来像这样：

```
 www.google.com
 www.ebay.com
 www.yahoo.com
 www.bing.com
 www.buy.com
 www.woot.com
 news.google.com
 images.google.com 
```

总之，它需要添加“www”。如果它还没有 www 或子域。该列表位于名为 theList 的文件中。我的蹩脚尝试是这样的：

```
 sed 's/^www\./' theList > cleanedList 
```

这显然不适用于已经有 www 或子域的情况。任何想法，将不胜感激。

谢谢！

电动汽车

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:32:54.987

使用 awk 比使用 sed 容易得多。例如：

```
awk -F. 'NF == 2 {print "www." $0; next}; {print}' theList > cleanedList 
```

这将“子域”定义为名称中少于两个点的任何内容，使用点作为每个记录中的字段分隔符。你当然可以调整它以适应。

它正确处理提供的语料库，如您在此处看到的：

```
$ cat cleanedList
www.google.com
www.ebay.com
www.yahoo.com
www.bing.com
www.buy.com
www.woot.com
news.google.com
images.google.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:38:01.820

在 bash 中，你可以这样写：

```
while read; do
  case "$REPLY" in
  www.*|*.*.*)         # begins with www. or contains at least two dots...
    echo "$REPLY"      # ...leave as-is
    ;;
  *)                   # all other cases...
    echo "www.$REPLY"  # ...prepend "www."
    ;;
  esac
done < theList > cleanedList 
```

外部 while 循环从 stdin 读取（重定向到`theList`最后一行），一次一行。如果没有其他参数，该行将在 shell 变量中结束`$REPLY`。

case 语句类似于 C 的 switch 语句，但它与通配符模式而不是整数常量进行比较。我们使用它将 ( `$REPLY`) 行分为两类：一类不需要`www.`前置，另一类不需要。

第一个模式 ( `www.|*.*.*)`) 实际上有两种选择：要么匹配行`www.*`（即以 开头`www.`），要么匹配`*.*.*`（即，它包含至少两个点（它们可能是相邻的，但这不是验证模板名称的模式），因为`*`在 Unix 中也匹配`.`s)。在这种情况下，我们只是输出我们得到的行。

第二个模式 ( `*)`) 匹配所有内容，但只有在第一个不匹配时才会选择它。在这些情况下，我们输出`"www.$REPLY"`，即。我们添加`www.`到刚刚读到的那一行。

它们一起实现了您描述的算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T21:45:15.203

关键在于[正则表达式](http://rubular.com/r/vNgCLb2rhy)。它捕获所有没有子域的独立域，然后将其替换为`www.`和自身。

```
sed -ri 's/^([^.]+\.[^.]+)$/www.\1/' YOUR_FILENAME 
```

或者：

```
sed -r 's/^([^.]+\.[^.]+)$/www.\1/' YOUR_FILENAME > NEW_FILENAME 
```

# c++ - 用模板重写的类会使程序变慢（在运行时）

> ID：11058431
> 
> 赞同：3
> 
> 时间：2012-06-15T21:28:42.663
> 
> 标签：c++, performance, templates, runtime

我有一个用于串行存储器二维数组的类，它最初是一个`int`s 数组。现在我需要一个具有另一种类型的类似数组，我用模板重写了这个类；唯一的区别在于存储对象的类型：

```
template <class T>
class Serial2DArray
{
    ...
    T ** Content;
} 
```

我有一些处理内容的测试函数，例如，一个使数组中的所有元素无效的函数（它们不是类成员，它们是处理`Serial2DArray<int>`对象的外部函数。我注意到现在它可以工作了 1-慢了 2% - 类中的所有其他代码都保持不变，唯一的区别是早期它只是一个普通类，`int ** Content`现在它是一个模板。

一个类似的问题：[C++ 模板会使程序变慢吗？](https://stackoverflow.com/questions/2442358/do-c-templates-make-programs-slow)- 有意见认为只有编译会变慢（我可以明白为什么，编译器会为它在代码中找到的每个类生成类），但在这里我看到程序在运行时变慢 - 有什么合理的解释吗？

更新：问题在这里缩小了一点：[https ://stackoverflow.com/a/11058672/1200000](https://stackoverflow.com/a/11058672/1200000)

Upd2：如评论中所述，这是变慢的功能：

```
#include <windows.h>
#include <mmsystem.h>
...
int Size = G_Width * G_Height * sizeof(int);
DWORD StartTime = timeGetTime();
for(int i=0; i<100; ++i)
{
    FillMemory(TestArray.Content[0], Size, 0);
}
MeasuredTime = timeGetTime() - StartTime; 
```

这是实际的类模板：

```
#include <malloc.h>

template <class T>
class Serial2DArray
{
    public:
    Serial2DArray()
    {
        Content = NULL;
        Width = 0;
        Height = 0;
    }
    Serial2DArray(int _Width, int _Height)
    {
        Initialize(_Width, _Height);
    }
    ~Serial2DArray()
    {
        Deinitialize();
    }
    T ** Content;
    int GetWidth()
    {
        return Width;
    }
    int GetHeight()
    {
        return Height;
    }
    int Initialize(int _Width, int _Height)
    {
        // creating pointers to the beginning of each line
        if((Content = (T **)malloc(_Height * sizeof(T *))) != NULL)
        {
            // allocating a single memory chunk for the whole array
            if((Content[0] = (T *)malloc(_Width * _Height * sizeof(T))) != NULL)
            {
                // setting up line pointers' values
                T * LineAddress = Content[0];
                for(int i=0; i<_Height; ++i)
                {
                    Content[i] = LineAddress; // faster than Content[i] =
                    LineAddress += _Width;    // Content[0] + i * _Width;
                }
                // everything went ok, setting Width and Height values now
                Width = _Width;
                Height = _Height;
                // success
                return 1;
            }
            else
            {
                // insufficient memory available
                // need to delete line pointers
                free(Content);
                return 0;
            }
        }
        else
        {
            // insufficient memory available
            return 0;
        }
    }
    int Resize(int _Width, int _Height)
    {
        // deallocating previous array
        Deinitialize();
        // initializing a new one
        return Initialize(_Width, _Height);
    }
    int Deinitialize()
    {
        // deleting the actual memory chunk of the array
        free(Content[0]);
        // deleting pointers to each line
        free(Content);
        // success
        return 1;
    }
    private:
    int Width;
    int Height;
}; 
```

根据要求，二进制文件大小比较。

代码如下：

```
Serial2DArray<int> TestArray; 
Serial2DArray<int> ZeroArray; 
```

*   1 016 832 字节。

代码如下：

```
Serial2DArray TestArray; // NOT-template class with ints
Serial2DArray ZeroArray; // methods are in class declaration 
```

*   1 016 832 字节

代码如下：

```
Serial2DArray<int> TestArray;
Serial2DArray<int> ZeroArray;
Serial2DArray<double> AnotherArray;
Serial2DArray<double> YetAnotherArray; 
```

*   1 017 344 字节

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:31:27.017

是的 - 随机基准可变性，更不用说*整个程序*速度较慢的事实可能与这个特定的类完全无关。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-15T21:36:12.803

在容器类中使用模板可能会导致已知的**模板代码膨胀**问题。粗略地说，它可能会导致程序中出现更多页面错误，从而降低性能。

那你为什么要问？因为模板会为模板的每个类实例而不是一个生成类，从而导致二进制产品中有更多页面，如果您愿意，可以使用更多代码页面。这可能会**导致**更多的页面错误，具体取决于您的运行时执行。

使用一个类模板实例和两个必须是最重的实例查看二进制文件的大小。它将让您了解新实例引入的新代码大小。

这是关于该主题的维基百科文章：[代码膨胀文章](http://en.wikipedia.org/wiki/Code_bloat)。当**强制**编译器内联程序中的每个函数和方法时，问题可能是相同的，只要它可以与您的编译器一起使用。该标准试图通过使`inline`关键字成为编译器每次都不得遵循的“***请求”来防止这种情况。***例如，GCC 以中间语言生成您的代码，以评估生成的二进制文件是否不会导致代码膨胀，并可能因此丢弃内联请求。

# jquery - 使用 jquery find() 按类选择输入

> ID：11058432
> 
> 赞同：3
> 
> 时间：2012-06-15T21:28:52.427
> 
> 标签：jquery, forms, class, input, find

我有一个脚本，它验证表单的每个阶段，如果验证没有错误，则在每个部分添加一个勾号或交叉。

这是我的代码：

```
var error = 1;
var hasError = false;
$('.edit_artist').children(':nth-child(' + parseInt(step) + ')').find('input:not(button)').each(function() {
                var $this = $(this);
                var valueLength = jQuery.trim($this.val()).length;
                if(valueLength == '') {
                    hasError = true;    
                } 
```

我不希望在所有输入字段上都进行验证，所以我希望能够按类验证输入。有没有办法按班级查找输入，还是我需要走另一条路才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T21:31:29.913

要基于它的元素查找元素`class`，同时排除`button`元素：

```
$(selector).find('input.className:not("button")'); 
```

或者，更详细的方式：

```
$(selector).find('input:not("button")').filter(
     function(){
         return $(this).hasClass('className')
     }); 
```

参考：

*   [`filter()`](http://api.jquery.com/filter/).
*   [`find()`](http://api.jquery.com/find/).

# java - 在 groovy 中替换大字符串

> ID：11058437
> 
> 赞同：1
> 
> 时间：2012-06-15T21:29:08.340
> 
> 标签：java, string, groovy, replace

我正在尝试替换 groovy 中的大字符串。但不能让它工作。我正在使用 groovy 1.8.6

```
def textn = "http://10.33.0.69:8001/VS_SiteFacilityLookup/SiteFacilityLookupService?XSD=/com/enbridge/csim/ebo/module/common/serviceinterface/SiteFacilityLookupService.xsd"
textn = textn.replaceAll("http://10.33.0.69:8001/VS_SiteFacilityLookup/SiteFacilityLookupService?XSD=/com/enbridge/csim/ebo/module/common/serviceinterface/SiteFacilityLookupService.xsd", "hola")
println "textn : $textn" 
```

这打印出原始变量

如果我替换较短的字符串，它会正确替换它。

```
def textn = "http://10.33.0.69:8001/VS_SiteFacilityLookup/SiteFacilityLookupService?XSD=/com/enbridge/csim/ebo/module/common/serviceinterface/SiteFacilityLookupService.xsd"
textn = textn.replaceAll("SiteFacilityLookupService.xsd", "hola")
println "textn : $textn" 
```

这打印出预期的结果

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:34:54.640

试试这个模式：

`http:\/\/10.33.0.69:8001\/VS_SiteFacilityLookup\/SiteFacilityLookupService\?XSD=\/com\/enbridge\/csim\/ebo\/module\/common\/serviceinterface\/SiteFacilityLookupService.xsd`

您需要记住转义特殊字符-例如`?`->`\?`

所以，总而言之，它的结尾是：

```
def textn = "http://10.33.0.69:8001/VS_SiteFacilityLookup/SiteFacilityLookupService?XSD=/com/enbridge/csim/ebo/module/common/serviceinterface/SiteFacilityLookupService.xsd"
textn = textn.replaceAll("http:\/\/10.33.0.69:8001\/VS_SiteFacilityLookup\/SiteFacilityLookupService\?XSD=\/com\/enbridge\/csim\/ebo\/module\/common\/serviceinterface\/SiteFacilityLookupService.xsd", "hola")
println "textn : $textn" 
```

我在这里测试过：http: [//gskinner.com/RegExr/](http://gskinner.com/RegExr/)

关于主题：在 groovy、Java 和（我希望！）任何其他语言中替换字符串时，字符串长度并不重要。重要的是，在较大的模式中，更容易省略会导致不匹配的内容。因此，您应该使用简单且易于代码读者理解的模式。

例如：

`http:\/\/.*`- 匹配每个以开头的字符串`http://`

# javascript - 扩展引导模式

> ID：11058440
> 
> 赞同：1
> 
> 时间：2012-06-15T21:29:18.643
> 
> 标签：javascript, coffeescript, twitter-bootstrap

对于我的一个项目，我想扩展 twitter 引导模式窗口功能。

我希望我的模态窗口能够获得 Java CardLayout 的功能。对于那些不知道的人，CardLayout 允许一个容器（在我们的例子中是模态窗口）接受多个卡片子项（在我们的例子中是 div）。每个孩子都有一个索引，容器最初显示索引为“0”的孩子。CardLayout 接口包含“previous()、next()、first()、last()”函数，根据它们的索引更改显示的卡片。

这是我想用来生成带有 4 个“卡片”的“卡片模式”的 HTML 模板：

```
<a class="btn" data-toggle="modal" href="#myModal" >Launch Modal</a>

<div class="modal hide" id="myModal">
    <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>Modal header</h3>
    </div>
    <div class="modal-body">
        <div class="modal-card" card-index="0">
            This is the initial state
        </div>
        <div class="modal-card" card-index="1">
            This is the Step 1
        </div>
        <div class="modal-card" card-index="2">
            This is the Step 2
        </div>
        <div class="modal-card" card-index="3">
            This is the final State
        </div>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" card-change="previous">Previous</a>
        <a href="#" class="btn" card-change="next">Next</a>
        <a href="#" class="btn" data-dismiss="modal">Close</a>
        <a href="#" class="btn btn-primary">Save changes</a>
    </div>
</div> 
```

由于我对 JS 很陌生，因此我想作为一个练习，尝试使其尽可能通用和可重用。理想的情况是有一个 card-modal.js 文件，我可以将它放入我的项目 JS 文件夹中，以便能够随时创建其中一个。

我在两个方向之间犹豫不决： - 扩展 Modal 类（使用咖啡脚本“extends”关键字），因为毕竟是 CardModal“IS A”Modal。- 创建一个单独的类，只处理对那些上一个/下一个按钮的响应。

这两个选项的初始化有什么区别吗？（开发人员必须写什么来实际启动所需的对象）

我只是从更有经验的开发人员那里寻找“你会如何回答”。因此，实际展示“为什么这个解决方案比这个解决方案更好”而获得额外积分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:15:12.907

JavaScript 有一个基于函数原型的继承模型；这与您在 Python/Java/等中看到的“传统”基于类的继承模型不同。从绝对意义上讲，它也更难使用和学习（恕我直言）。这就是为什么框架和编译器（如 CoffeeScript）有自己的内置类继承系统。

这些特别的 JS 类继承系统的缺点是它们通常不能与其他 JS 继承系统交叉兼容。在这个特定的实例中，[我可以从源代码中看到](http://twitter.github.com/bootstrap/assets/js/bootstrap-modal.js)Modal 类不是 CoffeeScript 类。因此，我强烈建议*不要*尝试使用 CoffeeScript 来扩展它——那样会很疯狂。

我建议您使用选项 #2 — 构建功能以分别在 prev/next 之间切换。您应该将您的 CardLayout 开发为独立的 Javascript/jQuery，它期望获得一个`<div class="card-container">`包含`N` `<div class="card" >`元素的元素，这样无论该`card-container`元素位于 DOM 中的哪个位置，您都可以使用`setupCardLayout($('.card-container'))`.

然后，将它与 Bootstrap Modal 集成所需要做的就是监听显示模式的事件

```
$('#id-of-modal').on 'shown', ()->
    setupCardLayout($(this)) 
```

# c - 这个缓冲区溢出是否适用于 Mac OSX？

> ID：11058441
> 
> 赞同：1
> 
> 时间：2012-06-15T21:04:21.737
> 
> 标签：c, security

正在阅读一些文本并尝试在 C 中写入超过数组的大小，即缓冲区溢出。文本表明，每当您尝试写出`array[5]`数组长度为 5 时，就会出现分段错误，但使用下面的代码时我似乎没有得到。代码实际运行。

```
#include <stdio.h>
#include <string.h>

int main ()
{
    int i;
    int array[5] = {1, 2, 3, 4, 5};
    for (i = 0; i <= 255; i++)
    {
        array[i] = 10;
    }
    int len = sizeof(array) / sizeof(int);
    printf("%d\n", len);
    printf("%d\n", array[254]);
} 
```

在执行最后一条语句时，将`10`打印 a。我想知道这是否是一个漏洞，或者我是否缺少某些东西。我在 macbook pro 上运行 iterm2 的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T21:10:31.120

写到最后是未定义的行为——任何事情都可能发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T01:16:30.073

您正在将数据写入数组末尾。这是未定义的行为。未定义的行为意味着它可能在星期五工作，但在星期六崩溃。

这是 C 段落，它说它是未定义的行为：

> (C99, 6.5.3.2p4) 如果给指针分配了无效值，则一元 * 运算符的行为未定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T21:33:24.817

您将能够检查当前进程拥有的任何内存。当您到达该内存块的末尾时，您将收到 EXC_BAD_ACCESS 错误。试试这个循环的代码的修改版本，直到操作系统杀死它：

```
#include <stdio.h>
#include <string.h>

int main(int argc, const char * argv[])
{
    int i = 0;
    int array[5] = {1, 2, 3, 4, 5};
    while (1)
    {
        printf("%llu - %d\n", i, array[i]);
            // if (&i == &array[i]) printf("Overwriting i\n");
            // array[i] = 2;
        ++i;
    }
} 
```

如果您取消注释已注释掉的行，您应该会发现您陷入了 i 值 3 和 6 之间的无限循环。您正在覆盖位于`i`整数地址的内存。

# wpf - WPF Listview 虚拟化模式在绑定时会出现问题

> ID：11058444
> 
> 赞同：3
> 
> 时间：2012-06-15T21:29:25.750
> 
> 标签：wpf, listview, mode, recycle, virtualizingstackpanel

我创建了一个新类（从 listview 派生）。

此列表视图是视图的一部分，该视图具有视图模型。此视图模型有两个主要属性 - 1)myView(ICollectionView)...和 ​​isWritable(bool)。

每个列表视图项（列表视图内的行）都有一个控件模板，该模板显示一组控件。

其中少数控件的可见性由“isWritable”属性决定...通过 FindAncestor 方法。

**问题是**..当我们滚动这个列表视图时，一些使用“isWritable”属性来启用/禁用的控件被禁用，即使属性的值为“True”。

如果我删除回收，它工作正常......我认为这个问题是 - 因为它重用旧容器......绑定并没有完美地与 FindAncestor 发生。

如您所见，我在这里使用虚拟化......并且项目面板被回收。所以我认为当我们重用 itempanel 时，使用 FindAncestor 并没有像预期的那样发生数据绑定。

任何帮助，将不胜感激！

```
<controls:ListViewMine                                                   
    ItemsSource="{Binding Path=myView}"
    VirtualizingStackPanel.IsVirtualizing="true"
    ScrollViewer.IsDeferredScrollingEnabled="True"
    VirtualizingStackPanel.VirtualizationMode="Recycling"
    IsSynchronizedWithCurrentItem="True"
    SelectionMode="Single" 
    Template="{StaticResource myView2}"
    AllowDrop="{Binding Path=isWritable}">
    <controls:ListViewMine.View>
        <controls:GridViewMine ScrollViewer.VerticalScrollBarVisibility="Visible" ColumnHeaderContainerStyle="{StaticResource listViewHeaderStyle}">
            <GridViewColumn Width="110"  />
            <GridViewColumn Header="Name" CellTemplate="{StaticResource templateName}"/> 
        </controls:GridViewMine>
    </controls:ListViewMine.View>
</controls:ListViewMine> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-10T04:36:38.377

试试`VirtualizationMode="Standard"`。

解决了我遇到的问题：*带有组合框和 selectedindex 集的单元格模板。滚动时未呈现选定的索引。*

我不知道你的性能是否会得到同样的改善。

# php - Maven 3 + maven-php-plugin + PHPUnit 无法提取 phar

> ID：11058445
> 
> 赞同：1
> 
> 时间：2012-06-15T21:29:37.627
> 
> 标签：php, maven, phpunit, maven-3, phar

我正在尝试清理和构建一个 maven php 项目，我的 pom 文件中有以下代码片段：

```
<build>

    <plugins>

        <plugin>

            <groupId>org.phpmaven</groupId>

            <artifactId>maven-php-plugin</artifactId>

    <version>2.0.0</version>

            <extensions>true</extensions>

            <configuration>

                <ignoreIncludeErrors>true</ignoreIncludeErrors>

                <ignoreValidate>true</ignoreValidate>

            </configuration>

        </plugin>

    </plugins>

</build>

<dependencies>

    <dependency>

        <groupId>de.phpunit</groupId>

        <artifactId>PHPUnit</artifactId>

        <version>3.6.10</version>

    <type>phar</type>

        <scope>test</scope>

    </dependency>

</dependencies> 
```

但我不断收到以下错误：

*org.apache.maven.lifecycle.LifecycleExecutionException：无法在项目 MediaWikiTestClasses 上执行目标 org.phpmaven:maven-php-plugin:2.0.0:extractTestDependencies (default-extractTestDependencies)：执行 unphar 脚本时出错。无法在 org.apache.maven.lifecycle.internal.MojoExecutor.execute 提取 /home/demo/.m2/repository/de/phpunit/PHPUnit/3.6.7/PHPUnit-3.6.7.phar（MojoExecutor.java:217 ) 在 org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145) 在 org.apache.maven 的 org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)。 org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59) 在 org.apache.maven.lifecycle.internal 的生命周期.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)。launchEnhanced(Launcher.java:290) 在 org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230) 在 org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)在 org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352) 引起：org.apache.maven.plugin.MojoExecutionException：执行 unphar 脚本时出错。无法在 org.phpmaven.plugin.build.AbstractPhpExtractMojo.execute(AbstractPhpExtractMojo.java:76) 处提取 /home/demo/.m2/repository/de/phpunit/PHPUnit/3.6.7/PHPUnit-3.6.7.phar org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101) at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209) ... 19 更多原因：java.io .IOException：执行 unphar 脚本时出错。*

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T13:19:52.420

可能的解决方案： - 您的 php 可执行文件知道 phar 文件吗？也许你需要升级。- 您的 php 可执行文件在路径上可用吗？使用控制台（php 命令）进行测试。

如果这没有帮助，您应该查看调试输出（-X 标志）。是否有任何其他堆栈跟踪条目？

# javascript - 如何从 highcharts.js 动态更新 pointStart 系列属性？

> ID：11058449
> 
> 赞同：1
> 
> 时间：2012-06-15T21:29:54.460
> 
> 标签：javascript, charts, highcharts, series

我有一个非常简单的 highcharts js 图表，它在 x 轴上有日期，在 y 轴上有值。它适用于以下代码：

```
chart = new Highcharts.Chart({
    chart: {
        renderTo: 'chart_container',
        type: 'line',
    },
    xAxis: {
        type: 'datetime',
            dateTimeLabelFormats: { 
                day: '%e / %b'              
            }
    },
    yAxis: {
            title: {
                text: null
            },              
            tickInterval: 1,
            tickmarkPlacement: 'on',
            min: 1,
            max: 5
    },
    series: [{
            name: 'serie_1',
            pointInterval: 24 * 3600 * 1000, // one day
            pointStart: Date.UTC(2011, 11, 22),            
            data: [
                2, 3, 5, 4, null, 4, 4, 4, 4, 3, 2, 2, 1, 2, 2, null               
            ]
   }]
}); 
```

我还有一个事件会在触发某些操作时更改图表的数据：

```
function reloadChart(){
    $.get('/my/ajax/link/', { ajax_param: 10 },                                         
        function(data){
            // HOW TO GET THIS TO WORKS??? series.pointStart is readonly
            chart.series[0].pointStart = data.newPointStart;

            chart.series[0].setData(data.data, true);
        }
    );
} 
```

**我的问题是：如何在图表初始化后更新我的 series[0].pointStart？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-17T15:17:57.620

我会重新考虑这一点。从 y 值系列创建 x,y 点会比使用`pointStart`and`pointInterval`选项更容易。

```
startDate = Date.UTC(2010, 0, 1);
createData = function(beginDate){
    someData = [];
    for (var i = 0; i < 11; i++){
     someData.push([beginDate + (3600 * 1000 * 24 * i), Math.random() * 100]);
    }
    return someData;
}

....

series: [{
        data: createData(startDate)
    }] 
```

然后在你的函数中：

```
 nextDay = function(){
    startDate += 3600 * 1000 * 24;        
    chart.series[0].setData(createData(startDate), true);
 } 
```

[在这里](http://jsfiddle.net/larsenmtl/nWLjE/)工作小提琴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T23:57:33.407

我想这就是你要找的

```
 chart.xAxis[0].setCategories(); 
```

另请参阅工作[jsFiddle](http://jsfiddle.net/minagabriel/MUnrB/5/)

# android - 尝试即时更改 Android 语言环境

> ID：11058450
> 
> 赞同：0
> 
> 时间：2012-06-15T21:29:56.100
> 
> 标签：android, locale

我熟悉Java，但只是学习Android 编程。我非常喜欢他们的 Hello, LinearLayout 示例中的彩条，所以我一直在尝试将其扩展为一个小程序，我可以在我 13 个月大的孩子身上使用。我让它显示七种颜色的标签和四行。我想做的一件事（因为我会说双语），就是能够即时更改区域设置显示语言，而无需退出应用程序、加载新的区域设置并再次启动应用程序（这可行，但是这很乏味）。因此，七个颜色条被标记为适合所选语言，但我希望能够通过在程序中单击来更改这些颜色条，而不是退出程序。换句话说，我真的只想在应用程序范围内更改区域设置，而不是整个手机。

我在这里找到了一些关于区域设置更改的提示，但在这种情况下没有任何 100% 有效。我所做的是将 Spinner 代码与布局结合起来。我正在尝试将所有内容保存在一个文件中（暂时），以便我知道变量和范围都在工作（我曾尝试像在“官方”Android HelloSpinner 代码中那样来回传递东西，但这没有任何作用但一团糟）。到目前为止，这是我为自定义版本的 HelloLinearLayout 编写的代码：

任何和所有的建议表示赞赏！哦，我正在针对 Gingerbread 进行构建和测试，因为这就是我的 HTC 手机所运行的。

 ````
package net.buellnet.hellolinearlayout;

import java.util.Locale;

import android.app.Activity;<br/>
import android.content.res.Configuration;<br/>
import android.os.Bundle;<br/>
import android.view.View;
import android.widget.AdapterView;<br/>
import android.widget.ArrayAdapter;<br/>
import android.widget.Spinner;<br/>
import android.widget.Toast;<br/>

public class HelloLinearLayoutActivity extends Activity {<br/>
    /** Called when the activity is first created. */<br/>
    @Override<br/>
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Spinner spinner = (Spinner) findViewById(R.id.spinner);
        ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(
                this, R.array.lang_array, android.R.layout.simple_spinner_item);
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

        spinner.setAdapter(adapter);
        spinner.setHapticFeedbackEnabled(true);
        spinner.setOnItemSelectedListener(null);
    }

           public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {

                String language = parent.getItemAtPosition(pos).toString();
                Configuration newConfig = new Configuration();

                Toast.makeText(parent.getContext(), "The language is " +
                          parent.getItemAtPosition(pos).toString(), Toast.LENGTH_LONG).show();<br/>
/* I threw the above line in just to see if the control was working. I can change the "language" but the Toast line never pops up, nor does the locale ever change. */

                if (language.equals("English")) {
                    newConfig.locale = Locale.ENGLISH;
                    super.onConfigurationChanged(newConfig);

                    Locale.setDefault(newConfig.locale);
                    getBaseContext().getResources().updateConfiguration(newConfig, getResources().getDisplayMetrics());
                }
                else if (language.equals("French")) {
                    newConfig.locale = Locale.FRENCH;
                    super.onConfigurationChanged(newConfig);

                    Locale.setDefault(newConfig.locale);
                    getBaseContext().getResources().updateConfiguration(newConfig, getResources().getDisplayMetrics());
                }
                else if (language.equals("German")) {
                    newConfig.locale = Locale.GERMAN;
                    super.onConfigurationChanged(newConfig);

                    Locale.setDefault(newConfig.locale);
                    getBaseContext().getResources().updateConfiguration(newConfig, getResources().getDisplayMetrics());
                }
                else if (language.equals("Italian")){
                    newConfig.locale = Locale.ITALIAN;
                    super.onConfigurationChanged(newConfig);

                    Locale.setDefault(newConfig.locale);
                    getBaseContext().getResources().updateConfiguration(newConfig, getResources().getDisplayMetrics());
                }
                else if (language.equals("Portuguese")) {
                    newConfig.locale = new Locale("pt");
                    super.onConfigurationChanged(newConfig);

                    Locale.setDefault(newConfig.locale);
                    getBaseContext().getResources().updateConfiguration(newConfig, getResources().getDisplayMetrics());
                }
                else if (language.equals("Spanish")) {
                    newConfig.locale = new Locale("es");
                    super.onConfigurationChanged(newConfig);

                    Locale.setDefault(newConfig.locale);
                    getBaseContext().getResources().updateConfiguration(newConfig, getResources().getDisplayMetrics());
                }
            }

            public void onNothingSelected(AdapterView parent) {
                  // Do nothing.
            }
}
</code> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T20:53:59.607

试试这个方法！请参见下面的代码（请注意 setContentView 不再位于 onCreate 方法中）：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    doUIStuff();
    //otherThanUILogicGoesHere
}

@Override
public void onResume() {
    super.onResume();
    if (JustModifiedLocale){
        doUIStuff();
    }
}

void doUIStuff(){
    setContentView(R.layout.my_layout);
    //other UI_related necessary initializations go here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:34:05.797

```
 try updateConfiguration function to set new Locale........

  Resources res = context.getResources();
// Change locale settings in the app.
DisplayMetrics dm = res.getDisplayMetrics();
android.content.res.Configuration conf = res.getConfiguration();
conf.locale = new Locale(language_code.toLowerCase());
res.updateConfiguration(conf, dm); 
```

代替 `spinner.setOnItemSelectedListener(null);`

```
1 - public class HelloLinearLayoutActivity extends Activit implements Spinner.OnItemSelectedListener
2- spinner.setOnItemSelectedListener(this); 
````

# java - 如何保持一个并删除其他重复的 arrayList 对象并更新另一个对象属性？

> ID：11058451
> 
> 赞同：0
> 
> 时间：2012-06-15T21:30:01.397
> 
> 标签：java, collections, arraylist

对于以下情况，我需要您在 JAVA 中的帮助（如果可能，请提供一些示例代码）：
我有一个包含类对象的列表，并想检查一个对象属性是否有重复项，然后
保留其中一个并添加其他数量与保留一个人的数量。例如：
我有这个类：

```
class Salary {
    String names;
    Double amount;
} 
```

并且列表说`salary_list`其中包含以下元素（例如）：

```
[jony,john   300.96]
[fuse,norvi,newby  1000.55]
[john,jony  22.6]
[richard,ravi,navin  55.6]
[fuse,norvi,newby  200.6]
... ... ... 
```

所以我的预期输出是相同的输入列表，修改后的结果如下：

```
[jony,john  323.56]
[fuse,norvi,newby  1201.15]
[richard,ravi,navin  55.6] 
```

**注意**：名称中的顺序并不重要，因此重复消除后元素的顺序也不重要。
我不擅长英语和Java。因此，如果有任何错误，请原谅我。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:11:57.243

按以下方式增强您的`Salary`课程：

```
class Salary {
    String names;
    Double amount;
    private String sortedNames = null;

    @Override
    public boolean equals(Object o)
    {
        if (o == null || ! (o instanceof Salary)) return false;
        Salary othr = (Salary) o;
        String thisNames = this.getSortedNames();
        String othrNames = othr.getSortedNames();
        return thisNames.equals(othrNames);
    }

    @Override 
    public int hashCode()
    {
        return getSortedNames().hashCode();
    }

    public String getSortedNames()
    {
        if (this.sortedNames == null)
        {
            String[] nameArr = this.names.split(",");
            Arrays.sort(nameArr);
            StringBuilder buf = new StringBuilder();
            for (String n : nameArr)
                buf.append(",").append(n);
            this.sortedNames = buf.substring(buf.length()==0?0:1);
        }

        return this.sortedNames; 
    }
} 
```

这假设它`Salary`是不可变的（也就是说，在它创建后，它的值不会改变。然后您可以将它与哈希映射一起使用，以将所有具有相同名称的金额相加`names`。`amount`

```
 Map<String,Salary>  map  = new HashMap<String,Salary>();
    for (Salary s : list)
    {
        Salary e = map.get(s.getSortedNames());
        if (e == null)
            map.put(s.getSortedNames(), s);
        else
            e.amount += s.amount;
    } 
```

此时，`map`包含所有唯一`Salary`对象以及每个对象的总数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:04:59.360

Java 中几乎没有非常有用的工具。你可以

*   将字符串拆分为定义分隔符的数组，例如`"jony,john".split(",")`将为您提供数组 {"jony","john"}
*   对数组中的数据进行排序`Arrays.sort(arrayToSort)`
*   比较数组是否相等（包含具有相同顺序的相同值）`Arrays.equals(array1, array2)`或通过使用比较其字符串表示`Arrays.toString(array)`
*   使用 Maps（如 HashMap）来保存对 [key -> value]

有了这些，您就可以解决您的问题。

提示：您可以使用 Map like`<String, Double>`来统计您的数据。作为键（字符串），您可以使用名称的排序表示。如果 Map 已经包含名称的某种排序表示，则增加存储在该键下的值。

# c++ - 使用 QTestLib 时禁止 qDebug

> ID：11058456
> 
> 赞同：5
> 
> 时间：2012-06-15T21:30:33.557
> 
> 标签：c++, qt, unit-testing

我正在向 Qt 中的项目添加单元测试，并希望使用 QTestLib。我已经设置了测试并且它们运行良好。

问题是在项目中我们已经覆盖了 qDebug() 以输出到我们自己的日志文件。这在运行应用程序时效果很好，问题是当我测试类时，它有时会开始记录，然后将其发送到输出窗口。结果是一场彻底的灾难，几乎无法阅读，因为我们的日志与 QTest 输出混合在一起。

我想知道是否有办法抑制 qDebug() 输出，或者至少将其移动到其他地方。我已经尝试添加`#define QT_NO_DEBUG_OUTPUT`并使用`qInstallMsgHandler(messageOutput);`来重定向或阻止输出，但都没有任何效果。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-20T21:19:56.707

@Kuba 给出的解决方案在某些情况下有效，但在与`QTest::qExec(&test,argc,argv)`main 方法结合使用以运行多个测试时无效。在这种情况下，禁用 qDebug() 输出（我发现）的唯一方法是为其`void initTestCase()`插槽中的每个测试类注册一个新的消息处理程序。

例如

```
void noMessageOutput(QtMsgType, const char *)
{}

int main(int argc,char* argv[])
{
  qInstallMsgHandler(noMessageOutput);
  tst_Class1 t1;
  tst_Class2 t2;
  QTest::qExec(&t1,argc,argv);
  QTest::qExec(&t2,argc,argv);     
} 
```

将显示调试输出 tst_Class1、Class1、tst_Class2 和 Class2。为了防止这种情况，您必须明确禁用每个测试类中的输出

```
class tst_Class1
{
   //class stuff
   private slots:
      void initTestCase();
      //test cases
};

void tst_Class1::initTestCase()
{
      qInstallMsgHandler(noMessageOutput);
}

class tst_Class2
{
   //class stuff
   private slots:
      void initTestCase();
      //test cases
};

void tst_Class2::initTestCase()
{
      qInstallMsgHandler(noMessageOutput);
} 
```

如果您希望查看来自类子集的调试输出，请删除该`qInstallMsgHandler()`行，它将通过。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-16T04:41:10.520

1.  定义必须进入您的`QT_NO_DEBUG_OUTPUT`项目文件或生成文件，并且必须存在于您编译的每个文件中。然后您必须重新编译您的应用程序（当然不是 Qt 本身）。该宏在编译器命令行上的存在保证了第一次`QDebug`标头包含在任何代码中，`qDebug`将被重新定义为无操作。这就是这个宏的作用：如果包含头文件时`qDebug` *它存在*`<QtCore/qdebug.h>`，它会禁用- 无论是您直接执行*还是其他头文件间接*执行。

2.  使用`qInstallMsgHandler`当然可以抑制调试输出。

下面是一个独立的例子。

```
#if 0
// Enabling this section disables all debug output from non-Qt code.
#define QT_NO_DEBUG_OUTPUT
#endif
#include <QtCore/QDebug>

void noMessageOutput(QtMsgType, const char *)
{}

int main(int argc, char *argv[])
{
    qDebug() << "I'm shown";
    qInstallMsgHandler(noMessageOutput);
    qDebug() << "I'm hidden";
} 
```

# apache-camel - 如何在 Camel Multicast 中设置端点特定的标头值

> ID：11058460
> 
> 赞同：1
> 
> 时间：2012-06-15T21:30:44.023
> 
> 标签：apache-camel

我想在多播组件中设置端点特定的标头值。

XML DSL 如下：

```
<route>

<from uri="direct:testRoute"/>
<multicast strategyRef="MyAggregator" parallelProcessing="true">
<to uri="direct:call1"/> <!-- set the header MY_HEADER = "call_1" -->
<to uri="direct:call2/> <!-- set the header MY_HEADER = "call_2" -->
</multicast>

</route> 
```

基本上在我想知道的响应聚合中，这个响应属于哪个服务请求。

我尝试这样做，但它不是正确的方法（解析异常）：

```
<to uri="direct:call1"> 
      <setHeader headerName="MY_HEADER"><simple>call1</simple></setHeader>
 </to> 
```

我从阅读文档中看到的是，多播将复制源 Exchange 并多播每个副本。因此，它是 Exchange 的浅表副本，也是所有多播接收者之间共享的一种引用。

但是在这里，我正在寻找单个收件人的特定标头值。

这该怎么做？任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:00:57.620

您不能在多播路由中执行此操作。但是之后的直接路线应该很简单。

```
<route>
  <from uri="direct:call1"/>
     <setHeader headerName="MY_HEADER"><simple>call1</simple></setHeader>
     .. do whatever
  </from>
</route> 
```

否则，如果 call1 用于其他事情并且您不知道何时将标头放入该路由中，请制作一个简单的准备路由：

```
<route>
   <from uri="direct:prepCall1"/>
     <setHeader headerName="MY_HEADER"><simple>call1</simple></setHeader>
     <to uri="direct:call1"/>
  </from>
</route> 
```

作为第三个选项，即使您不能将 DSL（xml 或 java）放在多播列表中，您也可以提供一个“onPrepareRef”处理器 bean，将标头添加到您的交换中。但是一个处理器将处理所有多播端点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T13:41:27.903

有一个带有键 Exchange.TO_ENDPOINT 的标头，您可以看到响应来自 2 个端点中的哪一个。

# python - 程序无法从 arg 读取路径名。“没有相应的文件和目录”

> ID：11058464
> 
> 赞同：1
> 
> 时间：2012-06-15T21:30:58.030
> 
> 标签：python

我有一个 python 脚本的新问题。当我尝试运行它将路径作为参数传递给程序时，它返回错误消息：“ `No such file or directory`”。该程序应该遍历由路径名指定的目录以查找文本文件并打印出前两行。

是的，确实是家庭作业，但我已经看了很多关于 os 和 sys 的内容，但仍然不明白。各位老手能帮帮新手吗？谢谢

```
 #!/usr/bin/python2.7
    #print2lines.py
    """
    program to find txt-files in directory and
    print out the first two lines
    """
    import sys, os

    if (len(sys.argv)>1):
        path = sys.argv[0]
        if os.path.exist(path):
            abspath = os.path.abspath(path):
                dirlist = os.listdir(abspath)
                for filename in dirlist:
                    if (filename.endswith(".txt")):
                        textfile = open(filename, 'r')
                        print filename + ": \n"
                        print textfile.readline(), "\n"
                        print textfile.readline() + "\n"

                    else:   
                        print "passed argument is not valid pathname"
    else:   
        print "You must pass path to directory as argument" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T21:42:29.993

与您的路径相关的问题是：

```
path = sys.argv[0] 
```

`argv[0]`指的是命令运行（通常是您的 Python 脚本的名称）。如果您想要第一个命令行参数，请使用索引**1**，而不是**0**。IE，

```
path = sys.argv[1] 
```

示例脚本`tmp.py`：

```
import sys, os
print sys.argv[0]
print sys.argv[1] 
```

并且：`python tmp.py d:\users`给出：

```
 tmp.py
 d:\users 
```

还有两个语法错误：

```
 if os.path.exist(path):  # the function is exists()  -- note the s at the end
        abspath = os.path.abspath(path):  # there should be no : here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:39:52.320

`os.listdir`返回目录中文件名的列表，但不返回它们的路径。例如，您有一个目录“test”和其中的文件 a、b 和 c：

```
os.listdir("test") #-> returns ["a", "b", "c"] 
```

如果要打开文件，则需要使用完整路径：

```
from os import path, listdir
def getpaths(dirname):
    return [path.join(dirname, fname) for fname in listdir(dirname)]
getpaths("test") #-> returns ["test/a", "test/b", "test/c"] 
```

五行完整解决您的问题：

```
import sys, os
dir = sys.argv[1]
files = [open(os.path.join(dir, f)) for f in os.listdir(dir)]
first2lines = ['\n'.join(f.read().split("\n")[:2]) for f in files]
print '\n'.join(first2lines) 
```

# php - 在这个 sql 查询中除以零？

> ID：11058465
> 
> 赞同：2
> 
> 时间：2012-06-15T21:31:12.107
> 
> 标签：php, mysql

我正在执行这个 sql 查询来更新数据库

```
$sql_select = "UPDATE `database1`.`media` SET `media` =(http://torcache.net/torrent/'" . $upload_result . "'.torrent) WHERE 'image_type'= '4' AND 'media' LIKE '"%$fname%"' "; 
```

我收到警告：除以零？？

我认为这与这种情况有关`LIKE '"%$fname%"' "`

它使用 sql LIKE %% 来匹配任何字符串，因为我以前从未在我的代码中使用过这个条件

错误来自哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T21:33:20.507

百分号在引号之外，使其成为模数，或除法的余数。

```
$sql_select = "UPDATE `database1`.`media` SET `media` =(http://torcache.net/torrent/'" . $upload_result . "'.torrent) WHERE 'image_type'= '4' AND 'media' LIKE '%".$fname."%' "; 
```

# android - 禁用键盘单个字母弹出

> ID：11058466
> 
> 赞同：2
> 
> 时间：2012-06-15T21:31:15.283
> 
> 标签：android, keyboard

有人知道如何以编程方式禁用键盘单个字母弹出窗口吗？

（当您在设备的虚拟键盘上单击一个字母时，此蓝色弹出窗口。）

![图片](../Images/0e4f9c5fb0f1320d5ef44bd1015e46fe.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:35:01.550

您不能从应用程序中执行此操作。

如果设备上的键盘是为此而构建的，那么您唯一的选择是构建/安装/使用不这样做的不同键盘。

应用程序无法操作系统键盘（除了 ime 选项、inputType 等小东西）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-07T08:04:23.643

在您的手机中，转到设置 --> 语言和输入法 --> 选择您正在使用的键盘类型。（在我的情况下，它说三星键盘）。选择它旁边的设置图标。有一个名为“字符预览”的选项。禁用它。

# java - 用Java编写unicode字符？

> ID：11058470
> 
> 赞同：4
> 
> 时间：2012-06-15T21:31:35.360
> 
> 标签：java, unicode, character-encoding

我正在开发一个随机名称生成器，用于我正在开发的游戏中，问题是不同的物种具有不同的命名风格，我想要一个名称生成器来处理所有这些。我已经对这个问题的第一部分进行了排序 - 名称生成器使用一系列模板，每个种类的玩家/NPC 一组。

我遇到的主要问题是一些元音需要有一个随机选择的重音标记。我已经搜索和搜索，但我找不到随机选择一个字符然后对其应用重音符号的方法。那么，通过选择字母然后对其应用重音标记来组成重音字母的方法有哪些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T01:57:48.773

Unicode 具有代表大多数类型的重音的“组合”字符。从您创建的组合字符数组中随机选择一个组合字符非常容易。然后，您可以将任何口音放在您喜欢的任何字符上。

[http://en.wikipedia.org/wiki/Combining_character](http://en.wikipedia.org/wiki/Combining_character)

由于这些由代码点表示，因此您可以将它们单独视为一个字符：

```
String s = "a" + "\u0300"; // latin lowercase letter a + combining grave accent
char combining_grave_accent = '\u0300'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T21:45:09.910

嗯，也许使用二维数组并创建一个转换表，该表将有 2 列和多少行（有多少重音字符），现在在第一列存储每个重音值，在第二列存储值 un-重音即a，e，i，o，u，当您为名称生成元音时，您可以随机选择是否重音，如果您选择重音，您将遍历二维数组获取所有重音值使用'a'或其他任何东西，并通过获取和检查数组第二列中的值（以便选择所有重音a），然后随机选择一个来使用......

那是很长的路要走，我知道java中没有为此的捷径。

编辑：这是一些符合我建议的代码：

```
import java.util.ArrayList;

/**
 *
 * @author David
 */
public class JavaApplication145 {

    static char[][] chars = new char[6][6];

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {

        createConversionTable();

        char c = 'u';

        ArrayList<String> charsList = getAccentedChar(c);

        for (int i = 0; i < charsList.size(); i++) {
            System.out.println(charsList.get(i));
        }

    }

    private static void createConversionTable() {
        chars[0] = new char[]{'ù', 'ü', 'é', 'ê', 'ä', 'à'};
        chars[1] = new char[]{'u', 'u', 'e', 'e', 'a', 'a'};
    }

    private static ArrayList getAccentedChar(char c) {

        ArrayList<String> charsList = new ArrayList<>();

        for (int i = 0; i < chars[0].length; i++) {

            for (int x = 0; x < chars[1].length; x++) {

                if (chars[i][x] == c) {
                    charsList.add(chars[i - 1][x] + "");
                }

            }
        }
        return charsList;
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-19T06:58:46.887

需要同样的东西，所以我最终做了这个：

```
 /**
 * Given a letter and an accent, return the char with the accent included.
 * 
 * @param accentCode: The accent char; i.e '~', '´';
 * @param letter: Letter to put accent in it.
 * @return: Char with {@code letter} with accent if it was a valid letter.
 */
public static int getAccent(char accentChar, int letter) {
    int index = 0;
    boolean upperCase = false;
    for (char vogal : vogalList) {
        if (letter == vogal) {
            if (index >= 5) {
                index -= 5;
                upperCase = true;
            }
            for (int accentType = 0; accentType < convertTable.length; accentType++) {
                if (convertTable[accentType][0] == accentChar) {
                    char converted = convertTable[accentType][index + 1];
                    if (converted != '-') {
                        if (upperCase)
                            converted = Character.toUpperCase(converted);

                        return converted;
                    }
                }
            }
        }
        index++;
    }
    return letter;
}

/**
 * Verify if {@code charID} is an accent character;
 * 
 * @param charID: Character code id to be verified.
 * @return: true in case {@code charID} is an accent character id.
 */
public static boolean isAccent(int charID) {
    for (int i = 0; i < convertTable.length; i++) {
        if (convertTable[i][0] == charID)
            return true;
    }
    return false;
}

private static final char[] vogalList = { 'a', 'e', 'i', 'o', 'u', 'A', 'E', 'I', 'O', 'U' };
private static final char[][] convertTable = { { '´', 'á', 'é', 'í', 'ó', 'ú' }, { '`', 'à', 'è', 'ì', 'ò', 'ù' }, { '^', 'â', 'ê', 'î', 'ô', 'û' }, { '~', 'ã', '-', '-', 'õ', '-' }, { '¨', 'ä', 'ë', 'ï', 'ö', 'ü' } }; 
```

# jquery - 在 IE 9 中显示错误

> ID：11058471
> 
> 赞同：-1
> 
> 时间：2012-06-15T21:31:50.370
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, twitter-bootstrap

我有一个即将推出的页面，位于 www.remindeals.com。

当单击“首先进入”按钮并提交电子邮件（做一个像 abc@abc.com 之类的假邮件）时，模态弹出窗口存在一个错误，其中背景不显示，社交图标仅在悬停时出现超过。这是一个使用引导程序构建的 Rails 站点。

这个问题只发生在 IE 9 中。任何人有任何线索吗？

下面附上相关的jquery，不确定这是否有帮助。

```
$('document').ready(function() {

  // display validation errors for the "request invitation" form
  if ($('.alert-error').length > 0) {
    $("#request-invite").modal('toggle');
  }

  // use AJAX to submit the "request invitation" form
  $('#invitation_button').live('click', function() {
    var email = $('form #user_email').val();
    var password = $('form #user_password').val();
    var dataString = 'user[email]='+ email + '&user[password]=' + password;
    $.ajax({
      type: "POST",
      url: "/users",
      data: dataString,
      success: function(data) {
        $('#request-invite').html(data);
        loadSocial();
      }
    });
    return false;
  });

})

// load social sharing scripts if the page includes a Twitter "share" button
function loadSocial() {

    //Twitter
    if (typeof (twttr) != 'undefined') {
      twttr.widgets.load();
    } else {
      $.getScript('http://platform.twitter.com/widgets.js');
    }

    //Facebook
    if (typeof (FB) != 'undefined') {
      FB.init({ status: true, cookie: true, xfbml: true });
    } else {
      $.getScript("http://connect.facebook.net/en_US/all.js#xfbml=1", function () {
        FB.init({ status: true, cookie: true, xfbml: true });
      });
    }

    //Google+
    if (typeof (gapi) != 'undefined') {
      $(".g-plusone").each(function () {
        gapi.plusone.render($(this).get(0));
      });
    } else {
      $.getScript('https://apis.google.com/js/plusone.js');
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:40:56.467

```
$('document').ready(function() { <-- Document isn't supposed to be in quotes 
```

正确的方法是这样的

```
$(document).ready(function() { //code here }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:47:57.730

在 IE 中的输入字段中按下时，您的页面将提交给`thankyou.html`而不是打开带有社交统计信息的模式。`Enter`这是因为在输入字段中按下提交时不会触发`#invitation_button`'事件。`click``Enter`

将您的文本`input`和`submit`按钮包装在 a 中`<form/>`，然后替换：

```
$('#invitation_button').live('click', function() { 
```

和：

```
$('form').live('submit', function() { 
```

或者，当您使用 jQuery 1.7.2 时：

```
$('form').on('submit', function() { 
```

您也可以考虑使用 CDN 托管的 jQuery 副本，而不是将其托管在您的网站上，因为它为您的用户提供了更好的缓存和加载时间。

您页面的其余部分似乎与我的 IE 中的 FF/Chrome 相同。

# mysql - mysql：为单个列计数特定值出现的行数

> ID：11058472
> 
> 赞同：0
> 
> 时间：2012-06-15T21:31:52.833
> 
> 标签：mysql, select

我正在使用 MySQL 查询编写报告。它有多个我报告的列。其中，有一列包含许多不同的值（行前只有一个值）。我需要计算该列中的两个特定值。然后按类型对最终结果进行分组：

桌子

```
ID Name  has passed  Type  
 1  abc      yes (1)   z  
 2  xyz      yes (1)   x  
 3  cde      no  (0)   y  
 4  abc      yes (1)   z  
 5  cde      no  (0)   z  
 6  xyz      no  (0)   y 
```

我的预期结果是：

```
For Type x  
 total records = 1  
 yes count = 1     
 total abc = 0  
 total cde = 0  

For Type y  
 total records = 2  
 yes count = 0     
 total abc = 0  
 total cde = 1  

For Type z  
 total records = 3  
 yes count = 2   
 total abc = 2  
 total cde = 1 
```

请注意，我们不计算名称 xyz 或任何其他名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:42:19.933

```
SELECT
    type,
    COUNT(*) AS total_records,
    COUNT(IF(has_passed, 1, NULL)) AS yes_count,
    COUNT(IF(name = 'abc', 1, NULL)) AS total_abc,
    COUNT(IF(name = 'cde', 1, NULL)) AS total_cde
FROM
    table
GROUP BY
    type 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:44:06.020

在我的脑海中（现在无法访问数据库进行测试，抱歉）......也许这样的事情会起作用（假设你存储 0 和 1 来表示“通过”）？

```
SELECT
   type,
   SUM(passed) as "Yes count",
   SUM(case when name = 'abc' then 1 else 0 end) as "Total abc",
   SUM(case when name = 'cde' then 1 else 0 end) as "Total cde",
   COUNT(1) as "Total records"
FROM
   myTable
GROUP BY
   type
; 
```

# box-api - 获取给定路径的文件 ID

> ID：11058475
> 
> 赞同：12
> 
> 时间：2012-06-15T21:32:03.947
> 
> 标签：box-api

有没有通过给出路径（例如/some/folder/deep/inside/file.txt）来获取文件ID的直接方法？我知道这可以通过递归检查文件夹的内容来完成，但是一个简单的调用会好得多。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T23:41:30.480

我们目前不对此提供支持，但在我们继续构建 v2 API 时肯定会考虑反馈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-30T11:16:54.173

另一种方法是从路径中提取目标文件/文件夹名称并使用搜索 API 进行搜索

像这样：[https ://api.box.com/2.0/search?query=filename.txt](https://api.box.com/2.0/search?query=filename.txt)

这将返回所有匹配的条目及其 path_collections，为每个条目提供整个层次结构。像这样的东西：

```
 "path_collection": {
                "total_count": 2,
                "entries": [
                    {
                        "type": "folder",
                        "id": "0",
                        "sequence_id": null,
                        "etag": null,
                        "name": "All Files"
                    },
                    {
                        "type": "folder",
                        "id": "2988397987",
                        "sequence_id": "0",
                        "etag": "0",
                        "name": "dummy"
                    }
                ]
           } 
```

此条目的路径可以反向工程为`/dummy/filename.txt`

只需将此路径与您正在寻找的路径进行比较。如果匹配，那么这就是您要查找的搜索结果。这只是为了减少获得结果所需的 ReST 调用次数。希望这是有道理的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-16T22:44:01.370

这是我关于如何根据路径获取文件夹 id 的方法，而不是递归地遍历整个树，这也可以很容易地适应文件。这是基于 PHP 和 CURL 的，但也很容易在任何其他应用程序中使用它：

```
//WE SET THE SEARCH FOLDER:
$search_folder="XXXX/YYYYY/ZZZZZ/MMMMM/AAAAA/BBBBB";

//WE NEED THE LAST BIT SO WE CAN DO A SEARCH FOR IT
$folder_structure=array_reverse (explode("/",$search_folder));

// We run a CURL (I'm assuming all the authentication and all other CURL parameters are already set!) to search for the last bit, if you want to search for a file rather than a folder, amend the search query accordingly
curl_setopt($curl, CURLOPT_URL, "https://api.box.com/2.0/search?query=".urlencode($folder_structure[0])."&type=folder");    

// Let's make a cine array out of that response
$json=json_decode(curl_exec($curl),true);
$i=0;
$notthis=true;

// We need to loop trough the result, till either we find a matching element, either we are at the end of the array
while ($notthis && $i<count($json['entries'])) {
  $result_info=$json['entries'][$i];

     //The path of each search result is kept in a multidimensional array, so we just rebuild that array, ignoring the first element (that is Always the ROOT)
     if ($search_folder == implode("/",array_slice(array_column($result_info['path_collection']['entries'],'name'),1))."/".$folder_structure[0])
        {
         $notthis=false;
         $folder_id=$result_info['id'];
        }
      else
        {
         $i++;  
        }
   }
if ($notthis) {echo "Path not found....";} else {echo "Folder id: $folder_id";} 
```

# java - Gson 中的自循环引用

> ID：11058476
> 
> 赞同：7
> 
> 时间：2012-06-15T21:32:08.933
> 
> 标签：java, json, gson, circular-reference

我在反序列化遵循这种格式的 Json 数组时遇到了一些问题：

```
[
{
  "ChildList":[
     {
        "ChildList":[

        ],
        "Id":110,
        "Name":"Books",
        "ApplicationCount":0
     }
  ],
  "Id":110,
  "Name":"Books",
  "ApplicationCount":0
}
] 
```

它基本上是一个类别数组，其中每个类别还可以有一个子类别列表，依此类推。我的班级模型看起来有点像这样：

```
public class ArrayOfCategory{
    protected List<Category> category;
}

public class Category{

    protected ArrayOfCategory childList;
    protected int id;
    protected String name;
    protected int applicationCount;
} 
```

现在，Gson 显然抱怨循环引用。鉴于我无法假设有多少级别的类别，有什么方法可以解析这个 Json 输入？提前致谢。

**编辑：** 以防万一有人有类似的问题，基于 Spaeth 的回答，我使用反射将解决方案改编为更一般的情况。唯一的要求是 JSON 数组表示的对象列表被包装在另一个类中（如我的示例中的 Category 和 ArrayOfCategory）。将以下代码应用于我的原始示例，您只需调用“deserializeJson(jsonString,ArrayOfCategory.class)”，它就会按预期工作。

```
private <T> T deserializeJson(String stream, Class<T> clazz) throws PluginException {
    try {
        JsonElement je = new JsonParser().parse(stream);
        if (je instanceof JsonArray) {
            return deserializeJsonArray(clazz, je);
        } else {
            return new GsonBuilder().setFieldNamingPolicy(FieldNamingPolicy.UPPER_CAMEL_CASE).create().fromJson(stream, clazz);         
        }
    } catch (Exception e) {
        throw new PluginException("Failed to parse json string: " + ((stream.length() > 20) ? stream.substring(0, 20) : stream) + "... to class " + clazz.getName());
    }       
}

private <T> T deserializeJsonArray(Class<T> clazz, JsonElement je) throws InstantiationException, IllegalAccessException {
    ParameterizedType listField = (ParameterizedType) clazz.getDeclaredFields()[0].getGenericType();
    final Type listType = listField.getActualTypeArguments()[0];
    T ret = clazz.newInstance();
    final Field retField = ret.getClass().getDeclaredFields()[0];
    retField.setAccessible(true);
    retField.set(ret, getListFromJsonArray((JsonArray) je,(Class<?>) listType));
    return ret;
}

private <E> List<E> getListFromJsonArray(JsonArray je, Class<E> listType) {
    Type collectionType = new TypeToken<List<E>>(){}.getType();
    final GsonBuilder builder = new GsonBuilder().setFieldNamingPolicy(FieldNamingPolicy.UPPER_CAMEL_CASE);
    Gson jsonParser = builder.create();
    return jsonParser.fromJson(je, collectionType);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:54:05.403

也许你可以试试这个：

```
 com.google.gson.Gson gson = new GsonBuilder().create();
    InputStreamReader reader = new InputStreamReader(new FileInputStream(new File("/tmp/gson.txt")));
    Collection<Category> fromJson = gson.fromJson(reader, new TypeToken<Collection<Category>>() {}.getType());
    System.out.println(fromJson); 
```

你会得到一个好的结果。

“魔法”发生在这里：`new TypeToken<Collection<Category>>() {}.getType()`

整个代码是：

```
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.InputStreamReader;
import java.util.Collection;
import java.util.List;

import com.google.gson.GsonBuilder;
import com.google.gson.JsonIOException;
import com.google.gson.JsonSyntaxException;
import com.google.gson.reflect.TypeToken;

public class GsonCircularReference {

    public class Category {
        protected List<Category> childList;
        protected int id;
        protected String name;
        protected int applicationCount;

        public List<Category> getChildList() {
            return childList;
        }

        public void setChildList(final List<Category> childList) {
            this.childList = childList;
        }

        public int getId() {
            return id;
        }

        public void setId(final int id) {
            this.id = id;
        }

        public String getName() {
            return name;
        }

        public void setName(final String name) {
            this.name = name;
        }

        public int getApplicationCount() {
            return applicationCount;
        }

        public void setApplicationCount(final int applicationCount) {
            this.applicationCount = applicationCount;
        }

        @Override
        public String toString() {
            return "Category [category=" + childList + ", id=" + id + ", name=" + name + ", applicationCount="
                    + applicationCount + "]";
        }

    }

    public static void main(final String[] args) throws JsonSyntaxException, JsonIOException, FileNotFoundException {
        com.google.gson.Gson gson = new GsonBuilder().create();
        InputStreamReader reader = new InputStreamReader(new FileInputStream(new File("/tmp/gson.txt")));
        Collection<Category> fromJson = gson.fromJson(reader, new TypeToken<Collection<Category>>() {}.getType());
        System.out.println(fromJson);
    }

} 
```

JSON文件是：

```
[
{
  "childList":[
     {
        "childList":[
        ],
        "id":110,
        "Name":"Books",
        "applicationCount":0
     }
  ],
  "id":110,
  "name":"Books",
  "applicationCount":0
}
] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T00:23:09.770

看看[GraphAdapterBuilder](https://code.google.com/p/google-gson/source/browse/trunk/extras/src/main/java/com/google/gson/graph/GraphAdapterBuilder.java)。您需要将它包含在您的应用程序中，但它可以序列化任意对象图。

# opengl - 如何使 opengl 对象出现在鼠标单击时？

> ID：11058477
> 
> 赞同：0
> 
> 时间：2012-06-15T21:32:10.340
> 
> 标签：opengl, graphics, mouse-picking

我需要做的是在我的 OpenGL 视口上单击某处并在该位置渲染一个对象。我已经知道基本的东西，即创建窗口、检测鼠标点击、获取点击坐标和绘制对象。我缺少的链接是正确的坐标。我需要确定我在屏幕上单击的 (X,Y) 点意味着什么是 openGL 世界坐标。我知道一个名为 gluUnProject 的 GLUT 函数，但由于技术原因，我不能使用 GLUT。我检查了许多算法来手动制作我自己的 unproject 函数：

[http://schabby.de/picking-opengl-ray-tracing/](http://schabby.de/picking-opengl-ray-tracing/) [http://collagefactory.blogspot.mx/2010/03/gluunproject-source-code.html](http://collagefactory.blogspot.mx/2010/03/gluunproject-source-code.html) [OpenGL 数学 - 将屏幕空间投影到世界空间坐标](https://stackoverflow.com/questions/7692988/opengl-math-projecting-screen-space-to-world-space-coords-solved)

和其他人，但没有工作，当我点击屏幕时，对象被绘制在奇怪的地方。我什至不确定我在这里寻找什么，我不知道我要实现的是 Picking，还是 Raycasting 或 Raypicking 或其他东西。有谁知道我正在寻找的算法？

编辑：我正在添加一个屏幕截图，我标记了我单击的位置，如您所见，球体正在另一个位置绘制。 [http://img23.imageshack.us/img23/4738/proofxd.jpg](http://img23.imageshack.us/img23/4738/proofxd.jpg) 我还添加了我的opengl源代码：

```
 /**OPENGL**/
    private void GLC_display_Load(object sender, EventArgs e)
    {
        //CONTEXT
        GL.ClearColor(Color.LightGray);
        GL.Enable(EnableCap.Texture2D);
        GL.Enable(EnableCap.Blend);
        GL.Enable(EnableCap.DepthTest);
        GL.Enable(EnableCap.CullFace);
        GL.CullFace(CullFaceMode.Back);
        GL.Enable(EnableCap.Blend);
        GL.DepthFunc(DepthFunction.Always);     
        GL.BlendFunc(BlendingFactorSrc.SrcAlpha, BlendingFactorDest.OneMinusSrcAlpha);
        GL.Hint(HintTarget.PerspectiveCorrectionHint, HintMode.Nicest); 
        SetupViewport();
    }

    private void SetupViewport()
    {
        GL.Clear(ClearBufferMask.ColorBufferBit);
        GL.ShadeModel(ShadingModel.Smooth);
        float aspectRatio = (float)GLC_display.Width / (float)GLC_display.Height;
        GL.Viewport(0, 0, GLC_display.Width, GLC_display.Height);
        GL.MatrixMode(MatrixMode.Projection);
        GL.LoadIdentity();
        OpenTK.Matrix4 perspective = OpenTK.Matrix4.CreatePerspectiveFieldOfView((float)(System.Math.PI / 4f), aspectRatio, 0.1f, 2000f);
        GL.MultMatrix(ref perspective);
        GL.MatrixMode(MatrixMode.Modelview);
        GL.LoadIdentity();
    }

    private void GLC_display_Resize(object sender, EventArgs e)
    {
        SetupViewport();
        GLC_display.Invalidate();
    }

    private void GLC_display_Paint(object sender, EventArgs e)
    {

        GL.Clear(ClearBufferMask.ColorBufferBit | ClearBufferMask.DepthBufferBit);
        Matrix4 lookat = Matrix4.LookAt(posVector, eyeVector, Vector3.UnitY);
        GL.MatrixMode(MatrixMode.Modelview);
        GL.LoadMatrix(ref lookat);
        GL.Color3(Color.Red);
        //GL.PushMatrix();
        //GL.Translate(new Vector3(10f,3f,5f));
        //Geometry.drawSphere(5, 20);
        //GL.PopMatrix();

        foreach (Vector3 coord in clicks)
        {
            Console.WriteLine("List: "+coord.ToString());
            //GL.Color3(0f, 1f, 0f);
            GL.PushMatrix();
            GL.Translate(coord);
            Geometry.drawSphere(5, 20);
            GL.PopMatrix();
        }
        GLC_display.SwapBuffers();
    }

    public Vector3 unProjectInput(Vector2 mouse)
    {
        Vector4 result;
        int[] view = new int[4];
        GL.GetInteger(GetPName.Viewport, view);

        mouse.Y = view[3] - mouse.Y;
        result.X = (2f*((float)(mouse.X - view[0])/view[2])) - 1f;
        result.Y = (2f*((float)(mouse.Y - view[1]) / view[3])) - 1f;
        result.Z = 0f;
        result.W = 1f;

        double[] projection = new double[16];
        GL.GetDouble(GetPName.ProjectionMatrix, projection);
        Matrix4 Projection = new Matrix4((float)projection[0], (float)projection[1], (float)projection[2], (float)projection[3],
                                                   (float)projection[4], (float)projection[5], (float)projection[6], (float)projection[7],
                                                   (float)projection[8], (float)projection[9], (float)projection[10], (float)projection[11],
                                                   (float)projection[12], (float)projection[13], (float)projection[14], (float)projection[15]);
        double[] modelViewMatrix = new double[16];
        GL.GetDouble(GetPName.ModelviewMatrix, modelViewMatrix);
        Matrix4 MV = new Matrix4((float)modelViewMatrix[0], (float)modelViewMatrix[1], (float)modelViewMatrix[2], (float)modelViewMatrix[3],
                                                   (float)modelViewMatrix[4], (float)modelViewMatrix[5], (float)modelViewMatrix[6], (float)modelViewMatrix[7],
                                                   (float)modelViewMatrix[8], (float)modelViewMatrix[9], (float)modelViewMatrix[10], (float)modelViewMatrix[11],
                                                   (float)modelViewMatrix[12], (float)modelViewMatrix[13], (float)modelViewMatrix[14], (float)modelViewMatrix[15]);

        Matrix4 iMVP = Matrix4.Invert(Matrix4.Mult(MV, Projection));
        result = Vector4.Transform(result, iMVP);

        if (result.W > float.Epsilon || result.W < float.Epsilon)
        {
            result.X /= result.W;
            result.Y /= result.W;
            result.Z = 0f;
            //result.Z /= result.W;
        }

        return result.Xyz;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:36:28.510

GLU 和 GLUT 不是一回事。GLU 功能应该存在于任何相当现代的 OpenGL 安装中。

值得一提的是，gluUnProject 的实现实际上在[其手册页](http://www.opengl.org/sdk/docs/man/xhtml/gluUnProject.xml)中有详细说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T02:43:29.503

```
vec3f cameraPos=camera->position();
vec3f objectPos=vec3f(
    (float)(mousePos.x)/(videoProperties.w)*2-1,
    1,
    (float)(((videoProperties.h)-mousePos.y))/(videoProperties.h)*2-1);
objectPos.x/=(videoProperties.h)/(videoProperties.w);
objectPos*=distance;
objectPos+=cameraPos;
objectPos*=camera->transformation();//may need to inverse this depending on your camera system 
```

这是我在我的引擎中使用的

# sql - 如何连接具有字符限制的字段“溢出”

> ID：11058478
> 
> 赞同：1
> 
> 时间：2012-06-15T21:32:10.757
> 
> 标签：sql, sql-server, tsql

我有一个包含 3 个地址字段的表，每个地址字段的限制为 100 个字符。

我需要创建一个查询以使每个地址字段的最大字符限制为 30 个字符。如果一个地址字段大于 30，那么我将切断其余部分，但将剩余部分连接到下一个地址字段的开头。我会这样做，直到最后一个地址字段（address3）被填满，然后摆脱最后一个地址字段的剩余部分。

有没有办法通过 SQL 查询或 T-SQL 来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:46:49.683

您没有指定如何处理非常短的地址，但我的第一次破解是这样的：

```
with temp as
(
  select 1 id, 'abcdefghijklmnopqrstuvwxyz123456789' part1, 'second part' part2, 'third part' part3
),
 concated as
(
  SELECT id, part1 + part2 + part3 as whole
  FROM temp
)
select  id, 
        SUBSTRING(whole, 0, 30) f, 
        SUBSTRING(whole, 30,30) s, 
        SUBSTRING(whole, 60,30) t 
from concated 
```

这将返回：

```
id  | f                               | s                            | t
1   | abcdefghijklmnopqrstuvwxyz123   | 456789second partthird part  | 
```

如果这不是您要查找的内容，请为上述内容指定所需的输出。

**更新：**

嗯......这似乎工作，但它很恶心。我相信有人可以提出更好的解决方案。

```
with temp as
(
  select 1 id, 'abcdefghijklmnopqrstuvwxyz123456789 ' part1, 'second part' part2, 'third part' part3
)
select  id, 
        SUBSTRING(part1, 0, 30) f, 
        SUBSTRING(SUBSTRING(part1, 30, 70) + SUBSTRING(part2, 0,30),0,30) s, 
        SUBSTRING(SUBSTRING(SUBSTRING(SUBSTRING(part1, 30, 70) + SUBSTRING(part2, 0,30),30,70),0,30) + SUBSTRING(part3, 0,30),0,30) t 
from temp 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-17T05:17:41.560

我想我会按照问题描述去写一些“显然”正确的东西（前提是我已经理解了你的规范:-)）

```
/* Setup data - second example stolen from Abe, first just showing that it works with short enough data */
declare @t table (ID int not null,Address1 varchar(100) not null,Address2 varchar(100) not null,Address3 varchar(100) not null)
insert into @t (ID,Address1,Address2,Address3)
values (1,'abc','def','ghi'),
(2,'abcdefghijklmnopqrstuvwxyz123456789 ', 'second part', 'third part')

/* Actual query - shift address pieces through the address fields, but only to later ones */
;with Shift1 as (
    select
        ID,SUBSTRING(Address1,1,30) as Address1,SUBSTRING(Address1,31,70) as Address1Over,Address2,Address3
    from @t
), Shift2 as (
    select
        ID,Address1,SUBSTRING(Address1Over+Address2,1,30) as Address2,SUBSTRING(Address1Over+Address2,31,70) as Address2Over,Address3
    from Shift1
), Shift3 as (
    select
        ID,Address1,Address2,SUBSTRING(Address2Over+Address3,1,30) as Address3
    from Shift2
)
select * from Shift3 
```

结果：

```
ID            Address1                          Address2                          Address3
----------- ------------------------------ ------------------------------ ------------------------------
1           abc                                 def                                ghi
2           abcdefghijklmnopqrstuvwxyz1234   56789 second part                 third part 
```

# video - ffmpeg - 移动覆盖/文本命令如何工作？

> ID：11058479
> 
> 赞同：1
> 
> 时间：2012-06-15T21:32:13.083
> 
> 标签：video, ffmpeg

在 Ffmpeg 中，您可以创建移动文本：

```
ffmpeg -y -t 10 -s qcif -f rawvideo -pix_fmt rgb24 -s 1280x720 -i /dev/zero -g 1 -r 24 -vf drawtext="fontfile=~/fonts/Trebuchet_MS.ttf:text='thing crawls':fontsize=155:fontcolor=red:y=h-20*t" wow.mpg 
```

所以这会给我一个黑色的框架，“东西爬行”从下往上慢慢地......

如果我知道视频的长度（20 秒）并且想要例如创建从屏幕顶部在时间 0 开始并一直到屏幕底部直到 00:00:20 的“东西坠落”，如何我这样做吗？

我也可以创建文本从上到下开始但在屏幕中间停止的情况吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T23:45:18.167

[FFmpeg 文档](http://ffmpeg.org/ffmpeg.html#drawtext)提供了使用 drawtext 过滤器时必须使用的变量的完整列表，但对于移动文本，有一些特别感兴趣：

> 'n'<br> 输入帧数，从0开始
> 
> 't'<br> 以秒表示的时间戳，如果输入时间戳未知，则为 NAN

有了这些，您可以根据已经看到的帧数来设置文本位置。这就是`y=h-20*t`您示例中的表达式正在执行的操作。随着`t`增加，文本随着减少而靠近视频顶部`h-20*t`。

为了使您的示例“事物落下”，您需要一个类似的术语`20*t`。因为`y`位置从视频顶部的0开始，随着`t`增加，它会向下移动屏幕。

对于停在屏幕中间的文本，您可能会做一些花哨的数学运算，或者只是使用 FFmpeg[丰富的逻辑函数集](http://ffmpeg.org/ffmpeg-utils.html#Expression-Evaluation)。像这样的东西在小于一半高度`y=t*20*lte(t*20,h/2) + h/2*gt(t*20,h/2)`时移动文本，然后立即保持位置大于一半高度。`t*20``y``h/2``t*20`

# python - Python win32com.adsi 模块限制从 AD 返回的成员数

> ID：11058480
> 
> 赞同：0
> 
> 时间：2012-06-15T21:32:14.207
> 
> 标签：python, active-directory, win32com, adsi

使用以下代码...

```
import win32com.adsi

DNC=win32com.adsi.ADsGetObject('LDAP://rootDSE').Get('DefaultNamingContext')
path = 'LDAP://cn=BIG_GROUP,ou=Groups,'+DNC
groupobj = win32com.adsi.ADsGetObject(path)
users = groupobj.member
print len(users) 
```

即使 BIG_GROUP 包含数千个成员，输出也始终为最大值 1500。如何以返回 BIG_GROUP 的所有成员的方式执行此查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T03:36:19.927

AD 一次从一个大属性（如成员）返回 N 个结果，其中 N 是最大范围检索大小。该目录支持所谓的范围检索，您可以在其中每次提取最多 1500 个值的分组。
您应该对目录使用范围检索控制。我不知道您的 LDAP API 是否支持这一点，但文档应该回答。

这里有更多信息，来自[MSFT 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa367017%28v=vs.85%29.aspx)

# python - python字符串语法错误+=运算符

> ID：11058482
> 
> 赞同：2
> 
> 时间：2012-06-15T21:32:19.577
> 
> 标签：python, string

我在 Python 2.7.3 中遇到语法错误，如下所示：

```
[s += 'Orig' for s in strs]
  File "<stdin>", line 1
    [s += 'Orig' for s in strs]
        ^
SyntaxError: invalid syntax 
```

其中 strs 只是一个字符串列表，例如`['a', 'b', 'c', 'd']`

如果我将代码更改为：

```
[s + 'Orig' for s in strs] 
```

然后它工作：

```
['aOrig', 'bOrig', 'cOrig', 'dOrig'] 
```

这背后的原因是什么？是因为列表推导中的 s 不可变吗？但它应该是一个临时对象，无论如何以后都会被丢弃，为什么不呢？

另外，做我想做的最有效的方法是什么？我查看了另一个链接：[http](http://www.skymind.com/~ocrow/python_string/) ://www.skymind.com/~ocrow/python_string/并尝试使用 join，但 join 不符合我的要求；它将字符串列表连接到单个字符串中，而我想将字符串附加到字符串列表中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T21:34:26.840

Python 中的赋值（包括`+=`）是语句，而不是表达式。您只能在列表推导中使用表达式。

你的例子`+`没有做你想让它做什么？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-15T21:36:53.457

你不能这样做。`s += 'Orig'`是 的简写`s = s + Orig`，它是一个赋值。为清楚起见，python 不允许您将赋值语句放在其他语句中。请参阅[为什么我不能在表达式中使用赋值？](http://docs.python.org/faq/design.html#why-can-t-i-use-an-assignment-in-an-expression)在 Python 常见问题解答中了解更多详细信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-15T21:46:19.737

好吧，你可以做

```
strs = [s+'Orig' for s in strs] 
```

或者

```
strs = map(lambda s: s+'Orig', strs) 
```

我发现列表理解（第一个）更容易阅读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T21:35:21.807

您不能将其用作表达式。只有通过语句中的赋值才能使用 (+=) 符号。

# php - 对齐字符串算法

> ID：11058483
> 
> 赞同：49
> 
> 时间：2012-06-15T21:32:26.767
> 
> 标签：php, algorithm

刚刚参加了一次工作面试，我被要求用这个签名实现一个功能：

```
function justify($str_in, $desired_length) 
```

它需要模仿 HTML 的 text-align: justify 会做什么，这里有一些例子（desired_length = 48）

```
    hello world there ok then = hello......world......there........ok.......then
    你好 = ......你好......
    好的然后 = 好的.......................................然后
    我认为这个字符串几乎肯定比 48 长 = this.string.is.almost.certainly.longer.than.48。
    两个词 = 两个 .................................... 词
    三个好的词=三个........好的........词
    1 2 3 4 5 6 7 8 9 = 1....2....3........4..5....6........7.... 8.....9

```

（我用句号替换了空格来说明）

单词之间的空格长度可能永远不会相差超过一。

我写*了*一个 PHP 解决方案，但我更感兴趣的是人们可以想出什么算法来解决这个问题。这是我在工作面试中遇到的第一个白板问题，我担心多种因素的结合让我花的时间比我应该做的要长。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T22:54:13.917

这就是我想出的。我添加了可选`$char`参数，以便您可以看到它输出的内容 - 当然，您可以将其拉入函数内部，以便原型符合要求。

```
function justify($str_in, $desired_length, $char = '_') {

    // Some common vars and simple error checking / sanitation
    $return = '';
    $str_in = trim( $str_in);
    $desired_length = intval( $desired_length);

    // If we've got invalid input, we're done
    if( $desired_length <= 0)
        return $str_in;

    // If the input string is greater than the length, we need to truncate it WITHOUT splitting words
    if( strlen( $str_in) > $desired_length) {
        $str = wordwrap($str_in, $desired_length);
        $str = explode("\n", $str);
        $str_in = $str[0];
    }

    $words = explode( ' ', $str_in);
    $num_words = count( $words);

    // If there's only one word, it's a simple edge case
    if( $num_words == 1) {
        $length = ($desired_length - strlen( $words[0])) / 2;
        $return .= str_repeat( $char, floor( $length)) . $words[0] . str_repeat( $char, ceil( $length));
    } else {
        $word_length = strlen( implode( '', $words));

        // Calculate the number of spaces to distribute over the words
        $num_words--; // We're going to eliminate the last word
        $spaces = floor( ($desired_length - $word_length) / $num_words);
        $remainder = $desired_length - $word_length - ($num_words * $spaces);

        $last = array_pop( $words);
        foreach( $words as $word) {
            // If we didn't get an even number of spaces to distribute, just tack it on to the front
            $spaces_to_add = $spaces;
            if( $remainder > 0) {
                $spaces_to_add++;
                $remainder--;
            }

            $return .= $word . str_repeat( $char, $spaces_to_add);
        }
        $return .= $last;
    }
    return $return;
} 
```

和测试用例：

```
$inputs = array( 
    'hello world there ok then',
    'hello',
    'ok then',
    'this string is almost certainly longer than 48 I think',
    'two words',
    'three ok words',
    '1 2 3 4 5 6 7 8 9'
);

foreach( $inputs as $x) {
    $ret = justify( $x, 48);
    echo 'Inp: ' . $x . " - strlen(" . strlen( $x) .  ")\n";
    echo 'Out: ' . $ret . " - strlen(" . strlen( $ret) .  ")\n\n";
} 
```

和输出：

```
Inp: hello world there ok then - strlen(25)
Out: hello_______world_______there_______ok______then - strlen(48)

Inp: hello - strlen(5)
Out: _____________________hello______________________ - strlen(48)

Inp: ok then - strlen(7)
Out: ok__________________________________________then - strlen(48)

Inp: this string is almost certainly longer than 48 I think - strlen(54)
Out: this_string_is_almost_certainly_longer_than_48_I - strlen(48)

Inp: two words - strlen(9)
Out: two________________________________________words - strlen(48)

Inp: three ok words - strlen(14)
Out: three__________________ok__________________words - strlen(48)

Inp: 1 2 3 4 5 6 7 8 9 - strlen(17)
Out: 1_____2_____3_____4_____5_____6_____7_____8____9 - strlen(48) 
```

[和一个演示！](http://codepad.viper-7.com/usNb72)

**编辑：**清理了代码，[它仍然有效:)](http://codepad.viper-7.com/xieUfk)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-16T01:00:59.853

不使用任何循环/递归或带有回调的正则表达式成为个人挑战。我用一个`explode()`和一个`implode()`来实现这一点。巨大的成功！

# 编码

```
function justify($str, $maxlen) {
    $str = trim($str);

    $strlen = strlen($str);
    if ($strlen >= $maxlen) {
        $str = wordwrap($str, $maxlen);
        $str = explode("\n", $str);
        $str = $str[0];
        $strlen = strlen($str);
    }

    $space_count = substr_count($str, ' ');
    if ($space_count === 0) {
        return str_pad($str, $maxlen, ' ', STR_PAD_BOTH);
    }

    $extra_spaces_needed = $maxlen - $strlen;
    $total_spaces = $extra_spaces_needed + $space_count;

    $space_string_avg_length = $total_spaces / $space_count;
    $short_string_multiplier = floor($space_string_avg_length);
    $long_string_multiplier = ceil($space_string_avg_length);

    $short_fill_string = str_repeat(' ', $short_string_multiplier);
    $long_fill_string = str_repeat(' ', $long_string_multiplier);

    $limit = ($space_string_avg_length - $short_string_multiplier) * $space_count;

    $words_split_by_long = explode(' ', $str, $limit+1);
    $words_split_by_short = $words_split_by_long[$limit];
    $words_split_by_short = str_replace(' ', $short_fill_string, $words_split_by_short);
    $words_split_by_long[$limit] = $words_split_by_short;

    $result = implode($long_fill_string, $words_split_by_long);

    return $result;
} 
```

# 短（348 个字符）

```
function j($s,$m){$s=trim($s);$l=strlen($s);if($l>=$m){$s=explode("\n",wordwrap($s,$m));$s=$s[0];$l=strlen($s);}$c=substr_count($s,' ');if($c===0)return str_pad($s,$m,' ',STR_PAD_BOTH);$a=($m-$l+$c)/$c;$h=floor($a);$i=($a-$h)*$c;$w=explode(' ',$s,$i+1);$w[$i]=str_replace(' ',str_repeat(' ',$h),$w[$i]);return implode(str_repeat(' ',ceil($a)),$w);} 
```

# 算法/代码解释

1.  处理两个异常（字符串长于最大长度或只有一个单词）。
2.  找出每个单词之间所需的平均间距 ( `$space_string_avg_length`)。
3.  `ceil()`分别基于和`floor()`，创建用于单词之间的长短填充字符串`$space_string_avg_length`。
4.  找出我们需要多少长填充字符串。( `$limit+1`)。
5.  根据我们需要多少长填充字符串拆分文本。
6.  用短填充字符串替换数组最后一部分中的空格，由拆分产生。
7.  将拆分文本与长填充字符串重新连接在一起。

# 测试

```
$tests = array(
    'hello world there ok then',
    'hello',
    'ok then',
    'this string is almost certainly longer than 48 I think',
    'two words',
    'three ok words',
    '1 2 3 4 5 6 7 8 9'
);

foreach ($tests as $test) {
    $len_before = strlen($test);
    $processed = str_replace(' ', '_', justify($test, 48));
    $len_after = strlen($processed);
    echo "IN($len_before): $test\n";
    echo "OUT($len_after): $processed\n";
} 
```

# 结果

```
IN(25): hello world there ok then
OUT(48): hello_______world_______there_______ok______then
IN(5): hello
OUT(48): _____________________hello______________________
IN(7): ok then
OUT(48): ok__________________________________________then
IN(54): this string is almost certainly longer than 48 I think
OUT(48): this_string_is_almost_certainly_longer_than_48_I
IN(9): two words
OUT(48): two________________________________________words
IN(14): three ok words
OUT(48): three__________________ok__________________words
IN(17): 1 2 3 4 5 6 7 8 9
OUT(48): 1_____2_____3_____4_____5_____6_____7_____8____9 
```

# [看它跑！](http://codepad.org/rgM2q2jT)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-15T22:39:24.570

这是我的解决方案，没有讨厌的循环

```
function justify( $str_in, $desired_length=48 ) {
    if ( strlen( $str_in ) > $desired_length ) {
        $str_in = current( explode( "\n", wordwrap( $str_in, $desired_length ) ) );
    }
    $string_length = strlen( $str_in );
    $spaces_count = substr_count( $str_in, ' ' );
    $needed_spaces_count = $desired_length - $string_length + $spaces_count;
    if ( $spaces_count === 0 ) {
        return str_pad( $str_in, $desired_length, ' ', STR_PAD_BOTH );
    }
    $spaces_per_space = ceil( $needed_spaces_count / $spaces_count );
    $spaced_string = preg_replace( '~\s+~', str_repeat( ' ', $spaces_per_space ), $str_in );
    return preg_replace_callback(
        sprintf( '~\s{%s}~', $spaces_per_space ),
        function ( $m ) use( $spaces_per_space ) {
            return str_repeat( ' ', $spaces_per_space-1 );
        },
        $spaced_string,
        strlen( $spaced_string ) - $desired_length
    );
} 
```

评论和输出...

[https://gist.github.com/2939068](https://gist.github.com/2939068)

1.  找出有多少个空格
2.  找出需要多少空间
3.  用满足或刚好超过所需行长所需的空间量（均匀分布）替换现有空间
4.  使用 preg_replace_callback 将数量替换`\s{spaces_inserted}`为`\s{spaces_inserted-1}`满足所需行长所需的数量

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-16T14:14:56.283

我想看看哪种算法最有效，所以我运行了一些基准测试。我对所有 7 个测试用例进行了 100k 次迭代。（在单核 Ubuntu 虚拟机中运行）

*@ppsreejith*和*@Kristian Antonsen*的代码的结果被省略了，因为他们的代码在我尝试运行它时崩溃了。~~*@PhpMyCoder*的代码运行，只要我在对象构造后没有将格式设置为 48 长度。因此测试结果不完整。~~（固定的）

# 基准测试结果

```
$ php justify.bench.php
盖伦（justify1）：5.1464750766754
nickb(justify2): 3.8629620075226
保罗·贝甘蒂诺（justify3）：4.3705048561096
用户 381521（justify5）：8.5988481044769
vlzvl(justify7): 6.6795041561127
亚历山大（justify8）：6.7060301303864
哦哈尔（justify9）：2.9896130561829

PhpMyCoder：6.1514630317688（已修复！）

```

# 证明.bench.php

```
<?php
$tests = array(
    'hello world there ok then',
    'hello',
    'ok then',
    'this string is almost certainly longer than 48 I think',
    'two words',
    'three ok words',
    '1 2 3 4 5 6 7 8 9'
);
$testers = array(
    'Galen' => 'justify1',
    'nickb' => 'justify2',
    'Paolo Bergantino' => 'justify3',
//    'Kristian Antonsen' => 'justify4',
    'user381521' => 'justify5',
//    'ppsreejith' => 'justify6',
    'vlzvl' => 'justify7',
    'Alexander' => 'justify8',
    'ohaal' => 'justify9'
);
// ppsreejith and Kristian Antonsen's code crashed and burned when I tried to run it
// PhpMyCoder is a special case, but his code also crashed when doing $jus->format(48);

foreach ($testers as $tester => $func) {
    $b=microtime(true);
    for($i=0;$i<100000;$i++)
        foreach ($tests as $test)
            $func($test,48);
    $a=microtime(true);
    echo $tester.'('.$func.'): '.($a-$b)."\n";
}

echo "\n";

// Fixed!
$jus = new Justifier($tests);
$b=microtime(true);

for($i=0;$i<100000;$i++) {
    $jus->format(54);
}

$a=microtime(true);
echo 'PhpMyCoder: '.($a-$b)." (Fixed!)\n";

// ALGORITHMS BELOW

// Galen
function justify1( $str_in, $desired_length=48 ) {
    if ( strlen( $str_in ) > $desired_length ) {
        $str_in = current( explode( "\n", wordwrap( $str_in, $desired_length ) ) );
    }
    $string_length = strlen( $str_in );
    $spaces_count = substr_count( $str_in, ' ' );
    $needed_spaces_count = $desired_length - $string_length + $spaces_count;
    if ( $spaces_count === 0 ) {
        return str_pad( $str_in, $desired_length, ' ', STR_PAD_BOTH );
    }
    $spaces_per_space = ceil( $needed_spaces_count / $spaces_count );
    $spaced_string = preg_replace( '~\s+~', str_repeat( ' ', $spaces_per_space ), $str_in );
    return preg_replace_callback(
        sprintf( '~\s{%s}~', $spaces_per_space ),
        function ( $m ) use( $spaces_per_space ) {
            return str_repeat( ' ', $spaces_per_space-1 );
        },
        $spaced_string,
        strlen( $spaced_string ) - $desired_length
    );
}
// nickb
function justify2($str_in, $desired_length, $char = '_') {

    // Some common vars and simple error checking / sanitation
    $return = '';
    $str_in = trim( $str_in);
    $desired_length = intval( $desired_length);

    // If we've got invalid input, we're done
    if( $desired_length <= 0)
        return $str_in;

    // If the input string is greater than the length, we need to truncate it WITHOUT splitting words
    if( strlen( $str_in) > $desired_length) {
        $str = wordwrap($str_in, $desired_length);
        $str = explode("\n", $str);
        $str_in = $str[0];
    }

    $words = explode( ' ', $str_in);
    $num_words = count( $words);

    // If there's only one word, it's a simple edge case
    if( $num_words == 1) {
        $length = ($desired_length - strlen( $words[0])) / 2;
        $return .= str_repeat( $char, floor( $length)) . $words[0] . str_repeat( $char, ceil( $length));
    } else {
        $word_length = strlen( implode( '', $words));

        // Calculate the number of spaces to distribute over the words
        $num_words--; // We're going to eliminate the last word
        $spaces = floor( ($desired_length - $word_length) / $num_words);
        $remainder = $desired_length - $word_length - ($num_words * $spaces);

        $last = array_pop( $words);
        foreach( $words as $word) {
            // If we didn't get an even number of spaces to distribute, just tack it on to the front
            $spaces_to_add = $spaces;
            if( $remainder > 0) {
                $spaces_to_add++;
                $remainder--;
            }

            $return .= $word . str_repeat( $char, $spaces_to_add);
        }
        $return .= $last;
    }
    return $return;
}
// Paolo Bergantino
function justify3($str, $to_len) {
    $str = trim($str);
    $strlen = strlen($str);

    if($str == '') return '';

    if($strlen >= $to_len) {
        return substr($str, 0, $to_len);   
    }

    $words = explode(' ', $str);
    $word_count = count($words);
    $space_count = $word_count - 1;

    if($word_count == 1) {
        return str_pad($str, $to_len, ' ', STR_PAD_BOTH);
    }

    $space = $to_len - $strlen + $space_count;
    $per_space = $space/$space_count;

    if(is_int($per_space)) {
        return implode($words, str_pad('', $per_space, ' '));    
    }

    $new_str = '';
    $spacing = floor($per_space);
    $new_str .= $words[0] . str_pad('', $spacing);
    foreach($words as $x => $word) {
        if($x == $word_count - 1 || $x == 0) continue;
        if($x < $word_count - 1) {
            $diff = $to_len - strlen($new_str) - (strlen(implode('', array_slice($words, $x))));
            $new_str .= $word . str_pad('', floor($diff/($space_count - $x)), ' ');
        }
    }
    $new_str .= $words[$x];

    return $new_str;   
}
// Kristian Antonsen
function justify4($str_in, $desired_length)
{
    foreach ($str_in as &$line) {
        $words = explode(' ', $line);
        $word_count = count($words) - 1;
        $spaces_to_fill = $desired_length - strlen($line) + $word_count;
        if (count($words) == 1) {
            $line = str_repeat('_', ceil($spaces_to_fill/2)) . $line
                  . str_repeat('_', floor($spaces_to_fill/2));
            continue;
        }
        $next_space = floor($spaces_to_fill/$word_count);
        $leftover_space = $spaces_to_fill % $word_count;
        $line = array_shift($words);
        foreach($words as $word) {
            $extra_space = ($leftover_space) ? ceil($leftover_space / $word_count) : 0;
            $leftover_space -= $extra_space;
            $line .= str_repeat('_', $next_space + $extra_space) . $word;
        }
    }
    return $str_in;
}
// user381521
function justify5 ($str, $len)
{
    // split by whitespace, remove empty strings
    $words = array_diff (preg_split ('/\s+/', $str), array (""));

    // just space if no words
    if (count ($words) == 0)
        return str_repeat (" ", $len);

    // add empty strings if only one element
    if (count ($words) == 1)
        $words = array ("", $words[0], "");

    // get number of words and spaces
    $wordcount = count ($words);
    $numspaces = $wordcount - 1;

    // get number of non-space characters
    $numchars = array_sum (array_map ("strlen", $words));

    // get number of characters remaining for space
    $remaining = $len - $numchars;

    // return if too little spaces remaining
    if ($remaining <= $numspaces)
        return substr (implode (" ", $words), 0, $len);

    // get number of spaces per space
    $spaces_per_space = $remaining / $numspaces;
    $spaces_leftover = $remaining % $numspaces;

    // make array for spaces, spread out leftover spaces
    $spaces = array_fill (0, $numspaces, $spaces_per_space);
    while ($spaces_leftover--)
        $spaces[$numspaces - $spaces_leftover - 1]++;
    $spaces[] = 0; // make count ($words) == count ($spaces)

    // join it all together
    $result = array ();
    foreach ($words as $k => $v)
        array_push ($result, $v, str_repeat (" ", $spaces[$k]));
    return implode ($result);
}
// ppsreejith
function justify6($str, $to_len) {
    $str = trim($str);
    $strlen = strlen($str);

    if($str == '') return '';

    if($strlen >= $to_len) {
        return substr($str, 0, $to_len);   
    }

    $words = explode(' ', $str);
    $word_count = count($words);
    $space_count = $word_count - 1;

    if($word_count == 1) {
        return str_pad($str, $to_len, ' ', STR_PAD_BOTH);
    }

    $space = $to_len - $strlen + $space_count;
    $per_space = floor($space/$space_count);
    $spaces = str_pad('', $per_space, ' ');
    $curr_word = implode($words, $spaces);
    while(strlen($curr_word) < $to_len){
    $curr_word = substr($curr_word,0,preg_match("[! ][".$spaces."][! ]",$curr_word)." ".preg_match("[! ][".$spaces."][! ]",$curr_word));
    }
    return $curr_word;
}
// vlzvl
function justify7($str_in, $desired_length)
{
   $str_in = preg_replace("!\s+!"," ",$str_in);   // get rid of multiple spaces
   $words = explode(" ",$str_in);   // break words
   $num_words = sizeof($words);     // num words
   if ($num_words==1) {
      return str_pad($str_in,$desired_length,"_",STR_PAD_BOTH);
   }
   else {
      $num_chars = 0; $lenwords = array();
      for($x=0;$x<$num_words;$x++) { $num_chars += $lenwords[$x] = strlen($words[$x]); }
      $each_div = round(($desired_length - $num_chars) / ($num_words-1));
      for($x=0,$sum=0;$x<$num_words;$x++) { $sum += ($lenwords[$x] + ($x<$num_words-1 ? $each_div : 0)); }
      $space_to_addcut = ($desired_length - $sum);
      for($x=0;$x<$num_words-1;$x++) {
         $words[$x] .= str_repeat("_",$each_div+($each_div>1? ($space_to_addcut<0?-1:($space_to_addcut>0?1:0)) :0));
         if ($each_div>1) { $space_to_addcut += ($space_to_addcut<0 ? 1 : ($space_to_addcut>0?-1:0) ); }
      }
      return substr(implode($words),0,$desired_length);
   }
}
// Alexander
function justify8($str, $length) {
  $words   = explode(' ', $str);
  if(count($words)==1) $words = array("", $str, "");
  $spaces  = $length - array_sum(array_map("strlen", $words));
  $add     = (int)($spaces / (count($words) - 1));
  $left    = $spaces % (count($words) - 1);
  $spaced  = implode(str_repeat("_", $add + 1), array_slice($words, 0, $left + 1));
  $spaced .= str_repeat("_", max(1, $add));
  $spaced .= implode(str_repeat("_", max(1, $add)), array_slice($words, $left + 1));
  return substr($spaced, 0, $length);
}
// ohaal
function justify9($s,$m){$s=trim($s);$l=strlen($s);if($l>=$m){$s=explode("\n",wordwrap($s,$m));$s=$s[0];$l=strlen($s);}$c=substr_count($s,' ');if($c===0)return str_pad($s,$m,' ',STR_PAD_BOTH);$a=($m-$l+$c)/$c;$h=floor($a);$i=($a-$h)*$c;$w=explode(' ',$s,$i+1);$w[$i]=str_replace(' ',str_repeat(' ',$h),$w[$i]);return implode(str_repeat(' ',ceil($a)),$w);}

// PhpMyCoder
class Justifier {
    private $text;

    public function __construct($text) {
        if(!is_string($text) && !is_array($text)) {
            throw new InvalidArgumentException('Expected a string or an array of strings, instead received type: ' . gettype($text));
        }

        if(is_array($text)) {
            // String arrays must be converted to JustifierLine arrays
            $this->text = array_map(function($line) {
                return JustifierLine::fromText($line);
            }, $text);
        } else {
            // Single line of text input
            $this->text = $text;
        }
    }

    public function format($width = NULL) {
        // Strings have to be broken into an array and then jusitifed
        if(is_string($this->text)) {
            if($width == null) {
                throw new InvalidArgumentException('A width must be provided for separation when an un-split string is provided');
            }

            if($width <= 0) {
                throw new InvalidArgumentException('Expected a positive, non-zero width, instead received width of ' . $width);
            }

            // Break up a JustifierLine of all text until each piece is smaller or equal to $width
            $lines = array(JustifierLine::fromText($this->text));
            $count = 0;
            $newLine = $lines[0]->breakAtColumn($width);

            while($newLine !== null) {
                $lines[] = $newLine;
                $newLine = $lines[++$count]->breakAtColumn($width);
            }
        } else {
            $lines = $this->text;

            // Allow for fluid width (uses longest line with single space)
            if($width == NULL) {
                $width = -1;

                foreach($lines as $line) {
                    // Width of line = Sum of the lengths of the words and the spaces (number of words - 1)
                    $newWidth = $line->calculateWordsLength() + $line->countWords() - 1;

                    if($newWidth > $width) { // Looking for the longest line
                        $width = $newWidth;
                    }
                }
            }
        }

        // Justify each element of array
        //$output = array_map(function($line) use ($width) {
        //    return $this->justify($line, $width);
        //}, $lines);

        $output = array();
        foreach($lines as $line) {
            $output[] = $this->justify($line, $width);
        }            

        // If a single-line is passed in, a single line is returned
        if(count($output)) {
            return $output[0];
        }

        return $output;
    }

    private function justify(JustifierLine $line, $width) {
        // Retrieve already calculated line information
        $words     = $line->extractWords();
        $spaces    = $line->countWords() - 1;
        $wordLens  = $line->findWordLengths();
        $wordsLen  = $line->calculateWordsLength();
        $minWidth  = $wordsLen + $spaces;
        $output    = '';

        if($minWidth > $width) {
            throw new LengthException('A minimum width of ' . $minWidth . ' was required, but a width of ' . $width . ' was given instead');
        }

        // No spaces means only one word (center align)
        if($spaces == 0) {
            return str_pad($words[0], $width, ' ', STR_PAD_BOTH);
        }

        for(;$spaces > 0; $spaces--) {
            // Add next word to output and subtract its length from counters
            $output   .= array_shift($words);
            $length    = array_shift($wordLens);
            $wordsLen -= $length;
            $width    -= $length;

            if($spaces == 1) { // Last Iteration
                return $output . str_repeat(' ', $width - $wordsLen) . $words[0];
            }

            // Magic padding is really just simple math
            $padding  = floor(($width - $wordsLen) / $spaces);
            $output  .= str_repeat(' ', $padding);
            $width   -= $padding;
        }
    }
}

class JustifierLine {
    private $words;
    private $numWords;
    private $wordLengths;
    private $wordsLength;

    public static function fromText($text) {
        // Split words into an array
        preg_match_all('/[^ ]+/', $text, $matches, PREG_PATTERN_ORDER);
        $words       = $matches[0];

        // Count words
        $numWords    = count($words);

        // Find the length of each word
        $wordLengths = array_map('strlen', $words);

        //And Finally, calculate the total length of all words
        $wordsLength = array_reduce($wordLengths, function($result, $length) {
            return $result + $length;
        }, 0);

        return new JustifierLine($words, $numWords, $wordLengths, $wordsLength);
    }

    private function __construct($words, $numWords, $wordLengths, $wordsLength) {
        $this->words       = $words;
        $this->numWords    = $numWords;
        $this->wordLengths = $wordLengths;
        $this->wordsLength = $wordsLength;
    }

    public function extractWords() { return $this->words; }
    public function countWords() { return $this->numWords; }
    public function findWordLengths() { return $this->wordLengths; }
    public function calculateWordsLength() { return $this->wordsLength; }

    public function breakAtColumn($column) {
        // Avoid extraneous processing if we can determine no breaking can be done
        if($column >= ($this->wordsLength + $this->numWords - 1)) {
            return null;
        }

        $width       = 0;
        $wordsLength = 0;

        for($i = 0; $i < $this->numWords; $i++) {
            // Add width of next word
            $width += $this->wordLengths[$i];

            // If the line is overflowing past required $width
            if($width > $column) {
                // Remove overflow at end & create a new object with the overflow
                $words             = array_splice($this->words, $i);
                $numWords          = $this->numWords - $i;
                $this->numWords    = $i;
                $wordLengths       = array_splice($this->wordLengths, $i);
                $tempWordsLength   = $wordsLength;
                $wordsLength       = $this->wordsLength - $wordsLength;
                $this->wordsLength = $tempWordsLength;

                return new JustifierLine($words, $numWords, $wordLengths, $wordsLength);
            }

            $width++; // Assuming smallest spacing to fit

            // We also have to keep track of the total $wordsLength
            $wordsLength += $this->wordLengths[$i];
        }

        return null;
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-16T08:45:47.097

这是我的解决方案。没有讨厌的正则表达式:)

```
function justify($str, $length) {
  $words   = explode(' ', $str);
  if(count($words)==1) $words = array("", $str, "");
  $spaces  = $length - array_sum(array_map("strlen", $words));
  $add     = (int)($spaces / (count($words) - 1));
  $left    = $spaces % (count($words) - 1);
  $spaced  = implode(str_repeat("_", $add + 1), array_slice($words, 0, $left + 1));
  $spaced .= str_repeat("_", max(1, $add));
  $spaced .= implode(str_repeat("_", max(1, $add)), array_slice($words, $left + 1));
  return substr($spaced, 0, $length);
} 
```

这是由[PHP 数组函数](http://www.php.net/manual/en/ref.array.php)提供支持的。

这是[工作示例](http://codepad.org/UXD2OECf)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-15T23:11:58.693

我想念我在 Python 中的列表理解...

```
<?php
function justify ($str, $len)
{
    // split by whitespace, remove empty strings
    $words = array_diff (preg_split ('/\s+/', $str), array (""));

    // just space if no words
    if (count ($words) == 0)
        return str_repeat (" ", $len);

    // add empty strings if only one element
    if (count ($words) == 1)
        $words = array ("", $words[0], "");

    // get number of words and spaces
    $wordcount = count ($words);
    $numspaces = $wordcount - 1;

    // get number of non-space characters
    $numchars = array_sum (array_map ("strlen", $words));

    // get number of characters remaining for space
    $remaining = $len - $numchars;

    // return if too little spaces remaining
    if ($remaining <= $numspaces)
        return substr (implode (" ", $words), 0, $len);

    // get number of spaces per space
    $spaces_per_space = $remaining / $numspaces;
    $spaces_leftover = $remaining % $numspaces;

    // make array for spaces, spread out leftover spaces
    $spaces = array_fill (0, $numspaces, $spaces_per_space);
    while ($spaces_leftover--)
        $spaces[$numspaces - $spaces_leftover - 1]++;
    $spaces[] = 0; // make count ($words) == count ($spaces)

    // join it all together
    $result = array ();
    foreach ($words as $k => $v)
        array_push ($result, $v, str_repeat (" ", $spaces[$k]));
    return implode ($result);
}
?> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-15T21:34:48.373

只是没有人认为我想让他们为我做功课，这是我的（工作，我认为）解决方案。

但是，我不确定我是否可能被期望在白板上按需编写这么多代码，所以我很想知道其他人如何在不查看我的代码的情况下解决它。（可以这么说，在他们称我为“时间”之前，我在采访中绕过了 foreach）

```
function justify($str, $to_len) {
    $str = trim($str);
    $strlen = strlen($str);

    if($str == '') return '';

    if($strlen >= $to_len) {
        return substr($str, 0, $to_len);   
    }

    $words = explode(' ', $str);
    $word_count = count($words);
    $space_count = $word_count - 1;

    if($word_count == 1) {
        return str_pad($str, $to_len, ' ', STR_PAD_BOTH);
    }

    $space = $to_len - $strlen + $space_count;
    $per_space = $space/$space_count;

    if(is_int($per_space)) {
        return implode($words, str_pad('', $per_space, ' '));    
    }

    $new_str = '';
    $spacing = floor($per_space);
    $new_str .= $words[0] . str_pad('', $spacing);
    foreach($words as $x => $word) {
        if($x == $word_count - 1 || $x == 0) continue;
        if($x < $word_count - 1) {
            $diff = $to_len - strlen($new_str) - (strlen(implode('', array_slice($words, $x))));
            $new_str .= $word . str_pad('', floor($diff/($space_count - $x)), ' ');
        }
    }
    $new_str .= $words[$x];

    return $new_str;   
}

$tests = array(' hello world there ok then ', 'hello', 'ok then', 'this string is almost certainly longer than 48 I think', 'two words', 'three ok words', '1 2 3 4 5 6 7 8 9');

foreach($tests as $word) {
    print $word . ' = ' . str_replace(' ', '_', justify($word, 48)) . '<br>';
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-15T22:53:51.367

我认为这是完全有效的：（“_”只是保持空间可见）

```
function justify($str_in, $desired_length)
{
   $str_in = preg_replace("!\s+!"," ",$str_in);   // get rid of multiple spaces
   $words = explode(" ",$str_in);   // break words
   $num_words = sizeof($words);     // num words   
   if ($num_words==1) {   
      return str_pad($str_in,$desired_length,"_",STR_PAD_BOTH);   
   }
   else {
      $num_chars = 0; $lenwords = array();
      for($x=0;$x<$num_words;$x++) { $num_chars += $lenwords[$x] = strlen($words[$x]); }
      $each_div = round(($desired_length - $num_chars) / ($num_words-1));
      for($x=0,$sum=0;$x<$num_words;$x++) { $sum += ($lenwords[$x] + ($x<$num_words-1 ? $each_div : 0)); }
      $space_to_addcut = ($desired_length - $sum);
      for($x=0;$x<$num_words-1;$x++) {
         $words[$x] .= str_repeat("_",$each_div+($each_div>1? ($space_to_addcut<0?-1:($space_to_addcut>0?1:0)) :0));
         if ($each_div>1) { $space_to_addcut += ($space_to_addcut<0 ? 1 : ($space_to_addcut>0?-1:0) ); } 
      }
      return substr(implode($words),0,$desired_length);
   }
} 
```

**编辑：**

函数现在也摆脱了单词之间的多个空格。它是如何工作*的（简而言之*）：

*   删除单词之间的连续空格
*   计算单词，所以如果一个（*'hello'*示例）只是填充两者并回显它。
*   ..否则计算所用单词的字符
*   计算要添加的全局和部分空间（示例中的**“_”**）。
*   计算要添加（字符串 len < 所需）或删除（字符串 len > 所需）的额外空间并将其应用于填充。
*   final，将最终字符串减少到所需的长度。

**测试：**

```
$tests = array(
   'hello world there ok then',
   'hello',
   'ok then',
   'this string is almost certainly longer than 48 I think',
   'three ok words',
   '1 2 3 4 5 6 7 8 9',
   'Lorem Ipsum is simply dummy text'
);

$arr = array();
foreach($tests as $key=>$val) {
   $arr[$key] = justify($val,50);
   $arr[$key] .= " - (chars: ".strlen($arr[$key]).")";
}
echo "<pre>".print_r($arr,TRUE)."</pre>"; 
```

**结果：**

```
Array
(
    [0] => hello________world_______there_______ok_______then - (chars: 50)
    [1] => ______________________hello_______________________ - (chars: 50)
    [2] => ok____________________________________________then - (chars: 50)
    [3] => this_string_is_almost_certainly_longer_than_48_I_t - (chars: 50)
    [4] => three___________________ok___________________words - (chars: 50)
    [5] => 1______2_____3_____4_____5_____6_____7_____8_____9 - (chars: 50)
    [6] => Lorem____Ipsum____is_____simply_____dummy_____text - (chars: 50)
) 
```

**那是艰难的:)**

**编辑2：**

函数现在***快了大约 20%***，因为那个基准触动了我 :)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-06-16T02:40:33.493

# （半长）解决方案

我花了一段时间来完善（可能比面试官所允许的要长得多），但我想出了一个优雅的 162 行 OOP 解决方案来解决这个问题。我包含了允许对齐单个字符串、字符串数组（已经分成多行）或需要首先分解成最大宽度的行的长字符串的功能。演示遵循代码块。

~~**重要提示：**此类仅适用于 PHP 5.4。在我自己的服务器 PHP (5.3.6) 上运行一个版本以使用 XDebug 获取分析统计信息时，我意识到了这一点。PHP 5.3 抱怨我`$this`在匿名函数中的使用。[对匿名函数文档](http://php.net/manual/en/functions.anonymous.php)的快速检查表明，`$this`直到 5.4 版本才能在匿名函数的上下文中使用它。如果有人能找到一个干净的解决方法，请将其放在评论中。~~ **添加了对 PHP 5.3 的支持！**

```
<?php
class Justifier {
    private $text;

    public function __construct($text) {
        if(!is_string($text) && !is_array($text)) {
            throw new InvalidArgumentException('Expected a string or an array of strings, instead received type: ' . gettype($text));
        }

        if(is_array($text)) {
            // String arrays must be converted to JustifierLine arrays
            $this->text = array_map(function($line) {
                return JustifierLine::fromText($line);
            }, $text);
        } else {
            // Single line of text input
            $this->text = $text;
        }
    }

    public function format($width = null) {
        // Strings have to be broken into an array and then jusitifed
        if(is_string($this->text)) {
            if($width == null) {
                throw new InvalidArgumentException('A width must be provided for separation when an un-split string is provided');
            }

            if($width <= 0) {
                throw new InvalidArgumentException('Expected a positive, non-zero width, instead received width of ' . $width);
            }

            // Break up a JustifierLine of all text until each piece is smaller or equal to $width
            $lines = array(JustifierLine::fromText($this->text));
            $count = 0;
            $newLine = $lines[0]->breakAtColumn($width);

            while($newLine !== null) {
                $lines[] = $newLine;
                $newLine = $lines[++$count]->breakAtColumn($width);
            }
        } else {
            $lines = $this->text;

            // Allow for fluid width (uses longest line with single space)
            if($width == NULL) {
                $width = -1;

                foreach($lines as $line) {
                    // Width of line = Sum of the lengths of the words and the spaces (number of words - 1)
                    $newWidth = $line->calculateWordsLength() + $line->countWords() - 1;

                    if($newWidth > $width) { // Looking for the longest line
                        $width = $newWidth;
                    }
                }
            }
        }

        // Justify each element of array (PHP 5.4 ONLY)
        //$output = array_map(function($line) use ($width) {
        //  return $this->justify($line, $width);
        //}, $lines);

                    // Support for PHP 5.3
                    $output = array();
                    foreach($lines as $line) {
                        $output = $this->justify($line, $width);
                    }

        // If a single-line is passed in, a single line is returned
        if(count($output)) {
            return $output[0];
        }

        return $output;
    }

    private function justify(JustifierLine $line, $width) {
        // Retrieve already calculated line information
        $words     = $line->extractWords();
        $spaces    = $line->countWords() - 1;
        $wordLens  = $line->findWordLengths();
        $wordsLen  = $line->calculateWordsLength();
        $minWidth  = $wordsLen + $spaces;
        $output    = '';

        if($minWidth > $width) {
            throw new LengthException('A minimum width of ' . $minWidth . ' was required, but a width of ' . $width . ' was given instead');
        }

        // No spaces means only one word (center align)
        if($spaces == 0) {
            return str_pad($words[0], $width, ' ', STR_PAD_BOTH);
        }

        for(;$spaces > 0; $spaces--) {
            // Add next word to output and subtract its length from counters
            $output   .= array_shift($words);
            $length    = array_shift($wordLens);
            $wordsLen -= $length;
            $width    -= $length;

            if($spaces == 1) { // Last Iteration
                return $output . str_repeat(' ', $width - $wordsLen) . $words[0];
            }

            // Magic padding is really just simple math
            $padding  = floor(($width - $wordsLen) / $spaces);
            $output  .= str_repeat(' ', $padding);
            $width   -= $padding;
        }
    }
}

class JustifierLine {
    private $words;
    private $numWords;
    private $wordLengths;
    private $wordsLength;

    public static function fromText($text) {
        // Split words into an array
        preg_match_all('/[^ ]+/', $text, $matches, PREG_PATTERN_ORDER);
        $words       = $matches[0];

        // Count words
        $numWords    = count($words);

        // Find the length of each word
        $wordLengths = array_map('strlen', $words);

        //And Finally, calculate the total length of all words
        $wordsLength = array_reduce($wordLengths, function($result, $length) {
            return $result + $length;
        }, 0);

        return new JustifierLine($words, $numWords, $wordLengths, $wordsLength);
    }

    private function __construct($words, $numWords, $wordLengths, $wordsLength) {
        $this->words       = $words;
        $this->numWords    = $numWords;
        $this->wordLengths = $wordLengths;
        $this->wordsLength = $wordsLength;
    }

    public function extractWords() { return $this->words; }
    public function countWords() { return $this->numWords; }
    public function findWordLengths() { return $this->wordLengths; }
    public function calculateWordsLength() { return $this->wordsLength; }

    public function breakAtColumn($column) {
        // Avoid extraneous processing if we can determine no breaking can be done
        if($column >= ($this->wordsLength + $this->numWords - 1)) {
            return null;
        }

        $width       = 0;
        $wordsLength = 0;

        for($i = 0; $i < $this->numWords; $i++) {
            // Add width of next word
            $width += $this->wordLengths[$i];

            // If the line is overflowing past required $width
            if($width > $column) {
                // Remove overflow at end & create a new object with the overflow
                $words             = array_splice($this->words, $i);
                $numWords          = $this->numWords - $i;
                $this->numWords    = $i;
                $wordLengths       = array_splice($this->wordLengths, $i);
                $tempWordsLength   = $wordsLength;
                $wordsLength       = $this->wordsLength - $wordsLength;
                $this->wordsLength = $tempWordsLength;

                return new JustifierLine($words, $numWords, $wordLengths, $wordsLength);
            }

            $width++; // Assuming smallest spacing to fit

            // We also have to keep track of the total $wordsLength
            $wordsLength += $this->wordLengths[$i];
        }

        return null;
    }
} 
```

# 演示

## 原始问题（将文本行对齐宽度 = 48）

您可以将包含许多字符串或仅一个字符串的数组传递给`Justifier`. 呼唤`Justifier::format($desired_length)`意志~~总是~~*如果将需要分段的字符串数组或字符串传递给构造函数，则*返回对齐行数组。*否则，将返回一个字符串。*（[键盘演示](http://codepad.viper-7.com/96gStD)）

```
$jus = new Justifier(array(
    'hello world there ok then',
    'hello',
    'ok then',
    'two words',
    'three ok words',
    '1 2 3 4 5 6 7 8 9'
));

print_r( $jus->format(48) ); 
```

### 输出

```
Array
(
    [0] => hello      world       there       ok       then
    [1] =>                      hello                      
    [2] => ok                                          then
    [3] => two                                        words
    [4] => three                  ok                  words
    [5] => 1    2     3     4     5     6     7     8     9
) 
```

您可能会注意到我省略了 OP 的测试线之一。这是因为它是 54 个字符并且会超过`$desired_length`传递给`Justifier::format()`. 该函数将抛出一个`IllegalArgumentException`大于或等于最小宽度的非正数、非零数的宽度。最小宽度是通过查找具有单个间距的最长行（传递给构造函数的所有行中的）来计算的。

## 使用字符串数组对齐的流体宽度

如果省略宽度，`Justifier`将使用单行距时最长行的宽度（传递给构造函数的行）。这与在上一个演示中找到最小宽度的计算相同。（[键盘演示](http://codepad.viper-7.com/VnuXK9)）

```
$jus = new Justifier(array(
    'hello world there ok then',
    'hello',
    'ok then',
    'this string is almost certainly longer than 48 I think',
    'two words',
    'three ok words',
    '1 2 3 4 5 6 7 8 9'
));

print_r( $jus->format() ); 
```

### 输出

```
Array
(
    [0] => hello        world        there        ok         then
    [1] =>                         hello                         
    [2] => ok                                                then
    [3] => this string is almost certainly longer than 48 I think
    [4] => two                                              words
    [5] => three                     ok                     words
    [6] => 1     2     3     4      5      6      7      8      9
) 
```

## 对齐单个文本字符串（宽度 = 48）

我还在该类中包含了一项功能，该功能允许您将单个完整的字符串传递给构造函数。该字符串可以是任意长度。当您调用时`Justifier::format($desired_length)`，字符串被分成几行，这样每行都尽可能多地填充文本，并在开始新行之前对齐。该类会抱怨，`InvalidArgumentException`因为您必须提供一个宽度，它可以打破字符串。如果有人能想到一个合理的默认值或以编程方式确定字符串默认值的方法，我完全愿意接受建议。（[键盘演示](http://codepad.viper-7.com/HCS2AA)）

```
$jus = new Justifier(
    'hello world there ok then hello ok then this string is almost certainly longer than 48 I think two words three ok words 1 2 3 4 5 6 7 8 9'
);

print_r( $jus->format(48) ); 
```

### 输出

```
Array
(
    [0] => hello world there ok then  hello  ok  then  this
    [1] => string is almost  certainly  longer  than  48  I
    [2] => think two words three ok words 1 2 3 4 5 6 7 8 9
) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-06-15T22:44:01.807

这是我的尝试。

```
function justify($str_in, $desired_length)
{
    foreach ($str_in as &$line) {
        $words = explode(' ', $line);
        $word_count = count($words) - 1;
        $spaces_to_fill = $desired_length - strlen($line) + $word_count;
        if (count($words) == 1) {
            $line = str_repeat('_', ceil($spaces_to_fill/2)) . $line
                  . str_repeat('_', floor($spaces_to_fill/2));
            continue;
        }
        $next_space = floor($spaces_to_fill/$word_count);
        $leftover_space = $spaces_to_fill % $word_count;
        $line = array_shift($words);
        foreach($words as $word) {
            $extra_space = ($leftover_space) ? ceil($leftover_space / $word_count) : 0;
            $leftover_space -= $extra_space;
            $line .= str_repeat('_', $next_space + $extra_space) . $word;
        }
    }
    return $str_in;
} 
```

我尽量保持相对简洁，这影响了可读性。但它是这样工作的：

对于每个条目，我们将单词分成一个数组`$words`。因为我们可能需要单词前后的空格，所以我们还在数组的开头和结尾添加了一个空字符串。

我们计算剩余的空格数量`$leftover_space`（即我们需要在某处插入的空格），然后将其除以单词数`$word_count`，因此我们知道每个单词之间要放置多少空格的平均值。

每当我们添加一个单词时，我们也会添加几个空格`$extra_space`，具体取决于剩下多少个。之后，我们从`$leftover_space`.

### 样本输出

```
$data = justify($data, 48);
print_r($data);

Array
(
    [0] => 123456789012345678901234567890123456789012345678
    [1] => hello_______world_______there_______ok______then
    [2] => ______________________hello_____________________
    [3] => ok__________________________________________then
    [4] => this__string__is_almost_certainly_longer_than_48
    [5] => two________________________________________words
    [6] => three__________________ok__________________words
    [7] => 1_____2_____3_____4_____5_____6_____7_____8____9
) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-06-15T22:10:12.523

这是接近尾声的一些不同的实现。

```
<?php
function justify($str, $to_len) {
    $str = trim($str);
    $strlen = strlen($str);

    if($str == '') return '';

    if($strlen >= $to_len) {
        return substr($str, 0, $to_len);   
    }

    $words = explode(' ', $str);
    $word_count = count($words);
    $space_count = $word_count - 1;

    if($word_count == 1) {
        return str_pad($str, $to_len, ' ', STR_PAD_BOTH);
    }

    $space = $to_len - $strlen + $space_count;
    $per_space = floor($space/$space_count);
    $spaces = str_pad('', $per_space, ' ');
    $curr_word = implode($words, $spaces);
    while(strlen($curr_word) < $to_len){
    $curr_word = substr($curr_word,0,preg_match("[! ][".$spaces."][! ]",$curr_word))." ".preg_match("[! ][".$spaces."][! ]",$curr_word));
    }
    return $curr_word;

?> 
```

我不确定`regexp`，我只是说`$spaces`而不是下一个空格。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-06-16T23:11:13.760

这是我的解决方案。对于它的价值，我花了大约 20 分钟来为它做 justify 功能和验收测试；其中 5 分钟调试了 justify 函数。另外，我使用 notpad++ 而不是更强大的 IDE 来尝试在一定程度上模拟面试环境。

我认为这对于白板面试问题来说可能是一个太大的问题，除非面试官让你用伪代码编写并且对你的思维过程更感兴趣，而不是你在白板上的内容。

```
<?php

function justify($str_in, $desired_length) {
    $words = preg_split("/ +/",$str_in);
    // handle special cases
    if(count($words)==0) { return str_repeat(" ",$desired_length); }

    // turn single word case into a normal case
    if(count($words)==1) { $words = array("",$words[0],""); }

    $numwords = count($words);
    $wordlength = strlen(join("",$words));
    // handles cases where words are longer than the desired_length
    if($wordlength>($desired_length-$numwords)) { 
        return substr(join(" ",$words),0,$desired_length);
    }

    $minspace = floor(($desired_length-$wordlength)/($numwords-1));
    $extraspace = $desired_length - $wordlength - ($minspace * ($numwords-1));
    $result = $words[0];
    for($i=1;$i<$numwords;$i++) {
        if($extraspace>0) {
            $result.=" ";
            $extraspace--;
        }
        $result.=str_repeat(" ",$minspace);
        $result.=$words[$i];
    }
    return $result;
}

function acceptance_justify($orig_str, $just_str, $expected_length) {
    // should be the correct length
    if(strlen($just_str)!=$expected_length) { return false; }

    // should contain most of the words in the original string, in the right order
    if(preg_replace("/ +/","",substr($orig_str,0,$expected_length)) != preg_replace("/ +/","",substr($just_str,0,$expected_length))) { return false; }

    //spacing should be uniform (+/- 1 space)
    if(!preg_match("/( +)/",$just_str,$spaces)) { return false; }

    $space_length=strlen($spaces[0]);
    $smin=$space_length;
    $smax=$space_length;
    for($i=1;$i<count(@spaces);$i++) {
        $smin=min($smin,strlen($spaces));
        $smax=max($smax,strlen($spaces));
    }
    if(($smax-$smin)>1) { return false; }
    return true;
}

function run_test($str,$len) {
    print "<pre>";
    print "$str  ==> \n";
    $result = justify($str,$len);
    print preg_replace("/ /",".",$result) . "\n";
    print acceptance_justify($str,$result,$len)?"passed":"FAILED";
    print "\n\n</pre>";
}

run_test("hello world there ok then",48);
run_test("hello",48);
run_test("this string is almost certainly longer than 48 I think",48);
run_test("two words",48);
run_test("three ok words",48);
run_test("1 2 3 4 5 6 7 8 9",48); 
```

# ios - iOS - DrawRect 性能问题

> ID：11058489
> 
> 赞同：0
> 
> 时间：2012-06-15T21:33:13.987
> 
> 标签：ios, uitableview, core-graphics, drawrect, lag

我是`-drawRect`第一次尝试加速 UITableView。但是，该`drawRect`方法似乎在很大程度上减慢了桌子的速度。

请您告诉我如何改进以下`drawRect`方法以加快表格速度？

编辑 - -

在 drawRect 方法中，我将两个 NSStrings 写入单元格的视图，两个 UIImages 和一个阴影到两个 NSStrings 和一个 UIImages。

上述图像之一是异步下载的，然后`setNeedsDisplay`被调用以将该 UIImage 绘制到屏幕上。我相信这最初可能是滞后发生的原因。

```
- (void) drawRect:(CGRect) rect {

    CGContextRef context = UIGraphicsGetCurrentContext();

    [[UIColor clearColor] set];

    CGContextFillRect(context, rect);

    CGContextSaveGState(context);
    CGContextSetShadow(context, CGSizeMake(1,1),1);
    //draw text here

    if (shouldDrawImage == YES) {

        CGContextDrawImage(context, CGRectMake(10, 10, 40, 40), self.image.CGImage);

    }

    CGContextDrawImage(context, CGRectMake(self.frame.size.width - 16, 0, 16, self.frame.size.height), [UIImage imageNamed:@"right_bar_including_holes"].CGImage);

    NSString *authorName = [[self.info objectForKey:@"user"] objectForKey:@"full_name"];

    [RGB(219, 240, 73) set];

    CGSize maximumLabelSize = CGSizeMake(self.frame.size.width - 10 - 55 - 16,9999);
    CGSize authorsize = [authorName sizeWithFont:[UIFont boldSystemFontOfSize:15]
                                     constrainedToSize:maximumLabelSize 
                                         lineBreakMode:UILineBreakModeWordWrap]; 
    [authorName drawInRect:CGRectMake(60, 10, self.frame.size.width - 60, authorsize.height) withFont:[UIFont boldSystemFontOfSize:15]];

    [RGB(249,249,249) set];

    NSString *description = [self.info objectForKey:@"description"];
    CGSize descriptionSize = [description sizeWithFont:[UIFont systemFontOfSize:14] constrainedToSize:maximumLabelSize lineBreakMode:UILineBreakModeWordWrap];

    [description drawInRect:CGRectMake(60, authorsize.height + 15, descriptionSize.width, descriptionSize.height) withFont:[UIFont systemFontOfSize:14]];

    CGContextRestoreGState(context);

}

- (NSString *) reuseIdentifier {
    return NSStringFromClass([SlideCell class]);
}

- (void) updateCellInfo:(NSDictionary *)_info {
    [self setInfo:_info];

    UIImageView *iv = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 1, 1)];
    [iv setImageWithURLRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:[[self.info objectForKey:@"user"] objectForKey:@"avatar"]]] placeholderImage:nil success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *_image) {
        dispatch_async(dispatch_get_main_queue(), ^{
            shouldDrawImage = YES;
            self.image = [self roundedImage:_image];
            [iv release];
            [self setNeedsDisplay];
        });

    } failure:nil];

    [self setNeedsDisplay];

    [self setSelectionStyle:UITableViewCellSelectionStyleNone];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:41:55.283

是的 - 您在您的应用程序上运行 Instruments 的时间配置文件，以准确告诉您花费了多少时间以及*在哪里*花费了时间。它会告诉你它是图像、字符串、阴影还是其他东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T06:15:51.527

**您应该先分析该代码并查看图像是否是问题所在。**

我不确定 AFNetworking 库（您正在使用的）在异步下载图像时如何工作。

如果您知道图像是问题所在，我怀疑图像在设置时需要在 UIImageView 中重新缩放。这可能是问题所在。您需要将要设置为 UIImageView 的 UIImage 重新缩放为 UIIImageView 的框架，这样就不会触发自动重新缩放。滚动时成本很高。

您收到图像并立即将代码分派到主线程。潜在的重新调整可以“在幕后”工作。我会将该方法更改为：

```
UIImageView *iv = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, IMGSIZEX, IMGSIZEY)];
    [iv setImageWithURLRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:[[self.info objectForKey:@"user"] objectForKey:@"avatar"]]] placeholderImage:nil success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *_image) {
        //Note you have to implement rescaleToFitSize
        UIImage* rescaled = [_image rescaleToFitSize:iv.frame.size];
        dispatch_async(dispatch_get_main_queue(), ^{
            self.image = _image;
            [iv release];
            [self setNeedsDisplay];
        });

    } failure:^{
         //Handle failure! You create mem. leak on failure
         [iv release];
}]; 
```

作为旁注，您不会处理图像下载中的失败。你绝对应该。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T07:26:01.753

库存 UITableView 尽可能高效，只要您正确使用它： 1\. 回收单元格（出队） 2\. 尽可能避免透明度（alpha 混合确实会减慢速度） 3\. 重用单元格的配置不需要太多处理时间。

我认为没有人可以通过覆盖 drawRect 来显着改进 Apple 的代码......

# jqgrid - 缩小并连接 jqGrid 语言环境文件？

> ID：11058494
> 
> 赞同：1
> 
> 时间：2012-06-15T21:33:53.940
> 
> 标签：jqgrid, internationalization, locale, minify

有没有人成功地尝试缩小和连接所有 jqGrid 语言环境文件，以便它们可以在一个 HTTP 请求中加载并缓存在浏览器中？

单独缩小每个文件是一项简单的任务，但当前的 jqGrid i18n 模型需要`'../i18n/grid.locale-XX.min.js'`根据用户的语言环境动态加载正确的脚本文件（例如）。这是因为资源文件只是扩展了 $.jgrid 对象，甚至不知道它们自己的语言环境是什么。在下载中包含多个将简单地应用要加载和执行的最后一个。

我希望所有这些静态语言环境对象一次可用于客户端/浏览器，然后通过网格选项（或者可能通过 jqGrid 方法）以编程方式应用一个。这似乎是一种更常见的客户端本地化模式，例如 jQuery UI Datepicker、Globalize (fka jquery-global)、Moment.js 等。

那么有没有人成功地做到了这一点，或者这应该是对 jqGrid 项目的功能请求/贡献吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:44:27.023

如果您检查[我的旧功能请求](http://www.trirand.com/blog/?page_id=393/feature-request/small-changes-in-i18ngrid-locale-xx-js-files-to-make-possible-dynamic-language-switching/#p22314)，您会发现您需要的最多信息。[第一个](http://www.ok-soft-gmbh.com/jqGrid/Localization.htm)和[第二个](http://www.ok-soft-gmbh.com/jqGrid/Localization1.htm)演示使用 jqGrid 3.8.2。同样的想法也适用于当前的 jqGrid 版本。这将是更容易实现的事件。在第二个演示中，我使用了基于 Web 浏览器语言的额外动态语言选择。代码可能会有所改进，但总的来说我仍然喜欢这种方法。

# ruby-on-rails - 使用 shared_examples_for 的正确方法

> ID：11058502
> 
> 赞同：4
> 
> 时间：2012-06-15T21:34:46.817
> 
> 标签：ruby-on-rails, rspec

我可能对应该做什么有一个有缺陷的理解`shared_examples_for`，但请听我说。

基本上，我有一个常见的导航栏，出现在论坛的`index`页面和`new`页面中。所以我希望对导航栏的测试对`index`页面和`new`页面都执行。我希望下面使用的代码`shared_examples_for`可以实现这一点。但是发生的事情是，测试用例`shared_examples_for`根本没有运行。检查我在范围内创建了失败的测试用例`shared_examples_for`，但测试没有失败。

我究竟做错了什么？

```
require 'spec_helper'

describe "Forums" do

  subject { page }

  shared_examples_for "all forum pages" do

    describe "should have navigation header" do
      it { should have_selector('nav ul li a', text:'Home') }
      it { should have_selector('nav ul li a', text:'About') }
    end
  end

  describe "Index forum page" do
    before { visit root_path }
    ...
  end

  describe "New forum page" do
    before { visit new_forum_path }
    ...
  end

end 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-19T03:15:28.767

这是将这些东西绑定在一起的一种很好的意图揭示方式：

```
shared_examples_for 'a page with' do |elements|
  # the following two would be navs for a page with
  it { should have_selector 'h1', text: 'About' }
  it { should have_selector 'a', text: 'Songs' }
  # these would be dynamic depending on the page
  it { should have_selector('h1',    text: elements[:header]) }
  it { should have_selector('title', text: full_title(elements[:title])) }
end

describe "About" do
  it_behaves_like 'a page with', title: 'About', header: 'About Header' do
    before { visit about_path }
  end
end

describe "Songs" do 
  it_behaves_like 'a page with', title: 'Songs', header: 'Songs Header' do
    before { visit songs_path }
  end
end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-15T21:39:37.337

不确定您的问题到底是什么，但共享示例中的 describe 块有多大必要？那是我的第一次刺。

这段代码对我有用。

```
shared_examples_for 'all pages' do
  # the following two would be navs for all pages
  it { should have_selector 'h1', text: 'About' }
  it { should have_selector 'a', text: 'Songs' }
  # these would be dynamic depending on the page
  it { should have_selector('h1',    text: header) }
  it { should have_selector('title', text: full_title(title)) }
end

describe "About" do
  before { visit about_path }

  let(:title) {'About'}
  let(:header) {'About Site'}

  it_should_behave_like 'all pages'
end

describe "Songs" do 
  before { visit songs_path }

  let(:title) { 'Songs Title' }
  let(:header) { 'Songs' }

  it_should_behave_like 'all pages'
end 
```

# c# - Caliburn.micro 查看 ViewModel 名称解析问题

> ID：11058507
> 
> 赞同：2
> 
> 时间：2012-06-15T21:35:00.260
> 
> 标签：c#, mvvm, caliburn.micro

我正在使用我的 and 上调用的命名空间`ComShorCaliburnWPF.ViewModules.Views.ShortMenuWindows.GWDSCT`，`View.xaml`对于`View.cs`我`ViewModel.cs`正在使用的我和我的 IoC 容器`ComShorCaliburnWPF.ViewModules.Views.ShortMenuWindows.GWDSCT`。当我最后删除 GWDSCT 时，它可以正常工作，但在当前状态下却不行。我希望它能够像现在这样工作，因为它准确地反映了文件的位置。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T03:10:29.897

有助于调试这些问题的一件事是使用记录器：

```
 public class DebugLogger : ILog
    {
        private readonly Type _type;

        public DebugLogger(Type type)
        {
            _type = type;
        }

        public void Info(string format, params object[] args)
        {
            if (format.StartsWith("No bindable"))
                return;
            if (format.StartsWith("Action Convention Not Applied"))
                return;
            Debug.WriteLine("INFO: " + format, args);
        }

        public void Warn(string format, params object[] args)
        {
            Debug.WriteLine("WARN: " + format, args);
        }

        public void Error(Exception exception)
        {
            Debug.WriteLine("ERROR: {0}\n{1}", _type.Name, exception);
        }
    } 
```

然后在`AppBootstrapper`，配置方法。

```
LogManager.GetLog = type => new DebugLogger(type); 
```

# linux - 变量未按预期在函数中打印

> ID：11058509
> 
> 赞同：0
> 
> 时间：2012-06-15T21:35:03.923
> 
> 标签：linux, bash

我有这个：

我希望`f1()`我能够访问变量`$pid`。但是我的脚本不打印来自 function 的值`f1()`。你能解释一下吗？

```
#!/bin/sh

f1()
{
    echo in f1 pid is $pid
}

f2()
{
    sleep 1
    f1
}

f2 &

pid=$!

echo f2 bg pid is $pid 
```

输出

```
f2 bg pid is 15095
in f1 pid is 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:39:01.460

`pid`您在分叉到自己的进程后在父进程中进行分配`f2`，因此无法跨进程访问它。您可以将自己的进程 pid 访问为`$$`.

# google-apps-script - 关于使用 UiApp 和 google 电子表格进行数据格式化的问题

> ID：11058510
> 
> 赞同：0
> 
> 时间：2012-06-15T21:35:08.900
> 
> 标签：google-apps-script

提前感谢您提供的任何帮助。作为背景，我使用 GAS 构建了一个简单的 UiApp，我用它来填充谷歌电子表格和日历，其中包含有关时间、日期、位置等事件的条目。我已经让它工作了一段时间，但我想继续改进它和我有几个关于格式和功能的问题。

1.) 我现在希望脚本将信息复制到第二个电子表格中，我已经确定了如何执行此操作，但是第二个电子表格已经有一些列在使用中，我不想覆盖并且我不想要只需将此 Ui 中的信息放入第一个“X”列，是否有任何简单的方法可以“将这 5 列复制到第一列，然后跳过列并引入其余列”。这是我现在用于复制操作的代码：

```
var ss = SpreadsheetApp.openById(ssID);
var sheet = ss.getSheets()[0];
sheet.getRange(sheet.getLastRow()+1, 1, 1, 20).setValues([[new Date(), eventTitle, eventDateFrom, eventStartTimeb, eventEndTimeb, eventLocationName, eventLocationCity,eventActivity, eventLeadContact, eventNSLContact, eventContactAttending, eventDepartment, eventStaff, eventMaterials, eventCost, eventIncentive, eventMSTarget, eventSolar, eventNotes,eventRegion]]); 
```

另外，与这个问题一样，我一直想知道是否有可能编写一些东西，当条目被复制到第二个电子表格时，会根据其中一个元素的值进行选择。例如，如果 eventStaff=0 或为空，脚本会将指定的信息复制到第一个电子表格而不是第二个。

2.) 日期格式：我添加了两个列表框来捕获事件时间开始和事件时间结束，我希望它们显示在格式为 00:00 AM/PM 的电子表格中，但只完成了 00:00： 00 或到目前为止的整数。

3.) 使用多个元素来填充日历条目的位置和事件部分。该脚本用于创建具有开始/结束时间和标题的基本事件，但我想使用一些信息来填写事件的位置和描述。有没有办法让我做到这一点，或者我是否需要将这些字段连接成一个以便能够在事件创建中输入它们。当前事件创建代码：

```
 cal.createEvent(eventTitle,eventDateFrom,eventDateTo); 
```

对不起，文字墙，如果需要任何澄清/附加代码示例，请询问。提前感谢您提供的任何帮助/见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:20:03.627

请不要生气，但恐怕您的问题是比 GAS 问题更一般的编程问题，通过制定您几乎自己回答的问题（问题 1）。至于问题 2，看看[Utilities.formatDate](https://developers.google.com/apps-script/class_utilities?hl=fr-FR#formatDate)你会得到你想要的，也可以看看[这个](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)。问题 3：请参阅[CalendarApp 文档， createEvent](https://developers.google.com/apps-script/class_calendarapp?hl=fr-FR#createEvent)，有一组适合您需要的可选参数。- 此致，

# c# - windows phone 上的推送通知可以免费实现吗？

> ID：11058518
> 
> 赞同：2
> 
> 时间：2012-06-15T21:36:04.560
> 
> 标签：c#, windows-phone, push-notification

我想知道我是否需要支付云服务才能使推送通知正常工作，或者微软是否免费提供？我被要求使用这个 windows phone 功能制作一个应用程序，并假设它是一个免费的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:43:59.820

简短的回答：你需要支付一个。

您需要用户手机可以向其发送请求的 Web 服务（WCF 很好地工作），而该服务又向 Microsoft 发出单独的请求。

设置完成后，将传递一个身份验证令牌，让您的 Web 服务被授权向该特定电话发送消息（通过发送给 Microsoft 的请求）。

嗯，Web 服务需要托管在某个地方（并且它需要提供手机可以使用的 SSL (https) 连接）。这通常要花钱（取决于主机，每月大约 5-20 美元）

# ios - 按下后按钮变为白色。(iOS) 刷新后恢复正常

> ID：11058524
> 
> 赞同：3
> 
> 时间：2012-06-15T21:36:34.720
> 
> 标签：ios, xcode

使用 Xcode 4.3.3

在App中按下按钮拨出后，切换到电话拨出。返回应用程序后，拨出按钮变白，刷新后恢复正常。

当为电子邮件或文本按下另一个按钮时，也会发生同样的事情。似乎只有在离开当前应用程序以在其之外执行某些操作时才会发生这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T08:24:20.100

怎么用

```
button.selected = NO 
```

如果您仍然不满意，您可能希望将其添加到

```
- (void)applicationWillResignActive:(UIApplication *)application 
```

在应用程序委托中

创建一个指向按钮的指针

```
@property (nonatomic, assign) IBOutlet UIButton * button 
```

在 .m 中添加

```
@synthersize button; 
```

然后在界面生成器中，您需要通过按住控件并从 ViewContrtoller 图标拖动来将 IBOutlet 与按钮链接起来

# php - 在css中自动移动图像的简单方法

> ID：11058525
> 
> 赞同：0
> 
> 时间：2012-06-15T21:36:36.997
> 
> 标签：php, html, css

我的目标是拍摄一张图片（大小不一）并将其放入一组容器（330x330 像素）中。我不想调整图像大小。我只想让css自动移动以使图片像用330x330裁剪一样。

如果我放入一张小于 330x330 的图片，那么我认为它必须按比例放大。例如，如果它是 200x800，那么它会将其拉伸，然后垂直移动图像以显示中心？

如果没有很多烦人的PHP，这是可能的还是我试图做的事情是不可能的？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:58:22.937

您可以使用：

```
​div {
  width: 330px;
  height: 330px;
  background: url("http://placekitten.com/800/200") 50% 50% no-repeat;   
  background-size: cover;
}​ 
```

它应该适用于：IE9+、Firefox 4+、Opera、Chrome 和 Safari 5+。

# facebook-fql - 从个人资料图片中获取照片的 FQL 突然停止工作

> ID：11058527
> 
> 赞同：5
> 
> 时间：2012-06-15T21:36:40.183
> 
> 标签：facebook-fql

我的应用程序曾经使用此 FQL 从朋友的个人资料图片中获取列表照片：

```
SELECT owner, src_big FROM photo 
WHERE aid IN (
SELECT aid FROM album 
WHERE name="Profile Pictures" 
AND owner IN (XXXXXX,YYYYYYY,ZZZZZZZZ)) 
```

但现在得到的回应只有 ZZZZZ 的几张照片（最后一张）。甚至不是所有的都被退回。如果我尝试删除列表中的 YYYY,ZZZZ，它可以正常工作，即使我使用 IN 运算符，它也会返回该朋友的所有个人资料图片。

我错过了什么吗？我的另一个开发朋友也尝试过，但没有成功。

各位大佬能不能在explorer里试试？：） 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:36:28.353

我推出了一个应用程序，它在病毒式传播，在几个小时内吸引了 4 万用户。首先，它开始不随机提供个人资料照片。然后它从来没有奏效。

我尝试调试，发现了错误，`403`当我尝试访问图片时我得到了。

我认为这是 FB 有意为之，或者以他们的“垃圾邮件检测”算法会做出反应的方式工作。因为每次它发生在我身上，我很快就有了“应用程序限制”。

作为修复，我会说检查您的代码是否正常并且没有对 Facebook 进行未经授权的调用。您可能不会从用户端看到任何错误，但请检查`error_log`以查看是否有问题。并确保您遵守 FB 政策。

我的回答可能看起来含糊不清，但经验不足。如果它是一个错误，而不是一个`spam prevention feature`，那么我很抱歉:)

# python - cgi.FieldStorage 类如何处理文件上传？

> ID：11058528
> 
> 赞同：2
> 
> 时间：2012-06-15T21:36:43.880
> 
> 标签：python, file-upload

整个问题几乎都在标题中。

我可以在该类上找到的唯一文档是**非常**节省的[cgi 文档](http://docs.python.org/library/cgi.html?highlight=cgi#using-the-cgi-module)，它至少没有提到该类如何接收文件、它是如何存储的、它支持什么功能等。

我对上传文件的存储位置非常感兴趣。显然它不在内存中，因为[Bottle](http://bottlepy.org/docs/0.10/tutorial.html?highlight=file%20upload#post-form-data-and-file-uploads)提到该`FileStorage.read()`功能对大文件很危险。如果它放在磁盘上，我想将它移动到一个永久位置，而不必在 Python 中通读它，将它一点一点地复制到一个新位置。

但是由于课程的文档很差，我不知道从哪里开始。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-28T16:17:10.953

有点晚了，但我自己调查了一下：

这一切都归结为 cgi.py 中的“make_file”方法：

```
def make_file(self, binary=None):
    import tempfile
    return tempfile.TemporaryFile("w+b") 
```

tempfile 文档 ( [http://docs.python.org/2/library/tempfile.html](http://docs.python.org/2/library/tempfile.html) ) 表明该文件是在从与平台相关的列表中选择的默认目录中创建的，但用户可以通过以下方式控制目录位置设置环境变量之一：TMPDIR、TEMP 或 TMP。

另请注意文档：

> 在 Unix 下，文件的目录条目在文件创建后立即被删除。其他平台不支持；您的代码不应依赖于使用此函数创建的临时文件，该文件在文件系统中具有或不具有可见名称。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-15T19:04:08.880

我希望这会有所帮助：

[http://epydoc.sourceforge.net/stdlib/cgi.FieldStorage-class.html](http://epydoc.sourceforge.net/stdlib/cgi.FieldStorage-class.html)

`cgi.FieldStorage()`有

*   一个“文件名”，
*   一个“值”——文件本身，
*   一个“文件”和
*   一种”

还有别的……你可以在文档中阅读。

这是我的代码：

```
f_sd=open(tempfilesd,'r+b')
newdata_sd = cgi.FieldStorage()
newdata_sd.filename='sdfile.jpg'
newdata_sd.name='file'
newdata_sd.file=f_sd
form.vars.file = newdata_sd 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-10T11:03:21.927

该`FieldStorage.file`属性实际上不是文件而是`cStringIO`对象，在文档上描述为*内存文件*： http: [//docs.python.org/library/stringio.html](http://docs.python.org/library/stringio.html)

也许这可以帮助你一点。

# python - 弹出一个包含需要对所有输出说是的命令

> ID：11058529
> 
> 赞同：2
> 
> 时间：2012-06-15T21:36:44.850
> 
> 标签：python, subprocess, pipe, popen

我需要自动化以下命令

```
cmd="yes | vgremove <vgname>" 
```

每当我用

```
Popen(cmd.split(),stdout=PIPE,stderr=PIPE) 
```

它没有完成。我怀疑它会等到命令完成，所以管道被敲击了，有没有替代方法？？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T21:40:52.180

在这种情况下，有一个更简单的方法：

```
Popen('vgremove -f <vgname>') 
```

具体到你的问题：

```
p = Popen(cmd.split(), stdout=PIPE, stderr=PIPE, stdin=PIPE)
p.stdin.write('yes') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T21:49:16.793

管道是外壳功能，因此您需要`shell=True`它。您正在做的事情`shell=True`是使用参数执行`yes`。`yes`永远不会停止执行，因此子进程永远不会返回。

# javascript - 如果某些内容在 HTML 源代码中，脚本重定向到另一个页面？

> ID：11058531
> 
> 赞同：-1
> 
> 时间：2012-06-15T21:36:56.610
> 
> 标签：javascript, redirect, greasemonkey

如果特定的 HTML 源代码匹配，我正在寻找一种创建自动转发器（网络浏览器用户脚本）的方法。

`<span class="redux">$STRING</span>`应搜索代码，如果找到此跨度类并且该`$STRING`部分与某个值匹配，则必须发送重定向。

不幸的是，我非常不擅长基于 Web 的脚本，这就是我在这里问的原因。

我正在寻找的一个确切的 HTML 片段是`<span class="tit">mash</span>`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:57:09.887

使用 jQuery 选择类：

```
if($(".YourClass").length() > 0) {
    window.location = "redirectURL.com";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:06:44.937

问题含糊不清，但这是找到特定内容时重定向的一般方法。[它使用了jQuery](http://jquery.com/)的强大功能：

```
// ==UserScript==
// @name     _Redirect on specfic contents
// @include  http://YOUR_SERVER.COM/YOUR_PATH/*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// ==/UserScript==

var redirectURL = "http://xkcd.com/870/";
var triggerStr  = "Buy more beer!";     // Regex allowed.

/*--- Extend jQuery with a case-insensitive version of contains().
    Also allows regular expressions.
*/
jQuery.extend (
    jQuery.expr[':'].containsCI = function (a, i, m) {
        //--- The next is faster than jQuery(a).text()...
        var sText   = (a.textContent || a.innerText || "");     
        var zRegExp = new RegExp (m[3], 'i');

        return zRegExp.test (sText);
    }
);

//--- The following selector depends mightily on exact page details!
var targetTextNode  = $('div span.redux:containsCI(' + triggerStr + ')');
if (targetTextNode.length) {
    document.location   = redirectURL;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:13:32.380

其他答案支持 jQuery，这不是坏事。如果出于任何原因您想在本地执行此操作，这里有两种方法（一种如果您需要支持旧版浏览器，另一种使用较新的 JS）。

**方法 1（适用于旧版浏览器）**

```
window.onload = function() {

    var spans = document.getElementsByTagName('span');

    for (var i=0, len=spans.length; i<len; i++) {
        if (/\bsome_class\b/.test(spans[i].className) && spans[i].innerHTML == look_for_value) {
            location.replace('some/redirect.php');
        break;
        }
    }

}; 
```

**方法 2（较新的浏览器）**

```
document.addEventListener('DOMContentLoaded', function() {
    Array.prototype.forEach.call(document.body.querySelectorAll('.some_class'), function(el) {
        if (el.innerHTML == 'some value') {
            location.replace('some/redirect.php');
            return;
        }
    });
}, false); 
```

后者的一个优点是它使用了较新的 DOMContentLoaded 事件，这在这种情况下更可取（而 onload 在触发之前等待图像和其他资产加载）。

[编辑 - 正如 Brock 指出的那样，`location.replace()`覆盖当前页面的历史记录条目。通过一些重定向（大多数？），这就是您想要的，但不一定。如果没有，请`location.href = ...`改用。]

# php - 3 表连接查询

> ID：11058534
> 
> 赞同：0
> 
> 时间：2012-06-15T21:37:16.857
> 
> 标签：php, codeigniter

我很想知道使用 codeigniter 的活动记录查询集查询此信息的最佳方法是什么。

我有 3 张桌子：

```
Table 1: "Titles"
         Fields: id, title_name

Table 2: "Roster"
         Fields: id, roster_name

Table 3: "Champions"
         Fields: id, title_id, champion_id, 
                 contender1_id, contender2_id, contender3_id 
```

我以前尝试过这样做，但由于出现问题，它似乎没有正确完成。关于如何呈现查询的任何想法？

任何人的任何想法？

# mysql - mysql 复制只插入

> ID：11058537
> 
> 赞同：1
> 
> 时间：2012-06-15T21:37:22.570
> 
> 标签：mysql

我有几个从同一个主数据库复制的从数据库，但是，对于其中一个从数据库，我想将其保留为备份数据库，它永远不会更新或删除行。

基本上目的是拥有一个备份数据库，通过使用复制存储所有行（mysqldump 进行备份的速度很慢），没有更新/删除查询被复制，仅插入查询。我知道毫无疑问会发生一些冲突，但仍然想知道从端的语句/查询是否有任何过滤选项或任何其他解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T09:34:24.407

您**永远不**应该在没有有效备份方案的情况下运行生产数据库 - 至少只要您重视数据。如果你担心一个错误的 sql 指令会毁掉你的数据库，那么你可以试试*point in time recovery*。

如果您已经使用复制，您的主服务器会将所有写入/更新操作记录到其 binlog 中 - 它将发送到从属服务器进行复制。例如，您可以对完整数据库进行夜间备份。如果您在早上销毁数据库，则可以从晚上导入备份，然后从备份之后到杀死数据库的指令之前重新应用 binlog 中的指令。

然后，您可以跳过此说明并应用随后的说明。这也可能导致一致性问题，因为跳过指令之后的指令在数据库中看到的数据与它们最初执行时不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T22:41:47.950

我有类似的问题。我知道这是旧线程，但它可以帮助其他人：

链接：[只有当我通过 USE 数据库选择数据库时，mysql 复制才有效](https://stackoverflow.com/questions/19989768/mysql-replication-works-only-if-i-choose-database-by-use-database)

# google-closure-library - 如何禁用 goog.ui.Dialog 中的关闭按钮？

> ID：11058538
> 
> 赞同：2
> 
> 时间：2012-06-15T21:37:25.173
> 
> 标签：google-closure-library

我想去掉 Google Closure 对话框右上角的关闭/X 按钮。

我正在浏览文档（[http://closure-library.googlecode.com/svn-history/r8/trunk/closure/goog/docs/class_goog_ui_Dialog.html](http://closure-library.googlecode.com/svn-history/r8/trunk/closure/goog/docs/class_goog_ui_Dialog.html)）并且找不到这样做的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-21T22:20:51.277

方法来了！请参阅[http://closure-library.googlecode.com/svn/docs/class_goog_ui_Dialog.html](http://closure-library.googlecode.com/svn/docs/class_goog_ui_Dialog.html)

```
dialog.setHasTitleCloseButton(false); 
```

问候，

雷内

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T06:55:12.577

标题[`goog.ui.Dialog`](http://closure-library.googlecode.com/svn-history/r8/trunk/closure/goog/docs/class_goog_ui_Dialog.html)栏关闭按钮可以通过先调用[`goog.ui.Dialog.prototype.getTitleCloseElement()`](http://closure-library.googlecode.com/svn-history/r8/trunk/closure/goog/docs/closure_goog_ui_dialog.js.source.html#line337)然后再调用来禁用[`goog.style.showElement(el, display)`](http://closure-library.googlecode.com/svn/docs/closure_goog_style_style.js.source.html#line1059)。

**例子**

```
var dialog = new goog.ui.Dialog();
dialog.setContent('Lorem ipsum dolor sit amet, consectetuer' +
    'adipiscing elit. Aenean sollicitudin ultrices urna. Proin vehicula ' +
    'mauris ac est. Ut scelerisque, risus ut facilisis dictum, est massa ' +
    'lacinia lorem, in fermentum purus ligula quis nunc. Duis porttitor ' +
    'euismod risus. Nam hendrerit lacus vehicula augue. Duis ante.');
dialog.setTitle('Lorem ipsum');
dialog.setButtonSet(goog.ui.Dialog.ButtonSet.createYesNo());

var titleCloseEl = dialog.getTitleCloseElement();
goog.style.showElement(titleCloseEl, false); 
```

# jquery - Firefox 3.6 未加载 Jquery UI 选项卡

> ID：11058540
> 
> 赞同：1
> 
> 时间：2012-06-15T21:37:28.993
> 
> 标签：jquery, jquery-ui, jquery-ui-tabs, firefox3.6

我的 jquery UI 标签目前仅在 Firefox 3.6.24 中存在问题，其中第一个标签不会被加载。这让我发疯，因为 xhr 说它有 html 数据。

jQuery v1.4.4 jQuery v1.8.18

想知道是否有一些已知问题和任何修复

```
 $(function() {
            $("#tabs").tabs({
                'cookie': {
                        'expires': 1
                    },
                'ajaxOptions': {
                    'error': function( xhr, status, index, anchor ) {
                        $( anchor.hash ).html(
                            "Couldn't load this tab. We'll try to fix this as soon as possible.");
                    }
                },
                'spinner':"Loading..."
            });
        }); 
```

=====HTML=====

```
 <div id="tabs">
        <ul class="nav nav-tabs">
            <li><a href="/url/1">First tab</a></li>
            <li><a href="/url/2">Second tab</a></li>
            <li><a href="/url/3">Third tab</a></li>
            <li><a href="/url/4">Fourth tab</a></li>
        </ul>
     </div> 
```

[http://jsfiddle.net/Un2q4/1/](http://jsfiddle.net/Un2q4/1/)

=====更新=======

问题出在 HTML 中，表单元素在表格内打开，而表单关闭标记位于关闭表格标记之外。经验教训总是验证您的 HTML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T16:14:06.313

您需要包含[jQuery cookie 插件](http://jsfiddle.net/skram/Un2q4/5/)。请参阅以下来自 jQuery UI 站点的注释。

> cookie 选项需要 cookie 插件，该插件可以在下载构建器的 development-bundle > external 文件夹中找到。

您可以在 github -> [https://raw.github.com/carhartl/jquery-cookie/master/jquery.cookie.js中找到它](https://raw.github.com/carhartl/jquery-cookie/master/jquery.cookie.js)

**固定小提琴：http:** [//jsfiddle.net/skram/Un2q4/5/](http://jsfiddle.net/skram/Un2q4/5/)

**没有 cookie 选项和 cookie 插件：http:** [//jsfiddle.net/skram/Un2q4/6/](http://jsfiddle.net/skram/Un2q4/6/)

# web-services - jaxws-maven-plugin wsgen IllegalAnnotationExceptions

> ID：11058541
> 
> 赞同：1
> 
> 时间：2012-06-15T21:37:29.870
> 
> 标签：web-services, maven, jax-ws, wsgen

我正在使用 clientgen 从第三方 WSDL 生成客户端类。然后我使用 wsgen 创建我的 Web 服务，捆绑我的类以及生成的类。

jaxws-maven-plugin wsgen 抛出`JAXBContext IllegalAnnotationsException`抱怨生成的类没有无参数默认构造函数。

我在这个网站上看到的一个解决方案是将类包装在`XMLWrappers`. 问题是第三方类在我无法控制的第三方方法中使用。

有解决方案或解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:39:40.183

一种可能的解决方法是使用[axis2 maven wsdl2code](http://axis.apache.org/axis2/java/core/tools/maven-plugins/maven-wsdl2code-plugin.html)生成器。

然而，这将生成一个完全不同的客户端（尽管仍然易于使用）。

该文档还告诉添加以下依赖项：

```
<dependency>
      <groupId>org.apache.axis2</groupId>
      <artifactId>axis2</artifactId>
      <version>1.4</version>
</dependency> 
```

# css - 您如何使菜单随页面滚动，但留下徽标

> ID：11058542
> 
> 赞同：2
> 
> 时间：2012-06-15T21:37:44.393
> 
> 标签：css, logging, scroll, move

我不想做[这个](http://totalfratmove.com)网站，我可以上下滚动，我的菜单和我一起，但标志仍然在顶部。他们是怎么做到的？我尝试了一些 CSS，但无法让徽标留在他的位置。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-15T21:42:24.940

它被称为持久标头，在这里解释太长了，因此您可以使用本教程：[http ://css-tricks.com/persistent-headers/](http://css-tricks.com/persistent-headers/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T08:28:52.747

您可以从 position:fixed 开始并定义顶部和左侧属性或底部和左侧属性。

这个网站也可以帮助你：[CSS Sticky Footer](http://www.cssstickyfooter.com/)

# javascript - Flash 对象中的单击事件处理程序可以对 JavaScript 从另一个 DOM 元素委托的单击事件作出反应吗？

> ID：11058544
> 
> 赞同：1
> 
> 时间：2012-06-15T21:38:07.077
> 
> 标签：javascript, flash, events, canvas, dispatchevent

我有一个`canvas`元素绝对定位在相同尺寸的 Flash 对象上。我希望能够单击该`canvas`元素并将该事件（或者更准确地说，该事件的模仿）发送到下面的 Flash 对象。

我向 Flash 对象添加了一个事件侦听器，因此我知道该事件已成功分派给 Flash 对象。问题是 Flash 对象根本不会对其做出反应（例如，单击巨大的“播放”按钮区域不会播放视频）。

Flash 对象可以以这种方式对事件做出反应吗？DOM 中的 Flash 是否有什么特别之处，需要 JavaScript 事件委托以外的其他东西来激活来自它的响应？

```
<!DOCTYPE html>
<html lang="zh">
    <头部>
        <meta charset="utf-8"/>
        <title>将来自 DOM 元素的点击事件委托给底层 Flash 对象</title>
    </head>
    <正文>
        <object type="application/x-shockwave-flash" name="StrobeMediaPlayback" data="assets/StrobeMediaPlayback.swf" width="640" height="480" id="StrobeMediaPlayback" style="visibility: visible; position ：绝对；顶部：0；左侧：0；">
            <param name="allowFullScreen" value="true">
            <param name="wmode" value="透明">
            <param name="flashvars" value="src=http://mediapm.edgesuite.net/strobe/content/test/AFaerysTale_sylviaApostol_640_500_short.flv&autoPlay=false&verbose=true&controlBarAutoHide=false&controlBarPosition=bottom&poster=assets/images/StrobeMediaPlayback.png">
        </对象>
        <script type="text/javascript">
            var smp = document.getElementById('StrobeMediaPlayback');
            smp.addEventListener('click', function (e) { console.log('CLICK'); }, false);
            添加画布（）；

            函数 addCanvas() {
                canvas = document.createElement('canvas');
                画布.宽度 = 640;
                画布.高度 = 480;
                canvas.style.position = '绝对';
                canvas.style.top = '0px';
                canvas.style.left = '0px';
                canvas.addEventListener('click', function (e) { evt(smp, e); }, false);
                ctx = canvas.getContext('2d');
                document.body.appendChild(canvas);
            }

            函数 evt(el, e) {
                var event = document.createEvent('HTMLEvents');
                event.initEvent(e.type, true, true);
                for (var key in e) {
                    事件[键] = e[键]；
                }
                el.dispatchEvent(事件);
            }
        </脚本>
    </正文>
</html>

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:44:41.753

使用[ExternalInterface](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html)在 SWF 和 DOM 之间进行通信。

您可以在 SWF 中创建一个函数，然后使用以下方法从 JS 调用该 ActionScript 函数：

```
ExternalInterface.call( functionInsideYourSWF ) 
```

在您的情况下，当有人单击您的画布元素时，您将调用您的 ActionScript 函数，然后使用您在 ActionScript 函数中定义的任何内容在内部使用 Flash 处理该单击事件，例如播放视频。

# cmd - CMD 返回 ErrorLevel 不运行程序

> ID：11058546
> 
> 赞同：0
> 
> 时间：2012-06-15T21:38:29.977
> 
> 标签：cmd, errorlevel, nul

我正在通过 CMD 提示符运行 Powershell 命令，我想在开始运行命令之前检查是否先安装了 Powershell。如果 powershell 不存在而不显示下面的实际错误，我希望脚本退出。这是我的脚本：

```
@echo off
setlocal enabledelayedexpansion
:: Check to see if Powershell is installed
powershell.exe -command {"test"} > NUL
if errorlevel 1 (
    echo/Powershell is NOT Installed
    EXIT
) else (
    goto PSI
)

:PSI
powershell Set-ExecutionPolicy RemoteSigned 
```

我遇到的问题是我将其作为输出：

```
Powershell is NOT Installed

'powershell.exe' is not recognized as an internal or external command,
operable program or batch file. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:43:13.673

弄清楚了！我不得不使用 2>NUL 而不是 NUL 来重定向输出：

```
:: Check to See if Powershell is Installed
powershell.exe test 2>NUL
    if errorlevel 1 (
        echo/Powershell is NOT Installed
    EXIT
    ) else (
    goto PSI
    ) 
```

# sql - SQL 涉及以逗号分隔的字符串和比较的列

> ID：11058556
> 
> 赞同：0
> 
> 时间：2012-06-15T21:40:09.667
> 
> 标签：sql, sql-server, tsql

**我正在更新要求..基本上一个字符串可以有 2 位或 3 位或 4 位小数位而不是两位小数位，如下所示。**

假设我在列名“版本”中有一条以逗号分隔的字符串的记录

假设我们有一条记录 (A)，在其“版本”列中包含这些值

Version=10.1.2.4, 10.4.3.4,11.6.0, （该列有逗号分隔的字符串）

我正在传递一个名为 @VersionCheck 的 sql 参数

IF @VersionCheck = 11.6.0 并且 Version 没有像 11.5.6 这样的任何值（注意 11 与 11.6.0 中的 11 匹配）

我要退回记录

所以这里有一些例子都与参数 @VersionCheck= 11.6.0 进行比较

Version=10.1.2,10.4.3.45 返回这条记录

Version=10.1.2,10.4.3,10.4.4.5,11.6.0 返回这条记录（如果我们有一个匹配 11.6.0 并且没有以 11 开头的字符串。不等于 11.6.0 的东西（参数传递）我们返回这个记录）

Version= 10.1.2,10.4.3,11.6.0.2 不返回这条记录（要检查，取第一个小数点之前的字符串，在这种情况下是11，但是11.6.0.2和11.6.0不一样所以它不应该匹配）

如何编写 sql 查询以在 where 子句中包含此逻辑？如果传递的参数是@VersionCheck = 10.6.8，我不希望它匹配如果逗号分隔列中的字符串说 10.5.4 基本上取第一个小数点之前的字符并且它们相等（10 = 10），它的其余值必须相同，否则它不应该匹配。

这是我在 sql server 2008 语法中的解决方案

请注意，@SU_Version 是我的参数

并且 SuVersion.fieldValue 是具有逗号分隔字符串值的列，例如 10.1.2,10.3.4 等

```
WHERE (CASE WHEN '%@SU_Version%' <> '' AND suVersion.fieldValue LIKE LTRIM('@SU_Version')
                THEN suVersion.fieldValue
                ELSE '%'
             END like CASE WHEN '%@SU_Version%' <> '' 
                THEN '%@SU_Version%' 
                ELSE '%'

        END

        AND

        (CASE WHEN LTRIM('@SU_Version') <> '' AND suVersion.fieldValue  LIKE SUBSTRING(LTRIM('@SU_Version'),1, CHARINDEX( '.',LTRIM('@SU_Version'))-1) 
                THEN suVersion.fieldValue
                ELSE'%'
             END not like CASE WHEN LTRIM('@SU_Version')<> ''
                THEN  SUBSTRING(LTRIM('@SU_Version'),1, CHARINDEX( '.',LTRIM('@SU_Version'))-1) + '%'
                ELSE '%'

        END
        AND 

        CASE WHEN LTRIM('@SU_Version') <> '' AND suVersion.fieldValue  LIKE SUBSTRING(LTRIM('@SU_Version'),1, CHARINDEX( '.',LTRIM('@SU_Version'))-1) 
                THEN suVersion.fieldValue
                ELSE'%'
             END not like CASE WHEN LTRIM('@SU_Version')<> ''
                THEN  SUBSTRING(LTRIM('@SU_Version'),1, CHARINDEX( '.',LTRIM('@SU_Version'))-1) + '%'
                ELSE '%'

        END)
      ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:52:27.857

由于您的设计基本上阻止了任何在 Version 列上使用索引的尝试，这将为您提供完全匹配的行

```
...
WHERE ',' + Version + ',' LIKE '%,' + @VersionCheck + ',%' 
```

对于你有时髦的要求，试试这个（假设所有版本字符串都包含两个小数位）：

```
DECLARE @v TABLE(Version VARCHAR(MAX));

INSERT @v SELECT ('10.1.2,10.4.3')
UNION ALL SELECT ('10.1.2,10.4.3,11.6.0')
UNION ALL SELECT ('10.1.2,10.4.3,11.5.2');

DECLARE @SU_Version VARCHAR(32);
SET @SU_Version = '11.6.0';

DECLARE 
  @p1 VARCHAR(10),
  @p2 VARCHAR(10);

SELECT
  @p1 = PARSENAME(@SU_Version, 3),
  @p2 = PARSENAME(@SU_Version, 2);

SELECT Version = SUBSTRING(Version, 2, LEN(Version)-2) FROM 
(
  SELECT Version = ',' + Version + ',' FROM @v
) AS v WHERE 
(
  Version LIKE '%,' + @SU_Version + ',%' 
  OR
  Version NOT LIKE '%,' + @p1 + '.%,%'
  AND NOT
  (
    Version LIKE '%,' + @p1 + '.%,%'
    AND
    Version NOT LIKE '%,' + @p1 + '.' + @p2 + '.%,%'
  )
); 
```

# javascript - Javascript（如果不在字典中）（node.js）

> ID：11058559
> 
> 赞同：0
> 
> 时间：2012-06-15T21:40:36.960
> 
> 标签：javascript, node.js, logic, express

这是代码：

```
exports.index_post = function(req, res) {
  var nicks = [];
  if (req.body.nick) {
    for (var nick in nicks) {
      if (nick == req.body.nick) {
        res.redirect("/");
      } else {
        nicks.push(req.body.nick)
        req.session.nick = req.body.nick;
        res.redirect("/msg");
        console.log(nicks);
      }
    }
  } else {
    res.redirect("/");
  }
}; 
```

它的意思是检查 req.body.nick 是否是 nicks 字典中的项目之一，如果是则将其重定向回根。如果它不在字典中，则应将其添加到字典中并将其设置为会话变量，然后重定向到 /msg。但是，此代码似乎对我不起作用，而是导致 Express 挂起。有人可以告诉我我做错了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:46:35.057

`nicks`首先，每次运行函数时都会创建一个新数组；听起来您希望它在服务器的整个生命周期中持续存在，每个请求都可能添加到`nicks`数组中。此外，尽管您正在遍历数组寻找`req.body.nick`，`if/else`语句在循环内的写入方式，它*总是*会在循环的第一次迭代时重定向。尝试这样的事情：

```
var nicks = []; // don't reset `nicks` every call

exports.index_post = function(req, res) {
  if (req.body.nick) {
    if (nicks.indexOf(req.body.nick) != -1) { // better checking for nick in nicks
      res.redirect("/");
    } else {
      nicks.push(req.body.nick)
      req.session.nick = req.body.nick;
      res.redirect("/msg");
      console.log(nicks);
    }
  } else {
    res.redirect("/");
  }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:46:53.230

1.  你`nicks`的是空的

    所以你的 for 循环不会做任何事情

    你甚至没有机会往里面塞任何东西

2.  对于每个请求，您都会有一个新`nicks`的，它不是全局的

# .net - 在 TPL 中，如何覆盖执行上下文？

> ID：11058567
> 
> 赞同：2
> 
> 时间：2012-06-15T21:41:12.913
> 
> 标签：.net, task-parallel-library, executioncontext

创建新任务对象时如何覆盖执行上下文？我想使用我之前使用 ExecutionContext.Capture 捕获的一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T22:12:15.877

与不使用 TPL 时相同：使用[`ExecutionContext.Run()`](http://msdn.microsoft.com/en-us/library/system.threading.executioncontext.run.aspx). 例如：

```
Task.Factory.StartNew(
    () => ExecutionContext.Run(
        ec, _ => Console.WriteLine(CallContext.LogicalGetData("foo")), null)) 
```

# ios - NSTimer timerWithTimeInterval：不工作

> ID：11058571
> 
> 赞同：31
> 
> 时间：2012-06-15T21:41:43.880
> 
> 标签：ios, timer, nstimer

在我的项目中实现它之前，我已经创建了一个带有计时器的测试应用程序。这是我第一次使用计时器。但问题是当我使用 实现计时器时`[NSTimer timerWithTimeInterval: target: selector: userInfo: repeats: ];`，它不起作用。这是我的代码，接口：

```
@interface uialertViewController : UIViewController
{

    NSTimer *timer;
}

-(void)displayAlert;
-(void)hideandview;
@end 
```

执行：

```
@implementation uialertViewController
- (void)viewDidLoad {

    [self displayAlert];
    [super viewDidLoad];
}

-(void)displayAlert{

    timer = [NSTimer timerWithTimeInterval:1 target:self selector:@selector(hideandview) userInfo:nil repeats:NO];

    alert = [[UIAlertView alloc] initWithTitle:@"testing" message:@"hi hi hi" delegate:nil cancelButtonTitle:@"continue" otherButtonTitles:nil];
    [alert show];

    [alert release];
    alert = nil;

}

-(void)hideandview{

    NSLog(@"triggered");

    [alert dismissWithClickedButtonIndex:0 animated:YES];

    [alert release];

    [self displayAlert];
}

@end 
```

**然后我改变** `[NSTimer timerWithTimeInterval: target: selector: userInfo: repeats: ];` **了** `[NSTimer scheduledTimerWithTimeInterval: target: selector:userInfo: repeats: ];` **，它正在工作**。有什么问题`timerWithTimeInterval:`？我在第一次实施中遗漏了什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-07-01T10:30:24.167

`scheduledTimerWithTimeInterval:invocation:repeats:`并`scheduledTimerWithTimeInterval:target:selector:userInfo:repeats:`创建自动添加到 的计时器`NSRunLoop`，这意味着您不必自己添加它们。将它们添加到 an`NSRunLoop`是导致它们触发的原因。

使用`timerWithTimeInterval:invocation:repeats:`and `timerWithTimeInterval:target:selector:userInfo:repeats:`，您必须手动将计时器添加到运行循环中，代码如下：

```
[[NSRunLoop mainRunLoop] addTimer:repeatingTimer forMode:NSDefaultRunLoopMode]; 
```

此处的其他答案表明您需要给`fire`自己打电话。你不知道——一旦定时器进入运行循环，它就会被调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-02T12:17:22.520

还可能需要确保在主线程上添加计时器。

```
assert(Thread.isMainThread)
let timer = Timer.scheduledTimer(timeInterval: 3, target: self, selector: #selector(YourSelector), userInfo: nil, repeats: true) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-05-15T13:48:30.847

正如先前的回答所指出的主线程上的调度，而不是使用断言，将其放在主线程上：

```
@objc func update() {
    ...
}

DispatchQueue.main.async {
            self.timer = Timer.scheduledTimer(timeInterval: 0.01, target: self, selector: #selector(self.update), userInfo: nil, repeats: true)
        } 
```

如果不需要异步，请尝试以下操作：

```
let schedule = {
            self.timer = Timer.scheduledTimer(timeInterval: 0.01, target: self, selector: #selector(self.update), userInfo: nil, repeats: true)
        }

        if Thread.isMainThread {
            schedule()
        }
        else {
            DispatchQueue.main.sync {
                schedule()
            }
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-15T21:46:19.653

两者的区别在于该`timerWithTimeInterval`方法返回一个`NSTimer`尚未触发的对象。要触发计时器，您必须使用`[timer fire];`另一方面，`scheduledTimerWithTimeInterval`返回`NSTimer`已经触发的一个。

所以，在你的第一个实现中，你只是错过了`[timer fire];`

# jquery-mobile - 未在 PhoneGap 应用程序中加载 Openlayers 磁贴 - jQuery Mobile 冲突？

> ID：11058572
> 
> 赞同：0
> 
> 时间：2012-06-15T21:41:52.973
> 
> 标签：jquery-mobile, cordova, openlayers

作为我的第一个 PhoneGap 应用程序的一部分，我需要加载 OpenLayers 地图（最终使用我自己的本地自定义图块，但目前，我只是使用在线图块进行测试，修改标准 OpenLayers 示例）。

但是当我尝试在 iOS 模拟器中初始化地图时，瓷砖不想加载，使用 OpenStreetMap 或替代方案。地图初始化尽可能地放置控件和版权声明，但我一直得到蓝色问号框而不是动态图块。在浏览器中独立测试地图加载代码，如果我删除 jQuery Mobile 引用，它似乎可以正常工作，但如果我在 Xcode 中调整文件，这似乎不起作用，除此之外，它搞砸了我想要的外观和行为。这是一个已知的冲突吗？有人知道解决方法吗？

提前致谢！

贾尔斯

```
<!DOCTYPE html> 
<html> 
<head> 
<title>My Page</title> 
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="stylesheet" href="jquery.mobilecus-1.1.0.min.css"/>
    <script src="js/jquery-1.7.2.js"></script>
    <script src="js/jquery.mobile-1.1.0.min.js"></script>
    <script src="js/sessionstorage.1.4.js"></script>
    <script src="js/OpenLayers.js"></script>

<script type="text/javascript" charset="utf-8">

    $(function() { //ready
    // JQuery stuff trimmed out
    }); //end ready

    var map
    function init() {
       map = new OpenLayers.Map("mapview");
       map.addLayer(new OpenLayers.Layer.OSM());
       var lonLat = new OpenLayers.LonLat( 0.0 ,51.0).transform(
            new OpenLayers.Projection("EPSG:4326"), // transform from WGS 1984
            map.getProjectionObject() // to Spherical Mercator Projection);
       var zoom=10;
       map.setCenter (lonLat, zoom);
       }
</script>
</head>

<body onload="init();"> 

<div data-role="page" id="page1" class="page">
     //html for first page (no map)
</div><!-- /page -->

<div data-role="page" id="page2" class="page">
    <div data-role="header" data-id="fixedheader" data-position="fixed" >   
    <h1>Fixed header</h1>
        </div><!-- /header -->

    <div data-role="content">
            <div id="leftbar">
            <img src="images/leftbar.png">
        </div><!-- /leftbar -->
        <div id="mapview">
            //map appears here
        </div><!-- /mapview -->
        </div><!-- /content -->

    <div data-role="footer"data-id="fixedfooter" data-position="fixed">
        <a id="ForwardButton">Forward</a><a id = "BackButton" href="#page2">Back</a>
    </div><!--/footer -->

</div><!-- /page -->

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T09:38:39.860

对不起——忘了我说话了！刚刚发现我需要在 Cordova.plist 中的“ExternalHosts”中添加对地图服务器域的引用。现在图像似乎加载正常。

# c - POSIX 函数在 PATH 中搜索可执行文件？

> ID：11058574
> 
> 赞同：9
> 
> 时间：2012-06-15T21:42:00.973
> 
> 标签：c, unix, path, posix

是否有 POSIX 函数`PATH`根据[POSIX 规范对`PATH`环境变量](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html#tag_08_03)的描述搜索可执行文件并返回可执行文件的绝对路径？

如果没有，是否有一种简单、安全、标准、可靠的搜索方式`PATH`？

**编辑：** [glibc 的`execvpe()`函数](http://sourceware.org/git/?p=glibc.git;a=blob;f=posix/execvpe.c)进行自己的`PATH`搜索，所以我猜`PATH`该标准没有定义特定的搜索函数。

**编辑 2：**出于以下几个原因 ，我不想复制别人的代码或`PATH`自己实现搜索：

*   [干燥](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself)
*   我必须测试和维护更多代码
*   可能的许可问题
*   POSIX 说，“如果`PATH`未设置或设置为 null，则路径搜索是实现定义的。” 我希望这些情况下的行为与系统所做的一切保持一致，但如果没有我可以调用的标准函数，我就不能这样做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-16T11:47:28.517

> 是否有一个 POSIX 函数根据 POSIX 规范对 PATH 环境变量的描述在 PATH 中搜索可执行文件并返回可执行文件的绝对路径？

不。

> 如果没有，是否有一种简单、安全、标准、可靠的方式来搜索 PATH？

是和不是。是的，有一个格式的标准，`PATH`实现的正确性/可靠性遵循该标准。

不，没有标准功能可以做到这一点。复制代码是你最好的选择。

> 如果`PATH`未设置或设置为 null，则路径搜索是实现定义的。

这意味着您不能总是*可移植*地复制所做的事情`execvp`，但搜索`/bin:/usr/bin`是一个非常安全的选择。或者，在这种情况下只引发错误。

（我承认如果 POSIX 有这个功能会很好，但它就是不存在。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T21:53:09.383

命令行工具`which`将执行此操作。[这是手册页](http://unixhelp.ed.ac.uk/CGI/man-cgi?which)

[和来源](http://cvs.savannah.gnu.org/viewvc/which/which.c?root=which&view=markup)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-17T05:02:38.557

怎么样做类似的事情：

```
FILE *f = popen("command -v somecommand", "r") 
```

然后读取它的输出？这将导致与系统对 empty/unset 的处理相匹配的行为`PATH`，并且可能比手动搜索更简单`PATH`。

这种方法有一些缺点：

*   如果`somecommand`来自用户，则可能必须对其进行清理以防止代码注入攻击。这会增加复杂性。
*   在处理所有可能的错误情况时可靠地读取流并非易事。更复杂。
*   如果`somecommand`是一个特殊的shell 内置（例如，`set`），它会返回虚假的结果。这种情况应该是可以检测到的，但是然后呢？更复杂。

# c - C，使用参数列表是否可以调用所有其他参数

> ID：11058581
> 
> 赞同：1
> 
> 时间：2012-06-15T21:42:57.473
> 
> 标签：c, variadic-functions

编辑：我别无选择，只能用 C 语言为这个软件编写代码，所以请记住这一点。

我正在尝试使用参数列表来比较来自点集的数据。可能有更好的方法来做到这一点，但我认为我需要调用所有其他参数进行比较。

基本上函数调用如下：

char * key1 是专有的，指的是我们数据库中记录的唯一 ID OSI_RECORD 也是专有的，指的是记录号 GET_*_VALUE 也是专有的，用于使用 DOFRI 指向特定字段

```
size_t LAST_OFF ( int argCount, char * key1, ... )
{
va_list     parmlist;
int         dS1, dS2, retValue, nextArg, max = 0;
char        * keyN;
char        * keyS;
OSI_RECORD  ptRecord1;
float       argMax;

va_start( parmlist, key1 );

    nextArg = 2;

    for (size_t i = 0; i < key1; i +=2)
    {

        keyN = va_arg( parmlist, char * );
        keyS = va_arg( parmlist, char * );

        dS2 = GET_STATUS ( keyS );

        if (dS2 = 1) 
        {
            ptRecord1 = GET_R (keyN, "STATUS");
            dS1 = GET_FLOAT_VALUE ( 10, 4, 31, ptRecord1, 0); 

            if ( dS1 > max );
            {
                max = ( dS1 );

                if (nextArg < argCount)
                {
                    argMax = (((float)nextArg + 1 ) / 2 );
                }

                else if (nextArg = argCount)
                {
                    argMax = (1);
                }

            }

        nextArg++;

        }

        else if (dS2 /= 1)
        {

            nextArg++;

        }

    }

    retValue = max;

va_end ( parmlist);

PUT_ANALOG ( key1, argMax );

} 
```

编辑：这是当前版本的 calc。我确信它有很多问题，但我在编译它时遇到了问题。

以下是我从编译器中得到的错误：

```
 error C2143: syntax error: missing ';' before 'type'
 error C2143: syntax error: missing ';' before 'type'
 error C2143: syntax error: missing ';' before 'type'
 error C2143: syntax error: missing ';' before 'type'
 warning C4047: '<' : 'int' diffes in levels of indirection from 'char *'
 warning C4552: '<' : operator has no effect; expected operator with side-effect
 error C2059: syntax error : ')'
 error C2143: syntax error : missing ':' before '{'
 warning C4244: '=' : conversion from 'float' to 'int', possible loss of data 
```

除了最后两个警告之外的所有警告都指向这一行：

```
 for (size_t i = 0; i < key1; i +=2) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:34:25.587

我最终使用 struct 来定义我的配对。我能够使用我现有的代码进行最少的修改。

```
typedef struct 
{
    char * key1;
    char * key2;
} UnitKeyPair; 
```

我相当简单地将 UnitKeyPairs 传递到我的 parmlist 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T02:26:22.060

```
else if (nextArg = argCount) 
```

您确定要*分配*而不是*比较*吗？

> 基本上，对于我在 va_list 中比较的每个键，我需要有一个设置为等于 1 或 0 的配对键。如果该键是 0，我跳到下一个参数，如果它是 1，那么我使用那个论点。

只要您记住传递正确的参数计数和正确排序的参数，这非常容易。这是一个简单的`filter`函数，它`int`至少需要一个大小数组`argc / 2`和可变数量的参数（总是偶数），并根据紧随参数的条件参数返回选定的参数：

```
size_t filter( int *out, int argc, ... )
{
  assert( argc % 2 == 0 );
  size_t nout = 0;
  va_list vl;
  va_start( vl, argc ); 
  for (size_t i = 0; i < argc; i += 2)
  {
    int val = va_arg( vl, int );
    int cond = va_arg( vl, int );
    if (cond) {
        out[ nout++ ] = val;
    }   
  }
  va_end( vl );
  return nout;
} 
```

使用该功能也很容易：

```
void test() 
{
    int *p = malloc( 4 * sizeof *p );
    if ( p ) {             /*4 pairs*/
        size_t n = filter( p, 4 * 2, 1, 0, 2, -1, -4, 1, 0, 0 );
                                    /*out*/ /*in!*/ /*in*/ /*out*/
        printa( p, n );
        free( p );
    }
} 
```

我不知道您的代码中有几个项目（看起来像宏），因此您必须弄清楚如何修复代码。

# .net - 用户控件的 OutputCache 不起作用

> ID：11058583
> 
> 赞同：0
> 
> 时间：2012-06-15T21:43:06.927
> 
> 标签：.net, caching, sitefinity

我有一个复杂的网站，它使用通过 Sitefinity 启用的 .NET 输出缓存。最近我们需要一个特定的用户控件根据用户位置有不同的缓存版本。因此，我为用户控件提供了一个设置了 VaryByCustom 的 OutputCache 指令，并覆盖了 Global.asax 中的 GetVaryByCustomString 方法以获取用户位置。问题是，即使在一个简单的测试用例中，这也不起作用。我们在 Sitefinity 环境之外测试了这个用例，通过创建一个包含 .aspx 页面的新项目并在其中放置一个新的 .ascx 用户控件来验证它是否会导致问题。该页面有一个标签，该标签获取当前加载时间以及控件。该控件还有一个呈现当前时间的标签。如果我将页面 OutputCache 设置为此：

```
<%@ OutputCache Duration="60" VaryByParam="none" %> 
```

并将控件设置为此：

```
<%@ OutputCache Duration="60" VaryByParam="none" VaryByCustom="browser" %> 
```

没有发生预期的功能。当时的想法是，如果我们在两个不同的浏览器中打开这个页面，我们会在第二个标签中看到两个不同的时间。我在这里完全错过了什么吗？我是处理 .NET 缓存的新手，所以完全有可能。

谢谢

这是我对 GetVaryByCustomString 的覆盖：

```
 public override string GetVaryByCustomString(HttpContext context, string custom)
    {
        if (custom == "custom")
        {
            // return custom logic
        }
        else
        {
            return base.GetVaryByCustomString(context, custom);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T00:05:40.813

如果您正在使用

```
 <%@ OutputCache Duration="60" VaryByParam="none" VaryByCustom="browser" %> 
```

那么对于不同的主要版本+浏览器类型的每个浏览器，缓存应该是不同的。所以 Firefox 3.5.0 和 Firefox 3.6.0 应该看到相同，但 Firefox 3.5 和 Firefox 2.0 应该看到不同。

我假设您没有意外地在 global.asmx 中重载 HttpApplication.GetVaryByCustomString 来处理浏览器而不是允许 .NET 来处理它？

# sql - 从大容量插入的第二列开始插入

> ID：11058587
> 
> 赞同：1
> 
> 时间：2012-06-15T21:43:18.857
> 
> 标签：sql, sql-server, tsql, sql-server-2005, bulkinsert

我有一张有 4 列的表。我正在尝试从`.dat`文件批量插入表：

```
CREATE PROCEDURE insertIntoTable3
    @path nvarchar(500) 
AS 

declare @sql varchar(max)

select @sql='BULK INSERT Test1..Ao7 FROM ''';
select @sql=@sql+ @path ;
select @sql=@sql+''' with (FIELDTERMINATOR = ''|'' ,  ROWTERMINATOR = ''\n'' )';

exec(@sql) 
```

该`.dat`文件包含 3 列的数据，例如：

```
rr  qwerwq  1
vv  asdf    1 
```

我不想插入第一列。我想插入到第二、第三和第四列。

有没有办法从表中的第二列开始插入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:48:31.553

您可以使用临时表，在那里批量插入，然后仅将您想要的列插入到目标中。

或者您可以[使用格式文件跳过列](http://msdn.microsoft.com/en-us/library/ms179250.aspx)。

# ios - 更改 UIPopoverController 中的箭头位置

> ID：11058589
> 
> 赞同：2
> 
> 时间：2012-06-15T21:43:33.333
> 
> 标签：ios, uipopovercontroller

我有一个 UIPopoverController 但是，由于设计原因，我必须以不同的方式放置箭头。同样，这是箭头放置，而不是箭头方向

换句话说，默认情况下，箭头放置在 UIPopoverController 的中心，如下所示：

```
 -----^-----
 |         |
 |         |
 |         |
 |_________| 
```

我想要以下用于我的箭头位置

```
 --^--------
 |         |
 |         |
 |         |
 |_________| 
```

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T21:50:14.307

箭头实际上指向您提供的矩形：

```
presentPopoverFromRect:inView:permittedArrowDirections:animated: 
```

它出现在中心是因为弹出视图试图与提供的矩形居中对齐。如果您将带有该矩形的弹出框显示在难以出现的位置（例如屏幕一角），它将尽可能靠近，但不一定居中。

不幸的是，您不能真正改变这种行为，因为它已在类中内化，以保留 Apple/Cocoa UI 准则和行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-28T16:04:39.870

尝试使用[popoverLayoutMargins](https://developer.apple.com/library/ios/documentation/uikit/reference/UIPopoverController_class/Reference/Reference.html#//apple_ref/occ/instp/UIPopoverController/popoverLayoutMargins)并根据需要设置左边距。

# ruby-on-rails-3 - 嵌套属性，父级和可选子级

> ID：11058592
> 
> 赞同：0
> 
> 时间：2012-06-15T21:43:59.213
> 
> 标签：ruby-on-rails-3, nested-attributes

我有两个模型类，比如父母和孩子。首先创建父母，然后可以添加孩子。

我正在尝试创建一个编辑页面，您可以在其中编辑父级的信息并可能添加一个子级。

我设置了它，以便父母可以访问子属性：

```
has_one :child
accepts_nested_attributes_for :child 
```

在我编辑父信息的视图中，我有一个显示所有父信息的表单，然后是编辑现有子信息或添加新子信息的字段：

```
<%= form_for(@parent, :as => :parent, ...  %>       
    <%= form.text_field(:field_one) %>
    <%= form.text_field(:field_two) %>

    <%= form.fields_for @child do |child| %>  
        <%= child.text_field(:child_field_one) %>
        <%= child.text_field(:child_field_two) %>
    <%end%>
<%end%> 
```

问题是我可以让它工作的唯一方法是让我的父编辑控制器创建一个新的子节点并将其与父节点关联，然后再渲染视图。然后当用户尝试保存时，我的控制器会检查子字段是否为空，如果是则删除新创建的子字段。这样做的一个问题是，每次加载编辑页面时它都会创建一个空子项（假设一个子项不存在），然后将其保存到数据库中（我不想要）

是否有一种优雅的方式可以在父编辑页面上显示不存在的子项的字段，而无需在渲染之前创建新的子项？理想情况下，我希望所有内容都在一个表单上。我很确定我可以想出一种方法，用多个保存按钮以多种形式执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:08:38.243

也许我不完全理解你想要做什么，但如果你使用 fields_for 标签，你需要一个对象。唯一的另一种方法是使用该符号并将其称为：

```
<%=form.fields_for :child do |child| %> 
```

但是（假设这在 Rails 3 中仍然有效）实际上相当于

```
<%=form.fields_for Child.new do |child| %> 
```

这与

```
@child = Child.new 
```

在控制器动作中。

我很确定，为了使用表单助手，您需要一个对象来迭代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T15:39:11.253

如果您不希望将子对象保存到数据库中，除非用户对其进行了编辑，一种方法是对子对象进行模型验证，以防止其被保存。

# charts - Tableau Public 的替代方案

> ID：11058597
> 
> 赞同：0
> 
> 时间：2012-06-15T21:44:21.323
> 
> 标签：charts, visualization, analytics, tableau-api

我有想要分析的多变量数据。到目前为止，我发现了两个具有强大功能的程序：Tableau Public 和 Mondrian（更多信息请参见：http: [//www.wikiviz.org/wiki/Tools](http://www.wikiviz.org/wiki/Tools)）。您可以创建连接图并拥有大量过滤和显示选项。这确实很棒，但是两者都没有正确的保存选项。在 Tableau Public 中，您可以在线保存它，但这不是我想要的。

是否有类似于 Tableau Public 但脱机并带有“保存到文件”选项的东西？（免费也不错；））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T11:41:21.427

Tableau Desktop 有 14 天的评估期，您可以继续学习。与 Public 不同，您可以随心所欲地保存。因此，如果这是一个一次性的项目，那可能就足够了。

我怀疑你不想保存到 Public 因为 - 好吧，它是公开的 :)

...但如果这对您来说不是问题，您可以保存到 Public，然后直接从网站下载您的可视化，并使用 Public 和/或 Tableau Reader 进行查看。

（或者您可以分解并实际购买该软件:-)

# file - 如何在保存文件之前压缩文件？

> ID：11058602
> 
> 赞同：-1
> 
> 时间：2012-06-15T21:44:51.153
> 
> 标签：file, compression, storage

我想做一个免费的照片分享网站，想知道降低存储成本的最佳方法是什么？显然，没有明确的答案，我知道很多。我知道的最便宜的是 0.15 美元/GB。但是还有什么我可以做一些明智的编程来压缩文件之类的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T06:14:42.213

图像通常已经压缩，因此您不会在此处保存。您可以而且应该做的是拥有一个全局图像存储并避免其中的重复。原因是人们经常多次上传同一个文件（一张合影可以被群里的所有成员上传）。

这是它的完成方式：

*   您有图像的全局存储，其中每个图像文件都有一个引用计数器
*   当用户上传某个文件时，您会计算其哈希值，并查看您的图像存储中是否有大小相同且哈希值相同的文件。如果这样做，则增加文件的引用计数器，并将用户上传与现有文件相关联，方法是将指向现有文件的链接存储在与用户关联的记录中。
*   当用户删除“他的”文件时，您删除链接并减少引用计数器。如果计数器达到零，则删除该文件。
*   如果您的存储允许文件编辑，您将需要使用写时复制，即当文件被用户修改时制作一个副本。

# css - Grails Twitter Bootstrap 和谷歌地图

> ID：11058603
> 
> 赞同：0
> 
> 时间：2012-06-15T21:45:00.540
> 
> 标签：css, grails, twitter, twitter-bootstrap

我在 2.0.4 版本中使用 Grails，并且在我的 BuildConfig 中有以下内容：

```
compile ":twitter-bootstrap:2.0.2.25"
runtime ":fields:1.1" 
```

所以事实上，我使用的是 Twitter Bootstrap 插件。现在，我想在我的应用程序中使用谷歌地图，但使用 Bootstrap 插件时地图根本不显示。在没有 Bootstrap 的情况下使用地图时，它完全可以工作。我使用地图的文件如下所示：

```
<!doctype html>
<html>
  <head>
    <meta name="layout" content="main">
    <title>YouPlace</title>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&language=de"></script>
    <g:javascript src="googleWrapper.js" />
  </head>
  <body>
    <div id="mapCanvas"/>
  </body>
</html> 
```

所以，没什么特别的，我想。但它不起作用。有任何想法吗？

编辑：我创建了一个名为 map 的容器，它具有以下 css：

```
.map {
    padding: 100px;
} 
```

现在我可以看到地图，但地图并没有覆盖整个页面。我怎么能说它应该覆盖整个页面。我试过 padding: 100%，但后来它越过了页面，但更多，我看不到地图的尽头。

# character-encoding - 网站显示其他语言文本的错误字符

> ID：11058605
> 
> 赞同：0
> 
> 时间：2012-06-15T21:45:03.207
> 
> 标签：character-encoding, web, special-characters

我有很多文本存储在数据库中。这些文本有不同的语言（英语、日语、阿拉伯语、韩语、中文、西班牙语......）。

当我使用 phpMyAdmin 查看数据库时，我可以完美地看到每种语言的所有字符。但是，当我想使用 PHP 在屏幕上打印这些文本时，我会得到符号 � 或只是一堆????????。

保存文本的所有字段的排序规则编码都是相同的：**utf8_general_ci**。

另外，我将网站的编码设置为“utf8”：

 **我该怎么做才能正确地看到他们？我试过**utf8_encode()**和**utf8_decode()**，但什么都没有，它只是修复了西方语言中的一些字符，但在具有不同字母的语言中没有任何作用。

我不需要在同一页面中显示所有不同的字母，但我需要同时显示其中的 2 个（这是一个语言学习网站）。

关于如何解决这个问题的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:50:10.727

好的，解决方案很简单：在 PHP 中将数据库的编码设置为“UTF8”。就我而言，因为我使用的是 CakePHP，所以在数据库配置中我必须添加 **'encoding'=>'UTF8'**

# java - 如何使用 gradle 链接 lib 中的 jar？

> ID：11058609
> 
> 赞同：4
> 
> 时间：2012-06-15T21:45:32.210
> 
> 标签：java, jar, gradle

该项目如下所示：

项目

/src /a.java

/lib /B.jar

/垃圾桶

（a.java 使用 B.jar 中的一些类）

如何链接B.jar并通过gradle构建项目？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-16T13:00:28.903

首先，创建一个以`build.gradle`项目根目录命名的新构建脚本。您需要应用 Java 插件并将源目录设置`src`为，因为它不使用默认项目布局。我们还将您的 JAR 文件依赖项分配给`compile`配置。运行`gradle build`将编译您的代码，运行测试（您没有）并组装您的模块的工件。

```
apply plugin: 'java'

sourceSets {
    main {
        java {
            srcDirs = ['src']
        }
    }
}

dependencies {
    compile fileTree(dir: 'lib', include: 'B.jar') 
} 
```

# javascript - Javascript元编程：获取动态重写的当前执行函数的名称

> ID：11058610
> 
> 赞同：5
> 
> 时间：2012-06-15T21:45:37.043
> 
> 标签：javascript, function, dynamic, metaprogramming

我正在重写 javascript 的核心方法之一：

```
Element.prototype._removeChild = Element.prototype.removeChild;
Element.prototype.removeChild = function(){
    callback();
    this._removeChild.apply(this,arguments);
} 
```

我想从动态重写的函数内部动态获取方法的名称（在本例中为“removeChild”）。我使用`arguments.callee.name`但它似乎什么也没返回，认为它只是一个匿名函数。如何获取分配匿名函数的函数的名称？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T21:50:23.800

它*是*一个匿名函数。您只是将此匿名函数分配给该`Element.prototype.removeChild`属性，但这并不会使该属性成为该函数的名称。您可以将相同的函数分配给许多变量和属性，并且无法知道调用它的名称。

但是，您可以为函数指定一个正确的名称，您可以通过以下方式访问`arguments.callee.name`：

```
Element.prototype.removeChild = function removeChild() {
    ....
} 
```

# jquery - 关闭后如何打开另一个颜色框？

> ID：11058617
> 
> 赞同：0
> 
> 时间：2012-06-15T21:46:35.750
> 
> 标签：jquery, jquery-plugins, colorbox

关闭后如何打开另一个颜色框？

这是我到目前为止所做的：

```
$(document).ready(function () {    
     $(".signup, .load, #loop a[href='#signup_box'], .signup_sidebar").colorbox({
        inline : true,
        innerWidth : 600,
        innerHeight : 600,
        escKey : false,
        arrowKey : false,
        fixed : true,
        onClosed:function(){
          interrupt();
        }
      })
    //...    
    interrupt = function ($) {
      $('#footer .stage .interrupt').colorbox({
        inline : true,
        innerWidth :  '600px',
        innerHeight : '600px',
        escKey :      false,
        arrowKey :    false,
        fixed :       true
      });
    };
}); 
```

每当我在文档中初始化它时，我都会收到一条错误消息，指出未定义颜色框。我认为这是一个范围界定问题，但我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:51:55.093

`interrupt`将定义更改为

```
interrupt = function () { ... } 
```

不知道为什么你期望`$`作为参数，但它不是必需的并且会导致问题。

# jquery - Fading in a previously hidden iframe in Firefox

> ID：11058619
> 
> 赞同：0
> 
> 时间：2012-06-15T21:46:43.970
> 
> 标签：jquery, firefox, iframe

CSS

```
iframe {
  display: none;
} 
```

JS

```
$('iframe').load(function() {
    $('iframe').fadeIn('slow');
}); 
```

HTML

```
<a href="http://example.com" target="ifrm">external link</a>

<iframe name="ifrm"></iframe> 
```

The above works in IE and Chrome, but when I try it out in Firefox, the iframe never displays. Any workarounds ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:13:21.253

Wrap it in a div and fade that in.

```
<a href="http://example.com" target="ifrm">external link</a>
<div id="iframeContainer" style="display:none;">
    <iframe name="ifrm"></iframe>
</div>

$(function() {
    $('iframe').load(function() {
        $('#iframeContainer').fadeIn('fast');
    });
}) 
```

# c# - 检测 http 标头内的电子邮件

> ID：11058623
> 
> 赞同：1
> 
> 时间：2012-06-15T21:47:18.810
> 
> 标签：c#, regex

我正在 csharp 中建立一个代理，我的任务之一是在 http 标头中查找电子邮件，问题是在我得到的数据中我收到 %40 而不是@，谁能告诉我如何在何时检测电子邮件邮件地址中的 @ 被替换为 %40？这是我在给定字符串中获取电子邮件地址的代码（使用 @ 而不是 %40） **代码**：

```
 string regexPattern = @"[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}";
  Regex regex = new Regex(regexPattern);
  MatchCollection matches = regex.Matches(this._context.Request.Headers[i]);
  foreach (Match match in regex.Matches(this._context.Request.Headers[i]))
  {// any email address should be printed 
         Console.WriteLine(match.Value);
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:54:43.177

不确定我是否理解你的问题。你为什么不直接用`@`你`%40`提供的正则表达式替换？所以：

```
string regexPattern = @"[A-Za-z0-9._%-]+%40[A-Za-z0-9.-]+\.[A-Za-z]{2,4}"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:04:38.150

在通过正则表达式运行数据之前，对您的数据进行[URL 解码：](http://msdn.microsoft.com/en-us/library/adwtk1fy.aspx)

```
regex.Matches(this._context.Server.UrlDecode(this._context.Request.Headers[i])) 
```

或者：

```
regex.Matches(HttpUtility.UrlDecode(this._context.Request.Headers[i])) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T21:57:10.923

使用 OR (|) 允许 @ 或 "%40"

[A-Za-z0-9._%-]+(@|%40)[A-Za-z0-9.-]+.[A-Za-z]{2,4}

# javascript - 淡入淡出 HTML5 视频图像/海报

> ID：11058635
> 
> 赞同：0
> 
> 时间：2012-06-15T21:49:12.463
> 
> 标签：javascript, video, html5-video, fadein, fadeout

如果我们开始播放视频并在暂停或停止视频时再次淡入，是否可以淡出 HTML5 视频海报/oimage？

通常海报图像在视频启动时直接隐藏，在我们加载/停止视频时也直接显示

也许我们可以将海报图像克隆到画布上，将其放置在视频上并淡出淡入？

是否有现有的解决方案/脚本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T22:11:55.690

属性的行为`poster`实际上是由`<video>`标签本身驱动的。在开始显示此图像之前，您只是在告诉它。与任何视频元素定制一样，这需要您参与其中的元素。基本上，您将拥有：

```
<div class="video-container" style="position:relative">
    <video width="x" height="y"></video>
    <img style="position: absolute; top: 0; left: 0; bottom: 0; right: 0">
</div> 
```

然后，您必须绑定您的事件，例如使用 Zepto：

```
$('.video-container img').bind('click', function() {
    var $img = $(this),
        $vid = $img.parent().find('video');
    $img.animate({opacity: 0}, 1000, 'linear', function() {
        $img.css({visibility: 'hidden'});
        $vid[0].play();
    });
}); 
```

同样，您将侦听暂停事件以及何时发生淡入。

*也就是说*，这可能是一个坏主意，原因有两个：

1.  这可能不适用于 iOS 或任何阻止脚本播放的设备。在这些设备中，您只能`play()`在单击事件处理程序中触发。由于您稍后再玩，因此您实际上无法控制。
2.  您正在破坏默认功能。当我暂停视频时，我可能想寻找另一个时刻，但我绝对想知道我在哪里停下来。视觉队列的缺乏消除了这一点。

**更新**

这是一种不同的方法，可以帮助您解决 iOS 难题。在这种情况下，您实际上是在点击时开始播放视频，这意味着褪色图像会在一段时间内覆盖正在播放的视频，所以这是您的决定。

```
$('.video-container').each(function() {
    var $img = $(this).find('img'),
        $vid = $(this).find('vid');

    $img.bind('click', function() { $vid[0].play() });

    $vid.bind('play', function() {
        $img.animate({opacity: 0}, 1000, 'linear', function() {
            if($vid[0].playing) {
                $img.css({visibility: 'hidden'});
            }
        });
    });

    $vid.bind('pause ended', function() {
        $img.css({visibility: 'visible'});
        $img.animate({opacity: 1}, 1000, 'linear');
    });

}); 
```

# ruby - 有没有办法在红宝石中重新定义 []=+

> ID：11058637
> 
> 赞同：3
> 
> 时间：2012-06-15T21:49:15.350
> 
> 标签：ruby, redis, metaprogramming

我正在尝试编写一个简单的 DSL（针对 Redis），我想自己定义 []+=

我有

```
def []=(key,val)
  @redis.zadd(@name,val,key)
end 
```

我想定义

```
def []+=(key,val)
  @redis.zincrby(@name,val,key)
end 
```

但我的理解是 Ruby 自动提供了 "[]+=" 运算符 []=

有没有办法覆盖这种行为显然我不想要这个，因为我不能，比如说，在管道模式下运行它

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T22:26:13.407

不，`<operator>=`不能在 Ruby 中重新定义。

您可以尝试变得非常花哨并将返回值包装在委托给实际值的类中。这样，它们的行为就像实际值一样，但您可以玩花样，例如使用`+`.

这是一个简单的例子：

```
require 'delegate'
module Redis
  class Set
    class Value < SimpleDelegator
      def +(val)
        Increment.new(self, val)
      end
    end

    class Increment < SimpleDelegator
      attr_reader :increment
      def initialize(source, increment)
        super(source.__getobj__ + increment)
        @increment = increment
      end
    end

    def [](key)
      Value.new(@redis.not_sure_what(@name, key))
    end

    def []=(key,val)
      if val.is_a?(Increment)
        @redis.zincrby(@name,val.increment,key)
      else
        @redis.zadd(@name,val,key)
      end
    end
  end
end 
```

这只是一个起点。您必须比这更加小心，例如检查密钥是否相同。在我的简单示例中，`redis[:foo] = redis[:bar] + 1`实际上相当于`redis[:foo] += 1`...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T21:52:03.830

没有。`x[y] += z`扩展到完全`x[y] = x[y] + z`：

```
class << (object = Object.new)
  def [](key)
    puts "[#{key.inspect}]"
    key
  end

  def []=(key, value)
    puts "[#{key.inspect}] = #{value.inspect}"
    value
  end
end

# These are all equivalent
object['See?'] += " It's impossible."
object['See?'] = object['See?'] + " It's impossible."
object.[]=('See?', object.[]('See?').+(" It's impossible."))

# They all produce the same output:
# ["See?"]
# ["See?"] = "See? It's impossible."
# => "See? It's impossible." 
```

您将不得不创建一个单独的方法。

# android - Android：解压缩文件会引发数据错误或 CRC 错误

> ID：11058639
> 
> 赞同：3
> 
> 时间：2012-06-15T21:49:20.467
> 
> 标签：android, exception, zip

我正在开发一个下载 zip 文件并在本地解压缩的项目。我遇到的问题是解压缩过程的工作时间为 5%。

在这一点上，这对我来说是个谜，因为有时它会起作用，但大多数时候它会抛出数据或 crc 错误。即使 zip 文件没有更改，它甚至会在错误之间切换。

我尝试了许多工具创建的 zip 文件，想知道格式是否不正确。但无济于事。即使在终端中创建的 zip 也不起作用。

这是我的解压缩代码：

```
try {
    String _location = model.getLocalPath();
    FileInputStream fin = new FileInputStream(localFile);
    ZipInputStream zin = new ZipInputStream(fin);
    ZipEntry ze = null; 
    byte[] buffer = new byte[1024];
    while((ze = zin.getNextEntry()) != null) {
        if(_cancel) break; 

        System.out.println("unzipping " + ze.getName());

        if(ze.isDirectory()) {
            File f = new File(_location + ze.getName());
            f.mkdirs();
        } else { 

            FileOutputStream fout = new FileOutputStream(_location + ze.getName());
            for(int c = zin.read(buffer); c > 0; c = zin.read(buffer)) {
                fout.write(buffer,0,c);
            }
            zin.closeEntry();
            fout.close();
        }
    }
    zin.close();

    if(_cancel) {
        handler.post(dispatchCancel);
        return;
    }

} catch(Exception e) {
    System.out.println("UNZIP ERROR!");
    System.out.println(e.getMessage());
    System.out.println(e.toString());
    e.printStackTrace();
} 
```

以下是我通常创建 zip 文件的方式。

```
$>zip -r myzip.zip myzip/ 
```

这是两个错误输出：

```
java.util.zip.ZipException: CRC mismatch
    at java.util.zip.ZipInputStream.readAndVerifyDataDescriptor(ZipInputStream.java:209)
    at java.util.zip.ZipInputStream.closeEntry(ZipInputStream.java:173)
    at com.XX.XX.XXIssueDownloader$7.run(XXIssueDownloader.java:222)
    at java.lang.Thread.run(Thread.java:1020)

java.util.zip.ZipException: data error
    at java.util.zip.ZipInputStream.read(ZipInputStream.java:336)
    at java.io.FilterInputStream.read(FilterInputStream.java:133)
    at com.XX.XX.XXIssueDownloader$7.run(XXIssueDownloader.java:219)
    at java.lang.Thread.run(Thread.java:1020) 
```

任何人都知道为什么我可能会收到这些错误？我没有得到任何这些。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T18:50:28.993

加载 Zip 文件时有两件事非常重要。

1.  确保您使用的请求方法不包含 Accept-Encoding: 标头。如果它在请求中，则响应不是 zip 文件，而是 gzip 压缩的 zip 文件。因此，如果您在下载时直接将其写入磁盘，那么它实际上并不是一个 zip 文件。您可以使用类似这样的方法来加载 zip 文件：

    ```
    URL url = new URL(remoteFilePath);
    URLConnection connection = url.openConnection();
    InputStream in = new BufferedInputStream(connection.getInputStream());
    FileOutputStream f = new FileOutputStream(localFile);

    //setup buffers and loop through data
    byte[] buffer = new byte[1024];
    long total = 0;
    long fileLength = connection.getContentLength();
    int len1 = 0;
    while((len1 = in.read(buffer)) != -1) {
            if(_cancel) break;
            total += len1;
            _Progress = (int) (total * 100 / fileLength);
            f.write(buffer,0,len1);
            handler.post(updateProgress);
    }
    f.close();
    in.close(); 
    ```

2.  使用输入和输出流时，不要使用 read(buffer) 或 write(buffer) 方法，您需要使用 read/write(buffer,0,len)。否则，您正在编写或阅读的内容可能最终会包含垃圾数据。前者 (read(buffer)) 将始终读取整个缓冲区，但实际上可能没有完整的缓冲区，例如，如果循环的最后一次迭代仅读取 512 个字节。所以这里是你如何解压文件：

    ```
    String _location = model.getLocalPath();
    FileInputStream fin = new FileInputStream(localFile);
    ZipInputStream zin = new ZipInputStream(fin);
    ZipEntry ze = null; 

    while((ze = zin.getNextEntry()) != null) {
            if(_cancel) break;  
            System.out.println("unzipping " + ze.getName());
            System.out.println("to: " + _location + ze.getName());
            if(ze.isDirectory()) {
                    File f = new File(_location + ze.getName());
                    f.mkdirs();
            } else { 
                    byte[] buffer2 = new byte[1024];
                    FileOutputStream fout = new FileOutputStream(_location + ze.getName());
                    for(int c = zin.read(buffer2); c > 0; c = zin.read(buffer2)) {
                            fout.write(buffer2,0,c);
                    }
                    zin.closeEntry();
                    fout.close();
            }
    }
    zin.close(); 
    ```

# android - Android 测试用例非 Activity 类

> ID：11058640
> 
> 赞同：-1
> 
> 时间：2012-06-15T21:49:40.500
> 
> 标签：android, junit

我在测试需要活动类上下文的非活动类时遇到问题。

Card 类扩展了 ImageView 并有一些方法：

```
public class Card extends ImageView { 

    public Card(Context context, int cardID) {
       super(context);
       this.cardID = cardID;
       this.turnback = 0;
       backImage =  getResources().getDrawable(R.drawable.backimage);
       setBackgroundDrawable(backImage);
   }
} 
```

我想将这个类作为一个独立类进行测试，是否有机会创建一个虚拟上下文？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:52:38.307

简单回答是不。原因是您正在扩展视图。测试视图的唯一方法是查看它。为此，您需要一项活动。这是安卓基础。

# php - 似乎无法附加到php中的数组

> ID：11058641
> 
> 赞同：1
> 
> 时间：2012-06-15T21:50:01.560
> 
> 标签：php

这个简单的脚本理论上应该检查表单是否有错误，然后打印它发现的任何错误。

formValidate 函数接受一个表单数组，表单中的每个字段都有一个经过验证的值。该字段还有一个错误键，其值为空数组。我正在尝试将我发现的任何错误附加到特定字段的错误数组中。然后我在完成后返回表单数组。

我稍后打印出所有字段的错误。不幸的是，错误从未出现。

我已经为此烦恼了好几个小时，我一生都无法弄清楚为什么我的脚本中的表单错误没有被应用。

任何帮助将不胜感激！

```
# get value from array
function array_get(array $array, $key, $default = null)
{
    return (array_key_exists($key, $array)) ? $array[$key] : $default;
}

# get string value from array
function array_get_string(array $array, $key, $default = '', $trim = true)
{
    $val = array_get($array, $key);
    if (is_string($val)) {
        return ($trim) ? trim($val) : $val;
    }
    return $default;
}

function validateForm($form)
{
    // validateField each field
    foreach ($form as $field)
    {
        foreach ($field['validation'] as $validate)
        {
            switch($validate)
            {
                case 'email':
                    if(!filter_var($field['value'], FILTER_VALIDATE_EMAIL)) {
                        $field['errors'][] = $field['value'] . ' is an invalid email address.';
                    }
                break;
                case 'number':
                    if(!preg_match('/^[0-9 ]+$/', $field['value'])) {
                        $field['errors'][] = $field['value'] . ' is an invalid number.';
                    }
                break;
                case 'alpha':
                    if(!preg_match('/^[a-zA-Z ]+$/', $field['value'])) {
                        $field['errors'][] = $field['value'] . ' contains invalid characters. This field only accepts letters and spaces.';
                    }
                break;
            }
        }
    }

    return $form;
}

// $post = filter_input_array( INPUT_POST, FILTER_SANITIZE_SPECIAL_CHARS );
$post = $_POST;
$ajax = array_get_string($post, "request_method") == 'ajax';

# select data that needs validation
$form = array(
    'fullname' => array(
        'value' => array_get_string($post, "full-name"),
        'validation' => array('alpha', 'required'),
        'errors' => array(),
    ),
    'emailaddress' => array(
        'value' => array_get_string($post, "email-address"),
        'validation' => array('email'),
        'errors' => array(),
    ),
    'activites' => array(
        'value' => array_get_string($post, "activites"),
        'validation' => array('default'),
        'errors' => array(),
    ),
    'country' => array(
        'value' => array_get_string($post, "country"),
        'validation' => array('default'),
        'errors' => array(),
    ),
    'contactpreference' => array(
        'value' => array_get_string($post, "contact-preference"),
        'validation' => array('default'),
        'errors' => array(),
    ),
    'message' => array(
        'value' => array_get_string($post, "message"),
        'validation' => array('alpha'),
        'errors' => array(),
    ),
);

// validate the form
$form = validateForm($form);

foreach ($form as $field)
{
    foreach ($field['errors'] as $error)
    {
        echo $error . '<br />';
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T21:53:33.687

`foreach`创建数组的副本并对其进行处理。如果您需要对原始数组进行更改，请通过引用传递它，如下所示：

```
foreach($form as &$field) {
    ...
} 
```

# jquery - 替换类的jquery事件

> ID：11058645
> 
> 赞同：0
> 
> 时间：2012-06-15T21:50:29.250
> 
> 标签：jquery

我正在尝试使用 jQuery 创建一个隐藏/显示按钮。单击 .cminus 时，需要隐藏 .arrowwrap 和 .commentbody 并用 cplus 替换它自己的类。然后，如果单击 .cplus，则需要发生相反的情况。

问题 1：在下面的示例中，将 .cminus 替换为 .cplus 后，.cplus 在单击时不会触发单击事件。

（编辑问题 2 移到单独的票）问题 2：我没有达到 .commentbody 隐藏/显示它的权利

html:

```
<div class="commentline">
    <div class="carrowholder">
        <div class="cminus"></div>
        <div class="arrowwrap">
        </div>
    </div>
    <div class="commentholder">
        <div class="commenttitle">
            Title
        </div>
        <div class="commentbody">
            Body
        </div>
    </div>
</div> 
```

jQuery代码：

```
$('.cminus').click(function(e) {
  $(this).next('.arrowwrap').hide();
  $(this).parent().next('.commentholder .commentbody').hide();
  $(this).removeClass('cminus');
  $(this).addClass('cplus');
})

$('.cplus').click(function(e) {
  alert("clicked cplus");
  $(this).next('.arrowwrap').show();
  $(this).addClass('cminus');
  $(this).removeClass('cplus');
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:52:55.980

使用`.toggleClass('cminus');`etc. 然后有一个事件处理程序或在父元素上使用 .on/.live 以允许委托事件。

至于

```
$(this).parent().next('.commentholder .commentbody').hide(); 
```

我认为 .commentholder 是多余的，因为您要指定下一个获得下一个兄弟的下一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:04:36.577

如果您只是想在显示和隐藏之间切换，我建议使用 .toggle('showorhide')

我创建了一个基本的小提琴供您尝试。

[http://jsfiddle.net/LsWuR/2/](http://jsfiddle.net/LsWuR/2/)

希望这会有所帮助。

# php - 如何在 CodeIgniter 的单个 post 参数中传递多个值？

> ID：11058652
> 
> 赞同：1
> 
> 时间：2012-06-15T21:51:12.410
> 
> 标签：php, codeigniter, post

我正在使用[所选](http://harvesthq.github.com/chosen/)的UI 库为名为“tables”的帖子参数选择多个值。在 Chrome 网络控制台中，我可以检查它是否按预期工作：

```
Form data
checkin:2012-06-15 16:00:00
checkout:2012-06-15 17:00:00
tables:14
tables:15
tables:16
customer:28 
```

但是当我尝试在控制器中恢复这个表信息时

```
var_dump($this->input->post('tables')); 
```

我只得到了参数的最后一个值：

```
string(2) "16" 
```

我也试试`var_dump($_POST['tables']);`，结果一样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T21:54:33.913

尝试调用它`tables[]`而不是`tables`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T22:06:28.527

只是一个如何将数组从 html 表单传递到服务器的示例

**HTML**

```
<form>
    <input name="tables[]" value="value1" />
    <input name="tables[]" value="value2" />
    ....
</form> 
```

**PHP**（代码点火器）

```
$tables_array=$this->input->post('tables'); // an array with all values of tables[] input/item of form 
```

如果你`print_r($tables_array);`那么输出将是

```
Array ( [0] => value1 [1] => value2 ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T21:56:00.910

我对 CodeIgniter 没有任何经验，但是您正在寻找的基本解决方案是创建一个数组并传递它（如果 CodeIgniter 有一个在 POST 中传递数组的函数最好，否则创建一个函数附加值并用逗号或分号和另一个函数分隔它们以在另一端解释它）或传递，说“tables1：14”，“tables2：15”，“tables3：16”，然后在你处理它们接收它们。我个人认为数组可能是最好的方法，但您可能有理由使用第二种方法。

# css - 可调整大小的导航栏未正确堆叠

> ID：11058653
> 
> 赞同：0
> 
> 时间：2012-06-15T21:35:04.573
> 
> 标签：css

有问题的网站是[http://oxfordbeach.com/bynight/](http://oxfordbeach.com/bynight/)

如果您调整浏览器的大小，导航栏最终会进入 iPhone 的下拉菜单。但是当它大约 900px 宽时，导航栏无法适应“联系人”列表项。

我为基本的 CSS 问题道歉，但我尝试过：

*   将标题调整为 %
*   将导航栏类调整为 %
*   调整单个列表项的大小

但是，我似乎无法绕过这样一个事实，即当浏览器在 900 像素左右时，给或取 100，导航栏无法正确呈现。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T21:54:11.580

将链接上的填充从 30px 减少到 25px 可以：

```
.sf-menu li a {
    padding: 0 25px;
} 
```

您还可以将此填充设置为 % 而不是固定 px 以使菜单更具响应性 - 我将把计算留给您！

# gnuplot - gnuplot图例中的粗线

> ID：11058659
> 
> 赞同：8
> 
> 时间：2012-06-15T21:51:56.700
> 
> 标签：gnuplot, legend, presentation

我正在用 gnuplot 绘制一些数据曲线，它们看起来像这样：

![用细线绘图](../Images/1802c9dc014d83012d86dcdac6872b2c.png)

但是，图例中的线样本太细了。当你有更多的曲线时，很难区分颜色。您可以使用“线宽”增加曲线的粗细，例如，通过在绘图命令中添加“lw 3”，您会得到：

![用粗线绘制](../Images/09a370b7e996bc21e659e14cc9026643.png)

*但是，这会增加各处*的厚度。是否可以仅在图例中使线条变粗？我知道它可以通过对输出 .png 文件进行后处理来“以另一种方式”完成。但是有没有直接的方法，使用一些 gnuplot 设置/向导？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T22:18:06.833

不幸的是，我不知道如何控制键中线条的粗细，因为它们对应于正在绘制的线条。`help set key`您可以通过输入gnuplot来查看可以更改的内容。

使用多图，您可以先绘制没有键的情节线，然后再次绘制“鬼线”的键。这是一个可以做到这一点的代码示例：

```
set terminal png color size 800,600
set output 'plot.png'

set multiplot

unset key

plot '../batteries/9v/carrefour.txt' w lp, \
     '../batteries/9v/philips.txt' w lp, \
     '../batteries/9v/sony.txt' w lp

set key; unset tics; unset border; unset xlabel; unset ylabel

plot [][0:1] 2 title 'Carrefour' lw 4, \
     2 title 'Philips' lw 4, \
     2 title 'Sony' lw 4 
```

在第二个绘图命令中，函数 2（一个常数）被绘制在 0 到 1 的范围内，所以它没有显示出来。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-31T11:41:54.020

我遇到了这篇文章，它给了我一个批判性的想法。提供的解决方案在多图模式下不起作用，因为第二个绘图命令将触发第二个绘图，这很可能是不希望的。作为一种解决方法，可以将原始数据设置为“notitle”，然后使用相同的线型和不同厚度的颜色绘制范围之外的数据以及所需的标题。我将在这里留下我当前的示例。它还包括我已声明的线条样式。所以我只是使用相同的线型（ls）来获得相同的颜色，但改变第二行的粗细。

```
 # for pngs
 set terminal pngcairo size 1600,600 font ',18' enhanced
 set output "pic_multi_kenngr_ana.png 

 set style line 2 lc rgb '#0ce90b' lt 1 lw 1.5 # --- green
 set style line 3 lc rgb '#09e0b3' lt 1 lw 1.5 #      .
 set style line 4 lc rgb '#065fd8' lt 1 lw 1.5 #      .
 set style line 5 lc rgb '#4e04cf' lt 1 lw 1.5 #      .
 set style line 6 lc rgb '#c702a9' lt 1 lw 1.5 #      .
 set style line 7 lc rgb '#bf000a' lt 1 lw 1.5 # --- red

 set multiplot layout 1,2 
 set xtics rotate
 set tmargin 5

 set xtics 12
 set grid xtics

 # set axis labels
set ylabel 'T [K]'
set xlabel 'Zeit [h]'

# select range
set xrange [0:48]
set yrange [290.15:306.15]

set title "(a) Bodentemperatur"
set key top right Right 

plot   'par_crank_hom01lvls.04.dat' u 1:3 with lines ls 7 notitle,\
       'par_crank_str01lvls.16.dat' u 1:3 with lines ls 2 notitle,\
       500  t 'z = 4 cm' ls 7 lw 4,\
       500  t 'z = 16 cm' ls 2 lw 4

################################################

set title "(b) Bodenwärmestrom an der Oberfläche"
set ylabel 'G [W m^{-2}]'
set yrange[-110:110]
unset key

plot 'par_crank_str01_ghf.dat' u 1:3 with lines

unset multiplot 
```

我希望这会对某人有所帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-16T07:47:19.383

一个更简单的解决方法（恕我直言）是明确定义颜色并将每行绘制两次，一次使用高 lw 作为键，并且标题出现在键中，但添加“每个 ::0::0 “这实际上最终导致什么都没有，并且曾经是正常的方式。请参阅以下代码片段：

```
plot data              u 0:1 w l linecolor rgb #1b9e77 lw 2 t "",\
     data every ::0::0 u 0:1 w l linecolor rgb #1b9e77 lw 4 t "Title" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-09-08T22:03:06.607

为了扩展`NaN`@Svalorzen 的评论，下面将绘制一些 datafile.txt 中没有标题的两条宽度为 1 的行，并创建具有指定标题和宽度为 5 的匹配空行，仅用于键：

```
plot [][]\
    NaN title "Title1" w line lt 1 lc 1 lw 5,\
    NaN title "Title2" w line lt 1 lc 2 lw 5,\
    "datafile.txt" using 1:2 title "" w line lt 1 lc 1 lw 1,\
    "datafile.txt" using 1:3 title "" w line lt 1 lc 2 lw 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-26T22:46:47.807

我找到了答案： [设置关键线宽](http://gnuplot.10905.n7.nabble.com/Set-key-linewidth-td2166.html)

在您的情况下，必须是：

```
plot '../batteries/9v/carrefour.txt' w l lw 1 linetype 1 notitle, 0/0 linetype 1 linewidth 5 title 'Carrefour' 
rep '../batteries/9v/philips.txt' w l lw 1 linetype 2 notitle, 0/0 linetype 2 linewidth 5 title 'Philips' 
rep '../batteries/9v/sony.txt' w l lw 1, linetype 3 notitle, 0/0 linetype 3 linewidth 5 title 'Sony' 
```

# c# - C# 后期绑定命令 COM obj 命令因所需的复制回设置而失败

> ID：11058661
> 
> 赞同：1
> 
> 时间：2012-06-15T21:52:04.577
> 
> 标签：c#, com, .net-3.5, late-binding

我知道我应该在 Vb.net 中编写此代码，但出于我自己的原因，我正在尝试对 C# .net 框架 3.5 中的 Com 对象进行后期绑定。我得到的错误是“DISP_E_BADCALLEE”，我只是根据我想要的复制设置为 true 来得到它。我在处理安全问题吗？我的研究使我尝试在 AssemblyInfo 文件中删除“[assembly: AllowPartiallyTrustedCallers()]”，但这并没有成功。我在下面的代码的精简版本中删除了一些细节。它在第四步失败了。我会很感激你的帮助。谢谢。

```
 //step 1
        _atlDirectorObject = Activator.CreateInstance(Type.GetTypeFromProgID("atlDirectorObject.atlDirector"));
        //step 2
        object[] parms = { "3270", 1, true, true, 0, _atl3270Tool, _ErrMsg };
        Boolean[] CopyBack2 = new Boolean[7];
        CopyBack2[5] = true;  //atl3270Tool
        CopyBack2[6] = true;  //ErrMsg

        Microsoft.VisualBasic.CompilerServices.NewLateBinding.LateCall(_atlDirectorObject, _atlDirectorObject.GetType(), "CreateTool", parms, null, null, CopyBack2, false);
        _atl3270Tool = parms[5];

        //step 3
        // now using _atl3270Tool we navigate mainframe screens
        object[] parms3 = { Screen, SubScreen, _Number, _ErrMsg };
        Microsoft.VisualBasic.CompilerServices.NewLateBinding.LateCall(_atl3270Tool, _atl3270Tool.GetType(), "ShowScreen", parms3, null, null, null, false);

        //>>>>>>>>>>>>>>CODE FAILS ON THIS STEP<<<<<<<<<<<<
        //step 4
        Boolean[] CopyBack4 = new Boolean[5];
        CopyBack4[3] = true; //screentext
        CopyBack4[4] = true; //_errmsg
        object ScreenText = String.Empty;
        object[] parms4 = { Row, Col, Length, ScreenText, _ErrMsg};
        Microsoft.VisualBasic.CompilerServices.NewLateBinding.LateCall(_atl3270Tool, _atl3270Tool.GetType(), "ReadScreen", parms4, null, null, CopyBack4, false)

        // if it were working the code would read screen data into parms4[3] object
        // If CopyBack4[3 and/or 4] are set to true = error 
        // Is just CopyBack4[0,1,2] are true = no error but no result           
        //Errors out with "Invalid callee. (Exception from HRESULT: 0x80020010 (DISP_E_BADCALLEE))"

        return Convert.ToString(parms4[3]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:06:29.757

ScreenText 应设置为 null，而不是 string.empty

# c++ - std::allocator 在重新分配后不保留旧分配的项目

> ID：11058662
> 
> 赞同：3
> 
> 时间：2012-06-15T21:52:14.610
> 
> 标签：c++, allocator

我正在尝试实现一个分配内存块的 Vector 类，如果它需要包含更多项目，最终会重新分配它。
我正在使用 std::allocator 来做到这一点：

```
#include <iostream>
#include <stdexcept>

using namespace std;

template <class T>
class Vector
{
private:
    T* data;
    allocator<T> data_all;
    int length;
    int _size;
    static const int block_size=10;
    void init()
    {
        length=0;
        _size=block_size;
        data=data_all.allocate(block_size,NULL);
    }
public:
    Vector()
    {
        init();
    }
    int size() const
    {
        return length;
    }
    void push_back(T item)
    {
        length++;
        if(length > _size)
        {
            _size+=block_size;
            data=data_all.allocate(_size,data);
        }
        data_all.construct(&data[length-1],item);
    }
    T& operator[] (int i)
    {
        if(i<0 || i>= length)
            throw out_of_range("The index is out of vector range");
        return data[i];
    }
};

int main(int argc, char** argv)
{
    Vector<int> v;
    for(int i=0; i<20; i++)
        v.push_back(i);
    for(int i=0; i<v.size(); i++)
        cout << v[i] << "\t";
    return 0;
} 
```

问题是先前分配的项目没有保留，它打印：

```
0   0   0   0   0   0   0   0   0   0   10  11  12  13  14  15  16  17  18  19 
```

代替：

```
0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16  17  18  19 
```

为什么会有这种行为？C++ 中没有办法像在 C 中使用 realloc 重新分配连续项目吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T22:01:50.553

的第二个参数`allocate`只是一个提示，分配器*可以*用来尝试返回靠近旧内存的新内存，但是`std::allocator`对于类似向量的容器来说被忽略并且相当无用，因为无论如何所有元素都彼此靠近，因为它们'在一个连续的块中。

您似乎期望它复制现有数据。它不会。您必须通过从旧内存块复制到新内存块来做到这一点。

您还泄漏了旧内存。你需要释放它。

你想要这样的东西：

```
void push_back(const T& item)
{
    if (length == _size)
    {
        T* new_data = data_all.allocate(_size+block_size);
        // N.B. if any of the following copies throws new_data will be leaked
        std::uninitialized_copy(data, data+length, new_data);
        std::destroy(data, data+length);
        data_all.deallocate(data, _size);
        data = new_data;
        _size+=block_size;
    }
    data_all.construct(&data[length++],item);
} 
```

# image-recognition - 通过 SURF 描述符识别对象的多次出现

> ID：11058667
> 
> 赞同：2
> 
> 时间：2012-06-15T21:52:52.563
> 
> 标签：image-recognition, surf

我的目标是识别并标记图像中所有出现的测试对象。我一直在使用 SURF 描述符来识别对象。目前，我能够从对象图像和场景图像中提取描述符，然后通过基于欧几里德距离的最近邻方法匹配它们。然后，计算一个单应矩阵（带有RASNAC）来定位和标记图像场景中的对象。但是如果对象在图像场景中多次出现，我不知道如何标记它。？

# jquery - 在 2 个不同的脚本中使用 2 个不同的 jquery URL？

> ID：11058669
> 
> 赞同：0
> 
> 时间：2012-06-15T21:53:04.800
> 
> 标签：jquery, version

我是 jquery 的新手，我正在尝试组合 2 个脚本，每个脚本似乎都使用不同的文件。

一种用途：

```
http://code.jquery.com/jquery-1.7.1.js 
```

而其他用途：

```
http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js 
```

问题是，如果我把 1.7.1 留在里面，那么使用 1.4.2 的脚本就会中断。删除 1.7.1 并只使用 1.4.2 通常安全吗？

另外，正常的和.min有什么区别。版本？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:56:08.270

1.7.1 包含 1.4.2 没有的功能。如果在引用 1.7.1 的脚本中使用了其中任何一个，而您改为使用 1.4.2，则引用 1.7.1 的脚本将中断。[您可以在http://blog.jquery.com/2011/11/21/jquery-1-7-1-released/](http://blog.jquery.com/2011/11/21/jquery-1-7-1-released/)找到 1.7.1（在之前的版本之上）的变更集

版本 1.4.2 之后的一些重大更改的示例

*   添加新方法，如 1.6 中的 attr 方法[http://ejohn.org/blog/jquery-16-and-attr/](http://ejohn.org/blog/jquery-16-and-attr/)
*   弃用旧方法，如 bind 支持新方法，如 on：[http ://api.jquery.com/bind/](http://api.jquery.com/bind/)
*   1.5 中 ajax 方法的主要重写[http://api.jquery.com/category/version/1.5/](http://api.jquery.com/category/version/1.5/)

.min 版本被缩小（意味着删除了不必要的空格，缩短了变量名），因此在页面加载时检索脚本需要更少的时间和空间。当你觉得不需要调试 jquery 时，你应该使用 .min 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:56:17.183

迁移是*不安全*的，事情不能停止工作，毫无疑问。如果您决定进行迁移，您可能需要检查路线图以了解从 1.4.2 到 1.7.1 的变化，并非常仔细地测试当前使用 v1.4.2 的主要功能。

尽管完全建议使用最新版本，但迁移可能是一个危险的过程，您必须权衡分析您的项目限制。

File`.min`是 js 库的缩小版。这意味着减小了大小，删除了不必要的空白字符、换行符和注释。

# mysql - MySQL 按等级排序，但需要整数

> ID：11058671
> 
> 赞同：0
> 
> 时间：2012-06-15T21:53:11.083
> 
> 标签：mysql, casting, sql-order-by

我想按以下顺序订购作为字符串的等级。

```
K, 1, 2, 4, .... 12 
```

但我不断得到`5, 4, 3, ... 12, K, 1`

sims_classroom 中的成绩列是 VARCHAR(255)，表格是 latin1；

我已经尝试了书中的每一个演员和技巧。目前，我通过添加 0 来获得以下技巧。我究竟做错了什么？

```
SELECT 
        (SELECT district_get_name_function(sod.parent_id, sod.id)) AS 'district_name', 
        (SELECT school_get_name_function(so.id)) AS 'school_name',
        st.teacher_username,
        st.teacher_first_name,
        st.teacher_last_name,
        c.name as 'classroom_name',
        c.grade,
        c.id,
        d.name AS 'discipline_name',
        d.id AS 'discipline_id',
        lc.name AS 'program_name',
        lc.id AS 'program_id'
    FROM sims_classroom c
.
.
.

    ORDER BY 
            CASE lower(sort_direction) WHEN 'asc' THEN
                CASE lower(sort_order)
                    WHEN 'grade' THEN 
                                 CASE c.grade 
                                    WHEN 'K' THEN 0
                                    ELSE (c.grade + 0)
                                 END
                    WHEN 'teachername' THEN lower(st.teacher_first_name)
                    ELSE c.name
                END
            END ASC,
            CASE lower(sort_direction) WHEN 'desc' THEN
                CASE lower(sort_order)
                    WHEN 'grade' THEN 
                                 CASE c.grade 
                                    WHEN 'K' THEN 10000
                                    ELSE (c.grade + 0)
                                 END
                    WHEN 'teachername' THEN lower(st.teacher_first_name)
                    ELSE c.name
                END
            END DESC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:17:18.167

您可以为成绩创建一个查找表。它将具有 Grade_Name（即“K”、“1”、“2”等）和作为 int 的 Grade_Order。

你会有这样的记录：

```
Grade_Name    Grade_Order
K             1
1             2
2             3
3             4 
```

等等。

然后，您可以将该查找表添加到您的 JOIN 和 ORDER BY Grade_Order。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T20:45:16.283

我只能让它工作。

```
WHEN 'grade' THEN 
                             CASE c.grade 
                                 WHEN 'K' THEN '00'
                                 WHEN '9' THEN '09'
                                 WHEN '8' THEN '08'
                                 WHEN '7' THEN '07'
                                 WHEN '6' THEN '06'
                                 WHEN '5' THEN '05'
                                 WHEN '4' THEN '04'
                                 WHEN '3' THEN '03'
                                 WHEN '2' THEN '02'
                                 WHEN '1-2' THEN '01'
                                 WHEN '1' THEN '01'
                                 ELSE c.grade
                             END 
```

# c# - 实体框架更新两个数据库

> ID：11058674
> 
> 赞同：1
> 
> 时间：2012-06-15T21:53:21.417
> 
> 标签：c#, entity-framework, linq-to-sql

正如我在其他几个问题中提到的那样，我目前正在尝试用实体框架替换本土 ORM，因为我们的数据库可以支持它。

目前，我们设置了某些对象，以便将它们映射到我们内部数据库中的一个表*和*运行我们网站的数据库中的一个表（甚至不在同一状态，更不用说在同一台服务器上）。因此，例如：

```
Part p = new Part(12345);
p.Name = "Renamed part";
p.Update(); 
```

将同时更新内部数据库和 Web 数据库，以反映 ID 为 12345 的零件现在被命名为“重命名零件”。这个逻辑暂时只需要走一个方向（内部->网络）。我们通过 LINQ-to-SQL DBML 及其对象访问 Web 数据库。

我**认为**我的问题有两个部分，尽管我可能一开始就没有提出正确的问题。

1.  是否有任何类型的“OnUpdate()”事件/方法可用于触发“是否应该将其推送到网络？”的验证。然后做推？如果默认情况下没有任何内容，是否有任何其他方法可以`.SaveChanges()`在它到达数据库之间和何时插入逻辑？
2.  有什么方法可以为每个对象指定它映射到哪个 DBML 对象，以及为每个 EF 自动生成的属性指定 L2S 对象上的哪个属性映射到？这些名字经常匹配，但并不总是如此，所以我不能依赖它。或者，我可以以通用方式修改 L2S 对象，以便它们可以从 EF 对象中填充自己吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:20:12.933

这是我最终采用的解决方案。请注意， 的实现`IAdvantageWebTable`是从现有的基类继承的，因此一旦将 T4 模板修改为正确继承，就无需对基于 EF 的类进行任何特殊操作。

```
public partial class EntityContext
{
    public override int SaveChanges(System.Data.Objects.SaveOptions options)
    {
        var modified = this.ObjectStateManager.GetObjectStateEntries(EntityState.Modified | EntityState.Added); // Get the list of things to update
        var result = base.SaveChanges(options); // Call the base SaveChanges, which clears that list.
        using (var context = new WebDataContext()) // This is the second database context.
        {
            foreach (var obj in modified)
            {
                var table = obj.Entity as IAdvantageWebTable;
                if (table != null)
                {
                    table.UpdateWeb(context); // This is IAdvantageWebTable.UpdateWeb(), which calls all the existing logic I've had in place for years.
                }
            }
            context.SubmitChanges();
        }
        return result;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:56:52.793

听起来像是[Sql Server 复制](http://msdn.microsoft.com/en-us/library/ms151198%28v=sql.105%29.aspx)的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T14:31:00.877

您不需要将两者相互连接在一起，就像您在问题 2 中所说的那样。只需让两个独立的数据库具有自己的 EF 或 L2S 模型，并使用具有域对象的存储库将它们抽象出来。

# java - fmt:message 在数字中添加无意的逗号

> ID：11058676
> 
> 赞同：3
> 
> 时间：2012-06-15T21:53:31.833
> 
> 标签：java, jsp, jstl

我发现格式标签库有奇怪的行为。我正在网页页脚格式化版权信息。我正在使用以下伪代码：

```
<fmt:message var="copyright" key="someKey">
    <fmt:param value="${year}"/>
</fmt:message>

...

<c:out value="${copyright}"/> 
```

我只是将年份作为参数传递到资源包中。如果您在传入之前删除年份值：

```
<c:out value="${year}"/>
<%-- renders as 2012 --%> 
```

但是在参数传入后，年份被格式化为数字。该数字呈现为 2,012。

我用谷歌搜索并四处询问，除了通用的 Oracle 文档（[http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/fmt/tld-summary.html](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/fmt/tld-summary.html)）之外，什么也没找到

还有其他人达到了吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T12:56:25.343

我有同样的问题，但在玩了之后发现只有数字类型会被格式化。如果您先将 year 设为字符串，则它不会：

```
Calendar cal = Calendar.getInstance();
int currYear = cal.get(Calendar.YEAR);
String cYear = Integer.toString(currYear);

<fmt:message key="msg.parameterized"><fmt:param value="<%=currYear%>"/></fmt:message>
<fmt:message key="msg.parameterized"><fmt:param value="<%=cYear%>"/></fmt:message> 
```

第一个将包含 2,012，第二个将包含 2012

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T00:21:28.227

它被解释为[`Number`](http://docs.oracle.com/javase/6/docs/api/java/lang/Number.html)by [`MessageFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/MessageFormat.html)，因此被格式化为千位分隔符，可以是逗号或点，具体取决于当前的语言环境。`Number`您可以通过添加[零宽度空间](http://en.wikipedia.org/wiki/Zero-width_space)来防止它被解释为 a ：

```
<fmt:param value="${year}&#8203;"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-05T11:54:46.787

虽然[BalusC 的答案](https://stackoverflow.com/a/12905859/889583)简单且表面上有效，但对我来说感觉有点不纯。首先，有一天可能会有其他人出现，想知道这个额外的角色到底是为了什么，甚至可能会删除它。

由于在底层`<fmt:message />`使用 Java 的内置[MessageFormat](https://docs.oracle.com/javase/8/docs/api/java/text/MessageFormat.html)类，我们可以在 ResourceBundle 的消息字符串本身中插入一个格式化模式。

例如，在您的 ResourceBundle 中，您可以拥有：

```
someKey = Copyright (c) {0,number,#} ACME Inc. 
```

这里`#`实际上可以是[DecimalFormat](https://docs.oracle.com/javase/8/docs/api/java/text/DecimalFormat.html)类中记录的任何格式字符串。在这种情况下，`#`仅输出数字而无需任何其他格式。

* * *

顺便说一句，由于在这个特定的实例中你想输出一年，你可以传递一个 java.util.Date 实例作为值`<fmt:param />`并在你的 ResourceBundle 中使用以下内容：

```
someKey = Copyright (c) {0,date,yyyy} ACME Inc. 
```

在这种情况下，可以使用任何[SimpleDateFormat](https://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html)格式字符串来代替`yyyy`.

# javascript - 如何知道动态页面的更改何时完全加载（来自用户脚本）？

> ID：11058678
> 
> 赞同：0
> 
> 时间：2012-06-15T21:53:43.627
> 
> 标签：javascript, userscripts

上`facebook.com`，单击“链接”*似乎*会加载新页面，但（我相信）实际上只是用新代码更新现有页面，*我怎么知道新内容何时完全加载*？例如，当您访问 时`facebook.com`，您将从“主页”页面（新闻提要）开始。当您在导航栏中单击您的名字时，您将被带到`facebook.com/yourname`. 然而，它并不是一个真正的*新*页面，因为用户脚本不会重新加载。

因此，我为我的用户脚本编写了一个小检查器，用于查看页面的当前 href 是否已更改：

```
var startURL;
var curURL;

function main() {
    startURL = window.location.href;
    console.log("initial page. src: "+startURL);
    setInterval(checkfornewpage, 500);
}

function checkfornewpage() {
    curURL = window.location.href;

    if(curURL != startURL) {
        console.log("new page. src: "+curURL);
        // do something
        startURL = curURL;
    }
}

main(); 
```

这工作正常，并在页面更改时通知我。但是，当尝试访问该新页面中的元素时，我发现我得到的是来自旧页面的内容。我认为这是因为即使`window.location.href`已更改，页面的其余部分也没有完全加载。

所以我决定在新页面上寻找一些我知道会改变的内容，以提示我新内容是否已完全加载。我选择了`body`标签类，因为每个新页面的类列表`body`总是不同的。我写了一个函数来观察这个，但是即使在`body`类列表完全改变之后，我的查询仍然会显示旧的页面数据。

我也尝试调用`load()`元素`body`，但它永远不会触发。

我不想使用某种`setTimeout`等待足够长的泛型......我想准确地知道它何时加载，以便我可以立即前进。想法？

# web-services - 使用 JaxBElement 处理肥皂故障

> ID：11058684
> 
> 赞同：1
> 
> 时间：2012-06-15T21:54:17.540
> 
> 标签：web-services, jaxb, jax-ws, jaxb2

问题是我们用于生成 JAXBElement 的 WSDL 不包含 SOAP 错误，因为服务可以返回 Soap 错误作为响应。

现在，当服务返回故障并且我使用 JaxBElement 时，它会引发异常。有没有办法可以处理（解析）这些肥皂故障并从中获取错误消息或描述。

# python - 尝试调用类方法的代码中的各种错误

> ID：11058686
> 
> 赞同：24
> 
> 时间：2012-06-15T21:54:26.963
> 
> 标签：python, class-method

我有这个代码：

```
class SomeClass:
    @classmethod
    def func1(cls,arg1):
        #---Do Something---
    @classmethod
    def func2(cls,arg1):
        #---Do Something---

    # A 'function map' that has function name as its keys and the above function
    # objects as values
    func_map={'func1':func1,'func2':func2}

    @classmethod
    def func3(cls,arg1):
        # following is a dict(created by reading a config file) that
        # contains func names as keys and boolean as values that tells
        # the program whether or not to run that function
        global funcList
        for func in funcList:
            if funcList[func]==True:
                cls.func_map[func](arg1)        #TROUBLING PART!!!

    if _name__='main'
        SomeClass.func3('Argumentus-Primus') 
```

当我运行它时，我不断收到错误：

```
异常类型错误：“'classmethod'对象不可调用”

```

我无法弄清楚这有什么问题，希望您能提供帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-15T22:20:29.173

在定义类之前，您不能创建对类方法的引用。您必须将其移出类定义。然而，使用全局函数映射来决定运行什么真的很尴尬。如果您描述了您要对此做什么，我们可能会建议一个更好的解决方案。

```
class SomeClass(object):
    @classmethod
    def func1(cls, arg1):
        print("Called func1({})".format(arg1))

    @classmethod
    def func2(cls, arg1):
        print("Call func2({})".format(arg1))

    @classmethod
    def func3(cls, arg1):
        for fnName,do in funcList.iteritems():
            if do:
                try:
                    cls.func_map[fnName](arg1)
                except KeyError:
                    print("Don't know function '{}'".format(fnName))

# can't create function map until class has been created
SomeClass.func_map = {
    'func1': SomeClass.func1,
    'func2': SomeClass.func2
}

if __name__=='__main__':
    funcList = {'func1':True, 'func2':False}
    SomeClass.func3('Argumentus-Primus') 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-11-17T15:04:54.527

我今晚发现了一些有用的东西：我们可以通过以下方式解开魔法`staticmethod`和`classmethod`物体：`getattr(func, '__func__')`

我是如何找到这些信息的？使用 JetBrains 的 PyCharm（我不了解其他 Python IDE），我查看了`@staticmethod`和`@classmethod`. 两个类都定义了属性`__func__`。

*“剩下的留给读者练习。”*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-09-17T15:37:58.297

`class SomeClass`所有其他答案都建议在定义之外添加一些代码。在某些情况下可能没问题，但在我的情况下，这非常不方便。我真的很想保留`func_map`课堂内部。

我建议采用以下方法。不使用类变量，而是使用另一种类方法：

```
class SomeClass:
    # ...

    @classmethod
    def get_func_map(cls):
        return {'func1': cls.func1, 'func2': cls.func2}

    @classmethod
    def func3(cls, arg1):
        # .....
        cls.get_func_map()[func_name](arg1) 
```

当然，您应该修改此代码，以便每次调用该`get_func_map`方法时都不会构建新字典。这很容易，我自己并没有这样做以保持示例小而清晰。

在 python 3.6 上测试

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-15T21:57:47.390

添加 *self* 作为类中每个方法的参数。

还

```
 if _name__='main'
    SomeClass.func3('Argumentus-Primus') 
```

应该是这样的：

```
if __name__=='__main__':
    SomeClass.func3('Argumentus-Primus') 
```

并且不应该在类的主体内。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-12-29T04:12:17.150

这是一个不好的方法：

```
def func3(cls,arg1):
    global funcList
    for func in funcList:
        if funcList[func]==True:
            eval(f'SomeClass.{func}')(arg1) 
```

仅当 func 是函数的名称时才有效。话虽如此，**请不要**使用此方法，因为您正在接受用户输入。在调用中注入讨厌的代码是很容易的。话虽如此，这确实有效。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-05-26T14:42:05.953

您可能需要尝试静态方法。

```
@staticmethod
def function():... 
```

静态方法不会将类作为隐式的第一个参数传递。

# django - 在不重新指定选项的情况下覆盖 Django ModelForm 中的 ChoiceField 小部件

> ID：11058687
> 
> 赞同：4
> 
> 时间：2012-06-15T21:54:28.683
> 
> 标签：django, django-forms, django-models

我试图覆盖 Django 的默认小部件，`ChoiceField`同时保留模型中生成的选择。这是我的模型的相关部分：

```
class UserGroup(models.Model):
    icon = models.CharField(max_length=100, choices=<function call>) 
```

而我的形式：

```
class UserGroupForm(forms.ModelForm):
    icon = models.ChoiceField(widget=IconPicker)

    class Meta:
        model = UserGroup
        fields = [ 'icon', ] 
```

像这样覆盖`ChoiceField`'s 小部件会破坏`form.fields['icon'].choices`通常从模型继承的属性并将其设置为`[]`Django. 如果我`icon`从表单中删除字段定义，则保留选项 - 但当然小部件默认为`Select`.

（不幸的是，无法从表单代码访问生成模型字段选项的函数。）

到目前为止，我想出的最好的方法是将`icon`表单字段定义更改为

```
icon = ChoiceField(choices=UserGroup._meta.get_field_by_name('icon')[0].choices, 
                   widget=IconPicker) 
```

但这很笨拙，我宁愿让选择自动传递，就像内省的`ChoiceField`行为一样。（我尝试将子类化为相同的子类`ChoiceField`，`IconChoiceField`但对于默认小部件，但由于[这个问题](https://code.djangoproject.com/ticket/9245)`IconPicker`，Django 将其转换回`TypedChoiceField`具有默认小部件的 a 。）`Select`

有没有办法在保留从模型继承的行为的同时覆盖`ChoiceField`'s属性？ `widget``choices`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-29T15:32:12.060

我认为您丢失模型中指定的选择的原因，即“将其设置为`[]`”**不是“因为 Django”，而是因为您**使用该行覆盖了图标字段`icon = models.ChoiceField(widget=IconPicker)`

请注意，如果您使用的是模型表单，则无需在初始化时覆盖小部件，而应在小部件字典的 Meta 类中指定小部件。

```
class UserGroupForm(forms.ModelForm):

    class Meta:
        model = UserGroup
        fields = [ 'icon', ]
        widgets = {
            'icon': IconPicker
        } 
```

至于覆盖你可以简单地做的选择`self.fields['icon'].choices = UserGroupForm.ICON_CHOICES`，但我认为你不需要在这种情况下覆盖选择。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-16T10:56:59.883

弄清楚了。`UserGroupForm`只需要在's中进行一些自我参考`__init__`：

```
def __init__(self, *args, **kwargs):
    super(UserGroupForm, self).__init__(*args, **kwargs)
    self.fields['icon'].widget = IconPicker(choices=self.fields['icon'].choices) 
```

# mysql - MySQL 将 VARCHAR 转换为 INT 进行搜索

> ID：11058694
> 
> 赞同：1
> 
> 时间：2012-06-15T21:55:44.433
> 
> 标签：mysql, casting, int, varchar

我正在尝试在 varchar 字段的搜索之间执行数字，其中所有行几乎都是 int 的。我无法更改该行的数据类型，因为这是这个特定程序不幸的运行方式，我尝试使用它失败了

```
SELECT * FROM sales_flat_shipment_grid
WHERE CAST(order_increment_id AS SIGNED) 
BETWEEN 100073843 AND 100073504; 
```

increment_id 实际上是 varchar(50)，所以我尝试了其他方法来做到这一点

```
SELECT * FROM sales_flat_shipment_grid
WHERE order_increment_id >= '100073843' 
AND order_increment_id <= '100073504'; 
```

但我认为它不起作用，因为我仍在尝试模棱两可地搜索 varchar 字段。有什么建议，我是否走在正确的道路上，试图将该行作为 INT 进行搜索以进行搜索？多谢你们

# c++ - 将其转换为基类指针是否安全？

> ID：11058705
> 
> 赞同：0
> 
> 时间：2012-06-15T21:57:07.623
> 
> 标签：c++, pointers, polymorphism

我目前正在学习C++，这次我在搞指针，研究`this`指针和多态。我的问题是，下面的转换是否安全，我知道基本上我可以`m_uConnectedUsers`从`CUser`课堂上直接访问，因为“公共”，但我可能会找到需要它的场合，我想知道你们专业人士的意见它。

```
#include <windows.h>
#include <iostream>

using namespace std;

class CUserCounter
{
public:
    CUserCounter();
    virtual ~CUserCounter(){};

    BOOL m_bEmpty;
    u_long m_uConnectedUsers;
};

CUserCounter::CUserCounter()
{
    m_bEmpty = TRUE;
    m_uConnectedUsers = 0;
}

class CUser : public CUserCounter
{
public:
    CUser(LPCTSTR szName, BOOL bConnected, BOOL bChatting = FALSE );
    virtual ~CUser(){};

    BOOL m_bConnected;
    BOOL m_bIsChatting;
    TCHAR szCharName[32];

    bool IncreaseMoverMeter( unsigned uMeters );
};

CUser::CUser( LPCTSTR szName, BOOL bConnected, BOOL bChatting )
{
    if( szName )
    {
        if( strlen( szName ) > 30 )
            strcpy( szCharName, "Invalid" );
        else
            strcpy( szCharName, szName );
    }
    m_bConnected = bConnected;
    m_bIsChatting = bChatting;
}

bool CUser::IncreaseMoverMeter( unsigned uMeters )
{
    //is it safe? how does it works
    CUserCounter* pUserCounter = (CUserCounter*)this;
    if( pUserCounter )
    {
        pUserCounter->m_uConnectedUsers++;
        return true;
    }
    return false;
}

int main( int argc, char *argv[] )
{             
    CUser *pUser = new CUser( "Jonh", FALSE );
    std::cout << pUser->IncreaseMoverMeter( 4 );

    system("pause>nul");
    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T21:59:16.977

是的，它是安全的，但也没有必要。:)

转换是隐式的，因此无需强制转换。

`CUser` **是 a** `CUserCounter`（至少在您的设计中），因此指向 a`CUser`的指针也是指向 a 的指针`CUserCounter`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T22:02:15.500

我想讨论一个比问题中明确提出的问题更大的问题。

您有从 CUserCounter 派生的 CUser。这似乎是一个错误，因为用户*不是*计数器。在这种情况下，您应该有一个*has-a*关系 - CUser 对象应该包含一个 CUserCounter 对象，而不是一个。

为了回答这个问题，派生类可以访问它想要的基类的任何成员。不需要铸造，事实上铸造可以隐藏一些讨厌的问题 - 除非绝对必要，否则避免它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-15T22:01:06.660

通常不建议将成员变量公开。而是将它们设为私有并提供公共 getter 和/或 setter 方法。

如果您*必须*从派生类访问变量，请使其受保护

这样做的原因是成员变量表示对象的状态，不建议允许直接修改，因为它允许以破坏类的底层逻辑的方式更改状态（想想 String 类：如果你可以直接修改保存字符串大小缓存的变量，如果字符数组也没有相应地重新调整大小，这可能会对对象的进一步使用造成严重影响）

至于`this`指针：在大多数情况下，您不需要显式使用它，它的使用可以从上下文中推断出来。但是，如果您在同名的成员函数中有一个成员变量和一个参数，则该参数将隐藏该成员变量，您必须使用`this`它才能访问它。（当派生类的成员函数隐藏父类的函数声明时，也会产生类似的效果）

您也可以通过 访问类父类的受保护成员和公共成员`this`，但如上所述，您通常不需要使用它。此外，在这些情况下不需要转换为（指向）父类型的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T22:15:12.797

在我看来，这种转换不仅是不必要的，而且是不雅的。正如有人所说，很明显，如果你从某个类继承，你就有一些可用的字段/方法。您不仅编写了一些不必要的代码，而且还使您的方法的可读性降低并且更难以维护。编译器可能会优化此类代码并删除额外的指令，因此可能没有效率成本（但这只是我的假设）。我坚信，当您认为`this`有必要进行转换时，您很可能应该再次重新考虑您的实施。

# css - 用 CSS 中的图像遮盖 div

> ID：11058708
> 
> 赞同：1
> 
> 时间：2012-06-15T21:57:12.633
> 
> 标签：css, background-image

有没有办法在 CSS 中伪造与背景图像类似的前景图像？它不会存在于 div 中的其他元素之后，而是会隐藏元素内的所有内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T22:08:25.497

使用[伪元素](http://www.w3.org/TR/selectors/#gen-content)（`::before`在[IE≤7](http://quirksmode.org/css/contents.html#t15)中不起作用）：

```
.obscured{     
    position: relative;
}
.obscured::before{
    position: absolute; /* maximize the pseudo-element */
    top: 0;
    right: 0;
    left: 0;
    bottom: 0;
    background-color:rgba(0,0,0,0.3); /* use background-image here */
    content: " "; /* it needs actual content, an empty space is enough */
} 
```

也可以看看：

*   [**JSFiddle 演示**](http://jsfiddle.net/hsVuX/)
*   W3C: [CSS2.1: 12.1 :before 和 :after 伪元素](http://www.w3.org/TR/2009/CR-CSS2-20090908/generate.html#before-after-content)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:07:41.490

途中是使用绝对定位，来覆盖所有的标签。我想你想用一个事件来触发它。所以当事件触发时，可以浮动除前景之外的所有元素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:20:38.743

您可以使用绝对定位覆盖相同大小的子元素并为其添加背景图像。

带有 bg 颜色而不是图像的[jsfiddle 示例。](http://jsfiddle.net/Matt_Coughlin/hMxxq/)在 FF、Chrome、IE9 中测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-20T04:26:29.330

您可以使用一行 css > `backdrop-filter: blur(1rem);`：

```
<div class="some-background">
  <div style="backdrop-filter: blur(1rem);"></div>
</div> 
```

# html - div 的最小高度 100%

> ID：11058709
> 
> 赞同：0
> 
> 时间：2012-06-15T21:57:29.223
> 
> 标签：html, css

我正在尝试为这种布局找到一个简单的解决方案。这是简化的html。

```
<div class='wrapper'>
<div class='header'></div>
<div class='middle'> TEXT </div>
<div class='footer'></div>
</div> 
```

页眉和页脚具有固定的像素高度。中间可以有一个可变的高度，这取决于内容。我希望包装器的最小高度为 100%。因此，如果中间的文本很小，中间的 div 应该扩展以填充浏览器页面。如果它太长，*整个页面*应该是可滚动的。

这很容易吗？也许改变布局中的一些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T23:03:27.173

这是你的解决方案：http: [//jsfiddle.net/S4akv/1/](http://jsfiddle.net/S4akv/1/)

您不想为`.middle`. 如果您的内容只有几行，那么您最终会得到不需要滚动条的地方。

使用页眉和页脚，您也不希望`height: 100%`在您的`.middle`课程上，因为它会将您的页脚向下推，无论如何都会强制滚动条。您*也不*希望明确，`height:100%`因为大多数浏览器会将其解释为浏览器高度的 100%，因此当您将浏览器调整为更大时，高度不会改变或页脚不会移动。

这里最好的解决方案是让你的包装器和任何相关的背景附加到它上面。根据`.middle`div 中的内容，这个答案可能会改变，但考虑到简单的参数，这是最优雅的方法。

秘诀是确保所有包含的元素都设置了高度。原因是，任何块元素`height: 100%`都只会是包含它的区域的 100%。在这种情况下，您需要为中间、包装器和`body, html`

```
body,html { height: 100%; margin:0; padding:0; }
.wrapper { min-height: 100%; width: 100%; background-color: red; position:relative; padding-bottom: 200px; }
.header { height: 200px; width: 100%; background-color: blue; }
.middle {  }
.footer { height: 200px; width: 100%; background-color: green; position:absolute; bottom: 0; } 
```

如果您的嵌套内容`.middle`也需要 100% 高度，则有更好的方法，使用高度、绝对定位和负边距的组合。给猫剥皮的方法有一百万种。好吧，至少有一把:)

**编辑以添加填充`.wrapper`以为页脚腾出空间。wrapper 的底部填充必须与页脚高度相同**

# sql - 要相交的 SQL 查询

> ID：11058714
> 
> 赞同：0
> 
> 时间：2012-06-15T21:58:20.017
> 
> 标签：sql, intersect

我有很多关于 SQL 的问题，我不知道如何做我需要的，但一系列步骤是这样的：

有两张桌子。表 1 有一个“game_id”

表 2 有一个 'game_id' 和 'id' 其中 'game_id' 与第一个表相同。

表 1 是游戏列表。表 2 是特许经营权列表。

我正在尝试进行一个仅显示特许经营游戏的 sql 查询。

我有这个：

```
SELECT * FROM gamedata_similar_games
INNER JOIN gamedata_franchises
ON gamedata_franchises.id='244'
WHERE gamedata_similar_games.game_id= '6959' 
```

但它返回 335 个结果。该游戏属于特许经营，其中包含 6 场比赛。

这也太不清楚了吧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:00:55.233

您必须将相关字段放在 ON 子句上

```
SELECT * FROM gamedata_similar_games G
INNER JOIN gamedata_franchises F
ON G.game_id = F.game_id 
WHERE F.id= '244' 
```

# c++ - 在 C++ 中重载运算符的目的？

> ID：11058716
> 
> 赞同：0
> 
> 时间：2012-06-15T21:58:36.180
> 
> 标签：c++

在 C++ 中重载运算符的主要目的是什么？

在下面的代码中，`<<`并且`>>`被重载；这样做有什么好处？

```
#include <iostream>
#include <string>

using namespace std;

class  book {
    string name,gvari;
    double cost;
    int year;
    public:
    book(){};

    book(string a, string b, double c, int d) { a=name;b=gvari;c=cost;d=year; }
    ~book() {}
    double setprice(double a) { return a=cost; }
    friend ostream& operator <<(ostream& , book&);
    void printbook(){
        cout<<"wignis saxeli "<<name<<endl;
        cout<<"wignis avtori "<<gvari<<endl;
        cout<<"girebuleba "<<cost<<endl;
        cout<<"weli "<<year<<endl;
    }
};

ostream& operator <<(ostream& out, book& a){
    out<<"wignis saxeli "<<a.name<<endl;
    out<<"wignis avtori "<<a.gvari<<endl;
    out<<"girebuleba "<<a.cost<<endl;
    out<<"weli "<<a.year<<endl;
    return out;
}

class library_card : public book {
    string nomeri;
    int raod;
    public:
    library_card(){};
    library_card( string a, int b){a=nomeri;b=raod;}
    ~library_card() {};
    void printcard(){
        cout<<"katalogis nomeri "<<nomeri<<endl;
        cout<<"gacemis raodenoba "<<raod<<endl;
    }
    friend ostream& operator <<(ostream& , library_card&);
};

ostream& operator <<(ostream& out, library_card& b) {
    out<<"katalogis nomeri "<<b.nomeri<<endl;
    out<<"gacemis raodenoba "<<b.raod<<endl;
    return out;
}

int main() {
    book A("robizon kruno","giorgi",15,1992);
    library_card B("910CPP",123);
    A.printbook();
    B.printbook();
    A.setprice(15);
    B.printbook();

    system("pause");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T22:02:59.610

它永远*不必*使用；这只是一种方便，一种让用户定义类型更像内置类型的方式。

例如，如果重载 operator<<，则可以像整数和字符串一样流式传输书籍：

```
cout << "Book #" << n << " is " << books[n] << endl; 
```

如果你不这样做，你必须写这样的相同的东西：

```
cout << "Book #" << n << " is ";
books[n].printbook();
cout << endl; 
```

类似地，如果你创建一个 Fraction 类并给它一个 operator+，你可以像使用整数一样使用分数，等等。

有时，您的类是否应该以某种方式表现得像本机类型（例如，字符串的 operator+ 有意义吗？），有时是一个艰难的设计选择，但关键是 C++ 为您提供了选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T22:02:44.710

重载`<<`运算符允许您的对象在传递给 cout 时以您指定的方式写入输出。

否则， cout 只会写出你的对象的地址。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-23T00:56:24.813

重载运算符的目的主要是语法糖。它使丑陋的东西看起来不错。但它也是关于统一接口的，统一接口的一个重要原因是多态性，在这种情况下尤其是模板。

想象一下，我们有一个可爱的复数类`Complex`，我们想要一个正弦的泰勒级数逼近，我们想要为 Complex 和 double 类型工作。

如果我们支持运算符重载 on `*`,等`=`，`/`那么我们可以这样写：

```
template<typename T>
T sin(T t)
{
  T t2 = t*t;
  return t*(1 - t2/6 + (t2*t2)/120 );
} 
```

如果我们不能在等上重载`*`，`/`那么它开始变得丑陋，因为我们需要一个帮助类来统一双精度和复杂的接口，这就是它的样子。（我仍然允许重载`operator=`，否则会变得更糟）。

```
template<typename T>
T sin(T t)
{
  T t2 = helper<T>::mult( t, t );
  T t4 = helper<T>::mult( t2, t2 );
  T s(1);
  helper<T>::sincrement( &s, -1./6, t2);
  helper<T>::sincrement( &s, -1./120, t4);
  return helper<T>::mult( t, s );
}

template<>
struct helper<double>
{
  static double mult( double a, double b) { return a*b; }
  static void sincrement( double * v, double s, double x) { *v += s*x; }
}

template<>
struct helper<Complex>
{
  static Complex mult( Complex a, Complex b ) { return a.mult(b); }
  static void sincrement( Complex * v, double s, Complex x ) { v->add( x.scale(s) ); }
} 
```

现在我知道运算符重载可能很丑陋，并且可以隐藏真正发生的事情，但正确使用我认为它使这样的情况更容易理解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-18T09:46:04.263

The thing about C++ is it passes objects **by value**, as a fundamental aim of how it works, and this really greatly changes how objects work compared to reference-semantics oriented languages like Java and Objective-C.

Whereas in one of those languages there is a clear distinction between primitive types and objects in terms of how you use them - that is, you copy primitives a lot, you stick them into expressions involving operators, that sort of thing, whereas your interaction with objects is mainly instantiating them, calling methods on them and passing the references to them into functions - in C++ you can use objects pretty much the same way as you use primitives. This brings up a lot of complicated issues that C++ programmers have to deal with, like object lifetimes, whether an object is an lvalue or rvalue (that is, if it has a lifetime outside the expression it appears in), etc.

One thing your question brings up is why a class would overload << and >>. The C++ standard library uses this convention for *iostream* classes, and highlights another big difference from reference-semantics based languages - *in a value-semantics oriented language, class inheritance is inadequate to fully describe what you want to do with an object.* We can loosely say that if an object overloads << and >> to stream data in and out of some resource, then it satisfies the **concept** of an iostream, even if it doesn't inherit from iostream, or ios_base, or something. The meaning of this is twofold:

1.  If you put a *value* of this type into an expression and used <<, it would behave as expected.
2.  If you instantiate a *template* with this type as a parameter, which calls operator<< on the object, the code will compile successfully.

I deliberately used the word *concept* above because there was going to be a feature in C++11 (it got postponed to the next version) called Concepts which would formalise this idea in the language. The situation we have now is a sort of *duck typing* - if a template wants to use a certain operator with a type, it will compile if the type provides that operator and won't if it doesn't, regardless of what the operator actually *means*. operator<< is a case in point - in its original meaning, for an integer type, it means "leftward signed bit-shift", but when you are using the concept of iostream, it means "stream data from the object on the right into the object to the left".

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-15T22:02:13.260

您可以轻松地使用成员函数，在大多数情况下它只是提供“语法糖”。例如，在某些语言中，添加 2 个字符串会执行 concat。

```
stringOne = stringOne + stringTwo; 
```

虽然它可以很容易地用一个成员函数来实现，比如

```
stringOne.concat(stringTwo); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-15T22:03:08.900

重载运算符允许多态的特殊情况。

我能想到的最好的例子是重载了 + 运算符的字符串类。

在这种情况下，运算符将被重载以连接字符串，而不是“添加”两个没有任何意义的字符串。

为了回答您的问题，重载运算符可以（在某些情况下）生成更具可读性和可维护性的代码。然而，对一个人“有意义”的东西对于维护代码的人可能没有意义。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-18T08:10:13.810

使用重载运算符，您可以使用要求该运算符重载的标准库算法。

例如：

```
struct wtf{ wtf(int omg): omg(omg){} int omg; };

wtf operator+ (wtf const &omg, wtf const &lol)
{
    return wtf(omg.omg+ lol.omg);
}

#include <iostream>
#include <numeric>

int main()
{
    wtf lol[3]= { wtf(1), wtf(2), wtf(3) };
    std::cout<< std::accumulate(lol, lol+ 3, wtf(0)).omg;
} 
```

> 6

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-15T22:04:59.890

您重载 << 和 >> 运算符的主要目的是按照 C++ 标准库的精神创建一个 API，因此有经验的 C++ 程序员使用您的类型变得更加自然。

正是这样，操作符 << 和 >>在与 STL 流一起使用时称为[插入/提取操作符。](https://stackoverflow.com/questions/3281666/what-is-operator-called)从 C 开始，它们只是[位移运算符](http://en.wikipedia.org/wiki/Bitwise_operation#Shifts_in_C.2C_C.2B.2B.2C_C.23)。

由于在标准 C++ 领域中，他们获得了该含义，甚至为此获得了新的命名法，因此重用已经建立的编程术语是件好事。

现在，最初在 C++ 的创建中，为什么它对流操作采取了这种方式？通过获取移位运算符并将它们标记为插入和提取运算符，我不知道，考虑到移位运算符的出现，这可能是为了更好地表达插入/提取的想法，这个含义现在已经成为标准和西装可以重复使用。

# android - 如何在Android上省略活动标题

> ID：11058717
> 
> 赞同：2
> 
> 时间：2012-06-15T21:58:58.260
> 
> 标签：android, android-activity, title

我正在尝试省略活动的标题，有人可以告诉我该怎么做吗？

```
setTitle("My Title");
//when the text of the title gets too long, how can I use setEllipsize() here? how can I get the view Id of that title? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:11:28.310

试试这个： http: [//it-ride.blogspot.pt/2010/07/android-title-marquee.html](http://it-ride.blogspot.pt/2010/07/android-title-marquee.html) 有些人说它有效，有些人说它没有。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-15T22:27:37.787

该代码基于此网络链接 [http://it-ride.blogspot.pt/2010/07/android-title-marquee.html](http://it-ride.blogspot.pt/2010/07/android-title-marquee.html)

```
// make the title scroll!
         // find the title TextView
         TextView title = (TextView) findViewById(android.R.id.title);
         // set the ellipsize mode to MARQUEE and make it scroll only once

         title.setEllipsize(TruncateAt.MARQUEE);
         title.setMarqueeRepeatLimit(1);
         // in order to start strolling, it has to be focusable and focused
         title.setFocusable(true);
         title.setFocusableInTouchMode(true);
         title.requestFocus(); 
```

![在此处输入图像描述](../Images/cef5d6419fb8af097dc0e6bb13a776c3.png)

# yii - yii 日志不同 - 我们应该看哪里？

> ID：11058719
> 
> 赞同：0
> 
> 时间：2012-06-15T21:59:10.157
> 
> 标签：yii

我们正在使用 Yii 进行开发。一位用户看到 Yii 发出的警告，另一位用户没有。我们有相同的 app/config.php 文件。

这可能与apache有关吗？

我们应该在哪里查看更多差异以使它们看到相同的日志？

index.php 和 .htaccess 在所有机器上都是相等的（它们在 git btw 下）；

我们拥有的代码返回了一个只有一些用户看到而其他用户没有看到的错误，如下所示：

```
1 $(document).ready(function(){
2 if('<?php echo Yii::app()->controller->action->id?>' == 'update'){
3   if('<?php echo Yii::app()->user->id;?>' != '<?php echo $model->createUser->id; ?>'){ 
```

错误是：

> 试图访问非对象的属性

（在第 3 行）。

此错误已解决。事实上，只有一些开发人员会看到这一点，而其他人则不会，这让我感到困扰。

请指教

# php - 包含 $_SESSION 和 $_GET 的仅限会员页面

> ID：11058720
> 
> 赞同：0
> 
> 时间：2012-06-15T21:59:15.410
> 
> 标签：php, if-statement

代码：

```
<?php
//initializing script, do not modify
session_start();
define('IN_SCRIPT', true); //so that global.php cannot be accessed directly
$_SCRIPTNAME = 'default.php';
include 'global.php';
$db = new MyDB(); //mysql class
if(isset($_GET['action'])) {
    $action = $_GET['action'];
} elseif(isset($_SESSION['user']) && $action == "login") {
    header("Location: {$_SCRIPTNAME}?action=overview");
    exit;
} elseif($action == 'logout') {
    session_unset();
    header("Location: {$_SCRIPTNAME}?action=login");
    exit;
} else {
    header("Location: {$_SCRIPTNAME}?action=login");
    exit;
}

//display proper template for the action defined (if none found, 404)
$template = $db->selectFrom("template", null, array("name" => mysql_real_escape_string($action)));
if(!empty($template['result']['0'])) {
    $template = $template['result']['0'];
    eval("echo \"".$template['html']."\";");
} else {
    $template = $db->selectFrom("template", null, array("name" => "404"));
    $template = $template['result']['0'];
    eval("echo \"".$template['html']."\";");
}
?> 
```

在数据库中，我有一个表格`templates`，其中有几行格式`name/html`，其中`name`是模板的名称，`html`也是模板本身。Eval 是必需的 AFAIK 并且用户在模板中没有输入任何内容，因此它应该是安全的。

示例 URL 将是：`http://localhost/default.php?action=login`

我的问题是：为什么会

```
if(isset($_GET['action'])) {
    $action = $_GET['action'];
} elseif(isset($_SESSION['user']) && $action == "login") {
    header("Location: {$_SCRIPTNAME}?action=overview");
    exit;
} elseif($action == 'logout') {
    session_unset();
    header("Location: {$_SCRIPTNAME}?action=login");
    exit;
} else {
    header("Location: {$_SCRIPTNAME}?action=login");
    exit;
} 
```

如果未设置“用户”会话且操作未注销，则不重定向到 default.php?action=login？我正在尝试使未登录的用户无法访问“概述”页面。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:05:53.803

问题在于您的 if/elseif 块。

您需要将`$action`定义与块分开：

```
if(isset($_GET['action'])) {
    $action = $_GET['action'];
}

if(isset($_SESSION['user']) && $action == "login") {
    header("Location: {$_SCRIPTNAME}?action=overview");
    exit;
} elseif($action == 'logout') {
    session_unset();
    header("Location: {$_SCRIPTNAME}?action=login");
    exit;
} else {
    header("Location: {$_SCRIPTNAME}?action=login");
    exit;
} 
```

您的代码现在的方式是，它将执行该`if(isset($_GET['action']))`块，然后忽略该块的其余部分，因为这些都是`elseif`s。

# xml - 在 as3 中写入、更新和保存格式良好的 xml 文件

> ID：11058721
> 
> 赞同：2
> 
> 时间：2012-06-15T21:59:16.060
> 
> 标签：xml, actionscript-3, flash, actionscript, filestream

我正在尝试更新 xml 文件并将元素**保存****在**已保存的根元素中。

我只找到了刚刚打开而不保存 xml 文件的示例。有人可以帮我找到保存结果的最佳方法吗？

我现在的项目是这样的：

我正在通过 URLLoader/URLRequest 加载一个 xml 文件，并在几个文本字段中显示内容。来自输入字段的新文本通过 FileStream 直接保存（附加）到 applicationStorageDirectory 中的 xml 文件（将在 iPhone 上）。

然后应该将新输入添加到屏幕列表（使用 for 循环创建）并显示，但是，它无法做到那么远。从 xml 文件中读取新保存的输入后，我自然会得到错误 1088，因为 xml 文件格式不再正确。

这是因为输入附加在根元素之后，结果如下所示：

```
<root>
  <message></message>
  <date></date>
</root>
  <message>new input</message>
  <date></date> 
```

当然，我想要的是：

```
<root>
  <message></message>
  <date></date>
  <message>new input</message>
  <date></date>
</root> 
```

但我不知道我怎么能做到这一点。

我做了几次尝试来避免附加，比如加载 xml 内容，更改它，然后重新编写所有内容。但由于我还是 as3 的新手，我无法让它工作。

如果有人能告诉我最好的方法是什么以及如何解决它，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T07:38:51.020

简单地使用 XML 文字不是更好吗？

```
package
{
  import flash.display.Sprite;

  public class ZutAlors extends Sprite
  {
    public function ZutAlors()
    {
      trace(messagesToXMLString('hello world'.split(' ')));
    }

    private function messageToXML(m:String, d:Date = null):XMLList
    {
      return <ret>
        <message>{m}</message>
        <date>{(d || new Date()).toString()}</date>
      </ret>.children();
    }

    private function messagesToXMLString(array:Array):XML
    {
      const ret:XML = <root />
      for each(var s:String in array)
      {
        ret.appendChild(messageToXML(s));
      }
      return ret;
    }
  }
} 
```

如果 XML 格式不正确，则会出现编译错误...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T01:50:32.280

好吧，我只是想我会发布一个关于我目前所处位置的更新......

这应该能够为大多数对象输出 XML，到目前为止，如果您想开始尝试使用它进行调试并让我知道您是否有任何部分丢失或错误的 XML 输出，请告诉我知道...我将继续并尝试使用解析器来反转此版本生成的 XML 的过程，当我这样做时可能会改变。

```
package
{
    import flash.utils.describeType;

    import mx.collections.IList;

    public class AS3ToXMLMapper
    {

        public function AS3ToXMLMapper()
        {
        }

        public static function generateXML(objectToMap:Object, basePropertyName:String="root"):String
        {
            var describeXML:XML = describeType(objectToMap);

            var xmlOutput:String = "<"+basePropertyName+" name=\""+describeXML.@name+"\" base=\""+describeXML.@base+"\">\n";

            if(describeXML.@isDynamic=="true")
            {
                for(var property:String in objectToMap)
                {
                    xmlOutput += "<"+property+">";
                    xmlOutput += objectToMap[property];
                    xmlOutput += "</"+property+">";
                }
            }
            else if(objectToMap is XML)
            {
                xmlOutput+=(objectToMap as XML).toString();
            }
            else if(objectToMap is XMLList)
            {
                xmlOutput+=(objectToMap as XMLList).toString();
            }
            else
            {
                for each(var accessor:XML in describeXML..accessor)
                {
                    xmlOutput+="\t"+exportProperty(objectToMap, accessor,true);
                }
                for each(var variable:XML in describeXML..variable)
                {
                    xmlOutput+="\t"+exportProperty(objectToMap, variable, false);
                }
            }

            xmlOutput += "</"+basePropertyName+">\n";
            trace(xmlOutput);
            return xmlOutput;
        }

        private static function exportProperty(objectToMap:Object, xmlObj:XML, isAccessor:Boolean):String
        {
            var xmlOutput:String="";
            var propName:String = xmlObj.@name.toString();
            var objectValue:Object = objectToMap[propName];
            if(!objectValue)
            {
                xmlOutput += "<"+propName+">";
                xmlOutput += "</"+propName+">";
                return xmlOutput;
            }

            if(isAccessor && xmlObj.@access != "readwrite")
            {
                return "";
            }
            if(objectValue is Array)
            {
                return exportArray(objectValue as Array, xmlObj.@name);
            }
            else if(objectValue is IList)
            {
                return exportArray((objectValue as IList).toArray(), propName);
            }
            else if(objectValue is int || objectValue is Number || objectValue is String || objectValue is uint || objectValue is Boolean)
            {
                xmlOutput += "<"+propName+" type=\""+xmlObj.@type+"\">";

                xmlOutput += objectValue;
                xmlOutput += "</"+propName+">"; 
            }
            else
            {
                return generateXML(objectValue, propName);
            }
            return xmlOutput;
        }

        private static function exportArray(array:Array, arrayName:String):String
        {
            var xmlOutput:String = "<"+arrayName+">\n";

            for each(var element:Object in array)
            {
                xmlOutput+="\t"+generateXML(element,"arrayElement");
            }

            xmlOutput += "</"+arrayName+">\n";
            return xmlOutput;
        }
    }
} 
```

用法如下：

```
 var fs:FileStream = new FileStream();
            fs.open(new File("C:\\test.xml"),FileMode.WRITE);
            var thingToExport:Object = {aProperty:"someValue"};
            var as3XMLMapper:String = AS3ToXMLMapper.generateXML(thingToExport);
            fs.writeUTFBytes(as3XMLMapper);
            fs.close(); 
```

# c++ - C++ 逆运动算法/库，其中包括已知链中多个节点位置时的 IK 方法

> ID：11058724
> 
> 赞同：5
> 
> 时间：2012-06-15T21:59:28.973
> 
> 标签：c++, graphics, computational-geometry, robotics, inverse-kinematics

我正在寻找理想的 c++ 库/代码（但如果不是至少一个算法），它可以解决给定 n 个节点链的 IK 问题，其中估计链中 k 个节点（其中 k < n）的位置是已知的。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:15:23.923

这可以使用迭代 IK 算法（例如 Cyclic Coordinate Decent）来实现。

# umbraco5 - 使用对象作为数据源编写自定义 Hive 提供程序

> ID：11058726
> 
> 赞同：0
> 
> 时间：2012-06-15T21:59:57.880
> 
> 标签：umbraco5, umbraco-hive

我试图创建一个能够处理某些对象的配置单元提供程序。

一个对象可能看起来像这样

```
public class MyContent
{
    public System.Collections.Generic.List Content { get; set; }
}

public class ContentExample
{
    public string Title { get; set; }
    public string Text { get; set; }
}

public class MyFiles
{
    public System.Collections.Generic.List Files { get; set; }
}

public class FileExample
{
    public System.IO.FileInfo File { get; set; }
} 
```

我已经从 Visual Studio Gallery 下载并检查了两个 Hive 提供程序（Umbraco 5 Hive 提供程序和 Umbraco 5 Simple Hive 提供程序），但是缺少文档有点令人不安。我还下载了其他一些示例配置单元，例如 Wordpress 配置单元提供程序，但该配置单元与 Visual Studio 库中的配置单元有很大不同。

**理念**

我习惯使用 ObjectDataSource 之类的东西，如果需要，上面的示例可以用完整的 CRUD 来补充。

现在，我假设一个 Hive 提供商将能够为 Umbraco 的不同部分提供内容（对吗？）。只需设置一个新的存储库就可以了？我现在已经知道如何连接所有部分，甚至如何将数据输入提供程序。

对我如何将所有部分组合在一起有任何帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T04:28:56.197

第一步是退后一步，评估您的业务需求。你会允许用户在前端使用表单更新信息吗？您是否需要后台内容的树编辑器？您是否需要处理内置 ORM 之外的数据？

如果这些问题的答案是否定的，那么蜂巢供应商就太过分了。使用简单的表面控制器或仅使用[自定义文档类型](http://our.umbraco.org/wiki/how-tos/working-with-document-types)来评估解决方案。Umbraco 5 是一个完整的 EAV/CR 系统，因此与某些 CMS 产品不同，您将能够表示您可以想象的任何 rdbs 结构

ContentExample 可以表示为名为“Article”的文档类型，它具有 Title 和 Text 属性。只需定义此文档类型，我们就会立即在我们的内容部分为我们的后台用户添加和编辑表单。我们甚至可以限制哪些节点能够拥有“文章”类型的子节点，例如新闻。

同样，上传控件是一种允许您将文件附加到文档的字段类型。

那么自定义配置单元提供程序有什么意义呢？

自定义配置单元提供程序的目标是统一数据访问层的 CRUD 操作。因此，数据可以存储在烘焙的 nhibernate orm、自定义表、RSS 提要甚至平面文件中，同时仍然使用通用接口来检索和更新它。如果这听起来像您的目标，请继续阅读。

回到业务需求，具体来说，您希望将数据实际*存储*在哪里？--假设您有一些与平面文件存储相关的字段和属性，假设一个 TypedEntity（一个模型）等效于一个文件，并且写一些伪代码：

第一步，正如您所说的“将数据放入存储库”。这涉及返回到该 VS 模板并使用您的逻辑填充“未实现”方法以存储和检索数据。

```
 protected override void PerformAddOrUpdate(TypedEntity entity)
    {
        // step 1: serialize the typed entity to xml
        // step 2: write the file to the hdd, making sure that the file name is named using the                 hive id so that we can pull it back later.
    } 
```

编写完数据访问层或 DAL 后，您可以将其连接到 hive 配置中，并为其提供匹配的 url。例如，而不是匹配内容：\\，您的可能匹配文件管理器：\\

我们可以让我们的后台用户能够通过编写[自定义树](http://web-matters.blogspot.com/2011/11/umbraco-5-hive-provider-tree-editor.html)来添加新实体（间接地，新文件） ，并且我们可以通过宏向我们的前端用户显示结果。

# c# - 在编译时使用方法创建常量

> ID：11058727
> 
> 赞同：2
> 
> 时间：2012-06-15T22:00:05.837
> 
> 标签：c#, .net-4.0, compilation

我有一堆依赖于静态字典和彼此的字符串，但从未被用户代码修改。如下所示：

```
public static RegexDicts
{
  public static readonly Dictionary<string, string> dict = new Dictionary<string, string>{
    {"One", "1"},
    //And so on
  } 
}

public static class RegexStrings
{
  public static readonly string String1 = String.Join("|", RegexDicts.dict.Keys);
  public static readonly string String2 = "Hi! (" + String1 + "(";
  //...
} 
```

现在，每次程序执行时都必须执行所有这些方法（即使只有一次）。

将这些方法执行转移到编译器的最佳方法是什么，让实际的可执行文件保留预期的常量？更好的是，是否可以将其扩展到该字典本身 - 通过在编译时读取文件来构建字典？

如果我可以生成代码并同时编译它，我很乐意通过代码生成来做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T22:03:05.070

> 如果我可以生成代码并同时编译它，我很乐意通过代码生成来做到这一点。

您可以通过 T4 模板执行此操作。有关详细信息，请参阅[代码生成和 T4 模板](http://msdn.microsoft.com/en-us/library/bb126445.aspx)。

# magento - 联系表格不会从 Magento 发送，说无法提交您的请求

> ID：11058730
> 
> 赞同：1
> 
> 时间：2012-06-15T22:00:54.470
> 
> 标签：magento, contact-form

我刚刚升级了 Magento 的新版本，并注意到我们网站上的联系表格不再起作用，它只是说“无法提交您的请求。请稍后再试”。

我创建了 email.log 并输出：DEBUG (7): true;'My Name';'email@domain.com';'Contact Form'

我尝试对社区和企业进行新升级，它们都在联系表单上输出相同的错误。在论坛上阅读他们说这与 Magento 没有设置它的设置与新的新 ZEND 邮件有关。

我已经尝试了 20 种不同的东西：

*   验证联系人已在后端启用，设置发送电子邮件至：myemail@email.com 电子邮件发件人：一般联系人电子邮件模板：联系表格（来自区域设置的默认模板）

*   转到 ADVANCED_System 上的邮件发送设置禁用电子邮件通信设置为否确保设置返回路径设置为是，甚至更改它否，并指定，即使在保存设置后清除缓存后仍然无法工作

*   更改了 template.php

*   确保在位于 (app\design\frontend\enterprise\default\template\contacts) 的 form.phtml 中的提交按钮之间

*   检查位于 (app\code\core\Mage\Contacts\controllers) 中的 IndexController.php

*   检查 Mail.php 以查看是否有任何有趣的内容。(lib\Zend)

我真的迷失了答案，我搜索了高低，即使在这里，也没有找到可行的解决方案。在我升级到新版本之前，我的联系表格和一切正常。我什至用几个虚拟产品在全新安装上尝试了社区版本，它输出相同的错误。

* * *

谢谢大家的反馈，我决定在 8 小时后忘记该解决方案并使用此免费解决方案：http: [//www.magentocommerce.com/magento-connect/ziq2004/extension/460/advanced-smtp --artson.it](http://www.magentocommerce.com/magento-connect/ziq2004/extension/460/advanced-smtp--artson.it)

它基本上可以让您设置 SMTP 设置并阻止 Magento 说要使用的原始本地设置。希望其他人可以通过该解决方案节省数小时。

# google-app-engine - GWT 使用 RequestFactory 将 Objectify Cursor 从服务器传递到客户端，并在 DataGrid 中显示更多页面

> ID：11058737
> 
> 赞同：1
> 
> 时间：2012-06-15T22:01:41.913
> 
> 标签：google-app-engine, gwt, requestfactory, objectify

我对游标是全新的，并且有以下方法：

```
public List<Venue> findPage(Subject subject, Objectify ofy, int pageSize) {
  final Business business = (Business) subject.getSession().getAttribute(BUSINESS_ATTRIBUTE);
  final Query<Venue> query = ofy.query(Venue.class).filter(BUSINESS_ATTRIBUTE, business);
  final String encodedCursor = (String) subject.getSession().getAttribute(VENUE_CURSOR_CONDITION);
  if (encodedCursor != null) {
    query.startCursor(Cursor.fromWebSafeString(encodedCursor));
  }
  final QueryResultIterator<Key<Venue>> iterator = query.fetchKeys().iterator();
  final List<Key<Venue>> data = new ArrayList<Key<Venue>>(pageSize);
  boolean more = false;
  for (int i = 0; i < pageSize && (more = iterator.hasNext()); i++) {
    data.add(iterator.next());
  }
  subject.getSession().setAttribute(VENUE_CURSOR_CONDITION, iterator.getCursor().toWebSafeString());
  return get(ofy, data);
} 
```

其中get是以下方法

```
public <T> List<T> get(Objectify ofy, List<Key<T>> keys) {
  if (keys == null) {
    return null;
  }
  final Map<Key<T>, T> map = ofy.get(keys);
  final List<T> list = new ArrayList<T>();
  for (T t : map.values()) {
    list.add(t);
  }
  return list;
} 
```

现在，这就是我目前正在做的事情——这有点骇人听闻。我正在使用 Apache Shiro 来跟踪用户的会话 - 在用户的会话中，我保留最后使用的光标 - 如果用户导航离开页面，我将光标设置为 false （显然 - 这非常非常脆弱，因为它需要每个方法都有一个代码使最后一个游标无效）。

现在，这就是我被抓住的地方。我做了一个简单的 HasCursor 接口，并且打算将一个带有 Cursor 的 List 传回给客户端——唯一的问题是 RequestFactory 只能处理从服务器到客户端的某些类型的传递——这种自定义类型不是其中之一。那么，现在使用 GWT RequestFactory - 有没有一种将 Objectify 游标从服务器传递到客户端的好方法？

另外-我遇到的另一个问题-如果我用这些数据填充DataGrid，它会在网格中显示数据很好-但就是这样-寻呼机说25个中有1-25个。所以，我想知道的是，您实际上如何告诉 DataGrid 服务器上有更多可用数据。我有点困惑，因为似乎没有很多可用的文档/示例。

非常感谢

* * *

对于遇到此问题的其他任何人，我找到了其中一部分的答案-我忘记了所有有关 ValueProxies 的信息，它允许您映射标准 Java bean 以使用 RequestFactory 从服务器返回到客户端。

不幸的是，您不能将泛型与 ValueProxies 一起使用，因此我必须为每个单独的类型创建一个 ListCursor 包装器。

这是代理：

```
@ProxyFor(value = VenueListCursorWrapper.class)
public interface VenueListCursorWrapperProxy extends ValueProxy {

  List<VenueProxy> getVenues();

  String getCursor();

  boolean isMoreAvailable();

  void setVenues(List<VenueProxy> venues);

  void setCursor(String cursor);

  void setMoreAvailable(boolean moreAvailable);
} 
```

这是服务器上的更新方法：

```
public VenueListCursorWrapper findPage(Subject subject, Objectify ofy, int pageSize, String cursor) {
  final Business business = (Business) subject.getSession().getAttribute(BUSINESS_ATTRIBUTE);
  final Query<Venue> query = ofy.query(Venue.class).filter(BUSINESS_ATTRIBUTE, business);
  if (cursor != null) {
    query.startCursor(Cursor.fromWebSafeString(cursor));
  }
  final QueryResultIterator<Key<Venue>> iterator = query.fetchKeys().iterator();
  final List<Key<Venue>> data = new ArrayList<Key<Venue>>(pageSize);
  boolean more = false;
  for (int i = 0; i < pageSize && (more = iterator.hasNext()); i++) {
    data.add(iterator.next());
  }
  return new VenueListCursorWrapper(get(ofy, data), iterator.getCursor().toWebSafeString(), more);
} 
```

所以 - 这就是它的一部分 - 我还没有完全弄清楚如何做的一件事是正确设置寻呼机 - 我想显示寻呼机中的项目总数，以便您翻阅它但我还不确定如何做到这一点 - 如果我找到解决方案，我会发布它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:23:16.980

您可以转换`Cursor`为可序列化的字符串 - 实际上您已经使用了这个：`iterator.getCursor().toWebSafeString()`.

只需将序列化的游标（= 一个字符串）连同所有其他列表数据一起返回给客户端，并在下一个请求中将其作为参数提供。

Optonaly 在[片段标识符](http://en.wikipedia.org/wiki/Fragment_identifier)（又名[GWT 历史令牌](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsHistory#tokens)）中使用它，以便用户实际上可以为列表中的特定页面添加书签（取决于用例，如果列表数据没有太大变化则有意义）。

# facebook - 制作新广告素材

> ID：11058746
> 
> 赞同：0
> 
> 时间：2012-06-15T22:02:23.400
> 
> 标签：facebook, facebook-graph-api, curl, facebook-ads-api

我正在努力创建一个新的广告素材。我发布的网址是：

```
https://graph.facebook.com/act_________/adgroups?max_bid=1&name=asdfadf&campaign_id=_________&targeting={"action_spec_friend":[{"action.type":"like","object":"adjfadf"},{"action.type":"post","object":"adjfadf"}],"countries":["US"]}&redownload=1&bid_type=1&creative={"action_spec":{"action.type":"like","object":"adjfadf"},"title":"asdfadf","type":25} 
```

但它似乎无法识别这种格式。`-d`在文档中，在 cURL 中使用与在使用时之间似乎存在一些区别`-F`，我认为这可能与我的问题有关。

我可以使用以下网址创建一个广告系列：

```
https://graph.facebook.com/act________/adcampaigns?end_time=1339819200&daily_budget=10000&name=Test Campain 2&redownload=1&campaign_status=1 
```

但我无法通过 API 向其中添加广告素材。

有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T11:55:46.273

> 在 cURL 中使用 -d 与使用 -F 之间似乎存在一些区别，我认为这可能与我的问题有关。

-d 以*application/x-www-form-urlencoded 形式*发送数据，而 -F 以*multipart/form-data 形式*发送数据。

根据您的问题，我猜您无法使用 cURL(?) - 但我找不到任何信息您在哪种系统/环境下开发。请使用该信息更新您的问题，也许我们将能够找出另一种方法来组合正确的请求。

# php - 通过数组计算整体和部门排名

> ID：11058754
> 
> 赞同：0
> 
> 时间：2012-06-15T22:03:12.230
> 
> 标签：php, mysql, arrays, ranking

[这是在 PHP 中迭代 MySQL 结果时检测未来重复值](https://stackoverflow.com/questions/10855462/detect-future-duplicate-values-while-iterating-through-mysql-results-in-php)的后续行动。

我有一个产生结果的 SQL 查询：

```
team_id   division_id   wins
-------------------------------
10        2             44
9         2             42
5         1             42
2         1             42
3         1             41
11        2             40
1         1             36
8         2             31
7         2             29
12        2             24
4         1             20
6         1             18 
```

我正在尝试计算给定团队的**整体**和**分区排名**。

例如，**team_id = 1**：

```
Overall:       7
Divisional:    4 
```

对于**team_id = 3**：

```
Overall:       5
Divisional:    3 
```

对于**team_id = 9**：

```
Overall:     T-2  //must indicate tie
Divisional:    2 
```

正如您从链接的先前问题/答案中看到的那样，我可以很好地计算总体排名。计算分区排名也存在问题（包括正确处理平局）。

我尝试将结果存储在一个多维数组`$arr['wins']['division_id']['team_id']`中，例如...

```
44 =>  2 => 10
42 =>  1 =>  5
             2
       2 =>  9
41 =>  1 =>  3
40 => 11 =>  2
... 
```

但是对于如何迭代并获得我的两个各自的排名，*以及为每个*.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:42:33.740

尝试这样的事情：

```
// Dataset as defined on question
$arr = array(
array('team_id' => 10, 'division_id' => 2, 'wins' => 44),
array('team_id' => 9, 'division_id' => 2, 'wins' => 42),
array('team_id' => 5, 'division_id' => 1, 'wins' => 42),
array('team_id' => 2, 'division_id' => 1, 'wins' => 42),
array('team_id' => 3, 'division_id' => 1, 'wins' => 41),
array('team_id' => 11, 'division_id' => 2, 'wins' => 40),
array('team_id' => 1, 'division_id' => 1, 'wins' => 36),
array('team_id' => 8, 'division_id' => 2, 'wins' => 31),
array('team_id' => 7, 'division_id' => 2, 'wins' => 29),
array('team_id' => 12, 'division_id' => 2, 'wins' => 24),
array('team_id' => 4, 'division_id' => 1, 'wins' => 20),
array('team_id' => 6, 'division_id' => 1, 'wins' => 18));

$divisionTeam = array();
$divisionWins = array();
foreach($arr as $team) {
    $divisionTeam[$team['division_id']][] = $team['team_id'];
    $divisionWins[$team['division_id']][] = $team['wins'];
}

echo "<pre>";
foreach (array_keys($divisionTeam) as $division_id) {
    $rank = 0;
    $prevWins = -1;
    echo "DIVISION $division_id \n";
    foreach ($divisionTeam[$division_id] as $index => $team_id) {

       if ($prevWins == $divisionWins[$division_id][$index]) {
           echo $team_id . " T - " . $rank . "\n";
       }
       else { 
           $rank++;
           echo $team_id . " " . $rank . "\n";
       }
       $prevWins = $divisionWins[$division_id][$index];

    }
}
echo "</pre>"; 
```

# php - codginiter（CI）中_pre（）方法的用途是什么

> ID：11058760
> 
> 赞同：3
> 
> 时间：2012-06-15T22:04:16.403
> 
> 标签：php, codeigniter

`_pre()`codginiter（CI）中方法的用途是什么：

```
 <?php 
      $x = array('hello', 'ram', 'shyam');
     _pre($x);    
     die;
 ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:06:16.800

这是在标签中输出数组的简写`<pre>`，尽管它可能是用户贡献而不是核心框架的一部分。

这里的功能基本上是：

```
function _pre($arr)
{
    echo '<pre>' . print_r($arr, true) . '</pre>';
} 
```

现在它将使用此格式输出您的数组...

```
Array
(
    [0] => hello
    [1] => ram
    [2] => shyam
) 
```

...而不是这种格式：

```
Array ( [0] => hello [1] => ram [2] => shyam ) 
```

# php - 获取 Wordpress 中所有可用的管理页面

> ID：11058763
> 
> 赞同：0
> 
> 时间：2012-06-15T22:04:32.683
> 
> 标签：php, wordpress, admin

我需要在 Wordpress 中创建一个包含所有可用管理页面的下拉列表：

```
Dashboard -> /wp-admin/index.php
Posts -> /wp-admin/edit.php
Media -> /wp-admin/upload.php
...
etc
... 
```

我可以手动完成，但我想获得具有一级菜单的特定插件链接：

```
My plugin -> /wp-admin/admin.php?page=my-plugin 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T09:48:49.147

该信息存储在全局变量`$menu`和`$submenu`变量中（当然，它们仅在管理屏幕中可用）。

查看[menu-header.php 中的 _wp_menu_output 函数，](http://core.trac.wordpress.org/browser/tags/3.4/wp-admin/menu-header.php#L36)了解 WordPress 如何使用它们。

您还需要考虑用户的权限。请参阅[_wp_menu_output](http://core.trac.wordpress.org/browser/tags/3.4/wp-admin/menu-header.php#L36)`current_user_can`中函数的用法。

# c++ - 为什么我可以分配对象数组但不能将它们放入向量中？

> ID：11058767
> 
> 赞同：0
> 
> 时间：2012-06-15T22:04:42.510
> 
> 标签：c++

我有一个类，我想包含我创建的多个对象。现在有效的代码是：

**进程.h：**

```
private:
  myObj *data; 
```

**进程.cc：**

```
data = new myObj[10]; 
```

但是，我想将值传递给构造函数，因此我尝试将其转换为 std::vector （在修改构造函数以获取值之后）。

**进程.h：**

```
private:
  std::vector<myObj> data; 
```

**进程.cc：**

```
for (int m=0; m<10; m++) data.push_back( myObj(1.2) ); 
```

当我尝试它在执行时崩溃

```
*** glibc detected *** ... corrupted double-linked list: ... *** 
```

当我尝试为我分配的其他数组释放一些内存时，gdb 中的回溯显示析构函数中的错误。搜索没有显示任何明显的东西。我在 中使用了一些静态成员变量`myObj`，这可能是个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T06:51:52.850

您遇到了双重删除错误。考虑这个简单的例子：

```
struct Other {};

struct MyObj {
    Other *p;

    MyObj () : p(new Other) {}
    ~MyObj () { delete p; }
};

std::vector<MyObj> data;

data.push_back(MyObj()); 
```

被推送到的临时对象被`data`正确存储。但是，由于它是临时的，因此在推送后立即销毁。这意味着，`p`当临时对象被销毁时，成员被删除，因此向量的副本版本有一个悬空指针。当vector对象被销毁时，指针会再次被删除，导致堆损坏。您收到的错误消息来自`glibc`抱怨导致错误状态的代码。

要解决此问题，应定义适当的复制构造函数，将对象的所有权从临时对象传递到目标对象。三的规则说我们也应该定义赋值运算符。

```
struct MyObj {
    mutable Other *p;

    MyObj () : p(new Other) {}
    MyObj (const MyObj &o) : p(o.p) { o.p = 0; }
    ~MyObj () { delete p; }
    const MyObj & operator = (MyObj o) {
        using namespace std;
        swap(*this, o);
        return *this;
    }
}; 
```

需要使用 mutable 才能`p`在实例为 时修改成员`const`，并且`const`因为临时对象被传递给复制构造函数而需要使用。通过此更改，将项目推入向量中可以正常工作。

更好的解决方案是定义`p`使用 a`unique_ptr`代替。

```
struct MyObj {
    std::unique_ptr<Other> p;

    MyObj () : p(new Other) {}
}; 
```

在这个例子中不需要析构函数，因为默认的析构函数会破坏 p，这会导致`Other`实例被 删除`unique_ptr`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-16T01:30:33.270

您正在尝试使用向量在一个类中存储多个对象？我也遇到了这个问题，我可以解决这个问题的唯一方法是将使用向量的函数放在标题中。我相信正在发生的事情是您为向量提供了一种类型，在本例中为 myObj，但 .cpp 无法看到您将向量定义为什么类型。因此，将函数粘贴在 Header 中似乎可以解决它。我相信还有其他方法可以解决这个问题，但我没有深入研究这个问题。

示例代码：

```
class A
{
 private:
 vector<myObj> data;
 public:
 A();
 ~A();

 printData()
 {
     for(int i = 0; i < data.size(); i++)
     {
         printf("X position: %.2f Y position: %.2f Z position: %.2f \n", data.at(i).x, data.at(i).y, data.at(i).z);
     }
 };
} 
```

这可能是问题所在，或者是您的命名约定。我不确定你在做什么，但 data *myObj; 和数据 = 新的 myObj[10]; 实际工作？不是 myObj = new data[10] 吗？如果是这样，那么您的向量将是：

```
vector<data> myObj; 
```

# html - Xpath - 寻找兄弟姐妹

> ID：11058768
> 
> 赞同：0
> 
> 时间：2012-06-15T22:04:43.983
> 
> 标签：html, xpath

我想在网站（它的 xpath）中找到某些节点的父节点和兄弟节点。我的大问题是我想找到一个节点的兄弟姐妹，没有 ID，只能通过它的属性。

例如： `<a id="nav-europe-3231" class="" href="/EUROPE/" title="Europe News Headlines and Video from CNN.com International">Europe</a>`

```
 <a id="nav-asia-1265" class="" href="/ASIA/" title="Asia News Headlines and Video from CNN.com International">Asia</a> 
```

我看到了一些指令，比如`parent::child-node`，但它没有以这种方式找到 xpath。

我怎样才能找到这个节点的父母和兄弟姐妹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:20:17.307

`preceding-sibling::`在 XPath 1 中，您可以通过and`following-sibling::`轴（对于同级）和或者`../`或`the`parent::` ax 找到上下文节点的同级和父级以查找父级。

请注意，对于轴，您必须在`::`. 如果您不知道，可以使用通配符`*`.

请参阅[http://www.w3schools.com/xpath/xpath_axes.asp](http://www.w3schools.com/xpath/xpath_axes.asp)

# css - 手写笔无法正确解析评论？

> ID：11058771
> 
> 赞同：0
> 
> 时间：2012-06-15T22:05:06.457
> 
> 标签：css, stylus

我有以下css文件：

```
/*!
 * http://meyerweb.com/eric/tools/css/reset/
 * v2.0 | 20110126
 * License: none (public domain)
 */
... 
```

但是，当我尝试解析它时，出现以下错误：

```
/usr/local/lib/node_modules/npm/node_modules/stylus/bin/stylus:502
              throw err;
                    ^
TypeError: reset.styl:2
   1| /*!
 > 2|  * http://meyerweb.com/eric/tools/css/reset/
   3|  * v2.0 | 20110126
   4|  * License: none (public domain)
   5|  */

Cannot read property 'name' of undefined 
```

我注意到手写笔也有其他被屏蔽的评论的问题（我只是删除这些评论以解决问题，但现在我需要弄清楚发生了什么）。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T15:34:53.363

显然我的编辑器正在创建 .styl 文件而不是文本，所以我更新了应用程序的文件类型关联，现在一切看起来都很好。

# php - createUrl Yii - 我们应该在控制器视图上调用它，还是无关紧要？

> ID：11058772
> 
> 赞同：1
> 
> 时间：2012-06-15T22:05:15.503
> 
> 标签：php, yii

应该在控制器或视图中调用 createUrl 吗？没关系？还是这很重要？

有我们应该遵循的规则吗？应该在控制器等上使用扩展 ccontroller 的方法等.. ?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T22:40:23.540

在 View 中，您可以使用此代码段。您可以在任何地方使用此代码段。

```
Yii::app()->createUrl(); 
```

但对我来说最好在控制器的操作中定义一个 url，并在视图中简单地使用 $some_url var。

```
class SomeController extends Controller
{
    public function actionSomeAction()
    {
        $params = array(
            'key1' => 'value1',
            'key2' => 'value2',
        );

        $myUrl = Yii::app()->createUrl('controller/action', $params);

        $this->render('some_action', array(
            'my_url' => $myUrl
        ));
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:56:59.277

两者都很好，当您在视图中时， $this 指的是当前控制器。所以你可以`$this->createUrl()`在控制器或视图中做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T07:54:17.687

您可以在视图中使用创建 url，它不会影响性能，因为它不使用任何数据库查询。创建 URL : Yii::app()->createUrl(); 创建绝对网址： Yii::app()->createAbsoluteUrl();

您可以使用 $this 在视图中使用此功能，例如 $this->createUrl();

# c# - Point/Point3D 到 TouchPoint？

> ID：11058775
> 
> 赞同：1
> 
> 时间：2012-06-15T22:06:01.880
> 
> 标签：c#, wpf, touch, touchscreen

我编写了一个使用鼠标的 C# 程序，它运行良好。我现在希望实现触摸支持。问题是我经常跟踪鼠标并在整个程序中使用 Point 和 Point3D 类。当我使用触摸时，我需要跟踪“鼠标”的移动位置。我可以得到触摸的坐标，但这就是我卡住的地方。我正在使用 Helix 3D Toolkit，大多数功能都需要 Point 或 Point3D 输入参数。我的问题是，有没有办法将 TouchPoint 转换为 Point 或 Point3D？或者有没有其他“简单”的方式来实现触摸支持？

这是我正在尝试做的一些代码：

```
private Point3D? GetPoints(TouchEventArgs e)
{
    var p = e.GetTouchPoint(ViewPort);
    var ray = Viewport3DHelper.Point2DtoRay3D(ViewPort.Viewport, p); //error here at p
    if (ray != null)
    {
        var pi = ray.PlaneIntersection(new Point3D(0, 0, 0), new Vector3D(0, 0, 1));
        if (pi.HasValue)
            return pi;
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T18:48:17.537

弄清楚了。我刚刚用 p.Bounds.X 和 p.Bounds.Y 创建了一个新的 Point()。

# javascript - 如何在 Jquery UI 中修复嵌套的可排序 div？

> ID：11058781
> 
> 赞同：0
> 
> 时间：2012-06-15T22:07:03.733
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-sortable

我正在尝试创建一个 UI，允许用户在 DOM 中获取一组窗口 div 并拖动它们，有时将 div 作为其他 div 的子级附加，有时将这些子级拉到父级。我有一个可行的示例，但是当您尝试将“叔叔” div 附加到“侄子” div 或反之亦然时，它非常敏感。嵌套 div 大约有 1px 的余地，如您在此 JSFiddle 中所见：http: [//jsfiddle.net/UdXr4/124/](http://jsfiddle.net/UdXr4/124/)。

如何“放松”灵敏度，以便在单击和拖动时移动到树中的下一个可排序对象不会那么快？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T13:34:27.603

我能够在很大程度上修复它。多亏了 Knockmeout.net 的 Ryan Niemeyer 的建议，通过在容器 div 上设置最小高度并添加一点填充以确保放置区域有目标，该问题在很大程度上得到了纠正。这是小提琴示例： http: [//jsfiddle.net/UdXr4/130/](http://jsfiddle.net/UdXr4/130/) 您将看到的唯一区别是带有填充和最小高度的排序修复类，可排序标签被归类为排序修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:14:15.370

您可能需要查看 snap、snapMode 和 snapTolerance。[请参阅此处的 API。](http://jqueryui.com/demos/draggable/)

# javascript - 如何定义名称等于字符串的javascript函数

> ID：11058783
> 
> 赞同：2
> 
> 时间：2012-06-15T22:07:20.317
> 
> 标签：javascript, metaprogramming

假设我有一个字符串，我想用该字符串的名称定义一个函数。我怎样才能做到这一点？

更新：

我忘了提到我不想将匿名函数设置为属性，因为我还想从函数内部动态获取函数的名称，即。`arguments.callee.name`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T22:08:51.037

像这样：

```
var functionName = "myfunction"
window[functionName] = function() {
    // your function here
} 
```

根据要求，也许这样的事情会起作用：

```
var myFunctionGenerator = function(name) {return function(message) {
    alert("hi, this is a function named '" + name + "'.  The parameter passed is '" + message + "'.");
}}

var myFunction = myFunctionGenerator('some function name');
myFunction('a parameter');
// hi, this is a function named 'some function name'.  The parameter passed is 'a parameter'. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:19:29.240

如果您声明函数，请使用`eval()`. 只需键入您尝试执行的参数的字符串表示形式，例如：

```
eval("function name(){alert('a');}"); 
```

然后，您可以按照正常约定调用该方法，`name();`.

如果您已经有了函数名称并想用字符串表示调用该函数，则可以使用该`eval()`方法，尽管它并不总是性能最佳。你会有这个：

```
var fnName = "functionName";
var params = "param1";
var fnNameWithParams = "functionName("+params+")";
eval(fnNameWithParams); 
```

更好的方法可能是：

```
var fnName = "functionName";
var params = "param1";
var fnToCall = window[fnName];
fnToCall(params); 
```

# ios - 仅获取“合并”核心图形路径的外部路径

> ID：11058785
> 
> 赞同：0
> 
> 时间：2012-06-15T22:07:51.917
> 
> 标签：ios, xcode, core-graphics, quartz-2d

我在 Core Graphics 中创建了一条路径来绘制心形，但是，为此我创建了一个菱形和 2 个圆圈，这个图像看起来很棒，但我只想知道是否有可能获得“实际”来自这个 CGPath/CGContext 的心形。

这是绘制心脏的代码（对于任何感兴趣的人），这个形状是我想要创建的形状，因为心脏“驼峰”和尖三角形之间的连接是平滑的：

```
CGPathAddEllipseInRect(heartPath, NULL, CGRectMake(0, 0, 20, 20));
CGPathAddEllipseInRect(heartPath, NULL, CGRectMake(20, 0, 20, 20));

CGPathMoveToPoint(heartPath, NULL, 37.5, 16.5);

CGPathAddLineToPoint(heartPath, NULL, 37.5, 16.5);
CGPathAddLineToPoint(heartPath, NULL, 20, 37.5);
CGPathAddLineToPoint(heartPath, NULL, 2.5, 16.5);
CGPathAddLineToPoint(heartPath, NULL, 20, 10);

CGPathCloseSubpath(heartPath); 
```

[产生这个](https://www.dropbox.com/s/2qtvger1xc8k1cz/iOS%20Simulator%20Screen%20shot%2016%20Jun%202012%2000.48.42.png)

而这段代码：

```
CGPathAddArc(heartPath, NULL, 10, 10, 10, M_PI, 0, false); // Left hump
CGPathAddArc(heartPath, NULL, 30, 10, 10, M_PI, 0, false); // Right hump
CGPathAddLineToPoint(heartPath, NULL, 20, 37.5); // Pointy end

CGPathCloseSubpath(heartPath); 
```

[产生这个](https://www.dropbox.com/s/2t7c3r9mrv02aoe/iOS%20Simulator%20Screen%20shot%2016%20Jun%202012%2000.48.04.png)

这是否可能且易于实施？如果有怎么办？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:44:09.790

没有公共函数可以计算多条路径的联合（据我所知，也没有任何私有函数）。计算贝塞尔路径的并集是一个困难而复杂的问题。

根据您想做什么，可能有更简单的方法。你想用联合路径做什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:50:39.740

您应该通过执行以下操作来绘制单个形状，而不是绘制 3 个不同的形状：

```
CGPathAddArc(heartPath, NULL, 10, 10, 10, M_PI, 0, false); // Left hump
CGPathAddArc(heartPath, NULL, 30, 10, 10, M_PI, 0, false); // Right hump
CGPathAddLineToPoint(heartPath, NULL, 20, 37.5); // Pointy end
CGPathCloseSubpath(heartPath); 
```

我不是肯定所有的值都是正确的，但基本上你只想画圆的一部分，所以使用`CGPathAddArc()`两次，然后在尖端画一条线，然后关闭它。

# shell - Shell 脚本 -x 标志含义

> ID：11058794
> 
> 赞同：3
> 
> 时间：2012-06-15T22:08:57.650
> 
> 标签：shell, if-statement, sh, flags

我有一个 #!/bin/sh 脚本，其中包含以下行：

```
if [ ! -x "$TEST_SLAPD" ] 
```

`$TEST_SLAPD`是 .bat 文件的完整路径。

我想知道该`-x`标志在该声明的上下文中意味着`if`什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-15T22:11:52.143

`if`只是检查它后面的命令的结果。`[`不是（至少不总是）操作员，它是称为“测试”的小实用程序。

从其文档中：

```
-x file
                             True if file exists and is  exe-
                             cutable.   True  indicates  only
                             that the execute flag is on.  If
                             file  is a directory, true indi-
                             cates that file can be searched. 
```

（是的，`!`显然是否定的）

对于类似的评估标志，文档可在此处获得：http: [//illumos.org/man/1/test](http://illumos.org/man/1/test)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T22:13:07.590

`! -x`条件意味着文件或目录没有为当前用户设置可执行位。该帮助对它也适用于目录这一事实不太清楚，但它说：

```
$ help test | fgrep -- '-x'
      -x FILE        True if the file is executable by you. 
```

# c++ - 如何从重载集中删除当前函数？

> ID：11058800
> 
> 赞同：1
> 
> 时间：2012-06-15T22:10:06.920
> 
> 标签：c++, argument-dependent-lookup

我的命名空间中有一个函数`ns::foo`，它的工作是调度`foo`使用参数相关查找的调用：

```
namespace ns
{

template<typename T>
void foo(T x)
{
  // call foo through ADL
  foo(x);
}

} 
```

我希望客户能够调用`foo`而无需手动实例化它，即：

```
bar x;
ns::foo(x); 
```

不是

```
ns::foo<bar>(x); 
```

当然，问题`ns::foo`是如果没有`foo`比更好的匹配，那就是递归的`ns::foo`。

我不想给`ns::foo`一个不同的名字，那么有什么办法可以将它从内部的重载集中删除？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T22:30:05.883

如果`foo`要分派的 to 不在`ns`命名空间中，那么这应该有效：

```
namespace helper
{
    template<typename T>
    void _foo(T x)
    {
        // call foo through ADL
        foo(x);
    }
}

namespace ns
{
    template<typename T>
    void foo(T x)
    {
      ::helper::_foo(x);
    }
} 
```

诀窍是对`foo`from的调用`_foo`不会考虑`ns::foo`，因为它不在依赖于参数的命名空间中。除非`x`碰巧的类型`ns`当然是 in，但是你*有*一个定义的递归。

**更新**：您必须将此代码放在以下定义*之后*`namespace ns`：

```
namespace ns
{
     //your useful stuff here
}
namespace helper { /* template _foo */ }
namespace ns { /* template foo */ } 
```

没有递归，因为该`helper::_foo`函数无法调用，`template foo`因为它仍未定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:25:43.827

如果你用一个额外的参数定义你的 ADL 函数，它会给它一个不同的类型签名，所以你不会有冲突。我在全局范围内定义了模板，但它也可以在`ns`范围内工作。

```
namespace ns
{
   class A {};
   class B {};
   void foo(A, int) { std::cout << "adl: fooA" << std::endl; }
   void foo(B, int) { std::cout << "adl: fooB" << std::endl; }
}

template <typename T>
void foo(T t) {
   foo(t, 0);
}

int main()
{
   ns::A a;
   ns::B b;
   foo(a);    //calls ns::foo
   foo(b);    //calls ns::foo
} 
```

# sql - SQL Server 2008 错误 18452 登录来自不受信任的域，不能用于 Windows 身份验证

> ID：11058803
> 
> 赞同：2
> 
> 时间：2012-06-15T22:10:25.107
> 
> 标签：sql, windows, sql-server-2008, active-directory, windows-authentication

我试图弄清楚发生了什么。这是我们的设置：我们有四个相互复制的 SQL 服务器。

我们将一个新用户添加到 Windows Active Directory，并将他们添加到我们已经使用多年的 SQL Server 中的组中。

新用户在尝试使用 Windows 身份验证进行身份验证时会在主题行中返回该错误。但是，以前在 Active Directory 中的任何用户都可以正常工作。

有一次，我让 SQL Server “赶上了”，因为我们有一组用户因为这个错误而无法登录。我对 SPN 进行了一些更改，最终使它没有人可以登录。然后我意识到 SPN 的外观并修复了它。然后我猜发生了一些神奇的事情，这些用户能够进行身份验证。我认为它已修复，但显然不是因为我们必须添加一个新用户并且他们无法进行身份验证。

有趣的是，用户可以使用四个 SQL Server 中的三个进行身份验证。只有这台服务器工作不正常。我在这个 sql server 上为 SQl Service 设置了两个 SPN。

他们看起来像 -

MSSQLSvc/[服务器名].[域].local:1433

MSSQLSvc/[服务器名]:1433

这些实际上已注册到我们用于 SQL Server 的服务帐户。有趣的是，我找不到在任何地方工作的服务器的 SPN。

任何帮助，将不胜感激！

编辑：另外，要注意的另一点是，如果我尝试将用户直接添加为 SQL 服务器的登录名。我右键单击登录并单击添加登录然后单击搜索。然后我输入 [Domain]\[Username] 并单击检查名称。它验证名称是否正确。然后我点击确定。然后再次确定，它给出了错误 Windows NT 用户或组 '[Domain]\[Username]' not found。再次检查名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T05:35:28.783

> 我认为它已修复，但显然不是因为我们必须添加一个新用户并且他们无法进行身份验证。

用户必须重新登录才能选择新组。否则，它的 kerberos 票证仍在其 PAC 中使用旧的组成员信息

> 这些实际上已注册到我们用于 SQL Server 的服务帐户。有趣的是，我找不到在任何地方工作的服务器的 SPN。

我认为发生的情况是您有一个正确设置 SPN 的 SQL Server，而其他三个根本没有设置 SPN 的 SQL Server。因此，您将在此特定服务器上使用 Kerberos，而在其他三个服务器上使用 NTLM。

如前所述，当您使用 Kerberos 时，您必须使用某些工具清除票证，或者您必须重新登录才能获得新的组成员身份。您也可以尝试锁定屏幕然后解锁。如果我没记错的话，这也应该刷新票。

与 Kerberos 不同，NTLM 不携带组 memberhsip 数据。在 SQL Server 使用 NTLM 对用户进行身份验证后，它将找到经过身份验证的用户的组成员身份，包括您刚刚添加的新组。

# linux - 将 JSP 作为 iframe 集成到 Joomla 中

> ID：11058804
> 
> 赞同：0
> 
> 时间：2012-06-15T22:10:35.750
> 
> 标签：linux, jsp, joomla, file-permissions, integrate

我有一个作为 UI 运行的 Joomla (nginx + mysql) 站点和一些 JSP (tomcat + mysql) 处理计算逻辑。

我想将 JSP 页面作为 iframe 集成到 Joomla 中。我成功地做到了，但问题是：

如何使 JSP 页面不能对公众访问，而只能通过 Joomla 站点访问？

例如，

Joomla 网站位于 mydomain.com/Joomla 下

JSP 页面位于 mydomain.com/JSP 下

当用户在浏览器中访问 mydomain.com/JSP 时，用户看不到 JSP 页面（而是看到错误或空白页面）。

但是，当用户在浏览器中打开 mydomain.com/Joomla 并转到 iframe 中包含 JSP 站点的页面时，用户可以在那里看到 JSP 页面。

我正在考虑更改文件夹/文件所有者和权限。我在正确的轨道上吗？我应该如何接近？

谢谢，

米洛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T17:45:18.630

你需要改变你目前的工作方式。

1）使用composent **JUMI**根据您的脚本创建虚拟Joomla组件。2）在每个页面上，在每个脚本的开头添加此代码：

```
<?php
defined( '_JEXEC' ) or die ('Restricted Access');
?> 
```

它会阻止用户在没有任何活动的 Joomla 会话的情况下直接加载您的脚本。

# redis - 在 Redis 中回收过期的密钥

> ID：11058805
> 
> 赞同：0
> 
> 时间：2012-06-15T22:11:06.067
> 
> 标签：redis

我正在尝试解决 Redis 中的以下问题。

我有一个包含各种可用键的列表：

```
List MASTER:
111A
222B
333C
444D
555E 
```

我希望能够从列表中弹出一个元素并将其用作具有过期时间的键。

到期后，我希望能够将此号码推回 MASTER 以供将来使用。我没有看到任何明显的方法可以做到这一点，所以我正在征求一个有创意的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:20:03.357

最好的方法是在密钥过期时被 Redis 回调，然后采取行动。但是，回调支持仍有待添加（http://code.google.com/p/redis/issues/detail?id=360）。您可以使用包含自定义/社区修改的 Redis 版本来支持此功能（就像我发布的链接中的最后一个），或者更糟:)：开始跟踪客户端应用程序中的键和超时。

# perl - 使用 Perl 从文件中读取

> ID：11058809
> 
> 赞同：1
> 
> 时间：2012-06-15T22:11:42.127
> 
> 标签：perl

我正在学习 Perl 并且已经查看了这个问题，但是尽管它没有错误地终止，但无法让它为我工作。

我输入了一个它应该想要的文件（`name-0-0-0`），但它只是`while`完全跳过了循环。

```
open FILE, '+>>userinfo.txt';
print("What is your name?");
$name = <>;
chomp $name;

while (<FILE>) {

chomp;
($nameRead,$wins, $losses, $cats) = split("-");

if ($nameRead eq $name){
    print("Oh hello $name, your current record is $wins wins - $losses losses - $cats ties");
    print("Would you like to play again? type y for yes or n for no\n");
    $bool = <>;
    if ($bool == "y"){
        print("Okay let's play!");
        play();
        exit();
    }
    else {
        printf("well fine goodbye!");
        exit();
    }

} 
```

}

好吧，看来我的问题确实与+>>有关。我正在尝试添加到文件中，但我希望能够写入，而不仅仅是追加。我将其更改为 +< 并且一切正常。谢谢你们，我真的很感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T22:33:14.087

我似乎使用错误的语法打开文件进行阅读。尝试

```
use autodie qw(:all);
open my $FILE, '<', '/path/to/file'; 
```

您使用的语法会打开一个文件以进行附加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T22:34:02.840

您的主要问题是您为 选择了一种神秘的打开模式`userinfo.txt`，这将允许您打开现有文件进行读写，但如果它不存在则创建一个新文件。

您必须*始终*检查文件打开是否成功，并且看起来您想要做的只是从该文件中读取，所以您想要

```
open FILE, '<', 'userinfo.txt' or die $!; 
```

您还必须*始终*添加

```
use strict;
use warnings; 
```

到程序的顶部，并`my`在第一个使用点声明所有变量。

进行这些更改后，您很可能会了解自己出了什么问题，但是如果您还有其他问题，请发布修改后的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:23:39.763

以下内容表示您正在阅读文件并且尚未到达文件末尾：

```
while (<FILE>) {
   ...
} 
```

您可能希望完全删除 while 循环，并在其中执行所有操作。

* * *

### 编辑/替代解决方案：

没有发生任何事情的真正原因是，当您使用 时`+>>`，它会按照您的预期打开文件以供读取/追加，但它会立即将光标设置在文件末尾。这样当你遇到的`while (<FILE>) { ... }`时候就没有什么可读的了。

一种解决方案是重置文件光标位置：

```
open FILE, '+>>userinfo.txt';
seek(FILE,0,0);                 # set the file cursor at the top 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T22:35:15.790

为什么要以`+>>`模式打开文件？该模式打开您的文件进行输入和输出，但将文件句柄光标设置为文件末尾。即使是经验丰富的 Perl 程序员也很少需要这样做。

由于文件句柄在您打开文件时位于文件的末尾，因此当您尝试从中读取时将不会得到任何东西。

你有理由不只是说`open FILE, '<', 'userinfo.txt'`吗？

# jquery - 验证 CSS 属性的多个输入

> ID：11058810
> 
> 赞同：1
> 
> 时间：2012-06-15T22:11:44.343
> 
> 标签：jquery, css, validation, input

我的页面上有多个输入字段。输入无效数据时，我用 CSS 红色边框对它们进行正则表达式。

在将数据插入数据库之前，我想一次简单地检查该类的所有输入字段。以下是我的想法，但失败了。

```
if($('input').css("border") == "2px solid red"){//1 or more red borders to flag
    alert('yes');
}else{
    alert('no'); // there are no red borders in all inputs 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T22:12:49.663

我不会检查你的 CSS 类...

在提交之前重新运行您的验证功能。用它来检查一切是否正常。另外，不要忘记验证服务器端！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:34:57.210

如果您想为所有一组输入添加红色边框，您可以这样做

```
$("input").css('border','1px solid red'); 
```

否则，如果你想通过 jquery 检查输入是否有类，你可以使用 .hasClass 方法。

假设您有一个名为 validate() 的 validate 函数，它将在执行时返回 false 或 true 以及具有特定类的特定输入组

```
<input class="validate" type="text" />
<input class="validate" type="text" />  

$(".validate").each(function(){
 if(  !validate( $(this).val() ) ){
 $(this).css('border','1px solid red'); //add red border
 $(this).focus(); //focus the element
 alert("you didn't pass the validation"); //alert message error
 return false; //stops the loop
} 
```

});

这将使用 validate 类检查所有输入，并将显示不满足验证功能的输入的错误消息

# ubuntu - wget不工作

> ID：11058811
> 
> 赞同：13
> 
> 时间：2012-06-15T22:11:44.440
> 
> 标签：ubuntu

在 Ubuntu 上，我正在尝试使用 wget 下载文件（从脚本）。构建一个程序以每天下载此文件并加载到 hadoop 集群。

但是，wget 失败，并显示以下消息。

```
wget http://www.nseindia.com/content/historical/EQUITIES/2012/JUN/cm15JUN2012bhav.csv.zip
--2012-06-16 03:37:30--  http://www.nseindia.com/content/historical/EQUITIES/2012/JUN/cm15JUN2012bhav.csv.zip
Resolving www.nseindia.com... 122.178.225.48, 122.178.225.18
Connecting to www.nseindia.com|122.178.225.48|:80... connected.
HTTP request sent, awaiting response... 403 Forbidden
2012-06-16 03:37:30 ERROR 403: Forbidden. 
```

当我在 Firefox 或同等软件中尝试相同的 url 时，它工作得很好。是的，没有涉及许可协议之类的事情......

我错过了关于 wget 的一些基本知识吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-15T22:17:25.867

该站点阻止 wget，因为默认情况下 wget 使用不常见的用户代理。要在 wget 中使用不同的用户代理，请尝试：

```
wget -U Mozilla/5.0 http://www.nseindia.com/content/historical/EQUITIES/2012/JUN/cm15JUN2012bhav.csv.zip 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-15T22:13:29.910

利用：

```
wget -U mozilla http://www.nseindia.com/content/historical/EQUITIES/2012/JUN/cm15JUN2012bhav.csv.zip 
```

一些站点只是阻止 wget 用户代理下载文件。我刚刚用这个命令下载了那个文件。有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-14T07:54:47.750

我使用`curl -O <URL>`wget 是因为 wget 不支持 HTTPS 和其他一些协议。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T00:36:18.283

webapps 或 webservers 可能使用的另一种技术是检查“Referrer”内容标头值。除了指定用户代理之外，可能还需要提供引荐来源网址。

例如，

```
wget --referer http://freestockphotos.com/Scenery1.html http://freestockphotos.com/SKY/TreeSunset.jpg 
```

如果从“Scenery1.html”页面导航时未发出对目标文件的请求，该主机似乎会拒绝这些请求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-19T05:41:09.313

有些网站只是阻止 wget 用户代理下载文件 wget -U 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.6) Gecko/20070802 SeaMonkey/1.1.4' [http://yourURL .com](http://yourURL.com)

# android - 在 Android 2.x 中使用 Apache Cordova/PhoneGap

> ID：11058816
> 
> 赞同：2
> 
> 时间：2012-06-15T22:12:05.730
> 
> 标签：android, cordova

似乎无法为 Android 2.x 创建 PhoneGap 应用程序。那正确吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-16T09:42:37.783

对于使用 phonegap 运行 android 应用程序，将您的应用程序构建为 Android 4.0.3，并将最低版本设置为任何您想要的较低版本。基本上 Android 4.0.3 build 不会影响旧 android 版本的功能。这个应用程序完美适用于 android 较低版本。

我通常在 manifest.xml 中这样做

```
<uses-sdk android:minSdkVersion="7" android:targetSdkVersion="15"/> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T22:51:14.730

好的 - 所以回答我自己的问题。您需要安装 Android API 标记 15 才能使 PhoneGap 正常工作。

但 。. . 您可以更改应用程序中的 AndroidManifest.xml 文件以使其向后兼容。

例如

```
<uses-sdk android:minSdkVersion="10" /> 
```

将与 2.3.3 兼容

# java - 将 Maven 项目添加到 Eclipse 编译的项目中

> ID：11058820
> 
> 赞同：0
> 
> 时间：2012-06-15T22:12:40.150
> 
> 标签：java, eclipse, maven

我正在尝试将`docx4java`我从 svn 签出的 Maven 项目（称为）中的 java 代码添加到现有的 Eclipse 项目（称为`DocumentManager`）中。我已经尝试过我认为可行的正常方式，即：

右键单击`eclipse project>Properties>Java Build Paths> Projects > Add`（这里我添加了 Maven 项目）和`>Libraries`（这里我指定了本地库位置，例如`docx4/trunk/docx4/src/`），但我仍然无法在 Eclipse 中识别“Maven”类。我收到消息

```
import docx4j.src.main.java.org.docx4j.convert.out.flatOpcXml.FlatOpcXmlCreator cannot be resolved 
```

我已经尝试添加一个在 Eclipse 中编译的测试项目并且工作正常，Eclipse 似乎可以识别它，即`import org.me.TestProject`工作正常。

如何从 Maven 项目中获取代码`docx4java`以在 Eclipse 编译项目中工作`DocumentManager`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:23:59.740

[您可以使用 maven eclipse 插件](http://maven.apache.org/plugins/maven-eclipse-plugin/)生成 eclipse 项目文件（您可以将其导入您的工作区）

看看[这些 ecplise 插件](http://maven.apache.org/eclipse-plugin.html)，以便更直接地将 maven 集成到 eclipse 中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T08:46:48.330

似乎源路径配置不正确，这就是编译器找不到您的“Maven 类”的原因。

> docx4java.src.main.java...

Maven 有不同的目录结构，你必须告诉 Eclipse 在哪里可以找到你的源代码。

对于“vanilla”eclipse 项目，删除[标准 eclipse 构建路径](http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.cdt.doc.user/tasks/cdt_t_proj_paths.htm) *src*并添加 maven 源路径*src/main/java*（或添加代码的任何位置），编译器应该正确选择您的源。

请注意，您仍然必须添加 maven pom.xml 文件的依赖项部分中提到的所有 jar。否则它不会编译，即使它找到了你添加的 java 类。

（附录：我建议在您现有的项目中也使用 maven。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:31:55.573

正如@Attila 评论的那样，您应该为 docx4java 创建一个 Eclipse 项目。完成后，您的工作区中应该有两个项目：docx4java 和 DocumentManager。此时，您现在所做的（将项目引用添加到 Java 构建路径）应该可以工作了。

# java - 如何处理公共抽象布尔响应

> ID：11058825
> 
> 赞同：0
> 
> 时间：2012-06-15T22:13:03.360
> 
> 标签：java, android, boolean, response, handle

像 SO 上的许多提问者一样，我对 java 比较陌生，并试图自学 android 编程并取得了一些不错的成功。我敢肯定，这对于具有该主题实际知识的人来说是微不足道的。我正在开发一个应用程序，它试图从网络上获取数据，如果你得到数据就“返回真”，如果没有，就“返回假”。当它返回 false 但不知道如何正确处理响应时，我想做一些事情。现在，我只是忽略响应，什么也不做。有什么帮助吗？

```
 public void onBackPressed() {
        Someclass.getinfo().maybeShowInfo(this);
        finish();
    } 
```

我想做的是（在伪代码中）

```
 public void onBackPressed() {
        Someclass.getinfo().maybeShowInfo(this);
        // if false is returned
            // do something
            // else
            // finish();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:18:08.337

```
public void onBackPressed() {
    boolean result = Someclass.getinfo().maybeShowInfo(this);
    if (result) {
        finish();
    } else {
//      do something else
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:17:22.217

在我看来，您将两个必须分开的东西结合在一起。通过两个类进行获取数据和显示两种方法。

```
private InfoDao infoDao; // This is a class that gets the data; it's a member of the class with the onBackPressed() method

public void onBackPressed() {
    Info info = this.infoDao.find();
    if (info != null) {
        displayInfo();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:27:23.357

```
public void onBackPressed()   
{
    boolean result = Someclass.getinfo().maybeShowInfo(this);
    if (result = false) 
    {
        //do work for false response;
    } 
    else 
    {
        finish();
    }
} 
```

不要忘记，如果成功，则必须使 Someclass.getinfo() 返回 true，否则返回 false。

# mysql - Ruby mysql gem 错误

> ID：11058828
> 
> 赞同：1
> 
> 时间：2012-06-15T22:13:20.723
> 
> 标签：mysql, ruby-on-rails, ruby, ruby-on-rails-3

我已经安装了 mysql gem，但遇到了第一个障碍：

```
 initialize': wrong number of arguments(4 for 0) (ArgumentError)
 from open.rb:14:in `new' 
 from open.rb:14:in `<main>' 
```

是这段代码的结果：

```
 require 'mysql'

 db = Mysql.new('localhost','root','','test')
 puts db 
```

我正在关注本教程中的代码：

[http://rubylearning.com/satishtalim/ruby_mysql_tutorial.html](http://rubylearning.com/satishtalim/ruby_mysql_tutorial.html)

看起来新方法不会接受 4 个参数。我不知道为什么。Mysql.new 创建一个新对象就好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:46:27.140

使用 Mysql2 gem：

```
gem install mysql2 
```

然后：

```
require 'mysql2'
client = Mysql2::Client.new(:host => "localhost", :username => "root")
results = client.query("show databases")
results.each do |row|
  puts row["Database"]
end 
```

[您可以在gem 文档](http://rubydoc.info/gems/mysql2/0.3.11/frames)中找到更多信息

！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:25:03.937

第 14 行是您声明的行`db = Mysql.new('localhost','root','','test')`吗？

我刚刚打开`irb`，安装了 gem，复制了你的行，它工作得很好——它按预期返回了一个 Mysql 对象。

你可以尝试通过做同样的事情`irb`吗？顺便说一句，我建议您改为安装`mysql2`gem。这是一个关于原因的解释：[mysql和mysql2 gem有什么区别](https://stackoverflow.com/questions/5411551/what-the-difference-between-mysql-and-mysql2-gem)

# android - android上的线程转储

> ID：11058834
> 
> 赞同：0
> 
> 时间：2012-06-15T22:14:06.917
> 
> 标签：android, multithreading

我正在android上开发一个android应用程序。我是否可以（通过 DDMS 或 adb shell）对我的应用程序的所有线程进行线程转储？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:50:12.873

除了 ddms 支持之外，您还可以通过 adb shell 运行

```
ps -t 
```

或者

```
top -t 
```

虽然大多数 android shell 命令是原始的并且只采用标准选项的一个子集，但 top 似乎有一些内置的帮助，当给出错误的选项时它会打印出来，ps 没有，但幸运的是它的源代码可供检查。

# javascript - 在 CoffeeScript 类中装饰函数

> ID：11058836
> 
> 赞同：3
> 
> 时间：2012-06-15T22:14:21.393
> 
> 标签：javascript, backbone.js, coffeescript, decorator

我正在编写一个主干应用程序，我想编写一个经过身份验证的装饰器，我可以用它来装饰路由器类中的方法（路由）列表。

所以我有一个带有几种方法的路由器，并尝试过类似的方法。但是，当我调用我想要装饰的路线时，装饰器没有附加。

```
class MyApp extends Backbone.Router

  routes: 
    ''         : 'home'
    'foo'      : 'foo'
    'bar'      : 'bar'

  authenticated: ['foo', 'bar'] 

  initialize: ->
    @decorateAuthenticatedFunctions()      

  decorateAuthenticatedFunctions: => 
    _.each @authenticated, (method)=>
      @[method] = (args)=>
        if @authorized()
          @[method].apply @, args
        else
        @navigate '', true

  authorized: =>
    @user? and @user.loggedIn 

  foo: =>
    #do stuff

  bar: =>
    #do stuff 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T22:50:15.967

你有几个问题。

首先，我认为不会`initialize`因为某种原因而被调用。我可以说，因为如果它被调用，那么它会引发错误（见下一点）。现在我不是骨干专家，但也许尝试使用构造函数？

```
class MyApp extends Backbone.Router
  constructor: ->
    super
    @decorateAuthenticatedFunctions() 
```

其次，该循环不起作用。您将替换`@[method]`为一个新函数，该`@[method]`函数在该函数中调用。当它成功时，你会得到一个递归的无限函数调用。所以保存对原始函数的引用，然后使用装饰器函数调用该引用。

当你在那里时，不需要下划线，因为咖啡脚本循环非常好。而且你甚至根本不需要这个循环的闭包，因为你只是立即使用循环值。

这个稍微改变的非主干版本有效：

[http://jsfiddle.net/ybuvH/2/](http://jsfiddle.net/ybuvH/2/)

```
class MyApp

  authenticated: ['foo', 'bar'] 

  constructor: ->
    @decorateAuthenticatedFunctions()      

  decorateAuthenticatedFunctions: =>
    for method in @authenticated
      fn = @[method]
      @[method] = (args) =>
        if @authorized()
          fn.apply @, args
        else
          console.log 'denied'

  authorized: =>
    @user? and @user.loggedIn 

  foo: =>
    console.log 'foo'

  bar: =>
    console.log 'bar'

app = new MyApp

app.user = { loggedIn: no }
app.foo() # denied
app.bar() # denied

app.user = { loggedIn: yes }
app.foo() # foo
app.bar() # bar​ 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:37:32.000

我认为您遇到了`this`上下文问题。

请记住，“胖箭头”`=>`绑定到`this`at 函数定义时间。因此，当您想将其绑定到您的实例时，您`decorateAuthenticatedFunctions: =>`将绑定到 global 。`this``MyApp`

尝试这个：

```
...

initialize: ->
  @decorateAuthenticatedFunctions.call(@) # Call with proper context

decorateAuthenticatedFunctions: ->    # Use skinny arrow
  _.each @authenticated, (method)=>
    @[method] = (args)=>
      if @authorized()
        @[method].apply @, args
      else
      @navigate '', true

authorized: ->                        # Use skinny arrow
  @user? and @user.loggedIn 

... 
```

# google-apps-script - 将已发布的应用程序脚本从电子表格插入页面已停止工作

> ID：11058838
> 
> 赞同：1
> 
> 时间：2012-06-15T22:14:40.003
> 
> 标签：google-apps-script, google-sheets, google-sites

我一直在从电子表格发布脚本，获取 url，将其粘贴到插入应用程序脚本小工具对话框中，并将“文档”更改为“站点”有一段时间了，除了今天之外，我一直非常成功。GAS、Google 电子表格和 Google 协作平台之间是否发生了最近停止此过程的变化？

2012 年 6 月 18 日更新

回应评论：

根据彼得的评论，网址更改确实影响了该过程。但更改并不特定于此处发布的问题。所有讨论都包含仅基于“站点”的 url，并且不讨论包含无法与 Apps 脚本小工具一起使用的“文档”的电子表格中发布的 url。问题中发布的过程不是一个稳定的过程，如果发生变化，这反过来又不可靠。因此，为了将电子表格中的 Apps 脚本用作 Google 协作平台上的服务，可能需要找到一种新的“解决方法”。

真正发布的电子表格脚本网址应该与 Google 协作平台一起使用，就像 Google 协作平台脚本网址一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T21:07:25.327

这可能与 URL 格式的最近更改有关。请为这个[未解决的问题](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1415)加注星标以获取更新。

# python - 是否可以使用 TastyPie 对 ToManyField 属性中的元素进行排序？

> ID：11058839
> 
> 赞同：2
> 
> 时间：2012-06-15T22:14:47.647
> 
> 标签：python, django, rest, tastypie

我有一个使用 Django Tastypie 的 REST API。给定以下代码

模型

```
class BlogPost(models.Model):
    # class body omitted, it has a content and an author

class Comment(models.Model):
    blog_post = models.ForeignKey(BlogPost, related_name="comments")
    published = models.DateTimeField()
    # rest of class omitted 
```

资源

```
class CommentResource:
    # omitted

class BlogPostResource(ModelResource):

    comments = fields.ToManyField("resources.CommentResource",
        attribute="comments") 
```

当我要求一篇博文时，我得到了类似的信息：

```
GET: api/blogpost/4/

{
   'content' : "....",
   'author' : "....",
   'comments' : ['api/comment/4/', 'api/comment/5']
} 
```

但是，评论不一定按任何字段排序。我想确保它们按特定键（`published`）排序

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T22:32:57.843

我设法通过将字段更改`BlogPostResource`为以下内容来解决问题：

```
class BlogPostResource(ModelResource):

    comments = fields.ToManyField("resources.CommentResource",
        attribute=lambda bundle: bundle.obj.comments.all().order_by("published")) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-30T00:28:19.730

您也可以尝试在实际的评论模型中添加排序（而不是在美味的评论模型资源中）：

```
class Comment(models.Model):
    blog_post = models.ForeignKey(BlogPost, related_name="comments")
    published = models.DateTimeField()

    class Meta:
        ordering = ['published'] 
```

# config - 当akka config没有指定变量时如何指定默认值？

> ID：11058845
> 
> 赞同：1
> 
> 时间：2012-06-15T22:15:19.537
> 
> 标签：config, akka

Akka 1.3 能够查找配置变量，并返回一个选项，因此可以指定默认值。

Akka 2.0 没有这个。那么如何检查变量是否存在，如果未定义则指定默认值？

例子：

在 1.3 中：config.getString("myvariable", "mydefault") // 默认指定

在 2.0 中： GlobalActorSystem.settings.config.getString("myvariable") //无法指定默认值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T14:24:05.967

您不应该将默认值放在代码中，而是将默认值放在 jar 的 /resources 文件夹中的 reference.conf 中。在此处阅读有关 Typesafe Config 项目的信息：[https ://github.com/typesafehub/config](https://github.com/typesafehub/config)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T14:25:02.083

您可以使用`config.hasPath`查明是否已指定设置。但我建议仅在您想为省略设置附加特殊含义的情况下使用。如果您只想拥有一个默认值，`reference.conf`请在包含该值的项目（在 JAR 的根目录）中包含一个。

# css - 网站布局在旧版本的 IE 上无法正常工作 - 在 IE9、FF 13 和 chrome 上工作正常

> ID：11058851
> 
> 赞同：-3
> 
> 时间：2012-06-15T22:16:27.437
> 
> 标签：css, internet-explorer, cross-browser

我已经创建了我的第一个站点并投入了大量时间，但我很困惑我已经在浏览器上测试了该站点

IE9 铬 19.0.1084.56 m 火狐 13.0

我的布局都适合我

在检查以前的浏览器（如 IE8、IE7 等）时，我的菜单上的按钮甚至没有正确显示，我有一个图像作为按钮，顶部有一个翻转图像。

它们要么一半显示底层图像，要么根本不显示，然后单击一半消失等。

我真的很想从那里有经验的人那里得到一些帮助，让我知道在我的网站上做的最好的事情。

它与图形的大小等有关吗？或者我为翻转按钮完成 CSS 编码的方式？

任何帮助将不胜感激。

对不起，我是初学者，但我已经尝试学习我能做的，并观看了数百个 youtube 视频和网站教程......所以我不确定我哪里出错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:47:37.730

如果您使用的是 HTML5，那么旧版本的 IE 将会出现严重问题。要解决这些问题，请将这些代码行添加到每个网页的结束标记之前：

```
<!--[if lt IE 9]>
     <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:23:24.383

在 style.css 的第 148 行，您`.`在类选择器上缺少 a`menu li a:visited`应该是`.menu li a:visited`. 如果无法解析，某些浏览器可能会完全放弃该规则。仔细检查你的 CSS。

由于您使用的是 html5 shiv，因此并不真正相关，但值得一提：

*此外，您正在使用`section`元素并依赖它们来设置样式。这些来自 HTML5，因此某些浏览器无法识别它们，因此不会应用您的 css。如果您想支持旧版浏览器（以及任何不支持某些 HTML5 元素的新浏览器），请改用 DIV 或其他元素作为容器。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:26:57.227

因此，您使用 HTML5 标签，您必须为 IE8添加[http://code.google.com/p/html5shiv/ -](http://code.google.com/p/html5shiv/)

你也有一些 JS 错误。

# asp.net-mvc - 在 ASP.NET MVC 中的选择列表上使用 HTML.Encode

> ID：11058852
> 
> 赞同：1
> 
> 时间：2012-06-15T22:16:44.577
> 
> 标签：asp.net-mvc, asp.net-mvc-2, encoding

在我的 ASP.NET MVC 应用程序中，我使用选择列表控件为多选小部件生成列表：

```
<%=Html.ListBoxFor( m => m.Product.Name, 
           new SelectList( 
               Model.Products.Where( 
               s => !Model.Product.Any( 
                   t => t.Id == s.Id.Value 
                   ) ).OrderBy( t => t.Name ), "Id", "Name", 
                   new { multiselect = "multiselect", @class = "fancySelect products"}     ) ) %> 
```

这将生成一个项目列表。问题是其中一些需要编码：

```
 <span>C&#333;netic&trade; Technology</span> 
```

如果我使用简单的 response.write 将这个项目直接呈现到 UI，我会看到：

```
<p class="c">Cōnetic&trade; Technology</p> 
```

我将如何将 Html.Encode 集成到我的选择列表语句中以产生相同的编码结果？还是有更好的编码方法可以在全局范围内影响选择列表？

这是 MVC 2 顺便说一句，所以没有剃刀。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:31:12.450

您需要在显示之前对数据进行编码，并且它应该按预期呈现。这是我们在 asp.net mvc2 项目中使用的示例：

```
<%= Html.Encode(ViewData["PasswordLength"]) %> 
```

它位于命名空间 System.Web.Mvc 中，并将指定的字符串转换为 HTML 编码的字符串。

# delphi - 如何在正确保持纵横比的情况下进行缩放

> ID：11058857
> 
> 赞同：18
> 
> 时间：2012-06-15T22:17:27.717
> 
> 标签：delphi, delphi-xe

嗯，这是我的目标。使用鼠标左键滚动图像，鼠标右键选择缩放矩形，双击恢复全缩放。

我目前很累，到目前为止发现它与我加载图像或显示图像的方式无关，而是与它的绘画方式有关。无论窗体或源图像的形状如何，屏幕上的图像始终填充控件的客户区，因此不可能保留纵横比。我不知道如何改变这个或保持纵横比。因此给了我一张干净漂亮的照片。

我正在为我的 ZImage 单元发布整个代码虽然我认为问题出在 Zimage.paint 或 Zimage.mouseup 但想如果你需要在其中一个函数中查看一个函数，将它全部发布会有所帮助。

```
unit ZImage;

interface

uses
  Windows, Messages, SysUtils,jpeg, Classes, Graphics, Controls, Forms, Dialogs,
  ExtCtrls;

type
  TZImage = class(TGraphicControl)
  private
    FBitmap        : Tbitmap;
    PicRect        : TRect;
    ShowRect       : TRect;
    FShowBorder    : boolean;
    FBorderWidth   : integer;
    FForceRepaint  : boolean;
    FMouse         : (mNone, mDrag, mZoom);
    FProportional  : boolean;
    FDblClkEnable  : boolean;
    FLeft        :integer;
    FRight        :integer;
    FTop             :integer;
    FBottom             :integer;
    startx, starty,
    oldx, oldy     : integer;
    procedure SetShowBorder(s:boolean);
    procedure SetBitmap(b:TBitmap);
    procedure SetBorderWidth(w:integer);
    procedure SetProportional(b:boolean);
  protected
    procedure Paint; override;
    procedure MouseDown(Button: TMouseButton; Shift: TShiftState;
                        X, Y: Integer); override;
    procedure MouseMove(Shift: TShiftState; X, Y: Integer); override;
    procedure MouseUp(Button: TMouseButton; Shift: TShiftState;
              X, Y: Integer); override;
  public
    constructor Create(AOwner:TComponent); override;
    destructor Destroy; override;
    procedure DblClick; override;
  published
  procedure zoom(Endleft,EndRight,EndTop,EndBottom:integer);
    property ValueLeft    : integer read FLeft write FLeft;
    property ValueRight    : Integer read FRight write FRight;
    Property ValueTop         : Integer read FTop write FTop;
    Property ValueBottom         : Integer read FBottom write FBottom;
    property ShowBorder : boolean
                 read FShowBorder
                 write SetShowBorder default true;
    property KeepAspect : boolean
                 read FProportional
                 write SetProportional default true;
    property Bitmap : TBitmap
                 read FBitmap
                 write Setbitmap;
    property BorderWidth : integer
                 read FBorderWidth
                 write SetBorderWidth default 7;
    property ForceRepaint : boolean
                 read FForceRepaint
                 write FForceRepaint default true;
    property DblClkEnable : boolean
                 read FDblClkEnable
                 write FDblClkEnable default False;
    property Align;
    property Width;
    property Height;
    property Top;
    property Left;
    property Visible;
    property Hint;
    property ShowHint;
  end;

procedure Register;

implementation

 //This is the basic create options.
constructor TZImage.Create(AOwner:TComponent);
begin
   inherited;
   FShowBorder:=True;
   FBorderWidth:=7;
   FMouse:=mNone;
   FForceRepaint:=true;    //was true
   FDblClkEnable:=False;
   FProportional:=true;   //was true
   Width:=100; Height:=100;
   FBitmap:=Tbitmap.Create;
   FBitmap.Width:=width;
   FBitmap.height:=Height;
   ControlStyle:=ControlStyle+[csOpaque];
   autosize:= false;
   //Scaled:=false;
end;

//basic destroy frees the FBitmap
destructor TZImage.Destroy;
begin
   FBitmap.Free;
   inherited;
end;

//This was a custom zoom i was using to give the automated zoom effect
procedure TZimage.zoom(Endleft,EndRight,EndTop,EndBottom:integer);
begin

   while ((Endbottom <> picrect.bottom) or (Endtop <> picrect.top)) or ((endleft <> picrect.left) or (endright <> picrect.right)) do
     begin
       if picrect.left > endleft then
            picrect.left := picrect.left -1;
       if picrect.left < endleft  then  //starting
            picrect.left := picrect.left +1;

       if picrect.right > endright then   //starting
            picrect.right := picrect.right -1;
       if picrect.right < endright  then
            picrect.right := picrect.right +1;

       if picrect.top > endtop then
            picrect.top := picrect.top -1;
       if picrect.top < endtop then //starting
            picrect.top := picrect.top +1;

       if picrect.bottom > endbottom then  //starting
            picrect.bottom := picrect.bottom -1;
       if picrect.bottom < endbottom  then
           picrect.bottom := picrect.bottom +1;
       self.refresh;
     end;

end;

//this is the custom paint I know if i put
//Canvas.Draw(0,0,FBitmap);  as the methond it displays
//perfect but the zoom option is gone of course and
//i need the Zoom.
procedure TZImage.Paint;
var buf:TBitmap;
    coef,asps,aspp:Double;
    sz,a : integer;
begin

   buf:=TBitmap.Create;
   buf.Width:=Width;
   buf.Height:=Height;
   if not FShowBorder
     then ShowRect:=ClientRect
     else ShowRect:=Rect(ClientRect.Left,ClientRect.Top,
                         ClientRect.Right-FBorderWidth,
                         ClientRect.Bottom-FBorderWidth);
   ShowRect:=ClientRect;
   with PicRect do begin
    if Right=0 then Right:=FBitmap.Width;
    if Bottom=0 then Bottom:=FBitmap.Height;
   end;
   buf.Canvas.CopyMode:=cmSrcCopy;
   buf.Canvas.CopyRect(ShowRect,FBitmap.Canvas,PicRect);
   Canvas.CopyMode:=cmSrcCopy;
   Canvas.Draw(0,0,buf);
   buf.Free;
end;

procedure TZImage.MouseDown(Button: TMouseButton; Shift: TShiftState;
                            X, Y: Integer);
begin

//   if mbLeft<>Button then Exit;
   if not PtInRect(ShowRect,Point(X,Y)) and
      not PtInRect(Rect(ShowRect.Right,ShowRect.Bottom,
                        Width,Height),Point(X,Y)) then Exit;
   if PtInRect(Rect(ShowRect.Right,ShowRect.Bottom,
                    Width,Height),Point(X,Y)) then begin
      DblClick;
      Exit;
   end;
   //here click is in the picture area only
   startx:=x; oldx:=x;
   starty:=y; oldy:=y;
   if mbRight=Button then begin
      MouseCapture:=True;
      FMouse:=mZoom;
      Canvas.Pen.Mode:=pmNot;
   end else begin
      FMouse:=mDrag;
      Screen.Cursor:=crHandPoint;
   end;
end;

function Min(a,b:integer):integer;
begin
   if a<b then Result:=a else Result:=b;
end;
function Max(a,b:integer):integer;
begin
   if a<b then Result:=b else Result:=a;
end;

procedure TZImage.MouseMove(Shift: TShiftState; X, Y: Integer);
var d,s:integer;
    coef:Double;
begin
    if FMouse=mNone then Exit;
    if FMouse=mZoom then begin
       Canvas.DrawFocusRect(Rect(Min(startx,oldx),Min(starty,oldy),Max(startx,oldx),Max(starty,oldy)));
       oldx:=x; oldy:=y;
       Canvas.DrawFocusRect(Rect(Min(startx,oldx),Min(starty,oldy),Max(startx,oldx),Max(starty,oldy)));
    end;
    if FMouse=mDrag then begin
//horizontal movement
       coef:=(PicRect.Right-PicRect.Left)/(ShowRect.Right-ShowRect.Left);
       d:=Round(coef*(x-oldx));
       s:=PicRect.Right-PicRect.Left;
       if d>0 then begin
          if PicRect.Left>=d then begin
            PicRect.Left:=PicRect.Left-d;
            PicRect.Right:=PicRect.Right-d;
          end else begin
            PicRect.Left:=0;
            PicRect.Right:=PicRect.Left+s;
          end;
       end;
       if d<0 then begin
          if PicRect.Right<FBitmap.Width+d then begin
            PicRect.Left:=PicRect.Left-d;
            PicRect.Right:=PicRect.Right-d;
          end else begin
            PicRect.Right:=FBitmap.Width;
            PicRect.Left:=PicRect.Right-s;
          end;
       end;

//vertical movement
       coef:=(PicRect.Bottom-PicRect.Top)/(ShowRect.Bottom-ShowRect.Top);
       d:=Round(coef*(y-oldy));
       s:=PicRect.Bottom-PicRect.Top;
       if d>0 then begin
          if PicRect.Top>=d then begin
            PicRect.Top:=PicRect.Top-d;
            PicRect.Bottom:=PicRect.Bottom-d;
          end else begin
            PicRect.Top:=0;
            PicRect.Bottom:=PicRect.Top+s;
          end;
       end;

{There was a bug in the fragment below. Thanks to all, who reported this bug to me}
      if d<0 then begin
          if PicRect.Bottom<FBitmap.Height+d then begin
            PicRect.Top:=PicRect.Top-d;
            PicRect.Bottom:=PicRect.Bottom-d;
          end else begin
            PicRect.Bottom:=FBitmap.Height;
            PicRect.Top:=PicRect.Bottom-s;
          end;
       end;

       oldx:=x; oldy:=y;
       if FForceRepaint then Repaint
                        else Invalidate;
    end;
end;

procedure TZImage.MouseUp(Button: TMouseButton; Shift: TShiftState;
                          X, Y: Integer);
var coef:Double;
    t:integer;
    left,right,top,bottom : integer;
begin

   if FMouse=mNone then Exit;
   if x>ShowRect.Right then x:=ShowRect.Right;
   if y>ShowRect.Bottom then y:=ShowRect.Bottom;
   if FMouse=mZoom then begin  //calculate new PicRect
     t:=startx;
     startx:=Min(startx,x);
     x:=Max(t,x);
     t:=starty;
     starty:=Min(starty,y);
     y:=Max(t,y);
     FMouse:=mNone;
     MouseCapture:=False;
//enable the following if you want to zoom-out by dragging in the opposite direction}
{     if Startx>x then begin
        DblClick;
        Exit;
     end;}
     if Abs(x-startx)<5 then Exit;
     //showmessage('picrect Left='+inttostr(picrect.Left)+' right='+inttostr(picrect.Right)+' top='+inttostr(picrect.Top)+' bottom='+inttostr(picrect.Bottom));
     //startx and start y is teh starting x/y of the selected area
     //x and y is the ending x/y of the selected area
     if (x - startx < y - starty) then
     begin
       while (x - startx < y - starty) do
       begin
          x := x + 100;
          startx := startx - 100;
       end;
     end

     else if (x - startx > y - starty) then
     begin
        while (x - startx > y - starty) do
        begin
            y := y + 100;
            starty := starty - 100;
        end;
     end;

//picrect is the size of whole area
//PicRect.top and left are 0,0
//IFs were added in v.1.2 to avoid zero-divide
     if (PicRect.Right=PicRect.Left)
     then
        coef := 100000
     else
        coef:=ShowRect.Right/(PicRect.Right-PicRect.Left);    //if new screen coef= 1
     left:=Round(PicRect.Left+startx/coef);
     Right:=Left+Round((x-startx)/coef);

     if (PicRect.Bottom=PicRect.Top)
     then
        coef := 100000
     else
        coef:=ShowRect.Bottom/(PicRect.Bottom-PicRect.Top);
     Top:=Round(PicRect.Top+starty/coef);
     Bottom:=Top+Round((y-starty)/coef);
     //showmessage(inttostr(left)+' '+inttostr(Right)+' '+inttostr(top)+' '+inttostr(bottom));

     zoom(left,right,top,bottom);
     ValueLeft := left;
     ValueRight := Right;
     ValueTop := top;
     ValueBottom := bottom;
     end;
   if FMouse=mDrag then begin
     FMouse:=mNone;
     Canvas.Pen.Mode:=pmCopy;
     Screen.Cursor:=crDefault;
   end;

   Invalidate;
end;

procedure TZImage.DblClick;
begin
   zoom(0,FBitMap.Width,0,FBitMap.Height);
   ValueLeft := 0;
   ValueRight := FBitMap.Width;
   ValueTop := 0;
   ValueBottom := FBitMap.Height;
   //PicRect:=Rect(0,0,FBitmap.Width,FBitmap.Height);
   Invalidate;
end;

procedure TZImage.SetBitmap(b:TBitmap);
begin
   FBitmap.Assign(b);
   PicRect:=Rect(0,0,b.Width, b.Height);
   Invalidate;
end;

procedure TZImage.SetBorderWidth(w:integer);
begin
   FBorderWidth:=w;
   Invalidate;
end;

procedure TZImage.SetShowBorder(s:boolean);
begin
   FShowBorder:=s;
   Invalidate;
end;

procedure TZImage.SetProportional(b:boolean);
begin
   FProportional:=b;
   Invalidate;
end;

procedure Register;
begin
  RegisterComponents('Custom', [TZImage]);
end;

end. 
```

使用此代码，您可以注册组件 ZImage 并查看它如何运行.. 如果需要

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-16T04:31:01.187

问题很清楚，但我认为回答这个问题的问题是如何不重写完整的代码以使您可以理解。而且由于我更擅长编码然后解释，所以我做到了。

我认为您正在搜索以下内容：

```
unit ZImage2;

interface

uses
  Windows, Messages, Classes, Controls, Graphics, StdCtrls, ExtCtrls, Math;

const
  DefAnimDuration = 500;

type
  TZImage = class(TGraphicControl)
  private
    FAlignment: TAlignment;
    FAnimDuration: Cardinal;
    FAnimRect: TRect;
    FAnimStartTick: Cardinal;
    FAnimTimer: TTimer;
    FBuffer: TBitmap;
    FCropRect: TRect;
    FImgRect: TRect;
    FLayout: TTextLayout;
    FPicture: TPicture;
    FPrevCropRect: TRect;
    FProportional: Boolean;
    FProportionalCrop: Boolean;
    FScale: Single;
    FSelColor: TColor;
    FSelecting: Boolean;
    FSelPoint: TPoint;
    FSelRect: TRect;
    procedure Animate(Sender: TObject);
    function HasGraphic: Boolean;
    procedure PictureChanged(Sender: TObject);
    procedure RealignImage;
    procedure SetAlignment(Value: TAlignment);
    procedure SetLayout(Value: TTextLayout);
    procedure SetPicture(Value: TPicture);
    procedure SetProportional(Value: Boolean);
    procedure UpdateBuffer;
  protected
    function CanAutoSize(var NewWidth, NewHeight: Integer): Boolean; override;
    procedure ChangeScale(M: Integer; D: Integer); override;
    procedure DblClick; override;
    procedure MouseDown(Button: TMouseButton; Shift: TShiftState; X,
      Y: Integer); override;
    procedure MouseMove(Shift: TShiftState; X, Y: Integer); override;
    procedure MouseUp(Button: TMouseButton; Shift: TShiftState; X,
      Y: Integer); override;
    procedure Paint; override;
    procedure Resize; override;
  public
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;
    procedure Reset;
    function ScreenToGraphic(R: TRect): TRect;
    procedure Zoom(const ACropRect: TRect);
    procedure ZoomSelection(const ASelRect: TRect);
  published
    property Alignment: TAlignment read FAlignment write SetAlignment
      default taLeftJustify;
    property AnimDuration: Cardinal read FAnimDuration write FAnimDuration
      default DefAnimDuration;
    property Layout: TTextLayout read FLayout write SetLayout default tlTop;
    property Picture: TPicture read FPicture write SetPicture;
    property Proportional: Boolean read FProportional write SetProportional
      default False;
    property ProportionalCrop: Boolean read FProportionalCrop
      write FProportionalCrop default True;
    property SelColor: TColor read FSelColor write FSelColor default clWhite;
  published
    property Align;
    property Anchors;
    property AutoSize;
    property Color;
  end;

implementation

function FitRect(const Boundary: TRect; Width, Height: Integer;
  CanGrow: Boolean; HorzAlign: TAlignment; VertAlign: TTextLayout): TRect;
var
  W: Integer;
  H: Integer;
  Scale: Single;
  Offset: TPoint;
begin
  Width := Max(1, Width);
  Height := Max(1, Height);
  W := Boundary.Right - Boundary.Left;
  H := Boundary.Bottom - Boundary.Top;
  if CanGrow then
    Scale := Min(W / Width, H / Height)
  else
    Scale := Min(1, Min(W / Width, H / Height));
  Result := Rect(0, 0, Round(Width * Scale), Round(Height * Scale));
  case HorzAlign of
    taLeftJustify:
      Offset.X := 0;
    taCenter:
      Offset.X := (W - Result.Right) div 2;
    taRightJustify:
      Offset.X := W - Result.Right;
  end;
  case VertAlign of
    tlTop:
      Offset.Y := 0;
    tlCenter:
      Offset.Y := (H - Result.Bottom) div 2;
    tlBottom:
      Offset.Y := H - Result.Bottom;
  end;
  OffsetRect(Result, Boundary.Left + Offset.X, Boundary.Top + Offset.Y);
end;

function NormalizeRect(const Point1, Point2: TPoint): TRect;
begin
  Result.Left := Min(Point1.X, Point2.X);
  Result.Top := Min(Point1.Y, Point2.Y);
  Result.Right := Max(Point1.X, Point2.X);
  Result.Bottom := Max(Point1.Y, Point2.Y);
end;

{ TZImage }

procedure TZImage.Animate(Sender: TObject);
var
  Done: Single;
begin
  Done := (GetTickCount - FAnimStartTick) / FAnimDuration;
  if Done >= 1.0 then
  begin
    FAnimTimer.Enabled := False;
    FAnimRect := FCropRect;
  end
  else
    with FPrevCropRect do
      FAnimRect := Rect(
        Left + Round(Done * (FCropRect.Left - Left)),
        Top + Round(Done * (FCropRect.Top - Top)),
        Right + Round(Done * (FCropRect.Right - Right)),
        Bottom + Round(Done * (FCropRect.Bottom - Bottom)));
  UpdateBuffer;
  RealignImage;
  Invalidate;
end;

function TZImage.CanAutoSize(var NewWidth, NewHeight: Integer): Boolean;
begin
  Result := True;
  if not (csDesigning in ComponentState) or HasGraphic then
  begin
    if Align in [alNone, alLeft, alRight] then
      NewWidth := Round(FScale * FPicture.Width);
    if Align in [alNone, alTop, alBottom] then
      NewHeight := Round(FScale * FPicture.Height);
  end;
end;

procedure TZImage.ChangeScale(M, D: Integer);
var
  SaveAnchors: TAnchors;
begin
  SaveAnchors := Anchors;
  Anchors := [akLeft, akTop];
  FScale := FScale * M / D;
  inherited ChangeScale(M, D);
  Anchors := SaveAnchors;
end;

constructor TZImage.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  ControlStyle := [csCaptureMouse, csClickEvents, csOpaque, csDoubleClicks];
  FAnimTimer := TTimer.Create(Self);
  FAnimTimer.Interval := 15;
  FAnimTimer.OnTimer := Animate;
  FAnimDuration := DefAnimDuration;
  FBuffer := TBitmap.Create;
  FPicture := TPicture.Create;
  FPicture.OnChange := PictureChanged;
  FProportionalCrop := True;
  FScale := 1.0;
  FSelColor := clWhite;
end;

procedure TZImage.DblClick;
begin
  if not HasGraphic then
    Reset
  else
    Zoom(Rect(0, 0, FPicture.Width, FPicture.Height));
  inherited DblClick;
end;

destructor TZImage.Destroy;
begin
  FPicture.Free;
  FBuffer.Free;
  inherited Destroy;
end;

function TZImage.HasGraphic: Boolean;
begin
  Result := (Picture.Width > 0) and (Picture.Height > 0);
end;

procedure TZImage.MouseDown(Button: TMouseButton; Shift: TShiftState; X,
  Y: Integer);
begin
  if (Button = mbRight) and HasGraphic and PtInRect(FImgRect, Point(X, Y)) then
  begin
    FSelPoint.X := X;
    FSelPoint.Y := Y;
    FSelRect := Rect(X, Y, X, Y);
    FSelecting := True;
    Canvas.Brush.Color := FSelColor;
    Canvas.DrawFocusRect(FSelRect);
  end;
  inherited MouseDown(Button, Shift, X, Y);
end;

procedure TZImage.MouseMove(Shift: TShiftState; X, Y: Integer);
const
  HorzAlign: array[Boolean] of TAlignment = (taLeftJustify, taRightJustify);
  VertAlign: array[Boolean] of TTextLayout = (tlTop, tlBottom);
begin
  if FSelecting and PtInRect(FImgRect, Point(X, Y)) then
  begin
    Canvas.DrawFocusRect(FSelRect);
    FSelRect := NormalizeRect(FSelPoint, Point(X, Y));
    if (not FProportionalCrop) then
      FSelRect := FitRect(FSelRect, FPicture.Graphic.Width,
        FPicture.Graphic.Height, True, HorzAlign[X < FSelPoint.X],
        VertAlign[Y < FSelPoint.Y]);
    Canvas.DrawFocusRect(FSelRect);
  end;
  inherited MouseMove(Shift, X, Y);
end;

procedure TZImage.MouseUp(Button: TMouseButton; Shift: TShiftState; X,
  Y: Integer);
begin
  if FSelecting then
  begin
    FSelecting := False;
    Canvas.DrawFocusRect(FSelRect);
    if (Abs(X - FSelPoint.X) > Mouse.DragThreshold) or
        (Abs(Y - FSelPoint.Y) > Mouse.DragThreshold) then
      ZoomSelection(FSelRect);
  end;
  inherited MouseUp(Button, Shift, X, Y);
end;

procedure TZImage.Paint;
begin
  Canvas.Brush.Color := Color;
  if HasGraphic then
  begin
    Canvas.StretchDraw(FImgRect, FBuffer);
    if FSelecting then
      Canvas.DrawFocusRect(FSelRect);
    with FImgRect do
      ExcludeClipRect(Canvas.Handle, Left, Top, Right, Bottom);
  end;
  Canvas.FillRect(Canvas.ClipRect);
end;

procedure TZImage.PictureChanged(Sender: TObject);
begin
  Reset;
end;

procedure TZImage.RealignImage;
begin
  if not HasGraphic then
    FImgRect := Rect(0, 0, 0, 0)
  else if FProportional then
    FImgRect := ClientRect
  else
    FImgRect := FitRect(ClientRect, FBuffer.Width, FBuffer.Height, True,
      FAlignment, FLayout);
end;

procedure TZImage.Reset;
begin
  FCropRect := Rect(0, 0, FPicture.Width, FPicture.Height);
  FAnimRect := FCropRect;
  UpdateBuffer;
  RealignImage;
  Invalidate;
end;

procedure TZImage.Resize;
begin
  RealignImage;
  inherited Resize;
end;

function TZImage.ScreenToGraphic(R: TRect): TRect;
var
  CropWidth: Integer;
  CropHeight: Integer;
  ImgWidth: Integer;
  ImgHeight: Integer;
begin
  CropWidth := FCropRect.Right - FCropRect.Left;
  CropHeight := FCropRect.Bottom - FCropRect.Top;
  ImgWidth := FImgRect.Right - FImgRect.Left;
  ImgHeight := FImgRect.Bottom - FImgRect.Top;
  IntersectRect(R, R, FImgRect);
  OffsetRect(R, -FImgRect.Left, -FImgRect.Top);
  Result := Rect(
    FCropRect.Left + Round(CropWidth * (R.Left / ImgWidth)),
    FCropRect.Top + Round(CropHeight * (R.Top / ImgHeight)),
    FCropRect.Left + Round(CropWidth * (R.Right / ImgWidth)),
    FCropRect.Top + Round(CropHeight * (R.Bottom / ImgHeight)));
end;

procedure TZImage.SetAlignment(Value: TAlignment);
begin
  if FAlignment <> Value then
  begin
    FAlignment := Value;
    RealignImage;
    Invalidate;
  end;
end;

procedure TZImage.SetLayout(Value: TTextLayout);
begin
  if FLayout <> Value then
  begin
    FLayout := Value;
    RealignImage;
    Invalidate;
  end;
end;

procedure TZImage.SetPicture(Value: TPicture);
begin
  FPicture.Assign(Value);
end;

procedure TZImage.SetProportional(Value: Boolean);
begin
  if FProportional <> Value then
  begin
    FProportional := Value;
    RealignImage;
    Invalidate;
  end;
end;

procedure TZImage.UpdateBuffer;
begin
  if HasGraphic then
  begin
    FBuffer.Width := FAnimRect.Right - FAnimRect.Left;
    FBuffer.Height := FAnimRect.Bottom - FAnimRect.Top;
    FBuffer.Canvas.Draw(-FAnimRect.Left, -FAnimRect.Top, FPicture.Graphic);
  end;
end;

procedure TZImage.Zoom(const ACropRect: TRect);
begin
  if HasGraphic then
  begin
    FPrevCropRect := FAnimRect;
    FCropRect := ACropRect;
    if FAnimDuration = 0 then
    begin
      FAnimRect := FCropRect;
      UpdateBuffer;
      RealignImage;
      Invalidate;
    end
    else
    begin
      FAnimStartTick := GetTickCount;
      FAnimTimer.Enabled := True;
    end;
  end;
end;

procedure TZImage.ZoomSelection(const ASelRect: TRect);
begin
  Zoom(ScreenToGraphic(ASelRect));
end;

end. 
```

示例代码：

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  FImage := TZImage.Create(Self);
  FImage.SetBounds(10, 10, 200, 300);
  FImage.Picture.LoadFromFile('D:\Pictures\Mona_Lisa.jpg');
  FImage.Alignment := taCenter;
  FImage.Layout := tlCenter;
  FImage.AutoSize := True;
  FImage.Parent := Self;
end; 
```

![示例图像](../Images/5bd2fdfc0c705b9a8d2dd334fd700884.png)

# css - 包含在 div 中的图像不以边距为中心：自动

> ID：11058862
> 
> 赞同：0
> 
> 时间：2012-06-15T22:17:54.000
> 
> 标签：css

我有以下 html 和 css 代码：

```
<!DOCTYPE HTML>
<html>
<head>
</head>

<body>

    <div class="wrapper">
        <header>
            <section class="top">
                <div id="quote"><a href="contact.html"><p>Request a quote</p></a></div>
                <div class="arrow"><img src="icons/top-icon.png" alt=""></div>
            </section>
</body>
</html>​​​​​​​​​​​​​​​​​​

a {
    font-size: 1.6em;
    color: #fff;
    text-decoration: none;
    }
.top {
    height: 3.2em;    
    width: 100%;
    background: rgb(255,214,94); /* Old browsers */
    background: -moz-linear-gradient(top,  rgba(255,214,94,1) 0%, rgba(254,191,4,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,214,94,1)), color-stop(100%,rgba(254,191,4,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  rgba(255,214,94,1) 0%,rgba(254,191,4,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  rgba(255,214,94,1) 0%,rgba(254,191,4,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  rgba(255,214,94,1) 0%,rgba(254,191,4,1) 100%); /* IE10+ */
    background: linear-gradient(top,  rgba(255,214,94,1) 0%,rgba(254,191,4,1) 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffd65e', endColorstr='#febf04',GradientType=0 ); /* IE6-9 */
    position: fixed;
    top: 0;
    left :0;
    z-index: 10;
    text-align: center;
    border-bottom: 1px solid #f9e555;
    -webkit-box-shadow: 0px 0px 8px #555;
    -moz-box-shadow: 0px 0px 8px #555;
    box-shadow: 0px 0px 8px #555;
    }
.top div#quote {
    width: 20em;
    background: rgb(254,252,234); /* Old browsers */
    background: -moz-linear-gradient(top,  rgba(254,252,234,1) 0%, rgba(241,218,54,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(254,252,234,1)), color-stop(100%,rgba(241,218,54,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  rgba(254,252,234,1) 0%,rgba(241,218,54,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  rgba(254,252,234,1) 0%,rgba(241,218,54,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  rgba(254,252,234,1) 0%,rgba(241,218,54,1) 100%); /* IE10+ */
    background: linear-gradient(top,  rgba(254,252,234,1) 0%,rgba(241,218,54,1) 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fefcea', endColorstr='#f1da36',GradientType=0 ); /* IE6-9 */
    margin: 0 auto;
    }
.top div#quote p {
    color: #f2572a;
    height: 3.5em;
    font-size: 1.5em;
    padding: 0;
    margin: 0;        
    }
.top div#quote a {
    font-size: 1.1em;
    }
.top div#quote p:hover {
    color: #ed3419;
    }    
.arrow {
    display: inline-block;
    margin: 0 auto;
    border: 1px solid #000;
    position: relative;
    } 
```

这里有两个问题：第一个是“请求报价 div”大于 css 中定义的 3.2em，第二个是如果我删除 text-aling: center in .top 样式下面的图像报价 div 不会保持居中。我试图相对定位 .arrow div 并定位绝对 img 图标，但它不起作用，因为 div 完全消失了。还有其他想法吗？​</p>

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T22:21:53.647

由于`.arrow`元素的默认宽度为 100%，`margin: 0 auto`因此水平设置无效。而且由于`img`它是一个内联元素，因此它也不起作用。您需要在元素上设置显式宽度，或者在元素上`.arrow`设置`display: block`和。`margin: 0 auto``img`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T22:24:58.733

“请求报价” div 更大，因为它的高度是相对于它的字体大小的。[`em`](http://www.w3.org/TR/css3-values/#font-relative-lengths)基于字母的当前宽度`M`（至少在[经典排版](http://en.wikipedia.org/wiki/Em_%28typography%29)中）。由于您更改`font-size`元素`3.2em`in`.top`与`3.2em`in不同`.top div#quote p`。

即使您不更改`font-size`值仍然不同（`3.2em`in `.top`，`3.5em`in `.top div#quote p`）。

您应该摆脱所有`padding-top`s, `padding-bottom`s, `margin-top`s 和`margin-bottom`s 而只​​是使用`height:100%`.

### HTML

```
<div class="wrapper">
    <header>
        <section class="top">
            <p class="quote"><a href="contact.html">Request a quote</a></p>
            <img class="arrow" src="icons/top-icon.png" alt="Arrow"></div>
        </section>
    </header>
</div> 
```

### CSS

```
a {
    color: #fff;
    text-decoration: none;
}

.top {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;

    z-index: 10;

    height: 3.2em;

    background: rgb(255,214,94); /* Old browsers */
    background: linear-gradient(top,  rgba(255,214,94,1) 0%,rgba(254,191,4,1) 100%); /* W3C */    

    text-align: center;

    border-bottom: 1px solid #f9e555;
    box-shadow: 0px 0px 8px #555;
}

.top p.quote {
    width: 20em;
    height:100%;  

    padding: 0;
    margin: 0 auto;

    color: #f2572a;    
    font-size: 1.6em;
    line-height:2.1em;

    background: rgb(254,252,234); /* Old browsers */
    background: linear-gradient(top,  rgba(254,252,234,1) 0%,rgba(241,218,54,1) 100%); /* W3C */
}

.top p.quote a{
    color: #f2572a;
}

.top p.quote a:hover{
    color: #ed3419;
}    
.arrow {
    display: inline-block;
    margin: 0 auto;
    border: 1px solid #000;
    position: relative;
}

/* gradient and other vendor specific quirks */
.top{
    /* background rules */
    background: -moz-linear-gradient(top,  rgba(255,214,94,1) 0%, rgba(254,191,4,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,214,94,1)), color-stop(100%,rgba(254,191,4,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  rgba(255,214,94,1) 0%,rgba(254,191,4,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  rgba(255,214,94,1) 0%,rgba(254,191,4,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  rgba(255,214,94,1) 0%,rgba(254,191,4,1) 100%); /* IE10+ */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffd65e', endColorstr='#febf04',GradientType=0 ); /* IE6-9 */

    /* vendor specific box shadows */    
    -webkit-box-shadow: 0px 0px 8px #555;
    -moz-box-shadow: 0px 0px 8px #555;
}

.top p.quote{    
    background: -moz-linear-gradient(top,  rgba(254,252,234,1) 0%, rgba(241,218,54,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(254,252,234,1)), color-stop(100%,rgba(241,218,54,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  rgba(254,252,234,1) 0%,rgba(241,218,54,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  rgba(254,252,234,1) 0%,rgba(241,218,54,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  rgba(254,252,234,1) 0%,rgba(241,218,54,1) 100%); /* IE10+ */    
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fefcea', endColorstr='#f1da36',GradientType=0 ); /* IE6-9 */
} 
```

[**JSFiddle 演示**](http://jsfiddle.net/qJHzz/1/)

# c# - 如何检测黑白图像中的白色斑点（矩形）？

> ID：11058866
> 
> 赞同：1
> 
> 时间：2012-06-15T22:18:39.737
> 
> 标签：c#, image-processing, aforge

我正在做一个车牌提取，我设法侵蚀了车牌区域，我需要使用 blobcount 来检测矩形车牌。但是我可以在黑白图像上使用它吗？

我为此使用 Aforge.Net 库。

我的整个想法是识别车牌角落的位置并从彩色图像中提取它，然后使用 OCR。

希望这可以帮助

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T00:54:11.270

我最近一直在使用 AForge，并遇到了一个很好的 blob 检测示例（尽管我自己没有尝试过）。它使用一些 BlobCounter 并识别字形。不管怎样，就[在这里](http://www.aforgenet.com/articles/glyph_recognition/)。

希望这会有所帮助，如果没有，祝你好运！

# apache - 在 Tomcat 应用程序中使用来自 Apache 的应用程序

> ID：11058868
> 
> 赞同：1
> 
> 时间：2012-06-15T22:18:54.120
> 
> 标签：apache, rest, tomcat

基本上我有 2 个 RESTful 服务：一个用 Java 构建并使用 Tomcat 服务器，另一个用 PHP 构建并使用 Apache 服务器。有什么方法可以配置使来自 Tomcat 的应用程序成为来自 Apache 的应用程序的消费者？

来自 Tomcat 的网络服务位于以下地址：

```
http://localhost:8080/myapp1 
```

来自 Apache 的应用程序位于以下地址：

```
http://localhost:80/myapp2. 
```

我想要的是在 Tomcat 中使用 Apache 上的 RESTful 服务的响应，类似于从 Java 代码中使用的东西：

```
HttpGet httpget = new HttpGet(http://localhost:80/myapp2/items); 
```

目前我收到 404-Not Found。有没有办法做到这一点？还是有其他方法可以使服务进行通信？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T21:00:26.827

忘记发布答案了。我觉得很愚蠢——我的代码有错误。它按预期工作。下面是一个从 Tomcat 调用 Apache 服务器的简单示例：

```
final static String BASE_URL = "http://localhost:80/proiect/";

    private String getResponse(String title) {
        HttpClient httpclient = new DefaultHttpClient();
        String url = (title != null && title.length() > 0) ? BASE_URL + "?title=" + title : BASE_URL;
        HttpGet httpget = new HttpGet(url);
        String response;
        try {
            ResponseHandler<String> responseHandler = new BasicResponseHandler();
            response = httpclient.execute(httpget, responseHandler);
            return response;

        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        return null;
    } 
```

# android - 禁用 Android 文本字段建议

> ID：11058869
> 
> 赞同：3
> 
> 时间：2012-06-15T22:18:54.767
> 
> 标签：android, autocomplete

在 Android 浏览器（在 Galaxy Nexus 上）上运行的网页中，是否可以禁用建议单词（在键盘上方的框中）并在您键入时为它们加下划线的功能？

![示例屏幕](../Images/74ce0854a20e291a8a50a86e3e1c7127.png)

我试过`autocomplete="off" autocorrect="off"`了，但没有效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-08-28T16:45:53.323

在遇到同样的问题时，我做了一些挖掘，发现这是 Android 版 Chrome 中的一个错误。这些 HTML 5 属性旨在满足您的需求，但在 Android 版 Chrome 中没有得到适当支持（它们适用于 iOS）。它似乎最近才被修复，希望很快会在更新中发布。

[https://code.google.com/p/chromium/issues/detail?id=303883&q=autocorrect&colspec=ID%20Pri%20M%20Iteration%20ReleaseBlock%20Cr%20Status%20Owner%20Summary%20OS%20Modified](https://code.google.com/p/chromium/issues/detail?id=303883&q=autocorrect&colspec=ID%20Pri%20M%20Iteration%20ReleaseBlock%20Cr%20Status%20Owner%20Summary%20OS%20Modified)

也可以随意给问题加注星标以帮助提高排名...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T00:30:09.327

> 在 Android 浏览器（在 Galaxy Nexus 上）上运行的网页中，是否可以禁用建议单词的功能（在键盘上方的框中）

不

> 并在您键入时为它们加下划线？

不

这些是用户偏好，此外，如果用户购买了键盘应用程序，它可以有自己的设置来自动完成。

# javascript - 定位拉斐尔纸对象

> ID：11058874
> 
> 赞同：2
> 
> 时间：2012-06-15T22:19:57.210
> 
> 标签：javascript, svg, raphael

我正在尽我所能了解拉斐尔的纸制品。我已经用尽了有关该主题的 raphael 文档，但有一件事让我（通过 nads）了解了您到底是如何定位纸质物体的？

我试过使用 setViewBox 方法，但 x 和 y 没有响应。还有另一种方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T03:12:36.803

Raphael 可以通过 CSS 定位在 DOM 中。例如：

```
<style type="text/css">
    #derp { position: absolute; width:200px; height:100px; }
</style> 
```

`<div id="derp">Loading...</div>`

然后，实例化它：

`var my_paper = Raphael("derp", 200, 100 );`

您可以将 DOM 元素与 Raphael 混合和匹配。例如，请参阅[http://jsfiddle.net/NQtU5/](http://jsfiddle.net/NQtU5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:31:12.153

```
// Creates canvas 320 × 200 at 10, 50
var paper = Raphael(10, 50, 320, 200); 
```

第一个参数是x，第二个是y。[来源：他们主页](http://raphaeljs.com/)上的第一行代码

要在创建页面后移动页面本身，请使用 js 设置 dom 元素的 'top' 和/或 'left' 样式属性

# java - 使用不同的映射配置 JSR-303 休眠验证器

> ID：11058881
> 
> 赞同：1
> 
> 时间：2012-06-15T22:20:29.553
> 
> 标签：java, bean-validation, hibernate-validator

我正在研究将 JSR-303 与休眠验证器一起使用。我们希望能够对每个客户进行不同的验证，或者拥有一组基本约束并允许它们被覆盖。

我不确定这样做的最佳方法是什么。

对约束使用注释是不合适的，因为它们本质上是在模型中硬编码的。我知道我可以使用 XML 来外部化验证（创建指定约束映射文件的 META-INF/validation.xml）。但我不太确定如何轻松地为多个客户配置此功能。

我想我希望能够设置一个简单的属性，以便在我们部署它时使用一组完全不同的约束映射文件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T21:05:43.853

您可以`ValidatorFactory`使用客户特定的约束映射 XML 文件配置每个客户，如下所示：

```
ValidatorFactory validatorFactory = Validation
    .byDefaultProvider()
    .configure()
    .addMapping(...) //input stream with an XML constraint mapping
    .addMapping(...) //another input stream with an XML constraint mapping
    .buildValidatorFactory(); 
```

当您使用 Hibernate Validator 时，您还可以使用 API 进行[编程约束声明](http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html/validator-specifics.html#programmaticapi)来创建单独配置的验证器工厂。

# .net - 尝试验证我的组合框时遇到问题

> ID：11058883
> 
> 赞同：3
> 
> 时间：2012-06-15T22:20:42.953
> 
> 标签：.net, vb.net, vb.net-2010

我决定向我的组合框添加一些验证，我想要实现的是确保用户只能输入组合框中的字段，但我现在遇到的问题是，如果用户点击组合框和不输入任何内容并尝试离开组合框，出现消息框。

```
Private Sub Combobox1_Validating(sender As Object, e As System.ComponentModel.CancelEventArgs) Handles Combobox1.Validating
    If Combobox1.Items.Contains(Combobox1.Text) = False Then
        e.Cancel = True
    End If
End Sub

Private Sub Combobox1_Leave(sender As Object, e As System.EventArgs) Handles Combobox1.Leave
    If Combobox1.Items.Contains(Combobox1.Text) = False Then
        Combobox1.Select()
        MessageBox.Show("select item from combobox")
    End If
End Sub 
```

如前所述，编码确实有效，但我试图确保如果用户未在组合框中输入任何内容，则不会出现消息框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T22:56:32.487

根据您的评论，我认为您需要做的就是添加一个空字符串检查：

```
Private Sub ComboBox1_Validating(ByVal sender As Object, ByVal e As CancelEventArgs) Handles ComboBox1.Validating
  If ComboBox1.Items.Contains(ComboBox1.Text) = False Then      
    e.Cancel = (ComboBox1.Text <> String.Empty)
  End If
End Sub

Private Sub ComboBox1_Leave(ByVal sender As Object, ByVal e As EventArgs) Handles ComboBox1.Leave
  If Not ComboBox1.Items.Contains(ComboBox1.Text) Then
    If ComboBox1.Text <> String.Empty Then
      ComboBox1.Select()
      MessageBox.Show("select item from combobox")
    End If
  End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T01:32:39.363

使用此代码：

```
Private Sub Combobox1_Leave(sender As Object, e As System.EventArgs) Handles Combobox1.Leave

    If ComboBox2.SelectedIndex = -1 Then
        MessageBox.Show("select item from combobox")
    End If
End Sub 
```

# php - 通过浏览器下载txt文件后缺少换行符

> ID：11058884
> 
> 赞同：0
> 
> 时间：2012-06-15T22:20:46.950
> 
> 标签：php

我有一个在服务器上生成并包含换行符的 txt 文件。如果我在我的 ftp 编辑器中查看该文件，它们就在这里。如果我通过我的 ftp 客户端下载它并使用记事本在它的窗口中打开，我也会看到换行符。

但是当我尝试通过强制下载窗口通过浏览器下载它，然后打开文件时，所有新行都突然消失了。

这是我现在拥有的代码。我还尝试将内容类型设置为应用程序/强制下载，但这也没有什么区别。

```
header('Content-Type: text/plain');
header('Content-Disposition: attachment; filename="'.$myFile.'"');
header("Content-Transfer-Encoding: binary"); 
```

知道为什么只有当我通过浏览器下载新行时才会丢失新行吗？但是当我在服务器上查看文件时是否完好无损，或者从 ftp 下载并在记事本中打开？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:27:24.853

Unix 行尾 (\n) 与 Windows 行尾 (\r\n) 不同。许多 FTP 程序都可以选择在操作系统之间自动转换行尾。您的浏览器没有这样做（浏览器不会触摸文本/纯文本。）

如果你想再三确定，你可以对文件进行 hexdump 并查看换行符应该在哪里。

尝试使用 wordpad 或 notepad++ 打开文件，它们将 \n 作为行尾。记事本是少数仍需要 \r\n 行尾的工具之一。

# javascript - jquery datatable oTable.$ 适用于 Firefox 但不适用于 Chrome

> ID：11058887
> 
> 赞同：1
> 
> 时间：2012-06-15T22:21:04.093
> 
> 标签：javascript, jquery, datatables

我正在使用最新版本的 jquery 插件[DataTables](http://datatables.net/)，并尝试将它们的可选行和删除[示例](http://datatables.net/release-datatables/examples/api/select_single_row.html)实现到我的项目中。我的解决方案在 Firefox 中正常工作，但在 Chrome 中不能正常工作。

所以在我的局部视图中，我创建了我的表；

```
 loadSlideShowTable = $("#LoadTable").dataTable({
        "bJQueryUI": true,
        "aaSorting": [[0, 'desc']],
        "aoColumnDefs": [
        { "sType": "date-euro", "aTargets": [5] },
        { "sType": "date-euro", "aTargets": [4] }]
    }); 
```

在我的行点击事件处理程序中，我有以下内容：

```
 console.log(loadSlideShowTable);
    loadSlideShowTable.$(".LoadTableRowSelected").removeClass("LoadTableRowSelected"); 
```

在 FireFox 中，console.log 返回：

```
jQuery(table#LoadTable.dataTable) 
```

在 Chrome 中，console.log 返回：

```
[<table id=​"LoadTable" style>​…​&lt;/table>​]
Uncaught TypeError: Object [object Object] has no method '$' 
```

编辑：它也适用于 IE，并且 console.log 返回：

```
LOG: [object Object] 
```

所以我认为这里的问题是 Chrome 似乎并不“知道” $("#LoadTable") 是一个数据表对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:25:20.613

试试 $(loadSlideShowTable.(".LoadTableRowSelected")).removeClass(xxxxx)

您希望在 jQuery 包装器中使用类 LoadTableRowSelected 的元素，直接在点之后添加它对我来说看起来不正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:38:10.870

由于我无法删除我的问题，我将发布一个关于我如何修复它的回复。

我关闭了所有 chrome 会话，重新打开了我的应用程序，然后再次尝试。在那之后它就可以正常工作了。

# mysql - InnoDB 唯一键和索引

> ID：11058890
> 
> 赞同：1
> 
> 时间：2012-06-15T22:21:45.670
> 
> 标签：mysql, indexing, innodb

我使用了以下创建语句：

```
CREATE TABLE `subscr` (
 `id` int(11) NOT NULL AUTO_INCREMENT,
 `media_id` int(11) NOT NULL,
 `user_id` int(11) NOT NULL,
 `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
 PRIMARY KEY (`id`),
 UNIQUE KEY (`media_id`, `user_id`),
 CONSTRAINT FOREIGN KEY (`media_id`) REFERENCES `media` (`id`) ON DELETE CASCADE,
CONSTRAINT FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB 
```

为什么 InnoDB 只在 user_id 上放一个索引？我认为它需要所有外键引用的索引。

```
CREATE TABLE `subscr` (
 `id` int(11) NOT NULL AUTO_INCREMENT,
 `media_id` int(11) NOT NULL,
 `user_id` int(11) NOT NULL,
 `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
 PRIMARY KEY (`id`),
 UNIQUE KEY `media_id` (`media_id`,`user_id`),
 KEY `user_id` (`user_id`),
 CONSTRAINT `subscriptions_media_ibfk_1` FOREIGN KEY (`media_id`) REFERENCES `media` (`id`) ON DELETE CASCADE,
 CONSTRAINT `subscriptions_media_ibfk_2` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:43:51.447

media_id 也有一个索引，而且它是唯一的。它对于 MySQL 来说已经足够了。只是为 user_id 创建了一个单独的索引，因为唯一索引中的 user_id 是第二个，因此它对外键没有用处。

# php - PHP / MYSQL 插入数组 Foreach 循环

> ID：11058891
> 
> 赞同：0
> 
> 时间：2012-06-15T22:21:49.133
> 
> 标签：php, mysql, arrays, insert

这让我很紧张，所以我提前感谢你的帮助。似乎有很多关于这个主题的演练，但似乎我可能会为这只猫剥皮有点不同。. . .

我有一个采购订单表格，我正在使用 javascript 将行动态添加到表中并捕获多个行项目的数据。然后，我正在为数组中的每一列收集数据。例如，我将“Cust_PN”、“数量”、“价格”作为每个列和数组。. . Cust_PN[0] Cust_PN[1] 和 Cust_PN[2] 分别用于行项目 1-3。然后我有 Qty[0]、Qty[1] 和 Qty[2] 等等。

我可以让它正确地回显而不会出现问题。但是，当我发帖时，我只会根据上面的示例发布最后一个条目 *[3] 中的数组数据。

我目前有以下代码/查询。. . 再次任何帮助将不胜感激。

```
$query1 = "INSERT INTO SO_Items (Timestamp,SO_Num,SO_Rev,SO_Line_Item,Cust_PN,Cust_PN_Rev,My_PN,My_PN_Rev,Description,
  Qty,Sale_Price,UOM,Program,Required_Date) 
  SELECT NOW(),'$SO_Num','$SO_Rev','$SO_Line_Item[$a]','$Cust_PN[$a]','$Cust_PN_Rev[$a]','$My_PN[$a]','$My_PN_Rev[$a]','$Description[$a]','$Qty[$a]','$Sale_Price[$a]','$UOM[$a]','$Program[$a]','$Required_Date[$a]'" or die ('Error posting data');

foreach($Cust_PN as $a => $b) {
  mysql_query($query1);
  } 
```

我很确定上面有很多问题。. . 先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T22:40:43.257

您的主要问题是，`$query`在循环之外声明。它使它成为一个常量，并且它也接受值`$a`，`$b`并且是那个时间，未定义，因此导致 SQL 语法无效。

```
foreach($Cust_PN as $a => $b) {
   $query1 = "INSERT INTO SO_Items (Timestamp, SO_Num, SO_Rev, SO_Line_Item, Cust_PN, Cust_PN_Rev, My_PN, My_PN_Rev, Description, Qty, Sale_Price, UOM, Program, Required_Date) VALUES (NOW(), '$SO_Num', '$SO_Rev', '$SO_Line_Item[$a]', '$Cust_PN[$a]', '$Cust_PN_Rev[$a]', '$My_PN[$a]', '$My_PN_Rev[$a]', '$Description[$a]', '$Qty[$a]', '$Sale_Price[$a]', '$UOM[$a]', '$Program[$a]', '$Required_Date[$a]');";

   $q = mysql_query($query1) or die ('Error posting data');

 } 
```

试试看。也修复了您的 SQL 查询。正确的语法是

```
INSERT INTO table_name (column1, column2, column3,...)
VALUES (value1, value2, value3,...) 
```

你已经`SELECT`代替`VALUES`

让我知道它是否有效，否则请告诉我它到底是什么错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T22:31:42.467

foreach 必须在 $query1 之前：

```
foreach($Cust_PN as $a => $b) {

    $query1 = "INSERT INTO SO_Items (Timestamp,SO_Num,SO_Rev,SO_Line_Item,Cust_PN,Cust_PN_Rev,My_PN,My_PN_Rev,Description,
    Qty,Sale_Price,UOM,Program,Required_Date) 
    VALUES(NOW(),'$SO_Num','$SO_Rev','$SO_Line_Item[$a]','$Cust_PN[$a]','$Cust_PN_Rev[$a]','$My_PN[$a]','$My_PN_Rev[$a]','$Description[$a]','$Qty[$a]','$Sale_Price[$a]','$UOM[$a]','$Program[$a]','$Required_Date[$a]')" or die ('Error posting data');

    mysql_query($query1);

  } 
```

# c# - 有没有办法在 Winforms 中对 MainMenu 进行所有者绘制（或类似的东西）？

> ID：11058893
> 
> 赞同：1
> 
> 时间：2012-06-15T22:22:09.867
> 
> 标签：c#, winforms, menubar, aero, dwm

我正在尝试为我的应用程序创建一个类似于 Mozilla Firefox 使用的 MainMenu：

![](../Images/212491ce91e7ec1fb0908e90af682ea0.png)

这样它就可以显示在航空玻璃上。我可以想出几种方法来做到这一点，但它们会很丑陋，并且可能会因为它们是 hackish 而破坏程序的体验。

我想知道是否有一种方法可以自定义绘制`MainMenu`控件，类似于如何覆盖`OnPaint`其他控件上的方法（由于某种原因，`MainMenu`没有）。或者如果这不可能，我可以使用什么样的hacky方法不会破坏用户体验。

是的，我确信在 WPF 中有一种非常简单的方法可以做到这一点，我希望能够花时间学习它，但是我的应用程序已经处于半成熟阶段，而且它会非常此时切换到不同的 UI 平台不方便。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T04:08:24.520

我最终创建了自己的控件，该控件继承 ToolStripMenuItem 并覆盖 OnPaint 并使用 绘制文本，并使用[此处](http://code.google.com/p/szotar/source/browse/trunk/Client/Szotar.WindowsForms/Base/NativeToolStripRenderer.cs)`DrawThemeTextEx`找到的 MenuStrip 渲染器的修改版本，它省略了标题文本的渲染（因此它不会与工具条。`DrawThemeTextEx`

最终产品如下所示：

![:)](../Images/939ed65221d757918c085680bf3b6455.png)

# objective-c - NSPredicate 忽略逗号？

> ID：11058894
> 
> 赞同：1
> 
> 时间：2012-06-15T22:22:14.560
> 
> 标签：objective-c, cocoa-touch, nspredicate, foundation

我已经实现了一个`UISearchDisplayController`允许用户搜索表的方法。目前我用来搜索的谓词如下，

```
NSPredicate *resultPredicate = [NSPredicate predicateWithFormat:@"Name contains[cd] %@", searchText]; 
```

现在假设用户搜索“beans,cooked”，在表中找到相应的匹配项。但是，如果用户在搜索文本中输入“beans cooked”而不使用逗号，则不会找到匹配项。

如何在搜索时重新编写谓词以“忽略”逗号？换句话说，我怎样才能重写它，以便它认为“beans,cooked”等于“beanswritten”（没有逗号）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-17T14:22:45.783

首先是免责声明：

我认为您要做的是为您的搜索算法添加一些“模糊性”，看到您想让您的匹配对用户输入的某些差异不敏感。

谓词（它们是逻辑结构）本质上并不模糊，因此问题和所选工具之间存在潜在的阻抗不匹配。

无论如何，解决它的一种方法可能是向您的模型对象类添加一个方法。

在这种方法中，您可以清理您的姓名字符串，使其仅包含最基本的字符，例如数字、ascii 字母和空格。

由于完全确定性，这样的方法实际上是对象上的只读字符串属性，因此它可用于匹配谓词。

这是一个删除标点符号、重音符号和变音符号的实现：

```
- (NSString *)simplifiedName
{
    // First convert the name string to a pure ASCII string
    NSData *asciiData = [self.name dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];

    NSString *asciiString = [[[NSString alloc] initWithData:asciiData encoding:NSASCIIStringEncoding] lowercaseString];

    // Define the characters that we will allow in our simplified name
    NSString *searchCharacters = @"0123456789 abcdefghijklmnopqrstuvwxyz";

    // Remove anything else
    NSString *regExPattern = [NSString stringWithFormat:@"[^%@]", searchCharacters];

    NSString *simplifiedName = [asciiString stringByReplacingOccurrencesOfString:regExPattern withString:@"" options:NSRegularExpressionSearch range:NSMakeRange(0, asciiString.length)];

    return simplifiedName;
} 
```

现在，可以进行谓词以在简化名称中进行搜索：

```
NSPredicate *pred = [NSPredicate predicateWithFormat:@"self.simplifiedName = %@", searchString]; 
```

您当然希望使用用于清除名称的相同算法清除搜索字符串，因此将其分解为可在两个地方使用的通用方法可能是个好主意。

最后，`simplifiedName`还可以通过在模型对象类中实现一个类别来添加该方法，这样您就不必修改其代码，如果您的对象类是在 Core Data 自动生成的文件中定义的，这很方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:34:33.903

这可能有点 hacky，但您可以从搜索词中删除逗号。

例子：

```
searchText = [searchText stringByReplacingOccurrencesOfString:@"," withString:@""];
NSPredicate *resultPredicate = [NSPredicate predicateWithFormat:@"Name contains[cd] %@", searchText]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T17:45:05.713

我为此类问题找到的最佳解决方案是在每个项目字典中添加一个具有相同名称但所有标点符号、逗号、破折号等的条目，就像在[这个答案中一样](https://stackoverflow.com/questions/4781379/problem-while-using-nspredicate)

# mysql - Mysql 列连接

> ID：11058896
> 
> 赞同：1
> 
> 时间：2012-06-15T22:22:47.203
> 
> 标签：mysql, join

这可能是一个简单的问题，但我无法在任何地方找到答案。这是问题的抽象版本：

*   我有一个表“数据”，其中有一个名为“键”的列和一个名为“值”的列
*   我有另一个表“用户”，其中包含名为“ID”、“Key1”、“Key2”的列
*   我想要某种连接，它将给出列“ID”、“Value1”和“Value2”，其中 Value1 是 Key1 的值，Value 2 是 Key2 的值​​。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:40:25.697

尝试

```
select u.id, d1.v as v1, d2.v as v2 from users u 
inner join data d1 on u.k1 = d1.k 
inner join data d2 on u.k2 = d2.k 
```

您可以检查它是否适用于[SQLFiddle](http://sqlfiddle.com/#!2/57574/4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:30:13.403

```
select d1.value, d2.value from Users 
inner join Data d1 on users.key1 = d1.key 
inner join Data d2 on users.key2 = d2.key 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:51:29.510

```
SELECT
    a.ID,
    b.Value AS Value1,
    c.Value AS Value2
FROM 
    users a
INNER JOIN
    data b ON a.Key1 = b.Key
INNER JOIN
    data c ON a.Key2 = b.Key 
```

# android - 加载依赖于其他共享库的共享库

> ID：11058898
> 
> 赞同：14
> 
> 时间：2012-06-15T22:23:05.573
> 
> 标签：android, linker, android-ndk, gstreamer

**问题：**

我正在 Eclipse 中构建 Android 应用程序，它使用共享库`libgstreamer-0.10.so` *（为 android-8 平台编译的 GStreamer-android NDK Bundle 库）*。我`libs/armeabi`在项目根文件夹中创建了新文件夹并将其放在那里。此外，我已将它附带的所有其他库（其中 158 个）放在同一个文件夹中。如果我把它放在我的主要活动代码中：

```
static{
    System.loadLibrary("gstreamer-0.10");
} 
```

并在 Android-8 模拟器上构建/安装/运行我的应用程序，它会引发此错误：

```
06-15 21:54:00.835: E/AndroidRuntime(402): Caused by: java.lang.UnsatisfiedLinkError: Cannot load library: link_image[1962]:    33 could not load needed library 'libglib-2.0.so' for 'libgstreamer-0.10.so' (load_library[1104]: Library 'libglib-2.0.so' not found) 
```

现在，`libglib-2.0.so`与 位于同一文件夹中`libgstreamer-0.10.so`，为什么没有加载？我得到那个链接器试图从它加载它`/system/lib`，`libglib-2.0.so`但它不在那里，但为什么它不从它所在的位置加载它`libgstreamer-0.10.so`？

所以我用这个命令去发现哪些库`libgstreamer-0.10.so`依赖于：

```
arm-linux-androideabi-readelf -d libgstreamer-0.10.so 
```

结果：

```
Dynamic section at offset 0x118b64 contains 29 entries:
  Tag        Type                         Name/Value
 0x00000001 (NEEDED)                     Shared library: [libglib-2.0.so]
 0x00000001 (NEEDED)                     Shared library: [libgobject-2.0.so]
 0x00000001 (NEEDED)                     Shared library: [libgthread-2.0.so]
 0x00000001 (NEEDED)                     Shared library: [libgmodule-2.0.so]
 0x00000001 (NEEDED)                     Shared library: [libdl.so]
 0x00000001 (NEEDED)                     Shared library: [libm.so]
 0x00000001 (NEEDED)                     Shared library: [libstdc++.so]
 0x00000001 (NEEDED)                     Shared library: [libc.so]
 0x0000000e (SONAME)                     Library soname: [libgstreamer-0.10.so]
 0x00000010 (SYMBOLIC)                   0x0 
```

前四个`libglib-2.0.so, libgobject-2.0.so, libgthread-2.0.so, libgmodule-2.0.so`都位于设备上`libgstreamer-0.10.so`位于 ( `/data/data/com.marko.gstreamer_test/lib`) 中的同一文件夹中。

**逻辑解决方案：**

因此，我尝试在加载之前加载这四个库，`libgstreamer-0.10.so`并且它起作用了：

```
static{
    System.loadLibrary("glib-2.0");
    System.loadLibrary("gthread-2.0");
    System.loadLibrary("gobject-2.0");
    System.loadLibrary("gmodule-2.0");
    System.loadLibrary("gstreamer-0.10");
} 
```

**我的问题是：**

1.  我可以以某种方式告诉链接器也从应用程序位置加载库吗？就像添加一些环境变量的路径或其他东西......类似于Linux上的PATH。

2.  我的解决方案有一些不好的副作用吗？*我的意思是，链接器在加载libgstreamer-0.10.so*之前也会这样做。但这会带来什么问题吗？

3.  我可以将我的库安装到无根设备上的*/system/lib*文件夹吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-18T14:59:10.090

根据[https://groups.google.com/forum/?fromgroups#!msg/android-ndk/J3lzK4X--bM/4YaijymZy_AJ](https://groups.google.com/forum/?fromgroups#!msg/android-ndk/J3lzK4X--bM/4YaijymZy_AJ)

> 是的，这是记录在案的行为：您必须明确地以反向依赖顺序加载库。[...] 这是系统的限制。
> 
> 简而言之，动态链接器对您的应用程序一无所知（例如，它的库所在的位置），它只知道创建进程时设置的 LD_LIBRARY_PATH 值。当你启动一个 Android 应用程序时，你实际上是 fork Zygote 进程，你没有创建一个新的，所以库搜索路径是初始路径并且不包括你的应用程序的 /data/data//lib/ 目录，其中您的本机库已上线。这意味着 dlopen("libfoo.so") 将不起作用，因为只会搜索 /system/lib/libfoo.so。
> 
> 当你从 Java 调用 System.loadLibrary("foo") 时，VM 框架知道应用程序的目录，因此它可以将 "foo" 翻译成 "/data/data//lib/libfoo.so"，然后调用 dlopen()这条完整的路径，它将起作用。
> 
> 它 libfoo.so 引用“libbar.so”，那么动态链接器将无法找到后者。
> 
> 此外，即使您从本机代码更新 LD_LIBRARY_PATH，动态链接器也不会看到新值。由于各种低级原因，动态链接器包含它自己的程序环境副本，就像创建进程时（不是分叉）一样。而且根本没有办法从本机代码更新它。这是设计使然，改变这一点会产生严重的安全限制。作为记录，这也是 Linux 动态链接器的工作方式，这会强制任何需要自定义库搜索路径的程序使用包装脚本来启动其可执行文件（例如 Firefox、Chrome 和许多其他程序）。

我已经给作者发了电子邮件，询问这是在哪里记录的。

Tor Lillqvist 继续提供解决方法：[https ://groups.google.com/d/msg/android-ndk/J3lzK4X--bM/n2zUancIFUEJ](https://groups.google.com/d/msg/android-ndk/J3lzK4X--bM/n2zUancIFUEJ)

> 更详细地说，lo_dlopen() 函数的作用是：
> 
> *   搜索有问题的共享对象在哪里。它搜索一组由 Java 代码传递给它的目录。Java 代码查看 LD_LIBRARY_PATH 并将应用程序的 lib 目录添加到其中。
> *   打开找到的共享对象文件并读取其中的 ELF 结构。不是全部，但足以找出它需要哪些共享对象（由 arm-linux-androideabi-readelf -d 显示的 DT_NEEDED 对象）。它在需要的共享对象上递归调用自己。
> *   只有在那之后，即在确保所有需要的其他共享对象都已加载之后，它才会在找到的共享对象的完整路径名上调用真正的 dlopen()。

[你可以在http://cgit.freedesktop.org/libreoffice/core/tree/sal/android/lo-bootstrap.c?id=5510127e89d6971a219ce3664e4631d6c6dda2b1](http://cgit.freedesktop.org/libreoffice/core/tree/sal/android/lo-bootstrap.c?id=5510127e89d6971a219ce3664e4631d6c6dda2b1)找到他的代码

**更新**：根据[http://code.google.com/p/android/issues/detail?id=34416](http://code.google.com/p/android/issues/detail?id=34416) ，此代码已于 2012 年 12 月集成到 Android 中。耶！对于 API 级别 18 及更高级别的设备，会自动加载依赖项。如果您支持旧的 API 级别，您仍然需要列出依赖项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T23:09:04.670

1.  我不确定你可以为 Java 应用程序做些什么。对于本机命令行应用程序，您可以通过在声明应用程序之前设置 LD_LIBRARY_PATH 环境变量来做到这一点。

2.  这是正确的解决方案。在 NDK 文档中的某处提到您需要以这种方式加载所有依赖库。

3.  不，你不能那样做。

# r - R-函数中的多个返回以创建绘图

> ID：11058902
> 
> 赞同：3
> 
> 时间：2012-06-15T22:23:31.837
> 
> 标签：r

我想编写一个函数来创建一组数字的图并添加一条回归线。到现在为止，我仍然可以创建情节，但我要么得到情节错误，要么得到某种空响应。

我的函数没有返回不返回 null 的回归线，如下所示：

```
fun<-function(){
+   x<-c(1,2,3,4,5)
+   y<-c(1,2,3,4,5)
+   LR<-lm(x~y)
+   
+   return(plot(x,y))
+ }
> fun() 
```

结果很好很漂亮，只有一个情节

如果我将回归线添加到绘图中，我仍然会得到绘图，但也会得到空响应

```
> fun<-function(){
+   x<-c(1,2,3,4,5)
+   y<-c(1,2,3,4,5)
+   LR<-lm(x~y)
+   p<-plot(x,y)
+   a<-abline(LR)
+   return(p)
+ }
> fun()
NULL 
```

或错误

```
> fun<-function(){
+   x<-c(1,2,3,4,5)
+   y<-c(1,2,3,4,5)
+   
+   LR<-lm(x~y)
+   
+   p<-plot(x,y)
+   a<-abline(LR)
+   
+   return(p,a)
+ }
> fun()
Error in return(p, a) : multi-argument returns are not permitted 
```

或两个空值

```
> fun<-function(){
+   x<-c(1,2,3,4,5)
+   y<-c(1,2,3,4,5)
+   
+   LR<-lm(x~y)
+   
+   p<-plot(x,y)
+   a<-abline(LR)
+   
+   return(list(p,a))
+ }
> fun()
[[1]]
NULL

[[2]]
NULL 
```

抱歉，如果这看起来很挑剔，但在实际数据集中它可能会变得丑陋。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T22:29:16.313

这是做你想做的吗？

```
fun <- function(x, y) {
  plot(x, y)
  abline(lm(x~y))
}

fun(1:10, 10:1) 
```

如果您希望绘图对象返回以进行进一步操作，您可以使用`ggplot`：

```
fun <- function(df) {
  ggplot(df, aes(X, y)) + geom_point()
}

df <- data.frame(x=1:10, y=10:1)
p <- fun(df)

# examine p
str(p)

# plot p
p 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T22:30:57.850

你真的需要这个函数来返回绘图对象吗？还是直接绘制就足够了？

我沉迷于 ggplot2 那种东西。此函数同时执行（打印绘图并将其作为对象返回）

```
fun <- function(dataset){
  require(ggplot2)
  p <- ggplot(dataset, aes(x = x, y = y)) + geom_smooth(method = "lm") + geom_point()
  print(p)
  return(p)
}

p1 <- fun(data.frame(x = c(1,2,3,4,5), y = rnorm(5)))
p1 
```

# mercurial - Jenkins、Mercurial、Bitbucket 和 SSH 不工作

> ID：11058905
> 
> 赞同：1
> 
> 时间：2012-06-15T22:23:47.900
> 
> 标签：mercurial, ssh, hudson, jenkins, bitbucket

我正在尝试将 Jenkins 设置为从 bitbucket 存储库中提取（在 Windows Server 2008 上）。我已经生成了一个密钥，将其上传到 bitbucket，将 Mercurial 配置为使用 Plink，正在运行 Pageant，并且可以从命令行克隆。

当我设置 Jenkins 作业时，它会尝试克隆存储库，但只是挂起控制台输出中的“工作”图标

```
Building in workspace <workspace>
$ hg clone --rev default --noupdate ssh://hg@bitbucket.org/user/repo <workspace>
<spinning working icon> 
```

如果我从命令行克隆 repo，我会得到

```
Building in workspace <workspace>
[src] $ hg showconfig paths.default
[src] $ hg pull --rev default
<spinning working icon> 
```

它也只是挂起。我让它在一夜之间运行，没有错误消息，什么都没有。

我可以使用`https://user:pass@bitbucket.org/user/repo`它，它从詹金斯检查得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T00:59:27.397

原来在 32 位 tomcat 中运行的 Jenkins 不喜欢 64 位 plink。我将其更改为 32 位 plink，现在它检查正常。

# class - struct vs class 用于围绕外语编写 D 包装器

> ID：11058906
> 
> 赞同：2
> 
> 时间：2012-06-15T22:23:58.710
> 
> 标签：class, struct, wrapper, d

（注意：这与[D 语言中结构和类之间的使用偏好](https://stackoverflow.com/questions/10965577/usage-preference-between-a-struct-and-a-class-in-d-language)有关，但针对更具体的用例）

在为 C++ 代码编写 D 接口时，SWIG 和其他代码会执行以下操作：

```
class A{
   private _A*ptr;//defined as extern(C) elsewhere
   this(){ptr=_A_new();}//ditto 
   this(string s){ptr=_A_new(s);} //ditto
   ~this(){_A_delete(ptr);} //ditto
   void fun(){_A_fun(ptr);}
} 
```

假设不需要继承。

**我的问题是：为此使用结构而不是类不是更好吗？**

优点是：

1）效率（堆栈分配）

2）易用性（无需到处写新的，例如：`auto a=A(B(1),C(2))`vs `auto a=new A(new B(1),new C(2))`）？

缺点是：需要额外的字段 is_own 来通过 postblit 处理别名。

**最好的方法是什么？** 还有什么需要担心的吗？这是一个尝试：

```
struct A{
   private _A*ptr;
   bool is_own;//required for postblit
   static A opCall(){//cannot write this() for struct
       A a;
       a.ptr=_A_new();
       a.is_own=true;
       return a;
   }
   this(string s){ptr=_A_new(s); is_own=true;} 
   ~this(){if(is_own) _A_delete(ptr);}
   void fun(){_A_fun(ptr);}
   this(this){//postblit; 
       //shallow copy: I don't want to call the C++ copy constructor (expensive or unknown semantics)           
       is_own=false; //to avoid _A_delete(ptr)
   }
} 
```

请注意，在调用以下函数的情况下，postblit 是必需的：

```
myfun(A a){} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T02:14:58.377

我建议你阅读[这个页面](http://dlang.org/cpp_interface.html)。您可以在 D 中调用的 C++ 类上的唯一函数是虚函数。这意味着

> D 不能调用 C++ 特殊成员函数，反之亦然。这些包括构造函数、析构函数、转换运算符、运算符重载和分配器。

当你在 D 中声明一个 C++ 类时，你使用一个`extern(C++) interface`. 所以，你的类/结构看起来像这样

```
extern(C++) interface A
{
   void fun();
} 
```

但是，您需要另一个`extern(C++)`函数来分配任何类型的对象`A`，因为它是 C++ 代码必须这样做，因为 D 代码无权访问任何构造函数。您还需要一种方法将其传递回 C++ 代码，以便在完成后将其删除。

现在，如果您想将该接口包装在一个类型中，该类型将调用`extern(C++)`函数来构造它并调用`extern(C++)`函数来删除它（这样您就不必担心手动执行此操作），那么您是否使用类或 struct 完全取决于你想用它做什么。

一个类将是一个引用类型，它反映了 C++ 类的实际情况。因此，无需您做任何特别的事情，就可以传递它。但是，如果您想要保证包装的 C++ 对象已被释放，则必须手动执行此操作，因为无法保证 D 类的终结器将永远运行（并且大概是您放置代码的地方）调用 C++ 函数来删除 C++ 对象）。您必须使用`clear`（实际上将`destroy`在编译器的下一个版本中重命名为 - dmd 2.060）来销毁 D 对象（即调用其终结器并处理其任何值类型的成员变量的销毁） ，否则您必须调用 D 对象上的一个函数，该函数调用 C++ 函数来删除 C++ 对象。例如

```
extern(C++) interface A
{
   void fun();
}

extern(C++) A createA();
extern(C++) void deleteA(A a);

class Wrapper
{
public:
    this()
    {
        _a = createA();
    }

    ~this()
    {
        deleteA(_a);
    }

    auto opDispatch(string name, Args...)(Args args)
    {
        return mixin("_a." ~ name ~ "(args)");
    }

private:

    A _a;
}

void main()
{
    auto wrapped = new Wrapper();

    //do stuff...

    //current
    clear(wrapped);

    //starting with dmd 2.060
    //destroy(wrapped);
} 
```

但这确实有缺点，如果您不调用`clear`/ `destroy`，并且垃圾收集器永远不会收集您的包装器对象，`deleteA`则永远不会在 C++ 对象上调用。这可能很重要，也可能无关紧要。这取决于 C++ 对象是否真的需要在程序终止之前调用它的析构函数，或者如果 GC 永远不需要收集包装器，当程序终止时它是否可以让它的内存返回给操作系统（而不调用它的析构函数）目的。

如果你想要确定性破坏，那么你需要一个结构。这意味着您需要担心将结构变成引用类型。否则，如果它被复制，当其中一个被销毁时，C++ 对象将被删除，而另一个结构将指向垃圾（然后它将在被销毁时尝试删除）。要解决这个问题，您可以使用[`std.typecons.RefCounted`](http://dlang.org/phobos/std_typecons.html#RefCounted). 然后你会得到类似的东西

```
extern(C++) interface A
{
   void fun();
}

extern(C++) A createA();
extern(C++) void deleteA(A a);

struct Wrapper
{
public:
    static Wrapper opCall()
    {
        Wrapper retval;
        retval._a = createA();
        return retval;
    }

    ~this()
    {
        if(_a !is null)
        {
            deleteA(_a);
            _a = null;
        }
    }

    auto opDispatch(string name, Args...)(Args args)
    {
        return mixin("_a." ~ name ~ "(args)");
    }

private:

    A _a;
}

void main()
{
    auto wrapped = RefCounted!Wrapper();
    //do stuff...
} 
```

您还可以定义包装器，使其具有引用计数逻辑并避免`RefCounted`，但这肯定会更复杂。

无论如何，我绝对不建议您使用 a`bool`来标记包装器是否拥有 C++ 对象的建议，因为如果原始包装器对象在所有副本之前被销毁，那么您的副本将指向垃圾。

如果您*确实*希望使用 C++ 对象的复制构造函数（因此将 C++ 对象视为值类型），则另一个选择是添加一个`extern(C++)`函数，该函数采用 C++ 对象并返回它的副本，然后在 postblit 中使用它.

`extern(C++) A copyA(A a);`

```
this(this)
{
    if(_a !is null)
        _a = copyA(a);
} 
```

希望这能让事情变得足够清楚。

# mysql - 如何在 mysql 查询中按行限制分组？

> ID：11058911
> 
> 赞同：11
> 
> 时间：2012-06-15T22:24:24.623
> 
> 标签：mysql

这里还有其他听起来相似但不是的问题。我有一个查询，它返回一堆带有 group by 的行，我想对总 group by 行应用限制，而不是用于创建组的总行数。

```
ID    TYPE        COLOR        SIZE
----------------------------------------
1     Circle      Blue         Large
2     Circle      Red          Large
3     Square      Green        Large
4     Circle      Purple       Large
5     Circle      Blue         Small
6     Circle      Yellow       Medium
7     Circle      Black        Large
8     Oval        Blue         Large
9     Circle      Gray         Small
10    Triangle    Black        Large
11    Star        Green        Large
12    Triangle    Purple       Large

SELECT size, type FROM clothes WHERE size = 'large' GROUP BY type LIMIT 0, 5

TYPE       SIZE       ROWS
---------------------------    
Circle     Large      4
Square     Large      1 
```

^^^^ 2 组按行已经用尽了我的限制

```
TYPE       SIZE       ROWS
---------------------------    
Circle     Large      4
Square     Large      1
Oval       Large      1
Triangle   Large      2
Star       Large      1 
```

^^^^ 这是我想要的，限制适用于组

必须有一些子查询或我可以在这里做的事情，但我没有弄清楚。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-16T00:25:23.953

这对我有用：

```
SELECT type, size, COUNT(*) AS rows
FROM clothes
WHERE size = 'large'
GROUP BY type
LIMIT 0, 5 
```

结果是：

```
type      size   rows
------------------------
Circle    Large     4
Oval      Large     1
Square    Large     1
Star      Large     1
Triangle  Large     2 
```

LIMIT 应该在 GROUP BY 之后应用，所以我不明白这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T22:33:14.403

```
SELECT * FROM (
  SELECT id, color, size, type FROM clothes WHERE size = 'large' GROUP BY type 
) AS baseview LIMIT 0, 25 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:34:36.240

数数有多少怎么样？

```
select color, size, type, count(id) from clothes where size = 'large' group by size, type, color; 
```

我是 sql 编程的新手，但这应该返回以下内容，这样您就可以为每种颜色/尺寸/类型组合使用 1 行并在其后获得数量计数。

红色大衬衫4

绿色大号衬衫6

绿色大裤2

等等...

# css - How do I remove the "border-bottom" from a specific image that links to other websites?

> ID：11058917
> 
> 赞同：2
> 
> 时间：2012-06-15T22:26:03.273
> 
> 标签：css

I have an add this button on the website that is rendering a border bottom in the subheader. This seems to be because the CSS is attributing a border bottom to all hyperlinks in that subheader box. However, I want to remove the border bottom from the images (twitter, rss) only. I've tried various methods with no success. My most recent attempt involved adding custom CSS to the border bottom: `#subheader a { border-bottom: none; }`

Here is my website: [http://edhaj.tumblr.com/](http://edhaj.tumblr.com/)

Thanks for any help on this!!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:32:03.943

Changing the selector from `#subheader a` to `#subheader > a` does the trick in your case because the links you want to give a border-bottom style are direct child nodes of the div with the id `subheader` but the other linked elements are not.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:33:00.697

Well those images are within your addthis box so did you try:

```
#subheader .addthis_toolbox a {border-bottom: 0 none;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:36:06.427

A new rule like this one should work:

```
#subheader .addthis_toolbox a {
  border-bottom:none;
} 
```

# solr - Solr - 唯一键异常

> ID：11058929
> 
> 赞同：0
> 
> 时间：2012-06-15T22:27:50.020
> 
> 标签：solr, solrj

对于具有现有唯一键的更新请求，Solr 有什么方法可以以某种方式在状态或异常消息中抛出异常。现在，Solr 只是发回一条状态为 0 的良好更新消息，而不添加文档。我需要能够从客户端判断是否由于重复的唯一键问题而未添加文档。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T22:44:24.223

如果存在具有唯一 id 的文档，则 solr 只会更新该文档。这是设计使然，据我所知，没有办法改变它。

您可以在更新/添加文档之前进行 solr 查询，这样您就不会再次添加它......但这并不是真正的事务性（solr 不是数据库）。如果您是唯一一个更新太阳能和更改被序列化等。

如果您对不添加现有 id 有严格的要求，您可以使用中间数据库，加载它并从中重新索引 solr..？

# powershell - #更新注册表权限

> ID：11058930
> 
> 赞同：0
> 
> 时间：2012-06-15T22:27:51.283
> 
> 标签：powershell, permissions, registry

# 更新注册表权限

```
$RegistryAcl = Get-Acl "HKLM:\SYSTEM\CurrentControlSet\services\eventlog\LynxGate"
$RuleObject = @{
TypeName = "system.security.AccessControl.RegistryAccessRule"(
ArgumentList = “CATApplication","FullControl","Allow")
}
$RegistryRule = New-Object $RuleObject
$RegistryAcl.SetAccessRule ($RegistryRule)
$RegistryAcl | Set-Acl -path $RegistryAcl.path
} 
```

我的 powershell 脚本有问题，任何人都可以对我的问题提供一些见解。我正在尝试添加一个名为 CATApplication 的新用户，该用户具有对权限的完全访问权限。但我得到一个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T02:56:46.283

克里斯，你好像忘了问一个问题。但是，我在这里看到一个问题：

```
$RegistryRule = New-Object $RuleObject 
```

应该

```
$RegistryRule = New-Object @RuleObject 
```

因为看起来您的意思是将哈希表分解为新对象。

# cython - 没有命令行的 Cython -a 标志（用于生成黄色阴影的 HTML）

> ID：11058933
> 
> 赞同：27
> 
> 时间：2012-06-15T22:28:56.233
> 
> 标签：cython

从命令行运行时

```
$ cython -a mycode.pyx 
```

你会得到一个非常漂亮的带有黄色阴影的 HTML“注释”文件，以指示慢速 python 操作与快速 C 操作。每次在 Sage 中编译 Cython 代码时，您也会获得相同的 HTML 文件作为链接。我的问题是：（1）如果我使用 distutils 编译，我可以获得这个 HTML 文件吗？(2) 如果我使用 pyximport 编译，我可以得到这个 HTML 文件吗？谢谢！！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-17T22:48:42.310

感谢 larsmans 的评论和[Cython 电子邮件列表](https://groups.google.com/d/topic/cython-users/LZcC92mGx94/discussion)，我现在有许多令人满意的选项可以在不离开 IPython 的情况下生成“注释”HTML 文件：

(1) 使用子进程...

```
import subprocess
subprocess.call(["cython","-a","myfilename.pyx"]) 
```

（2）自己在Cython中开启全局注释标志，编译前：

```
import Cython.Compiler.Options
Cython.Compiler.Options.annotate = True 
```

(3)`annotate=True`传入`cythonize()`[使用[`distutils`编译方法](http://docs.cython.org/src/reference/compilation.html#compiling-with-distutils)时]。

似乎 pyximport 没有自己的直接选项来打开注释。

# javascript - iPhone 应用程序或 Mobile Safari 的动画 PNG 文件的替代方案，目标是模拟短视频剪辑的即时播放

> ID：11058935
> 
> 赞同：0
> 
> 时间：2012-06-15T22:29:06.763
> 
> 标签：javascript, iphone, ios, animation, animated-gif

我们的目标是在有人点击按钮时立即显示 3-5 秒的视频剪辑。

显示实际视频涉及几秒钟的延迟，这是不可接受的。我们需要让回放感觉是即时的。

将这 3-5 秒转换为动画 PNG 是一个很好的选择，但动画 PNG 在 iPhone 应用程序中不起作用。

现在最好的选择是使用用于创建动画 PNG 的相同图像，并在 JavaScript 中为一系列图像制作动画。

谁能想到更好的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:41:37.033

除非您预先加载它们，否则图像与视频存在相同的问题，在大多数蜂窝网络上至少有 700 毫秒的延迟。

你可以做的是让图像精灵充当电影卷轴，类似于谷歌为他们的动画涂鸦所做的。您基本上将整个动画放在一张长图像中，将其放置为背景，然后使用 JavaScript 将背景位置每帧推进一次。例如，如果您想要每 100 毫秒推进 3 秒 200x100 图像，您可以这样做：

```
<div class="thumb" style="background-image: url(vid1.png); width:200px; height:100px" data-frames="30">
</div>

$('.thumb').bind('click', function() {
    var $img = $(this);
    var startTime = Date.now();
    var frames = $img.attr('data-frames');
    var width = $img.width();

    setInterval(function() {
    var frame = Math.round((Date.now() - startTime) / 100) % frames;
        $img.css('background-position', -frame * width + 'px 0';
    }, 100);
}); 
```

**更新**

因为您在这里只是使用图像，所以您不再受格式的约束。您最好的选择是将幻灯片重新编码为 60% 或 85% 的 JPG，从而显着减小文件大小。由于您正在制作动画，因此质量变得不那么重要了。

**更新 2**

我的意思是在超时不完美的情况下包括跳帧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T04:31:23.247

UIImageView 支持动画图像。这是一个用于所有意图和目的的动画 PNG。@Brian 是正确的，但是，除非您预加载，否则您会有一点延迟。

所以我的建议是预加载。

视频也是如此。您可以让 MPMoviePlayerController 全部设置为播放，只是在按下按钮之前不要添加视图并播放。

**动画图像的想法：**

```
- (void)readySet {

    NSMutableArray *images = [NSMutableArray array];

    for (int i=0; i<kIMAGE_COUNT; i++) {
        NSString *fn = [NSString stringWithFormat:@"image%d.png"];
        UIImage *image = [UIImage imageNamed:fn];
        [images addObject:image];
    }
    self.myUIImageView.animationImages = [NSArray arrayWithArray:images];
}

// go runs fast if we run readySet first
//
- (void)go {

    [self.myUIImageView startAnimating];
} 
```

**视频创意**

```
// A little more complex because we need to get notified that it's ready to play,
// but the same principal...

- (void)readySet {

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlayerLoadStateChanged:) name:MPMoviePlayerLoadStateDidChangeNotification object:nil];

    MPMoviePlayerController *player = [[MPMoviePlayerController alloc] initWithContentURL:url];

    player.shouldAutoplay = NO;
    [player prepareToPlay];
    self.mp = player;
}

- (void)moviePlayerLoadStateChanged:(NSNotification*)notification {

    MPMovieLoadState state = [self.mp loadState];
    if (state & MPMovieLoadStatePlaythroughOK) {
        [[NSNotificationCenter defaultCenter] removeObserver:self name:MPMoviePlayerLoadStateDidChangeNotification object:nil];

        self.mp.view.frame = CGRect(/* where it will appear */)
    }
}

// go runs fast if we run readySet first (and the movie is ready)
//
- (void)go {

    MPMovieLoadState state = [self.mp loadState];
    if (state & MPMovieLoadStatePlaythroughOK) {
        [self.view addSubview:self.mp.view];
        [self.mp play];
    } else {
        self.mp.shouldAutoplay = YES;
    }
} 
```

# jquery - 不会在点击时更新链接的 ID

> ID：11058937
> 
> 赞同：3
> 
> 时间：2012-06-15T22:29:29.833
> 
> 标签：jquery

我有这个函数来创建对另一个文件的请求以更新数据库：

```
$('#thumb-up').live('click', function() {
    $('#loading').show();

    $.ajax({
            context: this,
            type: 'GET',
            url: '/gallery/configurations/required/photo-thumbs.php',
            data: 'i=21&t=1',
            success: function() {
                                  $('#loading').hide();
                                  $(this).attr('id', 'thumbup-undo').text('Sluta gilla');
                                  $('#thumbup-count').load('/gallery/configurations/required/thumbup-count.php?i=21&t=1');
                                 }
    });
});

$('#thumbup-undo').click(function() {
    alert('das');
}); 
```

当我单击带有 id 的链接时，`thumb-up`文本按预期更改为“Sluta gilla”。当我现在单击此链接时，相同 a 标记的 ID 将从更改为`thumb-up`，`thumbup-undo`并且将出现警报“dsa”。这里的问题是它没有出现！我什至不知道它是否会改变，`thumbup-undo`但我希望它不会。

[您可以在此处](http://jsfiddle.net/HbSjm/)尝试代码（我已缩短代码以使演示正常工作）。

我该如何解决这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:33:34.393

**请尝试这个演示** [http://jsfiddle.net/kxLzu/](http://jsfiddle.net/kxLzu/)

我已经使用`.prop`和`.on`绑定点击，然后在成功时我告诉`foo`这个点击存在。

希望能帮助到你 ：）

请注意：`.live`已弃用，`.on`应改为使用。

**代码**

```
 $('#thumb-up').click(function() {
        $.ajax({
                context: this,
                type: 'GET',
                success: function() {
                       $(this).prop('id', 'thumbup-undo').text('Sluta gilla');
                      foo();
                                     }
        });
    });

function foo(){
    $('#thumbup-undo').on('click', function() {
        alert('das');
    });
}
​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T22:36:51.250

```
$('body').on('click','#thumb-up', function() {
    $('#loading').show();

    $.ajax({
            context: this,
            type: 'GET',
            url: '/gallery/configurations/required/photo-thumbs.php',
            data: 'i=21&t=1',
            success: function() {
                                  $('#loading').hide();
                                  $(this).attr('id', 'thumbup-undo').text('Sluta gilla');
                                  $('#thumbup-count').load('/gallery/configurations/required/thumbup-count.php?i=21&t=1');
                                 }
    });
});

$('body').on('click','#thumbup-undo', function() {
    alert('das');
}); 
```

您必须使用 ON，因为在页面加载后会向 dom 添加一个“新”元素。请记住 .live 在最新版本的 Jquery 中已弃用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:32:28.737

问题是，在分配时，`$("#thumbup-undo")`不存在。它只是稍后创建的。

您可以通过使用来解决这个问题`.live()`，就像在[这个更新的 Fiddle](http://jsfiddle.net/HbSjm/1/)中一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T22:33:09.777

使用[.on](http://api.jquery.com/on/)代替
`.click()`（因为这是您的示例中的问题：`#thumbup-undo`创建单击处理程序时不存在）
并且代替`.live()`（因为[在 jquery 1.7 中已弃用](http://api.jquery.com/live/)`live()`）。

# php - 随机化/随机排列数组，然后是 foreach，然后限制为 10 个结果（Facebook API + PHP）

> ID：11058944
> 
> 赞同：0
> 
> 时间：2012-06-15T22:30:17.617
> 
> 标签：php, facebook, facebook-graph-api, foreach

我这里有一个使用 Facebook API 的 PHP 页面。

我要做的是（在用户设置权限后），通过以下方式获取用户朋友的用户 ID：`$facebook->api('/me/friends')`。问题是，我只想**随机获得 10 个朋友**。我可以通过使用轻松地将结果限制为 10 `/me/friends?limit=10`，但话又说回来，这不是随机的。

所以这就是我现在所拥有的：

```
 $friendsLists = $facebook->api('/me/friends');

     function getFriends($friendsLists){
       foreach ($friendsLists as $friends) {
          foreach ($friends as $friend) {
             // do something with the friend, but you only have id and name
             $id = $friend['id'];
             $name = $friend['name'];
        shuffle($id);
     return "@[".$id.":0],";
          }
       }
     }

$friendsies = getFriends($friendsLists);
$message = 'I found this Cover at <3 '.$Link.'

'.$friendsies.' check it out! :)'; 
```

我已经尝试过 shuffle()，以及这里的第一个选项：[https](https://stackoverflow.com/a/1656983/1399030) ://stackoverflow.com/a/1656983/1399030 ，但我认为我可能做错了，因为他们没有返回任何东西。我很确定我已经很接近了，但是到目前为止我尝试过的方法都不起作用。可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:45:14.690

你会想在你 foreach 之前使用洗牌，这样你就可以真正洗牌了。

之后，您将希望限制为 10 个朋友。我建议添加一个 $i var 数到十，然后添加到一个新数组中。

像这样的东西：

```
function getFriends($friendsLists){
   $formatted_friends = array();
   $i = 0;
   foreach ($friendsLists as $friends) {
      // I'm guessing we'll need to shuffle here, but might also be before the previous foreach
      shuffle($friends);
      foreach ($friends as $friend) {
         // do something with the friend, but you only have id and name
         // add friend as one of the ten
         $formatted_friends[$i] = $friend;
         // keep track of the count
         $i++;
         // once we hit 10 friends, return the result in an array
         if ($i == 10){ return $formatted_friends; }
      }
   }
 } 
```

请记住，它会返回一个数组，而不是可以在回显中使用的字符串。如果需要，可以将其放入 echo 以进行调试：

```
echo 'friends: '.print_r($friendsies, true); 
```

# ruby-on-rails - Rails 应用程序架构和通用设置

> ID：11058946
> 
> 赞同：0
> 
> 时间：2012-06-15T22:30:56.930
> 
> 标签：ruby-on-rails, ruby, architecture, infrastructure

因此，我开始着手公司项目，该项目将包含几个组成部分：

首先...

1.  工作清单
2.  客户档案创建和管理
3.  用户管理和访问（登录、注册、角色等）

之后...

1.  消息传递
2.  日程
3.  基本报告

以后……

1.  更深入的分析和双

我想知道将每个子弹项目作为自己的 Rails 项目、自包含和模块化是否有意义（如果确实如此）；或者最好放在同一个应用程序中。我可以设想这样一种情况，即每个模块都可以彼此独立地运行，以至于它不需要其余的（除了用户功能），另一种情况是所有模块都可以一起使用。

在我看来，许多任务都可以用像 Sinatra 这样的轻量级框架来处理（然后物理地位于 rails 应用程序下）。在服务器上运行多个 Rails 应用程序似乎也有很多开销。但我并不完全了解操作每个场景的所有优点和缺点。

我知道这是一个一般性的问题，肯定会得到很多“它取决于”类型的响应（这是正确的）我是一个准菜鸟，所以要温柔。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T22:49:08.117

一般来说，我会认为网站是 Rails 应用程序的合适目标。应用程序的每个部分都可以在应用程序中拥有自己的命名空间，因此应用程序内部有一些结构，但它们都应该是一个应用程序。考虑诸如会话之类的事情，您希望用户在其中登录并使用您想要的站点的任何功能。您希望在一个应用程序中进行这些会话，而无需用户登录到不同的部分。

话虽如此，如果存在不属于 MVC 架构的复杂或扩展功能（例如与外部 API 通信、数据挖掘等），那么您可以将其偏移到一个单独的项目中，并将其作为 Gem 包含在你的申请。您仍然会有一个包含这些 Gem 的主要 Rails 应用程序。

您可能还希望将项目的一部分捆绑到一个可重用的 Rails 引擎中，该引擎可以加载到多个项目中。例如，[Devise](https://github.com/plataformatec/devise)处理用户登录和管理。它是一个 Rails 引擎，捆绑为 Gem，您可以将其包含在项目中。

[Meducation](http://www.meducation.net)（我的网站之一）的另一个例子。我正在将我们的电子邮件跟踪系统提取到[它自己的 Rails 引擎](https://github.com/ihid/email_tracker)中，因为我觉得它的功能与 Meducation 并列，而不是它的核心部分。然后我也可以在其他项目中使用它。

在您的具体示例中，我认为您的要求非常适合一个 Rails 应用程序。

# java - Selenium WebDriver：与远程浏览器通信时出错。它可能已经死了

> ID：11058948
> 
> 赞同：3
> 
> 时间：2012-06-15T22:31:07.773
> 
> 标签：java, selenium, webdriver

这是我的 Selenium 浏览器测试类（派生类，但应该不难理解它在做什么）。当我运行测试用例时，所有交互都按预期发生。但最终测试用例的结果显示失败。

```
package dmswebui.CR;

import org.infineta.webui.selenium4j.MainTestCase;

public class TestLogin extends MainTestCase {

  @Override
  public void setUp() throws Exception {
    super.setUp();
    startSeleniumSession("ChromeDriver", "http://192.168.8.207/");
  }

  public void testMethod() throws Exception {

        session().open("/");
        session().type("name=user","admin");
        session().type("name=password","infineta123");
        session().click("id=btnLogin-button");      session().waitForPageToLoad("30000");
        session().click("id=btnUserLogout-button");
        session().click("id=yui-gen0-button");      session().waitForPageToLoad("30000");
  }
  public void tearDown() throws Exception {
        super.tearDown();
        closeSeleniumSession();
  }
} 
```

我得到的错误是：

```
Testcase: testMethod took 13.939 sec
Caused an ERROR
Error communicating with the remote browser. It may have died. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T18:18:36.403

当您尝试多次关闭同一个 webdriver 实例时，通常会发生这种情况。你知道发生了`super.teardown()`什么吗？当我检查 selenium4j 源时，它扩展了 junit 测试用例。您`super.tearDown`将调用 jUnitTeardown 并在调用之前杀死浏览器实例`closeSeleniumSession()`。

你可以把它放在`closeSeleniumSession()`前面`super.tearDown()`。

# ruby-on-rails - 为什么在 Ubuntu 中安装 JSON gem 时会出错？

> ID：11058952
> 
> 赞同：22
> 
> 时间：2012-06-15T22:31:28.630
> 
> 标签：ruby-on-rails, ruby, json, ubuntu, gem

使用 Ubuntu，当我运行“ `bundle install`”来设置我的 Rails 环境时，它会在 JSON gem 安装过程中引发错误：

```
Installing json (1.7.3) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

/usr/bin/ruby1.9.1 extconf.rb 
/usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError)
    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from extconf.rb:1:in `<main>'

Gem files will remain installed in /home/danny/.bundler/tmp/2040/gems/json-1.7.3 for inspection.
Results logged to /home/danny/.bundler/tmp/2040/gems/json-1.7.3/ext/json/ext/parser/gem_make.out
An error occured while installing json (1.7.3), and Bundler cannot continue.
Make sure that `gem install json -v '1.7.3'` succeeds before bundling. 
```

当我尝试仅安装 JSON 1.7.3 gem 时，它也会给我一个错误：

```
Building native extensions.  This could take a while...
ERROR:  Error installing json:
    ERROR: Failed to build gem native extension.

/usr/bin/ruby1.9.1 extconf.rb
/usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError)
    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from extconf.rb:1:in `<main>'

Gem files will remain installed in /var/lib/gems/1.9.1/gems/json-1.7.3 for inspection.
Results logged to /var/lib/gems/1.9.1/gems/json-1.7.3/ext/json/ext/parser/gem_make.out 
```

我已经安装了 RVM 并且正在运行 Ruby 1.9.3；为什么它不能安装 JSON gem？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-06-15T22:36:37.887

安装`ruby1.9.1-dev`软件包应该可以为您解决这个问题：

```
sudo apt-get install ruby1.9.1-dev 
```

# jquery - 无法到达层次结构中的特定元素

> ID：11058953
> 
> 赞同：1
> 
> 时间：2012-06-15T22:31:32.633
> 
> 标签：jquery

我不能直接使用 $('commentbody') 因为有很多评论和选择需要在这个特定区域内完成。

html:

```
<div class="commentline">
    <div class="carrowholder">
        <div class="ctoggle"></div>
        <div class="arrowwrap">
        </div>
    </div>
    <div class="commentholder">
        <div class="commenttitle">
            Title
        </div>
        <div class="commentbody">
            Body
        </div>
    </div>
</div> 
```

jQuery：

```
$('.ctoggle').click(function(e) {
    $(this).parent().next('.commentholder > .commentbody').hide();
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:35:20.267

您的尝试失败，因为您正在寻找与选择器匹配的父元素的*兄弟：*

```
.commentholder > .commentbody 
```

没有兄弟姐妹会匹配那个（`.commentholder`是兄弟姐妹，但你正在寻找那个的孩子），所以你需要将孩子选择器移出。您可以使用[`children`](http://api.jquery.com/children/)（或[`find`](http://api.jquery.com/find/)）：

```
$('.ctoggle').click(function(e) {
    $(this).parent().next().children('.commentbody').hide();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:34:51.140

```
$('.ctoggle').click(function(e) {
    $(this).parent().next().find('.commentbody').hide();
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T22:40:55.133

来自 API 文档：“获取匹配元素集中每个元素的紧随其后的同级。如果提供了选择器，则仅当它与该选择器匹配时才检索下一个同级。”

因此，您的选择器匹配兄弟姐妹的孩子，因此您将一无所获。尝试：

```
var x = $(this).parent().next('.commentholder');
x.find('.commentbody').hide(); 
```

（这在您的示例中有效）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T22:45:08.120

给定以下 HTML：

```
<!DOCTYPE html>
<html>
<head>
[include jQuery here]
<meta charset=utf-8 />
<title>JS Bin</title>
<!--[if IE]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<style>
  article, aside, figure, footer, header, hgroup, 
  menu, nav, section { display: block; }
</style>
</head>
<body>
  <div class="commentline">
    <div class="carrowholder">
        <div class="ctoggle">Click to toggle</div>
        <div class="arrowwrap">
        </div>
    </div>
    <div class="commentholder">
        <div class="commenttitle">
            Title 1
        </div>
        <div class="commentbody">
            Body 1
        </div>
    </div>
  <div class="commentline">
    <div class="carrowholder">
        <div class="ctoggle">Click to toggle</div>
        <div class="arrowwrap">
        </div>
    </div>
    <div class="commentholder">
        <div class="commenttitle">
            Title 2
        </div>
        <div class="commentbody">
            Body 2
        </div>
    </div>
</div>
</body>
</html> 
```

此 Javascript 将起作用：

```
$('.ctoggle').click(function(e) {
    $(this).closest('.commentline').find('.commentbody').toggle();
}); 
```

这样做是在 DOM 中找到第一个具有类的元素`.commentline`（它是所有 DIV 的父注释），然后它在 DOM 树的该分支中找到所有具有该类的元素`.commentbody`，在这种情况下很好，因为每个评论行只有一个评论体。`.commentbody`如果每个 DIV 中有更多DIV，`.commentline`那么您需要进一步指定哪个 DIV（使用`.first()`或`.find()`再次等）。

已经提到了其他解决方案，但我发现这种方法更具可读性，因此可维护 - 但这是我的观点：O）

# javascript - Google plus 如何在 contenteditable div 中实现 Javascript 纯文本“粘贴”？

> ID：11058958
> 
> 赞同：2
> 
> 时间：2012-06-15T22:31:59.210
> 
> 标签：javascript, dom-events, google-plus

我在 Stack Overflow 中看到了很多答案，解释了我们如何通过监听`keydown`事件并将焦点重定向到位于屏幕外的文本区域来删除文本粘贴的格式。此解决方案很好，但不解决使用上下文菜单或浏览器菜单进行粘贴的问题。

Google Plus 确实使用`contenteditable`div 作为用户帖子的编辑器，即使使用上下文菜单，那里的粘贴也能正常工作。有谁知道他们是如何取得这个好成绩的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T14:21:12.367

我做了一些测试，我认为我能够重现这种行为。我只使用 Google Chrome 和 Firefox 测试过这个解决方案，所以它可能在许多浏览器中都有问题。我怀疑 Google Plus 在不能使用这种技术时会优雅地降低用户体验。

为了实现这个功能，我在粘贴事件期间将焦点重定向到屏幕外的一个 div。div 收到粘贴内容，超时后，我得到了 div 的文本（使用 jquery 删除 html 标签）。示例代码：

```
var object = this;     
this.$editable.on("paste", function(evt) {
    object.saveCursorPosition();
    var textarea= $("<div contenteditable></div>");
    textarea.css("position",  "absolute").css("left", "-1000px").css("top", object.$editable.offset().top + "px").attr("id","pasteHelper").appendTo("body");
    textarea.html('<BR>');
    textarea.focus();

    setTimeout(function() {
        object.$editable.focus();
        object.restoreCursorPosition();
        object.insertTextAtCursor(textarea.text());
        textarea.remove();
    }, 0);

}); 
```

# jquery - 悬停时的 CSS 元素过渡

> ID：11058960
> 
> 赞同：0
> 
> 时间：2012-06-15T22:32:23.747
> 
> 标签：jquery, css, jquery-animate, drop-down-menu, css-transitions

我正在尝试复制类似[http://www.gk-films.com](http://www.gk-films.com)上的扩展悬停菜单之类的内容，但采用 HTML5/CSS3 方式。它们有一个绝对位于窗口右侧的小元素，悬停时会扩展为带有选项的全角菜单。

到目前为止，我已经尝试了 jQuery 和特定于浏览器的过渡效果，但无法提出可靠的工作解决方案。

我现在的基础工作是这样的：http: [//jsfiddle.net/z64vX/](http://jsfiddle.net/z64vX/)

```
<nav>
    <ul>
        <li><a href="#main">Main</a></li>
        <li><a href="#services">Services</a></li>
        <li><a href="#works">Works</a></li>
        <li><a href="#contact">Contact</a></li>
    </ul>
</nav>

body { background: #bbb; }
nav { display: block }

nav { 
    position: absolute; 
    top: 0; 
    right: 30%; 
    width: 300px; 
    height: 40px; 
    z-index: 950; 
    background: rgba(255,255,255,0.9); 
    -webkit-transition: left 0.5s ease, right 0.5s ease;
}
nav:hover { 
    right: 0; 
    left: 0; 
    width: auto; 
    height: auto;
}
nav ul { display: none; width: 100%; }
nav:hover ul { display: block; } 
```

问题是过渡对于导航容器的定位和宽度不能正常工作（它只是跳转到末尾的“左”值）。

理想情况下，菜单元素会在扩展完成后淡入，所以如果你也加入那部分会很棒。

也许，最好通过 jQuery 的 animate 函数来做，但我不想在这里用不同的代码变体造成混乱。

* * *

经过一番摆弄后，我实际上正在使用 jQuery animate：http: [//jsfiddle.net/z64vX/6/](http://jsfiddle.net/z64vX/6/)

```
$(function(){
    var nav = $("nav"),
    navHeight = nav.height();

    nav.hover(
        function() {
            navOn();
        }, function() {
            navOff();
        }
    );

    var navOn = function(){
        nav.stop().animate({right: '0%', width: '100%', height: navHeight}, 1000, function() {
            $(this).find("ul").fadeIn('slow');
        });
    };

    var navOff = function(){
        nav.animate({right: '10%', width: '200px', height: '20px'}, 500).find("ul").fadeOut(100);
    };

    navOff();
}); 
```

关于使用它的防弹性有什么想法吗？或者如果有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T06:41:15.503

[这个 jsfiddle](http://jsfiddle.net/seyfollahi/a8edq/)应该可以帮助你。

```
body { background: #bbb; }
nav { display: block }

nav {
    position: absolute;
    top: 0;
    right: 30%;
    width: 30%;
    height: 40px;
    z-index: 950;
    background: rgba(255,255,255,0.9);
    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    overflow:hidden;
}
nav:hover {

    width: 100%;
    right:0;
    height: 90px;
}
nav ul { display: none; width: 100%; padding:5px;}
nav:hover ul { display: block; } 
```

但是你不能设置`height:auto;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:49:20.883

你可以用这个。

```
body { background: #bbb;text-align:center; }
nav { display: inline-block; }

nav { 
    top: 0; 
    text-align:left; 
    width: 40%; 
    height: 40px; 
    z-index: 950; 
    background: rgba(255,255,255,0.9); 
    -webkit-transition: width 0.5s ease;
}
nav:hover { 
    width: 100%; 
    height: auto;
}
nav ul { display: none; width: 100%; }
nav:hover ul { display: block; }
​ 
```

# java - 使用 hamcrest 和 mockito dsl 在 intellij 中配置自动完成

> ID：11058963
> 
> 赞同：4
> 
> 时间：2012-06-15T22:32:39.237
> 
> 标签：java, autocomplete, intellij-idea, mockito, hamcrest

我想知道是否可以在测试类中配置 Intellij 的智能插入以建议 hamcrest 和 mockito dsl 习惯用法。真的，我正在寻找像 eclipse 的“静态收藏夹”这样的东西，这样当我点击 ctrl + space 或 ctrl +shift +space 时，就会出现成语。

一般来说，是否可以为此配置自动完成/智能插入或建议气球。我已经查看了设置，但运气不佳，但很容易忽略了一些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T08:03:43.587

我认为无法调整智能插入功能，但我能够为 Mockito 创建自己的实时模板。由于 IntelliJ 在导出方面有点受限，我只是发布了一个手动创建它们的指南。

该页面是法文的，但最重要的部分应该对于说英语的读者来说是可以理解的。

[http://blog.arkey.fr/2011/10/21/quelques-live-template-intellij-pour-mockito/](http://blog.arkey.fr/2011/10/21/quelques-live-template-intellij-pour-mockito/)

页面中可能存在一些拼写错误，这些实时模板也是在旧版本的 IntelliJ 上创建的。如果您遇到有关它们的问题，请告诉我。

您应该能够为 Hamcrest 创建自己的实时模板。你也试过 FEST-Assert，我发现这个库的 API 很好用。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-28T15:42:05.107

就 Eclipse 最喜欢的导入功能而言：在使用 Intellij 时，您是否尝试过使用`Alt`+ `Return`？

当我使用 Mockito 时，我只需编写`mock(MyService.class)`，然后按`Alt`+`Return`即可选择静态导入方法`Mockito.mock`。

# java - 有没有好的通用 JPA DAO 实现？

> ID：11058972
> 
> 赞同：5
> 
> 时间：2012-06-15T22:33:17.150
> 
> 标签：java, jpa, dao

根据[这篇文章](http://java.dzone.com/articles/jpa-implementation-patterns)，通用 JPA DAO（数据访问对象）是一个非常好的模式。

有什么好的实现吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T22:36:48.783

您可以查看[Spring Data JPA](http://blog.springsource.org/2011/02/10/getting-started-with-spring-data-jpa/)。

Spring Data JPA 中引入了一些新概念，例如基于方法名称的查询创建，因此您可以声明一个类似的方法`findById(String id)`，“通用”实现将解释该方法的名称并执行类似的操作`select Entity from Entity where id = 'given string'`

`findByNameAndLastName(String name, String lastName)`甚至`findByNameOrInternalId(String name, int internalId)`也支持类似的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T23:21:35.433

只想为 JPA 提几个更通用的 dao 实现：

*   通用 DAO 工具包 - [http://code.google.com/p/generic-dao/](http://code.google.com/p/generic-dao/)
*   SO 中的相关问题 - [单一 DAO 和通用 CRUD 方法（JPA/Hibernate + Spring）](https://stackoverflow.com/q/3888575/204788)
*   关于 JPA DAO 的一篇很好的博客文章 - [http://blog.xebia.com/2009/03/09/jpa-implementation-patterns-data-access-objects/](http://blog.xebia.com/2009/03/09/jpa-implementation-patterns-data-access-objects/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-20T13:21:13.780

[Querydsl](http://www.querydsl.com)支持 JPA，并广泛支持为查询构建复杂的谓词。

它不支持更新和插入，但您可以使用 Spring Data，因为 Querydsl 还与 Spring 存储库集成。

# xml - 如何测试某个 XML 节点是否存在？

> ID：11058980
> 
> 赞同：9
> 
> 时间：2012-06-15T22:34:23.980
> 
> 标签：xml, delphi

测试可选节点是否存在的正确方法是什么？我的 XML 片段是：

```
<Antenna >
  <Mount Model="text" Manufacture="text">
   <BirdBathMount/>
  </Mount>
</Antenna> 
```

但也可能是：

```
<Antenna >
  <Mount Model="text" Manufacture="text">
   <AzEl/>
  </Mount>
</Antenna> 
```

Antenna 的孩子可以是 BirdBath 或 AzEl，但不能同时是...

在 Delphi XE 中，我尝试过：

```
 if (MountNode.ChildNodes.Nodes['AzEl'] <> unassigned then //Does not work
 if (MountNode.ChildNodes['BirdBathMount'].NodeValue <> null) then // Does not work
 if (MountNode.BirdBathMount.NodeValue <> null) then  // Does not work 
```

我使用 XMLSpy 创建模式和示例 XML，它们可以正确解析。我使用 Delphi XE 创建绑定，它适用于大多数其他组合。

这*一定*有一个我刚刚忽略的简单答案——但是什么？谢谢......吉姆

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-16T00:46:29.620

您可以使用 XPath，试试这个示例。

```
uses
  MSXML;

Var
  XMLDOMDocument  : IXMLDOMDocument;
  XMLDOMNode      : IXMLDOMNode;
begin
  XMLDOMDocument:=CoDOMDocument.Create;
  XMLDOMDocument.loadXML(XmlStr);
  XMLDOMNode := XMLDOMDocument.selectSingleNode('//Antenna/Mount/BirdBathMount');
  if XMLDOMNode<>nil then
    Writeln('BirdBathMount node Exist')
  else
  begin
    XMLDOMNode := XMLDOMDocument.selectSingleNode('//Antenna/Mount/AzEl');
    if XMLDOMNode<>nil then
      Writeln('AzEl node Exist');
  end;
end; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-16T17:34:09.527

使用 .FindNode。如果节点不存在，则返回 nil。

例如

```
xmlNode := MountNode.ChildNodes.FindNode('AzEl');
if Assigned(xmlNode) then
... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T03:12:52.217

我已经成功测试过了。使用此代码。它有点复杂，我需要一个根元素。

**xml文件**

```
<ThisIsTheDocumentElement>
<Antenna >
  <Mount Model="text" Manufacture="text">
   <BirdBathMount/>
  </Mount>
</Antenna>
<Antenna >
  <Mount Model="text" Manufacture="text">
   <AzEl/>
  </Mount>
</Antenna>
</ThisIsTheDocumentElement> 
```

**Delphi2010.pas**

```
procedure TForm1.RetrieveDocument;
var
  LDocument: IXMLDocument;
  LNodeElement, LNode,BNode,CNode : IXMLNode;
  I: Integer;
begin
  LDocument := TXMLDocument.Create(nil);
  LDocument.LoadFromFile(XmlFile);
  LNodeElement := LDocument.ChildNodes.FindNode('ThisIsTheDocumentElement');
  if (LNodeElement <> nil) then
  begin
    for I := 0 to LNodeElement.ChildNodes.Count - 1 do
    begin
      LNode := LNodeElement.ChildNodes.Get(I);
       if (LNode <> Nil) AND (LNode.NodeName='Antenna') then begin
          Memo1.lines.Add('Node name: ' + LNode.NodeName);
          BNode:=LNode.ChildNodes.FindNode('Mount');
         if (BNode <> Nil) then CNode:=BNode.ChildNodes.FindNode('AzEl');
            if (CNode <> Nil) then Memo1.lines.Add('found: '+CNode.NodeName) else continue;
       end;
    end;
  end;
end; 
```

**输出：**

```
Node name: Antenna
Node name: Antenna
found: AzEl 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T00:22:55.743

对我有用的是：

```
if (MountNode.ChildNodes.FindNode('AzEl') <> nil) then 
```

我不清楚它如何`nil`响应 TXMLDocumnet 上的选项设置，`doAttrNull`但它可以工作。

# ubuntu - hadoop 示例作业因网络错误而失败

> ID：11058983
> 
> 赞同：0
> 
> 时间：2012-06-15T22:34:38.237
> 
> 标签：ubuntu, hadoop

我正在运行一个包含三个节点的测试集群（一个真实系统，两个虚拟机）。所有三个 ubuntu 10.1 或更高版本。Hadoop 版本 1.0.2 和配置单元 0.8.1

现在，基本工作正常，节点能够相互通信，数据包正在被复制等等。进程运行良好。

作为测试用例，我尝试运行标准的 hadoop 字数统计示例。那个 map/reduce 工作失败了——

```
Call to <my_NameNode_HostName>127.0.0.1:9000 failed on connection exception:
 java.net.ConnectException: Connection refused 
```

尽管工作继续进行，但有时它只是挂起，有时它会在失败之前重复此消息（当然还有堆栈跟踪）几次。令人惊讶的是，无论是在屏幕上还是在输出目录中，都不会产生任何输出。

这是我运行的命令 -

```
hadoop jar hadoop*examples*.jar wordcount /text_data /txt_output 
```

hadoop在path中，jar文件在当前目录下，3个文本文件已经复制到hdfs目录/text_data

谷歌搜索似乎也没有找到有用的东西......在这里寻求帮助......

编辑：我忘了添加其他作业（例如由配置单元查询触发）运行得很好。SSH 是跨三个节点设置的，并且所有边缘都经过了连接性测试，没有密码挑战。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T02:24:49.207

似乎问题出在NameNode上。你的名字节点起来了吗？

我将尝试在下面确定问题：

1) 在主节点尝试 jps 以查看名称节点守护进程是否正在运行 2) 验证名称节点 hadoop/logs/ 的日志 3) 验证 /etc/hosts/ 配置和 masters 文件配置

# c++ - 一次从文件中读取多行而不包含部分行的方法

> ID：11058984
> 
> 赞同：2
> 
> 时间：2012-06-15T22:34:40.017
> 
> 标签：c++, file, input

我正在从 CSV 文件中读取、解析并存储数据，非常简单。

现在正在使用标准`readLine()`方法来做到这一点，我正试图从这个处理循环中挤出一些额外的效率。我不知道他们在幕后隐藏了多少，但我认为每次调用`getLine`都是一个新的操作系统调用，会带来所有的痛苦？我不想为每一行输入的操作系统调用付费。我会提供一个巨大的缓冲区，并让它一次用多行填充缓冲区。

但是，我只关心完整的行。我不想处理从一个缓冲区读取中维护部分行以附加到第二个缓冲区读取以形成一整​​行，这既丑陋又烦人。

那么，有没有一种方法可以为我做到这一点？似乎几乎必须有。我可以指示读取 x 行数或 x 字节但不输出最后部分行的任何方法，甚至是我管理内存缓冲区的简单方法，因此我最大限度地减少了处理部分字符串的代码量将不胜感激。我可以使用 Boost，但如果标准 C++ 中有方法，我会更喜欢。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T22:55:43.343

您不太可能比内置的 C++ 流做得更好。他们相当快。一般来说，完全读取文件的最快方法是使用单个线程从头到尾读取整个文件，特别是如果文件在磁盘上是连续的。此外，在读取过程中，磁盘可能比操作系统更成为瓶颈。如果您需要提高应用程序的性能，我有一些建议。

*   使用分析器。如果您的应用程序正在读取一行然后以某种方式对其进行解析或处理，则解析或处理可能是可以优化的。这可以在分析中确定。如果解析或处理占用大量 CPU 资源，那么优化可能是值得的。
*   如果您确定解析或处理是导致应用程序缓慢的原因，并且无法轻松优化，请考虑多道程序设计。如果单个行的处理不依赖于正在处理的先前行的结果，则使用多个线程或 CPU 来进行处理。
*   如果您必须处理多个文件，请使用流水线。例如，假设您的应用程序中有四个阶段：读取、解析、处理、保存。一次读取一个文件可能比一次读取所有文件更有效。但是，在读取第二个文件时，您仍然可以解析第一个文件。在读取第三个文件时，您可以解析第二个文件并处理第一个文件，等等。实现这一点的一种方法是[分阶段的多线程应用程序设计](http://en.wikipedia.org/wiki/Staged_event-driven_architecture)。
*   使用 RAID 改善磁盘读取。某些突袭模式可以创建更快的读取和写入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T22:47:27.970

我是java程序员，但我仍然有一个提示......读取流中的数据。这意味着例如 2048 字节（或更多）的 4 或 5 倍...您可以遍历流（并转换它）并搜索您的行尾（或其他字符）...但我认为“readLine”反正也在做同样的事情......

# objective-c - Cocos2d如何根据视网膜从平铺地图中获取对象位置？

> ID：11058996
> 
> 赞同：0
> 
> 时间：2012-06-15T22:36:24.217
> 
> 标签：objective-c, cocos2d-iphone

嘿伙计们，我的瓦片地图中有一个对象用于生成点参考，问题是 -hd 版本是非-hd 版本的两倍，所以：

(width = 生成字符的宽度) int spawnX = (width/2) + [tilemap spawnX];

在高清模式下获取错误的位置，因为瓦片地图以像素为单位，而 cocos2d 以点为单位。

IE 我可以测试是否支持视网膜显示，但据我所知，这有点狡猾。

你怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:48:28.750

在 cocos2d v2.0 rc2 上正确支持 Retina 显示。

首先，确保`[director_ enableRetinaDisplay:YES]`在您的应用启动时调用所有其他 cocos2d 初始化内容。

然后，用于`CC_CONTENT_SCALE_FACTOR() * pointCount`从中获取像素。在与宏相同的标头中还定义了其他便利宏，`CC_CONTENT_SCALE_FACTOR()`以帮助您`CGRect`将以点为单位的 s 等转换为像素，反之亦然。

# r - R-在函数结束后访问在用户定义的函数中创建的变量

> ID：11058999
> 
> 赞同：2
> 
> 时间：2012-06-15T22:36:44.337
> 
> 标签：r

取一个基本函数

```
fun<-function(){
x<-c(1,2,3,4,5)
y<-c(1,2,3,4,5)

t<-x+y
return(t)

} 
```

运行函数后，有没有办法可以访问函数中创建的任何变量。通过指定变量 - 像这样：

```
fun$y 
```

或者

```
fun$t 
```

或者是否有某种方式要求 R 将变量保存在函数中以在我当前的 R 会话期间使用（我不希望永久保存它）。又名类似的东西：

```
fun<-function(){
x<-c(1,2,3,4,5)
y<-c(1,2,3,4,5)

t<-x+y
Y<-save y for latter use
T<-save T for latter use
return(t)

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T22:50:22.003

您不能在其范围之外使用变量。

您可以做的是使用列表从您的函数返回多个值。

这是一个很好的[例子](https://stackoverflow.com/a/8936179/1117415)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T23:14:18.603

是和不是。

**是**的，从技术上讲，可以对函数范围之外的变量进行赋值，以便可以在其他地方访问它们。通常，这是使用其中之一来完成`<<-`的，如果找不到被分配的变量，它会在全局环境中分配，或者`assign`直接调用并指定环境。

但...

**不**，您可能**不**应该这样做。R 是一种函数式语言，这意味着它的使用目的是使其函数不会产生副作用。如果您过多地违反此原则，您将不可避免地遇到严重的问题，这些问题即使不是不可能调试也很困难。

如果您在稍后需要的函数中创建变量，最好将它们全部返回到列表中，如 Benito 所述。