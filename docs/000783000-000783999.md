# StackOverflow 问答 000783000-000783999

# c# - LinqToXML：获取具有给定值的元素

> ID：783011
> 
> 赞同：1
> 
> 时间：2009-04-23T18:41:05.353
> 
> 标签：c#, linq, linq-to-xml

我有这个 xml 文件：

```
<objects>
  <object> 
    <value>test</value>
  </object>
  <object> 
    <value>foo</value>
  </object>
  <object> 
    <value>bar</value>
  </object>      
</objects> 
```

现在，我想查询这个 xml，并检索 value-element = "foo" 中的文本的所有对象元素

有没有一种简单的方法可以做到这一点？

我尝试过这样的事情：

```
var objects = from e in xml.Elements("value")
              where e.Value.Equals("foo", StringComparison.OrdinalIgnoreCase)
              select e.parent; 
```

那不行。。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T18:47:03.870

我想你正在寻找

```
xml.Descendants("value") 
```

xml.Elements() 只返回子元素...如果 xml 是您的根 XDocument，它不会返回任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T18:53:43.700

假设您从文档根目录查询，您应该使用*xml.Descendants 。*此外，我更喜欢使用*string.Equals*而不是*Equals*方法调用由元素的*Value*属性返回的字符串（仅作为偏好问题。）例如：

```
var objects = from e in xml.Descendants("value")
                where string.Equals(e.Value, 
                                    "foo", 
                                    StringComparison.OrdinalIgnoreCase)
                select e.Parent; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T18:46:36.837

```
 var objects = from e in xml.Descendants("object").Elements("value")
                          where e.Value.Equals("foo", StringComparison.OrdinalIgnoreCase)
                          select e.Parent; 
```

# stream - Red5流flv文件

> ID：783013
> 
> 赞同：1
> 
> 时间：2009-04-23T18:41:50.450
> 
> 标签：stream, flv, red5

我正在检查 Red5 的 oflaDemo。我想知道如何更改 oflaDemo 以便可以将某个 flv 文件流式传输给所有订阅者...

```
/** {@inheritDoc} */
    @Override
    public boolean appConnect(IConnection conn, Object[] params) {
        // Trigger calling of "onBWDone", required for some FLV players
        measureBandwidth(conn);
        if (conn instanceof IStreamCapableConnection) {
            IStreamCapableConnection streamConn = (IStreamCapableConnection) conn;
            SimpleConnectionBWConfig bwConfig = new SimpleConnectionBWConfig();
            bwConfig.getChannelBandwidth()[IBandwidthConfigure.OVERALL_CHANNEL] =
                1024 * 1024;
            bwConfig.getChannelInitialBurst()[IBandwidthConfigure.OVERALL_CHANNEL] =
                128 * 1024;
            streamConn.setBandwidthConfigure(bwConfig);
        }

            serverStream = StreamUtils.createServerStream(appScope, "live0");
            SimplePlayItem item = new SimplePlayItem();
            item.setStart(0);
            item.setLength(10000);
            item.setName("IronMan");
            serverStream.addItem(item);
            item = new SimplePlayItem();
            item.setStart(20000);
            item.setLength(10000);
            item.setName("DarkKnight");
            serverStream.addItem(item);
            serverStream.start();
            serverStream.setRepeat(true);

        return super.appConnect(conn, params);
    } 
```

上面代码的结果对于所有订阅者来说只是一个空白屏幕......

你们有人知道吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T10:50:26.847

我遇到了同样的问题。我发现空白屏幕是因为什么行

```
serverStream.setRepeat(true); 
```

如果您将重复设置为 false 一切正常

**UPD：** 我认为这是 red5 错误。我做了一个技巧来连续重复一个flv。我添加了自定义播放列表控制器：

```
public class MyPlayListController implements IPlaylistController {
    @Override
    public int nextItem(IPlaylist playlist, int itemIndex) {
        return 0;
    }

    @Override
    public int previousItem(IPlaylist playlist, int itemIndex) {
        return 0;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-03T16:40:28.883

这在客户端更容易完成，如果您不想硬编码流名称，您可以将其名称作为 flash var 传递。

# asp.net - 可编辑的 GridView 存储视图状态中的更改直到保存

> ID：783017
> 
> 赞同：5
> 
> 时间：2009-04-23T18:42:32.057
> 
> 标签：asp.net, gridview, viewstate

我知道如何拥有一个可编辑的 GridView 以及一个 SqlDataSource，其中每个编辑（更新/插入/删除）都会立即保存到数据库中（使用 SqlDataSource 的 UpdateCommand、Insertcommand 等）。

我现在需要的是有一个可编辑的 GridView，它在视图状态中维护所有编辑，直到用户在表单的其他位置按下“保存”按钮。

换句话说：

1.  首次加载时，从数据库数据填充 GridView
2.  用户对数据进行了各种编辑，这些编辑还没有保存到数据库中，但是可以通过任意数量的回发来保存。
3.  用户按下保存，所有更改都保存到数据库中

我假设我需要编写自定义代码来保存第 3 步中的数据，但是第 2 步是否有一种直接的、开箱即用的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T20:13:10.543

您想使用 DataSet 或 DataTable 并使用以下内容：

```
myDataSet.AcceptChanges(); 
```

当您在 DataSet、DataTable 或 DataRow 上调用该方法时，这将提交更改。可以把它想象成一个需要提交或回滚的 SqlTransaction。希望这可以帮助！

查看链接：[接受更改](http://msdn.microsoft.com/en-us/library/ceab2k93(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-24T22:03:46.107

我可以建议执行以下操作：
1）创建一个自定义列表对象来存储您的数据。将数据库数据上传到该对象并将其保存到会话状态。

目的：

```
 public class InvestorClaim  
  {  
    public InvestorClaim()  
    {  
    }

    private int? _record_id;
    private int? _ic_record_id;
    private Int64? _lh_record_id;

    public int? record_id
    {
      get { return _record_id; }
      set { _record_id = value; }
    }

    public int? ic_record_id
    {
      get { return _ic_record_id; }
      set { _ic_record_id = value; }
    }

    public Int64? lh_record_id
    {
      get { return _lh_record_id; }
      set { _lh_record_id = value; }
    }  
} 
```

将数据上传到列表：

```
List<InvestorClaim> inv_claim = new List<InvestorClaim>();  

inv_clai= dataFromDB 
```

保存到会话：

```
 HttpContext.Current.Session[ "InvestorClaimsObject" ] = inv_claim; 
```

2）将gridview绑定到对象并根据需要操作数据。

```
 protected void yourGridView_Bind()  
  {   
    inv_claim = HttpContext.Current.Session[ "InvestorClaimsObject" ] as List<InvestorClaim>;  
    yourGridView.DataSource = inv_claim;  
    BindData();   
  }  

  protected void yourGridView_RowUpdating(object sender, GridViewUpdateEventArgs e)  
  {      
    inv_claim = HttpContext.Current.Session[ "InvestorClaimsObject" ] as List<InvestorClaim>;  

    //Update the values.
    GridViewRow row = yourGridView.Rows[e.RowIndex];
    inv_claim[row.DataItemIndex].lh_record_id = ((TextBox)(row.Cells[1].Controls[0])).Text;
    inv_claim[row.DataItemIndex].ic_record_id = ((TextBox)(row.Cells[2].Controls[0])).Text;

    //Reset the edit index.
    yourGridView.EditIndex = -1;

    //Bind data to the GridView control.
    yourGridView.DataSource = inv_claim;
    BindData();  
} 
```

3）准备好后将数据从会话列表对象保存到数据库。

# c++ - 如何优雅地从 C++ 向量中提取二维矩形区域

> ID：783018
> 
> 赞同：1
> 
> 时间：2009-04-23T18:43:38.077
> 
> 标签：c++, templates, stl, boost, vector

这个问题很基本。（我很困惑为什么搜索没有找到任何东西）

我有一个矩形“图片”，它在 std::vector 中逐行存储它的像素颜色

我想从那张图片中复制一个矩形区域。

我将如何在 C++ 中优雅地编写代码？

我的第一次尝试：

```
 template <class  T>    std::vector<T> copyRectFromVector(const std::vector<T>& vec, std::size_t startx,  std::size_t starty, std::size_t endx, std::size_t endy, std::size_t fieldWidth, std::size_t fieldHeight)
    {
     using namespace std;
    vector<T> ret((endx-startx)*(endy-starty)+10);  // 10: chickenfactor

    // checks if the given parameters make sense:
    if (vec.size() < fieldWidth*endy)
    {
        cerr << "Error: CopyRectFromVector: vector to small to contain rectangular region!" << std::endl;
        return ret;
    }

    // do the copying line by line:
    vector<T>::const_iterator vecIt = vec.begin();
    vector<T>::forward_iterator retIt = ret.end();

    vecIt += startx + (starty*fieldWidth);
     for(int i=starty; i < endy; ++i)
    {
            std::copy(vecIt, vecIt + endx - startx, retIt);
        }
        return ret;
} 
```

甚至不编译.....

补充：澄清：我知道如何“手工”做到这一点。这不是问题。但我会喜欢一些 c++ stl 迭代器魔法，它做同样的事情，但速度更快，而且……更 c++ 时尚。

补充：我给算法图片数据向量、图片的宽度和高度以及一个矩形，表示我想从图片中复制出来的区域。返回值应该是包含矩形内容的新向量。

把它想象成打开你最喜欢的图像编辑器，然后从中复制一个矩形区域。图片存储为像素颜色的长一维数组（向量）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T18:46:51.703

```
for (int r = startRow; r < endRow; r++)
    for (int c = startCol; c < endCol; c++)
        rect[r-startRow][c-startCol] = source[r*rowWidth+c]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T20:51:34.120

基本上是相同的想法，除了它可以编译并且更迭代：

```
#include <vector>
#include <algorithm>
#include <iostream>
#include <iterator>

template <typename I, typename O> 
void copyRectFromBiggerRect(
    I input,
    O output,
    std::size_t startx,  
    std::size_t cols, 
    std::size_t starty, 
    std::size_t rows, 
    std::size_t stride
) {
    std::advance(input, starty*stride + startx);
    while(rows--) {
        std::copy(input, input+cols, output);
        std::advance(input, stride);
    }
}

template<typename T>
std::vector<T> copyRectFromVector (
    const std::vector<T> &vec, 
    std::size_t startx,  
    std::size_t starty, 
    std::size_t endx, 
    std::size_t endy, 
    std::size_t stride
) {
    // parameter-checking omitted: you could also check endx > startx etc.

    const std::size_t cols = endx - startx;
    const std::size_t rows = endy - starty;

    std::vector<T> ret;
    ret.reserve(rows*cols);
    std::back_insert_iterator<std::vector<T> > output(ret);

    typename std::vector<T>::const_iterator input = vec.begin();
    copyRectFromBiggerRect(input,output,startx,cols,starty,rows,stride);
    return ret;
}

int main() {
    std::vector<int> v(20);
    for (int i = 0; i < 20; ++i) v[i] = i;
    std::vector<int> v2 = copyRectFromVector(v, 0, 0, 1, 2, 4);
    std::copy(v2.begin(), v2.end(), std::ostream_iterator<int>(std::cout, "\n"));
} 
```

我不希望这比按索引复制的两个循环更快。甚至可能更慢，尽管它基本上是 vector::push_back 的开销和 std::copy 在循环中的增益之间的竞争。

但是，如果您的其他模板代码通常设计为与迭代器一起使用，而不是矢量作为特定容器，它可能会更灵活。copyRectFromBiggerRect 可以像使用向量一样轻松地使用数组、双端队列甚至列表作为输入，尽管它目前对于非随机访问的迭代器来说并不是最佳的，因为它目前在每个复制的行中前进两次。

对于使它更像其他 C++ 代码的其他方法，考虑多维数组的 boost::multi_array （在这种情况下，实现将与此完全不同），并避免返回集合，例如按值向量（首先它可以如果您没有获得返回值优化，则效率低下，其次，将对分配哪些资源的控制留在可能的最高级别）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T20:50:11.500

好的 C++ 代码首先必须易于阅读和理解（就像任何代码一样）、面向对象（就像面向对象语言中的任何代码），然后应该使用语言工具来简化实现。

我不会担心使用 STL 算法让它看起来更像 C++，最好以面向对象的方式开始简化可用性（接口）。不要在外部使用普通矢量来表示您的图像。提供一定程度的**抽象**：创建一个代表图像的类并在其中提供您需要的功能。**这将通过封装**来自常规使用的细节来提高可用性（2D 区域对象可以知道它的尺寸，用户不需要将它们作为参数传递）。这将使代码更加**健壮**，因为用户可以减少错误。

即使您使用 STL 容器，也请始终首先考虑**可读性**。如果按照常规 for 循环实现更简单，并且使用 STL 算法更难阅读，请忘记它们：让您的代码简单且可维护。

这应该是你的重点：制作更好、更简单、更易读的代码。使用语言特性来改进你的代码，而不是你的代码来锻炼或炫耀语言的特性。如果您需要在两个月后维护该代码，它将获得回报。

注意：使用更多的 STL 不会使您的代码在 C++ 中更加惯用，我相信这是其中一种情况。滥用 STL 会使代码实际上变得更糟。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T23:20:47.333

您的问题要求使用 C++ 方法来复制某个容器中的矩形元素字段。你有一个相当接近的例子，并且会在答案中得到更多。不过，让我们概括一下：

您需要一个迭代器，它可以在一定范围的元素上遍历矩形范围的元素。那么，如何编写一种适配器，它位于任何容器上并提供这个特殊的迭代器。

将在这里使用代码进行广泛的笔触：

```
vector<pixels> my_picture;
point selTopLeft(10,10), selBotRight(40, 50);
int picWidth(640), picHeight(480);
rectangular_selection<vector<pixels> > selection1(my_picture.begin(),
  my_picture.end(), picWidth, picHeight, selTopLeft, selBotRight);

// Now you can use stl algorithms on your rectangular range
vector<pixels> rect_copy = std::copy(selection1.begin(), selection1.end());
// or maybe you don't want to copy, you want 
// to modify the selection in place
std::for_each (selection1.begin(), selection1.end(), invert_color); 
```

我确信这是完全可行的，但我不喜欢即兴编码 stl 样式的模板内容。如果我有时间并且您有兴趣，我可能会在稍后重新编辑草稿，因为这是一个有趣的概念。

请参阅此[SO 问题的答案](https://stackoverflow.com/questions/757153/concatenating-c-iterator-ranges-into-a-const-vector-member-variable-at-construc)以获得灵感。

# .net - 如何使用 LINQ 查询作为数据源过滤 BindingSource

> ID：783020
> 
> 赞同：6
> 
> 时间：2009-04-23T18:44:30.197
> 
> 标签：.net, data-binding, filter

我无法让筛选器在作为 DataGridView 控件的数据源的 BindingSource 上工作。基本上，我有 LINQ 查询，它是 BindingSource 的数据源，我想过滤掉结果。下面是我想要完成的一个例子。

```
Dim query = From row In dataTable _
            Select New MyRow(row)

Dim bs As New BindingSource()
bs.DataSource = query.ToList()

grid.DataSource = bs

bs.Filter = "Col1 = 'value'" 
```

...

```
Public Class MyRow
    Private _key As String
    Private _col1 As String

    Public Sub New(ByVal row As DataTableRow)
        _key = GetNewKeyValue()
        _col1 = row.Col1
    End Sub

    Public ReadOnly Property Key() As String
        Get
            Return _key
        End Get
    End Property

    Public ReadOnly Property Col1() As String
        Get
            Return _col1
        End Get
    End Property
End Class 
```

因此，我可以看到 DataGridView 控件中的所有行，但过滤器没有任何效果。如果我将 BindingSource 的 DataSource 切换为使用 DataTable，则过滤将按预期工作。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T18:52:11.363

从 BindingSource 文档：

> 通常用于复杂的数据绑定场景，Filter 属性允许您查看 DataSource 的子集。只有实现 IBindingListView 接口的底层列表才支持过滤

# python - wxPython：使用 EVT_IDLE

> ID：783023
> 
> 赞同：3
> 
> 时间：2009-04-23T18:45:30.817
> 
> 标签：python, wxpython

我定义了一个处理程序，`EVT_IDLE`它为我执行某个后台任务。（该任务是从几个进程中获取已完成的工作并将其集成到某个对象中，在 GUI 中进行可见的更改。）

问题是当用户没有移动鼠标或做任何事情时，`EVT_IDLE`不会被多次调用。我希望这个处理程序一直在工作。所以我尝试`event.RequestMore()`在处理程序结束时调用。工作，但现在它需要大量的CPU。（我猜它只是在该任务上过度循环。）

我愿意限制每秒执行任务的次数；我怎么做？

还是您有其他解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T20:27:04.037

像这样的东西（最多每秒执行一次）：

```
...

def On_Idle(self, event):
    if not self.queued_batch:
        wx.CallLater(1000, self.Do_Batch)
        self.queued_batch = True

def Do_Batch(self):
    # <- insert your stuff here
    self.queued_batch = False

... 
```

哦，别忘了在构造函数中将 self.queued_batch 设置为 False，并且可能在 On_Idle 中以某种方式调用 event.RequestMore()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T20:43:20.613

这听起来像是 wxTimerEvent 而不是 wxIdleEvent 的用例。当需要处理时调用 wxTimerEvent.Start()。当没有任何事情可做时，调用 wxTimerEvent.Stop() 并调用您的方法从 EVT_TIMER 进行处理。

（注意：我从 wxWidghets 使用 C++ 并且不熟悉 wxPython，但我认为他们有类似的 API）

# c - open() 返回“没有这样的设备”错误，但是有这样的设备（linux）

> ID：783030
> 
> 赞同：5
> 
> 时间：2009-04-23T18:48:42.417
> 
> 标签：c, linux, linux-kernel, linux-device-driver, kernel-module

我正在尝试使用一个有点旧的 DAQ，并且不得不跳过一些圈来获得一个旧的（大约 2004 年）设备驱动程序来编译它（[DTI-DT340 Linux-DAQ-PCI](http://bmicfl.tripod.com/id12.html)）。

我已经到了可以编译的地步，我可以加载内核模块，它找到卡，我可以使用 mknod 创建字符设备。

但是当我尝试打开这些设备时，我似乎无法打开这些设备并不断收到*errno 19 (ENODEV) 'No such device'*

```
open("/dev/dt340/0",O_RDWR); 
```

但是 mknod 对制作它没有任何抱怨，而且它就在那里：

```
# ls -l /dev/dt340/
total 0
crw-rw-r-- 1 root staff 250, 0 2009-04-23 11:02 0
crw-rw-r-- 1 root staff 250, 1 2009-04-23 11:02 1
crw-rw-r-- 1 root staff 250, 2 2009-04-23 11:02 2
crw-rw-r-- 1 root staff 250, 3 2009-04-23 11:02 3 
```

有什么我忽略的事情吗？打开失败的原因可能是什么？

这是我用来加载驱动程序和制作设备的脚本。

```
#!/bin/bash
module="dt340"
device="dt340"
mode="664"

# invoke modprobe with all arguments we were passed
#/sbin/modprobe -t misc -lroot -f -s $module.o $* || exit 1
insmod $module.ko

# remove stale nodes
rm -f /dev/${device}/[0-3]

major=`awk "\\$2==\"$module\" {print \\$1}" /proc/devices`
mkdir -p /dev/${device}
mknod /dev/${device}/0 c $major 0
mknod /dev/${device}/1 c $major 1
mknod /dev/${device}/2 c $major 2
mknod /dev/${device}/3 c $major 3

# give appropriate group/permissions, and change the group
# not all distributions have staff; some have "users" instead
group="staff"
grep '^staff:' /etc/group > /dev/null || group="users"

chgrp $group /dev/${device}/[0-3]
chmod $mode  /dev/${device}/[0-3] 
```

一些附加信息：

```
#grep dt340 /proc/devices 
250 dt340
# lsmod | grep dt340
dt340                  21516  0 
# tail /var/log/messages
Apr 23 11:59:26 ve kernel: [  412.862139] dt340 0000:03:01.0: PCI INT A -> GSI 22 (level, low) -> IRQ 22
Apr 23 11:59:26 ve kernel: [  412.862362] dt340: In function dt340_init_one:
Apr 23 11:59:26 ve kernel: [  412.862363] Device DT340 Rev 0x0 detected at address 0xfebf0000
#lspci | grep 340
03:01.0 Multimedia controller: Data Translation DT340 
```

回答： printk 确认 -ENODEV 是从 open() 内部抛出的。遵循旧式

```
while ((pdev = pci_find_device(PCI_VENDOR_ID_DTI, PCI_ANY_ID, pdev))) 
```

（已弃用），`if(!pdev)`以 true 结束，并返回 -ENODEV。

我越来越近了——我想我必须完成并更新 pci 代码以使用更现代的机制......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T20:09:32.893

如果设备显示在 /proc/devices 中，并且您确定 mknod 中的号码正确，则驱动程序本身拒绝打开。驱动程序可以从 open() 返回任何错误代码 - 包括“没有这样的设备”，如果它发现初始化硬件的问题，它可能会返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T19:28:41.883

我猜这是驱动程序的问题，请检查打开功能。

它显示在 /proc/devices 中，因此所有通用设备的东西似乎都可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T18:52:54.387

mknod 不关心是否有与给定的主要/次要数字相对应的设备。您确定 insmod 正在安装您的模块吗？lsmod 告诉你什么？

我不熟悉必须添加“.ko”扩展名。这是特定于您的设备驱动程序的东西吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-19T20:01:24.763

检查 lspci 并确保硬件已正确初始化。如果您的系统支持热插拔，pci_find_device 将不起作用。这个问题是一个refcnt。处理和学习的最佳方式是剖析 API。波尔！！

# javascript - 在 IE 中使用 Javascript 难以捕获日文字符输入

> ID：783037
> 
> 赞同：6
> 
> 时间：2009-04-23T18:51:05.937
> 
> 标签：javascript, actionscript-3, apache-flex, unicode, keyboard

我正在尝试将键盘输入从 Javascript 传递到使用 Internet Explorer 显示的 Flex 应用程序，在 Windows XP 语言栏中输入语言设置为日语（使用完整片假名）。在初始击键后，我将焦点从 Javascript 传递到 Flex 中的文本字段。一旦焦点位于 Flex 中，IME 就会唤醒并且日文字符的输入行为正常。不幸的是，最初的击键并没有进入 IME 编辑器，所以我希望传递击键的 unicode 键值。Javascript 中的 keyDown 事件仅报告 keyCode 229 和 charCode 0。关于在使用日语输入时在 Javascript 中获取可用键或字符代码的任何想法？

谢谢，菲利普

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-20T23:49:17.253

尝试使用“keypress”而不是“keydown”，向下箭头的键码应该是 40。

你也可以试着找出一个错误——吃第一个 char 看起来很奇怪。

# iis-6 - 全新 Server 2003 SP2 安装上的 IIS 6.0 问题

> ID：783039
> 
> 赞同：0
> 
> 时间：2009-04-23T18:51:13.067
> 
> 标签：iis-6, windows-server-2003

不幸的是，我没有太多的技术信息可以给你，但我会尽可能详细地描述。

我已经完成了 Windows Server 2003 Enterprise (SP1) 的全新安装。执行了包括 SP2 在内的所有更新并安装了 McAfee Enterprise 8.7。完成此操作后，我打开 Windows 组件安装并检查应该安装基本 IIS 安装的“应用程序服务器”。

安装运行良好，我重新启动只是为了更好地衡量。当我进入服务时，我看到 IIS Admin 已启动。拉起 IIS 管理器显示 DefaultAppPool 和 Default Web Site 都已停止。尝试启动默认网站不会导致失败消息和事件日志中的条目。这并不让我感到非常惊讶，因为它取决于 DefaultAppPool。当我在几秒钟后尝试启动 DefaultAppPool 时，我收到一个错误“服务没有及时响应启动或控制请求。” 并且仍然没有消息写入事件日志。

我现在已经两次尝试了这个确切的安装过程，结果相同。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T13:22:11.323

如果不是完整的解决方案，我找到了解决方法。我在更新或安装 McAfee 之前安装并配置了 IIS。IIS 工作正常。既然我让它工作了，我不想回去重新安装，但现在我想起来了，我可能只需要在安装 IIS 后再运行一次更新。我安装它的顺序确实让我能够让它工作，祝其他有这个问题的人好运。我希望这有帮助。

# jquery - 向页面添加额外的 javascript 时出现问题

> ID：783040
> 
> 赞同：1
> 
> 时间：2009-04-23T18:51:18.433
> 
> 标签：jquery

```
function slideSwitch() {
var $active = $('#slideshow DIV.active');

if ( $active.length == 0 ) $active = $('#slideshow DIV:last');

// use this to pull the divs in the order they appear in the markup
var $next =  $active.next().length ? $active.next()
    : $('#slideshow DIV:first');

// uncomment below to pull the divs randomly
// var $sibs  = $active.siblings();
// var rndNum = Math.floor(Math.random() * $sibs.length );
// var $next  = $( $sibs[ rndNum ] );

$active.addClass('last-active');

$next.css({opacity: 0.0})
    .addClass('active')
    .animate({opacity: 1.0}, 1000, function() {
        $active.removeClass('active last-active');
    });
} 
```

我将此脚本添加到带有附加 js 的页面中，它可以独立运行，但现在它在 firebug、newbie、thx 中出现错误以寻求任何帮助......

```
$(function() {
     setInterval( "slideSwitch()", 5000 );
}); 
```

错误信息是：

```
$ is not defined index.html()()index.html (line 126)
$(function() { 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T18:55:38.733

您确定新页面包含 jquery 吗？

如果是这样，请逐个添加代码以缩小问题发生的范围。让我知道发生什么事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T18:55:57.627

看起来您正在使用[jQuery](http://jquery.com)，尽管您没有提及它。你加载了 jQuery 库吗？[Prototype](http://prototypejs.org)库还定义了一个`$()`函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:19:32.593

您在执行 javascript 代码后加载 jquery。那根本行不通。将您的 javascript 放在一个外部文件中并在 jquery 之后加载它。

# .net-3.5 - .Net 3.5 中的 Windows 服务开发

> ID：783044
> 
> 赞同：2
> 
> 时间：2009-04-23T18:51:25.047
> 
> 标签：.net-3.5, windows-services

我目前正在开发一个具有 .Net 3.5 目标的 Windows 服务。

我对此有很多问题：

1.  尽管我在解决方案中有一个安装项目，但即使安装程序成功完成，它也不会安装服务（平台是 vista）。我必须使用 .Net 2.0 文件夹而不是 3.5 文件夹中的 InstallUtil.exe 手动安装服务。

2.  我无法使用 ConfigrationManager 对象访问 app.config。我怀疑这是因为正在运行的服务不是从它的安装目录运行的。有谁知道我在运行时安全地访问它的方法？

任何有关此主题的建议和经验将不胜感激。

詹姆士

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T19:13:45.867

我最近自己做了这个，这里的代码允许你通过“/install”或“/uninstall”作为命令行选项来安装你的服务。如果您愿意，可以将其更改为自动安装。它还可以正常访问 app.config（我的原始服务在其主循环中执行此操作）。如您所见，我将其设置为以特定用户身份运行，但您可以设置 spi.Account = ServiceAccount.LocalSystem; 并省略名称和密码。希望这可以帮助：

```
namespace MyService
{   
    public class ServiceMonitor : ServiceBase
    {
        private System.ComponentModel.Container _components = null;
        private static string _service_name = "MyServiceName";

        public ServiceMonitor()
        {
            InitializeComponent();
        }

        private void InitializeComponent()
        {
            this.CanHandlePowerEvent = true;
            this.CanPauseAndContinue = true;
            this.CanShutdown = true;
            this.CanStop = true;
            this.ServiceName = _service_name;
        }

        protected override void Dispose(bool disposing)
        {
            if (disposing && _components != null)
            {
                _components.Dispose();
            }
            base.Dispose(disposing);
        }

        static void Main(string[] args)
        {
            string opt = null;            

            if (args.Length >= 1)
            {
                opt = args[0].ToLower();
            }

            if (opt == "/install" || opt == "/uninstall")
            {
                TransactedInstaller ti = new TransactedInstaller();
                MonitorInstaller mi = new MonitorInstaller(_service_name);

                ti.Installers.Add(mi);

                string path = String.Format("/assemblypath={0}", Assembly.GetExecutingAssembly().Location);
                string[] cmdline = { path };

                InstallContext ctx = new InstallContext("", cmdline);

                ti.Context = ctx;

                if (opt == "/install")
                {
                    Console.WriteLine("Installing");
                    ti.Install(new Hashtable());
                }
                else if (opt == "/uninstall")
                {
                    Console.WriteLine("Uninstalling");
                    try
                    {
                        ti.Uninstall(null);
                    }
                    catch (InstallException ie)
                    {
                        Console.WriteLine(ie.ToString());
                    }
                }
            }
            else
            {
                ServiceBase[] services;
                services = new ServiceBase[] { new ServiceMonitor() };
                ServiceBase.Run(services);
            }
        }

        protected override void OnStart(string[] args)
        {
            //
            // TODO: spawn a new thread or timer to perform actions in the background.
            //
            base.OnStart(args);
        }

        protected override void OnStop()
        {
            //
            // TODO: stop your thread or timer
            //
            base.OnStop();
        }
    }

    [RunInstaller(true)]
    public class MonitorInstaller : Installer
    {
        public MonitorInstaller()
            : this("MyServiceName")
        {
        }

        public MonitorInstaller(string service_name)
        {
            ServiceProcessInstaller spi = new ServiceProcessInstaller();

            spi.Account = ServiceAccount.User;
            spi.Password = ConfigurationManager.AppSettings["Password"];
            spi.Username = ConfigurationManager.AppSettings["Username"];

            ServiceInstaller si = new ServiceInstaller();

            si.ServiceName = service_name;
            si.StartType = ServiceStartMode.Automatic;
            si.Description = "MyServiceName";
            si.DisplayName = "MyServiceName";

            this.Installers.Add(spi);
            this.Installers.Add(si);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T18:53:24.357

安装该服务需要在您的安装项目中创建一个自定义操作，否则它不会被注册。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T19:43:05.407

正如其他人所说，您必须创建一个安装项目才能进行安装。我还编写了[批处理](https://stackoverflow.com/questions/582896/batch-script-to-install-or-uninstall-a-net-windows-service/582966#582966)文件以在没有设置的情况下执行此操作。

为了帮助创建设置项目，我发现以下链接很有帮助。

[如何在 Visual C# 中为 Windows 服务应用程序创建安装项目](http://support.microsoft.com/kb/816169)

[C# 中的 Windows 服务：第 2 部分：为您的 Windows 服务添加安装程序](http://www.grinn.net/blog/dev/2008/02/windows-services-in-c-part-2-adding.html)

[如何：将安装程序添加到您的服务应用程序](http://msdn.microsoft.com/en-us/library/ddhy0byf.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-09T16:21:13.333

[http://journalofasoftwaredev.wordpress.com/2008/07/16/multiple-instances-of-same-windows-service/](http://journalofasoftwaredev.wordpress.com/2008/07/16/multiple-instances-of-same-windows-service/)

我喜欢这个解决方案

# php - 接口中的构造方法

> ID：783046
> 
> 赞同：20
> 
> 时间：2009-04-23T18:52:02.643
> 
> 标签：php, oop

接口中的构造方法不好吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2010-01-19T03:35:30.087

为什么人们认为任何人都想实例化接口？

我们要做的是强制实现者实现构造函数，就像其他接口方法一样。

接口就像合同。假设我有一个接口 Queue，并且我想确保实现者创建一个带有一个参数的构造函数，该参数创建一个单例队列（一个只有该元素的新队列）。为什么这不应该是合同的一部分？至少对于 Java 接口，不能指定。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-23T18:55:42.587

它们的坏处在于它们没有任何用途。从本质上讲，接口只是一个数据传递合约。没有附加接口的实现，因此不需要初始化，也不需要构造函数。

如果您需要某种初始化，最好使用抽象类。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-01-19T03:47:38.870

首先，我不同意接口只是一个数据传递合同。如果这是真的，您将被允许在接口中定义属性。

我不认为这样做很奇怪：

```
interface IDBConnection
{
    function __construct( $connectionString );
    function executeNonQuery( $commandText, $paramters=null);
    function executeScalar( $commandText, $paramters=null);
    function executeSingle( $commandText, $paramters=null);
    function executeArray( $commandText, $paramters=null);
} 
```

这将使您能够基于简单的反射创建第三方类的实例以进行数据访问，而不仅仅是数据合同。

我很确定这不是最好的例子，我会在现实世界中选择一个抽象基类，但我也很确定在一个我没有想到的界面。

我还没有看到它完成，但我不认为这很奇怪或不好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-23T19:05:58.053

尽管接口在大多数语言中不能有构造函数，但[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)提供了构造对象的契约，类似于接口。看看那个。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T18:53:25.213

无论它们是否不好，我都不知道有任何语言能够在接口上指定构造函数。

话虽如此，但我个人不相信对象的构造函数是该对象接口的一部分，因此向接口添加构造函数会抑制接口提供的自然灵活性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-21T16:13:50.823

我不知道为什么谷歌把我送到这里:)

但是这个问题很有趣，我在很多项目中看到有人在接口中定义了构造函数。但我真的认为这是一个无用的限制。此类的任何客户端都不能调用`__construct`.

并且在接口中定义它不会限制任何行为，我仍然可以按照我的意愿实现它，我什至可以有一个空函数，例如：

```
...
function __construct(string $name) {}
... 
```

那么它有什么好处呢？它只是阻止你做多态性，没有任何好处。

因此，如果您有：

```
<?php
interface Shape {
   function __construct(int $width, int $height);
   public function getArea();
}

class Square implements Shape {
   public function __construct(int $width, int $height) {...}
   public function getArea(){...}
}

// This will throw an exception because it does not implement the correct constructor signature!
class Circle implements Shape {
   public function __construct($radius) {...}
   public function getArea(){...}
} 
```

即使你想扩展 Square，你也必须实现相同的构造函数！。

答案中有一个例子，例如：

> 你必须实例化不可变的多态对象......

示例如下：

```
$immutablePolymorphe = $userConfig['immutable_polymorphe_class'];
$immutablePolymorphe = new $immutablePolymorphe($state);
// Then do something with that polymorphe... 
```

这是聪明的想法，但前提是您可以将`$userConfig`数组中的字符串限制为特定接口！至少据我所知，这是不可能的。

所以底线：DI 认为`__construct`在界面中存在是不好的，并且会阻止您发展软件，它会鼓励您使用糟糕的解决方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-22T14:52:24.840

You have to instantiate immutable polymorphic objects sometime via their constructor that requires parameters and you may need that constructor in the interface for the exact same reasons you may need the other public methods in the interface, for example…</p>

Say you have to instantiate a polymorphic object, its class implementing your interface and being supplied by the client code. As a dumb but simple scenario let's say this object is a value object and as such should be immutable, which mean the object's state should be valid from the moment it's instantiated…</p>

```
$immutablePolymorphe = $userConfig['immutable_polymorphe_class'];
$immutablePolymorphe = new $immutablePolymorphe($state);
// Then do something with that polymorphe... 
```

So what if you don't define the constructor with its parameter in the interface? Hence the reason why I believe a constructor in an interface can be as much legitimate as any other public method in an interface…</p>

# c# - C#：简单的 TCP 服务器问题

> ID：783061
> 
> 赞同：1
> 
> 时间：2009-04-23T18:56:09.997
> 
> 标签：c#, tcp, winsock

我试图在用来监听连接的套接字上发送一个数据包——我当然失败了。

我记得我用帕斯卡编码的日子，还有另一个我应该发送连接的套接字，它是在“接受”之后收到的。

好吧，如果这是正确的，那么这就是我的问题：

我在我的 TCP 服务器（C#）中使用 WSAAsyncSelect()

```
protected override void WndProc(ref Message m)
    {
        switch (m.Msg)
        {

            case Values.MESSAGE_ASYNC:
                switch (m.LParam.ToInt32())
                {
                    case Values.FD_ACCEPT:
                        WS2.Accept();
                        break;

                    case Values.FD_READ:
                        WS2.Receive();
                        break;
                    case Values.FD_CLOSE:
                        WS2.Close();
                        break;
                }
                break;

            default:
                base.WndProc(ref m);
                break;
        }
    } 
```

连接后，我必须向客户端发送一个数据包。

我如何获得必须将数据包发送到该客户端的套接字？

我没有调用 Accept()，因为我不知道在 C# 中应该如何完成，一直在寻找示例，但没有一个使用旧的 WSAAsyncSelect()。

请提供一个例子来说明它应该如何完成。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T18:58:35.623

看看[TcpListener](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx)。将语言限制为 C# 以摆脱非 C# 示例。

# asp.net - 网站的业务层是否应该访问会话状态？

> ID：783064
> 
> 赞同：1
> 
> 时间：2009-04-23T18:57:15.343
> 
> 标签：asp.net, session

我正在维护一个 ASP.NET 网站，我注意到业务层和其他支持库大量使用 HttpContext.Current.Session。这使得很难跟踪会话变量、确定它们的用途以及它们存在的原因。

在业务层使用会话是否被认为是不好的做法？开始将所有使用会话的代码移动到代码隐藏中是否明智？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T19:02:25.677

这几乎从来都不是一个好主意。有很多原因，但这里有几个：

*   您将永远无法在 ASP.NET 以外的任何地方使用业务层代码
*   单元测试变得更加痛苦甚至不可能。

当我们开始构建使用通用业务层代码的服务时，我们遇到了与这种完全相同的情况非常头疼的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T19:02:19.153

我遵循这条规则 - System.Web 命名空间（Java 中的 javax.servlet 包）中的任何类都不应该出现在您的业务层中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T19:01:16.863

是的 - BL 不应该对会话有任何了解。它是您不需要的依赖项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T19:02:17.157

创建一个间接类，在这种情况下，在网络上它可能会从 HttpContext.Current.Session 返回值，而在其他领域会从其他地方解决这个问题。IE 有一个接口 ISessionStore 并有具体的类 WebSessionStore 和 WindowsFormsSessionStore 等。

这将使您的代码更易于测试，并且还为您提供扩展路径，例如，您现在希望 x 业务逻辑在 Windows 服务中运行，它可以每 y 分钟运行 x 段代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T19:03:31.570

在我看来，这是不好的做法。

这使得将业务层与环境分离变得非常困难。例如，如果您希望对事物进行单元测试，那么您就不走运了。

解决这个问题的一种方法是暂时将其隔离为抽象，以便您可以传递“状态缓存”而不是引用 HttpContext。这至少会带你到某种程度的抽象。另一个更有趣的问题是，为什么业务层需要引用它？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-24T06:09:08.803

拥有一个集中的缓存/会话管理器总是更好，它封装了与会话/缓存的完整交互或您使用的任何持久性方法。让你的 BL 与会话进行交互绝对是一种非常糟糕的做法，并且在某种程度上完全违背了分层架构的目的。

# sql - oracle - 对子查询求和？

> ID：783070
> 
> 赞同：0
> 
> 时间：2009-04-23T18:58:48.197
> 
> 标签：sql, oracle

想知道是否有人可以帮助我理解如何总结单列的列，即成本列表为一个总成本。

我一直在研究这个，我认为我在理解我需要对查询求和，将其视为子查询方面处于正确的位置。但是我运气不好 - 我需要给子查询一个别名，还是直接将查询包装在一个总和中？

这是我想总结的工作查询，为了清楚起见，我对总和的所有尝试都省略了！

```
SELECT TICKET_TYPE.PRICE AS TOTALSALES, RESERVATION.RESERVATION_ID,
       CINEMA.LOCATION, PERFORMANCE.PERFORMANCE_DATE
    FROM RESERVATION, TICKET, TICKET_TYPE, CINEMA, PERFORMANCE
    WHERE TICKET_TYPE.TICKET_TYPE_ID = TICKET.TICKET_TYPE_ID
      AND TICKET.RESERVATION_ID = RESERVATION.RESERVATION_ID
      AND RESERVATION.PERFORMANCE_ID = PERFORMANCE.PERFORMANCE_ID
      AND CINEMA.LOCATION = 'sometown'
      AND PERFORMANCE.PERFORMANCE_DATE = to_date('01/03/2009','DD/MM/yyyy'); 
```

一些数据...

```
TOTALSALES RESERVATION_ID LOCATION PERFORMANCE_DATE
    2.8     1     sometown     01-MAR-09
    3.5     2     sometown     01-MAR-09
    2.8     3     sometown     01-MAR-09
    2.8     3     sometown     01-MAR-09
    2.8     3     sometown     01-MAR-09
    2       4     sometown     01-MAR-09
    2.8     5     sometown     01-MAR-09 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T19:04:04.593

您可以将单列与

从 mytable 中选择 sum(mycolumn)

当您将选择列表中的聚合器（例如 sum()、count()）与字段混合时，您会更改查询的含义。您必须包含一个 GROUP BY 子句，并且该子句必须包含选择列表的每个非聚合部分。

您可以在嵌套子查询中单独进行求和，然后将该输出包含在外部选择中...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T19:07:53.760

尝试：

如果您想要每个 ID 的总数，您需要包含一个分组依据。

```
SELECT SUM(TICKET_TYPE.PRICE) AS TOTALSALES
          , RESERVATION.RESERVATION_ID
          , CINEMA.LOCATION
          , PERFORMANCE.PERFORMANCE_DATE
       FROM RESERVATION
          , TICKET
          , TICKET_TYPE
          , CINEMA
          , PERFORMANCE
      WHERE TICKET_TYPE.TICKET_TYPE_ID = TICKET.TICKET_TYPE_ID 
        AND TICKET.RESERVATION_ID = RESERVATION.RESERVATION_ID 
        AND RESERVATION.PERFORMANCE_ID = PERFORMANCE.PERFORMANCE_ID 
        AND CINEMA.LOCATION = 'sometown' 
        AND PERFORMANCE.PERFORMANCE_DATE = to_date('01/03/2009','DD/MM/yyyy');
     GROUP BY RESERVATION.RESERVATION_ID 
```

****和上面的答案几乎一样，我需要在发帖前更好地刷新****

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:09:25.033

您首先需要知道的是查询的“非求和部分”应该是什么。

您想计算 X 与 Y 的总和（例如，按月计算的销售额总和）。Y 可以是任意数量的字段，并且生成的数据集将包含 Y 字段的每个不同组合的一条记录。

一旦您知道我们可以帮助您编写查询。

# c++ - 处理消息太慢，导致 UI 不稳定、无响应 - 如何使用多个线程来缓解这种情况？

> ID：783073
> 
> 赞同：3
> 
> 时间：2009-04-23T19:00:07.850
> 
> 标签：c++, windows, multithreading, winapi, message-queue

我无法让我的应用程序响应用户操作。因此，我想在多个线程之间拆分消息处理。

我可以简单地创建几个线程，从所有线程中的同一个消息队列中读取，并让哪个线程能够处理每条消息吗？

如果是这样，如何实现？

如果没有，您能否提出另一种解决此问题的方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T19:04:37.073

与消息泵或任何 UI 元素交互的线程不能超过一个。那就是疯狂。

如果有很长的处理任务可以外包给工作线程，您可以这样做，但您必须使用另一个线程安全队列来管理它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T19:15:19.247

[如果这是在未来的晚些时候，我会说在尚未发布的 Visual Studio 2010](http://blogs.msdn.com/nativeconcurrency)中使用异步代理 API（我正在处理的插件） 但是我会说鉴于今天的工具是分开工作，特别是在您的消息传递泵中，您希望尽可能少地识别消息并将其传递给另一个线程，该线程将处理该工作（希望不需要线程本地信息）。将它传递给另一个线程意味着将其插入某种锁定或无锁的线程安全队列，然后设置一个其他线程可以观察的事件以从队列中拉取项目（或直接拉取它们）。您可以考虑使用带有线程池的“工作窃取队列”来提高效率。

这将完成从 UI 线程中获取工作，让 UI 线程执行额外的工作（例如绘制该工作的结果），您需要生成一条 Windows 消息来唤醒 UI 线程并检查结果，这是一种简单的方法这样做是让另一个工作对象的“工作就绪”队列在 UI 线程上执行。想象一个看起来像这样的队列：`threadsafe_queue<function<void(void)>` 基本上你可以检查它是否在 UI 线程上是非空的，如果有工作项，那么你可以内联执行它们。您会希望工作对象的寿命尽可能短，并且最好根本不做*任何*阻塞。

如果您仍然看到不稳定的运动响应，另一种可以提供帮助的技术是确保您的线程回调没有执行超过 16 毫秒，并且您没有在 UI 上使用任何锁或执行任何类型的 I/O线。有一系列工具可以帮助识别这些操作，最免费可用的是[“windows 性能工具包”](http://msdn.microsoft.com/en-us/performance/default.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:02:56.470

在处理长操作时创建单独的线程，即保持简单，问题在于您正在运行的某些代码花费了太长时间，这就是应该具有单独线程的代码。

# web-services - ASMX 页面：无法远程查看可用操作

> ID：783074
> 
> 赞同：0
> 
> 时间：2009-04-23T19:00:25.743
> 
> 标签：web-services, iis

我正在尝试使用 Web 服务，并在尝试将 Web 引用添加到详细说明可用操作的 .asmx 页面时，我得到了格式化的页面，但没有列出任何操作。

但是，当我在本地访问同一页面时，我可以看到所有可用的操作。

看来我无法远程使用 Web 服务。

有任何想法吗？我应该去哪里配置它以便 IIS 允许远程使用？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T19:05:38.523

您是在谈论 .NET 向您展示的用于查看服务定义的格式化页面吗？如果您是本地的，那只会向您显示带有方法定义的测试页面。从其他机器它没有显示（出于安全原因）。但是，您仍然可以调用这些方法（并在 WSDL 中查看它们，而不是在格式化的测试页面中列出）。

我错过了你的要求吗？如果这不能回答问题，请解释更多。

# java - 在java中创建硬链接

> ID：783075
> 
> 赞同：13
> 
> 时间：2009-04-23T19:01:04.477
> 
> 标签：java, operating-system

目前我通过 ' `ln`' 命令使用`Runtime.exec()`. 它工作正常。唯一的问题是，为了进行这个分叉，我们需要两倍的应用程序堆空间。我的应用程序是一个 64 位应用程序，堆大小约为 10Gigs，因此它的交换空间不足。我找不到任何可以解决此问题的配置。

我也不想同样使用 JNI。我也听说过这个设施很快就会在 java 7 中提供。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-09T22:08:26.647

在 Java 7 中使用[createLink](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createLink(java.nio.file.Path,%20java.nio.file.Path))很容易：

```
Files.createLink(Paths.get("newlink"), Paths.get("existing")); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T19:11:31.770

您可以尝试用[JNA](https://github.com/twall/jna/)代替 JNI（JNA 比 JNI 有一些明显的优势）；是的，检查[JSR 203](http://jcp.org/en/jsr/detail?id=203)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-11T13:58:26.813

这对于 JNA 来说非常容易：

```
public interface CLibrary extends Library {
    CLibrary INSTANCE = (CLibrary)
        Native.loadLibrary((Platform.isWindows() ? "msvcrt" : "c"),
                           CLibrary.class);
    int link(String fromFile, String toFile);
}

public static void main(String[] args) {
    CLibrary.INSTANCE.link(args[0], args[1]);
} 
```

编译运行！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-23T19:15:20.060

您可以使用 Windows 代替 UNIX 吗？;) 我相信 JDK7 将使用类似于 CreateProcess 的调用，而不是在可用的情况下使用 fork。

更实际的解决方案是在启动后不久创建一个新的子进程。如果您使用的是 10g 堆，那么另一个小型 Java 进程可能不会那么糟糕。获取该过程（通过使用流）执行。

# xsd - 需要（递归）xsd 组的帮助

> ID：783083
> 
> 赞同：0
> 
> 时间：2009-04-23T19:02:34.647
> 
> 标签：xsd

我有这个 xsd：

```
<?xml version="1.0" encoding="utf-8" ?>
<xs:schema xmlns="http://myschema.com/schema"
           targetNamespace="http://myschema.com/schema"
           xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:complexType name="aType" mixed="true">
        <xs:group ref="aElements" minOccurs="0" maxOccurs="unbounded"/>
    </xs:complexType>

    <xs:group name="aElements">
        <xs:choice>
            <xs:element name="a" type="aType"/>
        </xs:choice>
    </xs:group>

    <xs:element name="b">
        <xs:complexType>
            <xs:choice minOccurs="0" maxOccurs="unbounded">
                <xs:group ref="aElements"/>
            </xs:choice>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

我尝试针对它验证这个 xml 文档：

```
<?xml version="1.0" encoding="utf-8" ?>
<b xmlns="http://myschema.com/schema">
    <a/>
</b> 
```

但是，Visual Studio 2008 的 xml 验证器抱怨 <a> 元素：

[命名空间“ http://myschema.com/schema](http://myschema.com/schema) ”中的元素“b”在命名空间“ [http://myschema.com/schema](http://myschema.com/schema) ”中有无效的子元素“a” 。预期的可能元素列表：'a'。

问题是什么？

**编辑**：糟糕，在简化示例时，我忘记在元素内部设置元素可选，导致无限递归。不过，这个mod仍然存在问题。

* * *

**解答**： 答案是 xs:schema 标记应包含 elementFormDefault="qualified" 属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T13:13:11.980

使用编辑器进行 XSD 开发可以让您的生活更轻松。我们已经使用 Liquid [XML Studio](http://www.liquid-technologies.com/XmlStudio/xml_schema_editor.aspx)多年了，它让生活变得更加轻松。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T17:14:16.877

您定义`aElements`with`aType`和`aType`with `aElements`。我不是 xsd 专家，但这应该如何工作？

# sqlite - SQLIite - 如何添加特殊数据？

> ID：783085
> 
> 赞同：1
> 
> 时间：2009-04-23T19:03:29.027
> 
> 标签：sqlite

我有办法将“附加信息”添加到 sqlite 数据库。诸如创建数据库的日期、条目数量或创建它的用户的名称。如果我不想创建特殊表来存储所有这些信息，特别是如果每​​种类型只有一个。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T18:30:57.127

为什么不使用一个特殊表并将每个特殊值存储为名称-值对？

```
CREATE TABLE SpecialInfoKeyValues (
    Key VARCHAR UNIQUE COLLATE NOCASE,
    Value
 ); 
```

由于 SQLite 使用“清单类型”，因此您可以在其中存储任何类型的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T19:16:21.040

简而言之，没有。SQLite 没有用户的概念，也不存储创建元数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:27:51.403

不，没有办法做到这一点，您将不得不使用“特殊”表在文件中携带数据，或者您将不得不使用外部手段。

但是，数据库本身存储了两个版本计数器：schema_version 和 user_version（有关详细信息，请参阅[Pragmas 查询/修改版本值](http://www.sqlite.org/pragma.html#version)。）也许您可以滥用它们。但是请记住，默认情况下，当您使用 .dump 命令将数据库转储为文本表示时，sqlite3 shell 应用程序不会存储这些内容。

# php - 识别mysql问题

> ID：783087
> 
> 赞同：1
> 
> 时间：2009-04-23T19:03:37.123
> 
> 标签：php, mysql

我用 PHP 编写了一个 Web 应用程序，它有 30 个表+视图。有时我的应用程序无法正常工作，并认为这与 mysql 数据库有关。

不幸的是，我无法从该服务器上的浏览器中看到错误，因为 php.ini 是这样说的。此外，当我尝试使用 phpMyAdmin 连接到 mysql db 时，当我尝试选择我的数据库时连接失败。

我如何查看我的 mysql DB 的问题。它有时会起作用，但我不明白为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T19:05:55.853

您可以查看 MySQL 错误日志 - 它`/var/log/mysqld.log`在我的设置中...

您的 PHP 错误可能会发送到另一个日志文件 - 尝试 Apache / IIS 错误日志（全局或特定虚拟主机，取决于您的 Apache 配置 - 我不能说 IIS）或系统日志 -`/var/log/messages`

# visual-studio - 当我不小心单击添加新 Winform 时，Visual Studio 添加了哪些引用？

> ID：783088
> 
> 赞同：0
> 
> 时间：2009-04-23T19:03:46.170
> 
> 标签：visual-studio, winforms, reference

奇怪的是，这不在谷歌上。我真的可以使用一个列表，这样我就知道我需要删除哪些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T19:08:19.857

在引用屏幕上，有一个未使用的引用按钮。这将向您显示未使用的参考，并让您选择删除它们。这在 95% 的时间里都有效。每隔一段时间，如果那里有一个共享库，它会告诉你它没有被使用，但它确实被使用了。

这对于此类问题很有用，而不仅仅是 Windows 窗体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T19:08:02.400

刚刚进行了一个小实验（清除了引用，添加了一个 winform），它添加了：

*   系统
*   系统数据
*   系统绘图
*   System.Windows.Forms
*   系统文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T19:05:47.650

几乎它将确保添加以下内容。

*   System.Windows.Forms
*   系统绘图

它也可能会尝试添加 System.Data 和 System.Xml，但这些是大多数项目类型的默认设置，因此很难判断。

# networking - 有没有办法在我的本地机器上替换 127.0.0.1 以进行测试？

> ID：783090
> 
> 赞同：4
> 
> 时间：2009-04-23T19:03:52.177
> 
> 标签：networking, development-environment, ip-address, test-environments, loopback-address

我知道这听起来可能很愚蠢，但无论如何。也许有什么诀窍？

我只想让本地 Web 服务器接收来自我本地机器的请求，但以某种方式看到不同的 IP 地址？即使是与臭名昭著的 127.0.0.1 不同的单曲也会有很大帮助。

有没有可用的选项？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T19:05:36.057

尝试`127.0.0.2`或`127.0.0.3`...或...

认真的，试试吧！

根据您的操作系统，`localhost`可能可以通过整个`127.0.0.0/8`网络访问，因此甚至`127.42.37.254`可以访问`localhost`（它在我的 Ubuntu 机器上）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T19:09:16.127

或者在您的 HOSTS 文件中为您想要的任何内容添加一个条目，指向 localhost。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T19:07:53.667

您是否通过 127.0.0.1 访问本地 Web 服务器？如果是这样，如果您使用机器的实际 IP 地址怎么办？该请求仍将在您的本地 Web 服务器上结束，但它可能会将其视为发件人而不是 127.0.0.1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T19:08:49.950

您可以使用您的公共[IP 地址](http://whatismyipaddress.com/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T20:33:07.127

您始终可以配置网络服务器以侦听您的网络 IP 地址，然后使用该 IP。

另一方面，如果您希望从多个域（如 a.localhost、b.localhost 和 c.localhost）获取请求，请尝试编辑您的主机文件以将域重定向到 127.0.0.1

# java - 有没有办法让 ANT 任务在 Windows Vista 中以管理员身份运行？

> ID：783094
> 
> 赞同：7
> 
> 时间：2009-04-23T19:04:26.823
> 
> 标签：java, ant, windows-vista

作为安装程序的一部分，我需要从 ANT 运行批处理文件。如果我以管理员身份运行 cmd.exe 并运行批处理文件，一切都很好，因为它具有适当的管理权限。当从 ant 执行批处理文件时，它会失败，就像我在没有管理权限的情况下运行批处理文件时一样。我的问题是，如何从我的 ANT 脚本以管理模式运行此批处理文件？

```
<exec executable="cmd.exe" output="dir.txt" dir="c:/bin/">
<arg line="/c service.bat install"/>
</exec> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T20:17:45.197

至少 XP 有一个`runas`您可以尝试使用的命令，例如：

```
runas /u:%COMPUTERNAME%\Administrator "cmd /c service.bat install" 
```

调用时，它将在控制台上询问密码。

更新：半年后，我已经升级到 Windows 7。这里 runas 不能用于权限提升，但是[Aaron Margosis](http://blogs.msdn.com/aaron_margosis/archive/2007/07/01/scripting-elevation-on-vista.aspx)有一个解决方案：

```
// elevate.js -- runs target command line elevated
if (WScript.Arguments.Length >= 1) {
    Application = WScript.Arguments(0);
    Arguments = "";
    for (Index = 1; Index < WScript.Arguments.Length; Index += 1) {
        if (Index > 1) {
            Arguments += " ";
        }
        Arguments += WScript.Arguments(Index);
    }
    new ActiveXObject("Shell.Application").ShellExecute(Application, Arguments, "", "runas");
} else {
    WScript.Echo("Usage:");
    WScript.Echo("elevate Application Arguments");
} 
```

如果需要，它也许可以嵌入到安装程序中。不过，对于最终用户来说，[Script Elevation Power Toys](http://technet.microsoft.com/lt-lt/magazine/2007.06.utilityspotlight%28en-us%29.aspx)更方便，正如另一个答案所建议的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T18:39:01.740

你可以试试[Script Elevation PowerToy](http://technet.microsoft.com/en-us/magazine/2007.06.utilityspotlight.aspx)。它添加了一个提升命令，可用于提升命令行上的权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-05T13:11:28.087

我偶然发现了一个类似的问题。解决方案是使用[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553)作为可执行文件，并使用它来调用批处理文件。PsExec 是 Windows 的 runas 命令的强大替代品。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T18:14:43.730

关闭 UAC 似乎是允许执行此 ant 任务的唯一选项。

我尝试创建批处理文件的快捷方式并运行它，因为快捷方式可以设置为“以管理员身份运行”。当我收到提示时，那里也没有运气，但我的批处理文件仍然失败。

[ [http://www.mydigitallife.info/2007/02/17/how-to-open-elevated-command-prompt-with-administrator-privileges-in-windows-vista/][1]](http://www.mydigitallife.info/2007/02/17/how-to-open-elevated-command-prompt-with-administrator-privileges-in-windows-vista/][1])

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-06-28T08:48:13.430

通过使用提升命令提示符，我们可以做到这一点。

在 Ant 任务中，我们可以使用 exec 任务来运行任何可执行文件。就像我们也可以使用带有 exec tas 的命令提示符

```
<property name=”admincmd” value=”./elevate.cmd” />
<property name=”server.location” location=”c:/Apache/tomcat/bin” />

<exec executable=”${admincmd}” failonerror=”false”&gt;
<arg value=”cmd” />
<arg value=”/k” />
<arg value=”${server.location}/service” />
<arg value=”install” />
</exec> 
```

在上面的代码片段中，elevate.cmd 源可以从这里下载

要正确运行此代码，我们需要将两个文件 elevate.vbs、elevate.cmd 放在同一目录中，并且应该在属性 admincmd 中定义的适当位置可用。

[这](https://javatechguru.wordpress.com/2014/06/28/elevaterun-as-administrator-command-prompt-in-ant-task/)是原帖的参考链接

# css - CSS 流体“列”

> ID：783097
> 
> 赞同：5
> 
> 时间：2009-04-23T19:04:53.143
> 
> 标签：css, layout

在 CSS 中获取此布局的最佳方法是什么？想象一下，我有三个 div，两个 div 在另一个内部 .. 两个内部 div 中，第一个设置了特定的宽度，第二个 div 预计会占用剩余空间。

一般来说，我最终会在第二列上设置一个特定的宽度，并在包含 div 宽度改变的最后管理更新它。

如果我浮动固定而不是流体，流体柱将包裹在固定 div 下方（不是想要的）。

```
+-------+  +--------------------------------------+
| fixed |  |                                      |
+-------+  |               fluid                  |
           |                                      |        
           |                                      |
           +--------------------------------------+

<div>
  <div>fixed</div>
  <div>fluid</div>
</div> 
```

这必须是一个完全 css 的解决方案，没有 javascript 框架 - 理想情况下适用于最常用的浏览器，并且具有最少的“hackage”（如果有的话）。

希望ASCII艺术作品，

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-23T19:19:03.373

标记

```
<div id="fixed">fixed content</div>
<div id="fluid">fluid content</div> 
```

的CSS

```
#fixed {
  float: left;
  width: 13em;
  margin-right: -14em;
}
#fluid {
  margin-left: 14em;
} 
```

这应该够了吧。我在我的个人网站上使用它。边距使其保持在同一水平。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T21:46:11.840

您可以使用支持流体列的[Emastic CSS 框架](http://code.google.com/p/emastic/)。这里的[链接](http://www.allapis.com/Emastic-CSS-Temaplates/template9.html)是类似于你的“ASCII艺术作品”的工作示例:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:18:08.973

希望这至少可以帮助您入门：

```
* {
   margin:0;
}

div#wrapper {
   margin:0;
   height:auto !important; //IE Hack
   height:100%; //IE Hack
   min-height:100%;
   overflow:auto
}

div#fixed{
   float:left;
   position:absolute;
   background-color:red;
   margin:0;
   height:200px;
   width:200px
}

div#fluid{
   float:right;
   position:absolute;
   left:200px;
   background-color:blue;
   display:block;
   height:80%;
   width:60%
} 
```

“包装器”将是您的包装 div。我只将流体列设置为 60% 的宽度，因此您可以看到它应该流畅地运行。我在 Opera 10、IE 6 和 Firefox 3 中对此进行了测试，只有小问题。如果您将流体列的宽度设置为 100%，IE 想要在右侧附加一个额外的 200px。我敢肯定在某个地方可以解决这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-11T23:05:19.120

实际上，我不久前发现了一个更简单的解决方案。可以很好地回到 IE7。#fluid div 将在固定修复旁边向上滑动并占用剩余空间，同时为所有响应式站点保持良好的流动性。

```
#fixed{
     width:200px;
     float:left;
}
#fluid{
    overflow:hidden;
} 
```

# wpf - 刷新 WPF 命令

> ID：783104
> 
> 赞同：74
> 
> 时间：2009-04-23T19:06:02.390
> 
> 标签：wpf, mvvm, updating

有谁知道我如何强制`CanExecute`调用自定义命令（Josh Smith's [`RelayCommand`](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)）？

通常，`CanExecute`在 UI 上发生交互时调用。如果我单击某些东西，我的命令就会更新。

我有一种情况，条件`CanExecute`是由幕后的计时器打开/关闭。因为这不是由用户交互驱动的，`CanExecute`所以在用户与 UI 交互之前不会调用。最终结果是我的`Button`保持启用/禁用状态，直到用户点击它。单击后，它已正确更新。有时`Button`显示已启用，但当用户单击时，它会变为禁用而不是触发。

当计时器更改影响的属性时，如何强制更新代码`CanExecute`？我尝试在影响的属性上触发`PropertyChanged`( ) ，但这没有帮助。`INotifyPropertyChanged``CanExecute`

示例 XAML：

```
<Button Content="Button" Command="{Binding Cmd}"/> 
```

后面的示例代码：

```
private ICommand m_cmd;
public ICommand Cmd
{
    if (m_cmd == null)
        m_cmd = new RelayCommand(
            (param) => Process(),
            (param) => EnableButton);

    return m_cmd;
}

// Gets updated from a timer (not direct user interaction)
public bool EnableButton { get; set; } 
```

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-04-23T19:08:44.070

调用[`System.Windows.Input.CommandManager.InvalidateRequerySuggested()`](http://msdn.microsoft.com/en-us/library/system.windows.input.commandmanager.invalidaterequerysuggested.aspx)会强制 CommandManager 引发 RequerySuggested 事件。

> **备注：** CommandManager 在确定命令目标何时发生变化时只关注某些条件，例如键盘焦点的变化。在 CommandManager 无法充分确定导致命令无法执行的条件变化的情况下，可以调用 InvalidateRequerySuggested 以强制 CommandManager 引发 RequerySuggested 事件。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2010-02-23T15:30:01.500

我很久以前就知道 CommandManager.InvalidateRequerySuggested() 并使用它，但有时它对我不起作用。我终于明白为什么会这样了！即使它不像其他一些动作那样抛出，你必须在主线程上调用它。

在后台线程上调用它似乎可以工作，但有时会禁用 UI。我真的希望这对某人有所帮助，并为他们节省我刚刚浪费的时间。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-05-04T08:10:46.070

一种解决方法是绑定`IsEnabled`到属性：

```
<Button Content="Button" Command="{Binding Cmd}" IsEnabled="{Binding Path=IsCommandEnabled}"/> 
```

然后在您的 ViewModel 中实现此属性。这也使得 UnitTesting 更容易使用属性而不是命令来查看命令是否可以在某个时间点执行。

个人觉得比较方便。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-05T08:58:56.197

可能此变体将适合您：

```
 public interface IRelayCommand : ICommand
{
    void UpdateCanExecuteState();
} 
```

执行：

```
 public class RelayCommand : IRelayCommand
{
    public event EventHandler CanExecuteChanged;

    readonly Predicate<Object> _canExecute = null;
    readonly Action<Object> _executeAction = null;

   public RelayCommand( Action<object> executeAction,Predicate<Object> canExecute = null)
    {
        _canExecute = canExecute;
        _executeAction = executeAction;
    }

    public bool CanExecute(object parameter)
    {
       if (_canExecute != null)
            return _canExecute(parameter);
        return true;
    }

    public void UpdateCanExecuteState()
    {
        if (CanExecuteChanged != null)
            CanExecuteChanged(this, new EventArgs());
    }

    public void Execute(object parameter)
    {
        if (_executeAction != null)
            _executeAction(parameter);
        UpdateCanExecuteState();
    }
} 
```

使用简单：

```
public IRelayCommand EditCommand { get; protected set; }
...
EditCommand = new RelayCommand(EditCommandExecuted, CanEditCommandExecuted);

 protected override bool CanEditCommandExecuted(object obj)
    {
        return SelectedItem != null ;
    }

    protected override void EditCommandExecuted(object obj)
    {
        // Do something
    }

   ...

    public TEntity SelectedItem
    {
        get { return _selectedItem; }
        set
        {
            _selectedItem = value;

            //Refresh can execute
            EditCommand.UpdateCanExecuteState();

            RaisePropertyChanged(() => SelectedItem);
        }
    } 
```

XAML：

```
<Button Content="Edit" Command="{Binding EditCommand}"/> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-03-03T19:45:57.393

谢谢大家的提示。下面是一些关于如何将 BG 线程的调用编组到 UI 线程的代码：

```
private SynchronizationContext syncCtx; // member variable 
```

在构造函数中：

```
syncCtx = SynchronizationContext.Current; 
```

在后台线程上，触发重新查询：

```
syncCtx.Post( delegate { CommandManager.InvalidateRequerySuggested(); }, null ); 
```

希望有帮助。

——迈克尔

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-27T17:38:54.887

要仅更新单个 GalaSoft.MvvmLight.CommandWpf.RelayCommand 您可以使用

```
mycommand.RaiseCanExecuteChanged(); 
```

对我来说，我创建了一个扩展方法：

```
public static class ExtensionMethods
    {
        public static void RaiseCanExecuteChangedDispatched(this RelayCommand cmd)
        {
            System.Windows.Application.Current.Dispatcher.Invoke(DispatcherPriority.Normal, new Action(() => { cmd.RaiseCanExecuteChanged(); }));
        }

        public static void RaiseCanExecuteChangedDispatched<T>(this RelayCommand<T> cmd)
        {
            System.Windows.Application.Current.Dispatcher.Invoke(DispatcherPriority.Normal, new Action(() => { cmd.RaiseCanExecuteChanged(); }));
        }
    } 
```

# c# - 如何使用 Linq 选择未显示在第二个列表中的项目

> ID：783106
> 
> 赞同：0
> 
> 时间：2009-04-23T19:06:39.440
> 
> 标签：c#, linq, list

我有两个列表，我想从第一个列表中选择不在第二个列表中的项目。我没有 Linq 经验，我认为这应该是开始学习的好方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T19:10:11.693

您可以使用除此之外：

```
var query = list1.Except(list2); 
```

# c# - C#：返回给定对象和方法名称的委托

> ID：783108
> 
> 赞同：9
> 
> 时间：2009-04-23T19:07:22.637
> 
> 标签：c#, reflection

假设我有一个对象和一个包含方法名称的字符串，我怎样才能将委托返回给该方法（该方法的？）？

例子：

```
MyDelegate GetByName(ISomeObject obj, string methodName)
{
    ...
    return new MyDelegate(...);
}

ISomeObject someObject = ...;
MyDelegate myDelegate = GetByName(someObject, "ToString");

//myDelegate would be someObject.ToString 
```

提前致谢。

还有一件事——我真的不想使用 switch 语句，即使它可以工作但需要大量代码。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-23T19:10:03.240

您需要使用[`Type.GetMethod`](http://msdn.microsoft.com/en-us/library/system.type.getmethod.aspx)来获取正确的方法，并将[`Delegate.CreateDelegate`](http://msdn.microsoft.com/en-us/library/system.delegate.createdelegate.aspx)其转换`MethodInfo`为委托。完整示例：

```
using System;
using System.Reflection;

delegate string MyDelegate();

public class Dummy
{
    public override string ToString()
    {
        return "Hi there";
    }
}

public class Test
{
    static MyDelegate GetByName(object target, string methodName)
    {
        MethodInfo method = target.GetType()
            .GetMethod(methodName, 
                       BindingFlags.Public 
                       | BindingFlags.Instance 
                       | BindingFlags.FlattenHierarchy);

        // Insert appropriate check for method == null here

        return (MyDelegate) Delegate.CreateDelegate
            (typeof(MyDelegate), target, method);
    }

    static void Main()
    {
        Dummy dummy = new Dummy();
        MyDelegate del = GetByName(dummy, "ToString");

        Console.WriteLine(del());
    }
} 
```

[不过，Mehrdad 的评论很棒——如果Delegate.CreateDelegate](http://msdn.microsoft.com/en-us/library/12f294ye.aspx)的这种重载引发的异常没问题，您可以大大简化`GetByName`：

```
 static MyDelegate GetByName(object target, string methodName)
    {
        return (MyDelegate) Delegate.CreateDelegate
            (typeof(MyDelegate), target, methodName);
    } 
```

我自己从来没有使用过这个，因为我通常会在找到明确的内容后进行其他检查`MethodInfo`- 但在合适的地方，这真的很方便:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T19:12:52.217

```
static MyDelegate GetByName(object obj, string methodName)
{
    return () => obj.GetType().InvokeMember(methodName, 
        System.Reflection.BindingFlags.InvokeMethod, null, obj, null); 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T19:23:09.290

更容易使用：

```
 public static MyDelegate GetByName(object target, string methodName)
    {
        return (MyDelegate)Delegate.CreateDelegate(typeof(MyDelegate), 
               target, methodName);
    } 
```

请注意， CreateDelegate 有一个重载，它为您获取 methodName。这是使用 .net 3.5 Sp1 完成的

# jquery - jQuery 选择器：选择作为具有特定 id 的 div 的后代的锚标记

> ID：783109
> 
> 赞同：3
> 
> 时间：2009-04-23T19:07:31.327
> 
> 标签：jquery, css-selectors

尝试选择作为具有特定 id 的 div 的后代的锚标记，例如它是`#mydiv1`和。`#mydiv2``#mydiv3`

```
myFunction = function() {    
  var theDivs = $("#mydiv1, #mydiv2, #mydiv3");    
  theDivs.hover(function(e){    
      $(this+" a:link").css("color","#99ccff");
  },function(e){
      $(this+" a:link").css("color","#848484");        
  });    
} 
```

选择器`$(this+" a:link")`似乎没有选择任何东西。

有没有人对此选择的正确语法有任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-23T19:09:48.107

尝试`$(this).find("a:link")`

编辑：额外信息

当你`$(this + "query")`混合类型时。jQuery 的选择器参数正在寻找查询字符串或对象。当 'this' 被转换为字符串时，它将不是有效的选择器语法。例如，您*可以*执行以下操作： `$("." + this.className + "[query]")`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-23T19:16:23.597

您可以为上下文提供一个元素，以下应该有效：

```
$("a:link", this). 
```

它将搜索从`this`节点开始的锚点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T19:21:58.700

或者试试`$(this).children("a:link")`

[http://api.jquery.com/children/](http://api.jquery.com/children/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T19:24:16.980

上述任何一种方法都应该有效，但我在 jQuery 选择器语法中没有看到任何关于“:link”是有效语法的内容。如果上述方法对您不起作用，也许也可以尝试将其关闭。

您的原始方法不起作用的原因是“this”是一个 DOM 元素，而不是代码中的字符串。如前所述，您可以通过执行 "$(this)" 使其成为 jQuery 对象，或者仅使用 DOM 元素作为搜索上下文。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T19:30:32.143

使用 .each() 遍历 div，并使用子选择器：

```
 myFunction = function() {    
      var theDivs = $("#mydiv1, #mydiv2, #mydiv3");    
  theDivs.each(function(){    
      $(this > 'a').css("color","#99ccff");
  });    
} 
```

像这样。

# c# - 如何确定 C# 中最后一次更改文件名的时间？

> ID：783119
> 
> 赞同：1
> 
> 时间：2009-04-23T19:08:25.583
> 
> 标签：c#, filenames

我有一个小型实用程序，可以对文件进行一些处理，并在完成后将文件扩展名更改为 .processed。我还想在“x”天后删除这些旧的 .processed 文件。是否有一个文件属性可以告诉您上次更改文件名的时间？我意识到我可以在处理后在文件末尾添加空格，重新保存，然后获取“LastWriteTime”属性，但我根本不想接触原始文件。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T19:15:00.777

System.IO.FileInfo 命名空间中的 LastWriteTime。

```
FileInfo fi1 = new FileInfo(path); 
```

哦，是的，你也可以写这个值。更新文件名时更新它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T16:54:15.333

如果更新 LastWriteTime 解决方案不能满足您的需求，另一个想法是：

将文件名（或重命名的文件名）和文件处理日期存储在数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:14:40.437

我不明白... LastWritetime 应该是最后一次写入文件的时间。因此，如果您的处理修改了 x.processed 文件，您可以查看它。您也可以在最后一次读取时使用[GetLastAccessTime 。](http://msdn.microsoft.com/en-us/library/system.io.file.getlastaccesstime.aspx)

**编辑**：啊，重命名不会修改 LastWriteTime。那么[你自己设置 LastWriteTime](http://msdn.microsoft.com/en-us/library/system.io.file.setlastwritetime.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T19:17:34.670

我不认为重命名文件会更新 LastWriteTime。

因此，当您的进程重命名文件时，请同时更新 FileInfo 对象中的 LastWriteTime，然后您可以使用 LastWriteTime 进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T19:17:45.000

即使 Windows 在您重命名文件时确实更新了 LastWriteTime，它也不够好：

当您第一次更改文件名时，您可以检查新文件名上的 LastWriteTime 日期，但是一旦您以任何方式编辑文件，之后信息就会丢失。

幸运的是，在这种情况下，您将通过其他方式更改文件，所以没关系。你可以检查一下，就知道你没事。

# wcf - 如何使用 IronPython 连接到 WCF 服务

> ID：783120
> 
> 赞同：2
> 
> 时间：2009-04-23T19:08:27.440
> 
> 标签：wcf, ironpython

有人做过吗？我已经尝试生成 ac# 代理类并通过它进行连接，但我无法弄清楚如何让 IronPython 使用生成的定义端点的 app.config 文件。它尝试连接，但我只是收到关于没有默认端点的错误。如果可能的话，我最好只使用 IronPython 代码而不使用代理类来建立连接。我尝试连接的服务的绑定是 NetTcpBinding，如果这有什么不同的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-30T18:41:42.360

请参阅我的[博文](http://gui-at.blogspot.com/2009/10/wcf-service-in-ironpython.html)。有 IronPython WCF 服务和客户端示例。

要使用 app.config，您可能必须将其复制`ipy.exe`并重命名为，`ipy.exe.config`但我没有尝试过，所以我不知道它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T21:35:21.830

您的 WCF 服务接口在共享程序集中可用吗？如果是这样，您可以考虑使用 ChannelFactory 动态创建客户端代理（而不是使用生成的 C# 代理）。使用该方法，您可以在创建 ChannelFactory 时提供端点的所有详细信息，并且不需要在 .config 文件中进行任何配置。

# php - 检查有效的 MySQL 结果资源

> ID：783125
> 
> 赞同：6
> 
> 时间：2009-04-23T19:09:12.540
> 
> 标签：php, mysql, resultset

我有这个代码：

```
$rows = array();
$res = mysql_query($someQuery);

if(!mysql_errno())
    while($row = mysql_fetch_assoc($res))
        $rows[] = $row; 
```

`$someQuery`是我写入表单的任意查询。mysql_errno 在我编写包含错误的 mysql 查询时捕获了这种情况。但是，我刚刚发现，当我执行“从 table_name 删除”查询时，这当然不是错误，但同时 mysql_fetch_assoc 失败并显示“警告：mysql_num_rows()：提供的参数不是有效的 MySQL 结果第 x 行 /blah/blah/file.php 中的资源”。

我试图在手册中寻找它（也许我只是瞎了......）但是有没有我可以用来检查 $res 是否是有效的 MySQL 结果资源的函数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T19:14:42.917

`if ($res)`应该可以正常检查它是否是资源。 [is_resource()](http://php.net/is_resource)将确定它是否是有效的资源。

您还可以检查[mysql_affected_rows](http://php.net/mysql_affected_rows)以尝试确定它是否是 INSERT/UPDATE/etc

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-07-09T15:17:53.147

您[`is_resource()`](http://php.net/is_resource)可以使用[`get_resource_type()`](http://php.net/get_resource_type)它来检查它是否是 MySQL 资源。

```
$res_type = is_resource($res) ? get_resource_type($res) : gettype($res);

if(strpos($res_type, 'mysql') === false) {
    echo 'Invalid resource type: ' . $res_type;
} 
```

`get_resource_type()`可能会返回`"mysql link"`或`"mysql link persistent"`取决于您的连接类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T19:15:30.200

[`mysql_query()`](http://php.net/mysql_query)返回`true`左右`false`，您可以这样检查：

```
if($res) {
    // The query succeeded.
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-15T10:11:45.873

检查[http://www.lampdocs.com/blog/2010/10/how-to-check-that-a-php-variable-is-a-mysql-resource/](http://www.lampdocs.com/blog/2010/10/how-to-check-that-a-php-variable-is-a-mysql-resource/)以获得解决方案。希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T19:14:40.153

如果您通过 INSERT、UPDATE、DELETE 或 DROP`mysql_query`那么它只会返回`true`或`false`（取决于操作的成功）。

我不确定您期望资源在这种情况下包含什么？

如果您需要受影响的行数，可以使用[`mysql_affected_rows()`](http://php.net/mysql_affected_rows).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T19:21:33.850

也许只需将条件更改为：

```
if(!mysql_errno() && @mysql_num_rows($res) > 0) 
```

如果没有行，条件将失败，@ 将抑制警告。

# c# - 如何在 WPF 中指定应用程序的 App.config 文件的名称？

> ID：783131
> 
> 赞同：1
> 
> 时间：2009-04-23T19:10:07.717
> 
> 标签：c#, wpf, wcf, app-config

这非常令人沮丧......我可以很好地设置 Windows 窗体应用程序的配置文件。考虑一下：

```
public static void Main(){
    AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", @"SharedAppConfig.config");
    //do other things
} 
```

但是，在 WPF 应用程序中，这似乎不起作用！如果我设置此值，则 AppDomain.CurrentDomain.SetupInformation.ConfigurationFile 属性的值是正确的，但在调试时对该配置文件的任何调用都不会产生任何结果。我需要在应用程序之间共享的 App.config 中有 WCF 配置设置，所以这是我建议的解决方案。是否可以在 WPF 中动态设置我的配置文件的位置？

帮助！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-22T22:08:05.880

您应该能够按照以下方式做一些事情：

```
using System.Configuration;

public class TryThis
{
    Configuration config = ConfigurationManager.OpenExeConfiguration("C:\PathTo\app.exe");

    public static void Main()
    {
        // Get something from the config to test.
        string test = config.AppSettings.Settings["TestSetting"].Value;

        // Set a value in the config file.
        config.AppSettings.Settings["TestSetting"].Value = test;

        // Save the changes to disk.
        config.Save(ConfigurationSaveMode.Modified);
    }
} 
```

注意：这将尝试在 C:\PathTo 打开一个名为 app.exe.config 的文件。这也要求在同一路径中存在一个名为“app.exe”的文件。“app.exe”文件可以只是一个空文件。对于您的情况，我几乎会创建一个共享的“Config.dll”库来处理配置文件。

~md5sum~

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T18:35:52.063

这是在服务端还是客户端？如果在服务端，通常情况是服务在自己的 AppDomain 中运行，因此如果您设置 AppDomain.CurrentDomain.SetData(...) 它将不适用于服务配置。

我不完全确定如何解决这个问题，但您应该能够通过实现自己的 ServiceHost 来控制服务的配置。

# unix - AF_UNIX 域 - 为什么只使用本地文件名？

> ID：783134
> 
> 赞同：7
> 
> 时间：2009-04-23T19:10:52.300
> 
> 标签：unix, sockets

> 在 UNIX 域中使用套接字时，建议使用挂载在本地磁盘上的目录的路径名。UNIX 域只允许在同一台机器上工作的进程进行进程间通信。

你能解释一下上面的行吗？它是关于 UNIX 域中的一个套接字。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-23T19:14:23.150

Unix 域套接字或 IPC 套接字（进程间通信套接字）是类似于 Internet 套接字的数据通信端点，但不使用网络协议进行通信。它在 POSIX 操作系统中用于进程间通信。正确的标准 POSIX 术语是 POSIX 本地 IPC 套接字。

Unix 域连接显示为字节流，很像网络连接，但所有数据都保留在本地计算机中。UNIX 域套接字使用文件系统作为地址名称空间，即它们被进程引用为文件系统中的 inode。这允许两个不同的进程打开同一个套接字以进行通信。但是，实际的通信（数据交换）并不使用文件系统，而是使用内核内存中的缓冲区。

除了发送数据之外，进程还可以使用 sendmsg() 和 recvmsg() 系统调用通过 Unix 域套接字连接发送文件描述符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T19:28:37.577

UNIX 域套接字的端点由文件系统中的文件表示（而不是由主机/端口）。

然而，进程之间的通信是在本地系统内完成的，不会导致可搜索的文件存储在任何地方。

使用文件系统作为端点的命名空间的优点是可以应用正常的文件权限和 ACL - 如果您无法打开端点，则无法连接。IP 套接字没有这种机制。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T19:44:35.637

这意味着如果您在 NFS 磁盘上创建一个在两台机器 A 和 B 之间共享的 AF_UNIX 套接字，则不能让 A 上的进程将数据写入 unix 套接字，而 B 上的进程则无法从该套接字读取数据。

通信发生在内核级别，您只能在位于同一内核的进程之间传输数据。

# java - 如何检查给我的对象是否是 Java 中的 int []？

> ID：783144
> 
> 赞同：4
> 
> 时间：2009-04-23T19:14:02.060
> 
> 标签：java

如何检查给我的对象是否是`int[]`Java 中的？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-23T19:18:31.003

您期望的方式：

```
if (theObject instanceof int[]) {
    // use it!
} 
```

数组是`Objects`，即使它们是基元数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T19:33:45.820

```
if (o instanceof int[])
{
...
} 
```

数组是java中的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:23:58.430

获取变量的运行时类，如果它是一维数组，类名类似于 [int 如果它是二维数组，类名是 [[int，如果它是 3 维类名是 [[[int

```
if ( j.class.Name.equals("[int")) {
   ......
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T19:39:42.963

intanceof 是最简单的，但可以按照您的要求进行操作。

```
if (o.getClass() == int[].class) 
```

# c# - 在 .NET Framework 2.0 中使用扩展方法

> ID：783155
> 
> 赞同：6
> 
> 时间：2009-04-23T19:15:50.777
> 
> 标签：c#, visual-studio-2008, .net-2.0, extension-methods

在 Visual Studio 2008 下
我可以创建扩展方法以在 .NET Framework 2.0 项目下工作吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-23T19:18:32.767

有一个[丑陋的 hack](http://www.danielmoth.com/Blog/Using-Extension-Methods-In-Fx-20-Projects.aspx)可以让扩展方法在 .Net 2.0 中工作；但最好将您的框架升级到 3.5。

替代[来源](http://kohari.org/2008/04/04/extension-methods-in-net-20/)：[1、2](http://www.codethinked.com/Using-Extension-Methods-in-net-20)。

简而言之（来自链接＃2）：扩展方法只是标有 [Extension] 属性的普通静态方法。这个属性其实只是编译器在幕后添加的。在 .NET 3.5 中，它位于 System.Core 中，因此只需定义您自己的属性，如下所示：

```
namespace System.Runtime.CompilerServices
{
  [AttributeUsage(AttributeTargets.Method, AllowMultiple = false, Inherited = false)]
  public class ExtensionAttribute : Attribute
  {
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T19:19:24.183

绝对地。有一些 hacky 方法，但我使用的方法是从[Mono 项目](http://www.mono-project.com/)中获取 System.Core ，将其所有代码添加到我自己的解决方案中名为 System.Core 的新 .NET 2.0 类库中，然后重新编译它. 有一些事情需要修复，比如将它们的 MonoTODO 属性更改为 TODO 注释，以及修复 AssemblyInfo.cs，但效果很好。我现在在 VS 2008 中编译的 2.0 项目中同时使用 LINQ 和扩展方法。

假设您获得了 2.4 版本的 Mono 源代码，您应该可以在以下位置找到代码：

```
<extracted directory>/mono-2.4/mcs/class/System.Core 
```

如果您卡在 VS 2005 中，您可以下载[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/Download/)，使用针对 2.0 的 System.Core dll 构建您的 System.Core dll，添加对已编译程序集的引用，它可能会工作，但我不知道 VS 2005 是否会有扩展语法是否存在问题。我想它会给你一些嘴唇。

# sql-server - 使用 SQLServer 的 ASP.NET MVC 教程？

> ID：783184
> 
> 赞同：3
> 
> 时间：2009-04-23T19:24:31.143
> 
> 标签：sql-server, asp.net-mvc

如何使用 SQLServer（而不是 SQL Express）作为我的数据库？

我正在尝试通过[ContactManager](http://www.asp.net/learn/mvc/tutorial-26-cs.aspx)教程，但我似乎无法让它使用 SQLServer - 当我从“添加新项目”对话框中选择 SQLServer 时，我收到一条错误消息，告诉我没有安装 SQL Express .

我知道我一定错过了一些基本的东西......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T19:30:47.277

ASP.NET 站点上的大多数教程都是这样编写的，您不必购买任何软件来完成它们。他们在示例中使用 Visual Studio Express 和 SQL Express。

但是，您仍然可以按照教程进行操作。只需进行一些调整。转到服务器资源管理器以创建到 SQL Server 的连接，并创建数据库和表。

然后在创建 EntityDataModel 的步骤中，创建一个与您刚刚创建的数据库的新连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T19:27:26.987

只有 SQL Express 可以在运行时附加您的数据库。如果您有非 Express 版本的 SQL Server，则需要使用 SSMS 创建 SQL Server。如果您希望文件实际存在于 app_data 中，那么当被问及将数据库文件放在哪里时，ldf 指示 app_data 文件夹。创建它后，只需将其添加为现有项目就很容易了，尽管在不产生明显问题的情况下无法将其签入源安全。我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:31:34.403

如果您使用的是完整的 SQL Server 实例，则根本不需要使用“添加新项目”对话框。相反，连接到您的 SQL Server 实例（通过 Visual Studio 或 SQL Server Management Studio），并在那里创建新数据库。

# svn - 颠覆错误“无法读取状态行”是什么意思？

> ID：783186
> 
> 赞同：3
> 
> 时间：2009-04-23T19:26:27.897
> 
> 标签：svn

这是一个相当基本的问题，但它让我发疯。我在 beanstalk.com 上建立了一个全新的存储库。他们给了我网址[http://my_name.svn.beanstalkapp.com/blog](http://my_name.svn.beanstalkapp.com/blog)。他们还自动在存储库中创建标签、主干和分支文件夹。我已经检查了主干文件夹并使用了

```
svn 添加
```

添加新文件。我正在尝试进行第一次提交，但出现此错误：

```
提交失败（详情如下）：
'/foo/!svn/bln/1' 的检查：无法读取状态行：
连接被服务器关闭。(http://user_name@my_name.svn.beanstalkapp.com)
```

这是什么意思，是什么原因造成的？我搜索了“无法读取状态行”的定义，但找不到任何解释它的东西。

编辑：我在尝试从防火墙后面操作我的存储库时遇到此错误。我仍然不知道是什么原因造成的，但我在家里没有这个问题。奇怪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-05-20T10:09:57.687

当我输入错误的 URL 时，我也遇到了同样的问题：

不良行为：

`$ svn list https://zh3.beanstalkapp.com/repo`

要解决此问题，URL 应为： `https://zh3.svn.beanstalkapp.com/repo`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-16T19:19:58.000

我有同样的问题..直到我记得我需要在前面的 https

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-24T20:28:45.920

我在某处读到是因为 http 方法。请改成 https 解决这个 问题**https://my_name.svn.beanstalkapp.com/blog**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-12T23:58:10.953

我有同样的错误。在我们的案例中，服务器存储库中的 Mcafee 防病毒软件在通过颠覆提交时窃取了文件。导致svn错误。

禁用病毒软件解决了我们的问题。

# c# - 是否可以从 Visual Studio 复制代码并将格式化的代码粘贴到 OneNote？

> ID：783187
> 
> 赞同：52
> 
> 时间：2009-04-23T19:26:33.417
> 
> 标签：c#, .net, visual-studio, onenote, richtext

有没有办法从 Visual Studio (C#) 复制代码并将其粘贴到 OneNote 中，而不会丢失格式？

我能够做到这一点，但前提是我从 VS 复制，粘贴到 Word，从 Word 复制，然后粘贴到 OneNote。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2010-07-15T12:11:44.683

幸运的是，Visual Studio 2010 有一个解决方案！安装 Visual Studio 2010 Pro Power Tools 扩展并复制/粘贴到 OneNote 会保留语法突出显示。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2020-08-14T23:03:51.460

这是一个默认情况下似乎被禁用的选项。

## 要启用（在 VS 2019 中）：

1.  去`Tools -> Options`

2.  在搜索框中输入**副本**

3.  根据`Text Editor -> Advanced`...

4.  检查**复制/剪切时复制富文本**

[![Visual Studio 选项示例](https://i.stack.imgur.com/efTPJ.png)](https://i.stack.imgur.com/efTPJ.png)

## 格式化的顶部副本

启用该功能后，根据目标，这可能是一个两步过程。如果在复制和粘贴代码之后，它仍然显示为未格式化（例如，如果粘贴到 Web 浏览器中），请使用[marcus](https://stackoverflow.com/a/33935005/3063884)建议的方法，首先粘贴到 wordpad.exe ( `start -> run ->` type `wordpad`)，然后再次从 Wordpad 中复制文本，并粘贴到目标应用程序/浏览器中。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-23T19:35:47.997

你在这个过程中一针见血。您要粘贴到的应用程序必须能够正确接受具有格式的代码。MS Word 是少数能正确处理此问题的软件之一，因此，从 VS -> Word -> OneNote 开始即可。但是 VS -> OneNote 不起作用。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-12-08T22:06:59.983

对于 Visual Studio 2008 ---- [http://blogs.msdn.com/b/johnguin/archive/2010/11/29/an-addin-to-help-visual-studio-users-with-moving-code- to-onenote.aspx](http://blogs.msdn.com/b/johnguin/archive/2010/11/29/an-addin-to-help-visual-studio-users-with-moving-code-to-onenote.aspx)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-09-10T13:36:55.210

Microsoft Visual Studio 有一个加载项，允许您将源代码、语法突出显示和行号复制为 HTML。

使用此插件，您可以从 VS 复制并将 HTML 直接粘贴到您的目标。

在这里查看： [CopySourceAsHtml](http://copysourceashtml.codeplex.com/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-08-29T16:47:18.637

[NoteHighlight](https://github.com/elvirbrk/NoteHighlight2016)可以解决问题。我通过以下博客文章[codefoster](http://codefoster.com/post/2012/03/30/Insert-Formatted-Code-into-OneNote.aspx)找到了它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-01-04T02:28:46.950

直接从 Microsoft 尝试这个优雅的解决方案：Productivity Power Tools 2015

[https://marketplace.visualstudio.com/items?itemName=VisualStudioProductTeam.ProductivityPowerTools2015](https://marketplace.visualstudio.com/items?itemName=VisualStudioProductTeam.ProductivityPowerTools2015)

HTML 复制粘贴与 OneNote 配合得很好。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-03-23T08:51:19.907

好吧，抱歉回复晚了，我知道这是很老的帖子了。但是，它可能对试图为上述问题找到解决方案的人有所帮助。即使是 OneNote 2016，我也没有找到适合我的方法，但在这里它是非常简单的方法。

只需复制您的代码并将其粘贴到**wordpad.exe 中**，它会粘贴格式和颜色。保存***.rtf**文件并在 Ms Word 中打开它，从那里您可以复制/粘贴 word 中的任何文档，它对我有用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-09-01T11:43:00.300

GEM OneNote 插件具有语法高亮功能 -> [http://www.onenotegem.com/blog/onenote-insert-highlight-syntax-source-code](http://www.onenotegem.com/blog/onenote-insert-highlight-syntax-source-code)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-10-02T07:03:54.083

[Notehighlight](http://notehighlight2013.codeplex.com/)支持以下语法高亮显示：C#、SQL、CSS、JS、HTML、XML、JAVA、PHP、Perl、Python、Ruby、C++

他们已经发布了一个与 OneNote 2013 兼容的端口（也恰好适用于 OneNote2016）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-11-26T09:35:37.020

完全保持代码格式的最佳方法由两个步骤组成：

1.  在第一步中，右键单击代码并单击“复制”，然后将其粘贴到“写字板”中
2.  第二步从“写字板”复制到word。

[![复制代码](https://i.stack.imgur.com/sK51F.png)](https://i.stack.imgur.com/sK51F.png) [![粘贴代码](https://i.stack.imgur.com/SpIfH.png)](https://i.stack.imgur.com/SpIfH.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-08-02T02:28:49.157

我只是想出了一个解决方法来做到这一点，而不需要任何插件。

1.  向 OneNote 中插入只有一个单元格的表格
2.  把这张表的底纹颜色改成vscode背景色，可以用颜色选择器来选择vscode的bg颜色
3.  选择要复制的代码块并将缩进转换为制表符（否则粘贴时缩进会丢失）参考：[https ://github.com/Microsoft/vscode/issues/35954](https://github.com/Microsoft/vscode/issues/35954)
4.  复制选定的代码并将其粘贴到单元格中
5.  将源代码的代码缩进改回空格。

PS：我在 macOS 上试过，效果很好

[![截图图像](https://i.stack.imgur.com/3FlyW.png)](https://i.stack.imgur.com/3FlyW.png)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-26T15:19:13.920

我只是在我选择的存储库的网站上查看代码并从那里复制。然后粘贴到 OneNote 并保留源格式。

# python - 英语和/或芬兰语文本验证

> ID：783189
> 
> 赞同：0
> 
> 时间：2009-04-23T19:27:10.997
> 
> 标签：python

是否有一个易于使用的 python 模块可以进行英语或芬兰语文本验证？

如果我可以检查用户定义的字典中存在的单词并可能检查语法是否还可以，那就可以了。

我计划对我之前做的目录内容进行花哨的验证。这涉及一些简单的事情，比如检查配置脚本不会崩溃并且做得很好。否则一切都很容易。

对于验证器，我应该能够输入整个文件或 unicode 文本字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T19:32:06.603

我不确定您要做什么，但是如果您正在寻找可以说“这是有效的英语”或“这是有效的芬兰语”的东西，那么您正在寻找的一类问题是很可能无法解决。

如果不是，则使用字典和/或字母频率和贝叶斯分析来确定给定的文本是类似于英语还是类似于芬兰语。如果您尝试自动检测一种语言，这可能是最好的方法，尽管您会遇到混合语言文本的问题。

# windows - Windows XP 索引服务：转义 #, ! 或者 @？

> ID：783191
> 
> 赞同：2
> 
> 时间：2009-04-23T19:27:49.950
> 
> 标签：windows, escaping

在 Windows 资源管理器中打开搜索侧栏 (Ctrl + F)。在标记为“文件中的单词或短语：”的字段中，输入以 #, ! 开头的查询。或 @ 您希望返回一些结果。

我收到以下错误：无法成功完成索引服务查询，因为您指定的卷未编入索引

有没有办法逃避这些字符，以便搜索通过？我知道 Agent Ransack 和命令行解决方案等，但我想知道是否有一种简单的方法可以让 Windows 按预期工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T20:03:09.350

你确定你已经打开了索引服务吗？关闭服务时，我只收到“查询无法成功完成，因为您指定的卷未编入索引”错误。

查看**Control Panel** -> **Administrative Tools** -> **Services**，右键单击**“Indexing Service”**并选择**Start**。

或者，从搜索窗格本身，单击**“更改首选项”**，然后单击**“使用索引服务”**，然后单击**“是，启用索引服务”**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-02T21:55:24.200

尝试以下类型的转义序列：

*   ~=#
*   ~=！
*   ~=@

这个***~=***转义序列似乎适用于 Windows 7，但我不确定 Windows XP。

[我通过在 SuperUser.com 上发布](https://superuser.com/questions/168638/trouble-trying-to-use-windows-search-to-search-for-file-with-a-question-mark-in-t/217491#217491)的类似问题找到了我的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:24:34.650

这很可能是因为索引服务已关闭。要从 Explorer 搜索栏中打开它，您可以执行以下操作：

1.  返回到**您要搜索什么？**控制板
2.  单击面板底部的**更改首选项**
3.  Click **With Indexing Service（用于更快的本地搜索）**
4.  单击**是，启用索引服务**，然后单击确定

您可能需要等待一段时间才能建立索引（如果您再次尝试搜索，它可能会因为索引未完成而失败）。但最终，它应该按预期工作。

# java - 如何为具有可扩展属性的资源编写 DAO？

> ID：783198
> 
> 赞同：0
> 
> 时间：2009-04-23T19:29:01.307
> 
> 标签：java, database, metadata

我正在尝试用 Java 编写一个嵌入式（**不是 Web，不是企业**）内容管理系统，重点是组织、易用性和可扩展到 100,000 个左右的项目。用户和系统应该能够创建和定义可以与独特资源相关联的元数据项，以允许搜索。

例如，他们可以创建一个带有字符串值的标签“ProjectName”。然后他们可以将一堆资源标记为属于“接管世界”或“修理我的车”项目。标签是强类型的，因此标签可以存储单个或多个字符串、整数、双精度等。每种标签类型都应具有格式化程序和输入验证器以允许编辑。

我已经决定从 GUI 中抽象出存储模型以实现可扩展性很重要；显而易见的方法是对每个资源使用数据访问对象 (DAO)。但是，我不知道如何编写支持可变数量标签并能正确扩展的 DAO。

问题是资源既需要表现为元组（用于表格查看/排序/过滤），又需要表现为 (TagName,TagValue) 映射。GUI 模型可能会在每次 GUI 更新时调用这些方法数千次，因此一些索引的概念会使这一切工作得更好。不幸的是，多种标签类型意味着它会很尴尬，除非我将所有内容都作为通用对象返回并做一团糟的“TagValue instanceof Type”条件。

我已经研究过使用反射和 Apache 的 DynaBeans，但是将其编码为与 GUI 模型一起使用看起来既痛苦又尴尬。有一个更好的方法吗？？？一些库或设计模式？

所以，我的问题是，有没有更好的方法？一些库或设计模式可以简单地完成整个事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T01:22:44.763

我从您的问题中假设“资源”是您系统中的一个实体，它具有一些与之关联的“标签”实体。如果我的假设是正确的，这里有一个普通的 DAO 界面，如果这就是你的想法，请告诉我：

```
public interface ResourceDAO {
    void store(Resource resource);
    void remove(Resource resource);
    List<Resource> findResources(QueryCriteria criteria);
    void addTagsToResource(Resource resource, Set<Tag> tags);
} 
```

这里的想法是，您将为任何可用的数据存储机制实现此接口，并且应用程序将通过此接口访问它。实现类的实例将从工厂获得。

这符合你的想法吗？

您提到的问题的另一个方面是必须处理多个不同的 TagTypes，这些 TagTypes 根据类型需要不同的行为（需要“TagValue instanceof Type”条件）。[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)可以优雅地为您处理这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T01:51:51.137

我认为您不应该将这些属性中的任何一个视为实际的成员变量。您应该有一个包含属性（类似于成员变量）的“Property”对象，以及一个具有属性集合（类似于类）的“Collection”对象。

由于这些属性和集合实际上并没有与之关联的代码，因此将它们作为对象来实现是没有意义的（而且会让人头疼）

您的属性和集合需要保存所有特定于它们的数据。例如，如果一个字段最终被写入数据库，它需要将它的表名存储在某个地方。如果需要将其写入屏幕，则还需要将其存储在某个地方。

范围/值检查可以“添加”到属性中，因此当您定义属性是什么类型的数据时，您可能会有一些文本显示“MaxLength(12)”，它将实例化一个名为 MaxLength 的类，其值为 12，并将该类存储到属性中。每当属性的值更改时，新值将传递给已应用于此类的每个范围检查器。可以有许多类型的动作与该类相关联。

这只是基础。我已经设计了这样的东西，这是一个很好的工作，但它比尝试用一种直接的语言来做要简单得多。

我知道现在这似乎工作太多了（如果你真的明白我的建议，它应该），但请记住它，最终你可能会去“嗯，也许这毕竟值得一试” .

编辑（回复评论）：

我考虑过尝试使用注册表/键的东西（我们仍在谈论属性值对），但它不太合适。

您正在尝试将 DAO 放入 Java 对象中。这真的很自然，但我开始将其视为解决 DAO/DTO 问题的一种糟糕方法。Java 对象具有作用于这些属性的属性和行为。对于您正在做的事情，没有行为（例如，如果用户创建一个“生日”字段，您将不会使用目标代码来计算他的年龄，因为您并不真正知道生日是什么）。

因此，如果您丢弃拥有对象和属性，您将如何存储这些数据？

让我先迈出非常简单的第一步（这与您提到的注册表/标签系统非常接近）：在您使用对象的地方，使用哈希表。对于您的属性名称，使用键，对于属性值，使用哈希表中的值。

现在，我将介绍我为增强这个简单模型而采取的问题和解决方案。

问题：您丢失了强类型，并且您的数据格式非常自由（这可能很糟糕）

解决方案：为“属性”创建一个基类，以代替哈希表中的值。为 IntegerAttribute、StringAttribute、DateAttribute 扩展该基类...... 不要允许不适合该类型的值。现在你有强类型，但它是运行时而不是编译时——可能没问题，因为你的数据实际上是在运行时定义的。

问题：格式化程序和验证程序

解决方案：能够为您的属性基类创建插件。您应该能够为任何属性“setValidator”或“setFormatter”。验证器/格式化程序应该与属性一起使用——所以当你保存属性时，你可能必须能够将它们序列化到数据库中。

这里好的部分是，当您对属性执行“attribute.getFormattedValue()”时，它会预先格式化以供显示。如果任何验证失败，attribute.setValue() 将自动调用验证器并抛出异常或返回错误代码。

问题：如何在屏幕上显示这些？我们已经有了 getFormatted() 但它在屏幕上的什么位置显示？我们用什么做标签？什么样的控件应该编辑这个字段？

解决方案：我会将所有这些内容存储在每个属性中。（订单应该存储在类中，但由于这是一个哈希表，所以它不会工作——好吧，我们接下来会谈到）。如果您存储显示名称、用于呈现此的控件类型（文本字段、表格、日期...）和数据库字段名称，则此属性应具有与显示和数据库交互所需的所有信息/ O 编写处理属性的例程。

问题：哈希表对于 DAO 来说是一个糟糕的接口。

解决方案：这是完全正确的。您的哈希表应该包装在一个知道它所拥有的属性集合的类中。它应该能够将自己（包括它的所有属性）存储到数据库中——可能在帮助类的帮助下。它应该能够通过单个方法调用来验证所有属性。

问题：如何实际使用这些东西？

解决方案：由于它们包含自己的数据，因此在系统中它们交互的任何位置（例如与屏幕或数据库），您都需要一个“适配器”。

假设您正在展示一个屏幕来编辑您的数据。您的适配器将被传递一个框架和一个基于哈希表的 DTO。

首先，它会按顺序遍历属性列表。它会询问第一个属性（比如一个字符串）它想使用什么样的控件来进行编辑（比如一个文本字段）。

它将创建一个文本字段，然后将一个侦听器添加到将更新数据的文本字段，这会将您的数据绑定到屏幕上的控件。

现在，每当用户更新控件时，更新都会发送到 Attribute。该属性存储新值，您就完成了。

（这会因为一次传输所有值的“OK”按钮的概念而变得复杂，但我仍然会事先设置每个绑定并使用“OK”作为触发器。）

这种绑定可能很困难。我是手工完成的，一旦我使用了一个名为“JGoodies”的工具包，它内置了一些绑定能力，这样我就不必自己编写每个可能的绑定组合，但我不确定从长远来看它节省了很多时间。

这太长了。总有一天我应该创建一个 DAO/DTO 工具包——我认为 Java 对象根本不适合作为 DAO/DTO 对象。

如果您仍然感到困惑，请随时通过电子邮件/即时消息给我——gmail 的 bill.kress。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:53:19.563

您是否与使用关系数据库有关？研究面向文档的数据库（例如 couchDB）可能是值得的。它将为您提供存储所需任意强类型对象所需的灵活性，并让您也能够查询这些对象。我相信也有一些用于访问 couchDB 的 Java 库。

# iphone - iPhone中的剥离回车

> ID：783199
> 
> 赞同：5
> 
> 时间：2009-04-23T19:29:01.337
> 
> 标签：iphone, objective-c

我用objective-c 为Iphone 解析一个XML 文件。解析结果字符串变量后得到一个回车字符。怎么能把它从弦上剥下来。

谢谢大家。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-23T19:39:53.073

我相信下面的代码片段会做你想要的修剪。

```
NSString *foo = @"THis is foo\r";
NSString *bar = [foo stringByTrimmingCharactersInSet:[NSCharacterSet newlineCharacterSet]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T20:38:20.030

您可能还会发现[NSString 正则表达式添加](http://regexkit.sourceforge.net/Documentation/NSString.html)很有用。您可以快速将“\r”字符替换为空字符，将它们从文档中删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T11:27:46.950

上面的帖子提到了在 iphone 中使用 RegexKit。

事实上，您需要在 iPhone 上使用 RegexKitLite 并将其链接到不受支持的 icu 库。

RegexKit 不适用于 iPhone。

# php - 使用 PHP 和 Curl 隐藏响应

> ID：783205
> 
> 赞同：5
> 
> 时间：2009-04-23T19:31:35.217
> 
> 标签：php, curl, twitter

我正在重用很久以前的 curl 函数，现在的行为与我记忆中的不同。在这种特殊情况下，我正在验证用户的 Twitter 凭据。这是现在的代码：

```
$cred = $_POST['twitter_username'].':'.$_POST['twitter_password'];
$url = "http://twitter.com/account/verify_credentials.json";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_GET, 0);
curl_setopt($ch, CURLOPT_USERPWD, $cred);
$result = curl_exec ($ch);
curl_close ($ch); 
```

这对于身份验证工作正常，但是将整个 JSON 响应输出到浏览器，我不想这样做。

我对卷曲不是很熟悉。我尝试将 CURLOPT_VERBOSE 设置为 0 和 false，但都没有成功。我确信这是某个地方的一个非常简单的更改，但我不知道它是什么。

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-23T19:33:32.073

你需要这个选项：

```
curl_setopt(CURLOPT_RETURNTRANSFER, true); 
```

来自[curl 文档](http://www.php.net/curl_setopt)：

> `CURLOPT_RETURNTRANSFER`: TRUE 将传输作为 curl_exec() 的返回值的字符串返回，而不是直接输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T19:45:04.987

我写了这个函数来帮助简化我的 CURL 请求

```
function curl_http_request ($url, $options)
{
    $handle = curl_init($url);
    curl_setopt_array($handle, $options);
    ob_start();
    $buffer = curl_exec($handle);
    ob_end_clean();
    curl_close($handle);
    return $buffer;
} 
```

使用示例

```
$options = array(
    CURLOPT_RETURNTRANSFER => TRUE,
    CURLOPT_USERPWD => $cred
);

curl_http_request($url, $options); 
```

# api - 为我的软件创建 API - 基本代码结构

> ID：783209
> 
> 赞同：0
> 
> 时间：2009-04-23T19:32:54.540
> 
> 标签：api, code-structure

我目前正在编写一个 Web 软件，客户端桌面也将通过 API 使用该软件。我现在面临的问题是：我是否应该在应用程序中执行两次添加/更新/删除对象的每个操作？一旦它位于普通代码中并且曾经为 API 隔离？

或者我应该更愿意使用代表我数据库中所有对象的 OOP 模型类系统，并将它们用于 API 和普通代码？

还是直接开发 API 并在我的普通 Web 界面中使用它？

这是我一直想知道的事情。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T19:37:32.020

做两次事情几乎总是一个坏主意——你可能最好实现 API，向最终用户开放，并将其用于客户端代码，并为接口的东西添加一些额外的钩子-具体的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T19:46:31.810

这就是我们拥有 REST（和 SOAP）协议的原因。

桌面向您的 Web 应用程序发出 RESTful 请求。您的 Web 应用程序接收 REST 请求并执行实际工作。

您的代码只存在于一个地方——网络。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T19:59:09.703

首先让我说我的经验是使用 Django，它是一个已经提供 ORM 的富 Web 框架。我必须创建模型来代表我的对象；我不执行原始 sql。

所以我自然会推荐你的第二种方法。马上我会说你的第三种方法会让人头疼。为什么？因为你会想要做不同的后期处理。这就是游戏的本质。当您在 Web 上建立一个 CRUD 界面时，一些内容将作为字段存储在您的模型中，用户甚至无法从 CRUD 页面中识别出来。例如，我有一个 CRUD 页面，其中包含与不同公司相关联的新闻报道。（这是一个数据库外键。）当然，这是由登录信息自动提供的。但是登录网页的过程（以及登录的存储位置）将与远程 API 的过程大不相同。

我的偏好是将您的前两种方法中的一点点结合起来。每次保存对象时肯定应该发生一些动作。把它们放在一个`save()`方法中（或者`update()`如果`insert()`你想把事情分解得更多）。您不应该考虑两次实现此功能。

但是，反序列化/对象构造和验证在 Web 界面和远程 API 中会发生不同的情况。这确实应该单独实施。

人们也可能将验证视为与反序列化本质上不同，并认为某些规则是相同的，而另一些则不同。例如，在 Web 界面中，我知道当我收到故事时，我会标记`modification_time`自己，而对于远程 API，我相信客户端会标记时间。这是故意的。另一方面，任何没有标签的故事都必须收到`default`标签，无论它来自哪里。您可能更喜欢在对象构造之后自由地制作验证器对象。

一个代码示例（在 python 中）：

```
def handle_remote_update(serialized_object):
    #do some parsing
    model_object = ModelObject(...)#fill in with parsed values
    validator1.validate(model_object)
    validator3.validate(model_object)
    model_object.save()#All database code is in this method
    #If you have to log to your system or notify listeners, that's also in this method

def handle_web_submission(post_dict):
    #do some parsing
    model_object = ModelObject(...)#fill in with parsed values
    validator2.validate(model_object)#This wasn't executed above
    validator3.validate(model_object)#This was
    model_object.save()#Same code gets executed down here as above 
```

当然，我只处理了`insert`或可能的情况`update`。您需要*调用*这些函数的是一些方法拆分器，它知道远程 api 何时调用以及相应地调用不同的函数（`insert`对于`delete`Web 界面也是如此）。如果您使用的是 Web 框架，这很可能是您的 Web 界面部分的 urlconfig。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T06:06:27.780

REST 几乎已成为通过 Web 为客户端提供 API 的标准，并且还为您提供了很大的灵活性和功能。如果您在 .net 平台上工作，您实际上可以使用 ASTORIA [ADO.Net Data Services]，它通过简单地映射您的数据库对象来生成基于 REST 的 Web 服务。

# sql - 计算两个日期之间的差异

> ID：783211
> 
> 赞同：2
> 
> 时间：2009-04-23T19:33:19.330
> 
> 标签：sql, sql-server, database

我有一份报告计算了多个日期差异（以工作日为单位，而不是 DATEDIFF），原因是各种商业原因太枯燥而无法进入。

基本上查询（现在）看起来像

```
SELECT -- some kind of information
       DATEDIFF(dd, DateOne, DateTwo) AS d1_d2_diff,
       DATEDIFF(dd, DateOne, DateThree) AS d1_d3_diff,
       DATEDIFF(dd, DateTwo, DateThree) AS d2_d3_diff,
       DATEDIFF(dd, DateTwo, DateFour) AS d2_d4_diff
  FROM some_table; 
```

我可以更改此计算以使用标量函数，但我不希望标量函数对结果集中的每一行执行 4 次。

我在数据库中有一个日历表：

```
CREATE TABLE Calendar (
   Date DATETIME NOT NULL,
   IsWeekday BIT,
   IsHoliday BIT
); 
```

表值函数和 CROSS APPLY 在这里会是一个不错的选择吗？如果是这样，我将如何写这样的东西？还是我最好的选择是标量函数？

**重要提示**我们数据库中的所有日期值都已删除时间，因此可以安全地忽略任何将天数重置为午夜的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T19:47:07.923

实际上，我认为您想为此使用标量函数。乍一看，您需要进行一些计算。然后我想了更多，实际上你可以通过两步过程非常简单地做到这一点。

1.）~~将您的日期值回滚到相应日期的午夜，这样您就可以轻松计算出来。~~由于提供了额外的信息，这不是必需的！

2.) 执行查询以找出工作日值之间存在多少天，而不是假期

```
SELECT ISNULL(COUNT(*), 0)
FROM Calendar
WHERE [DATE] > DateOne 
    AND [DATE] < DateTwo
    AND IsWeekDay = 1
    AND IsHoliday = 0 
```

总的来说，我认为最有效的方法是将其作为标量函数执行，我相信可能还有其他方法，但这种方法很简单，只要您在日历表上有索引，它不应该表现太差了。

*交叉应用注释*

稍微看一下，这也可以通过交叉应用来完成，但实际上它最终会做同样的事情，所以我认为 Scalar 函数是一个更好的解决方案，因为它更容易理解，并且很容易重复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T02:26:50.587

诀窍是使用内联表值函数，因为它们不会遭受与标量函数相同的性能损失。它们相当于将函数的源代码实际粘贴到查询中。

以下是它的工作原理：

```
create function BusinessDayDiffs_fn ( 
  @DateOne datetime
, @DateTwo datetime
)
returns table
as return (
  select count(*) as numBusinessDays
  from Calendar
  where date between @DateOne and @DateTwo
    and IsWeekday = 1
    and IsHoliday = 0;
)

GO

select
  d1_d2_diff = d1_d2.numBusinessDays,
  d1_d3_diff = d1_d3.numBusinessDays,
  d2_d3_diff = d2_d3.numBusinessDays,
  d3_d4_diff = d3_d4.numBusinessDays
from some_table s
cross apply BusinessDayDiffs_fn( DateOne, DayTwo  ) d1_d2
cross apply BusinessDayDiffs_fn( DateOne, DayThree) d1_d3
cross apply BusinessDayDiffs_fn( DayTwo,  DayThree) d2_d3
cross apply BusinessDayDiffs_fn( DayTwo,  DayFour ) d2_d4; 
```

这应该执行得很好，因为它与将子查询从函数中取出并将其直接粘贴到主查询的 select 子句中相同。它会比标量函数快得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:50:52.783

我也建议您为此使用标量函数。下面是我从[这里](http://www.ideaexcursion.com/2008/09/24/calculate-weekdays-between-two-dates/)偷来的一个功能。这样，您只需要维护一个假期表并减去您的开始日期和结束日期之间的数字。

```
CREATE FUNCTION dbo.fn_WeekdayDiff(@StartDate DATETIME, @EndDate DATETIME)
RETURNS INT
AS
--Calculdate weekdays between two dates
BEGIN
    --if @StartDate is AFTER @EndDate, swap them
    IF @StartDate > @EndDate
    BEGIN
        DECLARE @TempDate DATETIME
        SET @TempDate = @StartDate
        SET @StartDate = @EndDate
        SET @EndDate = @TempDate
    END

    RETURN
        --number of weeks x 5 weekdays/week
          (DATEDIFF(ww, @StartDate, @EndDate) * 5)
        --add weekdays left in current week
        + CASE DATEPART(dw, @StartDate + @@DATEFIRST) WHEN 1 THEN 5 ELSE (7 - DATEPART(dw, @StartDate + @@DATEFIRST)) END
        --subtract weekdays after @EndDate
        - dbo.fn_MaxInt(6 - DATEPART(dw, @EndDate + @@DATEFIRST), 0)
END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-08T04:41:50.310

下面是一个基于上面的版本，应该适用于 MySQL

```
#
# This function calculates the total number of weekdays (inclusive)
# between the specified dates.
#
# If start date < end date, the value returned is negative
#
# Known issues - due to the inaccuracy of the MySQL WEEK detection
# boundaries across years may be incorrect
#

DELIMITER $$

DROP FUNCTION IF EXISTS `dbname`.`WeekdayDiff` $$
CREATE FUNCTION `dbname`.`WeekdayDiff` (start_date date, end_date date) RETURNS INT DETERMINISTIC
BEGIN
  DECLARE week_diff INT;
  DECLARE week_diff_add_days INT;
  DECLARE temp_date DATE;
  DECLARE multiplier INT;
  DECLARE wd_left_in_start_inclusive INT;
  DECLARE wd_left_in_end_exclusive INT;
  DECLARE wd_diff INT;

  SET multiplier = 1;

  IF start_date > end_date THEN
    SET temp_date = end_date;
    SET end_date = start_date;
    SET start_date = temp_date;
    SET multiplier = -1;
  END IF;

  # Note we subtract 1 from the dates here as
  # we want sunday to be included in the last week
  SET week_diff = (YEAR(end_date) * 52 + WEEK(end_date-1)) - (YEAR(start_date) * 52 + WEEK(start_date-1));
  SET week_diff_add_days = week_diff * 5;

  # Calculate the week days left in the start week
  SET wd_left_in_start_inclusive = GREATEST( 5 - WEEKDAY( start_date ), 0 );
  SET wd_left_in_end_exclusive = GREATEST( 4 - WEEKDAY( end_date ), 0 );

  SET wd_diff = week_diff_add_days + wd_left_in_start_inclusive - wd_left_in_end_exclusive;

  RETURN wd_diff * multiplier;
END $$

DELIMITER ; 
```

# c++ - 查找单实例 Qt 应用程序的 QWidget

> ID：783212
> 
> 赞同：2
> 
> 时间：2009-04-23T19:33:25.633
> 
> 标签：c++, windows, qt

我正在尝试创建一个单实例 Qt 应用程序，并且我已经做到了这一点，但现在我想在第二个启动时关注已经启动的实例。QWidget::find(g_hWnd) 应该返回小部件，但它在 w->show() 上失败并崩溃；

有什么想法吗？

```
#pragma data_seg("Shared")
HWND g_hWnd = NULL;
#pragma data_seg()
#pragma comment(linker,"/section:Shared,rws")

int main(int argc, char *argv[])
{
    if (g_hWnd)
    {
        QWidget* w = QWidget::find(g_hWnd);
        w->show();
        return 0;
    }
    else
    {
        QApplication a(argc, argv);
        mainWindow w;
        w.show();
        g_hWnd = a.topLevelWidgets().at(0)->winId(); //or w.winId()?

        return a.exec();
    }
} 
```

**编辑：我现在看到 Trolltech在 LGPL 下发布了[QtSingleApplication类。](http://doc.trolltech.com/solutions/4/qtsingleapplication/qtsingleapplication.html)**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-23T19:45:17.757

您应该使用[qtsingleapplication](http://doc.trolltech.com/solutions/4/qtsingleapplication/qtsingleapplication.html) API

编辑-这是一个单独的下载 ，[请参见此处](http://www.qtsoftware.com/products/appdev/add-on-products/catalog/4/Utilities/qtsingleapplication/)用于 LGPL 和商业版

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-18T06:46:12.917

```
#include <QtGui/QApplication>
#include "mainwindow.h"
#include <QMessageBox>
#include <QSharedMemory>

int main(int argc, char *argv[])
{ 
    QApplication a(argc, argv);
     MainWindow w;

    QSharedMemory shared("61BB200D-3579-453e-9044-");
    if(shared.create(512,QSharedMemory::ReadWrite)==true)
    {
        QMessageBox msgBox;
        msgBox.setText("I am first.");
        msgBox.exec();
    }
    else
    {
        QMessageBox msgBox;
        msgBox.setText("i am already running.");
        msgBox.exec();
        exit(0);
    }
    //shared.AlreadyExists()

    w.show();
    return a.exec();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:12:28.953

这可能是您遇到的问题：

> WId QWidget::winId () 常量
> 
> 返回小部件的窗口系统标识符。
> 
> 原则上是便携的，但如果你使用它，你可能会做一些非便携的事情。当心。
> 
> 如果一个小部件是非本地的（外来的）并且在其上调用了 winId()，则该小部件将被提供一个本地句柄。
> 
> **注意：我们建议您不要存储此值，因为它可能会在运行时更改。**

[来源](http://doc.trolltech.com/4.5/qwidget.html#winId)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T22:05:03.927

我怀疑你的方法会奏效。

最好的方法仍然是运行一个本地服务器（参见[QLocalServer](http://doc.trolltech.com/qlocalserver.html)），它从特定的套接字进行侦听。新启动的实例将检测正在运行的服务器，并可以通过管道传输约定的命令，例如设置焦点、打开新文件等。

类似的方法是使用命名共享内存（请参阅[QSharedMemory](http://doc.trolltech.com/qsharedmemory.html)）。和以前一样，如果共享内存已经存在，对方可以通过发送合适的命令来控制它。

# python - 从元组列表创建树

> ID：783217
> 
> 赞同：3
> 
> 时间：2009-04-23T19:34:26.800
> 
> 标签：python, sorting, tree

我现在好像是个盲人，所以我需要在这里问一下。我想对看起来像这样的元组列表进行排序

```
(id, parent_id, value) 
```

这样它就可以将树表示为树节点列表的扁平列表。

例如输入

```
(1, None, '...')
(3, 2', '...')
(2, 1, '...')
(4, 1, '...')
(5, 2, '...')
(6, None, '...') 
```

之后应该这样排序

```
(1, None, '...')
(2, 1, '...')
(3, 2', '...')
(5, 2, '...')
(4, 1, '...')
(6, None, '...') 
```

任何提示将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T19:44:51.517

Python 从左到右对元组进行排序，所以如果你安排你的元组，使第一个排序键是第一项，依此类推，它会相当有效。

从您所描述的内容中，从元组列表到树的映射并不清楚。请把它画出来，或者更彻底地解释一下。例如，您的示例似乎是：

[![树形图](https://i.stack.imgur.com/SWPUZ.png)](https://i.stack.imgur.com/SWPUZ.png)
[（来源：[sabi.net](http://web.sabi.net/temp/tree.png)）]

如果您有两个没有父节点的节点，那更像是森林而不是树。你想用树代表什么？在这种情况下，“排序”是什么意思？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T20:04:04.590

我不确定我是否完全遵循了您正在尝试做的事情，但是如果您有一个森林作为节点列表，您不能只阅读它并构建树结构，然后将其写成面包-首先遍历所有树？有什么特别的理由可以避免这种情况吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-24T14:22:51.823

奥利弗，如果我理解正确，我认为您可以（a）将数据库中的所有元组检索到字典或列表中，然后构造树，或者（b）在检索元组时使用 ORDER BY 子句，以便它们按照您将它们添加到树中的顺序。

如果可以在您的应用程序中对树进行更改然后传播到数据库，我会选择一个，但如果更改总是在数据库插入、更新或删除时进行，并且除这些之外，您的树是只读的，那么选项 b 应该更快并且需要更少的资源。

罗兰

# ruby-on-rails - 我应该如何跟踪小部件渲染？

> ID：783225
> 
> 赞同：0
> 
> 时间：2009-04-23T19:38:14.013
> 
> 标签：ruby-on-rails, database, apache-flex, statistics, widget

我创建了一个小部件，我的网站的用户将嵌入他们的网站。我想跟踪小部件呈现的次数以及引用 URL。小部件是用 flex 编写的，我的后端是 Rails。

一种明显的方法是让我的小部件对后端进行服务调用以注册命中。但是，当我的小部件加载时，它会获取一个配置 XML。如果我添加另一个渲染服务调用，每个小部件渲染将有 3 个请求（一个用于获取 swf，一个用于获取配置，一个用于渲染）。我可以使 config.xml 动态化并在那里处理渲染，然后返回 XML ......但这可能不利于缩放吗？

另一种方法是使嵌入源 URL 指向处理命中然后返回 swf 的脚本...我很确定这是可能的。但我也不确定这是否是最好的方法。

我对这方面的任何专业建议感兴趣。专业人士如何有效地实施这个简单的系统？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T20:30:57.770

您提到的所有三个选项似乎都是完全有效的方法，但是在返回 .swf 或 .xml 配置文件的同时注册这些命中似乎是一件聪明的事情，因为 AFAIK 大多数浏览器都有一个漂亮的他们可以向同一主机发出的并发 HTTP 请求数量的下限（我认为是两个或类似的），因此如果必须发出更多请求才能在浏览器中呈现某些内容，超过此限制的请求将必须等待第一个完成才能启动。它也可能需要稍微减少你的工作。

我能想到的唯一区别是返回 .swf 并不意味着 Flash Player 实例会渲染它，因此在返回配置 xml 时“注册渲染”似乎可以让您更可靠地衡量多少次某人的浏览器已成功加载并向他们显示此 .swf（假设 Flash 应用程序将在成功加载此配置文件后发起对该配置文件的请求）。

就扩展问题而言，无论您何时注册命中，它仍然需要在服务器上进行相同数量的处理（我无法想象这样的事情会非常高），所以我不不要认为这是一个大问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T03:19:09.827

执行此操作的标准方法是从您的站点加载 1px 图像（“错误”），并在您的站点上使用分析来跟踪统计信息。这种技术有很多创新，但它们都基于简单的 1px 图像加载，并使用相关的 HTTP 标头。

维基百科有一篇关于这种技术的好文章：

[http://en.wikipedia.org/wiki/Web_bug](http://en.wikipedia.org/wiki/Web_bug)

（此外，浏览器对并发 HTTP 请求的限制仅适用于发送到同一域的请求。您可以通过使用多个子域或任何其他技术来解决此问题，以确保您的资源并非全部来自同一个域。）

# ruby-on-rails - Ruby on Rails 和 CruiseControl.rb

> ID：783227
> 
> 赞同：1
> 
> 时间：2009-04-23T19:38:28.320
> 
> 标签：ruby-on-rails, email, notifications, cruisecontrol.rb

如何使用 CruiseControl.rb 设置电子邮件通知？我在 site-config.rb 中指定了 ActionMailer::Base.smtp_settings 但我在哪里指定谁将收到电子邮件通知？我需要创建一个 config.xml 文件吗？如果是这样，我应该把文件放在哪里，你有这个文件内容的例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T04:46:11.637

这实际上是在项目特定的 Cruise_config.rb 文件中指定的。

这实际上是在每个 ~/.cruise/projects/ 目录中为您创建的。

一个示例如下所示：

```
Project.configure 做 |project|
  project.email_notifier.emails = ["you@example.com"]
结尾

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T19:41:20.463

查看 config/site_config.rb。有一个用于启用电子邮件通知的注释模板。

# asp.net-mvc - 你如何模拟 asp.net mvc 中的缓存对象？

> ID：783228
> 
> 赞同：17
> 
> 时间：2009-04-23T19:39:34.027
> 
> 标签：asp.net-mvc, unit-testing, mocking

我将如何模拟 ControllerContext 对象上的缓存对象以进行单元测试？我尝试创建一个如下所示的包装类（因为缓存对象是密封类），但没有成功。

```
var mockControllerContext = new Mock<ControllerContext>(); 
var mockhttpContext = new Mock<HttpContextBase>();            

mockhttpContext.SetupGet(o => o.Cache).Returns(
         new CacheWrapper(mockControllerContext.Object.HttpContext.Cache));

mockControllerContext.SetupGet(
                          o => o.HttpContext).Returns(mockhttpContext.Object);
this.tennisMatchupController.ControllerContext = mockControllerContext.Object; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-23T20:02:23.253

**编辑**：我找到了一种更简单的方法，至少在您使用空缓存进行测试时。使用 HttpRunTime.Cache 作为您对 HttpContext 的 Cache 属性的期望的返回值。对于更高级的场景，使用包装器和模拟可能仍然是更好的处理方式——例如，如果您需要测试缓存中的异常。

```
var httpContext = MockRepository.GenerateMock<HttpContextBase>();
httpContext.Expect( h => h.Cache ).Return( HttpRunTime.Cache ).Repeat.Any() 
```

**原文**：

包装类是要走的路，但我认为你在错误的地方应用它。我会给我的控制器一个 CacheWrapper 属性，然后创建一个构造函数，允许我传入一个可以设置此属性的 CacheWrapper 实例。默认情况下，控制器使用 HttpContext.Current.Cache 创建一个 CacheWrapper。在您的测试代码中，构造一个模拟 CacheWrapper 以传递给控制器​​的构造函数。这样，您根本不需要创建模拟 Cache 对象——这很难，因为它是一个密封的类。

或者，您可以只实例化 Cache 类的一个实例并返回它，因为它有一个公共构造函数。使用模拟的优点是您可以通过期望验证缓存是否正在使用，所以我可能会使用包装器。

```
public class CacheWrapper
{
  private Cache Cache { get; set; }

  public CacheWrapper()
  {
     this.Cache = HttpContext.Current.Cache;
  }

  public virtual Object Add( string key,
                             Object value,
                             CacheDependency dependencies,
                             DateTime absoluteExpiration,
                             TimeSpan slidingExpiration,
                             CacheItemPriority priority,
                             CacheItemRemovedCallback onRemoveCallback )
  {
     this.Cache.Add( key,
                     value,
                     dependencies,
                     absoluteExpiration,
                     slidingExpiration,
                     priority,
                     onRemoveCallback );
  }

  ...wrap other methods...
}

public class BaseController : Controller
{
    private CacheWrapper { get; set; }

    public BaseController() : this(null) { }

    public BaseController( CacheWrapper cache )
    {
        this.CacheWrapper = cache ?? new CacheWrapper();
    }
}

[TestMethod]
public void CacheTest()
{
   var wrapper = MockRepository.GenerateMock<CacheWrapper>();

   wrapper.Expect( o => o.Add( ... ) ).Return( ... );

   var controller = new BaseController( wrapper );

   var result = controller.MyAction() as ViewResult;

   Assert.AreEqual( ... );

   wrapper.VerifyAllExpectations();
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-07-30T16:16:36.533

我建议使用 Microsoft 的新**MemoryCache.Default**方法。您将需要使用 .NET Framework 4.0 或更高版本并包含对*System.Runtime.Caching*的引用。

请参阅此处的文章-> [http://msdn.microsoft.com/en-us/library/dd997357(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/dd997357(v=vs.100).aspx)

MemoryCache.Default 适用于 Web 和非 Web 应用程序。所以这个想法是你更新你的 webapp 以删除对 HttpContext.Current.Cache 的引用并将它们替换为对 MemoryCache.Default 的引用。稍后，当您决定对这些相同的方法进行单元测试时，缓存对象仍然可用并且不会为空。（因为它不依赖于 HttpContext。）

这样，您甚至不必模拟缓存组件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-23T02:08:19.820

```
HttpContext.Current = new HttpContext(new HttpRequest(null, "http://tempuri.org", null), new HttpResponse(null)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T12:01:10.643

您可以尝试使用[Typemock Isolator](http://www.typemock.com)，它会开箱即用地伪造密封类，因此您不需要这些包装器。

# asp.net - 使用 ASP.NET 从 GET 请求中获取 XML 响应的一些帮助（参见代码）？

> ID：783232
> 
> 赞同：0
> 
> 时间：2009-04-23T19:40:08.877
> 
> 标签：asp.net, xml, get

似乎无法弄清楚，请参见下面的代码。尝试向 Basecamp 发出 GET 请求并将它返回的 XML 存储在内存中，以便我可以解析它。不确定如何准确地“触发”请求或从中取回 XML，请告知。

```
using System;
using System.Web;
using System.Data;
using System.Xml;
using System.Net;
using System.IO;

public class bc2fb : IHttpHandler {

    private struct projectItem
    {
        int projID;
        string projCode;
        string projName;
    }

    private projectItem[] allProjects = new projectItem[100];

    public void ProcessRequest (HttpContext context) {
        context.Response.Write(GetAllProjects().Value);

    }

    public XmlTextReader GetAllProjects()
    {
        HttpWebRequest objRequest = (HttpWebRequest)WebRequest.Create("https://company_name.updatelog.com/projects.xml");

        objRequest.Method = "GET";
        objRequest.ContentType = "application/xml";
        objRequest.Accept = "application/xml";

        string creds = "uname:pass";
        byte[] encData_byte = new byte[creds.Length];
        encData_byte = System.Text.Encoding.UTF8.GetBytes(creds);
        string encodedData = Convert.ToBase64String(encData_byte);

        objRequest.Headers.Add("Authorization", "Basic " + encodedData);

        XmlTextReader projectXML = new XmlTextReader(???WHAT TO DO HERE???);

        return projectXML;

    }

    public bool IsReusable {
        get {
            return false;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T19:49:45.390

```
HttpWebResponse response = (HttpWebResponse)objRequest.GetResponse();
XmlTextReader projectXML = new XmlTextReader(response.GetResponseStream()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T19:58:39.550

您需要使用 GetResponse，然后对其进行处理。请参阅[.NET 的 REST 客户端库，第 1 部分](http://johnwsaundersiii.spaces.live.com/blog/cns!600A2BE4A82EA0A6!657.entry)。

请注意，没有第 2 部分。

# c# - C# 中按位与的逆运算是什么？

> ID：783237
> 
> 赞同：7
> 
> 时间：2009-04-23T19:43:08.010
> 
> 标签：c#, bitwise-operators

我需要做一个逆计算，包括按位与运算，我该怎么做？

我尝试了异或，但没有帮助。

```
 int i = 254 & 2;
        Console.Write("254 & 2 ={0}", i + "\n");
        Console.Write("{0} ^ 2 ={1}",i, (i ^ 2) + "\n"); 
```

不工作。我该如何计算？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-23T19:49:28.853

给定`i`的，你不能回来`254`。通过`&`ing 它，您已经破坏了未存储在第二位中的数据。

```
 1111 1110
&0000 0010
----------
 0000 0010 
```

您将如何恢复丢失的 6 个位？因为`x & 2 == 2`，你几乎可以放任何`x`东西，这将是真的。

```
 0010 1010 // = 42
&0000 0010
----------
 0000 0010 
```

是`x`254 还是 42？你说不出来。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-23T19:49:46.980

从技术上讲，AND 的对立面是 NAND：

> ~( 254 & 2 )

请注意，~ 是补码运算符，并且按位 NOT（将每个位切换到相反的位置）。

不过，你到底想要什么？你想达到什么目的？

如果您试图撤消计算，则不能 - 没有逆函数使得 inverseand(and(x, y)) 将返回 x 或 y，即使 inverse 给出其中之一。

-亚当

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T19:49:07.623

你不能，你已经丢失了执行 & 时的数据。

4 位示例：

```
1110 & 0010 = 0010 
```

如果您只知道结果 0010 和 & 的第二个操作数（也是 0010），您将无法知道哪些位是 1，哪些不是。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T19:55:44.360

Wikipedia 有一篇关于位运算的好文章，它们如何工作以及它们在 C 和 Java 中的语法，这与 C# 非常相似

[http://en.wikipedia.org/wiki/Bitwise_operation](http://en.wikipedia.org/wiki/Bitwise_operation)

MSDN 当然也有每个位和逻辑运算符的文档，每个运算符都有一个示例：

[http://msdn.microsoft.com/en-us/library/6a71f45d(vs.71).aspx](http://msdn.microsoft.com/en-us/library/6a71f45d(vs.71).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T19:59:01.700

反向计算是什么意思？

如果您将数字 254 视为由 8 位组成的位寄存器，则除最后一位之外的所有位都设置为 1。

计算 254 & 2 与检查寄存器中的第 2 位是否设置相同。

与此相反的是什么？检查是否设置了所有其他位？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-26T08:50:44.467

如果`&`操作的目的是检查是否设置了位 1，则潜在的“相反”操作是“设置位 1”。

IE：

```
val = val | 2; 
```

这会覆盖当前位 2 中的值，并且不会触及任何其他位。

如果字节中的 8 位被认为是完全独立的位，那么可以通过触摸任何其他位来更改其中的任何位。

在这种情况下，丢失一些原始信息并不重要。我们实际上并不关心其他位具有什么值，并且通常在使用位掩码时，所讨论的位的原始值无论如何都是零。

# java - 贾斯珀报告 PDF。& 性格惹麻烦

> ID：783243
> 
> 赞同：2
> 
> 时间：2009-04-23T19:45:32.327
> 
> 标签：java, jasper-reports

我正在尝试使用 JasperReports 创建一个 pdf 文档。一切正常，除了出现 & 字符时，一些标签没有被解释，并出现在最终文档中。

我必须转义“&”字符吗？我已经尝试过编写 & 代替，以及将 a 包裹起来。在第一种情况下， & 出现在我的 pdf 中，而在第二种情况下，& 符号消失了。

我的 JasperReport 元素是：

```
<textFieldExpression   class="java.lang.String"><![CDATA[$P{footer}]]></textFieldExpression> 
```

例如。所需：a & b

第一次尝试：一个“&” 湾。结果：一个“&” b

第二次尝试：“<！[ CDATA[&]] > b”。结果：ab

（我添加了一些空格和引号以避免此编辑器中的字符串格式）

有什么线索吗？

编辑：请阅读第一条评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T15:24:27.830

您是否尝试过转义为 ASCII 或 Unicode：

*   "a & b"
*   "a & b"

?

# java - 通过套接字传递对（大）数据区域的引用

> ID：783246
> 
> 赞同：0
> 
> 时间：2009-04-23T19:45:50.000
> 
> 标签：java, sockets, reference

我一直在阅读 Java 中引用的描述，虽然我觉得我理解它们，但我不确定 Java 是否允许我执行以下操作：我们在同一个 JVM 中有两个线程通过套接字进行通信，我们想通过套接字传递本质上是大量数据的地址，而不复制数据本身。解决方案对初学者来说可能很明显，但我想不通！帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T19:57:46.760

AFAIK Java 不提供获取对象内存引用的方法。不过，可能对您有用的是使用共享数组或共享向量，您可以将数据作为对象放入向量/数组中，并通过套接字传递对象的索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T20:32:30.013

这个插座上还有什么东西？如果是你自己的协议，那么在协议中添加一个动词，上面写着“从已知位置获取那个大东西”，然后发送动词。这些物体有多少？你可以制作一个映射 - 字符串，对象 - 并通过套接字传递字符串吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:53:17.473

使用 JNI 可能是可能的，但我认为纯 Java 不可能。

鉴于您在同一个 JVM 中（这是您使其工作的唯一机会，除非您使用内存映射文件）您真的必须使用套接字吗？你不能创建一个更“直接”的 API 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T19:56:58.883

有两种方法可以做到这一点。

1.  将引用放入一个全局位置，以后可以检索。通过套接字发送一个对象，该对象在反序列化时被解析为全局访问引用。（仅适用于同一个 JVM）
2.  使大对象可通过 RMI 访问。发送一个对象，该对象在反序列化时会为您的大对象创建一个 RMI 代理。

使用更高效、更简单的直接 API。我建议考虑使用 BlockingQueue。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T20:11:31.907

如果您在同一程序的 2 个线程之间传递数据，您可以简单地通过 java.concurrent 包中的任何通道传递对该区域的引用。

如果您正在运行 2 个单独的程序，那么您必须序列化数据（如果您真的希望传递数据本身）。

如果您只想访问数据，您可以发布通过 RMI 执行所需转换的服务。

# java - 如何使用 iText 复制 AcroForm？

> ID：783248
> 
> 赞同：4
> 
> 时间：2009-04-23T19:45:56.727
> 
> 标签：java, pdf, pdf-generation, itext

我有一个带有 acroform 的 pdf。我正在使用 iText 打开这个 pdf 并用一些数据填充表单字段。有时我需要生成比原始 pdf 更多的页面。为此，我创建一个页面并使用以下代码替换为现有页面：

```
 OutputStream output = new FileOutputStream("C:\\newFile.pdf");
    PdfStamper stamper = PdfHelper.openPdfStamper("C:\\template.pdf", output);
    stamper.insertPage(NEW_PAGE_NUMBER,  new Rectangle(0,0));
    stamper.replacePage(stamper.getReader(), EXISTING_PAGE_NUMBER, NEW_PAGE_NUMBER); 
```

这样做，现有页面中的字段不会复制到新页面。

这是添加新页面的好方法吗？（新页面必须与现有页面相同）

如何将表单域复制到新页面中？如何更改新的表单字段名称，以免出现重复的字段？

**编辑：**我要复制的页面有一个表格。但是这个表只有十行。如果用户输入了十个以上的项目，我想填满整个表格并创建一个新页面来填充其他项目。

现在我正在制作该页面的多个副本以避免这种溢出。但我不认为这是一个优雅的解决方案，它不适用于非常大的输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-25T00:08:35.793

我为此使用了 PdfCopyFields。首先，我打开一个新的 PdfCopyFields 实例并调用 SetFullCompression()。然后我将我的模板加载到一个字节缓冲区中，对于每个“模板”页面，我使用 PdfStamper，设置表单字段，并将其输出添加到阅读器中，并将阅读器添加到 PdfCopyFields。就是这样。在我的测试中，它可以很好地扩展到多个页面，最终的 pdf 大小也不错。

# c++ - 如何在 COM 服务器中使用用户定义类型 (UDT)？

> ID：783260
> 
> 赞同：1
> 
> 时间：2009-04-23T19:47:22.277
> 
> 标签：c++, com, enums

我有一个 COM 服务器，其方法当前返回一个整数：

```
[
    object,
    uuid("..."),
    dual,
    helpstring("IMyCOMServer Interface"),
    pointer_default(unique)
]
__interface IMyCOMServer : IDispatch
{
    [id(1), helpstring("method MyQuery")]
    HRESULT MyQuery([in] BSTR instr, [out,retval] int* outint);
}; 
```

这编译得很好，但我宁愿返回一个枚举：（*这段代码实际上在接口定义之上）*

```
typedef
[
    uuid("..."),
    v1_enum,
    helpstring("Enum")
]
enum {
    value_a,
    value_b,
    value_c
} MyEnum; 
```

哪个再次编译它自己的权利，但只要我在接口和实现中更改为`int*`，`MyEnum*`我就会得到链接器错误：

```
[id(1), helpstring("method MyQuery")]
HRESULT MyQuery([in] BSTR instr, [out,retval] MyEnum* outint);

error MIDL2025 : syntax error : expecting a type specification near "MyEnum" 
```

无论我怎么做，我都无法编译它。

* * *

多亏了[Euro Micelli](https://stackoverflow.com/users/2230/euro-micelli)，事实证明真正的问题是我的用户定义类型（枚举）没有进入生成的 .IDL 文件。从网上的论坛查询来看，这似乎是一个普遍的问题。

一篇博文[Star Tech：UDT（用户定义类型）和 COM](http://startech-journey.blogspot.com/2007/06/udt-user-defined-types-and-com.html)引导我走上了正确的道路。使用属性 ATL 时似乎需要一种解决方法。

总而言之，我做了以下更改：

创建`udt.idl`：

```
import "oaidl.idl";
import "ocidl.idl";

[
    uuid("..."),
    v1_enum,
    helpstring("Enum")
]
typedef enum MyEnum {
    value_a,
    value_b,
    value_c
} MyEnum_t;

[
    version(1.0),
    uuid(...),
    helpstring(...)
]
library MyLibrary
{
    enum MyEnum;
} 
```

在主`.cpp`文件中的模块属性之前添加了以下行，以便将上述 IDL 导入到生成的文件中：

```
[importidl("udt.idl")]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T02:06:08.683

这是非常依赖于编译器的，因为枚举没有固定的存储大小。

还有兼容性角度 - 你将如何在 Visual Basic 或 C# 中表示该枚举？底层存储类似于整数，因此 COM 允许这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T04:59:02.917

您几乎已经掌握了，但 idl 编译器的语法比 cl.exe 更严格一些。您需要像这样在枚举之前具有初始枚举名称。

```
typedef
[uuid("..."), v1_enum, helpstring("Enum")]
enum tagMyEnum
{
    value_a,
    value_b,
    value_c
} MyEnum; 
```

如果您构建并注册您的 tlb，那么脚本语言应该能够在脚本和 .NET 中访问您的枚举。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T22:42:52.720

（这是根据实际的 IDL 改编的，所以我知道它有效）

```
[uuid(XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX), v1_enum, helpstring("Enum")]
enum MyEnum {
    value_a,
    value_b,
    value_c
} ; 
```

另外，在您的库部分中，您还必须包含枚举，否则枚举不会导出到类型库：

```
library MyLib
{
    enum MyEnum;
...
}; 
```

# java - 如何使 Java 语法正确？

> ID：783261
> 
> 赞同：3
> 
> 时间：2009-04-23T19:47:28.767
> 
> 标签：java, syntax

编译程序后收到一堆警告声明，我知道我可以关闭它们，但我想让它们正确，但我不知道修复它们的正确方法，对于其中一些它也抱怨方式，像这样：

```
BS=(TreeSet)B.next()
BS=(TreeSet<Object>)B.next() 
```

请问有什么帮助吗？这里是其中的一些 ：

```
170: warning: [unchecked] unchecked call to getMethod(java.lang.String,java.lang.Class<?>...) as a member of the raw type java.lang.Class
        Method createMethod=factory.getMethod("create"+currentValue, parameters);
---------------------------------------------------------------------------------------------------------------------------------
168        Class factory=Class.forName("net.sourceforge.barbecue.BarcodeFactory");
169        Class [] parameters={ "".getClass() };
170        Method createMethod=factory.getMethod("create"+currentValue, parameters);
=======================================================================================================
76: warning: [unchecked] unchecked conversion
found   : java.util.Vector[]
required: java.util.Vector<Stock_Region_Element>[]
  static Vector<Stock_Region_Element> Region[]=new Vector[Nm_Lib.Region_Num];
---------------------------------------------------------------------------------------------------------------------------------
76        static Vector<Stock_Region_Element> Region[]=new Vector[Nm_Lib.Region_Num];
=======================================================================================================
1365: warning: [unchecked] unchecked cast
found   : java.lang.Object
required: java.util.Vector<Contact_Info_Entry>
        Loaded_Contact_Info_Entry_Vector=(Vector<Contact_Info_Entry>)XML_Decoder.readObject();
---------------------------------------------------------------------------------------------------------------------------------
1358    Vector<Contact_Info_Entry> Loaded_Contact_Info_Entry_Vector=new Vector<Contact_Info_Entry>();
1359    
1360    if (new File(A_Path).exists())
1361      try
1362      {
1363//        Out("A_Path="+A_Path);
1364        XML_Decoder=new XMLDecoder(new BufferedInputStream(new FileInputStream(A_Path)));
1365        Loaded_Contact_Info_Entry_Vector=(Vector<Contact_Info_Entry>)XML_Decoder.readObject();
=======================================================================================================
1902: warning: [unchecked] unchecked cast
found   : java.lang.Object
required: java.util.Vector<java.awt.font.TextLayout>
      if (textToUse == FILE_TEXT) backupLineBreakTLs=(Vector<TextLayout>) lineBreakTLs.clone();
---------------------------------------------------------------------------------------------------------------------------------
1692    private Vector<TextLayout> lineBreakTLs=null;
1693    for (int i=0; i < fileText.length; i++)
1694    {
1695      AttributedString as=new AttributedString(fileText[i],g2.getFont().getAttributes());
1696      LineBreakMeasurer lbm=new LineBreakMeasurer(as.getIterator(),g2.getFontRenderContext());
1697      while (lbm.getPosition() < fileText[i].length()) lineBreakTLs.add(lbm.nextLayout((float) w));
1698    }
......
1901    Vector<TextLayout> backupLineBreakTLs=null;
1902    if (textToUse == FILE_TEXT) backupLineBreakTLs=(Vector<TextLayout>) lineBreakTLs.clone();
=======================================================================================================
143: warning: [unchecked] unchecked conversion
found   : java.util.TreeSet
required: java.util.TreeSet<java.lang.Object>
          BS=(TreeSet)B.next();
---------------------------------------------------------------------------------------------------------------------------------
139          TreeSet<Object> Sub_Set=new TreeSet<Object>(TreeSet_Order);
140          Sub_Set.add(First);
141          if (Debug) System.out.println("=7.20= Sub_Set="+Sub_Set);
142          TreeSet<Object> BS=new TreeSet<Object>(TreeSet_Order);
143          BS=(TreeSet)B.next();
=======================================================================================================
813: warning: [unchecked] unchecked cast
found   : java.lang.Object
required: java.util.Vector<java.lang.Object>
    Vector<Object> dataRow=(Vector<Object>)rows.elementAt(row);
---------------------------------------------------------------------------------------------------------------------------------
813    Vector<Object> dataRow=(Vector<Object>)rows.elementAt(row);
=======================================================================================================
199: warning: [unchecked] unchecked cast
found   : java.lang.Object
required: java.util.Vector<java.lang.String>
        comboModel=(Vector<String>)(ois.readObject());
---------------------------------------------------------------------------------------------------------------------------------
19  private static Vector<String> comboModel;
......
199        comboModel=(Vector<String>)(ois.readObject());
=======================================================================================================
71: warning: [unchecked] unchecked conversion
found   : LoadLibraryAction
required: java.security.PrivilegedAction<T>
  static { java.security.AccessController.doPrivileged(new LoadLibraryAction("jpeg")); }
71: warning: [unchecked] unchecked method invocation: <T>doPrivileged(java.security.PrivilegedAction<T>) in java.security.AccessController is applied to (LoadLibraryAction)
  static { java.security.AccessController.doPrivileged(new LoadLibraryAction("jpeg")); }
---------------------------------------------------------------------------------------------------------------------------------
70  // load the jpeg lib when created.
71  static { java.security.AccessController.doPrivileged(new LoadLibraryAction("jpeg")); }
=======================================================================================================
184: warning: [unchecked] unchecked cast
found   : java.lang.Object
required: java.util.Vector<java.lang.Object>
      trans_frame.Events_Vector=(Vector<Object>)s.readObject();   
---------------------------------------------------------------------------------------------------------------------------------
183      ObjectInputStream s=new ObjectInputStream(in);
184      trans_frame.Events_Vector=(Vector<Object>)s.readObject();    
=======================================================================================================
3473: warning: [unchecked] unchecked call to getConstructor(java.lang.Class<?>...) as a member of the raw type java.lang.Class
      java.lang.reflect.Constructor constructor=cl.getConstructor(new Class[] {String.class});     // get the constructor with one parameter
---------------------------------------------------------------------------------------------------------------------------------
3473      java.lang.reflect.Constructor constructor=cl.getConstructor(new Class[] {String.class});     // get the constructor with one parameter
=======================================================================================================
3476: warning: [unchecked] unchecked call to getMethod(java.lang.String,java.lang.Class<?>...) as a member of the raw type java.lang.Class
      java.lang.reflect.Method objMethod=cl.getMethod(Method_Name,arguments);                      // get the method
---------------------------------------------------------------------------------------------------------------------------------
3475      Class  arguments[]=new Class[] { };                                                          // the method has no argument
3476      java.lang.reflect.Method objMethod=cl.getMethod(Method_Name,arguments);                      // get the method
=======================================================================================================
486: warning: [unchecked] unchecked call to getConstructor(java.lang.Class<?>...) as a member of the raw type java.lang.Class
              Constructor ctor=cls.getConstructor(new Class[]{String.class});
---------------------------------------------------------------------------------------------------------------------------------
485              Class cls=Class.forName(loader);
486              Constructor ctor=cls.getConstructor(new Class[]{String.class});
=======================================================================================================
476: warning: [unchecked] unchecked method invocation: <T>doPrivileged(java.security.PrivilegedAction<T>) in java.security.AccessController is applied to (<anonymous java.security.PrivilegedAction>)
    JarClassLoader bootLoader=(JarClassLoader)AccessController.doPrivileged(
---------------------------------------------------------------------------------------------------------------------------------
476    JarClassLoader bootLoader=(JarClassLoader)AccessController.doPrivileged(
=======================================================================================================
224: warning: [unchecked] unchecked method invocation: <T>sort(java.util.List<T>) in java.util.Collections is applied to (java.util.List<Sorted_List_Model.SortedListEntry>)
      Collections.sort(sortedModel);
---------------------------------------------------------------------------------------------------------------------------------
24  private List<SortedListEntry> sortedModel;
105    sortedModel=new ArrayList<SortedListEntry>(size);
224      Collections.sort(sortedModel);
=======================================================================================================
325: warning: [unchecked] unchecked conversion
found   : java.util.List
required: java.util.List<? extends java.lang.Comparable<? super Sorted_List_Model.SortedListEntry>>
      insertionPoint=Collections.binarySearch((List)sortedModel,entry);
---------------------------------------------------------------------------------------------------------------------------------
320  private int findInsertionPoint(SortedListEntry entry)
321  {
322    int insertionPoint=sortedModel.size();
323    if (sortOrder != SortOrder.UNORDERED)
324    {
325      insertionPoint=Collections.binarySearch((List)sortedModel,entry);
=======================================================================================================
361: warning: [unchecked] unchecked call to compare(T,T) as a member of the raw type java.util.Comparator
      int comparison=comparator.compare(thisElement, thatElement);
---------------------------------------------------------------------------------------------------------------------------------
348    public int compareTo(Object o)
349    {
350      // retrieve the element that this entry points to in the original model
351      Object thisElement=unsortedModel.getElementAt(index);
352      SortedListEntry thatEntry=(SortedListEntry)o;
353      // retrieve the element that thatEntry points to in the original model
354      Object thatElement=unsortedModel.getElementAt(thatEntry.getIndex());
355      if (comparator instanceof Collator)
356      {
357        thisElement=thisElement.toString();
358        thatElement=thatElement.toString();
359      }
360      // compare the base model's elements using the provided comparator
361      int comparison=comparator.compare(thisElement, thatElement);
=======================================================================================================
3201: warning: [unchecked] unchecked method invocation: <T>sort(T[],java.util.Comparator<? super T>) in java.util.Arrays is applied to (java.io.File[],<anonymous java.util.Comparator>)
    Arrays.sort(files,new Comparator() { public int compare(final Object o1,final Object o2) { return By_Ascending_Date?new Long(((File)o1).lastModified()).compareTo(new Long(((File) o2).lastModified())):new Long(((File)o2).lastModified()).compareTo(new Long(((File) o1).lastModified())); } });
---------------------------------------------------------------------------------------------------------------------------------
3197  public static File[] Get_File_List_From_Dir_By_Date(String Dir,final boolean By_Ascending_Date)
3198  {
3199    if (!new File(Dir).isDirectory()) return null;
3200    File files[]=new File(Dir).listFiles();
3201    Arrays.sort(files,new Comparator() { public int compare(final Object o1,final Object o2) { return By_Ascending_Date?new Long(((File)o1).lastModified()).compareTo(new Long(((File) o2).lastModified())):new Long(((File)o2).lastModified()).compareTo(new Long(((File) o1).lastModified())); } }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T19:51:43.747

你应该阅读泛型。[Angelika Langer 的网站](http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html)是一个极好的资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T19:55:22.600

我认为一定程度的这种情况是不可避免的。我喜欢将未经检查的强制转换警告本地化到例程中唯一的行，然后使用 @SuppressWarnings("unchecked") 抑制该答案。这样，警告抑制不会在我的方法的其他地方隐藏任何无意的此类事件。这在泛型中很常见，尤其是混合原始集合（例如 List）和类型化集合（例如 List）。如果您正在使用使用原始集合的库，则很难完全避免这些警告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-25T12:05:18.887

泛型绝对是更可取的解决方案，例如：

```
Class<? extends SomeClass> cl = inst.getClass(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T20:11:20.080

Java 的验证系统非常类似于 lint，它甚至可能偶尔会警告您如果不认真重新实现某个部分就无法修复的问题。

但是，如果您真的感兴趣，您应该搜索“Java 静态代码分析”，那里有一些很棒的工具可以检查您的代码，并可以为您提供更深入的问题分析。

我相信您使用静态分析工具会比尝试清除 java 警告取得更大的进步。

# python - 等待时向浏览器发送数据（Python）

> ID：783262
> 
> 赞同：3
> 
> 时间：2009-04-23T19:47:43.257
> 
> 标签：python

我有以下代码

```
print "Starting stage 1<br>"

# Something that takes about 5 seconds
time.sleep(5)

print "Stage 1 complete" 
```

我用我的浏览器查看脚本，因为它是网络应用程序的一部分，问题是它一起显示所有这些。我希望它在开始之前首先显示开始消息，然后在完成后添加完成消息。

我用什么来以这种方式将信息推送到浏览器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T19:49:38.510

尝试在第一次打印后使用 sys.stdout 刷新输出。[冲洗（）](http://docs.python.org/library/stdtypes.html#file.flush)

# iphone - 更新我的证书后出现代码签名错误

> ID：783263
> 
> 赞同：1
> 
> 时间：2009-04-23T19:47:44.333
> 
> 标签：iphone, code-signing, renewal

我的证书刚刚过期。我在 Team 部分更新了它，然后更新了配置文件，并将它们重新安装到我的钥匙串和 xcode 上，然后我收到了这个错误：

代码签名错误：身份“iPhone 开发人员”与登录钥匙串中的任何有效证书/私钥对都不匹配

我该怎么办 ？

非常感谢

蒂埃里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T21:42:22.500

我发现了问题。我已经删除了我的私钥。

我不得不使用创建新私钥的钥匙串请求“CertificateSigningRequest.certSigningRequest”证书。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-29T19:56:10.227

如果您在创建证书后更改计算机密码，则必须重新执行该过程并创建新证书。我花了 4 个小时才弄清楚这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T16:01:26.927

我只是想补充一点，当您的证书过期或以某种方式从您的钥匙串中删除时，您会收到此错误。要修复它，请登录 iPhone 开发者计划门户并更新证书 - 那里的说明非常全面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-04T15:06:01.390

删除你的私钥是不够的。

您还必须从 Mac 中删除您的配置文件，否则新的配置文件将（默默地！）无法安装，即使它显然比现有的要新。

（使用 iPhone 配置实用程序最简单的擦除密钥，您可以从 Apple.com 下载。擦除配置文件也是使用该应用程序最简单的方法。每个人都应该获得 iPCU！（它是免费的））

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-03T10:26:16.930

我知道问题已得到解答，但如果有人对此有疑问并且不确定在哪里查找信息 - 我发现以下内容很有用：

您还可以在开发和分发选项卡上的配置部分检查您的配置证书的状态。

这很有用，如果证书已更改或生成存在问题，则现有应用程序供应配置文件状态将被标记为无效。在这种情况下，无论如何你都必须修改它们，但我发现它很有用。

此外，在 XCode 中，iPhone Development->Provisioning Profiles 下的 Organizer 窗口是查看任何问题的快捷方式，尤其是过期日期。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-02T19:08:51.403

如果未安装 WWDR 中间证书，也会发生这种情况。

# svn - 乌龟 svn 总是合并 45 个额外的文件

> ID：783275
> 
> 赞同：16
> 
> 时间：2009-04-23T19:51:53.107
> 
> 标签：svn, tortoisesvn

当我们使用 svn 进行分支和合并时，总是会发生同样的事情。

我们得到了主干的最新副本。

创建分支并切换。

对分支中的一个文件进行一些小的更改。

将分支合并回主干。

此时，我们将拥有一个需要提交的文件，以及相同的 45 个额外文件。这发生在每个分支和合并上，并且总是相同的 45 个额外文件。我不知道如何解决这个问题，但它非常烦人。

有没有人见过这个？

更新：当我提交时，我实际更改的文件的文本状态为已修改，其属性状态为空白。“45个文件”都是Text Status normal，Property Status modified。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-23T19:55:00.323

它们可能是*mergeinfo*属性。*在 SVN 的 1.5 版中，设置mergeinfo*属性非常激进，当您合并时，这些属性会更新 - 需要对它们进行提交。

答案是从它们中删除*mergeinfo*属性。还升级到具有更好的*合并信息*支持的 1.6 版（即，它写入的这些属性更少）。

我应该说，如果您查看差异，这些文件将没有明显的变化。显然，如果它们的内容发生了变化，那么这些变化可能会给你一个线索（例如，一个自动工具编写额外的注释、修改布局或在顶部或底部添加行）。

* * *

**编辑**：有关SVN 合并问题和修复的更多信息，请参阅[此博客文章。](http://blogs.open.collab.net/svn/2008/07/subversion-merg.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T21:38:52.303

很可能是提到的 mergeinfo 属性。您可能需要清理主干中文件和文件夹的 mergeinfo 属性。批处理文件对此很方便，因为您将来可能需要再次执行此操作。类似于以下内容：

```
echo Removing Nested Merge Information...

svn propdel svn:mergeinfo subfolder1 --depth=infinity

svn propdel svn:mergeinfo subfolder2 --depth=infinity

svn propget svn:mergeinfo --depth=infinity trunk 
```

在主干的工作副本上运行批处理文件后，然后提交回主干。

此外，重命名和移动文件夹是在 subversion repo 中的文件夹/文件上生成 mergeinfo 属性的常用方法。svn1.6 没有为各种操作添加 mergeinfo 属性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-04-12T16:50:11.900

阅读[http://www.collab.net/community/subversion/articles/merge-info.html上的详细文章](http://www.collab.net/community/subversion/articles/merge-info.html)

它很长，但很值得。请特别注意最后“Parting Thoughts”部分中的建议，其中包括减少合并信息噪音的提示。

此外，不要使用 svn propdel 来清理不需要的 mergeinfo，而是考虑使用 svn merge 和 --record-only 选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-15T00:00:01.383

就个人而言，我认为 mergeinfo 导致的问题多于它解决的问题，至少在工具的当前状态下是这样。一旦它在提交上是**透明**的，也许它会值得使用。

您可以安全地删除 mergeinfo 属性。但是，请注意，您将需要手动跟踪要合并哪些修订以进行重新集成。

# sql - 编写 SQL 查询时遇到问题

> ID：783283
> 
> 赞同：0
> 
> 时间：2009-04-23T19:54:50.340
> 
> 标签：sql, oracle

我在编写查询时遇到问题。我有一个名为“MYTABLE”的支持表，它有一个名为“TABLENAME”的列，其中可以有一个或多个表名。多个表用逗号分隔。

例子：

```
TBLUSER
TBLUSER, TBLACCOUNT 
```

我正在尝试编写一个查询，该查询将识别 MYTABLE 表中不是数据库中有效表的任何条目。我能够写出以下内容......

```
 SELECT *
                       FROM MYTABLE T1
            LEFT outer JOIN ALL_TAB_COLS T2
                         ON (    upper(T1.TABLENAME) = upper(t2.Table_Name) 
                             AND T2.Owner = 'ME'
                             )
                       WHERE TABLE_NAME IS NULL; 
```

它完全按照我想要的方式工作 - 但它仅在 MYTABLE 中的条目包含单个表时才有效。当有多个用逗号分隔的表时 - 它会失败。我的 SQL 技能有些欠缺，我的本能是“为每个人做一个”，但我觉得这不是正确的方法（而且我不知道如何在 SQL 中做到这一点）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T20:06:18.097

你真的需要在那里重新考虑你的数据库设计。在应该跟踪这些条目的表中的单个记录上保留多个条目是一个巨大的 WTF。

您需要更改您的设计，以便代替您描述的内容，例如：

```
ID    TABLENAME
----------------------
1     TBLUSER
2     TBLUSER
2     TBLACCOUNT 
```

其中 ID + Tablename 是复合主键。这将使您编写的查询工作（尽管根据我上面提供的基本示例无法工作）。

**注意**我知道这可能不是您在确切问题中寻找的内容，但我觉得无论如何都说出来很重要，因为未来的用户可能会发现这个问题并且需要更好地了解数据库规范化实践（您可能不会能够做到，因为应用程序是这样的，因为“这就是它的样子”）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T20:07:57.030

您将字符串存储在 MYTABLE.TABLENAME 中，并尝试将其与 ALL_TAB_COLS.TABLE_NAME 中的字符串匹配（顺便说一句，我看不出有任何理由在这种情况下使用 ALL_TAB_COLS 而不是 ALL_TABLES ）。

如果您的字符串是“TBLUSER, TBLACCOUNT”，它不会等于字符串“TBLUSER”或字符串“TBLACCOUNT”。这就是表达式`upper(T1.TABLENAME) = upper(t2.Table_Name)`正在测试的全部内容——这两个字符串是否相等？您似乎期望它以某种方式“知道”您的数据恰好是逗号分隔的表名列表。

使用字符串比较使您拥有的工作的蛮力方法是将条件更改为`','||upper(T1.TABLENAME)||',' LIKE '%,'||upper(t2.Table_Name)||',%`. 因此，您基本上会查看 TABLE_NAME 是否是您的 TABLENAME 列值的子字符串。

然而，真正的一点是，这不是一个很好的数据库设计。首先，从一个简单的角度来看，为什么要命名一个列“TABLENAME”（单数），然后将代表多个表名的值放入其中？如果您要这样做，您至少应该将其称为“TABLENAMELIST”之类的名称。

更重要的是，这通常不是我们在关系数据库中做事的方式。如果您的 MYTABLE 如下所示：

```
ID       TABLENAME
1        TBLUSER
2        TBLUSER, TBLACCOUNT 
```

那么设计表格的更合适的关系方式是：

```
ID       TBL_NUM    TABLENAME
1        1          TBLUSER
2        1          TBLUSER
2        2          TBLACCOUNT 
```

然后您的查询将或多或少按原样工作，因为 TABLENAME 列将始终包含单个表的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T20:12:18.190

简短的回答是：

```
select distinct
  atc.table_name
from
  mytable mt
 ,all_tab_cols atc
where atc.owner = 'SOMESCHEMA'
  and (
       mt.tablename = atc.table_name
       or
       (
        0 < instr(','||replace(upper(mt.tablename),' ','')||','
                          ,','||upper(atc.table_name)||',')
       )
      ) 
```

大卫科斯塔的帖子已经很好地描述了长长的答案。

# c# - 在 C# 中执行 SQL 语句？

> ID：783294
> 
> 赞同：1
> 
> 时间：2009-04-23T19:58:16.523
> 
> 标签：c#, sql, execute

嘿伙计们，我想执行我的 SQL 语句，但我遇到了语法问题，有人可以帮我理解我做错了什么吗？

谢谢，阿什。

```
public void AddToDatabase(string[] WordArray, int Good, int Bad, int Remove)
{

    for (int WordCount = 0; WordCount < WordArray.Length; WordCount++)
    {
        string sSQL = "INSERT INTO WordDef (Word, Good, Bad, Remove) VALUES (" + WordArray[WordCount] + ", " + Good + ", " + Bad + ", " + Remove + ")";

        Debug.Print(sSQL);

        //Private m_recordset As ADODB.Recordset
        //Private m_connection As ADODB.Connection
        ADODB.Recordset RS;
        ADODB.Connection CN ;

        CN = new ADODB.Connection();
        RS = new ADODB.Recordset();

        CN.CursorLocation = ADODB.CursorLocationEnum.adUseClient;

        CN.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=doom_calc_dict.mdb;jet OLEDB:database";
        CN.Open(CN.ConnectionString,"","",0);

        object dummy = Type.Missing;

        CN.Execute(sSQL,out dummy,0);

        RS.Close(); 
        CN.Close(); 

        //string sSQL = "SELECT Word FROM WordDef WHERE Word='" + WordArray[WordCount] + "'";
        DatabaseTools.LoadDataFromDatabase(sSQL);
        //DatabaseTools.LoadDataFromDatabase(sSQL);

    }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-23T20:09:36.420

您需要修复的最重要的事情是使用查询参数而不是动态构建字符串。这将提高性能、维护和安全性。

此外，您希望使用较新的强类型 ADO.Net 对象。确保添加 using 指令`System.Data.OleDb`。

请注意`using`此代码中的语句。当您完成连接时，他们将*确保*您的连接已关闭。这很重要，因为数据库连接是一种有限且不受管理的资源。

最后，您并没有真正在代码中使用数组。您真正关心的是迭代单词集合的能力，因此您希望接受一个`IEnumerable<string>`而不是数组。不用担心：如果您需要传递它，此函数将接受一个数组作为参数。

```
public void AddToDatabase(IEnumerable<string> Words, int Good, int Bad, int Remove)
{
    string sql = "INSERT INTO WordDef (Word, Good, Bad, Remove) VALUES (@Word, @Good, @Bad, @Remove)";

    using (OleDbConnection cn = new OleDbConnection("connection string here") )
    using (OleDbCommand cmd = new OleDbCommand(sql, cn))
    {
        cmd.Parameters.Add("@Word", OleDbType.VarChar);
        cmd.Parameters.Add("@Good", OleDbType.Integer).Value = Good;
        cmd.Parameters.Add("@Bad", OleDbType.Integer).Value = Bad;
        cmd.Parameters.Add("@Remove", OleDbType.Integer.Value = Remove;

        cn.Open();

        foreach (string word in Words)
        {
            cmd.Parameters[0].Value = word;
            cmd.ExecuteNonQuery();
        }
    }
} 
```

还有一件事：在 OleDb 中使用查询参数时，确保按顺序添加它们很重要。

**更新：**固定在 VS 2005 / .Net 2.0 上工作（依赖于 VS 2008 功能）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T20:06:13.370

一开始我会觉得我没有帮助。但事实上，我正在努力帮助你，所以请这样吧。你需要阅读[这个](https://blog.codinghorror.com/give-me-parameterized-sql-or-give-me-death/)和[这个](http://msdn.microsoft.com/en-us/magazine/cc163799.aspx)STAT！完成后，这里有一些好的、干净的[ADO.NET 示例](http://msdn.microsoft.com/en-us/library/dw70f090(VS.71).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:02:22.863

试试这个（你应该尝试从应用程序外部运行 SQL）：

```
string sSQL = "INSERT INTO WordDef (Word, Good, Bad, Remove) VALUES ('" + WordArray[WordCount] + "', " + Good + ", " + Bad + ", " + Remove + ");"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T20:03:45.403

您需要在 SQL 语句中的第一个参数周围添加单引号。

```
string sSQL = "INSERT INTO WordDef (Word, Good, Bad, Remove) VALUES ('" + WordArray[WordCount] + "', " + Good + ", " + Bad + ", " + Remove + ")"; 
```

字符和日期字段要求值用“单引号”括起来

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-26T10:21:54.920

不，你需要这样：

```
string query = "INSERT INTO Table_PersonInfo
(PersonID,Surname
,[Family Name]
,AddsOnName
,Street,Number
,PostalCode
,[City of Birth]
,[Year of Birth]
,[Phone Number])
 VALUES
 ('"+@personID+"'
, '"+ @surname + "' 
, '"+@familyname+"'
, '"+@nameExtension+"'
, '"+@street+"'
, '"+@houseNumber+"'
, '"+ @postalCode+"'
, '"+@yearofbirth+"'
, '"+@placeofbirth+"'
, '"+@phoneNumber+"')"; 
```

# xml - 基于到期日期属性的 XPath 选择

> ID：783304
> 
> 赞同：1
> 
> 时间：2009-04-23T20:02:42.723
> 
> 标签：xml, xpath

鉴于此 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<content dataType="XML">
  <item type="Promotion" name="Sample Promotion" expires="04/01/2009">
    <![CDATA[
      <p>Details here.</p>
    ]]>
  </item>
  <item type="Promotion" name="Sample Promotion 2" expires="05/01/2009">
    <![CDATA[
      <p>Details here.</p>
    ]]>
  </item>
</content> 
```

选择尚未过期的项目的 XPath 是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T21:48:21.597

**过期`<item>`元素可以通过单个 XPath 表达式来选择**，前提是提供了当前日期——可以是变量，也可以是文字字符串。

**下面的解决方案使用 XSLT 1.0 作为 XPath 1.0 的宿主语言**。

**为方便起见，当前日期被指定**为全局`<xsl:param>`参数，名为`pToday`.

**另一个方便之处是当前年、月和日的值**在变量`$vthisYear`、`$vthisMonth`和中定义`$vthisDay`。如有必要，所有这些变量引用都可以在 XPath 表达式中用其定义的右侧替换。

所需的单个 XPath 表达式包含在以下 XSLT 转换中：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"
  cdata-section-elements="item"/>

 <xsl:param name="pToday" select="'04/23/2009'"/>

 <xsl:variable name="vthisDay" select=
  "substring($pToday,4,2)"/>

 <xsl:variable name="vthisMonth" select=
  "substring($pToday,1,2)"/>

 <xsl:variable name="vthisYear" select=
  "substring($pToday,7)"/>

    <xsl:template match="/">
     <nonExpired>
          <xsl:copy-of select=
          "/*/item
                [$vthisYear &lt; substring(@expires,7)
               or
                  ($vthisYear = substring(@expires,7)
                 and
                   $vthisMonth &lt; substring(@expires,1,2)
                   )
             or
                  ($vthisYear = substring(@expires,7)
                 and
                   $vthisMonth = substring(@expires,1,2)
                 and
                   $vthisDay &lt;= substring(@expires,4,2)
                   )
                ]

          "/>
      </nonExpired>
    </xsl:template>
</xsl:stylesheet> 
```

**当对提供的 XML 文档应用上述转换时**：

```
<content dataType="XML">
    <item type="Promotion" name="Sample Promotion" expires="04/01/2009"><![CDATA[      <p>Details here.</p>    ]]></item>
    <item type="Promotion" name="Sample Promotion 2" expires="05/01/2009"><![CDATA[      <p>Details here.</p>    ]]></item>
</content> 
```

**产生了想要的结果**：

```
<nonExpired>
   <item type="Promotion" name="Sample Promotion 2" expires="05/01/2009"><![CDATA[      <p>Details here.</p>    ]]></item>
</nonExpired> 
```

**注意**：*oneporter*的解决方案也可以工作，只要纠正其中的一些小错误。此外，它需要返工，因为它不切实际地期望当前日期将以不同于`@expires`属性中日期的格式提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T21:23:32.777

我是 xslt 的新手，但如果您使用的是 1.0 或 1.1，我会从某个地方获取当前日期，然后比较两个字符串。本页[描述](http://www.dpawson.co.uk/xsl/sect2/dates.html#d3834e229)了用于提取日期的 dos 和 *nix 方法。然后我可能会重新组织这些值，以便它们具有可比性（我假设 $current_date 是格式为 YYYYMMDD 的字符串）

```
<xsl:if test="number(concat(substring(.[@expires],5,4),
   substring(.[@expires],3,2),substring(.[@expires],1,2))&lt;number(
   $current_date">
...
</xsl> 
```

但就像我说的，我刚开始使用 xsl。所以，对于一个简单的问题，这可能是一个非常笨拙的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:08:59.900

XPath 不理解日期格式，因此您需要使用扩展函数来使这项工作干净利落。

或者，您可以使用子字符串来提取属性的各个部分。但是，如果属性的格式不准确，您会遇到问题，并且表达式将是巨大的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T20:16:53.063

XPath 2.0 支持一些日期函数：

[http://www.w3.org/TR/xpath-functions/#durations-dates-times](http://www.w3.org/TR/xpath-functions/#durations-dates-times)

[http://www.w3.org/TR/xpath-functions/#func-date-less-than](http://www.w3.org/TR/xpath-functions/#func-date-less-than)

# c++ - 是否有任何工具可以检测 Visual C++ 6.0 上的缓冲区溢出？

> ID：783310
> 
> 赞同：2
> 
> 时间：2009-04-23T20:03:19.647
> 
> 标签：c++, visual-c++

由于堆问题，我一直遇到崩溃问题，所以我猜某处发生了缓冲区溢出。我如何检测它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T20:05:11.873

我使用[Compuware BoundsChecker](http://www.compuware.com/products/devpartner/visualc.htm)作为 VC6 中的错误检测工具。它可以拾取缓冲区溢出。

你也可以试试[PageHeap](http://support.microsoft.com/kb/286470)，一个windows的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T20:09:50.210

为此，我使用[Rational Purify](http://www-01.ibm.com/software/awdtools/purify/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T20:10:04.203

您可以使用 VC 调试堆：http: [//msdn.microsoft.com/en-us/library/974tc9t1.aspx](http://msdn.microsoft.com/en-us/library/974tc9t1.aspx)

VC6 也支持 crtdbg.h 中的大部分内容（如果不是全部的话）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T21:22:04.980

当简单地在某些地方插入 _heapchk() Windows API 函数并寻找错误时，我得到了很好的结果（在我的例子中是对数组的索引 -1 的访问）。

# .net - 接口 + 扩展（mixin）与基类

> ID：783312
> 
> 赞同：30
> 
> 时间：2009-04-23T20:04:03.047
> 
> 标签：.net, interface, extension-methods, abstract-class

**接口+扩展方法（mixin）比抽象类更可取吗？**

如果您的答案是“取决于”，它取决于什么？

我看到接口+扩展方法有两个可能的优势。

*   接口是可多重继承的，而类则不是。
*   您可以使用扩展方法以非破坏方式扩展接口。（实现您的接口的客户端将获得您的新基本实现，但仍然能够覆盖它。）

我还没有想到这种方法的缺点。接口+扩展方法失败的原因可能非常简单。

关于这个主题的两篇有用的文章是

*   [使用接口和扩展方法创建 Mixin](http://msdn.microsoft.com/en-us/vcsharp/bb625996.aspx)
*   [抽象基类也有版本问题](http://haacked.com/archive/2008/02.aspx)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-23T20:09:17.323

扩展方法的缺点：C#3/VB9 之前的客户端将无法轻松使用它。

就我而言，就是这样——我认为基于接口的方法要好得多。然后，您可以很好地模拟出您的依赖关系，并且所有内容基本上都没有那么紧密耦合。我不是类继承的忠实拥护者，除非它真的是关于专业化的:)

编辑：我刚刚想到了另一个*可能*相关的好处。一些具体的实现可能会提供一些通用方法的更优化版本。

`Enumerable.Count`就是一个很好的例子——它显式地检查序列是否实现`IList`，因为如果它实现了，它可以调用`Count`列表而不是遍历整个序列。如果`IEnumerable<T>`它是一个带有虚拟`Count()`方法的抽象类，它可能会被覆盖，`List<T>`而不是有一个`IList`明确知道的实现。我并不是说这总是相关的，也不`IEnumerable<T>`应该是一个抽象类（绝对不是！）——只是指出它可能是一个小的缺点。这就是多态性真正适合的地方，通过专门化现有行为（诚然，以一种只影响性能而不是结果的方式）。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-23T22:24:35.410

恕我直言，这是错误的问题。

**您应该将一切用于其设计目的。**

*   扩展方法不是成员。它们在语法上看起来像成员，因此您可以更轻松地找到它们。
*   扩展方法只能使用公共（或内部）接口。许多其他类也可以这样做。所以扩展方法并不是真正的封装方式。
*   它们是静态方法，不能在单元测试中被覆盖和模拟。Is 是一种非 OO 语言功能，调用者静态绑定到它。

*   抽象基类确实经常被误用于“重用代码”（而不是真正的继承）。这通常适用于继承。

**问题应该是：“我什么时候应该使用接口、扩展方法或基类？”**

*   每当您需要合同时使用接口（这种情况一直都在发生）。
*   当你有真正继承的情况时使用（抽象的）基类（你可以写一本关于如何判断的书，所以我就这样离开它）。一个接口大多也是同时实现的。
*   对实际上不应该是类型成员的逻辑使用扩展方法，因为实现它不是类型的责任 - 但您希望使其易于查找，并且将其称为成员感觉很自然。

编辑：

**或者问题应该是：“我如何编写不属于基类的可重用功能？”**

*   编写一个公开功能的接口
*   编写实现功能的可重用库类
*   编写一个实现接口并通过聚合可重用类来重用功能的类。

一般来说，我会说，扩展方法是业务逻辑的错误位置，除了特殊情况或特殊设计决策。

基类仅在极少数情况下是正确的决定。毫无疑问，事实并非如此。毫无疑问，你应该再考虑一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T21:19:19.683

接口倾向于使代码更简洁我觉得它更容易测试。当您添加扩展时，您会增加更多的灵活性，同时保持干净的可测试代码。

对我来说，抽象类总是显得笨重，使用接口我可以拥有一个对象工厂，它返回一个特定于我想要完成的对象（关注点分离）。

只是编造一些东西 A 有一个名为 Math 的接口，它具有加、减、除和乘法，然后我有一个名为 IntMAth 的类，它实现了针对整数数学优化的 Math，我还有另一个名为 FloatMath 的类，它实现了优化的 Math对于浮动数学，我有一个通用数学，它实现了处理其他所有事情的数学。

当我需要添加一些浮点数时，我可以调用我的工厂 MathFactory.getMath(typeof(float)) 并且它有一些逻辑可以知道如果我传入的类型是浮点数，那么它会返回 FloatMath 类。

这样我所有的类都更小更易于维护，调用类的代码更小，等等。

# php - 使用 MSSQL 数据库时，有没有办法在 PHP 4 中进行参数化查询？

> ID：783315
> 
> 赞同：1
> 
> 时间：2009-04-23T20:05:53.697
> 
> 标签：php, sql-server, php4, parameterized

我正在运行 PHP 4 并通过 FreeTDS 与 MS SQL2000 数据库通信的旧系统上进行一些维护工作。我知道，听起来已经有些吓人了！

许多代码使用不安全的字符串连接来生成 SQL 查询。我做了一些工作来尝试过滤输入以使事情更安全，但这让我很头疼。

我想知道是否有什么东西可以让我在当前设置的情况下进行正确的参数化查询？此时我无法更改 PHP 或 MSSQL 的版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T20:15:00.650

使用提供它们的数据库抽象层（如[MDB2](http://pear.php.net/manual/en/package.database.mdb2.intro-execute.php) [）](http://pear.php.net/package/MDB2)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T22:14:52.327

如果您对参数化查询的主要兴趣是 SQL 注入安全性，我会寻找一个为您提供功能并用纯 PHP 编写的数据库抽象层。我使用了[ADOdb](http://adodb.sourceforge.net/)，这是一个不错的选择，而且看起来他们仍然有旧的 PHP4 版本可供下载。

对此唯一需要注意的是，抽象层可能无法对您的数据库进行“正确”的参数化查询。换句话说，他们可能已经实现了自己的参数化引擎，然后将完整的 SQL 字符串发送到数据库。这对于 MS SQL Server 很重要，因为“适当的”参数化查询可以带来显着的性能提升。

# sql-server-2005 - 如何导出存储过程的内容？

> ID：783320
> 
> 赞同：0
> 
> 时间：2009-04-23T20:06:33.807
> 
> 标签：sql-server-2005, stored-procedures, export

如何使用 SQL 语句导出存储过程的内容？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T20:09:21.193

如果**您通过“内容”谈论代码**，请查看 sp_helptext()

[http://msdn.microsoft.com/en-us/library/ms176112.aspx](http://msdn.microsoft.com/en-us/library/ms176112.aspx)

这是一个基于旧 PUBS 示例数据库的示例

```
USE pubs;
GO
EXEC sp_helptext 'pubs.dbo.byroyalty';
GO 
```

这是结果

```
Text                                                                                      --------
CREATE PROCEDURE byroyalty @percentage int
AS
select au_id from titleauthor
where titleauthor.royaltyper = @percentage 
```

但是，如果**“内容”是指结果**；您可以使用“结果到文件...”设置运行 proc，或“网格中的结果”并右键单击网格，然后执行“另存为...”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T20:10:50.363

[sp_helptext](http://msdn.microsoft.com/en-us/library/ms176112.aspx)系统存储过程可能会有所帮助。

```
sp_helptext YourProcedureName 
```

如果您正在寻找类似的东西，我还使用[print在存储过程中查看我生成的 sql：](http://msdn.microsoft.com/en-us/library/ms176047.aspx)

```
CREATE PROCEDURE YourProcedureName
AS
DECLARE @sql varchar(100)
SET @sql = 'SELECT * FROM MyTable'

print @sql
--EXEC @sql
GO 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T20:09:53.533

内容是指代码？

如果是这样，你可以打电话

```
EXEC sp_helptext proc_name 
```

请注意，您也可以使用视图名称来调用它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T20:21:40.337

您可以查询“sys.sql_modules”目录视图来查找存储过程和存储函数的 SQL 源代码：

```
SELECT definition
FROM sys.sql_modules
WHERE object_id = OBJECT_ID('your stored proc name here') 
```

马克

# java - 从 Java 开始学习 iPhone 编程的最佳方式是什么？

> ID：783321
> 
> 赞同：14
> 
> 时间：2009-04-23T20:06:36.440
> 
> 标签：java, iphone, objective-c, cocoa

我已经开始阅读关于这个主题的所有可用的苹果文档。快速概览给了我大约 8.000（八千）个 DIN A4 PDF 页面。大约 10% 的内容对我来说几乎是相等的。现在阅读了 2 周后，我发现我会很快忘记一周前阅读的内容。除非我开始用知识做一些事情，否则就像大脑中的一种消耗。

你的学习策略是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-23T20:15:31.520

斯坦福大学有免费课程（[在这里](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)），您可以从 iTunes U 下载。它包含视频和 PDF 文件，每次讲座后都有作业，您可以将其用作开发的想法。

来自 Java 世界，我认为最难学习的是：

*   使用引用计数代替 GC 的内存管理
*   了解如何利用消息分发，充分利用 Objective-C

Apple 提供的论坛和文档也非常好，应该作为您所做任何事情的参考。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-23T20:57:57.800

这是我所做的（我来自 Java/C++ 背景）：

**出发**

*   [在http://developer.apple.com](http://developer.apple.com)注册成为 iPhone 开发者（这是免费的）
*   下载 iPhone SDK（其中包括最新版本的 XCode 和 SDK 文档——在使用 SDK 或创建应用程序时，您会经常使用这两者）。
*   得到[希勒加斯的书](https://rads.stackoverflow.com/amzn/click/com/0321503619)。这本书很好地教授了 Cocoa 的基本概念。我发现这是理解 Cocoa 中引用计数的好方法（保留、释放、分配等）
*   购买有关 iPhone 编程[的橙皮书。](https://rads.stackoverflow.com/amzn/click/com/1430216263)这真的很好。（我之前买过 Erica Sadun 的书，但这并不能从初学者的角度解释事情）
*   试用这些程序。

这应该可以让您合理地加快速度并开发基本应用程序。（我还没有看过斯坦福的视频讲座，但我认为这也是一个很好的开始方式）

**变得更好**

*   为了更好地理解 Cocoa 概念，我发现最好的资源是 Apple Programming Guides。你绝对应该阅读这些。从 NSStrings 到 Objective 2.0 属性、内存模型等，它们几乎每个主题都有一个。您可以在 XCode 文档中找到这些内容。（如果您正在查找课程参考等，您会在左侧边栏中找到相关的编程指南）
*   Apple 示例代码：您可以在[http://developer.apple.com](http://developer.apple.com)再次找到它。您可以重复使用和/或调整这些。

您现在应该已经启动并开发应用程序了。如果您遇到困难或需要建议，这里有一些额外的资源：

**当你被卡住时该怎么办**

*   Cocoa-Dev 邮件列表（这本身并不是 Cocoa-touch 特定的，但我从这里得到了一些非常好的答案）
*   Apple 讨论论坛
*   国税局

（我不确定上面的资源列表是否足够好——但其他人可以纠正我）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T20:09:40.663

在阅读/了解代码时编写代码（例如 hello world 之类的东西）。这是我似乎可以保留东西的唯一方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-04-01T22:27:10.533

## 基础知识

**学习 Objective-C**

*   Apple 的[Objective-C 2.0 编程语言](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Introduction/introObjectiveC.html)是最接近袖珍参考的东西。它有大约 125 页。苹果有几个主题的参考资料，很棒的东西。

**学习 UIKit**（又名 iPhone 编程）

*   [iPhone 编程，大书呆子牧场指南](http://my.safaribooksonline.com/book/programming/iphone/9780321706485)，由 Joe Conway 和 Aaron Hillegass 撰写

与大多数书籍不同，牧场指南会在您阅读时解释类层次结构。否则，经过一系列步骤后，您最终会得到漂亮的应用程序，但无法单独飞行。

我喜欢同时阅读几本书中的一个主题。我几乎有所有关于 iPhone 编程的书，我也可以推荐

*   [Matt Neuburg 编写的iOS 6 编程](http://shop.oreilly.com/product/0636920029717.do)（也[可在线获取](http://www.apeth.com/iOSBook/)）
*   Erica Sadun[的 iPhone 开发者食谱](http://my.safaribooksonline.com/book/programming/iphone/9780321670168)
*   比尔·达尼 (Bill Dudney) 的[iPhone SDK 开发](http://pragprog.com/titles/amiphd/iphone-sdk-development)

**做你的作业**

我建议你做笔记和做练习。专注于小任务。例如，创建一个“基于导航的应用程序模板”项目，并尝试理解它。然后添加功能，例如，创建一个单元格，删除一个单元格，对它们进行排序，单击一个单元格以推动第二个屏幕。像这样的东西。撰写摘要时，您的记忆力会提高 50%。

由于 GCC 的限制，Xcode 不如 Eclipse 复杂。您应该做的第一件事是在您的项目中激活 NSZombieEnabled 以获得更好的错误消息。

你会发现小障碍并犯愚蠢的错误。让附近的人来帮助你是非常有帮助的。如果你不这样做，那就是 StackOverflow。

## 高级的东西

**Core Data**是 Apple 针对 iPhone 的 O/R 映射。您可以将它用于任何与数据库相关的内容。

*   Marcus S. Zarra 的[核心数据](http://pragprog.com/titles/mzcd/core-data)

**核心图形/动画**位于 UIKit 之下。要超越大多数 iPhone 编程书籍将教给您的内容，您需要自己绘制以实现高级 UI 定制。

*   由 Bill Dudney[为 Mac OS X 和 iPhone 设计的核心动画](http://pragprog.com/titles/bdcora/core-animation-for-mac-os-x-and-the-iphone)

**WWDC 会议**总是来自编写 UIKit 框架的 Apple 员工的精彩内容。WWDC 2010 对注册开发者免费：

*   [WWDC 2010 会议](http://developer.apple.com/videos/wwdc/2010/)

一些**博客**包含有用的提示和技巧：

*   [iDev 食谱](http://idevrecipes.com/)
*   [桥下](http://www.alexcurylo.com/blog/)
*   [有爱的可可](http://cocoawithlove.com/)
*   ......还有[更多](http://www.quora.com/Apple-Developer/What-is-your-favourite-iOS-OS-X-developer-blog)。几乎所有最终出现在书上的东西都可以在互联网上看到。

在 Twitter 上关注其他程序员。去你所在城市的 NSCoder 会议，欢迎所有人，即使你不是程序员。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-23T20:49:55.947

不要只是想它......做它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-23T20:12:27.270

一旦你与 Apple 签约使用 iPhone SDK（它可以免费下载和使用，如果你想在 App Store 上销售你的应用程序，你只需要付费），你就可以访问一些非常棒的开发者资源 -论坛、文档、示例代码等。我强烈建议您使用这些资源作为一个很好的起点。

从 Apple 下载一些基本示例应用程序，以了解它们如何组合在一起。在 iPhone 上进行开发肯定与其他类型的开发有很大不同，因此有示例可供参考和使用是非常棒的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-24T04:28:27.313

这份文档是从 C++/Java 到 Objective-C 的语言罗塞塔石碑（里面有很多适合 Java 人的东西）：

[http://ktd.club.fr/programmation/fichiers/cpp-objc-en.pdf](http://ktd.club.fr/programmation/fichiers/cpp-objc-en.pdf)

除此之外，请注意 iPhone 非常重视通过广泛而深入的基础类的功能，就像 Java 一样。尝试尽可能地学习它们，并且当您需要更多灵活性时，请注意 Cocoa 下还有更深层次的基于 CF C 的调用。

很好地理解内存管理模型并且很容易处理。这是我读过的关于在使用 Interface Builder 插座时如何处理内存管理的绝对最佳和最简单的描述：

[http://blog.airsource.co.uk/index.php/2008/12/23/memory-management-and-nibs/](http://blog.airsource.co.uk/index.php/2008/12/23/memory-management-and-nibs/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-23T22:02:26.147

在我对我所处的环境有所了解之前，我倾向于浏览示例代码和/或教程……但我从不完全遵循它们。总是改变一些值，一些细节的一些实现方法，并观察它的结果。

只是按照指示，我从来没有学到任何东西。改变事物，看到它的影响，我学到了很多。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-24T07:00:47.057

我会为这些非常好的答案添加一些内容 - 选择一个项目并几乎立即开始工作。当我不得不为我的实现找到答案时，我学到的东西比我在除了“学习”之外没有别有用心的情况下阅读时学到的要深入得多。

您可以发布另一个问题，询问您的第一个项目的想法。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-13T14:26:35.973

当我学习任何新语言时，我会使用提供的示例代码并从头开始重写它。这样，如果我被困在如何做某事上，我可以翻到提供的示例作为参考。我发现简单地重写示例代码对我有帮助，尤其是当存在很大的语法差异时。

关于 iPhone，我会密切关注内存管理。iPhone Dev 站点中有一些很棒的示例代码和文档。

# php - PHP printf 不打印，simplexml_load_string 不解析

> ID：783326
> 
> 赞同：-5
> 
> 时间：2009-04-23T20:08:59.913
> 
> 标签：php, simplexml, printf

我有一些数据不会打印出来......

echo 有效，但 printf 无效

字符串中有数据，simplexml_load_string 也不会解析字符串。

有一些二进制或不可见字符我看不到，也无法获得序数值，导致 printf 以及 PHP 中的大多数其他字符串函数失败。

显然这是一个编码问题，但是，我不知道如何找出它是什么，以便我可以正确编码/解码它。

```
$string = getStringFromDatabase();
printf($string); 
```

...

```
Nothing is displayed 
```

...

```
No errors, No Warnings, No Nothing 
```

显然那里有数据，如果我遍历每个字符，我知道它就在那里，但是，我不知道从那里去哪里。

[更新] 这很奇怪，因为序数值超出了典型的 ASCII 范围。

ord($buffer[$i]) = 1610

它是 DLE 和 LF 字符的组合。不知道它是如何到达那里的或为什么。或者它应该是什么，两边的数据都是有效的，而且它的位置很奇怪。

认为 <此处有问题的字符>0,000

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T20:25:11.560

printf的定义：

```
int printf  ( string $format  [, mixed $args  [, mixed $...  ]] ) 
```

您的问题不只是您将字符串作为 $format 传递吗？您不需要简单地使用`print`或提供`printf`字符串`$format`AND a`$string`吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T20:20:00.793

[echo](http://php.net/echo)将按字面意思输出一个字符串，但是如果您将字符串作为第一个参数传递给[printf](http://php.net/printf)，它将被解释为格式 - 如果它包含 % 字符，这些可能是您的问题的根源。

如果这有效：

```
echo $foo 
```

那么应该这样：

```
printf("%s", $foo); 
```

如果您想获得一个快速而肮脏的十六进制转储字符串，请尝试类似

```
$foo="fo \00 33jj";

$len=strlen($foo);
for ($i=0; $i<$len; $i++)
{
  printf("%02x ", ord($foo[$i]));
}

//outputs 66 6f 20 00 20 33 33 6a 6a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T20:21:08.717

看这里：[http](http://ditio.net/2008/11/04/php-string-to-hex-and-hex-to-string-functions/) ://ditio.net/2008/11/04/php-string-to-hex-and-hex-to-string-functions/也许只是显示十六进制表示，坏字符可能会来出，但是；您也可以只浏览字符串并将所有可打印字符（ASCII > 31 和 < 128）复制到一个新字符串中，然后打印出该字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T23:22:42.977

感谢那些比我说得不好的问题更糟糕的非有趣、明智的非答案和评论。我想，很多人都在寻找简单的问题来回答而不是思考。也可以随意投反对票。

真诚地感谢那些真正试图提供帮助的人。

对于那些遇到同样问题的人，这里是真正的答案：

答案是一个多字节字符，它是运行时的一个错误。您可以通过在字符串中查找 chr(16) 并将其替换为空字符串 ("") 来解决此问题。也就是说，如果您需要它与 s/v/printf 函数一起使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T20:21:26.187

尝试

```
file_put_contents('tmp.txt', $string); 
```

然后将其加载到十六进制编辑器中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T20:22:15.640

那时我会尝试，因为字符串可能为空：

```
echo "'" . $string . "'<br>"; 
```

# java - Java Swing中的拖动手柄

> ID：783342
> 
> 赞同：2
> 
> 时间：2009-04-23T20:12:23.073
> 
> 标签：java, swing

我似乎无法弄清楚如何在 Java Swing 中调整大小拖动手柄。如果您不确定我的意思，请打开本网站上的“提问”页面并查看文本区域的底部。它有一个栏，您可以拖动它以更改区域的大小。我正在寻找一种在 Java Swing 中执行此操作的方法。我什至不知道在哪里看这一点。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T20:22:43.173

在我看来，Stack Overflow 发布表单上使用的拖动句柄在外观和功能上都与垂直[JSplitPane](http://java.sun.com/javase/6/docs/api/javax/swing/JSplitPane.html)最相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T20:20:09.577

我也没有做过，但既然你只是在寻找一个开始，我会试一试。

我会`JComponent`在您希望句柄出现的位置放置某种（可能是自定义子类）（我假设您可以很好地操作布局管理器来完成该部分）。然后，我会在组件中添加一个`MouseListener`和一个`MouseMotionListener`——可能是同一个类，一个子类`MouseAdapter`——。当检测到点击和拖动时，我会调整手柄所连接的组件的大小。

这有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:33:01.620

这只是您可以开始寻找的一个想法。

在 swing 中，gui 组件确实使用了一个布局管理器（[LayoutManagers](http://java.sun.com/docs/books/tutorial/uiswing/layout/using.html)），它负责将每个图形元素放置在它的位置。

它们有点棘手，因为布局元素的逻辑因 LayoutManager 而异，大多数情况下您必须将它们组合起来。

LayoutManagers 通常会查询他们正在布局的组件以了解最小尺寸、最大尺寸和首选尺寸。一些 lym 完全忽略此信息，其中一些人部分使用它。

那么建议是使用一个布局管理器，它尊重首选大小（或最大值），然后在其他元素上添加一个鼠标侦听器。当元素被拖动时，您可以通过编程方式增加/减少组件的最大/最小/preff 大小（很可能是 JTextArea ）并让 LYM 调整组件的视觉外观。

所以它看起来像这样的伪：

```
 public App { 

      private JComponent container;
      private JComponent myTarget;
      private JComponent dragComponent;

      public void someWhere() { 
              container.setLayoutManager( someLayoutManager() );
              container.add( myTarget );
              container.add( dragComponent );

              // warn: not actual method names, I don't remember them
               dragComponent.addMouseListener( new MouseAdapter() {
                    public void mouseDragged( MouseEvent me ) { 
                          Point point me.getPoint();
                          int h = myTarget.getHeight();
                          int w = myTarget.getWidth();
                          // Do some math to know if you have to add or subtract. 
                          int movement = // -20, +20, whatever.
                          myTarget.setMaximumSize( h + ( movement ) , w ); 
                    }
               } );
       }
 } 
```

那只是一个伪代码，所以不要拍我。

同样的想法是找到正确的布局管理器并添加一个鼠标侦听器以了解组件被拖动到哪里。每次拖动组件时，您都会更改目标组件的大小并让 LayoutManager 重塑组件。

我希望这有帮助。

ps Swing 也有[拖放](http://java.sun.com/docs/books/tutorial/dnd/index.html)支持，看看它是否有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T20:42:53.577

正如另一个人已经回答的那样，您要做的只是需要将 JSplitPane 设置为水平对齐。您可以将分割条的宽度调整为您想要的像素大小。

# .net - Windows 窗体控件库；托管和非托管

> ID：783354
> 
> 赞同：0
> 
> 时间：2009-04-23T20:15:58.527
> 
> 标签：.net, c++, unmanaged, managed-c++

我编写的 Windows 窗体控件库项目 (C++) 使用非托管 dll。非托管 dll 有一个头文件（柴郡猫）。我只是将它包含在控制库项目中。并调用非托管 dll 中的函数（当然需要适当的编组）。这将编译和构建。问题是当我继续将控件添加到我的脚手架的工具箱中时，这是一个托管 C++ winform 应用程序，VS2005 抱怨它不是一个 .Net 模块。

我见过人们使用 MFC dll 作为 Windows 窗体控件进行转换。我究竟做错了什么？。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T21:48:33.840

可能是因为 VS2005 没有找到你的原生 .DLL。此 .DLL 以“正常”方式搜索本机 .DLL：

*   当前目录（我认为它主要是VS的启动目录）
*   应用程序目录（在 %ProgramFiles%\Microsoft Visual Studio... 中的某处）
*   %PATH% 目录。

您可以尝试将您的本机 DLL 放在上述目录中的某个位置，并尝试获得更好的结果。

我绝对建议您将本机部分设为静态并将其静态链接到您的 .NET 项目（如果可能的话），因为这样可以避免本地 .DLL 查找问题。（这是我做的，因为有很多问题。例如，我们有一个翻译工具 [SDL Passolo]，它可以处理 .NET DLL 并将它们打包到包括所有引用的 DLL 的翻译包中......但只有 .NET DLL，但不是本机DLL！）。

# javascript - javascript 内容压缩/扩展选项基于 内容长度

> ID：783357
> 
> 赞同：1
> 
> 时间：2009-04-23T20:17:33.950
> 
> 标签：javascript

我在这样的 html 页面中有很多字段

```
<div class="note" id="notexyz23">
    very long content
</div> 
```

我正在寻找可以执行以下操作的脚本：

*   检查内容长度是否大于某个数量（如 300 个字符）
*   如果是这种情况，请将其压缩，使其长度为 300 个字符并显示“展开”按钮，否则保持原样

显然它应该完整地保持内容的内部 html 结构。

我确信这样的事情已经完成了，我想得到一些参考。

非常感谢

尼古拉·蒙特奇奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T17:40:43.163

这就是我要找的东西： [http](http://www.reindel.com/truncate/#examples) ://www.reindel.com/truncate/#examples 无论如何，感谢你们所有人的友好回答。祝你有美好的一天尼古拉

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T20:27:24.690

您可能想要使用支持 css 选择器的框架，例如 dojo 或 jquery

所以想：

```
dojo.query(".note").foreach(
     function(zeDiv){
       if(zeDiv.innerHTML.length > 300){
          var content = zeDiv.innerHTML;
          var summary = content.subtring(0,300);
          zeDiv.innerHTML = summary;
          var hiddenContent = document.createElement("input");
          hiddenContent.type = "hidden";
          hiddenContent.value = content;
          zeDiv.appendChild(hiddenContent);
          var expandButton = document.createElement("input");
          expandButton.type = "button";
          expandButton.onClick = function(){
             this.innerHTML = dojo.query("[type=hidden]")[0].value;
          }
          zeDiv.appendChild(expandButton);
       }
     }
); 
```

代码没有经过测试，但它在这个大方向上有所作为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:27:29.277

[这里](http://devongovett.wordpress.com/2009/04/06/text-overflow-ellipsis-for-firefox-via-jquery/)有一个 jQuery 插件，当调用它时，它会自动切断不适合的文本并添加省略号。如果容器被调整大小，它也会重新计算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T20:27:54.550

不是您的问题的答案，但这是一个不错的小功能，我必须仅在单词末尾截断文本，而不是在`x`字符后盲目截断。

```
function truncate(text, length) {
    if (text.length > length) {
        var re = new RegExp('^(.{1,' +length+ '})(\\s.*|$)');
        text = text.replace(re, '$1...');
    }
    return text;
} 
```

# c# - YAML 作为 .NET (C#) 中的数据 DSL

> ID：783361
> 
> 赞同：0
> 
> 时间：2009-04-23T20:19:25.757
> 
> 标签：c#, .net, serialization, dsl, yaml

有人在 .NET 中使用 YAML 作为数据 DSL 吗？我想使用 YAML，因为它比 XML 更轻量级。我打算将此 DSL 用作我现有应用程序之一的“高级用户”配置工具。

我的担忧：

*   使用 .NET 社区库之一对 YAML 的支持如何？
*   YAML 有持久力吗？4年后还会有吗？或者我们会谈论其他格式吗？我知道 JSON 和 XML 将会出现一段时间，但我的用户不想编写或维护 JSON 或 XML 文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T21:08:40.693

您是否考虑过使用 IronPython 脚本？这样，您不仅可以解释简单的键值类型的东西，还可以将动态执行和计算添加到您的高级用户配置中。

值得一试，因为托管 IronPython 非常*简单*，而且语法非常干净且易于用户阅读，即使他们不了解 Python。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T20:55:37.557

如果它是面向用户的文档，请不要担心 YAML 的“持久力”。担心让用户对某些 DSL 感到满意。话虽如此，我会选择 YAML 而不是 XML。

在面向用户的部分之外，我不会过多地使用 YAML。XML 有更多的用途*我可以想象*，使用更丰富和更广泛使用的东西（尤其是 .NET）将符合您的最大利益。

即使您必须创建自己的语言来满足您的用户，不强迫他们查看 XML 可能也是值得的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-05T15:21:48.563

有可以构造和解析 YAML 的 YAML 库，但我似乎找不到任何方法来序列化任意对象，例如用于 C# 的 XML 或用于 Ruby 的 YAML。

# social-networking - 用于设计社交网络的资源？

> ID：783362
> 
> 赞同：2
> 
> 时间：2009-04-23T20:19:30.590
> 
> 标签：social-networking

我正在设计一个与 deviantART 或其他艺术社区没有什么不同的在线艺术社区。

我正在寻找资源（书籍、网站、博客）来指导我解决我在设计网站时需要解决的一些技术、社会和法律问题。

我从Clay Shirky的[Here Comes Everyone 开始。](https://rads.stackoverflow.com/amzn/click/com/1594201536)我只需要知道从这里去哪里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T20:22:48.570

它根本不会解决技术或法律问题，但Clay Shirkey 的[《Here Comes Everyone》是一本有趣的读物，内容涉及社交网络的动态以及新技术如何改变人们的组织方式。](https://rads.stackoverflow.com/amzn/click/com/1594201536)我希望它是一个很好的灵感来源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T20:27:25.503

对于技术方面的东西，这就是您需要的：http: [//oreilly.com/catalog/9780596529321/](http://oreilly.com/catalog/9780596529321/) [（来源：][[oreilly.com](http://oreilly.com/catalog/covers/9780596529321_cat.gif)][）][![编程集体智能](https://i.stack.imgur.com/ylG2g.gif)](https://i.stack.imgur.com/ylG2g.gif)

对于社交方面，请查看[Seth Godin](http://sethgodin.typepad.com/)的[Tribes](https://rads.stackoverflow.com/amzn/click/com/1591842336)

[部落 http://classes.tametheweb.com/shelfless/files/2009/02/sethgodin-tribescover.jpg](http://classes.tametheweb.com/shelfless/files/2009/02/sethgodin-tribescover.jpg)

# asp.net - 从 .NET Web 服务中的 XML 表示返回复杂类型

> ID：783374
> 
> 赞同：1
> 
> 时间：2009-04-23T20:22:07.527
> 
> 标签：asp.net, xml, web-services, serialization, soap

我在数据库中有一个 XML 文档，它是某个类 Foo 的实例的 XML 序列化表示：

```
<?xml version="1.0" encoding="utf-16"?>
<Foo xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  <StringProp>hello</StringProp>
  <IntProp>5</IntProp>
</Foo> 
```

假设现在我想编写一个返回 Foo 实例的 ASP.NET Web 服务方法，如下所示：

```
[WebMethod]
public Foo GimmeFoo()
{
} 
```

问题：我想返回序列化的 Foo，但*没有在 GimmeFoo() 方法中首先反序列化它*（现实生活中的 Foo 相当大，从数据库反序列化它然后在不久之后自动重新序列化它会感觉很愚蠢由 SOAP 仙女）。

是否有任何属性可以让我在 Web 服务（或我可以在其主体中编写的一些代码）上添加任何属性，以允许我发送 Foo 的实例而无需先反序列化它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T20:33:03.897

这假定只有已知的客户端会调用此服务，因为其他语言可能无法反序列化此 xml 文件。

在我看来，如果是这种情况，那么为什么不使用 REST 服务将数据传回，因为您没有正确使用 Web 服务，IMO。例如，如果我使用 GSOAP（C 语言）或 PHP 作为客户端，您的 xml 文件是否有用，因为我需要自己反序列化它。

反序列化然后让 Web 服务重新序列化可能会很痛苦，但是如果您必须使用 Web 服务，IMO 再次是正确的方法。

此外，如果您将这个序列化的 XML 文件传回，那么客户端和服务器之间的耦合非常强，这在 IMO 中也是一个糟糕的设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T04:50:57.493

您可以从 Web 服务返回 XmlElement 或 XmlDocument 类型。只需返回您的序列化 XML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T15:31:16.050

我找到了一种可能不是最优雅的方法，但可以完成工作。这个想法是将*所有*工作委托给自定义的 SoapExtension 派生类，实际上在 WebMethod 本身中什么都不做 - WebMethod 只是作为调用的端点：

```
[WebMethod]
public Foo GimmeFoo()
{
     return null;
} 
```

但神奇之处在于：您编写了一个拦截所有 SOAP 流量的 SoapExtension，当 SoapMessageStage.AfterSerialize 阶段到达时，您将已经序列化的有效负载插入其中：

```
public class SerializationPassThrough : SoapExtension
{
    private Stream oldStream;
    private Stream newStream;

    // Other overrides...

    public override void ProcessMessage(SoapMessage message)
    {
        switch (message.Stage)
        {
            case SoapMessageStage.BeforeSerialize:
                // ...
                break;
            case SoapMessageStage.AfterSerialize:
                string newOutput = ReadPreCookedResponseFromDB();
                RewriteOutput(newOutput);
                break;
            case SoapMessageStage.BeforeDeserialize:
                // ...
                break;
            case SoapMessageStage.AfterDeserialize:
                // ...
                break;
            default:
                throw new Exception("invalid stage");
        }
    }

    private void RewriteOutput(string output)
    {
        newStream.Position = 0;
        StreamWriter sw = new StreamWriter(newStream);
        sw.Write(output);
        sw.Flush();
        newStream.Position = 0;
        Copy(newStream, oldStream);
        newStream.Position = 0;
    }

    private void Copy(Stream from, Stream to)
    {
        TextReader reader = new StreamReader(from);
        TextWriter writer = new StreamWriter(to);
        string toWrite = reader.ReadToEnd();

        writer.WriteLine(toWrite);
        writer.Flush();
    }

} 
```

最后一点：您需要指示 ASP.NET 运行时使用您的 SoapExtension。您可以通过 WebMethod 或 web.config 中的属性来执行此操作（这就是我所做的）：

```
<system.web>
  <webServices>
    <soapExtensionTypes>
       <add type="SoapSerializationTest.SerializationPassThrough, SoapSerializationTest" priority="1" />
    </soapExtensionTypes>
  </webServices>
<system.web> 
```

我从中派生出这些片段的原始代码示例位于[http://msdn.microsoft.com/en-us/library/7w06t139(VS.85).aspx](http://msdn.microsoft.com/en-us/library/7w06t139(VS.85).aspx)。

# wpf - Silverlight/WPF 用十六进制颜色设置椭圆

> ID：783384
> 
> 赞同：4
> 
> 时间：2009-04-23T20:25:23.260
> 
> 标签：wpf, silverlight

我正在尝试在后面的代码中设置椭圆对象的颜色。到目前为止，我是通过使用 SolidColorBrush 方法来完成的。有没有办法像在 CSS 中一样以十六进制插入颜色值？

这是我正在使用的代码：

```
ellipse.Fill = new SolidColorBrush(Colors.Yellow); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T20:51:15.320

像这样的东西会起作用

```
ellipse.Fill = 
    new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF00DD")); 
```

（编辑：看起来这只是[WPF。Alex Golesh 在这里有一篇](http://blogs.microsoft.co.il/blogs/alex_golesh/archive/2008/04/16/colorconverter-in-silverlight-2.aspx)关于他的 Silverlight ColorConverter 的博客文章）

虽然我更喜欢这种`Color.FromRgb`方法

```
byte r = 255;
byte g = 0;
byte b = 221;
ellipse.Fill = new SolidColorBrush(Color.FromRgb(r,g,b)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T20:51:19.737

我写了一个简单的[颜色转换器函数](http://www.wiredprairie.us/blog/index.php/archives/659)来解决这个问题。快乐的面孔实际上是数字 8 和括号，如下所示：8)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T20:54:17.263

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.media.solidcolorbrush.aspx)

```
SolidColorBrush mySolidColorBrush = new SolidColorBrush();

// Describes the brush's color using RGB values. 
// Each value has a range of 0-255.
mySolidColorBrush.Color = Color.FromArgb(255, 0, 0, 255);
myRgbRectangle.Fill = mySolidColorBrush; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T21:07:11.600

当然，您也可以这样做（使用 FromArgb 函数中的十六进制数字）：

```
SolidColorBrush mySolidColorBrush = new SolidColorBrush();

// Describes the brush's color using RGB HEX values. 
// Each value has a range of 0-255\. Use 0x for HEX numbers
mySolidColorBrush.Color = Color.FromArgb(255, 0xFF, 0xC0, 0xD0);
myRgbRectangle.Fill = mySolidColorBrush; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T07:36:25.910

另一个，小巧，快速且有用：

```
public static Color ToColor(this uint argb)
{
    return Color.FromArgb((byte)((argb & -16777216) >> 0x18),
                          (byte)((argb & 0xff0000) >> 0x10),
                          (byte)((argb & 0xff00) >> 8),
                          (byte)(argb & 0xff));
} 
```

在代码中使用：

```
SolidColorBrush scb  = new SolidColorBrush (0xFFABCDEF.ToColor()); 
```

当然需要使用 0xFFFFFFFF (uint) 表示法而不是 "#FFFFFFFF" (string)，但我相信这没什么大不了的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-30T03:45:41.693

对于使用十六进制值：

```
 your_contorl.Color = DirectCast(ColorConverter.ConvertFromString("#D8E0A627"), Color) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-02T10:20:00.943

我认为这会起作用，因为它适用于文本框。

```
var bc = new BrushConverter();
textRichTextBoxEditor.Foreground = (Brush)bc.ConvertFrom("#FF97315A"); 
```

访问[http://soulsolutions.com.au/Blog/tabid/73/EntryId/617/Using-Hex-Colour-values-to-set-Foreground-in-WPF.aspx](http://soulsolutions.com.au/Blog/tabid/73/EntryId/617/Using-Hex-Colour-values-to-set-Foreground-in-WPF.aspx)

# postgresql - 在 geos/postgis 重新编译后恢复 postgresql/postgis 备份策略？

> ID：783393
> 
> 赞同：0
> 
> 时间：2009-04-23T20:28:49.947
> 
> 标签：postgresql, backup, compilation, postgis, geos

**现在的情况：**

*   Ubuntu 8.04 服务器版（直播服务器）
*   Postgresql 8.3.7（来自标准存储库）
*   Postgis 1.3.3（来自标准存储库）
*   GEOS 2.3.4（来自标准存储库）

**问题：**

GEOS 包含在 3.0 版本中修复的错误。我遇到了这些问题，需要升级 GEOS/Postgis 以包含 GEOS 修复程序。

**我现在站在哪里：**

在具有几乎相同设置的测试机器上，我删除了 postgis 包并尝试针对 Postgis 1.3.5 和 Postgresql 8.3.7 重新编译 Geos 3.1.0。

修复一些链接和路径问题后，此方法有效。

**我的具体问题：**

将我的数据库（表、函数、触发器、gist 索引、数据...）从“基于较旧的 geos/postgis”版本迁移到“较新”版本的最佳方法是什么？

[我会尝试文档中描述](http://postgis.refractions.net/documentation/manual-1.3/ch02.html#upgrading)的“软升级”方式，但你认为这会奏效吗？

对这个启用了 postgis 的数据库进行完整备份的最佳方法是什么，以便我可以在我正在编译的“较新的 postgis 版本”上完全恢复它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T02:08:21.313

> 我会尝试文档中描述的“软升级”方式，但你认为这会奏效吗？

我对 GEOS 的了解还不够，无法肯定地说，但这听起来是件好事。从您链接到的文档中：

> 如果无法进行软升级，则脚本将中止，并且您将收到有关需要进行硬升级的警告，因此请不要犹豫，先尝试软升级。

否则，我只会遵循他们的“硬升级”指示，这似乎在功能上等同于用于升级到新的 PostgreSQL 主要版本的常用`pg_dump`/方法。`pg_restore`Postgres 文档中有更多关于如何做到这一点的信息；这是一个非常安全的过程，并且作为官方迁移方法，得到了极好的支持。

您可能希望考虑的一件事是在完成所有这些工作时升级到 PostgreSQL 8.4 beta。它是 Beta 版软件，确实如此，但这可能对您的环境是可以接受的，如果它合适，那么您将获得 8.4 的新功能以及软升级到 8.4 最终版的能力（因为预计不会使用磁盘格式在测试版开始后更改）。

# objective-c - NSDate 的字符串描述

> ID：783395
> 
> 赞同：19
> 
> 时间：2009-04-23T20:30:01.173
> 
> 标签：objective-c, cocoa, nsdate

我有以下代码：

```
[ [NSDate date] descriptionWithLocale: @"yyyy-MM-dd" ] 
```

我希望它以以下格式返回日期：“2009-04-23”

但它会返回：2009 年 4 月 23 日星期四晚上 11:27:03 GMT+03:00

我究竟做错了什么？

先感谢您。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2010-09-20T09:03:28.033

```
NSDateFormatter* dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyy-MM-dd"];
NSString *dateString = [dateFormatter stringFromDate:[NSDate date]];
[dateFormatter release];  // delete this line if your project uses ARC
NSLog(@"%@",dateString); 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-23T20:33:40.417

您使用了错误的方法。而是尝试[`descriptionWithCalendarFormat:timeZone:locale:`](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDate/descriptionWithCalendarFormat:timeZone:locale:)

```
[[NSDate date] descriptionWithCalendarFormat:@"%Y-%m-%d"
                                    timezone:nil
                                      locale:nil]; 
```

另请注意，该方法期望的格式与您问题中的格式不同。可以在[这里](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/df100103.html%23//apple_ref/doc/uid/TP40007972-SW1)找到完整的文档。

编辑：虽然正如迈克所说，你真的应该使用`NSDateFormatter`. `descriptionWithCalendarFormat:timezone:locale:`Apple 在文档中提到的一些问题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-24T14:45:39.870

另请注意，在大多数情况下，`NSDateFormatter`它的灵活性是首选。

在许多应用程序中重复使用日期格式化程序还可以带来显着的性能优势。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T20:36:28.337

如果你没有`NSDate -descriptionWithCalendarFormat:timeZone:locale:`可用的（我不相信 iPhone/Cocoa Touch 包括这个），你可能需要使用[strftime](http://www.cplusplus.com/reference/clibrary/ctime/strftime/)和一些 C 风格的字符串。您可以使用 NSDate 从 NSDate 获取 UNIX 时间戳`NSDate -timeIntervalSince1970`。

# c# - 在 C# 中按搜索词过滤后，如何按匹配数对列表进行排序？

> ID：783396
> 
> 赞同：0
> 
> 时间：2009-04-23T20:30:03.890
> 
> 标签：c#, search, list, filter

我的用户类中有一个过滤器方法，它接受一个用户列表和一串搜索词。目前，FindAll 谓词拆分空格上的术语，然后如果任何可搜索属性包含术语的任何部分，则返回匹配项。

```
public static List<User> FilterBySearchTerms( List<User> usersToFilter, string searchTerms, bool searchEmailText )
{
    return usersToFilter.FindAll( user =>
    {
        // Convert to lower case for better comparison, trim white space and then split on spaces to search for all terms
        string[] terms = searchTerms.ToLower().Trim().Split( ' ' );

        foreach ( string term in terms )
        {
            // TODO: Is this any quicker than two separate ifs?
            if ( 
                    (searchEmailText && user.Email.ToLower().Contains( term )) 
                    || (
                        user.FirstName.ToLower().Contains( term ) || user.Surname.ToLower().Contains( term ) 
                        || user.Position.ToLower().Contains( term ) || user.Company.ToLower().Contains( term ) 
                        || user.Office.ToLower().Contains( term ) 
                        || user.Title.ToLower().Contains( term )
                    )
            )
                return true;
            // Search UserID by encoded UserInviteID
            else 
            {
                int encodedID;
                if ( int.TryParse( term, out encodedID ) )
                {
                    User fromInvite = GetByEncodedUserInviteID( encodedID );
                    if ( fromInvite != null && fromInvite.ID.HasValue && fromInvite.ID.Value == user.ID )
                        return true;
                }
            }
        }

        return false;
    } );
} 
```

我收到了一个新要求，因此订购现在很重要。例如，搜索“史密斯先生”时，亚当史密斯先生应该排在夏娃史密斯夫人之前，这可能使我对包含的使用不合适。但是，最重要的是属性/部分术语匹配的数量。

我想我可以有几个计数器来跟踪完整的学期匹配和部分匹配，然后按这两个排序。我也愿意接受有关如何改进 Filter 方法的建议——也许完全使用其他方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T20:47:26.890

这是一个基于 LINQ 的解决方案。如果您不使用 .NET 3.5，恐怕会更加痛苦。为清楚起见，它将匹配的细节与查询本身分开。

您需要创建一个`LowerCaseUser`方法，该方法返回一个`User`所有属性都小写的对象 - 这样做一次比对每个搜索词都更有意义。如果你能把它放在`UserMatches`课堂`User`上，那就更好了。无论如何，这是代码。

```
public static List<User> FilterBySearchTerms
    (List<User> usersToFilter, 
     string searchTerms,
     bool searchEmailText)
{
    // Just split the search terms once, rather than for each user
    string[] terms = searchTerms.ToLower().Trim().Split(' ');

    return (from user in usersToFilter
            let lowerUser = LowerCaseUser(user)
            let matchCount = terms.Count(term => 
                                         UserMatches(lowerUser, term))
            where matchCount != 0
            orderby matchCount descending
            select user).ToList();
}

private static bool UserMatches(User user, string term,
                                bool searchEmailText)
{
    if ((searchEmailText && user.Email.Contains(term))
        || user.FirstName.Contains(term)
        || user.Surname.Contains(term)
        || user.Position.Contains(term)
        || user.Company.Contains(term)
        || user.Office.Contains(term)
        || user.Title.Contains(term))
    {
        return true;
    }
    int encodedID;
    if (int.TryParse(term, out encodedID))
    {
        User fromInvite = GetByEncodedUserInviteID(encodedID);
        // Let the compiler handle the null/non-null comparison
        if (fromInvite != null && fromInvite.ID == user.ID)
        {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T21:06:23.770

我想说您需要做的第一件事是将大型惰性评估或条件分解为单独的条件。否则，您将永远无法解决实际获得的匹配数量。在此之后，您可能需要为每个用户提供一个分数，以反映搜索词与它的匹配程度。

我还假设您可以在这里使用 LINQ，因为您已经在使用 lambda 表达式。

```
 class ScoredUser
    {
        public User User { get; set; }
        public int Score { get; set; }
    }

    public static List<User> FilterBySearchTerms(List<User> usersToFilter, string searchTerms, bool searchEmailText)
    {
        // Convert to lower case for better comparison, trim white space and then split on spaces to search for all terms
        string[] terms = searchTerms.ToLower().Trim().Split(' ');

        // Run a select statement to user list which converts them to
        // a scored object.
        return usersToFilter.Select(user =>
        {
            ScoredUser scoredUser = new ScoredUser()
            {
                User = user,
                Score = 0
            };

            foreach (string term in terms)
            {
                if (searchEmailText && user.Email.ToLower().Contains(term))
                    scoredUser.Score++;

                if (user.FirstName.ToLower().Contains(term))
                    scoredUser.Score++;

                if (user.Surname.ToLower().Contains(term))
                    scoredUser.Score++;

                // etc.
            }

            return scoredUser;

            // Select all scored users with score greater than 0, order by score and select the users.
        }).Where(su => su.Score > 0).OrderByDescending(su => su.Score).Select(su => su.User).ToList();
    } 
```

让该方法返回得分客户还可以让您稍后轻松调整得分余额。例如，假设您想要匹配的名字比匹配的公司更重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:34:42.410

完全匹配和部分匹配之间的区别是相关的，还是只是标准的字典排序？如果您要对 Adam Smith 先生和 Eve Smith 夫人进行排序，它们将按此顺序排列。那只会允许您使用标准的排序 lambda。

# language-agnostic - 设计良好的网络服务器的示例是什么？

> ID：783399
> 
> 赞同：1
> 
> 时间：2009-04-23T20:31:37.817
> 
> 标签：language-agnostic, architecture, network-programming, ambiguous

我对研究可扩展网络服务应用程序的架构很感兴趣。我对协议或使用的语言不太感兴趣，对设计的优雅和可扩展性更感兴趣。当然会想到 Apache，但我想知道是否有人有任何其他让他们乐于使用的示例。

编辑：为了澄清，我问的是实现网络协议的服务器应用程序。从这个意义上说，Web 开发框架不是网络服务器。协议可能包括但不限于：FTP、HTTP、XMPP、SNMP、IMAP 等。好的网络服务器实现某种并行性，注重可扩展性，同时也具有良好的可扩展性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T18:20:07.317

[nginx](http://nginx.net/)（另见[nginx wiki](http://wiki.nginx.org/Main)）是一个 HTTP 服务器和邮件代理，在可扩展性和资源效率方面享有盛誉。它使用基于事件的架构（支持 epoll、kqueue 等），即使在相当大的负载下也能保持较低的内存使用率。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T20:33:53.240

想我会在这里扔掉[Apache](http://modules.apache.org/doc/API.html)以防止每个人同时回答它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:37:04.030

[Django](http://www.djangoproject.com)的 web 框架是一个不错的服务器。就此而言，所有 Web 应用程序服务器都具有很强的可扩展性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T17:33:38.817

我会说 ASP.NET 是一个设计良好的服务器应用程序。编程模型是可扩展的（允许您使用用户编写的模块连接到请求生命周期的每个事件）。

也非常可扩展和高性能。

仅缓存功能就值得了。我可以给你一个指向 ASP.NET 的通用链接，但我相信你对它相当熟悉。

[http://www.asp.net/](http://www.asp.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T17:37:03.427

对于编写网络服务器，我喜欢使用[POE](http://poe.perl.org)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T17:47:25.943

[Ejabberd](http://www.ejabberd.im/)是一个用 Erlang 编写的 XMPP 服务器。Erlang 编程语言的本机消息传递非常适合即时消息服务器，这使得 Ejabberd 非常模块化，并展示了很多并行性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T17:51:24.560

[Asterisk PBX](http://www.asterisk.org/)是一个开源电话服务器，它实现了包括 SIP 在内的许多 VoIP 协议。它是相当模块化的，并且非常可配置，甚至使用它自己的某种编程语言 AEL 来描述 IVR 拨号方案交互。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T18:08:26.860

[码头](http://www.mortbay.org/)对我来说效果很好。它速度快，在负载下运行良好。当然，性能将取决于您在 Jetty 上部署的应用程序类型。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T18:21:27.640

我建议阅读有关 ACE 的这些书籍：

*   [C++ 网络编程：使用 ACE 和模式掌握复杂性](http://www.cs.wustl.edu/~schmidt/ACE/book1/)
*   [C++ 网络编程：ACE 和框架的系统重用](http://www.cs.wustl.edu/~schmidt/ACE/book2/)

它们包含很多关于设计网络应用程序的非常有用的信息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T18:28:44.487

我会看看[OpenSSH](http://www.openssh.com/)，它以几乎无法穿透而闻名。这主要是由于 OpenBSD 小组的密集审查过程，但我怀疑它也与架构有关。

对于可扩展性，我会更深入地研究[OpenSSL](http://www.openssl.org/)（用于 OpenSSH 的底层协议工具包）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-01T18:40:35.193

由于没有其他人提到它：IIS。

它是一个非常可扩展的 Windows 应用程序（它本身是非常可扩展的）。

使用 ASP 和其他 .NET 组件，您将无法获得比这更通用的功能。

# c# - 无法访问外部类库调用中的已处置对象错误

> ID：783402
> 
> 赞同：1
> 
> 时间：2009-04-23T20:32:24.663
> 
> 标签：c#, powershell, exchange-server-2007, cmdlets

我有一个 Windows 窗体应用程序，它使用 Powershell 和 Exchange2007 cmdlet 在 Exchange 中配置用户帐户。此应用程序只有一种形式，它为新用户获取信息，然后运行 ​​Powershell 命令。像一个优秀的程序员一样，我只是重构了代码，把所有的 Exchange 和 Active Directory 调用都取出来，并将它们放在不同的类中。在 Windows 窗体中，我在按钮 Click 事件中调用以下代码：

```
ExchangeMailboxFunctions exFuncs = new ExchangeMailboxFunctions();

exFuncs.CreateNewMailbox(username, userPrincipalName, OU, txtDisplayName.Text, txtFirstName.Text, txtInitials.Text, txtLastName.Text,
   txtPassword1.Text, ckbUserChangePassword.Checked, mailboxLocation); 
```

在课堂上，我有以下内容：

```
RunspaceConfiguration config = RunspaceConfiguration.Create();
PSSnapInException warning;
Runspace thisRunspace;

public ExchangeMailboxFunctions()
    {
        InitializePowershell();
    }

    private void InitializePowershell()
    {
        try
        {
            thisRunspace = RunspaceFactory.CreateRunspace(config);
            config.AddPSSnapIn("Microsoft.Exchange.Management.PowerShell.Admin", out warning);
            thisRunspace.Open();
        }
        catch (Exception ex)
        {
            throw new Exception(string.Format("Could not initialize Powershell: {0}", ex.Message));
        }
    }

public void CreateNewMailbox(string username, string userPrincipalName, string OU, string DisplayName, string FirstName, string Initials,
        string LastName, string Password, bool ChangePasswordNextLogon, string MailboxLocation)
    {

        try
        {
            using (Pipeline thisPipeline = thisRunspace.CreatePipeline())

    [Set a bunch of pipLine parameters here]

    thisPipeline.Invoke();
    }
    catch (Exception ex) 
```

thisPipeline.Invoke 导致错误，我不知道 Disposed 是什么。该代码在表单的代码隐藏中时工作得非常好。我还有一些 Active Directory 方法，我将它们撕成一个单独的类库，它们似乎工作正常。

我应该怎么做才能让这种情况停止发生？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T20:40:00.557

确保您的代码实际上看起来像这样......

```
using (Pipeline thisPipeline = thisRunspace.CreatePipeline())
{
    [Set a bunch of pipLine parameters here]

    thisPipeline.Invoke();
} 
```

括号是关键，您的示例中缺少它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T20:56:57.087

抱歉，括号之类的东西实际上没问题——我一定把它们排除在问题之外了。我错过了 create 方法中的这些代码行：

```
 using (SecureString ss = new SecureString())
 {
    foreach (char c in Password)
      ss.AppendChar(c);
    thisPipeline.Commands[0].Parameters.Add("Password", ss);
 } 
```

由于在调用 Invoke 之前已释放 Using，因此没有 ss，因为它已经被 Disposed。在发布这个之前应该看起来更深入一点:-(

# oracle - 使用 .NET MVC 查询 Oracle

> ID：783408
> 
> 赞同：2
> 
> 时间：2009-04-23T20:33:36.923
> 
> 标签：oracle, model-view-controller

我一直在关注一些连接到 sql mdf 数据库的 MVC 教程，并且想知道是否存在任何教程，向您展示如何使用 Oracle 数据库创建数据模型。我工作的公司在后端使用 Oracle，因此将 MVC 作为模型与 Oracle 绑定将对我有很大帮助。谢谢。

顺便说一句，我想尝试在不使用 DevArt 的 dotConnect 或 OraDeveloper 的工具等 3rd 方工具的情况下创建数据库连接，但如果这是唯一的方法，我想听听如何让它与这个工具一起工作。

编辑：.NET 特定 MVC 感谢@Eric

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T20:45:05.460

假设您在这里谈论 .NET MVC，MVC 本身实际上没有任何“内置”数据访问。您只需使用您认为适合您的应用程序的任何 .NET 数据访问方法（ADO.NET、NHibernate、LINQ 等）。

因此，您可能需要先查看以下问题：

[哪个是 C# 和 .Net 的“最佳”数据访问框架/方法？](https://stackoverflow.com/questions/657220/which-is-the-best-data-access-framework-approach-for-c-and-net)

[使用 linq 和 oracle](https://stackoverflow.com/questions/30790/is-there-a-way-to-use-linq-to-oracle)

[将 Visual Studio 2005 (C#) 连接到 Oracle8 最方便的方法是什么？](https://stackoverflow.com/questions/230927/what-would-be-the-most-convenient-way-to-connect-visual-studio-2005-c-to-oracl)

如果您在此站点中搜索“.net 和 oracle”或类似内容，我相信您会找到更多信息。

# windows - 如何判断我的 Web 服务在 Visual Studio 2005 中运行的帐户

> ID：783412
> 
> 赞同：3
> 
> 时间：2009-04-23T20:35:35.170
> 
> 标签：windows, security, asmx, impersonation

我有点疯了，试图理解关于模拟和委托的文档，问题是我的网络服务在哪个帐户下运行。

我在名为 JOHNXP 的开发工作站上登录为 myDomainName\johna。从 Vstudio2005 我通过 Debug 启动我的 web 服务，然后 wsdl 页面出现在我的浏览器中。

在任务管理器中，我在 .asmx 代码中的断点处看到以下内容：

aspnet_wp.exe pid=1316 用户名=ASPNET devenv.exe pid=3304 用户名=johna

托管我的 ws.asmx 代码的虚拟目录的 IIS 目录安全选项卡未选中“启用匿名访问”并选中“集成 Windows 身份验证”。

因此，当 MSDN 人员声明“您必须配置运行服务器进程的用户帐户”时，对于上述我的小 Web 服务，他们指的是什么？

我引用自：http: [//msdn.microsoft.com/en-us/library/aa302400.aspx](http://msdn.microsoft.com/en-us/library/aa302400.aspx)

最终，我希望我的这个 web 服务能够模拟任何经过身份验证的域用户浏览到我的 web 服务的调用。我的 web 服务反过来在不同的服务器（但相同的域）上使用另一个 ASMX web 服务。我需要这个远程 Web 服务来使用模拟的域用户凭据（不是我在 JOHNXP 上的 Web 服务的凭据）。

所以对我来说理解这一点有点难听，我发现我不清楚我的网络服务使用的帐户。我认为它是 WinXP 上 IIS 5.1 中的 ASPNET，但不确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T21:02:25.700

默认情况下，在 ASP.NET 之上运行的任何应用程序（包括 ASMX Web 服务）都将在**ASP.NET 机器帐户**(ASPNET) 安全上下文下执行，该安全上下文在主机上具有受限权限。

可以通过启用**模拟**来更改此行为，这将导致 ASP.NET 应用程序在经过身份验证的用户或特定用户帐户的安全上下文下执行。在 Web.config 文件中启用了模拟：

```
<system.web>
  <!-- ASP.NET runs as the authenticated user -->
  <identity impersonate="true" />
</system.web>

<system.web>
  <!-- ASP.NET runs as the specified user -->
  <identity impersonate="true"
            username="DOMAIN\user"
            password="password" />
</system.web> 
```

当在 IIS 中启用**集成 Windows 身份验证并禁用****匿名 Internet 用户帐户**时，经过身份验证的用户将是发出 HTTP 请求的客户端的 Windows 身份。
启用模拟后，ASP.NET 工作进程在处理请求时将使用相同的标识。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-19T16:15:53.297

顺便说一句，上面除了答案，其实应该是：

```
<system.web>
  <!-- ASP.NET runs as the specified user -->
  <identity impersonate="true"
            userName="DOMAIN\user"
            password="password" />
</system.web> 
```

用户名需要大写 N -> userName

希望这可以帮助

# asp.net - 用于在按键上跳到文本框的 Jquery 函数

> ID：783415
> 
> 赞同：2
> 
> 时间：2009-04-23T20:36:42.093
> 
> 标签：asp.net, jquery, function

我目前有 4 个文本框，用于存储 IP 地址。我需要帮助的是一个允许用户输入“。”的功能。并让文本框将焦点从当前文本框更改为下一个文本框。

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T20:55:42.843

假设您的文本框命名为 ip0、ip1、ip2、ip3：

```
$(document).ready( function() {
    $('#ip0,#ip1,#ip2').keydown( function(event) {
       var key = event.charCode || event.keyCode || 0;
       if (key == 190) {
           event.preventDefault();
           var i = Number(this.id.replace(/ip/,'')) +1;
           $('#ip'+i).focus();
       }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T20:42:06.543

```
textbox.onChange = function(){
   if(textbox.value[textbox.value.length-1] =='.'){
     textbox.value = textbox.value.substring(0,textbox.value.length-2);
     nextTextbox.focus();
   }
} 
```

我没有对此进行测试，但我认为这个总体思路有些内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T20:56:00.410

我宁愿使用一个“掩码”插件，比如这个：[http](http://digitalbush.com/projects/masked-input-plugin/)
://digitalbush.com/projects/masked-input-plugin/ 这会让你有机会给它一个漂亮的外观，仍然让你的访问者复制一个IP 并粘贴。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T20:48:40.553

你不能在盒子上捕捉到 onKeyPress 事件，如果字符匹配“。” 专注于下一个盒子？例如：

```
var dotCode = ".".charCodeAt( 0 );
$("box0").bind( "keypress", function( e ){ 
    if( e.keyCode === dotCode ){ $("box1").focus( ); }
});

// etc... 
```

# testing - 集成测试框架？

> ID：783422
> 
> 赞同：2
> 
> 时间：2009-04-23T20:38:35.693
> 
> 标签：testing, frameworks, automated-tests, black-box

我正在寻找一个测试框架来涵盖我们的黑盒集成测试。我们需要非开发人员可以编写脚本的东西（也不是 C# 单元测试类型的东西）。

我想到的最初场景是：

1.  恢复已知数据库
2.  运行 sql 代理作业 (ETL)
3.  针对输出数据库执行验证 sql 脚本

和

1.  运行 msi 安装
2.  检查文件夹/文件/RegKeys/Services/etc 的存在
3.  运行 msi 卸载

到目前为止，我还没有找到任何看起来合适的东西。我们将使用的主要是 UI 测试（Project White/etc），但不包括这些情况。或者基于单元测试框架的集成测试，我们还没有准备好推动我们的 QA 团队进行。

如果我找不到其他任何东西，我目前正在尝试为这部分测试滚动我们自己的内部工具。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T15:47:48.303

看起来你想运行一堆命令行参数，对吧？

好吧，我看到了两种方法：

1）您可以发明自己的领域特定语言。这是一种奇特的说法，即您编写了一个具有一些非常高级功能的解释器。非技术人员编写批处理文件之类的东西，您编写一些 C# 来读取文件，执行 switch 语句，然后运行命令。FIT 可能是最常用的方法——它是集成测试的框架。（这样做的方法是用逗号分隔事物：command,param1,param2。假装它是一个非常简单的汇编程序。然后你的 switch 语句接受 param1..paramx 并将它们粘贴在一个字符串数组中并将其传递给函数. 该函数处理数组。）

这样做的问题是您的客户会想要变量。他们会想要循环。很快，您就实现了一个完整的编程解释器，它以列格式读取数据。臭死了。

所以你可以...

2) 教你的客户一门脚本语言。我会研究 perl 和 test::more - 或者可能是一些 ruby​​ 测试的东西。

如果这不起作用，也许你可以......

3) 放弃让客户创建所有测试。相反，让工具匠与客户配对创建大纲，然后返回并将其转换为代码。

如果您使用的是浏览器，我建议您使用 selenium 或 watIR，但看起来您使用的是命令行方式。

给我发电子邮件 (matt.heusser@gmail.com) 或在我的博客 (xndev.blogspot.com) 上阅读有关测试框架的更多信息。我的博客是询问谷歌什么是测试框架的排名第二的搜索结果，所以我很乐意推荐它。:-)

问候，

--heusser

# html - 在 HTML 中包装表格数据

> ID：783423
> 
> 赞同：3
> 
> 时间：2009-04-23T20:38:39.827
> 
> 标签：html, perl, html-table

我有一些数据，其中包含一行标题和一行或多行要显示的值。目前，我正在使用 HTML 表格，但我遇到过这样的情况：我有这么多列，表格超出了屏幕的末端。或者某些列名太长（它们通常只是一个带有下划线作为空格的单词），即使没有那么多列，表格仍然会超出浏览器窗口的末尾。

我想要的是能够显示所有数据而不必水平滚动。即使这意味着将数据分解为多个表。

我目前正在使用 Embedded Perl，我使用的一个 hackish 解决方案是对每个表的 8 列进行硬编码，并在必要时在第一个表下启动一个新表。但理想情况下，我想要的是在一个表上动态放置尽可能多的列，并换行到新的行/表行/如有必要。

这可以仅通过 HTML/CSS 完成吗？或者我是否需要以某种方式计算每列将占用多少宽度，并以此为基础每个表的列数？我不必使用 HTML 表格，所以如果有更好的解决方案，我非常愿意使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T21:38:38.577

`table { display: inline; }`与每列一个表结合使用应该可以解决您的问题。运行它并在 Web 浏览器中加载输出。当您调整窗口大小时，不适合的列会下拉。`class`如果您不希望所有表都受到影响，您可能希望将 a与表一起使用。

```
#!/usr/bin/perl

use strict;
use warnings;

print "<html><head><style>table { display: inline }</style></head><body>";
for my $col (1 .. 100) {
    print "<table><tr><th>$col</th></tr>";
    for my $row (1 .. 10) {
        print "<tr><td>$row</td></tr>";
    }
    print "</table>";
}
print "</body></html>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T20:40:51.617

您可以做的是根据您拥有的列数为每列设置一个宽度。最好的解决方案是百分比宽度，因此表格宽度可以随着页面宽度的变化而变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T20:55:59.507

如果您制作多个表格，那么我假设您必须垂直向下滚动页面才能查看所有数据。

另一种解决方案可能是将表格包装在 div 中，在 div 上设置宽度，并将该 div 的溢出设置为滚动。这样整个页面不会水平滚动，但包含表格的 div 会有一个滚动条。

# javascript - 如何从调用的函数中引用包含事件的元素？

> ID：783434
> 
> 赞同：0
> 
> 时间：2009-04-23T20:41:50.833
> 
> 标签：javascript, dom-events, yui

如何从`fireAlert()`函数内部引用调用它的元素，而不必`this`通过链接作为参数传递？

```
<script type="text/javascript">

//function
function fireAlert(){
    alert();
}

</script>

<a href="javascript:;" onclick="fireAlert();">Fire</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T20:42:53.827

[使用jQuery](http://jquery.com)有更简单的方法，但没有它是这样的：

**更新：**请尝试以下 HTML/Javascript 代码。请注意我是如何在 window.onload 中附加 onclick 事件，而不是将其指定为元素的属性。

对于此示例，我将事件附加到页面中的所有锚标记，但您可以替换`getElementsByTagName`为`getElementById`特定的。

```
<html>
    <head>
        <script language="javascript">
        function fireAlert(e)
        {
            var whoCalled = e ? e.target : event.srcElement;

            alert(whoCalled.innerHTML);
        }
        window.onload=function()
        {
            var allHrefs = document.getElementsByTagName("a");
            for(i=0;i<allHrefs.length;i++)
            {
                allHrefs[i].onclick=fireAlert;
            }
        }
        </script>
    </head>
    <body>
        <a href="#">Hello #1</a>
        <a href="#">Hello #2</a>
        <a href="#">Hello #3</a>
        <a href="#">Hello #4</a>        
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T21:03:43.433

正如 Jose 所说，使用 jQuery 会很容易。

```
$(document).ready(function()
{
    $("a").click(function()
    {
        // this == the clicked element
    });
}); 
```

# entity-framework - 使用视图和存储过程的实体框架

> ID：783457
> 
> 赞同：2
> 
> 时间：2009-04-23T20:50:27.320
> 
> 标签：entity-framework, .net-3.5

我的数据库中有以下基本表结构（不允许更改）：

**地址**
(PK) AddressId
Line1
...

**Person**
(PK) PersonId
(FK) AddressId
FirstName
...

**学生**
(PK) StudentId
(FK) PersonId
StudentNumber
...

我想使用 Table-per-Type 方法将 Person 和 Student 组合成一个 Student 实体。但是，这些表不符合 EF 的限制，即子表（学生）必须具有 PK 和 FK 是同一列。与我的数据库不同，它们是单独的列。

我的下一个想法是创建一个视图并在视图之外创建一个实体。我创建了一个名为 StudentView 的视图，其中包含一个连接和所有列。然后我将此视图导入到 EF 模型中。在我尝试更新之前一切都很好。由于视图无法更新，我创建了 Insert/Update/Delete 存储过程并将它们绑定到我的 Student 实体中（我为所有 FK 关系做了额外的 sp 参数）。

但是，现在我收到以下错误：

> 错误 2027：如果 EntitySet 或 AssociationSet 包含函数映射，则 EntityContainer 中的所有相关实体和 AssociationSet 也必须定义函数映射。

我无法在任何地方找到很多关于此的信息。在我看来，这意味着如果一个实体使用存储过程，那么所有实体都使用存储过程（或者至少是所有被引用的实体，在我的情况下大致相当于所有实体）。但是，我从 EF 收到的其他错误消息一直是骗人的。

有谁知道如何解决这个问题？此外，任何关于如何在我的案例中使用 Table-per-Type 的建议（我认为这是不可能的）也会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T19:00:16.630

我想通了。事实证明这是因为我将一些关系设置为 0..1:1。似乎当这种情况发生时，任何具有这种关系类型的东西也必须使用存储过程。将关系设置回 0..1:* 解决了我的问题。

# entity-framework - 实体框架 + POCO

> ID：783458
> 
> 赞同：8
> 
> 时间：2009-04-23T20:50:32.297
> 
> 标签：entity-framework, fluent-nhibernate, structuremap, poco

我正在使用 MVVM 模式构建 WPF 应用程序。我们的堆栈如下所示：

SQL Server 2008 -> 实体框架

我们使用 StructureMap 进行依赖注入来注入我们的 DataFactory，它本质上为我们的 POCO 业务对象执行 CRUD。

ViewModel 将 DataFactory 用于 CRUD，而 xaml 是绑定到 POCO 中的属性的数据。

整个事情都很好，但我发现唯一有点烦人的是数据工厂。我们在选择时将 EF 对象中的每个属性复制到 POCO 中，而在更新/插入时则相反。

有没有办法像 Fluent 对 NHibernate 但使用实体框架一样自动化这个过程？

这是数据工厂中的示例插入方法：

```
public void InsertCustomer(ref Manager.Model.Customer businessObject)
{
    var mgr = new Manager.Data.PersonData.PersonContext();

    var person = new Manager.Data.PersonData.Person();
    var customer = new Manager.Data.PersonData.Customer();

    customer.Comments = businessObject.Comments;
    customer.Company = businessObject.Company;
    customer.IsBusiness = businessObject.IsBusiness;
    customer.IsCompleted = businessObject.IsCompleted;
    customer.ModifiedBy = "someone";
    customer.ModifiedOn = DateTime.Now;
    customer.CreatedBy = "someone";
    customer.CreatedOn = DateTime.Now;

    person.Customer.Add(customer);
    person.FirstName = businessObject.FirstName;
    person.LastName = businessObject.LastName;
    person.Birthday = businessObject.Birthday;
    person.CreatedBy = "someone";
    person.CreatedOn = DateTime.Now;
    person.Gender = businessObject.Gender;
    person.MiddleInitial = businessObject.MiddleInitial;
    person.ModifiedBy = "someone";
    person.ModifiedOn = DateTime.Now;
    person.Nickname = businessObject.Nickname;
    person.Picture = "";
    person.Suffix = businessObject.Suffix;
    person.Title = businessObject.Title;

    mgr.AddToPeople(person);
    mgr.SaveChanges();
} 
```

声明一些类会很好，就像 Fluent 那样：

```
public class CatMap : ClassMap<Cat>  
{  
  public CatMap()  
  {  
    Id(x => x.Id);  
    Map(x => x.Name)  
      .WithLengthOf(16)  
      .Not.Nullable();  
    Map(x => x.Sex);  
    References(x => x.Mate);  
    HasMany(x => x.Kittens);  
  }  
} 
```

最后我的插入方法看起来像这样：

```
public void InsertCustomer(ref Manager.Model.Customer businessObject)
{
    var mgr = new Manager.Data.PersonData.PersonContext();

    var person = new Manager.Data.PersonData.Person();
    var customer = new Manager.Data.PersonData.Customer();

    Something.Map(person, businessObject);
    Something.Map(customer, businessObject);  

    person.Customer.Add(customer);

    mgr.AddToPeople(newCustomer);
    mgr.SaveChanges();
} 
```

本质上，我将消除将数据从业务对象移动到实体框架工作对象的代码，这将在映射类中完成一次，并且不必为每个方法重复。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-01T19:43:33.857

你可以试试 Automapper，对我有用。

[http://www.codeplex.com/AutoMapper](http://www.codeplex.com/AutoMapper)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T06:05:39.230

虽然我不知道有一个数据映射器可以为 EF 做你想要的，但编写一个并不难。此外，由于定义映射是大部分工作，因此实际上并不比使用您列出的流畅接口映射更难。您只需创建一个具有多个映射函数的 Mapper 类，每个映射函数都包含您的映射逻辑。

一种可能有趣的想法是使您的地图函数扩展方法。您仍然会创建一个 Mapper 类，但每个映射方法看起来像

```
 public static Person MapToPerson(this Manager.Model.Customer bizObject)
    {
        Person person = new Person();
        // mapping logic
        return person;
    } 
```

由于 MapToPerson 方法是扩展方法，而不是真正的 bizObject 类上的方法，因此您不会破坏 POCO。但是，由于扩展方法的语法糖，您的 InsertCustomer 方法可能具有如下代码：

```
 Customer customer = bizObject.MapToCustomer();
    Person person = bizObject.MapToPerson(); 
```

# asp.net - 限制用户可以访问 ASP.NET 网站的计算机数量？

> ID：783459
> 
> 赞同：1
> 
> 时间：2009-04-23T20:51:10.063
> 
> 标签：asp.net, content-management, settings

我正在构建一个 ASP.NET 应用程序。其中一项要求是限制用户可以访问站点内容的不同计算机的数量（例如 5 台计算机）。它不一定是完美的，如果没有 IT 知识的普通用户将无法省略检查 - 解决方案将是 K.

我正在考虑一种获取用户机器指纹的方法（例如：MAC 和计算机名称的组合）。当然，用户将被告知检查他们的 MAC。但是，这很难做到，因为 HTTP 协议是无状态的。一种解决方案是使用 ActiveX。但它仅限于 Windows 系统，并且很容易通过安全检查（只需禁用 ActiveX，据我所知默认情况下禁用）。

正如我在谷歌上搜索的那样，这是一个很常见的问题，但是除了使用 ActiveX 之外没有其他解决方案。有没有人遇到过这种问题，并找到了一些好的解决方案？

用户可以在不同的网络中。这将是一个外联网应用程序，因此检查 IP 将不起作用（路由器和动态 IP）。

编辑：我想通过这样做来避免购买会员资格，然后将帐户数据分享给您所有的朋友。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T22:31:01.540

根据您的评论

> 这种要求的意义是避免用户在应用程序中注册、支付会员费用以及将帐户凭据提供给其他人。

要么像[RSA 硬件验证器那样昂贵且高度安全](http://www.rsa.com/node.aspx?id=1158)

-或者-

你改变了你的商业模式，让分享凭证变得没有吸引力。例如，由于成本 - 我不分享我的苹果或亚马逊信誉，因为我不想为他们的购买付款。另一个是拥有一个用户社区。没有人分享他们的 flickr 帐户，因为这些照片在艺术上是他们的，而且他们不希望任何人为了几美元而捣乱他们的东西。不鼓励共享，因为它是一个社区，而不仅仅是一个存储库。

但这些事情都不会阻止用户分享，但我敢肯定它发生的次数要少得多。

否则，您将自己限制在（尝试）被动监控滥用行为的机制中。并发下载过多、并发访问过多等。如果您的用户违反了您协议中的 t 和 c，那么您将暂停他们的帐户。但是你必须有非常明显的违规者，因为很容易出错。如果可以的话，这是一个应该避免的模式，因为你总是要追赶，总会有人骗你。

如果他们需要购买 RSA 设备来访问它，没有人会注册一个网站。这不是一个可行的消费者解决方案。

* * *

（原始答案）我认为您要查看的是使用客户端证书身份验证。本质上，您的用户在他们的计算机上安装了个人客户端证书，以便当他们连接到您的服务器时，您的服务器可以验证该计算机。

我不会告诉你这很容易，因为它看起来不像。您可能需要设置自己的证书服务器并快速搜索它，但没有一个是漂亮的。

也许，取决于操作系统，那里有一个功能，您可以创建一个特定于机器的证书，或者一个无法导出的证书。

这种事情通常用于服务器之间的安全连接，而不是通常用于您在客户端想要的东西。这将是帮助台的噩梦。

wiki [Transport Layer Security](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)或 windowssecurity.com[将客户端证书身份验证与 IIS 6.0 网站](http://www.windowsecurity.com/articles/Client-Certificate-Authentication-IIS6.html)或 msdn一起使用[构建安全的 ASP.NET 应用程序：身份验证、授权和安全通信](http://msdn.microsoft.com/en-us/library/aa302408.aspx)

您还可以使用[RSA 硬件身份验证器](http://www.rsa.com/node.aspx?id=1158)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T21:32:59.730

使用（跟踪）cookies？即使这将基于每个浏览器而不是基于每个机器，当然还需要用户启用持久性 cookie，但这可能就足够了吗？检查 cookie 是否存在并且不应该过期，如果存在，一切都很好而且花花公子 - 如果没有，添加它并在您的后端跟踪它......

通过 IP、网络或任何其他与网络相关的标准屏蔽访问，虽然当然有自己的问题，就像大多数没有固定 IP 的用户一样，或者如果是这样，通过 NAT 的恐怖与许多其他用户共享它，很可能应该是由发布防火墙而不是应用程序本身完成。

通过一个简单的网站从某人的计算机上获取指纹或任何识别信息几乎是不可能的（希望如此），而是需要用户安装本地应用程序或插件。

编辑：新添加的有关原因的信息清楚地表明，任何此类解决方案都会很烦人，并且需要额外的开发和维护成本。完全规避这种限制的需要的答案似乎是最好的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T20:58:20.357

如果在某个时间范围内限制足够好 - 即用户在一天、一周或一个月内只能使用五台不同的计算机，您可以随时检查 IP 地址。每次用户尝试访问您的网站时，您可以使用以下算法来查看是否应该允许访问：

1) 检查此用户帐户以前使用过哪些 IP 地址。是否有少于 5 个唯一 IP？是 => 3。否 => 2。

2) 已经存储了五个或更多 IP。其中至少有一个至少一天/一周/一个月大吗？是 => 3。否 => 4。

3) 没关系 - 存储的 IP 少于五个，或者至少一个太旧。删除任何太旧的，存储新的并进行身份验证。=> 5。

4) 不行 - 五个或更多 IP 已经在您的数据库中，而且还没有一个过期。不进行身份验证。=> 5

5) 结束

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T21:54:28.633

这是用于许可方案吗？如果是这样，这是我自互联网问世以来听到的最愚蠢的许可证之一。

这种许可证过去在桌面应用程序环境中有意义，但在基于 Web 的应用程序中没有意义。您的应用程序可能是这些用户使用的唯一具有这种行为方式的应用程序。这对你来说看起来不太好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T20:53:21.493

除非我们谈论限制所有在同一个 LAN 上的用户，否则为什么你不能只跟踪用户的 IP 地址，如果他们来自不在他们“列表”中的 IP 地址，那么你可以拒绝他们而不是认证？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T20:55:36.370

*   使用带有 MAC 过滤/IP 过滤的防火墙
*   应用程序中的 IP 白名单
*   Membership Provider 中“登录”用户的阈值

场景是什么，是面向公众的网站还是您要在私有 LAN 上内部托管的东西

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-23T20:59:18.810

只有5台特定的计算机吗？或者不超过 5 台同时运行的计算机？这不是一个完美的解决方案，但您可以分别在会话开始/结束时增加/减少计数器。

编辑：好的，在这种情况下，我可能会采用基于 cookie 的方法（同样不完美）。当 PC 连接时，在客户端计算机上存入一个 cookie，并在服务器上记录该 cookie。当#6 尝试连接时，阻止 cookie 并拒绝连接。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-04-23T21:24:40.140

我认为您应该考虑使用 WCF Web 服务和具有授权的自定义 WinForms/WPF 客户端。

# javascript - Javascript：获取 id 为 log_XXXX 的所有对象

> ID：783463
> 
> 赞同：13
> 
> 时间：2009-04-23T20:51:48.110
> 
> 标签：javascript

我需要获取 id 与特定模式匹配的所有对象。我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-23T20:54:55.047

当前浏览器：

```
// DOM collection as proper array
const matches = Array.from(document.querySelectorAll('[id^=log_]')); 
```

* * *

旧版浏览器：（IE9+）

```
// Use Array.prototype.slice to turn the DOM collection into a proper array
var matches = [].slice.call(document.querySelectorAll('[id^=log_]')); 
```

* * *

jQuery：

```
$('[id^=log_]') 
```

* * *

真正的旧浏览器，没有 jQuery：

```
var matches = [];
var elems = document.getElementsByTagName("*");
for (var i=0; i<elems.length; i++) {
  if (elems[i].id.indexOf("log_") == 0)
    matches.push(elems[i]);
}
//matches now is an array of all matching elements. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T21:01:41.503

好的，这是一个直接的 JavaScript 答案：

```
// a handy function to aid in filtering:
// takes an array and a function, returns another array containing
// only those elements for which f() returns true
function filter(a, f) 
{ 
  var ret = []; 
  for (var i=0; i<a.length; ++i) 
  {
    if ( f(a[i]) ) 
      ret.push(a[i]); 
  }
  return ret;
}

// this collects all elements in the current document
var elements = document.getElementsByTagName("*");

// and this filters out all but those that match our pattern
var logElements = filter(elements, function(el) 
  { return /log_/.test(el.id) } ); // simple expression 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-23T20:58:28.750

最好使用[JS 框架](http://en.wikipedia.org/wiki/JavaScript_framework)来完成此操作，因为它们具有高级 DOM 选择器功能，使您想做的事情变得非常容易。有很多可供选择，但更流行的是[jQuery](http://www.jquery.com)、[Prototype](http://prototypejs.org/)、[MooTools](http://mootools.net/)和[Dojo](http://www.dojotoolkit.org/)。

# visual-studio - Visual Studio 2008 - 自定义右键菜单

> ID：783464
> 
> 赞同：1
> 
> 时间：2009-04-23T20:52:22.713
> 
> 标签：visual-studio

有没有办法通过UI自定义VS2008中的右键菜单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T20:55:12.177

绝对地。

最简单的方法是录制宏，然后将其绑定到上下文菜单。

我发现[这篇](http://www.sharpregion.com/blog/?p=105)文章非常有帮助。

# java - 从 JVM 的 getRuntime.exec() 运行时找不到进程

> ID：783473
> 
> 赞同：4
> 
> 时间：2009-04-23T20:54:56.560
> 
> 标签：java

我正在尝试从 Eclipse 中运行以下代码：

```
Process process = Runtime.getRuntime().exec("gs"); 
```

但是我得到了例外：

> java.io.IOException：无法运行程序“gs”：错误=2，没有这样的文件或目录

从命令提示符 (OS X) 运行 gs 可以在任何目录中正常工作，因为它位于我的 PATH 上。似乎 eclipse 不知道我的路径环境变量，即使我已经进入运行配置并在环境选项卡上选择了 PATH 。

为了调试此问题，我尝试了以下代码：

```
Process process = Runtime.getRuntime().exec("echo $PATH");
InputStream fromStdout = process.getInputStream();
byte[] byteArray = IOUtils.toByteArray(fromStdout);
System.out.println(new String(byteArray)); 
```

输出是 $PATH，嗯。有人可以将我推向正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T21:07:45.000

你假设 exec() 使用 shell 来执行你的命令（echo $PATH 是一个 shell 命令）；为简单起见，您可以使用 System.getenv() 查看您的 $PATH：

```
 System.out.println(System.getenv("PATH")); 
```

## 编辑

Often a better and flexible alternative to Runtime.exec() is the [ProcessBuilder](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html) class.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-11T10:34:35.507

I had the same issue and i found the problem. The Path Variable in Eclipse had different content than the one from the command Line.

Solution:

Look up for the $Path variable in command Line and copy the content. Then open Run Configuration->Environment and select new. Name: $PATH Value: insert the copied content.

That solved the Problem.

# c - C 到 Fortran 调用问题

> ID：783477
> 
> 赞同：3
> 
> 时间：2009-04-23T20:55:40.927
> 
> 标签：c, visual-studio-2008, fortran

在带有 Intel Fortran 10.1 的 Windows 64 上使用 Visual Studio 9

我有一个调用 Fortran 的 C 函数，传递一个文字字符串“xxxxxx”（非空终止）和隐藏的传递长度 arg 6。

Fortran 正确，因为调试器识别出它是一个 character(6) var 并且具有正确的字符串，但是当我尝试为其分配另一个 Fortran character*6 var 时，我得到了最奇怪的错误。

> `forrtl: severe (408): fort: (4): Variable Vstring has substring ending point 6 which is greater than the variable length 6`

**-- C 调用 --**

```
SETPR("abcdef",6); 
```

**-- Fortran 子程序 --**

```
subroutine setpr(vstring)

character*(*) vstring

character*6 prd

prd(1:6) = vstring(1:6)

return

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T16:53:33.923

我使用英特尔 C 编译器和英特尔 Fortran 编译器进行了尝试。这在 C 中给出了，

```
#include <stdio.h>

int main(void)
{
    extern void test_f_(char*, int);

    test_f_("abcdef",6);
} 
```

并且，在 Fortran 中，

```
subroutine test_f(s)
    implicit none
    character*(*), intent(in) :: s

    character*6 :: c

    write (*,*) 'S is ', s
    write (*,*) 'Length of S is', len(s)

    c = s
    write (*,*) 'Implicit-copied C is ', c

    c(1:6) = s(1:6)
    write (*,*) 'Range-copied C is ', c
end subroutine test_f 
```

编译并运行时，它会产生

```
S is abcdef
Length of S is           6
Implicit-copied C is abcdef
Range-copied C is abcdef 
```

您在 C 例程中对 Fortran 例程类型的声明是什么？您确定 C 和 Fortran 代码之间的字符和整数变量的大小相同吗？

# serialization - 我需要一个 D 的序列化框架

> ID：783482
> 
> 赞同：5
> 
> 时间：2009-04-23T20:56:20.923
> 
> 标签：serialization, metaprogramming, rpc, d

我正在寻找一个[D](http://digitalmars.com/d/) *模板*库来获取任意变量并将其编组为可传输的包。变量可能是基本值类型 ( `int`, `char[]`, `real`) 或者可能是一个`struct`或`class`甚至可能包含或是一个引用类型。一个可以在没有任何类型帮助的情况下做到这一点的系统会很好，但我怀疑它的要求太多了，所以我会对使用轻量级注释的东西感到满意。

如果没有类似的关于如何构建的建议，那就太好了。我可以想到几种方法来进行消毒，但我不确定如何指定注释。

*背景：*在尝试使用 ASMX 和 WCF Web 服务并且不喜欢它们之后，我感觉我想尝试解决 RPC 问题。

*编辑：*顺便说一句，只要它是可移植的，我不太关心中间的格式是什么（XML、JASON、YAML、二进制）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T21:19:00.683

看看[谷歌协议缓冲区](http://code.google.com/intl/sv-SE/apis/protocolbuffers/)。也许您可以直接使用 C++ 或 C 绑定，或者自己编写 D 绑定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T02:12:54.970

这是我为 D 1.x 写的一个基本的。它是很久以前写的，所以也许可以改进它，但它*确实*有效。实际格式基本上是网络字节序二进制，因此存储和传输字节应该是安全的。

[http://gist.github.com/100885](http://gist.github.com/100885)

它不支持类或任意指针。*为了正确地*做到这一点，你需要一些能记住它已经序列化的引用的东西。如果你限制自己使用值类型、数组和 AA，它就可以完成这项工作。

如果您确实想将其扩展为支持类，我的建议是要求定义 toStream 和 fromStream 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T21:12:58.513

我建议您自己编写，因为它是一个有用的模板练习，可以帮助您调整序列化格式以适应您的特定要求。

您可能想查看 tools.serialize ( [http://dsource.org/projects/scrapple/browser/trunk/tools/tools/serialize.d](http://dsource.org/projects/scrapple/browser/trunk/tools/tools/serialize.d) ) 作为起点。

[编辑] 对不起！没想到是你！:D

# java - 对需要强制转换的 Java 泛型感到困惑

> ID：783486
> 
> 赞同：3
> 
> 时间：2009-04-23T20:57:13.573
> 
> 标签：java, generics, casting

我对以下代码感到困惑：

```
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

public class GenericsTest<T extends List> {

  public void foo() {
    T var = (T) new LinkedList();
  }

  public static void main(String[] args) {
      GenericsTest<ArrayList> gt1 = new GenericsTest<ArrayList>();
      gt1.foo();
      System.out.println("Done");
  }
} 
```

的运行时类型`T`似乎是`java.util.List`，无论我将什么类型参数传递给构造函数。

那么为什么编译器`T`在分配 var 时需要强制转换？它不应该在编译时知道`LinkedList`可分配给 List 吗？

我知道代码是伪造的，并且我理解为什么它在运行时工作，即使它看起来不应该。令我困惑的部分是为什么编译器要求我在赋值时输入 (T)？然而，它编译得非常好，没有虚假演员。

据推测，编译器理解擦除。似乎编译器也应该能够在没有强制转换的情况下编译代码。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-23T21:03:04.963

`LinkedList`可分配给`List`，但可能不可分配给`T`。

在某些方面，您的测试代码*不应该*工作 - 它只是因为强制转换被编译器有效地删除，因为在执行时无用（由于类型擦除）。它在编译时很有用，因为它要求您（开发人员）向编译器保证您正在做一些它无法检查的有效事情。碰巧的是，您所做的事情*是*无效的，但是编译器无法知道这一点，并且如果没有更多信息，也无法在执行时检查它。您可以提供该信息：

```
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

public class GenericsTest<T extends List> {

  Class<T> clazz;

  public GenericsTest(Class<T> clazz) {
    this.clazz = clazz;
  }

  public void foo() {
    T var = clazz.cast(new LinkedList());
  }

  public static void main(String[] args) {
    GenericsTest<ArrayList> gt1 = 
        new GenericsTest<ArrayList>(ArrayList.class);
    gt1.foo();
    System.out.println("Done");
  }
} 
```

现在这将失败并出现适当的异常 - 类型信息在执行时仍然可用，我们正在使用它以安全的方式执行转换。

请注意，如果您使用适当的警告进行编译，编译器会告诉您原始代码并没有真正检查任何内容。

有关此主题和许多其他主题的更多信息，请查看非常全面的[Java 泛型常见问题解答](http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-23T21:45:16.580

发帖人在评论中问道，

> 但是，大概编译器知道那为什么需要强制转换为 (T)。演员阵容有没有可能失败？

*这个*演员不会失败。但是编译器警告说，*这段*代码设置了一个定时炸弹，会在*其他地方*用`ClassCastException`.

在这个例子中，没有理由使用泛型，因为没有一个 API 使用类型变量`T`。看一个更现实的泛型应用。

```
 public class GenericsTest<T extends List> {

 3   public T foo() {
 4     T var = (T) new LinkedList();
 5     return var;
 6   }

 8   public static void main(String... argv) {
 9     GenericsTest<ArrayList> gt1 = new GenericsTest<ArrayList>();
10     gt1.foo();
11     System.out.println("Test one okay");
12     ArrayList<?> list = gt1.foo();
13     System.out.println("Test two okay");
14   }

   } 
```

A`ClassCastException`在第 12 行被抛出`ClassCastException`，没有演员表？调用代码完全正确。无效的转换，即错误，位于被调用方法的第 4 行。但例外是在遥远的某个时间和地点提出的。

Java 泛型的目的是确保代码是类型安全的。如果*所有*代码都在没有“未检查”警告的情况下编译，则保证不会`ClassCastException`在运行时引发。但是，如果您依赖的库被错误地编写，就像这个例子一样，承诺就会被打破。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T20:59:36.360

那是因为[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)；在编译时，泛型参数变成它的下限。

编译器试图告诉你出了点问题。如果它做了你认为应该做的事情，你会得到一个`ClassCastException`——你不能将 a`LinkedList`转换为`ArrayList`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T20:59:32.493

我以为你来自 C#？在这种情况下，Java 泛型不是 C# 泛型。

当您提供泛型类型参数时，Java 不会生成强类型类，它只是使用适用于所有可能提供的泛型类型参数组合的最不常见的命名类型。

因此，在这种情况下，`List`由于您指定了`extends List`.

# java - Pylons 或 TurboGears 与 .NET 或 Java

> ID：783488
> 
> 赞同：4
> 
> 时间：2009-04-23T20:57:23.527
> 
> 标签：java, python, jakarta-ee, pylons, wsgi

我们正在为客户开展一个项目。他们计划在今年年底前拥有大约 5 万用户。我们正在推动使用带有 Mako 和 SQLAlchemy 的 Pylons，我们在那里的联系人对此很兴奋，但他的一些同事很谨慎，因为它不是 .NET 或 J2ee（他们习惯于企业化的东西）。

他们的网络应用程序将有一些我们将卸载的数据分析以及一些社交网络功能。（到目前为止，他们基本上只有一些用于 UX 的 Flex 模型）

我正在寻找一些关于开发时间的证据，或者其他有助于我们的论点让客户放心的原因。

另一种选择是我们在找错树并且不知道。我希望不是这样。

任何对案例研究或诸如此类的参考都会很好。我能找到的最好的是

[http://www.oracle.com/technology/pub/articles/rubio-python-turbogears.html](http://www.oracle.com/technology/pub/articles/rubio-python-turbogears.html)

和

[http://www.oracle.com/technology/pub/articles/devlin-python-oracle.html](http://www.oracle.com/technology/pub/articles/devlin-python-oracle.html)

有点过时了（对于 TG2 和诸如此类的东西）

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T03:37:22.693

如果您正在为客户寻找成功案例，[Virgin Charter](http://virgincharter.com/)正在为他们的网站使用 Pylons 和 SQLAlchemy。这是一个高价值的交易系统，因为人们通过该网站预订非常昂贵的航班。

对于更高流量的网站，Reddit 现在与[Charlie Rose](http://www.charlierose.com/)一起在 Pylons 上运行。

SQLAlchemy 和 Mako 都是由 Mike Bayer（一位资深的 Java 程序员）设计的，SQLAlchemy 基于 Hibernate 的优点，并具有与 Hibernate 支持相同的强大原理和模式。

如果他们对部署他们不熟悉的东西持谨慎态度，那么 Pylons 可以在 Jython 上运行，而最新的 SQLAlchemy（0.6 分支）也即将在 Jython 上准备就绪。这将允许您将完整的 Pylons 应用程序打包到一个 WAR 文件中以进行部署，这将确保它们的 Java 类型。

对于一般的 Python，请考虑指出所有使用它的大型动画工作室，以及 S.Lott 指出的其他各种来源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T21:03:33.933

构建一个快速的概念证明服务来展示它是多么的干净和简单，这几乎更容易。

一个简单的 SQLAlchemy 映射，带有查询处理的快速演示。

一个简单的模板，展示了 Mako 的酷炫程度。

一个简单的 Pylons 应用程序将两者结合在一起。

最重要的是——使用他们的应用程序和他们的数据。不是一个蹩脚的你好世界；不是现有的教程。

如果他们想将您的应用程序的简洁、优雅的演示与 .NET 和 J2EE 进行比较，他们会发现其他语言会导致更大的代码库。

* * *

**编辑**

给他们看这个： http: [//python.org/about/success/](http://python.org/about/success/)

此外，最好的 Python 演示之一是以 SQLAlchemy 和 Django 教程的方式做事——在`>>>`提示符下使用交互式 python。没有什么比编程更令人兴奋的了，编程如此简单，您可以交互式地完成它。

你不会找到很多令人信服的案例研究。Python 是一个社区。.Net 和 J2EE 是产品。.Net 有微软的广告支持它；微软有能力对其产品进行广泛的调查和研究。Sun（即将成为 Oracle）和 J2EE 也是如此——大量的营销炒作支持他们的主张。

Python 仅包含 Python.org 站点 ( [http://python.org/about/](http://python.org/about/) ) 上的内容。各种相关项目（Pylons、Mako 和 SQLAlchemy）没有丰富的案例研究白皮书。他们确实有大量的下载量和大量的口口相传。

但是，如果有人正在寻找 Python 比 .Net 工作得更好的“证据”，那就不会有太多了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-04T18:52:04.173

如果他们想使用 j2ee imho，他们会很疯狂。Visual Studio/C# 非常好，特别是如果您不想做任何棘手的事情。但是，如果您想自定义 C# 的处理方式，超出其明确设计的范围，那么它很快就会变得一团糟——您会陷入自动生成的 XML 配置文件等。当然，我也认为带有 SQLAlchemy 的 Pylons 可能会变得一团糟，因为它们也会生成太多东西，最终你可能不得不重新配置。如果您想要完全控制，我建议您使用侵入性较小的环境，例如 Werkzueg。 [请阅读我关于在没有无形支持的情况下编写 MVC 的文章。](http://aaron.oirt.rutgers.edu/myapp/docs/W1100_1200.wwiki)

# wpf - 有什么方法可以提取底层 Xaml？

> ID：783497
> 
> 赞同：2
> 
> 时间：2009-04-23T20:58:37.580
> 
> 标签：wpf, silverlight, xaml, runtime

无论如何从控件中提取底层xaml。

IE。我有一个名为 fooBox 的文本框。我可以在运行时从代表文本框的文本框中取回 xaml 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T21:04:21.997

这向您展示了完整的生命周期（从控制到 XAML 再到控制）。如你看到的，

```
string s = XamlWriter.Save(value); 
```

是您可能关心的有趣部分。

```
 /// <summary>
    /// Clones a given UIElement.  Please note that any events, animations, etc
    /// on the source item may not carry over to the cloned object.
    /// </summary>
    /// <param name="value">UIElement to clone.</param>
    /// <returns>A shallow clone of the source element.</returns>
    public static UIElement CloneUIElement(UIElement value)
    {
        if (value == null)
        {
            return null;
        }

        string s = XamlWriter.Save(value);
        StringReader stringReader = new StringReader(s);
        XmlReader xmlReader = XmlTextReader.Create(stringReader, new XmlReaderSettings());
        return (UIElement)XamlReader.Load(xmlReader);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-15T18:45:48.423

对于 Silverlight，我遇到了 Rob Relyea 的[这篇博客文章](http://blogs.windowsclient.net/rob_relyea/archive/2010/07/29/xamlwriter-save-for-silverlight.aspx)，其中提到了David Poll 创建的[Silverlight xaml 序列化程序。](http://www.davidpoll.com/2010/07/25/to-xaml-with-love-an-experiment-with-xaml-serialization-in-silverlight/)对大卫·波尔表示极大的敬意。（[下载页面](http://www.davidpoll.com/downloads-and-samples/#SLaB)）。

用法

```
UiXamlSerializer uxs = new UiXamlSerializer();
string text = uxs.Serialize(this.gridToSerialize); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T21:03:09.783

是的 - Josh Smith 在他的 Mole 工具中执行此操作：http: [//www.codeproject.com/KB/WPF/MoleForWPF.aspx](http://www.codeproject.com/KB/WPF/MoleForWPF.aspx)

# silverlight - 自定义 Silverlight 闪屏

> ID：783504
> 
> 赞同：3
> 
> 时间：2009-04-23T21:00:29.293
> 
> 标签：silverlight, splash-screen

有没有人创建了自定义 Silverlight 闪屏来替换蓝球循环进度？

有没有人有样品或最好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T21:29:59.377

看看这个如何： -

[如何：定义一个简单的 Silverlight 启动画面](http://msdn.microsoft.com/en-us/library/cc903962(VS.95).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-15T13:00:59.407

这看起来也很有用

[C# 2008 中的 Pro Silverlight 2（Google 图书预览）](http://books.google.com/books?id=mY2YWBC_M-8C&pg=PA171&lpg=PA171&dq=silverlight+splash&source=bl&ots=T1D8WMvi9v&sig=3z93sqcaWG5ltoSA2WXdUdBdtmM&hl=en&ei=QUU2SozLO9OL_Aaps8CBCw&sa=X&oi=book_result&ct=result&resnum=18#PPA172,M1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T10:52:42.810

在 CodePlex[链接文本上查看这个项目](http://www.codeplex.com/SilverlightLoader)

# c# - VB.NET 开发人员的好奇心不强吗？VB.NET 上的标准化

> ID：783512
> 
> 赞同：9
> 
> 时间：2009-04-23T21:02:52.967
> 
> 标签：c#, .net, vb.net

我是在为一家拥有 70% 到 75% 的 VB.NET 开发人员社区的公司工作的人问这个问题的。我想说 80% 的开发人员不知道 OOD 模式是什么。我想知道这是否对我公司发展努力的健康是最好的？

我正在查看标签计数：
[https](https://stackoverflow.com/tags)
://stackoverflow.com/tags 目前有：
12175 .NET 问题
18630 C# 问题
2067 VB.NET 问题

检查亚马逊，似乎有：
51 C# Wrox 书籍
21 VB.NET Wrox 书籍

在 CodePlex 上有：
979 个项目标记为 C#
136 个项目标记为 VB.NET

如果您想成为 VB.NET 开发人员，那么可以学习的材料肯定更少。公司在 VB.NET 上进行标准化和雇佣 VB.NET 开发人员有什么优势？微软如何回答这个问题？

是仅有的两个论点：

1.  我们有这些 VB6 程序员，让他们舒服
2.  XML 文字

如果您为一家在 VB.NET 上完全标准化的公司工作，您能否发布一个答案来解释他们做出该选择的实际或技术原因？

**更新：**
更多统计数据 - O'Reilly Radar
[2008 年计算机图书市场状况，第 4 部分——语言](http://radar.oreilly.com/2009/02/state-of-the-computer-book-mar-22.html)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-23T21:08:18.853

我们在 VB.Net 上没有标准化，我经常不得不在 VB.Net 和 C# 之间来回走动。我不寻常，因为我来自 C/C++ 背景，知道 C#，但实际上更喜欢 VB.Net（我非常不喜欢 vb6/vbscript）。

我之所以这么说是因为重要的是要记住 VB6 不是 VB.Net。这是一门全新的语言，IMO 确实值得站在 C# 旁边。我*真的很讨厌*vb6，但我几乎立刻就爱上了 VB.Net。然而，VB.Net 确实继承了 VB6 的一些东西，而不仅仅是语法风格。我说的是声誉，这并不完全应得。但我也在谈论帮助创造这种声誉的开发人员基础。这似乎是你正在经历的一部分。

考虑到这一点，您似乎主要根据受欢迎程度来判断语言。并不是说这有什么问题。更容易找到样本和社区支持的能力有很多话要说。但至少让我们称它为它是什么。如果这是您的衡量标准，那么 VB.Net 肯定有*足够的*支持使其可行，而且利用 C# 示例并不难。

此外，我们仍然在我工作的 .Net 2.0 上。对于 2.0，我绝对更喜欢 VB.Net。我更喜欢它的语法，而且我喜欢它在 C# 上做一些其他事情的方式。但我在家里玩 Visual Studio 2008。在 2008 年，我真的更喜欢 C# lambda 表达式语法。

关于你的两个论点：

*   对于#1，[这可能不是一个好主意](https://stackoverflow.com/questions/507291/should-we-select-vb-net-or-c-when-upgrading-our-legacy-apps/507309#507309)，尽管我怀疑这是许多商店的主要原因。
*   对于 #2，我*从未*使用过 Xml 文字。它们看起来不错，但没有那么实用。

* * *

我想补充一点：似乎最近的一些 C# 特性实际上是为了让 C# 更像 VB。静态类填充了 vb 模块的概念空间。`var`关键字使变量声明看起来更 VB 的暗淡。即将推出的 dynamic 关键字将允许 vb 样式的后期绑定。甚至可以说在 1.0 中“添加”到 c# 中的属性也是 vb 在 .Net 之前就有的东西。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-27T19:58:19.937

作为一名 VB.NET 开发人员，我不喜欢 C#，因为我的经验来自阅读 C#，而不是写得太多：

1）不编辑并继续。我已经看到有人认为“编辑并继续”是一件坏事，并且会鼓励不良的编码习惯。这让我想起了 25 年前我的项目经理告诉我，我对当时的高级调试器的热爱是“拐杖”，它鼓励了不良的编程习惯。对不起，我当时没买，现在不买了。至少，利大于弊 10:1。一旦 C# 获得了这个特性，你会更加感激它，如果你不得不再次在没有它的情况下编写代码，你会非常感激它。

2) 语言区分大小写。恕我直言，这是纯粹的邪恶。人们会同意在同一范围内有两个仅因情况而异的变量是不好的吗？如果是这样，为什么允许它？呸。

3) 后台编译和更好的设计时错误反馈。喜忧参半，因为这会减慢 IDE。但在 2008 年，性能更好，可能会节省时间。当然，这不是语言本身的因素，只是开发环境。

4) 大括号 {}{}。让我想起了我的 LISP 日子，在那里你可以将 LISP 程序员与其他程序员区分开来：他们是那些用手指在屏幕上试图匹配括号的人。

我发现下面的 VB 代码更容易阅读并且不太可能包含错误。

```
If condition1 then
  truestatement1
  truestatement2
else
  falsestatement1
  falsetatement2
end if

If (condition1) then {
  truestatement1;
  truestatement2;
  } //if (cond)
else
  {
  falsestatement1;
  falsetatement2;
  } //else (Condition) 
```

所有那些缺少自动缩进的大括号只是在乞求编译时或运行时错误。随着嵌套的 if 变得复杂，大括号只是添加到它上面。代替 C# 示例中的 4 个大括号，VB 代码只有一个 END IF 语句，但是注释的 C# 程序员喜欢添加可选注释，说明大括号是结束括号的块是终止的。

VB 代码是自我记录的，输入更少——当您在 IF 条件行中输入时，IDE 甚至会为您添加 END IF。所以，最后，我错过了 C#-aficionados 声称的简洁/好处。`}`可能比 更简洁，`End If`但我建议整体结构不必要地复杂。

当然，这一切都不是什么大不了的事，但作为一个新手 C# 编码器，我觉得弄乱嵌套条件比使用 VB 容易得多。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-23T21:06:25.580

我敢肯定，大多数情况下，公司使用 VB.NET 的原因正是您所提到的 - 组织中大量使用 VB6，无论是在代码库还是开发人员方面。请记住，ASP 网站和 VB6 应用程序可以轻松迁移到 VB.NET。VB6 到 C# 是另一回事。

话虽如此，在使用过 VB.NET 的公司工作过，在做事方式和开发人员习惯于阅读 C# 中的示例、书籍等方面几乎没有什么*区别*。将 C# 代码转换为 VB.NET 并不难，尤其是在您不进行复制粘贴的情况下。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-23T21:22:47.913

要学习成为优秀的 VB.NET 程序员，您不需要从 VB.NET 资源中学习，从 C# 资源中学习是非常好的。如果您甚至不能将 C# 代码转换为 VB.NET，那么您无论如何都会遇到更大的问题。

由于您刚才所说的内容，几乎所有体面的+ VB.NET程序员都可以阅读和体面地编写C#，否则您将无法轻松学习新东西。

最后，废话的人不是废话，因为他们是 VB.NET 程序员，那只是 VB.NET 易于编码，这不是一件坏事！也有人说这些人大多来自经典的 ASP 和 VB6 背景，这也是入门门槛非常低的语言。一周后，任何体面的计算机用户都可以使用这些语言进行编码。但大多数 C# 开发人员来自 Java 和 C/C++ 背景。特别是Java方面有很多OO。毕竟尤其是C不好学，大部分人不是在学校学的，就是长期学的，或者是从一堆书上学的。

当谈到公司使用 VB.NET 的原因时，主要是因为遗留问题。还有一些从 VB6 跳出 .NET 1.0 的公司认为 VB.NET 将成为主要语言，几年后结果证明这是一个大错误。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-23T21:19:29.310

不是在寻找争论，而是作为一个老 VB.NET 粉丝：

3\. `With`语句、`Handles`语句、`Module`语句、XML 文字、不区分大小写...
4 . `My`命名空间，`Microsoft.VisualBasic`命名空间，所有的“糖衣”
5。后期绑定支持和 COM 组件的互操作性
6．Ermmmm .....（手指交叉）可读性？

如前所述，我并不是要争辩，我是 C# 的忠实粉丝，只是在公司中有更多的 VB6 程序员来标准化 VB。

例如，如果您在 C# 中进行标准化并且您的业务依赖于许多 COM 组件，那么 COM 互操作性很容易成为“阻碍”...

并且提到的糖衣支持相当大（我一直想念他们编写 C# 代码）。我觉得 VB.NET 团队比 C# 团队提供更多的工具支持，而 C# 团队将精力集中在更多语言功能上。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-23T21:35:49.050

我目前正在与一位正在对 VB.NET 进行标准化的客户合作。
正如您所提到的，主要原因是大多数员工都有 10 年以上的 VB 和 COM 经验。
他们认为，将 VB.NET 作为职业道路是最有意义的，尽管他们很清楚他们现有的知识库中只有很少一部分可以在未来得到利用。
鉴于这一事实，他们还考虑转向 C#，这确实似乎是当今 .NET 平台上使用最多的语言。然而，考虑到他们必须学习大量新知识才能开始使用 .NET，他们更愿意选择具有熟悉的语法的语言。

在我看来，这恰恰证明了 VB.NET 的目的。那是为了帮助将世界上大量的 VB 开发人员带到 .NET，使他们能够使用他们“感觉”熟悉的语言。
此外，VB.NET 中内置的向后兼容层使得可以将用 VB 编写的现有（大型）应用程序一次移植到一个新平台，同时保持它们运行。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-23T21:46:08.120

我必须继续使用 VB.net 的唯一论点是：

1.  **我讨厌区分大小写的语言（比如 C#）**

这很愚蠢，创建区分大小写的语言后的第一件事就是创建最佳实践“永远不要使用不同大小写的相同变量名”

我知道他们想复制 Java 区分大小写，但这确实是一个愚蠢的决定。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-23T21:08:06.200

回复第 1 点：

好吧，我的商店是一个 VB6 的房子 - 有**很多**VB6 代码需要支持，我们直接转向 C# 没有任何问题。我们确实必须考虑这个决定，但我 100%（或更多）相信我们做出了正确的选择。

关于第 2 点：

你会惊讶于我每天都不需要这么多;-p

我没有*反对*VB.NET - 我只是觉得 C# 让我可以更优雅地完成我的工作。

重新阅读书籍等 - 我想知道是否没有一群前 VB6 开发人员仍在 VS2008 中编写 VB6。切换到 C#**确实**帮助我欣赏新的（当时）.NET 架构。如果我迁移到 VB.NET，我认为我不会做出那种精神上的飞跃——至少在一段时间内是这样。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-04-24T13:59:40.917

这与问题无关，但与对问题的评论有关

阅读此评论让我想起了 70 年代和 80 年代，当我读到人们使用任何高级编程与汇编时。与使用诸如... C 之类的高级语言的人相比，汇编程序员具有“精英”地位！

那时它是胡扯，现在它仍然是胡扯，因为它是 C# vs VB.NET。

有经验的程序员喜欢使用 C#，因为它简洁。少了该死的打字。我很少看到他们尝试增加你必须做的打字量的新语言。C# 也不例外。

但是……这有问题。可维护性问题。语言越简洁，回溯 5 年、10 年后越难读懂你在做什么。这就是我使用 VB.NET 而不是 C# 或其他 C 风格语言的原因。在你破坏我成为 VB 程序员的想法之前，我会用 C++ 维护各种历史航天器的软件模拟。我广泛使用这两种风格。

现在它不是一个戏剧性的差异。但是将经验丰富的程序员与许多人对他们最喜欢的语言的宗教依恋结合起来，难怪会出现像 Tyndall 这样的问题。

QuickBASC/PDS/Visual Basic 系列语言继续为 Microsoft 销售，因为它们并不简洁。因为它们更具可读性。尽管此功能对许多有经验的程序员没有吸引力，但它确实吸引了许多刚起步的程序员。结合宗教依恋，许多人朝着他们的工具发展，他们在整个职业生涯中都坚持使用它。此外，Visual BASIC 具有一种吸引许多人的民粹主义氛围。

像大多数具有民粹主义吸引力的东西一样，精英们都看不起。相反，它为该语言提供了很多用户。因此，它不太可能很快被微软砍掉。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-23T21:50:48.873

我敢肯定有更多的 VB.NET 开发人员购买书籍来学习 C#，反之亦然。他们知道，如果他们换了，他们会得到更多的尊重（无论是否合理）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-08-27T16:59:19.650

[Paul Vick](http://www.panopticoncentral.net/)，当时是 VB.NET 的语言架构师，在 2008 年写了这篇文章。

> 我们的用户 [VB 开发人员] 从第一次使用编程工具的人到构建大型商业应用程序的行业资深人士，应有尽有。设计一个吸引 Visual Basic 开发人员的框架的关键是专注于让他们以最少的麻烦和麻烦来完成工作......使用最少数量概念的框架是一个好主意 [对于 VB。 NET 开发人员] 不是因为 VB 开发人员不能处理概念，而是因为必须停下来思考与手头任务无关的概念会中断工作流。Visual Basic 开发人员的目标通常不是学习一些有趣或令人兴奋的新概念……而是完成工作并继续前进。

来自 。[NET Framework 设计指南](https://rads.stackoverflow.com/amzn/click/com/0321545613)第 2 版第 10 页。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-23T21:36:09.970

是的，C# 书籍比较多，C# 社区也比较活跃，但同时两种语言使用相同的框架，并且具有几乎相同的功能，这意味着 VB.NET 程序员可以拿起 C# 书籍并理解如果他知道 C# 语法（这与许多其他语言的语法很接近），那是没有问题的。

归根结底，选择一种语言胜过另一种语言并没有太大的优势。由于您提到的原因，如果您的团队没有偏好，我会选择 C#，但如果大多数人来自 VB6 背景，我认为选择 VB 语言没有问题。

这就是在我的组织中发生的事情。我们的大部分软件之前都是用 VB6 编写的，所以他们决定使用团队已经熟悉的语法，我对此没有意见。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-23T21:54:11.893

我在一家拥有现有 ASP/VB6 代码库的小公司工作，该代码库由几个不同的开发人员构建，每个开发人员都有自己的“印章”。

像许多人一样，BASIC 是我在 80 年代初的第一门语言，但我“毕业”到了汇编（6502 和 x86），并且已经在许多语言中徘徊，我希望在 C/C++ 方面具有优势（尽管我总是有更多学习）。我是一个非常“适合工作的工具”的人，所以我什至学习（并且学会了讨厌）VB，从 3 到 6 和 VBScript。

当公司被收购时，我相当容易地学会了 C#，并且正在慢慢地将我破旧的旧代码库转换为 C#。$corporate_owner 已在 VB.Net 上标准化。让我对 VB 发疯的事情与其他人喜欢的事情相同，即所有的语法糖（过度冗长）。

Jeff 之前写过的“真正的”程序员也讨厌 VB。

总而言之，VB.net 并不“酷”。但是，它确实有很多优点（语法糖、熟悉度、易于学习）；我知道至少有一所大学将 VB.net 课程作为其所需的 CS 和 CIS 课程的一部分。

无论如何，由于它的易用性和相对简单的升级路径，我认为它不会很快消失。至少它不像以前那样脑残了。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-23T22:33:14.780

我想你会发现它不是语言，而是使用它的人。强迫这些人使用 C# 并不能解决核心问题。

但是，如果您使用 C# 进行编程，那么如果他们将其作为现有技能，那么您下次雇用时更有可能获得更好的程序员类别。（这并不是说没有优秀的 VB.net 程序员，因为我认识一些优秀的 VB.Net 程序员。甚至所有 C# 程序员都很棒。）

然而，根据我的经验，技术较差的程序员往往会坚持使用 VB 和 VB.Net，甚至不想看 C# 或任何其他语言外的 VB/VB.Net

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-23T21:08:34.420

我认为这更多地与 VB.NET 和 C# 刚开始时所吸引的潜在目标受众有关。

在引擎盖下，它都是一样的（大部分情况下），但 .NET Winforms/Websites 等......你可以在 VB.NET 中做什么，你可以在 C# 中做什么，反之亦然。所以这个问题在功能方面并不真正相关

完全主观的意见，但我想说任何加入 VB.NET 潮流的人都来自 VB6/Classic ASP 的背景。然而，加入 C# 潮流的能力扩展到具有 Java/C++/其他 OO 背景的人。

所以从一开始，你就有一个更大的社区使用 C#，有更多的教育者/贡献者/开源项目在该语言下是有道理的

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-23T21:10:42.543

在我的工作场所，直到最近，VB.NET 还是标准，因为之前的一些开发人员来自经典的 ASP 背景并熟悉 VB 语法。随着我们的开发团队日趋成熟，并且我们采用了更复杂的设计方法（DDD，良好的 OOD），自然而然地转向使用 C#。

在大多数情况下，我猜想使用 VB.Net 的商店是一种务实的选择，而不是一种技术选择。话虽如此，VB.Net 确实是一种比它的前辈更强大的语言——它只是缺乏 C# 的一些优雅，而且正如您所发现的那样，在 web 上有更多与 C# 开发相关的材料。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-23T22:19:19.337

在 .NET 出现后维持现有的 VB6 代码多年后，我现在才切换到 .NET。我相信我有理由认为自己是 VB6 专家。我现在的雇主是在 VB.NET 上标准化的。

由于多种原因，我发现我有一些空闲时间来学习新语言。我正在使用一本包含所有代码的 ASP.NET 书籍，当我在 VB 中输入时，我正在努力阅读 C#。我已经看到了一些事情一种语言比另一种语言“更好”（主观调用......），双向。

到目前为止，我的感觉是，当我完成这个过程时，我将能够以合理的舒适度来回走动。我当然不会好奇——如果我是，我会在这里吗？

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-07-10T10:59:07.453

这里已经有很多好的答案，但我对最初的问题的看法是，真正需要回答的不是人们为什么坚持使用 VB.NET，而是是什么让 C#.NET 成为 .NET 书籍的首选语言，样本和工具集？

我认为这里有三件事在起作用：

**1.**第一批进入 C#.NET 的人天生好奇——这就是为什么他们选择新语言而不是坚持有趣的东西。所以是的，一开始确实引起了更多好奇的人;D

**2.** C#.NET 是微软吸引 Java 程序员进入 .NET 世界的一种方式，而且效果很好。.NET 中许多最好的想法都是从 Java 移植过来的，因此首先移植到 C#.NET 中。它们只有在成为主流之后才会出现在 VB.NET 中。有关C#.NET 如何被视为对 Microsoft 未能拥有自己的 Java 版本的反应，请参阅[这篇文章。](http://www.extremetech.com/print_article2/0,1217,a%253D1616,00.asp)

对此的一种反应是：

> “我不是 MS 程序员，但如果我被迫从 Java 搬到那里，我知道现在他们拥有 C#，我不会完全迷失和无用。”

**3.** VB.NET 程序员和其他程序员一样聪明和好奇，所以当他们看到一本涉及某个主题的 C#.NET 书籍时，他们会购买并把他们需要知道的东西转换成 VB.NET——甚至只需在他们的 VB.NET 项目中的单独的 C#.NET DLL 中实现它。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-07-10T11:46:01.067

在我看来，编程语言不是贵公司的主要问题。如果我在贵公司工作，我会优先考虑让那些不知道 OOD 模式是什么的 80% 的人了解情况。

好代码就是好代码，无论是用 C# 还是 VB.NET 编写的。

# mysql - 以编程方式监控 MySQL？SNMP？

> ID：783522
> 
> 赞同：3
> 
> 时间：2009-04-23T21:05:46.020
> 
> 标签：mysql, snmp

我被要求看看我们是否可以以某种方式监控 mysql 服务器的“健康”。提议是可能有 snmp 支持（这是针对版本 5.0.x）。我无法找到关于它的明确信息 - 参考链接会很棒。

真正的问题是获取有关 mysql 的“健康”或状态的定期信息。我们可以编写自己的站点并主动与之对话的进程，然后将其发布到我们的 GUI（GUI 现在不与 mysql 对话）。

有没有一种简单的机制可以使用，或者当一个人对 mysql 的内容不感兴趣，但只想知道它的状态是什么时的其他最佳实践？（向上、向下、可用、其他等）

gui 应用程序是 java，我们其余的东西是 java 和 c++ 的混合

我不是在寻找第三方解决方案 - 只是想知道 mysql 是否“发布”snmp 数据供其他人使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T15:50:01.107

我认为 MySQL Enterprise Monitor 中有一个可用的 SNMP 代理，但这当然是针对商业版本的。还有其他几个可用的商业 snmp 代理。

有一个用于 MYSQL 的 C API，可用于您可能感兴趣的许多监视任务：mysql_ping、mysql_sqlstate 等。既然您提到您使用的是 C++，这可能是一个选项。

查看[MySQL C API](http://dev.mysql.com/doc/refman/6.0/en/c.html)以获得完整的文档。

也就是说，您还可以使用 SQL 语句获取一些可用的状态信息：“SHOW PROCESSLIST”、“SHOW SLAVE STATUS”等。

您可以在[SHOW Syntax中找到有关此的文档](http://dev.mysql.com/doc/refman/6.0/en/show.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T21:07:30.587

这可能会有所帮助：[MySQL 活动报告](http://gert.sos.be/en/)

没有看到您希望将其发布到您的 GUI 应用程序。不过，如果您的应用程序可以显示图像，您可以只加载 MySQL AR 输出的图像......

# macos - Mac OS X 中的加密卷自动挂载

> ID：783523
> 
> 赞同：7
> 
> 时间：2009-04-23T21:06:01.870
> 
> 标签：macos, encryption, diskimage

我需要在我的 Mac 上为公司源代码创建一个加密卷。要求不是很严格：如果有人能以我的身份登录机器，他们就赢了，否则就输了。有了这组要求，您可以使磁盘在登录时自动挂载。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-23T21:52:12.943

跟着这些步骤：

1.  打开磁盘工具并单击“新图像”按钮。您希望使用 128 位 AES 加密创建一个新的基于 GUID 分区图、不区分大小写、日志式 HFS 稀疏图像。告诉它你想要一个 10 GB 的图像（应该足够了）。给它一个名字并将它保存在你的主目录中。给它你想要的任何密码，并告诉它将该密码存储在钥匙串中。
2.  打开系统偏好设置、帐户，然后选择登录项并添加一个条目以在登录时打开磁盘映像：只需将磁盘映像拖到登录项列表中即可。由于您将磁盘映像的密码保存在钥匙串中，因此在挂载之前不会询问您。这是设计使然。

没有您的登录凭据，其他人都无法打开钥匙串（默认情况下，登录钥匙串的密码与您的帐户相同）。在不破坏您的帐户、钥匙串或卷上的密码的情况下，没有其他人可以挂载卷。

如果有人盗用您的机器并使用 Mac OS X 安装 DVD 更改密码，您仍然受到保护，因为钥匙串密码不会更改并且磁盘将不再自动挂载。

此技术不会使您的帐户更加安全，但可以保护加密卷的内容免受绕过帐户凭据以获取磁盘的技术的影响 - 例如移除磁盘（或以目标模式启动）并将其安装为外部驱动器在其他机器上，或者引导单用户，或者什么不是。

# python - 如何在后台运行python脚本？

> ID：783531
> 
> 赞同：26
> 
> 时间：2009-04-23T21:07:49.837
> 
> 标签：python, windows, backgrounding

我有一个脚本每 5 分钟在我的电脑上检查一次，我不希望 Python 显示在我的任务托盘上。我使用 Windows 作为我的操作系统。

有什么方法可以让 Python 在后台运行并强制它不在我的任务栏中显示？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-04-23T21:15:11.567

如果您使用 运行控制台脚本`pythonw.exe`，它既不会显示窗口，也不会出现在任务栏中。例如，我使用以下命令在启动时启动[ntlmaps](http://ntlmaps.sourceforge.net/)：

```
C:\BenBlank\Python2.6\pythonw.exe scripts/ntlmaps 
```

但是请注意，无法与脚本交互，也无法通过任务管理器终止它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T21:17:50.560

您还有另一个选择：

您可以创建 Python 脚本的快捷方式，然后`right-click the shortcut --> Properties --> Shortcut tab`

运行选项下有一个下拉框，可让您**最小化运行命令。**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T08:07:51.967

您可以将其作为服务运行。看[这里](http://code.activestate.com/recipes/551780/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T21:10:36.087

在 linux 上运行它；在Windows上安排它[控制面板>计划任务>添加计划任务]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-29T05:05:02.830

从任何地方运行 python 文件：

第1步：

```
Create Shortcut of Python File. 
```

第2步：

```
Place Shortcut in this location  C:\ProgramData\Microsoft\Windows\Start Menu\Programs 
```

第 3 步：

```
Now Right Click --> Go to Properties --> Shortcut --> Press any key on keyboard it will take one shortcut key 
```

第4步：

```
Now , Type the Shortcut key which you entered in previous step. 
```

第 5 步：

```
Check out Output!   :) 
```

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2009-04-23T21:11:09.157

在控制面板中查找计划任务。

# c# - 从哪里开始使用 C# 和 Dreamweaver 中的 ASP.net？

> ID：783532
> 
> 赞同：7
> 
> 时间：2009-04-23T21:08:05.420
> 
> 标签：c#, asp.net, ide, dreamweaver

我希望开始使用 C# 在个人网站上工作。我是一名网络开发人员，以前使用过 VBScript，现在正在工作中使用 Coldfusion。我使用 Dreamweaver 进行这些语言的开发。

我读过很多人建议您应该使用 MS IDE 在 .net 中进行开发，并且 C# 是语言方面的最佳选择。我想坚持使用 Dreamweaver，因为我觉得要学习如何同时使用新的 IDE 和新的语言，我会承担太多的责任。

使用 Visual Studio 之类的东西是否会极大地帮助在 .net 中进行开发，以至于值得从 Dreamweaver 进行更改？如果是这样，哪个 IDE 最适合学习？

如果我选择坚持使用 Dreamweaver，您是否可以就如何最好地设置 Dreamweaver 以方便开发提出任何建议？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-23T21:16:54.150

我相信不会。Dreamweaver 不是开发*代码*的好工具。这就是您在 ASP.NET 中所需要的。你需要调试。您会喜欢 IntelliSense，并且您总是可以偶尔在 Dreamweaver 中打开单个文件（无论如何我怀疑您会这样做）。

获取[Visual Studio Express 2013 for Web](http://www.visualstudio.com/downloads/download-visual-studio-vs#d-express-web)（免费）并尽情享受。它是一个 Windows 应用程序，就像许多其他 Windows 应用程序一样！您不需要专业培训即可使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T21:17:17.350

作为以前在 Dreamweaver 中编写 PHP 的人，我强烈建议将 Visual Studio IDE 用于 C# ASP.NET 应用程序。好处很多：

*   **Intellisense** - 您创建的任何对象、属性、方法等都将自动出现在自动完成框中，从而大大减少语法错误
*   **项目模板**- 如果您必须通过源代码完成所有工作，从头开始启动 Web 应用程序将非常棘手
*   **调试**- 可以直接在源代码中捕获和调试错误
*   **加载项**- 我最喜欢的是[配置部分设计器](http://csd.codeplex.com)

我敢肯定还有更多的原因，这些只是最大的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T21:18:56.173

如果您对使用 Dreamweaver 进行设计感到满意，您仍然可以继续使用它，但我强烈建议您熟悉[Visual Studio Express](http://www.microsoft.com/Express/)（它是免费的）。尝试使用文本编辑器或 Dreamweaver 之类的应用程序来学习 .NET 和 C# 是可行的，但您会使学习过程变得不必要地困难。Visual Studio 为您提供语法突出显示、智能感知、调试和许多其他功能，这些功能在其他针对 Web 设计的 IDE 中是无法获得的。VS 与 .NET 开发的耦合度非常高。

多年前，我使用 Dreamweaver 开始了我的网页设计师职业生涯，并逐渐过渡到软件开发人员。离开像 Dreamweaver 这样的工具实际上给了我作为设计师工作的更多自由，而且我发现除了文本编辑器之外，我实际上不需要任何标记和 css 工具。你可能会发现放弃 Dreamweaver 这样的设计工具实际上会让你成为更好的设计师；同样——Visual Studio 中的“设计”工具绝对没用 :)

如果您决定继续使用 Dreamweaver 进行标记，请注意在 Visual Studio 中的呈现方式可能有所不同。完全忽略 Visual Studio 设计窗格，只需在各种浏览器中检查您的设计（我相信您已经这样做了）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T21:19:17.920

我认为您会对 Dreamweaver 中的 ASP.NET 支持感到非常失望。你最好给自己一份 Visual Studio / Web Developer（快速版是免费的）并在那里进行开发。

也就是说，您没有理由不能在 Dreamweaver 中创建 HTML 和 CSS，然后将这些文件带入 Visual Studio 以实际放入代码中。这是一种一次性的交易，因为通常一旦您开始将 HTML 拆分为母版页和用户控件/部分视图，就很难返回并在 Dreamweaver 中再次编辑它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T21:19:53.910

Visual Studio 2008 可能会更好。不仅 IntelliSense，而且在 JavaScript 中调试有时也会有所帮助（不知道它是否包含在 Express 版中）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T21:18:26.347

是的，我现在可以告诉您，从完全相同的情况出发，离开 Dreamweaver 对您的 .net 工作将大有帮助。C# 的智能感知在 Dreamweaver 中并不是特别出色。但是，您会发现 Dreamweaver 中很多您错过的功能，特别是 HTML 端的代码完成在 Dreamweaver 中比在 VS 中要好得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T21:19:45.110

再次投票支持 Visual Studio，此外您不必放弃 Dreamweaver。您可以使用 Dreamweaver 构建基本布局和界面设计。然后使用 Visual Studio 实现该设计的实现。

您会发现在没有专门构建 IDE 的情况下构建 ASP.Net 很痛苦。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-05-17T00:49:53.310

我真的很想指出，“IntelliSense”并不是什么新鲜事物，也不是微软以任何方式发明的。IntelliSense 是带有指向 Microsoft 帮助页面的链接的代码提示，我个人从来不需要。请注意，Dreamweaver 确实具有与 Visual Studio 完全相同的代码提示，但并非旨在开发 C# 和类似语言，仅出于这个原因，我不建议尝试使用它进行开发。至于纯粹使用 HTML、CSS 和 JavaScript 进行开发，纯文本编辑器是比 Visual Studio 更好的选择，因为您无需更改任何设置。在我编写 HTML 时，我讨厌 VS 的行为方式有很多事情，但那是另一个线程。在另一个网站上。

# visual-c++ - sqlucode.h 标头的 C++ ODBC 问题

> ID：783539
> 
> 赞同：0
> 
> 时间：2009-04-23T21:09:35.807
> 
> 标签：visual-c++, odbc, linker

[我在这里](http://www.codeproject.com/KB/database/easyodbc.aspx)找到了一个很棒的 C++/ODBC 示例...

我下载的项目构建得很好，一切正常。但是，当我将 .cpp 和 .h 文件复制到另一个项目中时，我似乎遇到了链接问题。

sql.h 中的`SQLConnect`函数是我想要的。当我在我下载的项目中的文件中右键单击该函数时`easyodbc.h`，它会跳转到 sql.h 中的声明。生活很好。

但是，在我创建的项目中，当我这样做时，它会跳转到 sqlucode.h 中的 UNICODE 定义。这似乎引起了问题，我的测试项目崩溃了。

我的项目中的任何地方都没有`#include`for sqlucdode.h，但它仍然将声明解析为 sqlucode.h 中的声明。我怎样才能防止这种情况？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T21:13:42.363

似乎您有预处理器问题而不是链接问题。

您的项目文件中可能有`UNICODE`（或）的预处理器定义。`_UNICODE`在 Visual C++ 2005 和 2008 中，您可以通过转到项目属性并将 Character Set 从**Use Unicode Character Set**更改为**Use Multi-Byte Character Set**来解决此问题。应用此设置时，Visual Studio 会为您修复正确的预处理器和链接器设置。

如果您有早期版本的 Visual Studio，您仍然可以通过更改预处理器定义来修复它`UNICODE`-`_UNICODE`只是`_MBCS`您必须自己找到它们。

编辑：我刚刚下载了该示例代码并进行了尝试——好消息，正如我所猜测的那样，更改为多字节字符集就可以了。

# ruby-on-rails - 安装 googlecharts gem 的问题？

> ID：783543
> 
> 赞同：1
> 
> 时间：2009-04-23T21:11:02.700
> 
> 标签：ruby-on-rails, ruby, rubygems, installation

我正在尝试使用 googlecharts gem 来创建一些快速图表。以下是 ruby​​forge 和 github 站点：

[http://googlecharts.rubyforge.org/](http://googlecharts.rubyforge.org/)
[http://github.com/mattetti/googlecharts/tree/master](http://github.com/mattetti/googlecharts/tree/master)

安装后，我不断收到一条错误消息，提示“没有要加载的此类文件——googlecharts”，即使当我执行“gem list”时，gem 也已列出。我已经重新启动了我的服务器。有人知道这里会发生什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T22:37:50.587

根据[文档](http://googlecharts.rubyforge.org/)，您需要

```
require 'gchart' 
```

但听起来你可能正在做

```
require 'googlecharts' 
```

反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T09:13:17.530

您必须先做一个`gem install googlecharts`，然后添加`gem "googlecharts"`到您的 gemfile，然后运行 ​​bundle install。之后您应该不会出现错误。

# iphone - 您最期待 iPhone SDK 3 的哪些功能？

> ID：783553
> 
> 赞同：1
> 
> 时间：2009-04-23T21:13:56.513
> 
> 标签：iphone, cocoa-touch, iphone-sdk-3.0

您最期待 iPhone SDK 3.0 中的哪些新[功能？](http://developer.apple.com/iPhone/program/sdk.html)

它是主要宣传的六种新事物之一，还是更小的东西？也许是“1,000 个新 API”中的一些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T22:04:00.217

通过蓝牙进行电话到电话通信似乎对我正在编写的某些应用程序非常有用。您不再需要自己输入所有想要存储的数据，您可以与其他 iPhone 用户共享其中的一些数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T21:23:30.093

不是一个真正的功能，但进一步开发 iPhone SDK 最好的事情是出现了很棒的框架。已经有一些非常非常棒的框架（比如 Three20 项目），它们会随着新的 3.0 SDK 变得更好。

一旦他们让我们运行后台进程，我真正的兴奋就会接管。也许在4.0？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T21:27:26.433

视频！为移动视频上传编写体面的工具的能力是一个很大的吸引力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T04:22:19.730

迄今为止，MapKit 将带来席卷整个应用程序空间的最大变化。

我个人最喜欢的是我们终于可以轻松跟踪大文件（如图像）的上传进度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T06:57:46.157

我真的非常想在相机 API 中看到修复，这样它就不会被破坏（2.2.1）或强制切换到肖像（3.0）。

除此之外，对我来说最有用的功能是：

1.  推送通知。非常适合使应用程序更具粘性 - 您可以让用户知道他们感兴趣的事情发生了。

2.  CoreData - 我一直在使用第三方 SQL 层，但它有一点问题，不再受支持。

3.  点对点蓝牙，正如上面的海报所说，对于本地数据交换也很有用。

最没用的？剪切和粘贴。我实际上想在我的应用程序中禁用它（以阻止人们复制内容）——而且看起来你还不能（还）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-24T09:44:19.720

与 GameKit 的蓝牙电话到电话通信将启用许多目前不可能的应用程序。无需 WiFi 网络的多人游戏和两部手机之间的数据交换是显而易见的用例。

我还希望看到——目前尚未包含在测试版中——一个不错的相机 API，它允许我们自定义捕获屏幕的外观，并且正如另一位海报所说，让它在横向和纵向模式下正常工作。

# asp.net - 在 ASP.NET Web 部署项目中编译时间定义

> ID：783572
> 
> 赞同：0
> 
> 时间：2009-04-23T21:20:00.633
> 
> 标签：asp.net, visual-studio-2005, trace, web-deployment-project

我的环境是 Visual Studio 2005。我的具体问题是我想定义`TRACE`.

`system.codedom`由于在 web.config 的元素中定义了它，我有一个网站项目，它在用完 ASP.NET 开发服务器时发送跟踪消息。

当我部署到 IIS 时，我是通过 Web 部署项目进行的。所以网站是预编译的。自然，这些条目在编译的网站上毫无用处。

我的问题是如何`TRACE`在 web 部署项目中定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T17:57:10.177

据我所知，Visual Studio IDE 不允许您在 Web 部署项目中设置编译时间常数。但是，由于 .wdproj 文件只是一个 msbuild 文件，因此您可以使用文本编辑器对其进行编辑。您需要向这些部分添加一个元素，如所提供链接中的屏幕截图所示。

我无法更改图像的链接，因为新用户显然无法添加图像： [文本编辑器中 .wdproj 的注释截图 http://img140.imageshack.us/img140/1719/deploymentproject.png](http://img140.imageshack.us/img140/1719/deploymentproject.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:05:12.683

C# 中没有与#defines 等效的功能。也就是说，听起来您想使用条件跟踪，这很容易实现。如果您在整个项目中都有诊断代码但想要定义它，请使用内置的跟踪功能，例如

System.Diagnostics.Trace.WriteLine("一些调试输出");

然后，在您的 webconfig 中，您可以使用

```
<configuration>
 <system.web>
  <trace enabled="true" requestLimit="40" localOnly="false"/>
 </system.web>
</configuration> 
```

更多信息[在这里](http://msdn.microsoft.com/en-us/library/1y89ed7z(VS.71).aspx)

# css - 阻止浏览器文本输入建议

> ID：783573
> 
> 赞同：44
> 
> 时间：2009-04-23T21:20:06.483
> 
> 标签：css, browser, user-interface

我正在构建自己的本地搜索 UI 元素，它会在您键入时提供本地搜索建议。我遇到的问题是，当我关注 html 文本输入元素时，我的浏览器（Safari，但可能发生在其他浏览器中）会根据我过去输入的内容显示自己的文本建议。

我的猜测是，这取决于 < input > 标签的 ID 或 Class。因此，如果我将输入标记类更改为晦涩难懂的内容，浏览器可能不会提供任何建议。但我想知道是否没有更优雅的方式......

一个相关的问题是当您关注 < input > 元素时，Safari 中的文本字段突出显示。当我在 Facebook 上填写表格时，我看不到这个大纲。很高兴听到有人知道如何处理这两个问题。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-04-23T21:25:39.153

基于 Gecko 的浏览器支持称为“自动完成”的标记属性。所以在你的`<form>`标签中你会放`<form autocomplete="off">`.

更多信息： [如何关闭表单自动完成](https://developer.mozilla.org/docs/Web/Security/Securing_your_site/Turning_off_form_autocompletion)

其他一些浏览器也支持此功能。我相信 IE 会尊重这一点。

# windows - 面向 Linux 的 Visual C++ 开发

> ID：783575
> 
> 赞同：3
> 
> 时间：2009-04-23T21:20:57.667
> 
> 标签：windows, linux, visual-c++

我成为 Visual C++ 用户已经有一段时间了，在接下来的几周内，我将加入一个 (C++) 仅限 Linux 的项目。需要注意的是，我在 Linux 上的开发经验绝对为零。

目前，Visual C++ 9 和 Visual Assist X 插件使基于 Windows 的开发变得相当愉快。然而，在查看了 Linux 上的各种 C++ IDE 后，我对编码体验感到有些失望。

我希望能够使用我当前的工具集（见上文）进行 Linux 开发，所以我有几个问题：

1.  VS 编辑器能否以可靠的方式在**CR** + **LF** <-> **LF之间进行转换？**
2.  是否可以设置一个系统，如果我在 IDE 中按“构建”，我的所有工作都会转移到另一个运行 Linux 的机器（例如，虚拟机）来编译我的项目？
3.  调试将如何工作？是否可以通过类似的方式远程调试在 Linux 中运行的应用程序`gdb`？如果是这样，MS 调试器的“高级”功能（例如，跟踪点、break-if-cond 等）会丢失吗？

这甚至是一个理智的想法吗？有人使用 Windows 环境进行 Linux 开发吗？如果没有，我想我应该把它吸起来，然后一起迁移到 Linux 环境......？

感谢您提供任何意见，因为我现在感到有些失落。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T21:26:57.013

很可能你最终会想要接受它并在 Linux 上工作。微软出于显而易见的原因，将他们的工具构建为非常以 Windows 为中心和特定于 Windows 的；Visual C++ 在某些方面甚至不是标准的 C++。

尽管如此，您还是*可以*在某种程度上使用 VC++。

linux 上有一些简单的工具可以从 Windows 转换为 UNIX 行尾。（称为“dos2unix”之类的创意）

您可以设置远程文件系统，例如 Windows 的 ExpanDrive，让您将文件保存在那里。

您可以从 Windows 运行 ssh 或 rsh 以在远程 Linux 机器上运行 make。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T21:30:13.167

我建议您深入研究并尝试学习 Linux 的做事方式。您团队中的其他人在使用什么？如果您使用与其他人相同的工具集，那么您在寻求帮助时会做得更好。如果您正坐在使用 Cygwin 进行交叉编译的 Windows 机器上，那么您或多或少是靠自己的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T21:54:20.630

我已经使用 Windows 作为我的主要操作系统完成了 windows/linux/freebsd 跨平台开发......所以这是可能的。

*   使用 VS 作为编辑器。

*   [使用putty](http://www.chiark.greenend.org.uk/~sgtatham/putty/)通过 SSH 访问 Linux Dev 节点 。

*   使用修订控制系统 (subversion/git/bazaar/mercurial/cvs) 将更改检查到 repo 并检查 Linux 上的更改。

*   使用多平台构建过程。我使用[SCons](http://www.scons.org/)。它是基于 python 的并且运行良好 - 尽管默认设置有点慢。

*   使用 putty 从 shell 启动构建过程。

*   根据需要使用额外的 shell 来附加 gdb 和调试。

现在回答你的问题：

1.  是的。有一个 VS 设置说使用 unix 行尾。许多修订控制系统也可以配置为为您更正此问题。

2.  也许吧，但我不是那样做的。

3.  是的，您可以使用 GDB 进行远程调试。GDB 有许多（全部？）VS 调试器可用的功能，但您必须学习 GDB 命令。我不知道如何使用 VS 的调试器来调试用 GCC 编译的进程——尽管这是一个常见的请求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-01T15:54:40.400

我目前在一个 Linux 团队工作，但使用 Visual Studio + Visual AssistX 作为我的 IDE。在我看来，VS+VAX 是最好的代码开发环境。我发现的其他任何地方都没有类似的东西。

你想做的是：

1.  安装 Cygwin openssh 并将其配置为无需密码即可进入您的 linux 机器。
2.  将您的 linux 机器上的开发树公开为 samba 共享，并将该共享挂载到您的 Windows 机器上。
3.  创建一个引用 linux 机器上文件的 Visual Studio“makefile”项目。
4.  覆盖 make 命令以 ssh 进入您的 linux 机器并执行构建。
5.  在您的 linux 机器上编写一个 sed 脚本，将 gcc/g++ 输出错误转换为 Visual Studio 格式。我使用类似的东西： sed -e 's/(. *):([0-9]* ): (.*)/z:\path\to\code\\1(\2): \3/' \

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T21:31:48.390

我真的建议您在本地尝试一下 Linux，而不是通过虚拟机。如果您在虚拟机下运行它，您最终可能会在 Windows 下完成 85% 的活动，这将阻止您在 linux 下实际学习任何东西。

在自己的分区中安装 linux 并全职工作。在项目开始之前尽快执行此操作，并首先熟悉如何使用它的基础知识。

关于要使用的 IDE，找出项目将使用的构建系统以及您将使用的库。[KDevelop](http://www.kdevelop.org/)是一个很棒的 IDE，虽然它可能有点太杂乱了。我真的很喜欢[Qt-Creator](http://www.qtsoftware.com/products/developer-tools)。您可能也想尝试一下 Eclipse。

至于要使用什么发行版，如果你真的想从中学习一些东西并学习 linux 以及学习在 linux 下进行开发，我会推荐你[​​ Archlinux 。](http://www.archlinux.org/)如果您真的不想学习太多关于 linux 的知识并直接进行开发，那么请选择[Kubuntu](http://www.kubuntu.org/)。至于使用什么桌面管理器，我会选择 KDE。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T21:24:55.940

Linux 上没有 Visual Studio。时期。试试 KDevelop 或 Code::Blocks。他们应该让 Linux 上的开发变得有趣。

至于编译器/可执行文件，您必须使用 GNU GCC 工具链。Linux 上也没有 MS`cl`编译器。

使用的调试器`gdb`也是 GCC 工具链的一部分。

还有一件事，尝试选择一个外壳（如`bash`）并阅读它。以后会省不少时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T21:27:37.247

2.  & 3.：我在 Windows 上使用 cygwin + Eclipse 进行开发和编译。通过这种组合，我还可以通过目标机器（带有 x86 Linux 或 ARM“真实”目标的 VM）上的 gdbserver 进行调试。

不幸的是，您必须进行一些微小但重要的设置（gdb 中的库路径等...），但只要它起作用......

抱歉，没有解决方案可以在 Linux 机器上的 VS 中进行调试……而且我认为在不久的将来不会有……

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T21:29:14.980

我写了一个 ftp 脚本将文件从我的 pc 移动到 linux 机器，然后将它设置为一个工具，所以我至少可以在 pc 上编写代码，并且可以轻松访问源代码安全。我点击了一个工具按钮，文件被传输到 linux 盒子，在那里我使用那里的实用程序来完成工作

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-01T16:11:16.250

您会发现编译器中存在辩证的变化，并且库的差异足以使其不太可能正常工作。

如果您不想立即将环境切换到 Windows，那么使用 MinGW 等基于 gcc 的工具链可能会更好。MinGW 使用标准开源库（如 getopt）的本机 Win32 端口，并且在 Linux 和 MinGW32 之间移植软件相当容易（只要您不使用 Linux 或 Windows 特定的 API）。

然而，将软件从 MinGW 移植到 Visual C++ 相当困难。在我做过这种事情的少数情况下，我发现在 Linux 和 MinGW 之间移植比在 MinGW 和 Visual C++ 之间移植要容易得多。

据我所知，我从未见过 Visual Studio 的 MinGW 插件，尽管理论上可以编写诸如 Visual Studio 允许您使用第三方编译器的东西。此外，您必须使用团队其他成员使用的任何构建系统，这几乎可以保证不是 MSBuild。

所以，我猜它不太可能运作良好。尽管如此，正如 Hunt & Thomas 所说，习惯不同的做事方式会让你成为更好的程序员。虽然 vi（或者如果您倾向于使用 emacs），但 ctags 和 gdb 的工作方式与 Visual Studio 完全不同，它们仍然是一个非常强大的开发环境。使用 MinGW32 和 Cygwin 或 MSYS，您可以使用这些，而无需大规模切换到 Linux。

# java - 构建端到端 Web 应用程序所需的技术？

> ID：783579
> 
> 赞同：3
> 
> 时间：2009-04-23T21:22:25.603
> 
> 标签：java, architecture, ria, tapestry

我想开发一个 Web 应用程序，例如在线调度程序。（是的，我知道它已经完成了一百万次。）我的大部分经验都是在 Java 中，所以我想在考虑技术时利用它。

我主要是一名系统开发人员，几乎没有接触过 UI 编程，所以我认为这是我需要学习的大部分内容。

您对我应该关注的技术有什么建议吗？我想专注于有市场且易于学习的技术。

到目前为止，这是我认为我需要的 3 层架构（从头开始）：

*   数据库（可能是 MySQL 或 PostgreSQL）- SQL、JDBC
*   后端服务器 - Java
*   Web 服务器 (Tomcat) - JSP、Servlet
*   Web 框架 - Tapestry（在这方面很弱，有更好的选择吗？）
*   浏览器技术——HTML、Javascript、CSS（需要学习）

我听说过诸如 Flex 和 Silverlight 之类的“富互联网应用程序”开发工具，但我不确定此类技术的市场。

编辑：似乎有很多提到 Spring/Hibernate，所以我会调查一下。我很感激反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T21:27:35.203

我认为你已经很好地覆盖了你的基础。

您可能需要研究一些框架/库以使您更轻松。

Web 框架 - Wicket / Stripes / JSF / Tapestry（组件与基于请求的框架）

Javascript 库 - JQuery / YUI / Dojo

至于您的模板语言，您可以使用 JSP / Velocity / Freemarker。

只需研究框架和工具，也许可以尝试一些，看看哪些最适合你。

仅供参考，我目前正在使用。

*   阿帕奇——网络服务器
*   Tomcat - servlet 容器
*   MySQL - 数据库
*   Stripes - 基于请求的 Web 框架
*   YUI - 用于 ajax
*   Spring - 依赖注入
*   Hibernate - 对象关系映射
*   jsp - 动态生成html

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T21:29:41.547

我会亲自将[Spring](http://springframework.org/)添加到此列表中。依赖注入绝对是一门很棒的学习技术，根据我的经验，Spring 可以让你随心所欲地使用它。

[您没有明确提到单元测试，但这当然应该是混合的一部分——我在JUnit](http://junit.org/)作为实际测试框架之外没有太多经验，但也有[EasyMock](http://easymock.org)和[JMock](http://www.jmock.org/)（以及其他）用于模拟依赖项。

这些都不是特定于网络的，但仍然是 IMO 重要的东西 :)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T05:04:57.260

我不同意富 Internet 应用程序没有市场。实际上，将企业规模的应用程序作为 RIA 制作的趋势正在增长。RIA 相对于普通 Web 应用程序的优势在于可用性。您获得了 Web 应用程序的所有优点，但仍然能够保留类似桌面的用户界面。

您说您来自 Java 背景，并且对 Web 技术没有太多经验。好吧，我不得不说，您听起来确实是[GWT](http://code.google.com/webtoolkit/)或[IT Mill Toolkit](http://www.itmill.com)（基于 GWT）的理想用户候选人。两者都是允许您纯粹用 Java 创建富互联网应用程序的框架！无需 HTML 或 JavaScript 技能。您必须学习 CSS 才能为应用程序制作自己的主题。

这两个框架都是开源的，并且非常适合商业用途。IT Mill Toolkit 与 GWT 的区别在于它是服务器驱动的，这意味着业务逻辑在服务器上实现和运行，而不是作为客户端浏览器中的 JavaScript（GWT 就是这种情况）。从软件安全的角度来看，这种服务器驱动的架构使应用程序更加安全。GWT 相对于 IT Mill Toolkit 的优势在于更大的用户社区。

What comes to the ORM frameworks, Hibernate is quite popular. However, I'm not very fond of it, because even though it technically implements Java Persistence API, it doesn't always behave as expected and you'll have to use a lot of hibernate specific annotations, which ties your application pretty hard to hibernate (bad thing!) and you cannot just easily swich to another JPA provider if you'd like to. Antoher ORM framework implementing the JPA is [EclipseLink](http://www.eclipse.org/eclipselink/). 我个人没有在企业规模的应用程序中使用过 EclipseLink（因为我还没有机会），但我将它用于一个较小的项目，而且它看起来很不错。EclipseLink 是开源的，它的许可对商业用途很友好。EclipseLink 由 Oracle 不断开发，因此它的背景很扎实。它实际上基于 TopLink，这是 Oracle 的闭源 JPA 实现。

希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T09:42:52.340

前段时间问了基本相同的问题，有一些非常有用的答案：

[网站开发工具](https://stackoverflow.com/questions/268606/tools-for-website-development)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T21:49:02.983

如果您要使用 Java 后端，我会推荐[Hibernate](http://www.hibernate.org/)用于您的 JPA，JSF 与[RichFaces](http://www.jboss.org/jbossrichfaces/)（AJAX/皮肤）和[Facelets](https://facelets.dev.java.net/)（视图呈现/模板）用于您的前端，以及[Seam](http://seamframework.org/)将它们放在一起。这是一个美妙的组合。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T22:13:37.963

如果你使用 Spring，那么你可以只使用 Hibernate 去 mysql，你可以在那里拥有你需要的一切。

在你写完之后，你想开始改进它，然后也许开始考虑在浏览器端做更多的事情，但是，最初，你可能希望它没有 ajax 调用。

Spring Framework 文档可能会有所帮助，因为您可以选择使用 Spring 的许多部分，例如 Spring MVC、Spring Framework、Spring Webflow 和 Spring Security（如果需要）。

# ruby-on-rails - Ruby on Rails。如何在 :belongs to 关系中使用 Active Record .build 方法？

> ID：783584
> 
> 赞同：140
> 
> 时间：2009-04-23T21:23:18.880
> 
> 标签：ruby-on-rails, activerecord, foreign-keys

我一直无法在 Rails 中找到任何关于 .build 方法的文档（我目前使用的是 2.0.2）。

通过实验，您似乎可以使用 build 方法`has_many`在保存任一记录之前将记录添加到关系中。

例如：

```
class Dog < ActiveRecord::Base
  has_many :tags
  belongs_to :person
end

class Person < ActiveRecord::Base
  has_many :dogs
end

# rails c
d = Dog.new
d.tags.build(:number => "123456")
d.save # => true 
```

这将使用外键正确保存狗和标签。这似乎在一段`belongs_to`关系中不起作用。

```
d = Dog.new
d.person.build # => nil object on nil.build 
```

我也试过

```
d = Dog.new
d.person = Person.new
d.save # => true 
```

在这种情况下没有设置外键，`Dog`因为在保存时，新人没有id，因为它还没有保存。

我的问题是：

1.  构建是如何工作的，以便 Rails 足够聪明地弄清楚如何以正确的顺序保存记录？

2.  我怎样才能在一段`belongs_to`关系中做同样的事情？

3.  我在哪里可以找到有关此方法的任何文档？

谢谢

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-04-24T02:17:19.233

记录在哪里：

[来自“ Module ActiveRecord::Associations::ClassMethods](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html) ”中 has_many 关联下的 API 文档

> collection.build(attributes = {}, ...) 返回一个或多个集合类型的新对象，这些对象已经用属性实例化并通过外键链接到该对象，但尚未保存。注意：这仅在关联对象已经存在时才有效，如果它是 nil 则无效！

在相反方向构建的答案是稍微改变语法。在你与狗的例子中，

```
Class Dog
   has_many :tags
   belongs_to :person
end

Class Person
  has_many :dogs
end

d = Dog.new
d.build_person(:attributes => "go", :here => "like normal") 
```

甚至

```
t = Tag.new
t.build_dog(:name => "Rover", :breed => "Maltese") 
```

您还可以使用 create_dog 立即保存它（很像您可以在集合上调用的相应“创建”方法）

Rails 有多聪明？这很神奇（或者更准确地说，我只是不知道，很想知道！）

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2010-12-15T16:01:25.663

```
@article = user.articles.build(:title => "MainTitle")
@article.save 
```

# c# - NHibernate 的工作单元/存储库管理器？

> ID：783590
> 
> 赞同：7
> 
> 时间：2009-04-23T21:24:28.003
> 
> 标签：c#, asp.net, asp.net-mvc, nhibernate

我白天是一名 .NET 开发人员，但过去一年一直在使用 Rails 和 Merb 进行自己的项目，所以当谈到 MVC 和 ORM 时，我更习惯它们并使用 ActiveRecord 和 DataMapper。

我开始使用 ASP.NET MVC，我喜欢我在 NHibernate 和 Fluent NHibernate 中看到的内容，但我正在寻找更多关于如何最好地处理工作单元或存储库类型模型的内容。

我想要一些在建筑上并不重要的东西。我见过一些像 S#arp Architecture 这样的项目，但它看起来有点臃肿。

我真正追求的是一种管理连接和处理数据检索/存储的简单方法。一个简单的指南或示例应用程序就足够了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-23T21:39:16.733

您可以使用一些组件来轻松实现工作单元：

*   [NHibernate Burrow](http://nhforge.org/wikis/burrow/get-started.aspx) - NHContrib 项目的一部分
*   [Rhino Commons](http://ayende.com/wiki/Rhino+Commons.ashx) - 工作单元实现，文档在示例代码中，在博客和网络上
*   [每个业务交易的对话](http://code.google.com/p/unhaddins/wiki/Overview)- 来自主要的 nhibernate 开发人员 Fabio Maulo，[在他的网站上有一些文档](http://fabiomaulo.blogspot.com/2009/01/using-conversation-per-business.html)

至于示例项目，[这里](http://blog.pragmasql.com/post/NHibernate-20-Sample-Project-using-NHibernateBurrow-contribution.aspx)是 Burrow 的一个。我现在正在将 Burrow 用于一个项目，它对我来说工作得很好。虽然我不使用它们，但有一些存储库类使用工作单元会话管理，因此使用它真的很容易。我也使用 Fluent NHibernate，它很容易让所有东西一起工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-27T21:49:14.047

您可能还对[Castle ActiveRecord](http://castleproject.org/activerecord/index.html)感兴趣，它在 NHibernate 之上实现了 ActiveRecord 模式，其灵感来自 Rails 的 ActiveRecord。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-28T14:42:24.143

> 我真正追求的是一种管理连接和处理数据检索/存储的简单方法。

是的，NHibernate 可能非常冗长。我已经研究了工作单元和存储库“模式”（它们实际上是“门面”，但这是另一个故事）并为它们编写了非常简单的实现。它们都极大地简化了 NHibernate，但我建议使用 Unit of Work 实现，因为我觉得它通常比 Repository 更高效且更易于使用。下载并试一试：

[http://code.google.com/p/nhibernate-unitofwork-example/](http://code.google.com/p/nhibernate-unitofwork-example/)

# c++ - SQLite3 对象不理解？

> ID：783592
> 
> 赞同：0
> 
> 时间：2009-04-23T21:24:35.130
> 
> 标签：c++, sqlite

现在我收到一个错误：

1>c:\development\document_manager\document_manager\storage_manager.h(7) : 错误 C2079: 'storage_manager::db' 使用未定义的结构 'sqlite3'

和

```
 #pragma once
 #include "sqlite3.h"
class storage_manager
{
    sqlite3 db;
    sqlite3** db_pp;
public:
    void open()
    {
        sqlite3_open("data.db", db_pp);
    }
}; 
```

老问题：大家好。[我从http://www.sqlite.org/download.html](http://www.sqlite.org/download.html)下载了 sqlite-amalgamation-3_6_13.zip ，但我无法在我的项目中编译它。我收到很多错误，例如：

```
c:\pathtoproject\sqlite3.c(11337) : error C2440: '=' : cannot convert from 'void *' to 'char *'
        Conversion from 'void*' to pointer to non-'void' requires an explicit cast

c:\pathtoproject\sqlite3.c(12023) : error C2440: '=' : cannot convert from 'void *' to 'sqlite3_int64 *'
        Conversion from 'void*' to pointer to non-'void' requires an explicit cast 
```

我需要做什么才能正确编译我的项目？谢谢！

编辑：我不想将整个程序编译为C，我只想将三个文件编译为c，这可能吗？

编辑：修复！我创建了一个新项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T21:32:04.630

看起来您可能正在尝试使用 C++ 编译器编译 C 程序。虽然有很多 C 代码也是有效的 C++，但它们是不同的语言。

您的编译器可能有一些开关或设置来编译 C 代码。检查您的编译器文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T21:40:39.820

您需要将文件编译为 C 代码而不是 C++。右键单击项目或仅 .c 文件，并在属性中，确保将其设置为编译为 C，而不是 C++。（您可能只想为文件设置此设置，而不是整个项目）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T21:27:51.927

编译器没有告诉你该怎么做吗？你需要一个明确的演员：

```
void *pv = /* some value */;
char *pc = (char*) pv; 
```

这当然不是 C 的问题，而是 C++ 的问题。

# c# - 带有 FileUpload 控件的 Gridview

> ID：783597
> 
> 赞同：3
> 
> 时间：2009-04-23T21:26:11.337
> 
> 标签：c#, asp.net, gridview, file-upload

我有一个网格视图，它显示一个图像作为其一列的一部分。在编辑模式下，我想让用户能够上传新的图像文件，所以我在模板的编辑部分使用了 FileUpload 控件。

我有一个事件可以捕捉到这一点，我相信：

```
 protected void GridVew1_RowUpdated(object sender, GridViewUpdateEventArgs e)
    {          
        if (FileUpload1.HasFile)
        {
            FileUpload1.SaveAs(Server.MapPath("images/hardware/" + FileUpload1.FileName));
        }
    } 
```

我不知道如何正确调用控件......这个功能是如何编码的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T21:36:40.873

首先，您需要处理**RowUpdating**事件而不是**RowUpdated**。然后，您需要在该行上找到对 FileUpload 控件的引用。

**重要提示：** *您需要知道控件所在列的序号位置。在我的示例中，我将其设置为 0，假设它是第一列。*否则，您将需要通过 Cells 集合找到它。

```
protected void gridView_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
    GridViewRow row = gridView.Rows[e.RowIndex];
    FileUpload fileUpload = row.Cells[0].FindControl("fileUpload1") as FileUpload;
    if (fileUpload != null && fileUpload.HasFile)
    {
        fileUpload.SaveAs(Server.MapPath("images/hardware/" + fileUpload.FileName));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T21:36:56.490

如果我明白你在这里做什么，你将不得不在行中找到控件

所以在VB中是这样的

```
 Protected Sub GridView1_RowUpdating(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewUpdateEventArgs) Handles GridView1.RowUpdating

      Dim aRow As GridViewRow = Me.GridView1.Rows(e.RowIndex)

    dim xFileUpload as fileupload = CType(aRow.FindControl("FileUpload1"), FileUpload)

    xFileUpload. save file etc etc etc 

End Sub 
```

警告 - 如果这是错误的，我希望看到更好的方法来做到这一点！

# asp.net - 如何阻止 ModalPopupExtender 显示？

> ID：783608
> 
> 赞同：0
> 
> 时间：2009-04-23T21:28:50.207
> 
> 标签：asp.net, javascript, ajaxcontroltoolkit, modalpopupextender

我有一个验证某些表单数据的 Web 服务。该服务是一个 ScriptService，我从客户端调用它。如果验证失败，我需要显示一个模式弹出窗口。如果用户在模式弹出窗口上单击“确定”，那么我想发回并保存我的数据。“取消”应该允许他们关闭模式弹出窗口并让用户更正数据，允许重新提交。目前，无论验证结果如何，每次都会显示模式弹出窗口。

我尝试调用 hide() 并返回 false，但都没有成功。

我尝试通过将 modalpopupextender 的 TargetControlID 属性分配给隐藏按钮，然后在验证失败时在模式弹出窗口上调用 show() 来从不同的角度解决此问题，但这并没有取消回发。modalpopup 显示大约一秒钟，然后页面回发。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T21:56:52.043

所以你想做这样的事情：

```
function ValidateInput() {
   MyScriptService.ValidateInput({however you are passing form data}, OnValidateComplete);
}

function OnValidateComplete(response) {
   if ({response is bad}) {
      $find('<%= ModalPopupExtender.ClientID %>').show();
   }
} 
```

然后，您可以保持 TargetControlID、OnOkScript 等保持不变。也许通过一些代码，我们实际上可以看到你在做什么。

# java - 如何在 Spring Web Flow 2 中编写自定义转换器？

> ID：783617
> 
> 赞同：1
> 
> 时间：2009-04-23T21:32:05.160
> 
> 标签：java, spring-mvc, converter, spring-webflow

我正在使用带有 Spring MVC 和 Hibernate 的 Web Flow 2.0.7。

我的问题是关于我的自定义类型的自定义转换器和我的转换器中的数据库连接。

假设我有一个*Person*类型，并且*Person*有一个我的自定义类型*Title*的字段，并且所有*Titles*都已经在我的数据库中。现在我有一个 html 表单，用户可以在其中填充*Person*实例，包括在选择下拉框中选择*Title 。*

在流程定义中，我从数据库中获取所有*标题*，它们使用自定义转换器显示在下拉框中，将*Title*转换为*String*，然后再转换回*Title*。

我的问题是关于从我的数据库中从*String*（这是数据库 ID，我将其设置为元素的值）转换回正确*Title*对象的过程。基本上：怎么做？

到目前为止，我无法将 titleManager 注入到我的转换器中以访问数据库。这个场景在[Spring Web Flow 论坛](http://forum.springsource.org/showpost.php?p=218316&postcount=20)中得到了评论。另一种解决方案可能是在呈现视图之前缓存*标题，并在表单发布后以某种方式获取内存中的**标题*。

如果有人能启发我，我将非常感激如何处理这种数据绑定。到目前为止，我无法让它工作，因此，我从原本很棒的 webflows 中得到了最少的使用。

我已经[在 Web Flow Board 上发布了一个帖子](http://forum.springsource.org/showthread.php?t=70536)，但仍然缺少我自己无法找到的最佳实践。

非常感谢！

钨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-23T16:44:59.237

我用来做这个。基本上我加载标题列表并将其放入我的表单模型中。在表单模型中，我还有一个 currentTitleId 或 selectedTitleId 变量来存储所选项目的值。此字段名称设置在 spring 组合框的“路径”中，而 titleList 设置在“项目”中。然后在“itemValue”中设置您要绑定的值，并在“itemLabel”中为该值显示文本。就是这样。

在我的表单模型中：

```
private int currentTitleId;
public long getCurrentTitleId() { return this.currentTitleId; }
public void setCurrentTitleId(long currentTitleId) { this.currentTitleId = currentTitleId; }

List titleList = getTitlesFromMyDatabaseHereOrSomewhereElse(); 
```

在我的jsp中：

```
<form:label path="currentTitleId">Title</form:label>
<form:select path="currentTitleId" items="${formModel.titleList}" itemLabel="titleDescription" itemValue="titleId" /> 
```

我假设您的 Title 类将是这样的：

```
class Title {
    public long getTitleId() { return this.titleId; }
    public long getTitleDescription() { return this.titleDescription; }
} 
```

您还可以像这样自定义组合框：

```
 <form:select path="currentPhoneNumberId">
    <form:option value="">-</form:option>
    <c:forEach items="${formModel.phoneList}" var="phone">
        <form:option value="${phone.phoneNumberId}">${phone.phoneNumberId} - ${phone.description}</form:option>
    </c:forEach>
</form:select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T21:55:17.647

我不太确定 Spring Web Flow，但是使用普通的 Spring MVC 注册一个新的 PropertyEditor 就足够了，然后这些东西会自动工作

[http://static.springframework.org/spring/docs/2.5.x/reference/validation.html#beans-beans-conversion-customeditor-registration](http://static.springframework.org/spring/docs/2.5.x/reference/validation.html#beans-beans-conversion-customeditor-registration)

[http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html#mvc-ann-webdatabinder](http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html#mvc-ann-webdatabinder)

因此，我将创建一个新的 PropertyEditor，它获取一个服务或 dao，它负责从数据库中获取数据，在 PropertyEditor 中，您可以将 id 转换为您的键类型并从数据库中获取值并返回它。我只是没有一个例子，但我希望你能明白要点。

# asp.net - 将文件上传到我的网站

> ID：783618
> 
> 赞同：0
> 
> 时间：2009-04-23T21:32:25.283
> 
> 标签：asp.net, iis

我有一个 ASP.NET 应用程序。我希望用户能够上传文件。我应该将这些文档存储在文件系统的哪个位置？用户应该能够上传它们并在站点上看到指向它们的超链接，但用户A 应该不能看到用户B 的文档，但管理员角色应该能够看到所有这些文档。

我假设我不想将它们上传到我的 Web 应用程序的文件夹中，因为这样 Web 服务器可以直接为它们提供服务。我不想将文件存储在数据库中，但我可以将文件路径存储在数据库中。

有人请给我一些最佳实践。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T08:57:26.220

根据文件的大小，一种选择是将文件存储在 web 根目录之外，这样没有人可以热链接到它们，然后，正如建议的那样，生成一个带有一些参数和[Response.WriteFile()](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.writefile(VS.71).aspx)的页面从所述目录。

如果文件很大，您可能希望使用[Response.TransmitFile](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.transmitfile.aspx)来节省服务器上的一些内存。

从实现的角度来看，我可能会将文件的真实名称存储在数据库中以避免命名冲突，并将文件保存在磁盘上重命名为 GUID 或只是从数据库表中获取的整数 ID。

然后，当您将文件写入输出流时，您可以使用[内容处置标头](http://support.microsoft.com/kb/260519)将文件重命名为原始名称。

！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T21:39:47.903

您可能需要一个文件夹结构，每个用户一个文件夹。您可以编写自己的`CreateFolder()`方法，在创建文件夹后添加一个`web.config`带有授权规则的文件，只让用户和管理员访问它。这样，用户只能访问自己的文件，而管理员可以访问所有文件。

**编辑：**为了澄清 - 我假设您正在使用 ASP.NET 成员资格功能（尽管不一定完全按原样），这使您可以将单个`web.config`文件放在具有如下所示节点的目录中以控制访问。

```
<configuration>
  <system.web>
    <authorization>
      <allow roles="admin" />
      <allow users="TomasLycken" />
      <deny users="*" />
    </authorization>
  </system.web>
</configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T21:46:15.297

另一种方法是将所有文件放在一个地方，您静态地不允许任何人访问该位置，然后有一个通用处理程序 ( `.ashx`) 在从数据库中查找 url 和权限后为文件提供服务。这可能是一种更清洁的方法，而且它也将占用更少的空间，因为你不会有大量的`web.config`文件放在周围......

* * *

注意：我故意将此作为单独的答案发布，因此您可以将您喜欢的解决方案标记为您的答案并忽略另一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T21:51:51.930

我已经实施了这样的解决方案。我将文件存储在网站内的受保护（通过 web.config 部分）文件夹中，但我使用的是 guid 而不是真实文件名。我还有一个将 guid 映射到真实姓名的数据库，并有一些额外的信息，如文件大小、类型等。在您的情况下，此信息还可能包含上传文件的用户的名称。为了下载文件，我实现了 HTTP 处理程序，该处理程序将获取 guid 参数并根据文件类型设置适当的 HTTP 标头并将文件内容写入响应。在我将文件写入响应之前，我还会检查当前用户的权限。然后我有一个页面，将文件名列表呈现为超链接，这些超链接指向这个 HTTP 处理程序，其 guid 参数对应于受保护文件夹中的特定文件。 [http://krystalware.com/Products/SlickUpload/](http://krystalware.com/Products/SlickUpload/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T22:06:01.180

您可以在 IIS 中创建与网站根目录相邻的虚拟目录（作为同级目录），这有几件事：1）它可以防止用户通过猜测文件位置直接访问文件，2）您可以指向虚拟目录到您希望的任何位置，3）关闭目录浏览，您可以防止任何人看到该结构。然后，您可以将路径存储在数据库中，进一步从客户端中删除实际结构。

# c++ - Boost、共享内存和向量

> ID：783623
> 
> 赞同：6
> 
> 时间：2009-04-23T21:34:25.840
> 
> 标签：c++, boost, ipc, interprocess

我需要在进程之间共享一堆字符串（将来可能会更复杂的对象）。我决定使用 boost::interprocess 但我无法让它工作。我确定这是因为我不理解某些东西。我遵循了他们的示例，但是如果有使用该库经验的人可以查看我的代码并告诉我出了什么问题，我将不胜感激。问题是它似乎可以工作，但是经过几次迭代后，我在阅读器进程和有时在编写器进程上都遇到了各种异常。这是我的实现的简化版本：

```
using namespace boost::interprocess;
class SharedMemoryWrapper
{
public:
    SharedMemoryWrapper(const std::string & name, bool server) :
      m_name(name),
      m_server(server)
    {
        if (server)
        {
            named_mutex::remove("named_mutex");
            shared_memory_object::remove(m_name.c_str());
            m_segment = new managed_shared_memory (create_only,name.c_str(),65536);         
            m_stackAllocator = new StringStackAllocator(m_segment->get_segment_manager());
            m_stack = m_segment->construct<StringStack>("MyStack")(*m_stackAllocator);
        }
        else
        {
            m_segment = new managed_shared_memory(open_only ,name.c_str());
            m_stack = m_segment->find<StringStack>("MyStack").first;
        }
        m_mutex = new named_mutex(open_or_create, "named_mutex");
    }

    ~SharedMemoryWrapper()
    {
        if (m_server)
        {
            named_mutex::remove("named_mutex");
            m_segment->destroy<StringStack>("MyStack");
            delete m_stackAllocator;
            shared_memory_object::remove(m_name.c_str());
        }
        delete m_mutex;
        delete m_segment;
    }

    void push(const std::string & in)
    {
        scoped_lock<named_mutex> lock(*m_mutex);
        boost::interprocess::string inStr(in.c_str());
        m_stack->push_back(inStr);
    }
    std::string pop()
    {
        scoped_lock<named_mutex> lock(*m_mutex);
        std::string result = "";
        if (m_stack->size() > 0)
        {
            result = std::string(m_stack->begin()->c_str());
            m_stack->erase(m_stack->begin());
        }
        return result;
    }
private:
    typedef boost::interprocess::allocator<boost::interprocess::string, boost::interprocess::managed_shared_memory::segment_manager> StringStackAllocator;
    typedef boost::interprocess::vector<boost::interprocess::string, StringStackAllocator> StringStack;
    bool m_server;
    std::string m_name;
    boost::interprocess::managed_shared_memory * m_segment;
    StringStackAllocator * m_stackAllocator;
    StringStack * m_stack;  
    boost::interprocess::named_mutex * m_mutex;
}; 
```

*编辑*编辑使用named_mutex。原始代码使用了不正确的 interprocess_mutex，但这不是问题。

*EDIT2*我还应该注意，事情在一定程度上起作用。writer 进程可以在 reader 中断之前推送几个小字符串（或一个非常大的字符串）。阅读器以 m_stack->begin() 行不引用有效字符串的方式中断。是垃圾。然后进一步执行会引发异常。

*EDIT3*我已经修改了类以使用 boost::interprocess::string 而不是 std::string。阅读器仍然失败，内存地址无效。这是读者/作者

```
//reader process
SharedMemoryWrapper mem("MyMemory", true);
std::string myString;
int x = 5;
do
{
    myString = mem.pop();
    if (myString != "") 
    {
        std::cout << myString << std::endl;
    }
} while (1); //while (myString != ""); 

//writer
SharedMemoryWrapper mem("MyMemory", false);
for (int i = 0; i < 1000000000; i++)
{
    std::stringstream ss;
    ss <<  i;  //causes failure after few thousand iterations
    //ss << "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" << i; //causes immediate failure
    mem.push(ss.str());
}
return 0; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-13T18:55:00.687

关于您的实施，有几件事让我大吃一惊。一种是使用指向命名互斥对象的指针，而大多数 boost 库的文档倾向于向后弯曲而不使用指针。这导致我要求参考您在构建自己的测试用例时使用的程序片段，因为我也遇到过类似的不幸事件，有时唯一的出路是回到示例并一次向前推进一步，直到我遇到了重大变化。

另一件似乎有问题的事情是您为共享内存分配了一个 65k 块，然后在您的测试代码中，循环到 1000000000，每次迭代都将一个字符串推入堆栈。

With a modern PC able to execute 1000 instructions per microsecond and more, and operating systems like Windows still doling out execution quanta in 15 millisecond. chunks, it won't take long to overflow that stack. That would be my first guess as to why things are haywire.

P.S. I just returned from fixing my name to something resembling my actual identity. Then the irony hit that my answer to your question has been staring us both in the face from the upper left hand corner of the browser page! (That is, of course, presuming I was correct, which is so often not the case in this biz.)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-04-23T23:27:55.413

好吧，也许共享内存不是解决您的问题的正确设计。但是我们不知道，因为我们不知道您首先要达到什么目标。

# odbc - FileMaker Pro 10 和 xDBC ODBC 插件

> ID：783625
> 
> 赞同：2
> 
> 时间：2009-04-23T21:34:52.470
> 
> 标签：odbc, filemaker

有人在 Windows 上为 FileMaker Pro 10 设置了 ODBC 数据源吗？

FileMaker Pro 10 附带的文档没有意义，因为它说单击不存在的设置文件。

也没有一个论坛提供答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-25T03:53:34.880

在您的 FileMaker Server 10 安装盘上应该有一个名为“xDBC”的文件夹以及一个子文件夹“ODBC 客户端驱动程序安装程序”。

里面是一个名为“setup.exe”的启动器。（在同一位置还应该有“DataDirect SequeLink 5.5 Client for ODBC.msi”，您可以尝试直接运行。）

安装驱动程序后，您可以使用从控制面板 > 管理工具 > 数据源 (ODBC) 访问的 ODBC 数据源管理器设置 ODBC DSN

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T12:40:54.447

我也有同样的问题。我发现了 Filemaker 7.0 的这个页面（[http://dev.mysql.com/tech-resources/articles/filemaker_mysql_whitepaper/filemaker_to_mysql_whitepaper01.htm](http://dev.mysql.com/tech-resources/articles/filemaker_mysql_whitepaper/filemaker_to_mysql_whitepaper01.htm)）。尝试进入文件/共享/ODBC 菜单。我认为它可能会奏效。

或者可能不是。FM 似乎在销售 SQL 产品。这可能有效：[http ://www.filemakertrial.com/sqlkit/](http://www.filemakertrial.com/sqlkit/)

麦克风

# sql - 从子记录生成父记录

> ID：783630
> 
> 赞同：0
> 
> 时间：2009-04-23T21:36:17.023
> 
> 标签：sql

我有以下情况。

我以表格形式从外部系统获取数据

```
UserId  Group  Value
1       Abc    .....
1       Abc    .....
1       Bcd    .....
2       Abc    ..... 
```

我需要将这些数据按摩到我的架构中，即

```
Parent Table
ID    UserID    Group    Name
1     1         Abc      User 1 - Abc data
2     1         Bcd      User 1 - Bcd data
3     2         Abc      User 2 - Abc data

Child Table
ParentID  Value
1         .....
1         .....
2         .....
3         ..... 
```

所以子数据和来自外部系统的数据是一对一的。问题是我从子数据开始，需要编写一个查询，该查询可以根据 UserID 和 Group 的不同组合创建父记录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T21:50:50.123

```
insert parent (userId, group, name)
select distinct userId, group, concat("user ", userId, " - ", group, " data")
from input_data; 
```

（它有一个自动递增的 ID）

然后：

```
insert child (parentId, value)
select p.parentId, d.value
from parent p
inner join input_data d on p.user_id = d.user_id and p.group = d.group; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T21:40:02.410

> 需要编写一个查询，该查询可以根据 UserID 和 Group 的不同组合创建父记录

```
insert into parent(UserID, Group, Name) 
select distinct 
UserID,  
Group, UserID, 
'User ' || UserID || ' - ' || Group || '  data'
from raw_input_data; 
```

# .net - 有没有简单的方法来设置 WPF 状态栏文本？

> ID：783649
> 
> 赞同：0
> 
> 时间：2009-04-23T21:42:09.003
> 
> 标签：.net, wpf, multithreading, backgroundworker, statusbar

我想在我的程序执行一些工作时让用户稍等片刻之前在我的状态栏中设置 TextBlock 的文本。

显然，而不是像这样做一个很好的小功能（这不起作用）：

```
Function Load(ByVal Id As Guid) As Thing
    Cursor = Cursors.Wait
    TextBlockStatus.Text = "Loading..."
    TextBlockStatus.UpdateLayout()
    Dim Found = From t In db.Thing _
                Where t.Id = Id _
                Select t
    TextBlockStatus.Text = String.Empty
    Cursor = Cursors.Arrow
    Return Found
End Function 
```

我不得不改用这个怪物：

```
Private WithEvents LoadWorker As BackgroundWorker

Private Sub Window1_Loaded(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
    InitializeLoadWorker()
End Sub

Private Sub InitializeLoadWorker()
    LoadWorker = New BackgroundWorker
    LoadWorker.WorkerSupportsCancellation = False
    LoadWorker.WorkerReportsProgress = False
    AddHandler LoadWorker.DoWork, AddressOf LoadBackgroundWorker_DoWork
    AddHandler LoadWorker.RunWorkerCompleted, AddressOf LoadBackgroundWorker_RunWorkerCompleted
End Sub

Sub Load(ByVal Id As Guid)
    Cursor = Cursors.Wait
    LoadWorker.RunWorkerAsync(Argument)
End Sub

Private Sub LoadBackgroundWorker_DoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs)
    Dim Worker As BackgroundWorker = DirectCast(sender, BackgroundWorker)
    Dim Id As Guid = DirectCast(e.Argument, Guid)
    e.Result = From t In db.Thing _
               Where t.Id = Id _
               Select t
End Sub

Private Sub LoadBackgroundWorker_RunWorkerCompleted(ByVal sender As Object, ByVal e As RunWorkerCompletedEventArgs)
    TextBlockStatus.Text = String.Empty
    Cursor = Cursors.Arrow
    Dim Found As Thing = DirectCast(e.Result, Thing)
    'now do something with the found thing here instead of where Load() is called.'
End Sub 
```

而 Load() 函数现在是一个 Sub！

必须有更好的方法来处理这种简单的情况。这不需要是异步的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T21:57:05.927

看看这个问题：[Display Wait Screen in WPF](https://stackoverflow.com/questions/616629/display-wait-screen-in-wpf)。

接受的答案有一种方法可以做我认为你想要的，没有背景工人阶级。

从另一个问题的答案中的链接来看，这可能适用于 VB.NET（虽然我还没有尝试过）

```
Public Sub AllowUIToUpdate()

    Dim frame As New DispatcherFrame()

    Dispatcher.CurrentDispatcher.BeginInvoke(DispatcherPriority.Render, New DispatcherOperationCallback(AddressOf JunkMethod), frame)

    Dispatcher.PushFrame(frame)

End Sub

Private Function JunkMethod(ByVal arg As Object) As Object

    DirectCast(arg, DispatcherFrame).Continue = False
    Return Nothing

End Function 
```

# ruby-on-rails - 是否可以使用 Ruby 1.9x 运行 Ruby on Rails？

> ID：783651
> 
> 赞同：3
> 
> 时间：2009-04-23T21:42:46.897
> 
> 标签：ruby-on-rails, ruby

如果是这样，怎么做？

当您访问[http://rubyonrails.org/download](http://rubyonrails.org/download)时，它会显示：

> 我们推荐 Ruby 1.8.7 与 Rails 一起使用。Ruby 1.8.6、1.8.5、1.8.4 和 1.8.2 也仍然可用，但 1.8.3 版本不可用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T22:45:16.047

从 2.3 开始，Rails 确实在 1.9 中工作。我想他们仍然推荐 Ruby 1.8.7，因为它与其他 Ruby 库的兼容性最好——其中很多仍在追赶。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T21:58:04.630

从[Rails 2.2 的公告中](http://weblog.rubyonrails.org/2008/11/21/rails-2-2-i18n-http-validators-thread-safety-jruby-1-9-compatibility-docs)：

> Jeremy Kemper 一直在 Ruby 1.9 和 JRuby 兼容性方面摇摆不定。Rails 2.2 与两者完全兼容，但同样，可能存在不支持的库和 gem。同样，为了使其他一切也完全兼容，还有很多工作要做。

然后，从[Rails 2.3 的发行说明中](http://guides.rubyonrails.org/2_3_release_notes.html#ruby-191-support)：

> 无论您是在 Ruby 1.8 还是现在发布的 Ruby 1.9.1 上运行，Rails 2.3 都应该通过它自己的所有测试。不过，您应该知道，迁移到 1.9.1 需要检查所有数据适配器、插件和其他代码，这些代码依赖于 Ruby 1.9.1 兼容性以及 Rails 核心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T21:56:51.293

根据他们的[讨论板](http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/a2b417bae6171d30/6d9ffd0575cc4e2f?lnk=gst&q=1.9#6d9ffd0575cc4e2f)，Rails 2.3.0RC1 及更高版本与 Ruby 1.9.1 兼容（并且可能与任何更高的 1.9 版本兼容）。我猜他们还没有开始正确地更新网站。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T22:26:42.173

Rspec 最近才移植到 1.9，因此许多 gem 直到最近才能够在 1.9 中运行他们的测试套件，所以许多 gem 在 1.9 中还不稳定

# oracle - 外部联接的有效替代方案

> ID：783660
> 
> 赞同：0
> 
> 时间：2009-04-23T21:47:38.600
> 
> 标签：oracle, outer-join

on此`RIGHT JOIN`查询导致`TABLE ACCESS FULL`on `lims.operator`。常规连接运行很快，但当然，样本 ' `WHERE authorised_by IS NULL`' 不会出现。

在这种情况下，是否有更有效的替代方案`RIGHT JOIN`？

```
 SELECT   full_name
  FROM       (SELECT   operator_id AS authorised_by, full_name
                FROM lims.operator)
  RIGHT JOIN (SELECT   sample_id, authorised_by
                FROM   lims.sample
               WHERE   sample_template_id = 200)
  USING (authorised_by) 
```

注意：显示的所有列（全名除外）都已编入索引，并且是某些表的主键。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T22:41:45.320

由于您正在执行外连接，因此执行全表扫描而不是使用索引实际上可能更有效。

如果您确信应该使用索引，请通过提示强制它：

SELECT /*+ INDEX (lims.operator operator_index_name)*/ ...

然后看看会发生什么...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T21:54:19.850

无需嵌套查询。试试这个：

```
select s.full_name
from lims.operator o, lims.sample s
where o.operator_id = s.authorised_by(+)
and s.sample_template_id = 200 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T21:56:37.130

我有一段时间没有为 oracle 编写 sql，但我会这样编写查询：

```
SELECT lims.operator.full_name
FROM       lims.operator
RIGHT JOIN lims.sample
           on lims.operator.operator_id = lims.sample.authorized_by
           and sample_template_id = 200 
```

这仍然表现得那么糟糕吗？

# javascript - 从 JavaScript 登录到 Firefox 错误控制台

> ID：783661
> 
> 赞同：53
> 
> 时间：2009-04-23T21:47:53.890
> 
> 标签：javascript, firefox, debugging

是否可以从网页中运行的 JavaScript 代码向 Firefox 的内置错误控制台添加消息？

我知道我有 Firebug，它提供了一个`console`对象和它自己的错误控制台，但我之前一直在寻找快速修复，但找不到任何东西。

我想可能根本不可能防止恶意网页向日志发送垃圾邮件？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2010-03-09T20:18:30.843

如果您定义了一个检查 window.console 是否存在的全局函数，您可以使用 Firebug 进行跟踪，并且仍然可以与其他浏览器配合使用和/或如果您关闭 Firebug 的控制台跟踪：

```
debug = function (log_txt) {
    if (typeof window.console != 'undefined') {
        console.log(log_txt);
    }
}

debug("foo!"); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-04-23T22:02:03.327

您不能直接从不受信任的 JavaScript（例如来自页面的脚本）写入控制台。但是，即使安装 Firebug 对您没有吸引力，我还是建议您查看[Firebug Lite](http://getfirebug.com/lite.html)，它不需要安装到浏览器中（事实上，它甚至不需要 Firefox）。它是一个脚本，您可以将其包含到任何网页中（甚至是动态的），它将为您提供一些基本的 Firebug 功能（例如`console.log()`）。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2010-01-13T16:48:58.413

是的，你可以=P

```
function log(param){
    setTimeout(function(){
        throw new Error("Debug: " + param)
    },0)
}

//Simple Test:
alert(1)
log('This is my message to the error log -_-')
alert(2)
log('I can do this forever, does not break')
alert(3) 
```

*更新为实际功能*

这是一个简单的 hack，只是为了好玩。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-09-19T02:51:30.420

window.console 在 Firefox 4 beta 6 中未定义，即使 Firebug 1.6X.0b1 已启用并打开，可能是因为其他人讨论的权限问题。但是，Firefox 4 有一个新的工具 > Web 控制台，如果它打开了，您会有一个 window.console 对象，并且页面上不受信任的 JavaScript 代码可以使用 console.log()。Web 控制台不断变化（请参阅[https://wiki.mozilla.org/Firefox/Projects/Console](https://wiki.mozilla.org/Firefox/Projects/Console)），您可能需要在 about:config 和 YMMV 中更改名为 devtools.* 的设置。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-23T22:00:46.293

我只会安装 Firebug 并使用`console.log`. 但是，如果你不能这样做，你总是可以抛出一个错误：

```
throw "foobar";
throw new Error("bazquux"); 
```

当然，这会让你脱离当前正在执行的代码，所以你不能用它来进行详细的日志记录，但如果你能解决这个问题，我认为这是开箱即用的唯一方法.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-23T21:58:18.857

AFAIK，这是不可能的。但如果您对 Firefox 中的扩展如何与错误控制台交互感兴趣，[请查看此](https://developer.mozilla.org/en/Components.utils.reportError)内容。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-15T14:49:38.960

此功能不需要任何扩展或库。但是，它授予相关网站的全部权限。不用担心，因为您是开发它的人，对吗？

```
 // Define mylog() function to log to Firefox' error console if such a
// thing exists
function defineMyLog()
{
    // Provide a useless but harmless fallback
    mylog = function(msg) { };
    // return; // disable in production

    if (typeof(netscape) === "undefined") {
        // alert("Logging implemented only for Firefox");
        return;
    }
    // The initial auth popup can be avoided by pre-setting some magic user_pref
    //  ( "capability.principal.codebase.p0.granted", "UniversalXPConnect"), etc.
    try {
        netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
    } catch (e) { // User has denied privileges
        // alert(e.name + ": " + e.message);
        return;
    }
    ffconsoleService = Components.classes["@mozilla.org/consoleservice;1"]
                                 .getService(Components.interfaces.nsIConsoleService);
    mylog = function (msg)
    {
        netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
        ffconsoleService.logStringMessage(new Date().toLocaleTimeString() + ": " + msg);
    }
    mylog("Firefox logging function has been defined");

    // window.open("javascript:"); // this URL does not work anymore?
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-23T22:37:08.717

如果您有兴趣，请查看我编写的脚本——它是“廉价”的 Firebug 替代品，不会干扰任何普通控制台（如 Safari 或 Chrome），但可以使用几乎所有 Firebug 方法对其进行扩展：

[http://code.google.com/p/glentilities/](http://code.google.com/p/glentilities/)

看看引擎盖下，你会明白我所说的“便宜”是什么意思。:-)

将它与 YUI 或 json.org 的 JSON 序列化程序结合起来以复制 console.dir。

Firebug 和 Firebug Lite 绝对是更好的 GUI，但我一直使用我自己开发的 GUI 来安全地保留日志记录，即使对于生产代码也是如此——*无需*不断评论和取消评论，

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-08-09T12:52:15.470

我今天遇到了一个问题，注意到 Firebug 中的控制台有不同的选项卡，而我的在 Depuration Information 中，您必须选择 ALL 选项才能看到 console.log 工作而不会出现错误！就这么简单！;^)

# java - Java 32 位与 64 位兼容性

> ID：783662
> 
> 赞同：98
> 
> 时间：2009-04-23T21:48:07.883
> 
> 标签：java, jvm, 64-bit, compatibility, 32-bit

针对 32 位 JDK 构建和编译成 32 位字节代码的 Java 代码是否可以在 64 位 JVM 中工作？还是 64 位 JVM 需要 64 位字节码？

为了提供更多细节，我的代码在运行 32 位 JVM 的 Solaris 环境中工作，但现在我在将 JDK 和 Weblogic Server 升级到 64 位后遇到了问题。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-04-23T21:50:37.690

是的，假设您使用独立于平台的库，Java 字节码（和源代码）是独立于平台的。32 位与 64 位无关紧要。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-23T21:59:07.700

我不小心在 64 位 VM 而不是 32 位 VM 上运行了我们的（大型）应用程序，直到一些外部库（由 JNI 调用）开始失败时才注意到。

在 32 位平台上序列化的数据在 64 位平台上被读取，完全没有问题。

你遇到什么样的问题？有些事情有效，有些无效？您是否尝试过附加 JConsole 等并有一个高峰？

如果您有一个非常大的 VM，您可能会发现 64 位的 GC 问题会影响您。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-23T21:52:03.787

第一个问题是，第二个问题不是；它是一个虚拟机。您的问题可能与版本之间库实现的未指定更改有关。虽然它可能是一个竞争条件。

虚拟机必须经历一些障碍。值得注意的是，引用在类文件中被视为`int`与堆栈上的 s 占用相同的空间。`double`并`long`占用两个参考槽。例如字段，VM 通常会进行一些重新排列。这一切都是（相对）透明地完成的。

一些 64 位 JVM 也使用“压缩 oops”。因为数据大约每 8 或 16 个字节对齐一次，所以地址的 3 或 4 位是无用的（尽管某些算法可能会窃取“标记”位）。这允许 32 位地址数据（因此使用一半的带宽，因此速度更快）在 64 位平台上使用 35 位或 36 位的堆大小。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-24T06:12:22.880

所有字节码都是基于 8 位的。（这就是为什么它被称为 BYTE 代码）所有指令的大小都是 8 位的倍数。我们在 32 位机器上开发并使用 64 位 JVM 运行我们的服务器。

您能否详细说明您面临的问题？那么我们可能有机会帮助你。否则，我们只会猜测您遇到了什么问题。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-24T08:15:11.573

除非您有本机代码（为特定架构编译的机器代码），否则您的代码将在 32 位和 64 位 JVM 中同样运行良好。

但是请注意，由于更大的地址（32 位是 4 个字节，64 位是 8 个字节），对于相同的任务，64 位 JVM 将需要比 32 位 JVM 更多的内存。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-05T20:16:21.007

当您与本机库交互时，32 位与 64 位的区别确实变得更加重要。64 位 Java 将无法与 32 位非 Java dll 交互（通过 JNI）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-11-10T05:09:17.787

在创建 exe 时在配置中添加如下参数

[http://www.technimi.com/index.php?do=/group/java/forum/building-an-exe-using-launch4j-for-32-bit-jvm/](http://www.technimi.com/index.php?do=/group/java/forum/building-an-exe-using-launch4j-for-32-bit-jvm/)

我希望它有所帮助。

谢谢...

/jav

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-31T10:42:33.037

Java JNI 需要与 JVM 具有相同“bittiness”的操作系统库。例如，如果您尝试构建依赖于 IESHIMS.DLL（位于 %ProgramFiles%\Internet Explorer 中）的东西，则当您的 JVM 为 32 位时，您需要使用 32 位版本，当您的 JVM 为 64 位时，您需要使用 64 位版本。对于其他平台也是如此。

除此之外，您应该已准备就绪。生成的 Java 字节码 s/b 相同。

请注意，对于较大的项目，您应该使用 64 位 Java 编译器，因为它可以处理更多内存。

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2011-05-22T08:33:43.767

哟哪里错了！针对这个主题，我向 oracle 写了一个问题。答案是。

“如果你在 32 位机器上编译你的代码，你的代码应该只在 32 位处理器上运行。如果你想在 64 位 JVM 上运行你的代码，你必须使用 64 位机器在 64 位机器上编译你的类文件- 位 JDK。”

# tfs - 如何在 TFS 中分支和合并

> ID：783674
> 
> 赞同：24
> 
> 时间：2009-04-23T21:51:26.003
> 
> 标签：tfs, branch, merge

这个问题是上一个问题的衍生问题： [如何对跨项目共享的资源进行版本控制](https://stackoverflow.com/questions/761885/source-control-how-to-version-resources-that-are-shared-across-projects)

我有一个项目，其中包含许多其他项目使用的代码。具体来说，此父项目中的一个文件夹已分支到依赖子项目。

我们已经在父项目中进行了更改并签入。在源代码管理资源管理器中，我右键单击父项目中的分支文件夹并选择“合并”，打算将更改推送到依赖项目。我选择子项目作为目标，然后选择“最新版本”。向导通知我“没有要合并的更改”。

从我的角度来看，这不是真的，因为最近更新的文件明显不同。

这里对 TFS 中的合并过程有根本的误解吗？我需要做些什么不同的事情？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-11T23:35:49.670

TFS 合并引擎几乎完全依赖于历史，而不是文件内容。这使得它对于非常大的树很有效，并且对于像安全地挑选变化这样的任务很灵活——但它也使得回答你的问题变得困难。

第一步是了解诊断命令*tf history、tf merges*和*tf merge /candidate*。这是一个很好的介绍：http: [//blogs.msdn.com/dstfs/archive/2009/04/15/a-note-on-merging-and-the-use-of-tf-merges-tf-merge。 aspx](http://blogs.msdn.com/dstfs/archive/2009/04/15/a-note-on-merging-and-the-use-of-tf-merges-tf-merge.aspx)

如果您不熟悉 TFS 中的分支和合并，那么您的历史可能不是很复杂。我认为您可能会通过快速调用*tf merges*找到答案。但是，在一般情况下，跟踪合并历史可能会变得非常复杂，因此如果您遇到麻烦，请随时回复更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T02:08:41.890

转到您知道在“父”项目中已更改的特定文件。尝试仅合并该文件。不要检查任何东西；看看会发生什么。

需要注意的事项：合并工具不会包含分支后添加的文件。您必须明确分支新文件，然后才能合并任何进一步的更改。如果将文件添加到父文件夹和子文件夹而不使用分支操作，则合并工具不会将它们视为同一文件的版本（并且您无法合并它们之间的更改）。

# mysql - 在 MySQL 触发器中使用 IF 语句插入多行

> ID：783687
> 
> 赞同：2
> 
> 时间：2009-04-23T21:55:13.437
> 
> 标签：mysql, performance, triggers

我有一个触发器，当用户编辑数据时，它会将所做的更改存储在单独的表中。该数据以人类可读格式写在当前数据下方的网页上，即

23/04/09 22:47 James Smith 将租户名称从“George Hill”更改为“George Hilling”。

我的触发器看起来有点像这样 - （这是精简版）。

两个问题：

A）这在性能方面是否相当昂贵，如果是，是否有更好的方法可以采取？B）是否有一种更整洁的方法可以在没有所有 IF 的情况下使用某种循环来做到这一点？

```
DELIMITER //
CREATE TRIGGER repair_history AFTER UPDATE ON repairs
FOR EACH ROW
BEGIN
INSERT INTO repair_edit SET repair_id=NEW.repair_id,
edit_date_time=NEW.edit_date_time, edited_by=NEW.edited_by;

IF OLD.tenant_name != NEW.tenant_name THEN
INSERT INTO repair_history SET edit_id=LAST_INSERT_ID(), field='tenant_name',
former_field_value=OLD.tenant_name, new_field_value=NEW.tenant_name;
END IF;

IF OLD.priority != NEW.priority THEN
INSERT INTO repair_history SET edit_id=LAST_INSERT_ID(), field='priority',
former_field_value=OLD.priority, new_field_value=NEW.priority;
END IF;

IF OLD.property_id != NEW.property_id THEN
INSERT INTO repair_history SET edit_id=LAST_INSERT_ID(), field='property_id',
former_field_value=OLD.property_id, new_field_value=NEW.property_id;
END IF;

IF OLD.type_id != NEW.type_id THEN
INSERT INTO repair_history SET edit_id=LAST_INSERT_ID(), field='type_id',
former_field_value=OLD.type_id, new_field_value=NEW.type_id;
END IF;

END; //
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T22:05:26.657

为什么不在可以更新和检查的每一列上放置一个触发器。不过，这会对性能产生影响。您可能想要做的是在有触发器和没有触发器的地方进行单元测试，并查看快速更改多行时的时间差异。

[http://forums.mysql.com/read.php?99,174963,175381#msg-175381](http://forums.mysql.com/read.php?99,174963,175381#msg-175381)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T22:25:01.727

> A）这在性能方面是否相当昂贵

剖析它。只有您知道您正在使用什么硬件，以及您的数据库必须处理多少更新。

> 如果是这样，有没有更好的方法可以采取？

考虑一下在您的触发器中花费最多的时间。是比较还是插入？

> B）是否有一种更整洁的方法可以在没有所有 IF 的情况下使用某种循环来做到这一点？

不幸的是，我不知道如何索引伪表 NEW 和 OLD 的列

# java - 清除 HTTP 会话

> ID：783694
> 
> 赞同：0
> 
> 时间：2009-04-23T21:57:02.183
> 
> 标签：java, html

当我从超链接条目访问 HTML 表单时，我试图清除它的所有内容。

有任何想法吗？我的开发语言是java。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T22:00:31.113

你在使用会话范围的数据吗？如果是这样，请关闭浏览器并再次打开它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T00:02:33.333

我不确定应用程序是否正确，但实现此目的的一种方法是使用 JavaScript。例如，如果每次访问该页面时都清除表单是可以接受的，那么您可以编写一个快速函数，在页面加载时清除表单（即，使用`onload`事件）。

如果您只想在从该链接点击页面时清除表单，您可以在 URL 中添加一个参数（例如 clearForm=true）并使用 JavaScript 获取查询字符串并在该参数存在时清除表单。

当然，这是一个纯粹的客户端解决方案。对于服务器端解决方案，了解您使用的框架会很有帮助。

# .net - 通过 WCF 传递图像并将它们显示在 WPF 数据网格中

> ID：783702
> 
> 赞同：6
> 
> 时间：2009-04-23T21:59:18.260
> 
> 标签：.net, wpf, wcf, image

[在WCF](http://en.wikipedia.org/wiki/Windows_Communication_Foundation)服务中传递图像并在传递后将其显示在[WPF](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)数据网格中的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T12:22:37.360

我并不是说这是唯一或最好的解决方案，但我们让它像这样工作：

你需要做的是：

创建一个 WCF 方法，该方法将通过某个 id 或其他方式返回图像。它应该返回字节数组（byte[]）：

```
public byte[] GetImage(int id)
{
  // put your logic of retrieving image on the server side here
} 
```

在您的数据类（网格中显示的对象）中创建一个属性 Image，它的 getter 应该调用 WCF 方法并将字节数组转换为 BitmapImage：

```
public BitmapImage Image
{
  get
  {
  // here - connection is your wcf connection interface
  //        this.ImageId is id of the image. This parameter can be basically anything
  byte[] imageData = connection.GetImage(this.ImageId);    

  // Load the bitmap from the received byte[] array
  using (System.IO.MemoryStream stream = new System.IO.MemoryStream(imageData, 0, imageData.Length, false, true))
    {
    BitmapImage bmp = new BitmapImage();
    bmp.BeginInit();
    bmp.StreamSource = stream;

    try
      {
      bmp.EndInit();
      bmp.Freeze(); // helps for performance

      return bmp;
      }
    catch (Exception ex)
      {
      // Handle exceptions here
      }

    return null; // return nothing (or some default image) if request fails
    }
  }
} 
```

在您的单元格模板（或任何地方）中放置一个 Image 控件并将其 Source 属性绑定到上面创建的 Image 属性：

```
<DataTemplate> <!-- Can be a ControlTemplate as well, depends on where and how you use it -->
  <Image
    Source={Binding Image, IsAsync=true}
    />
</DataTemplate> 
```

在检索图像时不使 UI 冻结的最简单方法是像我一样将 IsAsync 属性设置为 false。但是还有很多需要改进的地方。例如，您可以在加载图像时显示一些加载动画。

可以使用 PriorityBinding 在加载其他内容时显示某些内容（您可以在此处阅读：http: [//msdn.microsoft.com/en-us/library/ms753174.aspx](http://msdn.microsoft.com/en-us/library/ms753174.aspx)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T04:45:51.420

您可以从流中加载 WPF 图像吗？如果是这样，那么您可以编写 WCF 服务以返回 System.IO.Stream 类型。

# apache-flex - 无法访问 htmlText 中的嵌入图像

> ID：783710
> 
> 赞同：3
> 
> 时间：2009-04-23T22:01:52.203
> 
> 标签：apache-flex, htmltext

可以`TextArea`使用以下属性将图像包含在控件中`htmlText`：

```
ta.htmlText = '<img src="http://..."/>'; 
```

如何**引用嵌入的图像**？

一个例子：

```
<mx:TextArea xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Script>
        <![CDATA[
            [Embed(source='../assets/img.gif')]
            public var img:Class;
        ]]>
    </mx:Script>
    <mx:htmlText>
        <![CDATA[
            <img src="???" />
        ]]>
    </mx:htmlText>
</mx:TextArea> 
```

**升级版：**

```
<img src='../assets/img.gif /> 
```

在本地机器上工作，但在服务器环境中它抛出：

```
错误 #2044：未处理的 IOErrorEvent：。文本=错误 #2035：未找到 URL。

```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-11-13T01:27:01.050

好的，我刚刚花了几个小时整理出来，但我已经让它在 Flash 和 Flex 中工作。

### 在 TextField 中显示图像

您可以将 DisplayObject 加载到 TextField`<img />`标记中，包括 MovieClip、Sprite 和嵌入的图像。

*   在 Flash 或 Flex 中，如果要显示嵌入的图像，则必须创建一个扩展`DisplayObject`类（例如 Sprite 或 MovieClip）的包装类。

*   确保您的文本字段足够大以包含图像。在测试期间，当我真的让 TextField 太小而无法显示整个图像时，我认为事情不正常。

* * *

## 闪存示例

简单的例子，所有代码都在主时间线上。

1.  在舞台上创建一个动态的 TextField。给它一个有用的名字，我叫我`txtImageTest`的。

2.  调整`txtImageTest`到合适的大小，例如 300x150px。

3.  创建一个新的 MovieClip 元件并给它一个类名，例如`imageClip1`。

4.  在您的新剪辑中绘制一些内容或在其中放置嵌入的图像`imageClip1`。

5.  返回主时间轴，取消选择所有对象并在第一帧打开 Actionscript 编辑器。

6.  在文本字段上打开多行和自动换行：

    ```
    imageClip1.wordWrap = true;
    imageClip1.multiline = true;
    imageClip1.htmlText = "<p>You can include an image in your HTML text with the &lt;img&gt; tag.</p><p><img id='testImage' src='imageClip1' align='left' width='30' height='30' hspace='10' vspace='10'/>Here is text that follows the image. I'm extending the text by lengthening this sentence until it's long enough to show wrapping around the bottom of the image.</p>" 
    ```

7.  保存并测试您的电影。

* * *

## 弹性示例

由于我们不能像在 Flash 中那样在库中创建新的 MovieClip，因此我们需要创建一个执行相同任务的新类（如果您想在库中创建新剪辑，此方法也适用于 Flash） .

这是我的黑色三角形子弹类，名为 BlackArrow.as：

```
// Set the correct package for you class here.
package embed
{
    import flash.display.Sprite;
    import mx.core.BitmapAsset;

    public class BlackArrow extends Sprite
    {
        // Embed the image you want to display here.
        [Embed(source='assets/embed/triangleIcon_black.png')]
        [Bindable]
        private var TriangleImage:Class;

        public function BlackArrow()
        {
            super();

            // Instantiate the embedded image and add it to your display list.
            var image:BitmapAsset = new TriangleImage();
            addChild(image);
        }

    }
} 
```

**注意：**不要扩展 Bitmap（在 Flash 中）或 BitmapAsset（在 Flex 中），因为它们在 TextField 中不能正确缩放或定位**。**选择 Sprite 或类似的东西。

下面是在 TextField 中显示此图像的类的示例：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml"
    width="100%" height="100%">

    <mx:Script>
    <![CDATA[
        import embed.BlackArrow;

        // You must include a variable declaration of the same type as your
        // wrapper class, otherwise the class won't be compiled into
        // the SWF and you will get an IOError.
        private var img2:BlackArrow;
    ]]>
    </mx:Script>

    <mx:Text id="txtResults1" width="100%" height="100%">
        <mx:htmlText>
        <![CDATA[<p>You can include an image in your HTML text with the &lt;img&gt; tag.</p><p><img id='testImage' src='embed.BlackArrow' align='left' hspace='10' vspace='10'/>Here is text that follows the image. I'm extending the text by lengthening this sentence until it's long enough to show wrapping around the bottom of the image.</p>]]>
        </mx:htmlText>
    </mx:Text>

 </mx:VBox> 
```

请注意，我在`src`图像标记的属性中使用了完全限定的类名。

* * *

### 最后的笔记

*   图像与文本字段的左侧或右侧对齐，由`align`图像标签的属性决定。这意味着您不能在不直接访问图像的情况下将图像放置在文本中间。

*   图片标签支持的属性列表在这里： http:
    [//blog.coursevector.com/notes-htmltext](http://blog.coursevector.com/notes-htmltext)

*   TextField LiveDoc 页面在这里：
    [http ://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextField.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextField.html)

*   该`getImageReference()`函数是您获取文本字段中图像参考所需的功能：http:
    [//livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextField.html#getImageReference%28%29](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextField.html#getImageReference%28%29)

*   `src`确保在属性中使用完全限定的类名。

*   确保声明包装类的变量以确保将其编译到 SWF 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-20T02:30:48.053

您可以将嵌入图像指定为 htmlText 中 HTML img 标记的 src，方法是使用完全限定的类名来引用它们，您可以使用`getFullyQualifiedClassName`) 来确定。像这样：

```
public class Example
{
    [Embed(source="myImage.png")
    public static const MyImage:Class;

    public function getHTMLImg() : String
    {
        return "<img src='" + getQualifiedClassName(MyImage) + "' />";
    }
} 
```

这比为每个可能嵌入的图像创建一个包装类要简单得多......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T22:08:14.480

尝试：

```
<mx:htmlText>
        <![CDATA[
           <p>
            <img src='../assets/butterfly.gif' 
                 width='30' height='30' 
                 align='left' 
                 hspace='10' vspace='10'>
            </p>
        ]]>
     </mx:htmlText> 
```

请参阅[文档](http://livedocs.adobe.com/flex/3/html/help.html?content=textcontrols_04.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-31T11:02:55.607

我一直在寻找同样的东西。使用**嵌入式**图像背后的想法是防止从外部 URL 加载所述图像。所以接受的答案实际上并不能解决问题。我看过文档，他们在那里也使用了一个 URL，并且该图像不会被编译到 swf 中，而是会在运行时从服务器加载。为什么他们称该嵌入图像可能是因为它嵌入在文本中，但我正在寻找的是使用嵌入在编译代码中的图像。

为什么要在 htmlText 中使用嵌入式图像显示？因为这是在工具提示中显示图像的最简单方法（您只需覆盖默认工具提示类以设置 htmlText 而不是文本，并将其设置为 TooltipManager 中的默认工具提示类）。在我的搜索中，我发现了这个：[http](http://groups.google.com/group/flex_india/browse_thread/thread/cf0aa62afaae3fdc/b21f462f8d5da117?pli=1) ://groups.google.com/group/flex_india/browse_thread/thread/cf0aa62afaae3fdc/b21f462f8d5da117?pli=1 。尚未对其进行测试，我想问题将出现在确定该链接 ID 上。当我有它们时，我会回来提供更多细节。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-19T06:44:27.740

Sly_cardinal 写了一个非常有用的答案。非常感谢他！我半天都解决不了这个问题。Sly_cardinal 注意到，如果你这样做 getQualifiedClassName（嵌入位图）图像被插入的文本不正确只是到左上角。Sly_cardinal 提供了一个包装类。

我想附加一个他的答案

一个新的类包装器 ImageWrapper.as ->

```
package 
{
import flash.display.Bitmap;
import flash.display.Sprite;
public class ImageWrapper extends Sprite{
    public static var img:Class;
    public function ImageWrapper() {
        var bitmap:Bitmap = new img();
        addChild(bitmap);
    }
}
} 
```

代码中的调用：

```
[Embed(source = "img/MyImg.png")] var _MyImg:Class;
ImageWrapper.img = _MyImg;
tf.htmlText = "My text, and my image <img src='ImageWrapper'>"; 
```

就是这样。谢谢！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T22:06:35.390

尝试

```
src='../assets/img.gif' 
```

取自：[使用 htmlText 属性](http://livedocs.adobe.com/flex/3/html/help.html?content=textcontrols_04.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-09T03:50:42.013

使用 src='assets/img.gif' 但您必须在部署应用程序 SWF 的服务器目录中创建一个 assets 目录，并将您的 img.gif 文件放在那里。在 html 中，它正在寻找与 SWF 文件相关的文件。

这将允许您在开发和部署位置使用相同的文件和位置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-15T08:30:09.223

它可以在 localhost 上运行，因为您在机器上有图像，因此您可以加载它。如果要嵌入它，它不会上传到服务器上的指定目录中，而是包含在 .SWF 文件本身中。在生产输出的相应位置上传图像（浏览它以从您的源文件文件夹上传）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-04T10:03:04.440

**小伙伴们不用再为难自己了！**从现在开始，导入 MovieClip 就不是什么大问题了！借助名为 TextArea 的新类（不是 TextArea 组件，它是一个 OOP 类，是原始 TextField 类的扩展）。

**我们不再需要嵌入或库**，我们可以在任何地方使用 TextArea 而不是 Textfield，这使我们能够导入我们自己的 SWF 文件，例如视频播放器、说话的头像或任何其他文本行。

它有很多更多的功能，并不特别局限于这个问题。查看[www.doitflash.com](http://www.doitflash.com)了解更多信息，**该网站提供平台，下载也是免费的**:)

# latex - LaTeX 中的脚注间距

> ID：783716
> 
> 赞同：39
> 
> 时间：2009-04-23T22:04:29.793
> 
> 标签：latex, margin, lyx, footnotes

我正在写我的论文，研究生院说我需要多个脚注之间的空间，而且文本和脚注开头之间的空间太小。有没有办法做到这一点？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-04-23T22:13:36.417

`\footnotesep`是脚注之间的空格：

```
\setlength{\footnotesep}{0.5cm} 
```

`\footins`是正文和脚注之间的空格：

```
\setlength{\skip\footins}{2cm} 
```

你可能想玩弄实际的数字，我刚刚选择了一些你会真正看到差异的值。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-09-08T13:30:30.447

还有一个 LaTeX 包[footmisc](http://www.ctan.org/pkg/footmisc)，可用于处理脚注格式。

# asp.net-mvc - ASP.NET MVC 视图后处理

> ID：783721
> 
> 赞同：0
> 
> 时间：2009-04-23T22:06:00.367
> 
> 标签：asp.net-mvc

在 Monorail 中，有一个变换过滤器的概念，然后可以对渲染的视图进行进一步的处理。用例：

*   处理降价
*   删除空格
*   去除不需要的字符

我怀疑在 ASP.NET MVC 中没有开箱即用的方法可以做到这一点，但有人有建议的方法吗？我正在使用 NVelocity 视图引擎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T22:39:24.890

创建一个自定义 ActionFilter 并覆盖 OnResultExecuted 方法以进行额外处理，然后使用该属性装饰您的控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T23:02:25.363

我实施的一个可能的解决方案是创建一个自定义 ViewResult 并在那里完成工作。这不是一个优雅的解决方案，因为我基本上只是将正常的实现复制并粘贴到覆盖的 ExecuteResult 中，并在那里调整了呈现的输出。这一行：

```
View.Render(viewContext, context.HttpContext.Response.Output); 
```

变成：

```
TextWriter writer = new StringWriter();

View.Render(viewContext, writer);

string renderedResult = writer.ToString();

renderedResult = renderedResult.Replace("hello", "goodbye");

context.HttpContext.Response.Output.Write(renderedResult); 
```

相关来源在这里： [http ://aspnet.codeplex.com/SourceControl/changeset/view/23011#288022](http://aspnet.codeplex.com/SourceControl/changeset/view/23011#288022)

这是一种非常可怕的 IMO 方式，但它确实有效。

# sql - 如何在 SQL Server 中使用 INNER JOIN 从多个表中删除

> ID：783726
> 
> 赞同：128
> 
> 时间：2009-04-23T22:06:56.793
> 
> 标签：sql, sql-server, tsql

在 MySQL 中，您可以使用语法

```
DELETE t1,t2 
FROM table1 AS t1 
INNER JOIN table2 t2 ...
INNER JOIN table3 t3 ... 
```

我如何在 SQL Server 中做同样的事情？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2009-05-01T01:45:32.620

您可以利用此示例中的“已删除”伪表。就像是：

```
begin transaction;

   declare @deletedIds table ( id int );

   delete from t1
   output deleted.id into @deletedIds
   from table1 as t1
    inner join table2 as t2
      on t2.id = t1.id
    inner join table3 as t3
      on t3.id = t2.id;

   delete from t2
   from table2 as t2
    inner join @deletedIds as d
      on d.id = t2.id;

   delete from t3
   from table3 as t3 ...

commit transaction; 
```

显然，您可以执行“输出已删除”。如果您需要为第三张表加入某些内容，那么在第二次删除时也是如此。

作为旁注，您还可以在插入语句上执行插入。*，以及在更新语句中插入。*和删除。*。

**编辑：** 另外，您是否考虑过在 table1 上添加一个触发器以从 table2 + 3 中删除？您将处于一个隐式事务中，并且还将有“已插入*”和“已删除*”伪表可用。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-23T22:13:06.433

1.  您始终可以对表的关系设置级联删除。

2.  您可以将多个删除操作封装在一个存储过程中。

3.  您可以使用事务来确保一个工作单元。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-23T22:18:27.170

您可以在 SQL Server 的 DELETE 的 FROM 子句中使用 JOIN 语法，但您仍然只能从第一个表中删除，它是专有的 Transact-SQL 扩展，可以替代子查询。

从[这里的](http://msdn.microsoft.com/en-us/library/ms189835.aspx)例子：

```
 -- Transact-SQL extension
 DELETE 
   FROM Sales.SalesPersonQuotaHistory 
     FROM Sales.SalesPersonQuotaHistory AS spqh INNER JOIN 
          Sales.SalesPerson AS sp ON spqh.BusinessEntityID = sp.BusinessEntityID
    WHERE sp.SalesYTD > 2500000.00; 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-04-07T13:03:59.913

从主表中删除一些记录并从两个明细表中删除相应记录的示例：

```
BEGIN TRAN

  -- create temporary table for deleted IDs
  CREATE TABLE #DeleteIds (
    Id INT NOT NULL PRIMARY KEY
  )

  -- save IDs of master table records (you want to delete) to temporary table    
  INSERT INTO #DeleteIds(Id)
  SELECT DISTINCT mt.MasterTableId
  FROM MasterTable mt 
  INNER JOIN ... 
  WHERE ...  

  -- delete from first detail table using join syntax
  DELETE d
  FROM DetailTable_1 D
  INNER JOIN #DeleteIds X
    ON D.MasterTableId = X.Id

  -- delete from second detail table using IN clause  
  DELETE FROM DetailTable_2
  WHERE MasterTableId IN (
    SELECT X.Id
    FROM #DeleteIds X
  )

  -- and finally delete from master table
  DELETE d
  FROM MasterTable D
  INNER JOIN #DeleteIds X
    ON D.MasterTableId = X.Id

  -- do not forget to drop the temp table
  DROP TABLE #DeleteIds

COMMIT 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-23T22:40:32.110

基本上，不，您必须在事务中进行三个删除语句，首先是孩子，然后是父母。如果这不是一次性的事情并且它的存在不会与任何现有的触发器设置冲突，那么设置级联删除是一个好主意。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-04-24T07:03:55.877

只是想知道..这在 MySQL 中真的可能吗？它会删除t1和t2吗？或者我只是误解了这个问题。

但是如果你只是想删除具有多个连接条件的table1，只是不要为你想删除的表加上别名

这：

```
DELETE t1,t2 
FROM table1 AS t1 
INNER JOIN table2 t2 ...
INNER JOIN table3 t3 ... 
```

应该这样写才能在 MSSQL 中工作：

```
DELETE table1
FROM table1 
INNER JOIN table2 t2 ...
INNER JOIN table3 t3 ... 
```

对比其他两个常见的 RDBMS 如何执行删除操作：

[http://mssql-to-postgresql.blogspot.com/2007/12/deleting-duplicates-in-postgresql-ms.html](http://mssql-to-postgresql.blogspot.com/2007/12/deleting-duplicates-in-postgresql-ms.html)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-24T06:50:01.310

在 SQL Server 中，无法使用连接从多个表中删除记录。因此，您必须先从子级删除，然后再删除父级。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-08-06T05:55:01.873

都已经指出来了。只需`DELETE ON CASCADE`在父级上使用或从then中`table`删除。`child-table``parent`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-07-14T16:15:38.227

这是在不留下孤儿的情况下删除记录的另一种方法。

```
声明 @user Table(keyValue int , someString varchar(10))
插入@user
值（1，'1 值'）

插入@user
值（2，'2 值'）

插入@user
值（3，'3 值'）

声明@password 表（keyValue int，详细信息 varchar(10)）
插入@password
值（1，'1 密码'）
插入@password
值（2，'2密码'）
插入@password
值（3，'3 密码'）

        --删除前
  select * from @password a 内连接 @user b
                a.keyvalue = b.keyvalue
  select * into #deletedID from @user where keyvalue=1 -- 这与输出示例类似
  删除键值 =1 的 @user
  删除@password where keyvalue in（从#deletedid中选择keyvalue）

  --删除后--
  select * from @password a 内连接 @user b
                a.keyvalue = b.keyvalue

```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-23T22:17:05.567

正如 Aaron 已经指出的那样，您可以将删除行为设置为 CASCADE，这样会在删除父记录时删除子记录。除非您希望发生某种其他魔法（在这种情况下，Aaron 的回复的第 2、3 点会很有用），否则我不明白您为什么需要使用内部连接进行删除。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-10-24T10:27:00.470

以 John Gibb 的回答为基础，删除具有 FK 关系的两个表中的一组数据：

```
--*** To delete from tblMain which JOINs to (has a FK of) tblReferredTo's PK  
--       i.e.  ON tblMain.Refer_FK = tblReferredTo.ID
--*** !!! If you're CERTAIN that no other rows anywhere also refer to the 
--      specific rows in tblReferredTo !!!
BEGIN TRAN;

    --*** Keep the ID's from tblReferredTo when we DELETE from tblMain
    DECLARE @tblDeletedRefs TABLE ( ID INT );
    --*** DELETE from the referring table first
    DELETE FROM tblMain 
    OUTPUT DELETED.Refer_FK INTO @tblDeletedRefs  -- doesn't matter that this isn't DISTINCT, the following DELETE still works.
    WHERE ..... -- be careful if filtering, what if other rows 
                --   in tblMain (or elsewhere) also point to the tblReferredTo rows?

    --*** Now we can remove the referred to rows, even though tblMain no longer refers to them.
    DELETE tblReferredTo
    FROM   tblReferredTo INNER JOIN @tblDeletedRefs Removed  
            ON tblReferredTo.ID = Removed.ID;

COMMIT TRAN; 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2012-02-13T12:34:33.730

```
DELETE     TABLE1 LIN
FROM TABLE1 LIN
INNER JOIN TABLE2 LCS ON  CONDITION
WHERE CONDITION 
```

* * *

## 回答 #13

> 赞同：-5
> 
> 时间：2013-07-17T18:32:20.777

$sql="DELETE FROM `basic_tbl`, `education_tbl`, `personal_tbl`, `address_tbl`, `department_tbl` USING `basic_tbl`, `education_tbl`, `personal_tbl`, `address_tbl`, `department_tbl` WHERE `b_id`= `e_id`= `p_id`= `a_id`= `d_id`='".$id."' "; $rs=mysqli_query($con,$sql);

# javascript - 嵌套的 insert_html 错误：Ruby On Rails 和 Javascript

> ID：783727
> 
> 赞同：3
> 
> 时间：2009-04-23T22:07:10.583
> 
> 标签：javascript, ruby-on-rails

嘿大家！这个问题快把我逼疯了！这似乎是 Rails 渲染 JS 的一个错误，但我不确定。

简介：

我正在尝试创建一个包含多个轨道的 RELEASE。这些 TRACKS 有许多 TRACK_LINKS。然后这些 TRACK_LINK 具有关联的 TRACK_LINK_TYPE（mp3、m3u、播客等）。把它想象成一张专辑。因此，在添加版本时，您可以添加专辑曲目，并且每个专辑曲目可以有不同的链接（mp3、m3u、播客等）。我处于非常早期的阶段并利用脚手架 - 用户可以在表单上创建发布，通过 JS 添加轨道并通过 JS 添加轨道链接。这一切都很好——但是当我在代码中有“添加轨道链接”功能时，添加轨道不起作用！它默默地失败 - 没有错误，只是转到 # 锚点。

在主发布表单中，我正在渲染 TRACK 部分并添加链接以添加 TRACK：

```
<div id="tracks">
    <%= render :partial => 'track', :collection => @release.tracks -%>
</div>

<%= add_track -%> 
```

现在在 TRACK 部分中，我正在渲染 TRACK_LINK 部分并添加链接以添加 TRACK_LINK：

```
<div class="track">
    <fieldset>
    <legend>Track</legend>
    <p> 
        <% @track = track %>
    <%= error_messages_for :track -%>

        <% fields_for_track(track) do |track_form| -%>
        Track Name
    <br />
    <%= track_form.text_field :name -%>
    <%= link_to_function "remove", "$(this).up('.track').remove()" -%>
    <% track_links_id = "track_links_#{Time.now.to_i.to_s}" %>
    <div id="<%= track_links_id %>">
            <%= render :partial => 'track_link', :collection => @track.track_links -%>              
    </div>
    <%= add_track_link track_links_id -%>   
    <% end -%>
    </p>
</fieldset>
</div> 
```

在 TRACK_LINK 部分中，我正在创建 TRACK_LINK 字段（及其关联的 TRACK_LINK_TYPE 字段）：

```
<div class="track_link">
    <% @track_link = track_link -%>
<% fields_for_track_link(track_link) do |track_link_form| -%>
    Track Link
    <br />
    <%= track_link_form.text_field :url -%>
    <%= select ("track_link_type", "id", @track_link_type.map {|type| [type.name, type.id]}) -%>        
        <%= link_to_function "remove", "$(this).up('.track_link').remove()" -%>     
<% end -%>
</div> 
```

最后，这里是 link_to_function 辅助方法：

```
module ReleasesHelper
    def fields_for_track(track, &block)
        prefix = track.new_record? ? 'new' : 'existing'
        fields_for("release[#{prefix}_track_attributes][]", track, &block)
    end

    def fields_for_track_link(track_link, &block)
        prefix = track_link.new_record? ? 'new' : 'existing'
        fields_for("track[#{prefix}_track_link_attributes][]", track_link, &block)
    end

    def add_track
        track = Track.new
        track.track_links.build
        link_to_function 'Add Track' do |page| 
            page.insert_html :bottom, :tracks, :partial => 'track', :object => track
    end
end

    def add_track_link(name)
        link_to_function "Add Track Link" do |page|       
            page.insert_html :bottom, name, :partial => 'track_link', :object => TrackLink.new
    end
end
end 
```

结果是每个 link_to_function 都可以正常工作，但是当我同时具有“添加轨道”和“添加轨道链接”功能时，“添加轨道”link_to_function 不起作用。渲染“添加轨道链接”功能的一些东西把它搞砸了！为长篇大论道歉！希望它不烦人，有人可以伸出援助之手吗？

最好的，普拉文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T20:36:18.887

看看[https://github.com/nathanvda/cocoon](https://github.com/nathanvda/cocoon)。文档很好，它可以节省您编写和维护此代码的时间。如果您有兴趣了解它的工作原理，请查看源代码（它并不太复杂）。祝你好运！

# git - Git合并展平

> ID：783731
> 
> 赞同：43
> 
> 时间：2009-04-23T22:08:24.370
> 
> 标签：git, git-pull, git-push, git-merge

如果我在多个分支中处理单个功能，我会使用`git pull branch1 branch2 branch3`将所有更改拉入我的主分支。但是，每个分支的所有提交日志也会被复制。如何将提交日志扁平化为一条消息？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-04-24T18:26:07.330

“git merge --squash”（在“git fetch”之后；“git pull”只是 fetch+merge，也许它也允许 --squash 选项）**可能**是你想要的。

从[git-merge(1)](http://www.kernel.org/pub/software/scm/git/docs/git-merge.html)：

> - 壁球
> 
> > 生成工作树和索引状态，就好像发生了真正的合并一样，但实际上并不进行提交或移动 HEAD，也不记录 `$GIT_DIR/MERGE_HEAD` 以导致下一个 git commit 命令创建合并提交。 这允许您在当前分支的顶部创建*单个提交，其效果与合并另一个分支相同（或者在章鱼的情况下更多）。*

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-23T23:06:01.533

您可以使用交互式[rebase](http://git-scm.com/docs/git-rebase)并“压缩”提交 - 另请参阅[Git Ready Tutorial on squashing via rebase](http://www.gitready.com/advanced/2009/02/10/squashing-commits-with-rebase.html)。很抱歉只给你一个链接，但这是一个非常彻底的教程。哦，这也会很好地消除您的合并。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-09-02T11:19:37.380

正如 Brian White 评论的那样，问题`git merge --squash`在于它没有给您任何可见的链接，因此无法追溯到您合并的分支（或单个更改）。

可见（当被视为图表时`git log --graph`），一个已合并回来的重要分支看起来与您搞砸并乐意丢弃的实验分支没有什么不同。两者都只是挂在那里，与任何东西无关。我个人想知道某个分支已被合并回来，所以我知道工作已经完成。

一个对我有用的解决方案是使用带有 no-fastforward 选项的合并。

```
git merge --no-ff somebranch -m "my commit message" 
```

这会强制 git 创建包含所有分支更改的单个提交，您可以自己设置提交消息（如果需要）但最重要的是，它将新提交链接回它刚刚合并的分支。这明显表明工作在该分支上已完成，但还允许您回溯以查看合并分支中各个提交的详细信息。

这是一个示例，其中非常简单的分支分别具有一个和两个提交已合并回 master。我随后删除了合并分支上的分支标签，但是仍然可以在合并提交消息中看到分支名称。分支名称应该总结更改，如果您想知道包含的确切更改，您可以将其追溯到各个提交。这种方法似乎适用于简单的项目。

注意：我不得不手动绘制其中一个连接器，因为它是如此深蓝色，几乎看不到。

[![git 日志输出](https://i.stack.imgur.com/QZCTw.jpg)](https://i.stack.imgur.com/QZCTw.jpg)

# asp.net - 是否可以完全否定子文件夹中的“更高” web.config？

> ID：783732
> 
> 赞同：12
> 
> 时间：2009-04-23T22:08:25.167
> 
> 标签：asp.net, web-config

是否可以完全否定子文件夹中的 web.config？

显然，我在根目录中有一个 web.config。

如果我有一个名为“MyApp”的子文件夹，我可以在其中编写一堆代码并让它在不引用根目录下的 web.config 的情况下运行吗？它会有自己的 web.config，甚至不会在根目录中引用“更高”的 web.config。

我正在寻找的是完整的应用程序隔离。我希望能够在现有站点的子文件夹中编写一个应用程序，它会忽略它上面的整个 web.config 层次结构——该应用程序本身就是一个孤岛。

我知道我可以使用“clear”元素，但这是最好的方法吗？只需在每个顶级元素下放置一个“清除”？只是想知道是否还有其他方法。

子应用程序是否[会从其父 web.config 继承？](https://stackoverflow.com/questions/778635/will-a-child-application-inherit-from-its-parent-web-config)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T21:50:40.960

在根目录的 web.config 文件中，`<system.web>`使用以下元素包装该元素：`<location path="." inheritInChildApplications="false"></location>`

查看此链接以获取参考：

[http://www.jaylee.org/post/2008/03/Prevent-ASPNET-webconfig-inheritance-and-inheritInChildApplications-attribute.aspx](http://www.jaylee.org/post/2008/03/Prevent-ASPNET-webconfig-inheritance-and-inheritInChildApplications-attribute.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T04:50:59.457

不，为了共享主机和简单性而设计的。

IIS7 通过允许显式锁定/解锁配置来稍微改变这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T09:38:27.537

是的，您必须清除那些想要覆盖的部分。再想一想，这是有道理的，因为清除所有内容的唯一方法可能很难弄清楚要清除的内容。Clear 通常会重置所有内容，包括 web.configs 中的根 web.configs 和服务器上 frameworks /config 文件夹中定义的 machine.config。

请注意，您还将无法访问 /bin 文件夹、/app_code 文件夹等。这可能是您想要的，也可能不是。

是否可以使用主机创建子应用程序也是要考虑的另一件事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T19:02:34.987

这听起来更像是您应该创建一个完全是另一个应用程序根目录的虚拟目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-25T08:19:53.153

我刚刚在工作中遇到了这个问题，我的解决方案是创建一个新网站，而不是尝试将我的应用程序嵌套在现有网站下。我为新应用程序（即 www.mysite.com ）保持域映射相同，但更改了端口号/映射。

因此，我可以在 www.mysite.com:88 上使用我的新应用程序，而不必使用子域。

这里需要注意的是，我的应用程序是一个 Web 服务，因此必须在 URL 中指定端口号对我来说是可能的。这对你来说可能不是一个选择，但我想我会发布这个以防万一它可以帮助我遇到这种情况的人。

该`<location path="." inheritInChildApplications="false"></location>`解决方案不是我的选择，因为`inheritInChildApplications`在 ASP.Net Framework 4.0 之前似乎不存在？

# c - C中的指针问题

> ID：783733
> 
> 赞同：2
> 
> 时间：2009-04-23T22:08:51.857
> 
> 标签：c, pointers

问候，我正在尝试学习 C 中的指针，我只是希望我的“addtwo”函数将 2 添加到输入整数数组的每个元素，但我得到奇怪的编译错误，这里是非指针版本，确实不会正确编译。

```
addtwo(int *arr[]) {
    int i=0;
    for(;i< sizeof(arr)/sizeof(int);i++) {
        arr[i] = arr[i] + 2;
    }
}

main() {
    int myarray[] = {1,2,3,4};
    addtwo(myarray);
} 
```

问候

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T22:15:18.270

你有一些问题。首先，您尝试将 a 传递`int*`给 type 的参数`int**`。那是行不通的。给它类型`int*`：

```
void addtwo(int *arr){
    int i=0;
    for(;i< sizeof(arr)/sizeof(int);i++){
        arr[i] = arr[i] + 2;
    }
} 
```

然后，您需要在附加参数中传递大小。问题是，当您传递数组时，您实际上只传递了一个指针（编译器将组成一个指向数组第一个元素的临时指针）。因此，您需要自己跟踪大小：

```
void addtwo(int *arr, int size){
    int i=0;
    for(;i<size;i++){
        arr[i] = arr[i] + 2;
    }
}

int main(void) {
    int myarray[] = {1,2,3,4};
    addtwo(myarray, sizeof myarray / sizeof myarray[0]);
} 
```

现在它将起作用。还要将返回类型放在它们之前。一些编译器可能会拒绝您的代码，因为它不再符合最新的 C 标准，并且早已被弃用（省略返回类型是您使用旧 K&R C 编码的方式）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T22:10:04.023

`addtwo(int *arr[])`应该`addtwo(int *arr)`

您不能使用 sizeof 从指针中获取数组的大小。通常，您可以将数组的大小作为单独的 arg 传递，或者使用一些特殊值标记最后一个元素。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T22:12:11.320

与编译错误无关，但是...

您必须将 sizeof(arr) 传递给函数，而不是在函数中调用它。当数组传递给函数时，C 不再将其视为数组，而是将其视为指向内存的单个指针，因此您现在调用的 sizeof(arr) 将返回指针 arr 的大小，即最有可能 4。

这就是我在代码中的意思：

```
void addtwo(int *arr, int size){
    int i=0;
    for(;i< size;i++){
        arr[i] = arr[i] + 2;
    }
}

int main(){
    int myarray[] = {1,2,3,4};
    addtwo(myarray, sizeof(arr)/sizeof(int));
    return 0; 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T22:12:40.787

在 C 中，符号 int *arr[] 与 int** arr 相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T22:15:02.780

您需要将指针传递给数组的第一个元素和数组大小。数组类型在函数参数的上下文中衰减为指针。尝试：

```
void addtwo(int *arr, size_t size){
    for(size_t i = 0; i < size; i++){
        arr[i] = arr[i] + 2;
    }
}

int main() {
    int v[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 0 };
    addtwo(v, sizeof v / sizeof v[ 0 ]);
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T22:16:12.293

虽然其他人已经给出了正确的响应，但基本上你有一个指针数组，当你有

```
int *arr[] 
```

我怀疑那是你想要的。如果你有

```
int arr[] 
```

那么这也将等同于

```
int *arr 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T22:21:12.640

addtwo 参数声明实际上是：

*arr 是指向整数的指针数组*

当你可能真的想要

*指向整数数组的指针*

“[如何阅读 C 声明](http://www.antlr.org/wiki/display/CS652/How+To+Read+C+Declarations?showComments=true&showCommentArea=true)”确实帮助我了解了刚才的话题，也许它对你也有同样的作用。

# visual-studio - 为什么在我编辑文件时不会自动从 VSS 签出文件？

> ID：783738
> 
> 赞同：1
> 
> 时间：2009-04-23T22:10:09.687
> 
> 标签：visual-studio, version-control, visual-sourcesafe, vcs-checkout

这让我发疯，并导致失去工作（至少不多）。

通常，当我在 Visual Studio 中编辑文件时，它应该在源代码安全中自动检出该文件。在多项目解决方案（例如，带有类库的 Web 应用程序）中，有时一个项目中的所有文件都不会自动检出，但退出和重新加载 Visual Studio 可能会暂时解决该问题。此外，项目文件永远不会自动签出。每当我添加/删除代码文件时，我都必须记得明确检查项目文件（否则我们将遇到代码文件未显示在解决方案资源管理器中的问题，或者尝试加载不存在的文件）。

我们正在使用 VS-2008 和 VSS 2005。你知道我该如何解决这个问题吗？Microsoft Update 上没有更多的 visual-studio 更新/修复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T22:18:00.790

您需要确保文件是只读的，否则 VS 将无法判断它们是受版本控制的（或者，至少它是用来确定它的）。您可以告诉 VSS 自行设置，以便获取最新版本将文件 RW 放在磁盘上。

这里可能还有其他问题，但这是首先想到的。我的建议（我自己接受的）是迁移到 SVN 或替代方案。失去工作是不可接受的。

# vb.net - LINQ to SQL 并使用 OR 子句连接两个表

> ID：783742
> 
> 赞同：5
> 
> 时间：2009-04-23T22:11:20.870
> 
> 标签：vb.net, linq, linq-to-sql, where

假设我有计划和文件

```
Dim myPlans = _context.Plans.Where(predicate1)
Dim myDocuments = _context.Documents.Where(predicate2) 
```

我为每个使用 PredicateBuilder 构建了 where 子句。因此，myPlans 和 myDocuments 具有正确的 SQL 语句。

我想做的是将这两个表连接到一个 linq 语句中。我遇到的问题是，默认情况下 AND 条件是加入 where 子句。

myPlans Where 子句 : (p.name like "%test%" AND p.name like "%bed%") OR (p.description like "%test%" AND p.description like "%bed%")

myDocuments Where 子句 : (d.name like "%test%" AND d.name like "%bed%") OR (d.description like "%test%" AND d.description like "%bed%")

当我将两者结合起来时，**所需**的结果 Where 子句是：
Where (d.ID = p.ID) AND (myplans where 子句) **OR** (mydocument where 子句)。意思是，我希望每个表中的两个 where 子句是“或”而不是“和”。

当前结果 where 子句是：Where (d.ID = p.ID) AND (myplans where clause above) **AND** (mydocument where clause above)。意思是，我希望每个表中的两个 where 子句是“或”而不是“和”。

我正在形成这样的声明：

```
Dim test = From d in myDocuments _
           Join p in MyPlans on d.ID Equals p.ID _
           Select d.Name, p.Name 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T08:38:45.550

为了达到您想要的结果，您需要在单个语句上进行谓词过滤和连接。

```
Dim myCriteria() = {"test", "bed"}
Dim test = from d in _context.Documents _
           join p in _context.Plans on d.ID Equals p.ID _
           where (myCriteria.Contains(d.Name) OR _
                   myCriteria.Contains(d.Descrition)) _
           OR (myCriteria.Contains(p.Name) OR _
                 myCriteria.Contains(p.Description)) _
           select Document = d.Name, Plan = p.Name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T18:28:00.703

发生这种情况是因为您正在执行“第一次通过”，它过滤与您的谓词匹配的计划和文档，*然后*仅加入这些结果，有效地执行`AND`. 就像 Basilio 说的，你应该在同一个过程中做你的加入/过滤。你可以尝试这样的事情：

```
Dim test = From d in _context.Documents _
           Join p in _context.Plans on d.ID Equals p.ID _
           Where predicate1(p) Or predicate2(d)
           Select d.Name, p.Name 
```

或类似地：

```
Dim test = From d in _context.Documents _
           From p in _context.Plans _
           Where d.ID = p.ID And (predicate1(p) Or predicate2(d))
           Select d.Name, p.Name 
```

# php - 在不同机器上开发时的文件系统权限

> ID：783745
> 
> 赞同：1
> 
> 时间：2009-04-23T22:12:02.833
> 
> 标签：php, permissions, development-environment, chmod

我在不同的 linux 机器上使用的便携式卷（usb 驱动器上的 truecrypt 卷）上安装了 xampp（apache + mysql + php）堆栈，用于 webapp 开发。

这个卷是用 ext3 格式化的，所以我遇到了权限问题，因为我不能在每台机器上都是同一个用户。例如，我试图检查在另一台机器上启动的项目的 git 状态，但访问被拒绝。

上次我遇到类似的问题时，我做了 chmod 777 （或者是 chown？）整个目录，所以我猜我的 php 文件的权限状态是混乱的。这次我也担心像 git 文件和我最近安装的 symfony web 框架这样的特殊情况。

我应该如何处理这种情况？我很想正确设置此权限问题。

非常感谢您的关注。

* * *

编辑：每次我使用不同的机器时，我可能需要在本地编写一个脚本“sudo chown lampp:lamppusers”。或者一些带有本地存储库导出的 git voodoo 技巧？任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T22:26:12.923

我怀疑有没有这样的方法——你可以尝试使用 SELinux ACLs 而不是通常的权限，但我认为这对你来说太过分了。

我建议使用 chmod 将整个目录设置为 777（chown 更改所有权），因为每个用户所在的用户和组在每台机器上都会有所不同，你真的不能做得更好。您在这里唯一的问题是安全性-但是出于您自己的目的，它在您的本地盒子上，我认为没有问题。直到您将文件复制到服务器，然后您最好将它们正确设置回来。

您可以尝试针对 LDAP 服务器进行身份验证，您将检索您输入的用户名的 uid，并将其映射到每台 PC 上的相同 uid，因此您可以设置一次组或所有者。（我认为，您必须询问对 LDAP ud 映射更有经验的人）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T16:39:04.857

这似乎是我找到的最好的解决方案：

```
sudo chown -R polypheme:lamppusers webdir 
```

这样我就可以用我的本地用户名和我的本地组再次拥有整个目录。

*   polypheme 是一个用户名
*   Lamppusers 是一个组名
*   webdir 是包含我所有 Web 开发文件的目录

请注意，在计算机 1 上，我的用户名是 polypheme，我属于 Lamppusers 组，在计算机 2 上，我的用户名是 polypheme，我属于 Lamppusers 组。用户名和组名完全相同。如果名字碰巧不同，我不能 100% 确定这会完美地工作。

我没有修改任何很好的 chmod，因为问题比简单地用全局扁平化每个文件权限要复杂得多

```
chmod -R 744 webdir 
```

在 symfony 框架中处理受保护的文件是错误的。我猜也是 .git/ 文件。（gbjbaanb 是对的）

在这一点上，我已经恢复了我以前在另一台机器上的相同配置，这正是我正在寻找的。我又可以工作了。

知道了这一点，我的问题突然显得很愚蠢。好吧，多计算机环境使它变得非常棘手，因此变得有价值。（至少对我来说）

*（此答案将在经过适当测试后立即得到验证）*

# .net - 是否有可靠的方法使 Compact Framework 和桌面项目与 Visual Studio 2008 保持同步？

> ID：783750
> 
> 赞同：3
> 
> 时间：2009-04-23T22:13:20.100
> 
> 标签：.net, compact-framework, cross-platform

我正在开发一个面向 Full/Desktop .Net Framework 和 Compact .Net Framework 的 SDK。因此，我有一个解决方案，其中包含紧凑框架和完整框架的项目。项目文件包含相同的源文件，或者应该。与我一起开发此 SDK 的一些开发人员仅在完整的框架方面工作。他们不时将文件添加到完整的框架项目中，但忘记将其添加到紧凑的框架项目中。最终，其他一些代码（已经在两个项目中）引用了这种新类型。然后当晚构建失败，因为紧凑框架项目不包含新文件。有谁知道验证两个项目文件是否同步的工具或技巧？请记住，这些文件并不相同（一个用于紧凑框架，另一个用于完整框架）。

顺便说一句，在你提到它之前，我已经阅读了 The Moths 的博客文章。

帕特奥

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T06:12:34.067

是的，有一个技巧；-p 考虑一下我的 protobuf-net CF[项目文件](http://code.google.com/p/protobuf-net/source/browse/trunk/protobuf-net-CF20/protobuf-net-CF20.csproj)中的这一行：

```
<ItemGroup>
    <Compile Include="..\protobuf-net\**\*.cs" />
</ItemGroup> 
```

它说“在这个项目中，包含并编译来自（返回一个级别，直到兄弟 protobuf-net 文件夹）和所有子文件夹的所有 .cs 文件”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T02:47:11.323

听起来您已经进行了持续集成，这实际上是其中的第一步——确保所有开发人员尽快了解构建中断。

如果没有，请查看 JetBrains Team City、Cruise Control 或 Microsoft Team Systems Team Build。

根据您的源代码控制服务器，您可能还可以设置签入策略。因此，如果签入特定文件，则会生成警报。

但通常我会通过链接文件共享尽可能多的代码。如果您必须在两者之间使用不同的代码，希望有细微的差异，您可以围绕不同的代码执行#IFDEF。

抱歉，但在这个问题上没有简单的答案。

# vb.net - 在 VB.net 中将特定的 WebControl 类型作为参数传递

> ID：783760
> 
> 赞同：0
> 
> 时间：2009-04-23T22:15:27.100
> 
> 标签：vb.net, parameters, types, web-controls

我正在尝试创建一个函数来搜索 WebControl 的父子关系（基本上与 WebControl.FindControl(id as String) 相反，但要查找特定的 WebControl 类型）。

示例：我在 GridViewRow 的 ItemTemplate 中有一个用户控件。我正在尝试从用户控件中引用 GridViewRow。用户控件可能位于也可能不在 div 或其他类型的控件中，所以我不知道要查看多少父级（即我不能只使用 userControl.Parent.Parent）。我需要一个函数来找到它在父子层次结构中找到的第一个 GridViewRow。

因此需要这个功能。除非有更好的方法来做到这一点？无论如何，我希望我正在创建的函数相当通用，以便可以根据我正在寻找的内容指定不同的 WebControl 类型（即 GridViewRow、Panel 等）。这是我写的代码：

```
Public Function FindParentControlByType(ByRef childControl As WebControl, ByVal parentControlType As WebControl.Type, Optional ByRef levelsUp As Integer = Nothing) As WebControl
    Dim parentControl As WebControl = childControl
    Dim levelCount = 1
    Do While Not parentControl.GetType = parentControlType
        If Not levelsUp = Nothing AndAlso levelCount = levelsUp Then
            parentControl = Nothing
            Exit Do
        End If
        levelCount += 1
        parentControl = parentControl.Parent
    Loop
    parentControl.FindControl(
    Return parentControl
End Function 
```

我知道函数定义中的“ByVal parentControlType as WebControl.Type”不起作用——这就是我要找的。

我相信有更好的方法可以做到这一点，所以请随时指出来让我看起来很简单！

多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T22:28:53.293

您应该能够使用递归轻松地做到这一点。这是一个让您开始或可能解决您的问题的示例。

VB 语法不再那么好，但我相信你可以通过转换器运行它（如 converter.telerik.com）

## C# 代码

```
public T FindParentControl<T>(
    ref WebControl child, 
    int currentLevel, 
    int maxLevels)
    where T : WebControl
{
    if (child.Parent == null || currentLevel > maxLevels)
        return null;

    if (child.Parent is T)
        return child.Parent as T;
    else 
        return FindParentControl<T>(
            child.Parent, 
            currentLevel + 1, 
            maxLevels);
} 
```

## VB.NET 代码（converter.telerik.com 提供）

```
Public Function FindParentControl(Of T As WebControl)(
    ByRef child As WebControl,
    currentLevel As Integer, 
    maxLevels As Integer) As T

    If child.Parent = Nothing OrElse currentLevel > maxLevels Then
        Return Nothing
    End If

    If TypeOf child.Parent Is T Then
        Return TryCast(child.Parent, T)
    Else
        Return FindParentControl(Of T)(child.Parent, currentLevel + 1, maxLevels)
    End If
End Function 
```

# html - CSS DIV 默认宽度在 IE 中看起来不错。不是火狐

> ID：783763
> 
> 赞同：0
> 
> 时间：2009-04-23T22:16:30.310
> 
> 标签：html, css, internet-explorer, firefox, layout

我已经设置了一个我在这里遇到的例子：http: [//studiozion.com/cssproblem/fix_it.htm](http://studiozion.com/cssproblem/fix_it.htm)。

相关代码块...

```
<style type="text/css">
body
{
    background: transparent url(Grade300_Color1.png) repeat-x 
    }
.RowMaker
{
    overflow: auto;
}
.ColumnMaker
{
    float: left;
}
.ColumnMaker2
{
    float: right;
}
.PadTop
{
    padding-top: 10px;
}
.PadBot
{
    padding-bottom: 10px;
}
.PadLeft
{
    padding-left: 15px;
}
.PadRight
{
    padding-right: 15px;
}
.ControlCurve1
{
    height: 6px;
    background: transparent url(ControlCurve1.png) no-repeat right -6px
    }
.ControlCurveRight1
{
    height: 6px;
    width: 6px;
    background: transparent url(ControlCurve1.png) no-repeat top left
    }
.ControlCurveLeft1
{
    height: 6px;
    width: 6px;
    background: transparent url(ControlCurve1.png) no-repeat bottom left
    }
</style>
```

```
<div class="RowMaker">
    <div class="ColumnMaker ControlCurveLeft1"><span></span></div>

    <div class="ColumnMaker ControlCurve1">
        <div class="RowMaker">
            <div class="ColumnMaker2 ControlCurveRight1"><span></span></div>       
        </div>
    </div>
</div>
```

所以问题是具有“ColumnMaker ControlCurve1”类的 div 将扩展以填充 IE 中具有“RowMaker”类的父容器的宽度，为 div 创建一个漂亮的小斜角帽。但在 Firefox 中，“ColumnMaker ControlCurve1”div 会截断，导致斜角帽的右侧左对齐。

那么谁是对的呢？更重要的是，我该如何解决这个问题，同时保留扩展到其父容器的视觉元素的灵活性？我真的不想在“ColumnMaker Control1”上设置硬宽度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T04:22:59.040

你需要清除你的花车。在您的样式表中，为包含浮动的**CONTAINER**包含以下代码：

```
#yourContainer:after {
content: ".";
display: block;
height: 0;
clear: both;
visibility: hidden;
} 
```

`min-height: 10px;`您还可以（也应该）通过输入`#yourContainer`样式定义来清除 IE 的浮动。

也有可能因为您没有内容并且没有设置宽度，所以 div 不会拉伸到任何东西。

只是一些想法，没有经过真正的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T22:21:25.993

firefox 永远是正确的 (j/k)

这个问题之前已经解决过很多次了。我可以建议快速搜索一下吗？

[http://redmelon.net/tstme/4corners/](http://redmelon.net/tstme/4corners/)

[http://kalsey.com/blog/2003/07/rounded_corners_in_css/](http://kalsey.com/blog/2003/07/rounded_corners_in_css/)

还有一个jquery解决方案

[http://www.malsup.com/jquery/corner/](http://www.malsup.com/jquery/corner/)

# sdk - 微软/福特同步 SDK

> ID：783767
> 
> 赞同：5
> 
> 时间：2009-04-23T22:17:25.427
> 
> 标签：sdk, synchronization, smartdevicelink

刚买了一辆装有 Microsoft 同步系统的汽车。在线快速搜索并很好奇是否有人知道可能存在的任何 SDK、示例开源附加应用程序等。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-11-10T11:18:58.120

***更新***：

看起来[福特终于发布了他们的 SDK](http://bits.blogs.nytimes.com/2013/01/08/c-e-s-2013-have-you-programmed-a-ford-lately/)：

[https://developer.ford.com/](https://developer.ford.com/)

* * *

Ford 有一个网站[SYNC Mobile Application Developer Network](https://secure.syncmyride.com/Own/Modules/Developer/Subscribe.aspx)，但 SYNC SDK 看起来还没有可用（他们的网站可能会在今年晚些时候提到）。看来他们在发布 API 之前仍在开发它。他们现在提供的只是一种注册方式，以便在新信息可用时收到通知。

从他们的[关于页面](http://www.syncmyride.com/Own/Modules/Developer/about.aspx)：

> 福特正在努力开发一种 API，以允许开发人员将他们的智能手机应用程序与 SYNC 集成。开发者计划网站将向开发者介绍福特 SYNC 平台以及如何通过 API 与之交互。将提供一整套文档、示例应用程序、参考库，甚至还有一个开发者论坛，以便您可以与社区联系以获得快速帮助。
> 
> 使用可用的 SYNC API，移动应用程序开发人员将能够执行以下一些操作：
> 
> 1.  使用车载语音识别系统为您的应用程序创建语音 UI。
> 2.  将信息写入收音机头显或车载触摸屏
> 3.  使用文字转语音引擎朗读文字。
> 4.  使用车载菜单系统为您的移动应用程序提供命令或选项
> 5.  从收音机和方向盘控制中获取按钮。
> 6.  接收车辆数据（速度、GPS 位置、燃油经济性等）
> 
> ***官方 API 和完整网站的发布定于今年晚些时候推出。***

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-19T01:53:22.530

看起来 SDK 即将推出。这个故事刚刚发布在 Engadget 上：

[http://www.engadget.com/2009/12/18/ford-to-give-sync-some-app-store-flavor-opening-api-to-devs-in/](http://www.engadget.com/2009/12/18/ford-to-give-sync-some-app-store-flavor-opening-api-to-devs-in/)

现在想象一下您可以通过访问您的汽车功能来做什么！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T22:26:49.273

我认为没有。它是一个封闭的生态系统。

[http://www.autoblog.com/2009/01/09/ces-2009-sync-could-one-day-add-app-development-like-iphone/](http://www.autoblog.com/2009/01/09/ces-2009-sync-could-one-day-add-app-development-like-iphone/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-23T17:52:41.623

据我了解，它基于使用 windows 汽车 4.1 的 CE 6.0 平台，但我可能是错的。我们真的需要一个论坛来实现这一点。福特快点！发布 SDK！

鉴于 Windows 汽车的方式，只有两种方法可以将 ROM 置于 Sync 上。使用 JTAG 放置您自己的自定义引导加载程序（忘记它），或者通过 USB。您需要知道如何对文件进行签名，以便同步认为它是 OEM ROM。所以在这一点上，即使您能够通过使用 Microsoft eMbedded Visual C++ 来设计您自己的自定义 rom，您仍然无法将其安装到那里。

顺便说一句，他们所说的发布的SDK只会为applink开发应用程序。（不修改操作系统）。但是，要上传应用程序，我们或许可以了解如何签署 .bin 文件以进行同步以通过 USB 接受 ROM。

再说一次，这只是根据我的理解......我不是伟大的开发人员或任何东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T18:08:55.800

福特在 ces 推出 sdk，查看：[http ://techcrunch.com/2013/01/08/ford-launches-its-openxc-sdk-and-hardware-specs-to-let-developers-access-its-汽车传感器和指标/](http://techcrunch.com/2013/01/08/ford-launches-its-openxc-sdk-and-hardware-specs-to-let-developers-access-its-cars-sensors-and-metrics/)

# clr - CLR 支持哪些 JIT 编译器

> ID：783771
> 
> 赞同：0
> 
> 时间：2009-04-23T22:18:24.190
> 
> 标签：clr, jit

我偶然发现了这句话：

> “.NET 公共语言运行时 (CLR) 为每个支持 NET 的计算机架构提供至少一个 JIT 编译器，因此同一组 CIL 可以进行 JIT 编译并在不同的架构上运行。”

我环顾四周，但找不到 CLR 支持的 JIT 编译器的明确列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T22:23:50.963

对于 CLR 运行的每个处理器架构，主要有一个 JIT 编译器。尤其是

*   x86
*   amd64
*   ia64

对以下内容不太确定。

*   PowerPC (XBox360)
*   ARM（移动设备）

# java - 如何配置休眠以使用特定于上下文的连接信息？

> ID：783773
> 
> 赞同：1
> 
> 时间：2009-04-23T22:18:30.697
> 
> 标签：java, hibernate, connection-pooling, c3p0

我正在使用 Hibernate 编写 Java SE（注意，**不是**Java EE）应用程序，并且我需要为每个执行线程提供到 Hibernate 的不同连接。这些连接必须汇集在一起​​，并且每个连接至少具有不同的身份验证，并且可能具有不同的 JDBC URL。连接将被重新使用（可以从池化需求中推断出来）。

我必须覆盖 Hibernate/C3P0/et al 的哪些部分？这可以通过这些工具来完成，还是我需要编写自己的池数据源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T01:13:39.667

您在这里有两个问题：

1.  连接不是线程安全的，因此每个线程必须有自己的连接。由于您使用的是 Hibernate，因此您的应用程序看到的实际上是从 SessionFactory 获得的 Session。要利用它，您调用 SessionFactory#getCurrentSession() 方法，并在 hibernate.cfg.xml 中配置当前会话上下文：

    ```
    <property name="current\_session\_context\_class">线程</property>
    ```

    如果您在 hibernate.cfg.xml 中正确配置了线程池（使用 c3po 或您喜欢的任何池机制），那么每个线程都会从该池中获得一个连接。
2.  要维护应用程序可能需要使用的多个数据源，您需要为要访问的每个 JDBC url 配置单独的 SessionFactory。在您的应用程序中，您需要有一些使用 SessionFactory 进行选择的方法，您需要选择（例如“客户端 ID”），使用它您可以管理 Map 或某种此类数据结构中的每个 SessionFactory 实例（在 Java EE 应用程序，您将从 JNDI 获得参考）。

总结（和概括），基本上 SessionFactory 本质上是围绕数据源（和伴随的连接池）的巨大包装器。它是只读的（因此是线程安全的）、重量级和静态的，一次构建，并且知道它需要的关于给定 DataSource 的一切。

另一方面，会话本质上是围绕连接的轻量级包装器。它不是线程安全的，通常是短暂的，并且打算使用然后丢弃。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T19:35:13.420

我认为最好的做法是`SessionFactory`为每个数据源创建一个，并可能使用池连接——这就是 eqbridges 在他的回答中所建议的。

现在，Hibernate 确实有一个`ConnectionProvider`钩子，所以我想您可以编写一个实现，将`Connection`s 返回到不同的数据源，具体取决于当前的执行线程和一些附加参数。理论上，您可以拥有一个`SessionFactory`实例，该实例将使用与不同数据库的不同连接，由您的自定义`ConnectionProvider`实现提供。但是，一个人`SessionFactory`拥有相当多的数据，然后当为一个工作单元打开 a 时，这些数据会被 Hibernate 在内部使用`Session`。另外，还有一个与之相关的二级缓存。

不幸的是，`Session`任何人都在猜测，面对这样的供应商，工厂和您从中打开的工厂将如何表现。这对我来说就像是一种黑客行为，我怀疑它曾经被认为是一个可行的`SessionFactory`. 它可能会导致各种可能非常微妙的错误或数据损坏。

另一方面，一定要准确衡量创建多个的成本`SessionFactories`——它可能没有你想象的那么高。请务必将其与仅打开所需 JDBC 连接的成本进行比较。我不知道你可能会得到什么样的结果，但我认为你应该先确定性能，然后再求助于更骇人听闻的解决方案。

# php - Python 等价于 PHP 的 compact() 和 extract()

> ID：783781
> 
> 赞同：11
> 
> 时间：2009-04-23T22:21:29.473
> 
> 标签：php, python, dictionary

[compact](http://www.php.net/compact) () 和[extract](http://www.php.net/extract) () 是 PHP 中的函数，我觉得非常方便。compact() 获取符号表中的名称列表，并创建一个仅包含其值的哈希表。提取物则相反。例如，

```
$foo = 'what';
$bar = 'ever';
$a = compact('foo', 'bar');
$a['foo']
# what
$a['baz'] = 'another'
extract(a)
$baz
# another 
```

有没有办法在 Python 中做同样的事情？我环顾四周，最接近的是[这个线程](http://markmail.org/message/r52hym6zfy7hd2ch)，它似乎对此皱眉。

我知道 locals()、globals() 和 vars()，但是我怎样才能轻松地选择它们值的一个子集呢？

Python 是否有更好的东西来消除这种需求？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T22:47:46.600

它不是很 Pythonic，但如果你真的必须，你可以`compact()`这样实现：

```
import inspect

def compact(*names):
    caller = inspect.stack()[1][0] # caller of compact()
    vars = {}
    for n in names:
        if n in caller.f_locals:
            vars[n] = caller.f_locals[n]
        elif n in caller.f_globals:
            vars[n] = caller.f_globals[n]
    return vars 
```

以前可以`extract()`像这样实现，但在现代 Python 解释器中，这似乎不再起作用（并不是说它曾经“应该”起作用，真的，但是 2009 年的实现有一些怪癖让你得到远离它）：

```
def extract(vars):
    caller = inspect.stack()[1][0] # caller of extract()
    for n, v in vars.items():
        caller.f_locals[n] = v   # NEVER DO THIS - not guaranteed to work 
```

如果您真的觉得需要使用这些功能，那么您可能做错了事。它似乎至少在三个方面与[Python 的哲学](https://www.python.org/dev/peps/pep-0020/)背道而驰：“显式胜于隐式”、“简单胜于复杂”、“如果实现难以解释，那就是个坏主意”，也许更多（实际上，如果你有足够的 Python 经验，你就会知道这样的事情还没有完成）。我可以看到它对于调试器或事后分析很有用，或者对于某种*非常通用*的框架，它经常需要创建具有动态选择的名称和值的变量，但这是一个延伸。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-23T22:40:07.977

恐怕Python中没有等价物。在某种程度上，您可以使用（和传递）模拟它们的效果`locals`：

```
>>> def compact(locals, *keys):
...     return dict((k, locals[k]) for k in keys)
...
>>> a = 10
>>> b = 2
>>> compact(locals(), 'a', 'b')
{'a': 10, 'b': 2}

>>> def extract(locals, d):
...     for k, v in d.items():
...         locals[k] = v
...
>>> extract(locals(), {'a': 'foo', 'b': 'bar'}
>>> a
'foo'
>>> b
'bar' 
```

不过，我不认为这些功能“非常方便”。动态全局/局部变量是邪恶的并且容易出错——当 PHP 人不鼓励 register_globals 时，他们就明白了这一点。根据我的经验，很少有经验丰富的 PHP 程序员或主要框架使用`compact()`或`extract()`.

在 Python 中，[显式优于隐式](http://www.python.org/dev/peps/pep-0020/)：

```
a = 1
b = 2
# compact
c = dict(a=a, b=b)

# extract
a, b = d['a'], d['b'] 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-24T05:57:58.750

是否值得指出`extract()`（在较小程度上，`compact()`）是 PHP 最“邪恶”的特性之一（与`register_globals`and一起`eval`），应该避免吗？

[`extract`](http://php.net/manual/en/function.extract.php)使确定变量的定义位置变得更加困难。当很难将变量追溯到定义的位置时，就更难检查常见的安全问题，例如使用未初始化的变量或源自用户输入的未过滤变量。

[`compact`](http://php.net/manual/en/function.compact.php)没有那么糟糕，但是如果使用不当，仍然会比从变量中查看数组成员的位置更加困难。

`extract()`许多其他语言中的等价物是`with`关键字。Python 现在有一个`with`关键字，虽然它的工作方式有点不同，使它不太像`extract()`. 但是，在其他语言（例如 Javascript）中，该`with`关键字[的声誉也很差](http://yuiblog.com/blog/2006/04/11/with-statement-considered-harmful/)。

我认为最好的建议是换一种思路——不要试图模仿 PHP 的一个不好的特性，而是想其他方法来用简洁易读的代码来做你想做的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T18:13:24.327

PHP 在 Python 中的紧凑函数（适用于 2.6；不保证适用于早期版本的 Python）：

```
import inspect
def compact(*args):
    return dict([(i, inspect.currentframe().f_back.f_locals.get(i, None)) 
                  for i in args]) 
```

我已经写了更多关于此的文章：[Python 可能和 PHP 一样丑陋](http://www.elfsternberg.com/2009/05/14/python-can-be-just-as-ugly-as-php/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T22:32:56.573

我猜相当于`extract($x)`is `globals().update(x)`，因为`compact()`它是`vars()`

```
>>> foo, bar, baz = 1, 2, 3
# extract
>>> globals().update({"foo": 4, "qux": 5})
>>> foo
4
>>> qux
5
# compact
>>> d = dict((k, v) for k, v in vars().iteritems() if k in ["foo", "bar"])
>>> d
{'bar': 2, 'foo': 1} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-23T20:54:37.607

您*可以*使用该函数执行此操作（尽管我只建议谨慎...），该`locals()`函数返回一个可更新的`dict`. 例子：

```
$ python
Python 2.7.12 (default, Jul  1 2016, 15:12:24) 
>>> locals().update({'derek':'anderson'})
>>> derek
'anderson'
>>> 
```

所以`locals()`将是“紧凑所有”并且`locals().update()`将是`extract`.

祝你好运！

# iphone - iPhone 应用程序崩溃并且没有留下 .crash 日志文件

> ID：783782
> 
> 赞同：4
> 
> 时间：2009-04-23T22:21:48.830
> 
> 标签：iphone, objective-c, cocoa-touch, debugging

我正在努力捕捉我的代码中发生的一个非常隐蔽的错误。问题是，该错误是完全随机的，可能会在应用程序运行时 9 分钟或 30 分钟后发生。我已经继续并将出色的 PLCrashReporter 添加到我的项目 ( [http://code.google.com/p/plcrashreporter](http://code.google.com/p/plcrashreporter) ) 中，这对于微不足道的错误非常有效。此外，当我有疑问时，我将导航到 ~/Library/Logs/CrashReporter/MobileDevice/ 中的崩溃日志，并在崩溃日志上运行 symbolicatecrash。这个 + GDB 最终会捕获任何错误，除了我现在面临的错误。

显然，这个错误的性质甚至阻止了 Apple 的崩溃日志被正确写入存储。当我将我的 iPhone 或 iPod Touch 与 iTunes 同步并在我的应用程序上运行 symbolicatecrash 时，这会显示：

```
sf$ symbolicatecrash foo.crash 
No crash report version in foo.crash at /usr/local/bin/symbolicatecrash line 741. 
```

可能是我的应用程序根本没有留下崩溃报告，并且由于内存问题而退出。我确实在我的 App Delegate 中看到了 applicationWillTerminate: 在退出之前执行我的 NSLog 语句。但是，在通过 ObjectAlloc 运行应用程序后，我的应用程序从未达到 > 2.08MB 的使用量。尽管如果我正确阅读了结果，我确实在整个测试运行期间分配了超过 28MB 的内存。

再次感谢一切。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T23:45:38.177

几个建议：

1.  确保您实际上没有调用 exit()、从 main() 返回或以其他方式干净地退出代码中的任何位置。如果您的应用程序只是退出，而不是崩溃，那显然不会留下日志。

2.  我认为在内存不足的情况下快速运行系统有时会导致您的应用程序崩溃而不会留下崩溃日志。在 Instruments 下运行它，看看随着时间的推移内存使用情况如何。

3.  如果您有一组“经常”重现问题的步骤，请尝试在调试器下运行它并反复检查它，直到它崩溃。这可能是一个半小时的好时光。

消除了明显/简单的，它是更模糊的。很有可能您在途中某处损坏了堆或堆栈，通过缓冲区溢出、重新使用无效指针等等等。这里有一些事情可以尝试：

4.  尝试在环境变量中使用 NSZombieEnabled=YES 运行。这将帮助您找到释放对象的重用。但是，它确实对内存使用产生了巨大影响，因此它可能并不适用于所有人。这是一篇关于 NSZombie（除其他外）[的 Apple 文章。](http://developer.apple.com/iphone/library/documentation/Xcode/Conceptual/iphone_development/130-Debugging_Applications/debugging_applications.html#//apple_ref/doc/uid/TP40007959-CH7-SW3)

5.  在 iPhone 模拟器中运行时，使用硬件菜单中的“模拟内存警告”项来强制执行低内存条件 - 这可以清除该代码中的错误，否则这些错误会在不可预测的时间运行。

6.  最后但并非最不重要的一点是，在代码中搜索使用低级 C 内存操作函数（malloc、calloc、realloc、memcpy、strcpy、strncpy 等）的所有地方，并确保缓冲区大小合适。

# log4net - 我应该在我的域模型对象中直接使用 log4net 吗？

> ID：783786
> 
> 赞同：2
> 
> 时间：2009-04-23T22:23:35.643
> 
> 标签：log4net, dns, modeling

我想知道直接在我的域对象上使用 log4net 是否是不好的做法......我将在 ASP.NET MVC 应用程序端使用 ELMAH 来处理我的异常，但出于某些信息目的，我想记录一些数据关于域模型本身。

给定以下域对象：

```
 public class Buyer
{
    private int _ID;
    public int ID
    {
        get { return _ID; }
        set
        {
            _ID = value;
        }
    }

    private IList<SupportTicket> _SupportTickets=new List<SupportTicket>();
    public IList<SupportTicket> SupportTickets
    {
        get
        {
            return _SupportTickets.ToList<SupportTicket>().AsReadOnly();
        }
    }

    public void AddSupportTicket(SupportTicket ticket)
    {
        if (!SupportTickets.Contains(ticket))
        {
            _SupportTickets.Add(ticket);
        }
    }
} 
```

在 AddSupportTicketMethod 中添加日志记录行为是一个坏主意......所以它看起来像这样：

```
 public class Buyer
{
    protected static readonly ILog log = LogManager.GetLogger(typeof(SupportTicket));

    public Buyer()
    {
       log4net.Config.XmlConfigurator.Configure();
    }

    private int _ID;
    public int ID
    {
        get { return _ID; }
        set
        {
            _ID = value;
        }
    }

    private IList<SupportTicket> _SupportTickets=new List<SupportTicket>();
    public IList<SupportTicket> SupportTickets
    {
        get
        {
            return _SupportTickets.ToList<SupportTicket>().AsReadOnly();
        }
    }

    public void AddSupportTicket(SupportTicket ticket)
    {
        if (!SupportTickets.Contains(ticket))
        {
            _SupportTickets.Add(ticket);
        } else {
           log.Warn("Duplicate Ticket Not Added.");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T23:04:03.957

我在域对象中直接使用了 log4net 和 log4J。这有好的副作用和坏的副作用。

*   **+**：在域对象中登录是简单直接的代码，并且您知道您可以利用 log4net 功能。
*   **--** : 表示使用域对象的程序需要注意log4net的配置，可能有问题，也可能没有问题
*   **--**：您不能将域对象链接到与调用程序使用的不同的 log4net 版本。我已经看到一个与 log4net 1.2.0.10 相关联的项目和另一个与早期版本相关联的项目发生了很多冲突。

*不登录*您的域对象是个坏主意。另一种方法是正如其他人所建议的那样，依赖注入或外部框架（例如 log4J 的 commons-logging）允许插入不同的日志框架或创建一个接口来执行日志记录和针对该接口进行日志记录。（使用您的域对象的代码需要提供该接口的适当实例以用于日志记录。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T22:46:56.417

这是一个经典的问题！

这样做的好方法是引入 ILogger 类型的类成员并将日志记录抽象到此接口中。在您的班级中，无论您在哪里调用以记录某些内容，都可以通过此接口进行。然后在运行时使用可用的 IoC 容器之一或依赖注入farmeworks 中的一种实现注入此依赖项。默认情况下，您可以使用此接口的 log4net 实现。

这是可用依赖注入框架的长列表： [http ://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx](http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T18:46:29.867

如果你要从你的域对象记录并且你使用一个你可能想要换出的 IOC 容器，我建议你使用服务定位器模式（你可以查看 Sharp# 架构以获得一个很好的 SafeServiceLocator 实现用更多信息错误消息包装 msoft 的 ServiceLocator）。

我还想建议您考虑是否要记录您在示例中显示的错误类型。在这种情况下，我倾向于让域对象抛出异常，并让调用者决定这是否是应用程序所期望的（因此不应该被记录），或者这是否代表调用者想要的情况以某种方式处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T22:48:22.293

我认为日志记录是一个横切关注点，因此最好以面向方面的方式完成。如果您使用的是 Spring.NET 之类的框架，那么您可以使用它。

# sifr - 如何用 sifr 显示自定义引号？

> ID：783788
> 
> 赞同：0
> 
> 时间：2009-04-23T22:24:08.560
> 
> 标签：sifr, quotes, quotations

我周围有一些文字和引号，但我希望它们中的每一个都是不同的字体，可以被 sifr 替换。问题是引号需要完全围绕文本，但文本一旦变成标签就会变成一个块，并且文本的形状不一定像矩形。我想过让引号成为替换文本的背景图像，但只有 safari 3 支持多个背景图像。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T21:04:16.560

我不认为 Flash 提供了对文本元素的足够控制来获得您想要的精确度。

# .net - 我正在寻找像 LibCheck 这样的工具来评估同一 SDK 的不同版本

> ID：783790
> 
> 赞同：5
> 
> 时间：2009-04-23T22:24:36.937
> 
> 标签：.net, api, backwards-compatibility

我正在开发一个 SDK。当我发布新版本时，我想生成一份关于 API 差异的报告。这不是代码中的差异。大多数代码预计不会直接使用。公共类/方法是我感兴趣的。此外，我们采用了这样的约定，即命名空间中包含实现的任何内容都不应被 SDK 的客户端使用。因此，我正在寻找不在包含实现的命名空间中的公共接口、类和方法的差异。我想知道在两个版本之间删除、添加和修改了什么。

我从微软找到了一个名为 LibCheck 的工具，它在正确的范围内。我对 LibCheck 有几个问题。LibCheck 无法识别已修改的方法。它报告该方法已被删除和添加。它有时会报告一个方法已被删除和添加，但名称和参数都相同。我不知道在这些情况下它试图告诉我什么。最后，我不关心报告的布局。我想按名称空间以及程序集和类进行细分。

我知道这些报告是 XSLT 转换的结果，我可以让它们看起来像我想要的任何东西。还有其他问题，再加上微软对该工具普遍缺乏支持，让我不得不寻找替代方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-25T07:28:48.847

[NDepend](http://www.ndepend.com/)之类的工具非常适合这项工作，并且内置了用于在“API”级别进行差异报告的功能，而不仅仅是文本，例如：

[比较构建和代码差异](http://www.ndepend.com/Features.aspx#BuildComparison)

NDepend有自己的代码查询语言CQL，可以用来编写高度自定义的静态分析报告：

[代码查询语言](http://www.ndepend.com/Features.aspx#CQL)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-22T16:58:58.980

还有[http://apichange.codeplex.com](http://apichange.codeplex.com)有一个不同的选项。像这样称呼它

```
ApiChange -diff -old $net2dir\System.dll -new $net4dir\System.dll 
```

你应该得到一份报告。

# python - 在python中寻找（），然后读取（），然后写入（）

> ID：783792
> 
> 赞同：7
> 
> 时间：2009-04-23T22:25:29.337
> 
> 标签：python, file-io

运行以下 python 代码时：

```
>>> f = open(r"myfile.txt", "a+")        
>>> f.seek(-1,2)                                        
>>> f.read()                                            
'a'                                                     
>>> f.write('\n') 
```

我得到以下（有用的）异常：

```
Traceback (most recent call last):      
  File "<stdin>", line 1, in <module>   
IOError: [Errno 0] Error 
```

用“r+”打开时也会发生同样的事情。

这应该失败吗？为什么？

编辑：

1.  显然，这只是一个例子，而不是我真正想要执行的。我的实际目标是在添加新行之前验证文件是否以“\n”结尾，或者添加一个。
2.  我在 Windows XP 下工作，它们的问题在 Python 2.5 和 Python 2.6 中都存在。
3.  我通过再次调用 seek() 设法绕过了这个问题：

    > > > f = open(r"myfile.txt", "a+")
    > > > f.seek(-1,2)
    > > > f.read()
    > > > 'a'
    > > > f.seek(-10,2)
    > > > f.write('\n')

第二次搜索调用的实际参数似乎无关紧要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T22:41:18.177

这似乎是一个特定于 Windows 的问题 -有关类似问题，请参阅[http://bugs.python.org/issue1521491 。](http://bugs.python.org/issue1521491)

更好的是，在[http://mail.python.org/pipermail/python-bugs-list/2005-August/029886.html](http://mail.python.org/pipermail/python-bugs-list/2005-August/029886.html)给出并解释了一个解决方法，插入：

```
f.seek(f.tell()) 
```

在 read() 和 write() 调用之间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T22:30:09.590

a+ 模式用于追加，如果你想读写，你正在寻找 r+。

试试这个：

```
>>> f = open("myfile.txt", "r+")
>>> f.write('\n') 
```

**编辑：**

您最初应该指定您的平台...在 Windows 中查找存在已知问题。尝试查找时，UNIX 和 Win32 有不同的行尾，分别是 LF 和 CRLF。读取到文件末尾也存在问题。我认为您正在寻找文件末尾的 seek(2) 偏移量，然后从那里继续。

您可能对这些文章感兴趣（更具体地说是第二篇）：

[http://coding.derkeiler.com/Archive/Python/comp.lang.python/2004-08/2512.html](http://coding.derkeiler.com/Archive/Python/comp.lang.python/2004-08/2512.html)

[http://mail.python.org/pipermail/python-list/2002-June/150556.html](http://mail.python.org/pipermail/python-list/2002-June/150556.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T22:43:23.443

为我工作：

```
$ echo hello > myfile.txt
$ python
Python 2.5.2 (r252:60911, Oct  5 2008, 19:24:49) 
[GCC 4.3.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> f = open('myfile.txt', 'r+')
>>> f.seek(-1, 2)
>>> f.tell()
5L
>>> f.read()
'\n'
>>> f.write('\n')
>>> f.close() 
```

你在窗户上吗？如果是这样，请尝试`'rb+'`而不是`'r+'`在模式中。

# database - 在开发人员之间同步数据库模式

> ID：783798
> 
> 赞同：5
> 
> 时间：2009-04-23T22:27:03.420
> 
> 标签：database, cakephp

我正在和其他几个人一起做一个项目。我们都有项目的本地副本，它也通过 svn repo 不断更新。

因为我们处于开发的早期阶段，所以我们经常更改数据库的架构。当我们同步我们的代码时，这会导致很多问题，因为我们没有很好的方法来同步我们的数据库模式。

同步频繁更改的数据库模式有哪些直观且简单的方法？

我们正在使用 CakePHP（不确定这是否会帮助我找到好的解决方案）。

***编辑***

找到了一些在 CakePHP 中完成此类工作的工具：http: [//book.cakephp.org/view/734/Schema-management-and-migrations](http://book.cakephp.org/view/734/Schema-management-and-migrations)

这是一个额外的网站： [http ://bakery.cakephp.org/articles/view/cake-db-migrations-v2-1](http://bakery.cakephp.org/articles/view/cake-db-migrations-v2-1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T22:40:54.433

数据库迁移是一种让您的工作数据库保持同步的简单方法。本质上，迁移是将数据库更新到最新模式并使用正确数据填充新表的脚本，因此它们保持在有效状态。

迁移提供的功能很少：

*   自动创建/更新表的工具。这些工具会跟踪架构版本以及需要运行哪些脚本。
*   一些迁移工具提供了运行代码（c#、ruby 等）而不是 sql 脚本的能力。迁移工具提供的代码库通常能够更好地抽象出依赖于数据库的部分，并使您的数据库脚本更加独立于数据库。

有适用于 Ruby（迁移是 Rails 的重要组成部分）、C# 和 Java 的工具。当然，其他语言也是如此。

[这里](https://stackoverflow.com/questions/426378/what-is-your-favorite-solution-for-managing-database-migrations-in-django)有很多关于迁移的[问题](https://stackoverflow.com/questions/313/-net-migrations-engine) ，我建议搜索适合您工具链的迁移工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T12:46:09.290

[Joel Moss 的CakePHP Database Migrations](http://github.com/joelmoss/cakephp-db-migrations/tree/master)是目前最好的解决方案。

来自github的项目描述：

> CakePHP 1.2 的数据库迁移是一个受 CakePHP 控制台支持的 shell 脚本，它可以让您管理您的数据库模式，而无需触及一点 SQL。它基于 Ruby on Rails 的 Migrations 实现，并使用 Pear 的 MDB2 包，因此支持所有支持的数据库。
> 
> 您可以将迁移视为数据库的版本控制系统。它的强大功能非常适合作为团队的一部分进行开发，因为每个成员都可以保留他们自己的应用程序数据库的独立副本，并使用迁移来更改其架构。然后所有其他成员要做的就是运行一个简单的两字 shell 命令，并且他们的数据库副本与其他人的数据库副本是最新的。
> 
> Migrations shell 将为您要进行的每个数据库更改生成一个迁移文件。该文件可以包含任意数量的数据库更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T21:35:25.627

Github 上与 Cake 2.x 兼容的插件：

[https://github.com/CakeDC/migrations](https://github.com/CakeDC/migrations)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-29T08:19:25.710

这是使用 Git 的一个很好的例子，但同样适用于 SVN。[http://thewebandthings.synodicsolutions.com/2009/06/13/cakephp-versioning-database-changes-with-git/](http://thewebandthings.synodicsolutions.com/2009/06/13/cakephp-versioning-database-changes-with-git/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-20T09:31:25.980

我已经开始了一个小项目，我们用它来在开发人员之间同步数据库并部署到生产环境。它仍处于早期阶段，但它被证明可以工作，只是还没有很多文档。

[http://code.google.com/p/php-mysql-version-control/](http://code.google.com/p/php-mysql-version-control/)

# windows - 使用 at 访问共享网络

> ID：783804
> 
> 赞同：2
> 
> 时间：2009-04-23T22:29:03.447
> 
> 标签：windows

我有一个程序，我想每 X 分钟运行一次

问题是程序正在访问共享网络并使用 AT 命令我无法使用它（由于 AT 正在使用 SYSTEM ACCOUNT 运行程序）

任何想法如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T22:39:31.003

/interactive 开关能买到你想要的东西吗？

“使用此参数允许任务与在任务运行时登录的用户的桌面进行交互。”

有关详细信息，请参阅：http: [//support.microsoft.com/kb/313565](http://support.microsoft.com/kb/313565)

使用 at 命令，您可以选择以系统用户或当前登录的用户身份运行。

您可能想尝试让您的程序作为计划任务运行。这将使您可以选择在您拥有凭据（用户名/密码）的任何帐户下运行。您可以通过控制面板手动设置它，也可以[使用此库从 C# 以编程方式设置](http://www.codeproject.com/KB/cs/tsnewlib.aspx)

# database - 在进行常规构建时，您如何处理数据库版本控制？

> ID：783806
> 
> 赞同：3
> 
> 时间：2009-04-23T22:30:15.770
> 
> 标签：database, database-versioning, dailybuilds

我有一个使用非常大的数据库（超过 5 GB）的 Web 应用程序项目。数据库中的数据按项目分区。每个项目大约需要 1 GB，它是应用程序工作的最小集合（我们进行了一些数学计算，这些计算分布在这个数据集上，并且不能删除数据集的一部分）。

作为日常构建的一部分，我们还将我们的应用程序部署到测试环境中。为此，构建器运行自定义数据库更新实用程序，将当前数据库更新到适当的版本。但是我们还要求保留所有每日构建，以便 QA 团队可以“及时返回”并比较不同构建的计算结果。尽管我们尝试拥有向后兼容的数据模式，但有时它非常具有挑战性和耗时。所以，因此问题：

如果您需要保持以前的每日构建并运行，并且需要在进行日常构建的同时管理大型数据库，您会使用哪种数据库版本控制方法？

我们在前端使用 SQL Server 2005 和 ColdFusion 以及一些 Java，如果它有什么不同的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T22:56:09.513

我建议阅读 Leon Bambrick 的列表，标题为[11 Tools for Database Versioning](http://secretgeek.net/dbcontrol.asp)

我会将 Visual Studio for Database Professionals 添加到[可以在此处找到的列表中](http://msdn2.microsoft.com/en-us/teamsystem/aa718807.aspx)

Jeff Atwood 也有一篇关于该主题的不错的[博客文章](https://blog.codinghorror.com/get-your-database-under-version-control/)，其中包含一些背景阅读的链接。

# wcf - WCF、安全和证书

> ID：783807
> 
> 赞同：6
> 
> 时间：2009-04-23T22:30:23.537
> 
> 标签：wcf, authentication, wcf-security, certificate

我有一个客户端/服务器 WCF 应用程序，它需要对数据库进行某种用户身份验证。该应用程序（客户端和服务器一起）正在开发中，以出售给数十个客户，以在他们的 Intranet 上使用。我们不太担心加密通过网络传输的大部分数据，当然在身份验证期间除外。

考虑到 WCF 安全性，我不断回到我们应该使用 x509 证书的想法。但是，我们的客户肯定不想知道必须申请、购买和安装这些证书的任何细节。

我首先想知道在这种情况下实现用户名/密码身份验证的首选方法是什么。如果需要使用证书，客户必须向受信任的 CA 申请自己的证书，还是我们作为软件提供商可以生成证书供客户使用？

真的，我正在寻找一种最佳实践，对我们的客户的摩擦最小。

谢谢！

**编辑：** 我正在使用 NetTcpBinding，并且我的服务器作为 Windows 服务运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T22:37:58.823

所以用户名/密码不需要客户端证书，我相信你知道，它只需要托管 WCF 服务的服务器上的 HTTPS 证书 - 一旦你有了它，你就可以愉快地使用标准的用户名/密码身份验证位（WCF将不允许没有 HTTPS 的基于消息的身份验证）。

如果您想查看客户端证书根目录，您将获得不可否认性的优势 - 您可以确定发送的机器就是它所说的（除非有人窃取了证书，这比用户名和密码更不可能）组合走来走去）。作为软件提供商，您可以充当自己的证书颁发机构并生成自己的客户端证书（根据您的基础架构，有几种方法可以做到这一点），但是您需要将客户端配置为信任您的根 CA。

如果服务器和客户端在域环境中运行，您可以将[传输安全性与 Windows 身份验证一起](http://msdn.microsoft.com/en-us/library/ms733089.aspx)使用（您正在使用 tcp 绑定，因此互操作性无论如何都在窗外！）额外的好处是身份验证是透明的，而您不需要在任何地方都不需要任何证书。如果您想要验证服务器身份，那么[使用 Windows 身份验证的消息安全性](http://msdn.microsoft.com/en-us/library/ms729709.aspx)就可以解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T20:12:12.717

我有一个与您的场景类似的生产项目。我有一个通过 netTCPBinding 托管端点的 Windows 服务，并且我使用了 x509 证书……尽管在我的情况下，目的是加密传输层和消息层，因为我跨越了不受信任的安全边界。除了要求证书存在之外，我不太关心提供身份验证/授权。

与您的 Intranet 场景（我假设）类似，我在安装时对服务器和客户端机器拥有权限......或者至少可以规定一些安装条款。

我没有购买 x509 证书并让客户承担这笔费用，而是选择推出我们自己的证书。我们将其中一台 Win2003 服务器设置为 CA，颁发我们自己的证书颁发机构证书。然后，我们为服务器生成了一个 x509 证书，并为客户端生成了单独的 x509 证书。

客户端和服务器证书安装在客户端和服务器上（视情况而定）到计算机级别的个人用户存储中。我们还将我们的 CA 证书直接安装到受信任的根证书颁发机构部分，从而使我们的客户端和服务器证书受信任。

因为我不太关心身份验证/授权，所以我不知道推荐什么作为处理将证书绑定到单个用户并且比机器级别更精细的最佳实践（我的解决方案是 Windows 服务到 Windows 服务通信——完全无人看管）。我认为您需要为每个用户提供一个证书，将其安装到证书 MMC 中的个人用户存储中。运行时实现将由您如何配置 WCF 来进行证书查找来指导，因此它应该相当容易。

在整个过程中，我非常依赖从这篇很棒的 CodeProject 文章中学到的知识：[使用证书保护 WCF 服务](http://www.codeproject.com/KB/WCF/wcf_certificates.aspx?display=Print)。它会引导您生成/安装证书。示例 WCF 应用程序是 IIS 托管的，但我能够非常轻松地将配置部分从 web.config 转换为 app.config。

在我的例子中，我将 Win2003 中用于请求证书的 Web 界面暴露给 Web 本身，因此客户端将来可以直接请求证书。我们有审批控制，所以它运作良好。我还没有需要生成新的证书，所以我不能说这会带来多少摩擦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T22:44:09.840

如果您要跨越防火墙边界，那么证书将是您最好的解决方案。我不太了解有关证书申请或您的申请的细节。不幸的是，据我所知，我认为您将不得不帮助他们申请证书，否则他们将不得不自己做，除非他们想在安装自己的证书服务器的过程中进行。如果应用程序将是内部应用程序，那么 Windows 身份验证将起作用并且非常简单，但如果您认为您的客户端将跨越防火墙边界使用您的应用程序，那么您不妨花时间使用证书，因为证书将在任何地方工作。现在有一种称为联合安全性的东西，您可以将身份验证权限委托给另一个实体。

安全性不应该是容易的:)

# .net - .Net 开发层的架构问题

> ID：783809
> 
> 赞同：10
> 
> 时间：2009-04-23T22:32:22.207
> 
> 标签：.net, architecture, n-tier-architecture

大家好，我对分层开发过程很陌生。我目前正在开发一个应用程序，我有一些关于当今技术的最佳实践/架构问题的基本问题。我将使用 WCF 作为服务层。请注意，我正在尝试尽可能多地解耦。我不希望上层的任何事情都必须了解下层的任何事情，这是我不喜欢 LINQ TO SQL 或实体框架的原因之一。

1) 在层之间传递数据的最佳方式是什么？我知道数据集或数据表都很容易，但我认为在层之间传递这种臃肿的数据结构并不是最好的解决方案。如果数据表/数据集很大，调试也会更加困难。一组 POCO 对象可能是最好的解决方案还是有更好的方法？

2）下一个问题有点棘手。许多应用程序会有一堆不同的数据视图。您可能有多个报告、各种数据网格，可能还有一个或两个图表。您如何为此设计数据层？您是否只是为每个表设计一个“获取”类型的函数，然后尝试将它们组合成有用的视图，例如您的业务层中的网格或报表，或者您是否为业务层中需要的每个视图提供了专门的功能。

老实说，我不喜欢这两种解决方案。如果您决定每个视图的专用逻辑，那么您需要为每个视图创建一个 POCO 对象（假设您将返回一个 POCO 对象数组）。如果您稍后决定需要向其中一个视图添加更多列，那么您将破坏现有代码（因为您更改了 POCO 上的界面）。如果您决定返回每个表的视图并尝试将其组合到业务层中，那可能会变得非常混乱。TSQL 有连接是有原因的:)。此外，您可能会返回比您需要的更多的数据，具体取决于您的设计，这将是低效的。

我还有一些问题，但我会留到以后。我不希望这篇文章变得太大:)

笼子

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T22:50:37.733

好问题。重要的东西，这个。通常，处理分层解决方案的最佳方法之一是查看接口。接口是提供“阻塞点”的一种方式，它可以服务于几个有用的目的。

在分层解决方案中，接口用于强制执行层的行为；通过定义您期望的一组行为，您可以有效地解耦层的实现。也就是说，只要我的层正确地实现了接口，实现是我根本不需要关心的。

我提出这个（并且它是相关的）是因为在定义接口时，您还需要定义在层之间传递的数据。因此，在定义层之间需要发生的事情时，您最终会定义要传递的数据；同时，定义了一组严格的传递数据。

这里关于隔离的一个相关点是，不应该在层之间传递有关层实现的信息。也就是说，通过定义您的接口并严格执行，您应该能够使该层的实现可以从头开始重新实现，只知道接口，并且可以毫无问题地替换其他实现。

知道这一点会使事情变得简单；使用普通旧对象通常会使您的界面保持干净和正确；它可以防止您的数据结构变得臃肿。它还用于防止在另一层中使用有关某一层实施的一些信息的诱惑。

当然，要正确地做到这一点，从长远来看要解决的问题是有用的；用户想要执行的操作集是什么？这些操作通常将自己解析为“动词”，这些“动词”很好地映射到定义业务对象将实现的合同的接口定义。您的业​​务对象将对其进行操作的数据集将定义您需要在数据库上拥有的一组视图。这样，你可以干净利落地保持你的分离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T22:43:21.277

这些都是非常好的问题。有很多可能的答案和很多可能的架构。我建议您阅读有关该主题的入门读物。 [Patterns & Practices 有一个很好的](http://www.codeplex.com/AppArchGuide)。它是免费的、全面的，并深入讨论您提出的问题。没有一个架构指南是完美的，但作为一个起点，我认为学习基础知识不会出错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T22:42:23.820

我认为您不希望数据层了解有关业务或 UI 层的任何内容的想法有点遗漏。在 ORM 工具（例如 LINQ to SQL）中，实体的属性由数据决定。真的没有理由不这样做。拥有强类型实体与在数据层拥有业务/UI 逻辑不同，通常是一件好事；你如何到达那里取决于你。

我总是提倡使用强类型组件来传递数据，而不是像 DataSet/Table/Row/View/etc 这样的通用存储库。

也许您可以稍微扩展一下使您远离这种方法的原因？

# git - 让 Git 与代理服务器一起工作 - 因“请求超时”而失败

> ID：783811
> 
> 赞同：978
> 
> 时间：2009-04-23T22:32:53.877
> 
> 标签：git, version-control, proxy

如何让 Git 使用代理服务器？

我需要从 Git 服务器检查代码，但每次都显示“请求超时”。我该如何解决这个问题？

或者，如何设置代理服务器？

* * *

## 回答 #1

> 赞同：1746
> 
> 时间：2013-10-06T21:10:25.603

使用命令：

```
git config --global http.proxy http://proxyuser:proxypwd@proxy.server.com:8080 
```

*   更改`proxyuser`为您的代理用户
*   更改`proxypwd`您的代理密码
*   更改`proxy.server.com`为您的代理服务器的 URL
*   更改`8080`为代理服务器上配置的代理端口

请注意，这适用于 http 和 https 存储库。

如果您决定随时重置此代理并在没有代理的情况下工作：

使用命令：

```
git config --global --unset http.proxy 
```

最后，检查当前设置的代理：

```
git config --global --get http.proxy 
```

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2011-11-23T20:14:38.647

这对我有用，在企业防火墙后面的 Windows XP 中。

[除了来自http://code.google.com/p/msysgit/downloads/list?can=3](http://code.google.com/p/msysgit/downloads/list?can=3)的 git v1.771 之外，我不需要安装任何本地代理或任何其他软件

```
$ git config --global http.proxy http://proxyuser:proxypwd@proxy.server.com:8080
$ git config --system http.sslcainfo /bin/curl-ca-bundle.crt
$ git remote add origin https://mygithubuser:mygithubpwd@github.com/repoUser/repoName.git
$ git push origin master 
```

**proxyuser** = 我的 IT 部门分配的代理用户，在我的情况下，它是我用来登录我的 PC 的同一个 windows 用户，Active Directory 用户

**proxypwd** = 我的代理用户的密码

**proxy.server.com:8080** = 代理名称和端口，我从“控制面板”、“Internet 选项”、“连接”、“局域网设置”按钮、“代理服务器”部分内的“高级”按钮中获取，使用第一行 (http) 上的服务器名称和端口.

**mygithubuser** = 我用来登录 github.com 的用户

**mygithubpwd** = 我的 github.com 用户的密码

**repoUser** = repo 的用户所有者

**repoName** = 存储库的名称

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2010-07-01T19:42:18.027

设置一个名为的系统变量`http_proxy`，其值为`ProxyServer:Port`。这是最简单的解决方案。分别`https_proxy`用作评论中指出的大夫。

设置 gitproxy （正如 sleske 提到的）是另一种选择，但这需要一个“命令”，这不像上述解决方案那么简单。

参考资料： [http ://bardofschool.blogspot.com/2008/11/use-git-behind-proxy.html](http://bardofschool.blogspot.com/2008/11/use-git-behind-proxy.html)

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2012-05-25T12:21:12.283

如果配置代理服务器的命令行方式不起作用，您可能只需编辑 .gitconfig （在您的配置文件的根目录中，它可能隐藏在 C:\Documents and Settings 和某些网络驱动器中）并添加它：

```
[http]
    proxy = http://username:password@proxy.at.your.org:8080 
```

不过，YMMV 仅涵盖命令行配置的第一步。您可能还必须编辑系统 git 配置，我不知道他们把它藏在哪里。

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2016-10-05T14:03:45.507

作为 using 的替代方法`git config --global http.proxy address:port`，您可以在命令行上设置代理：

```
git -c "http.proxy=address:port" clone https://... 
```

优点是代理不是持久设置的。在 Bash 下，您可以设置别名：

```
alias git-proxy='git -c "http.proxy=address:port"' 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2014-01-15T11:30:09.103

如果您使用的是 ubuntu，请执行以下操作...

第 1 步：安装开瓶器

```
$ sudo apt-get install corkscrew 
```

第 2 步：编写一个名为 git-proxy.sh 的脚本并添加以下内容

```
#!/bin/sh

exec corkscrew <name of proxy server> <port> $*

# <name_of_proxy_server> and <port> are the ip address and port of the server
# e.g. exec corkscrew 192.168.0.1 808 $* 
```

第 3 步：使脚本可执行

```
$ chmod +x git-proxy.sh 
```

第 4 步：通过设置环境变量为 GIT 设置代理命令

```
$ export GIT_PROXY_COMMAND="/<path>/git-proxy.sh" 
```

现在使用 git 命令，例如

```
git clone git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2019-03-08T11:05:15.903

我注意到并想在这里分享一些东西：

```
git config --global http.proxy http://<proxy address>:<port number> 
```

上述方法不适用于 SSH URL（即`git@github.com:<user name>/<project name>.git`）：

```
git clone git@github.com:<user name>/<project name>.git // will not use the http proxy 
```

[如果我们在 HTTPS 端口（ https://help.github.com/en/articles/using-ssh-over-the-https-port](https://help.github.com/en/articles/using-ssh-over-the-https-port) ）上设置 SSH，事情不会改变，因为它只会改变端口（默认为 22 ) SSH 连接连接到。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2017-07-02T09:22:24.137

由于 Windows 中的多个文件而面临相同的问题`.gitconfig`，请按照以下步骤修复相同的问题：

**第 1 步：**打开 Git BASH

**步骤 2：**查找`.gitconfig`，执行以下命令：

```
git config --list --global --show-origin 
```

**第三步：**复制以下内容`.gitconfig`：

```
[http]
    proxy = http://YOUR_PROXY_USERNAME:YOUR_PROXY_PASSWORD@YOUR.PROXY.SERVER:YOUR.PROXY.SERVER.PORT
    sslverify = false
[https]
    proxy = http://YOUR_PROXY_USERNAME:YOUR_PROXY_PASSWORD@YOUR.PROXY.SERVER:YOUR.PROXY.SERVER.PORT
    sslverify = false
[url "http://github.com/"]
    insteadOf = git://github.com/

[user]
    name = Arpit Aggarwal
    email = aggarwalarpit.89@gmail.com 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2017-02-22T20:51:38.490

尝试将以下内容放入 ~/.gitconfig 文件：

```
[http]
    proxy = http://proxy:8080
[https]
    proxy = http://proxy:8080
[url "https://"]
    insteadOf = git:// 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2015-10-12T03:20:21.467

对于 git 协议（git://...），安装 socat 并编写如下脚本：

```
#!/bin/sh

exec socat - socks4:your.company.com:$1:$2 
```

使其可执行，将其放在您的路径中，并`~/.gitconfig`设置`core.gitproxy`为该脚本的名称。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2014-04-24T18:54:10.580

**我在工作中使用 Windows XP（州/政府），所以我做了我的研究并在[这里](http://kaamka.blogspot.com/2009/06/httpproxy-environment-variable.html)找到了它，它对我有用。希望这可以帮助 ：）**

***http_proxy 环境变量***

如果您使用代理服务器或防火墙，您可能需要设置 http_proxy 环境变量才能从命令行访问某些 url。示例：为 perl 安装 ppm 或在 linux 中应用 rpm，更新 ubuntu

使用代理服务器的主机名或 IP 地址设置 http_proxy 变量：http_proxy=http:// [proxy.example.org]

如果代理服务器需要用户名和密码，请将它们包含在以下格式中：http_proxy=http:// [username:password@proxy.example.org]

如果代理服务器使用 80 以外的端口，请包括端口号：http_proxy=http:// [username:password@proxy.example.org:8080]

**视窗**

> 1.  打开控制面板并单击系统图标。
> 2.  在高级选项卡上，单击环境变量。
> 3.  在系统变量面板中单击新建。
> 4.  使用适当的代理信息添加 http_proxy（参见上面的示例）。

**Linux、Solaris 或 HP-UX**

使用特定于您的shell 的命令（例如set 或export）设置http_proxy 环境变量。要使此更改持久化，请将命令添加到 shell 的相应配置文件中。例如，在 bash 中，在 .bash_profile 或 .bashrc 文件中添加如下一行：

> 1.  http_proxy=http:// [用户名:密码@主机名:端口];
> 2.  导出 $http_proxy

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2017-11-15T11:44:50.843

除了这些答案之外，我发现考虑以下两点很有帮助：

可能需要执行一种身份验证方案：

```
[http]
    # https://github.com/git/git/blob/master/Documentation/config.txt
    proxyAuthMethod = anyauth|basic|digest|negotiate|ntlm 
```

此外，通常使用 NTLM 身份验证架构，可能需要明确提供 AD 域。

在 git bash 中：

```
echo %userdomain% 
```

并相应地更新 http.proxy：

```
git config --global http.proxy http://DOMAIN\\proxyuser:proxypwd@proxy.server.com:8080 
```

无论如何，添加 CURL 日志可能有助于调查：

```
export GIT_CURL_VERBOSE=1 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2016-10-05T12:18:19.750

如果你安装并配置了[**tsocks**](https://sourceforge.net/projects/tsocks/)或[**proxychains**](http://proxychains.sourceforge.net/)，你可以

```
$ tsocks git clone <you_repository> 
```

或者

```
$ proxychains git clone <you_repository> 
```

为了让它更短，我创建了一个符号链接`/usr/bin/p`，`proxychains`所以我可以像这样使用它

```
p git clone <you_repository> 
```

我可以用它来代理任何命令，

```
p <cmd-need-be-proxied> 
```

顺便提一下，proxychains 好久没更新了，你可以试试[proxychians-ng](https://github.com/rofl0r/proxychains-ng)

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2016-12-12T08:20:24.407

**在终端上设置 git 代理**

如果

*   您不希望手动为每个 git 项目设置代理，一个接一个
*   总是想为所有项目使用相同的代理

全局设置一次

```
git config --global http.proxy username:password@proxy_url:proxy_port
git config --global https.proxy username:password@proxy_url:proxy_port 
```

如果您只想为一个 git 项目设置代理（在某些情况下，您可能不想为某些 git 连接使用相同的代理或任何代理）

```
//go to project root
cd /bla_bla/project_root
//set proxy for both http and https
git config http.proxy username:password@proxy_url:proxy_port
git config https.proxy username:password@proxy_url:proxy_port 
```

如果要显示当前代理设置

```
git config --list 
```

如果要全局删除代理

```
git config --global --unset http.proxy
git config --global --unset https.proxy 
```

如果您只想删除一个 git root 的代理

```
//go to project root
cd /bla-bla/project_root
git config --unset http.proxy
git config --unset https.proxy 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2017-12-27T09:54:46.733

这是代理设置

```
git config --global http.proxy http://<username>:<pass>@<ip>:<port>
git config --global https.proxy http://<username>:<pass>@<ip>:<port> 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2018-11-01T04:30:08.260

我遵循了这里推荐的大部分答案。首先，我收到以下错误：

> 致命：无法访问“ [https://github.com/folder/sample.git/](https://github.com/folder/sample.git/) ”：schannel：下一个 InitializeSecurityContext 失败：未知错误（0x80092012）-吊销功能无法检查证书的吊销。

然后我尝试了@Salim Hamidi 的以下命令

```
git config --global http.proxy http://proxyuser:proxypwd@proxy.server.com:8080 
```

但我收到以下错误：

> 致命：无法访问“ [https://github.com/folder/sample.git/](https://github.com/folder/sample.git/) ”：CONNECT 后从代理收到 HTTP 代码 407

如果代理服务器无法验证 SSL 证书，则可能会发生这种情况。所以我们要确保关闭 ssl 验证（不推荐用于不受信任的站点），所以我已经完成了 @Arpit 推荐的以下步骤，但有细微的变化：

1.首先确保删除任何以前的代理设置：

```
git config --global --unset http.proxy 
```

2.然后列出并获取gitconfig内容

```
git config --list --show-origin 
```

3.最后更新gitconfig文件内容如下：

```
[http]
sslCAInfo = C:/yourfolder/AppData/Local/Programs/Git/mingw64/ssl/certs/ca-bundle.crt
sslBackend = schannel
proxy = http://proxyuser:proxypwd@proxy.server.com:8080
sslverify = false
[https]
proxy = http://proxyuser:proxypwd@proxy.server.com:8080
sslverify = false 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2018-12-22T13:20:46.163

我已经尝试了上述所有答案，但没有任何效果，因为存在代理密码编码问题。

该命令有效：

```
git config --global http.proxy http://username@proxy.example.com:PortNumber 
```

不要在命令中输入密码。当您尝试连接到任何 git repo 时，它将动态询问。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-04-07T07:52:13.980

对于 Windows 用户：如果`git config`或`set http_proxy=`不起作用，[此答案](https://stackoverflow.com/a/36469864/1150303)可能会有所帮助：

`git://`将 git 存储库的协议替换为`http://`. `http_proxy`请注意，无论如何，您必须设置第一个。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-10-26T20:03:33.240

在不知疲倦地尝试了此页面上的每个解决方案之后，我的解决方法是改用 SSH 密钥！

1.  打开 Git Bash
2.  $ ssh-keygen.exe -t rsa -C
3.  打开您的 Git 提供程序（Github、Bitbucket 等）
4.  添加复制 id_rsa.pub 文件内容到 Git 提供者的输入页面（检查您的个人资料）

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2021-01-06T08:47:39.087

**使用代理的另一种方法是使用 SSH** 在 git configs 中，在 ssh 地址上配置源远程。然后使用 ssh-keygen 命令，它会为您提供可以在 GitLab 或 Gitab 帐户设置中设置的公钥登录相应完成...

1-通过`git remote -v`在您的 Git 客户端中运行来验证正在使用哪些遥控器。

2-如果这是 http(s) url，将其更改为 ssh 地址，运行：`git remote set-url <remote name, e.g. origin> <new SSH URL>` 例如

```
git remote set-url git@gitlab.com:example/myproject.git 
```

3-生成用于登录的 ssh 密钥，运行：`ssh-keygen -o`，此命令生成公钥（id_rsa.pub 文件）和私钥。

4拷贝**公钥**内容。（来自 id_rsa.pub 文件）

5-转到 gitlab/githup/.... 配置文件部分 > setting/ssh-key 。创建新的**ssh 密钥**并粘贴公钥内容

# iphone - 如何制作 swoosh 图形/声音效果？

> ID：783817
> 
> 赞同：1
> 
> 时间：2009-04-23T22:35:10.080
> 
> 标签：iphone, cocoa-touch, opengl, uiimageview

我有一个可以用手指拖动的 UIImageView。它的大小适合其中的图像，例如球或正方形。如果用户加速得非常快，我想用自身模糊的方式跟踪对象，以呈现快速行驶的外观。就像曲速一样。我也有嗖嗖声。我希望声音只在用户加速时持续。

我怎样才能实现这些效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T06:47:13.093

好吧，声音完全超出了我的技能——OpenGL 不支持声音，你必须研究 OpenAL 或 iPhone 上存在的任何等效项。

实现模糊的一种简单方法是保留对象最后几个点的数组。每当 UIImageView 移动时（我不确定是否有事件，或者您是否必须检查每一帧），您将新位置推送到数组中，删除最旧的位置。

每当需要渲染对象时，请查看最后几个点并计算当前位置与数组中最新项目之间的距离。如果它超过一定距离，请在阵列位置绘制模糊并检查接下来的两个点。继续直到距离低于一定量。

希望这可以帮助！

# javascript - 如何在 JavaScript 中创建自定义错误？

> ID：783818
> 
> 赞同：254
> 
> 时间：2009-04-23T22:35:21.920
> 
> 标签：javascript, exception

由于某种原因，构造函数委托在以下代码段中似​​乎不起作用：

```
function NotImplementedError() { 
  Error.apply(this, arguments); 
}
NotImplementedError.prototype = new Error();

var nie = new NotImplementedError("some message");
console.log("The message is: '"+nie.message+"'") 
```

运行这个给出`The message is: ''`. 关于为什么，或者是否有更好的方法来创建新`Error`子类的任何想法？我不知道`apply`的本机构造函数是否存在问题？`Error`

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2009-05-16T03:51:52.990

更新您的代码以将您的原型分配给 Error.prototype 和 instanceof 和您的断言工作。

```
function NotImplementedError(message = "") {
    this.name = "NotImplementedError";
    this.message = message;
}
NotImplementedError.prototype = Error.prototype; 
```

但是，我只会抛出您自己的对象并检查 name 属性。

```
throw {name : "NotImplementedError", message : "too lazy to implement"}; 
```

**根据评论编辑**

在查看了评论并试图记住为什么我会分配原型`Error.prototype`而不是`new Error()`像 Nicholas Zakas 在他的[文章](https://www.nczonline.net/blog/2009/03/10/the-art-of-throwing-javascript-errors-part-2/)中所做的那样，我使用以下代码创建了一个[jsFiddle](http://jsfiddle.net/MwMEJ/)：

```
function NotImplementedError(message = "") {
  this.name = "NotImplementedError";
  this.message = message;
}
NotImplementedError.prototype = Error.prototype;

function NotImplementedError2(message = "") {
  this.message = message;
}
NotImplementedError2.prototype = new Error();

try {
  var e = new NotImplementedError("NotImplementedError message");
  throw e;
} catch (ex1) {
  console.log(ex1.stack);
  console.log("ex1 instanceof NotImplementedError = " + (ex1 instanceof NotImplementedError));
  console.log("ex1 instanceof Error = " + (ex1 instanceof Error));
  console.log("ex1.name = " + ex1.name);
  console.log("ex1.message = " + ex1.message);
}

try {
  var e = new NotImplementedError2("NotImplementedError2 message");
  throw e;
} catch (ex1) {
  console.log(ex1.stack);
  console.log("ex1 instanceof NotImplementedError2 = " + (ex1 instanceof NotImplementedError2));
  console.log("ex1 instanceof Error = " + (ex1 instanceof Error));
  console.log("ex1.name = " + ex1.name);
  console.log("ex1.message = " + ex1.message);
}
```

控制台输出是这样的。

```
undefined
ex1 instanceof NotImplementedError = true
ex1 instanceof Error = true
ex1.name = NotImplementedError
ex1.message = NotImplementedError message
Error
    at window.onload (http://fiddle.jshell.net/MwMEJ/show/:29:34)
ex1 instanceof NotImplementedError2 = true
ex1 instanceof Error = true
ex1.name = Error
ex1.message = NotImplementedError2 message 
```

这证实了我遇到的“问题”是错误的堆栈属性`new Error()`是创建的行号，而不是`throw e`发生的位置。`NotImplementedError.prototype.name = "NotImplementedError"`但是，这可能比影响 Error 对象的线条的副作用更好。

另外，请注意`NotImplementedError2`，当我没有`.name`明确设置时，它等于“错误”。但是，正如评论中提到的那样，因为该版本将原型设置为`new Error()`，所以我可以设置`NotImplementedError2.prototype.name = "NotImplementedError2"`并没问题。

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2013-07-26T21:12:05.720

以上所有答案都非常糟糕 - 真的。甚至是107 ups的那个！真正的答案在这里，伙计们：

[从 Error 对象继承 - message 属性在哪里？](https://stackoverflow.com/questions/8802845/inheriting-from-the-error-object-where-is-the-message-property)

TL;博士：

A.`message`未设置的原因是`Error`该函数返回一个新的 Error 对象并且不*以*任何方式进行操作`this`。

B. 做到这一点的方法是从构造函数返回 apply 的结果，以及以通常复杂的 javascripty 方式设置原型：

```
function MyError() {
    var temp = Error.apply(this, arguments);
    temp.name = this.name = 'MyError';
    this.message = temp.message;
    if(Object.defineProperty) {
        // getter for more optimizy goodness
        /*this.stack = */Object.defineProperty(this, 'stack', { 
            get: function() {
                return temp.stack
            },
            configurable: true // so you can change it if you want
        })
    } else {
        this.stack = temp.stack
    }
}
//inherit prototype using ECMAScript 5 (IE 9+)
MyError.prototype = Object.create(Error.prototype, {
    constructor: {
        value: MyError,
        writable: true,
        configurable: true
    }
});

var myError = new MyError("message");
console.log("The message is: '" + myError.message + "'"); // The message is: 'message'
console.log(myError instanceof Error); // true
console.log(myError instanceof MyError); // true
console.log(myError.toString()); // MyError: message
console.log(myError.stack); // MyError: message \n 
// <stack trace ...>

//for EMCAScript 4 or ealier (IE 8 or ealier), inherit prototype this way instead of above code:
/*
var IntermediateInheritor = function() {};
IntermediateInheritor.prototype = Error.prototype;
MyError.prototype = new IntermediateInheritor();
*/
```

您可能会做一些技巧来枚举`tmp`Error 的所有不可枚举属性来设置它们，而不是仅显式设置`stack`and `message`，但是 ie<9 不支持这种技巧

* * *

## 回答 #3

> 赞同：90
> 
> 时间：2017-06-14T16:09:57.443

在 ES2015 中，您可以使用`class`干净地执行此操作：

```
class NotImplemented extends Error {
  constructor(message = "", ...args) {
    super(message, ...args);
    this.message = message + " has not yet been implemented.";
  }
} 
```

这不会修改全局`Error`原型，允许您自定义`message`、`name`和其他属性，并正确捕获堆栈。它的可读性也很好。

当然，`babel`如果您的代码将在旧版浏览器上运行，您可能需要使用这样的工具。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2014-12-22T02:12:14.930

如果有人对如何创建自定义错误**并**获取堆栈跟踪感到好奇：

```
function CustomError(message) {
  this.name = 'CustomError';
  this.message = message || '';
  var error = new Error(this.message);
  error.name = this.name;
  this.stack = error.stack;
}
CustomError.prototype = Object.create(Error.prototype);

try {
  throw new CustomError('foobar');
}
catch (e) {
  console.log('name:', e.name);
  console.log('message:', e.message);
  console.log('stack:', e.stack);
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-08-12T06:31:27.520

标准的这一部分可以解释为什么`Error.apply`调用不初始化对象：

> **15.11.1 作为函数调用的错误构造函数**
> 
> 当 Error 作为函数而不是构造函数调用时，它会创建并初始化一个新的 Error 对象。因此，函数调用 Error(...) 等效于具有相同参数的对象创建表达式 new Error(...)。

在这种情况下，该`Error`函数可能确定它没有被作为构造函数调用，因此它返回一个新的 Error 实例而不是初始化`this`对象。

使用以下代码进行测试似乎表明这实际上是正在发生的事情：

```
function NotImplementedError() { 
   var returned = Error.apply(this, arguments);
   console.log("returned.message = '" + returned.message + "'");
   console.log("this.message = '" + this.message + "'");
}
NotImplementedError.prototype = new Error();

var nie = new NotImplementedError("some message"); 
```

运行时会生成以下输出：

```
returned.message = 'some message'
this.message = '' 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-11-20T05:43:30.633

```
function InvalidValueError(value, type) {
    this.message = "Expected `" + type.name + "`: " + value;
    var error = new Error(this.message);
    this.stack = error.stack;
}
InvalidValueError.prototype = new Error();
InvalidValueError.prototype.name = InvalidValueError.name;
InvalidValueError.prototype.constructor = InvalidValueError; 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-10-19T09:48:09.397

[根据 Joyent](https://www.joyent.com/node-js/production/design/errors#4-augment-the--code-error--code--object-with-properties-that-explain-details)的说法，您不应该弄乱堆栈属性（我在这里给出的很多答案中都看到了），因为它会对性能产生负面影响。他们是这样说的：

> **堆栈：**一般来说，不要搞砸这个。甚至不要增加它。V8 仅在有人实际读取该属性时才计算它，这显着提高了可处理错误的性能。如果您只是为了增加它而读取该属性，即使您的调用者不需要堆栈，您最终也会付出代价。

我喜欢并且想提一下[他们包装原始错误的想法，](https://www.joyent.com/node-js/production/design/errors#5-if-you-pass-a-lower-level-error-to-your-caller-consider-wrapping-it-instead)这是一个很好的替代传递堆栈的方法。

因此，考虑到上述情况，这是我创建自定义错误的方法：

# es5 版本：

```
function RError(options) {
    options = options || {}; // eslint-disable-line no-param-reassign
    this.name = options.name;
    this.message = options.message;
    this.cause = options.cause;

    // capture stack (this property is supposed to be treated as private)
    this._err = new Error();

    // create an iterable chain
    this.chain = this.cause ? [this].concat(this.cause.chain) : [this];
}
RError.prototype = Object.create(Error.prototype, {
    constructor: {
        value: RError,
        writable: true,
        configurable: true
    }
});

Object.defineProperty(RError.prototype, 'stack', {
    get: function stack() {
        return this.name + ': ' + this.message + '\n' + this._err.stack.split('\n').slice(2).join('\n');
    }
});

Object.defineProperty(RError.prototype, 'why', {
    get: function why() {
        var _why = this.name + ': ' + this.message;
        for (var i = 1; i < this.chain.length; i++) {
            var e = this.chain[i];
            _why += ' <- ' + e.name + ': ' + e.message;
        }
        return _why;
    }
});

// usage

function fail() {
    throw new RError({
        name: 'BAR',
        message: 'I messed up.'
    });
}

function failFurther() {
    try {
        fail();
    } catch (err) {
        throw new RError({
            name: 'FOO',
            message: 'Something went wrong.',
            cause: err
        });
    }
}

try {
    failFurther();
} catch (err) {
    console.error(err.why);
    console.error(err.stack);
    console.error(err.cause.stack);
}
```

# es6 版本：

```
class RError extends Error {
    constructor({name, message, cause}) {
        super();
        this.name = name;
        this.message = message;
        this.cause = cause;
    }
    [Symbol.iterator]() {
        let current = this;
        let done = false;
        const iterator = {
            next() {
                const val = current;
                if (done) {
                    return { value: val, done: true };
                }
                current = current.cause;
                if (!val.cause) {
                    done = true;
                }
                return { value: val, done: false };
            }
        };
        return iterator;
    }
    get why() {
        let _why = '';
        for (const e of this) {
            _why += `${_why.length ? ' <- ' : ''}${e.name}: ${e.message}`;
        }
        return _why;
    }
}

// usage

function fail() {
    throw new RError({
        name: 'BAR',
        message: 'I messed up.'
    });
}

function failFurther() {
    try {
        fail();
    } catch (err) {
        throw new RError({
            name: 'FOO',
            message: 'Something went wrong.',
            cause: err
        });
    }
}

try {
    failFurther();
} catch (err) {
    console.error(err.why);
    console.error(err.stack);
    console.error(err.cause.stack);
}
```

我已将我的解决方案放入一个模块中，这里是：[https ://www.npmjs.com/package/rerror](https://www.npmjs.com/package/rerror)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2018-09-21T23:42:34.103

我喜欢这样做：

*   使用[名称](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/name)所以 toString() 抛出`"{code}: {message}"`
*   将相同的东西返回给 super，使其在堆栈跟踪中看起来相同
*   将代码附加到`error.code`检查/解析代码比检查消息更好，例如您可能希望将其本地化
*   附加消息`error.message`作为替代`error.toString()`

```
class AppException extends Error {
  constructor(code, message) {
    const fullMsg = message ? `${code}: ${message}` : code;
    super(fullMsg);
    this.name = code;
    this.code = code;
    this.message = fullMsg;
  }

  toString() {
    return this.message;
  }
}

// Just a code
try {
  throw new AppException('FORBIDDEN');
} catch(e) {
  console.error(e);
  console.error(e.toString());
  console.log(e.code === 'FORBIDDEN');
}

// A code and a message
try {
  throw new AppException('FORBIDDEN', 'You don\'t have access to this page');
} catch(e) {
  console.error(e);
  console.error(e.toString());
  console.log(e.code === 'FORBIDDEN');
}
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-05-16T11:56:12.137

我有一个类似的问题。我的错误必须是`instanceof`两者`Error`，`NotImplemented`并且还需要在控制台中产生连贯的回溯。

我的解决方案：

```
var NotImplemented = (function() {
  var NotImplemented, err;
  NotImplemented = (function() {
    function NotImplemented(message) {
      var err;
      err = new Error(message);
      err.name = "NotImplemented";
      this.message = err.message;
      if (err.stack) this.stack = err.stack;
    }
    return NotImplemented;
  })();
  err = new Error();
  err.name = "NotImplemented";
  NotImplemented.prototype = err;

  return NotImplemented;
}).call(this);

// TEST:
console.log("instanceof Error: " + (new NotImplemented() instanceof Error));
console.log("instanceof NotImplemented: " + (new NotImplemented() instanceofNotImplemented));
console.log("message: "+(new NotImplemented('I was too busy').message));
throw new NotImplemented("just didn't feel like it"); 
```

使用 node.js 运行的结果：

```
instanceof Error: true
instanceof NotImplemented: true
message: I was too busy

/private/tmp/t.js:24
throw new NotImplemented("just didn't feel like it");
      ^
NotImplemented: just didn't feel like it
    at Error.NotImplemented (/Users/colin/projects/gems/jax/t.js:6:13)
    at Object.<anonymous> (/Users/colin/projects/gems/jax/t.js:24:7)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.runMain (module.js:487:10)
    at process.startup.processNextTick.process._tickCallback (node.js:244:9) 
```

该错误通过了我的所有 3 个标准，尽管该`stack`属性是非标准的，[但大多数较新的浏览器都支持它](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error/Stack#Browser_Compatibility)，这在我的情况下是可以接受的。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2020-08-10T08:57:15.683

```
class NotImplementedError extends Error {
  constructor(message) {
    super(message);
    this.message = message;
  }
}
NotImplementedError.prototype.name = 'NotImplementedError';
module.exports = NotImplementedError; 
```

和

```
try {
  var e = new NotImplementedError("NotImplementedError message");
  throw e;
} catch (ex1) {
  console.log(ex1.stack);
  console.log("ex1 instanceof NotImplementedError = " + (ex1 instanceof NotImplementedError));
  console.log("ex1 instanceof Error = " + (ex1 instanceof Error));
  console.log("ex1.name = " + ex1.name);
  console.log("ex1.message = " + ex1.message);
} 
```

它只是[这个](https://stackoverflow.com/a/871646/1448511)答案的一个类表示。

输出

```
NotImplementedError: NotImplementedError message
  ...stacktrace
ex1 instanceof NotImplementedError = true
ex1 instanceof Error = true
ex1.name = NotImplementedError
ex1.message = NotImplementedError message 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-02-16T17:33:35.617

我使用构造函数模式来创建新的错误对象。我定义了**原型链**，例如一个`Error`实例。请参阅 MDN[错误构造函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)参考。

**[您可以在此gist](https://gist.github.com/jherax/c2f151165ecb19b9f8e3)**上查看此代码段。

## 执行

```
// Creates user-defined exceptions
var CustomError = (function() {
  'use strict';

  //constructor
  function CustomError() {
    //enforces 'new' instance
    if (!(this instanceof CustomError)) {
      return new CustomError(arguments);
    }
    var error,
      //handles the arguments object when is passed by enforcing a 'new' instance
      args = Array.apply(null, typeof arguments[0] === 'object' ? arguments[0] : arguments),
      message = args.shift() || 'An exception has occurred';

    //builds the message with multiple arguments
    if (~message.indexOf('}')) {
      args.forEach(function(arg, i) {
        message = message.replace(RegExp('\\{' + i + '}', 'g'), arg);
      });
    }

    //gets the exception stack
    error = new Error(message);
    //access to CustomError.prototype.name
    error.name = this.name;

    //set the properties of the instance
    //in order to resemble an Error instance
    Object.defineProperties(this, {
      stack: {
        enumerable: false,
        get: function() { return error.stack; }
      },
      message: {
        enumerable: false,
        value: message
      }
    });
  }

  // Creates the prototype and prevents the direct reference to Error.prototype;
  // Not used new Error() here because an exception would be raised here,
  // but we need to raise the exception when CustomError instance is created.
  CustomError.prototype = Object.create(Error.prototype, {
    //fixes the link to the constructor (ES5)
    constructor: setDescriptor(CustomError),
    name: setDescriptor('JSU Error')
  });

  function setDescriptor(value) {
    return {
      configurable: false,
      enumerable: false,
      writable: false,
      value: value
    };
  }

  //returns the constructor
  return CustomError;
}()); 
```

## 用法

CustomError 构造函数可以接收许多参数来构建消息，例如

```
var err1 = new CustomError("The url of file is required"),
    err2 = new CustomError("Invalid Date: {0}", +"date"),
    err3 = new CustomError("The length must be greater than {0}", 4),
    err4 = new CustomError("Properties .{0} and .{1} don't exist", "p1", "p2");

throw err4; 
```

这就是自定义错误的外观：

[![自定义错误原型链](https://i.stack.imgur.com/QnUPb.png)](https://i.stack.imgur.com/QnUPb.png)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-05-31T11:14:54.253

我只需要实现这样的东西，发现堆栈在我自己的错误实现中丢失了。我必须做的是创建一个虚拟错误并从中检索堆栈：

```
My.Error = function (message, innerException) {
    var err = new Error();
    this.stack = err.stack; // IMPORTANT!
    this.name = "Error";
    this.message = message;
    this.innerException = innerException;
}
My.Error.prototype = new Error();
My.Error.prototype.constructor = My.Error;
My.Error.prototype.toString = function (includeStackTrace) {
    var msg = this.message;
    var e = this.innerException;
    while (e) {
        msg += " The details are:\n" + e.message;
        e = e.innerException;
    }
    if (includeStackTrace) {
        msg += "\n\nStack Trace:\n\n" + this.stack;
    }
    return msg;
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-09-12T14:56:01.050

这是我的实现：

```
class HttpError extends Error {
  constructor(message, code = null, status = null, stack = null, name = null) {
    super();
    this.message = message;
    this.status = 500;

    this.name = name || this.constructor.name;
    this.code = code || `E_${this.name.toUpperCase()}`;
    this.stack = stack || null;
  }

  static fromObject(error) {
    if (error instanceof HttpError) {
      return error;
    }
    else {
      const { message, code, status, stack } = error;
      return new ServerError(message, code, status, stack, error.constructor.name);
    }
  }

  expose() {
    if (this instanceof ClientError) {
      return { ...this };
    }
    else {
      return {
        name: this.name,
        code: this.code,
        status: this.status,
      }
    }
  }
}

class ServerError extends HttpError {}

class ClientError extends HttpError { }

class IncorrectCredentials extends ClientError {
  constructor(...args) {
    super(...args);
    this.status = 400;
  }
}

class ResourceNotFound extends ClientError {
  constructor(...args) {
    super(...args);
    this.status = 404;
  }
} 
```

**示例用法#1：**

```
app.use((req, res, next) => {
  try {
    invalidFunction();
  }
  catch (err) {
    const error = HttpError.fromObject(err);
    return res.status(error.status).send(error.expose());
  }
}); 
```

**示例用法#2：**

```
router.post('/api/auth', async (req, res) => {
  try {
    const isLogged = await User.logIn(req.body.username, req.body.password);

    if (!isLogged) {
      throw new IncorrectCredentials('Incorrect username or password');
    }
    else {
      return res.status(200).send({
        token,
      });
    }
  }
  catch (err) {
    const error = HttpError.fromObject(err);
    return res.status(error.status).send(error.expose());
  }
}); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-23T22:42:49.700

构造函数需要像工厂方法一样返回你想要的。如果您需要其他方法/属性，可以在返回之前将它们添加到对象中。

```
function NotImplementedError(message) { return new Error("Not implemented", message); }

x = new NotImplementedError(); 
```

虽然我不确定你为什么需要这样做。为什么不直接使用`new Error...`？自定义异常在 JavaScript（或者可能是任何无类型语言）中并没有真正增加太多。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-01-27T01:34:12.480

这在 Cesium DeveloperError 中很好地实现了：

*   [文档](http://cesiumjs.org/Cesium/Build/Documentation/DeveloperError.html)
*   [来源](https://github.com/AnalyticalGraphicsInc/cesium/blob/b24/Source/Core/DeveloperError.js)

在它的简化形式：

```
var NotImplementedError = function(message) {
    this.name = 'NotImplementedError';
    this.message = message;
    this.stack = (new Error()).stack;
}

// Later on...

throw new NotImplementedError(); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-04-28T14:58:04.880

以无法使用为代价`instanceof`，以下保留原始堆栈跟踪并且不使用任何非标准技巧。

```
// the function itself
var fixError = function(err, name) {
    err.name = name;
    return err;
}

// using the function
try {
    throw fixError(new Error('custom error message'), 'CustomError');
} catch (e) {
    if (e.name == 'CustomError')
        console.log('Wee! Custom Error! Msg:', e.message);
    else
        throw e; // unhandled. let it propagate upwards the call stack
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-07-30T09:00:36.580

另一种选择，可能无法在所有环境中工作。至少保证它在 nodejs 0.8 中工作这种方法使用修改内部 proto 属性的非标准方式

```
function myError(msg){ 
      var e = new Error(msg); 
      _this = this; 
      _this.__proto__.__proto__ = e;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-10-24T20:31:05.250

如果您使用的是 Node/Chrome。以下代码段将为您提供满足以下要求的扩展。

*   `err instanceof Error`
*   `err instanceof CustomErrorType`
*   console.log()`[CustomErrorType]`在创建时返回一条消息
*   console.log()`[CustomErrorType: message]`在没有消息的情况下创建时返回
*   throw/stack 提供错误创建时的信息。
*   在 Node.JS 和 Chrome 中运行最佳。
*   将在 Chrome、Safari、Firefox 和 IE 8+ 中通过 instanceof 检查，但在 Chrome/Safari 之外没有有效堆栈。我可以接受，因为我可以在 chrome 中进行调试，但是需要特定错误类型的代码仍然可以跨浏览器运行。**如果您只需要 Node，您可以轻松删除这些`if`语句，一切顺利**。

片段

```
var CustomErrorType = function(message) {
    if (Object.defineProperty) {
        Object.defineProperty(this, "message", {
            value : message || "",
            enumerable : false
        });
    } else {
        this.message = message;
    }

    if (Error.captureStackTrace) {
        Error.captureStackTrace(this, CustomErrorType);
    }
}

CustomErrorType.prototype = new Error();
CustomErrorType.prototype.name = "CustomErrorType"; 
```

用法

```
var err = new CustomErrorType("foo"); 
```

输出

```
var err = new CustomErrorType("foo");
console.log(err);
console.log(err.stack);

[CustomErrorType: foo]
CustomErrorType: foo
    at Object.<anonymous> (/errorTest.js:27:12)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:906:3

/errorTest.js:30
        throw err;
              ^
CustomErrorType: foo
    at Object.<anonymous> (/errorTest.js:27:12)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:906:3 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-01-06T15:21:23.530

以下内容对我有用，取自官方 Mozilla 文档[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)。

```
function NotImplementedError(message) {
    var instance = new Error(message);
    instance.name = 'NotImplementedError';

    Object.setPrototypeOf(instance, Object.getPrototypeOf(this));
    if (Error.captureStackTrace) {
        Error.captureStackTrace(instance, NotImplementedError);
    }
    return instance;
}

NotImplementedError.prototype = Object.create(Error.prototype, {
    constructor: {
        value: Error,
        enumerable: false,
        writable: true,
        configurable: true
    }
}); 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2012-08-19T21:09:26.480

为用户定义的错误类型的每个实例尝试一个新的原型对象。它允许`instanceof`检查正常运行，并且在 Firefox 和 V8（Chome、nodejs）中正确报告类型和消息。

```
function NotImplementedError(message){
    if(NotImplementedError.innercall===undefined){
        NotImplementedError.innercall = true;
        NotImplementedError.prototype = new Error(message);
        NotImplementedError.prototype.name = "NotImplementedError";
        NotImplementedError.prototype.constructor = NotImplementedError;

        return new NotImplementedError(message);
    }
    delete NotImplementedError.innercall;
} 
```

请注意，附加条目将在其他正确堆栈之前。

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2020-02-05T17:19:37.467

这是最快的方法：

```
 let thisVar = false

    if (thisVar === false) {
            throw new Error("thisVar is false. It should be true.")
    } 
```

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2013-03-06T19:27:28.060

更简单的方法。你可以让你的对象继承自 Error 对象。例子：

```
function NotImplementError(message)
{
    this.message = message;
    Error.call();
    Error.call(message);
} 
```

我们正在做的是使用函数 call() 调用 Error 类的构造函数，因此与在其他面向对象语言中实现类继承基本相同。

* * *

## 回答 #23

> 赞同：-3
> 
> 时间：2017-09-04T21:59:38.107

MDN 有一个[很好的例子](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)：

```
try {
  throw new Error('Whoops!');
} catch (e) {
  console.log(e.name + ': ' + e.message);
} 
```

# java - JVM 在并行处理方面有多好？我什么时候应该创建自己的线程和可运行对象？为什么线程会干扰？

> ID：783819
> 
> 赞同：4
> 
> 时间：2009-04-23T22:35:35.787
> 
> 标签：java, multithreading, multicore

我有一个运行许多小型模拟的 Java 程序。它运行一个遗传算法，其中每个适应度函数都是使用每个染色体上的参数进行的模拟。每个单独运行可能需要 10 秒左右，我想运行一个相当大的人口规模（比如 100？）。在上一轮模拟完成之前，我无法开始下一轮模拟。我可以访问一台装有大量处理器的机器，我想知道我是否需要做任何事情来使模拟并行运行。我以前从未为多核处理器明确写过任何东西，我知道这是一项艰巨的任务。

所以这就是我想知道的：JVM 并行化的程度和效果如何？我读过它创建了低级线程，但它有多聪明？它的效率如何？如果我将每个模拟都设为线程，我的程序会运行得更快吗？我知道这是一个很大的话题，但你能指出一些关于并行处理和 Java 的介绍性文献吗？

非常感谢！

**更新：** 好的，我已经实现了一个 ExecutorService 并使我的小型模拟实现 Runnable 并具有 run() 方法。而不是这样写：

```
Simulator sim = new Simulator(args); 
sim.play(); 
return sim.getResults(); 
```

我在构造函数中写了这个：

```
ExecutorService executor = Executors.newFixedThreadPool(32); 
```

然后每次我想向池中添加一个新的模拟时，我运行这个：

```
RunnableSimulator rsim = new RunnableSimulator(args); 
exectuor.exectue(rsim); 
return rsim.getResults(); 
```

该`RunnableSimulator::run()`方法调用该`Simulator::play()`方法，两者都没有参数。

我想我遇到了线程干扰，因为现在模拟错误了。通过错误输出，我的意思是变量包含它们真正不应该的值。没有更改模拟中的代码，并且在模拟完美运行许多不同的参数之前。模拟游戏的工作原理是这样的：每回合都有一个游戏块，并循环遍历游戏板上的所有位置。它检查给定的位置是否有效，如果有效，则提交该部分，并衡量该板的好坏。现在，显然无效的位置被传递给 commit 方法，导致索引超出范围的错误到处都是。

每个模拟都是它自己的对象，对吧？根据上面的代码？我可以将完全相同的一组参数传递给`RunnableSimulator`和`Simulator`类，并且可运行版本会抛出异常。您认为可能导致这种情况的原因是什么，我能做些什么来防止这种情况发生？我可以在新问题中提供一些代码示例以提供帮助吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-23T22:39:38.353

[Java并发教程](http://java.sun.com/docs/books/tutorial/essential/concurrency/index.html)

如果您只是将一堆东西生成到不同的线程，并且不会在不同的线程之间来回交谈，那并不太难；只需将每个写入[Runnable](http://java.sun.com/javase/6/docs/api/java/lang/Runnable.html)并将它们传递给[ExecutorService](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)。

您应该浏览整个教程，但对于这个特定的任务，请[从这里开始](http://java.sun.com/docs/books/tutorial/essential/concurrency/executors.html)。

基本上，你做这样的事情：

```
ExecutorService executorService = Executors.newFixedThreadPool(n); 
```

其中 n 是您想要一次运行的事物的数量（通常是 CPU 的数量）。您的每个任务都应该是一个实现 Runnable 的对象，然后您在 ExecutorService 上执行它：

```
executorService.execute(new SimulationTask(parameters...)); 
```

`Executors.newFixedThreadPool(n)`将启动`n`线程，并执行将任务插入到提供给这些线程的队列中。当一个任务完成时，它正在运行的线程不再忙，队列中的下一个任务将开始在它上面运行。执行不会阻塞；它只会将任务放入队列并继续执行下一个任务。

需要注意的是，您确实没有在任务之间共享任何可变状态。你的任务类不应该依赖于它们之间共享的任何可变的东西（即静态数据）。有一些方法可以处理共享的可变状态（锁定），但如果你能完全避免这个问题，它会容易得多。

编辑：阅读您对问题的编辑，看起来您真的想要一些不同的东西。与其执行`Runnable`，不如执行[`Callable`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Callable.html)。您的`call()`方法应该与您当前的方法几乎相同`run()`，除了它应该`return getResults();`。然后，`submit()`它到您的`ExecutorService`. 你会得到一个[`Future`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Future.html)作为回报，你可以用它来测试模拟是否完成，当它完成时，得到你的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T23:02:55.300

您还可以看到[Doug Lea](http://gee.cs.oswego.edu/)的[新 fork join 框架](http://gee.cs.oswego.edu/dl/concurrency-interest/index.html)。关于该主题的最佳书籍之一当然是[Java Concurrency in Practice](https://rads.stackoverflow.com/amzn/click/com/0321349601)。我强烈建议您查看分叉连接模型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-26T13:34:03.883

Java 线程太重了。我们在 Ateji PX 中将并行分支实现为非常轻量级的计划对象。与在 Erlang 中一样，您可以在开始注意到开销之前创建数千万个并行分支。但它仍然是 Java，因此您无需切换到其他语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T23:08:47.097

如果您一直在线程中进行全面处理，那么线程数多于处理器数不会使您受益。如果您的线程偶尔会相互等待或在系统上等待，那么 Java 可以很好地扩展到数千个线程。

我编写了一个应用程序，通过 ping 每个节点在几分钟内发现了 B 类网络（65,000），并且每次 ping 重试的延迟越来越大。当我将每个 ping 放在一个单独的线程上时（这是在 NIO 之前，我现在可能可以改进它），在事情开始变得不稳定之前，我可以在 Windows 中运行大约 4000 个线程。Linux 这个数字接近 1000（从来不知道为什么）。

无论您使用哪种语言或工具包，如果您的数据进行交互，您都必须注意它所在的那些区域。Java 使用 Synchronized 关键字来防止两个线程同时访问一个节。如果您以更实用的方式编写 Java（使您的所有成员成为最终成员），您可以在不同步的情况下运行，但它可以——好吧，我们只是说解决问题采用不同的方法。

Java 还有其他管理独立工作单元的工具，请查看“并发”包以获取更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T14:28:02.087

Java 非常擅长并行处理，但有两个警告：

*   Java 线程是相对重量级的（与例如 Erlang 相比），所以不要开始创建成百上千的线程。每个线程都有自己的堆栈内存（默认值：256KB），您可能会耗尽内存等。
*   如果你在一台非常强大的机器上运行（尤其是有很多 CPU 和大量 RAM），那么 VM 的默认设置（尤其是关于 GC）可能会导致性能欠佳，你可能不得不花一些时间通过[命令来调整它们线路选项](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)。不幸的是，这不是一项简单的任务，需要大量的知识。

# database - 文件 'C:\....\.....\.....\bin\debug\128849991926295643' 已经存在

> ID：783820
> 
> 赞同：0
> 
> 时间：2009-04-23T22:35:40.687
> 
> 标签：database, numbers, rows

我正在使用 Visual C#2008 Express Edition 和 Express SQL 数据库。每次我构建我的解决方案时，都会收到类似上述错误。显然文件名发生了变化。每次我遇到调试点时，也会创建一个新文件。

我有一个存储过程，它从数据库表中获取每一行，每次主窗体初始化时它都会获取这些行并将它们添加到泛型列表中。如果不从表中插入或删除，每次我启动 Windows 应用程序时它都会获得不同数量的行。该错误与奇怪的数据检索问题同时开始发生。关于什么会导致这种情况的任何想法？

谢谢

何塞，

当然，这是我的 c# 方法，它检索表中的每一行，每一行都有一个 int 和 Image ....

```
 private List<ImageNumber> GetListOfKnownImagesAndNumbers()
    {
        //ImageNumber imNum = new ImageNumber();

        SqlCommand sqlCommand = new SqlCommand();
        sqlCommand.Connection = _conn;

        try
        {
            MemoryStream ms = new MemoryStream();

            sqlCommand.CommandText = "usp_GetKnownImagesAndValues";

            _conn.Open();
            using (IDataReader dr = sqlCommand.ExecuteReader())
            {
                while (dr.Read())
                {
                    ImageNumber imNum = new ImageNumber();
                    imNum.Value = dr.IsDBNull(dr.GetOrdinal("ImageValue")) ? 0 : Convert.ToInt32(dr["ImageValue"]);

                    //Turn the bitmap into a byte array
                    byte[] barrImg = (byte[])dr["ImageCaptured"];
                    string strfn = Convert.ToString(DateTime.Now.ToFileTime());
                    FileStream fs = new FileStream(strfn,
                                      FileMode.CreateNew, FileAccess.Write);
                    fs.Write(barrImg, 0, barrImg.Length);
                    fs.Flush();
                    fs.Close();
                    imNum.Image = (Bitmap)Image.FromFile(strfn);

                    _listOfNumbers.Add(imNum);
                }
                dr.Close();
                _conn.Close();
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
        finally
        {
            _conn.Close();
        }

        return _listOfNumbers;

    } 
```

这是我的存储过程....

更改程序 dbo.usp_GetKnownImagesAndValues 开始

```
select  ImageCaptured, ImageValue
from CapturedImages 
```

结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T19:35:40.657

谢谢你看这个。最后的答案是将 Thread.Sleep 放在 while 循环中，它开始完美地工作。我可能还有其他事情可以做，我显然在等待完成某些事情，这就是为什么在这里允许更多时间有所帮助的原因。如果我知道需要完成什么以及如何检测它何时完成，那么我可以检查它而不是简单地等待一小段时间。

# events - 订阅 .NET 中的 Vista 事件（例如，打开的窗口）

> ID：783822
> 
> 赞同：0
> 
> 时间：2009-04-23T22:35:46.177
> 
> 标签：events, windows-vista

我正在尝试为 Vista 构建自己的小工具箱。

其中一个功能是“窗口放置工具”，它将窗口放置在保存的位置。我可以想象的另一个工具是 Firefox 或 Thunderbird 的扩展......

为了使这些工具正常工作，我需要它们能够在 Vista 中捕获“事件”。给你一个具体的例子：

*   资源管理器打开新窗口
*   用户启动 Firefox
*   鼠标移动

对于鼠标案例，有一些 C# 示例。我也知道目录观察者，不错的小帮手。

我现在需要的是**“新窗口打开事件”**

知道如何监控这一点，而不是每 5 秒迭代一次当前窗口列表（我已经知道如何使用 DLLImports 获取 Windows，并使用托管代码获取进程。但是当资源管理器进程打开一个新窗口时我没有事件）

谢谢你的帮助，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T23:46:38.050

你所说的做起来一点也不简单。

您将需要注册一个[钩子](http://msdn.microsoft.com/en-us/library/ms644990.aspx)，并且您将必须构建一个回调过程，该过程在另一个进程的执行上下文中被调用——这不会是 .NET 代码（可能是 C），并且会必须在 DLL 中。每次发生某类事件时，都会调用该回调过程。它将检查它接收到的事件并过滤掉您感兴趣的事件，然后向您的应用程序发送您想要的通知（可能通过[PostMessage](http://msdn.microsoft.com/en-us/library/ms644944(VS.85).aspx)）。然后，您将进入应用程序的主消息循环以拦截这些消息，然后您可以从那里触发 .NET 事件或任何您想要的。

编写钩子回调是一件棘手的事情，因为代码在另一个进程中运行，而不是您自己的，并且内存管理和并发问题需要一些预先考虑。出于同样的原因，它不会在 C# 中完成。不过，理想情况下，此回调代码将非常小且非常快，因为它会被如此频繁地调用。

另请注意，虽然在 Win32 中完全“合法”，但这些系统挂钩具有巨大的功能，并且通常被恶意软件用来改变系统的工作方式。因此，如果您尝试在客户的计算机上执行此类操作，您可能会与防病毒软件发生冲突。

另请注意，系统挂钩的深远影响还意味着简单的编程错误可能会破坏整个系统，您可能会在调试时自己发现；所以在你点击“运行”之前保存所有内容。

祝你好运！

## 编辑

做了更多的搜索，看看是否有任何方法可以在 C# 中编写 hook proc，并想出了这个：

[如何在 Visual C# .NET 中设置 Windows 挂钩](http://support.microsoft.com/kb/318804)

这几乎是您正在寻找的，但不完全是。挂钩过程可以是全局的（这意味着它们在每个应用程序上运行）或线程（仅在您的应用程序内运行）。该文件指出：

> **.NET Framework 不支持全局挂钩**
> 
> 除了 `WH_KEYBOARD_LL`低级挂钩和 `WH_MOUSE_LL`低级挂钩外，您不能在 Microsoft .NET Framework 中实现全局挂钩。要安装全局挂钩，挂钩必须具有本机 DLL 导出，以将自身注入另一个需要有效、一致的函数才能调用的进程。此行为需要 DLL 导出。.NET Framework 不支持 DLL 导出。托管代码没有函数指针一致值的概念，因为这些函数指针是动态构建的代理。

这再次意味着，要监视应用程序视图之外发生的事情，您需要设置一个全局挂钩，而这不能用 .NET 编写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-13T19:49:21.263

我有与此完全相同的问题，我认为我有一个可行的解决方案。最初，我研究了与“tylerl”提到的选项类似的选项。然而，就我而言，我没有使用“SetWindowsHookEx”，而是尝试使用类似的函数“RegisterShellHookWindows”。

不幸的是，这只成功地向我提供了有关何时创建/销毁窗口子集的通知。它提供通知的唯一窗口是任务栏上显示的窗口。

由于我不喜欢侵入其他进程或编写 SetWindowHookEx 所需的本机代码，因此我尝试深入研究 .NET 4.0 中引入的 .NET 自动化 API，我认为这可以解决您的问题（在至少检测窗户何时打开/关闭）。

这是使用此 API 检测正在打开/关闭的窗口的代码片段：

```
 using System.Windows.Automation;

    private void StartMonitoringForWindowEvents()
    {
        Task.Factory.StartNew(() =>
        {
            AutomationEventHandler windowOpenedHandler = new AutomationEventHandler(OnWindowOpened);

            System.Windows.Automation.Automation.AddAutomationEventHandler(
                WindowPattern.WindowOpenedEvent, AutomationElement.RootElement, 
                TreeScope.Descendants, windowOpenedHandler);
        });
    }

    private void OnWindowOpened(object source, AutomationEventArgs eventArgs)
    {
        try
        {
            AutomationElement sourceElement = (AutomationElement)source;

            string message = string.Format(
                "Automation.WindowOpened PID: {0}, Handle: {1}, Name:{2}",
                sourceElement.Current.ProcessId,
                sourceElement.Current.NativeWindowHandle,
                sourceElement.Current.Name);

            Debug.WriteLine(message);

            // for each created window, register to watch for it being closed
            RegisterForClosedWindowEvent(sourceElement);
        }
        catch
        {
        }
    }

    private void RegisterForClosedWindowEvent(AutomationElement element)
    {
        try
        {
            string elementName = element.Current.Name;
            int processId = element.Current.ProcessId;
            int nativeHandle = element.Current.NativeWindowHandle;

            AutomationEventHandler windowClosedHandler = new AutomationEventHandler(
                (ignoreSource, ignoreArgs) => OnWindowClosed(nativeHandle, processId, elementName));

            System.Windows.Automation.Automation.AddAutomationEventHandler(
                WindowPattern.WindowClosedEvent, element,
                TreeScope.Element, windowClosedHandler);
        }
        catch
        {
        }
    }

    private void OnWindowClosed(int nativeHandle, int processId, string elementName)
    {
        string message = string.Format(
            "Automation.WindowClosed PID: {0}, Handle: {1}, Name:{2}",
            processId,
            nativeHandle,
            elementName);

        Debug.WriteLine(message);
    } 
```

您将需要添加对程序集“UIAutomationClient”和“UIAutomationClientTypes”的引用。

这是 MSDN 文档的链接（您可能特别想查看有关事件的信息）：http: [//msdn.microsoft.com/en-us/library/ms747327.aspx](http://msdn.microsoft.com/en-us/library/ms747327.aspx)

**重要实施说明：**

1.) 请注意，在示例中，我使用了一个任务工厂来注册接收自动化事件。在注册自动化事件或通常与自动化 API 交互时避免使用 UI 线程尤为重要。这样做会（而且通常很快）会导致死锁。因此，我使用任务工厂来确保通过线程池完成注册。

这也意味着，将在线程池上接收事件......因此，如果您需要执行任何 UI 更新，则必须将这些事件编组到 UI 线程。

2.) 您还会注意到，我*在注册时*（使用闭包）捕获了有关可能关闭的元素的任何所需信息。这是因为，一旦元素关闭，我们将无法再访问此信息——因为元素已被销毁。

菲尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T23:14:59.547

答案不是 C#（或 .Net）特定的。您需要调用 SetWindowsHookEx(WH_CBT, ...)。这将允许知道何时创建、销毁、移动、调整大小等窗口。您还需要从窗口获取相关信息，以确定您是否需要对其进行处理。可能是 GetClassInfo、GetWindowLong 和 GetWindowText。

SetWindowsHookEx 的问题在于，为了从每个窗口获取事件，您需要有一个单独的 win32 dll 并导出相关函数。尽管您可能会成功使用[此处](http://www.codeproject.com/KB/dotnet/DllExport.aspx)概述的过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T23:21:26.973

要扩展 Joel Lucsy 的答案，您需要使用 Win32 API。但是，有一个很好的库，即[Managed Windows API](http://mwinapi.sourceforge.net/)，它为通用 API 提供了一个面向对象的包装器。它可能有你需要的东西。

# windows-xp - windows xp上的libxml-ruby问题

> ID：783824
> 
> 赞同：2
> 
> 时间：2009-04-23T22:36:14.100
> 
> 标签：windows-xp, failed-installation, libxml-ruby

大约一个月前，我使用 gem install libxml-ruby 安装了 libxml-ruby，它运行良好。然后我今天去另一台机器上安装它，它失败了这个错误：

```
C:\Windows\system32>gem install -r libxml-ruby
Building native extensions.  This could take a while...
ERROR:  Error installing libxml-ruby:
        ERROR: Failed to build gem native extension.

c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.4/bin/rake RUBYARCHDIR=c:/ruby/lib/ruby/
gems/1.8/gems/libxml-ruby-1.1.3-x86-mswin32-60/lib RUBYLIBDIR=c:/ruby/lib/ruby/g
ems/1.8/gems/libxml-ruby-1.1.3-x86-mswin32-60/lib
'c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.4/bin/rake' is not recognized as an int
ernal or external command,
operable program or batch file.

Gem files will remain installed in c:/ruby/lib/ruby/gems/1.8/gems/libxml-ruby-1.
1.3-x86-mswin32-60 for inspection.
Results logged to c:/ruby/lib/ruby/gems/1.8/gems/libxml-ruby-1.1.3-x86-mswin32-6
0/ext/mingw/gem_make.out 
```

我已经安装了 rake 和 win32-api

然后，如果我之前真的在我的机器上安装了 libxml-ruby 并尝试卸载并重新安装它，我会感到困惑。它现在在我的机器上失败并显示相同的错误消息，并且我编写的一些用于解析 xml 的脚本不再有效。最近有其他人尝试在 Windows XP 上安装 libxml-ruby 吗？它似乎完全被打破了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T16:18:21.413

我遇到了同样的问题，最终找到了一个体面的解决方法。

看来错误是正确的

```
'c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.4/bin/rake' 
```

不是有效的可执行文件。它需要从根 ruby​​/bin 文件夹运行 rake，在该文件夹中可以找到包装批处理文件。

翻遍 ruby​​gems 代码，我发现 Gem::Ext::RakeBuilder 尝试使用

```
cmd = ENV['rake'] || Gem.bin_path('rake') rescue Gem.default_exec_format % 'rake' 
```

因此，在运行 gem install 之前简单地将 rake 环境变量设置为有效的值应该会有所帮助：

```
C:\>set rake=c:\ruby-1.8.6-26\bin\rake.bat

C:\>gem install libxml-ruby --no-rdoc --no-ri
Building native extensions.  This could take a while...
Successfully installed libxml-ruby-1.1.3-x86-mswin32-60
1 gem installed 
```

（我跳过了安装 rdoc 和 ri，因为它会打印出一堆格式警告，使得在此处粘贴结果更加困难。）

# delphi - 为什么大多数 Delphi 示例使用 FillChar() 来初始化记录？

> ID：783825
> 
> 赞同：31
> 
> 时间：2009-04-23T22:36:18.610
> 
> 标签：delphi, initialization, record

我只是想知道，为什么大多数 Delphi 示例使用 FillChar() 来初始化记录。

```
type
  TFoo = record
    i: Integer;
    s: string; // not safe in record, better use PChar instead
  end;

const
  EmptyFoo: TFoo = (i: 0; s: '');

procedure Test;
var
  Foo: TFoo;
  s2: string;
begin
  Foo := EmptyFoo; // initialize a record

  // Danger code starts
  FillChar(Foo, SizeOf(Foo), #0);
  s2 := Copy("Leak Test", 1, MaxInt); // The refcount of the string buffer = 1
  Foo.s = s2; // The refcount of s2 = 2
  FillChar(Foo, SizeOf(Foo), #0); // The refcount is expected to be 1, but it is still 2
end;
// After exiting the procedure, the string buffer still has 1 reference. This string buffer is regarded as a memory leak. 
```

这里 ( [http://stanleyxu2005.blogspot.com/2008/01/potential-memory-leak-by-initializing.html](http://stanleyxu2005.blogspot.com/2008/01/potential-memory-leak-by-initializing.html) ) 是我对这个主题的说明。IMO，声明一个具有默认值的常量是一种更好的方法。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-24T03:50:14.020

历史原因，主要是。FillChar() 可以追溯到 Turbo Pascal 时代并用于此类目的。这个名字确实有点用词不当，因为它虽然说 Fill **Char** ()，但实际上是 Fill **Byte** ()。原因是最后一个参数可以采用 char**或**一个字节。所以 FillChar(Foo, SizeOf(Foo), #0) 和 FillChar(Foo, SizeOf(Foo), 0) 是等价的。另一个令人困惑的地方是，从 Delphi 2009 开始，FillChar 仍然只填充字节，即使 Char 等效于 WideChar。在查看 FillChar 的最常见用途以确定大多数人是使用 FillChar 实际用字符数据填充内存还是仅使用它用给定的字节值初始化内存时，我们发现后一种情况主导了它的使用而不是前者。有了这个，我们决定让 FillChar 以字节为中心。

确实，如果没有在适当的上下文中使用，使用 FillChar 清除包含使用“托管”类型（字符串、变体、接口、动态数组）之一声明的字段的记录可能是不安全的。*但是，在您给出的示例中，只要是您对该范围内的记录所做的第一件事，就可以*在本地声明的记录变量上调用 FillChar 实际上是安全的。原因是编译器已经生成了代码来初始化记录中的字符串字段。这已经将字符串字段设置为 0 (nil)。调用 FillChar(Foo, SizeOf(Foo), 0) 只会用 0 个字节覆盖整个记录，包括已经为 0 的字符串字段。在记录变量**之后使用 FillChar**给字符串字段赋值，不推荐。使用初始化常量技术是解决此问题的一个很好的方法，因为编译器可以生成正确的代码，以确保在分配期间正确完成现有记录值。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-16T20:12:00.113

如果您有 Delphi 2009 及更高版本，请使用`Default`调用来初始化记录。

```
Foo := Default(TFoo); 
```

请参阅[大卫对](https://stackoverflow.com/a/11066205/576719)[如何在 Delphi 中一次正确释放包含各种类型的记录](https://stackoverflow.com/q/11065821/576719)的问题的回答？.

编辑：

使用`Default(TSomeType)`调用的好处是，记录在被清除之前就已经完成了。没有内存泄漏，也没有对 FillChar 或 ZeroMem 的显式危险低级调用。当记录很复杂时，可能包含嵌套记录等，就消除了出错的风险。

您可以使初始化记录的方法更加简单：

```
const EmptyFoo : TFoo = ();
...
Foo := EmptyFoo; // Initialize Foo 
```

有时您希望参数具有非默认值，然后执行以下操作：

```
const PresetFoo : TFoo = (s : 'Non-Default'); // Only s has a non-default value 
```

这将节省一些打字，并将重点放在重要的东西上。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-24T00:52:35.053

FillChar 可以确保您在**新的未初始化**结构（记录、缓冲区、数组...）中没有任何垃圾。
在不知道您正在重置什么的情况下，不应使用它来“重置”这些值。
不只是写作`MyObject := nil`并期望避免内存泄漏。
特别是所有托管类型都应仔细观察。
请参阅**完成**函数。

**当你有能力直接摆弄记忆时，总有办法让自己在脚下开枪。**

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-23T23:12:37.180

**FillChar**通常用于填充只有数字类型和数组的**数组**或**记录。****你是正确的，当记录中有****字符串**（或任何引用计数的变量）时，它不应该被使用。

 **尽管您建议使用**const**来初始化它会起作用，但是当我有一个要初始化 的*可变长度* **数组时，就会出现问题。**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-08-20T17:43:33.360

问题也可能在问：

*   为什么**填充字符**
*   而不是[**零内存**](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366920(v=vs.85).aspx)？

Windows中没有**ZeroMemory**功能。在头文件 ( `winbase.h`) 中，它是一个宏，在 C 世界中，它转身调用 memset：

```
memset(Destination, 0, Length); 
```

ZeroMemory 是*“您的平台可用于零内存的功能”的语言中性术语*

Delphi 等价于`memset`.`FillChar`

由于 Delphi 没有宏（并且在内联之前），调用**ZeroMemory意味着您必须在实际到达****FillChar**之前遭受额外函数调用的惩罚。

所以在很多方面，调用**FillChar是一种性能微优化 - 现在****ZeroMemory**内联后不再存在：

```
procedure ZeroMemory(Destination: Pointer; Length: NativeUInt); inline; 
```

# 奖金阅读

Windows 还包含[**SecureZeroMemory**](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366877(v=vs.85).aspx)函数。**它的作用与ZeroMemory**完全相同。**如果它与ZeroMemory**做同样的事情，为什么它存在？

因为一些聪明的 C/C++ 编译器可能会认识到`0`在摆脱内存之前将内存设置为浪费时间 - 并优化对**ZeroMemory**的调用。

我不认为 Delphi 的编译器和其他许多编译器一样聪明。所以不需要**SecureFillChar**。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-23T23:12:01.847

传统上，字符是单个字节（Delphi 2009 不再适用），因此使用带有 #0 的 fillchar 将初始化分配的内存，使其仅包含空值、字节 0 或 bin 00000000。

为了兼容性，您应该改用**ZeroMemory**函数，它与旧的 fillchar 具有相同的调用参数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-24T09:29:35.967

这个问题有一个更广泛的含义，多年来一直在我的脑海中。我也是，在使用 FillChar 记录时长大的。这很好，因为我们经常向（数据）记录添加新字段，当然 FillChar( Rec, SizeOf( Rec), #0 ) 会处理这些新字段。如果我们“正确地做”，我们必须遍历记录的所有字段，其中一些是枚举类型，其中一些可能是记录本身，如果我们不添加新代码，结果代码的可读性较差，也可能是错误的认真记录字段。字符串字段很常见，因此 FillChar 现在是禁忌。几个月前，我四处走动，将带有字符串字段的记录上的所有 FillChars 转换为迭代清除，但我对解决方案不满意，想知道是否有一种简洁的方法来完成“填充”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-12T18:33:19.073

这是一种不使用 FillChar 来初始化内容的更好方法：

[Record in record (无法初始化)](https://stackoverflow.com/questions/6667187/record-in-record-cannot-initialize)
[如何初始化静态数组？](https://stackoverflow.com/questions/6667907/how-to-initialize-a-static-array)

# porting - 跟踪主干或使用特定分支

> ID：783830
> 
> 赞同：0
> 
> 时间：2009-04-23T22:37:50.977
> 
> 标签：porting

我计划将 LLVM 移植到新的目标处理器。这是我第一次尝试对大型项目进行更改。这种事情的最佳做法是什么。

如果我坚持发布 2.5 版本，我就有一个基准来构建我的修改。但是，我可能会失去新功能和错误修复。如果我跟踪树干，它可能会产生问题，因为它是最前沿的。它可能会引入不稳定和/或错误。

例如，对于 GCC 的某些端口，它们倾向于在特定点分叉并从那里构建它们的修改。他们似乎没有合并回主线并独立发布他们的版本。而其他人则将他们的更改合并到主线中，但他们可能不会勤奋地维护它，这会导致它在未来的某个时候中断。

我正在寻找一些关于如何最好地进行的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T22:42:59.733

这是一个版本控制问题吗？

如果是这样.. 推荐的最佳实践是从已知点获取一个分支，然后定期将对主干所做的更改合并到您的分支中。完成后，您的分支很容易合并回主干（实际上，此时它应该与主干相同）。

如果主干正在接收前沿变化，那么它们应该自己变成一个分支。

如果您无法分支这些更改，那么您最好像以前一样定期将主干合并到您的分支，但是要小心合并的内容 - 不要担心拿走所有东西，您可以留一些东西留待以后使用（只是在进行最终合并时要小心，以确保您已将所有更改都带入 - 此时在主干和最终分支之间进行差异）。

# linq - LINQ to SQL 中的事务

> ID：783832
> 
> 赞同：2
> 
> 时间：2009-04-23T22:38:13.097
> 
> 标签：linq, transactions

我需要一些有关 Linq to sql 事务的帮助。以下是典型的交易布局。如果任何操作失败，则所有操作都将回滚。

```
mainTransaction (tScope)
     Operation 1 changes
     db.submitChanges()

     Operation 2 changes
     db.submitChanges()    
     ...

     catch(TransactionException ex)
         'rollback mainTransaction

     tScope.complete() 
```

但是，我希望有一个场景，操作 2**应该能够看到**操作 1 的更改，并且如果任何操作失败，则所有先前的操作都将回滚。

我可以想到 Linq to Sql 中的嵌套事务，但也许有更好的方法。我还没有尝试过嵌套事务方法。

```
mainTransaction
    childTransaction #1 
        child 1 changes

    childTransaction #2 changes
        should see child 1 changes
        child 2 changes

    childTransaction #3 changes
        should see child 1 changes
        should see child 2 changes
        child #3 changes

catch(TransactionException ex)
    'rollback child 1
    'rollback child 2
    ...
tScope.complete() 
```

*更新：假设我们有父母和孩子的关系。父级将引用子集合作为 parent.Childs EntitySet。在所有操作中，我传递父引用并将子 EntitySet 作为 parent.Childs 获取。我在 Childs Linq 表中添加子记录，而不是 Childs EntitySet。在 op# 1 之后，我执行 db.submitChanges()。对于 op# 2，即使在 db.SubmitChanges() 之后，我也没有在 parent.Childs EntitySet 中看到 op# 1 的插入记录——但是，我在 Child Linq 表中看到了。有任何想法吗？*

我想使用 Linq to Object 来做到这一点。Linq to Object 在后续操作中似乎没有“看到” InsertOnSubmit 记录（例如：如果我在子表中插入一条记录，则从父关系返回的 EntitySet 不会显示插入的记录）。

我能够在 Linq to SQL 中实现这一点，但代价是重新查询整个 Linq 表。我必须为每个操作编写重复的代码。

有任何想法吗？如果您能想到更简单的方法，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-27T20:48:46.957

如果每个父表的数据大小足够易于管理，我使用一个列表（linqToSqlRowType）来跟踪人口和添加的新行。所以我在列表中查询了尚未提交更改的子操作。

同样在 Linq to sql 中也可能是 linq to objects，您可以将外键行字段设置为尚未提交的行，它会自动处理任何身份字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T01:45:08.240

很晚了，但我想回答这个问题。

**选项 1**：使用`TransactionScope`. 我不喜欢这个。

```
// if an exception is thrown, ts.Complete() is not called causing rollback
using (TransactionScope ts = new TransactionScope())
{
    // operation 1 changes //
    var items = db.Items.ToList();
    var itemToFind = items.Where(somePredicate);
    db.Items.InsertOnSubmit(item1);
    db.Items.InsertOnSubmit(item2);
    db.SubmitChanges();

    // operation 2 changes //
    // re-query the table(s) again
    var items = db.Items.ToList();
    var itemToFind = items.Where(somePredicate);
    db.Items.InsertOnSubmit(item3);
    db.SubmitChanges()

    ts.Complete();
} 
```

**选项 2**：查看' `context.GetChangeSet()`s`Inserts`或.`Updates``Deletes`

```
// operation 1 changes //
var items = db.Items.ToList();
var itemToFind = items.Where(somePredicate);
db.Items.InsertOnSubmit(item1);
db.Items.InsertOnSubmit(item2);
// do not submit changes here

// operation 2 changes //
// look in the ChangeSet
var itemToFind = items.Where(somePredicate);
if (itemToFind = null)
    itemToFind = db.GetChangeSet().Inserts.OfType<Item>().Where(somePredicate);
db.Items.InsertOnSubmit(item3);
db.SubmitChanges()    

// submit changes when all done
db.SubmitChanges(); 
```

**选项 3**：维护一个单独的列表并查看它（类似于选项 2）。

```
// operation 1 changes //
var items = db.Items.ToList();
var itemToFind = items.Where(somePredicate);
db.Items.InsertOnSubmit(item1);
db.Items.InsertOnSubmit(item2);
customList.Add(item1);
customList.Add(item2);
// do not submit changes here

// operation 2 changes //
// look in the ChangeSet
var itemToFind = items.Where(somePredicate);
if (itemToFind = null)
    itemToFind = customList.Where(somePredicate);
db.Items.InsertOnSubmit(item3);
db.SubmitChanges()    

// submit changes when all done
db.SubmitChanges(); 
```

我根据情况使用了选项 2 和 3，但回避了选项 1。

# iphone - Paypal API SetMobileCheckout 的 Soap xml（滚动我自己的 Objective-C 请求）

> ID：783834
> 
> 赞同：-1
> 
> 时间：2009-04-23T22:38:58.993
> 
> 标签：iphone, objective-c, xml, soap, paypal

我在这里有通用结构：

```
 <?xml version=”1.0” encoding=”UTF-8”?> 
<SOAP-ENV:Envelope xmlns:xsi= ”  http://www.w3.org/2001/XMLSchema-instance” 
    xmlns:SOAP-ENC=”http://schemas.xmlsoap.org/soap/encoding/” 
    xmlns:SOAP-ENV=”http://schemas.xmlsoap.org/soap/envelope/” 
    xmlns:xsd=”http://www.w3.org/2001/XMLSchema”   
    SOAP-ENV:encodingStyle=”http://schemas.xmlsoap.org/soap/encoding/” 
><SOAP-ENV:Header> 
    <RequesterCredentials xmlns=”urn:ebay:api:PayPalAPI”&gt; 
        <Credentials xmlns=”urn:ebay:apis:eBLBaseComponents”&gt; 
            <Username>api_username</Username> 
            <Password>api_password</Password> 
            <Signature/>     
            <Subject/> 
        </Credentials> 
    </RequesterCredentials> 
</SOAP-ENV:Header> 
<SOAP-ENV:Body> 
    <specific_api_name_Req xmlns=”urn:ebay:api:PayPalAPI”&gt; 
        <specific_api_name_Request> 
            <Version xmlns=urn:ebay:apis:eBLBaseComponents”&gt;service_version 
            </Version> 
            <required_or_optional_fields xsi:type=”some_type_here”&gt;                data 
            </required_or_optional_fields> 
        </specific_api_name_Request> 
    </specific_api_name_Req> 
</SOAP-ENV:Body> 
</SOAP-ENV:Envelope> 
```

我需要的具体调用（SetMobileCheckout 和 DoMobileCheckoutPayment）在[这里](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_MobileCheckout.pdf)

我正在路上。但是我在objective-c中滚动我自己的xml请求，我试图确保我做对了。

有没有人有一个真实请求的实际例子？

如果它被包裹在 Objective-C 中，那么它会得到奖励，但只是裸 xml 会很棒。

谢谢，科里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T23:47:16.450

我最终解决了这个问题。

您可以在 HTTP POST 中使用 NVP。这在 iPhone 上要容易得多。不知道为什么我的 SOAP 响应一直被拒绝，但是继续下去太费时间了。

在寻找我的答案时，我确实遇到了 gSoap，这可能对其他人有所帮助。我只需要提出 2 个请求，所以我不想沉浸在依赖那个框架中。

我也遇到了[wsdl2objC](http://code.google.com/p/wsdl2objc/)，不幸的是，它现在不能在 iPhone 上运行（数据类型问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T04:01:27.717

这是一个使用 NVP 的 HTTP POST 请求的链接：

[有没有人通过原生 iPhone 应用程序实现了 PayPal API？](https://stackoverflow.com/questions/779423/has-anyone-implemented-the-paypal-api-through-a-native-iphone-app/850940#850940)

# backup - MSDE 备份文件正在附加

> ID：783838
> 
> 赞同：0
> 
> 时间：2009-04-23T22:39:49.007
> 
> 标签：backup, msde

我有一个 MSDE 2000 数据库备份文件，它正在追加而不是删除或重命名。我正在使用这个命令：BACKUP DATABASE [SPSDB] TO DISK = 'E:\Program Files\Microsoft SQL Server\MSSQL\BACKUP\SPSbackup\spsdb.bak' with retaindays = 1

我在我的完整 SQL 版本数据库上使用维护计划，他们每天都会创建一个新文件，文件名中包含日期。

如果我不监控它，备份文件的大小会逐渐增加。有没有办法让 MSDE 用我创建的每日备份作业制作一个 uniue 文件？

谢谢，乍得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-30T14:10:34.543

查看[http://msdn.microsoft.com/en-us/library/ms186865.aspx](http://msdn.microsoft.com/en-us/library/ms186865.aspx)的`BACKUP`命令。您是否尝试使用`INIT`选项？

我注意到这个问题很老了，但也许我的回答可以帮助别人。

# performance - 升级后的 IIS5、6 和 7 速度问题

> ID：783847
> 
> 赞同：0
> 
> 时间：2009-04-23T22:42:39.577
> 
> 标签：performance, iis-7, iis-6, iis-5

我会提前道歉，因为这篇文章是出于严重的挫败感而诞生的。

我有一个在 Windows 2000/IIS5 上运行多年的经典 ASP 网站，以及我们最近开始在相同服务器上运行的另一个 ASP.NET 2.0 网站。到目前为止，一切运行良好。

去年，我尝试升级（全新安装）到 Windows 2003/IIS6。经典的 ASP 网站要慢得多，根据使用数周的平均日志/统计数据，慢了大约 50%。我想尽一切办法找出慢的地方。网络调整。融合的。经典的 iis5 模式。进行中。进程外。没有什么比这更好的了，我很快又回到了 IIS5/2000。那天倒退了，性能又回到了原来的位置。这发生在不止一台服务器上。最终，我放弃了，把它归结为 2003 年的某种 TCP 问题。

我最近在一台类似但功能更强大的机器上安装了一个 Windows 2008/IIS 服务器，希望情况会更好。令我高兴的是，我的 ASP 经典应用程序在 Windows 2008 下速度更快。不幸的是，我的 ASP.NET 应用程序现在明显慢了 50-75%。所有它的内容加载。它与 2000 机器在同一个网络上。该站点是直接从另一台机器复制的，它是来自 studio 2005 的预编译 Web 应用程序。

虽然该页面确实会访问数据库和另一台服务器以获取初始数据，但它会从那里缓存一段时间，它还使用与经典站点相同的数据库服务器，速度很快，所以我知道这不一定是连接问题。

我试过默认的应用程序池和经典的 .NET 池没有区别。已更新。/检查所有常用位置的最大线程数、每个 cpu 的最大数、web garen 或没有似乎无关紧要。我已经仔细检查了编译 debug=false 仍然在 web.config 中设置。

为了快速进行基准测试，我使用 ab.exe (Apache Bench) 发送 10 个请求，一次发送 1 个。即使我使用 IE 或 Firefox 访问该站点，它也明显比 2000 以下慢，即使根据 firebug 也是如此。

在这一点上，我很沮丧，完全不知道从哪里开始。有没有人经历过这种混乱？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T19:07:53.600

速度取决于许多因素。您确实需要仅在服务器上测量性能，以了解这是否是服务器问题。在 Web 配置中为您的网站启用跟踪，并查看哪个部分/功能减慢了它的速度。您可以在每次操作后添加自己的跟踪，以查看哪个代码块最慢。我敢肯定，一旦页面的哪个部分最慢，您就会发现可以改进/优化的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T01:27:40.687

就我而言，答案很简单，我启动了 WireShark。有 1 个外部资源请求无法解决，因为测试机器无法像现场机器那样直接访问互联网。

总是小事。

# seo - 添加规范标签的有效方法

> ID：783849
> 
> 赞同：0
> 
> 时间：2009-04-23T22:42:55.910
> 
> 标签：seo

如果 Canonical 标签的 href 值是通过 javascript 函数填充的，那会影响搜索引擎索引（因为搜索引擎会忽略 javascript）吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T23:27:23.697

我不确定我是否完全理解你所说的问题。但这是我的看法：

规范标签用于确保 Google（等）知道具有不同 URL 的同一页面实际上是同一页面。

这为 Google 节省了大量的处理时间，因为它会将这些页面视为单个页面，而不是尝试对每个页面进行索引。此外，您的域的搜索引擎排名可能会上升，因为 Google 不认为您在复制内容。

对于任何可能因参数而重复的页面，您应该包含一个您想要称为原始页面的规范链接。所以是的，这对你的情况会有所帮助。尽管您不能将规范链接放在指向您的域的其他人的域上，但将其放在合作伙伴的页面上不会产生预期的后果。

如果您想了解更多信息，请在此处阅读：[Google 网站管理员中心：指定您的规范](http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html)

# sql - 我可以在 'insert ... on duplicate update ...' 语句中重用绑定变量吗？

> ID：783857
> 
> 赞同：4
> 
> 时间：2009-04-23T22:44:51.350
> 
> 标签：sql, mysql

我正在尝试对 mysql 数据库引擎运行使用绑定变量的查询。我想知道如何告诉引擎“重置”绑定变量分配。我相信一个例子会比我可怜的大脑解释得更好。

这是查询：

```
INSERT INTO site_support_docs
      (
          ASSET_ID,
          TIME_STAMP,
          SITE_NAME,
          DOCUMENT_NAME,
          DOCUMENT_LOCATION,
          DOCUMENT_CONTENT,
          DOCUMENT_LAST_MODIFIED
      )
VALUES (?, ?, ?, ?, ?, ?, STR_TO_DATE(?, '%M %e, %Y %r'))
ON DUPLICATE KEY UPDATE asset_id   = ?,
                        time_stamp   = ?,
                        site_name   = ?,
                        document_name   = ?,
                        document_location   = ?,
                        document_content   = ?,
                        document_last_modified   =
                           STR_TO_DATE(?, '%M %e, %Y %r') 
```

我的问题是第八个“？” 当只有七个时被解释为一个新的绑定变量。无论如何，我想我可以恢复使用实际值......但是，我确信有更好的方法。马特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-24T14:58:22.587

MySQL 提供了一个“VALUES()”函数，该函数提供了在不存在重复键冲突的情况下将被插入的值。您不需要重复占位符。

在重复键更新时插入 t 值 (?) x = VALUES(x);

[http://dev.mysql.com/doc/refman/5.0/en/miscellaneous-functions.html#function_values](http://dev.mysql.com/doc/refman/5.0/en/miscellaneous-functions.html#function_values)

# php - _函数名中的下划线

> ID：783858
> 
> 赞同：23
> 
> 时间：2009-04-23T22:45:02.583
> 
> 标签：php, javascript, oop, naming-conventions, history

在许多具有简单 OO 功能（PHP 4）或被误解的 OO 功能（Javascript、使用函数指针的 C 等）的语言中，您最终会得到一个函数命名约定，该约定使用前导下划线来指示特权级别。

```
//ex.
function _myPrivateFunction(){
} 
```

虽然各个团队总是会提出自己的这样的命名约定，但下划线约定似乎如此普遍，以至于让我很好奇

1.  技术最初来自哪里
2.  如果有围绕公约开发的任何标准化系统（有点像匈牙利符号）

除了纯粹的好奇之外，我在我现在正在处理的几个代码库中看到了这一点，我想了解最初提出它的开发人员可能的顶空。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-23T22:49:07.347

在 C++ 世界中，以下划线开头的成员名称保留给编译器（或低级 STL，如 API）开发人员使用。编译器并没有以任何方式禁止它，但这是传统。

这个 wiki 链接在[下划线](http://en.wikipedia.org/wiki/Underscore)方面提供了很多信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T22:50:16.347

我不能告诉你这个约定的起源。我的猜测是，由于下划线是大多数编程语言中标识符中唯一允许的非字母数字字符，因此选择它作为私有成员的前缀是很自然的。

在 Python 中，使用下划线作为前缀不仅仅是一种约定：从模块中导入“所有内容”时，默认情况下不会导入以下划线开头的符号，因此下划线表示“私有”/“内部使用”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T09:38:17.443

下划线 (_) 代表私有/受保护函数或变量。

不知道谁真的想出了它，但我知道它是由 Zend（和 Zend 编码标准）“支持”的。

编辑： http: [//framework.zend.com/manual/en/coding-standard.naming-conventions.html](http://framework.zend.com/manual/en/coding-standard.naming-conventions.html)

-> B.3.4 节 -> 第 2 段

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T09:46:42.820

我已经看到下划线被用作私有函数，我已经看到下划线被用作全局函数。下划线也用于表示 PHP 本身内的全局变量。

```
$_POST $_GET $_SESSION etc.. 
```

这只是一个命名约定，所以我会问作者，如果他在附近。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T22:46:45.277

我在编写 C++ 时第一次看到它。通常使用“m_”前缀标记成员变量。

当我编写 Java 时，我宁愿不使用任何这些。我使用“this”明确成员变量。

# c++ - 标准::地图 > 分配失败

> ID：783864
> 
> 赞同：1
> 
> 时间：2009-04-23T22:46:58.973
> 
> 标签：c++, stl

基本上我有（州，州代码）对，它们是国家 [USA] -> [VT] -> 32 的子集

所以我正在使用`std::map<tstring<std::map<tstring, unsigned int>>`，但我在分配状态代码时遇到问题

```
for(std::map<tstring, std::map<tstring, unsigned int>>::const_iterator it = countrylist.begin(); it != countrylist.end(); ++it) 
{
foundCountry = !it->first.compare(_T("USA")); //find USA 
if(foundCountry) it->second[_T("MN")] = 5; //Assignment fails
} 
```

`error C2678: binary '[' : no operator found which takes a left-hand operand of type 'const std::map<_Kty,_Ty>'`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T22:54:04.917

std::map 上的 operator[] 是非常量的，因为如果条目不存在，它会创建条目。所以你不能以这种方式使用 const_iterator 。您可以在 const 映射上使用 find()，但这仍然不允许您修改它们的值。

Smashery 是对的，考虑到你有一张地图，你正在以一种奇怪的方式进行第一次查找。既然你明确地修改了这个东西，这有什么问题？

```
countryList[_T("USA")][_T("MN")] = 5; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T22:53:23.967

如果您想在地图中查找元素，可以使用 find 方法：

```
std::map<tstring, std::map<tstring, unsigned int>::iterator itFind;
itFind = countrylist.find(_T("USA"));
if (itFind != countrylist.end())
{
    // Do what you want with the item you found
    it->second[_T("MN")] = 5;
} 
```

此外，您需要使用迭代器，而不是 const_iterator。如果使用 const_iterator，则无法修改映射，因为：它是 const！

# printing - 如何在 .NET 中访问打印机特定字体？

> ID：783873
> 
> 赞同：0
> 
> 时间：2009-04-23T22:49:31.230
> 
> 标签：printing, fonts, pinvoke

这个问题与[Retrieving Device Context from .NET print API](https://stackoverflow.com/questions/684900/retrieving-device-context-from-net-print-api) ...

我有一个 Datacard 295 压花机/磁条编码器。为了写入 Mag Stripe 或 Embosser 轮，您必须以特殊的“伪字体”书写文本，打印机驱动程序将识别并正确处理该字体。有多种字体，具体取决于您是要写入磁道 1、磁道 2、大浮雕字母还是小。

不幸的是，.NET 只直接支持 OpenType 和 TrueType 字体。

与我提到的问题不同，我没有技术指南来告诉我要传输什么。对我来说，处理这个问题的最简单方法是找到一种方法来使用 .NET 中的打印机字体，无论需要什么。如何在 .NET 中访问和使用打印机字体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-10-14T01:06:16.117

您不能直接从 .NET 执行此操作，因此您必须在设备上下文中使用 Win32 调用来使用“伪字体”进行渲染。[此处](http://www.eggheadcafe.com/community/aspnet/14/29563/accessing-printer-font-from--net.aspx)提供的示例代码显示了如何执行此操作：

```
' As we're using a device font, we need to write directly on the device context
' as the System.Drawing.Font class which is used to write on a graphics object
' does not support device fonts
Dim hdcLabel As IntPtr
hdcLabel = e.Graphics.GetHdc

' Create the new device font
Dim hfEPC As IntPtr
hfEPC = WinAPI.GDI32.CreateFont(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, "Track1")

' Select the font on the device context, getting a handle on the font that is being replaced
Dim hReplacedFont As IntPtr
hReplacedFont = WinAPI.GDI32.SelectObject(hdcLabel, hfEPC)

' Draw the text using the printer font
Dim intDrawTextReturn As Integer
intDrawTextReturn = WinAPI.User32.DrawText(hdcLabel, "Track 1 Data", ("Track 1 Data").Length, New Rectangle(20, 20, 300, 300), 0)

' Re-Select the original font on the device context
WinAPI.GDI32.SelectObject(hdcLabel, hReplacedFont)

' Dispose of the EPC font
WinAPI.GDI32.DeleteObject(hfEPC)

' Release the device context
e.Graphics.ReleaseHdc(hdcLabel) 
```

# .net - 如何将资源添加到现有的签名程序集

> ID：783885
> 
> 赞同：3
> 
> 时间：2009-04-23T22:52:03.160
> 
> 标签：.net, resources, assemblies

给定： - 一个程序集（例如“SomeLib.dll”） - 一个文本文件（例如“myconfig.xml”）

我需要将文件 myconfig.xml 嵌入到现有程序集 SomeLib.dll

请在按下“答案”之前考虑一下：我知道编译期间嵌入的资源（csc.exe .. /embedresource:file ...）。

问题是我需要在创建程序集**后**嵌入资源。

可能吗？

我也知道ILMerge。但是还没有找到它如何提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-30T15:03:40.460

您可以为此使用[Cecil ：加载程序集、添加资源、保存到程序集。](http://www.mono-project.com/Cecil)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T00:07:43.180

添加资源后，您需要退出程序集。程序集签名的全部目的是防止人们修改程序集的内容而无法知道它已被修改。您可以在添加资源后使用signcode.exe、 http: [//msdn.microsoft.com/en-us/library/9sh96ycy](http://msdn.microsoft.com/en-us/library/9sh96ycy(VS.80).aspx) (VS.80).aspx 对程序集进行签名，前提是您拥有适当的证书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T15:19:21.000

程序集[链接器工具](http://msdn.microsoft.com/en-us/library/c405shex.aspx)可用于将模块和资源组合成一个签名程序集。但是，我还没有找到使用现有程序集作为输入的方法。

```
> al.exe SomeLib.module /out:SomeLib.dll /keyfile:SomeLib.snk /embed:myconfig.xml 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T18:12:19.917

您也许可以使用[Resource Hacker](http://www.angusj.com/resourcehacker/)从命令行自动修改程序集（他们的教程包括如何自动化的示例）。修改后，您只需退出程序集即可。

# python - 如何截断浮点值？

> ID：783897
> 
> 赞同：137
> 
> 时间：2009-04-23T22:56:44.380
> 
> 标签：python, floating-point

我想从浮点数中删除数字以在点后具有固定位数，例如：

```
1.923328437452 → 1.923 
```

我需要作为字符串输出到另一个函数，而不是打印。

我也想忽略丢失的数字，而不是四舍五入。

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2009-04-23T22:59:15.607

```
round(1.923328437452, 3) 
```

请参阅[Python 关于标准类型的文档](http://docs.python.org/library/stdtypes.html#numeric-types-int-float-long-complex)。您需要向下滚动一点才能进入圆形功能。本质上，第二个数字表示将其四舍五入到小数位数。

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2009-04-23T23:10:44.877

首先，功能，对于那些只想要一些复制和粘贴代码的人：

```
def truncate(f, n):
    '''Truncates/pads a float f to n decimal places without rounding'''
    s = '{}'.format(f)
    if 'e' in s or 'E' in s:
        return '{0:.{1}f}'.format(f, n)
    i, p, d = s.partition('.')
    return '.'.join([i, (d+'0'*n)[:n]]) 
```

这在 Python 2.7 和 3.1+ 中有效。对于旧版本，不可能获得相同的“智能舍入”效果（至少，不是没有很多复杂的代码），但在截断之前舍入到小数点后 12 位将在很多时候起作用：

```
def truncate(f, n):
    '''Truncates/pads a float f to n decimal places without rounding'''
    s = '%.12f' % f
    i, p, d = s.partition('.')
    return '.'.join([i, (d+'0'*n)[:n]]) 
```

# 解释

底层方法的核心是以全精度将值转换为字符串，然后将超出所需字符数的所有内容切掉。后一步很容易；它可以通过字符串操作来完成

```
i, p, d = s.partition('.')
'.'.join([i, (d+'0'*n)[:n]]) 
```

或`decimal`模块

```
str(Decimal(s).quantize(Decimal((0, (1,), -n)), rounding=ROUND_DOWN)) 
```

第一步，转换为字符串，非常困难，因为有一些浮点文字对（即您在源代码中编写的）都产生相同的二进制表示，但应该以不同的方式截断。例如，考虑 0.3 和 0.29999999999999998。如果您`0.3`在 Python 程序中编写，编译器会使用 IEEE 浮点格式将其编码为位序列（假设为 64 位浮点数）

```
0011111111010011001100110011001100110011001100110011001100110011 
```

这是最接近 0.3 的值，可以准确地表示为 IEEE 浮点数。但是如果你用`0.29999999999999998`Python 程序编写，编译器会将它翻译成*完全相同的 value*。在一种情况下，您的意思是将其截断（一位数）为`0.3`，而在另一种情况下，您的意思是将其截断为`0.2`，但 Python 只能给出一个答案。这是 Python 或任何没有惰性求值的编程语言的基本限制。截断函数只能访问存储在计算机内存中的二进制值，而不是您实际输入到源代码中的字符串。¹

如果您将位序列解码回十进制数，再次使用 IEEE 64 位浮点格式，您会得到

```
0.2999999999999999888977697537484345957637... 
```

`0.2`所以即使这可能不是您想要的，也会提出一个幼稚的实现。有关浮点表示错误的更多信息，[请参阅 Python 教程](https://docs.python.org/3/tutorial/floatingpoint.html)。

*使用非常接近整数但故意*不等于该整数的浮点值是非常罕见的。因此，在截断时，从所有可能对应于内存值的十进制表示中选择“最好的”十进制表示可能是有意义的。Python 2.7 及更高版本（但不是 3.0）包含一个[复杂的算法来做到这一点](https://bugs.python.org/issue1580)，我们可以通过默认的字符串格式化操作来访问它。

```
'{}'.format(f) 
```

唯一需要注意的是，这就像一个`g`格式规范，从某种意义上说，`1.23e+4`如果数字足够大或足够小，它就会使用指数符号 ( )。所以该方法必须抓住这种情况并以不同的方式处理它。在某些情况下，使用`f`格式规范会导致问题，例如尝试截断`3e-10`到 28 位精度（它会产生`0.0000000002999999999999999980`），我还不确定如何最好地处理这些问题。

如果您实际上*正在*使用`float`非常接近整数但故意不等于它们的 s（如 0.29999999999999998 或 99.959999999999994），这将产生一些误报，即它会舍入您不希望四舍五入的数字。在这种情况下，解决方案是指定一个固定的精度。

```
'{0:.{1}f}'.format(f, sys.float_info.dig + n + 2) 
```

此处使用的精度位数并不重要，它只需要足够大以确保在字符串转换中执行的任何舍入都不会将值“碰撞”到其漂亮的十进制表示。我认为`sys.float_info.dig + n + 2`在所有情况下可能就足够了，但如果不是，`2`可能必须增加，这样做并没有什么坏处。

在 Python 的早期版本（最高 2.6 或 3.0）中，浮点数格式要粗糙得多，并且会经常产生类似

```
>>> 1.1
1.1000000000000001 
```

如果这是您的情况，如果您*确实*想使用“不错的”十进制表示进行截断，那么您所能做的（据我所知）就是选择一些位数，小于 a 可表示的完整精度`float`，然后将在截断之前将其编号为那么多位数。一个典型的选择是 12，

```
'%.12f' % f 
```

但您可以调整它以适合您使用的数字。

* * *

¹嗯……我撒谎了。从技术上讲，您*可以*指示 Python 重新解析其自己的源代码并提取与您传递给截断函数的第一个参数相对应的部分。如果该参数是浮点文字，您可以将其从小数点后的一定数量的位置中删除并返回。但是，如果参数是变量，则此策略不起作用，这使得它相当无用。以下内容仅供娱乐：

```
def trunc_introspect(f, n):
    '''Truncates/pads the float f to n decimal places by looking at the caller's source code'''
    current_frame = None
    caller_frame = None
    s = inspect.stack()
    try:
        current_frame = s[0]
        caller_frame = s[1]
        gen = tokenize.tokenize(io.BytesIO(caller_frame[4][caller_frame[5]].encode('utf-8')).readline)
        for token_type, token_string, _, _, _ in gen:
            if token_type == tokenize.NAME and token_string == current_frame[3]:
                next(gen) # left parenthesis
                token_type, token_string, _, _, _ = next(gen) # float literal
                if token_type == tokenize.NUMBER:
                    try:
                        cut_point = token_string.index('.') + n + 1
                    except ValueError: # no decimal in string
                        return token_string + '.' + '0' * n
                    else:
                        if len(token_string) < cut_point:
                            token_string += '0' * (cut_point - len(token_string))
                        return token_string[:cut_point]
                else:
                    raise ValueError('Unable to find floating-point literal (this probably means you called {} with a variable)'.format(current_frame[3]))
                break
    finally:
        del s, current_frame, caller_frame 
```

将其概括为处理传入变量的情况似乎是一个失败的原因，因为您必须向后追溯程序的执行，直到找到赋予变量其值的浮点文字。如果有的话。大多数变量将从用户输入或数学表达式中初始化，在这种情况下，二进制表示就是全部。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-04-23T23:04:46.653

的结果`round`是一个浮点数，所以要小心（示例来自 Python 2.6）：

```
>>> round(1.923328437452, 3)
1.923
>>> round(1.23456, 3)
1.2350000000000001 
```

使用格式化字符串会更好：

```
>>> "%.3f" % 1.923328437452
'1.923'
>>> "%.3f" % 1.23456
'1.235' 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2010-11-14T06:58:32.930

```
n = 1.923328437452
str(n)[:4] 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2017-02-01T21:10:52.683

在我的 Python 2.7 提示符下：

`>>> int(1.923328437452 * 1000)/1000.0 1.923`

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-05-28T16:43:49.513

真正的pythonic方式是

```
from decimal import *

with localcontext() as ctx:
    ctx.rounding = ROUND_DOWN
    print Decimal('1.923328437452').quantize(Decimal('0.001')) 
```

或更短：

```
from decimal import Decimal as D, ROUND_DOWN

D('1.923328437452').quantize(D('0.001'), rounding=ROUND_DOWN) 
```

**更新**

通常问题不在于截断浮点数本身，而在于舍入*之前*对浮点数的不当使用。

例如：`int(0.7*3*100)/100 == 2.09`。

如果您*被迫*使用浮点数（例如，您正在使用 加速代码`numba`），最好使用美分作为价格的“内部表示”： ( `70*3 == 210`) 并乘/除输入/输出。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2016-01-10T15:49:15.827

简单的python脚本 -

```
n = 1.923328437452
n = float(int(n * 1000))
n /=1000 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-04-24T05:46:03.820

```
def trunc(num, digits):
   sp = str(num).split('.')
   return '.'.join([sp[0], sp[1][:digits]]) 
```

这应该有效。它应该给你你正在寻找的截断。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2015-02-04T14:26:37.100

针对这个问题给出的许多答案都是完全错误的。它们要么舍入浮点数（而不是截断），要么不适用于所有情况。

这是我搜索“Python truncate float”时的最高 Google 结果，这个概念非常简单，值得得到更好的答案。我同意 Hatchkins 的观点，即使用`decimal`模块是 python 的方式，所以我在这里给出一个我认为正确回答问题的函数，并且在所有情况下都可以正常工作。

作为旁注，通常小数值不能用二进制浮点变量精确表示（有关此问题的讨论，请参见[此处](https://stackoverflow.com/questions/1089018/why-cant-decimal-numbers-be-represented-exactly-in-binary)），这就是我的函数返回字符串的原因。

```
from decimal import Decimal, localcontext, ROUND_DOWN

def truncate(number, places):
    if not isinstance(places, int):
        raise ValueError("Decimal places must be an integer.")
    if places < 1:
        raise ValueError("Decimal places must be at least 1.")
    # If you want to truncate to 0 decimal places, just do int(number).

    with localcontext() as context:
        context.rounding = ROUND_DOWN
        exponent = Decimal(str(10 ** - places))
        return Decimal(str(number)).quantize(exponent).to_eng_string() 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-03-30T19:13:49.080

```
>>> from math import floor
>>> floor((1.23658945) * 10**4) / 10**4
1.2365 
```

#*除并乘以 10**所需位数*

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-09-06T16:42:11.000

我做了这样的事情：

```
from math import trunc

def truncate(number, decimals=0):
    if decimals < 0:
        raise ValueError('truncate received an invalid value of decimals ({})'.format(decimals))
    elif decimals == 0:
        return trunc(number)
    else:
        factor = float(10**decimals)
        return trunc(number*factor)/factor 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-03-25T04:47:01.603

你可以做：

```
def truncate(f, n):
    return math.floor(f * 10 ** n) / 10 ** n 
```

测试：

```
>>> f=1.923328437452
>>> [truncate(f, n) for n in range(5)]
[1.0, 1.9, 1.92, 1.923, 1.9233] 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-03-08T21:54:38.227

如果你喜欢一些数学，这适用于 +ve 数字：

```
>>> v = 1.923328437452
>>> v - v % 1e-3
1.923 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2010-07-22T05:46:38.640

只是想提一下旧的“make round() with floor()”技巧

```
round(f) = floor(f+0.5) 
```

可以转身从 round() 制作 floor()

```
floor(f) = round(f-0.5) 
```

尽管这两个规则都打破了负数，但使用它并不理想：

```
def trunc(f, n):
    if f > 0:
        return "%.*f" % (n, (f - 0.5*10**-n))
    elif f == 0:
        return "%.*f" % (n, f)
    elif f < 0:
        return "%.*f" % (n, (f + 0.5*10**-n)) 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-06-24T16:26:58.843

```
def precision(value, precision):
    """
    param: value: takes a float
    param: precision: int, number of decimal places
    returns a float
    """
    x = 10.0**precision
    num = int(value * x)/ x
    return num
precision(1.923328437452, 3) 
```

> > 1.923

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2019-03-20T13:46:05.217

简短易行的变体

```
def truncate_float(value, digits_after_point=2):
    pow_10 = 10 ** digits_after_point
    return (float(int(value * pow_10))) / pow_10

>>> truncate_float(1.14333, 2)
>>> 1.14

>>> truncate_float(1.14777, 2)
>>> 1.14

>>> truncate_float(1.14777, 4)
>>> 1.1477 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2019-08-07T19:16:01.930

使用 pandas df 时，这对我有用

```
import math
def truncate(number, digits) -> float:
    stepper = 10.0 ** digits
    return math.trunc(stepper * number) / stepper

df['trunc'] = df['float_val'].apply(lambda x: truncate(x,1))
df['trunc']=df['trunc'].map('{:.1f}'.format) 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2010-07-22T02:12:26.913

```
def trunc(f,n):
  return ('%.16f' % f)[:(n-16)] 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-10-20T23:52:03.307

诠释（16.5）；这将给出一个整数值 16，即 trunc，将无法指定小数，但猜你可以通过

```
import math;

def trunc(invalue, digits):
    return int(invalue*math.pow(10,digits))/math.pow(10,digits); 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2014-11-28T13:19:53.777

这是一个简单的方法：

```
def truncate(num, res=3):
    return (floor(num*pow(10, res)+0.5))/pow(10, res) 
```

对于 num = 1.923328437452，输出 1.923

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2016-11-07T17:16:07.897

一个通用且简单的函数：

```
def truncate_float(number, length):
    """Truncate float numbers, up to the number specified
    in length that must be an integer"""

    number = number * pow(10, length)
    number = int(number)
    number = float(number)
    number /= pow(10, length)
    return number 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2018-06-07T14:14:18.643

在 python 3 中有一个简单的解决方法。我使用帮助变量 decPlace 定义了剪切位置，以使其易于适应。

```
f = 1.12345
decPlace= 4
f_cut = int(f * 10**decPlace) /10**decPlace 
```

输出：

```
f = 1.1234 
```

希望能帮助到你。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2019-04-21T02:12:49.840

在我看来，大多数答案都太复杂了，这个怎么样？

```
digits = 2  # Specify how many digits you want

fnum = '122.485221'
truncated_float = float(fnum[:fnum.find('.') + digits + 1])

>>> 122.48 
```

只需扫描“。”的索引。并根据需要截断（无舍入）。将字符串转换为浮点数作为最后一步。

或者在您的情况下，如果您将浮点数作为输入并希望将字符串作为输出：

```
fnum = str(122.485221)  # convert float to string first
truncated_float = fnum[:fnum.find('.') + digits + 1]  # string output 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-04-11T06:02:06.780

使用 numpy.round

```
import numpy as np
precision = 3
floats = [1.123123123, 2.321321321321]
new_float = np.round(floats, precision) 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-07-04T11:14:18.133

一些简单到适合列表理解的东西，没有库或其他外部依赖项。对于 Python >=3.6，使用 f 字符串编写非常简单。

这个想法是让字符串转换将舍入*到比您需要的多一个位置*，然后去掉最后一个数字。

```
>>> nout = 3  # desired number of digits in output
>>> [f'{x:.{nout+1}f}'[:-1] for x in [2/3, 4/5, 8/9, 9/8, 5/4, 3/2]]
['0.666', '0.800', '0.888', '1.125', '1.250', '1.500'] 
```

当然，这里*发生*了四舍五入（即第四位），但*在某些时候*四舍五入是不可避免的。如果截断和舍入之间的转换是相关的，这里有一个更好的例子：

```
>>> nacc = 6  # desired accuracy (maximum 15!)
>>> nout = 3  # desired number of digits in output
>>> [f'{x:.{nacc}f}'[:-(nacc-nout)] for x in [2.9999, 2.99999, 2.999999, 2.9999999]]
>>> ['2.999', '2.999', '2.999', '3.000'] 
```

奖励：删除右侧的零

```
>>> nout = 3  # desired number of digits in output
>>> [f'{x:.{nout+1}f}'[:-1].rstrip('0') for x in [2/3, 4/5, 8/9, 9/8, 5/4, 3/2]]
['0.666', '0.8', '0.888', '1.125', '1.25', '1.5'] 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-12-20T09:29:11.147

在我看来，[这里](https://stackoverflow.com/a/784665/10645311)给出的核心思想是解决这个问题的最佳方法。不幸的是，它获得的选票较少，而[后来获得更多选票的答案](https://stackoverflow.com/a/4176526/10645311)并不完整（如评论中所观察到的）。***希望下面的实现为truncation***提供了一个简短***而***完整的解决方案。

 **```
def trunc(num, digits):
    l = str(float(num)).split('.')
    digits = min(len(l[1]), digits)
    return l[0] + '.' + l[1][:digits] 
```

这应该照顾在[这里](https://stackoverflow.com/a/4176526/10645311)和[这里](https://stackoverflow.com/a/784665/10645311)找到的所有角落案例。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-06-03T10:42:57.340

我认为更好的版本只是找到`index`小数点`.`，然后相应地获取字符串切片：

```
def truncate(number, n_digits:int=1)->float:
    '''
    :param number: real number ℝ
    :param n_digits: Maximum number of digits after the decimal point after truncation
    :return: truncated floating point number with at least one digit after decimal point
    '''
    decimalIndex = str(number).find('.')
    if decimalIndex == -1:
        return float(number)
    else:
        return float(str(number)[:decimalIndex+n_digits+1]) 
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2012-08-08T16:30:19.137

我也是一个python新手，在这里使用了一些零碎的东西后，我提供了我的两分钱

```
print str(int(time.time()))+str(datetime.now().microsecond)[:3] 
```

str(int(time.time())) 将时间纪元作为 int 并将其转换为字符串并加入... str(datetime.now().microsecond)[:3] 仅返回微秒，转换字符串并截断到前 3 个字符

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2015-08-31T02:24:03.917

```
# value  value to be truncated
# n  number of values after decimal

value = 0.999782
n = 3
float(int(value*1en))*1e-n 
```

* * *

## 回答 #30

> 赞同：-3
> 
> 时间：2009-04-23T23:01:35.290

如果您的意思是在打印时，那么以下应该可以工作：

```
print '%.3f' % number 
```

# javascript - 如何计算 DOM 元素内的文本行数？我可以吗？

> ID：783899
> 
> 赞同：146
> 
> 时间：2009-04-23T22:58:27.713
> 
> 标签：javascript, html, dom

例如，我想知道是否有一种方法可以计算 div 内的行数。假设我们有一个这样的 div：

```
<div id="content">hello how are you?</div> 
```

根据许多因素，div 可以有一行、两行甚至四行文本。脚本有什么办法知道吗？

换句话说，自动中断是否在 DOM 中表示？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-04-23T23:13:19.270

如果 div 的大小取决于内容（我假设您的描述就是这种情况），那么您可以使用以下方法检索 div 的高度：

```
var divHeight = document.getElementById('content').offsetHeight; 
```

并除以字体行高：

```
document.getElementById('content').style.lineHeight; 
```

或者如果没有明确设置，则获取行高：

```
var element = document.getElementById('content');
document.defaultView.getComputedStyle(element, null).getPropertyValue("lineHeight"); 
```

您还需要考虑填充和行间距。

**编辑**

完全独立的测试，明确设置行高：

```
function countLines() {
   var el = document.getElementById('content');
   var divHeight = el.offsetHeight
   var lineHeight = parseInt(el.style.lineHeight);
   var lines = divHeight / lineHeight;
   alert("Lines: " + lines);
}
```

```
<body onload="countLines();">
  <div id="content" style="width: 80px; line-height: 20px">
    hello how are you? hello how are you? hello how are you? hello how are you?
  </div>
</body>
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2015-02-22T22:51:42.797

查看函数[getClientRects()](https://developer.mozilla.org/en-US/docs/Web/API/Element/getClientRects)可用于计算元素中的行数。这是一个如何使用它的示例。

```
var message_lines = $("#message_container")[0].getClientRects(); 
```

它返回一个 javascript DOM 对象。通过这样做可以知道行数：

```
var amount_of_lines = message_lines.length; 
```

需要注意的几点是它仅在包含元素是内联时才有效，但是您可以用块元素围绕包含内联元素来控制宽度，如下所示：

```
console.log(  message_container.getClientRects().length  )
```

```
<div style="display:inline;" id="message_container">
  ..Text of the post..<br>
  nice ha?
</div>
```

虽然我不建议对这种风格进行硬编码。这仅用于示例目的。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-01-10T08:55:38.967

一种解决方案是使用脚本将每个单词包含在 span 标记中。然后，如果给定跨度标签的 Y 维度小于其直接前一个标签的 Y 维度，则发生换行符。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-06-03T21:51:37.790

我对这里和其他问题的答案不满意。评分最高的答案没有考虑`padding`或`border`考虑，因此显然也忽略`box-sizing`了。我的答案在这里和其他线程上结合了一些技术，以获得令我满意的解决方案。

它并不完美：当无法为`line-height`（例如`normal`或`inherit`）检索数值时，它只使用`font-size`乘以`1.2`。也许其他人可以建议一种可靠的方法来检测这些情况下的像素值。

除此之外，它已经能够正确处理我扔给它的大多数样式和案例。

[jsFiddle](https://jsfiddle.net/1eem7w08/2/)用于玩耍和测试。下面也内联。

```
function countLines(target) {
  var style = window.getComputedStyle(target, null);
  var height = parseInt(style.getPropertyValue("height"));
  var font_size = parseInt(style.getPropertyValue("font-size"));
  var line_height = parseInt(style.getPropertyValue("line-height"));
  var box_sizing = style.getPropertyValue("box-sizing");

  if(isNaN(line_height)) line_height = font_size * 1.2;

  if(box_sizing=='border-box')
  {
    var padding_top = parseInt(style.getPropertyValue("padding-top"));
    var padding_bottom = parseInt(style.getPropertyValue("padding-bottom"));
    var border_top = parseInt(style.getPropertyValue("border-top-width"));
    var border_bottom = parseInt(style.getPropertyValue("border-bottom-width"));
    height = height - padding_top - padding_bottom - border_top - border_bottom
  }
  var lines = Math.ceil(height / line_height);
  alert("Lines: " + lines);
  return lines;
}
countLines(document.getElementById("foo"));
```

```
div
{
  padding:100px 0 10% 0;
  background: pink;
  box-sizing: border-box;
  border:30px solid red;
}
```

```
<div id="foo">
x<br>
x<br>
x<br>
x<br>
</div>
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-02-25T21:22:16.547

克隆容器对象并写 2 个字母并计算高度。这将返回应用了所有样式、行高等的实际高度。现在，计算高度对象/字母的大小。在 Jquery 中，高度超过了 padding、margin 和border，计算每一行的真实高度是很棒的：

```
other = obj.clone();
other.html('a<br>b').hide().appendTo('body');
size = other.height() / 2;
other.remove();
lines = obj.height() /  size; 
```

如果您使用每个字母高度不同的稀有字体，则此方法不起作用。但适用于所有普通字体，如 Arial、mono、comics、Verdana 等。使用您的字体进行测试。

例子：

```
<div id="content" style="width: 100px">hello how are you? hello how are you? hello how are you?</div>
<script type="text/javascript">
$(document).ready(function(){

  calculate = function(obj){
    other = obj.clone();
    other.html('a<br>b').hide().appendTo('body');
    size = other.height() / 2;
    other.remove();
    return obj.height() /  size;
  }

  n = calculate($('#content'));
  alert(n + ' lines');
});
</script> 
```

结果：`6 Lines`

适用于所有浏览器，没有超出标准的稀有功能。

检查：[https ://jsfiddle.net/gzceamtr/](https://jsfiddle.net/gzceamtr/)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-02-16T11:39:21.457

对于那些使用 jQuery [http://jsfiddle.net/EppA2/3/的人](http://jsfiddle.net/EppA2/3/)

```
function getRows(selector) {
    var height = $(selector).height();
    var line_height = $(selector).css('line-height');
    line_height = parseFloat(line_height)
    var rows = height / line_height;
    return Math.round(rows);
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-25T16:20:33.863

我确信现在这是不可能的。不过，确实如此。

IE7 的 getClientRects 实现正是我想要的。在 IE8 中打开[此页面](http://home.arcor.de/martin.honnen/javascript/2008/08/test2008082301.html)，尝试以不同的窗口宽度刷新它，并查看第一个元素中的行数如何相应变化。这是该页面中javascript的关键行：

```
var rects = elementList[i].getClientRects();
var p = document.createElement('p');
p.appendChild(document.createTextNode('\'' + elementList[i].tagName + '\' element has ' + rects.length + ' line(s).')); 
```

不幸的是，Firefox 总是为每个元素返回一个客户端矩形，而 IE8 现在也是如此。（Martin Honnen 的页面现在可以正常工作，因为 IE 在 IE 兼容视图中呈现它；在 IE8 中按 F12 可以使用不同的模式。）

这真是难过;这真是伤心。看起来 Firefox 对规范的字面但毫无价值的实现再次战胜了微软的实用规范。还是我错过了新的 getClientRects 可以帮助开发人员的情况？

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-03-26T13:11:03.503

根据上面 GuyPaddock 的回答，这似乎对我有用

```
function getLinesCount(element) {
  var prevLH = element.style.lineHeight;
  var factor = 1000;
  element.style.lineHeight = factor + 'px';

  var height = element.getBoundingClientRect().height;
  element.style.lineHeight = prevLH;

  return Math.floor(height / factor);
} 
```

这里的诀窍是增加行高，以至于它会“吞下”任何浏览器/操作系统在渲染字体的方式上的差异

用各种样式和不同的字体大小/系列检查了它唯一没有考虑的东西（因为在我的情况下它无关紧要），是填充 - 可以很容易地添加到解决方案中。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-24T04:21:22.197

不，不可靠。未知变量太多了

1.  什么操作系统（不同的 DPI、字体变化等）？
2.  他们是否因为几乎是盲人而放大了字体大小？
3.  哎呀，在 webkit 浏览器中，您实际上可以根据自己的意愿调整文本框的大小。

名单还在继续。总有一天我希望有这样一种方法可以用 JavaScript 可靠地完成这个任务，但是在那一天到来之前，你运气不好。

我讨厌这些答案，我希望有人能证明我错了。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-24T04:30:50.567

您应该能够 split('\n').length 并获得换行符。

更新：这适用于 FF/Chrome，但不适用于 IE。

```
<html>
<head>
<script src="jquery-1.3.2.min.js"></script>
<script>
    $(document).ready(function() {
        var arr = $("div").text().split('\n');
        for (var i = 0; i < arr.length; i++)
            $("div").after(i + '=' + arr[i] + '<br/>');
    });
</script>
</head>
<body>
<div>One
Two
Three</div>
</body>
</html> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-08-13T09:57:39.260

遵循@BobBrunius 2010 的建议，我用 jQuery 创建了这个。毫无疑问，它可以改进，但它可能会有所帮助。

```
$(document).ready(function() {

  alert("Number of lines: " + getTextLinesNum($("#textbox")));

});

function getTextLinesNum($element) {

  var originalHtml = $element.html();
  var words = originalHtml.split(" ");
  var linePositions = [];

  // Wrap words in spans
  for (var i in words) {
    words[i] = "<span>" + words[i] + "</span>";
  }

  // Temporarily replace element content with spans. Layout should be identical.
  $element.html(words.join(" "));

  // Iterate through words and collect positions of text lines
  $element.children("span").each(function () {
    var lp = $(this).position().top;
    if (linePositions.indexOf(lp) == -1) linePositions.push(lp);
  });

  // Revert to original html content
  $element.html(originalHtml);

  // Return number of text lines
  return linePositions.length;

}
```

```
#textbox {
  width: 200px;
  text-align: center;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<div id="textbox">Lorem ipsum dolor sit amet, consectetuer adipiscing elit,
  <br>sed diam nonummy</div>
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-03-07T10:37:25.917

`getClientRects`像[这样](http://codepen.io/defims/pen/XdmPmV)返回客户端矩形，如果您想获取这些行，请使用如下[函数](http://codepen.io/defims/pen/YqwqGq)

```
function getRowRects(element) {
    var rects = [],
        clientRects = element.getClientRects(),
        len = clientRects.length,
        clientRect, top, rectsLen, rect, i;

    for(i=0; i<len; i++) {
        has = false;
        rectsLen = rects.length;
        clientRect = clientRects[i];
        top = clientRect.top;
        while(rectsLen--) {
            rect = rects[rectsLen];
            if (rect.top == top) {
                has = true;
                break;
            }
        }
        if(has) {
            rect.right = rect.right > clientRect.right ? rect.right : clientRect.right;
            rect.width = rect.right - rect.left;
        }
        else {
            rects.push({
                top: clientRect.top,
                right: clientRect.right,
                bottom: clientRect.bottom,
                left: clientRect.left,
                width: clientRect.width,
                height: clientRect.height
            });
        }
    }
    return rects;
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-05-19T20:31:13.877

我在开发 html 编辑器时找到了一种计算行号的方法。主要的方法是：

1.  在 IE 中你可以调用 getBoundingClientRects，它将每一行作为一个矩形返回

2.  在 webkit 或新标准 html 引擎中，它返回每个元素或节点的客户矩形，在这种情况下你可以比较每个矩形，我的意思是每个矩形必须是最大的，所以你可以忽略那些高度较小的矩形（如果有一个矩形的顶部比它小，底部比它大，条件为真。）

那么让我们看看测试结果：

[![在此处输入图像描述](https://i.stack.imgur.com/7mHu3.png)](https://i.stack.imgur.com/7mHu3.png)

绿色矩形是每行中最大的矩形

红色矩形是选择边界

蓝色矩形是展开后从开始到选择的边界，我们看到它可能比红色矩形大，所以我们必须检查每个矩形的底部以限制它必须小于红色矩形的底部。

```
 var lineCount = "?";
        var rects;
        if (window.getSelection) {
            //Get all client rectangles from body start to selection, count those rectangles that has the max bottom and min top
            var bounding = {};
            var range = window.getSelection().getRangeAt(0);//As this is the demo code, I dont check the range count
            bounding = range.getBoundingClientRect();//!!!GET BOUNDING BEFORE SET START!!!

            //Get bounding and fix it , when the cursor is in the last character of lineCount, it may expand to the next lineCount.
            var boundingTop = bounding.top;
            var boundingBottom = bounding.bottom;
            var node = range.startContainer;
            if (node.nodeType !== 1) {
                node = node.parentNode;
            }
            var style = window.getComputedStyle(node);
            var lineHeight = parseInt(style.lineHeight);
            if (!isNaN(lineHeight)) {
                boundingBottom = boundingTop + lineHeight;
            }
            else {
                var fontSize = parseInt(style.fontSize);
                if (!isNaN(fontSize)) {
                    boundingBottom = boundingTop + fontSize;
                }
            }
            range = range.cloneRange();

            //Now we have enougn datas to compare

            range.setStart(body, 0);
            rects = range.getClientRects();
            lineCount = 0;
            var flags = {};//Mark a flags to avoid of check some repeat lines again
            for (var i = 0; i < rects.length; i++) {
                var rect = rects[i];
                if (rect.width === 0 && rect.height === 0) {//Ignore zero rectangles
                    continue;
                }
                if (rect.bottom > boundingBottom) {//Check if current rectangle out of the real bounding of selection
                    break;
                }
                var top = rect.top;
                var bottom = rect.bottom;
                if (flags[top]) {
                    continue;
                }
                flags[top] = 1;

                //Check if there is no rectangle contains this rectangle in vertical direction.
                var succ = true;
                for (var j = 0; j < rects.length; j++) {
                    var rect2 = rects[j];
                    if (j !== i && rect2.top < top && rect2.bottom > bottom) {
                        succ = false;
                        break;
                    }
                }
                //If succ, add lineCount 1
                if (succ) {
                    lineCount++;
                }
            }
        }
        else if (editor.document.selection) {//IN IE8 getClientRects returns each single lineCount as a rectangle
            var range = body.createTextRange();
            range.setEndPoint("EndToEnd", range);
            rects = range.getClientRects();
            lineCount = rects.length;
        }
        //Now we get lineCount here 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-12-21T04:25:13.693

试试这个解决方案：

```
function calculateLineCount(element) {
  var lineHeightBefore = element.css("line-height"),
      boxSizing        = element.css("box-sizing"),
      height,
      lineCount;

  // Force the line height to a known value
  element.css("line-height", "1px");

  // Take a snapshot of the height
  height = parseFloat(element.css("height"));

  // Reset the line height
  element.css("line-height", lineHeightBefore);

  if (boxSizing == "border-box") {
    // With "border-box", padding cuts into the content, so we have to subtract
    // it out
    var paddingTop    = parseFloat(element.css("padding-top")),
        paddingBottom = parseFloat(element.css("padding-bottom"));

    height -= (paddingTop + paddingBottom);
  }

  // The height is the line count
  lineCount = height;

  return lineCount;
} 
```

你可以在这里看到它的实际效果： [https ://jsfiddle.net/u0r6avnt/](https://jsfiddle.net/u0r6avnt/)

*尝试调整页面上面板的大小（使页面的右侧更宽或更短），然后再次运行它以查看它可以可靠地判断有多少行。*

这个问题比看起来要难，但大部分困难来自两个方面：

1.  浏览器中的文本渲染太低级，无法直接从 JavaScript 查询。甚至 CSS ::first-line 伪选择器的行为也不像其他选择器那样（例如，您不能反转它，以将样式应用于除*第一*行之外的所有内容）。

2.  上下文在您如何计算行数中起着重要作用。例如，如果 line-height 没有在目标元素的层次结构中明确设置，您可能会得到“正常”作为行高。此外，该元素可能正在使用`box-sizing: border-box`，因此会受到填充。

我的方法通过直接控制 line-height 并考虑盒子大小的方法来最小化 #2，从而产生更具确定性的结果。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-07-31T09:31:54.270

您可以将元素高度和元素高度与`line-height: 0`

```
function lineCount(elm) {
      const originalStyle = elm.getAttribute('style')

      // normalize 
      elm.style.padding = 0
      elm.style.border = 0

      // measure
      elm.style.lineHeight = 1
      const totalHeight = elm.offsetHeight
      elm.style.lineHeight = 0
      const singleLineHeight = elm.scrollHeight * 2

      const lineCount = Math.round(totalHeight / singleLineHeight)

      // undo above style changes
      elm.setAttribute('style', originalStyle)

      return (isNaN(lineCount) || singleLineHeight == 0) ? 0 : lineCount
}

function printElmLineCount(elm){
  console.log(
     lineCount(elm)
  )
}
```

```
p{ border:2em black solid ; padding:1em; line-height: 3em; }
```

```
<p contentEditable id='elm'>
  one<br>
  two<br>
  three
</p>

<button onclick='printElmLineCount(elm)'>Get lines count</button>
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-08-24T21:11:26.703

在某些情况下，例如在非对齐文本中跨越多行的链接，当您使用此选项时，您可以获得行数和每行的每个坐标：

```
var rectCollection = object.getClientRects(); 
```

[https://developer.mozilla.org/en-US/docs/Web/API/Element/getClientRects](https://developer.mozilla.org/en-US/docs/Web/API/Element/getClientRects)

这是有效的，因为每条线都会略有不同。只要它们存在，它们就会被渲染器绘制为不同的“矩形”。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-16T15:53:10.003

您可以计算元素中的换行数`innerText`，如下所示：

```
const text = anyDivElement.innerText;
const lines = text.split(/\r\n|\r|\n/).length; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-01-07T16:21:17.527

最简单的方法是计算行高并将其除以元素高度。此代码适用于任何类型的元素：

```
function getStyle(el,styleProp)
{
    var x = el;
    if (x.currentStyle)
        var y = x.currentStyle[styleProp];
    else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(x,null).getPropertyValue(styleProp);
    return y;
}
function calculateLineHeight (element) {

  var lineHeight = parseInt(getStyle(element, 'line-height'), 10);
  var clone;
  var singleLineHeight;
  var doubleLineHeight;

  if (isNaN(lineHeight)) {
    clone = element.cloneNode();
    clone.innerHTML = '<br>';
    element.appendChild(clone);
    singleLineHeight = clone.offsetHeight;
    clone.innerHTML = '<br><br>';
    doubleLineHeight = clone.offsetHeight;
    element.removeChild(clone);
    lineHeight = doubleLineHeight - singleLineHeight;
  }

  return lineHeight;
}

function getNumlines(el){return Math.ceil(el.offsetHeight / calculateLineHeight (el))}

console.log(getNumlines(document.getElementById('g1')))
```

```
.Text{font-size: 28px;}
@media screen and (max-width: 780px) {
            .Text{font-size: 50px;}
        }
```

```
<div><span class="Text" id="g1" >
                This code works for any Kind of elements: bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli bla blo bli </span>
        </div>
```

# eclipse - 在 Eclipse 中排除/禁用验证

> ID：783902
> 
> 赞同：42
> 
> 时间：2009-04-23T23:00:01.313
> 
> 标签：eclipse

我很幸运拥有一个大型项目源代码库，我主要在其中使用 PHP 和 JavaScript。我必须拥有完整的项目区域作为 Eclipse 中的项目根目录，但不幸的是，这包括驱动内置到 WST/DLTK/etc 中的验证的几个目录。坚果。

我尝试禁用项目属性中的所有验证器。我一次进入验证器，并将规则添加到“排除组”集中以排除特定文件夹。我已经从项目属性中的 PHP 构建路径中删除了这些文件夹。然而，我的问题视图/选项卡仍然充斥着成千上万的危险信号，这些危险信号主要来自我们用来保存外部元素（Apache、PHP 等）副本的文件夹。您知道，典型的“拥有我们当前使用的特定版本的副本”之类的东西。

信噪比太差了，我根本无法使用视图，这是一种耻辱。如果我不打算享受 IDE 的好处，我不妨为此使用 vim（我将它用于其他东西，但对于这个代码库，一个好的 IDE 是一个更好的选择，只要我可以让它工作）。在我看来，能够右键单击项目中的文件夹并选择“从验证中排除”将是一个明显的功能，但可惜没有这样的功能。是否有另一种方法可以让验证器（PHP、HTML 等）忽略我需要忽略的文件夹？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2011-03-13T09:21:20.320

尝试过的解决方案；

1.  右键项目
2.  选择属性
3.  选择验证
4.  选中启用项目特定设置
5.  在 XML Validator 行上，单击“...”按钮
6.  选择排除组
7.  点击添加规则
8.  选择“文件夹或文件名”
9.  点击下一步
10.  选择未验证的文件或文件夹。
11.  点击完成
12.  点击确定
13.  点击确定

这解决了我的问题。因为 Eclipse 验证会为生成的 GWT 文件提供错误。

此致。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-12-11T13:24:12.233

我有 Eclipse for PHP Developers，我正在处理同样的问题。

除了上述出色的答案外，我还有一个建议。

我的第一个建议是不要使用 Aptana，除非你真的想要那些验证器（因为根据我的经验，它们几乎不可能关闭）。

除此之外，转到 File -> Properties -> Builders，然后取消选择“Validation”和“Script Builder”和“JavaScript Validator”。

到目前为止，它帮助极大地加快了一些操作。

我还建议禁用“自动构建”。因为您使用的是 PHP，所以如果您不想要验证，您实际上需要它来构建任何东西的可能性很小。

在主菜单中，转到项目并取消选中“自动构建”。您将需要不时地通过右键单击项目并选择“构建项目”来构建您的项目。

以上所有步骤都帮助我获得了基本编辑器，这正是我想要的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-12-06T09:46:34.787

我在寻找相同答案时遇到了这个问题。我将列出我在这里执行的步骤，希望它对将来的人有所帮助。

我正在使用 Eclipse 4.1，并执行以下操作来排除特定 xml 文件的验证。我敢肯定，如果您配置不同的验证器，它也适用于其他文件。

转到 Preferences -> Validation 找到您要更改的验证器并选择设置（并非所有验证器都有设置，希望您有）。

在设置中，您可以添加排除组，您可以在其中添加规则以指定排除特定扩展名、文件夹或文件名、项目性质、构面或内容类型的验证器。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-10-27T14:08:45.987

我曾经通过特定项目从验证中排除资源`Exclude Group`（正如这里的大多数答案所暗示的那样）。但是，如果有人在 2014 年对指定文件夹禁用验证仍然存在问题 - 只需**将文件夹资源标记为`Derived`**：

![资源属性对话框](https://i.stack.imgur.com/6pioH.png)

这应该禁用对该文件夹的验证。

如果您使用的是 EGIT，您可能还希望禁用自动包含派生资源`.gitignore`：

![Git 项目首选项对话框](https://i.stack.imgur.com/oKgPd.png)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-07-24T15:12:43.943

实际上不可能选择一个目录，至少在 Windows 下是这样。

在按下 Preferences->Validation->Settings->Add Exclude Group->Add Rule->Folder or filename->Browse Folder->(selecting some directory)->[OK]

“Browse for folder”对话框正在关闭，“文件或文件夹”字段为空。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T20:07:03.960

我正在开发的网络应用程序遇到了同样的问题。我最终禁用了自动构建，并且每天构建一次（项目-> 自动构建），这样我仍然可以从库中获得代码完成的好处，同时加快旧计算机上的程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-18T09:27:45.537

解决方案。

**像lothar**建议的那样配置问题视图中显示的内容，创建新的自定义过滤器并在“范围”区域中选择“在工作集上”。现在按下此选项正下方的按钮以配置它将是什么工作集：在工作集选择弹出窗口中点击“新建”按钮并标记您的所有项目文件，除了那些您想要从验证中排除的文件。您可能希望以方便的名称保存此工作集，例如“No_Validation_Set”。

摘要：1）工作集排除有问题的文件。2）自定义问题视图过滤器来操作这个集合。

问题：向项目添加新文件时，您需要更新工作集，因此它们也经过验证。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-01T17:43:20.227

我发现在项目属性中有一个 Builders 类别。在构建器列表中，我有一个 JavaScript 构建器。我取消选择了这个构建器，我所有烦人的 javascript 验证问题都消失了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-01T13:05:21.290

这对我有用：Properties > Builders 部分并取消选中相应的框。[https://bugs.eclipse.org/bugs/show_bug.cgi?id=317833](https://bugs.eclipse.org/bugs/show_bug.cgi?id=317833)

似乎是某些版本的 Eclipse 中的错误。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-10-18T16:53:48.650

有更多的全局验证参数。您可以通过以下方式暂停所有验证（或仅暂停不需要的验证）：

```
Window > Preferences > Validation. 
```

在这里，选中“*暂停所有验证器*”框。

或者，从下面的列表中取消选中您不需要的验证器。
将请求一个完整的构建，这可能需要一些时间。但是 Eclipse 之后会运行得更快[但当然没有验证]

[http://www.flickr.com/photos/jesuspresley/5094048124/](http://www.flickr.com/photos/jesuspresley/5094048124/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-03-15T10:15:41.920

当我从项目验证中排除文件时，在我重新启动 Eclipse 并清理项目之前，我的设置似乎没有被识别。

# sql-server-2005 - MSSQL Server 2005 临时数据库问题

> ID：783904
> 
> 赞同：1
> 
> 时间：2009-04-23T23:00:29.690
> 
> 标签：sql-server-2005

所以我有一个行为怪异的数据库。我正在查看服务器上的所有活动，并且 tempdb 不断增长。它在大约 45 分钟内增长了 30GB。我不断检查 tempdb 中分配的空间，它总是大约 8mb。我知道它不需要它分配的所有空间，我已经看到 1 个事务发生，其中 tempdb 基本上是空的，并且仍在增长。在我看来，引擎不是使用先前分配的空间而是选择使用更多的硬盘空间。我注意到今天早些时候我们的 tempdb 非常大，并重新启动了 SQL，这使 tempdb 的大小减小到一个合适的大小，但从那以后它又一直在增长，并且不断地重新启动 SQL 不是一种选择，因为这是一个生产环境。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T23:17:44.830

您是否对正在运行的脚本进行了分析？您是否使用探查器来确定 SQL 活动？

我的第一个想法是使用临时表（#table）和可能的笛卡尔积连接的脚本？

请注意，在 SQL Server 启动时会重新创建 tempdb，这就是为什么在您重新启动服务时它会被截断。

# git - windows下的Git：MSYS还是Cygwin？

> ID：783906
> 
> 赞同：80
> 
> 时间：2009-04-23T23:01:44.227
> 
> 标签：git, cygwin, msysgit, dvcs

我计划将我的项目迁移到 git，我目前想知道在 windows 下哪个是最好和/或最稳定的选项。

据我所知，我基本上有 2.5 个选项：

1.  [MSYSgit](http://code.google.com/p/msysgit/)
2.  [Cygwin](http://www.cygwin.com/)下的git
3.  （又名 2.5）来自 Cygwin 提示符的 MSYSgit（假设 Cygwin git 已经安装）。

注意：IMO Cygwin 本身就是一大优势，因为您可以访问几乎所有的 *nix 命令行工具，就像使用 MSYSgit bash 一样，您只能访问这些工具的一小部分。

鉴于此，你会建议什么选择？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-04-24T06:29:59.313

编辑（2 年后：2014 年 10 月）

[Johannes Schindelin](http://episodes.gitminutes.com/2014/04/gitminutes-28-johannes-schindelin-on.html) [刚刚解释](http://osdir.com/ml/msysgit/2014-10/msg00071.html)（2014 年 10 月）**msysgit 已被淘汰**：

> 我们现在有一个**用于 Windows SDK 的轻量级 Git——**它本质上是一个通过包管理器 mingw-get 管理的标准 MinGW/MSys 系统。
> 
> 我们决定逐步淘汰名称“msysGit”（以及[同名](https://github.com/msysgit/msysgit/wiki/Relationship-to-Git-for-Windows)的 GitHub org ）并使用[**适用于 Windows 的 Git**](http://git-for-windows.github.io/)（以及[相应的 GitHub org）](https://github.com/git-for-windows)，并使用名称“Git for Windows”作为目标安装程序在“最终用户”和“Git for Windows SDK”中，针对面向 Windows 开发人员的 Git 开发环境）。

* * *

编辑（3 年后：2012 年 4 月）

如果你想在 Git 世界中轻量级快速启动， MsysGit（现在[在 GitHub 上](https://github.com/msysgit/msysgit)）是你要走的路：解压缩存档，启动，[`git-cmd.bat`](https://github.com/msysgit/msysgit/blob/devel/git-cmd.bat)或者[`git-bash.bat`](https://github.com/msysgit/msysgit/blob/devel/msys.bat)你就完成了。
它的[最新版本（1.7.10，2012 年 4 月）](http://code.google.com/p/msysgit/downloads/list)现在包括[对 UTF-8 的支持](https://stackoverflow.com/a/5855213/6309)，也[包括在 GitExtension 中](https://github.com/jbialobr/gitextensions/commit/50bf972442629c798be20a377a4702fef4a0f443)。不要忘记将您的设置[`autocrlf`为 false](https://stackoverflow.com/questions/2333424/distributing-git-configuration-with-the-code/2354278#2354278)。

如果您确实缺少所有其他 unix 命令而不是 msysgit 软件包，只需下载一个[GoW 版本（Windows 上的 Gnu）](https://github.com/bmatzelle/gow/wiki)，恰当地命名为“Cygwin 的轻量级替代品”。
我的意思是：[**130个**unix命令](https://github.com/bmatzelle/gow/wiki/executables_list)...

Cygwin 应该是仅适用于某些情况的备份解决方案，例如*大型*Git 存储库的传输速度，如下面的[incrementor](https://stackoverflow.com/users/1203340/incrementor)在[他的回答](https://stackoverflow.com/a/9237853/6309)中提到的。

* * *

2012 年 6 月：如果您想与**GitHub**交互，现在可以**[访问 http://windows.github.com](http://windows.github.com)**（另请参阅“[为 Windows 设计 GitHub](https://github.com/blog/1151-designing-github-for-windows) ”）。
它不仅会为您配置 ssh 密钥（并将生成的公钥添加到您的 GitHub 配置文件中），而且还会为所有 git 操作安装一个... MsysGit。

* * *

原始答案（2009 年 4 月）

我对最新版本的 MsysGit 没有任何问题：
我使用[选项 2](https://stackoverflow.com/questions/623518/msysgit-on-windows-what-should-i-be-aware-of-if-any)，这意味着我只将 git\bin 目录添加到 PATH 环境变量中，但没有覆盖一些内置的 windows 工具。

我设法定义了外部工具，如[Notepad++](https://stackoverflow.com/questions/10564/how-can-i-set-up-an-editor-to-work-with-git-on-windows/773973#773973)和[WinMerge（或 DiffMerge）](https://stackoverflow.com/questions/780425/how-do-i-setup-diffmerge-with-msysgit-gitk/783667#783667)

我确实成功地运行了像[svn2git](https://stackoverflow.com/questions/572893/cloning-a-non-standard-svn-repository-with-git-svn/572898#572898)这样的脚本，因为从 MsysGit1.6.2+ 开始，它确实包含 ' `git svn`' 命令。

最后我期待 MsysGit1.6.2.3 因为它[会包含 finally ' `git filter-branch`' 命令](http://groups.google.com/group/msysgit/browse_thread/thread/23d0046b697bdcce/aa746a2e3eab37fa?lnk=raot)！（过滤器分支的慢版本，但仍然）。

对于 Unix 命令，我更喜欢安装[GnuWin32 coreutils 包](https://stackoverflow.com/questions/247234/do-you-know-a-similar-program-for-wc-unix-word-count-command-on-windows)，并且仅在需要时使用它们。

所以总而言之，我不使用 Cygwin 层，并在其基于 Windows 的版本 MsysGit 中很好地运行了 Git。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-02-11T04:35:56.820

Yes. Old question. New answer:

We have been using MSYSgit for about 2 years now in a large deployment. The speed of transfers from a local git repository server have been limited to less than 5 MiB/s. Earlier investigation into the issue indicated that the problem was with MSYS devs being on Windows XP and Windows 7 security limiting connections from command prompt/bash shell. This does not appear to be, in fact, the problem.

I discovered [Darrell Mozingo's blog posting](http://darrell.mozingo.net/2011/09/29/painfully-slow-clone-speeds-with-msysgit-gitextensions/) and tested a clone of a large (many GiB) repo using only a Cygwin install. Transfer speeds were in the 30 MiB/s range. The problem is that MSYSgit uses an antique OpenSSH binary from 2007.

To this end, until that gets fixed, I am now recommending a shift to Cygwin (even though the version of git is a bit behind). I also found Cygwin to be more stable and less likely for perl to run out of memory.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-24T02:50:06.097

我已经尝试过使用 MSYS 和 Cygwin 版本的 git，老实说，我没有发现这两种体验特别好。我只是认为 git 还没有真正为 Windows 做好准备。

话虽如此，我在 MSYS 版本中发现的一个问题是，它将（非二进制）文件的行尾从 UNIX 样式（换行）转换为 DOS 样式（回车/换行）。您可能认为这是一个错误或一个功能，但没有办法改变我能找到的行为。（编辑：将配置变量设置`core.autocrlf`为`false`。谢谢布赖恩。）

OTOH，MSYS 版本的 git 具有一些在 cygwin 版本中不可用的 GUI 功能，除非您想安装和运行整个 X 服务器。（感谢乔斯确认这一点。）

我的印象是 MSYS 版本更受欢迎，虽然这可能是因为你不需要安装 cygwin 生态系统来使用它。（我同意，cygwin 非常有用。）

就个人而言，我会选择[Bazaar](http://bazaar-vcs.org/)或[Mercurial](http://www.selenic.com/mercurial/)，其中任何一个都对 windows IMO 有更好的支持。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-24T02:55:33.243

Cygwin 和 Msys Git 都适用于正常用例。如果你想使用 git-svn 等脚本，Cygwin 是一个更好的选择。作为一个最终跳槽到 Linux 的老 Windows 用户，我可以肯定地说 Cygwin 是一个巨大的福音，它本身就值得拥有。

上下文很重要；这些是什么项目？它们被谁使用？等等。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-03-18T15:39:09.243

我还测试了两个世界（CygWin 和 MSysgit），我的经验也是 MSysgit bash 存在一些缺点。Cygwin 在同一个 git 存储库上优雅地处理它时，无法成功运行 git stash。

虽然还没有进行深入的分析...

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-09-12T16:55:29.963

我目前将 Msysgit 与 TortoiseGit 一起使用。

MsysGit UI 并不是我真正喜欢的，所以我使用了一个熟悉的工具，比如 TortoiseGit，在命令行上工作时（大部分时间），我使用来自 Msysgit 的 git 二进制文件

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-03-05T20:30:15.537

我会推荐 msysgit。特别是如果它与[Git Extensions](http://code.google.com/p/gitextensions/)一起使用：它提供了配置环境的简单方法：编辑器/差异/合并工具，并允许从用户界面执行高级 git 操作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-17T09:50:23.693

我在 Windows 上使用过 Cygwin Git 和 Msysgit。我建议使用 Cygwin + Git。Cygwin 1.7（目前处于测试阶段）在使用 git gui 和 gitk 时解决了一个主要的细微差别（至少对我而言）。Cygwin 的早期版本过去每次我在 git-gui 或 gitk 中做某事时都会打开 10 多个 cmd 窗口。这已在 1.7 中解决。Cygwin 强大的 shell 也带来了许多 linux 终端的优点。

也就是说，Msysgit 已经发展了很多，并且在 Windows 中非常有用。不过，我遇到了几个问题。

权限问题：在 Windows 中本地创建的一些文件的模式为 755，在使用 Msysgit 时转换为 644。这将显示为修改后的文件。签入应该可以解决此问题。

CRLF：像往常一样难以捉摸的 CRLF 在 Windows 中产生了问题。Msysgit 可能会报告文件已修改。这可以通过在安装 Msysgit 时选择“保持行尾不变”（忘记确切的文本）来解决。

守护进程：是的，我仍然觉得在 Msysgit 中设置 git 守护进程很困难。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-04-06T17:41:08.730

旧问题的新答案...

我在 Windows 7 cmd shell 中使用 git 1.7.3，效果很好。我混合使用了 git 命令行和 git gui，几个月来都运行良好。我们确实遇到了回车/换行问题，当我们将 Mac 开发人员添加到团队中时，问题更加严重，但这些问题已经通过......

```
core.autocrlf=true
core.safecrlf=false 
```

并不是说您不应该使用 *nix-y shell，只是说没有必要。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-11T21:07:30.280

我在 MSys 的 cygwin 实现中遇到了严重的错误：一些命令，尤其是 rebase，很容易失败。Cygwin的对我来说更稳定。

也就是说，这是一个月前的事了，从那以后可能会有所改善。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-03-19T12:13:37.223

如果您只想执行简单的操作，例如推/拉/分支，您可以尝试 Atlasian 的 SourceTree。一个非常简单明了的 Git 命令用户界面。然而，它有不足之处。

如果您需要使用命令行 git 工具，只需获取 Git for windows 工具即可。这应该足够了，除非您开始查看 bash 脚本。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-24T06:58:55.517

我对[CygWin](http://www.cygwin.com/)持保留态度，因为我只想要 git 而不是 Cygwin 想要插入的任何其他工具。通常你希望你的 Windows 计算机像 Windows 计算机一样工作，而 CygWin 想要拍一些完全不同的东西。只是为了好玩而使用 *nix 功能是不可取的。

问题是，如果我想使用 *nix 之类的命令行，我会转到我的 Linux 机器并在该计算机上工作。[如今，虚拟计算机](http://www.virtualbox.org/)和[远程桌面](http://www.nomachine.com/download.php)就像一种魅力，并且对开发人员来说足够容易访问。

您使用 CygWin 确实需要有正当理由。如果只是为了使用 git，我建议您改用[MSysGit](http://code.google.com/p/msysgit/)，这是我的偏好。它与捆绑的 gitk 和 git-gui 工具配合得非常好。我一直在使用 msysgit 开发 Eclipse 和 Visual Studio，它就像一个魅力。

我现在唯一等待的是[git 的完全正常工作的 Tortoise 克隆](http://repo.or.cz/w/git-cheetah.git)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-06-01T08:15:45.653

在 Windows 下有一种情况，您只需**通过**Cygwin 使用 Git：这是当您想针对 SVN 服务器使用 Git 时，该服务器需要 SVN 客户端版本高于 1.5。存在 SVN 预提交钩子，当没有 'mergeinfo' 参数时会阻止提交 - 并且 'mergeinfo' 参数仅在 1.5 版后才在 SVN 中为默认值。[msysGit 的问题在于，它是针对较旧的 SVN 版本（1.4.6）构建的，因此在这种情况下您无法成功提交。](http://code.google.com/p/msysgit/issues/detail?id=253)但是使用 Cygwin 的 Git 是可能的，因为它是针对较新的 SVN 版本构建的。

# linq - 按顺序而不是 LINQ 中的条件加入 2 个列表

> ID：783922
> 
> 赞同：5
> 
> 时间：2009-04-23T23:09:02.057
> 
> 标签：linq, join, linq-to-objects

我如何加入 2 个相等长度的列表（以生成第 3 个相等长度的列表），我不想指定条件，而只是依赖于 2 个列表中的项目顺序。

例如，我如何加入：

```
{1,2,3,4} with {5,6,7,8} 
```

生产：

```
{{1,5}, {2,6}, {3,7}, {4,8}} 
```

我尝试了以下方法：

```
from i in new []{1,2,3,4}
from j in new []{5,6,7,8}
select new { i, j } 
```

但这会产生交叉连接。当我使用join时，我总是需要指定“on”。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-23T23:22:15.737

您可以在第一个列表中使用[Select](http://msdn.microsoft.com/en-us/library/bb534869.aspx)，使用项目索引并访问第二个列表中的元素：

```
var a = new [] {1,2,3,4};
var b = new [] {5,6,7,8};

var qry = a.Select((i, index) => new {i, j = b[index]}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-28T14:12:03.013

如果您使用的是 .Net 4.0，则可以使用 Zip 扩展方法和元组。

```
var a = new [] {1,2,3,4};
var b = new [] {5,6,7,8};

var result = a.Zip(b, (an, bn) => Tuple.Create(an, bn)); 
```

或者，您可以将它们保存为数组：

```
var resultArr = a.Zip(b, (an, bn) => new []{an, bn}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-28T13:28:32.947

如果您想使用查询语法，有一个中途解决方案。从某种意义上说，您需要在两个列表上使用 Select 方法才能获得将在 where 子句中使用的索引。

```
int[] list1 = {1,2,3,4};
int[] list2 = {5,6,7,8};

var result = from item1 in list1.Select((value, index) => new {value, index})
             from item2 in list2.Select((value, index) => new {value, index})
             where item1.index == item2.index
             select new {Value1 = item1.value, Value2 = item2.value}; 
```

此解决方案的好处是，如果列表具有不同的长度，它不会失败，就像使用索引器的解决方案一样。

# c# - Control.Invoke 输入参数

> ID：783925
> 
> 赞同：13
> 
> 时间：2009-04-23T23:10:22.037
> 
> 标签：c#, winforms, multithreading

根据我在 C# 中的发现，Control.Invoke 方法要求您使用不带输入参数的委托。有没有办法解决？我想调用一个方法来从另一个线程更新 UI 并将字符串参数传递给它。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-23T23:30:00.977

您使用的是哪个版本的 C#？如果您使用 C#3.5，您可以使用闭包来避免传入参数。

使用 C#3.5

```
public static class ControlExtensions
{
  public static TResult InvokeEx<TControl, TResult>(this TControl control,
                                             Func<TControl, TResult> func)
    where TControl : Control
  {
    return control.InvokeRequired
            ? (TResult)control.Invoke(func, control)
            : func(control);
  }

  public static void InvokeEx<TControl>(this TControl control,
                                        Action<TControl> func)
    where TControl : Control
  {
    control.InvokeEx(c => { func(c); return c; });
  }

  public static void InvokeEx<TControl>(this TControl control, Action action)
    where TControl : Control
  {
    control.InvokeEx(c => action());
  }
} 
```

安全调用代码现在变得微不足道。

```
this.InvokeEx(f => f.label1.Text = "Hello World");
this.InvokeEx(f => this.label1.Text = GetLabelText("HELLO_WORLD", var1));
this.InvokeEx(() => this.label1.Text = DateTime.Now.ToString()); 
```

* * *

使用 C#2.0，它变得不那么琐碎

```
public class MyForm : Form
{
  private delegate void UpdateControlTextCallback(Control control, string text);
  public void UpdateControlText(Control control, string text)
  {
    if (control.InvokeRequired)
    {
      control.Invoke(new UpdateControlTextCallback(UpdateControlText), control, text);
    }
    else
    {
      control.Text = text;
    }
  }
} 
```

使用它很简单，但是您必须为更多参数定义更多回调。

```
this.UpdateControlText(label1, "Hello world"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-02T12:35:04.447

更多可能性：

```
this.Invoke(new MethodInvoker(() => this.DoSomething(param1, param2))); 
```

或者

```
this.Invoke(new Action(() => this.DoSomething(param1, param2))); 
```

甚至

```
this.Invoke(new Func<YourType>(() => this.DoSomething(param1, param2))); 
```

其中第一个选项是最好的，因为 MethodInvoker 是为此目的而设计的并且具有更好的性能。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-04T12:31:44.310

正如卢克所说，像这样使用 Control.Invoke ......

例如在一个表格中：

```
public delegate void DelegatePassMessages(string name, int value);

public DelegatePassMessages passMessage; 
```

在构造函数中：

```
passMessage = new DelegatePassMessages (this.MessagesIn); 
```

然后MessagesIn函数接收数据：

```
public void MessagesIn(string name, int value)
{

} 
```

然后将数据传递给您的表单：

```
formName.Invoke(formName.passMessage, new Object[] { param1, param2}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T12:18:36.537

我认为塞缪尔的（优秀）方法可以进一步推动：

**扩展方法：**

```
public static void ExecuteAsync<TControl>(this TControl control, Action action)
where TControl : Control
{
  new Thread(() =>
  {
    control.Invoke(action);
  })
  .Start();
} 
```

**表格代码：**

```
private void doStuff()
{
  this.ExecuteAsync(() =>
  {
    // Do your stuff in a separate thread
    // but having full access to local or instance variables.

    // No (visible) threading code needs to be used here.
  });
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-08T07:28:29.217

在这里，您可以使用带有 Invoke() 扩展 + 输入参数的 lambda 表达式。

使用：动作（STARS db）

```
_ccb.GetImagerFRU_PartNbr().Invoke(new Action<STARS>(dbase => _ccb.GetImagerFRU_PartNbr().Text = dbase.PartNumber(serial) ?? String.Empty), db); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-01T19:13:50.090

为什么不

```
tvMatrix.Invoke((MethodInvoker) (() => {
    tvMatrix.Nodes[0].Nodes.Add(id.ToString(), typename);
})); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-23T07:36:28.063

为 .net 2.0 找到了一个优雅的方法，其中包含在 MethodInvoker 委托中的匿名方法。这样就不需要一直定义自己的委托。例子：

```
 private void InitUI(Guid id, string typename)
    {
        MethodInvoker inv = delegate{tvMatrix.Nodes[0].Nodes.Add(id.ToString(), typename);};
        tvMatrix.Invoke(inv);
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-07-10T20:06:07.957

```
 private void ppTrace(string tv)
    {
        if (_Txb1.InvokeRequired)
        {
            _Txb1.Invoke((Action<string>)ppTrace, tv);
        }
        else
        {
            _Txb1.AppendText(tv + Environment.NewLine);
        }
    } 
```

# .net - 什么是扩展方法——是什么让它们与其他方法不同？

> ID：783926
> 
> 赞同：-1
> 
> 时间：2009-04-23T23:10:37.093
> 
> 标签：.net, extension-methods

> **这个问题在这里已经有了答案：**
> [什么是扩展方法？](https://stackoverflow.com/questions/403539/what-are-extension-methods) *5 answers*
> [扩展方法的使用](https://stackoverflow.com/questions/403619/usage-of-extension-methods) *9 answers*
> [你发现扩展方法的优点是什么？[关闭]](https://stackoverflow.com/questions/487904/what-advantages-of-extension-methods-have-you-found) *30 个答案*

因此，在阅读有关 .Net 和智能感知（！）的文章时，我经常遇到“扩展方法”这个词......

什么是扩展方法——它们与其他方法的区别是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T23:13:42.513

它们是静态方法，可以添加到其他类型而无需修改原始类型。

例如，假设您希望能够对字符串调用 ToInt()。您可以创建这样的方法：

```
public static int ToInt( this string value ){ return Int32.Parse( value ); } 
```

现在假设您的网页上有一个名为 Port 的 TextBox，您可以将其作为 int 获取，如下所示：

```
int port = Port.Text.ToInt(); 
```

扩展方法的实际使用通常比这更有用，并且被[Fluent](http://en.wikipedia.org/wiki/Fluent_interface) API 和[测试](http://www.nunit.org/index.php)框架大量使用。

**更新：**扩展的另一个很好的用途是为接口提供类似于默认行为的基类。许多流行的测试方法依赖于接口定义和模拟这些接口的能力。不幸的是，基于接口的一切都失去了继承的一些好处。扩展方法可以在不污染接口的情况下增加基类的一些便利。

例如说我有一个`Window`这样定义的基类

```
public class Window
{
    public void Show( object owner ){...}
    public void Show(){ Show( null ); }
} 
```

现在我想`IWindow`从这个类中提取一个接口。我真的不想要求派生自`IWindow`的每个对象都必须实现第二种`Show`方法，因为它只是一个基本的重载。所以我可以这样定义我的界面：

```
public interface IWindow
{
    void Show( object owner );
} 
```

还有一个像这样的扩展方法：

```
public static void Show( this IWindow window )
{
    window.Show( null );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T23:27:51.060

扩展方法是静态方法，第一个参数具有特殊语法。编译器允许您像实例方法一样在语法上使用它们。

```
public class ExampleClass
{
   public String Value { get; set; }
} 
```

现在你可以`PrintValue()`通过修改类来引入一个方法。

```
public class ExampleClass
{
   public String Value { get; set; }

   public void PrintValueInstance()
   {
      Console.WriteLine(this.Value);
   }
} 
```

您还可以在某个类`ExampleClass`或任何其他类中创建一个静态方法。

```
public class AnyClass
{
   public static void PrintValueStatic(ExampleClass exampleClass)
   {
      Console.WriteLine(exampleClass.Value);
   }
} 
```

你可以创建一个扩展方法——它很像静态方法，但是用 . 标记第一个参数`this`。

```
public class ExtensionClass
{
   public static void PrintValueExtension(this ExampleClass exampleClass)
   {
      Console.WriteLine(exampleClass.Value);
   }
} 
```

那么用法如下。

```
ExampleClass example = new ExampleClass();

example.PrintValueInstance(); // Instance method

AnyClass.PrintValueStatic(example); // Static method

ExtensionClass.PrintValueExtension(example); // Extension method (long usage)

example.PrintValueExtension(); // Extension method 
```

因此，编译器允许您在与第一个参数类型匹配的对象上使用具有实例方法语法的静态方法。这允许您向类添加方法而无需修改类。当然，有一个限制 - 您只能从扩展方法中访问公共成员。

您还可以为接口定义扩展方法，然后它们可用于所有实现该接口的类。

```
public interface ISomeInterface
{
   Int32 Foo(Int32 value);
   Int32 Bar(String text);
}

public static class SomeInterfaceExtension
{
    public static Int32 FooFooBar(this ISomeInterface @this, String text)
    {
       return  @this.Foo(@this.Foo(@this.Bar(text));
    }
} 
```

现在该方法`FooFooBar()`可用于所有实现`ISomeInterface`.

```
public class NiceClass : ISomeInterface
{
   public Int32 Foo(Int32 value)
   {
      return value * value;
   }

   public Int32 Bar(String text)
   {
      return text.Length;
   }
} 
```

`NiceClass`现在您可以在实例上使用扩展方法。

```
NiceClass niceClass = new NiceClass();

Console.WriteLine(niceClass.FooFooBar("ExtensionMethodExample")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T23:14:22.637

请参阅有关扩展方法的[MSDN 主题](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T23:15:00.980

扩展方法是您自己的类中的静态方法，可用于操作类型，通常不在您自己的代码中。

例如，您可以编写：

```
public static void RemoveS(this string value)
{
   value = value.Trim("s");
} 
```

并且此方法将附加到系统中的所有“字符串”类型，只要您编写它的命名空间对编译器可用。

喜欢：

```
string foo = "Somethings";
string betterfoo = foo.RemoveS(); 
```

有关更多帮助，请参见：[http ://www.csharphelp.com/archives/archive148.html。](http://www.csharphelp.com/archives/archive148.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T23:18:18.510

我在这里写了一个关于它们的摘要：

[http://blogs.msdn.com/vbteam/archive/2007/01/05/extension-methods-part-1.aspx](http://blogs.msdn.com/vbteam/archive/2007/01/05/extension-methods-part-1.aspx)

回到我以前在 VB 编译器团队工作的时候。它很好地概述了它们为何有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T23:18:28.120

扩展方法是您创建的用于扩展现有类型（字符串、int、char 或自定义类型）的方法。

这允许您向其他人创建的内置类型或类型添加功能（例如在 dll 中）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T23:18:32.550

扩展方法是添加到静态类的静态函数，编译器可以允许您将其公开为另一种类型的实例方法。例如，假设我想在类中添加一个名为“ `MakeInvisible()`”的函数，该函数`Control`可以使其不可见（忽略这样一个方法已经存在于“ `Hide()`”中的事实......）。我会这样做。

```
public static class ControlExtensionClass
{
    public static void MakeInvisible(this Control control)
    {
        control.Visible = false;
    }
} 
```

如果我在引用的程序集中的某个地方有这个类，那么我可以在任何地方执行此操作..

```
Control c;

c.MakeInvisible(); 
```

' `this`' 关键字是使它成为扩展方法的原因。这告诉编译器将此方法添加到`Control`类中，并提供对指定变量中实体的引用。

# php - 将 html 字符转换回 Flash 中的文本 - AS3

> ID：783932
> 
> 赞同：3
> 
> 时间：2009-04-23T23:12:43.110
> 
> 标签：php, xml, flash, actionscript-3, htmlspecialchars

我需要生成一个可编辑的 xml 文件来向 Flash 网站提供内容。

我正在使用 html 表单生成我的文件，`htmlspecialchars`例如：

```
 $currentItem = htmlspecialchars(stripslashes($currentItem)); 
```

这是为了防止 xml 条目会产生错误**"XML Parsing Error: not well-formed"**，例如

```
<entry title="Words & Things">
---------------------^ 
```

它的副作用是使 flash 文件显示内容的 html 代码，而不是正确的字符。

将代码读入 Flash 文件 (as3) 后，有没有一种好方法可以将代码转换回来？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T23:25:01.770

也许尝试：

```
public function htmlUnescape(str:String):String
{
    return new XMLDocument(str).firstChild.nodeValue;
} 
```

（参见： [http](http://www.razorberry.com/blog/archives/2007/11/02/converting-html-entities-in-as3/) ://www.razorberry.com/blog/archives/2007/11/02/converting-html-entities-in-as3/ ）

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-23T23:26:14.997

使用`html_entity_decode`：[http ://us.php.net/manual/en/function.html-entity-decode.php](http://us.php.net/manual/en/function.html-entity-decode.php)

# c# - 在 MVVM 应用程序中存储应用程序设置/状态的位置

> ID：783934
> 
> 赞同：27
> 
> 时间：2009-04-23T23:13:05.010
> 
> 标签：c#, .net, wpf, unit-testing, mvvm

我是第一次尝试 MVVM，非常喜欢职责分离。当然，任何设计模式都只能解决很多问题——不是全部。所以我试图弄清楚在哪里存储应用程序状态以及在哪里存储应用程序范围的命令。

假设我的应用程序连接到特定的 URL。我有一个 ConnectionWindow 和一个 ConnectionViewModel ，它们支持从用户那里收集这些信息并调用命令来连接到该地址。下次应用程序启动时，我想在不提示用户的情况下重新连接到同一个地址。

到目前为止，我的解决方案是创建一个 ApplicationViewModel，它提供一个命令来连接到特定地址并将该地址保存到某个持久存储中（实际保存的位置与这个问题无关）。下面是一个缩写的类模型。

应用程序视图模型：

```
public class ApplicationViewModel : INotifyPropertyChanged
{
    public Uri Address{ get; set; }
    public void ConnectTo( Uri address )
    { 
        // Connect to the address
        // Save the addres in persistent storage for later re-use
        Address = address;
    }

    ...
} 
```

连接视图模型：

```
public class ConnectionViewModel : INotifyPropertyChanged
{
    private ApplicationViewModel _appModel;
    public ConnectionViewModel( ApplicationViewModel model )
    { 
        _appModel = model; 
    }

    public ICommand ConnectCmd
    {
        get
        {
            if( _connectCmd == null )
            {
                _connectCmd = new LambdaCommand(
                    p => _appModel.ConnectTo( Address ),
                    p => Address != null
                    );
            }
            return _connectCmd;
        }
    }    

    public Uri Address{ get; set; }

    ...
} 
```

所以问题是这样的：ApplicationViewModel 是处理这个问题的正确方法吗？您还可以如何存储应用程序状态？

**编辑：**我也想知道这如何影响可测试性。使用 MVVM 的主要原因之一是能够在没有主机应用程序的情况下测试模型。具体来说，我有兴趣深入了解集中式应用程序设置如何影响可测试性以及模拟依赖模型的能力。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-29T17:00:35.917

我通常对具有一个视图模型直接与另一个视图模型通信的代码有一种不好的感觉。我喜欢这样的想法，即模式的 VVM 部分应该基本上是可插入的，并且该代码区域内的任何内容都不应取决于该部分中是否存在其他任何内容。这背后的原因是，如果不集中逻辑，就很难定义责任。

另一方面，根据您的实际代码，可能只是 ApplicationViewModel 命名错误，它不会使模型可以访问视图，因此这可能只是名称的错误选择。

无论哪种方式，解决方案都归结为责任分解。在我看来，您需要实现三件事：

1.  允许用户请求连接到一个地址
2.  使用该地址连接到服务器
3.  坚持那个地址。

我建议您需要三个班级而不是两个班级。

```
public class ServiceProvider
{
    public void Connect(Uri address)
    {
        //connect to the server
    }
} 

public class SettingsProvider
{
   public void SaveAddress(Uri address)
   {
       //Persist address
   }

   public Uri LoadAddress()
   {
       //Get address from storage
   }
}

public class ConnectionViewModel 
{
    private ServiceProvider serviceProvider;

    public ConnectionViewModel(ServiceProvider provider)
    {
        this.serviceProvider = serviceProvider;
    }

    public void ExecuteConnectCommand()
    {
        serviceProvider.Connect(Address);
    }        
} 
```

接下来要决定的是地址如何到达 SettingsProvider。您可以像现在一样从 ConnectionViewModel 传递它，但我并不热衷于此，因为它增加了视图模型的耦合，并且 ViewModel 没有责任知道它需要持久化。另一种选择是从 ServiceProvider 拨打电话，但我觉得这也不应该是 ServiceProvider 的责任。事实上，除了 SettingsProvider 之外，它不像任何人的责任。这让我相信设置提供者应该监听连接地址的变化并在没有干预的情况下保持它们。换句话说，一个事件：

```
public class ServiceProvider
{
    public event EventHandler<ConnectedEventArgs> Connected;
    public void Connect(Uri address)
    {
        //connect to the server
        if (Connected != null)
        {
            Connected(this, new ConnectedEventArgs(address));
        }
    }
} 

public class SettingsProvider
{

   public SettingsProvider(ServiceProvider serviceProvider)
   {
       serviceProvider.Connected += serviceProvider_Connected;
   }

   protected virtual void serviceProvider_Connected(object sender, ConnectedEventArgs e)
   {
       SaveAddress(e.Address);
   }

   public void SaveAddress(Uri address)
   {
       //Persist address
   }

   public Uri LoadAddress()
   {
       //Get address from storage
   }
} 
```

这引入了 ServiceProvider 和 SettingsProvider 之间的紧密耦合，如果可能的话，您希望避免这种情况，我会在这里使用 EventAggregator，我在回答[这个问题时已经讨论过](https://stackoverflow.com/questions/798964/wpf-mvvm-correct-way-to-fire-event-on-view-from-viewmodel/799079#799079)

为了解决可测试性问题，您现在对每种方法的作用有了非常明确的期望。ConnectionViewModel 将调用 connect，ServiceProvider 将连接，SettingsProvider 将持续存在。要测试 ConnectionViewModel，您可能希望将与 ServiceProvider 的耦合从类转换为接口：

```
public class ServiceProvider : IServiceProvider
{
    ...
}

public class ConnectionViewModel 
{
    private IServiceProvider serviceProvider;

    public ConnectionViewModel(IServiceProvider provider)
    {
        this.serviceProvider = serviceProvider;
    }

    ...       
} 
```

然后，您可以使用一个模拟框架来引入一个模拟的 IServiceProvider，您可以检查它以确保使用预期的参数调用了 connect 方法。

Testing the other two classes is more challenging since they will rely on having a real server and real persistent storage device. You can add more layers of indirection to delay this (for example a PersistenceProvider that the SettingsProvider uses) but eventually you leave the world of unit testing and enter integration testing. Generally when I code with the patterns above the models and view models can get good unit test coverage, but the providers require more complicated testing methodologies.

Of course, once you are using a EventAggregator to break coupling and IOC to facilitate testing it is probably worth looking into one of the dependency injection frameworks such as Microsoft's Prism, but even if you are too late along in development to re-architect a lot of the rules and patterns can be applied to existing code in a simpler way.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-28T19:13:23.547

如果您没有使用 MV-VM，解决方案很简单：您将这些数据和功能放入您的应用程序派生类型中。Application.Current 然后让您访问它。如您所知，这里的问题是 Application.Current 在对 ViewModel 进行单元测试时会导致问题。这就是需要解决的问题。第一步是将自己与具体的应用程序实例解耦。通过定义一个接口并在您的具体应用程序类型上实现它来做到这一点。

```
public interface IApplication
{
  Uri Address{ get; set; }
  void ConnectTo(Uri address);
}

public class App : Application, IApplication
{
  // code removed for brevity
} 
```

现在下一步是通过使用控制反转或服务定位器来消除 ViewModel 中对 Application.Current 的调用。

```
public class ConnectionViewModel : INotifyPropertyChanged
{
  public ConnectionViewModel(IApplication application)
  {
    //...
  }

  //...
} 
```

现在，所有“全局”功能都通过可模拟的服务接口 IApplication 提供。您仍然不知道如何使用正确的服务实例构建 ViewModel，但听起来您已经在处理这个问题了？如果您正在那里寻找解决方案，Onyx（免责声明，我是作者）可以在那里提供解决方案。您的应用程序将订阅 View.Created 事件并将自身添加为服务，框架将处理其余部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T23:55:46.470

是的，你在正确的轨道上。当您的系统中有两个控件需要通信数据时，您希望以尽可能解耦的方式进行。有几种方法可以做到这一点。

在 Prism 2 中，它们有一个类似于“数据总线”的区域。一个控件可能会使用添加到总线的键生成数据，并且任何想要该数据的控件都可以在该数据更改时注册回调。

就个人而言，我已经实现了我称之为“ApplicationState”的东西。它具有相同的目的。它实现了 INotifyPropertyChanged，系统中的任何人都可以写入特定的属性或订阅更改事件。它不如 Prism 解决方案通用，但它有效。这几乎就是您创建的。

但是现在，您遇到了如何传递应用程序状态的问题。执行此操作的老派方法是使其成为单例。我不是这个的忠实粉丝。相反，我有一个接口定义为：

```
public interface IApplicationStateConsumer
{
    public void ConsumeApplicationState(ApplicationState appState);
} 
```

树中的任何可视化组件都可以实现这个接口，并简单地将 Application 状态传递给 ViewModel。

然后，在根窗口中，当 Loaded 事件被触发时，我会遍历可视化树并查找需要应用程序状态的控件 (IApplicationStateConsumer)。我把 appState 交给他们，我的系统就被初始化了。这是一个穷人的依赖注入。

另一方面，Prism 解决了所有这些问题。我有点希望我可以回去使用 Prism 重新架构......但是对于我来说，成本效益有点太晚了。

# sql - 将 Microsoft Access 连接到 Delphi 7 时尝试执行 SQL 查询时提示用户名和密码

> ID：783940
> 
> 赞同：1
> 
> 时间：2009-04-23T23:14:16.350
> 
> 标签：sql, delphi, ms-access

作为我大学课程的一部分，我被要求为一家商店设计和创建 HCI。其中一部分是将 Delphi 7 连接到 MS Access 并运行 SQL 查询。我将数据库连接到 Delphi，但是当我运行程序并输入查询时，它会提示我输入用户名和密码以访问数据库。有人对发生的事情有任何想法吗？我为想法难住了！

任何帮助是极大的赞赏！

安迪

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-23T23:22:42.243

简单的解决方案，将 TAdoDatabase 组件上的 LoginPrompt 设置为 FALSE。确保您的查询对象随后链接到数据库组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T21:53:28.590

您需要将 LoginPrompt 属性设置为 True，还需要实现 OnLogin 事件。在这种情况下，设置事件的 LoginParams 参数的用户名（如果有密码）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T20:10:32.513

令许多人感到困惑的事情之一是 Jet 用户级安全的工作方式。当您运行 Access 时，无论您是否知道，您都在登录。如果您在打开 MDB 时没有看到用户名/密码提示，那么您正在以没有密码的 ADMIN 用户身份登录。

因此，要打开任何 Jet MDB，您需要提供有效的用户名/密码对。如果您没有在管理员帐户上设置密码，您仍然需要提供没有密码的管理员用户名。

# c++ - 如何使用 glibc 的字符串实现在堆栈上分配 std::string？

> ID：783944
> 
> 赞同：19
> 
> 时间：2009-04-23T23:16:45.907
> 
> 标签：c++, memory, heap-memory, stdstring, stack-memory

```
int main(void)
{
   std::string foo("foo");
} 
```

我的理解是上面的代码使用了默认的分配器来调用new。因此，即使 std::string foo 是在堆栈上分配的，foo 内部的内部缓冲区也会在堆上分配。

如何创建一个完全在堆栈上分配的字符串？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-24T02:37:26.673

我最近想自己做这件事，发现以下代码很有启发性：

[Chronium 的 stack_container.h](http://src.chromium.org/viewvc/chrome/trunk/src/base/containers/stack_container.h?view=markup)

它定义了一个新的`std::allocator`，可以为 STL 容器的初始存储分配提供基于堆栈的分配。我最终找到了一种不同的方法来解决我的特定问题，所以我自己并没有真正使用代码，但也许它对你有用。请务必阅读代码中有关用法和警告的注释。

对于那些质疑这样做的实用性和合理性的人，请考虑：

*   通常，您先验地知道您的字符串具有合理的最大大小。例如，如果字符串要存储一个十进制格式的 32 位整数，您知道这样做不需要超过 11 个字符。在这种情况下，不需要可以动态增长到无限大小的字符串。
*   在许多情况下，从堆栈分配比从堆分配更快。
*   如果字符串被频繁地创建和销毁（假设它是常用实用函数中的局部变量），从堆栈而不是堆分配将避免在堆分配器中导致碎片化的搅动。对于使用大量内存的应用程序，这可能会改变游戏规则。

一些人评论说，使用基于堆栈的分配的字符串不会`std::string`好像这会以某种方式降低其效用。诚然，您不能互换使用这两者，因此您将无法将您`stackstring`的函数传递给期望`std::string`. 但是（如果你做对了），你将能够使用`stackstring`你现在使用的所有相同的成员函数`std::string`，比如`find_first_of()`，`append()`等等 `begin()`，并且`end()`仍然可以正常工作，所以你将能够使用许多STL 算法。当然，它不会是`std::string`最严格的意义上的，但它仍然是实际意义上的“字符串”，它仍然非常有用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-23T23:32:07.710

问题是`std::basic_string`分配器有一个模板参数。但`std::string`不是模板，也没有参数。

因此，您原则上可以使用`std::basic_string`使用堆栈上内存的分配器的实例化，但它不会是`std::string`. 特别是，您不会获得运行时多态性，并且您无法将生成的对象传递给期望`std::string`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T23:36:40.633

你不能。除了...

`std::string`是一个实例化

```
std::basic_string<class CharType, 
                  class Traits=char_traits<CharType>, 
                  class Allocator=allocator<CharType> > 
```

您可以想象定义一个使用[alloca](http://www.gnu.org/software/hello/manual/libc/Variable-Size-Automatic.html#Variable-Size-Automatic)进行内存管理的 Allocator 类。这只有在分配器本身以及`basic_string`直接或间接调用它的方法都是`inline`. 使用此分配器创建的`basic_string`对象不会**是**a `std::string`，但它会（大部分）表现得像它。但是，对于有限的收益，这将是相当多的工作。具体来说，使用此类从函数返回值将是职业限制的举动。

我不知道您或其他任何人**为什么**要这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T23:23:27.687

我怀疑做这样的事情会很难做，不知道你为什么要这样做？要完全在堆栈上分配某些内容，编译器需要在编译时知道该事物的确切大小 - 在您的示例中，它不仅需要知道`std::string`元数据的大小，还需要知道字符串数据本身的大小. 这不太灵活，您可能需要不同的字符串类型，具体取决于您想要包含在其中的字符串数据的大小 - 并不是说​​不可能做到，只是它会使事情变得有点复杂。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-04-23T23:23:57.357

*   std::string 将始终使用 new/delete 管理它的内部存储。
*   不知道为什么您的问题包含*glibc 的字符串实现*。*c++ 标准库的字符串实现与glibc*无关。
*   将字符串存储在堆栈上的唯一方法是在堆栈上使用 C char 数组（就像 Shhnap 概述的那样）。但这可能不是你想要的:-)

# actionscript-3 - FlexBuilder 到 FDT 的迁移

> ID：783962
> 
> 赞同：1
> 
> 时间：2009-04-23T23:24:06.310
> 
> 标签：actionscript-3, autocomplete, migration, flexbuilder, fdt

我是 FDT 的新手，我想将一些（动作脚本）项目从 FlexBuilder 移到 FDT。

我注意到 FDT 可以从 FlexBuilder 读取 .actionscriptProperties，因此只需将工作区设置为我的 FlexBuilder 工作区即可获得项目，当前项目打开，其余项目关闭，这很棒。

我在路上遇到了一个错误：

“打开编辑器时出错。id com.adobe.flexbuilder.editors.actionscript.ActionScriptEditor 没有编辑器描述符”

这是有道理的...我最后使用的编辑器是来自 flexbuilder 的 as 编辑器，它在 fdt 中不存在...这里没什么大不了的。

我的问题是我没有让 FDT 自动完成工作，甚至对于默认的 AS3 类（Sprite、TextField 等）也没有。

我尝试右键单击项目，然后单击 Flash Project > Remove Flash Nature，然后再次单击 Flash Project > Add Flash Nature...但它似乎没有做任何事情。我什至不知道它有什么作用。我猜它告诉 FDT 将此项目视为 CS3 或 Flex 编译项目。

我还在 FDT 中从 SVN 导入了一个项目，并且没有自动完成功能。

那么，如何为在 FDT 中打开的 FlexBuilder Actionscript 项目获得出色的 FDT 自动完成功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-21T09:56:14.550

FDT 的当前版本附带一个“Flex 项目导入器”。在“导入 -> 导入 Flex Builder 3 项目”下的 Flash 资源管理器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T11:30:31.970

我想我必须对没有简单答案的答案感到满意。像这样在 fdt 中打开一个 flexproject 并让一切正常运行，这不是懒人的选择。

所以我猜答案是使用导出/导入。

# c# - 哪个更好，多次使用 console.writeline() 或将输出保存在 stringbuilder 上并调用 console.writeline 一次？

> ID：783963
> 
> 赞同：5
> 
> 时间：2009-04-23T23:24:59.600
> 
> 标签：c#

哪个更快？哪个使用更少的内存？

```
Console.WriteLine("string1")
Console.WriteLine("string2")
Console.WriteLine("string3")
Console.WriteLine("stringNth") 
```

或者

```
StringBuilder output = new StringBuilder();
output.AppendLine("string1");
output.AppendLine("string2");
output.AppendLine("string3");
output.AppendLine("stringNth");
Console.WriteLine(output); 
```

谢谢，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T23:28:45.427

首先。

控制台类将把它缓冲到标准输出流。

使用第二个选项，您尝试创建自己的缓冲区，然后再次缓冲。

把它发挥到极致 - 这样做 10,000,000 次。您的 StringBuilder 最终会占用您所有的内存，而控制台只会吐出输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T23:28:43.930

找出答案的最好方法是对每个迭代进行 10,000 次迭代，看看哪个更快。我怀疑它们在性能方面几乎相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-22T15:12:03.550

由于这是一个已有 7 年历史的问题，因此这里需要更清楚地添加我的答案。

Console.WriteLine 会更慢。但它会消耗更少的内存。第二个将占用更多内存，但速度会快得多。

一些统计数据：使用 Console.Writeline 写入 100,000 大约需要 30 秒。使用 String builder 只需不到一秒钟。

如果字符串很小，那么内存不会成为问题，使用第二种方法会更好。

# wpf - WPF - 将鼠标悬停在一个元素上会显示另一个元素中的内容

> ID：783965
> 
> 赞同：3
> 
> 时间：2009-04-23T23:25:32.907
> 
> 标签：wpf

我想实现一种效果，我可以将鼠标悬停在 Button 上并让 TextBlock 更新其内容（通过绑定）。更复杂的是，Button 是 ItemsControl/DataTemplate 中定义的众多按钮之一。TextBlock 超出了 ItemsControl 的范围。

问题的一些简化标记如下：

```
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition />
    <RowDefinition />
  </Grid.RowDefinitions>
  <ItemsControl Grid.Row="0">
    <ItemsControl.ItemTemplate>
      <DataTemplate>
        <Button Content="{Binding Title}"
                Command="{Binding Command}" />    
      </DataTemplate>
    </ItemsControl.ItemTemplate>
  </ItemsControl>
  <TextBlock x:Name="TitleTextBox" Grid.Row="1" />
</Grid> 
```

在这个例子中，我可能想将数据项的“Title”属性绑定到 TextBlock 的“Text”属性。

我假设我想点击按钮的 IsMouseOver，但我似乎无法正确连接它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T14:23:59.810

我不相信没有一些代码你就能够完成这个......但是，你不需要使用代码隐藏。“行为”可以很好地解决这个问题（老派的[附加行为](http://blogs.msdn.com/bencon/archive/2006/07/26/more-advanced-attached-property-use-the-ramora-pattern.aspx)，或者更现代的[混合行为](http://blogs.msdn.com/expression/archive/2009/03/23/an-introduction-to-behaviors-triggers-and-actions.aspx)）。以下是使用附加行为修改后的标记可能看起来的样子：

```
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition />
    <RowDefinition />
  </Grid.RowDefinitions>
  <ItemsControl x:Name="Buttons" Grid.Row="0" ext:Hover.TrackChildItems="true">
    <ItemsControl.ItemTemplate>
      <DataTemplate>
        <Button Content="{Binding Title}"
                Command="{Binding Command}" />
      </DataTemplate>
    </ItemsControl.ItemTemplate>
  </ItemsControl>
  <TextBlock x:Name="TitleTextBox"
             Grid.Row="1"
             Text="{Binding ElementName=Buttons, Path=ext:Hover.Item.Content}" />
</Grid> 
```

这里附加的行为“Hover.TrackChildItems”用于监视适当的鼠标事件，并将只读的“Hover.Item”附加属性设置为被悬停的控件。编写行为应该足够简单，并留给您。

**编辑**：要为项目设置事件处理程序，首先要做的事情很简单：遍历 Items 属性中的项目并添加处理程序。

```
Mouse.AddMouseEnter(item, OnMouseEnter); 
```

这适用于静态内容，但动态（在运行时添加和删除）内容将因此丢失。因此，接下来您必须跟踪对 Items 属性的更改。

```
((INotifyCollectionChanged)Items).CollectionChanged += OnItemsChanged; 
```

在 CollectionChanged 处理程序中添加和删除项目时，根据需要添加或删除鼠标事件处理程序。

还有另一种解决方案。为此，从 ItemsControl 创建一个新的 HoverTrackingItemsControl。在这个控件中重写GetContainerForItemOverride 方法返回一个新的HoverTrackingItem，它处理MouseEnter/MouseLeave 来通知父HoverTrackingItemsControl。这个解决方案可能更容易实现，尽管它确实需要一个专门的控件，而 Behavior 解决方案更通用，可以与任何 ItemsControl 类型（ItemsControl、ListBox、ComboBox 等）一起使用。

# unicode - 在数据库表中存储货币符号

> ID：783971
> 
> 赞同：6
> 
> 时间：2009-04-23T23:27:44.103
> 
> 标签：unicode, firebird, currency

我们使用 firebird 作为我们的数据库。我们如何在数据库中存储货币符号。我们应该使用哪个字符集或通常的最佳实践是什么？

例如，存储“$”或“¥”会直接显示，但更复杂的符号不会正确显示在数据库表中，即“₡”不会存储在数据库中。

这种事情通常被认为是“最佳实践”。

编辑-
让我指定我们使用的语言是 C#。我怀疑 UTF8 会是答案，但是我们如何将字符存储在数据库中，我们是使用 Unicode、Hex 还是 Decimal 等价的......还是只使用字符？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T01:40:22.787

### 这种方法的问题

如果您需要输出货币文本，我建议您不要存储与货币数据关联的货币符号。即使符号存储在另一列中并且您根据需要将其拉出。更好的方法是存储货币数据的区域/语言环境，然后使用区域默认格式格式化货币。如果您使用的任何语言/平台都没有基于语言环境的货币功能，我仍然认为这是一种更好的方法。在这种情况下，您将在一些应用程序逻辑中进行格式化，然后将其显示给用户。

主要原因是在不同的地区和语言环境中，不仅符号不同，符号的位置和货币本身的格式也不同。还要考虑是否需要区分不同类型的美元——也许在某些时候你会想要指出美元金额是美元、港币、澳元等。

### 货币示例

```
 1.234,56€ - Euro (Germany)
€ 1.234,56  - Euro (Netherlands)
€ 1,234.56  - Euro (Ireland)
  123,456円 - Yen (Japan)
  123,456￥ - Yen (Japan) - yes there are two different currency marks! 
```

### 其他资源

*   我在 MSDN 网站上找到了一篇关于[货币全球化](http://msdn.microsoft.com/en-us/goglobal/bb688126.aspx)的好文章，有助于更好地解释这个问题。
*   这是针对欧元的每个区域设置的不同[格式的站点。](http://www.evertype.com/standards/euro/formats.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T23:38:09.133

我会指出两个主要的陷阱：

首先，确保您的数据库正确安装为 utf-8。一些数据库强制您在安装时选择此选项，而另一些则在模式/用户创建时选择。

其次，确保您使用的编程语言支持 utf-8。众所周知，php 会导致字符串操作和 utf-8 出现问题。

firebird 的 create database 语句如下所示：

**确保至少使用 2.0 版**的 firebird，这是第一个支持 utf-8 的版本。

```
 CREATE DATABASE <database> 
      USER <username> 
      PASSWORD <password> 
      PAGE_SIZE <pagesize> 
      DEFAULT CHARACTER SET UTF8 
```

或者，您可以使用

```
 CREATE TABLE money (
       SYMBOL VARCHAR(50) CHARACTER SET UTF8 ) 
```

编辑：澄清要存储的内容：您完全存储屏幕上出现的字符。很可能您可以将它们从任何程序剪切/粘贴到您的数据库或 sql 语句中。无需费力地转换为 int/hex/oct/ascii。

Edit2：当然，您不存储完全格式化的数字，而只存储单一货币符号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T00:08:50.213

也可能是字体问题，有些字体没有所有稀有的 utf-8 字符。例如，Arial 缺少它。“Lucida Sans Unicode”肯定有它。尝试在您的查看程序中设置“Lucida Sans Unicode”。

# c# - 如何在现有项目中实施 SOLID 原则

> ID：783974
> 
> 赞同：21
> 
> 时间：2009-04-23T23:28:09.733
> 
> 标签：c#, design-patterns, solid-principles

对于这个问题的主观性，我深表歉意，但我有点卡住了，我希望得到以前必须处理过这个问题的任何人的一些指导和建议：

我有（现在变成了）一个用 C# 2.0 编写的非常大的 RESTful API 项目，而且我的一些类变得很可怕。我的主要 API 类就是一个例子——有几十个成员和方法（可能接近数百个）。正如您可以想象的那样，它正在成为一场小噩梦，不仅要维护此代码，甚至只是**导航**代码都已成为一件苦差事。

我对 SOLID 原则相当陌生，而且我是设计模式的忠实粉丝（但我仍处于可以**实现**它们的阶段，但还不足以知道何时**使用**它们——在不那么明显的情况下） .

我需要将我的班级缩小规模，但我不知道如何最好地做到这一点。我的 StackOverflow 同事能否建议他们采用现有代码单体并将它们缩小到大小的方法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-23T23:52:21.797

**单一职责原则**——一个类应该只有一个改变的理由。如果你有一个单一的类，那么它可能有不止一个改变的理由。*简单地*定义你改变的一个原因，并且尽可能的细化。我建议从“大”开始。将三分之一的代码重构到另一个类中。一旦你有了它，然后重新开始你的新课程。直接从一个班级升到 20 个班级太令人生畏了。

**开放/封闭原则**- 一个类应该对扩展开放，但对更改关闭。在合理的情况下，将您的成员和方法标记为虚拟或抽象。每个项目本质上都应该相对较小，并为您提供一些基本功能或行为定义。但是，如果您稍后需要更改功能，您将能够*添加*代码，而不是*更改*代码以引入新的/不同的功能。

**Liskov 替换原则**- 一个类应该可以替换它的基类。在我看来，这里的关键是正确地继承。如果你有一个巨大的 case 语句，或者两页 if 语句检查对象的派生类型，那么你违反了这个原则，需要重新考虑你的方法。

**接口隔离原则**——在我看来，这个原则非常类似于单一职责原则。它仅适用于高级（或成熟）类/接口。在大型类中使用此原则的一种方法是让您的类实现一个*空*接口。接下来，将使用您的类的所有类型更改为接口的类型。这会破坏你的代码。但是，它将准确地指出你是如何消费你的课程的。如果您有三个实例，每个实例都使用自己的方法和属性子集，那么您现在知道需要三个不同的接口。每个接口都代表一组功能，以及改变的一个理由。

**依赖倒置原则**——父/子寓言让我明白了这一点。想想一个父类。它定义了行为，但不关心肮脏的细节。这是可靠的。然而，一个子类是关于细节的，不能依赖它，因为它经常变化。你总是想依赖父母，负责的班级，而不是相反。如果您有一个依赖于子类的父类，那么当您更改某些内容时会出现意外行为。在我看来，这与 SOA 的思维方式相同。服务合同定义了输入、输出和行为，没有任何细节。

当然，我的观点和理解可能不完整或错误。我建议向那些掌握了这些原则的人学习，比如鲍勃叔叔。[对我来说，他的书《敏捷原则、模式和 C# 实践》](https://rads.stackoverflow.com/amzn/click/com/0131857258)是一个很好的起点。另一个很好的资源是[Hanselminutes 上的 Bob 叔叔](http://www.hanselman.com/blog/HanselminutesPodcast145SOLIDPrinciplesWithUncleBobRobertCMartin.aspx)。

当然，正如[Joel 和 Jeff 所指出的](https://blog.stackoverflow.com/2009/02/podcast-41/)，这些是原则，而不是规则。它们将成为帮助指导你的工具，而不是土地的法律。

**编辑：**

我刚刚发现这些看起来非常有趣的[SOLID 截屏视频。](http://www.dimecasts.net/Casts/ByTag/SOLID%20Principle)每一个大约是 10-15 分钟。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T00:01:55.643

Martin Fowler有一本经典著作[——重构：改进现有代码的设计。](https://rads.stackoverflow.com/amzn/click/com/0201485672)

在那里，他提供了一组设计技术和决策示例，以使您现有的代码库更易于管理和维护（这也是 SOLID 原则的全部内容）。尽管重构中有一些标准例程，但它是一个非常自定义的过程，一个解决方案不能应用于所有项目。

单元测试是这个过程成功的支柱之一。您确实需要用足够的代码覆盖率覆盖现有的代码库，这样您就可以确保在更改它时不会破坏内容。实际上，使用具有模拟支持的现代单元测试框架将鼓励您进行更好的设计。

有像 ReSharper（我最喜欢的）和 CodeRush 这样的工具来帮助进行繁琐的代码更改。但这些通常是微不足道的机械东西，做出设计决策是一个复杂得多的过程，并且没有那么多工具支持。使用类图和 UML 会有所帮助。实际上，这就是我要开始的。试着理解已经存在的东西并为其带来一些结构。然后，您可以从那里就不同组件之间的分解和关系做出决定，并相应地更改您的代码。

希望这有助于重构愉快！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T23:33:29.597

这将是一个耗时的过程。您需要阅读代码并找出不符合 SOLID 原则的部分并重构为新类。[使用像 Resharper ( http://www.jetbrains.com](http://www.jetbrains.com) )这样的 VS 插件将有助于重构过程。

理想情况下，您将对自动化单元测试有很好的覆盖，这样您就可以确保您的更改不会给代码带来问题。

**更多信息**

在主 API 类中，您需要识别相互关联的方法并创建一个更具体地表示该方法执行的操作的类。

例如

假设我有一个 Address 类，其中包含单独的变量，其中包含街道号、名称等。这个类负责插入、更新、删除等。如果我还需要以特定方式为邮政地址格式化地址，我可以一个名为 GetFormattedPostalAddress() 的方法，它返回格式化的地址。

或者，我可以将此方法重构为一个名为 AddressFormatter 的类，该类在其构造函数中接受一个 Address 并具有一个名为 PostalAddress 的 Get 属性，该属性返回格式化的地址。

这个想法是将不同的职责分成不同的类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T23:48:48.343

当遇到这种类型的事情时，我所做的（我很容易承认我以前没有使用过 SOLID 原则，但从我对它们的了解很少，它们听起来不错）是查看现有的代码库连接性的观点。本质上，通过查看系统，您应该能够找到一些内部高度耦合（许多频繁交互）但外部松散耦合（很少不频繁交互）的功能子集。通常，任何大型代码库中都有一些这样的部分；他们是切除的候选人。从本质上讲，一旦您确定了您的候选人，您就必须列举他们与整个系统外部耦合的点。这应该让您对所涉及的相互依赖程度有一个很好的了解。通常涉及相当多的相互依赖。评估子集及其连接点以进行重构；经常（但并非总是）最终会出现一些可以增加解耦的清晰结构重构。着眼于这些重构，使用现有的耦合来定义允许子系统与系统的其余部分一起工作所需的最小接口。在这些接口中寻找共性（通常，您会发现比您预期的更多！）。最后，实施您确定的这些更改。使用现有的耦合来定义允许子系统与系统的其余部分一起工作所需的最小接口。在这些接口中寻找共性（通常，您会发现比您预期的更多！）。最后，实施您确定的这些更改。使用现有的耦合来定义允许子系统与系统的其余部分一起工作所需的最小接口。在这些接口中寻找共性（通常，您会发现比您预期的更多！）。最后，实施您确定的这些更改。

这个过程听起来很糟糕，但在实践中，它实际上非常简单。请注意，这不是通往完全完美设计系统的路线图（为此，您需要从头开始），但它肯定会降低整个系统的复杂性并提高代码的可理解性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-02-07T11:59:10.423

OOD - 面向对象设计

**SOLID** - 一流的设计

**单一职责原则**- SRP - 由鲍勃叔叔介绍。方法、类、模块只负责做单一的事情（一个单一的任务）

**开放/封闭原则**- OCP - 由 Bertrand Meyer 介绍。方法、类、模块对扩展开放，对修改关闭。使用继承、抽象、多态、扩展、包装的力量。[[Java 示例]](https://stackoverflow.com/a/59220073/4770877)，[[Swift 示例]](https://stackoverflow.com/a/60905233/4770877)

[[Liskov 替换原则]](https://stackoverflow.com/a/64789005/4770877) - LSP - 由 Barbara Liskov 和 Jeannette Wing 介绍。子类型可以替换超类型而没有副作用

**接口隔离原则**- ISP - Bob 大叔介绍的。你的界面应该尽可能小

[[依赖倒置原则(DIP)]](https://stackoverflow.com/a/66808672/4770877) - DIP - Bob大叔介绍的。内部类、层不应该依赖于外部类、层。例如，当您有`aggregation`[^([About])](https://stackoverflow.com/a/65967271/4770877)依赖项时，您应该使用一些抽象/接口。[[DIP vs DI vs IoC]](https://stackoverflow.com/a/67401178/4770877)

关于包/模块（.jar、.aar、.framework）的 6 条原则：

什么放在一个包里

*   发布重用等效性
*   共同的关闭
*   常见的重用

包之间的耦合

*   非循环依赖
*   稳定的依赖
*   稳定的抽象

[【面向协议编程（POP）】](https://stackoverflow.com/a/70314267/4770877)

# jquery - 使用 Rails 和 jQuery 处理内联编辑表单的好方法

> ID：783975
> 
> 赞同：5
> 
> 时间：2009-04-23T23:28:26.143
> 
> 标签：jquery, ruby-on-rails

我有一个项目列表，显示在一系列 DIV 中。当有人点击“编辑”链接时，我想用一个表单替换 div，让他们以一种很好的方式编辑该项目的内容。

我正在尝试考虑处理此问题的理想方法。我是否为列表中的每个项目创建一个隐藏的编辑表单，并挂钩编辑链接以显示它，如下所示：

```
<div>
    <a href="#">edit</a> Item One
    <div id="edit_1202" class="editform">Edit form goes here</div>
</div>
<div>
    <a href="#">edit</a> Item Two
    <div id="edit_2318" class="editform">Edit form goes here</div>
</div> 
```

或者有没有更好的方法来获取数据并将表单的 HTML 插入正确的位置？请记住，我使用的是 jQuery，所以我不能使用原型助手。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-01-12T23:51:29.750

最简单的答案是，通常情况下，Ryan Bates 的[Railscasts](http://railscasts.com/)。他有一集关于在[Rails 中使用 jQuery](http://railscasts.com/episodes/136-jquery)。虽然他没有具体介绍它，但可以从他展示的基础知识中制作出一个相当优雅的解决方案。

在我的情况下，编辑链接将被覆盖以向服务器发送 ajax 请求，服务器返回 javascript 以使用表单编辑代码构建部分。简单，一旦你知道怎么做！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T02:01:15.980

我建议使用某种插件。这是一个非常标准的功能，为什么要重新编码某人已经写过的东西？查看[jeditable](http://www.appelsiini.net/projects/jeditable)插件。

看了你的评论，是的。如果你想让所有东西都可以一次编辑，我可能会用你描述的 jQuery 来做到这一点。我认为我没有见过一次处理多个字段的插件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T07:51:56.323

我认为这就是您要查找的内容：jquery 就地编辑插件

[http://davehauenstein.com/code/jquery-edit-in-place/example/](http://davehauenstein.com/code/jquery-edit-in-place/example/) [http://code.google.com/p/jquery-in-place-editor/](http://code.google.com/p/jquery-in-place-editor/)

我最近用过它，它工作的地方。查看上面第一个链接中的示例。

如果这真的不是您想要的，您可能希望使用 jquery ajax 加载加载远程页面。然后你就可以添加任何你想要的表单元素。

[http://docs.jquery.com/Ajax/load](http://docs.jquery.com/Ajax/load)

```
$('.yourlinkid').click(function(){
   var id = $(this).attr('id');
   $("div#editThisDiv").load("/events/editAjax/" + id);
}); 
```

# windows - 如何使用 Win32 API 获取 (Java) 进程的退出代码？

> ID：783976
> 
> 赞同：2
> 
> 时间：2009-04-23T23:28:29.967
> 
> 标签：windows, winapi, jvm, status, termination

如何从启动此 JVM 的 Windows 程序中获取 JVM 退出代码（调用中的“状态”值：System.exit(status)）？我尝试使用 ShellExecute() 调用的结果，但结果 (42) 与状态的实际值无关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T01:45:00.153

使用 ShellExecuteEx 而不是 ShellExecute 启动外部应用程序。

在调用 ShellExecuteEx 之前，在 ShellExecuteEx 函数的参数中启用 SEE_MASK_NOCLOSEPROCESS 标志。然后，您将在 ShellExecuteEx 函数参数的 hProcess 字段中接收到已启动进程的句柄。

ShellExecuteEx： http: [//msdn.microsoft.com/en-us/library/bb762154 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb762154(VS.85).aspx)

然后，使用 WaitForSingleObject 函数或任何其他 WaitFor* 函数等待外部应用程序终止。

WaitForSingleObject：http: [//msdn.microsoft.com/en-us/library/ms687032.aspx](http://msdn.microsoft.com/en-us/library/ms687032.aspx)

然后，使用 GetExitCodeProcess 函数读取外部进程的退出代码。

GetExitCodeProcess： http: [//msdn.microsoft.com/en-us/library/ms683189 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms683189(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T23:59:23.683

该函数的[MSDN 文档](http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx)清楚地表明它不会从被调用的应用程序返回退出代码。

> 如果函数成功，则返回大于 32 的值。如果函数失败，则返回指示失败原因的错误值。为了向后兼容 16 位 Windows 应用程序，返回值被转换为 HINSTANCE。然而，这不是一个真正的 HINSTANCE。它只能转换为 int 并与 32 或以下错误代码进行比较。

在 MSDN 上似乎也有一些用于[获取退出状态的示例代码。](http://msdn.microsoft.com/en-us/library/aa446835(VS.85).aspx)

# css - 黑莓粗体 CSS

> ID：783980
> 
> 赞同：1
> 
> 时间：2009-04-23T23:29:10.557
> 
> 标签：css, blackberry, mobile, rim-4.6

我正在查看 4.6 版的 CSS 文档并在文档中看到：“在 BlackBerry Device Software 4.6 版中，BlackBerry 浏览器提供对 CSS 2.1 的全面支持，不包括伪元素和动态伪类、系统字体和生成的内容。”

我正在为粗体运行 4.6.0.190 模拟器，但我无法使用任何填充。我的其他 CSS 工作正常，例如字体系列和字体大小，但仅此而已。任何与盒子模型（边距，填充）和定位相关的东西都不起作用，根据文档，它应该。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T23:34:01.013

我注意到在 BlackBerry 模拟器上进行开发的一件事是，与实际设备相比，它在很多情况下都非常不准确。

不幸的是，我没有列出哪些东西可以工作或与模拟器上的物理设备不一样，但是我注意到了一些小的差异，这使得它（在我看来）几乎无用依赖于开发.

许多这些差异与盒模型有关。例如，真正的 BlackBerry Bold 上的填充正常运行，而模拟器提供的填充比它应该提供的多，导致渲染错误。

与盒子模型相关的东西在我尝试过的模拟器上确实有效，但是我遇到了一些问题，尤其是与元素宽度有关的问题，但与您描述的问题不同。

我的建议是让您亲身体验 BlackBerry Bold，以真正了解一切。

# powershell - 在 Windows PowerShell 中更改路径分隔符

> ID：783984
> 
> 赞同：19
> 
> 时间：2009-04-23T23:29:50.277
> 
> 标签：powershell

是否有可能让 PowerShell 始终输出`/`而不是输出`\`？例如，我希望 get-location 的输出为 C:/Documents and Settings/Administrator。

**更新**

感谢使用替换的示例，但我希望这能够在全球范围内发生（例如制表符完成等）。根据 Matt 的观察，分隔符是由[System.IO.Path.DirectorySeparatorChar](http://msdn.microsoft.com/en-us/library/system.io.path.aspx)定义的，它在实践中出现并且从文档中是只读的，我猜这是不可能的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-24T03:41:35.320

这是个好问题。底层 .NET 框架将其显示为 System.IO.Path.DirectorySeparatorChar，它是一个读/写属性，所以我认为您可以这样做：

```
[IO.Path]::DirectorySeparatorChar = '/' 
```

...这似乎成功了，除非您随后键入以下内容：

```
[IO.Path]::DirectorySeparatorChar 
```

...它告诉你它仍然是'\'。这就像它没有“抓住”一样。哎呀，我什至不确定 PowerShell 是否尊重该特定价值，即使它正在发生变化。

我想我会发布这个（冒着它实际上没有回答你的问题的风险），以防它帮助其他人找到真正的答案。我确信这与 DirectorySeparatorChar 字段有关。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-24T00:19:28.127

用。。。来代替 ”/”。

```
PS C:\Users\dance2die> $path =  "C:\Documents and Settings\Administrator"
PS C:\Users\dance2die> $path.Replace("\", "/")
C:/Documents and Settings/Administrator 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T00:58:14.947

您可以创建一个过滤器（或函数），您可以将路径通过管道传输到：

```
PS C:\> filter replace-slash {$_ -replace "\\", "/"}
PS C:\> Get-Location | replace-slash
C:/ 
```****