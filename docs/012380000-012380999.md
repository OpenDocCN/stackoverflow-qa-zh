# StackOverflow 问答 12380000-12380999

# c# - 如何以编程方式创建 .xsn (InfoPath) 文件

> ID：12380000
> 
> 赞同：2
> 
> 时间：2012-09-12T01:11:25.373
> 
> 标签：c#, xslt, infopath-2007

我们有一个第 3 方组件，它将 INPUT 作为 .xsn (InfoPath2007) 文件并提供预先确定的输出。这一切都很好，直到我们的一位客户决定不再使用 MS-InfoPath，因此即使我们的第 3 方组件也无法运行，因为我们无法创建 xsn 文件（这些文件是由人类 InfoPath 用户创建的，直到现在，直到 InfoPath 在他们的组中停止使用）...所以我们面临的挑战是创建这些简单的（文本框、下拉列表、日期选择器和复选框控件）类似 InfoPath 的表单——.XSN 文件以编程方式。这可能吗？是否有任何 API 或基于对象模型的函数可用于此任务。我们的团队主要是 C# 开发人员。我们目前的分析表明，与.XSN 的清单、XML、J 脚本部分有关的文件在经过仔细编码后可能是可以实现的...... 然而 XSL（与布局相关的部分）似乎是一场豪赌。任何有关此主题的指针将不胜感激。

> 更新（因为问题陈述似乎还不清楚）：
> 我们不想将 InfoPath 表单转换为任何 HTML 或类似格式。现在，我们需要以 .xsn 文件格式以编程方式创建一些简单的（使用已知数据预先确定的控件类型）InfoPath 表单。我们希望以编程方式完成此操作，因为早些时候它是由不再订阅 InfoPath 许可证的人类客户完成的，并且出于各种 HR 原因排除了雇用另一个人来执行此操作的可能性。所以这个“以编程方式”创建的 xsn 文件被输入到这个第 3 方组件中。然后这个第 3 方组件读取 xsn-input 内的各个部分并对其进行操作，将其转换为输出 custom-file-frmat 以便自定义“工作流组件”继续工作......所以希望你得到更大的现在的照片。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-04T03:14:41.650

是的，可以自动创建 InfoPath 模板表单。XSN 只不过是一个扩展名为 .xsn 的压缩文件 (.CAB)。

要进一步了解 CAB 文件的内容以及它们的作用，请点击以下链接：

[表单和表单模板的初学者指南](http://office.microsoft.com/en-us/infopath-help/a-beginner-s-guide-to-forms-and-form-templates-HA001155963.aspx)

以下是可以进一步帮助您的链接。

[Microsoft Cabinet 软件开发工具包](http://support.microsoft.com/kb/310618)

[通过 C# 程序打开 CAB 的相关问答](https://stackoverflow.com/questions/8533105/minimum-c-sharp-code-to-extract-from-cab-archives-or-infopath-xsn-files-in-mem)

# python - 在 Python 中向不同的用户显示不同的数据

> ID：12380002
> 
> 赞同：0
> 
> 时间：2012-09-12T01:12:14.093
> 
> 标签：python

我正在用 Python 制作一个（相当）简单的纸牌游戏，我已经为游戏设置了一切，我只需要一种方法来处理多个用户，并向用户显示他们的东西（手中的牌）重新分配给。我看过一些关于 Twisted 的回复，但这似乎并没有解决我的问题，至少它是如何呈现的。我正在寻找类似的东西 -

```
print player1cards to player1
print player2cards to player2 
```

但需要任何格式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:21:38.803

好吧，这里明显的答案是有一个类`Player`：

```
class Player:
     playercards = [] 
```

另一种方法是为每个玩家分配一个名字：

```
class Player:
     name = "" 
```

然后`Gameserver`上课：

```
class Gameserver:
    cards = {'Player1':['4Clubs', 'QClubs'], .....}

    def getCards(name):
        return cards[name] 
```

然后你可以做这样的事情：

```
gameserver = GameServer()

#Initialize and blablabla
........

x = Player("Player1")
x.showHand() 
#the line above would basically do the following:
#print gameserver.getCards(x.name()) 
```

# ruby-on-rails-3 - Rails 3 如何减少查询

> ID：12380013
> 
> 赞同：1
> 
> 时间：2012-09-12T01:14:29.303
> 
> 标签：ruby-on-rails-3, activerecord

```
c = Conversation.joins(:messages).random
>> Conversation Load (8.1ms)  SELECT `conversations`.* FROM `conversations` INNER JOIN `messages` ON `messages`.`conversation_id` = `conversations`.`id` ORDER BY created_at DESC, RAND() LIMIT 1 
```

数数：

```
c.messages.count
>> (5.7ms)  SELECT COUNT(*) FROM `messages` WHERE `messages`.`conversation_id` = 74 
```

长度：

```
c.messages.length
>> Message Load (1.2ms)  SELECT `messages`.* FROM `messages` WHERE `messages`.`conversation_id` = 82 
```

如何不执行上述附加查询？我以为我已经使用 INNER JOIN 加入了随机对话的消息，但是执行了一个新查询来计算这些结果？

第二个问题是尝试获取具有特定 user_id 的所有加入消息：

```
u = User with id 27 # has messages in 'c' results above
c.messages.where('user_id = ?', u.id).all
>> Message Load (5.3ms)  SELECT `messages`.* FROM `messages` WHERE `messages`.`conversation_id` = 82 AND (user_id = 27) 
```

我使用 select 来执行此操作而无需其他查询：

```
c.messages.select { |msg| msg.user_id == u.id }
>> returns messages without query logged 
```

我仍然很感激我可以如何减少或优化这些查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:34:17.563

尝试使用`includes`而不是`joins`避免 n+1 问题。
Railscast #181 由 Ryan Bates 撰写，[http:](http://railscasts.com/episodes/181-include-vs-joins?view=asciicast) //railscasts.com/episodes/181-include-vs-joins?view=asciicast以简单的方式解释了差异。

# filepicker.io - 文件选择器拖放小部件大小

> ID：12380014
> 
> 赞同：4
> 
> 时间：2012-09-12T01:14:53.547
> 
> 标签：filepicker.io

有没有办法指定默认拖放窗格的大小：

```
<input type="filepicker-dragdrop"/> 
```

理想情况下，我想要更大的 Javascript 拖放窗格，带有一个用于手动上传的按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T01:29:32.117

使用该`data-fp-drag-class`物业。您只需要定义自己的 css 类。 [https://developers.filepicker.io/docs/web/#widgets-drag](https://developers.filepicker.io/docs/web/#widgets-drag)

[http://jsfiddle.net/66z9K/](http://jsfiddle.net/66z9K/)

# python - 如何在python中动态创建属性？

> ID：12380016
> 
> 赞同：2
> 
> 时间：2012-09-12T01:15:09.273
> 
> 标签：python

我有这样的课：

```
class User:
    def __init__(self, uid):
        userinfo = json.load(urlopen(passportapi + 'user/' + uid)) 
```

此类将从远程 api 加载用户信息并为此类设置相应的属性，以便我可以通过以下方式访问这些属性：

```
print user.username
print user.group_id 
```

有什么方法可以实现吗？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T01:42:28.357

```
import json

api_result = '{"username":"wawa","age":20}'

class User(object):
    def __init__(self, api_result):
        userinfo = json.loads(api_result)
        self.__dict__.update(userinfo)

import unittest

class DefaultTestCase(unittest.TestCase):
    def test_default(self):
        user = User(api_result)
        self.assertEqual(user.username, 'wawa')
        self.assertEqual(user.age, 20)

if __name__ == '__main__':
    unittest.main() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-12T01:18:12.800

您可以使用以下功能执行此类操作`setattr`：

```
>>> class A(object):
    pass
>>> a = A()
>>> setattr(a, 'val', 4)
>>> a.val
4 
```

在您的情况下，假设您解析的 json 文件提供了某种键值对（如字典），您可以遍历这些，然后`setattr`调用`self`; 像这样的东西（假设`userinfo`是一个字典）：

```
class User:
    def __init__(self, uid):
        userinfo = json.load(urlopen(passportapi + 'user/' + uid))
        for key, value in userinfo.iteritems():
            setattr(self, key, value) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T01:31:29.453

假设您的 JSON 请求返回一个 Python 字典：

```
class User:
    def __init__(self, uid):
        self.__dict__.update(json.load(urlopen(passportapi + 'user/' + uid))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T03:50:37.150

有时我喜欢比“更新”提供的更多的封装和控制。我可能会像这样完成你想要做的事情：

```
class User(object):                                                             
    def __init__(self, api_result):                                             
        self.userinfo = json.loads(api_result)                                  

    def __getattr__(self, name):                                                
        if name in self.userinfo: return self.userinfo[name]                    
        raise AttributeError 
```

我认为此方法将允许您执行其他操作，例如过滤某些关键字并引发自定义异常以访问您的数据。

# .net - 为什么 .NET 使用 SIMD 而不是 x87 进行并非 SIMD 固有的数学运算？

> ID：12380017
> 
> 赞同：9
> 
> 时间：2012-09-12T01:15:11.670
> 
> 标签：.net, assembly, compiler-construction, simd, x87

这是一个好奇的问题，比什么都重要。我正在查看此代码反汇编（C#，64 位，发布模式，VS 2012 RC）：

```
 double a = 10d * Math.Log(20d, 2d);
000000c8  movsd       xmm1,mmword ptr [00000138h] 
000000d0  movsd       xmm0,mmword ptr [00000140h] 
000000d8  call        000000005EDC7F50 
000000dd  movsd       mmword ptr [rsp+58h],xmm0 
000000e3  movsd       xmm0,mmword ptr [rsp+58h] 
000000e9  mulsd       xmm0,mmword ptr [00000148h] 
000000f1  movsd       mmword ptr [rsp+30h],xmm0 
            a = Math.Pow(a, 6d);
000000f7  movsd       xmm1,mmword ptr [00000150h] 
000000ff  movsd       xmm0,mmword ptr [rsp+30h] 
00000105  call        000000005F758220 
0000010a  movsd       mmword ptr [rsp+60h],xmm0 
00000110  movsd       xmm0,mmword ptr [rsp+60h] 
00000116  movsd       mmword ptr [rsp+30h],xmm0 
```

...并发现编译器在这里没有对日志使用 x87 指令（Power 使用日志），这很奇怪。当然，我不知道调用位置的代码是什么，但我知道 SIMD 没有 Log 功能，这使得这个选择更加奇怪。此外，这里没有任何东西是并行化的，那么为什么是 SIMD 而不是简单的 x87？

顺便说一句，我还发现没有使用 x87 [FYL2X](http://www.website.masmforum.com/tutorials/fptute/fpuchap11.htm)指令很奇怪，该指令专为第一行代码中所示的情况而设计。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T12:38:48.110

这里有两个不同的点。首先为什么编译器使用 SSE 寄存器而不是 x87 浮点堆栈作为函数参数，其次为什么编译器不只使用可以计算对数的单条指令。

不使用对数指令最容易解释，x86 中的对数指令被定义为精确到 80 位，而您使用的是只有 64 位的双精度指令。计算精度为 64 位而不是 80 位的对数要快得多，而且速度的提高足以弥补必须在软件中而不是在硅片中进行的计算。

SSE 寄存器的使用更难以以令人满意的方式解释。简单的答案是 x64 调用约定要求将函数的前四个浮点参数传递给`xmm0`through `xmm3`。

下一个问题当然是为什么调用约定告诉你这样做而不是使用浮点堆栈。答案是本机 x64 代码根本很少使用 x87 FPU，而是使用 SSE 代替。这是因为 SSE 中的乘法和除法更快（又是 80 位与 64 位的问题），并且 SSE 寄存器的操作速度更快（在 FPU 中，您只能访问堆栈顶部，并旋转 FPU 堆栈通常是现代处理器上最慢的操作，实际上有些处理器专门为此目的增加了一个额外的流水线阶段）。

# excel - VBA 中的样本协方差与总体协方差

> ID：12380020
> 
> 赞同：1
> 
> 时间：2012-09-12T01:15:36.040
> 
> 标签：excel, excel-2010, vba

我想知道如何在我的 VBA 代码中使用示例协方差。

我可以`Application.WorksheetFunction.Covar(array_1,array_2)`用来获取总体协方差，但是样本协方差呢？我意识到公式栏中有`COVARIANCE.S`和`COVARIANCE.`P 函数。如何在我的 VBA 代码中使用它们？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T01:39:15.253

在 xl2010 你当然可以使用
`Application.WorksheetFunction.Covariance_P`

`Evaluate`或者速记`[]`是你计算函数的朋友

```
Sub Test()
MsgBox Application.WorksheetFunction.Covariance_P([a1:a3], [b1:b3])
MsgBox [Covariance.P(a1:a3, b1:b3)]
End Sub 
```

# ios - 在特定视图或页面重新启动应用程序

> ID：12380021
> 
> 赞同：0
> 
> 时间：2012-09-12T01:15:46.817
> 
> 标签：ios, cocoa-touch, restart

我在 Xcode 4 中编写了一个简单的 iPad 应用程序。当我退出应用程序然后返回应用程序时，它会从我退出前的最后一页开始。如何在每次重启时让应用在指定页面重启？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:47:13.587

在您的`AppDelegate.m`文件中查找方法`applicationDidBecomeActive:`（如下）。每当您的应用程序变为活动状态时都会调用它 - 通过启动或通过从后台返回。这是您用来恢复应用程序状态的事件 - 但具体情况取决于您的应用程序的设置方式。

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{
    // Restart any tasks that were paused (or not yet started) while 
    //the application was inactive. If the application was previously in the background,
    //optionally refresh the user interface.
} 
```

# java - 使用双精度的绝对值对 HashMap 进行排序

> ID：12380022
> 
> 赞同：1
> 
> 时间：2012-09-12T01:16:16.410
> 
> 标签：java, sorting, hashmap

我正在尝试`<Integer,Double>`使用 a`TreeMap`和 a对类型的哈希图进行排序`SortedMap`我想对 s 的绝对值进行排序，`Double`但我也想保留符号值（因此不存储为 unsigned `Double`）。

下面是我正在使用的代码，但是我没有得到我期望的值，大概是由于使用了`hashcode()`任何人都可以指出如何解决这个问题？

```
Map<Integer,Double> termWeights = new HashMap<Integer,Double>();    
SortedMap sortedData = new TreeMap(new ValueComparer(termWeights));
System.out.println(termWeights);
sortedData.putAll(termWeights);
System.out.println(sortedData);

class ValueComparer implements Comparator {
    private Map _data = null;

    public ValueComparer(Map data) {
        super();
        _data = data;
    }

    public int compare(Object o1, Object o2) {
        Double e1 = Math.abs((Double) _data.get(o1));
        Double e2 = Math.abs((Double) _data.get(o2));
        int compare = e2.compareTo(e1);
        if (compare == 0) {
            Integer a = o1.hashCode();
            Integer b = o2.hashCode();
            return b.compareTo(a);
        }
        return compare;
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:23:52.033

> 你能举一个预期和实际结果的例子吗？
> 
> Sorted map: {17=1.644955871228835, 0=-1.029545248153297, 10=-5.291765636407169E-4, 9=-3.331976978545177E-4, 1=-2.7105555587851366E-4, 2=-2.7105555587851366E-4, 7=-2.0897436261984377E -4, 8=-1.305197184270594E-5, 3=0.0, 4=0.0, 5=0.0, 6=0.0, 11=0.0, 12=0.0, 13=0.0, 14=0.0, 15=0.0, 16=0.0 , 18=0.0, 19=0.0, 20=0.0, 21=0.0, 22=0.0}

那么问题是什么？

这看起来从大到小正确排序。

但我会避免在决胜局辅助比较器中使用 hashCode，因为您需要它永远不会为不同的输入返回相同的值。在这种情况下，它可以工作，因为您在 Integer 上调用它，其中 hashCode 只返回相同的 int。但是，如果您在地图中使用 Long 或 String 键，则会发生冲突。而是直接比较两个键。

最后，您在开始使用比较器后不得更改权重。这将导致不一致的 TreeMap。

# android - 无法通过 HTTP POST 发布

> ID：12380023
> 
> 赞同：0
> 
> 时间：2012-09-12T01:16:35.280
> 
> 标签：android, http-post

我正在尝试使用名称值键对通过 HTTP Post 发布数据。但我无法发帖。帖子网址是[http://mastercp.openweb.co.za/api/dbg_dump.asp](http://mastercp.openweb.co.za/api/dbg_dump.asp) 。我应该在发布时也包含一些标题吗？谢谢

```
public class MainActivity extends Activity {
    Button ok;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.profile);
        ok=(Button)findViewById(R.id.but_signup_login);

        ok.setOnClickListener(new OnClickListener() {

            public void onClick(View arg0) {

                System.out.println("Clicked");
        DownloadWebPageTask task = new DownloadWebPageTask();
        task.execute(new String[] { "http://mastercp.openweb.co.za/api/dbg_dump.asp" });}});
    }

    public void postData() {
        // Create a new HttpClient and Post Header
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://mastercp.openweb.co.za/api/dbg_dump.asp");

        System.out.println("Clicked again");
        try {
            // Add your data
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(34);
            String amount ="Ashish";
            nameValuePairs.add(new BasicNameValuePair("User_Type", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Email", "ash@gmail.com"));
            nameValuePairs.add(new BasicNameValuePair("User_Email_In", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Pass", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Mobile", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Mobile_In", amount));
            nameValuePairs.add(new BasicNameValuePair("User_ADSL", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Org", amount));
            nameValuePairs.add(new BasicNameValuePair("User_VAT", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Name", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Surname", amount));
            nameValuePairs.add(new BasicNameValuePair("User_RegNo", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Address", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Town", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Code", amount));
            nameValuePairs.add(new BasicNameValuePair("User_State", amount));
            nameValuePairs.add(new BasicNameValuePair("User_Country", amount));
            nameValuePairs.add(new BasicNameValuePair("User_ADSL", amount));
            nameValuePairs.add(new BasicNameValuePair("User_ADSL_Address", amount));
            nameValuePairs.add(new BasicNameValuePair("Payment_CC_Alt", amount));
            nameValuePairs.add(new BasicNameValuePair("Payment_Type", amount));
             nameValuePairs.add(new BasicNameValuePair("CProfile", amount));
            nameValuePairs.add(new BasicNameValuePair("COrder", amount));
            nameValuePairs.add(new BasicNameValuePair("Debit_Name", amount));
            nameValuePairs.add(new BasicNameValuePair("Debit_Bank", amount));
            nameValuePairs.add(new BasicNameValuePair("Debit_Number", amount));
            nameValuePairs.add(new BasicNameValuePair("Debit_Code", amount));
            nameValuePairs.add(new BasicNameValuePair("Debit_Type", amount));
            nameValuePairs.add(new BasicNameValuePair("TOS_Agree", amount));  
            nameValuePairs.add(new BasicNameValuePair("Code", amount));  
            nameValuePairs.add(new BasicNameValuePair("package_activation", amount));  
            nameValuePairs.add(new BasicNameValuePair("session", amount)); 
            nameValuePairs.add(new BasicNameValuePair("OnceOff", amount));  
            nameValuePairs.add(new BasicNameValuePair("submit-button", amount));  

            try {
                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            } catch (UnsupportedEncodingException e) {
               System.out.println("Unsupported Exception "+e);
                e.printStackTrace();
            }

        }  catch (Exception e) {
            System.out.println("  Exception last"+e);
            // TODO Auto-generated catch block
        }
    } 

    private class DownloadWebPageTask extends AsyncTask<String, Void, String> {
        @Override
        protected String doInBackground(String... urls) {
          String response = "";
          for (String url : urls) {

             postData(); 
          }

        return response;
      }
        @Override
        protected void onPostExecute(String result) {}
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:17:39.597

你的`postdata()`方法实际上并没有*做*这个帖子。您需要执行以下操作：

```
httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
HttpResponse response = httpclient.execute(httppost, new BasicHttpContext()); 
```

然后您可以处理响应（从检查 的值开始`response.getStatusLine().getStatusCode()`）。例如，如果您期望响应中包含字符串数据：

```
if (response.getStatusLine().getStatusCode() == 200) {
    BasicResponseHandler handler = new BasicResponseHandler();
    String data = handler.handleResponse(response);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:48:21.160

这是我关于实施 Restful 请求的个人清单：

1.  检查互联网许可
2.  检查 api 是否真的使用 Rest Client 工作
3.  检查网址是否正确
4.  检查端口号是否正确
5.  检查所需的标题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T01:27:08.260

这段代码对我帮助很大：

```
 /**
        * HTTP post request
        *
        * @param sUrl
        * @param ht
        * @return
        * @throws Exception
        */
        public static HttpData post(String sUrl, Hashtable<String, String> ht) throws Exception {
                String key;
                StringBuffer data = new StringBuffer();
                Enumeration<String> keys = ht.keys();
                while (keys.hasMoreElements()) {
                        key = keys.nextElement();
                        data.append(URLEncoder.encode(key, "UTF-8"));
                        data.append("=");
                        data.append(URLEncoder.encode(ht.get(key), "UTF-8"));
                        data.append("&amp;");
                }
                return HttpRequest.post(sUrl, data.toString());
        } 
```

在此处查看完整课程：

[http://moazzam-khan.com/blog/?p=490](http://moazzam-khan.com/blog/?p=490)

# wordpress - Wordpress 自定义帖子类型，带有两个图片库

> ID：12380024
> 
> 赞同：0
> 
> 时间：2012-09-12T01:16:39.703
> 
> 标签：wordpress, media, custom-post-type

我需要在 wordpress 中创建具有以下要求的自定义帖子类型：

*   标题
*   字幕
*   简要描述;简介
*   详细描述
*   外部图片库
*   内部图片库

我无法为此创建两个单独的图像库。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T01:49:46.867

[https://gist.github.com/897503](https://gist.github.com/897503)
试一试.. :D

# android - 删除其他片段后无法将新片段添加到 LinearLayout

> ID：12380027
> 
> 赞同：0
> 
> 时间：2012-09-12T01:16:53.097
> 
> 标签：android, android-layout, android-fragments

我有一些`LinearLayouts`旨在包含片段。我正在使用兼容性库片段、管理器等。当我尝试重绘内容时，`LinearLayouts`我首先删除所有片段，然后添加需要的内容。我不使用替换，因为我的理解是它并不总是按预期工作，无论如何我需要将多个片段添加回布局中。据我所知，下面的代码应该可以工作，但是当它执行时，所发生的只是原始片段消失了，但新片段没有出现。

相关代码如下：

```
public boolean onDrag(View v, DragEvent event) {
    int action = event.getAction();
    switch (action) {
    case DragEvent.ACTION_DRAG_ENTERED:
        Log.d(TAG, "ACTION_DRAG_ENTERED called on view: " + v + " with id: " + v.getId());
        handleActionDragEntered(v, event);
        break;
    default:
        break;
    }
    return true;
}

protected void handleActionDragEntered(View v, DragEvent event) {
    ArrayList<Integer> oldRow;
    switch (mState) {
    case TARGET_NOT_ENTERED:
        mState = State.TARGET_ENTERED_PARENT;
        mParentOld = mParentNew = (LinearLayout) v; //Save the parent row
        //Replace the drag view with a drop target. Need to lookup which row the parent row is.
        oldRow = mAdapter.replaceDragViewWithTarget(mDragView.getId(), 
                mRowIndices.get(mParentOld.getId()));
        redraw(mParentOld, oldRow, mAdapter.getIndiciesForRow(mRowIndices.get(mParentOld.getId())));
        break;
    case TARGET_ENTERED_PARENT:
        mState = State.TARGET_ENTERED_NEW_PARENT;
        mParentNew = (LinearLayout) v;
        oldRow = mAdapter.addDragViewToRow(mDragView, mRowIndices.get(mParentNew.getId()), getIndexInRow(event.getX(), v));
        redraw(mParentNew, oldRow, mAdapter.getIndiciesForRow(mRowIndices.get(mParentNew.getId())));
        break;
    default:
        Log.w(TAG, "Unhandled Action Drag Entered!");
    }
}

public void redraw(View v, ArrayList<Integer> oldRow, ArrayList<Integer> newRow) {
    FragmentManager fragmentManager = mParentActivity.getSupportFragmentManager();
    FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
    //fragmentTransaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
    for (int oldFragment : oldRow) {
        Log.d(TAG, "Removing fragment " + oldFragment);
        fragmentTransaction.remove(fragmentManager.findFragmentByTag(String.valueOf(oldFragment)));
    }
    fragmentTransaction.commit();
            fragmentManager.executePendingTransactions();
    fragmentTransaction = fragmentManager.beginTransaction();
    //fragmentTransaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
    for (int newFragment : newRow) {
        Log.d(TAG, "Adding fragment " + newFragment + " to row: " + v.getId());
        fragmentTransaction.add(v.getId(), mAdapter.getFragmentAtIndex(newFragment), String.valueOf(newFragment));
    }
    fragmentTransaction.commit();
} 
```

LogCat 中没有任何错误指示，代码中的所有日志语句都按预期报告值，包括来自片段的回调，通知他们正在创建视图。

**更新**

调用`invalidate()`视图容器并不能解决问题。

**更新 2**

根据来宾用户的建议，我尝试将重绘代码包装在`Runnable`视图上。目前我的重绘代码在 UI 线程上执行，所以我认为这本身没有必要，但也许它会让我深入了解我的问题可能是什么。我还编辑了上面的代码片段以包含 Wizetux 的建议以及更多负责调用重绘函数的代码。这一切都与Android的拖放组件有关。测试是在 Galaxy Nexus 4.1 设备上进行的，但是我尝试过的所有设备上的代码行为都是相同的。

**更新 3**

如果我删除删除事务并只执行添加事务，结果如预期，所以问题似乎与连续执行两个事务有关。Wizetux 的建议对我来说很有意义，所以我没有正确执行它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:39:54.120

您是否在提交删除事务后尝试在添加之前调用 fragmentManager.executePendingTransactions()。我想知道这些是否在经理执行过程中出现故障，因为它们在提交时并没有真正执行，而是放在队列中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T03:15:37.770

在尝试了发布者的所有（非常感谢）建议之后，似乎没有任何解决问题的方法。结果，我重新设计并重写了负责我的应用程序这一部分的代码，新的布局设计似乎没有问题。具体来说，没有`LinearLayout`片段的父母，而是直接使用 GridLayout 似乎可以解决问题。我仍然看不出这两种方法都行不通的任何原因，但我会选择可行的方法，尤其是因为少一层布局无论如何都会带来不错的性能提升。

# c# - 将表单作为引用传递给类，但我应该从哪里调用它？

> ID：12380028
> 
> 赞同：0
> 
> 时间：2012-09-12T01:17:01.567
> 
> 标签：c#, winforms, class

我想将我的表单作为引用传递给一个类，这样类对象就可以从表单访问公共方法。我已经在几个不同的地方尝试过，但每个地方都有一些限制。

有没有办法从事件外部实例化类，但仍以形式传递？

```
namespace MyApplication
{
    public partial class Form1 : Form
    {
        //If I instantiate the class here, the form seemingly doesn't exist yet 
        //and can't be passed in using "this."
        Downloader downloader = new Downloader(this);

        private void Form1_Load(object sender, EventArgs e)
        {
            //If I instantiate the class here, the form can be passed in, but the
            //class object can't be seen outside of this event.
            Downloader downloader = new Downloader(this);
        }

        private void downloadButton_Click(object sender, EventArgs e)
        {
            //If I instantiate the class here, the form can be passed in, but the
            //class object can't be seen outside of this event.
            Downloader downloader = new Downloader(this);

            downloader.dostuff();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T01:20:30.913

你快到了。将其更改为：

```
namespace MyApplication
{
    public partial class Form1 : Form
    {
        private Downloader downloader;

        private void Form1_Load(object sender, EventArgs e)
        {
            this.downloader = new Downloader(this);
        }

        private void downloadButton_Click(object sender, EventArgs e)
        {
           downloader.Whatever();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T01:20:50.273

```
namespace MyApplication
{
    public partial class Form1 : Form
    {
        Downloader downloader;
        // either of the following two will work
        private void Form1_Load(object sender, EventArgs e)
        {
            downloader = new Downloader(this);
        }

        private void downloadButton_Click(object sender, EventArgs e)
        {
            downloader = new Downloader(this);
        }
    }
} 
```

# visa - 使用 GPIB 进行安捷伦电源编程

> ID：12380029
> 
> 赞同：-1
> 
> 时间：2012-09-12T01:17:20.910
> 
> 标签：visa, gpib

查看电源文档中提供的示例。通过在 C# 中添加两个库 AgilentRMLib 和 VisComLib 来完成编程。当我尝试通过选择添加参考->安捷伦 VISA COM 资源管理器 1.0 添加 AgilentRMLib 时，参考中显示错误。

我尝试直接从 Program Files 添加 agtRM.dll。错误仍然存​​在。有没有人遇到过这个问题？有什么解决方案吗？您是否有任何其他方法可以使用 Agilent IO 从 PC 对电源进行编程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-23T00:13:11.693

当您使用 GPIB 协议时，最好使用 GPIB 库和包装器，然后使用本机 SCPI 命令进行编码。这样，您的软件将更加依赖于您的应用程序，您几乎可以控制一切。使用 VISA 接口，您不必担心另一层，但通过这种方法，您可以直接有效地控制您的设备。我与 VISA 合作了几年，但经过那段艰苦的工作，现在我可以通过直接 GPIB 编程来构建我的测量系统。您可以从 NI 或 Agilent 的网站上找到所需的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-26T19:18:43.057

如果您不介意使用 VBA，此代码可以帮助您完成您正在尝试做的事情，请确保它在参考中具有 VISA COM 488.2 格式化 I/O：

```
Public Sub TestVISA()
    Dim Dev_IO As VisaComLib.FormattedIO488
    Dim io_manager As VisaComLib.ResourceManager

'Start of Open GPIB port (or any VISA resource)
    Set io_manager = New VisaComLib.ResourceManager
    Set Dev_IO = New VisaComLib.FormattedIO488
    Set Dev_IO.IO = io_manager.Open("GPIB0::x::INSTR")    ' x is the GPIB address number of the Dev_IOument
    Set io_manager = Nothing
    Dev_IO.IO.Timeout = 10000  'set time out to 10 seconds, use this line to change timeout to any time out value per VISA spec
'End of Open GPIB port

'Send some SCPI command to the Dev_IOumnet
    Dev_IO.WriteString ("*IDN?")
    MsgBox ("Connected to: " & Dev_IO.ReadString)

'Close the port upon completion
    Dev_IO.IO.Close
    Set Dev_IO = Nothing 'release the object

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T04:51:42.987

我能够使用 VisaComLib(GlobMgr.dll) 来使用 C# 编程语言对 GPIB 进行编程。pdf[文件链接](http://www.htest.cz/download/manual_iolib_suite_connectivity_guide_May2006.pdf)！被用作参考。

# html - 自动水平滚动

> ID：12380034
> 
> 赞同：0
> 
> 时间：2012-09-12T01:17:44.613
> 
> 标签：html, css, button, scroll

这听起来很“菜鸟”，但我是 HTML/javascript/php 的新手，到目前为止，我一直在探索新事物。不过现在，我遇到了一个小问题。

我正在尝试制作一个带有很多按钮的 UI（它是一个按钮矩阵，5x24）。当浏览器最大化时，一切都很好，按钮在它们应该在的位置。但是，当浏览器调整为变窄（宽度变小）时，按钮会尝试通过相互叠加来保持可见。

我想知道如何让它自动出现水平滚动条。

我试过把所有东西都放在一个`<body>`标签里然后放，`style="width:100%;overflow:scroll;"`但是按钮仍然做他们做的事情，也就是说，当它们应该并排时，它们最终会彼此重叠......

非常感谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:24:32.123

问题是，`width: 100%`意味着父元素的全宽。为您的容器提供必要的宽度（in `px`，not `%`）以容纳所有按钮。比把它放在一个 div 中`overflow: auto`，它应该可以工作。

# c# - 异步 SSL 套接字

> ID：12380041
> 
> 赞同：2
> 
> 时间：2012-09-12T01:18:21.630
> 
> 标签：c#, sockets, ssl, client-server, sslstream

最近我正在创建一个异步 ssl 套接字类。我完成了它，它成功地通过了客户端的身份验证，但它没有正确接收到客户端发送的消息。

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net;
using System.Net.Sockets;
using System.Net.Security;
using System.Security.Authentication;
using System.Security.Cryptography.X509Certificates;
using System.IO;

public class Wrapper
{
    public byte[] buffer;
    public SslStream sslStream;
    public object connector;
}

public class Sock
{
    private Dictionary<string, byte> Connections;
    public event Action<Wrapper> AnnounceNewConnection;
    public event Action<Wrapper> AnnounceDisconnection;
    public event Action<byte[], Wrapper> AnnounceReceive;
    private Socket _sock;

    private X509Certificate certificate = X509Certificate.CreateFromCertFile("exportedcertificate.cer");

    public Sock(int port)
    {
        try
        {
            Connections = new Dictionary<string, byte>();
            _sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
            _sock.Bind(new IPEndPoint(IPAddress.Any, port));
            _sock.Listen(500);
            _sock.BeginAccept(AcceptConnections, new Wrapper());
        }
        catch (Exception e)
        {
            Console.WriteLine(e);
        }
    }

    private void AcceptConnections(IAsyncResult result)
    {
        Wrapper wr = (Wrapper)result.AsyncState;
        try
        {
            wr.sslStream = new SslStream(new NetworkStream(_sock.EndAccept(result), true));
            wr.sslStream.BeginAuthenticateAsServer(certificate, EndAuthenticate, wr);

            _sock.BeginAccept(AcceptConnections, new Wrapper());
        }
        catch (Exception e) { Console.WriteLine(e); }
    }

    private void EndAuthenticate(IAsyncResult result)
    {
        Wrapper wr = (Wrapper)result.AsyncState;
        try
        {
            wr.sslStream.EndAuthenticateAsServer(result);
            if (wr.sslStream.IsAuthenticated == true)
            {
                wr.buffer = new byte[65535];
                wr.sslStream.BeginRead(wr.buffer, 0, wr.buffer.Length, ReceiveData, wr);
                AnnounceNewConnection.Invoke(wr);
            }
        }
        catch (Exception e) { Console.WriteLine(e); }
    }

    private void ReceiveData(IAsyncResult result)
    {
        Wrapper wr = (Wrapper)result.AsyncState;
        try
        {
            int size = wr.sslStream.EndRead(result);
            byte[] buffer = new byte[size];
            Buffer.BlockCopy(wr.buffer, 0, buffer, 0, size);
            AnnounceReceive.Invoke(wr.buffer, wr);

            if (wr.sslStream.IsAuthenticated)
                wr.sslStream.BeginRead(wr.buffer, 0, wr.buffer.Length, ReceiveData, wr);
        }
        catch (Exception e) { Console.WriteLine(e); AnnounceDisconnection.Invoke(wr); }
    }
} 
```

所以在上面的代码中，当我调用`BeginRead`并尝试使用 `Console.WriteLine(Encoding.ASCII.GetString(arg1));`时，我只得到很多空行[注意我使用 MSDN 示例中的 ssl 客户端来测试我的服务器]

我真的很想知道为什么它没有正确接收到消息！

# java - 在 objectify 3.1 中使用 ConsistentErrorHandler 作为 Memcache 错误处理程序？

> ID：12380042
> 
> 赞同：0
> 
> 时间：2012-09-12T01:18:24.017
> 
> 标签：java, google-app-engine, memcached, objectify

有没有办法在objectify的3.1实现中使用ConsistentErrorHandler。我开始在我的应用程序中看到一些内存缓存错误，并希望默认行为是忽略这些异常。查看 appengine 上的此错误报告（[http://code.google.com/p/googleappengine/issues/detail?id=6236](http://code.google.com/p/googleappengine/issues/detail?id=6236)），似乎他们没有修复最初的错误，而是添加了一种忽略异常的方法如果设置了 ConsistentErrorHandler。

在创建 objectify 实例时，是否可以让 Objecitfy 将 ConsistentErrorHandler 设置为 memcache 处理程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T07:16:54.030

在 objectify google 组上得到答案：[https ://groups.google.com/forum/?fromgroups=#!searchin/objectify-appengine/memcache/objectify-appengine/HbggddpAka0/_9ODKTnwswcJ](https://groups.google.com/forum/?fromgroups=#!searchin/objectify-appengine/memcache/objectify-appengine/HbggddpAka0/_9ODKTnwswcJ)

# jquery - 使用后退和前进浏览器按钮时单击事件触发

> ID：12380046
> 
> 赞同：0
> 
> 时间：2012-09-12T01:18:55.100
> 
> 标签：jquery, browser-history, hashchange, jquery-click-event

我正在使用单击事件来显示隐藏的内联 div。我目前正在使用 Ben Alman 的 Jquery hashchange 事件[http://benalman.com/projects/jquery-hashchange-plugin/](http://benalman.com/projects/jquery-hashchange-plugin/)以便向前和向后浏览器按钮将在 URL 中显示主题标签链接。问题是当你前进和后退时隐藏的 div 保持隐藏状态，我需要它们显示。

HTML：

```
<ul>
<li><a href="#link1">Link 1</a></li>
<li><a href="#link2">Link 2</a></li>
<li><a href="#link3">Link 3</a></li>
<li><a href="#link4"><Link 4</a></li>
</ul>

<div id="div1"></div>
<div id="div2"></div>
<div id="div3"></div>
<div id="div4"></div> 
```

脚本：

```
$("#link1").click(function() {
    $("#div1").fadeIn("400");
    $("#div2, #div3, #div4").hide(); 
});
$("#link2").click(function() {
    $("#div2").fadeIn("400");
    $("#div1, #div3, #div4").hide();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:50:13.373

如果您可以更改您的 hashchange 插件，我可以推荐 jQuery 地址。
见这里[http://www.asual.com/jquery/address/](http://www.asual.com/jquery/address/)

为了捕捉哈希变化，你写：

```
$.address.change(function(event) {
    // Your code here
}); 
```

这个 hashchange 函数的好处是插件确保它总是在**document.ready**之后被调用，所以你不必担心这件事。

**event.pathNames[0]**将是您需要的哈希值。您可以在 change hadnler 中使用它并显示所需的 div。

**请参阅此演示**（*我认为它完全符合您的需要。使用浏览器按钮检查*）：
[http ://www.asual.com/jquery/address/samples/api/](http://www.asual.com/jquery/address/samples/api/)

**示例用法：** [http://www.asual。 com/jquery/address/docs/#sample-usage](http://www.asual.com/jquery/address/docs/#sample-usage)

# asp.net - 突出显示选定的菜单项 dotnetnuke

> ID：12380049
> 
> 赞同：1
> 
> 时间：2012-09-12T01:19:29.867
> 
> 标签：asp.net, dotnetnuke-6

```
<%@ Register TagPrefix="dnn" TagName="LINKS" Src="~/Admin/Skins/Links.ascx" %>

<dnn:LINKS runat="server" id="LINKS1" CssClass="MenuLink" Alignment="Horizontal"
            Level="Root" ForceLinks="False" /> 
```

我有以下代码在我的 dotnetnuke 站点中生成菜单项。我需要更改所选菜单项的颜色或应用不同的 CSS，以便用户知道他们在网站上的位置。我尝试通过转到页面设置并在页面标题标签下使用 jquery 来执行此操作。它什么也没做。我如何能够突出显示或将不同的 CSS 应用于选定的菜单项？

我会感谢你们在这方面的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:58:44.157

我能够在下面的 url 的帮助下解决这个问题。

[jquery改变当前页面的背景颜色](http://learnedstuffs.wordpress.com/2012/05/24/jquery-highlighting-the-menu-item-for-the-current-page/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T00:01:54.340

可能为时已晚，但 DNN 将“.sel”CSS 样式动态应用于当前选定的菜单项。

有一个 PDF 漂浮在 DNN 站点的某个地方，其中详细说明了它（真的很难找到），或者使用开发人员工具（IE 中的 F12，或 Firefox 中的 Firebug 等）来查看应用于每个菜单项的样式。

因此，在您的 CSS 中添加如下内容：

```
.sel {
    color: #ABCDEF;
} 
```

编辑：对不起，这适用于导航菜单皮肤对象。当您有更多样式选项时，使用它可能会更好。

# sql - SQL 查询从表中选择 *，但返回 ID 列作为查找的用户名

> ID：12380051
> 
> 赞同：2
> 
> 时间：2012-09-12T01:19:35.670
> 
> 标签：sql, lookup, bugzilla

我正在使用 Bugzilla，我本质上想从“错误”数据库中的错误表中选择 *。但是，“assigned_to”列实际上包含整数值 (ID)，而不是带有用户名的字符串。

这些 ID 与“profiles”表（“userid”列）中的主键匹配，而我希望查询返回的字符串实际上存储在该表的“realname”列中。

如何修改此查询以捕获“错误”中的所有列，但对assigned_to 列执行查找并返回用户名？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T01:21:38.243

```
SELECT b.*, p.realname FROM bugs b
JOIN profiles p
ON b.assigned_to = p.userid 
```

# java - 在 Java Runtime Exec 中使用重定向运算符

> ID：12380054
> 
> 赞同：1
> 
> 时间：2012-09-12T01:20:35.407
> 
> 标签：java, windows

我有这个字符串，我在 Windows XP 的 JVM 中与 Runtime.exec() 一起使用。

`String cmd = encoderFull + " " + "-i " + originalFull + " "+ "-bitrate" + " " + bitrateVBR[i] + " " + "-bvhq"+ " " + "-avi " + outputFull + " " + "2>&1" + " " + "1>"+ outputFile + ".txt";`

不幸的是 '2>&1 1>output.txt' 不起作用。其余的还可以。有没有办法使用命令来创建这个文件？

再见，大卫

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T01:34:52.713

基本上，不 - Runtime.exec() 不支持您尝试做的事情。

请注意，Runtime.exec**不是**shell - 对于您显然正在使用的 exec(String)，它会标记字符串（以空格作为分隔符），并尝试将第一个标记作为程序执行，使用其余的标记作为该程序的参数。

因此，在您的情况下，重定向运算符将作为参数发送到由“encoderFull”变量命名的应用程序 - 它们不会像您期望的那样被 shell 解释，因为没有 shell。

据我所知，您在这里有两个选择：

1.  编写一个批处理文件（对于 Windows）或一个 shell 脚本（对于 *nix），执行您的应用程序并进行重定向。然后使用 Runtime.exec() 以批处理文件/shell 脚本作为参数调用 shell（cmd 或 sh，或者你有什么）

2.  从 Runtime.exec 创建的进程中读取输出流，并使用 java io 将内容写入相应的文件

我强烈推荐＃1而不是＃2

在继续之前，您可能还应该阅读这篇关于[“当 Runtime.exec() 不会 - 绕过与 Runtime.exec() 方法相关的陷阱”的](http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html)文章。

# python - 添加流派/歌曲名称/艺术家元数据的python icecast/shoutcast流代理？

> ID：12380061
> 
> 赞同：1
> 
> 时间：2012-09-12T01:21:52.553
> 
> 标签：python, metadata, shoutcast, icecast

我正在收听 3FM 流，但不幸的是它没有在其 aac/mp3/wma 流中提供音乐名称/艺术家信息。

所以我想写一个简单的python代理来将元数据添加到流中。元数据来自从 3FM 网站抓取 JSON 的定期爬虫。

知道我可以从哪里开始吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T11:49:18.643

您可以使用：[http](http://www.3fm.nl/data/dalet/dalet.xml) ://www.3fm.nl/data/dalet/dalet.xml获取元信息。您想如何构建元数据？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-29T05:13:16.757

有一种相当直接的方法来滑动元数据（在旧格式流的情况下）：

*   设置一个 Icecast 服务器来中继您选择的流。
*   运行你的 python（或其他）脚本来获取元数据并将更新发送到 Icecast。
    *   将传入元数据与当前元数据进行比较
    *   如果更改，使用元数据更新功能将数据推送到 Icecast

来自官方文档：

*元数据更新*

此功能为源客户端或任何外部程序提供更新特定挂载点的元数据信息的能力。

例子：

```
/admin/metadata?mount=/stream&mode=updinfo&song=ACDC+Back+In+Black 
```

需要进行身份验证，使用特定于挂载的源或一般管理员凭据。

遗留流的元数据是*一个*文本字段。“艺术家”、“标题”等没有单独的字段。这是这种传统流类型的限制。有些玩家遇到“-”时会分场。

如果使用 Ogg 封装（如 Vorbis 或 Opus）的正确流，则涉及更多，因为支持许多元数据字段，包括任意数据，甚至专辑封面。要注入这些东西，需要源客户端。Liquidsoap 可能很容易做到这一点。在未来（计划在 2.5 中）Icecast 也将支持 Ogg 流的所有字段的直接元数据更新。

PS：我知道这是一个老问题，但我认为值得记录下来以供将来参考。

# css - 如果使用 CDN，如何设置引导程序的 @baseFontSize？

> ID：12380062
> 
> 赞同：6
> 
> 时间：2012-09-12T01:22:09.373
> 
> 标签：css, twitter-bootstrap

[我通过公共 CDN](http://www.bootstrapcdn.com/)使用 v2.0.4 的Bootstrap 。

最近（2012 年 8 月 20 日）版本 2.1.0 发布，其中一项更改是[新的基本 font-size 和 line-height](https://github.com/twitter/bootstrap/wiki/Changelog)，实际上只是稍微大了一点。

我知道这是设置的`variables.less`，所以如果我使用的是预编译版本，我可能会被设置卡住 - 但是有没有什么好的方法可以覆盖东西并将基本字体大小“重置”为一些东西使用此 CDN 版本时更小，并且不必为我想要影响的每个元素指定字体大小覆盖？

`body{ font-size:.9em; }`不幸的是没有帮助。

2.0.4 渲染的 H2 字体大小：

[图片2.png http://img819.imageshack.us/img819/7048/picture2ww.png](http://img819.imageshack.us/img819/7048/picture2ww.png)

2.1.0 渲染的 H2 字体大小：

[图片1.png http://img687.imageshack.us/img687/8741/picture1qvc.png](http://img687.imageshack.us/img687/8741/picture1qvc.png)

旧的和新的压缩 CSS 以防万一有人想摆弄：

```
http://netdna.bootstrapcdn.com/twitter-bootstrap/2.0.4/css/bootstrap-combined.min.css 
```

和更新：

```
http://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.0/css/bootstrap-combined.min.css 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T02:21:29.313

@cwd

很明显你没有RTFM。尝试：

`http://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap-combined-for-cwd.min.css`

=P

![在此处输入图像描述](../Images/d5c759c4af5041d854d238d16ab2e52e.png)

# php - 在 TCPDF 库中编写 HTML

> ID：12380064
> 
> 赞同：1
> 
> 时间：2012-09-12T01:22:38.473
> 
> 标签：php, web-services, pdf, pdf-generation, tcpdf

我有 104 个 html 段落使用文本编辑器输入到我的数据库中。有些段落需要一页或一页半，而有些则只需要几行。当我尝试为整个集合生成 pdf 时，它给了我“服务器错误”，但是当我尝试打印几段时它做得很好。然后我尝试逐个增加段落数，但我遇到了 85 个段落。之后它给了我服务器错误。有谁知道如何解决这个问题？因为除了这些段落之外，我还有另一组 html 表格。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:01:47.413

我检查了服务器错误日志文件，然后我发现了错误，它是“/XXXXXXX/includes/tcpdf/tcpdf.php on line 5036 中的最大执行时间超过了 30 秒”。所以我使用设置执行时间

```
set_time_limit(180); 
```

它对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T02:34:50.017

检查您的服务器是否没有内存不足。TCPDF 在渲染时可能会使用大量内存

尝试

```
memory_limit = 64M 
```

在你的 php.ini 文件中..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T09:55:34.670

可能有执行时限的情况

```
set_time_limit(0); 
```

如果您在代码中添加它，最大执行时间将设置为无限制，并且 TCPDF 可以处理所有段落

# javascript - ThreeJS 将画布中的文本渲染为纹理，然后应用于平面？

> ID：12380072
> 
> 赞同：5
> 
> 时间：2012-09-12T01:24:22.117
> 
> 标签：javascript, html, canvas, webgl, three.js

我整天都在寻找一种在程序上生成带有文本的 2d 纹理的方法，以便我可以将它们作为纹理应用到平面上。基本上，我希望能够更改 WebGL 页面中显示的文本，而不必只使用图像编辑程序中制作的纹理。我的目标是能够像编辑完全 2d 页面一样轻松地编辑页面内容，只需编辑代码并 bam，它就在那里。

我见过的最有希望的方法是使用 CSS 在空白画布中渲染文本，将该画布用作 ThreeJS 非常容易制作的纹理，然后将该纹理应用到我可以放置在任何位置的平面上3d 环境。我试图通过使这个例子适应我的需要来实现这一点：http: [//jsfiddle.net/sSD65/28/](http://jsfiddle.net/sSD65/28/)

但是，我最终得到一个完全黑色的页面，表明某处有错误。一个我一生都无法找到并修复的错误。我有一种感觉，因为我缺乏使用 ThreeJS 的经验，实际上我缺乏使用 Javascript 的经验，所以我来这里寻求您的帮助。

我非常感谢我能在这里得到的任何帮助。这是该页面的链接，尽管我认为您无法在不将其托管在本地的情况下正确查看它，因为我是从那里的文件夹加载图像，但 Python 非常适合。导航到该文件夹​​后，只需在控制台中使用 Python -m SimpleHTTPServer，它将在本地托管它，以便您可以从“http://localhost:8000/homepage.html”访问它：[https://dl。 dropbox.com/u/40043006/WebGLTest.zip](https://dl.dropbox.com/u/40043006/WebGLTest.zip)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-12T07:55:16.840

这是一个将画布中的文本添加为​​纹理的简单代码：

```
//create image
var bitmap = document.createElement('canvas');
var g = bitmap.getContext('2d');
bitmap.width = 100;
bitmap.height = 100;
g.font = 'Bold 20px Arial';

g.fillStyle = 'white';
g.fillText(text, 0, 20);
g.strokeStyle = 'black';
g.strokeText(text, 0, 20);

// canvas contents will be used for a texture
var texture = new THREE.Texture(bitmap) 
texture.needsUpdate = true; 
```

它需要一些工作......比如将输出文本大小设置为画布的大小。

# .htaccess - 使用 htaccess从和其他引用中删除前导斜杠

> ID：12380074
> 
> 赞同：0
> 
> 时间：2012-09-12T01:24:32.863
> 
> 标签：.htaccess

我有一个开发服务器，我已将客户端旧站点的副本上传到：

```
/dev/name/old/ 
```

在旧网站中，有很多参考资料

```
/ 
```

例子：

```
/css/stylesheet.css
/js/script.js
/images/img.jpg 
```

所需结构：

```
/dev/name/old/css/stylesheet.css
/dev/name/old/js/script.js
/dev/name/old/images/img.jpg 
```

有没有办法或使用子目录中的 htaccess 文件将所有带有前导斜杠的引用重定向到子目录？

为重复的问题道歉，我尝试了许多解决方案但无济于事

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:10:09.087

您需要添加到所有客户旧站点的标题中：

```
<base href="/dev/name/old/"> 
```

否则，就无法区分来自旧站点的链接与来自当前站点的链接。

# windows - CreateTextfile() > 写入不起作用

> ID：12380075
> 
> 赞同：0
> 
> 时间：2012-09-12T01:24:53.123
> 
> 标签：windows, vbscript

当尝试使用以下代码将下面显示的文本写入文件时，VBScript 确实会传递“非法参数”消息。如果我将 resultStr 更改为一些测试文本，它会起作用。可能是什么问题呢？

```
Set resFile = fs.CreateTextfile(resFilePath, true)
resFile.write resultStr
resFile.close 
```

* * *

resultStr 的内容：

![样本](../Images/1dae459de04efe641c37e9ce33b28566.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:32:21.270

您的字符串看起来包含非 ASCII 字符。您需要传递一个额外的`True`参数来`CreateTextfile`使用 Unicode 编码（在 Windows 上可能是 UTF-16）打开文本文件。

如果要将 UTF-8 写入文件，请参阅[将 UTF8 文本写入文件](https://stackoverflow.com/questions/2840252/writing-utf8-text-to-file)。

# rest - 在 RESTful API 中处理版本控制的最佳（最兼容）方法是什么？

> ID：12380079
> 
> 赞同：1
> 
> 时间：2012-09-12T01:25:14.940
> 
> 标签：rest, versioning

> **可能重复：**
> [如何对 REST URI 进行版本控制](https://stackoverflow.com/questions/972226/how-to-version-rest-uris)

我是 REST-ful API 设计的新手，我似乎无法就如何以 REST-ful 风格实现 API 版本控制达成共识。我遇到的可能性包括：

*   基于 URL（例如`/myApi/version5/someCall`）

    这种方法对服务器和客户端都很好......但它似乎不是很 REST-ful（url 应该对应于资源，API 版本真的不是资源的一部分）

*   基于负载的（例如`$.ajax({data:{version:5, ...`）

    这种方法在兼容性方面效果很好，但是：

    A）服务器需要实际解析有效负载以确定版本（这往往会使版本检查逻辑“更深”地比它应该的）

    B）再一次，从我所知道的哲学来看，这不是很 REST-ful（据我所知，我发布的数据应该只是我想要创建的资源的数据）

*   基于标头（例如`Accept application/json;version=5`）

    这种方法是[在此处](http://publish.luisrei.com/articles/rest.html)提出的，我发现它是关于如何制作 REST-ful API 的绝佳资源。但是在这种特殊情况下，我一直遇到问题，因为无论我做什么，我似乎都无法让 jQuery 在标题中发送版本。

现在，我确信如果我尝试，我最终可以解决方法#3 中的 jQuery 问题，但这让我认为我可能会在基于标头的版本控制中走错路；如果我遇到问题，我们 API 的消费者似乎也会遇到问题。

因此，在创建 REST-ful API 时，谁能解释一下哪种版本控制方法：

*   A) 将与其他技术（浏览器、框架等）一起使用最好的

*   B) 最忠实地执行“REST-ful”理念

*   C）是最常见的（这个本身并不重要，但它确实往往是前两个的指标）

换句话说，在 REST-ful API 中处理版本控制的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T13:50:38.133

解决方案 1 看起来既实用又简单。供您参考 twitter( `api.twitter.com/2`) 和[linkedin](http://developer.linkedin.com/apis) ( `api.linkedin.com/v1`) 使用基于 URL 的版本控制，Google Data( `&v=1.0`) 使用基于有效负载。我的实践经验是基于 URL 的版本控制。

如果要进行分析，请检查此[api 目录](http://www.programmableweb.com/apis/directory/1?protocol=REST)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T01:53:52.093

我强烈建议解决方案 1，它既清晰又简单——不仅 StackOverFlow 也使用它：[https](https://api.stackexchange.com/2.1/questions?order=desc&sort=activity&site=stackoverflow) ://api.stackexchange.com/2.1/questions?order=desc&sort=activity&site=stackoverflow :)

# jquery - Magento 模块 GET 请求未收到

> ID：12380080
> 
> 赞同：0
> 
> 时间：2012-09-12T01:25:27.623
> 
> 标签：jquery, ajax, magento

我正在创建一个模块，该模块通过 GET 请求获取 SKU 并返回具有该产品某些属性的 JSON 对象。

我的 indexController 功能代码是这样的

```
public function pinboardgetitemsAction(){
    $sku = $_GET[sku];

    $product = Mage::getModel('catalog/product')
            ->loadByAttribute('sku', $sku);

    $fullItem = array();

    $fullItem[0] = $product->getName();
    $fullItem[1] = $product->getFormatedPrice();
    $fullItem[2] = $product->getSmallImageUrl();

    echo json_encode($fullItem);

} 
```

当我在浏览器中加载此请求时，它会正确返回 JSON 对象

[http://www.jinkou.info/pinboard/index/pinboardgetitems?sku=50065](http://www.jinkou.info/pinboard/index/pinboardgetitems?sku=50065)

但是，当我执行 AJAX 请求（我正在使用 jQuery）时，未设置 $sku 并引发致命错误。

查看此行为的最简单方法是使用[http://hurl.it](http://hurl.it)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:31:54.653

除了我的错字评论之外，访问参数的适当方法是通过请求对象：

```
$sku = $this->getRequest()->getParam('sku'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T06:42:28.233

benmarks写了正确的答案。

对不起offtop，但下一个代码：

```
echo json_encode($fullItem); 
```

不合适。您应该在标头中设置 json 内容类型并在响应正文中设置 json 正文：

```
/** @var $helper Mage_Core_Helper_Data */
$helper = Mage::helper('core');
$this->getResponse()->setHeader('Content-type', 'application/json')
$this->getResponse()->setBody($helper->jsonEncode($fullItem); 
```

# api - 来自 google api 的图表格式不正确

> ID：12380095
> 
> 赞同：0
> 
> 时间：2012-09-12T01:28:22.013
> 
> 标签：api, google-visualization

我正在使用旧版本的 Google 图表 API 来生成简单的图像。

例如：[https ://chart.googleapis.com/chart?chs=250x100&chd=t:265,148&cht=p3&chl=empty%20-%20%20265%20|%20with%20link%20-148](https://chart.googleapis.com/chart?chs=250x100&chd=t:265,148&cht=p3&chl=empty%20-%20%20265%20%7C%20with%20link%20-148)

[你可以在这里](https://developers.google.com/chart/image/docs/making_charts)找到 api 的文档。负责图表值的链接部分后跟链接中的“t:”参数。

如您所见，我传递了 2 个值：265 和 148，但图表将它们显示为图表的几乎相等的一半.....

知道为什么吗？有没有人有类似的问题？

一切顺利，

亚当

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T10:57:20.873

您提供的数字都超过 100，这意味着您实际上正在尝试显示 413%。您可以通过计算每个百分比并使用它来创建正确的图表。

在您的示例中，您应该将 64% 和 36% 作为值：[https ://chart.googleapis.com/chart?chs=250x100&chd=t:64,36&cht=p3&chl=empty%20-%20%20265%20 |%20with%20link%20-148](https://chart.googleapis.com/chart?chs=250x100&chd=t:64,36&cht=p3&chl=empty%20-%20%20265%20|%20with%20link%20-148)

我用以下等式计算出这些：

```
(value / (total)) * 100 
```

# c++ - C++ 可能的内存泄漏读取文件

> ID：12380099
> 
> 赞同：0
> 
> 时间：2012-09-12T01:28:40.067
> 
> 标签：c++, memory-management, file-io

我对 C++ 比较陌生，我正在尝试读取专有文件格式。我知道标头格式，并且创建了一个`RTIHeader`包含必要字段的结构。

我的测试代码从文件中读取字节并将它们复制到与标头结构相同的内存空间中，从而有效地重构它。我的问题是每次我运行测试代码（只是调用构造函数）我都会得到不同的值！我的理论是我不完全理解`memcpy`。

```
struct RTIHeader decode(char* memblock){
    struct RTIHeader header;
    memcpy(&header,&memblock,sizeof(RTIHeader));
    return header;
}

RTIFile::RTIFile(const char* filename){
    // open the file in binary input mode with the pointer at the end
    std::ifstream file(filename,
                       std::ios::in |
                       std::ios::binary |
                       std::ios::ate);

    std::ifstream::pos_type size;
    char * memblock;
    RTIHeader header;

    // if the file didn't open, throw an error
    if(!file.is_open()){
        //TODO learn about C++ error handling
        return;
    }
    // use pointer position to determine file size
    size = file.tellg();
    // read file
    memblock = new char [sizeof(RTIHeader)];
    file.seekg(0,std::ios::beg);
    file.read(memblock,sizeof(RTIHeader));

    header = decode(memblock);

    std::cout << (unsigned int)header.signature[0] << "\n";

    // still need to read the rest of the file
    file.close();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T01:34:37.453

您将 的*地址*作为`memblock`的第二个参数传递`memcpy`。由于`memblock`是函数的参数，因此您只需从堆栈中复制内存块。

要修复，只需直接传递指针：

```
memcpy(&header,memblock,sizeof(RTIHeader)); 
```

顺便说一句，由于您是按值返回结构，因此您将产生*额外的*memcpy，因为返回的值被完整复制（除非您的编译器对其进行了优化）。为避免这种情况，您应该考虑将目标结构作为指向 的指针传递`decode`，如

```
struct RTIHeader *decode(struct RTIHeader *header, char* memblock){
    memcpy(header, memblock, sizeof(RTIHeader));
    return header;
} 
```

然后你只需要做

```
decode(&header, memblock); 
```

哪个更有效率。

# c# - 过滤从远程机器返回的事件日志条目

> ID：12380104
> 
> 赞同：0
> 
> 时间：2012-09-12T01:30:30.750
> 
> 标签：c#, event-log

我正在尝试返回由 sqlserveragent 编写的事件日志条目。不幸的是，我似乎只能一次获取所有条目，而且时间太长。这是我目前正在使用的代码：

```
EventLog log = new EventLog("Application", "x.x.x.x", "SQLSERVERAGENT");
var entries = log.Entries.OfType<EventLogEntry>().Where(o => o.Source == "SQLSERVERAGENT");
var c = entries.Count(); 
```

当它到达最后一行时，它需要很长时间，以至于我没有耐心等待它完成。有没有办法让我获得条目的过滤视图，而不必预先获取它们然后过滤它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:50:35.967

我发现我需要使用 EventLogQuery 和 EventLogReader 类才能做到这一点。

仍然试图弄清楚如何正确地形成查询，所以如果有人知道，请告诉：[EventLogQuery：如何形成查询字符串？](https://stackoverflow.com/questions/12380189/eventlogquery-how-to-form-query-string)

# geometry - 圆变形的交点

> ID：12380106
> 
> 赞同：0
> 
> 时间：2012-09-12T01:30:41.967
> 
> 标签：geometry, smalltalk, pharo, morphic

我正在尝试借助此链接找到 Circle 的相交点。

![在此处输入图像描述](../Images/8d299ebdff693a30635a7872ed2bfc69.png)

以下注释描述了如何在平面上找到两个圆之间的交点，使用以下符号。目的是找到两个点 P3 = (x3, y3)（如果存在）。

首先计算圆心之间的距离d。d = ||P1 - P0||。

如果 d > r0 + r1 则没有解，圆圈是分开的。如果 d < |r0 - r1| 那么没有解决方案，因为一个圆圈包含在另一个圆圈中。如果 d = 0 且 r0 = r1 则圆是重合的，并且有无数个解。考虑两个三角形 P0P2P3 和 P1P2P3 我们可以写

a2 + h2 = r02 和 b2 + h2 = r12

使用 d = a + b 我们可以求解 a，

a = (r02 - r12 + d2 ) / (2 d)

可以很容易地证明，当两个圆在一个点接触时，这会减少到 r0，即： d = r0 + r1 通过将 a 代入第一个方程来求解 h，h2 = r02 - a2 所以

P2 = P0 + a ( P1 - P0 ) / d

最后，根据 P0 = (x0,y0)、P1 = (x1,y1) 和 P2 = (x2,y2)，P3 = (x3,y3) 是

x3 = x2 +- h ( y1 - y0 ) / d

y3 = y2 -+ h ( x1 - x0 ) / d [http://paulbourke.net/geometry/2circle/](http://paulbourke.net/geometry/2circle/)

```
b:=CircleMorph new.
b center: 60@60.
b openInWorld.
b1:=CircleMorph new.
b center: 100@100.
b1 openInWorld.
d:= b1 center - b center. // distance between 2 circles
r1:= (((b center x abs)squared +(b  center y abs)squared)sqrt).
r2:= (((b1 center x abs)squared +(b1  center y abs)squared)sqrt).
r3:= r1+ r2.
(d) > (r3) ifTrue:[Transcript show:'Circles are seprate';cr] 
```

当我将距离与 2 个圆的半径之和进行比较时，得到的距离小于两个圆的半径，我知道这是不正确的，当圆是分开的时，我是否正确地计算了半径，我知道这个帮助有一些问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T07:15:17.827

一种可能的解决方案是：

```
| b b1 d r1 r2 r3 |
b := CircleMorph new.
b center: 60@60.
b bounds: (Rectangle origin: 100@40 corner: 40@100).
b openInWorld.
b1 := CircleMorph new.
b center: 100@100.
b bounds: (Rectangle origin: 100@40 corner: 40@100).
b1 openInWorld.
r1 := b bounds width / 2.
r2 := b1 bounds width / 2.
r3 := r1+ r2.
(d < r3)
    ifTrue: [| a h mid |
        a := (r1 squared - r2 squared + d squared) / (2 * d).
        h := (r1 squared - a squared) sqrt.
        mid := (b1 center x - b center x) @ (b1 center y - b center y).
        {(mid x + (h * (b1 center y - b center y))) @ (mid y - (h * (b1 center x - b center x))).
        (mid x - (h * (b1 center y - b center y))) @ (mid y + (h * (b1 center x - b center x)))}]
    ifFalse: ['separate'] 
```

你会想检查我的算术。（更新：我没有使用两个圆心之间的点来计算点。）

# qt - 在QTableView中，什么“信号”触发了编辑模式

> ID：12380107
> 
> 赞同：2
> 
> 时间：2012-09-12T01:30:42.413
> 
> 标签：qt, inheritance, qt4, signals-slots, qtableview

我正在尝试从 QTableView 编写一些继承类（我们称之为 A），并希望覆盖插槽

> 无效编辑 ( const QModelIndex & index )

来自 QAbstractItemView。我知道这个功能可以触发编辑模式，但这是我的问题：我希望每当编辑模式由这个类 A 中的用户触发时，程序可以进入被覆盖的插槽**A::edit**内。

但是，似乎只有直接调用**A::edit**时，程序才能进入。

由于 QTableView 来自 QAbstractItemView，如果编辑模式被其他方式触发（如鼠标双击），程序将运行默认的**QAbstractItemView::edit**而不是**A::edit**。

我试图连接“激活”信号，但显然它不是触发编辑模式的正确信号。每次触发编辑器时，无论如何都要做一些事情吗？

另外，当编辑模式结束时，我想通过按 Enter 或 ESC 或鼠标单击其他位置来做一些事情。同样的情况也发生在插槽

> void editorDestroyed (QObject * editor)

谁能帮我解决这个问题？我会很感激的，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T02:32:03.883

QAbstractItemView::edit(const QModelIndex& index) 不是[virtual](http://en.wikipedia.org/wiki/Virtual_function)，所以这就是为什么当你直接调用它时你会得到你的子类的行为，但是当现有的代码调用它时，它们会得到基类的行为。如果这没有响起，请阅读该链接；Qt 有很多虚拟和非虚拟功能，知道它们之间的区别会为您省去很多麻烦。

但是，[QAbstractItemView::edit(const QModelIndex& index, EditTrigger trigger, QEvent* event)](http://doc.qt.nokia.com/4.7/qabstractitemview.html#edit-2) *是*虚拟的，因此您可以覆盖它。我还没有验证过，但想必非虚拟的edit()调用了这个edit()，所以应该有同样的效果。

QAbstractItemView::editorDestroyed(QObject* editor) 也是虚拟的，所以我不确定它为什么不起作用。但是，还有[QAbstractItemView::closeEditor(QWidget* editor, QAbstractItemDelegate::EndEditHint hint)](http://doc.qt.nokia.com/4.7/qabstractitemview.html#closeEditor)也是虚拟的，因此您可能想尝试在您的子类中重新实现它。closeEditor() 文档还建议 commitData()，它也是虚拟的。Qt 项目视图有很多类似的方法，所以不要假设你看到的第一个会完全按照你的意愿/期望做。

仅供参考，如果您不习惯在子类中重新实现虚拟方法，确保您的实现被调用的最快/最简单的方法是执行以下操作：

```
class A : public QTableView {
    void closeEditor ( QWidget * editor, QAbstractItemDelegate::EndEditHint hint ) {
        qDebug("my closeEditor was called!");
        // call the real implementation so that the base class continues to work properly
        QTableView::closeEditor(editor, hint);
    }
}; 
```

您可以使用 edit()、editorDestroyed()、closeEditor() 和 commitData() 来执行此操作，以查看何时调用了哪些。

# solr - 我可以使用带有模式的 copyField 吗？

> ID：12380109
> 
> 赞同：0
> 
> 时间：2012-09-12T01:31:09.263
> 
> 标签：solr, schema

我的索引中有几个 groupFields。我可以这样写 copyField 模式吗

```
 <copyField source="*_attr_group" dest="important_text"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:59:58.697

是的，自 Solr v 1.1.0 起已支持此功能，请参阅[JIRA 问题 SOLR-21](https://issues.apache.org/jira/browse/SOLR-21)了解更多详细信息。

# .htaccess - 访问新的 php 文件

> ID：12380111
> 
> 赞同：3
> 
> 时间：2012-09-12T01:31:50.273
> 
> 标签：.htaccess, https, url-rewriting, url-routing

我正在帮助一个朋友建立一个网站，我创建了几个 php 页面，然后他将这些页面复制到了根目录。问题是 htaccess 文件的设置方式使我无法访问我创建的任何新 php 文件，但我可以访问所有 html 文件。我查看了很多用于编辑 htaccess 的文档，但我无法使其工作。任何帮助表示赞赏。我添加的新页面是contact.php、show-captcha.php 和thank-you.php

```
RewriteEngine on
RewriteRule ^(.*)\.htm$ $1.php [NC]

#RewriteCond %{REMOTE_ADDR} !71\.239\.5\.36
#RewriteCond %{REQUEST_URI} !/maintenance.html$
#RewriteCond %{REQUEST_URI} !/img(.*)$
#RewriteCond %{REQUEST_URI} !/sync/$
#RewriteRule $ /maintenance.html [R=302,L]

##Errors##
ErrorDocument 400 /error.php
ErrorDocument 401 /error.php
ErrorDocument 403 /error.php
ErrorDocument 404 /error.php
ErrorDocument 500 /error.php

##Redirect##
RewriteCond %{HTTP_HOST} ^www.example.net [NC]
RewriteRule ^(.*)$ http://example.net/$1 [L,R=301]
RewriteCond %{SERVER_PORT} 80
RewriteCond %{REQUEST_URI} !/$
RewriteRule ^(.*)$ https://example.net/$1 [R,L]

##Common Files##
RewriteRule ^(.*)\~\57(.*)$ $1Main.php?file=$2 [NC]
RewriteRule ^(.*)ajax\57(.*)$ $1Main.php?ajax&$2 [NC]
RewriteRule ^(.*)sync\57(.*)$ $1Main.php?sync&$2 [NC]
RewriteRule ^(.*)backup\57(.*)$ $1Main.php?backup&$2 [NC]
RewriteRule ^(.*)SampleDoc(\57)(.*[^\57])(\57?)$ $1index.php?count=$3 [NC]

##REDIRECTS##
RewriteRule ^(.*)menu(\57)(.*[^\57])(\57)(.*[^\57])$ $1menu.php [NC]
RewriteRule ^(.*)menu(\57)(.*[^\57])(\57?)$ $1menu.php [NC]
RewriteRule ^(.*)menu(\57?)$ $1menu.php [NC]

RewriteRule ^(.*)checkout(\57)(.*[^\57])(\57)(.*[^\57])$ $1checkout.php [NC]
RewriteRule ^(.*)checkout(\57)(.*[^\57])(\57?)$ $1checkout.php [NC]
RewriteRule ^(.*)checkout(\57?)$ $1checkout.php [NC]

RewriteRule ^(.*)ThankYou(\57)(.*[^\57])(\57?)$ $1ThankYou.php?$3 [NC]
RewriteRule ^(.*)ThankYou(\57?)$ $1ThankYou.php [NC]

RewriteRule ^(.*)Contact(\57)(.*[^\57])(\57?)$ $1contact.php?$3 [NC]
RewriteRule ^(.*)Contact(\57?)$ $1contact.php [NC]

RewriteRule ^(.*)account(\57)(.*[^\57])(\57)(.*[^\57])(\57)(.*[^\57])$ $1account.php?type=$3&email=$5&code=$7 [NC]
RewriteRule ^(.*)account(\57)(.*[^\57])(\57?)$ $1account.php?type=$3 [NC]
RewriteRule ^(.*)account(\57?)$ $1account.php [NC]

RewriteRule ^(.*)catering(\57)(.*[^\57])(\57)(.*[^\57])$ $1catering.php?$3$5 [NC]
RewriteRule ^(.*)catering(\57)(.*[^\57])(\57?)$ $1catering.php?$3 [NC]
RewriteRule ^(.*)catering(\57?)$ $1catering.php [NC]

RewriteRule ^(.*)changepassword\57(.*[^\57])\57(.*[^\57])$ $1account.php?type=changepssd&email=$2&code=$3 [NC]
RewriteRule ^(.*)join(\57)(.*[^\57])(\57)(.*[^\57])$ $1account.php?type=join&email=$5&code=$7 [NC] 
```

我尝试添加contact.php，但您可以看到它没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T21:57:01.553

如果您不打算将路径变量移动到查询字符串，则根本不需要重写规则。只需删除联系页面的 RewriteRules。如果您仍然收到未找到的页面，请删除

```
ErrorDocument 500 /error.php 
```

所有错误，从页面未找到到服务器错误都得到相同的 error.php。您的contact.php 中可能有一些错误，这就是您总是得到这个页面的原因。

希望有帮助！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-18T00:46:12.403

尝试删除与联系人的现有线路

```
#RewriteRule ^(.*)Contact(\57)(.*[^\57])(\57?)$ $1contact.php?$3 [NC]
#RewriteRule ^(.*)Contact(\57?)$ $1contact.php [NC] 
```

并添加这些：

```
RewriteRule ^(.*)contact(\57)(.*[^\57])(\57)(.*[^\57])$ $1contact.php [NC]
RewriteRule ^(.*)contact(\57)(.*[^\57])(\57?)$ $1contact.php [NC]
RewriteRule ^(.*)contact(\57?)$ $1contact.php [NC] 
```

并注意区分大小写。

# meteor - 如何在 Meteor 中订阅发布集合？

> ID：12380114
> 
> 赞同：1
> 
> 时间：2012-09-12T01:32:09.180
> 
> 标签：meteor, publish-subscribe

我从以下位置复制代码：[Meteor 文档中的消息计数示例如何工作？](https://stackoverflow.com/questions/10565654/how-does-the-messages-count-example-in-meteor-docs-work,but)这没用。客户端调用`Counts.find().count()`方法，我希望它输出 1 但结果是 0 ，你能告诉我为什么吗？

```
//server code
if (Meteor.is_server)
{
    Meteor.startup(function (){
      console.log("server is startup...");
      Messages = new Meteor.Collection("messages");
      if(Messages.find().count() == 0){
      for(var i=0;i<7;i++){
        Messages.insert({room_id:"00"+i,text:"message "+i});
      }
    }
    console.log("room_id:001 messages count="+Messages.find({room_id:"001"}).count());
    //print--->room_id:001 messages count=1 (it's ok)

    Meteor.publish("counts-by-room", function (roomId) {
      var self = this;
      var uuid = Meteor.uuid();
      var count = 0;

      var handle = Messages.find({room_id: roomId}).observe({
        added: function (doc, idx) {
        count++;
        self.set("counts", uuid, {roomId: roomId, count: count});
        self.flush();
      },
      removed: function (doc, idx) {
      count--;
      self.set("counts", uuid, {roomId: roomId, count: count});
      self.flush();
    } 
    // don't care about moved or changed
    });
    // remove data and turn off observe when client unsubs
    self.onStop(function () {
      handle.stop();
      self.unset("counts", uuid, ["roomId", "count"]);
      self.flush();
     });
     });
     });
}

//client code
if (Meteor.is_client)
{
    Meteor.startup(function () {
      Counts = new Meteor.Collection("counts");
      Session.set("roomId","001");
      Meteor.autosubscribe(function () {
      Meteor.subscribe("counts-by-room", Session.get("roomId"));
    });
    console.log("I client,Current room "+Session.get("roomId")+" has " 
     + Counts.find().count() + " messages.");
    //print--->I client,Current room 001 has 0 messages.(trouble:I expect it to output "...has 1 messages" here)
    }); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T06:55:18.530

我尝试了很多次，我发现了这个错误。将客户端代码更改为如下所示，它将打印正确的结果。

```
//client code
Meteor.startup(function () {
  Counts = new Meteor.Collection("counts");
  Session.set("roomId","001");
  Meteor.autosubscribe(function () {
    Meteor.subscribe("counts-by-room", Session.get("roomId"));
    data = Counts.findOne();
    if(data){
      console.log("I client,Current room "+Session.get("roomId")+" has " 
     + data.count + " messages.");
     //print--->I client,Current room 001 has 1 messages.(now it's ok!)
    }
 })
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:43:45.270

像这样试试

```
Counts = new Meteor.Collection("counts-by-room"); /* correct name of the collection */
/*... subscribing stuff */
Counts.findOne('counts') /* this is the count you published */ 
```

# php - SQL SELECT DISTINCT 但合并来自另一个表的结果

> ID：12380116
> 
> 赞同：1
> 
> 时间：2012-09-12T01:32:24.893
> 
> 标签：php, sql, select, odbc, sybase

我什至不确定要搜索什么，如果这已经在某个地方覆盖，请原谅我。

我有一个从多个表中提取数据的 SELECT 语句。正如预期的那样，如果我运行这个查询，我会得到第二个表中每条记录的记录，就像这样。

```
|ID     |Name     |Assets
 ------------------------------------
|1      |Bob      |Car
|1      |Bob      |Bicycle
|1      |Bob      |House
|2      |Jane     |Car
|2      |Jane     |House
|3      |Peter    |Boat
|3      |Peter    |Car
|3      |Peter    |Motorcycle 
```

我想要的是这样的：

```
|ID     |Name     |Assets
 ------------------------------------
|1      |Bob      |Car,Bicycle,House
|2      |Jane     |Car,House
|3      |Peter    |Boat,Car,Motorcycle 
```

我已经能够使用 PHP 通过简单地为从第一个表中获得的每条记录再次访问数据库来实现这一点，但这使得我的页面变慢，因为它在每次页面刷新时访问数据库大约 40-60 次。

查询一：

```
SELECT ID,Name FROM People 
```

然后在 while 循环中查询 2：

```
<?php
while($owner_row=odbc_fetch_array($query1) {
$assets = odbc_exec($conn,"SELECT Asset FROM Assets WHERE Owner='$owner_row[Name]'");
$asset_array = odbc_fetch_array($assets);
$asset_string = implode(",",$asset_array);
} 
```

然后，我可以将每个所有者的资产结果组合成一个字符串，并根据需要显示它们。

有没有办法在单个查询中实现这一点，以便我只访问数据库一次并以某种方式将这些资产组合成查询本身中的单个值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T01:35:53.110

我不确定您要访问哪个数据库，但是如果您使用的是 mySQL，则有一个可爱的函数可以执行此操作，称为 group_concat，其工作方式如下：

```
select 
    a.ID, 
    a.Name, 
    group_concat(b.Asset) as assetGroup 
from 
    people a
        join Assets b
            on a.ID=b.Owner 
group by 
    a.ID, 
    a.Name 
```

这将完全输出：

```
|ID     |Name     |Assets
 ------------------------------------
|1      |Bob      |Car,Bicycle,House
|2      |Jane     |Car,House
|3      |Peter    |Boat,Car,Motorcycle 
```

编辑：我假设 people 表中的每条记录在 Assets 表中至少有一个匹配记录 - 如果没有，请在查询中使用外连接。

编辑：我不熟悉 SyBase，但快速搜索相关函数给了我一个坏消息：[MYSQL group_concat 在 Sybase ASE 中等效？](https://stackoverflow.com/questions/8230712/mysql-group-concat-equivalent-in-sybase-ase)SyBase 中没有这样的函数，您必须编写一个存储过程来获取结果，但这表明您仍然可以直接在数据库上执行此操作（尽管方式要困难得多）。

如果您不想编写存储过程，您仍然可以在查询中加入表，然后简单地将每个 ID 的许多行返回到 PHP 中，并简单地沿着以下行遍历它们：

```
$currentID=0;
$userAssets=array();
while($row=$AnotherRowFromTheDatabase)
{
    if($row['ID']==$currentID)
    {
        $userAssets[]=$row['Asset'];
    }
    else
    {
        $currentID=$row['ID'];
        // More stuff to move the array previously
        // and start a new Assets Array
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:19:08.310

在此处使用 Sybase [LIST](http://manuals.sybase.com/onlinebooks/group-sasarc/awg0603e/dbrfen6/@ebt-link;pt=31454?target=%25N%15_37949_START_RESTART_N%25)函数。

例如

```
SELECT ID,NAME,LIST(ASSETS)
FROM PEOPLE
GROUP BY ID,NAME 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T05:07:25.647

请使用以下 SQL：

```
declare @tempUser  Table
(
ID int,
Name nvarchar(250),
AssetNAme nvarchar(250)
)
Insert into @tempUser values(1,'Bob','Car')
Insert into @tempUser values(1,'Bob','Bicycle')
Insert into @tempUser values(1,'Bob','House')
Insert into @tempUser values(2,'Jane','Car')
Insert into @tempUser values(2,'Jane','House')
Insert into @tempUser values(3,'Peter','Boat')
Insert into @tempUser values(3,'Peter','Car')
Insert into @tempUser values(3,'Peter','MotorCycle')

select  tt.ID,tt.Name,(select ITT.AssetNAme + ', ' as 'data()'  from @tempUser as ITT 
where ITT.ID =tt.ID for xml path('')) from @tempUser  as tt group by tt.ID,tt.Name 
```

# html - 我正在尝试将 webkit 命令转换为 moz o 和 ms

> ID：12380118
> 
> 赞同：0
> 
> 时间：2012-09-12T01:33:07.870
> 
> 标签：html, css, webkit, w3c

我正在尝试找到 webkit 命令的替代方法：

```
-webkit-text-fill-color 
```

由于 moz o 和 ms 中尚不支持此功能，因此任何人都知道可以执行此操作的另一个命令或我可以使用某种 css hack 来获得此效果吗？

基本上我所做的是使文本不可见，将背景渐变设置为不可见，除了文本所在的位置，并使该背景显示出来以制作纯 CSS 渐变文本。有人有想法么？这就是我使用 webkit 完成它的方式：

```
background-image: -webkit-linear-gradient(top, #3e698c, #30576e);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent; 
```

它在 safari/chrome (duh :P) 中效果很好，但在 ff 歌剧 maxthon 等中效果不佳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-25T16:36:00.457

这已在评论中解决，因此将评论放在答案中以将此问题从未回答列表中删除。

> 代替使用颜色和 webkit-text-fill-color 两者都是相同的，看看[“-webkit-text-fill-color”和“color”之间的区别？](https://stackoverflow.com/questions/9287552/difference-between-webkit-text-fill-color-and-color)– Arpit Srivastava 2012 年 9 月 14 日 3:12

此外，除了 IE 之外的所有浏览器都支持 webkit-text-fill-color，即使它不是标准的：[https ://developer.mozilla.org/en-US/docs/Web/CSS/-webkit-text-fill-color #Browser_compatibility](https://developer.mozilla.org/en-US/docs/Web/CSS/-webkit-text-fill-color#Browser_compatibility)

# c# - Linq Where Lambda 超慢

> ID：12380128
> 
> 赞同：0
> 
> 时间：2012-09-12T01:34:50.723
> 
> 标签：c#, linq, list, where

我有一个只有 6 个属性的自定义类列表。有一个字段叫做“状态”

我将它们放在通用列表中

```
 List<House> hList = GetHomes(); //Holds 204 instances of House
 int count = hList.Where(x=>x.status == "sold").ToList().Count(); 
```

这样做会返回 3，这是正确的，但这样做需要 10 秒。

有更快的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T02:31:27.237

如果你只需要计数，你可以这样做：

```
var count = hList.count(x => x.status == "sold"); 
```

这将防止迭代 3 次（对于 where，然后 tolist，然后 count）

# c++ - 对于以下情况，哪个更好 stl map 或 unordered_map

> ID：12380131
> 
> 赞同：5
> 
> 时间：2012-09-12T01:35:05.287
> 
> 标签：c++, visual-c++, stl

我正在尝试比较某些操作的 stl map 和 stl unordered_map。我在网上看了看，它只会增加我对哪个整体更好的怀疑。所以我想根据它们执行的操作来比较两者。

哪一个执行得更快

插入、删除、查找

哪一个需要更少的内存和更少的时间来从内存中清除它。任何解释都受到热烈欢迎！

提前致谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-12T02:14:41.040

> 哪一个在插入、删除、查找中执行得更快？哪一个需要更少的内存和更少的时间来从内存中清除它。任何解释都受到热烈欢迎！

*对于特定用途，您应该尝试使用您的实际数据和使用模式，看看哪个实际上更快......有足够的因素假设任何一个总是“获胜”是很危险的。*

### 无序映射/哈希表的实现和特点

学术上——随着元素的数量向无穷大增加，在`std::unordered_map`（这是 C++ 库提供的计算科学术语“哈希图”或“哈希表”）上的操作将倾向于继续花费相同的时间 O （1）（忽略内存限制/缓存等），而对于`std::map`（平衡二叉树），每次元素数量翻倍时，它通常需要进行额外的比较操作，因此它会逐渐变慢 O(log [2] n ）。

`std::unordered_map`实现[必须使用开放散列](https://stackoverflow.com/a/31113618/410767)：基本期望是会有一个连续的“桶”数组，每个在逻辑上都是散列到其中的任何值的容器。

它通常用于将哈希表描述为`vector<list<pair<key,value>>>`从向量元素到一个值的位置，当您跟随存储在存储桶中的列表头指针到初始列表节点*时，至少需要*一个指针解引用；插入/查找/删除操作的性能取决于列表的大小，平均等于`unordered_map`'s [`load_factor`](http://en.cppreference.com/w/cpp/container/unordered_map/load_factor)。

如果[`max_load_factor`](http://en.cppreference.com/w/cpp/container/unordered_map/max_load_factor)降低 （默认值为 1.0），那么在插入过程中会发生更少的冲突，但会发生更多的重新分配/重新散列，并且会浪费更多的内存（这会通过增加缓存未命中来损害性能）。

这种最明显的`unordered_map`实现的内存使用涉及[`bucket_count()`](http://en.cppreference.com/w/cpp/container/unordered_map/bucket_count)列表头迭代器/指针大小的桶的连续数组和每个键/值对的一个双向链表节点。通常，`bucket_count()`+ 2 *`size()`额外的开销指针，针对实现可能执行的动态内存分配请求大小的任何四舍五入进行调整。例如，如果您要求 100 字节，您可能会得到 128 或 256 或 512。实现的动态内存例程也可能使用一些内存来跟踪已分配/可用区域。

尽管如此，C++ 标准还是为现实世界的实现留出了空间，让他们自己做出一些性能/内存使用决策。例如，他们可以在分配一个新的更大的数组后将旧的连续桶数组保留一段时间，因此可以逐渐将值重新散列到后者中，以降低最坏情况下的性能，但会以平均情况性能为代价在操作期间会咨询这两个阵列。

### map/平衡二叉树的实现和特点

A`map`是一棵二叉树，可以预期使用指向不同调用返回的不同堆内存区域的指针`new`。除了键/值数据，树中的每个节点都需要父、左和右指针（如果丢失，请参阅[维基百科的二叉树文章）。](https://en.wikipedia.org/wiki/Binary_tree)

### 比较

因此，两者都`unordered_map`需要`map`为键/值对分配节点，前者通常具有两个指针/迭代器开销用于上一个/下一个节点链接，而后者具有三个用于父/左/右。但是，`unordered_map`它还具有用于存储桶的单个连续分配`bucket_count()`(== `size()`/ `load_factor()`)。

对于大多数用途而言，内存使用量的差异并不大，而且一个额外区域的释放时间差异不太可能引起注意。

### 另一种选择

对于容器预先填充然后重复搜索而没有进一步插入/擦除的情况，有时使用排序向量可能是最快的，使用标准算法搜索[`binary_search`](http://en.cppreference.com/w/cpp/algorithm/binary_search), [`equal_range`](http://en.cppreference.com/w/cpp/algorithm/equal_range), [`lower_bound`](http://en.cppreference.com/w/cpp/algorithm/lower_bound), [`upper_bound`](http://en.cppreference.com/w/cpp/algorithm/upper_bound)。这具有单个连续内存分配的优点，这对缓存更加友好。它总是优于`map`，但`unordered_map`可能仍然更快 - 如果您关心，请衡量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T02:00:03.740

两者兼有的原因是两者都不是整体更好。

使用任何一个。如果另一个证明更适合您的使用，请切换。

*   std::map 为更糟糕的时间提供了更好的空间。
*   std::unordered_map 为更差的空间提供了更好的时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T01:44:49.460

您的问题的答案在很大程度上取决于您使用的特定 STL 实现。确实，您应该查看您的 STL 实现的文档——它可能包含大量有关性能的信息。

不过一般来说，根据 cppreference.com，[地图](http://en.cppreference.com/w/cpp/container/map)通常实现为[红黑树](https://en.wikipedia.org/wiki/Red-black_tree)并支持时间复杂度为 O(log n) 的操作，而[unordered_maps](http://en.cppreference.com/w/cpp/container/unordered_map)通常支持恒定时间操作。cppreference.com 几乎没有提供关于内存使用情况的信息；但是，[另一个 StackOverflow 答案](https://stackoverflow.com/questions/2196995/is-there-any-advantage-of-using-map-over-unordered-map-in-case-of-trivial-keys)表明地图通常比 unordered_maps 使用更少的内存。

对于带有 Visual Studio 2012 的 STL 实现 Microsoft 包，看起来[map](http://msdn.microsoft.com/en-us/library/s44w4h2s.aspx)在摊销 O(log n) 时间内支持这些操作，而[unordered_map](http://msdn.microsoft.com/en-us/library/bb982522.aspx)在摊销常数时间内支持它们。但是，文档没有明确说明内存占用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T15:34:26.823

**地图：**

*插入：*

1.  对于第一个版本（ insert(x) ），对数。
2.  对于第二个版本（ insert(position,x) ），通常是对数，但如果 x 插入到 position 指向的元素之后，则为摊销常数。
3.  对于第三个版本（ insert (first,last) ），通常为 Nlog(size+N) （其​​中 N 是 first 和 last 之间的距离，并且 size 是插入前容器的大小），但如果元素之间是线性的first 和 last 已经根据容器使用的相同排序标准进行排序。

*删除：*

1.  对于第一个版本（擦除（位置）），摊销常数。
2.  对于第二个版本（ erase(x) ），容器大小的对数。
3.  对于最后一个版本（erase(first,last)），容器大小的对数加上第一个和最后一个之间的距离的线性。

*抬头：*

1.  大小为对数。

**无序地图：**

*插入：*

1.  单元素插入：
    1.  平均情况：恒定。
    2.  最坏的情况：容器大小呈线性关系。
2.  多个元素插入：
    1.  平均情况：与插入的元素数量呈线性关系。
    2.  最坏情况：N*(size+1)：插入的元素数乘以容器大小加一。

*删除：*

1.  平均情况：移除的元素数量呈线性关系（仅移除一个元素时保持不变）
2.  最坏情况：容器大小呈线性关系。

*抬头：*

1.  平均情况：恒定。
2.  最坏的情况：容器大小呈线性关系。

知道了这些，你就可以根据实现的类型来决定使用哪个容器了。

***来源：www.cplusplus.com***

# memory - 了解 CUDA 中的内存使用情况

> ID：12380138
> 
> 赞同：3
> 
> 时间：2012-09-12T01:36:19.847
> 
> 标签：memory, memory-management, cuda

我有一块***NVIDIA GTX 570***显卡，在带有***Cuda 4.0的******Ubuntu 10.10 系统上运行。***

 *我知道，为了性能，我们需要有效地访问内存，并巧妙地使用设备上的**寄存器**和**共享内存。**

但是我不明白如何计算，每个线程可用的寄存器数量，或者单个块可以使用多少共享内存以及针对特定内核配置的其他简单/重要的计算。

我想通过一个***明确***的例子来理解这一点。顺便说一句，我目前正在尝试编写一个粒子代码，其中一个内核应该看起来像这样。

每个块是线程的***一维集合，每个网格是块的******一维***集合。

*   块数：***16384***
*   每个块的线程数：***32*** （=> 总线程 32*16384 = ***524288***）
*   **每个**线程块都有一个***32 x 32*** 的二维整数共享内存数组以供使用。

在一个线程中，我想存储一些类型的数字`double`。但是我不确定在`double`没有任何寄存器溢出到本地内存（在设备上）的情况下我可以存储多少这样的数字。有人能告诉我这个内核配置每个线程可以存储多少个双精度数吗？

另外，我的每个块的共享内存的上述配置是否有效？

关于如何推断这些事情的示例计算将非常具有说明性和帮助

这是关于我的 GTX 570 的信息：（使用 CUDA-SDK 的 deviceQuery）

```
[deviceQuery] starting...
./deviceQuery Starting...

 CUDA Device Query (Runtime API) version (CUDART static linking)

Found 1 CUDA Capable device(s)

    Device 0: "GeForce GTX 570"
      CUDA Driver Version / Runtime Version          4.0 / 4.0
      CUDA Capability Major/Minor version number:    2.0
      Total amount of global memory:                 1279 MBytes (1341325312 bytes)
      (15) Multiprocessors x (32) CUDA Cores/MP:     480 CUDA Cores
      GPU Clock Speed:                               1.46 GHz
      Memory Clock rate:                             1900.00 Mhz
      Memory Bus Width:                              320-bit
      L2 Cache Size:                                 655360 bytes
      Max Texture Dimension Size (x,y,z)             1D=(65536), 2D=(65536,65535), 3D=(2048,2048,2048)
      Max Layered Texture Size (dim) x layers        1D=(16384) x 2048, 2D=(16384,16384) x 2048
      Total amount of constant memory:               65536 bytes
      Total amount of shared memory per block:       49152 bytes
      Total number of registers available per block: 32768
      Warp size:                                     32
      Maximum number of threads per block:           1024
      Maximum sizes of each dimension of a block:    1024 x 1024 x 64
      Maximum sizes of each dimension of a grid:     65535 x 65535 x 65535
      Maximum memory pitch:                          2147483647 bytes
      Texture alignment:                             512 bytes
      Concurrent copy and execution:                 Yes with 1 copy engine(s)
      Run time limit on kernels:                     Yes
      Integrated GPU sharing Host Memory:            No
      Support host page-locked memory mapping:       Yes
      Concurrent kernel execution:                   Yes
      Alignment requirement for Surfaces:            Yes
      Device has ECC support enabled:                No
      Device is using TCC driver mode:               No
      Device supports Unified Addressing (UVA):      Yes
      Device PCI Bus ID / PCI location ID:           2 / 0
      Compute Mode:
         < Default (multiple host threads can use ::cudaSetDevice() with device simultaneously) >

    deviceQuery, CUDA Driver = CUDART, CUDA Driver Version = 4.0, CUDA Runtime Version = 4.0, NumDevs = 1, Device = GeForce GTX 570
    [deviceQuery] test results...
    PASSED

    Press ENTER to exit... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:26:07.820

所以，内核配置有点复杂。您应该使用[CUDA 占用计算器](http://news.developer.nvidia.com/2007/03/cuda_occupancy_.html). 另一方面，您必须研究经线的工作原理。一旦一个块被分配给一个 SM，它就会被进一步划分为 32 个线程的单元，称为 warp。可以说，warp 是 SM 中的线程调度单元。对于给定的块大小和分配给每个 SM 的给定块数，我们可以计算驻留在 SM 中的扭曲数。在您的情况下，一个经线包含 32 个线程，因此如果您有一个包含 256 个线程的块，那么您有 8 个经线。现在选择正确的内核设置取决于您的数据和操作，请记住您必须完全占用一个 SM，即：您必须在每个 SM 中获得完整的线程容量以及围绕长延迟操作进行调度的最大扭曲数. 另一个重要的事情是不要超过每个块的最大线程数的限制，在你的情况下是 1024。*

# android - 设备可用性、过滤和 Google Play

> ID：12380139
> 
> 赞同：5
> 
> 时间：2012-09-12T01:36:27.520
> 
> 标签：android, google-play

关于限制设备应用程序的问题。我们已向设备制造商授权软件，我们希望允许应用程序开发人员仅在这些设备上发布（我将这些设备称为“授权设备”）。应用程序无法在其他设备上运行（“非许可设备”）。

我在这里找到了关于设备可用性和 Google Play 的非常有用的帖子。

*   [Android：限制 Android Market 中支持的设备](https://stackoverflow.com/questions/7636588/android-limit-supported-devices-in-android-market?rq=1)
*   [如何过滤要从 google play 下载到特定设备的 android 应用程序？](https://stackoverflow.com/questions/11643112/how-to-filter-android-app-to-be-downloaded-from-google-play-to-specific-device)除其他外

借助设备可用性，应用程序开发人员似乎必须从受支持设备的动态列表中手动选择所有未授权设备，并将其移至排除列表。对于应用程序开发人员来说似乎需要做很多工作，特别是如果他们必须随着每台新发布的 Android 设备不断更新排除列表。

我想看看是否有相反的方法 - 使我的应用程序仅可用于一组许可设备。有没有办法通过 Google Play 做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-05T12:42:18.170

> 我们已向设备制造商授权软件，我们希望允许应用程序开发人员仅在这些设备上发布（我将这些设备称为“授权设备”）。应用程序无法在其他设备上运行（“非许可设备”）。

此类自定义固件扩展的开发人员应将其作为 SDK 插件，从而要求使用这些扩展的开发人员`<uses-library>`在其清单中具有相应的元素。然后，Play 商店应自动过滤应用程序，使其仅显示在具有该 SDK 插件的设备上。摩托罗拉、HTC、三星和其他公司已经创建了这样的 SDK 插件。

> 我想看看是否有相反的方法 - 使我的应用程序仅可用于一组许可设备。有没有办法通过 Google Play 做到这一点？

不，对不起。

> 明天，如果 Google 在支持的设备列表中再添加一台设备，那么它将自动包含在我不希望发生的我支持的设备列表中。

然后不要在 Play 商店中分发该应用程序。

> 是否有一种机制可以在 Google 将新设备添加到 Google Play 控制台中支持的设备列表后立即获得通知？

不，对不起。

> 如果不是，那么处理它的替代方法是什么。

不断刷新您的浏览器，气喘吁吁地等待设备名册的下一次更新。

> 我相信许多其他安卓开发者也会面临同样的问题

希望不会。Play 商店专为分发到*所有 Android 设备*而设计。每个设备的排除列表专为短期兼容性问题而设计，同时您可以制定一些错误修复来克服这些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T12:14:19.743

Google 似乎刚刚发布了[Google Play Private Channel](http://support.google.com/a/bin/answer.py?hl=en&answer=2494992)，它可以帮助您解决“许可设备”问题。

正如最近在这篇博文中所说：[一种分发内部 Android 应用程序的新方法](http://googleenterprise.blogspot.com.br/2012/12/a-new-way-to-distribute-your-internal.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T08:59:09.850

不是原生的。如果设备类型与您的白名单不匹配，您可以检查设备类型并退出，但这很容易在有根设备上被欺骗。如果你有一个库，你可以在初始化时抛出一个致命异常，等等。

# php - 使用 php 时 .htaccess 的一些混乱包括

> ID：12380144
> 
> 赞同：2
> 
> 时间：2012-09-12T01:37:48.253
> 
> 标签：php, .htaccess, include

我目前正在开发一个 Web 应用程序，我想通过输入 www.mysitename.com/username 让用户访问他们的个人资料

[http://www.mysitename.com/song-type-one.php?song=xyz](http://www.mysitename.com/song-type-one.php?song=xyz)到 [http://www.mysitename.com/song-type-one.php/song/xyz](http://www.mysitename.com/song-type-one.php/song/xyz)

我使用了这样的重写规则

```
RewriteRule ^(.*)$ ./song-type-one.php?song=$1 
RewriteRule ^lok-songs/(.*)$ .song-type-one.php?song=$1 
```

如果我现在在浏览器中键入干净的 url，则只加载我的主要内容，css、javascript 和我的 php 包含未加载。我的 .htaccess 可能有问题 用 .htaccess 实现我想要的所有规则的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T01:48:28.673

尝试在它之前添加：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f 
```

如果文件存在于磁盘上，它将不会执行您的重写规则，从而允许正常加载 JS 和图像。

# importerror - ModelSim PE 学生版 10.1c（STD_LOGIC 错误）

> ID：12380145
> 
> 赞同：0
> 
> 时间：2012-09-12T01:37:51.830
> 
> 标签：importerror, modelsim

我正在尝试在我的 VHDL 代码中使用 STD_LOGIC。它不会编译，因为我在该`port(.....)`部分中尝试使用的 STD_LOGIC 不起作用。我知道问题是因为我没有导入 IEEE 库。我尝试导入它，但没有成功。

如何将 IEEE 库正确导入 ModelSim 中的 VHDL 程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T18:02:31.557

要将定义 std_logic 类型的包导入 VHDL 设计，请将以下两行添加到 VHDL 文件的顶部：

```
library ieee;
use ieee.std_logic_1164.all; 
```

# c# - 自定义 Html 助手在视图中不可用（Razor/Asp.Net MVC3）

> ID：12380146
> 
> 赞同：1
> 
> 时间：2012-09-12T01:37:51.870
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, html-helper, html-agility-pack

我正在尝试使用[HtmlAgilityPack](http://htmlagilitypack.codeplex.com/)实现 Whitelist HTML Sanitizer 。我想创建一个允许我使用它的可重用 Html Helper。我有其他自定义的 Html 助手，我正在使用它工作得很好，但由于某种原因，这个助手不起作用。每次我尝试从视图中调用它时，都找不到 Sanitize 方法。我试图拨打的电话是局部视图，如下所示：

```
@Html.Raw(Html.Sanitize(Model.Body)) 
```

我的 HTML 助手类：

```
using System;
using System.Text;
using System.Web.Mvc;
using System.Collections.Generic;
using System.Linq;
using HtmlAgilityPack;

namespace ProjectX.WebUI.HtmlHelpers
{
    public static class HtmlSanitizeHelpers
    {
        private static readonly IDictionary<string, string[]> Whitelist;
        private static List<string> DeletableNodesXpath = new List<string>();

        static HtmlSanitizeHelpers()
        {
            Whitelist = new Dictionary<string, string[]> {
                { "a", new[] { "href" } },
                { "strong", null },
                { "em", null },
                { "blockquote", null },
                { "b", null},
                { "p", null},
                { "ul", null},
                { "ol", null},
                { "li", null},
                { "div", new[] { "align" } },
                { "strike", null},
                { "u", null},                
                { "sub", null},
                { "sup", null},
                { "table", null },
                { "tr", null },
                { "td", null },
                { "th", null }
                };
        }

        public static MvcHtmlString Sanitize(string input)
        {
            if (input.Trim().Length < 1)
                return MvcHtmlString.Empty;
            var htmlDocument = new HtmlDocument();

            htmlDocument.LoadHtml(input);            
            SanitizeNode(htmlDocument.DocumentNode);
            string xPath = HtmlSanitizeHelpers.CreateXPath();

            return MvcHtmlString.Create(StripHtml(htmlDocument.DocumentNode.WriteTo().Trim(), xPath));
        }

        private static void SanitizeChildren(HtmlNode parentNode)
        {
            for (int i = parentNode.ChildNodes.Count - 1; i >= 0; i--)
            {
                SanitizeNode(parentNode.ChildNodes[i]);
            }
        }

        private static void SanitizeNode(HtmlNode node)
        {
            if (node.NodeType == HtmlNodeType.Element)
            {
                if (!Whitelist.ContainsKey(node.Name))
                {
                    if (!DeletableNodesXpath.Contains(node.Name))
                    {                       
                        //DeletableNodesXpath.Add(node.Name.Replace("?",""));
                        node.Name = "removeableNode";
                        DeletableNodesXpath.Add(node.Name);
                    }
                    if (node.HasChildNodes)
                    {
                        SanitizeChildren(node);
                    }                  

                    return;
                }

                if (node.HasAttributes)
                {
                    for (int i = node.Attributes.Count - 1; i >= 0; i--)
                    {
                        HtmlAttribute currentAttribute = node.Attributes[i];
                        string[] allowedAttributes = Whitelist[node.Name];
                        if (allowedAttributes != null)
                        {
                            if (!allowedAttributes.Contains(currentAttribute.Name))
                            {
                                node.Attributes.Remove(currentAttribute);
                            }
                        }
                        else
                        {
                            node.Attributes.Remove(currentAttribute);
                        }
                    }
                }
            }

            if (node.HasChildNodes)
            {
                SanitizeChildren(node);
            }
        }

        private static string StripHtml(string html, string xPath)
        {
            HtmlDocument htmlDoc = new HtmlDocument();
            htmlDoc.LoadHtml(html);
            if (xPath.Length > 0)
            {
                HtmlNodeCollection invalidNodes = htmlDoc.DocumentNode.SelectNodes(@xPath);
                foreach (HtmlNode node in invalidNodes)
                {
                    node.ParentNode.RemoveChild(node, true);
                }
            }
            return htmlDoc.DocumentNode.WriteContentTo(); ;
        }

        private static string CreateXPath()
        {
            string _xPath = string.Empty;
            for (int i = 0; i < DeletableNodesXpath.Count; i++)
            {
                if (i != DeletableNodesXpath.Count - 1)
                {
                    _xPath += string.Format("//{0}|", DeletableNodesXpath[i].ToString());
                }
                else _xPath += string.Format("//{0}", DeletableNodesXpath[i].ToString());
            }
            return _xPath;
        }
    }
} 
```

此代码的大部分内容都归功于[此帖子](https://stackoverflow.com/questions/3107514/html-agility-pack-strip-tags-not-in-whitelist)中的答案。

我已经检查过的事情：

1.  命名空间已在 Web.Config 文件中正确定义。（我也知道这一点，因为命名空间中的其他人已经工作了）
2.  已经完成了项目的干净构建。
3.  重新启动 Visual Studio 2010。

关于为什么我似乎无法从课堂上调用该方法的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:43:19.670

看起来您没有正确扩展 HtmlHelper。

您的函数定义中缺少以下内容：

```
public static MvcHtmlString Sanitize(this HtmlHelper helper, string input) 
```

查看这篇关于[使用类扩展来使用 UrlHelper 简化代码的帖子](http://www.webistrate.com/mvc3-using-class-extensions-to-simplify-your-code-with-the-urlhelper/)

# mysql - MySQL 5.5 + .NET 连接器 + 实体框架 + 迁移 = FormatException

> ID：12380147
> 
> 赞同：7
> 
> 时间：2012-09-12T01:38:31.187
> 
> 标签：mysql, ef-code-first, entity-framework-5

我试图为我的问题找到解决方案，但到目前为止我的努力都是徒劳的。:-(

我使用 Visual Studio 2010、.NET Framework 4、C#、Entity Framework 5.0、MySQL 5.5 及其对应的 .NET 连接器（版本 6.5.4）创建了一个 Web 项目。我对实体和 O/R 映射使用代码优先方法。

我面临的问题是我无法执行看似简单的迁移。这是我的实体类：

```
public class Usuario
{
    public int Id { get; set; }

    [Required]
    [StringLength(100)]
    public string NomeCompleto { get; set; }

    [Required]
    [StringLength(100)]
    [DataType(DataType.EmailAddress)]
    public string Email { get; set; }

    [Required]
    [StringLength(30)]
    public string Login { get; set; }

    [Required]
    [StringLength(64)]
    public string Senha { get; set; }

    [Required]
    public bool Ativo { get; set; }

    //[Timestamp]
    [ConcurrencyCheck]
    public int Versao { get; set; }
}

public class Perfil
{
    public int Id { get; set; }

    [Required]
    [StringLength(50)]
    public string Nome { get; set; }

    [StringLength(100)]
    public string Descricao { get; set; }

    //[Timestamp]
    [ConcurrencyCheck]
    public int Versao { get; set; }

    public virtual ICollection<Usuario> Usuarios { get; set; }
    public virtual ICollection<Permissao> Permissoes { get; set; }
}

public class Permissao
{
    public int Id { get; set; }

    [Required]
    [StringLength(50)]
    public string Nome { get; set; }

    [StringLength(100)]
    public string Descricao { get; set; }

    //[Timestamp]
    [ConcurrencyCheck]
    public int Versao { get; set; }

    public virtual ICollection<Perfil> Perfis { get; set; }
} 
```

`Add-Migration Acesso`由（唯一`Up()`方法）生成的代码：

```
public partial class Acesso : DbMigration
{
    public override void Up()
    {
        CreateTable(
            "dbo.Usuario",
            c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    NomeCompleto = c.String(nullable: false, storeType: "mediumtext"),
                    Email = c.String(nullable: false, storeType: "mediumtext"),
                    Login = c.String(nullable: false, storeType: "mediumtext"),
                    Senha = c.String(nullable: false, storeType: "mediumtext"),
                    Ativo = c.Boolean(nullable: false),
                    Versao = c.Int(nullable: false),
                })
            .PrimaryKey(t => t.Id);

        CreateTable(
            "dbo.Perfil",
            c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    Nome = c.String(nullable: false, storeType: "mediumtext"),
                    Descricao = c.String(storeType: "mediumtext"),
                    Versao = c.Int(nullable: false),
                })
            .PrimaryKey(t => t.Id);

        CreateTable(
            "dbo.Permissao",
            c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    Nome = c.String(nullable: false, storeType: "mediumtext"),
                    Descricao = c.String(storeType: "mediumtext"),
                    Versao = c.Int(nullable: false),
                })
            .PrimaryKey(t => t.Id);

        CreateTable(
            "dbo.PerfilPermissao",
            c => new
                {
                    PerfilId = c.Int(nullable: false),
                    PermissaoId = c.Int(nullable: false),
                })
            .PrimaryKey(t => new { t.PerfilId, t.PermissaoId })
            .ForeignKey("dbo.Perfil", t => t.PerfilId, cascadeDelete: true)
            .ForeignKey("dbo.Permissao", t => t.PermissaoId, cascadeDelete: true)
            .Index(t => t.PerfilId)
            .Index(t => t.PermissaoId);

        CreateTable(
            "dbo.UsuarioPerfil",
            c => new
                {
                    UsuarioId = c.Int(nullable: false),
                    PerfilId = c.Int(nullable: false),
                })
            .PrimaryKey(t => new { t.UsuarioId, t.PerfilId })
            .ForeignKey("dbo.Usuario", t => t.UsuarioId, cascadeDelete: true)
            .ForeignKey("dbo.Perfil", t => t.PerfilId, cascadeDelete: true)
            .Index(t => t.UsuarioId)
            .Index(t => t.PerfilId);

    }
} 
```

首先，我必须将名为 Versao (version) 的属性从

```
[Timestamp]
public byte[] Versao { get; set; } 
```

到

```
[ConcurrencyCheck]
public int Versao { get; set; } 
```

因为在更改之前发生了错误（关于类型 rowversion 的某些事情没有被命名空间或别名限定）。进行此更改后，我能够生成迁移，但`Update-Database`命令失败，控制台中显示以下错误：

```
System.FormatException: Cadeia de entrada não estava em um formato incorreto.
    em System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal) 
```

（输入字符串的格式不正确。）

我尝试使用 MySQL 5.5 和 5.1 版本；连接器的6.5.4、6.4.5和6.3.9版本并不能解决问题。

是否可以使用 MySQL、实体框架和代码优先方法？如果不是，那么切换到 ODBC 连接器而不是 .NET 的后果是什么？

在此先感谢，并对这个大问题感到抱歉。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-19T23:50:37.040

我[创建了](https://bitbucket.org/kirk/mysql-data-connector-net-ef5/downloads/mysql-data-connector-net-ef5-2.zip)MySQL Data Connector v.6.6.4 的一个分支，它支持最新版本的 Entity Framework (v.5)。

要使用它，您只需[下载二进制文件](https://bitbucket.org/kirk/mysql-data-connector-net-ef5/downloads/mysql-data-connector-net-ef5.zip)，它们是`MySql.Data`和的替换程序集`MySql.Data.Entity`。还要确保您的项目依赖于 EF5 而不是 4.3。

在您`Enable-Migrations`第一次之后，修改您的`Configuration`类的构造函数以包含以下行：

```
SetSqlGenerator("MySql.Data.MySqlClient", new MySql.Data.Entity.MySqlMigrationSqlGenerator()); 
```

此时，您应该能够运行`Add-Migration`并且`Update-Database`没有问题。

我的 fork 的主要变化如下：

*   二进制文件依赖于 EF5 而不是 EF4.3。

*   EF5 会`dbo.`添加到 MySQL 无法处理的所有表名。因此，我的版本破解了 SQL 迁移生成器以`dbo.`从表名中去除前缀​​。这一切都假设您没有通过`TableAttribute`实体类覆盖模式。

*   它消除了`CreatedOn`Jimi 在他的回答中提到的用法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T08:41:24.783

您还应该尝试[.NET 连接器 6.6](https://blogs.oracle.com/MySqlOnWindows/entry/mysql_connector_net_6_62)，因为它是第一个声称支持 EF 4.3 的版本（第一个带有迁移的版本）。如果它没有帮助，您应该尝试[dotConnect for MySql](http://www.devart.com/dotconnect/mysql/)（至少试用）以查找问题是在 .NET 连接器中还是在 EF 中。ODBC 连接器不适用于 EF。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T17:25:15.747

我认为 .Net Connector 6.6 不支持代码迁移。我已经试过了，当你运行'Update-Database'时你会得到错误，没有为提供者'MySql.Data.MySqlClient'找到MigrationSqlGenerator。使用目标迁移配置类中的 SetSqlGenerator 方法来注册其他 SQL 生成器。dotConnect for MySql 可能会起作用，因为他们说他们已经添加了迁移支持

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-14T20:39:52.293

有一些关于如何使用 EF+Connector/Net+EFMigrations 的有用指南。我认为如果您检查它们会有所帮助。最新版本的 Connector/Net (6.6.4) 依赖于 EF 4.3.1 支持 EF 5 的 Connector/Net 版本仍处于代码阶段。

[如何使用 EF 迁移和连接器/网络](https://blogs.oracle.com/MySqlOnWindows/entry/entity_framework_4_3_1 "如何使用 EF 迁移和连接器/网络")

[使用 Connector/Net 6.6 升级到基于代码的迁移 EF 4.3.1](https://blogs.oracle.com/MySqlOnWindows/entry/upgrading_to_code_first_migrations "使用 Connector/Net 6.6 升级到基于代码的迁移 EF 4.3.1")

希望这可以帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-02-15T12:44:35.440

我收到以下提到的错误

找不到提供程序“MySql.Data.MySqlClient”的 MigrationSqlGenerator。使用目标迁移配置类中的 SetSqlGenerator 方法来注册其他 SQL 生成器。

并得到了这个声明

```
SetSqlGenerator("MySql.Data.MySqlClient", new ySql.Data.Entity.MySqlMigrationSqlGenerator()); 
```

这[![在此处输入图像描述](../Images/f07a75bd713ec5d601eca659565508bf.png)](https://i.stack.imgur.com/3dLRR.png)需要在配置构造函数下设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-01T11:12:33.510

使用 EF CTP5（又名 4.4.0 版）的问题是 CreatedOn 方法已被弃用（用于在数据库中创建相关表）并且 Connector/Net 6.6 正在尝试迁移该表导致异常。

# javascript - 获取全名未知的 cookie

> ID：12380148
> 
> 赞同：0
> 
> 时间：2012-09-12T01:39:04.430
> 
> 标签：javascript, cookies

我正在制作一个将用户输入存储在 cookie 中的网页。我想做出预测，这意味着当用户按下字母“a”时，应该获取所有以“a”开头的 cookie。我怎样才能使用 javascript 做到这一点？实际上，我的网页旨在独立于所有 OS 。

# javascript - JavaScript 运行时是如何工作的？

> ID：12380151
> 
> 赞同：2
> 
> 时间：2012-09-12T01:39:28.203
> 
> 标签：javascript

当JavaScript中同时触发2个事件时，javascript引擎使用单个队列（先入先出），还是引擎内部创建独立线程？如果是第二个选项（因此可能存在并发问题）。

预先感谢您的时间:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T01:40:16.360

JavaScript 是单线程的。两个事件不能完全同时发生，所以按它们到达的顺序处理。

# scala - 如何依赖 GitHub 中的 PlayProject？

> ID：12380153
> 
> 赞同：3
> 
> 时间：2012-09-12T01:40:10.637
> 
> 标签：scala, playframework, playframework-2.0, sbt

我想让一个 Play 2.0 项目依赖于另一个 Play 2.0 项目，我希望它在构建时签出并构建该项目。

我知道如果依赖项目不是 PlayProject，而是标准库，我该怎么做。我可以使用这样的东西。

```
val libDep = RootProject(uri("git://github.com/ChazInc/play2-authenticitytoken.git"))

val main = PlayProject(appName, appVersion, appDependencies, mainLang = SCALA).settings(
  // settings here
).dependsOn(libDep) 
```

这对我来说不适用于 play 项目，因为我需要从 PlayProject 免费获得的特殊构建逻辑来获取依赖项。我看到 PlayProject 可以采用文件参数，但它不像 RootProject 那样采用 URI 参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T13:22:07.137

为了直接使用 git 项目，有问题的项目必须有一个`project`文件夹，该文件夹位于项目的根级别`Build.scala`和/或`plugins.sbt`位于项目的根级别。Play 模块很糟糕，但目前就是这样。

# javascript - 试图处理子窗口上的关闭窗口事件

> ID：12380154
> 
> 赞同：0
> 
> 时间：2012-09-12T01:40:14.090
> 
> 标签：javascript, jquery

我有一个打开一个新窗口的网站。我试图`onclose`在子窗口上触发事件（如果用户关闭窗口，父窗口会提醒它）。

我在以下位置找到了关于该问题的 stackoverflow 问题：[如何在子窗口关闭时运行父窗口的功能？](https://stackoverflow.com/questions/1777864/how-to-run-function-of-parent-window-when-child-window-closes)

但是，答案也会对子窗口执行我认为我无法执行的操作，因为子窗口打开了一个不受我控制的网站（我无法编辑其 html）。

我正在考虑使用以下内容来触发关闭事件

```
var inFormOrLink;
$('a').live('click', function() { inFormOrLink = true; });
$('form').bind('submit', function() { inFormOrLink = true; });

$(window).bind("beforeunload", function() { 
    return inFormOrLink;
}) 
```

如何在新选项卡/窗口上应用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:50:06.957

找到了我正在寻找的解决方案。这比上面的答案要容易得多，加上它的实际效果和我正在寻找的东西。

```
var win = open('http://www.google.com');
if (win.closed) {
    alert('Window closed! Hoorah!');
} 
```

非常感谢任何尝试帮助的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T01:47:53.637

这不可能仅在客户端进行。为此，您需要执行以下操作：

*   打开选项卡后，向脚本发送 ajax 调用，该脚本在收到第二个 ajax 调用之前不会停止加载，这通常是通过在输出之前等待 sql 值存在的脚本来完成的。
*   关闭选项卡后，将第二个 ajax 调用发送到该脚本，以便它回复原始 ajax 调用。

中提琴。

我不知道有更简单的方法来做到这一点。

**原始窗口：**

```
function waitForTabClose(windowID) {
    $.post('waitfortabclose.php',{windowID:windowID},function(data) {
        if (data == 1) { 
             // Do tab closed stuff
        } else {
            waitForTabClose(windowID);
        }
    });
} 
```

**waitfortabclose.php**

```
$i=1;
$wID = $_POST['windowID'];
do {
    if (file_get_contents($wID) == $wID) {
        echo 1;exit;
    }
    set_time_limit(30);
    sleep(5);
} while($i++ < 50);
echo 0; 
```

**新标签**

```
window.onclose = function() {
    $.post('windowclosed.php',{windowID:windowID);
}; 
```

**窗口关闭.php**

```
$wID = $_POST['windowID'];
file_put_contents($wID,$wID); 
```

这是伪代码，未经测试。该功能可以通过多种方式编写，这就是我的做法。

# php - mysql和重复条目报告

> ID：12380156
> 
> 赞同：1
> 
> 时间：2012-09-12T01:40:17.830
> 
> 标签：php, mysql, joomla, joomla2.5

我使用 phpmyadmin 手动更改某些行数据的 id (auto_increment)，因此当我运行我的程序来创建新的行数据时，它返回一个错误“重复的条目 id，因此无法创建行”。这个问题似乎很经典，但我不知道在谷歌上查找的正确关键字或短语。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T01:42:17.077

尝试

```
ALTER TABLE tablename AUTO_INCREMENT=X 
```

其中 X 是高于最高 ID 的某个数字。

我没有对此进行测试，但它可能有效：

```
ALTER TABLE tablename AUTO_INCREMENT=(SELECT MAX(id)+1 FROM tablename) 
```

（由于从正在更改的同一个表中选择，它可能会失败）

# python - 函数运行后返回代码

> ID：12380159
> 
> 赞同：0
> 
> 时间：2012-09-12T01:41:03.320
> 
> 标签：python, text-based

我正在制作一个基于文本的游戏，并且需要一个能够在任何文本输入处被拉出的应用程序范围的命令行。我的计划是将命令包含在一个模块中，然后执行 command()，然后允许用户输入一个命令（或获取一个列表），然后运行（包含在同一模块中）。这不起作用，因为我需要一种返回用户所在位置的方法。无论如何要返回到用户进入命令模式之前的位置，还是有更好的方法来做到这一点？

这是我的想法：

```
import commands

def something():
    print "a question"

    action = raw_input("> ")

    if action == "command":
        commands.commands()
    elif "something else" in action:
        do something
    else:
        error.error(1)
        something() 
```

然后转到commands.py：

```
def commands():
    print "Enter a command, help for a list, blah blah blah."

    command = raw_input("$ ")

    if command == "bag":
        bag()
    elif command == "other":
        other()

def bag():
    print "Action listing things in bag" 
```

问题是返回用户离开的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:40:03.913

你需要的是一个主游戏循环：

```
while game.is_running:
    command = get_user_input()
    user_do(command)
    update_world() 
```

`while`只要`game.is_running`is ，这将重复循环内的三行代码`True`。首先，您获得用户输入。接下来，您对其采取行动。最后，您执行游戏所需的任何其他更新，例如移动或生成怪物。此时，它会循环回来并要求用户输入另一个命令。

**更新：**这是一个工作示例：

```
# In commands.py:
def bag():
    print 'bag'

def other():
    print 'other'

def unrecognized():
    print 'unknown command'

# In main.py:
import commands

def user_input():
    print 'a question'
    return raw_input('>')

def user_do(command):
    # get the matching command out of commands, or pass back
    # the unrecognized function if it's not found
    action = getattr(commands, command, commands.unrecognized)
    action()

is_running = True
while is_running:
    command = user_input()
    if command == 'quit':
        is_running = False
    else:
        user_do(command) 
```

在这个例子中，我作弊了，我依赖于用户输入的命令与要调用的函数的名称相同。在`user_do`中，`getattr`调用将用户输入的字符串与`command`模块的内容进行比较，如果存在则返回同名函数，`unrecognized`如果不存在则返回后备函数。`action`现在将保持命令功能或`unrecognized`.

如果您不想让用户命令与实际函数本身如此紧密地绑定，则可以使用 a`dict`作为分支构造（或*dispatch*）而不是使用大量`if / elif / else`语句：

```
# Modified main.py
import commands

COMMAND_DISPATCH = {
    'bag': commands.bag,
    'sack': commands.bag,
    'other': commands.other,
    # ...
}

# ...

def user_do(command):
    action = COMMAND_DISPATCH.get(command, commands.unrecognized)
    action() 
```

在此示例中，我们不是在模块中查找函数，而是在其中`commands`查找它们`COMMAND_DISPATCH`。

还有一点建议：很快你就会想把用户输入解析成不止一个命令。对于此示例，假设您希望能够接受“command ...”形式的输入。您可以扩展该`user_input`功能以解决此问题：

```
def user_input():
    print 'a question'
    user_input = raw_input('>').split(' ')
    command = user_input[0]
    arguments = user_input[1:]
    return command, arguments 
```

因此，如果您输入“foo bar baz”，这将返回元组`('foo', ['bar', 'baz'])`。接下来我们更新主循环来处理参数。

```
while is_running:
    # use tuple unpacking to split into command, argument pairs
    command, arguments = user_input()
    if command == 'quit':
        is_running = False
    else:
        user_do(command, arguments) 
```

然后确保我们将它们传递给命令：

```
def user_do(command, arguments):
    action = COMMAND_DISPATCH.get(command, commands.unrecognized)
    action(arguments) 
```

最后，我们修改命令以接受和处理参数：

```
def bag(arguments):
    for argument in arguments:
        print 'bagged ', argument 
```

对于文本冒险，您将需要一个更充实的解析器，它可以处理`command object`, `command object preposition subject`，甚至可能`command adjective object ...`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T16:55:32.623

您应该研究“python 有限状态机”。这几乎正​​是您想要的。

*   [迷人的 Python：使用状态机](http://www.ibm.com/developerworks/library/l-python-state/index.html)
*   [有限状态机](http://en.wikipedia.org/wiki/Finite_state_machine)
*   [wiki.python.org/moin/FiniteStateMachine](http://wiki.python.org/moin/FiniteStateMachine)

> 什么是状态机？
> 
> 状态机的一个过于准确的描述是它是一个有向图，由一组节点和一组相应的转换函数组成。机器通过响应一系列事件来“运行”。每个事件都在属于“当前”节点的转换函数的域中，其中函数的范围是节点的子集。该函数返回“下一个”（可能是相同的）节点。这些节点中至少有一个必须是结束状态。当达到结束状态时，机器停止。
> 
> 何时使用状态机...
> 
> 1.  从初始状态开始。
> 2.  读取一行输入。
> 3.  根据输入和当前状态，要么转换到新状态，要么根据当前状态处理行。

与@MatthewTrevor 在他的回答中建议的类似，您将拥有一个主循环，并将“状态”上下文传递给第一个入口点调用（`start`或`intro`其他任何东西）。该调用可以更改状态上下文以指向其他内容。当控制再次回到主循环并检查状态时，它将运行新状态。

# mysql - MySQL 使用 WHERE 语句跨表选择 COUNT()？

> ID：12380160
> 
> 赞同：0
> 
> 时间：2012-09-12T01:41:22.883
> 
> 标签：mysql, performance, count, where

到目前为止，我已经将它与子选择一起使用，但一些研究告诉我使用子选择（尤其是在大表上）是不好的，因为它们的性能较低。

现在这就是我得到的：

```
SELECT COUNT( riddims.riddim ) AS rc, 
(
    SELECT COUNT( tunes.tune )
    FROM tunes
    WHERE tunes.tune NOT
    IN (
        ''
    )
) AS tc
FROM riddims
WHERE riddims.riddim NOT
IN (
    ''
) 
```

这些表看起来像：

```
riddims:
riddim | genre | image

tunes:
riddim | artist | tune 
```

我在玩'JOIN'，但无法真正找出有效的查询。我需要的是类似于[STACKOVERFLOW COUNT FROM MULTIPLE TABLES](https://stackoverflow.com/questions/3761240/count-from-multiple-tables-in-mysql)的东西，其性能比我上面的解决方案更高。

我的目标是执行显示以下输出的查询：

```
riddims | tunes | artist
100     | 400   | 2 
```

*   哪里没有谜语（''）
*   WHERE 不调入（''）
*   WHERE 艺术家 = '某位艺术家'

这就是我开始的方式，但它显然走错了方向：

```
SELECT COUNT(riddims.riddim) AS rc, COUNT(tunes.tune) AS tc FROM riddims LEFT JOIN tunes ON riddims.riddim = tunes.riddim 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:39:41.683

您是否尝试这样做：

```
select riddims, tunes, artists
from (select count(*) as riddims from riddims where . . . ) r cross join
     (select count(*) as tunes from tunes where tunes not in  . . .) t cross join
     (select count(*) as artists from tunes where artist not in . . .) a 
```

您的表似乎没有连接，至少对于这个查询。可能的性能问题是您的选择中的子查询每行都被调用一次。通过将它们放在 FROM 子句中，您可以消除这个可能的问题。

# javascript - 点击时似乎没有触发

> ID：12380162
> 
> 赞同：1
> 
> 时间：2012-09-12T01:41:51.353
> 
> 标签：javascript, event-handling

拥有我想象的可能是一个简单的问题。尽管我在点击“切换”功能中设置了警报，但它们从未出现。我认为问题在于添加事件处理程序，但我真的不知道。任何想法将不胜感激！非常感谢。

索引.html：

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Men With Arms</title>
        <!--<link rel="stylesheet" type="text/css" href="style.css" />-->
        <script type="text/javascript" src="scripts.js"></script>
        <style type="text/css">
            body { margin: 0; padding: 0; background-color: #111; color: #FFF; text-align: center; font-family: "Helvetica Neue Light", Helvetica, sans-serif; }
            #yall { position: absolute; width: 100%; height: 100%; }
            #content { position: absolute; margin: -225px 0 0 -400px; padding: 0.15em; top: 50%; left: 50%; background-color: #FFF; }
            #front { margin: 0; padding: 0; width: 800px; height: 451px; background-color: #000; }
            #lloyd, #dad, #martha { width: 800px; height: 451px; display: none; border: 0; }
            h1 { margin: 0; padding: 0.25em 0 0 0; }
            ul { list-style-type: none; margin: 0; padding: 0.5em 0 0 0; }
            li { padding: 0 0 0 0.5em; display: inline; }
            a:link, a:active, a:visited { color: #FFF; text-decoration: none;  }
            a:hover { color: #FFF; text-decoration: none; border-bottom: 1px solid #FFF; }
            .bottom { position: absolute; left: 40.5%; bottom: .75em; font-size: 11px; padding: 5em 0 0 0; }
            .ltr { unicode-bidi: bidi-override; direction: rtl; }
            /*@font-face { font-family: "Helvetica Neue Light"; src: url('/font/HelveticaNeueDeskUI.ttc'); font-weight: 200; }*/
        </style>
    </head>
    <body>
        <div id="yall">
            <div id="content">
                <div id="front">
                        <h1>MEN WITH ARMS</h1>
                        <ul id="menu">
                            <li><a href="#">LLOYD</a></li>
                            <li><a href="#">DAD</a></li>
                            <li><a href="#">MARTHA</a></li>
                        </ul>
                        <span class="bottom">&copy; mothers favorite pictures 2012<br />
                            <span class="ltr">moc.smrahtiwnem&#64;mom</span>
                        </span>
                </div>
                <iframe id="lloyd" src="http://player.vimeo.com/video/28292168?title=0&amp;byline=0&amp;portrait=0&amp;color=e813c8"></iframe>
                <iframe id="dad" src="http://player.vimeo.com/video/28253343?title=0&amp;byline=0&amp;portrait=0&amp;color=e813c8"></iframe>
                <iframe id="martha" src="http://player.vimeo.com/video/28388076?title=0&amp;byline=0&amp;portrait=0&amp;color=FF7788"></iframe>
            </div>
        </div>
     </body>
 </html> 
```

脚本.js：

```
function toggle(e) {
    alert('click!');
    alert(get_source_element(e).tagName);
    if (get_source_element(e).tagName=='a') {
        document.getElementById(get_source_element(e).innerHTML.toLowercase()).style.display='block';
        document.getElementById('front').style.display='none';
        return false;
    }
    else {
        alert('hide!');
        var frames = document.getElementById('content').getElementsByTagName('iframe');
        for (i = 0; i < frames.length; i++) {
            frames[i].style.display='none';
        }
        document.getElementById('front').style.display='block';
    }
}
// return event source
function get_source_element(e) {
    var targ;
    if (!e) e = window.event;
    if (e.target) targ = e.target;
    else if (e.srcElement) targ = e.srcElement;
    if (targ.nodeType == 3) // defeat Safari bug
        targ = targ.parentNode;
    return targ;
}
function load() {
    document.getElementById('yall').addEventListener('onclick', toggle, false);
    document.getElementById('content').addEventListener('onclick', toggle, false);
    var as = document.getElementById('menu').getElementsByTagName('a');
    for (i = 0; i < as.length; i++) {
        as[i].addEventListener('onclick', toggle, false);
    }
}
document.addEventListener('DOMContentLoaded', load, false); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:04:39.773

你可以试试这个

```
document.addEventListener('DOMContentLoaded', load, false); 
```

或者

```
window.onload=load; // onload will work in all browsers so use this 
```

加载函数

```
function load()
{
    var yall=document.getElementById('yall');
    addEvent(yall, 'click', toggle, false);
    var content=document.getElementById('content');
    addEvent(content, 'click', toggle, false);
    var as = document.getElementById('menu').getElementsByTagName('a');
    for (i = 0; i < as.length; i++) {
        (function(n){
            addEvent(as[n], 'click', toggle, false);
        })(i)
    }
} 
```

`addEvent`与两者一起使用`addEventListener`的功能`attachEvent`

```
function addEvent(el, event, func, bubble) 
{
    if(el.addEventListener) el.addEventListener(event, func, bubble)
    el.attachEvent('on'+event, function(){ func.call(el) }, bubble);
} 
```

还要注意`e`那是你的函数中的`event`对象`toggle`

```
function toggle(e)
{
    e=e||window.event; // if you need event object, that's e
    alert(e.type+' occured on'+this.innerHTML);
} 
```

[**一个例子**](http://jsfiddle.net/2vkjC/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T01:45:04.410

调用时`addEventListener`，应去掉`on`前缀。所以只是`click`。

此外，要支持使用 的浏览器`attachEvent`，请尝试以下操作：

```
var elem = document.getElementById('yall');
(elem.attachEvent || elem.addEventListener)('click',toggle,false); 
```

# python - PyCrypto中的DCPcrypt加密解密

> ID：12380163
> 
> 赞同：1
> 
> 时间：2012-09-12T01:42:01.290
> 
> 标签：python, delphi, encryption, pycrypto

我正在使用 Rijndael 解密使用 DCPcrypt 加密的数据。我想用 Python 来解密它，但我遇到了问题。我会提到我不是特别精通加密（我参加了大学课程，但仅此而已）而且我也不是 Delphi 程序员，所以这也可能阻碍我努力破译 DCPcrypt 正在做什么。

这是 Delphi 代码的核心：

```
Cipher: TDCP_rijndael;
begin
Cipher:= TDCP_rijndael.Create(nil);
Cipher.InitStr(PasswordField.Text);
Cipher.EncryptCBC(encryptString[1],encryptString[1],Length(encryptString)); 
```

因此，该实现使用密钥（从密码字段获得）但没有 IV。另一方面，PyCrypto 需要 IV。搜索 DCPcrypt 代码的内部，似乎如果 IV 为 nil，则使用 E​​CB 加密从 0xff 字符串填充 IV？

```
procedure TDCP_rijndael.Init(var Key; Size: longint; IVector: pointer);
....
  if IVector= nil then
  begin
    FillChar(IV,Sizeof(IV),$FF);
    {$IFDEF CFORM}Encrypt(IV,IV){$ELSE}RijndaelEncryptECB(Data,IV,IV){$ENDIF};
    Move(IV,LB,Sizeof(LB));
  end 
```

看来我正在使用静态 IV。但是，我无法完成这项工作。这是我在 PyCrypto 中的实现。任何想法我做错了什么？

```
key = "password"
s = hashlib.sha1()
s.update(key)
key = s.digest()
key = key[:16]

# Set up the IV, note that in ECB the third parameter to the AES.new function is ignored since ECB doesn't use an IV
ecb = AES.new(key, AES.MODE_ECB, '\xff' * 16)
iv = ecb.encrypt('\xff' * 16)

cipher = AES.new(key, AES.MODE_CFB, iv)
msg = cipher.decrypt(ct[:16]) 
```

我有一些使用 Delphi 代码加密然后 base64 编码的纯文本。使用的密钥是字符串密码，如上面的硬编码。使用我的实现，我解密了一堆乱码。

k8b+uce5Fkp7Hbk/CaGYcuEWTfxlI05as88lJL0mHmJxLsKWqki2YwiFPU9Rx8qiUC2cvWZrQIOnkw==

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T05:13:48.327

随机的各种建议和想法：

1.  静态 IV 通常存在安全风险，因为它们为已知的明文攻击打开了大门。
2.  查看 dcpcrypt 源代码，似乎有一种方法可以指定 IV。如果没有其他原因，除了消除不正确的 IV 作为错误源之外，还有什么理由不这样做？
3.  同样，您可以尝试使用 ECB 而不是 CBC 来完全消除 IV 并隔离问题是在 IV 中还是在其他地方（密钥、数据或配置）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T14:13:59.763

免责声明：我对 Python**非常**

陌生，但试试这个： 尝试改变

```
key = key[:16] 
```

至

```
key = key + bytes([0,0,0,0]) 
```

这将为您提供一个 24 字节的密钥，我认为它应该可以工作。

DCP 允许任何长度的密钥，而 Crypto 坚持使用 16、24 或 32 字节的密钥。默认情况下，DCP 将使用 SHA1 生成密钥，密钥长度为 20 字节。基于此 DCP 使用 keylength <= 24 的逻辑，并且只填充密钥而不是 keylength <= 16 的逻辑，这是 key[:16] 所具有的效果。

另外，不知道这是否只是一个错字，但尝试更改 AES 模式

```
cipher = AES.new(key, AES.MODE_CFB, iv) 
```

至

```
cipher = AES.new(key, AES.MODE_CBC, iv) 
```

这将解密您的输入。但是随后您需要考虑对原始源文本进行填充，因为 DCP 不填充（我认为），但 Crypto 需要 16 的倍数进行解密。

# php - Magento 中的配套/捆绑项目

> ID：12380170
> 
> 赞同：1
> 
> 时间：2012-09-12T01:43:51.367
> 
> 标签：php, magento

我想在我的 magento 商店中创建配套产品。这背后的原因是因为我们销售配套产品，这些产品是我们的个人产品，它们被创建为具有不同定价的定制套件。唯一的问题是我似乎无法显示选项产品附带的？所以我想让我的套件（捆绑产品）显示其他单个产品<--但也能够选择与这些项目相关的属性.. 尺寸/高度颜色等......这可能吗？

# qt - qmake 不生成二进制资源文件

> ID：12380171
> 
> 赞同：1
> 
> 时间：2012-09-12T01:43:56.333
> 
> 标签：qt, makefile, qt-creator, qmake

规格：Qt Creator 2.5.1、Qt 4.7.4(32bit)

我从[Qt 文档](http://doc.qt.nokia.com/4.7-snapshot/resources.html)中了解到，在 Qt的 .pro 文件中包含资源 (.qrc) 是让 qmake 生成正确的 qrc_*.cpp 文件所需的全部内容。我的项目似乎并非如此。运行 qmake 时，会创建 make 文件，并且有对我在 compiler_rcc_clean 下寻找的 qrc_ 文件的引用，只是不在构建链中。

[更新] 根据下面评论的建议，qmake 生成的 makefile 直接使用 NMAKE 进行了测试。创建了正确的 qrc_filter_ao.cpp 文件。但是，当我从 Qt Creator 构建时，IDE 仍然无法正确生成此文件。

.pro：

```
include (../../shared.pri)

TARGET = filter_ao
QT += opengl

HEADERS += ./filter_ao.h
SOURCES += ./filter_ao.cpp

RESOURCES += \
    filter_ao.qrc 
```

共享.pri

```
include (./general.pri)
VCGDIR = ../$$VCGDIR
TEMPLATE      = lib
CONFIG       += plugin
CONFIG       += resources
QT += opengl
QT += xml
QT += xmlpatterns
QT += script

win32-msvc2008:  LIBS += ../../distrib/common.lib
win32-msvc2008:DEFINES += GLEW_STATIC _USE_MATH_DEFINES

INCLUDEPATH  *= ../.. $$VCGDIR ../$$GLEWDIR/include
DEPENDPATH += ../.. $$VCGDIR

win32-msvc2008:DEFINES  += _CRT_SECURE_NO_DEPRECATE
CONFIG(release,debug | release){
  # Uncomment the following line to disable assert in mingw
  #DEFINES += NDEBUG
}

DESTDIR       = ../../distrib/plugins
contains(TEMPLATE,lib) {
  CONFIG(debug, debug|release) {
     unix:TARGET = $$member(TARGET, 0)_debug
     else:TARGET = $$member(TARGET, 0)d
  }
}
win32-msvc2008: RCC_DIR = $(ConfigurationName) 
```

一般.pri

```
 VCGDIR = ../../../vcglib
 GLEWDIR = ../external/glew-1.7.0
 win32:DEFINES += NOMINMAX 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T20:30:59.817

我认为@Pie_Jesu 是正确的。我已经使用来自 OP 的文件建立了一个目录结构，并将 .pro 文件导入到 QtCreator 中。我已经从设置 RCC_DIR 的行中删除了“win32-msvc2008:”前缀，因为我使用的是 VS Express 2010。结果是我收到一条消息，例如“无法打开 \qrc_filter_ao.cpp 进行写入：访问被拒绝”并且没有 qrc_file正在创建。然后我将该行设置为 /TEMP：

```
RCC_DIR = /TEMP 
```

结果是我在 \TEMP 下找到了 qrc_ 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T06:00:35.383

您是否尝试过使用更简单的 .pro 文件？例如，以下对我有用（在 Linux 上，当前没有可用的 MSVC 环境）：

```
TEMPLATE = lib
CONFIG       += plugin
CONFIG       += resources
QT += opengl
QT += xml
QT += xmlpatterns
QT += script

TARGET = filter_ao
QT += opengl

RESOURCES += \
    filter_ao.qrc 
```

确保构建的输出包含对 $QTDIR/rcc 的调用，例如

```
/usr/bin/rcc -name filter_ao filter_ao.qrc -o qrc_filter_ao.cpp 
```

# html - 为什么 DIV 在使用 display:table-cell 时会根据另一个 DIV 的样式定位其内容？

> ID：12380172
> 
> 赞同：0
> 
> 时间：2012-09-12T01:44:19.177
> 
> 标签：html, css

因此，我将网站转换为 HTML5，并丢失了标签……一切都很好，直到我开始使用我的侧边栏和内容区域。

例如，当 中的任何元素`<section id="content">`提供上边距（*#first-article*）时（或当`<section id="content">`提供填充时）， 的内容`<nav id="sidebar">`将位于与 #content 文本相同的 Y 坐标处。

**请注意，我并没有说#sidebar 内容具有相同的样式。**计算样式中没有*padding-top*、*margin*、*postion: top:X*或任何将这些元素定位在相同 Y 坐标上的东西。

在创建布局（和其他 HTML5 块元素）方面，我相当缺乏经验。所以对我来说，能走到这一步，真是太棒了，哈哈。然而，我在其他方面都非常精通css，这就是为什么这让我把头发拉出来......

我使用**display: table-cell**样式来定位**#sidebar**和**#content**。我确信这与它有关。不幸的是，这是我设法让代码做我想做的事情的唯一方法。

***如果大家能在这里给我一些建议，我将不胜感激！与此同时，我将对此进行更多研究。提前谢谢大家:)***

**注意：** *除了我的样式（如下）之外，我还**使用了**html5 样板**文件“ **normalize.css** ”和“ **main.css ”。**他们似乎并没有为我的问题做出贡献......*

**示例**-[我的问题示例](http://www.horsepowerfreaks.com/cleanup/start.asp)

**这是HTML：**

```
<div id="page">

  <header id="head">

   <img id="logo" src="/Images/head/logo-gloss-white.png">

   <nav id="account">
    <ul>
     <li id="phone">Call (503) 256-5600</li>
     <li>Logout</li>
     <li>My Cart (3)</li>
    </ul>
   </nav>

  </header>

  <nav id="main">
   Main Menu
  </nav>

  <nav id="search-bar">
   Select Vehicle and Searchbox
  </nav>

  <nav id="crumbs">
   Directory Tree
  </nav>

  <section id="content-wrap">

    <nav id="sidebar">
      <ul>
       <li>
        <span>Nav</span>
       </li>
      </ul>
    </nav>

    <section id="content">

      <article id="first-article">

       <p>Ecommerce Tracking - Before Google Analytics can report ecommerce activity for your website, you must enable ecommerce tracking on the profile settings page for your website. After that, you must implement the ga.js ecommerce tracking methods in your shopping cart pages or through your ecommerce software. The collection of ecommerce methods work together to send each user's transaction information to the Google Analytics database as it occurs. In this way, Analytics can link a specific referral source to a conversion or purchase. Most template-driven ecommerce engines can be modified to include this information hidden in the order confirmation page.</p>

       <ul>
        <li>General Process</li>
        <li>Guidelines</li>
        <li>Complete Example</li>
        <li>General Process</li>
       </ul>

       <p>The basic process for tracking ecommerce using Google Analytics can best be described by summarizing the three methods required for tracking ecommerce transactions on your site. These methods are described in the order in which you should invoke them in your shopping cart or ecommerce software.</p>
       <p>Create a transaction object. - Use the _addTrans() method to intialize a transaction object. The transaction object stores all the related information about a single transaction, such as the order ID, shipping charges, and billing address. The information in the transaction object is associated with its items by means of the order IDs for the transaction and all items, which should be the same ID.</p>

       <p>Add items to the transaction. - The _addItem() method tracks information about each individual item in the user's shopping cart and associates the item with each transaction via the orderId field. This method tracks the details about a particular item, such as SKU, price, category, and quantity.</p>

       <p>Submit the transaction to the Analytics servers. - The _trackTrans() method confirms that a purchase has occurred, and all data that has been built up in the transaction object is finalized as a transaction.</p>

       <p>There are many ways that this information can be retrieved from the ecommerce engine. Some ecommerce engines write the purchase information to a hidden form that you can use, others keep the information in a database that you can retrieve, and others store the information in a cookie. Some of the more popular ecommerce engines that recognize Google Analytics provide their own modules to simplify order tracking for Analytics.</p>

      </article>

    </section>

  </section>

</div>

<footer id="footer">
 Footer
</footer> 
```

**这是CSS：**

```
body {
    background:#121212 url(/images/body/pageBg.jpg) repeat-x top;
    font-size:12px;
    clor:#333;
}

div#page {
    width:1000px;
    margin:0px auto;
    position:relative;

    border-radius:0px 0px 10px 10px;
    -moz-border-radius:0px 0px 10px 10px;
    -webkit-border-radius:0px 0px 10px 10px;
}

header#head {
    position:relative;
    height:100px;
    background:#121212 url(/images/head/headMetal.jpg) no-repeat right;
    border-bottom:#000 1px solid;
}

nav#main {
    height:44px;
    background:#121212 url(/images/menu/navBarBg.jpg) repeat-x;
}

nav#search-bar {
    height:50px;
    background:#f70 url(/images/menu/orangeBarBg.jpg) repeat-x;
    border-bottom:#F50 1px solid;
}

nav#crumbs {
    color:#575647;
    height:34px;
    background:#fff;
    border-bottom:#eee 1px solid;
}

section#content-wrap {
    background:#e0e0e0;
    border-radius:0px 0px 10px 10px;
    -moz-border-radius:0px 0px 10px 10px;
    -webkit-border-radius:0px 0px 10px 10px;
}

#sidebar {
    display:table-cell;
    width:200px;
    background:#fff;
    border-right:#ccc 1px solid;

    border-radius:0px 0px 0px 10px;
    -moz-border-radius:0px 0px 0px 10px;
    -webkit-border-radius:0px 0px 0px 10px;
}

#content {
    display:table-cell;
    height:500px;
    padding:15px;
}

footer#footer {
    width:970px;
    margin:0px auto;
    color:#fff;
    margin-top:15px;
    height:180px;
    padding:15px;

    background:#1e1e1e url(/images/footer/footBg.jpg) repeat-x center;

    border-radius:10px 10px 0px 0px;
    -moz-border-radius:10px 10px 0px 0px;
    -webkit-border-radius:10px 10px 0px 0px;
}

#page, #footer {
    -moz-box-shadow: 0px 0px 20px #000; /* Firefox */
    -webkit-box-shadow: 0px 0px 20px #000; /* Safari, Chrome */
    box-shadow: 0px 0px 20px #000; /* CSS3 */
}

/* Content */
/*----------------------- This is to demonstrate the issue at hand ------*/
#first-article {
    margin-top:100px;
}

/* Head Area */
img#logo {
    margin:10px 0px 0px 10px;
}

nav#account {
    position:absolute;
    top:0;
    right:0;
}

nav#account {
    margin:0;
}

nav#account li {
    float:left;
    margin-right:15px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:17:47.957

Yes, the `table-cell` thing most likely has everything to do with it. You're forcing 2 elements to act like they are table cells. A nature table cell (a `td` element), falls inline with other `td`s that unless there is a `tr` or `display:table-row` separating them. Those `td`s will naturally have the same height unless they have a `rowspan` > 1\. This means that if you change the `margin-top` or `padding` of one of them, it will affect the other `td`s in the same `tr`.

On top of these issues in modern browsers, earlier browsers (like IE < 8) do not support `display:table-[anything]` anyway, so you'd need backward-compatibility fixes there. I imagine there's no real need for you to use `display:table-cell` because you can likely handle all your positioning through `float`s and standard positioning techniques.

There are plenty of methods for making 2 adjacent 'columns' equal height even though their content heights vary. Check out this [article](http://css-tricks.com/fluid-width-equal-height-columns/) for that. This might help you to steer clear of the `table-cell` displays.

# java - 如何从数组中取出空位？

> ID：12380174
> 
> 赞同：0
> 
> 时间：2012-09-12T01:44:24.760
> 
> 标签：java

我必须制作一个程序，从输入数组中获取重复字符并打印出一个包含所有唯一字符的新数组。

这一切都有效。除非取出字符，否则它会在该新数组的末尾留下一个空框。

```
public class Deleter {

public static void main (String[] args){
    Scanner keyboard = new Scanner(System.in);

    char[] initialInputArray = new char[15];

    System.out.println("How many characters do you wish to enter?");

    int size = keyboard.nextInt();

    while ( size > initialInputArray.length ) {
        System.out.println("Error. Enter smaller number.");
        size = keyboard.nextInt();
    }
    if( initialInputArray.length <= 15) {           
        for ( int counter = 0; counter < size; counter++ ){             
            initialInputArray[counter] = keyboard.next().charAt(0);         
        }
        {

        }
    }

    deleteRepeats(initialInputArray, size); 
    //Comeback to print out array
    {
        for ( int helloWorld = 0 ; helloWorld < size ; helloWorld ++)
            System.out.print(  initialInputArray[helloWorld] );
    }
}

//"deleteReapets" method begins, looking for repeated user inputs
public static char[] deleteRepeats (char[] methodArray, int sizeTwo) {

    if (sizeTwo == 0)
        return methodArray;

    if (sizeTwo == 1)
        return methodArray;

    int uniqueCharacter = 1; 
    //Start at the second entered character.

    for (int x = 1; x < sizeTwo; ++x) { 
        int y;

        for (y = 0; y < uniqueCharacter; ++y) {
            if (methodArray[x] == methodArray[y]) break; // break if we find duplicate.
        }

        if (y == uniqueCharacter) {
            methodArray[uniqueCharacter] = methodArray[x]; // add
            ++uniqueCharacter; // increment uniqueCharacter...[0,uniqueCharacter) is still "unique char list"

        }
    }
    while ( uniqueCharacter < sizeTwo ) {
        methodArray[uniqueCharacter] = 0;
        uniqueCharacter++;

    }

            return methodArray;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:51:10.440

该空框是您在数组末尾添加的空字符。您正在打印它们，因为您没有`size`根据*唯一*字符的数量（可能小于输入大小）进行调整。由于您没有创建新数组，因此您不需要返回`char []`from `deleteRepeats`。相反，您可以返回唯一字符的数量。这样，调用程序就知道要打印多少。

如果您的分配要求`deleteRepeats`返回 a `char[]`，那么您应该分配一个长度完全等于 的新数组`uniqueCharacter`，将唯一字符复制到其中，然后返回它。调用程序可以只打印那个新的（和更短的）数组，而不是打印`size`输入的第一个元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T01:53:04.467

可能最简单的方法是创建一个与您的字符数组大小相同的新数组，然后将所有字符复制到其中。数组的问题在于，一旦它们被初始化，它们就无法调整大小。如果您熟悉 arrayLists，我建议您使用它们。但如果不尝试这样的事情......

```
int count = 0;
for(int i = 0; i < initialInputArray.size; i++){
        count++;
}

char[] newArray = new char[count];

for(int i = 0; i < count; i++){
        newArray[i] = initialInputArray[i];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T02:00:13.140

我建议使用[HashSet](http://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html)删除重复项并将您的 char 包装到[Character](http://docs.oracle.com/javase/7/docs/api/java/lang/Character.html)。像这样的东西：

```
public static Character[] deleteRepeats (char[] methodArray){
    HashSet<Character> set = new HashSet<Character>();

    for(int index = 0; index < methodArray.length; index++){
        set.add(methodArray[index]);
    }

    return set.toArray(new Character[set.size()]);
} 
```

所以在你的主要方法中，你会做的是这样的：

```
Character[] charArray = deleteRepeats(methodArray);
for(int index = 0; index < charArray.length; index++){
    System.out.println(charArray[index]);
} 
```

# javascript - JSONP API 之后的 URL 重定向

> ID：12380176
> 
> 赞同：2
> 
> 时间：2012-09-12T01:44:49.510
> 
> 标签：javascript, cross-domain

## **长版：**

所以，我在我的学校网站上工作，我需要通过同源执法。我不是要欺骗任何人或任何东西；我的学校使用 Google Apps 和单独的成绩簿系统，两者都使用相同的用户名和密码，因为学校已将 Google Apps 登录信息替换为他们自己的单点登录交易。问题是单点登录表单需要在 Google 端生成的 AuthID。因此，当您转到学校的 google 应用程序登录页面时，它会重定向到带有单点登录表单和 url 中的 AuthID 作为 GET 参数的页面。如果我可以使用 Javascript 获取此 AuthID，那么我会很好，用户将能够从我的页面登录。

## **精简版：**

**问题：**我需要向一个 URL 发送一个请求，然后该 URL 会重定向到另一个 URL，该 URL 在我需要的 URL（一个 id）中的 GET 参数中有内容。

**我试过的：**

*   AJAX - 网址在另一个域上，不允许跨域
*   iframe - 不允许获取具有不同域的 iframe 的位置

基本上有人知道跟随 URL 并返回重定向 URL 的 JSONP API 吗？或者完全解决这个问题？

如果我能澄清任何事情，请告诉我。

提前致谢！

* * *

**编辑**：例如[这个站点](http://web-sniffer.net/)正是我所需要的，除了 JSONP API 形式。当我将我的 URL 放在那里时，它会显示一个带有“位置”的 302 重定向标头，其值是我需要的确切 URL。

所以我给它一个这样的网址：

```
https://sso.thewebsite.org/simplesaml/saml2/idp/SSOService.php?app_name=Google&SAMLRequest=... 
```

它表明响应是一个 302 重定向

```
Location: https://sso.thewebsite.org/simplesaml/module.php/core/loginuserpass.php?AuthState=[this_is_what_i_need]... 
```

# matlab - Matlab: int32(2)/int32(3) 给出 1\. 如何得到正常的整数除法？

> ID：12380178
> 
> 赞同：3
> 
> 时间：2012-09-12T01:45:14.267
> 
> 标签：matlab

当我将代码从 C++、Java、Python 等语言移植到 Matlab 中时，需要它以与整数相同的方式运行。

int32(n) 不适用于除法（见帖子标题）。有没有这样的类型？

**编辑：**你猜怎么着，事实证明我最喜欢的语言并没有我想象的那么一致。C++：

```
#include <cstdio>
int main() {
    #define TEST(a, b)  printf("%d / %d = %d\n", (a), (b), (a)/(b));
    TEST(-4, 3);
    TEST(4, -3);
    TEST(-5, 3);
    TEST(5, -3);
    TEST(-1, 2);
    TEST(1, -2);
    return 0;
} 
```

产生：

```
-4 / 3 = -1
4 / -3 = -1
-5 / 3 = -1
5 / -3 = -1
-1 / 2 = 0
1 / -2 = 0 
```

Python：

```
def TEST(a, b): return (a)/(b)

>>> TEST(-4, 3);
-2
>>> TEST(4, -3);
-2
>>> TEST(-5, 3);
-2
>>> TEST(5, -3);
-2
>>> TEST(-1, 2);
-1
>>> TEST(1, -2);
-1 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-12T01:48:32.637

通过“正常整数除法”，我认为您的意思是“地板除法”，就像其他语言一样？

在这种情况下，使用`idivide`显式舍入选项：

```
> idivide(int32(2), int32(3), 'floor')
ans = 0 
```

# jquery - jQuery 百分比值在 IE7 和 IE8 中不起作用

> ID：12380180
> 
> 赞同：0
> 
> 时间：2012-09-12T01:45:23.393
> 
> 标签：jquery, internet-explorer, internet-explorer-8, internet-explorer-7

请帮忙！我为#somediv 创建了一个回调函数，最好使用百分比值使其在响应式模板中正常工作，这是我的代码：

```
before: function(){
   jQuery('#somediv').hide().animate({bottom:'100%'});
}
after: function(){
   jQuery('#somediv').show().animate({bottom:0});
} 
```

不幸的是，上面的代码仅适用于 IE9，如果我使用它会很好：

```
before: function(){
   jQuery('#somediv').hide().animate({bottom:400});
}
after: function(){
   jQuery('#somediv').show().animate({bottom:0});
} 
```

任何帮助，将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:59:14.687

```
before: function(){
   // no need for hidden animations just set the css
   // you cannot animate percents in jQuery as not all browsers will support it
   // using offset parent you can find use the real px height instead of a 100%
   jQuery('#somediv').hide().css({bottom: jQuery('#somediv').offsetParent().height() });
}
after: function(){
   jQuery('#somediv').show().animate({bottom:0});
} 
```

# c# - Excel 互操作 - 取消选择

> ID：12380181
> 
> 赞同：3
> 
> 时间：2012-09-12T01:45:28.113
> 
> 标签：c#, excel, interop, excel-interop

我在 Excel 工作表中复制和插入行，如下所示：

```
 while (rowsToAdd > 0)
   {
      // copy the existing row
      insertionCell.EntireRow.Copy(Type.Missing);

      // location of the new row
      Range newRow = insertionCell.EntireRow.get_Offset(1, 0).EntireRow;

      // insert the new row
      newRow.Insert(XlInsertShiftDirection.xlShiftDown, Type.Missing);

      rowsToAdd--;
   } 
```

我遇到的问题是，有时，我在最初复制的行周围留下了一个选择框。

有没有办法可以取消选择框（通常使用 Escape 键的方式？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T02:12:03.770

Adding

```
myExcelApplication.CutCopyMode = XlCutCopyMode.xlCopy; 
```

seems to do the trick, though the [documentation](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel._application.cutcopymode.aspx) does not explain it very well, and seems to be wrong, since bools are mentioned.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T01:53:44.167

在 VBA 中是`Application.CutCopyMode = False`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-19T09:10:45.770

我知道它已经很老了，但是由于我在将一行复制到另一行时遇到了一些问题，并且当我得到了正确的解决方案时，我现在很高兴分享它，以防万一它可以解决您的问题（考虑复制行而不是插入一个）。

这是解决方案：

```
Microsoft.Office.Interop.Excel.Range xlSourceRow;
Microsoft.Office.Interop.Excel.Range xlNewRow;
xlSourceRow.Copy(xlNewRow); 
```

使用此解决方案可防止在您的 MS-Excel 文件中获得任何选择。

# android - 自定义布局（扩展线性布局）上的单击事件在 IceCream Sandwich 中未触发，但适用于姜饼

> ID：12380188
> 
> 赞同：0
> 
> 时间：2012-09-12T01:47:14.930
> 
> 标签：android, android-layout, android-event

我们有一个扩展线性布局的自定义布局，它有一个按钮。该按钮有一个 OnClickListener 集。此布局被添加到扩展 ScrollView（称为网格）的自定义视图中。

按钮上的 onclick 事件在姜饼中被识别，但在 ICS 中失败。在调试代码时，从不输入按钮的 OnClick，我能识别事件的唯一方法是“OnTouch”

有没有其他人对 ICS 有过同样的经历？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:39:15.933

好的，这就是问题所在，使用姜饼，子视图中的点击事件优先于父触摸事件，但使用 ICS，触摸事件获得优先权。在我的情况下，子视图有一个点击事件并且没有触摸事件，但它的父视图有触摸代码。一旦我在父视图中注释掉触摸事件的代码，代码就会进入子视图的点击事件

# c# - EventLogQuery：如何形成查询字符串？

> ID：12380189
> 
> 赞同：9
> 
> 时间：2012-09-12T01:47:25.407
> 
> 标签：c#, event-log

我有以下代码：

```
string query = "???";

EventLogQuery elq = new EventLogQuery("Application", PathType.LogName, query);
elq.Session = new EventLogSession("x.x.x.x");
EventLogReader elr = new EventLogReader(elq); 
```

我试图弄清楚我需要将查询设置为什么，以便查找具有“SQLSERVERAGENT”源的所有条目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-11-14T15:42:57.173

我刚刚花了一个小时试图为自己解决类似的问题，并认为我会为其他任何以这种方式出现的人提供解决方案。评论应该是不言自明的。

```
public void ReadSqlAgentEventMessages()
{
    // Force culture to en-US if required, some people get a null from FormatDescription() and this appently solves it. 
    // My culture is set as en-GB and I did not have the issue, so I have left it as a comment to possibly ease someone's pain!
    // Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");

    EventLogQuery eventlogQuery = new EventLogQuery("Application", PathType.LogName, "*[System/Provider/@Name=\"SQLSERVERAGENT\"]");
    using (EventLogReader eventlogReader = new EventLogReader(eventlogQuery))
    {
        EventRecord eventRecord = eventlogReader.ReadEvent();
        try
        {

            // Loop through the events returned
            for (null != eventRecord; eventRecord = eventlogReader.ReadEvent())
            {
                // Get the description from the eventrecord. 
                string message = eventRecord.FormatDescription();

                // Do something cool with it :) 
            }
        }
        finally
        {
            if (eventRecord != null)
                eventRecord.Dispose();
        }
    }
} 
```

# ruby-on-rails - 这是继续开发 ruby on rails Web 应用程序的好方法吗？

> ID：12380192
> 
> 赞同：0
> 
> 时间：2012-09-12T01:48:06.777
> 
> 标签：ruby-on-rails

这是继续开发 ruby​​ on rails Web 应用程序的好方法吗？

这是一个注册示例：

**用户模型：** user.rb

```
class User < ActiveRecord::Base
attr_accessible :email, :name, :password, :username
validates_presence_of :email, :name, :password, :username
end 
```

**注册控制器：**注册控制器.rb

```
class SignupController < ApplicationController
def init
    @user = User.new
    render :template => '/signup/signup'
end

def signup
    @user = User.new(params[:user])
    if @user.valid?
        @user.save
        render :template => '/signup/success'
    else
               #bla bla bla
    end
end
end 
```

**注册页面：** signup.html.erb

```
 <h1>Signup!!!</h1>
  <%= form_for(@user, :url => signup_path) do |f| %>
   Name: <%= f.text_field  :name %> </br>
   Email <%= f.text_field :email %> </br>
   Username: <%= f.text_field :username %> </br>
   Password: <%= f.text_field :password %> </br>
   <%= submit_tag "Submit" %>
  <% end %> 
```

**注册过程完成后：** success.html.erb

```
<h1>signup successfull :) </h1> 
```

**路线.rb**

```
get '/index/signup' => 'signup#init', :as => :signup_index
post '/index/signup/' => 'signup#signup', :as => :signup 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T05:23:27.327

[迈克尔杜兰特](https://stackoverflow.com/a/12380438/467546)给出了一些很好的建议，我会小心不要复制。但是，我想添加一些代码更具体的内容。

## 为 Rails 4.0 做准备

我假设这要么是一个练习应用程序，要么是早期开发的东西。不管哪一种对你来说都是正确的，我认为如果你继续采用 Rails 4.0 中的一些新变化，你会变得更好。

新的变化之一是[强参数](http://weblog.rubyonrails.org/2012/3/21/strong-parameters/)。Rails 将放弃`attr_accessible`在模型中的使用，并在控制器中创建一种处理质量分配的新方法。这将允许您根据不同的用户或[命名空间](http://guides.rubyonrails.org/routing.html#controller-namespaces-and-routing)“动态地”更改哪些字段可以更新。

更新到目前为止编写的代码并不是很困难。我已经继续并自己进行了关键更改。

**宝石文件**

```
gem 'strong_parameters' 
```

**用户模型：** `user.php`

```
class User < ActiveRecord::Base
  include ActiveModel::ForbiddenAttributesProtection
  validates_presence_of :email, :name, :password, :username
end 
```

**用户控制器：** `users_controller.php`

```
class UsersController < ApplicationController
  def new
    @user = User.new
  end

  def create
    @user = User.new(user_params)
    if @user.save
      redirect_to login_path, :notice => "You have signed up successfully. You may now login!"
    else
      render :new, :alert => "There was an problem creating your account"
    end
  end

private

  def user_params
    params.require(:user).permit(:email, :name, :password, :username)
  end
end 
```

**注意：**`users_controller.php`除了使用强参数之外，我还做了一些更改。

1.  我更改了动作名称以匹配[Rails 资源动词](http://guides.rubyonrails.org/routing.html#crud-verbs-and-actions)。
2.  我没有调用`.valid?`and `.save`，而是将`if`语句更改为仅使用`.save`. 这是因为`.save`会相应地调用`.valid?`并返回 false。
3.  我修改/添加`redirect_to`并`render`呼吁`create`采取行动。该`redirect_to`调用是一个更重要的更改，因为它有助于防止重复提交表单。

## 为您的表单使用部分

在 Rails 中使用视图的一个很酷的特性是[partials](http://guides.rubyonrails.org/layouts_and_rendering.html#partial-layouts)。部分允许您提取在多个地方使用的 HTML 片段。通过使用部分，您可以`form_for`在一个文件中编写代码并在`new`and`edit`操作中使用它。保持你的代码[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself "不要重复自己")。

另外，我注意到您没有`[<label>](https://developer.mozilla.org/en-US/docs/HTML/Element/label)`在表单中使用标签。这是我认为非常重要的事情，因为它改善了用户体验。

**注意：**我已更改注册页面文件名以匹配我的`users_controller.php`.

**注册页面：** `new.html.erb`

```
<h1>Signup!!</h1>
<%= render :partial => "form" %> 
```

**用户形式：** `_form.html.erb`

```
<%= form_for @user do |f| %>
  <%= f.label :name %>
  <%= f.text_field :name %><br />

  <%= f.label :email, "Email Address" %>
  <%= f.email_field :email %><br />

  <%= f.label :username %>
  <%= f.text_field :username %><br />

  <%= f.label :password %>
  <%= f.password_field :password %><br />

  <%= f.submit "Sign Up" %>
<% end %> 
```

如果您对我发布的内容有任何疑问，请询问。我会尽力解释任何我能解释的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T02:24:16.937

正确使用 Rails 就是遵循它的约定。

*   将初始化更改为新的

*   更改注册以创建。

*   使用资源：用户路由。

最好遵循使用 authLogic 或 Devise 的 railscast，而不是自己动手。

# asp.net-mvc-3 - 在 mvc3 运行时添加和删除文本框

> ID：12380193
> 
> 赞同：0
> 
> 时间：2012-09-12T01:48:08.397
> 
> 标签：asp.net-mvc-3

在我的页面中，默认情况下有一个文本框，旁边有一个添加按钮。当用户单击添加按钮时，我需要添加另一个文本框。在新添加的文本框旁边应该有两个按钮添加和删除。同样的过程继续进行，即用户可以使用添加按钮添加文本框并使用删除按钮将其删除。

我是 mvc 3 的新手，所以我很困惑如何继续。有没有像 asp.net 中的占位符这样的方法，以便我们可以在运行时添加控件。

任何建议和想法都会对我有所帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:26:21.343

这需要一些 Javascript/JQuery ......以下只是一个草图，但希望作为一般方法有用。

*   **移除**按钮_

您想要呈现一个可以针对其自己的容器进行移除的按钮。为此，请使用如下标记：

```
<div class="item-container">
    <input type="button" onclick="removeItem(this)" />
</div> 
```

和 Javascript 用于`removeItem`：

```
<script>
    function removeItem(element) {
        // get the parent element with class "item-container" and remove it from the DOM
        $(element).find(".item-container").remove();
    }
</script> 
```

*   **添加**按钮_

你可以使用 Ajax 的局部视图，或者直接使用 Javascript；哪一个最有可能取决于您是否需要往返服务器来创建新项目。假设您需要去服务器生成一个新的 ID 或其他东西。

首先，创建*局部视图*和对应的控制器动作；这应该包含上面的*删除*按钮，以及文本框和*添加*按钮。

现在，在您的主页上创建一个 Ajax 表单，当您单击**Add**时会调用该表单：

```
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>

@using (Ajax.BeginForm("New", new AjaxOptions() { UpdateTargetId="ajaxTarget", HttpMethod = "GET" })) {
    <input type='submit' value='Add New' />
}

<div id="ajaxTarget"></div> 
```

此代码获取您的部分视图（来自当前控制器中的操作**New**）并将结果添加到`ajaxTarget`元素中。

[**注意**Ajax 表单需要*Unobtrusive Ajax*，您可以通过 Nuget: 安装它`Install-Package JQuery.Ajax.Unobtrusive`。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T01:52:39.770

与 Web 窗体相比，MVC 是一个非常“不干涉”的框架，因此您可以随意添加新的文本框。请注意，MVC 中不存在“控件”。

这是我的做法：

模型：

```
class MyModel {
    public Boolean AddNewTextBox { get; set; }
    public List<String> MultipleTextBoxes { get; set; } // this stores the values of the textboxes.
} 
```

视图（我更喜欢 Web 窗体视图引擎，我不是 Razor 的粉丝）：

```
<% for(int i=0;i<Model.MultipleTextBoxes.Count;i++) { %>
<%= Html.TextBoxFor( m => m.MultipleTextBoxes[i] ) /* this might look like magic to you... */ %>
<% } %>
<button type="submit" name="AddNewTextbox" value="true">Add New Textbox</button>
<button type="submit">Submit form</button> 
```

控制器：

```
[HttpPost]
public ActionResult MyAction(MyModel model) {
    if( model.AddNewTextBox ) model.MultipleTextBoxes.Add("Yet another");

    else if( ModelState.IsValid ) {
        // your regular processing
    }
} 
```

您还可以使用 Javascript 添加更多文本框，它工作得非常好。重要的是 HTML 输入元素。没有神秘的视图状态。MVC 是无状态的。

请注意，因为我使用`<button type="submit">`的示例在 Internet Explorer 6-8 中无法可靠运行（我知道这很糟糕），但您可以将它们替换`<input type="submit">`为不会产生不良影响。

# php - 在 PDO 中，我可以执行（）一个字符串，但不能准备（）然后执行（）它

> ID：12380195
> 
> 赞同：2
> 
> 时间：2012-09-12T01:48:28.783
> 
> 标签：php, pdo, exec, prepare

如果我`PDO::exec()`查询，它会起作用。但是，当我尝试先`PDO::prepare()` *然后* `PDO::execute()`，它*不起作用*。为什么？

例如，这按预期工作：

```
$db->exec($string); 
```

但是，这不是：

```
$stmt = $db->prepare($string);
$stmt->execute(); 
```

没有抛出任何错误，并且`$db->errorInfo`显示全零，表示成功。

这对我来说绝对是零意义。

**编辑*上下文***：

注意，`newDB()`这只是一个使用我需要的设置启动数据库的功能。

当我运行以下命令时，它按预期工作：

```
$db = newDB();

if (!$error) {
    if (isset($id)) {
        try {
            $db->exec('UPDATE Events SET Title = "WHY" , Date = "2012-11-01 00:00:00", Place = "no", Description = "no", UDate = now() WHERE Id = "12"');
        } catch(PDOException $e) {
            $error = 1;
        }
    }
}

$db = null; 
```

但是，这没有，我不知道为什么：

```
$db = newDB();

if (!$error) {
    if (isset($id)) {    
        try {
            $stmt = $db->prepare('UPDATE Events SET Title = "WHY" , Date = "2012-11-01 00:00:00", Place = "no", Description = "no", UDate = now() WHERE Id = "12"');
            $stmt->execute();
        } catch(PDOException $e){
            $error = 1;
        }
    }
}

$db = null; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T02:07:47.010

你有设置异常模式吗？

```
$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

# php - php乘除法

> ID：12380200
> 
> 赞同：0
> 
> 时间：2012-09-12T01:49:16.747
> 
> 标签：php

当我尝试提交值时，它显示“服务器错误”。

在我的第一个文件`index.php`中，我有这个，然后我让它提交给另一个文件，也许它也可以提交给自己？

```
<html>
<body>

<h1>Sale Calculator </h1>

<form action="process.php" method="post">

Cost of item:

<input type="text" name="itemAmt" required="required" />

Percentage of discount:

<select name="saleAmt">
<option value="5">5% off</option>
<option value="10">10% off</option>
<option value="15">15% off</option>
<option value="20">20% off</option>
<option value="25">25% off</option>
<option value="30">30% off</option>
<option value="40">40% off</option>

<!-- Ill fill out more values later -->

</select>

<input type="submit" name="submit" value="submit">

</form>

</body>
</html>

**Then in the second php file process.php I have put this:**

 <?php
    $itemAmt = $_POST['itemAmt'];
    $saleAmt = $_POST['saleAmt'];
    $dollarSaleAmt;
    $totalCost;

    function calculateDiscount($itemAmt, $saleAmt, &$dollarSaleAmt, &$totalCost)
    {

    $dollarSaleAmt = $itemAmt * ($saleAmt / 100);
    $totalCost = $itemAmt – $dollarSaleAmt;
    }

    calculateDiscount($itemAmt, $saleAmt, $dollarSaleAmt, $totalCost);
    ?>

    <html>
    <body>
    The total discount <?php echo $_POST['itemAmt']; ?> .

    <br />

    The final cost minus the discount of <?php echo $_POST['saleAmt']; ?> .

    <br />
    Discount
    <?php echo $dollarSaleAmt; ?>
    <br />
    Total value:
    <?php echo $totalCost; ?>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:11:00.620

# android - 我的应用在 Android 4 上的运行速度比 Android 2 慢

> ID：12380201
> 
> 赞同：0
> 
> 时间：2012-09-12T01:49:26.560
> 
> 标签：android, multithreading, performance, loops, versions

我有一个适用于 Android 的应用程序可以生成声音。

当 CPU 过度工作时，它不会运行足够紧密的循环，结果是音频中出现啪啪声、爆裂声和爆裂声。

我在想，使用更新的设备，这种情况会更少。

但它看起来像在平板电脑和最新手机上，我期望更好的硬件和更流畅的音频，它通常似乎比我的旧旧 Droid 和 Android 2.2.3 更糟糕。

我还有一些测试要做（我通常在 Verizon 或 AT&T 商店测试这些东西，因为我自己买不起所有的硬件），但到目前为止似乎就是这种情况。

我想知道从 Android 2 到 Android 4 是否有任何特定的东西可以解释这一点？

例如，限制线程运行速度的“州长”。

循环在 Thread 的子类的 run() 中运行。它是在一个活动中创建的（而不是一个服务）。

我会发布应用程序的名称和链接（它是免费的），但我担心这可能会被视为垃圾邮件，或者至少是不正当的礼仪。

# objective-c - 在目标 c 中创建链表

> ID：12380209
> 
> 赞同：3
> 
> 时间：2012-09-12T01:50:34.183
> 
> 标签：objective-c

有没有办法在目标 c 中创建链表。我是一个新手，到目前为止我已经在苹果开发者指南中进行了研究，没有为链表预定义的任何函数。双向链表与objective-c中的链表相同吗？

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T02:00:39.487

首先要记住的是，Objective-C*就是*C，它还有很多。

接下来是对象作为（本质上）指针（编译器知道指向对象）传递。

所以你当然可以创建和管理你自己的链表，你可以用结构*或*对象来做。使用对象（可能是首选），只需`@property`在类中为“下一个”对象创建一个，然后随意使用它。类似地，对于双向链表，有一个`@property`for previous。

反对在 Objective-C 中关注点赞列表的最佳论据之一可能是，通常你手头有 Cocoa 框架，并且有如此丰富的特性，我们过去必须用链表来实现自己。例如，概念上简单的 NSMutableArray 或 NSDictionary 是构建良好的组件的绝佳示例，它们通常使我们不再需要链表。更进一步，核心数据等......

一个简单的抽象链表类可能如下所示：

```
@interface LinkedNode : NSObject 
  @property (nonatomic, strong) id nextNode;
@end 
```

然后您可以按预期使用它：

```
id currentNode = myFirstNode;
do {
  [currentNode someMessage];
}
while(currentNode = currentNode.nextNode); 
```

请记住，这实际上并不比使用结构“更好”。对于“更好”的业务，可以转移到 Cocoa 类并在“更高级别”上实现，可以这么说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-07T10:08:52.617

请检查我在目标 C 中实现的一些常见数据结构，如链表、堆栈、二叉搜索树。 [https://github.com/udaypatial/Data-Structures-in-Objective-C](https://github.com/udaypatial/Data-Structures-in-Objective-C)

# cassandra - Cassandra Hector：从事件时间线查询最后 5 个事件

> ID：12380211
> 
> 赞同：1
> 
> 时间：2012-09-12T01:50:40.080
> 
> 标签：cassandra, hector

赫克托：赫克托核心1.0-5，卡桑德拉1.1.2

```
I have a user_event CF created through cqlsh as follows:
user_event(
user_name text,
event_id timeuuid,
event_data text,
PRIMARY KEY(user_name, event_id)) 
```

我试图在 Hector 中编写的查询是：选择当前时间之前给定用户的最后 5 个事件。

我的代码如下：

```
 ...    
    {
        Composite start = compositeFrom(TimeUUIDUtils.getUniqueTimeUUIDinMillis(),
        Composite.ComponentEquality.EQUAL);
        Composite end = compositeFrom(TimeUUIDUtils.getUniqueTimeUUIDinMillis(),
Composite.ComponentEquality.GREATER_THAN_EQUAL);

        List<HColumn<Composite, String>> cList= dao.getCompositeQueryIterator(key,  start,  end, stringSerializer);...
     }

        public static Composite compositeFrom(UUID componentName, Composite.ComponentEquality equalityOp) 
        {
          Composite composite = new Composite();
          composite.addComponent(0, componentName, equalityOp);
          return composite;
        } 
```

我无法弄清楚用于开始和结束组合的运算符和值，以便我将取回按时间排序的最后 n 个事件。另外，另一个问题： getUniqueTimeUUIDinMillis() 是否适合用于 event_id 或者我应该创建一个单独的时间戳列并对其进行切片？

# classloader - 当我们说一个类被加载时，我们的意思是什么？

> ID：12380218
> 
> 赞同：0
> 
> 时间：2012-09-12T01:51:35.383
> 
> 标签：classloader

即：实际加载的是什么。逻辑或类文件或与文件相关的一些元数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:57:06.603

这通常意味着一个类的逻辑和属性已经加载，但根据上下文，它也可能意味着其他事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T15:11:20.363

从类加载器实现的角度来看，调用 ClassLoader.defineClass(...) 时类加载已经完成。即当类被JVM 知道时。

# azure-sql-database - 在 SQL Azure 中复制数据库需要哪些权限

> ID：12380220
> 
> 赞同：6
> 
> 时间：2012-09-12T01:51:39.037
> 
> 标签：azure-sql-database

我使用 SQL Azure 中非常有用的“CREATE AS COPY OF”命令编写了一个小应用程序来备份 SQL Azure 数据库。例如

```
CREATE DATABASE MyNewDB AS COPY OF MyOldDB 
```

我使用管理员登录名运行此命令（创建服务器时获得的第一个登录名）。 **我的问题：新登录名执行上述命令所需的最低权限是多少？**

到目前为止，这是我所做的：

```
-- IN MASTER DB --
CREATE LOGIN DBCreator WITH PASSWORD = '?????????????'
CREATE USER DBCreator FROM LOGIN DBCreator;
EXEC sp_addrolemember 'dbmanager', 'DBCreator';

-- IN MyOldDB --
-- (I ran this stuff when the previous commands didn't do it) --
CREATE USER DBCreator FROM LOGIN DBCreator;
EXEC sp_addrolemember 'db_datareader', 'DBCreator';  -- 
```

运行上述 CREATE DATABASE 命令时的结果：

```
CREATE DATABASE permission denied in database 'MyOldDB'. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-19T21:04:28.447

我无法将 db_owner 角色添加到新登录，命令

```
EXEC sp_addrolemember 'db_owner', 'NewLogin' 
```

抛出错误

`Cannot alter the role 'db_owner', because it does not exist or you do not have permission.`

但是使用 dbmanager 角色有效

```
EXEC sp_addrolemember 'dbmanager', 'NewLogin' 
```

[管理 Windows Azure SQL 数据库中的数据库和登录](http://msdn.microsoft.com/en-us/library/windowsazure/ee336235.aspx)一文中提供了有用的信息。

# linux - 如何在 dpkg-source --commit 调用中抑制编辑器？

> ID：12380226
> 
> 赞同：3
> 
> 时间：2012-09-12T01:52:50.783
> 
> 标签：linux, ubuntu, debian, packaging, dpkg

在 Ubuntu 上精确

我正在调用“dpkg -q --commit ./patchsetname”

当我这样做时，它决定使用选择编辑器二进制文件打开一个编辑器。

我想压制它。有什么想法吗？

我宁愿不必用共享库中断 exec 系统调用并过滤编辑器查询。应该有一种更清洁的方法来做到这一点。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-14T12:16:32.563

我刚刚用以下方法解决了这个问题：

```
EDITOR=/bin/true dpkg-source -q --commit . patchsetname 
```

这将（显然）使用`true`而不是`nano`并且至少在 kubuntu 上这似乎工作正常。

# mfc - SCI_AUTOCSHOW 上闪烁

> ID：12380227
> 
> 赞同：2
> 
> 时间：2012-09-12T01:52:57.350
> 
> 标签：mfc, scintilla

我有一个问题，当我使用

`CallScintilla(SCI_AUTOCSHOW, nLen, (LPARAM)m_strCandidate.c_str())`

显示关于自动完成的窗口，当我输入一个单词时它可以工作，但当我按下退格按钮时它并不总是有效，我想知道是否有一些关于键退格的冲突？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-11-28T10:53:33.723

使用 SCI_AUTOCSETSEPARATOR 设置用于分隔 SCI_AUTOCSHOW 列表中单词的分隔符。默认值为空格字符。

# java - 在 java URI 中编码井号

> ID：12380229
> 
> 赞同：7
> 
> 时间：2012-09-12T01:53:08.083
> 
> 标签：java, uri, urlencode

我有一个应该从 URL 读取文件的 java 程序（URL 位置是 IIS 网站下的虚拟目录；在下面，在我的初始测试中，我将它视为任何其他文件系统位置）。不幸的是，所有需要读取的文件的路径在其中一个目录名称中都包含一个井号 (#)，我无法更改它。当（作为测试）我将它指向路径中没有那个井号的位置时，该程序运行良好。

我首先从传递给程序的字符串创建一个 URL。对于像这样的文件路径`/Documents/#2012/09/11`（其中 Documents 是 Windows 共享），如果我在命令行上传递这样的路径，我可以让程序成功处理：

```
file://serverIPaddress/Documents/\%232012/09/07/16/DOC4671179.DOC 
```

也就是说，将井号手动编码为`%23`，并用反斜杠转义 %23 的 %。

只需一行即可获取该 URL：

```
URL url = new URL(filePath); // filePath is passed in 
```

但是程序不会像这样用勺子喂食编码路径，所以我必须弄清楚如何以编程方式对井号进行编码。继续在[如何对 URL 进行编码以避免 java 中的特殊字符中](https://stackoverflow.com/questions/4571346/how-to-encode-url-to-avoid-special-characters-in-java?rq=1)找到的好建议，我使用多参数构造函数创建了一个 URI（我将传递给程序的参数分解为三个单独的参数以适应这种变化） . 看起来是这样的：

```
URI uri = new URI(protocol, host, filePath, null); // all values are passed in 
```

正确编码了英镑符号；我的 URI 是：

```
file://serverIPaddress/Documents/%232012/09/07/16/DOC4671179.DOC 
```

但是如果没有 前面的反斜杠`%23`，程序会返回`Connection refused`，大概是因为它在没有反斜杠的情况下误解了路径。

所以我想，好吧，我会自己添加反斜杠。我创建了相同的 URI，提取了它的 rawPath，并通过一些字符串操作，在 %23 前面放了一个反斜杠。然后，我使用该新字符串创建了一个新 URI：

```
URI uri = new URI(protocol, host, filePath, null); // all values are passed in
String rawPath = uri.getRawPath();
int pctPos = rawPath.indexOf("%");
String escaped = new String("\\");
String firstPart = rawPath.substring(0,pctPos);
String secondPart = rawPath.substring(pctPos);
String newPath = firstPart + escaped + secondPart;
URI uri2 = new URI(protocol, host, newPath, null); 
```

然而，可以预见的是，这给了我一个这样的 URI：

```
file://<serverIPaddress>/Documents/%5C%25232012/09/07/16/DOC4671179.DOC 
```

同时使用反斜杠和 % 编码。有道理，但在执行时仍然不起作用。

URL API 说：

> URL 类本身并不根据 RFC2396 中定义的转义机制对任何 URL 组件进行编码或解码。调用者有责任对任何字段进行编码，这些字段需要在调用 URL 之前进行转义

所以我想，好吧，我不会创建第二个 URI，而是从我在上次尝试中生成的新字符串创建一个 URL：

```
URI uri = new URI(protocol, host, filePath, null); // all values are passed in
String rawPath = uri.getRawPath();
int pctPos = rawPath.indexOf("%");
String escaped = new String("\\");
String firstPart = rawPath.substring(0,pctPos);
String secondPart = rawPath.substring(pctPos);
String newPath = firstPart + escaped + secondPart;
URL url = new URL(protocol + "://" + host + newPath); 
```

但是在这种方法中，即使我的新路径看起来不错：

```
/Documents/\%232012/09/07/16/DOC4671179.DOC 
```

生成的 URL 返回为：

```
file://serverIPAddress/Documents//%232012/09/07/16/DOC4671179.DOC 
```

在 %23 前面有一个额外的正斜杠而不是反斜杠。

有了这个，我已经没有想法了。

*   是什么让最后一种方法中的反斜杠变成 URL 中的正斜杠？

*   我能做什么去获取我需要的 URI/URL？

*   或者我应该问：如果 %23 是合法 URI 或 URL 的一部分，为什么程序首先需要对 %23 中的 % 进行转义，那么我可以对此做些什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:40:53.800

不知道为什么需要“\”。它取决于服务器代码。实际上“\”在 URL 中不是合法字符，它应该被编码为 %5C

`URI`上课很乱。它可能会默默地将文件 URL 的“\”更改为“/”。

试试这个：

```
 String filePath = "/Documents/#2012/09/11";
    filePath = filePath.replace("#", "\\#");
    URI uri = new URI("file", "serverAddress", filePath, null); 
```

“#”将更改为“%5C%23”。看看它是否有效。

# c# - 在 C# 中通过名称访问类变量

> ID：12380230
> 
> 赞同：2
> 
> 时间：2012-09-12T01:53:10.433
> 
> 标签：c#, asp.net, class, variables

我正在从 xml 文件中读取数据并具有以下 switch 语句

```
switch (localVariable)
{
    case "myStringVariable":
        myClass.myStringVariable= subReader.ReadElementContentAsString();
        break;
    case "myOtherStringVariable":
        myClass.myOtherStringVariable= subReader.ReadElementContentAsString();
        break;
    case "myBoolVariable":
        myClass.myBoolVariable= subReader.ReadElementContentAsBool();
        break; 
```

我想将其优化为类似

```
switch (localVariable)
{
    case "myStringVariable":
    case "myOtherStringVariable":
        myClass.localVariable= subReader.ReadElementContentAsString();
        break;
    case "myBoolVariable":
        myClass.localVariable= subReader.ReadElementContentAsBool();
        break; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:03:39.473

我的猜测是你想要这样的东西：

```
 switch (localVariable)
        {
             case "myStringVariable":
             case "myOtherStringVariable":
                {
                    myClass.GetType()
                           .GetProperty(localVariable)
                           .SetValue(myClass, 
                                     subReader.ReadElementContentAsString(), 
                                     null);
                    break;
                }
             ...
        } 
```

我应该同意其他人的观点，他们告诉我们要在简单的场景中避免反射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T02:04:30.047

您正在寻找的（我认为）有时称为“宏替换”，在 C# 中不可用。您*可以*使用反射来执行类似的操作，以查找具有名称的属性`localVariable`，但除非您有数十个属性要设置和/或您希望避免在添加属性时更改开关，否则可能不值得这样做.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T02:15:59.657

您可以使用反射更进一步：

将以下方法添加到您的类中：

```
 private void SetVariableFromReader(string variableName)
    {
        var property = GetType().GetProperty(variableName);
        if (property != null)
        {
            if (typeof(string).IsAssignableFrom(property.PropertyType))
            {
                property.SetValue(this, subReader.ReadElementContentAsString());
            }
            if (typeof(bool).IsAssignableFrom(property.PropertyType))
            {
                property.SetValue(this, subReader.ReadElementContentAsBool());
            }
            // ...
        }
    } 
```

然后，您无需在代码中使用 switch 语句，只需调用：

```
SetVariableFromReader(localVariable) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T02:33:37.703

使用[FastMember](http://marcgravell.blogspot.com/2012/01/playing-with-your-member.html)库，它正是为此目的，比反射快*WAAAAY 。*

转到 Nuget/包管理控制台：

```
PM> Install-Package FastMember 
```

然后：

```
public class Foo  {
    public string Bar { get; set; }
    public string Baz { get; set; }
}

class Program {
    public static void Main() {
        Foo f = new Foo();
        var wrapped = ObjectAccessor.Create(f);
        string propName = "Baz";
        wrapped[propName] = "Ah ha";
        Console.WriteLine(f.Baz);  //Prints Ah ha
    }
} 
```

或者，在您的情况下：

```
var myWrappedClass = ObjectAccessor.Create(myClass);

        switch (localVariable) {
            case "myStringVariable":
            case "myOtherStringVariable":
                myWrappedClass[localVariable] = subReader.ReadElementContentAsString();
                break;
            case "myBoolVariable":
                myWrappedClass[localVariable] = subReader.ReadElementContentAsBool();
                break;
        } 
```

做完了。真是优雅。

# php - 我似乎无法在 codeigniter 中上传 css 文件类型

> ID：12380232
> 
> 赞同：8
> 
> 时间：2012-09-12T01:53:28.257
> 
> 标签：php, css, codeigniter, file-upload, mime-types

我正在尝试上传一个 css 文件用户 codigniter 的上传类。这是控制器：

```
public function uploadcssfile() 
{
   $config['upload_path'] = './stylesheets/stores/'.$memberid.'/'; 
   $config['file_name'] = 'main.css';    
   $config['allowed_types'] = 'css';   
   $config['overwrite'] = true;   
   $this->load->library('upload', $config);
   if (! $this->upload->do_upload('filefieldname'))
   {
     die($this->upload->display_errors());
   } 
} 
```

我只想上传一个css类型的文件，但codeigniter总是给出这个错误：

```
The filetype you are attempting to upload is not allowed. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T11:04:32.243

我知道，这真的很奇怪，但它对我有用：

在 application/config/mimes.php，第 77 行

```
'css' => 'text/css', 
```

改成：

```
'css' => array('text/css','text/x-c'), 
```

要查看，如果您的开发环境有自己的幽默感并且可以将新的 mime 类型添加到任何文本文件（我的情况），请像​​这样检查您的 mime：

```
if ( ! $this->upload->do_upload(-your-form-input-name-) ){
                    print_r($_FILES['-your-form-input-name-']['type']);
                    exit($this->upload->display_errors(). 'File Type: ' . $this->upload->file_type);
                } 
```

如果上传失败，它将显示您的服务器实际处理的 MIME 类型。

PS。既然您的问题有了答案，[请到这里帮助我](https://stackoverflow.com/questions/12409546/extending-ci-controller-indirect-modification-of-overloaded-property):)

# c++ - 返回 const 值的函数

> ID：12380233
> 
> 赞同：2
> 
> 时间：2012-09-12T01:53:39.143
> 
> 标签：c++, return, constants

> **可能重复：**
> [为了清楚起见，是否应该在返回类型上使用无用的类型限定符？](https://stackoverflow.com/questions/1579435/should-useless-type-qualifiers-on-return-types-be-used-for-clarity)

我对按值返回和返回 const 值感到困惑。例如，在任何函数中，一旦函数完成，所有局部变量都会超出范围。因此，如果我从函数返回一个值，它必须是通过副本传递，除非它是通过引用返回。因此，当这种情况发生时，该函数会返回一个可以稍后修改的副本。因此，即使将局部变量声明为 const，我也可以在另一个变量中读取它并轻松修改后者。

```
const int DoubleValue(int nX)
{
    int nValue = nX * 2;
    return nValue; // A copy of nValue will be returned here
} // n 
```

我对弄清楚`const`这里的含义感到困惑。函数体中有`nValue`const 吗？如果我对 . 进行分配`z = DoubleValue(x);`，我显然可以修改`z`.

在什么情况下执行constness？对象`DoubleValue(x)`是 const 对象吗？它代表什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T02:18:49.620

在极端情况下，您返回一个 const 值会有所作为。如果我从 Scott Meyers 的一本书中没记错的话，如果你重载了一个运算符（比如 +）并且你返回的值不是`const`你可以做的事情：

```
A + B = C; 
```

这不是你想要允许的。以下代码编译（但如果您在运算符中替换`A`为`const A`不会）：

```
#include <iostream>

class A
{
public:
    A(int i): i_(i) {}
    A operator +(A& rhs) { return A(i_ + rhs.i_); }

private:
    int i_;
};

int main(int argc, char* argv[])
{
    A a(1);
    A b(2);
    A c(3);

    a + b = c;

    return 0;
} 
```

# ios - 在用户输入他们的凭据以进行应用内购买后，我可以收到消息吗？

> ID：12380237
> 
> 赞同：0
> 
> 时间：2012-09-12T01:54:03.127
> 
> 标签：ios, in-app-purchase

我想收到一条消息，以便在应用程序与 App Store 通信以完成应用程序内购买时显示“处理中...”覆盖。是否存在仅在用户输入其凭据后才会触发的回调，这样我就不会在 UIAlertView 后面显示“正在处理...”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:00:31.547

结果确实有一个回调，我只是错过了它。`SKPaymentTransactionObserver`' 的方法将`paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions`在事务状态更改时被调用，包括更改为 时`SKPaymentTransactionStatePurchasing`，因此您可以执行以下操作：

```
- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions
{
    for (SKPaymentTransaction *transaction in transactions)
    {
    if (transaction.transactionState == SKPaymentTransactionStatePurchasing) {
        // do your stuff
    }
} 
```

# parsing - Agda：解析嵌套列表

> ID：12380239
> 
> 赞同：11
> 
> 时间：2012-09-12T01:54:37.417
> 
> 标签：parsing, haskell, agda, dependent-type

我正在尝试解析 Agda 中的嵌套列表。我在谷歌上搜索，我发现最接近的是 Haskell 中的解析，但通常使用像“parsec”这样的库，这些库在 Agda 中不可用。

所以我想`"((1,2,3),(4,5,6))"`用`(List (List Nat))`.

并且应该支持进一步的嵌套列表（直到深度 5），例如，深度 3 将是`(List (List (List Nat)))`.

我的代码很长很麻烦，它只适用于嵌套列表，`(List (List Nat))`但不适用于进一步的嵌套列表。我自己没有取得任何进展。

如果有帮助，我想重用我的一个旧帖子`splitBy`的[第一个答案](https://stackoverflow.com/questions/11763639/agda-parse-a-string-with-numbers)。

```
NesList : ℕ → Set
NesList 0 = ℕ -- this case is easy
NesList 1 = List ℕ -- this case is easy
NesList 2 = List (List ℕ) 
NesList 3 = List (List (List ℕ))
NesList 4 = List (List (List (List ℕ)))
NesList 5 = List (List (List (List (List ℕ)))) -- I am only interested to list depth 5
NesList _ = ℕ -- this is a hack, but I think okay for now

-- My implementation is *not* shown here
--
--
-- (it's about 80 lines long and uses 3 different functions
parseList2 : List Char → Maybe (List (List ℕ))
parseList2 _ = nothing -- dummy result

parseList : (dept : ℕ) → String → Maybe (NesList dept)
parseList 2 s = parseList2 (toList s)
parseList _ _ = nothing

-- Test Cases that are working (in my version)

p1 : parseList 2 "((1,2,3),(4,5,6))" ≡ just ((1 ∷ 2 ∷ 3 ∷ []) ∷ (4 ∷ 5 ∷ 6 ∷ []) ∷ [])
p1 = refl

p2 : parseList 2 "((1,2,3),(4,5,6),(7,8,9,10))" ≡ just ((1 ∷ 2 ∷ 3 ∷ []) ∷ (4 ∷ 5 ∷ 6 ∷ []) ∷ (7 ∷ 8 ∷ 9 ∷ 10 ∷ []) ∷ [])
p2 = refl

p3 : parseList 2 "((1),(2))" ≡ just ((1 ∷ []) ∷ (2 ∷ []) ∷ [])
p3 = refl

p4 : parseList 2 "((1,2))" ≡ just ((1 ∷ 2 ∷ []) ∷ [])
p4 = refl

-- Test Cases that are not working 
-- i.e., List (List (List Nat))

lp5 : parseList 3 "(((1,2),(3,4)),((5,6),(7,8)))" ≡ just (  ((1 ∷ 2 ∷ []) ∷ (3 ∷ 4 ∷ []) ∷ []) ∷ ((5 ∷ 6 ∷ []) ∷ (7 ∷ 8 ∷ []) ∷ []) ∷ [])
lp5 = refl 
```

## ***编辑1*** **

康纳在 ICFP 的演讲是在线的——标题是“Agda-curious?”。
这是两天前的事。看看这个！！
.
观看视频：
[http ://www.youtube.com/watch?v=XGyJ519RY6Y](http://www.youtube.com/watch?v=XGyJ519RY6Y)

--
**EDIT2：**
我发现一个链接似乎几乎是我解析所需的代码。
提供了一个`tokenize`功能：
[https ://github.com/fkettelhoit/agda-prelude/blob/master/Examples/PrefixCalculator.agda](https://github.com/fkettelhoit/agda-prelude/blob/master/Examples/PrefixCalculator.agda)

--
**EDIT3：**
我终于找到了一个应该足够快的简单组合库。库中没有包含示例，因此我仍然需要查看如何解决问题。
链接在这里：

## [https://github.com/crypto-agda/agda-nplib/blob/master/lib/Text/Parser.agda](https://github.com/crypto-agda/agda-nplib/blob/master/lib/Text/Parser.agda)

有更多来自 Nicolas Pouillard 的在线代码：
[https ://github.com/crypto-agda](https://github.com/crypto-agda)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T19:28:39.750

我现在无法访问 agda 实现，所以我无法检查语法，但这就是我要解决的问题。

首先，NesList 可以简化。

```
NesList 0 = ℕ
NesList (succ n) = List (NesList n) 
```

然后你需要一个通用的列表解析函数。您可以使用 List 而不是 Maybe 来指定替代解析。返回值是一个成功的解析和字符串的剩余部分。

```
Parser : Set -> Set
Parser a = List Char -> Maybe (Pair a (List Char)) 
```

这给定类型 x 的解析器例程，解析 x 的括号描述的逗号分隔列表。

```
parseGeneralList : { a : Set } Parser a -> Parser (List a)
parseGeneralList = ...implement me!... 
```

这会解析一个通用的 NesList。

```
parseNesList : (a : ℕ) -> Parser (NesList a)
parseNesList 0 = parseNat
parseNesList (succ n) = parseGeneralList (parseNesList n) 
```

编辑：正如评论中指出的那样，使用这种解析器的代码不会通过 agda 的终止检查器。我在想，如果你想做解析器组合器，你需要一个基于 Stream 的设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-09T03:32:37.463

我参加聚会有点晚了，但我目前正在编写一个完整的解析器组合库，并且我有一个相当紧凑的解决方案，重新使用`NesList`@NovaDenizen 建议的简洁类型。

我使用差异列表，但基本列表也可以（我们只需替换`DList.toList`为，`List.reverse`因为`chainl1`从左到右聚合值）。

```
NList : Set → ℕ → Set
NList A zero    = A
NList A (suc n) = List (NList A n)

NList′ : {A : Set} → [ Parser A ] →
         (n : ℕ) → [ Parser (NList A n) ]
NList′ A zero    = A
NList′ A (suc n) = parens $ return $ DList.toList <$>
                   chainl1 (DList.[_] <$> NList′ A n)
                           (return $ DList._++_ <$ char ',') 
```

所有测试用例都成功通过。我已将示例添加到[（整体）poc 文件](https://github.com/gallais/potpourri/blob/master/agda/poc/ParserCombinator.agda)中，以便您自己检查

```
_ : "((1,2,3),(4,5,6))" ∈ NList′ decimal 2
_ = (1 ∷ 2 ∷ 3 ∷ []) ∷ (4 ∷ 5 ∷ 6 ∷ []) ∷ [] !

_ : "((1,2,3),(4,5,6),(7,8,9,10))" ∈ NList′ decimal 2
_ = (1 ∷ 2 ∷ 3 ∷ []) ∷ (4 ∷ 5 ∷ 6 ∷ []) ∷ (7 ∷ 8 ∷ 9 ∷ 10 ∷ []) ∷ [] !

_ : "((1),(2))" ∈ NList′ decimal 2
_ = (1 ∷ []) ∷ (2 ∷ []) ∷ [] !

_ : "((1,2))" ∈ NList′ decimal 2
_ = (1 ∷ 2 ∷ []) ∷ [] !

_ : "(((1,2),(3,4)),((5,6),(7,8)))" ∈ NList′ decimal 3
_ = ((1 ∷ 2 ∷ []) ∷ (3 ∷ 4 ∷ []) ∷ []) ∷
    ((5 ∷ 6 ∷ []) ∷ (7 ∷ 8 ∷ []) ∷ []) ∷ [] ! 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T17:45:14.047

我在这里使用解析器组合器发布我的解决方案。它使用[github 上的 agda-nplib 库](https://github.com/crypto-agda/agda-nplib/tree/master/lib/Text)。该代码远非最佳，但它可以工作。

```
module NewParser where

-- dummy
open import Data.Maybe
open import Data.Bool

-- includes
open import Data.List hiding (map)

-- ***
-- WAS PRELUDE IMPORTS
open import StringHelpers using (charToℕ; stringToℕ)
open import Data.String hiding (_==_; _++_)
open import Data.Char
open import Function
open import Data.Nat
open import Data.Unit
open import Data.Maybe

-- https://github.com/crypto-agda/agda-nplib/tree/master/lib/Text
open import Text.Parser
open import ParserHelpers

--- ****
--- Lessons Learned, this is the key:
--- (was a basic error that tyeps where too specific, generalisation not possible)

-- parseList : {A : Set} → Parser (Maybe A) → Parser (Maybe A) → ℕ → Parser (List (Maybe A))
-- converted to
-- parseList : {A : Set} → Parser A → Parser A → ℕ → Parser (List A)

-- *****
-- General ... Normal List (depth 1)

parseList : {A : Set} → Parser A → Parser A → ℕ → Parser (List A)
parseList oneMatcher manyMatcher n = ⟪ _++_ · (map toL oneMatcher) · (many n manyMatcher) ⟫

parseBracketList : {A : Set} → Parser A → Parser A → ℕ → Parser (List A)
parseBracketList oneMatcher manyMatcher n = bracket '(' (parseList oneMatcher manyMatcher n) ')'

parseCommaListConvert : {A : Set} → (List Char → A) → (Parser (List Char)) → ℕ → Parser (List A)
parseCommaListConvert convert parser = parseBracketList (⟪ convert · parser ⟫) (⟪ convert · parseOne "," *> parser ⟫) 

-- For Numbers

number : Parser (List Char)
number = manyOneOf (toList "1234567890")

parseNumList : ℕ → Parser (List (Maybe ℕ))
parseNumList = parseCommaListConvert charsToℕ number

-- Nested List (depth 2)
--

parseListListNum : ℕ → Parser (List (List (Maybe ℕ)))
parseListListNum n = parseList (parseNumList n) ((parseOne ",") *> (parseNumList n)) n

parseManyLists : ℕ → Parser (List (List (Maybe ℕ)))
parseManyLists n = bracket '(' (parseListListNum n) ')'

-- Run the Parsers
--

open import MaybeEliminatorHelper

-- max number of terms is the number of characters in the string
-- this is for the termination checker
runParseList' : String → Maybe (List (Maybe ℕ))
runParseList' s = runParser (parseNumList (strLength s)) (toList s)

runParseList : String → Maybe (List ℕ)
runParseList = maybe-list-maybe-eliminate ∘ runParseList'

-- nested list
runParseNesList' : String → Maybe (List (List( Maybe ℕ)))
runParseNesList' s = runParser (parseManyLists (length (toList s))) (toList s)

runParseNesList : String → Maybe (List (List ℕ))
runParseNesList = maybe-list-list-maybe-eliminate ∘ runParseNesList' 
```

这是我的辅助功能：

```
module MaybeEliminatorHelper where

open import Data.Maybe
open import Category.Monad
open import Function

open import Data.List

open import Category.Functor

sequence-maybe : ∀ {a} {A : Set a} → List (Maybe A) → Maybe (List A)
sequence-maybe = sequence Data.Maybe.monad

join : {A : Set} → Maybe (Maybe A) → Maybe A
join m = m >>= id
  where 
    open RawMonad Data.Maybe.monad

maybe-list-elem : {A : Set} → Maybe (List (Maybe A)) → Maybe (List A)
maybe-list-elem mlm = join (sequence-maybe <$> mlm)
  where open RawFunctor functor

{-
sequence-maybe : [Maybe a] -> Maybe [a]

join :: Maybe (Maybe a) -> Maybe a

Maybe (List (List (Maybe A))
  Maybe.fmap (List.fmap sequenc-maybe)
Maybe (List (Maybe (List A))
  Maybe.fmap sequence-maybe
Maybe (Maybe (List (List A)))
  join
Maybe (List (List A))

join . Maybe.fmap sequence-maybe . Maybe.fmap (List.fmap sequenc-maybe)

join . Maybe.fmap (sequence-maybe . List.fmap sequenc-maybe)
(short form)

-}

maybe-list-elem2 : {A : Set} → Maybe (List (List (Maybe A))) → Maybe (List (List A)) 
maybe-list-elem2 = join ∘ Mfmap (sequence-maybe ∘ Lfmap sequence-maybe)
  where
    open RawMonad Data.Maybe.monad hiding (join) renaming (_<$>_ to Mfmap)
    open RawMonad Data.List.monad hiding (join) renaming (_<$>_ to Lfmap)

maybe-list-maybe-eliminate = maybe-list-elem

maybe-list-list-maybe-eliminate = maybe-list-elem2 
```

其他辅助功能：

```
-- ***
-- WAS PRELUDE IMPORTS
open import StringHelpers using (charToℕ; stringToℕ)

open import Data.String hiding (_==_)
open import Data.Char
open import Function
open import Data.Nat
open import Data.Unit
open import Data.Maybe

open import Text.Parser

open import Data.List

-- mini helpers
--

parseOne : String → Parser Char
parseOne = oneOf ∘ toList 

strLength : String → ℕ
strLength = length ∘ toList 

-- misc helpers
--

charsToℕ : List Char → Maybe ℕ
charsToℕ [] = nothing
charsToℕ xs = stringToℕ (fromList xs)

toL : ∀ {a} {A : Set a} → A → List A
toL x = x ∷ []

-- test
l : List (Maybe ℕ)
l = (just 3) ∷ (just 3) ∷ []

-- Parser Helpers Nicolas
--
isSpace : Char → Bool
isSpace = (_==_ ' ')

spaces : Parser ⊤
spaces = manySat isSpace *> pure _

-- decide if seperator before after brackets is spaces
someSpaces : Parser ⊤
someSpaces = someSat isSpace *> pure _

tok : Char → Parser ⊤
tok c = spaces *> char c *> pure _

bracket : ∀ {A} → Char → Parser A → Char → Parser A
bracket start p stop = tok start *> p <* tok stop 
```

还有一些测试用例：

```
tn09 : pList "12,13,,14" ≡ nothing
tn09 = refl

tn08 : pList "" ≡ nothing
tn08 = refl

tn07 : pList "12,13,14" ≡ nothing
tn07 = refl

-- not working tn06 : pList "(12,13,14,17)," ≡ nothing
-- not working tn06 = refl

tn05 : pList "aa,bb,cc" ≡ nothing
tn05 = refl

tn04 : pList "11" ≡ nothing 
tn04 = refl

tn03 : pList "(11,12,13)" ≡ just (11 ∷ 12 ∷ 13 ∷ [])
tn03 = refl

-- new testcases
tn11 : pList2 "((1,2,3),(4,5,6),(7,8,9))" ≡ just ((1 ∷ 2 ∷ 3 ∷ []) ∷ (4 ∷ 5 ∷ 6 ∷ []) ∷ (7 ∷ 8 ∷ 9 ∷ []) ∷ [])
tn11 = refl

-- old testcases
p1 : pList2 "((1,2,3),(4,5,6))" ≡ just ((1 ∷ 2 ∷ 3 ∷ []) ∷ (4 ∷ 5 ∷ 6 ∷ []) ∷ [])
p1 = refl

p2 : pList2 "((1,2,3),(4,5,6),(7,8,9,10))" ≡ just ((1 ∷ 2 ∷ 3 ∷ []) ∷ (4 ∷ 5 ∷ 6 ∷ []) ∷ (7 ∷ 8 ∷ 9 ∷ 10 ∷ []) ∷ [])
p2 = refl

p3 : pList2 "((1),(2))" ≡ just ((1 ∷ []) ∷ (2 ∷ []) ∷ [])
p3 = refl

p4 : pList2 "((1,2))" ≡ just ((1 ∷ 2 ∷ []) ∷ [])
p4 = refl 
```

我愿意接受改进代码的建议。

# c - 下面的联合是什么意思？

> ID：12380242
> 
> 赞同：1
> 
> 时间：2012-09-12T01:55:06.473
> 
> 标签：c, unions

```
struct  ifreq {
    char    ifr_name[IFNAMSIZ];             
    union {
            caddr_t ifr_d;
    } ifr;
}; 
```

在这里他们使用了联合，我不明白为什么当那里只使用一个元素时他们使用？我有一个想法，只有在需要使用 2-3 个元素时才使用联合。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T01:59:11.427

大量的可能性。但是，在这种情况下，似乎是因为定义是从相应的 Linux 头文件中删除的，他们只取了他们需要的部分。`struct ifreq`看起来像这样，通常：

```
struct ifreq {
    char ifr_name[IFNAMSIZ]; /* Interface name */
    union {
        ...
    };
}; 
```

# asp.net-mvc - StructureMap 异常：没有为 PluginFamily System.Collections.Generic.IDictionary2 定义默认实例

> ID：12380246
> 
> 赞同：1
> 
> 时间：2012-09-12T01:56:14.190
> 
> 标签：asp.net-mvc, structuremap

初始化我的 ObjectFactory 时，我从 StructureMap 收到以下错误。

> StructureMap.StructureMapException 发生 HResult=-2146232832
> Message=StructureMap 异常代码：202 没有为 PluginFamily System.Collections.Generic.IDictionary `2[[System.Type, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Func`2 [[System.Data.Entity.DbContext，EntityFramework，Version=5.0.0.0，Culture=neutral定义默认实例, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]], mscorlib, 版本=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 Source=StructureMap ErrorCode=202 StackTrace: at StructureMap.BuildSession.<.ctor>b__0(Type t) in c:\BuildAgent\work\767273992e840853\src\StructureMap\BuildSession。 cs：第 33 行内部异常：

从以前的答案来看，我似乎缺少对程序集的引用，但我现在包含了很多。这是我的完整初始化声明：

```
 ObjectFactory.Initialize(x =>
                                   {
                                       x.Scan(scan =>
                                                  {
                                                      scan.TheCallingAssembly();
                                                      scan.WithDefaultConventions();
                                                      scan.AssembliesFromApplicationBaseDirectory();
                                                  });
                                       x.For<IRepositoryProvider>().Use<RepositoryProvider>();
                                       x.For<IDataUow>().Use<DataInterface>();
                                       x.Forward<IDataUow, IDisposable>();
                                       x.For<RepositoryFactories>().Singleton();
                                   }); 
```

# java - 如何从war solaris服务器访问windows的文件系统？

> ID：12380247
> 
> 赞同：1
> 
> 时间：2012-09-12T01:56:21.210
> 
> 标签：java, spring-mvc, solaris, weblogic-10.x

我需要从 solaris 服务器访问文件系统或路径 windows 的 txt 文件。我将 .war 部署到服务器 weblogic solaris 中，但我无法从服务器到客户端（在本例中为 windows 系统或任何系统）获取 txt 文件。

对txt文件的访问来自，

```
<input type="file" name="filename" /> 
```

![在此处输入图像描述](../Images/dcdf93b596781f2d9c8475ba3168d7d1.png)

我需要从客户端读取文件，但我有**FileNotFoundException**

**请帮我**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:35:33.033

您在服务器上运行的 Spring MVC 应用程序不会访问客户端计算机上的原始文件（否则网站可能会对您的计算机造成不良影响） - 浏览器通过线路将文件的副本发送到您的控制器。

这是我用来将上传的文件复制到服务器的文件系统的代码片段：

```
@RequestMapping(value = "/upload", method = RequestMethod.POST)
public String uploadFile(
    HttpServletResponse response,
    @RequestParam(value="filename", required=true) MultipartFile multipartFile,
    Model model) throws Exception {

    if (!multipartFile.isEmpty()) {
        String originalName = multipartFile.getOriginalFilename();
        final String baseTempPath = System.getProperty("java.io.tmpdir"); // use System temp directory
        String filePath = baseTempPath + File.separator + originalName;
        File dest = new File(filePath);

        try {
            multipartFile.transferTo(dest); // save the file
        } catch (Exception e) {
            logger.error("Error reading upload: " + e.getMessage(), e);
            response.sendError(HttpServletResponse.SC_BAD_REQUEST, "File uploaded failed: " + originalName);
        }
    }
} 
```

# c# - 使用具有多态性的 foreach 会产生空引用异常？

> ID：12380250
> 
> 赞同：0
> 
> 时间：2012-09-12T01:57:11.267
> 
> 标签：c#, foreach, polymorphism

所以我试图遍历所有从 BaseClass 继承的对象数组，我的代码如下所示：

```
ChildClass object1 = new ChildClass();
OtherChildClass object2 = new OtherChildClass();
BaseClass array[] = {object1, object2}

foreach(BaseClass element in array)
{
    //do stuff
} 
```

显然 ChildClass 和 OtherChildClass 继承自 BaseClass。//do stuff 的语句每次都会给出一个空引用异常，当我查看局部变量赋值时，果然“元素”为空......但“数组”远非空！

在我看来，foreach 没有拾取数组中的项目，因为它们不完全是基类，但我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:15:21.977

疯狂猜测：您正在执行的代码不是您上面的代码；您上面的代码将无法编译，因为您的数组声明必须是：

```
BaseClass[] array = {object1, object2}; 
```

试一试，然后执行一个`clean`或`rebuild`步骤。

# javascript - 使用 RegExp 在 url 中查找字符

> ID：12380251
> 
> 赞同：0
> 
> 时间：2012-09-12T01:57:18.047
> 
> 标签：javascript, jquery, regex

“/产品/手表”

对于上面的字符串，我只是想匹配反斜杠和它们之间的字符。所以在这种情况下，我只想匹配 /products/

使用 RegExp 执行此操作的基本方法是什么，或者我可以使用 Jquery

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:12:35.067

```
var str = "/products/watch";
var matches = str.match(/\/(.*?)\//);
if (matches) {
    // matches[0] is the full match including slashes "/products/"
    // matches[1] is the chars between the slashes "products"
} 
```

工作演示：http: [//jsfiddle.net/jfriend00/8AAAE/](http://jsfiddle.net/jfriend00/8AAAE/)

# c# - C#从逗号两边的数字中设置变量？

> ID：12380254
> 
> 赞同：0
> 
> 时间：2012-09-12T01:57:54.573
> 
> 标签：c#, textbox, numbers

我有一个文本框，用户可以在其中输入一组用逗号分隔的数字（“1、2、3、4”）。我需要为这些数字中的每一个设置一个变量。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:00:01.253

为什么不将它存储在数组中？

```
string val = textbox.text;
string[] arr = val.Split(','); 
```

例子

```
using System;

class Program
{
    static void Main()
    {
         string s = "1,2,3,4";
         string[] numbers = s.Split(',');
         foreach (string num in numbers)
         {
             Console.WriteLine(num);
         }
    }
} 
```

输出

```
1
2
3
4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T02:00:08.763

取文本框的值并将其以逗号分隔。然后，您将拥有一个足以供进一步使用的值的字符串数组。

[http://www.dotnetperls.com/split](http://www.dotnetperls.com/split)

# .htaccess - 你如何用 htaccess 解决这个问题？

> ID：12380256
> 
> 赞同：0
> 
> 时间：2012-09-12T01:58:27.570
> 
> 标签：.htaccess

你能帮我解决我的这个 htaccess 问题吗？

我的网址是：

```
mysite.com/blog.php?post=01/01/2012/my-first-post 
```

我想把它变成这样：

```
mysite.com/post/01/01/2012/my-first-post/ 
```

我通过使用这个部分解决了这个问题：

```
RewriteRule    ^post/([A-Za-z0-9-]+)/?$    blog.php?postd=$1    [NC,L] 
```

现在问题来了。当我尝试单击第二个帖子“01/01/2012/my-second-post”时，它应该去

```
mysite.com/post/01/01/2012/my-second-post 
```

但作为回报

```
mysite.com/post/01/01/2012/my-first-post/01/01/2012/my-second-post 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:08:21.783

尝试在所有页面的标题中添加：

```
<base href="/"> 
```

# ipad - iPad CSS3 webkitTransform 和触摸事件 - 轻微的无法解释的口吃

> ID：12380257
> 
> 赞同：2
> 
> 时间：2012-09-12T01:58:41.063
> 
> 标签：ipad, html, css, webkit, css-transitions

这与图像库有关，因此当您“滑动”时，图像会从屏幕上加载和卸载，但中心图像始终会平滑显示。

它是从这里描述的 swipeview 库派生的代码：http: [//cubiq.org/swipeview](http://cubiq.org/swipeview)

问题是，在 javascript 在触摸结束事件中设置 webkitTransform 和元素实际开始在屏幕上动画之间存在 100-200 毫秒的延迟。

这种有问题的延迟只会间歇性地发生；在卸载/加载大约 15-20 张幻灯片后，它似乎开始持续发生。

在触摸移动事件中有这样的代码：

```
element.style.webkitTransitionDuration = 0
element.style.webkitTransform = "translate3d( etc. ) " 
```

而且这个功能非常快，因此如果您在 ipad 上移动手指，元素会精确且“立即”跟随您的手指。

在触摸结束事件中有这样的代码：

```
element.style.webkitTransitionDuration = '<some_number>ms';
element.style.webkitTransform = "translate3d( etc. ) " 
```

触摸结束事件就是问题所在。touch End 事件本身会在手指从 ipad 上移开的那一刻触发，但是，当问题发生时，css 更新不会触发屏幕上的实际动画，直到出现上述问题延迟之后。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T08:13:33.567

这是一个棘手的问题。我终于找到了罪魁祸首。在我的 touchend 事件监听器中，我调用了一个向 DOM 元素添加类的函数。这导致 Safari 需要一些时间将纹理重新连接到 GPU，从而导致卡顿。删除那些直接的 className 更新使它再次变得非常顺利（我仍在使用 requestAnimationFrame 而不是 CSS 过渡）。

我将我的 className 更改移动到从 touchend 触发的单独事件中，它不会导致任何性能问题。因此，如果您必须设置类，请不要直接在 touchend 回调中进行设置。改为触发另一个事件或在 requestAnimationFrame 中设置类。

# wpf - 如何使用 wpf datagrid 超链接导航到 .pdf 文件？

> ID：12380260
> 
> 赞同：1
> 
> 时间：2012-09-12T01:58:55.700
> 
> 标签：wpf, datagrid, hyperlink, wpf-controls

我有一个 WPF 数据网格，它有一个超链接列。超链接是我在系统上拥有的 PDF 文档（不在特定文件夹中）。如何编写代码以导航到文档？当我单击超链接时，它会给出错误“无法导航到应用程序资源”。请问我该如何解决这个错误？

谢谢你。

# regex - 使用 perl 替换没有重音和相关数字的重音单词

> ID：12380262
> 
> 赞同：1
> 
> 时间：2012-09-12T01:59:02.157
> 
> 标签：regex, perl, replace

任何带重音的单词都需要去除重音，然后在单词的末尾添加一个相应的数字。

**例子：*

```
gàr must appear as gar3 
```

▶ 单词只会显示重音和重音，应分别翻译为在单词末尾添加 2 和 3。

▶ 单词可能伴随着空格、制表符、回车、连字符（长或短）、括号、问号等。

▶ 单词将包括非 ASCII 字符，如 shin（上面有一个有趣的倒置帽子）

谁能建议正确的结构、正则表达式和替换模式？

谢谢 ！

这是一个测试样本：

```
14 IGI <DIŠ>⌈x⌉-èr-ra 
15 IGI <DIŠ>bu-ṣí-ia 
16 IGI <DIŠ>su-ka-lum
17 IGI <DIŠ>ì-lí-tu-[...x-...x] 
18 ⌈MU⌉&lt;ON:>KI.BAL.BAR.RÚ:KI 
```

它应该导致：

```
14 IGI <DIŠ>⌈x⌉-er3-ra
15 IGI <DIŠ>bu-ṣi2-ia
16 IGI <DIŠ>su-ka-lum
17 IGI <DIŠ>i3-li2-tu-[...x-...x]
18 ⌈MU⌉&lt;ON:>KI.BAL.BAR.RU2:KI 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-04T13:51:52.650

这是一个不活跃的问题，但由于它可能对搜索类似问题的人有用，所以这里的代码完全符合您的要求：

```
use utf8;
use Unicode::Normalize;

my $text='IGI <DIŠ>bu-ṣí-ia'; #your input data

my $x=NFD($text); #Normalization Form D (1)
$x=~s/\x{300}/3/g; #substitute grave accents with number 3 (2)
$x=~s/\x{301}/2/g; #substitute acute accents with number 2 (2)
$x=NFC($x); #Normalization Form C (1)
print $x; #prints "IGI <DIŠ>bu-ṣi2-ia" 
```

¹我不是 Unicode 专家，所以我不足以清楚而正确地解释这些函数究竟做了什么。[这些](https://en.wikipedia.org/wiki/Unicode_equivalence) [文章](http://unicode.org/reports/tr15/#Norm_Forms)或[谷歌](https://www.google.com/search?q=unicode+normalization+forms)可能会给你一个更好的主意。

²检查[Unicode 表](http://www.tamasoft.co.jp/en/general-info/unicode.html)中的值 300 和 301。

# c# - 这个 ToArray() 实现如何更优化？

> ID：12380266
> 
> 赞同：1
> 
> 时间：2012-09-12T01:59:30.277
> 
> 标签：c#, .net, arrays, optimization

我只是看一下我们的代码库的历史记录，并发现了一个从这里发生变化的签入：

```
 public virtual T[] ToArray()
    {
        List<T> list = new List<T>();
        foreach (object item in List)
        {
            list.Add((T)item);
        }

        return list.ToArray();
    } 
```

对此：

```
 public virtual T[] ToArray()
    {
        T[] result = new T[List.Count];
        for (int i = 0; i < List.Count; ++i)
        {
            result[i] = (T)List[i];
        }

        return result;
    } 
```

附注：优化 ToArray 实现以避免在过程中创建多个数据结构。

我想知道为什么这里有优化。`for()`可能比 快`foreach()`，但是“创建多个数据结构”在哪里？

P/S：写这篇文章的人现在正在度假

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T02:02:10.610

在原始代码中，您创建一个`List<T>`- 而不指定容量，因此它可能涉及多次复制内部数组 - 然后您调用`ToArray`，`List<T>`从而产生一个副本。

较新的版本没有这样做。它创建一个数组，并将原始列表复制到其中。

诚然，仅使用 LINQ 的`ToArray`方法会更简单，甚至可能更有效，而且尚不清楚为什么这是一个虚拟方法开始，但是......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T02:05:50.037

第一个实现创建了一个中间人额外的 List 对象；GC 清理只是另一件事。这种优化几乎肯定不会被注意到，除非这个例程被击中到非常高的水平。

`foreach`否则，它与是否使用或无关`for`。这种选择主要是因为列表在被枚举时不能被修改的规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-03T03:12:25.773

为了更快地将 List 转换为 Array，HPCsharp nuget 包实现了 List.ToArray() 的并行（多核）版本：

```
public virtual T[] ToArray()
{
    return List.ToArrayPar();
} 
```

此方法不是必需的，只要在需要 Array 的地方使用 List.ToArrayPar() 函数即可。这个并行版本比 List.ToArray() 快大约 3 倍

# versioning - “RTMREL”在软件版本控制中是什么意思？

> ID：12380269
> 
> 赞同：5
> 
> 时间：2012-09-12T01:59:48.557
> 
> 标签：versioning, visual-studio-2012

我刚刚安装了 Visual Studio 2012 并注意到“关于”菜单中提到的版本是：

`Version 11.0.50727.1 RTMREL`

我熟悉`RTM`（发布到制造），但很好奇`REL`组件的含义。

任何人有任何见解？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-12T02:03:02.373

RTMRel 是[“发布到制造”*版本*](https://stackoverflow.com/a/6850413/14955)。有点多余，但与“SP1Rel”（Service Pack 1 版本）押韵。

更新：见下文爱德华的评论。“Rel”部分有一点。这意味着“发布”构建（优化并去除了调试信息）。MSDN 成员也可以获得用于调试目的的“Chk”构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-03T17:09:31.057

根据此链接[https://social.msdn.microsoft.com/Forums/vstudio/en-US/b0db1059-6006-4e9a-8d82-6508adef31e0/is-it-the-rtm-or-final-version-of- visual-studio-2012-?forum=vssetup](https://social.msdn.microsoft.com/Forums/vstudio/en-US/b0db1059-6006-4e9a-8d82-6508adef31e0/is-it-the-rtm-or-final-version-of-visual-studio-2012-?forum=vssetup)

> RTM 是指生产制造，即零售盒中 DVD 上的图像

# jquery - Struts2 结果类型 http 标头 500 不会触发 sj:autocompleter 中的 onErrorTopics

> ID：12380271
> 
> 赞同：3
> 
> 时间：2012-09-12T01:59:54.607
> 
> 标签：jquery, error-handling, struts2, struts2-jquery

我们有一个使用 Struts2-jQuery 框架进行 Ajax 操作的 Struts2 应用程序。在 Struts2-jQuery 中使用 Autocompleter (sj:autocompleter) 标签时，它会向 Struts2 Action jsonlanguages 发出 ajax 请求。

```
<s:url var="remoteurl" action="jsonlanguages"/>
<sj:autocompleter
    id="languages"
    href="%{remoteurl}"
    delay="50"
    loadMinimumCount="2"
/> 
```

我们为此操作定义了一个结果类型 ERROR，如下所示，以触发内部服务器错误，而不是作为成功的 ajax 请求完成。

```
<result name="ERROR" type="httpheader">
  <param name="status">500</param>
  <param name="headers.a">a custom header value</param>
  <param name="headers.b">another custom header value</param>
</result> 
```

***问题***：现在这种方法会触发`"onErrorTopics"`所有其他 Struts2-jQuery 标记（如`sj:select`..etc），但它似乎不会在`sj:autocompleter`. 有人遇到过这个问题吗？如果是这样，处理来自自动完成器的 ajax 请求期间发生的异常的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T18:04:09.900

我认为在您自己检查返回的 json 的有效性之前，不可能在视图中进行异常处理。

顺便说一句，自动完成器不返回任何结果，而是返回一个 json 对象。

您可以验证 javascript 或 jquery 中的操作返回的 json。

# python - TypeError：不支持的操作数类型

> ID：12380272
> 
> 赞同：0
> 
> 时间：2012-09-12T01:59:58.040
> 
> 标签：python, django

尝试检查运输变量是否为无时出现类型错误（见下文）。该字段是使用 django 设置的货币字段...检查其是否为空的正确方法是什么。

```
 Traceback (most recent call last):

    File "core/handlers/base.py", line 111, in get_response
    response = callback(request, *callback_args, **callback_kwargs)

File "contrib/admin/options.py", line 307, in wrapper
return self.admin_site.admin_view(view)(*args, **kwargs)

File "utils/decorators.py", line 93, in _wrapped_view
response = view_func(request, *args, **kwargs)

File "views/decorators/cache.py", line 79, in _wrapped_view_func
response = view_func(request, *args, **kwargs)

File "contrib/admin/sites.py", line 197, in inner
return view(request, *args, **kwargs)

File "admin.py", line 21, in changelist_view
return super(HeldOrderAdmin,self).changelist_view(request, extra_context=extra_context)

File "utils/decorators.py", line 28, in _wrapper
return bound_func(*args, **kwargs)

File "utils/decorators.py", line 93, in _wrapped_view
response = view_func(request, *args, **kwargs)

File "utils/decorators.py", line 24, in bound_func
return func(self, *args2, **kwargs2)

File "contrib/admin/options.py", line 1179, in changelist_view
], context, context_instance=context_instance)

File "shortcuts/__init__.py", line 20, in render_to_response
return HttpResponse(loader.render_to_string(*args, **kwargs), **httpresponse_kwargs)

File "template/loader.py", line 188, in render_to_string
return t.render(context_instance)

File "template/base.py", line 123, in render
return self._render(context)

File "template/base.py", line 117, in _render
return self.nodelist.render(context)

File "template/base.py", line 744, in render
bits.append(self.render_node(node, context))

File "template/base.py", line 757, in render_node
return node.render(context)

File "template/loader_tags.py", line 127, in render
return compiled_parent._render(context)

File "template/base.py", line 117, in _render
return self.nodelist.render(context)

File "template/base.py", line 744, in render
bits.append(self.render_node(node, context))

File "template/base.py", line 757, in render_node
return node.render(context)

File "template/loader_tags.py", line 127, in render
return compiled_parent._render(context)

File "template/base.py", line 117, in _render
return self.nodelist.render(context)

File "template/base.py", line 744, in render
bits.append(self.render_node(node, context))

File "template/base.py", line 757, in render_node
return node.render(context)

File "template/loader_tags.py", line 127, in render
return compiled_parent._render(context)

File "template/base.py", line 117, in _render
return self.nodelist.render(context)

File "template/base.py", line 744, in render
bits.append(self.render_node(node, context))

File "template/base.py", line 757, in render_node
return node.render(context)

File "template/loader_tags.py", line 64, in render
result = block.nodelist.render(context)

File "template/base.py", line 744, in render
bits.append(self.render_node(node, context))

File "template/base.py", line 757, in render_node
return node.render(context)

File "template/loader_tags.py", line 64, in render
result = block.nodelist.render(context)

File "template/base.py", line 744, in render
bits.append(self.render_node(node, context))

File "template/base.py", line 757, in render_node
return node.render(context)

File "template/base.py", line 921, in render
dict = func(*args)

File "contrib/admin/templatetags/admin_list.py", line 232, in result_list
'results': list(results(cl))}

File "contrib/admin/templatetags/admin_list.py", line 217, in results
yield ResultList(None, items_for_result(cl, res, None))

File "contrib/admin/templatetags/admin_list.py", line 209, in __init__
super(ResultList, self).__init__(*items)

File "contrib/admin/templatetags/admin_list.py", line 137, in items_for_result
f, attr, value = lookup_field(field_name, result, cl.model_admin)

File "contrib/admin/util.py", line 214, in lookup_field
value = attr(obj)

File "admin.py", line 50, in total
return '$%s' % (obj.order.total(),)

File "models.py", line 234, in total
if item.total is not None:

File "models.py", line 356, in total
shipping = 0

TypeError: unsupported operand type(s) for +: 'NoneType' and 'Decimal' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:09:12.233

`total += item.total`也许这段代码是错误的。检查是否`total`或是`item.total``NoneType`

因为你的错误是`TypeError: unsupported operand type(s) for +: 'NoneType' and 'Decimal'`，所以它是由操作员引起的`+`

# javascript - Android WebChromeClient 与 javaScript 的集成给出了 Unexpected Illegal token

> ID：12380285
> 
> 赞同：1
> 
> 时间：2012-09-12T02:01:10.877
> 
> 标签：javascript, android, webview, webchromeclient

主页.java

```
public void updatePhoto(Bitmap bitmap) {
   String bitmapStr = BitMapToString(bitmap);
   Home.currentBmp = bitmap;

   String parameter = "data:image/jpeg;base64," + bitmapStr;

   webView1.loadUrl("javascript:var script = document.createElement('script');" + 
      "script.type='text/javascript';script.src='form.js';" + 
      "script.onload=" + "processImage('" + parameter + "');" +
      //"script.onload=" + "processImage(':/;//');" +
      "document.getElementsByTagName('head').item(0).appendChild(script);");
   Log.v(parameter, "QWERTY");
   Log.v("QWERTY", parameter);
} 
```

表单.js

```
function processImage(img) {
   alert('process image end');
} 
```

此函数将 Bitmap 对象转换为 base64 字符串，然后执行外部 javascript `function (form.js -> processImage(var))`。但是它不执行 processImage 并给出 Uncaught `SyntaxError: Unexpected token ILLEGAL`。但是，当我取消注释时

```
//"script.onload=" + "processImage(':/;//');" + 
```

行和评论

```
"script.onload=" + "processImage('" + parameter + "');" + 
```

似乎该功能运行良好。参数变量的可能值是

```
data:image/jpeg;base64,iVBORw0KgoAAAANSHUEgAAA...... 
```

我要问的是如何使 javaScript 函数与参数一起工作？谢谢！

# perl - Perl `$$` 变量

> ID：12380286
> 
> 赞同：0
> 
> 时间：2012-09-12T02:01:42.157
> 
> 标签：perl

`$$`perl中的part是什么意思？

我在这段代码片段中找到了它：

```
my $unique   = "P$$" . "M$microseconds"; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T02:03:52.130

`$$`表示当前的PID（进程ID）。所有预定义的 Perl 变量都可以在[perlvar](http://perldoc.perl.org/perlvar.html)手册页中找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T02:03:33.873

表示当前进程ID。见`man perlvar`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-26T18:19:13.927

在 Perl 中，继承了 Linux 的属性。它也可以接受一些功能。像这样，$$ 是当前进程的进程 ID。

# objective-c - iOS：创建更暗版本的 UIImage 并保持透明像素不变？

> ID：12380288
> 
> 赞同：13
> 
> 时间：2012-09-12T02:01:45.637
> 
> 标签：objective-c, ios, uiimage, core-graphics

我发现

[通过向现有 UIImage 添加阴影来创建新的 UIImage](https://stackoverflow.com/questions/2936443/create-new-uiimage-by-adding-shadow-to-existing-uiimage)

和

[UIImage，有没有一种简单的方法可以使它变暗或全黑](https://stackoverflow.com/questions/4099041/uiimage-is-there-an-easy-way-to-make-it-darker-or-all-black)

但是选定的答案对我不起作用。

我有一个 UIImage，其中可能有一些透明像素，我需要创建一个新的 UIImage，其中不透明的像素变暗，有什么办法吗？我正在考虑使用 UIBezierPath 但我不知道如何仅对不透明像素执行此操作。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-12T02:21:19.230

这是我用来为图像着色的类，即使它们是透明的。

```
+ (UIImage *)colorizeImage:(UIImage *)image withColor:(UIColor *)color {
    UIGraphicsBeginImageContextWithOptions(image.size, NO, image.scale);

    CGContextRef context = UIGraphicsGetCurrentContext();
    CGRect area = CGRectMake(0, 0, image.size.width, image.size.height);

    CGContextScaleCTM(context, 1, -1);
    CGContextTranslateCTM(context, 0, -area.size.height);

    CGContextSaveGState(context);
    CGContextClipToMask(context, area, image.CGImage);

    [color set];
    CGContextFillRect(context, area);

    CGContextRestoreGState(context);

    CGContextSetBlendMode(context, kCGBlendModeMultiply);

    CGContextDrawImage(context, area, image.CGImage);

    UIImage *colorizedImage = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();

    return colorizedImage;
} 
```

要使图像变暗，您将向该方法传递具有较低透明度的黑色或灰色 UIColor。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-12T02:24:49.943

试试 CoreImage 过滤器怎么样？

您可以使用 CIColorControls 过滤器来调整输入亮度和对比度以使图像变暗。

```
CIContext *context = [CIContext contextWithOptions:nil];
CIImage *inputImage = [[CIImage alloc] initWithImage:sourceImage]; //your input image

CIFilter *filter= [CIFilter filterWithName:@"CIColorControls"];
[filter setValue:inputImage forKey:@"inputImage"];
[filter setValue:[NSNumber numberWithFloat:0.5] forKey:@"inputBrightness"];

// Your output image
UIImage *outputImage = [UIImage imageWithCGImage:[context createCGImage:filter.outputImage fromRect:filter.outputImage.extent]]; 
```

在此处阅读有关 CIFilter 参数的更多信息：

[http://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CoreImageFilterReference/Reference/reference.html%23//apple_ref/doc/filter/ci/CIColorControls](http://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CoreImageFilterReference/Reference/reference.html%23//apple_ref/doc/filter/ci/CIColorControls)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-01-12T23:32:31.533

这是一个快速的 Swift 版本，使用 CIExposureAdjust CIFilter :)

```
 // Get the original image and set up the CIExposureAdjust filter
  guard let originalImage = UIImage(named: "myImage"),
    let inputImage = CIImage(image: originalImage),
    let filter = CIFilter(name: "CIExposureAdjust") else { return }

  // The inputEV value on the CIFilter adjusts exposure (negative values darken, positive values brighten)
  filter.setValue(inputImage, forKey: "inputImage")
  filter.setValue(-2.0, forKey: "inputEV")

  // Break early if the filter was not a success (.outputImage is optional in Swift)
  guard let filteredImage = filter.outputImage else { return }

  let context = CIContext(options: nil)
  let outputImage = UIImage(CGImage: context.createCGImage(filteredImage, fromRect: filteredImage.extent))

  myImageView.image = outputImage // use the filtered UIImage as required. 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-02-27T04:12:52.250

这是大卫在 Swift 5 中的回答：

```
class func colorizeImage(_ image: UIImage?, with color: UIColor?) -> UIImage? {
    UIGraphicsBeginImageContextWithOptions(image?.size ?? CGSize.zero, _: false, _: image?.scale ?? 0.0)

    let context = UIGraphicsGetCurrentContext()
    let area = CGRect(x: 0, y: 0, width: image?.size.width ?? 0.0, height: image?.size.height ?? 0.0)

    context?.scaleBy(x: 1, y: -1)
    context?.translateBy(x: 0, y: -area.size.height)

    context?.saveGState()
    context?.clip(to: area, mask: (image?.cgImage)!)

    color?.set()
    context?.fill(area)

    context?.restoreGState()

    if let context = context {
        context.setBlendMode(.multiply)
    }

    context!.draw((image?.cgImage)!, in: area)

    let colorizedImage = UIGraphicsGetImageFromCurrentImageContext()

    UIGraphicsEndImageContext()

    return colorizedImage
} 
```

# android - android模拟器中的方向

> ID：12380297
> 
> 赞同：2
> 
> 时间：2012-09-12T02:02:49.723
> 
> 标签：android, orientation

我首先从我的模拟器中选择默认方向。然后我选择查看风景并且它有效。但是当我再次将我的模拟器变成默认方向时，我发现我的应用程序方向没有改变。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
      xmlns:tools="http://schemas.android.com/tools" 
    android:layout_width="match_parent"
    android:layout_height="match_parent"
        android:orientation="vertical" 
   > 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:07:37.390

按下模拟器的主页按钮并在再次运行应用程序后将模拟器设置为默认方向

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T02:08:39.160

这是模拟器版本 2.3 中有时会出现的问题 我通过在 4.0 上运行应用程序解决了这个问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T02:11:47.137

查看您的应用程序清单是否包含以下内容：

```
<activity... android:screenOrientation="portrait"> 
```

删除此属性。它将应用程序锁定到特定方向。但是，当您这样做时，您的活动将在每次方向更改时被删除并重新创建（可能会加载不同的布局文件）。要在不重新启动活动的情况下处理方向更改，请将以下属性添加到`<activity>`

```
android:configChanges="orientation" 
```

# c++ - 为具有许多友元函数c ++的模板类（2d动态）创建析构函数

> ID：12380306
> 
> 赞同：0
> 
> 时间：2012-09-12T02:04:35.000
> 
> 标签：c++, arrays, templates, dynamic, destructor

我在为具有私有二维动态数组的模板类创建析构函数时遇到问题。出于某种原因，一旦我将信息输入到矩阵中，析构函数就会破坏矩阵。不知道出了什么问题，因为它编译得很好，但是当我输入前 2 个矩阵的信息并且程序尝试将它们相乘时给出错误。如果我摆脱了析构函数，代码就可以工作。

```
template <class T>
class matrix
{
//sudo
friend matrix operator + , *,-,(bunch of friends used to overload)
//end sudo 
public:
                matrix(): rows(0), cols(0){}
                int Arows(){return rows;}
                int Acols(){return cols;}
            class Proxy
            {
                matrix& _a;
                int _i;
            public:
                Proxy(matrix& a, int i) : _a(a), _i(i){}
                int& operator[](int j) {return _a.Array[_i][j];};
            };
                Proxy operator[](int i) {return Proxy(*this,i);}
                ~matrix();
                private:
                T ** Array;
                int rows;
                int cols;
                };

                template<class T>
                matrix<T>::~matrix()
            {
                for (int i=0;i<rows;i++)
                    delete [] Array[i];
                delete [] Array;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:16:33.870

如果没有看到确切的代码和调用代码，很难判断，但这可能是因为您缺少复制构造函数和赋值运算符。

```
matrix m1;    
{
 matrix m2 = ...
 m1 = m2; // copy ctor, now they share same Array pointer
} // m2 destructor free the Array

// m1 is left with dangling Array pointer 
```

从代码示例来看，它看起来不像真正的代码。Array在哪里初始化，什么是matrixArray？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T02:26:02.917

我认为 R. Martinho Fernandes 提供的评论回答了这个问题......我想指出其他一些事情，我只是把它作为一个答案，所以我可以格式化代码。

人们痴迷于做大量的内存分配只是为了制作一个二维数组......但这很慢！如果您对这些矩阵做了很多工作，那么最好进行一次内存分配。它有点像这样：

```
Array = (T**)malloc( rows*sizeof(T*) + rows*cols*sizeof(T) );
T* rowData = (T*)(Array + rows);
for( int r = 0; r < rows; r++ ) {
    Array[r] = rowData;
    rowData += cols;
} 
```

当你想释放这个内存时：

```
free((void*)Array); 
```

自然地，我假设您使用的是基本类型......事实上，您最好使用`typename T`而不是`class T`在模板中。

哦，是的，这使得将数据从一个矩阵（相同大小）复制到另一个矩阵变得非常容易。您只需按上述方式分配，然后`memcpy`在数据部分上执行一次。

# header - Lua 自定义 UDP 标头

> ID：12380309
> 
> 赞同：0
> 
> 时间：2012-09-12T02:05:10.177
> 
> 标签：header, lua, udp

有没有办法在 Lua 中创建自定义 UDP 标头？我正在使用**Ubuntu 11.10**、**Lua 5.1**和**Luasocket**。我错过了一个模块来工作还是不可能？

我打算做的是从客户端在 UDP 标头的长度部分发送一个字符，然后在服务器上对其进行解码。有没有更好的方法可以在不通过正常数据传输发送数据的情况下做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T06:00:42.547

修改数据包头的唯一方法是使用原始套接字并自己构建数据包，包括 IP 和 UDP 头。

但是，您想要做的，将长度字段用于数据，是行不通的。请记住，客户端和服务器之间的所有路由器/交换机/集线器都会查看标头以确定数据包的长度。如果那里没有有效的长度，他们将无法发送您的数据包。

# git - Git 将存储库合并到同一根文件夹中

> ID：12380313
> 
> 赞同：1
> 
> 时间：2012-09-12T02:06:58.067
> 
> 标签：git, version-control

我们有两个要合并的存储库，前端和共享是否可以这样做：

1.  从第一次提交（没有提交任何内容）在前端创建一个新分支
2.  将 shared 的所有分支的所有历史记录应用到前端的新空白分支上。
3.  是否将新分支大规模合并到主分支中，以便我们保留两个存储库的所有历史记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:44:47.333

我不确定您将如何“应用所有历史记录”并进行“大规模合并”，但要回答问题标题，我会通过遥控器来完成，例如 github：

*   将仓库 A 推送到 github
*   在存储库 B 中创建一个新分支
*   切换到那个分支
*   将存储库 A 添加为远程
*   从存储库 A 中拉出，它将合并 2。

# javascript - 根据标签内的文本链接中的哈希 ID 动态选择 jquery UI 选项卡

> ID：12380314
> 
> 赞同：2
> 
> 时间：2012-09-12T02:07:07.257
> 
> 标签：javascript, jquery, html, user-interface, tabs

我有一组由 CMS 生成的 jQuery UI 选项卡，因此每个页面的内容都会有所不同。一些选项卡集可能有两个选项卡，其他可能有 5 个等等。

我四处寻找一个简单的解决方案，但似乎找不到它。我查看了历史插件以及替代代码。

这是我的示例标记

```
<div id="tabs"> 
<ul>
<li><a href="#tabs-1">TAB 1 HEADING</a></li>
<li><a href="#tabs-2">TAB 2 HEADING</a></li>
<li><a href="#tabs-3">TAB 2 HEADING<a></li>
<li><a href="#tabs-4">TAB 3 HEADING</a></li>
</ul>
</div>

<div id="tabs-1">tab1 content here</div>
<div id="tabs-2">tab2 content here</div>
<div id="tabs-3">tab2 content here</div>
<div id="tabs-4">tab4 content here</div> 
```

我想创建一个脚本，允许用户从选项卡式内容中的文本链接中交替选择一个选项卡。因此，例如，在选项卡内容 div 中，具有指向第三个选项卡的链接，就像选项卡导航一样。我不想在脚本中手动编写所需选项卡的索引。

我知道这会起作用，但我想在我的所有选项卡式内容中创建更强大的东西。

```
$("#tabs").tabs("select" , "#tab-4"); 
```

这是我到目前为止所拥有的，但似乎不起作用。我是 jQuery 的新手。我在锚链接中添加了一个名为 tabJump 的 onlick。

```
function tabJump(){
    //get href ID as a number
    var thisID = Number($(this).attr('href').replace(/#tabs-/, '')) - 1;
    // this should trigger the new tab based on this href id.
    $("#tabs").tabs("select" , "#tabs-" + thisID);
}; 
```

以及我如何让它发挥作用的想法？本质上，我希望标签的 id 作为被点击的锚链接的 href，并通过这个给定的 id 来定位新标签。我希望有多个带有这些 id href 的链接实例。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T22:55:52.733

好的，谢谢大家，终于知道我需要什么了。

如果有人觉得这很有用，我将在下面分享。

单击时启动功能

```
<p><a href="#tabs-4" onclick="tabJump(this);">my text link</a></p> 
```

和脚本

```
function tabJump(obj) {
//grab the id in the clicked links href
var thisID = Number($(obj).attr('href').replace(/#tabs-/, ''));
//use this ID to trigger the click on the set of tabs
$("#tabs").tabs("select", "#tabs-" + thisID); 
//then scroll to the top of the tabs set
$('html, body').animate({
     scrollTop: $("#tabs").offset().top
 }); 
```

};

所以我使用它的方式是，一旦在我的 CMS 的文章中创建了选项卡中的内容，我最终会得到 4 个或 10 个选项卡。然后在第一个选项卡中有一些副本需要链接到选项卡 4。所以我在链接中添加了一个 onclick 并在需要时附加 jQuery 脚本，如上图所示。

感谢大家的帮助和提示。如果有人有更清洁的方法，请随时发布。

和平

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:52:06.323

我认为您的功能`tabJump`可能有效。只需将方法的调用更改为`select`仅使用数字（thisID）而不是与字符串“#tabs-”连接。

像这样：

```
function tabJump(){
    //get href ID as a number
    var thisID = Number($(this).attr('href').replace(/#tabs-/, '')) - 1;
    // this should trigger the new tab based on this href id.
    $("#tabs").tabs("select" , thisID);
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T03:19:30.843

不确定这是否是您需要的，但看看这是否有效。

这是一个[工作小提琴](http://jsfiddle.net/EP6Cd/)。

```
<div id="tabs">
<ul>
    <li><a href="#tabs-1">Nunc tincidunt</a></li>
    <li><a href="#tabs-2">Proin dolor</a></li>
    <li><a href="#tabs-3">Aenean lacinia</a></li>
</ul>
<div id="tabs-1">
    <p>This is tab ONE</p>
    <p><a href="#" class="next">Go to next tab</a></p>
    <p><a href="#" class="prev">Go to prev tab</a></p>
</div>
<div id="tabs-2">
    <p>This is tab TWO</p>
    <p><a href="#" class="next">Go to next tab</a></p>
    <p><a href="#" class="prev">Go to prev tab</a></p>
</div>
<div id="tabs-3">
    <p>This is tab THREE</p>
    <p><a href="#" class="next">Go to next tab</a></p>
    <p><a href="#" class="prev">Go to prev tab</a></p>
</div> 
```

```
$("#tabs").tabs();

$("#tabs div a").on("click", function(){
    var idx = Number($(this).parent().parent().attr('id').replace('tabs-','')) - 1;
    if($(this).attr('class') == 'next'){
        $( "#tabs" ).tabs( "option", "selected", idx + 1 );            
    }
    else{
        $( "#tabs" ).tabs( "option", "selected", idx - 1 );
    }
 }); 
```

# excel - 循环引用excel公式使VBA方法返回0

> ID：12380317
> 
> 赞同：0
> 
> 时间：2012-09-12T02:07:41.707
> 
> 标签：excel, vba

我编写了一个 VBA 插件函数来执行一系列的矩形舍入。在我的 VBA 方法中，我想检测包含公式/VBA 方法的单元格上方是否有空单元格。但是，如果我在我的方法中使用 ActiveCell，Excel 会抱怨循环引用并返回 0 而不是我的方法的返回值。示例方法：

```
Function MovingAverageSmooth(r As Range, m As Integer)
    ' returns a smoothed average using the 'rectangular' method
    Dim cStart As Long, x As Long, total As Double, activeColumn As Long
    Dim vc As Long, vr As Long, count As Double, beforeCount As Long, afterCount As Long

    vc = r.Column
    vr = r.Row

    rStart = Max(1, vr - m)
    currentValue = Cells(vr, vc).Value
    activeColumn = ActiveCell.Column
    For x = rStart To vr + m
        If Application.IsNumber(Cells(x, vc).Value) Then
            total = total + Cells(x, vc).Value
            count = count + 1
            If Application.IsNumber(Cells(x, activeColumn).Value) Then
                If x < vr Then
                    beforeCount = beforeCount + 1
                End If
                If x > vr Then
                    afterCount = afterCount + 1
                End If
            End If
        End If
    Next
    MovingAverageSmooth = total / count
    If afterCount = 0 Or beforeCount = 0 Or count = 0 Then
        MovingAverageSmooth = currentValue
    End If

End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T05:05:01.890

我认为这对你有用。正如我在评论中提到的，Application.Caller 返回调用该函数的单元格：

```
Function MovingAverageSmooth(r As Range, m As Integer)
    ' returns a smoothed average using the 'rectangular' method
    Dim cStart As Long, x As Long, total As Double, activeColumn As Long
    Dim vc As Long, vr As Long, count As Double, beforeCount As Long, afterCount As Long

    vc = r.Column
    vr = r.Row

    rStart = Max(1, vr - m)
    currentValue = Cells(vr, vc).Value
    activeColumn = Application.Caller.Column
    For x = rStart To vr + m
        If Application.IsNumber(Cells(x, vc).Value) Then
            total = total + Cells(x, vc).Value
            count = count + 1
            If Application.IsNumber(Cells(x, activeColumn).Value) Then
                If x < vr Then
                    beforeCount = beforeCount + 1
                End If
                If x > vr Then
                    afterCount = afterCount + 1
                End If
            End If
        End If
    Next
    MovingAverageSmooth = total / count
    If afterCount = 0 Or beforeCount = 0 Or count = 0 Then
        MovingAverageSmooth = currentValue
    End If
End Function 
```

# subsonic - Subsonic 3 保存到不同的数据库

> ID：12380325
> 
> 赞同：1
> 
> 时间：2012-09-12T02:09:46.223
> 
> 标签：subsonic, subsonic3, subsonic-active-record

使用 subsonic 3 我有一个项目有点奇怪的场景。我有一个 .net windows 服务，它需要连接到一个主数据库，该数据库存储与其他数据库服务器的连接以及一组用于处理自动 SMS 消息的表。然后我在其他服务器上有相同的数据库（连接字符串表在其他数据库上是空的）来处理其他应用程序的消息。

因此，subsonic 可以使用连接字符串/提供程序名称选项调用所有数据库。

```
 public static List<SMSRequestWithResponseList> SMSRequestListGetAll(string applicationName)
    {
        string connStr = GetConnectionStringByApplicationName(applicationName);

        List<SMSRequestWithResponseList> response = new List<SMSRequestWithResponseList>();

        List<DAL.CDYNESMSRequest> lst = DAL.CDYNESMSRequest.All(connStr, providerName).ToList();

        foreach (DAL.CDYNESMSRequest mitm in lst)
        {
            SMSRequestWithResponseList itm = new SMSRequestWithResponseList(mitm, mitm.CDYNESMSResponses.ToList(), string.Empty);
            response.Add(itm);
        }

        return response;
    } 
```

问题是保存...插入似乎正在工作。

```
DAL.CDYNESMSRequest itm = new DAL.CDYNESMSRequest(connStr, providerName).;
            itm.KeyCode = KeyCode;
            itm.ApplicationName = ApplicationName;
            itm.BatchTransaction = BatchTransaction;
            itm.AssignedDID = GetParameter("AssignedDID");
            itm.PhoneNumber = PhoneNumber;
            itm.MessageDetail = MessageText;
            itm.MessageCancelled = false;
            itm.MessageQueued = false;
            itm.MessageSent = false;
            itm.IsImmediate = SendImmediate;
            itm.InQueue = false;
            itm.ScheduledDateTime = ScheduledDateTime;
            itm.CreateDT = dt;
            itm.ModifiedDT = dt;
            itm.Save(); 
```

不过好像不想更新了。。。

```
 DAL.CDYNESMSRequest itm = DAL.CDYNESMSRequest.SingleOrDefault(x => x.RequestID == requestID, connStr, providerName);
            if (itm != null)
            {
                itm.MessageID = messageGUID;
                itm.MessageCancelled = messageCancelled;
                itm.MessageQueued = messageQueued;
                itm.ReferenceID = messageReferenceID;
                itm.MessageSent = messageSent;
                if (messageSentDT < new DateTime(1753, 1, 1, 0, 0, 0))
                    itm.MessageSentDT = null;
                else
                    itm.MessageSentDT = messageSentDT;
                itm.MessageSMSError = messageSMSError;
                itm.ModifiedDT = dt;
                itm.Save();
            } 
```

我正在使用正确数据库中的连接字符串进行调用，但它不会更新记录。如果我保存不正确，请告诉我。我确实尝试创建一个新的提供程序并将其设置为保存，但它对我咆哮说它已经有一个打开的连接。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T08:35:52.317

不要使用 ActiveRecord 模式，但 SimpleRepository 允许您设置多个存储库，并且您可以为每个存储库指定一个连接字符串。

```
// not sure if this is the right constructor or if it's providerName, connectionString
var repo1 = new SimpleRepository(connectionString1, providerName);
var repo2 = new SimpleRepository(connectionString2, providerName);

var item = repo1.Single<Product>(1);

if (repo2.Exists<Product>(x => x.Id == item.Id))
    repo2.Update(item);
else
    repo2.Add(item); 
```

# .net - 当我想更改我的映射时出错

> ID：12380326
> 
> 赞同：0
> 
> 时间：2012-09-12T02:09:56.487
> 
> 标签：.net, linq, entity-framework, express, code-first

```
public class MovieTotal:DbContext
{
    public DbSet<Movie> Movies { get;set; }
    public DbSet<Person> Persons { get; set;}

    protected override void OnModelCreating(System.Data.Entity.ModelConfiguration.ModelBuilder modelBuilder)
    {
        Movie mov = new Movie();
        modelBuilder.Entity<Movie>().Property(GetPropert("MovieName")).HasColumnName("Actors");
    }

    public System.Linq.Expressions.Expression<Func<Movie,string>> GetPropert(string  properName)
    {
        // Func<Movie, string> dele = 
        System.Linq.Expressions.Expression<Func<Movie, string>> exp = k => (string)(typeof(Movie).GetProperty(properName).GetValue(k, null));
        return exp ;
    }

    public string GetColumnName(string value)
    {
        return "Actors";
    }

    public MovieTotal()
    {   
        this.Database.Connection.ConnectionString = @"Data Source=(local);Initial Catalog=MovieTotal6;Integrated Security=SSPI;";
    }
} 
```

这是错误消息：

> 表达式 'k => Convert(Movie.GetProperty(value(MovieTotal+ <>c__DisplayClass0).properName).GetValue(k, null))' 不是有效的属性表达式。它必须采用“e => e.Property[.Property]”的形式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T17:19:11.080

验证传递给 Property 方法的表达式是一个 MemberExpression，其 .Member 属性是一个 PropertyInfo。如果不是您看到的异常，将被抛出。您可以在此处找到执行此操作的实际代码：http: [//entityframework.codeplex.com/SourceControl/changeset/view/7fb31c1526d0#src%2fEntityFramework%2fUtilities%2fExpressionExtensions.cs](http://entityframework.codeplex.com/SourceControl/changeset/view/7fb31c1526d0#src%2fEntityFramework%2fUtilities%2fExpressionExtensions.cs)（寻找 GetSimplePropertyAccess 方法）现在 Property() 方法采用 Expression 的原因不是让人们学习 Expression Trees 和 Linq 的复杂性，而是在编码时提供更好的体验 - 即当您开始在括号中键入 lambda 表达式时 Intellisense将向您显示给定实体的所有属性，这很有帮助。此外 lambda 表达式是强类型的，因此如果您输入错误的属性，您的程序将无法编译。考虑在 Property() 方法中将属性名称作为字符串 - 编码会变得很麻烦 - 首先您不会从智能感知中获得帮助，因此您必须始终记住（或检查）给定实体具有哪些属性。其次，如果您输入错误的名称，则会在运行时抛出异常，而不是在编译时找不到属性。看看格特阿诺德的评论。我相信这是您问题的解决方案并回答您的问题。

# php - How to pass the jquery hidden value to php

> ID：12380333
> 
> 赞同：0
> 
> 时间：2012-09-12T02:11:06.363
> 
> 标签：php, html, ajax, jquery

in my code i am creating a drop down box and storing the changed value of the drop down in hidden variable.

```
<!DOCTYPE html>
<html>
<head>
  <style>

  div { color:red; }
  </style>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
  <select id="sweets">
    <option>Chocolate</option>
    <option selected="selected">Candy</option>

    <option>Taffy</option>
    <option selected="selected">Caramel</option>
    <option>Fudge</option>
    <option>Cookie</option>

  </select>
  <input type="hidden" id="inputfield">
  <div></div>
<script type="text/javascript">
$(document).ready(function() {
  $("#sweets").change(function() {
    var var_name = $(this).val();
    $('input[id=inputfield]').val(theValue);
      }
    });
  });
});
</script>
</body>
</html>

<?php

if(isset($_POST['form']))
echo $_POST['inputfield'];
?> 
```

once the combo box is changed the php should get the hidden field value and i ve to perform db transaction. again i need to load another drop down box based on the selected value.. Can you guide me

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:20:23.677

你可以通过隐藏字段绕过所有的马交易，直接通过ajax发送给php。

```
$(document).ready(function() {
  $("#sweets").change(function() {
    $.post('myphpfile.php', {sweet : $(this).val() });
  });
}); 
```

myphpfile.php 将接收值作为名称为“甜蜜”的帖子

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:17:41.320

除非我有误解，否则不应该

`$('input[id=inputfield]').val(theValue);`

是

`$('input[id=inputfield]').val(var_name);`

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T02:19:09.290

您可以将 select 和 hidden 元素包装在 form 元素中，添加 post 方法和 action 属性。为隐藏字段命名，如 name="hidden field" 这样您就可以在 post 变量中访问它。

```
<form action="currentpage.php" method="post">
 <select id="sweets">
    <option>Chocolate</option>
    <option selected="selected">Candy</option>

    <option>Taffy</option>
    <option selected="selected">Caramel</option>
    <option>Fudge</option>
    <option>Cookie</option>

  </select>
  <input type="hidden" id="inputfield" name="hiddenfield"/>
  <input type="submit" value="Submit" name="submit"/>
</form> 
```

当执行更改事件以更新隐藏字段并在 php 中提交时，您可以执行

```
if(isset($_POST["submit"]))
{
   $val = $_POST["hiddenfield"] ;
} 
```

# java - 如何使用 java 或 json 从公司简介中检索推文？

> ID：12380334
> 
> 赞同：0
> 
> 时间：2012-09-12T02:11:09.533
> 
> 标签：java, json, twitter

在 twitter 中有很多公司都有自己的个人资料，例如（例如：[https](https://twitter.com/starbucks) ://twitter.com/starbucks或[https://twitter.com/mcdonalds](https://twitter.com/mcdonalds)）。我想从公司简介中获取最新的推文。我有以下使用 JSON 的代码，但它返回带有来自最新推文的关键字的一般搜索。

```
 BufferedReader in = new BufferedReader(  
                new InputStreamReader(System.in));  
        String urlstr = "http://twitter.com/search.json?q=";  
        StringBuffer buff = new StringBuffer();  

        System.out.print("Search for : ");  
        urlstr += in.readLine();  

        URL url = new URL(urlstr);  
        BufferedReader br = new BufferedReader(  
                                    new InputStreamReader(  
                                    url.openConnection().getInputStream()));  
        int c;  
        while((c=br.read())!=-1)  
        {  
            buff.append((char)c);  
        }  
        br.close();  

        JSONObject js = new JSONObject(buff.toString());  
        JSONArray tweets = js.getJSONArray("results");  
        JSONObject tweet;  
        for(int i=0;i<tweets.length();i++) {  
            tweet = tweets.getJSONObject(i);  
            System.out.println((i+1)+") "+tweet.getString("from_user")+" at   
                "+tweet.getString("created_at"));  
            System.out.println(tweets.getJSONObject(i).getString("text")+"\n");  
        }  
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T04:09:25.673

正确的 URL 是 String urlstr="http://search.twitter.com/search.json?q=from%3AMcDonalds";

# jquery - 表大小差异

> ID：12380338
> 
> 赞同：0
> 
> 时间：2012-09-12T02:11:47.427
> 
> 标签：jquery, html, css, html-table

我真的无法理解为什么会这样，第一个 td 的大小似乎吸收了最后一个 td 大小的一部分。

表的 id 是“slide-table”，[http://www.rickpascua.cu.cc/](http://www.rickpascua.cu.cc/)。

此错误或 w/e 仅发生在 Firefox 和 IE 上，Chrome 以均匀分布的大小显示它很好。

任何帮助将非常感激！

（我应该注意到这只是在我添加了一些之后才发生`.hide()`的，但它们都不会直接影响“幻灯片”。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:23:29.413

默认情况下，浏览器根据每个`td`. 所以在你的情况下，每列的宽度取决于图像，它们都是不同的大小。

您可以通过指定在 CSS 中更改它：

```
#slide-table table {
    table-layout: fixed;
} 
```

并`width`为每一列指定一个。

或者只是使所有图像的宽度和高度相同。

# class - 编写方法和构造函数

> ID：12380341
> 
> 赞同：0
> 
> 时间：2012-09-12T02:12:10.787
> 
> 标签：class, methods, constructor

好的，我需要有人向我解释从哪里开始这个项目。

*首先，我需要通过向Person*添加一个默认（无参数）构造函数来重载构造函数，该构造函数定义了一个名称为“N/A”且 id 为 -1 的对象。

然后我需要添加一个名为 reset 的 setter 方法，该方法可用于将此类的两个私有实例变量重置为作为参数传入的两个值。

然后我需要添加一个名为 getName 和 getId 的 getter 方法，可用于检索这两个私有变量

这是代码：

```
public class Person
{
private String name;
private int    id;
private static int personCount = 0;

// constructor
public Person(String pname)
{
name = pname;
personCount++;
id = 100 + personCount;
}

public String  toString()
{
 return "name: " + name + "  id: " + id
  + "  (Person count: " + personCount + ")";
}

// static/class method
public static int getCount()
{
  return personCount;
} 
```

////////////////////////////////////////

```
public class StaticTest
{
  public static void main(String args[])
{
    Person tom = new Person("Tom Jones");
    System.out.println("Person.getCount(): " + Person.getCount());
    System.out.println(tom);
    System.out.println();

    Person sue = new Person("Susan Top");
    System.out.println("Person.getCount(): " + Person.getCount());
    System.out.println(sue);
    System.out.println("sue.getCount(): " + sue.getCount());
    System.out.println();

    Person fred = new Person("Fred Shoe");
    System.out.println("Person.getCount(): " + Person.getCount());
    System.out.println(fred);
    System.out.println();

    System.out.println("tom.getCount(): " + tom.getCount());
    System.out.println("sue.getCount(): " + sue.getCount());
    System.out.println("fred.getCount(): " + fred.getCount());
}
} 
```

我不确定从哪里开始，我不想要答案。我正在找人解释清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:17:38.940

我强烈推荐查阅[Java 教程](http://docs.oracle.com/javase/tutorial/)，这在这里应该很有帮助。例如，有一个关于[构造函数](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)的部分详细说明了它们是如何工作的，甚至给出了一个无参数形式的例子：

> 虽然`Bicycle`只有一个构造函数，但它可以有其他构造函数，包括无参数构造函数：
> 
> ```
> public Bicycle() {
>     gear = 1;
>     cadence = 10;
>     speed = 0;
> } 
> ```
> 
> `Bicycle yourBike = new Bicycle();`调用无参数构造函数来创建一个`Bicycle`名为 的新对象`yourBike`。

同样，也有专门用于[定义方法](http://docs.oracle.com/javase/tutorial/java/javaOO/methods.html)并将[信息传递给它们](http://docs.oracle.com/javase/tutorial/java/javaOO/arguments.html)的部分。甚至还有一个关于从您的方法[返回值的部分。](http://docs.oracle.com/javase/tutorial/java/javaOO/returnvalue.html)

阅读以上内容，您应该能够完成作业:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T06:44:52.377

*首先，我需要通过向 Person 添加一个默认（无参数）构造函数来重载构造函数，该构造函数定义了一个名称为“N/A”且 id 为 -1 的对象。*

[在此处](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)阅读有关构造函数的信息。

Person 类已经包含一个接受 1 个参数的 ctor。您需要做的是创建一个“默认 ctor”，它通常是一个不带任何参数的 ctor。

例子：

```
class x
{
   // ctor w/ parameter
   //
   x(int a)
   {
      // logic here
   }

   // default ctor (contains no parameter)
   //
   x()
   {
     // logic here
   }
} 
```

*然后我需要添加一个名为 reset 的 setter 方法，该方法可用于将此类的两个私有实例变量重置为作为参数传入的两个值。*

Setter 方法用于通过公共函数“设置”成员变量的值来“封装”成员变量。见[这里](http://docs.oracle.com/javase/tutorial/reflect/member/fieldValues.html)。

例子：

```
class x
{
   private int _number;

   // Setter, used to set the value of '_number'
   //
   public void setNumber(int value)
   {
     _number = value; 
   }
} 
```

*然后我需要添加一个名为 getName 和 getId 的 getter 方法，可用于检索这两个私有变量*

吸气剂则相反。它们不是“设置”私有成员变量的值，而是用于“获取”成员变量的值。

例子：

```
class x
{
   private int _number;

   // Getter, used to return the value of _number
   //
   public int getNumber()
   {
      return _number;
   }
} 
```

希望这可以帮助

# entity-framework - EF vs NHibernate vs Dapper ORM

> ID：12380344
> 
> 赞同：2
> 
> 时间：2012-09-12T02:12:35.987
> 
> 标签：entity-framework, orm, nhibernate, dapper

I am trying to understand which ORM is fast in performance?

*   NHibernate support Level 2 caching can we compare its performance with EF or Dapper?
*   EF Code First looks promising, but do we have inbuilt Level 2 cache support for EF?
*   Don't know much about Dapper ORM

Can someone please explains me pros and cons of this ORM and which one to choose for application performance boost.

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-12T02:23:54.297

诸如 EF 或 NHibernate 之类的“大型”ORM 工具的问题在于（夸大其词？）99% 的开发人员对掌握如何使其工作感到不知所措；他们没有时间弄清楚如何让它发挥作用。更糟糕的是，要使这些工具正常运行通常归结为具备出色的 SQL/数据库设计和调优技能——这削弱了 ORM 的一个主要卖点。

在我看来，Level 2 缓存的问题被使用不当的 ORM 引入的其他性能损失所掩盖。似乎大多数使用 ORM 的项目都做得很差（同时设计数据库的工作也很差），这使得 2 级缓存有点没有意义。

因此，像 Massive 或 Dapper（后者由 Stack Overflow 使用）这样的微 ORM 工具非常有吸引力：

*   与宏 ORM 不同，开发人员不需要花费几个月的时间来学习如何使用它们。每个微 ORM 不到一千行代码（犯罪！）。这可能需要多长时间才能理解？
*   开发人员手头上的额外时间可以专门用于获得对 SQL 的更多掌握，他们需要学习这些知识才能更好地使用宏 ORM 或微 ORM。

需要明确的是，一个使用良好的宏 ORM 是一件很棒的事情。您是否拥有经验丰富的员工来确保其得到充分利用？

底线是这样的：如果您认为完整的 ORM 可以安全地隐藏数据库的复杂性，那么几乎可以肯定您会误会。如果给我一个选择，我会选择微型 ORM。不要误会我的意思，我认为 EF 和 NHIbernate 非常酷，我很乐意使用它们——我只是说你需要管理你的期望。

# java - Access String variable from one if statement in another

> ID：12380346
> 
> 赞同：1
> 
> 时间：2012-09-12T02:12:51.800
> 
> 标签：java, if-statement, scope

I am new to java coming from C#.

If I have a string that gets set in an "if-statement" is there a way to carry that string's value to other if statements?

E.g. I set the `String hi` to carry the text "hello" in an if statement, but now have a completely separate if statement, and would like to use the value set to the `String hi` in the previous if statement.

My issue is that the veriable can't be set until certain things in the if statement happen.

```
if(add.equals(temp)) {
    System.out.println ("What is the first number?");
    numberone = listen.nextDouble ();
    System.out.println ("What is the second number?");
    numbertwo = listen.nextDouble ();
    numberthree = numberone + numbertwo;
    previousproblem = numberthree;
    System.out.println ("The answer is " + numberthree);
} 
```

So later on, in another `if` statement I, need to reference `previousproblem`, but it can't be set until this `if` statement, as `numberthree` isn't set until this statement.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:15:54.830

Java 在这方面与 C# 相同，您需要做的就是在两个 if 语句*之外声明变量，并设置其初始值：*

```
String s = null;
if (someCondition) {
    s = "hello";
}
if (anotherCondition) {
    System.out.println("s is "+s);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:17:11.040

在开始 if 和 else 序列之前定义字符串。

```
String str1,str2;
if(true) {
   // ... true part
   str1 = "hello";
} else { 
   // ... false part
} 
```

现在在另一个`If`

```
if(true) {
    str2 = str1; //assign the value of str1 to str2 demonstrating the use str1 in another if
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T04:23:15.883

**变量在它声明的范围内可用；一个范围可以很容易地通过封闭来识别`{ }`。**

因此，如果您需要跨两个`if`语句访问变量，则需要在两个语句的范围内声明它们`if`。

```
if(condition) {

}
if(another condition) {

} 
```

如果您应该在第一个 if 语句之外声明它，则在两者中使用变量，如下所示：

```
String myVariable = "";

if(condition) {
    //myVariable operation
}
if(another condition) {
    //myVariable another operation    
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-23T06:56:47.307

请参阅简单概念。在方法之后定义变量 =null 喜欢：

```
Condition =null;

if (Condition == true){
System.out.println(Condition);
else{
System.out.println(Condition);
} 
```

所以现在条件值应该是块的访问外部

# html - scroll to some section in another page after clicking a link

> ID：12380350
> 
> 赞同：0
> 
> 时间：2012-09-12T02:13:24.473
> 
> 标签：html

As the title says, what I want to do is after clicking a link I go to some section in another page, and that section should scroll to top. Also, I don't want to use jquery for this, I only want to use html. Thanks! following is the code from the original page:

```
<TABLE cellspacing="11px" style="margin-left:3px">
               <TR>
                  <TD><A href="detail.html#patents">PATENT</A></TD>
                  <TD><A href="detail.html#trademarks">TRADEMARKS</A></TD>
                  <TD><A href="detail.html#ipLawAndPolicy">IP LAW & POLICY</A></TD>
                  <TD><A href="detail.html#productsAndServices">PRODUCTS & SERVICES</A></TD>
                  <TD><A href="detail.html#inventors">INVENTORS</A></TD>
                  <TD><A href="detail.html#newsAndNotices">NEWS & NOTICES</A></TD>
                  <TD><A href="detail.html#faqs">FAQs</A></TD>
               </TR>
            </TABLE> 
```

Following is the code from target page:

```
<BODY>
      <P id="patents">PATENTS</P>
      <HR />
      <P id="trademarks">TRADEMARKS</P>
      <HR />
      <P id="ipLawAndPolicy">IP LAW & POLICY</P>
      <HR />
      <P id="productsAndServices">PRODUCTS & SERVICES</P>
      <HR />
      <P id="inventors">INVENTORS</P>
      <HR />
      <P id="newsAndNotices">NEWS & NOTICES</P>
      <HR />
      <P id="faqs">FAQs</P>
   </BODY> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:27:54.853

如果您只想跳转到页面的特定部分，请在目标处使用以下代码：

```
<a name="targetName"/> 
```

并链接到 targetPage.html#targetName。此处的 targetName 只是一个示例，请使用适合您链接到的部分的内容。

如果您需要在目标页面的底部添加空格，您可以执行以下操作，例如将以下内容添加到页面底部（之前`</body>`）：

```
<div style="height: 1000px"></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:27:07.677

听起来您需要 HTML 书签：

[http://www.ezineasp.net/post/HTML-Anchor-Bookmark-Tag-Links.aspx](http://www.ezineasp.net/post/HTML-Anchor-Bookmark-Tag-Links.aspx) [http://www.freewebmasterhelp.com/tutorials/html-basics/4](http://www.freewebmasterhelp.com/tutorials/html-basics/4)

# mysql - MySQL获取具有相同ID的表的总和

> ID：12380353
> 
> 赞同：2
> 
> 时间：2012-09-12T02:13:42.467
> 
> 标签：mysql, join, sum

我有四张桌子`person,loan,ca,payments`

我想获得所有付款金额和现金垫款金额的总和，这些金额与从特定日期加入的人的贷款具有相同的 ID。

这是我的代码，但总和计算不正确：

```
SELECT pd.*,
    l.total_loan_amount,
    sum(c.ca_total_amount) AS ctot,
    sum(p.payment_amount)
FROM personal_data pd
LEFT JOIN loans l
    ON pd.id_personal_data = l.id_personal_data
LEFT JOIN ca c
    ON l.id_loan = c.id_loan
LEFT JOIN payments p
    ON l.id_loan = p.id_loan
WHERE l.loan_date = curDate()
    AND (
        c.ca_date = curDate()
        OR c.ca_date IS NULL
        )
    AND (
        p.payment_date = curDate()
        OR p.payment_date IS NULL
        )
GROUP BY pd.id_personal_data 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:22:52.660

这样做有时可能会检索到无效结果，因为`id`有时可能会或可能不会出现在其他表上。

尝试对要检索的每一列使用子查询。

```
SELECT  pd.*,
        l.total_loan_amount,
        c.totalCA,
        p.totalPayment
FROM    personal_data pd
        LEFT JOIN loans l
            ON pd.id_personal_data = l.id_personal_data
        LEFT JOIN
        (
            SELECT  id_loan, SUM(ca_total_amount) totalCA
            FROM    ca 
        --  WHERE   DATE(ca_date) = DATE(CURDATE()) OR
        --          ca_date IS NULL
            GROUP BY id_loan
        ) c ON l.id_loan = c.id_loan
        LEFT JOIN
        (
            SELECT  id_loan, SUM(payment_amount) totalPayment
            FROM    payments 
        --  WHERE   DATE(payment_date) = DATE(CURDATE()) OR
        --          payment_date IS NULL
            GROUP BY id_loan
        ) p ON l.id_loan = p.id_loan
WHERE DATE(l.loan_date) = DATE(curDate()) 
```

我认为`dates`每次付款和预付现金都无关紧要，因为您正在根据`date of loan`

# iphone - 核心数据获取最后 50 个对象？

> ID：12380355
> 
> 赞同：0
> 
> 时间：2012-09-12T02:13:51.880
> 
> 标签：iphone, ios, core-data, nsfetchrequest

与原生 iPhone 消息应用程序一样，我想编写[AcaniChat](https://github.com/acani/AcaniChat)代码以返回按时间顺序排序的最后 50 条消息。假设 Core Data 中总共有 200 条消息。

我知道我可以使用 fetchOffset=150 & fetchLimit=50 （实际上，在这种情况下我什至需要 fetchLimit 因为我想一直获取到最后？），但是我可以获取最后 50 条消息而无需先获取消息数？例如，使用 Redis，我可以将 fetchOffset 设置为 -50。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T02:26:45.170

反转排序顺序，并获取前 50 个。

**编辑**

> 但是，如何按时间顺序显示消息？我正在使用 NSFetchedResultsController。– 马特迪帕斯夸莱

现在这不是你问题的一部分，是吗;-)

无论如何，不​​直接使用 FRC。您的视图控制器被要求提供信息，然后它会询问 FRC。您可以进行简单的数学运算来转换部分/行以获得相反的顺序。

您还可以在内部使用第二个数组，该数组具有 FRC 中对象的副本，但排序顺序不同。这也很简单。

更复杂但更“学术上有趣”的是使用带有自定义提取参数的单独 MOC。

但是，在我走得太远之前，我想知道查询对象的数量有什么问题。它实际上相当快。

在我从 Instruments 那里得到证据证明这是扼杀我的应用程序的瓶颈之前，我会尽可能地寻求最简单的解决方案。

# r - 使用 R 列出 xlsx 工作表名称

> ID：12380356
> 
> 赞同：13
> 
> 时间：2012-09-12T02:14:14.423
> 
> 标签：r, xlsx

是否可以在 xlsx 文件中生成工作表名称列表？或者，我可以检查工作表名称是否存在，如果不存在，则继续执行某些指定功能？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-06-25T14:53:13.673

使用**xlsx**库，您可以使用 getSheets() 获取现有工作簿中的工作表列表：

```
wb <- loadWorkbook(your_xlsx_file)
sheets <- getSheets(wb) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-12T02:19:17.967

是的，我使用[xlsx](http://cran.r-project.org/package=xlsx)包（就像[XLConnect](http://cran.r-project.org/package=XLConnect)包一样）使用带有 Apache POI 代码的 Java 后端来做到这一点——因此它是跨平台的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T05:04:31.457

您也可以使用 RODBC 包执行此操作：

```
h <- odbcConnectExcel2007("file.xlsx")
sqlTables(h) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-15T15:34:07.957

使用的单线解决方案`openxlsx`是

```
openxlsx::getSheetNames('your/file.xlsx') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-04T08:52:52.980

# 使用 R xlsx 包获取 excel 或工作簿文件表名称

**加载您的工作簿或 excel 文件，在我的情况下，例如 excel 文件的名称是“input_4_r.xlsx”**

```
> wb<-loadWorkbook("input_4_r.xlsx") 
```

**查看文件列表，这里它在我的示例案例中显示 2 张工作表，我没有命名第一张工作表并保留默认但第二张工作表，我命名为“名称城市”，因此输出如下**

```
> getSheets(wb)
$Sheet1
[1] "Java-Object{Name: /xl/worksheets/sheet1.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml}"

$`name city`
[1] "Java-Object{Name: /xl/worksheets/sheet2.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml}" 
```

**您可以看到工作表名称的名称如下**

```
> names(getSheets(wb))
[1] "Sheet1"    "name city" 
```

**获取工作表特定索引的名称，例如在我的情况下通过 [2] 获取第二张工作表**

```
> names(getSheets(wb))[2]
[1] "name city" 
```

*** 以上假设是 xlsx 包已安装并加载到 R 中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-28T05:44:25.410

只有这在我的情况下有效：

```
library(openxlsx)
sheetNames <- getSheetNames("filename.xlsx") 
```

以上解决方案均不适用于我的大 xlsx（>300 张）：

> .jcall 中的错误（“RJavaTools”、“Ljava/lang/Object;”、“invokeMethod”、cl、：java.lang.OutOfMemoryError：Java 堆空间

# jquery - 动态更改 Twitter API @username 的文本和链接的颜色

> ID：12380359
> 
> 赞同：0
> 
> 时间：2012-09-12T02:15:04.130
> 
> 标签：jquery, api, twitter

我正在研究网站的社交媒体部分，我的要求允许用户更改他用于 twitter 窗口的背景和文本的颜色。我已经部分实现了它，但是当**动态加载推文**时，一个与每次使我的更改为空时都会加载文本。我使用 jquery 使用**farbtastic.js**添加颜色，但它可以部分工作。如何避免应用到 API 的 css 的动态加载或覆盖每个推文加载的默认颜色？任何链接或指针都会有所帮助。这就是我将 css 应用于推文的段落元素的方式！

```
 if(container.className == 'tweetCPTrans'){
    $('p').attr('style', 'color:'+fb.color+' !important');      
 }

     twMix = new TWTR.Widget({ version: 4,
     type: 'profile', 
     rpp: 4, 
     interval: 6000, 
     width: w, 
     height: h, 
     theme: { shell: 
      { background: 'none', 
        color: '#4c4c4c' }, 
      tweets: { 
      background: '#none', 
      color: '#4c4c4c', 
     links: '#b30009' } } 
```

谢谢萨赫
_

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:08:39.353

这看起来像你想要的。

```
complete : function (tweetBox) {

  me.tweetBox = tweetBox; 

  try {

     me.tweetBox.$editor.css({

        resize : 'none', 

        color : '#9B9B9B', 

        'font-family': 'Arial', 

        'font-size': '14px', 

        border : 'none', 

        background : 'transparent', 

        'border-radius': 0, 

        '-webkit-border-radius': 0, 

        '-moz-border-radius': 0 

     }); 

     me.tweetBox.$button.css( {

        cursor : 'hand', 

        cursor : 'pointer' 

     }); 

  } catch (e) {

     //

  } 
```

}

这是该方法的`complete`回调`tweetbox`。

# vim - 在Vim中用空行分隔行？

> ID：12380360
> 
> 赞同：3
> 
> 时间：2012-09-12T02:15:15.393
> 
> 标签：vim, newline, shortcut, multiline

我正在处理一组评论，例如：

```
//this is comment 1
//this is comment 2
//this is comment 3
//this is comment 4 
```

我想让它看起来像：

```
//this is comment 1

//this is comment 2

//this is comment 3

//this is comment 4 
```

在命令模式下，是否有 Vim 快捷方式可以在选定的行上进行这种转换？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T02:18:55.777

您可以使用该`:substitute`命令。将光标放在第一行的任意位置：

```
:,+3s/$/\r 
```

这会在每行的末尾插入一个额外的换行符。

您也可以使用该`:global`命令。将光标放在第一行的任意位置，运行：

```
:,+3g//norm o 
```

对于接下来的四行中的每一行，这将执行`o`正常模式命令，添加一个新的空白行。

在这两个命令中，`,+3` 前缀都是命令的*范围*，请参阅`:help range`. 简而言之，逗号分隔范围的起始行和结束行的地址，如果我们省略两个地址中的前者，则使用当前行。`+3` 地址是指当前行以下三行的行。

`,+3`您可以使用 `V`普通模式命令在您想要的所有行上创建一个可视块，而不是为这些命令中的任何一个指定范围，例如。然后键入 `:`开始命令将自动填充指定可视块的范围，然后您可以输入以 `s`或 开头的两个命令中的任何一个`g`：

```
:'<,'>s/$/\r 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T22:04:46.083

可以使用命令

```
:g/^/pu_ 
```

在整个缓冲区（默认情况下）或选定的行范围内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T02:21:51.427

您可以使用宏：

```
qao<esc>jq 
```

然后使用`3@a`在最后几行应用宏 3 次。

在哪里：

```
qa    "Start recording a macro named a
o     "Insert new line under current line
<esc> "Exit insert mode
j     " Move down next line
q     " end macro 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T02:24:11.020

选择您的视觉选择`V`

然后运行正则表达式替换以将一个换行符替换为两个

`:s/\n/\r\r/g`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T14:46:23.600

选择你想要的线条`V`

然后输入`:`和`s/\ze/\r`

# c++ - 使用指针时 xcode 发生 EXEC_BAD_ACCESS

> ID：12380364
> 
> 赞同：0
> 
> 时间：2012-09-12T02:15:48.807
> 
> 标签：c++, exc-bad-access

我只是在学习 c++ 的基础知识，并且已经到了关于指针的部分。但是，在尝试为指针的内容分配值时出现错误。有小费吗？

```
#include <iostream>
class X
{
public:
    int * x;
    X()
    {
        int * x = new int;
    }   
};

int main (int argc, const char * argv[])
{

    X test;
    *(test.x) = 10;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:19:22.597

这一行：

```
int * x = new int; 
```

声明一个局部变量 x。公共成员**x**仍未初始化为指向任何分配的内存。

所以将其更改为：

```
x = new int; 
```

将工作。

# android - android 3.0+ 中的 getSupportFragmentManager() 与 getFragmentManager()

> ID：12380367
> 
> 赞同：8
> 
> 时间：2012-09-12T02:16:02.867
> 
> 标签：android, actionbarsherlock

在 android.support.v4.app.FragmentManager 的文档中：

“静态库支持版本的framework的FragmentManager。用于编写运行在Android 3.0之前的平台上的应用程序。运行在**Android 3.0以上的时候，还是使用这个实现，不会尝试切换到framework的实现**。见用于类概述的框架 SDK 文档。”

那么，我是否需要在运行时进行检查并为运行应用程序的 android 版本使用适当的 FragmentManager？即如果在 android 3.0+ 上调用 getFragmentManager() 而不是 getSupportFragmentManager()

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T02:17:18.327

`getSupportFragmentManager()`只要您导入了支持库，在 Android 3.0+上使用就没有问题。如果您想`getFragmentManager()`用于 SDK 11+，那就去吧；请记住，您可能正在`if/else`编写大量带有版本检查的代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-04-19T10:17:29.837

如果您使用 API >= 14，则使用 getFragmentManager()。如果您希望与 API 14 以下的设备兼容，则可以使用 getSupportFragmentManager()。因此，getSupportFragmentManager() 用于向旧平台提供新功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-13T16:27:20.817

如果您在项目或应用程序中使用支持包，那么您必须使用 getSupportFragmentManager，因为这是您返回 fragmentManager 以与与此活动关联的片段交互的方式。另一方面，如果您不是，那么您可以使用 getFragmentManager。这仅取决于您在应用程序中使用的内容。

# c# - 跨 AppDomain 添加事件

> ID：12380369
> 
> 赞同：1
> 
> 时间：2012-09-12T02:16:04.627
> 
> 标签：c#, ironpython, appdomain

好的，所以我有这个 python 代码

```
_events.GameStart += method

method():
    DoStuff 
```

在 c# 方面

```
[SecuritySafeCritical]
public class ScriptEvents: MarshalByRefObject
{
    public event Action GameStart;

    public ScriptEvents(Engine e)
    {
        _engine = e;
    }

    public void FireGameStart()
    {
        if(GameStart != null)
          GameStart.Invoke();
    }
} 
```

所以我传入`ScriptEvents`. `_events`这对于像这样的python调用方法效果很好`_events.FireGameStart()`，但我无法附加到事件。

我最终得到一个错误，说不能序列化委托。现在我已经尝试使用`CrossAppDomainDelegate`，但这似乎并没有解决问题。

我想知道是否有某种神奇的方法可以将该委托扔到墙上，以便我可以从 c# 端调用它并激活后续的 python 代码？

此外，如果它是相关的

```
var Events = new ScriptEvents();
AppDomain sandbox = CreateSandbox(forTesting);
var _engine = Python.CreateEngine(sandbox);
ScriptScope scope = _engine.CreateScope();
scope.SetVariable("_events",Events);
var _sponsor = new Sponsor();
var life = (ILease) RemotingServices.GetLifetimeService(Events);
life.Register(_sponsor);

private static AppDomain CreateSandbox(bool forTesting)
{
    var permissions = new PermissionSet(PermissionState.Unrestricted);
    var appinfo = new AppDomainSetup {ApplicationBase = AppDomain.CurrentDomain.BaseDirectory};
    return AppDomain.CreateDomain("Scripting sandbox", null, appinfo, permissions);
} 
```

# objective-c - RestKit - get:queryParameters:delegate 的返回类型：

> ID：12380372
> 
> 赞同：0
> 
> 时间：2012-09-12T02:16:15.587
> 
> 标签：objective-c, restkit

下面的代码有效，但我还没有弄清楚如何。

```
RKObjectManager *objectManager = [RKObjectManager managerWithBaseURLString:@"https://xyz.com"];

[objectManager.client get:@"/abc/feed.json"
                 queryParameters:[NSDictionary dictionaryWithObject:@"lmn" forKey:@"qrs"]
                        delegate:self]; 
```

get:queryParameters:delegate: 方法是 RKClient 中的一个实例方法，它返回一个 RKRequest 类型的对象。声明如下所述。

```
- (RKRequest *)get:(NSString *)resourcePath queryParameters:(NSDictionary *)queryParameters delegate:(NSObject<RKRequestDelegate> *)delegate; 
```

那么这个方法调用怎么没有返回任何东西，或者换句话说，它的返回结果没有被分配给某个东西。一个人可能会查看代码并认为该方法的返回类型是 void。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:02:55.033

这是objective-c的正常行为，您可以忽略返回值。如果您有警告这样做，您可以随时将返回值强制转换为 (void)。

```
(void)[objectManager.client get:@"/abc/feed.json"
             queryParameters:[NSDictionary dictionaryWithObject:@"lmn" forKey:@"qrs"]
                    delegate:self]; 
```

# .net - 在运行时条件序列化属性

> ID：12380374
> 
> 赞同：1
> 
> 时间：2012-09-12T02:16:25.867
> 
> 标签：.net, serialization

我想在运行时对同一个对象进行几种类型的序列化。例如，我有课

```
class Car {
    string Color;
    string Model;
} 
```

而且我希望一项服务仅发送“颜色”属性，而另一项服务仅发送“模型”。这个有什么巧妙的解决方案吗？最好使用 Newtonsoft Json.Net。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:18:37.673

只需使用匿名类型：

```
var myObject = new Car();
return new { myObject.Color } 
```

或者

```
var myObject = new Car();
return new { myObject.Model } 
```

# linux - Linux 中 Qt 动态库的问题

> ID：12380377
> 
> 赞同：4
> 
> 时间：2012-09-12T02:16:31.937
> 
> 标签：linux, qt, quickfix, dynamic-library

我在 Qt 中构建了一个基于 QuickFIX Engine 的应用程序，名为`fixapp`; 它工作正常。我的经纪人要求我指定一个本地端口来连接到他们。然后我找不到这样的配置文件，所以我修改了QuickFix的源代码。

我用QuickFIX源代码自带的例子进行了测试`tradeclient`。`executor`这行得通。`tradeclient`绑定到我在配置文件中指定的本地端口。

但是，当我`fixapp`使用修改后的 QuickFIX 源代码构建的库时，它并没有绑定到我指定的本地端口。看来我修改的部分并没有改变程序的行为。

这里有什么潜在的问题？

更新：我试图在`QuickFix`源代码中设置一些断点。在我修改的一个 cpp 文件中，我的断点被忽略了。它是调试模式，而不是发布模式。我觉得它正在运行旧的 cpp 文件并显示新的 cpp 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-20T16:50:20.973

提问者发现quickfix库路径是`.../quickfix/lib`，我引用的外部库的路径`fixapp`也是`.../quickfix/lib`。然而，当他检查图书馆路径时`/usr/lib`，图书馆仍然是旧的。一旦他更换了 中的`/usr/lib`那个，就`fixapp`开始工作了。他不知道为什么他在 Qt 中引用的路径行不通，但`/usr/lib`行得通。

# javascript - Javascript将变量分配给警报

> ID：12380382
> 
> 赞同：3
> 
> 时间：2012-09-12T02:17:09.637
> 
> 标签：javascript, alert

我想知道您可以为警报分配一个变量吗？它的真正含义和作用是什么？例如，

```
var a = alert('test'); 
```

我试过了，一旦页面加载，当我调用它时变量`a`仍然存在的地方就会弹出警报。`'undefined'`难道我们不应该把它变成一个匿名函数，里面有警报吗？

```
var a = function(){ alert('test'); } 
```

如果我们想触发某事的警报？为什么javascript允许你这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T02:24:24.153

```
var a = alert('test'); 
```

将此语句视为任何其他变量赋值。为了执行分配，首先评估右侧。在这种情况下它是一个函数调用，所以函数被调用并获得它的返回值。在警报的情况下，返回值为`undefined`. 它不返回任何东西。

然后将返回值分配给`a`，因此`a`以 value 结束`undefined`。

作为该语句的副作用，会显示一条警报消息。这是调用 alert() 并获取其返回值的结果。

```
function foo(x) {
    return x * 2;
}

var a = foo(3); 
```

这段代码在结构上类似于 alert 调用，结果`a`为 6。但是 alert() 不返回值。它更像是这样的：

```
function bar(x) {
    return;
}

var a = bar(3); 
```

现在`a`是`undefined`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T02:22:22.437

```
var a = alert('test'); 
```

这表示执行`alert('test')`该函数的返回值并将其分配给名为 的变量`a`。

这与以下内容没有什么不同：

```
var max = Math.max(1,2,3,4); 
```

where`max`最终会将其中的值`4`作为 execution 的返回值`Math.max(1,2,3,4)`。

* * *

```
var a = function(){ alert('test'); } 
```

这表示声明一个匿名函数并将该函数对象分配给变量`a`。由于该函数是刚刚声明的，所以此时不​​执行。您可以在将来使用`a()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T02:33:47.873

你评论说：

> 我只是想知道为什么javascript允许我们这样做，如果它真的没有任何意义

好吧，只要语法有效，JavaScript（和任何其他语言，包括英语）就可以让你做很多没有任何意义的事情。例如，下面的片段也没有任何意义：

```
var a;
a = a; // so what?

function something() { /* nothing */ }
var b = something(); // very similar to your example! 
```

如果您可以从某些功能分配而不是从其他功能分配，那会不会不太一致？如果输入了语言，那会产生错误，但既然不是，那有什么问题呢？如果它们不返回值，则它们的返回值为`undefined`，如果您尝试将其分配给变量，则不会中断。因此，您可以创建有时会返回某些内容的函数，有时则不会。如果使用得当，这可能是一个优势。这是一个功能，而不是语言的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T02:20:28.970

如果你这样做：

```
 var a = function(){ alert('test'); } 
```

然后你可以这样做：

```
a(); 
```

因为你已经定义了一个匿名函数..

alert 是一个函数，所以你不能给它分配任何东西，本质上。

如果你想在变量有值的情况下弹出一些东西，你可以做类似的事情 -

```
$(document).ready(function() { 
  if (someVar != undefined) {
    alert(someVar);
  }
}); 
```

# css - 自举流体行宽

> ID：12380384
> 
> 赞同：5
> 
> 时间：2012-09-12T02:17:12.707
> 
> 标签：css, twitter-bootstrap

在 bootstrap-responsive.css

```
.row-fluid .span10{
    width: 91.45299145299145%;
    *width: 91.39979996362975%;
} 
```

我正在配置大小，但很好奇它们是如何得出这些数字的，为什么它们精确到小数点后 14 位？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T12:31:34.500

它们以三个值开头，可以由用户定义：

```
@gridColumns: 12;
@gridColumnWidth: 60px;
@gridGutterWidth: 20px; 
```

**编辑：**在 Bootstrap 3.0+ 上，变量现在是：

```
@grid-columns
@grid-gutter-width
@grid-float-breakpoint   // the point at which the navbar stops collapsing 
```

并计算固定行宽：

```
@gridRowWidth: (@gridColumns * @gridColumnWidth) + (@gridGutterWidth * (@gridColumns - 1)); 
```

然后他们变得流畅：

```
@fluidGridColumnWidth: percentage(@gridColumnWidth/@gridRowWidth);
@fluidGridGutterWidth: percentage(@gridGutterWidth/@gridRowWidth); 
```

最后，生成所有跨度（这有点令人困惑）：

```
.spanX (@index) when (@index > 0) {
  (~".span@{index}") { .span(@index); }
  .spanX(@index - 1);
}

.span (@columns) {
      width: (@fluidGridColumnWidth * @columns) + (@fluidGridGutterWidth * (@columns - 1));
      *width: (@fluidGridColumnWidth * @columns) + (@fluidGridGutterWidth * (@columns - 1)) - (.5 / @gridRowWidth * 100 * 1%);
}

.row-fluid {
  // generate .spanX and .offsetX
  .spanX (@gridColumns);
  .offsetX (@gridColumns);
} 
```

如您所见，LESS 进行除法和乘法运算。

自己看：

1.  [https://github.com/twitter/bootstrap/blob/master/less/variables.less](https://github.com/twitter/bootstrap/blob/master/less/variables.less)
2.  [https://github.com/twitter/bootstrap/blob/master/less/mixins.less](https://github.com/twitter/bootstrap/blob/master/less/mixins.less)

# android - Android地图编程

> ID：12380391
> 
> 赞同：1
> 
> 时间：2012-09-12T02:17:45.460
> 
> 标签：android

实际上，我正在 Android 中开发地图浏览器应用程序。我有一个 .dat 文件，其中包含具有这样文件格式的地图信息，

```
struct point{
    int x,
        int y;
}; 
```

如何使用这种格式读取这个 .dat 文件并将值复制到 x 和 y 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:55:48.503

如果您指的是离线地图浏览器（本地存储在手机 SD 卡中的图块），您有多种选择：

1- 使用 osmdroid 地图查看器（[code.google.com/p/osmdroid](http://code.google.com/p/osmdroid)）。该库支持离线模式的一系列格式，并且还能够连接到一些在线地图切片提供商（如[openstreetmap](http://www.openstreetmap.org)）。要为此库创建离线切片，您可以使用[Mobile Atlas Creator](http://mobac.sourceforge.net)。

2-使用[地图锻造](http://code.google.com/p/mapsforge)。该库根据数据生成地图瓦片（动态渲染地图瓦片）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T04:00:44.877

要绘制地图，您需要扩展[View 类](http://developer.android.com/reference/android/view/View.html)并实现[onMeasure(int, int)](http://developer.android.com/reference/android/view/View.html#onMeasure%28int,%20int%29)和[onDraw(android.graphics.Canvas)](http://developer.android.com/reference/android/view/View.html#onDraw%28android.graphics.Canvas%29)等方法。然后在 onDraw 中，您可以直接使用[Canvas](http://developer.android.com/reference/android/graphics/Canvas.html)方法绘制映射元素，例如 drawArc、drawCircle、drawLine、drawOval、drawPath、drawPoint、drawRect、drawText 等。[要获得线索，请查看mapsforge](http://code.google.com/searchframe#8SMNiUpcFlI/trunk/mapsforge/src/org/mapsforge/android/map/CanvasRenderer.java&q=Canvas%20package%3amapsforge%5C.googlecode%5C.com&ct=rc&cd=2&sq=)中的此类（例如）。

# php - 我在哪里可以找到可以接受变量的文本编辑器插件

> ID：12380393
> 
> 赞同：0
> 
> 时间：2012-09-12T02:18:28.917
> 
> 标签：php, jquery

我不知道怎么称呼它，但这是图片：

![在此处输入图像描述](../Images/55ccbaba5a5d3b6d009ef4fc6faf8853.png)

在此处查看[更高质量的图像](https://i.stack.imgur.com/81qMl.jpg)。

我在某个网站上看到了它，以及创建报告的内容，我在数据库中获得的值将传递给该插件（*不知道该怎么称呼它*）。

在上图中。你怎么称呼它？是否可以将 php 变量传递给它？例如，我的值为：

```
$hello = "<b>hello</b>"; 
```

我可以将该值传递给上面的插件吗？那么插件的价值将是`Hello`它的粗体吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:24:03.090

首先，我不明白问题的标题与您关于您展示的 puling 的问题有何关系。

你上面有一个富文本编辑器..它是一个所见即所得的html编辑器..你有很多这样的插件，最oppulr是[tinyMCE](http://www.tinymce.com/)

# kml - 一个 kml 文件中的不同方面（线串）

> ID：12380396
> 
> 赞同：0
> 
> 时间：2012-09-12T02:18:51.467
> 
> 标签：kml, google-earth

我想在一个 kml 文件中呈现同一路径上的不同方面（因此不同的线串）。KML 格式是否支持对象的层次结构：

```
Document
  Aspect1
    Aspect1_1
      LineString1
      LineString2
    Aspekt1_2
      LineString1
  Aspect2
  ...
Document 
```

所以我需要在一个文件中有很多方面。

UPD：在一个地标中有许多具有不同 LineStyles 的 LineStrings 呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:05:00.037

我不确定你所说的一个方面是什么意思。但是，这可能很有用。为包含的文件夹或文档提供一个 ListStyle，其中 listItemType 为 radioFolder： [https ://developers.google.com/kml/documentation/kmlreference#liststyle](https://developers.google.com/kml/documentation/kmlreference#liststyle)

然后在左窗格中将您的选项显示为单选按钮，因此一次只能选择一个。然后使用与其他方式不同的 LineString 创建不同的 Placemarks。

# assembly - 您将如何使用 lc3/汇编代码将存储的十六进制值转换为二进制等效值？

> ID：12380400
> 
> 赞同：1
> 
> 时间：2012-09-12T02:19:16.857
> 
> 标签：assembly, binary, hex, lc3

这些值存储在 .BLKW 对象中，并通过 LDR R0,R1,0 - ADD R1,R1,1 加载到 LOOP 中（以增加 .BLKW 地址）。问题是如何将存储的 HEX 值转换为二进制值，然后以 16 位二进制格式将转换输出到 CONSOLE。任何想法将不胜感激！我已经考虑过 ANDing 值，但不确定如何去做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-06T02:30:48.717

你已经把循环搞定了。然而，一个小错误。
我们知道，当我们使用 OUT 进行打印时，它会将 R0 中的值打印到控制台。因此，我们正在打印的数字（R0 中的数字）应该始终为 0 或 1。因此，我们正在处理的十六进制值应该存储在其他一些寄存器中，例如 R2。因此，代码“LDR R0, R1, 0”变为“LDR R2, R1, 0”。

现在，对于每个单词（也就是 .BLKW 中的地址），您必须将其转换为二进制，一次打印一位。

你可以做 16 次 AND 操作。通过将 R2 与 1000 0000 0000 0000 的数字进行与运算来检查 [16]（最左边的位）是否为 1。如果结果不是 0，那么您知道最左边的位是 1，所以打印 1 . 如果结果是 0，你知道它一定是 0，所以打印 0。然后将 R2 与 0100 0000 0000 0000 以相同的方式检查第二位，依此类推。

然而，这只是一团糟。最好的方法是使用循环。

将其中一个寄存器 - 比如说 R3 设置为 1000 0000 0000 0000。我们将在一分钟内使用它。

让我们使用 R5 作为我们的哨兵，也就是“计数器”，告诉我们何时处理完所有 16 位数字。我们将 R5 设置为 16，然后每次通过循环时从 R5 中减去 1，当我们达到 0 时，我们将退出循环。

现在，将什么放入循环中。

对于每次迭代，AND R2 和 R3，并将结果存储在一些未使用的寄存器中，如 R4。如果结果为零，我们知道 R2 的最左边位为零，所以打印 0。如果结果为负（因为 1000 0000 0000 0000 是 2 的补数，因此为负数），我们知道最左边的位是a 1，所以打印 1。

然后在 R2 中进行左移。这是通过将 R2 添加到自身并通过以下方式存储它来实现的：“ADD R2, R2, R2”。

通过以下方式减少我们在 R5 中的计数器：“ADD R5, R5, #-1”

返回到循环的开头。

结果应该是你需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:32:16.793

我对lc3一无所知，但假设移位指令反映了进位标志中最后一个移出的位，你可以

*   在小端架构上，将值左移 1，如果设置了进位，则将“1”放入输出流，否则为“0”
*   在大端架构上，将值右移，并在进位设置时输入字符“1”，否则输入“0”到输出。

如果移位指令不移入进位标志，您可以先测试最高或最低有效位（分别用于小端或大端拱），并根据结果将“1”或“0”放入输出流，然后转移——效果是一样的。

“流”是指任何可以想象的输出介质，无论是（字符串）变量还是内存中的其他缓冲区或真实文件。

抱歉，我无法为您提供相关系统的可用源代码。

问候，并玩得开心...

# java - 如何让 MappingJacksonHttpMessageConverter 设置内容长度

> ID：12380404
> 
> 赞同：1
> 
> 时间：2012-09-12T02:19:52.980
> 
> 标签：java, spring

我通过 @ResponseBody 从我的 Spring 控制器返回 JSON 数据。与此类似：

```
@RequestMapping("/api/someMethod.json")
public @ResponseBody MyClass someMethod(@RequestParam Long someVal, HttpServletRequest request) {
    return new MyClass(someVal);
} 
```

MappingJacksonHttpMessageConverter 始终为 getContentLength() 返回 null，这导致内容长度标头为 -1。

我需要准确设置内容长度（以解决客户端上的一个单独问题，我无法访问修复）。

让此类计算生成的 JSON 的内容长度并将其设置在 content-length 标头中的最简单方法是什么？

我不想编写自己的 JSON 生成器并返回 json 字符串，因为我有很多 API 方法需要这个“修复”。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:38:13.087

一般来说，您永远不必手动设置 HTTP 标头的内容长度。能够告诉服务有比实际发送的数据更多或更少的数据是非常危险的。似乎底层技术（在您的情况下为弹簧）实际上不应正确处理 json 转换。

也许 MyClass 对象没有正确转换为 json，这就是为什么没有内容？

# ruby - 启动和停止 Ruby 守护进程

> ID：12380405
> 
> 赞同：2
> 
> 时间：2012-09-12T02:20:07.740
> 
> 标签：ruby, daemons

`daemons`我正在尝试使用gem启动和停止无限循环守护程序。

查看[主页](http://daemons.rubyforge.org)，我尝试了（在 irb 中）：

```
require 'daemons'
=>true
task_handle = Daemons.call do
  loop{
    sleep 10
    puts "foo"
  }
end
=> #<Daemons::Application:0x000000043f96d0 ...
task_handle.stop
=> nil
task_handle2 = Daemons.call do
  loop{
    sleep 10
    puts "bar"
  }
end

=>Daemons::RuntimeException: there is already one or more instance(s) of the program running
from /home/bdares/.rvm/gems/ruby-1.9.3-p194/gems/daemons-1.1.9/lib/daemons/application_group.rb:125:in `new_application'
from /home/bdares/.rvm/gems/ruby-1.9.3-p194/gems/daemons-1.1.9/lib/daemons.rb:251:in `call'
from (irb):21 
```

现在，我正在查看的确切示例（链接页面上的#3）使用 option 进行第一次调用`:multiple => true`，但我真的只需要一次运行一个守护进程（事实上，多个守护进程是不可取的）。

第一个守护进程是否仍然存在并且没有被 GC 处理？如果是这样，我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T07:17:11.433

以下代码可以正常工作：

```
require 'daemons'
task_handle = Daemons.call(:force => true)  do
  loop{
    sleep 10
    puts "foo"
  }
end

task_handle.stop

task_handle2 = Daemons.call do
  loop{
    sleep 10
    puts "foo"
  }
end 
```

变化在于第一次看涨`:force`期权。守护进程检查创建的应用程序编号，而不仅仅是它们正在运行。在您的情况下，即使停止后第一个实例仍然存在。“强制”选项清除未运行的应用程序。

请注意，您可能会遇到另一个问题 -`task_handle.stop`不能保证生成的 proc 会立即停止，因此您需要处理这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T02:13:04.600

我认为这里的误解是*守护进程没有按顺序运行*。根据它们的性质，它们并行运行，它们之间几乎没有协调。我相信您可以找到 System V IPC 信号量的 Ruby 接口来协调它们，但是如果您想要一个作业队列，请查看除守护程序之外的其他东西。

此外，要添加到上面的@Sigurd 答案，这里是实现该`:force`选项的有问题的代码（方便地未记录）（[source](http://daemons.rubyforge.org/classes/Daemons/ApplicationGroup.html#M000056)）：

```
115: if @applications.size > 0 and not @multiple
116:         if options[:force]
117:           @applications.delete_if {|a|
118:             unless a.running?
119:               a.zap
120:               true
121:             end
122:           }
123:         end
124:         
125:         raise RuntimeException.new('there is already one or more instance(s) of the program running') unless @applications.empty?
126:       end 
```

所以基本上， ( `zap`，正如我在源代码中发现的，*绝对什么都不*做)，当你指定 时，如果没有设置多个`:force`，守护进程将删除所有非运行的应用程序。`@applications`否则，您会收到错误消息。因此，这意味着如果您不指定`:force`or `:multiple`，那么您将单向出错。

注意：所有这一切的原因是`Application#stop`不会从`ApplicationGroup`（负责创建新作业的）中删除守护进程。

注意：顺便说一句，在 Ruby 中`{}`用于多行块是不好的形式。仅用于`{}`单行块。`do...end`改为用于多行。

# objective-c - 将现有访问令牌迁移到 Facebook iOS SDK 3.0

> ID：12380410
> 
> 赞同：6
> 
> 时间：2012-09-12T02:20:33.173
> 
> 标签：objective-c, authentication, migration, access-token, facebook-ios-sdk

我刚刚彻底检查了我的代码库以使用新的 facebook-ios-sdk 3.0（来自以前的版本，2.x 或其他版本）。

一切都很好，直到我意识到我没有考虑到已经授予应用程序权限/使用 SDK 的先前实现登录的用户。所以我尝试检查 accessToken 是否保存在 NSUserDefaults 中，如果是，则调用打开会话：

```
 if ([[NSUserDefaults standardUserDefaults] objectForKey:@"FBAccessTokenKey"] &&
        [[NSUserDefaults standardUserDefaults] objectForKey:@"FBExpirationDateKey"]) {
        [FBSession openActiveSessionWithPermissions:permissions
                                       allowLoginUI:allowLoginUI
                                   completionHandler:^(FBSession *session,
                                                       FBSessionState status,
                                                       NSError *error) {
         // deal with state change
         } 
```

我的假设是用户不必为 SSO 快速切换应用程序，因为他们已经拥有了。然而，事实确实如此。

我宁愿不让每个现有用户在升级时都需要重新登录。

有没有人成功升级而无需重新登录？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T16:43:02.133

我已经用 facebook SDK 3.0 升级了一个应用程序，它工作得很好。Facebook SDK 自己处理令牌，但您仍然可以访问 accessToken。

您可以随时访问它，如下所示：

```
NSString *accessToken = [FBSession activeSession].accessToken; 
```

如果没有设置令牌，这将返回 accessToken 或 nil。您甚至可以在会话上定义令牌缓存规则集。享受。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T00:45:11.967

答案在我同事的另一篇文章中。我们能够将用户从 SDK pre 3.0 升级到 3.1，而无需用户重新登录。它涉及到 FBSessionManualTokenCachingStrategy 的使用：

[从 iOS Facebook 2.x -> 3.x 迁移时如何避免注销用户](https://stackoverflow.com/questions/13260141/how-to-avoid-logging-users-out-when-migrating-from-ios-facebook-2-x-3-x)

# c# - 在 Linux/Mono 中创建 Alchemy WebSocket 的访问被拒绝

> ID：12380411
> 
> 赞同：4
> 
> 时间：2012-09-12T02:20:49.730
> 
> 标签：c#, linux, sockets, mono

我的问题实际上与[mono/linux socket denied 相同？](https://stackoverflow.com/questions/10254954/mono-linux-socket-denied)但似乎这个问题没有得到正确的回答，所以我仍然被困住了。

我有一个使用 Alchemy WebSockets 编写的服务器。我让它在 Windows 上运行良好，但在将它移植到 Linux 后，我无法让它工作。每次尝试启动套接字服务器时，我都会收到以下错误：

```
System.Net.Sockets.SocketException: Access denied
  at System.Net.Sockets.Socket.Bind (System.Net.EndPoint local_end) [0x00051] in /build/src/mono-2.10.8/mcs/class/System/System.Net.Sockets/Socket.cs:1104
  at System.Net.Sockets.TcpListener.Start (Int32 backlog) [0x00022] in /build/src/mono-2.10.8/mcs/class/System/System.Net.Sockets/TcpListener.cs:268
  at System.Net.Sockets.TcpListener.Start () [0x00000] in /build/src/mono-2.10.8/mcs/class/System/System.Net.Sockets/TcpListener.cs:243
  at Alchemy.TcpServer.Listen (System.Object state) [0x00000] in <filename unknown>:0 
```

我正在尝试绑定到 1024 以上的端口（在这种情况下特别是 12345），所以这不是问题。我没有运行 AppArmor 或 SELinux 或类似的东西。我的系统上没有使用该端口。如果重要的话，我的用户是“网络”组的成员。如果我使用 sudo 运行我的程序将绑定到套接字，但这显然不是一个理想的情况。

这是我用来创建套接字并开始监听的代码：

```
 static public void Start(int port, string host)
    {
        _server = new WebSocketServer(port, IPAddress.Parse(host));
        _server.OnConnect = OnConnected;
        _server.OnDisconnect = OnDisconnect;
        _server.Start();
    } 
```

“12345”作为“端口”传递，“192.168.0.11”（我的本地 IP）作为“主机”传递。我也试过 IPAddress.Any 无济于事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T17:05:42.883

Alchemy 在 843 处抛出一个 Flash 策略文件 - 在实例化您的服务器时尝试关闭 flashsocketpolicy。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T18:07:42.760

这严格来说是一个权限问题

> 如果我使用 sudo 运行我的程序将绑定到套接字，但这显然不是一个理想的情况。

在 Stackoverflow 的上一篇文章中已经提出了这个问题。 [单声道/linux套接字被拒绝？](https://stackoverflow.com/questions/10254954/mono-linux-socket-denied)

我会尝试将“用户”添加到 sudo 的组中，这将作为一种快速解决方案进行补救。如果它使用 ICMP 或原始套接字，则必须以 root 用户身份运行。仔细检查 Alchemy 是否没有使用它，如果你在没有超级用户权限的情况下运行它有点不走运。

我尝试将此作为评论发布，但它不允许我，这不是一个真正的答案。

仅供参考所有反对的选民。

# iphone - presentingViewController:animated 不工作

> ID：12380412
> 
> 赞同：-1
> 
> 时间：2012-09-12T02:20:54.200
> 
> 标签：iphone, objective-c

我正在尝试使用相机 API 拍照但是当我尝试使用

```
[self presentingViewController:picker animated: YES]; 
```

我不断收到错误消息：

> 'MainViewController' 没有可见的@interface 声明选择器'presentingViewController:animated:'

而且我似乎无法弄清楚如何解决它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T02:32:00.947

应该是`[self presentModalViewController: picker animated: YES]`（现已弃用）

或者`[self presentViewController:picker animated:YES completion: NULL];`

查看[`UIViewController`类参考](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW29)以获取更多详细信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T07:38:49.890

没有什么像@danielbeard 建议`presentingViewController: animated:`的那样。`presentModalViewController: animated:`

`presentingViewController`是一个*只读*属性，它讲述：

“呈现此视图控制器的视图控制器。（只读）”[来自文档。](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instp/UIViewController/presentingViewController)

# java - Java：传输包含空值的双精度数据类型数组需要多少字节？

> ID：12380413
> 
> 赞同：0
> 
> 时间：2012-09-12T02:21:03.973
> 
> 标签：java, amf

[如果我使用二进制传输（例如AMF 协议](http://en.wikipedia.org/wiki/Action_Message_Format)）将具有 100 个元素（例如）的数据类型 double 的数组从应用程序服务器的（Linux CentOS）Java（1.6）方法传递给客户端，则传输了多少字节？

例如，如果它是一个双浮点数数组，每个数字占用 8 个字节。那么，如果数组有 100 个元素长，并且每个元素都为空，是否会传输 800 字节的数组大小？也就是说，如果为null，每个元素是否仍然占用8个字节？

更新：

最终，我对上述问题的理解是，我在服务器上有一个 (x,y) 数据集，它代表一个情节。y 数据是唯一的，但 x 数据是等距的。因此，我可以避免将 x 数据从服务器传输到客户端（而是传输 x 间隔并让客户端重新创建可预测的 x 轴值）。但是，从服务器传递到客户端的数组显示为：

```
myArray[0].x = null
myArray[0].y = 1e-302
myArray[1].x = null
myArray[1].y = 1.42e-202
...
myArray[99].x = null
myArray[99].y = 2.3234e-3 
```

我想知道这些`null`值是否每个都是 8 个字节长，或者我是否会节省一些内存，因为它们是`null`.

更新 2：

BlazeDS（例如 LCDS）[文档](http://help.adobe.com/en_US/LiveCycleDataServicesES/3.1/Developing/lcds31_using.pdf)的 PDF 第 82 页描述了从 Java 到 ActionScript AMF3（由 BlazeDS 和 LCDS 使用）的转换。在 PDF 第 83 页上的表格显示了 Java 类型`null`映射到 ActionScript AMF3 类型`null`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T02:35:34.983

在 AMF0 中，根据[您链接到的 Wikipedia 文章](http://en.wikipedia.org/wiki/Action_Message_Format)，“数字”（AMF0 唯一的数字类型，但它对应于 Java 的`double`）将是九个字节（`0x00`表示它是一个数字，加上数字的双精度浮点数的八个字节-点表示），而 a`null`只是一个字节（`0x05`）。一个数组包含两个字节（初始`0x08`和最终`0x09`）加上它的内容，所以如果数组的长度为*n*，并且它的元素*k*是数字，那么它的总大小将是 2 + 9 × *k* + ( *n* - *k* ) = 2 + *n* + 8 × *k*。如你看到的，`null`s 可能会显着减少传输负载。

AMF3 在细节上有所不同，但相似。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T02:28:09.317

Java SE 中没有 DOUBLE 数据类型。既然它是可空的，那么我们谈论的是[`Double`](http://docs.oracle.com/javase/7/docs/api/java/lang/Double.html)（而不是`double`）。包装类型 ( ) 的实例`Double`比原始类型 ( ) 的值使用更多的内存`double`。

任何空引用所使用的内存都将*少于*类实例引用的内存消耗加上[用于存储实例本身的内存](https://stackoverflow.com/a/8420032/139010)。您可能天真地假设空引用使用 4 或 8 个字节（取决于您使用的是 32 位还是 64 位 JVM），但是[JVM 可以使用一些花哨的优化优化](http://docs.oracle.com/javase/7/docs/technotes/guides/vm/performance-enhancements-7.html#compressedOop)来*潜在地*减小对象的大小参考（更多关于[这里](https://stackoverflow.com/questions/1348008/memory-allocation-how-much-space-does-a-reference-occupy-in-java)和[这里](https://stackoverflow.com/questions/2430655/java-does-null-variable-require-space-in-memory)）。

无论哪种方式，如果您非常关心内存使用情况，那么您*为什么要使用`Double`，而不是`double`?* 如果只是因为您需要“无价值”值，请**使用[`Double.NaN`](http://docs.oracle.com/javase/7/docs/api/java/lang/Double.html#NaN).**

# ruby-on-rails - Rails App 抛出此错误 - 控制台输出是什么意思

> ID：12380417
> 
> 赞同：0
> 
> 时间：2012-09-12T02:21:25.047
> 
> 标签：ruby-on-rails, ruby, json, debugging, afnetworking

我正在使用 iOS 客户端调试我的 rails 应用程序。它是我关注的照片共享和上传应用程序

我完成了客户部分，照片出现在客户周围。包括从客户端将图像上传到服务器的下一部分是发生错误的地方。我在控制器中使用“puts @photos”语句来查看上传后创建的变量。

这是从设备上传照片后引发的错误

```
 19:07:06 web.1  | Started POST "/photos" for 127.0.0.1 at 2012-09-11 19:07:05 -0700
 19:07:06 web.1  | Connecting to database specified by database.yml
 19:07:06 web.1  | Processing by PhotosController#create as JSON
 19:07:06 web.1  |   Parameters: {"photo%5Blat%5D"=>"37.785834", 
 "photo%5Blng%5D"=>"-122.406417", "photo"=>{"image"=>#
 <ActionDispatch::Http::UploadedFile:0x007ff3cf0a3870 
 @original_filename="image.jpg", @content_type="image/jpeg", 
 @headers="Content-Disposition: form-data; name=\"photo[image]\"; 
 filename=\"image.jpg\"\r\nContent-Type: image/jpeg\r\n", @tempfile=#
 <File:/var/folders/dh/1k2rdp_51yd2k43xzkc2pmdh0000gn/T/RackMultipart20120911-22662-1walqgi>>}}
 19:07:06 web.1  | Completed 500 Internal Server Error in 55ms
 19:07:06 web.1  | ActiveModel::MassAssignmentSecurity::Error (Can't mass-assign protected attributes: image):
 19:07:06 web.1  |   app/controllers/photos_controller.rb:51:in `new'
 19:07:06 web.1  |   app/controllers/photos_controller.rb:51:in `create' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:24:19.950

您在模型的`image`属性上遇到质量分配错误。`Photo`只需添加：

```
attr_accessible :image 
```

模型中的某个地方，它应该可以工作。有关详细信息，请参阅[文档](http://api.rubyonrails.org/classes/ActiveModel/MassAssignmentSecurity/ClassMethods.html#method-i-attr_accessible)。

# ruby-on-rails - 部分没有渲染，也没有抛出错误

> ID：12380425
> 
> 赞同：0
> 
> 时间：2012-09-12T02:23:17.660
> 
> 标签：ruby-on-rails, ruby

所以我在项目#show中有以下内容：

```
<h1>Discussion</h1>

<%= render 'discussions/creatediscussion', :project => @project %>

<ul>
    <%= render :partial => 'discussions/discussion', :collection => @discussions %>
</ul>

<h1>Category</h1>
<ul id="categories" data-update-url="<%= sort_categories_url %>">
  <%= render :partial => 'categories/category', :collection => @categories %>
</ul>

<%= render 'categories/createcategory', :project => @project %> 
```

这本质上是渲染表单、视图等等。问题是，尽管这些都不会以任何方式抛出错误，并且在创建讨论和类别之类的东西时有效 - 任何 :partial => '' 都不会呈现。而其余的渲染则......

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:09:02.443

你有没有尝试过：

`<%= render :partial => 'discussions/creatediscussion', :locals => {:project => @project} %>`

或者

`<%= render :partial => 'discussions/discusion', :locals => {:discussions => @discussions} %>`

或者

`<%= render :partial => 'categories/category', :locals => {:categories => @categories} %>`

您可能需要稍微修改部分代码，但声明本地人总是对我有用。

# android - 禁用清除数据并卸载更新/system/app/

> ID：12380428
> 
> 赞同：1
> 
> 时间：2012-09-12T02:23:43.600
> 
> 标签：android, uninstallation

我有一个应用程序可以烘焙到大约 10 个无根设备操作系统上。位于/系统/应用程序。我们正在尝试更新应用程序并阻止用户卸载关键更新或清除数据。我们如何才能禁用管理应用程序菜单中的“清除数据”和“卸载更新”。

# c# - 如何使用 FtpWebRequest 上传图片？

> ID：12380429
> 
> 赞同：5
> 
> 时间：2012-09-12T02:23:44.057
> 
> 标签：c#, asp.net-mvc-3, ftpwebrequest

我一直在为客户构建一个功能，使他们能够从 www.site1.com 上传图像，将图像 URL 存储到数据库中，并将图像存储到 www.site2.com/images 上的文件中。我已经设法将文件上传到目标位置，但是当我尝试打开并查看图像时，据说它包含错误。我从来没有真正需要处理图像，所以我很茫然。

这是用于上传文件的方法：

```
public static void UpLoadImage(Stream image, string target)
    {
        FtpWebRequest req = (FtpWebRequest)WebRequest.Create("ftp://www.site2.com/images/" + target);
        req.UseBinary = true;
        req.Method = WebRequestMethods.Ftp.UploadFile;
        req.Credentials = new NetworkCredential("myUser", "myPass");
        StreamReader rdr = new StreamReader(image);
        byte[] fileData = Encoding.UTF8.GetBytes(rdr.ReadToEnd());

        rdr.Close();
        req.ContentLength = fileData.Length;
        Stream reqStream = req.GetRequestStream();
        reqStream.Write(fileData, 0, fileData.Length);
        reqStream.Close();
    } 
```

这是调用该方法的地方（image1 是一个 HttpPostedFileBase）：

```
myObject.UpLoadImage(image1.InputStream, storedTL.ID + "-1.png"); 
```

如果有一种方法可以使此代码正常工作，或者如果有更好的方法可以做到这一点，请提供帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T02:28:27.693

StreamReader 旨在阅读文本。

改变：

```
StreamReader rdr = new StreamReader(image);
byte[] fileData = Encoding.UTF8.GetBytes(rdr.ReadToEnd()); 
```

到

```
byte[] fileData = File.ReadAllBytes(image); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-21T01:35:56.130

老问题，但我今天在这个问题上浪费了一些时间，并且使用*ReadAllBytes*对我来说不是一个选项，所以我只需要处理 Streams。经过一番研究，我是如何达到我的解决方案的：

```
 public void UploadToFTP(Stream stream, string ftpPath)
    {
        Stream requestStream = null;

        try
        {

            Uri uri = GetServerUri(ftpPath);

            FtpWebRequest request = Connect(uri); //here I set user/pwd/etc
            request.UseBinary = true;
            request.Method = WebRequestMethods.Ftp.UploadFile;
            request.ContentLength = stream.Length;

            requestStream = request.GetRequestStream();

            //Avoid to write zero length files in destiny. 
            //If you have read the stream before for any reason (as a convertion to Bitmap to extract dimensions, for example)
            stream.Seek(0, SeekOrigin.Begin);

            stream.CopyTo(requestStream);

        }
        catch (WebException ex)
        {
            //do something
        }
        finally
        {
            if (requestStream != null)
                requestStream.Close();

        }
    } 
```

# json - 将数据推送到 json 数组中

> ID：12380432
> 
> 赞同：1
> 
> 时间：2012-09-12T02:24:00.863
> 
> 标签：json, yui

我正在尝试使用 YUI 来显示表格。使用以下示例

```
YAHOO.example.Data = {
        bookorders: [
            {id:"po-0167", date:new Date(1980, 2, 24), quantity:1, amount:4, title:"A Book About Nothing"},
            {id:"po-0783", date:new Date("January 3, 1983"), quantity:null, amount:12.12345, title:"The Meaning of Life"},
            {id:"po-0297", date:new Date(1978, 11, 12), quantity:12, amount:1.25, title:"This Book Was Meant to Be Read Aloud"},
            {id:"po-1482", date:new Date("March 11, 1985"), quantity:6, amount:3.5, title:"Read Me Twice"}
        ]
    }

    YAHOO.example.Basic = function() {
        var myColumnDefs = [
            {key:"id", sortable:true, resizeable:true},
            {key:"date", formatter:YAHOO.widget.DataTable.formatDate, sortable:true, sortOptions:{defaultDir:YAHOO.widget.DataTable.CLASS_DESC},resizeable:true},
            {key:"quantity", formatter:YAHOO.widget.DataTable.formatNumber, sortable:true, resizeable:true},
            {key:"amount", formatter:YAHOO.widget.DataTable.formatCurrency, sortable:true, resizeable:true},
            {key:"title", sortable:true, resizeable:true}
        ];

        var myDataSource = new YAHOO.util.DataSource(YAHOO.example.Data.bookorders);
        myDataSource.responseType = YAHOO.util.DataSource.TYPE_JSARRAY;
        myDataSource.responseSchema = {
            fields: ["id","date","quantity","amount","title"]
        };

        var myDataTable = new YAHOO.widget.DataTable("basic",
                myColumnDefs, myDataSource, {caption:"DataTable Caption"});

        return {
            oDS: myDataSource,
            oDT: myDataTable
        };
    }(); 
```

但我没有使用 bookorders 数据，而是使用 esri.tasks.QueryTask 从数据库中查询结果

所以我必须遍历我要填充 bookorders json 数组的数据。

```
for (var i=0, il=results_books.features.length; i<il; i++) {
     var featureAttributes = results_books.features[i].attributes;
         var string = " id : \"" + results_books.features[i].attributes[0] + "\",";
         var string = string + " date : \"" + results_books.features[i].attributes[1] + "\",";
         var string = string + " quantity: \"" + results_books.features[i].attributes[2] + "\",";
         var string = string + " amount: \"" + results_books.features[i].attributes[3] + "\",";
         var string = string + " title: \"" + results_books.features[i].attributes[4] + "\"";

} 
```

但是我如何将字符串推送到 JSON 数组中，读取属性的方法是否正确？

**编辑**：将逗号添加到字符串

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:40:51.810

只需使用对象文字而不是构建字符串：

```
for (var i=0, il=results_books.features.length; i<il; i++) {
     var featureAttributes = results_books.features[i].attributes;
     var book = {
        "id" : featureAttributes[0],
        "date" : featureAttributes[1],
        "quantity" : featureAttributes[2],
        "amount" : featureAttributes[3],
        "title" : featureAttributes[4]
      };
      // push into array   
} 
```

无需使用中间字符串，立即创建一个完整的对象。

# objective-c - Xcode UITouch 和 UIImage 用户触摸放置在触摸位置的图像

> ID：12380437
> 
> 赞同：0
> 
> 时间：2012-09-12T02:24:14.453
> 
> 标签：objective-c, xcode, cocoa-touch, user-interface

Xcode 在用户触摸的地方放置一个图像

```
-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
UITouch *touch=[[event allTouches]anyObject];
CGPoint point= [touch locationInView:touch.view];

UIImage *image = [[UIImage alloc]initWithContentsOfFile:@"BluePin.png"];
[image drawAtPoint:point];
} 
```

基本上触摸屏图像应该出现在触摸的地方，但什么也没有出现......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:44:53.663

1.  你应该像这样初始化一个 UIImage：

    ```
    UIImage *image = [UIImage imageNamed:@"BluePin"]; 
    ```

2.  你应该使用一个 UIImageView 来包含一个 UIImage，你不能直接把一个 UIImage 放到 UIView 中。

**更新**

```
-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch=[[event allTouches]anyObject];
    CGPoint point= [touch locationInView:touch.view];

    UIImage *image = [UIImage imageNamed:@"BluePin"];
    CGRect rect=CGRectMake(point.x, point.y, image.size.width, image.size.height);
    UIImageView *imageView=[[UIImageView alloc]initWithFrame:rect];
    [imageView setImage:image];
    [self.view addSubview:imageView];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:52:59.760

要添加到其他答案，请按照以下方式对其进行动画处理：

```
- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    NSLog(@"Touches began!");
    UITouch *touch= [[event allTouches] anyObject];
    CGPoint point= [touch locationInView:touch.view];

    UIImage *image = [UIImage imageNamed:@"BluePin.png"];

    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    [imageView setFrame: CGRectMake(point.x-(imageView.bounds.size.width/2), point.y-(imageView.bounds.size.width/2), imageView.bounds.size.width, imageView.bounds.size.height)];
    [self addSubview: imageView];
    //self.currentPins += 1;

    [UIView animateWithDuration:2.0 delay:1.0 options:UIViewAnimationOptionCurveLinear  animations:^{
        [imageView setAlpha:0.0];
    } completion:^(BOOL finished) {
        [imageView removeFromSuperview];
        //self.currentPins -= 1;
    }];

   // for(;self.currentPins > 10; currentPins -= 1){
   //     [[[self subviews] objectAtIndex:0] removeFromSuperview];
   // }
} 
```

注释掉的代码是我写的一些额外的代码，用于将屏幕上的引脚数量一次限制为 10 个，假设您有一个名为*currentPins*的@property 。经过测试，它可以工作，假设我在复制、粘贴和注释掉几行后没有搞砸任何事情。

编辑：忽略注释掉的代码。我实际上混合了两个版本（一个没有动画，一个有）所以它坏了。

# perl - 在 sftp 的内存文件对象中

> ID：12380443
> 
> 赞同：1
> 
> 时间：2012-09-12T02:24:50.567
> 
> 标签：perl

在 perl 中执行内存文件对象的最佳方法是什么？我想把它传递给[Net::SFTP::Foreign](https://metacpan.org/module/Net%3a%3aSFTP%3a%3aForeign)的`put`方法。现在我只是使用[File::Temp](https://metacpan.org/module/Net%3a%3aSFTP%3a%3aForeign)作为切换到内存实现的前兆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T08:07:03.903

Perl 允许您打开引用标量变量而不是真实文件的文件句柄。如果 Net::SFTP::Foreign 支持真正的 Perl 级别的文件句柄，这将起作用：

```
my $content = "This is the content we want to put";
open( my $fh, '<', \$content ) || die "Ooops";

$sftp->put($fh, "file.txt") or die "Ooops"; 
```

请参阅 perlfunc 手册页中有关 open 函数的文档。它没有很好地宣传，但它在某处有记录。

如果 Net::SFTP::Foreign 是由 C 库实现的，则不保证可以正常工作。但是在快速查看模块后它应该可以工作，但我还没有测试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T08:32:05.340

The module has an undocumented `put_content` method.

```
$sftp->put_content($content, $remote_filename, %opts); 
```

Don't be afraid to use it because it is not documented, it is just that the author (that's me) forgot to document it!

BTW, under the hood, this method does what pmakholm says in his post.

# arrays - 基本 R：使用循环将 3-D 数组中的元素相乘

> ID：12380445
> 
> 赞同：2
> 
> 时间：2012-09-12T02:25:34.233
> 
> 标签：arrays, r, linear-algebra, vectorization, matrix-multiplication

我有两个 3-D 数组，**A**和**B**，每个 2 x 3 x 3。下面显示的示例（这将有助于阐明我想如何乘法）。

```
 A1   A2   A3                             B1   B2   B3  
 A4   A5   A6                             B4   B5   B6

 A7   A8   A9                             B7   B8   B9
 A10  A11  A12                            B10  B11  B12

 A13  A14  A15                            B13  B14  B15
 A16  A17  A18                            B16  B17  B18 
```

我想要做的是创建一个矩阵，其中 3 个**A**矩阵被平均，一个位置的值由相应的**B**值加权......我无法很好地解释，但例如，第一个元素是：

```
[(A1*B1)+(A7*B7)+(A13*B13)] / sum(B1,B7,B13). 
```

另一个要素是：

```
[(A5*B5)+(A11*B11)+(A17*B17)] / sum(B5,B11,B17). 
```

依此类推...结果是一个 2 x 3 矩阵。我一直在玩嵌套 for 循环的不同组合，下面显示了一个示例，但我还没有弄清楚如何正确地做到这一点......感谢帮助。

```
for (j in 1:2){
     for (k in 1:3){
          ans[j*k]=sum(A[j,k,1:3]*B[j,k,1:3])/sum(B[j,k,1:3])
     }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T02:49:09.363

你可以做：

```
apply(A * B, c(1,2), sum) / apply(B, c(1,2), sum) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:24:36.487

我将重写您的表达式：

```
for (j in 1:2){
     for (k in 1:3){
          ans[j,k]= dotProduct(A[k,j],B[k,j])/sum(B[k,j])
     }
} 
```

# markdown - 在 Markdown 中，如何格式化引号中的斜体文本？

> ID：12380446
> 
> 赞同：4
> 
> 时间：2012-09-12T02:25:33.750
> 
> 标签：markdown, italic

在 Markdown 中，如何格式化引号中的斜体文本？

```
 *italicized text* 
```

不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T02:33:36.723

Markdown 中缩进 4 个空格表示一个[代码块](http://daringfireball.net/projects/markdown/syntax#precode)：`pre`用于显示代码或预格式化文本的元素。Markdown 语法在代码块中被忽略，因此您的示例不起作用。

您需要使用[blockquote 语法](http://daringfireball.net/projects/markdown/syntax#blockquote)：

```
> *italicized text* 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T02:32:47.817

> *像这样？*

这是代码：

```
>*Like this?* 
```

您用字符表示块引号`>`。缩进四个空格会创建一个代码块，您不能在其中插入斜体文本。

# node.js - 在 Node.js 上编译 CoffeeScript 文件从 connect-assets 开始

> ID：12380447
> 
> 赞同：2
> 
> 时间：2012-09-12T02:25:41.540
> 
> 标签：node.js, coffeescript, package

如果我`!= js('engagement')`的`.jade`文件中有，并且该 CoffeeScript 文件将在页面加载时编译成一个`.js`文件，然后我可以`.js`直接访问该文件。

但我**无法启动我的 Node.js 服务器**并直接转到 url 中的`.js`文件`/js/engagement.js`。

是否有一些简单的代码可以放入我的包中`app.js`以使包**“connect-assets”**在编译时有所不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T17:10:11.693

我称这个具体问题为“启动”；您想使用这些文件而不在任何视图中引用它们。对于在前端涉及[requireJS的架构尤其成问题。](http://requirejs.org)

我创建了一个名为的模块，该模块`connect-assets-jsprimer`将在应用程序启动时准备好所有的咖啡脚本文件，以便它们可用。本质上，它只是 `js("")`在 assets/js 文件夹中的所有文件上调用 connect-assets 函数（递归地）。

安装：

```
npm install connect-assets-jsprimer 
```

用法（在您的 server.js 或其他内容中）

```
var assets = require('connect-assets');
var jsPrimer = require('connect-assets-jsprimer');

// Snip ...

app.use(assets());
jsPrimer(assets);

// Optionally, you can pass in a log function to see progress
// jsPrimer(assets, console.log); 
```

在此之后，您应该能够立即请求您的 javascript 文件而无需呈现任何视图。

源代码在 github 上的[connect-assets-jsprimer](http://jgable.github.com/connect-assets-jsprimer)

# django - 如何创建一个 Django 查询集过滤器比较同一模型中的两个日期字段

> ID：12380448
> 
> 赞同：92
> 
> 时间：2012-09-12T02:25:49.907
> 
> 标签：django, django-queryset

试图在我的 Solr 索引中查询活动记录过时的位置。我想检查`Activity.updated`数据库中的日期是否大于`Activity.added_toSolr_date`同一记录的日期。

```
stale_activities_queryset = Activity.objects.filter(updated__gte = self.added_toSolr_date) 
```

模型

```
class Activity(models.Model):
    # Last time entry / metric was updated in the Activity model database
    updated =  models.DateTimeField( verbose_name="CRUD date")
    # When it was added to Solr Index Date
    added_toSolr_date = models.DateTimeField(blank=True, null=True, verbose_name="Added to Solr Index Date") 
```

我引用了 Django Query 文档： [https](https://docs.djangoproject.com/en/1.4/ref/models/querysets/) ://docs.djangoproject.com/en/1.4/ref/models/querysets/ 和样本的单元测试： [https ://github.com/django/django/blob/master/tests/ modeltests/or_lookups/tests.py](https://github.com/django/django/blob/master/tests/modeltests/or_lookups/tests.py)

也在 Stackoverflow 上搜索过。所有示例都使用输入的日期，而不是比较同一模型中的两个日期字段。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2012-09-12T03:54:35.923

# [F 对象。](https://docs.djangoproject.com/en/dev/topics/db/queries/#filters-can-reference-fields-on-the-model)

```
from django.db.models import F
stale_activities = Activity.objects.filter(updated__gte=F('added_toSolr_date')) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-03T02:10:08.897

不幸的是，富田裕二的解决方案没有奏效。

考虑以下模型：

```
class list(models.Model):
    text = models.CharField(max_length=140)
    created = models.DateTimeField()
    modified = models.DateTimeField() 
```

查询集：

```
my_list = todolist.objects.order_by('created').filter(created__gte=F('modified')) 
```

模板：

```
{% if my_list %}
{% for list in my_list %}
{{ list.text}}
{% endfor %}
{% else %}
<p>there is no list</p>
{% endif %} 
```

最后我得到一个空列表，但我知道，这是不正确的。我还在模板中使用了以下内容（没有查询集过滤器）：

```
{% if list.created|date:'d m y h:i:s' == list.modified|date:'d m y h:i:s' %} 
```

它有效，但我希望看到更优雅的解决方案。

# testing - 如何在 Windows 上将 testlink 从 1.9.3 升级到 1.9.4？

> ID：12380452
> 
> 赞同：0
> 
> 时间：2012-09-12T02:26:17.690
> 
> 标签：testing

升级的时候有问题！

```
Read/write permissions

For security reason we suggest that directories tagged with [S] on following messages, will be made UNREACHEABLE from browser
Checking if C:\xampp\htdocs\testlink-1.9.4\gui\templates_c directory exists OK
Checking if C:\xampp\htdocs\testlink-1.9.4\gui\templates_c directory is writable (by user used to run webserver process)    OK
Checking if /var/testlink/logs/ directory exists [S]    Failed!
Checking if /var/testlink/upload_area/ directory exists [S] Failed! 
```

请帮帮我。这。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:27:39.377

假设*testlinkDir*作为 TestLink 的安装目录：

1.  打开文件*testlinkDir/config.inc.php*；
2.  更改 $tlCfg->log_path 和 $g_repositoryPath 的值，如下所示：

    ```
    ...
    $tlCfg->log_path = 'testlinkDir/logs/';
    ...
    $g_repositoryPath = 'testlinkDir/upload_area/'; 
    ```

它在 Win7 中的简单 XAmpp 安装下对我有用。

# internet-explorer - 如何在远程机器上设置 IE webdriver

> ID：12380454
> 
> 赞同：8
> 
> 时间：2012-09-12T02:26:22.773
> 
> 标签：internet-explorer, webdriver, installation, selenium-webdriver

我所有的测试都在一个 ubuntu 盒子里运行。测试是用 PHP 编写的。它们可以与 Firefox 驱动程序和 chrome 驱动程序一起正常工作。我正在使用在同一个盒子中运行的独立 selenium 服务器（selenium-server-standalone-2.25.0.jar）。最近我需要针对 IE 平台编写测试。我已经尝试了一些事情，但到目前为止，我仍然不确定为我的特定场景设置 IE 驱动程序的正确方法是什么。

我曾尝试在同一个 ubuntu 框中安装带有 mono 的 IE，但在安装过程中遇到了很多问题，在我解决了这些问题并使其可以从命令行运行 IE 之后，它仍然没有为我的测试工作。

我在这里通读了这个特定的文档：[http](http://code.google.com/p/selenium/wiki/InternetExplorerDriver) ://code.google.com/p/selenium/wiki/InternetExplorerDriver并在 Windows 框上继续阅读，直到我看到这个：

> 由 IEDriverServer.exe 启动的 HTTP 服务器将访问控制列表设置为仅接受来自本地计算机的连接，并禁止来自远程计算机的传入连接。目前，如果不修改IEDriverServer.exe的源代码，则无法更改。要在远程计算机上运行 Internet Explorer 驱动程序，请将 Java 独立远程服务器与语言绑定的 RemoteWebDriver 等效项结合使用。

所以我将 selenium-server-standalone-2.25.0.jar 下载到 windows 机器并启动它；我的 IEDriverServer.exe 被放入了我的 PATH 中的 C:\windows\system32\。然后我将 ubuntu 框中的代码更改为指向在 windows 框上运行的 selenium 服务器。但仍然没有运气。

我用谷歌搜索了一下，有些人成功地让它运行起来了。但他们似乎正在使用 java 绑定或 c# 绑定，我想他们是在本地机器上开发的。我还没有找到像我这样的工作案例：

> 一个 ubuntu 盒子，基于 PHP 的测试运行连接到在 Windows 上运行的远程 selenium 服务器。一个运行 selenium 独立服务器并在 PATH 中使用 IEDriverServer.exe 的 Windows 框

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-07-06T14:36:35.490

我有一个类似的问题 - 在 Linux 上工作并希望针对 IE 11 运行我的 WD 测试 - 并让它工作。我和 OP 的主要区别在于我的测试是用 Java 编写的。

**我的目标是这样的：**

*   我的工作站：Ubuntu 14.04，用 Java 编写的测试。
*   Windows 机器：一些带有 IE 11 的虚拟机。
*   **我想从 Ubuntu 工作站**针对 Windows 机器上运行的 IE 运行测试（这样我就不需要在 Windows 机器上安装整个开发环境）。

**我做了什么：**

1.  [获得了从 Microsoft（此处](https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/)）下载的 Win 7 和 IE 11 VirtualBox VM ，打开了它的电源。
2.  下载到 Windows 框：(a) Java JRE，(b) [Selenium Standalone Server](http://www.seleniumhq.org/download/) jar（该页面上还没有提到“Internet Explorer Driver Server”），(c) [Internet Explorer Driver](https://github.com/SeleniumHQ/selenium/wiki/InternetExplorerDriver)。
3.  在我的工作站和 Windows 机器之间设置仅主机网络。[这](https://2buntu.com/articles/1513/accessing-your-virtualbox-guest-from-your-host-os/)是对该过程的一个很好的描述。尽管博文中的虚拟机是 Linux，但它对于 Windows 虚拟机的工作方式几乎相同（使用命令提示符下的“ipconfig”而不是“ifconfig”来查找您的 IP）。
4.  在 Windows 机器上，配置了官方 Internet Explorer 驱动程序页面中提到的内容，在“[必需配置](https://github.com/SeleniumHQ/selenium/wiki/InternetExplorerDriver#required-configuration)”部分中。如果他们更改链接，我将它们粘贴在这里：

> *   IEDriverServer 可执行文件必须下载并放置在您的 PATH 中。
> *   在 Windows Vista 或 Windows 7 上的 IE 7 或更高版本上，您必须将每个区域的保护模式设置设置为相同的值。该值可以打开或关闭，只要每个区域都相同。要设置保护模式设置，请从“工具”菜单中选择“Internet 选项...”，然后单击“安全”选项卡。对于每个区域，标签底部都会有一个标记为“启用保护模式”的复选框。
> *   此外，对于 IE 10 及更高版本，必须禁用“增强保护模式”。此选项位于 Internet 选项对话框的高级选项卡中。
> *   浏览器缩放级别必须设置为 100%，以便可以将本机鼠标事件设置为正确的坐标。
> *   仅对于 IE 11，您需要在目标计算机上设置一个注册表项，以便驱动程序可以保持与它创建的 Internet Explorer 实例的连接。对于 32 位 Windows 安装，您必须在注册表编辑器中检查的项是 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE。对于 64 位 Windows 安装，密钥是 HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE。请注意，FEATURE_BFCACHE 子项可能存在也可能不存在，如果不存在，则应创建它。重要提示：在此键中，创建一个名为 iexplore.exe 且值为 0 的 DWORD 值。

请注意，我不需要将`IEDriverServer.exe`' 位置放在 PATH 中，并且在我的 IE 11 设置中找不到“增强保护模式”（所以没有这样做）。

5.  在 Windows 机器上，从命令提示符开始（它们必须**都在运行；我从关于**[这个问题](https://github.com/seleniumhq/selenium-google-code-issue-archive/issues/4308)的帖子中弄清楚了）：
    *   `java -jar selenium-server-standalone-2.53.1.jar`
    *   `IEDriverServer.exe`
6.  将我的测试的设置部分编辑为使用`RemoteWebDriver`，如下所示（192.168.56.101 是 Windows 框的仅主机网络 IP）：

    ```
    DesiredCapabilities capability = DesiredCapabilities.internetExplorer();
    driver = new RemoteWebDriver(new URL("http://192.168.56.101:4444/wd/hub"),
        capability); 
    ```

7.  像往常一样从我的 Ubuntu 工作站运行测试： `mvn test myproject`

它奏效了！:)

# weblogic - 使用 startWebLogic.cmd 启动 weblogic

> ID：12380455
> 
> 赞同：0
> 
> 时间：2012-09-12T02:26:28.250
> 
> 标签：weblogic, wlst

我正在使用 WLST 脚本在 Weblogic 10.3.4 中创建域。然后启动管理服务器并部署一个war文件。全部在脚本中。

在此 WLST 中，我还将更新 setDomainEnv.cmd 文件以在类路径的开头添加某些 jar。当我们使用 startWebLogic.cmd 启动域时，将调用这个 setDomainEnv.cmd。

但是在脚本中，当我使用 startServer 命令启动服务器时，它不会调用 startWebLogic.cmd，因此不会调用我更新的 setDomainEnv.cmd。结果，尽管其他一切正常（例如域创建，战争部署），但由于未加载必要的 jar，我的应用程序失败了。具体来说，我想在类路径中附加 javax.el-api-2.2.4.jar 和 com.sun.el_2.2.0.v201105051105.jar 。

关于如何从 WLST 调用 startWebLogic.cmd 的任何建议。此外，如果我们可以从 ant 任务中调用 startWebLogic.cmd，或者 Maven 也可以。

编辑

我的 weblogic.xml 如下所示

```
 <container-descriptor>
<prefer-application-packages>
  <package-name>javax.el.*</package-name>
  <package-name>com.sun.el.*</package-name>
   <package-name>javax.persistence.*</package-name>
   <package-name>javax.persistence.criteria.*</package-name>
   <package-name>javax.persistence.metamodel.*</package-name>
   <package-name>javax.persistence.spi.*</package-name>  
   <package-name>org.eclipse.persistence.*</package-name>      
   <package-name>org.springframework.*</package-name>      
  </prefer-application-packages>          
 </container-descriptor> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T07:46:53.150

您可以选择以下方法之一

1 - 将所有 jars 放在 %DOMAIN_HOME%/lib 文件夹中，它们将在服务器启动期间添加到类路径中，这样您就不必修改 setDomainEnv.cmd。这里的问题是，如果您阅读 %DOMAIN_HOME%/lib 下的 readme.txt，您会看到这些 jars 添加在类路径的末尾，因此如果您希望所有这些 jars 都位于类路径的开头，那么这是不是一个好的解决方案。

2 - 通过 startWebLogic.cmd 启动服务器的一种方法是使用 nodemanager - 当然，对于这种方法，您需要配置 nodemanger，在域中注册并在启动域之前启动 - 使用 nmConnect 并发出 nmStart - 请参阅[http ://docs.oracle.com/cd/E24329_01/web.1211/e21050/starting_nodemgr.htm#NODEM209](http://docs.oracle.com/cd/E24329_01/web.1211/e21050/starting_nodemgr.htm#NODEM209)了解更多详情

在未来：请注意，如果服务器始终使用 startWebLogic.cmd 启动，则在 setDomainEnv 中设置类路径可能会正常工作，但如果存在服务器也可以从 AdminConsole 启动的任何用例，那么您需要设置类路径at : 登录到 AdminConsole–>Environments—.Servers—>YourManagedServer—>Configuration (TAB)—>ServerStart (SubTab) -> Classpath (text area)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:15:29.877

I wont question why you need these jars deployed, but the way to do this in Weblogic is to deploy them as a Shared Library. You can probably do this with WLST or the Deployer in a script. Modifying the cmd files seems like a hack to me.

# javascript - 检查网络声明的更好方法？

> ID：12380456
> 
> 赞同：0
> 
> 时间：2012-09-12T02:26:38.253
> 
> 标签：javascript, microsoft-metro

我使用 JavaScript 开发 Win 8 Metro 应用程序，可以看作是一个 Web 应用程序。现在我应该检查网络声明以使应用程序能够从服务中获取数据。

我有两个选择：

1.  一种是运行循环功能以每 X 秒检查一次网络（X 可以随时间变化）。
2.  第二个是在任何网络请求操作之前进行检查（例如登录、显示详细信息和退出）。

如果您能告诉我哪种方式更好，我将不胜感激？或者你有另一个解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:22:04.753

[Windows.Networking.Connectivity.NetworkInformation](http://msdn.microsoft.com/en-us/library/windows/apps/br207293.aspx)类提供了一个 NetworkStatusChanged 事件，只要连接状态发生更改，就会触发该事件。

关于管理连接状态更改的 MSDN 快速入门：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh700376.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh700376.aspx)

# android - Android 自定义视图大小

> ID：12380461
> 
> 赞同：5
> 
> 时间：2012-09-12T02:27:18.987
> 
> 标签：android, xml, android-layout, layout

我正在尝试在 android 中创建自己的视图，它只是一个椭圆，将根据典型的**android:layout_width**和**android:layout_height**参数正确绘制。

例如，如果在我的 XML 布局文件中，我有一个 LinearLayout，它是最高级别的视图容器，那么我希望能够添加多个我自己的椭圆视图。（我称之为“PieFiller”）

我知道我非常接近，但由于某种原因，我不知道如何确定 XML 文件中的用户是说“fill_parent”还是“wrap_content”，我什至不知道我是否应该询问该信息。让我们假设 wrap_content 将简单地绘制一个 40x40 像素的圆圈。但是，如果 XML 布局文件指定宽度应该是“fill_parent”，高度应该是“wrap_content”，我想要一个 40 像素高的长水平椭圆和屏幕上的像素数。

以下是我的布局 xml 文件和自定义视图中的代码：

**布局文件**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    xmlns:custom="http://schemas.android.com/apk/res/com.example.relativelayoutexample"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <com.example.relativelayoutexample.PieFiller
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        custom:labelPosition="left"
        custom:showText="true" />

    <com.example.relativelayoutexample.PieFiller
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        custom:labelPosition="left"
        custom:showText="true" />

</LinearLayout> 
```

**名为“PieFiller”的自定义视图类**

```
package com.example.relativelayoutexample;

import android.content.Context;
import android.content.res.TypedArray;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.RectF;
import android.util.AttributeSet;
import android.view.View;

public class PieFiller extends View
{
    private boolean mShowText;
    private int mTextPos;

    private Paint paint;

    private RectF mBounds;

    public PieFiller(Context context, AttributeSet attrs)
    {
        super(context, attrs);

        TypedArray a = context.getTheme().obtainStyledAttributes(attrs, R.styleable.PieFiller,0,0);

        try
        {
            mShowText = a.getBoolean(R.styleable.PieFiller_showText, false);
            mTextPos = a.getInteger(R.styleable.PieFiller_labelPosition, 0);
        }
        finally
        {
            a.recycle();
        }

        paint = new Paint(Paint.ANTI_ALIAS_FLAG);
        paint.setColor(Color.BLUE);
        paint.setStyle(Paint.Style.FILL);
        mBounds = new RectF();
    }

    public void onDraw(Canvas canvas)
    {
        canvas.drawCircle(40.0f, 40.0f, 40.0f, paint);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec)
    {
        int minw = getSuggestedMinimumWidth();
        int w = Math.max(minw,MeasureSpec.getSize(widthMeasureSpec));

        int minh = this.getSuggestedMinimumHeight();
        int h = Math.max(minh, MeasureSpec.getSize(heightMeasureSpec));

        setMeasuredDimension(w,h);
    }

    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh)
    {
        mBounds = new RectF(0,0,w,h);
    }

    public boolean ismShowText()
    {
        return mShowText;
    }
    public void setmShowText(boolean mShowText)
    {
        this.mShowText = mShowText;
        this.invalidate();
        this.requestLayout();
    }
    public int getmTextPos()
    {
        return mTextPos;
    }
    public void setmTextPos(int mTextPos)
    {
        this.mTextPos = mTextPos;
        this.invalidate();
        this.requestLayout();
    }

} 
```

顺便说一下，上面贴出的代码结果，第一个 PieFiller 占据了整个屏幕。（我不希望这样）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-20T05:45:42.640

在自定义视图的 onMeasure() 内添加以下逻辑：

```
int width = 100;
    if(getLayoutParams().width==LayoutParams.WRAP_CONTENT)
    {
        width = 40;
    }
    else if((getLayoutParams().width==LayoutParams.MATCH_PARENT)||(getLayoutParams().width==LayoutParams.FILL_PARENT))
    {
        width = MeasureSpec.getSize(widthMeasureSpec);
    }
    else
        width = getLayoutParams().width;

    int height = 100;
    if(getLayoutParams().height==LayoutParams.WRAP_CONTENT)
    {

    }
    else if((getLayoutParams().height==LayoutParams.MATCH_PARENT)||(getLayoutParams().height==LayoutParams.FILL_PARENT))
    {
        height = MeasureSpec.getSize(heightMeasureSpec);
    }
    else
        height = getLayoutParams().height;

    setMeasuredDimension(width|MeasureSpec.EXACTLY, height|MeasureSpec.EXACTLY); 
```

# windows - 选择多个文件夹时如何禁用上下文菜单选项？

> ID：12380462
> 
> 赞同：1
> 
> 时间：2012-09-12T02:27:21.643
> 
> 标签：windows, directory, contextmenu

这是我的第一个问题，过去几周一直困扰着我，所以想在这里问。

我通过添加以下注册表项为目录添加了上下文菜单选项。 **HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Directory\shell\Upload HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Directory\shell\Upload\command**

问题是，如果只选择一个目录，我想显示上传选项。如果用户选择了多个目录，则不应显示上传选项。

我很感激帮助。

# c# - C#算法难题——装箱

> ID：12380464
> 
> 赞同：1
> 
> 时间：2012-09-12T02:27:51.383
> 
> 标签：c#

我正在尝试为 2d bin 打包制作 FNF 算法，当我调用该方法时，我得到了错误的结果。请帮忙，我找不到问题。

```
private void FFF()
{
    int xmax = 0;
    int movex = 0;
    int movey = 0;
    int maxH = RectBin.Height;
    int maxW = RectBin.Width;
    List<Rectangle> rectsToDraw = new List<Rectangle>();
    for (int i = 0; i < Shapes.Count; i++)
    {
        int height = Shapes[i].Height;
        int width = Shapes[i].Width;
        if ((movey + height) <= maxH)
        {
            rectsToDraw.Add(new Rectangle(movex, movey, width, height));
            movey = movey + height;
            if (xmax < movex + width)
            {
                xmax = movex + width;
            }
        }
        else if ((xmax + width) <= maxW)
        {
            movex = xmax;
            rectsToDraw.Add(new Rectangle(movex, 0, width, height));
            movey = height;
            xmax = movex + width;
        }
        else
        {
            Debug.Write("Message1");
            break;
        }
    }

    for (int j = 0; j < rectsToDraw.Count; j++)
    {
        Debug.Write(rectsToDraw[0]);
    }
    r2d = rectsToDraw;
} 
```

rectBin 是一个公共矩形 (0,0, 300, 190)，Shapes[] 是一个公共矩形列表。我在这里使用之前对形状进行排序：

```
private void button9_Click(object sender, EventArgs e)
{
    Shapes.Sort((x,y) => ((y.Width.CompareTo(x.Width))));
} 
```

当我在调试控制台中启动 FNF 时，我得到重复的列表项和 message1（形状中的第一个，不应该重复），当我应该得到 14 个项目时。

为了清楚起见，我不是在寻找算法，只是有人告诉我我在哪里犯了错误，以便 oblici 中的第一项被复制 4 次到 rectsToDraw 并且循环结束......

输入：{X=0,Y=0,Width=231,Height=66}{X=0,Y=0,Width=167,Height=61}{X=0,Y=0,Width=151,H​​eight =47}{X=0,Y=0,Width=130,Height=40}{X=0,Y=0,Width=119,Height=39}{X=0,Y=0,Width=115,高度=52}{X=0,Y=0,宽度=72,高度=53}{X=0,Y=0,宽度=58,高度=46}{X=0,Y=0,宽度=47 ,Height=32}{X=0,Y=0,Width=41,Height=47}{X=0,Y=0,Width=38,Height=47}{X=0,Y=0,Width= 33,高度=45}{X=0,Y=0,宽度=22,高度=39}{X=0,Y=0,宽度=0,高度=0}

输出：{X=0,Y=0,Width=231,Height=66}{X=0,Y=0,Width=231,Height=66}{X=0,Y=0,Width=167,Height =61}{X=0,Y=0,Width=231,Height=66}{X=0,Y=0,Width=167,Height=61}{X=0,Y=0,Width=151,高度=47}{X=0,Y=0,宽度=231,高度=66}{X=0,Y=0,宽度=167,高度=61}{X=0,Y=0,宽度=151 ,Height=47}{X=0,Y=0,Width=130,Height=40}{X=0,Y=0,Width=231,Height=66}{X=0,Y=0,Width= 167,高度=61}{X=0,Y=0,宽度=151,高度=47}{X=0,Y=0,宽度=130,高度=40}{X=0,Y=0,宽度=119,高度=39}{X=0,Y=0,宽度=231,高度=66}{X=0,Y=0,宽度=167,高度=61}{X=0,Y=0,宽度=151,高度=47}{X=0,Y=0,宽度=130,高度=40}{X=0,Y=0,宽度=119,高度=39}{X=0,Y=0 ,Width=115,Height=52}{X=0,Y=0,Width=231,Height=66}{X=0,Y=0,Width=167,Height=61}{X=0,Y= 0,Width=151,H​​eight=47}{X=0,Y=0,Width=130,Height=40}{X=0,Y=0,Width=119,Height=39}{X=0,Y =0,Width=115,Height=52}{X=0,Y=0,Width=72,Height=53}{X=0,Y=0,Width=231,Height=66}{X=0, Y=0,宽度=167,高度=61}{X=0,Y=0,宽度=151,高度=47}{X=0,Y=0,宽度=130,高度=40}{X=0,Y=0 ,Width=119,Height=39}{X=0,Y=0,Width=115,Height=52}{X=0,Y=0,Width=72,Height=53}{X=0,Y= 0,Width=58,Height=46}{X=0,Y=0,Width=231,Height=66}{X=0,Y=0,Width=167,Height=61}{X=0,Y =0,Width=151,H​​eight=47}{X=0,Y=0,Width=130,Height=40}{X=0,Y=0,Width=119,Height=39}{X=0, Y=0,Width=115,Height=52}{X=0,Y=0,Width=72,Height=53}{X=0,Y=0,Width=58,Height=46}{X=0 ,Y=0,Width=47,Height=32}{X=0,Y=0,Width=231,Height=66}{X=0,Y=0,Width=167,Height=61}{X= 0,Y=0,宽度=151,高度=47}{X=0,Y=0,宽度=130,高度=40}{X=0,Y=0,宽度=119,高度=39}{X =0,Y=0,宽度=115,高度=52}{X=0,Y=0,宽度=72,高度=53}{X=0,Y=0,宽度=58,高度=46}{ X=0,Y=0,Width=47,Height=32}{X=0,Y=0,Width=41,Height=47}{X=0,Y=0,Width=231,Height=66} {X=0,Y=0,Width=167,Height=61}{X=0,Y=0,Width=151,H​​eight=47}{X=0,Y=0,Width=130,Height=40 }{X=0,Y=0,Width=119,Height=39}{X=0,Y=0,Width=115,Height=52}{X=0,Y=0,Width=72,Height=53}{X=0 ,Y=0,Width=58,Height=46}{X=0,Y=0,Width=47,Height=32}{X=0,Y=0,Width=41,Height=47}{X= 0,Y=0,宽度=38,高度=47}{X=0,Y=0,宽度=231,高度=66}{X=0,Y=0,宽度=167,高度=61}{X =0,Y=0,宽度=151,高度=47}{X=0,Y=0,宽度=130,高度=40}{X=0,Y=0,宽度=119,高度=39}{ X=0,Y=0,Width=115,Height=52}{X=0,Y=0,Width=72,Height=53}{X=0,Y=0,Width=58,Height=46} {X=0,Y=0,Width=47,Height=32}{X=0,Y=0,Width=41,Height=47}{X=0,Y=0,Width=38,Height=47 }{X=0,Y=0,Width=33,Height=45}{X=0,Y=0,Width=231,Height=66}{X=0,Y=0,Width=167,Height= 61}{X=0,Y=0,Width=151,H​​eight=47}{X=0,Y=0,Width=130,Height=40}{X=0,Y=0,Width=119,Height =39}{X=0,Y=0,宽度=115,高度=52}{X=0,Y=0,宽度=72,高度=53}{X=0,Y=0,宽度=58,高度=46}{X=0,Y=0,宽度=47,高度=32}{X=0,Y=0,宽度=41,高度=47}{X=0,Y=0,宽度=38 ,高度=47}{X=0,Y=0,宽度=33,高度=45}{X=0,Y=0,宽度=22,高度=39}{X=0,Y=0,宽度=231,高度=66}{X=0,Y=0 ,Width=167,Height=61}{X=0,Y=0,Width=151,H​​eight=47}{X=0,Y=0,Width=130,Height=40}{X=0,Y= 0,Width=119,Height=39}{X=0,Y=0,Width=115,Height=52}{X=0,Y=0,Width=72,Height=53}{X=0,Y =0,Width=58,Height=46}{X=0,Y=0,Width=47,Height=32}{X=0,Y=0,Width=41,Height=47}{X=0, Y=0,Width=38,Height=47}{X=0,Y=0,Width=33,Height=45}{X=0,Y=0,Width=22,Height=39}{X=0 ,Y=0,宽度=0,高度=0}高度=39}{X=0,Y=0,宽度=0,高度=0}高度=39}{X=0,Y=0,宽度=0,高度=0}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:22:03.507

可能还有其他问题，但我认为这段代码：

```
for (int j = 0; j < rectsToDraw.Count; j++)
{
    Debug.Write(rectsToDraw[0]);
} 
```

应该：

```
for (int j = 0; j < rectsToDraw.Count; j++)
{
    Debug.Write(rectsToDraw[j]);
} 
```

（更改`Debug.Write(rectsToDraw[0]);`为`Debug.Write(rectsToDraw[j]);`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T17:34:44.407

没关系，我设法修复它......代码如下：

```
private void FNF()
    {
        int XMX = 0;
        int moveX= 0;
        int moveY = 0;
        int MH = RectBin.Height;
        int MW = RectBin.Width;
        int c1 = Items.Count;
        rectsToDraw = new List<Rectangle>();

        for(int i = 0; i < c1; i++)
        {
            int height = Oblici[i].Height;
            int width = Oblici[i].Width;
            if(((moveY + height) <= MV)&&((moveX+width)<=MW))
            {
                rectsToDraw.Add(new Rectangle(moveX, moveY, width, height));
                moveY = moveY + height;
                if (XMX < moveX + width)
                {
                    XMX = moveX + width;
                }
            }
            else if((XMX + width) <= MW)
            {
                moveX = XMX;
                rectsToDraw.Add(new Rectangle(moveX, 0, width, height));
                moveY = height;
                XMX = moveX + width;
            }
            else
            {
                Debug.Write("Doesn't fit.");
                break;
            }
        }
        for (int j = 0; j < rectsToDraw.Count; j++)
        {
            Debug.Write(rectsToDraw[j]);
        }
    } 
```

又写了一遍，改了一些名字（无缘无故）....还是谢谢....

# node.js - 如何在 Debian VPS 上为 Node.js 安装 websocket 模块？

> ID：12380471
> 
> 赞同：0
> 
> 时间：2012-09-12T02:30:12.353
> 
> 标签：node.js, websocket, debian, vps

我已经成功安装了 Node.js，现在我想安装这里找到的 websocket 模块：[https ://github.com/Worlize/WebSocket-Node](https://github.com/Worlize/WebSocket-Node)

从 root 用户，我运行了以下命令：

```
 npm install websocket 
```

抛出的错误是：

> [websocket v1.0.7]

```
Native code compile failed!!

On Windows, native extensions require Visual Studio and Python.

On Unix, native extensions require Python, make and a C++ compiler.

Start npm with --websocket:verbose to show compilation output (if any). 
```

我应该发出什么命令来安装这个 websocket 模块及其要求？

编辑：当我跑步时`sudo apt-get install gcc make`

我收到这条消息：

> 正在读取包列表... 完成 构建依赖树 正在读取状态信息... 完成 gcc 已经是最新版本。gcc 设置为手动安装。make 已经是最新版本了。0 升级，0 新安装，0 删除，44 未升级。

尝试安装 WebSocket 时出现同样的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T03:33:05.007

如果您看到 install.js，则此错误是因为您遇到了 node-gyp 问题。尝试“sudo npm install -g node-gyp”并再次运行您的命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T02:57:47.610

确保你已经安装了 python、make 和 gcc。默认情况下应该已经安装了 Python。您可以使用以下命令以 root 身份安装 gcc 和 make：

```
apt-get install gcc make 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T08:16:29.190

```
apt-get g++ 
```

解决了我的问题，非常好！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-17T22:33:13.690

我的问题：python 版本。我已经安装了 python 2.4.3 而不是 python 2.7（websocket 需要）。

我使用**make altinstall**[安装 python2.7](http://elastic-computing.blogspot.com.es/2012/08/install-python-27-on-centos-without.html)并为替换 python 脚本创建一个符号链接：

 **```
ln -s /usr/local/bin/python2.7 /usr/bin/python 
```

并为我工作：

```
# npm install websocket --websocket:verbose

[websocket v1.0.8] Attempting to compile native extensions.
gyp http GET http://nodejs.org/dist/v0.10.15/node-v0.10.15.tar.gz
gyp http 200 http://nodejs.org/dist/v0.10.15/node-v0.10.15.tar.gz
make: Entering directory `********/node_modules/websocket/build'
  CXX(target) Release/obj.target/validation/src/validation.o
  SOLINK_MODULE(target) Release/obj.target/validation.node
  SOLINK_MODULE(target) Release/obj.target/validation.node: Finished
  COPY Release/validation.node
  CXX(target) Release/obj.target/xor/src/xor.o
  SOLINK_MODULE(target) Release/obj.target/xor.node
  SOLINK_MODULE(target) Release/obj.target/xor.node: Finished
  COPY Release/xor.node
make: Leaving directory `*******/node_modules/websocket/build'
[websocket v1.0.8] Native extension compilation successful! 
```**

# algorithm - 整数时间复杂度中的位计数算法 (Brian Kernighan)

> ID：12380478
> 
> 赞同：40
> 
> 时间：2012-09-12T02:31:58.147
> 
> 标签：algorithm, bit-manipulation

有人可以解释为什么 Brian Kernighan 的算法需要 O(log N) 来计算整数中的设置位 (1s)。该算法的简单实现如下（在 JAVA 中）

```
int count_set_bits(int n){
    int count = 0;
    while(n != 0){
        n &= (n-1);
        count++;
    }
    return count;
} 
```

我通过逐位清除最右边的设置直到它变为0来理解它是如何工作的，但我只是不知道我们如何得到O（log N）。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-12T04:10:22.893

该算法经过与设置位一样多的迭代。因此，如果我们有一个仅设置了高位的 32 位字，那么它只会通过循环一次。在最坏的情况下，它将每比特通过一次。整数`n`有`log(n)`位，因此最坏的情况是`O(log(n))`. 这是您在重要位上注释的代码（双关语）：

```
 int count_set_bits(int n){
        int count = 0; // count accumulates the total bits set 
        while(n != 0){
            n &= (n-1); // clear the least significant bit set
            count++;
        }
  } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-12T02:56:28.483

N 中有 floor(lg(N)) + 1 个有效位——这是一个以 2 为底的对数。n 中 1 的位数最多是这个。所以时间会有渐近上界 O(lg(N)) = O(log(N))。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-11-08T13:45:17.177

这个问题实际上是关于大 O 表示法中 N 的含义，而不是算法的复杂性。

N 表示数据的大小。但是，如果“数据”是单个数字，您需要定义您所理解的数据大小。一个数字的值或它的表示长度。

IMO算法是O（N）。因为在这个二进制表示中计数 1 的问题中，IMO 相关的数据大小是数字表示的长度，而不是它的值，即比特流的长度。显然最坏的情况是所有 1 都进行 N 次迭代。

但是，如果您将 N 的值视为数据的大小，则它的表示具有 log(N) 长度，因此您可以说它是 O(log(N))

PS 只有当您将算法推广到任意高的 Ns 时，大 O 表示法才有意义。在此代码中，N 受 int 大小的限制，因此您可以说它是 O(1)，因为它最多为 64 次循环迭代（对于 64 位整数）

# java - 如何从（Java）日期对象中获取到期字段以发送到 Apple 推送通知服务？

> ID：12380482
> 
> 赞同：3
> 
> 时间：2012-09-12T02:32:23.217
> 
> 标签：java, ios, apple-push-notifications

谁能澄清增强通知格式（用于发送到 Apple 推送通知服务）的 Expiry 字段中的 4 个字节是什么意思，就像使用 Java 与 APNS 服务器通信一样？说，如果我准备 Date 对象，我如何将它变成发送到 APNS 所需的 4 个字节？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:30:57.983

APNS 文档指出：

> **Expiry** — 以秒 (UTC) 表示的固定 UNIX 纪元日期，用于标识通知何时不再有效并且可以丢弃。到期值应按网络顺序（大端）。如果到期值为正，APNs 会尝试至少发送一次通知。您可以指定零或小于零的值来请求 APN 根本不存储通知。

如果您有一个 Date 对象（让我们称之为`date`），其中包含您的消息应该过期的日期/时间，发送到 APNS 的 4 个字节的过期值是`expiry`：

```
Calendar cal = Calendar.getInstance ();
cal.setTime (date);
int expiry   = cal.getTimeInMillis () / 1000L; 
```

或者你可以有一个相对的到期间隔。例如，如果您希望您的消息在发送到 APNS 服务器后 2 小时（7200 秒）过期，则值为`expiry`：

```
int expiry = (System.currentTimeMillis () / 1000L) + 7200; 
```

# arduino - Arduino - 解析 GET 字符串

> ID：12380483
> 
> 赞同：2
> 
> 时间：2012-09-12T02:32:30.933
> 
> 标签：arduino

讨厌发布这个，但我用谷歌搜索并尝试了许多不同的选项，但没有成功。

基本上我想获取一个状态为 10 个灯的页面并打开/关闭相应的灯。Arduino 正在获取结果并将字符串发布到串行监视器中，但字符串没有触发我的 if 语句。不确定我是否使用错误的函数来解析字符串或我的 if 语句不正确。

这是 GET 的输出，它在串行监视器中发布（打印`readString`）：

> Light1:1 Light2:0 Light3:0 Light4:0 Light5:0 Light6:1 Light7:0 Light8:1 Light9:0 Light10:0

这是我在草图中尝试的最后一件事，每个灯都有一个 if 语句：

```
if (readString.indexOf("Light1:1">0)) 
{
    digitalWrite(light1, HIGH);
}
else
{ 
    digitalWrite(light1, LOW);  
} 
```

你会使用什么功能？我究竟做错了什么？重构页面的输出也是一种选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T21:57:10.133

可能的错字...您在`.indexOf()`通话中进行了比较。你的意思

```
if (readString.indexOf("Light1:1") >= 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T06:22:39.243

字符串将从位置 0 开始。使用 >= 0

# tcp - 系统调用 flush() 在收到 TCP ACK 之前还是之后返回？

> ID：12380489
> 
> 赞同：0
> 
> 时间：2012-09-12T02:32:50.003
> 
> 标签：tcp, linux-kernel, flush

当我使用`send()`并调用阻塞系统调用发送数据时`flush()`，刷新是否返回：

*   收到相应的 TCP-ACK 后？

    或者

*   数据通过网络发送后？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T10:29:31.027

正如@caf 评论的那样，Linux 中没有`flush`系统调用。此外，Linux 中没有等待接收 TCP ACK 的机制。当您将`send`数据传输到网络时，它已进入内核的网络缓冲区，没有更多的保证可用。当内核接收并确认数据已进入远程主机上的接收窗口时，不再有可用的保证（严重的是，它可能尚未到达远程主机上的应用程序）。

如果您希望确保通过 TCP 发送的数据的传递，那么您应该让接收方通过发送回复来确认应用层的数据。

# objective-c - 将0到1之间的浮点数传递给NSLog？

> ID：12380490
> 
> 赞同：0
> 
> 时间：2012-09-12T02:32:59.120
> 
> 标签：objective-c, ios, xcode

```
float beat = 1/2;
    NSLog(@"timeinterval: %f",beat); 
```

"timeinterval" 一直为 0

我的xcode有问题吗？还是我只是在这里坐得太久而错过了一些明显的东西？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T02:36:32.307

这是 C 中整数除法的结果（这是 objc 的基础）。要解决此问题，请显式使用浮点值：

```
float beat = 1.0 / 2.0;
NSLog(@"%f", beat); // works correctly. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T06:49:19.787

```
float x = 1.0/2.0;
NSLog(@"The Float Number is %f",x); 
```

这就是你将如何计算`x`浮点数的值。

# r - r 从 github 采购私人仓库

> ID：12380491
> 
> 赞同：4
> 
> 时间：2012-09-12T02:33:11.780
> 
> 标签：r, github, repository, devtools

嗨，我想知道如何在 github 中获取我有权访问的私有仓库。

使用该`devtools`软件包，可以很容易地使用以下命令来获取开源存储库：

```
source_url('https://raw.github.com/hadley/stringr/master/R/c.r') 
```

但是对私有仓库的 URL 进行等效操作似乎不起作用。

PS我知道我可以克隆整个repo，然后以这种方式获取文件，但我只是在整个repo中寻找一个特定文件来获取，克隆整个东西效率有点低，复制代码和根据需要使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-12T11:04:44.137

我对 R 不是很熟悉，但我通常在我的项目中使用 Git 协议通过 SSH 包含私有存储库。

GitHub 要求您进行身份验证才能下载私有代码。如果您通过 SSH 使用 Git，当您拉入项目依赖项时，您的机器将使用您的 SSH 密钥进行身份验证。我对使用私有 gem 的 Ruby 项目执行此操作，但我不确定 R 是否允许您通过 SSH 使用 Git 获取依赖项。

# ruby-on-rails - id 字段的 Elasticsearch 构面值

> ID：12380503
> 
> 赞同：1
> 
> 时间：2012-09-12T02:34:07.613
> 
> 标签：ruby-on-rails, elasticsearch, tire

我在带有轮胎的轨道上使用弹性搜索。

我的代码：

```
def to_indexed_json
    {
      :id                 => id,  
      :brand_name         => brand_name,
      :brand_id           => brand_id
    }.to_json
end

facet "brands" do
  terms :brand_id
end 
```

我必须查询数据库以检索 elasticsearch 返回的所有品牌的名称。有没有办法从elasticsearch返回这些值（brand_name）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:41:23.593

您可以使用基于 id 字段的构面，并结合将名称添加到每个条目的脚本，以便每个条目将由 id 和 name 组成：

```
"facets" : {
    "tag" : {
        "terms" : {
            "field" : "id",
            "script" : "term + \"_\" + _source.name"
        }
    }
} 
```

然后在前端，您需要以某种方式从构面条目中删除 id 以便仅显示名称（我希望您的 id 不能包含 a `_`），但是当用户选择条目本身时，您可以保留应用过滤器的键.

# c# - 对 PDF 文件使用 MS RawPrinterHelper 类

> ID：12380509
> 
> 赞同：0
> 
> 时间：2012-09-12T02:35:07.000
> 
> 标签：c#, vb.net

我在使用 MS RawPrinterHelper 类打印 pdf 文件时遇到问题。我可以让 txt 文件打印得很好。我将打印机的名称和 pdf 字节传递给打印机 RawPrinterHelper，但什么都不会打印。任何帮助都很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T20:20:37.677

```
 private static void printLables(byte[] LabelFile)
    {

    string s = System.Text.ASCIIEncoding.ASCII.GetString(LabelFile);
    PrintDialog pd = new PrintDialog();
    pd.PrinterSettings = new PrinterSettings();
    pd.PrinterSettings.PrinterName = "Your Printer Name";

    RawPrinterHelper.SendStringToPrinter(pd.PrinterSettings.PrinterName, s);
    } 
```

让我知道这是否适合您。

# oracle - 如何获得 num uniques week to date 但唯一的期间滚动日期

> ID：12380514
> 
> 赞同：1
> 
> 时间：2012-09-12T02:35:31.140
> 
> 标签：oracle, group-by, reporting, analytical

非常简化，一个包含一些示例数据的表格：

```
action_date account_id
1/1/2010    123
1/1/2010    123
1/1/2010    456
1/2/2010    123
1/3/2010    789 
```

对于上面的数据，我需要一个查询，它将给出以下内容：

```
action_date num_events  num_unique_accounts  num_unique_accounts_wtd
1/1/2010    3           2                    2
1/2/2010    1           1                    2
1/3/2010    1           1                    3 
```

正如您在此处看到的， num_unique_accounts_wtd 给出了唯一时期的一种滚动结束日期......

起初，人们会认为是形式的查询

```
WITH
    events AS
    (
        SELECT
            action_date
            , COUNT(account_id) num_events
            , COUNT(DISTINCT account_id) num_unique_accounts
        FROM     actions
        GROUP BY action_date
    )
SELECT
    action_date
    , num_events
    , num_unique_accounts
    , SUM(num_unique_accounts) OVER (PARTITION BY NEXT_DAY(action_date, 'Monday') - 7 ORDER BY action_date ASC) num_unique_accounts_wtd
FROM events 
```

会起作用，但如果你仔细观察，它只会每天添加 num_unique_accounts。如果要在 2010 年 1 月 2 日运行查询，为了清楚起见，它会给出 num_unique_accounts_wtd = 3，因为 2 + 1。

有任何想法吗？

编辑：为清楚起见，又添加了一行数据和输出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T08:50:13.070

我会将事件查询拆分为 2：

```
WITH
    events1 AS
    (
        SELECT 
               NEXT_DAY(action_date, 1) - 7 week
             , action_date             
             , COUNT(account_id) num_events
             , COUNT(DISTINCT account_id) num_unique_accounts
        FROM     actions
        GROUP BY action_date
    ),
    events2 AS
    (
        SELECT NEXT_DAY(action_date, 1) - 7 week               
             , COUNT(DISTINCT account_id) num_unique_accounts_wtd
        FROM     actions
        GROUP BY NEXT_DAY(action_date, 1)
    )
SELECT events1.*, events2.num_unique_accounts_wtd
  FROM events1, events2 
 WHERE events1.week = events2.week 
```

其中*events1*将选择一天不同帐户的数量，而*events2*将选择每周不同帐户的数量。

编辑：我现在明白了这个要求。但是，如果操作表中的行数非常高，我唯一的想法会很重：

```
WITH
events AS
(
    SELECT 
           NEXT_DAY(action_date, 1) - 7 week
         , action_date             
         , COUNT(account_id) num_events
         , COUNT(DISTINCT account_id) num_unique_accounts
    FROM     actions
    GROUP BY action_date 
)      
SELECT events.*, 
      (SELECT COUNT(DISTINCT(account_id)) 
         FROM actions 
        WHERE action_date < events.week + 7) as num_unique_accounts_wtd
 FROM events
ORDER BY events.action_date 
```

如您所见，这个想法是（重新）计算事件子查询的每一行的所有不同*account_id*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T16:41:54.927

似乎答案可能是能够修改分析函数以包含某种形式

```
COUNT(DISTINCT ...) OVER (PARTITION BY ... ORDER BY ... RANGE BETWEEN ... AND ...) 
```

因为 RANGE BETWEEN 允许表达式，所以 PARTITION BY 窗口可以进一步子集化以获得我们正在寻找的东西——不幸的是，Oracle 给出了一个

```
ORA-30487 DISTINCT functions and RATIO_TO_REPORT cannot have an ORDER BY 
```

错误，所以我们不能使用它。

在谷歌搜索错误之后，我发现其他人也在尝试相同的事情（[这里](http://tkyte.blogspot.com/2009/11/comparative-window-functions.html)和[这里](https://forums.oracle.com/forums/thread.jspa?threadID=1555323)），并且在链接中找到了两个答案——其中一个用于我的真实数据。

作为参考，使用原始帖子中的模型对这个问题的答案将是以下形式：

```
SELECT    action_date, COUNT(account_id) num_attempts, MAX(num_accounts) num_unique_accounts_wtd
FROM
(
    SELECT
        action_date
        , account_id
        , SUM(is_unique) OVER (PARTITION BY NEXT_DAY(action_date, 'Monday') - 7 ORDER BY action_date ASC, account_id ASC) num_accounts
    FROM
    (
        SELECT
            action_date
            , account_id
            , CASE
                WHEN LAG(account_id) OVER (PARTITION BY NEXT_DATE(action_date, 'Monday') - 7, account_id ORDER BY action_date ASC) = account_id 
                THEN 0
                ELSE 1
            END is_unique
            FROM
                actions
    )
)
GROUP BY  action_date 
```

所以数据是

1.  迭代并确定对于每个帐号的一周，它是否是唯一的
2.  然后对于每周，首先按操作日期订购集合，然后是 account_id 并创建一个运行总计
3.  按操作日期分组并取最大周数

# java - JDBC Java 教程上的 UnsupportedClassVersionError

> ID：12380517
> 
> 赞同：1
> 
> 时间：2012-09-12T02:35:35.453
> 
> 标签：java, jdbc, ant, javac, unsupported-class-version

我遇到了一个常见问题，即已知的 UnsupportedClassVersionError，我正在使用已经配置的 Ant Apache运行[http://docs.oracle.com/javase/tutorial/jdbc/basics/gettingstarted.html的 JDBC 教程。](http://docs.oracle.com/javase/tutorial/jdbc/basics/gettingstarted.html)我知道错误的性质，但我只是不知道如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T01:47:04.027

我已经解决了这个问题，首先我更新了我的 Java 版本，然后我使用命令行命令：ANT CLEAN 从相应目录中删除 .class 文件，最后我用 ANT JAR 和 VOILA 重新编译我的 java 文件！

# php - ajax php json 返回 null

> ID：12380521
> 
> 赞同：-1
> 
> 时间：2012-09-12T02:37:03.837
> 
> 标签：php, ajax, json

编辑：问题是我试图以使用框架时调用函数的方式调用函数。而且，我什至懒得提一些非常重要的事情，比如我没有使用这个框架。

正如我的同事所指出的，这里应该可以提供帮助。[http://www.php.net/manual/en/language.oop5.basic.php](http://www.php.net/manual/en/language.oop5.basic.php)

问题：我尝试了其他用户建议的多种方法，但 json 仍然返回 NULL 或空白。这是我的代码，我注释掉的行是我尝试过但失败的行。现在我知道以前有过像我这样的帖子，但没有一个对我有用。提前感谢大家。

编辑：我正在使用 chrome，当我按 F12 时转到网络，我可以看到函数 login() 已被访问，并且我传递的数据也在那里。但是，当我尝试打印字符串和/或 die()/exit() 时，响应仍然给我“此请求没有可用数据”。这是什么意思？

我最初在没有进行任何查询的情况下对此进行了测试，但仍然返回 NULL。我想我的问题被否决了，因为我的查询似乎有错误，所以我只是想清除它。我已经处理这个问题 2 天了，我已经尝试了几乎所有东西，我确信这不是查询。

```
 public static function login()
{
    //      header("Content-Type: application/json");
    //      header("Content-Type: text/javascript");

    $response->msg  = '';
    $username = $_POST['username'];
    $password = $_POST['password'];

    $hashed = hash('md5', $password);
    $query = mysql_query("select * from tbl_user where username = '$username' and password = '$hashed'");
    $result = mysql_fetch_object($query);

    if(mysql_num_rows($result) > 0)
    {
        $response->msg  = 1;
        $response->username = $username;

    //          $response['msg']  = 1;
    //          $response['username'] = $username;

        echo json_encode($response);
    }
    else
    {
    //          $response['msg']  = 0;
        $response->msg  = 0;
        echo json_encode($username);
    }
} 
```

Javascript

```
$("#btn_submit").click(function(){

    var username = $("#txtusername").val();
    var password = $("#mypassword").val();

    $.ajax({
        url: base_url + 'includes/main.php/login',
        data: { username: username,  password: password },
                    type: 'post',
    //          async:false,
        dataType: 'json',
        success: function(data)
        {
            console.log(data);
        }
    });
});

    //  $('#btn_submit').click(function() {
    //      var username = $("#txtusername").val();
    //      var password = $("#mypassword").val();
    //      
    //      $.getJSON(base_url + 'includes/main.php/login', 
    //          { username: username,  password: password },
    //      function(json) {
    //          console.log(json);
    //      });
    //  });

    //  $('#btn_submit').click(function() {
    //      var username = $("#txtusername").val();
    //      var password = $("#mypassword").val();
    //
    //      $.post(base_url + 'includes/main.php/login', 
    //          {username: username,  password: password}, 
    //      function(r) {
    //          console.log(r);
    //      }, "json");
    //  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T06:03:46.347

据我了解这个问题，并且您没有指定您使用过任何框架，您试图通过 AJAX url 调用 php 方法

**`login()`如果是控制器方法，请留下这个**

```
url: base_url + 'includes/main.php/login', 
```

但是你不能这样做，试试下面的

在 JavaScript 中

```
$("#btn_submit").click(function(){

    var username = $("#txtusername").val();
    var password = $("#mypassword").val();

    $.ajax({
        url: base_url + 'includes/main.php',
        data: { action:'login', username: username,  password: password },
        type: 'post',
        dataType: 'json',
        success: function(data)
        {
            console.log(data);
        }
    });
    return false;
}); 
```

在php中

```
if(isset($_POST['action']) && $_POST['action'] == 'login') {
    login();
}

function login()
{
    header("Content-Type: application/json");

    $response->msg  = '';
    $username = $_POST['username'];
    $password = $_POST['password'];

    // Do the rest ............

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T02:52:57.803

我认为这不是关于 json 的问题。您的代码没有输出任何内容可能是因为错误，并且 php 通常不会明确报告数据库错误，endyourif 的解决方案应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T02:40:36.380

编辑：

AJAX 作为 get 发送也可能导致 PHP 脚本失败：

```
$.ajax({
    url: base_url + 'includes/main.php/login',
    data: { username: username,  password: password },
//          async:false,
    type: 'post',
    dataType: 'json',
    success: function(data)
    {
        console.log(data);
    }
}); 
```

看起来您的查询可能有错误：

```
 $query = mysql_query("select * from tbl_user where username = $username and password = $hashed"); 
```

$username 和 $password 需要用单引号括起来：

```
$query = mysql_query("select * from tbl_user where username = '$username' and password = '$hashed'"); 
```

我猜你得到 null 的原因是正在默默地生成一个错误。

尝试在查询后添加 or die()：

```
$query = mysql_query("select * from tbl_user where username = $username and password = $hashed") or die('Query error'); 
```

# java - GAE：上传到 Blobstore 服务会终止会话

> ID：12380523
> 
> 赞同：1
> 
> 时间：2012-09-12T02:37:34.897
> 
> 标签：java, html, google-app-engine, jsp, servlets

所以我使用 GAE 并创建了一个会话来在一些 JSP 和 servlet 之间保留一些数据。问题是当我访问 Blobstore 服务以上传文件时，会话被终止并且用户被注销。

这是导致问题的表单属性： action="<%= blobstoreService.createUploadUrl("/upload") %>" method="post" enctype="multipart/form-data"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-04T10:39:05.083

似乎会话正在基于 blobstoreService.createUploadUrl("/test") 更改开发环境中的域而被终止。如果我使用我的开发机器 IP 地址进行测试，则会话被破坏，因为回调 URL 导致计算机名：端口/测试而不是 ipaddress：端口/测试。我在 URL 中使用计算机名来提交表单，最初会话仍然存在并且开发人员很高兴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-25T23:59:16.357

对于将来看到此问题的任何人，似乎此问题仅在*本地开发服务器*中工作时发生，而**不是**在部署应用程序后发生。

在本地开发服务器上进行测试时，我遇到了同样的问题。将文件上传到 GAE Blobstore 会使用户退出并打乱会话。在我部署了我的应用程序后，一切都在网上完美运行。希望我在花费数小时试图找出如何解决它之前先尝试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-23T15:13:49.707

如果您使用 Eclipse 进行开发，您可以在部署之前验证您的每个 jsps。如果你先清除所有错误，编译错误就会消失。我对开发环境没有抱怨但阻止部署的错误感到惊讶。

# c# - Youtube Windows 商店应用 API

> ID：12380525
> 
> 赞同：1
> 
> 时间：2012-09-12T02:37:37.420
> 
> 标签：c#, youtube, youtube-api, windows-store-apps

是否有可用的 API 允许您使用 Metro 布局嵌入 Youtube 视频？我找到了一个名为“工具包”的 btu，它适用于 .net 3.5，我在 .net4.5 上运行

任何建议表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:51:25.240

在 codeplex 上是一个项目 YouTube 类 [YoutubeClass](http://mytoolkit.codeplex.com/wikipage?title=YouTube)

也看看这个线程： [如何在 Windows8 html/javascript 应用程序中播放 YouTube 视频？](https://stackoverflow.com/questions/11491774/how-to-play-youtube-videos-in-a-windows8-html-javascript-app)

这是 google youtube api:> [这里](https://developers.google.com/youtube/getting_started#data_api)

# mysql - Perl DBI mysql 更新

> ID：12380528
> 
> 赞同：1
> 
> 时间：2012-09-12T02:38:05.903
> 
> 标签：mysql, perl, dbi

名称键值。. . . . . 要更新的用户名

```
#!/usr/bin/perl -w
# Use the DBI module

use  strict;
use warnings;
use DBI;

# CONFIG VARIABLES
my $platform = "mysql";
my $database = "prod";
my $host     = "localhost";
my $username = "root";
my $password = "admin";

# DATA SOURCE NAME
my $dsn = "dbi:$platform:$database:$host";

# PERL DBI CONNECT
my $connect = DBI->connect($dsn, $username, $password);

# VARS for Examples
my $query;
my $query_handle;
my $id;
my $demo;

# Example 2 using do() UPDATE   

# SAMPLE VARIABLE AND VALUES TO PASS INTO SQL STATEMENT
$id   = "username";
$name = "Arty";

# do() THE UPDATE
$query        = "UPDATE jos_config SET values = '$name' WHERE namekey = $id;";
$query_handle = $connect->prepare($query);

# EXECUTE THE UPDATE
$query_handle = $connect->do($query);

print STDERR "ERROR: $DBI::errstr";
print STDERR "INFO: $query_handle rows updated";

undef $query; 
```

错误信息：

```
DBD::mysql::db do failed: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'values = 'Arty' WHERE namekey = smtp_username' at line 1 at /home/arty/Documents/SmtpDbchange2.pl line 40.
ERROR: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'values = 'Arty' WHERE namekey = smtp_username' at line 1Use of uninitialized value $query_handle in concatenation (.) or string at /home/arty/Documents/SmtpDbchange2.pl line 43. 
```

请协助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T04:16:41.017

您的语法错误来自“值”是 SQL 中的保留字这一事实。当它用作标识符时，您需要*引用该标记：*

```
UPDATE jos_config SET `values` = ... 
```

通常，MySQL 会在查询摘录的开头向您显示语法错误的位置，就像它为您所做的那样。

您的下一个问题将是您没有正确引用您比较的文字值`namekey`，并且该文字值看起来像一个标识符而不是 MySQL 的字符串。这里的解决方案是忘记插值变量并使用参数化查询：

```
$connect->do('UPDATE jos_config SET `values`=? WHERE namekey=?', undef, $name, $id); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:54:13.357

看起来您在 namekey 值 $id 周围缺少一些引号：

```
$query = "UPDATE jos_config SET values = '$name' WHERE namekey = '$id';"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T03:56:43.327

如果您收到这样的错误，请打印出违规语句：

```
print $query; 
```

这表明：

```
UPDATE jos_config SET values = 'Arty' WHERE namekey = username; 
```

然后盯着它，直到你看到丢失的引号。

然后停止这样做并使用占位符：

```
$query = "UPDATE jos_config SET values=? WHERE namekey=?;";
$query_handle = $connect->prepare($query);
my $result = $connect->do($query, {}, $name, $id); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-07T15:23:23.660

你可以试试这个：

```
my $sthSetid = $dbh->prepare("UPDATE $table SET nameOfColumnToChange = ? WHERE id = ?");
$sthSetid->execute($newData, $refGetid[0]);
$sthSetid->finish; 
```

# php - PHP sleep() 导致高 CPU 使用率

> ID：12380529
> 
> 赞同：6
> 
> 时间：2012-09-12T02:38:09.027
> 
> 标签：php

我正在运行一个大部分时间都在休眠的 CLI 脚本。每隔 10 秒左右，脚本就会执行一些操作。问题是，脚本在睡眠时处于 94% 的 CPU 使用率。

我设置的方式是：

```
while(1){
    sleep(10);
    doStuff();
} 
```

虽然这按预期工作，但有一个明显的问题。在 C++/Java 中，我可以简单地设置一个计时器来消除循环问题。另外，我希望我不需要 cron 工作。

有没有其他方法可以做到这一点？

* * *

## 更新

显然我的原始脚本（相当大）从未*真正*进入睡眠模式，因此 while 循环运行时中断并烧毁了 CPU 周期。对于遇到相同问题的任何人，请确保您不是这种情况！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T02:42:09.737

过去，当我需要使 PHP 脚本成为守护进程时，我使用了此处概述的 PEAR 模块：http: [//kevin.vanzonneveld.net/techblog/article/create_daemons_in_php/](http://kevin.vanzonneveld.net/techblog/article/create_daemons_in_php/)

如果您不想使用 PEAR 模块，您可以检查它的源代码并执行类似的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:06:07.817

我的脚本设置如下：

```
define('THREAD_SLEEP', 10); // Sleep time
$sleep = false; // Skips the first sleep

while(1){
    if($sleep){
        sleep(THREAD_SLEEP);
    }

    $sleep = true; // By default, the script enters sleep mode each loop.

    if(doSomethingAndHaveMoreToDo()){
        $sleep = false; // If more stuff to do, remove sleep and keep doing it.
    }
} 
```

问题是，脚本一直设置`$sleep`为`false`，这意味着它永远不会进入睡眠模式并且几乎消耗了 100% 的 CPU。

# php - 谷歌地图 v3 商店定位器

> ID：12380531
> 
> 赞同：1
> 
> 时间：2012-09-12T02:38:23.453
> 
> 标签：php, xml, google-maps-api-3

我知道，已经有很多关于“商店定位器”的博客，但我找不到答案。[我使用了来自https://developers.google.com/maps/articles/phpsqlsearch_v3](https://developers.google.com/maps/articles/phpsqlsearch_v3)的教程。事情不正常，那么有人对那个教程让商店定位器工作有问题吗？我的问题是，没有生成有效的 xml 文件。我已经更改了 xml 输出，因为原来的那个根本不起作用。以下是这两个文件的代码：

## 标题##1。[http://umwelt-und-information.com/maps/ASPE_Adressen_kodieren_2a.php](http://umwelt-und-information.com/maps/ASPE_Adressen_kodieren_2a.php)

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<title>Example</title>
<script src="http://maps.googleapis.com/maps/api/js?sensor=false"
        type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
var map;
var markers = [];
var infoWindow;
var locationSelect;

function initialize() {
  map = new google.maps.Map(document.getElementById("map"), {
    center: new google.maps.LatLng(52, 8),
    zoom: 8,
    mapTypeId: 'roadmap',
    mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU}
  });
  infoWindow = new google.maps.InfoWindow();

locationSelect = document.getElementById("locationSelect");
  locationSelect.onchange = function() {
    var markerNum = locationSelect.options[locationSelect.selectedIndex].value;
    if (markerNum != "none"){
      google.maps.event.trigger(markers[markerNum], 'click');
    }
  };
}

function searchLocations() {
 var address = document.getElementById("addressInput").value;
 var geocoder = new google.maps.Geocoder();
 geocoder.geocode({address: address}, function(results, status) {
   if (status == google.maps.GeocoderStatus.OK) {
    searchLocationsNear(results[0].geometry.location);
   } else {
     alert(address + ' not found');
   }
 });
}

function clearLocations() {
 infoWindow.close();
 for (var i = 0; i < markers.length; i++) {
   markers[i].setMap(null);
 }
 markers.length = 0;

 locationSelect.innerHTML = "";
 var option = document.createElement("option");
 option.value = "none";
 option.innerHTML = "See all results:";
 locationSelect.appendChild(option);
}

function searchLocationsNear(center) {
 clearLocations();

 var radius = document.getElementById('radiusSelect').value;
 var searchUrl = 'ASPE_Adressen_kodieren_3a.php?lat=' + center.lat() + '&lng=' +  center.lng() + '&radius=' + radius;
 downloadUrl(searchUrl, function(data) {
   var xml = parseXml(data);
   var markerNodes = xml.documentElement.getElementsByTagName("marker");
   var bounds = new google.maps.LatLngBounds();
   for (var i = 0; i < markerNodes.length; i++) {
     var nachname = markerNodes[i].getAttribute("Nachname");
     var strasse = markerNodes[i].getAttribute("strasse");
     var distance = parseFloat(markerNodes[i].getAttribute("distance"));
     var latlng = new google.maps.LatLng(
          parseFloat(markerNodes[i].getAttribute("lat")),
          parseFloat(markerNodes[i].getAttribute("lng")));

     createOption(nachname, distance, i);
     createMarker(latlng, nachname, strasse);
     bounds.extend(latlng);
   }
   map.fitBounds(bounds);
   locationSelect.style.visibility = "visible";
   locationSelect.onchange = function() {
     var markerNum = locationSelect.options[locationSelect.selectedIndex].value;
     google.maps.event.trigger(markers[markerNum], 'click');
   };
  });
}

function createMarker(latlng, nachname, strasse) {
  var html = "<b>" + nachname + "</b> <br/>" + strasse;
  var marker = new google.maps.Marker({
    map: map,
    position: latlng
  });
  google.maps.event.addListener(marker, 'click', function() {
    infoWindow.setContent(html);
    infoWindow.open(map, marker);
  });
  markers.push(marker);
}

function createOption(name, distance, num) {
  var option = document.createElement("option");
  option.value = num;
  option.innerHTML = nachname + "(" + distance.toFixed(1) + ")";
  locationSelect.appendChild(option);
}

function downloadUrl(url, callback) {
  var request = window.ActiveXObject ?
      new ActiveXObject('Microsoft.XMLHTTP') :
      new XMLHttpRequest;

  request.onreadystatechange = function() {
    if (request.readyState == 4) {
      request.onreadystatechange = doNothing;
      callback(request.responseText, request.status);
    }
  };

  request.open('GET', url, true);
  request.send(null);
}

function parseXml(str) {
  if (window.ActiveXObject) {
    var doc = new ActiveXObject('Microsoft.XMLDOM');
    doc.loadXML(str);
    return doc;
  } else if (window.DOMParser) {
    return (new DOMParser).parseFromString(str, 'text/xml');
  }
}

function doNothing() {}

//]]>
</script>
</head>

<body style="margin:0px; padding:0px;" onload="initialize()">
<div>
 <input type="text" id="addressInput" size="10"/>
<select id="radiusSelect">
  <option value="25" selected>25mi</option>
  <option value="100">100mi</option>
  <option value="200">200mi</option>
</select>

<input type="button" onclick="searchLocations()" value="Search"/>
</div>
<div><select id="locationSelect" style="width:100%;visibility:hidden"></select></div>
<div id="map" style="width: 100%; height: 80%"></div>
</body>
</html> 
```

## 标题 ## 2\. [http://umwelt-und-information.com/maps/ASPE_Adressen_kodieren_3a.php](http://umwelt-und-information.com/maps/ASPE_Adressen_kodieren_3a.php)

```
<?php
error_reporting(E_ALL); 
require("dbpass.php");
if (PHP_VERSION>='5')
require_once('domxml-php4-to-php5.php');
// Get parameters from URL
$center_lat = $_GET['lat'];
$center_lng = $_GET['lng'];
$radius = $_GET['radius'];

// Start XML file, create parent node
$doc = domxml_new_doc("1.0");
$node = $doc->create_element("markers");
$parnode = $doc->append_child($node);

$connection=mysql_connect ($dbhost, $username, $password);
if (!$connection) {
die('Not connected : ' . mysql_error());
}

// Set the active mySQL database
$db_selected = mysql_select_db($database, $connection);
if (!$db_selected) {
die ('Can\'t use db : ' . mysql_error());
}

// Search the rows in the ASPE table
$query = sprintf("SELECT strasse, nachname, lat, lng, ( 3959 * acos( cos( radians('%s') ) * cos( radians( lat ) ) * cos( radians( lng ) - radians('%s') ) + sin( radians('%s') ) * sin( radians( lat ) ) ) ) AS distance FROM ASPE HAVING distance < '%s' ORDER BY distance LIMIT 0 , 20",
mysql_real_escape_string($center_lat),
mysql_real_escape_string($center_lng),
mysql_real_escape_string($center_lat),
mysql_real_escape_string($radius));
$result = mysql_query($query);

$result = mysql_query($query);
if (!$result) {
die("Invalid query: " . mysql_error());
}

//header("Content-type: text/xml");

// Iterate through the rows, adding XML nodes for each
while ($row = @mysql_fetch_assoc($result)){
$node = $dom->create_element("marker");
$newnode = $parnode->append_child($node);
$newnode->set_attribute("nachname", utf8_encode ($row['nachname']));
$newnode->set_attribute("strasse", utf8_encode ($row['strasse']));
$newnode->set_attribute("lat", $row['lat']);
$newnode->set_attribute("lng", $row['lng']);
$newnode->set_attribute("radius", $row['radius']);
}
//echo $dom->saveXML();

$xmlfile = $doc->dump_file("codierung.xml");
?> 
```

这可能是正确的，但是：它将我发送到 lat/lng 0.000000/0.000000（南太平洋），这可能意味着地理编码无法正常工作。但此外，不会在 xml 中填充任何数据集，即使在 URL 中添加 lat、lng 和半径（例如[http://umwelt-und-information.com/maps/ASPE_Adressen_kodieren_3a.php?lat=56.45&lng=6.45&radius =25](http://umwelt-und-information.com/maps/ASPE_Adressen_kodieren_3a.php?lat=56.45&lng=6.45&radius=25) )。

有人可以验证代码吗？或者任何人都可以向我展示一个使用该商店定位器的工作示例，如果可能的话，使用脚本代码？

提前谢谢了！:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-02T06:59:20.080

考虑使用国际字符格式 ASCII 而不是 header("Content-type: text/xml"); 把这个头（“内容类型：文本/xml字符utf-8”）；当您仅运行第二个文件并将值分配给 lat、lng 和 radius 时，将生成 xml 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T20:40:01.347

您的[网址](http://umwelt-und-information.com/maps/ASPE_Adressen_kodieren_3a.php?lat=56.45&lng=6.45&radius=25)显示无效查询：“字段列表”中的未知列“地址”如果所有节点都等同于字段名称，则应生成 XML ![桌子](../Images/f70939fe7075a094a34868e095fe773f.png)

您的表格是这样的还是您更改了字段名称？我有一个基于教程的[演示。](http://daviestrachan.zxq.net/maps/stationmap8.php)它基于英国（尝试伦敦），但如果尝试英国以外的地址（尝试巴黎），则默认安全。

如果没有找到记录，地图将默认为 0,0（中太平洋）。要默认到该位置，请使用以下代码。

```
if (mysql_num_rows($result)==0) {
    $node = $dom->createElement("marker");
    $newnode = $parnode->appendChild($node);
    $newnode->setAttribute("nachname", "No Records Found");
    $newnode->setAttribute("lat", $center_lat);
    $newnode->setAttribute("lng", $center_lng);
    }
else {
    Iterate through the rows, adding XML nodes for each
    while ($row = @mysql_fetch_assoc($result)){
    $node = $dom->create_element("marker");
    $newnode = $parnode->append_child($node);
    $newnode->set_attribute("nachname", utf8_encode ($row['nachname']));
    $newnode->set_attribute("strasse", utf8_encode ($row['strasse']));
    $newnode->set_attribute("lat", $row['lat']);    
    $newnode->set_attribute("lng", $row['lng']);
    $newnode->set_attribute("radius", $row['radius']);
   } 
```

# math - 在数学中解决这个问题？

> ID：12380532
> 
> 赞同：2
> 
> 时间：2012-09-12T02:38:27.150
> 
> 标签：math, wolfram-mathematica

我在 Mathematica 中有以下代码：

```
rbar = 0.006236
rt = r_bar
k = 0.95
sigmar = 0.002
betazr = -0.00014
sigmaz = 0.4
pi = 0.99
chi = 0.05
Cbar = -3.7

alpha1[n_] := alpha1[n] = alpha1[n - 1] + alpha2[n - 1]
alpha2[n_] := alpha2[n] = k (alpha2[n - 1])
sigma1sq[n_] := 
 sigma1sq[n] = sigma2sq[n - 1] + 2 sigma12[n - 1] + sigmaz^2
sigma12[n_] := 
 sigma12[n] = k (sigma12[n - 1]) + k (sigma2sq[n - 1]) + betazr
sigma2sq[n_] := sigma2sq[n] = (k^2) (sigma2sq[n - 1]) + sigmar^2
phi1[n_] := phi1[n] = phi1[n - 1] + phi2[n - 1] + (0.5) (sigmaz^2)
phi2[n_] := phi2[n] = k (phi2[n - 1]) + (1 - k) (rbar)
psi[n_] := psi[n] = phi1[n] - (0.5) (sigma1sq[n])

alpha1[0] = 0
alpha2[0] = 1
sigma1sq[0] = 0
sigma12[0] = 0
sigma2sq[0] = 0
phi1[0] = 0
phi2[0] = 0

B[h_, r_] := Exp[(-alpha1[h]) (r) - psi[h]]
Exp[Cbar - beta] Sum[(Pi^x) B[x, r], {x, 1, 1000}] 
```

我想知道是否有可能解决最后一行，使我有“r”作为“beta”的函数，满足

```
Exp[Cbar - beta] Sum[(Pi^x) B[x, r], {x, 1, 1000}] == 1 
```

因为最终，我需要在“beta”上集成一个函数 J[r]，所以如果我没有“r”作为“beta”的函数，我不知道如何进行 J[ r]。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T18:06:32.037

您不能将 r 作为 beta 的显式函数，但也许您可以做一些数值魔术。让我们看看函数在某个选定区间内的形式：

```
B[h_, r_] := Exp[(-alpha1[h]) (r) - psi[h]]
g0 = ContourPlot[ 1 == Exp[Cbar - beta] Sum[(Pi^x) B[x, r], {x, 1, 1000}], 
                  {r, 25, 60}, {beta, -10, 10}] 
```

![数学图形](../Images/d27236f063a2feb466c832c499a3f6f7.png)

它几乎就在那儿。

让我们得到这些点：

```
ll = FullForm[g0] /. Graphics[GraphicsComplex[x_, ___], ___] -> x; 
```

现在适合一条直线

```
line = Fit[ll[[1]], {1, r}, r]
Show[ListPlot[ll[[1]], PlotStyle -> Red], Plot[line, {r, 52.3, 53.5}]]

(* 1085.- 20.5337 r *) 
```

![数学图形](../Images/a6b38c2b1bc8908f7303d61eed21afd5.png)

所以，在我选择的时间间隔内，你可以使用

```
beta = 1085 - 20.5337 r 
```

# javascript - Jquery 表单验证插件 - 如何通过额外的步骤提交？

> ID：12380535
> 
> 赞同：1
> 
> 时间：2012-09-12T02:38:44.943
> 
> 标签：javascript, jquery

我目前正在使用[Jquery 表单验证插件](http://docs.jquery.com/Plugins/Validation)，当我按照网页上的表单提交说明进行操作时效果很好：

```
$("#form").validate({
    submitHandler: function(form) {
        form.submit();
    }
}); 
```

但是，现在我需要在用户单击提交按钮后添加一个弹出警告框，然后他们需要在提交表单之前单击弹出框上的一个按钮。

所以它需要是：

1.  填写表格，点击提交按钮
2.  弹出框显示一个按钮，单击该按钮
3.  表单提交

我已经尝试过了，但它没有触发响应：

```
$("#form").validate({
    submitHandler: function(form) { 
        $('.popup').show();
        $('.popup').find('.button').click(function(){
            form.submit();
        });         
     }      
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:59:18.837

发生的情况是，在验证期间会显示弹出对话框，如果验证成功，表单将在用户有机会看到弹出窗口之前提交。

有一个类似的问题可能是[JavaScript Submithandler Issue](https://stackoverflow.com/questions/7758280/javascript-submithandler-issue)

更理想的是，您需要更改表单，以便在您实际提交表单之前出现对话框。
IE

1.  填写表格
2.  单击显示弹出窗口的常规按钮
3.  提交表格

这样您就不会将验证和弹出窗口混合在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T12:54:20.800

好吧，我猜你真的不再需要这个了。那好吧。无论如何，我都会将其发布给后代。

**HTML**

```
<form id="form">
    <fieldset>
        <legend>Please provide the following...</legend>
        <p>
            <label for="cname">Name (required, at least 2 characters)</label>
            <input id="cname" name="name" minlength="2" type="text" required />
        </p>
        <p>
            <label for="cemail">E-Mail (required)</label>
            <input id="cemail" type="email" name="email" required />
        </p>
        <p>
            <label for="curl">URL (optional)</label>
            <input id="curl" type="url" name="url" />
        </p>
        <p>
            <label for="ccomment">Your comment (required)</label>
            <textarea id="ccomment" name="comment" required></textarea>
        </p>
        <p><input class="submit" type="submit" value="Submit"/></p>
    </fieldset>
</form>
<div id="Achtung">
    <h1>Achtung!</h1>
    <p>You are about to provide the indicated information. Please be sure!</p>
</div>​ 
```

**Javascript**

```
(function env($, log) {
    $(function load() {
        var $form = $("#form"),
            form = $form[0],
            $Achtung = $('#Achtung'),
            valid = {submitHandler: Achtung};

        $form.validate(valid);

        function Achtung() {
            var buttons = [
                    {text: "Ok", click: ok},
                    {text: "Cancel", click: close}
                ],
                dialog = {modal: true, buttons: buttons};

            $Achtung.dialog(dialog);

            function ok(event, ui) {
                close(event, ui, "Submit Ok'd and will continue.");
                form.submit();
            }

            function close(event, ui, msg) {
                log(msg || 'Submit canceled by user.');
                $Achtung.dialog("close");
            }
        }

        // Just so the form does not submit; comment these
        // lines to verify it works.
        form.submit = function blocker(event, ui) {
            return !log('The form.submit() was triggered and canceled.');
        };

        fill();
    });

    // Nothing to see here...
    function fill(){
        var $els = $(':input[type!=submit], textarea'),
            d = ['oh', 'a@b.cd', location.href, 'oh'],
            $el;

        $.each(d, function fill(i, v){
            $el = $($els[i]);
            $el.is('input') ? $el.val(v) : $el.text(v);
        });
    }

})(jQuery, function z(){return !console.log.apply(console, arguments)});​ 
```

[http://jsfiddle.net/userdude/jULBx/](http://jsfiddle.net/userdude/jULBx/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T05:44:05.233

感谢你的帮助。我最终做的是`?submitted=true`在表单操作中添加一个参数，所以它仍然是同一个页面，但在 url 中有一个参数。然后检查 url 看是否有这样的参数并相应地执行弹出窗口。不确定它是否愚蠢，但它是我能想到的最简单的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T03:13:16.690

使用“开”命令

[http://api.jquery.com/on/](http://api.jquery.com/on/)

发生的情况是您的 DOM 元素是在文档加载后创建或可见的。这将为出现的任何新 DOM 附加一个事件处理程序。

就像是：

```
$('body').on('click','.button',function(){
    form.submit();
}); 
```

这是一篇很好的文章，解释了 ON 的作用：

[http://www.jquery4u.com/jquery-functions/on-vs-live-review/](http://www.jquery4u.com/jquery-functions/on-vs-live-review/)

# javascript - 如何将运动物理函数缩放到每秒帧数（在游戏引擎中）？

> ID：12380536
> 
> 赞同：2
> 
> 时间：2012-09-12T02:38:57.163
> 
> 标签：javascript, physics, game-engine, game-physics

我正在使用 Javascript (HTML5 Canvas) 开发游戏。我实现了一个简单的算法，它允许一个对象跟随另一个混合了基本物理的对象（一个力矢量以正确的方向驱动对象，速度叠加动量，但被恒定的阻力减慢）。目前，我将其设置为鼠标 (x, y) 坐标后的矩形。这是代码：

```
// rectangle x, y position
var x = 400; // starting x position
var y = 250; // starting y position
var FPS = 60; // frames per second of the screen
// physics variables:
var velX = 0; // initial velocity at 0 (not moving)
var velY = 0; // not moving
var drag = 0.92; // drag force reduces velocity by 8% per frame
var force = 0.35; // overall force applied to move the rectangle
var angle = 0; // angle in which to move

// called every frame (at 60 frames per second):
function update(){
    // calculate distance between mouse and rectangle
    var dx = mouseX - x;
    var dy = mouseY - y;
    // calculate angle between mouse and rectangle
    var angle = Math.atan(dy/dx);
    if(dx < 0)
        angle += Math.PI;
    else if(dy < 0)
        angle += 2*Math.PI;

    // calculate the force (on or off, depending on user input)
    var curForce;
    if(keys[32]) // SPACE bar
        curForce = force; // if pressed, use 0.35 as force
    else
        curForce = 0; // otherwise, force is 0

    // increment velocty by the force, and scaled by drag for x and y
    velX += curForce * Math.cos(angle);
    velX *= drag;
    velY += curForce * Math.sin(angle);
    velY *= drag;

    // update x and y by their velocities
    x += velX;
    y += velY; 
```

这在每秒 60 帧的情况下运行良好。现在，棘手的部分：我的问题是，如果我将其更改为不同的帧速率（例如，30 FPS），我如何修改力和拖动值以保持运动恒定？

也就是说，现在我的矩形（其位置由 x 和 y 变量决定）以大约每秒 4 个像素的最大速度移动，并在大约 1 秒内加速到其最大速度。但是，如果我改变帧速率，它会移动得更慢（例如 30 FPS 加速到每帧只有 2 个像素）。

那么，我如何创建一个以 FPS（每秒帧数）为输入的方程，并吐出正确的“拖动”和“力”值，它们的行为方式与实时相同？

我知道这是一个沉重的问题，但也许有游戏设计经验或编程物理知识的人可以提供帮助。感谢你付出的努力。

jsFiddle：http: [//jsfiddle.net/BadDB](http://jsfiddle.net/BadDB)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:00:04.007

我会介绍一个实际的时间度量。然后，您应该修改您的方程，使其成为实际经过时间和所需最大速度的函数。使用实际经过时间的好处是，即使在（由于负载或你有什么）不以编程的 FPS 运行的系统上，这些方程也能很好地工作。

顺便说一句 - 你应该使用`Math.atan2(dy, dx)`而不是`Math.atan(dy/dx)`. （想想当 时会发生什么`dx == 0`。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:24:42.870

理想情况下，您应该将时间范围视为自上一帧以来经过的时间，然后根据实际增量计算比例因子，并将其用于基于时间的计算。

考虑一下理想情况下，您的游戏以 60fps 运行。还要考虑到，你的游戏很少会在每一个单帧游戏中精确地以 1000ms/60f 运行。

所以你的理想是`1000/60`。你的实际情况是`current_timestamp - previous_timestamp`. 您的时间范围的规模将是`actual/ideal`。

现在，您只需要使用您的规模来转换您对时间敏感的值。

任何时间函数都可以使用其“每帧理想值”（`magnitude = 8; current_magnitude = magnitude * scale; vec.x *= current_magnitude; vec.y *= current_magnitude; vec.z *= current_magnitude;`）。

您只需要小心了解何时乘以，何时不乘。如果计算是基于时间的，则进行预乘。如果不是，那就不要。

如果您的游戏以 15fps 运行，您的时间尺度将是 4 倍，对吗？这不应该影响任何东西的力量。例如，它不会影响汽车的扭矩——发动机正在产生的被压抑的能量。它***会***影响的是在确切的时间跨度内发生了多少加速度（线性或其他）。

如果汽车应该加速 0.5m/s^2 或任何您决定的速度，那么您只需要查看该加速度的一部分（添加到当前速度上），它适用于秒的特定部分你现在在里面。然后在下一次更新中，汽车应该以你设定的速度行驶，乘以你计算的时间尺度，即当前帧和前一帧之间的差异。

旋转应该以相同的方式计算。

这使您可以将不一致的帧速率与实际动作区分开来，因为您始终基于百分比而不是硬数字（涉及时间）进行操作。

这也允许像子弹时间这样的事情很容易愚蠢地完成。***为所有内容***添加子弹时间因素，除了瞄准。或者，如果您想制作忍者反射，请对玩家应用不同的时间尺度，而不是敌人。

对于冻结时间，您有两种选择：

1.  将所有内容设置为 0 并忘记之前的值（让所有内容从 0 开始累积动量，在恢复时）
2.  将所有内容设置为 0，但保留之前所有值的“框架”。之后忘记 0，但将下一个时间跨度视为自暂停发生以来仅过去了 1 帧。

当您谈论要做什么时`drag`-您自己说过：`drag`在`constant`您的模拟中。不管你说的时间跨度有多长或多短，阻力在那个时间跨度内对一个对象的影响与它在任何其他时间段内对任何对象的影响是一致的时间跨度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T03:01:48.640

将力加倍并保持阻力不变。

**编辑：**

数学：

运动可以完全用两个参数来描述：初始加速度和终速度。如果这两个看起来正确，则动作看起来正确。

对于初始加速度，阻力（这种阻力）无关紧要。由于`force`是加速度，我们所要做的就是将它与一秒钟内的帧数相加，以获得一秒钟的加速度：

力[30] * 30 = 力[60] * 60
力[30] = 力[60] * 60/30 = 2.0 * 力[60] = 2.0 (0.35) = 0.7

最终速度发生在力和阻力平衡时。

V[项]* 阻力 = 力
阻力 = 力 / V[项]

我们想缩放 V [term]，但我们也在缩放`force`，所以缩放项取消；`drag`无需更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T16:40:38.123

**当您根据时间**进行积分时，力的积分是速度，速度的积分是位置。如果你让你的时间步长等于两帧之间的时间，那么如果你有一个碰撞后检测器，你的子弹物理就可以工作。

两帧之间的时间与 FPS 成反比。

FPS = 总帧数 / 总时间

时间步长=( 1.0/(float)FPS 秒数)*K。K 是一个常数，可以使您的时间步长足够小，从而使您的物理场足够稳定。

# vhdl - VHDL中的共享变量

> ID：12380538
> 
> 赞同：0
> 
> 时间：2012-09-12T02:39:34.523
> 
> 标签：vhdl

我是 vhdl 的新手（使用 ISE 项目导航器），我在合成这个程序（sequence.vhd）时遇到了一点问题：

```
LIBRARY ieee ;
USE ieee.std_logic_1164.all;

PACKAGE mypack IS
VARIABLE counter: STD_LOGIC := '0' ;
VARIABLE simultaneous : STD_LOGIC := '0' ;
END PACKAGE mypack;

LIBRARY ieee ;
USE ieee.std_logic_1164.all;
use IEEE.STD_LOGIC_ARITH.ALL;

use IEEE.STD_LOGIC_UNSIGNED.ALL;

--library work;

USE WORK.mypack.ALL;

ENTITY secuencia IS

PORT(
    polh            : IN    STD_LOGIC; --uno
    polv            : IN    STD_LOGIC; --cero
    seq            : OUT   std_logic_vector(8 downto 0):= (others => 'Z')
);

END secuencia;

ARCHITECTURE registro OF secuencia IS

SIGNAL stack : std_logic_vector(1000 downto 0);

BEGIN
PROCESS(polh, polv)
 BEGIN

        IF (polh'event) and (polh='1') and (polv='0')THEN
            stack(counter) <= '1';
            counter := counter +1;

        ELSE IF (polv'event) and (polv='1') and (polh='0')THEN
            stack(counter) <= '0';
            counter := counter +1;
        ELSE IF (polh'event) and (polh='1') and (polv'event) and 
(polv='1') THEN
            simultaneous := simultaneous+1;

        END IF;

END PROCESS;

END registro; 
```

这些是前两个错误：

> 第 5 行。这里只能声明 SHARED 变量。
> 
> 第 6 行。这里只能声明 SHARED 变量。

所以问题出在我声明的变量上......目的是在架构中使用它们。我确定是一个新手问题，但我看不到解决方案。多谢！

PD：我无法正确格式化代码，抱歉

* * *

更新：

感谢@Martin Thompson 的帮助。我按照你的建议做了，现在我遇到了不同的类型或问题。我一直在寻找它，但它似乎有广泛的因果关系。这是代码

```
ENTITY secuencia IS
PORT(
    polh            : IN    STD_LOGIC; --uno
    polv            : IN    STD_LOGIC; --cero
    Pedido      : IN    STD_LOGIC; 
    DatoListo   : OUT    STD_LOGIC; 
    seq            : OUT   std_logic_vector(1000 downto 0):= (others =>   'Z')

);
END secuencia;

ARCHITECTURE registro OF secuencia IS

SIGNAL stack : std_logic_vector(1000 downto 0);

BEGIN

PROCESS(polh, polv, Pedido) 

variable counteria : natural;
 variable Listo : integer;
 variable simultaneo : integer;
 BEGIN
    IF (counteria < 1000) THEN

       IF (polh'event AND polh='1' AND polv='0') THEN
        --IF (polh='1' AND polv='0') THEN
            stack(counteria) <= '1';
            counteria := counteria +1;

         ELSIF (polv'event AND polv='1' AND polh='0') THEN
         --ELSIF (polv='1' AND polh='0') THEN    
                stack(counteria) <= '0';
                counteria := counteria +1;                 

        ELSIF (polh'event AND polh='1' AND polv'event AND polv='1') THEN
           simultaneo := simultaneo+1;

END IF;

    ELSIF (counteria = 1000)THEN
      DatoListo <='1';
          IF (Pedido='1')THEN
               Seq  <= stack;            
           counteria := 0;
       DatoListo <='0';
            END IF;                                 
    END IF;

END PROCESS;
END registro; 
```

它给出了这个错误

> 第 25 行：信号堆栈> 无法合成，同步描述错误。当前软件版本不支持您用于描述同步元素（寄存器、内存等）的描述样式。

* * *

更新 2：

我做了一些更改并评论了程序的一部分，它综合了：

```
PROCESS(polh, polv, Pedido) 

     variable counteria : natural := 0;
     variable Listo : integer;
     variable simultaneo : integer;
 BEGIN
    IF (counteria < 1000) THEN
       IF rising_edge(polh) THEN
            IF (polv='0') THEN
               stack(counteria) <= '1';     
               counteria := counteria + 1;
            END IF;
--     ELSIF rising_edge(polv)  THEN
--          IF (polh='0') THEN
--             stack(counteria) <= '0';
--             counteria := counteria +1;                  
--          END IF;
--     END IF;

       ELSIF (counteria = 1000)THEN
           DatoListo <='1';
              IF (Pedido='1')THEN
                  Seq   <= stack;            
           counteria := 0;
           DatoListo <='0';
       ENDIF;                                           

    END IF;

END PROCESS;
END registro; 
```

这个合成。但是，当我取消注释该`ELSIF rising_edge(polv) THEN`部分时，它会出现同样的问题：`Signal stack<counteria<9:0>> cannot be synthesized...`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T15:48:25.943

暂时不要使用共享变量。你需要先了解一些基础知识。

如果您需要将`counter`out 的值“发送”到其他地方，请添加一个项目`port`并将其写入那里。

如果（看起来）您只想将它​​用作存储，请在`process`您使用它的内部声明它。

最后，如果你希望合成这个，你需要有一个时钟信号通过`port`，你需要做一个标准的时钟过程：

如果要查找 polh 和 polv 输入何时更改，则必须存储先前的值并检查它是否与当前值不同。

```
process (clk)
    variable vpol_last : std_logic;
begin
  if rising_edge(clk) then
       if vpol_last /= vpol then -- it's changed
       -- do something
       end if;
       vpol_last := vpol; -- store current value for next time.
       -- etc.
  end if;
end process; 
```

# embedded - 何时为嵌入式系统使用窗口看门狗

> ID：12380542
> 
> 赞同：3
> 
> 时间：2012-09-12T02:40:06.100
> 
> 标签：embedded, watchdog, windowed

这个帖子不是问怎么用，而是什么时候用。

有很多关于窗口看门狗 (WW) 的文档，并且大多数微控制器已经包含它。每个供应商都表示 WW 是用于安全应用程序的，但没有人对此主题进行更多说明。

我想指出具体的例子，但这些例子可能比“汽车制动系统”多一点。

我们都知道，WW 必须既不早也不晚地喂食，但这种情况如何有助于提高安全性呢？

谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T13:44:18.227

看门狗的总体意义是确保固件按预期执行。理论上，如果您的固件可以定期启动看门狗，那么它负责的其他功能也会发生。

从系统设计来看，它们是故障保护的最后一层。它基本上是在说“我们不知道系统在做什么，因为它无法启动看门狗。所以，重置设备并希望问题消失。”

它们可以保护您免受意外的无限循环、堆栈损坏、RAM 位旋转等。

Windowed Watchdog 是比单面 Watchdog 更好的解决方案，因为窗口可以防止更多事情...例如，对于单面，如果您陷入的循环包括看门狗踢，那么您永远不会知道你有问题。对于带窗口的看门狗，由于可能踢得太快，您有更好的重置机会......

所以，回答你的问题。您可以在任何时候使用 Windowed Watchdog 来合理地确定固件正在执行它应该做的事情，或者如果不是，则回退到安全状态。它们通常专注于安全系统，但所有嵌入式设备都可以从它们的使用中受益。（例如，房屋恒温器不被视为安全关键系统，但是如果它完全锁定并需要有人取出电池才能重新启动它，那将是一件烦人的事情。）

# cakephp - 如何大写身份验证组件中的登录字段 - cakephp

> ID：12380543
> 
> 赞同：0
> 
> 时间：2012-09-12T02:40:14.120
> 
> 标签：cakephp

我想在登录操作之前将我在身份验证组件中使用的用户名和密码字段转换为大写。我试图设置

```
text-transform:uppercase; 
```

在我的 CSS 中，用于输入，它起作用了。但是大写的信息不会进入数据库。如果我用大写锁定字符串，字符串只会大写。有人可以给我一个例子（新手）吗？

谢谢！

编辑：

这是我的登录操作：

```
function login() {

if (!empty($this->data) && $this->Auth->user()) {
    $this->User->id = $this->Auth->user('id');
    $this->User->saveField('last_login', date('Y-m-d H:i:s'));
    $this->redirect($this->Auth->redirect());
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T13:30:31.373

您可以在服务器端 php 中大写，如 @thecodeparadox 所示，或者您可以使用客户端 javascript 或如果您使用 jQuery，请将其添加到您的事件中。

html/javascript：

```
<form>
  <input type="text" name="username" onchange="this.value = this.value.toUpperCase();" />
  <input type="password" name="password" onchange="this.value = this.value.toUpperCase();" />
</form>​ 
```

演示：http: [//jsfiddle.net/85HEy/2/](http://jsfiddle.net/85HEy/2/)

或 html/jQuery:

```
<form>
  <input type="text" name="username" />
  <input type="password" name="password" />
</form>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script>
<script>
  $(document).ready(function() {
    $("input[name='username'], input[name='password']").change(function() {
      $(this).val($(this).val().toUpperCase());
    });
  });
</script>​ 
```

演示：http: [//jsfiddle.net/T9XbP/](http://jsfiddle.net/T9XbP/)

# mysql - 索引上的内连接 - 未知列

> ID：12380550
> 
> 赞同：0
> 
> 时间：2012-09-12T02:41:00.670
> 
> 标签：mysql, indexing, inner-join

```
SELECT T1_C1,...,T1_C100, T2_C1,T2_C2 FROM T1 INNER JOIN T2 on T1.index_T1 = T2.index_T2 
```

如上所述，我正在尝试从我使用下面的代码创建的索引上的两个表进行内部连接

```
CREATE INDEX index_T1 on T1 (T1_PID)
CREATE INDEX index_T2 on T2 (T2_PID) 
```

我不断收到未知列“T1.indexT1”。如果我删除表前缀，我会得到相同的结果。我正在努力寻找正确语法的工作示例。我需要先对桌子进行特殊处理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:43:52.013

您不需要明确地按名称提及索引。

索引名称只是您维护索引的标识符（例如删除它）。而mysql会自动使用索引，根据哪些列参与查询，哪些列以及如何被索引覆盖。

所以只需指定列名：

```
INNER JOIN T2 on T1.t1_pid = T2.t2_pid 
```

PS：对于这个特定的查询，您很可能不需要`T1`表索引

# maven - Maven - 解压缩文件名太长

> ID：12380551
> 
> 赞同：5
> 
> 时间：2012-09-12T02:41:20.840
> 
> 标签：maven, zip, maven-3, filenames

我在安装 maven 3 时遇到了麻烦。

我有 3.0.4 源 zip。但是，我无法提取它，或者在 zip 中的多个 jar 上出现文件名太长的错误。我正在运行 Windows 7。

我在其他任何地方都找不到关于此的任何信息，并且我开始怀疑我是否只是不知道如何首先安装 maven，而不是 zip 有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T20:13:52.953

我刚刚使用 Windows 7 遇到了同样的问题，并试图从他们的官方网站解压缩源 zip。为了解决这个问题，我只是按照 ptyx 的评论。而不是使用 C:/Program Files/Apache Software Foundation （就像他们的网站建议的那样）我只是使用了 C:/Maven

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-07T15:10:56.187

您可以通过将存档复制到其中一个分区的根目录中来“修复”此问题，然后将其解压缩到同一位置的文件夹中。

# sql - SQL 更新查询产品购物车

> ID：12380552
> 
> 赞同：1
> 
> 时间：2012-09-12T02:41:41.993
> 
> 标签：sql, sql-server

```
ID ProductId MemberId SessionId CreatedOn 数量
62 1 2 2012-09-11 1
63 2 2 2012-09-11 1
64 1 0 agzdeoqubwokfme05wwmne55 2012-09-11 1
65 3 0 agzdeoqubwokfme05wwmne55 2012-09-11 1

```

我有上表，我需要做一个程序。我的场景是没有登录将商品添加到购物车，当您登录时合并所有商品。

我将在程序@MemberId（登录会员ID）中传递两个参数，@SessionID

我想要如下所示的表格。

```
ID ProductId MemberId SessionId CreatedOn 数量
62 1 2 2012-09-11 2
63 2 2 2012-09-11 1
65 3 2 2012-09-11 1

```

一种产品与另一种产品合并，数量为 2。那一行应该消失了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:54:35.933

假设 SQL SERVER 2005 或以上

```
CREATE TABLE #T (ID INT , ProductId INT,  MemberId INT,   SessionId VARCHAR(100),  CreatedOn DATETIME,   Quantity INT)
INSERT INTO #T SELECT 62,1 ,2 ,' ','2012-09-11',1
INSERT INTO #T SELECT 63,  2,2, ' ','2012-09-11',1
INSERT INTO #T SELECT 64,  1,0,'agzdeoqubwokfme05wwmne55','2012-09-11',1
INSERT INTO #T SELECT 65,  3,0,'agzdeoqubwokfme05wwmne55','2012-09-11',1

;With CTE AS 
(SELECT 
    ID
    ,ProductId
    ,MemberId = MAX(MemberId) OVER(PARTITION BY ProductID ORDER bY(SELECT 1))
    ,SessionID
    ,CreatedOn = CONVERT(VARCHAR(10),MAX(CreatedOn) OVER(PARTITION BY ProductID ORDER bY(SELECT 1)),20)
    ,Quantity = SUM(Quantity) OVER(PARTITION BY ProductID ORDER bY(SELECT 1))
    ,Rn = ROW_NUMBER() OVER(PARTITION BY ProductID ORDER bY(SELECT 1))
FROM #T)

SELECT ID,ProductId,MemberId,SessionID,CreatedOn,Quantity FROM CTE WHERE Rn = 1

DROP TABLE #T 
```

将给出结果为

```
ID  ProductId   MemberId    SessionID              CreatedOn    Quantity
62  1            2                                  2012-09-11    2
63  2            2                                  2012-09-11    1
65  3            0          agzdeoqubwokfme05wwmne55 2012-09-11   1 
```

最后，如果您想更新表格，请点击此处

```
UPDATE #T
SET 
    #T.ID = c.ID
    ,#T.ProductId =c.ProductId
    ,#T.MemberId = c.MemberId
    ,#T.SessionID = c.SessionID
    ,#T.CreatedOn = c.CreatedOn
    ,#T.Quantity = c.Quantity
FROM #T
INNER JOIN CTE c
ON #T.ID = c.ID
WHERE c.Rn = 1 
```

结果是

```
ID  ProductId   MemberId    SessionId               CreatedOn   Quantity
62  1              2                                 2012-09-11   2
63  2              2                                 2012-09-11   1
64  1              0    agzdeoqubwokfme05wwmne5      2012-09-11   1
65  3              0    agzdeoqubwokfme05wwmne55     2012-09-11   1 
```

完整的查询是

```
;With CTE AS 
(SELECT 
    ID
    ,ProductId
    ,MemberId = MAX(MemberId) OVER(PARTITION BY ProductID ORDER bY(SELECT 1))
    ,SessionID
    ,CreatedOn = CONVERT(VARCHAR(10),MAX(CreatedOn) OVER(PARTITION BY ProductID ORDER bY(SELECT 1)),20)
    ,Quantity = SUM(Quantity) OVER(PARTITION BY ProductID ORDER bY(SELECT 1))
    ,Rn = ROW_NUMBER() OVER(PARTITION BY ProductID ORDER bY(SELECT 1))
FROM #T)

UPDATE #T
SET 
    #T.ID = c.ID
    ,#T.ProductId =c.ProductId
    ,#T.MemberId = c.MemberId
    ,#T.SessionID = c.SessionID
    ,#T.CreatedOn = CONVERT(VARCHAR(10),c.CreatedOn,20)
    ,#T.Quantity = c.Quantity
FROM #T
INNER JOIN CTE c
ON #T.ID = c.ID
WHERE c.Rn = 1

SELECT * FROM #T

DROP TABLE #T 
```

**对于任何版本的 SQL**

```
UPDATE #T
SET 
    #T.ID = c.ID
    ,#T.ProductId =c.ProductId
    ,#T.MemberId = c.MemberId
    ,#T.SessionID = c.SessionID
    ,#T.CreatedOn = c.CreatedOn
    ,#T.Quantity = c.Quantity
FROM #T
INNER JOIN (SELECT t.ID,t.ProductID,t.MemberId,t.SessionId,t.CreatedOn,x.Quantity
            FROM #T t 
            JOIN (
                    SELECT
                            ID = MIN(ID)
                            ,ProductID 
                            ,MemberId = MAX(MemberId)       
                            ,CreatedOn = MAX(CreatedOn)
                            ,Quantity = SUM(Quantity) 
                    FROM #T 
                    GROUP BY ProductID
                    )X
            ON t.ID =X.ID) c
ON #T.ID = c.ID

SELECT * FROM #T
DROP TABLE #T 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T02:45:01.573

```
SELECT ProductID, 
       max(MemberId), 
       max(CreatedOn),
       sum(Quantity) 
FROM theTable 
WHERE SessionID=<id> or MemberID=<id>
GROUP BY ProductID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T04:04:33.803

更新可能不是最佳解决方案，最好删除所有记录并插入新记录。

无论如何，如果你想更新然后删除额外的，你需要做这样的事情。

假设`ID`是这里的唯一键。这是完整的逻辑，请仔细阅读

```
DECLARE @Temp1 TABLE 
(
--datafields same AS your table

)

DECLARE @Temp2 TABLE 
(
--datafields same AS your table
)

INSERT INTO @Temp1
SELECT ID,
       ProductID, 
       MemberId,
       SessionId, 
       CreatedOn,
       Quantity 
FROM theTable 
WHERE SessionID= @SessionID  or MemberID= @MemberID 

UPDATE a
SET SessionID =  @SessionID  , MemberID= @MemberID 
FROM @Temp1 AS a
--WHERE  SessionID= @SessionID  OR MemberID= @MemberID 

INSERT INTO @Temp2
SELECT MAX(ID),
       ProductID, 
       max(MemberId),
       MAX(SessionId),
       max(CreatedOn),
       sum(Quantity) 
FROM @Temp1
GROUP BY ProductID 

UPDATE a
SET a.MemberId = b.MemberId ,a.SessionId=b.SessionId ,a.CreatedOn=b.CreatedOn,a.Quantity=b.Quantity 
FROM YourTable AS a
INNER JOIN @Temp2 AS b
ON a.ID=b.ID      

DELETE  FROM YourTable
WHERE   ID IN ( SELECT  ID
                    FROM    @Temp1 AS ta
                    WHERE   NOT EXISTS ( SELECT 1
                                         FROM   @Temp2 AS tb
                                         WHERE  ta.ID = tb.ID ) ) 
```

# c - 如何计算二进制数的C中的最大块长度

> ID：12380554
> 
> 赞同：0
> 
> 时间：2012-09-12T02:41:58.877
> 
> 标签：c, binary, block

我想重申一个事实，即我不是要求直接为我的问题提供代码，而是想要有关如何达到该解决方案的信息。

我之前问过一个关于在二进制代码中计算特定整数的问题。现在我想问一下如何计算二进制代码中的最大块长度。

老实说，我只想知道从哪里开始以及通过编写代码来计算输入整数二进制表示的“最大块长度”的确切含义。

例如：输入 456 输出：111001000 1 的数量：4 最大块长度：？

如果您需要查看我来自哪里，这是我到目前为止的参考代码。

```
#include <stdio.h>

int main(void)
{
  int integer; // number to be entered by user
  int i, b, n;
  unsigned int ones;
  printf("Please type in a decimal integer\n"); // prompt
  fflush(stdout);
  scanf("%d", &integer); // read an integer

  if(integer < 0)
  {
    printf("Input value is negative!"); // if integer is less than
    fflush(stdout);

    return;                  // zero, print statement
  }
  else{
    printf("Binary Representation:\n", integer);
    fflush(stdout);} //if integer is greater than zero, print statement

    for(i = 31; i >= 0; --i) //code to convert inputted integer to binary form
    {
      b = integer >> i;
      if(b&1){
        printf("1");
        fflush(stdout);
      }
      else{
        printf("0");
        fflush(stdout);
      }
    }
  printf("\n");
  fflush(stdout);
  ones = 0; //empty value to store how many 1's are in binary code
  while(integer)  //while loop to count number of 1's within binary code
  {
    ++ones;
    integer &= integer - 1;
  }
  printf("Number of 1's in Binary Representation: %d\n", ones); // prints number
  fflush(stdout);                                           //of ones in binary code
  printf("Maximum Block Length: \n");
  fflush(stdout);
  printf("\n");
  fflush(stdout);
  return 0;

}//end function main 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:06:11.920

假设您正在寻找最长的 1。

这是 32 位的操作方法。您应该能够将此想法扩展到任意长的比特流。

```
int maxRunLen(uint32_t num) {
    int count = 0; 
    int maxCount = 0;
    while(num) {
       if(num & 1) count++;
       else {
           if( count > maxCount) maxCount = count;
           count = 0;
       }
       num >>=1;
    }
    if( count > maxCount) maxCount = count;
    return maxCount;
} 
```

这个想法是测试每个位以确定它是否为 1。如果为 1，则增加计数。否则，它是运行的结束，在这种情况下，检查前一次运行是否比任何前一次最大运行时间长并重置计数。

测试一点的方法是使用掩码。在上面的例子中，最低位的测试由

```
num & 1 
```

要测试数字中的下一位，您将所有位向右移动 1 位，这称为移位。在这种情况下更明确地说是逻辑右移 (>>)。示例位模式 0110 变为 0011。这是在上面的示例中完成的：

```
num >>= 1; 
```

这相当于：

```
num = num >> 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:33:48.480

尝试这个：

```
int max_run_of_ones (unsigned x)
{
  int max_run = 0;
  int cur_run;

  while (x != 0) {
    // skip right-most zeros                                                    
    while ((x & 1) == 0) {
      x >>= 1;
    }
    // skip and measure right-most run of ones                                  
    cur_run = 0;
    while ((x & 1) == 1) {
      cur_run++;
      x >>= 1;
    }
    if (cur_run > max_run) max_run = cur_run;
  }
  return max_run;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T02:55:37.307

通过查看您的代码，您似乎想知道设置的位数。这是一个猜测...

这要归功于 Ratko Tomic。这家伙在位操作方面非常出色。

```
int countBits（整数值）
{
    诠释 n = 0;

    如果（值）
    {
        做
        {
            n++;
        } while( 0 != (value = value & (value - 1) ) );
    }
    返回（n）；
}

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T03:05:05.727

这应该在python中解决它，使用字符串操作......

这样做的主要目的是帮助其他人了解您要完成的工作。

```
import re    

number = 500
binary_repr = bin(number)[2:]             # '111110100'
blocks = re.split(r'0+', binary_repr)     # ['11111', '1', '']
block_lengths = [len(x) for x in blocks]  # [5, 1, 0]
maximum_block_length = max(block_lengths) # 5 
```

# c++ - 幻灯片演示中的 Qt Widget 绘画

> ID：12380556
> 
> 赞同：2
> 
> 时间：2012-09-12T02:42:48.110
> 
> 标签：c++, qt

我正在尝试从显示幻灯片的 Qt fluidLauncher 演示中运行稍作修改的代码。代码粘贴在下面。处理paintEvent时，屏幕上会显示一个黑色矩形，因为导入的图像大小为0。

单步执行 Qt creator 中的代码，当前图像路径在监视窗口中为 '"/home/tim/Pictures/HPIM0406.JPG"'。路径正确，包括大小写和 / 分隔符。“幻灯片”变量始终显示 <不可访问>。

在代码中的 slideSize = slide.size() 处，幻灯片大小从 (8481696,0) 变为 (0,0)。看起来虽然没有抛出错误，但 QPixmap slide (currentImagePath); 没有检索图像。

```
void SlideShow::paintEvent(QPaintEvent *event)
{
 QPainter painter(this);
 QString currentImagePath;

 painter.setRenderHint(QPainter::Antialiasing, false);

 if (d->imagePaths.size() > 0) {
    currentImagePath = d->imagePaths[d->currentSlide];
     QPixmap slide( currentImagePath );
     QSize slideSize = slide.size();
     QSize scaledSize = QSize(qMin(slideSize.width(), size().width()),
         qMin(slideSize.height(), size().height()));
     if (slideSize != scaledSize)
         slide = slide.scaled(scaledSize, Qt::KeepAspectRatio);

     QRect pixmapRect(qMax( (size().width() - slide.width())/2, 0),
                      qMax( (size().height() - slide.height())/2, 0),
                      slide.width(),
                      slide.height());

     if (pixmapRect.top() > 0) {
         // Fill in top & bottom rectangles:
         painter.fillRect(0, 0, size().width(), pixmapRect.top(), Qt::black);
         painter.fillRect(0, pixmapRect.bottom(), size().width(), size().height(), Qt::black);
     }

     if (pixmapRect.left() > 0) {
         // Fill in left & right rectangles:
         painter.fillRect(0, 0, pixmapRect.left(), size().height(), Qt::black);
         painter.fillRect(pixmapRect.right(), 0, size().width(), size().height(), Qt::black);
     }

     painter.drawPixmap(pixmapRect, slide);

 } else
     painter.fillRect(event->rect(), Qt::black); 
```

}

我晚上大部分时间都在为这个问题苦苦挣扎。谁能建议我可以添加用于调试的其他代码或让我知道此代码可能有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T07:30:34.980

我有一些解决您问题的想法：

1.  您应该添加资源文件 (.qrc) 并将图像粘贴到其中。使用语法从资源文件加载像素图。

2.  尝试粘贴分隔线的方式`home/tim/Pictures/HPIM0406.JPG`或`/home/tim/Pictures/HPIM0406.JPG`或`home\\tim\\Pictures\\HPIM0406.JPG`。一些评论：你写了 '"/home/tim/Pictures/HPIM0406.JPG"', '' - 在 QPixmap 构造函数中不使用单引号。我不明白，你只是在这里或你的代码中写的。

我希望它可以帮助你:)

# php - 从朋友和所有者的帖子中选择 INNNER JOIN

> ID：12380557
> 
> 赞同：1
> 
> 时间：2012-09-12T02:42:50.497
> 
> 标签：php, mysql, sql

我有 3 个表： user_info ，friend_match，posts

用户信息：帐户**ID** | **用户名**

朋友匹配：**友谊**ID | **朋友**1（第一个帐户ID）| **friend2** (account_id of 2nd) 好友匹配包含 2 1 和 1 2、1 3 和 3 1。

帖子：**post_id** | **海报ID** | **post_message** | **发布日期**

我如何从用户的朋友和他自己的朋友那里获得帖子？

我已经尝试过了，但它似乎效率低下，而且我遇到了分页问题，​​因为用户可能或多或少地发布了分页。

```
SELECT * FROM 
                    (
                    SELECT p.post_id, p.post_message, UNIX_TIMESTAMP(p.date_posted) as date_posted, u.username FROM posts p
                    INNER JOIN friend_match fm
                        ON p.poster_id = fm.friend1
                    INNER JOIN user_info u
                        ON u.account_id = p.poster_id
                    WHERE fm.friend2 = $sessionid

UNION ALL

                    SELECT p.post_id, p.post_message, UNIX_TIMESTAMP(p.date_posted) as date_posted, u.username FROM posts p
                    INNER JOIN user_info u
                        ON u.account_id = p.poster_id
                    WHERE p.poster_id = $sessionid
                    )z
                    ORDER BY post_id DESC LIMIT $page,$limit"; 
```

我希望的最终结果包含从最新到最旧的帖子，其中朋友的帖子与会话持有者的帖子以一种可靠的可分页方式混合在一起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:02:48.380

不是一个完整的答案，但也许使用这样的[子选择](http://dev.mysql.com/doc/refman/5.0/en/any-in-some-subqueries.html)：

```
SELECT * FROM posts p
  inner join user_info u ON u.account_id = p.poster_id
WHERE p.poster_id = $sessionid or p.poster_id IN 
(SELECT f.friend1 FROM friend_match f
 WHERE f.friend2 = $sessionid)
ORDER BY post_id DESC LIMIT $page, $limit; 
```

# php - 是否可以在 php 中跨会话保存 mysql 对象？

> ID：12380558
> 
> 赞同：1
> 
> 时间：2012-09-12T02:43:15.210
> 
> 标签：php, mysql, session

例如，在这种情况下，“视图”计数在会话期间明显增加，但 mysqli 对象未维护并且不能在会话期间重用（如果页面被刷新或其他）。_SESSION 全局只能保存简单类型吗？还有什么可以限制这一点？编辑：我的希望是提高性能。因此，如果有另一种方法可以实现这一目标，我很高兴知道。

```
<?php
session_start();

if(isset($_SESSION['db']))
{
    $mysqli = $_SESSION['db'];
    $_SESSION['views']=$_SESSION['views']+1;
}
else
{
    $mysqli = new mysqli(...);
    $_SESSION['db'] = $mysqli;
    $_SESSION['views']=1;
}

echo "Views=". $_SESSION['views'];    

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T02:47:58.403

不，没有任何 php 资源是可序列化的。`mysqli`所以每次都需要实例化对象。

> 编辑：我的希望是提高性能。

第一个性能优化规则是：第一次测量 - 第二次优化。如果不进行分析（测量），世界上没有人可以说出性能问题是什么。

那么，您的应用程序运行缓慢吗？那么，衡量是什么让它如此缓慢并优化那个特定的地方。我可以向你保证，这不是与 mysql 的连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:52:28.727

你不能直接这样做。但是你可以使用魔法方法：[`__sleep()`和`__wakeup()`](http://www.php.net/manual/en/language.oop5.magic.php#object.wakeup).

```
class Connection {
    protected $link;
    private $server, $username, $password, $db;

    public function __construct($server, $username, $password, $db) {
        $this->server = $server;
        $this->username = $username;
        $this->password = $password;
        $this->db = $db;
        $this->connect();
    }

    private function connect() {
        $this->link = mysql_connect($this->server, $this->username, $this->password);
        mysql_select_db($this->db, $this->link);
    }

    public function __sleep() {
        return array('server', 'username', 'password', 'db');
    }

    public function __wakeup() {
        $this->connect();
    }
} 
```

我认为没有必要在会话中这样做。

# javascript - 如何从 MP3 文件中获取幅度数据？

> ID：12380562
> 
> 赞同：5
> 
> 时间：2012-09-12T02:44:45.443
> 
> 标签：javascript, html, mp3, signal-processing, amplitude

我试图使用 html5 和 javascript 来获取 mp3 的振幅（和其他组件）。任何有帮助的图书馆？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-15T11:00:46.663

首先需要将问题划分为实时回放和非线性幅度等接入。

对于实时播放，您可以使用 Web Audio API

[https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html)

节拍示例

[https://beatdetektor.svn.sourceforge.net/svnroot/beatdetektor/trunk/core/js/beatdetektor.js](https://beatdetektor.svn.sourceforge.net/svnroot/beatdetektor/trunk/core/js/beatdetektor.js)

对于非线性、非实时的访问，有两种方式

如果您允许服务器端处理，您可以编写将数据发送到 Echo Nest 服务器并通过 Echo Next Remix API 检索信息的代理

[使用 Python 从 MP3 音乐中提取节拍](https://stackoverflow.com/q/6203007/315168)

如果您想完全避免服务器端处理，您需要用纯 Javascript 解码 MP3，以便以非实时方式访问原始音频数据

[https://github.com/devongovett/mp3.js](https://github.com/devongovett/mp3.js)

然后你需要对原始音频数据应用必要的过滤器来提取你需要的信息。这是信号处理的问题，与 Javascript 编程没有直接关系。如果您更仔细地指定您需要什么样的数据，人们可能会帮助您使用相关的 Javascript 库，例如用于快速傅立叶变换的库。

# ios - iOS 应用程序批准：Apple 是否检查二进制文件中的特定字符串？

> ID：12380564
> 
> 赞同：0
> 
> 时间：2012-09-12T02:44:48.857
> 
> 标签：ios

这可能是个愚蠢的问题。我有一个应用程序，其中有一堆 URL 以字符串形式存储在 Constants.h 文件中。其中一些指向可以在应用程序之外购买内容的网站。Apple 为此拒绝了向 App Store 提交二进制文件。所有指向外部站点的链接都已从应用程序中删除，但 URL 仍存储在 Constants.h 文件中，它们不再在任何地方使用。该应用程序由于同样的原因再次被拒绝（即使该应用程序没有链接到外部站点）。

我只是想弄清楚Apple是否有可能或可能正在解析我的二进制文件并标记未使用的字符串URL？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T02:56:35.707

很有可能，是的。

App Store 审查指南 11.13 规定：

> 链接到外部购买或订阅机制的应用程序将被拒绝

可以理解，“链接到外部机制”在这里是模棱两可的，可能意味着“包含可以购买应用程序内容的任何 URL”，但我不能肯定这就是那个意思。

不过，为了确保您避开该指南，我建议在您的 Constants.h 文件中添加一个预处理器指令，以便购买 URL 甚至不存在于应用程序包中：

```
#ifdef PURCHASE_URLS
static NSString* externalPurchaseURL = @"http://mywebsite.com/purchase_content";
#endif 
```

（请注意，您不应`Constants.h`在 Copy Headers 构建步骤中使用）

然后，您可以通过在项目的构建设置中添加`PURCHASE_URLS`“预处理器宏”（实际上，可能是“预编译头文件中未使用的预处理器宏”，因为您没有在`_Prefix.pch`文件中执行此操作）来添加调试构建的 URL，但是在您提交给 App Store 的版本中省略它们，不要为 Distribution 构建定义它们。

# actionscript-3 - FP 11 在 Chrome 中以 file:/// 运行时破坏了我的 flex 应用程序

> ID：12380568
> 
> 赞同：0
> 
> 时间：2012-09-12T02:45:09.030
> 
> 标签：actionscript-3, apache-flex, flash

我有一个 flex/AS3 应用程序，它可以在本地文件系统 (file:///C:...html) 中完美运行，或者通过 localhost 服务器访问，或者通过远程服务器访问。它可以在 flex 3 或 flex 4 下编译。

也就是说，这一切都适用于 FP 10 及之前的版本。但是，我刚刚发现它在 FP 11（但仅限于 Chrome）下被破坏，因为它只会在现在从 Web 服务器（本地或远程）访问时运行，并且不会在本地文件系统中运行。（仍然在 FF 上运行）。

如果我在 Flex 3 下编译，我可以让它在 Chrome 中的 FP 11 上运行，只要不对包装器进行任何 ExternalInterface.calls，如果它检测到 swf 是通过 file:/// 加载的。但是，如果在 Flex 4 下编译，如果通过 file:/// 加载它根本不会在 Chrome 中执行（显然甚至无法进入它）。我该如何解决这个问题。

我在此处发布此内容的原因是，我在谷歌上没有发现任何与 FP 11 中的这种变化显然仅影响 Chrome 相关的信息。重复一遍，在 FP 10 及之前的版本下一切正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:54:35.010

刚刚让它与 FP 11.4 r402（最新版本）一起工作。我之前安装的是 FP 11.3.31.232，那是一个不起作用的。很明显，这是一个非常当前的问题，只是碰巧偶然发现了它。以前会尝试不同的 Flash 播放器，除非你去 Flash 下载页面，它说因为你使用的是 Chrome，它已经内置了。所以现在必须找出如何在 Chrome 插件中禁用它，以便我可以安装最新的。不知道那个错误版本 FP 11.3.31.232 的日期是什么，但如果我找到它会报告的。

# google-dfp - DFP：获取当前的点击后到达网址

> ID：12380572
> 
> 赞同：0
> 
> 时间：2012-09-12T02:45:53.587
> 
> 标签：google-dfp

我正在为多个网站设置 DFP，我们有一组订单项，并且对于其中的每个广告素材，当前点击都将转到`example.com`（我们自己的`.com`网站），但由于我们正在运行多个 TLD，我们也希望点击通过 URL 进行相应的更改。例如，当广告在 中显示时`.jp`，点击应该转到`.jp`。

在 DFP API 参考中，有一个函数可以更改点击后到达网址： http: [//support.google.com/dfp_premium/bin/answer.py ?hl=en&answer=1650154&expand=adslot_details#setClickUrl](http://support.google.com/dfp_premium/bin/answer.py?hl=en&answer=1650154&expand=adslot_details#setClickUrl)

但是为了改变我们的点击 URL，我们还需要知道当前的 URL 是什么。示例案例：我们需要`http://www.example.com/products/1`从 DFP获取`adSlot`才能将其更改为`http://www.example.jp/products/1`.

我使用 chrome web JS 控制台进行了反复试验，并`getClickUrl()`在类中找到了一个函数`adSlot`，但它一直返回空字符串，例如：

```
googletag.defineSlot("/1234/Test_300x250", [300, 250], 'div-1').getClickUrl();
googletag.defineSlot("/1234/Test_300x250", [300, 250], 'div-1').addService(googletag.pubads()).getClickUrl(); 
```

有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T20:44:31.957

如果您可以控制广告素材，我认为通过传递自定义变量会容易得多。您使用**setTargeting**方法来传递自定义变量。因此，您展示广告的客户端代码如下所示：

```
googletag.defineSlot("/1234/Test_300x250", [300, 250], 'div-1').setTargeting('region','jp'); 
```

然后在您的 HTML 广告素材中使用模式宏来替换部分点击后到达网址。

```
<a href="http://www.example.%%PATTERN:region%%">
<img src="http://www.example.%%PATTERN:region%%/image.jpeg">
</a> 
```

DFP 将用您通过**setTargeting**传递的任何值替换宏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T08:28:30.683

我还没有找到一种超级简单的方法来做到这一点——但这是可能的。

基本上，您可以覆盖 DFP 中的内部函数并通过进入 iframe 的 DOM 来捕获广告（和 URL）的内容。

这是一个应该提醒广告 URL 的示例（我只在 chrome 中对此进行了测试，因此它可能需要调整才能在多个浏览器中工作）

```
<html>
<head>
    <title>DFP test</title>

    <script type='text/javascript'>
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
        (function() {
            var gads = document.createElement('script');
            gads.async = true;
            gads.type = 'text/javascript';
            var useSSL = 'https:' == document.location.protocol;
            gads.src = (useSSL ? 'https:' : 'http:') +
            '//www.googletagservices.com/tag/js/gpt.js';
            var node = document.getElementsByTagName('script')[0];
            node.parentNode.insertBefore(gads, node);
        })();
    </script>

    <script type="text/javascript">
        googletag.cmd.push(function() {
            var slot1 = googletag.defineSlot('/12345678/Test_300x250', [300, 250], 'div-gpt-ad-1340819095858-0').addService(googletag.pubads());

            slot1.oldRenderEnded = slot1.renderEnded;
            slot1.renderEnded = function(){
                alert(document.getElementById('div-gpt-ad-1340819095858-0').getElementsByTagName('iframe')[0].contentWindow.document.getElementsByTagName('a')[0].href.replace(/^.*&adurl=/,''));
                slot1.oldRenderEnded();
            };

            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>

</head>
<body>

    <div id='div-gpt-ad-1340819095858-0' style='width:266px; height:115px;'>
        <script type='text/javascript'>
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1340819095858-0');
            });
        </script>
    </div>

</body>
</html> 
```

如果您使用的是 jQuery，那么使用以下内容会更好：

```
$(adUnit).find('iframe:first').contents().find('a') 
```

任何问题让我知道。

# mysql - 如何查看mysql更新插入添加日志

> ID：12380576
> 
> 赞同：0
> 
> 时间：2012-09-12T02:47:06.673
> 
> 标签：mysql

有一个表，我想听更新，添加，删除操作，但由于性能原因我不想使用触发器，所以我想知道是否有mysql更新日志，我可以获取更改的行ID . 提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:57:18.850

使用 Binlog 应该是更好的方法。

这是 MySQL 5.5 的文档：http: [//dev.mysql.com/doc/refman/5.5/en/mysqlbinlog.html](http://dev.mysql.com/doc/refman/5.5/en/mysqlbinlog.html)

# xml - xsi:schemaLocation 和 pom.xml

> ID：12380577
> 
> 赞同：3
> 
> 时间：2012-09-12T02:47:11.373
> 
> 标签：xml, maven, xsd, xml-namespaces

我正在通过maven pom.xml，它以...开头

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"> 
```

1.  为什么我需要在这里使用 xsi:schemaLocation？我理解这是一种发现具有目标命名空间的 XSD 的方法。但是当我使用**xmlns="http://www.w3.org/2001/XMLSchema"**时，我不需要提及 schemaLocation？

2.  当我尝试用其他东西（比如 xsitest）覆盖前缀 xsi 时，编辑器显示它无效。它是一个应该使用的标准前缀关键字吗？我认为前缀可以是任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T23:13:11.217

你问“为什么我需要使用 xsi:schemaLocation ...？”

你？您是否需要使用`xsi:schemaLocation`取决于您正在使用的验证器和其他模式感知处理器：xsi:schemaLocation 是将命名空间绑定到特定模式的一种方式，但不是唯一方式。

如果您更改绑定 XSI 名称空间的前缀，那么您期望文档应该保持有效是正确的。如果您的软件向您显示错误，则可能是软件中存在错误，或者您没有正确重新绑定前缀。

# python - 将 CSV 文件中特定列中的值相加（在 Sage Notebook 中）

> ID：12380578
> 
> 赞同：0
> 
> 时间：2012-09-12T02:47:21.793
> 
> 标签：python, csv, sage

我有一个 csv 文件，其中包含 4 个不同列中的大量值。使用 python，有没有办法将一个特定列中的值相加（比如第 1 列中的值）。我想找到一列中所有值的平均值

```
values_list = []

for row in b:
   values_list.append(row[1]) 
```

我可以使用这种方法隔离特定列，但是有没有办法修改它以便能够添加值并找到特定列中的平均值

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T04:53:28.630

没有示例 csv 文件，我使用了以下内容：

```
1,2,3,4,5
1,2,3,4,5
1,2,3,4,5
1,2,3,4,5
0,1,2,3,4
2,3,4,5,6 
```

此 python 脚本将 csv 加载到内存中，对其进行解析，收集第*n*列的值，并计算总和和平均值。

```
#!/bin/env python

col = 2

values = []
with open('csv.csv', 'r') as csv:
    for line in csv.readlines():
        elements = line.strip().split(',')
        values.append(int(elements[col]))

csum = sum(values)
cavg = sum(values)/len(values)
print("Sum of column %d: %f" % (col, csum))
print("Avg of column %d: %f" % (col, cavg)) 
```

例如

```
$ python parsecsv.py
Sum of column 0: 6.000000
Avg of column 0: 1.000000

$ python parsecsv.py
Sum of column 2: 18.000000
Avg of column 2: 3.000000 
```

如果文件太大而无法一次全部加载到内存中，您可以`readlines()`使用`csv.readline()`

# paypal - 贝宝 IPN 状态

> ID：12380580
> 
> 赞同：0
> 
> 时间：2012-09-12T02:47:57.643
> 
> 标签：paypal

我正在使用 PayPal IPN 并在我的付款状态 = 反转时遇到问题。

Paypal 是否可以将第一次点击的状态 = 反转发送到 IPN？

我不应该先得到状态=完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:52:50.683

如果它是电子支票，那么它可能会在支票完成之前被撤销……在 PayPal 清除 ACH 之前，你不会得到这些钱。

# java - compareTo() 方法 java 的行为很奇怪

> ID：12380583
> 
> 赞同：2
> 
> 时间：2012-09-12T02:48:11.853
> 
> 标签：java, object, comparison, compareto

嗨，我无法让它工作我在我的对象比较中遇到错误......我怎么能将英寸转换为字符串（我从未使用过与字符串以外的任何东西进行比较），或者使用比较运算符来比较整数,

```
Object comparison = this.inches.compareTo(obj.inches); 
```

到目前为止，这是我的代码

```
import java.io.*;
import java.util.*;
import java.lang.Integer;
import java.lang.reflect.Array;

 public class Distance implements Comparable<Distance> {

private static final String HashCodeUtil = null;
private int feet;
private int inches; 
private final int DEFAULT_FT = 1;
private final int DEFAULT_IN = 1;

public Distance(){
    feet = DEFAULT_FT;
    inches = DEFAULT_IN;
}
public Distance(int ft, int in){
    feet = ft;
    inches = in;
}

public void setFeet(int ft){
    try {
        if(ft<0){
            throw new CustomException("Distance is not negative");

        }

    }
    catch(CustomException c){
        System.err.println(c);
        feet =ft;
    }
}

public int getFeet(){
    return feet;
}

public void setInches(int in){

    try
    {
        if (in<0)
            throw new CustomException("Distance is not negative");
        //inches = in;
    }
    catch(CustomException c)
    {
        System.err.println(c);
        inches = in;
    }

}

public int getInches(){
    return inches;
}

public String toString (){
    return "<" + feet + ":" + inches + ">";

}

public Distance add(Distance m){
    Distance n = new Distance();
    n.inches = this.inches + m.inches;
    n.feet = this.feet + m.feet;

    while(n.inches>12){
        n.inches = n.inches - 12;
        n.feet++;
    }

    return n;
}

public Distance subtract(Distance f){
    Distance m = new Distance();
    m.inches = this.inches - f.inches;
    m.feet = this.feet - f.feet;
    while(m.inches<0){
        m.inches = m.inches - 12;
        feet--;

    }

    return m;
}

@Override
public int compareTo(Distance obj) {
    // TODO Auto-generated method stub

    final int BEFORE = -1;
    final int EQUAL = 0;
    final int AFTER = 1;

    if (this == obj) return EQUAL;

    if(this.DEFAULT_IN < obj.DEFAULT_FT) return BEFORE;
    if(this.DEFAULT_IN > obj.DEFAULT_FT) return AFTER;

    Object comparison = this.inches.compareTo(obj.inches);
    if (this.inches == obj.inches) return compareTo(null);

    assert this.equals(obj) : "compareTo inconsistent with equals";

    return EQUAL;

}

@Override public boolean equals( Object obj){
    if (obj != null) return false;
    if (!(obj intanceof Distance)) return false;

    Distance that = (Distance)obj;

            ( this.feet == that.feet &&
            this.inches == that.inches);
            return true;
            else
            return false;
}

 @Override public int hashCode(int, int) {
    int result = HashCodeUtil.inches;
    result = HashCodeUtil.hash(result, inches );
    result = HashCodeUtil.hash(result, feet);
    ruturn result;
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T02:51:48.473

您正在比较对象引用。尝试比较对象值；覆盖`hashCode()`或比较字段值。

```
@Override
public int compareTo(Distance obj) {
    ....
    if (this == obj) return EQUAL; <--- This
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T02:58:27.600

有了这条线：

```
Object comparison = this.inches.compareTo(obj.inches); 
```

您正在尝试取消引用`int`原始类型。编译器应该给你一个错误：你只能`Objects`使用点取消引用`.`

我不确定你想让这段`compareTo`代码做什么，但在这一点上，比较原始类型，你应该使用`==`：

```
 if (this.inches == obj.inches) return compareTo(null); 
```

请注意，在这一行中：`if (this == obj) return EQUAL;`您正在比较对象*引用*，这可能是您想要的，也可能不是。由于您的类没有覆盖该`equals`方法，因此此比较等效于`this.equals(obj)`.

# java - 如何用 Java 构建一个简单的点对点系统？

> ID：12380587
> 
> 赞同：6
> 
> 时间：2012-09-12T02:49:52.213
> 
> 标签：java, sockets, network-programming

我正在做一个大学项目。我需要一些关于 Java 套接字编程中对等程序的示例程序。人们到处都在说要在客户端程序中添加一个服务器套接字。

具有服务器套接字和客户端套接字的单个程序会做还是我必须创建两个程序，一个启动系统，另一个对等程序运行三次才能解决问题？

我知道如何为客户端服务器模型做一个套接字程序并且清楚这个概念。但是创建点对点架构听起来对我来说很复杂。

我也提到了[这个线程](https://stackoverflow.com/questions/4920527/developing-peer-to-peer-application-in-java)。

第二个评论的人说“为了使 peer2peer 应用程序每个客户端也打开服务器套接字。当客户端 A 希望连接到客户端 B 时，它只是连接到它的套接字”。

需要更多示例并解释对等 Java 套接字程序的工作原理。我不希望任何像 jxta 这样的外部 API 来完成这项任务。我需要清楚地了解它是如何工作的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-12T03:28:39.787

> 具有服务器套接字和客户端套接字的单个程序可以吗

是的。事实上，这是实现 P2P 应用程序的正常方式。

> 但是创建点对点架构听起来对我来说很复杂。

没有什么特别复杂的。对等程序实际上只是一个可以完成*任*一角色的客户端/服务器程序。并且“架构”这个词在这里并没有真正增加太多，因为没有通用的“一刀切”对等架构这样的东西。“点对点”这个标签实际上是关于系统的一般特征，而不是关于任何特定的架构、框架或 API。（虽然框架和 API 确实存在......）

但是，我遇到了这个[介绍](http://cs.berry.edu/~nhamid/p2p/)，其中包含一些 Java 示例代码。我不知道这是否从套接字级别开始解决问题，但老实说，如果您知道如何开发套接字级别的客户端/服务器并且您了解并发编程，那么将两者放在一起是直接的编程给你简单的P2P。

# solr - Solr 中的词性标注器映射

> ID：12380589
> 
> 赞同：2
> 
> 时间：2012-09-12T02:50:11.413
> 
> 标签：solr, lucene, nlp

我目前正在使用 Apache Solr 构建搜索引擎。Solr 中的查询是 field:value 格式。现在我想使用词性标注器来分隔主语、动词和谓语，并搜索每个字段中的值。例如，如果我输入“谁喜欢星巴克”，那么我需要一些代码来给我“q=subject:*&verb=likes&object=starbucks”。有没有可以处理这项工作的图书馆？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T07:19:37.220

我认为有几个人为此使用了[UIMA](http://uima.apache.org/sandbox.html)，请参阅[solr wiki](http://wiki.apache.org/solr/SolrUIMA)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T19:32:02.897

有许多 POS 标记器。这是另一个关于此的 StackOverflow 帖子：[什么是用于词性标记的好的 Java 库？](https://stackoverflow.com/questions/2293636/what-is-a-good-java-library-for-parts-of-speech-tagging)

# android - OpenCV Android - 将 MatOfPoint 转换为 Mat

> ID：12380594
> 
> 赞同：2
> 
> 时间：2012-09-12T02:52:21.333
> 
> 标签：android, opencv

我想将使用 Imgproc.findContours 找到的 MatOfPoint 转换为（二进制）Mat。我知道有一种方法可以进行反向转换（只需使用构造函数 MatOfPoint(Mat m)），但是有没有内置的方法来进行这种转换？如果不是，那么逐个元素转换的正确方法是什么。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T09:08:55.167

您不需要任何转换器。MatOfPoint 是 Mat 的子类：

来自 OpenCV 源代码：

```
public class MatOfPoint extends Mat 
```

# asp.net - 如果发现错误的路由，抛出 404 错误页面？

> ID：12380599
> 
> 赞同：0
> 
> 时间：2012-09-12T02:53:01.303
> 
> 标签：asp.net, webforms, url-routing

我使用 ASP.Net URL Routing 进行 SEO，当我遇到一个错误的路由名称（即 /Games/{RouteName}）时，我想将它传递给我的 404 页面进行处理。我检查数据库以确保 {RouteName} 是游戏的有效名称。如果 RouteName 是有效的，我想继续正常处理，但是如果数据库返回并且没有找到对应的 RouteName，我想知道服务器如何表现得好像输入了一个真正错误的 URL。我怎样才能最好地做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:40:51.313

我建议在您的逻辑中抛出一个 404 错误，以确定它是无效的，例如

```
if (!<validRouteName>) {
   return new HttpStatusCodeResult(404, "Game not found.");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T00:18:05.443

在 IIS 中做一些乱七八糟的事情我已经弄清楚了。正如 endyourif 建议的那样，我需要在后面的代码中抛出 404 响应，这是由 Response.StatusCode = 404; 完成的。我还必须为 404 配置 IIS 的错误页面以指向我的 404.aspx 页面。

# asp.net - Asp.net MVC3 - 将数据导出到 Excel

> ID：12380600
> 
> 赞同：0
> 
> 时间：2012-09-12T02:53:03.617
> 
> 标签：asp.net, asp.net-mvc-3, excel

根据客户要求，我们需要将一些数据库表导出到 Excel 工作表。最直接的方法是什么？我们所做的任何处理都将来自服务器，并最好作为文件发送到浏览器。

注意：我使用 LinqToExcel 来读取/解析 excel 文件，我希望能找到一个同样好的工具来*写入*excel 文件。

ASP.NET 4，MVC3

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:02:16.837

我使用[EPPlus 取得](http://epplus.codeplex.com/)了很好的效果。从来没有遇到过问题，API 是明智的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:57:11.590

它必须是excel格式还是可以是csv文件？

我写了一个控制器动作，它写出一个 csv 文件，然后在 excel 中加载和处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T09:12:30.680

我总是使用代码项目中的[EPPlus](http://epplus.codeplex.com/)来创建 excel 文件。这有更多的功能

# c# - EventLogReader 和 EventRecord：消息在哪里？

> ID：12380601
> 
> 赞同：15
> 
> 时间：2012-09-12T02:53:04.297
> 
> 标签：c#, event-log

我想在远程计算机上查询应用程序事件日志，我使用了`EventLogReader`而不是`EventLog`因为使用`EventLog`. 但是，即使它使用 更快地找到事件`EventLogReader`，我也无法弄清楚我需要的信息在这个对象上的位置......尤其是消息。

```
 public static void Load()
    {
        string query = "*[System/Provider/@Name=\"SQLSERVERAGENT\"]";

        EventLogQuery elq = new EventLogQuery("Application", PathType.LogName, query);
        elq.Session = new EventLogSession("x.x.x.x");
        EventLogReader elr = new EventLogReader(elq);

        _logEntries = new List<SqlEventEntry>();

        EventRecord entry;
        while ((entry = elr.ReadEvent()) != null)
        {
            var Message = entry.???
            // I want process the message in the event here,
            // but I can't find a property anywhere that contains the message??
        }
    } 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-12T03:02:41.937

叹息......这是`FormatDescription()`方法。我没有看到它，因为我只看属性。

# database - processmaker：连接到数据库

> ID：12380602
> 
> 赞同：0
> 
> 时间：2012-09-12T02:53:27.220
> 
> 标签：database

根据标题，我想将流程制造商连接到数据库。

我使用MySql作为引擎，服务器是localhost，端口是3306。提交配置后，processmaker做4个步骤来测试连接。我已经通过了前 2 步，但第 3 步和第 4 步都失败了。加工者说：

> MySql 连接被拒绝！

我按照[http://wiki.processmaker.com/index.php/Database_Connections](http://wiki.processmaker.com/index.php/Database_Connections)的说明进行操作， 但它仍然无法正常工作。

感谢您的回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T21:56:21.370

当您安装 ProcessMaker 时，您使用哪个数据库作为默认数据库？我问过您这个问题，因为 ProcessMaker 默认带有 Apache 和 Mysql，所以这一步可能没有用。

问候，

[加工制造者](/questions/tagged/processmaker "显示标记为“流程制造者”的问题")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T14:13:13.593

你确认你的信息是正确的？？？

检查您的 mysql 用户名和密码，并尝试使用 127.0.0.1 作为服务器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-26T08:08:58.083

确保您使用的是 processmaker 支持的正确版本的 mysql。

# visual-studio - 禁用警告 c4702 似乎不适用于 VS 2012

> ID：12380603
> 
> 赞同：15
> 
> 时间：2012-09-12T02:53:28.507
> 
> 标签：visual-studio, warnings, visual-studio-2012, compiler-warnings, suppress-warnings

我有一些用于测试的代码，我预先添加了其余代码，因此在测试中永远无法达到其余部分。由于我设置了警告级别 4，这会导致 c4702: unreachable-code 警告

我尝试像这样禁用：

```
//do something
    return 0;

    /*-------------------------------------------------------------------------*/

#pragma warning(disable: 4702)
    //real code 
```

但编译器仍在呻吟。而且因为我已将每个警告都视为错误，所以这不会编译...

我正在使用 Visual Studio 2012 高级版...

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-12T04:15:23.213

您可能只需要在受影响的函数开始之前而不是在其中放置编译指示。

从[MSDN 文档](http://msdn.microsoft.com/en-us/library/2c8f766e%28v=vs.110%29.aspx)：

> 对于 4700-4999 范围内的警告编号（与代码生成相关的警告编号），当编译器遇到函数的左大括号时有效的警告状态将对函数的其余部分有效。使用函数中的warning pragma 来改变一个数字大于4699 的警告的状态只会在函数结束后生效。

例如：

```
#pragma warning(push)
#pragma warning(disable: 4702)
bool Do() {
  return true;
  return true;  // No warning generated
#pragma warning(pop)
}

bool DoDo() {
  return true;
  return true;  // Generates C4702
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-26T14:37:55.167

这来自 MSDN 文档[https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2012/2c8f766e(v=vs.110)?redirectedfrom=MSDN](https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2012/2c8f766e(v=vs.110)?redirectedfrom=MSDN)也适用于 Visual Studio 2013（ Express 和 Pro 版本）。

文本：

警告 2012 年 7 月 11 日 3 分钟阅读 启用对编译器警告消息行为的选择性修改。

```
#pragma warning( warning-specifier : warning-number-list [; warning-specifier : warning-number-list...] ) 
#pragma warning( push[ ,n ] ) 
#pragma warning( pop ) 
```

备注 以下警告说明符参数可用。

表 1 警告说明符

意义

**1、2、3、4**

将给定级别应用于指定的警告。这也会打开默认关闭的指定警告。

**默认**

将警告行为重置为其默认值。这也会打开默认关闭的指定警告。警告将在其默认的记录级别生成。

有关详细信息，请参阅默认关闭的编译器警告。

**禁用**

不要发出指定的警告消息。

**错误**

将指定的警告报告为错误。

**一次**

仅显示一次指定的消息。

**压制**

将 pragma 的当前状态压入堆栈，禁用下一行的指定警告，然后弹出警告堆栈，以便重置 pragma 状态。

以下代码语句说明了一个warning-number-list 参数可以包含多个警告号，并且可以在同一个pragma 指令中指定多个警告说明符参数。

```
#pragma warning( disable : 4507 34; once : 4385; error : 164 ) 
```

这在功能上等同于以下代码。

```
// Disable warning messages 4507 and 4034.
#pragma warning( disable : 4507 34 )

// Issue warning 4385 only once.
#pragma warning( once : 4385 )

// Report warning 4164 as an error.
#pragma warning( error : 164 ) 
```

编译器将 4000 添加到 0 到 999 之间的任何警告编号。

对于 4700-4999 范围内的警告编号，即与代码生成相关的警告编号，当编译器遇到函数的左大括号时有效的警告状态将对函数的其余部分有效。使用函数中的warning pragma 来改变一个数字大于4699 的警告的状态只会在函数结束后生效。以下示例显示了警告 pragma 的正确放置以禁用代码生成警告消息，然后将其恢复。

```
// pragma_warning.cpp
// compile with: /W1
#pragma warning(disable:4700)
void Test() {
   int x;
   int y = x;   // no C4700 here
   #pragma warning(default:4700)   // C4700 enabled after Test ends
}

int main() {
   int x;
   int y = x;   // C4700
} 
```

请注意，在整个函数体中，warning pragma 的最后一个设置将对整个函数有效。

Push 和 Pop 警告编译指示还支持以下语法。

```
#pragma warning( push [ ,n ] )

#pragma warning( pop ) 
```

其中 n 表示警告级别（1 到 4）。

pragma warning( push ) 存储每个警告的当前警告状态。pragma warning(push, n) 存储每个警告的当前状态并将全局警告级别设置为 n。

pragma warning( pop ) 弹出最后一个压入堆栈的警告状态。您对 push 和 pop 之间的警告状态所做的任何更改都将撤消。考虑这个例子：

```
#pragma warning( push )
#pragma warning( disable : 4705 )
#pragma warning( disable : 4706 )
#pragma warning( disable : 4707 )
// Some code
#pragma warning( pop ) 
```

在此代码的末尾，pop 将每个警告（包括 4705、4706 和 4707）的状态恢复到代码开头的状态。

当您编写头文件时，您可以使用 push 和 pop 来保证用户所做的警告状态更改不会妨碍头文件的正确编译。在标题的开头使用 push 并在结尾使用 pop 。例如，如果您的头文件在警告级别 4 处无法完全编译，则以下代码会将警告级别更改为 3，然后在头文件末尾恢复原始警告级别。

```
#pragma warning( push, 3 )
// Declarations/definitions
#pragma warning( pop ) 
```

有关帮助您抑制警告的编译器选项的详细信息，请参阅 /FI 和 /w。

另请参阅参考 Pragma 指令和 __Pragma 关键字

# php - if($_FILES['files']['name']!="") 如果有文件则运行，如果没有文件则不运行头痛

> ID：12380612
> 
> 赞同：1
> 
> 时间：2012-09-12T02:55:40.333
> 
> 标签：php, file-upload, if-statement

我的其他线程与特定代码没有任何运气，所以如果可以的话，我想问一下人们将如何让它工作。

我有一个页面，我的客户在其中编辑属性列表上显示的属性的详细信息，说他们编辑文本并且不向该属性添加任何图像。

HTML 表单工作正常，我只是在看 php.ini 文件。

例子：

```
If files selected then run this script as an include
If no files selected then exit 
```

像这样的东西...

```
if($_FILES['files']['name']!="")
 {
 Do this
 }
  else
{
exit();
} 
```

我很想弄清楚这一点，所以任何帮助或建议都会很棒。我在这些变体之上尝试了一些变体和变体，但到目前为止似乎没有任何效果。

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T02:57:29.653

使用`isset()`或`empty()`构造。（有关更多信息，请阅读 PHP 文档）

```
if(!empty($_FILES['files']['name']))
 {
  //
 } 
```

# c++ - 构造函数的问题

> ID：12380615
> 
> 赞同：0
> 
> 时间：2012-09-12T02:56:21.053
> 
> 标签：c++

目前我有一个带有构造函数的井字游戏“tttBoard”

```
 tttBoard::tttBoard() {
    isX = true;
    for (int x = 0; x < 3; ++x) {
        for (int y = 0; y < 3; ++y) {
            gBoard[x][y]=sEmp;
        }
    }
} 
```

那*应该*创建一个新板并用 enum 填充它`sEmp`。`isX`是一个布尔值，它标志着第一个玩家首先移动。尽管`#include "tttBoard.h"`在该头文件（如下）中有并且（我相信）有构造函数，但我一遍又一遍地遇到相同的错误：

```
error C2589: '(' : illegal token on right side of '::'
error C2059: syntax error : '::'
error C2334: unexpected token(s) preceding '{'; skipping apparent function body 
```

**tttBoard.h**

```
#ifndef tttBoard
#define tttBoard

class tttBoard {
public:
tttBoard();
    void            Draw();
    void            Move(int x, int y);
    char*           getValue(int x, int y);
private:
    enum sVal {
        sEmp,
        sX,
        sO
    };

    sVal            gBoard[3][3];
    bool            isX;
}

#endif 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T04:37:59.160

```
#ifndef tttBoard
#define tttBoard

class tttBoard { 
```

这不是一个适当的包含后卫。您将定义`tttBoard`为一个空符号，然后为该类使用相同的名称。

```
#ifndef TTT_BOARD_H
#define TTT_BOARD_H

class tttBoard { 
    // stuff
};

#endif 
```

# c++ - 如何确定普通话汉字的 Levenshtein 距离？

> ID：12380619
> 
> 赞同：15
> 
> 时间：2012-09-12T02:56:50.620
> 
> 标签：c++, unicode, cjk, levenshtein-distance, edit-distance

我们正在开发一个系统，使用 UTF-8、UTF-16 和 UTF-32 Unicode 字符标准对 50 多种国际语言进行模糊匹配。到目前为止，我们已经能够使用 Levenshtein 距离来检测德语 Unicode 扩展字符单词的拼写错误。

我们想扩展这个系统来处理以 Unicode 表示的普通话表意文字。我们将如何在相似的汉字之间进行 Levenshtein 距离计算？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-12T03:20:25.120

首先，澄清一下：一个汉字本身并不等同于一个德语或英语**单词**。大多数你认为是单词的东西（使用“单词”的语义或句法定义）由 1-3 个字符组成。通过将这些字符序列表示为 UCS-2 或 UCS-4 代码点序列，可以直接将 Levenshtein 距离应用于这些字符序列。由于大多数单词都很短（尤其是长度为 1 或 2 个字符的单词），但它的用途可能有限。

但是，由于您的问题是关于***单个字符*****之间的编辑距离***，我认为需要采用不同的方法，而且确实可能​​非常困难。*

 *首先，您必须将每个字符表示为它所包含的组件/笔划的序列。有两个问题：

*   一些组件本身由更小的**组件组**​​成，因此如何将字符分解为“原子”组件并不是唯一定义的。如果您将其降低到单个**笔画**的级别，则需要对每个笔画进行表征（字符内的位置、形状、方向等）。我不认为任何人都这样做（如果有人告诉我，我会最感兴趣）。

*   您需要将笔画或组件放入**order**中。明显的候选者是字符的规范笔顺，它在词典中进行了描述，甚至还有带有动画笔顺图的字典网站。但是，我知道的数据源（日语）将这些动画生成为位图图形序列；我从未见过以适合编辑距离计算的形式表示笔画序列（甚至单个笔画名称）的人类或机器可读代码。

不过，您可以尝试的最后一件事是渲染字符**字形**并根据需要更改*多少像素*（或矢量）以将一个字符转换为另一个字符来计算编辑距离。我曾经在 OCR 后校正的上下文中对拉丁字符和字符组合（以像素为基础）进行此操作，结果非常令人鼓舞。

* * *

对以下 larsmans 评论的快速回答：Unicode 标准定义了两个相关概念（在下面我指的是[6.0 版本，第 12 章](http://www.unicode.org/versions/Unicode6.0.0/ch12.pdf)）：

1.  基于部首和笔画计数的索引。每个汉字由几个部分组成，*其中一个*是部首。部首/笔画计数索引是按部首排序的字符列表（即，共享相同部首的所有字符组合在一起），并且每个部首特定组在内部按字符其余部分中使用的笔画数排序。不幸的是，即使这也不是唯一定义的——有些字符的部首在不同的传统词典中定义不同，笔画计数也可能很困难。这是 Unicode 标准所说的：

    > 为了加快在码表中定位特定的汉字表意字符，Unicode 网站上提供了部首笔画索引。[...] 最有影响力的部首信息权威是 18 世纪的康熙字典，其中包含 214 个部首。今天使用康熙部首的主要问题是，许多简体字在214个康熙部首中的任何一个下都难以分类。结果，引入了各种现代激进集。然而，没有一个是普遍使用的，214 个康熙部首仍然是最广为人知的。[...] Unicode 部首笔画图表基于康熙部首。Unicode 标准遵循许多不同的字根笔划分类来源。当两个来源在给定字符的部首或笔画计数方面存在分歧时，

    请注意，即使我们假设部首/笔画索引是明确和正确的，它也不足以作为将字符转换为组件序列的信息源，因为由此完全描述的字符的唯一组件是激进的。

2.  表意描述序列（第 12.2 节）：Unicode 为字符的基本组成部分定义了代码点（无论如何，它们中的大多数本身都可以用作独立字符），并且有一些代码点用于将它们粘合在一起以形成描述字符的组件序列组成更复杂的角色。所以它的工作方式类似于*组合 characters*，但有重要的区别：

    1.  组件的顺序不是唯一定义的
    2.  没有定义此类序列的渲染机制
    3.  没有从普通字符到相应的表意描述序列的映射（尽管标准提到这种映射在某种程度上存在于他们用来编译汉字符集的来源中）。

    该标准建议使用表意描述序列来描述任何现有代码点都不表示的复杂或稀有字符；但它明确不鼓励使用描述序列代替普通字符：

    > 特别是，表意文字描述序列不应用于在数据交换中提供编码表意文字的替代图形表示。搜索、整理和其他基于内容的文本操作将会失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-11-14T22:50:51.930

我写了一个python包[`fuzzychinese`](https://github.com/znwang25/fuzzychinese)来纠正中文单词的拼写错误。

正如@jogojapan 所说，如果您真的想计算 Levenshtein 距离，使用诸如**部首**或**笔画**之类的子字符结构更有意义。您可以使用`Stroke()`or`Radical()`类`fuzzychinese`来分解字符，然后计算 Levenshtein 距离。

但是，我不确定 Levenshtein 距离是否能很好地纠正拼写错误的中文单词。在我编写的包中，我计算了 n-gram 笔划的 tf-idf 向量，并使用余弦相似度来匹配单词。*

# c# - 如何将相同的依赖项绑定到 Ninject 中的许多依赖项？

> ID：12380627
> 
> 赞同：4
> 
> 时间：2012-09-12T02:57:35.363
> 
> 标签：c#, dependency-injection, ninject

让我们有三个接口：`IFoo`, `IBar`, `IBaz`. 我也有类`Foo`, `Bar`, ，`Baz`它们是各自的实现。

在实现中，每个都依赖于接口`IContainer`。因此，对于`Foo`（以及类似地对于`Bar`and `Baz`），实现可能是：

```
class Foo : IFoo
{
    private readonly IDependency Dependency;

    public Foo(IDependency dependency)
    {
           Dependency = dependency;
    }

    public void Execute()
    {
         Console.WriteLine("I'm using {0}", Dependency.Name);
    }
} 
```

假设我有一个`Container`恰好包含`IFoo`,`IBar`和实例的类`IBaz`：

```
class Container : IContainer
{
    private readonly IFoo _Foo;
    private readonly IBar _Bar;
    private readonly IBaz _Baz;

    public Container(IFoo foo, IBar bar, IBaz baz)
    {
        _Foo = foo;
        _Bar = bar;
        _Baz = baz;
    }
} 
```

在这种情况下，我希望实现类与注入到,中的约束`Container`绑定，并且对所有三个都相同。以手动方式，我可以将其实现为：`IContainer``IDependency``IFoo``IBar``IBaz`

```
IDependency dependency = new Dependency();
IFoo foo = new Foo(dependency);
IBar bar = new Bar(dependency);
IBaz baz = new Baz(dependency);
IContainer container = new Container(foo, bar, baz); 
```

我怎样才能在 Ninject 中实现这一点？

**注意：我不是在问如何做嵌套依赖。我的问题是如何保证物化服务中的对象集合中给定的依赖关系是相同的。**

非常明确地说，我知道 Ninject 的标准形式将生成等效于以下内容的代码：

```
IContainer container = new Container(new Foo(new Dependency()), new Bar(new Dependency()), new Baz(new Dependency())); 
```

我*不*喜欢这种行为。我也不能将其`Dependency`创建为单例。具体来说，这意味着如果我有多个请求`GetService<IContainer>`，则 Ninject 调用在语义上应该等同于以下手动注入：

```
var dep1 = new Dependency();
var container1 = new IContainer(new Foo(dep1), new Bar(dep1), new Baz(dep1));

var dep2 = new Dependency();
var container2 = new IContainer(new Foo(dep2), new Bar(dep2), new Baz(dep2)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:18:14.870

Use `ToConstant` method to specify exact instance to bind to. If there is an opportunity you can use `Unbind` to rebind to another instance:

```
 IKernel nKernel = new StandardKernel();

        nKernel.Bind<IFoo>().To<Foo>();
        nKernel.Bind<IBar>().To<Bar>();
        nKernel.Bind<IBaz>().To<Baz>();
        nKernel.Bind<IContainer>().To<Container>();

        nKernel.Bind<IDependency>().ToConstant(new Dependency());            

        Container c = nKernel.Get<Container>();
        //utilize the container...

        nKernel.Unbind<IDependency>();
        nKernel.Bind<IDependency>().ToConstant(new Dependency());

        c = nKernel.Get<Container>();
        //utilize the container... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:40:21.037

编辑：

这个怎么样？

```
kernel.Bind<IContainer>().ToMethod(context =>
            {
                IDependency dependency = new Dep();
                IFoo foo = new Foo(dependency);
                IBar bar = new Bar(dependency);
                IBaz baz = new Baz(dependency);
                return new Container(foo, bar, baz);
            }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T04:50:52.057

这是另一个尝试：

```
public class Container : IContainer
{
    private IFoo _foo;
    private IBar _bar;
    private IBaz _baz;

    public Container(IContainerDependencies dependencies)
    {
        _foo = dependencies.Foo;
        _bar = dependencies.Bar;
        _baz = dependencies.Baz;
    }
}

public class ContainerDependencies : IContainerDependencies
{
    public ContainerDependencies(IFoo foo, IBar bar, IBaz baz)
    {
        Foo = foo;
        Bar = bar;
        Baz = baz;
    }

    public IFoo Foo { get; set; }
    public IBar Bar { get; set; }
    public IBaz Baz { get; set; }
}

public interface IContainerDependencies
{
    IFoo Foo { get; set; }
    IBar Bar { get; set; }
    IBaz Baz { get; set; }
} 
```

然后：

```
var kernel = new StandardKernel();
kernel.Bind<IFoo>().To<Foo>();
kernel.Bind<IBar>().To<Bar>();
kernel.Bind<IBaz>().To<Baz>();
kernel.Bind<IContainerDependencies>().ToMethod(context =>
    {
        context.Kernel.Unbind<IDependency>();
        context.Kernel.Bind<IDependency>().ToConstant(new Dep());
        return context.Kernel.Get<ContainerDependencies>();
    });
 kernel.Bind<IContainer>().To<Container>(); 
```

# c# - C# SQL Server 查询名字有空格的名字/姓氏列

> ID：12380631
> 
> 赞同：1
> 
> 时间：2012-09-12T02:58:05.287
> 
> 标签：c#, sql-server, tokenize

我有一个像这样的表结构：

```
user_id | first_name | last_name
      1 | John       | Smith
      2 | Mary       | Jones
      3 | Sang He    | Lau

// here is a sample of the code I currently have to do a user search
public List<string> getResults(string autocompleteQuery) {
  string[] tokens = autocompleteQuery.Split(' ');

  // token[0] = first name parameter (@firstName)
  // token[1] = last name parameter  (@lastName)

  // code here executes the following query:
  // SELECT * FROM [user] WHERE first_name = @firstName AND last_name = @lastName
} 
```

我的问题是，以下使用空格作为列表分隔符并结合查询的代码在名字中有空格时不起作用，如 user_id = 3 所示。

如何优雅地升级代码或查询来处理这种情况？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:02:53.860

```
SELECT * FROM [user]
WHERE 
  first_name + last_name LIKE '%' + token[0] + '%'
AND
  first_name + last_name LIKE '%' + token[1] + '%'
AND
  first_name + last_name LIKE '%' + token[2] + '%'
... 
```

# android - 如何在 Android 平台上从 mp3 文件中解析图像

> ID：12380632
> 
> 赞同：0
> 
> 时间：2012-09-12T02:58:05.527
> 
> 标签：android

我正在尝试在我的 android 手机上编写一个媒体播放器。

有显示嵌入在 mp3 文件中的歌曲图像的功能。

现在我有了 mp3 文件位置的字符串，那么如何获取图像，以便将其提供给 ImageView？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:02:51.937

您应该查看[MediaMetadataRetriever](http://developer.android.com/reference/android/media/MediaMetadataRetriever.html)类以从 mp3 文件的 ID3 标记中获取所有数据。

更具体地说，寻找`getEmbeddedPicture`方法。

您需要使用`BitmapFactory.decodeStream`来获取实际图像。

# java - URLClassLoader : 如何设置 URL

> ID：12380637
> 
> 赞同：0
> 
> 时间：2012-09-12T02:59:24.187
> 
> 标签：java, class, url, tomcat, urlclassloader

假设在tomcat中，有两个应用：app1和app2，文件夹结构如下 tomcat6 -webapps -app1 -WEB-INF -lib -test1.jar -app2 -WEB-INF -lib -test2.jar 现在在test1中。 jar，它有一个类需要加载test2.jar中的类，如何实现？我知道在java中，它有可以加载远程类的URLClassLoader，但是如何设置URL？谢谢

# lucene - Lucene.NET C# 中的空间问题

> ID：12380638
> 
> 赞同：1
> 
> 时间：2012-09-12T02:59:31.783
> 
> 标签：lucene, lucene.net

我想在全文搜索中搜索有空格的句子。

例如：`Tom is a very good boy in class.` 我想搜索关键字“非常好”。

我正在使用空格标记器来创建/搜索索引。但是如果它被空格分隔，它不会找到关键字。

代码：

```
 Query searchItemQuery = new WildcardQuery(new Term(string-field-name, searchkeyword.ToLower())); 
```

我试过拆分，但它不能正常工作。

有人建议我解决这个问题吗？

谢谢，维杰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T08:23:00.327

由于您正在使用标记化字符串，因此每个单词都是一个单独的术语。为了找到包含多个词条的短语，您需要使用 PhraseQuery 而不是 WildcardQuery。像这样：

```
PhraseQuery phraseQuery = new PhraseQuery();
phraseQuery.Add(new Term(string-field-name, "very"));
phraseQuery.Add(new Term(string-field-name, "good")); 
```

另请注意，您正在使用通配符查询。短语查询中的通配符有点复杂。查看这篇文章了解详细信息：[Lucene - 短语中的通配符](https://stackoverflow.com/questions/1088558/lucene-wildcards-in-phrases)

最后，我建议考虑使用 QueryParser 而不是手动构建查询。

# playframework - PPlayframework 应用程序未与 netbeans 一起运行

> ID：12380639
> 
> 赞同：0
> 
> 时间：2012-09-12T02:59:45.137
> 
> 标签：playframework

运行netbeans 7.1，我明白了

```
nb-run-application:
C:\play\play-1.2.4\id doesn't exist
Listening for transport dt_socket at address: 8005
Java Result: -1
BUILD SUCCESSFUL (total time: 4 seconds) 
```

这才刚刚开始发生。恢复的代码，仍然是同样的问题。是否有任何日志可以更好地说明问题？

ide 显示应用程序运行了几秒钟，然后关闭

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T05:18:05.577

问题是缺少一个结束标记，并且 ide 没有显示该错误。通过使用比较备份存储库中的代码来捕捉它

# sql - 处理连续行计算

> ID：12380640
> 
> 赞同：3
> 
> 时间：2012-09-12T02:59:54.310
> 
> 标签：sql, oracle, plsql, oracle11g

假设以下情况：

*   第 1 周：
    *   *0*以前的案例
    *   *10个*新病例
    *   *3个*已解决的案例
*   第 2 周：
    *   *7个*以前的案例
    *   *13个*新病例
    *   *15个*已解决的案例
*   第 3 周：
    *   *5个*以前的案例
    *   *6个*新病例
    *   *7个*已解决的案例

此信息存储在以下排序的恢复表中：

```
RESUME_TABLE:
WEEK    | TOTAL_NEW |   TOTAL_SOLVED
1       |   10      |   3
2       |   13      |   15
3       |   6       |   7 
```

我很难构建查询以获得以下结果：

```
REPORT_TABLE:
WEEK    |   PREV_TOTAL  |   NEW_CASES   |   SOLVED_CASES    |   NEW_TOTAL
1       |   0           |   10          |   3               |   7
2       |   7           |   13          |   15              |   5
3       |   5           |   6           |   7               |   4 
```

这个想法似乎很微不足道，`NEW_TOTAL = PREV_TOTAL + NEW_CASES - SOLVED_CASES`尽管我一直在努力将其`PREV_TOTAL`带到下一行以继续前进。

我正在尝试使用`RESUME`表上的视图（Oracle 11g）来做到这一点。

有人可以帮我一些示例代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T04:57:27.320

非常简单整洁的分析功能：

```
12:57:06 HR@vm_xe> l                                                                    
  1  select week                                                                        
  2         ,lag(total_cases_by_now - total_solved_by_now) over (order by week) prev_total
  3         ,total_new new_cases                                                        
  4         ,total_solved solved_cases                                                  
  5         ,total_cases_by_now - total_solved_by_now new_total                         
  6    from (                                                                           
  7    select week                                                                      
  8           ,total_new                                                                
  9           ,total_solved                                                             
 10           ,sum(total_new) over(order by week asc) as total_cases_by_now             
 11           ,sum(total_solved) over (order by week asc) as total_solved_by_now        
 12      from resume_table                                                              
 13* )                                                                                  
12:57:07 HR@vm_xe> /                                                                    

      WEEK   PREV_TOTAL  NEW_CASES SOLVED_CASES  NEW_TOTAL                                
---------- ------------ ---------- ------------ ----------                                
         1                      10            3          7                                
         2            7         13           15          5                                
         3            5          6            7          4                                

3 rows selected.                                                                        

Elapsed: 00:00:00.01 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T04:51:34.490

[您可以使用MODEL](http://docs.oracle.com/cd/E11882_01/server.112/e25554/sqlmodel.htm#g1042989)子句解决此问题：

```
with resume_table as
(
    select 1 week, 10 total_new, 3 total_solved from dual union all
    select 2 week, 13 total_new, 15 total_solved from dual union all
    select 3 week, 6 total_new,  7 total_solved from dual
)
select week, prev_total, total_new, total_solved, new_total
from resume_table
model
    dimension by (week)
    measures (total_new, total_solved, 0 prev_total, 0 new_total)
    rules sequential order
    (
        new_total[any] order by week = 
            nvl(new_total[cv(week)-1], 0) + total_new[cv()] - total_solved[cv()]
        ,prev_total[any] order by week = nvl(new_total[cv(week)-1], 0)
    )
order by week; 
```

尽管这假设 WEEK 始终是一个连续的数字。如果不是这样，您将需要添加一个`row_number()`. 否则，`-1`可能不会引用先前的值。

请参阅此[SQL Fiddle](http://sqlfiddle.com/#!4/d41d8/2662)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T03:42:48.413

添加一列`RESUME_TABLE`（或创建一个视图，我认为这可能会更好）：

```
RESUME_LEFT
WEEK | LEFT
1    | 7
2    | -2
3    | -1 
```

像这样的东西：

```
CREATE VIEW resume_left
  (SELECT week,total_new-total_solved "left" FROM resume_table) 
```

所以在 中`REPORT_TABLE`，你可以有这样的定义：

```
PREV_TOTAL=(SELECT sum(left) FROM RESUME_LEFT WHERE week<REPORT_TABLE.week) 
```

* * *

**编辑**

好的，视图是不必要的：

```
PREV_TOTAL=(SELECT sum(total_new)-sum(total_solved)
  FROM resume_table
  WHERE week<REPORT_TABLE.week) 
```

# sql - SQL 交叉选项卡和数据透视表

> ID：12380644
> 
> 赞同：2
> 
> 时间：2012-09-12T03:00:24.123
> 
> 标签：sql, sql-server, pivot, crosstab

我正在使用以下查询来检索一些结果

```
SELECT  CONVERT(varchar, TS.StaffID) + CHAR(13) 
        + SUBSTRING ( TS.GivenName, 1 , 1 ) + '.' + CHAR(13) 
        + TS.Surname AS EmployeeInfo, SH.Hours,ts.UnitID,sh.RowID
         FROM dbo.tbl_TimesheetStaff AS TS
         Left OUTER JOIN
         dbo.tbl_StaffHours AS SH ON
         SH.ActivityUnitID = TS.ActivityUnitID
         AND Sh.StaffID=ts.StaffID
         WHERE TS.UnitID=1 
```

结果集看起来像

```
 EmployeeInfo   Hours  UnitID RowID
    114 H. Bar     73.71    111   401
    114 H. Bar     42.44    111   402
    115 M. Cha     20.39    111   401
    115 M. Cha     3.616    111   402
    116 Q. Xyz     20.39    111   401
    116 Q. Xyz     3.61     111   402 
```

现在我想要将 EmployeeInfo 列值转换为列名

```
 114 H. Bar  115 M. Cha  116 Q. Xyz  RowID
     73.71       20.39       20.39      401
     42.44       3.616       3.61       402 
```

EmployeeInfo 中的行数可以变化，因此我需要一个动态数据透视函数。

任何线索..？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:28:10.327

试试这个：

```
create table #t table(EmployeeInfo varchar(20),  Hours float, UnitID int, RowID int)
insert into #t
SELECT  CONVERT(varchar, TS.StaffID) + CHAR(13)  
        + SUBSTRING ( TS.GivenName, 1 , 1 ) + '.' + CHAR(13)  
        + TS.Surname AS EmployeeInfo, SH.Hours,ts.UnitID,sh.RowID 
         FROM dbo.tbl_TimesheetStaff AS TS 
         Left OUTER JOIN 
         dbo.tbl_StaffHours AS SH ON 
         SH.ActivityUnitID = TS.ActivityUnitID 
         AND Sh.StaffID=ts.StaffID 
         WHERE TS.UnitID=1 

DECLARE @cols AS NVARCHAR(MAX), 
    @query  AS NVARCHAR(MAX) 

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(EmployeeInfo)  
                    from #t 
            FOR XML PATH(''), TYPE 
            ).value('.', 'NVARCHAR(MAX)')  
        ,1,1,'') 

set @query = 'SELECT RowID,  ' + @cols + '   
                from #t 
            pivot  
            ( 
                MAX([Hours]) 
                for Code in (' + @cols + ') 
            ) p ' 
print(@query) 
execute(@query) 
```

# python - Django 表单验证错误

> ID：12380645
> 
> 赞同：0
> 
> 时间：2012-09-12T03:00:34.507
> 
> 标签：python, django

在 Django 中尝试我的第一个应用程序，并且在表单验证方面遇到了一些问题（以下文档）这是文件上传代码的一部分。表单创建良好。但是，验证失败。即使，我提供`Title`，它给`This field is required.`

## 视图.py

```
def upload(request):
    if request.method == 'POST':
        form = UploadFileForm(request.POST, request.FILES)
        if form.is_valid():
            #TODO handle(request.FILES['file'])
            return HttpResponseRedirect('/')
    else:
        form = UploadFileForm()
    return render_to_response('setup.html', {'form': form},context_instance=RequestContext(request)) 
```

## 表格.py

```
from django import forms

class UploadFileForm(forms.Form):
    title = forms.CharField()
    file = forms.FileField() 
```

## 设置.html

```
<form action="/setup/" method="post">{% csrf_token %}
    {% for field in form %}
        <div class="fieldWrapper">
            {{ field.errors }}
            {{ field.label_tag }}: {{ field }}
        </div>
    {% endfor %}
    <input type="submit" value="Submit" />
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:13:25.513

将参数添加`required`到您的表单字段。[如果您不提供它，Django 将假定它是必需的](https://docs.djangoproject.com/en/dev/ref/forms/fields/#required)。

`title = forms.CharField(required=False)`

# c++ - 列出 C++ 代码的全局命名空间的工具？

> ID：12380647
> 
> 赞同：0
> 
> 时间：2012-09-12T03:01:20.403
> 
> 标签：c++

是否有工具可以显示给定 C++ 代码源/头文件集的所有全局命名空间名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:35:05.603

您可以尝试预处理文件并读取输出。这将告诉您将要编译的所有内容——包括您有意包含的所有内容，如 iostream 和无意中包含的系统头文件。

GCC 中的示例：

```
g++ -E file.cpp ... > file.i 
```

其他编译器可能有执行此操作的选项（例如，如果他们希望直接从 Visual Studio 运行，可能会更难使用）。

然后打开文件。这有点神秘。以 # 开头的行告诉有用的信息，例如正在读取哪个文件/行。您可能会走到底部并向上阅读。

注意： ... 是您将在编译时传递的所有其他编译器选项和定义。这很重要，因为它可能会影响编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T10:13:48.893

您可以为此使用[CppDepend](http://www.cppdepend.com)，并使用 CQLinq 一种语言来查询代码库，您可以执行更复杂的查询以准确获取您感兴趣的内容。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T03:13:30.850

在没有为您执行此操作的工具的情况下，如果您觉得需要深入研究，并且如果您拥有 Visual Studio 2010，我可能会从以下一个或两个选项开始：

*   项目属性->C/C++->高级->显示包含->YES
*   项目属性->C/C++->预处理器->预处理到文件->YES

这两个选项中的一个或两个可以让您开始为本地例程提供输入，该例程将找到存在于命名空间之外的声明。

这些选项以一种或另一种方式存在于早期版本的 Visual Studio 中——我认为至少可以追溯到 VS 2005。

# c# - 字典和 SelectMany()

> ID：12380659
> 
> 赞同：2
> 
> 时间：2012-09-12T03:02:59.037
> 
> 标签：c#, dictionary

所以我有这些部分课程。有关 ParseFCIE 的部分实现和我的问题，请参见下文。

```
class CiscoSwitch
{
    Dictionary<int, CiscoVSAN> VSANList = new Dictionary<int, CiscoVSAN>();
    public void ParseFCIE(string block) 
    {}
}

class CiscoVSAN
{
     Dictionary<string, CiscoSwitch> MemberSwitches = new Dictionary<string, CiscoSwitch> ();
} 
```

ParseFCIE 的一部分是检查输入数据中的传入交换机是否已经在任何 CiscoVSAN 对象的 SwitchMembers 字典中，如果没有，则添加它。我有 2 个字典语句。第一条语句有效，第二条编译器说它无法确定谓词的类型，我不知道为什么。我更喜欢第二个第二个陈述，因为它只是一个步骤。我搜索开关的第一种方法是检查搜索结果中的空值。

```
ParseFCIE(string block)
{  
     string DID = string.Empty;
     //partial implementation
     // 'this' is a CiscoSwitch object
     //this works
     var vsans= this.VSANList.SelectMany(v => v.Value.MemberSwitches.
                          Where(d => d.Value.switchName == this.switchName)); 
     // assume DID now has a value;
     // this line the compiler says the type arguments cannot be inferred from usage
     if (this.VSANList.SelectMany(v => v.Value.MemberSwitches.ContainsKey(DID))) 
     {}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:06:05.780

```
if (this.VSANList.SelectMany(v => v.Value.MemberSwitches).Any(x => x.ContainsKey(DID))) {
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:06:12.677

`v.Value.MemberSwitches.ContainsKey(DID)`返回 a `boolean`，指示该嵌套字典是否包含该键。
`SelectMany()`需要一个返回集合的委托以使其展平。

你需要打电话`Any()`。

# jsf-2 - 经常刷新 primefaces 数据网格（轮询的替代方法）

> ID：12380662
> 
> 赞同：1
> 
> 时间：2012-09-12T03:03:12.173
> 
> 标签：jsf-2, datagrid, primefaces

我需要每 30 秒刷新一次*PrimeFaces*数据网格（版本 3.3.1）以从数据库中获取修改后的值。目前我正在使用*PrimeFaces*轮询，但每次调用数据库都会导致性能问题。

有没有其他方法可以刷新内容？

```
 <p:poll interval="30" listener="#{BoardAction.Search}" update="boardpanel"/> 
```

search 是刷新期间调用的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T08:00:05.127

如果您可以依赖其他触发器来启动刷新，您应该使用[Push（通过 primefaces - 自 3.4 版本起）](http://www.primefaces.org/showcase/push/index.jsf)

您将使用 push 刷新只会在需要时而不是每 30 秒发生一次，因此您可以保存对 db 的调用

如果你必须每 30 秒刷新一次，那么 poll 是你需要使用的东西（你可以考虑微调你的后端代码，也许你的 db 调用可以改进）

# python - 如何在恒定时间内找到python中列表/元组的大小

> ID：12380664
> 
> 赞同：1
> 
> 时间：2012-09-12T03:03:43.400
> 
> 标签：python, pointers

我是 Python 的新手。我只是想知道是否可以在 O(1) 时间内找到列表或元组的长度。*(len() 是 O(n))*

在C中，我可以实现如下类似的事情：

```
int a[] = {1, 2, 3, 4 ,5};
printf("Length of Array a is :: %d\n", sizeof(a)/sizeof(a[0])); 
```

我知道上述概念适用于地址，这就是为什么它在 C 中是可能的，而根据我的理解，Python 不处理地址。但是，出于好奇，我仍然想问这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T03:07:27.840

`len()`在 Python 中调用列表是`O(1)`. 见[这里](http://wiki.python.org/moin/TimeComplexity)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T03:08:47.747

这在 C 中的 O(1) 中起作用的原因不是因为它处理“地址”，而是因为在编译时知道大小。事实上，如果你在一个动态分配的数组上使用 sizeof()，你总是会得到一个指针的大小。

在 python 中，虽然你想使用 len()。

# mongodb - [MongoDB]'profile'为2时，system.profile集合中会保存哪些操作？

> ID：12380666
> 
> 赞同：0
> 
> 时间：2012-09-12T03:03:52.557
> 
> 标签：mongodb

今天想测试一下“profile”和“slowms”这两个参数。以下是我的案例：

profile 是 1，slowms 是 200

1.  >./mongod --dbpath /data/db --fork --profile 1 --slowms 200
2.  做一个查询，这个查询花费了 415 毫秒
3.  log文件有相关操作信息，system.profile也有相关文件
4.  再次进行查询，此查询花费了 110 毫秒
5.  log文件无相关操作信息，system.profile无相关文件

更新这两个参数“profile”和“slowms”

profile 是 2，slowms 是 200

1.  >./mongod --dbpath /data/db --fork --profile 2 --slowms 200
2.  做一个查询，这个查询花费了 410 毫秒
3.  log文件有相关操作信息，system.profile也有相关文件
4.  再次进行查询，此查询花费了 100 毫秒
5.  log文件无相关操作信息，system.profile无相关文件

当参数“profile”为2时，为什么日志文件和system.profile没有相关信息？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T14:14:25.713

所有慢查询都写入 mongod 日志。默认`slowms`值为 100 毫秒。

MongoDB[分析级别](http://www.mongodb.org/display/DOCS/Database+Profiler)允许将附加信息写入数据库的 system.profile 上限集合。

分析级别是：

```
0 - off
1 - write slow operations 
    to the system.profile collection
2 - write all operations to the system.profile collection 
```

如果您将分析级别作为命令行或配置文件参数传递，它们会影响所有数据库的默认值。您还可以在shell 中使用`db.setProfilingLevel(..)`and来设置或获取每个数据库的分析级别。`db.getProfilingLevel(..)``mongo`

因此，对于您的第一次测试：

1.  ./mongod --dbpath /data/db --fork --profile 1 --slowms 200
2.  做一个查询，这个查询花费了 415 毫秒
3.  log文件有相关操作信息，system.profile也有相关文件
4.  再次进行查询，此查询花费了 110 毫秒
5.  log文件没有相关的操作信息，system.profile没有相关的文件更新，因为你有

这是您的分析设置为 1 且慢速为 200 毫秒时的预期结果：

*   您的慢查询（415ms > 200ms）正在记录到 system.profile 以及日志文件
*   第二个查询（110ms < 200ms）不被视为慢查询，因此不会记录或保存在 system.profile

对于您的第二次测试：

1.  >./mongod --dbpath /data/db --fork --profile 2 --slowms 200
2.  做一个查询，这个查询花费了 410 毫秒
3.  log文件有相关操作信息，system.profile也有相关文件
4.  再次进行查询，此查询花费了 100 毫秒
5.  log文件无相关操作信息，system.profile无相关文件

    *   您的慢查询正在记录到两者
    *   第二个查询并不慢，但仍将作为分析级别 2 记录到 system.profile

请注意，配置级别为 2 时，您将在 system.profile 中收集更多条目。find() 的默认顺序是从最旧到最新，因此如果您想查看给定集合的最新查询，您需要按逆自然顺序排序。

例如，要查找数据库中`people`集合的最后一个查询`test`，您可以在`test.people`命名空间上进行搜索，类似于：

```
db.system.profile.find({'ns':'test.people'}).sort({$natural:-1}).limit(1) 
```

# javascript - 查询缓冲收到错误：错误代码 0？（谷歌地图的 ArcGis 服务器链接）

> ID：12380668
> 
> 赞同：0
> 
> 时间：2012-09-12T03:04:34.710
> 
> 标签：javascript, gis, arcgis, arcgis-server

我一直在尝试将缓冲区功能添加到一个正在进行的项目中，该项目在[此处](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/arcgislink/docs/examples.html)使用 arcgis 服务器链接进行谷歌地图。

我可以在地图上绘制缓冲区，但是，当我尝试对缓冲区（使用 proxy.ashx）和所有内容执行查询时，根据 firebug，代理加载正常，但它们返回错误，“错误：错误代码 0”，仅此而已。因为这个，我现在有点卡住了。

我不确定我做错了代理配置文件还是代码。我目前正在使用上面链接中的图层查询作为如何通过缓冲区查询的参考，方法是指示一个空间过滤器，它是缓冲区本身。

以下是代码：

```
var layer = overlayObjects['ls'].getMapService().getLayer(0);

var params = {
    geometry: buffers,
    geometryType: "esriGeometryPolygon",
    where:" ",
    spatialRelationship: "CONTAINS",
    returnGeometry: true        
};  

layer.query(params, function(resultSet){...} 
```

错误发生在 layer.query() 方法中。

我的代理配置文件：

```
<ProxyConfig mustMatch="true">
<serverUrls>
<!-- serverUrl options:
        url = location of the ArcGIS Server, either specific URL or stem
        matchAll = true to forward any request beginning with the url
        token = (optional) token to include for secured service
        dynamicToken = if true, gets token dynamically with username and
          password stored in web.config file's appSettings section.
-->

<serverUrl url="http://*mapserverlink*/ArcGIS/rest/services/"
           matchAll="true"></serverUrl>
</serverUrls>

</ProxyConfig> 
```

由于某些安全原因，我不确定是否应该将服务器 url 放在这里。无论如何，serverUrl 是不安全的，所以我认为不需要令牌。

另外..是因为我使用的缓冲区对象不是overlayView对象吗？如 queryOptions 类参考中所述。我的缓冲与上面链接中的示例中的缓冲基本相同。我已经使用从缓冲区获得的几何进行了测试，并将其放入地图服务器的查询服务中，并收到了一组记录，但不是用于 javascript。

对此的任何帮助将不胜感激..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T08:21:16.710

很抱歉将 google maps api v3 放入其中，因为我认为它包含在我正在查看的 api 参考中。我设法弄清楚错误代码 0 有什么问题。我通读了项目中的 arcgislink.js，发现代码 0 来自 XMLHTTPRequest 的状态代码。在对服务器进行一些配置后，它现在可以工作了..

# php - 在 wamp 2.2 中调用未定义函数 curl_init() 错误

> ID：12380670
> 
> 赞同：33
> 
> 时间：2012-09-12T03:04:46.077
> 
> 标签：php, curl, wamp, wampserver

当我尝试**使用 wamp 服务器在 Windows 7 中**实现 google 和 facebook 身份验证时出现以下错误。

> 致命错误：在第 273 行的 E:\wamp\www\mysite\protected\extensions\eauth\EAuthServiceBase.php 中调用未定义函数 curl_init()

我在用，

*   wampserver 2.2
*   php 版本 5.3.13

我也启用了 php_curl 模块。我检查了 php.ini 以进行确认，如下所示未注释。

```
;extension=php_bz2.dll
extension=php_curl.dll
;extension=php_dba.dll 
```

该代码已在带有 xampp 的 ubuntu 中运行，但在 windows 中的 wamp 中却没有。我已经做了我能找到的一切。我也尝试根据此线程上的评论替换 php_curl.dll，[调用未定义函数 curl_init() - 使用 WAMP](https://stackoverflow.com/questions/12076641/call-to-undefined-function-curl-init-with-wamp)

我的 phpinfo() 如下所示。 ![在此处输入图像描述](../Images/3958e7c1c154dc90937d9309144b015c.png)

我在 E:\ 分区中安装了 wamp，但是“配置文件 (php.ini) 路径”似乎不同，它是 C:\Windows。

请帮我解决问题。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-09-12T12:14:49.540

访问这个并在 Fixed curl extensions 下有一个文件： [http](http://www.anindya.com/php-5-4-3-and-php-5-3-13-x64-64-bit-for-windows/) ://www.anindya.com/php-5-4-3-and-php-5-3-13-x64-64-bit-for-windows/ 之后下载并替换相关文件，然后重新启动服务器。在浏览器中导航到 localhost 并确保在 Loaded Extensions 下显示 curl 扩展：

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-08T20:30:23.780

对于在 Windows 7 64 位上运行 PHP 5.4.3 的 WAMP，请确保使用 php_curl-5.4.3-VC9-x64.zip 而不是 php_curl-5.4.3-nts-VC9-x64.zip。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-02-03T23:42:31.853

在带有 PHP 5.5.31 的 Windows 7 中，在检查 php_curl.dll 扩展是否已启用（但仍然无法正常工作）后，我可以将**libeay32.dll**和**libssh2.dll**从 php 目录复制到 Apache bin。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T05:05:02.757

只是一个猜测 - php.ini 中的这一部分没有引用正确的位置

```
; Directory in which the loadable extensions (modules) reside.
extension_dir = *some value* 
```

[http://www.php.net/manual/en/ini.core.php#ini.extension-dir](http://www.php.net/manual/en/ini.core.php#ini.extension-dir)

编辑

另外，在您的 phpinfo 中查找此块，如果它不存在，则 curl 未加载（显然）。您不是在寻找匹配的版本号 - 只是为了块的存在。

![phpinfo 中的 curl 部分](../Images/61b08d38168445bc81ac162225093f85.png)

编辑

也看看这个问题

[Windows 7 64 位和 Apache 下的 PHP 和 CURL](https://stackoverflow.com/questions/2099174/php-and-curl-under-windows-7-64-bits-and-apache)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-29T11:15:11.987

下载此文件并替换您的 php_curl 文件。

[http://pan.baidu.com/share/link?shareid=256509&uk=3675208906](http://pan.baidu.com/share/link?shareid=256509&uk=3675208906)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-25T12:53:42.893

### 使用 WAMP 时..

*   您应该`php.ini`在 PHP 主目录中有一个文件*   在`php.ini`启用扩展`extension=php_curl.dll`中，通过删除`;`char*   `extension_dir`必须看起来像这个例子：，`extension_dir = "D:\AMP\PHP\ext\"`所以不是相对路径*   您只需要重新启动 Apache 服务器一次。无需多次重启*   只需确保您`php_curl.dll`在`ext`目录中有

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-30T21:32:08.790

（Windows 10 用户）

由于这是 Google 的第一个结果，我遇到了完全相同的问题，而且您的解决方案都没有为我工作，我终于在 stackoverflow 的另一个线程中找到了正确的解决方案，我将在此处发布链接： [EasyPHP Devserver 16.1 Curl Win 10](https://stackoverflow.com/questions/35113820/easyphp-devserver-16-1-curl-win-10)

解决方案是将您当前的 PHP 目录（取决于您使用的版本）添加到 Windows 中的全局“路径”变量中（如链接中所述，但您当然不需要添加所有 php 目录）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-02T12:42:51.673

不知道把我的经验放在哪里，希望它对某人有用。

就我而言（win7 x64 + apache 2.4 + php 7.2），curl 扩展已启用`php.ini`但未加载。[通过用最新版本](https://bintray.com/vszakats/generic/openssl/)的 OpenSSL替换 libs`libssl-1_1-x64.dll`和**Apache 的**文件夹来`libcrypto-1_1-x64.dll`解决 **`bin`**

 *** * *

## 回答 #9

> 赞同：-2
> 
> 时间：2014-07-25T13:42:40.030

通过删除更改 php.ini 文件中的扩展名取消注释；像下面

```
;extension=php_bz2.dll
extension=php_curl.dll
;extension=php_dba.dll 
```

然后重新启动所有服务，它会工作。**

# java - 从源代码提取时，我的模块似乎没有在 IntelliJ 中正确设置

> ID：12380673
> 
> 赞同：0
> 
> 时间：2012-09-12T03:05:43.560
> 
> 标签：java, spring, git, intellij-idea

在一台新计算机上，我从源代码中提取了我的 intellij 项目（spring mvc），当它打开时，我遇到了 10 多个错误，这些错误与未正确设置的 maven 模块等有关。

我注意到我的 appname.iml 不在 m git 存储库中。

我的 .gitignore 中有这个：

*.iml

应该包含这个文件，还是只需要这个 appname.iml？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T05:38:37.047

如果你不共享`.iml`文件，你也不需要共享`.idea`目录。在这种情况下，您需要打开`pom.xml`或使用新项目向导从 Maven 导入。存储在 IntelliJ IDEA 项目中的设置必须在每台机器上重新配置。

如果您选择共享 IntelliJ IDEA 项目文件（`.idea`目录和`.iml`），[请参阅常见问题解答](http://devnet.jetbrains.net/docs/DOC-1186)。

# windows - EXE 的无人值守安装（无需用户交互）

> ID：12380681
> 
> 赞同：0
> 
> 时间：2012-09-12T03:06:23.743
> 
> 标签：windows

是否有任何脚本语言可用于创建静默安装（无需输入并单击下一步，同意并完成）...？我想在 Windows 服务器中无人值守安装 NewsGator.exe 应用程序，哪种脚本最好..？预先感谢您的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:09:48.323

[NSIS](http://nsis.sourceforge.net/Main_Page)`/S`为运行安装程序提供了非常简单的标志。创建一个简单的安装程序也非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T07:43:37.863

所有 MSI 安装程序都可以支持静默安装，通过命令行以以下形式提供输入参数：

安装程序.exe /v/qn“参数=值参数=值”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:42:25.747

试试 autoit，这里是一个如何自动化 WinZip 安装的例子：

[http://www.autoitscript.com/autoit3/docs/tutorials/winzip/winzip.htm](http://www.autoitscript.com/autoit3/docs/tutorials/winzip/winzip.htm)

我已经用它来自动化我合作的公司的几次安装，它非常简单。

# c - 如何在 C 中将 RGB 转换为 HSL？

> ID：12380682
> 
> 赞同：4
> 
> 时间：2012-09-12T03:06:28.457
> 
> 标签：c, rgb, color-space, hsl

如何在 C/C++ 中将 RGB 转换为 HSL？

^(（注意：这是一个（简短的）自我回答——我把它贴在这里，这样人们就可以通过搜索快速找到它。）)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T03:06:28.457

[从这里](http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c)翻译代码，你会得到：

```
// Assuming sizeof(unsigned int) == 4 * sizeof(unsigned char)
unsigned int RgbToHsl(unsigned int rgb)  // Alpha value is simply passed through
{
#ifdef __cplusplus
    using std::max;
    using std::min;
#endif
    double
        r = (rgb >> (0 * CHAR_BIT)) & UCHAR_MAX,
        g = (rgb >> (1 * CHAR_BIT)) & UCHAR_MAX,
        b = (rgb >> (2 * CHAR_BIT)) & UCHAR_MAX;
    r /= UCHAR_MAX;
    g /= UCHAR_MAX;
    b /= UCHAR_MAX;
    double
        maxv = max(max(r, g), b),
        minv = min(min(r, g), b),
        h = 0, s = 0, d = maxv - minv,
        l = (maxv + minv) / 2;
    if (maxv != minv)
    {
        s = l > 0.5 ? d / (2 - maxv - minv) : d / (maxv + minv);
        if (maxv == r) { h = (g - b) / d + (g < b ? 6 : 0); }
        else if (maxv == g) { h = (b - r) / d + 2; }
        else if (maxv == b) { h = (r - g) / d + 4; }
        h /= 6;
    }
    return ((unsigned int)(h * UCHAR_MAX) << (0 * CHAR_BIT)) |
           ((unsigned int)(s * UCHAR_MAX) << (1 * CHAR_BIT)) |
           ((unsigned int)(l * UCHAR_MAX) << (2 * CHAR_BIT)) |
           (((rgb >> (3 * CHAR_BIT)) & UCHAR_MAX) << (3 * CHAR_BIT));
} 
```

假设顺序是 RGBA，其中 R 是最低有效字节。

# graphics - DX9 内存泄漏：Release() 返回 0 但未调用 DestroyObject

> ID：12380685
> 
> 赞同：2
> 
> 时间：2012-09-12T03:07:14.517
> 
> 标签：graphics, memory-leaks, directx, direct3d, directx-9

1.  `IDirect3DVertexDeclaration9`函数分配的两个对象`FindNextValidTechnique()`被释放但没有被销毁。在 PIX 中，“App Refs”状态为“0”，但“Destruction”状态为“Never”。
2.  应用程序分配的`IDirect3DIndexBuffer9`对象被释放但不被销毁。在 PIX 中，“App Refs”状态为“0”，但“Destruction”状态为“Never”。调用函数后`SetIndices(NULL)`，索引缓冲区的内存泄漏消失了。
3.  函数分配的一个`IDirect3DVertexShader9`和一个对象被释放但不被销毁。在 PIX 中，“App Refs”状态为“0”，但“Destruction”状态为“Never”。但是，在我调用and之后，两者的内存泄漏就消失了。`IDirect3DPixelShader9``D3DXCreateEffect()``SetVertexShader(NULL)``SetPixelShader(NULL)`
4.  `IDirect3DSwapChain9`分配有该函数的对象`CreateAdditionalSwapChain()`被释放但不被销毁。`GetBackBuffer()`曾经调用过，但 Surface 稍后发布。在 PIX 中，它们的“App Refs”状态为“0”，但它们的“Destruction”状态为“Never”。
5.  当然，`IDirect3DDevice9`and`IDirect3D9`对象被释放但没有被销毁。

我检查了 PIX 和应用程序中所有对象的引用计数。它们都是0。我不知道为什么仍然会发生内存泄漏。我不认为`SetIndices(NULL)`等是必要的。有人可以给我一些建议吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T21:49:22.150

尝试通过 DirectX 控制面板使用 Debug D3D DLL，打开“Break on Memory Leaks”，您将在调试输出中看到调用堆栈。

# vim - 在 vim 中可以循环滚动吗？

> ID：12380689
> 
> 赞同：3
> 
> 时间：2012-09-12T03:07:47.683
> 
> 标签：vim, scroll

是否可以配置 vim 以使移动命令“环绕”垂直（或水平）缓冲区？

换句话说，假设我在缓冲区的第 2 行，处于可视模式。我按`3k`。我的光标现在位于缓冲区的最后一行。

或者更简单地说，我的光标位于文件的第一行——我按下`k`. 现在我的光标翻转到文件的最后一行。

抱歉，如果以前有人问过这个问题，但我找不到任何搜索“圆形滚动”或“环绕滚动”的参考资料。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T04:06:28.180

`G`使用一些 vimscript hackery 可能是可能的，但是通过诸如转到文件底部和`gg`/`1G`或`<C-Home>`转到文件顶部之类的动作来提高效率要普遍得多。同样，`$`对于行尾和`0`行首或`^`第一个非空白字符。

您还可以设置`:help whichwrap`，它指定哪些键在移过行尾时将移至下一行，或在移过行首时移至上一行。除此之外，我认为没有内置功能可以满足您的要求。您可以使用一些 vimscript 来做到这一点，但它需要将 h、j、k 和 l 重新映射到函数并处理它们是否位于行/文件的末尾/开头。对我来说，这似乎有点矫枉过正而且相当混乱。

说了这么多，如果你必须...

```
nnoremap j :call CheckJ()<cr>
nnoremap k :call CheckK()<cr>
nnoremap h :call CheckH()<cr>
nnoremap l :call CheckL()<cr>

fun! CheckJ()
   if line('.') == line('$')
      norm! gg
   else
      norm! j
   endif
endfun

fun! CheckK()
   if line('.') == 1
      norm! G
   else
      norm! k
   endif
endfun

fun! CheckH()
   if col('.') == 1
      norm! $
   else
      norm! h
   endif
endfun

fun! CheckL()
   if col('.') == (col('$') - 1)
      norm! 0
   else
      norm! l
   endif
endfun 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T05:18:27.637

Vim 是一个*文本*编辑器，文本具有物理和逻辑属性，即在列和行中都有开始和结束。因此，您请求的功能不存在，并且可能永远不会包含在 Vim 中。

然而，通过将大多数移动命令绑定到自定义实现，它可以通过一些努力在 Vimscript 中进行模拟。但这会在使用模型中引入不一致，因为范围（例如`:42,10`）仍然不会环绕。

你为什么想要这样的环绕？这是针对特定文件类型的，还是您从其他编辑器习惯了它？

# asp.net-mvc - 与 ASP.NET MVC 和 CAS 的 Web 应用程序间通信

> ID：12380694
> 
> 赞同：0
> 
> 时间：2012-09-12T03:08:34.303
> 
> 标签：asp.net-mvc, web-services, rest, cas

我们已经在我的公司实现了几个 Intranet Web 应用程序。他们都：

1.  由 ASP.NET MVC 3 构建
2.  使用 CAS（cookie 策略中的票证）和共享 LADP 服务器进行单点登录
3.  根据当前登录用户具有基于角色的访问控制逻辑
4.  为页面的 ajax 使用公开许多 RESTful(like) web api

现在我们发现这些用于 ajax 请求的 Web api 可以用作其他 Web 应用程序的服务（如员工信息、客户信息等）。这意味着我们需要在后端访问这些 api（使用 C# 代码）。问题是身份验证和授权。

我不知道如何使用现有的身份验证模式来访问那些 web api。我只能想到一种在后端服务器之间使用共享服务凭证的方法，但这意味着该凭证必须具有完全访问权限。是否存在安全风险？正如我所提到的，我们在 CAS 的 cookie 策略中使用票证。这对于浏览器来说是可以的，但对于 C# 代码来说似乎很难。如何从后端使用带有 CAS 的凭证？使用 WebClient 并手动处理 302？

有没有人遇到过类似的情况并对此有一些好的经验？请给我一些建议。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T07:21:40.610

您需要的是使用 CAS 代理模式访问后端 Web 服务：[https](https://wiki.jasig.org/display/CAS/Proxy+CAS+Walkthrough) ://wiki.jasig.org/display/CAS/Proxy+CAS+Walkthrough 。

# php - 检查php中的多个文件输入

> ID：12380696
> 
> 赞同：1
> 
> 时间：2012-09-12T03:08:46.593
> 
> 标签：php

伙计们有一个问题，不知道为什么这不起作用，我有可以上传多个图像的文件输入字段。

这是我的表格

```
<form method="post" action="" enctype="multipart/form-data">
<input name="images[]" type="file" multiple="multiple">
<input type="submit" name="test" value="test"/>
</form> 
```

如果我在没有选择任何文件的情况下提交了代码，我需要显示一条错误消息。这是我的php代码

```
if(!empty($_FILES['images']['name'])){
foreach($_FILES['images']['name'] as $key =>$value){
//other code
}
}else{
echo 'No images have been selected';
} 
```

但这不知道为什么..？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T03:12:11.287

试试这个：

```
$hasUpload = false;
if(isset($_FILES['images']['name'])){
    foreach($_FILES['images']['name'] as $key => $value){
        if(!empty($value)) {
            // some codes here
            $hasUpload = true;
        }
    }
}
if (!$hasUpload) {
    echo 'No images have been selected';
} 
```

# validation - playframework 2.0 中的@Equals 注释在哪里？

> ID：12380701
> 
> 赞同：0
> 
> 时间：2012-09-12T03:09:38.987
> 
> 标签：validation, playframework, playframework-2.0

我正在尝试使用注册表单中的 confirmPassword 字段验证密码是否相等。我知道在 v.1（确切地说是 v.1.2.4）中，您可以使用 @Equals("confirmPassword") 注释来做到这一点。然而，在 v2.0 中似乎缺少相同的功能。我错过了什么还是 v2.0 不再实现这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:32:42.563

查看Play 2.0的[表单验证](https://github.com/playframework/Play20/wiki/JavaForms)`Constraints`，特别是该部分。根据`play.data.validation.Constraints`文档，该类包含几个内置的验证注释。他们在 1.* 和 2.* 版本之间进行了很多更改。

# java - Java 代码在网页中显示不正确

> ID：12380704
> 
> 赞同：1
> 
> 时间：2012-09-12T03:10:04.550
> 
> 标签：java

我刚刚从本地主机上传了一个网站到我的学校服务器，发生了一些奇怪的事情。

[http://helios.ite.gmu.edu/~ccarrin2/IT315/Assignment1/WebContent/index.jsp](http://helios.ite.gmu.edu/~ccarrin2/IT315/Assignment1/WebContent/index.jsp)

本文

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"pageEncoding="ISO-8859-1"%>
<%@ taglib prefix="c"uri="http://java.sun.com/jsp/jstl/core" %> 
```

出于某种原因正在显示。但是在本地主机中却没有。所以现在我所有的 jstl 标签都不起作用，我通过表单与 servlet 的连接也不起作用。我所做的只是将文件移动到服务器并为所有文件设置 755 的权限。我不知道这是好是坏，但这就是我到目前为止所做的。关于为什么会发生这种情况以及我可以做些什么来解决它的任何线索。再一次，在本地主机上它不显示，所有的 jstl 代码都很好。

# oracle - 一个简单的 Oracle 触发器修正

> ID：12380711
> 
> 赞同：1
> 
> 时间：2012-09-12T03:12:30.523
> 
> 标签：oracle, triggers, plsql

我在我们的 Oracle 数据库中找到了一个触发器

```
create or replace trigger pii_user_activation_trigger
  before insert on pii_user_activation
  for each row
begin
  select seq_pii_user_activation.nextval 
    into :new.id 
    from dual;
end; 
```

我不希望触发器在`id`每次插入一行时自动生成。如何修改触发器，使其仅`id`在`INSERT`语句未提供值时生成新触发器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T03:21:08.813

```
create or replace trigger pii_user_activation_trigger
  before insert on pii_user_activation<
  for each row
begin
  IF :new.id IS NULL THEN
    select seq_pii_user_activation.nextval 
      into :new.id 
      from dual;
  END IF;
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T03:21:18.577

听起来你只是想要

```
create or replace trigger pii_user_activation_trigger
  before insert on pii_user_activation
  for each row
begin
  IF( :new.id IS NULL )
  THEN
    select seq_pii_user_activation.nextval 
      into :new.id 
      from dual;
  END IF;
end; 
```

这使得通常合理的假设是没有为列指定非 NULL 默认值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T07:19:02.877

只是另一种方法：

```
create or replace trigger pii_user_activation_trigger
  before insert on pii_user_activation
  for each row
  WHEN (NEW.id IS NULL)
begin
  select seq_pii_user_activation.nextval 
    into :new.id 
    from dual;
end; 
```

`:`（请注意，在WHEN 子句中，您不包括`NEW`.

# javascript - 阻止订单按钮

> ID：12380715
> 
> 赞同：1
> 
> 时间：2012-09-12T03:13:19.067
> 
> 标签：javascript, jquery, asp-classic

我正在寻找一个脚本，该脚本将阻止或删除订单按钮，以防止客户进行两次或三次订购，但不止一次单击该按钮。我不知道这样的东西会被称为什么。但是该站点是用 Classic .asp 开发的。但是我会猜测并说这将是图像按钮上的 javascript 或 jquery？对此的任何建议或观点都会有很大帮助！！！！

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:27:17.590

看到您对 ianpgall 回答的评论后，我认为最好的解决方案是对客户订单进行服务器端检查。

当他们单击按钮并提交表单时，检查他们是否已经将产品添加到他们的购物篮中。如果有，您可以选择不再添加，或要求用户确认。

这允许用户根据需要多次单击按钮，并且还可以防止在用户禁用 javascript 时错误地添加产品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:16:40.690

我认为您指的是“禁用”按钮。例如：

```
<input type="button" id="button1" value="Submit" />

$("#button1").click(function () {
    this.disabled = true;
}); 
```

如果您使用 AJAX，您可以在单击按钮时禁用该按钮，然后在 AJAX 完成时删除该属性。

更新：

提醒一下，这仅在用户启用了 Javascript 时才有效。这是一件很安全的事情，但我只是想让你知道。如果未启用，我不确定如何防止多次点击，而不强制用户启用 Javascript。如果这是一个严重的问题，您可能需要调查一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T03:35:11.853

您可以在单击提交按钮后禁用它，这在大多数情况下会阻止这种情况。在 JavaScript 和 jQuery 中有很多方法可以做到这一点。

这是一个使用 jQuery 的简单示例。提交表单后，它将禁用表单中的任何 SUBMIT 按钮，防止再次按下提交按钮。

```
<script type="text/javascript">
$("form").submit(function(){ 
    $(this).find('input[type=submit]').attr("disabled", "disabled"); 
}); 
</script> 
```

如果您还想防止用户单击返回并再次提交，那么您需要基于 ASP 会话或 cookie 的不同解决方案。

# frameworks - 从模型中的 hasOne 设置的下拉值和 defaultValue

> ID：12380719
> 
> 赞同：0
> 
> 时间：2012-09-12T03:13:38.397
> 
> 标签：frameworks, atk4, php

我有以下模型：

```
class Model_GrantMinimal extends Model_Table {
    public $table='grant';

    function init() {
        parent::init();

        $this->hasOne('User');

        $this->getField('id')->hidden(true);
        $this->getField('user_id')->hidden(true);
        $this->addField('grant_number');
        $this->addField('grant_name');
    }
} 
```

在页面内，我有以下代码：

```
$grant=$this->add('Model_GrantMinimal');
$grant->load($id);
$user=$grant->ref('user_id');
        $field = $grantForm->addField('Dropdown','Manager');
        $field->setModel($user);
        $field
            ->validateNotNull()
            ->add('Icon',null,'after_field')
            ->set('arrows-left3')
            ->addStyle('cursor','pointer')
            ->js('click',$grantForm->js()->reload())
        ; 
```

一切工作几乎完美 - 我如何确保下拉菜单（`$field`在 php 中）链接到整个表单，即当我更改下拉菜单中的值时，该值被传递到`$grantForm->onSubmit`- 以及如何确保`defaultValue`（预下拉列表的选定值）是`user_id`内部设置的用户`GrantMinimal`

到目前为止，我很喜欢这个框架——它确实令人印象深刻，并且来自 .NET 框架，其中 MVVM 和 MVC 如此普遍，特别是与最新的 WPF 相关。与编写 HTML/PHP 的旧方式相比，这是一种享受，只是需要一段时间才能完全理解什么是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T21:05:02.057

经过几个小时的调试跟踪后弄清楚了：

```
class Model_GrantMinimal extends Model_Table {
    public $table='grant';

    function init() {
        parent::init();

        $this->hasOne('User');

        $this->getField('id')->hidden(true);
        $this->getField('user_id')->hidden(true);
        $this->addField('grant_number');
        $this->addField('grant_name');

        $this->hasOne('User');

        $this->getField('user_id')->caption('Manager')->hidden(false);
    }
} 
```

# ruby-on-rails - Rails：使用正则表达式查找没有标点符号的行

> ID：12380720
> 
> 赞同：1
> 
> 时间：2012-09-12T03:13:52.680
> 
> 标签：ruby-on-rails, regex

对此有什么想法吗？我试图在不以任何标点符号结尾的文本块（即段落）中查找行。我对正则表达式完全陌生。

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T03:17:16.970

```
/^.*[^\.!\?]$/ 
```

该正则表达式将匹配任何不以句点、问号或感叹号结尾的行。您还在寻找什么其他标点符号？

# c++ - 对象成员分配

> ID：12380724
> 
> 赞同：0
> 
> 时间：2012-09-12T03:15:07.073
> 
> 标签：c++

我知道用'new'初始化的对象是从堆中分配的，但是它们的成员呢？例如，我有 A 类：

```
class A
{
        private: int a;   //here "a" should be on stack  
}; 
```

然后我分别在以下代码中定义了对象A

```
A a;

A *ap = new A(); 
```

现在第一个语句`a`放在堆栈上并将`ap`在堆中，但是`a.a`and怎么样`ap->a`？他们和他们的父对象在一起吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:18:32.017

是的，根据定义，如果一个对象在堆上，它的成员也是如此，堆栈也是如此。

一个对象实际上只是一块内存，所以因为对象包含成员，所以成员的内存就在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:17:10.767

成员是对象的一部分，就像`struct`.

# excel - VBA: Summing a matrix

> ID：12380725
> 
> 赞同：7
> 
> 时间：2012-09-12T03:15:24.227
> 
> 标签：excel, matrix, vba

Why doesn't this function work?

Type `=funtest(2.1)` in Excel and it'll give me `#VALUE!`.

```
Public Function funtest(a As Double) As Double

Dim z, j, i As Integer
Dim matrix(3, 3, 3) As Double

For z = 0 To 3 Step 1
For j = 0 To 3 Step 1
For i = 0 To 3 Step 1

matrix(z, j, i) = a

Next i, j, z

funtest = Application.WorksheetFunction.Sum(matrix)

End Function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T06:15:26.593

`WorksheetFunction.Sum`将使用范围或二维数组。它出错是因为您传递给它一个 3 维数组。

所以，这行得通

```
Public Function funtest(a As Double) As Double
    Dim z As Long, j As Long, i As Long
    Dim matrix() As Double

    ReDim matrix(0 To 3, 0 To 4)
    For j = LBound(matrix, 1) To UBound(matrix, 1)
    For i = LBound(matrix, 2) To UBound(matrix, 2)
        matrix(j, i) = a
    Next i, j

    funtest = Application.WorksheetFunction.Sum(matrix)
End Function 
```

注意我稍微修改了您的声明，请参阅答案末尾的注释。

要对高维数组求和，您需要进行一些循环。

一种选择（可能适合也可能不适合您的总体要求）是声明您的数组略有不同，如所谓的`Jagged Array`.

```
Public Function funtest2(a As Double) As Double
    Dim z As Long, j As Long, i As Long
    Dim matrix() As Variant
    Dim InnerMatrix(0 To 4, 0 To 4) As Double

    ' Dimension Jagged Array
    ReDim matrix(0 To 4)
    For i = LBound(matrix, 1) To UBound(matrix, 1)
        matrix(i) = InnerMatrix
    Next

    'Load Data into matrix
    For z = LBound(matrix) To UBound(matrix)
    For j = LBound(matrix(z), 1) To UBound(matrix(z), 1)
    For i = LBound(matrix(z), 2) To UBound(matrix(z), 2)
        matrix(z)(j, i) = a
    Next i, j, z

    ' Sum matrix
    For z = LBound(matrix) To UBound(matrix)
        funtest2 = funtest2 + Application.WorksheetFunction.Sum(matrix(z))
    Next
End Function 
```

这是一个二维数组。然后`Sum`依次将其应用于每个内部数组。这样，至少您只循环一个维度，而不是全部三个。

请注意`Dim`，`Integer`
您必须指定所有`As Type`的，否则变量默认为`Variant`
在您的代码中`z`，并且`j`将是`Variants`

此外，在 32 位操作系统上使用`Integer`而不是`Long`实际上会适得其反：`Long`'s 会稍微快一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T04:43:14.163

当您说“我正在尝试解决 (3,3,3) 矩阵的简单情况，其中每个元素都等于某个双精度值 a”时，我将按字面意思理解您。这将做到这一点：

```
Public Function funtest(a As Double) As Double
   funtest = 4*4*4*a
End Function 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T03:54:53.453

首先，当您得到`#VALUE!`这意味着存在错误时，可能意味着使用无效的矩阵。

要回答您的问题，您的代码不起作用，因为您的语法不正确。以下函数从值创建一个矩阵。

```
Function FQ_matrix_create(StartValue As Double, Interval As Double,
nrow As Long, ncol As Long) As Double()
Dim M() As Double
' Creates matrix with sequential element values with given row and
' column sizes. Fills matrix row-wise with numbers.
' - set Interval = 0 for constant element values
' - error input arguments nrow and ncol are not positive integers 
```

要对值求和，请使用：

```
Function FQ_matrix_element_sum(M() As Double, SumOption As
MatrixDirection) As Double()
' Returns the sum of elements of matrix M, either row or column wise
' - Rowwise sum returns a horizontal 1xNcol matrix
' - Columnwise sum returns a vertical 1 xNrow matrix
' - Element sum (all elements) returns a 1x1 matrix
' - error if M is not a matrix
' - error if SumOption is not 1 (nRowWiseSum) or 2 (nColWiseSum) or
3 (nElementSum) 
```

为了帮助您了解 Excel VBA 中的矩阵，这里有一个很好的资源： http: [//finaquant.com/download/matrixvectorvba](http://finaquant.com/download/matrixvectorvba)

具体来说，请查看网站上的 PDF 下载。

# java - ListenableFuture, FutureCallback and timeouts

> ID：12380726
> 
> 赞同：35
> 
> 时间：2012-09-12T03:15:29.243
> 
> 标签：java, guava

Based on the examples of guava I've seen I've been looking for elegant solutions to my problem. Specifically, I like the way [`Futures.addCallback(ListenableFuture, FutureCallback)`](https://github.com/google/guava/blob/v23.0/guava/src/com/google/common/util/concurrent/Futures.java#L1298) works, but I'd like to be able to set a timeout on the length of time that can expire before the FutureCallback is invoked. Optimally It would be nice if breaching the timeout just caused an the failure condition of FutureCallback to be called.

Does Guava have something like this already? Is it just not recommended to try to couple timeouts with the callbacks?

EDIT: Including example of the code that led me to this point. Obviously, I stripped out the meaningful bits to get a minimum example.

```
@Test
public void testFuture()
{
    Callable<Boolean> callable = new Callable<Boolean>()
    {

        @Override
        public Boolean call() throws Exception
        {
            while(true);
        }
    };

    ListenableFuture<Boolean> callableFuture = MoreExecutors.listeningDecorator(Executors.newSingleThreadExecutor()).submit(callable);

    Futures.addCallback(callableFuture, new FutureCallback<Boolean>()
    {

        @Override
        public void onFailure(Throwable arg0)
        {
            System.out.println("onFailure:"+arg0); 
        }

        @Override
        public void onSuccess(Boolean arg0)
        {
            System.out.println("onSuccess:"+arg0);
        }
    }); 

    try
    {
        callableFuture.get(1000, TimeUnit.MILLISECONDS);
    }catch(Throwable t)
    {
        System.out.println("catch:"+t);
    }
} 
```

This code will only print `catch:java.util.concurrent.TimeoutException`.

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-12T21:51:52.073

**更新：**这已被添加到 Guava 作为[`Futures.withTimeout()`](https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/util/concurrent/Futures.html#withTimeout(com.google.common.util.concurrent.ListenableFuture,%20long,%20java.util.concurrent.TimeUnit,%20java.util.concurrent.ScheduledExecutorService)).

* * *

在内部，我们有一个`makeTimeoutFuture`方法，它将 a`Future`作为输入并返回一个`Future`具有相同结果的新方法，*除非*原始方法在给定的截止日期之前没有完成。如果截止日期到期，则输出`Future`的结果设置为 a `TimeoutException`。因此，您可以调用`makeTimeoutFuture`并将侦听器附加到 output `Future`。

`makeTimeoutFuture`不是解决您的问题的最自然的解决方案。事实上，我认为创建该方法的主要目的是为无参数`get()`调用设置硬超时，因为将所需的截止日期传播给所有调用者可能会很痛苦。一个更自然的解决方案是按`get()`原样`get(long, TimeUnit)`推理。这有点笨拙，尽管不如. 在做任何事情之前，我想多考虑一下。您会[提交功能请求](http://code.google.com/p/guava-libraries/issues/entry)吗？`addCallback(ListenableFuture, FutureCallback)``addCallback(ListenableFuture, FutureCallback, long, TimeUnit, SchededuledExecutorService)``makeTimeoutFuture`

（这是我们内部拥有的：）

```
public static <V> ListenableFuture<V> makeTimeoutFuture(
    ListenableFuture<V> delegate,
    Duration duration,
    ScheduledExecutorService scheduledExecutor) 
```

返回一个委托给另一个的未来，但如果指定的持续时间到期，它将提前完成（通过`TimeoutException`包装在 an 中）。`ExecutionException`在这种情况下，委托未来不会被取消。

```
scheduledExecutor.schedule(new Runnable() {
  @Override public void run() {
    TimeoutFuture.this.setException(new TimeoutException("Future timed out"));
  }
}, duration.getMillis(), TimeUnit.MILLISECONDS); 
```

# php - Intl extension in IIS moodle

> ID：12380730
> 
> 赞同：1
> 
> 时间：2012-09-12T03:16:02.897
> 
> 标签：php, apache, iis-7, moodle, intl

I am trying to install intl extension in moodle which is a php application. I've added the lines

```
extension = php_intl.dll 
and 
[intl]
intl.default_locale = en_utf8
intl.error_level = E_WARNING 
```

in my php.ini file. When I do this in apache and copy all the icuu*.dll files in apache/bin folder, I can see the extension in the application. In IIS server, I don't know where to copy the icuu*.dll files and whether I need to copy those files. If I restart without copying, the application still runs but I can't see the extension. Can someone please advise me?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-17T09:34:55.470

我遇到过同样的问题。我试图禁用 php_wincache.dll 扩展并且它有效。然后我可以再次重新启用它。[我从这里http://windows.php.net/download/](http://windows.php.net/download/)使用了来自 zip 包的 VC9 x86 Thread Safe intl extension dll

# wordpress - Wordpress Primary Category

> ID：12380732
> 
> 赞同：2
> 
> 时间：2012-09-12T03:16:20.690
> 
> 标签：wordpress, categories, facebook-social-plugins, permalinks

I recently needed to change my permalink structure in Wordpress. However the change caused all my social sharing counters to reset. I found this great script which I modified below, [http://encosia.com/preserving-social-sharing-counters-through-a-url-change/](http://encosia.com/preserving-social-sharing-counters-through-a-url-change/). I rewrote it so it would remove the %poste-id% at the end of the url on older posts.

The problem is that for the most part this works, however I need it to call the permalink category not the first category in the get_the_category(); array. Is there anyway I can pull this info, or modify this script to work that way? This is also being used in the loop. Thanks!!

```
 <?php
      $url_change_id = 68135;
      $postid = $post->ID;
      $category = get_the_category();
      $slug = $post->post_name;
      $permalink_url = get_permalink();

     if (intval($postid) < $url_change_id) {
        $url_date_prefix = "/" . $category[0]->category_nicename .
                           "/" . $slug .
                           ".html";

        $sharing_url = str_replace($permalink_url,
                                   "http://website.com" . $url_date_prefix,
                                   $permalink_url);                        

      } else {
          $sharing_url = get_permalink();

     }
    ?>

    <?php echo $sharing_url; ?> 
```

# c++ - C++ undefined symbol

> ID：12380738
> 
> 赞同：0
> 
> 时间：2012-09-12T03:16:58.327
> 
> 标签：c++, file-io, istream, ostream

I am creating a C++ console application where I am saving and loading a vector to a file. The file I am saving and loading has a header that has the size of the vector.

Here is my code:

```
void loadFromFile()
    {
        ifstream iStream("file.ext", ios::binary);
        fileHeader_t fHeader;
        iStream.read((char*)&fHeader, sizeof(fileHeader_t));
        if (fHeader.magicNumber = 0xDEADBEAF)
        {
            appointments.resize(fHeader.appointmentCount); iStream.read((char*)&appointments[0], fHeader.appointmentCount * sizeof(appointment));
        }
    }
    void saveToFile()
    {
        ofstream oStream("file.ext", ios::binary);
        fileHeader_t fHeader;
        fHeader.magicNumber = 0xDEADBEAF;
        fHeader.appointmentCount = appointments.size();
        oStream.write((char*)&fHeader, sizeof(fileHeader_t));
        oStream.write((char*)&appointments[0], sizeof(appointment) * appointments.size());
    } 
```

And here is the header struct:

```
struct fileHeader_s
{
DWORD magicNumber;
size_t appointmentsCount;
}fileHeader_t; 
```

I am getting the following errors:

> E2379 Statement missing ; E2451 Undefined symbol 'fHeader'

At the following lines:

```
fileHeader_t fHeader; 
```

Why is this happening, and more importantly, how can I fix it?

Thanks

**Update**

Here is my full code:

```
class appointment
{
public:
    appointment(string aDate, string aTime, string aType,
    string aLocation, string aComments, bool aIsImportant,
    string aReminderDate, string aReminderTime)
    {
        appDate = aDate;
        appTime = aTime;
        appType = aType;
        appLocation = aLocation;
        appComments = aComments;
        appIsImportant = aIsImportant;
        appReminderDate = aReminderDate;
        appReminderTime = aReminderTime;
    }
    void setDate(string aDate)
    {
        appDate = aDate;
    }
    void setTime(string aTime)
    {
        appTime = aTime;
    }
    void setType(string aType)
    {
        appType = aType;
    }
    void setLocation(string aLocation)
    {
        appLocation = aLocation;
    }
    void setComments(string aComments)
    {
        appComments = aComments;
    }
    void setIsImportant(bool aIsImportant)
    {
        appIsImportant = aIsImportant;
    }
    void setReminderDate(string aReminderDate)
    {
        appReminderDate = aReminderDate;
    }
    void setReminderTime(string aReminderTime)
    {
        appReminderTime = aReminderTime;
    }
    string getDate()
    {
        return appDate;
    }
    string getTime()
    {
        return appTime;
    }
    string getType()
    {
        return appType;
    }
    string getLocation()
    {
        return appLocation;
    }
    string getComments()
    {
        return appComments;
    }
    bool getIsImportant()
    {
        return appIsImportant;
    }
    string getReminderDate()
    {
        return appReminderDate;
    }
    string getReminderTime()
    {
        return appReminderTime;
    }
private:
    appointment();
    string appDate;
    string appTime;
    string appType;
    string appLocation;
    string appComments;
    bool appIsImportant;
    string appReminderDate;
    string appReminderTime;
    //person owner;
};

class calendar
{
public:
    calendar()
    {
        loadFromFile();
    }
    ~calendar()
    {
        saveToFile();
    }

    void createAppointment(string aDate, string aTime, string aType, string aLocation, string aComments, bool aIsImportant, string aReminderDate, string aReminderTime)
    {
        appointment newAppointment(aDate, aTime, aType, aLocation, aComments, aIsImportant, aReminderDate, aReminderTime);
        appointments.push_back(newAppointment);
    }

private:
    vector<appointment> appointments;
    string calCurrentDate;
    string calCurrentTime;
    void loadFromFile()
    {
        ifstream iStream("file.ext", ios::binary);
        fileHeader_t fHeader;
        iStream.read((char*)&fHeader, sizeof(fileHeader_t));
        if (fHeader.magicNumber = 0xDEADBEAF)
        {
            appointments.resize(fHeader.appointmentCount); iStream.read((char*)&appointments[0], fHeader.appointmentCount * sizeof(appointment));
        }
    }
    void saveToFile()
    {
        ofstream oStream("file.ext", ios::binary);
        fileHeader_t fHeader;
        fHeader.magicNumber = 0xDEADBEAF;
        fHeader.appointmentCount = appointments.size();
        oStream.write((char*)&fHeader, sizeof(fileHeader_t));
        oStream.write((char*)&appointments[0], sizeof(appointment) * appointments.size());
    }
    typedef struct fileHeader_s
    {
        DWORD magicNumber;
        size_t appointmentCount;
    }fileHeader_t;
}; 
```

I am getting the following 2 errors:

[BCC32 Warning] Person.cpp(271): W8060 Possibly incorrect assignment Full parser context Person.cpp(245): class calendar Person.cpp(290): decision to instantiate: void calendar::loadFromFile() --- Resetting parser context for instantiation... Person.cpp(267): parsing: void calendar::loadFromFile()

[BCC32 Error] vector(608): E2247 'appointment::appointment()' is not accessible Full parser context vector(607): decision to instantiate: void vector >::resize(unsigned int) --- Resetting parser context for instantiation... Person.cpp(18): #include c:\program files (x86)\embarcadero\rad studio\9.0\include\dinkumware\vector vector(8): namespace std vector(330): class vector<_Ty,_Ax> vector(607): parsing: void vector >::resize(unsigned int)

Can I please have some help to fix this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:18:27.447

您在结构定义中缺少 typedef 关键字。

```
typedef struct fileHeader_s
{

}fileHeader_t; 
```

但是，在 C++ 中， typedef 关键字不是必需的。在这种情况下，结构名称仍然是`fileHeader_s`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:18:49.357

我想你想要的是一个`typedef`

```
typedef struct fileHeader_s
{
DWORD magicNumber;
size_t appointmentsCount;
}fileHeader_t; 
```

# java - 继承类设计（Java）

> ID：12380743
> 
> 赞同：0
> 
> 时间：2012-09-12T03:17:48.753
> 
> 标签：java, inheritance, class-design

对于一个小游戏，我想设计两个应该绘制我的单位的类。我有课程`Unit`并且`Settler`扩展了`Unit`.

为了绘制它们，我有类`UnitView`和`SettlerView`.

现在`UnitView`有一个方法`public void draw(Graphics g)`，`SettlerView`应该使用相同的方法。这两个类的区别应该在于它们获取信息以绘制单元的方式。假设`Units`它们总是蓝色并且`Settlers`有一个取决于他们的健康状况的颜色（这将是一个字段`Settler`，`SettlerView`可以访问）。

什么是实现它的正确方法？我想要一个干净的设计，没有像`setColor`.

编辑：这是我的第一种方法：

```
public class UnitView {
    private Unit unit;
    public Color color; // I don't want to make it public. Setting it private + getter/setter does not seem to be different to me.
    private color calculateColor() { ...uses the information of unit... }
    public void draw(Graphics g) { ...something using the Color... }

}

public class SettlerView extends UnitView {
    private Settler settler;

    private color calculateColor() { ...this method overides the one of UnitView.... }
} 
```

我想用多态来调用UnitView.draw。关键是公共字段颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:27:57.297

了解多态性：

[http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)

UnitView 和 SettlerView 应该派生自具有 draw() 方法的基类。您可以将其抽象化，以便所有子类都必须实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:27:20.970

您始终可以覆盖父绘图方法。

例如，如果父方法是

```
public void draw(Graphic g){
     g.setColor(blue);
} 
```

子班将有

```
@Override
public void draw(Graphic g){        
    if  (this.health > 50){
        g.setColor(green);
    }else{
        g.setColor(red);
    }
    super.draw(g); // if you want to call the parent draw and just change color
} 
```

# ruby - 用户登录/会话系统说明

> ID：12380744
> 
> 赞同：0
> 
> 时间：2012-09-12T03:18:03.127
> 
> 标签：ruby, session, sinatra

我正在构建我的第一个 Web 应用程序，并且对于如何处理登录/会话之类的事情，我有所有这些疯狂的想法，但我想知道是否有人写了关于登录/会话如何工作的非常好的、详尽的描述。我看过教程，但我想知道是否有更抽象的东西可以让读者更全面地了解整个过程是如何处理的。如果相关的话，我的网络应用程序在 ruby​​/sinatra 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T14:52:29.057

不幸的是，大多数从头开始登录/身份验证的深入教程都是针对 Rails 的。我在寻找 Sinatra 特定教程时遇到了同样的麻烦。我建议只查看面向 Rails 的教程，因为这些知识非常笼统，也可以应用于 Sinatra。

这些来自 RailsGuides 的指南非常适合理解身份验证，即使它们是特定于 Rails 的（特别是阅读安全部分）：

[http://guides.rubyonrails.org/](http://guides.rubyonrails.org/)

这是 github 上一个好的 Sinatra 身份验证方案的示例（它使用 datamapper gem，但您可以轻松地将其替换为任何其他 Ruby [ORM](http://en.wikipedia.org/wiki/Object-relational_mapping)）：

[https://github.com/daddz/sinatra-dm-login](https://github.com/daddz/sinatra-dm-login)

如果您对自己滚动不感兴趣，也可以尝试使用 sinatra-authentication gem：

[https://github.com/maxjustus/sinatra-authentication](https://github.com/maxjustus/sinatra-authentication)

# installation - SugarCRM 门户安装允许通话时间通过参考

> ID：12380747
> 
> 赞同：0
> 
> 时间：2012-09-12T03:18:19.070
> 
> 标签：installation, portal, sugarcrm, php-ini

我正在本地主机上安装 SugarCRM Portal。在安装向导中，它说我必须打开允许呼叫时间通过参考，我在 php.ini 做了并停止了我的 apache 服务器。当我再次启动它时，发生了一个错误，说有一个致命错误。

这是我的日志中的错误

> “致命错误：指令 'allow_call_time_pass_reference' 在 PHP 中不再可用”

如果所有设置都为绿色，我将无法继续安装。这是唯一阻碍我的东西。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:56:23.033

它在 PHP 文档中说这个配置选项已经从 PHP 5.4.0 开始被删除。 [http://php.net/manual/en/ini.core.php](http://php.net/manual/en/ini.core.php)

如果您的 php 版本高于 PHP 5.4.0，请尝试降级 PHP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T08:16:59.930

我懂了

air4x 的评论是正确的，但不详细，所以我在这里给出详细的。

你所要做的就是去sugarportal_dir/install/然后打开checkSystem.php。有一个看起来像这样的 if 语句。

```
 if('0' == ini_get('allow_call_time_pass_reference')) {

   } 
```

您所要做的就是将 0 更改为 1：

```
 if('1' == ini_get('allow_call_time_pass_reference')) {

   } 
```

就是这样。希望对其他人有所帮助。感谢air4x的回复，您的逻辑是正确的。

# c - 错误：函数返回局部变量的地址

> ID：12380758
> 
> 赞同：49
> 
> 时间：2012-09-12T03:19:44.337
> 
> 标签：c, return, strcpy, strcat

我是 C 的初学者，我正在自学。我正在创建以下功能：

```
char *foo(int x){
     if(x < 0){
        char a[1000];
        char b = "blah";
        x = x - 1;
        char *c = foo(x);
        strcpy(a, b);
        strcat(a, c);
        return a;
      }
    blah ...
} 
```

我基本上是在尝试返回附加的字符串，但出现以下错误：

“错误：函数返回局部变量的地址”，任何建议，如何解决这个问题？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-09-12T03:23:34.313

局部变量的生命周期仅在定义它的块内扩展。当控件超出定义局部变量的块时，不再分配变量的存储空间（不保证）。因此，在变量的生命周期之外使用变量的内存地址将是未定义的行为。

另一方面，您可以执行以下操作。

```
 char *str_to_ret = malloc (sizeof (char) * required_size);
  .
  .
  .
 return str_to_ret; 
```

并`str_to_ret`改用。并且在`return`ing时，将返回`str_to_ret`分配的地址。`malloc`分配的内存`malloc`是从堆中分配的，堆的生命周期跨越程序的整个执行。因此，您可以在程序运行时从任何块和任何时间访问内存位置。

另请注意，在完成分配的内存块后，它是一种很好的做法，`free`以防止内存泄漏。释放内存后，您将无法再次访问该块。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2017-02-22T13:06:35.293

我想出了这个简单直接（我希望如此）的代码示例，它应该可以自我解释！

```
#include <string.h>
#include <stdio.h>
#include <stdlib.h>

/* function header definitions */
char* getString();                     //<- with malloc (good practice)
char * getStringNoMalloc();  //<- without malloc (fails! don't do this!)
void getStringCallByRef(char* reference); //<- callbyref (good practice)

/* the main */
int main(int argc, char*argv[]) {

    //######### calling with malloc
    char * a = getString();
    printf("MALLOC ### a = %s \n", a); 
    free(a);

    //######### calling without malloc
    char * b = getStringNoMalloc();
    printf("NO MALLOC ### b = %s \n", b); //this doesnt work, question to yourself: WHY?
    //HINT: the warning says that a local reference is returned. ??!
    //NO free here!

    //######### call-by-reference
    char c[100];
    getStringCallByRef(c);
    printf("CALLBYREF ### c = %s \n", c);

    return 0;
}

//WITH malloc
char* getString() {

    char * string;
    string = malloc(sizeof(char)*100);

    strcat(string, "bla");
    strcat(string, "/");
    strcat(string, "blub");

    printf("string : '%s'\n", string);

    return string;
}

//WITHOUT malloc (watch how it does not work this time)
char* getStringNoMalloc() {

     char string[100] = {};

     strcat(string, "bla");
     strcat(string, "/");
     strcat(string, "blub");
     //INSIDE this function "string" is OK
     printf("string : '%s'\n", string);

     return string; //but after returning.. it is NULL? :)
}

// ..and the call-by-reference way to do it (prefered)
void getStringCallByRef(char* reference) {

    strcat(reference, "bla");
    strcat(reference, "/");
    strcat(reference, "blub");
    //INSIDE this function "string" is OK
    printf("string : '%s'\n", reference);
    //OUTSIDE it is also OK because we hand over a reference defined in MAIN
    // and not defined in this scope (local), which is destroyed after the function finished
} 
```

编译它时，您会收到 [intended] 警告：

```
me@box:~$ gcc -o example.o example.c 
example.c: In function ‘getStringNoMalloc’:
example.c:58:16: warning: function returns address of local variable [-Wreturn-local-addr]
         return string; //but after returning.. it is NULL? :)
            ^~~~~~ 
```

...基本上我们在这里讨论的内容！

运行我的示例会产生以下输出：

```
me@box:~$ ./example.o 
string : 'bla/blub'
MALLOC ### a = bla/blub 
string : 'bla/blub'
NO MALLOC ### b = (null) 
string : 'bla/blub'
CALLBYREF ### c = bla/blub 
```

*理论：*

用户@phoxis 已经很好地回答了这个问题。基本上这样想：**{**和**}**之间的所有内容都是*本地*范围，因此 C-Standard 在外部是“未定义的”。通过使用 malloc，您可以从*HEAP*（程序范围）而不是从*STACK*（函数范围）获取内存 - 因此它从外部“可见”。第二种正确的方法是*call-by-reference*。在这里，您在父范围内定义 var，因此它使用 STACK（因为父范围是**main()**）。

*概括：*

3 种方法，其中一种是错误的。C 有点笨拙，只是让一个函数返回一个动态大小的字符串。要么你必须 malloc 然后释放它，要么你必须通过引用调用。或者使用 C++ ;)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-09-20T17:25:24.410

不需要 malloc 或按引用调用。您可以在函数中声明一个指针并将其设置为您想要返回的字符串/数组。

使用@Gewure 的代码作为基础：

```
char *getStringNoMalloc(void){
    char string[100] = {};
    char *s_ptr = string;

    strcat(string, "bla");
    strcat(string, "/");
    strcat(string, "blub");
    //INSIDE this function "string" is OK
    printf("string : '%s'\n", string);

    return s_ptr; 
} 
```

完美运行。

使用原始问题中代码的非循环版本：

```
char *foo(int x){    
    char a[1000];
    char *a_ptr = a;
    char *b = "blah";       

    strcpy(a, b);

    return a_ptr;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-12T03:23:13.490

`a`是函数的本地数组。一旦函数返回，它就不再存在，因此您不应该返回局部变量的地址。
换句话说，它的***生命周期***在函数`a`的作用域（`{`，`}`）内，如果你返回一个指向它的指针，你所拥有的是一个指向一些无效内存的指针。此类变量也称为***自动***变量，因为它们的生命周期是自动管理的，您无需显式管理它。

由于您需要扩展变量以使其超出函数的范围，因此您需要在堆上分配一个数组并返回一个指向它的指针。

```
char *a = malloc(1000); 
```

这样，数组`a`驻留在内存中，直到您`free()`在同一地址上调用 a 。
不要忘记这样做，否则最终会导致内存泄漏。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-12T03:24:13.540

这一行：

```
char b = "blah"; 
```

不好 - 你的左值需要是一个指针。

您的代码也有堆栈溢出的危险，因为您的递归检查没有限制 x 的递减值。

无论如何，您收到的实际错误消息是因为`char a`是一个自动变量；你的那一刻`return`，它将不复存在。您需要的不是自动变量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-12T03:22:19.513

`a`在函数中本地定义，不能在函数外使用。如果你想`char`从函数返回一个数组，你需要动态分配它：

```
char *a = malloc(1000); 
```

并在某个时候调用`free`返回的指针。

您还应该在此行看到警告`char b = "blah";`：：您正在尝试将字符串文字分配给`char`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-08T23:30:08.373

```
char b = "blah"; 
```

应该：

```
char *b = "blah"; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-26T09:20:41.807

所有的答案都很好地解释了这个问题。

但是，我想添加另一个信息。

> 当我希望函数的输出成为向量时，我遇到了同样的问题。

在这种情况下，常见的解决方案是将输出声明为函数本身的参数。这样，`alloc`存储信息所需的变量和物理空间在函数外部进行管理。解释经典解决方案的伪代码是：

```
void function(int input, int* output){
    //...
    output[0] = something;
    output[1] = somethig_else;
    //...
    return;
} 
```

在这种情况下，问题中的示例代码应更改为：

```
void foo(int x, char* a){
     if(x < 0){
        char b = "blah";
        //...
        strcpy(a, b);
        //..
        return;
      }
    //..
} 
```

# html - css 边框宽度百分比

> ID：12380759
> 
> 赞同：5
> 
> 时间：2012-09-12T03:19:54.630
> 
> 标签：html, css, border

我有一个 div 像这样包裹另一个

```
<div id="container"><div id="box"></div></div> 
```

假设容器的尺寸为 100 像素 x 100 像素。我想框有 0px 高度和 0px 宽度。但是，我希望盒子的左边框填满容器的 50%，而盒子的右边框填满容器的其他 50%。

我如何用css做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T05:19:49.480

你可以做你想做的事，但使用线性渐变而不是边框​​。

使用以下标记：

```
<div class="box"></div>​ 
```

以及以下样式（例如：http: [//jsfiddle.net/HxbnK/](http://jsfiddle.net/HxbnK/)）：

```
.box {
    background-image: linear-gradient(154deg, red 50%, transparent 50%),
                      linear-gradient(26deg, red 50%, transparent 50%);
    background-position: 0 0, 100% 0;
    background-repeat: no-repeat;
    background-size: 50% 100%;
    height: 100px;
    width: 100px;
}​ 
```

请记住，`.box`元素必须是正方形才能正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-20T10:31:32.123

改成`px`喜欢`vw`就好

```
border-width: 10px; 
```

到

```
border-width: 10vw; 
```

它做什么百分比做什么......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T03:23:52.957

没有手动计算并指定`50px`为边框宽度，您不能。该`border-width`属性只接受长度或关键字`thin`,`medium`和`thick`。

正如 Saad Imran 建议的那样，您也许可以只使用两个`div`宽度为 50% 的 s。

# neo4j - 一个非常基本的 Neo4J 密码不工作

> ID：12380760
> 
> 赞同：2
> 
> 时间：2012-09-12T03:20:03.060
> 
> 标签：neo4j, cypher

关于 Neo4j，我是菜鸟。我一直在尝试通过使用网站管理员中的控制台来学习 Cypher。但似乎有一些我不知道的怪癖，或者配置设置不正确。

例如：在以下 URL 处，提供了一个非常简单的 Cypher（参见下面的代码） [http://docs.neo4j.org/chunked/1.7.2/shell-commands.html#_query_with_cypher](http://docs.neo4j.org/chunked/1.7.2/shell-commands.html#_query_with_cypher)

当我在 Neo4j 管理网站的控制台上执行以下 Cypher 时，出现错误：

```
开始 n = (0) 返回 n
==> SyntaxException：此处应为节点或关系
==> "开始 m = (0) 返回 m"

```

但是，如果我执行以下 Cypher。请注意，我在“（0）”之前添加了“节点”。一切正常：

```
开始 n = node(0) 返回 n
==> +------------+
==> | n |
==> +------------+
==> | 节点[0]{} |
==> +------------+
==> 1 行，0 毫秒

```

似乎我看到的许多例子在类似的场景中都没有包含“节点”这个词。这应该是预期的还是我做错了什么？

我在 Windows Server 2008 上运行 Neo4j 版本 1.7.2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T06:35:56.087

只需使用单词节点。

[在这里](http://neo4j.org/wp-content/uploads/2012/07/Neo4j_CheatSheet_v3.pdf)，您可以找到可能有用的备忘单。

这是另一个可能对学习/理解 Cypher 有用的演示文稿[。](http://www.slideshare.net/maxdemarzi/cypher-12154713)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T18:57:38.550

根据 Neo4J 文档，从 1.4.2 版本到 1.5.3 版本发生了变化，我相信这个关键字曾经是可选的，但现在是必需的。

Neo4J 版本 1.4.2 文档 [http://docs.neo4j.org/chunked/1.4.2/query-start.html](http://docs.neo4j.org/chunked/1.4.2/query-start.html)

```
开始 n=(1) 返回 n

```

Neo4J 版本 1.5.3 文档 [http://docs.neo4j.org/chunked/1.5.3/query-start.html](http://docs.neo4j.org/chunked/1.5.3/query-start.html)

```
开始 n=节点（1）
返回 n

```

除非我加载 Neo4J 版本 1.4.2，否则我无法确定，但我相信“节点”在 Neo4j 版本 1.4.2 中可能是可选的。现在从 1.5.3 版开始，似乎需要“节点”。

# ruby-on-rails - 嵌套受保护模型的“无法批量分配受保护属性”

> ID：12380761
> 
> 赞同：3
> 
> 时间：2012-09-12T03:20:17.177
> 
> 标签：ruby-on-rails, ruby, nested-attributes, mass-assignment

我有时间试图让这个嵌套模型工作。我已经尝试了各种复数形式/单数形式，完全删除了 attr_accessible，谁知道还有什么。

餐厅.rb：

```
# == RESTAURANT MODEL
#
# Table name: restaurants
#
#  id         :integer          not null, primary key
#  name       :string(255)
#  created_at :datetime         not null
#  updated_at :datetime         not null
#

class Restaurant < ActiveRecord::Base
  attr_accessible :name, :job_attributes

  has_many    :jobs
  has_many    :users, :through => :jobs
  has_many    :positions

  accepts_nested_attributes_for :jobs, :allow_destroy => true

  validates :name, presence: true

end 
```

工作.rb：

```
# == JOB MODEL
#
# Table name: jobs
#
#  id            :integer          not null, primary key
#  restaurant_id :integer
#  shortname     :string(255)
#  user_id       :integer
#  created_at    :datetime         not null
#  updated_at    :datetime         not null
#

class Job < ActiveRecord::Base
  attr_accessible :restaurant_id, :shortname, :user_id

  belongs_to    :user
  belongs_to    :restaurant
  has_many      :shifts

  validates :name, presence: false

end 
```

餐厅控制器.rb：

```
class RestaurantsController < ApplicationController

  before_filter :logged_in, only:  [:new_restaurant]

  def new
    @restaurant = Restaurant.new
    @user = current_user
  end

  def create
    @restaurant = Restaurant.new(params[:restaurant])
    if @restaurant.save
      flash[:success] = "Restaurant created."  
      redirect_to welcome_path
    end
  end

end 
```

新的.html.erb：

```
<% provide(:title, 'Restaurant') %>

  <%= form_for @restaurant do |f| %>
        <%= render 'shared/error_messages' %>

        <%= f.label "Restaurant Name" %>
        <%= f.text_field :name %>

        <%= f.fields_for :job do |child_f| %>

              <%= child_f.label "Nickname" %>
              <%= child_f.text_field :shortname %>

        <% end %>

        <%= f.submit "Done", class: "btn btn-large btn-primary" %>

  <% end %> 
```

输出参数：

```
{"utf8"=>"✓",
 "authenticity_token"=>"DjYvwkJeUhO06ds7bqshHsctS1M/Dth08rLlP2yQ7O0=",
 "restaurant"=>{"name"=>"The Pink Door",
 "job"=>{"shortname"=>"PD"}},
 "commit"=>"Done"} 
```

我收到的错误是：

```
ActiveModel::MassAssignmentSecurity::Error in RestaurantsController#create

Cant mass-assign protected attributes: job
Rails.root: /home/johnnyfive/Dropbox/Projects/sa

Application Trace | Framework Trace | Full Trace
app/controllers/restaurants_controller.rb:11:in `new'
app/controllers/restaurants_controller.rb:11:in `create' 
```

任何人都知道如何让它工作*？*谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:24:26.343

在餐厅.rb 中：

它应该 `attr_accessible :name, :jobs_attributes` 代替 `attr_accessible :name, :job_attributes`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T09:34:50.037

关于您的最后一条评论：您可以在工作表中提交 user_id，这应该将 user_id 提交给模型

# objective-c - iOS：释放正在使用的对象 (ARC)

> ID：12380763
> 
> 赞同：1
> 
> 时间：2012-09-12T03:20:28.907
> 
> 标签：objective-c, ios, delegates, automatic-ref-counting, autorelease

我创建了一个订阅一些 NSNotificationCenter 通知的对象，但它正在被释放，因为我没有指向实例化的指针。实例化有一个委托，它将调用一个方法回我拥有的另一个类，所以我觉得没有必要也有一个指向它的指针，因为指针没有任何用途。

基本上，我有一个类 DelegateListener 的实例化（名称仅用于示例目的），它订阅了一些 default`NSNotificationCeneter`的通知。在实例化结束后，该实例化不会分配给任何指针。然而，实例化有一个属性，委托。我在实例化期间为该委托分配了一个值。该委托实现了我希望 DelegateListener 在它订阅的通知触发时调用的方法。

这样做的问题是我创建的 DelegateListener 的实例化被释放，除非我将它分配给一个保留的指针。有没有办法避免在 ARC 中自动释放我的 DelegateListener 实例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:36:16.033

`DelegateListener`如果您没有多个实例，则应将实例存储在静态变量中。

> 我觉得没有必要也有一个指向它的指针，因为指针没有任何用途。

指针确实（或至少*应该*）服务于一个目的：当您不再需要收听通知时，您应该取消订阅`DelegateListener`接收它们。至少，当您的应用程序进入后台（除非它的目的是执行后台处理）以及您的应用程序终止时，这应该发生。

```
[[NSNotificationCenter defaultCenter] removeObserver:delegateListener]; 
```

# html - 输入标签的名称属性可以简单地是一个整数吗？

> ID：12380764
> 
> 赞同：2
> 
> 时间：2012-09-12T03:20:29.223
> 
> 标签：html

输入标签的名称是否允许只是整数？

```
<input type="text" name="34" /> 
```

只是问我是否是一个懒惰的程序员。或者，如果我有大量任意字段并且它们的名称并不重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T04:34:16.427

是的，该[`name`属性](http://www.w3.org/TR/html401/interact/forms.html#adef-name-INPUT)被声明为采用 CNAME 值，这意味着任何字符串，没有施加约束。HTML5 不会改变这一点，除非它不允许空字符串；[它的定义](http://www.w3.org/TR/html5/attributes-common-to-form-controls.html#attr-fe-name)明确指出：“名称的任何非空值都是允许的”。

人们有时会将`name`属性与`id`属性混淆，根据 HTML 版本存在各种限制（例如，某些版本禁止以数字开头的值）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T03:21:42.943

是的他们可以。我不会推荐它，但是使用数字作为`name`属性并没有错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-21T04:29:32.253

不，使用整数是有效的，但它会被转换成字符串。

> 内容属性是您从内容（HTML 代码）设置的属性，您可以通过 element.setAttribute() 或 element.getAttribute() 设置或获取它。即使预期值应该是整数，内容属性也**始终是字符串。**例如，要使用 content 属性将元素的 maxlength 设置为 42，您必须对该元素调用 setAttribute("maxlength", "42")。

参考：[https ://developer.mozilla.org/en-US/docs/Web/HTML/Attributes](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T03:25:40.160

它在 HTML5 中有效，但我会避免它。但是，由于自关闭标记，您的代码仍然*不是有效的 HTML5。*它应该是：

```
<input type="text" name="34"> 
```

# python-2.6 - 如何使用 python...capture.py 从数码相机远程拍照？

> ID：12380772
> 
> 赞同：0
> 
> 时间：2012-09-12T03:21:54.593
> 
> 标签：python-2.6

我想用我的尼康 Coolpix 和尼康 D5000 数码相机用 python 远程拍照。

我已经从`pyusb`.

当我运行 capture.py 脚本时，会出现以下错误：

```
"Attribute Error:  'module' object has no attribute 'findptps'" 
```

错误所指的代码行在 capture.py 中：

```
ptpTransport = PtpUsbTransport(PtpUsbTransport.findptps()[0]) 
```

这个错误是由什么引起的？将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T06:09:02.607

你可能做过：

```
import PtpUsbTransport 
```

代替：

```
from PtpUsbTransport import PtpUsbTransport 
```

# ruby-on-rails - Rails 初学者 - 查询多个表以一次检索大量信息的最佳实践

> ID：12380775
> 
> 赞同：0
> 
> 时间：2012-09-12T03:22:09.627
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我是 Rails 初学者，为了学习它，我正在构建一个简单的时间跟踪应用程序。我想用来自许多具有嵌套信息的表的大量信息来填充管理员的仪表板。

查询数据库以请求一家公司的所有数据以查看所有客户、项目、任务、调整和会议记录的仪表板的最佳实践是什么？

以下是数据的结构方式：

公司拥有_众多客户

客户所属_公司有_许多项目

项目属于_to client has_many tasks

任务属于_to 项目 has_many 分钟

分belongs_to任务

* * *

这种数据结构可能真的很糟糕。我不知道。

数据的示例视图：

动视
-- 网站重新设计
--- 开发
---- 100 分钟

我从这个开始，但我很漂亮，但它可能完全倒退（用户属于公司）：

```
 @clients = Client.find_all_by_company_id(current_user.company_id)
    @clients.each do |client| 

        project = Project.find_all_by_client_id(client.id)
        puts project.name

        project.each do |project|

            task = Task.find_all_by_project_id(project.id)
            puts task.name

        end
    end 
```

我想这个问题也可以问：有没有一本好书或资源可以完整描述 Rails ActiveRecord 最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T04:55:06.290

这会产生与您相同的结果

```
@clients = current_user.company.clients
@clients.each do |client| 
    projects = client.projects

    # puts project.name # makes no sense here

    projects.each do |project|

        project.tasks.each do |task|
            puts task.name
        end
    end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T05:02:54.320

使用该`includes`方法急切地加载关联。

[指南](http://guides.rubyonrails.org/active_record_querying.html#nested-associations-hash)中的示例

```
Category.includes(:posts => [{:comments => :guest}, :tags]).find(1) 
```

根据你说的，应该是：

```
require 'active_record'
require 'logger'

# =====  Config  =====
ActiveRecord::Base.establish_connection adapter: 'sqlite3', database: ':memory:'
ActiveRecord::Base.logger = Logger.new $stdout
ActiveSupport::LogSubscriber.colorize_logging = false

# =====  Schema  =====
ActiveRecord::Schema.define do
  self.verbose = false

  create_table :clients do |t|
    t.string  :name
    t.integer :company_id
  end

  create_table :companies do |t|
    t.string :name
  end

  create_table :projects do |t|
    t.string  :name
    t.integer :client_id
  end

  create_table :tasks do |t|
    t.string  :name
    t.integer :project_id
  end

  create_table :minutes do |t|
    t.integer :quantity
    t.integer :task_id
  end
end

# =====  Classes  =====
class Company < ActiveRecord::Base
  has_many :clients
end

class Client < ActiveRecord::Base
  belongs_to :company
  has_many   :projects
end

class Project < ActiveRecord::Base
  belongs_to :client
  has_many   :tasks
end

class Task < ActiveRecord::Base
  belongs_to :project
  has_many   :minutes
end

class Minute < ActiveRecord::Base
  belongs_to :task
end

# =====  Data  =====
Company.create! name: 'Activision' do |company|
  company.clients.build name: 'Robert Kotick' do |client|
    client.projects.build name: 'Website Redesign' do |project|
      project.tasks.build name: 'Development' do |task|
        task.minutes.build quantity: 100
      end
    end
  end
end

# =====  Querying and displaying  =====
company = Company.find_by_name 'Activision'
clients = Client.includes(projects: {tasks: :minutes}).where(company_id: company.id)

print "\n----- The query makes four requests, regardless of how much data you have. -----\n\n"
clients.inspect # do this to force loading since AR queries are lazy

print "\n----- some representation of the data (notice no queries while iterating through) -----\n\n"
clients.each do |client|
  puts client.name
  client.projects.each do |project|
    puts "-- #{project.name}"
    project.tasks.each do |task|
      puts "--- #{task.name}"
      task.minutes.each do |minute|
        puts "---- #{minute.quantity}"
      end
    end
  end
end

# =====  Output =====

# >> D, [2012-09-12T00:01:42.755414 #72855] DEBUG -- :    (0.7ms)  select sqlite_version(*)
# >> D, [2012-09-12T00:01:42.755890 #72855] DEBUG -- :    (0.2ms)  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar(255), "company_id" integer) 
# >> D, [2012-09-12T00:01:42.756327 #72855] DEBUG -- :    (0.1ms)  CREATE TABLE "companies" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar(255)) 
# >> D, [2012-09-12T00:01:42.756728 #72855] DEBUG -- :    (0.1ms)  CREATE TABLE "projects" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar(255), "client_id" integer) 
# >> D, [2012-09-12T00:01:42.757122 #72855] DEBUG -- :    (0.1ms)  CREATE TABLE "tasks" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar(255), "project_id" integer) 
# >> D, [2012-09-12T00:01:42.757531 #72855] DEBUG -- :    (0.1ms)  CREATE TABLE "minutes" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "quantity" integer, "task_id" integer) 
# >> D, [2012-09-12T00:01:42.906877 #72855] DEBUG -- :    (0.0ms)  begin transaction
# >> D, [2012-09-12T00:01:42.909242 #72855] DEBUG -- :   SQL (0.5ms)  INSERT INTO "companies" ("name") VALUES (?)  [["name", "Activision"]]
# >> D, [2012-09-12T00:01:42.934937 #72855] DEBUG -- :   SQL (24.7ms)  INSERT INTO "clients" ("company_id", "name") VALUES (?, ?)  [["company_id", 1], ["name", "Robert Kotick"]]
# >> D, [2012-09-12T00:01:42.936110 #72855] DEBUG -- :   SQL (0.1ms)  INSERT INTO "projects" ("client_id", "name") VALUES (?, ?)  [["client_id", 1], ["name", "Website Redesign"]]
# >> D, [2012-09-12T00:01:42.937001 #72855] DEBUG -- :   SQL (0.1ms)  INSERT INTO "tasks" ("name", "project_id") VALUES (?, ?)  [["name", "Development"], ["project_id", 1]]
# >> D, [2012-09-12T00:01:42.937767 #72855] DEBUG -- :   SQL (0.1ms)  INSERT INTO "minutes" ("quantity", "task_id") VALUES (?, ?)  [["quantity", 100], ["task_id", 1]]
# >> D, [2012-09-12T00:01:42.938005 #72855] DEBUG -- :    (0.0ms)  commit transaction
# >> D, [2012-09-12T00:01:42.939882 #72855] DEBUG -- :   Company Load (0.1ms)  SELECT "companies".* FROM "companies" WHERE "companies"."name" = 'Activision' LIMIT 1
# >> 
# >> ----- The query makes four requests, regardless of how much data you have. -----
# >> 
# >> D, [2012-09-12T00:01:42.940458 #72855] DEBUG -- :   Client Load (0.1ms)  SELECT "clients".* FROM "clients" WHERE "clients"."company_id" = 1
# >> D, [2012-09-12T00:01:42.943272 #72855] DEBUG -- :   Project Load (0.1ms)  SELECT "projects".* FROM "projects" WHERE "projects"."client_id" IN (1)
# >> D, [2012-09-12T00:01:42.943919 #72855] DEBUG -- :   Task Load (0.1ms)  SELECT "tasks".* FROM "tasks" WHERE "tasks"."project_id" IN (1)
# >> D, [2012-09-12T00:01:42.944520 #72855] DEBUG -- :   Minute Load (0.1ms)  SELECT "minutes".* FROM "minutes" WHERE "minutes"."task_id" IN (1)
# >> 
# >> ----- some representation of the data (notice no queries while iterating through) -----
# >> 
# >> Robert Kotick
# >> -- Website Redesign
# >> --- Development
# >> ---- 100 
```

这是一个可怕的违反[得墨忒耳法则的](http://en.wikipedia.org/wiki/Law_of_Demeter)行为，如果这些东西在任何时候发生变化，无论是结构还是命名，我们都必须修复这个代码。如果不引入大量抽象，我不确定如何处理这个问题。

关于一本书，有很多，但老实说，我认为 Rails 世界还没有弄清楚什么是最佳 ActiveRecord 实践（事实上，社区中有很大一部分人认为几乎所有 ActiveRecord 实践都很糟糕——我大部分时间都在那个营地）。

但是，如果您想要上面提到的用于`#includes`急切加载关联的内容，那么指南是查找此类信息的好地方。我也很喜欢[这个](http://schneems.com/post/28125445535/active-record-deep-dive)博客和视频。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T05:11:13.803

尝试类似的东西

```
 Client.includes(
                      :company =>{:projects=>:tasks}) 
```

以上所有内容都应连接（通过 has_one、has_many、belongs_to）希望这会有所帮助！

# magento - 在我的 Magento 自定义模块的控制器中接收 HTTP POST

> ID：12380780
> 
> 赞同：3
> 
> 时间：2012-09-12T03:22:38.967
> 
> 标签：magento, http-post

我正在学习开发模块 magento。我正在开发一个支付模块，它应该会收到一个帖子（在关闭应用程序后）以更改请求的状态并生成发票。

但我不知道如何使用我的 HTTP POST 控制器。我将在[http://mymagento.com/mymodule/receive](http://mymagento.com/mymodule/receive)上发帖。

```
class MyCompanyName_MyModule_StandardController extends Mage_Core_Controller_Front_Action{

    public function receiveAction() {
        //How receive my POST HERE??
    }

    // ...

} 
```

我很感激任何帮助

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-12T03:30:24.707

见[`Zend_Controller_Request_Http::getPost()`](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/lib/Zend/Controller/Request/Http.php#L317)：

```
$this->getRequest()->getPost();
// or
$this->getRequest()->getPost('param'); 
```

# iphone - 按下主页按钮时 MPMoviePlayerViewController 消失

> ID：12380781
> 
> 赞同：2
> 
> 时间：2012-09-12T03:22:50.883
> 
> 标签：iphone, objective-c, ios, xcode, mpmovieplayercontroller

我正在创建我的 MPMoviePlayerViewController，如下所示：

```
MPMoviePlayerViewController *playerView = [[MPMoviePlayerViewController alloc] initWithContentURL:videoURL];
[self presentMoviePlayerViewControllerAnimated:playerView]; 
```

它工作正常，直到我按下主页按钮：这样，在我重新打开应用程序后，播放器视图控制器消失了，我看到了我最初调用它的视图控制器。如果我双击主页按钮，打开多任务面板，播放器不会消失，只是暂停（应该如此）。

那么如何防止这种情况发生（关闭并重新打开应用程序应该让我重新开始播放视频）？

UPD：我注意到如果我在“正在加载...”文本出现时关闭并重新打开应用程序，播放器不会消失。在这种情况下，回到应用程序可以让播放器继续加载视频以最终开始播放。然而，在那之后关闭应用程序（无论是在视频播放还是暂停时）不可避免地会杀死播放器视图控制器......</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:49:40.043

试试这样：

```
 MPMoviePlayerViewController *playerView = [[MPMoviePlayerViewController alloc] initWithContentURL:videoURL];
    playerView.view.frame = self.view.frame;
    [self presentMoviePlayerViewControllerAnimated:playerView];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(MPMoviePlayerDidExitFullscreen:) name:MPMoviePlayerDidExitFullscreenNotification object:nil];
    [[NSNotificationCenter defaultCenter]
     addObserver:self
     selector:@selector(playbackStateChanged:)
     name:MPMoviePlayerPlaybackStateDidChangeNotification
     object:moviePlayerController];

     [playerView.moviePlayer play]; 
```

之后添加这两种方法：

```
- (void) movieFinishedCallback:(NSNotification*) aNotification 
{
    moviePlayerController = [aNotification object];
    [moviePlayerController.moviePlayer stop];
    [[NSNotificationCenter defaultCenter] 
     removeObserver:self name:MPMoviePlayerPlaybackDidFinishNotification
     object:moviePlayerController];
    [moviePlayerController autorelease];
    NSLog(@"stopped?");
}

- (void)MPMoviePlayerDidExitFullscreen:(NSNotification *)notification
{
    [[NSNotificationCenter defaultCenter] removeObserver:self
                                                    name:MPMoviePlayerDidExitFullscreenNotification 
                                                  object:nil];

    [moviePlayerController.moviePlayer stop];
    MPMoviePlayerController *player = [notification object];
    [[NSNotificationCenter defaultCenter] 
     removeObserver:self name:MPMoviePlayerPlaybackDidFinishNotification
     object:player];
    [moviePlayerController dismissMoviePlayerViewControllerAnimated];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T04:40:31.783

我在这里找到了答案：

[当应用程序退出活动状态时，MPMoviePlayerViewController 被解雇](https://stackoverflow.com/questions/8172507/mpmovieplayerviewcontroller-gets-dismissed-when-app-resignes-active-state?rq=1)

![plist 中的必需值](../Images/1a2f8b98f72ae18e75bc018d296ac072.png)

然而，该问题（和答案）的作者提到他的应用程序因此被拒绝。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T05:43:54.447

你试试这个代码---

```
 - (void)willEnterFullscreen:(NSNotification*)notification {
NSLog(@"willEnterFullscreen");
}

- (void)enteredFullscreen:(NSNotification*)notification {
NSLog(@"enteredFullscreen");
}

- (void)willExitFullscreen:(NSNotification*)notification {
NSLog(@"willExitFullscreen");
}

- (void)exitedFullscreen:(NSNotification*)notification {
NSLog(@"exitedFullscreen");
[self.movieController.view removeFromSuperview];
self.movieController = nil;
[[NSNotificationCenter defaultCenter] removeObserver:self];
}

- (void)playbackFinished:(NSNotification*)notification {
NSNumber* reason = [[notification userInfo] objectForKey:MPMoviePlayerPlaybackDidFinishReasonUserInfoKey];
switch ([reason intValue]) {
    case MPMovieFinishReasonPlaybackEnded:
        NSLog(@"playbackFinished. Reason: Playback Ended");         
            break;
    case MPMovieFinishReasonPlaybackError:
        NSLog(@"playbackFinished. Reason: Playback Error");
            break;
    case MPMovieFinishReasonUserExited:
        NSLog(@"playbackFinished. Reason: User Exited");
            break;
    default:
        break;
}
[self.movieController setFullscreen:NO animated:YES];
}

- (void)showMovie {
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(willEnterFullscreen:) name:MPMoviePlayerWillEnterFullscreenNotification object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(willExitFullscreen:) name:MPMoviePlayerWillExitFullscreenNotification object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(enteredFullscreen:) name:MPMoviePlayerDidEnterFullscreenNotification object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(exitedFullscreen:) name:MPMoviePlayerDidExitFullscreenNotification object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(playbackFinished:) name:MPMoviePlayerPlaybackDidFinishNotification object:nil];

NSURL* movieURL =  [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"tron" ofType:@"mov"]];
self.movieController = [[MPMoviePlayerController alloc] initWithContentURL:movieURL];
self.movieController.view.frame = self.view.frame;
[self.view addSubview:movieController.view];
[self.movieController setFullscreen:YES animated:YES];
[self.movieController play];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-04T05:16:55.457

正如 Arnold 所说，当应用程序进入后台时 MPMoviePlayerViewControllers 会关闭，当您离开它所嵌入的视图控制器视图时也可以关闭。要解决这两个问题，请尝试将 MPMoviePlayerViewController 保留为 ivar 或属性，并在vc的viewWillAppear: 被调用或者当应用重新进入前台时，比如：

```
- (void) viewDidLoad{
      [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(reset) name:UIApplicationWillEnterForegroundNotification object:nil];
}    

- (void) viewWillAppear:(BOOL)animated{
      [self reset];
}

- (void) reset{
      [_mpmpvc.moviePlayer prepareToPlay];
      [_mpmpvc.moviePlayer pause];
} 
```

# symfony - 在 Symfony2 中流式传输响应

> ID：12380783
> 
> 赞同：12
> 
> 时间：2012-09-12T03:23:01.540
> 
> 标签：symfony, symfony-2.1

我正在尝试文档中的这个示例：[Streaming a Response in Symfony2](http://symfony.com/doc/master/components/http_foundation/introduction.html#streaming-a-response)。

```
/**
 * @param Request $request
 * @return Response $render
 * @Route("/streamedResponse", name="streamed_response")
 * @Template("AcmeTestBundle::streamedResponse.html.twig")
 */
public function streamedResponseAction(Request $request)
{
    $response = new StreamedResponse();
    $response->setCallback(function () {
        echo 'Hello World';
        flush();
        sleep(3);
        echo 'Hello World';
        flush();
    });

    return $response;

} 
```

这会同时输出所有内容。我做错了什么吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-12T05:40:54.293

我尝试添加 ob_flush() ，它似乎正在工作。这是我的代码：

```
public function streamedAction()
{
    $response = new StreamedResponse();
    $response->setCallback(function () {
        echo 'Hello World';
        ob_flush();
        flush();
        sleep(3);
        echo 'Hello World';
        ob_flush();
        flush();
    });

    return $response;
} 
```

这将返回带有分块数据的分块传输编码标头。这是结果的输出：

```
$ telnet localhost 80
Trying ::1...
Connected to localhost.
Escape character is '^]'.
GET /app_dev.php/streamed HTTP/1.1
Host: symfony21.localdomain

HTTP/1.1 200 OK
Date: Wed, 12 Sep 2012 05:34:12 GMT
Server: Apache/2.2.17 (Unix) DAV/2 mod_ssl/2.2.17 OpenSSL/0.9.8o
cache-control: no-cache, private
x-debug-token: 50501eda7d437
Transfer-Encoding: chunked
Content-Type: text/html; charset=UTF-8

b
Hello World
b
Hello World
0

Connection closed by foreign host. 
```

如果您在浏览器中看到此响应，它将在加载大约 3 秒后显示“HelloWorldHelloWorld”，因为浏览器将等待接收到所有分块数据，因为 Content-Type 是 text/*，但是当您看到网络流时，它实际上是在做通过发送分块数据进行流式传输。

# vb.net - 尝试在 VB.NET 中调用重载的构造函数时出现编译器错误

> ID：12380784
> 
> 赞同：3
> 
> 时间：2012-09-12T03:23:01.603
> 
> 标签：vb.net, oop, inheritance

有人可以向我解释为什么当我尝试从继承的对象调用基类的构造函数时出现编译器错误吗？我已经包含了我所指内容的简短示例。

```
Public Class Person
    Public name As String

    Public Sub New()
        name = "John Doe"
    End Sub

    Public Sub New(Name As String)
        name = Name
    End Sub

End Class

Public Class NamedPerson
    Inherits Person

    Public Sub New(FirstName As String, LastName As String)
        name = FirstName & " " & LastName
    End Sub

    'adding this makes it work
    Public Sub New(Name As String)
       MyBase.New(Name)
    End Sub

End Class

'Valid
Dim guy1 As Person = New Person()

'Valid 
Dim guy2 As Person = New Person("John Smith")

'Valid
Dim guy3 As NamedPerson = New NamedPerson("John", "Smith")

'Compiler Error
Dim guy4 As NamedPerson = New NamedPerson("John Smith") 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T03:25:43.670

子类不从其基类型继承构造函数。子类负责定义它自己的构造函数。此外，它必须确保它定义的每个构造函数都隐式或显式调用基类构造函数或链接到同一类型的另一个构造函数。

**[有关更多信息，请参阅：实例构造函数](http://msdn.microsoft.com/en-us/library/aa711964%28VS.71%29.aspx)**

从您的示例课程中，

```
Public Class NamedPerson
    Inherits Person

    Public Sub New(Name As String)
        MyBase.New(Name)
    End Sub

    Public sub New(FirstName As String, LastName As String)
        name = FirstName & " " & LastName
    End Sub
End Class 
```

# vb.net - 如何在无边界表单周围绘制轮廓？

> ID：12380786
> 
> 赞同：2
> 
> 时间：2012-09-12T03:23:17.810
> 
> 标签：vb.net, visual-studio-2010, user-interface, gdi

我有一个用作启动屏幕的表单。因为它是一个飞溅，所以它没有边框。启动画面是白色的，所以当它加载到其他白色的东西上时，它看起来很有趣。我正在考虑在表单周围添加一个大约 1 px 左右的轮廓，以便给它一个细边框。可以将其视为在 Photoshop 中为图像添加笔触。我该怎么做？我正在使用 vb.net。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T03:49:34.487

您可以使用 GDI+：

```
Protected Overrides Sub OnPaintBackground(ByVal e As PaintEventArgs)
    MyBase.OnPaintBackground(e)

    Dim rect As New Rectangle(0, 0, Me.ClientSize.Width - 1, Me.ClientSize.Height - 1)

    e.Graphics.DrawRectangle(Pens.Black, rect)
End Sub 
```

（当然，您可以用 any 代替`Pen`。`Pens.Black`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-05-18T12:28:29.527

您还可以使用以下内容：

```
 Private Sub frm_Paint(sender As Object, e As PaintEventArgs) Handles Me.Paint
        ControlPaint.DrawBorder(e.Graphics, Me.ClientRectangle, Color.Black, ButtonBorderStyle.Outset)
    End Sub 
```

Color 和 ButtonBorderStyle 都可以根据您的需要进行定制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-02T05:48:35.447

如果您在表单中使用停靠面板，现在可能会显示此边框。如果您在表单中使用停靠面板，我建议在表单的所有边缘提供 1 的“填充”。这完美地工作。

# windbg - Windbg - 我如何转储与给定过滤器匹配的字符串

> ID：12380787
> 
> 赞同：4
> 
> 时间：2012-09-12T03:23:24.427
> 
> 标签：windbg, sos

可以使用以下命令转储所有字符串 !dumpheap -type System.string

如何只转储或打印那些开始或包含特定“字符串”的字符串

例子。我只想查看包含“/my/app/request”的字符串

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T14:46:39.937

为此，请使用 sosex 而不是 sos。它有一个`!strings`命令，允许您使用该`/m:<filter>`选项过滤字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T14:44:45.130

使用！sosex.strings。有关根据内容和/或长度过滤字符串的选项，请参阅 !sosex.help。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-27T23:15:11.863

如果您真的想不使用 SOSEX，请尝试

```
.foreach (string {!dumpheap -short -type System.String}) { .foreach (search {s -u ${string}+c ${string}+c+2*poi(${string}+8) "mySearchTerm"}) { du /c80 ${string}+c }} 
```

它用

*   !dumpheap 获取 .NET 堆上的所有字符串
*   .foreach 迭代它们
*   s 搜索子字符串
*   .foreach 再次查看 s 是否发现了什么
*   一些偏移量计算以获取字符串的第一个字符 (+c) 和字符串长度 (+8)（乘以 2 以获取字节而不是字符）。这些需要在 64 位应用程序的情况下进行调整

/c80 只是为了更好的输出。如果您喜欢字符串的 .NET 详细信息，也可以使用`!do ${string}`而不是。`du /c80 ${string}+c`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T14:32:28.287

不确定 !dumpheap 是否支持。您始终可以使用 .logopen 将输出重定向到文件并对其进行后处理。对于更优雅（因此也更复杂）的解决方案，您还可以使用 .shell 将命令输出重定向到 shell 进程进行解析。这是一个例子：

[http://blogs.msdn.com/b/baleixo/archive/2008/09/06/using-shell-to-search-text.aspx](http://blogs.msdn.com/b/baleixo/archive/2008/09/06/using-shell-to-search-text.aspx)

您还可以查看 .shell 文档了解更多详细信息：

[http://msdn.microsoft.com/en-us/library/windows/hardware/ff565339(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff565339(v=vs.85).aspx)

# android - 如何使用 android web 驱动程序选择选择标签的任何选项

> ID：12380789
> 
> 赞同：2
> 
> 时间：2012-09-12T03:23:35.870
> 
> 标签：android, selenium, webdriver

我正在为 android 设备的网站编写测试用例。我需要从页面的下拉列表中选择一个选项。但似乎 android web 驱动程序没有提供任何解决方案。

我尝试了 Select API，但它不起作用。

代码片段

```
 Select loginType = new Select(this.driver.findElement(By.xpath(LOGIN_TYPE_CHOICE)));
      loginType.selectByValue("smartphone");
      driver.findElement(By.id(LOGIN_BUTTON)).click(); 
```

寻找一些解决方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T15:04:31.810

我正在使用 c# 对 android、firefox Chrome 和 IE 运行 selenium 测试，并且我发现了与 android 驱动程序相同的问题。

这对我有用：（如果您根据 Java 约定重构代码，它应该在 java 中工作）

```
string jsToBeExecuted="document.getElementById('<insert dropdown Id here>').selectedIndex=<insert index here>";

IJavaScriptExecutor jsExecutor = (IJavaScriptExecutor)this.Driver;
jsExecutor.ExecuteScript(jsToBeExecuted); 
```

## 请注意，屏幕上不会呈现任何更改！！！

在提交带有所选索引的元素时，将被使用。如果您想对其添加一些调整以通过文本或任何您喜欢的方式选择元素，这取决于您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T12:20:00.547

根据我对使用 selenium 的自动化 Web 应用程序的经验，我有以下假设。据我所知，selenium 无法与下拉选项直接交互，因为它们被认为是不可见的（不活动的）。它始终有效的方式是为此使用 js。首先使用 css 选择器正确定位元素并使用 firepath 验证它（附加到 fox 中的 firebug） ![在此处输入图像描述](../Images/dfa666c52622de72bff15137b511ccbd.png)

所以你有 css 选择器：

```
String css=....;
public void jsClickByCss(String cssLocator){
JavascriptExecutor js = (JavascriptExecutor) driver;
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append("var x = $(\'"+cssLocator+"\');");
        stringBuilder.append("x.click();");
        js.executeScript(stringBuilder.toString());
}
jsClickByCss(css); 
```

您还可以尝试使用**Builder**的另一种方法，即高级用户交互 API：这个想法非常简单。首先，您应该使下拉列表向下滚动，以便您想要单击的元素变得可见，等待 driver.manage.timeout 然后选择所需的下拉元素并单击。

```
WebElement mnuElement;
WebElement submnuElement;
mnEle = driver.findElement(By.Id("mnEle")).click();
sbEle = driver.findElement(By.Id("sbEle")).click();

Actions builder = new Actions(driver);
// Move cursor to the Main Menu Element
builder.MoveToElement(mnEle).perform();
// Giving 5 Secs for submenu to be displayed
Thread.sleep(5000L);
// Clicking on the Hidden SubMenu
driver.findElement(By.Id("sbEle")).click(); 
```

[你可以在这里](http://www.anitpatel.net/2012/02/25/selenium-webdriver-how-to-click-on-a-hidden-link-or-menu/)阅读一些额外的信息 希望这对你有用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T01:38:27.787

这是Ruby的解决方案：

要从列表中选择值需要执行 javascript，这里是示例：

HTML：

```
<select id="select_id">
   <option id="option_id_1" value="value_1" name="OPTION1"> OPTION1 </option>
   <option id="option_id_2" value="value_2" name="OPTION2"> OPTION2 </option> 
```

更新：更简单的方法：$('#select_id').val(value_1)

代码：通过 id 属性查找元素：

```
browser.execute_script("$('#select_id').val($('#option_id_1').val())") 
```

按名称属性查找元素：

```
browser.execute_script("$('#select_id').val($('option[name=OPTION2]').val())") 
```

非常适合我。

# android - 错误代码：101 缺少用户 cookie

> ID：12380793
> 
> 赞同：3
> 
> 时间：2012-09-12T03:24:22.703
> 
> 标签：android, facebook-access-token, facebook-android-sdk

在我的应用程序中，我手动设置了存储在服务器端的访问令牌。当我尝试使用 FB.dialog 显示邀请对话框时，Web 视图显示“发生错误。请稍后再试。API 错误代码：110 API 错误描述：无效的用户 ID 错误消息：缺少用户 cookie（到验证会话用户）

我已经验证了令牌是有效的，并且我已经能够使用它发出请求请求。

这是实现：

```
 Facebook facebook = new Facebook("my app id");
            try {
                facebook.setAccessToken(authToken);
                SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
                Date date = format.parse(tokenExpiration);
                facebook.setAccessExpires(date.getTime());
                Bundle params = new Bundle();
                params.putString("message", "Invite Friends!");
                facebook.dialog(mActivity, "apprequests", params, new DialogListener() {

                    @Override
                    public void onFacebookError(FacebookError e) {
                        Log.e(e.getMessage(), e);
                    }

                    @Override
                    public void onError(DialogError e) {
                        Log.e(e.getMessage(), e);
                    }

                    @Override
                    public void onComplete(Bundle values) {
                    }

                    @Override
                    public void onCancel() {
                    }
                }); ..... 
```

没有回调 onFacebookError 或 onError

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T10:08:08.773

想通了，这与合作伙伴的 SDK 与 cookie 混淆有关。

# vbscript - Windows批处理/脚本代码根据文本文件中的日期值有条件地处理

> ID：12380794
> 
> 赞同：0
> 
> 时间：2012-09-12T03:24:25.113
> 
> 标签：vbscript, batch-file, cmd

我正在使用 Windows XP。该代码可用于批处理文件或 VBscript。我打算使用 Windows 调度程序来运行程序。

我需要代码来从文本文件中读取日期（可能是文本文件中的唯一行，或者日期可以包含在文件名中，我控制生成文件的过程）然后代码需要评估文本文件日期与当前日期的对比，以确认文本文件日期来自上个月。

我开始构建一个流程，以便在刷新每月数据后能够运行每月 1 日的作业。我是使用批处理/脚本文件构建这种过程的新手。

谢谢你的时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:34:30.407

windows date命令很有限，可以试试[realdate](http://www.huweb.hu/maques/realdate.htm)

```
realdate.com /f="DD" /s="set DAY=" >tmpdt.bat

call tmpdt.bat
if !%DAY%! == !%01%! (
echo not first day
exit 0
)
do your stuff here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T10:35:28.650

处理日期`batch`并非不可能，但真的*非常*难看。我建议使用`VBScript`这个（或者`PowerShell`如果这是你的选择）。

```
Set fso = CreateObject("Scripting.FileSystemObject")
Set f   = fso.GetFile("C:\PATH\TO\your_file_2012-07-23.txt")

fileDate  = CDate(Right(fso.GetBaseName(f.Name), 10))

If Month(DateAdd("m", 1, fileDate)) = Month(Now) Then
  WScript.Echo f.Name & " is from the previous month."
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T18:09:58.967

此代码的优点是您可以`date.txt`像这样将当前日期放入：

```
echo %date%>date.txt 
```

然后要在该日期采取行动，您只需要该行后面的代码：

```
set lastmonth= 
```

代码如下：

```
@echo off
:Beginagain
set lastmonth= %date:~4,2%
set /a lastmonth=%lastmonth: 0=%-1
echo.
set /p lastmonth=Enter month for date.txt [1-12, Default = %lastmonth%, Q = Quit]: 
if %lastmonth%==Q goto :eof
if %lastmonth%==q goto :eof
set year=%date:~-4%
if %lastmonth% leq 0 (
  set lastmonth=12
  set /a year=year-1
)
if %lastmonth% lss 10 set lastmonth=0%lastmonth%
echo %date:~,4%%lastmonth%/%date:~7,2%/%year% > date.txt
set year=
set lastmonth=
set /p olddate=<date.txt
set olddate= %olddate:~4,2%
set olddate=%olddate: 0=%
set thismonth= %date:~4,2%
set thismonth=%thismonth: 0=%
set /a diff=thismonth-olddate
if %diff% lss 0 (
  echo Date from Last Year
) else if %diff%==0 (
  echo Date from this month
) else if %diff%==1 (
  echo Date from last month
) else if %diff% gtr 1 (
  echo Date from before last month
)
goto :Beginagain 
```

上面的代码允许你通过循环来试验不同的月份，直到你选择 [Q]uit。

如果您使用默认选项，它将始终输出：

```
Date from last month 
```

在 9 月份运行时，上面的代码将显示：

```
Enter month for date.txt [1-12, Default = 8, Q = Quit]: 
```

您可以输入从 1 到 12 的任何月份（任何高于或低于前一年的数字），按`ENTER`默认月份，或键入`Q``ENTER`退出程序。

默认月份总是比当前月份早一个月。因此，如果当前月份是 1 月，则默认值为 12。如果当前月份是 12 月，则默认值为 11。

# arrays - 为什么我的递归比 Array.exists 快？

> ID：12380796
> 
> 赞同：1
> 
> 时间：2012-09-12T03:24:31.340
> 
> 标签：arrays, performance, f#, tail-recursion

我对 F# 很陌生。我试图了解如何在 F# 中获得快速代码。为此，我尝试编写两种方法 (`IsPrime1`和`IsPrime2`) 进行基准测试。我的代码是：

```
// Learn more about F# at http://fsharp.net
open System
open System.Diagnostics

#light

let isDivisible n d = n % d = 0
let IsPrime1 n =
    Array.init (n-2) ((+) 2) |> Array.exists (isDivisible n) |> not

let rec hasDivisor n d =
    match d with
    | x when x < n -> (n % x = 0) || (hasDivisor n (d+1)) 
    | _ -> false

let IsPrime2 n =
    hasDivisor n 2 |> not

let SumOfPrimes max = 
    [|2..max|] |> Array.filter IsPrime1 |> Array.sum

let maxVal = 20000

let s = new Stopwatch()
s.Start()

let valOfSum = SumOfPrimes maxVal

s.Stop()

Console.WriteLine valOfSum
Console.WriteLine("IsPrime1: {0}", s.ElapsedMilliseconds)

//////////////////////////////////
s.Reset()
s.Start()

let SumOfPrimes2 max = 
    [|2..max|] |> Array.filter IsPrime2 |> Array.sum

let valOfSum2 = SumOfPrimes2 maxVal

s.Stop()

Console.WriteLine valOfSum2
Console.WriteLine("IsPrime2: {0}", s.ElapsedMilliseconds)

Console.ReadKey() 
```

`IsPrime1`需要 760 毫秒，而`IsPrime2`相同的结果需要 260 毫秒。

这里发生了什么以及如何使我的代码更快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T06:21:23.703

在`IsPrime2`中，您不会构造一个巨大的数组，因此您可以避免分配、显式遍历和垃圾收集该数组。请记住，您调用了 IsPrime1/IsPrime2 函数`max-1`次，`SumOfPrimes`因此此类数组的实例很多。避免创建显式数据结构可以用作优化技术。

以下是可以对您的代码进行的一些小的优化。

1) 要检查 中的除数`hasDivisors`，您只需检查`sqrt(n)`并跳过所有偶数。如果没有找到除数，则检查的数字是素数。

```
let rec hasDivisor2 n d =
    match d with
    | x when x <= int(sqrt(float n)) -> (n % x = 0) || (hasDivisor2 n (d+2)) 
    | _ -> false

let IsPrime3 n =
    n = 2 || (n%2 <> 0 && not (hasDivisor2 n 3)) 
```

2）对于`SumOfPrimes`，您可以消除中间数组并跳过所有偶数（无论如何它们都不能是素数）。

```
let sumOfPrimes isPrime max = 
    [|2..max|] |> Array.filter isPrime|> Array.sum

let sumOfPrimes2 isPrime max = 
    let mutable sum = 2L
    for i in 3..2..max do
        if isPrime i then
            sum <- sum + int64 i
    sum 
```

3) 我做了一个小改动，以便将 isPrime 作为参数传递。这样，您可以更轻松地测量您的代码：

```
let time fn =
    let sw = new System.Diagnostics.Stopwatch()
    sw.Start()
    let f = fn()
    sw.Stop()
    printfn "Time taken: %.2f s" <| (float sw.ElapsedMilliseconds)/1000.0
    f

let maxVal = 200000

let p2 = time (fun () -> sumOfPrimes IsPrime2 maxVal)
let p3 = time (fun () -> sumOfPrimes2 IsPrime3 maxVal) 
```

新`sumOfPrimes2`功能`IsPrime3`非常快。在我的机器上用了 0.05 秒，`maxVal = 200000`而原始版本用了 7.45 秒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T04:06:58.123

速度差异的原因是慢代码做了这样的事情：

```
if n%a.[1] = 0 || n%a.[2]=0 ... 
```

而快速代码可以：

```
if n%2=0 || n%(2+1)=0 ... 
```

在快速的情况下，我们不需要去记忆来获得下一个因素。我们还避免了在快速情况下构建数组

这是我构建素数表的通用非常快速的 F# 代码（来自此答案：[https](https://stackoverflow.com/a/12014908/124259) ://stackoverflow.com/a/12014908/124259 ）：

```
#time "on"

let limit = 1000000
//returns an array of all the primes up to limit
let table =
    let table = Array.create limit true //use bools in the table to save on memory
    let tlimit = int (sqrt (float limit)) //max test no for table, ints should be fine
    let mutable curfactor = 1;
    while curfactor < tlimit-2 do
        curfactor <- curfactor+2
        if table.[curfactor]  then //simple optimisation
            let mutable v = curfactor*2
            while v < limit do
                table.[v] <- false
                v <- v + curfactor
    let out = Array.create (100000) 0 //this needs to be greater than pi(limit)
    let mutable idx = 1
    out.[0]<-2
    let mutable curx=1
    while curx < limit-2 do
        curx <- curx + 2
        if table.[curx] then
            out.[idx]<-curx
            idx <- idx+1
    out 
```

# jquery - jQuery悬停动画：不能同时为不透明度和背景位置设置动画

> ID：12380798
> 
> 赞同：1
> 
> 时间：2012-09-12T03:24:36.853
> 
> 标签：jquery, html, css

我正在尝试为导航元素设置动画，以便当鼠标悬停在元素上时，它变得完全不透明（不透明度为 30%），并且背景图像向上移动 10px。这是我的代码：

```
<script type="text/javascript">
$(document).ready(function(){
$('#topnav li')
.mouseover(function(){
    $(this).stop().animate(
        {'background-position-y': '28px'},
        {opacity: 1},
        {duration:100})
    })
.mouseout(function(){
    $(this).stop().animate(
        {'background-position-y': '38px'},
        {opacity: 0.3},  
        {duration:100})
    })
});
</script> 
```

但是，只有列出的第一个动画实际播放。正如所写，背景位置动画但不透明度没有。如果我切换不透明度和背景位置动画，则不透明度动画，但背景位置没有。我对 jQuery 不是很好，但从我读过的内容来看，这似乎应该可行。谁能帮我理解我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:26:54.347

您没有使用正确形式的参数来为多个属性设置动画。所有属性都属于作为第一个参数传递的对象。[这在jQuery`.animate()`](http://api.jquery.com/animate/)的文档中非常清楚。

```
<script type="text/javascript">
$(document).ready(function(){
$('#topnav li')
.mouseover(function(){
    $(this).stop(true).animate(
        {'background-position-y': '28px', opacity: 1},
        {duration:100})
    });
.mouseout(function(){
    $(this).stop(true).animate(
        {'background-position-y': '38px', opacity: 0.3},
        {duration:100})
    });
});
</script> 
```

仅供参考，您可能还想`.stop(true)`从队列中删除上一个动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:30:24.733

As you can see [here](http://api.jquery.com/animate/), the `property` is a map of CSS properties and `duration` is the second parameter.

```
$(this).stop().animate({
    'background-position-y': '28px',
    'opacity': 1
}, 100) 
```

# ruby-on-rails - 当我进行捆绑安装时，我收到了 kgio gem 的此 gem 安装错误

> ID：12380802
> 
> 赞同：5
> 
> 时间：2012-09-12T03:25:09.360
> 
> 标签：ruby-on-rails, ruby, gem, rvm, unicorn

我将独角兽添加到我的 Gemfile 中，之后当我进行捆绑安装时出现此错误

```
 em::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/bin/ruby extconf.rb 
checking for CLOCK_MONOTONIC in time.h... *** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/Users/adim86/.rvm/rubies/ruby-1.9.3-p0/bin/ruby
/Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)
You have to install development tools first.
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:491:in `block in try_compile'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:443:in `with_werror'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:491:in `try_compile'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:686:in `macro_defined?'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:822:in `block in have_macro'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:254:in `open'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:254:in `open'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'
    from /Users/adim86/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/mkmf.rb:821:in `have_macro'
    from extconf.rb:5:in `<main>'

Gem files will remain installed in /Users/adim86/.rvm/gems/ruby-1.9.3-p0/gems/kgio-2.7.4 for inspection.
Results logged to /Users/adim86/.rvm/gems/ruby-1.9.3-p0/gems/kgio-2.7.4/ext/kgio/gem_make.out
An error occured while installing kgio (2.7.4), and Bundler cannot continue.
Make sure that `gem install kgio -v '2.7.4'` succeeds before bundling 
```

我的 gem 文件看起来像这样。我尝试将独角兽添加到生产块中，但我仍然遇到相同的错误。我也删除了独角兽，我仍然得到同样的错误也尝试了捆绑更新无济于事：

```
source 'https://rubygems.org'

gem 'rails', '3.2.3'

gem 'devise'
gem 'haml-rails'

gem 'omniauth'
gem 'omniauth-twitter'
gem 'omniauth-facebook'
gem 'twitter'
gem 'fb_graph'

gem 'json'
gem 'json_pure'

gem 'simple_form'
gem 'postmark'
gem 'postmark-rails'

gem 'bootstrap-datepicker-rails'
gem 'watu_table_builder', :require => 'table_builder'

gem 'sqlite3'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'uglifier', '>= 1.0.3'
end

gem "therubyracer", :require => 'v8'

gem 'jquery-rails'

gem 'differ'

gem 'whenever'
gem 'unicorn' 
```

谁能帮忙？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-26T00:43:16.277

Unicorn，旨在利用类 Unix 系统中的功能。

换句话说，它们不能在 Windows 上运行

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-02T12:01:00.690

我最近遇到了这个问题。就我而言，这是因为由于某种未知原因，CC 的环境变量（它是 Apple 的 LLVM 编译器的垫片）没有被设置。打字：

```
$ export CC=cc 
```

`bundle install`在为我工作之前在终端中。

要使更改永久生效，您可以添加`export CC=cc`到 .bash_profile 文件中。

如果您执行后者，请确保您键入：

```
$ source ~/.bash_profile 
```

（或打开一个新的终端窗口），然后再执行`bundle install`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T04:21:45.993

问题是 Xcode。转到 Xcode 设置 -> 下载并确保您已安装“命令行工具”。一旦我安装它们，`bundle install`运行就好了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T06:39:09.003

这可能需要更新的 ruby​​ 补丁级别 - 比如`p194`- 安装它：

```
rvm install 1.9.3-p194 
```

然后再试一次。

您应该始终使用可用的最新补丁级别，RVM 允许这样做：

```
rvm get stable
rvm use 1.9.3 --install 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-14T04:41:44.987

我曾经`rvm use system`安装宝石。生活在红宝石边缘的代价是什么？

# list - 在 OCaml 中分隔列表

> ID：12380804
> 
> 赞同：1
> 
> 时间：2012-09-12T03:25:39.083
> 
> 标签：list, ocaml

所以我有一个列表，我试图将它分成两个列表，这样原始列表中的所有偶数索引组成第一个列表，奇数索引组成第二个列表。这是我对解决方案的尝试，但它没有正确返回：

```
let rec separate xs =
  match xs with
    [] -> [],[]
  | x::y::xs -> x::separate xs, y::separate xs
  | x::[] -> x:: separate [], separate [];; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T07:13:59.027

问题是`separate`返回一对列表，而当您编写时，`x::separate xs`您假设它返回一个列表（您将其添加到该列表中`x`）。此外，在这种情况下`x::[]`，您已经知道结果，无需递归调用`separate`.

产生：

```
let rec separate xs =
    match xs with
  | x::y::tail ->
        let a,b = separate tail in
        x::a, y::b
  | x::[] -> [x],[]
  | [] -> [],[];; 
```

（如果您发布更多问题，请将您的代码发布在多行而不是仅一行，并带有缩进）。

# namespaces - 更改 Google Play 命名空间或签名

> ID：12380808
> 
> 赞同：1
> 
> 时间：2012-09-12T03:25:58.983
> 
> 标签：namespaces, key, google-play, signing

最近，我们向 google play 市场上传/发布了一个内置应用程序（大约 100 万次安装）。

我们使用我们的测试签名 + 命名空间上传了我们的测试版 APK。现在我们被困住了，因为 test-key + 命名空间是捆绑在一起的。

有谁知道打破键+命名空间的方法？将命名空间从 beta-key 切换到我们的生产签名密钥非常重要。- 否则100万人无法更新。

此 APK 预装在旧版本的操作系统上。

# playframework-2.0 - 播放框架 - 在 ubuntu 11.10 中运行

> ID：12380810
> 
> 赞同：0
> 
> 时间：2012-09-12T03:26:03.873
> 
> 标签：playframework-2.0, ubuntu-11.10

如何在 ubuntu 11.10 中正确运行播放框架？我的意思是，我可以在终端上运行示例应用程序（helloworld），但是当我尝试在浏览器上打开 localhost:9001（我在端口 9001 上运行它）时，我得到了“连接已重置”响应。我尝试打开 localhost:9001/helloworld，我得到了这个 ![在此处输入图像描述](../Images/67187e539d5884e38c4d25ad6c267c55.png)

然后，我尝试打开 localhost:9001/hello，我再次得到“连接已重置”。我在端口 9001 运行它的原因是因为我运行了 php-fpm。

附加信息：我正在运行 nginx 和 apache2。我阻止了他们，它仍然没有工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T13:43:42.410

对于最初的问题，问题在于您的请求路径。查看路线，您没有将 /helloworld 映射到任何东西。

# php - WordPress-posted_on 不显示 (PHP)

> ID：12380813
> 
> 赞同：0
> 
> 时间：2012-09-12T03:27:00.380
> 
> 标签：php, wordpress, sticky

我一直在研究一个 WP 主题（基于 211），它有一个用于粘性帖子的聚光灯（特色）区域：http: [//www.designated.net.au/testbed/wordpress/](http://www.designated.net.au/testbed/wordpress/)

我遇到的问题是posted_on 声明不显示粘性帖子。说到 PHP，我完全是个菜鸟，所以我真的不知道我在做什么。

为了突出我使用本指南的粘性帖子：http: [//line25.com/tutorials/how-to-create-a-featured-post-layout-in-wordpress](http://line25.com/tutorials/how-to-create-a-featured-post-layout-in-wordpress)

但是我更改了帖子的显示以使用 content.php 中的代码。所以我正在使用以下内容：

```
<?php if ( 'post' == get_post_type() ) : ?>
<div class="entry-meta">
<?php twentyeleven_posted_on(); ?>
</div><!-- .entry-meta -->
<?php endif; ?> 
```

那是不显示的部分。

如果您需要我，我很乐意提供更多代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:38:16.107

如果您需要显示发布日期，请使用`<?php echo get_the_date(); ?>`

您可以以任何格式显示日期。检查此 Codex 以了解[格式化日期和时间](http://codex.wordpress.org/Formatting_Date_and_Time)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T08:13:24.410

您是否尝试过使用`get_post_type( $post->ID )`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T11:36:10.380

我想到了。这是 CSS 的问题。由于某种原因，它被设置为绝对值，左上角为零。

# javascript - 保持提交按钮处于禁用状态，直到表单完成并确认密码

> ID：12380824
> 
> 赞同：0
> 
> 时间：2012-09-12T03:28:40.920
> 
> 标签：javascript, html, forms, disabled-input

我知道已经有很多关于此的帖子，但是无论我尝试什么，都对我的表单无效。

我只是希望在填写所有字段之前禁用提交按钮，并且我希望在提交之前`$mypassword`检查是否相等`$myconfirmpassword`。

如果你能找到有用的东西。太感谢了！！

显然，出于隐私目的，有些内容是隐藏的，因为您看不到我的 CSS 和 PHP 信息。

```
<div id="container" style="height:700px;">
<a href="login.php" class="anchor"><div id="back">
 <h2>Back</h2>             
 </div></a>
    <div id="registration_container" >
   <table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#FF9">
    <tr>
<form name="form3" method="post" action="check_finish_registration.php">
        <td>
        <table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FF9">
            <tr>
                <td colspan="3"><strong>Complete Registration </strong></td>
            </tr>
            <tr>
                <td width="2000">First Name</td>
                <td width="6">:</td>
                <td width="294"><?php echo $fname ?></td>
            </tr>
            <tr>
                <td width="2000">Middle Name*</td>
                <td width="6">:</td>
                <td width="294"><input type="text" name="mymname" id="mymname"></td>
            </tr>
            <tr>
                <td width="2000">Last Name</td>
                <td width="6">:</td>
                <td width="294"><?php echo $lname ?></td>
            </tr>
             <tr>
                <td width="2000">Create a Username*</td>
                <td width="6">:</td>
                <td width="294"><input type="text" name="myusername" id="myusername"></td>
            </tr>
             <tr>
                <td width="2000">Create a Password*</td>
                <td width="6">:</td>
                <td width="294"><input type="text" name="mypassword" id="mypassword"></td>
            </tr>
             <tr>
                <td width="2000">Confirm Your Password*</td>
                <td width="6">:</td>
                <td width="294"><input type="text" name="myconfirmpassword" id="myconfirmpassword"></td>
            </tr>
             <tr>
                <td width="2000">Enter your Sigma Number*</td>
                <td width="6">:</td>
                <td width="294"><input type="text" name="mysnumber" id="mysnumber"></td>
            </tr>
             <tr>
                <td width="2000">E-Mail Address*</td>
                <td width="6">:</td>
                <td width="294"><input type="text" name="myemail" id="myemail"></td>
            </tr>
            <tr>

                <td width="2000">* required field</td>
                <td>&nbsp;</td>
                <td><input   type="submit" id='register' value="Register"disabled='disabled'></td>
            </tr>
        </table>
        </td>
</form>

     </tr>
    </table>
    </div>    
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:57:49.880

与其禁用提交按钮，不如尝试验证表单，以便在用户输入正确的值之前，不会将表单提交到数据库？以及关于密码和确认密码字段验证

```
 <script type="text/javascript">
    function passwordConfirm() {
        var confirmPass = document.getElementById("confirmpassid").value
        if(pass != confirmPass) {
            alert("Mismatching passwords");
        }
      } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T05:25:03.620

尽量不要使用它，但如果你愿意，你可以试一试（[jQuery](http://jquery.com)会很好）

```
var  els=[];
window.onload=function(){
    var inputs=document.getElementsByTagName('input');
    for(i=0; i<inputs.length;i++)
    {
        if(inputs[i].type=='text' || inputs[i].type=='password')
        {
            if(inputs[i].name!='fname' && inputs[i].name!='lname')
            {
                inputs[i].onkeyup=check;
                els.push(inputs[i]);
            }
        }
    }
}

function check()
{
    var isValid=true;
    for(i=0; i<els.length;i++)
    {
        if(!els[i].value.length) 
        {
            isValid=false;
            break;
        }
        else isValid=true;
    }
    var reg=document.getElementById('register');
    if(isValid && matctValidInputs()) reg.disabled=false;
    else reg.disabled=true;
}

function matctValidInputs()
{
    var re=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{3}$/;
    var ps=document.getElementById('mypassword');
    var cps=document.getElementById('myconfirmpassword');
    var snum=document.getElementById('mysnumber');
    var mail=document.getElementById('myemail');
    if(ps.value.length>5 && ps.value==cps.value && re.test(mail.value) && isNumber(snum.value))
        return true;
    else return false;
}

function isNumber(n) {
    return !isNaN(parseFloat(n)) && isFinite(n) && n.length>5;
} 
```

**在测试演示之前：**

1.  密码必须为 6 个字符并与确认密码匹配。
2.  `Sigma Number`必须是一个数字且最少 6 位数字。
3.  电子邮件必须匹配有效的电子邮件（非常基本的正则表达式）
4.  没有给出警报/通知。

[**演示**](http://jsfiddle.net/p3Nwd/4/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T05:42:32.107

只需复制并粘贴我的代码。您可能需要改进一些事情。如果是这样，请告诉我

```
<script type="text/javascript">
function fnc()
{
var name=document.getElementById("mymname").value;
var username=document.getElementById("myusername").value;
var password=document.getElementById("mypassword").value;
var confirmpassword=document.getElementById("myconfirmpassword").value;
var number=document.getElementById("mysnumber").value;
var email=document.getElementById("myemail").value;
if(name!='' && username!='' && password!='' && confirmpassword!='' && number!='' &&  email!='')
 {
   document.getElementById("register").disabled=false;
 }
 else
 document.getElementById("register").disabled=true;
}
function check()
{
var password=document.getElementById("mypassword").value;
var confirmpassword=document.getElementById("myconfirmpassword").value;
if(password!=confirmpassword)
    {
        alert("password missmatches");
        return false;
    }

}
</script>
<div id="container" style="height:700px;">
<a href="login.php" class="anchor"><div id="back">
<h2>Back</h2>             
</div></a>
<div id="registration_container" >
<table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#FF9">
<tr>
<form name="form3" method="post" action="check_finish_registration.php" onSubmit="return check()">
    <td>
    <table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FF9">
        <tr>
            <td colspan="3"><strong>Complete Registration </strong></td>
        </tr>
        <tr>
            <td width="2000">First Name</td>
            <td width="6">:</td>
            <td width="294"><?php echo $fname ?></td>
        </tr>
        <tr>
            <td width="2000">Middle Name*</td>
            <td width="6">:</td>
            <td width="294"><input type="text" name="mymname" id="mymname" onKeyUp="fnc()"></td>
        </tr>
        <tr>
            <td width="2000">Last Name</td>
            <td width="6">:</td>
            <td width="294"><?php echo $lname ?></td>
        </tr>
         <tr>
            <td width="2000">Create a Username*</td>
            <td width="6">:</td>
            <td width="294"><input type="text" name="myusername" id="myusername" onKeyUp="fnc()"></td>
        </tr>
         <tr>
            <td width="2000">Create a Password*</td>
            <td width="6">:</td>
            <td width="294"><input type="text" name="mypassword" id="mypassword" onKeyUp="fnc()"></td>
        </tr>
         <tr>
            <td width="2000">Confirm Your Password*</td>
            <td width="6">:</td>
            <td width="294"><input type="text" name="myconfirmpassword" id="myconfirmpassword" onKeyUp="fnc()">

            </td>
        </tr>
         <tr>
            <td width="2000">Enter your Sigma Number*</td>
            <td width="6">:</td>
            <td width="294"><input type="text" name="mysnumber" id="mysnumber" onKeyUp="fnc()"></td>
        </tr>
         <tr>
            <td width="2000">E-Mail Address*</td>
            <td width="6">:</td>
            <td width="294"><input type="text" name="myemail" id="myemail" onKeyUp="fnc()"></td>
        </tr>
        <tr>

            <td width="2000">* required field</td>
            <td>&nbsp;</td>
            <td><input   type="submit" id="register" value="Register" disabled='disabled' "></td>
        </tr>
    </table>
    </td>
  </form>

 </tr>
 </table>
 </div>

 </div> 
```

# objective-c - UITextView 可以从上到下呈现吗？

> ID：12380827
> 
> 赞同：7
> 
> 时间：2012-09-12T03:29:13.267
> 
> 标签：objective-c, ios, uitextview

我的下一个项目需要显示从上到下和从右到左的日文文本（传统的日文写作风格）。是否可以通过`UITextView`这种方式设置布局文本？下面是一些以这种方式编写的文本的示例：

> ```
>  W H
>  O E
>  R L
>  L L
>  D O
>  ! , 
> ```

另外，我需要能够选择它（所以`UILabel`出来了）。这会变成一个完全自定义的视图吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T05:35:02.050

事实证明，答案是“不，它不能”。

因此，我使用核心文本构建了自己的核心文本，它在很大程度上基于“ [SimpleTextInput](http://developer.apple.com/library/ios/#samplecode/SimpleTextInput/Introduction/Intro.html) ”。这个视图的关键是添加`YES`到`kCTVerticalFormsAttributeName`关键。幸运的是，选择逻辑已经存在于项目中，只是没有被使用。我很容易通过在平移手势中调用适当的方法来添加它（有一些猴子业务`CTFrameGetLineOrigins`覆盖了它的一些相邻内存，但幸运的是我能够解决它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T08:17:41.557

到目前为止，似乎还没有你想要的这种风格的自定义视图。如果我是你，我会将日文的排版转换为适应传统的日文写作风格。（也许，这不是一个好主意，但这是可能的）

也许文本字符串是“YUQMIEAZVRNJFBWSOKGCX TPLH D”。

顺便说一句，你擅长算术编码吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T11:14:09.560

如果您只想移动文本，请尝试

[textViewTest setContentInset:UIEdgeInsetsMake(<#CGFloat top#>, <#CGFloat left#>, <#CGFloat bottom#>, <#CGFloat right#>)];

正数将框架移向中间，负数将框架从中间移出。

例如，[textViewTest setContentInset:UIEdgeInsetsMake(-5, 0, 5,0)]，会将文本向上移动 5 个像素！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-12T04:55:08.100

右向左

```
 uiTextView.text = [NSString stringWithFormat:@"\u202B%@",textString]; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-12T05:54:01.100

你可以试试这个——

```
- (void)loadView {
[super loadView];

CGRect frame = CGRectZero;
frame.size = self.view.frame.size;

UITextView* tv = [[UITextView alloc] initWithFrame:frame];
[self.view addSubview:tv];

tv.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;

tv.text = [_value description];

tv.editable = NO;
tv.dataDetectorTypes = UIDataDetectorTypeAll;

// default font size is too small
tv.font = [UIFont systemFontOfSize:[UIFont labelFontSize]];

[tv release];
} 
```

# google-docs-api - 中断：Google Doclist API 2LO 导致 500 条内部错误消息

> ID：12380828
> 
> 赞同：0
> 
> 时间：2012-09-12T03:29:40.757
> 
> 标签：google-docs-api

大约 3 小时前，使用 2-legged OAuth 对 Doclist API 的每次调用都开始失败，并显示“500 内部错误”消息。

我们已经使用不同的库在多个系统（App Engine 和本地应用程序）以及亚洲、美国和欧洲的各个域中验证了这一点。

如果使用普通用户身份验证，则不会出现此问题 - 仅 2LO 受到影响。

不幸的是，这个问题影响了成千上万使用我们工具的学生。

[http://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=3233&thanks=3233&ts=1347419864](http://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=3233&thanks=3233&ts=1347419864)

简

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T08:08:16.367

这在[http://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=3233](http://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=3233)进行了跟踪，修复应该很快就会生效。

更新：现在一切恢复正常

# php - 将 Wordpress 网站移至根目录，现在出现 http 400 Bad Request 错误

> ID：12380829
> 
> 赞同：0
> 
> 时间：2012-09-12T03:30:12.467
> 
> 标签：php, wordpress, http-status-code-400

网址：[http ://www.tmla.org/athletics/](http://www.tmla.org/athletics/)

尝试重新上传图像，但没有运气。以前从未遇到过这种情况。有谁知道为什么会这样？

```
 "NetworkError: 400 Bad Request - http://www.tmla.org/wp-content/plugins/slideshow-gallery/vendors/timthumb.php?src=wp-content/uploads/slideshow-gallery/5.jpg&w=960&h=424&q=100&a=t"

    timthu...100&a=t

    "NetworkError: 400 Bad Request - http://www.tmla.org/wp-content/plugins/slideshow-gallery/vendors/timthumb.php?src=wp-content/uploads/slideshow-gallery/7.jpg&w=960&h=424&q=100&a=t"

    timthu...100&a=t

    "NetworkError: 400 Bad Request - http://www.tmla.org/wp-content/plugins/slideshow-gallery/vendors/timthumb.php?src=wp-content/uploads/slideshow-gallery/4.jpg&w=960&h=424&q=100&a=t" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T07:01:10.983

原来服务器的空间非常有限。它接近容量，这意味着图像无法缓存。腾出一些空间，现在全是肉汁。

# iphone - 根据内容大小属性设置 UIText 视图的宽度

> ID：12380832
> 
> 赞同：1
> 
> 时间：2012-09-12T03:30:31.987
> 
> 标签：iphone, xcode, uitextview

TextView.contentSize.width 无法设置 UITextView 的 .frame.size.width。

```
[TextView setFrame:CGRectMake(TextView.frame.origin.x, TextView.frame.origin.y, TextView.contentSize.width, TextView.contentSize.height)]; 
```

将 UITextView 的框架高度设置为 contentSize.height 属性可以使视图的框架缩放到适合内容当前垂直大小的大小。由于某种原因，视图框架的宽度不会以相同的方式响应。无论文本输入量如何，它都保持相同的大小。

当我动态记录 UITextView 的内容大小时，当我在视图中输入文本时，高度属性会发生变化（在每个换行符处），而宽度不会发生变化。让我想知道 width 属性在做什么，它是做什么用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T04:23:56.387

试试这个方法。。

```
UIFont *font = [UIFont fontWithName:@"Enriqueta" size:15];
NSString *text = @"Your text";
CGSize frameSize = [text sizeWithFont:font];
CGRect originalFrame = textViewA1.frame;
textViewA1.frame = CGRectMake(CGRectGetMinX(originalFrame), CGRectGetMinY(originalFrame), frameSize.width, frameSize.height); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T05:42:12.180

根据 UITextView 的宽度，它应该是这样的：

```
UIFont *myFont = [UIFont boldSystemFontOfSize:15.0]; //your font specification here
NSString *strText = yourTextView.text;
CGSize strsize = [strText sizeWithFont:myFont
                          forWidth:yourTextView.frame.size.width 
                    lineBreakMode:UILineBreakModeWordWrap]; //get string size
yourTextView.frame = CGRectMake(yourTextView.frame.origin.x,yourTextView.frame.origin.y,strsize.width,strsize.height+10); //change accordingly 
```

# android - What is the meaning of "ant maven-setup" in Roboelectic Maven Build?

> ID：12380833
> 
> 赞同：1
> 
> 时间：2012-09-12T03:30:52.813
> 
> 标签：android, maven, ant, robolectric

I am trying to use [RobolectricSample application](https://github.com/pivotal/RobolectricSample) for unit testing Android application. In the instruction for installation of application with Maven the first step is

`ant maven-setup`. I could not understand why is this command required and what it will do?

Any explanation will be great help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T05:19:38.600

根据 Ant 构建文件[build.xml](https://github.com/pivotal/RobolectricSample/blob/master/build.xml#L147)，`ant maven-setup`做了两件事：

*   **行家安装罐子：**

    将 2 个所需的 jar 库（guice-2.0-no_aop.jar 和 maps.jar）安装到 Maven 本地存储库中。

*   **maven-set-android-sdk：**

    如果 <path> 在 android-maven-plugin 中定义，则重置 pom.xml 中的 Android SDK 路径。

这不是一个优雅的解决方案，理想情况下，所有这些任务都应该完全由 Maven 处理。但是，由于该项目同时提供 Ant 和 Maven 构建，因此它在 Maven 构建生命周期中重用来自 Ant 的脚本以方便使用。

# eclipse-plugin - 现有编辑器的 Eclipse 插件

> ID：12380834
> 
> 赞同：1
> 
> 时间：2012-09-12T03:30:55.720
> 
> 标签：eclipse-plugin, editor, content-assist

我想制作一个有助于 Java 编辑器中的内容辅助菜单的插件。我想建议一些选项，插入代码并从编辑器中获取代码。这可能吗？到目前为止，我发现的只是创建新的编辑器，但我只需要弄乱现有的编辑器。这可以实现吗？我什至应该如何开始？任何帮助，将不胜感激！

# java - 如何相对于标记翻转 ByteBuffer？

> ID：12380835
> 
> 赞同：2
> 
> 时间：2012-09-12T03:31:08.963
> 
> 标签：java, nio

有没有一种内置的方法，或者，什么是最干净的方法来相对于标记翻转 java NIO ByteBuffer？

即，`flip()`设置`limit := position`然后`position := 0`。我想要一个设置然后的`flipToMark()`例程。`limit := position``position := mark`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T03:33:18.213

翻转清除标记，所以不幸的是`buffer.flip().reset()`不会工作。

怎么样`buffer.limit(buffer.position()).reset()`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-23T09:22:07.430

`mark`在许多情况下，从（例如使用）开始创建视图缓冲区可能更容易`slice()`，而不是实际设置`mark`. 在这种情况下，您可以使用常规`flip()`方法。

# java - StringIndexOutOfBoundsException：字符串索引超出范围 0

> ID：12380837
> 
> 赞同：0
> 
> 时间：2012-09-12T03:31:25.297
> 
> 标签：java, indexing

我正在尝试编写一个程序来获取用户输入的第一个字母来生成用户名。我正在尝试编写它，以便如果用户将输入留空，则用于生成用户名的字母默认为字母“z”。

这是我的完整代码：

```
 import java.util.Scanner;
    /**
      UsernameGenerator.java
      Generates a username based on the users inputs.
      @author: Evan Fravert
      */
public class UsernameGenerator {
/**
  * Generates a username based on the users inputs.
  *@param args command line argument
  */
  public static void main(String[] args)
{ // abcde
  String first;
  String middle;
  String last;
  String password1;
  String password2;
  int randomNum;
  randomNum = (int) (Math.random() * 1000) + 100;
  Scanner userInput = new Scanner(System.in);
  System.out.println("Please enter your first name:");
  first = userInput.nextLine();
  String firstLower = first.toLowerCase();
  System.out.println("Please enter your middle name:");
  middle = userInput.nextLine();
  String middleLower = middle.toLowerCase();
  System.out.println("Please enter your last name:");
  last = userInput.nextLine();
  int lastEnd = last.length()-1;
  String lastLower = last.toLowerCase();
  System.out.println("Please enter your password:");
  password1 = userInput.nextLine();
  System.out.println("Please enter your password again:");
  password2 = userInput.nextLine();

  char firstLetter = firstLower.charAt(0);
  char middleLetter = middleLower.charAt(0);
  char lastLetter = lastLower.charAt(0);
  char lastLast = lastLower.charAt(lastEnd);

  if first.length() == 0) {
      firstLetter = 'z';
  }
  else {
  firstLetter = firstLower.charAt(0);
  }

  System.out.println("Your username is " + firstLetter + ""
  + middleLetter + "" + lastLetter + "" + "" + lastLast + "" + randomNum); 
  System.out.println("Your password is " + password1);
  System.out.println("Welcome " + first + " " + middle + " " + last + "!");
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:36:23.470

这是行不通的：

```
char firstLetter = firstLower.charAt(0);
...

if (first.length() == 0) {
    firstLetter = 'z';
} 
```

如果长度为0，那么`charAt(0)`会在标题中抛出异常。你可以这样做：

```
char firstLetter = first.length() == 0 ? 'z' : firstLower.charAt(0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:36:02.340

这里可能会抛出异常：

```
char firstLetter = firstLower.charAt(0); 
```

您在检查输入是否为空`charAt(0)` *之前调用。*尝试这样的事情：

```
char firstLetter = first.isEmpty() ? 'z' : firstLower.charAt(0); 
```

请注意，这`first.isEmpty()`是一个等价的表达式`first.length() == 0`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T06:45:29.117

你从这条线得到例外

```
char firstLetter = firstLower.charAt(0); 
```

低于一个就足以得到第一个字母。所以只保留这个

```
char firstLetter;
if (first.length() == 0) {
      firstLetter = 'z';
  }
  else {
  firstLetter = firstLower.charAt(0);
  } 
```

以同样的方式，您必须检查其他输入字符串值

# java - 将数据从标准输出写入java中的文本文件不起作用

> ID：12380838
> 
> 赞同：2
> 
> 时间：2012-09-12T03:31:33.153
> 
> 标签：java, file-io, bufferedreader, redirectstandardoutput, printstream

我是 Java 编程的新手，并且一直在尝试使以下代码正常工作，但是尽管程序运行良好，但我似乎没有在将输出重定向到的文本文件中看到任何输出。如果有人可以请帮助我，我将非常感激。以下是整个代码。我遇到的问题是只有一行被写入文本文件，而且我在任何时间点文件中只有一行。我知道这与循环和每次重新初始化的对象有关，但我不知道如何克服这个问题，我知道这将是一个非常基本的错误。但我现在看不到它，所以任何帮助将不胜感激。感谢所有已经尝试提供帮助的人，您的建议非常有帮助。

```
 PrintStream out;
    for(int count = 0; count<list2.size(); count++)
    {

            String originalString = list2.get(count);
            try {
                BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
                String readLine = br.readLine();
                out = new PrintStream(new FileOutputStream("/Users/xyz/Desktop/metaDataFormatted.txt"));
                System.out.println(readLine);
                System.setOut(out);
                //out.flush();
                //out.close();

                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                    System.out.println("Error During Reading/Writing");
                }
                System.out.println(count+" >");
                //the following line is a method from another class which produces all the output on standard out.
                                    md.getHomePageLinks(originalString);

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:46:17.067

`System.out.println(data)`在关闭流之前尝试调用。

```
 System.out.println(readLine);
 System.setOut(out); 
```

# sql - SQL 查询 - 在同一事件中显示具有相同结果的竞争对手

> ID：12380839
> 
> 赞同：0
> 
> 时间：2012-09-12T03:31:33.953
> 
> 标签：sql

我正在尝试从假设表“结果”中选择在同一事件中获得相同排名的竞争对手。有谁知道这个查询有什么问题？

我似乎只得到相同的竞争对手编号，而不是不同的竞争对手编号。

```
Select Eventid, Place, c1.Competitornum, c2.Competitornum
From Results natural join Results c2
Where c1.Place = c2.Place 
and c1.Eventid = c2.Eventid
Order by Eventid, Place 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:44:11.560

A`natural join`过滤所有相同的字段。这意味着您当前的`where`条款是多余的。这也意味着连接条件包括`Compititornum`，解释为什么你只得到相同的行`Competitornum`。

而不是一个`natural join`，尝试一个`inner join`。使用 an`inner join`您可以在`on`子句中显式设置连接条件：

```
select  c1.Eventid
,       c1.Place
,       c1.Competitornum
,       c2.Competitornum
from    Results c1
inner join 
        Results c2
on      c1.Place = c2.Place 
        and c1.Eventid = c2.Eventid
        and c1.Competitornum <> c2.Competitornum 
```

# eclipse - 无法运行从 Bazaar 导入的 eclipse 项目

> ID：12380840
> 
> 赞同：0
> 
> 时间：2012-09-12T03:31:36.183
> 
> 标签：eclipse, bazaar

我正在尝试运行从 Bazaar 存储库导入的项目。我无法让它工作，有一些消息“无法启动选择，并且没有最近的启动”。有什么解决方法吗？

# node.js - 使用 node.js 生成 PNG 图像

> ID：12380841
> 
> 赞同：16
> 
> 时间：2012-09-12T03:31:50.663
> 
> 标签：node.js

是否可以使用 Node.js 从像素数据数组创建 PNG 图像？我想从一组 RGBA 值创建一个 PNG 图像，然后将其保存到文件中。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2017-03-06T20:33:03.893

您可以使用[jimp](https://github.com/oliver-moran/jimp)。

```
const Jimp = require('jimp');

let imageData = [
  [ 0xFF0000FF, 0xFF0000FF, 0xFF0000FF ],
  [ 0xFF0000FF, 0x00FF00FF, 0xFF0000FF ],
  [ 0xFF0000FF, 0xFF0000FF, 0x0000FFFF ]
];

let image = new Jimp(3, 3, function (err, image) {
  if (err) throw err;

  imageData.forEach((row, y) => {
    row.forEach((color, x) => {
      image.setPixelColor(color, x, y);
    });
  });

  image.write('test.png', (err) => {
    if (err) throw err;
  });
}); 
```

此代码使用数组中定义的颜色创建一个 3x3 像素的 png 文件。

# vb.net - 程序无法在另一台计算机上运行， 未处理的异常。参数无效

> ID：12380843
> 
> 赞同：1
> 
> 时间：2012-09-12T03:32:23.870
> 
> 标签：vb.net, exe, unhandled

通过搜索论坛尝试修复此程序 5 小时，现在已经很累了。没有任何帮助，我想我的耐心可能已经耗尽。

这是我正在做的事情的清单。

1st-我“发布”将所有内容编译成 .exe 和资源文件夹的程序 2nd-在我的计算机上完美运行 3rd-将其复制到我的另一台计算机（最终重命名文件夹和所有内容完全相同） 4th-打开.exe，弹出这个可笑的无用错误，说我的应用程序第 5 次出现未处理的异常 - 以任何方式继续，我的表单缺少背景、另外 3 个图像、2 个标签和一些绘图。但它有 6 个标签和 2 个图片框，我不明白为什么标签、背景和其他图片框没有加载……这非常令人沮丧，任何小的逻辑建议都会有所帮助。

注意：程序长 1378 行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:42:56.537

图像是否编译为资源？如果没有，它们可能需要在部署期间显式复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T22:34:45.373

解决它。我的图像是从 C:/... 调用的，因此需要从 My.Resources 调用它们。

# mysql - 合并两个mysql表的一些列，其中id = fileid

> ID：12380848
> 
> 赞同：3
> 
> 时间：2012-09-12T03:32:59.407
> 
> 标签：mysql, sql

有两张桌子

```
TableA
filedata_id | user_id | filename
1           | 1       | file.txt
2           | 1       | file2.txt

TableB   
a_id        | date    | filedataid | counter | state | cat_id | subcat_id | med_id
99          | 1242144 | 1          | 2       | v     | 55     |  56       | 90
100         | 1231232 | 2          | 3       | i     | 44     |  55       | 110 
```

我想将列 cat_id、subcat_id、med_id 移动到 TableA 其中 tableA.filedata_id = TableB.filedataid

编辑：结果应该是 tableA 中的架构更改，因此它如下所示，并且还包含 tableB 中这些列的数据：

```
TableA
filedata_id | user_id | filename  | cat_id | subcat_id | med_id
1           | 1       | file.txt  | 55     | 56        | 90
2           | 1       | file2.txt | 44     | 55        | 110 
```

等等。

有没有办法轻松做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T03:36:12.743

~~您可以`INNER JOIN`为此使用：~~

 ~~```
SELECT t1.filedata_id, t1.user_id, t1.filename
      ,t2.cat_id, t2.subcat_id, t2.med_id
FROM TableA t1 
INNER JOIN TableB t2 
ON t1.filedata_id = t2.filedataid 
```~~ 

~~[看到这个 SQLFiddle](http://sqlfiddle.com/#!2/7ba4b/1)~~

**更新：**

您可以像这样更改架构`TableA`：

```
ALTER TABLE TableA
Add column cat_id int, 
Add column  subcat_id int, 
Add column  med_id int; 
```

`TableA`并像这样更新from的新列`TableB`：

```
UPDATE tableA t1 
       JOIN tableB t2 
       ON t1.filedata_id = t2.filedataid
SET t1.cat_id = t2.cat_id,
    t1.subcat_id = t2.subcat_id,
    t1.med_ID = t2.med_ID; 
```

# [*看到这个 SQLFiddle*](http://sqlfiddle.com/#!2/a53c5/2)

有关更多信息，请参阅[MySQL：ALTER TABLE 语法](http://dev.mysql.com/doc/refman/5.1/en/alter-table.html)和[MySQL：UPDATE 语法](http://dev.mysql.com/doc/refman/5.0/en/update.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T03:35:09.217

~~你可以用`INNER JOIN`这个，~~

 ~~```
SELECT  a.*,
        b.cat_id,
        b.subcat_id,
        b.med_ID
FROM    TableA a
        INNER JOIN TableB b
            On a.filedata_id = b.filedataid 
```~~ 

# ~~[*SQLFiddle 演示*](http://sqlfiddle.com/#!2/7026e/3)~~

在您的评论中看到，您需要更改表并在其上添加列，为此您需要执行此 DDL 语句，

```
ALTER TABLE TableA ADD COLUMN cat_id int;
ALTER TABLE TableA ADD COLUMN subcat_id int;
ALTER TABLE TableA ADD COLUMN med_ID int; 
```

那么您现在可以`TableA`根据以下值更新您的行`TableB`

```
UPDATE tableA t1 INNER JOIN tableB t2 
        ON a.filedata_id = b.filedataid
SET a.cat_id = b.cat_id,
    a.subcat_id = b.subcat_id,
    a.med_ID = b.med_ID 
```

希望这是有道理的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T03:44:15.397

在这种情况下，您需要查看多表部分的[UPDATE](http://dev.mysql.com/doc/refman/5.0/en/update.html)。

> 您还可以执行覆盖多个表的 UPDATE 操作。但是，您不能将 ORDER BY 或 LIMIT 与多表 UPDATE 一起使用。table_references 子句列出了连接中涉及的表。它的语法在第 13.2.8.2 节，“JOIN 语法”中描述。这是一个示例： UPDATE items,month SET items.price=month.price WHERE items.id=month.id;

就像是

```
UPDATE  TableA, TableB
SET     TableA.cat_id = TableB.cat_id,
        TableA.subcat_id = TableB.subcat_id,
        TableA.med_ID = TableB.med_ID
WHERe   TableA.filedata_id = TableB.filedataid 
```

要更改表（将列添加到 TableA），请查看[ALTER TABLE Syntax](http://dev.mysql.com/doc/refman/5.1/en/alter-table.html)

# c# - Quartz.Net - 使用 JobFactory 时如何分配触发器

> ID：12380849
> 
> 赞同：2
> 
> 时间：2012-09-12T03:32:59.540
> 
> 标签：c#, quartz.net, quartz.net-2.0

好的，这是一个新手问题，我通过网络搜索找不到任何线索，这是我的问题：

从示例通常触发器和使用`IScheduler.ScheduleJob(job, trigger)`现在安排的作业中，我使用了我尝试使用的 JobFactory，`IScheduler.ScheduleJob(trigger)`但以**触发器的相关作业名称不能为空**异常结束

这是我的简单代码：

**工作**

```
class DummyJob : IJob
{
    public void Execute(IJobExecutionContext context)
    {
        Console.WriteLine("executed");
    }
} 
```

**工作工厂**

```
class JobFactory : IJobFactory
{
    public IJob NewJob(TriggerFiredBundle bundle, IScheduler scheduler)
    {
        return new DummyJob();
    }
} 
```

**主程序**

```
class Program
{
    static void Main(string[] args)
    {
        ISchedulerFactory sf = new StdSchedulerFactory();
        IScheduler sc = sf.GetScheduler();

        ITrigger trigger = TriggerBuilder.Create()
            .ForJob()
            .StartAt(DateTime.Now.AddSeconds(5))
            .Build();

        sc.JobFactory = new JobFactory();
        sc.ScheduleJob(trigger);
        sc.Start();

        Console.WriteLine("waiting...");
        Console.ReadLine();
        sc.Shutdown();
    }
} 
```

任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T11:04:05.517

就调度而言，我认为您不应该仅仅因为您使用自己的 JobFactory 而做任何不同的事情。

您的主程序无效，因为它不知道您要安排什么工作。

您的示例可能过于简化，并没有给出明确的想法或您试图通过 JobFactory 实现的目标，但也许值得指出 JobFactory 的目的不是指定要运行**的**作业，而是指定**如何**运行一个特定的作业应该开始，因此期望 bundle.JobDetail 包含有关运行哪个作业的信息。

# java - Java 套接字编程 - 在 Android 4.1 中不起作用？

> ID：12380850
> 
> 赞同：1
> 
> 时间：2012-09-12T03:33:16.177
> 
> 标签：java, android, sockets, socketexception, android-4.2-jelly-bean

在我的 Android 项目中，我只有一个 Activity - “MainActivity.java”。我在同一个包“GetSocket.java”中添加了另一个类文件。

GetSocket.java 的功能是它将通过 Socket 连接返回一个字符串到网站中托管的特定服务器。如果作为 Java 应用程序单独运行，GetSocket.java 工作得很好。

但是当我从 Android Activity 调用它时，它不会返回我想要的消息，它只是失败了，我也无法获得 StackTrace 的异常。

请注意，这是在 Android 4.1 版本中运行时的结果。

但同样的代码在 Android 2.2 中也能正常工作，并得到了我想要的信息。

MainActivity.java

```
public class MainActivity
{
TextView t= (TextView) getViewById(R.id.textView1);
//..
//some code
//..
String msg=GetSocket.getMessage();

//..
//some more code
//
} 
```

GetSocket.java

```
public class GetSocket
{
 public static String getMessage()
 {
  String b;
  Socket s=new Socket("<IP-Address",<Port-number>);
  InputStream i=s.getInputStream();
  int length=i.read(b)
  return b;
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T20:34:02.100

抱歉回复晚了。找到我的解决方案的问题。从 4.0 开始，Android 不允许通过 UI 线程进行套接字编程。我使用 Async Task 在单独的后台线程中处理套接字。有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:52:29.350

检查您的清单以获得互联网许可:)

# c# - .Net Framework 中的手动内存分页（是否可能/如何？）

> ID：12380852
> 
> 赞同：4
> 
> 时间：2012-09-12T03:33:17.573
> 
> 标签：c#, memory-management, clr, ramdisk

我对编写数据库管理系统有很大的兴趣。阅读了几页关于如何实现 SQL Server 2000 的内容后，我发现使用了 4KB 内存页面，每个页面都是硬盘上 4KB 页面的直接副本。这些页面根据需要加载到 RAM 中，然后在空闲时懒惰地写回磁盘（过于简单化）。

在我项目的规划阶段，我想知道在 CLR 上运行的代码中是否可以实现这种级别的控制。我意识到 C、C++ 或[D](http://dlang.org/)可能更适合这项任务，但我想先向自己证明这一点。这背后的部分动机是我最终希望用我自己的实际覆盖 CLR 垃圾收集器，使用我的数据库作为堆，至少对于相对陈旧的对象。

是否可以直接从 CLR 控制内存？如果是这样，我该怎么做？

现在假设我的数据是一堆 256 字节宽的结构/类，存储在磁盘上的一个平面表中，并且我正在使用 64KB 页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T04:00:47.967

有点。您可以在 .NET 中使用[内存映射文件](http://msdn.microsoft.com/en-us/library/dd997372.aspx)，以便写入“内存”实际上是写入磁盘。

# php - 如果不存在，则将名称插入表中

> ID：12380856
> 
> 赞同：4
> 
> 时间：2012-09-12T03:33:51.873
> 
> 标签：php, mysql, sql, unique

我正在尝试构建一个允许用户提交名称以添加到数据库表（runningList）的应用程序。在添加名称之前，我想对照另一个表（controlList）检查名字和姓氏。它必须存在于 (controlList) 中，否则回复名称无效。如果名称有效，我想检查名字和姓氏对（runningList）它确保它不已经存在。如果不存在，则插入名字和姓氏。如果存在，则回复名称已使用。

下面是在我尝试针对 controlList 添加测试之前有效的代码，我在尝试添加额外步骤时以某种方式完全破坏了它。

```
if (mysql_num_rows(mysql_query('SELECT * FROM runninglist WHERE firstname=\'' .$firstname . '\' AND lastname=\'' . $lastname . '\' LIMIT 1')) == 0)
{
 $sql="INSERT INTO runninglist (firstname, lastname)
 VALUES ('$_POST[firstname]','$_POST[lastname]')";
}
else
{
echo "This name has been used.";
 } 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:36:21.840

在 (firstname, lastname) 上创建一个“唯一”索引。

然后，当插入运行时，它将失败。只需忽略错误（或采取其他措施）

* * *

编辑：从[手册](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)中引用：

> UNIQUE 索引创建一个约束，使得索引中的所有值都必须是不同的。如果您尝试使用与现有行匹配的键值添加新行，则会发生错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T03:41:01.660

最好的方法是在两列上创建索引：`firstname`和`lastname`

```
ALTER TABLE youtableName ADD UNIQUE uniqueName (firstname,lastname) 
```

这样，当您尝试插入已存在的名称时会产生错误。

# c# - 如何在不将鼠标指针放在 IE 滚动条上的情况下滚动 IFrame？

> ID：12380858
> 
> 赞同：1
> 
> 时间：2012-09-12T03:34:14.747
> 
> 标签：c#, asp.net

我有这个 asp.net 页面如下。

```
<body>
    <form id="form1" runat="server">
    <div class="page" >
    <iframe id="iFrame1" style="width:100%" runat="server" 
    height="1100"  scrolling="yes"
    src="login.aspx"
     frameborder="0" align="left">
    </iframe>
    </div>
    </form>
</body> 
```

要滚动 iframe，我必须将鼠标指针放在 IE 滚动条上。我只想将鼠标指针放在 iframe 上并滚动页面。请建议。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:58:12.597

这是一个jQuery解决方案：

```
<div id="pane" style="width: 300px; height: 200px; overflow: auto;">
   <iframe id="iFrame1" width="800" height="600" src="login.aspx" scrolling="no">
   </iframe>
</div>

<script type="text/javascript">
$("#pane").hover(function()
{
  $("#pane").scrollTop(400).scrollLeft(400);
  return false;
});
</script> 
```

为了更平滑的滚动，您可以使用 jquery`animate`函数。

# rangy - Rangy将用户选择的边界移出标题元素

> ID：12380860
> 
> 赞同：0
> 
> 时间：2012-09-12T03:34:49.333
> 
> 标签：rangy

我正在使用 rangy 并且有一个带有 contenteditable div 的案例，其中可以保存用户选择并稍后恢复，以便可以插入 HTML。

我的问题是，如果用户在标题元素中进行选择，我不希望将 html 插入标题中。

所以我试图弄清楚如何使用 rangy 以便如果在标题中进行选择，那么我可以将它移动到标题元素之前。

因此，如果用户在 h1 中选择：

```
<div id="editable" contenteditable>
     <h1>|user selects here| Header Text</h1>
</div> 
```

然后将保存的选择移到 h1 之前：

```
| selection boundary moved here |<div id="editable" contenteditable>
     <h1>|user selects here| Header Text</h1>
</div> 
```

我尝试了以下方法来查看是否可以移动选择边界：

```
var sel = rangy.getSelection();
var range = sel.getRangeAt(0);

range.setStartBefore(sel.anchorNode.parentNode);

sel.removeAllRanges();
sel.addRange(range);

selected = rangy.saveSelection(); 
```

但是当我在 H1 中选择时，它仍然在 H1 内而不是在它之前设置保存的选择边界。我不确定如何在标题元素之前移动边界。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:58:42.397

我不知道如何用 rangy 来做这件事，最后最终用 jQuery 处理了清理工作。不确定这是否是最好的方法，但它对我有用。基本上，我想删除任何可能放置在标题中的 div：

```
$('#cleanup').click(function(e){

        e.preventDefault();

        var header, clone;

        // loop through each header element
        $(#editor :header').each(function(){

            // assign header element to variable
            header = $(this);

            // go through the header's children
            $(header).children().each(function(){

                // if we have a div in the header,
                if( $(this).is("div")){ 

                    // clone it
                    clone = $(this).clone();

                    // put clone before the header
                    $(header).before(clone);

                    // remove the original from the header
                    $(this).remove();

                }

            });

        });

}); 
```

# database - Delphi - 根据当前记录值更改文本颜色

> ID：12380873
> 
> 赞同：2
> 
> 时间：2012-09-12T03:36:47.753
> 
> 标签：database, delphi, firebird

使用连接到 FireBird 数据库的 db 控件。我有一个简单的 dblabel 我想根据当前记录的当前值更改文本颜色

用户使用 dbnavigator 进行导航，我在导航器按钮单击时编写了代码。但是有一个问题，代码总是读取上一个记录值而不是当前记录值，所以颜色是错误的！例如：

```
procedure <navigator button click>;
begin
  if table1.FieldByName('field1').AsString = 'val1' then
    <dblabel.textcolor> := red
  else
    <dblabel.textcolor> := green; 

end; 
```

但正如我所说，价值落后了一项记录。为什么会这样，更改标签文本颜色的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:59:42.320

`OnButtonClick`在更改数据集中的活动记录之前触发导航器的事件。一种可能的解决方案是将您的代码与`OnAfterScroll`DataSet 的事件挂钩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T04:05:15.667

使用 DataSource.OnDataChange 事件处理程序

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T10:15:27.443

你可以使用一堆事件！

*   TDataSource.OnDataChange
*   TJvDataSource.OnDatasetScrolled
*   DataSet.AfterScroll 加上 DataSet.AfterOpen

演示EXE：[http](http://rghost.ru/40321071) ://rghost.ru/40321071 （最左边的按钮是“下载”）

DFM：

```
object Form1: TForm1
  Left = 0
  Top = 0
  BorderIcons = [biSystemMenu, biMinimize]
  BorderStyle = bsSingle
  Caption = 'Form1'
  ClientHeight = 301
  ClientWidth = 685
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -13
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  OnCreate = FormCreate
  OnHide = FormHide
  PixelsPerInch = 120
  TextHeight = 16
  object dbgrd1: TDBGrid
    Left = 8
    Top = 8
    Width = 425
    Height = 277
    DataSource = ds1
    ReadOnly = True
    TabOrder = 0
    TitleFont.Charset = DEFAULT_CHARSET
    TitleFont.Color = clWindowText
    TitleFont.Height = -13
    TitleFont.Name = 'Tahoma'
    TitleFont.Style = []
  end
  object edtL_DS_ODC: TLabeledEdit
    Left = 448
    Top = 24
    Width = 200
    Height = 24
    EditLabel.Width = 163
    EditLabel.Height = 16
    EditLabel.Caption = 'TDataSource.OnDataChange'
    ReadOnly = True
    TabOrder = 1
  end
  object edtL_JDS_ODS: TLabeledEdit
    Left = 448
    Top = 104
    Width = 200
    Height = 24
    EditLabel.Width = 194
    EditLabel.Height = 16
    EditLabel.Caption = 'TJvDataSource.OnDatasetScrolled'
    ReadOnly = True
    TabOrder = 2
  end
  object edtL_T_AS: TLabeledEdit
    Left = 448
    Top = 184
    Width = 200
    Height = 24
    EditLabel.Width = 117
    EditLabel.Height = 16
    EditLabel.Caption = 'TDataSet.AfterScroll'
    ReadOnly = True
    TabOrder = 3
  end
  object pnl1: TPanel
    Left = 480
    Top = 48
    Width = 105
    Height = 25
    BevelOuter = bvLowered
    Caption = 'pnl1'
    Color = clBlack
    ParentBackground = False
    TabOrder = 4
    object dbtxt1: TDBText
      Left = 24
      Top = 6
      Width = 65
      Height = 17
      DataField = 'Dummy'
      DataSource = ds1
    end
  end
  object pnl2: TPanel
    Left = 480
    Top = 128
    Width = 105
    Height = 25
    BevelOuter = bvLowered
    Caption = 'pnl1'
    Color = clBlack
    ParentBackground = False
    TabOrder = 5
    object dbtxt2: TDBText
      Left = 24
      Top = 6
      Width = 65
      Height = 17
      DataField = 'Dummy'
      DataSource = ds1
    end
  end
  object pnl3: TPanel
    Left = 480
    Top = 208
    Width = 105
    Height = 25
    BevelOuter = bvLowered
    Caption = 'pnl1'
    Color = clBlack
    ParentBackground = False
    TabOrder = 6
    object dbtxt3: TDBText
      Left = 24
      Top = 6
      Width = 65
      Height = 17
      DataField = 'Dummy'
      DataSource = ds1
    end
  end
  object dbnvgr1: TDBNavigator
    Left = 439
    Top = 260
    Width = 240
    Height = 25
    DataSource = ds1
    Kind = dbnHorizontal
    TabOrder = 7
  end
  object ds1: TDataSource
    DataSet = data
    OnDataChange = ds1DataChange
    Left = 24
    Top = 80
  end
  object ds2: TJvDataSource
    DataSet = data
    OnDataSetScrolled = ds2DataSetScrolled
    Left = 64
    Top = 80
  end
  object data: TClientDataSet
    Aggregates = <>
    Params = <>
    AfterScroll = dataAfterScroll
    Left = 24
    Top = 24
    object fldValue: TIntegerField
      FieldName = 'Value'
    end
    object fldDummy: TIntegerField
      FieldName = 'Dummy'
    end
  end
end 
```

考绩：

```
type
  TForm1 = class(TForm)
    ds1: TDataSource;
    ds2: TJvDataSource;
    data: TClientDataSet;
    fldValue: TIntegerField;
    fldDummy: TIntegerField;
    dbgrd1: TDBGrid;
    edtL_DS_ODC: TLabeledEdit;
    edtL_JDS_ODS: TLabeledEdit;
    edtL_T_AS: TLabeledEdit;
    dbtxt1: TDBText;
    pnl1: TPanel;
    pnl2: TPanel;
    dbtxt2: TDBText;
    pnl3: TPanel;
    dbtxt3: TDBText;
    dbnvgr1: TDBNavigator;
    procedure FormCreate(Sender: TObject);
    procedure dataAfterScroll(DataSet: TDataSet);
    procedure ds1DataChange(Sender: TObject; Field: TField);
    procedure ds2DataSetScrolled(Sender: TObject);
    procedure FormHide(Sender: TObject);
  private
    { Private declarations }
    procedure ShowIt(const el: TLabeledEdit; Const color, value: integer); overload;
    procedure ShowIt(const el: TLabeledEdit); overload;
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
var i,j,k: integer;
begin
   data.CreateDataSet;

   for i := 1 to 20 do begin
       j := Random(100) - 50;
       k := Random(20);
       data.AppendRecord([j,k]);
   end;
end;

procedure TForm1.FormHide(Sender: TObject);
begin
  data.Close;
end;

procedure TForm1.ShowIt(const el: TLabeledEdit);
begin
  ShowIt(el, fldValue.AsInteger, fldDummy.AsInteger);
end;

procedure TForm1.ShowIt(const el: TLabeledEdit; const color, value: integer);
begin
  if el = nil then exit;

  if color < 0 then el.Color := clYellow
               else el.Color := clWhite;

  el.Text := IntToStr(color) + ' ==> ' + IntToStr(value);

  dbtxt1.Font.Color := edtL_DS_ODC.color;
  dbtxt2.Font.Color := edtL_JDS_ODS.color;
  dbtxt3.Font.Color := edtL_T_AS.color;
end;

procedure TForm1.dataAfterScroll(DataSet: TDataSet);
begin
 ShowIt(edtL_T_AS);
end;

procedure TForm1.ds1DataChange(Sender: TObject; Field: TField);
begin
 ShowIt(edtL_DS_ODC);
end;

procedure TForm1.ds2DataSetScrolled(Sender: TObject);
begin
 ShowIt(edtL_JDS_ODS);
end; 
```

# json - 遍历 facebook 评论 JSON 对象失败

> ID：12380874
> 
> 赞同：0
> 
> 时间：2012-09-12T03:36:58.883
> 
> 标签：json, facebook-comments

我尝试了students.item [“http://www.myurl.com”].comments.data.length的选项。但是，item["http://www.myurl.com"] 调用不起作用。

如果我从 JSON 对象中取出 URL 并使用 student.comments.data 编写迭代器，它就可以工作。

这是我的代码，非常感谢任何帮助。

```
var students = {
    "http://www.myurl.com":{
        "comments":{
                "data" : [{
                    "id": "123456778",
                    "from": {
                        "name": "XYZ",
                        "id": "1000005"
                        },
                    "message": "Hey",
                    "can_remove": false,
                    "created_time": "2012-09-03T03:16:01+0000",
                    "like_count": 0,
                    "user_likes": false
                }] 
            }
        }
    }

var i=0
var arrayObject = new Array();
alert("Parsing 2:   "+students.item["http://www.myurl.com"].comments.data.length);
for(i=0;i<students.item["http://www.myurl.com"].comments.data.length;i++)
{
    alert("Parsing 1:  "+i);
    arrayObject.push(students.item["http://www.myurl.com"].comments.data[i].id);
    arrayObject.push(students.item["http://www.myurl.com"].comments.data[i].message);
    arrayObject.push(students.item["http://www.myurl.com"].comments.data[i].created_time);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:50:59.480

该`students`对象只有没有`item`属性`http://www.myurl.com`。`students["http://www.myurl.com"]`不使用`students.item["http://www.myurl.com"]`

# ios - AVAudioPlayer 播放歌曲序列循环播放同一首歌曲，但没有声音

> ID：12380878
> 
> 赞同：1
> 
> 时间：2012-09-12T03:37:16.523
> 
> 标签：ios, asynchronous, avaudioplayer

我已经尝试解决这个错误大约 24 小时了。我有一个简单的音乐播放器，可以加载一些歌曲，然后一首又一首地播放。

问题是，在歌曲结束时不会随机调用 didFinishPlayingAudio。相反，同一首歌会循环回到开头而没有声音输出，这让我的音乐播放器出现严重缺陷！

最近发现AVAudioPlayer的播放功能是异步的，怀疑是这个问题。我检查了我的代码并检查了播放器在发布之前是否已停止，并且新的播放器已正确保留。一切正常，除了这个偶尔的严重错误。当我在进度条上滑动时，音乐将再次播放，并且通过阅读我认为这与正确的音频播放器重新关联为主播放器有关。

我尝试使用 ObjectAL 来解决这个问题，但问题是状态栏播放图标不会消失，除非我禁用接收远程控制事件，这对于音乐播放器来说是不可接受的。但是，如果有关闭播放图标的好方法，这也将是我讨厌的错误的解决方案！

非常感谢你读到这里！！希望对此有一些想法，谢谢！

# ios - 如何更有效地实现 GPUImageWhiteBalanceFilter 和 uiElement 混合？

> ID：12380882
> 
> 赞同：2
> 
> 时间：2012-09-12T03:39:01.297
> 
> 标签：ios, gpuimage, uielement, avcapture

我正在开发一个使用 GPUImage 框架的应用程序。我想使用 GPUImageWhiteBalanceFilter 来调整白平衡并使用 uiElement blend 记录一些水印，它可以工作，但是在 iphone 4s 中捕获 1080p 视频时帧速率很差。代码如下，任何人都可以提供帮助。

```
if (filter==nil) {
    filter = [[GPUImageWhiteBalanceFilter alloc] init];
}
[((GPUImageWhiteBalanceFilter *)filter) setTemperature:3000];
[videoCamera addTarget:filter];
GPUImageAlphaBlendFilter *blendFilter = [[GPUImageAlphaBlendFilter alloc] init];
blendFilter.mix = 0.8;

NSDate *startTime = [NSDate date];

UILabel *timeLabel = [[UILabel alloc] initWithFrame:CGRectMake(0.0, 0.0, 240.0f, 320.0f)];
timeLabel.font = [UIFont systemFontOfSize:17.0f];
timeLabel.text = @"Time: 0.0 s";
timeLabel.textAlignment = UITextAlignmentCenter;
timeLabel.backgroundColor = [UIColor clearColor];
timeLabel.textColor = [UIColor whiteColor];

uiElementInput = [[GPUImageUIElement alloc] initWithView:timeLabel];

[filter addTarget:blendFilter];
[uiElementInput addTarget:blendFilter];

[blendFilter addTarget:filterView];

__unsafe_unretained GPUImageUIElement *weakUIElementInput = uiElementInput;

[filter setFrameProcessingCompletionBlock:^(GPUImageOutput * filter, CMTime frameTime){

    timeLabel.text = [NSString stringWithFormat:@"Time: %f s", -[startTime timeIntervalSinceNow]];
    [weakUIElementInput update];
}];

NSString *pathToMovie = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/CPMovie.mov"];
unlink([pathToMovie UTF8String]); // If a file already exists, AVAssetWriter won't let you record new frames, so delete the old movie
NSURL *movieURL = [NSURL fileURLWithPath:pathToMovie];
movieWriter = [[GPUImageMovieWriter alloc] initWithMovieURL:movieURL size:CGSizeMake(videoDimensions.width , videoDimensions.height)];
//[videoCamera addTarget:movieWriter];
//to record filtered video
[blendFilter addTarget:movieWriter];
[videoCamera startCameraCapture]; 
```

# java - YUI Compressor 2.4.7 无法压缩js文件

> ID：12380885
> 
> 赞同：0
> 
> 时间：2012-09-12T03:40:07.870
> 
> 标签：java, javascript, yui-compressor

我使用了这个命令：

```
java -jar yuicompressor-2.4.7.jar -o '.js$:-min.js' *.js 
```

我得到了`'.js$`在 Windows 7 上命名的 0KB 文件

为什么？

我应该怎么做才能压缩批处理 js 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T04:45:13.873

以下命令对我有用（在没有任何引号的 Win7 上），但我不知道为什么。

```
java -jar yuicompressor-2.4.7.jar -o .js$:-min.js *.js 
```

如果有人可以分享一些见解，将不胜感激。提前致谢。

编辑：

我创建了一个简单的批处理文件（将其命名为`test.bat`），其中包含以下内容，试图弄清楚实际发生了什么。

```
@echo off
for %%a in (%*) do (
echo %%a
) 
```

当我用 运行它时`test.bat -o '.js$:-min.js' *s`，它给出了如下内容：

```
-o
'.js$:-min.js'
fb.js
test.cs
test.js 
```

所以我认为命令提示符不会像 *nix 那样处理引号。

# socket.io - 如何在上传的每个文件的进度状态上使用 node.js 和强大的 socket.io？

> ID：12380888
> 
> 赞同：0
> 
> 时间：2012-09-12T03:40:31.687
> 
> 标签：socket.io

我试图弄清楚如何将上传数据进度发送回客户端。似乎此事件执行了两次，并且带有先前的进度。

form.addListener('progress', function(bytesReceived, bytesExpected) {

```
 socket.sockets.on('connection', function(socket) {

                socket.emit('Uploaded', {
                    progress : (bytesReceived / bytesExpected * 100).toFixed(0)
                });
            });

        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T09:04:03.273

您可以将 socket.io 连接 ID 与您的文件上传请求一起发送。您可以从客户端代码中获取它，如下所示：

```
var socketio = io.connect();
// more code here
// once connected you can access the following prop:
console.log(socketio.socket.sessionid); 
```

在服务器端收到该`socket.sessionid`信息后，您可以查找连接并发出数据

```
io.sockets.socket(id).emit('uploaded', dataz); 
```

希望这可以帮助。

# asp.net - Visual Studio - ASP 网站 - 本地 IIS - 工作区名称是否可以包含在项目 URL 中

> ID：12380889
> 
> 赞同：1
> 
> 时间：2012-09-12T03:40:38.287
> 
> 标签：asp.net, visual-studio, iis, web, workspace

一些背景知识，我正在使用以下工具/环境：

*   视觉工作室 2012
*   TFS 2010
*   视窗服务器 2008 R2

我试图解决在使用多个工作区时使用映射到网站本地 IIS 的项目 URL 的问题。

示例：Workspace1 中的 Website1 设置为使用具有以下地址的本地 IIS Web 服务器：

`http://localhost/Website1`

如果我在 Workspace2 中打开此网站/项目，我会收到一条错误消息，告诉我：

`http://localhost/Website1 cannot be used because it already exists`

是否可以在项目 URL 中添加对工作区名称（不一定知道）的引用，例如`http://localhost/{WORKSPACE_NAME}/Website1`. 这意味着如果我在 Workspace1 中打开网站，它将被映射到`http://localhost/Workspace1/Website1`，如果我在 Workspace2 中打开它，它将被映射到`http://localhost/Workspace2/Website1`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T18:04:53.063

这可能不是您正在寻找的，但是...

如果您在“Web”选项卡的属性页面上取消选中“将服务器设置应用于所有用户（存储在项目文件中）”，它将创建一个 .user 文件并将其保存在工作区中，以便您可以为不同的项目 URL每个工作区。

我试图找到一种在项目 URL 中包含工作区名称的方法，但没有运气。这有点不那么神奇，但它有效。

# crystal-reports - Crystal Reports 组标题显示余额，而其详细信息显示另一个数字

> ID：12380896
> 
> 赞同：1
> 
> 时间：2012-09-12T03:41:17.307
> 
> 标签：crystal-reports

我正在做一份库存报告，查看每件商品的销售变动及其剩余库存会更有用。但是，我可以生成如下报告，但**粗体**中的值除外，即每个项目的剩余库存。我该怎么做才能在组标题中获得剩余余额？太感谢了。（注意 items1,2,.. 是组标题，customers1,2,3,... 是详细信息）

> item1 >>> **10 *（剩余库存）***
> 
> ```
>  (jan feb mar apr total)
> 
>   customer1        2   4   5   -   11 (sales)
>   customer2        -   2   1   1   4  (sales)
>   customer3        -   -   -   2   2  (sales)
>     total          2   6   6   3   17 
> ```
> 
> item2 >>> **56（剩余库存）**
> 
> ```
>  customer4        1   3   3   4   11 (sales)
>   customer2        -   3   5   2   10  (sales)
>   customer5        7   9   6   4   26  (sales)
>     total          8  15  14  10   47 
> ```

# c# - 是否可以使用 IOC 解析视图引擎？

> ID：12380898
> 
> 赞同：2
> 
> 时间：2012-09-12T03:41:50.053
> 
> 标签：c#, asp.net-mvc, inversion-of-control, castle-windsor

我有一个与我的 MVC4 Web 应用程序一起使用的自定义 ViewEngine。

我的注册目前是`Global.asax`这样的：

```
ViewEngines.Engines.Clear();
ViewEngines.Engines.Add(new CustomViewEngine()); 
```

在我`CustomViewEngine`的课堂上，我有通过 IOC 实现可用的类属性（使用 CastleWindsor）

目前我可以直接访问windsor解析器`CustomViewEngine`并解析它们，但我真正想做的是让windsor解析ViewEngine并免费获得所有这些位。无需明确执行。

这甚至可能吗？我希望 ViewEngine 然后按 WebRequest 进行解析。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:53:27.247

这样的事情怎么样？

```
 public class DependencyViewEngine : RazorViewEngine
    {
        public override ViewEngineResult FindPartialView(ControllerContext controllerContext, string partialViewName, bool useCache)
        {
            var result = base.FindPartialView(controllerContext, partialViewName, useCache);
            result.ViewEngine = // resolve view engine
            return result;
        }

        public override ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName, bool useCache)
        {
            var result = base.FindView(controllerContext, viewName, masterName, useCache);
            result.ViewEngine = // resolve view engine
            return result;
        }

    } 
```

然后

```
 ViewEngines.Engines.Clear();
    ViewEngines.Engines.Add(new DependencyViewEngine()); 
```

编辑：

如何实现依赖解析器以使用您的容器？

```
public class CustomDependencyResolver : IDependencyResolver
{
    public CustomDependencyResolver(IContainer container)
    {
       // ...
    }

    public object GetService(Type serviceType)
    {
        // pass resolution off to your container
    }
    public IEnumerable<object> GetServices(Type serviceType)
    {
        // pass resolution off to your container
    }
} 
```

然后

```
protected void Application_Start()
{
   ViewEngines.Engines.Clear();
   var resolver = new CustomDependencyResolver(container);
   DependencyResolver.SetResolver(resolver);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T08:26:47.797

您应该使用从 IDependencyResolver 派生的自定义依赖解析器服务。MVC 在解析 IViewEngine 接口时调用 IDependencyResolver.GetServices 方法。如果这个方法没有返回任何服务，MVC会调用传统的API（ViewEngines.Engines）。此外，这种方法返回的服务不止一个（它是具有竞争力的多服务模型）。尽管这种情况非常罕见，但它仍然存在。因此，只需使用您的自定义引擎实现 IViewEngine 接口，将其注册到您的容器中并使用自定义 IDependencyResolver 实现。

# c# - 当某些参数是委托时，是否可以在 C# 中使用“C++ 库函数”？

> ID：12380900
> 
> 赞同：2
> 
> 时间：2012-09-12T03:42:12.163
> 
> 标签：c#, c++, interop, dllimport, gaul

我通过
`[DllImport("C:\\gaul-windows.dll", ...)]`属性将 C++ 库用于 C# 解决方案。

我需要使用一个函数，它的一些参数是委托，它返回的类型也有一些委托作为字段。

我可以这样做吗？

我问是因为我尝试使用作为返回类型来做，`struct`但后来我得到了这个异常：**“方法的类型签名与 PInvoke 不兼容”**

所以我改变了它并尝试使用 IntPtr 作为返回类型，但后来我得到了这个异常：**无法编组“参数 #16”：无法编组通用类型。**

所以首先我想知道这是否可能？以这种方式使用这种功能。如果不可能，我将如何使用它？

**编辑**

我需要使用的功能

```
     [DllImport("C:\\gaul-windows.dll",
                 SetLastError = 真，
                 CallingConvention = CallingConvention.Cdecl)]
     公共外部静态 IntPtr ga_genesis_boolean(int population_size,
                                                         int num_chromo,
                                                         int len_chromo,
                                                         GAgeneration_hook generation_hook,
                                                         GAiteration_hook 迭代钩子，
                                                         GAdata_destructor data_destructor,
                                                         GAdata_ref_incrementor data_ref_incrementor,
                                                         GAevaluate 评估，
                                                         GAseed种子，
                                                         GAadapt适应，
                                                         GAselect_one select_one,
                                                         GAselect_two select_two,
                                                         GAmutate 变异，
                                                         GAcrossover 跨界车，
                                                         GAreplace替换，
                                                         诠释？用户数据）;

```

这是其中一位代表的示例

```
    [UnmanagedFunctionPointer(CallingConvention.Cdecl)]
    公共代表短 GAselect_one(
        参考人口流行，
        IntPtr 母亲）；

```

在[这里](https://www.dropbox.com/s/waixxdqppt4znkj/Gaul.cs)你可以得到整个班级。

最后这是我对函数的调用

```
    var x = Gaul.ga_genesis_boolean(30, /* const int population_size */
                                                  vehicle_num, /* const int num_chromo */
                                                  order_num, /* const int len_chromo */
                                                  IntPtr.Zero,// null, /* GAgeneration_hook generation_hook */
                                                  null, /* GAiteration_hook 迭代钩子 */
                                                  null, /* GAdata_destructor data_destructor */
                                                  null, /* GAdata_ref_incrementor data_ref_incrementor */
                                                  new GAevaluate(darp_score),/* GAevaluate 评估 */
                                                  new GAseed(Gaul.ga_seed_boolean_random), /* GAseed 种子 */
                                                  null, /* GAadapt 适应 */
                                                  new GAselect_one(Gaul.ga_select_one_bestof2),/* GAselect_one select_one */
                                                  new GAselect_two(Gaul.ga_select_two_bestof2),/* GAselect_two select_two */
                                                  new GAmutate(Gaul.ga_mutate_boolean_singlepoint), /* GAmutate mutate */
                                                  new GAcrossover(Gaul.ga_crossover_boolean_singlepoints), /* GAcrossover 交叉 */
                                                  null, /* GAreplace 替换 */
                                                  null /* vpointer 用户数据 */
                                                  );

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T05:14:14.913

是的，当它的某些参数是委托时，您可以使用 C++ 库函数。

我得到的错误“无法封送'参数＃16'：无法封送通用类型。” 不是关于委托参数，而是可以为空的整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:57:03.757

`DllImportAttribute`只能应用于方法定义。该方法定义定义了在 DLL 中声明的本机函数的签名。这意味着该方法必须是全局函数（并导出）并且不支持类函数。

您不能`DllImportAttribute`在结构和类等类型定义上使用。

如果要从 DLL 中导入非全局函数的方法，则必须创建全局函数来包装要导入的内容。

# vba - Excel 宏：浏览 Excel 文件并使用其工作表数据

> ID：12380901
> 
> 赞同：3
> 
> 时间：2012-09-12T03:42:23.433
> 
> 标签：vba, excel

我写了一个这样的脚本：

```
Sub Button_Click()
    objFile = Application.GetOpenFilename(fileFilter:="All Files (* . *) , * . * ") ' choose load path
    .....

    Call main_function
End Sub 
```

这是一个 Excel 宏按钮的脚本，用于让用户浏览文件。实际上，我想用它来加载一个 Excel 文件并在`main_function`（当前的 excel）中使用该 Excel 文件的数据。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T05:19:24.923

猜想您只想将用户限制为 Excel，所以我为您修改了过滤器

```
Dim pathString As String
Dim resultWorkbook As Workbook
Dim found As Boolean
pathString = Application.GetOpenFilename(fileFilter:="All Files (* . xl*) , *.xl* ")

' check if it's already opened
For Each wb In Workbooks
    If InStr(pathString, wb.Name) > 0 Then
        Set resultWorkbook = wb
        found = True
        Exit For
    End If
Next wb

If Not found Then
    Set resultWorkbook = Workbooks.Open(pathString)
End If

' then you can use resultWorkbook as a reference to the Excel Workbook Object 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-24T06:39:50.107

继续@Larry 的回答，如果需要通过 CodeName 引用工作表，您可以使用以下模块，或者如果想通过工作表名称引用，您可以使用工作表选项，感谢 MVP-Juan Pablo González 在另一个博客上的回答：

```
'Strating sub procedure to write VBA Code to Open an only Excel 2007 macro Files using File Dialog Box
Sub Browse_File()
Dim strFileToOpen As String
Dim Wbk_WeeklyTemplate As Workbook
Dim Tgt_ShtNm As String
Dim Src_ShtNm As String

'Choosing an Excel File using File dialog Box and capturing the file path in the variable
strFileToOpen = Application.GetOpenFilename(Title:="Please select the file to open", FileFilter:="Excel Files *.xlsm (*.xlsm),")

'Checking if file is selected
If strFileToOpen = "False" Then
    MsgBox "No file selected.", vbExclamation, "Sorry!"
    Exit Sub
Else
    Set Wbk_WeeklyTemplate = Workbooks.Open(strFileToOpen)
End If

''Refer sheet by Sheet CodeName
Src_ShtNm = SheetName(Wbk_WeeklyTemplate, "sheetCodeName")
Tgt_ShtNm = SheetName(ThisWorkbook, "sheetCodeName")

Wbk_WeeklyTemplate.Sheets(Src_ShtNm).Range("N15:X18").Copy
ThisWorkbook.Sheets(Tgt_ShtNm).Range("A1").PasteSpecial xlPasteValues

End Sub

''The function SheetName returns the actual name of the sheet by passing sheet code name
Function SheetName(Wb As Workbook, CodeName As String) As String
    SheetName = Wb.VBProject.VBComponents(CodeName).Properties("Name").Value
End Function 
```

MVP-Juan Pablo González 解决方案的链接： [https ://www.mrexcel.com/forum/excel-questions/58845-codename-selecting-sheets-through-visual-basic-applications.html](https://www.mrexcel.com/forum/excel-questions/58845-codename-selecting-sheets-through-visual-basic-applications.html)

希望有帮助。

# ios - iOS如何在弹出顶视图控制器时以编程方式检测？

> ID：12380905
> 
> 赞同：52
> 
> 时间：2012-09-12T03:43:41.970
> 
> 标签：ios, uinavigationcontroller, stack

假设我有一个带有 2 个视图控制器的导航控制器堆栈：VC2 位于顶部，VC1 位于下方。我可以在 VC1 中包含哪些代码来检测 VC2 刚刚从堆栈中弹出吗？

**由于我试图从 VC1 的代码中检测 VC2 的弹出，因此viewWillAppear**或**viewDidAppear**之类的东西似乎不起作用，因为每次显示 VC1 时都会触发这些方法，包括首次将其推入堆栈时。

**编辑：**我原来的问题似乎不是很清楚。这就是我想要做的：确定由于 VC2 从堆栈顶部弹出而显示 VC1 的时间。这就是我不想做的事情：确定何时显示 VC1，因为它被推到了堆栈的顶部。我需要一些方法来检测第一个动作而不是第二个动作。

注意：我并不特别关心 VC2，它可以是任何数量的其他 VC 从堆栈中弹出，我关心的是当 VC1 由于其他一些 VC 开始弹出而再次成为堆栈顶部时最佳。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-09-12T04:20:03.430

iOS 5 引入了两种新方法来处理这种情况。您正在寻找的是`-[UIViewController isMovingToParentViewController]`. 从[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)：

> **isMovingToParentViewController**
> 
> 返回一个布尔值，指示视图控制器正在添加到父级。
> 
> `- (BOOL)isMovingToParentViewController`
> 
> **返回值**
> 如果视图控制器出现是因为它是作为容器视图控制器的子级添加的，否则为否。
> 
> **讨论**
> 此方法仅在从以下方法内部调用时返回 YES：
> 
> `-viewWillAppear:`
> `-viewDidAppear:`

在您的情况下，您可以`-viewWillAppear:`像这样实现：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    if (self.isMovingToParentViewController == NO)
    {
        // we're already on the navigation stack
        // another controller must have been popped off
    }
} 
```

**编辑：**这里有一个微妙的语义差异需要考虑——您是否对 VC2 特别从堆栈中弹出这一事实感兴趣，或者您是否希望在每次 VC1 因*任何*控制器弹出而被显示时都得到通知？在前一种情况下，委托是一个更好的解决方案。如果您从不打算重用 VC2，那么对 VC1 的直接弱引用也可以工作。

**编辑 2：**我通过反转逻辑而不是提前返回来使示例更加明确。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-10-10T21:42:57.970

isMovingTo/FromParentViewController 不适用于推送和弹出导航控制器堆栈。

这是一种可靠的方法（不使用委托），但它可能仅限于 iOS 7+。

```
UIViewController *fromViewController = [[[self navigationController] transitionCoordinator] viewControllerForKey:UITransitionContextFromViewControllerKey];

if ([[self.navigationController viewControllers] containsObject:fromViewController])
{
    //we're being pushed onto the nav controller stack.  Make sure to fetch data.
} else {
    //Something is being popped and we are being revealed
} 
```

就我而言，使用委托意味着让视图控制器的行为与拥有导航堆栈的委托更紧密地耦合，我想要一个更独立的解决方案。这行得通。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-12T04:09:10.397

解决此问题的一种方法是为 VC2 声明一个委托协议，如下所示：

在 VC1.h

```
@interface VC1 : UIViewController <VC2Delegate> {
...
} 
```

在 VC1.m

```
-(void)showVC2 {
    VC2 *vc2 = [[VC2 alloc] init];
    vc2.delegate = self;
    [self.navigationController pushViewController:vc2 animated:YES];
}

-(void)VC2DidPop {
    // Do whatever in response to VC2 being popped off the nav controller
} 
```

在 VC2.h

```
@protocol VC2Delegate <NSObject>
-(void)VC2DidPop;
@end

@interface VC2 : UIViewController {

    id<VC2Delegate> delegate;
}

@property (nonatomic, assign) id delegate;

...

@end 
```

VC2.m

```
-(void)viewDidUnload {
    [super viewDidUnload];
    [self.delegate VC2DidPop];
} 
```

[这里](http://mobiledevelopertips.com/objective-c/the-basics-of-protocols-and-delegates.html)有一篇关于协议和委托基础的好文章。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-09-06T06:59:17.727

您还可以在正在弹出的视图控制器中检测到

```
- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];

    if ([self isMovingFromParentViewController]) {
        ....
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-25T11:56:23.213

这对我有用

```
UIViewController *fromViewController = [[[self navigationController] transitionCoordinator] viewControllerForKey:UITransitionContextFromViewControllerKey];
if (![[self.navigationController viewControllers] containsObject:fromViewController] && !self.presentedViewController)
{
  //Something is being popped and we are being revealed 
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-12T04:31:38.753

您可以专门为您的 VC2 添加一个 NSNotification 观察者。

```
// pasing the "VC2" here will tell the notification to only listen for notification from
// VC2 rather than every single other objects
[[NSNotitificationCenter defaultCenter] addObserver:self selector:@selector(doSomething:) object:VC2]; 
```

现在在你的 VC2 的视图中会消失，你可以发布一个通知：

```
-(void)viewWillDisappear
{
    [[NSNotificationCenter defaultCenter] postNotificationNamed:@"notif_dismissingVC2" object:nil];
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-12T03:52:54.157

你具体想做什么？

如果您试图检测 VC1 即将显示，[这个](https://stackoverflow.com/a/7949339/244343)答案应该对您有所帮助。使用[UINavigationControllerDelegate](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UINavigationControllerDelegate_Protocol/Reference/Reference.html)。

如果您试图检测 VC2 即将被隐藏，我会使用[`viewWillDisappear:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW18)VC2 的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-11T08:59:00.240

迅速 3

```
override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(animated)
        if self.isMovingToParentViewController {
            print("View is moving to ParentViewControll")
        }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-08T11:02:39.573

我遇到了同样的情况，但有更具体的用例。在我的例子中，我们想确定当用户点击 VC2 的后退按钮时是否出现/显示了 VC1，其中 VC2 在 VC1 上被推到 navigationController 上。

所以我根据我的需要使用了[snarshad 的答案](https://stackoverflow.com/a/26308475/596360)来定制。这是**swift 3**`viewDidAppear`中 VC1中的代码。

 **```
// VC1: ParentViewController
// VC2: ChildViewController

    override func viewDidAppear(_ animated: Bool) {
        super.viewDidAppear(animated)

        if let transitionCoordinator = navigationController?.transitionCoordinator,
            let fromVC = transitionCoordinator.viewController(forKey: UITransitionContextViewControllerKey.from),
            let toVC = transitionCoordinator.viewController(forKey: UITransitionContextViewControllerKey.to),
            fromVC is ChildViewController,
            toVC is ParentViewController {

            print("Back button pressed on ChildViewController, and as a result ParentViewController appeared")
        }
    } 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-09-12T04:58:55.903

是的，在**VC1**中你可以检查**VC2**是否被弹出。UINavigationController 有一种方法**viewControllers**将返回推送的**控制器**数组，这些控制器在堆栈中（即已被推送）。

所以你通过比较类来迭代循环。如果**VC2**存在，将有匹配，否则没有。**

# asp.net - 具有非数字 StartRowIndexParameter 的 ObjectDataSource 分页

> ID：12380906
> 
> 赞同：1
> 
> 时间：2012-09-12T03:43:50.753
> 
> 标签：asp.net

不太清楚如何解释这一点，所以我在这里可能有点笨拙，但我仍然会感谢我能得到的任何帮助。

我必须使用的是 COM 数据源。我可以将查询传递给这个 COM 数据源（SQL 语法），然后它会返回一个 COM 对象，它实际上是一个未索引的列表。使用这个返回的 com 对象，我能够遍历并将单个记录解析为 .net 友好的类型对象。这一切都非常简单，并且在访问单个记录时效果很好。但是，有几个地方我想显示记录列表，例如在网格等上。当我开始得到越来越多的记录时，当解析真正开始减慢整个过程时，理想的做法是实现一些某种懒惰或按需加载

所以我一直在查看 ObjectDataSource 并使用 Paging。我有理由相信这将完全符合我想要的 execpt 没有任何类型的行计数器/记录枚举器的访问权限。我所拥有的是数据源的主键，它是我可以排序的字符串类型。

我要问的是这个。有没有办法在 StartRowIndexParameter 不是整数的对象数据源上实现 selectcount 方法？

# cassandra - 将新节点加入 Cassandra 集群需要多长时间？

> ID：12380907
> 
> 赞同：2
> 
> 时间：2012-09-12T03:44:00.673
> 
> 标签：cassandra

我有一台 Cassandra 1.0.9 服务器，它被设置为集群的种子。它有大约 34gb 的数据。我正在尝试将第二个 Cassandra 1.0.9 加入到环中，并将第一个设置为种子。

在 /var/lib/cassandra/log/cassandra.log 我看到：

```
INFO 20:06:52,809 JOINING: waiting for schema information to complete
INFO 20:07:22,815 JOINING: waiting for schema information to complete
INFO 20:07:52,817 JOINING: waiting for schema information to complete
.
.
.
INFO 20:10:22,839 JOINING: waiting for schema information to complete
INFO 20:10:52,841 JOINING: waiting for schema information to complete
INFO 20:11:22,847 JOINING: waiting for schema information to complete 
```

在 /var/log/cassandra/system 日志中，我看到：

```
INFO [main] 2012-09-11 20:19:52,913 StorageService.java (line 668) JOINING: waiting for schema information to complete
INFO [main] 2012-09-11 20:20:22,919 StorageService.java (line 668) JOINING: waiting for schema information to complete
INFO [main] 2012-09-11 20:20:52,921 StorageService.java (line 668) JOINING: waiting for schema information to complete
.
.
.
INFO [main] 2012-09-11 20:23:22,943 StorageService.java (line 668) JOINING: waiting for schema information to complete
INFO [main] 2012-09-11 20:23:52,945 StorageService.java (line 668) JOINING: waiting for schema information to complete
INFO [main] 2012-09-11 20:24:22,951 StorageService.java (line 668) JOINING: waiting for schema information to complete 
```

运行 netstats 给了我：

```
Mode: JOINING
Not sending any streams.
Not receiving any streams.
Pool Name                    Active   Pending      Completed
Commands                        n/a         0              5
Responses                       n/a         0          51966 
```

知道这需要多长时间吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:42:22.497

看来我已经通过以下步骤解决了这个问题：

1.  删除新服务器上的 /var/lib/cassandra/data 目录（和子目录）
2.  删除种子服务器上的 /var/lib/cassandra/data/system/Schema* 文件
3.  删除种子服务器上的 /var/lib/cassandra/data/system/Migration* 文件
4.  在 cassandra-cli 的种子服务器上重新创建模式
5.  在新服务器上启动 Cassandra

现在我在环中看到新服务器，即使它仍在加入（在之前的加入尝试中它没有出现在环中）。种子和新服务器都在同一个模式上，正如运行“描述集群”所指出的那样；在 cassandra-cli 中。

我希望这对将来的其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T23:38:34.157

接收振铃信息只需几秒钟。

识别问题的最佳方法是在两台主机上的 log4j-server.properties 中打开调试日志记录。

我的猜测是其中一台主机无法连接到存储端口（7000 或 7001）上的另一台主机。这可能有不同的原因：主机名配置错误、防火墙、ssl 配置错误等。尝试执行

```
nodetool -h <hostname> ring 
```

命令，然后尝试

```
telnet <hostname> 7000 
```

从每个主机到另一个。确保您使用的是来自 nodetool 输出的主机名。

如果两个连接都正常工作，请尝试打开调试日志记录。

# random - 抛硬币计划程序

> ID：12380909
> 
> 赞同：4
> 
> 时间：2012-09-12T03:44:15.700
> 
> 标签：random, scheme, probability

我尝试解决这个问题 Flip-coin 没有争论，并以相同的概率随机返回符号的正面或反面。这就是我得到的，但我不明白为什么它给了我“不可能”，这可以阻止吗？

```
(define flip-coin
    (lambda ( )
        (cond
            [ (= (random 2 ) 1 ) "heads" ]
            [ (= (random 2 ) 0 ) "tails" ]
            [else "impossible" ]
        )
    )
) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T03:52:02.157

您的声明中有两个*不同*的调用。这两者都是独立的，可以给你不同的结果。因此，第一个评估为，第二个评估为，这两种情况都可能失败并给你。`random``cond``(random 2)``0``1``"impossible"`

解决方案是将结果放入`(random 2)`带有 let 语句的局部变量中，确保只调用`random` *一次*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T04:08:35.137

该`flip-coin`过程仅返回两个可能值中的一个，它可以简化一点，还注意到`random`应该只调用一次 - 并且不需要将其值保存在变量中，因为结果会立即使用：

```
(define (flip-coin)
  (if (zero? (random 2))
      "tails"
      "heads")) 
```

# c++ - 'class' 类型重定义，已经包含 ifndef/define/endif

> ID：12380915
> 
> 赞同：0
> 
> 时间：2012-09-12T03:45:29.623
> 
> 标签：c++

c++ 新手，很困惑。我已经查找了几十个类似的问题，每个解决方案都是添加`#pragma once`or `#ifndef/#define/#endif`，但对我来说似乎并非如此。我有一个井字板源文件*tttBoard.cpp*，如下所示：

```
#include "stdafx.h"
#include "tttBoard.h"
#include <string>

class tttBoard {

    enum sVal {sEmp,sX,sO};
    sVal gBoard[3][3];
    bool isX;

    tttBoard::tttBoard() {
    }

    void Draw() {
    }

    void Move(int x, int y) {
    }

    char* getValue(int x, int y) {}

}; 
```

以及相应的头文件*tttBoard.h*：

```
#ifndef tttBoard_h
#define tttBoard_h

class tttBoard {
    public:
        tttBoard();
        void            Draw();
        void            Move(int x, int y);
        char*           getValue(int x, int y);
    private:
        enum sVal {
        sEmp,
        sX,
        sO
        };

        sVal            gBoard[3][3];
        bool            isX;
};

#endif 
```

但是在编译时遇到以下错误：

```
tttboard.cpp(5): error C2011: 'tttBoard' : 'class' type redefinition
tttboard.h(4) : see declaration of 'tttBoard' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:48:10.177

您在头文件和实现文件中都提供了类的定义。在 .cpp 中只包含标题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:49:04.203

要实现该类，您无需重新定义它。`.cpp`在您的文件中尝试以下操作。

```
#include "tttBoard.h"

tttBoard::tttBoard() {
}

void tttBoard::Draw() {
}

void tttBoard::Move(int x, int y) {
}

char* tttBoard::getValue(int x, int y) {} 
```

您也不需要重新声明您的`enum sVal`或任何`tttBoard`成员变量。它们应该可以从头文件中的原始声明中获得。:-)

此外，确保`getValue`实现实际返回一些东西。在完成这些功能的实现之前，您将无法编译。

[在此处](http://www.cplusplus.com/doc/tutorial/classes/)阅读有关 C++ 类的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T03:48:55.830

我认为您正在尝试定义类方法并最终在 .cpp 文件中**重新声明类本身。**
该函数的定义应在 .cpp 文件中如下所示：

```
tttBoard::tttBoard() {
}

void tttBoard::Draw() {
}

void tttBoard::Move(int x, int y) {
}

char* tttBoard::getValue(int x, int y) { return ...; } 
```

请注意，您不必在 .cpp 文件中再次提及非静态数据成员和枚举等。
声明和定义只能在函数的单独部分中。

# java - 用于格式化方法调用的 Eclipse 快捷方式

> ID：12380917
> 
> 赞同：0
> 
> 时间：2012-09-12T03:45:48.880
> 
> 标签：java, eclipse

Eclipse IDE（此处为 Indigo）中是否有任何快捷方式可以从此语句转换

```
myObject.callMethod(param1, "param2", param3); 
```

进入这个？：

```
myObject.callMethod(
   param1, 
   "param2", 
   param3
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:53:00.210

Ctrl-Shift-F 是默认组合，您可以通过 Window -> Preferences -> General -> Keys 进行更改。检查 Java -> Code Style 的设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:53:09.057

在 Window -> Preferences -> Java -> Code Style -> Code Templates 处更新您的代码模板

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T03:53:09.350

Ctrl+Shift+F

您可以在 Window->Preferences->Java->Code style->Formatter 下看到格式化的设置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T04:02:20.973

您可以使用 Ctrl+Shift+F 来格式化代码。

但是，如果您想要任何特定的格式类型，例如空格而不是制表符，那么您需要`code formatter`从 Project > Properties > Java Code Style > Formatter 合并。它允许您定义格式方案，以 XML 格式导出，也可以在任何其他机器上导入。

# php - PHP DOM textContent vs nodeValue？

> ID：12380919
> 
> 赞同：49
> 
> 时间：2012-09-12T03:46:11.980
> 
> 标签：php, html, dom

PHP DOMnode 对象包含一个[textContent](http://at.php.net/manual/en/class.domnode.php#domnode.props.textcontent)和[nodeValue](http://at.php.net/manual/en/class.domnode.php#domnode.props.nodevalue)属性，它们似乎都是节点的 innerHTML。

> nodeValue：这个节点的值，取决于它的类型
> 
> textContent：此属性返回此节点及其后代的文本内容。

这两个属性有什么区别？什么时候用一个代替另一个合适？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2014-07-14T05:52:20.773

我终于也想知道其中的区别，所以我挖掘了[源代码](http://lxr.php.net/xref/PHP_TRUNK/ext/dom/php_dom.c)并找到了答案；在大多数情况下，不会有明显的区别，但是您应该注意一些边缘情况。

对于以下类（节点类型），两者`->nodeValue`和都是相同的：`->textContent`

*   [`DOMAttr`](http://php.net/manual/en/class.domattr.php)
*   [`DOMText`](http://php.net/manual/en/class.domtext.php)
*   [`DOMElement`](http://php.net/manual/en/class.domelement.php)
*   [`DOMComment`](http://php.net/manual/en/class.domcomment.php)
*   [`DOMCharacterData`](http://php.net/manual/en/class.domcharacterdata.php)
*   [`DOMProcessingInstruction`](http://php.net/manual/en/class.domprocessinginstruction.php)

该`->nodeValue`属性`NULL`为以下类（节点类型）产生：

*   [`DOMDocumentFragment`](http://php.net/manual/en/class.domdocumentfragment.php)
*   [`DOMDocument`](http://php.net/manual/en/class.domdocument.php)
*   [`DOMNotation`](http://php.net/manual/en/class.domnotation.php)
*   [`DOMEntity`](http://php.net/manual/en/class.domentity.php)
*   [`DOMEntityReference`](http://php.net/manual/en/class.domentityreference.php)

`->textContent`以下类不存在该属性：

*   `DOMNameSpaceNode`（未记录，但可以通过`//namespace:*`选择器找到）

`->nodeValue`以下类不存在该属性：

*   [`DOMDocumentType`](http://php.net/manual/en/class.domdocumenttype.php)

另见：[`dom_node_node_value_read()`](http://lxr.php.net/xref/PHP_TRUNK/ext/dom/node.c#288)和[`dom_node_text_content_read()`](http://lxr.php.net/xref/PHP_TRUNK/ext/dom/node.c#917)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-09-12T05:04:31.970

希望这是有道理的：

```
$doc = DOMDocument::loadXML('<body><!-- test --><node attr="test1">old content<h1>test</h1></node></body>');
var_dump($doc->textContent);
var_dump($doc->nodeValue);
var_dump($doc->firstChild->textContent);
var_dump($doc->firstChild->nodeValue); 
```

输出：

```
string(15) "old contenttest"
NULL
string(15) "old contenttest"
string(15) "old contenttest" 
```

因为： [nodeValue - 这个节点的值，取决于它的类型](http://at.php.net/manual/en/class.domnode.php#domnode.props.nodevalue)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-12-06T17:03:57.553

两者都`textContent`返回`nodeValue`未转义的文本；即`&lt;`变成`<`.

`textContent`将所有子项的所有内容连接在一起。这是一个重要的区别; 例如，在 Chrome 中，最大长度`nodeValue`为 65536 个字符（不是字节）；如果您已经将节点的内容设置为比您想要使用的更长的内容，则需要迭代子节点，`nodeValue`而`textContent`将为您执行连接。

正如所讨论的，还有几个不支持`nodeValue`但支持的 DOM 类`textContent`。

`nodeValue`由于明显的原因更快；但是，除非您确切知道节点结构到底是什么，否则不要使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-02T08:53:15.160

如果您想为`textContent`属性分配值，请注意它不适用于[PHP < 5.6.1](http://at1.php.net/manual/en/class.domnode.php#domnode.props.textcontent)。考虑`nodeValue`改为使用，以实现向后兼容性。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2014-02-17T01:37:16.437

他们是一样的。（mikespook 的 NULL 来自非 DOMNode）

# android - IllegalStateException：没有活动

> ID：12380920
> 
> 赞同：3
> 
> 时间：2012-09-12T03:46:16.700
> 
> 标签：android

我有一个非常奇怪的问题，我一生都无法弄清楚。我有一个即将完成的应用程序。我已经开始在不同版本的 Android 和模拟器中的不同屏幕尺寸/密度上对其进行测试。在我使用 Android 3.1 和 3.2 (Honeycomb) 之前，一切正常。`IllegalStateException: No Activity`每次应用程序启动时我都会得到一个。我首先认为这是我的应用程序，所以我查看了堆栈跟踪，并没有提到我的应用程序中的任何方法或类。因此，我在我的应用程序支持的所有 Android 版本上进行了尝试，它适用于除 Honeycomb 之外的所有版本。我用谷歌搜索了 Honeycomb 和`IllegalStateException: No Activity`并没有找到任何东西。于是我看了看屏幕尺寸，发现 Honeycomb 的唯一皮肤是 WXGA。我检查了我所有的drawables，我使用一个用于ldpi、mdpi、hdpi和xhdpi。但以防万一我把我的应用程序需要的所有drawables都扔到了默认的drawable文件夹中，但仍然遇到同样的问题。我正在为所有其他资源使用默认文件夹，所以我知道这不是原因。然后我尝试了一个较小的屏幕尺寸，令我惊讶的是它起作用了。所以我随后在 Android 4.1 上对其进行了测试，并使用 1280x800 和 160 的密度来模拟 WXGA。它工作得很好。所以它特定于 WXGA(1280x800 mdpi) 和 Honeycomb。我调试并单步执行了我的代码，它实际上成功地通过了`onCreate()`. 我认为它实际上经历了`onCreate()`两次。我没有压倒`onResume()`一切`Activity`. 我在谷歌的土地上花了更多的时间，但我找不到任何与我正在经历的事情有关的东西。以防万一它在这里有帮助是我的`onCreate()`。如果有人能对此有所了解，我将永远欠你的债。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main_activity);

    mResources = getResources();
    mDialog = new ProgressDialog(this);

    mUrl = mResources.getString(R.string.rate_url);
    mEmailSubject = mResources.getString(R.string.email_subject);
    mChoose = mResources.getString(R.string.email_choose);
    mSendTo = mResources.getString(R.string.email_send_to);
    mLoadingPlaces = mResources.getString(R.string.places_loading);
    mAmazonAppStore = mResources.getString(R.string.amazon_app);

    mButton1 = (Button) findViewById(R.id.tip_btn);
    mButton2 = (Button) findViewById(R.id.preference);
    mButton3 = (Button) findViewById(R.id.rate_btn);
    mButton4 = (Button) findViewById(R.id.feedback_btn);

    // Load the font and the set the font for each Button.
    Typeface tf = Typeface.createFromAsset(getAssets(),"fonts/ArchitectsDaughter.ttf");

    mButton1.setTypeface(tf);
    mButton2.setTypeface(tf);
    mButton3.setTypeface(tf);
    mButton4.setTypeface(tf);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T04:14:14.117

好吧，只是出于好奇，我回去再试一次。我打算安装它并多次打开它，看看它是否在任何时候都有效。令我惊讶的是，它每次都有效！！！！！！！我已经玩了几分钟卸载并重新安装它并运行它。这很奇怪，因为我知道我之前已经在 Honeycomb 上测试过它并且它在过去有效。所以我不知道这是否只是模拟器中的一个小故障，但现在看起来还可以。我只是希望我有一个具有这种配置的设备来测试它。因此，如果有人对可能导致此问题的原因有任何想法或建议，我愿意调查每一个以确保确定。

# python - 如何将异常推入堆栈？

> ID：12380922
> 
> 赞同：0
> 
> 时间：2012-09-12T03:46:22.470
> 
> 标签：python, exception, stack, decorator, stack-trace

> **可能重复：**
> [引发异常时如何修改 Python 回溯对象？](https://stackoverflow.com/questions/1603940/how-can-i-modify-a-python-traceback-object-when-raising-an-exception)

考虑这个玩具示例：

```
def twice(n):
    _validate_twice_args(n)
    return 2*n

def _validate_twice_args(n):
    if type(n) != int:
        raise TypeError('n must be an int')

twice(None)
--
Traceback (most recent call last):
  File "demo.py", line 9, in <module>
    twice(None)
  File "demo.py", line 2, in twice
    _validate_twice_args(n)
  File "demo.py", line 7, in _validate_twice_args
    raise TypeError('n must be an int')
TypeError: n must be an int 
```

即使错误的位置是 call `twice(None)`，回溯指的是负责错误的人甚至不知道的代码，（“`_validate`谁？我从来没有调用过它！我什至不知道它是什么！”） ，并且不必要地暴露了应该在“API 后面”的代码。 ***即使在没有“私有”辅助函数的情况下`_validate_twice_args`，响应错误参数而打印的堆栈跟踪也会不必要地暴露内部代码，并掩盖错误的位置。***

例如，如果内联 的代码`_validate_twice_args`，堆栈跟踪如下所示：

```
Traceback (most recent call last):
  File "demo.py", line 10, in <module>
    twice(None)
  File "demo.py", line 3, in twice
    raise TypeError('n must be an int')
TypeError: n must be an int 
```

要了解此类错误的堆栈跟踪*应该是什么样子*，这是由非常相似类型的错误产生的错误，调用`twice()`而不是`twice(None)`，但在控制权传递给之前由 Python 引发`twice`：

```
Traceback (most recent call last):
  File "demo.py", line 9, in <module>
    twice()
TypeError: twice() takes exactly 1 argument (0 given) 
```

在这种情况下，错误也在于`twice`使用无效参数列表调用。因此，堆栈跟踪直接指向错误的位置（而*不是*指向底层 [最有可能的 C] 代码中第一次检测到错误的行，谢天谢地）。这是应该的，IMO ¹。

如何修改`twice_args`和/或`_validate_twice_args`使堆栈跟踪的最后一行引用错误调用的源代码行`twice`？

* * *

¹***我意识到在这种情况下关于堆栈跟踪应该说什么的意见与我的不同，但这些哲学考虑不是本线程的主题。***

**编辑**：在原始帖子中***强调了评论，但显然被前两个响应者忽略了。***

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:57:07.503

好吧，您可以更改`twice`为：

```
def twice(n):
    try:
        _validate_twice_args(n)
    except Exception, e:
        raise e
    return 2*n 
```

但是，当然，如果您要在 中放置一个 try/except 块`twice`，您不妨在那里进行实际检查。当然，如果您想在此处提出异常，尽管您有脚注，但您真正应该做的是。异常发生在它发生的地方。您永远不能调用函数并期望在该特定函数的实际主体中会发生任何异常。函数总是调用其他函数。拥有执行此类操作的验证器函数很好，但如果是这样，您只需要接受异常将在那里引发，而不是在其他地方引发。

作为对您的编辑的回应：当您在发生异常的地方引发异常时，您似乎正在“公开私有代码”，但以另一种方式进行操作会隐藏错误，这是更糟糕的方式。回溯很容易让您查看*堆栈*并查找调用函数的*位置*。但是，按照您的描述进行操作会将回溯切断得太高，从而无法查看错误实际发生的位置。如果代码可以在其他地方引发异常，错误代码很容易隐藏自己。

 *更一般地说，你所说的“错误的轨迹”是一条红鲱鱼。*应在检测到**异常情况时引发异常*（可能是也可能不是“错误”）。“错误在哪里”是一个更复杂的问题，您不应该试图通过创建在其他地方引发自身的“意大利面条异常”来掩盖它。作为人类，您可以看到这是这个特定调用链中的“出错的地方”，但这并不意味着您应该尝试让您的程序变得聪明并让它解决这个问题。它可能在某些时候出错并引起更大的混乱。*`twice(None)`*

 *所以回答你强调的内容：不，你不能那样做。在引发异常的地方引发异常。您不能在一个地方引发异常并让它显示出来，就好像它是在其他地方引发的一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T04:40:25.623

长答案简短：不编写 C 扩展或使用 ctypes 魔法，您*无法*操纵正常的 Python 回溯来假装错误来自`raise`代码中的语句以外的任何地方。

从 Python 引发的异常将`raise`在其回溯的最顶部有一条语句，因为根据定义，这是异常起源的地方——您无法更改它（没有任何上述技巧）。在您的情况下，您希望异常看起来像是来自函数调用（作为最顶层的框架），我说的是纯 Python 不可能。

如果您仍想查看 ctypes 或 CPython 方法来执行此操作，我可以向您展示。但是你不会通过坚持纯 Python 代码得到你想要的（而且你显然想要你想要的）。

编辑：好的，这不是 100% 准确的。当然，您总是可以调用一些引发异常的扩展方法——异常“来自”对扩展方法的调用。因此，如果您编写`twice`为扩展方法，则可以实现您想要的确切语义（这就是我所说的“编写 C 扩展”的意思）。

由于 的存在`generator.throw()`，您还可以导致异常出现`def`在生成器函数或`yield`语句中，所有这些都来自 Python 代码。当然，两者都不会帮助你实现你想要的语义，但为了完整起见，我想提到这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T05:06:24.010

请参阅[引发异常时如何修改 Python 回溯对象？](https://stackoverflow.com/questions/1603940/how-can-i-modify-a-python-traceback-object-when-raising-an-exception)

在那里你会找到更多不这样​​做的建议，还有一个指向 jinja2 中一些丑陋代码的链接，如果你真的必须这样做，它会告诉你如何去做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T03:56:45.773

您可以将代码修改为以下内容：

```
def twice(n):
    error = _validate_twice_args(n)
    if error:
        raise error
    return 2*n

def _validate_twice_args(n):
    if type(n) != int:
        return TypeError('n must be an int')
    return None

twice(None) 
```

这样，错误就从`twice`. `twice`不幸的是，与简单的方法调用相比，它在方法中需要更多的代码。

```
Traceback (most recent call last):
  File "<module1>", line 28, in <module>
  File "<module1>", line 25, in main
  File "<module1>", line 16, in twice
TypeError: n must be an int 
```**

# linux - Linux 模块每秒检查一次电池状态，更好的检查方式，当前方式 rmmod 不起作用

> ID：12380924
> 
> 赞同：0
> 
> 时间：2012-09-12T03:46:39.483
> 
> 标签：linux, linux-kernel, kernel-module

我正在制作一个每秒调用 acpi 的 linux 模块（目前只有 20 秒）。我希望它每秒继续进行 acpi 调用，直到它被删除。正如我所拥有的那样，我将模块放入一个循环中，如果我确实设置了这个循环永远重复，我不能使用 rmmod 来删除模块。有没有办法为循环设置一个全局变量？

代码：acpi_call.ko

```
/* Copyright (c) 2010: Michal Kottman */
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/proc_fs.h>
#include <linux/slab.h>
#include <asm/uaccess.h>
#include <acpi/acpi.h>
#include <linux/jiffies.h>
#include <linux/sched.h>

MODULE_LICENSE("GPL");

#define BUFFER_SIZE 256

extern struct proc_dir_entry *acpi_root_dir;
char result_buffer[BUFFER_SIZE];
void do_acpi_call(void);

size_t get_avail_bytes(void) 
{
    return BUFFER_SIZE - strlen(result_buffer);
}

char *get_buffer_end(void) 
{
    return result_buffer + strlen(result_buffer);
}

int __init init_battcheck(void) 
{
    int i;
    if( true )
    {
        for (i=0 ; i < 1 ; i++) 
        {
            do_acpi_call();
            if(result_buffer[3] == '1')
                printk(KERN_INFO "Battery is discharging. %c\n", result_buffer[3]);
            else if(result_buffer[3] == '2')
                printk(KERN_INFO "Battery is charging. %c\n", result_buffer[3]);
            else
                printk(KERN_INFO "Battery is CRITICAL. %c\n", result_buffer[3]);
        }
    }
    return 1;
}

/** Appends the contents of an acpi_object to the result buffer
@param result: An acpi object holding result data
@returns: 0 if the result could fully be saved, a higher value otherwise **/
int acpi_result_to_string(union acpi_object *result) 
{
    if (result->type == ACPI_TYPE_INTEGER) 
    {
        snprintf(get_buffer_end(), get_avail_bytes(),"0x%x", (int)result->integer.value);
    } 
    else if (result->type == ACPI_TYPE_STRING) 
    {
        snprintf(get_buffer_end(), get_avail_bytes(), "\"%*s\"", result->string.length, result->string.pointer);
    } 
    else if (result->type == ACPI_TYPE_BUFFER) 
    {
        int i;
        // do not store more than data if it does not fit. The first element is
        // just 4 chars, but there is also two bytes from the curly brackets
        int show_values = min(result->buffer.length, get_avail_bytes() / 6);

        sprintf(get_buffer_end(), "{");
        for (i = 0; i < show_values; i++)
            sprintf(get_buffer_end(), i == 0 ? "0x%02x" : ", 0x%02x", result->buffer.pointer[i]);

        if (result->buffer.length > show_values)
        {
            // if data was truncated, show a trailing comma if there is space
            snprintf(get_buffer_end(), get_avail_bytes(), ",");
            return 1;
        } 
        else 
        {
            // in case show_values == 0, but the buffer is too small to hold
            // more values (i.e. the buffer cannot have anything more than "{")
            snprintf(get_buffer_end(), get_avail_bytes(), "}");
        }
    } 
    else if (result->type == ACPI_TYPE_PACKAGE) 
    {
        int i;
        sprintf(get_buffer_end(), "[");
        for (i=0; i < result->package.count; i++) 
        {
            if (i > 0)
                snprintf(get_buffer_end(), get_avail_bytes(), ", ");

            // abort if there is no more space available
            if (!get_avail_bytes() || acpi_result_to_string(&result->package.elements[i]))
                return 1;
        }
        snprintf(get_buffer_end(), get_avail_bytes(), "]");
    } 
    else 
    {
        snprintf(get_buffer_end(), get_avail_bytes(), "Object type 0x%x\n", result->type);
    }

    // return 0 if there are still bytes available, 1 otherwise
    return !get_avail_bytes();
}

void do_acpi_call(void)
{
    acpi_status status;
    acpi_handle handle;
    struct acpi_object_list arg;
    struct acpi_buffer buffer = { ACPI_ALLOCATE_BUFFER, NULL };

    printk(KERN_INFO "acpi_call: Calling \\_SB.PCI0.LPCB.EC0.BAT0._BST\n");

    // get the handle of the method, must be a fully qualified path
    status = acpi_get_handle(NULL, (acpi_string) "\\_SB.PCI0.LPCB.EC0.BAT0._BST", &handle);

    if (ACPI_FAILURE(status)) 
    {
        snprintf(result_buffer, BUFFER_SIZE, "Error: %s", acpi_format_exception(status));
        printk(KERN_ERR "acpi_call: Cannot get handle: %s\n", result_buffer);
        return;
    }

    // prepare parameters
    arg.count = 0;
    arg.pointer = NULL;

    // call the method
    status = acpi_evaluate_object(handle, NULL, &arg, &buffer);
    if (ACPI_FAILURE(status)) 
    {
        snprintf(result_buffer, BUFFER_SIZE,"Error: %s", acpi_format_exception(status));
        printk(KERN_ERR "acpi_call: Method call failed: %s\n", result_buffer);
        return;
    }

    // reset the result buffer
    *result_buffer = '\0';
    acpi_result_to_string(buffer.pointer);
    kfree(buffer.pointer);

    printk(KERN_INFO "acpi_call: Call successful: %s\n", result_buffer);
}

/** module initialization function */
int __init init_acpi_call(void) 
{
    struct proc_dir_entry *acpi_entry = create_proc_entry("call", 0660, acpi_root_dir);

    strcpy(result_buffer, "not called");

    if (acpi_entry == NULL) 
    {
        printk(KERN_ERR "acpi_call: Couldn't create proc entry\n");
        return -ENOMEM;
    }

    printk(KERN_INFO "acpi_call: Module loaded successfully\n");

    init_battcheck();

    return 0;
}

void __exit unload_acpi_call(void) 
{
    remove_proc_entry("call", acpi_root_dir);
    printk(KERN_INFO "acpi_call: Module unloaded successfully\n");
}

module_init(init_acpi_call);
module_exit(unload_acpi_call); 
```

编辑：我刚刚意识到每次调用 do_acpi_call 时我都没有等待一秒钟，我让它这样做只是为了检查错误。这只是我正在制作的一个例子。我在问是否有办法做到这一点，以便我可以删除我描述的循环中的模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:44:36.403

设置并使用工作队列。这将安排您希望在未来一段时间内运行的工作。在 Linux 设备驱动程序中阅读它：http: [//lwn.net/images/pdf/LDD3/ch07.pdf](http://lwn.net/images/pdf/LDD3/ch07.pdf)

当异步任务开始在您的内核模块中运行时，您需要非常小心地避免竞争条件并仔细清理。也就是说，在删除模块时，取消任何未完成的工作，等待任何正在进行的作业完成（确保该作业不会自行重新安排），然后销毁工作队列，然后才关闭工作功能可能需要的任何资源使用。

# android - Android，如何设置限定符以支持 4.7" 设备？

> ID：12380925
> 
> 赞同：0
> 
> 时间：2012-09-12T03:46:44.013
> 
> 标签：android, user-interface, qualifiers

我根据不同的限定符（如 drawable-hdpi 和 drawable-mdpi）设计了不同的 UI。正如您在下图中看到的，当我在 SG2 等 4.3" 尺寸的手机上进行测试时，UI 与屏幕匹配。但是，当我在 SG3 和 Atrix 等 4.7" 设备上进行测试时，会有一些差距，这并不好。

所以，我想根据新的维度重新设计这些设备的屏幕。我阅读了[支持多个屏幕](http://developer.android.com/guide/practices/screens_support.html)但是，我没有找到解决方案。我尝试在 drawable-xdpi 中添加新的 UI，但它影响了我在 4.3" 设备上的当前设计。我尝试使用 swdp、wdp 和 hdp 但结果并不令人满意。

你有什么建议？任何建议将不胜感激。谢谢 ![在此处输入图像描述](../Images/4e377f2436a8e9dd321b4e2749e8162b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:08:32.423

因此，您将这些图像放入 {*}dpi 文件夹中。对吗？正如您可能已经知道的那样，您将正常分辨率（最适合您的应用程序的分辨率 - 设备大小和分辨率）图像放入“mdpi”文件夹。如果您的应用程序在具有非常高分辨率的超大设备中启动（ xdpi) ，它会将图像放大到 2.0 的比例，如果设备大且高分辨率 (hdpi)，它会将图像放大到 1.5 的比例。如果设备具有低 dpi 和小尺寸，android 会将图像尺寸压缩到 0.75 比例。但是，如果这对您来说还不够（对我来说还不够），您可以简单地找出目标设备的分辨率并根据自己调整图像的大小.. 您所要做的就是找出（必须计算它）为自己）**常数**调整图像的分辨率。例如; 0.6（根据发现的屏幕分辨率，您将图像的宽度和高度乘以该**常数**。这是我的示例：

```
Display currentScreen = this.getWindowManager().getDefaultDisplay();
Point dimension = new Point();
    currentScreen.getSize(dimension);
    //int widthPixel = dimension.x;
    int heightPixel = dimension.y;
    System.out.println("Screen Resolution (Height) : "+heightPixel);

    int imgHeight;
    imgHeight = (int) Math.floor(heightPixel * 0.6);

    int widthSeparator = (int) dimension.y/13;
    System.out.println("Width Separator : "+widthSeparator);

    //imgHeight = 240;

    System.out.println("Image Resolution (Height) : "+imgHeight);

    FrameLayout.LayoutParams layoutParamCR = new FrameLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT,RelativeLayout.LayoutParams.WRAP_CONTENT);
    layoutParamCR.setMargins(widthSeparator, 0, 0, 0);

    //FrameLayout.LayoutParams layoutParamL = new FrameLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT,RelativeLayout.LayoutParams.WRAP_CONTENT);
    //layoutParamL.setMargins(-30, 0, 0, 0);

    ImageView leftCover = (ImageView) findViewById(R.id.magCoverLeft);
    leftCover.setAdjustViewBounds(true);
    leftCover.setMaxHeight(imgHeight);
    leftCover.setLayoutParams(layoutParamCR);
    leftCover.setImageBitmap(null);

    ImageView cover = (ImageView) findViewById(R.id.magCover);
    cover.setAdjustViewBounds(true);
    cover.setMaxHeight(imgHeight);
    cover.setLayoutParams(layoutParamCR);
    cover.setImageBitmap(coverImages[0]);

    ImageView rightCover = (ImageView) findViewById(R.id.magCoverRight);
    rightCover.setAdjustViewBounds(true);
    rightCover.setMaxHeight(imgHeight);
    rightCover.setLayoutParams(layoutParamCR);
    rightCover.setImageBitmap(coverImages[1]); 
```

# javascript - 绑定到 Collection 的主干视图未拾取添加事件

> ID：12380926
> 
> 赞同：1
> 
> 时间：2012-09-12T03:47:03.103
> 
> 标签：javascript, backbone.js, coffeescript

我有一个具有这些功能的视图 -

```
 initialize:=>
    @populateSearchHistory()
    @el

  populateSearchHistory:=>
    console.log(pastSearches)
    @$el.find("#searchHistoryContainer").append(Handlebars.templates["$$ uri $$-searchHistory"]())
    @collection.add(stuff)

  @collection.on "add", (toAdd)->
    console.log(toAdd) 
```

但是没有记录“添加”。到底是怎么回事？

更新-

我尝试在初始化函数中这样做 -

```
initialize:=>
  @collection.on "add", @populateSearchHistory 
```

populateSearchHistory 现在在哪里

```
populateSearchHistory:(toAdd)=>
  console.log(toAdd) 
```

但是， toAdd 是一个空模型，我需要它具有我添加的值。

更新编译的javascript

```
var _this = this;

({
  initialize: function() {
    _this.populateSearchHistory();
    return _this.el;
  },
  populateSearchHistory: function() {
    console.log(pastSearches);
    _this.$el.find("#searchHistoryContainer").append(Handlebars.templates["$$ uri $$-searchHistory"]());
    return _this.collection.add(stuff);
  }
});

this.collection.on("add", function(toAdd) {
  return console.log(toAdd);
}); 
```

更新

好的 - 所以 init 函数中的绑定起作用了，传入的未初始化查询是因为我有一个 for 循环遍历集合并在集合中添加每个模型 - 每个模型都是未定义的 - 为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T06:01:53.467

这里jsfiddle（更新）：http: [//jsfiddle.net/85YxD/](http://jsfiddle.net/85YxD/)

```
SearchModel = Backbone.Model.extend();

SearchCollection = Backbone.Collection.extend({
    model : SearchModel
});

myCollection = new SearchCollection();

SearchView = Backbone.View.extend({

   initialize: function() {
       var _this = this;
        _this.populateSearchHistory();
   },

    populateSearchHistory: function() {
        var _this = this;
       // your code here
       var stuff = new SearchModel({
          key : 'value'          
       })

       //model can be added both way 
       console.log('model1 added.......');
       _this.options.list.add(stuff);

       //Or,  
       console.log('model2 added.......');
      _this.options.list.add({
          key1 : 'value1',
          key2 : 'value2'
       });

       //TODO : add loop for adding models here

       return _this;
   }

});

myCollection.on("add", function(toAdd) {
    console.log('added model', toAdd);
    console.log('updated collection', myCollection.toJSON());  
});

new SearchView({
   list : myCollection
}); 
```

​</p>

# java - 使用 GSON 反序列化包含 JSON 的对象

> ID：12380927
> 
> 赞同：4
> 
> 时间：2012-09-12T03:47:13.157
> 
> 标签：java, json, gson

我正在使用 gson 从 JSON 表示中反序列化 POJO 对象。

我希望我的一个 POJO 中的一个字段包含任意 JSON 数据。例如：

```
class B {
    public String stringField;
    public JsonObject jsonField;
} 
```

我希望能够调用`Gson.fromJson(json, B.class)`以下 JSON：

```
{
    "stringField": "booger",
    "jsonField" :
    {
        "arbitraryField1": "foo"
    }
} 
```

并让结果`B.jsonField`包含一个具有`arbitraryField`value的 JsonObject `foo`。

但是，当我尝试这样做时，`jsonField`总是一个空对象 ( `{}`)。事实上，更一般地说，以下似乎总是返回一个空对象：

```
new Gson().fromJson("{ foo: 1 }", JsonObject.class) 
```

我希望上面返回一个对象，其中包含一个名为`foo`1 的字段。

将 json 反序列化为 POJOS 时，如何让 gson 保留任意 json 数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T06:09:03.037

你可以使用 JsonParser：

```
JsonParser parser = new JsonParser();
JsonObject o = parser.parse("{ \"foo\": \"1\" }").getAsJsonObject(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T04:08:38.950

我能够通过引入一个包含 JsonObject 的包装器对象来解决该问题，然后为该对象编写一个自定义反序列化器，它只返回原始 json。但是，似乎必须有更好的方法。

对于后代，反序列化器和普通包装器对象如下所示：

```
class MyJsonObjectWrapperDeserializer implements JsonDeserializer<MyJsonObjectWrapper> {
    @Override
    public MyJsonObjectWrapper deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context) throws JsonParseException {
        return new MyJsonObjectWrapper(json.getAsJsonObject());
    }
}

class MyJsonObjectWrapper {
    public JsonObject json;

    public MyJsonObjectWrapper(JsonObject json) {
        this.json = json;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T04:30:25.887

考虑这个反序列化器，这是我对[doc](https://sites.google.com/site/gson/gson-user-guide#TOC-Built-in-Serializers-and-Deserializers)的解释。

```
import com.google.gson.*;
import java.lang.reflect.Type;

class B {
    public String stringField;
    public JsonObject jsonField;
}

class BDeserializer implements JsonDeserializer<B> {
    public B deserialize(JsonElement json, Type typeOfT, 
                         JsonDeserializationContext context)
                 throws JsonParseException {
        JsonObject jsonObject = json.getAsJsonObject();

        B b = new B();
        b.stringField = jsonObject.get("stringField").getAsString();
        b.jsonField = jsonObject.getAsJsonObject("jsonField"); 

        return b;
    }
}

public class Test {
    static public void main(String[] args) {
        GsonBuilder gson = new GsonBuilder();
        gson.registerTypeAdapter(B.class, new BDeserializer());

        String json = " { \"stringField\" : \"booger\", \"jsonField\" : { \"arbitraryField1\" : \"foo\" } } ";

        B b = gson.create().fromJson(json, B.class);
        System.out.println(b.stringField);
        System.out.println(b.jsonField.toString());
    }
} 
```

# qt - 将 QPixmap 转换为 SDL_Surface 并呈现在屏幕上

> ID：12380932
> 
> 赞同：1
> 
> 时间：2012-09-12T03:48:18.947
> 
> 标签：qt, sdl

我正在尝试将 Qt 库与 SDL 应用程序集成。我想将 QPixmap 转换为 SDL_Surface，然后显示该表面。我怎样才能做到这一点？我找不到任何好的例子。

到目前为止，我已经管理了以下代码：

```
Uint32 rmask = 0x000000ff;
Uint32 gmask = 0x0000ff00;
Uint32 bmask = 0x00ff0000;
Uint32 amask = 0xff000000;

SDL_FillRect(screen, NULL, SDL_MapRGBA(screen->format, 255, 255, 255, 255));

const QImage *qsurf = ...;

SDL_Surface *surf = SDL_CreateRGBSurfaceFrom((void*)qsurf->constBits(), qsurf->width(), qsurf->height(), 32, qsurf->width() * 4, rmask, gmask, bmask, amask);
SDL_BlitSurface(surf, NULL, screen, NULL);
SDL_FreeSurface(surf);
SDL_Flip(screen); 
```

这行得通，但唯一的问题是，每次绘制基于 QImage 的表面时，底层区域都不会被清除，并且透明部分会在几帧的过程中“淡化”为实体。

我确实有`SDL_FillRect`我想象的清除屏幕的方法，但它似乎没有这样做。`screen`是主要的 SDL 表面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T06:27:30.890

我最初的过度绘制问题是因为我的源图像实际上没有被正确清除。哎呀。一旦我解决了这个问题，我只是把我的面具弄错了；没有想到 SDL 是如何使用这些的。最终的工作代码如下：

这是将 QImage 转换为 SDL_Surface 的函数：

```
/*!
 * Converts a QImage to an SDL_Surface.
 * The source image is converted to ARGB32 format if it is not already.
 * The caller is responsible for deallocating the returned pointer.
 */
SDL_Surface* QImage_toSDLSurface(const QImage &sourceImage)
{
    // Ensure that the source image is in the correct pixel format
    QImage image = sourceImage;
    if (image.format() != QImage::Format_ARGB32)
        image = image.convertToFormat(QImage::Format_ARGB32);

    // QImage stores each pixel in ARGB format
    // Mask appropriately for the endianness
#if SDL_BYTEORDER == SDL_BIG_ENDIAN
    Uint32 amask = 0x000000ff;
    Uint32 rmask = 0x0000ff00;
    Uint32 gmask = 0x00ff0000;
    Uint32 bmask = 0xff000000;
#else
    Uint32 amask = 0xff000000;
    Uint32 rmask = 0x00ff0000;
    Uint32 gmask = 0x0000ff00;
    Uint32 bmask = 0x000000ff;
#endif

    return SDL_CreateRGBSurfaceFrom((void*)image.constBits(),
        image.width(), image.height(), image.depth(), image.bytesPerLine(),
        rmask, gmask, bmask, amask);
} 
```

而我的绘图功能的核心：

```
// screen == SDL_GetVideoSurface()
// finalComposite == my QImage that SDL will convert and display
SDL_FillRect(screen, NULL, SDL_MapRGBA(screen->format, 255, 255, 255, 255));
SDL_Surface *surf = QImage_toSDLSurface(finalComposite);
SDL_BlitSurface(surf, NULL, screen, NULL);
SDL_FreeSurface(surf);
SDL_Flip(screen); 
```

# php - PHP登录代码，清理

> ID：12380935
> 
> 赞同：-4
> 
> 时间：2012-09-12T03:48:30.380
> 
> 标签：php, login

我想清理我的登录脚本并帮助我的数据库安全。我是一个基本的编码员，从教程中学到了我所拥有的东西，所以我想我的脚本需要一些保护，有什么建议吗？

```
<?php

session_start();

$email = strtolower( trim($_POST['email']));
$pass = $_POST['password'];

if ($email&&$pass){

require_once("dbconnect.php");

$query = mysql_query("SELECT * FROM users WHERE username='$email'");
$numrows = mysql_num_rows($query);
if ($numrows!=0){   
//code to login
    while ($row = mysql_fetch_assoc($query)){
        $dbusername = $row['username'];        //USERNAME IS NAME OF COLUMN IN DB
        $dbpassword = $row['password'];
        $activated = $row['activated'];

        if ($activated=='0')
            die("Your account has not been activated.(Remember to check in your email spam folder)");
    }

    //check to see if they match
    if ($email==$dbusername&&md5($pass)==$dbpassword){
        //echo "You have succesfully logged-in! <a href='start.php'>Click</a> here to enter." ;
        $_SESSION['username']=$email;
        header( 'Location: http://website' ) ;
    }
    else{
        echo "The password you entered is incorrect";   
    }
}
else
    die("Sorry, the email you have entered is incorrect");

}

else
    die("Please enter your email and password");

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T04:09:47.887

看，我给你重写了！这使用 PDO 和准备好的语句，以最优雅的方式（即 not `mysql_real_escape_string`）修补 SQL 注入漏洞，并且还使用 bcrypt 对密码进行哈希处理，这比没有盐的 MD5 好得多。

```
<?php
session_start();

if(isset($_POST['email']) && isset($_POST['password'])) {
    require_once 'dbconnect.php';

    $email = strtolower(trim($_POST['email']));
    $password = $_POST['password'];

    $query = $link->prepare('SELECT * FROM users WHERE username = :email LIMIT 1');
    $query->execute(array(':email' => $email));
    $row = $query->fetch();

    if($row) {
        if(!$row->activated) {
            die('Your account has not been activated. (Remember to check in your e-mail spam folder!)');
        }

        if($row->username === $email && crypt($password, $row->password) === $row->password) {
            $_SESSION['username'] = $email;
            header('Location: http://website'); # If this isn't a relative URL, try using one.
            exit();
        }
    }

    die('Invalid e-mail and/or password. Please try again.');
}
?> 
```

但是，您需要对数据库、注册代码和数据库连接代码进行一些更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T04:07:33.773

首先，我将通过更改来修复 SQL 注入漏洞：

```
$email = strtolower( trim($_POST['email']));
$pass = $_POST['password'];

if ($email&&$pass){

    require_once("dbconnect.php"); 
```

至

```
require_once("dbconnect.php");

$email = mysql_real_escape_string(strtolower( trim($_POST['email'])));
$pass = $_POST['password'];

if ($email&&$pass){ 
```

您可以做的下一件事是通过更改来防止“会话劫持”

```
if ($email==$dbusername&&md5($pass)==$dbpassword){
    //echo "You have succesfully logged-in! <a href='start.php'>Click</a> here to enter." ;
    $_SESSION['username']=$email; 
```

至

```
if ($email==$dbusername&&md5($pass)==$dbpassword){
    //echo "You have succesfully logged-in! <a href='start.php'>Click</a> here to enter." ;
    session_regenerate_id();
    $_SESSION['username']=$email; 
```

我不确定这个登录脚本在哪里使用（内部或外部），但如果它在外部使用，您可以将用户 IP 地址添加为会话变量，并在每次用户返回时检查。我也会使用 crypt() 函数而不是 md5() 因为 md5() 不建议用于散列密码（这可能取决于您拥有多少用户以及是否要重置每个人的密码）。我使用[PHPass 类](http://www.openwall.com/phpass/) 除了安全性之外，您还可以使用 MySQLi（又名 MySQL 改进版）而不是原始 MySQL 代码，因为它已被弃用。但是更改为 MySQLi 取决于您的 PHP 是否支持 MySQLi。

# php - MongoDB / MongoHQ 字段=>值大小限制？

> ID：12380940
> 
> 赞同：0
> 
> 时间：2012-09-12T03:48:58.397
> 
> 标签：php, mongodb, mongohq

我正在查询我在 MongoHQ 作为试用帐户托管的 MongoDB，以获取一个包含超过 1000 个值的字段的文档。当我尝试检索此文档时，我的查询根本不返回任何内容。如果我尝试将字段缩短为 100 个值，它可以正常工作。我在这个集合中有一个文档，其中包含一个具有 586 个值的类似字段，并且它也会加载。

我想知道这里是否有某种我不知道的限制？文档不可能超过 4MB。

**更新：**意识到有一些值被评估为空，这导致查询中断。解决了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:59:03.300

**MongoDB**文档大小限制现在为**16MB**。[参考](http://www.mongodb.org/display/DOCS/Documents)

更新到新版本！

巨大的嵌套文档可能会超出文档大小限制。

使用 Db-ref 而不是使用巨大的嵌套文档可能不会遇到任何大小限制问题。

# algorithm - 关于对数的大 O 表示法

> ID：12380943
> 
> 赞同：4
> 
> 时间：2012-09-12T03:49:18.303
> 
> 标签：algorithm, runtime, big-o

我被问到一个面试问题，希望我辨别几个对数函数的 Big-O 表示法。功能如下：

f(x) = log ⁵ (x)

f(x) = log(x ⁵ )

f(x) = log(6*log x)

f(x) = log(log x)

有人告诉我，第一个和第二个的 Big-O 不等价，第三个和第四个不等价，因为我错误地猜测相反。谁能解释为什么它们不相等以及它们的 Big-O 是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T03:59:25.970

1.  log ⁵ x 和写 log log log log log x 一样，是 x 的一个增长*很*慢的函数。
2.  这相当于 5 log x（将 log 内的幂重写为外部的乘法），相当于 log x。
3.  这相当于log 6 + log log x，相当于log log x。
4.  这只是 log log x。

所以你有 O(log log log log log x)、O(log x)、O(log log x) 和 O(log log x)，三个不同的 Big-O 类。

如果你的面试官说 3 和 4 不同，要么是他弄错了，要么你记错了问题（经常发生）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T04:01:07.807

这是一个数学问题：

1.  f(x) = log ⁵ (x)
2.  f(x) = log(x ⁵ ) = 5 * log x
3.  f(x) = log(6*log x) = log 6 + log(log x)
4.  f(x) = log(log x)

所以大O是

1.  O(log ⁵ (x))
2.  O(log x)
3.  O(log (log x))
4.  O(log (log x))

所以 (1) 和 (2) 不等价，但 (3) 和 (4) 是等价的（尽管它们与 (1) 和 (2) 都不同）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T04:02:18.653

```
f(x) = log^5(n)
f(x) = log(n^5) -> 5 log(n)
O(5 log(n)) < O(log(n)^5)

f(x) = log(6*log n) -> log(6)+log(log(n))
f(x) = log(log n) 
log(log n) < log(6) + log(log(n)) 
```

, 虽然 log(6) 是一个常数，所以它们有相同的 O

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T03:59:32.767

我假设你的意思是`f(n)`，不是`f(x)`。对于 1 和 2，`log^5(n)`等价于`O(log log log log log(n))`, 而`log(n^5) = 5 log(n) = O(log n)`.

对于3和4，我不同意。`log(6*log n) = log(6) + log(log n) = O(log log n)`，与 4 - 相同`O(log log n)`。

# java - 在构造函数中生成简单赋值的 Eclipse 快捷方式？

> ID：12380947
> 
> 赞同：13
> 
> 时间：2012-09-12T03:49:56.573
> 
> 标签：java, eclipse

反正有没有从构造函数的参数生成简单的赋值？

从 ：

```
public class MyClass {

  public MyClass(String id, String name, String desc) {

  }

} 
```

并通过一些神奇的捷径，它将变成：

```
public class MyClass {

  public MyClass(String id, String name, String desc) {
    this.id = id;
    this.name = name;
    this.desc = desc;
  }

} 
```

如果我们有生成它的快捷方式（避免使用许多 'ctrl + 1' 来创建不存在的字段），那就更好了：

```
public class MyClass {
  private String id;
  private String name;
  private String desc;

  public MyClass(String id, String name, String desc) {
    this.id = id;
    this.name = name;
    this.desc = desc;
  }

} 
```

* * *

## 更新

我找到了一种可以接受的方法来处理这个问题：

首先，我的典型用法：

我的带有参数的构造函数通常是另一个类的 ctrl + 1 的输出。

例如，在我的代码中：

```
MyClass type = new MyClass("id", "name", "desc"); // the constructor doesnt exist yet 
```

所以，我ctrl+1，创建构造函数，然后tadaa，构造函数是eclipse创建的

现在，为了帮助我创建字段并从参数中为其分配值，我只需将光标放在构造函数参数**ctrl + 1 --> 将参数分配给新字段**，然后对所有参数重复。

希望这可以帮助 ！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T06:47:26.747

```
public class MyClass {
  private String id;
  private String name;
  private String desc;
} 
```

如果您键入这么多右键单击-> 源-> 使用字段生成构造函数

您还可以生成所有 getter 和 setter。一旦默认情况下没有热键，我就为热键设置了这些。但他们需要检查字段，所以它不是即时的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T04:19:39.280

请看看它是否有效。

分配给本地：Ctrl+2，L

分配给字段：Ctrl+2, F

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T04:01:17.807

你可以试试：

1.  转到`Window`-> `Preference`-> `Java`-> `Code Style`->`CodeTemplates`

2.  编辑构造函数模板以满足您的要求

3.  编辑类模板并添加构造函数 var。

然后，当您创建一个新类时，Eclipse 会自动将构造函数添加到您的代码中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-26T12:43:27.390

您可以按`alt`+ `shift`+ `s`+ `o`。

将出现一个弹出窗口 - 单击`ok`并生成带有字段的类的构造函数。

# shell - 如何在 shell 中等待后台作业完成

> ID：12380948
> 
> 赞同：0
> 
> 时间：2012-09-12T03:50:13.220
> 
> 标签：shell, process, crontab

我有这段代码：

```
sqlplus usr1/pw1@DB1 @$DIR/a.sql $1 &
sqlplus usr2/pw2@DB2 @$DIR/b.sql $1 &
wait
echo "Done!" 
```

两个 sqlplus 会话都在后台，因此它们可以同时运行，并等待命令等待它们完成。

在实际程序中，“echo”实际上是对另一个程序的调用，该程序通过先前执行的查询处理假脱机文件，因此等待它们完成很重要。

我有一个问题，因为当我自己执行它时它工作正常，但当我在 crontab 上安排它时却没有。由于我似乎找不到解决方案，我想以某种方式模拟这种行为。这是我的想法：

```
sqlplus usr1/pw1@DB1 @$DIR/a.sql $1
session1=$! //I think this stores sqlpluss pid
sqlplus usr2/pw2@DB2 @$DIR/b.sql $1
session2=$!

while (not finished($session1) and not finished($session2)) //pseudocode
  do nothing //maybe sleep for a few seconds, something that wont waste resources unnecesarally

echo "Done!" 
```

我需要一些关于如何完成该循环的帮助。首先，我假设 $session1 和 $session2 有每个 sqlplus 会话的 pid。不确定这是否正确。然后，必须有一些简单的方法来检查进程是否仍在运行，它是 pid。最后，如果仍然有一个正在运行，我只想等待但不要循环数百万次，但可能会睡一分钟：

提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T04:56:22.757

为什么在 crontab 下不能在脚本中使用等待？就我而言，它可以。

使用名为 1.sh 的文件，如下所示：

```
#!/bin/bash
exec 2>&1
sleep 20&
time wait
echo hello 
```

以及 crontab 中的任务如下：

```
* * * * * bash ~/1.sh > ~/1.txt 
```

可以显示等待正在工作，因为它执行需要 20 秒：

```
$cat ~/.logs/1.txt

real    0m20.001s
user    0m0.000s
sys     0m0.000s
hello 
```

现在也许您可以尝试调试为什么等待在您的 crontab 中不起作用。您确定您使用的是 bash 而不是 POSIX sh 之类的其他 shell 吗？行为可以不同。

如果你不能开始`wait`工作，你可以试试`flock`。

# c# - 预转换的纹理多边形

> ID：12380950
> 
> 赞同：0
> 
> 时间：2012-09-12T03:50:44.503
> 
> 标签：c#, 3d, xna, texturing

我只是从 3D 开始，所以我有一个关于在屏幕上绘制预转换的东西的问题。

通过使用一些教程，我能够弄清楚如何以预转换形式绘制彩色多边形，但我就是不明白如何对它们进行纹理化......这可能吗？如果有怎么办？

我现在拥有的：

```
private void TestVertices()
{
 vertices = new VertexPositionColor[3];
 vertices[0].Position = new Vector3(-0.5f, -0.5f, 0f);
 vertices[0].Color = Color.Red;
 vertices[1].Position = new Vector3(0, 0.5f, 0f);
 vertices[1].Color = Color.Green;
 vertices[2].Position = new Vector3(0.5f, -0.5f, 0f);
 vertices[2].Color = Color.Blue;
} 
```

和

```
protected override void Draw(GameTime gameTime)
{
     device.Clear(Color.DarkSlateBlue);
     effect.CurrentTechnique = effect.Techniques["Pretransformed"];
     foreach (EffectPass pass in effect.CurrentTechnique.Passes)
     {
         pass.Apply();
         device.DrawUserPrimitives(PrimitiveType.TriangleList, vertices, 0, 1, VertexPositionColor.VertexDeclaration);
     }
     base.Draw(gameTime);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T08:05:30.170

而不是`VertexPositionColor`，`VertexPositionColorTexture`用于您的顶点，并将`TextureCoordinate`成员设置为每个轴上 0 到 1 之间的值。

绘制时，设置`GraphicsDevice.Texture[0]`为您要使用的纹理。

确保您的像素着色器执行以下操作：

```
// in the header:
sampler myTexture : register(s0);

// in your shader function:
float4 outputColor = input.Color * tex2D(myTexture, input.TexCoord); 
```

* * *

如果您正在使用`BasicEffect`，则等效于使用`VertexPositionColorTexture`，将 设置`BasicEffect.Texture`为您的纹理，然后设置`BasicEffect.TextureEnabled = true`。

# java - 在 spring mvc 中烘焙表单以进行编辑

> ID：12380952
> 
> 赞同：0
> 
> 时间：2012-09-12T03:50:58.930
> 
> 标签：java, spring, jakarta-ee, spring-mvc

完全初学者到spring mvc。我需要在 springmvc 框架中预填充编辑表单。

contact_edit.jsp

```
<form:form method="post" action="edit/1" commandName="contact">
<% Contact contact = (Contact)request.getAttribute("contact");  %>
    <table>

        <tr>
            <td><form:label path="firstname">
                    <spring:message code="label.firstname" />
                </form:label></td>
            <td><form:input path="firstname" value="<%=contact.getFirstname() %>"/></td>
        </tr>
        <tr>
            <td><form:label path="lastname">
                    <spring:message code="label.lastname" />
                </form:label></td>
            <td><form:input path="lastname" value="<%=contact.getLastname() %>"/></td>
        </tr>
        <tr>
            <td><form:label path="email">
                    <spring:message code="label.email" />
                </form:label></td>
            <td><form:input path="email" value="<%=contact.getEmail()%>" /></td>
        </tr>
        <tr>
            <td><form:label path="telephone">
                    <spring:message code="label.telephone" />
                </form:label></td>
            <td><form:input path="telephone" value="<%=contact.getTelephone()%>"/></td>
        </tr>
        <tr>
            <td colspan="2"><input type="submit"
                value="<spring:message code="label.addcontact"/>" /></td>
        </tr>
    </table>
</form:form> 
```

获取此页面的控制器代码：

```
@RequestMapping(value = "/edit/{contactId}", method = RequestMethod.GET)
public ModelAndView edit(@PathVariable("contactId") Integer contactId,
        HttpServletRequest request) {
    System.out.println("I was here");
    Contact contact = contactService.getContact(contactId);
    request.setAttribute("contact", contact);
    Map<String, Object> model = new HashedMap();
    model.put("contact", contact);

    return new ModelAndView("contact_edit", model);
} 
```

我的例外：

```
org.springframework.beans.InvalidPropertyException: Invalid property 'firstname' of bean class [net.viralpatel.contact.form.Contact_$$_javassist_0]: Getter for property 'firstname' threw exception; nested exception is java.lang.reflect.InvocationTargetException
org.springframework.beans.BeanWrapperImpl.getPropertyValue(BeanWrapperImpl.java:845)
org.springframework.beans.BeanWrapperImpl.getPropertyValue(BeanWrapperImpl.java:721)
org.springframework.validation.AbstractPropertyBindingResult.getActualFieldValue(AbstractPropertyBindingResult.java:99)
org.springframework.validation.AbstractBindingResult.getFieldValue(AbstractBindingResult.java:219)
org.springframework.web.servlet.support.BindStatus.<init>(BindStatus.java:120)
org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:178)
org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:198)
org.springframework.web.servlet.tags.form.LabelTag.autogenerateFor(LabelTag.java:129)
org.springframework.web.servlet.tags.form.LabelTag.resolveFor(LabelTag.java:119)
org.springframework.web.servlet.tags.form.LabelTag.writeTagContent(LabelTag.java:89)
org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:102)
org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:79)
org.apache.jsp.WEB_002dINF.jsp.contact_005fedit_jsp._jspx_meth_form_005flabel_005f0(contact_005fedit_jsp.java:320)
org.apache.jsp.WEB_002dINF.jsp.contact_005fedit_jsp._jspService(contact_005fedit_jsp.java:147)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:433)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1180)
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:950)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

root cause

  java.lang.reflect.InvocationTargetException
  sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
  sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method.invoke(Method.java:601)
org.springframework.beans.BeanWrapperImpl.getPropertyValue(BeanWrapperImpl.java:761)
org.springframework.beans.BeanWrapperImpl.getPropertyValue(BeanWrapperImpl.java:721)
org.springframework.validation.AbstractPropertyBindingResult.getActualFieldValue(AbstractPropertyBindingResult.java:99)
org.springframework.validation.AbstractBindingResult.getFieldValue(AbstractBindingResult.java:219)
org.springframework.web.servlet.support.BindStatus.<init>(BindStatus.java:120)
org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:178)
org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:198)
org.springframework.web.servlet.tags.form.LabelTag.autogenerateFor(LabelTag.java:129)
org.springframework.web.servlet.tags.form.LabelTag.resolveFor(LabelTag.java:119)
org.springframework.web.servlet.tags.form.LabelTag.writeTagContent(LabelTag.java:89)
org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:102)
org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:79)
org.apache.jsp.WEB_002dINF.jsp.contact_005fedit_jsp._jspx_meth_form_005flabel_005f0(contact_005fedit_jsp.java:320)
org.apache.jsp.WEB_002dINF.jsp.contact_005fedit_jsp._jspService(contact_005fedit_jsp.java:147)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:433)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1180)
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:950)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

我的联系方式：

```
@Entity
@Table(name="CONTACTS")
public class Contact {

@Id
@Column(name="ID")
@GeneratedValue
private Integer id;

@Column(name="FIRSTNAME")
private String firstname;

@Column(name="LASTNAME")
private String lastname;

@Column(name="EMAIL")
private String email;

@Column(name="TELEPHONE")
private String telephone;

public String getEmail() {
    return email;
}
public String getTelephone() {
    return telephone;
}
public void setEmail(String email) {
    this.email = email;
}
public void setTelephone(String telephone) {
    this.telephone = telephone;
}
public String getFirstname() {
    return firstname;
}
public String getLastname() {
    return lastname;
}
public void setFirstname(String firstname) {
    this.firstname = firstname;
}
public void setLastname(String lastname) {
    this.lastname = lastname;
}
public Integer getId() {
    return id;
}
public void setId(Integer id) {
    this.id = id;
}

} 
```

我的 Contact 类包含所有 getter 和 setter 方法，甚至我的创建表单也可以正常工作。无法弄清楚是什么在哪里造成了问题。我已经在请求以及 ModelAndView 类中插入了联系人对象。！！！？？！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:54:15.360

我通过在 applicationContext.xml 而不是 spring-servlet.xml 中初始化 sessionFactory 来解决它。并确保将其从 spring-servlet.xml 中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T04:21:47.427

您不需要显式调用 getter。由于您使用的是 spring 表单标签，因此 spring 将自动填充您的表单。

编辑：

```
@RequestMapping(value = "/edit/{contactId}", method = RequestMethod.GET)
public ModelAndView edit(@PathVariable("contactId") Integer contactId) {
    System.out.println("I was here");
    Contact contact = contactService.getContact(contactId);
    return new ModelAndView("contact_edit","contact", contact);
} 
```

请尝试替换此行

```
Contact contact = contactService.getContact(contactId); 
```

和

```
Contact contact = new Contact(); 
```

只是为了找出问题的根源

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T03:59:28.843

我认为问题出在您的模型类上。您的模型中有 getter/setter 方法`firstname`吗？如果是，请添加代码以便我们进一步调查

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T04:34:54.967

您的代码中要纠正的几件事：

1）当您将域对象添加到模型时，spring mvc 使它们可用于您的 JSP。您无需在请求中再次设置域对象。因此，请从您的控制器中删除以下内容。

`request.setAttribute("contact", contact);`

同样不需要在你的jsp中引用请求对象。所以删除

`Contact contact = (Contact)request.getAttribute("contact");`

2) 当您使用 spring 表单标签的 'commandName' 属性设置表单支持域对象时，spring 使用域对象的属性来设置/获取表单元素的值。

例如，在以下代码中，spring 将在填充/提交表单时使用 getter/setter 作为联系人的名字属性。

```
<form:form method="post" action="edit/1" commandName="contact">
    <form:input path="firstname"/>
</form> 
```

只需确保为您需要从域/表单烘焙对象中使用的所有属性实现 getter/setter。

# mysql - 如何查看远程访问我的 MYSQL 数据库的 IP？

> ID：12380954
> 
> 赞同：0
> 
> 时间：2012-09-12T03:51:09.900
> 
> 标签：mysql

我们有一个带有 MySQL 的专用服务器。我们的开发人员已授予对某些 IP 的远程访问权限。我想查询以查看已被授予访问权限的 IP 列表。我在网上找不到任何文档可以准确地告诉您如何做到这一点。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:55:17.947

看看 show grants 函数：[https ://dev.mysql.com/doc/refman/5.5/en/show-grants.html](https://dev.mysql.com/doc/refman/5.5/en/show-grants.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T05:10:05.810

您可以使用这样的语句

```
SELECT Host, User FROM mysql.users; 
```

# arrays - Hive 数组类型的求和值

> ID：12380955
> 
> 赞同：7
> 
> 时间：2012-09-12T03:51:13.093
> 
> 标签：arrays, hadoop, aggregate, hive, aggregation

Hive 有一个非常好的 Array 类型，理论上非常有用，但在实践中，我发现关于如何使用它进行任何类型的操作的信息非常少。我们将一系列数字存储在数组类型的列中，并且需要在查询中对它们求和，最好是从第 n 个元素到第 m 个元素。是否可以使用标准 HiveQL 或是否需要 UDF 或客户映射器/缩减器？

注意：我们在 EMR 环境中使用 Hive 0.8.1。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-17T13:30:12.907

`UDF`为此，我会写一个简单的。你需要`hive-exec`在你的构建路径中。
例如`Maven`：

```
<dependency>
  <groupId>org.apache.hive</groupId>
  <artifactId>hive-exec</artifactId>
  <version>0.8.1</version>
</dependency> 
```

一个简单的原始实现如下所示：

```
package com.myexample;

import java.util.ArrayList;
import java.util.List;

import org.apache.hadoop.hive.ql.exec.UDF;
import org.apache.hadoop.io.IntWritable;

public class SubArraySum extends UDF {

    public IntWritable evaluate(ArrayList<Integer> list, 
      IntWritable from, IntWritable to) {
        IntWritable result = new IntWritable(-1);
        if (list == null || list.size() < 1) {
            return result;
        }

        int m = from.get();
        int n = to.get();

        //m: inclusive, n:exclusive
        List<Integer> subList = list.subList(m, n);

        int sum = 0;
        for (Integer i : subList) {
            sum += i;
        }
        result.set(sum);
        return result;
    }
} 
```

接下来，构建一个 jar 并将其加载到 Hive shell 中：

```
hive> add jar /home/user/jar/myjar.jar;
hive> create temporary function subarraysum as 'com.myexample.SubArraySum'; 
```

现在您可以使用它来计算您拥有的数组的总和。

例如：

假设您有一个输入文件，其中包含制表符分隔的列：

```
1   0,1,2,3,4
2   5,6,7,8,9 
```

将其加载到 mytable 中：

```
hive> create external table mytable (
  id int,
  nums array<int>
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
COLLECTION ITEMS TERMINATED BY ','
STORED AS TEXTFILE
LOCATION '/user/hadoopuser/hive/input'; 
```

然后执行一些查询：

```
hive> select * from mytable;
1   [0,1,2,3,4]
2   [5,6,7,8,9] 
```

在 m,n 范围内求和，其中**m=1，n=3**

```
hive> select subarraysum(nums, 1,3) from mytable;
3
13 
```

或者

```
hive> select sum(subarraysum(nums, 1,3)) from mytable;
16 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T06:41:49.700

上面的答案解释得很好。我发布了一个非常简单的 UDF 实现。

```
package com.ak.hive.udf.test;

import java.util.ArrayList;

import org.apache.hadoop.hive.ql.exec.UDF;

    public final class ArraySumUDF extends UDF {
        public int evaluate(ArrayList<Integer>arrayOfIntegers,int startIndex,int endIndex) {
            // add code to handle all index problem
                    int sum=0;
            int count=startIndex-1;
            for(;count<endIndex;count++){
                sum+=arrayOfIntegers.get(count);
            }
            return sum;
        }
    } 
```

还发布表创建和其他查询。

```
create table table1 (col1 int,col2 array<int>)ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' COLLECTION ITEMS TERMINATED BY '~' STORED AS TEXTFILE;

load data local inpath '/home/ak/Desktop/hivedata' into table table1; 
```

我的输入文件看起来像

1,3~5~8~5~7~9
2,93~5~8~5~7~29
3,3~95~8~5~27~9
4,3~5~58~15~7 ~9
5,3~25~8~55~7~49
6,3~25~8~15~7~19
7,3~55~78~5~7~9

我创建了我的 UDF 的 jar，我使用以下命令将 jar 添加到 hive

```
add jar file:///home/ak/Desktop/array.jar; 
```

然后我创建临时函数，如图所示

```
create temporary function getSum as 'com.ak.hive.udf.test.ArraySumUDF'; 
```

执行如下示例查询，

```
select col1,getSum(col2,1,3) from table1; 
```

这应该解决非常基本的需求。如果这不是问题陈述，请回复，以便我再次为您提供帮助。

# cuda - 使用 CUDA 的标准差

> ID：12380966
> 
> 赞同：1
> 
> 时间：2012-09-12T03:52:39.553
> 
> 标签：cuda, standard-deviation

我正在编写一个代码来查找 6 个向量的均值和标准差，每个向量有 8000 个元素。我想知道我是否可以使用 CUDA 来加快操作速度。我可以想到如何使用 CUDA 找到平均值，但我无法理解如何使用 CUDA 计算标准差。任何人都可以在这里帮助我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T06:14:03.467

[这是一个 Thrust 示例](https://github.com/thrust/thrust/blob/master/examples/summary_statistics.cu)，它在一次通过中计算多个汇总统计信息，包括平均值和标准差。偏差。

```
#include <thrust/device_vector.h>
#include <thrust/host_vector.h>
#include <thrust/transform_reduce.h>
#include <thrust/functional.h>
#include <thrust/extrema.h>
#include <cmath>
#include <limits>

// This example computes several statistical properties of a data
// series in a single reduction.  The algorithm is described in detail here:
// http://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Parallel_algorithm
//
// Thanks to Joseph Rhoads for contributing this example

// structure used to accumulate the moments and other 
// statistical properties encountered so far.
template <typename T>
struct summary_stats_data
{
    T n;
    T min;
    T max;
    T mean;
    T M2;
    T M3;
    T M4;

    // initialize to the identity element
    void initialize()
    {
      n = mean = M2 = M3 = M4 = 0;
      min = std::numeric_limits<T>::max();
      max = std::numeric_limits<T>::min();
    }

    T variance()   { return M2 / (n - 1); }
    T variance_n() { return M2 / n; }
    T skewness()   { return std::sqrt(n) * M3 / std::pow(M2, (T) 1.5); }
    T kurtosis()   { return n * M4 / (M2 * M2); }
};

// stats_unary_op is a functor that takes in a value x and
// returns a variace_data whose mean value is initialized to x.
template <typename T>
struct summary_stats_unary_op
{
    __host__ __device__
    summary_stats_data<T> operator()(const T& x) const
    {
         summary_stats_data<T> result;
         result.n    = 1;
         result.min  = x;
         result.max  = x;
         result.mean = x;
         result.M2   = 0;
         result.M3   = 0;
         result.M4   = 0;

         return result;
    }
};

// summary_stats_binary_op is a functor that accepts two summary_stats_data 
// structs and returns a new summary_stats_data which are an
// approximation to the summary_stats for 
// all values that have been agregated so far
template <typename T>
struct summary_stats_binary_op 
    : public thrust::binary_function<const summary_stats_data<T>&, 
                                     const summary_stats_data<T>&,
                                           summary_stats_data<T> >
{
    __host__ __device__
    summary_stats_data<T> operator()(const summary_stats_data<T>& x, const summary_stats_data <T>& y) const
    {
        summary_stats_data<T> result;

        // precompute some common subexpressions
        T n  = x.n + y.n;
        T n2 = n  * n;
        T n3 = n2 * n;

        T delta  = y.mean - x.mean;
        T delta2 = delta  * delta;
        T delta3 = delta2 * delta;
        T delta4 = delta3 * delta;

        //Basic number of samples (n), min, and max
        result.n   = n;
        result.min = thrust::min(x.min, y.min);
        result.max = thrust::max(x.max, y.max);

        result.mean = x.mean + delta * y.n / n;

        result.M2  = x.M2 + y.M2;
        result.M2 += delta2 * x.n * y.n / n;

        result.M3  = x.M3 + y.M3;
        result.M3 += delta3 * x.n * y.n * (x.n - y.n) / n2; 
        result.M3 += (T) 3.0 * delta * (x.n * y.M2 - y.n * x.M2) / n;

        result.M4  = x.M4 + y.M4;
        result.M4 += delta4 * x.n * y.n * (x.n * x.n - x.n * y.n + y.n * y.n) / n3;
        result.M4 += (T) 6.0 * delta2 * (x.n * x.n * y.M2 + y.n * y.n * x.M2) / n2;
        result.M4 += (T) 4.0 * delta * (x.n * y.M3 - y.n * x.M3) / n;

        return result;
    }
};

template <typename Iterator>
void print_range(const std::string& name, Iterator first, Iterator last)
{
    typedef typename std::iterator_traits<Iterator>::value_type T;

    std::cout << name << ": ";
    thrust::copy(first, last, std::ostream_iterator<T>(std::cout, " "));  
    std::cout << "\n";
}

int main(void)
{
    typedef float T;

    // initialize host array
    T h_x[] = {4, 7, 13, 16};

    // transfer to device
    thrust::device_vector<T> d_x(h_x, h_x + sizeof(h_x) / sizeof(T));

    // setup arguments
    summary_stats_unary_op<T>  unary_op;
    summary_stats_binary_op<T> binary_op;
    summary_stats_data<T>      init;

    init.initialize();

    // compute summary statistics
    summary_stats_data<T> result = thrust::transform_reduce(d_x.begin(), d_x.end(), unary_op, init, binary_op);

    std::cout <<"******Summary Statistics Example*****"<<std::endl;
    print_range("The data", d_x.begin(), d_x.end());

    std::cout <<"Count              : "<< result.n << std::endl;
    std::cout <<"Minimum            : "<< result.min <<std::endl;
    std::cout <<"Maximum            : "<< result.max <<std::endl;
    std::cout <<"Mean               : "<< result.mean << std::endl;
    std::cout <<"Variance           : "<< result.variance() << std::endl;
    std::cout <<"Standard Deviation : "<< std::sqrt(result.variance_n()) << std::endl;
    std::cout <<"Skewness           : "<< result.skewness() << std::endl;
    std::cout <<"Kurtosis           : "<< result.kurtosis() << std::endl;

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T05:09:22.813

这超出了我的专业领域，但是有用于计算标准偏差的单程迭代算法，可以转换为减少。特别是，我正在考虑 Welford 算法，如 Knuth, TAOCP, vol. 中所述。2\. 一个缺点是它需要在每一步都进行除法，但这可能会与必要的内存访问很好地平衡。该算法的可用在线参考似乎是：

[http://www.johndcook.com/standard_deviation.html](http://www.johndcook.com/standard_deviation.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T14:48:23.040

我已经在 CUDA 中为数据挖掘解决了这个问题。我没有使用任何库。但是，它给了我很好的结果。问题是求128*100万个样本的标准差和均值。这就是我所做的。

1.  我的设备有 16KB 的共享内存。而且，我正在使用花车。因此，共享内存可以容纳 4,000 个元素。我的设备每个块的最大线程数是 512。所以，我可以有 8 个块。如果我将 16KB 分成 8 个块，我将得到 2,000KB（即 1 个线程的 1 个浮点数）。一般来说，这不会匹配。如果您有更好的设备，则需要再次进行此数学运算。

2.  为了找到标准差，每个块有 512 个元素。您可以使用单个线程找到平方（元素均值）。

3.  下一个挑战是添加它并找到这些元素的总和。尝试使用与求均值相同的方法。对于 512 个元素。将结果复制到全局内存。

4.  迭代。求结果的平方根。

PS：相应地进行计划，以使全局内存调用最小化。平均值和标准差经常从内存中调用数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-25T21:59:24.973

一个迟到的答案，但我已经在我的代码中解决了这个问题[`thrust::transform_reduce`](https://thrust.github.io/doc/group__transformed__reductions.html#ga0d4232a9685675f488c3cc847111e48d)（在 GTX 1070 上测试了 100k 浮点数）：

```
#include <thrust/transform_reduce.h>
#include <thrust/device_vector.h>
#include <thrust/functional.h>

#include <functional>
#include <cmath>

/*
 * @struct varianceshifteop
 * @brief a unary function that shifts input data
 * by their mean and computes the squares of them
 */
struct varianceshifteop
    : std::unary_function<float, float>
{
    varianceshifteop(float m)
        : mean(m)
    { /* no-op */ }

    const float mean;

    __device__ float operator()(float data) const
    {
        return ::pow(data - mean, 2.0f);
    }
};

int main(int argc, char** argv)
{
    thrust::device_vector<float> data{ ... };

    // sum elements and divide by the number of elements
    float mean = thrust::reduce(
        data.cbegin(),
        data.cend(),
        0.0f,
        thrust::plus<float>()) / data.size();

    // shift elements by mean, square, and add them
    float variance = thrust::transform_reduce(
            data.cbegin(),
            data.cend(),
            varianceshifteop(mean),
            0.0f,
            thrust::plus<float>()) / (data.size() - 1);

    // standard dev is just a sqrt away
    float stdv = std::sqrtf(variance);

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-03-02T18:12:50.207

这是使用[Thrust](https://docs.nvidia.com/cuda/thrust/index.html)找到向量的均值和方差的解决方案：

```
template <typename T> struct square {
    __host__ __device__ T operator()(const T& x) const {
        return x * x;
    }
};

template <typename T> void mean_and_var(T a, int n, double* p_mean, double* p_var) {
    double sum = thrust::reduce(a, &a[n], 0.0, thrust::plus<double>());
    double sum_square = thrust::transform_reduce(
        a,
        &a[n],
        square<double>(),
        0.0,
        thrust::plus<double>()
    );
    double mean = sum / n;
    *p_mean = mean;
    *p_var = (sum_square / n) - mean*mean;
} 
```

这是一个自包含源文件中的解决方案以及一些分析信息，比较 CPU 和 GPU（NB 完全按照要求回答问题，有必要在`mean_and_var`6 个长度为 8000 的不同向量上调用 6 次，但是这应该给你要点）：

```
#include "stdio.h"
#include <thrust/reduce.h>
#include <thrust/device_vector.h>

#define PROFILING_INIT                                              \
    cudaEvent_t start, stop;                                        \
    float elapsedTime;

#define PROFILING_START                                             \
    cudaEventCreate(&start);                                        \
    cudaEventCreate(&stop);                                         \
    cudaEventRecord(start, 0);

#define PROFILING_STOP                                              \
    cudaEventRecord(stop, 0);                                       \
    cudaEventSynchronize(stop);                                     \
    cudaEventElapsedTime(&elapsedTime, start, stop);                \
    printf("Time elapsed:  %.3g ms\n", elapsedTime);

#define N (6*8000)
// #define N (6*8000*10)
// #define N (6*8000*100)
double a[N];

template <typename T> struct square {
    __host__ __device__ T operator()(const T& x) const {
        return x * x;
    }
};

void mean_and_var_cpu(double* a, int n, double* p_mean, double* p_var) {
    double sum = 0, sum_square = 0, mean;
    for (int i = 0; i < n; i++) {
        sum += a[i];
        sum_square += (a[i] * a[i]);
    }
    mean = sum / n;
    *p_mean = mean;
    *p_var = (sum_square / n) - mean*mean;
}

template <typename T> void mean_and_var(T a, int n, double* p_mean, double* p_var) {
    double sum = thrust::reduce(a, &a[n], 0.0, thrust::plus<double>());
    double sum_square = thrust::transform_reduce(a, &a[n], square<double>(), 0.0, thrust::plus<double>());
    double mean = sum / n;
    *p_mean = mean;
    *p_var = (sum_square / n) - mean*mean;
}

int main() {
    for (int i = 0; i < N; i++) {
        a[i] = i;
    }

    double mean, var;

    PROFILING_INIT;

    printf("With thrust:\n");
    PROFILING_START;
    mean_and_var<double*>(a, N, &mean, &var);
    PROFILING_STOP;
    printf("Mean = %f, var = %f\n", mean, var);

    printf("With thrust, using device memory:\n");
    thrust::device_vector<double> a_dev(N);
    thrust::copy(a, &a[N], a_dev.begin());
    PROFILING_START;
    mean_and_var<thrust::device_ptr<double>>(&a_dev[0], N, &mean, &var);
    PROFILING_STOP;
    printf("Mean = %f, var = %f\n", mean, var);

    printf("On CPU:\n");
    PROFILING_START;
    mean_and_var_cpu(a, N, &mean, &var);
    PROFILING_STOP;
    printf("Mean = %f, var = %f\n", mean, var);

} 
```

为代码质量道歉（我主要是一名 C 程序员，为了 Thrust 的目的而尝试适应 C++）和缺乏评论。

`statistics`在所有情况下，答案都与使用 Python模块计算的均值和总体方差一致：

```
import statistics
x = 8000*6
print(statistics.mean(list(range(x))))
# print(statistics.variance(list(range(x))))
print(statistics.pvariance(list(range(x)))) 
```

以下是一些分析信息，所有这些信息都是在 Jetson Nano 开发板上执行的：

| ñ | 推力时间（毫秒） | Thrust 使用设备内存所用的时间（毫秒） | 简单 CPU 实现所用时间（毫秒） |
| --- | --- | --- | --- |
| 6*8000 | 11.2 | 2.38 | 1.11 |
| 6*8000*10 | 108 | 7.62 | 11.7 |
| 6*8000*100 | 1.12e+03 | 41.7 | 109 |

分析得出的结论：

*   如果您要使用 Thrust，请确保使用设备内存！
*   对于足够大的输入大小，GPU 比 CPU 快
*   对于较小的输入尺寸，取决于平台，使用 CPU 可能比使用 GPU 更快（**如果有人能告诉我为什么/如何改进我的 Thrust 代码以使其更快地用于较小的输入尺寸，那就太好了！**）

# shell - 寻找有效的文件分割

> ID：12380967
> 
> 赞同：1
> 
> 时间：2012-09-12T03:52:40.930
> 
> 标签：shell, unix, command-line, awk

假设这是我的文件：

```
$ cat file.txt 
A:1:i
B:2:ii
X:9:iv 
```

使用这样的 for 循环，我可以分别打印所有字段并重定向到子文件

```
$ for i in $(seq 1 3); do echo $i; awk -F ":" -v FL=$i '{print $FL}' file.txt > $i.out; done 
```

以便：

```
$ cat 1.out 
A
B
X

$ cat 2.out 
1
2
9

$ cat 3.out 
i
ii
iv 
```

问题：我必须在近 70 列和近 10 GB 的文件大小上执行此操作。它有效，但速度很慢。任何人都可以建议一个更好/有效的拆分来处理这个大数据集。谢谢。

```
$ for i in $(seq 1 70); do echo $i; awk -F ":" -v FL=$i '{print $FL}' *.data > $i.out; done 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T04:15:05.507

考虑到您要执行的操作，这应该相当快：

```
awk -F: '{ for (i=1; i<=NF; i++) print $i > i".out" }' file.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T04:25:57.177

蟒蛇版本

```
#!/bin/env python

with open('file.txt', 'r') as ih:
    while True:
        line = ih.readline()
        if line == '': break
        for i,element in enumerate(line.strip().split(':')):
            outfile = "%d.out" % (i+1)
            with open(outfile, 'a') as oh:
                oh.write("%s\n" % element) 
```

这可能会快一点，因为它只遍历原始文件一次。请注意，可以通过保持输出文件打开来进一步优化它（因为它是，我关闭它们中的每一个并为每次写入重新打开它们）。

**编辑**

例如，类似：

```
#!/bin/env python

handles = dict()

with open('file.txt', 'r') as ih:
    while True:
        line = ih.readline()
        if line == '': break
        for i,element in enumerate(line.strip().split(':')):
            outfile = "%d.out" % (i+1)

            if outfile not in handles:
                handles[outfile] = open(outfile, 'a');

            handles[outfile].write("%s\n" % element)

for k in handles:
    handles[k].close() 
```

这会使句柄在执行期间保持打开状态，然后在继续/结束之前将它们全部关闭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T04:22:05.463

在 perl 中，您可以执行以下操作：

```
#!/usr/bin/perl -w
my $n = 3;
my @FILES;
for my $i (1..$n) {
  my $f;
  open ($f, "> $i.out") or die;
  push @FILES, $f;
}
while (<>) {
  chomp;
  @a = split(/:/);
  for my $i (0..$#a) {
    print $FILES[$i] $a[$i],"\n";
  }
}
close($f) for $f in @FILES; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T13:11:29.553

这是一个使用我不经常看到的功能的 bash 脚本：要求 bash 为文件分配文件描述符并将描述符存储在变量中：

```
# Read the first line to get a count of the columns
IFS=: read -a columns < file.txt

# Open an output file for each column, saving the file descriptor in an array
for c in "${columns[@]}"; do
    exec {a}>$((++i)).txt
    fds+=( $a )
done

# Iterate through the iput, writing each column to the file opened for it
while IFS=: read -a fields; do
    for f in "${fields[@]}"; do
        printf "$f\n" >&${fds[++i]}
    done
done < file.txt

# Close the file descriptors
for fd in "${fds[@]}"; do
    exec {fd}>&-
done 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T08:49:05.893

如果您知道有三列，则使用 coreutils：

```
< file.txt tee >(cut -d: -f1 > 1.out) >(cut -d: -f2 > 2.out) >(cut -d: -f3 > 3.out) > /dev/null 
```

为了使其更通用，这是自动化命令行生成的一种方法：

```
# Determine number of fields and generate tee argument
arg=""
i=1
while read; do 
  arg="$arg >(cut -d: -f$i > $((i++)).out)"
done < <(head -n1 file.txt | tr ':' '\n') 
```

`arg`就是现在：

```
>(cut -d: -f1 > 1.out) >(cut -d: -f2 > 2.out) >(cut -d: -f3 > 3.out) 
```

保存到脚本文件：

```
echo "< file.txt tee $arg > /dev/null" > script 
```

并执行：

```
. ./script 
```

# android - 更新 Android 应用程序时如何清除旧的偏好设置？

> ID：12380968
> 
> 赞同：15
> 
> 时间：2012-09-12T03:52:39.943
> 
> 标签：android, sharedpreferences, preferences

我在 Google Play 市场上有一个应用程序。由于各种原因，我不会费心去讨论，我已经改变了我的一些偏好的类型。例如，首选项类型是整数，而在最新版本中，它现在是字符串。我想这不是一个好的做法，但不幸的是我不得不这样做。

我担心的是，当有人更新到新版本时，他们的应用程序会因为偏好类型的变化而崩溃。出于这个原因，我想在应用程序更新时清除首选项（我再次意识到不理想！）

这可能吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-12T04:04:43.910

该类`SharedPreferences.Editor`有一个`clear()`功能，它会删除所有存储的首选项（在 a 之后`commit()`）。您可以创建一个布尔标志，指示是否需要更新：

```
void updatePreferences() {
    SharedPreferences prefs = ...;
    if(prefs.getBoolean("update_required", true)) {
        SharedPreferences.Editor editor = prefs.edit();
        editor.clear();

        /*....make the updates....*/

        editor.putBoolean("update_required", false)
        editor.commit();
    }
} 
```

之后，您需要在您的主要（第一次开始）活动中调用它，然后才能访问任何首选项。

**编辑：**

要获取当前版本（清单中声明的​​ versionCode）：

```
int version = 1;
try {
    version = getPackageManager().getPackageInfo(getPackageName(), 0).versionCode;
} catch (NameNotFoundException e) {
    e.printStackTrace();
}

if(version > ...) {
    //do something
} 
```

**编辑**

如果您想做一些更新操作，每当版本更改时，您可以执行以下操作：

```
void runUpdatesIfNecessary() {
    int versionCode = getPackageManager().getPackageInfo(getPackageName(), 0).versionCode;
    SharedPreferences prefs = ...;
    if (prefs.getInt("lastUpdate", 0) != versionCode) {
        try {
            runUpdates();

            // Commiting in the preferences, that the update was successful.
            SharedPreferences.Editor editor = prefs.edit();
            editor.putInt("lastUpdate", versionCode);
            editor.commit();
        } catch(Throwable t) {
            // update failed, or cancelled
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-10-18T09:15:15.357

```
final String PREFERENCE_NAME = "my_preference";

final String APP_VERSION_CODE = 6; /* increase this if you want to clear
preference in updated app. */

preferences = getSharedPreferences(PREFERENCE_NAME, MODE_PRIVATE);

if (preferences.getInt(PREFERENCE_VERSION, 0) < APP_VERSION_CODE) {
      preferences.edit().clear().apply();
      preferences.edit().putInt(PREFERENCE_VERSION, APP_VERSION_CODE).apply();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-19T07:48:40.573

将版本代码存储在默认的 SharedPreferences 中并将您的其他首选项存储在版本指定的文件中，当版本更改时，您可以找到旧版本代码，您可以拥有旧的首选项文件并通过旧数据更新新版本

```
int versionCode=0,oldVersion;
    try
    {
        versionCode = getPackageManager().getPackageInfo(getPackageName(), 0).versionCode;
    }
    catch (PackageManager.NameNotFoundException e)
    {}
    SharedPreferences prefs =getSharedPreferences("MyPref" + versionCode, Context.MODE_PRIVATE);
    SharedPreferences prefsDefault = PreferenceManager.getDefaultSharedPreferences(MainActivity.this);  

    oldVersion=prefsDefault.getInt("OldVersion",0);

    if (oldVersion!=versionCode)
    {
        if (oldVersion>0)
        {
            // ToDo Update Preferences
            String oldPrefsKey="MyPref" + oldVersion;
            SharedPreferences oldPrefs =context.getSharedPreferences(oldPrefsKey, Context.MODE_PRIVATE);
            SharedPreferences.Editor pEdit=prefs.edit();
            pEdit.putBoolean("clock24",oldPrefs.getBoolean("clock24",false));
            pEdit.putBoolean("show_clock",oldPrefs.getBoolean("show_clock",true));
            pEdit.commit();
            oldPrefs.edit().clear().commit();
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.N) {
                deleteSharedPreferences(oldPrefsKey);
            } else {
                try {
                    File oldFile=new File(getCacheDir().getParent() + "/shared_prefs/"+oldPrefsKey+".xml");
                    oldFile.delete();
                } catch (Exception e) {

                }
            }

        }
        prefsDefault.edit().putInt("OldVersion",versionCode).commit();

    } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-08-20T06:10:43.957

您还可以在像这样获取 SharedPreferences 时附加版本号

```
context.getSharedPreferences("MyKey" + app_version_no, Context.MODE_PRIVATE); 
```

因此，如果您更新应用程序，版本号将发生变化，您将拥有一组新的偏好。

# jquery - 如何从 .load 转换为 .ajax？

> ID：12380973
> 
> 赞同：3
> 
> 时间：2012-09-12T03:52:59.707
> 
> 标签：jquery

我有以下代码示例，它使用以下语法调用 .load()：

```
.load( url [, data] [, complete(responseText, textStatus, XMLHttpRequest)] ) 
```

有没有一种简单的方法可以转换我的调用，所以我使用具有以下语法的 .ajax：

```
.ajax( url [, settings] ) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T03:57:43.330

[`.load()`](http://api.jquery.com/load/)只是[`.get()`](http://api.jquery.com/jQuery.get/)直接将其内容附加到附加元素。

因此，[`.ajax()`](http://api.jquery.com/jQuery.ajax/)版本应该是它的方法具有 GET 的版本，或者在 jQuery 的情况下，`type`：

```
$.ajax({
    type: "GET",
    url: "someURL.php",
    data: {...key-value pair parameters...},
    dataType : 'html'
}).done(function(msg) {
    $('html_selector').html(msg);
}); 
```

`.ajax()`return [deferred objects](http://api.jquery.com/category/deferred-object/)，这解释了[`.done()`](http://api.jquery.com/deferred.done/)此代码示例中的 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T04:09:21.897

您可以使用以下代码代替`.load`方法

```
$.ajax({
type: 'GET',//method GET/POST
url: "url",//Your url here
data: {data},//data to be send
complete: function(jqXHR, textStatus){
 console.log(jqXHR);
 console.log(textStatus);
 }
}); 
```

# iphone - UITableView 不显示滚动条的原因

> ID：12380983
> 
> 赞同：1
> 
> 时间：2012-09-12T03:54:39.023
> 
> 标签：iphone, ios, uitableview

我有一个 NavigationController 可以堆叠 UIViewcontrollers，这些 UIViewcontrollers 在其他 UI elmeents 中有 UITableView。我使用的表格实际上是使用自定义单元格视图的自定义表格。通过这种安排，即使我在 IB 中配置了 Shows Vertical Scrollers 来显示它们，这些表也不会显示任何类型的滚动条。

我尝试了几种调试方法，但均未成功。如果我打印以控制台此属性的值 (showsVerticalScrollers)，它会打印 1，因此该属性已正确设置，不，我的表不比其父视图宽，实际上它比其父视图窄。

表格不显示它的滚动是否有原因？...顺便说一句，这发生在在模拟器中运行的 iOS5 中。我将 xcode 4.2 与 SLeopard 一起使用。我无法使用 iPad 在硬件中对其进行测试，但我在同一个项目中拥有的其他表可以毫无问题地显示它们的滚动条。

**编辑**

感谢您的回答...我进行了最后一次测试，发现不显示滚动条的原因之一是表格中显示的元素数量，当它们适合而不需要实际滚动时。假设您有一个有 1 行的表格，并且表格的垂直大小对于一行来说太大了？那么 iOS 在弹跳时不会显示滚动条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:58:50.477

很难在没有看到任何代码的情况下提供可能的解决方案，但我可以提供的建议是将您的代码更新为实现 UITableView 所需的最少代码并查看滚动是否有效，如果有效，则以小增量添加功能，使用每个新代码添加测试滚动，直到达到滚动中断的程度。以这种方式进行增量测试有助于避免此类无法有效调试应用程序的问题。

# php - 在 Yii 框架中使用身份验证和调用 beforeSave 更新记录的最佳解决方案是什么？

> ID：12380985
> 
> 赞同：1
> 
> 时间：2012-09-12T03:55:09.973
> 
> 标签：php, yii

我在 yii api 文档上，有一个名为`saveAttributes()`用于更新几个字段的方法。我的情况只是`status`通过此方法更新特定字段。

```
ModelName::model()->findByPk($id)->saveAttributes(array('status' => 1)); 
```

但似乎`saveAttributes`没有`beforeSave()`在模型中调用方法，那么最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T08:23:22.103

```
$model = ModelName::model()->findByPk($id);
$model->status = 1;
$model->save(); 
```

[http://www.yiiframework.com/doc/api/1.1/CActiveRecord/#saveAttributes-detail](http://www.yiiframework.com/doc/api/1.1/CActiveRecord/#saveAttributes-detail)

# postgresql - 尝试在 PostgreSQL 中插入时间戳值时出错？

> ID：12380988
> 
> 赞同：4
> 
> 时间：2012-09-12T03:55:26.150
> 
> 标签：postgresql, sql-insert

我正在尝试插入以下值

```
('PA', 'Hilda Blainwood', 3, 10.7, 4308.20, '9/8/1974', '9:00', '07/03/1996 10:30:00'); 
```

进入具有以下结构的表**所有类型**

```
create table alltypes( state CHAR(2), name CHAR(30), children INTEGER, distance FLOAT,
budget NUMERIC(16,2), checkin TIME, started TIMESTAMP); 
```

弹出以下错误

```
test=# insert into alltypes VALUES('PA', 'Hilda Blainwood', 3, 10.7, 4308.20, '9/8/1974',
'9:00', '07/03/1996 10:30:00');
ERROR:  INSERT has more expressions than target columns
LINE 1: ...Blainwood', 3, 10.7, 4308.20, '9/8/1974', '9:00', '07/03/199... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T04:09:38.740

该错误消息非常不言自明：您正在尝试插入更多表具有列的值。您的表有七列，但您的 VALUES 表达式有八个值。

顺便说一句，您应该在插入时始终指定列：

```
insert into alltypes (state, name, children, distance, budget, checkin, started)
values (...) 
```

# ruby-on-rails - 在 FactoryBot 定义中通过 rolify 设置角色

> ID：12380989
> 
> 赞同：32
> 
> 时间：2012-09-12T03:55:42.187
> 
> 标签：ruby-on-rails, rspec, devise, factory-bot

我正在使用 devise、rolify 和 cancan。我还在使用带有 FactoryBot 的 RSpec 进行测试。现在我正在做一些测试，我想为这些测试定义具有不同角色的用户。这是我目前对如何使用 FactoryBot 做到这一点的猜测：

```
FactoryBot.define do
  factory :user do
    name 'Test User'
    email 'example@example.com'
    password 'please'
    password_confirmation 'please'
    # required if the Devise Confirmable module is used
    confirmed_at Time.now

    factory :admin do
        self.has_role :admin
    end

    factory :curator do
        self.has_role :curator
    end

    factory :super_admin do
        self.has_role :super_admin
    end
  end
end 
```

以下是我的一些测试，它们似乎没有正确编写：require 'spec_helper'

```
describe "Pages" do
    subject { page }

    before do
        @newpage = FactoryBot.create(:page)
        @newpage.save
    end

    context 'not logged in' do
        it_behaves_like 'not admin'
    end

    context 'logged in' do

        context 'as user' do
            before do
                @user = FactoryBot.create(:user)
                sign_in @user
            end

            it_behaves_like 'not admin'
        end

        context 'as curator' do
            before do
                @curator = FactoryBot.create(:curator)
                sign_in @curator
            end

            it_behaves_like 'not admin'
        end

        context 'as admin' do
            before do
                @admin = FactoryBot.create(:admin)
                sign_in @admin
            end

            it_behaves_like 'admin'
        end

        context 'as super admin' do
            before do
                @super_admin = FactoryBot.create(:super_admin)
                sign_in @super_admin
            end

            it_behaves_like 'admin'
        end
    end
end 
```

当我运行规范时，这些是我的错误：

```
1) Pages logged in as admin behaves like admin can show page 
 Failure/Error: Unable to find matching line from backtrace
 NoMethodError:
   undefined method `has_role=' for #<User:0x007f883384d178>
 Shared Example Group: "admin" called from ./spec/requests/pages_spec.rb:41
 # ./spec/requests/pages_spec.rb:37:in `block (4 levels) in <top (required)>'

2) Pages logged in as curator behaves like not admin can show page 
 Failure/Error: Unable to find matching line from backtrace
 ArgumentError:
   Factory not registered: curator
 Shared Example Group: "not admin" called from ./spec/requests/pages_spec.rb:32
 # ./spec/requests/pages_spec.rb:28:in `block (4 levels) in <top (required)>'

3) Pages logged in as super admin behaves like admin can show page 
 Failure/Error: Unable to find matching line from backtrace
 ArgumentError:
   Factory not registered: super_admin
 Shared Example Group: "admin" called from ./spec/requests/pages_spec.rb:50
 # ./spec/requests/pages_spec.rb:46:in `block (4 levels) in <top (required)>' 
```

注意：FactoryBot 以前称为 FactoryGirl

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-09-18T13:43:24.963

我宁愿使用 FactoryBot 的`after(:create)` [回调](https://github.com/thoughtbot/factory_bot/blob/master/GETTING_STARTED.md)来创建角色（另见Rolify 的[这个](https://github.com/RolifyCommunity/rolify/issues/99)问题）。

此外，该方法`has_role?`用于**检查**用户是否具有特定角色，要**设置**特定角色，您应该使用该`add_role`方法。

```
FactoryBot.define do
  factory :user do
    name 'Test User'
    email 'example@example.com'
    password 'please'
    password_confirmation 'please'
    # required if the Devise Confirmable module is used
    confirmed_at Time.now

    factory :admin do
        after(:create) {|user| user.add_role(:admin)}
    end

    factory :curator do
        after(:create) {|user| user.add_role(:curator)}
    end

    factory :super_admin do
        after(:create) {|user| user.add_role(:super_admin)}
    end
  end
end 
```

注意：FactoryBot 以前称为 FactoryGirl

# android - 在 Google Play 上发布 android 应用程序的屏幕截图大小

> ID：12380991
> 
> 赞同：44
> 
> 时间：2012-09-12T03:55:47.463
> 
> 标签：android, google-play, screenshot

在开发者控制台上，当您发布您的 Android 应用程序时，需要以下规格的屏幕截图：320 x 480、480 x 800、480 x 854、1280 x 720、1280 x 800 24 位 PNG 或 JPEG（无 alpha）完整流血，艺术没有边界。现在在[这个链接](http://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=1078870)上它说，“你最多可以上传 8 张截图。” 我的问题是，

*   最后五个屏幕截图的尺寸是多少？- 前三个是 - 320 x 480、480 x 800、480 x 854
*   第二到第八个屏幕截图是 480 x 800**还是**480 x 854，还是第二个应该是 480 x 800，第三个应该是 480 x 854，第四个到第八个？
*   尺寸 1280 x 720、1280 x 800 仅适用于平板电脑吗？它们是可选的吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-05-04T12:21:56.510

*   我们需要 2 个屏幕截图。
*   使用：显示在您在 Google Play 中的应用程序的详细信息页面上。
*   您可以为手机、7 英寸平板电脑和 10 英寸平板电脑分别上传**最多 8 个屏幕截图。**
*   规格：最小尺寸：320 像素。最大尺寸：3840 像素。屏幕截图的最大尺寸不能超过最小尺寸的两倍。您可以使用 24 位 PNG 或 JPEG 图像（无 alpha）。全流血，艺术无边界。
*   我们建议您添加在 7 英寸和 10 英寸平板电脑上运行的应用的屏幕截图。转到开发者控制台中的“商品详情”页面添加平板电脑应用屏幕截图。

[https://support.google.com/googleplay/android-developer/answer/1078870?hl=en&ref_topic=2897459](https://support.google.com/googleplay/android-developer/answer/1078870?hl=en&ref_topic=2897459)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2020-02-21T12:30:51.273

当我发布应用程序时，我使用以下屏幕截图尺寸：

**电话：1080 x 1920**我准备了 8 张带有标题的图片，一些精美的背景和智能手机模型中的屏幕截图。所以这不仅仅是一个简单的截图。它提供了一些不错的品牌，并帮助您从其他应用程序中脱颖而出。

**平板电脑 7": 1200 x 1920** - 我实际上做了几个 7" 模拟器的原始屏幕截图，以便用户可以知道布局将如何出现在他的设备上。没有带有标题等的花哨设计。

**平板电脑 10"：1800 x 2560** - 相同，只是几张原始屏幕截图。

全部`.png`格式。希望这可以帮助。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-09-12T04:04:29.587

它必须是给定大小中的任何一种，并且至少 2 个但最多 8 个屏幕截图在 Google Playstore 中被接受。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2019-06-15T00:23:14.463

最后！我得到了答案，在 Photoshop 中编辑它的大小是：**379x674**

不客气

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-12T04:00:33.470

您最多可以上传 8 个屏幕截图。这些屏幕截图必须是您列出的尺寸（尺寸）之一；您可以有多个相同尺寸的屏幕截图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-01T11:05:22.540

这些文件必须是**24 位的****JPEG**或**PNG**格式，**如果是纵向的，比例为 2:1**，横向**的比例为 16:9**。请注意，如果您选择不同的尺寸：最大尺寸不应比最小尺寸大两倍以上。

# git - 如何将 git repo 作为子模块克隆到 hg repo 中？

> ID：12380993
> 
> 赞同：0
> 
> 时间：2012-09-12T03:55:48.540
> 
> 标签：git, mercurial, git-submodules

搜索了一下，并指出了这一点：[https ://www.mercurial-scm.org/wiki/Subrepository](https://www.mercurial-scm.org/wiki/Subrepository)

但那是一个hg中的一个hg。(hg 又名 mercurial)

我需要将 git repo 作为子模块克隆到我当前的 hg repo 中的步骤。

顺便说一句，我已经安装了 hg 和 git 。

所以我想知道，我可以简单地进入我的 hg repo 的文件夹，然后在那里做`git clone`吗？

所以单独的 hg 将管理整个应用程序（包括 git repo），而 git 管理它自己的 repo。

会有什么影响吗？
这个方法是hg中所谓的git子模块吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:00:56.467

你可以创建一个 git subrepo。看看[https://www.mercurial-scm.org/wiki/Subrepository#Git_subrepositories](https://www.mercurial-scm.org/wiki/Subrepository#Git_subrepositories)

# php - HTML 中的 {VARIABLE} 是什么意思，如何初始化它？

> ID：12380995
> 
> 赞同：-2
> 
> 时间：2012-09-12T03:56:24.500
> 
> 标签：php, html

我最近在阅读某人的代码。在他的代码中，我看到一个奇怪的 html 文本写成`{VARIABLE}`. 那个语法是什么意思？以及如何创建它？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T04:05:27.040

在 PHP 中，有一种叫做[“复杂（卷曲）语法”](http://www.php.net/manual/en/language.types.string.php)`{}`的东西（在页面的更深处查找），您可以在其中使用而不是切割和连接字符串将变量的值注入字符串。

可以在[这里找到类似的答案](https://stackoverflow.com/a/5368897/575527)

* * *

另一种情况是，当 HTML 用作模板时，HTML 可能包含该文本，[例如 CodeIgniter 中的这个](http://codeigniter.com/user_guide/libraries/parser.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T04:18:20.937

你不初始化它。这是他们模板引擎的一部分。

不管他们如何做，我们的想法是用您想要的实际数据查找/替换“{VAR}”。

```
var songTemplate = "<li class=\"track\"><span class=\"num\">{{TRACKNUM}}.</span>" +
                   "<span class=\"title\">{{TITLE}}</span>" +
                   "<span class=\"duration\">{{DURATION}}</span></li>";

var songs = [ { tracknum : 1, title : "Speak to Me/Breathe", duration : "4:13" },
              { tracknum : 2, title : "On the Run", duration : "3:36" },
              { tracknum : 3, title : "Time", duration : "7:01" } ];

function makeTrack (song, template) {
    var track = "";
    track = template.replace("{{TRACKNUM}}", song.tracknum);
    track = template.replace("{{TITLE}}"), song.title);
    track = template.replace("{{DURATION}}", song.duration);
    return track;
}

function trackList (songs, template) {
    var list = "<ul class=\"tracklist\">";
    songs.forEach(function (song) {
        list += makeTrack(song, template);
    });
    list += "</ul>";
    return list;
}

var songlist = trackList(songs, songTemplate);
parentEl.innerHTML = songlist; 
```

无论使用什么语言对其进行模板化，基本思想都是从一串 HTML 开始，取出您知道要替换的内容，然后放入您想要的数据。

我已经向你展示了一个丑陋的、丑陋的模板（如果我只需要写一个变量名数组，其余的都由它完成......或者它通过字符串查找`{{X}}`和然后通过一个对象寻找正确的值来替换它找到的值）。这也存在安全漏洞，如果您不能同时控制模板和数据（如果您允许最终用户在站点的任何位置输入，那么您就无法控制）。

但这应该足以说明模板是如何做的，以及为什么。

# jquery - 我可以使用字符串变量作为 jQuery 输入掩码参数吗？

> ID：12380996
> 
> 赞同：0
> 
> 时间：2012-09-12T03:56:34.620
> 
> 标签：jquery, input, mask

我正在尝试将变量用作掩码输入参数，但没有成功。

```
Dim sgra_id As String // SGRA_ID.VALUE WILL BE RETRIEVED FROM A COOKIE

$('#" + tbx.ClientID + "').mask(sgra_id, { placeholder: ' ' }); 
```

谁能告诉我它是如何工作的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:03:26.733

可能这个可以帮助你

```
$('#date').mask("99/99/9999",{placeholder:"-"}); 
```

[如何使用 jquery 屏蔽输入](http://webdeveloperplus.com/jquery/how-to-mask-input-with-jquery/)