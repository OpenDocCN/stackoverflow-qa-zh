# StackOverflow 问答 10234000-10234999

# jquery - 如何将 Jquery 响应（带有脚本标签的 HTML 页面）加载到 DOM 中

> ID：10234014
> 
> 赞同：0
> 
> 时间：2012-04-19T18:00:20.397
> 
> 标签：jquery, append, response

test1.html 文件：

```
<html>
<head>
<script src="jquery-1.7.2.js">
</script>
<script>

function loadfn(){

$.get('test.html',function(data){

alert($(data).text());
//$('body div#returnData').html(data);
$.each(data, function(i, node) { 
    alert(i);
   if (node.tagName == "SCRIPT") {
       eval(node.innerHTML); 

   } else {
       $(node).appendTo($('#returnData')); 
   }

});

});
test1();
test2();
}
</script>
</head>
<body>
<div id="returnData" >
</div>
<input type="button" value="Click" onclick=loadfn()>
</body>
</html> 
```

测试.html：

```
<html>
<head>
<script src="/jquery-ui-timepicker-addon.js">
</script>
</head>
<script>
function test1(){
alert('test1 function');
}
</script>
<script>
function test2(){
alert('test2 function');
}
</script>
<body>
<div id="testdiv">
Text field : <input type="text" value="Test Value"/>
</div>
</body>
</html> 
```

实际上，我需要将 test.html 页面加载到 test1.html 中，然后运行该页面中的脚本函数。

上面的代码片段不能满足要求。请让我知道我在代码片段中做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:07:54.227

你需要做这样的事情来加载脚本元素，所以我的建议是当你得到响应时替换`script`字符串`scri" + "pt`

```
var code = "<script>alert('Hi!');</scr"+"ipt>";
$('body').append($(code)[0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:39:37.553

您无需将其“加载”到您的 DOM 中。对于脚本标签，你可以这样做..

```
eval("<script>alert('Hi!');</script>"); 
```

**更新 ：**

如果结果同时包含**HTML**和 SCRIPT 节点，请执行以下操作。

```
$.each(nodes, function(i, node) { //result might contain muliple HTML/Script nodes

   if (node.tagName == "SCRIPT") {
       eval(node.innerHTML); 
       //Appending to DOM also executes the script. So we do eval() instead, which does the equivalent.
   } else {
       $(node).appendTo($('#returnData')); //And append your HTML nodes to the desired target div
   }

}); 
```

# javascript - jquery 扩展返回 $.each 混淆

> ID：10234017
> 
> 赞同：0
> 
> 时间：2012-04-19T18:00:26.060
> 
> 标签：javascript, jquery

我正在尝试使用我遇到的 jQuery 扩展（[handsontable](http://handsontable.com/)）。我在创建表格时没有问题

```
var spreadsheet = $("#dataTable").handsontable({
            rows: 3,
            cols: 15,
            minSpareRows: 2
}); 
```

但是，在创建表之后，我想调用我在 javascript 中为`Handsontable`对象声明的各种帮助函数。问题是扩展似乎返回了`this.each(function() { ... });`，我不明白如何从中访问底层`Handsontable`对象。扩展的 js 可以在[这里](https://github.com/warpech/jquery-handsontable/blob/master/jquery.handsontable.js)找到，我在下面的链接上放了一个小演示

[http://jsfiddle.net/7JTG2/7/](http://jsfiddle.net/7JTG2/7/)

如您所见，我想在单击按钮时获取其中一个单元格的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:22:47.097

相关代码在最后：

```
$.fn.handsontable = function (action, options) {
    if (typeof action !== 'string') { //init
        options = action;
        return this.each(function () {
            if($(this).data("handsontable")) {
                instance = $(this).data("handsontable");
                ...
            } else {
                   ...
                instance = new Handsontable($(this), currentSettings);
                $(this).data("handsontable", instance);
            }
        });
    }
} 
```

这意味着，代码将`Handsontable`实例设置为元素的数据属性（并将选定的集合返回为可链接的）。拥有一个元素，您可以使用`instance = $el.data("handsontable")`. 如果您有一组元素，则需要对其进行循环 - 例如使用[`each()`](http://api.jquery.com/each/).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T18:26:54.380

看起来您可以使用插件的 onChange 方法在每次自动输入数据时捕获数据。不需要按钮。添加到上面代码中的一个简单示例。

```
onChange: function(data) {
            $("#data").append(JSON.stringify(data));
          } 
```

# php - AJAX 不工作 PHP

> ID：10234018
> 
> 赞同：1
> 
> 时间：2012-04-19T18:00:27.183
> 
> 标签：php, html, ajax

我正在尝试通过 ajax 从服务器检索 xml 文件，但无法解析它。我不知道我做错了什么。当我调用 getFriends.php 时，它会很好地打印 xml。这是ajax代码：

```
<!DOCTYPE>
<html>
<head>
<title>Ajax Sample</title>

<script type="text/javascript">

function getFriendsList(MemberId) {

    var xmlhttp;

    if (window.XMLHttpRequest) {
        // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
    }
    else {
        // code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange=function() {

    if (xmlhttp.readyState==4 && xmlhttp.status==200) {

            var xmlDoc = xmlhttp.responseXML;
            var friendElements = xmlDoc.getElementsByTagName('friend');

            for (var x=0; x<friendElements.length; x++) {
                // We know that the first child of show is title, and the second is rating
                var id = showElements[x].childNodes[0].value;
                var name = showElements[x].childNodes[1].value;

                // Now do whatever you want with the show title and ratings
                document.write("hi");
          }

        }
    }

    xmlhttp.open("POST","getFriends.php",true);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send("id=" + MemberId);

}

</script>

</head>

<body>

    <input name="ajax" type="button" onClick="getFriendsList(1)" value="Click for AJAX">
    <div style="background-color:#00FF99;" id="placehere">Here is where the update will occur.</div>
</body>
</html> 
```

这是 getFriends.php 代码（用户类工作正常）：

```
<?php
include('lib.php');
//$id = $_POST['id'];
$id=1;
$user = new User($id);

echo $user->getFriendsList();

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:32:50.960

您的 for 循环中有未定义的变量“showElements”。这两行：

```
var id = showElements[x].childNodes[0].value;
var name = showElements[x].childNodes[1].value; 
```

应替换为：

```
var id = friendElements[x].childNodes[0].value;
var name = friendElements[x].childNodes[1].value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:07:43.690

使用 jquery 执行 ajax 调用既简单又轻松，请参阅[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)了解更多信息

# android - Android 通过 AssetManager 访问资产的各种方式之间的差异

> ID：10234025
> 
> 赞同：2
> 
> 时间：2012-04-19T18:00:54.553
> 
> 标签：android

我是一名初学者 Android 程序员，在使用各种方法从 AssetManager 读取资产时遇到了一个奇怪的问题。

我在下面附上了显示此问题的示例代码。它读取一个包含“hello”的简单文本文件资产（“hello.txt”）。我将其作为原始字节读入并打印出字符的十六进制值（68 65 6c 6c 6f）。

我尝试过的方法是（按代码顺序）：

*   打开AssetFileDescriptor（AFD），创建InputStream：只读取前三个字节（68 65 6c ffffffff ffffffff）
*   打开 AFD，获取底层文件描述符，创建 FileInputStream：完全错误的数据 (50 4b 3 4 a)
*   直接打开InputStream：正确（68 65 6c 6c 6f）

我也重复了同样的三种方法，这次首先读入一个字节数组，这（令人惊讶！）改变了第一个结果，但产生了相同的结果（为方便起见，在此重复）：

*   打开AFD，创建InputStream，先读入字节数组：正确（68 65 6c 6c 6f）
*   打开AFD，获取底层文件描述符，创建FileInputStream，先读入字节数组：完全错误的数据（50 4b 3 4 a）
*   直接打开InputStream，先读入字节数组：正确（68 65 6c 6c 6f）

请注意，除了第一种情况（仅读入三个字节时），其他情况正好读取 6 个字节（包括末尾的换行符），随后将按预期返回 -1。这包括读入错误数据的情况。

有没有人遇到过这个？这是一个错误，还是我做错了什么？

谢谢！

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    AssetManager am = getAssets();
    StringBuilder sb = new StringBuilder();

    try {
        AssetFileDescriptor afd = am.openFd("hello.txt"); 
        InputStream instream = afd.createInputStream();
        sb.append(String.format("afd.createInputStream(): %x %x %x %x %x\n", instream.read(), instream.read(), instream.read(), instream.read(), instream.read()));
        instream.close();
        afd.close();
    }
    catch (IOException e) {
        throw new RuntimeException(e);
    }

    try {
        AssetFileDescriptor afd = am.openFd("hello.txt");
        InputStream instream = new FileInputStream(afd.getFileDescriptor());
        sb.append(String.format("new FileInputStream(afd): %x %x %x %x %x\n", instream.read(), instream.read(), instream.read(), instream.read(), instream.read()));
        instream.close();
        afd.close();
    }
    catch (IOException e) {
        throw new RuntimeException(e);
    }

    try {
        InputStream instream = am.open("hello.txt");
        sb.append(String.format("am.open(): %x %x %x %x %x\n", instream.read(), instream.read(), instream.read(), instream.read(), instream.read()));
        instream.close();
    }
    catch (IOException e) {
        throw new RuntimeException(e);
    }

    try {
        AssetFileDescriptor afd = am.openFd("hello.txt");
        InputStream instream = afd.createInputStream();
        byte[] b = new byte[instream.available()];
        instream.read(b);
        sb.append(String.format("afd.createInputStream() -> byte[]: %x %x %x %x %x\n", b[0], b[1], b[2], b[3], b[4]));
        instream.close();
        afd.close();
    }
    catch (IOException e) {
        throw new RuntimeException(e);
    }

    try {
        AssetFileDescriptor afd = am.openFd("hello.txt");
        InputStream instream = new FileInputStream(afd.getFileDescriptor());
        byte[] b = new byte[(int) afd.getLength()];
        instream.read(b);
        sb.append(String.format("new FileInputStream(afd) -> byte[]: %x %x %x %x %x\n", b[0], b[1], b[2], b[3], b[4]));
        instream.close();
        afd.close();
    }
    catch (IOException e) {
        throw new RuntimeException(e);
    }

    try {
        InputStream instream = am.open("hello.txt");
        byte[] b = new byte[instream.available()];
        instream.read(b);
        sb.append(String.format("am.open() -> byte[]: %x %x %x %x %x\n", b[0], b[1], b[2], b[3], b[4]));
        instream.close();
    }
    catch (IOException e) {
        throw new RuntimeException(e);
    }

    // print result
    TextView textview = (TextView) findViewById(R.id.textview);
    textview.setText(sb.toString());
    Log.d("blah", sb.toString());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T04:37:12.953

从应用的 BaseContext 获取 InputStream。下面的示例演示了从 assets 文件夹中获取一个 txt 文件并将其内容打印到控制台。

```
 try {
        InputStream in = getBaseContext().getResources().getAssets().open("sample.txt");
        InputStreamReader is = new InputStreamReader(in);
        BufferedReader br = new BufferedReader(is);
        String read=br.readLine();

        while(read != null) {
            System.out.println(read);
            read = br.readLine();
        }

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

# c - 在两个套接字之间共享信息

> ID：10234027
> 
> 赞同：0
> 
> 时间：2012-04-19T18:01:00.287
> 
> 标签：c, multithreading, sockets, process

我正在尝试实现一个基于 UDP 的服务器，它维护两个套接字，一个用于控制（`ctrl_sock`），另一个用于数据传输（`data_sock`）。问题是，`ctrl_sock`始终是上行链路和`data_sock`下行链路。也就是说，客户端将通过 请求数据传输/停止`ctrl_sock`，数据将通过 发送给他们`data_sock`。

现在的问题是，由于模型是无连接的，服务器将不得不维护一个注册客户信息列表（我称之为`peers_context`），以便它可以“盲目地”向他们推送数据，直到他们要求停止。`ctrl_sock`在这种盲传过程中，客户端可以通过异步的方式向服务器发送控制消息。这些信息，除了初始请求和停止之外，还可以是例如文件部分的首选项。因此，`peers_context`必须异步更新。但是，通过 的传输`data_sock`依赖于这种结构，因此会产生和`peers_context`之间的同步问题。我的问题是，我能做些什么来安全地维护这两个袜子和结构，以便异步更新`ctrl_sock``data_sock``peers_context``peers_context`不会造成破坏。顺便说一句，更新`peers_context`不会很频繁，这就是为什么我需要避免请求-回复模型。

`data_sock`我对实现的初步考虑是，在主线程（监听线程）中维护 ctrl_sock，在另一个线程（工作线程）中维护传输。但是，我发现在这种情况下很难同步。例如，如果我在 中使用互斥锁`peers_context`，每当工作线程锁定`peers_context`时，监听线程在需要修改时将无法再访问它`peers_context`，因为工作线程无休止地工作。另一方面，如果侦听器线程持有`peers_context`并写入它，则工作线程将无法读取`peers_context`并终止。有人可以给我一些建议吗？

顺便说一下，实现是在Linux环境中用C语言完成的。只有监听线程需要`peers_context`偶尔修改，工作线程只需要读取。衷心感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:27:23.657

如果您的竞争激烈，`peers_context`那么您需要缩短关键部分。您谈到了使用互斥锁。我假设您已经考虑更改为读取器+写入器锁并拒绝它，因为您不希望不断的读取器饿死写入器。这个怎么样？

制作一个非常小的结构，它是对这样的间接引用`peers_context`：

```
struct peers_context_handle {
    pthread_mutex_t ref_lock;
    struct peers_context *the_actual_context;
    pthread_mutex_t write_lock;
}; 
```

数据包发送者（读取者）和控制请求处理器（写入者）总是`peers_mutex`通过这种间接访问。

假设：数据包发送者永远不会修改`peers_context`，也不会释放它。

Packer 发送者短暂锁定句柄，获取当前版本`peers_context`并解锁：

```
pthread_mutex_lock(&(handle->ref_lock));
peers_context = handle->the_actual_context;
pthread_mutex_unlock(&(handle->ref_lock)); 
```

（实际上，如果您引入内存屏障，您甚至可以取消锁定，因为指针取消引用在 Linux 支持的所有平台上都是原子的，但我不推荐它，因为您必须开始研究内存屏障和其他低级的东西，C 和 POSIX 都不能保证它无论如何都能工作。）

请求处理器不会更新`peers_context`，他们会复制并完全替换它。这就是他们如何保持他们的关键部分很小。它们*确实*用于`write_lock`序列化更新，但更新很少，所以这不是问题。

```
pthread_mutex_lock(&(handle->write_lock));

/* Short CS to get the old version */
pthread_mutex_lock(&(handle->ref_lock));
old_peers_context = handle->the_actual_context;
pthread_mutex_unlock(&(handle->ref_lock));

new_peers_context = allocate_new_structure();
*new_peers_context = *old_peers_context;

/* Now make the changes that are requested */
new_peers_context->foo = 42;
new_peers_context->bar = 52;

/* Short CS to replace the context */
pthread_mutex_lock(&(handle->ref_lock));
handle->the_actual_context = new_peers_context;
pthread_mutex_unlock(&(handle->ref_lock));

pthread_mutex_unlock(&(handle->write_lock));

magic(old_peers_context); 
```

有什么问题？这是最后一行代码的魔力。您必须释放旧副本`peers_context`以避免内存泄漏，但您不能这样做，因为可能有数据包发送者仍在使用该副本。

该解决方案类似于在 Linux 内核中使用的[RCU 。](http://lwn.net/Articles/262464/)您必须等待所有数据包发送者线程进入静止状态。我将把它的实现作为一个练习留给你 :-) 但这里是指导方针：

*   该`magic()`函数添加了`old_peers_context`一个待释放队列（必须由互斥锁保护）。
*   一个专用线程循环释放此列表：
    1.  它锁定待释放列表
    2.  它获得一个指向列表的指针
    3.  它用一个新的空列表替换了列表
    4.  解锁待释放列表
    5.  它清除与每个工作线程关联的标记
    6.  它等待再次设置所有标记
    7.  它释放其先前获得的待释放列表副本中的每个项目
*   同时，每个工作线程在其事件循环中的空闲点（即它不忙于发送任何数据包或持有任何`peer_contexts`.

# javascript - JavaScript“x in obj”：obj.x 未定义？

> ID：10234028
> 
> 赞同：1
> 
> 时间：2012-04-19T18:01:05.893
> 
> 标签：javascript, syntax, for-in-loop

以下代码：

```
var obj = {uname:"OdO", age:"22"};  
alert(obj.uname); 
```

结果是：

```
OdO 
```

现在，在`for..in`语句中使用相同的概念：

```
for (x in obj) {
    document.write(obj.x+"<br>");
} 
```

我希望它打印以下内容：

```
OdO  
22 
```

但它打印：

```
undefined  
undefined 
```

并且为了实现元素中的打印循环，它应该写成这样的数组元素：

```
for (x in obj) {
    document.write(obj[x]+"<br>");
} 
```

那么，为什么第一个语法不起作用，但它在`for..in`语句之外起作用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T18:03:31.163

当你写 时`obj.x`，这实际上是在寻找一个名为“x”的属性`obj`——就像`obj.size`寻找一个名为“size”的属性一样。`x`没有为您的对象定义，所以它什么都没有。正确的写法`obj[x]`——使用*变量* `x`在对象中查找属性。括号语法使用括号内的值来查找属性，而点语法将属性名称转换为字符串。所以这两个是等价的：

```
obj.x
obj["x"] 
```

所以当你写`x`after时`obj.`，它会将它转换`x`成一个字符串——它不再是一个变量了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T18:05:56.013

括号语法用于接收名称为表达式的属性（表达式可以是文字、变量或更复杂的东西）：

```
var x = "a";
{a:0, b:1}[x] == 0; 
```

点语法用于接收具有该名称的属性：

```
({a:0, x:1}).x == 1; 
```

在您的 for-in-loop 中，变量`x`包含属性名称。您正在尝试访问`"x"`未定义的名为 的属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T18:05:22.707

`obj[x]`当属性名称存储在名为“x”的变量中时使用方括号形式 ( )，当属性名称*字面意思是*`obj.x`“x”时使用属性形式 ( ) 。

 *例如：

```
var o = {foo:1};
o.foo; // => 1
var x = 'foo';
o[x]; // => 1, since x='foo' and has a property named "foo".
o.x; // => undefined, since "o" has no property named "x". 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T18:05:43.270

尝试

```
for(var x in obj){
    console.log(obj[x]);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T18:18:09.270

这对我有用：

```
var obj = {uname:"OdO", age:"22"};  

for (x in obj) {
    document.write(obj[x.toString()] + "<br>");
}​ 
```

[http://jsfiddle.net/zA8HB/](http://jsfiddle.net/zA8HB/)*

# sql - 创建外键时省略父表的列

> ID：10234030
> 
> 赞同：0
> 
> 时间：2012-04-19T18:01:10.537
> 
> 标签：sql, oracle, foreign-keys

要在 Oracle 中创建外键，有时我会看到

```
CONSTRAINT FK_Supplier
  FOREIGN KEY (Supplier_id)
  REFERENCES Supplier(Supplier_id) 
```

但是，在其他时候，我看到了这个

```
CONSTRAINT FK_Supplier
  FOREIGN KEY (Supplier_id)
  REFERENCES Supplier 
```

不同之处在于该列在第一个语句中`Supplier_id`位于表之后，`Supplier`但在第二个语句中被省略。

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:14:37.180

这在[文档中有所描述：](http://docs.oracle.com/cd/B28359_01/server.111/b28286/clauses002.htm)

> 如果仅标识父表或视图并省略列名，则外键会**自动引用**父表或视图的主键。外键和被引用键的相应列或列必须在顺序和数据类型上匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T11:20:31.647

关于 SQL 不忠实于关系模型的主要批评之一是对列顺序的依赖。然而，仅仅因为 SQL 包含非关系特性，并不意味着应该使用它们。事实上，我强烈认为应该避免使用这些功能，或者在无法避免的情况下减少此类功能。

标准 SQL 提供了一些语法来避免依赖列排序（`NATURAL JOIN`,`UNION CORRESPONDING`等）。其他语法有助于减轻这种依赖（例如`INSERT INTO (<comma list of columns>) VALUES (<comma list of fields in same order>)`）。`FOREIGN KEY`语法属于第二类。

结论：始终使用第一个示例中的语法并避免使用第二个示例。

# ios - 在 StoryBoard TabBar 上设置托管对象上下文 - 带有嵌入式导航控制器的表视图控制器

> ID：10234031
> 
> 赞同：0
> 
> 时间：2012-04-19T18:01:10.850
> 
> 标签：ios, core-data, storyboard

我正在尝试在 TabBar - NavigationController - TableViewController 配置上使用 CoreData 和 Storyboard。

当试图将托管对象上下文分配给 TableViewController 我得到

```
[UITabBarController topViewController]: unrecognized selector sent to instance 
```

如果我理解正确，问题是我没有得到 TableViewController 实例。我已经尝试了很多事情，但我似乎没有得到任何地方。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T15:17:48.990

我能够使用 raywenderlich.com 上的 Matthijs Hollemans 教程修复它。

```
UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;
UINavigationController *navigationController = [[tabBarController viewControllers] objectAtIndex:0];
MyViewController *controller = [[navigationController viewControllers] objectAtIndex:0];
controller.managedObjectContext = self.managedObjectContext; 
```

# jquery - Google maps api中点之间的“弹跳”

> ID：10234032
> 
> 赞同：0
> 
> 时间：2012-04-19T18:01:18.630
> 
> 标签：jquery, google-maps-api-3, google-earth

在谷歌地图中从一个点转移到另一个点时，有什么方法可以从谷歌地球实现相同的“反弹”功能？例如，如果您在以下列出的地震之间切换： [http ://earthquakeproject.com/?earth 如果您在](http://earthquakeproject.com/?earth)[http://earthquakeproject.com/?maps](http://earthquakeproject.com/?maps)上 执行相同的操作，则 gui 会在全球各个位置之间“反弹”您只是在这些位置之间滑动。我希望两者之间的功能感觉相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T20:42:46.043

所以..找不到解决方案，所以这就是我最终要做的，以防其他人需要做同样的事情。是的，我知道它可以更整洁......

首先我找到了一个确定距离的函数，并用它得出了一个从 1 到 4 的相对跳跃量

```
 function sloc(lat,lon){
            sloc_obj.lat1=sloc_obj.lat2;
            sloc_obj.lon1=sloc_obj.lon2;
            sloc_obj.lat2=lat;
            sloc_obj.lon2=lon;
            var R = 6371; // km
            var d = Math.acos(Math.sin(sloc_obj.lat1)*Math.sin(sloc_obj.lat2) + 
                Math.cos(sloc_obj.lat1)*Math.cos(sloc_obj.lat2) *
                Math.cos(sloc_obj.lon2-sloc_obj.lon1)) * R;

            if(d<1000){
                return 1;
            }
            if(d<5000){
                return 2;
            }
            if(d<10000){
                return 3;
            }
            return(4);
        } 
```

然后我用它来错开一组延时动作......

```
 var l1=$(this).data('lat');
                    var l2=$(this).data('lon');
                    //set up array for times actions
                    var cmd=[]
                    //get the zoom-level based on the distance between two lat/lon spots
                    var d=sloc(l1, l2);
                    //based on our max flyout level, populate our times commands
                    if(d>=1){cmd[cmd.length]="map.setZoom(5)";}
                    if(d>=2){cmd[cmd.length]="map.setZoom(4)";}
                    if(d>=3){cmd[cmd.length]="map.setZoom(3)";}
                    if(d>=4){cmd[cmd.length]="map.setZoom(2)";}
                    cmd[cmd.length]="map.panTo(new google.maps.LatLng("+l1+","+l2+"),"+(1+d)+");";
                    if(d>=4){cmd[cmd.length]="map.setZoom(3)";}
                    if(d>=3){cmd[cmd.length]="map.setZoom(4)";}
                    if(d>=2){cmd[cmd.length]="map.setZoom(5)";}
                    if(d>=1){cmd[cmd.length]="map.setZoom(6)";}
                    timer_offset=0;

                    //get the number of steps for our cmd iterator. subtract 1 so we get the middle step in our math since the number of steps will always be odd
                    steps=cmd.length-1
                    //iterate over ALL the steps.
                    for(x=0;x<=steps+1;x++){
                        //for the middle step, wait a bit more than normal
                        if(x>=steps/2){
                            timer_offset=(100*d);
                        }
                        //at the end of the middle action pan, wait a bit even more than that
                        if(x>=(steps/2)+1){
                            timer_offset=(100*d)+200;
                        }
                        //set our timeout
                        time=200+(x*100+timer_offset)
                        //load the command on the timeout
                        setTimeout(cmd[x],time);
                    } 
```

通过这种方式，我得到了一个相当平滑的过渡，这反映了实际行驶的距离。我会尝试更巧妙地做到这一点，也许更容易进出对数，但这比平面平移要好。

# ruby-on-rails - 当我运行 rake assets:precompile 时在 application.js 中找不到文件'jquery' //= 需要 jquery

> ID：10234037
> 
> 赞同：3
> 
> 时间：2012-04-19T18:01:53.023
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

当我跑步时

```
bundle exec rake assets:precompile 
```

我有

```
couldn't find file 'jquery' 
```

在 application.js 上线：

```
//= require jquery 
```

导轨 3.2.2。什么是理由？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T18:56:33.930

我敢说您的应用程序中的任何地方都没有 jquery.js 文件。如果它不在 app/assets 或 vendor/assets 或 lib/assets 中，请将其添加到其中之一——或者如果您使用的是 jquery-rails gem，请按照[此处](https://github.com/indirect/jquery-rails)的说明进行操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T09:00:53.523

如果您在生产中运行，则必须注释掉该行

```
Bundler.require(*Rails.groups(:assets => %w(development test))) 
```

并取消注释以下

```
Bundler.require(:default, :assets, Rails.env) 
```

因为默认情况下，包含在 Gemfile 中指定的“资产”组中的 gem 不会添加到生产环境中。

这导致我遇到类似的情况，我在生产中运行预编译，但 Uglifier 不断向我抛出“找不到 jquery 错误”，但在开发中进行了干净编译。

# java - 比较方法抛出异常：比较方法违反了它的一般约定

> ID：10234038
> 
> 赞同：4
> 
> 时间：2012-04-19T18:01:57.040
> 
> 标签：java, exception, comparator, contract

> **可能重复：**
> [为什么我的比较方法会抛出异常——比较方法违反了它的一般约定！](https://stackoverflow.com/questions/6626437/why-does-my-compare-method-throw-exception-comparison-method-violates-its-gen)

我有这个代码：

```
class TimeComparatorTipo0 implements Comparator {
@Override
public int compare(Object a, Object b) {
     String Time1   = ((DataImportedTipo0) a).ora;
     Long   VolTot1 = Long.parseLong(((DataImportedTipo0) a).volume_totale);

     String Time2   = ((DataImportedTipo0) b).ora;
     Long   VolTot2 = Long.parseLong(((DataImportedTipo0) b).volume_totale);

    if (Time1.equals(Time2))
    {          
       if ( VolTot1.compareTo(VolTot2) > 0)
         return 1;
       else
         return -1;         
    }
    else
      return Time1.compareTo(Time2);
     }
}; 
```

有时它会抛出这个异常：

```
java.lang.IllegalArgumentException: Comparison method violates its general contract!
at java.util.TimSort.mergeHi(TimSort.java:868)
at java.util.TimSort.mergeAt(TimSort.java:485)
at java.util.TimSort.mergeForceCollapse(TimSort.java:426)
at java.util.TimSort.sort(TimSort.java:223)
at java.util.TimSort.sort(TimSort.java:173)
at java.util.Arrays.sort(Arrays.java:659)
at java.util.Collections.sort(Collections.java:217)
at ManageUrl.DownloadUrl.StartThreadDowloadTipo0(DownloadUrl.java:893)
at ManageUrl.DownloadUpdateWorkflow$ConsumerTipo0.run(DownloadUpdateWorkflow.java:278) 
```

为什么 ？

1）我怎样才能避免它？2）我怎样才能捕捉到这个异常？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T18:05:41.723

如果你有两个元素时相等`a`，`b`你会得到`compare(a, b) == -1`，`compare(b, a) == -1`这没有任何意义。

您可以简化代码并使其更高效

```
class TimeComparatorTipo0 implements Comparator<DataImportedTipo0> {
@Override
public int compare(DataImportedTipo0 a, DataImportedTipo0 b) {
    String Time1 = a.ora, Time2 = b.ora;

    int cmp = Time1.compareTo(Time2);
    if (cmp == 0) {
       // avoid expensive operations.
       Long VolTot1 = Long.parseLong(a.volume_totale);
       Long VolTot2 = Long.parseLong(b.volume_totale);
       cmp = VolTot1.compareTo(VolTot2);
    }
    return cmp; 
```

# mysql - 休眠中人员姓氏和名字类的唯一值

> ID：10234040
> 
> 赞同：0
> 
> 时间：2012-04-19T18:02:05.143
> 
> 标签：mysql, spring, hibernate

嗨，我想在我的数据库中为我的 person 表设置一个唯一的姓氏和名字。我的人的休眠 xml 映射是

```
package com.me.POJO;

public class Person {

private int personId;
private String firstName;
private String lastName;
private String streetAddress;
private String aptNo;
private String city;
private int zipCode;

public Person(){}
public Person(String firstName, String lastName, String streetAddress,
String aptNo, String city, int zipCode) {
this.firstName = firstName;
this.lastName = lastName;
this.streetAddress = streetAddress;
this.aptNo = aptNo;
this.city = city;
this.zipCode = zipCode;
}

public int getPersonId() {
return personId;
}

public void setPersonId(int personId) {
this.personId = personId;
}

public String getFirstName() {
return firstName;
}

public void setFirstName(String firstName) {
this.firstName = firstName;
}

public String getLastName() {
return lastName;
}

public void setLastName(String lastName) {
this.lastName = lastName;
}

public String getStreetAddress() {
return streetAddress;
}

public void setStreetAddress(String streetAddress) {
this.streetAddress = streetAddress;
}

public String getAptNo() {
return aptNo;
}

public void setAptNo(String aptNo) {
this.aptNo = aptNo;
}

public String getCity() {
return city;
}

public void setCity(String city) {
this.city = city;
}

public int getZipCode() {
return zipCode;
}

public void setZipCode(int zipCode) {
this.zipCode = zipCode;
}

} 
```

我的人的休眠 hbm.xml 文件是：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated Apr 9, 2012 2:49:54 PM by Hibernate Tools 3.4.0.CR1 -->
<hibernate-mapping>
<class name="com.me.POJO.Person" table="Person">
<id name="personId" type="int">
<column name="personId_PK" />
<generator class="native"></generator>
</id>
<property name="aptNo" type="java.lang.String">
<column name="aptNo" />
</property>
<property name="city" type="java.lang.String">
<column name="city" />
</property>
<property name="firstName" type="java.lang.String">
<column name="firstName" />
</property>
<property name="lastName" type="java.lang.String">
<column name="lastName" />
</property>
<property name="streetAddress" type="java.lang.String">
<column name="streetAddress" />
</property>
<property name="zipCode" type="int">
<column name="zipCode" not-null="true" />
</property>
</class>
</hibernate-mapping> 
```

有什么办法可以在 hbm 文件中的人员映射中添加唯一约束，以便我的名字和姓氏在数据库中是唯一的/

提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:06:44.457

您可以制作包含`last name`和`first name`使用[`<natural-id>`](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#mapping-declaration-naturalid)元素的自然键。

请注意，`<natural-id>`只有当 Hibernate 生成表模式时，才有助于在自然键列上创建唯一约束`hbm2ddl`。Hibernate 不会 `<natural-id>`在运行时对列进行任何唯一性验证。

因此，如果您不打算使用 Hibernate 重新创建表模式，您可以简单地使用 DDL 手动为这些列添加唯一约束，并让数据库检查唯一性。

# javascript - 前三个 td 和最后一个 td 的单独单击事件在 Dom 更改中不起作用

> ID：10234041
> 
> 赞同：1
> 
> 时间：2012-04-19T18:02:12.830
> 
> 标签：javascript, jquery

我的表中有四列。当我们单击前三个 td 中的一个时，将执行一项操作，当我们单击最后一个 td 时，将执行其他类型的操作。我确实喜欢这个

```
$('#items_list tr td').not('#items_list tr td:last-child').click(function() {
  // Do  something
}

$("#items_list tr td:last-child").click(function() {
  // Do something
} 
```

但是当 Dom 发生变化时，那些不起作用。我尝试使用 .live()，但 li 的缺点是不支持链式方法。任何人都可以指导我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:10:20.037

无需向表格上的每个单元格添加事件。表 tbody 级别的一个事件处理程序可以处理它。

```
jQuery("#foo tbody").on("click", function (evt) {
   var elem = jQuery( evt.srcElement || evt.target );
    if (elem.is("td:last-child")) {
        alert("last child");
    } else {
        alert("not last child");
    }       
}); 
```

如果 td 中有元素，您可能必须向 elem 添加代码以查找最近的 td。

```
if (!elem.is("td")) {
    elem = elem.closest("td");
} 
```

[jsFiddle](http://jsfiddle.net/yBmVx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:03:43.457

```
$("#items_list tr td").last().click(function(){ }); 
```

# c# - 使用 PowerShell 查找最近的 System.Color 实例

> ID：10234046
> 
> 赞同：2
> 
> 时间：2012-04-19T18:02:43.490
> 
> 标签：c#, powershell

我让这段代码在 C# 中工作。我想帮助将其翻译成惯用的 PowerShell 脚本，该脚本将 rgb 或 hex 颜色定义作为输入，并将前 3 或 5 个匹配项输出到控制台，包括颜色名称和 rgb 值。我对 PowerShell 很陌生，很抱歉，如果这要求太多。

```
 private static void FindMyColor()
    {
        System.Drawing.Color targetColor = System.Drawing.Color.FromArgb(red: 0, green: 128, blue: 0);
        var myStuff = EnumerateColors(targetColor: targetColor).OrderBy(tpl => tpl.Item1).ToList();
        int a = 0; // Pause the debugger here.
    }

    private static double GetColorDistance(System.Drawing.Color lhs, System.Drawing.Color rhs)
    {
        double sum = Cube(lhs.R - rhs.R) + Cube(lhs.G - rhs.G) + Cube(lhs.B - rhs.B);
        return Math.Pow(sum, 1.0/3.0);
    }

    private static double Cube(int value)
    {
        return (double) (value * value * value);
    }

    private static System.Collections.Generic.IEnumerable<Tuple<double, string, System.Drawing.Color>> EnumerateColors(System.Drawing.Color targetColor)
    {
        var candidateColors = EnumerateSystemColors();
        foreach (string colorName in candidateColors.Keys)
        {
            var color = candidateColors[key: colorName];
            double colorDistance = GetColorDistance(lhs: color, rhs: targetColor);
            yield return new Tuple<double, string, System.Drawing.Color>(colorDistance, colorName, color);
        }
    }

    private static System.Collections.Generic.Dictionary<string, System.Drawing.Color> EnumerateSystemColors()
    {
        var properties = typeof(System.Drawing.Color)
                .GetProperties(System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.FlattenHierarchy);
        return properties.ToDictionary(p => p.Name, p => (System.Drawing.Color)p.GetValue(null, null));
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T15:14:17.350

只是为了完整起见，这里有一个 PowerShell 版本，可以找到最接近的颜色。

首先，我们检索[`Color`](http://msdn.microsoft.com/en-us/library/system.drawing.color.aspx)类型上声明为静态命名属性的所有颜色：

```
$namedColors = [Drawing.Color] | Get-Member -Static -MemberType Property |
  foreach { [Drawing.Color]::($_.Name) } 
```

为了确定两种颜色之间的距离，我们可以使用[笛卡尔距离](http://en.wikipedia.org/wiki/Cartesian_coordinate_system#Distance_between_two_points)为三个 RGB 维度定义一个自定义函数：

```
function Measure-ColorDistance( [Drawing.Color]$a, [Drawing.Color]$b ) {
  $sum = 'R','G','B' | foreach { [Math]::Pow( $a.$_ - $b.$_, 2 ) } | measure -Sum
  [Math]::Round( [Math]::Pow( $sum.Sum, 0.5 ), 2 )
} 
```

为了更容易指定目标颜色，我们可以定义一个辅助函数来创建[ARGB](http://msdn.microsoft.com/en-us/library/at1k42eh.aspx)颜色值：

```
function New-Color( [byte]$r = 0, [byte]$g = 0, [byte]$b = 0, [byte]$a = 255 ) {
  [Drawing.Color]::FromArgb( $a, $r, $g, $b )
} 
```

最后，为了找到最接近的颜色，我们可以得到每个命名颜色与目标之间的距离，并返回按该距离排序的顶部颜色：

```
function MatchColor( [Drawing.Color]$targetColor, [int]$top = 5 ) {
  $distance = @{ n='Distance'; e={ Measure-ColorDistance $targetColor $_ } }
  $distances = $namedColors | Select-Object $distance,Name
  $distances | Sort-Object Distance | Select-Object -First $top
} 
```

调用`MatchColor (New-Color -g 128)`将显示前五名的结果：

```
Distance Name
-------- ----
       0 Green
      28 DarkGreen
   49.33 ForestGreen
   99.03 SeaGreen
   99.37 DarkOliveGreen 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T20:43:10.540

为什么不将此代码添加为带有 add-type 的类型？并在 powershell 中使用它`[myclass]::GetColorDistance(....)`- 有关更多详细信息，请参见此处

[添加类型](http://msdn.microsoft.com/en-us/library/dd315241.aspx)

# c# - 对 Linq 查询进行排序

> ID：10234047
> 
> 赞同：1
> 
> 时间：2012-04-19T18:02:44.423
> 
> 标签：c#, linq

我一辈子都想不通为什么这个列表不能正确排序。有人可以指出我做错了什么吗？

```
List<WNBlogPost> posts = new List<WNBlogPost>();

IEnumerable<WNBlogPost> orderedPosts = (
    from p in posts
    select p
).OrderByDescending(c => c.ID);

foreach (WNBlogPost post in orderedPosts) {
    //output post to page
} 
```

我正在循环中将项目添加到帖子列表中，但是它们添加到列表中的顺序与我添加 OrderByDescending() 后它们出现的顺序相同。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-19T18:05:02.957

LINQ 查询（无需外部努力）不会将副作用引入它们操作的集合中。因此，仅显示您可以通过 访问的`OrderByDescending`排序*视图*。`posts``orderedPosts`

```
// hat-tip: @JimSchubert
foreach (var post in orderedPosts)
{
    Frob(post); // these will be frobbed in descending order
} 
```

如果您想对实际列表本身进行排序，您应该使用[`List<T>.Sort`](http://msdn.microsoft.com/en-us/library/3da4abas.aspx)：

```
// utilize the Comparison<T> overload of List<T>.Sort to perform a
// descending sort based on the post ID
posts.Sort((post1, post2) => -post1.ID.CompareTo(post2.ID)); 
```

# rpm - RPM 规范文件 - 是否可以动态填充规范文件变量

> ID：10234053
> 
> 赞同：31
> 
> 时间：2012-04-19T18:03:06.060
> 
> 标签：rpm, rpmbuild, rpm-spec

我有一个规格文件。我需要定义一个从系统上的单行文件中获取其值的规范变量。

例如

```
%define path `cat /home/user/path_file` 
```

在 path_file 中是一行

```
/var/www/html/hosts 
```

这部分有效。我说从 RPM BUILD 输出开始，有时值`${path}`实际上是我的命令`cat /home/user/path_file`，有时值是 path_file (/var/www/html/hosts) 中的行，因为它应该是？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-19T20:20:21.193

`%(cmd)`您可以在规范文件的顶部定义 rpmbuild 变量。请注意，命令在括号中，而不是大括号中。一个例子：

```
%define whoami %(whoami) 
```

在规范文件的其他地方，例如脚本或构建/安装部分，在大括号中正常使用变量，如下所示：

```
echo "The user that built this is %{whoami}" 
```

`cmd`可以是任何东西，包括你的 cat 命令。小心 - 当另一个用户重建规范文件时，它可能找不到该文件。所以最好像这样使用 %{sourcedir} 宏：

```
%define path %(cat %{sourcedir}/path_file) 
```

并确保它`path_file`位于源目录中并作为源包含在规范文件中。

# javascript - 如何成功循环遍历 JQuery 中的类数组？

> ID：10234055
> 
> 赞同：0
> 
> 时间：2012-04-19T18:03:10.603
> 
> 标签：javascript, jquery, jquery-ui, jquery-selectors

我正在尝试将一组包含评论的类传递给一个函数，该函数将在列表中显示所有评论。该函数的目的是使列表下拉，并带有动画的感觉。与使用 .slideDown 略有不同，并且与 google+ 显示帖子所有评论的方式非常相似。

这是我的其他问题之一的 JSFiddle 链接。这就是我想要做的：

[http://jsfiddle.net/MZzUr/9/](http://jsfiddle.net/MZzUr/9/)

这是我尝试做同样的事情，但使用包含注释的类数组而不是 for 循环：

[http://jsfiddle.net/A9WLc/4/](http://jsfiddle.net/A9WLc/4/)

不打算放弃这个......现在已经做了好几天了。提前致谢。亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:19:45.320

当您使用`items[0]`它时，它会返回 DOM 节点，而不是 jQuery 对象。它相当于使用[`.get(index)`](http://api.jquery.com/get/). 您想使用[`.eq(index)`](http://api.jquery.com/eq/)which 返回 jQuery 对象。

```
var myItem = items.eq(0);
var height = myItem.height();
myItem.hide(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T19:19:43.730

我想我知道你要做什么。这不完全是，但它可能有用：http: [//jsfiddle.net/xkfqN/19/](http://jsfiddle.net/xkfqN/19/)

我试图重新创建谷歌如何为我工作的社交网络制作动画，但放弃了，只是按照 facebook 的方式去做......它只是弹出 :) 我不知道谷歌有什么样的巫术魔法但是真的很难复制。

# sql-server - 使用 t-sql 脚本启用/禁用 Sql Server 代理

> ID：10234057
> 
> 赞同：27
> 
> 时间：2012-04-19T18:03:14.343
> 
> 标签：sql-server, sql-server-agent

是否可以使用 t-sql 启用或禁用 sql server 代理？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-19T18:08:31.990

```
exec msdb..sp_update_job @job_name = 'Job Name', @enabled = 0 --Disable
exec msdb..sp_update_job @job_name = 'Job Name', @enabled = 1 --Enable 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-05-08T19:58:35.050

您可以使用它来将其设置为 ON 或 OFF

```
 EXEC xp_servicecontrol N'stop',N'SQLServerAGENT'
   EXEC xp_servicecontrol N'start',N'SQLServerAGENT' 
```

# javascript - 在不加载库的情况下使用 jQuery UI 函数

> ID：10234059
> 
> 赞同：1
> 
> 时间：2012-04-19T18:03:22.967
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins

我试图从 jQuery UI 中使用几个缓动函数，而不必完全加载 UI 库。

参考资料：[不使用插件的 jQuery 缓动函数](https://stackoverflow.com/questions/5207301/looking-for-jquery-easing-functions-without-using-a-plugin)

```
$.extend($.easing,
{
    def: 'easeOutQuad',
    swing: function (x, t, b, c, d) {
        //alert($.easing.default);
        return $.easing[$.easing.def](x, t, b, c, d);
    },
    easeInQuad: function (x, t, b, c, d) {
        return c*(t/=d)*t + b;
    },
    easeOutQuad: function (x, t, b, c, d) {
        return -c *(t/=d)*(t-2) + b;
    },
    easeInOutQuad: function (x, t, b, c, d) {
        if ((t/=d/2) < 1) return c/2*t*t + b;
        return -c/2 * ((--t)*(t-2) - 1) + b;
    },
    easeInCubic: function (x, t, b, c, d) {
        return c*(t/=d)*t*t + b;
    }
});

$(function(){
    (function(){
        $('#the_ribbon').animate({
            top: '+=140',
          }, 1000, function() {
            //Consume an easing function here.
          });
    })();   

}); 
```

特别是我希望能够使用类似弹跳的效果，但不确定是否会缓和（不必包含 UI 文件）。

如何从 UI 源中引用和使用这些内容？

# ruby-on-rails - Ruby on Rails 和 SSL 错误

> ID：10234060
> 
> 赞同：1
> 
> 时间：2012-04-19T18:03:30.923
> 
> 标签：ruby-on-rails, ssl

我格式化了我的电脑并将我所有的 RoR 应用程序转移到我的新 Lubuntu 系统中。我有带有 Unity 的 Ubuntu。（仍然是一个linux系统）。我已经安装了 rvm、ruby、rails，它们都工作正常！然后我在实际运行“rails s”之前运行“bundle install”来测试我的应用程序。这就是我得到的

```
Unfortunately, a fatal error has occurred. Please report this error to the Bundler issue tracker at https://github.com/carlhuda/bundler/issues so that we can fix it. Please include the full output of the command, your Gemfile and Gemfile.lock. Thanks!
/home/user/.rvm/rubies/ruby-1.9.2-p318/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': no such file to load -- openssl (LoadError) 
```

有什么帮助吗？

这就是 sudo apt-get install openssl 给我的：

```
Reading package lists... Done
Building dependency tree       
Reading state information... Done
openssl is already the newest version.
The following packages were automatically installed and are no longer required:
  libreadline-gplv2-dev git-man libncurses5-dev libnspr4-0d libtinfo-dev git libreadline5 zlib1g-dev liberror-perl libsqlite3-dev
Use 'apt-get autoremove' to remove them.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:22:15.703

您是否在使用 RVM 安装 ruby​​ 版本之前安装了这些软件包？

尝试删除 ruby​​ 版本，运行

```
sudo apt-get install libssl-dev openssl 
```

然后再次安装 ruby​​ 版本

# database - 如何在 SQL Anywhere 中创建动态存储过程？

> ID：10234063
> 
> 赞同：2
> 
> 时间：2012-04-19T18:03:33.597
> 
> 标签：database, procedure

我在 SQL Anywhere 中创建动态 sql 语句时遇到问题。

```
CREATE PROCEDURE pplAnalysis
AS
BEGIN

  DECLARE @Sql NVARCHAR(4000)

  SELECT @Sql = "select * from cds.ppl"

  EXECUTE(@Sql)

END 
```

当我执行这个过程时，我得到一个`Column 'select * from cds.ppl' not found`错误。

你能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T21:32:12.717

尝试首先将查询结果保存在时态表中，然后`SELECT`从时态表中执行：

```
SELECT @Sql = "select into #temp * from cds.ppl"

EXECUTE(@Sql)

SELECT * FROM #temp 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T18:54:13.560

这个问题与语法和`RESULT`子句有关；添加分号、`RESULT`子句并用于`SET`初始化 Sql 变量后，以下是有效的（在 SQL Anywhere 网络服务器版本 12.0.1 中测试）：

```
drop proc pplAnalysis;

CREATE PROCEDURE pplAnalysis()
RESULT (cnot CHAR(5), cnull CHAR(5), vnot VARCHAR(5), vnull VARCHAR(5), explanation VARCHAR(50))
BEGIN

  DECLARE @Sql NVARCHAR(4000);

  SET @Sql = 'select cnot, cnull, vnot, vnull, explanation from dbo.spaces';

  EXECUTE ( @Sql );

END; 
```

`spaces`是`dbo`架构中的一个表，并且这些列与中指定的类型相同`RESULT`

测试了这两种执行过程的方式，都返回了结果：

```
call pplAnalysis();

cnot  cnull vnot  vnull explanation                                        
----- ----- ----- ----- -------------------------------------------------- 
Execution time: 0.027 seconds
Procedure completed 
```

或者

```
exec pplAnalysis;

cnot  cnull vnot  vnull explanation                                        
----- ----- ----- ----- -------------------------------------------------- 
Execution time: 0.018 seconds 
```

更多细节：

[从过程返回结果集](http://dcx.sybase.com/1101/en/dbusage_en11/ptrrmr.html)

[创建过程语句](http://dcx.sybase.com/1200/en/dbreference/create-procedure-user-defined-statement.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T18:16:25.283

使用单引号。

```
SELECT @Sql = 'select * from cds.ppl' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T21:11:56.817

经过一番研究，我编辑了我的答案。

关于`EXECUTE ( string-expression )`语句，是的，您必须对字符串表达式使用单引号而不是双引号。[该](http://dcx.sybase.com/1200/en/dbreference/execute-tsql-statement.html)页面提到：

> 它允许您执行动态准备的语句，例如使用传递给过程的参数构造的语句。语句中的文字字符串必须用单引号括起来，并且语句必须在单行上。

这将消除未找到列的错误，但该过程将返回此其他错误：

```
Result set not permitted in '<batch statement>' 
```

尝试单独执行此语句时返回相同的错误：

```
execute ('select * from sysusers') 
```

有[可能的原因](http://dcx.sybase.com/index.html#1201/en/saerrors/errm946.html)：

> 您试图在不允许结果集的上下文中执行 SELECT 语句。

有关解决方案，请参阅我最近的答案。

关于模式，这里是如何引用对象：

> 通过模式名称和对象名称（以句点 (.) 分隔）来引用数据库对象始终是一种很好的做法。对于一个完整的示例，从当前数据库的 HumanResources 模式中的 Employee 表中选择记录如下所示：

```
SELECT * FROM HumanResources.Employee 
```

> 要引用位于远程数据库中的对象，完全限定的对象名称包括服务器名称和数据库名称。例如，要从 MyServer 上 AdventureWorks 数据库的 HumanResources 架构中的 Employee 表中选择记录，如下所示：

```
SELECT * FROM MyServer.AdventureWorks.HumanResources.Employee 
```

我在 SQL Anywhere 12 中对其进行了测试，它的工作原理相同。即使我不熟悉模式，我在下面建议您实际上是使用模式，dbowner 将是模式名称：

1)`select * from dbname.dbowner.tablename`

2)`select * from dbowner.tablename`

3）`select * from dbname..tablename`（假设表存在于`dbo`模式中）

底线....在您的选择语句`cds.ppl`中必须是在架构中`ppl`创建的名为的表。`cds`

或者，如果`cds`您的数据库名称和`ppl`表名称是在`dbo`架构中创建的，则您缺少一个点：

```
select * from cds..ppl 
```

# javascript - 使用 Javascript 删除表格行

> ID：10234066
> 
> 赞同：0
> 
> 时间：2012-04-19T18:03:42.317
> 
> 标签：javascript, jquery, html-table

目前，我有一个名为剧集的信息表。该表具有由标题、播出日期、剧集编号和情节组成的字段。我使用 javascript 来克隆字段并删除它们。我的问题是删除功能只删除了标题、播出日期和集数；但是情节框仍然存在。据我所知，问题是情节被包装在不同的`<tr></tr>`标签中。如何获得删除功能以删除两组？

这是桌子

```
<table id="template" style="display: none">
<tr class="line">
    <td width="50%">
    <label><?php _e('Episode Title'); ?></label>
    <p>
      <input type="text" name="episode_title[]" id="episode_title[]" value="" class="title regular-text" style="width:100%;" />
    </p>    
    </td>

    <td width"10%">        
    <label><?php _e('Airdate'); ?></label>
    <p>
      <input type="text" name="episode_airdate[]" id="episode_airdate[]" value="" class="airdate regular-text" style="width:100%" />
    </p>
    </td>

     <td width="10%">        
    <label><?php _e('Season:'); ?></label>
    <p>
          <?php

            for($i=1; $i<=50; $i++)
                $season_nums[]=$i;

            echo '<select name="episode_season[]" select id="episode_season[]" class="season regular-text" style="100%">';
                echo '<option value="">' . __("Season" ) . '</option>';
                foreach($season_nums as $season_num){
                    $selected = '';
                    echo '<option value="' . $season_num . '" ' . $selected . '>' . $season_num . '</option>';
                }
            echo '</select>';
            ?>
    </p>
    </td>

    <td width="10%">        
    <label><?php _e('Episode:'); ?></label>
    <p>
      <input type="text" name="episode_number[]" id="episode_number[]" value="" class="number regular-text" style="width: 100%" />
    </p>
    </td>

    <td width="10%" class="commands">
        <a rel="delete" class="button">-</a> <a rel="add" class="button">+</a>
    </td>

</tr>

<tr class="line2"> 
   <td width="100%">       
    <label><?php _e('Plot:'); ?></label>
      <textarea name="episode_plot[]" id="episode_plot[]" class="plot regular-text"value="" cols="100%" rows="10" tabindex="4" ><?php echo $_POST['episode_season'] ?></textarea>
    </td>
</tr> 
```

这是JavaScript

```
 // Delete the "-" button in first row
    $('#attachments tr:first-child .commands a[rel="delete"]').remove();
}

function items_add()
{
    obj = $('#template tr').clone().appendTo('#attachments');
    lines++;

    if (arguments.length > 0) {
        options = arguments[0];

        $('.title', obj).val( options.title );
        $('.airdate',   obj).val( options.airdate );
        $('.season',   obj).val( options.season );
        $('.number',   obj).val( options.number );
        $('.plot',   obj).val( options.plot );
    }
}

$('#attachments').delegate('.commands a', 'click', function()
{
    var action = $(this).attr('rel');
    var confirm_delete = true;

    // Add action
    if ('add' == action) {
        items_add();
    }

    // Delete action
    if ('delete' == action) {
        // La TR en la tabla
        var oTr = $(this).parent().parent();
        var episode_name = $('.title', oTr).val();
        var episode_airdate = $('.airdate', oTr).val();
        var episode_season = $('.season', oTr).val();
        var episode_number  = $('.number', oTr).val();
        var episode_plot  = $('.plot', oTr).val();

        if (episode_name != '' || episode_number != '' || episode_plot != '') {
            if ( !confirm('Are you sure you want to delete ' + episode_name + '?') ) {
                confirm_delete = false;
            }
        }

        if (confirm_delete) {
            oTr.remove();
            lines--;
        }
    }
});

$(document).ready(function()
{
    items_init();
});

})(jQuery); 
```

对你的帮助表示感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:25:25.100

主意：

在php中生成一个随机数，如

```
$rand = time() * rand(); 
```

在行上回显它

```
<tr class="line" data-row="<?php echo $rand; ?>"> 
```

和

```
<tr class="line2" data-row="<?php echo $rand; ?>"> 
```

当有人点击链接时使用你的删除功能

```
var oTr = $(this).closest("tr");
var data-row =$(oTr).attr('data-row');
 $('tr[data-row=' + data-row + ']').remove(); 
```

这个想法是有一个唯一的字符串来识别 tr 与 line 和 line2 类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:18:20.840

更改此行

```
var oTr = $(this).parent().parent(); 
```

至

```
var oTr = $(this).closest("tr"); 
```

然后使用`oTr.remove()`

# windows-phone-7 - WP7 - 确定文化是英制还是公制

> ID：10234068
> 
> 赞同：4
> 
> 时间：2012-04-19T18:03:44.870
> 
> 标签：windows-phone-7, localization, cultureinfo

我正在尝试确定用户是否更喜欢我的应用程序中的公制或英制单位。

有没有办法做到这一点？我一直在尝试使用 CultureInfo 无济于事。

干杯，

卡梅伦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T18:07:01.990

你要[`RegionInfo.IsMetric`](http://msdn.microsoft.com/en-us/library/system.globalization.regioninfo.ismetric.aspx)

# html - 表格行边框在 Firefox 和 Safari 中不起作用

> ID：10234072
> 
> 赞同：9
> 
> 时间：2012-04-19T18:04:00.727
> 
> 标签：html, css, html-table, border, tablerow

我希望表格行在底部和顶部有一个边框。下面的代码在 IE 中有效，但在 Firefox 或 Safari 中无效！请帮忙！

HTML

```
 <tr class='TableRow'> 
```

CSS

```
.TableRow{
   border-bottom: 2px solid rgb(167,167,167);
   border-top: 2px solid rgb(167,167,167);
  } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T18:27:26.003

据我所知，您不能通过 CSS 为表格行设置边框。但我会建议您解决此问题：将边框设置为行内的单元格，然后使用 cellspacing="0"。这是CSS：

```
.TableRow td{
   border-bottom: 2px solid rgb(167,167,167);
   border-top: 2px solid rgb(167,167,167);
} 
```

一个示例 HTML 将是：

```
<table cellspacing="0">
    <tr class="TableRow">
        <td>A</td>
        <td>B</td>
    </tr>
    <tr>
        <td>C</td>
        <td>D</td>
    </tr>
</table> 
```

第一行将是带边框的行。

希望有帮助。

编辑：我试过你的代码并没有在任何浏览器中显示边框，包括 IE。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-12T09:24:37.357

添加`border-collapse:collapse`到表格中，然后您可以为 tr 添加边框。

例子：

```
table.myTable{
  border-collapse:collapse;
}

table.myTable tr{
  border:1px solid red;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T18:34:58.837

这能解决您的问题吗？

```
tr.TableRow td {
  border-bottom: 2px solid rgb(167,167,167);
  border-top: 2px solid rgb(167,167,167);
} 
```

它将为具有 class 的任何行中的所有表数据添加边框`TableRow`。在开始时添加`tr.`是一种很好的做法，因为我假设您只会将此类与表格行一起使用。

如果您将其应用于多行 - 您可能还需要添加`border-collapse:collapse;`将边框折叠成单个边框。

# asp.net - 进入方法时访问冲突异常

> ID：10234073
> 
> 赞同：1
> 
> 时间：2012-04-19T18:04:00.813
> 
> 标签：asp.net, .net, vb.net, access-violation

过去几天我的应用程序的一部分遇到了一些严重的问题。它是一个中型 ASP.NET 应用程序。有一些处理错误的代码（将它们记录到数据库中并向用户显示错误页面）。但是最近这段代码在某些机器上停止了正常工作（不是在所有机器上）。

我知道有一个`AccessViolationException`from `ErrorViewer`：

```
Faulting application name: w3wp.exe, version: 7.5.7601.17514, time stamp: 0x4ce7afa2
Faulting module name: KERNELBASE.dll, version: 6.1.7601.17651, time stamp: 0x4e21213c
Exception code: 0xc0000005
Fault offset: 0x000000000000cacd
Faulting process id: 0x1150
Faulting application start time: 0x01cd1e44675765e2
Faulting application path: c:\windows\system32\inetsrv\w3wp.exe
Faulting module path: C:\Windows\system32\KERNELBASE.dll
Report Id: c43403ad-8a37-11e1-b256-005056891270 
```

每次应用程序尝试显示错误页面时，此错误都会记录到错误查看器中。但由于该错误仅发生在使用`msi`安装程序部署的应用程序上，并且 dll 文件正在被加密，因此我无法调试此应用程序。稍微更改代码我将初始方法重构为简单的单行代码：

```
Public Shared Function HandleException(ByVal exception As System.Exception) As Guid
    Return New GUID
End Function 
```

但是仍然进入这个方法抛出了这个堆栈跟踪的异常（使用 DebugDiag 1.2 获得）

```
at (Exception ) 
at MyApp.Business.Utilities.HandleException(Exception exception) 
at () 
at MyApp.BaseUtilities.ErrorSolution() 
at (ErrorPage_errorpage , Object , EventArgs ) 
at MyApp.ErrorPage_errorpage.Page_Load(Object , EventArgs ) 
at System.EventHandler.Invoke(Object sender, EventArgs e) 
at System.Web.UI.Control.LoadRecursive() 
at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
at System.Web.UI.Page.ProcessRequest() 
at System.Web.UI.Page.ProcessRequest(HttpContext context) 
at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() 
at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
at System.Web.HttpApplication.PipelineStepManager.ResumeSteps(Exception error) 
at System.Web.HttpApplication.BeginProcessRequestNotification(HttpContext context, AsyncCallback cb) 
at System.Web.HttpRuntime.ProcessRequestNotificationPrivate(IIS7WorkerRequest wr, HttpContext context) 
at System.Web.Hosting.PipelineRuntime.ProcessRequestNotificationHelper(IntPtr managedHttpContext, IntPtr nativeRequestContext, IntPtr moduleData, Int32 flags) 
at System.Web.Hosting.PipelineRuntime.ProcessRequestNotification(IntPtr managedHttpContext, IntPtr nativeRequestContext, IntPtr moduleData, Int32 flags) 
at System.Web.Hosting.UnsafeIISMethods.MgdIndicateCompletion(IntPtr pHandler, RequestNotificationStatus& notificationStatus) 
at System.Web.Hosting.PipelineRuntime.ProcessRequestNotificationHelper(IntPtr managedHttpContext, IntPtr nativeRequestContext, IntPtr moduleData, Int32 flags) 
at System.Web.Hosting.PipelineRuntime.ProcessRequestNotification(IntPtr managedHttpContext, IntPtr nativeRequestContext, IntPtr moduleData, Int32 flags) 
```

这对我来说似乎很奇怪。然后我删除了这个方法调用，突然应用程序开始正常工作（但没有按照我的意愿处理错误）。问题是 - 完全相同的代码多年来一直工作，它没有改变一点，只是停止在某些机器上工作。
更奇怪的是：如何调用上面解释的简单方法，它只返回简单的 GUID，可以抛出`AccessViolation`？

有人在他们的应用程序中遇到过类似的问题吗？有人可以向我解释为什么会发生这样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:53:23.893

该错误神秘地出现，并且在一些细微的代码更改后也神秘地消失了（这并没有改变代码的工作方式和方式）。在我向他们展示这个问题的团队或其他开发人员中，没有人不相信他们所看到的。

好像宇宙中还有一点点魔法……

# php - 通过正则表达式用htmlentities替换标签的嵌套标签 - PHP

> ID：10234074
> 
> 赞同：1
> 
> 时间：2012-04-19T18:04:01.077
> 
> 标签：php, regex

这是 xml 代码，我将此文本加载为字符串，我需要将其所有嵌套标签和内容替换为 htmlentities..

```
<?xml version="1.0" encoding="utf-8"?>
<data>
<target><x id="25e02e3e839c-a1e6b03cb682"  pid="NLSheets" name="NLSheets" />Sheets"</target>
<target>"<x id="3510a371bdf8-861b965564ea" pid="NLTable" name="NLTable" />Table"</target>
<target>"<x id="48a1560eaa68-c400c8394f0a"  pid="NLCaption" name="NLCaption" />Caption"</target>
</data> 
```

我为该任务使用了以下 php 代码。

```
function html_entities($matches) {
  return str_replace($matches[1], htmlentities($matches[1]), $matches[0]);
}

function get_tag( $tagname, $xml ) {
 $pattern = "/<$tagname ?.*>(.*?)<\/$tagname>/"; 
 $content = preg_replace_callback($pattern,  html_entities, $xml);
 return $content;
}

$content = get_tag('target', $str);

echo $content; 
```

现在问题出在正则表达式上。我使用了正则表达式

正如您在 get_tag 函数中看到的那样。`$pattern = "/<$tagname ?.*>(.*?)<\/$tagname>/";`这将建立在运行时

```
/<target ?.*>(.*?)<\/target> 
```

现在我无法解决问题...嵌套标签值未转换为 htmlentities。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:19:23.183

将行更改为：

```
$pattern = "/<$tagname ?.*?>(.*?)<\/$tagname>/"; 
```

您需要一个额外的非贪婪修饰符来防止搜索`>`开始标签的结束部分 ( ) 走得太远并抓住您的内部内容（因此不能使其可用于括号分组和 htmlentities）。

我们可以通过在末尾使用 's' 修饰符来稍微改进这一点，以允许内容中包含换行符（因为默认情况下点字符不包含换行符）以及防止`/`在开始标记内出现换行符，并允许任何类型的空格将元素名称与属性分开，并在结束标记的末尾允许空格：

```
$pattern = "/<$tagname(?:\s[^\/]*?)?>(.*?)<\/$tagname\s*>/s"; 
```

并缩短它：

```
$pattern = "@<$tagname(?:\s[^/]*?)?>(.*?)</$tagname\s*>@s"; 
```

为了处理所有这些可能的边缘情况，使用 XML 解析器更安全。例如，这不会捕获：

```
<target><![CDATA[ </target> ]]></target> 
```

# objective-c - UITableViewCell id 中的 UISwitch 未在视觉上禁用

> ID：10234078
> 
> 赞同：0
> 
> 时间：2012-04-19T18:04:15.390
> 
> 标签：objective-c, ios, uitableview, uiswitch

我有一个 UITableView，我所有的单元格都有一个 UISwitch 作为附件视图。

我还有一个包含所有 UISwitches 的数组。

在 viewDidAppear 方法中，我遍历我的 UISwitches 数组并禁用它们。

一切正常。

问题是当我上下移动 UITableView 时，隐藏并再次显示的 UISwitches 不会变暗。它们按预期禁用，但看起来它们已启用。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:14:30.407

问题是您的单元正在被重用，因此单元开关正在被重用。一种解决方案是强制您的单元格不被重复使用，即：

```
 MyCustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

//if (cell == nil) {

    NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"MyCustomCell" owner:nil options:nil];

    for(id currentObject in topLevelObjects){
        if([currentObject isKindOfClass:[UITableViewCell class]]){
            cell = (MyCustomCell *)currentObject;
            break;
        }
    }

//} 
```

请注意 if cell==nil 已被注释掉，因此这些单元格永远不会被重用。显然不适合节省内存等，但如果您没有大型或奇怪的表格视图，您可能甚至不会注意到。

您可以尝试的另一件事是保留一个布尔值数组，以确定是否应检查开关，并在`cellForRowAtIndexPath`方法中使用该数组。

# java - org.postgresql.*；找不到类错误

> ID：10234083
> 
> 赞同：0
> 
> 时间：2012-04-19T18:04:46.693
> 
> 标签：java, eclipse, postgresql, copy

我在 Eclipse 中使用 Java。我下载了 postgresql-9.1-901.jdbc4.jar 并添加了它。（属性-> Java 构建路径-> 库-> 添加外部 JAR...

我的数据库连接工作得很好，我可以创建表、执行查询等。现在我想使用 CopyManager。因此添加到我的代码中：

```
import org.postgresql.copy.CopyManager;
...
CopyManager cManager = new CopyManager(XXX); 
```

不幸的是，我收到一条错误消息：“源附件不包含文件 CopyManager.class 的源”

```
Exception in thread "main" java.lang.NullPointerException
at org.postgresql.copy.CopyManager.<init>(CopyManager.java:46)
at Table.insert_data_in_tb(Table.java:73)
at DB.main(DB.java:69) 
```

我会非常感谢任何帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:27:26.780

这是您在调试模式下运行代码和单击方法时收到的消息。要纠正当前的问题（能够查看源代码），请执行以下操作：

*   下载[PostgreSQL 9.1 源代码](http://jdbc.postgresql.org/download/postgresql-jdbc-9.1-901.src.tar.gz)
*   将文件复制到某个适当的文件夹并解压缩

    `tar xvf postgresql-jdbc-9.1-901.src.tar.gz`

*   将源文件夹添加到 Eclipse 中的调试配置（运行->调试配置->选择 Java 应用程序->单击源选项卡->添加->文件系统目录->添加），其中目录也是您展开 tarball 的位置。

然而，你真的不需要查看源代码来确定你的程序出了什么问题。[在线 Javadocs](http://jdbc.postgresql.org/documentation/publicapi/org/postgresql/copy/CopyManager.html)`CopyManager`中提供了 的文档。对象的构造函数需要一个有效的连接，我猜在你的程序中它是空的。

# sql - 在 PL/SQL 中检查空值的正确方法是什么？

> ID：10234087
> 
> 赞同：3
> 
> 时间：2012-04-19T18:05:03.030
> 
> 标签：sql, oracle, plsql

```
IF purpose = null THEN
   v_purpose := '';
ELSE
   v_purpose := ' for ' || purpose;
END IF; 
```

当目的为空时，它仍然会转到其他...为什么？！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T18:06:43.877

正确的测试是

```
IF purpose IS NULL THEN 
```

这是因为`NULL`不是存储在字段中的*值。*它是 关于存储在其他地方（但在行内）的字段的*属性。*

将一个字段设置为`NULL`似乎是一个普通的赋值，因此期望通过直接比较对其进行测试似乎是完全正交的。然而，为了让它正常工作，我推测 SQL 赋值原语有一个神奇的隐藏方面，它将特殊符号的赋值转移`NULL`到设置属性而不是字段。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-19T18:08:26.637

NULL 是 SQL 中的一个特殊值，不能使用相等运算符进行比较。您需要使用特殊运算符`IS`并`IS NOT`在测试值是否为 NULL 时。

这是[对这个想法的一个很好的概述](http://psoug.org/reference/null.html)。摘录：

> 注意：Oracle 中的 Null 是缺少信息。可以分配一个空值，但它不能等同于任何东西，包括它自己。NULL 值表示丢失或未知的数据。NULL 值不是整数、字符或任何其他特定数据类型。请注意，NULL 与空数据字符串或数值“0”不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T18:24:05.243

`purpose = null`无论是什么，表达式的结果都是未知`purpose`的（有关更多详细信息，请参阅@Paul Sasik 的答案）。既然是未知的，也不一定是真的，所以执行绕过了块的内部，`IF`落入了`ELSE`块中。

# tomcat - 如何告诉用户，该应用程序已从服务器中删除？

> ID：10234090
> 
> 赞同：0
> 
> 时间：2012-04-19T18:05:07.700
> 
> 标签：tomcat

您好，我已从我的 tomcat 服务器中删除了一个应用程序。现在我需要告诉用户，该应用程序已从路径中删除。使用新 URL（它将在新服务器中）。

如果任何用户点击了新 URL，他需要收到一条消息通知他应用程序已被删除。

如何处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:11:03.927

您可以放置​​一个重定向页面来将用户重定向到新的 URL，而不是删除旧的应用程序。

# jquery - 带有 jquery 和 SQLite 的 CSS 按钮 OnClick 事件

> ID：10234093
> 
> 赞同：-1
> 
> 时间：2012-04-19T18:05:14.923
> 
> 标签：jquery, css, html, sqlite

我正在使用 css 开发一个按钮，我使用 SQLite 和 jquery 来构建 OnClick 事件，但查询不起作用。单击 id="gameLogin" 的按钮后，我想在表联系人。运行数据库并创建表后，

有什么想法吗？还有其他解决方案吗？

非常感谢

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"                                 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
        <html xmlns="http://www.w3.org/1999/xhtml">
            <head>
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                <title>SQL Storage</title>
                <script src="http://code.jquery.com/jquery-latest.js"></script>
                <link rel="stylesheet" href="css/main.css" />
            </head>

            <body>    
                <br/><br/>
                <div align="center">
                    <section id="gameIntro">
                        First name:<input type="text" id="firstName"/><br/>
                        <p><a id="gameLogin"   class="button3 blue medium"  href="game.html">Login</a> 
                        </p>
                    </section>
                </div>
            </body>

            <script> 
                var results = document.getElementById('results'); 
                //var id = document.getElementById('id');
                var firstName = document.getElementById('firstName');  
                var createStatement = "CREATE TABLE IF NOT EXISTS Contacts (firstName TEXT PRIMARY KEY )";
                var selectAllStatement = "SELECT * FROM Contacts";
                var insertStatement = "INSERT INTO Contacts (firstName) VALUES (?)";
                var updateStatement = "UPDATE Contacts SET firstName = ?, WHERE firstName = ?";
                var deleteStatement = "DELETE FROM Contacts WHERE firstName=?";
                var dropStatement = "DROP TABLE Contacts";
                var findStatement = "SELECT * FROM Contacts WHERE firstName=?";
                var db = openDatabase("AddressBook", "1.0", "Address Book", 200000);
                var dataset;
                createTable();

                $("#gameLogin").click( function(){
                    db.transaction( function(tx) {tx.executeSql(insertStatement,[firstName.value],onErrorLogIn,goplay); });
                });

              ..........     ......... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:34:52.767

此外，使用 jQuery 库，`document.getElementById`完全不需要类似的东西。从您的代码的外观很明显，您有一个想要实现的“伟大想法”，但您确实需要阅读一些有关如何使用 jQuery 以及如何使用 MVC 进行正确 SQL 调用的文档。

我正在经历制作建议阅读清单的麻烦，我**强烈**建议您检查所有这些链接。

*   [W3 Schools JS](http://www.w3schools.com/js/default.asp)（不是最好的指南，但如果你不能通过他们对 JS 的测试，那么你还没有为图书馆做好准备）

*   [jQuery 文档](http://docs.jquery.com/Main_Page)

*   [jQueryUI 文档](http://jqueryui.com/demos/)

*   [免费 PHP 教程](http://www.homeandlearn.co.uk/php/php.html)（这是最好的 SQL 调用语言，因为它保留了调用“服务器”端，有助于防止黑客攻击）

*   [Codeigniter](http://codeigniter.com/)（一个伟大的开源 PHP 库）

*   [使用 Codeigniter 的 MVC 初学者指南](http://www.phpandstuff.com/articles/codeigniter-doctrine-scratch-day-4-user-login)（基本上如何登录）

*   [***SQL Injection Wiki***](http://en.wikipedia.org/wiki/SQL_injection) *also* [See This](https://www.owasp.org/index.php/SQL_Injection)(会告诉你为什么你正在做的事情如此糟糕，或者至少应该给你一个线索)

    最后，如果你正在使用 js 制作在线游戏，我建议使用以下 jQuery 插件

*   [游戏查询](http://gamequeryjs.com/)

如果您仍然坚持在 javascript 中使用 SQL，[请阅读此](http://www.ipa.go.jp/security/vuln/documents/website_security_sql_en.pdf)

# entity-framework - 任何使用 EF 数据库优先方法来解释主题的 Fluent API 教程？

> ID：10234094
> 
> 赞同：6
> 
> 时间：2012-04-19T18:05:21.657
> 
> 标签：entity-framework, fluent, ef-database-first

关于 Fluent API 的教程有很多，但它们都使用 Entity Framework Code-First 代码示例对其进行了解释。由于我不知道 Code-First，您是否知道任何 Fluent API 教程可以使用 EF Database-First 方法解释该主题？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T21:39:53.663

没有教程可以解释 Fluent API 和 Database-First 方法，因为 Fluent API 仅适用于 Code-First 方法。如果您想通过 Database-First 创建模型，则不需要 Fluent API。

Fluent API（连同 Code-First 数据注释和约定）是一种在代码中定义模型细节的工具，例如字符串长度、是否需要属性或关系类型 - 多对多、一对多等。当使用 Database-First 或 Model-First 时，EDMX 文件具有相同的目的 - 它包含模型的所有详细信息和映射定义。Fluent API（+ 数据注释和约定）仅在使用 Code-First 时替换 EDMX 文件。

如果您通过 Database-First 或 Model-First 创建模型，您将拥有一个代表您的模型的 EDMX 文件。您可以将 T4​​ DbContext 生成器应用于此 EDMX 文件。生成的文件有两个不同于 Code-First 的特征：

*   生成的连接字符串包含一个引用 EDMX 元数据的部分，该元数据将嵌入到您的程序集中：

    ```
    connectionString="metadata=res://*/Model.csdl
                              |res://*/Model.ssdl
                              |res://*/Model.msl;
                      ..." 
    ```

*   生成的上下文`DbContext`将有一个重写的`OnModelCreating`方法，它只是抛出一个异常：

    ```
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        throw new UnintentionalCodeFirstException();
    } 
    ```

只要您将元数据部分留在连接字符串中，EF 甚至不会`OnModelCreating`在此方法中调用 Fluent API 中的任何代码或任何代码。元数据部分告诉 EF 您的模型是 DB 优先或模型优先，并且元数据是在嵌入式 EDMX 中定义的，而不是在 Fluent API 中定义的。

但是，您可以从连接字符串中删除元数据部分，删除`UnintentionalCodeFirstException`并使用 Fluent API in 编写代码`OnModelCreating`。您可以按照此过程通过 Database-First 创建初始模型，然后在此初始模型上构建以使用 Code-First 进行进一步开发。

此时，您不再使用 Database-First，而是 Code-First，并且您阅读的有关 Fluent API 的所有内容都对您有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T17:31:57.613

有一篇有趣的文章是关于在不使用实际的“数据库优先”方法本身的情况下完成一些“数据库优先”的目标。

[http://agilenet.wordpress.com/2011/04/11/entity-framework-4-1-rc-with-an-existing-database/](http://agilenet.wordpress.com/2011/04/11/entity-framework-4-1-rc-with-an-existing-database/)

作者使用“Code-First”和“Fluent API”，但禁用了数据库和表的自动生成和播种。

他分享了一个示例，展示了“如何创建实体模型，然后手动创建数据库，然后将这些实体映射到您的数据库。最后它展示了使用 DatabaseContext 来保存和检索实体”。

他为“在实体和数据库之间映射的每个实体创建配置类”的部分非常酷。该步骤取代了在采用正式的“数据库优先”方法时生成的“edmx”文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T21:39:30.887

本教程包含 6 部分 Database First 教程系列，包括一些流畅的 API 示例：

[http://www.asp.net/web-forms/tutorials/continuing-with-ef/using-the-entity-framework-and-the-objectdatasource-control-part-3-sorting-and-filtering](http://www.asp.net/web-forms/tutorials/continuing-with-ef/using-the-entity-framework-and-the-objectdatasource-control-part-3-sorting-and-filtering)

# html - HTML5 音频 Safari 问题

> ID：10234102
> 
> 赞同：2
> 
> 时间：2012-04-19T18:05:48.077
> 
> 标签：html, safari, html5-audio

我正在尝试编写自己的 HTML5 音频播放器：您可以在[这里查看](http://www.guygar.com/inception/ultra/indexCopy.html)。

它在 IE9、FF、Chrome 中运行良好，但由于某种原因在 Safari 中运行良好，即使我已经听过

```
audio.addEventListener("loadedmetadata", tryThis, false); 
```

它在播放前显示 NaN*持续时间数据。*

```
audio.setAttribute("src", a[trackNo][1]);
audio.load();
audio.addEventListener("loadedmetadata", tryThis, false); 
```

* * *

```
function tryThis()
{
    this.addEventListener("timeupdate", function() { document.getElementById(radioPointer.toString()).innerHTML = formatTime(this.duration, this.currentTime);}, false);

    this.addEventListener("ended", function () { document.getElementById(radioPointer.toString()).innerHTML = formatTime(this.duration, 0); document.rootsPlaylist.roots[radioPointer].checked = false; }, false);

    this.play();    
} 
```

* * *

```
<audio id="rootsPlayer" style="display:none;"></audio> 
```

你能提供任何帮助吗？

非常感谢。

注意：您必须经常在歌曲之间切换才能明白我的意思，抱歉我忘了提及这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-04T01:32:55.320

这样做的原因是`duration`属性仅在`durationchange`事件发出后才被初始化。因此，您可以使用`isNan()`函数或一些虚拟`durationInitialized`变量：

```
var durationInitialized = 0;
audio.setAttribute("src", a[trackNo][1]);
audio.load();
audio.addEventListener("loadedmetadata", tryThis, false);
audio.addEventListener("durationchange", function() {durationInitialized = 1;}, false);
function tryThis() {
 this.addEventListener("timeupdate", function() {
  var time = '';
  if (durationInitialized) time = formatTime(this.duration, this.currentTime);
  else time = formatTime(this.currentTime);
  document.getElementById(radioPointer.toString()).innerHTML = time;
 }, false);

 this.addEventListener("ended", function () {
  var time = '';
  if (durationInitialized) time = formatTime(this.duration, 0);
  else time = formatTime(0);
  document.getElementById(radioPointer.toString()).innerHTML = time;  
  document.rootsPlaylist.roots[radioPointer].checked = false; 
 }, false);

 this.play();    
} 
```

# java - Grails 编译错误：无法解析类 JSON

> ID：10234105
> 
> 赞同：3
> 
> 时间：2012-04-19T18:05:56.267
> 
> 标签：java, eclipse, json, grails

我有以下设置，grails 2.0.3，STS，我在我的一个控制器中这样做：

```
render(['car': contactL] as JSON) 
```

当我运行应用程序时，我收到以下错误：

我已经阅读了有关该错误的信息，但没有一个解决方案对我有用，我尝试使用 Grails Tools -> Refresh dependencies 进行清理、升级，但它给了我：

```
grails> | Error Error running script null: Cannot invoke method trim() on null object (Use --stacktrace to see the full trace) 
```

我的项目中也出现了这个错误：

```
The project was not built since its build path is incomplete. Cannot find the class file for groovy.lang.GroovyObject. Fix the build path then try building this project    Ristretto       Unknown Java Problem 
```

你诊断什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-19T18:53:43.073

要修复“无法解析 JSON 类”错误，您只需要导入它：

```
import grails.converters.JSON
...
class MyController {
    ...
    render [car: contactL] as JSON 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T06:59:42.457

我终于设法让它工作，我切换了工作区，并添加了我的项目 - 问题解决了。

# entity-framework - 任何使用 EF 数据库优先方法来解释主题的数据注释教程？

> ID：10234109
> 
> 赞同：1
> 
> 时间：2012-04-19T18:06:21.827
> 
> 标签：entity-framework, data-annotations, ef-database-first

我发现的所有关于数据注释属性的教程都使用 Asp.Net 或 EF Code-First 示例解释了该主题。我不知道这两者中的任何一个，所以您知道任何可以使用 EF Database-First 方法解释该主题的教程吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T21:26:32.517

这是一个适用于 EF Database First 的 ASP.NET Web 表单：

[http://www.asp.net/web-forms/tutorials/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-8](http://www.asp.net/web-forms/tutorials/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-8)

这是 8 部分教程系列的最后一部分。

# oauth - 如何使用 Apps 脚本获取当前登录用户的 Google 文档列表？

> ID：10234110
> 
> 赞同：0
> 
> 时间：2012-04-19T18:06:22.130
> 
> 标签：oauth, google-docs, google-apps-script

我正在使用 Google 站点上的 Apps 脚本，并尝试使用 Oauth 将小工具验证为活动用户，以显示活动用户文档列表。我发现几个谷歌小组讨论询问这个问题没有答案，希望我能在这里得到答案。这是我的代码：

var oauthConfig = UrlFetchApp.addOAuthService("gDocs"); oauthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken"); oauthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken?scope=https://docs.google.com/feeds/"); oauthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken"); oauthConfig.setConsumerKey("myDomainName"); oauthConfig.setConsumerSecret("myCosumerSeceret");

var options = { "method": "GET", "headers": { "GData-Version": "3.0" }, "oAuthServiceName" : "gDocs", "oAuthUseToken" : "always" };

var results = UrlFetchApp.fetch("https://docs.google.com/feeds/default", options);

此时代码不会运行，并且带有小工具的页面会显示： 需要授权才能执行该操作。

任何帮助将不胜感激。

谢谢你，詹姆斯克里姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:05:54.930

为了使用 3-legged OAuth 执行授权，您必须使用“匿名”作为 ConsumerKey 和 ConsumerSecret：

```
 oauthConfig.setConsumerKey("anonymous");
 oauthConfig.setConsumerSecret("anonymous"); 
```

另外，请注意正确的提要 url 是`https://docs.google.com/feeds/default/private/full`.

但是，如果您的目标是获取活动用户的文档列表，为什么不直接使用 Apps Script 提供的 DocsList 服务呢？他们还将负责为您解析结果。

[https://developers.google.com/apps-script/service_docslist](https://developers.google.com/apps-script/service_docslist)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T02:59:40.130

无法访问`active user`数据。与网站一样，已发布的 Apps 脚本在脚本所有者的帐户下运行，称为`effective user`. 而且，出于安全考虑，脚本所有者无权访问`active user`.

因此，@claudio 建议（使用内置 DocsList）是不可能的。

**除非**我们谈论的是 Google Apps 域（而不是普通消费者帐户）并且脚本所有者是域管理员。在这种情况下，他可以使用 Google Docs List Data API 来模拟其域中的任何用户。

无论哪种方式，无论这种情况，消费者密钥和秘密都应该始终是“匿名的”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:09:49.297

我有一个 Google Script OAuth 库[https://sites.google.com/site/scriptsexamples/custom-methods/google-oauth](https://sites.google.com/site/scriptsexamples/custom-methods/google-oauth)这将使 OAuth 部分不那么痛苦。

以及当前正在开发的 DriveSrevice 库的一些源代码，这些源代码将触及 Google Script 中缺少的点。 [https://sites.google.com/site/scriptsexamples/custom-methods/driveservice](https://sites.google.com/site/scriptsexamples/custom-methods/driveservice)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:42:21.937

此特定错误可能与 OAuth 无关，但与将 DocsList 添加到应用程序有关。

请参阅：[https ://developers.google.com/apps-script/troubleshooting#common_errors](https://developers.google.com/apps-script/troubleshooting#common_errors)

> **执行该操作需要授权。**
> 
> 此错误表明脚本缺少运行所需的授权。在脚本编辑器中或从自定义菜单项运行脚本时，会向用户显示授权对话框。但是，当脚本作为服务运行、嵌入 Google 协作平台页面或从触发器运行时，无法显示对话框并显示此错误。**要授权脚本，请打开脚本编辑器并运行任何函数。为避免此错误，请记住在向脚本添加新服务或功能后在脚本编辑器中运行该脚本一次。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-21T15:49:52.903

这里的答案是不正确的。你可以做你需要的，但不能直接使用 Oauth。相反，发布带有“以当前用户身份运行”选项而不是脚本所有者的 Apps 脚本。然后使用 DriveApp 的 DocsList 来获取用户文件。这里的关键是将服务发布为“以访问应用程序的用户身份运行”。

# sql - 如何删除nzsql生成的输出文件中的最后一行

> ID：10234112
> 
> 赞同：1
> 
> 时间：2012-04-19T18:06:26.613
> 
> 标签：sql, unix

我正在尝试删除 nzsql 生成的文件中的最后一行。请查找以下查询。

```
nzsql -A  -c "SELECT * FROM AM_MAS_DIVISION_DIM" > abc.out 
```

当我执行此查询时，将生成输出并将其存储在 abc.out 中。这将包括标题列以及底部的一些时间信息。但我不需要底部元数据并且只想保留我的标题列. 我怎样才能只使用 nzsql 来做到这一点。请帮助我。在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-02T07:03:38.163

在 nzsql 命令中使用 -r 标志来避免获取该行[假设所涉及的元数据是行计数摘要行，例如：（3 行）]

-r 禁止显示在 SQL 输出末尾的行数。

参考：[http ://pic.dhe.ibm.com/infocenter/ntz/v7r0m3/index.jsp?topic=%2Fcom.ibm.nz.adm.doc%2Fr_sysadm_nzsql_command.html](http://pic.dhe.ibm.com/infocenter/ntz/v7r0m3/index.jsp?topic=%2Fcom.ibm.nz.adm.doc%2Fr_sysadm_nzsql_command.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:29:55.267

为什么不直接将输出通过管道传输到 unix 命令以将其删除？我认为这样的事情会起作用：

```
nzsql -A  -c "SELECT * FROM AM_MAS_DIVISION_DIM" | sed '$d' > abc.out 
```

似乎是摆脱最后一行的推荐解决方案（尽管 ed、gawk 和其他工具可以处理它）。

# java - Java TimeZone.setDefault

> ID：10234114
> 
> 赞同：1
> 
> 时间：2012-04-19T18:06:30.600
> 
> 标签：java, timezone

`TimeZone.setDefault`时区似乎不支持夏令时。如果我保留默认值（不使用函数`setDefault`），应用程序会在 EST/EDT 中显示日期。但是，如果我想更改时区（我使用 组合框 `TimeZone.getAvailableIDs()`），我只能选择 EST（并且忽略夏令时）。

查看文档有各种各样的方法来确定时区的夏令时，但它看起来不像可以设置。有什么想法可以强制时区使用夏令时吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:13:35.463

您可以通过参考夏令时活动的时间来使用夏令时。

即使不是夏令时，告诉它您想要夏令时的唯一方法是创建自己的 TimeZone，但这听起来不是一个好主意。或者您可以使用具有所需时间偏移的时区。

# html - 当我使用表格时出现某种边框

> ID：10234116
> 
> 赞同：0
> 
> 时间：2012-04-19T18:06:32.693
> 
> 标签：html, css

我正在尝试设计一个网页，并且我设置了一个 3 列 1 行的表格（页面底部）。如下图所示。![数字](../Images/d79e0390987b795c60f023060f02fa94.png)

正如您在该图中看到的那样，一些边框出现在 td 标签的开头（由黑色圆圈标记）。我已将边框设为 0，但仍然没有效果。为什么会发生，我应该如何解决？

我提供了下面的代码..

HTML

```
<div class="wrapper col3">

      <div id="intro">

            <div class="fl_left">

                  <div class="UpperSlideShow">

                  </div>
                  <div class="LowerFlyUps">
                        <table class="HoverTable" cellpadding="0" cellspacing="0" border="0" style="margin-left:2px;">
                        <tr>
                        <td>

                              <div class="box" id="box">
                                    <div class="inner">
                                          <h4>Header One</h4>        
                                          <p>Content One, Team Pwn helped us identify the root cause of our problems and delivered effective solutions to tackle them.</p>
                                    </div>
                              </div>
                        </td>
                        <td>
                              <div class="box" id="box1">
                                    <div class="inner">
                                          <h4>Header Two</h4>        
                                          <p>Content One, Team Pwn helped us identify the root cause of our problems and delivered effective solutions to tackle them.</p>
                                    </div>
                              </div>
                        </td>
                        <td>
                              <div class="box" id="box2">
                                    <div class="inner">
                                          <h4>Header Three</h4>        
                                          <p>Content One, Team Pwn helped us identify the root cause of our problems and delivered effective solutions to tackle them.</p>
                                    </div>
                              </div>
                        </td>
                        </tr>
                        </table>

                  </div>

            </div>

            <div class="fl_right"><img src="images/demo/380x300.gif" alt="" /></div>
            <br class="clear" />
      </div>
</div> 
```

CSS

```
table.HoverTable
{
    border: 0px;
}

table.HoverTable tr
{
    border: 0px;
}

table.HoverTable tr rd
{
    border: 0px;
}
.box {
    position: absolute;
    bottom: 0;
    width: 175px;
    height: 40px;
    overflow: hidden;
    color: #FFFFFF;
    font: 12px Tahoma,sans-serif;
    background-color: #284062;
    margin-right: 10px;
    float: left;
    text-align:center;
}

.inner {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
}
.box h4 {
    padding-bottom: 10px;
    border-bottom: 1px solid #fff;
    font: 18px Tahoma,sans-serif;
    text-transform: capitalize;
    margin: 10px;
}
.box p {
    margin: 0 10px;            
}
#intro
{
    padding:30px 0 5px 0;
    font-size:16px;
    font-family:Georgia, "Times New Roman", Times, serif;
}

#intro .fl_left
{
    display:block;
    float:left;
    width:575px;
    height:300px;
    margin:0;
    color:#FFFFFF;
    background-color:#2684B7;
}

#intro .fl_left h3
{
    font-size: 24px;
    padding:0;
    border:none;
    color:#FFFFFF;
    text-align:center;
    line-height:2em;
}

#intro .fl_left p
{
    margin:0;
    padding:0;
    line-height:1.6em;
}

#intro .fl_left p.readmore
{
    display:block;
    width:100%;
    margin:20px 0 0 0;
    padding:0;
    text-align:right;
    line-height:normal;
}

#intro .fl_left p.readmore a
{
    padding:8px 15px;
    font-size:18px;
    color:#FFFFFF;
    background-color:#1C5E82;
}

#intro .fl_right{float:right;} 
```

Javascript

```
$(document).ready(function() {

    $(".box").hover(function ()
    {
        $(this).animate({height: 200});
    }, function () 
    {
        $(this).animate({height: 40});
    }
    );

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:47:21.003

这是造成它，左右边界。[http://jsfiddle.net/SdDeH/4/](http://jsfiddle.net/SdDeH/4/)

```
 table tbody td {
vertical-align: top;
border-collapse: collapse;
border-left: 1px solid #CCC;
border-right: 1px solid #CCC;
} 
```

改成

```
table tbody td {
    vertical-align: top;
    border-collapse: collapse;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:30:07.240

我无法复制您的问题。但是你可以尝试添加border-collapse:collapse; 到桌子上。

```
table.HoverTable
{
  border: 0px;
  border-collapse:collapse;
} 
```

# c# - 防止继承？

> ID：10234119
> 
> 赞同：1
> 
> 时间：2012-04-19T18:06:43.393
> 
> 标签：c#, c#-4.0, c#-3.0

**如何在不使用密封**关键字的情况下防止类被继承？

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-19T18:07:59.943

在你的类的构造函数中：

```
public MyUnsealedClass()
{
  if (this.GetType() != typeof(MyUnsealedClass))
      throw new Exception("Don't do that");
} 
```

为什么不使用`sealed`关键字呢？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-19T18:09:34.393

另一种方法是您可以创建一个返回您类型的对象的静态方法，然后将构造函数设为私有。这样做的好处是它将创建编译时错误而不是运行时错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-19T18:10:09.837

您可以使用私有构造函数

```
class Base
{
  private Base() {}
}

class Derived : Base
{
  // derp
} 
```

然后提供一个实用程序来创建 Base 对象（例如 Base 上可以访问私有 ctor 的静态方法

```
class Base
{
  private Base() {}

  public static Base CreateBase() { return new Base(); }
} 
```

此外，如果您希望能够从此类派生，但您不希望其他人这样做，您可以将您的类设为内部（甚至是 ctor 内部）

```
class Base
{
  internal Base() { }
}

class Derived : Base
{
}

// in another assembly

class MyOwnDerived : Base
{
  // derp
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-12T19:09:41.197

您可以通过使用私有构造函数来实现这一点，类似于：

```
public class NonInheritableClass
{
    static NonInheritableClass GetObject()
    {
        return new NonInheritableClass();
    }

    private NonInheritableClass()
    { 
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T18:10:16.073

在构造函数中抛出异常将起作用。

我同意 - 为什么不使用密封？就是因为这个原因。

除非您正在尝试做其他事情，如果是这种情况，可能还有更好的解决方案。

# asp.net-mvc - 我可以在运行 MVC3 应用程序的地方为 .NET 4 部署和 MVC4 吗？

> ID：10234130
> 
> 赞同：2
> 
> 时间：2012-04-19T18:07:31.647
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我在共享托管服务器上有一个 MVC3 应用程序，想通过创建一个新的 MVC4 项目并复制我的内容来升级这个项目。当我发布 MVC4 应用程序的文件系统时，是否会发布所需的依赖项，或者服务器上是否有 GAC 等要求？我将使用已在托管服务器上正常使用的 .NET 4。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T21:05:27.470

我能够毫无问题地将 MVC4 Beta bin 部署到仅安装 MVC3 的服务器。我按照[Phil Haack 的指南](http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx)执行此操作（它是为 MVC3 编写的，但步骤相同）。

您所要做的就是右键单击项目并选择“Add Deployable Assemblies”。这也使我们的单元测试程序集运行良好，因此无需在我们的持续集成服务器上安装测试版。

[http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx](http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx)

# spring - Hibernate 条件查询 - 查询条件

> ID：10234133
> 
> 赞同：0
> 
> 时间：2012-04-19T18:07:44.530
> 
> 标签：spring, hibernate, jquery-plugins, spring-mvc, jqgrid

我正在使用 spring 3.0，并且正在使用 JqGrid 插件。我正在研究发送带有所有搜索条件的 json 字符串的搜索功能。这是字符串的外观。

```
{"groupOp":"AND","rules":[{"field":"firstName","op":"bw","data":"John"},{"field":"lastName","op":"cn","data":"Doe"},{"field":"gender","op":"eq","data":"Male"}]} 
```

如果您查看**规则数组中的****“op”**属性，您将看到必须执行的操作。Jq-grid有以下操作

 **['eq','ne','lt','le','gt','ge','bw','bn','in','ni','ew','en',' cn','nc']

对应于

['等于','不等于','小于','小于等于','大于','大于等于','开头','不开头','在','不是in','以'结尾','不以','包含','不包含']

我计划使用休眠条件搜索来启用搜索功能。为此，我使用 Jackson 的**ObjectMapper**将传入的 JSON 转换为 Java。这一切都很好。这是我转换json的代码。

```
public class JsonJqgridSearchModel {

    public String groupOp;

    public ArrayList<JqgridSearchCriteria> rules;
}

public class JqgridSearchCriteria {

    public String field;

    public String op;

    public String data;

public SimpleExpression getRestriction(){
    if(op.equals("cn")){
        return Restrictions.like(field, data);
    }else if(op.equals("eq")){
        return Restrictions.eq(field, data);
    }else if(op.equals("ne")){
        return Restrictions.ne(field, data);
    }else if(op.equals("lt")){
        return Restrictions.lt(field, data);
    }else if(op.equals("le")){
        return Restrictions.le(field, data);
    }else if(op.equals("gt")){
        return Restrictions.gt(field, data);
    }else if(op.equals("ge")){
        return Restrictions.ge(field, data);
    }else{
        return null;
    }       
}

}

@RequestMapping(value = "studentjsondata", method = RequestMethod.GET)
    public @ResponseBody String studentjsondata(@RequestParam("_search") Boolean search ,HttpServletRequest httpServletRequest) {
        StringBuilder sb = new StringBuilder();
        Format formatter = new SimpleDateFormat("MMMM dd, yyyy");
        if(search){
            ObjectMapper mapper = new ObjectMapper();
            try {
                    JsonJqgridSearchModel searchModel= mapper.readValue(httpServletRequest.getParameter("filters"), JsonJqgridSearchModel.class);
                    SessionFactory sessionFactory = new Configuration().configure().buildSessionFactory();
                    Session session = sessionFactory.openSession();
                    session.beginTransaction();
                    Criteria criteria = session.createCriteria(Person.class);                   
                Iterator<JqgridSearchCriteria> iterator = searchModel.rules.iterator();
                while(iterator.hasNext()){  
                    System.out.println("before");
                    criteria.add(iterator.next().getRestriction());
                    System.out.println("after");
                }                   
                } catch (JsonParseException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }

        }else{//do other stuff here} 
```

这就是问题所在。如何将 jqGrid 操作转换为等效的休眠命令？例如 **“cn”**应该对应于

`criteria.add(Restrictions.like("firstName", myJsonJqgridSearchModel.data));`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T13:39:32.720

有趣的是，我刚刚编写了与您上面的代码几乎相同的代码（但是我的不使用 JqGrid）。我想知道您的问题是否与“cn”-LIKE 条件特别相关？我遇到了这个问题 - 我必须指定 MatchMode 才能获得我想要的“包含”：

```
return Restrictions.ilike(
    searchCriterion.getPropertyName(),
    searchCriterion.getValue().toString(),
    MatchMode.ANYWHERE); 
```

我发现在没有指定 MatchMode 的情况下，它生成的 SQL 为：

```
WHERE property LIKE 'value' 
```

通过指定 MatchMode.ANYWHERE，它生成的 SQL 如下：

```
WHERE property LIKE '%value%' 
```

这是我所期待的“包含”操作。也许这也是你的问题？**

# java - JSP pageContext 空指针

> ID：10234140
> 
> 赞同：1
> 
> 时间：2012-04-19T18:08:08.303
> 
> 标签：java, jsp, inheritance, nullpointerexception, taglib

我正在尝试为我的 JSP TagLib 类构建一个通用类

```
class MyTag extends CustomTag
{
   public int doEndTag()
   {
      JspWriter out = pageContext.getOut(); <-- this one works fine
   }
}
class CustomTag extends BodyTagSupport
{
   public CustomTag()
   {
      JspWriter out = pageContext.getOut(); <-- this one throws me a Nullpointer
   }
} 
```

我究竟做错了什么？

我可以在父级中创建一个额外的方法，并从 doEndTag() 中的子级调用它，但使用构造函数会更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:30:24.393

在第一堂课`doEndTag()`被调用的时候，`pageContext`已经设置好了。在您的第二堂课中，`pageContext`尚未设置，因此是`null`。这就是导致您的空指针异常的原因。
有关更多详细信息，请参见[此处](http://docs.oracle.com/javaee/1.4/api/javax/servlet/jsp/tagext/Tag.html#setPageContext%28javax.servlet.jsp.PageContext%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:25:31.583

更改为以下代码并尝试更多：

```
class CustomTag extends BodyTagSupport {    
      public CustomTag()    {
           JspWriter out = super.pageContext.getOut(); 
      } 
} 
```

# c# - 如何查找和填充第三方来源的 Flash 字段

> ID：10234141
> 
> 赞同：0
> 
> 时间：2012-04-19T18:08:21.677
> 
> 标签：c#, c++, flash, automation, screen-scraping

简而言之，我正在寻找是否可以使用某种反射将值注入到正在运行的 Flash 应用程序中 - 不是通过通信链接，而是直接注入应用程序。

基本上，我被要求找出是否可以用我们程序中的值填充第三方 Flash 对象。

我玩过 Sothink SWF 反编译器，但没有发现任何可以立即满足我们需求的东西……但也许我错过了一些东西。

请注意，我用 C# 和 C++ 标记了它，因为我们有用 C++ 编写的低级库，但我们的主要应用程序是 C#。因此，如果确实可能的话，我们可以使用这两种语言中的任何一种来做到这一点。

**更新**

这是一个自然语言应用程序。因此，用户将想要交谈并查看填充的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:20:33.687

如果没有需要为每个闪存开发团队定制的公开 API，这似乎是不可能的。[这是一个很好的参考，说明了如何做到这一点](http://www.codeproject.com/Articles/269829/Communicate-with-Flash-Send-or-Get-data-from-to-a)

基本上，有一个 IShockwaveFlash* 对象可用于与 flash 接口来回通信。但是，flash 程序必须通过 flash.external.* 包公开它，然后使用 ExternalInterface 方法。

否则，闪光灯被设置为黑匣子。

# ios - 是否可以使用editingStyleForRowAtIndexPath - > UITableViewCellEditingStyleInsert 使用“静态单元格”作为UITableView？

> ID：10234148
> 
> 赞同：0
> 
> 时间：2012-04-19T18:08:48.770
> 
> 标签：ios, xcode, uitableview

我想我的问题很清楚。我已经在界面构建器中设置了一个`uitableview`静态单元格。在单元格内使用了诸如 textviews 之类的东西，我认为将其更改为以编程方式设置单元格的普通 tableview 将是很多工作。

所以我想知道我是否还能`editingStyleForRowAtIndexPath`以某种方式使用，我试过了，但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:33:19.717

有可能的！在这里找到了一些帮助：[https ://stackoverflow.com/a/10060997/871561](https://stackoverflow.com/a/10060997/871561)

# jquery - 将 bootstrap-datepicker 限制在工作日？

> ID：10234153
> 
> 赞同：23
> 
> 时间：2012-04-19T18:09:22.427
> 
> 标签：jquery, twitter-bootstrap, datepicker, bootstrap-datepicker

无论如何，是否只允许在下面找到的引导日期选择器中选择工作日？ [https://github.com/eternicode/bootstrap-datepicker/](https://github.com/eternicode/bootstrap-datepicker/)

我正在像这样实例化日期选择器：

```
$('#datepicker').datepicker();

/* Update datepicker plugin so that MM/DD/YYYY format is used. */
$.extend($.fn.datepicker.defaults, {
    parse: function (string) {
        var matches;
        if ((matches = string.match(/^(\d{2,2})\/(\d{2,2})\/(\d{4,4})$/))) {
            return new Date(matches[3], matches[1] - 1, matches[2]);
        } else {
            return null;
        }
    },
    format: function (date) {
        var
        month = (date.getMonth() + 1).toString(),
        dom = date.getDate().toString();
        if (month.length === 1) {
            month = "0" + month;
        }
        if (dom.length === 1) {
            dom = "0" + dom;
        }
        return month + "/" + dom + "/" + date.getFullYear();
    }
}); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-08-25T10:21:16.840

[https://github.com/eternicode/bootstrap-datepicker](https://github.com/eternicode/bootstrap-datepicker)的最新版本已经有一个选项来禁用特定工作日的选择。从[文档](http://bootstrap-datepicker.readthedocs.org/en/latest/options.html#daysofweekdisabled)：

> ### daysOfWeekDisabled
> 
> 字符串，数组。默认： ''， []
> 
> 一周中应该禁用的天数。值为 0（星期日）到 6（星期六）。多个值应以逗号分隔。示例：禁用周末：`'0,6'`或`[0,6]`.

换句话说，只需像这样实例化您的日期选择器：

```
$('#datepicker').datepicker({
    daysOfWeekDisabled: [0,6]
}); 
```

这是一个 jsfiddle 演示：http: [//jsfiddle.net/vj77M/1/](http://jsfiddle.net/vj77M/1/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-19T18:48:32.830

** 更新 **

Bootstrap datepicker 现在有一个`daysOfWeekDisabled`选项。请参阅下面的@fin 答案。

** 旧答案 **

[这是一个工作演示](http://jsfiddle.net/katowulf/zNbUT/5/)

假设你的星期从星期日开始：

```
$(function() {
    function disableWeekends($this) {
        var $days = $this.find('.datepicker-days tr').each(function() {
            var $days = $(this).find('.day');
            $days.eq(0).addClass('old').click(false); //Sunday
            $days.eq(6).addClass('old').click(false); //Saturday
        });

    }

    $('#dp1').datepicker({
        format: 'mm-dd-yyyy'
    });

    // get instance of the jQuery object created by
    // datepicker    
    var datepicker = $('#dp1').data('datepicker').picker;

    // disable weekends in the pre-rendered version
    disableWeekends(datepicker);

    // disable weekends whenever the month changes
    var _fill = datepicker.fill;
    datepicker.fill = function() {
        _fill.call(this);
        disableWeekends(this.picker);
    };

});​ 
```

如果没有，只需将 $days.eq(...) 更改为正确的索引。

当然，这仅涵盖点击事件并让您朝着正确的方向前进。我很确定可能需要解决其他问题，例如键盘导航。

* * *

**编辑**

对于最新版本，请在适当的地方使用此代码

```
// get instance of the jQuery object created by datepicker    
var datepicker = $('#dp1').data('datepicker');

// disable weekends in the pre-rendered version
disableWeekends(datepicker.picker);

// disable weekends whenever the month changes
var _fill = datepicker.fill;
datepicker.fill = function() {{
    _fill.call(this);
    disableWeekends(datepicker.picker);
}}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-17T04:43:54.100

你也可以试试。

```
onRender: function(date) {
    return date.getDay() == 0 || date.getDay() == 6 ? 'disabled' : '';
} 
```

希望它可以帮助某人。:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-07-12T06:29:49.863

```
$(document).ready(function(){

var date_input=$('input[name="date"]'); 

var container=$('.bootstrap-iso form').length>0 ? $('.bootstrap-iso form').parent() : "body";

date_input.datepicker({

format: 'dd/mm/yyyy',

container: container,

weekStart: 0,

daysOfWeekDisabled: "0,1,2,3,4,5",

daysOfWeekHighlighted: "6",

todayHighlight: true,

autoclose: true,

})

}) 
```

# css - 如何在 Chrome 开发者工具中找到任何元素的计算大小？

> ID：10234154
> 
> 赞同：12
> 
> 时间：2012-04-19T18:09:24.047
> 
> 标签：css, google-chrome, developer-tools

我确定这在开发人员工具检查器中的某个地方，但我找不到它。对于给定元素（例如，div），我在哪里可以找到我右键单击并选择“检查元素”的给定元素的计算尺寸（高度和宽度）？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-19T18:11:40.623

只需将鼠标悬停在开发人员工具面板下方功能区中的元素名称上即可。相应的元素将在浏览器窗口中突出显示，并且尺寸出现在它的一角。此外，如果您在开发人员工具中向下滚动右侧窗格，您将看到“指标”窗口，该窗口将为您提供计算尺寸以及边距、填充、边框等。

这是包含您的 SO 问题的 div 尺寸的屏幕截图。当我将鼠标悬停在底部的 div 名称上时，请注意突出显示区域左下角的尺寸。右侧是指标窗口。

![计算尺寸截图](../Images/0b5afef0bfabeceebb06cc23d5aedabf.png)

[点击这里查看大图](https://i.stack.imgur.com/qu6QS.png)

对于以后的问题，请先参考 Google 的[不错的文档](https://developer.chrome.com/devtools)。

# c - tcp 时间戳，记录返回回复所需的时间

> ID：10234158
> 
> 赞同：0
> 
> 时间：2012-04-19T18:09:42.080
> 
> 标签：c, linux, sockets, tcp, timestamp

我正在尝试计时（秒，毫秒，微秒）来自服务器的回复，我的客户端正在向服务器发送一个小数据包并且服务器正在回复客户端。现在我想要的是一种在从客户端发送到服务器的数据包，服务器将自己的时间戳附加到该数据包并将其返回给客户端。当客户端接收到该数据包时，它会找到两个时间之间的差异，并将此差异作为往返时间 + 服务器处理时间返回。

我的问题是我知道 tcp 套接字有一个时间戳选项，但网络上没有关于它的示例。如果有人能引导我朝着正确的方向前进，那就太好了。

谢谢 操作系统：ubuntu 11.10 语言：C 套接字：BSD

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:34:51.653

客户端是单线程的吗？如果是这样，并且您只对测量往返时间+处理时间感兴趣，那么您所要做的就是测量客户端发送数据包并接收与其对应的响应所花费的时间。所以只需在客户端发送之前获取以毫秒为单位的时间，然后在客户端收到响应后获取以毫秒为单位的时间。这两者的区别是往返时间+处理时间。当然，这只适用于客户端是单线程的（即它进行发送然后立即调用 recv 并等待来自服务器的响应）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:20:00.283

取决于你想去的兔子洞有多深......

如果您想专门使用 TCP 数据包（如在您的标签中），最直接的方法是从客户端向服务器发送一个数据包，其有效负载仅包含当前时间戳。当服务器接收到数据包时，将服务器的时间戳附加到有效负载并将其返回给客户端。

确保客户端/服务器也是时间同步的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:16:30.520

如果您对性能测量感兴趣，最好安装wireshark [http://www.wireshark.org/](http://www.wireshark.org/)并查看数据包日志。这将为您提供准确的计时，而无需更改您正在测量的代码或堆栈。

# c - 宏是否可以将多个参数评估给另一个？

> ID：10234172
> 
> 赞同：6
> 
> 时间：2012-04-19T18:10:28.783
> 
> 标签：c, c-preprocessor

我想做这样的事情：

```
#define NEED3ARGS(a1,a2,a3) ( "[" #a1 " + " #a2 " + " #a3 "]" )
#define MULTIARG()  ARG1, ARG2, ARG3

NEED3ARGS( MULTIARG() ) 
```

我希望它输出如下内容：

```
( "[" "ARG1" " + " "ARG2" " + " "ARG3" "]" ) 
```

但相反，我有：

```
$ cpp multiarg.c 
# 1 "multiarg.c"
# 1 "<built-in>"
# 1 "<command-line>"
# 1 "multiarg.c"

multiarg.c:4:23: error: macro "NEED3ARGS" requires 3 arguments, but only 1 given
NEED3ARGS 
```

有没有办法使用 ANSI-C/GNU GCC 和 C 预处理器来做我想做的事？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-19T18:14:36.590

你需要一些间接性。使用 C99：

```
#define NEED3ARGS(a1,a2,a3) ( "[" #a1 " + " #a2 " + " #a3 "]" )
#define INVOKE_NEED3ARGS(...) NEED3ARGS(__VA_ARGS__)
#define MULTIARG()  ARG1, ARG2, ARG3

INVOKE_NEED3ARGS( MULTIARG() ) 
```

（C99 不是严格要求的；您可以将可变参数宏替换为固定数量的宏。）

如果您需要使用 Visual C++ 编译源代码，则需要更多的间接性（因为[编译器错误](http://connect.microsoft.com/VisualStudio/feedback/details/380090/variadic-macro-replacement)）：

```
#define NEED3ARGS(a1,a2,a3) ( "[" #a1 " + " #a2 " + " #a3 "]" )
#define INVOKE_NEED3ARGS_(...) NEED3ARGS __VA_ARGS__
#define INVOKE_NEED3ARGS(...) INVOKE_NEED3ARGS_((__VA_ARGS__))
#define MULTIARG()  ARG1, ARG2, ARG3

INVOKE_NEED3ARGS( MULTIARG() ) 
```

* * *

至于*为什么*需要间接：宏参数在被替换到替换列表之前不会被评估和宏替换。因此，当您尝试`NEED3ARGS(MULTIARG())`,直到宏调用开始*后*`MULTIARG()`才会被评估，因此它被视为单个参数。

 *`INVOKE_NEED3ARGS`宏确保在调用之前对其参数进行完全评估`NEED3ARGS`。被的`__VA_ARGS__`宏替换参数替换`INVOKE_NEED3ARGS`，即`ARG1, ARG2, ARG3`，然后`NEED3ARGS`用这些参数调用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-19T18:15:07.487

是的，

```
#define NEED3ARGS(a1,a2,a3) ( "[" #a1 " + " #a2 " + " #a3 "]" )
#define MULTIARG()  ARG1, ARG2, ARG3
#define NEED1ARG(ARG) NEED3ARGS(ARG)

NEED1ARG( MULTIARG() ) 
```

您需要将其包装在另一个宏调用中，以便在调用之前扩展参数`NEED3ARGS`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-21T20:00:04.817

Adding to James McNellis's answer, if you need to apply this trick to many function-like macros (flm), you could define a single "invoke" macro to do the trick for you. Here's a complete working example:

```
#include<cstdio>
int f(int x,int y) { return x + y; }
#define g(x,y) x+y
#define XY  1,2
#define _g(arg) g(arg)
#define invoke(flm,...) flm(__VA_ARGS__)
int main(int argc, char ** argv)
{
  printf("%d\n",f(XY));        // functions are easy
  printf("%d\n",_g(XY));       // Jam,es' way
  printf("%d\n",invoke(g,XY)); // with generic invoke flm
  return 0;
} 
```*

# linux - Linux 的 Oracle JDK 链接是否损坏？

> ID：10234173
> 
> 赞同：1
> 
> 时间：2012-04-19T18:10:44.653
> 
> 标签：linux, oracle, bash, java, wget

我在 YouTube 上运行了一个在 Linux 上安装 Oracle JDK 的教程。我的脚本似乎有效，但我无法再运行

```
wget http://download.oracle.com/otn-pub/java/jdk/7u3-b04/jdk-7u3-linux-i586.tar.gz 
```

我可以使用哪些新方法或脚本在 Linux 上安装 Oracle JSK？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:17:22.573

是的，Oracle JDK 链接已损坏，您必须单击该网站并接受条款。

Google 上的第二个链接，第一个是这个问题（哇，Googlebot*很快*）是[Oracle 讨论线程](https://forums.oracle.com/forums/thread.jspa?threadID=2365607)：

> 你好，
> 
> 不幸的是，我们必须在下载之前要求接受许可。这可以通过两种方式之一来实现。我们要求在下载之前注册并登录，作为注册的一部分，您同意阅读并遵守许可。或者，我们使用点击下载的方式来避免注册和登录的需要。我们选择后者作为 Java 下载的侵入性最小的方法。我们前段时间发现脚本被用于规避点击（违反网站政策，坦率地说也违反常识）并堵住了这个漏洞。
> 
> 我们知道这使得 Linux 用户无法从我们的主网站进行命令行更新，并且正在积极寻找其他方法来启用此用例。
> 
> Oracle JDK 基于 OpenJDK（添加了一些组件，例如我们从第三方获得许可的闭源字体光栅化器），后者作为大多数 Linux 发行版的一部分提供，因此它是一个不错的选择，除非您特别需要Oracle 认证的二进制文件。
> 
> 问候，
> 
> Henrik Ståhl Oracle Java 平台集团产品管理高级总监

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:20:34.660

如果您查看返回的内容，则它不起作用的原因非常明显：

> 要从 Oracle 技术网下载产品，您必须同意 OTN 许可条款。
> 请确保...
> - 您的浏览器启用了“cookies”和 JavaScript。
> - 您为要下载的产品点击了“接受许可”。
> - 您在接受许可后 30 分钟内尝试下载。

当您从浏览器执行此操作时，您必须选择单选按钮“接受许可协议”，这就是设置 cookie 的时间。您应该可以使用链接或 lynx 下载它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T15:25:33.807

同意并下载 JDK 后，运行以下脚本：

```
#!/bin/bash
#Author: Yucca Nel http://thejarbar.org
#Will restart system
#Modify these variables as needed...
tempWork=/tmp/work
locBin=/usr/local/bin
javaUsrLib=/usr/lib/jvm
downloadDir=~/Downloads

sudo mkdir -p $javaUsrLib
mkdir -p $tempWork
cd $tempWork

#Extract the download
tar -zxvf $downloadDir/*linux*
#Move it to where it can be found...

sudo mv -f $tempWork/jdk* $javaUsrLib/

sudo ln -f -s $javaUsrLib/jdk1/bin/* /usr/bin/

#Update this line to reflect versions of JDK...
export JAVA_HOME="$javaUsrLib/jdk1.7.0_03"
#Extract the download
tar -zxvf $tempWork/*

#Move it to where it can be found...

sudo mv -f $tempWork/jdk1* $javaUsrLib/

sudo ln -f -s $javaUsrLib/jdk1*/bin/* /usr/bin/
sudo rm -rf $tempWork
#Update this line to reflect newer versions of JDK...
export JAVA_HOME="$javaUsrLib/jdk1.7.0_02"

if ! grep "JAVA_HOME=$javaUsrLib/jdk1.7.0_02" /etc/environment
then
    echo "JAVA_HOME=$javaUsrLib/jdk1.7.0_02"| sudo tee -a /etc/environment
fi

exit 0 
```

# javascript - 当我只想要一个时，鼠标悬停事件处理程序会同时显示两个 div

> ID：10234174
> 
> 赞同：0
> 
> 时间：2012-04-19T18:10:50.083
> 
> 标签：javascript, jquery, event-handling, mouseevent

我正在尝试为一张图片做一个鼠标悬停事件，当你将鼠标悬停在一个 div 上并在图片上动画时。但是，当我进行鼠标悬停时，当我一次只想要一个时，它会为单独的图片显示两个 div。这是我的代码。第一部分是鼠标悬停。二是鼠标移出。

```
$('.portfolio img').mouseover(function(){
    $(this).css('cursor', 'pointer');
    $(this).parent().find('img:first').stop().animate({opacity:1}, 800, function() {
          $("div.folio").animate({ height: '+=25px', top: '-=24px' }, 100, function() {
                $("div.folio span").animate({ opacity: 1 }, 500);
          });
    });
});

$('.img_grayscale').mouseout(function(){
       $(this).stop().animate({opacity:0}, 800, function() {
            $("div.folio span").animate({ opacity: 0 }, 500, function() {
                $("div.folio").animate({ height: '-=25px', top: '+=24px' }, 100);
                $("div.folio").css('top', '-9px');
            });
        });
}); 

        <div class="portfolio">
            <h2>The Portfolio</h2>
            <p class="slideTwo">Check out some of our recent projects.</p>
            <ul>
                <li><img src="portfolioOne.jpg"></img><div class="folio"><span>thesite.com</span></div></li>
                <li><img src="portfolioOne.jpg"></img><div class="folio"><span>mysite.com</span></div></li>
            </ul>
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:26:15.390

使用 jQuery`$("div.folio")`将返回所有带有“folio”类的 div。由于您在两张图像上都看到了此动画，而不仅仅是您将鼠标悬停的那张，我假设它们在要制作动画的 div 上都有相同的类。为了只对其中一个进行动画处理，您需要在使用 jQuery 选择它时更加具体。在 div 的路径上包含 $(this) 以进行动画处理通常有效，但如果没有相应的 HTML，我无法告诉您确切的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T13:53:13.537

设法弄清楚这一点。我必须通过下面的代码基本上横穿 DOM。我引用了图像，然后转到父级，然后转到 DOM 中的下一个元素，即 div.folio 的 div。然后我去那个对象的孩子淡入它。我基本上在鼠标移出时反向做了同样的事情。

```
 $('.portfolio img').mouseover(function(){
                $(this).css('cursor', 'pointer');
                $(this).parent().find('img:first').stop().animate({opacity:1}, 800, function() {
                    $(this).parent().next().animate({ height: '+=25px' }, 100, function() {
                        $(this).children().animate({ opacity: 1 }, 100);
                    });
                });
            });

            $('.img_grayscale').mouseout(function(){
                $(this).stop().animate({opacity:0}, 800, function() {
                        $(this).parent().next().children().animate({ opacity: 0 }, 100, function() {
                            $(this).parent().animate({height: '-=25px' }, 100);
                    });
                });
            }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T19:39:19.683

我对此有几个担忧，这可能有问题，也可能没有问题，具体取决于您尚未展示的其他情况。

*   您正在`$(this).parent().find('img:first')`jQuery onmouseover 函数内部进行操作，该函数`$(this)`应该已经代表了`img`您关心的内容。您是否发现出于某种原因有必要这样做？
*   您可以在选择器中更具体。尝试做`$(".portfolio>ul>li>img")`
*   `img_grayscale`在您的问题的标记中只提到一次，所以我不确定该类是如何应用的，但我假设它确实如此。
*   您可以直接将类`portfolio`（或一些唯一标识符）添加到您的图像中，并且可能更容易弄清楚为什么它没有按预期工作。那么你的鼠标悬停选择器可能只是`$(".specialClass")`

您绝对应该尝试发布 jsfiddle.net；您可以从网上借用任意两张图片进行测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T18:18:18.140

您需要通过从事件处理程序返回“false”来取消冒泡事件。

```
$('.portfolio img').mouseover(function(){
    // Your logic here...
    return false;
}); 
```

# wordpress - 将 WordPress 帖子和相关分类法移动到自定义帖子类型和分类法

> ID：10234176
> 
> 赞同：0
> 
> 时间：2012-04-19T18:10:53.737
> 
> 标签：wordpress, custom-post-type

我使用 21 安装了一个干净的 WordPress，没有插件或其他修改。该博客包含大约 800 篇带有相关标签和类别的帖子。

我想将所有这些帖子移动到自定义帖子类型。通过将以下代码添加到我的functions.php，我的博客现在已经安装了自定义帖子类型并且可以完美运行。

```
//Add custom post type
add_action( 'init', 'create_en_post_type' );
    function create_en_post_type() {
        register_post_type( 'en_post',  array(
            'labels' => array(
                'name' => __( 'English Posts' ),
                'singular_name' => __( 'English Post' )
            ),
            'public' => true,
            'menu_position' => 5,
            'rewrite' => array('slug' => 'en'),
            'supports' => array(
                'title', 
                'editor', 
                'author', 
                'excerpt', 
                'comments', 
                'custom-fields'
            )
        ));
    }

//Add belonging custom taxonomy
add_action( 'init', 'build_taxonomies', 0 ); 
    function build_taxonomies() { 
    register_taxonomy( 'english_categories', 'en_post', array( 'hierarchical' => true, 'label' => 'English Categories', 'query_var' => true, 'rewrite' => true ) );
    register_taxonomy( 'english_tags', 'en_post', array( 'hierarchical' => false, 'label' => 'English Tags', 'query_var' => true, 'rewrite' => true ) );
    } 
```

现在我需要的只是将常规帖子类型更改为我的自定义帖子类型。我已经设法使用插件[Convert Post Types](http://wordpress.org/extend/plugins/convert-post-types/)移动了帖子，但我的分类法没有被转换。

我意识到我可以创建类似的自定义类别并将自定义帖子分配给它们，但是标签呢？如何转换这些（自动，1200 个标签）？

我试过在数据库中手动弄乱，但我不能让它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:19:39.690

您应该更改数据库中的 ID，仔细查看 phpmyadmin

*   wp_term_taxonomy
*   wp_terms
*   wp_term_relationships

在术语表中，您会发现 term_taxonomy
中新旧分类的 id 将所有旧分类替换`term_id`为新分类。

SQL：

```
UPDATE `wp_term_relationships` SET `term_id` = REPLACE(`term_id`, /*old id*/, /*new id*/); 
```

开始前请做好**备份**

# c++ - 分配器如何创建和销毁数组？

> ID：10234178
> 
> 赞同：4
> 
> 时间：2012-04-19T18:10:58.660
> 
> 标签：c++, design-patterns, memory, memory-management

分配器如何创建和销毁和排列，例如

```
int* someInt = someAllocator(3); 
```

没有分配器的地方

```
int* someInt = new int[3]; 
```

分配器负责创建每个元素并确保调用构造函数。

在不使用 new 的情况下如何编写分配器的内部结构？有人可以提供该功能的示例吗？

我不想只使用 std::vector，因为我正在尝试学习分配器如何创建数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:28:22.230

**一般**内存分配问题是一个非常棘手的问题。有些人认为它已解决，有些则无法解决；）如果您对内部结构感兴趣，请先查看[Doug Lea 的 malloc](http://gee.cs.oswego.edu/dl/html/malloc.html)。

**专门**的内存分配器通常要简单得多——它们用通用性（例如通过固定大小）来换取简单性和性能。不过要小心，在实际程序中，使用通用内存分配通常比使用特殊分配器的大杂烩要好。

一旦通过内存分配器的“魔法”分配了一块内存，就可以使用[placement new](http://en.wikipedia.org/wiki/Placement_syntax)以容器的喜好对其进行初始化。

### - - 编辑 - -

放置 new 对于“正常”编程没有用 - 您只需要在实现自己的容器以将内存分配与对象构造分开时才需要它。话虽如此，这里有一个使用placement new的稍微做作的例子：

```
#include <new> // For placement new.
#include <cassert>
#include <iostream>

class A {
public:
    A(int x) : X(x) {
        std::cout << "A" << std::endl;
    }
    ~A() {
        std::cout << "~A" << std::endl;
    }
    int X;
};

int main() {

    // Allocate a "dummy" block of memory large enough for A.
    // Here, we simply use stack, but this could be returned from some allocator.
    char memory_block[sizeof(A)];

    // Construct A in that memory using placement new.
    A* a = new(memory_block) A(33);

    // Yup, it really is constructed!
    assert(a->X == 33);

    // Destroy the object, wihout freeing the underlying memory
    // (which would be disaster in this case, since it is on stack).
    a->~A();

    return 0;

} 
```

这打印：

```
A
~A 
```

### --- 编辑 2 ---

好的，这是您对数组执行此操作的方法：

```
int main() {

    // Number of objects in the array.
    const size_t count = 3;

    // Block of memory big enough to fit 'count' objects.
    char memory_block[sizeof(A) * count];

    // To make pointer arithmetic slightly easier.
    A* arr = reinterpret_cast<A*>(memory_block);

    // Construct all 3 elements, each with different parameter.
    // We could have just as easily skipped some elements (e.g. if we
    // allocated more memory than is needed to fit the actual objects).
    for (int i = 0; i < count; ++i)
        new(arr + i) A(i * 10);

    // Yup, all of them are constructed!
    for (int i = 0; i < count; ++i) {       
        assert(arr[i].X == i * 10);
    }

    // Destroy them all, without freeing the memory.
    for (int i = 0; i < count; ++i)
        arr[i].~A();

    return 0;

} 
```

顺便说一句，如果`A`有一个默认构造函数，你可以*尝试*在这样的所有元素上调用它......

```
new(arr) A[count]; 
```

...但这会打开一罐你真的不想处理[的蠕虫。](https://stackoverflow.com/a/15948/533120)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:55:33.537

我在这里的第二个例子中写过它：

[如何在可能使用placement new的同时创建一个数组](https://stackoverflow.com/questions/10220846/how-to-create-an-array-while-potentially-using-placement-new/10222202#10222202)

不同之处在于`t_allocator::t_array_record`它将由分配器而不是客户端管理。

# entity-framework - Entity Framework 4.3 多项目安装

> ID：10234179
> 
> 赞同：0
> 
> 时间：2012-04-19T18:11:03.697
> 
> 标签：entity-framework, installation

我对使用最新的 Entety 框架的代码感到困惑。我在解决方案中有 2 个项目。我使用 t4 模板来生成自我跟踪实体。在项目 #1 中，我刚刚通过 NuGet PM 安装了 .edmx 文件和 Entety Framework 4.3。现在我的第二个项目有模板生成的上下文类。那么如何确保我的第二个项目也使用 EF 4.3？我是否需要为我的解决方案中的每个项目单独安装它，或者我可以只引用 EntityFramework.dll 吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T21:42:11.717

实体框架包安装是项目特定的。我会单独安装它，以便 NuGet 可以管理引用。

要管理多个项目的包安装，请使用“工具->库包管理器->用于解决方案的 Nuget 包管理器...”打开解决方案的 NuGet PM 转到已安装选项卡（或在线），选择 EntityFramework 并单击管理。选中/取消选中安装 EntityFramework 的项目。

或者，在控制台中将 -ProjectName 属性传递给 install-package 命令。

# c# - 在 WinForms 中显示、覆盖和解释实时视频源

> ID：10234183
> 
> 赞同：0
> 
> 时间：2012-04-19T18:11:13.257
> 
> 标签：c#, winforms, video, opencv, video-capture

我正在开始一个新项目，以从附加的网络摄像头以 Windows 形式显示实时视频，并用 Windows 控件（按钮等）覆盖该视频。另外，我想做一些图像校正以消除动态失真并进行一些边缘检测。

我很困惑哪个库可能最适合这个。

1.  OpenCVSharp - 可以处理校正/检测，不确定是否可以覆盖/实时提要。
2.  DirectShow/DirectShow.Net - 我是否需要为叠加层编写过滤器，如何处理边缘检测？
3.  AForge.net - 已被推荐，但我不确定它是否有能力

有没有人有这些或其他可能适合从.Net访问的库的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:25:01.157

如果您只想使用视觉部分，那么 AForge.net 是您最好的选择。我过去曾使用过它，它非常适合用于视频/提要内容。不要指望稍后会对你的音频做些什么，因为 AForge.NET 只支持与视觉相关的东西。就我个人而言，我不会使用 DirectShow，因为它已经很老了，有时需要你做一些复杂的互操作技巧来获得你想要的东西。如果您想采用 DirectShow 方式，至少使用 DirectShow.NET。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T19:42:15.077

我相信您可以使用[OpenCVSharp](http://code.google.com/p/opencvsharp/)和来自[透明图像叠加](http://www.aishack.in/2010/07/transparent-image-overlays-in-opencv/)的说明来实现这一点。

# asp.net - 了解接口和基类的使用

> ID：10234187
> 
> 赞同：0
> 
> 时间：2012-04-19T18:11:38.507
> 
> 标签：asp.net, vb.net, interface, base-class

我知道有很多关于接口和基类的帖子，但我很难理解正确的设计模式。

如果我要编写一个报告类，我最初的想法是创建一个包含所有报告都将实现的核心属性、方法等的接口。

例如：

```
Public Interface IReportSales

Property Sales() As List(Of Sales)
Property ItemTotalSales() As Decimal

End Interface

Public Interface IReportProducts

Property Productss() As List(Of Inventory)
Property ProductsTotal() As Decimal

End Interface 
```

然后我假设我会有一个类来实现接口：

```
Public Class MyReport
Implements IReportSales

Public Property Sales() As System.Collections.Generic.List(Of Decimal) Implements IReportItem.Sales
    Get
        Return Sales
    End Get
    Set(ByVal value As System.Collections.Generic.List(Of Decimal))
        Items = value
    End Set
End Property

Public Function ItemTotalSales() As Decimal Implements IReport.ItemTotalSales
    Dim total As Decimal = 0.0
    For Each item In Me.Sales
        total = total + item
    Next
End Function

End Class 
```

我的想法是它应该是一个接口，因为其他报表可能不使用“项目”，这样我就可以实现用于给定报表类的对象。

我走远了吗？我应该还刚刚创建了一个基类吗？我不创建基类的逻辑是，并非所有报表类都可以使用“项目”，所以我不想在不使用它们的地方定义它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:46:28.060

为了尝试回答您的问题，抽象类用于为相关类提供共同的祖先。.Net API 中的一个示例是`TextWriter`. 这个类提供了一个共同的祖先，所有这些类的目的是以某种方式编写文本。

接口更适合用作不同对象的适配器，这些对象不属于同一对象“家族”但具有相似的功能。.Net API 中的各种集合就是一个很好的例子。

例如，`List`和`Dictionary`类为您提供管理对象集合的能力。他们没有通过继承共享共同的祖先，这是没有意义的。但是，为了允许它们之间的轻松互操作，它们实现了一些相同的接口。

这两个类都实现了`IEnumerable`. 这完全允许您使用任一类型的对象`List`或`Dictionary`作为任何需要`IEnumerable`. 多么美妙！

因此，现在在您设计新软件的情况下，您需要考虑如何将其融入您的问题空间。如果你通过继承抽象类给这些类一个共同的祖先，你必须确保从它继承的所有项目都是真正的基类型。（例如，A`StreamWriter`是 a `TextWriter`）。不恰当地使用类继承会使您的 API 在未来很难构建和修改。

假设您`ReportBase`为您的报告创建了一个抽象类 , 。它可能包含一些非常通用的方法，所有报告都必须具备这些方法。也许它只是指定了方法`Run()`

然后，您只需要生成一种类型的报告，因此您可以定义一个`Report`继承自`ReportBase`. 一切都很好。然后您发现您需要添加更多类型的报告，`XReport`例如，`YReport`。`ZReport`它们是什么并不重要，但它们的工作方式不同并且有不同的要求。所有的报告都会生成漂亮的 HTML 输出，每个人都很高兴。

下周您的客户说他们也希望`XReport`并且`YReport`能够输出 PDF 文档。现在有很多方法可以解决这个问题，但显然向`OutputPdf`抽象类添加方法是一个坏主意，因为其中一些报告不应该或不能支持这种行为！

现在这就是接口对您有用的地方。假设您定义了一些接口`IHtmlReport`和`IPdfReport`. 现在应该支持这些不同输出类型的报表类可以实现这些接口。然后，这将允许您创建一个函数，例如，`CreatePdfReports(IEnumerable<IPdfReport> reports)`它可以获取所有实现 IPdfReport 的报告，并对其进行所需的任何操作，而无需关心适当的基本类型是什么。

希望这会有所帮助，因为我不熟悉您要解决的问题，所以我有点从臀部射击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:07:57.750

是的，如果您不知道有多少报表不会使用 Items ，您可以参加 Abstract 课程。

另一个好主意如下：

您还可以创建接口和抽象类

在 Interface 中定义 Sales，创建两个抽象类，一个用于实现两者的 Reports，另一个用于未实现 Sales 的 Report。实现两者的接口

首先定义这两种方法（实施销售），然后仅在第二个中实施销售。

为这两个抽象类指定适当的名称，例如 ReportWithItemsBase 或 ReportWithoutItemsBase。

这样，您还可以在派生 Report 类时实现自我解释命名基类。

# android - 如果测试项目失败，如何编写一个 Git 预提交钩子来防止提交 Android 项目？

> ID：10234192
> 
> 赞同：1
> 
> 时间：2012-04-19T18:11:59.347
> 
> 标签：android, git, testing, hook, commit

鉴于我在我的工作区中有一个 android 项目`MyAndroidProject`和我的测试项目`MyAndroidProjectTests`目录，我如何编写一个 pre-commit git hook 来运行测试`MyAndroidProjectTests`并在测试失败时拒绝提交任何代码更改？

当我在终端上运行测试时，它们通常有如下输出：

```
com.mydomain.tests.Models.MyProjectTests:.......
Test results for InstrumentationTestRunner=.......
Time: 0.05

OK (10 tests) 
```

我不确定的是如何使用什么来尝试确定测试是否通过或失败，而不是解析最后一行的输出（例如`OK`，或者`FAILED`我不确定我是否非常喜欢这种方法。我理想情况下我'想要从我用来在终端上运行测试的命令返回一个状态：

```
adb shell am instrument -w com.mydomain.tests/android.test.InstrumentationTestRunner 
```

我想在一个 shell 脚本中使用响应，我可以将它`.git/hooks/`作为预提交钩子放在文件夹中。

我将不胜感激任何信息或其他资源的链接，并提前非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:17:20.733

git hooks 是从你的项目/repo 根目录执行的——所以你应该能够直接在 precommit hook 中使用你的命令：

```
#!/bin/bash
adb shell am instrument -w com.mydomain.tests/android.test.InstrumentationTestRunner 
```

如果`adb`在失败时返回非零存在代码 - 提交将被中止。

如果您需要出于其他目的获取退出代码，还有[其他问题](https://stackoverflow.com/questions/90418/exit-shell-script-based-on-process-exit-code)可以准确说明如何执行此操作。

# web - 如何使用路由器正确配置 Web 服务器

> ID：10234194
> 
> 赞同：1
> 
> 时间：2012-04-19T18:12:03.770
> 
> 标签：web, dns, webserver, ip

事实：我的路由器的公共 IP 地址是从我的 ISP（互联网服务提供商）获得的静态 IP 地址。我还有一个带有 windows server 2008 r2 版本的 web 服务器。我的域指向路由器的公共 IP 地址。

问题：

如何使用路由器设置 Web 服务器以管理对网站的请求。

示例：我需要知道如何执行此操作：

当有人在他们的网络浏览器中输入我的域名时，DNS 服务器将它们发送到我的路由器的 IP 地址，然后我的路由器将它们发送到我的网络服务器以显示我的网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:24:50.167

转到您的路由器设置（大多数路由器为 192.181.1.1，但在您的路由器下方查找您的路由器）输入您的用户名和密码（也位于路由器下方），然后找到端口转发设置。

让它将所有端口 80 流量转发到您计算机的 IP 地址。因此，如果您的计算机 ip 是 192.168.1.3，请使其直接访问该 ip。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-16T07:11:13.883

您的路由器使用您的公共 IP 对来自内部 192.xxx 网络和外部互联网的流量进行基于端口的 natting。您要做的称为反向 NAT。为此，您必须定义内部 IP 和端口号到外部 IP 和端口号的映射。它看起来像这样

`X.X.X.X:80 ------------> 192.168.1.x:80`

XXXX 是您的公共 IP，192.168.1.x 是您运行网络服务器的机器的 IP。一旦你有了这个映射，它就会让外部流量使用反向 NAT 进入内部。大多数路由器都将此功能列为端口转发，您必须在其中创建此类映射。他们会询问您要映射到的外部端口和内部 ip 和端口。-多发性硬化症

# java - 关于故意通知特定线程

> ID：10234197
> 
> 赞同：0
> 
> 时间：2012-04-19T18:12:29.677
> 
> 标签：java

我开发了下面的java代码..

```
 class ThreadB extends Thread {
public  int totals;

 public void run() {
     synchronized(this) {
     for(int i=0;i<100;i++) {
      totals += i;
      }
      notify(); //want to notify only thread b2
      }
      }
     } 
```

另一堂课是……

```
 class ThreadA {
     public static void main(String [] args) {
     ThreadB b1 = new ThreadB();
     b.start();
ThreadB b2 = new ThreadB();
b2.start();
ThreadB b3 = new ThreadB();
b3.start();
ThreadB b4 = new ThreadB();
b4.start();

     synchronized(b) {
     try {
     System.out.println("Waiting for b to complete...");
     b1.wait();
b2.wait(); //only b2 to be notified
b3.wait();
b4.wait();
    } catch (InterruptedException e) {}
    System.out.println("Total is: " + b.totals);
     }
    }
    } 
```

不，请告诉我我只想通知线程 b2 和 b2，我将如何实现这一点，因为通知线程可以拾取任何一个线程，但我只想要 b2，请告知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:15:26.087

您可以将引用`b2`等待传递给运行您要执行通知的线程的类。

你必须`synchronized`在你等待（）的对象上。

# eclipse-rcp - 激活零件警告

> ID：10234199
> 
> 赞同：1
> 
> 时间：2012-04-19T18:12:43.160
> 
> 标签：eclipse-rcp

我的应用程序是具有两个视图的透视图。启动它时，应用程序会显示带有表格的 viewA，而 viewB 是隐藏的。当我从表中选择一个项目时，打开 viewB，将您选择的项目发送到 viewB，然后隐藏 viewA。我可以执行这些操作，但在控制台上我有以下警告：“阻止递归尝试激活部分“viewB”，同时仍在激活部分“viewA”。一些帮助解决这个警告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T14:48:09.880

您是否正在做在按钮单击事件方法中显示“viewB”的工作？如果是这样，您可能需要将这些工作排队等待 UI 线程稍后执行，方法是将其包装在：

```
Display.getDefault().asyncExec(new Runnable() {
  @Override
  public void run() {
    // Your UI update code.
  }
}; 
```

# php - 由于某种原因没有更新 WordPress 表

> ID：10234200
> 
> 赞同：0
> 
> 时间：2012-04-19T18:12:47.507
> 
> 标签：php, wordpress

我正在尝试根据[http://codex.wordpress.org/wpdb#query_-_Run_Any_Query_on_the_Database使用下面提供的代码为我的用户更新字段](http://codex.wordpress.org/wpdb#query_-_Run_Any_Query_on_the_Database)

```
$wpdb->update($table, $data, $where); 
```

您可以在下面看到我是如何实现它的，希望它能够工作，但没有做到。它只是不会像它需要的那样更改用户**foobar的****电子邮件。**

 **```
global $wpdb;
$wpdb->update('wp_usermeta',
    array('email' => 'foo@bar.com'),
    array('user' => 'foobar')                               
); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:26:28.593

```
global $wpdb;
$wpdb->update(
    $wpdb->usermeta,
    array(
        'meta_value' => 'foo@bar.com')
    ),
    array(
        'user' => 'foobar',
        'meta_key' => 'email'
    )
); 
```**

# google-app-engine - AppEngine 错误 [ java.lang.NoClassDefFoundError: org/w3c/dom/ElementTraversal ]

> ID：10234201
> 
> 赞同：61
> 
> 时间：2012-04-19T18:13:01.773
> 
> 标签：google-app-engine

我一直在寻找解决这个问题的方法，但似乎很困难。我有一个使用处理注册的 servlet 的 appengine 项目。当我尝试调用这个 servlet 时，我有这个日志报告：

```
012-04-19 10:31:06.816 /register 500 90ms 0kb Apache-HttpClient/UNAVAILABLE (java 1.4)
ip - gecodroidtest [19/Apr/2012:10:31:06 -0700] "POST /register HTTP/1.1" 500 0 - "Apache-HttpClient/UNAVAILABLE (java 1.4)" "cloudnotifyit.appspot.com" ms=90 cpu_ms=58 api_cpu_ms=0 cpm_usd=0.001738 instance=00c61b117c772731eb45290bfcb07750c0505f
W 2012-04-19 10:31:06.794
com.cloudnotify.server.servlet.RequestInfo processRequest: xxxxxxxxxxxx@xxxx  //just for me
W 2012-04-19 10:31:06.810
Error for /register 
java.lang.NoClassDefFoundError: org/w3c/dom/ElementTraversal
    at com.google.appengine.runtime.Request.process-240c2ffe1bf8ddba(Request.java)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at org.apache.xerces.parsers.AbstractDOMParser.startDocument(Unknown Source)
    at org.apache.xerces.impl.dtd.XMLDTDValidator.startDocument(Unknown Source)
    at org.apache.xerces.impl.XMLDocumentScannerImpl.startEntity(Unknown Source)
    at org.apache.xerces.impl.XMLVersionDetector.startDocumentParsing(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
    at org.apache.xerces.parsers.DOMParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.DocumentBuilderImpl.parse(Unknown Source)
    at javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:121)
    at javax.jdo.JDOHelper.readNamedPMFProperties(JDOHelper.java:1407)
    at javax.jdo.JDOHelper.getNamedPMFProperties(JDOHelper.java:1286)
    at javax.jdo.JDOHelper.getPropertiesFromJdoconfig(JDOHelper.java:1232)
    at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:1079)
    at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:914)
    at com.cloudnotify.server.c2dm.C2DMessaging.getPMF(C2DMessaging.java:103)
    at com.cloudnotify.server.servlet.RequestInfo.initDevices(RequestInfo.java:225)
    at com.cloudnotify.server.servlet.RequestInfo.processRequest(RequestInfo.java:183)
    at com.cloudnotify.server.servlet.RegisterServlet.doPost(RegisterServlet.java:100)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:449)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:455)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:695)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:333)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:325)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:453)
    at java.lang.Thread.run(Thread.java:679)
Caused by: java.lang.ClassNotFoundException: org.w3c.dom.ElementTraversal
    at com.google.appengine.runtime.Request.process-240c2ffe1bf8ddba(Request.java)
    ... 44 more
C 2012-04-19 10:31:06.812
Uncaught exception from servlet
java.lang.NoClassDefFoundError: org/w3c/dom/ElementTraversal
    at com.google.appengine.runtime.Request.process-240c2ffe1bf8ddba(Request.java)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at org.apache.xerces.parsers.AbstractDOMParser.startDocument(Unknown Source)
    at org.apache.xerces.impl.dtd.XMLDTDValidator.startDocument(Unknown Source)
    at org.apache.xerces.impl.XMLDocumentScannerImpl.startEntity(Unknown Source)
    at org.apache.xerces.impl.XMLVersionDetector.startDocumentParsing(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
    at org.apache.xerces.parsers.DOMParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.DocumentBuilderImpl.parse(Unknown Source)
    at javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:121)
    at javax.jdo.JDOHelper.readNamedPMFProperties(JDOHelper.java:1407)
    at javax.jdo.JDOHelper.getNamedPMFProperties(JDOHelper.java:1286)
    at javax.jdo.JDOHelper.getPropertiesFromJdoconfig(JDOHelper.java:1232)
    at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:1079)
    at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:914)
    at com.cloudnotify.server.c2dm.C2DMessaging.getPMF(C2DMessaging.java:103)
    at com.cloudnotify.server.servlet.RequestInfo.initDevices(RequestInfo.java:225)
    at com.cloudnotify.server.servlet.RequestInfo.processRequest(RequestInfo.java:183)
    at com.cloudnotify.server.servlet.RegisterServlet.doPost(RegisterServlet.java:100)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:449)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:455)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:695)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:333)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:325)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:453)
    at java.lang.Thread.run(Thread.java:679)
Caused by: java.lang.ClassNotFoundException: org.w3c.dom.ElementTraversal
    at com.google.appengine.runtime.Request.process-240c2ffe1bf8ddba(Request.java)
    ... 44 more

Thanks all 
```

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2013-03-04T09:00:10.437

*   **行家解决方案：**

在 pom.xml 中，将“xml-apis”依赖项设置为 1.4.01 版本：

```
<dependency>
    <groupId>xml-apis</groupId>
    <artifactId>xml-apis</artifactId>
    <version>1.4.01</version>
</dependency> 
```

*   **其他人的解决方案：**

如果不使用 maven，可以手动添加 xml-apis 库，版本 1.4.01。您将在名为“XML Commons External 1.4.01”的 xml-commons 二进制包中找到这些 jar，您可以在此处下载：http: [//xerces.apache.org/mirrors.cgi](http://xerces.apache.org/mirrors.cgi)。

最后，使用此版本的库编译并执行您的 java 应用程序/项目。

*   ***说明*：**

xml-apis 库的 1.4.01 版本，包括所需的 ElementTraversal 类。其他版本如 2.0.0、1.0.0 等不包含它，并且应用程序在编译时失败。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-04-19T19:17:46.493

GAE 上的 Xerces 解析器可能存在一些问题。请参阅 [http://code.google.com/p/googleappengine/issues/detail?id=1367](http://code.google.com/p/googleappengine/issues/detail?id=1367)

也许解决方法是确保所有 Xerces jar（包括 xml-apis.jar）都在您的 WEB-INF/lib 中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-03-06T13:23:20.843

您的问题可以通过更新到已包含该类的版本[2.11.0.SP5](https://mvnrepository.com/artifact/xerces/xercesImpl/2.11.0.SP5)`ElementTraversal`来解决。

# c# - 我们如何将嵌入式资源添加到在运行时从源文件编译的文件中

> ID：10234203
> 
> 赞同：4
> 
> 时间：2012-04-19T18:13:06.800
> 
> 标签：c#, .net, embedded-resource, csharpcodeprovider

我正在编写一个小型应用程序，该应用程序使用函数从源（.cs）代码文件编译文件：

```
public static bool CompileExecutable(String sourceName)
{
    //Source file that you are compliling 
    FileInfo sourceFile = new FileInfo(sourceName);
    //Create a C# code provider 
    CodeDomProvider provider = CodeDomProvider.CreateProvider("CSharp");
    //Create a bool variable for to to use after the complie proccess to see if there are any erros
    bool compileOk = false;
     //Make a name for the exe
     String exeName = String.Format(@"{0}\{1}.exe",
     System.Environment.CurrentDirectory, sourceFile.Name.Replace(".", "_"));
     //Creates a variable, cp, to set the complier parameters
     CompilerParameters cp = new CompilerParameters();
     //You can generate a dll or a exe file, in this case we'll make an exe so we set this to true
     cp.GenerateExecutable = true;
     //Set the name
     cp.OutputAssembly = exeName;
     //Save the exe as a physical file
     cp.GenerateInMemory = false;
     //Set the compliere to not treat warranings as erros
     cp.TreatWarningsAsErrors = false;
     //Make it compile 
     CompilerResults cr = provider.CompileAssemblyFromFile(cp, sourceName);
     //if there are more then 0 erros...
     if (cr.Errors.Count > 0)
     {
         //A message box shows the erros that occured 
         MessageBox.Show("Errors building {0} into {1}" +
             sourceName + cr.PathToAssembly);
         //for each error that occured in the code make a separete message box
         foreach (CompilerError ce in cr.Errors)
         {
             MessageBox.Show("  {0}" + ce.ToString());
         }
     }
     //if there are no erros...
     else
     {
         //a message box shows compliere results and a success message
         MessageBox.Show("Source {0} built into {1} successfully." +
             sourceName + cr.PathToAssembly);
     }
     //if there are erros...
     if (cr.Errors.Count > 0)
     {
         //the bool variable that we made in the beggining is set to flase so the functions returns a false
         compileOk = false;
     }
     //if there are no erros...
     else
     {
         //we are returning a true (success)
         compileOk = true;
     }
     //return the result
     return compileOk;
} 
```

我想要实现的是添加用户选择的文件资源（图像、mp3、avi、ttf、..etc），这些文件资源将作为嵌入式资源添加到使用上述功能编译的内容中。

我们如何将嵌入式资源添加到在运行时从源文件编译的文件中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T18:34:07.157

您需要[创建一个包含要作为资源嵌入的`.resources`文件](http://msdn.microsoft.com/en-us/library/xbx3z216.aspx)的文件，然后使用该属性在您`CompilerParameter`的实例中引用生成的资源文件。[`EmbeddedResources`](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.compilerparameters.embeddedresources.aspx)

按照上面第一个链接*的 .resources 文件*部分的资源中的说明（引用的部分[`System.Resources.ResourceWriter`](http://msdn.microsoft.com/en-us/library/system.resources.resourcewriter.aspx)），这将生成一个临时文件。然后根据您问题中的代码（以及`EmbeddedResources`文档中的示例），您将使用以下内容引用它：

```
if (provider.Supports(GeneratorSupport.Resources))
{
    cp.EmbeddedResources.Add("pathToYourGeneratedResourceFile");
} 
```

# c# - 我的多线程应用程序失败后，未完成的线程会挂起吗？

> ID：10234205
> 
> 赞同：2
> 
> 时间：2012-04-19T18:13:09.723
> 
> 标签：c#, multithreading

我的应用程序在它们自己的线程上启动多个长时间运行的函数/方法。当其中一个线程遇到错误时，我的程序会崩溃（如预期的那样）。不过，我的问题是，应用程序产生的所有线程是否都停止执行？还是他们在某个地方闲逛？如果是这样，我是否需要编写另一个应用程序来监视它们以便我可以杀死它们？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-19T18:15:00.177

当一个进程完成时，该进程中包含的所有线程都将终止。线程不能存在于进程之外。应用程序崩溃 = 进程终止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T18:16:36.100

如果您从线程中产生进程，那么您产生的进程将在产生过程结束后继续运行。您可以在任务管理器和代码中终止进程树，但默认情况下，如果您的应用程序不正常结束，生成的进程将继续运行。

我假设这就是你所说的意思

> 我的应用程序在自己的线程上启动多个长时间运行的进程

但也许我误解了你的意思

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T18:16:16.430

如果创建所有线程的进程被终止/中止，则操作系统会自动中止线程。换句话说：正在运行的进程=至少一个正在运行的线程，已终止的进程=所有线程终止。

# linker - 如何在 GCC 中链接不以 lib 开头的库文件？

> ID：10234208
> 
> 赞同：13
> 
> 时间：2012-04-19T18:13:30.337
> 
> 标签：linker, gnu-toolchain

当我将 libm 等库与 ld 链接时，我需要删除 lib 前缀。如果文件不遵循此命名约定怎么办？除了重命名文件之外，还有其他方法可以链接它吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-09-18T13:00:00.913

您*可以*让链接器搜索一个没有 lib 前缀的库：

```
gcc main.o -L/path/to/foo -l:foo.a 
```

这在指定库列表并且稍后添加 -l 标志的环境中特别有用（例如，某些 makefile 或 eclipse CDT）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-21T14:33:02.157

您可以链接到任何库，例如`foo.a`，通过在链接行上指定它的完整路径：

```
gcc main.o /path/to/foo.a 
```

使用非标准库名称失去的是链接器搜索它的能力，例如，这将不起作用：

```
gcc main.o -L/path/to foo.a 
```

您可以使用`-l:foo.a`语法避免缺少搜索：

```
gcc main.o -L/path/one -L/path/two -l:foo.a 
```

> 当我将 libm 等库与 ld 链接时

请注意，通常您不应*将*任何内容与`ld`. 请改用编译器驱动程序——它将对象和库添加到正确结果所需的链接行。

# php - Wordpress 主题 - 如果页面有子页面，则添加文本箭头

> ID：10234212
> 
> 赞同：1
> 
> 时间：2012-04-19T18:13:41.430
> 
> 标签：php, wordpress

我想在所有具有子项/子页面的导航项后面显示一个箭头（添加文本）“>>”。add_filter 有解决方案还是我必须自己构建菜单？

感谢帮助！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-19T18:31:54.923

不完全是你问的......这会`class="dropdown"`在你的菜单中添加一个

```
// add a class 'dropdown' to menu items which have a sub menu
add_filter('nav_menu_css_class', 'check_for_submenu', 10, 2);
function check_for_submenu($classes, $item)
{
    global $wpdb;
    $has_children = $wpdb->get_var("SELECT COUNT(meta_id) FROM wp_postmeta WHERE meta_key='_menu_item_menu_item_parent' AND meta_value='" . $item->ID . "'");
    if ($has_children > 0)
        array_push($classes, 'dropdown'); // add the class dropdown to the current list
    return $classes;
} 
```

# xml - 如何使用 XSLT 根据优先顺序和属性删除 XML 中的节点？

> ID：10234213
> 
> 赞同：-1
> 
> 时间：2012-04-19T18:13:43.127
> 
> 标签：xml, xslt, xslt-1.0, xslt-2.0

我需要删除我的 xml 文件中的一些节点，其中包含某些方法以及它出现的顺序，例如这里是输入：

```
<root> 
<node id="a">
    <section id="a_1">
        <item id="0">
            <attribute>
                <color>Red</color>
            </attribute>
        </item>
    </section>

    <section id="a_2">
        <item id="0">
            <attribute>
                <color>Red</color>
            </attribute>
        </item>
    </section>            
</node>

<node id="b">
    <section id="b_1">         
        <user id="b_1b" method="pause">
            <attribute>a</attribute>
        </user>      
        <user id="b_1b" method="run">
            <attribute>a</attribute>
        </user>             
        <user id="b_1a" method="run">
            <attribute>
                <name>John</name>
            </attribute>
        </user>

        <user id="b_1a" method="pause">
            <attribute>a</attribute>
        </user>
    </section>

    <section id="b_1" method="create">   

        <user id="b_1b" method="stop">
            <attribute>a</attribute>
        </user>            
        <user id="b_1a" method="stop">
            <attribute>a</attribute>
        </user>

        <user id="b_1b" method="run">
            <attribute>a</attribute>
        </user>
        <user id="b_1b" method="pause">
            <attribute>a</attribute>
        </user>
    </section>

    <section id="b_2">                
        <user id="b_1a" method="run">
            <attribute>
                <name>John</name>
            </attribute>
        </user>
    </section>
</node> 
```

如果我使用这种方法：

```
<xsl:transform version="2.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:my="http://localhost"
  exclude-result-prefixes="my">

  <!-- Copy everything by default -->
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match=" user[not(@method eq 'stop' )][not(. is my:last(.))]
  | user[    @method eq 'stop' ][not(. is my:last(.))]
                     | user[not(@method eq 'stop')][my:last(.)/@method eq 'stop']"/>

          <!-- Get the last user for this section & user id -->
          <xsl:function name="my:last">
            <xsl:param name="user"/>
            <xsl:sequence select="($user/../../section[@id eq $user/../@id]
                                              /user   [@id eq $user/@id]
                                  )
                                  [last()]"/>
          </xsl:function>
</xsl:transform> 
```

结果将是：

```
<root>
    <node id="a">
        <section id="a_1">
            <item id="0">
                <attribute>
                    <color>
Red
                    </color>
                </attribute>
            </item>
        </section>
        <section id="a_2">
            <item id="0">
                <attribute>
                    <color>
Red
                    </color>
                </attribute>
            </item>
        </section>
    </node>
    <node id="b">
        <section id="b_1">
        </section>
        <section id="b_1" method="create">
            <user id="b_1a" method="stop">
                <attribute>
a
                </attribute>
            </user>
            <user id="b_1b" method="pause">
                <attribute>
a
                </attribute>
            </user>
        </section>
        <section id="b_2">
            <user id="b_1a" method="run">
                <attribute>
                    <name>
John
                    </name>
                </attribute>
            </user>
        </section>
    </node>
</root> 
```

而预期的输出是：

```
<root>
    <node id="a">
        <section id="a_1">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>

        <section id="a_2">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>            
    </node>

    <node id="b">
        <section id="b_1">                                           
        </section>

        <section id="b_1" method="create">               
            <user id="b_1a" method="stop">
                <attribute>a</attribute>
            </user>

            **<user id="b_1b" method="run">
                <attribute>a</attribute>
            </user>**
            <user id="b_1b" method="pause">
                <attribute>a</attribute>
            </user>
        </section>

        <section id="b_2">                
            <user id="b_1a" method="run">
                <attribute>
                    <name>John</name>
                </attribute>
            </user>
        </section>
    </node>
</root> 
```

所以这就是订单的运作方式。如果“停止”最后出现，那么任何其他具有相同用户 ID 的其他方法（例如暂停和运行）的节点都将被删除。但如果不是，则将删除本身具有“停止”的节点和“停止”***之前的所有节点。***

这必须发生在相同的部分 id 中，它只会删除用户节点（即使在删除用户节点后部分 id 为空，也要保留部分 id）。希望解释不会令人困惑。

非常感谢。

干杯，约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T11:49:38.857

试试这个 XSLT，它减少了条件的数量，并且也可以在 XSLT 1.0 中工作

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <!-- Ignore users with 'stop' method which are not the last such user -->
   <xsl:template match="user[@method='stop'][following::user[@method='stop']]"/>

   <!-- Match other users -->
   <xsl:template match="user">
      <!-- Copy the user if there isn't a following user with the same id and 'stop' method -->
      <xsl:if test="not(following::user[@id=current()/@id][@method='stop'])">
         <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
         </xsl:copy>
      </xsl:if>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

这也应该产生预期的输出

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T02:33:21.873

我想我找到了答案

```
<xsl:transform version="2.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:my="http://localhost"
  exclude-result-prefixes="my">

  <!-- Copy everything by default -->
    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="user[not(@method eq 'stop')][following::user[@method eq 'stop']]
    | user[(@method eq 'stop')][not(. is my:last(.))] 
    | user[not(@method eq 'stop')][my:last(.)/@method eq 'stop']"/>

    <xsl:function name="my:last">
        <xsl:param name="user"/>
        <xsl:sequence select="($user/../../section[@id eq $user/../@id]
                                              /user   [@id eq $user/@id]
                                  )
                                  [last()]"/>
    </xsl:function>
</xsl:transform> 
```

如果这是解决问题的正确方法或任何人有更好的解决方案，请发表评论。

# php - 如何将逗号分隔的文本文件转换为多维数组（使用单选按钮格式化）

> ID：10234218
> 
> 赞同：1
> 
> 时间：2012-04-19T18:14:13.707
> 
> 标签：php, multidimensional-array

我的文本文件包含：

*什么是狗？、宠物、人、房子、火车*

我想使用该数据创建一个多维数组，并使用该数组以测验格式发布问题。

例如：

*什么是狗？
[单选按钮] a.) 宠物
[单选按钮] b.) 人类
等*

到目前为止，我编码...

```
<?php

$file = fopen ("data.txt","r");

$i=0;
while (feof($file)==false)
    {
    $line = fgets($file);   
    $array[$i]=$line;
    $i=$i + 1;
    }

fclose($file);

session_start();
$_SESSION["questions_array"]=$array;

?> 
```

并回显数组...

```
<?php

session_start();
$array=$_SESSION["questions_array"];

for ($i=0;$i<count($array);$i++)
    {
    echo $array[$i]."<br>";
    }

?> 
```

我的问题是它回显为：

*什么是狗？、宠物、人、房子、火车*

而不是我想要的测验格式。我不确定如何将数组回显为我想要的格式。我到处寻找，但没有收到任何解决方案。请帮我！

细节（只是为了非常清楚）：

我想打开这个文本文件：

*什么是狗？、宠物、人、房子、火车*

进入一个多维数组并像这样回显它：

*什么是狗？
[单选按钮] a.) 宠物
[单选按钮] b.) 人类
等*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:19:08.460

您可以分解该行（[http://php.net/explode](http://php.net/explode)）并使用例如内部数组的数组元素 0 作为问题，以下用于答案。

```
$line = explode(',', $line);
$array[$i]=$line; 
```

稍后的：

> 回声 $array[$i][0] 。'br>';
> 
> $answers = count($array[$i]);
> 
> for($j = 1; $j < $answers; $j++) {
> 
> ```
> echo $array[$i][$j] . '<br>'; 
> ```
> 
> }

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:23:58.547

尽量避免这样的建模循环：`for ($i=0;$i<count($array);$i++)`请参阅[http://www.phpbench.com](http://www.phpbench.com)了解原因。

但让我们仔细看看您的具体需求：

```
foreach($array as $source){
   $data = explode(",", $source);
   // Now $data[0] is the question, [1] is answer 1, etc.. etc..

   echo "{$data[0]} <br> 
           <input type='radio' name='question' value='1'>{$data[1]} <br>
           <input type='radio' name='question' value='2'>{$data[2]} <br>
           <input type='radio' name='question' value='3'>{$data[3]} <br>
           <input type='radio' name='question' value='4'>{$data[4]} <br>";
} 
```

这应该让你走上正确的道路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:27:11.837

本质上，您需要构建一个数组数组（毕竟这就是多维数组）。

```
$quizItems=array();
$file = fopen ("data.txt","r");
while (feof($file)==false){
    $line = fgets($file);   

    //This code assumes no commas in the question or answers.
    $answers = explode(',', $line);

    //pull the question into a variable
    $question = $answers[0];

    //remove the question from the list of answers
    array_shift ($answers);

    //add the array to your result array
    $quizItems[]=array('question'=>$question, 'answers'=>$answers );
}
fclose($file);

var_dump($quizItems); 
```

这是在行动：[http ://codepad.org/lwOa7LNI](http://codepad.org/lwOa7LNI)

我的代码没有循环，我只是将代码复制了两次以进行说明。

**结果**

```
array(2) {
  [0]=>
  array(2) {
    ["question"]=>
    string(14) "What is a dog?"
    ["answers"]=>
    array(4) {
      [0]=>
      string(6) " A pet"
      [1]=>
      string(8) " A human"
      [2]=>
      string(8) " A house"
      [3]=>
      string(8) " A train"
    }
  }
  [1]=>
  array(2) {
    ["question"]=>
    string(14) "What is a car?"
    ["answers"]=>
    array(4) {
      [0]=>
      string(10) " A vehicle"
      [1]=>
      string(7) " A tool"
      [2]=>
      string(9) " A number"
      [3]=>
      string(9) " A person"
    }
  }
} 
```

**基本用法**

[http://codepad.org/4Zhr9Wje](http://codepad.org/4Zhr9Wje)

```
foreach ($quizItems as $quizItem){
    echo '<b>'.$quizItem['question'].'</b><br />'.
         implode('<br />', $quizItem['answers']);
} 
```

**输出**

> ```
> What is a dog?
>  A pet
>  A human
>  A house
>  A train
> 
> What is a car?
>  A vehicle
>  A tool
>  A number
>  A person 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T18:30:52.393

如果您在问题中有“，”，则此解决方案应该有效。这仅在您的答案没有问号时才有效。

```
$question = substr($line, 0, strpos($line, '?'));
str_replace($question, '', $line);
$answers = explode(',', $line);
$array[$i] = $question;
foreach($answers as $answer)
{
  $array[$i][] = $answer;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T18:31:16.343

你听说过[`fgetcsv`](http://php.net/fgetcsv)吗？:)

**例子：**

```
$file = fopen('data.txt', 'r');

$array = array();
while ($line = fgetcsv($file)) {
   $array[] = $line;
} 
```

**一些改进：**

这个：

```
$array[$i]=$line;
$i=$i + 1; 
```

……没用。它可能是：

```
$array[$i] = $line;
$i++; 
```

...或更好：

```
$array[$i++] = $line; 
```

...甚至更好（如我的示例）：

```
$array[] = $line; 
```

这里的使用`feof`也是多余的。`fread`,如果达到 EOF，则`fgets`已经`fgetcsv`返回。`false`

**输出：**

这是一个将其输出为 HTML 的代码示例：

```
foreach ($array as $q => $data) {
    echo '<p>'.array_shift($data).'</p>';
    echo '<ul>';
    foreach ($data as $a => $answer) {
        echo '<li>'.
             '  <input type="radio" name="question-'.$q.'" id="question-'.$q.'"'.
             '         value="'.$a.'"/>'.
             '  <label for="question-'.$q.'">'.$answer.'</label>'.
             '</li>';
    }
    echo '</ul>';
} 
```

# c# - 如何在 WCF 肥皂响应中实现安全令牌？

> ID：10234219
> 
> 赞同：4
> 
> 时间：2012-04-19T18:14:14.787
> 
> 标签：c#, wcf, security, soap, token

我正在实现银行的 API，他们需要提供安全令牌。在每条soap消息的标题中，都有如下内容：

```
<soapenv:Header>
  <tpw:BinarySecurityToken ValueType="MAC" Id="DesMacToken" EncodingType="Base64" Value="**xvz**"/>
</soapenv:Header> 
```

根据他们的文档，我需要在每条消息的正文上生成一个 8 字节的 MAC 值。MAC由CBC-MAC算法生成，DES作为分组密码。每个消息的soapenv:Body标签的内容被用作MAC计算的数据。

所以我的问题是如何让 WCF 做到这一点？我将以下代码放在一起创建 MAC 值，但不确定如何将其放入每条消息的标题中。

```
private string GenerateMAC(string SoapXML)
        {
            ASCIIEncoding encoding = new ASCIIEncoding();

            //Convert from Hex to Bin
            byte[] Key = StringToByteArray(HexKey);
            //Convert String to Bytes
            byte[] XML = encoding.GetBytes(SoapXML);

            //Perform the Mac goodies
            MACTripleDES DesMac = new MACTripleDES(Key);
            byte[] Mac = DesMac.ComputeHash(XML);

            //Base64 the Mac
            string Base64Mac = Convert.ToBase64String(Mac);

            return Base64Mac;
        }

        public static byte[] StringToByteArray(string Hex)
        {
            if (Hex.Length % 2 != 0)
            {
                throw new ArgumentException();
            }

            byte[] HexAsBin = new byte[Hex.Length / 2];
            for (int index = 0; index < HexAsBin.Length; index++)
            {
                string bytevalue = Hex.Substring(index * 2, 2);
                HexAsBin[index] = Convert.ToByte(bytevalue, 16);
            }

            return HexAsBin;
        } 
```

任何帮助将不胜感激。

**更多信息：** 银行提供了一个 WSDL，我将其用作服务参考。发送的响应示例：

```
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
[System.ServiceModel.MessageContractAttribute(WrapperName="LogonRequest", WrapperNamespace="http://webservice.com", IsWrapped=true)]
public partial class LogonRequest {

    [System.ServiceModel.MessageHeaderAttribute(Namespace="http://webservice.com")]
    public DataAccess.BankService.BinarySecurityToken BinarySecurityToken; 
```

BinarySecurityToken（位于标头中）如下所示：

```
 [System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "4.0.30319.233")]
    [System.SerializableAttribute()]
    [System.Diagnostics.DebuggerStepThroughAttribute()]
    [System.ComponentModel.DesignerCategoryAttribute("code")]
    [System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true, Namespace="http://webservice.com")]
    public partial class BinarySecurityToken : object, System.ComponentModel.INotifyPropertyChanged {

        private string valueTypeField;

        private string idField;

        private string encodingTypeField;

        private string valueField;

        public BinarySecurityToken() {
            this.valueTypeField = "MAC";
            this.idField = "DesMacToken";
            this.encodingTypeField = "Base64";
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T05:40:23.260

我最近不得不做这样的事情，我最终做的是创建一个行为，该行为实现`IClientMessageInspector`并使用该`BeforeSendRequest`方法为我的标头创建数据，然后将其填充到 SOAP 请求中。

```
public class SoapHeaderBehaviour : BehaviorExtensionElement, IClientMessageInspector
{
    public void AfterReceiveReply(ref Message reply, object correlationState) { }
    public object BeforeSendRequest(ref Message request, IClientChannel channel)
    { 
        var security = new Security();   // details irrelevant
        var messageHeader = MessageHeader.CreateHeader("Security", "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd", security, new ConcreteXmlObjectSerializer(typeof(Security)), true);
        request.Headers.Add(messageHeader);

        return null;
    }

    protected override object CreateBehavior() { return new SoapHeaderBehaviour(); }
    public override Type BehaviorType { get { return GetType(); } }
} 
```

ConcreteXmlObjectSerializer 是我在互联网上某个地方找到的一个类（不幸的是现在似乎找不到它），它刚刚起作用。这是代码：

```
public class ConcreteXmlObjectSerializer : XmlObjectSerializer
{
    readonly Type objectType;
    XmlSerializer serializer;

    public ConcreteXmlObjectSerializer(Type objectType)
        : this(objectType, null, null)
    {
    }

    public ConcreteXmlObjectSerializer(Type objectType, string wrapperName, string wrapperNamespace)
    {
        if (objectType == null)
            throw new ArgumentNullException("objectType");
        if ((wrapperName == null) != (wrapperNamespace == null))
            throw new ArgumentException("wrapperName and wrapperNamespace must be either both null or both non-null.");
        if (wrapperName == string.Empty)
            throw new ArgumentException("Cannot be the empty string.", "wrapperName");

        this.objectType = objectType;
        if (wrapperName != null)
        {
            XmlRootAttribute root = new XmlRootAttribute(wrapperName);
            root.Namespace = wrapperNamespace;
            this.serializer = new XmlSerializer(objectType, root);
        }
        else
            this.serializer = new XmlSerializer(objectType);
    }

    public override bool IsStartObject(XmlDictionaryReader reader)
    {
        throw new NotImplementedException();
    }

    public override object ReadObject(XmlDictionaryReader reader, bool verifyObjectName)
    {
        Debug.Assert(serializer != null);
        if (reader == null) throw new ArgumentNullException("reader");
        if (!verifyObjectName)
            throw new NotSupportedException();

        return serializer.Deserialize(reader);
    }

    public override void WriteStartObject(XmlDictionaryWriter writer, object graph)
    {
        throw new NotImplementedException();
    }

    public override void WriteObjectContent(XmlDictionaryWriter writer, object graph)
    {
        if (writer == null) throw new ArgumentNullException("writer");
        if (writer.WriteState != WriteState.Element)
            throw new SerializationException(string.Format("WriteState '{0}' not valid. Caller must write start element before serializing in contentOnly mode.",
                writer.WriteState));
        using (MemoryStream memoryStream = new MemoryStream())
        {
            using (XmlDictionaryWriter bufferWriter = XmlDictionaryWriter.CreateTextWriter(memoryStream, Encoding.UTF8))
            {
                serializer.Serialize(bufferWriter, graph);
                bufferWriter.Flush();
                memoryStream.Position = 0;
                using (XmlReader reader = new XmlTextReader(memoryStream))
                {
                    reader.MoveToContent();
                    writer.WriteAttributes(reader, false);
                    if (reader.Read()) // move off start node (we want to skip it)
                    {
                        while (reader.NodeType != XmlNodeType.EndElement) // also skip end node.
                            writer.WriteNode(reader, false); // this will take us to the start of the next child node, or the end node.
                        reader.ReadEndElement(); // not necessary, but clean
                    }
                }
            }
        }
    }

    public override void WriteEndObject(XmlDictionaryWriter writer)
    {
        throw new NotImplementedException();
    }

    public override void WriteObject(XmlDictionaryWriter writer, object graph)
    {
        Debug.Assert(serializer != null);
        if (writer == null) throw new ArgumentNullException("writer");
        serializer.Serialize(writer, graph);
    }
} 
```

然后通过配置文件分 3 步将其连接到 WCF 客户端端点（全部在`system.serviceModel`节点下：

注册扩展

```
<extensions>
  <behaviorExtensions>
    <add name="ClientSoapHeaderAdderBehaviour"
        type="MyNamespace.SoapHeaderBehaviour, MyAssembly, Version=My.Version, Culture=neutral, PublicKeyToken=null" />
  </behaviorExtensions>
</extensions> 
```

使用它创建端点行为

```
<behaviors>
  <endpointBehaviors>
    <behavior name="MyEndpointBehaviours">
      <ClientSoapHeaderAdderBehaviour />
    </behavior>
  </endpointBehaviors>
</behaviors> 
```

将您的端点行为附加到您的客户端端点

```
<client>
  <endpoint address="blah" binding="basicHttpBinding"
    bindingConfiguration="blah" contract="blah"
    name="blah"
    behaviorConfiguration="MyEndpointBehaviours"/>
</client> 
```

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T11:54:45.640

DavidJones 有正确的答案，但我想发布我的课程，以防其他人需要做类似的事情：

```
 public class SoapHeaderBehaviour : BehaviorExtensionElement, IClientMessageInspector, IEndpointBehavior
    {
        public void AfterReceiveReply(ref Message reply, object correlationState)
        {
        }

        public object BeforeSendRequest(ref Message request, IClientChannel channel)
        {
            try
            {
                // Get the request into an XDocument
                var memoryStream = new MemoryStream();

                var writer = XmlDictionaryWriter.CreateTextWriter(memoryStream);
                request.WriteMessage(writer);
                writer.Flush();
                memoryStream.Position = 0;
                var xmlDoc = new XmlDocument();
                xmlDoc.Load(memoryStream);

                // get the body tag
                XmlNode bodyNode = FindNode("body", xmlDoc);
                Debug.Assert(bodyNode != null, "Unable to find the BODY in the SOAP message");
                if (bodyNode != null)
                {
                    string MAC = GenerateMAC(bodyNode.InnerXml);

                    // replace the relevant item in the header
                    XmlNode tokenNode = FindNode("binarysecuritytoken", xmlDoc);
                    Debug.Assert(tokenNode != null, "Unable to find the BinarySecurityToken in the SOAP message");

                    if (tokenNode != null)
                    {
                        tokenNode.Attributes["Value"].Value = MAC;

                        // recreate the request
                        memoryStream = new MemoryStream();
                        writer = XmlDictionaryWriter.CreateTextWriter(memoryStream);
                        xmlDoc.WriteTo(writer);
                        writer.Flush();
                        memoryStream.Position = 0;
                        var reader = XmlDictionaryReader.CreateTextReader(memoryStream, XmlDictionaryReaderQuotas.Max);
                        var newRequest = Message.CreateMessage(reader, int.MaxValue, request.Version);
                        request = newRequest;
                    }
                }
            }
            catch (Exception ex)
            {
            }

            return null;
        }

        private XmlNode FindNode(string name, XmlDocument xmlDoc)
        {
            XmlNode node = null;
            for (int i = 0; i < xmlDoc.ChildNodes.Count; i++)
            {
                node = FindNode(name, xmlDoc.ChildNodes[i]);
                if (node != null)
                    break;
            }

            return node;
        }

        private XmlNode FindNode(string name, XmlNode parentNode)
        {
            if (parentNode != null && parentNode.Name.ToLower().Contains(name))
            {
                return parentNode;
            }

            XmlNode childNode = null;
            for (int i = 0; i < parentNode.ChildNodes.Count; i++)
            {
                childNode = FindNode(name, parentNode.ChildNodes[i]);
                if (childNode != null)
                    break;
            }

            return childNode;
        }

        private string GenerateMAC(string soapXML)
        {
            // get the key from the web.config file
            var key = ConfigurationManager.AppSettings["Key"];

            ASCIIEncoding encoding = new ASCIIEncoding();

            //Convert from Hex to Bin
            byte[] keyBytes = StringToByteArray(key);
            //Convert String to Bytes
            byte[] xmlBytes = encoding.GetBytes(soapXML);

            //Perform the Mac goodies
            MACTripleDES desMac = new MACTripleDES(keyBytes);
            byte[] macBytes = desMac.ComputeHash(xmlBytes);

            //Base64 the Mac
            string base64Mac = Convert.ToBase64String(macBytes);
            return base64Mac;
        }

        private static byte[] StringToByteArray(string hex)
        {
            if (hex.Length % 2 != 0)
            {
                throw new ArgumentException();
            }

            byte[] hexBytes = new byte[hex.Length / 2];
            for (int index = 0; index < hexBytes.Length; index++)
            {
                string bytevalue = hex.Substring(index * 2, 2);
                hexBytes[index] = Convert.ToByte(bytevalue, 16);
            }

            return hexBytes;
        }

        protected override object CreateBehavior()
        {
            return new SoapHeaderBehaviour();
        }

        public override Type BehaviorType
        {
            get
            {
                return GetType();
            }
        }

        public void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)
        {
        }

        public void ApplyClientBehavior(ServiceEndpoint serviceEndpoint, ClientRuntime behavior)
        {
            behavior.MessageInspectors.Add(this);
            // behavior.MessageInspectors.Add(new FaultMessageInspector());
        }

        public void ApplyDispatchBehavior(ServiceEndpoint serviceEndpoint, EndpointDispatcher endpointDispatcher)
        {
        }

        public void Validate(ServiceEndpoint serviceEndpoint)
        {
        }
    } 
```

# svn - CVS 到 SVN 的迁移和分支内的分支

> ID：10234223
> 
> 赞同：1
> 
> 时间：2012-04-19T18:14:25.800
> 
> 标签：svn, branch, cvs2svn, tortoisecvs

我最近使用 cvs2svn 工具从 CVS 迁移到 SVN。在我的一个项目的新迁移项目中，最新版本是分支 A（父目录）的一部分。在这个项目中，我有一个子项目，它的最新版本是另一个分支，比如分支 B。所以基本上主干没有我的主项目的最新版本。

因此，在 CVS 中，一旦我签出我的父文件夹（分支 A），我将浏览到我的子项目 > 右键单击​​ > CVS > 更新特殊 > 选择分支 B（因为分支 B 具有子项目的最新版本）。这将检查子项目的最新版本，我将拥有我的主项目的最新版本。

然而，在 SVN 中，我没有看到这个选项。据我所知，SVN 只能使用修订版而不是分支进行更新。我是 SVN 的新手，所以我错的可能性更大。有没有办法做我在 CVS 场景中尝试做的事情？

我想出了一个检查主项目（A 分支）然后分别检查子项目（B 分支）的方法。然后我会从第一个结帐（父项目-Branch A）中删除这个子项目，并用子项目的第二个结帐版本替换它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:17:05.970

您可以使用[svn externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html)来实现您的目标。该子项目将是另一个回购的外部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T20:56:11.557

听起来您正在尝试进行稀疏分支。在稀疏分支中，您有一个分支作为您的基础（我们称为*Branch A*），而在另一个分支上（我们称为*Branch B*），您只放置来自*Branch A*的更改，而不是整个分支。

这有时在 CVS 中完成，因为分支需要很长时间才能完成。我们发现小型项目需要 20 分钟，大型项目则需要一个小时。但是，它最终很难跟踪，而且我发现使用它的网站往往会忘记结帐的方式。持续构建系统也无法处理 CVS 稀疏分支设置。

Subversion 不做稀疏分支（至少很容易），但 Subversion 中的分支快速且简单。创建一个分支只需不到一秒钟。在 Subversion 中，您应该选择*Branch A* ，并从*Branch* A中创建*Branch B*。*然后，将Branch A*和*Branch B*之间的所有差异放到*Branch A*上。对*分支 A 的*更改必须定期合并到分支*B。*

 ***稀疏分支的问题是，如果一个文件在两个分支上都发生了变化，它就永远不会被拾取。通过合并，两个分支上的更改将添加到*Branch B*上的文件中。这就是为什么很少有网站做稀疏分支的原因。

您需要从*Branch A创建一个新的**Branch B*，然后将旧*Branch B*上的所有更改到这个新的*Branch B*并签入。然后，Branch B 将包含它需要的所有文件，您可以使用持续集成系统，签入和签出文件是一步操作。***

# android - 光标异常

> ID：10234224
> 
> 赞同：0
> 
> 时间：2012-04-19T18:14:27.657
> 
> 标签：android

我创建了一个数据库，我想通过使用游标从数据库中检索一些数据，但我总是收到此错误

```
04-19 20:02:56.747: E/AndroidRuntime(301): android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 1
04-19 20:02:56.747: E/AndroidRuntime(301):  at android.database.AbstractCursor.checkPosition(AbstractCursor.java:580)
04-19 20:02:56.747: E/AndroidRuntime(301):  at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:214)
04-19 20:02:56.747: E/AndroidRuntime(301):  at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:41) 
```

这是函数的代码

```
public double getlatitude(String[] i,int x) {
        // TODO Auto-generated method stub
        String[] columns = new String[] { KEY_SQUAREID, KEY_SQUARELATITUDE, KEY_SQUARENAME,
                KEY_SQUARELONGITUDE
                 };

    Cursor c;
      c=ourDatabase.query("squares", columns,"squarename=?",i, null, null, null);

      String latitude = null;
        if (c.moveToFirst()) {
             latitude=c.getString(0);
        }

        double latitude_double=Double.parseDouble(latitude);
        return latitude_double;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:17:57.100

试试这个

```
if(c.getCount() > 0) {
   c.moveToFirst();
   for(int i=0;i<c.getCount();i++) {
     //do your logic here
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:19:41.837

我认为问题出在这里：

```
latitude=c.getString(0); 
```

将其更改为：

```
latitude = c.getString(c.getColumnIndex("column_name")); 
```

并且不要忘记在通过调用返回值之前关闭光标`c.close();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:24:03.913

发生异常可能是因为您的光标为空（可能没有匹配项）。为避免这种情况，请确保检查光标是否为空，如果为空，则不应尝试访问它。如果它不为空，您应该检查最大行数并确保您不会访问任何等于或高于最大行数的行。请看下面的代码：

```
if ( c != null && c.getCount() > 0 ) {
    if (c.moveToFirst()) {
        do {

            // do something here

        } while (c.moveToNext());
    }
    c.close();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T18:32:46.510

每当您处理游标时，如果您想避免将来出现奇怪的崩溃，请务必检查 null 并检查 moveToFirst() 是否失败。

```
if( c != null ){
    if( c.moveToFirst() ){
        //Do your stuff
    }
}

//After finishing always close the cursor.
c.close(); 
```

# jsp - 从复选框中检索多个值

> ID：10234225
> 
> 赞同：0
> 
> 时间：2012-04-19T18:14:28.567
> 
> 标签：jsp, jdbc, struts-1

我想使用复选框来更新数据库中的多个值，同时使用单个查询提前java。我正在使用这段代码：

```
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
        <link href="../../css/style.css" rel="stylesheet" type="text/css">
    </head>
    <body>
        <html:form action="viewappnt">
            <table align="left" valign="top" width="295" border="0" id="box-table-b" >
                <thead><tr align="center">
                        <th colspan="4" nowrap><bean:message key="viewapp.heading"/></th>
                    </tr></thead>
                    <%
                        regForm reg = (regForm) session.getAttribute("reg");
                        reg.getspec();
                        String sql = "Select * from appointment where specs=?";
                        ArrayList alist = new ArrayList();
                        alist.add(reg.getSpecs());
                        ResultSet rs = SQLC.getData(sql, alist);
                        int t = 0;
                        while (rs.next()) {
                            String userid = rs.getString("userid");
                            String appdate = rs.getString("appdate");
                            String apptime = rs.getString("apptime");

                    %>
                <td nowrap ><html:text property="appuserid" value="<%=userid%>" size="3" readonly="true" styleId="htmltext"/></td>
                <td width="106"><html:text property="appdate" value="<%=appdate%>" size="5"/></td><td width="80">
                    <html:text property="apptime" value="<%=apptime%>" size="5"/></td>  
                <td><html:checkbox property="apppat"  value="<%=userid%>"></html:checkbox></td>
            </tr> 
            <%
                    t = t++;
                }
            %>
            <tr>
                <td colspan="4" align="center" valign="middle" nowrap><html:submit property="method"><bean:message key="UserForm.apppat"/></html:submit></td>
            </tr>
        </table>
    </html:form> 
```

我不知道如何通过这个对多个值使用更新命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:22:56.783

```
public StringBuffer appointPatient() throws ClassNotFoundException, SQLException {
    StringBuffer sb = new StringBuffer();
    String st[] = this.apppat;
    String st1[] = this.appdate;
    String st2[] = this.apptime;
    for (int i = 0; i < st.length; i++) {
        String sql = "update appointment set appdate=? , apptime=?, docuserid=? where userid=? and specs=?";
        ArrayList alist = new ArrayList();
        alist.add(st1[i]);
        alist.add(st2[i]);
        alist.add(this.userid);
        alist.add(st[i]);
        alist.add(this.specs);
        try {
            int rows = SQLC.ins_up_delete(sql, alist);
            if (rows > 0) {
                sb.append("Registration Success");
            } 
```

# c++ - 有什么方法可以创建一个可以作为参数传递的 16 字节对齐的类

> ID：10234227
> 
> 赞同：3
> 
> 时间：2012-04-19T18:14:32.313
> 
> 标签：c++, windows, sse

我们有一个（数字 3 浮点数）向量类，我希望将其对齐到 16 字节以允许 SIMD 操作。使用 declspec 进行 16 字节对齐会导致大量 C2719 错误（参数'：带有 __declspec(align('#')) 的形式参数不会对齐）。如果我不能传递一个对齐的向量，那有什么意义呢？即使使用对向量的 const 引用也会导致编译器错误，这真的让我很恼火。

有没有办法在这里做我想做的事 - 获得 16 字节的类对齐，同时允许结构传递，而不必对 __m128 类型做一些愚蠢的把戏？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T18:46:02.983

除非您一次对一堆这些 3 维向量结构进行操作，否则您不太可能从使用 SIMD 中获得太多好处，在这种情况下，您可能会将它们传递到一个数组中，您可以将其对齐为你需要。另一种可能从 SIMD 中获得好处的情况是，如果您对每个向量进行大量计算，并且可以并行化三个通道上的操作。在这种情况下，然后在函数的开头进行一些手动操作以将其转化为`__m128`类型可能仍然会给您带来一些好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T19:43:37.040

> 如果我不能传递一个对齐的向量，那有什么意义呢？

`__declspec(align(#))`似乎相当无用。C++11 支持你想要的；`alignas`似乎以所有`__declspec(align(#))`被破坏的方式工作。例如，`alignas`用于声明您的类型将导致该类型的参数对齐。

不幸的是，微软的编译器还不支持标准对齐说明符，而我所知道的唯一编译器是 Clang，它对 Windows 的支持有限。

无论如何，我只是想指出 C++ 有这个特性，它最终可能会提供给你。除非您可以移动到另一个平台，否则现在您最好不要按值传递参数，正如其他人提到的那样

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T18:50:23.850

当然，您不需要按值传递数组吗？而是传递一个指向 16 字节对齐数组的指针。还是我误解了什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T01:31:19.813

Xbox360 支持 __declspec(passinreg)，但目前 Visual Studio for Windows 不支持。

您可以在此处投票支持该功能的请求： [http ://connect.microsoft.com/VisualStudio/feedback/details/381542/supporting-declspec-passinreg-in-windows](http://connect.microsoft.com/VisualStudio/feedback/details/381542/supporting-declspec-passinreg-in-windows)

对于我们引擎中的向量参数，我们使用`VectorParameter`typedef'ed`const Vector`或`const Vector&`取决于平台是否支持通过寄存器传递。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-19T09:52:13.723

虽然这个问题很老，但 VC++ 编译器的情况并没有太大变化，所以也许这些笔记对某人有价值。1) 允许将带有 __declspec(align(X)) 的类或结构传递给函数的简单修复方法是通过引用传递。根据需要使用 const。2) 使用 SIMD 进行向量代数肯定是有原因的。通过将 quat multiply 和 quat rotate 函数切换为 SIMD，我能够将引擎中的动画和蒙皮传递速度提高 20%。没有对齐，没有数组。只有两个采用 float[4] 参数的函数。对于一开始写得不错并导致可衡量的 FPS 改进的东西，这没什么好打喷嚏的。而且由于这些是以后很难优化的东西，因此实际上不存在向量代数的过早优化之类的东西。3) 如果你把你的向量变成一个类，堆栈上所有多余的 _mm_store_ps 和 _mm_load_ps 指令都在 /O2 下优化。因此，虽然通过 SIMD 进行单个添加的收益可能可以忽略不计，但如果您有背靠背运行多个操作的情况，则生成的代码非常快。

# json - Spring 是否支持 JSON 配置？

> ID：10234234
> 
> 赞同：12
> 
> 时间：2012-04-19T18:14:48.630
> 
> 标签：json, spring, applicationcontext

有谁知道 Spring 是否有任何扩展允许通过 JSON（或任何其他格式）而不是 XML 配置其 ApplicationContext？我在官方文档中找不到任何内容，但我想知道是否有任何其他开源扩展可以允许这样做。

为了清楚起见，我不是在谈论配置 SpringMVC 以设置基于 RESTful JSON 的 Web 服务或类似的东西，只要可以通过 JSON 而不是 XML 进行 Spring 应用程序配置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T18:53:59.273

据我所知，没有项目支持 JSON 作为配置源。启动起来应该比较容易，（Spring 容器不依赖 XML，它只是构造 bean 定义的一种方式）。然而，这比你想象的要多得多。

请注意，Spring 提供了[xml-schema](/questions/tagged/xml-schema "显示标记为“xml-schema”的问题")来帮助您编写正确的 XML。在 JSON 中你不会得到那么多。许多 DSL 也建立在 Spring XML 和自定义命名空间支持之上（[spring-integration](/questions/tagged/spring-integration "显示标记为“弹簧集成”的问题")、[mule-esb](/questions/tagged/mule-esb "显示标记为“mule-esb”的问题")和其他人使用它）。

如果你讨厌 XML（很多人讨厌），试试 Java Configuration，它从 3.0 开始可用，并在 3.1 中得到了改进：

```
@Configuration
public class MyBeans {

    @Bean
    public Foo foo() {
        return new Foo();
    }

    @Bean
    public Bar bar() {
        return new Bar(foo());
    }

    @Bean
    public Buzz buzz() {
        Buzz buzz = new Buzz();
        buzz.setFoo(foo());
        return buzz;
    }

} 
```

有趣的事实：由于一些花哨的代理，`foo()`这里只调用了一次，即使引用了两次。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-04-07T05:59:16.767

试试maven Central 上的[JSConf](https://github.com/yyvess/jsconf)库，它支持 Properties、HOCON 和 JSON 格式。

您可以将外部文件中的值注入您的服务等等！

JavaConfig 的示例用法：

您存储在文件*app.conf中的数据*

```
{ 
"root":{
"simpleConf":{
    "url":"Hello World",
    "port":12,
    "aMap":{
        "key1":"value1",
        "key2":"value2"
    },
    "aList":[
        "value1",
        "value2"
    ]
}} 
```

您在必须注入配置的地方提供服务

```
@Service("service")
public class Service {
    @Autowired
    private ConfigBean configBean;
} 
```

声明一个接口以从您的服务访问您的配置值

```
@ConfigurationProperties("root/simpleConf")
public interface ConfigBean {
    String getUrl();
    int getPort();
    Map getAMap();
    List getAList();
} 
```

还有你的 Spring 配置 bean：

```
@Configuration
public class ContextConfiguration {
    @Bean
    public static ConfigurationFactory configurationFactory() {
        return new ConfigurationFactory().withResourceName("app.conf") //
                .withScanPackage("org.jsconf.core.sample.bean");
    }
} 
```

# linq - 在循环中设置 LINQ 查询中的 where 子句始终执行设置的最后一个 where 子句

> ID：10234235
> 
> 赞同：0
> 
> 时间：2012-04-19T18:14:48.800
> 
> 标签：linq, dynamic, foreach, predicate

所以我有一堆 UltraTreeNodes。我正在尝试遍历它们并将 LINQ 查询分配给 Tag 属性，该属性将在稍后用户单击节点时执行。对每个节点的查询唯一改变的是 where 子句中的变量。但是，当单击节点并最终从标记执行查询时，它始终使用在 foreach 循环中最后分配的查询（并且是 where 变量）。

它的行为是否因为所有标签都引用相同的查询，因此变量被一遍又一遍地分配给相同的地方？有没有办法避免这种行为而不必动态创建谓词并将其传递？

**更新**- 对不起，这里是代码：

```
var query = from result in results
                    where result.SchedulingStatus != SchedulerRunStatus.Scheduled 
                    group result by result.UserId into users
                    select new {users.Key, Count = users.Count()};

        foreach (var user in query)
        {
            UltraTreeNode efdUserNode = new UltraTreeNode();
            efdUserNode.Text = user.Key + " (" + user.Count + ")";
            efdUserNode.Key = user.Key;
            IEnumerable<DownloadResultSummary> nodeQuery = from result in efdDetail.DownloadResultSummaries
                              where
                                  result.SchedulingStatus != SchedulerRunStatus.Scheduled &
                                  result.UserId == user.Key
                              select result;

            efdUserNode.Tag = nodeQuery;

            efdUserNode.Override.NodeAppearance.Image = Properties.Resources.user;
            this.efdNode.Nodes.Add(efdUserNode);
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:20:19.737

> 它总是使用在 foreach 循环中最后分配的查询（它是 where 变量）。

您很~~可能会~~关闭循环变量-因为您的查询仅在稍后执行，它将采用当时变量的值*-*这是最后分配的值。

在循环内制作循环变量的本地副本`foreach`：

```
foreach (var user in query)
{
   User localUser = user;
   //use localUser now instead
   //..
} 
```

您关闭循环变量的部分在这里：

```
 where result.SchedulingStatus != SchedulerRunStatus.Scheduled 
         && result.UserId == user.Key
        select result; 
```

将其替换为：

```
 where result.SchedulingStatus != SchedulerRunStatus.Scheduled 
         && result.UserId == localUser.Key
        select result; 
```

有关更多详细信息，请参阅[“关闭被认为有害的循环变量”](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)

# ruby-on-rails - 仅当对客户端的响应成功时，如何在 Rails 中执行某些操作？

> ID：10234238
> 
> 赞同：0
> 
> 时间：2012-04-19T18:15:02.647
> 
> 标签：ruby-on-rails

我想要一个操作来格式化响应，响应客户端，然后仅当客户端设法接收响应时才将某些内容提交到数据库。根据我对 after_filters 的了解，它们只在响应发送到客户端之前拦截响应。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:41:51.797

据我所知，除了指示客户端发送附加请求（例如使用javascript）之外，没有可靠的方法来确认客户端在应用程序级别接收到消息。

我不会依赖客户端接收您的 200 消息，而是将与 API 的成功交易列表放在 API 的其他位置，以便客户端可以主动访问该列表以验证交易是否通过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:46:07.540

我认为这是一件合理的事情，尽管有其他评论员。我确实同意他编写发送确认的 javascript 的方法。

我不会让事务打开那么久，所以我建议使用暂定标志保存数据，然后当你得到确认时，将数据标记为已确认。

# clojure - 如何实现第 n 个可变数量的索引

> ID：10234249
> 
> 赞同：1
> 
> 时间：2012-04-19T18:15:33.933
> 
> 标签：clojure

我的问题是如何在编译时不知道有多少的情况下从序列中提取多个元素。想到了使用 partial，但我一直难以提取元素而不是序列。

我想实现下面交错生成的序列，但不需要以有限数量的映射形式进行编码。

```
(def s1 [[:000-00-0000 "TYPE 1" "JACKSON" "FRED"]
         [:000-00-0001 "TYPE 2" "SIMPSON" "HOMER"]
         [:000-00-0002 "TYPE 4" "SMITH" "SUSAN"]])

(interleave (map #(nth % 0 nil) s1) 
            (map #(nth % 2 nil) s1) 
            (map #(nth % 3 nil) s1))

(:000-00-0000 "JACKSON" "FRED" 
 :000-00-0001 "SIMPSON" "HOMER" 
 :000-00-0002 "SMITH" "SUSAN") 
```

如果我执行以下操作

```
(def cols [0 2 3])

(defn f1
    [s1 col]
    (nth s1 col nil))

(map (partial f1 s1) cols) 
```

我明白了

```
([:000-00-0000 "TYPE 1" "JACKSON" "FRED"]\
 [:000-00-0002 "TYPE 4" "SMITH" "SUSAN"] nil) 
```

我相信我知道为什么会这样。cols 参数的作用类似于序列选择器，而不是序列中的元素选择器。我想从每个序列中提取几个元素。如何从每个序列中提取元素？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:26:48.580

您可以使用该`get-in`函数访问嵌套的数据结构，如下所示：

```
(def cols [0 2 3])

(defn f1 
  [s1 col] 
  (map #(get-in s1 [% col] nil) (range (count s1))))

(apply interleave (map (partial f1 s1) cols))

(:000-00-0000 "JACKSON" "FRED" 
 :000-00-0001 "SIMPSON" "HOMER" 
 :000-00-0002 "SMITH" "SUSAN") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T14:17:16.743

`for`您可以使用and更简洁地执行此操作`partition`：

```
user> (defn get-cols [s cols] (partition (count cols) (for [ws s c cols] (ws c))))
#'user/get-cols
user> (get-cols [[:000-00-0000 "TYPE 1" "JACKSON" "FRED"]
            [:000-00-0001 "TYPE 2" "SIMPSON" "HOMER"]
            [:000-00-0002 "TYPE 4" "SMITH" "SUSAN"]]
            [0 2 3])
((:000-00-0000 "JACKSON" "FRED") (:000-00-0001 "SIMPSON" "HOMER") (:000-00-0002 "SMITH" "SUSAN")) 
```

这也将保留原始分组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:28:59.270

我会这样做：

```
(apply concat (map (juxt first #(nth % 2) #(nth % 3)) s1)) 
```

这首先将 s1 中的列收集到中间向量中，然后将这些向量展平一层，从而得到结果。

这里有两个非常方便的功能：

*   “apply concat”类似于“flatten”，但只有一层深

*   juxt 返回一个函数 A，它将传递给 juxt 的参数（必须是函数）应用于传递给 A 的值并返回结果向量。

# sql-server - 如何在 SQL 2008 R2 中记录警告（低严重性错误）

> ID：10234252
> 
> 赞同：0
> 
> 时间：2012-04-19T18:15:40.207
> 
> 标签：sql-server, tsql, logging, error-handling, warnings

我想记录从我的 Transact SQL 脚本中抛出的警告，这些警告不会被 TRY...CATCH 块捕获。有没有办法做到这一点？ERROR_NUMBER() 等不会在 catch 块之外工作，我不确定如何知道是否知道抛出了警告。谷歌搜索收效甚微。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:22:22.330

该[文档](http://msdn.microsoft.com/en-us/library/ms175976.aspx)似乎打算将错误消息传递给调用者。但是，它也确实指出，如果您将语句包装在存储过程中，然后在 try-catch 块中调用该语句，您将捕获低严重性错误。

```
-- Verify that the stored procedure does not exist.
IF OBJECT_ID ( N'usp_ExampleProc', N'P' ) IS NOT NULL 
    DROP PROCEDURE usp_ExampleProc;
GO

-- Create a stored procedure that will cause an 
-- object resolution error.
CREATE PROCEDURE usp_ExampleProc
AS
    SELECT * FROM NonexistentTable;
GO

BEGIN TRY
    EXECUTE usp_ExampleProc;
END TRY
BEGIN CATCH
    SELECT 
        ERROR_NUMBER() AS ErrorNumber
        ,ERROR_MESSAGE() AS ErrorMessage;
END CATCH; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-09T22:21:27.100

即使您将其包装在 proc 中并尝试，您也无法使用 try catch 捕获这些错误。这是一个例子。

```
CREATE PROC P
AS 
BEGIN
    RAISERROR('TEST',9,-1,-1)
END;

BEGIN TRY
    EXEC P
END TRY
BEGIN CATCH
    PRINT 'CAUGHT'
END CATCH; 
```

# tfs - 如何以编程方式确定 Team Foundation Server 的版本？

> ID：10234253
> 
> 赞同：1
> 
> 时间：2012-04-19T18:16:04.010
> 
> 标签：tfs, tfs-sdk

我正在开发一种适用于 TFS2010 和 TFS11 的工具。但是，有一些特定于 TFS11 的功能，所以我想在连接到运行 TFS2010 的服务器时禁用它们。

有没有办法通过 TFS API 检索 Team Foundation Server 的版本？[我在MSDN](http://msdn.microsoft.com/en-us/library/bb130146.aspx#ServerObjectModel)上的对象模型中没有找到任何东西。

我发现这篇[博客文章](http://blog.johnsworkshop.net/programmatically-detect-your-team-foundation-server-version/)很有趣，但不是一个合理的解决方案，因为它需要使用 TFS11 对象模型，并且完全可以使用 TFS2010 对象模型连接到 TFS11 服务器。

# extjs - Extjs htmleditor 获取光标位置

> ID：10234254
> 
> 赞同：2
> 
> 时间：2012-04-19T18:16:06.493
> 
> 标签：extjs

{

```
 xtype: 'htmleditor',
        name: 'msg',
        value : 'abcd',
        id: 'myeditor',
        listeners: {
            afterrender: function(t2){  
                var but = Ext.create('Ext.Button', {
                    text: 'Click me',
                    handler: function() {
                        Ext.getCmp('myeditor').insertAtCursor('bbbb');                      
                    }
                });

                t2.getToolbar().add(but)
            }
        }
    } 
```

如果光标不在 html 编辑器中，我不会在 'abcd' 的末尾插入 'bbbb' ，如果光标在编辑器中的任何位置都不会在光标点插入 'bbbb'。你能帮我做这件事吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T22:52:12.807

我已经使用了这个解决方法：

```
var before = Ext.getCmp('yourHtmlEditor').getValue();
Ext.getCmp('yourHtmlEditor').insertAtCursor('something');
var after = Ext.getCmp('noteEditor').getValue();
if (before==after) {       
    Ext.getCmp('yourHtmlEditor').setValue(before+'something');
} 
```

# java - Android Intent 不会发送值

> ID：10234257
> 
> 赞同：1
> 
> 时间：2012-04-19T18:16:24.400
> 
> 标签：java, android, android-intent, menu

我读取数据，然后在选择一个时创建具有两个可能选项的菜单，它会打开新的意图并显示数据。但正如我所见，它不会发送 courseName 值。问题在于 onCreateOptionsMenu 和 onOptionsItemSelected 方法，因为它们不会从主 onCreate 方法获得课程值。你能帮助我并告诉我如何解决它吗？

```
 String courseName = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.single_course_layout);

    Intent in = getIntent();
    courseName = in.getStringExtra("fullname");

    TextView label = (TextView)findViewById(R.id.label);
    label.setText(courseName);
    String summary = null;
    TextView summaryContent = (TextView)findViewById(R.id.summary);

    ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    nameValuePairs.add(new BasicNameValuePair("cname",""+courseName));
    InputStream is = null; 
    String result = null;
    try{
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://ik.su.lt/~jbarzelis/Bdarbas/getCourseSummary.php");
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
            is = entity.getContent();
    }catch(Exception e){
            Log.e("log_tag", "Error in http connection "+e.toString());
    }
    try{
            BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
                    System.out.println(line);
            }
            is.close();

            result=sb.toString();
    }catch(Exception e){
            Log.e("log_tag", "Error converting result "+e.toString());
    }

try{
    JSONArray jArray = new JSONArray(result);
    for(int ii=0;ii<jArray.length();ii++){
            JSONObject json_data = jArray.getJSONObject(ii);
            summary = json_data.getString("summary");
     }
    summaryContent.setText(summary);
} catch(JSONException e){
    Log.e("log_tag", "Error parsing data "+e.toString());
}

};

public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu, menu);
    return true;
};
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case R.id.users:     

            Intent in = new Intent(getApplicationContext(), AllCourseUsers.class);
            in.putExtra(courseName, "courseName");
            startActivity(in);
            break;

        case R.id.data:     Toast.makeText(this, "You will see data list!", Toast.LENGTH_LONG).show();
                            break;
         }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:20:04.007

您正在将价值观倒退到您的意图中

```
in.putExtra(courseName, "courseName"); 
```

应该

```
in.putExtra(key, value);

in.putExtra("courseName", courseName); 
```

# java - Java 连接字符串、整数和浮点数的最快方法

> ID：10234260
> 
> 赞同：6
> 
> 时间：2012-04-19T18:16:26.423
> 
> 标签：java, string-concatenation

从字符串、整数和浮点数构建字符串的最高效方法是什么？目前我正在这样做，它使用了大量的 cpu 时间。

```
String frame = this.frameTime + ":" +
    this.player.vertices[0].x + "," +
    this.player.vertices[0].y + "," +
    this.player.activeAnimId + "," +
    (int)this.player.virtualSpeed + "," +
    this.map.getCurrentTime() + 
    (this.player.frameSound == -1 ? "" : "," + this.player.frameSound) +
    (this.player.frameDecal.equals("") ? "" : "," + this.player.frameDecal) +
    ";"; 
```

有没有办法更快地做到这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-19T18:18:23.490

那应该已经很快了——它将在`StringBuilder`内部用于连接。可以说，显式使用`StringBuilder`可以消除空字符串的连接，但这不太可能产生很大的不同。

无论如何，你多久这样做一次？它必须经常，因为它是一个瓶颈......你真的*需要*经常这样做吗？

编辑：对于那些说“使用 StringBuilder，它会更快”的人 - 考虑这段代码：

```
public class Test
{
    public static void main(String[] args)
    {
        int x = 10;
        int y = 20;
        int z = 30;
        String foo = x + "," + y + "," + z + ";";
        System.out.println(foo);
    }
} 
```

编译它，然后用它`javap -c`来查看编译器生成了什么......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T18:18:34.187

使用`StringBuilder`.

```
String string = new StringBuilder("abcd").append(23).append(false).append("xyz").toString(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T18:18:12.560

您可以尝试使用`StringBuilder`.

（但是，大多数值得一提的 Java 编译器都会自动优化您列出的代码，以便`StringBuilder`在幕后使用。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T18:28:49.047

如果你想让它跑得非常快，你可以试试我的库，它允许你在一微秒内记录消息而不会产生任何垃圾。[https://github.com/peter-lawrey/Java-Chronicle](https://github.com/peter-lawrey/Java-Chronicle)

（正如我所说，它可能超出你想要的）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-27T17:13:58.130

下面的 concat3 方法对我来说效果最快，concat1 的性能取决于 jvm 实现/优化，它可能在其他版本的 JVM 中表现更好，但在我测试的 windows 机器和远程 linux red hat 机器上显示 concat3 运行速度最快..

```
public class StringConcat {

public static void main(String[] args) {
    int run = 100 * 1000 * 1000;
    long startTime, total = 0;

    final String a = "aafswerg";
    final String b = "assdfsaf";
    final String c = "aasfasfsaf";
    final String d = "afafafdaa";
    final String e = "afdassadf";

    startTime = System.currentTimeMillis();
    concat1(run, a, b, c, d, e);
    total = System.currentTimeMillis() - startTime;
    System.out.println(total);

    startTime = System.currentTimeMillis();
    concat2(run, a, b, c, d, e);
    total = System.currentTimeMillis() - startTime;
    System.out.println(total);

    startTime = System.currentTimeMillis();
    concat3(run, a, b, c, d, e);
    total = System.currentTimeMillis() - startTime;
    System.out.println(total);
}

private static void concat3(int run, String a, String b, String c, String d, String e) {
    for (int i = 0; i < run; i++) {
        String str = new StringBuilder(a.length() + b.length() + c.length() + d.length() + e.length()).append(a)
                .append(b).append(c).append(d).append(e).toString();
    }
}

private static void concat2(int run, String a, String b, String c, String d, String e) {
    for (int i = 0; i < run; i++) {
        String str = new StringBuilder(a).append(b).append(c).append(d).append(e).toString();
    }
}

private static void concat1(int run, String a, String b, String c, String d, String e) {
    for (int i = 0; i < run; i++) {
        String str = a + b + c + d + e;
    }
}
} 
```

# iphone - 带 GCD 的读写锁

> ID：10234261
> 
> 赞同：10
> 
> 时间：2012-04-19T18:16:28.437
> 
> 标签：iphone, objective-c, multithreading, locking, grand-central-dispatch

我的应用程序大量使用了 GCD，几乎所有内容都被拆分为由调度处理的小任务。但是，底层数据模型大部分是读取的，只是偶尔写入。

我目前使用锁来防止在阅读时更改关键数据结构。但是今天在查看锁之后，我发现了 NSConditionLock 和一些关于读写锁的页面。后者正是我所需要的。

我找到了这个实现：[http](http://cocoaheads.byu.edu/wiki/locks) ://cocoaheads.byu.edu/wiki/locks 。我的问题是，这个实现是否可以与 GCD 一起使用，因为它使用 PThreads？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-19T18:52:21.363

它仍然可以工作。pthreads 是 Mac OS X 上所有其他线程使用 API 的基础线程 API。（在此之下有 Mach 线程激活，但那是 SPI，而不是 API。）无论如何，pthreads 锁并不真正要求您使用 pthreads线程。

**但是**，从 iOS 5 开始，GCD 提供了更好的选择：`dispatch_barrier_async()`. 基本上，您有一个私有并发队列。您以正常方式向它提交所有读取操作。您使用屏障例程向它提交写操作。达达！读写锁定。

如果您可以访问[WWDC 2011 会议视频 Session 210 - Mastering Grand Central Dispatch，](https://developer.apple.com/videos/wwdc/2011/?id=210)您可以了解更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T08:35:07.530

您可能还需要考虑为所有读/写操作维护一个串行队列。然后，您可以`dispatch_sync()`写入该队列以确保及时应用对数据模型的更改以及`dispatch_async()`所有读取以确保您在应用程序中保持良好的性能。

由于您有一个串行队列，所有读取和写入都发生在该队列上，因此您可以确保在写入期间不会发生读取。这比锁的成本要低得多，但这意味着您不能同时执行多个“读取”操作。这不太可能对大多数应用程序造成问题。

使用`dispatch_barrier_async()`可能意味着您进行的写入需要花费任意时间才能实际提交，因为队列中的所有预先存在的任务都必须在您的屏障块执行之前完成。

# iphone - 第一次开发人员：设置我的 iPhone 应用程序以存储/获取上传的用户生成数据的最佳方式？

> ID：10234267
> 
> 赞同：0
> 
> 时间：2012-04-19T18:16:36.843
> 
> 标签：iphone

我是开发 iPhone 应用程序的新手，我想确保我在进行编码过程时奠定了正确的基础。我正在开发的应用程序将允许用户登录，从他们的 iPhone 上传照片，为图片写一个简短的描述，以及查看其他用户的照片。我应该在哪里存储以下数据，应该如何构建？我听说过core data, sqlite, MySQL, PostgreSQL, etc... 我需要捕获和存储的数据是： -用户名 -密码 -他们上传的照片 -照片的描述

理想情况下，该架构将支持数十万用户上传的图像（假设）。

我知道这个问题在某些层面上可能非常基础，但同样，这是我第一次浏览 iPhone 应用程序的数据存储方面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:19:21.997

对于用户名和密码，查找 KeyChain。

对于其他一切，Core Data 都很好。SQLite 是一种可能性。

# c++ - C++：抓取文件的每个字符，忽略换行符和空格

> ID：10234268
> 
> 赞同：0
> 
> 时间：2012-04-19T18:16:41.937
> 
> 标签：c++, arrays, char

所以这似乎是一个如此简单的问题，但我正在努力解决它。我有一个大文件，我想通过它并将文件中的每个字符放入一个字符数组中。我的问题是我不知道如何处理换行符和任何空格。有没有办法只通过文件并获取所有字符，跳过换行符并将它们放入数组中？

是的，我在谷歌上搜索过，但没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:21:11.217

这是在`C`. 我相信它也可以使用`C++`接口来完成，但是 C 库也是 C++ 的一部分。

```
#include <stdio.h>
#include <ctype.h>

FILE *f = fopen ("filename", "r");
if (!f)
   error ...

char array [BIGENOUGH];
int index = 0;
while (!feof (f))
{
    char c = fgetc (f);
    if (!isspace (c))
        array [index++] = c;
}
fclose (f): 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:21:17.317

首选方法是使用标准库字符串。[从此处](https://stackoverflow.com/questions/83439/remove-spaces-from-stdstring-in-c)的字符串中删除空格的示例。[如何在此处](https://stackoverflow.com/questions/551082/c-read-lines-from-file)逐行读取文件。

示例代码：

```
fstream file;
file.open("test.txt",ios::in);
while ( !file.eof() ) {
  string str;
  file >> str;

  remove_if(str.begin(), str.end(), isspace);
  str.erase(remove_if(str.begin(), str.end(), isspace), str.end());
  //save str here
}

file.close(); 
```

`remove_if`示例实现：

```
template<typename T, typename P>
T remove_if(T beg, T end, P pred)
{
    T dest = beg;
    for (T itr = beg;itr != end; ++itr)
        if (!pred(*itr))
            *(dest++) = *itr;
    return dest;
} 
```

此代码未经测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T18:32:12.800

在 C++ 中做你想做的事的关键是利用格式化的输入操作。你想忽略空格；格式化的输入法正是这样做的。

这是使用规范 C++ 输入循环的一种方法：

```
#include <fstream>
#include <iostream>

int main () {
  std::ifstream inFile("input.txt");

  char c;
  std::string result;
  while(inFile >> c)
    result.push_back(c);

  std::cout << result;
} 
```

我更喜欢标准算法而不是手工制作的循环。这是在 C++ 中使用`std::copy`. 请注意，这种方式和第一种方式几乎相同。

```
#include <vector>
#include <fstream>
#include <iostream>
#include <iterator>
#include <algorithm>

int main () {
  std::ifstream inFile("input.txt");
  std::string result;
  std::copy(std::istream_iterator<char>(inFile),
            std::istream_iterator<char>(),
            std::back_inserter(result));
  std::cout << result;
} 
```

另一种方式，这次使用`std::accumulate`. `std::accumulate`使用`operator+`代替`push_back`，因此我们可以一次读取文件`string`。

```
#include <vector>
#include <fstream>
#include <numeric>
#include <iostream>
#include <iterator>
#include <algorithm>

int main () {
  std::ifstream inFile("input.txt");
  std::string result =
    std::accumulate(
      std::istream_iterator<std::string>(inFile),
      std::istream_iterator<std::string>(),
      std::string());
  std::cout << result;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T18:23:30.170

[`fgets`](http://www.cplusplus.com/reference/clibrary/cstdio/fgets/)允许您读取直到换行符（请注意换行符仍然存在于目标缓冲区中，因此请确保用 '\0' 覆盖它）。
逐行读取文件，每次将您的输出与前一个输出连接起来。

# .net - 如何检查文件是否是 C++ 中的图像类型？

> ID：10234269
> 
> 赞同：0
> 
> 时间：2012-04-19T18:16:42.000
> 
> 标签：.net, winforms, visual-studio-2008, visual-c++, c++-cli

我想在使用之前检查我硬盘中的文件是否是图像。

我正在使用 C++/Cli

```
OpenFileDialog^ openFileDialog1 = gcnew OpenFileDialog;
if ( openFileDialog1->ShowDialog() == System::Windows::Forms::DialogResult::OK ) {
     Bitmap^ PreviewImage = gcnew Bitmap(openFileDialog1->FileName); //If File is not an image this will crash.

} 
```

正如我在该行中评论的那样，如果文件不是会产生错误的图像，我该如何检查文件是否是图像？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:18:20.380

通过捕获异常。

.Net 没有任何`TryRead`方法会返回 false 而不是抛出异常。

您可以检查扩展名，但`.png`文件也可能是无效图像。
（但是，您应该首先设置`Filter`以阻止用户选择其他文件类型）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:30:04.517

我会向 OpenFileDialog 添加一个过滤器，以便用户只能选择图像。

```
OpenFileDialog^ openFileDialog1 = gcnew OpenFileDialog;
openFileDialog1->Filter = "Image Files(*.BMP;*.JPG;*.GIF)|*.BMP;*.JPG;*.GIF" ; 
```

请参阅[http://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.filter.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.filter.aspx)

但是，当您尝试打开文件时仍然需要检查错误，因为用户总是可以尝试在对话框的文本框中键入无效的文件名。

> 今天的编程是软件工程师努力构建更大更好的防白痴程序与宇宙试图产生更大更好的白痴之间的竞赛。到目前为止，宇宙正在获胜。
> 
> 丰富的厨师

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:19:52.823

约定通常规定文件内容由扩展名描述。如果我是你，我会做一些基本的检查，以确保你只允许 .bmp、.jpeg、.jpg、.gif 等。另外，正如另一个答案所提到的，你应该确保捕捉到异常，你可以告诉用户那里发生了错误。

你可以这样做：

```
OpenFileDialog^ openFileDialog1 = gcnew OpenFileDialog;
if ( openFileDialog1->ShowDialog() == System::Windows::Forms::DialogResult::OK ) {
     try
     {
         Bitmap^ PreviewImage = gcnew Bitmap(openFileDialog1->FileName); //If File is not an     image this will crash.
     }
     catch(Exception ^ex)
     {
           //do something with the exception here
     }
} 
```

# asp.net - 从公共共享子访问 asp:Placeholder

> ID：10234270
> 
> 赞同：0
> 
> 时间：2012-04-19T18:16:43.587
> 
> 标签：asp.net, asp.net-placeholder

我目前正在开发一个使用 YUI 网格的解决方案。我的问题是我的主页是我所有其他页面的摘要，它包括显示在其他页面上的网格的摘要网格，我不想在每个页面的代码后面重用相同的代码。我试图集中它。所以我所做的是我`<asp:Placeholders id="LoadOpenPurchasesGridDataPlaceholder" runat="server">`在主页和 Open Purchases 页面上写了一个 JSON 字符串。但是，因为我想在所有页面之间共享子过程，所以我将其设为公共共享，但它给出了一个错误：无法从共享方法或共享成员中引用类的实例成员。

现在，如果我想从不同的代码开始响应.write 到页面，我使用 HttpContext.Current.Response.Write()。是否有类似的方法可以从我调用它的地方访问页面的 HTML 控件。（我已经尝试详细解释了，很抱歉造成混乱。）

我的代码：

```
Shared Sub LoadOpenPurchasesGrid(ByVal Location As String, ByVal Coop As String, ByVal Commodity As String, ByVal Financeed As String, ByVal Season As String, ByVal Trader As String, ByVal Department As String, ByVal Database As String)
    尝试
        Dim ReturnString As String = 无
        如果 Location = "0" And Coop = "0" And Commodity = "0" And Season = "0" And Trader = "0" 那么
             ReturnString = (LoadOpenPurchasesGridData("", "", "", "", "", 部门, 数据库))
             将 LoadGridDataContainer 调暗为新 HtmlGenericControl("input")
             LoadGridDataContainer.ID = "hdnOpenPurchasesGridData"
             LoadGridDataContainer.Attributes.Add("类型", "隐藏")
             LoadGridDataContainer.Attributes.Add("value", ReturnString)
             LoadOpenPurchasesGridDataPlaceholder.Controls.Add(LoadGridDataContainer)
        别的
             ReturnString = (LoadOpenPurchasesGridData(Location, Coop, Commodity, Season, Trader, Department, Database))
             HttpContext.Current.Response.Write(ReturnString)
        万一
        HttpContext.Current.Response.Write（例如消息）
    结束尝试
结束子

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T07:12:26.167

我找到了我的问题的答案。我没有尝试直接从调用方法引用占位符，而是将占位符作为方法参数传递，然后从调用方法将其作为 Me.PlaceholderID 发送。

```
' Public Shared Sub LoadOpenPurchasesGridData(ByRef Placeholder As Object, ByVal Location As String, ByVal Coop As String, ByVal Commodity As String, ByVal Season As String, ByVal Trader As String, ByVal SearchCriteria As String, ByVal Department As String, ByVal Database As String, ByVal InitialLoad As Boolean)
        Dim SqlConnection As New SqlConnection
        Dim SqlCommand As New SqlCommand
        Dim SqlParameter As New List(Of SqlParameter)
        Dim SqlReader As SqlDataReader = Nothing
        Dim ReturnString = "["
        Dim Counter As Integer = 1
        Try
            SqlConnection = CreateDatabaseConnection(ConnectionString)
            AddSqlParameterToCollection(SqlParameter, "@Location", Location)
            AddSqlParameterToCollection(SqlParameter, "@Coop", Coop)
            AddSqlParameterToCollection(SqlParameter, "@Commodity", Commodity)
            AddSqlParameterToCollection(SqlParameter, "@Season", Season)
            AddSqlParameterToCollection(SqlParameter, "@Trader", Trader)
            AddSqlParameterToCollection(SqlParameter, "@Search", SearchCriteria)
            AddSqlParameterToCollection(SqlParameter, "@Database", Database)
            SqlCommand = CreateSqlCommand("[proc_Dynamic_GetPOC]", SqlConnection, SqlParameter)
            SqlReader = SqlCommand.ExecuteReader()
            If SqlReader.HasRows Then
                Do While SqlReader.Read And Counter < 200
                    If Counter <> 1 Then
                        ReturnString += ","
                    End If
                    ReturnString += "{""PrimCont"":""" & SqlReader("PrimCont") & ""","
                    ReturnString += """PSCM_COOP_ID"":""" & SqlReader("PSCM_COOP_ID") & ""","
                    ReturnString += """POCNumber"":""" & SqlReader("POCNumber") & ""","
                    ReturnString += """VENDORID"":""" & SqlReader("VENDORID") & ""","
                    ReturnString += """VendorContract"":""" & SqlReader("VendorContract") & ""","
                    ReturnString += """ITMCLSDC"":""" & SqlReader("ITMCLSDC") & ""","
                    ReturnString += """CommodityGrade"":""" & SqlReader("CommodityGrade") & ""","
                    ReturnString += """ContractQty"":""" & SqlReader("ContractQty") & ""","
                    ReturnString += """LIQty"":""" & SqlReader("LIQty") & ""","
                    ReturnString += """TonsNotFinalized"":""" & SqlReader("TonsNotFinalized") & ""","
                    ReturnString += """POC_DEL_QTY"":""" & SqlReader("POC_DEL_QTY") & ""","
                    ReturnString += """OpenQty"":""" & SqlReader("OpenQty") & ""","
                    ReturnString += """ContractPrice"":""" & SqlReader("ContractPrice") & ""","
                    ReturnString += """PurchaseBasis"":""" & SqlReader("PurchaseBasis") & ""","
                    ReturnString += """Safex Month"":""" & SqlReader("Safex Month") & ""","
                    ReturnString += """SpreadToSafexMonth"":""" & SqlReader("SpreadToSafexMonth") & ""","
                    ReturnString += """LOCNDSCR"":""" & SqlReader("LOCNDSCR") & ""","
                    ReturnString += """Area"":""" & SqlReader("Area") & ""","
                    ReturnString += """VesselName"":""" & SqlReader("VesselName") & ""","
                    ReturnString += """DeliveryMonth"":""" & SqlReader("DeliveryMonth") & ""","
                    ReturnString += """SignedContract"":""" & SqlReader("SignedContract") & """}"
                    Counter += 1
                Loop
            End If
            ReturnString += "]"
            Counter = 0
            If InitialLoad = True Then
                Dim LoadGridDataContainer As New HtmlGenericControl("input")
                LoadGridDataContainer.ID = "hdnOpenPurchasesGridData"
                LoadGridDataContainer.Attributes.Add("type", "hidden")
                LoadGridDataContainer.Attributes.Add("value", ReturnString)
                Placeholder.Controls.Add(LoadGridDataContainer)
            Else
                HttpContext.Current.Response.Write(ReturnString)
            End If
        Catch ex As Exception
            HttpContext.Current.Response.Write("<span class=""error_message_span"">ERROR - An error occurred loading the open puchases grid. Please contact the system administrators for assistance.</span>" & ex.Message)
        Finally
            If Not IsNothing(SqlReader) Then
                SqlReader.Close()
                SqlReader = Nothing
            End If
            If Not IsNothing(SqlCommand) Then
                SqlCommand.Dispose()
                SqlCommand = Nothing
            End If
            If Not IsNothing(SqlConnection) Then
                SqlConnection.Close()
                SqlConnection.Dispose()
                SqlConnection = Nothing
            End If
        End Try
    End Sub' 
```

# wordpress - Wordpress 自动草稿禁用

> ID：10234271
> 
> 赞同：6
> 
> 时间：2012-04-19T18:16:48.143
> 
> 标签：wordpress

我正在使用带有多站点管理的 Wordpress v.3.3.1。

我正在尝试禁用自动草稿功能，但似乎我已经尝试了一切。

我试过的：

```
define('WP_POST_REVISIONS', false);

define('WP_POST_REVISIONS', false); 
```

没用。

我试图删除 post-new.php、post-php 中的 auto_save 行。在 wp-includes 和 wp-admin 中。没用。

我也尝试了几个插件，但他们不会这样做！知道为什么吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-10-23T16:10:14.877

我注意到您在询问是否禁用**Auto-Drafts**而不是**Auto-Save**。

您不能禁用自动保存，但您可以通过设置较长的时间间隔来实现类似的效果，例如：

```
define( 'AUTOSAVE_INTERVAL', 3600 ); // Default is 60 
```

*（您可以将其添加到您的 WordPress 站点的 wp-config.php 文件中。）*

至于自动草稿，您不想禁用它们。他们在那里有一个重要的原因。让我为你拿一两个报价...

Audrey Capital（Matt Mullenweg 的天使投资公司）的技术忍者 Samuel 'Otto' Wood[说](http://wordpress-hackers.1065353.n5.nabble.com/Disable-Stop-auto-draft-posts-tp914p917.html)：

> 之所以存在自动草稿，是因为多个用户可以同时创建新帖子。如果两个人几乎在同一时间进入 post-new，然后他们的第一次自动保存几乎同时发生，那么就会出现竞争条件，可能导致其中一个人取回错误的帖子 ID，这将导致帖子被覆盖/lost 当他们继续编辑帖子时。
> 
> 自动草稿会在显示编辑屏幕之前创建帖子并获取新帖子的 ID，从而防止两个同时作者在浏览器的数据中意外地拥有相同的帖子 ID。

负责 WordPress 的 TinyMCE 集成的 Andrew Ozz[说](http://wordpress-hackers.1065353.n5.nabble.com/Disable-Stop-auto-draft-posts-tp914p924.html)：

> 这也使得在保存第一个草稿之前上传图像成为可能，并且它们将正确地附加到新帖子中。

[最后](http://wordpress-hackers.1065353.n5.nabble.com/Disable-Stop-auto-draft-posts-tp914p923.html)：

> 自动草稿在 7 天未使用后会自动删除。它们基本上是自清洁的。无需担心它们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-20T01:46:33.403

A) 将其设置在您的 wp-config.php 文件中。否则就不行了。

```
define( 'AUTOSAVE_INTERVAL',    3600 );     // autosave 1x per hour
define( 'WP_POST_REVISIONS',    false );    // no revisions
define( 'DISABLE_WP_CRON',      true );
define( 'EMPTY_TRASH_DAYS',     7 );        // one week 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-09T21:28:59.973

打开位于 WordPress 根目录中的 wp-config.php 并添加以下代码：

```
define('WP_POST_REVISIONS', false ); 
```

在`require_once ABSPATH . 'wp-settings.php';`或文件的顶部之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-23T07:32:15.707

对于使用带有 Gutenberg Editor 的 WordPress 5.0+ 版本的人，下面的代码片段可以禁用自动起草/保存

```
/**
 * Disables auto saving feature for Gutenberg Editor (set interval by 3600s)
 */
add_filter( 'block_editor_settings', 'rsm0128_block_editor_settings', 10, 2 );
function rsm0128_block_editor_settings( $editor_settings, $post ) {
    $editor_settings['autosaveInterval'] = 3600;
    return $editor_settings;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-06-13T17:12:19.290

我认为**禁用它不好**（例如，当您并行尝试发布 2 个帖子时，可能会出现问题）。所以，而不是**禁用**：

# 方法1)

*   稍微禁用它们（没有核心修改），请参阅[**此答案**](https://wordpress.stackexchange.com/a/216447/33667)。

# 方法2)

*   只需使用[此代码](http://pastebin.com/raw/kveXGqJT)或好的插件[WP Clean Up清理它们](http://wordpress.org/plugins/wp-clean-up/)

# asp.net - 诱使浏览器发出 If-Range 获取请求

> ID：10234278
> 
> 赞同：1
> 
> 时间：2012-04-19T18:17:16.450
> 
> 标签：asp.net, http

我正在尝试根据[Scott Mitchell 的](http://www.4guysfromrolla.com/ScottMitchell.shtml)示例在页面上实现范围请求功能。我遇到的问题是，无论我如何中断下载，我使用的浏览器（IE9 和 Firefox 11）似乎都不会发出 If-Range 请求。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T13:59:44.863

**在 Firefox 中，只需在下载管理器中**暂停和恢复下载，就会发出带有**If-Match**和**Range**标头的请求。

# c - C - 如何同步访问连接句柄

> ID：10234283
> 
> 赞同：1
> 
> 时间：2012-04-19T18:17:26.730
> 
> 标签：c

想象一下这个场景，我有一个用 C 语言编写的适配器，它将消息写入 SAP（调用 RFC）。

仅当新消息到达“引擎”时才调用适配器，因此最多可以有 1 天或更长时间没有活动。这就是问题所在，连接句柄在标准代码中的“低级套接字”层/或 SAP 本身上的某些 SAP 参数可能会说“不再活动的终止句柄”无效

所以我现在要做的是生成一个“位于适配器顶部”的线程，并且每 10 秒左右对 SAP 进行一次 PIN。这里的问题是我使用相同的连接句柄向 SAP 发送消息以及 PING / HEARTBEAT 消息。

SAP 对 RFC 句柄说：

"**一个 RFC 句柄可以在多个线程中使用，但一次只能在一个线程中处于活动状态。由一个线程创建的 RFC 连接的 RFC 句柄可以在另一个线程中使用，但这些线程必须同步访问到这把柄。** ”

但是现在我尝试使用“pthread_mutex_lock”等来完成这项工作，但它没有。

我有一个全局“句柄”，当我的适配器 SHARED LIB 启动时，我启动一个线程，如下所示：

rc = pthread_create(&heartbeatThread, NULL, heartbeatThreadMainLoop, (void *)NULL);

而这个线程每隔 10 秒左右就对 SAP 进行一次 ping 操作。

在一个完美的世界里，我希望 MESSAGING to SAP 在这里优先，所以 PING 应该完全等到它“安静”然后重新启动。

我查看了以下链接：

[http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html#SYNCHRONIZATION](http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html#SYNCHRONIZATION)

但我实际上想锁定/解锁整段代码，所以正如我所说，如果 MESSAGE 进入 SAP，PING 线程必须等待......但是如果 PING 线程很忙，我想以某种方式中断它并说“嘿，我需要那个连接句柄来发送消息”......

什么是最佳实践“模式”？

帮助将不胜感激

谢谢

林顿

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:17:24.513

整个架构可以通过增加 ADAPTER 的范围来简化。

与其主循环无限期地等待请求，不如让它在 10 秒后超时。如果超时，请执行唤醒逻辑。在任何一种情况下（请求或超时），重置计时器。

这避免了整个共享问题，并使 ADAPTER 负责与 SAP 的所有交互。

# c - ISO C90 禁止变长数组

> ID：10234288
> 
> 赞同：6
> 
> 时间：2012-04-19T18:17:40.067
> 
> 标签：c, variable-length-array

我正在动态计算数组的大小。就像是：

```
void foo(size_t limit)
{
  char buffer[limit * 14 + 1];
} 
```

但只是 GCC 编译器说：

```
error: ISO C90 forbids variable length array ‘buffer’ 
```

搜索所以我找到[了这个答案](https://stackoverflow.com/a/3783369/866022)：

**C99 §6.7.5.2：**

> 如果大小是一个不是整数常量表达式的表达式... ...每次对其进行评估时，它的值都应大于零。

所以，我重新声明了大小限制类型变量：

```
void foo(const size_t limit) 
```

但它继续给我警告。这是 GCC 错误吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-19T20:08:00.993

`const`- 限定变量不会使其成为编译时常量（有关*整数常量表达式*的定义，请参见 C99 6.6 §6 ），并且在使用 C99 引入可变长度数组之前，数组大小需要在编译时常数。

很明显，`const`-qualify 变量不会使其成为编译时常量，特别是在函数参数在调用函数之前不会被初始化的情况下。

我看到以下解决您的问题的方法：

*   `-std=c99`通过或将您的代码编译为 C99`-std=gnu99`
*   通过分配缓冲区`malloc()`
*   如果可用，请使用`alloca()`，这是您可以使用 C90 获得的最接近可变长度数组
*   选择始终使用的最大缓冲区大小，如果给定`limit`参数溢出则失败

作为旁注，即使 C99 允许可变长度数组，使用具有静态存储持续时间的整数变量的值作为具有静态存储持续时间的数组的大小仍然是非法的，不管`const`-qualification：虽然没有什么可以阻止这一点原则上，如果整数变量在同一个翻译单元中初始化，则您必须使用具有可见定义的特殊情况变量，这些变量的定义位于不同的翻译单元中，并且必须禁止暂定定义或需要多次编译传递为在整个翻译单元被解析之前，暂时定义的变量的初始化值是未知的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-19T18:21:18.567

`const`不会在 C 中引入常量，而是引入只读变量。

```
#define SIZE 16
char bla[SIZE];   // not a variable length array, SIZE is a constant 
```

但

```
const int size = 16;
char bla[size];   // C99 variable length array, size is a constant 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-19T18:19:33.433

C90 不允许变长数组。但是，您可以使用`c99-gcc`编译器来完成这项工作。

您正在编译`c90-gcc`但正在查看 C99 规范。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-19T18:19:46.813

不，这不是错误。您不能在 C90 中使用 VLA。当你宣布

```
const size_t limit 
```

那不是一个常量表达式。常量表达式类似于文字值`666`。

请注意，C 在这方面与 C++ 有很大不同。即使是这样的*常数*

```
const int i = 666; 
```

`#define`不是 C 中的常量表达式。这是常量值通常在 C中声明为的主要原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T18:19:53.287

正如您在问题中所写，这是来自 C99，而不是 C90，您需要针对 C99 编译它才能使用可变长度数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T18:21:36.617

`const`限定变量不是标准意义上的整数常量表达式。这必须是字面常量、枚举常量`sizeof`或由这些组成的表达式。

如果可以，请切换到 C99。gcc 选项是`-std=c99`（或 gnu99，如果你想要 gnu 扩展。）

# ios - iCloud 权利被拒绝

> ID：10234289
> 
> 赞同：2
> 
> 时间：2012-04-19T18:17:40.017
> 
> 标签：ios, core-data, ios5, icloud, entitlements

我已经在我的（现有）应用程序上工作了一段时间，以添加对 iCloud 同步的支持。总的来说，我有 3 个版本的应用程序：

a) 普通 iPhone 版
b) lite（免费）iPhone 版
c) iPad 版

我想使用 iCloud 使所有 3 个版本/设备之间的核心数据存储同步。我已经实现了，我在我的设备上放置的开发版本运行良好。

昨天我决定提交 iPhone 版本，但被拒绝了：

> *无效的代码签名权利 - 您的应用程序包的签名包含不受支持的权利值。对于 com.apple.developer.ubiquity-container-identifiers 权利，数组中的第一个值必须由 Apple 在配置文件中提供的前缀和捆绑标识符后缀组成。捆绑包标识符必须与您的一个应用程序或允许您用作 iCloud 容器标识符的另一个应用程序的捆绑包标识符匹配。*
> 
> *具体来说，不支持 [my app] 中键“com.apple.developer.ubiquity-container-identifiers”的值“[teamid].com.[myself].[somename]”。*

我真的不知道这些标识符应该是什么样子。在此页面上：[https](https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/iCloud/iCloud.html#//apple_ref/doc/uid/TP40007072-CH5-SW1) ://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/iCloud/iCloud.html#//apple_ref/doc/uid/TP40007072-CH5-SW1他们说了一些关于我的其他应用程序的容器......我是否必须为我的应用程序的 3 个版本添加 3 个容器？到目前为止，我在 project/targets/summary/entitlements 下进行了配置：

[x] iCloud 键值存储：com.[myself].[somename]
iCloud 容器：com.[myself].[somename]

对于所有 3 个版本（相同的标识符）。我必须准确配置什么，以便所有 3 个版本都可以通过 iCloud 同步其核心数据存储数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-12T10:05:57.833

根据[iCloud 设计指南：iCloud Fundamentals](http://developer.apple.com/library/mac/documentation/General/Conceptual/iCloudDesignGuide/Chapters/iCloudFundametals.html)，您共享 iCloud 容器的所有应用程序都可以使用单个 iCloud 容器来实现（如果您愿意的话）。这里要注意的是，主要（第一个）容器 ID 必须是您**当前正在开发的应用程序的***Bundle* *ID*，或者是**您之前提交**的任何应用程序的 Bundle ID （共享相同的*Team ID*）。

 ******我举个例子，

让我们假设您的应用程序常规 iPhone 应用程序 (a) 有一个*Bundle ID* **com.yourteam.iphoneapp**并且它是您首先提交的并且在 App Store 上可用。然后，您还必须为所有其他版本提供与主要 iCloud 容器 ID 相同的 ID。

这是上述文档中的相关部分：

> 在 Xcode 目标编辑器的 Summary 选项卡中，您可以请求访问应用程序所需的任意数量的 ubiquity 容器。例如，假设您提供免费和付费版本的应用。您希望升级的用户保留对其 iCloud 文档的访问权限。或者，也许您提供了两个可以互操作并需要访问彼此文件的应用程序。在这两个示例中，您通过指定一个通用的通用容器然后从每个应用程序请求访问它来获得所需的访问权限。
> 
> 1.  选择一个支持 iCloud 的应用程序作为通用无处不在容器的主要应用程序。您选择的应用程序可以是您当前正在开发的应用程序，也可以是您提交到 App Store 以供分发且其权利使用相同团队 ID 的另一个应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T15:55:34.893

您现在可能已经解决了这个问题，但答案是您只需在所有应用程序中使用相同的通用容器标识符。你只需要一个，它不依赖于应用程序名称：注意 Apple 告诉你使用“[teamid].com.[myself].[ *somename* ]”而不是“[teamid].com.[myself].[ *appname* ]”。使用在应用程序之间一致的“某个名称”，而不是“应用程序名称”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T19:32:15.380

![在此处输入图像描述](../Images/6e7052418dff58bda67bdb5b698be16a.png)您需要创建 3 个单独的启用 iCloud 的临时配置文件。运行相同版本应用程序的设备可以在同一个 iCloud 容器上共享数据。但是，如果您希望任何设备运行这三个应用程序版本中的任何一个来共享数据，那么您需要在每个版本的“权利”部分中添加这些标识符。

[来自http://www.raywenderlich.com/6015/beginning-icloud-in-ios-5-tutorial-part-1](http://www.raywenderlich.com/6015/beginning-icloud-in-ios-5-tutorial-part-1)的 iCloud 有很好的教程

编辑：

我为您的案例添加了示例图片。此外，以下文本摘自该网站上的教程：

在这里，我们使用了一种您尚未见过的新方法，称为 URLForUbiquityContainerIdentifier。此方法允许您传入容器标识符（就像您之前在 iCloud 容器部分中设置的那样），它会返回一个 URL 用于访问 iCloud 存储中的文件。

您需要在启动时为要访问的每个容器调用此方法，以授予您的应用访问 URL 的权限。如果您将 nil 传递给该方法（就像我们在这里所做的那样），它会自动返回为项目设置的第一个 iCloud 容器。由于我们只有一个容器，这使它变得又好又容易。******

# eclipse - 外包生成的 Swing 代码

> ID：10234290
> 
> 赞同：1
> 
> 时间：2012-04-19T18:17:50.020
> 
> 标签：eclipse, eclipse-plugin, windowbuilder

有没有办法将生成的 Java 源代码从实际类（框架或面板类）外包到 XML 文件中（例如）？

我不喜欢我的 GUI 对象中这种凌乱的 Swing 代码；它使我的课变得庞大而难以阅读。

我知道在 IntelliJ IDEA 中实现的 GUI Builder 可以做到这一点（参见[http://www.jetbrains.com/idea/features/gui_builder.html](http://www.jetbrains.com/idea/features/gui_builder.html)）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:55:27.717

GUI Builder（来自 Google，以前称为 Instantiations）总是生成 Java 代码。这实际上是设计师的主要想法:-)

使用 Java 作为实现语言可以做很多 XML 或其他静态规范语言无法完成的事情。

*编辑：*您还可以查看[XWT - XML Windowing Toolkit](http://wiki.eclipse.org/E4/XWT) - 虽然我不知道它是在 Eclipse 3 下工作还是在“只是”Eclipse 4 下工作......

# macros - SAS 宏扫描和评估问题

> ID：10234294
> 
> 赞同：1
> 
> 时间：2012-04-19T18:18:01.713
> 
> 标签：macros, sas

我正在尝试实现一个宏，它允许我为多个数据集运行多个逻辑回归模型，这些模型具有相同的结果但不同的主要解释变量（协变量对于所有模型都是通用的）。我编写了一个扫描和评估宏来扫描两个全局变量，但它并不完全有效。代码如下所示：

```
%let numbers=5 7 8 9 10 12 13 14 16 18 19 24  26 
32 33  35 37  39  41  44 45  48 50 52 
55 56  58  66 67 68 ; 

%let list=voting national local safe street violence say free;

%macro logistic;    
%let j=1;
%let m=1;
%let first=%scan(&list,%eval(&j));
%let second=%scan(&numbers,%eval(&m));
%do %while (&first ne );
%do %while (&second ne );

proc logistic data=socialcapital&second. descending;
model depression= &first. agec married edu inc_2 inc_3 inc_4 inc_5/risklimits;
ods output ParameterEstimates=mv_model1&second._&first.;
run;

%let j=%eval(&j+1);
%let m=%eval(&m+1);
%let first=%scan(&list,%eval(&j));
%let second=%scan(&numbers,%eval(&m)); 
%end;
%end;
run;

%mend;  
%logistic; 
```

全局变量 numbers 指的是我正在使用的“socialcaptial”数据集。每个数据集代表一个国家，因此“数字”全局变量中的每个数字都指一个数据集。全局变量列表是指我想在模型中包含的主要解释变量的列表，每个模型一个主要解释变量。我希望得到的是每个国家/地区的 8 个独立的多变量逻辑回归结果。

但是，扫描功能似乎对我不起作用，所以我知道我做错了什么，但我不确定是什么。似乎宏将 &list 中的 1 个变量分配给 &numbers 中的 1 个数据集，直到它用完 &list 中的变量，并仅使用协变量运行模型，而不是使用数据集 5 运行所有 8 个模型，然后使用再次运行所有 8 个模型数据集 7，依此类推。

基本上，我把编号弄乱了，我不太确定如何继续使用这个宏。我知道我可以通过在具有堆叠数据集的 proc 逻辑中使用“by 语句”来摆脱 &numbers 全局变量，但我真的很想学习如何让它适用于可能无法选择的未来模型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T14:21:12.493

哎呀，小修正。我应该在下面使用“数字”而不是索引“i”。

您可以使用宏执行此操作，但您也可以在数据步骤（使用调用执行）或 Proc IML（9.22 或更高版本）中执行此操作，并将提交块嵌套在循环中。要获得一个想法，请参见下文。

```
Data _Null_;
 Do numbers = 5, 7, 
                  8 to 10, 
                  12 to 14, 
                  16, 18, 19, 24, 26, 32, 
                  33 to 41 by 2, 
                  44, 45, 48, 50, 52, 55, 56, 58, 
                  66 to 68;  
   Do IndpVar = "voting", "national", "local", "safe", "street", "violence", "say", "free";
       call execute( '%Put '||strip(Indpvar)||strip(put(numbers,best.))||';');
      "Logistic Code Goes Here";
   End;
   End;
 Run; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T23:11:00.533

这是另一种方法：（如果您最终在数据集中使用 NUMBERS 和 LIST，我们也可以更改代码来处理它）

```
%let numbers=5 7 8 9 10 12 13 14 16 18 19 24  26 
 32 33  35 37  39  41  44 45  48 50 52 
 55 56  58  66 67 68 ; 

%let list=voting national local safe street violence say free;

%macro logistic(First=, Second=);    
 %Put FIRST= &first;
 %Put SECOND= &second;
 /*proc logistic data=socialcapital&second. descending;*/
 /*model depression= &first. agec married edu inc_2 inc_3 inc_4 inc_5/risklimits;*/
 /*ods output ParameterEstimates=mv_model1&second._&first.;*/
 /*run;*/

%mend logistic;  

%Macro Test;
 %do i = 1 %to %sysfunc(countw(&list));
  %Let first=%scan(&list,&i);
  %do j = 1 %to %sysfunc(countw(&numbers));
   %Let second=%scan(&numbers,&j);
   %logistic(First=&first,Second=&second)
  %end;
 %end;
%Mend test;
%test 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T19:08:01.320

劣质煤，

我相信下面的代码会做你想做的事。我注释掉了 LOGISTIC 过程并放入了一个 PUT 语句进行测试，它似乎解决了我希望你认为它应该的方式。

```
%let numbers=5 7 8 9 10 12 13 14 16 18 19 24  26 
32 33  35 37  39  41  44 45  48 50 52 
55 56  58  66 67 68 ; 

%let list=voting national local safe street violence say free;

%macro logistic;
   %let j=1;
   %let first=%scan(&list,%eval(&j));
   %do %while (&first ne );
      %let m=1;
      %let second=%scan(&numbers,%eval(&m));
      %do %while (&second ne );

        /*
         proc logistic data=socialcapital&second. descending;
         model depression= &first. agec married edu inc_2 inc_3 inc_4 inc_5/risklimits;
         ods output ParameterEstimates=mv_model1&second._&first.;
         run;
        */
         %put J=&j - M=&m - FIRST=&first - SECOND=&second;

         %let m=%eval(&m+1);
         %let second=%scan(&numbers,%eval(&m));
      %end;
      %let j=%eval(&j+1);
      %let first=%scan(&list,%eval(&j));
   %end;
   run;
%mend;

%logistic; 
```

# java - 更新JComboBox后，如何刷新框的长度

> ID：10234297
> 
> 赞同：0
> 
> 时间：2012-04-19T18:18:13.313
> 
> 标签：java, swing, listener, jcombobox, jtextfield

我正在尝试创建一种更新 JComboBox 的方法，以便当用户在文本字段中输入内容时，一些代码将处理该条目并相应地更新 JComboBox。我遇到的一个问题是我可以更新 JComboBox，但是第一次打开时，该框没有刷新其中选项的长度，如下面的代码所示，它显示了额外的空白。我不知道是否有更好的不同方法来做到这一点，但这就是我想出的。

谢谢您的帮助，

担

```
import java.awt.event.*;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class Catch{
public static JComboBox dropDown;
public static String dropDownOptions[] = {
         "Choose",
         "1",
         "2",
         "3"};
 public static  void main(String[] args) {
     dropDown = new JComboBox(dropDownOptions);
     final JTextField Update = new JTextField("Update", 10);
     final JFrame frame = new JFrame("Subnet Calculator");
     final JPanel panel = new JPanel();
     frame.setSize(315,430);
     frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
     Update.addFocusListener(new FocusListener(){
    public void focusGained(FocusEvent arg0) {  
            }
            public void focusLost(FocusEvent arg0) {
                dropDown.removeAllItems();
                dropDown.insertItemAt("0", 0);
                dropDown.insertItemAt("1", 1);
                dropDown.setSelectedIndex(0);
            }
              });
        panel.add(Update);
        panel.add(dropDown);
        frame.getContentPane().add(panel);
        frame.setVisible(true);
        Update.requestFocus();
        Update.selectAll();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:52:59.623

1 )`JTextField`听从`ENTER key``ActionListener`

2) 删除`FocusListener`

3）关于将新`Item`的作为最后一个添加`Item`到`JTextField`的示例`JList`，只有您必须正确修改`JComboBox`和添加方法`insertItemAt()`

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class ListBottom2 {

    private static final long serialVersionUID = 1L;
    private JFrame frame = new JFrame();
    private DefaultListModel model = new DefaultListModel();
    private JList list = new JList(model);
    private JTextField textField = new JTextField("Use Enter to Add");
    private JPanel panel = new JPanel(new BorderLayout());

    public ListBottom2() {
        model.addElement("First");
        list.setVisibleRowCount(5);
        panel.setBackground(list.getBackground());
        panel.add(list, BorderLayout.SOUTH);
        JScrollPane scrollPane = new JScrollPane(panel);
        scrollPane.setPreferredSize(new Dimension(200, 100));
        frame.add(scrollPane);
        frame.add(textField, BorderLayout.NORTH);
        textField.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e) {
                JTextField textField = (JTextField) e.getSource();
                DefaultListModel model = (DefaultListModel) list.getModel();
                model.addElement(textField.getText());
                int size = model.getSize() - 1;
                list.scrollRectToVisible(list.getCellBounds(size, size));
                textField.setText("");
            }
        });
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                ListBottom2 frame = new ListBottom2();
            }
        });
    }
} 
```

# android - 安卓。ShapeDrawable 和 GradientDrawable 有什么区别？

> ID：10234301
> 
> 赞同：2
> 
> 时间：2012-04-19T18:18:20.437
> 
> 标签：android, shapedrawable

我是 Android 开发新手，对 ShapeDrawable 和 GradientDrawable 类有点困惑。有什么不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:36:46.490

形状定义了一个形状，如矩形、椭圆形、线形或环形。渐变用于定义形状的外观。例如，您可以使用纯色或渐变填充形状。

# linq-to-sql - 编写查询以检查 linq to sql 中的用户名和密码是否正确？

> ID：10234307
> 
> 赞同：0
> 
> 时间：2012-04-19T18:18:29.657
> 
> 标签：linq-to-sql

在表格中，我正在保存用户名和密码。

如果用户输入错误的用户名，我将返回 201 错误：

```
bool doesUserExist = myContext.Users.Any(u=>u.Username == "bob") 
```

如何检查用户输入的密码是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:25:46.203

```
var tempUser = myContext.Users.FirstOrDefault(u=>u.Username =="bob" && u.Password == "password");

if(tempUser==null)
{
//Not Authenticated
} 
```

# asp.net-mvc-3 - 模型的 MVC3 IEnumerable 找不到正确的编辑器模板

> ID：10234311
> 
> 赞同：5
> 
> 时间：2012-04-19T18:18:39.123
> 
> 标签：asp.net-mvc-3, razor, ienumerable, mvc-editor-templates

我有以下模型：

```
public class Filter
{
    public string Field { get; set; }

    public string Operator { get; set; }

    public string Value { get; set; }
} 
```

以及以下控制器：

```
public class FilterController
{
    public ActionResult Index()
    {
        IList<Filter> model = new List<Filter>() {
            new Filter(), 
            new Filter()
        };

        return View(model);
    }
} 
```

以及以下观点：

```
@model IEnumerable<Filter>
@Html.EditorForModel() 
```

这应该寻找我的 EditorTemplate `Filter.cshtml`，并为列表中的每个元素呈现模板，对吗？

使用 Glimpse，我注意到 MVC 正在寻找`IEnumerable`1.cshtml`而不是`Filter.cshtml`

当我使用时也会发生同样的事情

```
@Html.EditorFor(model => model) 
```

当我这样做时：

```
@Html.EditorFor(model => model, "Filter") 
```

我收到一条错误消息，说需要`Filter.cshtml`一个类型的模型，`Filter`但它收到了一个类型的模型`IEnumerable<Filter>`

我这样做正确吗？我是否需要做任何其他事情才能使用正确的编辑器模板正确渲染模型列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T20:16:37.387

I've definitely had issues in the past with EditorTemplates, but I think it was mostly user error.

One possible workaround is to encapsulate your collection in a single, view model class and pass that to the view

```
public class MySweetFilterViewModel
{
    public IEnumerable<Filter> Filters { get; set; }
} 
```

Then you could use a single view to pick apart the collection

```
@model Project.Models.MySweetFilterViewModel
@Html.EditorFor(x => x.Filters) 
```

Just make sure your controller encapsulates

```
public ActionResult Index()
{
    //...
    return View(new MySweetFilterViewModel() { Filters = model });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T20:54:02.053

要回答您关于为什么...让我们尝试一些事情的问题。

如果您以这种方式编写代码会发生什么：

```
return View(new List<Filter>{ new Filter(), new Filter() }); 
```

可能是因为您使用的是中间 IList 而不是 List，所以有些事情会变得混乱。将会发生的事情（在我的理论中）是传递 an`IList<Filter>`导致标准`IEnumerable`而不是`IEnumerable<Filter>`传递给视图。

你也可以试试`model.AsEnumerable<Filter>()`

# c# - c# excel com interop：在工作表之间移动图表

> ID：10234314
> 
> 赞同：0
> 
> 时间：2012-04-19T18:19:13.233
> 
> 标签：c#, excel, exception, com, interop

我使用 c# excel com interop 生成了一个工作簿。我有只有数据和随附图表的表格。图表和工作表位于工作簿中单独的 Excel 选项卡上。

在图表和工作表的生成过程中，所有工作表都在第一组，而图表组在选项卡列表中排在第二位。我想将各个图表选项卡放在相应的工作表选项卡之后。这是我到目前为止所拥有的：

```
 private void move_charts_into_position(Excel.Workbook workbook)
    {
        int tab_count = 1;
        foreach (Excel.Chart chart_tab in workbook.Charts)
        {
            Console.WriteLine(chart_tab.Index.ToString()); //prints chart 1 here
            if (tab_count + 1 > workbook.Sheets.Count)
                chart_tab.Move(workbook.Sheets[tab_count], Type.Missing);
            else
                chart_tab.Move(workbook.Sheets[tab_count], workbook.Sheets[tab_count + 1]); //fails at first iteration here

            tab_count+=2;
        }
    } 
```

这会在运行时生成*无法获取 Chart 类*COM 异常的 Move 属性。我认为这很可能是因为 Sheets 集合作为 Move 的 arg 传递。

有什么一般性建议可以帮助我理解这些对象吗？我有一种预感，我可以使用一些铸造技巧来让它发挥作用。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:10:32.413

显然，图表被放置在工作表容器中。我通过从工作簿中的工作表数组中抓取图表来将图表移动到位。

# php - 只为 XML 转换 <、>、&、' 和 "？

> ID：10234320
> 
> 赞同：2
> 
> 时间：2012-04-19T18:19:39.690
> 
> 标签：php, pdo, preg-replace, special-characters, xml-entities

在早先解决的这个[问题](https://stackoverflow.com/questions/10233071/special-characters-and-double-quotes-issue-in-php/)之后，我似乎还有一个特殊字符和双引号等问题。

我曾经使用这个函数将像'&'这样的符号转换为XML的数字代码，

```
function convert_specialchars_to_xmlenties($string) 
{ 

    # in order to convert  <, >, &, ' and ", include them into the square brackes [<\'"&>\x80-\xff]
    $output = preg_replace('/([<\'"&>\x80-\xff])/e', "'&#' . ord('$1') . ';'", $string);

    # return the result
    return $output; 
} 
```

因此，如果我的意见是**Judge-Fürstová Mila 和 Judge-Fürstová Mila**

我会得到`Judge-F&#252;rstov&#225; Mila &#38; Judge-F&#252;rstov&#225; Mila`

但我认为，因为我`PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES utf8"`用来处理我所有的特殊字符，所以如果我的输入类似于

**法官-Fürstová Mila & 法官-Fürstová Mila**

现在将返回，

```
Judge-F&#195;&#188;rstov&#195;&#161; Mila &#38; Judge-F&#195;&#188;rstov&#195;&#161; Mila 
```

我认为这对于 XML 是不正确的。

所以我认为我应该只转换**<、>、&、' 和 "**而不是其他特殊字符，如**ü**或**á**

我有什么想法可以做到这一点吗？或者我可能错误地思考/理解了这个问题，还有其他更好的方法来解决这个问题？

**编辑：**

我错了，因为我只是更改了仅转换**<、>、&、' 和 "的函数**

```
$output = preg_replace('/([<\'"&>])/e', "'&#' . ord('$1') . ';'", $string); 
```

XML 仍然不接受下面的转换代码，

```
Judge-Fürstová Mila &#38; Judge-Fürstová Mila 
```

我想不出它这样做的任何其他原因！有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:37:54.720

你想要[htmlspecialchars](http://php.net/htmlspecialchars) ()。不要让这个名字让你失望。默认情况下，它只转换您列出的字符。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-19T18:43:50.473

*编辑答案以删除所有多余的东西并保留实际答案*

你想要[`mb_ereg_replace_callback`](http://php.net/manual/en/function.mb-ereg-replace-callback.php)，并且回调应该处理多字节字符。就像是：

```
$out = mb_ereg_replace_callback(
    "[<>&\"']",
    function($a) {
        $o = 0;
        $l = strlen($a[0]);
        for( $i=0; $i<$l; $i++) {
            $o = ($o << 8) | ord($a[$i]);
        }
        return "&#".$o.";";
    },
    $in); 
```

虽然在这种情况下，只需一个简单的回调就可以了`ord`，但您可能希望在某个时候将此代码重用于其他字符。

# java - Android中JPG图像的编码和解码

> ID：10234321
> 
> 赞同：0
> 
> 时间：2012-04-19T18:19:41.633
> 
> 标签：java, android, jpeg, steganography

我正在通过 Android 创建一个应用程序，我需要在其中操作我的 JPG 文件。我没有获得太多 JPG 格式的标题信息，因此我将其转换为位图，操作位图中的像素值，然后再次将其转换回 JPG。

这里我面临的问题是 - 在仅处理位图的一些像素并将其转换回 JPG 之后，我没有得到我之前得到的相同像素集（对于那些我没有处理的像素）。我在新图像中得到与原始图像相同的图像。但是当我检查新的图像像素值进行解码时，未触及的像素是不同的......

```
File imagefile = new File(filepath);
FileInputStream fis = new FileInputStream(imagefile);
Bitmap bi = BitmapFactory.decodeStream(fis);
int intArray[];
bi=bi.copy(Bitmap.Config.ARGB_8888,true);       
intArray = new int[bi.getWidth()*bi.getHeight()];
bi.getPixels(intArray, 0, bi.getWidth(), 0, 0, bi.getWidth(), bi.getHeight());

int newArray[] = encodeImage(msgbytes,intArray,mbytes); // method where i am manipulating my pixel values 

// converting the bitmap data back to JPG file
bi = Bitmap.createBitmap(newArray, bi.getWidth(), bi.getHeight(), Bitmap.Config.ARGB_8888);

ByteArrayOutputStream baos = new ByteArrayOutputStream();
bi.compress(Bitmap.CompressFormat.JPEG, 100, baos);
byte[] data = baos.toByteArray();

Bitmap bitmapimage = BitmapFactory.decodeByteArray(data, 0, data.length);
String filepath = "/sdcard/image/new2.jpg";
File imagefile = new File(filepath);
FileOutputStream fos = new FileOutputStream(imagefile);
bitmapimage.compress(CompressFormat.JPEG, 100, fos); 
```

如果我在某处出错或是否应该使用其他方法来操作 JPG 像素值，请帮助我...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:53:38.113

JPEG 是一种通常基于[有损压缩](http://en.wikipedia.org/wiki/Lossy_compression)的图像格式。这意味着一些对人眼不重要的信息被丢弃以进一步缩小文件大小。尝试将图像保存为 PNG（无损格式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-07T22:44:47.817

使用时要小心

```
Bitmap bi = BitmapFactory.decodeStream(fis);
bi = bi.copy(Bitmap.Config.ARGB_8888, true); 
```

在您获得第`bi`一个信息时，您可能已经丢失了很多信息，而是尝试使用`BitmapFactory.Options`to force `8888`（这也是默认设置）：

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inPreferredConfig = Bitmap.Config.ARGB_8888;
options.inDither = false;
Bitmap bi = BitmapFactory.decodeStream(fis, options); 
```

如果你留下来，`copy`你应该仍然`recycle()`是你扔掉的那个。

# delphi - 将数据从数据集结构移动到另一个结构的更快方法（在 TDatasetProvider 中）

> ID：10234325
> 
> 赞同：12
> 
> 时间：2012-04-19T18:19:47.380
> 
> 标签：delphi, tclientdataset, tdatasetprovider

我有一个自定义的 TDatasetProvider，它允许为它提供的任何数据创建新字段。

因此，假设您在原始数据集上获得了以下字段：

*   客户ID
*   姓名
*   年龄

您需要使用显示位图在 DBGrid 上选择它。好吧，你可以，因为我的 DSP 可以添加一个调用`Selected`数据集数据的布尔字段。

我现在这样做的方式：

1.  创建 2 个 TClientDataset 对象（Origin 和 Target）
2.  在 Origin 中，我加载了从 InternalGetRecords 方法的参数中获取的数据（我覆盖了它）
3.  在 Target 中，我创建了从 Origin 数据集定义的 fielddef，并添加了开发人员在设计时创建的 fielddef
4.  在目标上执行 CreateDataset
5.  并且，逐行（和逐字段）将数据从 Origin 数据库复制到 Target 数据集
6.  最后，将 Data 变量作为 InternalGetRecords 的返回值返回。

我真的不知道是否有更优雅（更快）的方式来做到这一点。还有另一种（更快和/或优雅）的方式来获得这个结果吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T14:59:55.613

从源数据集加载数据后，似乎可以调用[`IDSBase.AddField`](http://docs.embarcadero.com/products/rad_studio/radstudio2007/RS2007_helpupdates/HUpdate4/EN/html/delphivclwin32/DSIntf_IDSBase_AddField@pDSFLDDesc.html)添加更多字段：

```
uses
  DB, DBCommon, DBClient, DSIntf;

type
  THackClientDataSet = class(TClientDataSet);

procedure EncodeFieldDesc(var FieldDesc: DSFLDDesc;
  const Name: string; DataType: TFieldType; Size, Precision: Integer;
  Calculated: Boolean; Attributes: TFieldAttributes);
begin
  // ... copied from TClientDataSet.EncodeFieldDesc
end;

//...
var
  FldDesc: DSFLDDesc;
begin
  FillChar(FldDesc, SizeOf(FldDesc), 0);
  EncodeFieldDesc(FldDesc, 'SELECTED', ftBoolean, 0, 0, False, []);
  with THackClientDataSet(DataSet) do
    Check(DSBase.AddField(@FldDesc));
  // now you can create a second client dataset and assign it DataSet.Data directly:
  // DataSet2.Data := DataSet.Data;
  // DataSet2 now contains the new field (with empty values in all existing records)
end; 
```

我没有彻底测试它，但上面的简单示例按预期工作，我能够导航第二个客户端数据集并像往常一样编辑所有字段的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:25:51.443

最快的方法是使用`CloneCursor`. 像这样的东西：

1.  创建 2 个 TClientDataset 对象（Origin 和 Target）
2.  在 Origin 中，加载从 InternalGetRecords 方法的参数中获取的数据
3.  在 Target 中，创建从 Origin 数据集定义的 fielddefs，并添加开发人员在设计时创建的 fielddefs
4.  `Target.CloneCursor(Origin); //there are more params than this, but this is the basic idea`
5.  Target 现在将包含与 Origin 相同数据的新视图，但受 Target 上存在的任何字段、过滤器等的限制。（如果您没有定义任何字段，它将复制 Origin 的字段。如果您确实定义了字段，那么它会坚持您提供的内容。）
6.  从 Target 复制数据，这应该正是您正在寻找的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T20:14:33.363

I have a sample that adds fields to a CDS dynamically, using anonymous methods for the calculations of individual fields, to achieve more flexibility. Before opening the CDS, you add the calculated fields, than open it..

Is this is what you are looking for? The question is not very clear...

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-19T19:26:36.250

您可以使用 TClientDataset 的 Data 属性复制整个数据集、元数据和数据。这应该是将一个 TClientDataset 复制到另一个的最快方法。

请参阅[http://docwiki.embarcadero.com/RADStudio/en/Assigning_Data_Directly](http://docwiki.embarcadero.com/RADStudio/en/Assigning_Data_Directly)

# python - 在 Pyramid 上将 POST 请求限制为最大大小

> ID：10234326
> 
> 赞同：4
> 
> 时间：2012-04-19T18:19:48.373
> 
> 标签：python, web-services, http, post, pyramid

我正在使用 Pyramid 编写一个 Web 应用程序，并希望限制 POST 请求的最大长度，这样人们就不能发布大量数据并耗尽服务器上的所有内存。然而，我几乎在所有我能想到的地方（Pyramid、WebOb、Paster）都找了找，但找不到任何选择来完成这个任务。我已经看到 Paster 对 HTTP 标头的数量、每个标头的长度等有限制，但是对于请求正文的大小，我没有看到任何东西。

服务器将只接受 JSON-RPC 的 POST 请求，因此我不需要允许巨大的请求正文大小。金字塔堆栈中是否有办法实现这一点？

以防万一这在其他方面并不明显，在检查长度并返回 4xx 错误代码之前必须接受整个请求正文并将其加载到内存中的解决方案违背了我正在尝试做的事情的目的，而不是我在找什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T01:25:33.670

不是真正直接回答您的问题。据我所知，您可以创建一个 wsgi 应用程序，如果主体低于配置设置，则该应用程序将加载请求，您可以将其传递给下一个 WSGI 层。如果超出，您可以停止阅读并直接返回错误。

但老实说，我真的不明白在金字塔中做这件事的意义。例如，如果您使用 nginx 或 apache 或其他东西在反向代理后面运行金字塔。您始终可以限制前端服务器的请求大小。

除非您想在没有任何代理的情况下直接使用 Waitress 或 Paster 运行金字塔，否则您应该在前端服务器中处理应该比 python 更有效的 body size。

**编辑**

我做了一些研究，这不是一个完整的答案，但我猜这里有一些可以使用的东西。据我所知，您必须阅读 environ['wsgi_input'] 。这是一个类似对象的文件，例如从 nginx 或 apache 接收数据块。

您真正需要做的是读取该文件，直到达到最大长度。如果达到它，如果它不继续请求，则会引发错误。

你可能想看看这个[答案](https://stackoverflow.com/questions/1783383/how-do-i-copy-wsgi-input-if-i-want-to-process-post-data-more-than-once)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T11:58:34.060

您可以通过多种方式做到这一点，这里有几个例子。一种使用基于 webob 的 wsgi 中间件（在您安装金字塔时安装）。和一个使用金字塔[事件机制的](http://docs.pylonsproject.org/projects/pyramid/en/1.2-branch/narr/events.html)

```
"""
restricting execution based on request body size
"""
from pyramid.config import Configurator
from pyramid.view import view_config
from pyramid.events import NewRequest, subscriber
from webob import Response, Request
from webob.exc import HTTPBadRequest
import unittest

def restrict_body_middleware(app, max_size=0):
    """
    this is straight wsgi middleware and in this case only depends on
    webob. this can be used with any wsgi compliant web
    framework(which is pretty much all of them)
    """
    def m(environ, start_response):
        r = Request(environ)
        if r.content_length <= max_size:
            return r.get_response(app)(environ, start_response)
        else:
            err_body = """
            request content_length(%s) exceeds
            the configured maximum content_length allowed(%s)
            """ % (r.content_length, max_size)
            res = HTTPBadRequest(err_body)
            return res(environ, start_response)

    return m

def new_request_restrict(event):
    """
    pyramid event handler called whenever there is a new request
    recieved

    http://docs.pylonsproject.org/projects/pyramid/en/1.2-branch/narr/events.html
    """
    request = event.request
    if request.content_length >= 0:
        raise HTTPBadRequest("too big")

@view_config()
def index(request):
    return Response("HI THERE")

def make_application():
    """
    make appplication with one view
    """
    config = Configurator()
    config.scan()
    return config.make_wsgi_app()

def make_application_with_event():
    """
    make application with one view and one event subsriber subscribed
    to NewRequest
    """
    config = Configurator()
    config.add_subscriber(new_request_restrict, NewRequest)
    return config.make_wsgi_app()

def make_application_with_middleware():
    """
    make application with one view wrapped in wsgi middleware
    """
    return restrict_body_middleware(make_application())

class TestWSGIApplication(unittest.TestCase):
    def testNoRestriction(self):
        app = make_application()
        request = Request.blank("/", body="i am a request with a body")
        self.assert_(request.content_length > 0, "content_length should be > 0")
        response = request.get_response(app)
        self.assert_(response.status_int == 200, "expected status code 200 got %s" % response.status_int)

    def testRestrictedByMiddleware(self):
        app = make_application_with_middleware()
        request = Request.blank("/", body="i am a request with a body")
        self.assert_(request.content_length > 0, "content_length should be > 0")
        response = request.get_response(app)
        self.assert_(response.status_int == 400, "expected status code 400 got %s" % response.status_int)

    def testRestrictedByEvent(self):
        app = make_application_with_event()
        request = Request.blank("/", body="i am a request with a body")
        self.assert_(request.content_length > 0, "content_length should be > 0")
        response = request.get_response(app)
        self.assert_(response.status_int == 400, "expected status code 400 got %s" % response.status_int)

if __name__ == "__main__":
    unittest.main() 
```

# linux - 将 bash `ls` 输出转换为 json 数组

> ID：10234327
> 
> 赞同：27
> 
> 时间：2012-04-19T18:19:51.073
> 
> 标签：linux, json, bash, ubuntu, sh

是否可以使用 bash 脚本将输出格式化为`ls`json 数组？要成为有效的 json，目录和文件的所有名称都需要用双引号括起来，用逗号分隔，整个东西需要用方括号括起来。即转换：

```
jeroen@jeroen-ubuntu:~/Desktop$ ls
foo.txt bar baz 
```

至

```
[ "foo.txt", "bar", "baz" ] 
```

编辑：我非常喜欢可以在我所有的 Linux 服务器上运行的东西；因此宁愿不依赖 python，而是有一个纯粹的 bash 解决方案。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-19T18:28:21.073

是的，但是极端情况和 Unicode 处理会让你陷入困境。最好委托给原生支持它的脚本语言。

```
$ ls
あ  a  "a"  à  a b  私
$ python -c 'import os, json; print json.dumps(os.listdir("."))'
["\u00e0", "\"a\"", "\u79c1", "a b", "\u3042", "a"] 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-09-02T13:26:09.037

如果您知道没有文件名包含换行符，请使用 jq：

`ls | jq -R -s -c 'split("\n")[:-1]'`

对 jq 的标志的简短解释：

*   `-R`将输入视为字符串而不是 JSON
*   `-s`将所有行加入一个数组
*   `-c`创建紧凑的输出
*   `[:-1]`删除输出数组中的最后一个空字符串

这需要 jq 1.4 或更高版本。如果它不适合你，试试这个：

`ls | jq -R '[.]' | jq -s -c 'add'`

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-04-19T18:38:50.040

您好，您可以使用 sed 和 awk 做到这一点：

```
ls | awk ' BEGIN { ORS = ""; print "["; } { print "\/\@"$0"\/\@"; } END { print "]"; }' | sed "s^\"^\\\\\"^g;s^\/\@\/\@^\", \"^g;s^\/\@^\"^g" 
```

编辑：更新以解决`"`和空格的问题。我`/@`用作 的替换模式`"`，因为`/`它不是文件名的有效字符。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-04-19T19:23:02.267

使用 perl 作为编码器；它保证不会出现故障，无处不在，并且使用管道，它仍然相当干净：

```
ls | perl -e 'use JSON; @in=grep(s/\n$//, <>); print encode_json(\@in)."\n";' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-08T12:16:11.380

大多数Linux机器已经有python。你所要做的就是：

```
python -c 'import os, json; print json.dumps(os.listdir("/yourdirectory"))' 
```

这是为了 . directory ，您可以添加任何路径。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-04T01:22:41.517

我还在寻找一种将 Linux 文件夹/文件树输出到某个 JSON 或 XML 文件的方法。为什么不使用这个简单的终端命令：

```
$ tree --dirsfirst --noreport -n -X -i -s -D -f -o my.xml 
```

所以，只需 linux tree 命令，并配置您自己的参数。这里`-X`给出了 XML 输出！对我来说，没关系，我想有一些脚本可以将 XML 转换为 JSON ..

注意：我认为[这](https://unix.stackexchange.com/questions/90115/convert-output-of-tree-command-to-json-format/)涵盖了同样的问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-19T18:35:50.693

这是一个 bash 行

```
echo '[' ; ls --format=commas|sed -e 's/^/\"/'|sed -e 's/,$/\",/'|sed -e 's/\([^,]\)$/\1\"\]/'|sed -e 's/, /\", \"/g' 
```

无法正确处理`"`,`\`或文件名中的一些逗号。此外，如果`ls`在文件名之间放置换行符，也会如此。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-19T18:23:48.313

个人而言，我会编写运行命令 ls 的脚本，将输出发送到您选择的文件，同时解析输出以将其格式化为有效的 JSON 格式。

我确信一个简单的 Bash 文件就可以完成这项工作。

[Bash 输出](http://www.skorks.com/2009/09/output-redirection-with-bash/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-19T18:28:51.030

你不能使用这样的python脚本吗？

```
myOutput = subprocess.check_output["ls"]
output = ["+str(e)+" for e in myOutput]
return output 
```

我没有检查它是否有效，但您可以在[此处找到规范](http://docs.python.org/library/subprocess.html#module-subprocess)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-04-19T18:32:57.677

应该很容易。

```
$ cat ls2json.bash
#!/bin/bash
echo -n '['
for FILE in $(ls | sed -e 's/"/\\"/g')
do
echo -n \"${FILE}\",
done
echo -en \\b']' 
```

然后运行：

```
$ ./ls2json.bash > json.out 
```

但是python会更容易

```
import os
directory = '/some/dir'
ls = os.listdir(directory)
dirstring = str(ls)
print dirstring.replace("'",'"') 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-04-19T18:41:04.280

不要使用 bash，使用脚本语言。未经测试的 perl 示例：

```
use JSON;
my @ls_output = `ls`; ## probably better to use a perl module to do this, like DirHandle
print encode_json( @ls_output ); 
```

# android - onbackpressed() 方法崩溃

> ID：10234334
> 
> 赞同：-1
> 
> 时间：2012-04-19T18:20:14.957
> 
> 标签：android

我正在使用身份验证进入页面，经过身份验证后只有用户进入页面。我为 onbackpressed() 编写了一个代码，但它不起作用。这里 DatabaseDemo 和 Login 是两个类。当我按下后退按钮时，将显示带有用户名和密码的登录类。

```
public class DatabaseDemo extends TabActivity {
    DatabaseHelper dbHelper;
    GridView grid;
    TextView txtTest;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        SetupTabs();
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu)
    {
        menu.add(1, 1, 1, "Add Employee");
        return true;
    }
    public boolean onOptionsItemSelected(MenuItem item)
    {
        switch (item.getItemId())
        {
        //Add employee
        case 1:
            Intent addIntent=new Intent(this,AddEmployee.class);
            startActivity(addIntent);
            break;
        }
        super.onOptionsItemSelected(item);
        return false;
    }
    void SetupTabs()
    {
        TabHost host=getTabHost();
        TabHost.TabSpec spec=host.newTabSpec("tag1");
        Intent in1=new Intent(this, AddEmployee.class);
        spec.setIndicator("Add Employee");
        spec.setContent(in1);

        TabHost.TabSpec spec2=host.newTabSpec("tag2");
        Intent in2=new Intent(this, GridList.class);

        spec2.setIndicator("Employees");
        spec2.setContent(in2);

        host.addTab(spec);
        host.addTab(spec2);
    }
    @Override
    public void onBackPressed() 
    {
        Intent i = new Intent(DatabaseDemo.this, Login.class);
        startActivity(i);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:42:58.473

您可以在后按时启动登录，因此如果它崩溃了，那么您的登录活动很可能有问题，而不是在这里。

# java - 将信息从 Android 发布到 PHP 服务器

> ID：10234343
> 
> 赞同：3
> 
> 时间：2012-04-19T18:20:48.360
> 
> 标签：java, php, android

所以我正在编写一个Android应用程序，其中一部分应该使用GPS来获取经度/纬度。这些值应该发布到我也在运行的 PHP 服务器上。我发布的功能如下：

```
public void doAll() {

Double locLat, locLon;
    try {
    locLat = locManager.getLastKnownLocation(locProvider).getLatitude();
    locLon = locManager.getLastKnownLocation(locProvider).getLongitude();
    } catch (NullPointerException e) {
    locLat = -1.0;
    locLon = -1.0;
    }
try {

    HttpClient client = new DefaultHttpClient();
    //we put all the parameters in the URL itself
    HttpPost request = new HttpPost("http://fatalatour.com/database.php?function=get_all&latitude="+Double.toString(locLat)+"&longitude="+Double.toString(locLon));

    ResponseHandler <String> responseHandler = new BasicResponseHandler();

   //List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
   //nameValuePairs.add(new BasicNameValuePair("latitude", Double.toString(locLat)));
   //nameValuePairs.add(new BasicNameValuePair("longitude", Double.toString(locLon)));
   //request.setEntity(new UrlEncodedFormEntity(nameValuePairs));

   String response = client.execute(request, responseHandler);
   Log.i("HOMI_RESPONSE", response.toString()); 
```

}

还有其他代码，但我相信这实际上会影响 locLat 和 locLon 的发布。

对于服务器端，我有：

```
function get_all() {
            $lat = trim($_GET['latitude']);
            $lon = trim($_GET['longitude']);
            // DEBUG
            $f = fopen('debug.log', 'a');
            fprintf($f, 'get_all: '.print_r($_REQUEST, true)."\n");
            $result = mysql_query("SELECT * FROM homi_table");

            $num = 0; //# of homicides

            while ($row = mysql_fetch_assoc($result)) {
                    $d = distance($row['latitude'], $row['longitude'], $lat, $lon, "K");
                    if ($d < 100) { //number to change for distance filter
                            $num += 1;
        echo "fatality:".$row['slug']."~".strtoupper($row['name']).", Age ".$row['age']."\n".$row['date']."\nhttp://projects.latimes.com/homicide/post/".$row['slug']."~".$row['latitude']."~".$row['longitude'];

                            // GH: limiting the number of results to 100
                            if ($num == 100) {
                                    break;
                            }
                    }
            };
            echo $num;
            fprintf($f, "get_all: returning: ".$num."\n");
    } 
```

现在的问题似乎是 $lat 和 $lon 的处理。当我为 PHP 中的每个人硬编码一个静态数字时，该应用程序可以工作，但是当我将其保留为变量时（应该如此），它会失败。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:26:42.493

在 Android 应用程序中您使用 POST 请求，在 PHP 中您读取 GET 参数。我的脑海中没有别的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:00:51.663

您构建的 URL 看起来像 HTTP Get，而不是 Post。Post 会将数据发布在请求的正文中。

如果您不介意 URL 中公开的参数，我只需在 Android 代码中将 HTTPPost 更改为 HTTPGet。如果您不希望这些内容出现在 URL 中，则必须稍微修改 Android 帖子（我相信这类似于您注释掉的代码）并更改 php 代码以访问 $_POST 变量。

# asp.net-mvc - 视图中的asp.net mvc 3模型

> ID：10234344
> 
> 赞同：0
> 
> 时间：2012-04-19T18:20:49.300
> 
> 标签：asp.net-mvc, razor

我怎样才能在视图中有这个模型

```
public class PostDetailsViewModel
{
    public Post Posts1 { get; set; }
    public IEnumerable<Post> Posts2 { get; set; }
} 
```

看法

```
@model IEnumerable<forum3.ViewModels.PostDetailsViewModel>
@foreach (var item in Model)
{
   <span>@item.Posts1.Title</span><br />  
   <p>@item.Posts1.Question</p><br /><br />   
} 
```

控制器

```
 public ViewResult PostDetails(int id)
    {
        PostDetailsViewModel postdetailsviewmodel = new PostDetailsViewModel();
        postdetailsviewmodel.Posts1 = postRepository.Find(id);
        postdetailsviewmodel.Posts2 = postRepository.FindPostByParentIds(id);
        List<PostDetailsViewModel> postDetailsList = new List<PostDetailsViewModel>();
        postDetailsList.Add(postdetailsviewmodel);
        return View(postDetailsList);
    } 
```

我如何才能在视图中有 post2 是答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:44:14.747

假设您要显示问题列表及其答案，并让您的 View 模型像这样。

（**我将 Post1 更改为 Question 并将 Posts2 更改为 Answers 以提高可读性**）

```
public class PostDetailsViewModel
{
    public Post Question { get; set; }
    public List<Post> Answers { get; set; }
}
public class Post
{
    public int ID { set; get; }
    public string Title { set; get; }
} 
```

假设您的控制器返回 PostDetailsViewModel 列表，并且 PostDetailsViewModel 具有 Post 类型的 Question 属性和 List 类型的 Answers 属性

```
public ActionResult Posts()
{
  List<PostDetailsViewModel> objVMLsit = new List<PostDetailsViewModel>();
  //add the object to objVMList here   

  return View(objVMLsit);
} 
```

此视图将为您提供输出

```
@model List<MvcApplication1.Models.PostDetailsViewModel>
@foreach (var item in Model)
{
  <h2>@item.Question.Title</h2><br />  
  foreach (var answer in item.Answers)
  {
        <p>@answer.Title</p>
  }   
} 
```

**编辑：看到您的控制器操作方法后**，我想您想显示一个特定的帖子（问题）及其答案。因此，只需将一个 PostViewModel 对象从操作返回到您的视图，而不是返回它们的列表

```
public ViewResult PostDetails(int id)
{
    PostDetailsViewModel postdetailsviewmodel = new PostDetailsViewModel();
    postdetailsviewmodel.Question= postRepository.Find(id);
    postdetailsviewmodel.Answers= postRepository.FindPostByParentIds(id);
    return View(postdetailsviewmodel);
} 
```

并像这样更改您的视图

```
@model MvcApplication1.Models.PostDetailsViewModel
<h2>@Model.Question.Title</h2><br />  
@foreach (var answer in Model.Answers)
{
   <p>@answer.Title</p>
} 
```

# mysql - 如何在 3 个表之间限制标签

> ID：10234345
> 
> 赞同：3
> 
> 时间：2012-04-19T18:20:52.803
> 
> 标签：mysql, tags, constraints

我正在开发一个标签系统，它应该做的是你可以有一个查询和选定的标签，例如,`jquery`的标签。它应该只显示与查询相关的脚本并且只显示具有标签的脚本。这是数据库布局：`javascript``library`

脚本表：

```
+-----------+---------------+
| script_id | name          |
+-----------+---------------+
|         1 | jQuery        |
|         2 | Sencha Touch  |
|         3 | Codeigniter   |
|         4 | Google Chrome |
|         5 | memcached     |
|         6 | PHP           |
|         7 | MooTools      |
|         8 | node.js       |
|         9 | jQuery Mobile |
+-----------+---------------+ 
```

标签表：

```
+--------+-------------+-------------+
| tag_id | name        | url_name    |
+--------+-------------+-------------+
|      1 | JavaScript  | javascript  |
|      2 | Library     | library     |
|      3 | PHP         | php         |
|      4 | MySQL       | mysql       |
|      5 | Cache       | cache       |
|      6 | HTML        | html        |
|      7 | Open source | open-source |
+--------+-------------+-------------+ 
```

标记表：

```
+-----------+--------+-----------+
| tagged_id | tag_id | script_id |
+-----------+--------+-----------+
|         1 |      1 |         1 |  # javascript -- jQuery
|         2 |      2 |         1 |  # library    -- jQuery
|         3 |      1 |         9 |  # javascript -- jQuery mobile
+-----------+--------+-----------+ 
```

当我运行我的 SQL 时，它仍然会启动，`jQuery Mobile`但它不应该，因为它不包含`library`where dos 的标签`jQuery`，我需要它来约束必须满足所选标签的结果。

这是我的 SQL：

```
SELECT scripts.script_id,
       scripts.name
FROM
(
    scripts scripts

    LEFT OUTER JOIN tagged tagged ON tagged.script_id = scripts.script_id

    LEFT OUTER JOIN tags tags ON tags.tag_id = tagged.tag_id
)
WHERE MATCH(scripts.name) AGAINST ('jquery*' IN BOOLEAN MODE) AND ( tags.url_name = 'javascript' OR tags.url_name = 'library' )
GROUP BY script_id
ORDER BY scripts.name
LIMIT 0, 25 
```

它返回：

```
+-----------+---------------+
| script_id | name          |
+-----------+---------------+
|         1 | jQuery        |
|         9 | jQuery Mobile |
+-----------+---------------+ 
```

如果我更改`OR`为`AND`，它根本不会返回任何东西，或者如果我从标签`(`和中删除括号`)`，它也不会返回任何东西。

如何使查询约束标签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:54:42.587

试试这个：

```
select s.script_id, s.name from scripts s
join tagged tj on s.script_id = tj.script_id
join tags t on t.tag_id = tj.tag_id
where s.name like 'jQuery%' and t.url_name in ('javascript', 'library')
group by s.script_id, s.name
having count(*) = 2
order by s.name
limit 25 
```

唯一需要考虑的是，`2`必须用`in`子句中的元素数量替换。

这是[小提琴](http://sqlfiddle.com/#!2/0c24c/1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T09:18:09.037

您的解决方案的主要问题是它在连接在一起时会创建多行，但每一行只有一个标签值。如果您使用 OR 条件，则任何匹配的标签都足以返回。使用 AND 没有行可以有两个不同的值。

在将它们组合在一起之前，会生成三个单独的行：

```
+-----------+-----------+---------------+
|     tag_id| script_id | name          |
+-----------+-----------+---------------+
|         1 |         1 | jQuery        |
|         2 |         1 | jQuery        |
|         1 |         9 | jQuery Mobile |
+-----------+-----------+---------------+ 
```

要解决这个问题，您必须使用 OR 条件，但在组之后，使用

```
HAVING count(tag_id) = 2 
```

这告诉 sql，根据他们有多少标签来评估每个组，并只留下那些正好有 2 个标签的组。

因此，基于您的代码的解决方案：

```
SELECT scripts.script_id,
       scripts.name
FROM
(
    scripts scripts

    LEFT OUTER JOIN tagged tagged ON tagged.script_id = scripts.script_id

    LEFT OUTER JOIN tags tags ON tags.tag_id = tagged.tag_id
)
WHERE MATCH(scripts.name) AGAINST ('jquery*' IN BOOLEAN MODE) AND ( tags.url_name = 'javascript' OR tags.url_name = 'library' )
GROUP BY script_id
HAVING count(tag_id) = 2
ORDER BY scripts.name
LIMIT 0, 25 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:53:13.500

我的尝试：

```
SELECT s.script_id, s.name, so_tags.url_name 
  FROM so_scripts s 
       LEFT JOIN so_tagged USING (script_id) 
       LEFT JOIN so_tags USING (tag_id)
  WHERE s.script_id IN 
  (
    SELECT td.script_id FROM so_tagged td 
      LEFT JOIN so_tags t USING (tag_id) 
    WHERE t.url_name = "javascript" OR t.url_name = "library"
  ) 
GROUP BY url_name HAVING COUNT(s.name) = 2 
```

这有点像 hack，它首先查找与任何标签匹配的所有条目，然后按名称分组并仅返回那些匹配数量等于提供的标签数量的条目:)

不确定 3、4 或更多标签的速度有多快，但至少它可以工作:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T18:43:50.670

```
SELECT s.script_id,
       s.name
FROM
        scripts AS s
    INNER JOIN 
        tagged AS st1
      ON  st1.script_id = s.script_id
    INNER JOIN tags AS tag1
      ON  tag1.tag_id = st1.tag_id
      AND tag1.url_name = 'javascript'
    INNER JOIN 
        tagged AS st2
      ON  st2.script_id = s.script_id
    INNER JOIN tags AS tag2
      ON  tag2.tag_id = st2.tag_id
      AND tag2.url_name = 'library'
ORDER BY s.name
LIMIT 0, 25 
```

# android - ExpandableListView 缓慢展开

> ID：10234349
> 
> 赞同：1
> 
> 时间：2012-04-19T18:21:07.937
> 
> 标签：android, expandablelistview

如何在android中的expandableListView中增加展开动作的持续时间

当我打电话时在我的代码中

```
 expList.expandGroup(gp); 
```

它膨胀得非常快......我希望它慢慢膨胀，看起来好像在滑动

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:35:10.733

我认为[这个问题](https://stackoverflow.com/questions/2385567/animation-for-expandablelistview)与您的问题相似，因此可能对您有用。似乎正确的方法是将其视为动画，在这种情况下，上述问题的答案将适用；似乎（不幸的是）最简单的方法是使用常规`ListView`并自己处理扩展和动画。

# iphone - iOS/iPhone 从 GLKViewController 获取 FrameBuffer

> ID：10234360
> 
> 赞同：1
> 
> 时间：2012-04-19T18:21:24.387
> 
> 标签：iphone, ios, opengl-es

如何从 iOS/iPhone 上的“GLKViewController”获取 FrameBuffer 或 RenderBuffer，以便将其传递给“glBindFramebuffer”？

我正在尝试渲染到 RenderTarget，然后切换回主 BackBuffer 以呈现其他信息。

在所有其他平台“Windows、OSX、Linux 和 Android”上设置 'glBindFramebuffer(GL_FRAMEBUFFER, 0);' 为 '0' 会导致系统设置默认 FrameBuffer。为什么这在 iOS 上有所不同？

我还注意到'GLKView'有'bindDrawable'方法，基本上是'glBindFramebuffer'......这个方法在'GLKViewController'中在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:56:36.167

Awww dur，我只是从“GLKViewController.View”获取“GLKView”并从那里调用“bindDrawable”。

# android - 推送通知以获取设备位置

> ID：10234364
> 
> 赞同：2
> 
> 时间：2012-04-19T18:21:42.997
> 
> 标签：android, push-notification

嗨，我想在 android 设备上使用推送通知并获取设备位置以获取更多
信息服务器及时。
我不能使用云到设备消息服务，因为该服务需要该用户首先在线并在用户在线后使用 C2DM 服务发送服务器通知！但是我想在服务器需要的任何时候向设备发送通知并获取设备位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:32:19.230

1.  要使任何类型的推送通知成为可能，您的客户需要在线。离线客户端在在线之前无法接受推送通知。

2.  C2DM 推送可以由服务器发起。无需客户端启动。服务器只需向 C2DM 服务器发送一条消息，就会发送通知。

3.  您基本上需要做的是，在收到来自 C2DM 服务器的通知后，让您的 C2DM 基本接收器调用一个函数，该函数使用检索客户端位置数据`LocationManager`并将其发送到服务器。

编辑 MQTT：

我自己没做过这么多，但它可以用于推送服务

你需要：

在服务器端运行的 MQTT 代理，例如开源的 mosquitto 代理。

您包含在 Android 应用程序中的 MQTT 客户端库，使您的应用程序能够连接、订阅和发布消息。参考这个[http://mqtt.org/software](http://mqtt.org/software)

想出一种唯一标识用户或设备的方法，然后将其用作主题，以便您可以将消息单独发布到一个设备。

# node.js - Node.js - 并发读写对象

> ID：10234366
> 
> 赞同：2
> 
> 时间：2012-04-19T18:21:56.890
> 
> 标签：node.js

嗯，我一直在找这个话题，但没有找到，所以我会问你：

我需要频繁地在服务器上的数组上读写，所以我决定不使用数据库，但我不知道最佳实践是什么？这将是很多数据，它可以是一个javascript数组吗？是否可以以非阻塞方式读写但避免并发问题？

它是一款MMORPG，多人在线游戏，数据为所有玩家在线。该过程将在玩家所做的几乎每一步都写在上面，然后再阅读。我在想一个子进程，或者更快更不阻塞的进程，但我什至知道子进程是什么哈哈！

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T18:54:43.500

由于 Node.js 是单线程的，因此无论何时您的代码正在执行某项操作，它都会在技术上阻止该进程执行其他任何操作。一旦它到达等待回调的点，Node 将开始处理其他请求，直到您的回调返回。多少数据是“很多”？你需要对数据做什么？

如果您没有对数据进行太多处理，并且有很多数据，那么数据库解决方案不会是一个坏主意。数据库（MongoDB、Redis 等）的节点驱动程序是异步且非阻塞的，因此 Node 在交错调用方面做得很好，从而能够同时处理大量调用。使用这样的存储（而不仅仅是在内存中）还意味着您可以使用 Node 集群来启动多个节点进程，以在您的机器上使用多个核心（以及使用多台机器）来响应请求。

如果您没有对数据进行太多处理，并且数据集非常小，并且您不关心在 Node 进程之间共享数据，那么当然，只需将其以您想要的任何数据结构保存在内存中即可。数组、字典或类似 LRU 缓存的东西。

如果您正在对数据进行大量处理，并且有很多数据，那么您需要做更多的工作，因为这不是节点的最大优势（处理阻塞了唯一的线程，这意味着它可以'不处理额外的请求）。我建议使用 PubSub 模型，它具有非阻塞队列，工作进程处理处理。

# ios - UITableViewCellAccessoryCheckmark 的默认颜色是什么？

> ID：10234368
> 
> 赞同：1
> 
> 时间：2012-04-19T18:22:11.593
> 
> 标签：ios, cocoa-touch, uitableview

我希望所选单元格中的文本与 UITableViewCellAccessoryCheckmark 附件的颜色相同。这是作为常数存储在某处吗？如果不是，它作为 RGB 的值是多少？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T19:46:44.640

没有定义常数，在 IB（StoryBoard）结果中测量到 #213D71。

![在此处输入图像描述](../Images/cbdfb4814f14be58694d0bd2143312bb.png)

使用扩展名为[Hex Color Picker](http://wafflesoftware.net/hexpicker/)的 ColorPicker 完成测量。

# git - Git 合并默认没有快进

> ID：10234369
> 
> 赞同：3
> 
> 时间：2012-04-19T18:22:11.560
> 
> 标签：git, merge

> **可能重复：**
> [我可以在 git 中默认关闭快速转发吗？](https://stackoverflow.com/questions/2500296/can-i-make-fast-forwarding-be-off-by-default-in-git)

有没有办法让 git 默认不进行快进合并？当我完成一个功能并将我的功能分支合并回主线时，我总是忘记添加 --no-ff。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-19T18:26:12.460

是的。使用 git config 设置 merge.ff。( [http://schacon.github.com/git/git-config.html](http://schacon.github.com/git/git-config.html) )

```
git config merge.ff false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:25:56.613

如果您在命令行上使用 Git，那么您应该为常用命令/选项使用别名。它们是使 Git 痛苦或有用之间的区别：

```
alias gm="git merge --no-ff" 
```

# javascript - 如何手动触发 ForeSee 调查对话框以使用 javascript 显示？或网址参数？

> ID：10234377
> 
> 赞同：3
> 
> 时间：2012-04-19T18:22:47.703
> 
> 标签：javascript

我无法找到[ForeSee](http://foreseeresults.com/)的任何 API 文档，并且我收到了与随机显示的 ForeSee 调查提示对话框相关的错误报告。我已经尝试清除缓存和cookie，但它还没有显示给我，有没有办法用javascript触发它的显示？或者可能使用某些 URL 参数？

在`foresee-trigger.js`我更新了`FSR.sites`数组以包含对 localhost 的引用：

```
var FSR = {
    'version': '7.0.0',
    'date': '01/01/2011',
    'enabled': true,
    'auto' : true,
    'encode' : true,
    'files': './foresee/', //default path when no match below         
    'id': 'etc',
    'sites': [
    /* several existing ones, etc.*/
    {
        name: 'localhost',
        path: 'localhost',
        files: '//localhost/subdirectory/foresee/',
        domain: 'localhost'
    },{
        path: '.',
        domain: 'default'
    }]
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T04:47:49.243

您应该能够通过点击与 predict-trigger.js 文件位于同一目录中的“fsradmin.html”页面手动设置当前会话的采样百分比。例如，localhost/YourApp/scripts/foresee/fsradmin.html。将抽样百分比设置为 100% 将确保您遇到调查。

另一种选择是在这里更改 predict-surveydef.js 文件中的实际采样百分比：

> 标准： {
> 
> > ```
> >  sp: 75,  //this is the sampling % - set it to 100 to ensure that it appears
> >    lf: 1  // loyalty factor, (the # of pages the user has to hit before it appears) 
> > ```
> > 
> > },

如果您选择了第二个选项，请务必在部署代码之前将采样百分比设置回原始值，否则每个人都会得到调查。

最后是他们文档的链接：http: [//demo.foreseeresults.com/_code/docs/ForeSee_Trigger_Code_Implementation_Guide.pdf](http://demo.foreseeresults.com/_code/docs/ForeSee_Trigger_Code_Implementation_Guide.pdf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-12T11:51:45.383

FSR.showInvite(); 只有当 Foresee 还没有向用户显示时才会显示，这意味着 cookie 还没有创建。如果要验证，请先清除缓存。加载编写预见代码的页面并在开发人员控制台中触发上述命令。它将显示调查对话框。

# linq - 在 linq to sql 的 foreach 循环中使用联合

> ID：10234378
> 
> 赞同：1
> 
> 时间：2012-04-19T18:22:50.470
> 
> 标签：linq

在下面的代码中，我希望 retrn n 行，但它总是返回零行，因为我的初始集有零记录。理想情况下，它应该执行 UNION ALL 并返回整数列表中所有整数的记录 clearTotals{6,7,8,9,17} 知道如何去做吗？

```
 var tbl = (from a in db.Applicants
    where a.Id == null
    select new { a.Id, a.Firstname, a.Lastname });
    int thisTag;
    foreach (int c in clearanceTotals)
    {
        switch (c)
        {
            case 6:
                thisTag = 38;
                break;
            case 8:
                thisTag = 39;
                break;
            case 17:
                thisTag = 39;
                break;
            case 7:
                thisTag = 42;
                break;
            case 9:
                thisTag = 44;
                break;
        }
        tbl = (from a in db.Applicants
               join ad in db.ApplicantDeployments on a.Id equals ad.ApplicantId
               join aa in db.ApplicantAttachments on a.Id equals aa.ApplicantId
               where a.Nationality == 15 && a.DoNotUse == false && a.ClearanceStatus == c
               && aa.Tag == thisTag
               select new { a.Id, a.Firstname, a.Lastname }).Union(tbl);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:58:04.843

我认为问题在于您在查询中捕获了循环变量 ( `c`)，因此在执行查询时，它仅使用 c 的最新值。尝试将 c 复制到循环内的变量中：

```
foreach (int c in clearanceTotals)
{
    int c2 = c;
    ...

        ...
        where a.Nationality == 15 && a.DoNotUse == false && a.ClearanceStatus == c2
        ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T13:17:40.927

好的，所以我让它工作，但它的附加代码加上附加变量

```
var temp = (from a in db.Applicants 
where a.Id == null 
select a.Id).ToList(); 

int thisTag; 
foreach (int c in clearanceTotals) 
{ 
    switch (c) 
    { 
        case 6: 
            thisTag = 38; 
            break; 
        case 8: 
            thisTag = 39; 
            break; 
        case 17: 
            thisTag = 39; 
            break; 
        case 7: 
            thisTag = 42; 
            break; 
        case 9: 
            thisTag = 44; 
            break; 
    }
    temp = temp.Union(from a in db.Applicants 
           join ad in db.ApplicantDeployments on a.Id equals ad.ApplicantId 
           join aa in db.ApplicantAttachments on a.Id equals aa.ApplicantId 
           where a.Nationality == 15 && a.DoNotUse == false && a.ClearanceStatus == c 
           && aa.Tag == thisTag 
           select a.Id).ToList(); 
}
var tbl = (from a in db.Applicants
                      join ad in db.ApplicantDeployments on a.Id equals ad.ApplicantId
                      where temp.Contains(a.Id) 
                      select new { a.Id, a.Firstname, a.Lastname }).Distinct(); 
```

# iphone - 如何调用draw rect方法在单击一次按钮时绘制不同的形状？

> ID：10234382
> 
> 赞同：1
> 
> 时间：2012-04-19T18:23:07.287
> 
> 标签：iphone, ios5

我有一个按钮，`UIViewController`我想调用`drawRect`方法`UIView`来在单击按钮时绘制不同的形状`UIViewController`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T23:54:06.510

rokjarc 的回答是正确的，你应该接受他的回答，而不是我的。我只是在阐述。

我建议您查看斯坦福 CS193P 2011 课程的第 5 和第 6 讲。

[http://itunes.apple.com/itunes-u/ipad-iphone-application-development/id473757255](http://itunes.apple.com/itunes-u/ipad-iphone-application-development/id473757255)

第 5 讲主要是绘图，第 6 讲将 drawRect 连接到滑块。

**编辑**rokjarc的信用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T19:02:47.653

回答你问题的第一部分：如何调用`drawRect`方法。

你不直接调用这个方法，你只需调用`[view setNeedsDisplay];`

至于你问题的第二部分。您不会通过参数*告诉* `drawRect`您要绘制什么 - 您覆盖它并自己绘制您需要的对象。

你可以在这里找到一个很好的教程：[An iPhone Graphics Drawing Tutorial using Quartz 2D](http://www.techotopia.com/index.php/An_iPhone_Graphics_Drawing_Tutorial_using_Quartz_2D)

# javascript - RequireJS - 首先初始化一个依赖模块，然后再加载其他模块

> ID：10234383
> 
> 赞同：1
> 
> 时间：2012-04-19T18:23:10.407
> 
> 标签：javascript, module, initialization, requirejs

我正在使用 requireJS 做我的第一个项目并立即遇到问题:)

我创建了一个模块“main”，它是我的应用程序应该初始化的基本节点。APP 使用 REST API 与服务器通信，所以我也创建了一个 API 模块。

问题是：我必须先初始化 API 模块，然后才能加载和初始化它所依赖的任何其他模块。

我发现这是不可能的，因为如果我的主模块同时需要 API 模块，加上一些依赖于 API 模块的模块，那么整个事情都会失败，因为它们都在我的主模块被初始化之前被加载和初始化（并且做API模块的基本配置）。

有人知道如何首先加载一个模块，通过传递一些参数来初始化它，然后继续并继续要求其他模块吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:19:37.850

从未尝试过使用 Node.js 但这对我来说在 Dojo AMD 和 RequireJS 中都适用，假设您需要运行一个模块但在运行模块 B 模块 A 之前必须运行我只是这样做

```
require(["path/ModuleA","require"],function(modA,req){

    req(["path/ModuleB"],function(modB){
        //do anything with ModuleB
    });

}); 
```

我希望这可以解决您的问题，如果这是您所指的问题，请注意

# asp.net-mvc - Knockout.js：无法绑定到自定义 @Html.EditorFor

> ID：10234385
> 
> 赞同：4
> 
> 时间：2012-04-19T18:23:12.717
> 
> 标签：asp.net-mvc, asp.net-mvc-3, knockout.js, knockout-2.0

我正在使用选择器来构建自定义 @Html.EditorFor（称为 @Html.FullFieldEditor）。它确定要生成的输入类型（文本框、下拉菜单、单选按钮、复选框等）。我一直试图将它连接到一个单选按钮列表中，因此：

```
@Html.FullFieldEditor(m => m.MyModel.MyRadioButton, new Dictionary<string, object> { { "data_bind", "myRadioButton" } }) 
```

或像这样：

```
@Html.FullFieldEditor(m => m.MyModel.MyRadioButton, new { data_bind = "checked: myRadioButton" }) 
```

但没有运气。

我试图修复我的`selector.cshtml`代码，但结果却弄得一团糟。这是在我尝试实现之前对我有用的代码`knockout.js`：

```
@{
var supportsMany = typeof (IEnumerable).IsAssignableFrom(ViewData.ModelMetadata.ModelType);
var selectorModel = (Selector)ViewData.ModelMetadata.AdditionalValues["SelectorModelMetadata"];
var fieldName = ViewData.TemplateInfo.GetFullHtmlFieldName("");
var validationClass = ViewData.ModelState.IsValidField(fieldName) ? "" : "input-validation-error";

// Loop through the items and make sure they are Selected if the value has been posted
if(Model != null)
{
    foreach (var item in selectorModel.Items)
    {
        if (supportsMany)
        {
            var modelStateValue = GetModelStateValue<string[]>(Html, fieldName) ?? ((IEnumerable)Model).OfType<object>().Select(m => m.ToString());
            item.Selected = modelStateValue.Contains(item.Value);
        }
        else
        {
            var modelStateValue = GetModelStateValue<string>(Html, fieldName);
            if (modelStateValue != null)
            {
                item.Selected = modelStateValue.Equals(item.Value, StringComparison.OrdinalIgnoreCase);
            }
            else
            {
                Type modelType = Model.GetType();
                if (modelType.IsEnum)
                {
                    item.Selected = item.Value == Model.ToString();
                }
            }
        }
    }
}
}
@functions
{
    public MvcHtmlString BuildInput(string fieldName, 
    SelectListItem item, string inputType, object htmlAttributes) 
    // UPDATE: Trying to do it above
    {
    var id = ViewData.TemplateInfo.GetFullHtmlFieldId(item.Value);
    var wrapper = new TagBuilder("div");
    wrapper.AddCssClass("selector-item");

    var input = new TagBuilder("input");
    input.MergeAttribute("type", inputType);
    input.MergeAttribute("name", fieldName);
    input.MergeAttribute("value", item.Value);
    input.MergeAttribute("id", id);

    input.MergeAttributes(new RouteValueDictionary(htmlAttributes)); 
    // UPDATE: and trying above, but see below in the 
    // @foreach...@BuildInput section

    input.MergeAttributes(Html.GetUnobtrusiveValidationAttributes(fieldName, ViewData.ModelMetadata));

    if(item.Selected)
        input.MergeAttribute("checked", "checked");

    wrapper.InnerHtml += input.ToString(TagRenderMode.SelfClosing);

    var label = new TagBuilder("label");
    label.MergeAttribute("for", id);
    label.InnerHtml = item.Text;
    wrapper.InnerHtml += label;

    return new MvcHtmlString(wrapper.ToString());
}

/// <summary>
/// Get the raw value from model state
/// </summary>
public static T GetModelStateValue<T>(HtmlHelper helper, string key)
{
    ModelState modelState;
    if (helper.ViewData.ModelState.TryGetValue(key, out modelState) && modelState.Value != null)
        return (T)modelState.Value.ConvertTo(typeof(T), null);
    return default(T);
}
}
@if (ViewData.ModelMetadata.IsReadOnly)
{
var readonlyText = selectorModel.Items.Where(i => i.Selected).ToDelimitedString(i => i.Text);
if (string.IsNullOrWhiteSpace(readonlyText))
{
    readonlyText = selectorModel.OptionLabel ?? "Not Set";
}

@readonlyText

foreach (var item in selectorModel.Items.Where(i => i.Selected))
{
@Html.Hidden(fieldName, item.Value)
}
}
else
{
if (selectorModel.AllowMultipleSelection)
{
    if (selectorModel.Items.Count() < selectorModel.BulkSelectionThreshold)
    {
<div class="@validationClass">
    @foreach (var item in selectorModel.Items)
            {
        @BuildInput(fieldName, item, "checkbox") // throwing error here if I leave this as is (needs 4 arguments)
        //But if I do this:
        //@BuildInput(fieldName, item, "checkbox", htmlAttributes) // I get does not exit in current context

            }
</div>
    }
    else
    {
@Html.ListBox("", selectorModel.Items)
    }
}
else if (selectorModel.Items.Count() < selectorModel.BulkSelectionThreshold)
{
<div class="@validationClass">
    @*@if (selectorModel.OptionLabel != null)
        {
        @BuildInput(fieldName, new SelectListItem { Text = selectorModel.OptionLabel, Value = "" }, "radio")
        }*@
    @foreach (var item in selectorModel.Items)
        {
        @BuildInput(fieldName, item, "radio")//same here
        }
</div>
}
else
{
@Html.DropDownList("", selectorModel.Items, selectorModel.OptionLabel)
}
} 
```

任何帮助是极大的赞赏。

**编辑** 我试图最小化现有`JS`代码（超过 1500 行）以显示/隐藏 KO（这似乎能够大大减少代码）。我知道我有 KO 的选择（`visible`,`if`等），但假设我想用 KO 完成的事情是可行的，我可以选择`visible`. 无论如何，越过约束障碍会阻止我走得那么远。

这是我用来显示/隐藏的一些代码示例`JS`：

```
$(document).ready(function () {
    $("input[name$='MyModel.MyRadioButton']").click(function () {
        var radio_value = $(this).val();
        if (radio_value == '1') {
            $("#MyRadioButton_1").show();
            $("#MyRadioButton_2").hide();
            $("#MyRadioButton_3").hide();
        }
        else if (radio_value == '2') {
            $("#MyRadioButton_1").show();
            $("#MyRadioButton_2").hide();
            $("#MyRadioButton_3").hide();
        }
        else if (radio_value == '3') {
            $("#MyRadioButton_1").show();
            $("#MyRadioButton_2").hide();
            $("#MyRadioButton_3").hide();
        }
    });
    $("#MyRadioButton_1").hide();
    $("#MyRadioButton_2").hide();
    $("#MyRadioButton_3").hide();
}); 
```

我认为KO可以最小化上述情况。同样，我正在查看 20-30 个输入，大多数有 3 个以上的选择（少数在下拉菜单中有 10 个选择）。这越来越难以维持在 1500 行并且还在增长。

然后在我的`view`我有这样的事情：

```
<div id="MyRadioButton_1">
    @Helpers.StartingCost(MyModel.Choice1, "1")
</div>
<div id="MyRadioButton_2">
    @Helpers.StartingCost(MyModel.Choice2, "2")
</div>
<div id="MyRadioButton_3">
    @Helpers.StartingCost(MyModel.Choice2, "2")
</div> 
```

上面的`view`代码会随着 KO 的变化而略有变化，但`JS`我再次尝试减少它。

**编辑 2** 这是`FullFieldEditor`. 为简洁起见，省略了某些部分（例如 和 的代码`RequiredFor`）。`ToolTipFor``SpacerFor`

```
public static MvcHtmlString FullFieldEditor<T, TValue>(this HtmlHelper<T> html, Expression<Func<T, TValue>> expression)
    {
        return FullFieldEditor(html, expression, null);
    }

    public static MvcHtmlString FullFieldEditor<T, TValue>(this HtmlHelper<T> html, Expression<Func<T, TValue>> expression, object htmlAttributes)
    {
        var metadata = ModelMetadata.FromLambdaExpression(expression, html.ViewData);

        if (!metadata.ShowForEdit)
        {
            return MvcHtmlString.Empty;
        }

        if (metadata.HideSurroundingHtml)
        {
            return html.EditorFor(expression);
        }

        var wrapper = new TagBuilder("div");
        wrapper.AddCssClass("field-wrapper");
        var table = new TagBuilder("table");
        table.Attributes["border"] = "0";
        table.Attributes["width"] = "100%";//added this to even out table columns
        var tbody = new TagBuilder("tbody");
        var tr = new TagBuilder("tr");
        var td1 = new TagBuilder("td");
        td1.Attributes["width"] = "40%";
        td1.Attributes["valign"] = "top";
        var label = new TagBuilder("div");
        label.AddCssClass("field-label");
        label.AddCssClass("mylabelstyle");
        label.InnerHtml += html.MyLabelFor(expression);
        td1.InnerHtml = label.ToString();
        var td2 = new TagBuilder("td");
        td2.Attributes["width"] = "50%";
        td2.Attributes["valign"] = "top";
        var input = new TagBuilder("div");
        input.AddCssClass("field-input");

        input.InnerHtml += html.EditorFor(expression);
        td2.InnerHtml = input.ToString();
        var td3 = new TagBuilder("td");
        td3.Attributes["width"] = "5%";
        td3.Attributes["valign"] = "top";
        if (metadata.IsRequired && !metadata.IsReadOnly)
        {
            td3.InnerHtml += html.RequiredFor(expression);
        }
        var td4 = new TagBuilder("td");
        td4.Attributes["width"] = "5%";
        td4.Attributes["valign"] = "middle";
        if (!string.IsNullOrEmpty(metadata.Description))
        {
            td4.InnerHtml += html.TooltipFor(expression);
        }
        else td4.InnerHtml += html.SpacerFor(expression);
        td4.InnerHtml += html.ValidationMessageFor(expression);
        tr.InnerHtml = td1.ToString() + td2.ToString() + td3.ToString() + td4.ToString();
        tbody.InnerHtml = tr.ToString();
        table.InnerHtml = tbody.ToString();
        wrapper.InnerHtml = table.ToString();
        return new MvcHtmlString(wrapper + Environment.NewLine);
    } 
```

**更新 3** 选项不起作用。选项 1 甚至不会显示`data-bind`在`<input>`. 选项 2 将不起作用，因为它只是检查该字段是否是必需的（如果是，代码只显示“必需”图像）。

**当我在您的“UPDATE2”**（ ）之前尝试您的第一个建议`input.MergeAttributes(new RouteValueDictionary(htmlAttributes));`时，输出如下：

```
<div class="field-input" data_bind="checked: MyRadioButton">
    <div class="">
        <div class="selector-item">
            <input id="MyModel_MyRadioButton_Choice1" name="MyModel.MyRadioButton" type="radio" value="Choice1">
            <label for="MyModel_MyRadioButton_Choice1">I am thinking about Choice 1.</label>
        </div>
        <!--Just showing one radio button for brevity-->
    </div>
</div> 
```

由于我将属性与输出的`input`部分合并，这就是放置它的位置（这是合乎逻辑的）。请注意，它应该是但在课堂上显示。这就是我拥有的方式：`TagBuilder``field-input` `<div>``data-bind``data_bind``field-input``FullFieldEditor`

```
@Html.FullFieldEditor(m => m.MyModel.MyRadioButton, new Dictionary<string, object> { { "data_bind", "myRadioButton" } }) 
```

我认为它应该显示的内容是这样的：

```
<div class="field-input">
    <div class="">
        <div class="selector-item">
            <!-- "data-bind" should be showing up in the following INPUT, correct?-->
            <input data-bind="checked: MyRadioButton" id="MyModel_MyRadioButton_Choice1" name="MyModel.MyRadioButton" type="radio" value="Choice1">
            <label for="MyModel_MyRadioButton_Choice1">I am thinking about Choice 1.</label>
        </div>
        <!--Just showing one radio button for brevity-->
    </div>
</div> 
```

我怀疑我必须把它`htmlAttributes`放到`Selector.cshtml`上面，而不是在`HtmlFormHelper.cs`文件中。这`Selector.cshtml`是在显示例如下拉列表、单选按钮列表或复选框列表（以及其他）之间做出决定的原因。是文件夹中的`Selector.cshtml`模板。`Shared\EditorTemplates`

背景：我有几十个表格，代表几十个页面（或向导）上的数百个输入。我之所以使用`@Html.FullFieldEditor`它是因为它比为每种类型的输入（下拉菜单、复选框、单选按钮等）使用意大利面条代码更容易维护。

**更新 4** 仍然无法正常工作。

我在`Selector.cshtml`（它的`BuildInput`函数）代码中尝试了这个，并且能够将“数据绑定”放入`<input>`列表中每个单选按钮的标签中：

```
input.MergeAttribute("data-bind", htmlAttributes); 
```

然后我在同一个文件中做了这个：

```
@foreach (var item in selectorModel.Items)
    {
        @BuildInput(fieldName, item, "radio", "test")
    } 
```

我的 HTML 输出是这样的：

```
<div class="selector-item">
    <input data-bind="test" id="MyModel_MyRadioButton_Choice1" name="MyModel.MyRadioButton" type="radio" value="Choice1">
    <label for="MyModel_MyRadioButton_Choice1">Choice 1</label>
</div> 
```

**这就是让我相信这是`Selector.cshtml`文件，而不是`HtmlFormHelper.cs`文件的原因。**

我将向所有 50 岁以上的人开放赏金。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T20:14:23.697

**更新3**

下划线位的第一个好电话，我完全忘记了这一点。您的代码看起来几乎正确，但实际上应该是这样的：

```
@Html.FullFieldEditor(m => m.MyModel.MyRadioButton, new Dictionary<string, object> { { "data_bind", "checked:myRadioButton" } }) 
```

因此，由于您在复选框和文本之间进行动态选择，因此您必须做几件事。如果它是一个复选框，您将不得不使用上面的代码。如果它是一个文本框，你将不得不使用：

```
@Html.FullFieldEditor(m => m.MyModel.MyTextBox, new Dictionary<string, object> { { "data_bind", "value:MyTextBox" } }) 
```

**更新2**

所以我更新了你的代码，我***认为***数据绑定属于你的 html（标记为 option1 和 option2）。如果您给我一个正在生成的 html 的片段，以及您需要数据绑定的位置，将会有帮助。

```
public static MvcHtmlString FullFieldEditor<T, TValue>(this HtmlHelper<T> html, Expression<Func<T, TValue>> expression)
{
    return FullFieldEditor(html, expression, null);
}

public static MvcHtmlString FullFieldEditor<T, TValue>(this HtmlHelper<T> html, Expression<Func<T, TValue>> expression, object htmlAttributes)
{
    var metadata = ModelMetadata.FromLambdaExpression(expression, html.ViewData);

    if (!metadata.ShowForEdit)
    {
        return MvcHtmlString.Empty;
    }

    if (metadata.HideSurroundingHtml)
    {
        return html.EditorFor(expression);
    }

    var wrapper = new TagBuilder("div");
    wrapper.AddCssClass("field-wrapper");

    var table = new TagBuilder("table");
    table.Attributes["border"] = "0";

    //added this to even out table columns
    table.Attributes["width"] = "100%";

    var tbody = new TagBuilder("tbody");

    var td1 = new TagBuilder("td");
    td1.Attributes["width"] = "40%";
    td1.Attributes["valign"] = "top";

    var label = new TagBuilder("div");
    label.AddCssClass("field-label");
    label.AddCssClass("mylabelstyle");
    label.InnerHtml += html.MyLabelFor(expression);

    td1.InnerHtml = label.ToString();

    var td2 = new TagBuilder("td");
    td2.Attributes["width"] = "50%";
    td2.Attributes["valign"] = "top";

    var input = new TagBuilder("div");
    input.AddCssClass("field-input");

    // option1
    input.InnerHtml += html.EditorFor(expression, htmlAttributes);
    td2.InnerHtml = input.ToString();

    var td3 = new TagBuilder("td");
    td3.Attributes["width"] = "5%";
    td3.Attributes["valign"] = "top";

    if (metadata.IsRequired && !metadata.IsReadOnly)
    {
        // option2
        td3.InnerHtml += html.RequiredFor(expression, htmlAttributes);
    }

    var td4 = new TagBuilder("td");
    td4.Attributes["width"] = "5%";
    td4.Attributes["valign"] = "middle";

    if (!string.IsNullOrEmpty(metadata.Description))
    {
        td4.InnerHtml += html.TooltipFor(expression);
    }
    else
    {
        td4.InnerHtml += html.SpacerFor(expression);
    }

    td4.InnerHtml += html.ValidationMessageFor(expression);

    var tr = new TagBuilder("tr");
    tr.InnerHtml = td1.ToString() + td2.ToString() + td3.ToString() + td4.ToString();

    tbody.InnerHtml = tr.ToString();
    table.InnerHtml = tbody.ToString();
    wrapper.InnerHtml = table.ToString();

    return new MvcHtmlString(wrapper + Environment.NewLine);
} 
```

**更新**

虽然我仍然相信下面是“正确”的答案，但这是您的标签生成器缺少的内容，因此您可以传递自定义属性：

```
input.MergeAttributes(new RouteValueDictionary(htmlAttributes)); 
```

**原始答案**

我有一种感觉，尝试混合 razor 和 knockout 会发生什么，是 razor 的东西会渲染，然后当附加了 knockout 时，knockout 视图模型中的值将覆盖 razor 视图中的任何内容。

如果您尝试重构淘汰赛，这是我的建议：

1.  创建仅 html 视图（无剃刀）。
2.  将您的淘汰赛绑定添加到它。
3.  [使用Json.NET](http://json.codeplex.com/)以 json 对象的形式将模型数据传递给敲除。您可以通过多种方式执行此操作，但最简单的方法是将视图中的数据填充到`<script>`您的 javascript 可以找到的标记内。
4.  使用[Knockout Mapping](http://knockoutjs.com/documentation/plugins-mapping.html)将 json 对象加载到视图模型中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T11:14:40.637

不确定我是否理解你的困难。但是，如果您的困难在于根据用于呈现属性的输入字段放置数据绑定的位置和方式，请查看[Mvc 控件工具包的](http://mvccontrolstoolkit.codeplex.com/)[ClientBlocks](http://mvccontrolstoolkit.codeplex.com/wikipage?title=Client%20Blocks)功能. 它通过预编译模板（即显示页面片段的 razor 助手或 PartialViews）或完整视图来自动计算大部分绑定。那就是你可以写：@Html.TextBoxFor(m => m.myProperty) 并且将在文本框和客户端 ViewModel 的 myProperty 之间创建足够的数据绑定，等等，选择、收音机等。你也可以避免使用帮助程序，只需给您的文件“适当的名称”，然后自动计算绑定。此外，您可以决定将服务器端 ViewModel 的哪一部分传输到客户端......您的客户端 ViewmOdel 将在发布时自动传输回服务器端 ViewModel 中。

# daemon - 使用 celeryd 作为多个 django 应用程序的守护进程？

> ID：10234386
> 
> 赞同：20
> 
> 时间：2012-04-19T18:23:14.007
> 
> 标签：daemon, celery, django-celery, celeryd

我刚开始使用[django-celery](https://github.com/ask/django-celery)，我想设置 celeryd 作为守护进程运行。但是，这些[说明](http://docs.celeryproject.org/en/latest/cookbook/daemonizing.html)似乎表明一次只能为一个站点/项目配置它。celeryd 可以处理多个项目，还是只能处理一个？而且，如果是这种情况，是否有一种干净的方法可以将 celeryd 设置为为每个配置自动启动，这需要我为每个配置创建一个单独的初始化脚本？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-11T17:50:43.250

像所有有趣的问题一样，答案是视*情况而*定。:)

绝对有可能想出一个场景，其中 celeryd 可以被两个独立的站点使用。如果多个站点正在向同一个交易所提交任务，并且这些任务不需要访问任何特定的数据库——例如，它们对电子邮件地址、信用卡号或数据库记录以外的其他东西进行操作——那么一个 celeryd 可能就足够了。只需确保任务代码位于所有站点和 celery 服务器加载的共享模块中。

不过，通常情况下，您会发现 celery 需要访问数据库——它要么根据作为任务参数传递的 ID 加载对象，要么必须将一些更改写入数据库，或者大多数情况下，两者兼有. 并且多个站点/项目通常不共享数据库，即使它们共享相同的应用程序，因此您需要将任务队列分开。

在这种情况下，通常会发生的情况是您设置了具有多个交换的单个消息代理（例如 RabbitMQ）。每个交换从一个站点接收消息。然后你在某处为每个交换运行一个或多个 celeryd 进程（在 celery 配置设置中，你必须指定交换。我不相信 celeryd 可以监听多个交换）。每个 celeryd 服务器都知道它的交换、它应该加载的应用程序以及它应该连接到的数据库。

为了管理这些，我建议研究[cyme——](https://github.com/celery/cyme)它由@asksol 提供，并在必要时在多个服务器上管理多个 celeryd 实例。我没有尝试过，但它看起来应该为不同的实例处理不同的配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-09T19:44:14.487

没有尝试但使用不需要 django-celery 的 Celery 3.1.x，根据文档，您可以像这样实例化 Celery 应用程序：

```
app1 = Celery('app1')

app1.config_from_object('django.conf:settings')
app1.autodiscover_tasks(lambda: settings.INSTALLED_APPS)

@app.task(bind=True)
def debug_task(self):
    print('Request: {0!r}'.format(self.request)) 
```

但是您可以使用 celery multi 来启动多个具有单一配置的工作人员，您可以[在此处](http://celery.readthedocs.org/en/latest/reference/celery.bin.multi.html)查看示例。因此，您可以使用不同的**[--app](http://celery.readthedocs.org/en/latest/reference/celery.bin.base.html?highlight=#cmdoption--app) appX**参数启动多个工作程序，以便使用不同的任务和设置：

```
# 3 workers: Two with 3 processes, and one with 10 processes.
$ celery multi start 3 -c 3 -c:1 10
celery worker -n celery1@myhost -c 10 --config celery1.py --app app1
celery worker -n celery2@myhost -c 3  --config celery2.py --app app2
celery worker -n celery3@myhost -c 3  --config celery3.py --app app3 
```

# python - 使用 pyparsing 进行这项特定工作的难度？（初学者）

> ID：10234387
> 
> 赞同：4
> 
> 时间：2012-04-19T18:23:15.460
> 
> 标签：python, parsing, pyparsing

我有一项任务要做，我确信 Python 和 pyparsing 确实可以提供帮助，但我仍然是编程新手，无法就完整实现的挑战性以及是否值得尝试或是否值得做出明智的选择肯定是徒劳的浪费时间。

任务是使用遵循以下一般语法的结构来翻译任意长度和嵌套深度的字符串：

```
item12345 'topic(subtopic(sub-subtopic), subtopic2), topic2' 
```

像这样的字典中的一个项目：

```
{item12345, 'topic, topic:subtopic, topic:subtopic:sub-subtopic, topic:subtopic2, topic2'} 
```

换句话说，逻辑就像数学一样，括号左边的项目被分配到里面的所有东西，而“，”表示括号内的项，很像加法函数关于二项式的因数.

到目前为止，我已经为自己发现或发现并理解了创建此解决方案的一些看似必要的元素的示例。

在 Python 中解析嵌套表达式：

```
def parenthetic_contents(string):
"""Generate parenthesized contents in string as pairs (level, contents)."""
stack = []
for i, c in enumerate(string):
    if c == '(':
        stack.append(i)
    elif c == ')' and stack:
        start = stack.pop()
        yield (len(stack), string[start + 1: i]) 
```

将一个字符串分配给其他字符串：

```
from pyparsing import Suppress,Word,ZeroOrMore,alphas,nums,delimitedList

data = '''\
MSE 2110, 3030, 4102
CSE 1000, 2000, 3000
DDE 1400, 4030, 5000
'''

def memorize(t):
    memorize.dept = t[0]

def token(t):
    return "Course: %s %s" % (memorize.dept, int(t[0]))

course = Suppress(Word(alphas).setParseAction(memorize))
number = Word(nums).setParseAction(token)
line = course + delimitedList(number)
lines = ZeroOrMore(line)

final = lines.parseString(data)

for i in final:
    print i 
```

还有其他一些方法，但这些方法不会直接应用于我的最终解决方案，而且在我理解 python 和 pyparsing 足以结合这些想法或找到新的想法之前，我还有很长的路要走。

我一直在寻找例子，寻找类似的东西，学习更多的python和更多的pyparsing的类和方法，但我不确定我离做出足够的东西还有多远。对于我的完整解决方案，而不仅仅是不适用于一般情况的中间练习。

所以我的问题是这些。为了完成我正在寻找的事情，我最终需要多复杂的解决方案？你有什么建议可以帮助我更接近？

提前致谢！（PS - StackOverflow 上的第一篇文章，如果我需要对这篇文章做一些不同的事情，请告诉我）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:51:55.703

在 pyparsing 中，您的示例将类似于：

```
from pyparsing import Word,alphanums,Forward,Optional,nestedExpr,delimitedList

topicString = Word(alphanums+'-')
expr = Forward()
expr << topicString + Optional(nestedExpr(content=delimitedList(expr)))

test = 'topic(subtopic(sub-subtopic), subtopic2), topic2'

print delimitedList(expr).parseString(test).asList() 
```

印刷

```
['topic', ['subtopic', ['sub-subtopic'], 'subtopic2'], 'topic2'] 
```

转换为`topic:subtopic`等留给 OP 练习。

# iphone - 谷歌地方 API

> ID：10234392
> 
> 赞同：0
> 
> 时间：2012-04-19T18:23:47.147
> 
> 标签：iphone, asp.net, django

我们正在开发一个应用程序，该应用程序利用 Google Places API 中支持的几种地点类型。但是，我们注意到支持的类型，餐厅代码，与您在智能手机上的谷歌页面底部找到的餐厅信息不同。例子; 智能手机提供的餐厅信息提供了餐厅的详细信息和位置。Google Places API 中列出的信息不显示相同的信息。请告知我们如何从智能手机获取与 Google 页面上提供的相同信息的代码。它是免费的还是与 Google 的高级交易的一部分？谢谢，我希望这很清楚。亚瑟

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T20:55:43.517

Google Places 数据库与 Google Maps 不同。

我想在某个时候，谷歌会将两者结合起来。

您可以按纬度/经度和名称进行匹配。这可能至少有一半的时间有效。另一半表示两个数据库中的名称和纬度/经度可能有点不同。

# php - 通过 PHP 使用 python 时的权限问题

> ID：10234393
> 
> 赞同：1
> 
> 时间：2012-04-19T18:23:48.207
> 
> 标签：php, python, permissions

我需要让我的 Python 程序打开一个文件，使用其中的一些数据，然后输出一个不同的文件。我有几个问题，并希望是否有人可以明确地告诉我它们是否基于权限，如果是，如何解决它们。我的 Python 程序通过终端运行。

以下是我确定的一些不起作用的区域：

```
import matplotlib.pyplot
infile = open('/correct_pathway/textfile1.txt','r')
outfile = open('/correct_pathway/textfile2.txt','w') 
```

它在所有这些方面都遇到了麻烦。我不知道导入模块时可能存在权限问题，但确实存在。此外，它试图打开的文件是全局读/写的。

编辑：抱歉，这无意中含糊不清，并且代码中的错字实际上并不存在。网页上写的PHP代码如下（如果我调用一个更简单的python程序就可以了，所以这里我能想到的没有问题）：

```
<?php  $command= '/usr/bin/python /correct_pathway/program.py';
$temp = exec($command, $output);
print_r($temp); ?> 
```

该代码应该打开 infile，从中读取一个数字，然后将该数字写入 outfile 并打印出一个不同的数字。打印的号码应显示在网页上。这一切都可以通过终端正常工作，而不是在网页上。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:27:32.073

要定义文件应该如何打开，即读取或写入，语法是用引号将 r 或 w 括起来。所以你上面的代码应该如下所示。

```
import matplotlib.pyplot
infile = open('/correct_pathway/textfile1.txt','r')
outfile = open('/correct_pathway/textfile2.txt','w') 
```

看看您是否可以访问添加了引号的文件。

# ios - 从应用程序委托中呈现故事板视图控制器？

> ID：10234399
> 
> 赞同：11
> 
> 时间：2012-04-19T18:24:08.673
> 
> 标签：ios, uistoryboard

我有一个视图控制器子类，`SignInViewController`用于随时可能需要的登录。与其让我的应用程序中的每个视图控制器都监听需要登录的通知，不如让应用程序委托来做。

但是如何从我的应用程序委托中触发它？

我把它`SignInViewController`放在我的主故事板中吗？如果是这样，我如何从我的应用程序委托访问我的故事板？还是其他方法更好？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-19T18:31:33.760

您始终可以通过 UIApplication 单例引用您的应用程序委托。从那里你总是可以得到你的根视图控制器。使用您的根视图控制器，您可以获得对故事板的引用。

一旦你有了故事板，你所做的就是实例化你想要的视图控制器的一个实例。呈现它。

```
AppDelegate* appDelegate = (AppDelegate*)[[UIApplication sharedApplication] delegate];
MainViewController *mvc = (MainViewController *)appDelegate.window.rootViewController;    
LoginViewController *lvc = [mvc.storyboard instantiateViewControllerWithIdentifier:@"LoginViewController"];
[currentVC presentModalViewController:lvc animated:YES]; 
```

可能有一种更直接的方法可以参考您的故事板，但这几乎总是会为您提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-08T19:31:22.153

为了从任何地方（包括应用程序委托）显示视图控制器，我在 iOS 8+ 中成功使用了这段代码（我不确定早期的兼容性）。如果有，它将从模态视图中呈现。

```
YOURAppDelegate *appDelegate =  (YOURAppDelegate *)[[UIApplication sharedApplication] delegate];
UINavigationController *rootNavC = (UINavigationController *)appDelegate.window.rootViewController;
UIViewController *topVC = rootNavC.topViewController;

UIViewController *myNewVC = [rootNavC.storyboard instantiateViewControllerWithIdentifier:<YOUR STORYBOARD ID>];

if (topVC.presentedViewController)
{
    if ([topVC.presentedViewController class] == [UINavigationController class])
    {
        dispatch_async(dispatch_get_main_queue(), ^{
            [((UINavigationController*)topVC.presentedViewController) pushViewController:myNewVC
                                                                                animated:YES];
        });
    }
    else
    {
        dispatch_async(dispatch_get_main_queue(), ^{
            [topVC.presentedViewController.navigationController pushViewController:myNewVC
                                                                          animated:animated];
        });
    }
}
else
{
    dispatch_async(dispatch_get_main_queue(), ^{
        [rootNavC pushViewController:myNewVC
                            animated:animated];
    });
} 
```

我通常将它包装在一个方便的方法中并传入我的实例化视图控制器。对于 OP - 您将在情节提要中创建 SignInViewController，为其分配一个唯一的情节提要 ID，然后在上述代码中替换该 ID。

# iphone - Cocos2D 角色动画

> ID：10234401
> 
> 赞同：0
> 
> 时间：2012-04-19T18:24:14.167
> 
> 标签：iphone, objective-c, cocos2d-iphone

我开始玩 Cocos2D，我想用精灵表做一个精灵动画。

现在我有一个小机器人在我的屏幕上四处走动。但我想知道如何将一个动画放入另一个动画中。

例如，我的机器人有一个行走动画，我想分别移动他的手臂。但是他的肩膀在行走过程中会上升和下降，手臂应该相对于他的肩膀位置移动。

我的行走动画有五个精灵，我有九个不同的手臂位置。现在，我可以为所有九个手臂位置的每个行走精灵添加手臂。但那样我就会有 45 张图片而不是 14 张。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:38:42.810

这是一个很好的问题（终于！）。

我要做的是将您的角色分成不同的精灵（您已经这样做了），这些精灵可以自行制作动画。

然后，每当呈现该动画的一帧时，我都会执行一段代码来修改手臂动画的位置，使其与肩膀匹配。

要执行该代码块，您需要 Cocos 1.1 或更高版本，因为他们在那里添加了 CCAnimationFrame，但是这些帧只能通过 NSNotification 执行代码，所以我进行了改进，以便我们可以在帧上设置块，并且只要显示该帧，就会执行该块。

只需找到 CCAnimation.h 并将 CCAnimationFrame 接口修改为如下所示：

```
typedef void(^FrameBlock)(CCSprite *sprite);

/** CCAnimationFrame
 A frame of the animation. It contains information like:
 - sprite frame name
 - # of delay units.
 - offset

 @since v1.1
 */
@interface CCAnimationFrame : NSObject <NSCopying>
{
    CCSpriteFrame* spriteFrame_;
    float delayUnits_;
    NSDictionary *userInfo_;

    FrameBlock frameBlock;
}
/** CCSpriteFrameName to be used */
@property (nonatomic, readwrite, retain) CCSpriteFrame* spriteFrame;

/**  how many units of time the frame takes */
@property (nonatomic, readwrite) float delayUnits;

/**  A CCAnimationFrameDisplayedNotification notification will be broadcasted when the frame is displayed with this dictionary as UserInfo. If UserInfo is nil, then no notification will be broadcasted. */
@property (nonatomic, readwrite, retain) NSDictionary *userInfo;

/**  If the block is not NULL, it will be executed when the frame becomes visible **/
@property (nonatomic, readwrite, copy) FrameBlock frameBlock;

/** initializes the animation frame with a spriteframe, number of delay units and a notification user info */
-(id) initWithSpriteFrame:(CCSpriteFrame*)spriteFrame delayUnits:(float)delayUnits userInfo:(NSDictionary*)userInfo;
-(id) initWithSpriteFrame:(CCSpriteFrame*)spriteFrame delayUnits:(float)delayUnits block:(FrameBlock)block;
@end 
```

然后打开 CCAnimation.m 并确保 CCAnimationFrame 实现如下所示：

```
@implementation CCAnimationFrame

@synthesize spriteFrame = spriteFrame_, delayUnits = delayUnits_, userInfo=userInfo_;

@synthesize frameBlock;

-(id) initWithSpriteFrame:(CCSpriteFrame *)spriteFrame delayUnits:(float)delayUnits userInfo:(NSDictionary*)userInfo
{
    if( (self=[super init]) ) {
        self.spriteFrame = spriteFrame;
        self.delayUnits = delayUnits;
        self.userInfo = userInfo;
    }

    return self;
}

-(id) initWithSpriteFrame:(CCSpriteFrame*)spriteFrame delayUnits:(float)delayUnits block:(FrameBlock)block{
    self = [self initWithSpriteFrame:spriteFrame delayUnits:delayUnits userInfo:nil];
    if(self){
        [self setFrameBlock:block];
    }
    return self;
}

-(void) dealloc
{    
    CCLOGINFO( @"cocos2d: deallocing %@", self);

    [spriteFrame_ release];
    [userInfo_ release];

    [super dealloc];
}

-(id) copyWithZone: (NSZone*) zone
{
    CCAnimationFrame *copy = [[[self class] allocWithZone: zone] initWithSpriteFrame:[[spriteFrame_ copy] autorelease] delayUnits:delayUnits_ userInfo:[[userInfo_ copy] autorelease] ];
    return copy;
}

-(NSString*) description
{
    return [NSString stringWithFormat:@"<%@ = %08X | SpriteFrame = %08X, delayUnits = %0.2f >", [self class], self, spriteFrame_, delayUnits_ ];
}
@end 
```

然后，在创建动画帧时，向其中添加一个块，在其中设置手臂的位置以匹配肩膀。

我希望它有所帮助。

# iphone - 增强 UITableView 滚动

> ID：10234402
> 
> 赞同：0
> 
> 时间：2012-04-19T18:24:15.447
> 
> 标签：iphone, objective-c, xcode, uitableview, scroll

在我的应用程序中，我有一个包含 120 行的 UITableView，每行都有 1 个 UItextfeilds 和 1 个按钮，如下面的代码所示：

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] 
             initWithStyle:UITableViewCellStyleDefault
             reuseIdentifier:CellIdentifier] autorelease];
}
else
{

}

UITextField *NameTextField = [[UITextField alloc] initWithFrame:CGRectMake(0, 10, 230, 28)];
NameTextField.borderStyle = UITextBorderStyleRoundedRect;

NameTextField.delegate = self;
NameTextField.textColor = UIColorFromRGB(0x2A1807);
NameTextField.font = [UIFont fontWithName:@"Helvetica" size:(17.0)];
NameTextField.font = [UIFont boldSystemFontOfSize:20];

NameTextField.tag = [indexPath row ];
NSString *temp = [self.sectionNames objectAtIndex:[indexPath section]];
NameTextField.text = [[self.myDataArray objectForKey:temp] objectAtIndex:[indexPath row]];
[cell.contentView addSubview:NameTextField];
[NameTextField release];
UIButton * aBtn = [UIButton buttonWithType:UIButtonTypeCustom];
UIImage *wijzigImage = [UIImage imageNamed:@"btn_delete.png"];
aBtn.frame = CGRectMake(240, 10, 28, 26);
[aBtn setImage:wijzigImage forState:UIControlStateNormal];
[aBtn addTarget:self action:@selector(deleteCustomCellWithUIButton:) forControlEvents:UIControlEventTouchUpInside];

[cell.contentView addSubview:aBtn];
return cell; 
```

}

我注意到滚动很慢而且不流畅。

任何想法 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:41:21.950

那是因为您每次都创建文本字段和按钮，将其添加到`if (cell == nil) {...}`. 唯一应该留在外面的`if`是 textField 文本设置。

顺便说一句，您的文本字段泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:58:11.717

我找到了解决方案：

```
if (cell == nil) {
    cell = [[[UITableViewCell alloc] 
             initWithStyle:UITableViewCellStyleDefault
             reuseIdentifier:CellIdentifier] autorelease];
}
else
{
UITextField *oldTextField = (UITextField *)[cell.contentView viewWithTag:999];
        [oldTextField removeFromSuperview];
        UIButton *oldBtn = (UIButton *)[cell.contentView viewWithTag:888];
        [oldBtn removeFromSuperview];
}
   NameTextField.tag = 999;

aBtn.tag = 88; 
```

# javascript - 如何排除特殊字符并允许使用西班牙语/英语字母？

> ID：10234403
> 
> 赞同：1
> 
> 时间：2012-04-19T18:24:16.520
> 
> 标签：javascript, regex, string-formatting

我在一个西班牙网站上工作，我在那个网站上进行了搜索，我们不允许在键盘上发送这些特殊字符（！@ # $ % ^ & * ( ) _ + - = [ ] \ { } | ; ,' : " ./<>? )。在网站的英文版中，我们`term.replace(/\W|_/g," ");`在 java 脚本中做了类似的事情。这允许所有字母表（大写和小写）和数字并过滤掉那些特殊字符.

同样，我应该如何发送所有英文/西班牙文字母、数字并排除这些字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:32:23.897

将正则表达式更改为以下内容应该可以工作：

```
/[^\wáÁéÉíÍóÓúÚñÑ]|_/g 
```

或者正如 MДΓΓ БДLL 在评论中指出的那样：

```
/[^\wáéíóúñ]|_/gi 
```

`^`字符类开头的 否定它，因此可以将其理解为“匹配所有不在 中的字符，`[a-zA-Z0-9_áÁéÉíÍóÓúÚñÑ]`并且也匹配`_`”。

作为旁注，您可以将当前的正则表达式简化为`/[\W_]/g`.

# web-applications - 关于服务器和网站

> ID：10234404
> 
> 赞同：0
> 
> 时间：2012-04-19T18:24:21.570
> 
> 标签：web-applications

我正计划制作一个可以存储大量照片并在 photobucket 或 flickr 中共享的网站，但我不知道什么是适合我的服务器。老实说，我对服务器了解不多。我打算买一个名为 bluehost 的服务器，但我的朋友说这不是适合我的服务器，他说我不能在 bluehost 服务器中存储超过 20,000 个文件。

你能帮我了解什么是适合我的服务器，请告诉我更多关于服务器的信息，以帮助我解决我的问题，并告诉我关于我的问题或情况我真正需要了解的内容。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:29:55.470

您正在混合术语**server**和**http daemon**。*服务器*是硬件，“计算机”保持 24/7 在线。在服务器上，即物理机器上，正在运行称为**daemons**的程序。

对于每个**互联网服务**，都有一些实现所需**协议**的守护进程。Internet 服务的协议称为**万维网**，称为**超文本传输​​协议**。

因此，您需要一个能够快速传送照片等静态文件的 http 守护进程。

我认为最好的选择是**nginx**，尽管还有其他选择。

无论哪种方式，apache 都不是最轻量级的 http 守护进程之一，它是一个强大且功能丰富的野兽，而不是快速。（这并不意味着轻型不坚固）

# javascript - 额外的单引号 - 无法摆脱它

> ID：10234405
> 
> 赞同：0
> 
> 时间：2012-04-19T18:24:23.570
> 
> 标签：javascript, jquery

对于以下代码（使用 JavaScript/jQuery），我正在我的网站上控制幻灯片/预览滑块类型小部件。它工作得很好。我们有小指示框，可以突出显示您所在的可用幻灯片。它们也可以工作。但由于某种原因，它们之间会出现一个单引号。我能够将其追溯到我在下面用大写字母评论过的那一行。您看到的最后一个单引号似乎是导致它的原因，但是当我删除它时，它会破坏代码。为什么需要这个单引号？我说不清它与什么相匹配。

```
for(var i = -1; i < numberOfSlides; i++)
    {
        $('#locationBar').append("<span class='locator' id='locator_" + i + "'><a></a></span>'");
//THE LAST SINGLE QUOTE HERE IS WHAT IS CAUSING THE QUOTES BETWEEN THE SLIDE INDICATORS. GETTING RID OF IT BREAKS IT THOUGH. INVESTIGATE.
        if(i < 0)
        {
            $('#locator_' + i).css('visibility','hidden');
            continue;
        }
        $('#locator_' + i).bind('click',function(){window.location=$('#link_' + currentPosition).attr('href');});
        $('#locator_' + i).hover(function(){

            var newPosition = 0;
            for(var j = 0; j < numberOfSlides; j++)
            {
                if($(this).attr('id') == "locator_" + j)
                {
                    newPosition = j;
                }
            }
            if(currentPosition==newPosition)
                return;

            jump(currentPosition,newPosition);

            currentPosition=newPosition;

            clearTimeout(delayTimer);
            delayScroll();
        });
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:59:51.817

只需转义字符串。
你得到额外的报价是有道理的。
你的行的结尾是

```
"'><a></a></span>'" 
```

所以你得到双引号内的引号。

转义示例：

```
 $('#locationBar').append('<span class=\'locator\' id=\'locator_' + i + '\'><a></a></span>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:30:26.720

**已编辑**

在同一个句子中混合使用单引号和双引号可能会导致问题。

```
$('#locationBar').append('<span class="locator" id="locator_' + i + '"><a></a></span>'); 
```

虽然 user1277499 的答案也应该解决这个问题，但它不起作用？

# ruby-on-rails - Ruby 方法和可选参数

> ID：10234406
> 
> 赞同：33
> 
> 时间：2012-04-19T18:24:26.067
> 
> 标签：ruby-on-rails, ruby

我正在使用 Ruby on Rails，并且正在尝试创建一个带有可选参数的方法。显然有很多方法可以做到这一点。我尝试将可选参数命名为散列，而不定义它们。输出不同。看一看：

```
# This functions works fine!
def my_info(name, options = {})
    age = options[:age] || 27
    weight = options[:weight] || 160
    city = options[:city] || "New York"
    puts "My name is #{name}, my age is #{age}, my weight is #{weight} and I live in {city}"
end

my_info "Bill"
-> My name is Bill, my age is 27, my weight is 160 and I live in New York
-> OK!

my_info "Bill", age: 28
-> My name is Bill, my age is 28, my weight is 160 and I live in New York
-> OK!

my_info "Bill", weight: 200
-> My name is Bill, my age is 27, my weight is 200 and I live in New York
-> OK!

my_info "Bill", city: "Scottsdale"
-> My name is Bill, my age is 27, my weight is 160 and I live in Scottsdale
-> OK!

my_info "Bill", age: 99, weight: 300, city: "Sao Paulo"
-> My name is Bill, my age is 99, my weight is 300 and I live in Sao Paulo
-> OK!

****************************

# This functions doesn't work when I don't pass all the parameters
def my_info2(name, options = {age: 27, weight: 160, city: "New York"})
    age = options[:age]
    weight = options[:weight]
    city = options[:city]
    puts "My name is #{name}, my age is #{age}, my weight is #{weight} and I live in #{city}"
end

my_info2 "Bill"
-> My name is Bill, my age is 27, my weight is 160 and I live in New York
-> OK!

my_info2 "Bill", age: 28
-> My name is Bill, my age is 28, my weight is  and I live in 
-> NOT OK! Where is my weight and the city??

my_info2 "Bill", weight: 200
-> My name is Bill, my age is , my weight is 200 and I live in 
-> NOT OK! Where is my age and the city??

my_info2 "Bill", city: "Scottsdale"
-> My name is Bill, my age is , my weight is  and I live in Scottsdale
-> NOT OK! Where is my age and my weight?

my_info2 "Bill", age: 99, weight: 300, city: "Sao Paulo"
-> My name is Bill, my age is 99, my weight is 300 and I live in Sao Paulo
-> OK! 
```

可选参数的第二种方法有什么问题？第二种方法仅在我不传递任何可选参数或全部传递时才有效。

我错过了什么？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-04-19T18:32:02.633

ruby 中可选参数的工作方式是您指定一个等号，*如果没有传递任何参数，*则使用您指定的参数。因此，如果在第二个示例中没有传递第二个参数，那么

```
{age: 27, weight: 160, city: "New York"} 
```

用来。如果您确实在第一个参数之后使用哈希语法，则传递该*精确哈希。*

你能做的最好的就是

```
def my_info2(name, options = {})
  options = {age: 27, weight: 160, city: "New York"}.merge(options)
... 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-19T18:51:50.313

问题是您发布的第二个版本中的默认值`options`是整个`Hash`。因此，默认值，整个`Hash`，被覆盖。这就是为什么不传递任何内容的原因，因为这会激活默认值，`Hash`并且输入所有这些值也可以，因为它会用`Hash`相同的键覆盖默认值。

我强烈建议使用 an`Array`来捕获方法调用末尾的所有其他对象。

```
def my_info(name, *args)
  options = args.extract_options!
  age = options[:age] || 27
end 
```

我从阅读 Rails 的源代码中学到了这个技巧。但是，请注意，这仅在您包含 ActiveSupport 时才有效。或者，如果您不想要整个 ActiveSupport gem 的开销，只需使用添加到的两种方法`Hash`即可`Array`。

> rails / activesupport / lib / active_support / core_ext / array / extract_options.rb

所以当你调用你的方法时，调用它就像调用任何其他带有附加选项的 Rails 辅助方法一样。

```
my_info "Ned Stark", "Winter is coming", :city => "Winterfell" 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-04-19T18:29:35.410

如果要默认选项哈希中的值，则需要合并函数中的默认值。如果您将默认值放在默认参数本身中，它将被覆盖：

```
def my_info(name, options = {})
  options.reverse_merge!(age: 27, weight: 160, city: "New York")

  ...
end 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-19T18:34:49.457

在第二种方法中，当你说，

`my_info2 "Bill", age: 28`

它将通过 {age: 28}，整个原始默认哈希 {age: 27, weight: 160, city: "New York"} 将被覆盖。这就是它无法正确显示的原因。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-02-07T22:19:33.957

您还可以使用关键字参数定义方法签名（自 Ruby 2.0 以来的新问题，因为这个问题很旧）：

```
def my_info2(name, age: 27, weight: 160, city: "New York", **rest_of_options)
    p [name, age, weight, city, rest_of_options]
end

my_info2('Joe Lightweight', weight: 120, age: 24, favorite_food: 'crackers') 
```

这允许以下操作：

*   可选参数 (`:weight`和`:age`)
*   默认值
*   参数任意顺序
*   使用 double splat 在哈希中收集的额外值（`:favorite_food`收集在`rest_of_options`）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-19T18:38:28.697

要回答“为什么？”的问题：您调用函数的方式，

```
my_info "Bill", age: 99, weight: 300, city: "Sao Paulo" 
```

实际上是在做

```
my_info "Bill", {:age => 99, :weight => 300, :city => "Sao Paulo"} 
```

请注意，您传递了两个参数`"Bill"`和一个哈希对象，这将导致您提供的默认哈希值`my_info2`被完全忽略。

您应该使用其他回答者提到的默认值方法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-04-19T18:41:40.080

`#fetch`是你的朋友！

```
class Example
  attr_reader :age
  def my_info(name, options = {})
    @age = options.fetch(:age, 27)
    self
  end
end

person = Example.new.my_info("Fred")
puts person.age #27 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-04-19T18:28:39.290

对于哈希中的默认值，您应该使用它

```
def some_method(required_1, required_2, options={})
  defaults = {
    :option_1 => "option 1 default",
    :option_2 => "option 2 default",
    :option_3 => "option 3 default",
    :option_4 => "option 4 default"
  }
  options = defaults.merge(options)

  # Do something awesome!
end 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-05-08T18:38:32.483

为什么不直接使用 nil？

```
def method(required_arg, option1 = nil, option2 = nil)
  ...
end 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-01-27T17:26:29.377

我认为使用 or 运算符设置默认值没有任何问题。这是一个真实的例子（注意，使用 rails 的`image_tag`方法）：

*文件：*

```
def gravatar_for(user, options = {} )   
    height = options[:height] || 90
    width = options[:width] || 90
    alt = options[:alt] || user.name + "'s gravatar"

    gravatar_address = 'http://1.gravatar.com/avatar/'

    clean_email = user.email.strip.downcase 
    hash = Digest::MD5.hexdigest(clean_email)

    image_tag gravatar_address + hash, height: height, width: width, alt: alt 
end 
```

*安慰：*

```
2.0.0-p247 :049 > gravatar_for(user)
 => "<img alt=\"jim&#39;s gravatar\" height=\"90\" src=\"http://1.gravatar.com/avatar/<hash>\" width=\"90\" />" 
2.0.0-p247 :049 > gravatar_for(user, height: 123456, width: 654321)
 => "<img alt=\"jim&#39;s gravatar\" height=\"123456\" src=\"http://1.gravatar.com/avatar/<hash>\" width=\"654321\" />" 
2.0.0-p247 :049 > gravatar_for(user, height: 123456, width: 654321, alt: %[dogs, cats, mice])
 => "<img alt=\"dogs cats mice\" height=\"123456\" src=\"http://1.gravatar.com/avatar/<hash>\" width=\"654321\" />" 
```

感觉类似于调用类时使用initialize方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-19T18:35:23.250

ActiveRecord 模型上有一个 method_missing 方法，您可以覆盖该方法以使您的类直接动态响应调用。这是一篇不错的[博客文章](http://inrails.wordpress.com/2009/04/23/using-method_missing-to-cleanup-your-models/)。

# c# - C# 应用程序中的 InternetSetCookie 不适用于子域

> ID：10234410
> 
> 赞同：1
> 
> 时间：2012-04-19T18:24:35.770
> 
> 标签：c#, cookies, browser, webclient, webrequest

在我的 C# 应用程序中，我正在使用 HTTPWebrequest 等浏览网站。在某个时候，我想在 WebBrowser 控件中显示网站。

当前的 Cookie 保存在 CookieContainer 中。

以下代码完美运行，所有 Cookie 均由浏览器在请求中发送。

```
CookieCollection cookies = ck.GetCookies(new Uri("http://www.abcde.de"));

foreach (Cookie c in cookies) {
  if (!InternetSetCookie("http://www.abcde.de", c.Name, c.Value))
    throw new Exception("Exception setting cookie: Win32 Error code=" 
    + Marshal.GetLastWin32Error());
  }

  /** Setting header_infos, POST-Data etc **/
  webBrowser1.Navigate(link, "_self", parameterbyte, header_infos.ToString()); 
```

但是当我从子域中检索 Cookie 时

```
CookieCollection cookies = ck.GetCookies(new Uri("http://ab.cde.de")); 
```

IntersetSetCookie 函数引发异常，因为 URL 格式“ [http://ab.cde.de](http://ab.cde.de) ”无效。当我尝试“ [http://www.cde.de](http://www.cde.de) ”或“ [http://www.ab.cde.de](http://www.ab.cde.de) ”时，我没有收到异常，但网站无法正确加载，因为浏览器只发送其中一个请求中有五个 cookie，我不知道为什么。

你知道我该如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T20:50:21.013

我认为出于安全原因，这种行为是故意的。子域上的站点可以托管在与主域上的站点完全不同的人管理的完全不同的服务器上。Cookie 可能包含敏感信息，因此 Web 浏览器会阻止将它们发送到另一个（子）域。

# c# - MonoTouch.Dialog：不在 NavigationController 中时弹回父级

> ID：10234411
> 
> 赞同：0
> 
> 时间：2012-04-19T18:24:39.030
> 
> 标签：c#, ios, xamarin.ios, monotouch.dialog

我有一个对话框，它是一个全屏模式弹出窗口。

它有一组放射性元素。在选择新屏幕时，在这种情况下，出现状态。

选择状态后，如果没有 UINavigation Controller，如何让屏幕“弹出”回主对话框？

```
var rWhoToSee = new RootElement ("What State are you in??", gWhoToSee) {
    new Section (){
           new RadioElement ("ACT"),
           new RadioElement ("NT"), 
           new RadioElement ("NSW"),
           new RadioElement ("TAS")
            }
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T21:04:04.350

任何子 Dialog 都有一个`PresentingViewController`属性。这可用于关闭，或用于与导致对话框出现的控件进行通信。

```
 var vc = dlg.PresentingViewController as MyViewController;
    dlg.DismissViewController (true, () => {}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:02:13.837

您需要使用 DismissModalViewController() 要求父控制器关闭模式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T00:55:23.833

从导航控制器中调用您选择的“pop”方法，如下所示：

```
NagivationController.PopViewControllerAnimated(true); 
```

您也可以将所有元素分组：

```
new RootElement ("Clients", new RadioGroup("clientGroup", 0)) {
    new Section () {
        new RadioElement ("Happy client", "clientGroup"),
        new RadioElement ("Angry client", "clientGroup")
    }
}; 
```

使用分组当前将允许它自动弹回上一个屏幕，其中根元素将在标题中显示“客户端”，然后无论您的组中的第一个选项是什么。所以，在这种情况下，它会显示“快乐的客户”。

# javascript - 需要了解跟踪代码如何在 Web 内容中发挥作用

> ID：10234414
> 
> 赞同：0
> 
> 时间：2012-04-19T18:24:59.327
> 
> 标签：javascript, html, analytics

最近一位网络合作伙伴联系了我，他们要求我将他们的“*跟踪代码*”添加到我的网站，如下所示。数据和地址会有所不同，但结构与以下相同。目前他们将我们的网站加载到 IFrame 中，而我无法理解的是......

**脚本**部分如何为他们提供任何价值？父页面可以读取托管 IFrame 中某些内容的 JavaScript 状态吗？Google 使用了类似的模式，但他们设置了**src**，其中包含在页面加载时执行的脚本并且可以读取状态。

谁能解释这可能是如何工作的，或者这只是无用的页面垃圾邮件？

```
<img src="https://www.APartnerCompany.foo/thing.img?arg=value" />

<script type="text/javascript">
//<![CDATA[ 
var Foo = {}; 
Foo.Tracking = {}; 
Foo.Tracking.Sale = {}; 
Foo.Tracking.Sale.amount = '100.00'; 
//]]> 
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:30:09.343

当发送对该 src 的请求时，服务器只是记录伴随它的变量，JS 代码只是用相关数据更新参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:31:02.397

内联脚本还可以从包含它的页面中读取值。要将它们发布回自己的服务器，它们似乎使用了该附属图像的 src 属性。但是，您提供的部分是无害的（代码除了构造一个对象之外什么都不做）并且只请求一个不可执行的`https://www.APartnerCompany.foo/thing.img?arg=value`（在他们的处记录）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:29:15.957

它所做的只是通过记录的 GET 请求向服务器发送信息。它可以像读取 Apache 日志中的命中一样简单，也可以是处理数据的 cgi。这基本上就是所有这些广告/日志服务的工作方式。

# sql - SQL插入问题

> ID：10234416
> 
> 赞同：0
> 
> 时间：2012-04-19T18:25:11.373
> 
> 标签：sql, azure-sql-database

我遇到了这个奇怪的问题，不知道如何解决。我的表有这些列（按此顺序）：

*   ID（唯一标识符）
*   用户 ID（唯一标识符）
*   JobID（唯一标识符）
*   存档（位）

我收到此错误消息：

```
Msg 8169, Level 16, State 2, Line 1
Conversion failed when converting from a character string to uniqueidentifier.

INSERT INTO AcceptedJobs VALUES 
(NEWID(),
CONVERT(uniqueidentifier,'32c5a126-a063-4d5c-98f5-0b8f9b18dc04'),
CONVERT(uniqueidentifier,'5d454187-b45d40b4-b90b-06a8662de634'),
0) 
```

SQL-Azure

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T18:45:24.730

您的第二个字符串无法转换为`UNIQUEIDENTIFIER`数据类型。我猜你错过了一个`-`：

```
INSERT INTO AcceptedJobs VALUES 
(NEWID(),
CONVERT(uniqueidentifier,'32c5a126-a063-4d5c-98f5-0b8f9b18dc04'),
CONVERT(uniqueidentifier,'5d454187-b45d-40b4-b90b-06a8662de634'),
0) 
```

我对此进行了测试并且它有效，但我不确定它是否与您需要的 UID 相同。

# javascript - 如果已经突出显示，如何取消文本框中突出显示的文本？

> ID：10234417
> 
> 赞同：2
> 
> 时间：2012-04-19T18:25:14.070
> 
> 标签：javascript, jquery, asp.net

所以我有这个非常简单的 JS 函数，可以选择 ASP.NET texbox（输入）中的所有文本：

```
function selectAllText(textbox) {
    textbox.focus();
    textbox.select();
} 
```

..它在点击事件中被这样调用：

```
$("#<%=Textbox1.ClientID %>").click(function () { selectAllText(jQuery(this)) }); 
```

问题是无论用户在文本框中单击多少次，*所有文本*总是被选中。我理解为什么会发生这种情况（基于我上面的代码的方式），但是当用户尝试在单词中间单击以使光标返回以对文本进行修改时，它无法正常工作。

如何修改此 JS 以判断文本是否已突出显示然后取消选择文本？这是在随后单击时，用户可以将单个光标放在精确的单击位置上进行修改。

我正在尝试获取有关该`.select()`方法的文档以查看是否可以这样做`if(!textbox.select())`，但是我很难找到它，因此如果您有任何文档链接，请同时发布它们。

**编辑：**这个问题和解决方法的需要似乎是针对 IE（我使用的是 IE9）。在 Chrome 中，默认情况下的行为是我需要的，但这是针对在 IE 上运行的 Intranet 应用程序，所以看来我需要一个明确的解决方法。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:55:17.450

有必要在这个函数中做 .focus() 吗？您可以改为附加一个简单的 .select(); 到 onfocus 事件（`.bind('focus', function(){..})`）：http: [//jsfiddle.net/EGHzj/](http://jsfiddle.net/EGHzj/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:34:35.550

试试这个

```
$(document).ready(function(){
    $('input').bind('click',function(){
        if($(this).hasClass('selected')){
            $(this).toggleClass('selected');
        }else{
           this.focus();
           this.select(); 
           $(this).toggleClass('selected');
        }  
    });
}); 
```

这也应该在 IE 中工作， [http://jsfiddle.net/rAqgw/7/](http://jsfiddle.net/rAqgw/7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:38:59.307

```
function selectAllText(textbox) {
    // if there isn't selected text.
    if (textbox[0].selectionEnd) {
        textbox.focus();
        textbox.select();
    }
}

$('#txt').click(function() {
    selectAllText($(this));
}); 
```

[**现场演示**](http://jsfiddle.net/SyAf6/4) ​</p>

# mips - MIPS 浮点加法故障排除

> ID：10234423
> 
> 赞同：0
> 
> 时间：2012-04-19T18:25:38.027
> 
> 标签：mips

所以我试图用 MIPS 汇编代码编写一个程序来帮助我更好地理解浮点加法的工作原理。我编写了一个程序，它从用户那里获取两个输入，并在不使用除 mtc1 和 mfc1 （用于输入和输出）之外的任何浮点指令的情况下添加它们。我的代码有错误，因为当我添加 1 + 2 时，我得到 2.74804688。我仍在尝试调试代码，但似乎无法理解问题所在。如果有人可以提供帮助，我将不胜感激。

这是我的代码（不包括用户输入...第一个浮点值在 $s0 中，第二个在 $s1 中）

```
#Integer implementation of floating-point addition
 #Initialize variables
 add $s0,$t0,$zero #first integer value
 add $s1,$t1,$zero #second integer value
 add $s2,$zero,$zero #initialize sum variable to 0
 add $t3,$zero,$zero #initialize SUM OF SIGNIFICANDS value to 0

 #get EXPONENT from values
 sll $s5,$s0,1 #getting the exponent value 
srl $s5,$s5,24 #$s5 = first value EXPONENT

 sll $s6,$s1,1 #getting the exponent value
 srl $s6,$s6,24 #$s6 = second value EXPONENT

 #get SIGN from values
 srl $s3,$s0,31 #$s3 = first value SIGN
 srl $s4,$s1,31 #$s4 = second value SIGN

 #get FRACTION from values
 sll $s7,$s0,9 
srl $s7,$s0,9 #$s7 = first value FRACTION
 sll $t8,$s1,9
 srl $t8,$s1,9 #$t8 = second value FRACTION

 #compare the exponents of the two numbers
 compareExp: ###################### 

beq $s5,$s6, addSig 
blt $s5,$s6, shift1 #if first < second, go to shift1
 blt $s6,$s5, shift2 #if second < first, go to shift2
 j compareExp 

shift1: #shift the smaller number to the right
 srl $s7,$s7,1 #shift to the right 1
 addi $s5,$s5,1 
j compareExp

 shift2: #shift the smaller number to the right
 #srl $s0,$s0,1 #shift to the right 1
 #j compareExp
 srl $t8,$t8,1 #shift to the right 1
 addi $s6,$s6,1
 j compareExp

 addSig: 

add $t3,$s7,$t8 #Add the SIGNIFICANDS 

li $v0, 4
 la $a0, sum
 syscall

 li $v0, 1
 move $a0, $t3
 syscall

 j result

 result: 
li $v0, 4
 la $a0, newline
 syscall

 sll $t4,$s3,31 #SIGN
 #FRACTION
 sll $t5,$s6,23 #EXPONENT
 add $t6,$t4,$t5
 add $t6,$t6,$t3

 li $v0, 4
 la $a0, sum2
 syscall

 li $v0, 1
 move $a0, $t6
 syscall

li $v0, 4
 la $a0, newline
 syscall

 li $v0, 4
 la $a0, sum2
 syscall

 li $v0,2
 mtc1 $t6,$f12
 syscall
 jr $31
 # END OF PROGRAM 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T23:48:05.570

您正在使用 MARS[系统调用](http://courses.missouristate.edu/KenVollmar/MARS/Help/SyscallHelp.html)5 来读取输入，它将它们读取为整数。您应该将它们视为浮点数。

提取分数时不包括[IEEE 754隐藏位。](http://en.wikipedia.org/wiki/IEEE_754-2008)

您没有正确处理输入的符号。

还有很多，但现在就足够了。

# java - 获取列表元素

> ID：10234427
> 
> 赞同：0
> 
> 时间：2012-04-19T18:25:46.893
> 
> 标签：java, list

我有一个带有元素的 ArrayList，例如：

```
[a,b,c,d,e,f,g,h]; 
```

并且需要获取元素`[a,b,c]`，它应该是一个 ArrayList 并从第一个列表中删除它们，并且在我删除它们之后我再次从第一个列表中获取一些元素。

那么完成这项工作的最佳方式（考虑时间）是什么？我的意思是我应该迭代元素还是应该转换为数组而不是使用它？

也许有一些快速的方法可以做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:30:13.273

创建一个新列表，[`subList()`](http://docs.oracle.com/javase/7/docs/api/java/util/AbstractList.html)用于获取第一个视图，然后[`clear()`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#clear%28%29)在 subList 上使用。例子：

```
subList = originalList.subList(0, 3);
newList = new ArrayList(subList);
subList.clear(); 
```

这比遍历原始列表一次删除一个元素要有效得多，因为从 ArrayList 中删除一个元素涉及移动所有元素。使用 a`subList`只转换一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:31:11.930

您可以使用该[`sublist`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/AbstractList.html#subList%28int,%20int%29)方法将此列表一分为二（对 进行两次调用`sublist`）。

# php - 使用 PHP 变量限制 URL 输入

> ID：10234432
> 
> 赞同：0
> 
> 时间：2012-04-19T18:26:03.557
> 
> 标签：php, url, variables

我试图将用户只能看到他/她自己的详细信息。我通过 URL 栏传递一个 PHP 变量，所以它只显示他们自己的信息，但是如果他们编辑 ID 号，他们可以查看其他人的详细信息吗？

我目前拥有的代码如下所示：

```
$managerID = preg_replace('#[^0-9]#i', '', $_SESSION["id"]);
$manager = preg_replace('#[^A-Za-z0-9]#i', '', $_SESSION["manager"]);
$password = preg_replace('#[^A-Za-z0-9]#i', '', $_SESSION["password"]);

include "../adminscripts/connect_to_mysql.php";
$sql = mysql_query("SELECT * FROM Users WHERE id='$managerID' AND username='$manager' AND password='$password' AND role='Student' LIMIT 1");
$existCount = mysql_num_rows($sql);
if ($existCount == 0) {
header("location: http://www.zuluirminger.com/SchoolAdmin/index.php");
exit();
}
?>

<?php
// Get a list of all items and display them in alphabetically
include "../adminscripts/connect_to_mysql.php";

//Check to see the URL variable exists in the database
$dynamicList = "";
if (isset($_GET['id'])) {
include "../adminscripts/connect_to_mysql.php";
$id = preg_replace('#[^0-9]#i', '', $_GET['id']);

***********************************************************************************
***********************************************************************************

// If the ID does not exist the display this message.
$sql = mysql_query("SELECT * FROM StudentAttendance WHERE StudentID='$id' ORDER BY AttendanceDate DESC");
$productCount = mysql_num_rows($sql);
if ($productCount > 0) {
    while ($row = mysql_fetch_array($sql)) {
        $AttendanceDate = $row["AttendanceDate"];
        $AttendanceStatus = $row["AttendanceStatus"];
        $Notes = $row["Notes"];
        $dynamicList .= '<tr style="font-size:15px;">
  <td>' . $AttendanceDate . '</td>
  <td>' . $AttendanceStatus . '</td>
  <td>' . $Notes . '</td>
</tr>';
    }
} else {
    $AttendanceDate = "nil";
    $AttendanceStatus = "nil";
    $Notes = "nil";
}
} else {
echo "Something is missing which means we can't display this page! Sorry for the inconvenience and please try again later!";
exit();
}
mysql_close();
?> 
```

我尝试将以下 if 语句放在上面代码中放置星号的位置...

```
if ($id != $managerID) {
    $id = $managerID;
} 
```

但这似乎不起作用......我把它放在正确的地方了吗？据我所知，我使用了正确的变量？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:33:25.903

看起来您已经有一个登录用户和 ID，那么为什么不直接使用`$_SESSION["id"]`而不是`$_GET['id']`呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T18:33:33.383

你只需要稍微改变一下你的想法。当他们登录时，设置一个会话变量作为他们的用户 ID，并使用它而不是查询字符串。或者继续使用查询字符串，但根据会话用户 ID 对其进行验证，并确保这是他们试图访问的信息。

# asp.net-mvc - 从数据库中获取两个日期之间的数据

> ID：10234435
> 
> 赞同：1
> 
> 时间：2012-04-19T18:26:15.053
> 
> 标签：asp.net-mvc, database, linq

我有一个数据库，其中包含“生效日期”和“终止日期”列

这种情况是在添加记录之前，我需要确保给定的一组有效和终止日期没有重叠记录。我怎么能实现这个？我正在使用 LINQ 使用 MVC 构建应用程序。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:38:07.167

您应该检查任何记录 startDate 和 TerminationDate 是否在新记录的开始和终止日期中，您可以使用 linq 执行此操作：

```
bool overlap = db.Records.Any(x=>(x.TerminationDate >= givenRecord.StartDate 
                  && x.StartDate <= givenRecord.TerminationDate) ||
                  (x.TerminationDate <= givenRecord.TerminationDate 
                  && x.StartDate >= givenRecord.StartDate)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:32:18.913

```
var result = (from t in dbContext.table
             where t.EffectiveDate.Value <= yourDate && 
             t.TerminationDate.Value >= youDate
             select t).Count();
if(result > 0)
{
//Overlap
} 
```

# c# - 从 asp.net 启动一个外部程序

> ID：10234441
> 
> 赞同：1
> 
> 时间：2012-04-19T18:26:32.433
> 
> 标签：c#, asp.net, .net-4.0, launching-application

我有一个关于从 asp.net 网站启动外部应用程序的问题。现在我认为有适当的安全措施来防止这种情况，我知道这不是一个好的做法，但对于我正在开发的 Intranet 站点来说，能够做到这一点将非常方便。

到目前为止，如果我在本地运行我的服务器（在调试中），我已经找到了可以启动外部应用程序的地方，那么它工作正常。当我将文件发布到我的网络服务器时，它不再起作用。我知道我的文件路径会有所不同，但我如何检查本地文件是否存在？或者我可以吗？

所以这是我的代码：

```
//the actual launch button on the page
protected void btnLaunchTnet_Click(object sender, EventArgs e)
{
    string tnetpath = "c:\path\tnet.exe";      
    RunProcess(tnetpath, "");
}

private void RunProcess(string cmd, string arguments)
{
    System.Diagnostics.Process p;
    p = new System.Diagnostics.Process();

    p.StartInfo.FileName = cmd;

    if (arguments.Length > 1)
    {
        p.StartInfo.Arguments = arguments;
    }
    p.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
    p.StartInfo.RedirectStandardOutput = false;
    p.StartInfo.UseShellExecute = false;
    p.Start();
} 
```

我还有一个快速的“检查此文件是否存在”，用于禁用或启用启动应用程序的按钮

```
private bool CheckFileExists(string filepath)
{
    FileInfo SetupPath = new FileInfo(filepath);
    return SetupPath.Exists;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:33:17.677

我知道一种使用 ActiveX 控件的方法，但它只适用于 Internet Explorer。

看看这篇[文章](http://www.olavaukan.com/2010/02/using-activex-to-launch-desktop-applications-from-sharepoint/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:51:32.607

我只是在写@Slaks 写的内容，但使用了更多的词。

当您浏览网页时，会发生以下情况。

1.  网络浏览器程序与网络服务器程序建立网络连接。
2.  Web 浏览器向 Web 服务器发送 HTTP 请求。
3.  Web 服务器处理 HTTP 请求中的信息。
4.  Web 服务器将 HTTP 响应发送回浏览器。
5.  浏览器程序显示 HTTP 响应中包含的 HTML。

您示例中的代码是将在上述步骤 3 中运行的代码。

这应该足以让您了解为什么您无法以您想要的方式启动流程，但如果您没有看到它，请告诉我，我会解释更多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:29:00.743

听起来你想在*客户端*机器上启动一个程序。

你不能那样做。

如果您在同一个域中并使用 Windows 身份验证，则应该能够使用模拟和 SysInternals PsExec.exe 远程启动该进程。

# sql-server - SQL Server触发器中的数组和循环，如何？

> ID：10234448
> 
> 赞同：1
> 
> 时间：2012-04-19T18:26:54.757
> 
> 标签：sql-server, arrays, loops, triggers

我正在 SQL Server 数据库中的表上创建触发器。

但我无法做到的是：我有变量`@pageid`并已`@templateid`填充，我需要从一个表中读取所有模板列 id - 基本上得到它们的列表（它们取决于模板 id 并且数量可能会有所不同）所以我需要某种方法来制作数组或其他东西并通过它并将其添加到表格中。

所以...

1.  如何将所有模板 ID（下图：从第一个表（可用模板字段）- `where availabletemplateid is @templateid`）读入数组？

2.  如何循环遍历该数组并将它们逐个添加到另一个表（下图：第二个表 - （公共页面到字段映射），其中`publicpageid = @pageid`fieldid 是上一步中的一个一个，字段内容是“-” )

![在此处输入图像描述](../Images/511cf4e9cf98b711466df189b46500bc.png)

到目前为止我有

```
ALTER TRIGGER CreatePageFields
ON dbo.PublicPages
FOR INSERT
AS
BEGIN TRANSACTION

/* variables */
DECLARE
    @pageid bigint,
    @templateid bigint

/* insert template fields for this page */
SELECT @pageid = id, @templateid = templateid FROM inserted

/* TODO 1 get all template field id's */
/* TODO 2 insert each templatefieldid / page combination */    

/* execute */
COMMIT TRANSACTION

GO 
```

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T18:44:53.487

我认为您不需要数组（表变量）或任何循环（光标）。这样的事情会快得多（猜测你的表和字段名）：

```
INSERT INTO publicpagetofieldmapping (PublicPageID, FieldID, FieldContent)
SELECT t1.ID, t2.ID, '-'
FROM INSERTED t1
JOIN AvailableTemplateFields t2
ON t1.TemplateID = t2.availabletemplateid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:40:48.383

使用游标：

```
DECLARE cur CURSOR FOR
SELECT ID
FROM AvailableTemplateFields
WHERE AvailableTemplateID = @templateid;

FETCH NEXT FROM cur INTO @current_template_id

WHILE @@FETCH_STATUS = 0
BEGIN

    INSERT INTO PublicPageFieldMapping (
        PublicPageID, FieldID, FieldContent
    ) VALUES (
        @pageid, @current_template_id, '-'
    );

    FETCH NEXT FROM cur INTO @current_template_id;
END

CLOSE cur
DEALLOCATE cur 
```

编辑：虽然这是“使用数组”的方法（不是游标是数组，但逻辑与将数据库记录读入其中然后单步执行相同），您也应该能够通过直接查询来完成此操作，这会更快。

# objective-c - NSPredicate 检索在 1:n 关系中属性不为 NIL 的所有对象

> ID：10234454
> 
> 赞同：1
> 
> 时间：2012-04-19T18:27:23.007
> 
> 标签：objective-c, ios, core-data, nspredicate

我想为**核心数据查询构建****NSPredicate** ，它应该检索所有 IBEstPeriod 托管对象，其 1:n 关系 estType.consHistory.consType <> NIL *。

 **不幸的是，我还没有找到任何关于这样的 NSPredicate 应该是什么样子的线索。你有什么想法或建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T18:40:45.290

对谓词中的多对关系使用 "ANY"：

```
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
[fetchRequest setEntity:[NSEntityDescription entityForName:@"IBEstPeriod" inManagedObjectContext:context]];
[fetchRequest setPredicate:[NSPredicate predicateWithFormat:@"ANY estType.consHistory.consType != nil"]];

 NSArray *fetchResult = [managedObjectContext executeFetchRequest:fetchRequest error:nil]; 
```**

# zend-framework - Zend 表单元素为所有元素添加属性

> ID：10234467
> 
> 赞同：2
> 
> 时间：2012-04-19T18:28:10.450
> 
> 标签：zend-framework, zend-form

```
/* Form Elements & Other Definitions Here ... */
$this->setAction("auth")
    ->setMethod("post")
    ->setAttrib("class","ajax_form");

$email = new Zend_Form_Element_Text("email");
$email->setAttrib("class","text_input")
        ->setLabel("E-Mail")
        ->addValidator("EmailAddress","NotEmpty")
        ->isRequired(true);

$password = new Zend_Form_Element_Password("password");
$password->setAttrib("class","text_input")
        ->setLabel("Password")
        ->addValidator("NotEmpty")
        ->isRequired(true);

$this->addElements(array($email,$password));
$this->setDecorators(array(
    'FormElements',
    'FormErrors',
    array('HtmlTag',array('tag'=>'<table>')),
    'Form'
));

$this->setElementDecorators(array(
    'ViewHelper',
    array(array('data'=>'HtmlTag'), array('tag'=>'td')),
    array('Label',array('tag'=>'td')),
    array(array('row'=>'HtmlTag'), array('tag'=>'tr'))
)); 
```

我想在 1 行编码中将类“text_input”添加到此表单的所有元素中。我不喜欢对每个元素都使用 setAtttrib。反正 ？我是 Zend 的新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T18:43:25.900

没有一个单行的。如果你有很多元素，那么最简单的方法是在创建后迭代元素：

```
foreach ($this->getElements() as $element) {
    if ($element instanceof Zend_Form_Element_Text
        || $element instanceof Zend_Form_Element_Textarea
        || $element instanceof Zend_Form_Element_Password) {
        $element->setAttrib("class","text_input");
    }
} 
```

# java - 在java中存储数字对

> ID：10234487
> 
> 赞同：14
> 
> 时间：2012-04-19T18:29:28.513
> 
> 标签：java

如何在java中存储一组配对数字？我使用列表或数组还是其他东西？

例如。[ (1,1) , (2,1) , (3,5)]

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-19T18:35:15.993

有几个选项：

编写自定义 IntPair 类

```
class IntPair {
  // Ideally, name the class after whatever you're actually using 
  // the int pairs *for.*
  final int x;
  final int y;
  IntPair(int x, int y) {this.x=x;this.y=y;}
  // depending on your use case, equals? hashCode?  More methods?
} 
```

然后创建一个`IntPair[]`或一个`List<IntPair>`。

或者，创建一个二维数组`new int[n][2]`，并将行视为对。

Java 没有内置类有几个原因，但最值得注意的是，编写一个具有相同功能的类*很*`Pair`容易，但对类、其字段和它的方法。

 *如果我们更多地了解您实际使用它的目的，我们或许能够提供更详细的建议——据我们所知，a`Map`可能适合这里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-21T17:19:53.470

如果您使用的是 JavaFX，则可以使用类`Pair`.

```
import javafx.util.Pair;

int x = 23;
int y = 98;

Pair<Integer, Integer> pair1 = new Pair<>(6, 7);
Pair <Integer, Integer> pair2 = new Pair<>(x, y); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:34:00.773

```
class Pair<T> {
    T p1, p2;
    Pair(T p1, T p2) {
        this.p1 = p1;
        this.p2 = p2;
    }

Pair<Integer> pair = new Pair<Integer>(1,2);

int i1 = pair.p1;
int i2 = pair.p2; 
```

您还可以放入 getter、setter、equals、hashcode 等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T18:38:19.427

如果您可以使用低级结构并且迫切需要“字面”形式的“成对集”的紧凑形式——这在单元测试中发生在我身上，当我需要一组固定装置时——你可以简单地使用一个数组数组：

```
int[][] squares = {
    { 1, 1 },
    { 2, 4 },
    { 3, 9 }
}; 
```

但请记住，这种类型没有语义——这完全取决于正确使用，如果您`squares[0][1]`在真正需要时键入，编译器不会给您警告`squares[1][0]`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T18:50:03.250

如果您需要避免重复，那么 HashSet 将是一个不错的选择，但不是 ArrayList 会起作用。

```
Class IntPair(){
  int i;
  int j;
}
HashSet<IntPair> set = new HashSet<IntPair>(); 
```

或者

```
ArrayList<IntPair> list = new ArrayList<IntPair>(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-01T16:37:32.020

**方式 1：使用 javafx.util.Pair 类**

```
Pair<Integer> myPair1 = new Pair<Integer>(10,20);
Pair<Integer> myPair2 = new Pair<Integer>(30,40);
HashSet<Pair<Integer>> set = new HashSet<>(); // Java 8 and above
set.add(myPair1);
set.add(myPair2); 
```

**方式 2：使用大小为 2 的 int[]**

```
int[] myPair1 = new int[] {10,20}; // myPair1[0]=10 , myPair[1] = 20
int[] myPair2 = new int[] {30,40};
HashSet<int[]> set = new HashSet<>(); // Java 8 and above 
```

**方式3：将pair转换为单个数字**

```
int myPair1 = 10 * 1000 + 20; 
// int first = myPair1 / 1000; second = myPair2 % 1000;
int myPair2 = 30 * 1000 + 40;
HashSet<Integer> set = new HashSet<>();
set.add(myPair1);
set.add(myPair2); 
```

**方式 4：在方式 2 中使用 ArrayList 而不是 int[]**

**方式 5：内部使用 HashSet 和 Pair 的自定义类***

# java - 从 JProfiler 中的离线运行中导出自定义探针图

> ID：10234489
> 
> 赞同：1
> 
> 时间：2012-04-19T18:29:35.580
> 
> 标签：java, export, offline, jprofiler

我在 JProfiler 中使用离线分析（在远程机器上），我试图使用 jpexport 命令从快照中导出图形。但是，由于某种原因，我无法从我的自定义探针中获取那些，即使当我使用 JProfiler GUI 打开快照时，我也可以访问这些图表。

请注意，我正在通过 Profiling API 收集数据，例如，使用实现“TelemetryProbe”的 Java 类。在文档中，也有使用自定义探针向导的可能性，我想知道在将会话文件导出到分析机器后，我是否必须通过这种方法来获得我想要的东西。

对于 jpexport，我尝试按照自定义探针的说明从“ProbeTelemetry”导出图形，并提供 ID 1 以获取我的第一个探针，但没有成功。我什至尝试了 0，但它仍然返回说没有具有此类 ID 的探测器。

不过，我再说一遍，当使用 GUI 上传快照时，图表就在那里，所以 JProfiler 正在收集信息，我只是不知道如何访问它。

有什么建议么？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T07:31:44.237

作为导出的探针名称，使用

```
-probeid=1 
```

其中 n 是自定义探针的从 1 开始的索引。

# c - 为c中的结构数组动态分配内存

> ID：10234490
> 
> 赞同：0
> 
> 时间：2012-04-19T18:29:44.897
> 
> 标签：c, struct, dynamic-memory-allocation

我有两个结构，如下所示

```
struct server{
    // some members
};

struct msg{
    struct server* servers;
}; 
```

然后我这样做。

```
struct msg msg1;
struct server s1,s2;

msg1.servers = (struct server *)malloc(2*sizeof(struct server));
msg1.servers[0] = &s1; // compilation error 
msg1.servers[1] = &s2;  // compilation error 
```

此代码无法编译并给出以下错误：从类型“struct server *”分配给类型“struct server”时类型不兼容。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:33:03.397

这里的问题是表达式`msg1.servers[0]`产生 a`struct server`但您提供的是`struct server*`(指针类型与非指针类型)。有两种方法可以解决此问题

第一种是`struct server`按照代码的预期简单地按值提供实例

```
msg1.servers[0] = s1;
msg1.servers[1] = s2; 
```

如果`struct server`是一种在复制时行为正确的类型，这将起作用。

如果您想继续`struct server*`在`struct msg`. 在这种情况下，您需要一个双指针来存储服务器指针。你需要`malloc`适当地调整你的陈述

```
struct msg{
    struct server** servers;
};

msg1.servers = malloc(2*sizeof(struct server*));
msg1.servers[0] = &s1; 
msg1.servers[1] = &s2; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T18:32:36.517

您不需要＆符号：

```
msg1.servers[0] = s1;
msg1.servers[1] = s2; 
```

说`&s1`会给你一个*指向*a的指针`struct server`，但`msg1.servers[0]`它是你刚刚分配的数组中的一个元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T18:36:01.040

`msg.servers`是指向类型的指针`server`。当您使用时，`msg.servers[0]`您正在取消引用指针，因此它的类型是 now `server`， not `server *`，显然您不能将`server`实例的地址分配给它。

您可能需要以下内容：

```
struct msg{
  struct server** servers;
};

struct msg msg1;
struct server s1,s2;

msg1.servers = malloc(2 * sizeof(struct server *));
msg1.servers[0] = &s1;
msg1.servers[1] = &s2; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T18:34:52.737

```
msg1.servers[0] = &s1; 
```

数组下标隐式取消引用指针 ( `a[i] == *(a + i)`，因此表达式的类型`msg1.servers[0]`是`struct server`，不是`struct server *`。

`struct msg`将您的定义更改为

```
struct msg {
  struct server **servers; // servers will be an array of pointers
}; 
```

并`malloc`呼吁

```
msg1.servers = malloc(2 * sizeof *msg1.servers); 
```

然后分配将起作用。

**编辑**

或者，就像其他人指出的那样，`&`从作业中删除。这取决于您打算`servers`代表什么；它是一个数组`struct server`，还是一个指针数组`struct server`？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T18:37:07.897

你需要一个指针数组

```
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    struct server{
        // some members
    };  

    struct msg{
        struct server ** servers;
    };  

    struct msg msg1;
    struct server s1,s2;

    if ((msg1.servers = malloc(2 * sizeof(struct server *))) == NULL) {
        printf("unable to allocate memory \n");
        return -1; 
    }   
    msg1.servers[0] = &s1; // compilation error 
    msg1.servers[1] = &s2;  // compilation error

    free(msg1.servers);

    return 0;
} 
```

# asp.net - 一个 asp.net 应用程序的定义？

> ID：10234494
> 
> 赞同：0
> 
> 时间：2012-04-19T18:30:03.227
> 
> 标签：asp.net

您如何定义**一个**asp.net 应用程序？它必须在一个解决方案下构建还是必须在 IIS 下的一个应用程序下部署？

是否可以在一个 IIS 应用程序下部署多个 Web 项目（以便它们可以访问彼此的会话、缓存等）？

这只是一个理论问题。

**更新：**我强调的是使它成为**一个**应用程序的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:12:48.387

应用程序是如何在 IIS 下部署的。一个应用程序可以包含多个项目，但在 IIS 下，所有项目将组合为一个应用程序。

如果出于某种原因，一个网站被分为两个解决方案，但在部署过程中它进入 IIS 下的一个网站，那么这实际上是一个应用程序和两个解决方案。

说了这么多，很大程度上取决于你和你的团队如何使用这个术语。这里没有黑白规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:34:45.597

我将 asp.net 应用程序定义为主要使用 asp.net 作为其背后的技术构建的任何 Web 应用程序。

# c# - 尝试通过应用连接而不是通过 Management Studio 连接时登录失败

> ID：10234501
> 
> 赞同：1
> 
> 时间：2012-04-19T18:30:21.073
> 
> 标签：c#, asp.net, sql-server, sql-server-2012

我有一个只是不连接到数据库的网站。两者都在我的本地机器上。使用相同的参数（主机、用户 ID、密码和数据库），我可以连接 MS SQL Server Management Studio。

我的问题能解决什么问题？？

这是我尝试使用的两个 ConnectionStrings：

`Data Source=VIVID-28\MSSQLSERVER1;Initial Catalog=DicionarioDados;Persist Security Info=True;User ID=VIVID-28\Development;Password=*******`

`Server=VIVID-28\MSSQLSERVER1;Database=DicionarioDados;Integrated Security=SSPI;User ID=VIVID-28\Development;Password=*******`

`VIVID-28`是我机器的名字。 `MSSQLSERVER1`是实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:39:16.837

要测试您的连接，您可以尝试使用 VS 服务器资源管理器，并通过将连接添加到您的 sql 服务器数据库，您可以测试是否可以使用给定的参数建立连接。您可以连接的那些您可以选择连接并转到属性并复制连接字符串并将其作为您的应用程序连接字符串过去。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T19:20:05.293

尝试删除“Integrated Security=SSPI”部分。这意味着它使用 Windows 身份验证，因此将忽略您在连接字符串中传递的用户名和密码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:49:01.627

这可能有很多原因，请参阅以下类似问题并查看我在帖子中提供的链接，按照步骤操作。

[为什么我无法从 asp.net 网站连接到远程 SQL Server，而它正在从 SQL Server Management Studio 连接](https://stackoverflow.com/questions/9819648/why-i-am-not-able-to-connect-to-remote-sql-server-from-asp-net-website-whereas-i)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T20:28:18.880

您是否使用多个 SQL Server？

您确定 SQL Management Studio 连接到与您的代码相同的 sql 服务器/实例吗？如果您有生产和开发服务器，您可能在生产服务器上创建了用户，但没有在开发服务器上创建用户，或者密码可能不正确。

尝试在您的开发服务器上重置密码，看看它会把您带到哪里。（：

# jquery - 如何让 Firefox 确认我的警报框并等到用户单击“确定”后再转发到下一页

> ID：10234512
> 
> 赞同：2
> 
> 时间：2012-04-19T18:31:28.560
> 
> 标签：jquery, firefox

有问题的页面在这里： [http ://ezup.com/csg/gt.html](http://ezup.com/csg/gt.html)

在 Firefox 中，警报框会触发，但随后页面会自动转发而无需等待用户的任何输入。这在 IE 和 Chrome 中有效，但 Chrome 似乎无法识别 cookie...

```
 <script type="text/javascript">
        $(document).ready(function(){
            (".buy > a").click(function(){
                //alert($.cookie("firstClick"));
                if($.cookie("firstClick") != 1){
                    $.cookie("firstClick", "1");
                    alert("You will now be directed to the Shopping Cart page. Please use your browser's back button to return to the CSG store.");
                }
                else if($.cookie("firstClick") == 1){

                }

            });
        });
    </script>

    <body>
      <ul>
        <li class="buy">
            <a href="http://store.ezup.eu/ShoppingCart.asp?ProductCode=EC2HSF1010W&ProductCode=EC1010402142T">L
                <button type="button">Add to Cart</button>
            </a>
        </li>
      </ul>
    </body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:36:49.090

改为将其更改为确认对话框。或将 prevent default 添加到函数[http://api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/)

```
<script type="text/javascript">
        $(document).ready(function(){
            prompt
            $(".buy > a").click(function(e){
            e.preventDefault();
                //alert($.cookie("firstClick"));
                if($.cookie("firstClick") != 1){
                    $.cookie("firstClick", "1");
                    alert("You will now be directed to the Shopping Cart page. Please use your browser's back button to return to the CSG store.");
                    window.location = $(this).attr(href);
                }
                else if($.cookie("firstClick") == 1){

                }

            });
        });
    </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T20:11:31.790

也许您需要稍微不同地捕获选择器。通过查看您的来源，我看到以下内容：

```
<li class="buy">
    <a>
        <button type="button" onclick="openURL1()" value="GO">Add to Cart</button>
    </a>
</form>
</li> 
```

首先，`</form>`标签不属于。

其次，如果我正在构建您的单击事件处理程序，我认为您可能还必须将其附加到按钮上。您的示例仅显示连接到`.buy > a`标签。（更新：我刚刚确认`.buy > a`应该也可以。）

试试这个：

```
$(".buy > a > button").click(function() {
    if (!confirm("Leave?")) {
        // If they 'cancel', leave them on the current page
        event.preventDefault();
        return false;
    } else {
        // Proceed with your navigation
    }
}); 
```

更新了确认框的[小提琴。](http://jsfiddle.net/dyFR5/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T20:16:03.317

```
window.onbeforeunload = function() {
    return "Are you sure you want to navigate away?";
}​ 
```

[http://jsfiddle.net/ppumkin/BddDK/](http://jsfiddle.net/ppumkin/BddDK/)

# django - 安装后 PostgreSQL 套接字错误

> ID：10234514
> 
> 赞同：0
> 
> 时间：2012-04-19T18:31:34.077
> 
> 标签：django, postgresql

我在 OS X 10.6 上从 EnterpriseDB 安装了 PostgreSQL(9.0.7)。但是，当我做一个简单的

```
$ psql -U postgres 
```

我明白了

```
psql: could not connect to server: No such file or directory
Is the server running locally and accepting
connections on Unix domain socket "/var/pgsql_socket/.s.PGSQL.5432"? 
```

我在 Django 中使用它。我尝试将 settings.py 中的主机变量更改为

```
'HOST': '/tmp' 
```

但是当我执行 syndb 时，我仍然收到相同的错误消息。有任何想法吗？谢谢你。

在我的**postgresql.conf**

```
listen_addresses = '*'      
port = 5432             
unix_socket_directory = '/var/pgsql_socket/' 
```

**编辑：** 我让它工作了。出于某种原因，安装了较新的 9.1.3 版本并且该错误消失了。我还从 PostgreSQL 的备忘单中获得了一些帮助（http://od-eon.com/blogs/calvin/postgresql-cheat-sheet-beginners/）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:41:47.993

你启动数据库集群了吗？您应该能够通过运行命令来判断

```
ps auwwx|grep postg 
```

您应该看到几个 postgresql 进程。如果不这样做，则需要启动数据库服务器。

[http://www.postgresql.org/docs/9.0/static/server-start.html](http://www.postgresql.org/docs/9.0/static/server-start.html)

# html5-filesystem - HTML5 文件系统 - 如何使用目录阅读器读取目录？

> ID：10234515
> 
> 赞同：5
> 
> 时间：2012-04-19T18:31:36.300
> 
> 标签：html5-filesystem

我使用文件输入和 webkitdirectory 加载了一个目录，如下所述。

```
<input  id="file_input"  type="file" webkitdirectory directory  /> 
```

选择目录后，我可以读取文件大小和其他信息。我的问题是如何使用 DirectoryReader 接口读取这个目录。

我尝试使用以下代码，但没有成功。results.length 变为零。我错过了什么吗？

```
window.requestFileSystem(TEMPORARY, 1024*1024 /*1MB*/, function(fs) {
        var dirReader = fs.root.createReader();
        var entries = [];
        // Call the reader.readEntries() until no more results are returned.
        var readEntries = function() {
            dirReader.readEntries(function(results) {
                // If no more results are returned, we're done.
                if (!results.length) {
                    // Sort list by name of entry.
                    entries.sort(function(a, b) {
                        return a.name < b.name ? -1 :
                        b.name < a.name ? 1 : 0;
                    });
                   // listResults(entries); // Render the list.
                } else {
                    // Add in these results to the current list.
                    entries = entries.concat(toArray(results));
                    readEntries();
                }
            }, errorHandler);
        };
        readEntries(); // Start reading the directory.
    }, errorHandler); 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-19T18:35:33.113

要读取目录的内容：

```
fs.root.getDirectory('Documents', {}, function(dirEntry){
  var dirReader = dirEntry.createReader();
  dirReader.readEntries(function(entries) {
    for(var i = 0; i < entries.length; i++) {
      var entry = entries[i];
      if (entry.isDirectory){
        console.log('Directory: ' + entry.fullPath);
      }
      else if (entry.isFile){
        console.log('File: ' + entry.fullPath);
      }
    }

  }, errorHandler);
}, errorHandler); 
```

在上面的代码中，使用 isDirectory 和 isFile 属性分别为目录和文件获取不同的输出。此外，我们使用 fullPath 属性来获取条目的完整路径，而不仅仅是其名称。

来自： http: [//net.tutsplus.com/tutorials/html-css-techniques/toying-with-the-html5-filesystem-api/](http://net.tutsplus.com/tutorials/html-css-techniques/toying-with-the-html5-filesystem-api/)

# python - 这是一种 Pythonic 的模块构建方式吗？

> ID：10234516
> 
> 赞同：0
> 
> 时间：2012-04-19T18:31:36.220
> 
> 标签：python, module

假设我正在编写一个应用程序，该应用程序使用了许多我正在为其编写 Python 代码的 GUI 控件。每个控件都由一个类描述，我想将所有这些类聚合到一个名为`gui`. 作为一名经验丰富的 C/C++ 开发人员，对我来说，按文件分隔类实现是最有意义的，如下所示：

```
gui/MainWindow.py
gui/Widget1.py
gui/Widget2.py 
```

其中，在上面，`MainWindow`类的规范将在`MainWindow.py`. 但是，如果我以这种方式布置文件，那么获取这些类的语法如下所示：

```
import gui
w = gui.MainWindow.MainWindow() 
```

这似乎是多余的。解决此限制的一种方法是编辑`gui/__init__.py`说：

```
from gui.MainWindow import *
from gui.Widget1 import *
from gui.Widget2 import * 
```

它将类带入`gui`模块命名空间。然后我可以按如下方式访问它们：

```
w = gui.MainWindow() 
```

这通常会完成吗？它是否有足够的 Pythonicity 被认为在社区中是合适的？`gui/__init__.py`我可以看到的一个缺点是，当我向模块添加新的子模块时，我需要确保保留`gui`；我不喜欢这样的手动步骤。

关于如何更好地解决这个问题的想法和/或建议会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:34:17.340

不要导入`*`（除非你*确定*不会有冲突；这个规则可以适用于*包*作者），但当然这是一个可以接受的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:14:27.147

您之前可能已经注意到这些 PEP 和文档站点：

*   [PEP8——Python 代码风格指南](http://www.python.org/dev/peps/pep-0008/)
*   [PEP 20——Python之禅](http://www.python.org/dev/peps/pep-0020/)
*   [套餐](http://docs.python.org/tutorial/modules.html#packages)

所以我唯一可以添加的就是不要使用`import *`. 一个例子：

```
>>> from pylab import *
>>> any(False for i in range(5))
True 
```

当您有效地争辩说您知道自己在做什么时。您不能假设`import *`您包中的所有潜在重用用户都知道他们正在隐藏什么，同时他们拆除了他们和您的代码之间的最终命名空间障碍。这会产生令人讨厌的错误。也可以看看：

> 现在当用户写入时会发生什么`from sound.effects import *`？理想情况下，希望以某种方式传递到文件系统，找到包中存在哪些子模块，然后将它们全部导入。这可能需要很长时间，并且导入子模块可能会产生不希望的副作用，这些副作用仅在显式导入子模块时才会发生。[文档](http://docs.python.org/tutorial/modules.html#importing-from-a-package)

和

> （导入 * 不是一个选项 ;-) [PEP328](http://www.python.org/dev/peps/pep-0328/)

和

> 命名空间是一个很棒的想法——让我们做更多的事情！[PEP20](http://www.python.org/dev/peps/pep-0020/)

但这些只是指南/建议/个人偏好，当这些不适用时，肯定存在极端情况。

# ruby-on-rails - Ruby on Rails：错误的参数类型 nil（预期为 Fixnum）

> ID：10234517
> 
> 赞同：3
> 
> 时间：2012-04-19T18:31:54.003
> 
> 标签：ruby-on-rails, ruby

我收到奇怪的错误

```
ActionView::Template::Error (wrong argument type nil (expected Fixnum)): 
```

在这条线上：

```
<%= (!attach.file_size.nil?) ? "(#{number_to_human_size(attach.file_size.to_i).to_s})": ""  %> 
```

这是我的代码：

```
<% if !pr.attachments.empty? %>
<ul class="attached_files">
  <% pr.attachments.each do |attach| %>
    <li><a href="<%= attach.path_url%> " target="_blank"><%= attach.path_identifier%></a> 
    <%= (!attach.file_size.nil?) ? "(#{number_to_human_size(attach.file_size.to_i).to_s})": ""  %>
    </li>
  <%end%>
</ul>
<% end %> 
```

我不明白问题出在哪里。请帮帮我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:41:55.430

什么语言环境？如果不是英语语言环境，请尝试一个。

听起来很像[这个错误](https://github.com/locomotivecms/engine/issues/183)，其中调用`number_to_human_size`最终调用`BigDecimal.new(the_number.to_s).round(...).to_f`，并且`round()`由于语言环境问题而失败。生成的异常与您的错误完全匹配（*"wrong argument type nil (expected Fixnum)"*）。

# asp.net - 适用于 IE9 的动态生成的 svg

> ID：10234520
> 
> 赞同：0
> 
> 时间：2012-04-19T18:31:59.797
> 
> 标签：asp.net, svg, internet-explorer-9, ashx

我们的网页使用从 ashx 页面动态生成的 svg。这适用于 IE8 及更早版本，使用 Adob​​e SVG 插件。它在 IE9 中不起作用（包括兼容模式）。我们正在使用 <object> 标签。我正在尝试修改页面以使用 IE9。

我能够使用我在网上找到的一个简单的测试 svg 来渲染 SVG：

```
<embed src="http://oursite.com/circle1.svg" type="image/svg+xml"
    height="200" width="550"/> 
```

但是，如果我将其更改为：

```
<embed src="http://oursite.com/ourhandler.ashx?t=Circle&v=1&ext=.svg"
    type="image/svg+xml" height="200" width="550"/> 
```

我得到一个带有禁用垂直滚动条的空白框。

的输出`"ourhandler.ashx?t=Circle&v=1&ext=.svg"`内容与“circle1.svg”相同，浏览到[http://oursite.com/Ourhandler.ashx?t=Circle&v=1&ext=.svg](http://oursite.com/Ourhandler.ashx?t=Circle&v=1&ext=.svg)直接在 IE9 中正确呈现。

我需要做什么才能使动态生成的 svg 在 IE9 中工作？我没有附加到`<embed>`标签，但没有任何其他方法（如`<object>`标签）的运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-31T20:01:10.883

检查您是否允许处理程序的 HEAD 请求。IE 曾经有两个 GET 请求：一个用于内容类型，一个用于对象。现在第一个请求是 HEAD，所以如果动词不被允许，第二个请求将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T06:21:00.317

我也有同样的问题。

我使用[Fiddler](http://www.fiddler2.com/)跟踪问题，然后我发现该元素没有向“scr”属性指定的 URL 发布请求。但是当“src”的 ext 以“.svg”开头时它确实请求。

最后我找到了解决方案。

**步骤1**

我将 src 更改为类似（使用“.svgx”ext）

```
<embed src="http://oursite.com/ourhandler.svgx?t=Circle&v=1"
type="image/svg+xml" height="200" width="550"/> 
```

**第2步**

编写一个 HttpModule将 URL[重写](http://msdn.microsoft.com/en-us/library/ms972974.aspx)为您的真实 URL。

在您的情况下，真正的 URL 是`http://oursite.com/ourhandler.ashx?t=Circle&v=1&Ext=.svg`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T14:10:02.900

适用于所有浏览器：

[http://jsfiddle.net/mihaifm/n8DWe/3/](http://jsfiddle.net/mihaifm/n8DWe/3/)

也许这是您如何封装嵌入的问题。

# c# - 如何将项目从 ListView 添加到字符串？

> ID：10234533
> 
> 赞同：0
> 
> 时间：2012-04-19T18:32:48.930
> 
> 标签：c#, asp.net

我试图将列表视图中的所有项目都放入一个字符串中，如下所示：

```
foreach(ListViewItem item in ListView1.Items)
{
     thisstring += item...?
} 
```

item.Text 不是 item 的属性...似乎可以解决这个问题。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:34:28.840

您可以使用 LINQ 选择所有项目`Text`。

```
var allItems = ListView1.Items.Cast<ListItem>().Select(i => i.Text);
var allItemText = String.Join(",", allItems); 
```

请注意，您需要添加`System.LINQ`命名空间。

**编辑**：我读过`ListBox`， ListView 没有 Text 属性，我不确定你真正想要连接什么文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:39:23.503

```
foreach(ListViewItem item in ListView1.Items)
{
     thisstring += item.Text+",";
}
    thisstring.TrimEnd(','); 
```

是不是很简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T18:36:31.190

```
StringBuilder sb = new StringBuilder();
foreach(ListViewItem item in ListView1.Items)
{
     sb.Append(item.Text);
     sb.Append(',');
}

Console.WriteLine(sb.ToString().TrimEnd(',')); 
```

编辑：正如 Tim 和 Guest 所说，在 ASP.Net 中没有 ListViewItem 的 Text 属性，[Windows Forms 具有 ListViewItem](http://msdn.microsoft.com/en-us/library/system.windows.forms.listviewitem.text.aspx)并且它具有 text 属性。[ASP.Net ListView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listviewitem.aspx)没有 Text 属性

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T18:36:48.660

```
 string.Join(" ", ListView1.Items.Cast<ListItem>().Select(i => i.Text).ToArray()); 
```

# android - How can I display a previous EditText user input, as well as a recent EditText user input?

> ID：10234535
> 
> 赞同：1
> 
> 时间：2012-04-19T18:32:55.247
> 
> 标签：android, sharedpreferences

I have a SharedPreferences that saves EditText input from one activity and displays the String value in another activity.

When I enter an input into the EditText fields and press (a button I created) "Save" (which commits the EditText to editor), the file is stored and displayed successfully.

However, I want it so that everytime the user adds another entry in the EditText, it displays underneath the previously added EditText input. Like a list. I understand that both are reading from the SharedPreferences file. How would I go about doing this?

CustomStoreEditActivity - Just storing the user inputs (EditText entries):

```
 final Button saveButton = (Button) findViewById(R.id.saveButton);
saveButton.setOnClickListener(new View.OnClickListener() {

    public void onClick(View arg0) {
        if (saveButton.isClickable()) {
            SharedPreferences prefs = getSharedPreferences(
                    "customtime", 0);
            // prefs.registerOnSharedPreferenceChangeListener(this);
            final SharedPreferences.Editor edit = prefs.edit();
            EditText shopName = (EditText) findViewById(R.id.shopName);
            EditText open1 = (EditText) findViewById(R.id.open1);
            EditText close1 = (EditText) findViewById(R.id.close1);
            EditText open2 = (EditText) findViewById(R.id.open2);
            EditText close2 = (EditText) findViewById(R.id.close2);
            EditText open3 = (EditText) findViewById(R.id.open3);
            EditText close3 = (EditText) findViewById(R.id.close3);
            EditText open4 = (EditText) findViewById(R.id.open4);
            EditText close4 = (EditText) findViewById(R.id.close4);
            EditText open5 = (EditText) findViewById(R.id.open5);
            EditText close5 = (EditText) findViewById(R.id.close5);
            EditText open6 = (EditText) findViewById(R.id.open6);
            EditText close6 = (EditText) findViewById(R.id.close6);
            EditText open7 = (EditText) findViewById(R.id.open7);
            EditText close7 = (EditText) findViewById(R.id.close7);
            EditText comments = (EditText) findViewById(R.id.comments);
            edit.putString("shopName", shopName.getText().toString());
            edit.putString("Monday1", open1.getText().toString());
            edit.putString("Monday2", close1.getText().toString());
            edit.putString("Tuesday1", open2.getText().toString());
            edit.putString("Tuesday2", close2.getText().toString());
            edit.putString("Wednesday1", open3.getText().toString());
            edit.putString("Wednesday2", close3.getText().toString());
            edit.putString("Thursday1", open4.getText().toString());
            edit.putString("Thursday2", close4.getText().toString());
            edit.putString("Friday1", open5.getText().toString());
            edit.putString("Friday2", close5.getText().toString());
            edit.putString("Saturday1", open6.getText().toString());
            edit.putString("Saturday2", close6.getText().toString());
            edit.putString("Sunday1", open7.getText().toString());
            edit.putString("Sunday2", close7.getText().toString());
            edit.putString("comments", comments.getText().toString());
            edit.commit();
            Intent myIntent = new Intent(getBaseContext(),
                    CustomStoreActivity.class);
            myIntent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
            startActivity(myIntent);

            Toast.makeText(getBaseContext(), "Opening Hours Saved!",
                    Toast.LENGTH_SHORT).show();

        }

    }
});

} 
```

CustomStoreActivity - where I retrieve the data and display:

```
 public void  onResume() {
    SharedPreferences prefs = getSharedPreferences("customtime", 0);
    String shopName = prefs.getString("shopName", "Empty");
    String shopTimeM1 = prefs.getString("Monday1", " ");
    String shopTimeM2 = prefs.getString("Monday2",  " ");
    String shopTimeT1 = prefs.getString("Monday1", " ");
    String shopTimeT2 = prefs.getString("Monday2",  " ");
    String shopTimeW1 = prefs.getString("Monday1", " ");
    String shopTimeW2 = prefs.getString("Monday2",  " ");
    String shopTimeTH1 = prefs.getString("Monday1", " ");
    String shopTimeTH2 = prefs.getString("Monday2",  " ");
    String shopTimeF1 = prefs.getString("Monday1", " ");
    String shopTimeF2 = prefs.getString("Monday2",  " ");
    String shopTimeS1 = prefs.getString("Monday1", " ");
    String shopTimeS2 = prefs.getString("Monday2",  " ");
    String shopTimeSU1 = prefs.getString("Monday1", " ");
    String shopTimeSU2 = prefs.getString("Monday2",  " ");
    String shopComments = prefs.getString("comments", "");

    TextView displayPrefs = (TextView) findViewById(R.id.displayPrefs);

    displayPrefs.setText(
            "------------------------------------------------------------" +
            "\n\nSHOP NAME: " + shopName +
            "\n\nTIMINGS: " + "\n\n  Monday: " + shopTimeM1 + " - " + shopTimeM2  +
            "\n  Tuesday: " + shopTimeT1 + " - " + shopTimeT2 + "\n  Wednesday: "
            + shopTimeW1 + " - " + shopTimeW2 + "\n  Thursday: " + shopTimeTH1 
            + " - " + shopTimeTH2 + "\n  Friday: " + shopTimeF1 + " - " + shopTimeF2 + 
            "\n  Saturday: " + shopTimeS1 + " - " + shopTimeS2 + "\n  Sunday: " +
            shopTimeSU1 + " - " + shopTimeSU2 +
            "\n\nCOMMENTS: " + shopComments +
            "\n\n------------------------------------------------------------");
    super.onResume();
} 
```

Thank you for your humble time.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:18:31.047

It sounds to me like you are trying to build a list. Pardon my initially nebulous answer but I promise it will eventually focus in on a point.

What I would recommend for the overall framework is this:

You have an `Activity` (presumably your `CustomStoreActivity`) which displays a list of saved `Store` objects. `Store` will need to implement `Parcelable` or `Serializable` (preferably the former).

On this `Activity` there is a `New Store` button (if you are following Android design convention, this is likely as a "+" button in the Action Bar).

On pressing the `New Store` button, your `CustomStoreActivity` calls `startActivityForResult(CustomStoreEditActivity.class)`.

Your `CustomStoreActivity` implements `onActivityResult` as per the answer on the last [question](https://stackoverflow.com/questions/10233751/how-can-i-display-values-from-edittext-user-input) you asked. Here, you will get a result code and an `Intent` which contains `Extras` (to be retrieved by `intent.getExtras()`).

Your `CustomStoreEditActivity` takes user input, as above, and instead of writing it to `SharedPreferences` it uses the information to create a new `Store` object which contains all of the information, and uses `setResult(RESULT_OK,intent)` where `intent` is the `Intent` to which you have added the `Store` extra (as a `Parcelable`).

This means that when `CustomStoreEditActivity` calls `finish()` (which you will do instead of using an intent to re-launch your `CustomStoreActivity` because the `CustomStoreActivity` is already just behind it) you'll get your call to `onActivityResult` and can pull the `Store` object out of the `Extras` from the `Intent` you just passed back.

And now to the point:

You can use a `ListView` in your `CustomStoreActivity`, and use a `StoreAdapter` that extends `ArrayAdapter<Store>`, and for each item in the list of `Store`s adds a view to the list containing that `Store`'s name. Then you'll just add your new `Store` object to the array you passed into your `StoreAdapter`, and call `adapter.notifyDataSetChanged()` in `onActivityResult` and that should take care of it.

If ultimately you need to persist this data between application sessions, you should handle writing the `Store` objects to the `SharedPreferences` in the `onPause` method of `CustomStoreActivity` (it being the keeper of the list) rather than touching your shared preferences from every direction. You can then read in the list again in `onCreate` should you need to.

I know it's a lot to parse through/digest, but it's a pretty standard mechanism for passing data between `Activity` constructs in Android and for persisting data.

Let me know if you have any questions on the implementation and I'll see what I can do! :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T13:28:46.197

Take a look at my answer here: [Show a drop down list of recently entered text when clicks on an android edit box](https://stackoverflow.com/questions/10499530/show-a-drop-down-list-of-recently-entered-text-when-clicks-on-an-android-edit-bo/15368045#15368045)

All you would really need to do is change the preference mode to public, not private.

# objective-c - 即使在使用 insertRowsAtIndexPaths 方法之前更新 DataSource 也无法将 Cell 插入 UITableView

> ID：10234543
> 
> 赞同：0
> 
> 时间：2012-04-19T18:33:26.867
> 
> 标签：objective-c, cocoa-touch, uitableview

我正在尝试在事件 tableView:didSelectRowAtIndexPath 上点击的单元格下方添加一个新单元格

这些是我的 numberOfSectionsInTableView 和 numberOfRowsInSection 方法。属性 self.dataTable 是我的 TableView 的数据源。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    //i have that - 1 there because i don't want to use the first row of my dataTable.
    //On my cellForRowAtIndex method I'm adding a +1 to the indexPath.row to get the right row information
    return [self.dataTable count] - 1;
} 
```

我的添加方法是：

```
-(void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    NSMutableArray * newRow = [NSMutableArray arrayWithObjects:@"Columna 1", @"Columna 2", @"Columna 3", @"Columna 4", nil];
    //here im adding the new item to the datasource.
    [self.dataTable insertObject:newRow atIndex:indexPath.row + 1];                       

    NSArray *newData = [NSArray arrayWithObjects:[NSIndexPath indexPathForRow:(indexPath.row + 1) inSection:1], nil];
    //self because this clas inherits from UITableView and implements its own delegate and datasource.
    //The error is also produced using tableView instead of self.
    [self beginUpdates];

    [self insertRowsAtIndexPaths:newData withRowAnimation:UITableViewRowAnimationBottom];

    [self endUpdates];

} 
```

当调试器到达 [self endUpdates] 时，方法 numberOfRowsInSection 被启动，我可以看到返回更新为 +1，但是我收到此错误：

> 异常名称：NSInternalInconsistencyException 原因：无效的表视图更新。应用程序已请求更新与数据源提供的状态不一致的表视图。

编辑：添加 cellForRowAtIndexPath

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString * CellIdentifier = @"SWTableCell";

UITableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil)
{
    UILabel *lblTemp; //Used for creates labels for cell
    CGRect readjust, rectTemp;
    rectTemp = CGRectMake(0, 0, self.frame.size.width, 15); //Size of the cell

    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    cell.frame = rectTemp;

    int x = 10; //initial x position for each label
    for(int i = 0; i < self.columnCount; i++)
    {
        rectTemp = CGRectMake(x, 10, COLUMN_WIDTH, 20); //Size of each column

        lblTemp = [[UILabel alloc] initWithFrame:rectTemp]; //inicialize label
        lblTemp.tag = i;
        [lblTemp setUserInteractionEnabled:NO];
        lblTemp.text = (NSString *)[[dataTable objectAtIndex:indexPath.row + 1] objectAtIndex:i];
        lblTemp.autoresizingMask= UIViewAutoresizingFlexibleRightMargin;
        [lblTemp setHighlightedTextColor:[UIColor whiteColor]];
        if(i!=0) lblTemp.textAlignment = UITextAlignmentRight;
        else lblTemp.textAlignment = UITextAlignmentLeft;

            lblTemp.font = [UIFont systemFontOfSize:10];
            [cell setUserInteractionEnabled:YES];
            cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

        [lblTemp setNumberOfLines:1];
        [lblTemp sizeToFit];

        readjust = lblTemp.frame;
        readjust = CGRectMake(readjust.origin.x, readjust.origin.y, COLUMN_WIDTH, readjust.size.height);
        lblTemp.frame = readjust;

        [cell.contentView addSubview:lblTemp];
        [lblTemp release];

        x = x + COLUMN_WIDTH;
    }
    }
    return cell;
} 
```

还有什么可能导致此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:38:23.970

我认为

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [self.dataTable count] - 1;
} 
```

应该

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [self.dataTable count];
} 
```

集合的找到或长度是它包含的项目数。只有索引从 0 开始。因此，如果您将 5 个项目放入一个数组中，则它的计数为 5，而最后一个项目的索引为 4。

现在我也瞎了：

```
-(void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    //…
    [self beginUpdates];
    [self insertRowsAtIndexPaths:newData withRowAnimation:UITableViewRowAnimationBottom];
    [self endUpdates];
} 
```

一定是

```
-(void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    //…
    [tableView beginUpdates];
    [tableView insertRowsAtIndexPaths:newData withRowAnimation:UITableViewRowAnimationBottom];
    [tableView endUpdates];
} 
```

# android - 在每个活动中检查用户“登录”的 Android 最佳实践

> ID：10234557
> 
> 赞同：3
> 
> 时间：2012-04-19T18:34:33.090
> 
> 标签：android, login, android-activity

在我的应用程序中，用户需要先进行身份验证，然后才能开始使用该应用程序。我在 startupActivity 中有这段代码

```
private boolean checkAuthentication() {
    SharedPreferences sp = getSharedPreferences(
            "com.simekadam.blindassistant", Context.MODE_PRIVATE);
    return sp.getBoolean("logged", false);
}

private void processStartup(){
    Log.d(TAG, "processing startup");
    if (checkAuthentication()) {
        Intent startApp = new Intent(getApplicationContext(),
                BlindAssistantActivity.class);
        startActivity(startApp);
    } else {

        Intent loginIntent = new Intent(getApplicationContext(), LoginActivity.class);
        startActivity(loginIntent);

    }
} 
```

它可以正常工作，但我需要在每个活动中（在 onStart 或 onResume 方法中）适当地检查它，但这会导致我所有活动中的代码重复。如何做到这一点的最佳方法是什么？我可以创建一个将与其他活动一起扩展的主活动吗？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T18:38:11.703

是的，您可以创建一个主 Activity 并使用“扩展”从它继承，但是如果我是你，我会研究 AppState。

您可以创建一个扩展 Application 类的类。然后，您可以将其用于“全局”变量和状态。

看看这个网页： [http ://www.helloandroid.com/tutorials/maintaining-global-application-state](http://www.helloandroid.com/tutorials/maintaining-global-application-state)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-20T20:05:49.687

我有时会做什么，我有我的默认 MainActivity，它总是在最初运行。

然后在 onCreate 我有一个检查来决定显示哪个屏幕：

```
boolean isLoggedIn = checkUserStatus();
Intent intent = isLoggedIn ? new Intent(context, HomeActivity.class) 
                           : new Intent(context, LoginActivity.class);
startActivity(intent); 
```

`checkUserStatus()`是一个简单的函数，它获取一个布尔标志来确定用户是否登录：

```
protected boolean checkUserStatus(){
    boolean isLoggedIn ;
    Context context = getApplicationContext();
    SharedPreferences pref = context.getSharedPreferences("Session Data", MODE_PRIVATE);
    isLoggedIn = pref.getBoolean("isLoggedIn", false);
    return isLoggedIn ;
} 
```

然后将 设置`boolean`为 true 或 false ：

```
SharedPreferences pref = context.getSharedPreferences(
        "Session Data", MODE_PRIVATE);
SharedPreferences.Editor edit = pref.edit();
edit.putInt("LAST_VERSION_CODE", BuildConfig.VERSION_CODE);
edit.putBoolean("isLoggedIn", true);// or false if you log out
edit.commit(); 
```

# c# - 如何通过参数化存储过程填充列表框？

> ID：10234562
> 
> 赞同：2
> 
> 时间：2012-04-19T18:34:49.957
> 
> 标签：c#, sql, winforms, stored-procedures

我有一个 Winforms 应用程序和一个employeeListBox、departmentComboBox 和一些文本框来显示员工信息，例如 fNameTextbox、lNameTextBox .....

我想通过departmentCombobox 选定值填充employeelistBox，并从employeeListBox 填充文本框。我有这个用于选择部门员工的存储过程

```
ALTER PROCEDURE [dbo].[selectEmployee] 
   @departID int
-- Add the parameters for the stored procedure here
AS
   -- SET NOCOUNT ON added to prevent extra result sets from
   -- interfering with SELECT statements.
   SET NOCOUNT ON;

   -- Insert statements for procedure here
   declare @ErrorCode int

   BEGIN TRANSACTION
      if ( @ErrorCode = 0 )
      Begin
        SELECT 
            EmpID, firstname, lastName, dateOfBirth, Gender, contactNumber, maritalStatus, 
            emailAddress, resentAddress, permanentAddress, nationality, bloodGroup, 
            qualification, Skills, Experience, joiiningdate, probation, departmentID, 
            Salary, paymentMode, active 
        FROM Employee
        WHERE departmentID = @departID

set @ErrorCode = @@error
      End

      if ( @ErrorCode = 0 )
     COMMIT TRANSACTION
      else
         ROLLBACK TRANSACTION

     return @ErrorCode 
```

并填充我写了这段代码的列表框

```
 private void selectEmployee(int departID)
    {
        string connString = BL.dbConn.ConnStr;
        DataSet ds = new System.Data.DataSet();
        SqlConnection conn = new SqlConnection(connString);
        conn.Open();
        SqlCommand cmd = new SqlCommand();
        cmd.CommandType = System.Data.CommandType.StoredProcedure;
        cmd.CommandText = "dbo.selectEmployee";
        SqlDataAdapter adapter = new SqlDataAdapter(cmd);
        adapter.Fill(ds);
        listBox1.DataSource = ds.Tables[0].DefaultView;
        listBox1.ValueMember = "EmpID";
        listBox1.DisplayMember = "firstname";
        cmd.Parameters.Clear();
        conn.Close();
        conn.Dispose();
    } 
```

我不知道如何将部门 ID 传递给存储过程，其次如何从列表框数据集中填充文本框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:38:23.973

要传递部门 ID，您需要创建 sql 参数并且需要使用 sql 命令附加将为您完成工作

您在代码中忘记的事情是`da.SelectCommand = cmd;`指定选择命令

```
 SqlConnection conn = new SqlConnection(connString);

        SqlCommand cmd = new SqlCommand();
        SqlDataAdapter da = new SqlDataAdapter();
        DataTable dt = new DataTable();
        try
        {
            conn.Open();
            cmd = new SqlCommand("dbo.selectEmployee", conn );
            cmd.Parameters.Add(new SqlParameter("@departID", value);
            cmd.CommandType = CommandType.StoredProcedure;
            da.SelectCommand = cmd;
            da.Fill(dt);
            dataGridView1.DataSource = dt;
        }
        catch (Exception x)
        {
            MessageBox.Show(x.GetBaseException().ToString(), "Error",
                    MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
        finally
        {
            cmd.Dispose();
            conn.Close();
        } 
```

为了在文本框中填充值，您能否发布您想要做的代码或示例，而不是我可以进一步帮助您

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:43:04.467

您需要执行以下操作才能将 DepartmentId 添加到存储过程：

```
cmd.Parameters.Add(new SqlParameter("@departID", departID)); 
```

# iphone - 开发人员的 iphone 选择

> ID：10234566
> 
> 赞同：0
> 
> 时间：2012-04-19T18:34:55.777
> 
> 标签：iphone, ios

我一直在使用模拟器和真正的 iPad 开发一些 iOs 的东西。现在我觉得我真的需要一部 iPhone，但我并不喜欢随身携带，我的诺基亚正好满足我的需求。我想知道：对于开发人员来说，获得二手 3g - 3gs 而不是昂贵的 4/4s 以便可以在最低端设备上试用这些应用程序不是更好吗？你怎么看？除了使用更新的视网膜屏幕尝试它之外，我是否会因为这个选择而失去一些东西？

* * *

编辑：我不想将它用作手机，它只是用于开发。我想知道从开发人员的角度来看，除了屏幕分辨率之外，所有 3g 以上的版本是否都相同。在这种情况下，由于我会做音频应用程序，我有可能测试最慢的硬件，这对我来说可能是一个不错的选择。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T18:43:56.100

您是否正在开发特定于手机的功能？如果没有，那么您可以使用 iPod Touch。当前一代有相机和视网膜屏幕；上一代的屏幕分辨率较低，可能没有摄像头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:54:37.687

我认为此时将 3G 定位为目标是错误的，因为可能到今年年底 4 或 4s 将取代 3G 作为低端设备。

如果您不介意升级超过这一点，那么将 3G 用于测试可能再过一两年是有意义的。

另一个考虑因素是，如果你真的追求增强现实，你可能想要使用 iPhone 4 的一些硬件改进，所以从这个角度来看，iPhone 4 作为测试设备比 3Gs 更有意义.

# android - 无法从 Eclipse 检查更新中看到 Indigo 或 Helios

> ID：10234567
> 
> 赞同：0
> 
> 时间：2012-04-19T18:34:57.027
> 
> 标签：android, eclipse

我目前在 Ubuntu 上运行 Eclipse 3.52，“Galileo”。我需要升级我的 ADT 版本，这需要更新版本的 Eclipse。

在 Window>Preferences>Install/Update>Available software sites 我只有 3 个站点，位于 http://dl-ssl.google.com/android/eclipse/ 的 ADT 和位于[http://dl-ssl.google.com/android/eclipse/](http://dl-ssl.google.com/android/eclipse/)[的](http://download.eclipse.org/releases/helios)Helios 和 Indigo 站点[/download.eclipse.org/releases/helios](http://download.eclipse.org/releases/helios)和 [http://download.eclipse.org/releases/indigo](http://download.eclipse.org/releases/indigo)分别是 * *En* *abled。

我还选中了“显示可用软件的所有版本”和“当为安装向导选择的软件可能不兼容时，仍然打开 wizaed”设置。但是当我运行 Help> **check for updates 时，**我可以看到它搜索 Indigo 和 Helios 站点，但是当它完成时它只显示“Subversion SVN Team Provider”。为什么它不向我显示 Indigo 或 Helios 更新，为什么它向我显示 Subversion？

是的，我确实多次停止并重新启动 Eclipse。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:39:05.353

我很确定你必须去下载 Helios 或 Indigo 并安装它，我认为它不会跳到较新的版本。检查更新只会让您获得最新版本的 Galileo。

# opengl-es - 在 iOS 上使用 Core Animation 与使用 Cocos2D 和 OpenGL ES 的适用性？

> ID：10234570
> 
> 赞同：1
> 
> 时间：2012-04-19T18:35:05.207
> 
> 标签：opengl-es, cocos2d-iphone, core-animation

我在一本书中完成了一个[突破性的游戏](http://en.wikipedia.org/wiki/Breakout_%28video_game%29)教程，但是球，这是一个 20x20 像素的图像，跳帧并且移动不是很流畅。模拟器和 iPhone 4S（真机）就是这种情况。该代码没有使用`NSTimer`（可能会更慢），但正在使用`CADisplayLink`并`UIImageView setFrame`执行动画。

iOS 上的 Core Animation 不是很适合开发动画类型的游戏吗？说如果它是一个游戏

1.  入侵者（[太空入侵者](http://en.wikipedia.org/wiki/Space_Invaders)）
2.  Breakout（作为教程中的游戏）
3.  打砖块
4.  愤怒的小鸟 / 割绳子 / 水果忍者

对于这些类型的游戏，Core Animation真的适合写上面的（2）吗？对于 (1)、(3) 和 (4)，无论是 Cocos2D 还是 OpenGL ES 都更适合做这项工作。并且 Cocos2D 和 OpenGL ES 的性能非常接近。真的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T00:49:47.413

Cocos2D 经常被关注是因为它易于编写常见的游戏逻辑，如碰撞检测和精灵动画、逐帧、缩放和其他在游戏开发中非常常见的过程，您可以将多个动画串在一起，然后组合，对它们进行排序，进行回调等等。这是引擎的一大好处。

然而，性能是另一回事。Cocos 提供批处理节点，将所有图形元素组合到一个 OpenGL 调用中，而不是在每一帧中分别“绘制”到屏幕上；这可以显着提高性能，尤其是对于大型图形。如果你有跳帧，我想知道 Cocos 中的批处理精灵是否会是缺失的环节。

Core Animation 给我留下了深刻的印象，并希望它能够在游戏中解决性能问题。我的理解是 CA 和 Cocos 一样，也是建立在 OpenGL ES 之上的，所以我希望两者都能取得好的结果。可能在 Cocos 中这样做更容易，因为它在内部是为游戏开发而设计和优化的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-15T21:56:56.513

如果您在使用 2D 应用程序时遇到性能问题，这可能是由于不了解如何从 CoreGraphics 获得最有效的结果，而不是切换到 OpenGL 可以解决的问题。2D 游戏可以与 CoreGraphics 完美配合，您只需要从正确的方法开始。首先，您不应该在每个 CADisplayLink 回调上重新渲染整个视图。相反，设置一个包含多个 CALayer 对象的 UIView。像这样设置图层：CALayer.contents = (id) cgImage，然后让系统在 x、y 或动画元素发生变化时进行渲染。您只需要定位元素并定义移动元素的动画。通过这种方法，系统将在后台将动画图像缓存在显卡上，并使用 GPU 操作重绘。

# linq - 在一组文档中选择 RavenDB 字段的最小值

> ID：10234571
> 
> 赞同：0
> 
> 时间：2012-04-19T18:35:05.310
> 
> 标签：linq, lucene, nosql, ravendb, min

如何在满足条件的所有文档中找到 RavenDB 文档属性的最小值。

例如，我想查找 ravendb 数据库中属于 NY 州的所有电影文档的最早发布日期。

我写了这样的东西..请纠正我..我需要帮助“??????” 在以下查询中...

```
 DateTime EarliestDate = session.Query<Movie>()                      
                         .Where(x => x.State == "NY")
                         .GroupBy(x => x.ReleaseDate)
                         .Select????Min(x => x.ReleaseDate)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:51:41.113

我可能是错的，但你不只是想要这个：

```
DateTime EarliestDate = session.Query<Movie>()                      
                         .Where(x => x.State == "NY")
                         .Min(x => x.ReleaseDate); 
```

**更新：** 试试这个

```
DateTime EarliestDate = session.Query<Movie>()                      
                             .Where(x => x.State == "NY")
                             .OrderBy(x => x.ReleaseDate)
                             .Take(1)
                             .Select(x => x.ReleaseDate)
                             .FirstOrDefault(); 
```

# java - encodeRedirectURL 改变了一些字符

> ID：10234573
> 
> 赞同：0
> 
> 时间：2012-04-19T18:35:10.800
> 
> 标签：java, url, ssl, struts2, interceptor

我在 Struts2 上有一个拦截器，我希望某些页面重定向到它们的 ssl 版本。

示例：[http://localhost/xhtml/path.do?ossesionid=value1](http://localhost/xhtml/path.do?ossesionid=value1)到[https://localhost/xhtml/path.do?ossesionid=value1](https://localhost/xhtml/path.do?ossesionid=value1)

为此，我创建了一个拦截器来执行此操作：

```
public String intercept(ActionInvocation invocation) throws Exception {

    // initialize request and response
    final ActionContext context = invocation.getInvocationContext();
    final HttpServletRequest request = (HttpServletRequest) context
            .get(StrutsStatics.HTTP_REQUEST);
    final HttpServletResponse response = (HttpServletResponse) context
            .get(StrutsStatics.HTTP_RESPONSE);

    // check scheme
    String scheme = request.getScheme().toLowerCase();

    // check method
    String method = request.getMethod().toUpperCase();

    // If the action class uses the SSLProtected marker annotation, then see
    // if we need to
    // redirect to the SSL protected version of this page
    if (invocation.getAction() instanceof SSLProtected) {

        if (HTTP_GET.equals(method) && SCHEME_HTTP.equals(scheme)) {

            // initialize https port
            String httpsPortParam = request.getSession().getServletContext().getInitParameter(HTTP_PORT_PARAM);
            int httpsPort = httpsPortParam == null ? HTTPS_PORT : Integer.parseInt(httpsPortParam);

            response.setCharacterEncoding("UTF-8");

            URI uri = new URI(SCHEME_HTTPS, null, request.getServerName(), httpsPort, response.encodeRedirectURL(request.getRequestURI()), request.getQueryString(), null);

            log.debug("Going to SSL mode, redirecting to " + uri.toString());

            response.sendRedirect(uri.toString());
            return null;
        }
    } 
```

我的问题是我期望这个

```
https://localhost/xhtml/path.do?ossesionid=value1 
```

并得到

```
https://localhost/xhtml/path.do;jsessionid=value1?osessionid=value1 
```

我完全迷路了！帮助任何人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:02:43.563

我强烈建议您使用更灵活的[S2-SSL 插件](http://code.google.com/p/struts2-ssl-plugin/wiki/HowToUse)，并提供更好的支持来处理从 SSL 到非 SSL 的切换，反之亦然。

关于 Jsessionid 的生成，JSESSIONID cookie 在创建会话时创建/发送。会话是在您的代码调用`request.getSession()`或`request.getSession(true)`第一次创建时创建的。如果您只想获取会话。您可以禁用创建 Jsessionid

有多种方法可以禁用此 id 的创建，请参阅此讨论线程。

我仍然不确定您在使用此会话 ID 时遇到的问题是什么，因为它在 Web 应用程序中很常见

*   [是否可以禁用 jsessionid-in-tomcat-servlet](https://stackoverflow.com/questions/962729/is-it-possible-to-disable-jsessionid-in-tomcat-servlet)

# python - import pymongo 适用于 Python 解释器，但不适用于脚本

> ID：10234575
> 
> 赞同：4
> 
> 时间：2012-04-19T18:35:14.297
> 
> 标签：python, mongodb, pymongo

我首先使用easy_install安装了pymongo，但没有成功，所以我尝试使用pip，但它仍然失败。

这在终端中很好：

```
Macintosh:etc me$ python
Python 2.7.2 (v2.7.2:8527427914a2, Jun 11 2011, 14:13:39) 
[GCC 4.0.1 (Apple Inc. build 5493)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import pymongo
>>> 
```

但是在我脚本的第 10 行

```
import pymongo 
```

引发以下错误：

> 文件“test.py”，第 10 行，>in <module> import pymongo ImportError: No module named pymongo

我正在使用 Apache 和 Python 的标准 Lion 版本。有没有其他人经历过这种情况？

谢谢

编辑：我还应该提到，在安装过程中它会引发以下错误

```
Downloading/unpacking pymongo
Downloading pymongo-2.1.1.tar.gz (199Kb): 199Kb downloaded
Running setup.py egg_info for package pymongo

Installing collected packages: pymongo
Running setup.py install for pymongo
building 'bson._cbson' extension
gcc-4.0 -fno-strict-aliasing -fno-common -dynamic -arch ppc -arch i386 -g -O2 -DNDEBUG -g -O3 -Ibson -I/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c bson/_cbsonmodule.c -o build/temp.macosx-10.3-fat-2.7/bson/_cbsonmodule.o
unable to execute gcc-4.0: No such file or directory
command 'gcc-4.0' failed with exit status 1

**************************************************************
WARNING: The bson._cbson extension module could not
be compiled. No C extensions are essential for PyMongo to run,
although they do result in significant speed improvements.

If you are seeing this message on Linux you probably need to
install GCC and/or the Python development package for your
version of Python. Python development package names for popular
Linux distributions include:

RHEL/CentOS: python-devel
Debian/Ubuntu: python-dev

Above is the ouput showing how the compilation failed.
**************************************************************

building 'pymongo._cmessage' extension
gcc-4.0 -fno-strict-aliasing -fno-common -dynamic -arch ppc -arch i386 -g -O2 -DNDEBUG -g -O3 -Ibson -I/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c pymongo/_cmessagemodule.c -o build/temp.macosx-10.3-fat-2.7/pymongo/_cmessagemodule.o
unable to execute gcc-4.0: No such file or directory
command 'gcc-4.0' failed with exit status 1

**************************************************************
WARNING: The pymongo._cmessage extension module could not
be compiled. No C extensions are essential for PyMongo to run,
although they do result in significant speed improvements.

If you are seeing this message on Linux you probably need to
install GCC and/or the Python development package for your
version of Python. Python development package names for popular
Linux distributions include:

RHEL/CentOS: python-devel
Debian/Ubuntu: python-dev

Above is the ouput showing how the compilation failed.
************************************************************** 
```

然后继续说

```
Successfully installed pymongo
Cleaning up...
Macintosh:etc me$ 
```

很奇怪。

我在脚本中的 sys.path 返回为：

['/Library/WebServer/Documents/', '/Library/Python/2.7/site-packages/tweepy-1.7.1-py2.7.egg', '/System/Library/Frameworks/Python.framework/Versions/ 2.7/lib/python27.zip', '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7', '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/ python2.7/plat-darwin', '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac', '/System/Library/Frameworks/Python.framework/Versions/ 2.7/lib/python2.7/plat-mac/lib-scriptpackages'，'/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python'，'/System/Library/Frameworks/Python.框架/版本/2.7/lib/python2.7/lib-tk'，'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old'，'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload'，'/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/PyObjC' , '/Library/Python/2.7/site-packages']

在口译员中：

['', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/SQLObject-1.2.1-py2.7.egg', '/Library/Frameworks/Python.framework /Versions/2.7/lib/python2.7/site-packages/FormEncode-1.2.4-py2.7.egg', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-包/setuptools-0.6c12dev_r88846-py2.7.egg', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pip-1.1-py2.7.egg', ' /Library/Python/2.7/site-packages/tweepy-1.7.1-py2.7.egg', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip', '/Library/Frameworks /Python.framework/Versions/2.7/lib/python2.7', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin', '/Library/Frameworks/Python.framework /版本/2.7/lib/python2。7/plat-mac', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages', '/Library/Frameworks/Python.framework/Versions/2.7/ lib/python2.7/lib-tk', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old', '/Library/Frameworks/Python.framework/Versions/2.7/ lib/python2.7/lib-dynload', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages', '/Library/Python/2.7/site-packages']7/lib-dynload'、'/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages'、'/Library/Python/2.7/site-packages']7/lib-dynload'、'/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages'、'/Library/Python/2.7/site-packages']

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:58:54.317

找到了！在导入 pymongo 模块之前需要附加路径

```
sys.path.append('/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages')
import pymongo 
```

理想情况下，希望找到一种方法将其永久附加到 pythonpath 中，但这目前有效！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T21:24:26.090

我不确定为什么最后一条消息说“成功安装了 pymongo”，但它显然失败了，因为您的系统上没有安装 gcc。您需要执行以下操作：

RHEL/Centos：sudo yum install gcc python-devel Debian/Ubuntu：sudo apt-get install gcc python-dev

然后再次尝试安装 pymongo。

# ruby-on-rails - 当我第一次登录时设计不创建会话

> ID：10234580
> 
> 赞同：1
> 
> 时间：2012-04-19T18:35:26.900
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, session, devise

我的站点上的设计和用户会话存在一些问题。

我有管理面板，我可以在其中手动创建新用户。在**Admin::UsersController#create**中，在**@user.save**之前我使用**@user.skip_confirmation！**方法。保存新用户后成功创建。

然后我尝试登录并收到错误：

```
NoMethodError in Devise::SessionsController#create 
undefined method `model_name' for Fixnum:Class 
```

这是跟踪日志[http://pastie.org/3818223](http://pastie.org/3818223)

仅当我第一次尝试使用最新用户的登录名登录时才会出现此错误，下次使用此登录名一切正常。

我使用 devise v 1.5.3 devise-russian 1.5.0 mongoid 2.4.1 ree 1.8.7 rails 3.1.1

请帮我。谢谢！:)

ps对不起我糟糕的英语

UPD：问题已解决。在我的应用程序控制器中，我覆盖**了 after_sign_in_path_for**方法，在这个控制器中，我在 Redis 中创建了关于 current_user 成功登录的记录。我在返回路径定义后调用了我的函数，我仍然不明白为什么它调用异常，但是当我把我的方法放在之前路径定义一切开始正常工作。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-12T21:10:04.250

问题解决了。在我的应用程序控制器中，我覆盖了 after_sign_in_path_for 方法，在这个控制器中，我在 Redis 中创建了关于 current_user 成功登录的记录。我在返回路径定义后调用了我的函数，我仍然不明白为什么它调用异常，但是当我把我的方法放在之前路径定义一切开始正常工作。谢谢。

# user-interface - 如何更好地将我的 SegmentedControl 融合到 UITableView 中？

> ID：10234586
> 
> 赞同：0
> 
> 时间：2012-04-19T18:36:00.800
> 
> 标签：user-interface, uitableview, uisegmentedcontrol

正如您在屏幕截图中看到的那样，分段控件的放置方式相当难看。

我需要它在那个地方，意思是在部分标题下方和该部分的第二个单元格之前。我怎样才能做得更好？

![在此处输入图像描述](../Images/755348c26166858a82abb20660f078cc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T20:43:12.240

我可以想到两个可以改善外观的建议。第一个是增加表格单元格的高度（只是特定的表格单元格，而不是表格中的所有单元格），以便分段控件顶部和底部的空白边距等于您当前拥有的边距在控件的左侧和右侧。

另一种解决方案是将此设置的值的选择移动到您向下钻取的单独的 tableView 控制器中。因此该单元格将显示当前值，但点击该单元格会将用户带到一个新视图，用户可以在其中选择更改值。

这是 Instapaper 应用程序设置页面中的一个示例，我认为它看起来很干净。

![在此处输入图像描述](../Images/e541cbed7496f6acdab3b8d65940e4b4.png) ![在此处输入图像描述](../Images/cffa9c226c992ab822176189a5106aa8.png)

# python - Python cmd模块 - 从行解析值

> ID：10234595
> 
> 赞同：3
> 
> 时间：2012-04-19T18:36:47.863
> 
> 标签：python, cmd, command-line-interface

我正在使用该`cmd`模块编写一个快速 python 脚本，该模块将允许用户输入文本命令，后跟基本 url 查询字符串格式的参数。提示将得到类似的回答

`commandname foo=bar&baz=brack`

使用 cmd，我似乎找不到要覆盖哪个方法来影响将参数`line`传递给所有方法的`do_*`方式。我想`urlparse.parse_qs`在这些值上运行，并且在每个`do_*`方法中逐行调用它似乎很笨拙。

该`precmd`方法在拆分和解释之前获取整行，`commandname`因此这不适用于我的目的。我也不太熟悉如何在这样的类中放置装饰器，并且无法在不破坏范围的情况下将其拉下来。

基本上，[cmd](http://docs.python.org/library/cmd.html)的 python 文档说如下

> 反复发出提示，接受输入，解析接收到的输入的初始前缀，然后分派给操作方法，将行的其余部分作为参数传递给它们。

我想创建一个方法，对“行的剩余部分”进行额外的处理，并将生成的字典作为`line`参数传递给成员函数，而不是在每个函数中解释它们。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:42:32.067

您可能会覆盖该`onecmd()`方法，如下面的快速示例所示。该`onecmd()`方法基本上是原始方法的副本，但在将参数传递给函数之前`cmd.py`添加了调用。`urlparse.parse_qs()`

```
import cmd
import urlparse

class myCmd(cmd.Cmd):
    def onecmd(self, line):
        """Mostly ripped from Python's cmd.py"""
        cmd, arg, line = self.parseline(line)
        arg = urlparse.parse_qs(arg) # <- added line
        if not line:
            return self.emptyline()
        if cmd is None:
            return self.default(line)
        self.lastcmd = line
        if cmd == '':
            return self.default(line)
        else:
            try:
                func = getattr(self, 'do_' + cmd)
            except AttributeError:
                return self.default(line)
            return func(arg)

    def do_foo(self, arg)
        print arg

my_cmd = myCmd()
my_cmd.cmdloop() 
```

样本输出：

```
(Cmd) foo
{}
(Cmd) foo a b c
{}
(Cmd) foo a=b&c=d
{'a': ['b'], 'c': ['d']} 
```

这是你想要达到的目标吗？

这是另一个潜在的解决方案，它使用类装饰器来修改 `cmd.Cmd`子类并基本上将装饰器函数应用于`do_*` 该类的所有方法：

```
import cmd
import urlparse
import types

# function decorator to add parse_qs to individual functions
def parse_qs_f(f):
    def f2(self, arg):
        return f(self, urlparse.parse_qs(arg))
    return f2

# class decorator to iterate over all attributes of a class and apply
# the parse_qs_f decorator to all do_* methods
def parse_qs(cls):
    for attr_name in dir(cls):
        attr = getattr(cls, attr_name)
        if attr_name.startswith('do_') and type(attr) == types.MethodType:
            setattr(cls, attr_name, parse_qs_f(attr))
    return cls

@parse_qs
class myCmd(cmd.Cmd):
    def do_foo(self, args):
        print args

my_cmd = myCmd()
my_cmd.cmdloop() 
```

我很快将它拼凑在一起，它似乎按预期工作，但是，我愿意接受有关任何陷阱或如何改进此解决方案的建议。

# java - 在同步代码段（java）中使用wait（）而不使用notify（）

> ID：10234598
> 
> 赞同：2
> 
> 时间：2012-04-19T18:36:49.603
> 
> 标签：java, multithreading, synchronization, wait, synchronized

我想知道是否可以在不使用 notify() 的情况下在同步的代码上使用 wait()，如下所示：

```
wait_on(B):
    synchronized(B.monitor) {
    B.count--
        while (B.count > 0) { /* wait */ }
    } 
```

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T18:38:58.727

您需要 notify 或 notifyAll 将线程从等待状态中唤醒。在您的示例中，代码将进入等待并留在那里（除非被中断）。

了解wait、yield和sleep之间的区别。需要在同步块中调用等待，一旦进入等待，锁就会被释放，并且线程保持在该状态直到调用通知。Yield 将线程返回到就绪池，并让调度程序决定何时再次运行它。睡眠意味着线程休眠一段固定的时间（然后从那里进入就绪池）。

确保在要同步的同一对象上调用 wait（这里是 B.monitor）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:40:22.847

不！唯一的选择是等待超时，这肯定对您没有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:40:55.047

如果你把 the`/* wait */`改成对 的调用`wait()`，而没有人会调用`notify()`or `notifyAll()`，那么这个线程将永远不会醒来......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T00:06:07.083

如果这是您想要的障碍，您将需要通知所有其他线程：

```
wait_on(B) {
    synchronized(B.monitor) {
        B.count--
        while (B.count > 0) {
            B.monitor.wait()
        }
        B.monitor.notifyAll();
    }
} 
```

问候，

皮埃尔-吕克

# python - 哪个 itertools 生成器不会跳过任何组合？

> ID：10234599
> 
> 赞同：2
> 
> 时间：2012-04-19T18:36:53.490
> 
> 标签：python, itertools

当我运行此代码时，我没有得到 3 个字符的所有可能组合：

```
def comb(iterable, r):
    pool = tuple(iterable)
    n = len(pool)
    for indices in permutations(range(n), r):
        if sorted(indices) == list(indices):
            yield tuple(pool[i] for i in indices)
def start():
    for x in comb("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12234567890!@#$%^&*?,()-=+[]/;",3):
        print x 
```

相反，它跳过了一些。当我重复字符 3 次时，我得到了我需要的所有组合，但我得到了多次。这需要三倍的时间，这不是我想要的。我将计算数百万个组合，因此我需要知道重复字符的替代方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T18:45:03.633

你正在寻找`itertools.product(characters, repeat = 3)`.

请参阅[`itertools.product`](http://docs.python.org/library/itertools.html#itertools.product)文档。

```
>>> ' '.join(''.join(x) for x in itertools.product('abcd', repeat = 2))
aa ab ac ad ba bb bc bd ca cb cc cd da db dc dd 
```

# android - android中的半透明webview背景

> ID：10234604
> 
> 赞同：0
> 
> 时间：2012-04-19T18:37:17.663
> 
> 标签：android, json, webview

**编辑：我当前的解决方案。将 json 包装在 div 标签中并将其设置为透明。**

我正在从 json 对象远程填充 webview。

```
{
"message": "<p style=\"color:#EEEEEE;background-color:transparent;font-family:'Arial Narrow','Nimbus Sans L',sans-serif;\"><\/p><p style=\"color:#EEEEEE;background-color:transparent;font-family:'Arial Narrow','Nimbus Sans L',sans-serif;\">The mission of the Canton Police Department is to protect the lives and properties of the citizens of Canton, enforce all city, state, and federal law<\/p>",
"nationalad": ""
} 
```

我可以让 webview 背景透明。但不是半透明的。当我尝试这个时：

```
webView1.setBackgroundColor(Color.argb(128, 00, 00, 000)); 
```

我得到一个黑色背景，右边有一个小的垂直透明条。让它一直透明：

```
webView1.setBackgroundColor(0x00000000); 
```

这是我引入 JSON 的方式：

```
 try{
                JSONObject json = new JSONObject(result);
                JSONArray nameArray = json.names();
                JSONArray valArray = json.toJSONArray(nameArray);
                for (int i = 0; i < valArray.length(); i++)
                {      
                    WebView webView1 = (WebView) findViewById(R.id.webView1);
                   // webView1.setBackgroundColor(0x00000000);

                    //webView1.loadDataWithBaseURL(null, valArray.getString(0), "text/html", "utf-8", null);   
                    webView1.setBackgroundColor(Color.argb(128, 00, 00, 00));
                } 
```

编辑：XML

```
 <!-- Included header.xml here -->

    <ViewStub
        android:id="@+id/vsHeader"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:inflatedId="@+id/header"
        android:layout="@layout/header" />

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@drawable/cpd"
        android:gravity="center|center_horizontal|center_vertical"
        android:orientation="vertical"
        android:paddingBottom="50dp" >

        <WebView
            android:id="@+id/webView1"
            android:layout_width="250dp"
            android:layout_height="300dp"
            />

    </LinearLayout>

</LinearLayout> 
```

![在此处输入图像描述](../Images/c78bc7d5c71d9dc13d221626bba26fb5.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T08:28:34.257

这对我有用：

在您的**网页**正文上：

```
background-color:transparent 
```

在您的**java**活动中：

```
webView.loadUrl("yourwebpage");
webView.setBackgroundColor(0x00000000); 
webView.setLayerType(WebView.LAYER_TYPE_SOFTWARE, null); 
```

并且您**必须**为您的活动设置 hardwareAccelerated **false ：**

```
android:hardwareAccelerated="false" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T18:47:37.223

将您的 setBackgroundColor 调用更改为以下内容：

```
 webView1.setBackgroundColor(0xAA000000); 
```

这应该给你一个半透明的黑色。前两个条目是 alpha 值。值越低，颜色越透明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-01T07:40:24.053

试试这个：

```
webView.setAlpha(0);  /*or for semi transparent : webView.setAlpha(0.5f);*/ 
```

# wpf - 在 WPF 中特定列的单元格内呈现自定义 XAML

> ID：10234605
> 
> 赞同：0
> 
> 时间：2012-04-19T18:37:34.957
> 
> 标签：wpf, datagrid

我有一个 DataGrid，我想让我的第一列的单元格都呈现一些自定义 XAML。

目前我只有网格：

```
 <DataGrid CanUserSortColumns="False" SelectionUnit="FullRow" HeadersVisibility="Column" ItemsSource="{Binding Test}" AutoGenerateColumns="False">
            <DataGrid.Columns>
                <DataGridTextColumn Binding="{Binding Path=Foo}" Header="Foo"></DataGridTextColumn>
                <DataGridTextColumn Binding="{Binding Path=Bar}" Header="Bar"></DataGridTextColumn>
            </DataGrid.Columns>
        </DataGrid> 
```

对于初学者，我希望能够将一些特定的 WPF 控件/XAML 添加到第一列的单元格中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:51:00.167

您只需要使用 a[`DataGridTemplateColumn`](http://msdn.microsoft.com/fr-fr/library/system.windows.controls.datagridtemplatecolumn%28v=vs.95%29.aspx)和 a `CellTemplate`：

```
<DataGridTemplateColumn Header="Foo">
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Path=Foo}" />
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn> 
```

# gdb - 在 GDB 中设置 Watch 对我不起作用

> ID：10234610
> 
> 赞同：1
> 
> 时间：2012-04-19T18:38:03.933
> 
> 标签：gdb, watch

我`watch`在 gdb 中使用时遇到问题。我正在尝试监视`m`我的代码中的变量。但由于某种原因，我收到以下消息 `no symbol m in current context`。我在第 7 行保留了一个断点，以便知道 m 的范围。

```
 steps performed by me :-
    1>g++ -g a.cpp
    2>gdb a.out
    3>(gdb)break 7
    4>(gdb)watch m 
```

以下是我的程序：-

```
 # include<iostream>
    # include<stdio.h>
    using namespace std;

    int main()
    {

      int m=10;
      char *abc = (char *)"ritesh";
      cout << abc << endl ;
      m=11; 
      m=13;
      abc=NULL;
      cout << *abc <<endl;

     return 0;
    } 
```

我也看到了[如何使用“watch” GDB？](https://stackoverflow.com/questions/835757/how-can-i-use-watch-gdb)但这对我没有多大帮助。有人可以解释我面临的这个问题吗？以下是与我的 GNU 相关的信息

```
 ritesh@ubuntu:~$ gdb a.out 
    GNU gdb (Ubuntu/Linaro 7.3-0ubuntu2) 7.3-2011.08
    Copyright (C) 2011 Free Software Foundation, Inc.
    License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
    This is free software: you are free to change and redistribute it.
    There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
    and "show warranty" for details.
    This GDB was configured as "i686-linux-gnu".
    For bug reporting instructions, please see:
    <http://bugs.launchpad.net/gdb-linaro/>...
    Reading symbols from /home/ritesh/a.out...done. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:50:54.380

当您将程序加载到调试器中时，它还没有运行。但是，您尝试观察一个符号，它将开始“存在”在一个函数中——`main()`函数——并且当你从函数返回时将“消失”。

例如，在这段代码中

```
void func() {
  int b = 1;
  ++b;
  cout << b << endl;
}

int main() {
  int a = 1;
  func();
  cout << a << endl;
} 
```

您不能`a`在开始执行程序之前设置值的监视，并且`b`在执行进入之前监视 的值`func()`。

# javascript - 如何使用 javascript 获取 jsf h:outputText 值？

> ID：10234613
> 
> 赞同：0
> 
> 时间：2012-04-19T18:38:09.287
> 
> 标签：javascript, jsf-2, backing-beans

我有一个按钮具有可以设置 myBackingBean.myString 的操作，并且 onclick 事件调用 js 方法来提醒该值。我只想通过使用 javascript 从支持 bean 获取 myString 的值。

我有一个隐藏的输出，它具有来自支持 bean 的价值：

```
h:outputText id="myOutput" rendered="false" value="#{myBackingBean.myString}" 
```

然后我需要在由按钮触发的 javascript fxn 中提醒这个值：

```
function myFunction() {

var outPut= document.getElementById("myForm:myOutput").value;

...

} 
```

但我得到了`Object required`错误。我怎样才能解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:53:02.903

确保 h:outputText 已呈现（rendered="false" 不能将其添加到 DOM。如果它不呈现，则无法访问它。如果您需要隐藏它，请改用 h:inputHidden） .

然后确保它将 HTML 标记呈现为或充当具有 id 属性为“myForm:myOutput”的容器。

此外，.value javascript 访问器用于输入标签，因此请改用 inerHTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T05:13:28.663

您不必总是有一个隐藏字段来访问 Bean 属性。您可以按如下方式进行。

```
<h:commandButton value="Show" onclick="alert('#{myBackingBean.myString}');"/> 
```

但是，如果您想在单击按钮时更改“ **myString** ”的值，然后又想显示新值，则应使用 a`<a4j:commandButton/>`及其**onComplete**属性，如下所示。

```
<a4j:commandButton value="Change" action="#{myBackingBean.changeString()}" oncomplete="alert('#{myBackingBean.myString}');" /> 
```

# apache - 一种能够将多个 url 重写为其 https (mod_rewrite) 的重写规则

> ID：10234615
> 
> 赞同：0
> 
> 时间：2012-04-19T18:38:15.530
> 
> 标签：apache, mod-rewrite

我正在尝试提出一个单一的重写规则来检查 url 字符串，如果它包含一些单词，则将其重写为它的 https 版本。

示例：[所有这些情况都需要一个重写规则]

```
$http://www.example.com/account/login  to  https://www.example.com/account/login
$http://www.example.com/checkout  to  https://www.example.com/checkout
$http://www/example.com/info/contact  to  https://www.example.com/info/contact 
```

这不起作用，我不知道为什么

```
$RewriteCond %{HTTPS} off
$RewriteCond %{REQUEST_URL} checkout|account
$RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:44:36.893

就像是：

```
RewriteCond %{HTTPS} off
RewriteRule ^(account/.+|checkout|info/contact)$ https://www.example.com/$1 [R=301,L] 
```

# api - API 设计：将内部功能与外部功能分开还是结合？

> ID：10234617
> 
> 赞同：6
> 
> 时间：2012-04-19T18:38:23.637
> 
> 标签：api, web-applications, architecture

举个简单的例子，假设您在站点中创建留言簿，并计划通过 API 为创建和读取函数提供外部访问权限。API 中不包含更新和删除，因为它只能在内部使用。

什么是更好的做法？

*   通过 API 使整个 CRUD 功能可用，并且只限制对更新和删除的公共访问。因此，您自己也将使用 API 进行应用程序的所有内部工作。

*   为所有内部工作创建没有 API 的内部 CRUD 函数，然后为创建和只读创建单独的 API。基本上，这为您提供了两种使用 Create 和 Read 的方法 - 一种使用 API，一种没有。

*   为内部工作创建没有 API 的内部更新和删除函数，然后为创建和只读创建 API。如果您需要使用 Create 和 Read 函数进行内部工作，那么您必须使用 API。

我希望这很清楚，通常最好的做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T01:08:23.117

我喜欢第一个选项。它有一个清晰的例子，即关注点分离和在正确的上下文中使用正确的工具。

通过对 API 使用 CRUD 方法，您可以获得一致性和完整性。它导致设计更加连贯，代码重复更少，并且更容易演变。安全方面可以在支持 API 的应用程序内部或外部实现。对于外部选项，您可以使用 3-d 方软件或硬件解决方案，例如防火墙。

# objective-c - iAds：为什么 CCGLView *eaglView = [[CCDirector sharedDirector] openGLView] 不起作用？

> ID：10234622
> 
> 赞同：2
> 
> 时间：2012-04-19T18:38:33.013
> 
> 标签：objective-c, ios, cocos2d-iphone, iad

我一直在通过一个很好的 Cocos2d 教程来实现 iAd，并且即将实现它（我从控制台收到 iAd 消息）......

我不断回到这个警告：

```
CCGLView *eaglView = [[CCDirector sharedDirector] openGLView]; 
```

*“找不到实例方法'-openGLView'...”*

我认为这与从调用 GLView 到 CCGLView (cocos2d) 的切换有关...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T05:11:44.777

通过使用 type `CCGLView`，我猜你使用的是 cocos2d-iphone 2.x，而 1.x 没有`CCGLView`但有`EAGLView`.

在 1.x 中我们通常访问属性`openGLView`来获取 OpenGL 视图对象：

```
EAGLView *eaglView = [[CCDirector sharedDirector] openGLView]; 
```

在 2.x 中，`CCDirector`类没有这样的属性。相反，`CCDirector`现在是`UIViewController`iOS（和`NSObject`Mac OS X）上的子类。因此，如果您想在 iOS 上获取 OpenGL 视图对象，只需执行以下操作：

```
CCGLView *ccglView = (CCGLView *)[[CCDirector sharedDirector] view]; 
```

因为`view`是 的属性`UIViewController`。

# .net - 终止 .net 程序

> ID：10234630
> 
> 赞同：0
> 
> 时间：2012-04-19T18:39:06.930
> 
> 标签：.net, vb.net

我有一个我在 vb.net 中编写的应用程序。当应用程序启动时，它会在线连接到 mysql 数据库以获取一些数据，一旦完成，它就会继续。

问题是有时它会卡在 mysql 中，我的意思是在请求没有任何反应之后，这会导致我的程序锁定。这可能是因为互联网问题或服务器。

有没有办法程序可以确定 x 秒已经过去并且它没有得到任何数据，所以自行终止它。我尝试使用计时器来执行此操作，但是当程序请求数据时，它卡住了，我的意思是它锁定了，因此计时器也锁定了，只有在任务完成后一切恢复。

我希望当程序即将启动请求时，我可以启动一个计时器并确定 x 秒已经过去，所以现在终止应用程序。

请让我知道我该怎么做？

谢谢，

干杯，伟大的家伙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:46:36.590

是的，您可以如您所说，使用计时器并在经过一定时间后强制应用退出。但是，在 MySqlConnection 上设置超时会更有意义。

`MySqlConnection.ConnectionTimeout`在你的情况下你会这样做。

如果由于某种原因你必须杀死它。您可以使用`Process.GetCurrentProcess().Kill()`您的计时器。

# javascript - 从Firefox扩展中加载的脚本传递对象

> ID：10234633
> 
> 赞同：0
> 
> 时间：2012-04-19T18:39:28.230
> 
> 标签：javascript, firefox-addon, xul

我正在开发一个 Firefox 扩展程序，用于从当前选项卡中的网页检索数据。当用户单击覆盖工具栏按钮时，我正在将脚本加载到网页中，该按钮进行一些处理并从网页获取信息。我想在弹出窗口中显示该信息。

我正在使用以下 api 加载脚本：

```
var loader = Components.classes[ "@mozilla.org/moz/jssubscript-loader;1" ].getService( Components.interfaces.mozIJSSubScriptLoader );
loader.loadSubScript("chrome://dynamonote/content/contentscript.js"); 
```

我需要发送在 contentscript.js 中创建的对象并将其显示在 popup.html 中，当用户单击工具栏图标时会显示该对象。

我在执行代码时收到 gBrowser is not defined 错误。我正在使用的代码的详细信息如下：

在叠加层的 onCommand 中，我调用了以下函数：

```
var Popup = {
    showPopup: function() {
        window.open("chrome://dynamonote/content/popup.html", "dynamonote", "chrome");
    }
}; 
```

这将显示一个弹出窗口。在页面加载时调用的 popup.html 的 init 函数中，我正在执行以下代码：

```
 function loadContentScript() {
            Components.utils.reportError("loadContentScript() called");
            gBrowser.selectedBrowser.messageManager.loadFrameScript("chrome://dynamonote/content/contentscript.js", true);
            gBrowser.selectedBrowser.messageManager.addMessageListener("foomessage", onMessage);
            Components.utils.reportError("loadContentScript() executed");
        } 
```

以下代码在 contentscript.js 文件中执行：

```
(function() {
    Components.utils.reportError("-- content script -- ");
    var doc = content.document;

    //Do something here

    var data = {
        "time": new Date().toLocaleString()
    };
    Components.utils.reportError("-- content script -- found something");
        sendSyncMessage("foomessage", onMessage(data));
})(); 
```

这个你能帮我吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:56:32.797

如果您想要经典 Firefox 扩展中的内容脚本，那么`mozIJSSubScriptLoader`工具是错误的 - “内容脚本”将保留高级权限并可能导致安全问题。您可以改用[消息管理器](https://developer.mozilla.org/en/The_message_manager)（忽略有关进程分离的讨论，它与桌面 Firefox 无关）。因此，要将脚本加载到当前选定的选项卡中，您将使用以下代码：

```
gBrowser.selectedBrowser.messageManager
        .loadFrameScript("chrome://dynamonote/content/contentscript.js", true);
gBrowser.selectedBrowser.messageManager.addMessageListener("foomessage", onMessage);

function onMessage(obj)
{
  alert("Received object from content script: " + obj.toSource());
} 
```

请注意，当不再需要该消息侦听器时，您应该删除它。并且要发回消息，内容脚本将使用如下代码：

```
sendAsyncMessage("foomessage", obj); 
```

# jquery - 子域 REST 调用在 FF 中而不在 IE 中工作

> ID：10234637
> 
> 赞同：0
> 
> 时间：2012-04-19T18:39:37.710
> 
> 标签：jquery, html, cross-browser, cross-domain, getjson

我有一个使用引导程序设计的 HTML 页面，它调用 REST 服务来更新数据库的信息。这是javascript：

```
$.support.cors = true;

$.ajaxSetup ({
  // Disable caching of AJAX responses
  cache: false,
  async: false
});

$("#submitemail").click(function() {

$.getJSON('http://sub.mydomain.com/getinfo/'+ 
                 encodeURIComponent($('#emailaddress').val()), 
                 function(resp) {
                    //do something here
                  }); 
}); 
```

在FF工作。

使用 IE - 如果我从桌面打开 html 文件并运行...它将调用 sub.mydomain.com 并获取信息。但是，如果我从 www.mydomain.com 打开站点并调用该方法 - 什么都没有。用 Fiddler 检查 - IE 甚至不发送请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:47:18.460

您不能像这样从主域调用子域。这是一个“跨域”请求，请求会中断。`www.mydomain.com`即使在 FF 上，它也不应该从 - 开始工作。我不知道它是怎么做的。

无论如何，您的服务器是如何构建的？是`sub.mydomain.com`mydomain.com/里面的文件夹吗？比如：

顶级域名：

`http_public/mydomain.com/`

子域

`http_public/mydomain.com/sub_domains/sub.mydomain.com/`

?

如果文件结构是这样的，那么你可以允许访问目录并使用

`url: '/sub_domains/sub.mydomain.com/getinfo'+whatever`

否则，您需要使用`JSONP`

[JSONP 或“带填充的 JSON”是对基本 JSON 数据格式的补充。它提供了一种从不同域中的服务器请求数据的方法，由于同源策略，典型的 Web 浏览器禁止这样做。](http://en.wikipedia.org/wiki/JSONP)

# windows-services - GlassfishSvc.jar 是否有有效的下载链接？

> ID：10234639
> 
> 赞同：3
> 
> 时间：2012-04-19T18:39:46.277
> 
> 标签：windows-services, glassfish

我想使用这个博客中的方法，[http:](http://www.ryandelaplante.com/2009/08/in-past-i-have-chosen-to-use-commercial.html) //www.ryandelaplante.com/2009/08/in-past-i-have-chosen-to-use-commercial.html，但是 GlassfishSvc.jar 的下载链接坏了。具有此方法的所有其他站点似乎都使用相同的下载链接。那么有人有这个罐子可以寄给我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:43:14.730

从谷歌代码下载它：

[http://acacia-business-ace.googlecode.com/svn-history/r1573/trunk/docs/Installation/service/GlassfishSvc.jar](http://acacia-business-ace.googlecode.com/svn-history/r1573/trunk/docs/Installation/service/GlassfishSvc.jar)

# c# - 获取最后一个字符，而字符！=“_”

> ID：10234649
> 
> 赞同：3
> 
> 时间：2012-04-19T18:40:23.887
> 
> 标签：c#, asp.net, string

我有类似的字符串

```
string test = "http://example.com/upload/user/80_747.jpg"
string test2 = "http://example.com/upload/user/80_4747.jpg" 
```

在这两种情况下，我都需要“747”或“4747”。是否有任何自动或预制功能，或者我需要完全手动完成。

ASP.NET C# 4.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:42:44.640

正则表达式应该可以正常工作。类似的东西`@"_(\d+)\."`。

```
Regex.Match ("http://example.com/upload/user/80_747.jpg",   @"_(\d+)\.")
    .Groups[1]
    .Captures[0]
    .Value 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T18:43:39.833

```
int startIndex = test.LastIndexOf('_');
int endIndex = test.LastIndexOf('.');
return test.Substring(startIndex, endIndex - startIndex); 
```

由于您使用的是 .net4，并且如果您的字符串格式如现在所述，您可以使用 linq 执行此操作：

```
return new string(test.SkipWhile(x=>x!='_').Skip(1).TakeWhile(x=>x!='.').ToArray()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T18:42:19.540

您可以使用 _ 字符拆分字符串并获取结果数组的最后一个字符串，然后再次使用 . 字符并取结果数组的第一个字符串。

在 JS 中

```
test.split('_')[1].split('.')[0]; 
```

在 CS 中使用 String 类的 SubString 和 IndexOf 方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T18:44:53.407

您可以使用`System.IO.Path`获取[不带扩展名的文件名](http://msdn.microsoft.com/en-us/library/system.io.path.getfilenamewithoutextension.aspx). 您将需要手动从该文件名中解析出您想要的片段。使用框架在整个路径的直接正则表达式上做这么多，如果其中一个文件夹名称中有一个“_”，那么出错的可能性会稍微小一些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T18:42:54.420

用于`test.LastIndexOf('_')`查找 _ 字符的最后一次出现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T18:47:22.157

```
string val = Path.GetFileNameWithoutExtension(test.Substring(test.LastIndexOf('_') + 1)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-19T19:09:58.617

```
test
    .ToCharArray()
    .Reverse()
    .SkipWhile(c =>
    {
        int i;
        return !int.TryParse(c.ToString(), out i);
    })
    .TakeWhile(c => c != '_'); 
```

我认为这对您的要求是万无一失的。

# c# - 用户控件的公共字符串不显示任何内容？

> ID：10234652
> 
> 赞同：0
> 
> 时间：2012-04-19T18:40:40.517
> 
> 标签：c#, wpf, linq, xaml, user-controls

在我的用户控件`ViewUser`中，组框标题和文本块不显示用户 ID？

主窗口：

```
private void btnGeneral_Click(object sender, RoutedEventArgs e)
{

    ViewUser myusercontrol = new ViewUser();
    String id = (String)((Button)sender).Tag;
    myusercontrol.UserID = id;
    PanelMainContent.Children.Add(myusercontrol);

}
 private void button1_Click(object sender, RoutedEventArgs e)
 {
         string uriUsers = "http://localhost:8000/Service/User";
            XDocument xDoc = XDocument.Load(uriUsers);
            var sortedXdoc = xDoc.Descendants("User")
                           .OrderByDescending(x => Convert.ToDateTime(x.Element("TimeAdded").Value));
            foreach (var node in xDoc.Descendants("User"))
            {

                Button btnFindStudent = new Button();
                btnUser.Click += this.btnGeneral_Click;
                btnUser.Tag = String.Format(node.Element("UserID").Value);
                //also tryed btnUser.Tag = node.Element("UserID").Value; 
```

用户控制：

```
public partial class ViewUser : UserControl
{
    public ViewUser()
    {
        InitializeComponent();
    }
    private string _user;

    public string UserID
    {
        get { return _userID; }
        set { _userID = value; }
    }
    protected override void OnInitialized(EventArgs e)
    {
        base.OnInitialized(e);
        groupBox1.Header = UserID;
        textBlock1.Text = UserID;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:30:11.553

**Kirsty，您应该在每次**UserID 属性更改时更新 GroupBox 和 TextBlock ：

```
public string UserID 
{ 
    get { return _userID; } 
    set
    {
        _userID = value;
        groupBox1.Header = _userID; 
        textBlock1.Text = _userID; 
    } 
} 
```

目前，您在 OnInitialized 中仅更新一次 GroupBox 和 TextBlock。但是 OnInitialized 仅在 ViewUser 控件初始化后调用一次，并且不再调用。

这就是 n8wrl 回答第二部分的意思。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-19T18:44:49.647

在设置 UserID 之前，您正在设置 groupBox1.Header 和 textBlock1.Text 。两种选择：

覆盖 OnPreRender 并将它们设置在那里。

或者

直接从您的属性中设置它们：

```
public string UserID
{
    get { return textBlock1.Text; }
    set
    {
        textBlock1.Text = value;
        groupBox1.Header = value;
    }
} 
```

# node.js - 如何处理在 Node 中发送多个 http 请求？

> ID：10234655
> 
> 赞同：0
> 
> 时间：2012-04-19T18:40:48.247
> 
> 标签：node.js, concurrency, httpwebrequest

我有发送 http 请求的标准代码。使用 http.globalAgent。

我将我的 maxSockets 设置为 2500。

然后当我一次发送多个请求时，我收到此错误：

```
['{'code':'ECONNRESET'}'] 
```

但是，如果我在每个请求之间有一点超时后发出请求，那么它就可以工作。

所以，问题是：

1) ECONNRESET 的真正含义是什么？为什么会发生这个错误？

2）如何立即发送多个请求而不会出现该错误？

* * *

发送多个请求的原始代码：

```
// I'm using Seq()
Seq().
 seq(function() {
  this(null, ['p1','p2','p3','p4','p5']);
})
.flatten(false)
.parEach(fuctnion(data) {
  // send out request
  sendRemoteRequest(data);  // a function that uses http.request
})
.seq(function(data) {
  console.log("done");
}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T19:35:26.893

`ECONNRESET`基本上意味着远程服务器已经关闭了连接。我假设它只允许一定数量的并发连接，如果达到该限制，它只会断开连接，从而`ECONNRESET`在您的程序中产生一个。

# tomcat - Apache2 Ubuntu 和 Tomcat Web 应用程序配置

> ID：10234666
> 
> 赞同：3
> 
> 时间：2012-04-19T18:41:14.107
> 
> 标签：tomcat, apache2

我正在使用 Apache2 (Ubuntu) 和 Tomcat 来提供 Web 应用程序。目前，我的 /etc/apache2/ports.conf 只有默认端口监听（*Listen 80*）。如果我使用 url [http://hostname:80/webAppName](http://hostname:80/webAppName)我的浏览器会一直显示“等待主机名”。我相信 Tomcat 的默认端口是 8080，我需要将 8080 添加到 ports.conf 还是更改 Tomcat 的默认端口。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:45:48.960

我没有使用 Tomcat 的经验，但谷歌搜索我发现了这个：

安装 mod-jk；apache 2 连接器。这是连接apache和tomcat的包。

```
apt-get install libapache2-mod-jk 
```

安装后，您需要对其进行配置。将这些行添加到 /etc/apache2/apache2.conf

```
# Worker properties file
JkWorkersFile /etc/apache2/workers.properties

# Logging
JkLogFile /var/log/apache2/mod_jk.log

# Set the jk log level [debug/error/info]
JkLogLevel info

# Log format
JkLogStampFormat "[%a %b %d %H:%M:%S %Y] " 
```

您需要修改workers.properties 文件，以便它知道在哪里可以找到您的tomcat 安装。您需要将您的工作人员指向您的 tomcat 和 java 目录，并指定它正在运行的端口（在本例中为 8080）。

```
workers.tomcat_home=/usr/local/tomcat/tomcat
workers.java_home=/usr/lib/jvm/java-6-sun
ps=/
worker.list=worker1

worker.default.port=8080
worker.default.host=localhost
worker.default.type=ajp13
worker.default.lbfactor=1 
```

现在，回到 /etc/apache2/apache2.conf，并添加您希望共享的 tomcat 上下文。不幸的是（据我所知）你不能翻译成不同的上下文（即你在 apache 中的 TestContext 必须翻译成 tomcat 中的 TestContext。如果你想翻译它，你需要使用 apaches（真棒）模块 mod_rewrite。）

```
# Send servlet for context / TestContext to worker named worker1

JkMount /TestContext worker1
JkMount /TestContext/* worker1

JkMount /AnotherContext worker1
JkMount /AnotherContext/* worker1 
```

重启 apache（/etc/init.d/apache2 restart）。现在，任何发送到 apache（即[http://myserver/TestContext](http://myserver/TestContext)）的请求都将被转发到 tomcat。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T20:16:09.260

您不匹配 Apache HTTPD（一个网络服务器，主要被称为 apache 或 apache2）和 Apache Tomcat（一个 java servlet 引擎）！

要访问 tomcat 上的应用程序，您必须访问在 tomcat 中配置的端口（对于 http，通常为 8080）：[http://hostname:8080/application](http://hostname:8080/application)

如果你想通过 httpd 访问 tomcat 应用程序，那么你必须配置 httpd 来代理你的请求。如何做到这一点可以在我对[这个问题](https://stackoverflow.com/questions/10200204/apache-subdomain-redirect-into-tomcat/10205871#10205871)的回答中看到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:18:38.777

Web 应用程序是 Web 或应用程序服务器的动态扩展，它为营销人员提供了一种了解访问其网站的人的方式。 [Web应用程序](http://www.universalutsi.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-12T20:56:31.360

我认为这是更改 apache tomcat 端口号的合适解决方案。我使用了本教程[http://beginlinux.com/server/ubuntu/chang-the-port-on-tomcat](http://beginlinux.com/server/ubuntu/changing-the-port-on-tomcat)，它对我有用。

# php - 带表前缀的 PDO

> ID：10234667
> 
> 赞同：2
> 
> 时间：2012-04-19T18:41:21.553
> 
> 标签：php, mysql, pdo

我有以下模型类，我的所有模型都对其进行了扩展。

```
class Model {
    [...]
    protected static $_query; // Query preparated

    public function prepare($query = null) {
        [...] // Connect to PDO, bla bla bla

        self::$_query = self::$link->prepare($query);
    }

    [...]

}

class Login extends Model {
    public function getUser($username = null) {
        self::prepare('SELECT * FROM usuarios WHERE usuario = :username LIMIT 1');
        self::bindValue('username', $username);

        return self::fetch();
    }
} 
```

问题是，我需要在我的 mysql 中插入前缀，以避免表冲突，但不想编辑我的所有查询。

```
clientone_tablename
clienttwo_tablename
clientthree_tablename 
```

准备查询时如何执行此操作、解析和插入表前缀？

我什么都没试过，因为我所知道的是，将我的自定义 PDO 扩展到 PHP PDO 类，这现在并不多..

我已经看到了： [PDO - 使用表前缀](https://stackoverflow.com/questions/1472250/pdo-working-with-table-prefixes)。但不要正常工作..

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:06:52.430

只需重写您的查询以使用在某处变量中找到的表前缀。解析所有表名查询比它的价值更麻烦。（你真的想写一个 SQL 解析器吗？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T20:38:23.210

所以我假设您只有 1 个 MySQL 数据库（您的虚拟主机上的最小软件包）并且需要为您的每个客户存储一个系统副本。

我的建议是，您创建一组单独的表（对于每个客户端），但名称无关紧要，因为您可以在客户端表中查找表名。

这是我给你的例子：clients表应该存储他们自己表的表名
（例如users_tbl = clientone_users for client id：1），以便稍后你可以查询clients表并获取他/她的表名，然后使用查询他/她的用户、新闻、页面和文件表的结果。

```
# SQL: new table structure
-- store the names of the clients tables here
CREATE TABLE clients(
    id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(id),
    name VARCHAR(50),
    address VARCHAR(250),
    email VARCHAR(50),
    pass BLOB,
    /* table names*/
    users_tbl VARCHAR(70),
    news_tbl VARCHAR(70),
    pages_tbl VARCHAR(70),
    files_tbl VARCHAR(70)
) ENGINE = InnoDB;

# PHP: Some definitions for the table structure
$tbl_names = array("_users","_news","_pages","_files");
$tbl_fields = array();
$tbl_fields[0] = array("id INT","users_col1 VARCHAR(10)","users_col2 VARCHAR(20)");
$tbl_fields[1] = array("id INT","news_col1 DATE",...);
$tbl_fields[2] = array(...);
$tbl_fields[3] = array(...);
// refers to YOUR clients table field names (see above)
$clients_fields = array("users_tbl", "news_tbl", "pages_tbl", "files_tbl");

# PHP: Create a user and create the users database
function createUser($name, $address, $email, $pass, $salt) {
    global $db, $tbl_names, $tbl_fields;
    $success = false;
    if ($db->beginTransaction()) {
        $sql = "INSERT INTO clients(name, address, email, pass)
                     VALUES (?, ?, ?, AES_ENCRYPT(?, ?));"
        $query = $db->prepare($sql);
        $query->execute(array($name, $address, $email, $pass, $salt));
        if ($query->rowCount() == 1) { # if rowCount() doesn't work
            # get the client ID        # there are alternative ways
            $client_id = $db->lastInsertId();
            for ($i=0; $i<sizeof($tbl_names); $i++) {
                $client_tbl_name = $name . $tbl_names[$i];
                $sql = "CREATE TABLE " . $client_tbl_name . "("
                           . implode(',', $tbl_fields[$i]) . ");";
                if (!$db->query($sql)) {
                    $db->rollBack();
                    return false;
                } else {
                    $sql = "UPDATE clients SET ".clients_fields[$i]."=? "
                                       ."WHERE id=?;";
                    $query = $db->prepare($sql);
                    if (!$query->execute(
                            array($client_tbl_name, (int)$client_id)
                                         )) {
                        $db->rollBack();
                        return false;
                    }
                }
            }
            $db->commit();
            $success = true;
        }
        if (!$success) $db->rollBack();
    }
    return $success;
}

# PHP: Get the Client's table names
function getClientsTableNames($client_id) {
    $sql = "SELECT (users_tbl, news_tbl, pages_tbl, files_tbl)
              FROM clients WHERE id=?;";
    $query = $db->prepare($sql);
    if ($query->execute(array((int)$client_id)))
        return $query->fetchAll();
    else
        return null;
}

# PHP: Use the table name to query it
function getClientsTable($client_id, $table_no) {
    $table_names = getClientsTableNames($client_id);
    if ($table_names != null && isset($table_names[$table_no])) {
        $sql = "SELECT * FROM ".$table_names[$table_no].";";
        $query = $db->prepare($sql);
        if ($query->execute(array((int)$client_id)))
            return $query->fetchAll();
    }
    return null;
} 
```

# html - 图层覆盖其他元素并忽略 z-index

> ID：10234671
> 
> 赞同：0
> 
> 时间：2012-04-19T18:41:37.150
> 
> 标签：html

在网络上，我有一个透明层来覆盖点击页面，并且只显示几个页面元素。但我对 z-index 有什么并不重要。该层涵盖了我想展示的一个元素。具有 id 的元素`player`应显示在图层上。我应该为此指定什么不同的`layer`内容`player`？

```
 <div id="layer" style="width: 100%; height: 100%; visibility: visible; z-index: 99;"> </div>

  <div id="page" style="margin: 0 auto; position: relative; top: 80px;"> <!-- Begin page div -->

  <div id="player" style="width: 506px; height: 377px; border: 2px solid white; z-index: 99999; display: inline; float:left; margin-top: 12px; margin-left: 12px; margin-right:0px; overflow: hidden;"> 
```

的样式`layer`是这些。

```
#layer {
    position: absolute; 
    top: 0px; 
    left: 0px; 
    width: 100%; 
    height: 100%; 
    background: black; 
    filter:alpha(opacity=80); 
    opacity: 0.80; 
    z-index: 999;" 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:08:42.520

要检查的一件事是你应该有“位置：相对；” 应用于这些 div 的父容器，以便识别和应用 z-indexing。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T20:59:49.847

您需要`position: relative;`为#player div 设置。

# mysql - mysql查询在我的左连接上没有收到任何数据

> ID：10234677
> 
> 赞同：0
> 
> 时间：2012-04-19T18:41:59.110
> 
> 标签：mysql

我有一个查询，左连接部分应该返回数据或 null。但即使有现有记录，它也不会返回任何数据。左连接部分的转折是我只想检索一条记录（如果存在）。谢谢你的帮助。

```
select a.*,p.thumbnailphotopath as AlbumPicture 
from (select * from album_access) ac
inner join (select * from albums) a on a.ID = ac.AlbumID
left join (
    select * from photos 
    where IsProcessed = 1 order by DateUploaded desc limit 1
) p 
on a.ID = p.AlbumID #should return one if exist.
where ac.AccessUserID = '35e44a8e-643a-4c4f-8a46-59911a1e7c53' 
  and ac.FullControl = 1 and a.Private = 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:51:13.627

首先，您可以只加入一个表名，而不需要加入整个 SELECT * FROM 语句。

其次，您应该尽量不要使用 SELECT * 而是选择您想要的列。

但我认为您的 LEFT JOIN 的问题在于您正在加入一个只会返回一个结果的子查询，这将是最后上传的照片中的条目，无论它属于哪个专辑 ID。如果您希望在照片中输入每行的最后上传日期，请尝试这样的操作

```
SELECT a.*,p.thumbnailphotopath AS AlbumPicture 
FROM album_access ac
INNER JOIN albums a ON a.ID = ac.AlbumID
LEFT JOIN (
    SELECT albumID,MAX(DateUploaded) FROM photos 
    WHERE IsProcessed = 1 GROUP BY albumID
) p ON a.ID = p.AlbumID #should return one if exist.
WHERE ac.AccessUserID = '35e44a8e-643a-4c4f-8a46-59911a1e7c53' 
  AND ac.FullControl = 1 
  AND a.Private = 1 
```

# python - 解析天气的脚本

> ID：10234678
> 
> 赞同：0
> 
> 时间：2012-04-19T18:42:03.933
> 
> 标签：python, python-2.5

我正在努力学习 Python。我唯一的经验是 Applescripting，学习起来并不容易……反正到目前为止。

我正在尝试解析一个 xml 天气站点，到目前为止我有我需要的数据，但我不知道如何将它放入列表中以进一步处理它。任何人都可以帮忙吗？

```
from BeautifulSoup import BeautifulSoup
import xml.etree.cElementTree as ET
from xml.etree.cElementTree import parse
import urllib2

url = "http://www.weatheroffice.gc.ca/rss/city/ab-52_e.xml"
response = urllib2.urlopen(url)
local_file = open("\Temp\weather.xml", "w")
local_file.write(response.read())
local_file.close()

invalid_tags = ['b', 'br'] 

tree = parse("\Temp\weather.xml")

stuff = tree.findall("channel/item/description")

item = stuff[1]

parsewx = BeautifulSoup(stuff[1].text)

for tag in invalid_tags: 
for match in parsewx.findAll(tag): 
    match.replaceWithChildren()

print parsewx 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:57:19.527

由于 XML 是结构化数据，BeautifulSoup 返回标签[树](http://en.wikipedia.org/wiki/Tree_structure)。该[文档](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)包含有关如何在该树中[搜索](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#searching-the-tree)和[导航的大量信息。](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#navigating-the-tree)

# regex - 基于先前值的正则表达式匹配

> ID：10234681
> 
> 赞同：0
> 
> 时间：2012-04-19T18:42:17.007
> 
> 标签：regex

是否可以创建一个正则表达式，如果它前面没有另一个值，它只会匹配一个值？例如，仅`?`当前面没有. 时才测试 true `.php`。如下所示：

```
/(?!\.php)\?/.test( 'mypage.php?call=here' ) == false;
/(?!\.php)\?/.test( 'otherpage.asp?call=here' ) == true; 
```

我试过使用前瞻`?!`和`?:`，但到目前为止还没有找到有效的组合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:58:29.890

这将匹配其中没有 a`?`或`?`前面没有 的字符串`.php`：

```
^(?!.*\.php\?) 
```

这是一个版本，它也需要`?`在字符串中：

```
^(?!.*\.php\?).*\? 
```

# c++ - C++ 运算符 < 重载

> ID：10234682
> 
> 赞同：4
> 
> 时间：2012-04-19T18:42:17.277
> 
> 标签：c++, sorting, operators

我在重载 < 运算符时遇到问题。我有这堂课：

WordEntry.h：

```
class WordEntry
{
public:
    WordEntry(string word);
    ~WordEntry();

    bool operator<(const WordEntry otherWordEntry);

    string getWord();

private:
    string _word;
}; 
```

WordEntry.cpp（我删除了构造函数和析构函数）：

```
string WordEntry::getWord()
{
   return _word;
}

bool WordEntry::operator<(WordEntry otherWordEntry)
{
   return  lexicographical_compare(_word.begin(),_word.end(),otherWordEntry.getWord().begin(),otherWordEntry.getWord().end());
} 
```

当我像这样在 main.cpp 中使用它时，一切都很好：

```
 WordEntry w1("Der");
    WordEntry w2("das");

    if (w1.operator<(w2)) {
       cout << "w1 > w2";
    }
    else 
    {
       cout << "w2 > w1";
    } 
```

但是当我用对象调用`sort()`时，我会收到错误消息`vector``WordEntry`

> 二进制表达式的无效操作数（“const WordEntry”和“const WordEntry”）

它指向`stl_algo.h`。

有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T18:44:26.450

现在的论点`<`是 const 但成员不是。这意味着`<`2 个对象之间的比较`const WordEntry&`将失败，因为它无法绑定到`<`. 您需要同时使成员和参数`const`

```
bool operator<(const WordEntry& otherWordEntry) const;

bool WordEntry::operator<(const WordEntry& otherWordEntry) const {
  ...
} 
```

注意：正如评论中指出的，您还应该`WordEntry`通过引用传递

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T18:45:03.857

对右值使用 const 引用并使方法 const 向编译器保证您不会更改对象。

```
bool operator<(const WordEntry& otherWordEntry) const
{
    // comparison
} 
```

您也不需要显式调用操作员。为对象定义后，`WordEntry`您可以执行以下操作：

```
if (w1 < w2) { // etc } 
```

由于您没有使用自定义比较谓词，因此您可以使用`std::string::operator<`：

```
return _word < otherWordEntry._word; 
```

David 在按价值返回内部成员方面提出了一个很好的观点。如果您想直接使用`lexicographical_compare`访问器而不是`_word`成员（可以在类范围内），那么您应该像这样定义它：

```
const string& getWord() const { return _word; } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T18:58:48.437

```
string WordEntry::getWord()
bool WordEntry::operator<(WordEntry otherWordEntry)
{
   return  lexicographical_compare(_word.begin(),
                                   _word.end(),
                                   otherWordEntry.getWord().begin(),
                                   otherWordEntry.getWord().end());
} 
```

`getWord`成员函数创建内部成员属性的副本并返回该副本。两次连续调用`getWord`将返回两个`std::string`具有相同内容的不同实例，但它们仍然是不同的对象。该`lexicographical_compare`函数要求第一个和第二个参数是指向同一容器的迭代器，第三个和第四个参数也是如此。在您的情况下，您将迭代器传递到**不同的**容器（字符串）中，这些容器将在函数内部进行比较并产生未定义的行为。

最简单的解决方案是`getWord`返回`const`对 internal 的引用`std::string`，这样，迭代器都将引用右侧对象中的内部对象。

正如其他人也提到的那样，您应该通过`WordEntry`引用`const`传递，并且`operator<`应该是`const`，以*改进*代码。但是您实现中的问题是来自不同容器的迭代器的混合。

# css - 动态高度相同的两个 div

> ID：10234683
> 
> 赞同：1
> 
> 时间：2012-04-19T18:42:18.720
> 
> 标签：css, html

正如标题所说，我需要两个 div 一样高。它们应该尽可能高，以适应内容。当前的CSS是：

```
.portfolioleft{
    float:left;
    width:189px;
    background-color: #436FAC;
    min-height: 100px;
    height: auto;
    color: #FFF;
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 10px;
}
.portfolioleft img{
    border-radius: 10px;
}
.portfolioright{
    float:right;
    width:500px;
    background-color: #436FAC;
    min-height: 100px;
    height: auto;
    color: #FFF;
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 10px;
}
.portfolioright a{
    color:#FFFFFF;
} 
```

div的html是：

```
<div class="portfolioleft"><img src="img" alt="img" width="189" height="311" /></div>
<div class="portfolioright">
<h2>Title</h2>
<p>Text</p>
</div>
<div class="clear">&nbsp;</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:11:15.893

单靠 CSS 无法解决这一壮举（除非您想要一个可以使用图像的 hack 解决方案）。您将需要实现一个 JS 解决方案。由于内容是动态的，并且您不知道列的高度，因此您需要访问 DOM 以确定最高列的高度，然后将其应用于指定的列。我经常使用以下内容，它工作得很好并且很容易实现。

[http://www.jainaewen.com/files/javascript/jquery/equal-height-columns.html](http://www.jainaewen.com/files/javascript/jquery/equal-height-columns.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:51:29.460

不幸的是，这是 CSS 中的一个棘手问题。如果您只想将左侧边栏的背景颜色扩展到该部分的底部（其高度由右侧 div 定义），请尝试将它们包装在父 div 中（缩放到右侧 div 的高度），然后将左侧 div 定位为 position:absolute 和 100% 的高度，如下所示：

```
<div class="portfolio">
  <div class="portfolioleft">...</div>
  <div class="portfolioright">...</div>
</div>

.portfolio {
  position: relative;
  background: white;
}

.portfolio .portfolioleft {
  position: absolute;
  left: 0;
  top: 0;
  width: 200px;
  height: 100%;
  background: #436FAC;
}

.portfolio .portfolioright {
  margin-left: 200px;
} 
```

如果两边都是动态的，并且您需要两个高度匹配，那么让它在所有主要浏览器上工作的唯一可靠方法是诉诸基于表格的两列布局，这可能会很糟糕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T07:27:28.410

左右 div 中的单元格属性

我检查了您的代码并将浮动替换为显示表格单元格

您可以查看此直播[http://jsfiddle.net/rohitazad/prMLh/1/](http://jsfiddle.net/rohitazad/prMLh/1/)

# sql - 使用 IF 语句后无法从 DB 输出正确的行

> ID：10234685
> 
> 赞同：0
> 
> 时间：2012-04-19T18:42:21.210
> 
> 标签：sql, sql-server-2008, tsql

我正在尝试创建一个 tsql 存储过程，它将根据一些参数输出行。最终目标是将行移动到另一个表，这就是为什么我有计数 - 我想跟踪我移动了多少行。有两个表 -`Notes`和`ExtraNotes`。`ExtraNotes`保存来自第一个表的溢出信息。

我正在使用该`if`语句根据调用的参数选择正确的行，`NoteType`但我不知道如何在`if`. 我知道每个中的选择语句`if`是错误的

```
select * 
from dbo.Notes 
left join dbo.ExtraNotes on Notes.NoteID = dbo.ExtraNotes.NoteID 
where NoteDate <= @Date 
```

任何人都可以提供一些关于我如何输出正确的行并可能更好地重组它的指针吗？

完整的代码在这里。

```
alter proc selectrows 
   --external variables
   @Date datetime,
   @NoteType varchar(2)
as
--internal variables
--Count variables, before any changes
declare @count_rowsBefore int
declare @count_Extra_rowsBefore int

--Count variables of selected rows to be moved

declare @count_SelectedRows int
declare @count_Extra_SelectedRows int

select @count_rowsBefore = count(*)
from dbo.Notes

select @count_Extra_SelectedRows = count(*)
from dbo.ExtraNotes

if(@NoteType= 'B')
begin
select @count_SelectedRows = count(dbo.Notes.NoteID), @count_Extra_SelectedRows =            count(dbo.ExtraNotes.NoteID)
        from dbo.Notes
        left join dbo.ExtraNotes on
        Notes.NoteID = dbo.ExtraNotes.NoteID
        where NoteDate <= @Date

        select *
        from dbo.Notes
        left join dbo.ExtraNotes on
        Notes.NoteID = dbo.ExtraNotes.NoteID
        where NoteDate <= @Date
end
else if(@NoteType = 'S')
  begin
  select @count_SelectedRows = count(dbo.Notes.NoteID), 
@count_Extra_SelectedRows = count(dbo.ExtraNotes.NoteID)
        from dbo.Notes
        left join dbo.ExtraNotes on
        Notes.NoteID = dbo.ExtraNotes.NoteID
        where NoteDate <= @Date
        and NoteType = 'S'

        select *
        from dbo.Notes
        left join dbo.ExtraNotes on
        Notes.NoteID = dbo.ExtraNotes.NoteID
        where NoteDate <= @Date
end
else if (@NoteType = 'M')
begin
select @count_SelectedRows = count(dbo.Notes.NoteID),
@count_Extra_SelectedRows =  count(dbo.ExtraNotes.NoteID)
        from dbo.Notes
        left join dbo.ExtraNotes on
        Notes.NoteID = dbo.ExtraNotes.NoteID
        where NoteDate <= @Date
        and NoteType = 'M'

        select *
        from dbo.Notes
        left join dbo.ExtraNotes on
        Notes.NoteID = dbo.ExtraNotes.NoteID
        where NoteDate <= @Date
  end
 else
  begin
  raiserror('Please enter a valid Note Read Type= M, S or B',16,1)
  end

Print 'Total Number of rows: ' + cast(@count_rowsBefore as varchar(10))
Print 'Total Number of "Extra" rows: ' + cast(@count_Extra_RowsBefore as varchar(10))

Print '-----------------------------------------------'
Print 'Total Number of rows to Move: ' + cast(@count_SelectedRows as varchar(10))
Print 'Total Number of "Extra" Rows to Move: ' + cast(@count_Extra_SelectedRows 
as varchar(10)) 
```

[输出截图](http://i2.photobucket.com/albums/y19/_karma_/code/ouput.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:20:19.520

如果您只想对您的行进行计数，您可以使用 OVER 子句来生成它们。如果 NoteType 在表中只能是 S 或 M，那么传递一个 NULL 并使用 ISNULL(, ) 应该会得到你想要的。下面的代码提取所有注释、所有相关注释，前两列是每个表中源行的总计数。我知道这是示例代码，所以我不会对 select *.

底部的链接越过 OVER 子句。

```
CREATE PROCEDURE selectRows
    ( @Date DATETIME
      , @NoteType VARCHAR(2) -- Pass NULL for both
    )
AS
    select count(dbo.notes.noteid) 
               over() as notecount
           , count(dbo.ExtraNotes.NoteID)
               over() as extraNoteCount
           , *
    from dbo.Notes 
    left join dbo.ExtraNotes
        on Notes.NoteID = dbo.ExtraNotes.NoteID
    where NoteDate <= @Date
      and NoteType = ISNULL(@NoteType, NoteType); 
```

您不一定需要所有这些计数副本，因此在标题行中合并可能更符合您的想法。下面的代码提取所有注释和一个标题行（noteid 为空），只有计数：

```
CREATE PROCEDURE selectRows
    ( @Date DATETIME
      , @NoteType VARCHAR(2) -- Pass NULL for both
    )
AS
    select *
       , CAST(NULL AS INT) noteCount
       , CAST(NULL AS INT) extraNoteCount
    from dbo.Notes 
    left join dbo.ExtraNotes
        on Notes.NoteID = dbo.ExtraNotes.NoteID
    where NoteDate <= @Date
      and NoteType = ISNULL(@NoteType, NoteType)
    UNION ALL
    SELECT NULL
       , NULL -- Repeat for as many columns as are in the select * above
       , count(dbo.Notes.NoteID)
       , count(dbo.ExtraNotes.NoteID)
    from dbo.Notes 
    left join dbo.ExtraNotes
        on Notes.NoteID = dbo.ExtraNotes.NoteID
    where NoteDate <= @Date
      and NoteType = ISNULL(@NoteType, NoteType) 
```

;

[http://msdn.microsoft.com/en-us/library/ms189461.aspx](http://msdn.microsoft.com/en-us/library/ms189461.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:03:54.083

目前尚不清楚您要做什么。似乎您正在寻找数据以及有关数据的一些统计信息，但我们不知道您真正想要什么数据，或者结构应该是什么。将它们分成单独的逻辑部分会更容易吗？映射出您想要输出的数据并分别为每个项目构建代码可能会更简单。

您可以澄清是否可以提供几行包含列和示例数据的行，以及如果该数据通过您的代码运行时您想要的示例输出。

一个建议是，If/then 语句不过滤任何内容，因此您将在第二个查询中获得比您想要的更多的数据，因为过滤器仅适用于每个查询。如果这对您有意义：您已经有一个带有 NoteType 的变量，您可以使用它来过滤。这会正确过滤数据，并且应该替换整个 if-else if 语句集，因为代码现在使用变量直接选择正确的数据。因此，您可以使用而不是使用 if 语句

```
select @count_SelectedRows = count(dbo.Notes.NoteID), 
        @count_Extra_SelectedRows =  count(dbo.ExtraNotes.NoteID)
  from dbo.Notes left join dbo.ExtraNotes 
    on Notes.NoteID = dbo.ExtraNotes.NoteID
  where NoteDate <= @Date
  and NoteType = @NoteType

select * 
  from dbo.Notes left join dbo.ExtraNotes 
    on Notes.NoteID = dbo.ExtraNotes.NoteID         
  where NoteDate <= @Date and NoteType = @NoteType 
```

# php - 在 PHP 中获取 teampeak 服务器状态

> ID：10234689
> 
> 赞同：1
> 
> 时间：2012-04-19T18:42:46.710
> 
> 标签：php, voip, status

我有一个 teampeak 服务器，我想在网页（PHP）中显示服务器状态（在线、离线）。请问你能帮帮我吗 ？我尝试了不同的东西，但它不起作用。

谢谢 ！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:57:35.083

如果您使用的是 Teamspeak 3，那么这可以通过使用 Teamspeak php 框架轻松完成。（[http://addons.teamspeak.com/directory/tools/integration/TeamSpeak-3-PHP-Framework.html](http://addons.teamspeak.com/directory/tools/integration/TeamSpeak-3-PHP-Framework.html)）

之后，您可以使用它来检查服务器的状态：

```
TeamSpeak3::init();
$status = "offline";
$ts3 = TeamSpeak3::factory("serverquery://<queryusername>:<password>@<name_or_ip>:<queryport>/?server_port=<ts3port>&use_offline_as_virtual=1&no_query_clients=1");
$status = $ts3->getProperty("virtualserver_status"); 
```

您还可以使用 Teamspeak3_node_server 的 isOnline 函数。

# visual-c++ - 调用 new 时调试一个奇怪的错误

> ID：10234695
> 
> 赞同：0
> 
> 时间：2012-04-19T18:43:02.187
> 
> 标签：visual-c++

我有一个程序，当使用 Microsoft Visual C++ 2008 Express 编译运行时会崩溃

```
comparison_vectors = new vec_element[(rbfnetparams->comparison_vector_length)+1]; 
```

在 myprog.exe 中的 0x7c93426d 处出现错误未处理的异常：0xC0000005：访问冲突读取位置 0x00000000

`rbfnetparams->comparison_vector_length`评估为 4（应该这样做并在调试器中检查），当我将行更改为测试时，事情仍然在这里崩溃：

```
comparison_vectors = new vec_element[5]; 
```

`vec_element`是一个具有多个整数、双精度和几个布尔值的结构，但没有方法或构造函数。如果我用 malloc 替换 new ，事情就会运行，但随后会在其他地方的另一个 new 上崩溃。每次运行这条线时它都不会崩溃，只是有时会崩溃，但似乎在每次这条线的迭代次数相同之后都会崩溃。此时程序中的内存使用量仅为 10MB。

这变得很奇怪，因为在 Solaris 上的 gcc 下编译和运行同一个程序，这通常比 Windows 显示的错误多得多。

任何帮助将不胜感激，因为我不知道如何调试这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T08:35:44.040

`Access violation reading location 0x00000000`意思是“你取消引用了一个`NULL`指针。” 看起来偶尔`rbfnetparams`是`NULL`你到达这条线的时候，因此你得到了错误。

我无法解释为什么会`comparison_vectors = new vec_element[5];`崩溃。是同样的错误信息吗？

检查是否`rbfnetparams`在`NULL`该行之前，并查看它是否被命中（或添加条件断点）。然后确定这`rbfnetparams`是否`NULL`是其他地方更大错误的症状。

取消引用`NULL`指针是未定义的。Solaris 编译器可能会进行优化以掩盖该错误。 [这是标准允许的](http://blog.llvm.org/2011/05/what-every-c-programmer-should-know_21.html)（阅读该帖子引用的整个系列）。

# c# - 源文件不同于构建模块时的错误

> ID：10234699
> 
> 赞同：0
> 
> 时间：2012-04-19T18:43:16.713
> 
> 标签：c#, visual-studio-2008

我目前有一个引用十个 .dll 文件的解决方案。这些 .dll 文件又都引用了一个共享的 .dll 文件。

今天我在调试时开始收到一个错误，指出“源文件与构建模块时的错误不同。”，紧接着重新编译共享的 .dll。

我尝试了所有通常的方法。我删除了 bin 和 object 文件夹。我重新编译。我关闭了 Visual Studio 的所有实例，并在它们全部关闭后重新启动。我重新启动了我的机器。没有任何固定似乎可以解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:45:51.313

我猜您的 10 个 DLL 中的一个引用了共享 DLL 的不同副本，而不是您编译的那个。

由于您拥有所有源代码，请将所有项目放在同一个解决方案中，并让 DLL 引用共享 DLL 的*项目*。这将解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T22:00:19.393

它也发生在我身上。一旦我通过从头开始重新编译项目来修复它（以与VS相同的顺序）。

还有一次，这没有帮助。我不记得我当时做了什么。

我相信这是VS中的一个错误。我注意到您正在运行 VS2008。升级后问题可能会消失（假设的错误可能已修复）。VS2010 也比 VS2008 更易于使用，因此它可以作为自己的领域来保持最新状态。为什么不下载评估版 VS11 并在那里试用。

将所有项目移至一个解决方案，以简单正确的方式引用它们。编译。现在，您在任何地方都拥有正确的 DLL，并且可以返回到更多样化的解决方案。

您也可以尝试使用 MSBuild。这很容易，因为您已经在 VS 中拥有项目。一旦它由 MSBuild（VS 自己使用）构建，它可能应该再次在 VS 中编译。

最后，您可以尝试使用 nAnt 进行构建。编译完成后，您可能可以再次在 VS 中编译。

祝你好运。我去过那儿。糟透了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:49:33.633

[编辑] 假设这是 asp.net，忽略。[/编辑]

您是否删除了所有临时 .NET 文件夹？

无论是在：

C:\Windows\Microsoft.NET\Framework[你的版本]\Temporary ASP.NET Files

或者

C:\Windows\Microsoft.NET\Framework64[你的版本]\Temporary ASP.NET Files

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T14:16:04.527

在将所有解决方案的输出文件夹中共享 .dll 的最后修改日期与存储在主要解决方案的输出文件夹中的文件进行比较时，我注意到它们与我刚刚构建的文件不同.

这对我来说没有意义，所以我只是将新文件复制到输出文件夹中。这并没有解决问题。在随后的构建中，旧版本再次被放入输出文件夹，在调试时立即导致错误......

在编译期间，旧版本与其他引用的 .dll 之一一起被提取。显然，对拉入的文件名进行了某种检查，以便只使用 1 个文件，但不检查最新版本号。

**我能够通过从主要解决方案创建对共享 .dll 的引用来实际解决问题。** 直接引用显然（或者可能希望）在引用引用的文件之前被拉入（并且已经被复制到与引用的 .dll 相同的输出文件夹中），因此最新的文件首先被成功拉入。

如果需要澄清，请告诉我！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-20T13:50:41.530

我很少回复帖子，因为我通常太忙了，但我只是在同样的问题上花了很多时间。我在 Windows 7 中运行 VS 2008。我已将我的 Visual Studio 设置为在 XP 兼容模式下运行，以解决我在其他项目中遇到的一些问题，但忘记将其重置为不在兼容模式下运行。

一旦我删除了运行兼容模式（在 DevEnv.exe 上的 Windows 资源管理器中），我的源与调试信息不​​同步的问题就消失了。

希望这可以帮助将来遇到同样问题的人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T18:45:10.363

我**想**您在项目中直接引用了某个 DLL，而不是*project*。这意味着如果您甚至清理和重建，*相同*的dll 将被用作参考。很多时候这是一个问题，所以我建议你检查你的参考资料。

# prolog - 代码中的 Prolog 查询

> ID：10234700
> 
> 赞同：1
> 
> 时间：2012-04-19T18:43:19.937
> 
> 标签：prolog

如何在代码中执行查询？

例如：

```
person(abe,instructor).  
person(bob,student).  
person(cindy,student).  
person(david,student).  
person(abe,student).  

% Like this, but this does not work  
% :- person(X,Y). 
```

加载程序后，我可以运行以下查询：person(X,Y)。

如何将此查询作为程序本身的一部分运行，以便程序加载后，它将运行查询并输出：

```
X = abe,  
Y = instructor ;  
X = bob,  
Y = student ;  
X = cindy,  
Y = student ;  
X = david,  
Y = student ;  
X = abe,  
Y = student. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:41:56.993

你可以只创建一个新的谓词......这里有两种不同的方式。第一个找到所有人（X，Y），将​​他们放入一个列表 AllPeople，然后将其写出来。

第二个是“失败驱动循环”，它执行第一个匹配，将其写出，然后告诉 prolog 再试一次，即“失败”，它一直持续到没有更多匹配项，然后匹配同名的第二个谓词，以确保谓词最终返回 true。

```
showpeople1 :-
    findall(X/Y, person(X,Y), AllPeople),
    write(AllPeople).

showpeople2 :-
    person(X, Y),
    write(X), write(','), write(Y), nl,
    fail.

showpeople2 :- true.

?- showpeople1.
[abe/instructor,bob/student,cindy/student,david/student,abe/student]
true.

?- showpeople2.
abe,instructor
bob,student
cindy,student
david,student
abe,student
true. 
```

# java - 动态创建 jCheckBox 并添加到 jScrollPane

> ID：10234704
> 
> 赞同：6
> 
> 时间：2012-04-19T18:43:31.527
> 
> 标签：java, swing, dynamic, jscrollpane, jcheckbox

编辑：使用下面介绍的解决方案，我将代码更改为在 JScrollPane 中有一个 JPanel。使用 JButton 我将 JCheckBoxes 添加到 JScrollPane 内的 JPanel。这是解决了一个问题，因为 JScrollPane 只能使用一个 JComponent。其余问题已解决，为 JScrollPane 内的 JPanel 设置了一个网格布局。为了后代，我把我原来的问题保留在这里：

原始问题：我正在尝试动态创建 JCheckBox 并将它们添加到 JScrollPane，但可惜我收效甚微。我已将其简化为单一的概念验证实现。

我在 JFrame 中有一个 JScrollPaneon 和一个 JPanel。同样在 JPanel 上，我添加了一个按钮，该按钮应该在单击时将 JCheckBox 添加到 JScrollPane。应该足够简单。按钮内部的代码如下：

```
 private void addCheckBoxActionPerformed(java.awt.event.ActionEvent evt) {

    JCheckBox cb = new JCheckBox("New CheckBox");        

    jScrollPaneCheckBoxes.add(cb);
    jScrollPaneCheckBoxes.revalidate();
 } 
```

代码运行看似没有错误。我没有例外，使用调试器表明 JCheckBox 实际上已添加到 JScrollPane 中。不幸的是，应用程序中没有显示任何内容。我需要关于在哪里寻找问题的方向。

这是您可以运行的快速代码。不幸的是，我使用 Netbeans 和它的 GUI 设计器将它放在一起，因此它比它需要的长一点，尤其是生成的代码。专注于方法 jButton1ActionPerformed，这就是上面代码的来源。

编辑：此代码现在可以满足我的需要。:-)

```
package dynamiccheckboxsscce;

import javax.swing.JCheckBox;

public class Main extends javax.swing.JFrame {

    /**
     * Creates new form Main
     */
    public Main() {
        initComponents();
    }

    @SuppressWarnings("unchecked")
    private void initComponents() {

        jScrollPane1 = new javax.swing.JScrollPane();
        jPanel1 = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jScrollPane1.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        jScrollPane1.setPreferredSize(new java.awt.Dimension(250, 250));

        jPanel1.setPreferredSize(new java.awt.Dimension(300, 250));
        jPanel1.setLayout(new java.awt.GridLayout(0, 2, 10, 10));
        jScrollPane1.setViewportView(jPanel1);

        jButton1.setText("Add Checkbox");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 309, Short.MAX_VALUE)
                .addContainerGap())
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jButton1)
                .addGap(112, 112, 112)))));
        layout.setVerticalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 11, Short.MAX_VALUE)
                .addComponent(jButton1)
                .addContainerGap()));

        pack();
    }

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
        JCheckBox cb = new JCheckBox("New CheckBox");

        jPanel1.add(cb);
        jPanel1.revalidate();
        jPanel1.repaint();
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /*
         * Set the Nimbus look and feel
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Main.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Main.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Main.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Main.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }

        /*
         * Create and display the form
         */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Main().setVisible(true);
            }
        });
    }
    private javax.swing.JButton jButton1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T19:08:57.603

*   如果不发布[SSCCE](http://sscce.org/)，您必须接受[JScrollPane](http://docs.oracle.com/javase/tutorial/uiswing/components/scrollpane.html)被指定为仅嵌套一个`JComponent`，

*   如果您想向 中添加更多，`JComponent`则将[JPanel](http://docs.oracle.com/javase/tutorial/uiswing/components/panel.html)`JScrollPane`放在那里，然后将新的添加到而不是`JComponent``JPanel``JScrollPane`

*   检查[如何动态添加/删除 JComponents](https://stackoverflow.com/a/6989230/714968)

编辑

*   您必须为 JPanel 设置正确的 LayoutManager

*   您必须将 JPanel 添加到 JScrollPane

*   例如（不使用内置设计器，即使是安全的时间......，也需要关于使用过的 SwingFramework 和 Swing 的最佳知识，我对普通的 Swing 感到满意）

代码

```
import java.awt.BorderLayout;
import java.awt.GridLayout;
import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;

public class AddJCheckBoxToJScrollPane {

    private static final long serialVersionUID = 1L;
    private JFrame frame = new JFrame();
    private JButton jButton1;
    private JPanel jPanel1;
    private JScrollPane jScrollPane1;

    public AddJCheckBoxToJScrollPane() {
        jPanel1 = new JPanel();
        jPanel1.setLayout(new GridLayout(0, 2, 10, 10));
        jScrollPane1 = new JScrollPane(jPanel1);
        jButton1 = new JButton("Add Checkbox");
        jButton1.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                JCheckBox cb = new JCheckBox("New CheckBox");
                jPanel1.add(cb);
                jPanel1.revalidate();
                jPanel1.repaint();
            }
        });
        frame.add(jScrollPane1);
        frame.add(jButton1, BorderLayout.SOUTH);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(300, 200);
        //frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public static void main(String args[]) {

        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
        } catch (InstantiationException ex) {
        } catch (IllegalAccessException ex) {
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        }
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                new AddJCheckBoxToJScrollPane();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:46:10.623

您应该调用 repaint() 而不是 revalidate()。

请参阅[重新验证与重新绘制](https://stackoverflow.com/questions/1097366/java-swing-revalidate-vs-repaint)

# android - DatePickerDialog ICS - 获取标题中显示的日期

> ID：10234706
> 
> 赞同：2
> 
> 时间：2012-04-19T18:43:40.053
> 
> 标签：android, dialog, datepicker, android-4.0-ice-cream-sandwich, datepickerdialog

我最近刚刚将我的个人手机更新到 Android 4.0.4。这样做，我注意到`DatePickerDialog`我在应用程序中显示的不再像以前的版本那样在标题栏中显示长日期格式：

![在此处输入图像描述](../Images/37b914a9384a532d97240afed2195249.png)

相反，它只是说：“设置日期”。

那么，有没有一种快速的方法可以让它`DatePickerDialog`总是在标题栏中显示长日期？或者这是我必须通过创建自己的自定义来克服的版本限制`Dialog`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T20:17:13.307

> So, is there a quick way to make it so that this particular DatePickerDialog always display the long date in the title bar ?

The former update-the-title logic is completely removed from [the current `DatePickerDialog` source code](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/app/DatePickerDialog.java). You should be able to extend `DatePickerDialog` and override `onDateChanged()` (and the six-parameter constructor) to restore this functionality, at least in theory -- I have never tried this.

FWIW, [here is a link to an older version of `DatePickerDialog`](https://github.com/android/platform_frameworks_base/blob/9066cfe9886ac131c34d59ed0e2d287b0e3c0087/core/java/android/app/DatePickerDialog.java) that had the update-the-title logic.

# php - 使用套接字在 PHP（服务器）和 Android（客户端）之间建立连接

> ID：10234711
> 
> 赞同：0
> 
> 时间：2012-04-19T18:44:07.383
> 
> 标签：php, android

最近几天我一直在尝试发送（通过表单（输入，提交按钮））并通过 php 脚本将数据接收到 android 应用程序。我设法做到了，但我不喜欢这个解决方案。我所做的是：创建了一个表单：

```
<form action="index.php" method="get">
        <strong>Please give me a shell command:</strong> <br><input type="text" name="cmd" onmouseover="this.focus(); this.select();"><br>
        <input type="submit" value="Submit">
</form> 
```

当点击提交按钮时：

```
<?php
if ( isset($_GET['cmd'])  ){
    $cmd = $_GET['cmd'];
    if (empty($cmd)){
         echo 'Please fill in a command first!';
    }else{
         echo "You gave me : \"$cmd\", right?<br>";
    }

        // don't timeout! 
    set_time_limit(0); 
    // set some variables 
    //$host = $_SERVER['HTTP_HOST'];
    $host = '10.16.5.191';
    $port = 5000;

    // create socket 
    $socket = socket_create(AF_INET, SOCK_STREAM, 0) or die("Could not create socket\n"); 
    // bind socket to port 
    $result = socket_bind($socket, $host, $port) or die("Could not bind to socket\n"); 
    // start listening for connections 
    $result = socket_listen($socket, 3) or die("Could not set up socket listener\n"); 
    // accept incoming connections 
    // spawn another socket to handle communication 
    $spawn = socket_accept($socket) or die("Could not accept incoming connection\n");

    $output = $cmd;

    socket_write($spawn, $output, strlen ($output)) or die("Could not write output\n"); 

    // read client input 
    $input = socket_read($spawn, 1024) or die("Could not read input\n"); 
    // clean up input string 
    $input = trim($input);  

    echo "I have read :</br> $input";
}
?> 
```

但后来我意识到想在按下提交按钮时打开一个连接（直到 socket_accept()）并发送数据（socket_write()）。

所以我这样做了：

```
<?php

    if ( isset($_GET['cmd']) ){
        main($_GET['cmd'],$spawn);
        return;
    }else{

        // don't timeout! 
        set_time_limit(0); 
        // set some variables 
        //$host = $_SERVER['HTTP_HOST'];
        $host = '192.168.10.21';
        $port = 5000;

        // create socket 
        $socket = socket_create(AF_INET, SOCK_STREAM, 0) or die("Could not create socket\n"); 
        // bind socket to port 
        $result = socket_bind($socket, $host, $port) or die("Could not bind to socket\n"); 
        // start listening for connections 
        $result = socket_listen($socket, 3) or die("Could not set up socket listener\n"); 
        // accept incoming connections 
        // spawn another socket to handle communication 
        $spawn = socket_accept($socket) or die("Could not accept incoming connection\n"); 
        echo "spawn: $spawn</br>";

      echo '
        <form action="" method="get">
            <strong>Please give me a shell command:</strong> <br><input type="text" name="cmd" onmouseover="this.focus(); this.select();"><br>
            <input type="submit" value="Submit">
        </form>
      ';
        }
function main($cmd,$spawn){

        // 1\. Checks if the form is set

        if (empty($cmd)){
            echo 'Please fill in a command first!';
        }else{
            echo "You gave me : \"$cmd\", right?<br>";
        }
        $output = $cmd;

        socket_write($spawn, $output, strlen ($output)) or die("Could not write output\n"); 

        // read client input 
        $input = socket_read($spawn, 1024) or die("Could not read input\n"); 
        // clean up input string 
        $input = trim($input);  

        echo "I have read :</br> $input";
}
?> 
```

所以现在我建立连接，然后我的 php 脚本结束！当我通过提交按钮发送东西时，$spawn 是未知的。

我也试过 $_SESSION[''] 但 socket_write() 说 $_SESSION[''] 变量是整数而不是资源变量。

android 代码非常简单，只需打开一个连接（通过套接字），读取和写入。

我是 PHP 编码新手（最近 3 天学习）我该怎么办？有更好的方法吗？我希望连接仅在​​本地网络上！

# ios - 按下按钮时显示“锁定屏幕”类型的 UI

> ID：10234712
> 
> 赞同：0
> 
> 时间：2012-04-19T18:44:09.790
> 
> 标签：ios, xcode, uitextfield

我知道在选择文本字段时如何显示键盘。我希望在按下按钮时弹出键盘和锁定屏幕等一些框。关于如何执行此操作的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:01:11.960

显示文本字段的键盘；[theTextField 成为FirstResponder];

# jquery - 如果所有 div 都没有 Class 做事

> ID：10234715
> 
> 赞同：1
> 
> 时间：2012-04-19T18:44:19.390
> 
> 标签：jquery, html, css, jquery-selectors

我想用 ul li 里面的几个 div 做点什么：[JsFiddle](http://jsfiddle.net/76NNp/4/)

如果 ul li div 有一个类，我**什么**也不做`.Class`我如何更改此代码以便什么都不会发生，除非没有一个 div 有一个类？

正如你现在看到的，最后一个 li 是红色的，但这不应该是因为第二个 div 有类`.Class`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T18:47:24.810

在调用样式之前，您始终可以测试元素的存在：

```
$(document).ready(function()
{
    if($('ul').find('li div.Class').length == 0)
       $('ul').find('li div').css('color', 'red');
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T18:51:27.210

关于什么：

```
$(function () {
    var uls = $('ul li div:not(.Class)');

    if (uls.length > 0) {
        uls.css('color', 'red')
    }
}); 
```

# css - 溢出中的css错误

> ID：10234722
> 
> 赞同：0
> 
> 时间：2012-04-19T18:44:29.117
> 
> 标签：css

我有一些 CSS 问题。这是一个链接 [http://way2enjoy.com/photos/viewstory/1132](http://way2enjoy.com/photos/viewstory/1132)当你点击缩略图时，完整的照片将会出现，6 个人喜欢即将到来，但我面临的问题是当我们点击 6 个人喜欢链接时它显示了喜欢这个的人，但它是在后台出现的。我尝试更改 css 类但没有运气。当用户点击 6 个人喜欢时，它应该会在打开的照片上显示喜欢的人，所以如果有人可以指导它将有很大的帮助。

我试过溢出

```
fixed

relative 
```

但没有任何效果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:50:45.420

将`<div id="#facebox">`z-index 更改为 101

# javascript - 如何从模板访问对象的属性？

> ID：10234725
> 
> 赞同：8
> 
> 时间：2012-04-19T18:44:39.833
> 
> 标签：javascript, meteor, spacebars

根据[http://handlebarsjs.com/expressions.html](http://handlebarsjs.com/expressions.html)，我应该能够做到这一点：

```
<h1>{{article.title}}</h1> 
```

但我似乎无法让它在流星中工作。这是我的模板：

```
<template name="content">
  {{#if item}}
    <p>{{item.name}}</p>
  {{/if}}
</template> 
```

这是返回项目的 JavaScript：

```
 Template.content.item = function() {
    return Items.findOne({ _id: Session.get("list_id") });
  }; 
```

是的，该项目确实有一个名为`name`:-)

当我这样做时，我在 Firebug 中看到一个错误，上面写着`ret is undefined`

这可以追溯到evaluate.js：

```
for (var i = 1; i < id.length; i++)
  // XXX error (and/or unknown key) handling
  ret = ret[id[i]];
return ret; 
```

在发生错误的那一刻，`ret`引用该`window`对象。那是怎么回事？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-19T20:35:01.463

你应该使用 {{#with object}}

如果你的对象是这样的：

```
my_object = {
    name : 'my_name',
    prop : 'my_prop'
} 
```

在您的模板中，您可以执行以下操作：

```
<template name="my_template">
    {{#with my_object}}
        <p>Name is {{name}}<p>
        <p>Prop is {{prop}}</p>
    {{/with}}
</template> 
```

干得好 ：）

# javascript - jquery 遇到问题并遍历 DOM 以选择适当的元素

> ID：10234726
> 
> 赞同：0
> 
> 时间：2012-04-19T18:44:42.690
> 
> 标签：javascript, jquery, html

大家好，我的网站上有许多产品的以下 html，

它显示一行包含产品标题、价格、想要的数量和一个名为购买的复选框。qty 输入目前被禁用。

所以我想要做的是， *如果单击复选框，我希望输入数量设置为 1，并且我希望它启用。*

我似乎在这样做时遇到了一些麻烦。任何人都可以帮助现在我可以拥有多个产品，即在我的 html 页面中会有多个表格产品 div。

我曾尝试使用 jQuery 来更改细节，但我似乎无法访问某些元素。

所以基本上对于每个表格产品，我想在复选框上放置一个点击监听器，它将设置输入文本的值，即 qty 文本字段。

所以下面的页面上可能有 20 个。

```
<div class="table-products">
    <div class="table-top-title">
        My Spelling Workbook F
    </div>
    <div class="table-top-price">
        <div class="price-box">
            <span class="regular-price" id="product-price-1"><span class="price">€6.95</span></span>
        </div>
    </div>
    <div class="table-top-qty">
        <fieldset class="add-to-cart-box">
            <input type="hidden" name="products[]" value="1"> <legend>Add Items to Cart</legend> <span class="qty-box"><label for="qty1">Qty:</label> <input name="qty1" disabled="disabled" value="0" type="text" class="input-text qty" id="qty1" maxlength="12"></span>
        </fieldset>
    </div>
    <div class="table-top-details">
        <input type="checkbox" name="buyMe" value="buy" class="add-checkbox">
    </div>

    <div style="clear:both;"></div>
</div> 
```

这是我尝试过的javascript

```
jQuery(document).ready(function() {
    console.log('hello');

    var thischeck;
    jQuery(".table-products").ready(function(e) {
        //var catTable = jQuery(this);
        var qtyInput = jQuery(this).children('.input-text');

        jQuery('.add-checkbox').click(function() {
            console.log(jQuery(this).html());
            thischeck = jQuery(this);
            if (thischeck.is(':checked'))
            {
                jQuery(qtyInput).first().val('1');
                jQuery(qtyInput).first().prop('disabled', false);
            } else {

                }

        });

    });
    // Handler for .ready() called.
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:52:21.420

采用

```
jQuery('.add-checkbox').change(function() { 
```

问题是您观察到单击而不是更改的一方面，因此请使用更改，因为它确实在状态更改后触发

```
var qtyInput = jQuery(this).children('.input-text'); 
```

另一件事是输入不是 .table-products 的直接子级

看到这个[小提琴](http://jsfiddle.net/smxVg/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:52:44.017

不是最直接的方法，但这应该有效。

```
jQuery(document).ready(function() {
   jQuery('.add-checkbox').on('click', function() {
      jQuery(this)
         .parents('.table-products')
         .find('input.input-text')
         .val('1')
         .removeAttr('disabled');
   });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:59:45.673

```
 jQuery('input:checkbox.add-checkbox').on('change', function() {
        jQuery(this)
            .parent()
            .prev('div.table-top-qty')
            .find('fieldset input:disabled.qty')
            .val(this.checked | 0)
            .attr('disabled', !this.checked);
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T19:22:51.093

这应该让您朝着正确的方向开始。基于 jQuery 1.7.2（我看到了你的 prop 调用，我猜这就是你正在使用的）。

```
$(document).ready(function() {

    var thischeck;
    $('.table-products').on('click', '.add-checkbox', function() {

        var qtyInput = $(this).parents('.table-products').find('.input-text');
        thischeck = $(this);
        if (thischeck.prop('checked')) {
            $(qtyInput).val('1').prop('disabled', false);
        } else {
            $(qtyInput).val('0').prop('disabled', true);
        }

    });
}); 
```

出于某种原因删除该属性往往会阻止它被重新添加。这适用于多个表。对于您的冲突，只需将 $ 替换为 jQuery。

这是小提琴：http: [//jsfiddle.net/KqtS7/5/](http://jsfiddle.net/KqtS7/5/)

# image - 如何在 TImage 或任何东西上制作水效果？

> ID：10234727
> 
> 赞同：25
> 
> 时间：2012-04-19T18:44:49.210
> 
> 标签：image, delphi, effect

好的，我刚刚在我的电脑上安装了一个 Tortoise git。我对它关于页面的水效果很感兴趣。

![在此处输入图像描述](../Images/28e755b53e780b87ef57c51608cf0ee7.png)

尝试将鼠标光标移动到来自 tortoise GIT 的海龟图片上 - 关于

更像是我们在玩水。

有谁知道如何在 Delphi 中制作那种水效果？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-19T19:23:47.063

请参阅 efg 实验室的 Leonel Togniolli 的[“水效应”](http://www.efg2.com/Lab/Library/Delphi/Algorithms/index.html#Waves)。

![在此处输入图像描述](../Images/f2727134bb92f597cbbd97de581366ca.png)

涟漪效果基于[1999 年 12 月 Game Developer Magazine 文章中的 2D Water Effects](http://www.darwin3d.com/gdm1999.htm) 。

该算法在此处[2D Water](http://freespace.virgin.net/hugo.elias/graphics/x_water.htm)中进行了描述，正如 François 所提到的，并且作为源代码中的参考。

Leonel 的实现部分基于 Roy Willemse 解释的 gamedev 文章[the-water-effect-explained](http://www.gamedev.net/page/resources/_/technical/graphics-programming-and-theory/the-water-effect-explained-r915)。这里也是帕斯卡代码。

efg 的另一个 Delphi 示例名为“Ripple Project”，屏幕截图如下所示。

![在此处输入图像描述](../Images/ba16ac57667d3cd08ffc535af2f54da8.png)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-10T18:50:28.097

请执行以下操作： 01\. 创建一个名为“WaterEffect.pas”的 Delphi 单元并粘贴以下代码：

```
unit WaterEffect;

interface

uses
  Winapi.Windows, System.SysUtils, Vcl.Graphics, Math;

const
  DampingConstant = 15;

type
  PIntArray = ^TIntArray;
  TIntArray = array[0..16777215] of Integer;
  PPIntArray = ^TPIntArray;
  TPIntArray = array[0..16777215] of PIntArray;
  PRGBArray = ^TRGBArray;
  TRGBArray = array[0..16777215] of TRGBTriple;
  PPRGBArray = ^TPRGBArray;
  TPRGBArray = array[0..16777215] of PRGBArray;
  TWaterDamping = 1..99;
  TWaterEffect = class(TObject)

  private
    { Private declarations }
    FrameWidth: Integer;
    FrameHeight: Integer;
    FrameBuffer01: Pointer;
    FrameBuffer02: Pointer;
    FrameLightModifier: Integer;
    FrameScanLine01: PPIntArray;
    FrameScanLine02: PPIntArray;
    FrameScanLineScreen: PPRGBArray;
    FrameDamping: TWaterDamping;
    procedure SetDamping(Value: TWaterDamping);

  protected
    { Protected declarations }
    procedure CalculateWater;
    procedure DrawWater(ALightModifier: Integer; Screen, Distance: TBitmap);

  public
    { Public declarations }
    constructor Create;
    destructor Destroy; override;
    procedure ClearWater;
    procedure SetSize(EffectBackgroundWidth, EffectBackgroundHeight: Integer);
    procedure Render(Screen, Distance: TBitmap);
    procedure Bubble(X, Y: Integer; BubbleRadius, EffectBackgroundHeight: Integer);
    property Damping: TWaterDamping read FrameDamping write SetDamping;
  end;

implementation

{ TWaterEffect }

const
  RandomConstant = $7FFF;

procedure TWaterEffect.Bubble(X, Y: Integer; BubbleRadius, EffectBackgroundHeight: Integer);
var
Rquad: Integer;
CX, CY, CYQ: Integer;
Left, Top, Right, Bottom: Integer;
begin
  if (X < 0) or (X > FrameWidth - 1) then X := 1 + BubbleRadius + Random(RandomConstant) mod (FrameWidth - 2 * BubbleRadius - 1);
  if (Y < 0) or (Y > FrameHeight - 1) then Y := 1 + BubbleRadius + Random(RandomConstant) mod (FrameHeight - 2 * BubbleRadius - 1);
  Left := -Min(X, BubbleRadius);
  Right := Min(FrameWidth - 1 - X, BubbleRadius);
  Top := -Min(Y, BubbleRadius);
  Bottom := Min(FrameHeight - 1 - Y, BubbleRadius);
  Rquad := BubbleRadius * BubbleRadius;
  for CY := Top to Bottom do
    begin
      CYQ := CY * CY;
        for CX := Left to Right do
          begin
            if (CX * CX + CYQ <= Rquad) then
              begin
                Inc(FrameScanLine01[CY + Y][CX + X], EffectBackgroundHeight);
              end;
          end;
    end;
end;

procedure TWaterEffect.CalculateWater;
var
X, Y, XL, XR: Integer;
NewH: Integer;
P1, P2, P3, P4: PIntArray;
PT: Pointer;
Rate: Integer;
begin
  Rate := (100 - FrameDamping) * 256 div 100;
  for Y := 0 to FrameHeight - 1 do
    begin
      P1 := FrameScanLine02[Y];
      P2 := FrameScanLine01[Max(Y - 1, 0)];
      P3 := FrameScanLine01[Y];
      P4 := FrameScanLine01[Min(Y + 1, FrameHeight - 1)];
      for X := 0 to FrameWidth - 1 do
        begin
          XL := Max(X - 1, 0);
          XR := Min(X + 1, FrameWidth - 1);
          NewH := (P2[XL] + P2[X] + P2[XR] + P3[XL] + P3[XR] + P4[XL] + P4[X] +
          P4[XR]) div 4 - P1[X];
          P1[X] := NewH * Rate div 256;
        end;
    end;
  PT := FrameBuffer01;
  FrameBuffer01 := FrameBuffer02;
  FrameBuffer02 := PT;
  PT := FrameScanLine01;
  FrameScanLine01 := FrameScanLine02;
  FrameScanLine02 := PT;
end;

procedure TWaterEffect.ClearWater;
begin
  if FrameBuffer01 <> nil then ZeroMemory(FrameBuffer01, (FrameWidth * FrameHeight) * SizeOf(Integer));
  if FrameBuffer02 <> nil then ZeroMemory(FrameBuffer02, (FrameWidth * FrameHeight) * SizeOf(Integer));
end;

constructor TWaterEffect.Create;
begin
  inherited;
  FrameLightModifier := 10;
  FrameDamping := DampingConstant;
end;

destructor TWaterEffect.Destroy;
begin
  if FrameBuffer01 <> nil then FreeMem(FrameBuffer01);
  if FrameBuffer02 <> nil then FreeMem(FrameBuffer02);
  if FrameScanLine01 <> nil then FreeMem(FrameScanLine01);
  if FrameScanLine02 <> nil then FreeMem(FrameScanLine02);
  if FrameScanLineScreen <> nil then FreeMem(FrameScanLineScreen);
  inherited;
end;

procedure TWaterEffect.DrawWater(ALightModifier: Integer; Screen, Distance:
  TBitmap);
var
DX, DY: Integer;
I, C, X, Y: Integer;
P1, P2, P3: PIntArray;
PScreen, PDistance: PRGBArray;
PScreenDot, PDistanceDot: PRGBTriple;
BytesPerLine1, BytesPerLine2: Integer;
begin
  Screen.PixelFormat := pf24bit;
  Distance.PixelFormat := pf24bit;
  FrameScanLineScreen[0] := Screen.ScanLine[0];
  BytesPerLine1 := Integer(Screen.ScanLine[1]) - Integer(FrameScanLineScreen[0]);
  for I := 1 to FrameHeight - 1 do FrameScanLineScreen[i] := PRGBArray(Integer(FrameScanLineScreen[i - 1]) + BytesPerLine1);
    begin
      PDistance := Distance.ScanLine[0];
      BytesPerLine2 := Integer(Distance.ScanLine[1]) - Integer(PDistance);
      for Y := 0 to FrameHeight - 1 do
        begin
          PScreen := FrameScanLineScreen[Y];
          P1 := FrameScanLine01[Max(Y - 1, 0)];
          P2 := FrameScanLine01[Y];
          P3 := FrameScanLine01[Min(Y + 1, FrameHeight - 1)];
          for X := 0 to FrameWidth - 1 do
            begin
              DX := P2[Max(X - 1, 0)] - P2[Min(X + 1, FrameWidth - 1)];
              DY := P1[X] - P3[X];
              if (X + DX >= 0) and (X + DX < FrameWidth) and (Y + DY >= 0) and (Y + DY < FrameHeight) then
                begin
                  PScreenDot := @FrameScanLineScreen[Y + DY][X + DX];
                  PDistanceDot := @PDistance[X];
                  C := PScreenDot.rgbtBlue - DX;
                  if C < 0 then PDistanceDot.rgbtBlue := 0 else if C > 255 then PDistanceDot.rgbtBlue := 255 else
                    begin
                      PDistanceDot.rgbtBlue := C;
                      C := PScreenDot.rgbtGreen - DX;
                    end;
                  if C < 0 then PDistanceDot.rgbtGreen := 0 else if C > 255 then PDistanceDot.rgbtGreen := 255 else
                    begin
                      PDistanceDot.rgbtGreen := C;
                      C := PScreenDot.rgbtRed - DX;
                    end;
                  if C < 0 then PDistanceDot.rgbtRed := 0 else if C > 255 then PDistanceDot.rgbtRed := 255 else
                    begin
                      PDistanceDot.rgbtRed := C;
                    end;
                end
              else
                begin
                  PDistance[X] := PScreen[X];
                end;
            end;
          PDistance := PRGBArray(Integer(PDistance) + BytesPerLine2);
        end;
    end;
end;

procedure TWaterEffect.Render(Screen, Distance: TBitmap);
begin
  CalculateWater;
  DrawWater(FrameLightModifier, Screen, Distance);
end;

procedure TWaterEffect.SetDamping(Value: TWaterDamping);
begin
  if (Value >= Low(TWaterDamping)) and (Value <= High(TWaterDamping)) then FrameDamping := Value;
end;

procedure TWaterEffect.SetSize(EffectBackgroundWidth, EffectBackgroundHeight: Integer);
var
I: Integer;
begin
  if (EffectBackgroundWidth <= 0) or (EffectBackgroundHeight <= 0) then
    begin
      EffectBackgroundWidth := 0;
      EffectBackgroundHeight := 0;
    end;
  FrameWidth := EffectBackgroundWidth;
  FrameHeight := EffectBackgroundHeight;
  ReallocMem(FrameBuffer01, FrameWidth * FrameHeight * SizeOf(Integer));
  ReallocMem(FrameBuffer02, FrameWidth * FrameHeight * SizeOf(Integer));
  ReallocMem(FrameScanLine01, FrameHeight * SizeOf(PIntArray));
  ReallocMem(FrameScanLine02, FrameHeight * SizeOf(PIntArray));
  ReallocMem(FrameScanLineScreen, FrameHeight * SizeOf(PRGBArray));
  ClearWater;
  if FrameHeight > 0 then
    begin
      FrameScanLine01[0] := FrameBuffer01;
      FrameScanLine02[0] := FrameBuffer02;
      for I := 1 to FrameHeight - 1 do
        begin
          FrameScanLine01[I] := @FrameScanLine01[I - 1][FrameWidth];
          FrameScanLine02[I] := @FrameScanLine02[I - 1][FrameWidth];
        end;
    end;
end;

end. 
```

1.  在“用途”中添加“WaterEffect”。
2.  添加一个带有“Enable”属性和“Interval=25”的“Timer”。
3.  在“私人声明”中添加“水：TWaterEffect；” 和“FrameBackground：TBitmap；”。
4.  定义“var X:Integer;”
5.  定义以下

> ```
> procedure TMainForm.FormCreate(Sender: TObject);
> begin
>   Timer01.Enabled := true;
>   FrameBackground := TBitmap.Create;
>   FrameBackground.Assign(Image01.Picture.Graphic);
>   Image01.Picture.Graphic := nil;
>   Image01.Picture.Bitmap.Height := FrameBackground.Height;
>   Image01.Picture.Bitmap.Width := FrameBackground.Width;
>   Water := TWaterEffect.Create;
>   Water.SetSize(FrameBackground.Width,FrameBackground.Height);
>   X:=Image01.Height;
> end;
> 
> procedure TMainForm.FormDestroy(Sender: TObject);
> begin
>   FrameBackground.Free;
>   Water.Free;
> end;
> 
> procedure TMainForm.Image01MouseDown(Sender: TObject; Button: TMouseButton;
>   Shift: TShiftState; X, Y: Integer);
> begin
>   Water.Bubble(X,Y,1,100);
> end;
> 
> procedure TMainForm.Image01MouseMove(Sender: TObject; Shift: TShiftState; X,
>   Y: Integer);
> begin
>   Water.Bubble(X,Y,1,100);
> end;
> 
> procedure TMainForm.Timer01Timer(Sender: TObject);
> begin
>   if Random(8)= 1 then
>     Water.Bubble(-1,-1,Random(1)+1,Random(500)+50);
>     Water.Render(FrameBackground,Image01.Picture.Bitmap);
>   with Image01.Canvas do
>     begin
>       Brush.Style:=bsClear;
>       font.size:=12;
>       Font.Style:=[];
>       Font.Name := 'Comic Sans MS';
>       font.color:=$e4e4e4;
>       Textout(190, 30, DateTimeToStr(Now));
>     end;
> end; 
> ```

现在编译。我想你会得到所需的效果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-19T19:00:34.517

这种效果是通过对图像应用某些数值变换来产生的。它们在`CWaterEffect`类中定义，您可以在[WaterEffect.cpp*源*文件](http://code.google.com/p/tortoisegit/source/browse/src/Utils/MiscUI/WaterEffect.cpp)中自行检查。

# windbg - 转储中的进程信息

> ID：10234733
> 
> 赞同：3
> 
> 时间：2012-04-19T18:44:56.713
> 
> 标签：windbg, crash-dumps, sos

我了解到， windbg 中的**.tlist**命令会在创建故障转储时转储系统中运行的所有进程。

我想查看每个进程的**内存信息**。这样它将帮助我查看系​​统是否因任何特定进程而过载。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T20:43:33.047

`!process 0 1`将列出所有进程并显示每个进程的内存相关信息。我使用 livekd 发出了这个命令并获得了所有进程。这是我的 chrome 进程（我从输出中挑选出来的）：

```
PROCESS fffffa8007cb4200
SessionId: 1  Cid: 1158    Peb: 7efdf000  ParentCid: 0ff8
DirBase: 1b7962000  ObjectTable: fffff8a00addb010  HandleCount: 135.
Image: chrome.exe
VadRoot fffffa80090a6f80 Vads 169 Clone 0 Private 4037\. Modified 3702\. Locked 0.
DeviceMap 0000000000000000
Token                             fffff8a0091f9120
ElapsedTime                       00:05:49.161
UserTime                          00:00:00.000
KernelTime                        00:00:00.000
QuotaPoolUsage[PagedPool]         0
QuotaPoolUsage[NonPagedPool]      0
Working Set Sizes (now,min,max)  (8020, 50, 345) (32080KB, 200KB, 1380KB)
PeakWorkingSetSize                10137
VirtualSize                       144 Mb
PeakVirtualSize                   151 Mb
PageFaultCount                    66631
MemoryPriority                    BACKGROUND
BasePriority                      8
CommitCharge                      5784
Job                               fffffa8009822e30 
```

请注意与内存相关的属性，例如“工作集大小”、“虚拟大小”等。

附言。适用于 livekd 和系统内存转储（我相信这就是 livekd 所做的）。

马克

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-20T01:25:59.673

此信息不包含在进程转储中。`.tlist`查询您当前的系统，而不是进行转储时的状态。如果您可以进行系统转储，则可以检查进程及其内存使用情况，正如 Marc Sherman 已经回答的那样。

# r - 将带有 dimnames 的矩阵转换为长格式 data.frame

> ID：10234734
> 
> 赞同：15
> 
> 时间：2012-04-19T18:44:57.713
> 
> 标签：r, dataframe, transformation, data.table, reshape

希望这里有一个简单的答案，但我在任何地方都找不到。

我有一个带有行名和列名的数字矩阵：

```
#      1    2    3    4
# a    6    7    8    9
# b    8    7    5    7
# c    8    5    4    1
# d    1    6    3    2 
```

我想将矩阵融合为长格式，一列中的值和矩阵行和列名各在一列中。结果可能是这样`data.table`的：`data.frame`

```
#  col  row  value
#    1    a      6
#    1    b      8
#    1    c      8
#    1    d      1
#    2    a      7
#    2    c      5
#    2    d      6
    ... 
```

任何提示表示赞赏。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-19T18:51:14.757

`melt`从 reshape2使用：

```
library(reshape2)
#Fake data
x <- matrix(1:12, ncol = 3)
colnames(x) <- letters[1:3]
rownames(x) <- 1:4
x.m <- melt(x)
x.m

   Var1 Var2 value
1     1    a     1
2     2    a     2
3     3    a     3
4     4    a     4
... 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-04-19T19:44:48.573

和函数一起执行此操作`as.table`：`as.data.frame`

```
> m <- matrix( sample(1:12), nrow=4 )
> dimnames(m) <- list( One=letters[1:4], Two=LETTERS[1:3] )
> as.data.frame( as.table(m) )
   One Two Freq
1    a   A    7
2    b   A    2
3    c   A    1
4    d   A    5
5    a   B    9
6    b   B    6
7    c   B    8
8    d   B   10
9    a   C   11
10   b   C   12
11   c   C    3
12   d   C    4 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-19T19:00:03.323

假设'm'是你的矩阵......

```
data.frame(col = rep(colnames(m), each = nrow(m)), 
           row = rep(rownames(m), ncol(m)), 
           value = as.vector(m)) 
```

这在大型矩阵上执行得非常快，并且还向您展示了一些关于如何制作矩阵、如何访问其中的内容以及如何构建自己的向量的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-21T13:01:06.590

不需要您了解任何有关存储结构的修改，并且如果您使用`dimnames`, 和`slice.index`函数，它可以轻松扩展到高维数组：

```
data.frame(row=rownames(m)[as.vector(row(m))],
           col=colnames(m)[as.vector(col(m))],
           value=as.vector(m)) 
```

# asp.net-mvc - 如何使用路由和/或查询字符串数据开始我的页面？

> ID：10234737
> 
> 赞同：0
> 
> 时间：2012-04-19T18:45:05.370
> 
> 标签：asp.net-mvc, asp.net-mvc-3, routes, query-string, asp.net-mvc-routing

当我的页面首次加载时，URL 如下所示：[http://localhost:1245/](http://localhost:1245/)。但是，我希望它看起来像这样：[http://localhost:1245/Home/Index/2/2012?Events=Show](http://localhost:1245/Home/Index/2/2012?Events=Show)（/2/2012?Events=Show 是重要的部分）。如何让我的页面从一开始就加载第二个 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:17:56.097

我要做的是在默认 MVC 路由之前添加一个新路由，所以它看起来像：

```
routes.MapRoute(
  "NewDefault", // Route name
  "{controller}/{action}/{month}/{year}", // URL with parameters
  new { controller = "Events", 
        action = "Shows", 
        month = DateTime.Now.Month,
        year = DateTime.Now.Year } // Parameter defaults
  );

routes.MapRoute(
  "Default", // Route name
  "{controller}/{action}/{id}", // URL with parameters
  new { controller = "Home", 
        action = "Index", 
        id = UrlParameter.Optional } // Parameter defaults
  ); 
```

默认 URL（特别是对用户不可见）将是`/Events/Shows/4/2012`（如果日期是`4/19/2012`）。默认控制器是`EventsController`，默认操作是`EventsController.Shows`.

```
public EventsController
{
  public ActionResult Shows(int month, int year)
  {
    someModel model = new someModel();
    someModel.month = month;
    someModel.year = year;
    this.View(someModel);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T19:25:47.130

添加：

```
 routes.MapRoute("MyRouteName", 
    "Home/Index/2/2012", new { controller = "Home", action = "Index" }); 
```

到您的路线。

将 HomeController 的 Index 操作更改为具有以下签名：

```
public ActionResult Index(string Events).... 
```

# vb.net - VB.NET 相当于 C# 的 default 关键字是什么？

> ID：10234744
> 
> 赞同：5
> 
> 时间：2012-04-19T18:45:22.860
> 
> 标签：vb.net, default, nullable, dbnull, ternary

> **可能重复：**
> [错误？？如果您通过三元运算符将值分配给可为空的整数，则它不能变为空](https://stackoverflow.com/questions/7181493/bug-if-you-assign-a-value-to-a-nullable-integer-via-a-ternary-operator-it-can)

虽然这个问题似乎与许多问题重复，但实际上是出于特定原因而提出的。以这段代码为例：

```
Dim n As Integer? = If(True, Nothing, 1) 
```

在该代码中，三元表达式*应该*返回 Nothing，但它将 n 设置为 0。如果这是 C#，我可以说它`default(int?)`会完美运行。现在看起来我将不得不放弃三元并使用常规的 If 块，但我真的想使用三元。

如果没有什么是真正的 VB.NET 等效于 C# 的默认值，你如何解释这种行为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T18:46:16.747

与 C# 等效的[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)`default`是关键字`Nothing`. 只要`Id.Value`返回一个`Integer`值，您编写的代码就应该编译得很好。

您更新的样本出错的原因是`Nothing`. 在 VB.NET`Nothing`中是空值，它可以转换为任何类型。现在对于一个`If`表达式，编译器必须推断返回的类型应该是什么，它通过查看两个值参数来做到这一点。

该值`Nothing`没有类型，但文字`1`有类型`Integer`。`Nothing`可转换为，`Integer`因此编译器确定`Integer`是此处的最佳类型。这意味着当`Nothing`被选为值时，它将被解释为`Integer`而不是`Integer?`。

解决此问题的最简单方法是明确告诉编译器您希望`1`被视为`Integer?`.

```
Dim n As Integer? = If(True, Nothing, CType(1, Integer?)) 
```

# ios - 围绕锚点旋转精灵

> ID：10234746
> 
> 赞同：0
> 
> 时间：2012-04-19T18:45:24.817
> 
> 标签：ios, animation, cocos2d-iphone, rotation, sprite

我有一个精灵：

```
ombreoeuf1 = [CCSprite spriteWithFile:@"mangeurcentremieu3_03.png" ];
ombreoeuf1.position = ccp(240,160);
[self addChild:ombreoeuf1]; 
```

我想不断地围绕一个锚点旋转它。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T04:46:13.527

您可以先通过设置属性来设置锚点`anchorPoint`，例如：

```
[ombreoeuf1 setAnchorPoint:ccp(0,0)] 
```

然后通过设置另一个属性来设置旋转（以度为单位）`rotation`：

```
[ombreoeuf1 setRotation:90] 
```

`anchorPoint`并且`rotation`都是[CCNode 类](http://www.cocos2d-iphone.org/api-ref/latest-stable/interface_c_c_node.html)的属性，它是 CCSprite 的父类。

**更新**

根据您的评论，您似乎想要的是一个永不停止的旋转精灵？这是一个让精灵每 0.1 秒旋转 10 度的示例：

```
[sprite runAction:[CCRepeatForever actionWithAction:[CCRotateBy actionWithDuration:0.1 angle:10]]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T08:45:45.360

CCNode 子类的所有变换都是相对于锚点进行的。在所有转换过程中，anchorPoint 将具有相同的位置。例如，如果您将带有anchorPoint (0.f, 0.f) 的精灵放置到屏幕左下角的位置(0.f, 0.f)，然后设置它的比例，例如， 5.f，变形后会停留在左下角，只是会变大。所以所有的旋转都会自动相对于锚点进行。

还有一件事。CCSprite 默认具有 anchorPoint (0.5f, 0.5f) 和一些内容大小，因此您只需将其设置为另一个即可查看转换的变化。如果你想用 CCNode 来做，你必须将它的 relativeToAnchorPoint 属性设置为 YES 并手动设置 contentSize。

您可以为此使用 CCRepeatForever 操作。例如，

```
id rotateAction = [CCRepeatForever actionWithAction:[CCRotateBy actionWithDuration: yourDuration 
                                                                             angle: anyAngleForGivenTime]]; 
```

# jquery - jQuery方法来点击图片/标题或 去网址

> ID：10234747
> 
> 赞同：0
> 
> 时间：2012-04-19T18:45:35.123
> 
> 标签：jquery

我想使用图像滑块插件（Elastislide）作为菜单。问题是它`<a href="#">`用作函数，不能用作链接。我试过了。所以，我正在寻找一个 jQuery 解决方案来使用图像/标题或 a`<li>`作为伪链接。

这些页面都是本地的，所以我不需要去另一个域，只需在同一目录中的另一个页面。这是 HTML 的示例

```
 <div id="carousel" class="es-carousel-wrapper">

        <div class="es-carousel">

        <ul>

    <li value="another_page.php"><a href="#"><img src="images/small/1.jpg" alt="image01" /></a></li>
    <li value="yet_another.php"><a href="#"><img src="images/small/2.jpg" alt="image02" /></a></li>
    <li value="still_another.php"><a href="#"><img src="images/small/3.jpg" alt="image03" /></a></li>
    <li value="last_one.php"><a href="#"><img src="images/small/4.jpg" alt="image04" /></a></li>

</ul>
</div>
</div> 
```

我添加了从另一篇文章中获取线索的价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:49:27.450

如果您可以为 each 添加一个类`li`，则可以轻松引用该类并执行以下操作：

```
$(".li-class").on("click", function(e) {
    $("#IDofSomeLoadAreaDiv").empty().load($(this).attr("value"));
}); 
```

您可能需要更改这些值中的链接以表示整个链接，而不仅仅是部分链接

此外，如果您添加了类似[myURL Extension](http://spyk3lc.blogspot.com/2012/03/jquery-myurl-extension-how-to-get-that.html)的内容，您可以执行以下操作：

```
$(".li-class").on("click" function(e) {
    $("#IDofSomeLoadAreaDiv").empty().load($.myURL("index", $(this).attr("value")));
});
// and this would eliminate the need to assure correct full link in each li, 
// as it would call your base site url, add index.php to it and then add 
// the link in your li.value 
```

如果您不想将视图部分加载到当前页面中，看来我可能误读了这个问题。换句话说，如果您想用新链接“刷新”页面，请执行以下操作：

```
$(".li-class").on("click", function(e) {
    window.location = $(this).attr("value");
});
// or with myURL extension if you want
$(".li-class").on("click" function(e) {
    window.location = $.myURL("index", $(this).attr("value"));
}); 
```

还！如果你想在新窗口中打开它，我也有一个简单的 jQuery 扩展（[参见 jsFiddle Here](http://jsfiddle.net/SpYk3/9NS5K/)，在长注释行之间复制 js 代码），它可以让它变得简单：

```
$(".li-class").on("click" function(e) {
    $.winOpen($.myURL("index", $(this).attr("value")), "windowName", { fullscreen: "no", height: "600px", toolbar: 1, width: 600 });
}); 
```

> 大更新：小提琴帮助，帮助了解你在哪里使用旧的 jQuery

使用该版本的 jQuery，您没有 .on，您也可以在不实际添加插件的情况下尝试使用 myURL 插件。我在[***这里重新创建了你的小提琴的工作版本***](http://jsfiddle.net/SpYk3/HsD2D/)

如果您想使用该插件，您需要将其添加到您的标题或为其创建一个 js 文件并将其链接到您的标题中，就像任何其他 jquery 插件一样，如果没有，您可以直接创建链接，如图所示在前面的例子中。

> 更多更新：发现该版本的 jQuery 不支持元素中的任何属性（又名“值”）的问题。更改`<li value="`为`<li href="`并在 javascript 调用中对其进行了修正。

此外，要在没有 myURL 插件的情况下进行位置调用，您可以简单地替换：

```
window.location = $.myURL("index", $(this).attr("value")); 
```

和

```
window.location = $(this).attr("value"); 
```

但是，请记住，这意味着确保您在每个 li 的 href attr 上都有完整的站点 url

# php - Mysql插入期间缺少部分字符串

> ID：10234750
> 
> 赞同：0
> 
> 时间：2012-04-19T18:45:59.487
> 
> 标签：php, mysql

所以也许我现在只是愚蠢或疲倦，我错过了明显的或其他的，但为什么这个 mysql 插入在双引号 (")> 处切断字符串

发布字段的内容是：这是我的文字“报价”

```
$gpCaption = mysql_real_escape_string ($_POST['gpCaption']);

$sql = "INSERT INTO galleriesphotos SET gpID = '$gpID', gID = '$gID', gpCaption = '".$gpCaption."'";
$rows = $db->query($sql);
} 
```

只有这个被插入到 mysql 中：It\'s my text \

其余的发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:58:37.257

你确定是剪？如果 $_POST['gpCaption'] 是 =

> 这是我的文字“报价”

这个转义结果是：

> $gpCaption = mysql_real_escape_string ($_POST['gpCaption']);

```
It\'s my text \"quote\" 
```

当我将它插入表格时，我可以看到它没有截止：

> 标识字段
> 
> 1 这是我的文字“报价”

这是sql小提琴测试：

[http://sqlfiddle.com/#!2/e5059/1](http://sqlfiddle.com/#!2/e5059/1)

# android - 是否建议使用片段构建所有应用程序？

> ID：10234755
> 
> 赞同：2
> 
> 时间：2012-04-19T18:46:13.213
> 
> 标签：android, android-fragments

在现代 Android 开发中，是否建议完全转向 Fragment-like 开发？

使用 Fragment 构建手机和平板电脑应用程序，而不区分单独活动和活动+片段应用程序？

谷歌 Android 团队有没有完全迁移到“碎片”或不完全迁移的官方建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T19:39:29.733

您不必使用片段进行开发，但如果您想为尽可能多的消费者/设备提供最佳环境，那么您应该切换到片段。但是，如果您真的认为 Fragment 是魔鬼的工作，您可以坚持仅基于 Activity 的开发并提供一个看起来很草率的 UI。

就谷歌的感受而言，我认为这总结了——

> 通过 ActivityGroup 嵌入 Activity 是一个好主意，但一直很难处理，因为 Activity 被设计为独立的自包含组件，而不是与其他 Activity 密切交互。Fragment API 是一个更好的解决方案，应该被视为嵌入式活动的替代品。

有关片段使用的更多信息，请查看[此处](http://developer.android.com/guide/topics/fundamentals/fragments.html)，有关设计理念的更多信息，请查看[此帖子](http://android-developers.blogspot.com/2011/02/android-30-fragments-api.html)。

# cakephp - CakePHP 2.1 Auth->login() 不起作用，但添加用户可以

> ID：10234757
> 
> 赞同：4
> 
> 时间：2012-04-19T18:46:18.613
> 
> 标签：cakephp, cakephp-2.1

我已经在 stackoverflow 上搜索了许多帖子以寻找答案，并且可能我只是忽略了一些东西，但我似乎无法让 $this->Auth->login() 工作。我从其他帖子中尝试了许多不同的建议。在描述我尝试过的其他方法时，我会尽量做到彻底。

我确实添加了一个正在工作的用户。MD5 散列工作正常。我对密码进行了哈希处理，然后使用奇迹沙拉 md5 [http://www.miraclesalad.com/webtools/md5.php检查了它](http://www.miraclesalad.com/webtools/md5.php)

我不使用盐进行散列。我使用不加盐的 MD5。

我使用的数据库是 Postgresql 9.0。我知道一些 CakePhp 魔法并不适用于所有数据库（或者有人告诉我）。

### **应用程序/配置/core.php**

```
Configure::write('Security.level', 'medium');

/**
* A random string used in security hashing methods.
*/

    Configure::write('Security.salt', ''); 
```

我正在使用 Auth->fields 将密码映射到数据库中的 user_password 和用户名到 user_name。user_password 和 user_name 是 core_users 表中的列。我也有 beforeFilter() 方法。

```
$this->Auth->fields = array('username' => 'user_name', 'password' => 'user_password'); 
```

### **应用程序/控制器/AppController.php**

```
class AppController extends Controller {
public $components = array(
    'Session',
    'Auth' => array(
        'loginRedirect' => array('controller' => 'pages', 'action' => 'index'),
        'logoutRedirect' => array('controller' => 'pages', 'action' => 'display', 'home'),
        'loginAction' => array('admin' => false, 'controller' => 'CoreUsers', 'action' => 'login'),
        /*'fields' => array('password' => 'user_password', 'username' => 'user_name'),*/
        'userModel' => 'CoreUser'
    )
);

public function beforeFilter() {
    Security::setHash('md5');
    $this->Auth->allow('login');
    //debug($this->Auth);
} 
} 
```

我留下了调试，这样你就可以看到它们的处理顺序，我将向你展示它们是如何打印的。

### **应用程序/控制器/CoreUsersController.php**

```
 public function login() {
    Security::setHash('md5');
    //debug($this->Auth);

    if ($this->request->is('post')) {
        debug(Security::hash($this->Auth->request->data['CoreUser']['user_password']));
        debug($this->Auth);
        debug(Configure::version());
        debug($this->Auth->request->data['CoreUser']['user_password']);
        debug($this->Auth->request->data['CoreUser']['user_name']);
        if ($this->Auth->login()) {
            debug($this->Auth->request->data['CoreUser']['user_password']);
            $this->redirect($this->Auth->redirect());

        } else {
            debug($this->Auth->request->data['CoreUser']['user_password']);
            $this->Session->setFlash(__('Invalid username or password, try again'));
        }
    }
}
public function logout() {
    $this->redirect($this->Auth->logout());
} 
```

### **应用程序/模型/CoreUser.php**

```
 App::uses('AuthComponent', 'Controller/Component');
class CoreUser extends AppModel{
public $primaryKey = 'user_id';
public $sequence = 'core_user_id_seq';
public $name = 'CoreUser';
public $validate = array(
    'user_name' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => 'User name is required'
        )
    ),
    'user_password' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => 'Password is required'
        )
    ),
    'privilege_id' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => 'Privilege ID is required'
        ),
        'legalValues' => array(
             'rule' => array('between',1,4),
            'message' => 'Privilege must be between 1 and 4'
        )
    ),
    'user_initial' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => 'User initials is required'
        )
    ),
    'email' => array(
        'rule' => array('email',true),
        'message' => 'Email must have an \'@\' symbol and a domain e.g. .com' 
    )
);

public function beforeSave() {
    Security::setHash('md5');
    if (isset($this->data[$this->alias]['user_password'])) {
        $this->data[$this->alias]['user_password'] = AuthComponent::password($this->data[$this->alias]['user_password']);
    }
    return true;
}
} 
```

### **应用程序/视图/CoreUsers/login.ctp**

```
<h3>Login</h3>

<div class="users form">
<?php echo $this->Session->flash('auth'); ?>
<?php echo $this->Form->create('CoreUser');?>
<fieldset>
    <legend><?php echo __('Please enter your username and password'); ?></legend>
<?php
    echo $this->Form->input('user_name');
    echo $this->Form->input('user_password');
?>
</fieldset>
<?php echo $this->Form->end(__('Login'));?>
</div> 
```

### **调试输出**

所有这些都来自 CoreUsersController 并按照处理它们的顺序进行。

### 哈希密码。当我添加用户时，这与数据库中的内容相同。

```
'098f6bcd4621d373cade4e832627b4f6' 
```

### 身份验证对象

```
object(AuthComponent) {
components => array(
    (int) 0 => 'Session',
    (int) 1 => 'RequestHandler'
)
authenticate => array(
    (int) 0 => 'Form'
)
authorize => false
ajaxLogin => null
flash => array(
    'element' => 'default',
    'key' => 'auth',
    'params' => array()
)
loginAction => array(
    'admin' => false,
    'controller' => 'CoreUsers',
    'action' => 'login'
)
loginRedirect => array(
    'controller' => 'pages',
    'action' => 'index'
)
logoutRedirect => array(
    'controller' => 'pages',
    'action' => 'display',
    (int) 0 => 'home'
)
authError => 'You are not authorized to access that location.'
allowedActions => array(
    (int) 0 => 'login'
)
request => object(CakeRequest) {
    params => array(
        'plugin' => null,
        'controller' => 'CoreUsers',
        'action' => 'login',
        'named' => array(),
        'pass' => array()
    )
    data => array(
        'CoreUser' => array(
            'user_name' => 'testy5',
            'user_password' => 'test'
        )
    )
    query => array()
    url => 'CoreUsers/login'
    base => '/cpm_v2_dev'
    webroot => '/cpm_v2_dev/'
    here => '/cpm_v2_dev/CoreUsers/login'
}
response => object(CakeResponse) {

}
settings => array(
    'loginRedirect' => array(
        'controller' => 'pages',
        'action' => 'index'
    ),
    'logoutRedirect' => array(
        'controller' => 'pages',
        'action' => 'display',
        (int) 0 => 'home'
    ),
    'loginAction' => array(
        'admin' => false,
        'controller' => 'CoreUsers',
        'action' => 'login'
    ),
    'userModel' => 'CoreUser'
)
userModel => 'CoreUser'
  } 
```

### CakePHP 的版本

```
'2.1.0' 
```

### 调用 login() 之前的密码

```
'test' 
```

### 调用 login() 之前的用户名

```
 'testy5' 
```

### 调用 login() 后的密码

```
 'test' 
```

这是我在其他我尝试过的 stackoverflow 帖子中阅读的内容的快速列表。如果您需要我详细说明，请告诉我。

1）我将用户名和密码映射到数据库中的字段。这是字段的注释。我也尝试在 beforeFilter() 方法中这样做。使用：

```
$this->Auth->fields = array('username' => 'user_name', 'password' => 'user_password'); 
```

在登录视图中，表单是这样创建的：

```
$this->Form->input('username');
$this->Form->input('password'); 
```

2）我尝试在登录之前手动散列密码，如下所示：

```
 $this->Auth->request->data['CoreUser']['password'] = Security::hash($this->Auth->request->data['CoreUser']['password'])
   if ($this->Auth->login()) {
            $this->redirect($this->Auth->redirect());
   } 
```

### 编辑0

[3）我只是按照CakePHP 2.0 Auth Login](https://stackoverflow.com/questions/10014928/cakephp-2-0-auth-login-not-working)的建议尝试这样做，但不工作

我的 AuthComponent 现在看起来像这样：

```
 public $components = array(
    'Session',
    'Auth' => array(
        'authenticate' => array(
            'Form' => array(
                'userModel' => 'CoreUser',
                'fields' => array(
                    'username' => 'user_name',
                    'password' => 'user_password'
                )
            )
        ),
        'loginRedirect' => array('controller' => 'pages', 'action' => 'index'),
        'logoutRedirect' => array('controller' => 'pages', 'action' => 'display', 'home'),
        'loginAction' => array('admin' => false, 'controller' => 'CoreUsers', 'action' => 'login')
    )
); 
```

如果我没有详细说明，或者我犯了错误，我深表歉意。我已经为此工作了几天，这真的让我筋疲力尽。我感谢我可能收到的任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T12:49:19.513

我最终解决这个问题的方法是完全按照 CakePHP 的教程进行操作。我也升级到 2.1.2。我正在运行 2.1.0。

[http://book.cakephp.org/2.0/en/tutorials-and-examples/blog-auth-example/auth.html](http://book.cakephp.org/2.0/en/tutorials-and-examples/blog-auth-example/auth.html)

然后我慢慢添加了我需要的配置。有关我引用的 Auth 组件的信息：

[http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html)

真正我的问题是故障排除。我会做一堆改变，而不是一次一个。我让我的 login.ctp 以两种不同的方式查看

```
 $this->Form->input('username');
 $this->Form->input('password'); 
```

现在看起来像这样：

```
 echo $this->Form->input('user_name');
 echo $this->Form->Label('Password');
 echo $this->Form->password('user_password'); 
```

第二个版本有效。

EDIT0：这非常重要。如果不调用 AppController 父级，则登录将不起作用。

```
class CoreUsersController extends AppController{
    public $helpers = array('Html','Form');

    public function beforeFilter() {
         parent::beforeFilter();
    } 
```

Auth 组件的修订版有效：

```
public $components = array(
    'Session',
    'Auth' => array(
        'authenticate' => array(
            'Form' => array(
                'userModel' => 'CoreUser',
                'fields' => array(
                    'username' => 'user_name',
                    'password' => 'user_password'
                )
            )
        ),
        'loginRedirect' => array('controller' => 'pages', 'action' => 'index'),
        'logoutRedirect' => array('controller' => 'pages', 'action' => 'display', 'home'),
        'loginAction' => array('admin' => false, 'controller' => 'CoreUsers', 'action' => 'login')
    )
); 
```

我的盐仍然是一个空字符串：

```
Configure::write('Security.salt', ''); 
```

只需要在一处设置 md5 哈希。在模型的 beforeSave() 中不需要它：

```
public function beforeFilter() {
    Security::setHash('md5');
    $this->Auth->allow('login','add');  
} 
```

之前保存（）：

```
public function beforeSave() {
    if (isset($this->data[$this->alias]['user_password'])) {
        $this->data[$this->alias]['user_password'] = AuthComponent::password($this->data[$this->alias]['user_password']);
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T21:45:56.747

如果您直接在数据库中添加用户，那就是问题所在。即使您在配置中有一个空字符串，它也会在盐算法中使用它而不是不使用盐。（这可能是一个坏主意，但这是另一个问题）。

此外，Auth->password 函数是 Security::hash() 的包装器，其中始终使用盐。请改用 Security::hash($password, 'md5', false) 。保存用户时，这不会对密码加盐。但是，您可能需要配置您的 Auth/login 功能以在不检查盐的情况下登录。

我很肯定你的问题出在你配置 Auth 的方式上……你的数据库应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-20T18:06:00.937

我遇到了同样的错误，我复制了一个 cakephp 项目，但无法登录新项目。经过数周寻找正确答案后，我发现我所要做的就是更改 tmp 文件夹的权限。由于未知原因，当我复制文件夹时，其中一些以只读权限复制。

# python - Firefox 本地存储外部访问

> ID：10234758
> 
> 赞同：2
> 
> 时间：2012-04-19T18:46:19.567
> 
> 标签：python, firefox, google-chrome

我编写了一个脚本，它使用网站存储在本地存储中的信息。Chrome将本地存储db文件存储在以下路径，我可以使用python很好地解析这个数据库文件。

```
'C:\Users\Matt\AppData\Local\Google\Chrome\User Data\Default\Local Storage\' 
```

另一方面，Firefox 将文件存储在以下路径，但我无法打开此文件来解析信息。

```
'C:\Users\Matt\AppData\Roaming\Mozilla\Firefox\Profiles\vrviae08.default\webappsstore.sqlite' 
```

你可以通过这种方式访问​​本地存储吗？有没有比这更好的方法来使用存储在本地存储中的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-29T18:56:47.903

在寻找类似问题的解决方案时，我偶然发现了这个问题。对我来说，问题当然是权限。我不想更改 Firefox 目录中的权限，所以我从我的脚本目录中创建了指向我想要访问的 .sqlite 文件的符号链接。这对我有用。希望这可以帮助某人。

# shell - 处理多个文件集的循环

> ID：10234759
> 
> 赞同：0
> 
> 时间：2012-04-19T18:46:24.213
> 
> 标签：shell

为了简化我的工作，我通常这样做：

```
 for FILE in ./*.txt; 
   do ID=`echo ${FILE} | sed 's/^.*\///'`; 
   bin/Tool ${FILE} > ${ID}_output.txt; 
   done 
```

因此进程循环遍历所有 *.txt 文件。

现在我有两个文件组 - 我的工具使用两个输入（-a 和 -b）。是否有任何命令可以在每个 FILE_B 上为每个 FILE_A 运行 Tool 并将输出文件命名为它们的组合？

我想它应该看起来像这样：

```
 for  FILE_A in ./filesA/*.txt; 
  do for FILE_B in ./filesB/*.txt; 
  bin/Tool -a ${FILE_A} -b ${FILE_B} > output.txt; 
  done 
```

因此，该过程将运行 filesA 中的 *.txt 数量超过 filesB 中的 *.txt 数量。还有我什至不知道放在哪里的命名问题......

希望很清楚我在问什么。以前从来没有做过这样的任务，命令行真的很有帮助。

期待！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:00:54.147

```
NEWNAME="${FILE_A##*/}_${FILE_B##*/}_output.txt" 
```

# android - Admob 关于多项活动？

> ID：10234762
> 
> 赞同：9
> 
> 时间：2012-04-19T18:46:32.750
> 
> 标签：android, android-activity, admob, adview

我的应用程序中有 7 个活动。我想**在每个活动中显示 admob**

**我是否必须在每个活动中创建每个 AdView？**

或者

**是否有任何替代方法可以重用以前的活动容器**或**防止它被破坏**，所以我可以在下一个活动中使用....

我们将不胜感激的任何代码或提示。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T08:09:12.020

我做到了。感谢 yorkw 的评论。这不是一个有效的代码。但是您可以进行相应的修改。这**减少了每个活动的代码**。

只需**扩展“TestingAdmobActivity”**并**调用 SetupAds()**来调用您的广告。

**我的超类“TestingAdmobActivity.java”**

```
package com.test.myadmob;

import com.google.ads.Ad;
import com.google.ads.AdListener;
import com.google.ads.AdRequest;
import com.google.ads.AdRequest.ErrorCode;
import com.google.ads.AdSize;
import com.google.ads.AdView;

import android.app.Activity;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup.LayoutParams;
import android.widget.LinearLayout;

public class TestingAdmobActivity extends Activity implements AdListener{
    public AdView adView;
    public String ADV_PUB_ID = "a14e2fb60918999";
    private boolean adVisible = true;
    LinearLayout layout;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.i("Admob", "Calling External");
    }

    public void SetupAds(){ 
    Log.i("AdMob", "Start Setup");
    layout = new LinearLayout(this);
    layout.setOrientation(LinearLayout.VERTICAL);
    layout.setGravity(android.view.Gravity.BOTTOM | android.view.Gravity.CENTER_HORIZONTAL);   //To put AdMob Adv to Bottom of Screen
    Log.i("AdMob", "End Layout Setup");

    addContentView(layout, new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.FILL_PARENT));

    adView = new AdView(this, AdSize.BANNER, ADV_PUB_ID);
    adView.setAdListener(this);
    Log.i("AdMob", "Init complete Adview");

    layout.addView(adView, new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
    Log.i("AdMob", "Done AddView Layout");

    AdRequest request = new AdRequest();    
    request.addTestDevice(AdRequest.TEST_EMULATOR);
    request.addKeyword("LifeOK");

    adView.loadAd(request);

    Log.i("AdMob", "End Setup");    
    }

    private Handler handler = new Handler() 
    {
        public void  handleMessage(Message msg) 
        {
            switch (msg.what)
            {
                case 0:     //Disable Adv
                    if (adVisible)
                        adVisible = false;
                    break;

                case 1:     //Enable Adv
                    if (!adVisible)
                    {
                        Log.i("AdMob", "Case 1");                       
                        adVisible = true;
                    }
                    break;

                case 2:     //Enable but Hide Adv
                        adView.setVisibility(View.GONE);                
                    break;

                case 3:     //Enable but Show Adv
                        adView.setVisibility(View.VISIBLE);
                    break;

                default:
                    break;
            }
        }
    };

    public void DisableAds()
    {
        Log.i("AdMob", "Request Disable Adv");
        handler.sendEmptyMessage(0);
    }

    public void EnableAds()
    {
        Log.i("AdMob", "Request Enable Adv");
        handler.sendEmptyMessage(1);
    }

    public void HideAdv()  //Enable Adv but Hide
    {
        Log.i("AdMob", "Request Hide Adv");
        handler.sendEmptyMessage(2);
    }

    public void ShowAdv()  //Show Adv
    {
        Log.i("AdMob", "Request Show Adv");
        handler.sendEmptyMessage(3);
    }

    @Override
    public void onDismissScreen(Ad arg0) {
        // TODO Auto-generated method stub
        Log.d("AdMob", "Dismiss Screen");
    }

    @Override
    public void onFailedToReceiveAd(Ad arg0, ErrorCode arg1) {
        // TODO Auto-generated method stub
        Log.d("AdMob", "failed to receive ad (" + arg1 + ")");    
    }

    @Override
    public void onLeaveApplication(Ad arg0) {
        // TODO Auto-generated method stub
        Log.d("AdMob", "Leaving Application");
    }

    @Override
    public void onPresentScreen(Ad arg0) {
        // TODO Auto-generated method stub
        Log.d("AdMob", "Present Screen");
    }

    @Override
    public void onReceiveAd(Ad arg0) {
        // TODO Auto-generated method stub
        Log.d("AdMob", "Adv Received");
    }
} 
```

**我的 FirstActivityClass “NewActivity_1.java”**

```
package com.test.myadmob;

import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;

public class NewActivity_1 extends TestingAdmobActivity {

     /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Log.i("Admob", "OnCreate");
        SetupAds();
        Log.i("Admob", "Done");

        Button button1 = (Button) findViewById(R.id.button1);
        button1.setOnClickListener(new View.OnClickListener() {         
            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                Log.i("Admob", "Going to Activity 2");
                Intent mainIntent = new Intent().setClass(NewActivity_1.this, NewActivity_2.class);
                startActivity(mainIntent);
            }
        });
    }
} 
```

**我的 SecondActivityClass “NewActivity_2.java”**

```
package com.test.myadmob;

import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;

public class NewActivity_2 extends TestingAdmobActivity {

     /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Log.i("Admob", "OnCreate");
        SetupAds();
        Log.i("Admob", "Done");

        Button button1 = (Button) findViewById(R.id.button1);
        button1.setOnClickListener(new View.OnClickListener() {         
            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                Log.i("Admob", "Going Back to Activity 1");
                finish();
            }
        });
    }
} 
```

**我的 AndroidManifest.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.test.myadmob"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="7" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:label="@string/app_name"
            android:name=".NewActivity_1" >
            <intent-filter >
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name=".TestingAdmobActivity" ></activity>
        <activity android:name=".NewActivity_2" ></activity>

        <activity android:name="com.google.ads.AdActivity"             
             android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize" 
             >

        </activity>
    </application>

    <!-- AdMob SDK requires Internet permission -->
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
    <uses-permission android:name="android.permission.READ_PHONE_STATE" />              <!-- to get Android Device ID -->   

</manifest> 
```

**注意：为了 google admob sdk 使用的权限，我必须在带有 min-sdk 版本 7 的 android 4.0 sdk 上构建它**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-02T17:21:54.897

在我的应用程序中，我在任何给定时间都有 0..12 个广告的缓存。我在无尽的 ViewPager 中跨不同的片段重复使用它们。缓存类负责加载向片段提供广告。

诀窍是：

1.  `onDestory`仅当您确定已永久使用该 AdView 实例时才调用 AdView 。这意味着 Fragments 本身不负责这件事。

2.  在 Fragment 之间传递 AdView 本身，我们需要记住将每个 AdView 从其层次结构中分离出来：

（当然只在 UI 线程上）：

```
public void detachFromHirerchy() 
{
    View adView = getAdView();
    if ( adView != null )
    {
        ViewGroup parent = (ViewGroup) adView.getParent();
        if (parent != null) 
        {
            parent.removeView( adView );
        }
    }

} 
```

# c - 警告使用 ICC 和 printf 以及千位分组格式（撇号）

> ID：10234766
> 
> 赞同：1
> 
> 时间：2012-04-19T18:46:45.043
> 
> 标签：c, locale, printf, number-formatting, icc

我需要显示一些数以千计的分组（在这种情况下，使用句点作为分隔符）。所以，我使用 printf 标志`'`来实现这样的事情。

`gcc`一切顺利，但如果我使用，`icc`那么我会收到以下警告：

> 警告 #269：无效的格式字符串转换

尽管该数字确实以所需的格式打印。

例如，如果我们编译这个简单的程序：

```
#include <stdio.h>
#include <stdlib.h>
#include <locale.h>

int main(int argc, char *argv[]) {
    setlocale(LC_NUMERIC, "da_DK");
    int i = 12345678;
    unsigned long int j = 987654321;

    printf("%d \t %'d \n%lu \t %'lu \n", i, i, j, j);
} 
```

然后我们得到这个警告：

```
% icc -o simple simple.c 

simple.c(10): warning #269: invalid format string conversion
  printf("%d \t %'d \n%lu \t %'lu \n", i, i, j, j);
                                          ^ 
```

尽管一切都按预期工作：

```
% ./simple 
12345678         12.345.678 
987654321        987.654.321 
```

所以我的问题是：

1.  如何抑制此警告？
2.  与编译器`'`一起使用 printf 和朋友作为标志是否安全？`icc`

* * *

**更新**：

我刚刚意识到抑制`269`警告的一个奇怪技巧是使用格式定义一个变量，并将该变量传递给`printf`：

```
#include <stdio.h>
#include <stdlib.h>
#include <locale.h>

int main(int argc, char *argv[]) {
    setlocale(LC_NUMERIC, "da_DK");
    int i = 12345678;
    unsigned long int j = 987654321;
    const char *strFormat = "%d \t %'d \n%lu \t %'lu \n";

    printf(strFormat, i, i, j, j);
} 
```

* * *

**更新**：

因为使用撇号 with`printf`是 XSI 扩展（如@Dave 所述），为了使代码更具可移植性，遵循[C-FAQ 问题 12.11](http://c-faq.com/stdio/commaprint.html)中的建议并使用他们的`commaprint`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T18:54:10.797

要回答您的第二个问题，编译器实际上并不控制您的格式字符串的处理；那是你的 C 库的工作。`icc`无法识别格式字符串，因为它是非标准的，但只要您了解您的代码仅在其 c 库支持该`'`标志的平台上有效，您就可以了。

正如[opengroup 页面](http://pubs.opengroup.org/onlinepubs/009695399/functions/printf.html)所示，`'`它是一个 XSI 扩展，因此您的代码可以在任何符合 XSI 的平台上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-12T17:05:38.830

所以：

```
#include <stdio.h>

void punt(int n){
    char s[28];
    int i = 27;
    if(n<0){n=-n; putchar('-');} 
    do{
        s[i--] = n%10 + '0';
        if(!(i%4) && n>9)s[i--]=' ';
        n /= 10;
    }while(n);
    puts(&s[++i]);
}

int main(){

    int a;
    scanf("%d",&a);
    punt(a);

} 
```

或者：

```
#include <stdio.h>

int main() {
    char str[50];
    int len = 0;   
    scanf("%48[^\n]%n", str, &len);

    int start = len % 3;

    for(int i = 0; i < len; i++) {        
        if(i == start && i != 0) {
            printf(" ");
        } else if((i - start) % 3 == 0 && i != 0) {
            printf(" ");
        }    
        printf("%c", str[i]);
    }   

   return 0;
} 
```

# java - Oracle 10g 声称一个包体有错误但它没有

> ID：10234767
> 
> 赞同：7
> 
> 时间：2012-04-19T18:46:45.247
> 
> 标签：java, oracle, spring, plsql

我的 oracle 实例上有几个包。当我从头开始重新创建数据库时，我得到零个无效对象，并且没有来自 liquibase 的警告。

然后，当我调用包方法时，如下所示：

```
new SimpleJdbcCall(jdbcTemplate).withCatalogName(packageName).withProcedureName(storedProcedureName).execute(parameterMap); 
```

它给了我以下错误：

```
org.springframework.jdbc.UncategorizedSQLException: CallableStatementCallback; uncategorized SQLException for SQL [{call CALENDAR_MANAGEMENT.CREATE_SUMMARIES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}]; SQL state [72000]; error code [4063]; ORA-04063: package body "ETPDEV.CALENDAR_MANAGEMENT" has errors
ORA-06508: PL/SQL: could not find program unit being called: "ETPDEV.CALENDAR_MANAGEMENT"
ORA-06512: at line 1; 

nested exception is java.sql.SQLException: ORA-04063: package body "ETPDEV.CALENDAR_MANAGEMENT" has errors
ORA-06508: PL/SQL: could not find program unit being called: "ETPDEV.CALENDAR_MANAGEMENT"
ORA-06512: at line 1

Caused by: java.sql.SQLException: ORA-04063: package body "ETPDEV.CALENDAR_MANAGEMENT" has errors
ORA-06508: PL/SQL: could not find program unit being called: "ETPDEV.CALENDAR_MANAGEMENT"
ORA-06512: at line 1 
```

再次检查无效对象一无所获。再次编译 CALENDAR_MANAGEMENT 正常完成，没有错误。

我尝试了完整的架构重新编译，但没有奏效。

当我从 SQLDeveloper 调用它时，它可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:59:37.203

我在集成检查中遇到了这个错误，我没想到在包运行时检查它的有效性。

在调用包之前删除一些简单的代码：

```
select name || ' - ' || line || ' - ' || text from user_errors order by name, sequence; 
```

我发现一个不同的测试本身并没有清理，但是这个是，所以当我前后查看数据库时，它看起来很好。

# javascript - 使用 XSLT 删除 JavaScript 和服务器端 C# 之间的格式重复

> ID：10234770
> 
> 赞同：0
> 
> 时间：2012-04-19T18:47:03.170
> 
> 标签：javascript, .net, ajax, json, xslt

我有一个严重依赖 Ajax 来呈现页面的 C#.Net 应用程序。当用户向上/向下滚动页面时，会加载新内容。我通过 JSON 将原始数据传递给 Javascript，然后我的 JS 通过它创建 HTML 标记并写入页面。

同时，我需要使用 .Net 传递初始页面内容，以便搜索引擎和非 JS 浏览器可以消化一些东西。C# 使用相同的原始数据将标记呈现到文字控件中。

问题是我发现自己在 C# 和 JavaScript 中编写相同的格式规则，这似乎是不必要的。

一个简化的例子：

这在 C#...

```
for (int x=0; x < lines.Length; x++)
{
    html.Append("<div>");
    html.Append(lines[x].Title);
    html.Append("</div>");
} 
```

...将在 JavaScript 中与 this 匹配：

```
for (int x=0; x < lines.length; x++)
{
    html += "<div>";
    html += lines[x].Title ;
    html += "</div>";
} 
```

更改格式/布局需要同时更改两者，这似乎很愚蠢。

所以我提出的解决方案是使用 XSLT。
我会使用 .Net 为新内容动态生成 XML 文件，然后 JS 和 .Net 都可以使用相同的 XSLT 文件转换为 XHTML 并简单地输出标记。

我能看到的唯一缺点是 .Net 只会生成 XML，然后将其转换为标记。这似乎是多余的，但实际上只有一小部分前端标记将由 .Net 生成，因此页面加载延迟应该是最小的。

对此有什么想法吗？有什么选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T20:01:06.860

如果使用 C# 生成的服务器端和使用 JavaScript 的客户端生成的 HTML 是相同的，我宁愿摆脱 JavaScript 生成，只在服务器上生成一次 HTML，使用 XLST 或直接使用代码。JavaScript 可以通过 AJAX 调用获取此 HTML 并直接显示它，并在需要的地方附加事件处理程序。

# sharepoint-2010 - Parent-Member 指示当前在多选过滤器中选择了 1 个（或多个）子级

> ID：10234782
> 
> 赞同：0
> 
> 时间：2012-04-19T18:47:39.350
> 
> 标签：sharepoint-2010, performancepoint

是否有 PerformancePoint 多选筛选器设置，可为用户提供当前选择子成员的可视队列？

例如，在下图中，“2012-Week02”是选定的子成员。当父成员“2012”折叠时，我希望看到一个可视队列（灰色复选框、粗体文本等），让我知道当前选择了此路径中有一个孩子。

![在此处输入图像描述](../Images/bee195f156e0d11a257461d7c2ccadf4.png)

像 Excel...

![在此处输入图像描述](../Images/92403a027f2dc5a51fba0a8acac5fc87.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T15:30:37.720

否，但 PerformancePoint Services 2013 中正在纠正此问题。请参阅[此处](http://blogs.msdn.com/b/performancepoint/archive/2012/08/03/what-s-new-in-performancepoint-services-2013.aspx)

# php - Facebook 登录突然不能用了？

> ID：10234783
> 
> 赞同：0
> 
> 时间：2012-04-19T18:47:53.280
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk

我们有一个自定义 facebook 登录，我为我们的网站 sourcecodedb.com 编写，并且没有对我们的代码进行任何更改，facebook 登录在 2012 年 4 月 15 日左右停止工作，我们的 twitter api 也变得非常慢，但这是另一个问题。这是用户单击登录按钮时被发送到的页面。

```
<?php
require_once('fbsdk/facebook.php');
$facebook = new Facebook(array(
  'appId' => 'xxx',
  'secret' => 'xxx',
));

  $params = array('scope' => 'read_stream, email', 'redirect_uri' => 'http://sourcecodedb.com/loggedin.php'); //parameter vi vill anv채nda fr책n facebook anv채ndare
  $loginUrl = $facebook->getLoginUrl($params);

header('Location: '.$loginUrl);
?> 
```

然后处理登录的页面看起来有点像这样，我取出了一些代码。

```
<?php
include_once('header.php');
require_once('fbsdk/facebook.php');

$facebook = new Facebook(array(
  'appId' => 'xxx',
  'secret' => 'xxx',
));

  $fbuid = $facebook->getUser(); //Detta tar facebook användarens id från en aktiv session
  echo 'fbid: '.$fbuid.'</br>';

  if($fbuid) 
{
  $user_profile = $facebook->api('/me','GET');
        $name = $user_profile['first_name'];
        $lname = $user_profile['last_name']; 
        $fbid = $user_profile['id'];

} 
```

这是为调试而添加的，总是返回 0

```
echo 'fbid: '.$fbuid.'</br>'; 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:31:06.020

通过更改修复它

```
CURLOPT_CONNECTTIMEOUT => 10 
```

至

```
CURLOPT_CONNECTTIMEOUT => 60 
```

在 base_facebook.php

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T13:10:25.613

我遇到了同样的问题，并通过以下方式解决了它：

*   [从https://github.com/facebook/facebook-php-sdk](https://github.com/facebook/facebook-php-sdk)下载新的 php sdk
*   更换`src`文件夹

现在它又对我有用了。干杯。

# c - 带有 gtk+ 的新事件（带有 select 的套接字交互）

> ID：10234784
> 
> 赞同：1
> 
> 时间：2012-04-19T18:47:55.777
> 
> 标签：c, sockets, select, gtk

我是 GTK+ 编程的真正初学者，但我无法理解 g_source_new() 函数。

我想使用 GTK 事件处理我的套接字（当我的套接字可读/可写时的新事件，如使用 select）。

如果有人能送我上路，我完全迷路了......

PS：我不想使用 Gtk 的套接字管理/为 UI 创建一个新线程。

提前谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T10:00:34.007

GSource 的文档记录很差。你能做的最好的就是浏览源代码，看看定时器和空闲源是如何实现的。阅读 g_timer_add 和 g_idle_add 的代码。

# java - 线程上可运行对象的监督调用

> ID：10234785
> 
> 赞同：0
> 
> 时间：2012-04-19T18:48:07.070
> 
> 标签：java, multithreading, concurrency, runnable, executorservice

好的，我将通过举例来解释我的要求。

假设我在给定时尝试实现并行合并算法：

*db*是一个数组，其中*db[i]*是一个对象的 ArrayList。

*j*是它的大小。 *Merger(db,cmp,i,j)*是将*db[ j ]合并* **到** *db[i] 的可运行对象。*

cmp 是一个相关的比较器。

这是我首先完成的：

```
 ExecutorService e =  Executors.newFixedThreadPool(3);
    while (j>0) 
        for ( i=0;i<j;i++,j--) 
            e.execute(new Merger<E>(db,cmp,i,j)); 
```

但是随后开始了一些合并，而之前需要先完成的合并尚未完成。（更不用说正在运行的线程在合并完成之前完成了循环方式......）这让我的程序踢出了一个异常。

这是我不能做但想做的事，因此需要你的帮助：

```
 ExecutorService e =  Executors.newFixedThreadPool(3);
    while (j>0) {
        for ( i=0;i<j;i++,j--) 
            e.execute(new Merger<E>(db,cmp,i,j));
        wait for e to announce that all runnables have finished running;
    } 
```

在我看来，这应该可行，如果您认为不行，请解释原因，但无论如何，我想知道它是如何完成的。

（基本上我可以实现我自己版本的 FixedThreadPool 以使其成为可能，但我宁愿不这样做）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:34:57.887

您可能正在寻找[`CountDownLatch`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/CountDownLatch.html)：

*   确定您需要等待的线程数并`CountDownLatch`使用该数创建一个
*   在构造它们时将锁存器传递给所有工作线程，并在`countDown()`它们完成后让它们调用。
*   在将工作线程排入队列的循环之后，`await()`倒计时达到零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T19:12:02.300

您需要一个“startAndRendezvous”可运行文件，它发出合并并等待它们完成。通常，这是通过创建一组合并可运行任务集来完成的，该任务集带有指向 startAndRendezvous 中的 CountDownlatch 的回调，或者更灵活地，将 startAndRendezvous 作为构造函数参数传递给合并可运行对象。

最新的 Java 有一个 ForkJoinPool。看看这个类 - 它节省了一个明确的倒计时锁存器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-20T11:41:17.937

一个应该工作的简单方法是在 Merger 中定义一个静态计数器：

```
public class Merger<E> ... {
  public static int runningCount=0;
  public Merger(...){
    runningCount++;
  }
  public void run(){
     ...
     runnningCount--;
  }
} 
```

然后 ：

```
ExecutorService e =  Executors.newFixedThreadPool(3);    
while (j>0) {
    for ( i=0;i<j;i++,j--) 
        e.execute(new Merger<E>(db,cmp,i,j));
    while(Merger.runningCount>0)
        Thread.sleep(10);
} 
```

# c++ - C++：出现奇怪的标头错误

> ID：10234786
> 
> 赞同：0
> 
> 时间：2012-04-19T18:10:27.060
> 
> 标签：c++, xcode, opencl

```
#ifndef _MY_OPENCLPLATFORM_
#define _MY_OPENCLPLATFORM_

#include "OpenCL.h"

namespace my
{

    class OpenCLPlatform
    {
        cl_platform_id mplatformID;

        cl_uint mnumDevices;

        std::vector<OpenCLDevice> mdevices; // OpenCLDevice was not declared in this scope

    public:
        OpenCLPlatform(cl_platform_id platformID);

        void getDevices();

        void printInfo();

        cl_platform_id& getPlatformID();
    };
}

#endif

#ifndef _MY_OPENCLDEVICE_
#define _MY_OPENCLDEVICE_
#include "OpenCL.h"

namespace my
{
    class OpenCLDevice
    {
        cl_device_id mdeviceID;

    public:
        OpenCLDevice(cl_device_id device);

        void printInfo();

        void printDeviceType(cl_device_type deviceType);
    };
}

#endif

#ifndef _MY_OPENCL_
#define _MY_OPENCL_
#if defined(__APPLE__) || defined(MACOSX)
#include <OpenCL/opencl.h> // This works only for XCODE compiler
#else
#include <CL/cl.h>
#endif
#include <cassert>
#include <iostream>
#include <vector>
#include "Exception.h"
#include "OpenCLDevice.h"
#include "OpenCLPlatform.h"

namespace my {

    class OpenCLDevice;
    class OpenCLPlatform;
    class OpenCL;

    class OpenCL
    {
        cl_uint mnumPlatforms;
        std::vector<OpenCLPlatform> mplatforms;

        void getPlatforms();
    public:

        OpenCL();
        ~OpenCL();

        void quickSetup();

        void printPlatformVersions();
    };
}

#endif 
```

是否排序“类 OpenCLDevice；类 OpenCLPlatform；类 OpenCL；” 事情？有时，头文件相互依赖，这可能导致“难以理解”或复杂的包含...您是否有一种“单向”技术来处理您一直使用的复杂的包含？

编辑：

我更改了代码以匹配我的实际问题。如果您查看上面的代码，编译器会说“OpenCLDevice 未在此范围内声明”。

编辑：

我终于让代码工作了，这就是我所做的： 1\. 在 OpenCLPlatform.h 中添加 #include "OpenCLDevice.h" 2\. 编译 3\. 在 OpenCLPlatform.h 中删除 #include "OpenCLDevice.h" 4\. 编译它现在工作！

编辑：

我清理了项目并删除了所有依赖项，但我又遇到了同样的错误。

编辑：

我认为编译器对代码做了一些事情。它可能选择不包含头文件和源文件中未使用但在其他头文件和源代码中使用的库

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:44:30.450

由于您包含了 classa.h 和 classb.h ，其中两个类都（可能）定义了，因此您甚至不需要前向声明。

但是，如果您不包括它们，那么不，声明的顺序无关紧要。只要一个类在使用之前被前向声明，你应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:43:35.090

我看到两个潜在的问题：

您`#include "OpenCL.h"`可能不包含您期望的文件（您的），而是一些系统文件。

在您的情况下不能使用前向声明。它仅在您有指向类实例的指针或引用时才有效。您`vector<OpenCLPlatform>`需要类声明（即包含相应的标头）。

# jquery-mobile - jQuery Mobile 导致 jQuery 中的访问被拒绝

> ID：10234792
> 
> 赞同：0
> 
> 时间：2012-04-19T18:49:03.217
> 
> 标签：jquery-mobile

我正在关注向 ASP.Net MVC 4 应用程序添加移动功能的[本教程](http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features)。

当我启动应用程序（导致登录页面被加载）时，我`Access denied`在 jQuery 1.7.2 中得到以下点（也与 1.7.1 一起复制）

```
if ( elem.parentNode ) { // Access denied here, Line 6081
    elem.parentNode.removeChild( elem );
} 
```

沿着调用堆栈走，我在 jquery.mobile-1.1.0.js 中看到以下内容（调用堆栈上还有其他一些方法）

```
// Called from .initializePage:
if ( !$pages.length ) {
    $pages = $( "body" ).wrapInner( "<div data-" + $.mobile.ns + "role='page'></div>" ).children( 0 ); // Called from here, Line 7475
}

// First method in jquery.mobile:
if( $.mobile.autoInitializePage ){
    $.mobile.initializePage();  // Called from here, Line 7541
} 
```

如果我从我的应用程序中注释掉 jquery.mobile，它会像以前一样工作：

```
// _Layout.cshtml:
<script src="@Url.Content("~/Scripts/jquery-1.7.2.js")" type="text/javascript"></script>
@*<script src="@Url.Content("~/Scripts/jquery.mobile-1.1.0.js")" type="text/javascript"></script>*@
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.19.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script> 
```

所有 JavaScript 文件都通过主项目域的内置 VS2010 Web 服务器提供服务。

**更新**

经过进一步检查，我意识到这是错误发生时 jQuery Mobile 正在做的事情：

```
// find and enhance the pages in the dom and transition to the first page.
// if no pages are found, create one with body's inner html
$pages = $( "body" ).wrapInner( "<div data-" + $.mobile.ns + "role='page'></div>" ).children( 0 ); 
```

发生了什么导致 jquery.mobile 失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:29:15.420

事实证明，页面上有对第三方脚本的引用（[Comodo SSL](https://support.comodo.com/index.php?_m=knowledgebase&_a=viewarticle&kbarticleid=1319&nav=0,1,82)验证），当然不需要在页面的移动版本上。jQuery Mobile 试图操作相关的 DOM，导致错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-17T14:47:21.783

感谢您为我指明正确的方向。我一直在寻找为什么弹出方法（JQuery Mobile）在 .aspx 页面上不起作用的原因。Visual Studio 使用脚本管理器自动初始化页面。

解决方案是注释掉 Asp:Scriptmanager 标记中的以下行，因为它与页面头部的 JQuery 引用冲突：

```
<asp:ScriptReference Name="jquery" /> 
```

# java - 如果使用模拟，在这种情况下进行单元测试的目的是什么

> ID：10234793
> 
> 赞同：3
> 
> 时间：2012-04-19T18:49:06.837
> 
> 标签：java, unit-testing, mocking

我有一个关于单元测试的问题。想了好几天，也没有找到答案。

比如说，我有一个从 Web 服务下载文件并将其写入磁盘的功能。在没有实际看到文件已下载并写入磁盘的情况下对其进行测试的目的是什么？

虽然我知道我们可以模拟 Web 服务，但是在这种情况下我该怎么做呢？据我所知，像 Mockito 这样的东西只能模拟行为，但不提供有意义的数据（本例中的文件）。

即使我们可以模拟 Web 服务的行为，我如何模拟将文件写入磁盘而不真正向磁盘写入内容？

很抱歉，我没有具体的例子。请随时发表您的意见。

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T18:57:48.547

我总是说对你的代码进行单元测试会使它更加模块化，因为它迫使你思考如何解耦这个类并单独测试它。

在您的情况下，当您想要测试诸如将文件写入磁盘之类的东西时，您可以改为让您的方法写入文件以与简单的 a 交互`OutputStream`这将确保您可以简单地将 a 传递`ByteArrayOutputStream`给函数而不是实际的`FileOutputStream`您然后可以获得bytes 转换为 String 并检查内容是否与您实际期望的匹配。

也可以创建一个临时文件并传递`FileOutputStream`临时文件的写入，然后您可以检查文件的内容。

通过使该方法与 进行交互`OutputStream`，您可以使其与识别文件路径、创建`FileOutputStream`等的过程分离

正如您所提到的，如果只是从某个 Web 服务获取数据并将其写入文件，那么测试此功能可能没有多大意义。但是如果它智能地操纵数据或者当 Web 服务交互抛出异常时期望做某事，测试它会很有趣。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T19:09:55.330

> 比如说，我有一个从 Web 服务下载文件并将其写入磁盘的功能。在没有实际看到文件已下载并写入磁盘的情况下对其进行测试的目的是什么？

空无一人。你不用单元测试来测试它。在这种情况下（与网络、文件系统、数据库的交互），您编写[集成测试](http://en.wikipedia.org/wiki/Integration_testing)。他们经常使用类似的工具和框架来进行单元测试，但它们服务于不同的目的——测试你的组件集成和它们之间的交互。集成测试通常会模仿您的应用程序的实际使用情况。

如果您的所有功能只是调用一个服务/组件来下载文件并调用另一个服务/组件将其保存到磁盘，那么在这种情况下单元测试是相当有限的。

# objective-c - 在 XCode 4.3.2 中，当我运行 ARC 转换重构工具时，我所有“保留”的属性选项都不会更改为“强”

> ID：10234794
> 
> 赞同：7
> 
> 时间：2012-04-19T18:49:10.007
> 
> 标签：objective-c, xcode, refactoring, automatic-ref-counting

在 XCode 4.3.2 中，当我运行 ARC 转换重构工具时，我所有的“保留”属性选项都不会更改为“强”。现在是暗示“强”还是这只是 XCode 4.3.2 的问题？

例子：

前

```
@property (nonatomic, retain) NSString * someString; 
```

后

```
@property (nonatomic) NSString * someString; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T20:02:53.210

“strong”是使用 ARC (LLVM 3.1) 时的默认值，因此新代码是正确的。
（在 ARC 之前，默认值为“assign”）
参见[http://clang.llvm.org/docs/AutomaticReferenceCounting.html#ownership.spelling.property](http://clang.llvm.org/docs/AutomaticReferenceCounting.html#ownership.spelling.property)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T08:32:05.753

strong 相当于非 ARC 保留。因此，当您从非 ARC 转移到 ARC 时，XCode 不理解保留一词，因此将其删除。从而导致错误或至少警告，因为所有实例变量都需要至少声明两个属性。

# c# - 当设置了 DefaultCellStyle.Format 的数据为空时显示一个空单元格

> ID：10234799
> 
> 赞同：2
> 
> 时间：2012-04-19T18:49:34.940
> 
> 标签：c#, datagridview

我有一个数据网格视图。dgv 的数据源是对象的“ReadOnlyCollection”。“ReadOnlyCollection”中对象的属性之一是可为空的“DateTime”。我想要做的是显示一个空白单元格，其中 'DateTime' 为空，但对 DateTime 列应用不同的格式，方法是：

```
TimeOutColumn.DefaultCellStyle.Format = "MM/dd/yyyy HH:mm"; 
```

唯一的问题是将我所有的空条目设置为 DateTime.Min 值。

“历史”是 ReadOnlyCollection。这是当前代码：

```
'DataGridViewTextBoxColumn TimeOutColumn = new DataGridViewTextBoxColumn();
            TimeOutColumn.DataPropertyName = "timeout";
            TimeOutColumn.HeaderText = "Time Out";                

            ddgGHistory.Columns.Add(BadgeTypeIDColumn);
            ddgGHistory.Columns.Add(EmployeeColumn);
            ddgGHistory.Columns.Add(TimeInColumn);
            ddgGHistory.Columns.Add(TimeOutColumn);

            ddgGHistory.DataSource = history

            ddgGHistory.Columns[3].DefaultCellStyle.Format = "MM/dd/yyyy HH:mm";
            ddgGHistory.Columns[3].DefaultCellStyle.NullValue = ""; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T18:07:14.587

由于`DateTime`是一个不可为空的对象，它必须有一个值。`DateTime`但是，可以通过将其声明为 nullable来使其可为空`DateTime`。

以下是一个不可为空的日期时间，并且总是有一个值。

```
 DateTime dt = new DateTime(); 
```

但是，可以通过`?`在类型之后添加来将其声明为可为空。

```
DateTime? nullable_dt = new DateTime?(); 
```

假设`nullable_dt`已设置为`null`，`datagridview`将显示一个空单元格，其中的值`nullable_dt`已被分配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T04:17:34.170

```
batchMembersDataGridView.Rows[e.RowIndex].Cells[16].Value = DateTime.MinValue;

                    if ((DateTime)(batchMembersDataGridView.Rows[e.RowIndex].Cells[16].Value) == DateTime.MinValue)
                    {
                        dataGridViewTextBoxColumn12.DefaultCellStyle.Format = ("");
                    } 
```

# c# - Dispose() 和 Ninject 指南

> ID：10234802
> 
> 赞同：32
> 
> 时间：2012-04-19T18:49:41.100
> 
> 标签：c#, .net, garbage-collection, ninject, idisposable

所以，我有一个从 WCF 服务公开的方法：

```
public GetAllCommentsResponse GetAllComments(GetAllCommentsRequest request)
{
    var response = new GetAllCommentsResponse();

    using(_unitOfWork)
        try
        {
            Guard.ArgNotNull(request, "request");

            var results = _unitOfWork.CommentRepository.Get(d => d.Id > 0).ToArray();

            //... Do rest of stuff here
        }
        catch (Exception ex)
        {
            response.Success = false;
            response.FailureInformation = ex.Message;
            Logger.LogError("GetAllComments Method Failed", ex);
        }

    return response;
} 
```

我有一个全局 DataUnitOfWork 对象（它实现了 IDisposable），当服务调用进入时，它由 Ninject 通过构造函数参数实例化。调试时，如果我使用

```
using(_unitOfWork) 
```

_unitOfWork 对象在超出范围后立即被释放，然后被 Ninject 再次调用（尽管它已被标记为已释放，所以没有任何反应。）如果没有 using 语句，Ninject 会处理释放。

长话短说，这有一般的经验法则吗？在我读到的所有内容似乎都表明永远不要使用它或在某些不拘一格的情况下使用它之后，我一直害怕整个 IDisposable 东西，但它总是让我感到困惑。

任何输入表示赞赏。

哦，当我在这里打字的时候，为什么在处理时会调用 GC.SuppressFinalize() 呢？Dispose 和 Finalize 有何不同？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-04-20T08:06:10.467

CLR 文档指出，创建 Disposable 对象的人负责调用 Dispose。在这种情况下，对象是由 Ninject 创建的。这意味着您不应该*显*式调用 Dispose。

Ninject 处置具有另一个作用域的每个 Disposable 对象，而不是`InTransientScope` [在 GC 收集所创建对象所绑定的作用域对象时](https://web.archive.org/web/20130111064153/http://kohari.org/2009/03/06/cache-and-collect-lifecycle-management-in-ninject-20/)。这就是为什么每个 Disposable 对象都应该是`Bind`d ，其范围不是`InTransientScope()`。例如，您可以`InParentScope()`从[NamedScope 扩展](https://github.com/ninject/ninject.extensions.namedscope/wiki)中使用它，一旦注入的对象被垃圾收集，它将立即处理该对象。

# php - 使用ajax在搜索结果中显示记录

> ID：10234804
> 
> 赞同：0
> 
> 时间：2012-04-19T18:49:53.293
> 
> 标签：php, ajax

我有以下 ajax.js，我必须使用它：

```
var xmlRequest = null;
    function ajax(url, parametersArray, callbackFunction, fcnVars) {
        if (xmlRequest != null) {
        if (xmlRequest.readyState == 2 || xmlRequest.readyState == 3) {
            xmlRequest.abort();
            xmlRequest = null;
           }
        }
        if (parametersArray == null)
            parameters = "";
        else
            parameters = formatParameters(parametersArray);
        if (window.XMLHttpRequest)
            xmlRequest = new XMLHttpRequest();
        else
            xmlRequest = new ActiveXObject("MSXML2.XMLHTTP.3.0");
            xmlRequest.open("POST", url, true);
            xmlRequest.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xmlRequest.onreadystatechange = function() {
                if (xmlRequest.readyState == 4 && xmlRequest.status == 200) {
                    if (xmlRequest.responseText) {
                        callbackFunction(xmlRequest.responseText, fcnVars);
                    }
                }
            }
        xmlRequest.setRequestHeader("Content-length", parameters.length);
        xmlRequest.setRequestHeader("Connection", "close");
        xmlRequest.send(parameters);
    }

    function formatParameters(parameters) {
        var i = 0;
        var param = "";
        for (index in parameters) {
            if (i==0) {
                param += index+"="+urlencode(parameters[index]);
            } else {
                param += "&"+index+"="+urlencode(parameters[index]);
            }
            i++; 
        }
    return param;
    }

    function urlencode(clearString) {
        clearString = encodeURI(clearString);
        clearString = clearString.replace('&', '%26');
        return clearString;
    } 
```

我有以下mysql表：

```
CREATE TABLE `dictionary` (
   `word` varchar(64) NOT NULL,
   PRIMARY KEY  (`word`)
 ) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

最后，这是我的搜索页面：

```
<div id = "search">
    <form id="searchform" method="post">
    Search for Word: 
    </select>
    <input type="text" id="search_term" name="search_term"  />
    <input type="submit" id="cmdSearch" value="Search"  />
</form>
<div id="search_results"></div>
</div> 
```

现在，我必须使用上面的 ajax.js 创建一个 php 函数，该函数将返回一个包含在表中找到的单词的数组

结果应使用 ajax 在 search_results div 中显示。

当然，我还需要一个 javascript 代码。

任何人都可以帮助我开始构建这个吗？我用 jquery 做过类似的事情，但现在我必须使用这个脚本，而且我没有其他方法可以做到这一点。

目标是在不刷新的情况下在 php 页面中显示结果。

任何帮助将不胜感激

更新：

这是我的php代码：

```
<?php

// add encoding here
header("Content-Type: text/html; charset=iso-8859-7");

// include the database connection here
include 'config.php';
include 'openDb.php';
function findWords(){
    // sanitaze the user input
    $term = strip_tags(substr($_POST['search_term'],0, 100));
    $term = mysql_escape_string($term);

    // query the database. one fileld only, so nothing to optimize here
    $sql = "SELECT word FROM dictionary WHERE word like '%$term%'";
    $result = mysql_query($sql);

    // set the string variable
    $string = '';

    // if resulta are found then populate the string variable
    if (mysql_num_rows($result) > 0){
        while($row = mysql_fetch_object($result)){
            // display the results here in bold and add a new line or break after each     result  
            $string[] = "<b>".$row->user_name."</b><br/>\n";
        }
    } else {
        // if no results are found, inform the visitors...  
        $string[] = "No matches!";
    }
    // output the string
    return $string[]; 
```

这是javascript：

```
 <script type='text/javascript'>
    ajax("findWord.php", {id:search_term}, function(result,params) {
    alert("result for ID: "+params.id+"\n\n"+result);
    }, {id:search_term});
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:22:29.797

您将不得不依赖该`ajax`函数，该函数可让您访问它在回调函数中加载的任何内容：

```
callbackFunction(xmlRequest.responseText, fcnVars); 
```

并`ajax`解释了它应该如何自称：

```
ajax(url, parametersArray, callbackFunction, fcnVars) 
```

即使 parametersArray 实际上应该是一个对象 ( `{index:value, i1:v2,...}`) 而不是一个数组 ( `[val1, val2,...]`)。`fcnVars`可以是一个对象，其中包含您想要传递给回调函数的任何内容。

这应该有效：

```
ajax("add_page.php", {id:535}, function(result,params) {
    alert("result for ID: "+params.id+"\n\n"+result);
}, {id:535}); 
```

# android - android listview 项目垂直拉伸

> ID：10234805
> 
> 赞同：1
> 
> 时间：2012-04-19T18:49:56.683
> 
> 标签：android, listview, android-layout, android-listview

我在一个列表视图中使用一个视图，它嵌入了一个带有图像背景的布局。图像，因此行似乎在哪里被垂直拉伸。我在应用程序的其他地方使用相同的布局，那里的大小似乎是正确的。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="100dp"
android:background="@drawable/bg_conference_team"
android:orientation="vertical" >

 <ImageView
    android:id="@+id/team_1_logo"
    android:layout_width="50dp"
    android:layout_height="40dp"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="10dp"
    android:layout_marginTop="10dp"
    android:src="@drawable/tm_van" 
    android:contentDescription="@string/desc"/>

<ImageView
    android:id="@+id/team_2_logo"
    android:layout_width="50dp"
    android:layout_height="40dp"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:layout_marginRight="12dp"
    android:layout_marginTop="10dp"
    android:src="@drawable/tm_det"
    android:contentDescription="@string/desc"/>

<ImageView
    android:id="@+id/conference_logo"
    android:layout_width="40dp"
    android:layout_height="40dp"
    android:layout_alignBottom="@+id/team_2_logo"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="10dp"
    android:src="@drawable/east" />

<TextView
    android:id="@+id/team_1_name"
    android:layout_width="76dp"
    android:layout_height="30dp"
    android:layout_marginTop="16dp"
    android:layout_toRightOf="@+id/team_1_logo"
    android:gravity="center"
    android:text="@string/team_van"
    android:textColor="@color/black"
    android:textSize="12dp" android:textStyle="bold"/>

<TextView
    android:id="@+id/team_2_name"
    android:layout_width="76dp"
    android:layout_height="30dp"
    android:layout_marginTop="16dp"
    android:layout_toLeftOf="@+id/team_2_logo"
    android:ellipsize="none"
    android:gravity="center"
    android:text="@string/team_det"
    android:textColor="@color/black"
    android:textSize="12dp" android:textStyle="bold"/>

<ImageView
    android:id="@+id/series_info_bg"
    android:layout_width="wrap_content"
    android:layout_height="18dp"
    android:layout_centerHorizontal="true"
    android:src="@drawable/bg_conference_team_series_info"
    android:layout_alignParentBottom="false"
     android:layout_marginTop="8dp" android:layout_below="@id/team_1_name"/>

<TextView
    android:id="@+id/series_info"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:gravity="center"
    android:text="@string/series_info"
    android:textColor="@color/black"
    android:textSize="12dp" android:layout_alignParentBottom="false"
    android:layout_alignBottom="@id/series_info_bg" android:textStyle="bold"/>

<TextView
    android:id="@+id/next_game_text"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/team_1_logo"
    android:layout_alignParentBottom="false"
    android:text="@string/game_time" android:gravity="left|center_vertical" 
    android:textColor="@color/white" android:textSize="11dp" android:textStyle="bold" 
    android:layout_below="@id/series_info_bg" android:layout_marginTop="5dp"/>

</RelativeLayout> 
```

嵌入它的布局是下面的

```
<?xml version="1.0" encoding="utf-8"?>
    <LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/main"
    android:orientation="vertical"
    android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:background="@drawable/listview_item_manual" >

  <LinearLayout
  android:id="@+id/header"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:background="@drawable/header_blue"
  android:orientation="horizontal"
  android:paddingBottom="8dip"
  android:paddingLeft="10dip"
  android:paddingRight="10dip"
  android:paddingTop="8dip" >
  </LinearLayout>
  <ListView android:id="@android:id/list" 
  android:background="@android:color/black"
   android:layout_width="fill_parent" 
   android:layout_height="wrap_content">
  </ListView>
</LinearLayout> 
```

listView 适配器是一个自定义光标适配器。我没有做任何特别的事情，只是从第一个布局中扩充行：

```
public View newView(Context context, Cursor cursor, ViewGroup parent) {
    return mInflater.inflate(R.layout.row_series, null);
} 
```

# vba - 如何访问标志完成日期？

> ID：10234806
> 
> 赞同：3
> 
> 时间：2012-04-19T18:49:56.597
> 
> 标签：vba, outlook

我通过选择“跟进 - 标记已完成选项”将我的电子邮件移动到另一个文件夹。现在我想编写一个程序来检查我今天完成的许多电子邮件，通过比较标志完成日期和今天的日期。

但我无法找到如何访问标志完成日期。

你能帮忙吗？

谢谢，阿洛克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T23:01:12.820

该属性是 Outlook.MailItem.TaskCompletedDate。尝试类似：

```
Sub GetCompletedToday()
Dim olNameSpace As Outlook.NameSpace
Dim olFolder As Outlook.Folder
Dim olMailItem As Outlook.MailItem
Dim CompletedTodayCount As Long

Set olNameSpace = Application.GetNamespace("MAPI")
Set olFolder = olNameSpace.Folders(1).Folders("tester")

For Each olMailItem In olFolder.Items
    If olMailItem.TaskCompletedDate = Date Then
        CompletedTodayCount = CompletedTodayCount + 1
    End If
Next olMailItem
Debug.Print CompletedTodayCount
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:05:13.287

您可以使用`expression.FlagStatus`

看到这个链接

**主题：FlagStatus 属性**

**链接**： http: [//msdn.microsoft.com/en-us/library/aa212013%28v=office.11​​%29.aspx](http://msdn.microsoft.com/en-us/library/aa212013%28v=office.11%29.aspx)

例如，这将为您提供所有选定电子邮件的状态

**展望 VBA 代码**

```
Option Explicit

Sub Sample()
    Dim Messages As Selection
    Dim Msg As MailItem
    Dim NamSpace As NameSpace

    Set NamSpace = Application.GetNamespace("MAPI")
    Set Messages = ActiveExplorer.Selection

    If Messages.Count = 0 Then Exit Sub

    For Each Msg In Messages
        Debug.Print Msg.FlagStatus
    Next
End Sub 
```

对于带有`No flags`它的消息会给你一个`0`

因为`Mark Completed`它会给你`1`和

因为`Other flags`它会给你`2`

因此，您实际上可以使用`If`语句来检查`.FlagStatus`属性和 Mail Date 以实现您想要的。

高温高压

# java - 在返回值的方法中阻止“finally”

> ID：10234810
> 
> 赞同：1
> 
> 时间：2012-04-19T18:50:47.620
> 
> 标签：java, jakarta-mail

我有一个方法，它连接到邮件服务器，获取所有消息并在一个数组中返回这些消息。所以这看起来像这样（伪代码）：

```
public Message[] getMessages() throws Exception {
  try{
      //Connection to mail server, getting all messages and putting them to an array
      return Message[];
  } finally {
      CloseConnectionToMailServer(); //I don't need it anymore, I just need messages
  }
} 
```

我可以将“return”指令放到“finally”块中，但这会禁用潜在的异常。如果我保持现在的状态，永远无法达到“返回”。

我想你抓住了我遇到的问题。我怎样才能得到我需要的所有消息，返回一个包含这些消息的数组，并以一种微妙的方式（甚至是“最佳实践”）关闭与服务器的连接？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:56:40.733

你的方法刚刚好。即使您从 try 块返回 finally 块也会被执行。而且您的方法必须返回一个值：

```
public Message[] getMessages() throws Exception {

  try{
      //Connection to mail server, getting all messages and putting them to an array
      return Message[];
  } finally {
      CloseConnectionToMailServer(); //I don't need it anymore, I just need messages
  }

  return null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:59:28.527

“标准”版本（我见过）是

```
try {
    doStuff()
} catch (Exception e) {
    throw e;
} finally {
    closeConnections();
}
return stuff; 
```

我认为没有理由不适合您的代码。

作为旁注，如果您的代码是“返回数据”的东西，我通常认为将其设置为“public Message[] getStuff() throws SQLException”更容易，然后让调用类处理错误。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-19T18:56:58.787

为什么不这样：

```
public Message[] getMessages() throws Exception {
  Message = null;
  try{
      //Connection to mail server, getting all messages and putting them to an array
      Message = Messages;
  } finally {
      CloseConnectionToMailServer(); //I don't need it anymore, I just need messages
      return Message;
  }
} 
```

# javascript - JSON 劫持注入 - 避免的最佳实践 - 以及哪些浏览器易受攻击？

> ID：10234811
> 
> 赞同：0
> 
> 时间：2012-04-19T18:50:48.463
> 
> 标签：javascript, xml, json, security

保护 json 响应的最佳方法是什么？

我们进行地址验证，它是来自 json 格式的 Web 服务的响应。我们希望得到这样的回应。

有一些提及，使用“while（1）”来导致无限循环，我很想知道其他经过验证的真实方法。

基于： http: [//lab.gsi.dit.upm.es/semanticwiki/index.php/JSON_Hijacking_%28aka_JavaScript_Hijacking%29](http://lab.gsi.dit.upm.es/semanticwiki/index.php/JSON_Hijacking_%28aka_JavaScript_Hijacking%29)

[http://capec.mitre.org/data/definitions/111.html](http://capec.mitre.org/data/definitions/111.html)

***更新***

好的，一个更具体的问题可能是哪些浏览器容易受到这种类型的注入攻击？

并通过 ssl 返回 json 并确保它的语法正确（而不仅仅是一个数组）足以提供安全保障？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:23:37.250

我会做些什么来防止这种攻击（如果我理解你的问题正确的话）如下：

防止 cookie 对 javascript 可用。在 PHP 中设置 cookie 时，您可以选择阻止这种情况：

```
setcookie ('cookie_name', 'value', 1200, '/path', 'www.example.com', true, true); 
```

最后一个 true 意味着 javascript 无法访问。

除了防止您的 cookie 被盗外，您应该始终使用[CSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)保护。

这可以[通过](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet)生成一个随机令牌来完成，并且只允许使用该随机令牌完成请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:57:44.883

您可以查看[https://github.com/chriso/node-validator/blob/master/lib/xss.js](https://github.com/chriso/node-validator/blob/master/lib/xss.js)上的代码。我发现它在防止 xss 类型攻击的检查类型方面非常彻底。

# macos - 如何在无边框窗口中嵌入 NSMenu 以创建假菜单栏

> ID：10234812
> 
> 赞同：0
> 
> 时间：2012-04-19T18:50:48.423
> 
> 标签：macos, cocoa, menubar

我正在尝试在可可应用程序中创建一个假菜单栏。我已经能够完成我需要的 95%，只是菜单栏与 mainMenu 不匹配。请参阅下面我目前所拥有的屏幕截图。

我在 xib 中使用“弹出按钮”对象来尝试模拟系统菜单栏。问题是它是一个弹出菜单，看起来与主菜单不完全一样。此外，标题菜单项不隐藏，并且弹出菜单具有与菜单标题重叠的圆角。所以，它很接近，但没有雪茄。

是否可以在与默认系统菜单栏匹配的无边框窗口内创建一个假菜单栏？如果是这样，怎么做？

我还尝试使用 NSStatusItem，默认情况下，它与系统菜单栏的匹配比我使用按钮能够完成的更接近，但我无法将 NSStatusItem 嵌入到窗口中。

理想情况下，如果有办法将 NSMenu 直接嵌入到 Windows 视图中，那将是最好的解决方案。

![假菜单栏](../Images/71454f588e2fe5b6838c260810ffcab0.png)

![假菜单栏](../Images/72427a0c81eb455a79529cf3b76f3158.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:50:01.137

您需要创建一个外观和行为类似于顶级项目的自定义按钮或视图，然后将 an 分配`NSMenu`给视图的`menu`出口。

然后，您可以`menuForEvent:`在视图中实现并在鼠标按下时返回菜单，或者在单击鼠标时调用`NSMenu`类方法`+popUpContextMenu:withEvent:forView:`。

顺便说一句，这似乎是一个有点奇怪的想法。你为什么要这样做？

# java - 确定来自 ServletContext 的资源是文件还是目录

> ID：10234813
> 
> 赞同：1
> 
> 时间：2012-04-19T18:50:50.957
> 
> 标签：java, servlets

鉴于我们使用下面的代码 Set paths = servletCtxt.getResourcePaths("/app/themes");

我们如何判断路径中的路径是目录还是实际文件？

这通常是在一场压缩战争中。

我确实找到了这个，但我打赌它不可靠：

当它是一个文件

```
servletCtxt.getResource(dir).getContent()
    returned (java.io.ByteArrayInputStream) java.io.ByteArrayInputStream@5a645a64 
```

当它是一个目录时，它返回：

```
(org.apache.naming.resources.FileDirContext) org.apache.naming.resources.FileDirContext@57155715 
```

可以肯定地说我可以在 getContent 返回的内容上使用带有 InputStream 的 instanceof 吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:59:58.137

未经测试，我在 JavaDoc 中看到以下内容[`getResourcePaths()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getResourcePaths(java.lang.String))：

> 指示子目录路径的路径以 / 结尾。
> 
> [...]
> 
> 例如，对于包含以下内容的 Web 应用程序：
> 
> *   `/welcome.html`
>     
>     
> *   `/catalog/index.html`
>     
>     
> *   `/catalog/products.html`
>     
>     
> *   `/catalog/offers/books.html`
>     
>     
> *   `/catalog/offers/music.html`
>     
>     
> *   `/customer/login.jsp`
>     
>     
> *   `/WEB-INF/web.xml`
>     
>     
> *   `/WEB-INF/classes/com.example.OrderServlet.class`
>     
>     
> *   `/WEB-INF/lib/catalog.jar!/META-INF/resources/catalog/moreOffers/books.html`
>     
>     
> 
> `getResourcePaths("/")`会回来`{"/welcome.html", "/catalog/", "/customer/", "/WEB-INF/"}, and getResourcePaths("/catalog/")`会回来`{"/catalog/index.html", "/catalog/products.html", "/catalog/offers/", "/catalog/moreOffers/"}`。

似乎您可以简单地依赖路径的最后一个字符。

# python - 此问题的智能语法

> ID：10234815
> 
> 赞同：1
> 
> 时间：2012-04-19T18:50:57.923
> 
> 标签：python

我有清单清单。让我们这样说：

```
somelist = [ 
               [1, 2, 3],
               [4, 8, 2],
               [7, 8, 4, 8, 2],
           ] 
```

这里我的列表包含 3 个列表。使用列表`len(list) == 3`我想做这样的事情：

```
list1 = somelist[0]
list2 = somelist[1]
list3 = somelist[2]

for l1 in list1:
    for l2 in list2:
        for l3 in list3:
            function(something=[l1, l2, l3]) 
```

但我的清单可以有`2 <= len(somelist) <= 10`。所以如果我的清单有`len(somelist) == 4`我必须做的：

```
list1 = somelist[0]
list2 = somelist[1]
list3 = somelist[2]
list4 = somelist[3]

for l1 in list1:
    for l2 in list2:
        for l3 in list3:
            for l4 in list4:
                function(something=[l1, l2, l3, l4]) 
```

所以我的问题是如何编写适用于不同的漂亮代码`len(somelist)`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T18:54:41.430

我觉得你需要[itertools.product](http://docs.python.org/library/itertools.html#itertools.product)

```
import itertools
for s in itertools.product(*somelist):
    function(something=s) 
```

*----平面优于嵌套。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:54:34.213

应该可以*递归*地执行此操作，并且每次都以[itertools.product](http://docs.python.org/library/itertools.html#itertools.product)的方式*扩展*列表项。`*args`

# windows - 命令提示符：文件大小大于 1024KB 的 dir 文件

> ID：10234817
> 
> 赞同：4
> 
> 时间：2012-04-19T18:51:01.007
> 
> 标签：windows, list, command, prompt

我目前正在使用以下命令来找出有多少具有完整路径的 pdf 格式的文档，但它显示了大约 11,000 个文档的列表，

```
dir *.pdf /s /b** 
```

我只想列出那些文件大小大于 1024KB 的图像，文件大小不应该显示，但文件大小应该大于 1024KB。

使用命令提示符可以吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T19:33:26.353

由于您使用的是 Windows，因此您很可能拥有[powershell](http://msdn.microsoft.com/en-us/library/windows/desktop/ms714415(v=vs.85).aspx)：

```
ls *.pdf | where-object {$_.length -gt 1048576} | format-table -property Name 
```

`ls`将列出带有`.pdf`扩展名的文件。 `where-object`将结果集过滤为长度大于 1MB (1048576 = 1MB) 的文件。 `format-table`将格式化最终输出以仅显示文件名

# php - 带有 Codeigniter 的 jQuery DataTables 不显示数据

> ID：10234822
> 
> 赞同：0
> 
> 时间：2012-04-19T18:51:20.247
> 
> 标签：php, codeigniter, datatables

我正在使用 Codeigniter 构建一个管理面板应用程序，并希望使用 jQuery DataTables 的服务器端处理方法获取我的成员记录（因为我有大量的成员记录）。我正在使用[Ignited DataTables](https://github.com/IgnitedDatatables/Ignited-Datatables/) CI 库来获取并尝试显示我的数据。我能够使用[此处](http://datatables.net/release-datatables/examples/data_sources/server_side.html)找到的 Datatables Server Side Implementation 的独立版本来实现此功能，但希望通过 CodeIgniter 来实现此功能，以便与我的应用程序的其余部分保持一致。到目前为止，这是我的代码：

CI 控制器：

```
$this->load->library('DataTables');
$this->load->model('table_model', 'table');

$this->datatables->select('member_id, username,email, first_name, last_name')
                 ->from($this->table->getTable('members'))
                 ->join($this->table->getTable('groups'), 'members.group_id = member_groups.group_id', 'left')
                 ->select('group_title');

echo $this->datatables->generate();
exit; 
```

HTML：

```
<table id="members">
    <thead>
        <tr>
            <th>Member ID</th>
            <th>Username</th>
            <th>Email</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Group Name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td colspan="7" class="dataTables_empty">Loading members...</td>
        </tr>
    </tbody>
</table> 
```

jQuery：

```
$(document).ready(function() {
    $("#members").dataTable({
        "bProcessing" : true,
        "bServerSide" : true,
        "sAjaxSource" : "/members/fetch_members",
        "sPaginationType" : "full_numbers"
    });
}); 
```

JSON响应：

```
{
    "sEcho": 0,
    "iTotalRecords": 11007,
    "iTotalDisplayRecords": 11007,
    "aaData": [ //member records here],
    "sColumns": "member_id,username,email,first_name,last_name,group_title"
} 
```

任何和所有的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T13:48:13.740

您必须修改库以使用 POST 而不是 GET

或者

您必须配置数据表才能使用 GET

这是配置方法的示例，请根据需要使用它

[http://www.datatables.net/release-datatables/examples/server_side/post.html](http://www.datatables.net/release-datatables/examples/server_side/post.html)

# wcf - WCF serviceBehaviors 与绑定设置

> ID：10234831
> 
> 赞同：5
> 
> 时间：2012-04-19T18:51:54.490
> 
> 标签：wcf

在 WCF 中，绑定设置 maxConnections 和 ServiceBehaviors serviceThrottling 设置（maxConcurrentCalls、maxConcurrentInstances、maxConcurrentSessions）有什么区别？

我正在尝试设置我的 WCF 服务，但我不确定它们如何相互协作以限制连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:05:46.880

有两件事需要考虑：

1.  该`serviceThrottling`行为是一种**服务/服务器端**设置，用于确定服务器支持多少并发调用、实例和会话。这独立于任何绑定或服务端点——它是一个服务范围的设置。这允许您调整特定服务可以处理多少并发请求（和/或会话）——这取决于服务器“功率”、RAM、CPU 和更多因素等因素。默认情况下，这些值保持相当低，以避免服务器“过载”，从而因大量请求（错误或恶意）而导致无响应

2.  绑定上的`maxConnections`设置特定于**`netTcpBinding`**（并且它是“表兄弟”，例如`netNamedPipe`和各种面向 Azure 的`net***Relay`绑定），并且与连接池有关。就像 ADO.NET 数据库连接被池化一样，到服务器的 TCP/IP 连接可以被池化和重用，以减少必须销毁和重新创建它们的开销。这主要是客户端设置（尽管它也对服务器端产生影响），并且再次：它特定于`netTcpBinding`（和表亲；都基于 TCP/IP）并且对于任何其他绑定都不存在.

    请参阅：[有关 MaxConnections](http://kennyw.com/?p=181)的更多详细信息，以深入了解此设置的来龙去脉。

# c++ - 简单的类会导致错误

> ID：10234832
> 
> 赞同：-1
> 
> 时间：2012-04-19T18:51:56.280
> 
> 标签：c++, oop

我有 3 个用 c++ 编码的类。它们都很简单，但是编译器给出了很多错误。每个类都有一个cpp文件和头文件。可能的问题是什么？其中之一是“未定义的基类”。

```
class re {
  int i;
  int j;
  string a;
  re(int,int,int);
  ~re();
}

class Pre:public re {
  int k;
  public:
    Pre(int,int,int);
   ~Pre();
}

class MPre:public Pre {
  int z;
  public:
      MPre(int);
     ~Mpre(int);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:53:10.567

可能的错误：

*   re 类构造函数不是公开的。你知道吗？

*   MPre 构造函数得到一个输入，因此您必须为 Pre 类编写默认构造函数。

*   添加头文件时要小心。例如 Pre class 需要 re class 的头文件。

*   此外，除非您将指针变量添加到类，否则您不需要编写析构函数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:58:14.740

类声明中缺少分号。此外，为了很好地将不同 .h .cpp 文件中的所有类分开，这样您就可以避免包含不需要的代码，以防万一您不需要它。此外，在继承的情况下，请确保您的析构函数是虚拟的，否则会产生内存泄漏。

此外，re 的构造函数不公开，使其公开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T18:55:24.433

对于错误`undefined base class`，我认为您没有在其他类所在的文件中声明`#include`该类的文件。`re`

# actionscript-3 - hitTestObject() 碰撞以某种方式无法正常工作

> ID：10234835
> 
> 赞同：0
> 
> 时间：2012-04-19T18:52:15.047
> 
> 标签：actionscript-3, flash

或者至少我是这么认为的。

我刚从 AS3 开始，我正在尝试做一个小游戏，其中一个球自己移动，另一个球由玩家处理。到目前为止，一切都很好。这样可行。

什么不工作是 hitTestObject(); 它只是在距离另一个对象 2 厘米时返回 true。这是一张图片，您可以看到：[http ://dl.dropbox.com/u/37057843/coll2.jpg](http://dl.dropbox.com/u/37057843/coll2.jpg)

我读过 hitTestObject 只是在对象周围创建一个矩形，然后在这些矩形上测试碰撞，是不是因为这个？

如果您需要任何代码，我会提供。我知道还有其他一些开源库/引擎，比如 Box2D，可以更好地解决这个问题，但我不想直接跳到引擎。

谢谢阅读！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:05:28.857

是的，hitTestObject 将使用剪辑边界框。

看看这个链接，它有很多很棒的信息以及一个可以做你正在寻找的课程

[http://sierakowski.eu/list-of-tips/39-collision-detection-methods-hittest-and-hittestobject-alternatives.html](http://sierakowski.eu/list-of-tips/39-collision-detection-methods-hittest-and-hittestobject-alternatives.html)

直接链接到包

[http://code.google.com/p/collisiondetectionkit/](http://code.google.com/p/collisiondetectionkit/)

# delphi - Delphi 线路组件

> ID：10234836
> 
> 赞同：2
> 
> 时间：2012-04-19T18:52:16.433
> 
> 标签：delphi, line, vcl

我正在寻找一个线路组件。

我看过几个例子，但是他们没有启用

*   以任何角度绘制的线，或
*   具有不同的线条图案 - 点/破折号
*   等等

我希望能够做一些类似于 MS word 中的 INSERT/SHAPES/LINE 的事情，我可以在末端抓住锚点并以任何角度拖动......

这是我发现的：[TLine v.1.0](http://www.torry.net/authorsmore.php?id=3649)

但它只能让我画水平线或垂直线，而不是 17 度的线。

这个[链接](http://www.rick_b.dds.nl/tools/PolyLines/)是我想做的事情的类型，在行尾有锚点，所以我可以在运行时单击它们并拖动行

有谁知道一个组件（免费软件）

*   可以做我想做的或
*   帮助将上述内容转换为我想要的，或
*   任何可能有帮助的建议..

提前致谢...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T20:40:06.847

我了解到您找到了一个组件，但它缺少您想要的一些属性。好吧，我看了一下是如何`TShape`制作的，并提出了以下尝试：

### 更新：

属性`AutoAngle`并`Backwards`添加。

```
unit Line;

interface

uses
  Windows, Classes, Controls, Graphics, StdCtrls, Math;

type
  TLine = class(TGraphicControl)
  private
    FAlignment: TAlignment;
    FAngle: Integer;
    FAutoAngle: Boolean;
    FLayout: TTextLayout;
    FPen: TPen;
    function DiagonalAngle: Integer;
    function GetBackwards: Boolean;
    function GetExtends(LimitWidth, LimitHeight: Integer): TRect;
    procedure PenChanged(Sender: TObject);
    procedure SetAlignment(Value: TAlignment);
    procedure SetAngle(Value: Integer);
    procedure SetAutoAngle(Value: Boolean);
    procedure SetBackwards(Value: Boolean);
    procedure SetLayout(Value: TTextLayout);
    procedure SetPen(Value: TPen);
  protected
    procedure AdjustSize; override;
    function CanAutoSize(var NewWidth, NewHeight: Integer): Boolean; override;
    procedure Paint; override;
    procedure Resize; override;
  public
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;
  published
    property Align;
    property Alignment: TAlignment read FAlignment write SetAlignment
      default taCenter;
    property Anchors;
    property Angle: Integer read FAngle write SetAngle;
    property AutoAngle: Boolean read FAutoAngle write SetAutoAngle
      default True;
    property AutoSize;
    property Backwards: Boolean read GetBackwards write SetBackwards
      stored False;
    property Constraints;
    property DragCursor;
    property DragKind;
    property DragMode;
    property Enabled;
    property Layout: TTextLayout read FLayout write SetLayout default tlCenter;
    property OnContextPopup;
    property OnDragDrop;
    property OnDragOver;
    property OnEndDock;
    property OnEndDrag;
    property OnMouseDown;
    property OnMouseMove;
    property OnMouseUp;
    property OnStartDock;
    property OnStartDrag;
    property ParentShowHint;
    property Pen: TPen read FPen write SetPen;
    property ShowHint;
    property Visible;
  end;

procedure Register;

implementation

procedure Register;
begin
  RegisterComponents('Samples', [TLine]);
end;

{ TLine }

procedure TLine.AdjustSize;
begin
  if AutoSize then
    FAutoAngle := False;
  inherited AdjustSize;
end;

function TLine.CanAutoSize(var NewWidth, NewHeight: Integer): Boolean;
begin
  with GetExtends(NewWidth, NewHeight) do
  begin
    NewWidth := Right;
    NewHeight := Bottom;
  end;
  Result := True;
end;

constructor TLine.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  ControlStyle := ControlStyle + [csReplicatable];
  Width := 65;
  Height := 65;
  FPen := TPen.Create;
  FPen.OnChange := PenChanged;
  FAlignment := taCenter;
  FLayout := tlCenter;
  FAutoAngle := True;
end;

destructor TLine.Destroy;
begin
  FPen.Free;
  inherited Destroy;
end;

function TLine.DiagonalAngle: Integer;
begin
  if Width = FPen.Width then
    Result := 90
  else if Height = FPen.Width then
    Result := 0
  else
    if Backwards then
      Result := 180 - Round(RadToDeg(ArcTan(Height / Width)))
    else
      Result := Round(RadToDeg(ArcTan(Height / Width)));
end;

function TLine.GetBackwards: Boolean;
begin
  Result := FAngle > 90;
end;

function TLine.GetExtends(LimitWidth, LimitHeight: Integer): TRect;
begin
  Result.Left := 0;
  Result.Top := 0;
  if FAngle = 0 then
  begin
    Result.Right := LimitWidth;
    Result.Bottom := FPen.Width;
  end
  else if FAngle = 90 then
  begin
    Result.Right := FPen.Width;
    Result.Bottom := LimitHeight;
  end
  else
  begin
    Result.Right := Min(LimitWidth,
      Round(LimitHeight / Abs(Tan(DegToRad(FAngle)))));
    Result.Bottom := Min(LimitHeight,
      Round(LimitWidth * Abs(Tan(DegToRad(FAngle)))));
  end;
end;

procedure TLine.Paint;
var
  R: TRect;
begin
  Canvas.Pen.Assign(FPen);
  Canvas.Brush.Style := bsClear;
  R := GetExtends(Width, Height);
  case FAlignment of
    taCenter:
      OffsetRect(R, (Width - R.Right) div 2, 0);
    taRightJustify:
      OffsetRect(R, Width - R.Right, 0);
  end;
  case FLayout of
    tlCenter:
      OffsetRect(R, 0, (Height - R.Bottom) div 2);
    tlBottom:
      OffsetRect(R, 0, Height - R.Bottom);
  end;
  if FAngle = 0 then
  begin
    Canvas.MoveTo(R.Left, R.Top + FPen.Width div 2);
    Canvas.LineTo(R.Right, R.Top + FPen.Width div 2);
  end
  else if FAngle = 90 then
  begin
    Canvas.MoveTo(R.Left + FPen.Width div 2, R.Top);
    Canvas.LineTo(R.Left + FPen.Width div 2, R.Bottom);
  end
  else if FAngle < 90 then
  begin
    Canvas.MoveTo(R.Left, R.Bottom);
    Canvas.LineTo(R.Right, R.Top);
  end
  else
  begin
    Canvas.MoveTo(R.Left, R.Top);
    Canvas.LineTo(R.Right, R.Bottom);
  end;
end;

procedure TLine.PenChanged(Sender: TObject);
begin
  AdjustSize;
  Invalidate;
end;

procedure TLine.Resize;
begin
  if FAutoAngle then
    Angle := DiagonalAngle;
  inherited Resize;
end;

procedure TLine.SetAlignment(Value: TAlignment);
begin
  if FAlignment <> Value then
  begin
    FAlignment := Value;
    Invalidate;
  end;
end;

procedure TLine.SetAngle(Value: Integer);
begin
  while Value < 0 do
    Inc(Value, 180);
  while Value >= 180 do
    Dec(Value, 180);
  if FAngle <> Value then
  begin
    FAngle := Value;
    if FAngle <> DiagonalAngle then
      FAutoAngle := False;
    if AutoSize then
      AdjustSize;
    Invalidate;
  end;
end;

procedure TLine.SetAutoAngle(Value: Boolean);
begin
  if FAutoAngle <> Value then
  begin
    FAutoAngle := Value;
    if FAutoAngle then
    begin
      AutoSize := False;
      Angle := DiagonalAngle;
    end;
  end;
end;

procedure TLine.SetBackwards(Value: Boolean);
begin
  if Backwards <> Value then
    Angle := 180 - FAngle;
end;

procedure TLine.SetLayout(Value: TTextLayout);
begin
  if FLayout <> Value then
  begin
    FLayout := Value;
    Invalidate;
  end;
end;

procedure TLine.SetPen(Value: TPen);
begin
  FPen.Assign(Value);
end;

end. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T15:30:48.907

EFG 的计算机实验室图形[线拉伸](https://web.archive.org/web/20190105013700/http://www.efg2.com:80/Lab/Graphics/LineStretch.htm)与您正在寻找的内容很接近。

外观和感觉：

[![](../Images/b6a8de1bd93920424fa96ca41fe8016c.png)](https://i.stack.imgur.com/Jn6Ze.jpg)
[（来源：[efg2.com](http://www.efg2.com/Lab/Graphics/ScreenLineStretch.jpg)）]

# android - 为什么这段代码不能在 HTC 上运行而在其他安卓手机上运行？

> ID：10234837
> 
> 赞同：-1
> 
> 时间：2012-04-19T18:52:17.487
> 
> 标签：android, layoutparams

我的意思是我写了这段代码：

```
getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON); 
```

它在索尼、三星上运行...但在 HTC 手机（野火 s）上出现错误。为什么？

也许这是原因？

```
java.lang.IllegalArgumentException: View not attached to window manager
at android.view.WindowManagerImpl.findViewLocked(WindowManagerImpl.java:381)
at android.view.WindowManagerImpl.removeView(WindowManagerImpl.java:226)
at android.view.Window$LocalWindowManager.removeView(Window.java:432)
at android.app.Dialog.dismissDialog(Dialog.java:278)
at android.app.Dialog.access$000(Dialog.java:71)
at android.app.Dialog$1.run(Dialog.java:111)
at android.app.Dialog.dismiss(Dialog.java:268)
at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:169)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3691)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:907)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:665)
at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:02:57.497

当您将此标志设置为其窗口时，您的活动似乎不可见。相反，我建议您将以下属性添加到您的任何视图中。

```
android:keepScreenOn="true" 
```

另一个原因可能是由于方向变化。如果您正在运行**AsyncTask**并且同时方向发生变化，它实际上会破坏活动并重新创建它。现在，如果 AsyncTask 完成它的工作，它会尝试更新不再可用的活动并崩溃。

# c++ - 将屏幕内存捕获到位图（visual c++ 6.0）

> ID：10234840
> 
> 赞同：0
> 
> 时间：2012-04-19T18:52:23.117
> 
> 标签：c++, visual-c++, mfc

我正在使用 Visual c++ 6.0，需要将屏幕上的图像捕获到内存中。我该怎么做呢？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T19:00:01.630

*   获取屏幕的 DC`GetDC(NULL)`
*   用 . 创建一个内存 DC `CreateCompatibleDC`。
*   创建与屏幕 DC 兼容且与屏幕大小相同的位图。
*   选择位图放入内存 DC。
*   BitBlt 从屏幕 DC 到内存 DC。
*   从内存 DC 中取消选择位图。
*   用于`GetBitmapBits`将位图复制到内存中。

# python - Python正则表达式问题

> ID：10234841
> 
> 赞同：0
> 
> 时间：2012-04-19T18:52:24.593
> 
> 标签：python

我有一个这种类型的字符串：

```
s = "//name#1  un2 //name2#1  u13 //name3#3" 
```

我怎样才能得到这些字符串数组：

```
s1 [] = "//name, //name2, name3"
s2 [] = "1, 2, 3" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:55:33.770

只需一个正则表达式即可：

```
>>> s = "//name#1  un2 //name2#1  u13 //name3#3"
>>> import re
>>> x = re.findall(r"(\S+)#(\S+)", s)
>>> [s1, s2] = [', '.join(y) for y in zip(*x)]
>>> s1
'//name, //name2, //name3'
>>> s2
'1, 1, 3' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:02:34.453

可能你正在寻找

```
>>> s1=", ".join(re.findall("(//.*?)#\d+",s))
>>> s2=", ".join(re.findall("#(\d+)",s))
>>> s1
'//name, //name2, //name3'
>>> s2
'1, 1, 3'
>>> 
```

# java - initContext.lookup() 和 mysqlDB 名称有什么关系？

> ID：10234845
> 
> 赞同：0
> 
> 时间：2012-04-19T18:52:56.997
> 
> 标签：java, mysql, jersey

我已将本地主机实现移至另一台服务器并尝试使用另一个 mySQL DB。

但是当我做的时候我得到一个空指针异常

```
 dataSource.getConnection(); 
```

****会不会是我的 jdbc 驱动有问题？****

堆栈跟踪：

```
java.lang.NullPointerException
testProject.resources.ItemsResource.getItemsBrowser(ItemsResource.java:79)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method.invoke(Method.java:616)
com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)
com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$TypeOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:185)
com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)
com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1483)
com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1414)
com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1363)
com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1353)
com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:414)
com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:537)
com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:708)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 
```

代码：

```
// For the browser
@GET
@Produces(MediaType.TEXT_XML)
public Item getItemHTML() {

    java.sql.Connection connection;
    java.sql.Statement statement;

    Item item = null;
    ResultSet resultSet = null;

    try {

                    connection = dataSource.getConnection();
        statement = connection.createStatement();

        String query = "SELECT * FROM ITEMS WHERE itemID = " + id ;

        resultSet = statement.executeQuery(query); 
```

第 78 行是 connection = dataSource.getConnection();

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:00:44.523

java:comp/env 是 Java EE 服务器命名空间。jdbc/fyproj 是您在上下文文件中定义的数据源名称。

在应用服务器启动时，它会加载上下文文件并创建使用 jndi 字符串和在上下文文件中指定的数据库详细信息定义的数据源。

当您想使用数据源时，您需要使用 JNDI 字符串（这是您的数据源绑定的服务器 JNDI 空间 (java:comp/env) 和定义的数据源名称 (jdbc/fyproj) 的组合）。

上下文文件中的数据源配置包含与数据库相关的所有详细信息。因此，jdbc/fyproj 不必是数据库名称。您使用的真实数据库将在数据源定义中。

# java - JTable 打印顶部带有前缀文本（不是页眉/页脚）

> ID：10234848
> 
> 赞同：2
> 
> 时间：2012-04-19T18:53:10.093
> 
> 标签：java, swing, printing, jtable, graphics2d

我想在 JTable 的顶部打印一个特定的文本，但不是在每一页（不是页眉）中，只是在第一页和/或文本末尾的文本，但又不是作为每页的页脚，而是仅在 JTable 内容结束后。

这怎么可能 ？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T20:02:35.533

JTable 有一个 print() 版本，您可能可以使用一个示例。看看它的源代码。

`public boolean print(PrintMode printMode, MessageFormat headerFormat, MessageFormat footerFormat, boolean showPrintDialog, PrintRequestAttributeSet attr, boolean interactive, PrintService service)`

还要看看`getPrintable(...)`JTable 中的方法和`javax.swing.TablePrintable`类。您将不得不做一些自定义打印代码，但 TablePrintable 是一个好的开始。有一个使用 pageIndex 的 print() 方法，您可以执行非常类似的操作，但不要在每一页上打印页眉和页脚。

# javascript - JavaScript 垃圾收集似乎没有在 Chrome 扩展程序 background.html 中运行

> ID：10234853
> 
> 赞同：1
> 
> 时间：2012-04-19T18:53:40.577
> 
> 标签：javascript, jquery, google-chrome, google-chrome-extension

我正在编写 Chrome 扩展程序。我有一个在后台计时器（setInterval）上运行的 $.post() 命令。回调调用解析函数：

```
function parseData(new_data) {
  new_data = $.parseJSON( new_data );
  for(var x=0; x<new_data.length; x++) {
    var obj = new CustomObj( new_data[x] );
    // I commented out code here in order to help isolate the problem.
  }
} 
```

CustomObj 以典型的 JS 方式进行原型设计...

```
function CustomObj(data){
   this.data = data;
}
CustomObj.prototype.getName = function() {
  return this.data.name;
}
// Of course, there are a few more methods here... 
```

问题：扩展将导致严重滞后。如果我将它设置为每 10 秒执行一次 $.post()（只是为了加快问题的出现），在 5 分钟内刷新 Chrome 中的任何选项卡都会显示“等待 [我的扩展程序]”大约 30 秒。最终浏览器或多或少会被锁定。

我发现：如果我注释掉 for() 循环的内部结构，一切都只是桃色。从来没有滞后。如果我只是将上面的行放在 for(); 循环（创建 CustomObj），问题又回来了。

据我所知，这似乎是一个垃圾收集问题。我尝试过隐式定义 obj 变量以及显式删除它（尽管[在 JavaScript 中删除对象](https://stackoverflow.com/questions/742623/deleting-objects-in-javascript)让我相信 delete 是不够的）。似乎没有任何效果。

谢谢。

# java - PromptSupport (SwingX) 和 nimbus L&F

> ID：10234857
> 
> 赞同：2
> 
> 时间：2012-04-19T18:54:10.330
> 
> 标签：java, swing, jtextfield, swingx, nimbus

我对 PromptSupport (SwingX) 和 nimbus L&F 有疑问

我创建了一个 JTextField 并通过以下代码向它添加提示。

```
 JTextField textField = new JTextField(20);
    PromptSupport.setPrompt("promptText", textField); 
```

问题是文本字段中的提示正确显示，但是当我在文本字段中键入一些文本时，其背景变为灰色。

我运行 swingx 演示，它有同样的问题。键入时我需要做什么才能将 textField 的背景更改为 WHITE？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T23:40:58.700

当 swingx 从 xswingx 复制源代码时，他们没有调查问题以了解问题是如何[解决](http://code.google.com/p/xswingx/issues/detail?id=10)的。我记得我用那个修复程序重新编译了 xswingx，但是现在我升级到了 swingx 1.6.3，它又回来了。为了我的理智，请在他们的错误跟踪器中对他们进行错误处理。编辑：虽然他们显然[已经知道](http://java.net/jira/browse/SWINGX-1476)sigh

# ffmpeg - 什么参数或软件最好用于将.MP4转换为.FLV

> ID：10234860
> 
> 赞同：0
> 
> 时间：2012-04-19T18:54:23.137
> 
> 标签：ffmpeg, flv, mp4

我在 Windows 7 上，我有很多 .MP4 视频要在 .flv 上转换。我尝试过 ffmpeg 和 Free FLV 转换器，但每次结果都不是我想要的。

我想要一个相同质量的视频（或几乎，看起来不错）和更小的视频尺寸，因为现在，每次我尝试时，视频结果都很糟糕，视频尺寸只会增加。

我怎样才能有一个好看的视频，尺寸更小，.FLV 格式？

非常感谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T06:51:32.687

首先，请参阅 slhck 关于超级用户的博客文章，以获得良好的[FFmpeg 教程](http://blog.superuser.com/2012/02/24/ffmpeg-the-ultimate-video-and-audio-manipulation-tool/)。FLV 是一种容器格式，可以支持多种不同的视频格式（如 H.264）和音频格式（如 AAC 和 MP3）。MP4 容器还可以支持 H.264 和 AAC，因此如果您的输入使用这些格式，那么您可以简单地将 mp4 中的视频和音频“复制并粘贴”到 flv。这将保持质量，因为没有重新编码。这两个例子做同样的事情，就是将视频和音频从 mp4 复制到 flv，但是 ffmpeg 语法根据您的 ffmpeg 版本而有所不同。如果一个不起作用，请尝试另一个：

```
ffmpeg -i input.mp4 -c copy output.flv
ffmpeg -i input.mp4 -vcodec copy -acodec copy output.flv 
```

但是，您没有提供有关您的输入的任何信息，因此这些示例可能不适合您。要减小文件大小，您需要重新编码。我提供的链接显示了如何做到这一点。请特别注意*恒定速率因子*部分。

# drupal-7 - Drupal 7 - 将内容正文放在灯箱中

> ID：10234861
> 
> 赞同：0
> 
> 时间：2012-04-19T18:54:27.660
> 
> 标签：drupal-7, lightbox

我正在开发一个使用日历模块的 drupal 7 站点。我创建了一个内容类型“事件”，其中包括事件标题、描述和时间。

我想将此信息显示到某种灯箱中。我研究了 lightbox2 和 colorbox 模块，但似乎它们主要用于媒体。

有没有人这样做和/或对我如何做到这一点有任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T20:30:29.237

日历模块内置了一个弹出选项。如果您想要另一个替代方案，您可以查看具有颜色框集成的[Fullcalendar 模块](http://drupal.org/project/fullcalendar)，无论如何我认为它是一个更好的日历。

# git - 如果代码过时，有什么方法可以默认 git svn dcommit 失败？

> ID：10234862
> 
> 赞同：1
> 
> 时间：2012-04-19T18:54:30.423
> 
> 标签：git, svn, git-svn, rebase, dcommit

如果我没有使用最新代码重新设置基础，我喜欢（普通）git 不会让我推送。但是使用 git svn，当我执行 git svn dcommit 时，它会自动变基（即 git svn rebase）然后提交。如果有新的东西要变基，有没有办法让它抛出错误消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:09:48.500

没门。总是有可能有人会在您进行任何检查后立即提交，并且就在您实际提交某事之前。`git svn fetch`之前每次运行`git svn dcommit`几乎可以确定 git 不会自动变基。

# sql - 来自日期时间函数的 SQL 复合键

> ID：10234866
> 
> 赞同：0
> 
> 时间：2012-04-19T18:54:41.267
> 
> 标签：sql, sqlite, datetime, composite-key

我正在尝试使用 SQLite 的一些函数创建一个复合键，但列 'newdate' 和 'newckey' 并且在我运行查询时显示为空白。有什么建议吗？

```
SELECT *,
       (repeat||date) as 'ckey', 
       (repeat||newdate) as 'newckey' 
FROM (SELECT transactions.id,
             transactions.repeat,
             transactions.date, 
             datetime(transactions.date,'+'||repeattransactions.interval||' days') 
                   AS 'newdate' 
      FROM transactions, repeattransactions 
      WHERE transactions.repeat = repeattransactions.id
     ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:11:12.737

SQL 本身没有问题，日期以错误的格式存储，包括本地时区信息

# asp.net-mvc - 发布参考类型

> ID：10234869
> 
> 赞同：1
> 
> 时间：2012-04-19T18:54:45.043
> 
> 标签：asp.net-mvc

我有一个强类型视图 ( `IEnumerable<Client>`)，我需要将客户端发布到操作中。

使用：

```
[HttpPost]
public ActionResult Index(Client client) 
```

当我使用`@Html.TextBox("Client.Name")`并发布它时，在我的操作中我收到一个所有属性都为空的客户端对象。

当我使用`@Html.TextBox("Name")`并发布它时，在我的操作中我收到一个空值。

## 我怎样才能做到这一点？

嗯......我重新打开我的解决方案，它适用于 '@Html.TextBox("Name");'...... 魔术......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T09:52:29.233

对于 ASP.NET MVC 中的模型绑定，您应该使用模型的属性名称而不使用输入元素的类名称。所以它应该是`@Html.TextBox("Name")`而不是`@Html.TextBox("Client.Name")`。

假设您在 Client 类中有一个引用类型属性（ReferenceTypeProperty），并且您想在提交时映射该属性（成员），那么您应该使用`@Html.TextBox("ReferenceTypeProperty.Member")`.

# linux - 从终端更改 Ubuntu 12.04 中的系统代理设置

> ID：10234872
> 
> 赞同：8
> 
> 时间：2012-04-19T18:54:52.863
> 
> 标签：linux, bash, ubuntu, configuration, proxy

我一直在 Ubuntu 12.04 中工作，我试图在 Bash 脚本中实现的一件事是修改系统的代理设置。澄清一下，这将是一个脚本，用于设置我使用我需要的程序和包制作的每个 VM。我可以通过系统设置并选择网络手动查找和编辑代理设置，但我的目的是自动化这部分。

到目前为止，我尝试过的代码是：

```
gconftool --set /system/http_proxy/host --type string *host*
gconftool --set /system/http_proxy/port --type int *port*
gconftool --set /system/http_proxy/use_http_proxy --type bool true
gconftool --set /system/http_proxy/use_same_proxy --type bool true
gconftool --set /system/proxy/mode                --type string manual 
```

我也用`gconftool-2`. 任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-25T10:32:45.823

您必须使用新`gsettings`工具而不是旧的 gconftool，并使用一些不同的键：

```
gsettings set org.gnome.system.proxy.socks host '127.0.0.1'
gsettings set org.gnome.system.proxy.socks port 3128
gsettings set org.gnome.system.proxy mode 'manual'

# to disable proxy:
# gsettings set org.gnome.system.proxy mode 'none' 
```

# iphone - Restkit 核心数据与 NSManagedObjectContext 集成

> ID：10234879
> 
> 赞同：3
> 
> 时间：2012-04-19T18:55:26.670
> 
> 标签：iphone, ios, core-data, restkit

在过去的几周里，我正在学习 Restkit (v0.10.0) 和核心数据，这些出色的工具提供了无限的可能性。问题是我对如何在这里看到更大的图景有点不知所措。而且由于 Restkit 的更新速度非常快，大多数教程/演示代码已经过时并且不再正常工作。

我已经设法让我的 tableview 充满了远程服务器上我的 json 中的数据。我还研究了如何使远程数据与缓存相结合现在工作，但我正在努力解决 NSManagedObjectContext/NSEntityDescription（核心数据）以及在使用 POST 命令时它如何与 Restkit 一起工作。

如果我理解正确，记录是在 Core Data 中创建的（在注释行 // Create a new instance 之后），然后该数据用于创建 POST 请求，以便将记录发布到服务器。

此代码用于在服务器上创建一条新记录，但是当代码执行时（我看到在我的服务器上创建了一条记录）但我的 tableview 没有相应更新，table view 没有更新，因此新记录是重新启动应用程序时首次可见。从服务器手动刷新数据也无济于事。

希望有人可以给我一些指示，或者可能是一个包含 Restkit/核心数据和 POST 的教程。谢谢！

```
- (void)createGoalWithName:(NSString *)name andDescription:(NSString *)goalDescription
{
    Goal* goal = [Goal object];
    goal.identifier = 0;
    goal.name = name;
    goal.goalDescription = goalDescription;

    // Create a new instance of the entity managed by the fetched results controller.
    NSManagedObjectContext *context = [self.fetchedResultsController managedObjectContext];
    NSEntityDescription *entity = [[self.fetchedResultsController fetchRequest] entity];
    [NSEntityDescription insertNewObjectForEntityForName:[entity name] inManagedObjectContext:context];

    [self saveContext];

    [[RKObjectManager sharedManager].router routeClass:[Goal class] toResourcePath:@"/api/goals" forMethod:RKRequestMethodPOST];

    [[RKObjectManager sharedManager] postObject:goal delegate:self];

    [self.tableView reloadData];
}

- (void)saveContext {
    NSManagedObjectContext *context = [self.fetchedResultsController managedObjectContext];
    NSError *error = nil;
    if (![context save:&error]) {
    /*
     Replace this implementation with code to handle the error appropriately.

     abort() causes the application to generate a crash log and terminate. 

     You should not use this function in a shipping application, 
     although it may be useful during development. 

     If it is not possible to recover from the error, 
     display an alert panel that instructs the user to quit the application by pressing the Home button.
     */
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T11:31:56.103

使用 RestKit+CoreData 时必须使用块，并忘记路由器设置：

```
NSString *postUrl = @"/someurl/newelement";    
[ [RKObjectManager sharedManager] loadObjectsAtResourcePath:postUrl usingBlock:^(RKObjectLoader* loader) {
    loader.serializationMIMEType = RKMIMETypeJSON;

    loader.delegate = nil;
    loader.targetObject = nil;
    loader.method= RKRequestMethodPOST; // change to GET, POST, PUT etc
}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T16:52:10.130

由于您不包含 UI 代码，因此很难完全诊断此问题，但是当您重新启动应用程序时显示更新可能会发生一件事，那就是您没有正确同步各个线程之间的更改本地托管对象上下文。RestKit 有自己的托管对象上下文，因为它不在主 UI 线程上运行。

在这个 Apple 文档中介绍了在 Core Data 中使用多线程的概念：http: [//developer.apple.com/library/ios/#documentation/cocoa/conceptual/CoreData/Articles/cdConcurrency.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/CoreData/Articles/cdConcurrency.html)但它的要点是您需要注册通知`NSManagedObjectContextDidSaveNotification`，然后`mergeChangesFromContextDidSaveNotification:`在 UI 线程的托管对象上下文上调用以安全地合并在 RestKit 线程上完成的更改。

请记住，通知将发布在 RestKit 线程上，因此您可能必须在主 UI 线程上运行更新，例如在接收通知的方法中如下所示：

```
[self.managedObjectContextForMainThread performSelectorOnMainThread:@selector(mergeChangesFromContextDidSaveNotification:) withObject:notification waitUntilDone:YES]; 
```

属性`NSManagedObjectContext* managedObjectContextForMainThread`已正确初始化以指向 UI 线程的托管对象上下文的位置。

希望这会有所帮助（如果您还没有完全放弃 RestKit ......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T07:37:00.373

我仍在使用稍旧版本的 Restkit。但一个关键要素是必须定义主键属性。这样 Restkit 就可以让你的本地存储对象和服务器对象保持同步。

在您的情况下，为您的目标对象定义映射时，您会这样做：goalMapping.primaryKeyAttribute = @"identifier";

# javascript - 即使跨标签也可以检测空闲时间吗？

> ID：10234885
> 
> 赞同：3
> 
> 时间：2012-04-19T18:55:38.360
> 
> 标签：javascript, detect, python-idle

我有一个脚本，当有新问题发给用户时，它会向用户发送时间敏感的通知。然而，我发现有些人打开他们的电脑去吃午饭，因此错过了通知。

我正在寻找一个脚本来检测用户是否空闲了 5 分钟，如果是这样，它会将它们显示为“离线”并关闭通知。

我很好奇即使跨标签也可以检测到不活动？（例如，如果用户切换到 Facebook.com 的另一个选项卡并在那里保持活跃，即使他们不在我们的网页上，他们也会被视为“活跃”）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:03:48.827

当用户不在您身边时发生的所有事情都无法跟踪（幸运的是）。

所以这不是不可能的（考虑安全性）。

**更新**

现在我想起来了。这*是*可能的，但你不可能做到。如果你的名字是谷歌，你会走得很远，因为很多网站都使用谷歌分析。但除此之外：由于上述原因，不可能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T19:02:44.380

当它们处于活动状态时，将它们的最后一个活动存储在数据库表中。您可以使用鼠标移动、按键或其他一些活动来更新时间戳。在用户将看到其在线/离线状态的页面上，使用 ajax 调用定期轮询该表。如果上次活动时间大于 5 分钟，则将其显示为离线或空闲。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T19:03:36.280

如果我在做这样的事情，我会使用 HTML5 Visibility API 或回退来模糊和聚焦事件，观察用户何时离开页面然后返回......离开意味着取消聚焦浏览器窗口或选项卡（但仍保持页面打开）

但是既然你想对不活动做出反应......嗯，你可以开始一个超时（当然，如果发生诸如提交、单击、更改、鼠标移动等事情，这将需要一个全局事件委托来阻止许多事件）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T09:53:15.293

代码是：

```
var inactivityTime = function () {
    var t;
    window.onload = resetTimer;
    document.onmousemove = resetTimer;
    document.onkeypress = resetTimer;

    function logout() {
        alert("You are now logged out.")
        //location.href = 'logout.php'
    }

    function resetTimer() {
        clearTimeout(t);
        t = setTimeout(logout, 3000)
        // 1000 milisec = 1 sec
    }
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-04T07:42:46.643

我想在我的客户网站上实现这个功能。在网络上没有找到任何闲置的解决方案。最后我不得不修改我的代码，想一些逻辑并实现它。代码如下 -

```
 `/*Put this code inside script tag whereever you want to execute the inactivity popup*/
     var t;
    //set the timeout period  
    var timeoutPeriod = '${inactiveIntervalMillis}';  
    //detect various events  
    callUserEvents();  
     `

//remove the logged Out storage after popup is closed by user  
function removeLocalStorage() {  
localStorage.removeItem("loggedOut");  
}      
//call this function whenever we detect user activity  
function resetUserActivity() {  
resetTimer();  
}  
//If the user is logged out and it clicks on other tabs,the popup will be               displayed there too  
function checkIfUserLoggedOut() {  
    if (localStorage.getItem("loggedOut")) {  
        loadLoginModal("/includes/gadgets/popup-content.jsp", 400, 230,  
            undefined);  
    }  
}  

// Call this method when any window onloads,this helps to check if multiple         tabs are opened by same site  
function incrementCounter() {   
    checkIfUserLoggedOut();  
    if (localStorage.getItem("counter") == "NaN") {  
        localStorage.setItem("counter", "0");  
    } else {  
        var counter = parseInt(localStorage.getItem("counter")) + 1;  
        localStorage.setItem("counter", counter);  
    }  
    resetTimer();  
}  
//after time interval,this method will be called  
function handleIdleTimedOut() {  
//get the current localStorage Object  
    window.sharedCounter = localStorage.getItem("counter");  
//If no tabs are opened,then popup will be shown here.  
    if (window.localCounter == window.sharedCounter) {  
        loadLoginModal("/includes/gadgets/popup-content.jsp", 400,               230,undefined);  
        localStorage.setItem("loggedOut", "true");  
    }   
}  

function resetTimer() {  
//save counterin current Window object,and after timeout period you can     match   it,if by chance multiple tabs were opened,the counter will be     different,popup  wont be shown in current window at incorrect time.  
    window.localCounter = localStorage.getItem("counter");  
    clearTimeout(t);  
    t = setTimeout(handleIdleTimedOut, timeoutPeriod);  
}  
function callUserEvents(){  
window.onload=incrementCounter  
window.onscroll = resetUserActivity;  
window.onmousemove = resetUserActivity;    
window.ondblclick = resetUserActivity;  
window.oncontextmenu = resetUserActivity;  
window.onclick = resetUserActivity;  
window.onkeypress = resetUserActivity;  
window.onpageshow = resetUserActivity;  
window.onresize = resetUserActivity;  
window.onfocus = incrementCounter;  
window.ondrag = resetUserActivity;  
window.oncopy = resetUserActivity;  
window.oncut = resetUserActivity;  
window.onpaste = resetUserActivity;     
}  

` 
```

# android - OpenCV undefined references

> ID：10234894
> 
> 赞同：6
> 
> 时间：2012-04-19T18:56:07.287
> 
> 标签：android, c++, c, opencv, android-ndk

I'm trying to link my JNI Android application with OpenCV but I get these errors

```
./obj/local/armeabi
/libopencv_calib3d.a(calibinit.cpp.o): In function `cvDrawChessboardCorners':
calibinit.cpp:(.text+0x20a): undefined reference to `cvLine'
calibinit.cpp:(.text+0x244): undefined reference to `cvLine'
calibinit.cpp:(.text+0x26e): undefined reference to `cvCircle'
calibinit.cpp:(.text+0x2ec): undefined reference to `cvLine'
calibinit.cpp:(.text+0x4ce): undefined reference to `cvLine'
calibinit.cpp:(.text+0x504): undefined reference to `cvLine'
calibinit.cpp:(.text+0x532): undefined reference to `cvCircle'
./obj/local/armeabi/libopencv_calib3d.a(calibinit.cpp.o): In function `cvFindChessboardCorners':
calibinit.cpp:(.text+0x1b6a): undefined reference to `cvRectangle'
./obj/local/armeabi/libopencv_calib3d.a(calibinit.cpp.o): In function `cv::findCirclesGrid(cv::_InputArray const&, cv::Size_<int>, cv::_OutputArray const&, int, cv::Ptr<cv::FeatureDetector> const&)':
calibinit.cpp:(.text+0x5058): undefined reference to `cv::FeatureDetector::detect(cv::Mat const&, std::vector<cv::KeyPoint, std::allocator<cv::KeyPoint> >&, cv::Mat const&) const'
./obj/local/armeabi/libopencv_calib3d.a(circlesgrid.cpp.o): In function `cv::findCirclesGridDefault(cv::_InputArray const&, cv::Size_<int>, cv::_OutputArray const&, int)':
circlesgrid.cpp:(.text+0x2ce): undefined reference to `cv::SimpleBlobDetector::Params::Params()'
circlesgrid.cpp:(.text+0x2dc): undefined reference to `cv::SimpleBlobDetector::SimpleBlobDetector(cv::SimpleBlobDetector::Params const&)'
./obj/local/armeabi/libopencv_calib3d.a(circlesgrid.cpp.o): In function `CirclesGridFinder::drawHoles(cv::Mat const&, cv::Mat&) const':
circlesgrid.cpp:(.text+0xa56): undefined reference to `cv::line(cv::Mat&, cv::Point_<int>, cv::Point_<int>, cv::Scalar_<double> const&, int, int, int)'
circlesgrid.cpp:(.text+0xafa): undefined reference to `cv::line(cv::Mat&, cv::Point_<int>, cv::Point_<int>, cv::Scalar_<double> const&, int, int, int)'
circlesgrid.cpp:(.text+0xb44): undefined reference to `cv::circle(cv::Mat&, cv::Point_<int>, int, cv::Scalar_<double> const&, int, int, int)'
./obj/local/armeabi/libopencv_calib3d.a(circlesgrid.cpp.o): In function `CirclesGridFinder::drawBasis(std::vector<cv::Point_<float>, std::allocator<cv::Point_<float> > > const&, cv::Point_<float>, cv::Mat&) const':
circlesgrid.cpp:(.text+0x106c): undefined reference to `cv::line(cv::Mat&, cv::Point_<int>, cv::Point_<int>, cv::Scalar_<double> const&, int, int, int)'
./obj/local/armeabi/libopencv_calib3d.a(circlesgrid.cpp.o): In function `CirclesGridFinder::drawBasisGraphs(std::vector<Graph, std::allocator<Graph> > const&, cv::Mat&, bool, bool) const':
circlesgrid.cpp:(.text+0x133c): undefined reference to `cv::circle(cv::Mat&, cv::Point_<int>, int, cv::Scalar_<double> const&, int, int, int)'
circlesgrid.cpp:(.text+0x13bc): undefined reference to `cv::line(cv::Mat&, cv::Point_<int>, cv::Point_<int>, cv::Scalar_<double> const&, int, int, int)'
./obj/local/armeabi/libopencv_calib3d.a(circlesgrid.cpp.o): In function `CirclesGridClusterFinder::parsePatternPoints(std::vector<cv::Point_<float>, std::allocator<cv::Point_<float> > > const&, std::vector<cv::Point_<float>, std::allocator<cv::Point_<float> > > const&, std::vector<cv::Point_<float>, std::allocator<cv::Point_<float> > >&)':
circlesgrid.cpp:(.text+0x3292): undefined reference to `cv::flann::LinearIndexParams::LinearIndexParams()'
circlesgrid.cpp:(.text+0x32c6): undefined reference to `cv::flann::Index::Index(cv::_InputArray const&, cv::flann::IndexParams const&, cvflann::flann_distance_t)'
circlesgrid.cpp:(.text+0x346a): undefined reference to `cv::flann::SearchParams::SearchParams(int, float, bool)'
circlesgrid.cpp:(.text+0x347e): undefined reference to `cv::flann::Index::knnSearch(cv::_InputArray const&, cv::_OutputArray const&, cv::_OutputArray const&, int, cv::flann::SearchParams const&)'
circlesgrid.cpp:(.text+0x3484): undefined reference to `cv::flann::IndexParams::~IndexParams()'
circlesgrid.cpp:(.text+0x3658): undefined reference to `cv::flann::Index::~Index()'
circlesgrid.cpp:(.text+0x365e): undefined reference to `cv::flann::IndexParams::~IndexParams()'
circlesgrid.cpp:(.text+0x36b6): undefined reference to `cv::flann::Index::~Index()'
circlesgrid.cpp:(.text+0x36bc): undefined reference to `cv::flann::IndexParams::~IndexParams()'
circlesgrid.cpp:(.text+0x3702): undefined reference to `cv::flann::IndexParams::~IndexParams()'
circlesgrid.cpp:(.text+0x370c): undefined reference to `cv::flann::Index::~Index()'
./obj/local/armeabi/libopencv_calib3d.a(circlesgrid.cpp.o): In function `CirclesGridFinder::computeRNG(Graph&, std::vector<cv::Point_<float>, std::allocator<cv::Point_<float> > >&, cv::Mat*) const':
circlesgrid.cpp:(.text+0x4b2a): undefined reference to `cv::line(cv::Mat&, cv::Point_<int>, cv::Point_<int>, cv::Scalar_<double> const&, int, int, int)'
circlesgrid.cpp:(.text+0x4b7e): undefined reference to `cv::circle(cv::Mat&, cv::Point_<int>, int, cv::Scalar_<double> const&, int, int, int)'
circlesgrid.cpp:(.text+0x4bd4): undefined reference to `cv::circle(cv::Mat&, cv::Point_<int>, int, cv::Scalar_<double> const&, int, int, int)'
./obj/local/armeabi/libopencv_imgproc.a(contours.cpp.o): In function `cv::drawContours(cv::_OutputArray const&, cv::_InputArray const&, int, cv::Scalar_<double> const&, int, int, cv::_InputArray const&, int, cv::Point_<int>)':
contours.cpp:(.text+0x3fd2): undefined reference to `cvDrawContours'
./obj/local/armeabi/libopencv_imgproc.a(samplers.cpp.o): In function `cvSampleLine':
samplers.cpp:(.text+0x65a2): undefined reference to `cvInitLineIterator'
./obj/local/armeabi/libopencv_imgproc.a(templmatch.cpp.o): In function `cv::crossCorr(cv::Mat const&, cv::Mat const&, cv::Mat&, cv::Size_<int>, int, cv::Point_<int>, double, int)':
templmatch.cpp:(.text+0x47e): undefined reference to `cv::getOptimalDFTSize(int)'
templmatch.cpp:(.text+0x494): undefined reference to `cv::getOptimalDFTSize(int)'
templmatch.cpp:(.text+0x92c): undefined reference to `cv::dft(cv::_InputArray const&, cv::_OutputArray const&, int, int)'
templmatch.cpp:(.text+0xfa4): undefined reference to `cv::dft(cv::_InputArray const&, cv::_OutputArray const&, int, int)'
templmatch.cpp:(.text+0x1006): undefined reference to `cv::mulSpectrums(cv::_InputArray const&, cv::_InputArray const&, cv::_OutputArray const&, int, bool)'
templmatch.cpp:(.text+0x102e): undefined reference to `cv::dft(cv::_InputArray const&, cv::_OutputArray const&, int, int)'
collect2: ld returned 1 exit status
make: *** [obj/local/armeabi/libarengine.so] Error 1 
```

I'm linking with 3 modules: opencv_core opencv_calib3d opencv_imgproc. What am I missing ?

**Edit.** I've added opencv_flann library and reduced the error count. But where are cv::line or for example cv::rectangle are defined ?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-19T21:34:47.990

The problem was in the libraries order. The correct order is:

```
LOCAL_STATIC_LIBRARIES :=  libopencv_calib3d opencv_features2d opencv_flann opencv_imgproc opencv_core 
```

So the main principle is you have to declare libraries in reverse order of their dependency (e.g. *opencv_imgproc* depends on *opencv_core* and *opencv_features2d* depends on *opencv_imgproc* and so on).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T19:35:59.650

You are missing `opencv_highgui` and probably `opencv_features2d` as well.

`cv::rectangle` is defined at `opencv_core`.

Make sure that your file is being linked with all these libraries.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-08T05:17:52.813

You can also look at the output of `pkg-config --static --libs opencv` to arrange the libraries in the correct order.

# infopath - 信息路径形式的可打印非数字签名 - 如何改善用户体验？

> ID：10234897
> 
> 赞同：0
> 
> 时间：2012-04-19T18:56:16.947
> 
> 标签：infopath, user-experience, infopath2010

我在与浏览器兼容的 InfoPath 2010 表单中有一个时间表，该表单正在提交到 SharePoint Enterprise 2010 文档库。时间表必须由用户及其经理签名，并且可以打印（包括签名）。它供内部使用，我们不使用数字签名，因为它们已过期。签名区设置如下：

1.  如果用户选中一个复选框，则会填充两个字段：他们的用户名和当前日期/时间 - 这被视为签名
2.  用户提交表单
3.  工作流程开始通知用户的主管他们需要签名
4.  主管收到工作流电子邮件
5.  主管打开电子邮件，点击链接打开 InfoPath 表单
6.  主管检查主管批准复选框
7.  主管更新工作流程
8.  主管提交表格

我担心主管可能会忘记或不打扰在提交签名表格之前更新工作流程。

有没有更好的方法来收集主管签名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T20:34:44.997

让工作流提交表单怎么样？

假设 (4.) 工作流电子邮件与任务列表相关联，则电子邮件应将人员指向任务项，而不是 InfoPath 表单。

表单可以与任务一起显示（Web 部件），以便主管可以查看数据。当任务完成时（好的，完成，无论如何），工作流会更新 InfoPath 表单上的“批准”框（实际上是您用来处理该字段的任何库/数据库表）。任务（批准此时间表）已完成并记录批准。如果您想要表单的打印副本，您可以从任务完成中触发它，或者只是确保他们知道表单的存储位置。

您必须创建自定义任务页面/表单以包含 InfoPath 显示 Web 部件。

或者，如果您正在做一些事情来自动化表单提交，您可以使用它来完成工作流程（将任务标记为完成）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T20:12:35.093

Initially, I was using the out of the box Approval workflow to send the email to the user's supervisor. What I ended up doing was just sending a custom email to the supervisor with a link to the InfoPath form, so that they could click the checkbox within the form, and not using the Approval workflow at all. This streamlined the process for the supervisor.

# javascript - Node.js for() 循环在每个循环中返回相同的值

> ID：10234898
> 
> 赞同：13
> 
> 时间：2012-04-19T18:56:23.447
> 
> 标签：javascript, node.js, loops

我正在制作这个非常简单的应用程序来帮助我探索 nodejs，并且我有一个特定的处理程序，它可以根据我的数据库中的前 10 条消息生成 HTML 代码。我遇到问题的片段循环遍历消息并调用生成 HTML 的函数并将结果附加到我的 html 字符串。

```
function CreateMessageboard(BoardMessages){
  var htmlMessageboardString = "";

  [... Console debug code ...]

  for(var i = 0; i < BoardMessages.length;i++){
        (function(){
            var j = i;
            console.log("Loading message %d".green, j);
            htmlMessageboardString += MessageToHTMLString(BoardMessages[j]);
          })();
  }
} 
```

我认为我的问题是由于Javascript处理循环的方式，与我读到的闭包有关，这是我在上面尝试使用的，或者是nodejs处理我的函数的异步方式。现在从数据库很好地返回了 10 个结果，但最后一条消息在每个循环中处理。

我也试过，而不是做 var j = i，取值 i 作为函数参数并将它传递到闭包中，无论如何它返回了相同的结果。

我有一种感觉，我缺少解决问题的关键知识，我可以了解一下这个问题吗？

编辑：欢迎我提供有关代码的任何其他信息，我会发布整个 git repo，但人们可能不想浏览整个项目来帮助我调试这个问题，所以我将整个函数发布在评论以提供更多上下文。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-19T19:45:40.303

```
 for(var i = 0; i < BoardMessages.length;i++){
        (function(j){
            console.log("Loading message %d".green, j);
            htmlMessageboardString += MessageToHTMLString(BoardMessages[j]);
        })(i);
  } 
```

那应该行得通；但是，您永远不应该在循环中创建函数。所以，

```
 for(var i = 0; i < BoardMessages.length;i++){
        composeMessage(BoardMessages[i]);
  }

  function composeMessage(message){
      console.log("Loading message %d".green, message);
      htmlMessageboardString += MessageToHTMLString(message);
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T19:36:31.983

我建议以更实用的风格来做这件事：P

```
function CreateMessageboard(BoardMessages) {
  var htmlMessageboardString = BoardMessages
   .map(function(BoardMessage) {
     return MessageToHTMLString(BoardMessage);
   })
   .join('');
} 
```

试试这个

# c# - 通过电子邮件发送唯一标识符

> ID：10234899
> 
> 赞同：0
> 
> 时间：2012-04-19T18:56:27.100
> 
> 标签：c#, asp.net, asp.net-mvc-3

我正在研究 asp.net 应用程序。

我必须开发一个功能，系统管理员应该能够发送邀请以通过电子邮件查看用户特定文档。当用户点击邀请时，系统应该能够识别用户并打开文档。

我正在考虑对每封电子邮件使用 16 位哈希密钥，并在管理员发送邀请时将它们存储在数据库中。当用户点击使用 16 位哈希键检索用户详细信息的邀请时。

但我觉得可能有更好的方法来做到这一点。

请建议我以更好的方式实现该功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:22:12.190

在数据库中创建一个表，其中包含

```
UserDocuments { UserKey, DocumentKey, GUID, IsRead (false by default)} 
```

在此表中存储用户和文档密钥关系。

生成随机公钥 (GUID) 并将此密钥存储在此表中，并使用电子邮件、邮件、电话或任何直接安全的方式将相同的密钥发送给用户。

让文档页面在查询字符串中包含 DocumentKey。

当用户打开文档页面时，根据表中的 DocumentKey、UserKey 对用户进行身份验证。

如果 IsRead 为假，则不允许。

如果身份验证成功，请他们输入 GUID。

如果用户 ID 有效，则再次检查数据库，如果是，则打开文档并将 IsRead 标记为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:07:11.587

如果您的用户通常必须登录，您可能还希望在打开文档（或回答其他问题）之前单击电子邮件中的链接后强制他们登录，尤其是在文档本质上是敏感的情况下。至少您应该在他们打开文档后或经过一段时间后禁用该密钥。

电子邮件帐户一直被黑客入侵，您不希望攻击者能够单击同一链接并访问任何敏感数据。

# python - Python函数：如果只访问它们，则传递全局变量？

> ID：10234901
> 
> 赞同：2
> 
> 时间：2012-04-19T18:56:35.493
> 
> 标签：python, function, variables, arguments, global

我试图了解python的最佳实践。如果我定义一个函数来访问（但不更改）全局变量，则通常不需要在函数中将变量指定为全局变量。但是将全局变量传递给函数会更快吗？我问是因为我遇到了一些关于查找全局变量的成本的参考资料，但我不确定我是否理解。例如：

```
def f1(localList):
    for element in localList:
        if element in globalSet:
            pass #do stuff.

def f2(localList, localSet):
    for element in localList:
        if element in localSet:
            pass #do stuff.

globalList = <arbitrary list>
globalSet  = <arbitrary set>

f1(globalList)
f2(globalList, globalSet) 
```

与 f1 相比，f2 通常被认为是更快/更好/更“pythonic”的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:09:34.480

使用 Globals 总是一个糟糕的设计选择。在任何情况下，您总是可以通过不使用 Globals 来提出一个更加 Pythonic 的解决方案。

*   如果您必须在函数之间共享大量变量，您可以重新考虑 OO 方法。
*   如果您必须将许多参数传递给函数，则可以选择 varargs 或 kargs。

请记住，参数是通过引用传递的，因此不会降低效率。

*----特殊情况不足以打破常规。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:17:21.030

如果数据`globalList`与`globalSet`函数紧密绑定，我将使用一个类并将这些列表定义为类属性，将这些函数定义为静态方法（或实例方法，无论我需要什么）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T19:34:33.840

全局变量[通常被认为是一般编程中的坏习惯](http://en.wikipedia.org/wiki/Global_variable)。基本上是因为任何可以看到变量的代码都可以更改它。尤其是在多线程程序中，这可能是错误的来源。

您应该将 Python 变量视为对象的名称或引用。因此，将变量传递给函数并不昂贵。

# javascript - Facebook Javascript SDK 安全性。Facebook 如何验证 JS SDK 是否加载到应用设置中指定的正确域中

> ID：10234906
> 
> 赞同：1
> 
> 时间：2012-04-19T18:56:42.597
> 
> 标签：javascript, facebook, security, facebook-javascript-sdk

很少有同名的问题，但没有一个是想问我在想什么。所以我们只用 app id 初始化 FB js sdk。通过查看他们的 facebook 初始化源代码很容易知道其他网站的应用程序 ID。有人可能认为黑客可能会尝试使用其他应用程序 ID 初始化 FB JS SDK 并尝试获取他们的用户访问令牌。但是facebook不允许这样的东西。您必须从您在 Facebook 开发人员应用程序页面的站点 url 属性中指定的同一域加载 js sdk。所以问题是他们怎么知道 jsonp 不管调用来自正确的客户端？在客户端检查是不安全的，因为人们可以根据需要复制和修改 javascript。所以它必须是服务器端检查。我只能想到“推荐人检查”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T00:56:45.443

好吧，我不确定，所以这只是猜测..

首先，在发出 http 请求时，会添加[HTTP 引用标头](http://en.wikipedia.org/wiki/HTTP_referer)，因此当您加载 sdk 时，发出请求的 url 将被添加为引用者。Facebook 可以检查其请求的来源服务器，并将其与他们的应用程序设置进行比较。

当然可以在发出请求时修改此标头，这就是为什么如果您在错误的域中仅通过加载应用程序的 sdk 就不会收到任何错误的原因。该错误只会在您尝试与 sdk 交互时发生，例如尝试执行*FB.login*方法将打开身份验证对话框弹出窗口，其中将显示以下错误消息：

> 发生错误。请稍后再试。

如果您检查此身份验证对话框（由 sdk 构建）的 url，您会注意到这两个查询字符串参数：

1.  域=THE_DOMAIN_OF_THE_PAGE
2.  redirect_uri=FACEBOOK_URL 将包含来源、域和关系=opener

（可能）发生的情况是facebook根据应用程序设置检查域，如果没问题，它会向用户显示身份验证对话框，当他完成该过程时，他会被重定向到redirect_uri。

由于redirect_uri 在弹出窗口中打开，它只能与它的打开器通信，如果它们都在同一个域中，一个facebook 域，除了从facebook 提供的页面之外，没有人可以在他的页面上拥有它。

当 sdk 加载时，它会在*fb-root*容器中添加一个 iframe，该容器会加载一个从与 redirect_uri 相同的域加载的 facebook js，因为弹出窗口可以与 iframe 通信并通过身份验证通知它回复。

iframe 收到响应后，弹窗关闭，iframe 将响应通知主页中加载的 sdk。我不确定他们使用哪种技术进行通信，但您可以通过谷歌搜索“跨域 iframe 通信”轻松找到更多信息。

这就是我的看法，但我不能确定。如果您想真正了解发生了什么，您可以查看[js sdk @ github的代码。](https://github.com/facebook/facebook-js-sdk)

# c# - 更改某些 ListView 列的颜色

> ID：10234910
> 
> 赞同：3
> 
> 时间：2012-04-19T18:57:01.857
> 
> 标签：c#, listview, colors, items, subitem

如何更改列表视图中特定列的颜色？

```
string[] row = { appID[i], "Launch Game"}; // more data to add

listView1.Items.Add(nameArray[i], i).SubItems.AddRange(row);

listView1.ForeColor = System.Drawing.Color.Blue; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-19T19:06:13.020

尝试这样的事情：

```
ListViewItem item1 = new ListViewItem( "Item 1"); 
item1.SubItems.Add( "Color" ); 
item1.SubItems[1].ForeColor = System.Drawing.Color.Blue;
item1.UseItemStyleForSubItems = false; 
listView1.Items.Add( item1 ); 
```

如果您使用数据库绑定它，您可能必须在项目数据绑定过程中执行此操作。让我知道是否是这种情况。

# c# - 嵌套 for 循环 - RadioButtonFor 不起作用

> ID：10234911
> 
> 赞同：1
> 
> 时间：2012-04-19T18:57:03.400
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, linq, razor

我在视图中嵌套了 foreach 循环，并且单选按钮有问题。

```
@foreach (var header in Model.surveyHeaders)
{
    <h1>@header.Name</h1>

foreach (var subHeader in Model.surveySubHeaders.Where(x => x.SurveryHeaderID == header.ID))
{
<h2>@subHeader.Name</h2>

    foreach (var question in Model.surveyQuestions.Where(x => x.SurveySubHeaderID == subHeader.ID))
    {
        @Html.RadioButtonFor(x => x.surveyResults.Where(y => y.SurveyQuestionID == question.ID).First().Value, 1);
        @Html.RadioButtonFor(x => x.surveyResults.Where(y => y.SurveyQuestionID == question.ID).First().Value, 2);
        @Html.RadioButtonFor(x => x.surveyResults.Where(y => y.SurveyQuestionID == question.ID).First().Value, 3);            
        @question.Question
    }
} 
```

}

单选按钮名称始终为“值”，因此单选按钮未分组。我可以做些什么来实现所需的分组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T19:23:38.757

啊MVC中的集合，快乐！为了确保所有字段都被相应地命名，以便在帖子上正确绑定模型，您需要使用`for`循环，这将正确设置索引。

在这样做之前，您将不得不调整模型结构以节省您的麻烦。您需要重新安排您的逻辑，以便您拥有一个分层对象模型，您可以在其中更清晰地迭代（这样我们也可以摆脱视图中的逻辑！）

您的调查标题类，您不能在上面放一个子标题列表吗？那么你的副标题类，你能把那个副标题的问题列表放出来吗？这样你就可以做到：

```
@for (var i = 0; i < Model.SurveyHeaders.Count; i++)
{
    <h1>@Model.SurveyHeaders[i].Name</h1>

    for (var j = 0; j < Model.SurveyHeaders[i].SubHeaders.Count; j++)
    {
        <h2>@Model.SurveyHeaders[i].SubHeaders[j].Name</h2>

        for (var k = 0; k < Model.SurveyHeaders[i].SubHeaders[j].Questions.Count; k++)
        {
            @Html.RadioButtonFor(x => x.SurveyHeaders[i].SubHeaders[j].Questions[k].Value , 1);
            @Html.RadioButtonFor(x => x.SurveyHeaders[i].SubHeaders[j].Questions[k].Value , 2);
            @Html.RadioButtonFor(x => x.SurveyHeaders[i].SubHeaders[j].Questions[k].Value , 3);            
            @Model.SurveyHeaders[i].SubHeaders[j].Questions[k].Question
        }
    }
} 
```

这假设您的新模型结构类似于（具有以下类）：

```
public class MyModel
{
    public List<SurveyHeader> SurveyHeaders { get; set; }
}

public class SurveyHeader
{
    public string Name { get; set; }
    public List<SubHeader> SubHeaders { get; set; }
}

public class SubHeader
{
    public string Name { get; set; }
    public List<Question> Questions { get; set; }
}

public class Question
{
    public int Value { get; set; }
    public string Question { get; set; }
} 
```

还有一个提示，供将来参考，您在代码中使用以下 LINQ：

```
x => x.surveyResults.Where(y => y.SurveyQuestionID == question.ID).First().Value 
```

您可以简化它，因为`First`实际上可以像这样使用lamba（尽管`FirstOrDefault`为了安全起见，您将来应该使用和空检查它）：

```
x => x.surveyResults.First(y => y.SurveyQuestionID == question.ID).Value 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:59:50.133

您可以使用接收 HtmlAttributes 的 RadioButtonFor 扩展的重载并设置每个 RadioButtons 的名称。

# c# - 如何在 EF 4.3 中使用带有复杂键的 AddOrUpdate 播种数据

> ID：10234912
> 
> 赞同：105
> 
> 时间：2012-04-19T18:57:03.457
> 
> 标签：c#, entity-framework-4.3, seed, linq-expressions, entity-framework-migrations

我正在尝试使用一些测试数据为开发数据库播种。

我已经使用`context.People.AddOrUpdate(p => p.Id, people));`了很多成功。

我有另一个需要播种的表，其中我不知道主键。

例如，我想根据名字和姓氏匹配来添加或更新。

我不确定如何正确编写表达式。

```
context.People.AddOrUpdate(p => p.FirstName && p.LastName, people); 
```

显然是不正确的，但我希望它传达了我正在寻找的解决方案。

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2012-04-19T20:51:32.273

试试这个：

```
context.People.AddOrUpdate(p => new { p.FirstName, p.LastName }, people); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-17T12:28:24.187

如果您`Only primitive types or enumeration types are supported in this context.`因为使用导航属性而得到 - 考虑将外键属性直接添加到实体（可能仅使用 getter）并按照*Ladislav Mrnka 的*建议使用它。

# twitter-bootstrap - 带有 Twitter Bootstrap 的 1/3 列

> ID：10234916
> 
> 赞同：2
> 
> 时间：2012-04-19T18:57:42.833
> 
> 标签：twitter-bootstrap

我用 Twitter Bootstrap 2.0 创建了一个自定义网格，我试图弄清楚如何更新网格以允许我使用 1/3 和 1/2 列。

看起来你可以使用 1.0：

```
<div class="span-one-third"></div> 
```

有没有人能想出用 2.0 做类似事情的方法，还是我忽略了什么？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-19T23:06:15.917

Bootstrap 过去包含 span-one-third 的原因是网格使用了 16 列。今天，Bootstrap 的网格默认包含 12 列（跨度）。因此，假设您没有自定义网格以使用不同数量的列，只需使用以下内容：

```
<!-- 3-columns, 1/3 each -->
<div class="row">
  <div class="span4">1/3 width</div>
  <div class="span4">1/3 width</div>
  <div class="span4">1/3 width</div> 
</div>  

<!-- 2-columns, 1/2 each -->
<div class="row">
  <div class="span6">1/2 width</div>
  <div class="span6">1/2 width</div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T16:15:56.300

对于较新的版本（从 v2 开始），只需使用 span4 或 col-xx-4 列，因为它是 12 列网格。

对于引导程序 2：

```
<div class="span4"></div> 
```

对于引导程序 3（示例）：

```
<div class="col-sm-4"></div> 
```

**原始和过时的答案**

为了明确起见，这个答案是为了保持与使用 Bootstrap v1 的 HTML 的应用程序的兼容性，这些应用程序没有任何响应的东西并且网格是 16 列（当他们改变它时，一些已经使用 v1 的项目开始了使用带有 16 列的新 v2 版本）。他们实际上有 .span-one-third 等 css 类。

只需实现 bootstrap v1 css（使用网格 16）中的旧值，因为 v2 不再实现它。

```
.span-one-third{width:300px;}
.span-two-thirds{width:620px;}
.offset-one-third{margin-left:340px;}
.offset-two-thirds{margin-left:660px;} 
```

现在你仍然可以拥有 span-one-thirds 和 span-two-thirds 类。这是从引导代码中提取的：[https ://github.com/twbs/bootstrap/blob/v1.3.0/lib/scaffolding.less#L133](https://github.com/twbs/bootstrap/blob/v1.3.0/lib/scaffolding.less#L133)

# python - 为什么 scipy.sparse.linalg.eigsh 给出错误的答案？

> ID：10234919
> 
> 赞同：1
> 
> 时间：2012-04-19T18:57:58.650
> 
> 标签：python, numpy, scipy, linear-algebra

`eigh`稀疏和`eigsh`正常 linalg 库的以下用途不应该给出相同的答案吗？

```
from numpy import random
from scipy.linalg import eigh as E1
from scipy.sparse.linalg import eigsh as E2

# Number of eigenvectors to check
kv = 4

# Make a symmetric matrix
N = 20
A = random.random((N,N))
A += A.T
assert( (A==A.T).all() )

L1,V1 = E1(A)
L2,V2 = E2(A,k=kv)

print sorted(L1)[::-1][:kv]
print sorted(L2)[::-1] 
```

一些样本值：

```
[20.189135474050769, 3.1309586179883211, 2.6576577451888599, 2.3435647560235355]
[20.18913547405079, 3.1309586179883317, -2.9218877679802597, -3.2962262932479751]

[19.688806193598253, 3.195683848729701, 3.0987244589789058, 2.5648352930907214]
[19.688806193598261, 3.1956838487296961, 3.0987244589789014, -2.7495588013870975]

[20.482117184188727, 3.3175885619590439, 2.8910051228982252, 2.746127351510173]
[20.482117184188716, 3.3175885619590524, 2.891005122898231, 2.7461273515101809] 
```

在我看来，内部的 Lancoz 例程只是有时会收敛。令人抓狂的是它适用于*某些*值 - 您可以在第三个示例中看到前四个特征值是正确的，但在其他两个示例中并非如此。

版本： Python `2.7.3`、 numpy `1.6.1`、 scipy `0.9.0`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T01:02:56.187

您需要按特征值的绝对值对特征值进行排序，以下代码将给出相同的结果：

```
print sorted(L1, key=abs)[::-1][:kv]
print sorted(L2, key=abs)[::-1] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-20T13:41:06.900

While sorting by absolute values (as suggested by @HYRY) gives the same result for both tests, it still is unsatisfying since the my underlying intent was to get the largest eigenvalues from my matrix. For real symmetric matrices I thought `eigsh` would return the largest eigenvalues. It doesn't, it returns the largest eigenvalues **sorted by magnitude**.

# c - 在 Visual Studio 2010 中使用 SDCC？

> ID：10234922
> 
> 赞同：1
> 
> 时间：2012-04-19T18:58:07.863
> 
> 标签：c, visual-studio-2010, compiler-construction, sdcc

有没有办法将 Visual Studio 2010 IDE 与小型设备 C 编译器 (SDCC) 一起使用？我想在 Visual Studio 中使用 SDCC 进行编译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T15:42:51.703

如果你想走这条路，那么你将不得不为自己弄清楚很多事情。这是我将如何开始：

1.  编写一个 Makefile，在您键入“make”时使用 SDCC 构建您的项目，并在您键入“make clean”时清理您的项目，并在您键入“make clean all”时重新构建您的项目。
2.  执行 File -> New Project 并选择“Makefile 项目”。将构建、清理和重建命令设置为我上面所说的命令。
3.  您可能必须将`.sln`和`.vcxproj`文件移动到包含 Makefile 和源代码的目录中，以便 Visual Studio 可以找到它。

此时，您应该能够从 Visual Studio 中构建您的项目。

不幸的是，Visual Studio 似乎不理解 SDCC 生成的错误消息的格式，所以如果你想让它工作，你必须重新配置 Visual Studio 或重新编译 SDCC。我会把它留给你作为练习。

我希望 Visual Studio 还会遇到许多它不理解的 SDCC 关键字，例如“__code”，因此您可能必须执行以下操作才能从 Visual Studio 中隐藏这些关键字：

```
#ifndef SDCC
#define __code
#endif 
```

总的来说，我希望你会遇到很多麻烦。

如果您想查看一些将 SDCC 与**Eclipse**结合使用的说明，请参阅[Wixel 用户指南](http://www.pololu.com/docs/0J46)。

# ruby - Ruby JSON.parse 为 unicode 返回不正确的数据

> ID：10234924
> 
> 赞同：5
> 
> 时间：2012-04-19T18:58:13.727
> 
> 标签：ruby, json

我正在尝试使用`JSON.parse`. 但是在一台机器上，使用`json/ext`，它会返回不正确的值。例如，`\u2030`应该`E2 80 B0`以 UTF-8 返回，但我得到的是`01 00 00`. `"\\u2030"`它会因转义或未转义而失败`"\u2030"`。

```
1.9.2p180 :001 > require 'json/ext'
 => true 
1.9.2p180 :002 > s = JSON.parse '{"f":"\\u2030"}'
 => {"f"=>"\u0001\u0000\u0000"} 
1.9.2p180 :003 > s["f"].encoding
 => #<Encoding:UTF-8> 
1.9.2p180 :004 > s["f"].valid_encoding?
 => true 
1.9.2p180 :005 > s["f"].bytes.map do |x| x; end
 => [1, 0, 0] 
```

它可以在我的另一台机器上使用相同版本的 ruby​​ 和类似的环境变量。两台机器上的 Gemfile.lock 是相同的，包括`json (= 1.6.3)`. 它确实适用`json/pure`于两台机器。

```
1.9.2p180 :001 > require 'json/pure'
 => true 
1.9.2p180 :002 > s = JSON.parse '{"f":"\\u2030"}'
 => {"f"=>"‰"} 
1.9.2p180 :003 > s["f"].encoding
 => #<Encoding:UTF-8> 
1.9.2p180 :004 > s["f"].valid_encoding?
 => true
1.9.2p180 :005 > s["f"].bytes.map do |x| x; end
 => [226, 128, 176] 
```

那么我的环境或设置中是否还有其他可能导致它解析不正确的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-29T22:09:41.470

最近遇到了同样的问题，我追查到[这个 Ruby 错误](https://bugs.ruby-lang.org/issues/5888)是由于在 Ruby 1.9.2中声明[这个缓冲区以及它是如何](https://github.com/ruby/ruby/blob/02a892e48df92436a07d234c84f4b5cafce8ae3a/ext/json/parser/parser.rl#L417)[被 GCC 优化的](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=51862)。[它已在此提交](https://github.com/ruby/ruby/commit/63da304fb7c849e675e762c626e074d130d1e715)中修复。

您可以重新编译 Ruby`-O0`或使用更新版本的 Ruby（1.9.3 或更高版本）来修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:21:56.887

尝试升级您的 JSON Gem（至少到 1.6.6）或最新的 1.7.1。

# list - 在 Scheme 中查找列表的最大值和最小值

> ID：10234926
> 
> 赞同：2
> 
> 时间：2012-04-19T18:58:16.657
> 
> 标签：list, scheme, racket

我需要找到一个列表的最大值和最小值，然后添加一个新列表。到目前为止，这是我的代码：

```
(define alist '(18 39 57 -4 0)

(define (nMax alist)
  (if (null? (cdr alist))
      (car alist)
      (if (> (car alist) (nMax (cdr alist)))
          (car alist)
          (nMax (cdr alist)))))

(define (nMin alist)
  (if (null? (cdr alist))
      (car alist)
      (if (< (car alist) (nMin (cdr alist)))
          (car alist)
          (nMin (cdr alist))))) 
```

现在我被困住了。如何在新列表中添加`nMin`+ ？`nMax`我的输出应该是这样的：

```
'(57 -4) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T19:23:33.170

试试这个：

```
(define alist '(18 39 57 -4 0))

(define (max-min alist)
  (list (nMax alist)
        (nMin alist)))

(max-min alist)
> '(57 -4) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:06:22.350

就像是`(cons (nMax alist) (cons (nMin alist) '()))`

# networking - 配置 RADIUS 服务器以验证 VPN 服务器？

> ID：10234927
> 
> 赞同：0
> 
> 时间：2012-04-19T18:58:29.563
> 
> 标签：networking, radius

我正在 linux 上实现这个项目，但无法链接 VPN 服务器和 RADIUS 服务器。我已经配置了 RADIUS 客户端，在 VPN 服务器上选择了 RADIUS 身份验证但没有工作。帮我！

这是我的拓扑[这里](http://blog.yimg.com/1/xIcK4oZ7s5.hv1ISKZkkxzLxIQEmGzyG.gFFyNoHdn.fYxBgrn9Mfw--/8/l/4tVtaDbNfu0bPh8PG4ZV_g.jpg)
VPN srv：

*   eth0 (10.0.0.1) 连接互联网。
*   eth1 (172.16.0.1) 连接局域网 (RADIUS srv in LAN)
    RADIUS srv: (172.16.0.2)

RADIUS 服务器使用 freeradius soft, openVPN for VPNsrv

*   我在*/etc/raddb/users 中加入了一个用户“A”。*
*   在 /etc/raddb/clients.conf 中创建客户端，如下所示 client 192.168.1.200 { secret ... shortname ... }
*   而使用openVPN的VPN srv，我已经启用RADIUS认证并输入IP *172.16.0.2。*
*   在 RADIUS srv 中，我使用 cmd 进行测试：***radtest A 123 172.16.0.2 0 "secret"***但不成功。我不知道配置还不够？以及如何测试的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:12:54.470

根据您的描述，您的 RADIUS 配置似乎需要修复。除非“radtest”有效，否则它不适用于 openVPN。

那么，如何找出问题所在呢？

你可以做的是： 1\. 以调试模式启动服务器，radiusd -X。2\. 运行 radtest A 123 172.16.0.2 0 "secret" 3\. 检查调试日志，它将显示身份验证失败的原因。

我建议你按照这个（http://freeradius.org/doc/）文件说的做。首先创建一个与文档中使用的信息完全相同的用户进行测试。如果可行，请创建您自己的真实用户。

我怀疑的另一件事可能是错误的，是您的用户文件。使用“man users”检查 Radius 服务器上的用户手册页。

用户文件位于 RADIUS 数据库目录中，默认为 /etc/raddb。它包含一系列配置指令，文件模块使用这些指令来决定如何授权和验证每个用户请求。

也检查这个示例文件，可能会提示您的设置有什么问题。[http://docs.snake.de/TNT/7/radius/userfile.htm](http://docs.snake.de/TNT/7/radius/userfile.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T10:51:05.547

我很确定您在响应中缺少 Message-Authenticator 属性，并且您的 RADIUS 服务器可能需要此属性。

您可以通过在 Cloudessa RADIUS（Google for it）上创建一个免费帐户来检查它。选择 PAP 作为身份验证方法。然后尝试进行身份验证，看看这是否有效。如果没有，请查看“日志”面板中的错误消息是什么。

# php - 将网站重定向到特定文件夹和 https

> ID：10234930
> 
> 赞同：1
> 
> 时间：2012-04-19T18:58:33.883
> 
> 标签：php, regex, .htaccess, mod-rewrite

我在一个安全的 https 文件夹中创建了一个新版本的网站，我希望任何请求都可以转到该文件夹​​，例如[https://photofileltd.co.uk/index.php?page=services](https://photofileltd.co.uk/index.php?page=services)然后会显示[https ://secure.photofileltd.co.uk/new_site/index.php?page=services](https://secure.photofileltd.co.uk/new_site/index.php?page=services)

**我已经在 .htaccess 中尝试过，它可以很好地重定向，但不会更改/屏蔽 URL，感谢 Jan 进行了更新**：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://secure.photofileltd.co.uk/new_site/$1 [L] 
```

任何帮助或建议将不胜感激 - 我对 htaccess/mod_rewrite 一点也不熟悉，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:07:53.457

您正在丢失查询：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://secure.photofileltd.co.uk/new_site/$1 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T19:01:49.000

尝试

`RewriteRule ^ https://secure.photofileltd.co.uk/new_site%{REQUEST_URI} [R=301,L]`

# jquery - 将 JavaScript 显示添加到主页以从 140 个字符开始倒计时。（Rails 教程，第 2 版，第 10 章，练习 7）

> ID：10234939
> 
> 赞同：13
> 
> 时间：2012-04-19T18:58:56.240
> 
> 标签：jquery, ruby-on-rails-3, asset-pipeline, railstutorial.org

这个练习有点棘手。想我会发布我的解决方案，看看是否有人做得不同，或者是否有人知道更好的方法。

我不确定使用 Asset Pipline 的最佳实践。例如，将内容放入 application.js 清单文件的正确顺序，或者何时将内容放入 lib 与 app。我只是将以下内容放入 lib 以尝试使其正常工作。

* * *

来自[Michael Hartl 的 Rails 教程第 2 版](http://ruby.railstutorial.org/chapters/user-microposts?version=3.2#sec:micropost_exercises) 第 10 章，练习 7：

**（具有挑战性）将 JavaScript 显示添加到主页以从 140 个字符开始倒计时。**

首先，我阅读了这篇[关于 jQuery Twitter-like countdowns 的文章](https://stackoverflow.com/questions/2136647/character-countdown-like-on-twitter)，其中提供了执行此操作的代码。

接下来，我将 app/views/shared/_micropost_form.html.erb 更新为如下所示：

```
<%= form_for(@micropost) do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <div class="field">
        <%= f.text_area :content, placeholder: "Compose new micropost..." %>
    </div>
    <%= f.submit "Post", class: "btn btn-large btn-primary" %>
    <span class="countdown"></span>

<% end %> 
```

然后，我在 lib 中创建了一个 javascripts 目录并添加了文件

lib/assets/javascripts/microposts.js

```
function updateCountdown() {
    // 140 is the max message length
    var remaining = 140 - jQuery('#micropost_content').val().length;
    jQuery('.countdown').text(remaining + ' characters remaining');
}

jQuery(document).ready(function($) {
    updateCountdown();
    $('#micropost_content').change(updateCountdown);
    $('#micropost_content').keyup(updateCountdown);
}); 
```

最后，我添加了一点 CSS

应用程序/资产/样式表/custom.css.scss

```
/* micropost jQuery countdown */

.countdown {
  display: inline;
  padding-left: 30px;
  color: $grayLight;
} 
```

最后，将指令添加到 app/assets/javascripts/application.js

```
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require microposts
//= require_tree . 
```

最终结果看起来像这样 [http://grab.by/dbC6](http://grab.by/dbC6)

* * *

**问题：** 将清单行放在后面会不会错`//= require_tree .`

例如，这可行，但我不确定与在 tree 上方添加行有什么区别。

```
 //= require jquery
 //= require jquery_ujs
 //= require bootstrap
 //= require_tree .
 //= require microposts 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:50:16.347

我认为[我在 SO 中发布的解决方案](https://stackoverflow.com/a/11332683/567863)与您的解决方案有很大不同，现在我可以谦虚地发布它作为答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T01:49:36.817

你可以使用 CoffeeScript 来简化它：

**/app/assets/javascripts/microposts.js.coffee**

```
更新倒计时 = ->
  剩余 = 140 - jQuery("#micropost_content").val().length
  jQuery(".countdown").剩余文本 + "剩余字符"

jQuery->
  更新倒计时（）
  $("#micropost_content").change updateCountdown
  $("#micropost_content").keyup updateCountdown

```

正如 jonyamo 所提到的，您不需要触摸**application.js**，因为它`//= require_tree .`已经做到了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T20:27:12.607

我不知道为什么，但该解决方案只对我使用咖啡脚本有效。我尝试用 javascript 实现它，但不知何故没有显示任何东西：也没有倒计时，也没有文本“剩余字符”的固定部分。

所以这里是我所做的回顾。

第 1 步：创建 app/javascripts/microposts.js.coffee 文件

```
updateCountdown = ->
  remaining = 140 - jQuery("#micropost_content").val().length
  jQuery(".countdown").text remaining + " characters remaining"

jQuery ->
  updateCountdown()
  $("#micropost_content").change updateCountdown
  $("#micropost_content").keyup updateCountdown 
```

注意：因为它位于 app/javascripts 文件夹中，所以我不需要更新 application.js 文件。

第 2 步：更新 _micropost_form.html.erb 部分：

```
<%= form_for(@micropost) do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <div class="field">
        <%= f.text_area :content, placeholder: "Compose new micropost..." %>
    </div>
    <%= f.submit "Post", class: "btn btn-large btn-primary" %>
    <span class="countdown"></span>
<% end %> 
```

第 3 步：在 custom_css.css.scss 文件中实现一点 css

```
/* micropost jQuery countdown */

.countdown {
  display: inline;
  padding-left: 10px;
  color: $grayLight;
} 
```

第 4 步：享受结果并为一切顺利而感到高兴 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-04T14:01:07.927

My`microposts.js.coffee`使用 jQuery [.css 方法](http://api.jquery.com/css/)根据变量的值更改剩余字符的颜色，`remaining`以更接近地反映[twitter的行为](https://twitter.com/)

```
updateCountdown = -> 
  remaining = 140 - jQuery("#micropost_content").val().length
  jQuery(".countdown").text remaining + " characters remaining"
  jQuery(".countdown").css "color", (if (140 >= remaining >= 21) then "gray")
  jQuery(".countdown").css "color", (if (21 > remaining >= 11) then "black")
  jQuery(".countdown").css "color", (if (11 > remaining)  then "red")

jQuery ->
  updateCountdown()
  $("#micropost_content").change updateCountdown
  $("#micropost_content").keyup updateCountdown 
```

感谢所有之前回答的人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-17T22:50:36.387

我使用 Brett 的代码帮助我完成 Rails 教程中的这个练习，尽管我有一个小的改动。当我导航到另一个页面然后返回主页时，我遇到了文本从 .countdown 元素中消失的问题。通过一些小的研究和[另一个答案的帮助，](https://stackoverflow.com/questions/21244253/jquery-widgets-disappearing-in-rails-4?newreg=aa9abbb3ba6f4496b34e73b8be96961d)我意识到原因是 Turbolinks。我对 Brett 代码的更改，绑定到`page:change`event 而不是 to `ready`，如下所示。我希望这对其他人有所帮助。

```
function updateCountdown() {
  // 140 is the max message length
  var remaining = 140 - jQuery('#micropost_content').val().length;
  jQuery('.countdown').text(remaining + ' characters remaining');
}

function micropostChange() {
  $('#micropost_content').change(updateCountdown);
}

function micropostKeyup() {
  $('#micropost_content').keyup(updateCountdown);
}

jQuery(document).ready(function($) {
  updateCountdown();
  micropostChange();
  micropostKeyup();
  jQuery(document).on('page:change', function($) {
    updateCountdown();
    micropostChange();
    micropostKeyup();
  });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-07T13:10:57.610

这是我基于 Adriano 解决方案的咖啡脚本版本。这会忽略空格，不涉及将空 div 添加到视图中，并且一旦您获得负数，还会添加一个错误类。

```
updateCountdown = ->
  text =  jQuery('#micropost_content').val()
  text = text.replace(/\s/g, '');   
  remaining = 140 - text.length
  jQuery('.countdown').text remaining + ' characters remaining'
  jQuery('.countdown').addClass 'alert alert-error' if remaining < 0
  jQuery('.countdown').removeClass 'alert alert-error' if remaining > 0

jQuery(document).ready ->
  jQuery('#new_micropost').append '<span class="countdown">140 characters remaining</span>'
  jQuery('#micropost_content').change updateCountdown
  jQuery('#micropost_content').keyup updateCountdown
  return 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-20T20:03:13.030

为了避免字符数减少，我将此限制添加到 _micropost_form.html.erb 部分，所以它会阻止你在 140 个字符：

```
<%= f.text_area :content, maxlength:140, placeholder: "Compose new micropost..." %> 
```

# javascript - JQuery 更改和加载函数

> ID：10234942
> 
> 赞同：0
> 
> 时间：2012-04-19T18:59:14.100
> 
> 标签：javascript, jquery

下面的查询在检查单选按钮和显示“结果值”时效果很好。

由于单选按钮已经检查了输入，如何在页面加载时显示“结果值”？

```
jQuery(document).ready(function ($) {
    $('input[name*="fed"], input[name*="stake"]').change(function () {
        var $this = $(this),
        $wrap = $this.closest('.js-weight-calc-wrap'),
        fedVal = $wrap.find('input[name*="fed"]:checked').val(),
        stakeVal = $wrap.find('input[name*="stake"]:checked').val(),
        result = fedVal === 'Very High' ? '3'
             : fedVal === 'High' && stakeVal === 'Very High' ? '3'
             : fedVal === 'Low to Moderate' && stakeVal !== 'Very High' ? '1'
             : '2';
        $wrap.find('.js-result').text(result)
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:15:34.510

最简单的解决方案是在 dom 就绪时手动触发输入上的更改事件。

```
$('input[name*="fed"], input[name*="stake"]').trigger('change'); 
```

# facebook - 即使我们不请求 publish_stream，为什么 Facebook 身份验证页面会显示我们“代表您发布”？

> ID：10234943
> 
> 赞同：2
> 
> 时间：2012-04-19T18:59:18.923
> 
> 标签：facebook

我们有一个移动应用程序（ios 和 android），当用户使用 Facebook 登录我们的应用程序时，我们请求以下 Facebook 权限：“offline_access,user_birthday,user_relationships,email”

Facebook 登录对话框最近开始显示“此应用可能会代表您发布，包括状态更新、照片等。” 我们不请求 publish_stream 权限，所以有人知道为什么会出现这种情况吗？这是一个听起来相当可怕的要求，我们宁愿不出现。

如果重要的话，我们正在 phonegap 中构建一个 html5 应用程序，使用 facebook phonegap 插件通过本机 Facebook 应用程序进行登录。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T19:34:13.870

看起来这是一个错误，昨天被报告并且在 dev facebook bugs 上。

检查[这个](https://developers.facebook.com/bugs/273948536030203?browse=search_4f9067dad28a38e01247644)

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:08:26.487

参考facebook的这个博客：http: [//developers.facebook.com/blog/post/2012/04/25/streamlining-publish_stream-and-publish_actions-permissions/](http://developers.facebook.com/blog/post/2012/04/25/streamlining-publish_stream-and-publish_actions-permissions/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T19:06:34.160

登录后授予您哪些权限？这看起来像 的描述，在操作上与最近的一些更改`publish_actions`非常相似`publish_stream`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-07T15:18:44.280

我认为这是无害的——他们获得我们许可的方式来发布你希望他们发布的帖子——例如，你添加的照片。

# javascript - 自定义 div 以奇怪的行为调整大小

> ID：10234945
> 
> 赞同：1
> 
> 时间：2012-04-19T18:59:25.483
> 
> 标签：javascript, jquery, drag-and-drop, resize

当鼠标单击 div 并开始拖动时，会在顶部构建另一个绝对 div。但是当我减小宽度和高度时，div 会闪烁。我注意到最初的 css 比例“top”和“left”导致了这种情况；

带有“顶部”和“高度”！= 0 [http://jsfiddle.net/mCupS/](http://jsfiddle.net/mCupS/)

顶部：0 和左侧：0 [http://jsfiddle.net/mCupS/1/](http://jsfiddle.net/mCupS/1/)

这是错的吗？我错过了什么吗？

```
$(selection_div).width(e.offsetX - xDown)
$(selection_div).height(e.offsetY - yDown) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:12:52.890

我不知道为什么，但`event.offsetX`不可靠。

我已经通过单独收听解决了您的问题`mousedown`，`mousemove`然后`mouseup`：

```
 $('#container').on('mousedown', function(mde){
        $('#container').on('mousemove', function(mme){
            $(selection_div).width(mme.pageX - mde.pageX)
            $(selection_div).height(mme.pageY - mde.pageY)
        });
        $('#container').on('mouseup', function(mue){
            $('#container').off('mousemove');            
        });                    
    }); 
```

在这里演示：http: [//jsfiddle.net/mCupS/2/](http://jsfiddle.net/mCupS/2/)

# php - PHP中的Xpath父选择器

> ID：10234948
> 
> 赞同：0
> 
> 时间：2012-04-19T18:59:34.080
> 
> 标签：php, xml, model-view-controller, xpath

***一点背景：***

嗨，大家好，

我正在为 MVC 应用程序在 PHP 中创建一个路由器，并决定该结构将采用 XML 格式。我有一个 XML 文件，其中包含系统中所有有效的路由（页面）及其关联的控制器和操作。

还有一个“参数”来指示 URI 末尾是否有一个变量以及将其分配给的变量名（我知道这个名字很混乱！！）

我正在做的是查看 REQUEST_URI 并使用 PHP 的 explode 函数将其转换为“路由”元素数组，然后我为其构建查询。

这是一些示例 XML：

```
<routes>    
    <route>
        <url>blog</url>
        <params>
            <controller>blogController</controller>
            <action>indexAction</action>
        </params>

        <route>
            <url>entry</url>
            <params>
                <controller>blogController</controller>
                <action>entryAction</action>
                <param>entryId</param>
            </params>
        </route>
    </route>
 </routes> 
```

这是正在构建的查询：

```
/routes/route/url[text()="blog"]/../route/url[text()="entry"]/.. 
```

这似乎总是在 PHPs XPath 中返回 0 个节点，但是使用在线表达式测试器我得到了匹配的入口路径。

谁能解释可能出了什么问题？PHP 的 Xpath 解析器是否理解这种语法？我也试过 ::parent* 方法

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:35:00.707

你不应该需要`..`或`parent::*`。

试试这个：

```
/routes/route[url="blog"]/route[url="entry"] 
```

你也不应该需要`text()`，但我也不太了解 PHP。F以上不起作用，请尝试：

```
/routes/route[url/text()="blog"]/route[url/text()="entry"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:59:11.563

明智的 XPath 我得出了与 DevNull 相同的结论，只是稍微添加了选择第一个匹配项：

```
/routes/route[url="blog"]/route[url="entry"][1] 
```

使用对象接口：

```
$routes = new RoutesXML($xml);

var_dump($routes->fromPath('blog/entry'));  # The SimpleXMLElement

var_dump($routes->fromPath('blog/entry2')); # NULL 
```

示例实现：

```
class RoutesXML
{
    private $xml;
    public function __construct($xml) {
        $this->xml = simplexml_load_string($xml);
    }
    public function fromPath($path) {
        $expression = '/routes';
        foreach(explode('/', $path) as $element)
            $expression .= "/route[url='$element']";
        $expression .= '[1]';
        list($route) = $this->xml->xpath($expression) + array(NULL);
        return $route;
    }
} 
```

# php - 只有一个“全局”变量 - 正确实施？

> ID：10234949
> 
> 赞同：0
> 
> 时间：2012-04-19T18:59:40.077
> 
> 标签：php

我将我的全局变量减少到只有一个。注入一个只有一个变量和一个 getter 函数的类似乎有点奇怪，但我不想要任何隐式依赖项，我希望它们都是显式的并记录在案。此外，我只希望我授予访问权限的类可以访问“全局变量”。所以从某种意义上说，它们不是全球性的。需要重命名才能共享。LOAD_ON 是我在多个类中需要的唯一变量。

在尝试遵守[SOLID](http://en.wikipedia.org/wiki/SOLID) /DRY（不要重复自己）/OOP（面向对象编程）时，这是实现“全局”变量的正确方法（最佳实践）吗？

```
<?php 

class GlobalClass
{
    private $LOAD_ON = 0;
    public function getLoad()
    {
        return $this->LOAD_ON;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:08:05.200

如果您只有 1 个“全局”并且不需要更改它，那么常量是最佳实践。

```
define('LOAD_ON', 0); 
```

以这种方式使用它

```
if(LOAD_ON === 0){
 ///... 
```

# r - 如何使用 ggplot 对前 X 个类别进行分组和显示？

> ID：10234952
> 
> 赞同：4
> 
> 时间：2012-04-19T18:59:49.513
> 
> 标签：r, ggplot2

我正在尝试使用 ggplot 按公司绘制生产数据，并使用点的颜色来指定年份。下图显示了基于样本数据的示例： ![在此处输入图像描述](../Images/6256496e125b38c11ed985de93e10f1f.png)

然而，很多时候我的真实数据有 50-60 个不同的公司，这使得 Y 轴上的公司名称被紧密地分组，并且不是很讨人喜欢。

仅显示前 5 名公司信息的数据（按 2011 年数量排名）然后显示其余汇总并显示为“其他”的最简单方法是什么？

下面是一些示例数据和我用来创建示例图表的代码：

```
# create some sample data
c=c("AAA","BBB","CCC","DDD","EEE","FFF","GGG","HHH","III","JJJ")

q=c(1,2,3,4,5,6,7,8,9,10)
y=c(2010)
df1=data.frame(Company=c, Quantity=q, Year=y)

q=c(3,4,7,8,5,14,7,13,2,1)
y=c(2011)
df2=data.frame(Company=c, Quantity=q, Year=y)

df=rbind(df1, df2)

# create plot
p=ggplot(data=df,aes(Quantity,Company))+
  geom_point(aes(color=factor(Year)),size=4)
p 
```

我开始走蛮力方法的道路，但认为可能有一种简单而优雅的方法可以做到这一点，我应该学习。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T19:42:28.747

那这个呢：

```
 df2011 <- subset (df, Year == 2011)
    companies <- df2011$Company [order (df2011$Quantity, decreasing = TRUE)]
    ggplot (data = subset (df, Company %in% companies [1 : 5]), 
            aes (Quantity, Company)) +
            geom_point (aes (color = factor (Year)), size = 4) 
```

顺便说一句：为了让代码被称为优雅，多花一些空间，它们并没有那么贵......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T05:40:26.090

看看这是不是你想要的。它需要您的`df`数据框，以及@cbeleites 已经提出的一些想法。步骤是：

1.选择2011年的数据，按数量从高到低排列公司。

2.`df`分为两位：`dftop`其中包含前5位的数据；和`dfother`，其中包含其他公司的汇总数据（使用`ddply()`来自 plyr 包）。

3.将两个数据框放在一起给出`dfnew`。

4.设置公司级别的绘制顺序：从上到下从最高到最低，然后是“其他”。订单部分由`companies`加上“其他”给出。

5\. 像以前一样绘制。

```
library(ggplot2)
library(plyr)

# Step 1
df2011 <- subset (df, Year == 2011)
companies <- df2011$Company [order (df2011$Quantity, decreasing = TRUE)]

# Step 2
dftop = subset(df, Company %in% companies [1:5])
dftop$Company = droplevels(dftop$Company)

dfother = ddply(subset(df, !(Company %in% companies [1:5])), .(Year), summarise, Quantity = sum(Quantity))
dfother$Company = "Other"

# Step 3
dfnew = rbind(dftop, dfother)

# Step 4
dfnew$Company = factor(dfnew$Company, levels = c("Other", rev(as.character(companies)[1:5])))
levels(dfnew$Company)    # Check that the levels are in the correct order

# Step 5
p = ggplot (data = dfnew, aes (Quantity, Company)) +
        geom_point (aes (color = factor (Year)), size = 4)
p 
```

代码产生：

![在此处输入图像描述](../Images/c6e963529f7206bb51e53b1a583a322d.png)

# google-chrome-frame - Google Chrome Frame - 带有“onmissing”的自定义安装对话框

> ID：10234955
> 
> 赞同：1
> 
> 时间：2012-04-19T18:59:55.127
> 
> 标签：google-chrome-frame

谁能指出一个自定义的 Google Chrome Frame 安装对话框的示例？

看起来 GCF 允许您将默认对话框隐藏为`CFInstall.check()` ( `onmissing`, `preventPrompt`) 的参数，但我无法找到预期结构的示例`onmissing`。

我可以`onmissing`使用 jQuery 或类似工具启动我自己的自定义对话框，但不知道要链接到哪里才能正确启动安装过程。每当我直接重定向到安装程序时，都会提示我输入管理员密码，这与使用默认 GCF 安装对话框时不同。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T02:24:33.017

这篇[文章](http://www.michaeldunbar.com/articles/blog/2011/november/using-google-chrome-frame.aspx)帮助了我。一探究竟。

# database - 将数据库迁移保留在 VCS 中是个好主意吗？

> ID：10234956
> 
> 赞同：1
> 
> 时间：2012-04-19T18:59:56.460
> 
> 标签：database, django, database-design, data-migration, django-south

传统观点似乎是数据库迁移应该保存在 VCS 中——这样就可以记录数据库经历的所有更改。

但...

旧迁移有什么用？我真的不认为自己会恢复到旧版本的 db。将它们排除在 VCS 之外并在每台机器上创建一个不必与其他所有人的迁移队列保持同步的迁移队列不是更容易吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T20:15:05.630

如果您认为保留旧迁移是浪费，那么您就不了解迁移。迁移允许您回滚更改。您可能无法想象这样做，但它可能是必要的。完整的迁移历史允许协作团队保持同步，而不管他们开始时可能拥有的版本。

扔垃圾和重新开始是你在南方能做的最糟糕的事情之一。除非您明确告诉所有人进入并清除 south_migrationhistory 表并删除所有现有迁移并创建新的 init 迁移，否则您完全搞砸了其他开发人员。

简而言之。将迁移留在 VCS 中，这是它们所属的地方，以便从任何时候进入项目的任何人都可以快速将他们的数据库迁移到当前版本。不要清理它们，它们不会伤害任何东西，这样做会给其他合作者带来麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T19:18:55.583

我认为你是对的，保留旧迁移几乎没有用，即使它们没有害处我也不喜欢我的项目中未使用的代码。

虽然在开发过程中使用像 south 这样的迁移系统有很大帮助，但您可能不需要关于合并功能/更改的旧模式迁移（如果您仍然在 VCS 上可用的 python 代码中更改模型）。

有时我会在一个初始迁移中做垃圾并重新创建所有迁移，然后重新开始收集新的迁移。

将迁移保持在 VCS 之外并不是一个好主意，如果它不会引入问题，它肯定会减慢开发速度。

编辑：由于清理过程涉及团队了解这种重组（并清除迁移历史表），因此当您无法轻松接触到所有开发人员/用户时，不建议这样做。

# ios - XCode 界面生成器的导航 UINavigationItem 高度错误

> ID：10234959
> 
> 赞同：1
> 
> 时间：2012-04-19T19:00:03.040
> 
> 标签：ios, xcode, macos, interface-builder

我刚刚遇到了这个问题，这基本上使 Interface Builder 对我来说无法使用。

我有一个细节视图控制器，它只能在横向模式下工作。所以我在 Xcode（最新的公共版本，最新的公共 Mac OS X）中打开了故事板，并选择了适当的选项使其进入横向。

然而，这就是它所显示的： ![在此处输入图像描述](../Images/547f4c9b3f60201b83e1e9f36720c524.png)

可能不是很明显，但是上面写着“Detail”的导航栏的高度是错误的。这绝不是它在设备上的显示方式。这使得 Interface Builder 无法使用，因为我无法正确布局/对齐本示例中的 UIWebView 和 UIImageView 等（即，在设备上它看起来与 Xcode 中的不同，所以我无法知道如何布局它在 Xcode 中）。

我做错了什么吗，这是一个错误，有没有办法解决这个问题（我尝试更改导航项的高度，但当我打开尺寸检查器时它告诉我“不适用”）？

作为参考，下面是一个屏幕截图，显示了运行应用程序时导航栏的实际外观，以便您了解问题的严重程度：

![在此处输入图像描述](../Images/7898d0685ba3c8adc7774b6c6c816328.png)

# javascript - 为国际用户显示消息

> ID：10234961
> 
> 赞同：1
> 
> 时间：2012-04-19T19:00:11.387
> 
> 标签：javascript, jquery, geolocation

我想在国际访问者访问我的美国基地网站时显示一个弹出窗口。最好使用 javascript 或 jQuery 框架。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T20:25:23.187

这是使用 jQuery、[http](http://smart-ip.net/) ://smart-ip.net/和[https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)的解决方案：

```
$(document).ready(function() {
    if (!$.cookie("international")) {
        $.getJSON("http://smart-ip.net/geoip-json?callback=?", function(data){
            if (data.countryCode !== "US") {
                popUpFunction();
                $.cookie("international", "yes", { expires: 365 });
            } else {
                $.cookie("international", "no", { expires: 365 });
            }
        });
    } else {
        if ($.cookie("international") === "yes") {
            popUpFunction();
        }
    }
}); 
```

# oop - 在函数内部创建对象是否可以

> ID：10234963
> 
> 赞同：3
> 
> 时间：2012-04-19T10:37:41.317
> 
> 标签：oop, vga

我在 VBA 中研究一个类，该类使用 MSXML2.XmlHttp 封装下载内容。

返回值有三种可能：Text、XML 和 Stream。

我应该为每个创建一个函数：

```
 aText=myDownloader.TextSynchronous(URL,formData,dlPost,....)
 aXml.load myDownloader.XmlSynchronous(URL,formData,dlPost,....) 
```

或者我可以只返回我在类中创建的 XmlHttpObject 然后有

```
 aText=myDownloader.Synchronous(URL,formData,dlPost,.....).ResponseText
 aXML=myDownloader.Synchronous(URL,formData,dlPost,.....).ResponseXML 
```

在前一种情况下，我可以在类中将 obj 设置为空，但必须编写几个或多或少相同的函数。

在后一种情况下，我使用“垃圾收集器”，但课程更精简。

两者都应该工作，但哪一个是更好的编码风格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T10:56:41.170

在我看来，第一种方法更好，因为您不会将低级细节暴露给高级抽象。

我用 Java 中的网络爬虫做了类似的事情，所以我有一个类只用于操作 URL 连接以获取所有需要的数据（低级）和一个使用返回名为 Page 的对象的低级类的高级类。

您可以使用第三种方法，仅执行`myDownloader.Synchronous(URL,formData,dlPost,.....)`返回的对象并将其存储在私有变量中，而其他方法仅操作此对象。这种形式，您只会打开一次连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:39:01.693

在网上四处寻找之后（由 EmmadKareem 的评论触发），我发现了这个：

首先，不要`localObject=Nothing`在方法的末尾做 - 变量无论如何都会超出范围并被丢弃。[在 msdn 上](http://blogs.msdn.com/b/ericlippert/archive/2004/04/28/122259.aspx "msdn 上一篇较旧但有趣的帖子")看到这个较旧但有启发性的帖子

VBA 使用引用计数，除了 ADO 上的一些较旧的错误之外，这似乎工作得很好，并且（据我所知）立即丢弃不再使用的资源。因此，从性能/内存使用的角度来看，这似乎不是问题。

至于编码风格：我认为我在设计它时的不舒服的感觉可以通过简单地将函数重命名为`myDownloader.getSyncDLObj(...)`或类似的方式消失。

代码风格似乎有两个阵营。一是提倡简洁的代码，易于阅读，但每次使用时都使用五行代码。它最重要的特权是“每个函数都应该做一件事，而且只做一件事。他们的方法可能看起来像

```
myDownloader.URL="..."
myDownloader.method=dlSync
myDownloader.download
aText=myDownloader.getXmlHttpObj.ResponseText
myDownloader.freeResources 
```

一个是可以的，更混乱，但更少的线路消耗

```
aText=myDownloader.getSyncObj(...).ResponseText 
```

两者都有其优点，两者都没有错，危险或不受欢迎。由于这是一个辅助类，我使用它从主代码中删除 xmlhttp 的内部工作，我更喜欢这里的第二种方法。（一个目标一条线；）

我会对任何人处理这件事很感兴趣

# c# - 使用 PhoneApplicationService.Current.State 保存集合

> ID：10234971
> 
> 赞同：0
> 
> 时间：2012-04-19T19:00:45.187
> 
> 标签：c#, windows-phone-7, silverlight-4.0

当我离开我的应用程序时，我正在尝试保存一个临时存储诊断日志的集合 - 我查看了其他示例代码，它看起来很基本，如下所示：

保存：

```
PhoneApplicationService.Current.State["DiagnosticLog"] = DiagnosticLog; 
```

加载：

```
if (PhoneApplicationService.Current.State.ContainsKey("DiagnosticLog"))
  DiagnosticLog = (ObservableCollection<DiagnosticLogEntry>)
    PhoneApplicationService.Current.State["DiagnosticLog"]; 
```

但是我收到此错误：

> System.Runtime.Serialization.dll 中出现“System.Runtime.Serialization.InvalidDataContractException”类型的第一次机会异常

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T20:03:25.333

通常，当这种情况发生时，这意味着您的诊断类（或其中一个包含的类）上没有默认的公共构造函数。

# windows-phone-7 - 墙壁和玩家控制器之间的碰撞

> ID：10234975
> 
> 赞同：1
> 
> 时间：2012-04-19T19:01:08.203
> 
> 标签：windows-phone-7, xna, box2d, farseer

我在 WP7 上使用 Farseer 和 XNA。我的游戏中有 2 个对象。第一个是从位图生成的墙。第二个是玩家控制器——实际上它只是一个圆形对象。这个圆圈跟随玩家的手指。

我需要某种行为——可能是非常基本的，但我不知道如何用谷歌搜索它。这是一种碰撞检测，只是不允许控制器撞到墙上。它不应该反弹。它应该只是尝试跟随手指而不是进入墙壁。

我知道自己实现它并不难，但是如果我使用的是物理引擎并且它恰好提供了这样的功能，那么不利用它将是一种耻辱。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:53:49.803

你需要使用一个 BoundingBox 对象，并检查碰撞与对象（你应该创建一个 BoundingSphere 包装它）

[http://www.riemers.net/eng/Tutorials/XNA/Csharp/Series2/Collision_detection.php](http://www.riemers.net/eng/Tutorials/XNA/Csharp/Series2/Collision_detection.php)

# java - Android - 如果用户未登录，则登录页面

> ID：10234980
> 
> 赞同：-1
> 
> 时间：2012-04-19T19:01:36.657
> 
> 标签：java, android, login, login-control

我正在和一些朋友一起开发一个小型 Android 应用程序，我们对 Android 非常陌生，但我们之前研究过一点 Java。我们想要的是让应用程序检查是否有活动用户，如果有 - 继续打开启动器活动。如果没有活动用户，请打开登录活动。我们不希望用户每次打开应用程序时都必须登录，如果他们之前已经登录，我们宁愿让他们直接进入启动器活动。所以我们需要以某种方式保存它，以便它可以即使应用程序关闭并重新打开，也要进行检查。如果您可以向我推荐一个很好的教程，或者如果它很容易修复，我们将不胜感激我们可以获得的所有帮助！

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:07:07.153

共享偏好可能是您最好的选择。您可以从 Youtube 或 Lynda.com 上的一些视频教程开始您的 Android 之旅。

# java - AAPT 被锁定

> ID：10234983
> 
> 赞同：0
> 
> 时间：2012-04-19T19:01:46.317
> 
> 标签：java, android, eclipse, adt

我会尽力在这里解释。我有一个正在为 android 开发开发的 eclipse 插件。它基于 Google/MIT 的 App Inventor 库中的 Java Bridge。该插件只是添加了一个新的项目向导（它复制了几个 jar 以及其他一些文件，并修改了 project.properties 文件）。它还包括一个向导，可轻松创建新的应用程序小部件。

对于新项目向导，我基本上只是复制了 AdtPlugin，更改了对 AltBridge 的引用，并删除了我不需要的东西。这在 r15-r16 中运行良好。但是，我最近更新到最新的 adt (r19)，并做了一些愚蠢的事情。我去对我的插件激活器类进行了修改，以使更改与新的 adt 版本相匹配。真正愚蠢的是我没有事先备份我的文件。

无论如何，我现在遇到的问题是向导完成后没有生成 R 文件。如果我退出 eclipse，然后重新启动它，然后清理项目，生成 R 文件，错误就会消失。

此外，如果我使用新的小部件向导，它可以很好地创建 xml 文件，但是我在控制台中收到一个错误，提示找不到 aapt。重启 eclipse 可以解决这个问题。

如果你想看一些代码，请告诉我。由于激活器类非常大，我不想在这里发布整个内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:58:41.397

发现问题。在 start(BundleContext 上下文方法中，它正在解析 SDK。由于 adtplugin 这样做，它导致了多个级别的冲突。

# asp.net-mvc - 如何删除 asp.net MVC 视图中的特殊字符

> ID：10234986
> 
> 赞同：0
> 
> 时间：2012-04-19T19:01:57.030
> 
> 标签：asp.net-mvc

我正在运行 asp.net MVC 剃须刀。我正在尝试从我的视图中的字符串中删除引号。

所以我要退回这个

```
 "<p><strong>test</strong</p>" 

and my wanting this

     <p><strong>test</strong></p> 
```

这是我尝试过的：

```
@foreach (var post in Model)
{
    var cont = post.postContent.Trim('"');

    <div class="post">
        <h2>@Html.ActionLink(post.postTitle, "Details", "Home", new { id = post.postId }, null)</h2>

         @cont

        <p>@post.postDate</p>
    </div>
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:04:49.887

您是否看到 HTML 编码的文本（当您查看源代码时）`@Cont`显示在哪里？如果是这样，请尝试

```
@Html.Raw(cont) 
```

# python - 如何单击 Selenium 中特定元素旁边的按钮？

> ID：10234988
> 
> 赞同：0
> 
> 时间：2012-04-19T19:02:10.077
> 
> 标签：python, selenium

我正在尝试为结构如下的 HTML 编写 Selenium 测试：

```
<table>
  <tr id="row-1">
    <td><span class="some_data">what I'm looking for</span></td>
    <td><button class="doSomething" onclick="..."></button></td>
  </tr>

  <tr id="row-n">
    <td><span class="some_data">not what I'm looking for</span></td>
    <td><button class="doSomething" onclick="..."></button></td>
  </tr>
</table> 
```

我需要测试来单击与`what I'm looking for`. 我可以找到`span`它在 ( `driver.find_elements_by_xpath('//span[text() = "what I'm looking for"]')`) 中，但我不知道如何从那里到达相应的按钮。

我正在使用[Selenium Python 绑定](http://pypi.python.org/pypi/selenium)，版本 2.21.2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T19:18:30.920

尝试：

```
//tr[td/span[text() = "what I'm looking for"]]/td/button 
```

如果找到`tr`带有`td/span`“我正在寻找的东西”的文本，则从它移动到它`tr`的`td/button`内部。

# iphone - UITableViewCell 高亮覆盖了我的附件视图

> ID：10234991
> 
> 赞同：3
> 
> 时间：2012-04-19T19:02:27.237
> 
> 标签：iphone, objective-c, ios, xcode

我有一个复选框，当它被选中时，它会被选中。但是当我选择单元格时，突出显示会覆盖复选框。对不起我糟糕的英语，但这里是下面的代码。有没有办法让我将复选标记按钮放在突出显示的顶部？

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
UITableViewCell *cell = nil;

if([tableView isEqual:self.myTableView]){
    static NSString *TableViewIdentifier = @"MyCells";
    cell = [tableView dequeueReusableCellWithIdentifier:TableViewIdentifier];
    if(cell == nil){
        cell = [[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:TableViewIdentifier];
    } 
    //configure the cell
    checkbox = [UIButton buttonWithType:UIButtonTypeCustom];
    CGRect checkboxRect = CGRectMake(135, 150, 36, 36);
    [checkbox setFrame:checkboxRect];  
    [checkbox setImage:[UIImage imageNamed:@"unselected@2x.png"]forState:UIControlStateNormal];
    [checkbox setImage:[UIImage imageNamed:@"selected@2x.png"] forState:UIControlStateSelected];
    [checkbox addTarget:self action:@selector(checkboxClicked:) forControlEvents:UIControlEventTouchUpInside];
    cell.accessoryView = checkbox;

    NSString *group;
    NSUInteger row = [indexPath row];

    switch (indexPath.section) {
        case 0:
            group = [suggestedPeople objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 1:
            group = [aArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 2:
            group = [bArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 3:
            group = [cArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 4:
            group = [dArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 5:
            group = [eArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 6:
            group = [fArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 7:
            group = [gArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 8:
            group = [hArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 9:
            group = [iArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 10:
            group = [jArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 11:
            group = [kArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;
        case 12:
            group = [lArray objectAtIndex:row];
            cell.textLabel.text = group;
            break;

    }
}
return cell;} 
```

和我的其他一些方法：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
NSLog(@"cell is touched");
if(checkbox.state == UIControlStateNormal){
    [checkbox setImage:[UIImage imageNamed:@"unselected@2x.png"] forState:UIControlStateHighlighted];
}else if (checkbox.state == UIControlStateSelected) {
    [checkbox setImage:[UIImage imageNamed:@"selected@2x.png"] forState:UIControlStateHighlighted];
}}

-(void)checkboxClicked:(UIButton *)sender{
sender.selected = !sender.selected;

UITableViewCell *ownerCell = (UITableViewCell *)sender.superview;
NSIndexPath *ownerCellIndexPath = [self.myTableView indexPathForCell:ownerCell];

if(sender.selected){

}else{

}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:27:44.400

在 的地方：

```
[checkbox setImage:[UIImage imageNamed:@"selected@2x.png"] forState:UIControlStateSelected]; 
```

利用

```
 [checkbox setImage:[UIImage imageNamed:@"selected@2x.png"] forState:UIControlStateHighlighted]; 
```

可能有帮助

# prolog - Prolog，寻找最佳匹配

> ID：10234992
> 
> 赞同：4
> 
> 时间：2012-04-19T19:02:29.030
> 
> 标签：prolog, pattern-matching, intersection

我有几个序言事实：

```
relation('Kitchen', [item(spoon), item(fork),  item(knife)  ]).
relation('Lounge',  [item(sofa),  item(chair), item(table)  ]).
relation('Bedroom', [item(bed),   item(desk),  item(drawers)]). 
```

以及在运行时生成的列表，例如：

```
[item(spoon), item(knife)] 
```

从这个列表中，在这种情况下，我希望返回“厨房”，因为它是最佳匹配。

我想我需要使用`intersection/3`谓词来计算运行时列表中有多少匹配项，所以 Kitchen 会返回 2 而其他人会返回 0，但我不知道递归所有`relation/2`谓词的方法和测试每一个，然后只返回最佳匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:45:46.730

最好的解决方案是无法改进的： `\+ better_candidate(Goal,CurSolution)`. 当然，您可以实现更精细的比较技术，而不是简单的长度比较。

```
:- use_module(library(lists)).

relation('Kitchen', [item(spoon), item(fork),  item(knife)  ]).
relation('Lounge',  [item(sofa),  item(chair), item(table)  ]).
relation('Bedroom', [item(bed),   item(desk),  item(drawers)]).

best(X,Best) :-
    relation(Best,BestList), intersection(X,BestList,I),
    length(I,L),
    \+ better_candidate(X,L).

better_candidate(X,L) :-
    relation(C,CList), intersection(X,CList,CI),
    length(CI,CIL), CIL > L. 
```

# python - 如何在 QWebView 中单击提交按钮？

> ID：10234999
> 
> 赞同：2
> 
> 时间：2012-04-19T19:02:50.120
> 
> 标签：python, forms, qt, pyqt, pyside

我有以下代码（排除的类构造函数等） - 我正在使用 PySide 顺便说一句：

```
self.view = QWebView()

frame = self.view.page().mainFrame()
document = frame.documentElement()
search = document.findFirst("input[name=q]")
search.setAttribute("value", "srbija")

button = document.findFirst("input[name=btnK]") 
```

您可能已经注意到，这直接来自 google.com 主页。我试图基本上搜索页面。但我不知道点击“谷歌搜索”按钮。文档只提到了`button.evaluateJavaScript("click()")`，但这只调用了 JS 方法——在这种情况下我不需要任何 JS 方法，我需要实际单击按钮。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T02:33:32.860

为了关闭它，它看起来不会没有答案...... :)

根据这个问题，尝试用 替换`click()`：`this.click()`

[如何跟踪 QWebKit 中的链接？](https://stackoverflow.com/questions/1219880/how-to-follow-a-link-in-qwebkit)