# StackOverflow 问答 10196000-10196999

# android - 避免在更改边距时调整布局大小

> ID：10196000
> 
> 赞同：2
> 
> 时间：2012-04-17T17:23:32.903
> 
> 标签：android, layout, resize, margin

我正在以编程方式更改框架布局内布局的边距。我的目标是制作像 Facebook 应用程序一样的滑动视图。是否可以避免调整此布局的大小？这是我的布局移动：

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="48dp"
    android:background="#00a2ff"
    android:gravity="center_vertical"
    android:orientation="horizontal" >

    <LinearLayout
        android:id="@+id/left"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal" >

        <ImageView
            android:id="@+id/ivGPSSearching"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="4dp"
            android:src="@drawable/actionbar_gps_searching" />
    </LinearLayout>

    <ImageView
        android:id="@+id/ivStarsFilter"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:paddingLeft="10dp"
        android:paddingRight="10dp"
        android:src="@drawable/actionbar_star" />
</LinearLayout> 
```

我不希望调整左侧 LinearLayout 的大小。我希望你能明白我想要什么:)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:46:06.377

为了实现类似的效果，我们扩展了 Horizo​​ntalScrollView - 只是覆盖 onInterceptTouchEvent 和 onTouchEvent 以始终​​返回 false。然后你只需要把你的菜单放在左边，内容放在右边（内容必须与屏幕宽度相匹配）。

最后设置初始 Horizo​​ntalScrollView 滚动并绑定到按钮单击事件以更改滚动位置（horizo​​ntalScrollView.scrollTo 或 Horizo​​ntalScrollView.smoothScrollTo）。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T07:28:56.830

下面是使用 TranslateAnimation 并为动画设置监听器的示例代码

```
 @Override
    public void onAnimationEnd(Animation animation) 
    {

    //Just set the layout params for your view (layout) which is animated,
    //to make your view shift to  the new position

     RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(LayoutWidth, LayoutHeight);

     params.leftMargin = 100; //for example you want to shift 100 px from left

     params.rightMargin = -Layoutwidth; //this will avoid your view 
     //from shrinking and make it as wide as its width was, and - negative value will 
     //move it towards right

    otherLayout.setLayoutParams(params);

    } 
```

我希望它能让你清楚如何在动画后移动你的视图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-14T20:41:14.930

在过去的几个小时里，我也一直在为此挠头。事实证明，如果您更改两个相反的边距，则 ReleativeLayout 内的视图将不会调整大小或移动：

```
RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams( LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);
lp.setMargins(0, - yOffset, Integer.MIN_VALUE, yOffset); 
```

这很疯狂，但它有效......

# haskell - Cabal ExitFailure 127 是什么意思？

> ID：10196001
> 
> 赞同：4
> 
> 时间：2012-04-17T17:23:34.670
> 
> 标签：haskell, cabal, cabal-install

当我尝试安装“编码”库时，我遇到了这个失败，但我找不到任何文档来告诉我这意味着什么：

```
$ sudo cabal install encoding --global
Resolving dependencies...
cabal: Error: some packages failed to install:
encoding-0.6.6 failed during the configure step. The exception was:
ExitFailure 127 
```

编辑：使用详细日志记录，我有：

```
$ cabal install encoding --global -v
Reading available packages...
Resolving dependencies...
In order, the following would be installed:
encoding-0.6.6 (new package)
Extracting
/home/aditya/.cabal/packages/hackage.haskell.org/encoding/0.6.6/encoding-0.6.6.tar.gz
to /tmp/encoding-0.6.610687...
creating /tmp/encoding-0.6.610687/encoding-0.6.6/dist/setup
/tmp/encoding-0.6.610687/encoding-0.6.6/dist/setup/setup configure --verbose=2
--ghc --global --flags=newghc --flags=splitbase --constraint=HaXml ==1.22.5
--constraint=array ==0.3.0.2 --constraint=base ==4.3.1.0 --constraint=binary
==0.5.1.0 --constraint=bytestring ==0.9.1.10 --constraint=containers ==0.4.0.0
--constraint=extensible-exceptions ==0.1.1.2 --constraint=ghc ==7.0.3
--constraint=ghc-prim ==0.2.0.0 --constraint=mtl ==2.0.1.0
--constraint=regex-compat ==0.93.1
World file is already up to date.
cabal: Error: some packages failed to install:
encoding-0.6.6 failed during the configure step. The exception was:
ExitFailure 127 
```

这似乎仍然没有告诉我可能缺少什么 C 库依赖项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:31:03.493

这通常意味着缺少包（或其依赖项之一）所需的 C 库。

打开详细日志记录应该会有所帮助。

```
$ cabal install encoding -v 
```

# ios - iOS MDM 服务器 SSL 证书不受设备信任

> ID：10196002
> 
> 赞同：3
> 
> 时间：2012-04-17T17:23:34.463
> 
> 标签：ios, ssl, mdm

MDM 服务器使用自签名证书配置 SSL。在 iOS 设备上安装了 Web 服务器证书（自签名）。仍然收到错误“{web server} 的服务器证书无效”带有自签名证书的 mdm web 服务器可以工作吗？还是我需要从受信任的 CA 签署证书？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T12:29:18.810

在设备上安装证书，使其显示设置 > 常规 > 配置文件。您可以通过将证书通过电子邮件发送到设备上配置的电子邮件帐户或允许通过 HTTP(S) 下载证书来执行此操作。

# heroku - Rails 3.2 资产：预编译

> ID：10196003
> 
> 赞同：2
> 
> 时间：2012-04-17T17:23:38.530
> 
> 标签：heroku, asset-pipeline, ruby-on-rails-3.2

在与 heroku 搏斗了大约一周并通过各种障碍使其正常工作后（对新手的障碍，我绝对不会责怪 heroku），我终于让我的应用程序在它上面运行了。我必须调整的步骤之一是预编译我的资产

```
bundle exec rake assets:precompile 
```

并对 production.rb 中的生产环境进行一些更改 ...

```
# Don't fallback to assets pipeline if a precompiled asset is missed
config.assets.compile = true 
```

不幸的是，这破坏了我本地站点上的许多 js 行为。不过在heroku上工作正常。我一直在处理这个问题的方式是将我的本地副本回滚到这些更改之前的某个点，但我想了解它为什么会中断。还有资产：反编译吗？基本上，一个人到底是如何反转极性或其他什么的？我肯定会尝试更深入地了解资产管道，但与此同时，任何帮助或见解都会受到极大的赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T19:30:47.320

要删除本地副本中的预编译资产，您只需运行

```
rake assets:clean 
```

如果仍有问题，请清理浏览器缓存

# rss - 带有参数的 rss 供稿的 Google Adsense（用户创建的供稿）

> ID：10196004
> 
> 赞同：1
> 
> 时间：2012-04-17T17:23:41.177
> 
> 标签：rss, adsense, atom-feed, feedburner

我有一个网站，用户可以在其中选择一些选项，并根据所选值生成原子提要。现在我想使用 Google Adsense 将广告添加到提要中，这指向了 Feedburner。但 Feedburner 似乎只支持静态网址。当然，除非我为用户可以输入的每个组合手动创建 Feedburner 提要，但这是不可行的。

[我发现的相关问题](https://webapps.stackexchange.com/questions/4645/parameters-in-feedburner-feeds)

# wcf - 多个 TransactionScope - 获取过时的信息

> ID：10196005
> 
> 赞同：0
> 
> 时间：2012-04-17T17:23:52.690
> 
> 标签：wcf, transactionscope

这篇文章与我的这篇文章有些相关： [如何在 WCF 服务中同步数据库访问？](https://stackoverflow.com/questions/10166571/how-to-synchronize-database-access-in-a-wcf-service)

我得到的回答过于复杂和\或矛盾...... :(

我创建了一个示例 WCF 服务，并针对它运行了 3 个客户端实例。该服务与一个名为名称的 SQL 表进行通信，该表有几行。

一个客户端在服务中生成**函数 1**。

第二个客户端在服务中生成**函数 2**。

**function1**在服务上生成一个函数：

一个。将特定行从“Charlie”更改为“Chin”

湾。等待 5 秒

C。再次将行从“Chin”更改为“Carol”

**function2**生成一个返回所有名称列表的函数。

需要注意的是，服务中的两个函数都用“TransactionScope”包装。

我做什么：我运行**function1**（将'Charlie'更改为'Chin'并等待5秒），然后立即生成**function2**，它试图获取名称列表但挂起（因为**function1**尚未完成），并且几秒钟后，**function1**将名称从“Chin”更改为“Carol”，然后才释放**function2**并返回名称列表。

事情是 - 从**function2**返回的名称列表不包含 'Carol' ！它包含“查理”！为什么是这样 ？我认为因为**function2**挂起直到**function1**完成 - 它也只会在**function1**完成时获取数据，但显然情况并非如此。

我究竟做错了什么 ？

我**不想**开始使用锁，因为这会减慢整个系统的速度。在我的最终服务中，我将有大约 20 种方法，我不希望所有方法都必须使用锁......（只有 3-4 种方法用于“阅读”，但它们将被使用 95 ％ 的时间）...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:15:58.407

为此，您需要锁定正在更改的数据，以便其他进程在第一个进程完成之前无法读取数据。

您使用 TransactionScope 来执行此操作。将隔离级别设置为可序列化。这将锁定数据。您可能必须指定读取还更新数据（到相同的值），以让第二个调用等待。

[http://msdn.microsoft.com/en-us/library/system.transactions.isolationlevel(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/system.transactions.isolationlevel(v=vs.90).aspx)

# json - Dojo 在没有标识符的情况下读取 JSON 数据

> ID：10196006
> 
> 赞同：0
> 
> 时间：2012-04-17T17:23:59.473
> 
> 标签：json, dojo

我正在尝试从休息服务中解析 JSON。该服务不会将数据放入我认为 ItemFileReadStore 想要的格式，但我无法更改它。我在 dojo 库中找到的用于读取 JSON 数据的所有内容都需要一个标识符，而我的数据没有这个标识符。这是 JSON 数据：

```
 {"ChannelReadResponse":[
     {"Event":    {"@entityOrigin":"System","@entityId":"0x080e00000136ad8986520af104608052","Name":"Untitled","SymbolCode":"OHVPEV---------","TimeObserved":"2012-04-13T21:09:49.207Z","CreatedUser":"Helpdesk","ModifiedUser":"Helpdesk","CreatedTime":"2012-04-13T21:09:49.207Z","ModifiedTime":"2012-04-17T15:51:12.496Z"}, 
```

{"@entityOrigin":"System","@entityId":"0x080e00000136bb54ec770af104608028","Name":"我的事件","SymbolCode":"OHVPE----------","严重性": "SIGACT","Outcome":"Effective","TimeObserved":"2012-04-16T14:34:29.796Z","CreatedUser":"Helpdesk","ModifiedUser":"Helpdesk","CreatedTime":" 2012-04-16T14:34:29.796Z","ModifiedTime":"2012-04-17T15:50:52.499Z"} ],"频道":{"@writable":"false","@connected": "true","@entityId":"0x080e00000136ad8500760af104608064","Name":"Ozone", "Members":{"Member":[{"@entityOrigin":"System","@entityRef":"0x080e00000136ad8986520af104608052"},{"@entityOrigin":"System","@entityRef":"0x080e00000136bb54ec770af104608028"}] }}}, {"Event": {"@entityOrigin":"System ","@entityId":"0x080e00000136bc3c92d80af104608042","Name":"From2","SymbolCode":"OHVPE----------","TimeObserved":"2012-04-16T19:43: 03.150Z","CreatedUser":"Helpdesk","ModifiedUser":"Helpdesk","CreatedTime":"2012-04-16T19:43:03.150Z","ModifiedTime":"2012-04-16T19:43: 03.150Z"}, "频道": {"@writable":"false","@connected":"true","@entityId":"0x080e00000136bc3c92d80af104608034","Name":"Ozone2", "Members":{"Member":{"@entityOrigin":"System","@entityRef":"0x080e00000136bc3c92d80af104608042"}}} ]} ]}

有什么方法可以处理这些数据吗？我特别想要所有的事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T20:31:07.650

只需将其按摩成商店想要的形式即可。例如，如果您将数据返回到一个名为“data”的变量中，您可以轻松地执行以下操作：

```
 var json = {
        identifier: "@entityId",
        items: data
    }; 
```

然后只需使用`json`商店中的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:33:18.750

我只能考虑将您的 JSON 数据转换为 JavaScript Object Literal，然后将 ID 和 Name 添加到 JavaScript Object Literal....然后将其转换为 JSON，然后再将其传递给您的 Dojo Store。

我遇到过类似的问题，但我有幸将服务更改为返回带有标识符和名称的 JSON。我还没有尝试过我上面写的。

# jquery - 即使没有可滚动的内容，也会出现 css 溢出滚动条

> ID：10196008
> 
> 赞同：15
> 
> 时间：2012-04-17T17:24:04.263
> 
> 标签：jquery, html, css

我正在使用溢出：滚动，如下面的代码，我遇到的问题是即使没有文本滚动条仍然显示。
w3schools 上的演示：[http](http://www.w3schools.com/cssref/tryit.asp?filename=trycss_overflow) ://www.w3schools.com/cssref/tryit.asp?filename=trycss_overflow 您会看到，即使您无法水平滚动（向左或向右），仍然有一个滚动条。如果没有可滚动的内容，我正在尝试将它放在不出现滚动条的地方。希望这是有道理的

```
<style type="text/css">
  div.scroll {
    background-color: #00FFFF;
    width: 100px;
    height: 100px;
    overflow: scroll;
  }
</style>
<p>overflow:scroll</p>
<div class="scroll">You can use the overflow property when you want to have better control of the layout. The default value is visible.</div> 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-04-17T17:25:53.900

我想你正在寻找`overflow: auto`.

[Mozilla 关于溢出的文档](https://developer.mozilla.org/en-US/docs/Web/CSS/overflow)

> overflow CSS 属性是overflow-x 和overflow-y 属性的简写，它指定了当内容太大而无法适应其块格式上下文时要执行的操作。
> 
> 这些选项包括剪辑、显示滚动条或显示从其容器流出到周围区域的内容。

**汽车**

> 取决于用户代理。如果内容适合填充框，它看起来与可见相同，但仍会建立一个新的块格式化上下文。如果内容溢出，像 Firefox 这样的桌面浏览器会提供滚动条。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-17T17:27:42.137

尝试

```
overflow: auto 
```

您提供的链接非常复杂。这是所有解释，我认为更好：[CSS-Tricks](http://css-tricks.com/the-css-overflow-property/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-02-02T09:47:12.780

尝试`overflow: auto;` 这样 Scroll 根据是否需要自动发生。

使用`overflow-x: auto`或者`overflow-y: auto` 如果你想只为一个方向获得自动滚动条

# visual-studio-2010 - 为什么我的表单在 VS IDE 中显示通用名称？

> ID：10196013
> 
> 赞同：0
> 
> 时间：2012-04-17T17:24:26.733
> 
> 标签：visual-studio-2010

我将主窗体的名称更改为“FormMain”，但在 IDE 中仍然显示“Form1.cs [Design]”和“Form1.cs”

虽然不是一个炫耀，但我觉得这既烦人又让人分心。

我该如何纠正这种令人反感的发展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:27:48.923

如果您在解决方案资源管理器中将文件名更改为`Form1.cs`，`FormMain.cs`则应该没问题。我想您可能已经单击了表单并将`name`属性视图中的属性更改为`FormMain.cs`，这只会更改表单标题栏中显示的名称。也改一下文件名。

# android - Android 是否可以在 XML 文件中定义地图？

> ID：10196015
> 
> 赞同：24
> 
> 时间：2012-04-17T17:24:45.277
> 
> 标签：android, xml, map, resources

我试图定义一个利用资源的静态哈希表，但我因无法静态访问资源而陷入困境。

然后我意识到定义静态地图的最佳位置是在资源文件本身中。

如何在 XML 中定义地图？我相信如果可能的话，它应该类似于 Listpreference 机制，具有条目和条目值。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-02-06T21:46:23.490

一个更简单的选择是使用两个数组。这样做的好处是不再迭代 xml 文件，使用更少的代码，并且更直接地使用不同类型的数组。

```
<string-array name="myvariablename_keys">
   <item>key1</item>
   <item>key1</item>
</string-array>

<string-array name="myvariablename_values">
   <item>value1</item>
   <item>value2</item>
</string-array> 
```

然后你的java代码看起来像这样：

```
String[] keys = this.getResources().getStringArray(R.array.myvariablename_keys);
String[] values = this.getResources().getStringArray(R.array.myvariablename_values);
LinkedHashMap<String,String> map = new LinkedHashMap<String,String>();
for (int i = 0; i < Math.min(keys.length, values.length); ++i) {
   map.put(keys[i], values[i]);
} 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-04-17T18:09:12.767

> 如何在 XML 中定义地图？

```
<thisIsMyMap>
  <entry key="foo">bar</entry>
  <entry key="goo">baz</entry>
  <!-- as many more as your heart desires -->
</thisIsMyMap> 
```

把`res/xml/`它放进去，然后用`getResources().getXml()`. 走事件来建立一个`HashMap<String, String>`.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-03-09T22:04:47.893

您始终可以在`strings.xml`文件中嵌入 Json：

res/values/strings.xml

```
<string name="my_map">{"F":"FOO","B":"BAR"}</string> 
```

在您的活动中，您可以在方法中构建您的地图`onStart`：

```
private HashMap<String, String> myMap;

@Override
protected void onStart() {
    super.onStart();
    myMap = new Gson().fromJson(getString(R.string.my_map), new TypeToken<HashMap<String, String>>(){}.getType());
} 
```

此代码需要 Google Gson API 才能工作。您可以使用 Android SDK 中的内置 Json API 来完成。

至于静态访问地图，您可以创建一个静态方法：

```
private static HashMap<String, String> method(Context context) {
    HashMap<String, String> myMap = new Gson().fromJson(context.getString(R.string.serve_times), new TypeToken<HashMap<String, String>>(){}.getType());
    return myMap;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-04-24T20:02:18.443

上面的 CommonsWare 提到了正确的答案，但由于 XML 解析并不那么简单，为此目的遵循一个简单的解析器：

```
public static Map<String, String> getHashMapResource(Context context, int hashMapResId) {
    Map<String, String> map = new HashMap<>();
    XmlResourceParser parser = context.getResources().getXml(hashMapResId);

    String key = null, value = null;

    try {
        int eventType = parser.getEventType();

        while (eventType != XmlPullParser.END_DOCUMENT) {
            if (eventType == XmlPullParser.START_TAG) {
                if (parser.getName().equals("entry")) {
                    key = parser.getAttributeValue(null, "key");

                    if (null == key) {
                        parser.close();
                        return null;
                    }
                }
            }
            else if (eventType == XmlPullParser.END_TAG) {
                if (parser.getName().equals("entry")) {
                    map.put(key, value);
                    key = null;
                    value = null;
                }
            } else if (eventType == XmlPullParser.TEXT) {
                if (null != key) {
                    value = parser.getText();
                }
            }
            eventType = parser.next();
        }
    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }
    return map;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-09T19:49:24.557

Android 经常使用`DefaultsXmlParser.getDefaultsFromXml()`which parse next 语法：

```
<?xml version="1.0" encoding="utf-8"?>
<defaults>
    <entry>
        <key>api_url</key>
        <value>https://</value>
    </entry>
    <entry>
        <key>some_feature_flag</key>
        <value>true</value>
    </entry>
</defaults> 
```

并阅读地图：

```
val map = DefaultsXmlParser.getDefaultsFromXml(this, R.xml.my_map) 
```

# python - 将两个nparray相乘python

> ID：10196016
> 
> 赞同：1
> 
> 时间：2012-04-17T17:24:52.727
> 
> 标签：python, numpy

将两个 numpy 数组相乘的有效方法是什么？例如，给定

```
A = [1, 2, 3, 4]
B = [2, 3, 5, 7] 
```

我想计算A和B之间的点积，即

```
 A.B/|A||B| = (1*2 + 2*3 + .. 4*7)/sqrt(1^2 + 2^2... +4^2) * sqrt(.....) 
```

我怎样才能有效和快速地做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T17:27:31.077

如果您使用的是 numpy，[numpy.dot](http://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html)会为您完成这项工作

```
numpy.dot(A,B)
51 
```

* * *

向量的最快范数是

```
n = math.sqrt(numpy.dot(A,A.conj())) 
```

这是与其他方法的比较

```
>>> t1=timeit.Timer("n = math.sqrt(numpy.dot(A,A.conj()))","from __main__ import A,math,numpy")
>>> t2=timeit.Timer("n = math.sqrt(sum(abs(A)**2))","from __main__ import A,math")
>>> t3=timeit.Timer("numpy.linalg.norm(A)","from __main__ import A,numpy")
>>> print "%.2f usec/pass" % (1000000 * t1.timeit(number=100000)/100000)
2.82 usec/pass
>>> print "%.2f usec/pass" % (1000000 * t2.timeit(number=100000)/100000)
13.16 usec/pass
>>> print "%.2f usec/pass" % (1000000 * t3.timeit(number=100000)/100000)
15.68 usec/pass
>>> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T17:40:25.513

除了[`numpy.dot`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html)，还有[`numpy.linalg.norm`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.norm.html)which 可以满足您的需求：

```
from numpy.linalg import norm    
from numpy import dot

dot(a,b)/(norm(a)*norm(b)) 
```

我猜你想要平方和的 sqrt，这是`norm`. 该度量称为 Frobenius 范数或 L2 范数。如果你想要一个不同的指标，比如[曼哈顿](http://en.wikipedia.org/wiki/Taxicab_geometry)或 L1 范数，它只是一个传入的参数。

# php - Linux 专用服务器上的 Imagemagick php 执行

> ID：10196026
> 
> 赞同：1
> 
> 时间：2012-04-17T17:25:30.393
> 
> 标签：php, linux, imagemagick

我正在做一些 ImageMagick 的东西。这是我的命令：

```
/usr/bin/convert /home/setsail/public_html/microsite/images
/tmp/fe0e3b88601d254befc115ca6a50365b.png -alpha set -channel alpha -background none 
-vignette 0x3 -resize 66x89 /home/setsail/public_html/microsite/images/oval_thumb
/77bda03b6358b89efbe747ae414bd75f.png 
```

此代码羽化并调整图像大小。它在 shell 和 php 代码中的 localhost（我在 localhost 上使用 xampp）上运行良好，并且在 shell 中我的专用服务器上运行良好。

但是，它在带有 php 代码的专用服务器上根本不起作用。这是我的代码：

```
$cmd = "convert ".realpath($temp1)." -alpha set -channel alpha -background none    -vignette 0x3 resize ".$width."x".$height." ".$dest_img;
exec($cmd); 
```

ImageMagick 已正确安装在服务器上并处于活动状态，并且我在 phpinfo() 中看到它有什么想法为什么会发生，我该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T17:27:30.597

该命令`convert`可能不在`$PATH`Web 服务器正在使用的环境变量中。使用完整路径`convert`：

```
// Substitute the full path for /usr/bin
$cmd = "/usr/bin/convert ".realpath($temp1)." -alpha set -channel alpha -background none    -vignette 0x3 resize ".$width."x".$height." ".$dest_img;

$results = array();
$return_code = NULL;
exec($cmd, $results, $return_code);

// Check the output of the command for error:
var_dump($results);
var_dump($return_code); 
```

要找到`convert`的位置，请从您服务器上的 shell 执行

```
$ which convert 
```

# objective-c - 来自表视图控制器的多个 segue

> ID：10196031
> 
> 赞同：5
> 
> 时间：2012-04-17T17:25:52.487
> 
> 标签：objective-c, ios, storyboard, ios5

我有一个小应用程序，它为初始表格视图使用多个部分布局。一个部分显示 Twitter 的最新趋势，另一部分显示 Twitter 的最新故事。当我点击趋势列表中的一个项目时，我会转换到一个新的表格视图控制器，该控制器显示有关该趋势的最新推文。在故事部分的根控制器中，我希望能够在包含图像、链接等的不同视图控制器中显示更多信息。问题是，当我在故事部分中选择任何内容时，我会被推送到为趋势部分设置的表格视图控制器。我已经为每个 segue 命名并为我想要转换到的两个视图都有自定义类，我这样做是为了检查正在调用哪个 segue：

```
-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    if([[segue identifier] isEqualToString:@"viewTrendsSearch"]) {

        //get the controller that we are going to segue to
        SearchTrendResultsViewController *strvc = [segue destinationViewController];

        //get the path of the row that we want from the table view
        NSIndexPath *path = [self.tableView indexPathForSelectedRow];

        //here we get the trend object from the array we set up earlier to hold all trends
        Trends *results = [currentTrends objectAtIndex:[path row]];

        //pass the object that was selected in the table view to the destination view
        [strvc setQuery: results];
    }

    if([[segue identifier] isEqualToString:@"storyfullDetails"]) {

        StoriesViewController *svc = [segue destinationViewController];

        NSIndexPath *path = [self.tableView indexPathForSelectedRow];

        Stories *results = [currentStories objectAtIndex:[path row]];

        [svc setStory:results];
    }
} 
```

关于如何获得不同观点的任何建议？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-17T19:06:53.680

您的问题中没有足够的信息可以确定，但这听起来像是我所说的自动与手动segues以及对每个segues的限制的问题。

通过从（原型）表格单元格或其他控件拖动来在 IB 中创建**自动转场。**它的好处是它是自动的——点击控件执行segue，您在代码中需要做的就是实现`prepareForSegue:sender:`，以便目标视图控制器获得正确的数据。缺点是任何给定的控件（包括原型表单元格）只能有一个传出的segue（否则，故事板将不知道要自动执行哪个）。

通过从源*视图控制器拖动，在 IB 中创建***手动**segue 。这样做的好处是视图控制器可以有多个传出的segue。另一方面，它们与可点击控件无关，因此您必须实现确定何时执行的逻辑（并调用以使其发生）。*`performSegueWithIdentifier:`*

 *鉴于这些权衡，您的问题有两种可能的解决方案：

1.  使用多个原型表单元格——然后每个单元格都可以有自己的传出自动转场。您需要更改表格视图控制器`tableView:cellForRowAtIndexPath:`以检查索引路径的部分编号并为 选择适当的标识符`dequeueReusableCellWithIdentifier:`，但如果您的趋势和故事单元格具有不同的内容，这可能会使事情变得更加方便或高效。

2.  使用手动转场。然后，您的表视图控制器可以实现使用基于索引路径部分选择的适当标识符`tableView:didSelectRowAtIndexPath:`进行调用。`performSegueWithIdentifier:`

无论哪种方式，您的`prepareForSegue:sender:`实现看起来都很好。*

# java - 数组列表空指针异常 - Android

> ID：10196042
> 
> 赞同：0
> 
> 时间：2012-04-17T17:27:02.637
> 
> 标签：java, android, nullpointerexception

我正在尝试创建一个应用程序来检索用户最喜欢的书名，但是我一直坚持如何将这些信息显示给用户。我创建了一个 ArrayList 来存储所有信息。但是，在显示此信息时，我不断收到错误消息：

> java.lang.NullPointerException

当它尝试执行代码时

```
temp[i] = new HashMap<String,String>(); 
```

这个类如下图所示：

```
public class FavouriteQuotesActivity extends ListActivity {

    static final ArrayList<HashMap<String,String>> list = new ArrayList<HashMap<String,String>>();

    private void getFavorites() {
        DataBaseHelper myDbHelper = new DataBaseHelper(this);

        String favorites [] = myDbHelper.getFavourites();

        if(list.size() > 0)
        {
            list.removeAll(list);
        }

        for(int i = 0;i < favorites.length; i++)
        {
            String quotes = favorites[i];
            String[] quoteArray = quotes.split(":");
            HashMap<String,String> temp[] = null; 

            temp[i] = new HashMap<String,String>();
            temp[i].put("Author",(quoteArray[2]));
            temp[i].put("Quote",(quoteArray[4]));
            list.add(temp[i]);

        }

    } 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T17:30:29.013

看看这段代码：

```
HashMap<String,String> temp[] = null; 
temp[i] = new HashMap<String,String>(); 
```

您*刚刚为变量分配*了一个空值`temp`（通常会声明） - 因此，当您尝试访问下一条语句时，您`HashMap<String, String>[] temp`当然会得到一个。`NullPointerException``temp[i]`

目前尚不清楚为什么您在该代码中使用数组 - 为什么不只是使用：

```
HashMap<String, String> map = new HashMap<String, String>();
map.put("Author", quoteArray[2]);
map.put("Quote", quoteArray[4]);
list.add(map); 
```

此外，还不清楚你为什么在这里使用地图，因为它总是有相同的两个键。为什么不创建一个`Quote`具有 name 和 author 属性的类？此外，在这里使用静态变量似乎是个坏主意——为什么不在`getFavorites`每次调用时创建一个新列表，并在方法结束时返回它？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T17:30:25.367

`temp`不指向数组。您将其设置为`null`.

您将变量 temp 声明为数组（通过写入`HashMap temp[]`）。

如果它不是一个实际的数组，则不能设置任何元素。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-17T17:31:01.107

您在声明和使用`temp`错误。你不需要一个数组`HashMap`，只需要一个`HashMap`，因为`list`是一个`ArrayList<HashMap>`：

```
HashMap<String,String> temp = new HashMap<String,String>();
temp.put("Author",(quoteArray[2]));
temp.put("Quote",(quoteArray[4]));
list.add(temp); 
```

# javascript - 增加 z-index 并降低不透明度的幻灯片

> ID：10196045
> 
> 赞同：1
> 
> 时间：2012-04-17T17:27:24.343
> 
> 标签：javascript, jquery, css, z-index, opacity

第一次发帖，请多多包涵。

我正在尝试创建一个幻灯片：

*   为每个分配一个 z-index`<section>`
*   设置所有幻灯片的不透明度为 0.7
*   将当前顶部幻灯片的不透明度指定为 1

这是HTML：

```
<div id="slides">
  <section class="slide">
    <article>
      <h1>6</h1>
    </article>
  </section>
  <section class="slide">
    <article>
      <h1>5</h1>
    </article>
  </section>
  <section class="slide">
    <article>
      <h1>4</h1>
    </article>
  </section>
  <section class="slide">
    <article>
      <h1>3</h1>
    </article>
  </section>
  <section class="slide">
    <article>
      <h1>2</h1>
    </article>
  </section>
  <section class="slide">
    <article>
      <h1>1</h1>
    </article>
  </section>
</div>
<div id="prev">
  <a href="#previous">&larr;</a>
</div>
<div id="next">
  <a href="#next">&rarr;</a>
</div> 
```

这是到目前为止的JS：

```
$(document).ready(function() {
  var z = 0;
  var inAnimation = false;

  $('section.slide').each(function() {
    z++;
    $(this).css('z-index', z);
  });

  function swapFirstLast(isFirst) {
    if(inAnimation) return false;
    else inAnimation = true;

    var processZindex, direction, newZindex, inDeCrease;

    if(isFirst) {
      processZindex = z; direction = '-'; newZindex = 1; inDeCrease = 1;
    } else {
      processZindex = 1; direction = ''; newZindex = z; inDeCrease = -1;
    }

    $('section.slide').each(function() {
      if($(this).css('z-index') == processZindex) {
        $(this).animate({ 'top' : direction + $(this).height() + 'px' }, 'slow', function() {
          $(this).css('z-index', newZindex)
          .animate({ 'top' : '0' }, 'slow', function() {
            inAnimation = false;
          });
        });
      } else {
        $(this).animate({ 'top' : '0' }, 'slow', function() {
          $(this).css('z-index', parseInt($(this).css('z-index')) + inDeCrease);
        });
      }

      return false;
    }

    $('#next a').click(function() {
      return swapFirstLast(true);
    });

    $('#prev a').click(function() {
      return swapFirstLast(false);
    });
  });
}); 
```

我想我可以在脚本中插入以下代码：

```
if($(this).css('z-index') == processZindex) {
  $(this).css('opacity', 1);
} else {
  $(this).css('opacity', 0.7);
} 
```

问题是我似乎无法让不透明度为 1 以跟上 z-index 值 6。所以我想写`$(this).css('z-index') == processZindex`as`$(this).css('z-index') != 6`但问题发生了。

有没有更简单的编码方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T19:29:04.747

我只是使用元素的顺序而不是 z-index，使用`appendTo`, `preprendTo`：

[http://jsfiddle.net/jtbowden/RAT8N/1/](http://jsfiddle.net/jtbowden/RAT8N/1/)

我无法决定一个功能或单独的功能是否更好。这是两个单独的函数：

[http://jsfiddle.net/jtbowden/5LJcA/3/](http://jsfiddle.net/jtbowden/5LJcA/3/)

这就是你的目的吗？

# iphone - UIScrollView 作为子视图不滚动

> ID：10196046
> 
> 赞同：4
> 
> 时间：2012-04-17T17:27:26.007
> 
> 标签：iphone, uiview, uiscrollview

当我将**UIScrollView**设置为 Interface Builder 中的主视图时，滚动按预期工作。但是，当我将**UIScrollView添加为****UIView**的子视图时，滚动不起作用。

因此，当**UIScrollView**作为子视图添加到**UIView**时，我的麻烦似乎就开始了。

“已**启用用户交互**”对于两个视图都是正确的。

我虽然也许我可能不得不做一些事情 in **touchesBegan**一些湖将触摸传递给**UIScrollView**，但没有太多运气。

有没有人见过这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T14:34:02.677

```
scrollView.delegate = scrollView;  //or nil may work 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:58:30.093

展示一个完整的工作代码片段总是好的：

```
// in viewDidLoad: 

//UIScrollview *myScrollView;

UIView_descendent *contentView;
// scrollview won't scroll unless content size explicitly set

[myScrollView setContentSize:contentView.frame.size]; 
```

我还没有找到在 IB 中设置 contentSize 的方法。

# gwt - GWT RPC 序列化

> ID：10196055
> 
> 赞同：2
> 
> 时间：2012-04-17T17:27:47.380
> 
> 标签：gwt, serialization, rpc

我正在尝试通过 RPC 通过 MyClass 发送，但得到：类型 MyClass 不可分配给 'com.google.gwt.user.client.rpc.IsSerializable' 并且没有自定义字段序列化程序。出于安全目的，此类型不会被序列化。

我查看了[GWT - 偶尔 com.google.gwt.user.client.rpc.SerializationException](https://stackoverflow.com/questions/2122798/gwt-occasional-com-google-gwt-user-client-rpc-serializationexception)并尝试了他们的解决方案，但没有奏效。

不同之处在于 MyClass 位于另一个项目中。项目结构为：

```
MyApiProject
-contains MyClass
MyClientProject
MyServerProject 
```

我还尝试通过 MyApiProject 的 RPC 传递枚举，但也失败了。

```
public class MyClass
    implements Serializable
{
    private static final long serialVersionUID = 5258129039653904120L;

    private String str;

    private MyClass()
    {
    }

    public MyClass(String str)
    {
        this.str = str;
    }

    public String getString()
    {
        return this.str;
    }
} 
```

在 RemoteService 我有：

```
mypackage.MyClass getMyClass(); 
```

在 RemoteServiceAsync 我有：

```
void getMyClass(AsyncCallback<mypackage.MyClass> callback); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T20:35:01.510

我不得不将实现 Serializable 更改为实现 IsSerializable

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:43:17.457

当您在类中使用另一种不可序列化的类型时，这通常会弹出。检查你的类的属性，确保它们都是可序列化的，把 MyClass 的代码贴在这里我也可以看看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:38:12.677

我相信 GWT 需要一个 RPC 可序列化的类也有一个公共的无参数构造函数。

尝试删除

```
 private MyClass()
    {
    } 
```

或将其设置为

```
 public MyClass()
    {
    } 
```

# node.js - 在heroku上使用nodejs的ENOENT错误

> ID：10196057
> 
> 赞同：0
> 
> 时间：2012-04-17T17:28:00.107
> 
> 标签：node.js, heroku, railway.js

我的 heroku 应用程序出现 ENOENT 错误，阻止它启动：

错误：ENOENT，打开“/app/log/production.log”

但是这个文件/目录（应用程序/日志）确实存在......所以我不确定发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:19:28.727

我最终禁用了“安静”模式以停止将日志写入磁盘：

```
app.disable('quiet'); 
```

这似乎解决了它

# android - 没有这样的列错误，虽然列存在

> ID：10196060
> 
> 赞同：0
> 
> 时间：2012-04-17T17:28:20.870
> 
> 标签：android, sqlite

伙计们，我已经在这段代码上工作了很长时间，但我无能为力。尽管该列存在，但它一直在返回错误，顺便说一句。我在 sqlitebrowser 中创建了我的数据库。

这是返回错误的方法：

```
Cursor getWordMatches(String query) {
    myDataBase = khol();
    Cursor cur = myDataBase.rawQuery("SELECT " + colid + "," +col2+" ,"
            + col3 + " from " + deptTable + " WHERE " + col2 + " LIKE '"
            + query + "%'", new String[] {});

    myDataBase.close();
    return cur;
} 
```

其中 cur="column2" 我在 SuggestionProvider 类中调用此函数

SuggestionProvider 类

```
public class SuggestionProvider extends ContentProvider {
String TAG = "SuggestionProvider";

public static String AUTHORITY = "example.search.custom.SuggestionProvider";
public static final Uri CONTENT_URI = Uri.parse("content://" + AUTHORITY
        + "/Curedata");

// MIME types used for searching words or looking up a single definition
public static final String DISEASE_MIME_TYPE = ContentResolver.CURSOR_DIR_BASE_TYPE
        + "/vnd.example.search.custom.Curedata";
public static final String DESCRIPTION_MIME_TYPE = ContentResolver.CURSOR_ITEM_BASE_TYPE
        + "/vnd.example.search.custom.Curedata";

private DatabaseHelper2 mHelper;

// UriMatcher stuff
private static final int SEARCH_DISEASE = 0;
private static final int GET_DISEASE = 1;
private static final int SEARCH_SUGGEST = 2;
private static final UriMatcher sURIMatcher = buildUriMatcher();

@Override
public int delete(Uri uri, String selection, String[] selectionArgs) {
    // TODO Auto-generated method stub
    throw new UnsupportedOperationException();

}

private static UriMatcher buildUriMatcher() {
    // TODO Auto-generated method stub
    UriMatcher matcher = new UriMatcher(UriMatcher.NO_MATCH);
    // to get definitions...
    matcher.addURI(AUTHORITY, "Curedata", SEARCH_DISEASE);
    matcher.addURI(AUTHORITY, "Curedata/#", GET_DISEASE);
    // to get suggestions...
    matcher.addURI(AUTHORITY, SearchManager.SUGGEST_URI_PATH_QUERY,
            SEARCH_SUGGEST);
    matcher.addURI(AUTHORITY, SearchManager.SUGGEST_URI_PATH_QUERY + "/*",
            SEARCH_SUGGEST);

    return matcher;
}

@Override
public String getType(Uri uri) {
    // TODO Auto-generated method stub
    switch (sURIMatcher.match(uri)) {
    case SEARCH_DISEASE:
        return DISEASE_MIME_TYPE;
    case GET_DISEASE:
        return DESCRIPTION_MIME_TYPE;
    case SEARCH_SUGGEST:
        return SearchManager.SUGGEST_MIME_TYPE;

    default:
        throw new IllegalArgumentException("Unknown URL " + uri);
    }
}

@Override
public Uri insert(Uri uri, ContentValues values) {
    // TODO Auto-generated method stub
    throw new UnsupportedOperationException();
}

@Override
public boolean onCreate() {
    mHelper = new DatabaseHelper2(getContext());
    return true;
}

@Override
public Cursor query(Uri uri, String[] projection, String selection,
        String[] selectionArgs, String sortOrder) {
    // TODO Auto-generated method stub
    switch (sURIMatcher.match(uri)) {
    case SEARCH_SUGGEST:
        if (selectionArgs == null) {
            throw new IllegalArgumentException(
                    "selectionArgs must be provided for the Uri: " + uri);
        }

        return mHelper.getWordMatches(selectionArgs[0]);
    case SEARCH_DISEASE:
        if (selectionArgs == null) {
            throw new IllegalArgumentException(
                    "selectionArgs must be provided for the Uri: " + uri);
        }
        return mHelper.getWordMatches(selectionArgs[0]);

    case GET_DISEASE:
        return getWord(uri);

    default:
        throw new IllegalArgumentException("Unknown Uri: " + uri);
    }
}

private Cursor getWord(Uri uri) {
    // TODO Auto-generated method stub
    String disease = uri.getLastPathSegment();
    mHelper.getstring(disease);
    return mHelper.getdisease();

}

@Override
public int update(Uri uri, ContentValues values, String selection,
        String[] selectionArgs) {
    // TODO Auto-generated method stub
    throw new UnsupportedOperationException();
} 
```

但是 LogCat 给出了例外

```
android.database.sqlite.SQLiteException->no such column:column2 
```

帮帮我。我被困住了！

**编辑：**
数据库创建代码

```
public class DatabaseHelper2 extends SQLiteOpenHelper {

private static String DB_PATH = "/data/data/example.SQLitetest/";

private static String DB_NAME = "desicures.db";

    private SQLiteDatabase myDataBase, mydb1;

private final Context myContext;

private String colname = "Area";

private String deptTable = "Curedata";

public static String col2 = "column2";

public static String col3 = "Description";

public static String colid = "_ID";
private String s;
private String y = "Y";

public DatabaseHelper2(Context context) {

    super(context, DB_NAME, null, 1);
    this.myContext = context;
}

public SQLiteDatabase khol() throws SQLException {

    // Open the database
    String myPath = DB_PATH + DB_NAME;
    myDataBase = SQLiteDatabase.openDatabase(myPath, null,
            SQLiteDatabase.OPEN_READWRITE);
    return myDataBase;
}

@Override
public synchronized void close() {

    if (myDataBase != null)
        myDataBase.close();

    super.close();

}

ArrayList<String> getAllDiseases() {
    ArrayList<String> list = new ArrayList<String>();

    myDataBase = khol();
    Cursor cur = myDataBase.rawQuery("SELECT " + col2 + " from "
            + deptTable + " WHERE " + colname + "='head'", new String[] {});
    while (cur.moveToNext()) {
        list.add(cur.getString(cur.getColumnIndexOrThrow(col2)));

    }
    cur.close();
    myDataBase.close();
    return list;
}

Cursor getWordMatches(String query) {
    myDataBase = khol();
    Cursor cur = myDataBase.rawQuery("SELECT " + colid +","+col2+" ,"
            + col3 + " from " + deptTable + " WHERE " + col2 + " LIKE '"
            + query + "%'", new String[] {});
    /*Cursor cur = myDataBase.rawQuery("SELECT " +"'"+ colid+"'" +","+"'"+col2+"'"+" ,"
            + "'"+col3+"'" + " from " + deptTable + " WHERE " + "'"+col2+"'" + " LIKE '"
            + query + "%'", new String[] {});*/

    //myDataBase.close();
    return cur;
}

void getstring(String s) {
    this.s = s;
}

Cursor getdisease() {

    myDataBase = khol();
    Cursor cur = myDataBase.rawQuery("SELECT " + col3 + " from "
            + deptTable + " WHERE " + colid + "='" + s + "'",
            new String[] {});
    return cur;
}

String getdisease1() {

    String list;
    myDataBase = khol();
    Cursor cur = myDataBase.rawQuery("SELECT " + col3 + " from "
            + deptTable + " WHERE " + colid + "='" + s + "'",
            new String[] {});
    cur.moveToFirst();
    list = cur.getString(cur.getColumnIndexOrThrow(col3));
    return list;
}

@Override
public void onCreate(SQLiteDatabase db) {

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

}

} 
```

我尝试了很多方法，发现 getWordMatches 引起了一些问题。即使我按照答案中的建议在所有列上使用“'”，它也不会返回任何内容。但是如果我不使用“'”，那么它会给出“没有这样的列”的错误。
请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:58:35.090

不要关闭你的数据库。删除此行`myDataBase.close();`

除了 Habib.OSU 所说的

# android - 如何使用 android 的线程支持编译 ffmpeg 和 x264？

> ID：10196061
> 
> 赞同：0
> 
> 时间：2012-04-17T17:28:23.043
> 
> 标签：android, ffmpeg, x264

我想编译 x264 和 ffmpeg 并支持 ANDROID .FFmpeg 和 x264 即使在分别启用 enable-pthreads 和 enable-threads 之后也没有使用线程支持进行编译。

config.h 都包含 #define HAVE_THREAD 0 和 #define HAVE_PTHREADS 0

1.如何编译线程支持。2.第二个问题是，当我将 gop 大小从 1 增加到某个其他值时，编码器会为某些后续帧返回 0。这会导致视频播放延迟超过 3 到 5 秒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-11T05:38:04.530

我正在使用 NDK9 独立工具链交叉编译最后一个支持线程的 x264 库。

这是我的步骤。 [http://bashell.nodemedia.cn/archives/cross-complie-pthread-android-x264-library.html](http://bashell.nodemedia.cn/archives/cross-complie-pthread-android-x264-library.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T09:44:50.593

对于第一部分，也许看看 configure 如何检查是否支持 pthread 是一个不错的起点？我在 x264 中看到了一个可能有帮助的 autotools 机器补丁：http: [//mailman.videolan.org/pipermail/x264-devel/2012-April/009309.html](http://mailman.videolan.org/pipermail/x264-devel/2012-April/009309.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T18:04:20.197

在此处查看我的**x264补丁：** [https ://mailman.videolan.org/pipermail/x264-devel/2013-March/009941.html](https://mailman.videolan.org/pipermail/x264-devel/2013-March/009941.html)

这两个简单的步骤也适用于**ffmpeg**

# node.js - 在 nodejs 应用程序上更改为 STDOUT 日志记录

> ID：10196069
> 
> 赞同：1
> 
> 时间：2012-04-17T17:29:09.623
> 
> 标签：node.js, heroku, express

从这里开始： [在heroku上使用nodejs的ENOENT错误](https://stackoverflow.com/questions/10196057/enoent-error-using-nodejs-on-heroku)

有人建议我在我的 node.js 应用程序上使用 STDOUT 日志记录...？这可能吗？如果是这样，我如何/在哪里配置它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T00:20:13.047

相关： [在heroku上使用nodejs的ENOENT错误](https://stackoverflow.com/questions/10196057/enoent-error-using-nodejs-on-heroku/10201055#10201055)

我最终禁用了“安静”模式以停止将日志写入磁盘：

app.disable('安静'); 这似乎解决了它

# css - CSS边框形状 - 如何切断矩形右上角

> ID：10196072
> 
> 赞同：5
> 
> 时间：2012-04-17T17:29:25.897
> 
> 标签：css

我只是想知道有没有办法制作一个像形状边框一样的标签？为了更清楚，我要用星号画出形状。我的意思是这个边框形状。

```
*********************
***********************
*************************
***************************
***************************
***************************
***************************
*************************** 
```

为此，如何在 CSS 中切断矩形右上角？或者什么是更优化的方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T18:00:09.693

您可以使用边框来实现类似的效果。[jsfiddle](http://jsfiddle.net/Ghokun/Q5NrB/1/)如果你坚持纯 css，也许不是最好的答案，而是一个起点。

编辑：在此处更新**[JsFiddle 演示](http://jsfiddle.net/Ghokun/9qAVF/)**

**标记**

```
<div>
<div class="wrapper inner">
    <div class="abc"></div>
    <div class="container">I AM A TAB<div>
</div>
<div class="border inner">
    <div class="ab"></div>
    <div class="bcontainer"><div>
</div>
</div> 
```

​</p>

**CSS**

```
.inner{position:fixed;}

.border{width:72px;height:52px;z-index:-1;top:0px;}

.wrapper{width:70px;top:1px;left:1px;}

.container {background:rgb(226,226,226);text-align:center;}

.bcontainer{background:black;width:71px;height:41px;}
.abc {
    width: 60px;
    border-bottom: 10px solid rgb(226,226,226);
    border-right: 10px solid transparent;
}

.ab{    width: 61px;
    border-bottom: 11px solid black;
    border-right: 10px solid transparent;}​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T17:33:53.060

CSS 不支持任何非方形、非圆形的边框形状。您可以使用一堆具有阶梯宽度或图像的 DIV，但仅靠 CSS 并不能真正提供帮助。

或者，您可以尝试覆盖一些[CSS 三角形](http://css-tricks.com/snippets/css/css-triangle/)，但这有点小技巧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-19T22:58:20.820

使用`border-corner-shape`css 属性可以解决问题……如果它是在 CSS3 中实现的！它是在 CSS4 草案中提出的——是的，不是开玩笑！

然而，实施是不确定的，需要支持。阅读： http: [//lea.verou.me/2013/03/border-corner-shape-is-in-danger-and-you-can-help/](http://lea.verou.me/2013/03/border-corner-shape-is-in-danger-and-you-can-help/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T17:34:56.877

如果那个角可以变圆，`border-radius`可能就是你所需要的：http: [//border-radius.com/](http://border-radius.com/)

如果角落必须是一个角度，那么如果没有一些非常混乱的 HTML，您就不可能得到它。没有标准的属性可以做到这一点。最好的替代方法是将边框的特定部分制作为图像，然后使用`background-image`并将`background-position`其放置在上角。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-17T17:34:01.993

您可以使用 CSS3`border-radius`属性：[http](http://www.w3schools.com/cssref/css3_pr_border-radius.asp) ://www.w3schools.com/cssref/css3_pr_border-radius.asp （[示例](http://www.w3schools.com/cssref/tryit.asp?filename=trycss3_border-radius)）

# visual-studio - 在两个解决方案中拥有相同的 Visual Studio 项目是不是很糟糕？

> ID：10196073
> 
> 赞同：0
> 
> 时间：2012-04-17T17:29:25.817
> 
> 标签：visual-studio, projects-and-solutions, code-organization

我正在使用 Google 协议缓冲区编写网络库。我有一个 Visual Studio 项目，它执行自定义构建步骤以运行 Protobuf 编译器，以及另一个构建输出类的项目。

我想将客户端库和服务器库放在单独的解决方案中。但两者都依赖于相同的 Protocol Buffers 类。如果它们都包含与 Protobuf 相关的项目，可以吗？

编辑澄清：我知道这样做是*可能*的，但我很好奇它是否被认为是好的做法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:33:38.733

好吧，我认为这不是一个坏主意，但您可能需要考虑将您的协议缓冲区项目编译为 .dll 文件，并让您的客户端和服务器端项目引用它。在我看来只是更清洁。

当您对 .dll 进行更改时，您可以在服务器和客户端项目中右键单击对它的引用，然后单击`Update Reference`。就那么简单！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T12:21:13.820

**那没问题。**

我通常有几个解决方案（当我有 20 多个项目时）具有相同的项目集。例如，我有我需要的所有项目的主要解决方案。和开发解决方案，我还包括单元测试项目或开发所需的类似项目。

有一些链接指向**组织项目和解决方案的最佳实践**：

*   [**在 Visual Studio.NET 中改进大型构建的 SSW 规则**](http://www.ssw.com.au/ssw/Standards/Rules/RulesToBetterLargedotNETProjects.aspx)
*   [**构建解决方案和项目**](http://msdn.microsoft.com/en-us/library/Ee817675%28pandp.10%29.aspx)
*   [**管理依赖项**](http://msdn.microsoft.com/en-us/library/Ee817675%28pandp.10%29.aspx)

希望这有助于找出可以应用于您的案例的最佳实践。

# rally - Rally App SDK：有没有办法为表格设置子列？

> ID：10196076
> 
> 赞同：1
> 
> 时间：2012-04-17T17:29:38.740
> 
> 标签：rally

有没有办法将一列拆分为表的子列？例如，主列是发布的迭代，但是每次迭代都会有资源|计划|接受的子列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:26:39.180

你可以用一点 CSS 和几个 span 相当简单地做到这一点。下面是一个简单的示例。您可能会更喜欢您的 CSS 并在子列周围绘制一些边框，但这给出了想法。请注意，当您以这种方式执行操作时，整个列的排序由第一个子列中的值决定...

```
 <html>
        <head>
        <title>Table With Sub Columns Example</title>
        <meta name="Name" content="Table With Sub Columns Example" />

        <style type="text/css">

            .subColumnLeft {
                float: left;
                text-align: center;
                width: 200px;
            }

            .subColumnRight {
                float: right;
                text-align: center;
                width: 200px;
            }

        </style>

        <script type="text/javascript" src="https://rally1.rallydev.com/apps/1.31/sdk.js"></script>
        <script type="text/javascript">

            rally.addOnLoad(function(){

                var table = new rally.sdk.ui.Table({
                    columns: [
                        {key: 'name', header: 'Name', width: 100},
                        {key: 'subColumnData', header: '<span class="subColumnLeft">Sub Column 1 Header</span>' +
                                '<span class="subColumnRight">Sub Column 2 Header</span>', width: 430}
                    ]
                });

                table.addRows([
                    {
                        name: 'Test 1',
                        subColumnData: '<span class="subColumnLeft">Sub Column 1 Data Here</span>' +
                                '<span class="subColumnRight">Sub Column 2 Data Here</span>'
                    },
                    {
                        name: 'Test 2',
                        subColumnData: '<span class="subColumnLeft">Sub Column 1 Data Here</span>' +
                                '<span class="subColumnRight">Sub Column 2 Data Here</span>'
                    }
                ]);

                table.display('tableDiv');

            });

        </script>
    </head>
    <body>
    <div id="tableDiv"></div>
    </body>
    </html> 
```

# android - 更新时如何保持列表视图的滚动位置

> ID：10196079
> 
> 赞同：23
> 
> 时间：2012-04-17T17:29:51.963
> 
> 标签：android, json, listview, scroll, autoscroll

`ListView`我已经阅读了很多示例，但是如果我希望在更新a 后保持滚动位置`JSON`，那么我可以在不使用`AsyncTask`实例的情况下做到这一点吗？？？

**我的清单的代码是**

```
 String wrd;
    //ArrayList<HashMap<String,String>> mylist;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Intent i2=getIntent();
         wrd=i2.getStringExtra("entrd");
        Log.v("keyis",wrd);

        final Handler handler = new Handler();
        Runnable runable = new Runnable() {

            @Override
            public void run() {

                //call the function
                LoadData();
                //also call the same runnable
                handler.postDelayed(this, 40000);
            }
        };
        handler.postDelayed(runable, 10);

    }public void LoadData(){

         JSONObject j2=JSONfunctions.getJSONfromURL("/webservice_search.php?keyword="+wrd+"&format=json");
         ArrayList<HashMap<String,String>> mylist = new  ArrayList<HashMap<String,String>>();

         try{JSONArray jray=j2.getJSONArray("listings");
            for(int i=0;i<jray.length();i++){
                Log.v("state","json data being read");
                JSONObject j3= jray.getJSONObject(i);
                String first=j3.getString("listing");
                Log.v("sublist", first);
                JSONObject j4=j3.getJSONObject("listing");
                String sec=j4.getString("links");

                int maxLength = (sec.length() < 30)?sec.length():27;
                sec.substring(0, maxLength);
                String cutsec=sec.substring(0,maxLength);
                Log.v("links are",cutsec);
                String img=j4.getString("image_name");
                Log.v("image name is ",img);
                //Uri dimg=Uri.parse("http://zeesms.info/android_app_images/Koala.jpg");
                HashMap<String,String> map=new HashMap<String,String>();

                map.put("Id",String.valueOf(i));
                map.put(Li_nk,cutsec);
                map.put(Image_name,j4.getString("image_name"));

                map.put(KEY_THUMB_URL,"http://zeesms.info/android_app_images/"+img);
                mylist.add(map);

            }

            }
            catch(JSONException e){

                Log.e("loG_tag","Error parsing"+e.toString());
            }
         LazyAdapter adapter = new LazyAdapter(this,mylist);
         adapter.notifyDataSetChanged();

            ListView list=(ListView)findViewById(R.id.lv1);
             list.setEmptyView(findViewById(R.id.empty));
             list.setAdapter(adapter);

                list.setItemsCanFocus(false); 
```

**我的适配器是**

```
public class LazyAdapter extends BaseAdapter {
private Activity activity;
private ArrayList<HashMap<String, String>> data;
private static LayoutInflater inflater=null;
public ImageLoader imageLoader; 

public LazyAdapter(Activity a, ArrayList<HashMap<String, String>> d) {
    activity = a;
    data=d;
    inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    imageLoader=new ImageLoader(activity.getApplicationContext());
}

@Override
public int getCount() {
    // TODO Auto-generated method stub
    return data.size();
}

@Override
public Object getItem(int position) {
    // TODO Auto-generated method stub
    return position;
}

@Override
public long getItemId(int position) {
    // TODO Auto-generated method stub
    return position;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View vi=convertView;
    if(convertView==null)

        vi = inflater.inflate(R.layout.custom_row_view1, null);

    TextView title = (TextView)vi.findViewById(R.id.linkname); // merchnts name
    TextView artist = (TextView)vi.findViewById(R.id.imagename); // address
    //TextView duration = (TextView)vi.findViewById(R.id); // distance
   ImageView thumb_image=(ImageView)vi.findViewById(R.id.mClogo); // logo

    HashMap<String, String> jsn = new HashMap<String, String>();
    jsn = data.get(position);

    // Setting all values in listview
   title.setText(jsn.get(Second.Li_nk));
   artist.setText(jsn.get(Second.Image_name));
    //duration.setText(song.get(CustomizedListView.KEY_DURATION));
    imageLoader.DisplayImage(jsn.get(Second.KEY_THUMB_URL), thumb_image);
    return vi;
} 
```

**最后用于 json 解析的类是**

```
 public class JSONfunctions {

    public static JSONObject getJSONfromURL(String url){
        InputStream is = null;
        String result = "";
        JSONObject jArray = null;
        String  str1="http://zeesms.info"+url;

  // ArrayList<NameValuePair> namevaluepairs = new ArrayList<NameValuePair>();
        Log.v("url result",url);
        //namevaluepairs.add(new BasicNameValuePair("location",str1));
        //http post
        try{   
            HttpClient httpclient= new DefaultHttpClient();
            HttpGet request = new HttpGet();

            request.setURI(new URI(str1));
            HttpResponse response = httpclient.execute(request);

            is  = response.getEntity().getContent();
            if(is==null){
                 Log.v("url result","is  null");
            }
            else
            {
                Log.v("url result","is  not null");
            }

        /*    BufferedReader buf = new BufferedReader(new InputStreamReader(is,"UTF-8"));

            StringBuilder sb = new StringBuilder();
            String s;
            while(true )
            {
                s = buf.readLine();
                if(s==null || s.length()==0)
                    break;
                sb.append(s);

            }
            buf.close();
            is.close();

            sb.toString();  */

        //  httppost.setEntity(new UrlEncodedFormEntity(namevaluepairs));
            //HttpResponse response=httpclient.execute(httppost);
            //HttpEntity entity=response.getEntity();
            //is=entity.getContent();

            /*
                HttpClient httpclient = new DefaultHttpClient();
                HttpPost httppost = new HttpPost(url);
                HttpResponse response = httpclient.execute(httppost);
                HttpEntity entity = response.getEntity();
                is = entity.getContent();
*/
        }catch(Exception e){
                Log.v("log_tag", "Error in http connection "+e.toString());

                AlertDialog.Builder alert=new AlertDialog.Builder(null);
                alert.setMessage("Invalid Keyword").setPositiveButton("Ok", new OnClickListener(){

                    @Override
                    public void onClick(DialogInterface arg0, int arg1) {
                        // TODO Auto-generated method stub

                    }

                });
        }

      //convert response to string
        try{
            Log.v("url result","getting result starts");

                BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);

                StringBuilder sb = new StringBuilder();

                String line = null;
                Log.v("url result","getting result");
                while ((line = reader.readLine()) != null) {
                    Log.v("url result","getting result");
                        sb.append(line + "\n");
                }

                is.close();

                result=sb.toString();
                Log.v("url result",result);

        }catch(Exception e){
                Log.e("log_tag", "Error converting result "+e.toString());
        }

        try{

            jArray = new JSONObject(result);            
        }catch(JSONException e){
                Log.e("log_tag", "Error parsing data "+e.toString());
        }

        return jArray;
    }

} 
```

除此之外，如果数据是从网页更新的，那么在顶部显示更新项目的最简单方法是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-11T13:50:48.517

只调用 notifydatasetchanged() 更容易保持滚动位置。问题是每次数据更新时您都在创建一个新适配器......您应该执行以下操作：

```
if(listView.getAdapter()==null)
   listView.setAdapter(myAdapter);
else{
   myAdapter.updateData(myNewData);  //update adapter's data
   myAdapter.notifyDataSetChanged(); //notifies any View reflecting data to refresh
} 
```

这样，您的列表视图将保持滚动位置。

如果您想滚动到新位置，请使用：

```
list.smoothScrollToPosition(int position); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-06-24T11:41:40.827

如果由于某种原因您不想调用 notifyDataSetChanged()，您可以使用 setSelectionFromTop() 来保持位置

更新适配器之前：

```
lastViewedPosition = listView.getFirstVisiblePosition();

//get offset of first visible view
View v = listView.getChildAt(0);
topOffset = (v == null) ? 0 : v.getTop(); 
```

更新适配器后：

```
listView.setSelectionFromTop(lastViewedPosition, topOffset); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-17T17:47:49.420

```
list.smoothScrollToPosition(int position);     //my favorite :) 
```

它还可以帮助您将 nice'n'smooth 滚动到特定项目

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-17T17:33:32.243

```
listview.setSelection( i ); 
```

这将帮助您在顶部设置特定行

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-09-26T10:54:27.380

对于整体图片：

在您的 API 响应回调中，调用以下函数（示例）：

```
MyAdapter mAdapter;
ArrayList<Users> mUsers;

private void updateListView(ArrayList<Users> users) {
    mUsers.addAll(users);
    if(mAdapter == null) {
        mAdapter = new MyAdapter(getContext(), mUsers);
        mListView.setAdapter(mAdapter);
    }
    mAdapter.notifyDataSetChanged(); // Add this one
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-02-19T21:41:06.813

如果您使用的是 ArrayAdapter（或其子类），则问题可能是由于适配器在您在添加新项目之前对其进行清理时更新了列表：

```
adapter.clear();
adapter.addAll(...); 
```

您可以通过包装修改适配器的代码来修复它，如下所示：

```
adapter.setNotifyOnChange(false); // Disable calling notifyDatasetChanged() on modification
adapter.clear();
adapter.addAll(...); // Notify the adapter about that data has changed. Note: it will re-enable notifyOnChange
adapter.notifyDataSetChanged(); 
```

# ruby-on-rails - rails 使用现有应用程序的大部分开始一个新项目？

> ID：10196080
> 
> 赞同：0
> 
> 时间：2012-04-17T17:29:57.753
> 
> 标签：ruby-on-rails, project, ruby-on-rails-3.2

根据我之前编写的现有应用程序的代码创建新的 Rails 应用程序的最佳方法是什么（大量初始化程序，正确配置设置）

我发现在 Rails 中制作我现有应用程序的干净副本并将其用作新应用程序的基础几乎是不可撤销的。

我应该从头开始吗？然后稍后查看初始化程序并将更改的部分复制过来？似乎这是没有各种问题的唯一方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:32:42.393

另一种方法是复制您的应用程序，并清空大部分应用程序/控制器、应用程序/模型和应用程序/视图。

我建议你创建一个空项目。然后复制您的应用程序，并将应用程序目录（在您的副本中）替换为空项目中的应用程序目录。

# sharepoint - 如何在 SharePoint 2010 事件处理程序解决方案中发送电子邮件？

> ID：10196081
> 
> 赞同：2
> 
> 时间：2012-04-17T17:30:01.917
> 
> 标签：sharepoint, event-handling

我正在为 SharePoint 2010（沙盒解决方案）创建 C# 事件处理程序。当 ItemAdded 事件被触发时，我执行了一些逻辑，然后我想发送一封电子邮件。

不幸的是，沙盒解决方案中似乎不允许使用 SPUtility.SendEmail 和 System.Net.Mail。有没有办法解决？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:44:31.573

根据文档[SPUtility.SendEmail](http://msdn.microsoft.com/en-us/library/ms460489.aspx)在沙盒解决方案中不可用，您是正确的。

解决方案是创建一个可以为您发送电子邮件的[完全信任代理。](http://msdn.microsoft.com/en-us/library/ff798482.aspx)

# sql-server - SQL Server 可以使用多个索引吗？

> ID：10196086
> 
> 赞同：1
> 
> 时间：2012-04-17T17:30:11.447
> 
> 标签：sql-server, sql-server-2008, indexing

恕我直言，SQL Server 可以自行选择（除非被告知）用于查询的*最佳索引是什么。*

行

像这样的东西（伪代码）怎么样：

```
select __a from tbl where __a not in
 (
   select __b  from tbl 

 ) 
```

（假设我们有`index_1`哪个是为了`(__a)`，`index_2`哪个是为了`(__b)`

SQL Server 是否仍会在执行时使用*一个*索引或同时使用多个索引...？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T18:15:54.070

首先，创建您的表：

```
USE tempdb;
GO
CREATE TABLE dbo.tbl(__a INT, __b INT); 
```

然后创建两个索引：

```
CREATE INDEX a_index ON dbo.tbl(__a);
CREATE INDEX b_index ON dbo.tbl(__b); 
```

现在填充一些数据：

```
INSERT dbo.tbl(__a, __b)
  SELECT [object_id], column_id
    FROM sys.all_columns; 
```

现在运行您的查询并打开实际的执行计划。您将看到类似这样的内容，表明是的，两个索引都被使用（实际上 __b 上的索引既用于子查询中的数据检索，也用于寻求消除行）：

![在此处输入图像描述](../Images/65cdb51e52e6bf4b256af176adf33993.png)

编写查询的更有效方法是：

```
select __a from dbo.tbl AS t where not exists
 (
   select 1 from dbo.tbl AS t2 
     where t2.__b = t.__a
 ); 
```

现在这是您的整个计划（同样，两个索引都被使用，但请注意操作少得多）：

![在此处输入图像描述](../Images/300751e925806acdf24022ce781ab83d.png)

# vba - 下标超出范围，即使值已定义

> ID：10196087
> 
> 赞同：2
> 
> 时间：2012-04-17T17:30:18.767
> 
> 标签：vba, excel

我正在编写一段代码，将 Excel 工作表上的选定数据传输到一个数组中，然后用于在新的电子表格上打印数据。但是，我收到“下标超出范围”错误，即使在我滚动 selectArr(i - 1) 时出现了一个值。这是我的代码：

```
Sub Marascuilo()
    Dim numRows As Integer 'Number of rows selected
    numRows = Selection.Rows.Count
    Dim selectArr() As Double 'Array containing numbers from selected cells
    selectArr = loadArr(numRows) 'Load values into array
    For i = 2 To UBound(selectArr) - LBound(selectArr) + 2
        Sheets("Sheet 4").Cells(i, 2).Value = selectArr(i - 1)
    Next
End Sub

'This function loads the values from the selected cells into selectArr.
Function loadArr(numRows) As Double()
    Dim ResultArray() As Double
    r = 1
    For Each v In Selection
        ReDim Preserve ResultArray(1 To r)
        If v <> "" Then
            ResultArray(r) = v.Value
            r = r + 1
        End If
    Next
    loadArr = ResultArray
End Function 
```

关于如何解决此问题的任何想法？

谢谢！

周杰伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:24:08.447

您可以考虑使用工作表的 CodeName，而不是使用 Sheets("Sheet 4")。如果您查看 Project Explorer 窗口，每个工作表都有一个 Name 和一个 CodeName。它可能看起来像这样

```
Sheet1 (Sheet1)
Sheet2 (Sheet2) 
```

第一个是 CodeName（不能从 UI 更改）。括号中的一个是选项卡名称。在 Project Explorer 中选择工作表并按 F4 打开 Properties 对话框。转到 (Name) 属性（名称不佳的属性）并将其更改为有意义的内容。我更改了所有工作表的代码名称并使用 wsh 前缀。我作为日志的工作表的 CodeName 为

```
wshLog 
```

现在我可以在我的代码中使用 wshLog 并获得一些好处。首先是如果有人在 UI 中重命名工作表，代码仍然有效。第二个是我可以输入 wshlog（全部小写），VBE 会将其更改为 wshLog，我会得到我拼写正确的视觉提示。最后，我的代码更具可读性，例如 wshFinalReport 与 Sheets("Sheet1")。

# .net - 获得“价值 表中为 DBNull”错误 我正在开发 WCF 服务，在该服务中，我尝试将传递给该方法的数据表中的数据加载到本地数据库中的另一个数据表中（在这种情况下，“本地”数据库是 SQL Server 数据库在 Windows 2003 服务器上）。当我这样做时，我收到以下错误消息： “表 'ASIVocationalNeeds' 中列 'VocNeedDesc' 的值是 DBNull。” 这实际上是可以的，因为表 ASIL 问问题 问问题 2012-04-17T17:30:36.580 11037 次 This question shows research effort; it is useful and clear 5 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在开发 WCF 服务，在该服务中，我尝试将传递给该方法的数据表中的数据加载到本地数据库中的另一个数据表中（在这种情况下，“本地”数据库是 SQL Server 数据库在 Windows 2003 服务器上）。当我这样做时，我收到以下错误消息： “表 'ASIVocationalNeeds' 中列 'VocNeedDesc' 的值是 DBNull。” 这实际上是可以的，因为表 ASILocationalNeeds 中的列 VocNeedDesc 允许空值。最初我只是将 VocNeedDesc 的值从传递的表分配给本地表，但我得到了那个错误。所以接下来我更改了我的代码来检查 VocNeedDesc 的值是否为空，如果是，我将 string.Empty 分配给该值，否则我分配了传递的值，但我仍然收到错误消息。我很难过；不知道为什么我会收到此错误。这是相关的代码段： localEmploy.ASIVocationalNeeds.Rows.Add(clientNumber, caseNumber, 0, EmploymentDataSet.ASIVocationalNeeds[i].VocNeedType, (EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc == null ? string.Empty : EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc)); 您是否尝试过将其与DBNull.Value进行比较？ 代码可能看起来像 EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc == DBNull.Value ? string.Empty : EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc)); .netwcfvisual-studio-2008 4 2 回答 2 This answer is useful 7 DBNull 检查不适用于整列的单元格值 所以试试这个 EmploymentDataSet.ASIVocationalNeeds.Rows[i]["VocNeedDesc"] == DBNull.Value ? string.Empty : EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc)); 如果您使用的是 typeDatset ，则可以将空值检查为 ((ASIVocationalNeedsRow)EmploymentDataSet.ASIVocationalNeeds.Rows[i]).isVocNeedDescnull() ? string.Empty : EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc)); 于 2012-04-18T04:48:08.833 回答 This answer is useful 0 您是否尝试过将其与DBNull.Value进行比较？ 代码可能看起来像 EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc == DBNull.Value ? string.Empty : EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc)); 于 2012-04-17T17:41:00.470 回答 Related 1 css - 相对 DIV 中的 CSS 定位 1 ios - UITouch 在使用 MPMoviePlayerController 的视图后被阻止 2 string - Scala在字符串中查找字符串的位置 1 sql - sql 选择 3 列并对两列进行重复数据删除 1 wpf - 动态加载使用具有代码隐藏类型的 XAML 1 mongodb - MongoDB + C# 驱动程序 + 地理空间字段查询 - 如何在实体上定义位置属性 2 python - 创建表单时Django意外的关键字参数 1 sql-server - 为什么无论前面的 IF 语句的结果如何，插入语句总是会触发？ 1 javascript - 从 HIGHCHART 中删除零 3 android - android中的getStringArrayList（key）生成空结果 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10196092
> 
> 赞同：5
> 
> 时间：
> 
> 标签：.net, wcf, visual-studio-2008

我正在开发 WCF 服务，在该服务中，我尝试将传递给该方法的数据表中的数据加载到本地数据库中的另一个数据表中（在这种情况下，“本地”数据库是 SQL Server 数据库在 Windows 2003 服务器上）。当我这样做时，我收到以下错误消息：

“表 'ASIVocationalNeeds' 中列 'VocNeedDesc' 的值是 DBNull。”

这实际上是可以的，因为表 ASILocationalNeeds 中的列 VocNeedDesc 允许空值。最初我只是将 VocNeedDesc 的值从传递的表分配给本地表，但我得到了那个错误。所以接下来我更改了我的代码来检查 VocNeedDesc 的值是否为空，如果是，我将 string.Empty 分配给该值，否则我分配了传递的值，但我仍然收到错误消息。我很难过；不知道为什么我会收到此错误。这是相关的代码段：

```
localEmploy.ASIVocationalNeeds.Rows.Add(clientNumber,
    caseNumber,
    0,
    EmploymentDataSet.ASIVocationalNeeds[i].VocNeedType,
    (EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc == null ? string.Empty : EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc)); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T04:48:08.833

DBNull 检查不适用于整列的单元格值

所以试试这个

```
EmploymentDataSet.ASIVocationalNeeds.Rows[i]["VocNeedDesc"] == DBNull.Value ? string.Empty : EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc)); 
```

如果您使用的是 typeDatset ，则可以将空值检查为

```
((ASIVocationalNeedsRow)EmploymentDataSet.ASIVocationalNeeds.Rows[i]).isVocNeedDescnull() ? string.Empty : EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:41:00.470

您是否尝试过将其与[DBNull.Value](http://msdn.microsoft.com/en-us/library/system.dbnull.value.aspx)进行比较？

代码可能看起来像

```
EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc == DBNull.Value ? string.Empty : EmploymentDataSet.ASIVocationalNeeds[i].VocNeedDesc)); 
```

# python - 在屏蔽/隐藏底层 URL 时执行敏感的 Django 操作

> ID：10196100
> 
> 赞同：0
> 
> 时间：2012-04-17T17:31:23.667
> 
> 标签：python, django

我有一个简单的 Django 视图，它**确认**删除了一个实例。此页面上有一个简单的表单，其中包含“取消”和“删除”两个按钮。

*取消*按钮只是将用户返回到按下原始删除按钮的页面。

*Delete*按钮跳转到执行实际操作的第二个视图。因此，我的 URL 定义如下：

```
url(r'^confirmDeleteItem/(?P<item_key>\w+)$', 'confirm_delete_item'), # Confirms

url(r'^deleteItem/(?P<item_key>\w+)$', 'delete_item'), # Performs the action 
```

在确认页面上，表单是使用访问第二个 URL 的 POST 操作定义的：

```
<form action="/squash/deleteItem/{{ item.key }}/" method="POST">
...
</form> 
```

我遇到的问题是项目相当大（它们存储大量数据）并且敏感，所以我想强迫用户每次都跳过确认圈。

**我想阻止用户`/deleteItem/`手动访问该页面，或者只是隐藏浏览器对该页面的加载，以避免它被存储在历史记录中，意外添加书签等。**

将动作包装在 AJAX 调用中是解决此问题的最佳方法，还是有更多标准/首选解决方案？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:37:32.337

如何在confirmDeleteItem 视图中设置一个会话变量（即prepareToDelete = item.key）并在deleteItem 视图中检查该会话变量是否存在以及该值是否与item.key 匹配？然后你只需要在实际删除发生后将其删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T17:34:33.397

一个我不确定的快速想法，但应该适用于您的情况。

`deleteItem`在您的视图中检查您的推荐人。就像在[这段代码中](http://djangosnippets.org/snippets/1474/)一样。如果用户没有从`confirmDelete`视图中删除视图，请将他重定向到适当的`confirmDelete`视图。

# multithreading - 基于 UDP 套接字的无速率文件传输

> ID：10196103
> 
> 赞同：2
> 
> 时间：2012-04-17T17:31:34.303
> 
> 标签：multithreading, sockets, process, udp

我是套接字编程的新手，我需要实现一个基于 UDP 的无速率文件传输系统来验证我研究中的方案。这是我需要做的：

我希望服务器 S 向一组对等点 A、B、C 等发送文件。该文件分为多个数据包。一开始，peers 会向服务器发送一个 Request 消息来初始化传输。每当 S 收到来自客户端的请求时，它都会无速率地将编码数据包（如何编码由我的设计完成，编码本身具有纠删能力，这就是为什么我可以通过 UDP 无速率传输）到该客户端。客户端不断收集数据包并尝试对其进行解码。当它最终解码所有数据包并成功重建文件时，它会向服务器发送一个停止消息，并且 S 将停止向该客户端传输。

对等方异步请求文件（他们可能在不同时间请求文件）。服务器必须能够同时为多个对等点提供服务。不同客户端的编码数据包是不同的（尽管它们都是从相同的源数据包编码的）。

这是我对实施的看法。不过，我在 unix 网络编程方面没有太多经验，所以我想知道您是否可以帮助我评估它，看看它是否可行或有效。

1.  我要将服务器实现为具有两个套接字端口的并发 UDP 服务器（根据 UNP 书，类似于 TFTP）。一种是接收控制消息，就像在我的上下文中它用于请求和停止消息一样。服务器将为每个请求维护一个标志（最初=1）。当它收到来自客户端的停止消息时，该标志将被设置为 0。

2.  当服务接收到请求时，它将 fork() 一个新进程，该进程使用第二个套接字和端口将编码的数据包发送到客户端。只要标志为1，服务器就一直向客户端发送数据包。当它变为0时，发送结束。

3.  客户端程序很容易做到。只需发送一个请求，recvfrom() 服务器，逐步解码文件并在最后发送一个停止消息。

这种设计可行吗？我主要担心的是：（1）通过分叉多个进程是否有效？或者我应该使用线程？(2)、如果我必须使用多个进程，子进程如何知道标志位？感谢您的意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:43:09.797

Using UDB for file transfer is not best idea. There is no way for server or client to know if any packet has been lost so you would only know that during reconstruction assuming you have some mechanism (like counter) to detect lost packes. It would then be hard to request just one of those packets that got lost. And in the end you would have a code that would do what TCP sockets do. So I suggest to start with TCP.

Typical design of a server involves a listener thread that spawns a worker thread whenever there is a new client request. That new thread would handle communication with that particular client and then end. You should keep a limit of clients (threads) that are served simultaneously. Do not spawn a new process for each client - that is inefficient and not needed as this will get you nothing that you can't achieve with threads.

Thread programming requires carefulness so do not cut corners. Otherwise you will have hard time finding and diagnosing problems.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:00:58.580

使用 UDP 传输文件会很有趣 :(

每条消息的结构/类应该包含一个序列号和一个校验和。这应该使每个客户端能够在传输结束时检测并请求重新传输任何丢失的块。

UDP 可能成为大赢家的地方是在本地 LAN 上。您可以一次将整个文件通过 UDP 广播到所有客户端，然后在最后依次询问每个客户端它丢失了哪些块并仅发送这些块。我希望卡巴斯基等会使用这样的方案来更新我所有的本地盒子。

我在 CANBUS 网络上使用了这样的广播方案，其中有几十个微控制器需要下载新图像。软件升级需要几分钟而不是几小时。

# ruby-on-rails - 如何在 ruby on rails 中实现显示所有评论功能？

> ID：10196105
> 
> 赞同：2
> 
> 时间：2012-04-17T17:31:37.143
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我正在为用户评论实现显示/隐藏功能。

在这里讨论：[https ://stackoverflow.com/a/10174194/439688](https://stackoverflow.com/a/10174194/439688)

我的目标是： 1\. 将默认显示的评论限制为 2。 2\. 有一个文本跨度，说明该特定微博的总评论数，当用户点击它时，它会展开并显示该微博的所有评论。我会使用 Jquery/Ajax 来隐藏、显示、前置等。

第一个更改是限制向用户显示的评论数量，我通过在我的帮助程序中创建一个名为“comments”的方法来实现这一点，在这里我传入评论所属的微博的 ID。

```
 def get_comments(micropost_id)
       Comment.limit(2).order("created_at DESC").where(:micropost_id => micropost_id)
  end 
```

现在，遍历每条评论的每个循环将只显示 2 条最近的评论。

```
 <<% @microposts.each do |m| %>
    <% if m.poster_id.nil? %>
       <div class="postHolder">
        <nav class="micropostOptions">
         <ul class="postMenu">
           <li class="deletePost"><%= link_to content_tag(:span, "Delete post"), m, :method => :delete, :confirm => "Are you sure?", :title => m.content, :class => "message_delete", :remote => true %>
           </li>
           <li class="disableCommenting"><%= link_to content_tag(:span, "Pause commenting"), "2" %></li>
           <li class="blockCommenter"><%= link_to content_tag(:span, "Block commenter"), "3" %></li>
           <li class="openInNewWindow"><%= link_to content_tag(:span, "Open in new window"), "4" %></li>
           <li class="reportAbuse"><%= link_to content_tag(:span, "Report abuse"), "5" %></li>
         </ul>  
       </nav>

                <%= link_to image_tag(default_photo_for_current_user, :class => "poster_photo"), current_users_username %>

<div class="post_content">
    <div class="post_container">

        <div class="mainUserNameFontStyle"><%= link_to current_users_username.capitalize, current_users_username %> - <div class="post_time"> <%= time_ago_in_words(m.created_at) %> ago.</div> 
        </div>  
                  <%=  simple_format h(m.content) %> </div>
            <div class="commentsCount">
                <%= content_tag :span, pluralize(m.comments.count, 'comment'), :class => "view_all_comments" if m.comments.any? %>
            </div>
                        <% if m.comments.any? %>

                   <% comments(m.id).each do |comment| %>

                    <div class="comment_container">

                        <%= link_to image_tag(default_photo_for_commenter(comment), :class => "commenter_photo"), commenter(comment.user_id).username %>

                        <div class="commenter_content"> <div class="userNameFontStyle"><%= link_to commenter(comment.user_id).username.capitalize, commenter(comment.user_id).username %> - <%=  simple_format h(comment.content) %> </div>
                    </div><div class="comment_post_time"> <%= time_ago_in_words(comment.created_at) %> ago. </div>

                   </div>

                        <% end %>
                    <% end %>

                <% if logged_in? %>
                <%= form_for @comment, :remote => true do |f| %>
                <%= f.hidden_field :user_id, :value => current_user.id %>
                <%= f.hidden_field :micropost_id, :value => m.id %>
                <%= f.text_area :content, :placeholder => 'Post a comment...', :class => "comment_box", :rows => 0, :columns => 0 %>

        <div class="commentButtons">         
          <%= f.submit 'Post it', :class => "commentButton", :disable_with => "Post it" %>
           <div class="cancelButton"> Cancel </div>
        </div>   
                <% end %>

                <% end %>
    </div>

</div> 
```

从这里开始，这让我感到困惑。我使用 link_to 稍微进一步，但后来决定我不希望在浏览器状态栏中显示评论计数的 url。这就是我改用 span 的原因。但现在做我想做的事情并不容易，因为我现在不能使用 link_to/remote => true。

**我如何做到这一点，当用户单击评论计数跨度时，ajax 调用指向：**

```
 def load_comments

  @load_comments = Comment.where(:micropost_id => params[:id])   
    respond_to do |format|
    format.js   { render :load_comments } 
    end

  end 
```

我想过在 users.js 中添加一个 click 函数，但是如何将上面代码中每个循环中的微帖子的参数传递给 users.js？我不认为这是可能的。

我所有的评论发布都是通过 ajax 完成的，但是因为我使用了这些表单，所以我很容易添加 remote => true 并创建一些 js 模板并在 ajax 发布成功的情况下做一些事情。

不确定我是否会以正确的方式解决这个问题。我会感谢更有经验的 Rails 程序员的一些帮助/建议。

亲切的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:54:08.630

**导轨部分**

#显示所有基于本地传递给这个部分的评论

# 最初将限制传递为 2（或任何你想要的）。然后单击跨度通过限制为零。然后您可以检查限制是否为零，您可以在没有限制说明符的情况下查询模型。

```
<% @comments = Comment.custom_find(@your_params) %>
<% @comments.each do |comment|  %>
<%= comment.title %>
<% end %> 
```

**javascript/jquery**

```
function load_all_comments(id)
{
   new Ajax.Updater('show_comments',
      '<%=url_for(:controller => "your_controller", :action => "your_action")%>', {
       parameters: {'id':id },
       method:     'get',
       onSuccess: function(request){
       div_comments = document.getElementById("partial_comments_list");
       div_comments.innerHTML = request.responseText;

      }
   });
} // you can call this js function on span click. use jquery if you want. 
```

**控制器：**

然后在 your_controller 的 your_action 中，不要忘记渲染部分

```
 render :partial => "show_comments", :layout => false 
```

编辑：

```
you can even pass locals to your partial

 render :partial => "show_comments", :locals => {:post => @post} 
```

每次您的局部视图都会根据您通过的本地人更新时使用它。

当然，这只是一个示例，而不是完整的代码/解决方案。

可能有更好的方法。但这对我来说很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T17:44:51.520

另一种选择是仅输出所有评论并隐藏您不想首先显示的评论。`<div class="hidden_comments" style="display:none;"> a comment </div>`

然后在单击跨度时只显示一些 javascript 来显示它们？

```
<script type="text/javascript">
   $("#span_id").click(function() {
      $('.hidden_comments').show();
});
</script> 
```

如果您没有大量评论，这将非常有用。

* * *

如果你真的想按照自己的方式做，我以前做过，但它会变得混乱。

把它放在你的 application.js 中

```
$('.comment_span').live('click', function () {
    $.get(this.data_url, null, update_row, 'json');
    return false;
  }); 
```

您的跨度将如下所示：

```
<span class="comment_span" data_url="http://website.com/resource/more_comments">
  show all comments
</span> 
```

此示例以 json 格式返回数据，因此我使用 update_row 函数更新替换评论数据。

```
 function update_row(data, status) {
    $("#comments-table").append(data.html);
  }; 
```

这是我的控制器的样子：

```
 def more_comments
    @comments = Comments.all

    if @comments
      respond_to do |format|
        format.js {
                render :json => { 
                  :html => render_to_string(:partial => "comments"),
                  }.to_json
              }
      end
    end
  end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T01:31:54.830

您应该通过索引操作来执行此操作。将参数传递给它以确定您是要显示所有评论还是仅显示当前集（我将使用 will_paginate 来处理此问题。由于我现在在手机上，所以没有深入研究您的代码，但是有些像这样：

```
class CommentsController < ApplicationController
  def index
    If params[:show_all] == "true"
      @comments = Comment.all
    else
      @comments = Comment.where(foo: bar).paginate(per_page: 2, page: params[:page])
    end
  end 
```

然后你让它响应 JavaScript 并用你的 Ajax 请求发送页面参数

# ruby-on-rails - 复杂的虚拟属性创建/更新

> ID：10196108
> 
> 赞同：2
> 
> 时间：2012-04-17T17:31:45.640
> 
> 标签：ruby-on-rails, ruby

所以基本上，我的应用程序包含有朋友（单方面访问）和拥有列表的用户（模型用户）。

我在这里想要实现的是在创建一个新列表时，为它提供从用户的朋友中挑选的“访问器”。

我的代码深受以下关于虚拟属性的[railscast的启发。](http://railscasts.com/episodes/167-more-on-virtual-attributes)

所以，我的 User 和 UserAccessor 模型来了（只是相关部分）：

```
class User < ActiveRecord::Base
  has_many :lists, :dependent => :destroy
  has_many :friendships, :dependent => :destroy
  has_many :friends, :through => :friendships
end

class UserAccessor < ActiveRecord::Base
  belongs_to :accessor, :class_name => "User"
  belongs_to :accessible_list, :class_name => "List"
end 
```

我的列表模型：

```
class List < ActiveRecord::Base
  has_many :items
  belongs_to :user

  has_many :user_accessors, :foreign_key => "accessible_list_id", :dependent => :destroy
  has_many :accessors, :class_name => "User", :through => :user_accessors

  validates :title, :presence => true, :length => { :minimum => 1 }

  attr_writer :authorized_users
  after_save :add_accessors

  def authorized_users
    @authorized_users || self.accessors.map(&:username).join(' ')
  end

  private
    def add_accessors
      if @authorized_users
        accessors = @authorized_users.split(' ').map do |username|
          user = User.find_by_username(username)
          if user
            if self.user.inverse_friends.include? user
              self.user_accessors.build(:accessor_id => user.id).accessor
            end
          end
        end
      end
    end
end 
```

用于创建或更新列表的表单如下：

```
= simple_form_for [@user, @list] do |f|
  = f.input :title, :label => "Titre"
  = f.input :authorized_users, :label => "Authorized users", :hint => "Separated by spaces"
  %p
  = f.button :submit 
```

所以我的问题来自这样一个事实，即我不确切知道如何创建/更新访问器，我的代码`self.user_accessors.build(:accessor_id => user.id).accessor`肯定无法正确填充它。

我仍然是 Rails 的菜鸟（和一般的 ruby​​ ......），所以我希望我放在那里的内容足够相关，可以帮助我！提前致谢！

# apache - 在 C 以外的驱动器上设置 Apache 虚拟主机：

> ID：10196112
> 
> 赞同：1
> 
> 时间：2012-04-17T17:32:07.053
> 
> 标签：apache, wamp, virtual-hosts

我之前已经在我的 C: 驱动器上成功设置了虚拟主机，但现在我想在我的 D: 驱动器上设置一些。我按照[此处](http://kristengrote.com/blog/articles/how-to-set-up-virtual-hosts-using-wamp)的设置说明进行操作，但是当我单击 WAMP 图标重新启动所有服务时，该图标不会恢复为绿色。

有人知道我需要做什么才能让虚拟主机在我的 D: 驱动器上工作吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:34:04.770

`D:\`在你的内部使用`DocumentRoot`：

```
<VirtualHost *:80>   
  DocumentRoot "D:\Users\Kristen\Documents\Projects\My Site" 
  ServerName mysite.local
</VirtualHost> 
```

要找出 WAMP 无法重新启动的原因，请查看`error.log`Apache 文件夹内部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:01:22.810

信不信由你，看起来我所要做的就是在目录路径周围加上引号：

```
<Directory "D:\Path\To\My\Directory">
    Order Deny,Allow  
    Allow from all
</Directory> 
```

我不知道为什么这能解决这个问题，但我会接受的。

# c# - Silverlight：在网格周围添加边框

> ID：10196113
> 
> 赞同：1
> 
> 时间：2012-04-17T17:32:06.800
> 
> 标签：c#, silverlight, grid, border

我有一个需要放入边框的网格，通过 XAML 执行此操作很容易，但如何通过 C# 执行此操作？到目前为止我发现的所有东西都想在每个单元格周围添加边框。

我需要它以与 XAML 相同的方式出现，请帮助！

我无法在此处正确发布 XAML：

```
<Border Grid.Column="1" 
        Grid.Row="0" 
        Background="AliceBlue" 
        BorderBrush="Black" 
        BorderThickness="4" 
        x:Name="Side6" 
        Visibility="Collapsed">
    <UIElement.Projection>
        <PlaneProjection RotationY="-90" />
    </UIElement.Projection>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="100"></ColumnDefinition>
            <ColumnDefinition Width="100"></ColumnDefinition>
            <ColumnDefinition Width="100"></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="100"></RowDefinition>
            <RowDefinition Height="100"></RowDefinition>
            <RowDefinition Height="100"></RowDefinition>
        </Grid.RowDefinitions>
        <Button Grid.Column="2" Grid.Row="1" Click="RotateRight_Click">
            <Button.Content>
                <StackPanel>
                    <TextBlock HorizontalAlignment="Center">Rotate Right</TextBlock>
                    <TextBlock HorizontalAlignment="Center">To</TextBlock>
                    <TextBlock HorizontalAlignment="Center">Side 4</TextBlock>
                </StackPanel>
            </Button.Content>
        </Button>
        <Button Grid.Column="0" Grid.Row="1" Click="RotateLeft_Click">
            <Button.Content>
                <StackPanel>
                    <TextBlock HorizontalAlignment="Center">Rotate Left</TextBlock>
                    <TextBlock HorizontalAlignment="Center">To</TextBlock>
                    <TextBlock HorizontalAlignment="Center">Side 2</TextBlock>
                </StackPanel>
            </Button.Content>
        </Button>
        <TextBlock HorizontalAlignment="Center" 
                   VerticalAlignment="Center" 
                   Grid.Column="1" 
                   Grid.Row="1" 
                   Text="Side 6">
        </TextBlock>
    </Grid>
</Border> 
```

* * *

这是我正在使用的 C# 代码，也许你可以看到我做错了什么？

```
public static void panelMain(string strPassGridName, System.Windows.Media.Color mcPassColor, 
int intRowProperty, int intColumnProperty, Visibility vVisibility, 
string[] strButtonTitles, Grid passLayoutRoot, Canvas passCanvas)
    {
        Grid panelGrid = new Grid();

             panelGrid.Name = strPassGridName;
             panelGrid.Background = new SolidColorBrush(mcPassColor);

             panelGrid.SetValue(Grid.RowProperty, intRowProperty);
             panelGrid.SetValue(Grid.ColumnProperty, intColumnProperty);
             panelGrid.Visibility = vVisibility;

        RowDefinition row1 = new RowDefinition();
                      row1.Height = new GridLength(100, GridUnitType.Auto);
             panelGrid.RowDefinitions.Add(row1);

        ColumnDefinition column1 = new ColumnDefinition();
                         column1.Width = new GridLength(100);
             panelGrid.ColumnDefinitions.Add(column1);

        passLayoutRoot.Children.Add(panelGrid);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T13:59:43.643

我想通了，我需要先创建边框，然后将网格添加到边框。一个主要区别是我不能直接引用边框对象，我需要“找到它”

```
 Border findBorder = passLayoutRoot.FindName("bd" + strPassGridName) as Border;
   if (findBorder == null)
   { }
   else
   {
     findBorder.Child = panelGrid;
   } 
```

这工作得很好....感谢所有试图提供帮助的人

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T05:56:23.377

你可以这样做，如下所示，

```
 Border gridBorder = new Border();
        gridBorder.BorderBrush = new SolidColorBrush(Colors.Black);
        gridBorder.BorderThickness = new Thickness(4);
        gridBorder.Child = new Grid(); //Your grid here
        LayoutRoot.Children.Add(border); // ParentGrid(layout) holding the border 
```

# windows-phone-7 - Windows Phone 应用程序栏的图标颜色

> ID：10196118
> 
> 赞同：4
> 
> 时间：2012-04-17T17:32:31.950
> 
> 标签：windows-phone-7, windows-phone-7.1

appbar 图标的颜色究竟是什么时候改变的（即从白色变为黑色，或从黑色变为白色）？当主题从黑色切换到白色时，或者当应用程序栏的背景画笔改变时？如果我想应用我自己的自定义主题，让应用程序栏始终是白色的，我该怎么办？我使用黑色图标，但它们会在深色主题中变成白色，即使应用栏是白色的（因为它是自定义更改的）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-17T17:54:49.497

ApplicationBar 中使用的所有图标应为 48x48 PNG 文件，白色透明背景。

如果用户使用浅色主题，Windows Phone 将负责更改图标的颜色（因此图标将变为黑色）

您可以在此处阅读[图标](http://msdn.microsoft.com/en-us/library/ff431786%28v=vs.92%29.aspx)[的](http://msdn.microsoft.com/en-us/library/ff431806%28v=vs.92%29.aspx)规则，以及如何创建新图标！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-18T12:54:48.103

**XAML**

以下 XAML 展示了如何设置应用程序栏的前景色和背景色以及不透明度。

```
<phone:PhoneApplicationPage.ApplicationBar>
    <shell:ApplicationBar IsVisible="True" IsMenuEnabled="True" Opacity="0.75" ForegroundColor="Green" BackgroundColor="Cyan" >
        <shell:ApplicationBarIconButton IconUri="/Images/appbar_button1.png" Text="Button 1"/>
    <shell:ApplicationBarIconButton IconUri="/Images/appbar_button2.png" Text="Button 2"/>
    <shell:ApplicationBar.MenuItems>
        <shell:ApplicationBarMenuItem Text="MenuItem 1"/>
        <shell:ApplicationBarMenuItem Text="MenuItem 2"/>
    </shell:ApplicationBar.MenuItems>
    </shell:ApplicationBar>
</phone:PhoneApplicationPage.ApplicationBar> 
```

**C# 也一样**

```
ApplicationBar = new ApplicationBar();
    //Now set the AppBar properties :
ApplicationBar.Opacity = 0.75;
ApplicationBar.BackgroundColor = Color.FromArgb(120, 0,190,190);
ApplicationBar.ForeGroundColor = Color.FromArgb(120, 0,140, 43); 
```

# java - Java中原子执行一对操作的非阻塞策略

> ID：10196122
> 
> 赞同：2
> 
> 时间：2012-04-17T17:32:46.597
> 
> 标签：java, atomic, nonblocking

可以说我有一个`Set`和另一个`Queue`。我想检查`set`如果它，`contains(Element)`如果不是。我想原子地完成这两个步骤。`add(element)``queue`

一种明显的方法是使用`synchronized`块或`Lock.lock()/unlock()`方法。在线程争用下，这些将导致上下文切换。是否有任何简单的设计策略可以以非阻塞方式实现这一目标？可能正在使用一些原子结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:40:36.690

我不认为你可以依赖任何机制，除了你自己指出的那些，仅仅因为你在两个结构上运行。

*对一个*数据结构上的并发/原子操作有很好的支持（例如 ConcurrentHashMap 中的“如果不存在则放置”），但是对于一系列操作，您会被锁或同步块卡住。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:06:45.130

由于*争用案例*是相关案例，您应该查看“自旋锁”。他们不会放弃 CPU，而是在一个标志上旋转，期望标志很快就会被释放。

但是请注意，*真正的*自旋锁在 Java 中很少有用，因为正常`Lock`情况非常好。请参阅[此博客](http://mkseo.pe.kr/blog/?p=689)，其中有人第一次在 Java 中实现了自旋锁，结果发现经过一些更正（即在使测试正确之后）自旋锁与标准的东西相当。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T18:06:55.753

对于某些操作，您可以使用所谓的“安全序列”，其中并发操作可能会重叠而不会发生冲突。例如，您可能能够将成员添加到集合（理论上）而无需同步，因为同时添加相同成员的两个线程在概念上不会相互冲突。

但是查询一个对象然后有条件地对另一个对象进行操作是一个复杂得多的场景。 *如果*您的序列是查询集合，然后有条件地将成员插入集合并插入队列，则查询和第一次插入可以替换为同步而不会停止的“比较和交换”操作（可能在内存访问级别除外)，然后可以根据第一次操作的成功将成员插入队列，只需要同步队列插入本身。但是，此序列留下了另一个线程可能使插入失败并且仍然找不到队列中的成员的情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T19:01:45.760

您可以使用`java.util.concurrent.ConcurrentHashMap`来获得您想要的语义。他们有一个`putIfAbsent`原子插入。然后，您实际上尝试将一个元素添加到映射中，如果成功，您知道执行插入的线程是唯一拥有的线程，然后您可以安全地将项目放入队列中。这里的另一个重要点是 ConcurrentMap 上的操作确保了“先发生”语义。

```
ConcurrentMap<Element,Boolean> set = new ConcurrentHashMap<Element,Boolean>();
Queue<Element> queue = ...;

void maybeAddToQueue(Element e) {
    if (set.putIfAbsent(e, true) == null) {
        queue.offer(e);
    }
} 
```

请注意，地图的实际值类型（布尔值）在这里并不重要。

# c# - Listview 显示 ObservableSelection

> ID：10196127
> 
> 赞同：1
> 
> 时间：2012-04-17T17:33:36.537
> 
> 标签：c#, wpf, collections, wpf-controls, observablecollection

我有学生表、课程表和学生课程表。在我的 WPF 上，我正在使用组合框进行“学生”选择。如何使用 ObservableCollection 在列表视图中显示相应的课程及其属性（CourseID、CourseName、Credit）？这是我的组合框 SelectionChanged 事件的代码

```
 private void comboBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        int MySelect = (int)this.comboBox1.SelectedValue;
        var SelectedStudent = db.Students.Include("StudentCourses.Course").SingleOrDefault(f => f.StudentID == MySelect); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:43:48.350

If you're not already, I would highly recommend using a MVVM styled approach. Your ListView's ItemsSource should be bound to an ObservableCollection in your ViewModel and your ComboBox's SelectedItem should also be bound to a propety on your ViewModel. When the SelectedItem changes and calls the property's setter update the ObservableCollection that your ListView is bound to.

**Update:**

Here's a partially implemented solution:

XAML:

```
<DockPanel>
    <ComboBox ItemsSource="{Binding Students}" SelectedItem="{Binding SelectedComboItem}" DockPanel.Dock="Top">
        <ComboBox.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Name}"/>
            </DataTemplate>
        </ComboBox.ItemTemplate>
    </ComboBox>

    <ListView ItemsSource="{Binding StudentCourses}">
        <ListView.ItemTemplate>
            <DataTemplate>
                <StackPanel>
                    <TextBlock Text="{Binding Name, StringFormat={}Name: {0}}"/>
                    <TextBlock Text="{Binding Id, StringFormat={}Id: {0}}"/>
                    <TextBlock Text="{Binding Credit, StringFormat={}Credit: {0}}"/>
                </StackPanel>
            </DataTemplate>
        </ListView.ItemTemplate>
    </ListView>
</DockPanel> 
```

Code:

```
public class Student
{
    public string Name { get; set; }
    public List<string> CourseIds { get; set; }
} 

public class Course
{
    public string Name { get; set; }
    public string Id { get; set; }
    public int Credit { get; set; }
}

public class ViewModel : INotifyPropertyChanged
{
    public ObservableCollection<Course> StudentCourses { get; set; }
    public ObservableCollection<Student> Students { get; set; }

    public Student SelectedComboItem
    {
        get { return selectedComboItem_; }
        set {
            selectedComboItem_ = value;
            StudentCourses.Clear();
            foreach(Course course in courses_)
                if(selectedComboItem_.CourseIds.Contains(course.Id))
                    StudentCourses.Add(course);
            PropertyChanged(this, new PropertyChangedEventArgs("SelectedComboItem"))    ;
        }
    }

    private List<Course> courses_ = new List<Course>();
    private Student selectedComboItem_;

    ... // Read DB and build collections

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

# ruby-on-rails - Draper - NoMethodError 与 RSpec 测试装饰器

> ID：10196129
> 
> 赞同：3
> 
> 时间：2012-04-17T17:33:38.110
> 
> 标签：ruby-on-rails, rspec, draper

尝试使用[Draper](https://github.com/jcasimir/draper)进行测试时收到以下错误：

```
NoMethodError: undefined method 'with_unit' for nil:NilClass 
```

这是我的测试代码：

```
# spec/decorators/food_decorator_spec.rb
require 'spec_helper'

describe FoodDecorator do
  before { ApplicationController.new.set_current_view_context }
  FactoryGirl.create(:food)
  @food = FoodDecorator.first

  specify { @food.with_unit('water').should == "85.56 g" }
end 
```

这是我的装饰器代码：

```
class FoodDecorator < ApplicationDecorator
  decorates :food

  def with_unit(nutrient)
    model.send(nutrient.to_sym).to_s + " g"
  end
end 
```

我的研究表明，这条线`ApplicationController.new.set_current_view_context`应该可以解决这个问题，但事实并非如此。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:19:44.733

用。。。来代替：

```
require 'spec_helper'

describe FoodDecorator do
  before do
    ApplicationController.new.set_current_view_context
    FactoryGirl.create(:food)
    @food = FoodDecorator.first
  end

  specify { @food.with_unit('water').should == "85.56 g" }
end 
```

你甚至可以这样做：

```
require 'spec_helper'

describe FoodDecorator do

  let(:food) { Factory(:food) }
  subject { FoodDecorator.first }

  before do
    food
    ApplicationController.new.set_current_view_context
  end

  specify { subject.with_unit('water').should == "85.56 g" }
end 
```

# c++ - OpenGL更改/重新加载纹理

> ID：10196131
> 
> 赞同：0
> 
> 时间：2012-04-17T17:33:52.447
> 
> 标签：c++, qt, opengl

```
glDeleteTextures(total, &Item::texture[0]);
glGenTextures(total, &Item::texture[0]); 
```

迭代所有图像，总计；

```
glBindTexture( GL_TEXTURE_2D, Item::texture[i] );
glTexImage2D( GL_TEXTURE_2D, 0, GL_RGBA, t.width(), t.height(), 0, GL_RGBA, GL_UNSIGNED_BYTE, t.bits() );
glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST );
glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR ); 
```

尝试重新加载纹理，但它没有。纹理保持不变。有什么想法可以/应该如何处理？为了清楚起见，我正在尝试用新的纹理重新加载纹理，最好不要更改纹理的数量（因为可能会有很多变化）。

我正在使用 Qt，C++。上面的代码位于单独的 GLwidget 中的静态函数中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:03:35.407

当您进行这些调用时，您是否有可能绑定到错误的渲染上下文，或者根本没有渲染上下文？

# wpf - 使用 XAML 将元素显示在屏幕上 v. 打印的最佳方法是什么

> ID：10196133
> 
> 赞同：0
> 
> 时间：2012-04-17T17:33:57.970
> 
> 标签：wpf, xaml, printing

使用 CSS，您可以定位屏幕和打印。您将如何使用 WPF 执行此操作？

我想要在屏幕上显示的元素与打印时不同。

现在我正在破解同一元素的两个实例，并在代码中设置可见性，这感觉真的很不对。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T12:40:52.310

在这种情况下，请查看[此处](http://www.codeproject.com/Articles/18388/A-Guided-Tour-of-WPF-Part-5-Styles)、[此处](http://drwpf.com/blog/category/styles/)和[此处](http://windowsclient.net/learn/video.aspx?v=76368)。

# apache-flex - 无法连接 Flex-

> ID：10196135
> 
> 赞同：0
> 
> 时间：2012-04-17T17:34:01.777
> 
> 标签：apache-flex, flex3

我在 JBoss-5.1.0 上部署了一个 Java EE 应用程序。为了获得额外的安全性，我在 JBoss 前面设置了启用 Apache + 的 ssl。Tomcat 使用（端口 8001 上的 AJP 1.3）与服务器通信。所以我的配置看起来像：

```
tomcat:443 (ssl) ---|--- Jboss:8080 (IpAddress:8080) (http) 
```

这种配置似乎适用于除 flex 部分之外的所有静态和动态页面。当我尝试访问 flex 部分的任何内容时，我的问题就开始了。AMF 通道失败，我可以在服务器日志中看到以下堆栈跟踪：

> 2012-04-13 16:19:50,940 错误 [org.apache.catalina.core.ContainerBase.[jboss.web].[localhost].[/catissuecore].[MessageBrokerServlet]] (ajp-127.0.0.1-8009- 4) Servlet MessageBrokerServlet 的 Servlet.service() 抛出异常 flex.messaging.security.SecurityException：**必须通过安全协议联系安全端点“/messagebroker/amfsecure”。** 在 flex.messaging.endpoints.AbstractEndpoint.validateRequestProtocol(AbstractEndpoint.java:862) 在 flex.messaging.endpoints.AbstractEndpoint.service(AbstractEndpoint.java:630) 在 flex.messaging.endpoints.AMFEndpoint.service(AMFEndpoint.java:99 ) 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java: 290) 在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 在 org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96) 在 org.apache.catalina.core .ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) 在 org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:235) 在 org.apache.catalina.core.StandardContextValve 的 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) .invoke(StandardContextValve.java:191) at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:190) at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:92 ) 在 org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:70) 在 org.apache.catalina 的 org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.process(SecurityContextEstablishmentValve.java:126)。 core.StandardHostValve.invoke(StandardHostValve.java:127) 在 org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) 在 org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158) 在 org.apache.catalina .core.StandardEngineValve.invoke(StandardEngineValve.java:109) 在 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330) 在 org.apache.coyote.ajp.AjpProcessor.process(AjpProcessor.java:436 ) 在 org.apache.coyote.ajp.AjpProtocol$AjpConnectionHandler.process(AjpProtocol.java:384) 在 org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447) 在 java.lang。线程.run(线程.java:662)在 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330) 在 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330) 在 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 调用(CachedConnectionValve.java:158) .coyote.ajp.AjpProcessor.process(AjpProcessor.java:436) 在 org.apache.coyote.ajp.AjpProtocol$AjpConnectionHandler.process(AjpProtocol.java:384) 在 org.apache.tomcat.util.net.JIoEndpoint$Worker .run(JIoEndpoint.java:447) 在 java.lang.Thread.run(Thread.java:662)在 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330) 在 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330) 在 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 调用(CachedConnectionValve.java:158) .coyote.ajp.AjpProcessor.process(AjpProcessor.java:436) 在 org.apache.coyote.ajp.AjpProtocol$AjpConnectionHandler.process(AjpProtocol.java:384) 在 org.apache.tomcat.util.net.JIoEndpoint$Worker .run(JIoEndpoint.java:447) 在 java.lang.Thread.run(Thread.java:662)ajp.AjpProtocol$AjpConnectionHandler.process(AjpProtocol.java:384) at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447) at java.lang.Thread.run(Thread.java: 662)ajp.AjpProtocol$AjpConnectionHandler.process(AjpProtocol.java:384) at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447) at java.lang.Thread.run(Thread.java: 662)

我在 remote-config.xml 中定义了以下通道：

```
 <default-channels>
    <channel ref="my-amf"/>
     <channel ref="my-secure-amf"/>
 </default-channels> 
```

我的 services-config.xml 具有以下配置

```
 <channels>
    <channel-definition id="my-amf" class="mx.messaging.channels.AMFChannel">
        <endpoint uri="http://{server.name}:{server.port}/{context.root}/messagebroker/amf" class="flex.messaging.endpoints.AMFEndpoint"/>
        <properties>
            <polling-enabled>false</polling-enabled>
        </properties>
    </channel-definition>

    <channel-definition id="my-secure-amf" class="mx.messaging.channels.SecureAMFChannel">
        <endpoint uri="https://{server.name}:{server.port}/{context.root}/messagebroker/amfsecure" class="flex.messaging.endpoints.SecureAMFEndpoint"/>
        <properties>
            <!--HTTPS requests on some browsers do not work when pragma "no-cache" are set-->
            <add-no-cache-headers>false</add-no-cache-headers>
        </properties>
    </channel-definition> 
```

有没有人面临这个问题？

任何指针都会很有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:42:39.610

尽管解决方案在另一个答案中，但并不明显。如果 SSL 在负载均衡器或 Apache 中终止，则应按`secure-amf`如下方式切换通道定义类：

```
<channel-definition id="my-secure-amf" class="mx.messaging.channels.AMFChannel"> 
```

至

```
<channel-definition id="my-secure-amf" class="mx.messaging.channels.SecureAMFChannel"> 
```

来源：http: [//blogs.adobe.com/kmossman/2010/02/lcds_with_ssl_termination_with.html](http://blogs.adobe.com/kmossman/2010/02/lcds_with_ssl_termination_with.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T22:50:21.357

在我的情况下，我只允许 HTTPS 流量，并且所有这些 HTTPS 流量都被允许通过启用 ssl 的 Apache 服务器进行路由。我还有一个负载均衡器，它与 Apache 发送 HTTP 请求而不是 HTTPS 请求进行对话，这是问题的根本原因。我更改了负载均衡器的设置，它工作正常。

例外：必须通过安全协议联系安全端点“/messagebroker/amfsecure”。

1.  此异常本身表示您正在尝试通过不安全协议连接到 flex 客户端到安全端点。
2.  安全端点从客户端接收消息/请求并对其进行解码，然后将它们发送到 MessageBroker 以路由到服务。所以这里的请求没有加密，安全端点会抛出异常，因为在解码请求时假定是加密的。

有两种解决方案：

*   找出不安全请求被发送到安全端点的原因。并尝试解决此问题。为此，您可能需要监控所有发送和接收的请求。
*   打开 services-config.xml 文件并将 flex 安全通道的端点类名更改为“flex.messaging.endpoints.AMFEndpoint”。通过更改此设置，您将告诉 flex 客户端通过不安全的端点处理所有请求。如果您不关心您的配置并且只想运行应用程序，请执行此操作。

# c# - 更新 gridview 的特定单元格不起作用，更新未发生并且存在一些问题

> ID：10196137
> 
> 赞同：0
> 
> 时间：2012-04-17T17:34:03.863
> 
> 标签：c#, asp.net, sql

晚上好，有人让我帮她修复一些 asp.net 的代码，她向我展示了她的代码，但我找不到修复它的方法。所以我想知道是否有人会花时间帮我修复它。

正如她所说，她正在使用 asp.net (net f.4)。在一个页面上，她添加了一个 gridview 并使用 sqldatasource 将数据表中的信息绑定到 gridview 。

*   目的是，在 GridView row_updating 上，如果条件为真，则当前编辑行的某个单元格将使用新值更新。但是，这里是问题：

*   假设我在gridview上有两行！

*   如果我单击第一行的编辑按钮，然后按更新按钮，则没有任何反应。
*   但是，当我单击第二行的编辑按钮时，我可以看到第一行更新的单元格的更新值，如果单击更新或取消，我将看不到该值。
*   并且在数据表中，值不会更新。

有人可以帮我解决吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:51:30.757

那是因为您在执行 Update 语句后没有更新您的 gridview。您需要在 gridview 更新后调用 DataBind()

```
GridView1.DataSource = yourDataSource;
GridView1.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:55:26.513

您需要将 分配`ID`给该`DataKeyNames`属性，然后您可以获得如下值：

```
<asp:GridView ID="GridView1" runat="server" DataKeyNames="ID" ...> 
```

在代码隐藏中，您可以获得这样的 ID：

```
var ID = (int)GridView1.DataKeys[e.RowIndex]["ID"]; 
```

# ios - ios 保存在 plist 与保存 nsdata

> ID：10196142
> 
> 赞同：0
> 
> 时间：2012-04-17T17:34:37.610
> 
> 标签：ios, plist, nsdata

我正在尝试找出保存数据的最佳方法。

像这样将数据保存到 plist 是否重要

```
NSString *error;
NSString *rootPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *plistPath = [rootPath stringByAppendingPathComponent:@"yourFile.plist"];
NSData *plistData = [NSPropertyListSerialization dataFromPropertyList:rootObj
                                                               format:NSPropertyListXMLFormat_v1_0
                                                     errorDescription:&error];
if(plistData) {
  [plistData writeToFile:plistPath atomically:YES];
}
else {
  NSLog(@"Error : %@",error);
  [error release];
} 
```

或通过使用 NSData

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *filePath = [documentsDirectory stringByAppendingPathComponent:FILE_NAME];

[myArray writeToFile:filePath atomically:YES]; 
```

我正在处理小型 XML 文件（我将其解析为 NSDictionaries）和大型 MP4 视频。关于我应该使用这两种文件存储方法中的哪一种，有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:07:12.093

我会选择`[myArray writeToFile:filePath atomically:YES];`（快速，简单，更少的代码）但只有当您的`NSArray`或`NSDictionaries`仅包含非自我对象（仅包含`NSNumber`, `NSString`,`NSArray`等）时。

如果您使用`NSPropertyListSerialization`，您可能应该使用 option `NSPropertyListBinaryFormat_v1_0`。它速度更快，文件大小更小。

但是您还需要考虑解析 XML 然后将其存储到 XML Plist 中是否有意义。：） 是的。这很有意义，因为这样您就可以更轻松地处理它们。

您还可以考虑解析 XML 并将其存储在 CoreData 数据库中。然后它使查询更容易。

MP4 视频我也会存储在 NSDocumentDirectory 中。

# java - 如何为 BufferedReader 使用 JOptionPane 字符串？

> ID：10196143
> 
> 赞同：0
> 
> 时间：2012-04-17T17:34:43.280
> 
> 标签：java, bufferedreader, joptionpane, filenotfoundexception

我正在使用 a`JOptionPane`向用户询问文件，然后将其提供给`BufferedReader`. 但是，我的代码不断抛出`FileNotFoundException`. 有人可以帮我理解为什么。

这是我的代码...

```
edit = JOptionPane.showInputDialog("Enter a file to edit");
try { 
    BufferedReader fIn = new BufferedReader(new FileReader(edit));
    String in;
    try {
        while((in = fIn.readLine()) != null) {
            System.out.println(in);
        }
        fIn.close();
    }
    catch (IOException ex) {
        Logger.getLogger(WordProcessor.class.getName()).log(Level.SEVERE, null, ex);
    }

    try {
        fIn.close();
    }
    catch (IOException ex) {
        Logger.getLogger(WordProcessor.class.getName()).log(Level.SEVERE, null, ex);
    }

} 
catch (FileNotFoundException ex) {
    JOptionPane.showMessageDialog(null, "File does not exist");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:57:41.873

```
JOptionPane.showMessageDialog(null, "File does not exist"); 
```

在这里你应该做 ex.printStackTrace() 它将揭示确切的问题。请注意，程序的当前目录将是它启动的地方，因此任何相对路径都应该与源目录相关，而不是源目录。

# sql - SQL 在 SELECT 语句中包含重复项

> ID：10196144
> 
> 赞同：2
> 
> 时间：2012-04-17T17:34:50.120
> 
> 标签：sql

简要概述所以这是在上下文中，我有一个使用 SQL 作为应用程序中的数据库的应用程序用户必须选择 8 个国家作为问题的答案（这些国家可能会被多次选择，例如澳大利亚可能是他们的Q1 和 Q3 的答案）

然后将国家 ID 与他们的 user_id 一起保存到他们的答案表中

我正在尝试编写一个查询，该查询将获取他们选择作为答案的所有国家/地区名称，（然后我将在我的 java 应用程序中设置 8 个标签的文本，以便用户可以看到他们选择作为答案的 8 个国家/地区）

我对 SQL 连接等没有任何问题，我编写的查询确实提取了正确的信息，但是如果有人用相同的答案（国家）回答了多个问题，那么它只返回作为答案的国家名称（所以基本上我希望返回 8但是如果同一个国家被选择了两次，它只返回 7) 这个问题是不同的用户可能会在同一个国家回答不同的问题，所以我不能简单地使用返回的答案并使用返回的行之一中的值设置 2 个标签在查询中（我希望这是有道理的）

这是我的 SQL

```
SELECT C.C_NAME
FROM COUNTRY C INNER JOIN
TBL_ANSWERS T ON 
T.ANSWER1_ID = C.C_ID 
OR
T.ANSWER2_ID = C.C_ID 
OR
T.ANSWER3_ID = C.C_ID 
OR
T.ANSWER4_ID = C.C_ID 
OR
T.ANSWER5_ID = C.C_ID 
OR
T.ANSWER6_ID = C.C_ID 
OR
T.ANSWER7_ID = C.C_ID 
OR
T.ANSWER8_ID = C.C_ID
WHERE T.USER_ID = '4' 
```

我确定我可能错过了一些相当容易的事情，但任何帮助都会非常感激

也很抱歉，如果我的问题没有完全有意义，我很乐意回答您可能遇到的任何问题

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:10:09.230

看起来你只想要这样的东西：

```
SELECT C_NAME, AnswerNum
FROM
(
SELECT C.C_NAME, "1" AS AnswerNum, T.USER_ID
FROM COUNTRY C 
    JOIN TBL_ANSWERS T 
        ON  T.ANSWER1_ID = C.C_ID 
UNION ALL
SELECT C.C_NAME, "2" AS AnswerNum, T.USER_ID
FROM COUNTRY C 
    JOIN TBL_ANSWERS T 
        ON  T.ANSWER2_ID = C.C_ID 
...
UNION ALL
SELECT C.C_NAME, "8" AS AnswerNum, T.USER_ID
FROM COUNTRY C 
    JOIN TBL_ANSWERS T 
        ON  T.ANSWER8_ID = C.C_ID 
) AS AnswersJoined
WHERE USER_ID = '4' 
```

**但是**，我会认真考虑重新设计您的表格，以便您使用关系映射表来找出问题和答案。这将允许在一个查询中更轻松地创建它

就像是

**Tbl_Answer**

```
 Question_Id|User_Id|Response_Id 
```

**Tbl_Question**

```
 Id|QuestionNumber 
```

这将允许您只运行一个简单的`BETWEEN`. 像这样的东西：

```
SELECT C.Name
FROM Country C
WHERE EXISTS
(
    SELECT 1 
    FROM Tbl_Answer T
        JOIN Tbl_Question Q
            ON Q.Id = T.Question_Id
    WHERE T.User_Id = 4 AND T.Response_Id = C.C_ID
        AND Q.QuestionNumber BETWEEN 1 AND 8
) 
```

# delphi - 如何翻译 Firemonkey 的资源字符串？

> ID：10196149
> 
> 赞同：2
> 
> 时间：2012-04-17T17:35:13.473
> 
> 标签：delphi, delphi-xe2, firemonkey

我是 иrazilian，我需要我的语言中的 Firemonkey 的资源字符串，例如当我使用对话框时。我找不到翻译它的方法。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:59:03.867

翻译 FMX 表单是使用[TLang](http://docwiki.embarcadero.com/Libraries/en/FMX.Types.TLang)组件完成的，尽管这不适用于大多数对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:09:44.130

你需要的是这样的东西[，](http://delphi.about.com/od/objectpascalide/l/aa020502a.htm)但对于 FMX。在快速搜索中，我在[Delphi XE2 的帮助中](http://docwiki.embarcadero.com/Libraries/en/Unit_List)找到的唯一文件是`FMX.Consts`. 您获取该文件，翻译它，然后将翻译后的文件放入您的项目中。

当 Delphi 有更新时要小心。原始文件可以更改，您需要更新翻译。此外，您可能想要更改任何其他具有[Resource Strings](http://docwiki.embarcadero.com/RADStudio/en/Declared_Constants#Resource_Strings)并且正在由您的项目使用的文件。

最后，我不是这方面的专家，但如果你打算使用多语言，这可能不是更好的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-25T20:07:23.480

您可以使用 FMX.Consts.pas 更改对话框，但它会在编译期间修复语言。如果要在运行时检查主机操作系统的语言版本，则应更正 FMX.Platform.Android.pas 或 FMX.Platform.iOS.pas。

对于 Android，在 FMX.Platform.Android.pas 中，在过程 TPlatformAndroid.MessageDialog... 中找到 ButtonCaptions 并用您自己的函数包围它，例如：ZSTranslate(ButtonCaptions[B])。按以下方式声明 ZSTranslate：

```
function ZSTranslate(txt: String):String;
var
  LocaleSvc: IFMXLocaleService;
begin
  LocaleSvc :=  TPlatformServices.Current.GetPlatformService(IFMXLocaleService) as IFMXLocaleService;
 result:=txt;
 if LocaleSvc.GetCurrentLangID ='your_language_two_letter_id' then
 begin
   if txt= 'Yes' then
    result := 'yes in your language'
    else
     if txt= 'No' then
      result := 'no in your language'
    else
     if txt= 'Confirm' then
      result := 'confirm in your language'
        else
     if txt= 'Cancel' then
      result := 'cancel in your language';
 end
end; 
```

将 ZSTranslate 放置在 FMX.Platform.Android.pas 副本中 TPlatformAndroid.MessageDialog 上方的某个位置，并将此更正版本的 FMX.Platform.Android.pas 添加到您的项目中。

请注意，上面的示例非常简单，据我记得 Embarcadero 质量体系中有未解决的案例，建议在这里使用 translate 方法（所以 TLang 应该可以正常工作）。我没有尝试翻译，我的版本完成了这项工作（因为对话框中只有几个按钮标签，我只想要两种不同的语言）。

对于 iOS，您应该在 FMX.Platform.iOS.pas 中查找函数 TPlatformCocoaTouch.MessageDialog。请注意，有两个重载版本。iOS 中还有 MsgTitles 和 ButtonCaptions，作为 iOS 中的对话框显示标题。

PS。对于波兰语，我还必须更正 GetCurrentLangID 方法，因为它总是返回“en” - 请仔细检查您的语言的结果。对我有用的版本：在 FMX.Platform.iOS.pas 中：

```
function TPlatformCocoaTouch.GetCurrentLangID: string;
var
  lngs : NSArray;
  CurrentLocale: NSLocale;
  LanguageISO: NSString;
begin
  lngs := TNSLocale.OCClass.preferredLanguages;
  LanguageISO:= TNSString.Wrap(lngs.objectAtIndex(0));
  //CurrentLocale := TNSLocale.Wrap(TNSLocale.OCClass.currentLocale);
  //LanguageISO := TNSString.Wrap(CurrentLocale.objectForKey((NSLocaleLanguageCode as ILocalObject).GetObjectID));
  Result := UTF8ToString(LanguageISO.UTF8String);
  if Length(Result) > 2 then
    Delete(Result, 3, MaxInt);
end; 
```

在 FMX.Platform.Android.pas 中：

```
function TPlatformAndroid.GetCurrentLangID: string;
var
  Locale: JLocale;
begin
  Locale := TJLocale.JavaClass.getDefault;
  Result := JStringToString(Locale.getLanguage);//getISO3Language); //zs
  if Length(Result) > 2 then
    Delete(Result, 3, MaxInt);
end; 
```

# java - XStream 通过所需的构造函数反序列化对象

> ID：10196150
> 
> 赞同：2
> 
> 时间：2012-04-17T17:35:14.510
> 
> 标签：java, xstream

在 java 的 xstream 中，有没有办法通过确保对象通过带有参数的特定构造函数来反序列化对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:36:21.807

XStream（或一般的反序列化）不调用构造函数。（除了很少使用的纯 Java 模式，当它调用默认构造函数时。）

`readResolve()`如果要初始化瞬态字段，则需要使用该方法。

但是，您可以编写自己的转换器，然后您可以做任何您想做的事情。如果您有一个特定的类要应用此方法，则此方法效果最佳。

# c# - 在文本文件中搜索和删除

> ID：10196153
> 
> 赞同：-2
> 
> 时间：2012-04-17T17:35:37.500
> 
> 标签：c#, file-io

我需要开发一个电话簿。

我将联系人数据写入文本文件并使用控制台。我有哪些选项可以搜索和删除该文本文件中的联系人？

这就是我插入联系人的方式：

```
public class Writer
{
    public void  writer (string name,string lastname,string number)
    {
        StreamWriter Wrt = new StreamWriter("D:\\Sample.txt",true);
        Wrt.Write(name);
        Wrt.Write(lastname);
        Wrt.Write(number);
        Wrt.Write("#");
        Wrt.Write("");
        Wrt.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:25:17.233

每行对应一个联系人，对吧？您删除联系人的标准是什么？如果您正在寻找姓名和姓氏，您可以这样做。

```
string line = null; 
string Criteria = name + " " lastname;

using (StreamReader reader = new StreamReader("C:\\input"))
{ 
  using (StreamWriter writer = new StreamWriter("C:\\output"))
  { 
    while ((line = reader.ReadLine()) != null)
    { 
      if (line.Contains(Criteria)) 
        continue; 

      writer.WriteLine(line); 
    } 
  } 
} 
```

这将读取您的文件并将您想要保留在另一个文件中的所有联系人写入。

但是，如果您想保留同一个文件（或者如果您的联系人信息不止一行）。您可以读取整个文件并将其保存在内存中，删除不需要的文件，然后再次写入文件。

```
//Method with a class containing the info because informations are on several lines
Contact[] contacts = MethodToRead("filename.txt"); 
Contact[] filteredContacts = methodFilterContacts(contacts ); 
foreach(Contact c in filteredContacts)
{
     //Call your write method mentionned
     Writer.writer(c.name, c.lastname, c.number);
}

//Method if contact on only one line
string[] contactLines = File.ReadAllLines("filename.txt"); 
string[] filteredContactLines = methodFilterContacts(contactLines ); 
//This will write everything as is
File.WriteAllLines("filename.txt", filteredContactLines ); 
```

That was if you want to keep your text file. As it was suggested earlier, you can use xml to write and read an easier to maintain file. If you know the basics of xml, or up for a little challenge (and have time for it), it might be a better way to go.

# hibernate - Tomcat catalina.out 文件增长非常迅速！如何防止 Hibernate 的 INFO 和 DEBUG 语句被添加到 catalina.out 文件中？

> ID：10196154
> 
> 赞同：6
> 
> 时间：2012-04-17T17:35:40.247
> 
> 标签：hibernate, logging, tomcat5.5, catalina

我的 Java 应用程序（Spring、Hibernate、MySQL）在 Tomcat 5.5 中运行

在对我的应用程序进行最后一组更改之后，Tomcat 的 catalina.out 文件增长得非常快。对于每个查询，它都会向文件中添加几 MB 的 INFO 和 DEBUG 语句

日志文件有大量的 INFO 和 DEBUG 语句，如下所示：

```
01:52:45.412 [main] INFO  o.hibernate.cfg.annotations.Version - Hibernate Annotations 3.5.6-Final
01:52:45.465 [main] INFO  org.hibernate.cfg.Environment - Hibernate 3.5.6-Final
01:52:45.468 [main] INFO  org.hibernate.cfg.Environment - hibernate.properties not found
01:52:45.473 [main] INFO  org.hibernate.cfg.Environment - Bytecode provider name : javassist
01:52:45.479 [main] INFO  org.hibernate.cfg.Environment - using JDK 1.4 java.sql.Timestamp handling
01:52:45.629 [main] DEBUG o.h.i.f.DefaultIdentifierGeneratorFactory - Registering IdentifierGenerator strategy [uuid] -> [class org.hibernate.id.UUIDHexGenerator]
01:52:45.635 [main] DEBUG o.h.i.f.DefaultIdentifierGeneratorFactory - Registering IdentifierGenerator strategy [hilo] -> [class org.hibernate.id.TableHiLoGenerator]
01:52:45.636 [main] DEBUG o.h.i.f.DefaultIdentifierGeneratorFactory - Registering IdentifierGenerator strategy [assigned] -> [class org.hibernate.id.Assigned]
01:52:45.639 [main] DEBUG o.h.i.f.DefaultIdentifierGeneratorFactory - Registering IdentifierGenerator strategy [identity] -> [class org.hibernate.id.IdentityGenerator]
01:52:45.640 [main] DEBUG o.h.i.f.DefaultIdentifierGeneratorFactory - Registering IdentifierGenerator strategy [select] -> [class org.hibernate.id.SelectGenerator]

01:52:45.668 [main] INFO  o.h.annotations.common.Version - Hibernate Commons Annotations 3.2.0.Final
01:52:45.719 [main] DEBUG o.h.cfg.AnnotationConfiguration - Execute first pass mapping processing
01:52:45.780 [main] DEBUG o.h.cfg.AnnotationConfiguration - Process hbm files
01:52:45.780 [main] DEBUG o.h.cfg.AnnotationConfiguration - Process annotated classes
01:52:45.791 [main] INFO  org.hibernate.cfg.AnnotationBinder - Binding entity from annotated class: com.knownomy.scl.appcommon.domain.Language
01:52:45.805 [main] INFO  o.h.cfg.annotations.QueryBinder - Binding Named query: language.id => from Language language where language.id = ?
01:52:45.821 [main] DEBUG org.hibernate.cfg.Ejb3Column - Binding column: Ejb3DiscriminatorColumn{logicalColumnName'DTYPE', discriminatorTypeName='string'}
01:52:45.824 [main] DEBUG org.hibernate.cfg.AnnotationBinder - no value specified for 'javax.persistence.sharedCache.mode'; using UNSPECIFIED
01:52:45.843 [main] DEBUG o.h.cfg.annotations.EntityBinder - Import with entity name Language
01:52:45.849 [main] INFO  o.h.cfg.annotations.EntityBinder - Bind entity com.knownomy.scl.appcommon.domain.Language on table language

01:52:50.164 [main] DEBUG o.h.hql.ast.QueryTranslatorImpl - parse() - HQL: from com.knownomy.scl.quiz.domain.Question question where question.chapter.id=? and question.questionSource.id=? and question.mcq.questionText=?
01:52:50.177 [main] DEBUG org.hibernate.hql.ast.AST - --- HQL AST ---
 \-[QUERY] Node: 'query'
    +-[SELECT_FROM] Node: 'SELECT_FROM'
    |  \-[FROM] Node: 'from'
    |     \-[RANGE] Node: 'RANGE'
    |        +-[DOT] Node: '.'
    |        |  +-[DOT] Node: '.'
    |        |  |  +-[DOT] Node: '.'
    |        |  |  |  +-[DOT] Node: '.'
    |        |  |  |  |  +-[DOT] Node: '.'
    |        |  |  |  |  |  +-[IDENT] Node: 'com'
    |        |  |  |  |  |  \-[IDENT] Node: 'knownomy'
    |        |  |  |  |  \-[IDENT] Node: 'scl'
    |        |  |  |  \-[IDENT] Node: 'quiz'
    |        |  |  \-[IDENT] Node: 'domain'
    |        |  \-[IDENT] Node: 'Question'
    |        \-[ALIAS] Node: 'question'
    \-[WHERE] Node: 'where' 
```

log4j.properties 的内容：

```
log4j.rootLogger=INFO, stdout, R

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=[%5p] %d{yyyy-MM-dd HH:mm:ss} (%F:%M:%L) - %m%n

log4j.appender.R=org.apache.log4j.RollingFileAppender
log4j.appender.R.File=${catalina.home}/logs/SmartCloudLearningMobi.log
log4j.appender.R.MaxFileSize=10MB 
log4j.appender.R.MaxBackupIndex=10 
log4j.appender.R.layout=org.apache.log4j.PatternLayout
log4j.appender.R.layout.ConversionPattern=[%5p] %d{yyyy-MM-dd HH:mm:ss} (%F:%M:%L) - %m%n

log4j.logger.org.hibernate=ERROR, stdout, R
log4j.logger.org.hibernate.type=ERROR, stdout, R
log4j.logger.org.hibernate.SQL=ERROR, stdout, R
log4j.logger.org.hibernate.tool.hbm2ddl=ERROR, stdout, R
log4j.logger.org.hibernate.cache=ERROR, stdout, R
log4j.additivity.org.hibernate.SQL=false
log4j.logger.org.springframework=ERROR, stdout, R
log4j.logger.org.springframework.test.context.junit4.SpringJUnit4ClassRunner=ERROR, stdout, R 
```

application.properties 文件的内容：

```
#  Application Properties
path.webinf=webapps/SmartCloudLearningMobi/WEB-INF
# JDBC Connection information
jdbc.driverClassName=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/databasename?useUnicode=true&characterEncoding=UTF8
jdbc.username=root
jdbc.password=mypassword
###hibernate
hibernate.show_sql=false
hibernate.format_sql=true
hibernate.transaction.factory_class=org.hibernate.transaction.JDBCTransactionFactory
hibernate.dialect=org.hibernate.dialect.MySQLDialect
hibernate.c3p0.min_size=1
hibernate.c3p0.max_size=25
hibernate.c3p0.acquire_increment=5
hibernate.c3p0.timeout=1800
hibernate.c3p0.max_statements=50
hibernate.c3p0.idle_test_period=3600 
```

在最后一次更改中，我删除了以下 jar 文件：

```
ejb3-persistance.jar 
```

并添加了以下 jar 文件：

```
aspectjtools-1.5.4.jar
bval-core-0.3-incubating.jar
hibernate-validator-4.1.0.Final.jar
jackson-core-asl-1.6.4.jar
jackson-mapper-asl-1.6.4.jar
joda-time-1.6.2.jar
joda-time-jsptags-1.0.2.jar
jstl-1.2.jar
validation-api-1.0.0.GA.jar 
```

有人可以告诉我如何防止 Hibernate 的 INFO 和 DEBUG 语句被添加到 catalina.out 文件中吗？非常感激。

**更新：** 根据我在网上找到的内容，我将 log4j.properties 文件更新为以下内容：log4j.rootLogger=INFO, stdout, R

```
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=[%5p] %d{yyyy-MM-dd HH:mm:ss} (%F:%M:%L) - %m%n
#log4j.appender.stdout.layout.ConversionPattern=[%5p] %t %d{yyyy-MM-dd HH:mm:ss} (%F:%M:%L) - %m%n

log4j.appender.R=org.apache.log4j.RollingFileAppender
log4j.appender.R.File=${catalina.home}/logs/SmartCloudLearningMobi.log
log4j.appender.R.MaxFileSize=10MB 
log4j.appender.R.MaxBackupIndex=10 
log4j.appender.R.layout=org.apache.log4j.PatternLayout
log4j.appender.R.layout.ConversionPattern=[%5p] %d{yyyy-MM-dd HH:mm:ss} (%F:%M:%L) - %m%n
#log4j.appender.R.layout.ConversionPattern=[%5p] %t %d{yyyy-MM-dd HH:mm:ss} (%F:%M:%L) - %m%n

log4j.logger.org.hibernate=ERROR, stdout, R

### log HQL parse trees  
log4j.logger.org.hibernate.hql=ERROR, stdout, R

### Log HQL and SQL ASTs during query parsing ###  
log4j.logger.org.hibernate.hql.ast.AST=ERROR, stdout, R
log4j.additivity.org.hibernate.hql.ast.AST=false

### log just the SQL  
log4j.logger.org.hibernate.SQL=ERROR, stdout, R
log4j.additivity.org.hibernate.SQL=false

### log JDBC bind parameters. Very userfull, when debug parameterized queries ###  
log4j.logger.org.hibernate.type=ERROR, stdout, R
log4j.additivity.org.hibernate.type=false

### log schema export/update ###
log4j.logger.org.hibernate.tool.hbm2ddl=ERROR, stdout, R

### log cache activity ###
log4j.logger.org.hibernate.cache=ERROR, stdout, R

### log transaction activity  
log4j.logger.org.hibernate.transaction=ERROR, stdout, R

### Log all JDBC resource acquisition  
log4j.logger.org.hibernate.jdbc=ERROR, stdout, R

### enable the following line if you want to track down connection ###  
### leakages when using DriverManagerConnectionProvider ###  
log4j.logger.org.hibernate.connection.DriverManagerConnectionProvider=ERROR, stdout, R

log4j.logger.org.hibernate.cfg=ERROR, stdout, R

log4j.logger.org.springframework=ERROR, stdout, R
log4j.logger.org.springframework.test.context.junit4.SpringJUnit4ClassRunner=ERROR, stdout, R 
```

但这并没有什么区别！我仍然在 catalina.out 文件中看到相同的日志语句！我该如何解决这个问题？任何人？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-05-26T15:34:59.950

我遇到了同样的问题，这就是我能够通过以下步骤解决的问题：

1.  导航到director中的`conf`文件夹`tomcat`（我有tomcat设置的方式，位置是`/usr/local/tomcat/conf`。这对你来说可能会有所不同，具体取决于tomcat的安装方式）
2.  编辑`logging.properties`文件（将需要 root 访问权限：`vim sudo logging.properties`或使用 root 登录`sudo su -`，然后执行`vim logging.properties`）
3.  更改
    `.handlers = 1catalina.org.apache.juli.AsyncFileHandler, java.util.logging.ConsoleHandler`
    为
    `.handlers = 1catalina.org.apache.juli.AsyncFileHandler`
4.  保存并重新启动tomcat（`/usr/local/tomcat/bin/shutdown.sh`然后`/usr/local/tomcat/bin/startup.sh`）

我还注意到我的 tomcat 日志文件夹 ( `/usr/local/tomcat/logs`) 非常大。要检查日志文件夹的大小，请执行以下操作`du -hs /usr/local/tomcat/logs/`。为了解决这个问题，我设置了一个每天晚上清理文件的 cron，或者您可以手动运行这些命令。这是删除 5 天前的文件的 shell 脚本

```
#!/bin/sh
find /usr/local/tomcat/logs -name 'catalina.*.log' -mtime +5 -print0 | xargs -0 rm -f
find /usr/local/tomcat/logs -name 'localhost_access_log.*.txt' -mtime +5 -print0 | xargs -0 rm -f 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T21:34:24.257

最有可能发生的是它不是 Log4j 正在做日志记录。它可能是 Tomcat 的 JULI 记录器。你应该看看

[http://tomcat.apache.org/tomcat-5.5-doc/logging.html](http://tomcat.apache.org/tomcat-5.5-doc/logging.html)

并确保 log4j 设置正确（即它使用它而不是默认的日志系统）

# objective-c - Xcode 中的热代码交换？

> ID：10196155
> 
> 赞同：14
> 
> 时间：2012-04-17T17:35:57.267
> 
> 标签：objective-c, xcode, hotswap

我正在使用 cocos2d 框架进行 iOS 游戏开发，我非常羡慕 Eclipse Java 程序员在调试他们的应用程序时能够热交换他们的代码（即在一个方法中更改变量值并让程序实时更新，就好像你无需重新编译即可获得 REPL）。

这似乎对 iOS 开发非常有帮助，我的开发环境（显然）是 Xcode，而我正在使用的编程语言是 Objective C。我在谷歌上搜索过，但找不到任何东西 - 所以我想我会问社区。

有谁知道在Objective C中编程时是否有办法在Xcode中热交换代码？

提前致谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-09T13:57:33.510

有一个很棒的插件可以在实时、工作的 APP 中更改代码。它被称为**InjectionPlugin**。

正如常见问题解答所说：

> 它是如何工作的？Objective-C 运行时允许您使用 bundle 将新版本的类加载到应用程序中，即使已经有一个实现链接到应用程序。Swizzling 用于在加载包时切换现有类以使用新实现的方法。这可以重复完成，适用于 OSX 和 iOS 应用程序以及 iOS 设备。

我制作了一些小视频，展示了如何安装和使用这个插件 [http://nomtek.com/developers/how-to-install-and-use-injection-plugin-for-xcode/](http://nomtek.com/developers/how-to-install-and-use-injection-plugin-for-xcode/)

希望能帮助到你！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-17T17:48:56.243

用当前的工具是不可能的。

请记住，iOS 应用程序是已签名的——如果您更改单个字节，您将放弃整个事情。可以想象使用运行时对动态添加和删除方法的支持使其工作。但这肯定需要在设备上添加一些额外的东西来支持它，而这是恶意软件可以轻松利用的东西。因此，它可能不是您很快就会看到的功能。

顺便说一句，Xcode 版本 1.x-3.x 确实具有“修复并继续”功能。您可以在调试时进行编辑，使用“修复并继续”命令，然后继续运行更新的代码。我相信它在某个时候被删除了，可能是由于以下一些组合：要求您的项目配置为使用“零链接”，也许还有其他一些事情；不完全可靠；可能不支持 iOS；切换到 llvm；Xcode 4 中的其他更改。也许有一天它会回来——如果你想要它回来，请提交一个错误——但同样，我认为在 iOS 上支持它将是一个挑战。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-17T17:53:20.917

如果您只是在谈论更改变量值，那么您可以通过 lldb（或者，大概）gdb 偷偷地实现这一点。假设你有：

```
- (void)uselessMethod
{
    NSString *localString = @"I'm some local text";

    NSLog(@"%@", localString);
} 
```

并在 上放置一个断点`NSLog`，此时您可以要求 lldb 评估 localString 的重新分配作为执行它的一种方式。例如

```
po localString = @"Hat" 
```

如果您随后允许程序继续执行，您应该会发现重新分配已卡住。同样，您可以调用任何方法或执行任何其他类型的分配。

我刚刚针对 Xcode 4.3.2 进行了测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-27T04:51:33.087

您可以通过以下方式在 Xcode 中热交换变量值：

`expression <variable> = <value>;`.

通过在要更改值的位置设置断点并在 Xcode 控制台中执行命令。

例子：

```
// Messages From Console
(lldb) expression graphFlag = @"X";    // Update variable value
(__NSCFConstantString *) $0 = 0x36f95718 @"X"  // Xcode prints the updated value
(lldb) expression graphFlag; // Printing value through expression command
(__NSCFConstantString *) $1 = 0x36f95718 @"X" // Hot Swapped variable value 
```

# jquery - 按下按钮的缩小/放大比例效果？

> ID：10196166
> 
> 赞同：0
> 
> 时间：2012-04-17T17:36:43.543
> 
> 标签：jquery, jquery-ui, animation

更新：找到了解决方案，见下文。

我正在尝试让单击的磁贴 div 进行快速缩小/增长转换，因此用户有一些关于磁贴被单击的反馈。我发现使用 CSS3 动画很容易做到这一点，但想要一个 jQuery 替代品，以便它在 IE8/9 中工作。

jQueryUI effect('scale') 似乎是一个不错的选择。这看起来会更好，因为图块具有重要的文本内容，并且仅使用 animate() 作为宽度/高度/顶部/底部不会缩放该内容，而只是将其压缩在一起。

我有一个可以工作的示例，只是单击的图块在收缩和增长阶段之间跳转。寻找有关如何使瓷砖在没有小跳跃的情况下重新生长的建议。

这是我的工作示例（抱歉没有 jsFiddle——这似乎在那里不起作用）：

```
div 
{ 
    margin: 0px;  
    background: green; 
    border: 10px solid black; 
    color: white;

    width: 250px;
    height: 250px;

}

body 
{
    margin: 20px;
}

$(document).ready(function() {

$("div").click(function () {

    $(this).effect("scale", {percent: 90, origin: ['middle','center']}, 125, 
        function () {

            $(this).effect("scale", {percent: 111, origin: ['middle','center']}, 125);
          });
    });   
});

    <div><h1>hi</h1><p>blah</p></div> 
```

在 jQueryUI 内部，我猜测正在应用包装器 div 时正在发生一些事情，但这有点超出我的想象。有什么建议么？

这是我的 CSS3 效果的 jsFiddle，它显示了所需的外观：http: [//jsfiddle.net/dex3703/n2RJs/](http://jsfiddle.net/dex3703/n2RJs/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:47:56.817

除了动画比例，您还可以动画 div 的宽度和高度。

```
$(this).animate({

    "width": "-=10",
    "height": "+=10"

}, 200, function() {

    "width": "+=10",
    "height": "+=10"

}); 
```

我也有这个问题。这是它的外观演示：单击一个正方形：[我的站点](http://unblockvevo.com/metro)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T17:49:55.350

找到了一个解决方案——在 div 缩小后添加一个具有正确布局属性的类，然后将其放大。与 CSS 相比，它很难看，但对于快速按钮单击转换来说是可以接受的。奇怪的事情一定是进行了一些舍入，因为收缩的两倍并没有将其恢复到原始大小。如果您不仔细看，将其设置为 111% 就可以了。

建议或意见表示赞赏！

```
.inner
{ 
    position: absolute; 
    margin: 0px;  
    background: green; 
    border: 10px solid black; 
    color: white;

    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
}

.innerpostmove
{
    position: absolute; 
    top: 11px;
    bottom: 11px;
    left: 11px;
    right: 11px;

}

body { margin: 20px;}

.container 

{
    position: relative; 
    width: 250px; 
    height: 250px;
    background: purple;
}

    $(".inner").mousedown(function () {

      $(this).effect("scale", {percent: 90, origin: ['middle','center']}, 100, function () {

        var item = $(this).addClass("innerpostmove");

        setTimeout(function () {
            item.effect("scale", {percent: 111, origin: ['middle', 'center']}, 100);
        }, 100);

        setTimeout(function () {
            item.removeClass('innerpostmove');
        }, 200);

      });

    }); 

<div class="container">
    <div class="inner" ><h1>hi</h1><p>blah</p></div>
</div> 
```

# c++ - 随机引擎状态和多个确定性独立随机序列

> ID：10196169
> 
> 赞同：1
> 
> 时间：2012-04-17T17:36:55.613
> 
> 标签：c++, random, c++11, tr1

C++ TR1 随机数生成方案在为不同线程中的随机引擎或独立随机序列保持单独状态方面改进了旧的 C 运行时库。旧库有一个全局状态机，这通常很糟糕。

但是，在实现需要确定性随机序列的算法时，我发现必须将引擎传递给任何应该从这样的序列中提取数字的方法，这很烦人。从设计的角度来看，初始化随机种子的代码不需要知道堆栈中的哪些方法正在使用随机数。然而，那些内部方法无法初始化它们自己的随机引擎，因为：

1.  他们缺乏创造独特可复制种子的知识
2.  内存要求阻止为许多下游客户端保持单独的状态

需要澄清的是，下游方法不需要从与主要方法相同的序列中提取数字，但它们确实需要在不同的运行中独立且可重现。

关于如何优雅地解决这个难题的任何想法？

**编辑**

一些代码来澄清情况

```
typedef std::mt19937 RandEng;

class PossibleRandomConsumer;

class RandomProvider {
public:
    void foo() {
        std::uniform_int<> uni;
        uni(eng, 17); // using the random engine myself
        std::for_each(children.begin(), children.end(), [](PossibleRandomConsumer& child) { 
            // may or may not need a random number. if it does, it has to be different than from other children, and from other providers
            child.DoSomething(eng); 
        });
    }
private:
    RandEng eng; // unique seed per RandomProvider
    std::array<PossibleRandomConsumer,10000> children; // lots of these...
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:12:54.680

如果不了解您的架构的一些细节，这不是一个简单的问题。所以这只是一个尝试：
如何将引用传递给知道如何提供随机数的接口。这个接口可能只有一个函数，如果被要求返回一定数量的随机数。通过这种方式，您可以隐藏下游函数（方法）的实现细节，并且几乎免费传递常量引用。您甚至可以在顶层决定这些随机数的来源（文件、随机数生成器、您的室温……）。

```
class RandomNumberProvider {
    public:  
        typedef std::vector<int> RandomArray;  
        virtual RandomArray Generate(unsigned numNumbers) = 0;
};  

void Consumer(const RandomNumberProvider& rndProvider) {  
    RandomNumberProvider::RandomArray rndNumber;   
    rndNumber = rndProvider(10); // get a sequence of 10 random numbers  
    ...
} 
```

像这样的东西。

# google-maps - 通过 KML 将 URL 值传递给 Google Maps Marker

> ID：10196171
> 
> 赞同：0
> 
> 时间：2012-04-17T17:37:13.240
> 
> 标签：google-maps, google-maps-api-3, kml

我在代表特定国家的谷歌地图上有一个 KML 标记层。当用户单击标记时，我希望它将他们带到每个标记的特定 URL。我在这里看到了解释如何在创建标记时添加 onclick 事件的答案，但我需要从 KML 文件向每个标记添加单独的 onclick 事件，并从 KML 文件中为 onclick 事件传递 URL 值。

我将 URL 值存储在 KML 文件中，如下所示：http://example.com/countries/usa/

我发现我可以向 KML 层添加一个事件侦听器来响应特定标记，但是当我传递标记对象并将其记录到控制台时，它没有任何最初在 KML 文件中的信息.

```
google.maps.event.addListener(klmLayer, 'click', function(countryObject) {
  var marker = countryObject;
  console.log(marker);
}); 
```

有什么方法可以将 KML 文件中的值传递给 markerObject，这样我就可以在上面的 onclick 函数中使用它来将用户定向到特定的 URL？如果没有，我有什么选择？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:43:32.940

[https://developers.google.com/kml/documentation/kml_tut#network_links](https://developers.google.com/kml/documentation/kml_tut#network_links)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:22:48.327

geoXML3 有一种方法。[我首先在这里写了它。](https://stackoverflow.com/q/10058559/1238040)这个想法是在解析器读取 KML 文件时传递一个自定义函数。我写了一个[简单的例子](https://files.nyu.edu/hc742/public/googlemaps/stackkml.html)来读取[这个 KML 文件](https://files.nyu.edu/hc742/public/googlemaps/urls.kml)，URL 存储在 description 和 styleURL 标记中。最大的缺点是我不知道如何让 geoXML3 读取其他标签。将鼠标悬停在标记上以获取一组 URL，然后单击以获取另一组。

我面临的另一个障碍是意识到由于 Ajax，我需要将 html 和 KML 放在同一个服务器中。离线工作时它什么也没做。

# c# - 为什么 C# .NET WinForms 应用程序的控件在不同的机器上会以不同的方式显示？黑盒测试方法

> ID：10196172
> 
> 赞同：2
> 
> 时间：2012-04-17T17:37:17.323
> 
> 标签：c#, .net, winforms, user-interface, testing

我正在“黑盒”测试 C# .NET Windows 窗体应用程序（黑盒测试：无需源代码进行测试，也可能无需了解软件的开发模式）。我有两台 Win7 64 位机器，它们/应该/提供相同的测试环境（它们都安装了相同版本的 .NET、相同的软件版本、相同的网络等）。

我在其中一个应用程序表单上发现了错误/不一致。它总是在两台机器之一上发生（并且自从首次安装应用程序以来），但从未发生在另一台机器上。这是一个控件布局问题：几个文本框不合适（部分不在屏幕上）。应用程序的所有窗口都不能重新调整大小，并且两台机器具有相同的屏幕分辨率和显示方法。这个问题一直存在于它存在的机器上，我在两台机器上的测试方法（据我所知）是等效的。

虽然我很想知道有经验的 C# .NET WinForms 开发人员可能会首先考虑解决什么问题，但我更感兴趣的是如何从测试的角度以尽可能抽象的逻辑处理此类问题。什么样的假设对于在测试此类问题时取得有效进展可能是有效的？什么样的软件环境问题可能适合提出？有没有什么方法可以解决这些问题——在没有我的软件或环境的具体知识的情况下——增加找到为什么会发生这样的事情的可能性？

同样，这个问题是关于*测试*的，适当的答案*不会*包括“查看源代码”、“询问开发人员”等回复，因为在某些情况下，这种类型的黑盒测试可能是 /only/ 可用的方法测试某些软件。我无法提供有关该软件的任何屏幕截图或详细信息——仅提供一般描述，但请要求澄清，我会尽力提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:41:41.287

不应该认为它们实际上是完全相同的设置，但这里有一些事情需要考虑作为两者之间可能的差异。

*   航空设置
*   分辨率/DPI
*   默认字体大小/面（如果这些被主题更改，例如它们可以更改文本的宽度）
*   在两台机器上使用不同版本的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T03:28:16.083

查看 AutoScaleMode。应设置为无

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T20:11:10.660

我会仔细检查两台计算机上的所有个人设置是否相同：

*   图标大小
*   字体大小
*   解析度

当一台显示器是标准显示器而另一台显示器是宽屏格式时，我也遇到过这种情况。

# jquery - HTML 表格布局 - 将两列表格包装成四列

> ID：10196174
> 
> 赞同：0
> 
> 时间：2012-04-17T17:37:19.310
> 
> 标签：jquery, html-table

现在我有一个简单的两列表，其中有 z 行。我想设置一定数量的行来显示，比如十个，然后整个表自动换行，但我不知道是否可以这样做。

就像我提到的，它现在是简单的 html 代码，它看起来像：

```
**Word -- Count**
hello -- 1
world -- 16
hi -- 4
wirld -- 1 
```

我希望它这样做：

```
**Word -- Count**
hello -- 1        hi -- 4        etc....
world -- 16       wirld -- 1     etc.... 
```

关于通过 JavaScript 或 JQuery 完成这项工作的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:39:49.877

您可以将表格分成两个或三个或四个不同的表格，然后将它们全部浮动。如果宽度太窄，它们或多或少会移动到正确的位置。

最好使用 flexbox 模型 (http://www.the-haystack.com/2012/01/04/learn-you-a-flexbox/) 之类的东西来做到这一点，但不幸的是，这还没有真正准备好现在使用，有各种问题。

# c++ - 如何处理父 CDialog 上的控制消息？

> ID：10196177
> 
> 赞同：0
> 
> 时间：2012-04-17T17:37:23.533
> 
> 标签：c++, windows, mfc, window-messages

我有一些控制，比如`CtrlTree`on `CMyDialog`。我想处理`ON_WM_LBUTTONDOWN()`来自课堂`CTreeCtrl`的消息。`CMyDialog`

MFC 中有没有办法将消息流重定向到父级？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T20:09:59.040

重定向消息的最简单方法是`WM_USER + xxx`从控件的`ON_WM_LBUTTONDOWN`处理程序向父类发送自定义 ( ) 消息。

将 parent 的`WM_LBUTTONDOWN`处理程序代码放在单独的方法中，并直接调用此方法。

类似的东西（伪代码），假设您现有的代码位于`HandleTreeCtrlLBDown()`

```
CMyTreeCtrl::OnLButtonDown(..)
{
   pParent ->SendMessage(WM_TREECTRLLBDOWN, 0, (LPARAM)this);
}

CControlParentDialog::OnTreeCtrlLBDown(wParam, lParam)
{
   HandleTreeCtrlLBDown();
} 
```

# svn - SmartSVN 和 SVN 版本混淆

> ID：10196180
> 
> 赞同：2
> 
> 时间：2012-04-17T17:37:37.873
> 
> 标签：svn, smartsvn

我正在运行 SmartSVN 版本 6.6.11 并收到一条消息，说我尝试访问的项目是 Subversion 1.7 或更高版本的工作副本的一部分。它要求我升级，但我已经在运行 SVN 1.7 客户端！

我很茫然。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T19:20:52.927

SmartSVN 不使用外部 SVN 客户端。*SmartSVN 6.6*支持*SVN 1.6*工作副本格式。*SmartSVN 7*支持*SVN 1.7*工作副本格式。在撰写本文时，*SmartSVN 7*的候选版本可用：

[https://www.smartsvn.com/download/](https://www.smartsvn.com/download/)

# ruby-on-rails - Rails：处理几个类似的模型类？

> ID：10196181
> 
> 赞同：0
> 
> 时间：2012-04-17T17:37:41.193
> 
> 标签：ruby-on-rails, database-design

我正在构建一个课程应用系统。高中生、本科生和研究生都可以申请该课程。他们必须填写一些申请表。

但是，它们的信息形式相似，但并不完全相同。每个学生都有姓名、电话号码、电子邮件、地址等。但只有本科生必须提供他们的 GPA，研究生需要告诉他们在哪个实验室进行研究。还有其他细微的差别...

那么我应该如何处理呢？制作一张大表，但将高中生的“GPA”列留空？还是使用三个单独的表？

`Student`此外， （或者，在三个表的情况下`HighSchoolStudent`，`UndergraduateStudent`和`GraduateStudent`）与其他模型之间存在一些关系。例如，`Course`有很多`Student`s，`Student`有很多`Question`s，等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:16:10.717

您可以使用[STI](http://www.youtube.com/watch?v=F0KH_9ikZiA)和[Store](http://api.rubyonrails.org/classes/ActiveRecord/Store.html)功能的组合来实现此目的。

`Student`使用名为 的文本列声明基本模型`settings`。

```
class Student < ActiveRecord::Base
  store :settings
  # name, email, phone, address etc..
end

class HighSchoolStudent < Student
  # declare HighSchoolStudent specific attributes 
  store_accessor :settings, :gpa
end

class UndergraduateStudent < Student
  # declare UndergraduateStudent specific attributes 
  store_accessor :settings, :attr1
end

class GraduateStudent< Student
  # declare GraduateStudent specific attributes 
  store_accessor :settings, :attr2
end 
```

在上面的示例中， 的实例`HighSchoolStudent`将具有一个名为 的属性`gpa`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:01:13.637

您可以选择您认为的选项，例如将 GPA 保留为空，并为模型设置自定义验证，以便它仅根据学生类型进行检查。单表继承也是一种选择，您可以在其中指定要在数据库表的列中使用的不同类名，然后您只需将这些类添加到模型目录中。你可以在这里看到一些文档：http: [//api.rubyonrails.org/classes/ActiveRecord/Base.html](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)

我以前没有尝试过 STI，但鉴于你上面所说的，我可能会走这条路，分支我的代码，看看它是如何成功的。

# java-me - 如何在 J2ME lwuit 中为组合框项目设置文本换行属性

> ID：10196185
> 
> 赞同：0
> 
> 时间：2012-04-17T17:38:16.200
> 
> 标签：java-me, lwuit, word-wrap

我正在使用 lwit `ComboBox`。

我必须为项目设置带有 textwrapping 属性的多行`ComboBox`。如果项目的大小大于`ComboBox`宽度，则文本必须换行到下一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T09:37:38.513

我建议您参加`derive`该`ComboBox`课程并实施受保护的方法`createPopupList()`，您可以在其中将`TextArea`字段添加到`List`.

# java - 我怎样才能修复我把它们放在评论下的错误？

> ID：10196188
> 
> 赞同：-3
> 
> 时间：2012-04-17T17:38:40.713
> 
> 标签：java, inheritance, listiterator

我不明白为什么我在使用 listIterator 时会出错？我得到错误的**地方**是评论。

这是我的代码：

```
 /**
      Returns an iterator for iterating through this list.
      @return an iterator for iterating through this list
  */
   public ListIterator<String> listIterator()
   {  
      return new LinkedListIterator();
      // error here it says: Type safety: The expression of type 
      // LinkedList.LinkedListIterator needs unchecked conversion to conform
      // to ListIterator<String>
   }

   class Node
   {  
      public Object data;
      public Node next;
   }

   class LinkedListIterator implements ListIterator 
   /* here also it says:The type LinkedList.LinkedListIterator must implement
     the inherited abstract method ListIterator.previousIndex() when i implement 
     the listIterator it says:ListIterator is a raw type. References to generic
      type ListIterator<E> should be parameterized*/ 
```

我不知道如何解决它们，因此将采取任何帮助。谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:47:23.130

在你的第一种方法中

```
public ListIterator<String> listIterator()
   {  
      return new LinkedListIterator(); // error here it says: Type safety: The expression of type LinkedList.LinkedListIterator needs unchecked conversion to conform to ListIterator<String>
   } 
```

您的返回类型是通用 ListIterator，但您返回的是非通用 LinkedListIterator。作为响应，您只会收到警告它不是错误，您可以通过添加简单地删除它..

```
@SuppressWarnings("unchecked")
public ListIterator<String> listIterator()
   {  
      return new LinkedListIterator(); // error here it says: Type safety: The expression of type LinkedList.LinkedListIterator needs unchecked conversion to conform to ListIterator<String>
   } 
```

其次，当您添加未实现的方法时，您会收到另一个不是错误的警告。

```
class LinkedListIterator implements ListIterator 
```

ListIterator 不是通用的，您可以将其设为通用。即`ListIterator<String>`

并且您还可以通过通知编译器您知道让它保持原样来删除此警告

```
 @SuppressWarnings("rawtypes")
class LinkedListIterator implements ListIterator 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T17:42:51.610

You are getting this error

```
LinkedList.LinkedListIterator must implement the inherited abstract method ListIterator.previousIndex() 
```

because `LinkedListIterator` needs to implement ALL of the methods defined in the `ListIterator` class. Until you do that, your `LinkedListIterator` type doesn't actually exist.

# iphone - 多个 iOS 开发者帐户

> ID：10196191
> 
> 赞同：0
> 
> 时间：2012-04-17T17:38:55.747
> 
> 标签：iphone, app-store

如果我和另一个人想要发布应用程序，我们将不得不以某种方式创建一个联名帐户，我理解这一点。但是，如果将来我们要独立发布应用程序，那将需要我们每个人创建另一个开发者帐户，因此每年还要花费 99 美元。所以我的问题是：有什么方法可以让我们既拥有个人账户，又能以某种方式共同将联合申请发布到市场上？

所以本质上，有什么方法可以避免为我们的个人出版企业创建单独的帐户，而为发布**一个**应用程序创建一个联合帐户？

抱歉，我是 iPhone 开发的新手，所以我可能错过了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:47:03.777

您的开发者 ID 与您的 iOS 开发者计划订阅不同，您的 ID 可以是多个不同开发者计划订阅的成员。但是，如果您想在开发者计划订阅中拥有多个帐户，则必须以公司而不是个人的身份注册。如果您这样做，您可以将您的两个 ID 添加到共享程序订阅中。（但是，您实际上必须有一家公司才能注册。）

拥有三个独立的个人订阅可能是最简单、最便宜的方式。如果 99 美元真的是一个障碍，那么您可能一开始就没有那么认真地构建产品。相反，如果您构建了一个人们想要购买的可靠产品，那么 99 美元的订阅费应该不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:29:37.900

对于 iOS 标准开发人员注册，您可以在个人帐户和公司帐户之间进行选择。获得在您的两个名字下合法的帐户的唯一方法是在合法公司名称下注册并注册一个公司帐户（可能包括您的两个名字）。

# php - 如何使用 PHP 从 mySQL 中的表中选择某些字段

> ID：10196193
> 
> 赞同：2
> 
> 时间：2012-04-17T17:38:57.670
> 
> 标签：php, mysql, database-table

我现在正在尝试使用 php - 我对它很陌生！

我想知道您将如何从 mySQL 表中选择所有项目（使用 SELECT * FROM .... 查询）将所有数据放入数组中，然后不以表形式显示数据。相反，在网页的不同区域使用提取的数据。

例如：

我希望名称、出生日期和最喜欢的水果出现在一个已经有“SAINSBURYS”部分硬编码到页面中的区域。然后再往下，适用于“ASDA”的下一行出现在其下方。

我在这里和谷歌都搜索过，似乎找不到我奇怪问题的答案！这是否涉及多次运行查询，过滤掉我想要放置相关的 sainsbury 数据和 asda 数据

```
 echo $row['name']." ";
   echo $row['DOB']." "; etc etc 
```

旁边应该去哪里？

我有 php 将数据包含到数组中（我认为？！）

```
$query = "SELECT * FROM people"; 

$result = mysql_query($query) or die(mysql_error());

$row = mysql_fetch_array($result) or die(mysql_error());

while($row = mysql_fetch_assoc($result))
{
   echo $row['name']." ";
   echo $row['DOB']." ";
   echo $row['Fruit']." ";
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:47:56.670

只需放置此（或您尝试显示的任何内容）：

```
echo $row['name']." "; 
```

您希望信息出现的任何地方。如果需要，您可以将其放在 HTML 中，只需打开新的 php 标签。

```
<h1>This is a the name <?php echo $row['name']." ";?></h1> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T19:28:53.957

如果您想稍后在 while 循环之外访问您的数据，则必须将其存储在其他地方。

例如，您可以创建一个类 + 数组并将数据存储在其中。

```
class User {
    public $name, $DOB, $Fruit;
}

$users = new array();

$query = "SELECT * FROM people"; 
$result = mysql_query($query) or die(mysql_error());

while($row = mysql_fetch_array($result)) {
    $user = new User;
    $user->name = $row["name"];
    $user->DOB = $row["DOB"];
    $user->Fruit = $row["Fruit"];

    $users[$row["name"]] = $user;
} 
```

现在您可以通过这种方式访问​​用户数据：

$users["USERNAME"]->名字

$users["USERNAME"]->DOB

$users["USERNAME"]->水果

# php - 找不到php文件

> ID：10196195
> 
> 赞同：1
> 
> 时间：2012-04-17T17:39:08.710
> 
> 标签：php, html

我正在编写一个单位转换器 php 程序。我已经设置了页面，但似乎找不到我的 php 文件。当我单击提交按钮时，我会看到一个错误页面。这是我的 html 代码。

```
<html>
<head>
</head>
<body>
<form action="hw7.php" method="post">
<h2>Convert length:</h2>
<p>Select conversion direction: <br />
<input type="radio" name="dir" value="1" 

checked="checked"/> Feet to meters<br />
<input type="radio" name="dir" value="2" /> Meters to feet<br 

/>
</p>

<p>Value to be converted: <br /><input type="text" 

name="cvalue" /></p>
<p><input type="submit" value="Convert" /></p>

 </form>
</body>
</html> 
```

这是我的 php 文件

```
<?php

$fTOm = $_POST["cvalue"] * 3.2808;
$mTOf = $_POST["cvalue"] / 3.2808;

echo "Result: ";
if ($POST[ 'dir'] == "1") <?php echo "$_POST["cvalue"]; ?> feet = <?php echo "fTOm"; ?> meters;

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:42:13.747

您应该知道该`hw7.php`文件必须与`HTML`从表单调用它的页面位于同一目录中。

我会建议使用总是相对`URLs`的或`contexT_path`尽可能的。

尝试：

```
<form action="./hw7.php" method="post"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T17:48:23.480

试试这个也许会有所帮助：

`<form action="./hw7.php" method="post">`

还要删除 php 脚本中的所有这些语法错误。`<?php .... ... ?>`不能有另一个`<?php`里面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T17:49:47.897

由于编码不当，您的 PHP 脚本可能会导致服务器错误。检查您的服务器日志以查找与 PHP 相关的错误，并可能为 PHP 打开 error_reporting。

在您的 PHP 脚本中，您有以下声明：

```
if ($POST[ 'dir'] == "1") <?php echo "$_POST["cvalue"]; ?> feet = <?php echo "fTOm"; ?> meters; 
```

既然您已经在 PHP 脚本中，为什么要使用`<?php echo`inline an`if`语句？更正此问题并尝试通过直接调用来运行脚本。

将 if 行更改为：

```
if ($POST[ 'dir'] == "1") {
  echo $_POST["cvalue"] . "feet , " .  $fTOm . " meters";

} 
```

# python - 如何消除数独方块中的凸性缺陷？

> ID：10196198
> 
> 赞同：211
> 
> 时间：2012-04-17T17:39:18.617
> 
> 标签：python, opencv, computer-vision, sudoku

我正在做一个有趣的项目：使用 OpenCV（如 Google 护目镜等）从输入图像中求解数独。而且我已经完成了任务，但是最后我发现了一个小问题，所以我来到这里。

我使用 OpenCV 2.3.1 的 Python API 进行了编程。

以下是我所做的：

1.  阅读图片
2.  找到轮廓
3.  选择面积最大的那个，（也有点相当于正方形）。
4.  找到角点。

    例如下面给出：

    ![在此处输入图像描述](../Images/73bd97ff65349c020d5f895fbd8889d6.png)

    （**请注意，绿线与数独的真实边界正确重合，因此数独可以正确扭曲**。检查下一张图片）

5.  将图像扭曲为完美的正方形

    例如图像：

    ![在此处输入图像描述](../Images/0d2c944ad4926f05489e6afa01269142.png)

6.  执行 OCR（为此我使用了我[在 OpenCV-Python 中的简单数字识别 OCR 中](https://stackoverflow.com/questions/9413216/simple-digit-recognition-ocr-in-opencv-python)给出的方法）

而且这个方法效果很好。

**问题：**

看看[这张图片。](http://web.archive.org/web/20140601100441/http://davemark.com/images/sudoku.jpg)

在此图像上执行步骤 4 会产生以下结果：

![在此处输入图像描述](../Images/8d54f68af41776f05cd17e4a8e30e7ce.png)

绘制的红线是原始轮廓，是数独边界的真实轮廓。

绘制的绿线是近似轮廓，将是扭曲图像的轮廓。

当然，数独顶部边缘的绿线和红线是有区别的。所以在变形时，我没有得到数独的原始边界。

**我的问题 ：**

如何在数独的正确边界（即红线）上扭曲图像，或者如何消除红线和绿线之间的差异？OpenCV中有什么方法吗？

* * *

## 回答 #1

> 赞同：268
> 
> 时间：2012-04-19T11:22:54.750

我有一个可行的解决方案，但您必须自己将其翻译成 OpenCV。它是用 Mathematica 编写的。

第一步是调整图像的亮度，通过将每个像素与关闭操作的结果相除：

```
src = ColorConvert[Import["http://davemark.com/images/sudoku.jpg"], "Grayscale"];
white = Closing[src, DiskMatrix[5]];
srcAdjusted = Image[ImageData[src]/ImageData[white]] 
```

![在此处输入图像描述](../Images/4d9e7dac49c777606d3ddff29dad5ea4.png)

下一步是找到数独区域，这样我就可以忽略（屏蔽）背景。为此，我使用连通分量分析，并选择具有最大凸区域的分量：

```
components = 
  ComponentMeasurements[
    ColorNegate@Binarize[srcAdjusted], {"ConvexArea", "Mask"}][[All, 
    2]];
largestComponent = Image[SortBy[components, First][[-1, 2]]] 
```

![在此处输入图像描述](../Images/31604f30b5754d3f8e5efb49ebb281e9.png)

通过填充此图像，我得到了数独网格的掩码：

```
mask = FillingTransform[largestComponent] 
```

![在此处输入图像描述](../Images/ffbfea8d4ab9a44540af9060f61e4010.png)

现在，我可以使用二阶导数滤波器在两个单独的图像中找到垂直线和水平线：

```
lY = ImageMultiply[MorphologicalBinarize[GaussianFilter[srcAdjusted, 3, {2, 0}], {0.02, 0.05}], mask];
lX = ImageMultiply[MorphologicalBinarize[GaussianFilter[srcAdjusted, 3, {0, 2}], {0.02, 0.05}], mask]; 
```

![在此处输入图像描述](../Images/d89ac530d69909fff0a4217bb4e1886d.png)

我再次使用连通分量分析从这些图像中提取网格线。网格线比数字长得多，所以我可以使用卡尺长度来仅选择网格线连接的组件。按位置对它们进行排序，我得到图像中每个垂直/水平网格线的 2x10 蒙版图像：

```
verticalGridLineMasks = 
  SortBy[ComponentMeasurements[
      lX, {"CaliperLength", "Centroid", "Mask"}, # > 100 &][[All, 
      2]], #[[2, 1]] &][[All, 3]];
horizontalGridLineMasks = 
  SortBy[ComponentMeasurements[
      lY, {"CaliperLength", "Centroid", "Mask"}, # > 100 &][[All, 
      2]], #[[2, 2]] &][[All, 3]]; 
```

![在此处输入图像描述](../Images/0b623627328c82198ee4f7cba930d56e.png)

接下来，我取每一对垂直/水平网格线，将它们扩大，计算逐个像素的交点，并计算结果的中心。这些点是网格线的交点：

```
centerOfGravity[l_] := 
 ComponentMeasurements[Image[l], "Centroid"][[1, 2]]
gridCenters = 
  Table[centerOfGravity[
    ImageData[Dilation[Image[h], DiskMatrix[2]]]*
     ImageData[Dilation[Image[v], DiskMatrix[2]]]], {h, 
    horizontalGridLineMasks}, {v, verticalGridLineMasks}]; 
```

![在此处输入图像描述](../Images/c10ecdf7abd343e81f76e2972d8562c3.png)

最后一步是为通过这些点的 X/Y 映射定义两个插值函数，并使用这些函数变换图像：

```
fnX = ListInterpolation[gridCenters[[All, All, 1]]];
fnY = ListInterpolation[gridCenters[[All, All, 2]]];
transformed = 
 ImageTransformation[
  srcAdjusted, {fnX @@ Reverse[#], fnY @@ Reverse[#]} &, {9*50, 9*50},
   PlotRange -> {{1, 10}, {1, 10}}, DataRange -> Full] 
```

![在此处输入图像描述](../Images/e84e988c52adbde5c77df9649812b70c.png)

所有的操作都是基本的图像处理功能，所以这在 OpenCV 中应该也是可以的。基于样条的图像转换可能更难，但我认为你并不需要它。可能使用您现在在每个单独的单元格上使用的透视变换会产生足够好的结果。

* * *

## 回答 #2

> 赞同：223
> 
> 时间：2012-07-06T16:58:32.210

Nikie 的回答解决了我的问题，但他的回答是在 Mathematica 中。所以我想我应该在这里给它的 OpenCV 改编。但是在实现之后，我可以看到 OpenCV 代码比 nikie 的数学代码要大得多。而且，我找不到 nikie 在 OpenCV 中完成的插值方法（虽然它可以使用 scipy 完成，但到时候我会告诉它。）

**1.图像预处理（关闭操作）**

```
import cv2
import numpy as np

img = cv2.imread('dave.jpg')
img = cv2.GaussianBlur(img,(5,5),0)
gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)
mask = np.zeros((gray.shape),np.uint8)
kernel1 = cv2.getStructuringElement(cv2.MORPH_ELLIPSE,(11,11))

close = cv2.morphologyEx(gray,cv2.MORPH_CLOSE,kernel1)
div = np.float32(gray)/(close)
res = np.uint8(cv2.normalize(div,div,0,255,cv2.NORM_MINMAX))
res2 = cv2.cvtColor(res,cv2.COLOR_GRAY2BGR) 
```

结果 ：

![结案结果](../Images/dea4f0f756a03c24ec88e63712092d18.png)

**2\. 找到数独方块并创建蒙版图像**

```
thresh = cv2.adaptiveThreshold(res,255,0,1,19,2)
contour,hier = cv2.findContours(thresh,cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE)

max_area = 0
best_cnt = None
for cnt in contour:
    area = cv2.contourArea(cnt)
    if area > 1000:
        if area > max_area:
            max_area = area
            best_cnt = cnt

cv2.drawContours(mask,[best_cnt],0,255,-1)
cv2.drawContours(mask,[best_cnt],0,0,2)

res = cv2.bitwise_and(res,mask) 
```

结果 ：

![在此处输入图像描述](../Images/88f6943ad085860536185d88a148606b.png)

**3\. 寻找垂直线**

```
kernelx = cv2.getStructuringElement(cv2.MORPH_RECT,(2,10))

dx = cv2.Sobel(res,cv2.CV_16S,1,0)
dx = cv2.convertScaleAbs(dx)
cv2.normalize(dx,dx,0,255,cv2.NORM_MINMAX)
ret,close = cv2.threshold(dx,0,255,cv2.THRESH_BINARY+cv2.THRESH_OTSU)
close = cv2.morphologyEx(close,cv2.MORPH_DILATE,kernelx,iterations = 1)

contour, hier = cv2.findContours(close,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)
for cnt in contour:
    x,y,w,h = cv2.boundingRect(cnt)
    if h/w > 5:
        cv2.drawContours(close,[cnt],0,255,-1)
    else:
        cv2.drawContours(close,[cnt],0,0,-1)
close = cv2.morphologyEx(close,cv2.MORPH_CLOSE,None,iterations = 2)
closex = close.copy() 
```

结果 ：

![在此处输入图像描述](../Images/2056a38862208c8018bc7db8dd55a9da.png)

**4\. 寻找水平线**

```
kernely = cv2.getStructuringElement(cv2.MORPH_RECT,(10,2))
dy = cv2.Sobel(res,cv2.CV_16S,0,2)
dy = cv2.convertScaleAbs(dy)
cv2.normalize(dy,dy,0,255,cv2.NORM_MINMAX)
ret,close = cv2.threshold(dy,0,255,cv2.THRESH_BINARY+cv2.THRESH_OTSU)
close = cv2.morphologyEx(close,cv2.MORPH_DILATE,kernely)

contour, hier = cv2.findContours(close,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)
for cnt in contour:
    x,y,w,h = cv2.boundingRect(cnt)
    if w/h > 5:
        cv2.drawContours(close,[cnt],0,255,-1)
    else:
        cv2.drawContours(close,[cnt],0,0,-1)

close = cv2.morphologyEx(close,cv2.MORPH_DILATE,None,iterations = 2)
closey = close.copy() 
```

结果 ：

![在此处输入图像描述](../Images/ac54c4b5cdc2ec83e98922ff9a2e00ee.png)

当然，这个不太好。

**5\. 寻找网格点**

```
res = cv2.bitwise_and(closex,closey) 
```

结果 ：

![在此处输入图像描述](../Images/ad17e30c691e84d06c4e190174c4f404.png)

**6\. 纠正缺陷**

在这里，nikie 做了某种插值，对此我知之甚少。而且我找不到这个 OpenCV 的任何相应功能。（可能它在那里，我不知道）。

查看此 SOF，它解释了如何使用我不想使用的 SciPy 执行此操作：[OpenCV 中的图像转换](https://stackoverflow.com/questions/10364201/image-transformation-in-opencv)

所以，在这里我取了每个子正方形的 4 个角，并对每个角应用了扭曲透视。

为此，首先我们找到质心。

```
contour, hier = cv2.findContours(res,cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)
centroids = []
for cnt in contour:
    mom = cv2.moments(cnt)
    (x,y) = int(mom['m10']/mom['m00']), int(mom['m01']/mom['m00'])
    cv2.circle(img,(x,y),4,(0,255,0),-1)
    centroids.append((x,y)) 
```

但不会对生成的质心进行排序。查看下图以查看他们的订单：

![在此处输入图像描述](../Images/a86a08f1d8420d0492854f89cd4f27f7.png)

所以我们从左到右，从上到下对它们进行排序。

```
centroids = np.array(centroids,dtype = np.float32)
c = centroids.reshape((100,2))
c2 = c[np.argsort(c[:,1])]

b = np.vstack([c2[i*10:(i+1)*10][np.argsort(c2[i*10:(i+1)*10,0])] for i in xrange(10)])
bm = b.reshape((10,10,2)) 
```

现在看看他们的顺序：

![在此处输入图像描述](../Images/9c255350c396d960639441907f103708.png)

最后，我们应用转换并创建一个大小为 450x450 的新图像。

```
output = np.zeros((450,450,3),np.uint8)
for i,j in enumerate(b):
    ri = i/10
    ci = i%10
    if ci != 9 and ri!=9:
        src = bm[ri:ri+2, ci:ci+2 , :].reshape((4,2))
        dst = np.array( [ [ci*50,ri*50],[(ci+1)*50-1,ri*50],[ci*50,(ri+1)*50-1],[(ci+1)*50-1,(ri+1)*50-1] ], np.float32)
        retval = cv2.getPerspectiveTransform(src,dst)
        warp = cv2.warpPerspective(res2,retval,(450,450))
        output[ri*50:(ri+1)*50-1 , ci*50:(ci+1)*50-1] = warp[ri*50:(ri+1)*50-1 , ci*50:(ci+1)*50-1].copy() 
```

结果 ：

![在此处输入图像描述](../Images/3717952c41c235932c876064721ed935.png)

结果和nikie的差不多，但是码长很大。可能是，那里有更好的方法，但在那之前，这行得通。

问候方舟。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-18T06:54:09.950

您可以尝试使用某种基于网格的任意变形建模。既然数独已经是一个网格，那应该不会太难。

因此，您可以尝试检测每个 3x3 子区域的边界，然后单独扭曲每个区域。如果检测成功，它将为您提供更好的近似值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-27T08:20:31.073

我想补充一点，上述方法仅在数独板直立时才有效，否则高度/宽度（反之亦然）比率测试很可能会失败，您将无法检测到数独的边缘。（我还想补充一点，如果线条不垂直于图像边界，sobel 操作（dx 和 dy）仍然可以工作，因为线条相对于两个轴仍然具有边缘。）

为了能够检测直线，您应该进行轮廓或像素分析，例如轮廓区域/边界矩形区域、左上角和右下角点......

编辑：我设法通过应用线性回归并检查错误来检查一组轮廓是否形成一条线。然而，当直线的斜率太大（即 > 1000）或非常接近 0 时，线性回归表现不佳。因此，在线性回归之前应用上面的比率测试（在大多数赞成的答案中）是合乎逻辑的，并且对我有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-01-09T13:01:50.767

为了去除未检测到的角落，我应用了伽马值 0.8 的伽马校正。

[![伽玛校正前](../Images/ff4773076061fd34fe3f92e10a50d1cc.png)](https://i.stack.imgur.com/7KDwW.png)

绘制红色圆圈以显示缺失的角落。

[![伽玛校正后](../Images/0e5679f7811d644345eaef4fa6a006ed.png)](https://i.stack.imgur.com/YvtbM.png)

代码是：

```
gamma = 0.8
invGamma = 1/gamma
table = np.array([((i / 255.0) ** invGamma) * 255
                  for i in np.arange(0, 256)]).astype("uint8")
cv2.LUT(img, table, img) 
```

如果缺少某些角点，这是对 Abid Rahman 的回答的补充。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-26T19:46:23.493

我认为这是一篇很棒的帖子，也是 ARK 的一个很好的解决方案；很好的布局和解释。

我正在研究一个类似的问题，并构建了整个东西。有一些变化（即 xrange 到范围，cv2.findContours 中的参数），但这应该可以开箱即用（Python 3.5，Anaconda）。

这是上面元素的汇编，添加了一些缺失的代码（即点的​​标签）。

```
'''

https://stackoverflow.com/questions/10196198/how-to-remove-convexity-defects-in-a-sudoku-square

'''

import cv2
import numpy as np

img = cv2.imread('test.png')

winname="raw image"
cv2.namedWindow(winname)
cv2.imshow(winname, img)
cv2.moveWindow(winname, 100,100)

img = cv2.GaussianBlur(img,(5,5),0)

winname="blurred"
cv2.namedWindow(winname)
cv2.imshow(winname, img)
cv2.moveWindow(winname, 100,150)

gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)
mask = np.zeros((gray.shape),np.uint8)
kernel1 = cv2.getStructuringElement(cv2.MORPH_ELLIPSE,(11,11))

winname="gray"
cv2.namedWindow(winname)
cv2.imshow(winname, gray)
cv2.moveWindow(winname, 100,200)

close = cv2.morphologyEx(gray,cv2.MORPH_CLOSE,kernel1)
div = np.float32(gray)/(close)
res = np.uint8(cv2.normalize(div,div,0,255,cv2.NORM_MINMAX))
res2 = cv2.cvtColor(res,cv2.COLOR_GRAY2BGR)

winname="res2"
cv2.namedWindow(winname)
cv2.imshow(winname, res2)
cv2.moveWindow(winname, 100,250)

 #find elements
thresh = cv2.adaptiveThreshold(res,255,0,1,19,2)
img_c, contour,hier = cv2.findContours(thresh,cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE)

max_area = 0
best_cnt = None
for cnt in contour:
    area = cv2.contourArea(cnt)
    if area > 1000:
        if area > max_area:
            max_area = area
            best_cnt = cnt

cv2.drawContours(mask,[best_cnt],0,255,-1)
cv2.drawContours(mask,[best_cnt],0,0,2)

res = cv2.bitwise_and(res,mask)

winname="puzzle only"
cv2.namedWindow(winname)
cv2.imshow(winname, res)
cv2.moveWindow(winname, 100,300)

# vertical lines
kernelx = cv2.getStructuringElement(cv2.MORPH_RECT,(2,10))

dx = cv2.Sobel(res,cv2.CV_16S,1,0)
dx = cv2.convertScaleAbs(dx)
cv2.normalize(dx,dx,0,255,cv2.NORM_MINMAX)
ret,close = cv2.threshold(dx,0,255,cv2.THRESH_BINARY+cv2.THRESH_OTSU)
close = cv2.morphologyEx(close,cv2.MORPH_DILATE,kernelx,iterations = 1)

img_d, contour, hier = cv2.findContours(close,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)
for cnt in contour:
    x,y,w,h = cv2.boundingRect(cnt)
    if h/w > 5:
        cv2.drawContours(close,[cnt],0,255,-1)
    else:
        cv2.drawContours(close,[cnt],0,0,-1)
close = cv2.morphologyEx(close,cv2.MORPH_CLOSE,None,iterations = 2)
closex = close.copy()

winname="vertical lines"
cv2.namedWindow(winname)
cv2.imshow(winname, img_d)
cv2.moveWindow(winname, 100,350)

# find horizontal lines
kernely = cv2.getStructuringElement(cv2.MORPH_RECT,(10,2))
dy = cv2.Sobel(res,cv2.CV_16S,0,2)
dy = cv2.convertScaleAbs(dy)
cv2.normalize(dy,dy,0,255,cv2.NORM_MINMAX)
ret,close = cv2.threshold(dy,0,255,cv2.THRESH_BINARY+cv2.THRESH_OTSU)
close = cv2.morphologyEx(close,cv2.MORPH_DILATE,kernely)

img_e, contour, hier = cv2.findContours(close,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)

for cnt in contour:
    x,y,w,h = cv2.boundingRect(cnt)
    if w/h > 5:
        cv2.drawContours(close,[cnt],0,255,-1)
    else:
        cv2.drawContours(close,[cnt],0,0,-1)

close = cv2.morphologyEx(close,cv2.MORPH_DILATE,None,iterations = 2)
closey = close.copy()

winname="horizontal lines"
cv2.namedWindow(winname)
cv2.imshow(winname, img_e)
cv2.moveWindow(winname, 100,400)

# intersection of these two gives dots
res = cv2.bitwise_and(closex,closey)

winname="intersections"
cv2.namedWindow(winname)
cv2.imshow(winname, res)
cv2.moveWindow(winname, 100,450)

# text blue
textcolor=(0,255,0)
# points green
pointcolor=(255,0,0)

# find centroids and sort
img_f, contour, hier = cv2.findContours(res,cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)
centroids = []
for cnt in contour:
    mom = cv2.moments(cnt)
    (x,y) = int(mom['m10']/mom['m00']), int(mom['m01']/mom['m00'])
    cv2.circle(img,(x,y),4,(0,255,0),-1)
    centroids.append((x,y))

# sorting
centroids = np.array(centroids,dtype = np.float32)
c = centroids.reshape((100,2))
c2 = c[np.argsort(c[:,1])]

b = np.vstack([c2[i*10:(i+1)*10][np.argsort(c2[i*10:(i+1)*10,0])] for i in range(10)])
bm = b.reshape((10,10,2))

# make copy
labeled_in_order=res2.copy()

for index, pt in enumerate(b):
    cv2.putText(labeled_in_order,str(index),tuple(pt),cv2.FONT_HERSHEY_DUPLEX, 0.75, textcolor)
    cv2.circle(labeled_in_order, tuple(pt), 5, pointcolor)

winname="labeled in order"
cv2.namedWindow(winname)
cv2.imshow(winname, labeled_in_order)
cv2.moveWindow(winname, 100,500)

# create final

output = np.zeros((450,450,3),np.uint8)
for i,j in enumerate(b):
    ri = int(i/10) # row index
    ci = i%10 # column index
    if ci != 9 and ri!=9:
        src = bm[ri:ri+2, ci:ci+2 , :].reshape((4,2))
        dst = np.array( [ [ci*50,ri*50],[(ci+1)*50-1,ri*50],[ci*50,(ri+1)*50-1],[(ci+1)*50-1,(ri+1)*50-1] ], np.float32)
        retval = cv2.getPerspectiveTransform(src,dst)
        warp = cv2.warpPerspective(res2,retval,(450,450))
        output[ri*50:(ri+1)*50-1 , ci*50:(ci+1)*50-1] = warp[ri*50:(ri+1)*50-1 , ci*50:(ci+1)*50-1].copy()

winname="final"
cv2.namedWindow(winname)
cv2.imshow(winname, output)
cv2.moveWindow(winname, 600,100)

cv2.waitKey(0)
cv2.destroyAllWindows() 
```

# css - CSS部分自动调整高度？

> ID：10196206
> 
> 赞同：2
> 
> 时间：2012-04-17T17:40:24.840
> 
> 标签：css, html

我有一个包含其他两个部分的 HTML 部分“全部”。我无法让网站根据我放入其他两个部分的内容的长度来调整“全部”部分的高度。

```
<section id="all">
   <section id="left_content">
      <p>Something here.</p>            
   </section>
   <section id="right_content">
      <p>Something here.</p>
   </section>
</section> 
```

我目前将高度设置为 700 像素的固定大小。我想知道是否有可能在 CSS 中使该部分的高度与 left_content 和 right_content 部分的大小相关。

```
#all {
    width: 900px;
    height: 700px;
    margin: 0 auto;
    padding-top: 20px;
    background: #F4F4F4;
}

#left_content {
    float: left;
    width: 570px;
    margin-top:-20px;
    padding: 0px 20px 10px 20px;
    line-height: 25px;
    font-size: 12px;
}

#right_content {
    border-left:4px solid #cccccc;
    float: right;
    width: 250px;
    padding: 0px 10px 20px 20px;
    line-height: 20px;
    font-size: 12px;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T17:45:11.293

*   不要给出`#all`高度
*   清除你的花车

当子项浮动时，您的包装器无法确定高度。您需要一个“结束”浮动的元素。`<div style='clear:both'></div>`是清除浮动的常用方法。[Clearfix](http://www.webtoolkit.info/css-clearfix.html)是另一种技术。

阅读更多：[http ://css-tricks.com/all-about-floats/](http://css-tricks.com/all-about-floats/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T17:52:58.837

删除 #all 的高度声明（如 Diodeus 所说）。然后，您需要在两个内容 div 下方应用一个清除元素（如页脚），或对 div #all 应用一个 clearfix。

例如：

```
/* For modern browsers */
#all:before,
#all:after {
    content:"";
    display:table;
}

#all:after {
    clear:both;
}

/* For IE 6/7 (trigger hasLayout) */
#all {
    zoom:1;
} 
```

这是[Nicolas Gallagher 出色的 micro clearfix](http://nicolasgallagher.com/micro-clearfix-hack/)的直接复制和粘贴。

# mysql - 如何将数据库从 wamp 连接到工作台

> ID：10196210
> 
> 赞同：1
> 
> 时间：2012-04-17T17:40:34.373
> 
> 标签：mysql, wamp, mysql-workbench

我正在尝试从 MySQL Workbench 中的 WAMP 读取表。我搜索了一下并尝试了它们，但没有任何效果。有人知道该怎么做吗？谢谢提前

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T19:10:11.580

这里有一个很好的手册：http: [//dev.mysql.com/doc/workbench/en/index.html](http://dev.mysql.com/doc/workbench/en/index.html)。

我建议你通过它。很好解释。

# actionscript-3 - 将 Adob e Air 打包到 Exe

> ID：10196216
> 
> 赞同：3
> 
> 时间：2012-04-17T17:41:13.500
> 
> 标签：actionscript-3, flash, actionscript, air, adt

使用 Flash Builder 4.6，我从我的移动项目中导出了一个 Adob​​e Air 文件。

我正在尝试将其打包成 EXE（包括 Adob​​e Air Runtime）

该项目使用 Air 3.1 编译。我在网上查看了一些人们推荐使用的 ADT 命令，但问题是该命令在 Air 3.1 中引发错误

如果我使用空气 3.0 ADT：

```
AIR file at [app path]/app.air could not be converted.
The error was "" 
```

如果我使用 air 3.1 或 air 3.2 sdk

```
SDK is missing file [my path to air]\lib\nai\bin\naip.exe 
```

我在跑

```
java -jar [path to air]\lib\adt.jar" -package -target native app.dmg app.air 
```

我也试过

```
java -jar [path to air]\lib\adt.jar" -package -target native app.exe app.air 
```

我也研究过这样的项目：http: [//bishoponvsto.wordpress.com/2010/02/23/adobe-air-2beta-2-to-exe-packaging-air-app-in-windows-executable /](http://bishoponvsto.wordpress.com/2010/02/23/adobe-air-2beta-2-to-exe-packaging-air-app-in-windows-executable/)，但它适用于 Air 2.0。

有任何想法吗？显然有一个集成的 Flash Builder 4.6 工具，但由于某种原因，移动项目不存在导出版本下的选项 - 奇怪......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T03:13:58.527

你为什么要这样做？Air 文件——当为特定平台导出时——*是*可执行文件。

如果您正在寻找可以创建目录、运行 Air 安装并将辅助文件移动到特定位置（文档、图标等）的“安装程序”，请尝试[Inno Setup](http://www.jrsoftware.org/isinfo.php)。

编辑：

您提供的代码适用于我创建 Windows EXE。但这似乎有点不必要。. . 为什么不直接从 Flash Builder 导出 EXE 文件（顶部工具栏中的“Export Release Build”按钮）？如果你不能或不会，那么这里有一些建议：

*   我正在使用 Java 版本 1.6.0_29。确保您的 Java 不仅是最新的，而且您实际上调用了正确的版本 ( `java -version`)。
*   仔细检查 JAR 目录文本。
*   检查您是否确实调用了正确的 Air 版本。
*   确保引号位于 JAR 路径的两侧。
*   您应该能够执行“导出发布构建”（尽管我*使用*的是FB 4.5）。不要选择“导出为：每个目标平台的签名包”，而是选择“导出为：用于在桌面上安装的签名 AIR 包”。（您可能必须创建一个证书，但您也可以通过此导出功能创建一个。）
*   （如果你碰巧可以使用 Flash IDE，导出的 Air 文件必须同时支持“桌面”和“扩展桌面”。）

希望这将允许您生成一个可以转换为 EXE 的 Air 程序，并使用命令行实际转换它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T23:15:26.007

我知道这个问题有点老了，但一位同事刚刚使用命令行工具和 FlashDevelop 遇到了相同的错误消息。事实证明，他不小心将一些源文件打包到 .air 包中，应用程序描述符的一个额外副本和一个 swc 被打包到 .air 文件中。我删除了这些并重新打包了 .air 文件，然后使用了这个命令：

```
adt.bat -package -target bundle kiosk kiosk.air 
```

这成功地创建了一个强制运行时 exe。当然，不需要先创建 .air 文件，您可以直接打包到本机或强制运行时，但由于我的同事正在创建 .air 文件，所以我也这样做了，只是为了确保它可以工作。

# c# - 在访问中拆分大查询字符串

> ID：10196217
> 
> 赞同：0
> 
> 时间：2012-04-17T17:41:16.670
> 
> 标签：c#, .net, sql, tsql

我在访问中有一个很长的查询，并试图将其分成多行，以便我可以在调试过程中检查它们，我尝试了通过谷歌找到的步骤，但它失败了，信息如下所示。

```
 public DataSet showallCompanyPaymentbyjobcode(int jobpk ,int confirmquotationpk)
        {

            string query=SELECT companypaymentmastertable.paymentpk, companypaymentmastertable.cmpinvoice, companypaymentmastertable.jobcode, companypaymentmastertable.customercode, confirmquotationmastertable.quotationcode, companypaymentmastertable.customerName, companypaymentmastertable.ischeque, companypaymentmastertable.isCash, companypaymentmastertable.amount, companypaymentmastertable.chequenumber, companypaymentmastertable.bankname, companypaymentmastertable.chequedate, companypaymentmastertable.chequereleasedate, companypaymentmastertable.companypaymentdate
FROM confirmquotationmastertable INNER JOIN companypaymentmastertable ON confirmquotationmastertable.confirmpk=companypaymentmastertable.confirmpk
WHERE (((companypaymentmastertable.confirmpk)=[?]) AND ((companypaymentmastertable.jobpk)=15));

                               OleDbDataAdapter dAdapter = new OleDbDataAdapter(query, Program.ConnStr);
                DataSet ds = new DataSet();
                dAdapter.Fill(ds, "tblpayview");

                if (ds.Tables.Count <= 0)
                {
                    ds = null;    
                }

                return ds;

            } 
```

在另一堂课上，我称之为

```
 public void fillpaymenttable()
        {
            DataSet ds= new DataSet();
            ds= companytransaction.showallCompanyPaymentbyjobcode(cmbjobcode.SelectedValue,cmbQuotationcode.SelectedValue);

             tblpaymentview.DataSource = ds.Tables["tblpayview"].DefaultView;

                if (ds.Tables.Count <= 0)
                {
                    lblstatus.Text = "No Payment Details Present";
                    clearcontrols();
                }

            } 
```

如果这样调用数据集，是否有任何方法可以拆分查询以及此功能是否有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:56:27.590

如果您只是想将代码实际拆分为单独的行，请使用`StringBuilder`? 请注意，如果您将参数传递给查询，则情况并非如此，因为您容易受到 SQL 注入的攻击

```
var query = new StringBuilder();

query.Append("SELECT companypaymentmastertable.paymentpk, companypaymentmastertable.cmpinvoice, ");
query.Append("companypaymentmastertable.jobcode, companypaymentmastertable.customercode, ");
query.Append("confirmquotationmastertable.quotationcode, companypaymentmastertable.customerName, ");
query.Append("companypaymentmastertable.ischeque, companypaymentmastertable.isCash, ");
query.Append("companypaymentmastertable.amount, companypaymentmastertable.chequenumber, ");
query.Append("companypaymentmastertable.bankname, companypaymentmastertable.chequedate, ");
query.Append(" companypaymentmastertable.chequereleasedate, companypaymentmastertable.companypaymentdate ");
query.Append("FROM confirmquotationmastertable INNER JOIN companypaymentmastertable ");
query.Append("ON confirmquotationmastertable.confirmpk=companypaymentmastertable.confirmpk ");
query.Append("WHERE (((companypaymentmastertable.confirmpk)=[?]) ");
query.Append("AND ((companypaymentmastertable.jobpk)=15))"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T19:14:21.170

这将比使用 stringbuilder 更有效，因为字符串连接将在编译时执行，而不是在运行时执行：

```
string query="SELECT companypaymentmastertable.paymentpk, companypaymentmastertable.cmpinvoice, "
 + "companypaymentmastertable.jobcode, companypaymentmastertable.customercode, "
 + "confirmquotationmastertable.quotationcode, companypaymentmastertable.customerName, "
 + "companypaymentmastertable.ischeque, companypaymentmastertable.isCash, companypaymentmastertable.amount, "
 + "companypaymentmastertable.chequenumber, companypaymentmastertable.bankname, companypaymentmastertable.chequedate, "
 + "companypaymentmastertable.chequereleasedate, companypaymentmastertable.companypaymentdate "
 + "FROM confirmquotationmastertable INNER JOIN companypaymentmastertable ON "
 + "confirmquotationmastertable.confirmpk=companypaymentmastertable.confirmpk "
 + "WHERE (((companypaymentmastertable.confirmpk)=[?]) AND ((companypaymentmastertable.jobpk)=15));" 
```

或者，您可以使用“逐字字符串”：

```
 string query= @"SELECT companypaymentmastertable.paymentpk, companypaymentmastertable.cmpinvoice, 
companypaymentmastertable.jobcode, companypaymentmastertable.customercode, 
confirmquotationmastertable.quotationcode, companypaymentmastertable.customerName, 
companypaymentmastertable.ischeque, companypaymentmastertable.isCash, companypaymentmastertable.amount, 
companypaymentmastertable.chequenumber, companypaymentmastertable.bankname, companypaymentmastertable.chequedate, 
companypaymentmastertable.chequereleasedate, companypaymentmastertable.companypaymentdate    
FROM confirmquotationmastertable 
INNER JOIN companypaymentmastertable ON confirmquotationmastertable.confirmpk=companypaymentmastertable.confirmpk    
WHERE (((companypaymentmastertable.confirmpk)=[?]) AND ((companypaymentmastertable.jobpk)=15));"; 
```

# jquery - Twitter 的 bootstrap 精简版可与 jquery-file-upload 一起使用

> ID：10196218
> 
> 赞同：3
> 
> 时间：2012-04-17T17:41:32.813
> 
> 标签：jquery, css, jquery-plugins, twitter-bootstrap

我正在为我的网站寻找一个精简版的 Twitter Bootstrap 原始版本的问题是：

*   干扰当前的 CSS 样式
*   Twitter Bootstrap 是巨大而令人毛骨悚然（但干净）的 CSS
*   我真的不需要在 IE6 IE7 中工作

尝试自己剥离看起来像是一项艰巨的任务，我不确定我是否可以保留所有需要的更改，如果有人能给我带来更多如何更轻松地完成它的想法，我也可以尝试再做一次。

**具体的问题是：**互联网上的某个地方有一个 twitter bootstrap 的剥离版本，它是为与 Jquery-upload-file 一起工作而量身定制的，而没有提供该工具包的所有其他东西？

如果这样的事情不存在，我愿意建议让这项任务更加可行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:47:07.810

[您可以使用他们的在线工具](http://twitter.github.com/bootstrap/download.html)创建自己的自定义引导程序版本，否则您需要使用[less](http://lesscss.org/)调整和重新编译 css 。

# python - 在 python 中线程化可序列化操作比顺序运行它们要慢

> ID：10196220
> 
> 赞同：1
> 
> 时间：2012-04-17T17:41:45.247
> 
> 标签：python, multithreading, python-multithreading

我试图在 python 中同时运行两个长时间运行的操作。它们都对相同的数据集进行操作，但不对其进行修改。我发现线程实现的运行速度比简单地一个接一个地运行要慢。

我创建了一个简化的示例来展示我正在经历的事情。

运行此代码并注释第 46 行（使其执行线程操作），导致我的机器上的运行时间约为 1:01（分：秒）。我看到两个 CPU 在整个运行时间内以大约 50% 的速度运行。

注释掉第 47 行（导致顺序计算）会导致运行时间约为 35 秒，其中 1 个 CPU 在整个运行时间中固定为 100%。
两次运行都导致完成了两个完整的计算。

```
from datetime import datetime
import threading

class num:
    def __init__(self):
        self._num = 0

    def increment(self):
        self._num += 1

    def getValue(self):
        return self._num

class incrementNumber(threading.Thread):
    def __init__(self, number):
        self._number = number
        threading.Thread.__init__(self)

    def run(self):
        self.incrementProcess()

    def incrementProcess(self):
        for i in range(50000000):
            self._number.increment()

def runThreaded(x, y):
    x.start()
    y.start()
    x.join()
    y.join()

def runNonThreaded(x, y):
    x.incrementProcess()
    y.incrementProcess()

def main():
    t = datetime.now()

    x = num()
    y = num()
    incrementX = incrementNumber(x)
    incrementY = incrementNumber(y)

    runThreaded(incrementX, incrementY)
    #runNonThreaded(incrementX, incrementY)

    print x.getValue(), y.getValue()
    print datetime.now() - t

if __name__=="__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T17:44:13.773

CPython 有一个所谓的[Global Interpreter Lock](http://www.dabeaz.com/python/UnderstandingGIL.pdf)，这意味着即使在多线程时，一次也只能运行一条 Python 语句。您可能想研究[multiprocessing](http://docs.python.org/library/multiprocessing.html)，它可以避免这种约束。

GIL 意味着 Python 多线程仅适用于 I/O 绑定操作、其他等待事情发生的事情，或者如果您正在调用 C 扩展以在工作时释放 GIL。

# jquery - 使用 jquery 从 wikimedia 解析 json 字符串

> ID：10196222
> 
> 赞同：2
> 
> 时间：2012-04-17T17:41:51.663
> 
> 标签：jquery, json, mediawiki, wikimedia

我想从 wiki 页面获取信息框。为此，我正在使用 wiki api。以下是我从中获取 json 数据的 url。

[http://en.wikipedia.org/w/api.php?action=query&prop=revisions&rvprop=content&format=json&titles=](http://en.wikipedia.org/w/api.php?action=query&prop=revisions&rvprop=content&format=json&titles=) "+first+"&rvsection=0

其中 first 是一个包含 Wikipedia 文章标题的变量。

我发现解析这些数据以制作有意义的 html 非常复杂。

我`$.each`最初使用的是功能。但是循环非常深，我不得不使用 6-7 次才能获得我想要的实际数据。我认为会有比这更好的选择。请帮我。

json数据供参考

```
jQuery16209061950308827726_1334683337112({"query":{"pages":{"11039790":{"pageid":11039790,"ns":0,"title":"Animal","revisions":[{"*":"{{Redirect|Animalia}}\n{{Other uses}}\n{{pp-semi-protected|small=yes}}\n{{pp-move-indef}}\n{{Taxobox\n| color = {{taxobox color|[[animalia]]}}\n| name = Animals\n| fossil_range = [[Ediacaran]] \u2013 Recent {{fossilrange|610|0|}}\n| image = Animal diversity.png\n| image_width = 250px\n| domain = [[Eukaryota]]\n{{Taxobox_norank_entry | taxon = [[Opisthokonta]]}}\n{{Taxobox_norank_entry | taxon = [[Holozoa]]}}\n{{Taxobox_norank_entry | taxon = [[Filozoa]]}}\n| regnum = '''Animalia'''\n| regnum_authority = [[Carolus Linnaeus|Linnaeus]], [[Systema Naturae|1758]]\n| subdivision_ranks = [[Phylum|Phyla]]\n| subdivision =\n* '''Subkingdom [[Parazoa]]'''\n** [[Sponge|Porifera]]\n** [[Placozoa]]\n* '''Subkingdom [[Eumetazoa]]'''\n** '''[[Radiata]] (unranked)'''\n*** [[Ctenophora]]\n*** [[Cnidaria]]\n** '''[[Bilateria]] (unranked)'''\n*** [[Orthonectida]]\n*** [[Rhombozoa]]\n*** [[Acoelomorpha]]\n*** [[Chaetognatha]]\n*** '''Superphylum [[Deuterostomia]]'''\n**** [[Chordata]]\n**** [[Hemichordata]]\n**** [[Echinoderm]]ata\n**** [[Xenoturbellida]]\n**** [[Vetulicolia]] [[extinction|\u2020]]\n*** '''[[Protostomia]] (unranked)'''\n**** '''Superphylum [[Ecdysozoa]]'''\n***** [[Kinorhyncha]]\n***** [[Loricifera]]\n***** [[Priapulida]]\n***** [[Nematoda]]\n***** [[Nematomorpha]]\n***** [[Lobopodia]]\n***** [[Onychophora]]\n***** [[Tardigrada]]\n***** [[Arthropoda]]\n**** '''Superphylum [[Platyzoa]]'''\n***** [[Platyhelminthes]]\n***** [[Gastrotricha]]\n***** [[Rotifera]]\n***** [[Acanthocephala]]\n***** [[Gnathostomulida]]\n***** [[Micrognathozoa]]\n***** [[Cycliophora]]\n**** '''Superphylum [[Lophotrochozoa]]'''\n***** [[Sipuncula]]\n***** [[Hyolitha]] [[extinction|\u2020]]\n***** [[Nemertea]]\n***** [[Phoronida]]\n***** [[Bryozoa]]\n***** [[Entoprocta]]\n***** [[Brachiopoda]]\n***** [[Mollusca]]\n***** [[Annelida]]\n***** [[Echiura]]\n}}\n\n'''Animals''' are a major group of multicellular, [[eukaryotic]] [[organism]]s of the [[Kingdom (biology)|kingdom]] '''Animalia''' or '''Metazoa'''. Their [[body plan]] eventually becomes fixed as they [[Developmental biology|develop]], although some undergo a process of [[metamorphosis]] later on in their life. Most animals are [[Motility|motile]], meaning they can move spontaneously and independently. All animals are also [[heterotroph]]s, meaning they must ingest other organisms or their products for [[sustenance]].\n\nMost known animal [[phylum|phyla]] appeared in the fossil record as marine species during the [[Cambrian explosion]], about 542 million years ago."}]}}}}) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T23:00:40.940

如果您希望实际的 html 显示在 wikipage 中，请改用[action=parse](http://www.mediawiki.org/wiki/API%3aParsing_wikitext)。是的，结果对象是深度嵌套的。但是没有理由循环它们！

*   第一个属性始终是动作，这里：`query`
*   您已请求页面的属性，因此您将收到`pages`
*   由他们的页面 id 键入。这是使用循环的唯一步骤
*   每个页面对象都有特定的属性（如标题），您对`revisions`
*   这是一个修订对象数组，您需要唯一且第一个
*   修订对象的 sourcetext 属性是`*`

所以，只要这样做：

```
if (data && data.query && data.query.pages)
    var pages = data.query.pages;
else
    // error: No pages returned / other problems!
for (var id in pages) { // in your case a loop over one property
    if (pages[id].revisions && pages[id].revisions[0] && pages[id].revisions[0]["*"])
        var content = pages[id].revisions[0]["*"];
    else
        // error: No revision content returned for whatever reasons!
}
// use "content" variable here 
```

不要忘记检查每个对象的存在！如果您没有请求任何页面，则不会有 pages 对象；仅当页面“数组”为空时才会出现这种情况。页面可能缺少/无效标题或其他内容，因此没有修订。等等

# android - Android Spinner 中的额外行

> ID：10196223
> 
> 赞同：1
> 
> 时间：2012-04-17T17:42:03.190
> 
> 标签：android, android-spinner

我正在编写一个 Android 应用程序。我有几个微调器。每个都在微调器底部附近和左右两侧显示一条额外的线。请看图片。有谁知道为什么会发生这种情况以及如何解决？

![在此处输入图像描述](../Images/70670bf12c360b58acf8b8c7caeb3325.png)

这是定义微调器的 xml 文件中的条目：

```
 <Spinner android:id="@+id/formatSpinner"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content"
         android:drawSelectorOnTop="true"
         android:prompt="@string/format_prompt"/> 
```

这是初始化它的代码：

```
 cur = mDbHelper.fetchAllFormats();
        adapter = new SimpleCursorAdapter(this, android.R.layout.simple_spinner_item, cur,
                new String[]{MoviesDbAdapter.KEY_NAME}, new int[]{android.R.id.text1});
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        formatSpinner.setAdapter(adapter); 
```

谢谢！

Update1：​​我做了一些实验，如果从 XML 文件中删除微调器之前的 TextView，微调器会正确显示。我不知道为什么会这样，有什么想法吗？

Update2：另外，如果我在微调器中添加一个 layout_marginTop，问题就会消失！这真的很奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:44:34.533

```
<Spinner android:id="@+id/formatSpinner"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content"
         android:prompt="@string/format_prompt"/> 
```

试试这个..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:43:57.497

这显然是android的一个错误。我看到其他人遇到同样的问题，没有人有一个好的答案。这实际上不是在微调控件上绘制的一条线，正如我最初所想的那样，而是控件绘制中的一个“间隙”，它允许背景颜色显示出来。

修复或解决此问题的方法是更改​​绘制微调器的位置。我通过在第一个微调器之前添加一个奇数边距来做到这一点。就我而言，我使用了 5dp。然后，我对以下两个微调器使用 4dp，以便它们都从奇数像素数开始。

这有点难看，但在为此创建修复程序之前，这是我找到的最佳解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-06T04:11:16.263

试试这个

```
<Spinner
    ...            
    style="@style/Widget.AppCompat.Spinner.Underlined"
    ... /> 
```

# html - img 浮动到文本的左侧

> ID：10196236
> 
> 赞同：1
> 
> 时间：2012-04-17T17:42:58.380
> 
> 标签：html, css, css-float

我无法使图像浮动到文本的左侧。能否请你帮忙？我也可以在 CSS 中写 width="200" height="200" 吗？如果可能，怎么做？谢谢你的帮助。

```
Html code

        <div class="content">
        <img src="img1.jpg" class="bw" width="200" height="200" alt="king">
        Content is very important bla bla bla....Content is very important bla bla bla....Content is very important bla bla bla....Content is very important bla bla bla....Content is very important bla bla bla....Content is very important bla bla bla....Content is very important bla bla bla....Content is very important bla bla bla....Content is very important bla bla bla....Content is very important bla bla bla....
        </div>

CSS
     div.content {
         width:80%;
         padding-top: 2pc;
         padding-left: 5pc;
         text-align:left;
         font: 10pt Helvetica,"Helvetica neue", Arial, sans-serif;
         margin-left: 100px;
         margin-right: 300px;
         color: #000000 }

     div.img.bw {
         float:left;
         margin:4px; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:46:22.980

最大的问题是您的选择器在您的图像上是错误的。

它应该是：

```
div img.bw {
float: left;
margin: 4px; 
} 
```

现在 css 正在寻找一个带有“img”类的 div。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T17:46:25.260

`div.img.bw`是不正确的。您应该将其定义为`div img.bw`. 您需要定位和元素是 a `image`，其中类`bw`是 a 的元素内`div`。这是什么`div img.bw`目标。还要定义高度和宽度使用：

```
 div img.bw {
  float:left;
  margin:4px; 
  width:200px;
  height:200px;
} 
```

# sql - Sql Select phone numbers from a many to many table with different types (mobile, home)

> ID：10196237
> 
> 赞同：2
> 
> 时间：2012-04-17T17:42:59.523
> 
> 标签：sql, sql-server, select, many-to-many

I have a simple table schema:

```
Person: ID, Name
PhoneNumber: ID, Type, Number                    #Type can be 'home' or 'mobile'.
PersonPhoneNumber: ID, Person_ID, PhoneNumber_ID #A join table that connects the
                                                 #person to a phone number. 
```

As data I have:

```
Person: 1, "Ed"
PhoneNumber: 1, "home", 1111
PhoneNumber: 2, "mobile", 2222
PersonPhoneNumber: 1, 1 /*(Person_ID)*/, 1 /*(PhoneNumber_ID*/
PersonPhoneNumber: 2, 1 /*(Person_ID)*/, 2 /*(PhoneNumber_ID*/ 
```

I want to write a view that returns:

```
Name    |Home    |Mobile
-----------------------------
"Ed"     1111     2222
"Joe"    3333     4444
... etc 
```

Any tips on how I approach this?

Note: These tables are a snippet from a larger schema which explains why its a many to many and not more simplistic.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:49:57.173

如果您有多个号码或者可能不止家庭/手机号码，您可以以更复杂的方式执行此操作，但现在，如果您只有两个号码，那么这将起作用：

```
SELECT Name, HomeNumber.Number AS Home, MobileNumber.Number AS Mobile
FROM Person
    LEFT JOIN PersonPhoneNumber HomeMap
        ON Person.ID = HomeMap.Person_ID
    LEFT JOIN PhoneNumber HomeNumber
        ON HomeMap.PhoneNumber_ID = HomeNumber.ID AND HomeNumber.Type = 'home'
    LEFT JOIN PersonPhoneNumber MobileMap
        ON Person.ID = MobileMap.Person_ID
    LEFT JOIN PhoneNumber MobileNumber
        ON MobileMap.PhoneNumber_ID = MobileNumber.ID AND MobileNumber.Type = 'mobile' 
```

顺便说一句，如果您不想要任何数字的人，那么您可以将`PersonPhoneNumber`映射设置为 a`JOIN`而不是 a`LEFT JOIN`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:50:14.553

```
select  p.Name
,       pnh.Number as Home
,       pnm.Number as Mobile
from    Person p
left join 
        PersonPhoneNumber pn
on      pn.Person_ID = p.ID
left join    
        PhoneNumber pnh
on      pnh.ID = pn.PhoneNumber_ID
        and phh.Type = 'home'
left join    
        PhoneNumber pnm
on      pnm.ID = pn.PhoneNumber_ID
        and pnm.Type = 'mobile' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:20:00.413

这将帮助你

```
select * from @Person p
left join @PersonPhoneNumber ppn
on p.ID = ppn.PersonID
right join @PhoneNumber pn
on ppn.PhoneNoID = pn.ID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T04:12:09.670

希望这可以帮助

```
 SELECT DISTINCT P.NAME,
                (SELECT DISTINCT PN1.PH_NUMBER
                   FROM PHONE_NUMBER PN1
                  WHERE PN1.ID = PN.ID
                    AND PN1.TYPE = 'Home') AS HOME,
                (SELECT DISTINCT PN1.PH_NUMBER
                   FROM PHONE_NUMBER PN1
                  WHERE PN1.ID = PN.ID
                    AND PN1.TYPE = 'Mobile') AS MOBILE
  FROM PERSON P, PHONE_NUMBER PN
  ORDER BY P.NAME 
```

# android - Where I can learn how to implement the physics of 'Where is my water'?

> ID：10196239
> 
> 赞同：4
> 
> 时间：2012-04-17T17:43:05.203
> 
> 标签：android, iphone, box2d, physics

I'm working on a game where the water acts as a property that can be used to solve puzzles and interact with other screen elements and I'm very much interested in learning how they managed to get such a fluid physics interaction.

Can that be accomplished with Box2D using particles?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T17:41:39.893

在看到您正在谈论的游戏视频后（并且在被告知您正在谈论特定游戏之后），我认为[元球](http://en.wikipedia.org/wiki/Metaballs)模拟可能会成功。

[谷歌搜索“我的水元球在哪里”，我在Ludum Dare](http://www.ludumdare.com/)条目中找到了如何实现这个精确游戏的描述：

[http://www.ludumdare.com/compo/?p=104952&preview=true](http://www.ludumdare.com/compo/?p=104952&preview=true)

> 粒子模拟器会是最好的，但将其集成到游戏中需要一些我没有的宝贵时间。所以我创建了一个水池和障碍物，以及大量密度很高的小滑球。您不需要任何摩擦、阻尼和少量恢复。当我的全屏尺寸为 48m x 32m 时，一个球的半径约为 0.25m。
> 
> 模拟许多经常夹在一个地方的动态物体是非常繁重的操作。这是需要考虑的。出于这个原因，我使用了非常不准确的物理设置。我只用一个速度和位置子步跨步了世界。此外，我将物理步数固定为 30/s。（比赛后我注意到 20 就足够了）总是在处理固定时间步长时，当物理没有步进但渲染是时，你想要插值或推断位置。我选择了外推。这很容易拉出来。
> 
> RenderPos = PhysicalPos + Velocity * TimeAccumulator

然后他们继续描述*渲染*是如何欺骗玩家相信它是一个流体而不是小球。他们使用一种元球渲染形式。

> 我的方法是将水滴渲染为半径是物体物理尺寸两倍的元球。制作元球的最快方法是中间不透明且边缘完全透明且具有平滑圆形渐变的精灵。

# c++ - Problems with headers and linker errors (new to C++)

> ID：10196242
> 
> 赞同：0
> 
> 时间：2012-04-17T17:43:16.010
> 
> 标签：c++, visual-c++

I'm new to c++ and I'm having some trouble with making a header file. The exact error I'm getting is

> obj.obj : error LNK2019: unresolved external symbol "float * __cdecl getVertices(class std::basic_string,class std::allocator >,int,float *)" (?getVertices@@YAPAMV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@HPAM@Z) referenced in function "struct ObjModel __cdecl importObj(void)" (?importObj@@YA?AUObjModel@@XZ)

The bugs/solutions I'm seeing seem much more complicated that what I'm doing. Here's my header, which I suspect is wrong.

```
//obj.h
#ifndef OBJ_H_INCLUDED
#define OBJ_H_INCLUDED

#include <stdio.h>
#include <stdlib.h>
#include <string>
#include <fstream>
#include <iostream>
using namespace std;

struct ObjVertex {
     float x, y, z;
};

struct ObjTriangle {
     int Vertex[3];
     int Normal[3];
};

struct ObjModel {
     int NumVertex, NumNormal, NumTexCoord, NumTriangle;
     ObjVertex *VertexArray;
     ObjVertex *NormalArray;
     ObjTriangle *TriangleArray;
};

//function prototypes
float* getVertices(string buf, int i, float* ret);
ObjModel importObj();
char* subString(char* buf, int b, int e);

#endif 
```

I've just started in C++ but I have experience in Java and C, so it's probably an issue with me not knowing some C++ specific thing.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:45:40.817

没有实现，`float* getVertices(string buf, int i, float* ret);`因此您会收到链接器错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T20:02:35.640

您必须将`getVertices`声明的模块附加到项目中。

# vb.net - label not showing up when properties changed to visable

> ID：10196245
> 
> 赞同：0
> 
> 时间：2012-04-17T17:43:22.910
> 
> 标签：vb.net

in my program I have a section that is outlined as listed below - in the page load, the label's visibility is set to false.

```
lblLoading.visable = true
lblloading.text = "loading please wait"
UpdateData()
lblloading.text = "Loading Complete" 
```

It takes about a minute or 2 to run updatedata as it is doing multiple things to a database - when I execute this code, it stalls and loads the data, then when done I do get my label that says loading complete, but I never see the label before it is done loading to tell the user that it is processing. Is there any way to force it to show before UpdateData() is called so that it shows during the load time? Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:47:39.577

放

```
Me.Refresh 
```

在调用 UpdateData 之前

# c# - windows服务启动方法出错

> ID：10196248
> 
> 赞同：0
> 
> 时间：2012-04-17T17:43:43.130
> 
> 标签：c#, .net, windows-services

我已经使用（Visual Studio 8）创建了一个 Windows 服务并使用`installutil.exe`工具安装了它，但是我没有得到正确的结果，因为我在服务启动方法上执行了以下代码。

```
protected override void OnStart(string[] args)
{
    FileStream fs = new FileStream(@"e:\mcWindowsService.txt",
        FileMode.OpenOrCreate, FileAccess.Write);
    StreamWriter m_streamWriter = new StreamWriter(fs);
    m_streamWriter.BaseStream.Seek(0, SeekOrigin.End);
    m_streamWriter.WriteLine("m ready buddy");
    m_streamWriter.Flush();
    m_streamWriter.Close();
} 
```

当我盯着它时，它不是在 E Drive 中创建文件而是显示跟随错误！

> 本地计算机上的测试服务安装程序服务启动然后停止。如果某些服务没有被其他服务或程序使用，它们会自动停止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:50:10.057

将上述代码放在 Try-Catch 块中，将其写入事件日志以查找任何异常并进行调查。也可以将它们放在单独的线程中以避免任何阻塞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T19:54:07.683

如果您从控制台运行该服务，请确保您的帐户对 E 驱动程序具有权限。

如果您已经安装了服务，并意识到它抛出了异常，那么为服务安装程序设置帐户类型，例如

```
var serviceInstaller = new ServiceProcessInstaller();
            serviceInstaller.Account = ServiceAccount.LocalSystem; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T20:58:00.243

我几乎肯定你的代码崩溃了。上面的 try-catch 建议是迄今为止最好的，所以你可以看到发生了什么。

进一步：尽量不要在 OnStart 中执行需要很长时间的东西——只执行简单的初始化东西。有一个超时，如果你超过这个阈值，Windows 会抱怨它无法启动它 - 它会保持在令人讨厌的启动状态。***在 OnStart 中仅启动一个计时器并在该计时器的间隔计时器*_Elapsed**的到期事件的处理程序中执行您的繁重工作。在你执行你的东西之前暂停计时器并在操作结束后重新启动它。

# facebook - 使用facebook登录，登录后出现错误并允许应用程序获得基本权限

> ID：10196251
> 
> 赞同：0
> 
> 时间：2012-04-17T17:43:52.130
> 
> 标签：facebook, login, localhost, blogs

获得的错误是**发生错误，请稍后重试**

我创建了新的 facebook 应用程序并使用 APP ID。我输入域名为**blogspot.in**并重定向 URL 作为[我的博客](http://viewmyprojects.blogspot.in)

[然后我使用了](http://developers.facebook.com/docs/guides/web/)以下代码

```
 <div id="fb-root"></div>
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : 'YOUR_APP_ID',
        status     : true, 
        cookie     : true,
        xfbml      : true,
        oauth      : true,
      });
    };
    (function(d){
       var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
       js = d.createElement('script'); js.id = id; js.async = true;
       js.src = "//connect.facebook.net/en_US/all.js";
       d.getElementsByTagName('head')[0].appendChild(js);
     }(document));
  </script>
  <div class="fb-login-button">Login with Facebook</div> 
```

我使用 Javascript/HTML 小工具在我的博客中输入了这段代码，一切正常，直到登录并允许应用程序，之后我得到了错误。

我什至通过将主机文件中的 127.0.0.1 更改为 local.localhost 来尝试使用 localhost 但即使这样我也遇到了同样的错误。我浏览了许多 stackoverflow 帖子，但没有任何帮助。

我的问题是；

*   我们可以在博客中使用 Facebook 登录吗
*   如果是这样，问题是什么以及如何纠正它？

**Imp：您可以通过访问我的博客来查看错误，在右侧您可以看到使用 facebook 选项登录（不要担心登录没有任何反应，我只是用它来测试）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:31:22.430

facebook 按钮提供了一种方便用户通过 facebook 登录的方法。通过这种方式，用户授予 Facebook 访问您网站的权限，一旦授予访问权限完成，Facebook 将向您发送用户数据。您必须使用此类数据来处理、授权、自动登录、自动注册用户。它不能直接完成，但需要在您的网站或博客网站内部执行其他步骤。

在使用 facebook 登录按钮在您的网站中实现 facebook 登录/自动注册过程时，请遵循以下方法。

i：页面脚本。

```
 <script>
    window.fbAsyncInit = function () {
        FB.init({ appId: 'appid', status: true, cookie: true,
            xfbml: true
        });
    };
    (function () {
        var e = document.createElement('script'); e.async = true;
        e.src = document.location.protocol +
           '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-root').appendChild(e);
    } ()); 
```

ii：使用点击登录按钮时创建链接并调用facebook功能。例如

```
<a rel="nofollow" href="javascript:void(0);"  onclick="fb_login();">login to facebook</a> 
```

iii: 创建 fb_login() 函数

```
function fb_login() {
FB.login(function (response) {
    if (response.authResponse) {
        // user authorized
        Process_Login(u, redirect);
    } else {
        console.log('User cancelled login or did not fully authorize.');
    }
  }, { scope: 'email,user_birthday,user_hometown,publish_stream' });
} 
```

// 此函数负责通过 ajax 将从 facebook 检索到的数据发送到您的网站，用于授权、自动登录、自动注册目的。

```
function Process_Login() {
FB.api('/me', function (response) {
    var fb_data = "uid=" + response.id + "&fn=" + response.first_name + "&ln=" + response.last_name + "&gn=" + response.gender + "&bt=" + response.birthday + "&eml=" + response.email;
    if (response.hometown != undefined)
        fb_data = fb_data + "&loc=" + response.hometown.name;
    if (response.username != undefined)
        fb_data = fb_data + "&uname=" + response.username;
    $.ajax({
        type: 'GET',
        url: u + "handlers/signup.ashx",
        data: fb_data,
        success: function (msg) {
             // login process completed
             // redirect user to final page.
        }
    });
  });
} 
```

# google-chrome-extension - Does content_scripts matches "chrome-extension://*/*" work?

> ID：10196258
> 
> 赞同：9
> 
> 时间：2012-04-17T17:44:20.790
> 
> 标签：google-chrome-extension

I want to run a content script on an iframe with a chrome-extension:// URL. I added a line to my manifest.json that I copied out of the documentation [http://code.google.com/chrome/extensions/match_patterns.html](http://code.google.com/chrome/extensions/match_patterns.html)

```
 chrome-extension://*/* 
```

But when I reload my extension I get an alert:

```
Could not load extension from '/work/sirius/extension'. 
Invalid value for 'content_scripts[2].matches[0]': Invalid scheme. 
```

Any idea how to get this to worK?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-17T17:56:49.343

不能。只有`ftp:`, `file:`,`http:`和`https:`可以与内容脚本声明匹配。

`matches`任何和字段中的无效 URL 模式都会`exclude_matches`被拒绝（在尝试加载扩展程序时生成错误）。

[`permissions`清单文件中选项的](https://developer.chrome.com/extensions/declare_permissions)无效模式将被忽略。

如果要在扩展程序的选项卡上运行脚本，请[`chrome.extension.getViews`](https://developer.chrome.com/extensions/extension#method-getViews)在后台脚本中使用。更好的是，设计您的扩展页面，使它们[能够有效地相互通信](https://developer.chrome.com/extensions/messaging) ^(（[示例](https://developer.chrome.com/extensions/messaging#external)）)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-30T19:29:02.963

我遇到了完全相同的问题，请查看 API [http://code.google.com/chrome/extensions/match_patterns.html](http://code.google.com/chrome/extensions/match_patterns.html) 它清楚地表明他们接受`chrome-extension://*/*`但他们不接受。

他们需要更新 API 以免混淆人们。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-08-12T14:37:47.817

似乎 Chrome 作者已经默默地删除了将内容脚本注入`chrome-extension:`页面的能力。[文档](http://developer.chrome.com/extensions/match_patterns.html)仍然说它有效，甚至包含带有*chrome-extension:*方案的示例，但实际上它不起作用。所以现在只有`http:`，`https:`并且`ftp:`“从盒子里”`file:`工作，如果你的扩展用户在扩展（chrome://extensions/）页面上启用了这个，就可以工作。

**更新：**现在上面提到的文档已经更新，并且没有说明向`chrome-extension:`页面注入内容脚本的能力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-22T03:02:17.087

您可以将 js 注入到您的 iframe html( `chrome-extension:`pages) 中，而无需在`manifast.json`. 注入的js可以直接访问Chrome API。

iframe.html：

```
<!DOCTYPE html>
<html>
<head>
...
</head>
<body>
...
</body>
<script src="iframe.js"></script>
</html> 
```

iframe.js：

```
console.log(chrome); // {loadTimes: ƒ, csi: ƒ, …} 
```

# javascript - Javascript handling JSON

> ID：10196264
> 
> 赞同：0
> 
> 时间：2012-04-17T17:44:36.880
> 
> 标签：javascript, jquery, json

This seems really bizarre...

I have some JSON...

```
{"firstName":"David","lastName":"Smith","email":null,"id":0} 
```

But when I try to parse it and use it with...

```
<script>
    $(document).ready(function() {
        var json = $.getJSON('userManagement/getUser');
        $("p").text(json.firstName);
    });
</script>

This is the user management view

Users : <p></p> 
```

Nothing appears, but if I just do $("p").text(json); it tells me it's an object and I can see the JSON is correct in firebug, any ideas?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T17:46:37.370

尝试：

```
<script>
    $(document).ready(function() {
        $.getJSON('userManagement/getUser',function(json){
            $("p").text(json.firstName);
        });            
    });
</script> 
```

`json`在 AJAX 请求完成后，您必须使用该变量。

在此处了解有关 AJAX JSON 请求的更多信息：http: [//api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

在此处了解有关一般 AJAX 请求的更多信息：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T17:47:26.323

该`$.getJSON()`函数只是一个 AJAX 调用的包装器；它不会返回由于 AJAX 调用而获得的 JSON，而是返回一个[jqXHR](http://api.jquery.com/Types/#jqXHR)对象（感谢 Mathletics 对此进行了澄清）。

您需要提供一个回调函数来对所需的 JSON 进行任何处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T17:48:51.733

`$.getJSON()`是异步的 - 它不返回 JSON。

您需要提供一个*回调函数*，或者使用：

```
$.getJSON(url, callback); 
```

或者

```
var jqxhr = $.getJSON(url);
jqxhr.done(success_callback); // will be passed the JSON
jqxhr.fail(error_callback);   // will be called if there's an error 
```

后者更灵活，因为您还可以注册原始`$.getJSON`方法不支持的错误回调。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T17:49:06.773

您需要使用回调函数，因为您异步检索数据。

您调用 JSON 的那一刻`$("p").text(json.firstName);`尚未加载。

这就是为什么你必须使用：

`$.getJSON('userManagement/getUser',function(json){...your code here... }<-callback`

# python-3.x - how to call a function a specific no. of times in python

> ID：10196266
> 
> 赞同：0
> 
> 时间：2012-04-17T17:44:42.427
> 
> 标签：python-3.x

I am building a python module which will take the two numbers.Then it will find the random numbers between the two numbers for specific number of times and then add all of them a single variable. Then I will use the // operator to find the nearest and least whole number(integer in python). I have just made this much of code:

```
import random
def randint(minno, maxno, nooftime): 
```

Here the minno is the least no and maxno is the maximum no and nooftime will be the no of times the random numbers will be generated and added to common variable(a , to be specific) then i will divide a by the nooftime by using this equation (a//nooftime) and then I will print the base quotient this module will be used for gaming purposes such as generating positions for an enemy to appear and for random map generaion

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:49:00.327

这基本上重新实现了`random.randint`：

```
from random import random

def randint(minno, maxno, nooftime):
    a = sum([random() * (maxno-minno) + minno for _ in range(nooftime)])
    return a // nooftime 
```

# sql - Oracle RATIO_TO_REPORT and Rollup

> ID：10196270
> 
> 赞同：2
> 
> 时间：2012-04-17T17:44:53.277
> 
> 标签：sql, oracle

```
SELECT HOME_DEPT, LINECODE, SUM(TOTAL_HRS),  
       TO_CHAR ( 
       100*RATIO_TO_REPORT(SUM(TOTAL_HRS))
       OVER (PARTITION BY HOME_DEPT), 
       '990.00L', 'NLS_CURRENCY=%'
       ) PCT_JOB
       FROM TABLE 
       GROUP BY HOME_DEPT, LINECODE ORDER BY HOME_DEPT ASC, PCT_JOB DESC; 
```

The above Oracle query works and produces results as such:

```
DEPT1 LINECODE1 100 50% 
DEPT1 LINECODE2  50 25%
DEPT1 LINECODE3  50 25%

DEPT2 LINECODE1  20 12.5% 
DEPT2 LINECODE2  20 12.5%
DEPT2 LINECODE3  20 12.5%
DEPT2 LINECODE4  20 12.5%
DEPT2 LINECODE5  20 12.5%
DEPT2 LINECODE6  20 12.5%
DEPT2 LINECODE7  20 12.5%
DEPT2 LINECODE8  20 12.5% 
```

now I want to rollup per department to get results as such:

```
DEPT1 LINECODE1 100  50% 
DEPT1 LINECODE2  50  25%
DEPT1 LINECODE3  50  25%
DEPT1           200 100%  <--- desired

DEPT2 LINECODE1  20  12.5% 
DEPT2 LINECODE2  20  12.5%
DEPT2 LINECODE3  20  12.5%
DEPT2 LINECODE4  20  12.5%
DEPT2 LINECODE5  20  12.5%
DEPT2 LINECODE6  20  12.5%
DEPT2 LINECODE7  20  12.5%
DEPT2 LINECODE8  20  12.5%
DEPT2           160 100.0%    <--- desired 
```

I have tried various things such as GROUPING SETS but then my PCT_JOB values are wrong.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T20:45:16.397

`GROUPING`这里[记录](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions062.htm#i77498)了一个函数。此函数将告诉您给定行是否为“超级聚合”行。然后，您可以根据该行的值进行排序。

请注意，我对 PCT_JOB 列的定义有点杂乱无章，因为我将普通行和“超级聚合”行分别分组。

下面的 SQL 查询应该可以满足您的需求。

```
select
  home_dept,
  linecode,
  total_hrs,
  to_char(
    100 * ratio_to_report(total_hrs) over (partition by home_dept, linecode_group),
    '990.00L', 'NLS_CURRENCY=%') as pct_job 
from (
  SELECT 
    HOME_DEPT, 
    LINECODE, 
    SUM(TOTAL_HRS) as total_hrs, 
    grouping(linecode) as linecode_group
  FROM my_TABLE 
  GROUP BY grouping sets ((home_dept), (HOME_DEPT, LINECODE))
)
ORDER BY HOME_DEPT ASC, linecode_group, pct_job desc 
```

另外，我在这里使用了分组集，但可以只使用：

```
 GROUP BY home_dept, rollup(LINECODE) 
```

有一个[SQLFiddle 可以](http://sqlfiddle.com/#!4/2ce94/27)让你看到一个例子。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-05T17:43:41.547

这是一个不需要外部查询的答案。它基于 Mike Meyers 的回答，但现在行代码的 GROUPING 在 PARTITION BY 子句和 ORDER BY 子句中指定：

```
SELECT
    home_dept,
    linecode,
    SUM(total_hrs) AS total_hrs, 
    TO_CHAR(100 * RATIO_TO_REPORT (SUM(total_hrs))
            OVER (PARTITION BY home_dept, GROUPING(linecode)),
            '990.00L', 'NLS_CURRENCY=%') AS pct_job
FROM my_table
GROUP BY GROUPING SETS ((home_dept), (home_dept, linecode))
ORDER BY home_dept, GROUPING(linecode), pct_job DESC 
```

上面的代码使用 GROUP BY GROUPING SETS 但下面的 GROUP BY 也可以工作：

```
GROUP BY home_dept, ROLLUP(linecode) 
```

也仅供参考：最初的问题希望线路代码按百分比降序排序，而不是按线路代码值（即线路代码名称）......但在给定的示例中，“按百分比降序”的结果看起来与“升序”相同按名字。” 如果有人想按名称升序查看线路代码，而不考虑百分比，您可以将 ORDER BY 行更改为：

```
ORDER BY home_dept, linecode 
```

# eclipse - 如何禁止 moreunit 自动执行测试？

> ID：10196272
> 
> 赞同：0
> 
> 时间：2012-04-17T17:44:58.010
> 
> 标签：eclipse, junit, mockito

我在 Eclipse 中安装“MoreUnit”作为插件。但是，当启动 Eclipse 时，测试将自动启动。这对我来说是一个问题，因为 CRUD 负责人的测试包括在内。因此，由于这种自动启动，数据库会在一定时间后为空。

如何禁止 moreunit 自动执行测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T10:31:42.860

MoreUnit 是一个辅助单元测试的工具。如果您的测试对数据库做任何事情，它们就不是单元测试。这样做的原因是，如果您使用真实的数据库连接测试您的类，那么您也在测试您的类的数据库。

您应该使用模拟解耦您对数据库的依赖（有关如何执行此操作的想法，请参阅[我的答案）。](https://stackoverflow.com/questions/6049777/mockito-how-to-mock-an-interface-of-jodatime/6060814#6060814)

如果您正在执行数据驱动的测试，那么最好使用[DbUnit](http://www.dbunit.org/)之类的工具来驱动您的测试，而不是依赖于真正的数据库连接。使用这样的工具，您将可以控制每个测试的数据，而不必担心测试会因为其他人更新数据库中的数据或您以“错误的顺序”执行测试而失败。

# image - 比较两个图像/匹配一个复杂的手势

> ID：10196282
> 
> 赞同：0
> 
> 时间：2012-04-17T17:45:51.620
> 
> 标签：image, algorithm, language-agnostic, logic, gesture-recognition

任何人都可以对匹配复杂模式的思维过程提出一些建议。例如，如果我向用户展示一个高音谱号并且他们绘制图案。

我需要生成一个数字，表示该线路与源的接近程度。对于我的示例，我想忽略速度、暂停或其他基于时间的元素，只是最终产品。

我一直在绞尽脑汁和“谷歌”，但没有看到任何有帮助的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T19:17:20.330

我搜索了“Computer Vision Gesture Recognition”，发现了一篇调查该领域的学生[评论论文](http://students.sabanciuniv.edu/~kamer/Magitact/References/Other%20Papers/Vision_Gesture_Recog.pdf)，可能会给你一些有用的参考。

# ruby - Ruby 中 Amazon CloudFront 的私有视频流

> ID：10196288
> 
> 赞同：1
> 
> 时间：2012-04-17T17:46:40.897
> 
> 标签：ruby, amazon-web-services, video-streaming, rtmp, amazon-cloudfront

## 签名 URL 如何用于 Amazon CloudFront 中的流式视频？

我正在使用[aws_cf_signer](https://github.com/stlondemand/aws_cf_signer) gem，但无法为 rtmp 流式传输的 mp4 文件获取签名的 url。对于像 text.txt 这样的静态文件，它可以正常工作，但当我进行流式分发时就不行了。

### 例子：

我有名为 test.mp4 的文件，那么如何从中获取签名的 url `signer.sign()`？

例如`signed_url = signer.sign('rtmp://xyz.cloudfront.net/test', :ending => Time.now + 3600)`，不产生工作 url。我已经用 VLC 播放器测试了 URL 和`rtmpdump`

发行版本身是使用[boto](https://github.com/boto/boto)创建的，如下所示：

> stream_dist = cf.create_streaming_distribution(origin=origin, enabled=True,trusted_signers=["Self"], comment="test distribution")

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T06:20:40.250

根据[AWS：限制最终用户访问](http://docs.amazonwebservices.com/AmazonCloudFront/latest/DeveloperGuide/RestrictingAccessPrivateContent.html#CreatingSignedURL)文档，签名 RTMP url 的格式与 HTTP 不同：

> 使用 HTTP，完整的 URL 唯一地描述了一个对象。您可以在签名中包含 URL。但是，流分发的内容并不总是由有效的 URL 描述。在流式分发中，您仅使用流名称来创建签名。例如，如果您的包含签名的流是：
> 
> `example/mp3_name.mp3?Expires=1258237200&Signature=TBD&Key-Pair-Id=PK12345EXAMPLE`
> 
> RESOURCE 的值为：
> 
> `example/mp3_name`
> 
> 对于流式分发，您不要在策略中为资源名称添加前缀，例如 mp3: 或 mp4:。
> 
> 此外，在引用 MPEG 文件时，您可能必须省略签名中包含的 URL 的文件扩展名。例如，您使用 mp3_name 而不是 mp3_name.mp3。

不幸的是，我不确定 aws_cf_signer gem 是否支持签署 RTMP url。如果你发现了，请告诉我！

# javascript - .draggable().resizable() 不适用于按钮

> ID：10196301
> 
> 赞同：0
> 
> 时间：2012-04-17T17:47:51.757
> 
> 标签：javascript, jquery, jquery-ui, dom

我正在尝试使用 jQuery UI 制作一个可拖动**且**可调整大小的按钮，但它似乎不能同时做到这两点。

```
$('.demo').resizable({grid: 10});
$('.demo').draggable({cancel:false, grid: [ 10,10 ] }); 
```

[这](http://jsfiddle.net/nagwW/5/)是我的代码。

这是一个 jquery ui 错误吗？

编辑：

我错过了一个`</button>`

这是我编辑的版本：http: [//jsfiddle.net/nagwW/13/](http://jsfiddle.net/nagwW/13/)

有没有办法让调整大小的箭头更靠近按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:03:23.847

正如您在[此处的 jsFiddle](http://jsfiddle.net/SpYk3/nagwW/12/)中看到的那样，这似乎确实是一个问题，主要是按钮，可能是由于在 .resizable() 调用时添加了一个包装器。

此外，您可以将任何元素转换为具有 .click 值的按钮，所以为什么不使用 div，它可以同时使用 .resize 和 .drag 0 问题，然后在该 div 上使用 .button 以及 .click。

如果你注意到，我的小提琴正是这样做的

> 更新了你的新东西和我的 div 表示以及 [http://jsfiddle.net/SpYk3/nagwW/25/](http://jsfiddle.net/SpYk3/nagwW/25/)

虽然，现在我考虑了一下，最好不要更改按钮，考虑一下，用户单击按钮将其拖动到某处，拖动完成，突然单击动作被触发并且他们想要的拖动现在一切都搞砸了！这就是为什么 jquery 从来没有打算在按钮上使用这些功能。可能会导致很多头痛，仅供参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-27T13:23:54.077

将您的按钮包裹在一个 div 中并使其可拖动和调整大小，也使您的按钮可调整大小。因此，您将同时拥有这两种效果。

# python - 如何在 Windows 中使用 ttk 主题小部件更改字体

> ID：10196305
> 
> 赞同：1
> 
> 时间：2012-04-17T17:47:59.447
> 
> 标签：python, fonts, styles, widget, ttk

在 OS X 上，`ttk.Style().configure('TLabelframe.label', font='helvetica 14 bold')`用于更改 ttk.LabelFrame 小部件使用的字体。在 Windows 上，`ttk.Style().configure('TLabelframe.label', font='arial 14 bold')`除了将相同的字体信息返回到`ttk.Style().lookup('TLabelframe.label','font')`.

我尝试了不同的字体名称和格式，创建派生样式，使用 TkDefaultFont 并仅更改大小，以及不同的小部件（TButton.label、TCheckbutton.label）。到目前为止，无论我尝试了什么，它似乎总是以默认大小使用 TkDefaultFont。

更改 python27/tcl/tk8.5/ttk/xpTheme.tcl（Windows 上的默认主题）中的字体设置确实会更改显示的字体。从主题设置中删除`-font TkDefaultFont`设置不会更改显示的内容。

关于这实际上如何工作的任何建议？

编辑：我之前没有尝试过更改 Label 小部件的字体，并且那个确实有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T05:18:16.023

看起来对于`ttk.LabelFrame`，您必须创建一个单独的`ttk.Label`小部件，然后使用`labelwidget=`操作数将其分配给 LabelFrame 。您可以在 Label 小部件上设置您想要的任何字体/样式，这将反映在 LabelFrame 中。请注意，您不会为 Label 小部件调用几何管理器。只需实例化它，然后将其分配给 LabelFrame。

`ttk.Checkbutton`这也意味着，如果您想控制 LabelFrame 中子控件的状态，您几乎可以分配您想要的任何小部件，例如 a 。您必须为此编写代码，但在视觉上，它会根据 Checkbutton 的状态启用/禁用子控件。

资料来源：http: [//infohost.nmt.edu/tcc/help/pubs/tkinter/web/ttk-LabelFrame.html](http://infohost.nmt.edu/tcc/help/pubs/tkinter/web/ttk-LabelFrame.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:28:35.790

我相信这方面的代码有问题，会开票。使用'TLableframe.Label'（注意'Label'中的大写'L'有效。'TButton.label'和'TButton.Label'不起作用，但只有'TButton'起作用；'TCheckbutton'是一样的。我是无法使用任何组合更改“TEntry”的字体，包括添加“textarea”。

# c# - 在装配信息中动态显示当前年份

> ID：10196312
> 
> 赞同：14
> 
> 时间：2012-04-17T17:48:43.290
> 
> 标签：c#, vb.net

如何在 AssemblyInfo 文件中设置当前年份？

我用了

而不是这个：

```
<Assembly: AssemblyCopyright("Copyright 2012, Company Name.")> 
```

试过这个：

```
<Assembly: AssemblyCopyright("Copyright" + DateTime.Now.Year.ToString() + ", Company Name.")> 
```

我得到无效的常量错误。

我不想使用注册表项，这样做的最佳方法是什么？（这样当用户右键单击 EXE 并查找程序集信息时可以看到当前年份）。

谢谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-10-11T09:04:35.843

[我在另一篇文章（ https://stackoverflow.com/a/827209/857307](https://stackoverflow.com/a/827209/857307) ）上看到了一些对这里很有帮助的东西。

尝试这个。

将新文件添加到解决方案中所有项目共有的源存储库中。将文件称为 AssemblyCopyright.tt

在文件中，为 c# 添加以下代码

```
<#@ template language="C#" #>
using System;
using System.Reflection;

[assembly: AssemblyCopyright("Copyright © CompanyName <#=DateTime.Now.Year#>")] 
```

或 vb

```
<#@ template language="VB" #>
<#@ output extension=".vb" #>
Imports System
Imports System.Reflection

<Assembly: AssemblyCopyright("Copyright © CompanyName <#=DateTime.Now.Year#>")> 
```

然后，从您的每个 AssemblyInfo.cs 文件中删除 AssemblyCopyright 属性。

最后，将 AssemblyCopyright.tt 文件的链接添加到您的每个项目。

模板文件将在每个具有正确年份的构建上重新创建一个新的 AssemblyCopyright.cs 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-06-04T15:56:43.000

尝试这个：

```
<Assembly: AssemblyCopyright("Copyright $([System.DateTime]::Now.ToString('yyyy')), Company Name.")> 
```

我还没有完全尝试过。[由于我使用此答案](https://stackoverflow.com/a/45248069/209568)`WriteCodeFragment`中描述的a 通过 .csproj 定义了程序集信息的其他部分，所以我也这样做 - 我定义属性

```
 <!-- We started in 2021\.  So, if it's still 2021 we just want to show '2021' -->
  <PropertyGroup Condition="$([System.DateTime]::Now.ToString('yyyy')) == '2021'">
    <CopyrightYears>2021</CopyrightYears>
  </PropertyGroup>
  <!-- But for later years we want a range.  E.g. in 2023 it will show '2021 - 2023' -->
  <PropertyGroup Condition="$([System.DateTime]::Now.ToString('yyyy')) != '2021'">
    <CopyrightYears>2021 - $([System.DateTime]::Now.ToString('yyyy'))</CopyrightYears>
  </PropertyGroup> 
```

然后，在更新程序集信息的任务中，我有一个`ItemGroup`包括

```
<AssemblyAttributes Include="AssemblyCopyright">
  <_Parameter1>"Copyright © $(CopyrightYears) ..."</_Parameter1>
</AssemblyAttributes> 
```

之后`ItemGroup`我在该任务中有以下内容

```
 <MakeDir Directories="$(IntermediateOutputPath)" />
    <WriteCodeFragment Language="C#"
                         OutputFile="$(IntermediateOutputPath)Version.cs"
                         AssemblyAttributes="@(AssemblyAttributes)" />
    <ItemGroup>
        <Compile Include="$(IntermediateOutputPath)Version.cs" />
    </ItemGroup> 
```

您可以用作属性的函数记录[在此处](https://docs.microsoft.com/en-us/visualstudio/msbuild/property-functions?view=vs-2019)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T17:55:27.490

[最好的方法可能是使用NAnt](http://nant.sourceforge.net/)或[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)等工具将其集成到您的构建过程中。

这是一篇解释如何使用 MSBuild 更改 AssemblyInfo 的文章：使用[版本号](http://weblogs.asp.net/srkirkland/archive/2010/12/07/simple-msbuild-configuration-updating-assemblies-with-a-version-number.aspx)更新程序集。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T17:55:55.683

您可以使用 NANT/MSBuild 任务来修改 AssemblyInfo.cs 文件，就像我们为每个构建更改每个程序集的版本一样。

有关更多信息，请访问[http://msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-17T17:56:35.687

通常，对于这种替换，您使用一个预构建步骤，该步骤调用一个自动生成您的 assemblyInfo.cs 文件的脚本。

你可以看看这个线程：[How can you find and replace text in a file using the Windows command-line environment？](https://stackoverflow.com/questions/60034/how-can-you-find-and-replace-text-in-a-file-using-the-windows-command-line-envir)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-17T00:22:54.150

我有类似的问题，但是对于新样式的 csproj 文件；包含文件版本信息。我在这里找到了一个很好的答案[How to define current system date in post build event](https://stackoverflow.com/questions/25484523/how-to-define-current-system-date-in-post-build-event)。奇怪的是，这是一个与我和 OP 问题有些不同的问题。但是，我认为接受的答案就是我想要的。即，csproj 文件中的 $([System.DateTime]::Now.Year) 计算为当前年份。

# jquery - jQuery - 当我选中任何复选框时如何发送表单？

> ID：10196313
> 
> 赞同：-1
> 
> 时间：2012-04-17T17:48:48.663
> 
> 标签：jquery, forms, checkbox

我有一个表格，其中大约有 10 个复选框。当我想在检查一些复选框后发送表单时，我这样做：

```
$('input#checkbox1').live("click", function() {
    $('#my_form').submit();
}); 
```

怎么办，如果我选中任何复选框，那么表格将被发送？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:50:48.827

`$('input[type=checkbox]')`而不是`$('input#checkbox1')`应该帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T06:39:08.427

每次您选中/取消选中任何复选框时，此代码都会提交。

```
$(document).on("click", ":checkbox", function() {
   $('#my_form').submit();
}) 
```

此代码仅在任何复选框上检查

```
$(document).on("click", ":checkbox", function() {
   if ( $(this).is(":checked") ) {
      $('#my_form').submit();
   }
}) 
```

如果要过滤以使其不附加到所有复选框，请考虑将类添加到指定的复选框，然后使用类似这样的内容

```
$(document).on("click", ".sendFormCheckbox", function() {
    $('#my_form').submit();
}); 
```

# bufferedimage - SwingWorkers 生成的 BufferedImage 不显示

> ID：10196318
> 
> 赞同：1
> 
> 时间：2012-04-17T17:48:57.333
> 
> 标签：bufferedimage, swingworker

我正在我的 GUI 中创建一个著名的 Mandelbrot Fractal，为了加快创建图像的速度，我决定使用 Swing Workers。在 doInBackground() 方法中，我正在计算每个像素的颜色，并将所有颜色放入数组中。在 done() 方法中，我正在访问数组并用适当的颜色为每个像素着色。这种方式在 EDT 中完成着色时，在不同的线程中完成大量计算。我只有一个问题 - 没有显示准​​备好的图片，即使我知道它们存储在 BufferedImage 中（我可以将文件保存到我的硬盘驱动器，直接访问 BufferedImage，或者 - 在缩放时 - 我正在创建一个深层副本BufferedImage - 在这种情况下，我可以看到正确的图像）。我对 Java 很陌生，但我希望我的应用程序尽可能好。我的代码在下面和这里：[http://pastebin.com/M2iw9rEY](http://pastebin.com/M2iw9rEY)

```
public abstract class UniversalJPanel extends JPanel{

    protected BufferedImage image;
    protected Graphics2D g2d;

    protected int iterations = 100; // max number of iterations
    protected double realMin = -2.0; // default min real
    protected double realMax = 2.0;// default max real
    protected double imaginaryMin = -1.6; // default min imaginary
    protected double imaginaryMax = 1.6;// default max imaginary
    protected int panelHeight;
    protected int panelWidth;
    protected Point pressed, released; // points pressed and released - used to calculate drawn rectangle
    protected boolean dragged; // if is dragged - draw rectangle
    protected int recWidth, recHeight,xStart, yStart; // variables to calculate rectangle
    protected FractalWorker[] arrayOfWorkers; // array of Swing workers

    public abstract int calculateIterations(Complex c);
    public abstract double getDistance(Complex a, Complex b);

    public void paintComponent(Graphics g){
        super.paintComponent(g);
        panelHeight = getHeight();
        panelWidth = getWidth();
        image =new BufferedImage(getWidth(), getHeight(), BufferedImage.TYPE_INT_ARGB); // creating new Bufered image
        g2d= (Graphics2D) image.getGraphics();

        arrayOfWorkers= new FractalWorker[getHeight()]; // create new worker for each row and execute them
         for(int q = 0; q < getHeight(); q++ ){
                arrayOfWorkers[q] = new FractalWorker(q);
                arrayOfWorkers[q].execute();
        }

        g.drawImage(image, 0, 0, null); // draw an image

    }   

// *** getters, setters, different code//

private class FractalWorker extends SwingWorker<Object, Object>{
    private int y;  // row on which worker should work now
    private Color[] arrayOfColors; // array of colors produced by workers
    public FractalWorker( int z){
        y = z;      
    }
    protected Object doInBackground() throws Exception {

        arrayOfColors = new Color[getWidth()];

        for(int q=0; q<getWidth(); q++){ // calculate and insert into array proper color for given pixel
            int iter = calculateIterations(setComplexNumber(new Point(q,y))); 
            if(iter == iterations){
                arrayOfColors[q] = Color.black;
            }else{
                arrayOfColors[q] = Color.getHSBColor((float)((iter/ 20.0)), 1.0f, 1.0f );
            }
        }           
        return null;
    }
    protected void done(){ // take color from the array and draw pixel
        for(int i = 0; i<arrayOfColors.length; i++){            
            g2d.setColor(arrayOfColors[i]);
            g2d.drawLine(i, y, i, y);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:01:18.653

当您调用 g.drawImage(...) 时，图像的当前内容被绘制到组件中。那时 SwingWorkers 还没有完成他们的工作，因为您在 drawImage 调用之前立即启动它们。您不应该在 paintComponent 方法中启动 SwingWorkers，如果已收到绘画请求，则开始漫长的绘图过程为时已晚。

更好的解决方案可能是在程序启动时创建 BufferedImage，然后在组件大小发生变化时重新创建它。然后，您应该在需要重绘时启动 SwingWorker，并在它们完成绘图后调用组件上的 repaint()。

# c# - 我的循环选择列表中的 MVC 3 控制器语法错误

> ID：10196321
> 
> 赞同：1
> 
> 时间：2012-04-17T17:49:12.520
> 
> 标签：c#, asp.net, asp.net-mvc-3

我的语法在我的控制器内创建一个月内几天的选择列表时遇到了一些问题。我得到了几个月和几年的工作，但是 for 循环给我带来了一些麻烦。

Visual Studio 给我的错误是：“Invalid initializer member declarator”和“名称 Days 在当前上下文中不存在。”

视图模型

```
public class DateSearchViewModel
{
    public int SelectedMonth { get; set; }
    public IEnumerable<SelectListItem> Months { get; set; }
    public int SelectedDay { get; set; }
    public IEnumerable<SelectListItem> Days { get; set; }
    public int SelectedYear { get; set; }
    public IEnumerable<SelectListItem> Years { get; set; }
} 
```

控制器

```
 [ChildActionOnly]
    public ActionResult _Header()
    {
        var DateVM = new DateSearchViewModel
        {
            //Set selected value of month.
            SelectedMonth = 5,
            Months = new List<SelectListItem> 
            {
                new SelectListItem {Text = "Jan", Value = "1"},
                new SelectListItem {Text = "Feb", Value = "2"},
                new SelectListItem {Text = "Mar", Value = "3"},
                new SelectListItem {Text = "Apr", Value = "4"},
                new SelectListItem {Text = "May", Value = "5"},
                new SelectListItem {Text = "Jun", Value = "6"},
                new SelectListItem {Text = "Jul", Value = "7"},
                new SelectListItem {Text = "Aug", Value = "8"},
                new SelectListItem {Text = "Sep", Value = "9"},
                new SelectListItem {Text = "Oct", Value = "10"},
                new SelectListItem {Text = "Nov", Value = "11"},
                new SelectListItem {Text = "Dec", Value = "12"},
            },

            //Set selected value of Day.
            SelectedDay = 13,
            Days = new List<SelectListItem>
            {
                for (var i = 1; i <= 31; i++)
                {
                    Days.Add(new SelectListItem { Text = i.ToString(), Value = i.ToString()});
                }
            },

            //Set selected value of Year.
            SelectedYear = 2010,
            Years = new List<SelectListItem> 
            {
                new SelectListItem {Text = "2009", Value = "2009"},
                new SelectListItem {Text = "2010", Value = "2010"},
                new SelectListItem {Text = "2011", Value = "2011"},
                new SelectListItem {Text = "2012", Value = "2012"},
            }
        };

        return PartialView(DateVM);
    } 
```

视图模型：

```
@Html.DropDownListFor(x => x.SelectedMonth, Model.Months) / @Html.DropDownListFor(x => x.SelectedDay, Model.Days) / @Html.DropDownListFor(x => x.SelectedYear, Model.Years) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:54:35.813

正如编译器试图告诉你的那样，你不能这样做。
初始化器只能包含表达式。

相反，您可以使用 LINQ：

```
Days = Enumerable.Range(1, 31)
                 .Select(i => new SelectListItem { Text = i.ToString() })) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T17:52:51.333

您不能在初始化程序中放置循环：

```
Days = new List<SelectListItem>
{
    for (var i = 1; i <= 31; i++)
    {
        Days.Add(new SelectListItem { Text = i.ToString(), Value = i.ToString()});
    }
}, 
```

因此，只需实例化它并稍后使用循环：

```
var DateVM = new DateSearchViewModel 
{
    ...
    Days = new List<SelectListItem>(),
    ...
}

for (var i = 1; i <= 31; i++)
{
    DateVM.Days.Add(new SelectListItem { Text = i.ToString(), Value = i.ToString()});
} 
```

# javascript - 当用户离开页面时，如何保存无限堆栈的 AJAX 内容？

> ID：10196323
> 
> 赞同：11
> 
> 时间：2012-04-17T17:49:22.060
> 
> 标签：javascript, ajax, infinite-scroll

我正在制作一个无限滚动的网站。也就是说，当用户滚动到页面底部时，一个新的内容块会附加到底部。它与 Facebook 非常相似。这是加载 3 个页面的示例：

```
 _________
|         |
|    0    |
|_________|
|         |
|    1    |
|_________|
|         |
|    2    |
|_________| 
```

当用户单击最后一页上的某些内容时，我会将他们带到单独的详细信息页面。但是如果用户点击返回搜索结果页面，我不记得他们以前的位置，必须再次加载第 0 页。

```
 _________
|         |
|    0    |
|_________| 
```

我知道一些解决这个问题的老派方法，但它们都有一些严重的问题：

# 哈希网址

每次加载新页面时，我都可以更新 URL。例如：www.website.com/page#2。当用户转到详细信息页面并返回时，URL 告诉我最后加载的页面，所以我为他加载它：

```
 _________
|         |
|    2    |
|_________| 
```

但这是糟糕的用户体验。仅加载第 2 页。用户无法向上滚动以查看较旧的内容。考虑到后退按钮占网络流量的 50%（雅各布尼尔森研究），我不能只加载页面 0、1 和 2，因为这会使服务器过载。

# 本地存储

Cookie 没有存储多页数据的存储容量。[本地存储](https://developer.mozilla.org/en/DOM/Storage)应该有足够的空间。一种想法是将所有加载的页面存储到本地存储中。当用户返回搜索结果时，我从本地存储加载而不是访问服务器。这种方法的问题是我的大部分用户都使用不[支持本地存储](http://caniuse.com/#feat=namevalue-storage)（IE7）的浏览器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:28:47.957

鉴于您的问题的限制，我能想到的唯一可行的解​​决方案是缓存前一页的高度，然后在用户向上滚动时加载它们。这将填充您的向上滚动并允许您在用户查找时触发负载。此外，如果您想更花哨一点，我会尝试找出一种冻结滚动条的方法，以防止用户向上滚动到上一个未加载的页面。这样他们就不能一次触发多个页面加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:48:54.313

与其将用户完全带到一个单独的详细信息页面，不如直接隐藏主滚动内容，通过 Ajax / 加载详细内容`XMLHttpRequest()` ，然后使该内容可见？换句话说，就像 Facebook 的做法一样。我想你是否能做到这一点取决于内容是什么，以及它是你正在设计和控制的东西，还是外部的东西。

# windows-installer - 在 InstallShield 中通过用户交互执行自定义操作（基本 MSI 项目）

> ID：10196325
> 
> 赞同：1
> 
> 时间：2012-04-17T17:49:35.510
> 
> 标签：windows-installer, installshield, installshield-2012

我正在使用 InstallShield 2012 Professional 创建一个基本的 MSI 项目。我的问题涉及如何执行由用户与对话框交互引起的自定义操作。

我一直在做研究，但我只是没有得到正确的设置组合来使它工作。我已经执行了自定义操作，但在它甚至获得用户交互之前。

安装完成后，显示标准的“SetupCompleteSuccess”对话框，我添加了一个复选框，以便用户在单击完成按钮时除了启动程序之外还可以选择查看一些 html 发行说明。程序启动完美，并在项目助手向导中设置。

![对话框中的复选框设置](../Images/403316832445a8ecc3006ce2f5313138.png)

在对话框中，我设置复选框以将属性 LAUNCHRELEASENOTES 设置为 1。在对话框行为中，如果条件 LAUNCHRELEASENOTES=1 为真，我在 Finish（又名 OK）按钮中设置 DoAction 以执行自定义操作“OpenReleaseNotes”。

![按钮行为。](../Images/cc1a45120884e8c9e71824ad1e2a6dde.png)

在我创建的“OpenReleaseNotes”自定义操作中，我可能弄乱了配方，我正在使它启动一个可执行文件（在这种情况下 cmd.exe 只是为了调用 DOS 命令）来打开 html 发行说明。我完全不清楚自定义操作中需要设置哪些设置组合才能在安装结束时通过用户交互执行。

![自定义操作](../Images/eacc96670a680d5e643584b06418e8cc.png)

应该如何为自定义操作设置这些？

*   退货处理
*   脚本内执行
*   执行调度
*   安装 UI 序列
*   安装执行序列
*   安装执行条件（如果适用）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:15:28.743

ControlEvents 有一个操作顺序。右键单击“EndDialog”控件事件并选择向下移动以使其在您的自定义操作后执行。

# jquery - jquery datetime 选择器插件默认时间

> ID：10196326
> 
> 赞同：7
> 
> 时间：2012-04-17T17:49:37.913
> 
> 标签：jquery, jquery-ui, jquery-plugins

所以默认的默认时间（不是说日期）是上午 12:00，我如何将其设置为其他时间？

谈论这个插件[http://trentrichardson.com/examples/timepicker/](http://trentrichardson.com/examples/timepicker/)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-17T17:52:54.437

这直接来自您发布的链接上的文档。

```
$('#example7').datetimepicker({
    hour: 13,
    minute: 15
}); 
```

# api - 超出 API 配额

> ID：10196329
> 
> 赞同：4
> 
> 时间：2012-04-17T17:49:54.467
> 
> 标签：api, foursquare

在文档中，我们可以找到`The limits are based on a moving window that tracks the number of requests you send per hour.`（https://developer.foursquare.com/overview/ratelimits），但在实践中，即使我等待几分钟，我的速率限制也不会被充电。

发生了什么？他们是否改变了 API 速率限制的实现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T18:57:33.317

窗口仍应实时更新。

需要明确的是，如果您的速率限制为 500，则在 11:00，您发送 5 个请求，X-RateLimit-Remaining 将为 495。如果您等待几分钟到 11:05，然后发送另一个请求，X-Rate - 剩余限制将是 494 - 它还没有重置。

直到 12:01，您才会取回您在 11:00 发出的 5 个请求。因此，如果您在 12:01 再次请求，您的限制将为 498（-1 表示您刚刚发出的请求，-1 表示 11:05 的请求）。在 12:06 再次请求，您将恢复到 499（完全限制，减去您刚刚使用的）。

# tsql - 检测到事务中的错误，而不仅仅是最后的操作错误

> ID：10196334
> 
> 赞同：0
> 
> 时间：2012-04-17T17:50:10.367
> 
> 标签：tsql, sql-server-2008-r2

识别事务错误的最优雅方法是什么？这时我的代码是这样的：

```
begin transaction tx1
update ....
insert ....
if @@error = 0
   commit
else
   rollback
end 
```

这只捕获最后一个操作错误，在这种情况下插入错误但不是第一个操作错误，在我的情况下，更新错误。如何改进我的代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T17:54:48.890

你看过`TRY`/`CATCH`吗？

[http://msdn.microsoft.com/en-us/library/ms175976.aspx](http://msdn.microsoft.com/en-us/library/ms175976.aspx)

`CATCH`当然，如果您执行以下操作，您仍然只能捕获导致您进入的第一个错误：

```
BEGIN TRANSACTION; -- not sure why you're using a named transaction

BEGIN TRY
  UPDATE ...
  INSERT ...
  COMMIT TRANSACTION;
END TRY
BEGIN CATCH
  PRINT ERROR_MESSAGE();
  ROLLBACK TRANSACTION;
END CATCH 
```

但是您可以将每个操作包装在自己的`TRY`/`CATCH`中，例如

```
BEGIN TRANSACTION; -- still not sure why you're using a named transaction

BEGIN TRY
  UPDATE ...
  COMMIT TRANSACTION;
END TRY
BEGIN CATCH
  PRINT ERROR_MESSAGE();
  ROLLBACK TRANSACTION;
END CATCH

BEGIN TRANSACTION;

BEGIN TRY
  INSERT ...
  COMMIT TRANSACTION;
END TRY
BEGIN CATCH
  PRINT ERROR_MESSAGE();
  ROLLBACK TRANSACTION;
END CATCH 
```

但是我不确定您要在这里遵循什么规则...如果更新失败，您是否希望插入成功？如果您希望所有操作作为一个组成功或失败，那么您需要第一种方法，即所有操作都在一个`TRY`.

您还应该查看 Erland Sommarskog 关于错误处理的圣经：

[http://www.sommarskog.se/error_handling_2005.html](http://www.sommarskog.se/error_handling_2005.html)

# mysql - 如何修复此 DELETE 查询？

> ID：10196336
> 
> 赞同：0
> 
> 时间：2012-04-17T17:50:18.797
> 
> 标签：mysql

我有两个表：products(product_id,date) 和 sex(product_id,sex)。

我想从 products 表中删除所有具有 product_id 的产品，在该 product_id 和 sex=1 的 sex 表中存在一行。

我还希望从 sex 表中删除包含 product_id 的所有行，这些行包含在我从 products 表中删除的行之一中。（这可能会删除每个 product_id 的多行。）

到目前为止我有

```
DECLARE @recordsToDelete AS TABLE(
int product_id
);

INSERT INTO @recordsToDelete( product_id )
SELECT product_id 
FROM products p
   JOIN sex s
     ON p.product_id = s.product_id
WHERE s.sex = 1; 
```

然后我会用

```
SELECT * FROM @recordsToDelete; 
```

在执行之前

```
DELETE FROM products 
WHERE product_id IN ( SELECT product_id FROM @recordsToDelete );

DELETE FROM sex
WHERE product_id IN ( SELECT product_id FROM @recordsToDelete ); 
```

但 DECLARE 语句给了我一个语法错误。我[在这里](http://dev.mysql.com/doc/refman/5.0/en/declare.html)注意到 DECLARE 需要一个 BEGIN/END 复合语句，但我无法正确地制定它。我怎样才能纠正我的错误？

编辑：

通过固定

```
CREATE TEMPORARY TABLE recordsToDelete(
product_id INT
);# MySQL returned an empty result set (i.e. zero rows).
INSERT INTO recordsToDelete( product_id ) 
SELECT p.product_id
FROM products p
JOIN sex s ON p.product_id = s.product_id
WHERE s.sex =1;# Affected rows: 275
SELECT * 
FROM recordsToDelete; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:57:13.430

我认为您正在寻找`CREATE TEMPORARY TABLE`创建表而不是`DECLARE`.

有关在 MySQL 中创建表的更多信息，请参阅[此页面](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)。

您使用的语法似乎适用于 MS SQL 服务器，而不是 MySQL。在 MySQL 中，[`DECLARE`](http://dev.mysql.com/doc/refman/5.0/en/declare.html)用于局部变量、条件、处理程序和游标，但**不**用于创建表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:06:44.400

试试这个？

```
CREATE TEMPORARY TABLE tempTable
      SELECT product_id  
        FROM products AS p
  INNER JOIN sex AS s
          ON p.product_id = s.product_id 
       WHERE s.sex = 1;

 DELETE FROM products AS p
NATURAL JOIN tempTable AS t
       WHERE p.product_id = t.product_id; 
```

顺便说一句，你不能`DELETE FROM same_table (SELECT * FROM same_table)`。

我引用：
`Currently, you cannot delete from a table and select from the same table in a subquery.`

[http://dev.mysql.com/doc/refman/5.5/en/delete.html](http://dev.mysql.com/doc/refman/5.5/en/delete.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T18:20:40.087

我认为你可以从一个简单的多表删除中得到你想要的：

```
delete sex, products from products p 
inner join sex s on p.id=s.product_id
where s.sex=1 
```

你也可以考虑`on cascade delete`在你的桌子上使用：http: [//dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)

# excel - 删除列包含0的整行，Excel 2007 VBA

> ID：10196338
> 
> 赞同：0
> 
> 时间：2012-04-17T17:50:20.217
> 
> 标签：excel, vba

更新：

好的，所以我使用了下面的代码，它完成了我需要它做的事情，即检查值是否为 0，如果是，则删除整行。但是，我想一次对一个工作簿中的多个工作表执行此操作。以下代码所做的是它仅从当前电子表格中删除零，当您通过 VBA 脚本打开 excel 时，默认情况下该电子表格处于活动状态。这里是工作零删除代码：

```
Dim wsDCCTabA As Excel.Worksheet
Dim wsTempGtoS As Excel.Worksheet

Set wsDCCTabA = wbDCC.Worksheets("Login")
Set wsTempGtoS = wbCalc.Worksheets("All_TemporaryDifferences")

Dim LastRow As Long, n As Long
LastRow = wsTempGtoS.Range("E65536").End(xlUp).Row
For n = LastRow To 1 Step -1
If Cells(n, 5).Value = 0 Then
    Cells(n, 5).EntireRow.Delete
End If
Next 
```

我究竟做错了什么？当我对同一个工作簿中的另一个工作表做同样的事情时，它什么也没做。我正在使用以下代码从另一个工作表中删除零：

```
Set wsPermGtoS = wbCalc.Worksheets("All_PermanentDifferences")
'delete rows with 0 description  
Dim LastRow As Long, n As Long
LastRow = wsPermGtoS.Range("E65536").End(xlUp).Row
For n = LastRow To 1 Step -1
If Cells(n, 5).Value = 0 Then
    Cells(n, 5).EntireRow.Delete
End If
Next 
```

有什么想法吗？或做同样事情的另一种方式？

原始问题：

我想删除所有在特定列中为零的行。我正在使用以下代码，但似乎什么也没发生：

```
 CurrRow = (Range("E65536").End(xlUp).Row)
 For Count = StartRow To CurrRow
     If wsDCCTabA.Range("E" & Count).Value = "0" Then
         wsDCCTabA.Rows(Count).Delete
     End If
 Next 
```

`StartRow`包含起始行值 `CurrRow`包含最后使用的行的行值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:05:52.093

看看这是否有帮助：

```
Sub DelSomeRows()

    Dim colNo As Long:      colNo = 5             ' hardcoded to look in col 5
    Dim ws    As Worksheet: Set ws = ActiveSheet  ' on the active sheet

    Dim rgCol As Range
    Set rgCol = ws.Columns(colNo)                          ' full col range (huge)
    Set rgCol = Application.Intersect(ws.UsedRange, rgCol) ' shrink to nec size
    Dim rgZeroCells As Range ' range to hold all the "0" cells (union of disjoint cells)
    Dim rgCell      As Range ' single cell to iterate
    For Each rgCell In rgCol.Cells
        If Not IsError(rgCell) Then
            If rgCell.Value = "0" Then
                If rgZeroCells Is Nothing Then
                    Set rgZeroCells = rgCell ' found 1st one, assign
                Else
                    Set rgZeroCells = Union(rgZeroCells, rgCell) ' found another, append
                End If
            End If
        End If
    Next rgCell
    If Not rgZeroCells Is Nothing Then
        rgZeroCells.EntireRow.Delete ' deletes all the target rows at once
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:54:37.007

我知道了。为了将来参考，我使用了

```
ActiveWorkbook.Sheets("All_temporaryDifferences").Activate 
```

和

```
ActiveWorkbook.Sheets("All_Permanentdifferences").Activate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T06:00:54.303

删除一行后，您需要减去“计数”变量

```
CurrRow = (Range("E65536").End(xlUp).Row)
For Count = StartRow To CurrRow
    If wsDCCTabA.Range("E" & Count).Value = "0" Then
        wsDCCTabA.Rows(Count).Delete
        ' Add this line:
        Count = Count - 1
    End If
Next 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-23T00:05:53.247

你不需要使用`ActiveWorkbook.Sheets("All_temporaryDifferences").Activate`. 实际上，如果与您`ActiveWorkbook`不同，`wbCalc`则会出现错误。

您真正的问题是您使用的是对`Cells(n, 5).Value`. 不合格意味着您没有指定要使用的工作表，因此它默认为活动工作表。这有时可能有效，但它是糟糕的代码。在你的情况下它没有工作。

相反，您应该始终使用合格的引用。`wsTempGtoS.Cells(n, 5).Value`是合格的参考。`wsTempGtoS`指定您想要的工作表，这样 VBA 就不会被猜测。

```
Dim LastRow As Long, n As Long
LastRow = wsTempGtoS.Range("E65536").End(xlUp).Row
For n = LastRow To 1 Step -1
    If wsTempGtoS.Cells(n, 5).Value = 0 Then
        wsTempGtoS.Cells(n, 5).EntireRow.Delete
    End If
Next 
```

这：`CurrRow = (Range("E65536").End(xlUp).Row)`也是一个不合格的参考。相反，它应该是`CurrRow = wsDCCTabA.Range("E65536").End(xlUp).Row`.

# asp.net - 确保唯一的用户名

> ID：10196340
> 
> 赞同：0
> 
> 时间：2012-04-17T17:50:27.607
> 
> 标签：asp.net, sql, tsql, asp.net-membership

Asp.net 会员 2.0。

我想更新表 aspnet_user 中的用户名，最好的方法是直接更新表。

```
UPDATE aspnet_Users SET UserName = @UserName,LoweredUserName = LOWER( @UserName) 
WHERE UserName = @CurrentUname 
```

如何确保它是唯一的？

谢谢，

**更新：** `If not exist (select UserName from aspnet_Users) Begin UPDATE aspnet_Users SET UserName = @UserName,LoweredUserName = LOWER( @UserName)
WHERE UserName = @CurrentUname
End`

如何修改上面的代码？

**第二次更新：**

```
If not exist (select UserName from aspnet_Users WHERE UserName = @CurrentUname)
Begin 
  UPDATE aspnet_Users SET UserName = @UserName,LoweredUserName = LOWER( @UserName)
WHERE UserName = @CurrentUname
End
SELECT 1;
else
select 0; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T17:53:03.377

在用户名列上创建唯一索引。

就像是：

```
CREATE UNIQUE INDEX index_username
ON aspnet_Users (UserName) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T17:53:28.550

在数据库中的列上放置唯一约束。然后在尝试更新之前检查现有用户名，或者捕获异常并相应地处理它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T18:25:01.757

除了@Icarus 和@Pete M 回复。这些已经是很好/值得信赖的建议。

另一种选择是，您可以使用**[TransactionScope](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)**吗？

**伪代码**

```
using (TransactionScope scope = new TransactionScope())
{
    UPDATE aspnet_Users 
    SET    UserName = @UserName,
           LoweredUserName = LOWER( @UserName) 
    WHERE  UserName = @CurrentUname

    if((select count(userName) 
        From   aspnet_Users
        Where  userName = @CurrentUname) = 1)
    Begin
         scope.Complete
    End
} 
```

上述方法保持独立`session of the request`，`Transaction`并使其`isolated`免受其他用户的其他请求。

# java - Hash Set 和 Array List 的表现

> ID：10196343
> 
> 赞同：42
> 
> 时间：2012-04-17T17:50:42.490
> 
> 标签：java, performance, algorithm, arraylist, hashset

我已经实现了一种方法，它简单地循环一组包含许多不同模块上的数据的 CSV 文件。然后将“moduleName”添加到 hashSet 中。（代码如下所示）

我使用了 hashSet，因为它保证不会插入重复项，而不是 ArrayList，后者必须使用 contains() 方法并遍历列表以检查它是否已经存在。

我相信使用哈希集比数组列表具有更好的性能。我这样说正确吗？

另外，有人可以向我解释一下：

1.  如果使用每个数据结构的性能如何？
2.  使用大 O 表示法的复杂度是多少？

    ```
    HashSet<String> modulesUploaded = new HashSet<String>();

    for (File f: marksheetFiles){
        try {
            csvFileReader = new CSVFileReader(f);
            csvReader = csvFileReader.readFile();
            csvReader.readHeaders();

            while(csvReader.readRecord()){
                String moduleName = csvReader.get("Module");

                if (!moduleName.isEmpty()){
                    modulesUploaded.add(moduleName);
                }
            }

        } catch (IOException e) {
            e.printStackTrace();
        }

        csvReader.close();
    }
    return modulesUploaded; 
    ```

    }

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-11-07T16:19:08.833

[我的实验](https://github.com/chaschev/experiments-with-microbes/blob/master/src/main/java/stackoverflow/q6462055/HashMapVsListMicrobe.java#L25)表明，这`HashSet`比`ArrayList`从包含 3 个元素的集合开始要快。

完整的结果表

```
| Boost  |  Collection Size  |
|  2x    |       3 elements  |
|  3x    |      10 elements  |
|  6x    |      50 elements  |
|  12x   |     200 elements  |  <= proportion 532-12 vs 10.000-200 elements
|  532x  |  10.000 elements  |  <= shows linear lookup growth for the ArrayList 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-04-17T18:07:42.420

它们是完全不同的类，所以问题是：你想要什么样的行为？

`HashSet`确保没有重复，为您提供 O(1)`contains()`方法但不保留顺序。
`ArrayList`不确保没有重复，`contains()`是 O(n) 但您可以控制条目的顺序。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-04-17T18:10:33.137

> 我相信使用哈希集比数组列表具有更好的性能。我这样说正确吗？

有很多（无论是什么意思）条目，是的。但是，对于较小的数据大小，原始线性搜索可能比散列更快。盈亏平衡点在哪里，你必须衡量。我的直觉是，如果元素少于 10 个，线性查找可能会更快；超过 100 个元素的散列可能更快，但这只是我的感觉......

如果元素的 hashCode 实现是健全的，从 HashSet 中查找是恒定的时间，O(1)。从列表中线性查找是线性时间，O(n)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-03-05T12:55:36.290

这取决于数据结构的使用。

您将数据存储在 中`HashSet`，并且对于您的情况，存储`HashSet`比`ArrayList`（因为您不希望重复条目）更好。但仅仅存储并不是通常的意图。

这取决于您希望如何读取和处理存储的数据。如果您想要顺序访问或基于随机索引的访问，那么`ArrayList`更好，或者如果排序无关紧要，那么`HashSet`更好。

如果排序很重要，但您想进行大量修改（添加和删除），LinkedList 会更好。

访问特定元素`HashSet`的时间复杂度为 O (1)，如果您使用`ArrayList`它，它会是 O (N)，正如您自己指出的那样，您必须`iterate`通过列表查看该元素是否不存在。

# ios - 我的应用程序冻结但没有出现错误

> ID：10196344
> 
> 赞同：36
> 
> 时间：2012-04-17T17:50:43.427
> 
> 标签：ios, debugging, xcode-instruments

有没有人知道我的应用程序是否冻结我必须检查什么？我的意思是，我可以在 iPad 屏幕上看到该应用程序，但没有按钮响应。当我单击按钮时，我尝试过调试代码，但我还没有看到任何东西。我正在阅读有关 Instruments 工具的信息；具体如何使用它们？

有谁能够帮助我？我只需要解释如何使用这些工具。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-04-17T17:57:39.033

听起来您以某种方式阻止了主线程。要调试，请在调试器中运行应用程序，当应用程序冻结时，点击 Xcode 底部日志区域上方的暂停按钮。然后在左侧，您将能够准确地看到每个线程在做什么，并且您可以看到它卡在哪里。

[![暂停按钮](../Images/741d0107609009ee900052ecf1a57ff6.png)](https://i.stack.imgur.com/utV2J.png)

可能是主线程上的长循环或同步死锁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-12-21T08:19:14.917

最佳答案是正确的。您可以使用“暂停”选项进行调试。阻塞主线程的最常见方法是调用`dispatch_sync`您调度的同一线程。有时您从`dispatch_once`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-09T00:56:41.057

除了暂停和跟踪堆栈跟踪之外，我认为还有一件事要做，就是检查代码是否有任何导致应用程序冻结的循环。

我最近遇到了类似的问题，但堆栈跟踪并没有太大帮助，我发现在调用`reloadData()`内部 layoutsubviews 方法时我有一个永恒的循环，这导致了没有错误的冻结，也没有仪器的帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-04T20:53:54.467

我的项目中有类似的情况，原因是另一个开发人员添加了`setNeedsLayout()`内部方法`layoutSubviews()`，这会导致无限循环并冻结应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-22T05:50:28.433

同样的问题发生在我的 ios 13.4 上，然后我尝试了上述解决方案，但没有解决，所以我尝试在编译时有一个带有中断约束的元素。因此，在解决约束后，我尝试解决了我的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-03-03T10:16:26.763

我建议检查你的尺寸，特别是在集合视图中，如果它们不合适，它们会冻结你的应用程序并检查你的约束

# ruby - rhotoalbum for ruby on rails

> ID：10196348
> 
> 赞同：0
> 
> 时间：2012-04-17T17:51:02.880
> 
> 标签：ruby, ruby-on-rails-3.1

任何人都知道 Rhotoalbum：[http:](http://rhotoalbum.rubyforge.org/) //rhotoalbum.rubyforge.org/ 。这个画廊示例看起来非常好，但在网站上没有很好的信息如何将此画廊添加到我的 ruby​​ on rails 项目中。我是 ruby​​ on rails 的初学者，所以有人可以帮助或指出好的信息来源吗？顺便说一句，我在 rails 3.2.1 上使用 ruby​​。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:00:01.583

我可能会在本地运行 Rhotoalbum，然后将您的图片存储在 public/pictures 目录中。然后运行 ​​Rhotoalbum 创建缩略图等。使用 Git 将它们添加到 Rails 项目中，然后在下次部署 Rails 应用程序时，它会在[http://hostname.com/pictures/上提供图片](http://hostname.com/pictures/)

# security - 图像清理库

> ID：10196351
> 
> 赞同：5
> 
> 时间：2012-04-17T17:51:14.330
> 
> 标签：security, png, jpeg, gif

我有一个显示用户提交的图像的网站。我担心一些聪明人上传的图片可能会利用浏览器渲染引擎中的一些 0-day 漏洞。此外，我想清除元数据的图像（如 EXIF 数据），并尝试以无损方式进一步压缩它们（PNG 和 JPEG 有几个这样的命令行实用程序）。

考虑到上述情况，我的问题如下：是否有一些 C/C++ 库可以满足上述情况？即使**解析->清除->清理->压缩->写入**的完整管道 在任何单个库中都不可用，我是否至少可以在其中实现 **解析->清除->清理->写入**管道（不压缩）支持 JPEG/PNG/GIF 的库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T18:28:52.920

您的要求无法满足：如果您使用的图像读取库之一存在 0-day 漏洞，那么您的代码在尝试解析和清理传入文件时可能会被利用。通过在接收到图像后立即进行“预清理”，您只会更早地而不是更晚地移动利用点。

唯一有帮助的是在沙箱中解析和清理传入的图像，这样至少，如果存在漏洞，它将包含在沙箱中。沙箱可以是一个单独的进程，在`chroot`环境（或虚拟机，对于非常偏执的人）中作为非特权用户运行，其接口仅包含字节流输入和经过清理的图像输出。

清理本身可以很简单，例如使用[ImageMagick](http://www.imagemagick.org/script/index.php)打开图像，将其解码为光栅，然后重新编码并以标准格式（例如 PNG 或 JPEG）发出它们。请注意，如果输入和输出都是有损格式（如 JPEG），则此转换将是有损的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-16T22:56:08.683

*我知道，我迟到了 9 年，但是...*

您可以使用类似于 Qubes OS 中[的 PDF sanitizer](https://github.com/QubesOS/qubes-app-linux-pdf-converter)的想法，它将 PDF 复制到一次性虚拟机，运行 PDF 解析器，将 PDF 转换为基本上 TIFF 图像，这些图像被发送回原始 VM 并在那里重新组合成 PDF . 通过这种方式，您可以将攻击面减少到 TIFF 文件。这是很小的。

[![Qubes PDF转换器示意图](../Images/6c292e93cf7b7954fcd7b090c1b5b75c.png)](https://i.stack.imgur.com/1uHLj.png) （取自这篇文章的图片：[https](https://blog.invisiblethings.org/2013/02/21/converting-untrusted-pdfs-into-trusted.html) ://blog.invisiblethings.org/2013/02/21/converting-untrusted-pdfs-into-trusted.html ）

如果该 PDF 中的特定解析器确实存在 0-day 漏洞，它会破坏一次性 VM，但由于原始 VM 只接受有效的 TIFF，并且一旦处理完成，一次性 VM 就会被丢弃，这是没有意义的. 当然，除非攻击者手头有 Xen 漏洞利用来突破一次性 VM，或者使用 Spectre 类型的全内存读取原语加上侧通道将数据泄漏到他们的机器。由于一次性虚拟机没有连接到互联网或没有分配任何音频硬件，这归结为通过调制 CPU 功耗来产生电磁干扰，因此攻击者可能需要一个大天线和一个靠近服务器的位置。

这将是一次代价高昂的攻击。

# coldfusion - cfset 还是 cffunction？

> ID：10196354
> 
> 赞同：0
> 
> 时间：2012-04-17T17:51:33.800
> 
> 标签：coldfusion

在冷融合中，在表单的隐藏值中，我得到两个值：

```
 <input type="hidden" name="EST_VAL" value="#EST_VAL#" />
            <input type="hidden" name="DOWN_PMT" value="#DOWN_PMT#" /> 
```

我需要找到从 DOWN_PMT 中减去的 EST_VAL 的值并将其分配给该值：

```
 <input type="hidden" name="LOAN_VAL" value="#LOAN_VAL#" /> 
```

我知道如何在 PHP 中执行此操作，但我不确定是否应该在 Coldfusion 中使用 cfset 或 cffunction。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T18:02:05.583

您可以使用英镑符号内联执行此操作，如下所示：

```
<input type="hidden" name="LOAN_VAL" value="#EST_VAL-DOWN_PMT#"/> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T18:03:40.920

CFSET 应该是你所需要的。在没有看到此文件/脚本中的其他代码的情况下，一个简单的方法/解决方案将需要以下内容：

```
<cfset LOAN_VAL = EST_VAL - DOWN_PMT /> 
```

然后，这将在您在原始帖子中记下的隐藏字段标记中输出 LOAN_VAL 变量的值。

# c - Read in text delimited file C

> ID：10196357
> 
> 赞同：0
> 
> 时间：2012-04-17T17:51:47.257
> 
> 标签：c, io

Still in the fiddling stage with C. Not sure what I'm doing wrong here but I think it has to do with pointers. Anyway. I'm trying to read in and parse a tab-delimited text file into a 2D array. The actual array is 6109 x 14, I allotted a bigger pointer array.

```
FILE *in = fopen("afile","rt");
// read the first line from the file
char line[2000];
int x=0;
int y=0;
char *result[7000][14];
char *curResult;
char delim[]= "\t";

while (fgets(line, 2000, in) != NULL) {
    printf("LINE IS %s\n",line);
    curResult=NULL;
    curResult = strtok(line,delim);
    y=0;
    while( curResult != NULL ) {
        result[x][y]= curResult;
        curResult = strtok( NULL, delim );
        y++;
    }
    x++;
}

//print a random line to check 
for(int i=0; i<10; i++)
    printf("%s\n", result[50][i]); 
```

The line I printed at the bottom which should be the 50th line prints the last line of the text file. I tried this with different numbers instead of 50 but they all print the same thing.

**EDIT: afile looks like this:**

```
 instance_id   batch_id    cmap_name   INN1    concentration (M)   duration (h)    cell2   array3  perturbation_scan_id    vehicle_scan_id4    scanner vehicle vendor  catalog_number  catalog_name
1   1   metformin   INN 0.00001 6   MCF7    HG-U133A    EC2003090503AA  EC2003090502AA  HP GeneArray Scanner    medium  Sigma-Aldrich   D5035   "1,1-dimethylbiguanide hydrochloride"
2   1   metformin   INN 0.00001 6   MCF7    HG-U133A    EC2003090504AA  EC2003090502AA  HP GeneArray Scanner    medium  Sigma-Aldrich   D5035   "1,1-dimethylbiguanide hydrochloride"
3   1   metformin   INN 0.0000001   6   MCF7    HG-U133A    EC2003090505AA  EC2003090502AA  HP GeneArray Scanner    medium  Sigma-Aldrich   D5035   "1,1-dimethylbiguanide hydrochloride"
4   1   metformin   INN 0.001   6   MCF7    HG-U133A    EC2003090506AA  EC2003090502AA  HP GeneArray Scanner    medium  Sigma-Aldrich   D5035   "1,1-dimethylbiguanide hydrochloride"
21  2   phenformin  INN 0.00001 6   MCF7    HG-U133A    EC2003091104AA  EC2003091102AA  HP GeneArray Scanner    medium  Sigma-Aldrich   P7045   phenformin hydrochloride
22  2   phenyl biguanide        0.00001 6   MCF7    HG-U133A    EC2003091105AA  EC2003091102AA  HP GeneArray Scanner    medium  Sigma-Aldrich   P19906  1-phenylbiguanide hydrochloride
23  2   valproic acid   INN 0.001   6   MCF7    HG-U133A    EC2003091106AA  EC2003091102AA  HP GeneArray Scanner    medium  Sigma-Aldrich   P4543   2-propylpentanoic acid
61  2a  metformin   INN 0.00001 6   MCF7    HG-U133A    EC2003091103AA  EC2003091102AA  HP GeneArray Scanner    medium  Sigma-Aldrich   D5035   "1,1-dimethylbiguanide hydrochloride" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:59:58.067

Imagine `line` is a big box where you can put a bunch of letters.
That's what you do with `fgets()`.

Next you point to specific letters inside that box.

Next you replace the contents of the box (another `fgets()` to the same variable `line`) and the pointers, of course still point to the same box, but now to the new letters.

You need to copy the characters (with `strcpy()`, **check that you have enough space first**) somewhere inside your loop.

# android - 如何通过 NDK 使用 c 代码检查设备运行 API 级别？

> ID：10196361
> 
> 赞同：5
> 
> 时间：2012-04-17T17:52:13.787
> 
> 标签：android, android-ndk

我开始使用 NDK 在 Android 上工作，我想检查设备在我的 c 代码上运行的 Android API 级别。我怎样才能做到这一点？

起初我以为我可以使用`__ANDROID_API__`/android/api-level.h 下的定义，但这是一个错误的假设。

**注意：我不是在问如何通过 java 检查 API 级别。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T07:47:34.143

我一直在处理一些 JNI 代码，并希望按照*Jona*的描述查询正在运行的 OS 构建版本。我想尽早做到这一点（即在**JNI_OnLoad**中），所以宁愿不按照*FUBUs*的描述从 Java 提交它。自 API 级别 4 以来，此信息已作为[android.os.Build.VERSION中的 int 字段](http://developer.android.com/reference/android/os/Build.VERSION.html)**SDK_INT**提供，这是我在此代码段中查找的内容：

```
static const char* TAG = "testjnjni";

static bool _disableHttpKeepAliveOnBuggyPlatforms(JNIEnv *env)
{
    // Based on article here:
    //   http://android-developers.blogspot.co.uk/2011/09/androids-http-clients.html
    // Which references the issue documented here:
    //   http://code.google.com/p/android/issues/detail?id=2939
    // We need to set "http.keepAlive" to "false" if running an OS version earlier than Froyo (API Level 8)

    if ((*env)->ExceptionCheck(env))
        return false; // already got an exception pending

    bool success = true;

    // VERSION is a nested class within android.os.Build (hence "$" rather than "/")
    jclass versionClass = (*env)->FindClass(env, "android/os/Build$VERSION");
    if (NULL == versionClass)
        success = false;

    jfieldID sdkIntFieldID = NULL;
    if (success)
        success = (NULL != (sdkIntFieldID = (*env)->GetStaticFieldID(env, versionClass, "SDK_INT", "I")));

    jint sdkInt = 0;
    if (success)
    {
        sdkInt = (*env)->GetStaticIntField(env, versionClass, sdkIntFieldID);
        __android_log_print(ANDROID_LOG_VERBOSE, TAG, "sdkInt = %d", sdkInt);
    }

    if (success && sdkInt < 8)
    {
        jclass systemClass = (*env)->FindClass(env, "java/lang/System");
        if (NULL == systemClass)
            success = false;

        jmethodID setPropertyMethodID = NULL;
        if (success)
            success = (NULL != (setPropertyMethodID = (*env)->GetStaticMethodID(env, systemClass, "setProperty", "(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;")));

        jstring propString = NULL;
        if (success)
            success = (NULL != (propString = (*env)->NewStringUTF(env, "http.keepAlive")));

        jstring valueString = NULL;
        if (success)
            success = (NULL != (valueString = (*env)->NewStringUTF(env, "false")));

        jobject oldValueString = NULL;
        if (success)
        {
            __android_log_print(ANDROID_LOG_VERBOSE, TAG, "Disabling http.keepAlive");
             oldValueString = (*env)->CallStaticObjectMethod(env, systemClass, setPropertyMethodID, propString, valueString);
        }

        // cleanup
        (*env)->DeleteLocalRef(env, propString);
        (*env)->DeleteLocalRef(env, valueString);
        (*env)->DeleteLocalRef(env, oldValueString);
        (*env)->DeleteLocalRef(env, systemClass);
    }

    // cleanup
    (*env)->DeleteLocalRef(env, versionClass);

    return success;
} 
```

我编写此代码所需的所有信息都清楚地记录在由 Sheng Liang 撰写的题为“Java Native Interface: Programmer's Guide and Specification”的 PDF 中，以前可以从 Oracle 的站点[这里](http://java.sun.com/docs/books/jni/)获得，但也可以作为一本书购买（例如[这里](https://rads.stackoverflow.com/amzn/click/com/0201325772)）。JNI 是一项非常强大的技术，我强烈建议任何想要掌握它的开发人员阅读 PDF 以及 Android 开发人员的[JNI 提示](http://developer.android.com/training/articles/perf-jni.html)。

哦，最后，不能强调理解本地和全球参考的重要性。[Android 的开发者博客在这里](http://android-developers.blogspot.co.uk/2011/11/jni-local-reference-changes-in-ics.html)有一篇很好的文章，涵盖了 ICS 中的变化（没有什么偏离 JNI 规范，但需要重申的要点！）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-21T20:46:30.917

存在完全原生的解决方案：

1.  之前`Android L`你可以使用[`__system_property_get("ro.build.version.sdk")`](https://stackoverflow.com/questions/26722040/replacement-for-system-property-get-in-android-l-ndk)from`sys/system_properties.h`
2.  对于`Android L`和更新您可以使用[`popen("getprop ro.build.version.sdk")`](https://stackoverflow.com/questions/26722040/replacement-for-system-property-get-in-android-l-ndk)

使用编译时工具链常量检查`#if __ANDROID_API__ < 21`在这两个实现之间切换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T16:41:04.900

您可以一次性将您在 JAVA 中获得的 API 级别传递给 C 代码，并将其存储在全局变量中。对我来说，这是更简单的方法。

# c++ - 切换字符值并将其添加到数组

> ID：10196362
> 
> 赞同：0
> 
> 时间：2012-04-17T17:52:21.273
> 
> 标签：c++, char, switch-statement

我在为数组提供新的 char 值时遇到问题。我不知道为什么即使 n 是 12 也会得到符号“<”？在这种情况下，我的程序应该将表达式更改`int char* tab = "93+"`为一个值`12`。

```
 char* tab = "93+";
    int b = sizeof (tab);
    char* tmp = new char[b] ;
    tmp [b-1] = '\0';

if(isdigit(tab[i]) && isdigit(tab[i+1]) ){
               int n;             
               if(tab[i+2]=='+' || tab[i+2]=='-' || tab[i+2]=='*'){

                  switch(tab[i+2]){
                    case '+':   
                    n = (tab[i]-'0') + (tab[i+1]-'0');

                    break;

                    case '-':
                    n = (tab[i]-'0') - (tab[i+1]-'0');
                    break;

                    case '*':
                    n = (tab[i]-'0') * (tab[i+1]-'0');
                    break;
                  }
                  tmp[i] = n+'0'; // I should have 12 but I get <
               }

               else if (tab[i+2]!='+' || tab[i+2]!='-' || tab[i+2]!='*'){
                     goto LAB;
               }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:18:39.010

问题出在这一行：

```
tmp[i] = n+'0'; // I should have 12 but I get < 
```

n 是 12，但 12 + '0' != '12'，因为 '12' 不是字符。您将 tmp[i] 的 char 值比 '0' 大 12，即 '<'。
我相信将 tmp 声明（和处理）为 int 会更好地满足您的目的。

另请注意，`sizeof (tab)`它与 相同`sizeof (char *)`，而不是`sizeof ("93+")`，因此您很可能总是得到`b==4`（在 32 位机器中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:21:47.000

你确实应该得到'<'。原因如下：`tmp`是一个字符数组。您计算出 n 为 12。这是正确的。然后您添加了“0”，即 48。48 + 12 = 60。因此您将 60 存储在 tmp[i] 中。ASCII 60 是“<”。

您可以使用`int tmp`，而不添加“0”，然后您将在 tmp[i] 中得到 12。

# php - PHP - 日期 - 之间

> ID：10196365
> 
> 赞同：0
> 
> 时间：2012-04-17T17:52:30.493
> 
> 标签：php, sql

我用

$date = date("Ymd");

在 sql 中我使用 max is = date("Ymd") min is = 6 days back

是否有一个函数可以从日期回溯 $limit？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:02:24.690

在 PHP 中，可以这样做：

```
$date_first    = date("Y-m-d"); //today's date or use some other date
$date_second = date("Y-m-d", strtotime(date("Y-m-d", strtotime($date_first)) . " -6 day")); //date before 6 days 
```

**编辑**

根据 Dan Lee 的建议（见下面的评论）：

```
$date_before = date("Y-m-d", strtotime("-6 day")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:58:13.187

您只能将 MySQL 用于此任务。

取 DATE_SUB() 从当前时间中减去：

```
SELECT * FROM table WHERE date BETWEEN DATE_SUB(NOW(), INTERVAL 6 DAY) AND CURDATE() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:42:22.527

您还可以使用@AkhileshBChandran 的答案的 OO 变体：

```
$dt = new DateTime('-6 days');
$sixDaysAgo = $dt->format('Y-m-d'); 
```

# c++ - 电话字生成器帮助 C++

> ID：10196367
> 
> 赞同：6
> 
> 时间：2012-04-17T17:52:53.140
> 
> 标签：c++, input, stream

我有一些作业要完成，直到我到达最后一步，我现在很难过，我真的很感激一些帮助。

该项目的前提是创建一个给定电话号码的可能单词文件。用户应输入格式为“###-####”的数字。然后代码将连字符拉出并将电话号码发送到方法**wordGenerator**。我知道到目前为止一切正常。当输出单词的不同可能性时，我遇到了问题。这是我的方法的样子：

```
// function to form words based on phone number
void wordGenerator( const int * const n )
{
  // set output stream and open output file
  /* Write a declaration for an ofstream object called
     outFile to open the file "phone.dat" */ 
 ofstream outFile("phone.dat");
 // letters corresponding to each number

  /* Write a declaration for an array of 10 const char *'s
  called phoneLetters. Use an initializer list to assign
  each element of the array the corresponding string of
  three letters. Use dummy characters for 0 and 1 */
  const char * phoneLetters[] = {"###", "###", "ABC", "DEF", "GHI",
                     "JKL", "MNO", "PRS", "TUV", "WXY"};
  // terminate if file could not be opened
  /* Write code to check if the file was opened successfully,
     and terminate if not */
   if( !outFile )
   {
    cerr << "The file could not be opened";
    exit(1);
   }

  int count = 0; // number of words found

  // output all possible combinations
  for ( int i1 = 0; i1 <= 2; i1++ )
  {
     for ( int i2 = 0; i2 <= 2; i2++ )
     {
        for ( int i3 = 0; i3 <= 2; i3++ )
        {
           for ( int i4 = 0; i4 <= 2; i4++ )
           {
              for ( int i5 = 0; i5 <= 2; i5++ )
             {
                for ( int i6 = 0; i6 <= 2; i6++ )
                 {
                   for ( int i7 = 0; i7 <= 2; i7++ ) 
                    {
                    /* Write a series of cascaded stream insertion
               operations to output a set of seven letters
           to outFile, followed by a space */

                     outFile << phoneLetters[i7 + 2] << phoneLetters[i6 + 2] <<  phoneLetters[i5 + 2]  << phoneLetters[i4 + 2] << phoneLetters[i3 + 2] << phoneLetters[i2 + 2]
                            << phoneLetters[i1 + 2] << ' ';
                    if ( ++count % 9 == 0 ) // form rows
                       outFile << '\n';
                   } // end for
                 } // end for
              } // end for
           } // end for
         } // end for
      } // end for
    } // end for

  // output phone number
    outFile << "\nPhone number is ";

    for ( int i = 0; i < 7; i++ ) 
    {
      if ( i == 3 )
      outFile << '-';

      outFile << n[ i ];
    } // end for

   /* Write a statement to close the ouput file */
     outFile.close();
     system("pause");
    } // end function wordGenerator 
```

不幸的是，我得到了一个代码框架，并被告知要填写空白以完成作业。评论被阻止的任何地方（/ * * /）都是我必须填写代码的地方。

我不确定我需要做什么来输出可能单词的正确格式。我尝试搜索谷歌，但我发现的所有结果都使用了一个更简单（在我看来）的 switch 语句来实现这一点，并且我受限于模板:(

感谢所有帮助，即使是朝着正确的方向轻推。

编辑：我只是想到了另一件事。我觉得如果有人甚至可以帮助我弄清楚如何单独遍历 phoneLetters[] 的字符而不是一个块，那将是向前迈出的重要一步。示例：当读取电话号码的数字“2”而不是打印“ABC”时，为所有可能的组合打印“A”，然后转到“B”。

编辑：这是我的主要（）：

```
int main()
{
  int phoneNumber[ 7 ] = { 0 }; // holds phone number

   // prompt user to enter phone number
   cout << "Enter a phone number (digits 2 through 9) "
     << "in the form: xxx-xxxx\n";

   // loop 8 times: 7 digits plus hyphen;
   // hyphen is not placed in phoneNumber
   for ( int u = 0, v = 0; u < 8; u++ ) 
  {
     int i = cin.get();

     // test if i is between 0 and 9
     if ( i >= '0' && i <= '9' )  
     phoneNumber[ v++ ] = i - '0';
   } // end for

   wordGenerator( phoneNumber ); // form words from phone number
   return 0;
} // end main 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T18:55:12.343

如果您无法摆脱可怕的嵌套 for 语句，那么您可以使用以下行：

```
outFile
    << phoneLetters[n[0]][i1]
    << phoneLetters[n[1]][i2]
    << phoneLetters[n[2]][i3]
    << phoneLetters[n[3]][i4]
    << phoneLetters[n[4]][i5]
    << phoneLetters[n[5]][i6]
    << phoneLetters[n[6]][i7]
    << ' '; 
```

关于代码的其他一些注释：

*   避免`exit`在 C++ 中使用，因为它会[阻止析构函数运行](https://stackoverflow.com/questions/2668075/will-exit-or-an-exception-prevent-an-end-of-scope-destructor-from-being-called)

*   使用语句避免[命名空间污染](http://www.parashift.com/c++-faq-lite/coding-standards.html#faq-27.5)`using namespace`（我假设上面有一个`using namespace std;`语句）

*   如果您没有使用`exit`并删除暂停（或添加范围），则[fstream 的显式关闭是多余的](https://stackoverflow.com/questions/748014/do-i-need-to-manually-close-a-ifstream)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:31:01.817

首先，改变这些嵌套的for-s。它们看起来很糟糕，如果我说你现在要生成 15 位数字，那你的处境就很糟糕了。

您正在寻找的是某种模数为 3 的置换生成器，正如我所想的那样...由于没有特殊情况（例如真实手机上的“PQRS”），只需计算从 0 到的所有可能组合3^7.

然后，使用一个 for 循环遍历它们。即编写自定义迭代器函数可能是难以理解的概念，所以想想就像做所有这些组合一样，比如：

```
// 3^7 = 2187

for (int i = 0; i < 2187; ++i)
{
    int Div = 1;
    // now, 7 digits
    for (int d = 0; d < 7; ++d)
    {
         outFile << (i / Div) % 3;
         Div *= 3;
    } 
} 
```

该代码将在三进制系统中生成数字排列；）然后可用于输出正确的字母

```
outFile << phoneLetters[ActualReadNumber][ (i/Div)%3 ]; 
```

如果您确实需要使用“级联”写入文件，请将内部循环替换为所有 7 种可能性，例如：

```
/*1.*/   i % 3
/*2.*/   (i / 3) % 3
/*3.*/   (i / 9) % 3 
```

等等......如果我应该更详细地解释一些事情，请对此发表评论；如果我有帮助，请投票 :) 并祝你功课好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T19:20:44.550

如果电话号码只有两位数，同时遵循您的模板，则解决方案。

```
int pN[] = {6,9};

const char * phoneLetters[] = {"###", 
    "###", "ABC", "DEF", "GHI", "JKL", "MNO", "PRS", "TUV", "WXY"}; // 

for (const char *c1 = phoneLetters[pN[0]]; *c1 != '\0'; c1++)
{ 
    for (const char *c2 = phoneLetters[pN[1]]; *c2 != '\0'; c2++)
    { 
        printf( "%c%c\n" , *c1 , *c2); 
    } 
} 
```

输出：MW MX MY NW NX NY OW OX OY

# xml - XML 编辑器，如 Word 2003

> ID：10196368
> 
> 赞同：8
> 
> 时间：2012-04-17T17:52:53.767
> 
> 标签：xml, editor, word-2003

我搜索了一个 XML 编辑器，专注于文本注释，如 Word 2003（[屏幕截图](https://web.archive.org/web/1/http://i.techrepublic%2ecom%2ecom/gallery/322865-500-277.jpg)），其中 xml 标签是内联的，您可以在其中选择文本并一键用标签包围它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T10:40:04.193

     `<oXygen/>`是最好的 XML 编辑器，拥有大量用户，从初学者到 XML 专家。
       它是唯一支持所有 XML 模式语言的 XML 工具。强大的调试器和性能分析器增强了 XSLT 和 XQuery 支持。
       您可以使用`<oXygen/>`XML 编辑器处理所有基于 XML 的技术，包括 XML 数据库、XProc 管道和 Web 服务。

## **特征**

*   XML IDE
*   智能 XML 编辑
*   XML 验证
*   XML 模式建模
*   XPath 支持

还有更多其他功能。

您可以获得更详细的[XML 编辑器](http://www.oxygenxml.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T00:18:53.273

我喜欢氧气产品。 [XML Author](http://www.oxygenxml.com/xml_author.html)是一款低端产品，可以满足您的需求。有下载和试用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T13:20:04.110

尝试使用[XML 记事本 2007](http://www.microsoft.com/download/en/details.aspx?id=7973)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T23:42:56.797

我强烈推荐带有[XML 插件的](http://sourceforge.net/projects/npp-plugins/files/XML%20Tools/)[Notepad++](http://notepad-plus-plus.org/)，它可以通过插件管理器轻松安装。让您选择流或树视图，您可以折叠，以及其他奖励功能，如*针对 XSD 模式进行验证*和*通过 XSLT 转换*。

 *** * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-29T14:36:00.553

也许您可以尝试[Altova XMLSpy](http://www.altova.com/xml-editor/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T11:35:14.350

另一种可能性是[XML Copy Editor](http://xml-copy-editor.sourceforge.net/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-02T11:08:24.867

好吧，如果你有钱，我更喜欢[EditX](http://www.editix.com/)，或者如果你想要一个免费的解决方案[EditX Lite](http://free.editix.com/download.html)就是你所需要的。

EditiX Lite 的特点：

[XML 编辑器](http://free.editix.com/features/xml_editor.html)

[XSLT 编辑器](http://free.editix.com/features/xslt_editor.html)和[调试器](http://free.editix.com/features/xslt_debugger.html)（1.0 和 2.0）

[打开 XML 格式编辑器](http://free.editix.com/features/open_xml_editor.html)

[打开文档格式](http://free.editix.com/features/open_document_editor.html)

[视觉模式编辑器](http://free.editix.com/features/schema_editor.html)

[XML 差异](http://free.editix.com/features.html#XML_Diff)

编辑：

这还包括功能[强大的 XPath 构建器/研究](http://free.editix.com/)

我真的很喜欢这个工具，希望对你也有帮助。**

# android - Jquery Mobile Framework 对 Web 开发人员有帮助吗

> ID：10196375
> 
> 赞同：0
> 
> 时间：2012-04-17T17:53:04.643
> 
> 标签：android, asp.net, ios, mobile, jquery-mobile

我是.net 开发人员。我想为移动设备开发一个应用程序。作为一名网络开发人员，我精通网络技术和脚本语言。我是 JQuery 的忠实粉丝，所以我找到了一些用于移动应用程序开发的 Jquery Mobile Framework。

所以，我有几个问题：

1.  这个框架会帮助我开发 Web 应用程序还是仅用于设计目的？
2.  我可以使用我的 Jquery 知识来使用 Jquery Mobile Framework 实现 Web 应用程序吗？
3.  我可以在移动应用程序开发中使用 Jquery AJAX 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:08:00.163

它不会帮助您构建移动“应用程序”，但会帮助您创建支持移动的网站。

1.  它将帮助您构建移动 Web 应用程序的前端。
2.  是的
3.  是的，如果您指的是移动**Web**应用程序。

您使用的后端技术无关紧要。我已经使用 jQuery Mobile 构建了几个 .NET MVC 站点，它们都运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:40:15.143

1.  jQuery Mobile 将帮助您构建网站，然后您可以在浏览器中查看该网站或将其打包到应用程序中。如果您想使用 HTML/CSS/JS 创建原生应用程序，那么您将需要一个中间步骤，让您可以将 web 视图作为您的应用程序运行。[PhoneGap](http://www.phonegap.com/)是一个框架示例，它允许您在使用 HTML/CSS/JS 构建应用程序时使用本机 API。

2.  您的 jQuery 知识将派上用场，但您将被迫以不同的方式思考 jQuery Mobile 网站。例如，页面不是 HTML 文档，但`pseudo-pages`它可以在单独的文档中，但也可以`pseudo-pages`在单个 HTML 文档中包含多个。而且由于远程文档是通过 AJAX（用于动画转换）引入 DOM，因此您需要对您的站点进行编码以在整个站点中使用唯一 ID，而不仅仅是在页面之间使用。

3.  绝对地！jQuery AJAX 使创建动态网站和本地应用程序变得容易。您基本上只是将一堆视图（在 HTML/JS/CSS 中）加载到应用程序中。打包，然后您的服务器进行建模。要考虑的一件很酷的事情是，由于您是从移动应用程序运行的，因此没有发送响应的域，因此无需担心跨域策略。

如果您尚未签出[PhoneGap](http://www.phonegap.com/)，请执行此操作，并查看[jQuery Mobile 网站上](http://jquerymobile.com/demos/1.1.0/docs/pages/phonegap.html)有关如何使用 jQuery Mobile 创建[PhoneGap](http://www.phonegap.com/)应用程序的文档：

[http://jquerymobile.com/demos/1.1.0/docs/pages/phonegap.html](http://jquerymobile.com/demos/1.1.0/docs/pages/phonegap.html)

# arrays - 使用另一个数组索引到一个八度数组

> ID：10196379
> 
> 赞同：1
> 
> 时间：2012-04-17T17:53:18.490
> 
> 标签：arrays, matlab, multidimensional-array, matrix, octave

嗨，我有一个大小为 [xyz] 的三维八度数组 A

现在我有另一个维度为 n * 3 的数组 B

假设 B(0) 给出 [3 3 1]

我需要访问 A 中的那个位置，即 A(3, 3, 1) = 说 15 类似于 A(B(0))

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T19:19:52.507

请参阅`sub2ind`( 和`ind2sub`) 的帮助。但是，现在人们建议使用循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T20:54:30.830

好吧，首先，`B(0)`索引无效，因为 MATLAB 和 Octave 中的寻址从 1 开始。另一个问题是您希望它`B(0)`包含一个 vector `[3 3 1 ]`。MATLAB 中的矩阵不能包含其他矩阵，只能包含标量。所以你需要使用 3x3 元胞数组、3x3 结构或 4 维数组。我将在这里选择元胞数组选项，因为我发现它最简单、最方便。

% 设置随机种子（仅用于示例数据生成）。

```
rng(123456789); 
```

% 让我们生成一些伪随机示例数据。

```
A = rand(3,3,3);

A(:,:,1) =
0.5328    0.7136    0.8839
0.5341    0.2570    0.1549
0.5096    0.7527    0.6705

A(:,:,2) =
0.6434    0.8185    0.2308
0.7236    0.0979    0.0123
0.7487    0.0036    0.3535

A(:,:,3) =
0.1853    0.8994    0.9803
0.7928    0.3154    0.5421
0.6122    0.4067    0.2423 
```

% 生成一个示例 3x3x3 索引元胞数组，填充伪随机 1x3 索引向量。

```
CellArrayOfIndicesB = cellfun(@(x) randi(3,1,3), num2cell(zeros(3,3,3)), 'UniformOutput', false); 
```

% 示例 #1。坐标 (1,2,3)。

```
Dim1 = 1;
Dim2 = 2;
Dim3 = 3; 
```

% 直接获取A对应值的代码。

```
ValueOfA = A(CellArrayOfIndicesB{Dim1,Dim2,Dim3}(1), CellArrayOfIndicesB{Dim1,Dim2,Dim3}(2), CellArrayOfIndicesB{Dim1,Dim2,Dim3}(3));
ValueOfA =
         0.8839 
```

% 让我们首先检查 CellArrayOfIndicesB{1,2,3} 指向的位置来确认这一点。

```
CellArrayOfIndicesB{1,2,3}
ans =
    [ 1 3 1 ] 
```

%`CellArrayOfIndicesB{1,2,3}`指向`A(1,3,1)`。% 那么让我们看看 的值是多少`A(1,3,1)`。

```
A(1,3,1)
ans =
    0.8839 
```

% 示例 #2。坐标 (3,1,2)。

```
Dim1 = 3;
Dim2 = 1;
Dim3 = 2;

ValueOfA = A(CellArrayOfIndicesB{Dim1,Dim2,Dim3}(1), CellArrayOfIndicesB{Dim1,Dim2,Dim3}(2), CellArrayOfIndicesB{Dim1,Dim2,Dim3}(3));
ValueOfA =
         0.4067

CellArrayOfIndicesB{3,1,2}
ans =
    [ 3 2 3 ]

A(3,2,3)
ans =
    0.4067 
```

# python - 创建条件迭代列表

> ID：10196386
> 
> 赞同：-2
> 
> 时间：2012-04-17T17:54:05.483
> 
> 标签：python, list

我有一个列表 B=[0,0,0,0,0,0,0,0,0] 但它可以是任何长度。

我正在尝试遍历所有可以通过迭代放置在 B 中的可能值。当满足某些条件 C 时，我想“重置”我刚刚迭代的元素并将下一个项目提高 1。有点像二进制：

000 变为 001，但是当我们增加到 002 时，条件 C 满足，因此我们将其降至 0 并增加下一列：002 变为 010，依此类推。

对不起，如果我解释得不好。

所以 B 可能从

```
B=[0,0,0,0,1,2,5]
to
B=[0,0,0,0,1,2,6]
to
B=[0,0,0,0,1,2,7] 
```

等等。

但是当满足条件C时，我想以这种方式重置：

```
B=[0,0,0,0,1,2,96]
...attempt to increment
B=[0,0,0,0,1,2,97]
...attempt to increment
Condition C met
B=[0,0,0,0,1,3,0] 
```

并且能够做到这一点，直到我最终在最左边的元素上达到条件 C（相当于达到 1111111 并且无法再增加它）。

为了更容易编码，假设条件 C = 所有数字的总和超过 100。

我的尝试（根据 agf 的要求）：

```
B=[0,0,0,0,0,0,0,0]
lenB=len(B)

while sum(B)<=100: #I think I have to somehow account for having tried incrementing the far left instead
    B[lenB-1]+=1 #increment last value in B
    while sum(B)>100: #if the sum is greater than 100
        B[lenB-1]=0 #reset the far right element
        B[lenB-2]+=1 #increment the next element
        #but this is wrong because it needs to perform this check again and again
        #for every column, while also checking if B[len-1] or B[len-2] even exists 
```

编辑：实际上我的条件 C比简单地检查*Sum* (B)>100 复杂得多。我只是将其用作虚拟条件，因为我可以简单地将“if sum(B)>100”替换为更复杂的条件函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T19:04:45.310

编辑：我似乎已经为一个不同的、更复杂的问题创建了一个解决方案。这是我对 agf 在评论中澄清的问题的解决方案：

```
def uphill(initial=None):
    """Yields a tuple of integers. On each iteration, add one to the last column
    . If True is sent then reset the column, and begin iterating the previous
    column, until the first column is matched."""
    b = initial
    column = len(initial)-1
    while True:
        if (yield tuple(b)):
            b[column] = 0
            if column > 0:
                column -= 1
                b[column] += 1
            else:
                yield None
                raise StopIteration
            yield None
        else:
            b[column] += 1

gen = uphill([1, 2, 0])
for b in gen:
    print(b)
    if sum(b) >= 4:
        gen.send(True) 
```

给我们：

```
(1, 2, 0)
(1, 2, 1)
(1, 3, 0)
(2, 0, 0)
(3, 0, 0)
(4, 0, 0) 
```

* * *

# 旧解决方案：

我们可以使用生成器和鲜为人知的方法创建一个非常优雅的解决方案`generator.send()`：

```
def waterfall(columns):
    """Yields a tuple of integers. On each iteration, adds one to the last list
    item. The consumer can send column numbers to the waterfall during iteration
     - when this is done, the specified column is reset to 0 and the previous 
    column is incremented. When the first column is reset, the iterator ends."""
    b = [0]*columns
    while True:
        reset = (yield tuple(b))
        if not reset == None:
            while not reset == None:
                b[reset] = 0
                if reset > 0:
                    b[reset-1] +=1
                else:
                    yield None
                    raise StopIteration
                reset = (yield None)
        else:
            b[-1] += 1

gen = waterfall(3)
for b in gen:
    print(b)
    if b[2] >= 3:
        gen.send(2)
    if b[1] >= 2:
        gen.send(1)
    if b[0] >= 1:
        gen.send(0) 
```

这给了我们：

```
(0, 0, 0)
(0, 0, 1)
(0, 0, 2)
(0, 0, 3)
(0, 1, 0)
(0, 1, 1)
(0, 1, 2)
(0, 1, 3)
(0, 2, 0)
(1, 0, 0) 
```

您可以愉快地将这些条件更改为任何内容。当满足您的选择条件时，您只需向生成器发送您希望重置的列的索引（它会自动将其上方的索引加一）。当最后一列被重置时，它完成了生成器。

还值得注意的是，您可以随时使用`gen.close()`它来停止它，而无需到达最后一列。（`gen.send(0)`与 相同`gen.close()`）。

具有不同条件的示例：

```
gen = waterfall(2)
for b in gen:
    print(b)
    if sum(b) >= 3:
        gen.send(1)
    if b[0] >= 3:
        gen.send(0) 
```

给我们：

```
(0, 0)
(0, 1)
(0, 2)
(0, 3)
(1, 0)
(1, 1)
(1, 2)
(2, 0)
(2, 1)
(3, 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:17:17.683

```
def increment(box, condition):
    # last index in the list
    maxindex = index = len(box) - 1
    while True:
        # so you can see it's correct
        print box
        # increment the last digit
        box[-1] += 1
        # while the overflow condition is True
        while condition(box):
            # reset the current digit
            box[index] = 0
            # and move to the next index left
            index -= 1
            # if we're past the end of the list
            if index < 0:
                # stop
                return
            # increment the current digit
            box[index] += 1
        # back to the rightmost digit
        index = maxindex

increment([0] * 3, lambda box: sum(box) > 4) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:13:20.170

您可以通过列表理解来做到这一点，并且[`range()`](http://docs.python.org/release/3.1.3/library/functions.html#range)（在此处使用较小的值来阻止输出非常大）：

```
>>> [(a, b, c) for a in range(2) for b in range(4) for c in range(3)]
[(0, 0, 0), (0, 0, 1), (0, 0, 2), (0, 1, 0), (0, 1, 1), (0, 1, 2), (0, 2, 0), (0, 2, 1), (0, 2, 2), (0, 3, 0), (0, 3, 1), (0, 3, 2), (1, 0, 0), (1, 0, 1), (1, 0, 2), (1, 1, 0), (1, 1, 1), (1, 1, 2), (1, 2, 0), (1, 2, 1), (1, 2, 2), (1, 3, 0), (1, 3, 1), (1, 3, 2)] 
```

请注意，如果您想循环它，而不是在开始时生成一个大列表，使用生成器表达式只会根据需要创建项目：

```
for a, b, c in ((a, b, c) for a in range(2) for b in range(4) for c in range(3)):
    ... 
```

请注意，在 Python 2.x 中，您希望使用[`xrange()`](http://docs.python.org/library/functions.html#xrange)而不是`range`获取生成器而不是列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T18:23:36.690

这是做你想做的吗？

```
B=[0,1,0]

def check(ll,callback):
    """
    This function only works if you 
    increment the last element in the list.
    All other incrementing is done in this function.
    """
    for idx in reversed(range(len(ll))):
        if(callback(ll)):
            ll[idx]=0
            ll[idx-1]+=1
        else:
            break  #this index wasn't updated, so the next one won't be either.

    #a check to see if every element is 1
    return all(map(lambda x: x==1,ll))

def checksum(ll):
    return True if sum(ll)>100 else False

count=0
while True:
    count+=1
    B[-1]+=1
    if(check(B,checksum)): break
    print B

print B   # [1,1,1]
print count 
```

即使对于这个例子，我们在 [1,1,1] 之前运行了超过 5000 次迭代

**编辑**

添加了一个简单的`break`语句，因为只需要检查列表，只要它在最后一次迭代期间发生了变化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T18:28:45.140

**紧凑但低效的解决方案**

如果您的条件不是特定于数字的，请尝试使用类似于 LattyWare 的解决方案，但使用过滤器仅提供预测结果。

如果您有一个谓词函数列表映射`(a, b, c)`到`bool`

```
for a, b, c in ((a, b, c) for a in range(2) for b in range(4) for c in range(3)):
    if all [p(a,b,c) for p in predicates]:
        yield a, b, c 
```

请注意，如果您不能对各个数字设置合理的初始界限（搜索空间变得太大），这将变得站不住脚。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T18:33:37.370

正如您所期望的那样，这似乎解决了您不断增加的问题：

```
b=[0,0,0,0,0,0,0,1,7]

def incr(arr, condition, pred):
   arr[-1] += 1
   element = -1
   while condition(arr) > pred:

      if arr[element]:
         arr[element] = 0
         arr[element-1] += 1
      else:
         element -= 1
      if abs(element) == len(arr):
         break
   return arr

print b
for i in xrange(0,10):
   b = incr(b, sum, 15)
   print b 
```

函数接受列表和函数条件（例如，总和）以及增量应该结转的点。

因此，对于示例 sum (15)，它会返回如下结果：

```
>>> 
[0, 0, 0, 0, 0, 0, 0, 1, 7]
[0, 0, 0, 0, 0, 0, 0, 1, 8]
[0, 0, 0, 0, 0, 0, 0, 1, 9]
[0, 0, 0, 0, 0, 0, 0, 1, 10]
[0, 0, 0, 0, 0, 0, 0, 1, 11]
[0, 0, 0, 0, 0, 0, 0, 1, 12]
[0, 0, 0, 0, 0, 0, 0, 1, 13]
[0, 0, 0, 0, 0, 0, 0, 1, 14]
[0, 0, 0, 0, 0, 0, 0, 2, 0]
[0, 0, 0, 0, 0, 0, 0, 2, 1]
[0, 0, 0, 0, 0, 0, 0, 2, 2] 
```

# .net - 服务安装程序的用户输入命令行选项

> ID：10196390
> 
> 赞同：1
> 
> 时间：2012-04-17T17:54:19.840
> 
> 标签：.net, visual-studio-2010, service, command-line, installation

# 背景

这是我第一次使用安装项目，更不用说安装服务了。事情进展得相当顺利，直到我达到我想要获得用户输入的地步。到目前为止，我已经设法根据这些帖子回答了我所有的问题：

创建安装项目：

[http://msdn.microsoft.com/en-us/library/zt39148a(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/zt39148a(v=vs.80).aspx) [http://blogs.msdn.com/b/nikhilsi/archive/2011/06/13/how-在组件设计器中创建 Windows 服务](http://blogs.msdn.com/b/nikhilsi/archive/2011/06/13/how-to-create-a-windows-service-in-the-component-designer.aspx)

安装项目中的用户界面：

[http://msdn.microsoft.com/en-us/library/9cdb5eda(VS.71).aspx](http://msdn.microsoft.com/en-us/library/9cdb5eda(VS.71).aspx)

我创建了一个表单来接受用户的两个输入，都是文本输入。

（**可选**）我希望一个作为文件选择器，另一个作为 int 进行验证。但是，如果它们是简单的文本框，则不会破坏交易。

# 问题

我的问题是关于在安装程序中获取用户的输入（通过文本框）并将它们设置为已安装服务的命令行选项。换句话说，如果用户在文本框 1 中输入“AAAA”，在文本框 2 中输入“1234”，我如何安装服务以使用以下命令行启动：

```
/OptionA "AAAA" /OptionB 1234 
```

# c# - 是否可以在 C# 中调用动态对象？

> ID：10196391
> 
> 赞同：1
> 
> 时间：2012-04-17T17:54:26.230
> 
> 标签：c#, dynamic

我有一种情况，我有一个可调用的“动态”类型的对象。我正在尝试实现一个函数，该函数将在运行时使用一组参数动态调用对象。如果我在编译时知道参数的数量，就很容易调用它：

```
Object StaticInvoke(dynamic func, Object[] args) {
    // arguments are explicitly unwrapped and bound to the invokation
    // requiring that we know the number at compile time
    return func(args[0], args[1], ...); 
} 
```

但是，这并不能实现我想要的，因为 args 数组可能是可变长度的。我想不出一种方法来支持任意数量的参数。我想出的最接近的是：

```
static Object Invoke(dynamic func, Object[] args)
{

    // not sure what to put here
    switch(args.Length)
    {
        case 0:
            return func();
        case 1:
            return func(args[0]);
        case 2:
            return func(args[0], args[1]);
        ...
        default:
            throw new NotSupportedException();
    }
} 
```

这将限制我可能通过的参数数量。我想我可以忍受这个限制，但感觉我正在尝试做的事情应该是可能的。

我基本上是在尝试在 C# 中实现 javascript“应用”函数。有没有更简单的方法来完成我想要做的事情？我觉得我错过了一些明显的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T15:32:24.967

开源 apache 许可的 ImpromptuInterface（在 nuget 上）具有执行此操作的静态方法[Impromptu.Invoke](http://code.google.com/p/impromptu-interface/wiki/UsageReallyLateBinding#dynamic_Impromptu.Invoke%28object_target,_params_object%5B%5D_args%29)。您可以查看实现，虽然它处理任意数量的参数，但它也可以工作，您可能不需要，例如提供一种机制来动态描述命名参数并调用它们。

根据您的使用情况，您的 switch case 想法实际上可能是可行的方法，因为它应该既简单又快速。

对于您的 switch 案例，N 是您支持的最大参数数量，C# 编译器将创建 N+1 个调用点，它只是静态地知道它们在哪里。即兴将调用 dlr api，就像编译器一样，但它将[调用站点存储在哈希表](http://code.google.com/p/impromptu-interface/source/browse/ImpromptuInterface/src/Optimization/InvokeHelper-Regular.cs#140)中，这将增加查找时间（虽然不错）。

dlr api 还需要一个委托，该委托具有与您正在调用的数字或参数相匹配的签名，编译器将再次确保您静态拥有 N+1 个委托，而 Impromptu 将在开关中使用 17 个内置 Func<>情况下，然后[根据需要开始发出新的委托](http://code.google.com/p/impromptu-interface/source/browse/ImpromptuInterface/src/Optimization/InvokeHelper.cs#274)，这是一次繁重的生成成本，然后为后续调用添加更多的哈希表查找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:58:26.457

编辑：这不是一个答案——把它放在这里是为了让其他人知道@Mark 寻找的东西不太可能。

对于常规对象，您将使用[`MethodBase.InvokeMethod`](http://msdn.microsoft.com/en-us/library/a89hcwhh.aspx)：

```
 MethodInfo magicMethod = magicType.GetMethod("ItsMagic");
 object magicValue = magicMethod.Invoke(magicClassObject, new object[]{100}); 
```

# javascript - In JavaScript, how do I split a string based on conditions within that string?

> ID：10196394
> 
> 赞同：1
> 
> 时间：2012-04-17T17:54:39.483
> 
> 标签：javascript, regex, string

## Background

I am currently writing a function which needs to accept a command as a string. The string needs to be split into it's finer parts so that the function may then use those parts. Here is an example string:

`People.filter(Hometown.eq("Pittsburgh"))`

Which, in this *simplified* example, I would need to resolve to something like:

```
var objectToTraverse = "People";
var actionToTake = "filter";
var comparer = "Hometown";
var targetValue = "Pittsburgh"; 
```

For the example above, the split operation is fairly easy:

```
var _command = "People.filter(Hometown.eq("Pittsburgh"))";
var command = _command.split(".");

var objectToTraverse = command[0];
var actionToTake = command[1].split("(")[0];
var comparer = command[1].split("(")[1];
var targetValue = command[2].split("(")[1].split(")")[0]; 
```

But what if you have a more complex command such as this: `People.filter(Hometown.eq("Pittsburgh") && Gender.eq("male") || Age.eq(>= 35)).orderBy(Age,Gender).limitResultSet(10)`

The pattern may be different each time.

## Question

Using JavaScript, how do I efficiently parse a string-command based on various mixed delimiters and conditions such as this:

`People.filter(Hometown.eq("Pittsburgh") && Gender.eq("male") || Age.eq(>= 35)).orderBy(Age,Gender).limitResultSet(10)`

## Please Note

I am aware of all of the frameworks available already for querying data in JavaScript and, while I appreciate all tips and advice, I would still like an answer to this question regardless of what else is available out there.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:07:22.553

The only way to sensibly parse this is with (wait for it...) a *parser*!

See [http://javascript.crockford.com/tdop/tdop.html](http://javascript.crockford.com/tdop/tdop.html) for Douglas Crockford's take on how to write parsers in Javascript.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:21:42.003

Regex, particularly JavaScript's flavor of regex which lacks recursion and balanced groups, is not up to the task of parsing code like this. Your sample code, with its well-formed nested parentheses, is a classic example of a [context-free grammar](http://en.wikipedia.org/wiki/Context-free_grammar), which [far wiser men than I](https://stackoverflow.com/a/1758162/399649) have declared undoable with regex.

What you need is an actual parser. There are [full JavaScript parsers](https://stackoverflow.com/questions/2554519/javascript-parser-in-javascript) available that are, themselves, implemented in JavaScript ([JSLint](https://github.com/douglascrockford/JSLint/blob/master/jslint.js) has one in it). Or, if you only want to allow certain types of expressions, you can [generate a parser to suit any grammar you choose](http://pegjs.majda.cz/).

**One thing to be aware of:** This is definitely doable with a parser (albeit not with regex alone). But it's unlikely to be easy or simple. If this is for a real-world project, unless you have a driving reason to write your own markup/programming language, I suggest you consider using an existing solution. If you're describing *expressions* rather than imperative code (e.g. LINQ vs. classic C#), XML or JSON could be good ways to do it.

# shell - 来自 bash 脚本的操作系统系统调用

> ID：10196395
> 
> 赞同：10
> 
> 时间：2012-04-17T17:54:46.800
> 
> 标签：shell, system-calls

是否可以从 shell 脚本调用 os 系统调用，如 open、close 等？我尝试使用谷歌搜索，但它使我使用“system()”命令的方向错误。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T18:01:35.513

许多系统调用是可访问的，但只能通过本机 shell 机制，而不是能够直接指定确切的参数。例如：

```
exec 4>outfile 
```

调用：

```
open("outfile", O_WRONLY|O_CREAT|O_APPEND, 0666) = 3
dup2(3, 4) 
```

（`3`被下一个可用描述符替换），和

```
exec 4<&- 
```

调用：

```
close(4) 
```

一些 shell，例如 bash，允许通过可加载模块添加额外的内置函数（参见`enable`内置函数，用于加载此类模块）；如果您*确实*需要上游未提供的功能，您可以通过这种方式实现它。

# html - 如何让我的文字不在我的css图片下方

> ID：10196398
> 
> 赞同：1
> 
> 时间：2012-04-17T17:54:53.643
> 
> 标签：html, css

我遇到了问题，我打字，我的文字出现在图像下方。如何使文字出现在红色框中的图像之外。我是否必须创建一个表格并指定它的宽度和高度？我想在 css 中完成并将其链接到 htm [http://imgur.com/Yrwdn](http://imgur.com/Yrwdn)

```
 <html>
  <head>
  <link rel="stylesheet" type="text/css" href="body.css"/>
  </head>
  <body>
  <h1>Bully-Free Zone</h1>
  <h2>"Online harassment has an off-line impact"</h2>
  <!--Menu-->
  <div id="nav">
  <a href="mainpage.htm" class="nav-link">HOME</a>
  <a href="page1.htm" class="nav-link">ASSISTANCE</a>
  <a href="page2.htm" class="nav-link">CYBER-BULLYING SIGNS</a> 
  <a href="page3.htm" class="nav-link">REPORT</a>
  </div>
  <img src="nobullying.jpg" id="picture"/>
  <!--Copyright-->
  <div id="center">
  <td> Copyright © 2012 Bully-FreeZone.com</td>
  </div>

  </body>
  </html> 
```

CSS：

```
 h1{color:black;text-align:center;font-size:40px;font-family:broadway;
  }
  h2{color:black; text-align:center;font-size:27px;font-style:italic;}

  /*Menu Buttons Orange*/
  a.nav-link:link
  {
  color: black;
  text-decoration: underline;

  }
  a.nav-link:visited
  {
  color: black;
  text-decoration: none;
  }
  a.nav-link:hover
  {
  color:black;
  text-decoration: overline;
  }
  a.nav-link:active
  {
  color: black;
  text-decoration: none;
  }

  /*Menu button styles*/
  #nav{text-align:center; font-family:"Bernard MT Condensed"; font-size:30px;
  }
  #center{text-align:center;}
  #picture{background-image: url(nobullying.jpg);
  width:200px;
  height:400px;
  position:absolute;
  left:10px;
  Top:190px;
bottom:10px;
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:01:30.110

```
<html>
  <head>
  <link rel="stylesheet" type="text/css" href="body.css"/>
  </head>
  <body>
  <h1>Bully-Free Zone</h1>
  <h2>"Online harassment has an off-line impact"</h2>
  <!--Menu-->
  <div id="nav">
  <a href="mainpage.htm" class="nav-link">HOME</a>
  <a href="page1.htm" class="nav-link">ASSISTANCE</a>
  <a href="page2.htm" class="nav-link">CYBER-BULLYING SIGNS</a> 
  <a href="page3.htm" class="nav-link">REPORT</a>
  </div>

  <div id="content"> YOUR CONTENT HERE </div>

  <img src="nobullying.jpg" id="picture"/>
  <!--Copyright-->
  <div id="center">
  <td> Copyright © 2012 Bully-FreeZone.com</td>
  </div>

  </body>
  </html> 
```

CSS：

```
#content {
   width:800px;
   margin:0 auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:01:58.527

制作该图像`float`而不是使用绝对定位。根据需要使用`margin`以将其放置在正确的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:02:28.683

把它放在一个单独的 div 中并给它一个更高的[z-index](http://www.w3schools.com/cssref/pr_pos_z-index.asp) ??

# ruby-on-rails - 为渲染方法添加参数

> ID：10196399
> 
> 赞同：1
> 
> 时间：2012-04-17T17:55:02.700
> 
> 标签：ruby-on-rails, ruby, json

我希望能够将“params”传递给“is_following”方法，如下所示：

```
 respond_to |format|
          format.json { render json: @user, :methods => [:is_following params] }
       end 
```

但是，当我在方法名称后面加上“params”时，会引发错误：

```
syntax error, unexpected tIDENTIFIER, expecting ']' 
```

.

.

当我渲染 JSON（没有 is_following 方法）时，它看起来像这样：

`[{"id":81,"image_url":"https://graph.facebook.com/123213123/picture?type=large","full_name":"John Johnson"},{"id":85,"image_url":"https://graph.facebook.com/123123123/picture?type=large","full_name":"Bill Nye"}]`

我想添加 is_following 方法，使 JSON 看起来像这样：

`[{"id":81,"image_url":"https://graph.facebook.com/123213123/picture?type=large","full_name":"John Johnson",'is_following'=>4},{"id":85,"image_url":"https://graph.facebook.com/123123123/picture?type=large","full_name":"Bill Nye",'is_following'=>9}]`

**编辑**

```
def friends
  @user = User.first
  respond_to do |format|
    format.json { render json: @user.friends.order("first_name ASC"), :methods => [:is_following], :only => [:id] }
  end
end 
```

模型中的 is_following 方法是：

```
def is_following params
    return Friendship.where("user_id = ? AND friend_id = ?", params[:user_id], self.id).count
end 
```

有谁知道如何解决这个问题？我会给你一百万美元。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-17T19:28:12.890

布莱恩，

只需更改此代码：

```
:methods => [:is_following params] 
```

至

```
:is_following => is_following(params) 
```

编辑

无论如何，这是一个更好的方法：

```
def friends
  @users = User.find_by_sql("SELECT users.*, 
      count(distinct friendships.friend_id) as is_following FROM users
      LEFT JOIN friendships ON users.id = friendships.user_id
      WHERE users.id = " + params[:user_id] + "
      GROUP BY users.id
      ORDER BY users.name ASC")

  respond_to do |format|
    format.json { render json: @users }
  end
end 
```

# android - 如何完全退出安卓应用程序？

> ID：10196404
> 
> 赞同：0
> 
> 时间：2012-04-17T17:55:17.410
> 
> 标签：android, quit

我面临着类似的[问题](https://stackoverflow.com/questions/3421812/destroy-android-application)。我在我的应用程序中使用了一些静态类成员，包括单例。当我使用 finish() 离开主要活动并重新启动它时，所有静态成员仍然存在。调用 Process.killProcess(Process.myPid()); 似乎不是一个好的解决方案；而且我也不想在离开应用程序时取消设置所有静态成员，因为在扩展应用程序时这很容易出错。那么如何正确地完全退出一个android应用程序呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T17:59:03.773

您不理会静态数据成员。他们没有伤害任何人。Android 将在需要内存时终止您的进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:03:41.297

正如@CommonsWare 所说，您可以留下静态成员，Android 操作系统会处理它，如果您仍然需要，您可以覆盖 onDestroy() 并取消所有静态变量。那么当您的应用下次启动时它将为空。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T18:18:48.530

关于这个话题的一些重要观察（我认为）：

这是Android编程的一个重要方面。在此处查看活动生命周期文档[http://developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)并不能很好地解释这种行为 - 我认为。

有一个底层的类加载器概念，它加载类，包括静态变量的所有初始设置。一旦活动停止甚至被破坏，它可能仍会保留在内存中！

当您现在再次启动应用程序时，将采用该类的最后一个状态 - 如果它仍然可以在内存中找到。当类加载器加载和初始化你的类时，类不会像第一次那样被初始化。

这也是为什么在开发/调试期间重新启动应用程序在启动之前真正“清理”整个类，而之后在设备上安装和启动/退出应用程序时，您可能不会像调试期间那样强制“真正”启动。

使变量无效只会增加 GC 的概率。您不得强制卸载 afaik。因此，从这个意义上说，没有办法“完全退出应用程序”。

必须围绕这个系统行为设计应用程序——尤其是更复杂的应用程序。

到目前为止，这是我的理解 - 不幸的是，我还没有找到任何关于此的完整文档。

如果我错了 - 请原谅和纠正！

# c++ - C 中是否有 %* 或 Environment.CommandLine 的等价物？

> ID：10196406
> 
> 赞同：2
> 
> 时间：2012-04-17T17:55:20.757
> 
> 标签：c++, c, command-line-arguments

换句话说，有没有办法在一个字符串中捕获整个命令行（甚至命令行的参数部分），包括所有分隔符？

我明确地不寻找涉及连接 argv 元素的解决方案。此类解决方案假定有关分隔符或参数格式的某些内容。

例如，让我们看下面的程序：

```
#include <stdio.h>

int main(int argc, char** argv){
    int i;
    for (i = 0; i < argc; i++)
        puts(argv[i]);
} 
```

如果我像这样运行它：

```
 Test.exe 1 2 
```

我得到输出：

```
 Test.exe
 1
 2 
```

这不是问题，但是当我像这样运行它时：

```
Test.exe "1" "2" 
```

我得到完全相同的输出，这是一个问题。基本上，我试图获取作为命令行发出的逐字字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:26:46.063

C 中没有内置方法可以将命令行（或参数）作为单个字符串检索，并且所有引号都完好无损，至少语言标准没有定义。部分问题是`argv`数组的定义，部分问题是您的 shell在将参数传递给程序*之前*所做的事情（例如删除引号）：

> **5.1.2.2.1 程序启动...——**
> 如果
> 的值`argc`大于零，则`argv[0]`通过 `argv[argc-1]`inclusive 的数组成员应包含指向字符串的指针，**这些指针在程序启动之前由宿主环境赋予实现定义的值**。目的是从托管环境中的其他地方向程序提供在程序启动之前确定的信息。如果主机环境不能提供大写和小写字母的字符串，则实现应确保以小写形式接收字符串。

强调我的。

*可能*有特定于平台的扩展可以满足您的需求，但我个人不知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:59:14.043

您可以使用 Environment 属性之一

```
Environment.CommandLine 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T17:57:47.580

`int main (int argc, char** argv)`

argc 是参数计数，argv 是参数器。我相信它们是空间分隔的。

如果您想将它们合并到一个字符串中，可以这样做：（请原谅我，如果写得不好）。

```
#include <sstream>
#include <string>
// --------
std::stringstream S;
for (int i = 0; i < argc; ++i)
    S << argv[i];

std::string Str = S.str(); 
```

合并时您可能还想在它们之间添加空格，但是，我认为它没有多大用处，除了调试目的。按原样使用它们，或者放入`vector<string>`通常是最方便的方式。

哦，没有意识到（我总是犯这个错误）它应该是纯 C。在那种情况下，让它们保持原样。我不会删除上面的代码，以防有人在 C++ 中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T18:43:19.077

C 和 C++ 甚至连命令行的*概念都没有。*该程序只是在 的参数中获取它的`argv`参数`main`。如何做到这一点取决于实施。

在 Windows 上，您可以调用[`GetCommandLine`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683156.aspx). 您的程序实际上在启动之前已经调用了它，`main`因为这是 Windows 程序首先作为填充`argv`数组任务的一部分所做的事情。

在 Unix 和 Linux 上，命令行在程序开始运行之前就被解析和分解。命令行参数被传递给[`exec`函数族](http://linux.die.net/man/3/exec)。

如果您需要一种跨平台且可移植的方式来读取逐字命令，我建议您从文件中读取它们，而不是命令行。命令行受命令解释器（如 bash 或 cmd.exe）的处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T18:38:13.467

Unix——这里的 C 显示了它的 unix 起源——有一个参数的概念，而不是命令行的概念。命令行由 shell 解析，shell 将它们拆分为参数，程序只看到参数。

在具有命令行概念的系统上，可以将命令行作为第一个参数传递并让程序解析它们。大多数 C 实现不这样做——至少在默认情况下——它们从命令行进行自己的参数拆分。

根据您的上下文，您可以：

*   接受 C 方式是 Unix 方式，不要试图强加其他东西；
*   重建命令行（但你必须注意引用）；
*   使用系统相关的方式来访问未解析的命令行（如果有的话）。

如果您想要可移植性，第一个可能是最好的，如果您必须遵守与您的实现为参数拆分提供的约定不同的约定，那么最后一个可能是最好的。

# javascript - 如何通过 SoundCloud 上的 Javascript SDK 获取 access_token？

> ID：10196411
> 
> 赞同：5
> 
> 时间：2012-04-17T17:55:29.470
> 
> 标签：javascript, soundcloud

我正在使用 Javascript SDK 来访问 SoundCloud API，但我不知道如何使用 javascript API 来维护连接。每次刷新时，它都会让你重新连接，这对于 UX 来说很糟糕。

如何获取 access_token 以便我可以存储，然后如何重新发送该令牌以进行授权，这样用户每次访问页面时都不需要重新连接。

有大量关于如何使用 PHP 等的文档......但 Javascript SDK 中没有关于访问令牌的内容。

我很确定 SC.isConnected() 函数正在工作，但现在它每次只加载连接按钮。

一切正常，我只是不希望用户每次都重新连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T20:56:59.977

您可以使用 SC.accessToken() 来访问它。我们计划在接下来的 2 个月内提供某种会话持久性和更好的后端集成。

# ruby-on-rails - Ruby on Rails - 设计在用户未登录时不让用户登录

> ID：10196414
> 
> 赞同：1
> 
> 时间：2012-04-17T17:55:43.007
> 
> 标签：ruby-on-rails, ruby, devise

我正在学习 Ruby 和 Devise，出于某种原因，未登录的用户不会被重定向到登录。

这是我的路线：

```
 scope :module => :mobile, :as => :mobile do
    constraints(:subdomain => /m/) do
      devise_for :users, :path => "", :path_names => { :sign_in => "login", :sign_out => "logout", :sign_up => "signup" }, :controllers => {:sessions => "sidebar/sessions"}

      resources :home

      resources :disclosures # Will have new, get, look up a disclosure

      devise_for :users, :path => "", :path_names =>
          { :sign_in => "login", :sign_out => "logout", :sign_up => "signup" }

    end
  end 
```

这是我的控制器：

```
class Mobile::HomeController < ApplicationController
  layout "mobile/application"
  before_filter :authenticate_user!, :only => [:edit, :update, :destroy]

  def index

    respond_to do |format|
      format.html
    end
  end

  def create

  end
end 
```

知道为什么用户没有被重定向到登录吗？现在，用户只是被显示在他只能看到是否经过身份验证的页面。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:04:52.040

改变这一行：

```
before_filter :authenticate_user!, :only => [:edit, :update, :destroy] 
```

到

```
before_filter :authenticate_user!, :only => [:index, :edit, :update, :destroy] 
```

# php - 如何获取文件的前 3 行，然后获取其他所有内容

> ID：10196415
> 
> 赞同：3
> 
> 时间：2012-04-17T17:55:47.367
> 
> 标签：php

我有一个像这样的txt文件：

> 这是第 1 行。
> 
> 这是第 2 行。
> 
> 这是第 3 行。
> 
> 这是其余的。
> 
> 洛雷姆等。

我想使用 PHP 将前三行放入 $variable，然后将文档中的其他所有内容放入 $variable。

我在这方面取得了一定程度的成功：

```
<?php

$file = fopen("text.txt","r");
$count = "0";

while(! feof($file))
  {
  $count++;

  if ($count=="1") {
  $line1 = fgets($file);
  }

  if ($count=="2") {
  $line2 = fgets($file);
  }

  if ($count=="3") {
  $line3 = fgets($file);
  }

//everything else?

}

echo $line1;
echo $line2;
echo $line3;
//echo $everythingelse;

fclose($file);

?> 
```

以下作品：

```
echo fgets($file); 
```

但这不会：

```
$line1 = fgets($file); 
```

那么，A）我做错了什么，B）我如何获取文件的其余部分，C）有没有更好的方法来实现这个？我觉得我的方式很笨拙，有人会建议一些明显的东西可以做到这一切。

多谢你们！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T17:58:52.970

这是最简单的方法，[`file()`](http://php.net/manual/en/function.file.php)它将整个文件读入行数组。然后，您可以使用数组操作，例如[`array_splice()`](http://us3.php.net/manual/en/function.array-splice.php)删除前三个并返回它们，然后使用`\n`.

```
// Reads the file into an array
$lines = file($file);

// Cuts off everything after the first three
$the_rest = array_splice($lines, 3);
// leaving the first three in the original array $lines
$first_three = $lines;

// Stick them back together as strings by implode() with newlines
$first_three = implode("\n", $first_three);
$the_rest = implode("\n", $the_rest); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T17:59:49.010

你可以这样做：

```
$data = file("text.txt");
$beginning = implode(PHP_EOL,array_splice($data,0,3));
$end = implode(PHP_EOL,$data); 
```

使用的函数：[`file`](http://php.net/file)、[`implode`](http://php.net/implode)和[常量](http://us2.php.net/manual/en/reserved.constants.php#constant.php-eol)。[`array_splice`](http://php.net/array-splice)[`PHP_EOL`](http://us2.php.net/manual/en/reserved.constants.php#constant.php-eol)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T18:57:09.113

**A）**您的代码在 if 结束之前都很好：您不能简单地将返回的值分配`fgets`给 a 中的变量`while`，因为循环将在下一次覆盖它，下一行的内容等等，直到它已经到了最后一行，不知何故总是空的。当您直接打印 的输出时`fgets`，`while`将在循环中逐行回显。

**B）**您的代码通过这个小修正运行良好：使用*连接赋值运算符*将该行附加到变量而不是覆盖它。（[字符串运算符](http://php.net/manual/en/language.operators.string.php)）

```
<?php

$file = fopen("text.txt","r");
$count = "0";

while(!feof($file)) {
  $count++;    
    switch ($count) {
        case "1":
            $line1 = fgets($file);
            break;
        case "2":
            $line2 = fgets($file);
            break;
        case "3":
            $line3 = fgets($file);
            break;
        default: 
            $everythingelse .= fgets($file);
    }
}

echo $everythingelse;

fclose($file);

echo "\n\n\n\n\n\n";
echo "Plus, here is line one: ".$line1."\n";
echo "This is line three: ".$line3."\n";
echo "And finally, line two: ".$line2."\n"; 
```

（我也用一个开关替换了你的 if ，这也是一样的）

示例输出： ![输出截图](../Images/3387c9a74c974b12c6e31ddacb7502cc.png)

**C）**我认为你的方法修复了它对你的目的很好，特别是如果你已经通过 fgets 获取了文件内容（因此使用了一段时间）。这种方法是原生的，可以像你一样在一段时间内工作。当然，您也可以按照 Kolink 和 Michael 的建议使用`implode`，这甚至可能更快。

# java - 服务器无缘无故返回 415 HTTP 代码

> ID：10196419
> 
> 赞同：2
> 
> 时间：2012-04-17T17:56:08.267
> 
> 标签：java, android, spring, http-error

我正在使用 Spring for Android RestTemplate 类发送一个对象。它发送有效的 JSON（我已经检查了每一种方式），http 标头和内容类型是正确的。

发送对象：

```
try {
            Event event = new Event();
            // Set event parameters.
            RestTemplate restTemplate = new RestTemplate();
            String url = Const.ADD_EVENT_REQUEST + Const.getRequiredRequestParameters(app);
            return restTemplate.postForObject(url, event, Boolean.class);
        } catch (Exception e) {
            Log.e("Add event task", e.getMessage(), e);
            return false;
        } 
```

在服务器上接收对象：

```
@RequestMapping(value = "/add", method = RequestMethod.POST)
    public @ResponseBody Boolean createEvent(@RequestBody Event event) {
        try {
            Logger.getLogger(EventRestAction.class).info("saving event " + event);
            eService.save(event);
            return true;
        } catch (Exception e) {
            Logger.getLogger(EventRestAction.class)
            .error(e.getMessage(), e);
            return false;
        }
    } 
```

“保存事件”日志从不打印。服务器返回 415 Unsupported media type 错误。

以防万一，这里是`dispatcher-servlet.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

    <context:component-scan base-package="ee.lapikud.ttyapp" />
    <mvc:annotation-driven />

    <mvc:interceptors>
        <bean class="ee.lapikud.ttyapp.interceptor.RequestSecurityInterceptor" />
    </mvc:interceptors>

</beans> 
```

这个问题很广泛，但我很困惑——这可能是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:24:51.833

这肯定是由于`content-type`HTTP 请求/响应的标头。你能确定它们都是`application/json`双向的吗？

**更新**：终于为我工作的 Spring 配置（评论）

```
<bean
      class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <property name="order" value="1"/>
    <property name="mediaTypes">
      <map>
        <entry key="json" value="application/json"/>
      </map>
    </property>
    <property name="defaultContentType" value="application/json"/>
    <property name="defaultViews">
      <list>
        <bean
            class="org.springframework.web.servlet.view.json.MappingJacksonJsonView"/>
      </list>
    </property>
    <property name="ignoreAcceptHeader" value="true"/>
  </bean> 
```

# java - Java中COM端口上的友好名称？

> ID：10196424
> 
> 赞同：1
> 
> 时间：2012-04-17T17:56:37.263
> 
> 标签：java

我正在从事一个必须在 COM 端口访问的项目。我目前正在使用 winjcom 获取访问权限并列出连接的设备。我的问题是我希望显示友好名称，而不仅仅是 COM3、COM4 等。

我找到了一个线程

[获取与 COM 端口相关的设备/驱动程序信息？](https://stackoverflow.com/questions/6362775/getting-device-driver-information-related-to-a-com-port)

这可以获得友好的名称，但这是基于我知道 PID、VID 和设备 ID 的面孔。我想在所有连接的设备上安装它。

希望你们能帮助我。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-19T11:46:18.667

使用 JNA ( [https://github.com/twall/jna](https://github.com/twall/jna) ) 并查看以下页面。这可能是一个有用的起点。

[http://www.digitalinferno.com/wiki/Wiki.jsp?page=JNAPrintDevices](http://www.digitalinferno.com/wiki/Wiki.jsp?page=JNAPrintDevices)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T14:38:31.330

例如，我使用 [https://stackoverflow.com/a/15348278/398348](https://stackoverflow.com/a/15348278/398348) 中的代码调用 WinRegistry.getStringSubKeys()。看，你不需要知道设备ID。您可以使用相同的逻辑，但可能必须在代码中使用递归来遍历较低的分支。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-04T22:45:22.187

此代码通过 JNA 使用 windows dll setupapi 来获取 COM 端口的描述：

```
final SetupApi2 setupApi = SetupApi2.INSTANCE;
int SPDRP_FRIENDLYNAME = 12;

WinNT.HANDLE handle = setupApi.SetupDiGetClassDevsA(null, null, null, SetupApi.DIGCF_ALLCLASSES);

SetupApi.SP_DEVINFO_DATA devInfo = new SetupApi.SP_DEVINFO_DATA();
int indice = 0;

while (setupApi.SetupDiEnumDeviceInfo (handle, indice, devInfo) 
    ) {
        char[] windowText1 = new char[255];
    IntByReference flag = new IntByReference(0);

    IntByReference PropertyRegDataType = new IntByReference();
    byte[] descripcionByte = new byte[255];

    if ((setupApi.SetupDiGetDeviceInstanceIdA(handle, devInfo, windowText1, windowText1.length, flag))) {
        if ((setupApi.SetupDiGetDeviceRegistryPropertyA(handle, devInfo, SPDRP_FRIENDLYNAME, PropertyRegDataType, descripcionByte, descripcionByte.length, flag))) {
            String descripcionString = Native.toString(descripcionByte);
            System.out.println(descripcionString);
        }
    }
    indice++;
}

import com.sun.jna.Library;
import com.sun.jna.Native;
import com.sun.jna.Pointer;
import com.sun.jna.Structure;
import com.sun.jna.platform.win32.Guid.GUID;
import com.sun.jna.platform.win32.SetupApi;
import com.sun.jna.platform.win32.SetupApi.SP_DEVICE_INTERFACE_DATA;
import com.sun.jna.platform.win32.SetupApi.SP_DEVINFO_DATA;
import com.sun.jna.platform.win32.WinBase;
import com.sun.jna.platform.win32.WinDef;
import com.sun.jna.platform.win32.WinNT;
import com.sun.jna.ptr.IntByReference;
import java.util.Arrays;
import java.util.List;

public interface SetupApi2 extends Library {

SetupApi2 INSTANCE = (SetupApi2) Native.loadLibrary("setupapi", SetupApi2.class);

public static class HDEVINFO extends WinNT.HANDLE {
}

public static class SP_DRVINFO_DATA extends Structure {

    public SP_DRVINFO_DATA() {
        DriverDate = new WinBase.FILETIME();
    }
    public int cbSize;
    public int DriverType;
    public int Reserved;
    public char[] Description = new char[255];
    public char[] MfgName = new char[255];
    public char[] ProviderName = new char[255];
    public WinBase.FILETIME DriverDate;
    public int DriverVersion;

    protected List getFieldOrder() {
        return Arrays.asList("cbSize",
                "DriverType",
                "Reserved",
                "Description",
                "MfgName",
                "ProviderName",
                "DriverDate",
                "DriverVersion");
    }
}

public static class SP_DEVICE_INTERFACE_DETAIL_DATA extends Structure {

    public static class ByReference extends SP_DEVINFO_DATA implements Structure.ByReference {

        public ByReference() {
        }

        public ByReference(Pointer memory) {
            super(memory);
        }
    }

    public SP_DEVICE_INTERFACE_DETAIL_DATA() {
        cbSize = size();
        setAlignType(Structure.ALIGN_NONE);
    }

    public SP_DEVICE_INTERFACE_DETAIL_DATA(int size) {
        cbSize = size();
        devicePath = new char[size];
        setAlignType(Structure.ALIGN_NONE);
    }

    public SP_DEVICE_INTERFACE_DETAIL_DATA(Pointer memory) {
        super(memory);
        read();
    }

    /**
     * The size, in bytes, of the SP_DEVINFO_DATA structure.
     */
    public int cbSize;

    public char[] devicePath = new char[1];

    protected List getFieldOrder() {
        return Arrays.asList("cbSize",
                "devicePath");
    }
}

public static int DIGCF_DEFAULT = 0x00000001;
public static int DIGCF_PRESENT = 0x00000002;
public static int DIGCF_ALLCLASSES = 0x00000004;
public static int DIGCF_PROFILE = 0x00000008;
public static int DIGCF_DEVICEINTERFACE = 0x00000010;
public static int SPDRP_DRIVER = 0x00000009;
public static int SPDRP_INSTALL_STATE = 0x00000022;

WinNT.HANDLE SetupDiGetClassDevsA(GUID Guid, String Enumerator, WinDef.HWND Parent, int Flags);

boolean SetupDiEnumDeviceInfo(WinNT.HANDLE DeviceInfoSet, int MemberIndex, SP_DEVINFO_DATA DeviceInfoData);

int SetupDiEnumDeviceInterfaces(HDEVINFO DeviceInfoSet, SP_DEVINFO_DATA DeviceInfoData, GUID Guid, int MemberIndex, SP_DEVICE_INTERFACE_DATA DeviceInterfaceData);

int SetupDiGetDeviceInterfaceDetail(HDEVINFO DeviceInfoSet, SP_DEVICE_INTERFACE_DATA DeviceInterfaceData, SP_DEVICE_INTERFACE_DETAIL_DATA DeviceInterfaceDetailData, int DeviceInterfaceDetailDataSize, IntByReference RequiredSize, SP_DEVINFO_DATA DeviceInfoData);

int SetupDiDestroyDeviceInfoList(HDEVINFO DeviceInfoSet);

boolean SetupDiGetDeviceInstanceIdA(WinNT.HANDLE DeviceInfoSet, SP_DEVINFO_DATA DeviceInfoData, char[] DeviceId, int DeviceInstanceIdSize, IntByReference RequiredSize);

boolean SetupDiClassNameFromGuid(GUID Guid, char[] ClassName, int ClassNameSize, IntByReference RequiredSize);

boolean SetupDiGetSelectedDriver(HDEVINFO DeviceInfoSet, SP_DEVINFO_DATA DeviceInfoData, SP_DRVINFO_DATA DriverInfoData);

boolean SetupDiClassGuidsFromName(String ClassName, GUID[] ClassGuidList, int ClassGuidListSize, IntByReference RequiredSize);

boolean SetupDiGetDeviceRegistryPropertyA(WinNT.HANDLE DeviceInfoSet, SP_DEVINFO_DATA DeviceInfoData, int Property, IntByReference PropertyRegDataType, byte[] PropertyBuffer, int PropertyBufferSize, IntByReference RequiredSize);
} 
```

# php - 加载保存为 PHP 文件的 Selenium 测试用例

> ID：10196426
> 
> 赞同：0
> 
> 时间：2012-04-17T17:56:41.053
> 
> 标签：php, selenium

我想要/需要将我的 Selenium 测试用例保存为 PHP 文件而不是 HTML。我找到了用于将 PHP 测试用例和套件导出到 PHP 的不错插件，但我找不到使用 Selenium IDE 打开保存文件的方法。

有没有办法做到这一点，如果有，怎么做？

[问题的背景是我会做一些我怀疑人们会将敏感信息放入（db和其他登录凭据）中的测试用例，然后放在实时服务器上。将测试存储为 PHP 文件，即使在 Web 主机上，这些信息也会相当安全。将测试存储为 HTML，信息将不安全。]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:01:30.773

Selenium IDE 允许您以 HTML 格式**保存**和**加载**测试套件。Selenium IDE 还允许您将测试套件**导出**到其他 Selenium 绑定（PHP、Ruby、C# 等）。导出的文件旨在从这些绑定中执行，它们*不*打算导入回 Selenium IDE。

鉴于背景，您最好将测试套件保存为 HTML 并管理服务器上的文件权限，以便它们在外部不可见。

另一种方法是将套件导出到 PHP 并从 PHP 运行它们。但是在这种情况下，您必须确保导出的案例是正确的（通常不是这种情况），然后您必须自己管理在 PHP 中运行这些案例（因为您不能再使用 IDE）。

# bash - 如何使“-persist”对 GNUPLOT 独一无二

> ID：10196430
> 
> 赞同：2
> 
> 时间：2012-04-17T17:56:54.847
> 
> 标签：bash, gnuplot

我正在使用 bash 从脚本中提供 gnuplot。你怎么只弹出一个窗口？假设你跑

```
#!/bin/bash 
for((i=1;i<6;i++)) do
  echo "plot sin(x)"
done | gnuplot -persist 
```

您将获得 5 个相同情节的窗口。有没有只买一个的选项？

* * *

上面有一个错误。那不完全是我正在做的那种运行时。更像是运行下一个脚本，比如 5 次

```
#!/bin/bash 
echo "plot sin(x)" 
```

我刚刚意识到我想要做的是在创建新进程之前杀死最新的 gnuplot 进程。

对此感到抱歉。今天好累 :D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T12:45:44.740

gnuplot x11 终端使用一个单独的程序`gnuplot_x11`来显示结果。从帮助

```
The `xlib` terminal driver supports the X11 Windows System.  It generates
 gnuplot_x11 commands, but sends them to the output file specified by
 `set output '<filename>'`. `set term x11` is equivalent to
 `set output "|gnuplot_x11 -noevents"; set term xlib.`
 `xlib` takes the same set of options as `x11`. 
```

所以，如果你想杀死在 a 之后剩余的地块`gnuplot -persist`，它应该就足够了`killall gnuplot_x11`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:08:26.477

以下情况如何：

```
 echo `for((i=1;i<6;i++))
  do
    echo 'plot sin(x)'
  done` | gnuplot -persist 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T22:04:54.393

您可能对较新版本的 Gnuplot 中可用的迭代功能感兴趣（请参阅[用户指南](http://www.gnuplot.info/docs_4.6/gnuplot.pdf)中的迭代部分）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T04:31:44.900

在一个脚本中，一个可以

```
 echo "set grid" > gpfile
    tail -f  gpfile | gnuplot  '-' 
```

然后在另一个进程中，可以将任何 gnuplot 命令写入 gpfile

```
 echo "plot \"whatever\" " >> gpfile
    sleep 3
    echo "replot" >> gpfile 
```

...ETC

它对于实时过程控制显示很有用，其中一些状态文件

正在定期更新。

# c# - 获取 CLR ID

> ID：10196432
> 
> 赞同：9
> 
> 时间：2012-04-17T17:57:12.080
> 
> 标签：c#, winforms, clr

是否有任何地方可以在运行时为当前应用程序获取 CLR ID？我正在使用性能监视器监视我的系统，用于实例的名称是：

```
ApplicationName.exe_p4952_r15_ad1 
```

我可以通过编程方式获取所有其他参数，但不能获取`r15`执行代码的公共语言运行时（实例）的运行时 ID。我注意到它总是 15，但最好动态获取它以避免并发症。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T07:49:00.033

您可以获得整个“后缀”，即`Application.exe`使用与 .NET 框架（例如性能计数器）相同的基础架构后的部分。

有方法[System.Runtime.Versioning.VersioningHelper.MakeVersionSafeName](http://msdn.microsoft.com/en-us/library/ms147560%28v=vs.100%29.aspx)可以做到这一点。请注意，该方法被描述为“基础架构”和“此 API 支持 .NET Framework 基础架构，不打算直接从您的代码中使用。”，但仍然是公共的。我认为没有任何“更好的支持”方式来获取您想要的信息。至少它对未来的变化更加健壮和有弹性，然后根据文档对信息进行逆向工程。

```
string suffix = System.Runtime.Versioning.VersioningHelper.MakeVersionSafeName("",                         
    System.Runtime.Versioning.ResourceScope.Machine,
    System.Runtime.Versioning.ResourceScope.AppDomain)); 
```

`_p4472_r16_ad1`例如，这将返回。

当然，也可以直接传递性能计数器的basename，直接得到全名。上面空字符串的使用只是获取“后缀”的一个技巧。

```
string str = VersioningHelper.MakeVersionSafeName("Application.exe",
    ResourceScope.Machine, ResourceScope.AppDomain);

// str -> "Application.exe_p4472_r16_ad1". 
```

该类`VersioningHelpers`也有私有方法`GetRuntimeId()`，但鉴于上述情况，我认为没有必要使用反射来实现您所需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:16:14.850

据我所知，无法预测该值将是什么 - 这是[您链接的 MSDN 页面](http://msdn.microsoft.com/en-us/library/dd537616.aspx)的引用（强调我的）

> runtimeID 是**公共**语言运行时标识符。

这篇文章有点令人困惑，因为它提供了一个示例，其中一个应用程序`myapp.exe`托管两个 CLR 运行时，但是在该示例中，这两个实例似乎具有不同的进程 ID，但具有相同的 CLR 运行时 ID。

然而，这篇文章绝对没有给出任何关于 CLR 运行时 ID 的值是什么或如何找到它的承诺（它甚至没有说明它是一个数字），这对我来说意味着它是一个内部的东西，而你不应该依赖于能够弄清楚它是什么。

我的方法可能是枚举所有 Perfmon 计数器并监视与您的 PID 匹配的任何计数器。如果有多个（如果您使用任何 .Net 2.0 组件就会发生这种情况），那么您只需要监控两者。

你能提供更多关于你想要做什么的信息吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T15:17:19.030

您可以通过拆分获得的字符串轻松找到它：

此函数拆分实例名称，并搜索唯一以“r”开头且不以“.exe”结尾的部分。一旦找到字符串的正确部分，只需删除第一个字母“r”并保留数字以将其转换为整数并返回。如果没有找到 CLR ID，只需返回“-1”让父函数注意到这一点。

```
 int getClrID(string instance_name)
    {
        string[] instance_name_parts = instance_name.Split('_');
        string clr_id = "";

        for (int i = 0; i < instance_name_parts.Length; i++)
        {
            if (instance_name_parts[i].StartsWith("r") && !instance_name_parts[i].EndsWith(".exe"))
            {
                clr_id = instance_name_parts[i];
                break;
            }
        }

        if (clr_id == "") // An error occured ...
            return -1;
        else 
            return Convert.ToInt32(clr_id.Substring(1));
    } 
```

我希望我对你有所帮助。

# java - 使用 SSLEngine (JSSE) 与旧客户端进行 SSL 握手

> ID：10196436
> 
> 赞同：2
> 
> 时间：2012-04-17T17:57:23.657
> 
> 标签：java, ssl, jsse, sslengine

[这是“使用自签名证书和 SSLEngine (JSSE)](https://stackoverflow.com/questions/9604532/ssl-handshaking-using-self-signed-certs-and-sslengine-jsse)进行 SSL 握手”的后续问题。

我已经实现了一个 NIO Webserver，它可以在同一个端口上处理 SSL 和非 SSL 消息。为了区分 SSL 和非 SSL 消息，我检查入站请求的第一个字节，看它是否是 SSL/TLS 消息。例子：

```
byte a = read(buf);
if (totalBytesRead==1 && (a>19 && a<25)){
    parseTLS(buf);
} 
```

在 parseTLS() 方法中，我实例化了一个 SSLEngine、启动握手、包装/解包消息等。对于大多数现代 Web 浏览器（Firefox 10、IE 9、Safari 5 等）来说，一切似乎都运行良好。

问题是 IE 6 等较旧的 Web 浏览器和 Java 的 URLConnection 类等库似乎以不同的方式启动 SSL/TLS 握手。例如，IE 6 的前几个字节看起来像这样（十六进制值）：

```
80 4F 01 03 00 ... 
```

如果我将消息传递给 SSLEngine，它似乎无法识别该消息并引发异常。

```
javax.net.ssl.SSLException: Unsupported record version Unknown-0.0 
```

那么 IE 6 和 Java 的 URLConnection 类到底发送了什么？这是 JSSE SSLEngine 可以支持的有效 SSL/TLS 消息吗？我是否必须进行一些预处理或与客户端协商以发送不同的消息？

提前致谢！

**更新**

感谢 Bruno 和 EJP 以及一些进一步的调试，我对正在发生的事情有了更好的理解。正如布鲁诺正确指出的那样，IE6 和 Java 6 客户端通过 SSLv2 ClientHello 发送。与我之前的评论相反，Java 1.6 中的 SSLEngine 实际上可以解开 SSLv2 消息并生成有效响应以发送回客户端。我之前报告的 SSLException 是我这边的一个错误，与 SSLEngine 无关（我错误地认为客户端已完成发送数据，而当 SSLEngine 期望更多数据解包时，我最终得到一个空的 ByteBuffer）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T20:01:38.480

这看起来像[SSLv2 Client Hello（请参阅 TLS 规范）](https://www.rfc-editor.org/rfc/rfc4346#appendix-E)：

> 支持 SSL 2.0 版服务器的 TLS 1.1 客户端必须发送 SSL 2.0 版客户端问候消息 [SSL2]。如果 TLS 服务器希望在同一连接端口上支持 SSL 2.0 客户端，则它们应该接受任一客户端问候格式。与 2.0 版规范的唯一偏差是能够指定值为 3 的版本，以及在 CipherSpec 中支持更多加密类型。

*   `80 4F`是长度，高位必须设置为 1（见[`msg_length`说明](https://www.rfc-editor.org/rfc/rfc4346#appendix-E.1)）。
*   `01`是消息类型（Client Hello）
*   `03 00`是支持的最高版本（此处为 SSLv3）

从 Java 7 开始，[现在默认禁用此功能](http://docs.oracle.com/javase/7/docs/technotes/guides/security/enhancements-7.html)。

**编辑：**

澄清一下，这并不是真正的 SSLv2 Client Hello，这是 SSLv2 格式的 SSLv3 的 Client Hello。在这种情况下，服务器将回复一个（正确的）SSLv3 Server Hello（对应于`03 00`请求的版本号）。这同样适用于 TLS 1.0、1.1 和 1.2，尽管这种格式的使用逐渐被弃用。

JSSE 7`SSLServerSocket`仍会理解这样的客户端问候，并使用 SSLv3/TLS1.x 服务器问候进行适当的回复。

# php - XAMPP 的非特定错误

> ID：10196438
> 
> 赞同：0
> 
> 时间：2012-04-17T17:57:38.220
> 
> 标签：php, html

我知道 XAMPP 在 Win 7 上遇到了很多问题。所以我成功安装了它，现在我遇到了以前从未遇到过的非特定错误。

我在 HTML 中有一个简单的 -tag

```
<form method="post" action="site.php">
  <input type="text" name="NAME">
</form> 
```

我的 PHP 代码也就是这么简单：

```
<?php 
  $something = $_POST['NAME'];
?> 
```

当我启动 XAMPP 并在“htdocs”中打开这个 HTML 时，出现了一个问题/通知：

> 注意：未定义的索引：在第 40 行的 C:\xampp\htdocs\test.php 中

那只是一个XAMPP错误吗？因为我以前从未遇到过这个问题，而且看起来很正确。我想我正在使用 XAMPP 1.7.7。

问候 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:15:59.647

当您使用在此之前尚未设置的数组索引的值时，会弹出“未定义索引”通知：

```
<?php
$myarray = array('a'=>1, 'b'=>2);
var_dump($myarray['a']); //outputs int(1) as this is defined
var_dump($myarray['c']); //we defined 'a' and 'b' but not 'c'.
?> 
```

第三行将给出：“注意：未定义的索引：第 3 行 C:\xampp\htdocs\test.php 中的 c”。

这通常在您访问 $_GET 或 $_POST 数组时发生。大多数情况下，原因是您拼错了索引（例如，您键入`$_POST['tset']`了而不是`$_POST['test']`），或者因为您`<input>`在提交信息的 HTML 表单中编辑了一个元素，然后忘记重新调整 PHP 代码。

您可以通过使用如下方式测试索引是否存在来确保一切正常`isset()`：

```
if( isset($_POST['test']) ) {
    $myvar = $_POST['test'];
    //and then whatever else you intended
}
else {
    //the index wasn't defined - you made a mistake, or possibly the user deliberately removed an input from the submitting form
    $error = "POST-array is missing the index 'test'!";
    //and now make sure that things after this which rely on the 'test' value don't run
} 
```

您会在*很多*脚本中找到一个非常常见的行：

```
$myvar = isset($_POST['test']) ? $_POST['test'] : 'N/A'; 
```

这使用 if-else 结构的特殊 PHP 简写。这条线的作用与以下内容几乎完全相同：

```
if( isset($_POST['test']) ) {
    $myvar = $_POST['test'];
}
else {
    $myvar = 'N/A';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:02:17.710

你应该做这个：

```
<?php
if(isset($_POST['NAME'])){
    $something = $_POST['NAME'];
}
?> 
```

当您打开该页面时，在`$_POST['NAME']`您提交该数据之前没有。

# c# - 在同一窗口 WPF 中切换视图而不创建页面的新实例

> ID：10196445
> 
> 赞同：3
> 
> 时间：2012-04-17T17:58:03.260
> 
> 标签：c#, .net, wpf

我的应用程序有 3 个页面（一个 MainWindow 和 2 个进行简单选择的页面）。

[目前我使用以下导航结构在页面http://azerdark.wordpress.com/2010/04/23/multi-page-application-in-wpf/](http://azerdark.wordpress.com/2010/04/23/multi-page-application-in-wpf/)之间切换。它基本上使用一个接口来传递页面的引用并创建新实例。

这个想法是我一次只能打开一个窗口。例如，当我从页面 A 导航到 B 时，B 替换了 A 的内容。顺序始终是 A -> B -> C -> A（返回主窗口）或 A -> B -> A。

换句话说，所有内容始终显示在 1 个窗口中。使用我当前的解决方案，我遇到的问题是每次切换时都会实例化一个新的页面实例（例如 A -> B -> A 有 2x New PageA() 结果。

这反过来导致不得不使用很多我不太喜欢的静态方法和类。

有没有更好的解决方案，不需要对我当前的应用程序导航结构进行全面检查？

在我当前的解决方案中，我使用静态 ObversableCollection 列表来记住许多动态创建的控件，因此当我返回页面 A（主窗口）时，一切都保持不变。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T18:11:41.383

我真的不明白你为什么要在如此简单的设置中使用导航（3 页和固定的导航结构）。更简单的方法是：

1.  使用 MainWindow 作为内容占位符
2.  将用户控件创建为页面
3.  定义静态类以将页面保存在不同的属性中。如果需要，初始化它们（单例实例）。
4.  使用 MainWindow.SetPage(Pages.First) 更改页面。

在代码中，这几乎看起来像这样：

```
public class MainWindow : Window
{
    // ...
    public void SetPage(UserControl page)
    {
         this.Content = page;
    }
}

// ...

public static class Pages
{
    private FirstUserControl _first;
    private SecondUserControl _second;
    private ThirdUserControl _third;
    private MainWindow _window = Application.Current.MainWindow;

    public UserControl First
    {
        get 
        { 
            if (_first == null) 
                _first =  new FirstUserControl();
            return _first;
        }
    }
    // ...
}

// Somewhere in B (after A -> B)

    MainWindow.SetPage(Pages.First); 
```

虽然如果你真的需要导航，你可以只使用它的静态部分并将单例实例传递给你的 SwitchPage 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-16T13:24:30.800

```
public partial class MainWindow : Window
{

    string un;
    string pw;

    public MainWindow()
    {
        InitializeComponent();
    }

    private void Button_Click_1(object sender, RoutedEventArgs e)
    {

        un = txtName.Text;
        pw = txtPw.Text;

        if (un.Equals("steve") && pw.Equals ("cool"))
        {
            Home h= new Home();
            this.Content = h.Content; ***// this is where we change the window's contents***

        }
    }
} 
```

# terminal - 在终端中安装 Sublime Text 的命令行工具“subl”，权限被拒绝？

> ID：10196449
> 
> 赞同：53
> 
> 时间：2012-04-17T17:58:24.603
> 
> 标签：terminal, osx-lion, sublimetext

我正在尝试从终端使用 Sublime Text，例如通过键入`subl`.

我正在遵循 Sublime Text 网站上的步骤：

> 设置
> 
> 第一个任务是创建一个到 subl 的符号链接。假设您已将 Sublime Text 2 放在 Applications 文件夹中，并且您的路径中有 ~/bin 目录，您可以运行：

```
ln -s "/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl" ~/bin/subl 
```

我不断得到`permission denied : ~/bin/subl: Permission Denied`

我一直在寻找类似的问题，但找不到适用的问题。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-06-14T10:51:09.713

我假设您没有 bin 目录。您可以执行以下操作：

```
cd 
mkdir bin
sudo ln -s "/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl" ~/bin/subl 
```

`ln -s`将在您的 bin 目录中创建 subl 文件的别名，您将能够运行该命令。

如果这仍然不起作用，您将不得不编辑您的 .bash_profile。您可以通过以下命令执行此操作：（注意：为此，您需要已经完成上述步骤。）

1.  打开你的 .bash_profile：

    ```
    cd                  // this will get you back to home directory
    vim .bash_profile   // this will open your .bash_profile file 
    ```

2.  编辑 .bash_profile：按 I 进入“插入”模式并添加以下内容：

    ```
    export PATH=$PATH:~/bin 
    ```

3.  保存并退出。按 Esc 进入命令模式：

    ```
    :wq   // saves and close file
    exit  // exits terminal 
    ```

4.  重新打开终端：

    ```
    subl --help 
    ```

这应该会为 Sublime Text 带来帮助。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-04-16T12:05:42.983

我个人对第三方应用程序特定符号链接（例如`subl`、`brew`、`github`、`mate`等）路径的偏好是：

```
/usr/local/bin 
```

为什么不`/usr/bin/`呢？

1.  `/usr/bin`是一个“神圣”的地方。通常*建议*存储由[包管理系统](http://en.wikipedia.org/wiki/List_of_software_package_management_systems)维护的静态二进制文件。`subl`不是这种情况。

2.  `subl`不够*稳定*，无法`/usr/bin`与其他基本 BSD 二进制文件（例如`find`、`man`、`make`等）一起存储。`subl`如果 (a) Sublime Text Editor 的开发人员决定在未来的版本中更改其应用程序名称（因为[BBEdit Lite 在 6.1 版之后更改为 TextWrangler](http://www.macworld.com/article/1042147/textwrangler.html)），或者 (b) 您可能只是希望卸载 Sublime 文本编辑器。

* * *

因此，我建议您执行以下行，假设`/usr/local/bin/`存在：

```
ln -s "/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl" /usr/local/bin/subl 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-06-06T15:46:46.300

检查路径中是否包含“~/bin/”。

更好的选择是在 /usr/bin 目录中创建符号链接。

```
sudo ln -s "/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl" /usr/bin/subl 
```

# c++ - 如何检测winsock2中的异常断开连接？

> ID：10196459
> 
> 赞同：0
> 
> 时间：2012-04-17T17:58:47.487
> 
> 标签：c++, winsock

对于非阻塞套接字，我知道`recv()`如果远程客户端正常断开连接（假设我们是服务器），它将返回 0 而没有错误代码。您将如何检测异常断开连接？仍然会`recv()`返回 0，还是有其他方法可以使用 API 来检测这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:23:06.873

如果连接在物理上断开或其他主机在没有正常关闭套接字的情况下关闭，您`recv`将永远等待。在套接字级别，您可以使用[`select()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740141%28v=vs.85%29.aspx)和设置超时等待数据可用于在套接字上读取。您将在循环中使用它，如果数据可用 - 读取它 ( `recv()`); 如果`select()`超时，请优雅地关闭套接字并重新连接。

另一种解决方案是在您的协议中实现保活。一侧定期发送保持活动消息，另一侧有一个设置了超时（根据发送周期调整）的计时器并正在等待它们。如果计时器超时，“等待”主机将关闭其套接字并尝试重新连接。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-17T18:12:26.043

查看 MSDN 中的 recv()，尤其是它返回的内容。一切都会揭晓！

# regex - 正则表达式单词边界不包括连字符

> ID：10196462
> 
> 赞同：36
> 
> 时间：2012-04-17T17:59:01.670
> 
> 标签：regex

我需要一个匹配以单词边界结尾的表达式的正则表达式，但它不将连字符视为边界。即获取匹配的所有表达式

```
type ([a-z])\b 
```

但不匹配，例如

```
type a-1 
```

换种说法：我想要一个等效的单词边界运算符 \b ，而不是使用单词 character class `[A-Za-z0-9_]`，而是使用扩展类：`[A-Za-z0-9_-]`

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-17T18:03:06.110

您可以为此使用前瞻，最短的方法是使用负前瞻：

```
type ([a-z])(?![\w-]) 
```

`(?![\w-])`意味着“如果下一个字符在`\w`或是”，则匹配失败`-`。

这是一个使用正常前瞻的选项：

```
type ([a-z])(?=[^\w-]|$) 
```

您可以阅读`(?=[^\w-]|$)`为“仅当下一个字符**不在**字符类中时才匹配`[\w-]`，或者这是字符串的结尾”。

看到它工作：[http ://www.rubular.com/r/NHYhv72znm](http://www.rubular.com/r/NHYhv72znm)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-08-28T01:52:34.687

我有一个非常相似的问题，只是我不想将“*”视为边界字符。这是我所做的：

```
\b(?<!\*)([^\s\*]+)\b(?!*) 
```

基本上，如果您处于单词边界，请回看一个字符，如果前一个字符是“*”，则不匹配。如果你在中间，不要在空格或星号上匹配。如果您在末尾，请确保末尾不是星号。在你的情况下，我认为你可以使用 \w 而不是 \s。对我来说，这适用于以下情况：

```
*word
wo*rd
word* 
```

# asp.net - 从父 web.config 中删除子 web.config 中的密钥

> ID：10196468
> 
> 赞同：0
> 
> 时间：2012-04-17T17:59:39.860
> 
> 标签：asp.net, web-config

当从父 web.config 继承时，[remove 元素允许您从子 web.config 中删除一个键。](http://msdn.microsoft.com/en-us/library/ms228241.aspx)有可能做相反的事情吗？我想替换父项中已经在子项中定义的键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:01:28.843

不，您不能从“子”配置中删除密钥。

继承是另一种方式，只有这种方式。

根据需要在父项中定义键，在子项中删除并添加它。

# iphone - 有一个 url 出现在 UITextview

> ID：10196478
> 
> 赞同：1
> 
> 时间：2012-04-17T18:00:17.333
> 
> 标签：iphone, objective-c, ios, xcode

此代码可以很好地使 url 出现在 UITextview

```
UITextView * descriptionTextView = [[UITextView alloc] initWithFrame:CGRectMake(10, 50, 300, 300)];
descriptionTextView.textColor = [UIColor whiteColor]; 
descriptionTextView.dataDetectorTypes = UIDataDetectorTypeLink;
descriptionTextView.font = [UIFont fontWithName:@"Helvetica" size:16];  
descriptionTextView.backgroundColor = [UIColor clearColor]; 
descriptionTextView.text = @"Click to go to the google website, http://www.google.com ";
descriptionTextView.autocorrectionType = UITextAutocorrectionTypeNo;    
descriptionTextView.keyboardType = UIKeyboardTypeDefault;  
descriptionTextView.returnKeyType = UIReturnKeyDone;  
descriptionTextView.editable = NO;
descriptionTextView.tag = 1;
[self.view addSubview:descriptionTextView]; 
```

问题是我写的整个网址都出现了，[http://www.google.com](http://www.google.com)

有没有办法只用一个词来包含链接？因此，用户只能看到以蓝色书写的“Goggle”，当他们点击该作品时，它会打开 safari。

非常感谢，-代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:41:57.543

你可以使用**UIWebview**

采用

```
- (void)loadHTMLString:(NSString *)string baseURL:(NSURL *)baseURL; 
```

并对整个消息进行编码，然后将链接包装到

```
[webView.loadHTMLString:@"<a href="http://www.google.com/">Google</a>" baseURL:nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-10T08:32:10.377

我知道这是超级老线程。UITextView 支持富文本/HTML。您应该创建 NSAttributedString 并将其分配给属性文本属性以使用非纯文本内容进行操作。像这样：

```
 NSString *htmlString = @"<your HTML code>";
        textView.attributedText = [[NSAttributedString alloc] initWithData:[htmlString dataUsingEncoding:NSUnicodeStringEncoding]
                                                           options:@{NSDocumentTypeDocumentAttribute: NSHTMLTextDocumentType,
                                                                     NSCharacterEncodingDocumentAttribute: @(NSUTF8StringEncoding)}
                                                documentAttributes:nil
                                                             error:nil]; 
```

# c# - 修整浮子

> ID：10196481
> 
> 赞同：3
> 
> 时间：2012-04-17T18:00:30.800
> 
> 标签：c#, winforms, floating-point, digit

> **可能重复：**
> [点后仅保留两位小数 将](https://stackoverflow.com/questions/1291483/leave-only-two-decimal-places-after-the-dot)
> [浮点数格式化为 2 位小数](https://stackoverflow.com/questions/6356351/formatting-a-float-to-2-decimal-places)

如果我有一个包含 153.2154879 之类的浮点数，有没有办法将它转换为字符串但只显示 4 个小数位？我知道我可以使用 格式化它`"000.000"`，但前面的数字并不总是必须是 3 位数。那么有没有办法显示所有前面的数字（153），但只显示字符串中点之后的前 4 个字符？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T18:03:02.017

这样的事情应该做：

```
your_number.ToString("0.####"); 
```

这将显示最多 4 个小数位。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-17T18:02:10.733

我通常使用格式字符串，例如`"#0.0000"`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-17T18:04:44.460

您可以使用 C# 函数 Math.Round 函数。

`float a= 153.213456;` `Math.Round(a,3);` 这会将数字四舍五入为 153.213，然后将其转换为字符串。

# ravendb - RavenDB 适合我的情况吗？

> ID：10196484
> 
> 赞同：2
> 
> 时间：2012-04-17T18:00:43.917
> 
> 标签：ravendb

我有一个有趣的情况，我即将结束一个 RavenDB 原型的评估期，该原型可用于我们公司的一个项目。有趣的原因是 99.99% 的时间，我相信它符合 Raven 的最佳点；它经常以小批量（一次< 1000个文档）重复查询新数据。

但是，我们确实有一个初始加载期，我们需要加载两天的数据，在某些情况下可能是 300 万（或更多）条记录。

图表可能会有所帮助：

![在此处输入图像描述](../Images/03d02ffb3bee2bcf380262083086e319.png)

传输服务负责从三个生产数据库中获取正确的数据并将其存储在 RavenDB 中。WCF 服务将查询此数据并将其提供给其客户端。

一旦我们将数百万条记录/文档初始加载到 RavenDB 中，我们将很少需要再次这样做。

作为初始负载测试，在具有 4GB RAM 和两个处理器的机器上，读取初始数据只需要 23 多分钟。在这种情况下，它只有大约 128 万条记录。我从这个初始加载中消除了所有异步操作，因为我希望每次读取都不会受到其他读取操作的干扰。我以这种方式找到了最好的结果。

![在此处输入图像描述](../Images/e129c0f2e028289d728b9ec880937315.png)

我知道不建议这样做，但要完成这一切，我必须更改不建议更改的设置：

我不得不增加超时：

```
documentStore.JsonRequestFactory.ConfigureRequest += (e, x) => ((HttpWebRequest)x.Request).Timeout = ravenTimeoutInMilliseconds; 
```

在 Raven.Server.exe.config 中，我不得不增加页面大小（到 int.MaxValue）：

```
<add key="Raven/MaxPageSize" value="2147483647"/> 
```

在我的检索方法中，我不得不使用 Take(int.MaxValue)：

```
return session.Query<T>().Where(whereClause).Take(int.MaxValue).ToList(); 
```

请记住，这只是一次性的初始加载。在那之后，它是许多查询，快速且经常。我还应该注意，每个文档在 RavenDB 中都是自包含的。没有需要管理的关系。

了解了这一切，RavenDB 是不是很合适？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T20:45:45.793

适合*什么*？

全文搜索？是的。后台聚合（map/reduce）？是的。简单的复制和分片，比如缩放？是的...

临时报告？不。可能支持成千上万的第三方工具？不...

如果你在谈论性能，你可能想看看 Orens 的最新帖子。他的数字与您的数字非常相似：http: [//ayende.com/blog/154913/ravendb-amp-freedb-an-optimization-story](http://ayende.com/blog/154913/ravendb-amp-freedb-an-optimization-story)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T23:08:31.357

根据我对您问题的理解，您需要“准备”WCF Web 服务。为此，您需要从 RavenDB 读取 120 万份文档（大约 23 分钟）并将它们保存在内存中，这样 WCF 服务就可以为它们提供查询，对吗？还是我错过了什么？

为什么不让 WCF 服务一次将其查询发送给 Raven？即对于它从客户端获得的每个查询，请 RavenDB 为它做查询？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T18:43:10.347

根据您在其他答案评论中告诉我们的内容，我相信为 wcf 客户端提供足够快的服务的唯一好方法是将所有内容实际存储在内存中，所以就像您现在做的那样。

问题是，RavenDB 是否适合这种情况取决于您的数据模型是否以其他方式从面向文档的性质中受益。因此，如果您的动态数据需要关系数据库中的某种 EAV 和大量连接，那么 RavenDB 可能是一个非常好的解决方案。但是，如果您只需要一些可以放入平面数据的东西，那么我会在这里使用关系数据库。在许可成本和易用性方面，您可能还想看看 PostgreSql，因为这是一个非常棒的数据库，完全免费。

# data-binding - 在 Silverlight 中绑定 DataGrid 列标题

> ID：10196485
> 
> 赞同：2
> 
> 时间：2012-04-17T18:00:44.997
> 
> 标签：data-binding, silverlight-4.0, datagrid

我已经看过很多关于这个话题的未答复的帖子，但我仍然倾向于相信这里有人已经弄清楚了这一点，并且正在阻止我们其他人。

我有一个包含模板列和文本列混合的 DataGrid。我只需要一种将标题绑定到视图模型中的属性的方法，以便我可以为不同的语言使用不同的字符串。

我已经看到[WPF 数据网格标题文本绑定](https://stackoverflow.com/questions/1658397/wpf-datagrid-header-text-binding)以及从它链接的每个帖子。此处建议的方法均不适用于 Silverlight。

没有人有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-22T22:23:24.007

我最近也花了一些时间来解决这个问题，这就是我如何让它为其他人的利益而工作。

首先在顶部声明命名空间，以便我可以在 xaml 中指定它的简写。

```
xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk" 
```

然后我将标题样式声明为顶部的静态资源以保持数据网格 xaml 干净：

```
<navigation:Page.Resources>        
    <Style x:Key="NameStyle" TargetType="sdk:DataGridColumnHeader">
        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock Text="{Binding Path=LocalizedStrings.Name, Source={StaticResource Language}}"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="DescriptionStyle" TargetType="sdk:DataGridColumnHeader">
        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock Text="{Binding Path=LocalizedStrings.Description, Source={StaticResource Language}}"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</navigation:Page.Resources> 
```

然后在您的数据网格 xaml 中，您可以简单地将 DataGridTextColumns 标题样式设置为静态资源标题样式。

```
<sdk:DataGrid.Columns>
    <sdk:DataGridTextColumn Width="Auto" FontSize="11" MinWidth="100" Binding="{Binding Name}" HeaderStyle="{StaticResource NameStyle}" />
    <sdk:DataGridTextColumn Width="1*" FontSize="11" Binding="{Binding Description}" HeaderStyle="{StaticResource DescriptionStyle}" />
</sdk:DataGrid.Columns> 
```

我最初的解决方案来自这篇文章：[Dynamicly setting the Header text of a Silverlight DataGrid Column](https://stackoverflow.com/questions/151682/dynamically-setting-the-header-text-of-a-silverlight-datagrid-column)

只是整理了一下，因为我要设置 15 个列标题。

# python - 必应 AppID 无效

> ID：10196487
> 
> 赞同：3
> 
> 时间：2012-04-17T18:00:58.533
> 
> 标签：python, language-translation, microsoft-translator

我正在尝试使用 Python 的 Bing Translator API，由于某种原因，它告诉我我的 AppID 无效。我得到错误：

> ArgumentException：无效的 appId
> 参数名称：appId：ID=[4 个数字的字符串].V2_Json.Translate.[8 个数字/字母的字符串]

我检查了我从开发者中心收到的ID是启用的，并且我没有超过流量使用量。我仍然不确定可能出了什么问题。如果有人能给我一个答案或解决这个问题的方法，我将不胜感激。

来自[bingtrans 示例](https://github.com/bahn/bingtrans#example)的代码：

```
import bingtrans
bingtrans.set_app_id(YourAppID) # you can get your AppID at: bing.com/developers 
print bingtrans.translate('hello', 'en', 'ko') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T19:22:25.857

我今天也遇到了这个问题，Bing Translator 的 Bing appID 已弃用。直到昨天还好。

您可以看到谈论它的帖子[http://social.msdn.microsoft.com/Forums/en-US/microsofttranslator/thread/02054a7c-090c-46a0-a8d1-2d57e236eb4d 。](http://social.msdn.microsoft.com/Forums/en-US/microsofttranslator/thread/02054a7c-090c-46a0-a8d1-2d57e236eb4d)

您需要从[http://api.microsofttranslator.com](http://api.microsofttranslator.com)网站获取新的 Azure 市场令牌。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:11:05.477

Bing AppID 机制已弃用且不再受支持：http: [//msdn.microsoft.com/en-us/library/hh454950.aspx](http://msdn.microsoft.com/en-us/library/hh454950.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T03:21:20.157

我认为您应该设置您的客户端 ID 和客户端密码，它们都是必需的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T18:33:55.647

好的，看来您需要获取正确的 appId。它应该是 16 个字符或更多。

如果我在浏览器中打开此 URL，它会告诉我它应该那么长：[http ://api.microsofttranslator.com/V2/Ajax.svc/Translate?from=en&to=ko&text=software&appId=](http://api.microsofttranslator.com/V2/Ajax.svc/Translate?from=en&to=ko&text=software&appId=)

# powershell - Start-Job 中的变量不会被评估

> ID：10196489
> 
> 赞同：3
> 
> 时间：2012-04-17T18:01:01.410
> 
> 标签：powershell

我的 Powershell 代码不评估`$agent`变量：

```
foreach ($agent in $agentcomputers) {
    Write-Output 'Starting agent on '$agent
    # psexc to start the agent
    Start-Job -ScriptBlock {& psexec $agent c:\grinder\examples\startAgent.cmd}
} 
```

[此链接](https://sqlblog.org/2011/01/29/powershell-start-job-scriptblock-sad-panda-face)与我的问题类似，只是我没有调用外部 Powershell 脚本。

我尝试添加它，使用`$args[0]`for`$agent`并添加`-ArgumentList`参数，但这不起作用。

* * *

**编辑/回复**

`$agentcomputers`只是计算机名称的列表 - 每个都在自己的行中：

```
$agentcomputers = Get-Content c:\grinder-dist\agent-computers.txt 
```

我也试过这个 - 并`$args[0]`没有评估：

```
Start-Job -ScriptBlock {& psexec $args[0] c:\grinder\examples\startAgent.cmd} -ArgumentList @($agent) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-01-09T08:18:58.067

这里有3种不同的方式我会这样做。首先，所有对齐和漂亮。

```
$agents = Get-Content c:\grinder-dist\agent-computers.txt
$jobs = {
     Param($agent)
         write-host "Starting agent on" $agent
         & psexec \\$agent c:\grinder\examples\startAgent.cmd
}
foreach($agent in $agents) {
     Start-Job -ScriptBlock $jobs -argumentlist $agent | Out-Null
}
Get-Job | Wait-Job | Receive-Job 
```

或者您可以将所有内容放在一行而不创建任何变量。

```
(Get-Content c:\grinder-dist\agent-computers.txt) | %{ Start-Job -ScriptBlock { param($_) write-host "Starting agent on" $_; & psexec \\$_ c:\grinder\examples\startAgent.cmd } -argumentlist $_ | Out-Null }
Get-Job | Wait-Job | Receive-Job 
```

在最后一个示例中，您可以通过这种方式管理并发运行的线程数。

```
$MaxThreads = 5
$agents = Get-Content c:\grinder-dist\agent-computers.txt
$jobs = {
     Param($agent)
         write-host "Starting agent on" $agent
         & psexec \\$agent c:\grinder\examples\startAgent.cmd
}
foreach($agent in $agents) {
     Start-Job -ScriptBlock $jobs -argumentlist $agent | Out-Null
     While($(Get-Job -State 'Running').Count -ge $MaxThreads) {
          sleep 10
     }
     Get-Job | Wait-Job | Receive-Job
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T20:16:18.090

这是解决方案。正如安迪所说，我需要使用带有 -ArgumentList 参数的 $args 数组。这个其他线程很有帮助： [Powershell：将参数传递给作业](https://stackoverflow.com/questions/4472284/powershell-passing-parameters-to-a-job)

```
foreach($agent in $agentcomputers){
$agentslash = "\\"+$agent
$args = ($agentslash,"c:\grinder\examples\startAgent.cmd")
Write-Output 'Starting agent on '$agent

#psexc to start the agent
$ScriptBlock = {& 'psexec' @args } 

Start-Job -ScriptBlock $ScriptBlock -ArgumentList $args

} 
```

# jquery - 选择具有另一个元素的任何类的元素

> ID：10196490
> 
> 赞同：0
> 
> 时间：2012-04-17T18:01:05.980
> 
> 标签：jquery

给定一个像

```
<div class="A B"></div> 
```

在 div 的类未知和/或可以更改的地方，我想选择像

```
<div class="A"></div>
<div class="B"></div>
<div class="A B"></div>
<div class="B Foo"></div> 
```

换句话说，任何具有 A 类或 B 类的元素。

jQuery 有这个`is()`功能，所以我考虑使用 抓取包含主 div 的类的字符串`attr("class")`，在每个类前面加上过滤器`.`和使用`is()`过滤器，但这感觉就像是 hack。有什么方法可以优雅地做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T18:04:29.917

```
$('#targeted_div').click(function() {
    if (this.className) {
        var classes = $.trim(this.className).split(/\s+/);
        var matches = $('.' + classes.join(',.'));
    }
}); 
```

因此，如果 的类`'#targeted_div'`是`A B`，则匹配的选择器将是`'.A,.B'`。换句话说，它将选择至少具有这些类之一的任何元素。

# matlab - Matlab 间断函数

> ID：10196492
> 
> 赞同：0
> 
> 时间：2012-04-17T18:01:15.403
> 
> 标签：matlab

定义不连续函数的任何简单方法（例如 f(x)=5 if x>5, f(x)=6x if x<5）并在区间内对其进行评估（例如 [0 6]）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T18:04:14.443

这个怎么样：

```
f = @(x) 5*(x>5) + 6*x.*(x<5); 
```

如在

```
t = 0:0.001:6;
f = @(x) 5*(x>5) + 6*x.*(x<5);
plot(t,f(t)); 
```

您可能希望更改定义以确保将 x = 5 时的情况定义为以下之一：

```
f = @(x) 5*(x>5) + 6*x.*(x<=5); 
```

或者

```
f = @(x) 5*(x>=5) + 6*x.*(x<5); 
```

# javascript - 如何在javascript中创建自定义对象的通用常量实例？

> ID：10196496
> 
> 赞同：2
> 
> 时间：2012-04-17T18:01:25.540
> 
> 标签：javascript, constants

我正在创建一个程序来表示 javascript 中的二叉搜索树。我想要的是一种创建公共树节点的方法，其中 ptrs(left, right) 都为空。这是我写的代码：

```
var BST = function(data) {
    if (data === null || data === undefined){
        this.data  = null;
        this.left  = null;
        this.right = null;
    }

    else{
        this.data  = data;
        this.left  = new BST(null);
        this.right = new BST(null);
    }
};

BST.prototype.insert = function(data) {
    if (this.data === null){
        this.data  = data;
        this.left  = new BST(null);
        this.right = new BST(null);
    }
    else if (data < this.data)
        this.left.insert(data);
    else if (data > this.data)
        this.right.insert(data);
};

BST.prototype.inOrder = function(func) {
    if (this.data !== null) {
        this.left.inOrder(func);
        func(this.data);
        this.right.inOrder(func);
    }
}; 
```

在这里，我想为所有空指针分配一个空节点（如`if(data === null || data === undefined)`条件中所定义）。但是对于每个空节点，我必须创建一个代表相同数据的新节点。有没有办法分配给空节点的公共实例？
我使用空节点而不是仅仅使用的原因

```
else{
    this.data = data;
    this.left = null;
    this.right = null;
} 
```

是在调用该`inOrder`方法时，在到达带有 的节点时`left or right = null`，它会给出 a`TypeError`因为它试图运行 `null.inOrder(func);`，因为它`this.left`转换为`null`。
解决这个问题的方法是修改`inOrder`函数，这将导致每个语句周围出现许多条件，即不是一个非常优雅的实现。
我也可以`inOrder`在对象的原型之外定义，并使其以树作为参数，即`inOder(tree,func)`，但我不想这样做。

此外，作为对代码的第二个改进，请考虑该`insert`方法；在这种 `null`情况下：

```
if (this.data === null){
    this.data  = data;
    this.left  = new BST(null);
    this.right = new BST(null);
} 
```

因为无论如何我都必须覆盖每个条目，所以我想通过执行以下操作来将此节点完全重新分配给一个新树：

```
if (this.data === null)
    this = new BST(data); 
```

我知道这对前者来说效率较低，但它仍然更加简洁。那么有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:32:40.477

是的，在这种情况下，您可以使用常量实例，因为所有空节点都是相同的并且没有不同的引用（如“父”属性）。要创建这样一个常量，您需要一个存储它的地方；可以是（私有）变量或类似的东西

```
BST.emptyleaf = new BST(null); 
```

你也可以使用单例模式：

```
function BST(data) {
    if (data === null || data === undefined) {
        if (BST.emptyleaf)
            return BST.emptyleaf; // singleton instance if available
        this.data  = null;
        this.left  = null;
        this.right = null;
        BST.emptyleaf = this; // else create it for re-use
    } else {
        this.data  = data;
        this.left  = new BST(null);
        this.right = new BST(null);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T20:17:27.393

> 但是对于每个空节点，我必须创建一个代表相同数据的新节点。有没有办法分配给空节点的公共实例？

是的，但这会破坏你的代码。想一想：当您`insert`在该节点实例上调用该方法时会发生什么？...

至于第二个问题，您无法使用当前模型对其进行优化。没有就地对象替换之类的东西（[在 C# 中有](https://stackoverflow.com/questions/5562908/assignment-of-a-struct-value-to-this-keyword)）。

我认为您当前的代码还可以，尽管我个人会坚持使用更简单的模型，例如

```
var BST = function(data) {
    this.insert(data);
};

BST.prototype.insert = function(data) {
    if (typeof this.data == 'undefined') {
        this.data = data;
    } else if (data < this.data) {
        if (!this.left) {
            this.left = new BST();
        }
        this.left.insert(data);
    } else if (data > this.data) {
        if (!this.right) {
            this.right = new BST();
        }
        this.right.insert(data);
    }
};

BST.prototype.inOrder = function(func) {
    if (typeof this.data != 'undefined') {
        this.left && this.left.inOrder(func);
        func(this.data);
        this.right && this.right.inOrder(func);
    }
}; 
```

请注意，这完全消除了对 a 的需要`nullNode`，因为 - 嘿！`undefined`- 它是 JavaScript，所以为什么不使用动态对象扩展等美妙的东西。

# google-analytics - 谷歌分析 - 查看记录的出站链接报告

> ID：10196499
> 
> 赞同：8
> 
> 时间：2012-04-17T18:01:30.213
> 
> 标签：google-analytics

我已添加此页面 ( [http://support.google.com/analytics/bin/answer.py?hl=en&answer=1136920](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1136920) ) 上列出的代码，以在 google 分析中记录出站链接。

如何在谷歌分析中查看此报告，我需要创建报告吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T18:05:54.400

假设事件跟踪设置正确，您应该能够在标准报告 -> 内容 -> 事件中看到您的事件。不过，第一个值最多可能需要 24 小时才能显示出来。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-21T07:54:07.363

在最新版本的 Analytics 中，现在看起来是这样的：

*   报告 > 行为 > 事件 > 概述

或者

*   报告 > 实时 > 事件

# java - 如何在不阻塞 GC 的情况下将值关联到键

> ID：10196502
> 
> 赞同：3
> 
> 时间：2012-04-17T18:01:36.453
> 
> 标签：java, garbage-collection

**我的问题是：如何将一堆值与一堆键关联起来**

*   无需直接修改密钥，并且
*   在不阻止键被 GC 的情况下（知道值对键有强引用）

**背景：**

我需要将一堆复杂对象（称它们为值）与一些特定对象（称它们为键）相关联。

通常，我这样做的方式是使用关联键和值的哈希图。

这很好用。但是，我还需要确保映射不会干扰键的垃圾收集。换句话说，映射的存在不应阻止密钥被垃圾收集。

通常解决这个问题的方法是使用 Wea​​kHashMap，它只保存对键的 WeakReferences。但是，WeakHashMaps 仅在映射中的值没有对键的强引用时才有效。不幸的是，我的值都对我的键有强引用，这会阻止键被垃圾收集。这也可以通过对值使用弱引用来解决，但这不是一个可行的解决方案，因为我不能让我的值在我的键之前被 GC'd。只要关键对象仍然存在，值也必须存在。

因此，对于这种情况，我的典型解决方案是停止使用 HashMap，而是修改键以对它需要的所有值进行强引用。这将确保我仍然可以获得给定键的所有值，但不会阻止该键在其自然生命周期完成时被 GC。

不幸的是，我无法修改键，因此无法将值直接添加到键中。那么还有哪些聪明的解决方案呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:08:40.397

给定约束：

*   键对值有*某种*引用
*   这些值对键有很强的引用
*   不要阻止密钥被 GC'd
*   值不能在键之前被 GC
*   只要值的键存在，该值也必须存在
*   值和键仍应支持 GC

...我认为这在逻辑上是不可能的。

为什么你不能删除值→键映射（或者至少使用引用不同但逻辑上`.equal()`的对象）然后使用`WeakHashMap`解决方案？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T11:54:33.133

基本上，您的问题的解决方案是：
1\. 从您的值中维护对键的弱引用，因此键可以是 Gc'd
2\. 使用 Wea​​kHashMap 将键映射到值（如果存在，则值不会被 GC'd强烈引用其密钥）。

下面是一个示例应用程序来解释我上面提到的设计：

```
public class WeakApp {

WeakHashMap<Key,Value> weakHashMap = new WeakHashMap<Key,Value> ();
ArrayList <Key> strongReferences = new ArrayList<Key>();

static class Key {
    String smthg = "key";
    public Key(int count) {
        smthg = smthg + count;
    }

    public int hashCode() {
        return smthg.hashCode();
    }

     protected void finalize() {
         System.out.println("Key object " + smthg + " Gc'd");
     }
}

static class Value {

    static int count = 0;
    WeakReference keyReference = null ;
    String smthgValue = "Value object of key ";

    public Value(Key key) {
        keyReference = new WeakReference(key);
        count++;
        smthgValue = smthgValue + key.smthg;

    }
    protected void finalize() {
         System.out.println(" " + smthgValue + " Gc'd");
     }
}

void initValueToKeys(){
    for(int i =0; i< 10; i ++) {
        Key key = new Key(i);
        strongReferences.add(key);
        Value value = new Value(key);
        weakHashMap.put(key, value);
    }
    System.out.println("Weak hash Map size is " + weakHashMap.size());
}

void doMain() {

    System.gc();
    System.runFinalization();

    //Now slowly remove the strong reference keys simulating them going out of use
    Iterator<Key> itr = strongReferences.iterator();

    while(itr.hasNext()){
        Key key = itr.next();
        System.out.println("Removing strong reference to key " + key );
        itr.remove();

    }

    System.gc();
    System.runFinalization();

//shows if any values have references still from keys(should be 0), and expunges stale values to be Gc'd        
    System.out.println("Weak hash Map size is " + weakHashMap.size());

    //give chance for gc to remove the values 
    try {
        Thread.sleep(1000);
    }
    catch(Exception e){
        e.printStackTrace();
    }

    System.gc();
    System.runFinalization();

    System.out.println("System exited");
}

public static void main(String[] args) {
    WeakApp weakApp = new WeakApp();
    weakApp.initValueToKeys();
    weakApp.doMain();
} 
```

}

问候奥斯汀

# google-api - 可以去掉相邻的两个或多个区域的内部线，形成一个完整的区域

> ID：10196503
> 
> 赞同：1
> 
> 时间：2012-04-17T18:01:39.510
> 
> 标签：google-api, kml, google-earth

正如标题所说，是否有可能摆脱彼此相邻的两个或多个区域（KML文件中的地标）的内部线条，形成一个完整的区域供google earth显示？

我希望我解释得足够清楚。

# javascript - 使用 JavaScript 更改图像颜色

> ID：10196506
> 
> 赞同：2
> 
> 时间：2012-04-17T18:01:49.797
> 
> 标签：javascript, html, css

我有一张可以应用颜色的图像，原始图像：

![原始图像](../Images/9447179458bfb45497bb108eba0ce623.png) ![应用背景时](../Images/2630642a8f351ebceabd641cc524ac7f.png)

当应用背景颜色时。

我正在使用 CSS 来更改颜色：

```
<html>
  <head>
  <style type="text/css">
    div.background
     {
     width:480px;
     height:300px;
     background:url(whiteroom.jpg) repeat;
     }
   div.transbox
    {
     width:480px;
     height:300px;
     background-color:#FF3E96;
     opacity:0.5;
     filter:alpha(opacity=60); /* For IE8 and earlier */
     }
     </style>
    </head>
<body>
  <div class="background">
  <div class="transbox">
  </div>
  </div>
  </body>
</html> 
```

如何使用 javascript 和 CSS 更改图像以反映所选颜色。我不需要能够从不同的颜色中进行选择，我只需要一种颜色和我可以选择的该颜色的不同色调，例如选择不同的粉红色色调。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:14:31.943

您可以使用 CSS：

```
<div class="background">
  <div id="tint" class="transbox blue"></div>
</div>

div.transbox.blue {
      background-color:#0000ff;   
} 
```

JS：

```
document.getElementByClassName('tint').setAttribute('class', 'transbox blue') 
```

# ios - 使用 NSString 查找字符的所有位置的索引

> ID：10196512
> 
> 赞同：2
> 
> 时间：2012-04-17T18:02:10.337
> 
> 标签：ios, nsstring

以编程方式，我可以看到一个字符在任何给定字符串中存在多少次：

```
 letterOccurences= [[tempWordStr componentsSeparatedByString:chosenCharacter] count]; 
```

所以对于密西西比这个词，如果选择的字符是 'i'，这个函数会返回 4。

但我想知道的是**字符**在字符串中出现的位置。在密西西比州的情况下，这将是 1,4,7,10。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:07:11.417

您可以使用该`NSString`方法`rangeOfString:options:range:`- 这会在给定范围内查找并返回给定字符串（即`@"i"`）的范围。您只需要调整接收器的给定范围，直到找不到子字符串的更多实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:42:57.723

使用拆分字符串的技巧，而不是仅获取返回数组中元素的数量，而是获取数组中每个元素的长度。循环并累积长度并为缺少的“i”加 1。

# android - 自定义微调器视图（不想要弹出微调器）

> ID：10196515
> 
> 赞同：1
> 
> 时间：2012-04-17T18:02:11.430
> 
> 标签：android

我想创建一个自定义微调器视图，以便微调器选项直接显示在微调器控件下方，而不是在模式弹出窗口中。我希望它是无模式的，并且功能类似于您在 html 选择标记中看到的功能。我正在使用 Android 平台 2.1。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:14:12.350

这在技术上应该是可行的，但并不值得。我知道这是一个糟糕的答案，但我认为如果你不需要，在基本的 UI 控件上与系统对抗是不明智的。你可能会走上一条不太可能取得胜利的道路。这不仅仅是一个快速的 stackoverflow 答案。

您是否从其他人那里得到这样的设计要求？如果是这样，如果您需要回击，请让他们通读[Android 设计。](http://developer.android.com/design/index.html)*您想要*这种类似 html 的行为的主要原因是什么？

# .net - 将单元格大小更改为 WPF DataGrid？

> ID：10196518
> 
> 赞同：1
> 
> 时间：2012-04-17T18:02:18.840
> 
> 标签：.net, wpf, wpfdatagrid

是否可以更改 WPF System.Windows.Controls.DataGrid 的单元格的大小？

说，我希望我所有的单元格都是大小（100 x 50）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T19:14:26.833

```
<DataGrid ...
    <DataGrid.CellStyle>
        <Style TargetType="DataGridCell">
            <Setter Property="Width" Value="100"/>
           <Setter Property="Height" Value="50"/>
        </Style>
    </DataGrid.CellStyle> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T19:22:57.997

您是否尝试过设置 ColumnWidth 和 RowHeight？

```
 <DataGrid ColumnWidth="100" RowHeight="50"/> 
```

可以在 [Styling Microsoft 的 WPF datagrid](http://blogs.msdn.com/b/jaimer/archive/2009/01/20/styling-microsoft-s-wpf-datagrid.aspx.)中找到有关设置 DataGrid 样式的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T19:18:45.203

尝试这样的事情：

```
 <!--you can set Name and ItemsSource to other values, this is just a sample-->
    <DataGrid x:Name="dataGrid" ItemsSource="{Binding}">
        <DataGrid.CellStyle>
            <Style TargetType="DataGridCell">
                <Setter Property="Width" Value="100"/>
                <Setter Property="Height" Value="50"/>
            </Style>
        </DataGrid.CellStyle>
    </DataGrid> 
```

# android - 消息未显示在模拟器屏幕上

> ID：10196527
> 
> 赞同：0
> 
> 时间：2012-04-17T18:02:54.403
> 
> 标签：android, android-layout, android-emulator

这是查找当前位置的代码，但按下检索按钮后屏幕上没有显示任何内容。
我已重置 adb 并尝试手动从模拟器控件发送数据。但是当我使用模拟器控制发送数据时，模拟器会重新启动，但不会显示主屏幕。
请帮忙。提前致谢。

```
public class LbsGeocodingActivity extends Activity {

    private static final long MINIMUM_DISTANCE_CHANGE_FOR_UPDATES = 1; // in Meters

    private static final long MINIMUM_TIME_BETWEEN_UPDATES = 1000; // in Milliseconds

    protected LocationManager locationManager;

    protected Button retrieveLocationButton;

    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        retrieveLocationButton = (Button) findViewById(R.id.retrieve_location_button);

        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

        locationManager.requestLocationUpdates(
                LocationManager.GPS_PROVIDER,
                MINIMUM_TIME_BETWEEN_UPDATES,
                MINIMUM_DISTANCE_CHANGE_FOR_UPDATES,
                new MyLocationListener()

        );
    retrieveLocationButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                showCurrentLocation();
            }
    });       

    }   

    protected void showCurrentLocation() {
        Location location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
        if (location != null) {
            String message = String.format(
                    "Current Location \n Longitude: %1$s \n Latitude: %2$s",
                    location.getLongitude(), location.getLatitude()
            );
            Toast.makeText(LbsGeocodingActivity.this, message,
                    Toast.LENGTH_LONG).show();
        }
    }  

    private class MyLocationListener implements LocationListener {
        public void onLocationChanged(Location location) {
            String message = String.format(
                    "New Location \n Longitude: %1$s \n Latitude: %2$s",
                    location.getLongitude(), location.getLatitude()
            );

            Toast.makeText(LbsGeocodingActivity.this, message, Toast.LENGTH_LONG).show();
        }

        public void onStatusChanged(String s, int i, Bundle b) {
            Toast.makeText(LbsGeocodingActivity.this, "Provider status changed",
                    Toast.LENGTH_LONG).show();
        }

        public void onProviderDisabled(String s) {
            Toast.makeText(LbsGeocodingActivity.this,
                    "Provider disabled by the user. GPS turned off",
                    Toast.LENGTH_LONG).show();
        }

        public void onProviderEnabled(String s) {
            Toast.makeText(LbsGeocodingActivity.this,
                    "Provider enabled by the user. GPS turned on",
                    Toast.LENGTH_LONG).show();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:10:00.873

在您的代码中，您可能没有收到当前位置（这是因为您需要通过[模拟器控制](http://sree.cc/google/emulator-control-for-android-in-eclipse-ide)手动推送您的位置）。

在 showCurrentLocation() 中也有其他情况，并检查位置对象是否为空，如下所示。

```
protected void showCurrentLocation() {
    Location location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    if (location != null) {
        String message = String.format(
                "Current Location \n Longitude: %1$s \n Latitude: %2$s",
                location.getLongitude(), location.getLatitude()
        );

    Toast.makeText(LbsGeocodingActivity.this, message,
                Toast.LENGTH_LONG).show();
    }else{
       Toast.makeText(LbsGeocodingActivity.this, "location is null",
                Toast.LENGTH_LONG).show();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T08:42:52.863

在我们第一次尝试使用位置传感器时，我们遇到了类似的问题。为了从 GPS 中获得最佳结果，有两件事最有帮助。

在模拟器上**`Location location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);`**导致很多力关闭。

而最重要的。通过telnet输入gps数据要稳定得多。**`telnet localhost 5554`**（*您可以在模拟器窗口标题上看到端口*）。新 gps 修复的命令是：**`geo fix lat lng`**

# assembly - CodeSourcery CS3 中断处理程序覆盖

> ID：10196530
> 
> 赞同：1
> 
> 时间：2012-04-17T18:03:03.030
> 
> 标签：assembly, arm, interrupt-handling, cortex-m3, codesourcery

我正在尝试用我的替换一些 CS3 中断处理程序。在“Stellaris_blizzard 的 ISR”文件部分下方

```
#if defined (L_stellaris_blizzard_isr_interrupt)
    .globl  __cs3_isr_interrupt
    .type   __cs3_isr_interrupt, %function
__cs3_isr_interrupt:
    b .
    .size   __cs3_isr_interrupt, . - __cs3_isr_interrupt

    .weak   __cs3_isr_reserved_7
    .globl  __cs3_isr_reserved_7
    .set    __cs3_isr_reserved_7, __cs3_isr_interrupt
    ...
    .weak   __cs3_isr_GPIOM
    .globl  __cs3_isr_GPIOM
    .set    __cs3_isr_GPIOM, __cs3_isr_interrupt
    ...
#endif /* interrupt */
...

#if defined (L_stellaris_blizzard_isr_systick)
    .globl  __cs3_isr_systick
    .type   __cs3_isr_systick, %function
__cs3_isr_systick:
    b .
    .size   __cs3_isr_systick, . - __cs3_isr_systick

#endif /* systick */ 
```

还有我的处理程序

```
extern "C" void __cs3_isr_systick() { ... }
extern "C" void __cs3_isr_GPIOM() { ... } 
```

SysTick 中断运行良好。但是当端口 M 发生 GPIO 中断时，默认调用“__cs3_isr_interrupt”。如何替换 GPIO 中断处理程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:46:12.423

看起来 __cs3_isr_GPIOM 是 __cs3_isr_interrupt 的弱别名。如果您已将自己的版本定义为非弱版本，则应该没有问题。

您应该检查目标文件是否具有您期望的正确的弱/非弱类型（使用`nm`）。

如果这不能解决它，那么你就有一个链接器问题，而且这些问题更难弄清楚。这可能是订购问题，或者只是某个地方的错字。

# java - 如果 JLayeredPane 中的面板在添加到 JLayeredPane 后被编辑，它会发生变化吗？

> ID：10196534
> 
> 赞同：0
> 
> 时间：2012-04-17T18:03:13.603
> 
> 标签：java, swing, jpanel, jlayeredpane

使用将 JPanel 添加到 JLayeredPane 之后

```
layeredPane.add(panel); 
```

添加后，如果我们更改面板，JLayeredPane 中的面板是否也会更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:06:00.450

是的。Java 中的对象是通过引用传递的，因此您所做的任何更改都会对其产生影响。

进行更改后，您可能必须重新绘制面板，以使其正确显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:07:51.390

> 添加后，如果我们更改面板，JLayeredPane 中的面板是否也会更改？

Yes 是可能的，但只有通过调用才能看到

```
layeredPane.add(panel);
layeredPane.revalidate();
layeredPane.repaint(); 
```

# android - 聚焦时，视图背景的选择器将应用于所有同级

> ID：10196538
> 
> 赞同：0
> 
> 时间：2012-04-17T18:03:35.650
> 
> 标签：android, focus, android-selector

我有一个带有按钮作为其子项的线性布局。当它们获得焦点时，我需要改变按钮背景。这些按钮在触摸模式下是可聚焦的。

我已将以下选择器 xml 设置为按钮。

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_focused="true"  
           android:drawable="@drawable/tile_focused" />
    <item android:drawable="@drawable/tile" /> <!-- default -->
</selector> 
```

## 更新

```
if (layout == null) {
        layout = new LinearLayout(this);
        RelativeLayout.LayoutParams rlp = new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
        rlp.addRule(RelativeLayout.BELOW, R.id.toplogo);
        layout.setLayoutParams(rlp);
        layout.setId(wordLayoutID);
        layout.setBackgroundColor(Color.WHITE);
        mainLayout.addView(layout, rlp);
    } 

    Drawable tileBG = getResources().getDrawable(R.drawable.selector_tile);
    for (int i = 0; i < word.length(); i++) {
        Button btntile = new Button(this);
        LinearLayout.LayoutParams rlp =  new LinearLayout.LayoutParams(40, 40);
        btntile.setId(inputViewsIds+i);
        btntile.setBackgroundDrawable(tileBG);
        btntile.setFocusableInTouchMode(true);
        layout.addView(btntile, rlp);
    } 
```

问题是当我将焦点设置到任何一个按钮时，所有按钮的背景都会变为“tile_focused”。我猜问题出在选择器xml中。这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:36:58.910

简而言之，您`android:state_pressed="true"`可能还想要混合其他一些东西。我不是 100% 确定，但请继续阅读。

对于这样的问题，我总是查看源代码以了解样式和主题是如何工作的。ListView 样式的源代码如下。

查看源代码[`<item name="android:listSelector">@android:drawable/list_selector_background</item>`](https://github.com/android/platform_frameworks_base/blob/master/core/res/res/drawable/list_selector_background.xml)似乎是我们想要深入研究的地方。

这是该可绘制对象的源代码。这应该提供指导来完成你想要的。

[https://github.com/android/platform_frameworks_base/blob/master/core/res/res/drawable/list_selector_background.xml](https://github.com/android/platform_frameworks_base/blob/master/core/res/res/drawable/list_selector_background.xml)

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">

  <item android:state_window_focused="false" android:drawable="@color/transparent" />

  <!-- Even though these two point to the same resource, have two states so the drawable will invalidate itself when coming out of pressed state. -->
  <item android:state_focused="true"  android:state_enabled="false" android:state_pressed="true" android:drawable="@drawable/list_selector_background_disabled" />
  <item android:state_focused="true"  android:state_enabled="false"                              android:drawable="@drawable/list_selector_background_disabled" />
  <item android:state_focused="true"                                android:state_pressed="true" android:drawable="@drawable/list_selector_background_transition" />
  <item android:state_focused="false"                               android:state_pressed="true" android:drawable="@drawable/list_selector_background_transition" />
  <item android:state_focused="true"                                                             android:drawable="@drawable/list_selector_background_focus" />

</selector> 
```

[https://github.com/android/platform_frameworks_base/blob/master/core/res/res/values/styles.xml#L614](https://github.com/android/platform_frameworks_base/blob/master/core/res/res/values/styles.xml#L614)

```
<style name="Widget.ListView" parent="Widget.AbsListView">
    <item name="android:listSelector">@android:drawable/list_selector_background</item>
    <item name="android:cacheColorHint">?android:attr/colorBackgroundCacheHint</item>
    <item name="android:divider">@android:drawable/divider_horizontal_dark_opaque</item>
</style>

<!-- Abstract ListView, nothing of importance here. -->
<style name="Widget.AbsListView">
    <item name="android:scrollbars">vertical</item>
    <item name="android:fadingEdge">vertical</item>
</style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T06:02:22.027

这种行为的根本原因是我用于所有按钮的通用 tile 可绘制参考。我改变了它并为每个按钮加载了单独的drawable。那解决了它。

谢谢大家。

# symfony - Symfony2 如何从通用对象中获取 Doctrine EntityManager

> ID：10196543
> 
> 赞同：1
> 
> 时间：2012-04-17T18:03:43.480
> 
> 标签：symfony, doctrine

我有一个来自 Symfony2 项目的对象。下面是代码。命名空间 Acme\UserBundle\Form\Model;

```
use Symfony\Component\Validator\Constraints as Assert;
use Acme\UserBundle\Entity\User;

class Registration
{
    /**
     * @Assert\Type(type="Acme\UserBundle\Entity\User")
     */
    protected $user;

    ...

    public function setUser(User $user)
    {
        //Get the EntityManager here!!!!
        $group = $em
            ->getRepository('AcmeUserBundle:Group')
            ->findOneByName('Customers');
        $this->user->addGroup($group);
    }
....

} 
```

那么，正如代码中强调的那样，如何让 EntityManager 使用 Doctrine 检索实体？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T08:54:59.983

好的，解决了！

我只需要将 EntityManager 传递给控制器​​内的 Registration 类的构造函数。

```
use Symfony\Component\Validator\Constraints as Assert;
use Acme\UserBundle\Entity\User;

class Registration
{
    /**
    * @Assert\Type(type="Acme\UserBundle\Entity\User")
    */
    protected $user;

    ...

    protected $em;    

    public function __construct($em) {
       $this->em = $em;
    }    

    public function setUser(User $user)
    {
        $this->user = $user;
        $group = $this->em->getRepository('AcmeUserBundle:Group')
            ->findOneByName('Customers');
        $this->user->addGroup($group);
    }
...
} 
```

总之非常感谢。

# html - 如何在不改变编码风格的情况下避免空白锚下划线？

> ID：10196545
> 
> 赞同：13
> 
> 时间：2012-04-17T18:03:53.170
> 
> 标签：html, css

看看下面的小提琴：

[http://jsfiddle.net/DNhAk/14/](http://jsfiddle.net/DNhAk/14/)

当您的图像带有包含在锚点/链接中的文本时，图像和代码中的文本之间的空白会在文本之前的呈现页面中创建一个带下划线的空白。

当没有图像时，即使代码中有空格，也没有带下划线的空格。

我可以看到避免这个带下划线的空格的唯一方法是消除我的代码中的空格。但我讨厌改变我的编码风格以改变渲染页面的呈现方式。无论如何，为了操纵页面的呈现而改变您的 HTML 无论如何都是错误的。这就像使用换行符 ( `<br/>`) 在元素之间添加空格而不是使用 CSS。

是否有用于解决此问题的不太明显的 CSS 属性？

**更新** 由于某种原因，人们对我在代码中的图像边框和边距感到困惑。我只是把它们放在那里让它看起来不错。它们与问题无关，因此我删除了它们并更新了小提琴，以便人们可以更清楚地了解问题所在。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-18T05:48:00.107

`a`您可以像这样为元素设置 CSS ：

```
a {
    display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-17T18:20:43.173

您可以使用一些 CSS 来模拟效果：

```
img {
    border: 1px solid #CCC;
    padding: 10px;
    vertical-align: middle;
    float:left;
}

a {
    display:block;
    height:70px;
    line-height:70px;
} 
```

[http://jsfiddle.net/DNhAk/8/](http://jsfiddle.net/DNhAk/8/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-19T15:01:33.200

您遇到的行为是规范的一部分（[http://www.w3.org/TR/html401/struct/text.html](http://www.w3.org/TR/html401/struct/text.html)）：

> 对于除 PRE 之外的所有 HTML 元素，空格序列分隔“单词”（我们在这里使用术语“单词”来表示“非空格字符的序列”）。在格式化文本时，用户代理应该识别这些词，并根据特定的书面语言（脚本）和目标媒体的约定对它们进行布局。
> 
> *这种布局可能涉及在单词之间放置空格*（称为单词间空间），但单词间空间的约定因脚本而异。例如，在拉丁语脚本中，字间距通常呈现为 ASCII 空格 ( )，而在泰语中，它是零宽度的单词分隔符 (​)。在日语和中文中，通常根本不呈现字间距。

因此，通过在标记中添加元素（img）后跟空格（换行符），您指示代理将您的图像解释为“单词”，并根据代理设置的语言添加空格。如果您想要从结果中删除此空格，您需要将其从标记中删除。

或者，您可以从标记中完全删除图像，并将其作为背景放置在锚点上，从而消除标记中的任何演示片段。这里的例子：

```
<a href='#' class="imglink">
There is
<em>no</em>
underlined whitespace at beginning of this text</a> 
```

CSS：

```
.imglink {
min-height: 50px;
background: transparent url("http://www.cadcourse.com/winston/Images/SoccerBall.jpg") no-repeat;
background-size: 50px 50px;
display: block;
padding-left: 55px;
line-height: 50px
} 
```

当然，这种方法有一些弱点，但它是一个潜在的解决方案，具体取决于您的其他限制。

[http://jsfiddle.net/hellslam/pvHK8/](http://jsfiddle.net/hellslam/pvHK8/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-17T18:24:37.170

这是预期的行为，因为图像后有空格：您必须更改 html 结构，改用：

```
<a href='#'>
<img src='SoccerBall.jpg'/> <span>Your text</span>
</a> 
```

CSS：

```
a{text-decoration:none;}
a>span{text-decoration:underline;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T18:08:14.473

对不同元素使用两个单独的链接，它们位于当前 . 我还没有看到 CSS 修复。显然，这是因为整个区域都被视为链接。这种解决方法暂时有效。

```
<a href='#'>
<img src='http://www.cadcourse.com/winston/Images/SoccerBall.jpg'
  width='50' height='50'/>
</a>
<a href='#'>
No Underlined Whitespace
</a> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T18:28:33.690

消除图像和文本之间的锚点空间（这是下划线的内容）。在你的 CSS 中，给 img 'margin-right:10px' （或任何你想要的值）。移除填充物。

编辑

澄清：

在图像后插入空格字符不属于“编码样式” - 您已将空格专门编码到锚的文本值中。

CSS 在这方面的行为符合预期：它使用下划线对锚的文本内容（包括空格）进行样式化，因为您没有覆盖锚中文本内容的该行为。

通过删除空格，您并没有改变编码风格，而是在改变内容。碰巧这将消除您面临的样式问题。

我知道您在问是否有办法保留锚中的空间并使用 CSS 定位该字符 - 我认为没有办法做到这一点。

我指出，通过删除空间，您不会以任何有意义的方式改变内容的语义（当然不是视觉上的，因为无论如何您都想隐藏它，所以它唯一可能产生的影响是对非视觉代理，其中大多数在这种情况下无论如何都没有以有意义的方式传达间距）。

事实上，我怀疑那个空格字符的意图是更面向表示而不是面向语义。

出于演示目的而更改 HTML 并不理想，但通常不是更改您的 HTML 本身，而是更改您*使用 HTML 传达的含义*。在这种情况下，我认为更改 HTML 以传达*相同的含义*是完全正确的。

有时您会更改文档以同时满足您的语义需求和样式需求 - 只要您传达相同的含义和逻辑信息流，这对于内容的消费者来说确实不是问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-19T13:32:27.060

我当然同意你的问题，并认为这是经过深思熟虑的，提出了一个很好的观点。正如这个[SO question](https://stackoverflow.com/questions/2628050/ignore-whitespace-in-html)中所引用的，有一个名为[text-space-collapse](http://www.w3.org/TR/2011/WD-css3-text-20110901/#white-space-collapsing)的实验性 CSS3 属性，它提出了`discard, trim-inner, trim-before and trim-after`所有可用于解决此问题的值。

我认为在实施之前你会找到的最佳解决方案是`text-space-collapse`稍微改变你的标记。您可以将文本包装在一个跨度中，然后`display: table`用作一种解决方案。

[http://jsfiddle.net/CPh82/](http://jsfiddle.net/CPh82/)

```
a { display:table; }

a > * { display: table-cell; vertical-align: middle; }

<a href='#'>
    <img src='http://www.cadcourse.com/winston/Images/SoccerBall.jpg' width='50' height='50'/>
    There is underlined whitespace at beginning of this text
</a> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-04-17T18:11:34.050

而不是填充，尝试边距

```
img {
    border: 1px solid #CCC;
    margin: 10px;
    vertical-align: middle;   
}​ 
```

# javascript - 检测加载了什么页面 - ajax

> ID：10196551
> 
> 赞同：1
> 
> 时间：2012-04-17T18:04:18.127
> 
> 标签：javascript, jquery, ajax

我有这段代码，并且对于每个加载的页面，一些额外的 JS 应该是不同的。我怎样才能做到这一点？谢谢

```
 function foo(val) {
        $("#paginas").hide("fast").load(('profile' + val + '.php'), function () {

            //pseudo code
            if (page loaded is profile1)
            alert("a");

            if (page loaded is profile2)
            alert("b");

            and so on

        });
    }
    for (var i = 0; i < 8; i++) {
        $('.lista' + i).bind('click', {
            button: i
        }, function (event) {
            foo(event.data.button);
        });
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T18:05:54.207

听起来你正在尝试写`if (val === 2)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:06:37.203

你仍然可以`val`从你的 ajax .load() 函数中访问，所以你可以这样做：

```
if(val == 'whatever') {
    //do specific thing for "whatever" page
} 
```

# linux - 获取不存在文件的数量

> ID：10196557
> 
> 赞同：0
> 
> 时间：2012-04-17T18:04:58.910
> 
> 标签：linux, bash, shell

我编写了这个 bash 脚本来自动化查找丢失文件的过程：

```
echo "--|";
echo "  |";
read -p "  ->Enter the text file that contains the video files to look for: " fname
if [ ! -e "$fname" ]; then
        echo "  |";
        echo "--> The file $fname is not valid or doesn't exist";
else
        echo "  |";
        read -p "  ->File ready to be processed, enter the path where to look for the files: [/home/efeikuna/public_html/files/flv/]": path
        if [ ! -e "$path" ]; then
                path="/home/efeikuna/public_html/files/flv/";
        fi
                i=0
                for line in `cat $fname`;
                do
                        file=$path$line;
                        #echo "   |";
                        if [ ! -e $file ]; then
                                echo "   -> $i - $file => DOES NOT EXIST";
                        fi
                        i=$(expr $i + 1);
                        #if [ $i == 3 ]; then
                        #       break;
                        #fi
                done
fi 
```

该脚本正在运行，但它需要更多功能，所以我希望您可以指导/指向正确的方式：

*   我需要获取非现有文件的总数和现有文件的数量
*   你推荐使用什么来检查文件的完整性（通常是flv文件和txt文件，但将来会是其他的）
*   如果`if [ ! -e $file ]`输入，我怎样才能匹配`$fname`一个`locate $fname`只是看文件是否存在于其他地方？如果`locate $fname`返回true，则显示所在位置，如果不是，则继续。
*   您建议使用什么来编写一个文件，其中它通过单独的方式指示现有和丢失的文件，例如：

    ```
    Found Files:
    ____________
       ---- asdasd.flv
       ---- asdasd1.flv
       ---- asdasd2.flv
       ---- asdasd3.flv
       ---- asdasd4.flv

    Missing Files:
    ____________
       ---- bsdasd.flv
       ---- bsdasd1.flv
       ---- bsdasd2.flv
       ---- bsdasd3.flv
       ---- bsdasd4.flv 
    ```

*   有什么可能的改进吗？

感谢和抱歉任何可能的误解

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:07:34.043

`md5sum`(and `sha1sum`) 生成一个包含校验和的文件。只需解析`md5sum -c`针对包含校验和的文件运行的结果，即可查看有多少文件有效、无效或丢失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T11:19:01.840

**.我需要获取非现有文件的总数和现有文件的数量** 有了这个，我使用python而不是bash，实际上它可以用bash来完成，但它发现python为此目的更有效：

```
 #!/usr/bin/env python

 import os
 import sys

 def check_file(directory, filelist):
     is_file = []
     not_file = []
     with open(filelist) as f:
         for filename in f:
             fp = directory + '/' + filename.strip()
             print fp
             if os.path.isfile(fp): is_file.append(filename.strip())
             else: not_file.append(filename.strip())
     print "Number of file: %s" %(len(is_file))
     for item in is_file: print "----- %s" %(item)
     print "Number of non file: %s" %(len(not_file))
     for item in not_file: print "----- %s" %(item)

 if __name__ == '__main__':
     if len(sys.argv) < 3:
         print "Usage: %s [dir] [listfile]" %(sys.argv[0])
         sys.exit(2)
     directory = sys.argv[1]
     filelist  = sys.argv[2]
     check_file(directory, filelist) 
```

**你推荐使用什么来检查文件的完整性（通常是flv文件和txt文件，但将来会是其他的）**

md5sum 是正确的方法，但是如果您有更多更大的文件，它可能会**很慢。**请改用**inotify**。使用 inotify，您将在文件更新时收到通知。

**如果如果 [ ！-e $file ] 输入，我怎样才能将 $fname 与 locate $fname 匹配只是为了查看文件是否存在于其他地方？如果 locate $fname 返回 true，则显示所在位置，如果不是，则继续。**

这是另一种python方式：

```
for path, dirs, files in os.walk(directory):
     for f in [os.path.abspath(os.path.join(path, filename)) for filename in files]:
         fn = filename.split['/'][-1]
         if fn == file_you_want_to_search_for:
             print filename 
```

希望这有帮助。

# node.js - 将 Geddy 部署到 Heroku

> ID：10196563
> 
> 赞同：2
> 
> 时间：2012-04-17T18:05:15.253
> 
> 标签：node.js, deployment, heroku, geddy

我正在尝试将一个简单的[Geddyjs](http://geddyjs.org/index.html) (node.js) 应用程序部署到[Heroku](http://www.heroku.com/)。

当我进行推送时，会收到该错误：

git push heroku 大师

```
Heroku receiving push
Heroku push rejected, no Cedar-supported app detected 
```

我必须对 heroku 检测 nodejs 应用程序做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:10:19.240

你为雪松做了几件事你需要明确地说出来（我相信你已经这样做了，但为了完整起见）

`heroku create --stack cedar`

确保您的 package.json 位于根目录

[heroku 对此有一篇很好的文章](https://devcenter.heroku.com/articles/nodejs)

您现在应该能够

`git push heroku master`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:47:16.373

您是否已将 Procfile 和 package.json 添加到本地 git 存储库。并承诺他们？

我已经创建了它们，但忘记添加并提交它们，所以当推送这些文件时没有上传，因此 Heroku 不知道应用程序的类型。

添加、提交和重新推送解决了这个问题。

当你知道时很明显:-)

# asp.net - .NET 内存中 DLL 和 ASP.NET 页面

> ID：10196567
> 
> 赞同：0
> 
> 时间：2012-04-17T18:05:36.813
> 
> 标签：asp.net, .net, c#-4.0

我们的应用程序中有一个场景，我们需要编译代码并加载在内存中生成的 DLL。从我们的基础架构的角度来看，这部分是一个要求，我们无法改变它。

在内存中编译和加载 DLL 没有问题。但是，ASP.NET aspx 页面无法加载，因为 asp.net 无法找到内存中的引用/类型。

我只能想到两种可能的方法，但不确定哪一种是最实用的方法：

1.  找到一种使用自定义 HTTP 处理程序自己编译和执行 aspx 页面或 ascx 控件的方法
2.  找到一种方法在执行时将内存中的 dll 作为对 page/ascx 控件的引用进行链接。

我很欣赏你的见解...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:18:47.340

在我曾经工作过的一家公司，我们有一个“即插即用”架构，允许我们动态地将用户控件 (ascx) 添加到项目中，而无需在每次添加/修改控件时重新编译站点。

基本架构包括一个数据库表，其中包含每个动态控件的名称、dll 位置和 ascx 页面。每个控件都被编译成一个单独的 dll，并且该 dll 和 ascx 页面一起存储在文件系统中。每个控件还实现了一个接口，允许我们将其加载并呈现到页面中。

在每个页面的加载过程中，每当遇到界面时，我们都会使用`LoadControl()`.

这是你想要做的吗？

# symfony - 使用 Symfony2 在 Twig 模板中获取环境名称

> ID：10196568
> 
> 赞同：99
> 
> 时间：2012-04-17T18:05:36.913
> 
> 标签：symfony, twig

有没有办法在 Twig 模板中获取当前环境的名称？我想根据它设置一些 CSS 样式值。

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2012-04-17T18:08:24.213

[http://symfony.com/doc/current/templating/app_variable.html](http://symfony.com/doc/current/templating/app_variable.html)：

```
<p>Application Environment: {{ app.environment }}</p> 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2013-05-17T12:58:54.997

利用

```
app.environment 
```

例如

```
{% extends app.environment == 'dev' ? "::dev_layout.html.twig" : "::layout.html.twig" %} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-07-30T11:10:56.447

或者你可以使用

```
应用程序调试
```

如果启用了调试，则返回 true。在开发环境中通常是这种情况，但是可以在任何环境中启用调试......生产、测试​​、开发等......

# c# - 为什么'struct Nullable ' 不是结构？

> ID：10196570
> 
> 赞同：6
> 
> 时间：2012-04-17T18:05:52.513
> 
> 标签：c#, struct, nullable

基本上为什么以下在 C# 中无效？我可以找到很多好的用途，实际上可以通过创建我自己的可为空的结构类来修复它，但是 C# 规范（以及编译器）为什么以及如何阻止它？

下面是我正在谈论的部分示例。

```
struct MyNullable<T> where T : struct
{
    public T Value;
    public bool HasValue;

    // Need to overide equals, as well as provide static implicit/explit cast operators
}

class Program
{
    static void Main(string[] args)
    {
        // Compiles fine and works as expected
        MyNullable<Double> NullableDoubleTest;
        NullableDoubleTest.Value = 63.0;

        // Also compiles fine and works as expected
        MyNullable<MyNullable<Double>> NullableNullableTest;
        NullableNullableTest.Value.Value = 63.0;

        // Fails to compile...despite Nullable being a struct
        // Error: The type 'double?' must be a non-nullable value type in order to use it as parameter 'T' in the generic type or method 'ConsoleApplication1.MyNullable<T>'
        MyNullable<Nullable<Double>> MyNullableSuperStruct;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T18:12:19.910

它是一个`struct`. 它只是不满足值类型泛型类型参数约束。从语言规范的 10.1.5 开始：

> 值类型约束指定用于类型参数的类型参数必须是不可为空的值类型。所有具有值类型约束的不可空结构类型、枚举类型和类型参数都满足此约束。请注意，尽管归类为值类型，但可为空的类型（第 4.1.10 节）不满足值类型约束。

所以，这`where T : struct`并不意味着你认为它意味着什么。

> 基本上为什么以下在 C# 中无效？

因为`where T : struct`只能满足`T`不可为空的值类型。`Nullable<TNonNullableValueType>`不满足这个约束。

> 编译器为什么以及如何阻止它？

为什么？要与规范一致。如何？通过执行句法和语义分析并确定您提供了`T`不满足泛型类型约束的泛型类型参数`where T : struct`。

> [I] 可以通过创建我自己的可为空的结构类来修复它，但是

不，您的版本无法修复它。它基本上与除了编译器没有进行特殊处理之外完全相同`Nullable<T>`，并且您将导致编译器的实现不会装箱的一些装箱。

> 我可以找到很多好的用途

真的吗？如？请记住，基本思想`Nullable<T>`是有一个存储位置可以包含`T`或可以表示“缺少值”。嵌套这个有什么意义？也就是说，有什么意义`Nullable<Nullable<T>>`？它甚至没有概念意义。这可能是它被禁止的原因，但我只是在推测（*Eric Lippert 已经[确认](https://stackoverflow.com/questions/10196570/why-is-struct-nullablet-not-a-struct/10196758#comment13092154_10196664)这种推测是正确的*）。例如，什么是`int??`? 它代表一个存储位置，代表值丢失或者是一个`int?`，它本身就是一个存储位置，代表值丢失或者是一个`int`？什么用途？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:19:09.877

结构约束允许空值的一个原因是我们希望能够`T?`在泛型方法中使用。如果`struct`允许可空值类型，编译器将不得不禁止`T?`.

在其他情况下，可空类型也必须在编译器中进行特殊处理：

*   null 关键字必须可以隐式转换为可空类型；这对于值类型是不可能的。
*   可空值类型可以与空关键字进行比较；对于不可为空的值类型，此比较始终返回 false。
*   可空值类型与`??`运算符一起使用；非空值没有。

# mysql - 我想写mysql查询

> ID：10196574
> 
> 赞同：-5
> 
> 时间：2012-04-17T18:06:06.453
> 
> 标签：mysql

打印除 JR 之外的所有级别的级别和该级别学生的平均年龄。

```
CREATE TABLE STUDENT (
    sid NUMERIC(6) NOT NULL,
    sname VARCHAR(15),
    major VARCHAR(20),
    level VARCHAR(2),
    sage NUMERIC(2) NOT NULL,
    PRIMARY KEY (sid)
);

INSERT INTO STUDENT (sid, sname, major, level, sage) values (1,'JOHN','EE','FR' ,18);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (2,'TIM','EE','FR',19);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (3,'RICHARD','EE','SO',20);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (4,'EDWARD','EE','SO',21);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (5,'ALBER','CS','JR',22);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (6,'MARY','EE','JR',22);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (7,'JACK','EE','SR',23);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (8,'JULIAN','EE','SR',22);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (9,'SAM','EE','SR',24);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (10,'RAM','CS','SR',23);
INSERT INTO STUDENT (sid, sname, major, level, sage) values (11,'RICK','EE','SR',24); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:10:21.740

```
 SELECT level, AVG(sage) AS AvgAge
    FROM STUDENT
   WHERE level != 'JR'
GROUP BY level 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:10:48.253

```
SELECT level, AVG(sage) 
    FROM STUDENT
    WHERE level <> 'JR' 
    GROUP BY level 
```

# algorithm - 用于计算 5 星评级的算法

> ID：10196579
> 
> 赞同：94
> 
> 时间：2012-04-17T18:06:26.373
> 
> 标签：algorithm, weighted-average, rating-system

我需要像亚马逊网站上的那样计算 5 星评级。我已经进行了足够多的搜索以找到最好的算法，但我无法得到正确的答案。例如，如果这些是评级

```
5 star - 252
4 star - 124
3 star - 40
2 star - 29
1 star - 33 
```

共 478 条评论

亚马逊计算得出这是“5 颗星中的 4.1 颗星”。谁能告诉我这个数字是怎么得出的？我不能仅仅通过平均来得到这个。

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2012-04-17T18:09:30.150

这是一个加权平均值，你可以用它获得的票数来衡量每个评级：

```
(5*252 + 4*124 + 3*40 + 2*29 + 1*33) / (252+124+40+29+33) = 4.11 and change 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2015-09-17T13:33:43.280

如果您从头开始计算总体评分，那么此公式将对您有所帮助。

公式

```
((Overall Rating * Total Rating) + new Rating) / (Total Rating + 1) 
```

例子

假设您到目前为止还没有评分，那么公式就像，到目前为止，总体评分为“0”。总评分“0”，给定评分为“4”

```
((0*0)+4)/1 = 4 
```

如果总体评分为“4.11” 总评分为“478” 一位用户给出的新评分为“2”

那么公式就像

```
((4.11 * 478)+ 2)/479 // 479 is increment of new rating from 478 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2018-11-08T08:25:26.633

一个更好的方法来做到这一点，

```
rating = (sum_of_rating * 5)/sum_of_max_rating_of_user_count 
```

**例子：**

```
total users rated: 6  
sum_of_max_rating_of_user_count: 6 x 5 = 30  
sum_of_rating: 25

rating = (25 * 5) / 30 
```

完毕！

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-04-17T18:08:55.117

是的，您可以将它们平均：

```
(5 * 252 + 4 * 124 + 3 * 40 + 2 * 29 + 1 * 33) / 478 = 4.11 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-07-14T15:46:20.930

Blindy 的超级有用的回复，这是基于它的 PHP 代码。有些人可能会觉得有用。根据 OP 的示例，结果将为 4.11：

```
$ratings = array(
5 => 252,
4 => 124,
3 => 40,
2 => 29,
1 => 33
);

function calcAverageRating($ratings) {

$totalWeight = 0;
$totalReviews = 0;

foreach ($ratings as $weight => $numberofReviews) {
    $WeightMultipliedByNumber = $weight * $numberofReviews;
    $totalWeight += $WeightMultipliedByNumber;
    $totalReviews += $numberofReviews;
}

//divide the total weight by total number of reviews
$averageRating = $totalWeight / $totalReviews;

return $averageRating;
} 
```

**如何构建上述 $ratings 数组**

示例伪代码，但它应该可以解释当信息存储在数据库中时如何构建 $ratings 数组，假设您有一个名为“ratings”的表和一个名为“rating”的列。在这种情况下，它是 1 次连接，您需要进行 4 次连接才能获得所有评分，但这应该可以帮助您开始：

```
SELECT count(c1.rating) as one_star, count(c2.rating) as two_star  
FROM ratings c1 
LEFT OUTER JOIN
ratings c2
ON
c1.id = c2.id
WHERE
c1.rating = 1
AND
c2.rating = 2 
```

评论中建议的另一种方法

```
SELECT SUM(rating = 1) AS one_s ,SUM(rating = 2) AS two_s ,SUM(rating = 3) as three_s FROM reviews where product_id = 9 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-04-17T18:11:19.180

该评级系统基于[加权平均](http://en.wikipedia.org/wiki/Weighted_mean)或*加权平均*。也就是说，他们使用以星表示的权重来计算四舍五入为 4.1 的十进制值。例如：

```
Sum of (weight * number of reviews at that weight) / total number of reviews
(5*252 + 4*124 + 3*40 + 2*29 + 1*33) / 478 = 4.1 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-17T18:11:26.743

加权平均，将星数与其权重相加，然后除以评论总数。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-06-12T05:01:15.687

在Javascript中

```
function calcAverageRating(ratings) {

  let totalWeight = 0;
  let totalReviews = 0;

  ratings.forEach((rating) => {

    const weightMultipliedByNumber = rating.weight * rating.count;
    totalWeight += weightMultipliedByNumber;
    totalReviews += rating.count;
  });

  const averageRating = totalWeight / totalReviews;

  return averageRating.toFixed(2);
}

const ratings = [
  {
    weight: 5,
    count: 252
  },
  {
    weight: 4,
    count: 124
  },
  {
    weight: 3,
    count: 40
  },
  {
    weight: 2,
    count: 29
  },
  {
    weight: 1,
    count: 33
  }
];

console.log(calcAverageRating(ratings)); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-03-13T10:05:06.577

根据您的问题，您的解决方案将是这样的。

```
Sum of (Rate*TotalRatingOfThatRate)/ TotalNumberOfReviews

((5*252)+(4*124)+(3*40)+(2*29)+(1*33)) / (252+124+40+29+33) 
```

输出将是 4.1

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-10-12T06:18:44.607

此外，我只是想为所有人编写实用且完整的代码。

我的 Json 对象数组

```
var yourRatingData =[{
        review_id:1,
        customer_id:5,
        customer_name:"Faysal",
        rating:5,
        review_content:"I like this product it's cool and best in quality"
    },
    {
        review_id:2,
        customer_id:6,
        customer_name:"Adams",
        rating:4,
        review_content:"It's quality product though price a bit high"
    },
    {
        review_id:3,
        customer_id:8,
        customer_name:"Jane",
        rating:3,
        review_content:"I like but should improve quality"
    },
    {
        review_id:4,
        customer_id:9,
        customer_name:"Julia",
        rating:1,
        review_content:"It's not good"
    }]; 
```

**评分计算**

```
let _5star = yourRatingData.filter(r=>r.rating==5).length;
let _4star = yourRatingData.filter(r=>r.rating==4).length;
let _3star = yourRatingData.filter(r=>r.rating==3).length;
let _2star = yourRatingData.filter(r=>r.rating==2).length;
let _1star = yourRatingData.filter(r=>r.rating==1).length;

//Sum of individual star.
let sumOfRating = parseInt( _5star + _4star + _3star + _2star + _1star );

//Total number of rating
let overallRating = parseInt( 5*_5star + 4*_4star + 3*_3star + 2*_2star +1*_1star );

//Average of all rating
let averageRating = parseFloat(overallRating/sumOfRating);

//Percentage of each star rating
let _5starPercentage = parseInt((_5star/totalRating)*100);
let _4starPercentage = parseInt((_4star/totalRating)*100);
let _3starPercentage = parseInt((_3star/totalRating)*100);
let _2starPercentage = parseInt((_2star/totalRating)*100);
let _1starPercentage = parseInt((_1star/totalRating)*100); 
```

我认为这很有帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-10-04T08:07:34.317

（总星数/总评论人数*5）*5

= 回答

将 js 中的小数固定为 1。

answer.toFixed(1);

例如 5 人的总评论是 20 星。

(20/5*5)*5 = 4.0

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-08-24T10:30:38.467

这是使用颤振的示例方法，

```
double starRating = 5.0;
  getRating() {
    // ! Check Already Accepted by others or Not -----------------------------------
    //
    int totalof5s = 0;
    int totalof4s = 0;
    int totalof3s = 0;
    int totalof2s = 0;
    int totalof1s = 0;
    //
    FirebaseFirestore.instance
        .collection('usersRating')
        .where("passengerUid", isEqualTo: "GNblJJJsjicaA2vkXJNJ6XCAiwa2")
        .snapshots()
        .forEach((querySnapshot) {
      if (querySnapshot.size > 0) {
        querySnapshot.docs.forEach((element) async {
          if (element["rating"] == 5) {
            totalof5s++;
          } else if (element["rating"] == 4) {
            totalof4s++;
          } else if (element["rating"] == 3) {
            totalof3s++;
          } else if (element["rating"] == 2) {
            totalof2s++;
          } else if (element["rating"] == 1) {
            totalof1s++;
          }
          //
          if (this.mounted) {
            setState(() {
              starRating = (5 * totalof5s +
                      4 * totalof4s +
                      3 * totalof3s +
                      2 * totalof2s +
                      1 * totalof1s) /
                  (totalof5s + totalof4s + totalof3s + totalof2s + totalof1s);
            });
          }
        });

      } else {
        // This is default one in any case these user doesn't have any rating document exists
        if (this.mounted) {
          setState(() {
            starRating = 5.0;
          });
        }
      }
    });
  } 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2020-06-07T11:32:40.367

用 C#

```
double rating = (double)(5 * star5 + 4 * star4 + 3 * star3 + 2 * star2 + 1 * star1) / (star1 + star2 + star3 + star4 + star5);
rating = Math.Round(rating, 1); 
```

# c++ - 使用 openGL 进行纹理映射

> ID：10196588
> 
> 赞同：0
> 
> 时间：2012-04-17T18:07:09.127
> 
> 标签：c++, opengl

我正在纹理映射一个图元，确切地说是一个四边形。我遇到了纹理以某种方式逆时针方向旋转 90 度的问题。我以为问题出在纹理的加载代码上，但事实证明这实际上是绘制函数的问题。所以这是错误地绘制图片的代码：

```
glVertex2f(0.0f, 0.0f); glTexCoord2f(0.0f, 1.0f);
glVertex2f(0.5f, 0.0f); glTexCoord2f(1.0f, 1.0f);
glVertex2f(0.5f, 0.5f); glTexCoord2f(1.0f, 0.0f);
glVertex2f(0.0f, 0.5f); glTexCoord2f(0.0f, 0.0f); 
```

这个画出来的就像我打算画的那样：

```
glTexCoord2f(0.0f, 1.0f); glVertex2f(0.0f, 0.0f);
glTexCoord2f(1.0f, 1.0f); glVertex2f(0.5f, 0.0f);
glTexCoord2f(1.0f, 0.0f); glVertex2f(0.5f, 0.5f);
glTexCoord2f(0.0f, 0.0f); glVertex2f(0.0f, 0.5f); 
```

是什么导致了这种行为？我真的没想到这会对绘画产生这样的影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:20:24.790

> 我真的没想到这会对绘画产生这样的影响。

想想看。做什么`glTexCoord`？它指定了纹理坐标，对吗？但是纹理坐标是什么？

是的，*你*知道它指定了下一个顶点的纹理坐标，但 OpenGL 不知道。所做`glTexCoord`的只是将您传递给它的值设置到一块内存中。

`glVertex`做更多的事情。它设置顶点位置，但它*也*告诉 OpenGL，“获取我目前设置的所有顶点值并用它渲染一个顶点。” 这就是为什么你不能`glVertex`在外面打电话的原因`glBegin/glEnd`，即使你*可以*用`glTexCoord`,`glColor`等等来做。

因此，当您这样做时`glTexCoord(...); glVertex(...)`，您是在说“将当前纹理坐标设置为 X，然后将位置设置为 Y 并使用这些值进行渲染。” 当您这样做时`glVertex(...); glTexCoord(...);`，您是在说“将位置设置为 Y 并使用先前设置的值进行渲染，然后将当前纹理坐标设置为 X。”

在你已经告诉 OpenGL 渲染一个顶点之后设置纹理坐标有点晚了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:11:47.837

您调用 glVertex 和 glTexCoord 的顺序绝对重要！每当您指定顶点属性（如 glTexCoord、glColor 等）时，它们都会应用您绘制的所有未来顶点，直到您再次更改其中一个属性。因此，在前面的示例中，您的第一个顶点是使用一些未指定的先前 tex 坐标绘制的，第二个顶点使用 tex 坐标 (0.0, 1.0) 等进行绘制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:16:52.217

OpenGL 以状态方式运行。许多 GL 函数调用用于更改当前状态，以便当您调用其他一些函数时，它们可以使用当前状态进行正确的操作。

在您的情况下， glVertex2f() 调用使用当前纹理状态来定义纹理的哪个部分映射到哪个顶点。在您的第一个调用系列中，对 glVertex2f() 的第一次调用将没有先前的纹理状态，因此它可能默认为 (0.0f, 0.0f)，尽管它也可能是未定义的行为。然后第二次调用 glVertex2f 将使用*第一次*调用 glTexCoord2f() 设置的状态，然后第三次调用 glVertex2f() 使用*第二次*调用 glTexCoord2() 设置的状态，依此类推。

将来，请确保在调用使用这些状态的函数之前设置正确的 GL 状态，您应该一切顺利。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T22:11:43.257

可能是网上最好的解释：[纹理映射 - 教程](http://www.cse.msu.edu/~cse872/tutorial4.html)

而且也只是为了确保纹理坐标（texCoor）如下：

它们被称为的顺序很重要！

> *   (0,0) 左下角
> *   (0,1) 左上角
> *   (1,0) 右下角
> *   (1,1) 右上角

# visual-studio - VS2010自定义构建VC++

> ID：10196589
> 
> 赞同：0
> 
> 时间：2012-04-17T18:07:10.477
> 
> 标签：visual-studio, visual-studio-2010, visual-c++, build, msbuild

我有一个很大的 C++ 项目，我需要在构建阶段做很多步骤，因为我正在构建一个兼容 64 和 32 的应用程序，我有三个项目：proj1、Porj2、Proj3

我需要执行以下操作：

1.  从 proj1 中排除 cpp 文件（32 位版本）

2.  将 cpp 文件包含到 proj1（64 位版本）

3.  构建项目1

4.  构建项目2

5.  执行 proj2 的输出

6.  从 proj3 中排除 cpp 文件（32 位版本）

7.  将 cpp 文件包含到 proj3（64 位版本）

8.  构建项目3

9.  重命名从 proj3 构建的 exe

10.  从 proj1 中排除 cpp 文件（64 位版本）

11.  将 cpp 文件包含到 proj1（32 位版本）

还有其他一些步骤...我是手动执行的，这令人沮丧，我发现我需要使用 MSBUILD 但它是否用于构建本机代码？以及如何执行这些任务？

- 将 cpp 文件排除和包含到项目中

-建筑项目

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:14:28.400

在 Visual Studio 2010 及更高版本中，C++ 项目使用 MSBuild。

* * *

与其根据配置排除或包含文件，不如使用预处理器指令有条件地编译文件的内容会更简单。例如，将文件的全部内容包装在：

```
#ifdef MY_32BIT_BUILD_MACRO
// Source file contents here
#endif 
```

同样使用用于 64 位构建的宏。使用 Visual C++ 时，您可以使用`_M_IX86`和`_M_X64`预定义的宏来分别检测您是针对 x86 还是 x64 进行编译。

或者，您可以为项目文件中的特定源文件的项目添加一个`Condition`属性，并仅在设置某些属性时将其包含在构建中。`ClCompile`不过，我认为源文件中的条件编译是一个更好的选择，除非您需要使用复杂的规则来确定是否包含文件。

* * *

在您的解决方案中，您可以设置项目依赖项以确保一个项目先于另一个构建。右键单击解决方案，选择属性，然后浏览到通用属性 -> 项目依赖项。依赖关系也可以在项目文件中指定。

您可以使用构建后任务执行构建的输出。右键单击该项目，选择 Properties，然后浏览到 Configuration Properties -> Build Events。Post-Build 事件可用于在构建完成时执行命令。

* * *

与其在构建后重命名可执行文件，不如让构建生成具有正确名称的可执行文件更容易。在 Project 属性中，在 Configuration Properties -> General 下，Target Name 属性可用于设置主要构建输出的名称。

# c# - 扩展 System.Convert

> ID：10196592
> 
> 赞同：14
> 
> 时间：2012-04-17T18:07:20.157
> 
> 标签：c#, .net, .net-4.0, types, type-conversion

System.Convert 有一个非常有用的实用程序，可以将数据类型从一种类型转换为另一种类型。在我的项目中，我有许多自定义类型。我想将命令行参数转换为这些自定义类型（其中一些非常复杂）。如果这些存在于 System.Convert 中会很好，所以我可以做这样的事情：

```
Convert.ToMyCustomType(args[1]) 
```

我希望它在我键入时显示在 Visual C# IDE 中。我知道我可以简单地创建一个例程来转换类型，但我希望以与框架中已经内置的方式相同的方式处理类型转换。过去有没有人成功做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-17T18:10:58.443

不，您不能将它们添加到[`Convert`](http://msdn.microsoft.com/en-us/library/system.convert.aspx)类中-我建议将转换方法添加到您的实际类型中，例如：

```
MyCustomType.FromInt32(...) 
```

而实例方法则相反：

```
int x = myCustomType.ToInt32(); 
```

（静态工厂方法通常比添加大量重载的构造函数更好，IMO。它们允许各种替代方案 - 包括在适当的情况下返回空值或缓存 - 并且可以使调用代码更清晰。）

我还强烈建议您*不要*过度提供您提供的转换数量。没有多少自定义类型真正具有从各种原始类型进行的单一自然转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:12:54.170

首先， System.Convert 不是命名空间；它是一个静态类（有关更多信息，请参阅[文档](http://msdn.microsoft.com/en-us/library/system.convert.aspx)）。您可以编写自己的 Convert 类！

```
static class Convert
{
    static MyCustomType ToMyCustomType(string value)
    {
         //logic here...
    }
} 
```

如果您想在使用 System.Convert 的同一文件中使用此类，您可能需要给它另一个名称，以减少歧义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T18:13:30.000

不幸`System.Convert`的是，它是一个静态类，您不能扩展静态类。您只能从`object`.

* * *

一种可能的方法是提供转换运算符（隐式或显式）

```
public class MyClass
{
    public static explicit operator MyClass(SomeOtherType other)
    {
        return new MyClass { /* TODO: provide a conversion here*/ };
    }

    public static explicit operator SomeOtherType(MyClass x)
    {
        return new SomeOtherType {  /* TODO: provide a conversion here*/ };
    }
} 
```

有了这个声明，你可以做到这一点

```
MyClass myClass = new MyClass();
SomeOtherType other = (SomeOtherType)myClass; 
```

或这个

```
SomeOtherType other = new SomeOtherType();
MyClass myClass = (MyClass)other; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T18:17:50.017

`Convert`是一个静态类，你不能扩展它。

但是，您可以[`Convert.ChangeType()`](http://msdn.microsoft.com/en-us/library/system.convert.changetype.aspx)根据自己的需要使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-28T23:17:38.983

如果您知道类型 - 或类型 - 您将转换您*可以*使用扩展方法（但不是`System.Convert`，如其他地方所述）。

例如，从字节数组转换为十六进制字符串（例如，当您想要从哈希中得到格式良好的十六进制字符串时），您可以这样做：

```
''' <summary>Converts a byte array to a hexadecimal string.</summary>
''' <param name="Item">Required. The array of byte to convert.</param>
''' <returns>A hexadecimal string if converted successfully, error otherwise.</returns>
<Extension()>
Public Function [ToHexString](
    ByVal Item As Byte()) As String

    Dim Result As String = ""
    If Item IsNot Nothing Then
        For Each b As Byte In Item
            Result += b.ToString("X2")
        Next b
    End If
    Return Result
End Function 
```

用法：

```
Dim myHexString As String = myByteArray.ToHexString() 
```

结果：

```
FEE53B1AB64BD74AF8A95A9D4078141F196BA7A3 
```

如果您想花哨，可以添加一个可选参数来选择结果的大写或小写。

而且您可以根据要转换的类型重载方法，因此您可以拥有一个用于转换的方法，例如`Long`（尽管这已经可以使用标准`String`函数）。

# knockout.js - KnockoutJS - 嵌套数据，加载子项

> ID：10196593
> 
> 赞同：3
> 
> 时间：2012-04-17T18:07:21.163
> 
> 标签：knockout.js

我对 knockoutjs 非常陌生 - 完成了教程，我有了一个良好的开端。我的应用程序似乎非常适合 KO。在那我需要用来自 JSON 的数据填充一个表。这些数据是嵌套的，可以嵌套在任何深度，但我的 API 只会返回两层深度的数据。

例如

*   节点 1
*   *   节点 A
*   *   节点 B

我已经设法将数据加载到我的表中，可爱。我更进一步，并支持嵌套。我有一个要求，如果一个节点有孩子，它可以在节点下面注入到表中。

这方面的一个例子是......

*   节点 1 (HasChildren)
*   *   节点 A
*   *   节点 B (HasChildren)

作为节点 B 'HasChildren'，我想允许将其子节点加载到节点 B 下方的表中。在这种情况下，我将能够查询我的 API，它会返回节点 B 的子节点

*   节点 1
*   *   节点 A
*   *   节点 B
*   *   *   节点 B1
*   *   *   节点 B2

> 我有一些大致工作的东西，但它只适用于 1 级节点。一旦到达 level2，似乎找不到我的方法（addChild）。我无法弄清楚为什么它找不到该方法，因为它在我的 ViewModel 中。
> 
> 下面的帖子对解决这部分问题大有帮助。

帮助！

我已经把代码贴在这里了……（如果你在桌子上滚动到右边，你可以点击打开，看看发生了什么！）

[http://jsfiddle.net/8k6pj/1/](http://jsfiddle.net/8k6pj/1/) - 原始版本（2012 年 4 月 18 日）

**[http://jsfiddle.net/8k6pj/6/](http://jsfiddle.net/8k6pj/3/) - 最新版本**

提前谢谢了！

劳伦斯

ps 已经进一步更新了我的代码，所以虽然我有点卡在上面，已经开始研究如何实现代码回发以便我们可以保存。

看起来回发正在工作，但是它不会回发更改的值，而是回发原始值。认为这是因为我需要使用 ObservableArray，现在正在探索它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:13:42.337

我已经了解您希望发生什么，我仍然有点不清楚，但我想我会提交我所做的，以便在需要时引发更多信息。

您的问题标题提到了嵌套，但从您的代码看来，您并没有嵌套任何东西，而是在展平嵌套的父子对象。

我没有使用我不推荐的 jquery 委托，因为它破坏了模型的封装，而是更改了您的模板以使用点击绑定，并在 Crew/Component 对象上放置了一个开放函数。

```
<td rowspan="3">
    <a data-bind="click: open">Open</a>
    <a>Save</a>
</td> 
```

我还注意到您的 addChild 方法要求您将数组传递给它。您的原始代码不会起作用，因为 Crew 对象本身没有 Crews 集合，所以我猜测并在其父组件上使用了 Crews 集合。

所有这些更改意味着我必须通过根视图模型和构造函数上的父组件。

[http://jsfiddle.net/madcapnmckay/fdb5r/2/](http://jsfiddle.net/madcapnmckay/fdb5r/2/)

仅供参考 - 单击打开时此小提琴仍然会引发错误，因为分配的对象未正确初始化。我把这个留给你来解决，因为我对域的了解不足以自己修复它。但是，添加行为可以正常工作。

**更新问题后编辑**

这是一个经过重构和简化的示例，应该可以帮助您入门。我删除了很多非必要的东西，以使其更清楚它是如何工作的。

[http://jsfiddle.net/madcapnmckay/xxGam/](http://jsfiddle.net/madcapnmckay/xxGam/)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T15:56:48.077

我建议看一下 ko.mapping 来处理您正在处理的一些数据加载。我认为这将有助于解决您遇到的一些数据问题

[http://knockoutjs.com/documentation/plugins-mapping.html](http://knockoutjs.com/documentation/plugins-mapping.html)

# ruby-on-rails - Active Record Query - 有很多通过关联

> ID：10196597
> 
> 赞同：0
> 
> 时间：2012-04-17T18:07:35.110
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, search, activerecord

我正在尝试在我的模型中编写活动记录查询以进行高级搜索。

我有一个公司模型，每个公司通过分类有许多类别

目前，我的搜索方法中内置了以下内容。

```
def find_firms
    firms = Firm.order(:name)
    firms = firms.where("name like ?", "%#{name}%") if name.present?
    firms = firms.categories.find(id: category_id) if category_id.present?
end 
```

我的类别架构如下所示。

```
create_table "categories", :force => true do |t|
  t.text     "name"
  t.datetime "created_at", :null => false
  t.datetime "updated_at", :null => false
 end 
```

和我的分类

```
 create_table "categorizations", :force => true do |t|
   t.integer  "category_id"
   t.integer  "firm_id"
   t.datetime "created_at",  :null => false
   t.datetime "updated_at",  :null => false
 end 
```

和我的搜索表单视图

```
 <div class="field">
    <%= f.label :category_id, "Practice Area" %><br />
    <%= f.collection_select :category_id, Category.order(:name), :id, :name, include_blank: true %>
  </div> 
```

任何想法我做错了什么？

当我不断收到错误消息时：

```
 undefined method `categories' 
```

非常感谢。

罗斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:12:00.667

将您的功能更改`find_firm`为：

```
 def find_firms
    if category_id.present?
      if name.present?
        Firm.where("name like ?", "%#{name}%").joins("JOIN categorizations ON firms.id = categorizations.firm_id").where("categorizations.category_id = ?", category_id).order(:name)
      else
        Firm.joins("JOIN categorizations ON firms.id = categorizations.firm_id").where("categorizations.category_id = ?", category_id).order(:name)
    elsif name.present?
      Firm.where("name like ?", "%#{name}%").order(:name)
    else
      Firm.order(:name)
    end
  end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:30:52.143

您正在尝试在`categories`返回的数组上运行该方法，该方法`firms`将失败。我假设您要返回具有给定类别 ID 的公司。

```
def find_firms
  firms = Firm.order(:name)
  firms = firms.joins(:categories).
            where(:categories =>{ id : category_id}).uniq if category_id.present?
  firms = firms.where("name like ?", "%#{name}%") if name.present?
end 
```

# objective-c - 使用 `CGEventSourceSetLocalEventsSuppressionInterval` 而不是已弃用的 `CGSetLocalEventsSuppressionInterval`

> ID：10196603
> 
> 赞同：4
> 
> 时间：2012-04-17T18:08:05.180
> 
> 标签：objective-c, macos, cocoa, macos-carbon

当以编程方式移动鼠标光标时，您必须设置`CGSetLocalEventsSuppressionInterval`为`0`使事件实时进入，而不是延迟 250 毫秒。

不幸的是，`CGSetLocalEventsSuppressionInterval`在 Snow Leopard 中被标记为已弃用。

另一种方法是`CGEventSourceSetLocalEventsSuppressionInterval(CGEventSourceRef source, CFTimeInterval seconds);` [https://developer.apple.com/library/mac/#documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html#//apple_ref/c/func/CGEventSourceSetLocalEventsSuppressionInterval](https://developer.apple.com/library/mac/#documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html#//apple_ref/c/func/CGEventSourceSetLocalEventsSuppressionInterval)

```
-(void) mouseMovement:(CGEventRef) newUserMouseMovement
{
    //Move cursor to new position
    CGSetLocalEventsSuppressionInterval(0.0); //Deprecated in OS X 10.6
    CGWarpMouseCursorPosition(NSPointToCGPoint(newMousePosition));
    CGSetLocalEventsSuppressionInterval(0.25); //Deprecated in OS X 10.6

    //--OR--//

    CGEventSourceRef source = ???;
    CGEventSourceSetLocalEventsSuppressionInterval(source, 0.0);
    CGWarpMouseCursorPosition(NSPointToCGPoint(newMousePosition));
    CGEventSourceSetLocalEventsSuppressionInterval(source, 0.25);
} 
```

我无法让后一种方法起作用。

所以我想我的问题是如何获得该`CGEventSourceRef`功能所需的？

是用户正常鼠标移动的事件源吗？还是为了我手动扭曲光标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-09T11:24:56.400

事件源似乎在任何地方都没有解释，也没有人知道如何使用它们。

```
CGPoint warpPoint = CGPointMake(42, 42);
CGWarpMouseCursorPosition(warpPoint);
CGAssociateMouseAndMouseCursorPosition(true); 
```

在 warp 调用后立即调用 CGAssociateMouseAndMouseCursorPosition( true ) 以使 Quartz 事件系统放弃此特定 warp 的延迟。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T15:06:36.953

你有没有解决过这个问题？

您是否尝试过使用 CGEventCreateSourceFromEvent(...) 从 CGEventRef 创建 CGEventSourceRef？

# css - 在 div 中设置文本样式

> ID：10196609
> 
> 赞同：0
> 
> 时间：2012-04-17T18:08:43.210
> 
> 标签：css

我试图弄清楚如何让文本`No Managers in Database`垂直定位在包含`div`元素`input`中。

我尝试添加`padding`and `margin`，但它们没有用。关于如何实现这一点的任何想法？

[http://jsfiddle.net/SKTRn/](http://jsfiddle.net/SKTRn/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:12:00.190

# CSS

```
#none {
    display: block;
    font-size: 12px;
    margin: 7px 0;
    padding: 5px 0;
} 
```

基本上，你只需要添加`display: block;`到你的 CSS 中。我只是冒昧地更改了其他样式以更好地排列事物（并使字体与输入的大小相同）。

# ruby-on-rails - 出错后重新加载模板

> ID：10196610
> 
> 赞同：0
> 
> 时间：2012-04-17T18:08:48.000
> 
> 标签：ruby-on-rails, ruby

当我进入`tickets/new`并创建一个有错误的新票时，我的 URL 被重建为`tickets/`. 如何保持在同一页面上并重新加载出现错误的页面而不是重定向？

在我的票控制器中：

```
if @ticket.valid?
  @ticket.save
  redirect_to tickets_path
else
  render :template => 'tickets/new'
end 
```

**更新**

路线.rb：

```
devise_for :users
root :to => 'tickets#index'
resources :users do
  resources :tickets
end
resources :tickets 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:15:36.410

代替：

```
render :template => 'tickets/new' 
```

尝试这个：

```
render 'new' 
```

# c# - 绑定自控字符串

> ID：10196611
> 
> 赞同：1
> 
> 时间：2012-04-17T18:08:51.843
> 
> 标签：c#, wpf, xaml, binding, converter

我有一个要在 xaml 中使用的自定义转换器。如果值等于 0，转换器只会放置 Admin，如果值等于 2，则放置 Cashier，等等。

无论如何，这就是我要找的。

```
 <ComboBoxItem Content="{Binding 'I want to place the value in here', Converter={StaticResource MyConverter}}"></ComboBoxItem> 
```

所以如果我放置：

```
 <ComboBoxItem Content="{Binding '0', Converter={StaticResource MyConverter}}"></ComboBoxItem> 
```

我希望它将值 0 传递给我的转换器。我怎样才能做到这一点？

* * *

我知道我可以作弊并做类似的事情：

```
 <Label  Name="L1" Visiblity="hidden">0</Label>
 <ComboBoxItem Content="{Binding, ElementName='L1', Path='Content' Converter={StaticResource MyConverter}}"></ComboBoxItem> 
```

但那是多余的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:13:18.213

好吧，由于无论如何您的实现似乎是一个 hack，您可以使用另一个 hack：

```
<ComboBoxItem Tag="0" 
              Content="{Binding RelativeSource={RelativeSource Self}, 
                                Path=Tag, 
                                Converter={StaticResource MyConverter}}"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:23:37.310

我知道您已经接受了我的第一个答案，但这是另一种方法，它可能更有效。

```
<Control ...
         xmlns:sys="clr-namespace:System;assembly=mscorlib"

    <Control.Resources>
        <sys:Int32 x:Key="Zero">0</sys:Int32 >
    </Control.Resources>

    <ComboBoxItem Content="{Binding Source={StaticResource Zero}, 
                                    Converter={StaticResource MyConverter}}">

</Control> 
```

# ios - 它是 UITableViewController 吗？

> ID：10196612
> 
> 赞同：0
> 
> 时间：2012-04-17T18:08:53.233
> 
> 标签：ios

我想知道这个控件是否派生自 UITableViewController？

![在此处输入图像描述](../Images/b09ff7a0833193b51fc6efec56e183d9.png) 如果是这样，怎么做？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:22:00.617

这就是将 UISwitch 视图添加到表格单元格的方式。（作为附件）

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    //add a switch
    UISwitch *switchview = [[UISwitch alloc] initWithFrame:CGRectZero];
    cell.accessoryView = switchview;
    [switchview release];
}

cell.textLabel.text = [NSString stringWithFormat:@"%d", indexPath.row];

return cell;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:17:12.987

是的，它是一个表格视图控制器..分组样式...第一部分有 7 行我不能确定是否派生，但我想不是...您可以将视图添加到特定行，以便您可以自定义单元格...派生 tableCell 不是强制性的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T18:18:06.467

不明白你的意思。

如果您的意思是他们如何在表格单元格中拥有 UISwitch，那么它可能是他们将 UISwitch 放入的 UITableViewCell 的子类。

# ruby-on-rails - Redmine Gitosis 安装：rake 找不到inifile

> ID：10196616
> 
> 赞同：1
> 
> 时间：2012-04-17T18:09:05.277
> 
> 标签：ruby-on-rails, ruby, redmine

我今天成功安装了Redmine。我尝试按照[此处](http://www.x2on.de/2011/04/23/tutorial-redmine-with-git-and-gitosis-on-ubuntu-11-04/)所述安装 Gitosis 插件。当我运行命令时，`sudo -u www-data X_DEBIAN_SITEID=default RAILS_ENV=production rake db:migrate:plugins`我收到此错误：

```
(in /var/www/lemusc.de/redmine/public_html)
/var/lib/gems/1.8/gems/rake-0.9.2.2/lib/rake/file_utils.rb:9: warning: already      initialized constant RUBY
/var/lib/gems/1.8/gems/rake-0.9.2.2/lib/rake/file_utils.rb:86: warning: already    initialized constant LN_SUPPORTED
Please install RDoc 2.4.2+ to generate documentation.
rake aborted!
no such file to load -- inifile

(See full trace by running task with --trace) 
```

我按照教程中的描述安装了inifile `gem install inifile`，但它仍然会发生。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T13:06:36.227

在列出 gems ( `gem list`) 时，我注意到这样的事情：

```
Invalid gemspec in [/var/lib/gems/1.8/specifications/inifile-1.1.0.gemspec]: invalid date format in specification: "2012-02-28 00:00:00.000000000Z" 
```

所以我去了这个规范文件（`/var/lib/gems/1.8/specifications/inifile-1.1.0.gemspec`）并简单地删除了带有日期的行。

在那之后，我的 redmine 又活了过来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T17:44:58.340

我从这里得到了答案：http: [//eric.lubow.org/2009/ruby/parsing-ini-files-with-ruby/](http://eric.lubow.org/2009/ruby/parsing-ini-files-with-ruby/)

打电话`$:.unshift( '/usr/lib64/ruby/gems/1.8/gems/inifile-0.1.0/lib/' )`有帮助。如果inifile lib是，我必须将其更改为路径

# jquery - 如何从其他元素覆盖的dom元素接收鼠标输入事件？

> ID：10196617
> 
> 赞同：0
> 
> 时间：2012-04-17T18:09:09.823
> 
> 标签：jquery, javascript-events

我有一个 jquery 项目，我通过将元素的位置设置为绝对来拖动元素，然后听鼠标运动来移动元素。这完美地工作。但是后来我试图将元素拖到另一个元素上，当鼠标进入时，另一个元素没有给我鼠标进入事件。如果鼠标位置没有与绝对定位的元素重叠，我会收到鼠标输入事件，但是当我在鼠标下有绝对定位的元素时，我不会收到事件。我正在尝试使用列表进行各种拖放操作，也许稍后我会检查 jquery ui，但我希望能够做一些简单的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T19:11:50.350

设置元素的 z-index css 属性。

检查这个：[http ://www.w3schools.com/cssref/pr_pos_z-index.asp](http://www.w3schools.com/cssref/pr_pos_z-index.asp)

# jquery - jQuery UI 选项卡：选项卡标题文本在许多选项卡打开时被切断

> ID：10196619
> 
> 赞同：0
> 
> 时间：2012-04-17T18:09:25.977
> 
> 标签：jquery, jquery-ui, jquery-ui-tabs

我无法让 jQuery UI 选项卡按照我需要的方式运行。在 Chrome 和 Firefox 中，它们运行良好。我遇到麻烦的是IE7，IE7是必须的。

问题：如下图所示，如果打开了多个选项卡，行文本末尾的选项卡会被截断。此外，关闭的“X”在选项卡标题下进行管理。如图 1 中的选项卡一样，我可以使浏览器的宽度更小，并且选项卡在第二行中找到它的方式，如下图所示。

我将宽度设置为最小，这解决了我遇到的问题。问题是，如果该行充满了选项卡，那么接下来的几个打开的选项卡标题将只有约 3-5 像素宽。几乎看不到。我不知道该怎么做。

只能发一个链接：

[http://postimage.org/image/k736znm4l/](http://postimage.org/image/k736znm4l/)

我在 jsFiddle 中重新创建了我的部分问题：http: [//jsfiddle.net/DbnTt/2/](http://jsfiddle.net/DbnTt/2/)

添加许多选项卡，慢慢调整窗口大小，并观察顶行最右边的选项卡。关闭按钮移动到左侧标题下方。我正在使用 IE7。

# excel - 工作表不起作用

> ID：10196620
> 
> 赞同：3
> 
> 时间：2012-04-17T18:09:28.627
> 
> 标签：excel, vba

我正在尝试编写一个 excel Visual Basic 宏。

我的问题是这段代码有效：

```
Dim x As String
x = Worksheets("Abgabe").Cells(20, 3).Value 
```

但这不会：

```
Dim y As Worksheet
y = Worksheets("Abgabe") 
```

此外，如果我使用 ActiveWorkbook，则代码不起作用。

```
Dim y As Worksheet
y = ActiveWorkbook.Worksheets("Abgabe") 
```

我收到此错误：

> 未设置对象变量或 With 块变量

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T18:11:07.447

> > > 暗淡为工作表
> > > 
> > > y = 工作表（“Abgabe”）

使用这个（你必须使用`Set`）

```
Dim y As Worksheet
Set y = Worksheets("Abgabe") 
```

**从 MSDN**（[http://msdn.microsoft.com/en-us/library/aa192490.aspx](http://msdn.microsoft.com/en-us/library/aa192490.aspx)）：

```
Set Keyword: In VBA, the Set keyword is necessary to distinguish between 
assignment of an object and assignment of the default property of the object. 
```

# ruby - 如何在 Sequel 中检查约束

> ID：10196624
> 
> 赞同：4
> 
> 时间：2012-04-17T18:09:49.940
> 
> 标签：ruby, sequel

如何创建 CHECK 约束来检查 Sequel 中的一系列可能值。一个红宝石 ORM。

`CHECK (1 = 0)`如输出日志中所见，所有尝试似乎都会生成。

这是我尝试使用 Sequel 的 DSL 建模的表格：

```
create table memberships(  
      id integer primary key autoincrement
    , group_id integer references groups(id) on delete cascade
    , user_id integer references users(id) on delete cascade
    , role char check (role in ('u','a','o')) default 'u'
    , unique(group_id, user_id, role)   
); 
```

这是 Sequel 模式生成代码：

```
db.create_table(:memberships){
    primary_key :id
    foreign_key :user_id, :users
    foreign_key :group_id, :groups  
    char :role, default: 'u'
    check{role=='u' or role=='a'} #<-----this line generates CHECK (1 = 0)
    unique [:user_id, :group_id, :role]
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T23:01:36.257

在 Sequel 中，检查约束的处理方式与过滤器表达式一样。处理您的案件的推荐方法是：

```
check(:role=>%w[a o u]) 
```

我同意更多文档可能会更好，尽管[http://sequel.jeremyevans.net/rdoc/files/doc/schema_modification_rdoc.html中有示例](http://sequel.jeremyevans.net/rdoc/files/doc/schema_modification_rdoc.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T20:00:17.197

关于如何`check`以及`add_constraint`应该如何工作的文档相当稀少，但您可以尝试完全绕过所有魔法，像在 SQL 中那样编写约束，然后从块中返回它；像这样的东西：

```
db.create_table(:memberships) {
    #...
    check { "role in ('a', 'o', 'u')" }
    #...
} 
```

CHECK 约束中允许的语言非常丰富多样，所以我希望一个简单的字符串可以作为一个选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-11T11:00:43.927

这将通过以下方式优雅地处理`enum`：

```
up do
  extension :pg_enum
  create_enum(:role_types, %w[a b c])
  create_table # ...
    role_types :role, null: false
#...

down do
  drop_table # :...
  drop_enum :role_types
end 
```

# asp.net-mvc-3 - Initialize 和 action 之间会发生什么？

> ID：10196627
> 
> 赞同：2
> 
> 时间：2012-04-17T18:10:05.087
> 
> 标签：asp.net-mvc-3

我有一个很少发生但无论如何都可能被抓住的问题。问题是有时当我调用某些控制器的操作时会出现巨大的时间延迟。我记录了时间，结果看起来很奇怪：

```
> -->BeginRequest: /Data/MyController Now: 17:47:37:248 Thread id = 22
> ---->Prerequest: /Data/MyController Now: 17:47:37:249 Thread id = 22
> ------>Init DataController: /Data/MyController Now: 17:47:37:250 Thread id = 22
> ------>/Data/MyController executing:  Now: 17:47:46:302 Thread id = 22
> == /Data/MyController inside: now is 17:47:46:304 
```

BeginRequest 和 Prerequest 是记录到 Global.asax 中的事件，Init 来自控制器。初始化覆盖方法，执行 - 来自控制器中的 OnActionExecuting。

如您所见，控制器的初始化和执行之间几乎有 10 秒的时间。我不明白这段时间发生了什么。我应该检查哪些事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T06:19:54.490

在 Initialize 方法和进入控制器操作之间可能会发生很多事情。您可以查看[以下](http://www.simple-talk.com/content/article.aspx?article=1358)提供深入概述的文章。你可以[在这里下载海报](http://www.simple-talk.com/content/file.ashx?file=6068)。

基本上在初始化控制器之后发生的步骤是：

1.  授权过滤器 OnAuthorization 方法被调用
2.  模型绑定器反序列化参数
3.  动作过滤器 OnActionExecuting 方法被调用

文章中显示的图表中存在轻微错误，其中步骤 1 和 2 颠倒了。事实上，授权过滤器在模型绑定之前执行。

因此，您应该在代码中寻找自定义授权过滤器、自定义模型绑定器和自定义操作过滤器。所有这些都可能导致您在控制器的初始化逻辑和进入控制器操作之间观察到的减速。

# click - 如何使用 Pywinauto 在 Windows 应用程序中选择图标

> ID：10196629
> 
> 赞同：2
> 
> 时间：2012-04-17T18:10:10.767
> 
> 标签：click, icons, simulate, pywinauto

我正在尝试模拟单击 Windows 应用程序上的图标。目前，我这样做的唯一方法是使用 ClickInput(coords = (x,y)) 模拟鼠标点击上述方法的问题是，每当软件 UI 更新时，它的位置就会改变，这迫使我更新所有脚本根据新的图标位置。

有没有办法在不使用坐标的情况下模拟工具条中的图标点击？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T11:00:48.200

是的！据我所知，图像看起来像`Static`.`pywinauto`

```
Access names : ['Static4']
Class : Static
ClientRects : [<RECT L0, T0, R24, B24>]
ContextHelpID : 0
ControlCount : 0
ControlID : 269
ExStyle : 4
Fonts : [<LOGFONTW 'MS Shell Dlg' -11>]
FriendlyClassName : Static
handle : 2097378
Image : <Image._ImageCrop image mode=RGB size=24x24 at 0x1E47DC8>
IsEnabled : True
IsUnicode : True
IsVisible : True
MenuItems : []
pwa_type : <class 'pywinauto.controls.win32_controls.StaticWrapper'>
Rectangle : (L514, T498, R538, B522)
Style : 1342179331
Texts : ['']
UserData : 0 
```

您可以轻松访问它

```
window['Static4'].Click() 
```

# c# - 图片上传和调整大小

> ID：10196630
> 
> 赞同：1
> 
> 时间：2012-04-17T18:10:15.783
> 
> 标签：c#, silverlight, windows-phone-7

应用程序允许用户选择照片 (PhotoChooserTask) 或拍摄照片 (Launcher)。这很容易，我明白了。但是，我必须将这张照片上传到我的服务器（仅限服务器端的 PHP）。这就是我的问题。现在我正在通过 RAW POST（POST 正文）进行操作，但这不是一个好的解决方案。我想调整所选照片的​​大小（ig 到 1024x768）并将它们上传到我的服务器并保存到文件中。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:17:18.760

WriteableBitmap 中有 SaveJpeg 函数，允许您指定文件的必要参数，例如宽度、高度、质量等。您可以以不同的分辨率保存位图（例如存储到内存流），然后将生成的字节数组发送到服务器。

请参阅[这篇](http://blogs.msdn.com/b/mikeormond/archive/2010/12/09/resizing-images-in-windows-phone-7.aspx)文章以供参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:17:59.000

要调整照片大小，请使用[DecodeJpeg](http://msdn.microsoft.com/en-us/library/ff708027%28v=vs.92%29.aspx)并传递流和大小（在您的情况下为 1024、1024）。您将获得一个然后可以使用[Extensions.SaveJpeg()](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.extensions.savejpeg%28v=VS.92%29.aspx)`WriteableBitmap`将其转换回 jpeg 流。

# html - 菜单边框线

> ID：10196631
> 
> 赞同：-2
> 
> 时间：2012-04-17T18:10:16.327
> 
> 标签：html, css, menu, border

菜单中最后一个元素的末尾没有边框线。我无法修复它。能否请你帮忙？谢谢你的帮助。

```
 div.menu { 
    list-style:none; 
    margin:0; 
    padding:0; 
    width:100%;
    text-align:center;
    background:#FBB117;} 
 div.menu ul{ 
    font-family: Verdana; 
    font-size:14px;
    margin-left: auto;
    margin-right: auto; 
    margin-top: 3px;
    margin-bottom: 3px;
    width: 100px 
    padding:0;
    display:inline-block;} 
 div.menu li{ 
    display:inline; } 
 div.menu li a{ 
    text-decoration:none; 
    padding:7px 0; 
    width:100px; 
    background:#FBB117; 
    color:#4C4646; 
    float:left; 
    text-align:center; 
    border-left:1px solid #fff;}  
 div.menu li a:hover{ 
    background:#a2b3a1; 
    color:#000 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:20:21.893

```
 div.menu li{
          border-right: 1px solid #fff;
          display:inline-block;
        }    
    div.menu li:last-child{
          border-right: 1px solid #fff;
        } 
```

将边框从链接中取出并放入 li

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T05:42:39.500

嗨，你可以像这样轻松地做到这一点

使用最后一个孩子并给 li 左边的边界

我的代码是

**HTML**

```
<div class="menu">
<ul>
    <li><a href="home.html">Home</a></li>
    <li><a href="home.html">Home2</a></li>
    <li><a href="home.html">Home3</a></li>
    <li><a href="home.html">Home4</a></li>
    <li><a href="home.html">Home5</a></li>
    <li><a href="home.html">Home6</a></li>
</ul>
</div>​ 
```

**CSS**

```
div.menu { 
    list-style:none; 
    margin:0 auto; 
    padding:0; 
    width:70%;
    text-align:center;
    background:#FBB117;
    overflow:hidden;
} 
 div.menu ul{ 
    font-family: Verdana; 
    font-size:14px;
    margin:0 3px;
    width: 100%; 
    padding:0;

  } 
 div.menu li{ 
    margin:10px 0;  
    float:left; 
    border-left:1px solid #fff; 
} 
 div.menu li a{ 
    text-decoration:none; 
    line-height:29px;
    padding:0 10px;
    background:#FBB117; 
    color:#4C4646; 
    text-align:center;
display:inline-block; 

   }
div.menu li:last-child{
    border-right:solid 1px #fff;
}
 div.menu li a:hover{ 
    background:#a2b3a1; 
    color:#000 } 

​ 
```

现场演示[http://jsfiddle.net/rohitazad/aJ5hc/](http://jsfiddle.net/rohitazad/aJ5hc/)

有关伪类的更多信息[http://reference.sitepoint.com/css/css3psuedoclasses](http://reference.sitepoint.com/css/css3psuedoclasses)

# perl - 导入 .pl 文件

> ID：10196634
> 
> 赞同：3
> 
> 时间：2012-04-17T18:10:23.063
> 
> 标签：perl, import

我想知道如何将 Perl 文件导入脚本。我尝试了使用、要求和执行，但似乎没有什么对我有用。这就是我使用 require 的方式：

```
#!/usr/bin/perl

require {
 (equations)
}

print "$x1\n"; 
```

是否可以编写代码将一个值（我在我的脚本中得到）代入`equations.pl`，然后让我的脚本使用定义的方程`equations.pl`来计算另一个值？我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T18:43:58.013

您可以 require 一个 .pl 文件，然后该文件将执行其中的代码，但为了访问变量，您需要一个包，并且“使用”而不是 require（简单的方法）或通过 Exporter。

[http://perldoc.perl.org/perlmod.html](http://perldoc.perl.org/perlmod.html)

简单示例：这是您要导入的内容，将其命名为 Example.pm：

```
package Example;

our $X = 666;

1;  # packages need to return true. 
```

以下是如何使用它：

```
#!/usr/bin/perl -w
use strict;

use Example;

print $Example::X; 
```

这假定 Example.pm 位于同一目录中，或者位于 @INC 目录的顶层。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T18:53:36.850

**equations.pm**文件：

```
package equations;

sub add_numbers {
  my @num = @_;
  my $total = 0;
  $total += $_ for @num;
  $total;
}

1; 
```

**test.pl**文件：

```
#!/usr/bin/perl -w

use strict;
use equations;

print equations::add_numbers(1, 2), "\n"; 
```

* * *

***输出：***

```
3 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-17T20:08:37.527

您不能导入*文件*。您可以执行文件并从中导入*符号*（变量和子项）。请参阅perlmod 中的[Perl 模块](http://perldoc.perl.org/perlmod.html#Perl-Modules)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T18:32:23.950

您提供的关于`equations.pl`的细节很少，但如果输入可以通过命令行参数给出，那么您可以[打开](http://perldoc.perl.org/functions/open.html)一个管道：

```
use strict;
use warnings;

my $variable; #the variable that you will get from equations.pl
my $input=5; #the input into equations.pl

open (my $fh,"-|","perl equations.pl $input") or die $!;

while(my $output=<$fh>)
{
  chomp($output); #remove trailing newline
  $variable=$output;
}

if(defined($variable))
{
  print "It worked! \$variable=$variable\n";
}
else
{
  print "Nope, \$variable is still undefined...\n";
} 
```

如果这是 的主体`equations.pl`：

```
use strict;
use warnings;

my $foo=$ARGV[0];
$foo++;
print "$foo\n"; 
```

然后上面的代码输出：

```
It worked! $variable=6 
```

# java - 如何在 JSF 页面中实现 PrimeFaces 示例？

> ID：10196635
> 
> 赞同：1
> 
> 时间：2012-04-17T18:10:25.493
> 
> 标签：java, jsf, primefaces

我想实现 Prime Faces[示例](http://www.primefaces.org/showcase-labs/ui/tabviewDynamic.jsf)

我创建了这个 JSF 页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"    
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <ui:insert name="header">           
            <ui:include src="header.xhtml"/>         
        </ui:insert>
    </h:head>
    <h:body>

        <h1><img src="resources/css/images/icon.png" alt="NVIDIA.com" /> History Center</h1>
        <!-- layer for black background of the buttons -->
        <div id="toolbar" style="margin: 0 auto; width:1180px; height:30px; position:relative;  background-color:black">
            <!-- Include page Navigation -->
            <ui:insert name="Navigation">           
                <ui:include src="Navigation.xhtml"/>         
            </ui:insert>

        </div>  

        <div id="greenBand" class="ui-state-default ui-corner-allh" style="position:relative; top:35px; left:0px;"> 
            <h:graphicImage alt="Dashboard"  style="position:relative; top:-20px; left:9px;"  value="resources/images/logo_application.png" />
        </div>
        <div id="main" style="margin: 0 auto; width:1190px; height:700px; position:absolute;  background-color:transparent; top:105px">

            <div id="mainpage" style="margin: 0 auto; width:1190px; height:500px; position:absolute;  background-color:transparent; top:80px">

                <div id="settingsHashMap" style="width:750px; height:400px; position:absolute;  background-color:r; top:20px; left:1px">

                    <p:spinner /> 
                    <h:form id="form">
                        <p:tabView id="tabView" dynamic="true" cache="true">

                            <p:tab id="tba1" title="Godfather Part I">
                                <h:panelGrid columns="2" cellpadding="10">
                                    <h:outputText
                                        value="The story begins as Don Vito Corleone, the head of a New York Mafia family, oversees his daughter's wedding.
                                        His beloved son Michael has just come home from the war, but does not intend to become part of his father's business. T
                                        hrough Michael's life the nature of the family business becomes clear. The business of the family is just like the head of the family, kind and benevolent to those who give respect,
                                        but given to ruthless violence whenever anything stands against the good of the family." />
                                </h:panelGrid>
                            </p:tab>

                            <p:tab id="tab2" title="Godfather Part II">
                                <h:panelGrid columns="2" cellpadding="10">
                                    <h:outputText value="Francis Ford Coppola's legendary continuation and sequel to his landmark 1972 film, The_Godfather, parallels the young Vito Corleone's rise with his son Michael's spiritual fall, deepening The_Godfather's depiction of the dark side of the American dream.
                                                  In the early 1900s, the child Vito flees his Sicilian village for America after the local Mafia kills his family. Vito struggles to make a living, legally or illegally, for his wife and growing brood in Little Italy,
                                                  killing the local Black Hand Fanucci after he demands his customary cut of the tyro's business. With Fanucci gone, Vito's communal stature grows."/>
                                </h:panelGrid>
                            </p:tab>

                            <p:tab id="tab3" title="Godfather Part III">
                                <h:panelGrid columns="2" cellpadding="10">
                                    <h:outputText value="After a break of more than 15 years, director Francis Ford Coppola and writer Mario Puzo returned to the well for this third and final story of the fictional Corleone crime family.
                                                  Two decades have passed, and crime kingpin Michael Corleone, now divorced from his wife Kay has nearly succeeded in keeping his promise that his family would one day be completely legitimate."/>
                                </h:panelGrid>
                            </p:tab>

                        </p:tabView>
                    </h:form>

                </div>   

                <div id="settingsdivb" style="width:350px; height:400px; position:absolute;  background-color:transparent; top:20px; left:800px">

                </div>   

            </div>  
        </div>

    </h:body>
</html> 
```

我不知道为什么，但我只能看到纯文本 - 没有标签？我错过了什么？

最好的祝愿

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T18:36:39.390

如果您尚未在 web 应用程序中实际安装 PrimeFaces，则可能会发生这种情况。

[下载](http://www.primefaces.org/downloads.html)JAR 文件，将其放入`/WEB-INF/lib`文件夹并重新构建/重新部署/重新启动。

# php - 将某些表列导入数据库表

> ID：10196640
> 
> 赞同：0
> 
> 时间：2012-04-17T18:10:50.800
> 
> 标签：php, mysql

我有一个名为`schools`. 我在另一台服务器上有一个现有的数据库表，它具有我需要的类似学校信息。示例：姓名、城市、州等，我正在使用 phpMyAdmin 来管理它。

我的问题是......将学校数据从外部服务器的数据库表导出到新的数据库表但只提取和导入我需要的列（例如：姓名、城市、州等）的最佳/详细方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:16:46.410

在 SQL 中，选择您需要的数据，

```
SELECT (name, city, state) FROM schools 
```

然后在PHP中，将其输出为某种格式，

```
$results = $query->fetchAll();
for ($i=0; $i<sizeof($results); $i++) {
    # format the output
} 
```

phpMyAdmin 具有以某些格式（包括 CSV）导入（和导出）数据的功能。

然后，您可以将 CSV 文件导入新服务器。

您也可以采用其他方式：保存整个数据库并将其导入新服务器。然后按照此语法使用 SQL 删除不需要的列，

```
ALTER TABLE tableName DROP columnName; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:26:57.340

如果您使用的是 phpMyAdmin，那么它允许您以 SQL 格式将整个表导出到可下载的文件中。这似乎是导出数据的最佳方式。然后，您可以将此文件上传到目标服务器并通过 phpMyAdmin 导入。

这种方法的一个警告是您需要确保您的表名不会冲突。如果他们这样做，您将需要重命名一个或另一个（我建议在导出之前重命名源表）。

导入整个表格后，您可以在必填字段上执行 INSERT INTO...SELECT。

# sql-server-2005 - 使用 sp_executesql 的语法错误

> ID：10196645
> 
> 赞同：1
> 
> 时间：2012-04-17T18:11:03.293
> 
> 标签：sql-server-2005

这是声明：

```
exec sp_executesql N'CRM_ValidateUser @p0, @p1, @p2',
    N'@p0 nvarchar(5),@p1 nvarchar(4),@p2 int',@p0=N'login',@p1=N'pass',@p2=15 
```

为什么我会收到此错误消息：

> 消息 102，级别 15，状态 1，第 1 行
> “CRM_ValidateUser”附近的语法不正确。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T18:21:21.963

您需要说 EXEC 以防任何其他命令作为批处理的一部分传输。在这种情况下，它将是参数定义，因此实际发送回 SQL Server 的批处理将类似于：

```
DECLARE @p0 NVARCHAR(5);
...
CRM_ValidateUser ... 
```

这就是您出现错误消息的原因。*如果存储过程调用是批处理中的第一*`EXEC`条语句，则只能省略，恕我直言，无论如何都不应该排除。尝试：

 *```
EXEC sp_executesql N'EXEC CRM_ValidateUser... 
```

指定模式前缀也是一个好主意。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-17T18:25:19.823

```
DECLARE @p0 NVARCHAR(5);
DECLARE @p1 NVARCHAR(4);
DECLARE @p2 INT;

SET @p0 =N'login';

SET @p1 = N'pass';

SET @p2 = 15;
EXECUTE sp_executesql N'CRM_ValidateUser', @p0, @p1, @p2; 
```*

# clearcase - 是否可以在 perforce 中列出按上次签入时间排序的文件夹中的文件？

> ID：10196647
> 
> 赞同：6
> 
> 时间：2012-04-17T18:11:12.167
> 
> 标签：clearcase, perforce

我最近从 ClearCase 搬到了 Perforce。在 CC 中，我曾经按上次签入时间对 ClearCase 资源管理器中的文件列表进行排序。有什么办法可以用 Perforce 做类似的事情吗？理想情况下，在 P4V 中？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T18:16:04.277

是的 - 在 P4V 中，选择您要列出文件的目录，然后从“查看”菜单中单击“按修改日期排序”。

请注意，如果您想按上次签到时间排序，则需要在 Depot 选项卡中执行此操作。如果您从显示本地文件的工作区选项卡执行此操作，它将包括您在本地更改的任何文件的修改时间。

# matlab - Simulink 数值评估以防止溢出

> ID：10196654
> 
> 赞同：0
> 
> 时间：2012-04-17T18:11:42.287
> 
> 标签：matlab, simulink

我有这个功能

```
f(a,b) = { 
            a*a/b   if a < b,
            b       if a >= b 
         } 
```

为介于 0 和 1 之间的 a 和 b 值定义。

该函数在此范围内的所有有效值 a 和 b 处是连续的。（真的！你自己试试吧！）但我不确定如何在 Simulink 中评估它。`min(a*a,b*b)/b`问题是`b=0`我无法弄清楚如何以一种可以评估函数的两个“分支”并取最小值或最大值（例如'希望避免陷入诸如有条件执行的子系统之类的事情。

有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T14:30:24.727

你有一些奇怪的限制。由于您坚持评估两个分叉并取两者的最小值，因此唯一的解决方案是不要除以零，而是除以足够小的数字以避免错误（例如 eps）。

![在此处输入图像描述](../Images/efce8ab25ff52124f148655c7ad76f21.png)

或使用 if 动作块： ![在此处输入图像描述](../Images/2d96044dd23eaec5bdd4a3020dfa9061.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:01:42.937

我认为最简单的方法是使用[MATLAB function block](http://www.mathworks.com/help/toolbox/simulink/slref/matlabfunction.html)。你可以这样编码

```
function retVal = myfunc(a, b)
   if (a < b)
     retVal = a*a/b;
   else
     retVal = b;
   end
end 
```

这将创建一个具有 2 个输入和一个输出的块。我不确定您如何确保 a,b \in [0,1]，但只要满足该限制，这将起作用。

# java - 需要有关如何在 java 中为 r/b 树创建节点类的建议

> ID：10196657
> 
> 赞同：0
> 
> 时间：2012-04-17T18:11:48.040
> 
> 标签：java, treenode, red-black-tree

我们被要求在 Java 中实现一棵红黑树，但我不确定这是如何完成的。如果有人能评论我的节点类以实现 r/b 树，那就太好了。开始了：

```
public class RBTnode {

public RBTnode(int key, RBTnode left, RBTnode right) {
    /* this is the constructor for a root node */
    color = 0;
    parent = null;
    key = this.key;
    left = this.left;
    right = this.right;
}

public RBTnode(int key, RBTnode left, RBTnode right, RBTnode parent, int color ) {
    key = this.key;
    color = this.color;
    left = this.left;
    right = this.right;
    parent = this.parent;

}

int color; // 0 black, 1 red
int key;
RBTnode parent;
RBTnode left;
RBTnode right; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:35:27.860

我自己还没有写过 RB 树，但我现在正在学习它们。据我所知，您似乎需要进行一些调整。

为了使 RB 树成为 RB 树，您需要遵循某些规则：

*   每个节点都是红色或黑色

*   根节点始终为黑色

*   新节点始终为红色

*   RED 节点的两个孩子都是黑色的。

*   从根到叶子或到空子节点的每条路径都必须包含相同数量的黑色节点。

话虽如此，我认为您不需要第二个构造函数，因为无论如何，您总是要将新节点初始化为 RED。

# linux - 安装两个操作系统时，某些文件夹的windows和linux的内存空间是否重叠？

> ID：10196663
> 
> 赞同：0
> 
> 时间：2012-04-17T18:12:11.023
> 
> 标签：linux

我的电脑上同时安装了 linux 和 windows。当我在 lex 和 yacc 中制作一些程序（在 linux 上工作时）并将所有文件存储在一个文件夹中时，如果我使用 windows 一段时间，它们就会损坏。例如，在存储所有文件（xyz.l，a.out）后 3 天，我在重新启动电脑后切换到 Windows 进行其他工作。3天后，当我再次打开该文件夹（使用linux时）时，a.out被转换为图像，当我双击它时，图像打开了。该图像与我两天前在 Windows 上工作时下载的图像相同，但我存储在其他文件夹中。那么用于存储linux和windows的内存空间是否重叠？如果不是，可能是什么原因？它已经发生了2次。真的我必须重新编码我所有的程序。我无法理解为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:19:45.030

它不应该重叠。这听起来像一个配置问题，其中 windows 和 linux 被配置为挂载相同的[分区](https://en.wikipedia.org/wiki/Disk_partitioning)。检查文件[/etc/fstab](http://man.cx/fstab)（linux下），看看是不是真的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:20:55.980

我不知道你的分区是什么样子的，但我猜它的设置方式是两个操作系统都具有对所有分区的读/写访问权限，或者至少 Windows 对 Linux 分区具有读/写访问权限。

你的linux分区是FAT32分区吗？您应该将其设置为仅在 Windows 中读取，但我不确定如何执行此操作。

你在windows端使用hibernate吗？如果数据在休眠时发生更改，Windows 可能会感到困惑，这可能是问题的原因。

# git - Git回滚1拉

> ID：10196668
> 
> 赞同：59
> 
> 时间：2012-04-17T18:12:29.300
> 
> 标签：git, rollback

我有一个 Web 服务器，它服务于一个 git 存储库的项目。当我对代码进行一些更改时，我会从服务器执行 git pull。有时新代码会崩溃，我希望能够回滚到最新的拉动，即之前的拉动。我想用一个脚本来做到这一点，而不必搜索最新的 sha。我怎样才能做到这一点？

编辑：澄清一下，我只想做一个动作，比如按下一个按钮，上面写着“哎呀！我刚刚做的最新拉动是一个错误，我希望我没有这样做”。在这种情况下，我不想寻找 sha 或标签或其他任何东西，它更像是一个“撤消”功能。然后我希望能够继续处理代码，并且服务器上的下一个 pull 需要带来最新的更改。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2012-04-17T19:31:06.100

`git reset --hard HEAD^1`将从您提取的内容中收回一次提交。如果您希望它恢复到拉动之前的状态，请使用`git reset --hard HEAD@{1}`. 在您的本地仓库中更改它的最后一次操作之前磁头所在的`@{1}`轨道，因此如果在您拉动之前推送了几个提交，它将返回多个提交。另请参阅`git reflog`以显示整个列表。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-10-25T04:53:12.913

还有另一种方法可以丢弃最后一次拉动

```
git reset --keep HEAD@{1} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-17T18:15:45.670

`git reset HEAD^`应该带你到上一个提交。请参阅[此处](http://book.git-scm.com/4_undoing_in_git_-_reset,_checkout_and_revert.html)了解更多信息。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-17T19:19:32.660

在这种情况下，使用分支是有意义的，它可以在失败或成功时轻松删除或合并。这将帮助您跟踪新内容，并且如果您遇到比“仅删除最后一次提交”更复杂的情况（尤其是因为您想使用脚本执行此操作），则可以使事情变得更清晰。所以在你的服务器上：

```
git fetch --all           # fetch new commits from remote
git checkout -b testing   # create and switch to branch 'testing'
git merge origin/master   # merge new commits from remote branch master
                          # (in branch 'testing') 
```

...然后测试东西...如果成功：

```
git checkout master       # switch back to master
git merge testing 
```

失败时：

```
git checkout master
git branch -D testing     # remove testing branch 
```

但无论如何......你唯一的一点是删除最后一次提交，你可以使用`git reset`Josh 指出的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-04-01T08:18:43.150

我用下面的命令来恢复最后一次提交

```
git merge --abort 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-12-13T13:19:02.040

@Karl Bielefeldt 接受的答案并不完全适合我。我正在使用 GIT 版本 2.10.0.windows.1 可能这适用于旧版本。我收到“未知开关'e'”错误。最后，我做了一些改变，它奏效了。

以下是在上一次拉取之前恢复到状态的步骤：

1.  用于`git reflog`查看 Karl 提到的列表。
2.  从列表中选择要移回的提交版本。
3.  执行`git reset --hard <commit version>`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-12-06T10:36:40.657

你可以简单地这样做：

```
git reset --hard 8b2574f 
```

通过做找到8b2574f

```
git reflog 
```

**8b2574f**代表任何 HEAD，而且我的与你的不同。当你运行上面的命令时，你会得到你的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-17T18:19:23.720

另一种方法是使用标签。想法是你可以在拉取之前用一些版本号标记你的 HEAD，做拉取，然后如果你需要回滚 HEAD 你可以这样做`git reset {tag name}`如果拉取有多个提交，你可以跳回你之前的位置到合并。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2020-03-20T18:23:25.017

有两个命令：

1.  git reset --hard@{1}

2.  git reset --hard^1

First ：回滚到最后一次拉取之前的状态。

第二：回滚到上次提交之前的状态（包括合并代码）。

希望能帮助到你。

# c++ - WebP 编码 - 分段错误

> ID：10196671
> 
> 赞同：1
> 
> 时间：2012-04-17T18:12:43.970
> 
> 标签：c++, opencv, webp

所以我正在尝试使用 webp API 来编码图像。现在我将使用 openCV 打开和操作图像，然后我想将它们保存为 webp。这是我正在使用的来源：

```
#include <stdlib.h>
#include <stdio.h>
#include <math.h>
#include <cv.h>
#include <highgui.h>
#include <webp/encode.h>

int main(int argc, char *argv[])
{

    IplImage* img = 0;
    int height,width,step,channels;
    uchar *data;
    int i,j,k;
    if (argc<2) {
        printf("Usage:main <image-file-name>\n\7");
    exit(0);
    }
    // load an image
    img=cvLoadImage(argv[1]);

    if(!img){
        printf("could not load image file: %s\n",argv[1]);
        exit(0);
    }

    // get the image data
    height      = img->height;
    width       = img->width;
    step        = img->widthStep;
    channels    = img->nChannels;
    data        = (uchar *)img->imageData;
    printf("processing a %dx%d image with %d channels \n", width, height, channels);

    // create a window
    cvNamedWindow("mainWin", CV_WINDOW_AUTOSIZE);
    cvMoveWindow("mainWin",100,100);

    // invert the image
    for (i=0;i<height;i++) {
        for (j=0;j<width;j++) {
            for (k=0;k<channels;k++) {
                data[i*step+j*channels+k] = 255-data[i*step+j*channels+k];
            }
        }
    }

    // show the image
    cvShowImage("mainWin", img);

    // wait for a key
    cvWaitKey(0);
    // release the image
    cvReleaseImage(&img);

    float qualityFactor = .9;
    uint8_t** output;
    FILE *opFile;
    size_t datasize;
    printf("encoding image\n");
    datasize = WebPEncodeRGB((uint8_t*)data,width,height,step,qualityFactor,output);

    printf("writing file out\n");
    opFile=fopen("output.webp","w");
    fwrite(output,1,(int)datasize,opFile);
} 
```

当我执行这个时，我得到这个：

```
nato@ubuntu:~/webp/webp_test$ ./helloWorld ~/Pictures/mars_sunrise.jpg 
processing a 2486x1914 image with 3 channels 
encoding image
Segmentation fault 
```

它可以很好地显示图像，但编码会出现段错误。我最初的猜测是，这是因为我在尝试写出数据之前释放了 img，但在尝试编码之前或之后释放它似乎并不重要。我还缺少其他可能导致此问题的东西吗？我是否必须复制图像数据或其他内容？

WebP api 文档是……稀疏的。以下是 README 关于 WebPEncodeRGB 的内容：

```
The main encoding functions are available in the header src/webp/encode.h
The ready-to-use ones are:

size_t WebPEncodeRGB(const uint8_t* rgb, int width, int height, 
    int stride, float quality_factor, uint8_t** output); 
```

文档具体没有说明“步幅”是什么，但我假设它与 opencv 中的“步幅”相同。这合理吗？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T11:56:01.083

首先，如果您以后使用它，请不要释放该图像。其次，您的输出参数指向未初始化的地址。这是如何将初始化内存用于输出地址：

```
uint8_t* output;
datasize = WebPEncodeRGB((uint8_t*)data, width, height, step, qualityFactor, &output); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:27:28.183

`cvReleaseImage`在尝试使用指向图像数据的指针进行编码之前释放图像。可能该释放函数会释放图像缓冲区，并且您的`data`指针现在不再指向有效内存。

这*可能*是您的段错误的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:02:52.840

所以看起来问题出在这里：

```
// load an image
img=cvLoadImage(argv[1]); 
```

函数 cvLoadImage 有一个额外的参数

```
cvLoadImage(const char* filename, int iscolor=CV_LOAD_IMAGE_COLOR) 
```

当我改为

```
img=cvLoadImage(argv[1],1); 
```

段错误消失了。

# php - 此代码是防止重复 ID 的正确方法吗？

> ID：10196674
> 
> 赞同：0
> 
> 时间：2012-04-17T18:12:55.623
> 
> 标签：php, mysql, validation, duplicates

我在下面有这段代码，据说它会检测到重复的 id 生成并且不会执行。这段代码是否足以防止重复 ID？

```
 //$guid and $alphabet are other sources from which id is generated
 $unique = false;
 while($unique == false){
     $Guid = NewGuid();
     ob_start();
     echo base_encode($Guid, $alphabet); 
     $newid = ob_get_contents();
     ob_get_clean();

     $query = "SELECT * FROM posts WHERE id='$newid'";
     $res = mysql_query($query) or die(mysql_error());
     if(mysql_num_rows($res) == 0) 
         $unique = true;
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T18:25:47.077

最好的方法是允许 MySQL 使用 auto_increment 创建 ID。

```
CREATE TABLE table_name (
   id int(12) NOT NULL AUTO_INCREMENT,
   /* other columns... */
   PRIMARY KEY (id)
); 
```

然后您只需插入而不指定 ID 列。要检索该值，请使用`mysql_insert_id()`.

如果有一些正当的理由你不能使用 auto_increment（你无法控制数据库并且至少有 10 个 IT 人员告诉过你至少一百次），那么下一个解决方案是添加一个唯一索引列，这将防止输入重复。

```
CREATE UNIQUE INDEX index_name ON table_name (id); 
```

这将防止任何重复。如果由于违反了唯一键（将在错误消息中）而导致插入尝试失败，您可以简单地使用新的 GUID 重试插入。

冲突将非常罕见（几乎不可能），除非有数千万条记录（可能是数亿条），否则您不必担心对其进行优化。

不会有很多其他好的选择可以避免竞争条件。您可以通过交易来管理它，但在您当前的理解水平下，这将非常非常棘手，并且在几乎所有情况下，考虑到上述两个选项，这将浪费您的时间。

所以我想总结一下，你提出的问题的具体答案可能只是尝试插入它。如果你得到一个 dup，要求一个新的 ID，然后再试一次。但根据您的用例，可能会有更好的策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:46:48.393

php具有生成唯一ID的功能，例如。独特的

依赖数据库的自动增量违反了命令查询职责分离，并且在构建大型应用程序时可能会导致问题。

# c# - 使用自定义架构/命名空间解析 XML

> ID：10196675
> 
> 赞同：1
> 
> 时间：2012-04-17T18:13:03.783
> 
> 标签：c#, xml, xsd, xml-parsing

我为 XML 配置文件编写了一个 XSD，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           xmlns:t="http://www.foo.com/schemas/datatransfer"
           targetNamespace="http://www.foo.com/schemas/datatransfer"
           attributeFormDefault="unqualified" elementFormDefault="qualified">
  <xs:element name="transferGroups">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="transferGroup" maxOccurs="unbounded">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="connectionString" type="xs:string" />
              <xs:choice minOccurs="1" maxOccurs="1">
                <xs:element name="script" minOccurs="0" maxOccurs="1">
                  <xs:complexType>
                    <xs:attribute name="path" type="xs:string" use="required" />
                    <xs:attribute name="fileName" type="xs:string" use="required" />
                    <xs:attribute name="useCompression" type="xs:boolean" use="required" />
                  </xs:complexType>
                </xs:element>
                <xs:element name="table" minOccurs="0" maxOccurs="1">
                  <xs:complexType>
                    <xs:attribute name="name" type="xs:string" use="required" />
                    <xs:attribute name="fileName" type="xs:string" use="required" />
                    <xs:attribute name="useCompression" type="xs:boolean" use="required" />
                  </xs:complexType>
                </xs:element>
                <xs:element name="tables" minOccurs="0" maxOccurs="1">
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element name="table" maxOccurs="unbounded" minOccurs="1">
                        <xs:complexType>
                          <xs:attribute name="name" type="xs:string" use="required" />
                          <xs:attribute name="fileName" type="xs:string" use="required" />
                          <xs:attribute name="useCompression" type="xs:boolean" use="required" />
                        </xs:complexType>
                      </xs:element>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:choice>
              <xs:element name="format">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="addHeaderRow">
                      <xs:complexType>
                        <xs:attribute name="value" type="xs:boolean" use="required" />
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="columnsDelimitedBy">
                      <xs:complexType>
                        <xs:attribute name="value" type="xs:string" use="required" />
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="rowsDelimitedBy">
                      <xs:complexType>
                        <xs:attribute name="value" type="xs:string" use="required" />
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="transferSite">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="protocol">
                      <xs:complexType>
                        <xs:attribute name="value" type="xs:string" use="required" />
                        <xs:attribute name="address" type="xs:string" use="required" />
                        <xs:attribute name="port" type="xs:unsignedByte" use="required" />
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="credentials">
                      <xs:complexType>
                        <xs:attribute name="userName" type="xs:string" use="required" />
                        <xs:attribute name="password" type="xs:string" use="required" />
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="destinationFolder">
                      <xs:complexType>
                        <xs:attribute name="value" type="xs:string" use="required" />
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
            <xs:attribute name="useCompression" type="xs:boolean" use="required" />
            <xs:attribute name="fileName" type="xs:string" use="optional" />
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

我从我在 Visual Studio 中设计的 XML 文件生成（然后修改）架构，如下所示：

```
<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<transferGroups>
  <transferGroup useCompression="false" >
    <connectionString>DSN=MyDSN;uid=foo;password=bar;</connectionString>
    <tables>
      <table name="dbo.Foo1" fileName="E:\Files\Foo1_{0:yyyyMMdd}.gz" useCompression="true" />
      <table name="pub.Foo2" fileName="E:\Files\Foo2_{0:yyyyMMdd}.gz" useCompression="true" />
    </tables>
    <format>
      <addHeaderRow value="true"/>
      <columnsDelimitedBy value="|" />
      <rowsDelimitedBy value="\r\n" />
    </format>
    <transferSite>
      <protocol value="FTP" address="localhost" port="21" />
      <credentials userName="anonymous" password="test@myserver.com" />
      <destinationFolder value="/" />
    </transferSite>
  </transferGroup>
</transferGroups> 
```

在实践中，我制作了一个这样的配置文件：

```
<transferGroups xmlns="http://www.foo.com/schemas/datatransfer">
  <transferGroup useCompression="false" >
    <connectionString>some connection string</connectionString>
    <tables>
      <table name="tableName1" fileName="tableName1_{0:yyyyMMdd}.gz" useCompression="true" />
      <table name="tableName2" fileName="tableName2_{0:yyyyMMdd}.gz" useCompression="true" />
    </tables>
    <format>
      <addHeaderRow value="true"/>
      <columnsDelimitedBy value="|" />
      <rowsDelimitedBy value="\r\n" />
    </format>
    <transferSite>
      <protocol value="FTP" address="ftp.someplace.com" port="21" />
      <credentials userName="foo" password="bar" />
      <destinationFolder value="subFolder1" />
    </transferSite>
  </transferGroup>
</transferGroups> 
```

然而，我没有意识到指定命名空间/模式改变了在`XmlDocument`. 例如，如果我没有指定架构，这段代码将捕获一个 1，但是一旦指定了架构，就没有节点匹配`XmlNodeList`：`XmlNode`

```
var xmlDoc = new XmlDocument();
xmlDoc.LoadXml(myXml);
var transferGroupNodes = xmlDoc.SelectNodes("//transferGroups/transferGroup")
    .OfType<XmlNode>(); 
```

在这种情况下，我将如何收集`transferGroup`节点进行解析？我在网上找不到一个像样的例子来告诉我如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T19:03:40.430

Schema 与您的问题无关 - 您有带有名称空间的节点，因此需要相应地更改 XPath。正如 Jon Skeet 指出的 LINQ to XML 将使其更易于使用，但您仍然需要选择具有正确名称空间的节点。

在 XPath 中使用命名空间的问题被多次讨论 - 从常见问题解答开始 -[在 C# 中使用带有默认命名空间的 Xpath](https://stackoverflow.com/questions/585812/using-xpath-with-default-namespace-in-c-sharp)。

使用 XPath 忽略命名空间的欺骗方式：`"//*[ local-name() = 'justName']"`.

# objective-c - Xcode 错误：ld：找不到 -lgomp 的库

> ID：10196681
> 
> 赞同：0
> 
> 时间：2012-04-17T18:13:52.137
> 
> 标签：objective-c, xcode, ios4

我正在根据 C 中的库在 Objective-C 中编译一个项目。

编译失败并出现以下错误：

```
Ld /Users/user/Library/Developer/Xcode/DerivedData/MyProject-enqkiqdfplxedfeowxlkwfgadtyz/Build/Products/Debug-iphonesimulator/MyApp.app/MyApp normal i386

cd /Users/user/Documents/XCodeWorkspace/MyProject/Subproject

setenv MACOSX_DEPLOYMENT_TARGET 10.6

setenv PATH "/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/clang -arch i386 -isysroot /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk -L/Users/user/Library/Developer/Xcode/DerivedData/MyProject-enqkiqdfplxedfeowxlkwfgadtyz/Build/Products/Debug-iphonesimulator -L/Users/user/Documents/XCodeWorkspace/MyProject/Subproject/../../../../../Library/Developer/Xcode/DerivedData/MyProject-enqkiqdfplxedfeowxlkwfgadtyz/Build/Products/Debug-iphoneos -F/Users/user/Library/Developer/Xcode/DerivedData/MyProject-enqkiqdfplxedfeowxlkwfgadtyz/Build/Products/Debug-iphonesimulator -filelist /Users/user/Library/Developer/Xcode/DerivedData/MyProject-enqkiqdfplxedfeowxlkwfgadtyz/Build/Intermediates/MyProject.build/Debug-iphonesimulator/MyApp.build/Objects-normal/i386/MyApp.LinkFileList -mmacosx-version-min=10.6 -Xlinker -objc_abi_version -Xlinker 2 -fopenmp -licucore -Xlinker -no_implicit_dylibs -D__IPHONE_OS_VERSION_MIN_REQUIRED=40300 -lamsip -lcares -lexosip2 -lgsm -lmediastreamer2 -lspeex -lsrtp -lsqlite3.0 -framework MessageUI -framework AudioToolbox -framework AVFoundation -lz -framework AddressBook -framework AddressBookUI -framework Foundation -framework UIKit -framework CoreGraphics -framework SystemConfiguration -framework CoreTelephony -lTestFlight -o /Users/user/Library/Developer/Xcode/DerivedData/MyProject-enqkiqdfplxedfeowxlkwfgadtyz/Build/Products/Debug-iphonesimulator/MyApp.app/MyApp

ld: library not found for -lgomp

Command /Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/clang failed with exit code 1 
```

我看到的问题是这个库甚至没有在链接命令中指定！为什么需要这个？

你的，伊曼纽尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T19:19:25.910

有人使用“其他标志”启用了 OpenMP，这会导致包含 -lgomp 库。:-(

# sql - SQL SMO 对象 SqlRestore 方法 (ReadFileList)

> ID：10196682
> 
> 赞同：0
> 
> 时间：2012-04-17T18:14:00.333
> 
> 标签：sql, restore, smo

大家下午好——

我进行了相当多的搜索，发现了一些关于如何动态确定包含在 SQL .bak 文件中的逻辑数据文件名的好资源。我使用的 SMO 方法要求我传递 ServerName，但是我的要求要求将实际文件路径传递给备份。我可以在 T-SQL 中得到我需要的东西，但我真的很想确定一种利用 SMO 的方法。下面是 T-SQL，它为我提供了我需要的信息：

```
RESTORE FILELISTONLY
FROM N'C:\Directory\File.bak'
WITH FILE = 1 
```

不幸的是 SqlRestore.ReadFileList(ServerName) 将不起作用，因为备份集尚未恢复到服务器。本质上我需要这些信息，所以我可以将它传递给Restore.RelocateFiles.Add。我实际上是一名刚刚涉足 C# 的 DBA，所以如果您需要更多信息，请告诉我，我会尽力填补空白。感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-30T15:41:18.583

下面的 Powershell 脚本显示了如何根据文件路径读取备份文件：

```
$ServerName="SERVER\MYSQLSERVER"
$svrConn = new-object Microsoft.SqlServer.Management.Common.ServerConnection
$svrConn.ServerInstance=$secondaryServerName
$svrConn.LoginSecure = $true
$svr = new-object Microsoft.SqlServer.Management.Smo.Server ($svrConn)
$fullResotrePath = "\\Path\MyDatabase.bak"
$res = new-object Microsoft.SqlServer.Management.Smo.Restore
$res.Devices.AddDevice($fullRestorePath, [Microsoft.SqlServer.Management.Smo.DeviceType]::File)

$dt = $res.ReadFileList($svr)

foreach($r in $dt.Rows)
{
    foreach ($c in $dt.Columns)
    {
        Write-Host $c "=" $r[$c]
    }
} 
```

# eclipse - 带有 eclipselink 和 derby 数据库的 Eclipse 插件项目

> ID：10196683
> 
> 赞同：0
> 
> 时间：2012-04-17T18:14:02.377
> 
> 标签：eclipse, eclipselink, derby, rcp

我设法使用 eclipselink 创建了一个 java 应用程序，如下所示

[http://www.vogella.com/articles/JavaPersistenceAPI/article.html](http://www.vogella.com/articles/JavaPersistenceAPI/article.html)

但我不能用插件项目做到这一点。我在构建路径中添加了 derby.jar、eclipselink.jar 和 java.persistence_2.0.3.jar。我还在依赖项选项卡的 MANIFEST.MF 的依赖项中添加了 javax.persistence 和 org.apache.derby.jdbc 作为导入包

我的 persistence.xml 与 MANIFEST.MF 位于 META-INF 文件夹中

我的 persistence.xml 看起来像

```
<?xml version="1.0" encoding="UTF-8" ?>
<persistence xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"xsi:schemaLocation="http:
//java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
version="2.0" xmlns="http://java.sun.com/xml/ns/persistence">
<persistence-unit name="todos" transaction-type="RESOURCE_LOCAL">
<class>Tutorial.Todo</class>
<properties>
    <property name="javax.persistence.jdbc.driver"value="org.apache.derby.jdbc.EmbeddedDriver" />
    <property name="javax.persistence.jdbc.url" value="jdbc:derby:simpleDb;create=true" />
    <property name="javax.persistence.jdbc.user" value="test" />
   <property name="javax.persistence.jdbc.password" value="test" />

   <property name="eclipselink.ddl-generation" value="create-tables" />
   <property name="eclipselink.ddl-generation.output-mode" value="database" />
     </properties>

</persistence-unit> 
```

我这样称呼它：

```
private static final String PERSISTENCE_UNIT_NAME = "todos";
private static EntityManagerFactory factory;

public static void test {
    factory = Persistence.createEntityManagerFactory(PERSISTENCE_UNIT_NAME);
    EntityManager em = factory.createEntityManager();
    // Read the existing entries and write to console
    Query q = em.createQuery("select t from Todo t");
    List<Todo> todoList = q.getResultList();
    for (Todo todo : todoList) {
        System.out.println(todo);
    }
    System.out.println("Size: " + todoList.size());

    // Create new todo
    em.getTransaction().begin();
    Todo todo = new Todo();
    todo.setSummary("This is a test");
    todo.setDescription("This is a test");
    em.persist(todo);
    em.getTransaction().commit();

    em.close();
} 
```

我得到的错误信息是：

```
!ENTRY org.eclipse.osgi 4 0 2012-04-17 20:54:18.568
!MESSAGE Application error
!STACK 1
javax.persistence.PersistenceException: No Persistence provider for EntityManager named todos
at javax.persistence.Persistence.createEntityManagerFactory(Unknown Source)
at javax.persistence.Persistence.createEntityManagerFactory(Unknown Source)
at rcptest.Application.start(Application.java:30)
at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622)
at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577)
at org.eclipse.equinox.launcher.Main.run(Main.java:1410)
at org.eclipse.equinox.launcher.Main.main(Main.java:1386)
An error has occurred. See the log file
C:\dev\runtime-RcpTest.application\.metadata\.log. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T09:32:56.193

您必须将 a 添加`provider`到您的`persistence.xml`:

```
...
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
... 
```

（`org.eclipse.persistence.jpa.PersistenceProvider`是*EclipseLink*的持久性提供程序。）

## 例子

```
<?xml version="1.0" encoding="UTF-8" ?>
<persistence xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd" version="2.0" xmlns="http://java.sun.com/xml/ns/persistence">

    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>

    <persistence-unit name="todos" transaction-type="RESOURCE_LOCAL">
        <class>Tutorial.Todo</class>

        <properties>
            <!-- your properties -->
        </properties>
    </persistence-unit>

</persistence> 
```

# javascript - RegExp - 替换引号不起作用

> ID：10196684
> 
> 赞同：1
> 
> 时间：2012-04-17T18:14:11.520
> 
> 标签：javascript, regex, str-replace

我想用 替换变量`str'`，`<span class="red">str'</span>`但我总是得到`"'"`跨度的外部。我写了以下javascript：

```
var f1="XY+X'Y";
var str=X;
var patt=new RegExp(str+'\'',"g");
f1.replace(patt, "<span class=\"red\">"+str+"'"+"</span>") 
```

我得到：

```
<span class="red">X</span>'; 
```

我想：

```
<span class="red">X'</span>; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:23:40.253

当我评估

```
var f1="XY+X'Y";
var str="X";
var patt=new RegExp(str+'\'',"g");
f1.replace(patt, "<span class=\"red\">"+str+"'"+"</span>") 
```

我明白了

```
"XY+<span class="red">X'</span>Y" 
```

我认为这是您的预期结果？也许您只需要仔细检查您的引号/字符串变量？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:32:49.567

您正在正则表达式中搜索“X”，并`<span ...>X''</span>`据我所知将其替换为。您的代码似乎存在一些问题，我不确定您希望如何从给定的代码中获得任一结果（您获得的结果或您想要的结果）。我可以建议这个替代方案吗？

```
var f1="XY+X'Y";
var str="X";
var patt=new RegExp(str+"\'?","g");
f1.replace(patt, "<span class=\"red\">$&</span>") 
```

This will find X **or** X' in the source and surround it with the red class span. If you only want to highlight X', then take out the `?` in the patt variable (the ? makes the apostrophe optional).

Edit:

Soluction:

The problem was that I use replace twice on the same string. Something like this

```
var str =f1.replace(patt, "<span class=\"red\">"+str+"</span>").f1.replace(patt, "<span class=\"red\">"+str+"'"+"</span>") 
```

this works for me:

```
var str =f1.replace(patt, "<span class=\"red\">"+str+"</span>");
var str2=str.replace(patt, "<span class=\"red\">"+str+"'"+"</span>"); 
```

Thanks anyway :)

# actionscript-3 - 仅在可见部分上的鼠标事件

> ID：10196685
> 
> 赞同：0
> 
> 时间：2012-04-17T18:14:12.257
> 
> 标签：actionscript-3, apache-flex, flex4, fxg

仅当我与组件的可见部分交互时，如何使 Flex 调度鼠标事件？在这种情况下，我希望仅在悬停该行时才调度事件。

```
<s:Group mouseOver="trace('over')">
    <s:Line xFrom="0" yFrom="0" xTo="100" yTo="100">
         <s:stroke>
             <s:SolidColorStroke color="0" weight="3"/>
         </s:stroke>
    </s:Line>
</s:Group> 
```

我记得前段时间在 Flex 3 中遇到了一个问题，当时我无法捕捉鼠标事件，直到我用透明背景填充画布。但现在我遇到了相反的问题。感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T06:20:13.023

您可以尝试以下代码：-

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>
    <fx:Script>
        <![CDATA[
            import mx.controls.Alert;

            private function rollOver(event:MouseEvent):void
            {
                Alert.show('over');
            }

            private function drawLine():void
            {
                var g:Graphics = graphics;

                graphComp.graphics.clear();
                var strokeColor:Number = getStyle("strokeColor");
                var shadowColor:Number = getStyle("shadowColor");

                graphComp.graphics.beginFill(strokeColor);
                graphComp.graphics.drawRect(0, 0, 100, 1);
                graphComp.graphics.endFill();

                graphComp.graphics.beginFill(shadowColor);
                graphComp.graphics.drawRect(0, 1, 100, 1);
                graphComp.graphics.endFill();
                graphComp.rotation = 45;

            }
        ]]>
    </fx:Script>
    <s:Group id="graphComp" x="100" y="100" creationComplete="drawLine()" rollOver="rollOver(event)"/>

</s:Application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:36:35.923

你在正确的轨道上。

正如您已经完成的那样，您需要将`Line`对象包装在`Group`或其他容器类中，因为 Spark 图形基元（如`Line`）不分派鼠标事件。

我假设您的问题是，由于您的线是对角线，因此边界框`Group`是一个比线大得多的矩形。

如果你画一条水平线或垂直线，那么 的边界框`Group`应该就是 的尺寸`Line`。然后旋转`Group`得到你的对角线：

请注意，我刚刚选择了一个随机 X 值和旋转...旋转具有置换对象 X/Y 坐标的效果...除非您使用`BasicLayout`. 因此，您必须调整 x/y/旋转（和/或布局）以将您的线定位在正确的位置。

```
<s:Group mouseOver="trace('over')" rotation="45">
    <s:Line x="100" yFrom="0" yTo="100">
        <s:stroke>
            <s:SolidColorStroke color="0" weight="3"/>
        </s:stroke>
    </s:Line>
</s:Group> 
```

# ssas - 使用什么查询语言来查询 SSAS 2012 表格模型？

> ID：10196691
> 
> 赞同：0
> 
> 时间：2012-04-17T18:14:36.910
> 
> 标签：ssas, ssas-2012

据我所知，MDX 通常用于 OLAP 多维数据存储。在 SSAS 2012 中，DAX 似乎用于表格模型，但也支持 MDX。那么，为什么一个系统可以使用两种查询语言呢？此外，推荐使用哪一种用于表格模型，为什么？在这些情况下，DAX 是否比 MDX 更快？

我还没有安装或使用 SSAS 2012，所以如果我可能遗漏了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:12:15.123

DMX 是一种数据挖掘查询语言，可用于识别数据中的固有模式。用户 Smith 关于可以在哪个平台上使用哪些语言是正确的。DAX 使用 xVelocity 内存分析引擎，该引擎的平均执行速度比多维立方体技术（ROLAP、MOLAP）更快。MDX 在表格模型上不如 DAX 查询快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:25:18.073

我没有所有的答案，但据我所知，事情就是这样。

MDX 适用于开发人员。DAX 适用于超级用户（excel 用户/业务用户）。

微软认为 MDX 对于商业用户来说太复杂了，所以他们想出了与 Excel 函数非常相似的 DAX，并且他们认为如果他们已经熟悉 Excel，最终用户会很快掌握这一点。

我不知道哪个一定更快，我认为这更多的是您使用的舒适度。就个人而言，我使用这两种语言，但我真的只倾向于在 powerpivot 和 excel 中使用 DAX（显然）。因此，我更愿意尽可能地使用 MDX。

HTH，哦，顺便说一句，我还没有使用 DMX，但相信它也可以与 SSAS 一起使用。是的，我同意一个系统的两个/三个查询语言是一个非常令人困惑的想法，但是一旦您阅读并使用它们，它就会变得更有意义，因为它们的情境用法有很大不同。

# ruby-on-rails - Rails：如何在每次刷新时要求重新加载？

> ID：10196694
> 
> 赞同：0
> 
> 时间：2012-04-17T18:14:49.337
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我注意到，当我`require "digest/sha1"`在模型顶部包含密码散列时，**每次**我在我的应用程序中进行一些更改时，我都必须**重新启动服务器**才能看到更改。

这有点烦人，并且大大减慢了开发速度，尤其是对于像我这样的初学者。

我在某个地方看到`require_dependency "digest/sha1"`它应该可以工作，但它对我不起作用（*说没有文件错误*）。

我什至不确定该放在哪里，`require_dependency`因为我没有找到任何示例。

应该有一些方法可以使它工作，因为这是很常见的问题，也许我只是在寻找错误的地方。

谢谢

**编辑 ：**

我得出的结论是，当我的 Ubuntu 机器进入睡眠状态时会出现错误。唤醒后，本地服务器（尝试瘦和 WEBrick）给出该错误。

**编辑 ：**

它与 Ubuntu 睡眠无关。我有一个名为的函数`hash`，每次都会出错，抱怨它的参数数量错误，但该函数从未被调用。

所以，我将它重命名为`encrypt`，现在它正在工作，但我不能 100% 确定它是解决方案，我必须测试更多。

如果可以，那将是一个奇怪的错误，我将发布答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:49:53.877

在开发模式下，默认情况下，请求之间会重新加载`app/`或重新加载任何内容。`config/routes.rb`如果您没有发生这种情况，则可能不是由需求引起的。您更有可能无意中关闭了重新加载。

我之前`digest/sha1`在很多项目中都使用过，从来没有遇到过这个问题，通常将它包含在使用它的 User 模型中。

你能在一个全新的 Rails 项目中复制这个问题吗？如果删除那条线，问题会消失吗？如果是这样，那就太奇怪了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T23:32:26.827

如果你删除`require "digest/sha1"`所有工作正常？无论如何
检查 `config.cache_classes = false``config/environments/development.rb`

# language-agnostic - 为插入和保存创建单独的类

> ID：10196696
> 
> 赞同：0
> 
> 时间：2012-04-17T18:14:53.903
> 
> 标签：language-agnostic

这是一个好主意吗？与其创建具有两个方法 ( `insert`and `update`) 和两个验证方法 ( `validateInsert`and `validateUpdate`) 的类，不如创建三个类：一个称为`ProductDB`，另一个`ProductInsert`（使用 Insert 和 Validate 方法）和另一个`ProductUpdate`（使用与 ProductInsert 相同的方法）。

这是否更具可读性、灵活性和可测试性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:29:45.250

PaulG 的回答更倾向于传统的域对象模式，我不赞成这种模式。就个人而言，我的偏好是为每个流程（如您的 ProductInsert 和 ProductUpdate）设置一个单独的类。这类似于在简单的银行示例中看到的，其中 Deposit 是类的实例，而不是 BankAccount 类的方法。当您开始考虑具有更多内容的业务流程时，例如要采取的规则和操作以及操作本身的审计/持久性（例如用于跟踪插入的 ProductInsert 表），您越意识到业务流程应该是一等公民在自己的权利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:17:58.640

这听起来像是一个与语言无关的问题。我将只创建一个类并将其命名为 Product，并在该类中使用适当的方法。想想当实际实例化你的单独对象时会有多混乱（除非你有静态方法）。

还有一个具体的 Product 类将允许您存储特定于对象的信息。

前任：

`Product myProduct = new Product()`

`myProduct.name = "cinnamon toast crunch"`

`myProduct.price = 3.99`

在我看来，单独的类会使您的代码的可读性和可测试性降低很多。

# ruby-on-rails - 在 Rails 中是否有提供“after_response”过滤器的 gem？

> ID：10196698
> 
> 赞同：2
> 
> 时间：2012-04-17T18:14:56.770
> 
> 标签：ruby-on-rails

我正在尝试进行一些激烈的优化。我知道延迟工作。但我什至不想在发送响应之前花时间创建延迟作业。我想回复用户，然后担心在发送响应后创建延迟作业。

有没有一些宝石可以做这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T19:17:28.253

如果它是轻量级的，你可以创建一个线程：

```
def show
  @record = Record.find(params[:id])
  Thread.new do
    Rails.logger.info "#{Time.now}"
    sleep 10
    Rails.logger.info "#{Time.now}"
  end
end 
```

我的日志输出与上述（响应立即呈现）

```
Started GET "/" for 127.0.0.1 at 2012-04-17 14:15:29 -0500
Processing by HomeController#public as HTML
2012-04-17 14:15:29 -0500
  Rendered home/public.html.haml within layouts/application (0.4ms)
  Rendered layouts/_navbar.html.haml (8.9ms)
  Rendered layouts/_flash.html.haml (0.1ms)
  Rendered layouts/_footer.html.haml (0.1ms)
Completed 200 OK in 210ms (Views: 202.3ms | ActiveRecord: 0.0ms)
2012-04-17 14:15:39 -0500 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:37:51.067

延迟工作。在某些时候，您必须在发送响应后存储有关您想要执行的进程的一些信息，而这正是延迟作业的用途：存储有关要在后台运行的进程的信息。

任何其他 gem 基本上都会做同样的事情，即存储一些关于做什么的信息。延迟工作有什么问题？如果您对延迟工作有任何具体问题，最好解决它而不是使用任何其他未经证实的方法。

# html - 将渲染到 html5 画布的 mathml 保存为 png

> ID：10196711
> 
> 赞同：0
> 
> 时间：2012-04-17T18:16:07.870
> 
> 标签：html, canvas, png, mathml

我的最终目标是将呈现的演示文稿 MathML 保存到 .PNG 文件中。知道编程是危险的 :-) 可能有更好的方法来做到这一点......我在画布元素上绘制方程，然后尝试将画布元素保存为 .PNG。我从这里找到的代码开始——https: [//developer.mozilla.org/en/HTML/Canvas/Drawing_DOM_objects_into_a_canvas——](https://developer.mozilla.org/en/HTML/Canvas/Drawing_DOM_objects_into_a_canvas)并修改如下：

```
<!DOCTYPE html>
<html>
<body>
<canvas id="canvas" style="border:2px solid black;" width="200" height="200">
</canvas>

<script>
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");
var data = "<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'>" +
        "<foreignObject width='100%' height='100%'>" +
        "<div xmlns='http://www.w3.org/1998/Math/MathML'     style='fontsize:40px'>" +
        "<math>" +
        "<mtable>" +
        "<mtr>" +
        "<mtd columnalign='right'>" +
            "<mn>2</mn>" +
            "<mi>x</mi>" +
            "<mo>+</mo>" +
            "<mn>3</mn>" +
            "<mo>&#8722;</mo>" +
            "<mn>3</mn>" +
         "</mtd>" +
         "<mtd columnalign='center'> " +              
            "<mo>=</mo>" +
        "</mtd>" +
        "<mtd columnalign='left'> " +              
            "<mn>9</mn>" +
            "<mo>&#8722;</mo>" +
            "<mn>3</mn>" +
         "</mtd>" +
        "</mtr>" +
        "</mtable>" +
        "</math>" +
        "</div>" +
        "</foreignObject>" +
        "</svg>";

var svg = new (self.BlobBuilder || self.MozBlobBuilder || self.WebKitBlobBuilder);
var DOMURL = self.URL || self.webkitURL || self;
var img = new Image();
svg.append(data);
var url = DOMURL.createObjectURL(svg.getBlob("image/svg+xml;charset=utf-8"));
img.onload = function() {
    ctx.drawImage(img, 0, 0);
    DOMURL.revokeObjectURL(url);
};
img.src = url;

window.open(canvas.toDataURL('image/png'));

</script>

</body>
</html> 
```

如果我注释掉 window.open 我可以在 canvas 元素中看到 MathML，但 toDataURL 生成的 .PNG 只是透明的（没有数学方程式）。我错过了什么？提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T19:17:11.493

我立即看到的问题是您将画布的渲染推迟到图像加载，但是您`window.open`在没有确保其已加载的情况下调用代码。您需要执行以下操作

```
img.onload = function() {
    ctx.drawImage(img, 0, 0);
    DOMURL.revokeObjectURL(url);
    // now the image has been drawn for sure *before* opening the window
    window.open(canvas.toDataURL('image/png'));
};
img.src = url; 
```

# php - MySQL查询以从播放列表时间表中选择播出节目

> ID：10196714
> 
> 赞同：0
> 
> 时间：2012-04-17T18:16:19.597
> 
> 标签：php, sql, date, time

我正在尝试编写**一个**SQL 查询，它总是给出**三行**结果。数据库如下：

```
uid | program_date | program_time | program_name
------------------------------------------------ 
1   | 2012-04-16   | 21:00        | Some movie
2   | 2012-04-16   | 23:00        | Program end
3   | 2012-04-17   | 10:00        | Animation
4   | 2012-04-17   | 11:00        | Some other movie
5   | 2012-04-17   | 12:00        | Some show 
```

我所需要的 - 总是有三排 - 现在正在播出的节目，下一个节目和即将播出的节目。所以如果今天是`2012-04-16 21:00`它应该输出`Some movie`, `Program end`, `Animation`.

在`2012-04-17 00:00`它应该输出`Program end`, `Animation`, `Some other movie`.

问题是如果没有记录，我需要在一天内“导航”回来`WHERE program_date = date("Y-m-d") AND program_time <= date("H:i:s");`

还有另一个问题 - 数据库没有 Unix 时间戳字段，只有`Uid`, `program_date`（日期字段）和`program_time`（时间字段）和`program_name`.

此外，可能存在`Uid`未按顺序插入表中的情况，因为某些节目条目可能会插入到现有节目时间表之间。

我正在尝试各种方法，但想在一个 SQL 查询中完成所有事情，而不是在 PHP 中循环。

有人能帮我一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T19:49:11.123

As TV-people count and show time in rather strange manner, MySQL function may be created to handle their non-human ;-) logic easier:

```
CREATE FUNCTION TV_DATE(d CHAR(10), t CHAR(5))
RETURNS CHAR(16) DETERMINISTIC
RETURN CONCAT(d, IF (t < "06:00", "N", " "), t); 
```

User-defined functions are declared per-database and this may be done just once. `DETERMINISTIC` tells that function always return the same result for the same input and internal MySQL optimizer may rely on that. `N` is just a letter which is larger (in string comparison) than whitespace. Consider it as mnemonics for *next* or *night*.

**note**: Hours should be always formatted with 2 digits!

Then using this function we may select what we need even simpler:

```
-- what is on air now
(SELECT `program_name`, TV_DATE(`program_date`, `program_time`) AS `tv_time`
 FROM `table` 
 WHERE (`tv_time` <= TV_DATE(date("Y-m-d"), date("H:i"))
 ORDER BY `tv_time` DESC 
 LIMIT 1)

  UNION

-- next and upcomming
(SELECT `program_name`, TV_DATE(`program_date`, `program_time`) AS `tv_time`
 FROM `table`
 WHERE (`tv_time` > TV_DATE(date("Y-m-d"), date("H:i"))
 ORDER BY `tv_time` ASC
 LIMIT 0, 2) 
```

Keep in mind, that if all records in DB are in future you'll get only 2 of them. The same for situation, when the next program is the last one in DB.

You may add different constant values into queries in order to distinguish those 2 situations.

# python - Pyqt 表格小部件更新

> ID：10196716
> 
> 赞同：0
> 
> 时间：2012-04-17T18:16:47.643
> 
> 标签：python, pyqt4

我在一段时间间隔后在 qtablewidget 中插入一些数据。为此，我正在清除 qtable 的所有内容，然后插入数据。但是表格显示第一行的数据，我希望表格总是显示最后一行。这会感觉像是对表格的真正更新。这个怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:36:57.383

插入行后，调用`QTableWidget.scrollToBottom()`以显示最后一行。

# vba - 单元格中的VBA Excel换行符

> ID：10196718
> 
> 赞同：2
> 
> 时间：2012-04-17T18:16:53.970
> 
> 标签：vba, excel

一个多星期以来，我一直在寻找解决这个问题的方法。我有一张带有格式化文本（颜色和样式）的表格，其值在第一列下方的距离未确定。两者之间有一些空格，但我相信我已经通过使用 IsEmpty 正确处理了这种情况。我想将每个单元格中的每个值都复制到第二列顶部的一个单元格中。我已经成功地将每个单元格中的文本复制到带有换行符的指定连接单元格中，但是我未能成功保持格式。任何人都可以提供有关如何将格式与此文本一起复制的任何帮助，我们将不胜感激。谢谢！

```
'set variable to find the last row of the sheet
Dim LastRow As Integer
'find the last row of the active sheet
LastRow = ActiveSheet.UsedRange.Rows.Count
'loop through each of the rows
For C = 1 To LastRow
    'determine if a cell has a value in it - if so complete below commands
    If (IsEmpty(Cells(C, 1).Value) = False) Then
    'leave the contents of the first cell in the second column, insert a linebreak and copy the values from the current cell in the first column
    Cells(1, 2).Value = Cells(1, 2).Value & Chr(10) & Cells(C, 1).Value
    End If
Next C 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-23T12:06:42.990

您可以使用 Range.Copy 和 Range.PasteSpecial 属性，这些属性易于使用并解决了您格式化单元格的问题。

# facebook - AppID 无法识别，但它在源代码中正确显示（评论框）

> ID：10196721
> 
> 赞同：0
> 
> 时间：2012-04-17T18:17:00.793
> 
> 标签：facebook, comments, app-id

我已将 Facebook 的评论框集成到我的页面中。我将生成的代码复制到我的页面中。App-ID 在源代码中正确显示，但 Facebook 无法识别。我被视为管理员，因为我的 UserID 也在源代码中，所以我看到了审核视图。但是，如果我切换到嵌入式评论框上的“设置”，我会收到以下错误消息：

```
removed 
```

此外，如果我输入评论，我可以直接在嵌入框中编辑它，但它不会显示在 Facebook 的评论审核工具中。

这是我的嵌入式代码：

```
 removed 
```

我还尝试了调试工具。它显示“应该修复的打开图形警告”错误，但这似乎不是 app-id 问题。调试器还显示我的用户/主持人 ID，但没有应用 ID。

谁能帮我？：/ 非常感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T09:39:20.487

问题是缺少元标记：

```
<meta property="fb:app_id" content="APPID_HERE"> 
```

# objective-c - iOS 中的 PDF 包

> ID：10196723
> 
> 赞同：2
> 
> 时间：2012-04-17T18:17:07.137
> 
> 标签：objective-c, ios, pdf, core-graphics, pdf-parsing

我一直在尝试能够提取 PDF 包中包含的 pdf 文档，但没有成功。我在任何地方都找不到任何文档或示例代码，但我知道这并非不可能，因为 Adob​​e Reader 应用程序和 PDFExpert 应用程序都支持它。他们可能有自己的解析器，我希望它不会变成那样......

任何将我指向正确方向的提示将不胜感激

编辑：很长一段时间后，我重新开始研究这个问题，终于弄明白了。特别感谢 iPDFDev 为我指明了正确的方向！！

下面是如何获取每个内部 CGPDFDocumentRef 的代码：

```
NSURL *url = [NSURL fileURLWithPath:filePath isDirectory:NO];
CGPDFDocumentRef pdf = CGPDFDocumentCreateWithURL((__bridge CFURLRef)url);
CGPDFDictionaryRef catalog = CGPDFDocumentGetCatalog(pdf);

CGPDFDictionaryRef names = NULL;
if (CGPDFDictionaryGetDictionary(catalog, "Names", &names)) {
    CGPDFDictionaryRef embFiles = NULL;
    if (CGPDFDictionaryGetDictionary(names, "EmbeddedFiles", &embFiles)) {
        // At this point you know this is a Package/Portfolio

        CGPDFArrayRef nameArray = NULL;
        CGPDFDictionaryGetArray(embFiles, "Names", &nameArray);

        // nameArray contains the inner documents
        // it brings the name and then a dictionary from where you can extract the pdf

        for (int i = 0; i < CGPDFArrayGetCount(nameArray); i+=2) {
            CGPDFStringRef name = NULL;
            CGPDFDictionaryRef dict = NULL;

            if (CGPDFArrayGetString(nameArray, i, &name) &&
                CGPDFArrayGetDictionary(nameArray, i+1, &dict)) {
                NSString *_name = [self convertPDFString:name];

                CGPDFDictionaryRef EF;
                if (CGPDFDictionaryGetDictionary(dict, "EF", &EF)) {
                    CGPDFStreamRef F;
                    if (CGPDFDictionaryGetStream(EF, "F", &F)) {
                        CFDataRef data = CGPDFStreamCopyData(F, NULL);
                        CGDataProviderRef provider = CGDataProviderCreateWithCFData(data);

                        CGPDFDocumentRef _doc = CGPDFDocumentCreateWithProvider(provider);
                        if (_doc) {
                            // save the docRef somewhere (_doc)
                            // save the pdf name somewhere (_name)
                        }

                        CFRelease(data);
                        CGDataProviderRelease(provider);
                    }
                }
            }
        }
    }
}

- (NSString *)convertPDFString:(CGPDFStringRef)string {
    CFStringRef cfString = CGPDFStringCopyTextString(string);
    NSString *result = [[NSString alloc] initWithString:(__bridge NSString *)cfString];
    CFRelease(cfString);
    return result;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T11:14:21.963

通过 PDF 包，我假设您指的是 PDF 组合。PDF 组合中的文件基本上是具有一些扩展属性的文档附件，它们位于 EmbeddedFiles 树中。您从文档目录字典开始。从文档目录字典中检索 /Names 字典。从 /Names 字典中，如果存在（它是可选的），则检索 /EmbeddedFiles 字典。如果存在，则表示嵌入文件树（PDF 规范中的名称树）的头部。
PDF 规范（可在此处获得：[http](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/pdf/pdfs/PDF32000_2008.pdf) : //wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/pdf/pdfs/PDF32000_2008.pdf）在第 7.9.6 节中描述了名称树你就会知道如何解析树。
树将字符串标识符映射到文件规范字典（第 7.11.3 节）。从文件规范字典中，您检索 /EF 键的值，它是嵌入的文件流（第 7.11.4 节）。与此对象关联的流是您要查找的文件内容。

# algorithm - 需要帮助来确定使用哪种算法

> ID：10196725
> 
> 赞同：2
> 
> 时间：2012-04-17T18:17:10.833
> 
> 标签：algorithm, combinatorics, dynamic-programming

我需要一种算法来解决以下条件的问题：

有一组“n”个人和另一组“m”个车间，人比车间多。每个人都选择了所有研讨会的大小为“j”的子集，并根据他们希望帮助该特定研讨会的程度为每个人分配值。现在，每个车间只有有限的职位空缺。

鉴于这些条件，问题将是：

将人员分配到研讨会的最佳方式是什么，以便每个人都参加她认为最有价值的研讨会（给定问题约束，即如果一个人不能参加他们的第一选择，那么算法应该选择第二，第三，第四，等等）。

我认为这个问题与组合优化有关，但我对算法知之甚少。如果有人能告诉我开始调查的人的名字，我将非常感激。

谢谢！请原谅我的英语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T20:21:08.040

这是一个与片面偏好匹配的问题（从某种意义上说，人们对研讨会有偏好，但不是相反）。

这是一篇出色的论文，更详细地讨论了这个问题：[https ://mattmccutchen.net/lumc/index.html](https://mattmccutchen.net/lumc/index.html)

这个问题的最佳解决方案不是特别清楚。有许多不同的最优（帕累托有效）准则。不幸的是，对于他们中的许多人来说，这个问题是 NP 难的。

但是，多项式时间算法有标准。在我链接的论文的“相关工作”部分中有一个很好的列表。

# javascript - 搜索下一个按钮 javascript

> ID：10196734
> 
> 赞同：0
> 
> 时间：2012-04-17T18:17:48.510
> 
> 标签：javascript, regex, search

有没有可能的方法来创建下一个搜索和使用 javascript 搜索所有按钮？到目前为止，这是我的脚本...

```
<script type="text/javascript"> 
    function setSelectionRange(input, selectionStart, selectionEnd)
    {
        input.focus();
        input.setSelectionRange(selectionStart, selectionEnd);
    }
    function selectString (input, string)
    {
        var match = new RegExp(string, "g").exec(input.value);
        if (match)
    {
    setSelectionRange (input, match.index, match.index + match[0].length);
    }
    }
</script> 
```

```
<form action="" method="get" onsubmit="selectString(document.getElementById('text'), document.getElementById('search').value);return false;">               
        <legend>
            <font face="verdana">Zoekveld</font face>
        </legend>
        <input id="search" name="search" type="text" size="75">
        <input type="submit" value="Zoeken">
</form>

<form name=form1 method="get">
        <legend>
            <font face="Verdana">Vind:</font face>
        </legend>
        <textarea id="text" cols="54" rows="20"></textarea>
</form> 
```

这个脚本的问题是它只能找到第一个匹配项......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:49:52.090

将 RegExp 存储在一个变量中，而不是在每个函数执行时创建一个新的，并且它的计数器属性将[`lastIndex`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp/lastIndex)持续`exec()`存在。

```
var r = /^$/;
function setSelector(string) {
    r = new RegExp(string, "i");
}
function selectNextMatch(input) {
    var match = r.exec(input.value);
    if (match)
        setSelectionRange(...);
    else
        alert("Nothing found");
} 
```

```
<input type="text" size="75" onchange="setSelector(this.value);">
<input type="button" value="Zoeken" onclick="selectNextMatch(document.getElementById('text'));">
<textarea id="text" cols="54" rows="20"></textarea> 
```

# sql - 根据收费日期选择有效成本费率的 SQL 查询

> ID：10196743
> 
> 赞同：8
> 
> 时间：2012-04-17T18:18:28.753
> 
> 标签：sql, sql-server, sql-server-2008

SQL新手在这里。我正在尝试生成一个成本核算查询，该查询输出员工考勤卡信息并根据有效的员工成本核算率计算成本。

我的问题类似于此处提出的问题：[追溯生效日期更改与重叠日期](https://stackoverflow.com/questions/4541993/retro-active-effective-date-changes-with-overlapping-dates)，但我不处理追溯或重叠日期范围。

表示例（费率表中的空值表示当前费率）：

```
CREATE TABLE Emp_Rate
(
    Emp int,
    Rate money,
    Rate_Start datetime,
    Rate_Exp datetime
)

CREATE TABLE Emp_Time
(
    Emp int,
    Chrg_Date datetime,
    Chrg_Code varchar(10),
    Chrg_Hrs decimal(8, 2)
)

Insert into Emp_Rate (Emp,Rate,Rate_Start,Rate_Exp) Values ('1','20','5/1/09','4/30/10')
Insert into Emp_Rate (Emp,Rate,Rate_Start,Rate_Exp) Values ('1','21','5/1/10','4/30/11')
Insert into Emp_Rate (Emp,Rate,Rate_Start,Rate_Exp) Values ('1','22','5/1/11',NULL)

Insert into Emp_Time (Emp,Chrg_Date,Chrg_Code,Chrg_Hrs) Values ('1','5/10/09','B','8')
Insert into Emp_Time (Emp,Chrg_Date,Chrg_Code,Chrg_Hrs) Values ('1','5/10/10','B','8')
Insert into Emp_Time (Emp,Chrg_Date,Chrg_Code,Chrg_Hrs) Values ('1','5/10/11','B','8') 
```

查询（返回由多个速率条目引起的欺骗（显然））：

```
Select  Emp_Time.Emp,
        Cast(Emp_Time.Chrg_Date as DATE) as 'Chrg_Date',
        Emp_Time.Chrg_Code,
        Emp_Time.Chrg_Hrs,
        Emp_Rate.Rate,
        Emp_Time.Chrg_Hrs * Emp_Rate.Rate as 'Cost'

From    Emp_Time inner join
        Emp_Rate on Emp_Rate.Emp = Emp_Time.Emp

Order By [Emp],[Chrg_Date] 
```

期望的输出：

```
Emp Chrg_Date   Chrg_Code   Chrg_Hrs    Rate    Cost
1   2009-05-10  B           8.00        20.00   160.00
1   2010-05-10  B           8.00        21.00   168.00
1   2011-05-10  B           8.00        22.00   176.00 
```

我在`Between`子查询中使用运算符绕着圈子根据收费日期隔离正确的费率，但没有任何运气。

我很感激任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:41:23.523

您没有指定 DBMS 类型，下面的答案适用于 sql-server。我相信还有其他方法可以做到这一点，但这种方法会将`null` `Rate_Exp`日期替换为当前日期。

```
Select  et.Emp,
        Cast(et.Chrg_Date as DATEtime) as 'Chrg_Date',
        et.Chrg_Code,
        et.Chrg_Hrs,
        er.Rate,
        et.Chrg_Hrs * er.Rate as 'Cost'
From  Emp_Time et
inner join 
(
    SELECT Emp
        , Rate
        , Rate_Start
        , CASE
            WHEN Rate_Exp is Null
            THEN Convert(varchar(10), getdate(), 101)
            ELSE Rate_Exp
          END as Rate_Exp
    FROM Emp_Rate 
)er 
    on er.Emp = et.Emp
WHERE (et.Chrg_Date BETWEEN er.Rate_Start AND er.Rate_Exp)
Order By et.Emp,et.Chrg_Date 
```

或在您的条款中使用`CASE`声明：`WHERE`

```
Select  et.Emp,
        Cast(et.Chrg_Date as DATEtime) as 'Chrg_Date',
        et.Chrg_Code,
        et.Chrg_Hrs,
        er.Rate,
        et.Chrg_Hrs * er.Rate as 'Cost'
From  Emp_Time et
inner join Emp_Rate er
    on er.Emp = et.Emp
WHERE (et.Chrg_Date 
        BETWEEN er.Rate_Start 
                AND CASE WHEN er.Rate_Exp Is Null 
            THEN  Convert(varchar(10), getdate(), 101)
            ELSE er.Rate_Exp END) 
```

# java - 使用 maven 生成生产就绪输出

> ID：10196745
> 
> 赞同：2
> 
> 时间：2012-04-17T18:18:37.893
> 
> 标签：java, spring, maven

我有一个多模块 maven 项目，我创建了一个依赖于其他 3 个模块的新模块。（我已经有一个生成 .war 文件的网络应用程序 maven 模块，现在我需要这个）

该模块的输出是一个 .jar，它还有一些资源：

1.  弹簧上下文xml文件
2.  属性文件

现在我想制作一个生产就绪文件夹，以便我可以将它上传到我的服务器。我希望 Maven 可以为我做到这一点。

我需要以下布局：

```
myjar.jar
/libs/  (the 3 other maven modules that are dependancies)
/resources 
```

此外，我的父 pom.xml 有一些通用依赖项，例如 slf4j/log4j/，我也需要打包。

如果我可以向 mvn 添加一个会产生如下效果的开关，那就太酷了：

```
mvn clean install production 
```

我计划通过命令行在我的服务器上运行它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T18:23:53.467

我认为您正在寻找的是一个 Maven 程序集：

[https://maven.apache.org/plugins/maven-assembly-plugin/](https://maven.apache.org/plugins/maven-assembly-plugin/)

您可以使用配置文件默认禁用程序集的生成（可以加快开发过程）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T19:54:59.710

@puce 是对的，您最好使用[Assembly Plugin](https://maven.apache.org/plugins/maven-assembly-plugin/)。您不能轻易做到的是向 Maven 添加另一个生命周期“生产”。如果您有时间，您可以编写一个插件来执行此操作，但您最好使用名为“production”或“prod-deploy”的配置文件来启用服务器上的应对。

```
mvn clean install -Pprod-deploy 
```

使用 maven 需要记住的一件事是，它非常擅长使用它的约定来构建项目，但它在实际编写脚本以在构建生命周期之外发生的事情方面非常糟糕。

我曾多次使用外部脚本工具（例如 ant/python/bash 和 groovy）首先使用 mvn 运行构建，然后以更自然的语言编写部署脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T07:26:46.143

Maven 的意图是构建而不是部署到生产。为此，我会推荐像 Chef 或 Puppet 这样的东西。从技术的角度来看，当然可以通过 Maven 处理这些事情。在像 Jenkins 这样的 CI 解决方案上构建什么也是可能的。此外，可以从 Jenkins 运行脚本来进行生产部署。

# web-applications - 如何在网络浏览器中演奏乐器音符？

> ID：10196747
> 
> 赞同：2
> 
> 时间：2012-04-17T18:18:41.847
> 
> 标签：web-applications, audio

我正在为一个项目创建一个工具，在该项目中我获取数据序列并将数据中的特征映射到音符和休止符中。

我需要能够使用一些不同的乐器选项来演奏我想要的任何音符。我编写了很多基于 Web 的应用程序，但从来不需要在运行时播放任意音符。

我知道我需要什么，但不知道它叫什么或在哪里可以找到它。我对 java applet 或 unity3d 库持开放态度。有谁知道这两个平台上的图书馆可以帮助我吗？我没有闪光灯，所以这个平台是不可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:30:03.787

您可以通过 javascript 播放音符。这是一个应用程序：[http ://www.schillmania.com/projects/soundmanager2/](http://www.schillmania.com/projects/soundmanager2/)

您还可以查看 api 的演示：[http ://www.schillmania.com/projects/soundmanager2/demo/api/](http://www.schillmania.com/projects/soundmanager2/demo/api/)

可能还有其他方法，但如果您正在寻找一个开始的例子，那就是一个开始。

# jquery - jQuery .find("img").attr("src") 不返回图像源

> ID：10196752
> 
> 赞同：0
> 
> 时间：2012-04-17T18:18:50.623
> 
> 标签：jquery, ajax, find

我正在使用以下 jQuery 来获取xml 提要的`<title>`和，因为没有返回任何内容，但是如果我要将变量更改为; 当我只查找内容的图像 src 属性值时，我返回了整个内容。`<content>``var contentimg = $(this).find('content').text().find("img").attr("src")``$(this).find('content').text()`

## [http://jsfiddle.net/bpBtC/3/](http://jsfiddle.net/bpBtC/3/)

```
$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "http://www.blogger.com/feeds/2399953/posts/default",
        dataType: "xml",
        success: xmlParser,
        dataType: 'jsonp'
    });
});

function xmlParser(xml) { 
    $(xml).find("entry").each(function () {
        var title = $(this).find('title').text();
        var contentimg = $(this).find('content').text().find("img").attr("src");
        $(".entirecont").append('<br/>'+title+'<br/>'+contentimg+'<br/><br/><br/>');
    });
}
​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:24:26.417

标签中的内容`<content>`被编码。你需要`unescape`它：

```
var contentimg = $(unescape($(this).find('content').text())).find("img").attr("src"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:44:47.850

您的代码中有几个错误：

1.  您没有将 xml 传递给回调函数。
2.  您必须先解析 xml（使用 $.parseXML）
3.  您必须将键和值参数传递给每个函数。

这是一个工作示例（没有来自提要的图像，但这应该是不言自明的）

```
 $(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "http://www.blogger.com/feeds/2399953/posts/default",
        dataType: "xml",
        success: function(xml) {
        xmlParser(xml)
        },
        dataType: 'jsonp'
    });
});

function xmlParser(xml) { 
    parsedxml = $.parseXML(xml)
xml = $(parsedxml)
        entries = xml.find("entry").each(function(key, value) {
        title = $(value).find("title").text()
        $("body").append(title)
        $("<br>").appendTo("body")
        })
}​ 
```

# javascript - 递归更改 JSON 键名（全部大写）？

> ID：10196754
> 
> 赞同：7
> 
> 时间：2012-04-17T18:18:54.160
> 
> 标签：javascript, json

有没有办法将所有 JSON 键名更改为大写字母？

例如：

```
{"name":"john","Age":"21","sex":"male","place":{"state":"ca"}} 
```

并且需要转换为

```
{"NAME":"john","AGE":"21","SEX":"male","PLACE":{"STATE":"ca"}} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-17T18:20:25.770

从你的评论来看，

> 例如，对于内部键 {"name":"john","Age":"21","sex":"male","place":{"state":"ca"}}，像这样会失败

对于这种情况，您可能需要使用递归。见下文，

[**演示**](http://jsfiddle.net/skram/XBWFC/3/)

```
var output = allKeysToUpperCase(obj);

function allKeysToUpperCase(obj) {
    var output = {};
    for (i in obj) {
        if (Object.prototype.toString.apply(obj[i]) === '[object Object]') {
            output[i.toUpperCase()] = allKeysToUpperCase(obj[i]);
        } else {
            output[i.toUpperCase()] = obj[i];
        }
    }
    return output;
} 
```

**输出**

![在此处输入图像描述](../Images/db9e36ffcaea0c89cc3e4561510948c0.png)

* * *

一个简单的循环应该可以解决问题，

[**演示**](http://jsfiddle.net/skram/XBWFC/)

```
var output = {};
for (i in obj) {
   output[i.toUpperCase()] = obj[i];
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T18:34:36.833

您不能直接在给定对象上更改键，但如果要对原始对象进行此更改，可以保存新的大写键并删除旧键：

```
function changeKeysToUpper(obj) {
    var key, upKey;
    for (key in obj) {
        if (obj.hasOwnProperty(key)) {
            upKey = key.toUpperCase();
            if (upKey !== key) {
                obj[upKey] = obj[key];
                delete(obj[key]);
            }
            // recurse
            if (typeof obj[upKey] === "object") {
                changeKeysToUpper(obj[upKey]);
            }
        }
    }
    return obj;
}

var test = {"name": "john", "Age": "21", "sex": "male", "place": {"state": "ca"}, "family": [{child: "bob"}, {child: "jack"}]};

console.log(changeKeysToUpper(test));
```

仅供参考，此功能还可以再次保护无意中修改继承的可枚举属性或方法。

# ios - 在导航栏中使用带有单个选项的分段控件的设计实用性

> ID：10196755
> 
> 赞同：0
> 
> 时间：2012-04-17T18:18:59.150
> 
> 标签：ios, user-interface

我即将完成我的第一个应用程序，该应用程序将提交到应用程序商店，我只是想确保我没有违反 iOS 人机界面指南。我添加了一个带有单个选项的分段控件：排序列表。它本质上用作 UIButton，因为我在选择排序选项后将其 selectedSegmentIndex 设置为 -1。由于难以向导航项的 titleView 添加按钮，我以这种方式设置它。此外，在不久的将来可能会在更新中添加“搜索”选项，并且在那里拥有分段控件将使其更容易添加。我和客户和其他志愿者做了一些初步的测试，大家都认可。

**我的问题是“如果该应用程序将这个分段控件伪装成一个按钮，Apple 会批准该应用程序吗？总的来说，它是一种可接受的设计吗？”**

我已阅读指南和其他文档，但我似乎找不到任何说我不应该这样做的内容，但我想听听您对此的想法和/或您对类似事情的任何经历。

以下是一些屏幕截图，可让您更好地了解：

![在此处输入图像描述](../Images/7e85fb613d72e84ae4a6742f6a06ad59.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:24:04.303

简短的回答：不，您可能不会因为以这种方式使用分段控件而被 App Store 拒绝。

更长的答案：您可能应该做的是将“排序”控件作为条形按钮项放置在导航栏的左侧（或者在右侧，如果您打算按下，将“刷新”控件向左移动导航堆栈上的更多内容）。最好使用操作表 (UIActionSheet) 作为排序选项，而不是页面卷曲的附加视图控制器。

# ruby-on-rails-3 - 在 ruby 1.9 中将 csv 文件转换为表

> ID：10196756
> 
> 赞同：1
> 
> 时间：2012-04-17T18:19:03.360
> 
> 标签：ruby-on-rails-3, csv

我在 ruby​​ 1.9 中使用 csv 库，并尝试按照此处显示的表的示例进行操作：

[链接到 github 上的 faster_csv](https://github.com/JEG2/faster_csv/blob/master/examples/csv_table.rb)

我的代码如下：

```
<% require 'csv' %>
<% table = CSV.parse("public/assets/file.csv", :headers => true, :header_converters =>   :symbol) %>

 <%= table %> 
```

但是上面会返回一个空白屏幕，我希望它会在其中显示文件。

此外，当我尝试查看 table[0].fields 时，我得到了错误

```
undefined method `fields' for nil:NilClass 
```

但是，以下在读取 csv 文件时有效：

```
<% b = CSV.read("public/assets/khq.csv") %>
<%= b %> 
```

我在表格示例中做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:33:48.193

对于 1.9.2，尝试

```
CSV.table("public/assets/file.csv") 
```

或者

```
CSV.read("public/assets/file.csv", :headers=>true, :conveters=>:numeric, :header_converters=>:symbol) 
```

仅供参考，CSV.parse 用于字符串，而不是文件。您可以在此处查看文档[http://ruby-doc.org/stdlib-1.9.2/libdoc/csv/rdoc/CSV.html#method-c-parse](http://ruby-doc.org/stdlib-1.9.2/libdoc/csv/rdoc/CSV.html#method-c-parse)

# php - php explode() 函数问题 - 空格

> ID：10196757
> 
> 赞同：0
> 
> 时间：2012-04-17T18:19:04.507
> 
> 标签：php, explode

我希望将文本字符串拆分为由空格分隔的单词。我用

```
$words=explode(" ", $text); 
```

不幸的是，这种方法对我来说效果不佳，因为我想知道两者之间有多少空格。

有没有比逐个符号地遍历整个 $text，使用`while`语句用整数（空格数，在大多数情况下为 1）填充 $spaces ( `$spaces=array();`) 并将文本读入 $words=更好的方法array() 一个符号一个符号？

这是一个额外的解释。

```
$text="Hello_world_____123"; //symbol "_" actually means a space 
```

需要：

```
$words=("Hello","world","123");
$spaces=(1,5); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:21:49.650

改用正则表达式：

```
$words = preg_split('/\s+/', $text) 
```

**编辑**

```
$spaces = array();
$results = preg_split('/[^\s]+/', $text);
foreach ($results as $result) {
  if (strlen($result) > 0) {
     $spaces [] = strlen($result);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:36:37.827

有很多方法可以做你想做的事情，但我可能会选择[preg_split()](http://us3.php.net/manual/en/function.preg-split.php)和[array_map()](http://us3.php.net/manual/en/function.array-map.php)的组合：

```
$text = 'Hello world     123';
$words = preg_split('/\s+/', $text, NULL, PREG_SPLIT_NO_EMPTY);
$spaces = array_map(function ($sp) {
    return strlen($sp);
}, preg_split('/\S+/', $text, NULL, PREG_SPLIT_NO_EMPTY));

var_dump($words, $spaces); 
```

输出：

```
array(3) {
  [0]=>
  string(5) "Hello"
  [1]=>
  string(5) "world"
  [2]=>
  string(3) "123"
}
array(2) {
  [0]=>
  int(1)
  [1]=>
  int(5)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:22:39.480

您仍然可以像这样获得中间的空格数：

```
$words = explode(" ", $text);
$spaces = sizeof($words)-1; 
```

那不适合你吗？

# email - CakeMail 无法识别 to 和 viewvars 函数

> ID：10196759
> 
> 赞同：0
> 
> 时间：2012-04-17T18:19:12.707
> 
> 标签：email, cakephp-2.0

在我的用户控制器中，我添加了：

```
App::uses('CakeEmail', 'Network/Email');
class UsersController extends AppController { 
      function sign_up() {
        $this->autoRender = false;
        $email = new CakeEmail('default');

        $email->template('sign_up');
        $email->emailFormat('html');
        $email->subject('Addience.com Sign Up');
        $email->to($this->request->query['email']);
        $email->viewVars(array('password' => $this->Password->generatePassword(), 'email' => $this->request->query['email'], 'key' => $this->Password->generateKey()));
        $email->send();
        $this->redirect('/');
    }

} 
```

我的 email.php 配置文件如下所示：

```
class EmailConfig {

    public $default = array(
        'host' => 'ssl://smtp.gmail.com',
        'port' => 465,
        'username' => 'xxx@gmail.com',
        'password' => 'xxx',
        'from' => array('support@xxx.com' => 'xxx'),
        'transport' => 'Smtp'
    );
} 
```

但是，我仍然得到：

```
Notice (8): Undefined index: email [APP\Controller\UsersController.php, line 311]

Notice (8): Undefined index: email [APP\Controller\UsersController.php, line 312]
You need specify one destination on to, cc or bcc.

Error: An Internal Error Has Occurred.
Stack Trace

#0 C:\xampp\htdocs\addience\Controller\UsersController.php(314): CakeEmail->send()
#1 [internal function]: UsersController->sign_up()
#2 C:\xampp\htdocs\cakephp-2.0.6\lib\Cake\Controller\Controller.php(473): ReflectionMethod->invokeArgs(Object(UsersController), Array)
#3 C:\xampp\htdocs\cakephp-2.0.6\lib\Cake\Routing\Dispatcher.php(104): Controller->invokeAction(Object(CakeRequest))
#4 C:\xampp\htdocs\cakephp-2.0.6\lib\Cake\Routing\Dispatcher.php(86): Dispatcher->_invoke(Object(UsersController), Object(CakeRequest), Object(CakeResponse))
#5 C:\xampp\htdocs\addience\webroot\index.php(98): Dispatcher->dispatch(Object(CakeRequest), Object(CakeResponse))
#6 {main} 
```

为什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-31T11:25:48.250

传入单个变量或数组

```
$email->viewVars($variables); 
```

在您的电子邮件模板中打印此内容。那么您将能够看到所有变量:)

```
var_dump($this->viewVars); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:58:14.420

简单的，

```
$this->request->query['email'] 
```

是空的:)

还是非常感谢。

# c# - 将 jquery 添加到 Visual Studio 中的“空”Web 项目的最佳方法？

> ID：10196761
> 
> 赞同：9
> 
> 时间：2012-04-17T18:19:35.130
> 
> 标签：c#, jquery, asp.net, solution

嘿，所以当我开始一个新的解决方案并选择“Web 应用程序”时，Visual Studio 会继续，默认情况下会创建一个包含 jquery-1.4.1.js、jquery-1.4.1.min.js 和 jquery-1.4.1 的脚本文件夹-vsdoc.js。但是，如果我改为启动一个新解决方案并选择“空 Web 应用程序”，则显然没有预期的文件夹。我只是想知道将 jquery 添加到我的新项目中的最佳方法是什么，我应该从默认 Web 应用程序中复制并粘贴脚本文件夹吗？

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T18:22:11.247

使用 NuGet！它将把东西安装在正确的文件夹中，并为你跟踪东西。没有理由再自己做这件事了。

右键单击您的解决方案，选择管理包。搜索 jquery 并安装它。如果您还没有安装 Nuget 包管理器，您可能需要安装它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T18:22:09.053

使用 nuget 包 [http://nuget.org/packages/jquery](http://nuget.org/packages/jquery)

命令是“安装包 jQuery”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T18:23:52.930

或者，您可以在每次在项目中使用时收集所需文件并将这些文件粘贴到空项目中......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T18:27:04.190

您可以只创建一个文件夹调用脚本并将 jquery 库拖到该文件夹​​中（或使用添加现有项）。新版本的 Jquery 库可在[http://docs.jquery.com/Downloading_jQuery下载](http://docs.jquery.com/Downloading_jQuery)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T18:39:09.700

或者让[别人的CDN](http://docs.jquery.com/Downloading_jQuery)为你做......

有关原因的更详细解释，请参阅：[http ://encosia.com/3-reasons-why-you-should-let-google-host-jquery-for-you/](http://encosia.com/3-reasons-why-you-should-let-google-host-jquery-for-you/)

[http://docs.jquery.com/Downloading_jQuery](http://docs.jquery.com/Downloading_jQuery)

# html - HTML/CSS 输入按钮样式不起作用

> ID：10196763
> 
> 赞同：6
> 
> 时间：2012-04-17T18:19:43.783
> 
> 标签：html, css, button

我有一个按钮：

![在此处输入图像描述](../Images/6856ebea6a6ff9329eaac6dfc58c2b8a.png) 上

![在此处输入图像描述](../Images/abfc77ec9e030acbc102b40c9efe6a5d.png) 离开

这是CSS：

```
.searchButton {
  height: 31px;
  width: 33px;
  cursor: pointer;
  border: none;
  background:url(../img/searchButton-Off.png) no-repeat;
}

.searchButton:hover {
  height: 31px;
  width: 33px;
  cursor: pointer;
  border: none;
  background:url(../img/searchButton-On.png) no-repeat;
} 
```

这是HTML：

```
 <div class="searchBox">
    <h2 style="color:000000;">Search</h2>
    <form id="form_297586" class="appnitro"  method="get" action="results.php">
      <input id="keywords" name="keywords" class="searchBar" title="What do you like...?" type="text" maxlength="255" value=""/>
      <input type="button" class="searchButton" />
      <input type="hidden" name="form_id" value="297586" />
    </form>
  </div> 
```

这是我的浏览器正在呈现的内容：

![在此处输入图像描述](../Images/f4f29ccc4bb513d0bd30f7d5fb7a3a2e.png) 野生动物园 ![在此处输入图像描述](../Images/79f673d559f3475b4ee7d9c03758e77e.png) 歌剧

当我将鼠标悬停在按钮上时，它会正确切换，然后会显示整个按钮。我不确定为什么会发生这种行为。

想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T18:33:06.067

按钮有很多附加的默认样式。考虑实现一个重置样式表，例如：

[埃里克迈耶的重置](http://meyerweb.com/eric/tools/css/reset/)

[规范化.css](http://necolas.github.com/normalize.css/)

此外，必须将元素设置为`display: block`或显示：`inline-block`才能在其上设置尺寸。

最后，我建议您将问题的简化示例放入[JSFiddle](http://jsfiddle.net/)或[Dabblet](http://dabblet.com)，以便人们更容易帮助您。

希望这可以帮助！

**编辑：**现在我可以看到您的示例，问题是 bootstrap.css 中的默认样式比您的样式具有更高的特异性。就像是：

```
input.searchButton 
```

应该解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T18:32:55.357

这可能是一种特殊情况，其中一组更具体的条件优先。

尝试这个：

```
.searchButton { 
  height: 31px !important; 
  width: 33px !important; 
  cursor: pointer; 
  border: none; 
  background:url(../img/searchButton-Off.png) no-repeat; 
} 
```

或者你可以试试：

```
form.appnitro .searchButton { 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-22T22:09:35.763

错误的！

你有

你也有使用：

```
input[type=button].[class name] 
```

或者您可以使用：

```
<button class='x' ></button> 
```

和CSS：

```
button.x{
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T18:25:09.540

背景：url（“../img/searchButton-Off.png”）白色无重复9px；

只需将 9px 更改为任何 px 并相应地进行操作并增加 height:50px weight:50px

# c++ - C++：在“for each”循环中从映射中删除值

> ID：10196766
> 
> 赞同：0
> 
> 时间：2012-04-17T18:19:45.483
> 
> 标签：c++, stl, map, foreach, function-pointers

对于 a`std::vector<double*> v;`我可以`double`通过调用删除 s

```
std::for_each(v.begin(), v.end(), (void(*)(void* a))operator delete); 
```

现在，如果我有`std::map<int, double*> m;`，我可以在不使用显式循环、boost 或非标准 STL 扩展的情况下做类似的事情吗？`???`即里面有什么

```
std::for_each(m.begin(), m.end(), ???); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-17T18:30:28.280

不要打扰。`std::map<int, std::unique_ptr<double>>`. 不再需要`delete`手动，您只需`clear()`地图即可。智能指针 >*每次*显式删除。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-17T18:27:49.650

如果您使用的是 C++11，则可以使用基于范围的 for。

```
for(auto& pair : m) delete pair.second; 
```

如果您使用的是 C++11 之前的标准，则可以使用仿函数：

```
struct delete_second {
  void operator()(std::pair<int, double*> p) { delete p.second; }
};

...

  std::for_each(m.begin(), m.end(), delete_second()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-17T18:28:02.473

使用 C+11，您可以： `std::for_each(m.begin(), m.end(), [](std::pair<int,double*> p) { delete p.second; });`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T13:20:19.047

删除 p.second 而不从地图中删除条目有什么用？

# windows - Windows 中的 PAM“会话所需模块”等效项

> ID：10196769
> 
> 赞同：2
> 
> 时间：2012-04-17T18:20:21.353
> 
> 标签：windows, windows-7, pam

我有这个漂亮的 PAM 模块，它可以验证每个会话（如桌面会话）的身份验证，并根据某些标准允许或阻止它。我想在 Windows 7 上做同样的事情。

现在，这可能听起来很愚蠢或微不足道，但我真的不知道我在 Windows 系统上的方式，因此想要一些关于如何实现类似功能的指针（即在例如时查询的服务或模块用户尝试启动会话。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T02:27:37.747

我认为您正在寻找的是[Subauthentication Package ，但您可以通过](http://msdn.microsoft.com/en-us/library/windows/desktop/aa380504%28v=vs.85%29.aspx)[Credential Provider](http://msdn.microsoft.com/en-us/magazine/cc163489.aspx)获得一些里程。

子身份验证包是一个动态链接的库，本地安全机构或 Kerberos 密钥分发中心 (KDC) 将在身份验证成功后但在授予用户访问权限之前调用它。

Windows 将在本地或通过 Kerberos 对用户进行身份验证，具体取决于您的配置。您必须构建一个导出两个函数的 DLL：

*   [`Msv1_0SubAuthenticationRoutine`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa378752%28v=vs.85%29.aspx)（不要求交互式登录或 Kerberos）
*   [`Msv1_0SubAuthenticationFilter`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa378751%28v=vs.85%29.aspx)

您将代码放入该 DLL 中，如果允许用户登录，则返回 STATUS_SUCCESS 或其他错误代码之一。您不能假设您可以访问密码。

如果您通过 Kerberos 登录，您必须在 KDC 上注册您的 DLL。这使得很难针对某些本地信息（例如硬件或生物识别设备）进行身份验证。

所以也许凭证提供者可以帮助你，但这不是最优雅的解决方案。它旨在捕获凭据并将其提供给身份验证包。但是 Microsoft 让 shure 凭据提供程序不会锁定用户，因此它可能并不总是被调用（在安全模式下）并且用户可以安装另一个 CP 等。所以为了完整起见，我提到它。

# facebook - Atk4 Step by Step 表单不加载 Facebook Like 按钮

> ID：10196773
> 
> 赞同：0
> 
> 时间：2012-04-17T18:20:26.510
> 
> 标签：facebook, frameworks, atk4

[我有一个包含站点列表的数组，我正在使用http://codepad.agiletoolkit.org/newsletter](http://codepad.agiletoolkit.org/newsletter)示例逐步编写表单。

在第二步中，我使用以下代码放置了 Like Buttons：

```
    $attr = 数组 (
      '数据发送' => FALSE，
      '数据布局' => 'button_count',
      '数据宽度' => 100,
      'data-show-faces' => FALSE  
    );
    foreach($this->sites as $k => $site) {
      $div = $form->add('View_HtmlElement')->setElement('div')->set(NULL);  
      $attr['data-href'] = $site;  
      $div->addClass('fb-like');
      $div->setAttr($attr);
    }

```

这在我直接访问时效果很好，但是当我尝试通过下一个按钮访问时，Like 按钮不会加载。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:54:19.663

facebook 和其他一些按钮可能不适用于 AJAX 页面的原因是因为 facebook 脚本通常仅在页面初始加载期间处理您的 HTML。当您的示例中的表单进入下一步时，它使用 AJAX 加载其他表单。因此，您将需要手动触发 facebook 的脚本来重新浏览您的页面或执行重定向而不是重新加载。你需要改变：

```
$this->js()->atk4_load($this->api->getDestinationURL('./step2'))
    ->execute(); 
```

至

```
$this->js()->univ()->location($this->api->getDestinationURL('./step2'))
    ->execute(); 
```

您可能还会发现这篇文章很有用： http: [//agiletoolkit.org/blog/adding-twitter-button-to-ajax-page/](http://agiletoolkit.org/blog/adding-twitter-button-to-ajax-page/)

# php - 测量 php 性能

> ID：10196777
> 
> 赞同：2
> 
> 时间：2012-04-17T18:20:44.663
> 
> 标签：php, performance, apache

我正在尝试追踪应用程序 [modx] 的问题 我的服务器上有几个这样的站点 [大约 10 个] 并且想知道我如何才能看到 php 正在做什么。

这些站点上的页面非常慢，而 dev 中的相同站点与服务器上的其他 php 应用程序一样好。

我尝试使用 xdebug 来了解 php 在处理这些页面时正在做什么以及发生瓶颈的位置，但它似乎只想对错误执行任何操作 [没有抛出错误]

有关如何追踪此问题的任何建议？[linux/Centos5/php5.2.?/apache2]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:31:03.943

Xdebug 和 webgrind 是查看瓶颈所在位置的好方法...

阅读[XDEBUG_PROFILE](http://xdebug.org/docs/profiler)和[Webgrind](http://code.google.com/p/webgrind/)

设置 php.ini 以在每次运行时对您的代码进行 xdebug 配置文件，或者如果传递了特殊参数，则设置 webgrind 以从 xdebug 将其配置文件转储写入的同一目录中读取。

Webgrind 将向您展示哪些函数和函数集最需要时间，它会将其分解并便于查找缓慢和/或低效的代码。（例如，您的脚本在快速查询中调用“PDOStatement->execute”300 次 [或者调用一次，然后非常慢] 占用了 90% 的执行时间）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:35:20.917

用于查找 PHP 瓶颈的最常用工具是[Xdebug](http://xdebug.org/)。但是您还应该手动检查代码库。

您必须关注三个不同的领域：

*   前端性能
*   SQL 查询
*   php逻辑本身

.. 对感知速度的影响按此顺序排列。

您应该从运行[ySlow](http://developer.yahoo.com/yslow/)开始，并确保您的站点尽可能地遵循指南。

下一步将跟踪执行了哪些 SQL 查询，并且（假设您使用的是 mysql）尝试使用[`EXPLAIN`](http://dev.mysql.com/doc/refman/5.5/en/explain.html). 另外，检查查询本身。那里可能有一些非常愚蠢的代码，比如在巨大的表格中`ORDER BY RAND()`使用。`LIKE`

最后一个阶段将修复这一切将仔细查看代码本身。在 PHP 和 JavaScript 方面。

此外，您应该**升级到 PHP 5.3**，因为您的版本非常过时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T18:39:19.687

通常当您不知道自己在寻找什么时，您无法使用 xdebug 或其他 CMS/Framework 中内置的插件/调试栏等工具来发现它，new relic 是最简单的解决方案 - 您将能够发现瓶颈几分钟后。

虽然 new relic 是一款付费应用，但您可以在前 14 天免费测试 - 发现问题绰绰有余。

这很棒，因为它集成了您通常使用的所有其他工具和数据源：xdebug、cpu 和 i/o 监控、mysql 慢日志、查询日志。它还会显示您的应用程序在 php/DB/frontend/network 上是否运行缓慢。

您应该尝试一下，而不是浪费时间使用其他工具进行调试。

这是centos安装指南：[https ://newrelic.com/docs/php/php-agent-installation-redhat-and-centos](https://newrelic.com/docs/php/php-agent-installation-redhat-and-centos)

# javascript - JavaScript 是否对函数参数有定义的求值顺序？

> ID：10196778
> 
> 赞同：2
> 
> 时间：2012-04-17T18:20:44.957
> 
> 标签：javascript

> **可能重复：**
> [Javascript中函数参数的评估顺序是什么？](https://stackoverflow.com/questions/8405989/what-is-the-order-of-evaluation-for-function-arguments-in-javascript)

如果我在 Chrome 中运行以下代码，匿名函数的参数将从左到右评估：

```
(function () {})(console.log(1), console.log(2)); 
```

这是在规范中定义的还是实现定义的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:26:44.183

是的，它是 ECMAScript 5 文档的一部分：

> 让名称是一个列表，其中包含与 FormalParameterList 的标识符相对应的字符串，按从左到右的文本顺序。如果未指定参数，则让 names 为空列表。

资料来源： http: [//www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)（第 99 页）

# ios - HTTPS 请求无法验证 iOS Safari 上的证书

> ID：10196783
> 
> 赞同：2
> 
> 时间：2012-04-17T18:21:05.327
> 
> 标签：ios, https, mobile-safari, ssl-certificate

我没有在我的域上配置 HTTPS，所以我不确定从哪里开始这个警告提示，我只在我的 iPhone 和 iPad 上的 iOS Safari 上。我从来没有在带有 Mac Safari、Chrome、FF 或 IE 的桌面上得到这个。

有人可以将我指向我的 ubuntu/apache EC2 服务器或我的域提供商 GoDaddy 网站上的某个文件，该文件处理验证证书。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T18:45:07.783

对于 Nginx 上的用户，您需要将 gd_bundle.crt 文件附加到您的其他 .crt 证书。只需`cat gd_bundle.crt >> yourwebsite.crt`重新启动 Nginx。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T23:36:55.600

蒂姆，

如果台式机上的浏览器在没有警告的情况下显示 SSL，而您收到的警告是在移动设备上，则问题很可能与颁发 SSL 的证书颁发机构的中间证书未正确安装有关。我建议您联系证书颁发者寻求帮助，而不是联系主机或域名注册商。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T02:22:46.577

我找到了解决我问题[的链接。](http://blog.serverdensity.com/2009/05/11/godaddy-ssl-certificates-and-cannot-verify-identity-on-macsafari/)

我需要将GoDaddy 中的**两个**.crt 文件放入我的 apache EC2 服务器上的 /etc/apache2/ssl 文件夹中，并将以下内容添加到我的 /etc/apache2/httpd.conf 文件中：

```
SSLCertificateFile /etc/apache2/ssl/mysite.com.crt
SSLCertificateChainFile /etc/apache2/ssl/gd_bundle.crt 
```

# java - jpa 无法执行简单的查询

> ID：10196787
> 
> 赞同：1
> 
> 时间：2012-04-17T18:21:13.087
> 
> 标签：java, jpa, db2, openjpa

当我尝试使用实体管理器执行查询时，我必须在所有配置和映射之后使用 jpa 从 db2 中的表中检索数据，但
出现错误，不知道问题到底出在哪里。消息错误：`Error 500: <openjpa-2.1.1-SNAPSHOT-r422266:1141200 fatal general error> org.apache.openjpa.persistence.PersistenceException: DB2 SQL Error: SQLCODE=-204, SQLSTATE=42704, SQLERRMC=DB2ADMIN.CATEGORIE, DRIVER=4.8.86 {prepstmnt 85179437 SELECT t0.CODE_CAT, t0.LIBELLE_CAT FROM CATEGORIE t0 } [code=-204, state=42704]SQLCA OUTPUT[Errp=SQLNQ1FC, Errd=-2145779603, 0, 0, 0, -10, 0] DB2 SQL Error: SQLCODE=-204, SQLSTATE=42704, SQLERRMC=DB2ADMIN.CATEGORIE, DRIVER=4.8.86 DB2 SQL Error: SQLCODE=-727, SQLSTATE=56098, SQLERRMC=2;-204;42704;DB2ADMIN.CATEGORIE, DRIVER=4.8.86 DB2 SQL Error: SQLCODE=-727, SQLSTATE=56098, SQLERRMC=2;-204;42704;DB2ADMIN.CATEGORIE, DRIVER=4.8.86 FailedObject: select c from Categorie c [java.lang.String]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-19T14:58:52.503

我遇到了同样的问题，我通过在我的实体中添加 Schema 来解决它：

```
@Entity
@Table(name="MyTable", schema="MySchemaName")
public class MyClass implements Serializable {
...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T19:43:04.747

在[SQLSTATE 消息页面](http://publib.boulder.ibm.com/infocenter/db2luw/v9r7/topic/com.ibm.db2.luw.messages.doc/doc/rdb2stt.html)中，第一个错误（SQLCODE= `-204`、SQLSTATE= `42704`）是“检测到未定义的对象或约束名称”。第二个错误（SQLCODE= `-727`、SQLSTATE= `56098`）是“在隐式重新绑定、重新编译或重新验证期间发生错误。”，这可能源于`-204`.

`-204`通常意味着要么表名拼写错误，要么由于某种原因找不到表。我没有看到那里生成的 SQL 架构 ( `SELECT t0.CODE_CAT, t0.LIBELLE_CAT FROM CATEGORIE t0`)，所以也许您需要添加它。

# android - 更新位置和屏幕外的位置

> ID：10196789
> 
> 赞同：0
> 
> 时间：2012-04-17T18:21:15.600
> 
> 标签：android, eclipse, opengl-es

我想展示汽车在道路上的运动。我有一个包含位置的文本文件，我通过每秒更新汽车的位置来构建运动。可以说平原是 (200,200) 。现在我应该为这个屏幕之外的位置做什么？我怎么能跟着我的车去那里？我应该设置一个相机还是什么？顺便说一句，我的应用是 2D 的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:33:48.663

根据我的经验，在 2D 编程中没有设置相机的实际概念，但我可能是错的。你必须自己做这个，创建一个相机类等等......

我认为最终会发生的是，汽车将保持在屏幕的中心，而它下面的所有东西都会移动。取决于您要达到的目标。

因此，如果您的汽车以 20 公里/小时的速度向东北移动，请不要真正移动汽车，让汽车下方的所有东西以 20 公里/小时的速度向西南移动（或每帧多少像素）

这是如果您想跟随汽车。如果您想在汽车越界时将“相机”居中，您可能必须将景观和汽车移向屏幕中心。

编辑：我假设汽车将成为主要焦点？所以它应该始终位于屏幕的中心。

游戏中的所有对象都应该有 a`velocity`和 a `position`。`position`告诉你对象当前在哪里，告诉`velocity`你每帧应该移动多少 x 和多少 y。所以你会说每一帧`position = position + velocity`。

非汽车对象可以根据需要从屏幕上移出，而无需相机跟随它们，因此请放开它们。保持汽车居中并根据汽车的速度调整所有其他物体的速度。

前任：

`Car's velocity (3, 0) ---> means it's moving right in the straight line at 3 pixels per frame`

`Object 1 velocity (4, 0) ---> means it's also moving right in a straight line but 4 pixels per frame`

对象 1 的速度必须根据汽车的速度自行调整。所以说：

`object1.position = object1.position + (object1.velocity - car.velocity)`

对象 1 的新速度为 (1, 0)，因此它的移动速度比汽车快 1。

如果汽车加速到假设 (5, 0)，那么对象一似乎向后移动了 1。

# metadata - Tridion 2009 - 检索组件的父文件夹 TCM

> ID：10196792
> 
> 赞同：5
> 
> 时间：2012-04-17T18:21:22.010
> 
> 标签：metadata, directory, parent, tridion

快速提问。我正在构建一个模板构建块 (TBB)，它从组件的父文件夹中检索元数据模式值。例如，此文件夹中列出的所有组件将共享相同的标题，但具有不同的内容。因此，我创建了一个模式并将其附加到父文件夹。这样，如果我想更改所有组件的标题，我所要做的就是更改文件夹上的元数据值。

我有这个使用硬编码的父文件夹 TCM，但是，我需要动态地获取它。有谁知道如何获取父文件夹的 TCM？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T18:43:33.430

RepositoryLocalObjects 都有一个“.OrganizationalItem”属性，它将返回对象的容器。

这些方面的东西应该让你开始：

```
Component component = (Component)engine.GetObject(package.GetByName(Package.ComponentName));
Folder parent = (Folder)component.OrganizationalItem;
ItemFields folderFields = new ItemFields(parent.Metadata, parent.MetadataSchema); 
```

# java - Java中的图表绘制

> ID：10196798
> 
> 赞同：0
> 
> 时间：2012-04-17T18:21:53.080
> 
> 标签：java

我使用 Java 绘制图表，但我不使用 JChart2D 之类的东西。我打开 wolframalpha 并绘制一个图，例如： plot[100*(x^2)] 然后当你将光标放在一个图上时，你会看到两条交叉线，可帮助您指定点。我可以在 jPanel 中使用 Java 制作这样的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T19:51:02.757

如果您想自己做所有事情，您需要在您绘制的 JPanel 中添加一个 MouseMotionListener，分析鼠标位置，在图表上找到离鼠标位置最近的点，然后更新图表以包含这些线条。一遍又一遍，每次鼠标移动并调用 MouseMotionListener 时。所以可以做到，但工作量很大。

# python - 使用 shutil 复制/移动在 Windows 服务器之间传输文件

> ID：10196803
> 
> 赞同：3
> 
> 时间：2012-04-17T18:22:08.670
> 
> 标签：python, windows

我正在使用 shutil.copy() 将文件从一台服务器传输到网络上的另一台服务器，都是 Windows。

我已经使用 shutil 和 os 模块来完成许多自动化任务，但仅限于本地机器。是否有更好的方法将文件（我的意思是在性能方面）从一台服务器传输到另一台服务器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:23:59.980

是：使用 FTP，或者在 Python 中使用[ftplib](http://docs.python.org/library/ftplib.html)。

ETA：如果需要安全文件传输协议，[paramiko](http://www.lag.net/paramiko/)是一个很棒的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:37:42.370

*用于许多自动化任务，但仅限于本地机器*使用**结构**

# php - PHP和MySQL，这个函数有什么问题？

> ID：10196806
> 
> 赞同：2
> 
> 时间：2012-04-17T18:22:11.647
> 
> 标签：php, mysql

这个函数不起作用，我找不到问题，这是在查询中的某个地方。

```
function get_category_posts($category, $page, $per_page) {
$start = (int)($page - 1) * $per_page;
$per_page = (int)$per_page;

$sql = "SELECT
    `posts`.`post_id` AS `id`,
    `posts`.`post_title` AS `title`,
    `posts`.`post_category` AS `category`,
    `posts`.`post_body` AS `preview`,
    `posts`.`post_user` AS `user`,
    DATE_FORMAT(`posts`.`post_date`, '%Y-%m-%d %H:%i:%s') AS `date`,
    `comments`.`total_comments`,
    DATE_FORMAT(`comments`.`last_comment`, '%Y-%m-%d %H:%i:%s') AS `last_comment`
FROM `posts`
WHERE `category`='".$category."'
LEFT JOIN (
    SELECT
        `post_id`,
        COUNT(`comment_id`) AS `total_comments`,
        MAX(`comment_date`) AS `last_comment`
    FROM `comments`
    GROUP BY `post_id`
) AS `comments`
ON `posts`.`post_id` = `comments`.`post_id`
ORDER BY `posts`.`post_date` DESC
LIMIT {$start}, {$per_page}";

$posts = mysql_query($sql);
//die(mysql_error());

$rows = array();
while (($row = mysql_fetch_assoc($posts)) !== false) {
    $rows[] = array(
        'id' => $row['id'],
        'title' => html_entity_decode($row['title']),
        'category' => html_entity_decode($row['category']),
        'preview' => html_entity_decode($row['preview']),
        'user' => html_entity_decode($row['user']),
        'date' => $row['date'],
        'total_comments' => ($row['total_comments'] === null) ? 0 : $row['total_comments'],
        'last_comment' => ($row['last_comment'] === null) ? 'aldrig' : $row['last_comment']
        );
}

return $rows; 
```

该函数在没有`WHERE`category的情况下工作正常`='".$category."'`，但是，它返回

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 12 行的“LEFT JOIN (SELECT `post_id`, COUNT( `comment_id`) AS `total_comments`,”附近使用正确的语法

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T18:25:08.607

WHERE 子句必须在表连接之后和 ORDER BY 和 LIMIT 之前

```
SELECT <column list>
FROM <table>
JOIN <table> USING (<column>)
WHERE <condition>
OR <condition>
AND <condition>
GROUP BY <column list>
HAVING <expression> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:27:58.947

JOIN 必须在 WHERE 条件之前

```
$sql = "SELECT
    `posts`.`post_id` AS `id`,
    `posts`.`post_title` AS `title`,
    `posts`.`post_category` AS `category`,
    `posts`.`post_body` AS `preview`,
    `posts`.`post_user` AS `user`,
    DATE_FORMAT(`posts`.`post_date`, '%Y-%m-%d %H:%i:%s') AS `date`,
    `comments`.`total_comments`,
    DATE_FORMAT(`comments`.`last_comment`, '%Y-%m-%d %H:%i:%s') AS `last_comment`
FROM `posts`
LEFT JOIN (
    SELECT
        `post_id`,
        COUNT(`comment_id`) AS `total_comments`,
        MAX(`comment_date`) AS `last_comment`
    FROM `comments`
    GROUP BY `post_id`
) AS `comments`
ON `posts`.`post_id` = `comments`.`post_id`
WHERE `posts`.`category`='".$category."'
ORDER BY `posts`.`post_date` DESC
LIMIT {$start}, {$per_page}"; 
```

# sql - 多次使用一个 CTE

> ID：10196808
> 
> 赞同：72
> 
> 时间：2012-04-17T18:22:15.357
> 
> 标签：sql, sql-server, sql-server-2008, common-table-expression

我有这个，我在设定的总数中得到一个错误。为什么我不能多次访问 cte？

```
ALTER PROCEDURE [dbo].[GetLeaguePlayers]
(
    @idleague int,
    @pageNumber int,
    @pageSize int,
    @total int OUTPUT
)
AS
WITH CTEPlayers AS
(
    SELECT ROW_NUMBER() OVER (ORDER BY p.Name) AS RowNumber, p.Id, p.Name, t.Name AS Team
    FROM Players p INNER JOIN Teams t ON p.IdTeam=t.Id INNER JOIN Leagues l ON l.Id=t.IdLeague
    WHERE l.Id=@idleague
)
SELECT Id, Name
FROM CTEPlayers c
WHERE RowNumber>@pageSize*(@pageNumber-1) AND RowNumber<@pageSize*@pageNumber;
SET @total = ( SELECT COUNT(*) FROM CTEPlayers ) 
```

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-04-17T18:26:22.577

A`CTE`基本上是一次性的视图。它只持续一个语句，然后自动消失。

您的选择包括：

*   第二次重新定义`CTE`。这就像从`WITH...`定义末尾复制粘贴到您的`SET`.

*   将结果放入`#temp`表格或`@table`变量中

*   将结果具体化为真实表格并参考

*   稍微改变一下`SELECT COUNT`你的 CTE：

.

```
SELECT @total = COUNT(*)
FROM Players p 
INNER JOIN Teams t 
    ON p.IdTeam=t.Id 
INNER JOIN Leagues l 
    ON l.Id=t.IdLeague
WHERE l.Id=@idleague 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-12-07T20:40:13.837

以上答案均不正确...您可以执行一次CTE并达到您想要的结果..这是查询

```
ALTER PROCEDURE [dbo].[GetLeaguePlayers]
(
    @idleague int,
    @pageNumber int,
    @pageSize int,
    @total int OUTPUT
)
AS
WITH CTEPlayers AS
(
    SELECT p.Id, p.Name, t.Name AS Team
    FROM Players p INNER JOIN Teams t ON p.IdTeam=t.Id INNER JOIN Leagues l ON l.Id=t.IdLeague
    WHERE l.Id=@idleague
),
TotalCount AS
(
 SELECT COUNT(*) AS Total FROM CTEPlayers
),
Final_Result AS
(
 SELECT ROW_NUMBER() OVER (ORDER BY p.Name) AS RowNumber, p.Id, p.Name, t.Name AS Team,
  (SELECT Total FROM TotalCount) AS Total
    FROM CTEPlayers
)
SELECT Id, Name, @total = Total
FROM Final_Results c
WHERE RowNumber>@pageSize*(@pageNumber-1) AND RowNumber<@pageSize*@pageNumber; 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-04-17T18:25:18.153

根据定义，CTE 仅对一个语句有效。

您可以创建一个[内联表值函数](http://msdn.microsoft.com/en-us/library/ms189294.aspx)，然后随意使用它。内联函数的功能正如其名称所暗示的那样；它的查询成为使用它的查询的一部分（与单独执行并用作行集的非内联函数相反）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-11-16T06:16:40.460

多次使用 CTE 收集数据

```
;with CTEReminder AS
(
    Select r.ReminderID,r.IsVerificationRequired from ReminderTbl r      -- main table
),
FileTaskCountTempTbl   as     
    (
        select  COUNT(t.ReminderID) as FileTaskCount                     -- getting first result
            from TaskTbl t
                left join CTEReminder r on t.ReminderID = r.ReminderID          
    ),
FollowUpCountTempTbl  as
    (
        select COUNT(f.FollowUpID)  as Total                             -- getting second result
            from FollowUpTbl f              --cte not used here
    ),
MachineryRegularTaskCountTempTbl as
    (
        select  COUNT(t.ReminderID) as TotalCount                        -- getting third result
                from TaskTbl t
                    left join CTEReminder r on t.ReminderID = r.ReminderID                  
    ),
FinalResultTempTbl as
    (
        select COUNT(t.ReminderID)  as MachineryTaskCount,               -- getting fourth result
                (select * from MachineryRegularTaskCountTempTbl ) as MachineryRegularTaskCount,  -- Combining earlier results to last query 
                (select * from FollowUpCountTempTbl ) as FollowUpCount,   -- Combining earlier results to last query 
                (select * from FileTaskCountTempTbl ) as FileTaskCount   -- Combining earlier results to last query 
            from TaskTbl t
                left join CTEReminder r on t.ReminderID = r.ReminderID          
    )

select * from FinalResultTempTbl 
```

[![在此处输入图像描述](../Images/7e7609fbd54106037aee0e028fc4c3be.png)](https://i.stack.imgur.com/TS1gM.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-27T12:11:04.003

在这种情况下，我使用这个：

```
ALTER PROCEDURE [dbo].[GetLeaguePlayers]
(
 @idleague int,
 @pageNumber int,
 @pageSize int,
 @total int OUTPUT
)
AS

WITH CTEPlayers AS
(
    SELECT ROW_NUMBER() OVER (ORDER BY p.Name) AS RowNumber,    
        COUNT(1) OVER () AS RecordCount,
    p.Id, p.Name,   
    t.Name AS Team
    FROM Players p 
        INNER JOIN Teams t ON p.IdTeam=t.Id 
        INNER JOIN Leagues l ON l.Id=t.IdLeague
    WHERE l.Id=@idleague
)

SELECT RowNumber,
    CAST(CEILING(CAST(RecordCount AS FLOAT) / CAST(@pageSize AS FLOAT)) AS INT) PageCount,
    RecordCount,
    Id, 
    Name
FROM CTEPlayers c
WHERE RowNumber > @pageSize*(@pageNumber-1) AND RowNumber < @pageSize*@pageNumber; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-23T12:48:12.283

将输出与总数一起存储在临时表中；设置输出变量值并从临时表中返回所需的列

```
ALTER PROCEDURE [dbo].[GetLeaguePlayers]
(
    @idleague int,
    @pageNumber int,
    @pageSize int,
    @total int OUTPUT
)
AS
WITH CTEPlayers AS
(
    SELECT ROW_NUMBER() OVER (ORDER BY p.Name) AS RowNumber, p.Id, p.Name, t.Name AS Team
    FROM Players p INNER JOIN Teams t ON p.IdTeam=t.Id INNER JOIN Leagues l ON l.Id=t.IdLeague
    WHERE l.Id=@idleague
),
TotalCounter(TotalRecords) as
(select count(1) from CTEPlayers)

SELECT Id, Name, TotalRecords(select TotalRecords from TotalCounter) into #tmp
FROM CTEPlayers c
WHERE RowNumber>@pageSize*(@pageNumber-1) AND RowNumber<@pageSize*@pageNumber;

SET @total = ( SELECT TotalRecords FROM #tmp)

select Id, Name from $tmp

drop table #tmp 
```

# java - SecondaryLoop而不是SwingWorker？

> ID：10196809
> 
> 赞同：7
> 
> 时间：2012-04-17T18:22:15.330
> 
> 标签：java, swing, java-7, swingworker, secondaryloop

从[SecondaryLoop](http://docs.oracle.com/javase/7/docs/api/java/awt/SecondaryLoop.html)的文档来看，尚不清楚何时应该使用此新功能而不是[SwingWorker](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html)，一些有趣的案例示例会很有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T19:29:54.910

SecondaryLoop 的意图与 SwingWorker 基本相同。但是，使用 SecondaryLoop 可能比将多个 SwingWorker 链接在一起更简单。

查看[Hidden Java 7 Features – SecondaryLoop](https://web.archive.org/web/20151104044220/http://sellmic.com/blog/2012/02/29/hidden-java-7-features-secondaryloop/)以获得详细的解释和示例。

# java - '清理' JTextField 输入的更清洁方法？

> ID：10196810
> 
> 赞同：0
> 
> 时间：2012-04-17T18:22:20.853
> 
> 标签：java, swing, jtextfield, formatted-input

因此，我正在为 JTextField 编写 TextValueChanged 处理程序，该处理程序需要很长时间才能输入。它只需要允许用户输入介于 0 和 Long.MAX 之间的有效值。如果用户键入了一个无效字符，它应该去掉它，以便 JTextField 中的值始终是一个有效的长整数。

我当前的代码看起来像这样，但看起来很难看。没有外部库（包括 Apache Commons），是否有更清洁/更简单的方法来做到这一点？

```
public void textValueChanged(TextEvent e) {
    if (e.getSource() instanceof JTextField) {
        String text = ((JTextField) e.getSource()).getText();
        try {
            // Try to parse cleanly
            long longNum = Long.parseLong(text);
            // Check for < 1 
            if (longNum < 1) throw new NumberFormatException();
            // If we pass, set the value and return
            setOption("FIELDKEY", longNum);
        } catch (NumberFormatException e1) {
            // We failed, so there's either a non-numeric or it's too large.
            String s = ((JTextField) e.getSource()).getText();
            // Strip non-numeric characters
            s = s.replaceAll("[^\\d]", "");
            long longNum = -1;
            if (s.length() != 0) {
                /* Really ugly workaround for the fact that a
                 * TextValueChanged event can capture more than one
                 * keystroke at a time, if it's typed fast enough,
                 * so we might have to strip more than one
                 * character. */
                Exception e3;
                do {
                    e3 = null;
                    try {
                        // Try and parse again
                        longNum = Long.parseLong(s);
                    } catch (NumberFormatException e2) {
                        // We failed, so it's too large.
                        e3 = e2;
                        // Strip the last character and try again.
                        s = s.substring(0, s.length() - 1);
                    }
                    // Repeat
                } while (e3 != null);
            }
            // We parsed, so add it (or blank it if it's < 1) and return.
            setOption("FIELDKEY", (longNum < 1 ? 0 : longNum));
        }
    }
} 
```

该字段不断地从 getOption(key) 调用中重新填充，因此要“存储”该值，只需将其传递给该调用即可。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T18:54:25.993

[DocumentFilter](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/text/DocumentFilter.html)是适合您的情况的一个很好的解决方案。

John Zukowski 的[Java Swing 权威指南在第 542-546 页上有一个很好的例子，展示了一个用于限制整数范围的自定义文档过滤器。](https://rads.stackoverflow.com/amzn/click/com/1590594479)

提供自定义 DocumentFilter 应该很容易满足在复制/粘贴时剥离不需要的字符的要求，正如您在其中一个评论中指定的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T19:53:56.263

还要考虑[`InputVerifier`](http://docs.oracle.com/javase/7/docs/api/javax/swing/InputVerifier.html)，在[*如何使用焦点子系统：验证输入*](http://docs.oracle.com/javase/tutorial/uiswing/misc/focus.html#inputVerification)中讨论过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:29:32.597

我有这个你可以长期使用的浮动

```
class DoubleTextDocument extends PlainDocument {
    public void insertString(int offs, String str, AttributeSet a)
            throws BadLocationException {
        if (str == null)
            return;
        String oldString = getText(0, getLength());
        String newString = oldString.substring(0, offs) + str
                + oldString.substring(offs);
        try {
            Float.parseFloat(newString + "0");
            super.insertString(offs, str, a);
        } catch (NumberFormatException e) {
        }
    }
} 
```

在您的扩展中`JTextField`，您可以使用

`@Override`

```
protected Document createDefaultModel() {
    return new DoubleTextDocument();
} 
```

# c# - Directory.Exists 不适用于网络路径

> ID：10196811
> 
> 赞同：33
> 
> 时间：2012-04-17T18:22:22.017
> 
> 标签：c#, asp.net, directory

我有一行代码检查目录是否存在，然后获取其中的文件列表。

```
System.IO.Directory.Exists(@"\\Server\Folder\"); 
```

我在测试它时工作（从 Visual Studio 运行），但是当我部署网站时，它总是返回 false。

我在另一台服务器（假设是 Server2）上对另一个文件夹进行相同的验证，它工作正常。

然后我认为这是一个访问问题，但是共享文件夹和网络对所有人都具有访问权限......还有其他原因导致它无法正常工作吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-17T18:30:12.660

当您在 Visual Studio 中运行代码时，它会在您的用户权限下运行。

当您在 IIS 中运行代码时，它以应用程序池的身份运行，默认情况下是内置用户“网络服务”，这是一个本地用户帐户，无法访问本地计算机之外。

网络共享的权限是第一层，之后是目录的 NTFS 权限检查。

您需要将应用程序池的身份更改为与您的用户具有相同权限的域用户。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-03-30T14:32:46.250

我可能有点晚了，但是我发现这个`Directory`类的方法有问题。相反，我`DirectoryInfo`以这种方式使用了模拟：

```
new DirectoryInfo(path).Exists 
```

这样您就可以避免整个身份更改问题，我们的 IT 部门否认了这一问题。

我希望这对某人有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-02T10:30:11.350

对于将来的参考，这也适用：

```
bool result = false;
try
{
    Directory.GetAccessControl(path);
    result = true;
}
catch (UnauthorizedAccessException)
{
    result = true;
}
catch
{
    result = false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-06T01:57:36.510

我收到这个错误的代码是这样的 UNC：

@"\Server01\c$\Data\SubFolder"

我做了一个明确的分享，去掉了`c$`，让它看起来像这样：

@"\Server01\TheData\SubFolder"

它开始起作用了。

我不是 100% 确定这就是解决权限问题的原因，但它在进行更改后立即开始工作。

# web-services - Web服务端点网址未连接

> ID：10196814
> 
> 赞同：0
> 
> 时间：2012-04-17T18:22:58.840
> 
> 标签：web-services, soapui

我正在尝试通过soap ui连接到远程Web服务端点并不断收到连接被拒绝错误。同事可以很好地连接。作为解决问题的一种方法，我在 IE 上粘贴了 http 端点 url，它给了我“Internet Explorer 无法显示网页”错误。这是否意味着我的互联网设置有问题？

Web 服务供应商无法提供帮助，因为它是在同事的机器上工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T08:20:10.803

您很可能被防火墙捕获，无论是在您的机器上，还是在您的机器和您正在访问的服务器之间的网段上。

鉴于您的同事工作，首先要看的是您的机器防火墙设置。

# multithreading - 使用 PHP CLI SAPI 的基于 PHP 的服务器

> ID：10196815
> 
> 赞同：2
> 
> 时间：2012-04-17T18:23:05.653
> 
> 标签：multithreading, php

使用 PHP CLI SAPI 开发（简单）服务器软件是否可能（并且可行）？PHP中是否有一些可用的（真正的）多线程方式，以便服务器能够同时处理多个请求？或者你会为这样的项目推荐另一种脚本语言（Python 或类似的东西）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T14:14:51.293

是的，可以用 PHP 开发 TCP 或 UDP 服务器。看看 PHP 中的一组套接字函数：[PHP:Sockets - Manual](http://php.net/manual/de/book.sockets.php)

尽管 PHP 没有多线程功能，但您可以使用非阻塞 IO（[请参阅](http://php.net/manual/de/function.socket-set-nonblock.php)`socket_set_nonblock()`）以及`socket_select()`

要回答“是否可行”这个问题，需要有关项目要求的更多信息。“是”的原因可能是：

*   您需要将服务器集成到现有的 PHP 类、模型框架中
*   您计划使用服务器交换 PHP 数据结构。（可能使用`serialize()`,生成`unserialize()`）

当然，您可能会为您找到其他原因。

您应该注意的另一件事是，在 Web 服务器环境（例如 apache SAPI）中，您已经有一个并行 TCP 服务器 - Web 服务器。您只需要实现几个请求之间的通信。您可以使用 PHP 的 IPC 功能、数据库或至少一个文件进行通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T14:27:17.080

> 使用 PHP CLI SAPI 开发（简单）服务器软件是否可能（并且可行）？

已经有一个内置的： http: [//php.net/manual/en/features.commandline.webserver.php](http://php.net/manual/en/features.commandline.webserver.php)

> PHP中是否有一些可用的（真正的）多线程方式，以便服务器能够同时处理多个请求？

您通常不会在 PHP 中执行此操作，而是将其交给一个单独的服务（您也可以用 PHP 编写），例如[http://php.net/manual/en/book.gearman.php](http://php.net/manual/en/book.gearman.php)

> 或者您会为这样的项目（Phyton 或类似的东西）推荐另一种脚本语言吗？

这取决于您的需求，没有更多信息就无法回答。**Python**、 Java 或 Golang 可能是更好的选择

**注意**：PHP 是一种多线程语言，但它不会向脚本的运行时公开多线程功能。

# jquery - 在 IE8 jQuery Cycle 中消失的图像

> ID：10196819
> 
> 赞同：7
> 
> 时间：2012-04-17T18:23:20.847
> 
> 标签：jquery, internet-explorer-8, cycle

[http://www.lunatestsite.co.uk/products/lifestation](http://www.lunatestsite.co.uk/products/lifestation)

不能为我的生活解决这个问题。到目前为止只在 IE8 中。我在主页周期中遇到了同样的问题，但设法通过声明宽度、高度和背景来解决：none !important 在有问题的 img 上。

我认为这可能是 png 问题，但 jpg 也会发生同样的情况：

[http://www.lunatestsite.co.uk/test-disappearing-jpgs](http://www.lunatestsite.co.uk/test-disappearing-jpgs)

结果相同：幻灯片中两个图像中的第一个通常闪烁，然后消失。

任何想法都值得赞赏。

已解决：我最初的修复最终也适用于此：添加背景：不重要！，并声明宽度/高度。它不适用于其他模板，因为我使用的是类而不是 ul#product-images 的 id。

耻辱，它燃烧！很抱歉浪费了任何人的时间。

```
body.home #front-slider #front-slides .slide{
background:none !important;
width: 980px;
height: 389px;
}

body.home #front-slider #front-slides .slide .slide-image img{
    background:none !important;
    width: 629px;
    height: 345px;
}

body.page-template-page-product-view-php ul#product-images .slide, body.page-template-page-product-view-wide-php ul#product-images .slide{
    background:none !important;
    width: 970px;
    height: 300px;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T14:41:50.240

我也遇到了这个问题，我将其追溯到 CSS 规则

```
img {
  max-width: 100%;
} 
```

一旦我删除了上述规则（在这种情况下我不需要它），图像就会停止消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-16T06:04:16.323

如果你想保持

```
max-width: 100%; 
```

然后还添加

```
width: auto; 
```

或从 HTML 中删除显式的宽度和高度属性

或将图像放入非浮动容器中

或为容器分配特定宽度。

这里有一篇关于这个错误的很好的文章：

[http://www.456bereastreet.com/archive/201202/using_max-width_on_images_can_make_them_disappear_in_ie8/](http://www.456bereastreet.com/archive/201202/using_max-width_on_images_can_make_them_disappear_in_ie8/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T18:48:29.110

听起来图像仍在加载中。

试试这个...

```
$(window).load(function() {
    $('#product-images, #front-slides').cycle({
        timeout: '7000',
        next: '#next',
        prev: '#prev',
        pager: '#pager',
        pagerAnchorBuilder: function(idx, el) {
                return '<a href="#"></a>';
            }
    });
 }); 
```

`window.load()`将在 DOM**和**页面图像加载`document.ready()`后触发，仅在 DOM 加载后触发。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T08:53:44.947

改变

```
img {
    max-width: 100%;
} 
```

到

```
img {
    max-width: auto;
} 
```

# r - 如何优化大型 R 数据框中每一行的过滤和计数

> ID：10196822
> 
> 赞同：1
> 
> 时间：2012-04-17T18:23:35.717
> 
> 标签：r, dataframe, apply, data.table, sqldf

我有一个数据框，如下所示：

```
 name day wages
1  Ann   1   100
2  Ann   1   150
3  Ann   2   200
4  Ann   3   150
5  Bob   1   100
6  Bob   1   200
7  Bob   1   150
8  Bob   2   100 
```

对于每个唯一的姓名/日期对，我想计算一个总数范围，例如“此人当前或第二天工资大于 175 的次数”。列比工资多得多，并且有四个时间片适用于每一行的每个总计。

我目前可以通过唯一化我的数据框来完成：

```
df.unique <- df[!duplicated(df[,c('name','day')]),] 
```

然后对于 中的每一行`df.unique`，将以下函数（为清楚起见而写成简写形式）应用于`df`：

```
for(i in 1:nrow(df.unique)) {
    df.unique[i,"wages_gt_175_day_and_next"] <- wages_gt_for_person_today_or_next(df,175,df.unique[i,"day"],df.unique[i,"name"])
}

wages_gt_for_person_today_or_next <- function(df,amount,day,person) {
  temp <- df[df$name==person,]
  temp <- temp[temp$day==day|temp$day==day+1,]
  temp <- temp[temp$wages > amount,]
  return(nrow(temp))
} 
```

给我，在这个简单的例子中：

```
name day wages_gt_175_day_and_next
Ann   1   1
Ann   2   1
Ann   3   0
Bob   1   1
Bob   2   0 
```

但是，鉴于我有数十万行，这似乎是一种极其缓慢的方法。有没有更聪明的方法来做到这一点？矩阵运算、应用、sqldf 之类的东西？

重新创建示例 df 的代码：

```
structure(list(name = structure(c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 
2L), .Label = c("Ann", "Bob"), class = "factor"), day = c(1, 
1, 2, 3, 1, 1, 1, 2), wages = c(100, 150, 200, 150, 100, 200, 
150, 100)), .Names = c("name", "day", "wages"), row.names = c(NA, 
-8L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:38:40.720

简单地从您的示例输出来看，这里有一些更有趣的使用`data.table`：

```
require(data.table)
DT <- data.table(df)
setkey(DT,name,day)

DT[,list(gt175 = sum(wages >= 175)),list(name,day)][,list(day = day,gt175 = as.integer(gt175 + c(tail(gt175,-1),0) > 0)),list(name)] 
```

这有点令人费解，但应该很快。

# c# - 将模型映射到视图模型

> ID：10196826
> 
> 赞同：0
> 
> 时间：2012-04-17T18:23:41.820
> 
> 标签：c#, .net, asp.net-mvc, model-binding, dto

我正在查看一个指南，上面写着“应该使用自动映射器将模型映射到视图模型。” 为什么会有这样的指导？

为什么不让模型成为视图模型的属性？例如，我可以使用这样的视图模型对联系人列表进行分页：

```
class ContactListPaginatedViewModel {
    public Contact myContact;  //the model object
    public PageInfo pageInfo;
} 
```

即使我需要回发来更新联系信息 - 模型活页夹也会很容易地解决这个问题。如果我需要从绑定中省略某些字段/属性（通过回发或其他方式），那么我可以简单地将绑定注释与“包含/排除”一起使用。

我是否遗漏了一些更大的问题，表明手动映射过程（模型的所有属性都在视图模型上复制）是可取的？

我能想到的最好的结果是模型可能有许多视图（或视图模型）不需要的属性......但即使在那种情况下，上述指导仍然没有意义。

洞察力？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:30:23.143

通常，如果您有一个 dto 类，最好只为视图模型提供模型所需的属性。这意味着您实际上只为实际使用的内容指定属性，例如我有一个`Client`包含 20 个字段的对象，我需要`Id`和您在该模型中需要的属性。`FullName``Client`

此外，从架构的角度来看，您真的想将 DTO 类公开给视图吗？在大多数情况下，某种服务层用作 DTO 类和视图本身之间的临时通信点，这反过来会为您填充视图模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:31:45.257

我几乎总是在我的 ViewModel 中保留一个模型参考。如果我需要一些额外的属性，我只需将它们添加到我的视图模型中。海事组织很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:42:07.093

因为将数据实体直接发送到视图是不好的做法。造成这种情况的原因有很多，包括安全原因。但也有更实际的原因，例如能够应用视图模型属性（当您的实体自动生成时您无法做到这一点，尽管有一些方法可以解决这个问题，例如使用伙伴类）。

一般来说。您需要一个特定于您的视图的视图模型。此视图模型应映射到您的业务对象。你的业务对象与你的实体对象是否不同，更多的是一个灰色地带，但视图模型和业务模型之间应该有明确的区别。

# grails - Grails - 传递选中的复选框

> ID：10196827
> 
> 赞同：1
> 
> 时间：2012-04-17T18:23:48.053
> 
> 标签：grails, checkbox

我已经完成了一个 Javascript 方法，该方法在声明的名称中获取所有选定的复选框并执行一个方法。

出于好奇，如何使用 JUST Grails 做某事？

例如：

```
 <g:checkBox name="personList" value="${person.id}"/>

 <g:form params="[people:personList]">
      <g:actionSubmit action="x" controller="bank" value="Pass These IDss"/>
 </g:form> 
```

表单的参数理论上将包括 personList 复选框组中所有选定复选框的列表。（我所做的我认为是不正确的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T18:38:05.317

您只需将`<g:checkbox />`标签包含在`<g:form> </g:form>`我认为的标签中即可。然后在*银行*控制器中，在*x*动作中，数据将在`params.personList`.

# asp.net - 我的 gacutil (vs2010 4.0) 似乎没有工作

> ID：10196832
> 
> 赞同：13
> 
> 时间：2012-04-17T18:24:10.337
> 
> 标签：asp.net, visual-studio-2010, gac, gacutil

我最近开始从头开始为 4.0 制作我的第一个 GAC 程序集，当我去安装它时，我得到了这个：Microsoft (R) .NET Global Assembly Cache Utility。版本 3.5.30729.1 版权所有 (c) Microsoft Corporation。版权所有。

将程序集添加到缓存失败：此程序集由比当前加载的运行时更新的运行时构建，无法加载。

所以我找到了 4.0 GacUtil (C:\Program Files\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools) 的位置，并将 exe 及其配置覆盖到那里的版本。我再次在我的新程序集上运行 /i 并得到：Microsoft (R) .NET Global Assembly Cache Utility。版本 4.0.30319.1 版权所有 (c) Microsoft Corporation。版权所有。

但是在 c:\windows\Assembly 中没有装配的痕迹。我以为我做错了什么并试图运行 gacutil /? 查看我可以尝试的其他选项（并查看为什么在安装程序集时没有显示输出），但它只是一直输出相同的东西：Microsoft (R) .NET Global Assembly Cache Utility。版本 4.0.30319.1 版权所有 (c) Microsoft Corporation。版权所有。

为了确保我没有失去理智，我复制了我一直在使用的旧 gacutil.exe 并执行了 /? 它加载了命令的帮助信息。将新的 gacutil 放回去并再次尝试，仍然没有输出。

使用这个新的 4.0 gacutil 时我做错了什么或错过了什么？

注意：程序集也不显示在 Windows\Microsoft.NET\Assemblies 中。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-17T20:37:41.857

如果要将 gacutil.exe 从其原始位置复制出来，则需要将 1033/gacutlrc.dll 文件与它一起复制。一旦我将该文件复制到新位置，gacutil 似乎工作正常。

# mysql - 在一个jsp页面中不断地从数据库中加载数据

> ID：10196835
> 
> 赞同：0
> 
> 时间：2012-04-17T18:24:40.870
> 
> 标签：mysql, jsp, servlets, chat

我正在使用 jsp 和 servlet 制作一个简单的聊天应用程序。我的问题是 jsp 页面仅在单击提交按钮时显示消息（存储在数据库中）。结果直到类型 user1 没有点击提交，他才能看到 user2 输入了什么。谁能建议我一个解决方案？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T19:02:22.423

从客户端/服务器的角度考虑这一点。如果您的客户端没有“连接”到服务器（浏览器就是这种情况），您需要将其“连接”到服务器以获取更新的消息或文本。您可以通过客户端通过几种方式完成此操作，事件或池化计时器，甚至是 Push 技术，但这对于初学者来说可能有点复杂。HTML5 有一种注册事件的方法，javascript 可以汇集新消息....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T19:04:53.363

阿贾克斯：[http ://w3schools.com/ajax/](http://w3schools.com/ajax/)

使用 javascript，您可以控制浏览器连接到服务器以请求数据的时刻。它仍然是有限的 - 您将更新聊天，例如每秒。

# php - 从表单调用php函数，并用结果完成表单

> ID：10196836
> 
> 赞同：1
> 
> 时间：2012-04-17T18:24:46.923
> 
> 标签：php, jquery, forms, wordpress, autofill

我正在为 Wordpress 编写一个插件，但如果您不熟悉 Wordpress，那也没关系。我有一个需要填写的表格，并且我有一个函数可以在 95% 的时间内返回表格中所需的所有字段。该函数需要一个唯一 ID，该函数将唯一 ID 放入 URL，获取一些 XML，解析 XML 并返回一些内容。我想用这些东西自动填充剩余的表单字段。

因此，我需要一个表单按钮来将唯一 ID 发送到我的函数，并且我需要了解我的函数如何将这些内容返回到其余字段......无论是否重新加载页面？然后，用户将检查这些字段，如果需要，手动添加其他数据，然后提交。

一个复杂的问题是 xml 来自的 URL 是外部的，因此无法通过 Jquery 查询？正确与否？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:29:56.820

如果“外部”是指跨域 Ajax 请求，则有可能。请参阅[jQuery.ajax()](http://api.jquery.com/jQuery.ajax/)函数和`jsonp`设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:30:44.593

使用 AJAX，您可以 POST/GET 并通过返回，您可以确定如何处理您的表单。

例如，我使用 jQuery 将数据转换为 JSON 格式并将其发送到外部服务器，该服务器以 JSON 字符串响应。仍然在 jQuery 中，我遍历数据并根据结果将错误抛出到特定的 id 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T18:39:24.633

如果您可以使用 JSON，那么您可以使用 jQuery。

如果您必须使用 XML，那么您需要 YQL（Yahoo！查询语言）。这是一篇文章：http: [//james.padolsey.com/javascript/cross-domain-requests-with-jquery/](http://james.padolsey.com/javascript/cross-domain-requests-with-jquery/)

如果您有权访问提供 XML 的位置，则可以使用 crossdomain.xml 技术：[http ://code.google.com/p/crossxhr/wiki/CrossXhr](http://code.google.com/p/crossxhr/wiki/CrossXhr)

或者您可以对您自己的一个 php 页面执行常规 ajax，该 php 页面使用 curl（或类似的东西）获取 XML，然后返回结果。这样你不需要做跨域请求，但它需要更长的时间。

# asp.net - 带有 twitter 引导组件的基本 asp.net 表单

> ID：10196838
> 
> 赞同：5
> 
> 时间：2012-04-17T18:24:50.900
> 
> 标签：asp.net, twitter-bootstrap

你们有在基本 asp.net 表单上工作的引导组件的示例（按钮后面有代码，获取下拉选择值等）吗？

我真的不知道如何使它工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T18:51:07.193

As long as you have an understanding of how ASP.NET server controls render in HTML

**example:**

This server control:

```
<asp:Button ID="Button1" runat="server" CssClass="btn" Text="Button 1" /> 
```

Renders to this HTML:

```
<input type="submit" class="btn" id="Button1" value="Button 1" name="Button1"> 
```

then you're on your way to using bootstrap with ASP.NET webforms

The `CssClass="btn"` is all you need to style the button with bootstrap.

Paste the markup below in your .ASPX page to see an example

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <link rel="stylesheet" href="http://twitter.github.com/bootstrap/1.4.0/bootstrap.min.css" />
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Button ID="Button1" runat="server" CssClass="btn" Text="Button 1" />
    </div>
    </form>
</body>
</html> 
```

* * *

**edit:**

You can turn any standard HTML control into a server control by adding `runat="server"` and then add click event handlers server side.

HTML:

```
<a id="actionLink" runat="server">Action</a> 
```

Code-Behind:

```
protected void Page_Load(object sender, EventArgs e)
{
    actionLink.ServerClick += new EventHandler(actionLink_ServerClick);
    ...
}

void actionLink_ServerClick(object sender, EventArgs e)
{
    ...
} 
```

Rendered Anchor Tag:

```
<a id="actionLink" href="javascript:__doPostBack('actionLink','')">Action</a> 
```

This should get you what you need to implement server clicks on those button dropdown and radio bootstrap controls.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-01T01:11:22.763

GitHub 上的 Pedro Fernandes 提供了几乎完整的 ASP.NET 引导控件集，但不确定许可证：

[https://github.com/cr1t/BootstrapControls](https://github.com/cr1t/BootstrapControls)

它仅支持 2.3.0 版本。将其转换为 3.0 应该不难。

# android - android开源上的相机应用程序？

> ID：10196852
> 
> 赞同：2
> 
> 时间：2012-04-17T18:25:43.910
> 
> 标签：android

安卓上的相机应用是开源的吗？我已经安装了 android 4.0.3 模拟器并获取了相机应用程序源。但是当我运行它时，它只让我设置曝光。但是当我在 Galaxy Nexus 上运行相机应用程序时，相机应用程序让我设置的不仅仅是曝光，它让我设置白平衡、闪光模式。

我的问题是为什么模拟器和 Galaxy Nexus 手机上的相机应用程序不同？

# python - Python Pandas：如何将带有“因子”的 DataFrame 转换为线性回归的设计矩阵？

> ID：10196860
> 
> 赞同：11
> 
> 时间：2012-04-17T18:26:39.853
> 
> 标签：python, dataframe, regression, factors

如果记忆对我有用，在 R 中有一种称为因子的数据类型，当在 DataFrame 中使用时，它可以自动解压缩到回归设计矩阵的必要列中。例如，包含 True/False/Maybe 值的因子将转换为：

```
1 0 0
0 1 0
or
0 0 1 
```

用于使用较低级别的回归代码。有没有办法使用熊猫库来实现类似的东西？我看到 Pandas 中有一些回归支持，但是由于我有自己的自定义回归例程，所以我对从异构数据构建设计矩阵（二维 numpy 数组或矩阵）非常感兴趣，并支持在numpy 对象的列和派生它的 Pandas DataFrame。

更新：这是一个数据矩阵的示例，其中包含我正在考虑的那种异构数据（示例来自 Pandas 手册）：

```
>>> df2 = DataFrame({'a' : ['one', 'one', 'two', 'three', 'two', 'one', 'six'],'b' : ['x', 'y', 'y', 'x', 'y', 'x', 'x'],'c' : np.random.randn(7)})
>>> df2
       a  b         c
0    one  x  0.000343
1    one  y -0.055651
2    two  y  0.249194
3  three  x -1.486462
4    two  y -0.406930
5    one  x -0.223973
6    six  x -0.189001
>>> 
```

'a' 列应转换为 4 个浮点列（尽管有这个含义，但只有四个唯一原子），'b' 列可以转换为单个浮点列，而 'c' 列应是设计矩阵中未修改的最后一列。

谢谢，

SetJmp

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-28T22:32:03.217

有一个名为 patsy 的新模块可以解决这个问题。下面链接的快速入门通过几行代码完全解决了上述问题。

*   [http://patsy.readthedocs.org/en/latest/overview.html](http://patsy.readthedocs.org/en/latest/overview.html)

*   [http://patsy.readthedocs.org/en/latest/quickstart.html](http://patsy.readthedocs.org/en/latest/quickstart.html)

这是一个示例用法：

```
import pandas
import patsy

dataFrame = pandas.io.parsers.read_csv("salary2.txt") 
#salary2.txt is a re-formatted data set from the textbook
#Introductory Econometrics: A Modern Approach
#by Jeffrey Wooldridge
y,X = patsy.dmatrices("sl ~ 1+sx+rk+yr+dg+yd",dataFrame)
#X.design_info provides the meta data behind the X columns
print X.design_info 
```

生成：

```
> DesignInfo(['Intercept',
>             'sx[T.male]',
>             'rk[T.associate]',
>             'rk[T.full]',
>             'dg[T.masters]',
>             'yr',
>             'yd'],
>            term_slices=OrderedDict([(Term([]), slice(0, 1, None)), (Term([EvalFactor('sx')]), slice(1, 2, None)),
> (Term([EvalFactor('rk')]), slice(2, 4, None)),
> (Term([EvalFactor('dg')]), slice(4, 5, None)),
> (Term([EvalFactor('yr')]), slice(5, 6, None)),
> (Term([EvalFactor('yd')]), slice(6, 7, None))]),
>            builder=<patsy.build.DesignMatrixBuilder at 0x10f169510>) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T19:17:33.853

```
import pandas
import numpy as np

num_rows = 7;
df2 = pandas.DataFrame(
                        {
                        'a' : ['one', 'one', 'two', 'three', 'two', 'one', 'six'],
                        'b' : ['x', 'y', 'y', 'x', 'y', 'x', 'x'],
                        'c' : np.random.randn(num_rows)
                        }
                      )

a_attribute_list = ['one', 'two', 'three', 'six']; #Or use list(set(df2['a'].values)), but that doesn't guarantee ordering.
b_attribute_list = ['x','y']

a_membership = [ np.reshape(np.array(df2['a'].values == elem).astype(np.float64),   (num_rows,1)) for elem in a_attribute_list ]
b_membership = [ np.reshape((df2['b'].values == elem).astype(np.float64), (num_rows,1)) for elem in b_attribute_list ]
c_column =  np.reshape(df2['c'].values, (num_rows,1))

design_matrix_a = np.hstack(tuple(a_membership))
design_matrix_b = np.hstack(tuple(b_membership))
design_matrix = np.hstack(( design_matrix_a, design_matrix_b, c_column ))

# Print out the design matrix to see that it's what you want.
for row in design_matrix:
    print row 
```

我得到这个输出：

```
[ 1\.          0\.          0\.          0\.          1\.          0\.          0.36444463]
[ 1\.          0\.          0\.          0\.          0\.          1\.         -0.63610264]
[ 0\.          1\.          0\.          0\.          0\.          1\.          1.27876991]
[ 0\.          0\.          1\.          0\.          1\.          0\.          0.69048607]
[ 0\.          1\.          0\.          0\.          0\.          1\.          0.34243241]
[ 1\.          0\.          0\.          0\.          1\.          0\.         -1.17370649]
[ 0\.          0\.          0\.          1\.          1\.          0\.         -0.52271636] 
```

因此，第一列是“一个”的 DataFrame 位置的指示符，第二列是“两个”的 DataFrame 位置的指示符，依此类推。第 4 列和第 5 列分别是 DataFrame 位置的指示符，它们分别是“x”和“y”，最后一列只是随机数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-12T16:20:07.110

2014 年 2 月 3 日的 Pandas 0.13.1 有一个方法：

```
>>> pd.Series(['one', 'one', 'two', 'three', 'two', 'one', 'six']).str.get_dummies()
   one  six  three  two
0    1    0      0    0
1    1    0      0    0
2    0    0      0    1
3    0    0      1    0
4    0    0      0    1
5    1    0      0    0
6    0    1      0    0 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-20T19:03:22.063

`patsy.dmatrices`在许多情况下可能运作良好。如果您只有一个向量 - a `pandas.Series`- 那么下面的代码可能会产生退化的设计矩阵并且没有截距列。

```
def factor(series):
    """Convert a pandas.Series to pandas.DataFrame design matrix.

    Parameters
    ----------
    series : pandas.Series
        Vector with categorical values

    Returns
    -------
    pandas.DataFrame
        Design matrix with ones and zeroes.

    See Also
    --------
    patsy.dmatrices : Converts categorical columns to numerical

    Examples
    --------
    >>> import pandas as pd
    >>> design = factor(pd.Series(['a', 'b', 'a']))
    >>> design.ix[0,'[a]']
    1.0
    >>> list(design.columns)
    ['[a]', '[b]']

    """
    levels = list(set(series))
    design_matrix = np.zeros((len(series), len(levels)))
    for row_index, elem in enumerate(series):
        design_matrix[row_index, levels.index(elem)] = 1
    name = series.name or ""
    columns = map(lambda level: "%s[%s]" % (name, level), levels)
    df = pd.DataFrame(design_matrix, index=series.index, 
                      columns=columns)
    return df 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-19T06:49:45.060

```
import pandas as pd
import numpy as np

def get_design_matrix(data_in,columns_index,ref):
    columns_index_temp =  columns_index.copy( )
    design_matrix = pd.DataFrame(np.zeros(shape = [len(data_in),len(columns_index)-1]))
    columns_index_temp.remove(ref)
    design_matrix.columns = columns_index_temp
    for ii in columns_index_temp:
        loci = list(map(lambda x:x == ii,data_in))
        design_matrix.loc[loci,ii] = 1
    return(design_matrix)

get_design_matrix(data_in = ['one','two','three','six','one','two'],
                  columns_index = ['one','two','three','six'],
                  ref = 'one')

Out[3]: 
   two  three  six
0  0.0    0.0  0.0
1  1.0    0.0  0.0
2  0.0    1.0  0.0
3  0.0    0.0  1.0
4  0.0    0.0  0.0
5  1.0    0.0  0.0 
```

# python - 在python中的用户输入中使用类中的字典

> ID：10196863
> 
> 赞同：0
> 
> 时间：2012-04-17T18:26:47.170
> 
> 标签：python, class, dictionary

这是我当前的代码：

```
class city1:
    dict = {"north":"city2", "east": 0, "south": 0, "west": "city3"}

validcmds = ['north', 'east', 'south', 'west']
input=raw_input(">>")
input=set(input.split())
validcmds=set(validcmds)
output = list(validcmds.intersection(input))
print city1.dict(output) 
```

我不知道这条线有什么问题：

```
print city1.dict(output) 
```

基本上我只想在 city1 类的字典中查找输出。这是我的基于文本的 RPG :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:35:27.290

首先，不要使用这个词`dict`。`dict()`这样做时会屏蔽内置方法。接下来，您可以使用该`d.get(key)`方法从字典中检索元素。

您可能需要查看您的代码，因为我不相信它可以在当前状态下工作，即使在您从字典中检索元素之后也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:28:43.393

您不使用括号来访问字典。改为使用`print city1.dict[output]`。然而，看起来你正在用字典键制作一个列表，如果你尝试在这样的列表上建立索引，Python 会抱怨这不是可散列的。

如果`output`里面有多个键，那么试试这个：

```
print [city1.dict[elem] for elem in output] 
```

以数据结构的类型命名数据结构也是不好的做法。我会考虑将重命名`dict`为其他名称，例如`city_dict`或更具有描述性的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:33:48.447

输出是一个键列表。你不能一次用一个键列表来键入你的字典。你应该做： `print [city1.dict[x] for x in output]`

顺便说一句，`input`是一种方法，通过分配输入您删除了该命令..（在这里并不重要，但您可能想知道）

# python - 使用python将文件从Windows复制到Linux机器

> ID：10196867
> 
> 赞同：-1
> 
> 时间：2012-04-17T18:27:07.117
> 
> 标签：python, paramiko

我是 Python 的新手，在旅途中学习 Python。我需要将 Windows 7 上的文件复制到运行 Linux 的远程机器上。这在 Python 中可行吗？如果是这样，应该使用什么模块？

我浏览了互联网，听说 paramiko 模块用于建立与远程服务器的 ssh 连接。我试过了，但在我的 Windows 7 PC 上安装 paramiko 时遇到问题。

有没有一种简单的方法可以做到这一点？或者在 Windows 7 上安装 paramiko 的指针也应该有所帮助。

尝试导入 paramiko 时出现以下错误

```
import paramiko
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "c:\Python26\lib\site-packages\paramiko\__init__.py", line 69, in <module>
from transport import randpool, SecurityOptions, Transport
File "c:\Python26\lib\site-packages\paramiko\transport.py", line 37, in <module>
from paramiko.dsskey import DSSKey
File "c:\Python26\lib\site-packages\paramiko\dsskey.py", line 23, in <module>
from Crypto.PublicKey import DSA
File "c:\Python26\lib\site-packages\Crypto\PublicKey\DSA.py", line 34, in <module>
from Crypto import Random
File "c:\Python26\lib\site-packages\Crypto\Random\__init__.py", line 28, in <module>
import OSRNG
File "c:\Python26\lib\site-packages\Crypto\Random\OSRNG\__init__.py", line 34, in   module>
from Crypto.Random.OSRNG.nt import new
File "c:\Python26\lib\site-packages\Crypto\Random\OSRNG\nt.py", line 28, in <module>
import winrandom
ImportError: DLL load failed: %1 is not a valid Win32 application. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:47:09.620

你可以考虑在linux服务器上安装samba，然后使用python的shutil.copyfile()。

[http://docs.python.org/library/shutil.html#shutil.copyfile](http://docs.python.org/library/shutil.html#shutil.copyfile)

[http://www.samba.org/](http://www.samba.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-22T09:19:40.767

在您的 Windows 机器上安装适用于 Python 的 anaconda。这包括几乎所有的 python 库，包括 Pramiko。

# java - TabWidget 错误令牌中的 Android Spinner

> ID：10196876
> 
> 赞同：0
> 
> 时间：2012-04-17T18:27:54.893
> 
> 标签：java, android, spinner, android-context, tabwidget

就此而言，我对 Android 和 Java 还很陌生，并且遇到了上下文问题 - 我在另一个 TabWidget 中的 TabWidget 中有一个 Spinner，在代码方面我有我的主类，它是一个 TabActivity，我在其中设置将特定选项卡的意图设置为另一个 TabActivity，在其中我将选项卡的意图设置为 Activity，我将内容视图设置为我拥有 Spinner 的布局（希望这是有道理的）。每当我单击微调器并尝试启动微调器的对话框时，它都会给我一个错误的令牌错误。根据我的阅读，这是因为我的微调器有错误的上下文，但由于我没有主动设置我的上下文（我在 XML 中创建了微调器），而且我似乎找不到要设置的方法或公开属性微调器的上下文......好吧，你明白了，我' 尽管阅读了其他人的类似问题，但我还是迷失了这一点。这是我的代码：

主要的：

```
public class Star_Android_Activity extends TabActivity 
{
    public static void main(String[] args) {
    }

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        TabHost tabHost = getTabHost();  // The activity TabHost
        TabHost.TabSpec spec;  // Resusable TabSpec for each tab
        Intent intent;  // Reusable Intent for each tab

        // Create an Intent to launch an Activity for the tab (to be reused)
        intent = new Intent().setClass(this, Pick_Activity.class);

        // Initialize a TabSpec for each tab and add it to the TabHost
        spec = tabHost.newTabSpec("pick").setIndicator(LinearLayout.inflate(this,R.layout.tab_header_pick, null))
            .setContent(intent);
        tabHost.addTab(spec);

        tabHost.setCurrentTab(0);
    }
} 
```

子标签：

```
public class Pick_Activity extends TabActivity {
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

            setContentView(R.layout.pick);

            TabHost tabHost = getTabHost();  // The activity TabHost
            TabHost.TabSpec spec;  // Reusable TabSpec for each tab
            Intent intent;  // Reusable Intent for each tab

            intent = new Intent().setClass(this, Pending_Activity.class);
            spec = tabHost.newTabSpec("pending").setIndicator(LinearLayout.inflate(this,R.layout.tab_header_pending, null))
                          .setContent(intent);
            tabHost.addTab(spec);

            tabHost.setCurrentTab(0);
    }
} 
```

儿童活动：

```
public class Pending_Activity extends Activity 
{

    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.pending);

        addSpinnerValues();
    }

    public void addSpinnerValues()
    {
        Spinner spn = (Spinner)findViewById(R.id.spnPick);
        List<String> list = new ArrayList<String>();
        list.add("list 1");
        list.add("list 2");
        list.add("list 3");
        ArrayAdapter<String> dataAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, list);
        dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spn.setAdapter(dataAdapter);    
    }

} 
```

Main 和 Pick 的 xml 文件基本上是 hello tabwidget 教程的副本，而我的 pending.xml 只是一个 FrameLayout，其中包含一些按钮和我的微调器。如果有帮助，我可以发布代码，但我在发布代码时遇到了问题（可能是字符限制）。

任何关于如何正确设置我的上下文的帮助（如果不麻烦的话，还有一个小的解释）将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T12:46:26.243

花了我一段时间，但我发现另一个帖子包含解决方案的一部分，至少对我的目的有很大帮助......我只是改变了我的：

```
setContentView(R.layout.pending); 
```

到：

```
View viewToLoad = LayoutInflater.from(this.getParent()).inflate(R.layout.pending, null); 
    this.setContentView(viewToLoad); 
```

这样我的pending.xml 页面的上下文就设置为父级的上下文了……虽然我承认，但我真的不明白为什么它不必是父级的父级，为什么只是父级本身是一个孩子是可以接受的......希望有一些时间我会开始理解它。

# r - 在 R 图上绘制预测线

> ID：10196880
> 
> 赞同：0
> 
> 时间：2012-04-17T18:28:12.847
> 
> 标签：r

我有一个时间序列数据：

x数据帧的输出：

```
Date  vol
1990  12
1991  13
1992  15
1994  18
1995  20
1996  35 
```

我正在尝试绘制这些数据并预测未来 4 年，如下所示：

```
plot(x$Date, x$vol, col="blue")
x.lm<-lm(x$Vol ~ x$Date)
x.pre<-predict(x.lm, n.ahead=4)
abline(x.pre, col="red") 
```

我收到此错误：

```
Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...) : 
  invalid a=, b= specification 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T18:30:14.917

您在 中将“Vol”大写`x.lm<-lm(x$Vol ~ x$Date)`。

尝试

```
x.lm<-lm(x$vol ~ x$Date) 
```

此外，如果不进行一些额外的修改，您将无法像这样传递`predict()`into的值。`abline`由于您没有进行任何复杂的预测，而只是想绘制线性拟合，您可以使用

```
abline(x.lm, col="red") 
```

如果您将变量分开，然后在 中使用 newdata 参数`predict`，您应该能够获得实际的预测。这可能是最干净的方法。例如：

```
y <- x$vol
x <- x$Date
x.lm <- lm(y~x)
predict(x.lm, data.frame(x=1997:2000)) 
```

这将返回 1997 - 2000 年的预测。我相信“x”中的“x”`data.frame(x=1997:2000)`必须与您`lm()`作为 x 变量输入的变量匹配。在您的情况下，它有一个美元符号访问器，这使整个事情变得更加复杂。我只是采用上面的方法，并将输入到您的`lm()`函数中的 x 组件重命名为可以稍后引用的有效变量名。

# django - Django Haystack Solr - Solr 的推荐位置和目录结构

> ID：10196885
> 
> 赞同：3
> 
> 时间：2012-04-17T18:28:41.367
> 
> 标签：django, solr, django-haystack

我正在使用 django-haystack，我对将 /solr 放在哪里有点困惑，它是 schema.xml、solr.xml 和 solrconfig.xml 文件。

我目前在以下较长的路径中有 /solr --- /home/mydir/solr/apache-solr3.6.0/example/

我正在考虑将胆量提升一个级别（摆脱/apache-solr3.6.0/）离开--- /home/mydir/solr/example/

看起来Jetty servelet都在example目录下，所以我的想法是将目录名称“example”更改为“mysite”，或者将“example”的副本保存为“mysite”在同一级别。在任何一种情况下，我都会得到 --- /home/mydir/solr/mysite/

我在某处读到 schema.xml、solr.xml 和 solrconfig.xml 应该位于“solr home”目录下的 /conf 目录中。所以我想我应该创建 --- /home/mydir/solr/mysite/conf 并将我的文件放在那里。

我已将以下内容添加到我的设置文件中：

```
HAYSTACK_CONNECTIONS = {
    ’default’: {
        ’ENGINE’: ’haystack.backends.solr_backend.SolrEngine’,
        ’URL’: ’http://127.0.0.1:8983/solr/mysite'
    },
} 
```

如果我按照上面概述的方式设置所有内容，那么事情是否可行？如果有人有一个干净优雅的设置，他们想分享——我非常愿意接受建议。

顺便说一句 - 我已经完成了 solr 教程（所以 solr 正在工作），并且我已经安装了 haystack run syncdb（所以看起来 haystack 也准备好了）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T17:56:44.763

实际上我使用了包含我的 django 项目文件夹的文件夹

# php - PHP - 页脚函数示例

> ID：10196891
> 
> 赞同：-1
> 
> 时间：2012-04-17T18:29:06.180
> 
> 标签：php, sql

我一直在寻找，但我找不到一个例子。我想在我的functions.php中写一个foother函数，你能给我一个简单的例子来说明这是如何完成的。我想我有一个想法，但我不确定是否可行。

```
 function footer_function()
 {
   $return_Str='';
   $return_Str .= '<h3>Copyright © 2012</h>';
   return $return_Str;
} 
```

感谢大家的帮助！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:32:01.613

只需在代码前添加函数，使其看起来像这样：

```
function footer_function()
{
   $return_Str = '';
   $return_Str .= '<h3>Copyright © '.date('Y').'</h>';
   return $return_Str;
} 
```

请注意我如何将 2012 更改为日期函数，以便 PHP 将根据需要自动更改数据，这样您就不必每年手动更新它。

要调用该函数，您只需在要显示文本的位置编写以下代码：

```
echo footer_function(); 
```

我还建议为您的页脚编写一个 HTML（或 php）模板，然后将其保存为 footer.inc.php。然后，您可以使用此函数在文档末尾包含此文件：

```
include('footer.inc.php;); 
```

这样您就可以轻松地编辑整个站点的 HTML，而无需更新各个页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:46:51.553

你的问题非常笼统，所以我会尽我所能提供帮助。如果你想在 php scrip 中编写 html，你可以这样做，你还需要 Echo 它：

```
<?php
footer_function()
 {
  $return_Str='';
  $return_Str .= { ?>
   <h3>Copyright © 2012</h>
  <?php }
  return $return_Str;
 }
 echo footer_function();
 ?> 
```

您会看到 {} 充当 php 之间的 HTML 代码的容器，并且将传递多个 php 标志直到关闭：

```
<?php
footer_function()
 {
  $return_Str='';
  $return_Str .= { ?>
   <h3>Copyright © 2012</h>
   <h1><?php someFunction(); ?></h1>
  <?php }
  return $return_Str;
 }
 echo footer_function();
 ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:32:39.130

这可能就是你想要的。

```
function footer() {
    $return_str = "";
    $return_str .= '<h3>Copyright 2012</h3>';
    return $return_str;
} 
```

显示页脚。就这样做

```
echo footer(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T18:32:47.463

我的一个项目中有这样的东西：

```
<div id="footer">

    <div id="inner">

        <p><span class="color">Copyright © Hüseyin Zeki, 2012 </span> Tüm hakları saklıdır.</p>

        <ul>

            <li><a href="http://www.facebook.com/Huskopat" class="facebook"></a></li>
            <li><a href="https://twitter.com/" class="twitter"></a></li>

        </ul>

    </div>

</div> 
```

php版本：

```
function footer_function() {
$return_Str = '';
$return_Str .= '<div id="footer">';
$return_Str .='<div id="inner">';
$return_Str .='<p><span class="color">Copyright © Hüseyin Zeki, 2012 </span> Tüm hakları saklıdır.</p>';
$return_Str .='<ul>';
$return_Str .='<li><a href="http://www.facebook.com/Huskopat" class="facebook"></a></li>';
$return_Str .='<li><a href="https://twitter.com/" class="twitter"></a></li>';
$return_Str .='</ul>';
$return_Str .='</div>';
$return_Str .='</div>';
return $return_Str;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T18:33:36.697

这是给wordpress的吗？

您已经创建了一个返回字符串的基本函数，您的示例将根据您实现它的方式工作......即：

`echo footer_function();`

您应该考虑使年份动态而不是静态。

`$returnStr .= '<h3>Copyright ".date('Y')."</h3>';`

# xamarin.ios - MonoTouch 中奇怪的 NSInvalidArgumentException

> ID：10196893
> 
> 赞同：1
> 
> 时间：2012-04-17T18:29:14.197
> 
> 标签：xamarin.ios

我正在为一家酒店开发非常简单的 MonoTouch 应用程序，主要包含图像和文本。没有花哨的事情发生。

在模拟器中一切都运行良好，但是当我在 iPhone 上加载它时，一些 UILabel 似乎已经消失了。我在 XCode 中创建了视图，没有创建动态视图，只是一个普通的旧 UILabel，它在模拟器中看起来很好，但没有显示在设备上。

我试图通过在 ViewDidLoad 事件中放置一个 Debug.Writeline(title==null) 来调试它。在模拟器中输出“false”，但 iPhone 崩溃并出现以下情况：

```
Objective-C exception thrown.  Name: NSInvalidArgumentException Reason: -[UILabel UTF8String]: unrecognized selector sent to instance 0x66266d0 
```

这是我的版本信息：

MonoDevelop 2.8.6.5 Mono 2.10.8 Xcode 4.2 (828) Monotouch: 5.0.4

我真的不知道该往哪个方向看，所以非常感谢任何帮助。

谢谢 Themos

# python - Django：过滤值或无的ForeignKey

> ID：10196895
> 
> 赞同：0
> 
> 时间：2012-04-17T18:29:35.290
> 
> 标签：python, django, django-queryset

我可以在不诉诸两个查询的情况下完成以下工作吗？

```
>>> c = Category.objects.all()[0]
>>> len(Document.objects.filter(category=c))
3
>>> len(Document.objects.filter(category=None))
55
>>> len(Document.objects.filter(category__in=[c, None]))
3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:32:05.053

Q 对象提供了您正在寻找的功能。[https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:32:17.760

使用[`Q`对象](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)。

```
from django.db.models import Q
len(Document.objects.filter( Q(category=c) | Q(category=None) ) ) 
```

# c# - MemoryMappedFile.CreateOrOpen 抛出句柄无效

> ID：10196897
> 
> 赞同：4
> 
> 时间：2012-04-17T18:29:38.807
> 
> 标签：c#, .net, memory-mapped-files

我有创建内存映射文件的代码，如下所示：

```
using (Mutex mutex = new Mutex(false, CoordinatorMutexName))
{
    mutex.WaitOne();

    var security = new MemoryMappedFileSecurity();
        security.SetAccessRule(
            new AccessRule<MemoryMappedFileRights>(
                new SecurityIdentifier(WellKnownSidType.WorldSid, null), // everyone
                MemoryMappedFileRights.FullControl,
                AccessControlType.Allow));

    MemoryMappedFile coordinator = MemoryMappedFile.CreateOrOpen(
        CoordinatorMMFName,
        16 * 1024 * 1024 + 4,
        MemoryMappedFileAccess.ReadWrite,
        MemoryMappedFileOptions.DelayAllocatePages,
        security,
        HandleInheritability.None);

...
...

} 
```

在某些情况下（如下所述），CreateOrOpen 调用会引发以下异常：

```
 System.IO.IOException: The handle is invalid.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.MemoryMappedFiles.MemoryMappedFile.CreateOrOpenCore(SafeFileHandle fileHandle, String mapName, HandleInheritability inheritability, MemoryMappedFileSecurity memoryMappedFileSecurity, MemoryMappedFileAccess access, MemoryMappedFileOptions options, Int64 capacity)
   at System.IO.MemoryMappedFiles.MemoryMappedFile.CreateOrOpen(String mapName, Int64 capacity, MemoryMappedFileAccess access, MemoryMappedFileOptions options, MemoryMappedFileSecurity memoryMappedFileSecurity, HandleInheritability inheritability) 
```

它仅在运行自动化测试时抛出此异常，我无法在本地、调试器内部或外部重现此异常。我尝试仅将上述代码提取到独立测试中，但无法重现该问题。但是这里的代码太多了，无法发布所有内容。MemoryMappedFile 在线程的持续时间内被持久化（假设它被创建），然后被释放。

以下是测试失败的情况： 测试旨在从多个线程执行此代码。它们在 NUnit 中，在 CruiseControl.NET 下运行，其服务在 64 位 Windows 2008 Server 上的域帐户（不是本地计算机帐户）下运行。我可以在登录到同一台机器时手动运行这些相同的测试，并且它们都通过了。

我知道这可能不足以让某人直接解决，但我什至不知道如何调查这个问题。在尝试 CreateOrOpen 内存映射文件时，哪些事情会导致“句柄无效”消息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T18:44:38.203

它记录了 CreateFileMapping() 的错误代码，这是创建内存映射文件的底层 winapi 函数：

> 如果 lpName 与现有事件、信号量、互斥体、可等待计时器或作业对象的名称匹配，则该函数将失败，并且 GetLastError 函数返回 ERROR_INVALID_HANDLE。这是因为这些对象共享相同的命名空间。

所以选择一个好的随机名称来避免这个错误。您可以从 Visual Studio 获得一个：工具 + 创建 GUID，选项 4。它是全球唯一的。

# c++ - 'if' 表达式的评估

> ID：10196898
> 
> 赞同：2
> 
> 时间：2012-04-17T18:29:40.507
> 
> 标签：c++, if-statement, short-circuiting

考虑我有以下内容：

```
edge some_edge;
std::priority_queue<edge> my_queue; 
```

即使队列可能是空的，写这样的“如果”是否安全？

```
if ((my_queue.size() > 0) && (my_queue.top().weight < some_edge.weight)) {
    do_something;
} 
```

这个如何？

```
if ((my_queue.top().weight < some_edge.weight) && (my_queue.size() > 0)) {
    do_something;
} 
```

如果左操作数的计算结果为假，则计算操作数之间的运算符为“and”的表达式是否停止？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T18:32:31.977

C++ 中的`if`语句是从左到右关联的，逻辑布尔运算符`&&`是`||`短路的，所以是的，像下面这样的语句是安全的，因为它保证您首先检查大小（假设这些运算符没有恶意重载）：

```
if(myqueue.size() > 0 && myqueue.top().whatever) {
    // ...
} 
```

但是，相反的情况并非如此，因为您检查了弹出队列`size()` *后的返回值。*

顺便说一句，`std::priority_queue`提供了一个`empty()`我/许多人更喜欢的功能`size() > 0`，但这也有效。

```
if(!myqueue.empty() && myqueue.top().whatever()) {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T18:31:29.333

是的，这种行为是根据 C++ 标准保证的。

```
if (false && doSomething()) 
```

永远不会评价`doSomething()`。

但是，如果您重载`operator&&`，则会评估所有表达式，因此此行为可能会有所不同。这就是为什么触摸 是一个坏主意`operator&&`。

你应该使用`!empty()`而不是`size() > 0`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T18:36:35.317

这根本不是关于`if`，而是关于`&&`。逻辑运算符（`&&`和`||`）首先计算其左操作数。然后当且仅当右操作数可以影响逻辑结果时，它们才会评估右操作数。

在 的情况下`&&`，如果左操作数的计算结果为`false`，则结果将`false`与右操作数的值无关，因此不会计算右操作数。

在 的情况下`||`，如果左操作数的计算结果为`true`，则结果将`true`与右操作数的值无关，因此不会计算右操作数。

This is true whether the `&&` is in the expression of an `if` statement or not. Some obfuscated code makes use of this by turning `if (x) y;` into `x && y`. Though not see as often, you *can* do the same with `||` as well.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T18:36:30.847

此链接解释了并非所有运算符都如此，即使 && 也是如此。特别是，请注意在关联性与评估顺序的上下文中从左到右/从右到左之间的差异。[http://en.cppreference.com/w/cpp/language/eval_order](http://en.cppreference.com/w/cpp/language/eval_order)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T18:32:26.327

布尔表达式是短路计算的，所以如果第一部分失败，第二部分将不会运行。所以第一个例子不会访问不存在的内存，但第二个会。

# plugins - 我可以在 Cordova-1.6.0 for Android 中使用 Phonegap 转换插件吗

> ID：10196903
> 
> 赞同：1
> 
> 时间：2012-04-17T18:29:51.940
> 
> 标签：plugins, cordova, transition

当我在我的 android 应用程序中使用这个插件 [ [https://github.com/sandstein/phonegap-transition-plugin](https://github.com/sandstein/phonegap-transition-plugin) ] 时，我发现了一个类似**04-18 00:56:02.495: D/CordovaLog(359) 的错误： [弃用通知] window.addPlugin 和 window.plugins 将在 2.0 版本中被移除。**我该如何使用这个插件。我不知道我也可以使用 phonegap-plugins [ [https://github.com/sandstein/phonegap-plugins](https://github.com/sandstein/phonegap-plugins) ] 吗？请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:11:50.900

插件模型正在重新设计。未来的 Cordova 2.0 插件方案尚未完全定义。在此之前，请使用已弃用的模型并忽略通知。

# sql-server - 在 SQL Server 中存储数据库架构版本的最佳实践？

> ID：10196904
> 
> 赞同：23
> 
> 时间：2012-04-17T18:29:53.783
> 
> 标签：sql-server, database-schema

我有一个应用程序，它将部署在带有 SQL Server 的生产 PC 上。我希望能够在我的数据库中存储和检索模式的一个版本。我对能够实现这一目标的最佳实践感兴趣，主要目标如下：

1.  能够存储和轻松检索数据库的版本号。
2.  隐藏或更难被客户发现和操作。
3.  当我们创建新版本时可以编辑/更改。
4.  备份数据库或检测数据库会保留版本号以供取证。

我希望有一种方法可以在元数据中存储“版本”或不是普通表，可以通过系统存储过程访问/设置。

有什么想法或最佳实践吗？

编辑：我发现可能有希望的一个选项是使用 SQL Server 扩展属性，将键|值分配给带有“Schema_Version”和版本号的数据库。它没有加密（但值可能是），也没有隐藏，但至少从我们的一些用户和现场人员浏览的实际数据库结构中删除（令我沮丧！:)）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-17T21:04:48.437

我是 Red Gate 的 SQL Source Control 和 SQL Compare 产品经理。我们必须解决同样的问题，因为我们的工具需要知道数据库的版本，以便选择适当的迁移脚本来构建完整的部署脚本。

我们考虑了一个版本表，这是最常用的本土解决方案。但是，从我们的研究中我们了解到，用户希望保持数据库对象集“不受污染”，因此我们选择了数据库级别的扩展属性。我们将其附加到脚本中，如下所示：

```
IF EXISTS (SELECT 1 FROM fn_listextendedproperty(N'SQLSourceControl Database Revision', NULL, NULL, NULL, NULL, NULL, NULL))
  EXEC sp_dropextendedproperty N'SQLSourceControl Database Revision', NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_addextendedproperty N'SQLSourceControl Database Revision', @RG_SC_VERSION, NULL, NULL, NULL, NULL, NULL, NULL 
```

当数据库加载到 SQL Compare 中时，它会执行检查以确保它声称的版本与源代码控制中存储的版本相对应。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T18:32:50.823

说实话，我们只是存储每个数据库的模式编号。我们在数据库中有一个表，仅供软件配置管理团队使用，它告诉我们当前版本，以便我们可以跨环境快速查看哪个版本在哪里。我不会担心将它放在数据库之外的某个地方，因为这只会使事情复杂化。

我想如果你真的想要安全，你总是可以创建一个存储过程，其中的值是硬编码的。然后你可以加密存储过程，这样他们就无法在你不知情的情况下查看/篡改它。当您更改它们的版本时，您可以只更新 sp。你也可以进系统，把系统表中的存储过程代码编译好后删除，但我真的不会这样做。它只会导致问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-13T21:59:55.277

我已经实现了一个基于一个表的解决方案，该表在每个版本开始和结束其有效性时使用时间戳跟踪四段架构版本（主要、次要、构建、修订）。只有一行的结束时间戳为 NULL，即当前版本。

此外，还有一堆存储过程支持这个版本控制系统，所有的数据库变更一旦对数据库模式进行任何更改（例如添加表、删除列），都必须使用这些过程来测试和更新模式版本， ETC。）。

请注意，完整的更改历史记录存储在跟踪数据库版本的表中。当出现任何问题时，解决方案非常灵活。例如，如果变更在执行过程中中断，它成功进行的所有更改都会被记住在版本表中，因为在每一步之后它都会增加修订号。您可以改进更改并再次运行它，它会自动跳过成功完成的步骤并从上次未执行的第一步继续。

还有一个（可选的）技巧——我对中间版本使用了奇数的内部版本号，对已完成的版本使用了偶数的内部版本号。这样，一旦变更开始，它首先将内部版本号更改为下一个奇数值，然后做它想做的事情。如果您在任何时候看到一个奇怪的内部版本号（版本号中的第三部分），那么您确定某些更改没有完成！一旦 alter 完成最后一步，它会再次更改模式版本，这次更改为下一个偶数内部版本号，只是为了通知每个人它已经完成。

您可以在本文中查看完整的源代码、手册和示例：[如何维护 SQL Server 数据库架构版本](http://www.codinghelmet.com/?path=howto/sql-schema-versioning)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T18:45:46.477

我在以前的公司所做的是将版本存储在一个包含几个字段（主要版本、次要版本、构建和应用日期）的表中，以便我可以了解更新的历史记录。在表上设置适当的权限足以防止篡改。

如果您真的想让 DBA 难以阅读，您可以将这些值作为加密字符串存储在表中。这样，只有您现在才知道如何解码它们。

# asp.net - asp.net数组/数组列表错误

> ID：10196911
> 
> 赞同：0
> 
> 时间：2012-04-17T18:30:25.657
> 
> 标签：asp.net, vb.net, arrays, loops, arraylist

我正在做一些相对简单的事情（或者我认为），需要一些帮助。

我正在尝试创建动态数量的逗号分隔字符串。

我有一个变量（numberOfStrings），它是我需要的不同字符串的数量。我只想循环通过 aryDrivers 然后分配给不同的字符串。

```
Dim aryHeats(numberOfStrings - 1) As ArrayList

Dim aryDrivers() As String
aryDrivers = txtBatch.Text.Split(",")

For i As Integer = 0 To aryDrivers.Length - 1
    For j As Integer = 0 To aryHeats.Length - 1
        aryHeats(j).Add(aryDrivers(i) & ",")
    Next
Next 
```

出于某种原因，当我尝试“添加”字符串时，我在循环中遇到错误。

想法？

谢谢！

* ***更新 **

也许这将有助于解释更多我正在尝试做的事情。我有一个字符串：

s = A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X, Y,Z

我正在传递一个变量（numberOfHeats）让我们使用 4。

然后我想有4个字符串（所以我想使用数组）

```
ary(0) = A,E,I,M,Q,U,Y
ary(1) = B,F,J,N,R,V,Z
ary(2) = C,G,K,O,S,W
ary(3) = D,H,L,P,T,X 
```

希望这可以解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T20:00:52.790

你可以使用[LINQ](http://msdn.microsoft.com/en-us/library/bb397910.aspx)，虽然[我讨厌 VB.NET 方法语法](https://stackoverflow.com/a/9039282/284240)：

```
Dim text = "A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z"
Dim numberOfHeats = 4
Dim aryHeats As String()() = s.Split(","c).
        Select(Function(w, index) New With {.Word = w, .Index = index}).
        GroupBy(Function(x) x.Index Mod numberOfHeats).
        Select(Function(grp) grp.Select(Function(x) x.Word).ToArray()).
        ToArray() 
```

**解释**：它采用初始字符串并将其拆分为单词（逗号作为分隔符）。然后它将字符串数组中的单词和相应的索引转换为具有`Word`和`Index`作为属性的匿名类型。此列表将按`Index Mod numberOfHeats`（您想要的数组数量）分组。这隐含地按您想要的结果排序。最后一步是将组转换为锯齿状数组。

结果：

```
(0) 
    (0) "A" 
    (1) "E" 
    (2) "I" 
    (3) "M" 
    (4) "Q" 
    (5) "U" 
    (6) "Y" 
(1) 
    (0) "B" 
    (1) "F" 
    (2) "J" 
    (3) "N" 
    (4) "R" 
    (5) "V" 
    (6) "Z" 
(2)     
    (0) "C" 
    (1) "G" 
    (2) "K" 
    (3) "O" 
    (4) "S" 
    (5) "W" 
(3) 
    (0) "D" 
    (1) "H" 
    (2) "L" 
    (3) "P" 
    (4) "T" 
    (5) "X" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:42:21.103

试试这个

```
Dim aryHeats(numberOfStrings - 1) As ArrayList

Dim aryDrivers() As String
aryDrivers = txtBatch.Text.Split(",")

For i As Integer = 0 To aryDrivers.Length - 1
    aryHeats(  i Mod aryHeats.Length  ).Add(aryDrivers(i) & ",")

Next 
```

# html - 可调节高度的粘性页脚

> ID：10196914
> 
> 赞同：2
> 
> 时间：2012-04-17T18:30:38.513
> 
> 标签：html, css, sticky-footer

我试图在我的页面上有一个粘性页脚，但与我以前看到的相比有所不同。

页脚的顶部始终在内容后 50 像素处保持粘性，而绿色则填充页脚的其余部分，直到页面结束。

[您可以在http://enviro2012.tapagecommunication.com](http://enviro2012.tapagecommunication.com)上查看示例

如果您单击页面底部 Facebook 插件中的“发送”按钮，问题会更好地说明。

如果您需要更多信息，请告诉我！:)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T11:59:37.073

我以前有过这个。我尝试了各种方法，包括根据页脚的垂直位置检查窗口高度，然后将页脚高度设置为差异。它在大多数浏览器中的效果都不算太差。

然而，最简单（也是快速渲染）的解决方案是在页脚中添加足够的底部填充以覆盖大多数窗口大小的间隙。假设您的内容总是会填满页面的大部分，那么几百像素应该就足够了——并且在页面第一次加载时就可以正确呈现。

# php - 循环遍历 PHP 中的 Unix 时间戳范围内的所有日子

> ID：10196915
> 
> 赞同：3
> 
> 时间：2012-04-17T18:30:42.543
> 
> 标签：php, loops, strtotime

假设你有两个这样的 Unix 时间戳：

```
$startDate = 1330581600;
$endDate = 1333170000; 
```

我想遍历该范围内的每一天并输出如下内容：

```
Start Loop
   Day Time Stamp: [Timestamp for the day within that loop]
End Loop 
```

我已经尝试寻找某种类型的功能来做到这一点，但我不确定它是否可能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T18:35:19.017

因为我喜欢 DateTime、DateInterval 和 DatePeriod，所以这是我的解决方案：

```
$start = new DateTime();
$end   = new DateTime();

$start->setTimestamp(1330581600);
$end->setTimestamp(1333170000);

$period = new DatePeriod($start, new DateInterval('P1D'), $end);

foreach($period as $dt) {
  echo $dt->format('Y-m-d');
  echo PHP_EOL;
} 
```

起初这似乎令人困惑，但这是一种非常合乎逻辑的方法。

使用[DatePeriod ，您可以定义间隔为 1 天的期间的开始和结束（在](http://php.net/manual/en/class.dateperiod.php)[DateInterval](http://php.net/manual/en/class.dateinterval.php)查找格式），然后您可以对其进行迭代。
最后，在每次迭代中，您都会返回一个可以使用的[DateTime 对象](http://php.net/manual/en/class.datetime.php)`DateTime::format()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:38:50.237

```
for ($t = $start; $t < $end; $t = strtotime('+1 day', $t)) {
    ...
} 
```

# asp.net-mvc - 如何在区域的 MVC 中保护 Elmah

> ID：10196920
> 
> 赞同：1
> 
> 时间：2012-04-17T18:30:57.490
> 
> 标签：asp.net-mvc, elmah

嗨，我正在尝试确保 elmah 只能从名为 admin 的 mvc 区域内访问：/admin/area

我已将以下内容添加到路由配置的顶部，以便它们首先出现：

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
routes.IgnoreRoute("admin/elmah.axd/{*pathInfo}"); 
```

并在 system.web 和 system.webServer 下的 web.config 中有以下内容：

```
 <handlers>
     ...
      <add verb="POST,GET,HEAD" path="/admin/elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
    </handlers> 
```

然而我不断得到：

```
The controller for path '/admin/elmah.axd' could not be found. 
```

似乎路线没有被忽略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:46:22.807

Elmah.MVC [nuget](http://nuget.org/packages/Elmah.MVC/)可能会有所帮助。

在版本 2.0.0（例如[1.3.2](http://nuget.org/packages/Elmah.MVC/1.3.2)）之前，它添加了一个名为“admin”的区域，并在其中添加了一个名为“elmah”的控制器。因此，您可以从 web.config 中删除带有“elmah.axd”的处理程序，并且仍然可以在“/admin/elmah”上访问 elmah。然后，您可以通过将 autorizeattribute 添加到 elmah 控制器来保护这条路线。

在版本 > 2.0.0 中，它已更改为不添加名为 admin 的区域。相反，您可以在“/elmah”上访问 elmah。版本 > 2.0.0 还会自动从您的 web.config 中删除 elmah.axd。

# c# - 运行 Visual Studio 调试。该进程无法访问该文件，因为它正被另一个进程使用

> ID：10196924
> 
> 赞同：1
> 
> 时间：2012-04-17T18:31:08.317
> 
> 标签：c#, visual-studio-2010

当我第二次运行我的解决方案时，出现此错误：

错误 467 无法将文件“obj\x86\Debug\uil.dll”复制到“bin\x86\Debug\uil.dll”。该进程无法访问文件“bin\x86\Debug\uil.dll”，因为它正被另一个进程使用。

对于工作，我需要关闭并重新打开解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:40:27.283

我在 VS2010 中发现了一个错误，该错误涉及引用多个项目的解决方案，其中您至少有一个 WPF 控件库。打开 WPF 设计器时，项目引用的 DLL 被锁定。因此，尝试编译将发出该错误。

如果这是您遇到的情况，则没有解决方案 AFAIK，但作为解决方法： 1\. 确保关闭所有 WPF 打开的设计器 2\. 全部重建，然后清理解决方案，然后再次构建。这在大多数情况下都有效

或者，在 VS2010 的 XML 编辑器中打开 XAML 文件，因此不会加载设计器。我通常直接写 XAML。如果您必须编写更复杂的 XAML，请与 VS2010 并排打开 Blend，这样您就可以在 Blend 中编辑 XAML，并在 VS2010 中编译和调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:33:45.210

您确定要停止运行应用程序的实例吗？您需要停止正在开发的应用程序（调试或发布模式）才能开始调试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:36:05.400

1.  检查以确保您的应用程序仍在任务管理器中运行，如果是，请将其杀死。
2.  从项目属性中禁用“Visual Studio 托管进程”。

# image - 修复图像大小而不重新调整大小

> ID：10196926
> 
> 赞同：8
> 
> 时间：2012-04-17T18:31:26.700
> 
> 标签：image, html, image-processing, resize, slideshow

我有一个`div`这是`width:500px;`和`height:170px;`

`div`包含一个**jquery**幻灯片，它从我的数据库中获取随机图像并显示它们。

问题是图像是由用户上传的，可以是任何**宽高比**/**任何尺寸**。

我需要图像适合`div`而不使用调整大小

```
style='height:x; width:x; 
```

基本上，我希望所有图像都能以真实的质量正确显示。

我不想限制可以上传哪些尺寸的图像，因为它们以全尺寸/质量显示在网站的其他部分。

任何人都可以提供解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T18:44:41.210

您可以使用 CSS 设置幻灯片中图像的大小，而不必更改图像的纵横比。

*   将图像的高度设置为幻灯片容器的高度

*   使宽度自动，以保持其纵横比

*   设置最大宽度，使其不会比幻灯片更宽

```
幻灯片.img{
    高度：170 像素
    width:auto;/*保持纵横比*/
    最大宽度：500px；
}

```

请注意，如果原始尺寸很小，图像可能会比幻灯片更薄。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T18:47:34.290

您应该能够使用 CSS 的`max-width`属性。如果您这样做，您将不想指定宽度或高度。

您的 HTML：

```
<div id="yourContainer">
    <img src="imagePath" />
</div> 
```

还有你的 CSS：

```
#yourContainer {
    width: 500px;
    height: 170px;
}

#yourContainer img {
    max-width: 100%;
    max-height: 100%;
} 
```

这不会使您的图像在容器内居中，但它应该可以为您完成工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-07-29T00:35:35.737

我已经想出了如何使用简单的 CSS 代码来完成图像调整大小保持纵横比和居中图像，如下所示：

```
width: auto !important; /*Keep the aspect ratio of the image*/
height: 140px !important;
margin: 0 auto 1em auto; /*Center the image*/ 
```

希望这对某人有帮助:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-19T10:25:27.947

使用下面的高度和宽度组合

```
style="height:271px; max-height: 336px; max-width:336px; width: 263px;" 
```

# java - JSlider 替代品

> ID：10196928
> 
> 赞同：4
> 
> 时间：2012-04-17T18:31:36.573
> 
> 标签：java, swing, floating-point, awt, jslider

我刚刚意识到 JSlider 无法处理浮点数。任何人都可以推荐一个 Swing/AWT 替代品吗？

编辑：或者一些描述的解决方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T18:47:06.847

滑块通常处理数字范围。从实际实现来看，每个滑块必须有两个元素：

1.  一个起始位置。
2.  有限数量的“下一个”增量。

给你带来麻烦的是“有限的数字”。如果没有有限数量的增量，滑块就无法适应屏幕。对于有限数量的增量，不可能选择`float`位于两个增量“步骤”之间的数字。

简而言之，这是不可能的；所以，这是解决方法：

1.  确定输入的“浮点”端的范围。这可能是`0.0f`to`10.0f`或其他，没关系，但你必须有一个范围。
2.  确定您希望支持的最小增量。这可能是`0.1f`或`0.001f`其他，没关系，但你必须有一个增量。
3.  创建一对函数。一种采用 Slider 整数值并将它们“映射”到浮点值，另一种采用浮点值并将它们“映射”到 Slider 值。

一个例子，`5.0f`用于`10.0f`增加`0.1f`：

```
((10.0f - 5.0f) / 0.1f) + 1 = 51 increments (0 to 50)

updateSlider(float value) {
  if (value > 10.0f) {
    Slider.setValue(50);
  } else if (value < 5.0f) {
    Slider.setValue(0);
  } else {
    Slider.setValue((int)Math.round((value - 5.0f)/0.1f));
  }
}

float updateFloat(Slider slider) {
  int value = slider.getValue();
  return 5.0f + (slider.getValue() * 0.1f);
} 
```

# php - 从数据库中检索图像并在页面上显示所有图像

> ID：10196929
> 
> 赞同：0
> 
> 时间：2012-04-17T18:31:42.513
> 
> 标签：php, image, upload, phpmyadmin

我有 5 个附件，其路径存储在数据库 (5) 列中。我正在为第一个文件检索如下路径。

```
$path1=$rowArray['file1'];
$path2=$rowArray['file2'];
<?php printf('<a href="%s" >View all Files</a>',$path1); ?> 
```

第一个文件的路径在哪里`$path1`，通过单击查看所有文件，图像显示在下一页上。

我想在查看所有文件链接下的同一页面上显示所有 5 张图像。

我该怎么做。希望大家理解。我已经应用了一个循环来显示它们，但它没有帮助。请为此提供一个有效的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:38:10.363

毫无疑问，您无法按照自己的方式进行操作，只需一个链接即可显示所有图像。我想最好的方法是在你的 URL 上发送文件名或 ID，并在你的目标 PHP 上检查它，这样你就可以显示它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:38:54.023

为此，您需要 javascript，将鼠标悬停在链接上会创建一个带有 image/s 的 div，其中 src 属性将是链接的路径。

# .net - 浮点计算中的估计误差

> ID：10196932
> 
> 赞同：0
> 
> 时间：2012-04-17T18:31:47.700
> 
> 标签：.net, floating-point, double

IEEE 浮点数学的一项重要属性是，由于位数有限和 base-2 格式，舍入会导致计算中的“错误”。

例如在 C# 中：

```
(Math.PI * 1e20 / 1e20) == Math.PI; // false 
```

有没有办法确定这些操作的误差大小？.NET 公开了[`Double.Epsilon`](http://msdn.microsoft.com/en-us/library/system.double.epsilon.aspx)给出大于零的最小有效值的字段，但这与比较非零数字无关。

编辑：我不是要一种方法来*精确*计算误差，我只是想找到一种方法来估计它的大小。

例如（同样，在 C# 中）：

```
(1e20 + 1e3) == 1e20; // true
(1e20 + 1e4) == 1e20; // false 
```

因此，操作的误差`1e20 + X`似乎约为 1e3，这是有道理的，因为`doubles`具有多达 17 位的十进制精度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T20:20:59.363

你需要的是机器 epsilon（你可以计算）而不是最小的（denorm）正数：见 [http://www.johndcook.com/blog/2010/06/08/c-math-gotchas/](http://www.johndcook.com/blog/2010/06/08/c-math-gotchas/)奇怪的命名约定。

一旦有了机器 epsilon，您就知道（根据 IEEE 标准）任何基本代数运算 *、+、/、- 的相对误差最多为 epsilon，即 x flop y = (x op y)(1+三角洲）其中：

*   flop 是浮点运算，例如浮点加法
*   op 是实数算术中的对应运算
*   delta 是相对舍入误差，以 |delta| 为界 <= ε

# java - 在 Eclipse IDE 中设计 Java Swing GUI 的最简单方法是什么？

> ID：10196933
> 
> 赞同：2
> 
> 时间：2012-04-17T18:31:48.417
> 
> 标签：java, eclipse, swing, user-interface, ide

我一直在手动编写 Java 中的基本 UI 并使用 NetBeans，但最近切换到了 Eclipse Indigo。我使用可视类构建器在 Eclipse 中设计 SWT 用户界面，但发现它非常缓慢且滞后。显示更改大约需要四秒钟，并且几乎不可能有效地构建复杂且大型的 UI。这是它的常见行为吗？这是在 Eclipse 中构建 Java Swing GUI 的首选方式吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T20:49:54.433

由于 Google 收购了 Instantiations，然后将[WindowBuilder](http://www.eclipse.org/windowbuilder/)捐赠给**Eclipse基金会，它是****Swing、SWT 和 GWT**首选的免费、开源可视 GUI 编辑器。

![在此处输入图像描述](../Images/bd0b91a37748271fa21f8fc27382e2d8.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-02T07:41:57.390

您也可以使用[Jigloo](http://www.cloudgarden.com/jigloo/)。

他们的eclipse更新站点吧，[http://cloudgarden.com/update-site](http://cloudgarden.com/update-site)

我已经很好地在Windows中使用了它。但是当我在mac中使用它时，大多数时候它会崩溃。

但windows builder对我来说似乎更好。

# unit-testing - 测试控制器有意义吗

> ID：10196935
> 
> 赞同：5
> 
> 时间：2012-04-17T18:31:52.267
> 
> 标签：unit-testing, spring-mvc, junit, testng

我有一个简单的 MVC 应用程序，由 View->Controller->Service->Model 组成。

我的控制器真的很瘦。他们所做的只是调用服务方法并填充 ModelAndView。对控制器进行单元测试以确保它们在完全模拟服务的同时在 ModelAndView 中设置所需的属性是否被认为是一种好习惯？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T18:43:10.090

在某些时候，即使测试控制器也不会有害 - 然后您可以确定它们正在调用正确的服务方法，正确传递（修改 - 如果需要）请求参数并返回正确的 ModelAndView。

# javascript - 选择下拉列表项jquery的值

> ID：10196938
> 
> 赞同：1
> 
> 时间：2012-04-17T18:32:00.443
> 
> 标签：javascript, jquery, html, drop-down-menu

**HTML**

```
<select id="selectDepartment">
  <option value="1">120</option>
  <option value="2">20</option>
  <option value="3">140</option>
  <option value="4">4120</option>
  <option value="5">560</option>
  <option value="6">451</option>
  <option value="7">310</option>
  <option value="8">656</option>
  <option value="9">444</option>
  <option value="10">555</option>
  <option value="11">2560</option>
  <option value="12">450</option>
</select> 
```

**jQuery**

```
$("#selectDepartment").change( function() {

alert($("select option:selected").val()); 

}); 
```

当我选择任何一个选项时，上述函数总是在警报时显示值**1**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T18:34:31.267

您查找选择选项的方法含糊不清。你说的是“抓住所有`<select>`的东西”。`:select`然后，您继续从每个（页面上的所有`<select>`s）中获取ed 选项。继续，`.val()`从顶部取出第一个值。

简而言之，您总是获取页面*上第一个* `<select>`找到的选定值。假设`#selectDepartment`不是第一个`<select>`，你的价值永远不会改变。

尝试将范围保持在当前`<Select>`使用范围内`this`：

```
$('#selectDepartment').change(function(){
  var selopt = $('option:selected',this);
}); 
```

请注意，我将范围指定为`<select>`触发`.change()`. 另请注意，这确实不是必需的，`val()`因为它很容易工作：

```
var selopt = $(this).val(); 
```

让 jQuery 完成繁重的工作。`option:selected`如果您想要控制特定元素的样式，或者您正在使用多选并想要更多控制，您真的只需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:38:33.713

你可以这样做：

```
$("#selectDepartment").change( function() {

     var selected = $(this).find(":selected");

}); 
```

# c# - 在类似 StringBuilder 的 C 模块中增加多少缓冲区？

> ID：10196942
> 
> 赞同：19
> 
> 时间：2012-04-17T18:32:06.117
> 
> 标签：c#, java, c, stringbuilder

在 C 语言中，我正在研究一个管理字节缓冲区的“类”，允许将任意数据附加到末尾。我现在正在研究自动调整大小，因为底层数组使用对`realloc`. 这对于曾经使用过 Java 或 C# 的任何人都应该是有意义的`StringBuilder`。我了解如何进行调整大小。但是有没有人有任何建议，并提供了理由，关于每次调整大小增加*多少缓冲区？*

显然，在浪费空间和过多的 realloc 调用（这可能导致过多的复制）之间需要进行权衡。我看过一些建议加倍的教程/文章。如果用户设法提供一个好的初始猜测，这似乎是一种浪费。是否值得尝试在平台上四舍五入到对齐大小的两倍或倍数？

有谁知道 Java 或 C# 在后台做什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-17T19:05:11.280

在 C# 中，用于增加 StringBuilder 使用的内部缓冲区的策略随着时间的推移发生了变化。

解决这个问题有三种基本策略，它们具有不同的性能特征。

第一个基本策略是：

*   制作一个字符数组
*   当你用完空间时，创建一个包含更多字符的新数组，用于某个常数 k。
*   将旧数组复制到新数组，并孤立旧数组。

这种策略有很多问题，其中最明显的是，如果正在构建的字符串非常大，则时间为 O(n ² )。假设 k 是一千个字符，最终的字符串是一百万个字符。您最终将字符串重新分配到 1000、2000、3000、4000...，因此复制了 1000 + 2000 + 3000 + 4000 + ... + 999000 个字符，总计复制了 5000 亿个字符！

这种策略有一个很好的特性，即“浪费”的内存量以 k 为界。

在实践中，由于存在 n 平方问题，这种策略很少使用。

第二个基本策略是

*   做一个数组
*   当你的空间用完时，创建一个包含更多字符的新数组，用于某个常数 k。
*   将旧数组复制到新数组，并孤立旧数组。

k% 通常为 100%；如果是，那么这就是所谓的“双满”策略。

该策略具有很好的特性，即其*摊销*成本为 O(n)。再次假设最终字符串是一百万个字符，而您从一千个字符开始。您以 1000、2000、4000、8000... 复制，最终复制 1000 + 2000 + 4000 + 8000 ... + 512000 个字符，总计复制了大约 100 万个字符；好多了。

该策略的特性是，*无论您选择什么百分比，摊销成本都是线性的。*

这种策略有许多缺点，*有时复制操作非常昂贵*，并且*您可能会在未使用的内存中浪费多达 k% 的最终字符串长度*。

第三种策略是制作一个数组链表，每个数组的大小为 k。当您溢出现有数组时，会分配一个新数组并将其附加到列表的末尾。

这种策略有一个很好的特性，即没有任何操作特别昂贵，总浪费的内存以 k 为界，并且您不需要能够定期在堆中定位大块。它的缺点是最终将事物转换为字符串可能会很昂贵，因为链表中的数组可能具有较差的局部性。

.NET 框架中的字符串生成器曾经使用双时满策略；它现在使用块链表策略。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-17T18:45:18.387

您通常希望保持增长因子略小于黄金平均值 (~1.6)。当它小于黄金分割时，丢弃的段将足够大以满足稍后的请求，只要它们彼此相邻。如果你的生长因子大于黄金分割，那是不可能的。

我发现将因子减小到 1.5 仍然可以很好地工作，并且具有易于在整数数学中实现的优点（`size = (size + (size << 1))>>1;`——使用一个体面的编译器，您可以将其编写为`(size * 3)/2`，它仍然应该编译为快速代码）。

我似乎记得几年前在 Usenet 上的一次谈话，其中 Dinkumware 的 PJ Plauger（或者可能是 Pete Becker）说他们会进行比我做过的更广泛的测试，并得出了相同的结论（所以，对于例如，`std::vector`他们的 C++ 标准库中的实现使用 1.5)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T18:41:24.083

在使用扩展和收缩缓冲区时，您想要的关键属性是按您的大小的倍数增长或收缩，而不是恒定的差异。

考虑您有一个 16 字节数组的情况，将其大小增加 128 字节是多余的；然而，如果你有一个 4096 字节的数组并且只增加了 128 字节，你最终会复制很多。

我被教导总是将数组加倍或减半。如果您真的没有关于大小或最大值的提示，那么乘以 2 可确保您在很长一段时间内拥有大量容量，除非您在资源受限的系统上工作，否则最多分配两倍的空间不是太可怕了。此外，将事物保持在 2 的幂可以让您使用位移和其他技巧，并且底层分配通常是 2 的幂。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T18:47:01.303

> 有谁知道 Java 或 C# 在后台做什么？

查看以下链接，了解它是如何在 JDK11 的 Java 的 StringBuilder 中完成的，特别是 ensureCapacityInternal 方法。 [https://java-browser.yawk.at/java/11/java.base/java/lang/AbstractStringBuilder.java#java.lang.AbstractStringBuilder%23ensureCapacityInternal%28int%29](https://java-browser.yawk.at/java/11/java.base/java/lang/AbstractStringBuilder.java#java.lang.AbstractStringBuilder%23ensureCapacityInternal%28int%29)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T18:45:08.200

将其翻译为 C。

我可能会保留一份`List<List<string>>`清单。

```
class StringBuilder
{
   private List<List<string>> list;

   public Append(List<string> listOfCharsToAppend)
   {

       list.Add(listOfCharsToAppend);
   }

} 
```

这样，您只需维护列表列表并**按需分配**内存，而不是提前分配内存。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T19:31:44.400

.NET 框架中的列表使用此算法：如果指定了初始容量，则创建此大小的缓冲区，否则在添加第一项之前不分配缓冲区，它分配的空间等于添加的项数，但是不少于4个。当需要更多空间时，它会分配2倍先前容量的新缓冲区，并将所有项目从旧缓冲区复制到新缓冲区。早期的 StringBuilder 使用了类似的算法。

在 .NET 4 中，StringBuilder 分配构造函数中指定大小的初始缓冲区（默认大小为 16 个字符）。当分配的缓冲区太小时，不进行复制。相反，它将当前缓冲区填充到边缘，然后创建 StringBuilder 的新实例，该实例分配大小为 *MAX(length_of_remaining_data_to_add, MIN(length_of_all_previous_buffers, 8000))* 的缓冲区，因此至少所有剩余数据都适合新缓冲区和所有缓冲区的总大小至少翻了一番。新的 StringBuilder 保持对旧 StringBuilder 的引用，因此各个实例创建缓冲区的链接列表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-17T18:37:09.170

根据[文档](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)，它是特定于实现的，但从 16 开始：

> 此实现的默认容量为 16，默认最大容量为 Int32.MaxValue。
> 
> StringBuilder 对象可以在实例的值放大时分配更多的内存来存储字符，并相应地调整容量。例如，Append、AppendFormat、EnsureCapacity、Insert 和 Replace 方法可以放大实例的值。
> 
> 分配的内存量是特定于实现的，如果所需的内存量大于最大容量，则会引发异常（ArgumentOutOfRangeException 或 OutOfMemoryException）。

基于其他一些 .NET 框架的东西，我建议每次达到当前容量时将其乘以 1.1。如果需要额外的空间，只需有一个等价物`EnsureCapacity`将手动将其扩展到必要的大小。

# delphi - 了解 SharedMem

> ID：10196943
> 
> 赞同：1
> 
> 时间：2012-04-17T18:32:06.713
> 
> 标签：delphi, delphi-xe2, firemonkey

晚上好，伙计们！

我目前正在使用 Firemonkey/FMX 设计具有各种功能的桌面界面。这些功能之一是能够在“面板”内显示信息。这个“面板”由一个`title`和`context`（两者`tlabel`）和一个`image`（`timage`）组成。为希望与我的应用程序交互的每个“应用程序”创建一个面板。每个面板都是在使用调用过程创建它时分配的变量创建时命名的，该变量旨在允许其他开发人员轻松访问他们的面板，但存在可能被利用的风险，因此我可能会切换到`bindingname`.

我已经编写了基于变量创建这些面板之一的代码，以及基于嵌套迭代`.children`和`FindComponent`循环将类型转换为标签和图像级别的代码，并且我可以自由更改标签的文本或使用此方法的图像（带有`.loadfromfile`）（即代码有效）。但是，由于我想向其他应用程序和开发人员开放此功能以在这些“面板”之一中实际显示信息，因此我需要使用共享内存。

问题是我真的无法理解。我读过的所有内容都暗示使用 SharedMem 很容易，但我根本无法理解。即使是 XE2 包含的示例中的简单示例也让我感到困惑。不幸的是，尽管我多次尝试掌握它，但我根本不了解 IPC。我可以使用 inifile，但我觉得它们不需要灵活性。我考虑`GlobalAtomTable`过，但与 SharedMem 一样，我也不明白这一点，更不用说据报道它在 Delphi 中泄漏了。

本质上，我正在寻找一个函数/过程，我首先在其中创建共享内存区域。然后，我真的在寻找一个函数来从该共享内存中读取一个字符串并输出该字符串以`result`供我通过其他过程或函数访问。由于我想让我的其他项目与这个项目兼容，我还希望获得一个过程/函数来将值从单独的应用程序写入共享内存。

正如我所说，我不了解 IPC 或 SharedMem，我真的需要一个基本的起点，我可以从中工作和自学，直到更高级的水平。非常感谢我希望学习的逐步演练。我想学习这一点，而不是仅仅获得一堆代码，因为我现在应该使用 IPC 几乎是理所当然的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T19:33:15.193

看看[Cromis IMC 或 IPC 组件](http://www.cromis.net/blog/2012/04/cromis-library-updated/)。

[IMC](http://www.cromis.net/blog/downloads/cromis-imc/)用于使用 tcp (indy) 进行机器间通信，而IPC[用于](http://www.cromis.net/blog/downloads/cromis-ipc/)使用 windows 命名管道进行进程间通信。

两者都使用相同的客户端/服务器消息系统（基于数据包），因此您不必详述 Windows 文档来实现您的应用程序。

只需按照上面链接中的示例进行操作，您的应用程序就会立即运行。顺便说一句，作者[`Iztok Kacin`](https://stackoverflow.com/users/118765/runner)是 SO 成员。

# ruby-on-rails - Mongoid querying inclusion Array

> ID：10196964
> 
> 赞同：0
> 
> 时间：2012-04-17T18:33:32.893
> 
> 标签：ruby-on-rails, mongodb, mongoid

I am implementing user setting in my rails website where a user has control over who can send him notifications. The allowed classed of users who can send him information is stored in an array and can be set by the user.

How do I query users to send the notification according to the user type of the user who sent the post.

I want to do something like this.

```
notifiable_users = User.all.or("notification_setting.posted_by" includes "sender.user_type") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:41:16.143

Assuming `notification_setting.posted_by` is an array for the allowed user types and `sender.user_type` is the user_type(singular, not an array) of sender, you can simply do:

```
notifiable_users = User.all.or("notification_setting.posted_by" => sender.user_type) 
```

If it is the other way around:

```
notifiable_users = User.all.or("notification_setting.posted_by".to_sym.in => sender.user_types) 
```

# java - 创建 Deque 类方法

> ID：10196973
> 
> 赞同：0
> 
> 时间：2012-04-17T18:33:50.020
> 
> 标签：java

我需要编写自己的 Deque 类，并且必须使用双向链表实现来存储数据。问题是编写方法 pushfromLeft(Thing thing) 将插入双端队列的左侧。以下是我迄今为止所拥有的，但似乎不起作用。

```
 public void pushLeft(Thing thing) {
         Node beg = new Node();  
         Node end = new Node();
         Node T = new Node();  

       if(isEmpty())
       { 
             beg = first;
             end = last;
             beg = end;
             T = beg.thing;
             N++;
       }
       else
       {
             beg = beg.next;
             end = end.next;
             T = beg.previous;
             N++;

       } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T18:34:53.117

您在该方法中所做的很少有任何外部影响，除了更改`N`and `item`。大概你应该修改`first`. 如果您提供类的字段以及它们的含义，这将有所帮助。例如，不清楚是什么`item`。

您还应该提出不同的命名成员和局部变量的约定，或者始终使用`this.`，或两者兼而有之。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:53:01.297

我是否可以提出一个建议，可以为您解决很多问题。这不是你要求的，但它可能是你需要的。

使用OO设计，这意味着不是对某事进行操作，而是要求某事对自己进行操作。这意味着 Node 应该更智能——目前你正在对 node 进行操作。

由于 Node 是双重链接的，它可以非常聪明！它可以有如下方法：

```
newNode.insertBefore(currentNode)
newNode.insertAfter(currentNode) 
currentNode.remove() 
```

一旦你有了这些，你的其余代码应该清理一下。给定一个双向链表，它们应该很容易实现。

```
void insertBefore(node existing) {
    // first set my stuff up
    previous = existing.previous;
    next = existing;
    // then point other stuff at me
    previous.next = this; 
    existing.previous = this;
} 
```

我想——这只是我的想法。

另一个问题是你如何处理你的“端点”。您的第一个和最后一个指针必须是 Node 的实例才能工作，但如果他们注意到整个“If”因素超出了您的原始代码！甜的！

只是总是有一个第一个和最后一个对象开始指向彼此（并且从不接受值）。当您进行第一次添加时，执行 first.insertAfter() 或 last.insertBefore() 即可完成。

顺便说一句，另一种可能性是使列表循环 - 没有理由 First 和 Last 不能是同一个“特殊”未分配节点，您仍然可以遍历它的 Next （这将为您提供第一个真正的项目在列表中）和上一个（为您提供列表中的最后一项）。

当迭代整个列表时，如果 .value == null，你知道你已经到达了另一端，这使得 node.next() 和 previous() 非常容易实现（你甚至不需要实现 .接下来，但见下文。

```
/** returns null if there are no more items in the list */
Node next() {
    return next;
} 
```

试试看，它会大大简化你的代码。大多数人真的不明白实际的 OO 代码有多么有用。

此外，将所有变量设为私有，这是一个好习惯。在这种情况下，当您让节点相互操作时，它们仍然可以访问彼此的私有成员（不像听起来那么脏），因此您仍然可以像我写的那样拥有 insertBefore 并且您不必拥有 getter 和设置器或公共变量。两全其美。

还要注意在节点上“操作”的原始类几乎消失了——事实上，它可以完全消失。如果您需要一些特定的方法，例如 find(item) 或 insertSorted(item) ，则没有理由不能将它们添加到节点本身。不过，在您实施它之前，这可能很难看到。

有趣的是，如果您实际上编码得很好，那么人们对 Java 的大多数抱怨都不会出现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T19:01:29.227

您绝对不需要创建多个`Node`内部添加方法。如果您想稍后从左侧和右侧读取，则每个都`Node`必须记住上一个和下一个元素。然后在添加的时候，只需要重新定位这些链接，像这样：

```
public void pushLeft(Thing thing) {
   Node newNode = new Node();  
   newNode.setValue(thing); //or just   newNode.value = thing;

   if(this.isEmpty())
   { 
         this.first = this.last = newNode;
         this.n=1;
   }
   else
   {
         this.first.previous = newNode;
         newNode.next = this.first;
         this.first = newNode;
         this.n++;
   }
} 
```

为 Node 类创建一个应该自动设置值的构造函数是明智的，然后你可以写：

```
Node newNode = new Node(thing); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T18:39:26.320

您是否查看过[LinkedList](http://developer.classpath.org/doc/java/util/LinkedList-source.html)源代码作为参考？

# javascript - 在 Windows Media Player 嵌入式网页对象中跳转

> ID：10196975
> 
> 赞同：1
> 
> 时间：2012-04-17T18:34:01.263
> 
> 标签：javascript, internet-explorer, windows-media-player

我的网站中有一个嵌入式 Windows Media Player 对象，我想让它在页面加载时跳到某个点。大多数网站建议使用：

```
mediaplayerID.controls.currentPosition=xxx 
```

这在 Chrome 中效果很好，但 IE 会抛出一个 JavaScript 错误，指出 mediaplayerID 未定义。我假设问题是脚本在媒体播放器对象完全加载之前运行——在视频开始播放之后，我可以在开发者工具控制台中运行设置 currentPosition，它会像它应该的那样向前跳过。JavaScript中有没有办法检测何时（或等到）媒体播放器被加载然后改变位置？

# javascript - 如何防止 Require.js 优化器在优化文件中包含文本插件？

> ID：10196977
> 
> 赞同：20
> 
> 时间：2012-04-17T18:34:06.320
> 
> 标签：javascript, optimization, requirejs

**tl;dr：当我的所有文本依赖项都内联时，如何将 text.js 插件排除在优化文件之外？**

我正在使用[Require.js 优化器](http://requirejs.org/docs/optimization.html)（通过 Node）来优化我项目中的一些 JS 文件。我正在使用[文本插件](http://requirejs.org/docs/api.html#text)来加载文本依赖项（HTML 模板、CSS）。我有一个要优化的模块，包括它的依赖项，如下所示：

```
define(['text!core/core.css'], function(styles) {
    // do setup stuff, return an object
}); 
```

Require.js 文档说，`core/core.css`当我运行优化器时，该文件将被内联`r.js`，我正在像这样调用它：

```
$ r.js -o baseUrl=./src name=core out=release/test.js

Tracing dependencies for: core
Uglifying file: c:/path/release/test.js

c:/path/release/test.js
----------------
c:/path/src/text.js
text!core/core.css
c:/path/src/core.js 
```

好消息是，这行得通。当我查看优化后的文件时，我可以看到内联文本，如下所示：

```
define("text!core/core.css",[],function(){return"some CSS text"}),
define("core",["text!core/core.css"],function(a){ ... }) 
```

坏消息是，text.js 插件也包括在内——它增加了大约 3K，并且由（据我所知）现在完全不需要的用于加载外部文本文件的代码组成。我知道 3K 并不多，但我正在努力使我的代码保持高度优化，据我所知，如果我的文本依赖项是内联的，则根本不需要文本插件的代码。我可以通过添加`exclude=text`到我的`r.js`调用中来阻止文本插件，但是如果我这样做了，当我尝试在浏览器中使用优化代码时，我会收到一个错误，提示无法加载 text.js 插件。

所以：

1.  有什么理由在这里**实际上需要**text.js 插件吗？

2.  如果没有，是否有可以修复此行为的**配置选项**，或者`r.js`

3.  text.js 插件是否有一个**简单**的填充程序，我可以包含它来说服 Require.js 加载了不必要的插件？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-18T16:23:38.630

文本插件确实是必需的，因为 RequireJS 需要`normalize`在检索正确的模块 ID 之前检查插件是否实现了该方法。

从构建中删除文本插件的方法是使用该`onBuildWrite`设置创建一个空插件模块，如本问题评论所述：[https](https://github.com/jrburke/r.js/issues/116#issuecomment-4185237) ://github.com/jrburke/r.js/issues/116#issuecomment-4185237 -此功能应该会出现在 r.js 的未来版本中

**编辑：**

r.js 现在有一个名为的设置`stubModules`正是这样做的：

```
//Specify modules to stub out in the optimized file. The optimizer will
//use the source version of these modules for dependency tracing and for
//plugin use, but when writing the text into an optimized layer, these
//modules will get the following text instead:
//If the module is used as a plugin:
// define({load: function(id){throw new Error("Dynamic load not allowed: " + id);}});
//If just a plain module:
// define({});
//This is useful particularly for plugins that inline all their resources
//and use the default module resolution behavior (do *not* implement the
//normalize() method). In those cases, an AMD loader just needs to know
//that the module has a definition. These small stubs can be used instead of
//including the full source for a plugin.
stubModules : ['text'] 
```

有关更多 r.js 选项，请查看[example.build.js](https://github.com/jrburke/r.js/blob/master/build/example.build.js)文件。

# jquery - jQuery cycle() 幻灯片的间歇性定位问题

> ID：10196979
> 
> 赞同：2
> 
> 时间：2012-04-17T18:34:22.090
> 
> 标签：jquery, css, jquery-cycle

这在 Chrome、Firefox 中会间歇性发生，尤其是在 Safari 中。在IE中没有观察到。幻灯片显示从顶部比通常更远，但按预期运行。在硬刷新时更频繁地发生，使其看起来像 document.ready() 问题。

页面在这里： http: [//privatecare.dreamhosters.com/](http://privatecare.dreamhosters.com/)

正确负载：

![正确的负载](../Images/1c6624bf41081afcc00a078a68fe3bfb.png)

不正确的负载：

![不正确的负载](../Images/884740b9c7c15f45667244655f9d00ce.png)

jQuery初始化：

```
<script src="http://code.jquery.com/jquery-latest.js"  type="text/javascript"></script>
<script type="text/javascript" src="js/jquery.cycle.all.latest.js"></script> 

<script type="text/javascript">
  $(document).ready(function(){
    $('#homeSlides').cycle({ 
      fx: 'fade', 
      speed:  2500
    });
  });
</script> 
```

HTML：

```
<div id="homeSlides">
<img src="/g/home/slide1.jpg" alt="Connecting You to Better Care" width="639" height="348" onclick='window.location="/why_choose_pca"' />
<img src="/g/home/slide2.jpg"  width="639" height="348" alt="Updates on DOL’s Proposed Amendments to Companionship and Live-In Worker Regulations" border="0"  onclick='window.location="/dol-issue-updates"'  />
<img src="/g/home/slide3.jpg" alt="Promoting the Rights of Independent Caregivers and Registries Since 1977" width="639" height="348" onclick='window.location="/caregivers"' />
<img src="/g/home/slide4.jpg" alt="The Consumer-Directed Model Puts You in Control" width="639" height="348" onclick='window.location="/comparing_your_options"' />
<img src="/g/home/slide5.jpg" alt="Join us in Orlando October 10 – 12 for the PCA Annual Conference" width="639" height="348" onclick='window.location="/annual-conference"' />
</div> 
```

CSS

```
#homeWrapper {
    position:relative;
    margin:0 auto;
    width:951px;
    background: url(../g/home_bg.jpg) no-repeat;
    min-height:888px;
}

#homeSlides {
    position:absolute;
    left:290px;
    top: 143px;
    width:639px;
    height:348px;
    overflow:hidden;
    cursor:pointer;
} 
```

有人以前见过这个或有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:59:45.297

我最好的猜测是，这是某种奇怪的比赛条件。在循环插件中，有一个区域可以检查您指定的元素 ( `#homeSlides`) 是否具有非静态位置。如果没有，循环将应用以下 CSS（宽度和高度值显然特定于您的实现）：

```
position: relative; width: 639px; height: 348px; 
```

此 CSS 应用于元素的内联样式属性，该属性会覆盖您在样式表中声明的样式。如果你可以让它在 Chrome 中中断，检查一下，`#homeSlides`你会看到内联样式。禁用内联`position: relative;`并观察它移动到正确的位置。

您可以通过简单地添加`!important`到`position: absolute;`main.css 中的声明来解决此问题。

在循环插件完成初始化后，您也可以通过在 javascript 中将位置设置为绝对来修复它。

**编辑：**

看看[这个问题](https://stackoverflow.com/questions/1324568/is-document-ready-also-css-ready)。您应该删除该重要声明并在所有脚本之前包含所有 CSS 文件。该脚本在 CSS 有时间应用之前执行。

# jsf - 在托管 bean 构造函数中访问注入的依赖项会导致 NullPointerException

> ID：10196982
> 
> 赞同：12
> 
> 时间：2012-04-17T18:34:43.747
> 
> 标签：jsf, constructor, nullpointerexception, managed-bean, managed-property

我正在尝试将 DAO 作为托管属性注入。

```
public class UserInfoBean {

    private User user;

    @ManagedProperty("#{userDAO}")
    private UserDAO dao;

    public UserInfoBean() {
        this.user = dao.getUserByEmail("test@gmail.com");
    }

    // Getters and setters.
} 
```

DAO 对象是在创建 bean 之后注入的，但它`null`在构造函数中，因此会导致`NullPointerException`. 如何使用注入的托管属性初始化托管 bean？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-17T18:39:43.147

注入只能在施工*后进行，*因为施工前没有符合条件的注入目标。想象一下下面这个虚构的例子：

```
UserInfoBean userInfoBean;
UserDao userDao = new UserDao();
userInfoBean.setDao(userDao); // Injection takes place.
userInfoBean = new UserInfoBean(); // Constructor invoked. 
```

这在技术上根本不可能。实际上，以下是正在发生的事情：

```
UserInfoBean userInfoBean;
UserDao userDao = new UserDao();
userInfoBean = new UserInfoBean(); // Constructor invoked.
userInfoBean.setDao(userDao); // Injection takes place. 
```

您应该使用带有注释的方法在构造*和*[`@PostConstruct`](http://docs.oracle.com/javaee/6/api/javax/annotation/PostConstruct.html)依赖注入之后直接执行操作（例如通过 Spring bean、、、、等）。*`@ManagedProperty``@EJB``@Inject`*

 *```
@PostConstruct
public void init() {
    this.user = dao.getUserByEmail("test@gmail.com");
} 
```*

# json - 我正在尝试从由 url 创建的 json 数组填充 DOJO 饼图

> ID：10196986
> 
> 赞同：1
> 
> 时间：2012-04-17T18:34:56.270
> 
> 标签：json, dojo, pie-chart

我正在尝试从由 url 创建的 json 数组填充 dojo 饼图。

url 返回一个看起来像这样的数组

> {"pieItems":[["IPv4 TCP",475919493840],["IPv6 TCP",37443255432],["IPv4 UDP",34595392128],["IPv6 ICMP",14496],["IPv4 ICMP",46560] ,["IP 其他",12385112]]}

我试图重做数组的格式，将其更改为如下所示的格式

> {"IPv4 TCP":[475919493840],"IPv6 TCP":[37443255432],"IPv4 UDP":[34595392128],"IPv6 ICMP":[14496],"IPv4 ICMP":[46560],"IP 其他" ：[12385112]} 。

我用来更改格式的代码是：

```
var len = responseObj.pieItems.length, i, hash = {};
    for (i = 0; i < len; i++) {
        hash[responseObj.pieItems[i][0]] = responseObj.pieItems[i][1];
    } 
```

更改格式后，我只能通过添加系列并指定名称来填充图表。

> chart1.addSeries("IP 其他", hash["IPv6 ICMP"])

这会用该项目填充图表，但如果我尝试添加另一个系列，例如

> chart1.addSeries("IP 其他", hash["IPv4 其他"])

它会覆盖图表并显示 IP Other 的数据，而不是添加另一个切片。

如何将数组中的所有项目添加到饼图中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:31:36.703

根据定义，饼图仅支持一个系列对象。您应该为不同的切片添加不同的数据点。草图：

```
chart.addSeries("IP", dojo.map(responseObj, function(p){
  return {
    y:    p[1], // value
    text: p[0]  // label
  };
}); 
```

# javascript - 没有为 html5 2D 画布存储图像

> ID：10196987
> 
> 赞同：1
> 
> 时间：2012-04-17T18:34:58.177
> 
> 标签：javascript, canvas

图片： http: [//oi43.tinypic.com/qzou2r.jpg](http://oi43.tinypic.com/qzou2r.jpg)

我正在学习如何编写一个简单的 2D 平铺引擎，而我学得最好的方法之一是尝试制作相同的程序，但以不同的方式，然后对其进行修补。任何人，我都在关注本教程：[http](http://that-guy.net/articles/2/Javascript-tile-engine-map-with-images/) ://that-guy.net/articles/2/Javascript-tile-engine-map-with-images/我的代码不起作用，它说文件身份不明或其他什么用错误填满画布。他的第一个教程（之前的那个）我可以用我设置应用程序的方式让它工作，但由于某种原因这种方式不起作用。我有点知道问题是什么，但不确定如何解决它，我想知道你们是否可以提供帮助。生病评论我认为有问题的部分：* * *

```
var engine = {
outhnd: document.getElementById('output'),
canvas: document.getElementById('canvas'),
handle: this.canvas.getContext('2d'),
width: this.canvas.width,
height: this.canvas.height,
tilesX: this.canvas.width / 16,
tilesY: this.canvas.height / 16,
images: 0, // *** I think this is what is causing the problem with the TILESTORE.

output: function (message) {
    engine.outhnd.innerHTML += '<br />' + message;
},
start: function (mapData, x, y) {
    engine.handle.translate( 0, 8 );
    engine.output('starting...');
    engine.viewport.x = x;
    engine.viewport.y = y;

    engine.tilestore('g', 'tile_grass.png');
    engine.tilestore('r', 'tile_rockgrass.png');
    engine.tilestore(' ', 'tile_black.png');

    engine.draw(mapData);
    engine.output('done');
},
viewport: function () {
    var x = 0;
    var y = 0;
},
allLoaded: function () {
    var i, len = engine.images.length;
    for(i=0; i<len; i++) {
        if(engine.images[i][2] === false) {
            return false;
        }
    }
    return true;
},
draw: function (mapData) {
    if(engine.allLoaded() === false){
        setTimeout(function(md)
    {
     return function() {
        engine.output('[engine.draw] waiting for images...');
        engine.draw(md);
    }
    }(mapData), 100);
    }else{
        engine.drawmap(mapData);
    }

},
drawmap: function (mapData) {
    var i, j;

    var mapX = 0;
    var mapY = 0;
    var tile;

    engine.output('drawing map from ' + engine.viewport.x + ',' + engine.viewport.y + ' to ' +
    (engine.viewport.x + engine.tilesX) + ',' + (engine.viewport.y + engine.tilesY));
    for(j=0; j<engine.tilesY; j++) {
        for(i=0; i<engine.tilesX; i++) {
            mapX = i + engine.viewport.x;
            mapY = j + engine.viewport.y;

            tile = (mapData[mapY] && mapData[mapY][mapX]) ? mapData[mapY][mapX] : ' ';
            engine.tiledraw( i, j, tile);
        }
    }
},
tiledraw: function (x,y,tile){
var img = engine.tileretrieve(tile);
    engine.handle.fillText(img, x * 16, y * 16);
},
 //*** the problem ***
tilestore: function(id, imgSrc) {
    var newid = engine.images.length;
    var tile  = [id, new Image(), false];

    tile[1].src    = imgSrc;
    tile[1].onload = function() {
        tile[2] = true;
        }
    engine.images[newid] = tile;
},
tileretrieve: function(id) {
    var i, len = engine.images.length;
    for(i=0; i<len; i++){
        if(engine.images[i][0] == id) {
            return engine.images[i][1];
        }
    }
},
}; 
```

有什么理由为什么这不起作用。为什么它不存储图像。我是 java 脚本的新手，这可能会让自己免于很多麻烦。

编辑：我怎么称呼它：

```
 var mapone =
   [
  ['r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'g', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'r', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
  ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
  ['r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r']
   ];
  engine.start(mapone, 0, 5); 
```

编辑：之前给出了错误的链接：http: [//that-guy.net/articles/2/Javascript-tile-engine-map-with-images/](http://that-guy.net/articles/2/Javascript-tile-engine-map-with-images/)

**编辑** 如果有人感兴趣，我有我写的工作代码，我会在这里为任何想学习新方法的人发帖。感谢大家尝试提供帮助。

```
var image_holder = function () {

    this.image_id =     0;  // 'a','b', etc
    this.image_src =    0;  // the source
    this.image_type =   0;  // 0 or 1
    this.image_load =   0;  // is it loaded 0 = false 1 = true
    this._head =        null;
};
image_holder.prototype = {

add: function (image_id, image_src, image_type, image_load) {

    var node = {
        image_id:image_id,
        image_src:image_src,
        image_type:image_type,
        image_load:image_load,
        next:null
    },
    current;

        if (this._head === null) {
            this._head = node;
        } else {
            current = this._head;

            while (current.next) {
                current = current.next;
            }   
            current.next = node;
        }

        this.image_id = image_id;
        this.image_src = image_src;
        this.image_type = image_type;
        this.image_load = image_load;

        },
get: function (image_id, image_load) {
    var current = this._head;

    if(image_id != null && image_load == null) {
        while (current != null && current.image_id != image_id) {
                current = current.next;
            }
            if(current != null){
                return current;
                }
            return null;
        }

    if(image_id == null && image_load != null) {
        while (current != null && current.image_load != image_load) {
                current = current.next;
            }
            if(current != null)
                return current;
            return null;
        }
    },
};

var engine = {
    outhnd: document.getElementById('output'),
    canvas: document.getElementById('canvas'),
    handle: this.canvas.getContext('2d'),
    width: this.canvas.width,
    height: this.canvas.height,
    tilesX: this.canvas.width / 16,
    tilesY: this.canvas.height / 16,
    obj: new image_holder(),

output: function (message) {
    engine.outhnd.innerHTML += '<br />' + message;
},
start: function (mapData, x, y) {
    engine.handle.translate( 0, 8 );
    engine.output('starting...');
    engine.viewport.x = x;
    engine.viewport.y = y;

    var images0 = "tile_grass.png";
    var images1 = "tile_rock.png";
    var images2 = "tile_black.png";

    imageObject0 = new Image();
    imageObject0.src = images0;
    imageObject0.onload = function() {
                        engine.obj.add('g', imageObject0, 0, 1);
                        var b = engine.obj.get('g').image_id;
                        console.log(b);
                                imageObject1 = new Image();
                                imageObject1.src = images1;
                                imageObject1.onload = function() {
                                engine.obj.add('r', imageObject1, 0, 1);
                                        imageObject2 = new Image();
                                        imageObject2.src = images2;
                                        imageObject2.onload = function() {
                                        engine.obj.add(' ', imageObject2, 0, 1);
                                        engine.draw(mapData);
                                        engine.output('done');
                                        };                              
                                };
                        };
},
viewport: function () {
    var x = 0;
    var y = 0;
},
draw: function (mapData) {
    engine.drawmap(mapData);
},
drawmap: function (mapData) {
    var i, j;
    var mapX = 0;
    var mapY = 0;
    var tile;

    engine.output('drawing map from ' + engine.viewport.x + ',' + engine.viewport.y + ' to ' +
    (engine.viewport.x + engine.tilesX) + ',' + (engine.viewport.y + engine.tilesY));
    for(j=0; j<engine.tilesY; j++) {
        for(i=0; i<engine.tilesX; i++) {
            mapX = i + engine.viewport.x;
            mapY = j + engine.viewport.y;

            tile = (mapData[mapY] && mapData[mapY][mapX]) ? mapData[mapY][mapX] : ' ';
            engine.tiledraw( i, j, tile);
        }
    }
},
tiledraw: function (x,y,tile){
    var img = engine.obj.get(tile,null).image_src;
    engine.handle.drawImage(img, x * 16, y * 16);
},
};

CALL:

        var mapone = [
        ['r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'g', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'r', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
        ['r', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'g', 'r'],
        ['r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r', 'r']];
        engine.start(mapone, 0, 5); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:58:46.907

是的，'images=0' 是不对的。它只需要是一个数组。

```
images = [], 
```

第二个问题是您没有调用正确的画布方法。将您的 tileDraw 方法更改为：

```
tiledraw: function (x,y,tile){
var img = engine.tileretrieve(tile);
    engine.handle.drawImage(img, x * 16, y * 16);
}, 
```

您仍然将其设置为 fillText。

当您进入下一个教程时，您似乎只是忘记更新那部分代码。

F12为了以后对你有帮助，会打开大部分浏览器的开发者工具（你需要在FireFox上安装FireBug）。控制台选项卡将显示带有行号的 JavaScript 错误，以帮助您进行调试。您甚至可以设置断点来对代码进行故障排除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:55:10.630

我相信您遇到的问题是因为您实例化`images = 0` 然后稍后尝试 `var newid = engine.images.length;` 这是试图获取图像数组的长度，但图像当前持有一个 int。也许尝试实例化图像 `images = []`

# php - 将函数传递给PHP中的另一个页面

> ID：10196988
> 
> 赞同：1
> 
> 时间：2012-04-17T18:35:00.093
> 
> 标签：php

所以这一直困扰着我一段时间，我想将存储在函数中的计算传递到另一个页面，我可以传递字段条目没有问题（对不起，我是 PHP 新手）但是我如何传递我的计算：

// 计算部分 (calculator.php) - 这是每个页面上的包含 计算是由每个页面上包含的用户条目进行的

//thank-you.php 页面输出感谢评论并发送电子邮件我收到所有其他信息都很好，但该功能不会在我的电子邮件中通过。计算的输出也存储在calculator.php 中，它是include，但它输出到屏幕上很好，而不是我的电子邮件:(。

我错过了什么吗？

抱歉（编辑）这是我的代码：

```
<?php
error_reporting(E_ALL);

if(isset($_POST['name']) && isset($_POST['to'])){

ini_set('date.timezone', 'Europe/Madrid');
$now = date("H:i");

$cutoff = "06:00";
$higherthan = "22:00";

    $name = $_REQUEST['name'];
$telephone = $_REQUEST['telephone'];
$from = $_REQUEST['from'];
$to = $_REQUEST['to'];
$date = $_REQUEST['date'];
$returndate = $_REQUEST['returndate'];
$people = $_REQUEST['people'];
$return = $_REQUEST['return'];
$myemail = $_REQUEST['myemail'];

include_once('includes/config.php');

$settingsSql = mysql_query("SELECT * FROM transfers_in WHERE location='$to' AND no_passengers='$people'");
$settings        = mysql_fetch_assoc($settingsSql);

echo "From: ".$from." To: ".$settings['location']."<br />";
echo "Number of passengers: ".$settings['no_passengers']."<br />";

ini_set('date.timezone', 'Europe/Madrid');
$now = date("H:i");

$cutoff = "06:00";
$higherthan = "22:00";

echo "Time cost: ".$settings['price']." euros<br /><hr />Total: ";

    function timeCost() {

        $to = $_REQUEST['to'];
        $people = $_REQUEST['people'];
        $return = $_REQUEST['return'];

        include_once('includes/config.php');

        $settingsSql = mysql_query("SELECT * FROM transfers_in WHERE location='$to' AND no_passengers='$people'");
        $settings        = mysql_fetch_assoc($settingsSql);

        //echo $return;

        if ($return == "No"){
            if ((strtotime($now) < strtotime($cutoff)) || (strtotime($now) > strtotime($higherthan))){
                echo number_format($settings['price']) + 1.40;
            } else {
                echo number_format($settings['price']) + 0.00;
            }
        } elseif ($return == "Yes") {
            if ((strtotime($now) < strtotime($cutoff)) || (strtotime($now) > strtotime($higherthan))){
                echo number_format($settings['price']) * 2 + 1.40;
            } else {
                echo number_format($settings['price']) * 2 + 0.00;
            }
        }

        echo " in euros<br /><br />";   
    }

    echo timeCost();

} else { ?>

<form method="POST" action="thank-you.php" name="chooseDateForm" id="chooseDateForm">
            <label>Name:</label>
            <input type="text" value="" name="name" />

            <label>Telephone:</label>
            <input type="text" value="" name="telephone" />

            <label>Email:</label>
            <input type="text" value="" name="myemail" />

            <label>From:</label>
            <select name="from">
                <option selected="selected">Malaga</option>
            </select>
            <div class="clr"></div>

            <label>To:</label>
            <select name="to">

<?php foreach ($data as $place => $price){
    echo "<option>{$place}</option>\n";
}
echo '</select>
            <div class="clr"></div>

            <label>Date:</label>
            <input type="text" value="dd/mm/yyyy" id="date" name="date" class="date-pick" />
            <span id="calendar"></span>

            <div id="return-journey">
                <label>Return Date:</label>
                <input type="text" value="dd/mm/yyyy" id="returndate" name="returndate" class="date-pick" />
                <span id="calendar"></span>
            </div>

            <label>Number of people:</label>
            <select id="people" name="people">
                <option value="4">4</option>
                <option value="6">6</option>
                <option value="8">8</option>
            </select>
            <div class="clr"></div>

            <div id="return">
                <label>Is this a return<br />journey?</label>
                <div class="clr"></div>
                <div id="radio-buttons">
                    <input type="radio" name="return" value="Yes" class="radio returning" />Yes<br />
                    <input type="radio" name="return" value="No" class="radio" checked />No
                </div>
            </div>
            <div class="clr"></div>

            <input type="submit" name="submit" class="fauxButton" />            

        </form>';
}
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T18:37:43.197

如果您使用会话，您可以将变量、结果、数组——任何内容存储到会话变量中，然后在新页面上检索它。

```
session_start();
$_SESSION['test_var'] = 'Jake'; 
```

然后，当我导航到新页面并检索 var 时：

```
 session_start();
echo $_SESSION['test_var'] 
    // outputs 'Jake' 
```

# c# - 如何在 asp.net mvc 3 应用程序中管理视图管理

> ID：10196989
> 
> 赞同：1
> 
> 时间：2012-04-17T18:35:01.407
> 
> 标签：c#, .net, asp.net-mvc-3, frameworks, views

我不确定这是否适合我的问题，但我会试一试。

我们正在开始开发一种新产品，它将使用 asp.net mvc 3 razor 作为表示层。该应用程序有大约 7-8 个不同的角色，所有角色都有不同的视图来显示数据。我在 NHibernate 的帮助下构建了一个不错的框架并实现了一些设计模式，因此应用程序的这一面将很容易调整和应用维护。

我希望表示层与我的框架一样具有自适应性，这就是为什么我试图找出一种方法来尽可能少地为所有不同类型的角色提供视图但具有完整的功能。您使用哪种实现方式根据最终用户的角色向其分发视图？

我考虑过使用 jquery 模板，但是鉴于当前的视图可能性和剃刀语法，这听起来有点不必要，而不是首选的方式。

在开发这个应用程序时我应该记住的任何信息都会很好，想想，常见的错误，最佳实践和建议等。

期待您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:19:39.150

减少视图数量的一种方法是`IsInRole()`结合局部视图使用（或等效的，如果您有一些自定义）。在最简单的情况下，您可以拥有一个视图，该视图还根据特定角色在其中呈现部分视图。类似于以下内容：

```
@if (HttpContext.Current.User.IsInRole("admin")) {
    @Html.Partial("_StuffForAdmins")
} 
```

根据您的情况，一些部分视图可以在多个不同角色之间共享，从而减少重复代码。所有角色都可以公开访问的用户界面元素可以直接放置在视图本身上，而无需进行角色检查。

编辑：另一种语法是：

```
 <div>
        @if (Context.User.IsInRole("admin"))
        {
            @Html.Partial("_StuffForAdmins")
        }
    </div> 
```

# asp.net-mvc - MVC 3 401 在托管服务器上未经授权

> ID：10196991
> 
> 赞同：3
> 
> 时间：2012-04-17T18:35:19.077
> 
> 标签：asp.net-mvc, asp.net-mvc-3, iis-7, http-status-code-401

我有一个 MVC 3 应用程序，当我尝试从远程服务器访问它时出现 401 错误，但是当我从本地计算机运行它时，它运行时没有任何错误。

远程服务器将 IIS 7 配置为允许表单和匿名访问并成功提供静态文件（内容文件），只有当我尝试访问 MVC 应用程序时才会遇到问题。

当我浏览到 MVC 应用程序时，我收到一条提示：“Windows 安全 - 服务器需要用户名和密码。警告：此服务器请求以不安全的方式发送您的用户名和密码（基本身份验证没有安全连接）。”

我试过输入所有我能想到的密码，但没有任何东西可以让我访问。

当我单击取消时，我收到一条服务器错误消息，显示“401 - 未经授权：由于凭据无效，访问被拒绝。您无权使用您提供的凭据查看此目录或页面。” 我已被重定向到`LogOn`页面

我的 Web.config 文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?> 
<!-- 
  For more information on how to configure your ASP.NET application, please visit 
  http://go.microsoft.com/fwlink/?LinkId=152368 
  --> 
<configuration> 
  <configSections> 
    <section name="razorJSSettings" type="RazorJS.Configuration.RazorJSSettings, RazorJS" /> 
  </configSections> 
  <connectionStrings> 
    <!--<add name="ApplicationServices" 
         connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true" 
         providerName="System.Data.SqlClient" />--> 
    <add name="ApplicationServices" connectionString="Data Source=SOURCE; Initial Catalog=thedb; User ID=thedbuser; Password='thedbuserpassword';" /> 
    <add name="GestmeDataContext" connectionString="metadata=res://*/Models.Gestme.csdl|res://*/Models.Gestme.ssdl|res://*/Models.Gestme.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=SOURCE;initial catalog=thedb;persist security info=True;user id=thedbuser;password=thedbuserpassword;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /> 
  </connectionStrings> 
  <appSettings> 
    <add key="webpages:Version" value="1.0.0.0" /> 
    <add key="ClientValidationEnabled" value="true" /> 
    <add key="UnobtrusiveJavaScriptEnabled" value="true" /> 
  </appSettings> 
  <system.web> 
    <compilation debug="true" targetFramework="4.0"> 
      <assemblies> 
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
        <add assembly="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
        <add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
        <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" /> 
      </assemblies> 
    </compilation> 
    <customErrors mode="Off" /> 
    <authentication mode="Forms"> 
      <forms loginUrl="~/Account/LogOn" timeout="2880" /> 
    </authentication> 
    <membership> 
      <providers> 
        <clear /> 
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" /> 
      </providers> 
    </membership> 
    <profile> 
      <providers> 
        <clear /> 
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/" /> 
      </providers> 
    </profile> 
    <roleManager enabled="true"> 
      <providers> 
        <clear /> 
        <add connectionStringName="ApplicationServices" applicationName="/" name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" /> 
      </providers> 
    </roleManager> 
    <pages> 
      <namespaces> 
        <add namespace="System.Web.Helpers" /> 
        <add namespace="System.Web.Mvc" /> 
        <add namespace="System.Web.Mvc.Ajax" /> 
        <add namespace="System.Web.Mvc.Html" /> 
        <add namespace="System.Web.Routing" /> 
        <add namespace="System.Web.WebPages" /> 
      </namespaces> 
    </pages> 
    <httpHandlers> 
      <add path="razorjs.axd" verb="GET" type="RazorJS.RazorJSHandler" /> 
    </httpHandlers> 
  </system.web> 
  <system.webServer> 
    <httpErrors errorMode="Detailed" />
    <asp scriptErrorSentToBrowser="true"/>
    <validation validateIntegratedModeConfiguration="false" /> 
    <modules runAllManagedModulesForAllRequests="true" /> 
    <handlers> 
      <add name="RazorJSHandler" path="razorjs.axd" verb="GET" type="RazorJS.RazorJSHandler" /> 
    </handlers> 
  </system.webServer> 
  <runtime> 
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1"> 
      <dependentAssembly> 
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" /> 
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="3.0.0.0" /> 
      </dependentAssembly> 
      <dependentAssembly> 
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral" /> 
        <bindingRedirect oldVersion="0.0.0.0-4.0.8.0" newVersion="4.0.8.0" /> 
      </dependentAssembly> 
    </assemblyBinding> 
  </runtime> 
  <razorJSSettings handlerPath="~/razorjs.axd"> 
    <!-- If empty all paths are valid --> 
    <allowedPaths> 
      <add path="~/Scripts" /> 
    </allowedPaths> 
  </razorJSSettings> 
</configuration> 
```

可能导致服务器返回 401 错误的所有问题是什么？可能是从数据库到服务器或`aspnet_*`表的连接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T14:02:25.397

所以，真正的原因有点愚蠢。我在母版页上有一个部分视图，它的`[Authorize]`属性与其操作结果相关联。

以防万一其他人遇到同样的错误！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T18:45:09.730

我相信这是因为您使用的是 AspNetWindowsTokenRoleProvider。这是试图在本地服务器上为用户获取角色，而不是从 Windows 窗体。

您应该指定 SqlRoleProvider。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T04:52:05.843

请转到 IIS 默认网站中的“身份验证方法”并选中“集成 Windows 身份验证”。这可能是工作。

# ssrs-2008 - 判断它是否是 SSRS 报告中图表上的最后一个柱

> ID：10196996
> 
> 赞同：0
> 
> 时间：2012-04-17T18:35:28.477
> 
> 标签：ssrs-2008, reporting-services

如果我在 SSRS 报告中有条形图，我如何判断（使用表达式）它是否是图表的最后一个条形？有没有办法获取索引或位置，或者查看下一个是否为空？

有没有 Chart.bar.index() 之类的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T07:13:50.580

一种方法是检查类别组的当前值是否与最大值相同。例如，如果您的图表从 Dataset1 报告并按 分组`date`，那么您的表达式可能如下所示：

```
=iif(Fields!date.Value=Max(Fields!date.Value, "DataSet1"),"Specific","Default") 
```

# python - 在 Python 中解析防火墙规则

> ID：10196998
> 
> 赞同：1
> 
> 时间：2012-04-17T18:35:59.553
> 
> 标签：python

我正在编写一个脚本来从 Cisco ASA 的配置中解析防火墙规则。

我的输入示例包括：

```
access-list myACL line 1 extended permit tcp host 10.8.13.200 host 10.32.53.22 eq 1122
access-list myACL line 2 extended permit tcp 10.8.13.0 255.255.255.0 host 10.1.206.17 eq 445 
access-list myACL line 3 extended permit udp host 10.8.13.200 eq 54345 host 10.1.206.17 eq 445
access-list myACL line 4 extended permit icmp any any 
```

对于上面的三行，我想要的 .csv 格式的输出如下。但是，这些也可以是要存储在数据库中的元组。

```
#aclName,lineNumber,action,protocol,sourceIP,sourcePort,destIP,destPort
myACL,1,permit,tcp,10.8.13.200,*,10.32.53.22,1122
myACL,2,permit,tcp,10.8.13.0/24,*,10.1.206.17,445
myACL,3,permit,udp,10.8.13.200,54345,10.1.206.17,445
myACL,4,permit,icmp,*,*,*,* 
```

我在选择这个项目的方法时遇到了麻烦。我查看了许多选项，包括 ats、shlex，甚至只是使用正则表达式，但我很难确定最佳选项是什么。PLY 在这里有帮助吗？

什么是合适的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:51:19.490

如果只需要输出 CSV 目标，我建议您使用最熟悉的方法。如果这是一次性/临时的事情，我进一步推荐任何能让你最快完成它的方法。

如果是我——我可能会使用正则表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:55:17.727

我会解析防火墙字符串`.split(" ")`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T19:06:12.620

前 6 个字段似乎是相当可预测的，这使得端点可以有多种表示形式。一种可能性是（未经测试的代码，但我希望你明白）：

```
parts = rule.split(" ")
aclName, _, lineNumber, _, action, protocol = parts[:6]
endpoints = parts[6:]

def get_endpoint(eps):
    host, port = "*", "*"
    if eps[0] == "host":
        host = eps[1]
        eps = eps[2:]
    elif eps[0] == "any":
        eps = eps[1:]
    else:
        host = eps[0] + "/" + mask_to_bits(eps[1])
        eps = eps[2:]

    if eps and eps[0] == 'eq':
        port = eps[1]
        eps = eps[2:]
    return host, port, eps

sourceIP, sourcePort, endpoints = get_endpoint(endpoints)
destIP, destPort, endpoints = get_endpoint(endpoints) 
```