# StackOverflow 问答 000465000-000465999

# spring - 我应该将 Maven 项目的应用程序配置文件放在哪里？

> ID：465001
> 
> 赞同：10
> 
> 时间：2009-01-21T11:59:42.520
> 
> 标签：spring, maven-2

我正在使用[Maven Application Assembler](http://mojo.codehaus.org/appassembler/index.html)插件从我的 Java 项目中生成独立的可执行文件。应用程序读入配置文件，包括 Spring 文件。Application Assembler 插件有一个选项（默认激活）将 etc/ 目录添加到应用程序的类路径，但是我应该怎么做才能让插件将我的配置文件复制到这个目录？

或者更一般地说，在 Maven 中，不应打​​包在工件中的应用程序配置文件的犹太洁食位置在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T13:09:13.653

您还可以使用资源过滤： [http ://maven.apache.org/guides/getting-started/index.html#How_do_I_filter_resource_files](http://maven.apache.org/guides/getting-started/index.html#How_do_I_filter_resource_files)

开启过滤：

```
...
<build>
...
<resources>
      <resource>
        <directory>src/main/resources</directory>
        <filtering>true</filtering>
      </resource>
    </resources>
...
</build>
... 
```

在 src/main/resources 下创建一个文件，例如：application.properties

应用程序属性

```
configprop.1=${param1}
configprop.2=${param2} 
```

然后设置一个配置文件并可能在 settings.xml 中设置一些属性，根据这是开发版本还是生产版本设置不同的属性。见：[http ://maven.apache.org/guides/introduction/introduction-to-profiles.html](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)

我设置了不同的属性，具体取决于这是构建服务器、开发还是生产部署

mvn -Denv=dev || mvn -Denv=dev-build || mvn -Denv=生产

maven 链接有一个很好的描述。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-02-23T06:42:29.597

对于最近接触到这一点的人来说，自 Application Assembler Plugin 版本 1.1 起，可选参数**configurationSourceDirectory**和**copyConfigurationDirectory**。请在下面的示例 POM.xml 提取中找到它们：

```
<configuration>
  <!-- Set the target configuration directory to be used in the bin scripts -->
  <configurationDirectory>conf</configurationDirectory>
  <!-- Copy the contents from "/src/main/config" to the target
      configuration directory in the assembled application -->
  <copyConfigurationDirectory>true</copyConfigurationDirectory>
  <!-- Include the target configuration directory in the beginning of
      the classpath declaration in the bin scripts -->
  <includeConfigurationDirectoryInClasspath>
    true
  </includeConfigurationDirectoryInClasspath>
...
</configuration> 
```

更多信息在[这里](http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/usage-program.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T18:31:35.560

您可以尝试使用 Maven 程序集插件。我将它与 appassembler 插件结合使用。

如果您不想要“等”，请将 appassembler 配置为指向您想要的配置目录的任何名称。程序集插件在其自己的输出目录中组装所有内容，因此我配置程序集插件以将 bin 和 repo 目录从 appassembler 目录复制到其输出目录中，然后我让它复制配置文件（我的在 src/main/config ) 进入预期的配置目录。这有一些重复，因为您正在复制 appassembler 输出，但这并没有真正困扰我。

所以你在执行程序集插件后得到的是你的 bin、repo 和 config dir 都是程序集输出目录下的对等目录。如果您愿意，您可以将其配置为具有不同的结构，我只是希望我的能够镜像 appassembler 结构。

好消息是您还可以配置程序集插件以将二进制文件更改为可执行文件，我无法看到如何使用 appassembler。而且，如果您随后将 appassembler:assemble 和 assembly:single 目标绑定到 package 阶段，您所要做的就是“mvn package”，它会组装所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T13:03:54.433

I don't know if I understand you correctly. But what I have done in the past for a project where I needed to copy configuration files, is use the [Maven AntRun plugin](http://maven.apache.org/plugins/maven-antrun-plugin/index.html). What I did is execute the plugin in the process-resources phase and copied my configuration files to the specified directory using the Ant copy task. The Assembler plugin executes in the package phase so it should pick up your configuration files if you put it in the right place. Hope this answers your question a little bit.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-04T18:01:48.887

我一直在寻找我认为是您的问题的答案，或者至少是一个非常相似的问题。Maven 允许您使用[maven-resources-plugin](http://maven.apache.org/plugins/maven-resources-plugin/index.html)指定资源目录。我的资源目录之一中有一些配置文件。我注意到通过将这些文件的副本放在您提到的 etc/ 目录中（位于我的 CLASSPATH 的开头），我可以更改这些文件中的值以在运行时使用。然后，我希望默认情况下使用资源目录中所有内容的副本创建该 etc/ 目录。maven-resources-plugin的[copy-resources](http://maven.apache.org/plugins/maven-resources-plugin/copy-resources-mojo.html)目标允许我这样做。左侧边栏中的示例 > 复制资源中的这节（我在这篇文章中仅限于 2 个链接）对我有什么帮助：

```
<project>
  ...
  <build>
    <plugins>
      <plugin>
        <artifactId>maven-resources-plugin</artifactId>
        <version>2.6</version>
        <executions>
          <execution>
            <id>copy-resources</id>
            <!-- here the phase you need -->
            <phase>validate</phase>
            <goals>
              <goal>copy-resources</goal>
            </goals>
            <configuration>
              <outputDirectory>${basedir}/target/extra-resources</outputDirectory>
              <resources>          
                <resource>
                  <directory>src/non-packaged-resources</directory>
                  <filtering>true</filtering>
                </resource>
              </resources>              
            </configuration>            
          </execution>
        </executions>
      </plugin>
    </plugins>
    ...
  </build>
  ...
</project> 
```

# linux - 在 Linux 上的 Apache 中设置默认脚本解释器

> ID：465004
> 
> 赞同：1
> 
> 时间：2009-01-21T12:03:48.737
> 
> 标签：linux, apache, cgi

在 Windows 上，以下注册表设置配置 Apache 使用的脚本解释器：

```
HKEY_CLASSES_ROOT\.cgi\Shell\ExecCGI\Command=C:\Perl\bin\perl.exe 
```

这是如何在 Linux 上完成的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T14:23:53.010

要为@Mohit 的好答案添加更多信息：

Unix 对多种语言使用多种解释器。其中一些被称为“shell”，但大多数只是系统的另一种计算机语言。事实上，每个文件都是用某种语言编写的，即使它是 Java 字节码的编译程序集。

文件的前几个字节是“魔法”：它们告诉操作系统如何执行文件。如果前两个字节是“#！”，则操作系统知道该文件需要解释器。然后将第一行到换行符的其余部分用作要执行的命令。该行的第一个“单词”（空格分隔的非空格组）被解释为要运行的绝对文件名，所有其他单词作为命令行参数传递给它。最后一个参数是您正在运行的文件的文件名。

因此，例如，如果您的第一行为

```
#!/bin/tclsh 
```

在文件 /home/user/aaa.tcl

操作系统将使用 /home/user/aaa.tcl 作为命令行参数执行 /bin/tclsh：

```
/bin/tclsh /home/user/aaa.tcl 
```

对于更高级的示例，请尝试以下操作：

```
#! /bin/env perl 
```

在 /home/user/myperlscript

这将执行以下命令：

```
/bin/env perl /home/user/myperlscript 
```

/bin/env 是一个实用程序，它使用 PATH 环境变量查找其第一个参数，然后执行它找到的程序，将其余参数传递给程序。在 env 的帮助下，您可以使用 PATH 找到您的解释器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T12:27:14.087

如果您在谈论 CGI 脚本处理程序。

它设置在每个 CGI 脚本的第一行，我经常使用 TCL 作为 Apache 中的脚本处理程序，因此添加：

```
#!/bin/tclsh 
```

在脚本顶部添加这一行，例如。test.cgi，只要有人请求它，它就会由 TCL shell 执行。

同样，您可以将其设置为

对于 BASH—— **#!/bin/sh**

或者

对于 PERL -- **#!/usr/bin/perl**

**注意：**在您的机器上，shell 二进制可执行文件的路径可能与上述不同。使用以下命令找到它：

```
#which perl 
```

* * *

此外，正如 Max 所建议的，请检查 Apache 是否配置为允许 CGI 脚本在此**[Apache 教程链接中找到相同的详细描述](http://httpd.apache.org/docs/1.3/howto/cgi.html)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T12:17:56.820

**ScriptInterpreterSource**是 Apache 配置设置，仅在 Windows 上受支持。我在 Linux 上配置 Apache 的经验并不丰富，但我认为您应该查看[Script 指令](http://httpd.apache.org/docs/2.2/mod/mod_actions.html)。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2009-01-21T12:06:40.790

Linux下没有注册表。另外，我怀疑你会让 Perl.exe 在 Linux 下运行。

# php - 列出表名

> ID：465014
> 
> 赞同：1
> 
> 时间：2009-01-21T12:06:50.040
> 
> 标签：php, sql-server

我正在尝试将我的 ASPNET 站点迁移到 Django。我当前的所有数据都绑定在共享主机上的 MS SQL Server 中，该主机（有帮助）不支持 python ......我可以使用现有代码导出所有数据，但我也停止使用 Windows。该站点主要编译为 VB.NET，因此我需要安装 Windows 和 Visual Studio，然后弄清楚我要做什么……我不喜欢那个计划。

与其经历*那个*令人头疼的问题，我更愿意使用 PHP 将整个数据库（或一次一个表）导出为 JSON。Python 中的 SimpleJSON 将使其非常容易导入，因此它看起来像是一个计划。

到现在为止还挺好。在 PHP 中，我设法连接到 SQL Server 并执行简单的查询，但我需要一个表列表，以便知道需要复制哪些数据。我想要所有表格，因为大约三年前我重写网站时有遗留表格，我想将这些数据保存在某个地方......

所以第一件事：**有人知道列出所有表的 SQL 查询吗？**

我试过`mssql_query('sp_tables');`了，但这会返回一个奇怪的列表：

```
mydatabasename
mydatabasename
dbo
dbo
syscolumns
syscolumns
SYSTEM TABLE
SYSTEM TABLE 
```

其次：在您看来，最好将每个表转储写入自己的 .json 文件，还是应该将它们保存在一起？

第三：我是不是走错了路？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T12:23:59.053

```
Select table_name from information_schema.tables 
```

对于任何给定的表，您都可以获取元数据

```
sp_help tablename 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T19:48:40.560

您使用以下方式进行查询：

```
SHOW TABLES; 
```

（您需要`DB`在此之前选择。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-13T04:37:34.463

你可以试试这个

```
SELECT * FROM information_schema.tables 
```

# project-management - 错误跟踪最佳实践

> ID：465019
> 
> 赞同：23
> 
> 时间：2009-01-21T12:08:26.637
> 
> 标签：project-management, bug-tracking

在我的公司，这些规则适用：

*   只允许测试人员创建问题。
*   开发人员必须向测试人员发送电子邮件以让他们创建问题。
*   开发人员向技术主管发送电子邮件，让他为他们认为可以解决的问题分配一个问题。
*   开发人员不能将问题分配给其他开发人员（必须向技术主管发送电子邮件）。
*   如果开发人员的问题被其他开发人员的代码阻止，她必须在错误跟踪系统之外解决此问题。
*   只有测试人员可以关闭自己打开的问题。
*   所有任务都必须经过技术主管，以便他可以跟踪问题。
*   与用户界面不直接相关的Bug 不会进入系统（必须外部解决）。

您正在使用什么错误跟踪流程？它对你有用吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2010-09-15T21:08:25.533

![替代文字](https://i.stack.imgur.com/m77qD.jpg)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-21T12:19:53.900

我们使用 BugZilla 进行错误跟踪，并且有如下规则：

*   任何人都可以报告错误，任何微小的变化都应该通过错误跟踪系统。如果是产品中的增强，则应将错误标记为增强，并应遵循错误跟踪系统。

*   任何人都可以将错误分配给其他任何人，这意味着如果错误存在于其他人的代码中，则可以轻松地将问题路由给其他人。可能存在需要在多个地方修复错误的情况，即首先要修复其他人的代码，然后再修复他/她的代码。在这些情况下，错误会被分配给首先需要完成工作的人，然后他/她通过重新分配将错误重新路由给适当的人。

*   如果一个问题出现在多个地方并且后面的代码不同但问题显然是相同的，则会克隆该错误，以便可以单独跟踪所有更改。

*   技术主管负责根据特定修复的需求确定错误的优先级。

*   测试人员/QAE 负责为错误分配严重性，即严重/主要/次要等。

*   所有错误都经过错误跟踪系统。来自客户的错误通过自定义标志单独分类以指示客户错误。客户错误大多存在于较旧的发布版本中，并且为它们创建了补丁，因此，它们是分开的。

通过这种方式，我们确保我们同时跟踪源代码控制系统（即 TFS 顺便说一句）和 Bugzilla 中的所有更改，以便将来需要时可以将任何更改追溯到原始代码更改/所有者。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-21T12:30:44.500

听起来相当复杂。我们大致使用以下流程：

*   公司中的每个人都可以打开一个问题单并将其分配给一个部门。
*   每个部门都有一个“调度员”，负责检查传入工单的有效性并确定它们的优先级。
*   根据部门的做法，调度员会为开发人员分配当前开发周期的票，或者他们自己分配票，优先级最高的优先。
*   当票被解决后，它会返回给打开它的人。此人之后还会执行所有必要的活动，例如通知客户。
*   所有票都保存在一个软件系统中，使这些任务变得容易。如果您收到一张票，您还会收到一封电子邮件通知。

这是一个轻量级的过程，鼓励开发人员对他们的问题负责。

除此之外，无论更改请求的来源和类型如何，我们都为更改软件中的任何内容的过程制定了多项质量保证措施。这尤其包括：

*   在将所有代码签入源代码管理系统之前，必须对其进行审查。这包括必要时由专业审阅者进行的 GUI 和数据库审阅
*   代码在签入之前必须由开发人员自己进行彻底的测试。
*   在每月构建之后，必须再次测试所有更改，以防止由于影响相同代码的多个更改而出现问题。
*   每月构建进入“第一个客户阶段”，仅在少数客户系统中推出。如果此阶段没有显示以前未检测到的错误，则该构建被声明为安全。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-07-28T18:44:25.933

我使用了大量的问题跟踪系统，包括 gnats（啊！）、Bugzilla（稍微少一点啊）、Trac、Jira，现在还有 FogBugz。我最喜欢 Trac，但这可能是因为我不是 FogBugz 的管理员，而且它在当前版本中被严重误用。

让工作流程正确是非常重要的，奇怪的是，它从决定在错误跟踪器中放入什么以及如何标记放入其中的东西开始。一旦你有了客户，所有的开发团队都会真正跟踪三种问题：

1.  真实客户注意到的问题（实时错误）。

2.  当前正在开发的新软件的问题（开发错误）。

3.  我们将来想做的事情（功能）。

当然，这三类问题中的每一类都有自己的优先事项。只是按钮上的拼写错误的“实时错误”可能比阻止公开发布的版本或限制其他开发、测试等的“开发错误”重要得多。

问题的严重性描述了副作用的可怕程度。根据我的经验，这归结为：

1.  该程序正在破坏某些东西。数据，客户被错误地计费，错误的药物被分配。这已经很糟糕了。我曾经在一个系统上工作过，其中一个软件命令将一个液压臂从一名军人的中间收回。这已经很糟糕了。

2.  该程序正在崩溃，我们没有解决方法，但在此期间它并没有破坏任何东西（除了停机）。如果停机导致某些事情被破坏，请使用严重性 #1。

3.  该程序行为不端，但我们有一个确定的解决方法，可以实际使用。

4.  该程序以令人讨厌但不影响结果的方式行为不端。

5.  该程序需要以某种明确定义的方式变得更好：更易于使用、实现新功能、运行更快等。

在这些系统中经常出现的另一个问题是“角色”的概念。应用于问题跟踪系统时，角色归结为允许谁做事。谁来制造问题？谁可以更改状态，谁可以将它们重新分配给另一个用户，谁可以关闭它们等等。

在我与之密切合作的中小型团队中，这套通用规则运行良好：

*   任何人都可以创建问题。创建者可以在创建问题时将问题分配给任何（或大多数）收件人。默认收件人是问题分类小组。开发人员可以通过这种方式记录他们在代码中发现的错误，并将错误分配给他们自己，以跟踪他们更改代码的原因。

*   分类团队开会（在此处指定时间间隔）以评估和分配问题。Triage 团队专门寻找重复的报告，在这种情况下，新问题会“汇总”到现有问题链中；对于现场未复制的问题，分配给 QA 进行复制；以及来自客户的高严重性问题。

*   错误的始作俑者是唯一可以关闭它的人。由 QA 或 CSR 发起的错误报告不能由开发人员关闭。是的，这意味着 CS 和开发团队不同意的错误仍未解决。当人们不同意时，为什么问题跟踪器将问题报告为已解决？如果你想要一个谎言的数字存储库，你有 C-SPAN。

一些团队可能希望将问题从一个部门转移到另一个部门到经理，其他团队可能允许任何团队成员将问题转移到（或返回）另一个团队。这可能归结为管理层的怀疑，或者仅仅是允许谁分配工作时间。

分类过程是关键。Triage 团队本质上是您组织中的任何人，他们决定谁从事什么工作，以及接下来要做什么。让团队定期开会有助于确保不会错过真正重要的事情，并且不会因为疏忽而放弃平凡的事情。如果 Triage 队列中没有任何内容，会议领导者可以取消会议（concall、netmeeting，无论实施如何）。

如果您正在使用 Scrum，那么 Triage 团队可能是 Scrum 主管，他们决定是否将某个问题拉入当前的 sprint，并在它进入积压工作时正确分配优先级。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-21T12:16:50.927

等等，你写：

> 如果开发人员的问题被其他开发人员的代码阻止，她必须在错误跟踪系统之外解决此问题。

所以有一些错误超出了正常的错误流程。然后你有第二个系统来跟踪这些错误，或者这些都是临时的？

听起来您的错误跟踪系统实际上是一个用户缺陷跟踪系统。

它对您有用还是正在寻找替代品？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-21T12:25:36.663

我认为客户也应该能够创建问题，不区分错误报告和功能请求。

问题的分配不应由开发人员自己执行：决定哪些问题必须为下一个版本修复应该是客户和经理的责任。

其他做法可以在Joel Spolsky的[Painless Bug Tracking中找到。](http://www.joelonsoftware.com/articles/fog0000000029.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-21T15:36:07.530

在过去的 10 年中，我使用了几种不同类型的错误跟踪系统，包括无、word 文档、FogBugz、Bugzilla 和 Remedy。FogBugz 是迄今为止最好的一个。在那项工作中，任何人都可以输入错误，并且任何人都可以将错误分配给其他任何人。我发现这很有效，特别是如果我在我的代码中发现了一个小错误。与其花一个小时写电子邮件和填写表格并让其他几个人参与，我可以快速记录我发现并修复了一个错误。这鼓励我输入我发现的所有错误并快速修复它们。如果一个错误需要大量工作，那么我会将其分配给我的经理，以便他可以优先处理我的其他工作。
在我使用 Bugzilla 的工作中，每次创建、分配或更改错误时，都会向所有开发人员和经理发送一封电子邮件。这产生了相反的效果，它阻止了我在系统中查找和输入错误。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-06-05T04:48:29.407

记录错误与速度有关 - 只是调查/复制错误所需的最少信息量

对于网络项目，这归结为：1）描述性错误标题，2）发生错误的页面，3）问题描述+屏幕截图***或***复制问题的分步说明（如果屏幕截图未提供）

屏幕截图非常强大有两个原因：1）一张图片说了一千个字，2）它为错误报告提供了可信度（曾经调查过一个你无法复制的错误并认为“看起来客户又在编造东西”？）

我有一篇博客文章进一步探讨了这个主题：[像专业人士一样记录错误](http://pm4web.blogspot.com/2008/07/logging-bugs-like-pro.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-21T18:11:02.600

我的小商店使用一个非常简单的工作流程：

*   任何人都可以创建问题（我认为不允许这样做是不必要的限制）这包括我们开源项目的客户和用户。
*   变更控制委员会（听起来很花哨，但它只是 QA 负责人和工程主管，以及产品经理）审查新问题并分配修复版本和优先级
*   任何人都可以重新分配错误，向记者提问或传递给其他人进行修复或测试
*   任何人都可以将错误标记为已解决
*   只有 QA 可以关闭错误 - 我们这样做是为了强制验证每个错误修复。

这样，所有内容都会记录在错误跟踪系统中，并且我们通过不限制更新来保持效率。通过这种方式，您最终可能会收到一些“错误垃圾邮件”，但这比在我的经验中制造瓶颈要好。

我们使用 JIRA 作为我们的错误跟踪器 - 可以在 JIRA 中设置各种自定义工作流来强制执行您的特定流程，但我从未发现在较小的组织中需要这样做。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-19T12:09:23.093

> 您正在使用什么错误跟踪流程？

*   测试人员将在开放状态下发布所有错误
*   分配给开发人员
*   开发人员将尝试修复错误 - 已修复
*   错误关闭
*   重新打开错误状态

# c# - 如何在 C# 源代码中的字符串中添加新行？

> ID：465034
> 
> 赞同：9
> 
> 时间：2009-01-21T12:13:31.930
> 
> 标签：c#, syntax

C# 语法中是否有定义新行的方法？（就像在 VB 中一样 _ ）

例子：

代替：

```
string myStr = "very long string" +
"another long string"; 
```

这：

```
string myStr = "very long string \something
another long string" 
```

或者; 编译器是否处理这个并做类似的事情；在这个例子中，“字符串”+“字符串”->“字符串字符串”？

欢迎使用不同的情况，例如当这些字符串是常量时等。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-21T12:16:23.907

编译器将 "ABC" + "DEF" 转换为 "ABCDEF"，因此使用 + 没有成本

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-21T12:15:15.250

您可以使用

```
string myStr = @"very long string
another long string"; 
```

@" 是字符串文字的开头，这种字符串在找到下一个 " 字符之前不会结束。

c# 没有与 vb 中的 _ 字符相同的确切语法。因此，如果您想避免包含新行，则必须手动将字符串连接到不同的行上。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T16:35:55.317

我相信您正在寻找的是 C# 行继续符。

别找了。空无一人。在 C# 中，一行以分号“;”结束 到达了。

因此，正如其他人所提到的，如果要拆分字符串分配，只需使用“+”字符。

```
 namespace Jaberwocky
{
    class Program
    {
        public static void Main(string[] args)
        {
            string s = "Hello World! " +
                "This is a long string " +
                "That continues on and " +
                "on and on and on.";
            Console.WriteLine(s);
            Console.ReadKey(true);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-21T16:20:28.127

应尽可能使用 StringBuilder 来连接字符串，因为它比简单地使用“this”+“that”运行得更快。

# sql-server - 在 ssis 中，如何包含对脚本组件中全局变量的引用？

> ID：465040
> 
> 赞同：3
> 
> 时间：2009-01-21T12:15:32.393
> 
> 标签：sql-server, ssis

我有一个脚本组件需要引用一个全局变量？我想我可以 dtsconfig 文件。如何设置它并从我的脚本组件中读回它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T17:41:34.313

您可以使用

```
Me.Variables.YourVariableName 
```

这仅适用于数据流任务的脚本组件。在脚本任务中，您可以像这样使用：

```
Dts.Variables("YourVariableName").Value.ToString 
```

您只需通过指定值来配置 dts 配置文件中的包变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T14:16:45.410

来自[http://blogs.conchango.com/jamiethomson/archive/2005/02/09/964.aspx](http://blogs.conchango.com/jamiethomson/archive/2005/02/09/964.aspx)：

```
Imports Microsoft.SqlServer.Dts.Runtime
Public Class ScriptMain
  Public Sub Main()
    Dim vars As Variables
    Dts.VariableDispenser.LockOneForWrite("vMyVar", vars)
    vars(0).Value = "Hello World"
    vars.Unlock()
    Dts.TaskResult = Dts.Results.Success
  End Sub
End Class 
```

更多讨论：

[http://www.developerdotstar.com/community/node/313](http://www.developerdotstar.com/community/node/313)

[http://www.developerdotstar.com/community/node/512](http://www.developerdotstar.com/community/node/512)

# svn - 是否可以将 Subversion 存储库作为 Git 子模块？

> ID：465042
> 
> 赞同：158
> 
> 时间：2009-01-21T12:16:05.187
> 
> 标签：svn, git, git-svn

有没有办法在我的 Git 存储库中添加一个 Subversion 存储库作为 Git 子模块？

就像是：

```
git-svn submodule add https://svn.foo.com/svn/proj --stdlayout svn-project 
```

指向`https://svn.foo.com/svn/proj`Subversion 存储库的位置。

我知道有`git-svn`它允许人们与 Subversion 存储库进行交互。所以我在想，也许有一种方法可以检查 Subversion 存储库，`git-svn`然后将其用作子模块。

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2009-01-21T12:47:31.597

不，最好的办法是在专用的 git 存储库中设置 svn 存储库的镜像。

```
git svn clone -s http://subversion.example.com/ mysvnclone
cd mysvnclone
git remote add origin git@example.com:project.git
git push origin master 
```

然后您可以将 git 存储库作为子模块添加到原始项目中

```
cd /path/to/gitproject
git submodule add git://example.com/project.git -- svn-project
git add svn-project
git commit -m "Add submodule" 
```

svn:externals 和 git submodule 之间有一个概念上的区别，如果你从颠覆的角度来处理这个问题，可能会绊倒你。git 子模块与您提供的修订版挂钩。如果“上游”发生变化，那么您必须更新子模块的参考。

因此，当我们与上游颠覆重新同步时：

```
cd /path/to/mysvnclone
git svn rebase
git push 
```

... git 项目仍将使用我们之前提交的原始版本。要更新到 svn HEAD，您必须使用

```
cd /path/to/gitproject/svn-project
git checkout master
git pull
cd ..
git add svn-project
git commit -m"Update submodule" 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-18T14:53:31.923

我刚刚经历了这个。我正在做类似于 rq 的事情，但略有不同。我设置了一台服务器来托管我需要的 svn 存储库的这些 git 克隆。就我而言，我只想要只读版本，并且需要服务器上的裸仓库。

在我运行的服务器上：

```
GIT_DIR=<projectname>.git git init
cd <projectname>.git/
GIT_DIR=. git svn init svn://example.com/trunk
GIT_DIR=. git svn fetch
git gc 
```

这设置了我的裸仓库，然后我有一个 cron 脚本来更新它：

```
#!/usr/bin/python

import os, glob

GIT_HOME='/var/www/git'

os.chdir(GIT_HOME)
os.environ['GIT_DIR']='.'
gits = glob.glob('*.git')
for git in gits:
  if not os.path.isdir(git):
    continue
  os.chdir(os.path.join(GIT_HOME, git))
  if not os.path.isdir('svn/git-svn'):
    #Not a git-svn repo
    continue

  #Pull in svn updates
  os.system('git svn fetch && git gc --quiet')
  #fix-svn-refs.sh makes all the svn branches/tags pullable
  os.system('fix-svn-refs.sh')
  #Update the master branch
  os.system('git fetch . +svn/git-svn:master && git gc --quiet')` 
```

这也需要来自[http://www.shatow.net/fix-svn-refs.sh](http://www.shatow.net/fix-svn-refs.sh)的 fix-svn-refs.sh 这主要受以下启发：[http ://gsocblog.jsharpe.net/archives/12](http://gsocblog.jsharpe.net/archives/12)

我不确定为什么`git gc`这里需要它，但没有它我无法做到`git pull`。

因此，在所有这些之后，您可以按照 rq 的说明使用 git submodule 。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-09T03:40:59.403

目前*git-svn*不支持*svn:externals*。但是还有另外两个工具可以帮助您：

1.  [子Git](http://subgit.com/)

    *SubGit*是服务器端解决方案，它允许 Git 访问 Subversion 存储库，反之亦然。您可以参考文档以获取更多详细信息，但总的来说，使用[SubGit](http://subgit.com/howto/)相当容易：

    ```
    $ subgit configure --layout auto $SVN_URL $GIT_REPO 
    ```

    上面的命令将检测 SVN 项目中的分支布局，然后将创建空的裸 Git 存储库以准备镜像 SVN 项目。您可能会被要求提供凭据，除非这些凭据已经存储在 ~/.subversion 目录的 SVN 凭据缓存中。您还可以调整`$GIT_REPO/subgit/authors.txt`以将 SVN 作者姓名映射到 Git 身份。

    ```
    $ subgit install $GIT_REPO
    $ ... let initial translation complete ... 
    $ TRANSLATION SUCCESSFUL 
    ```

    此时，您已将 Subversion 存储库连接到新创建的 Git 存储库。SubGit 将 SVN 修订版翻译成 Git 提交，`svn commit`并将 Git 提交翻译成 SVN 修订版`git push`。

您需要进一步做的就是让提交者可以使用 Git 存储库。看看[git-http-backend](http://schacon.github.com/git/git-http-backend.html)。然后，您可以将创建的 Git 存储库添加为通常的子模块。SubGit 也可作为 Bitbucket Server 的附加组件使用，请查看[此处](https://marketplace.atlassian.com/plugins/org.tmatesoft.subgit.stash-svn-importer/server/overview)了解更多信息。因此，无需使用任何外部工具，如*git-svn*或任何其他工具。

SubGit 是专有软件，但对小型公司（最多 10 个提交者）、学术和开源项目是免费的。

2.  [SmartGit](http://syntevo.com/smartgit/)

    SmartGit在客户端取代了*git-svn 。*您可以在[此处](http://www.syntevo.com/git-svn/features.html)找到有关其功能的更多信息。

    特别是 SmartGit 确实支持*git 子模块*和*svn:externals*，您可以将它们混合在您的存储库中。

    SmartGit 是专有软件，但可免费用于非商业用途。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-07-18T17:58:11.570

除了 rq 所说的，另一种方法是使用第三方“externals”项目（[http://nopugs.com/ext-tutorial](http://nopugs.com/ext-tutorial)），它更好地模仿了 svn 外部引用的工作方式。使用 externals，您可以跟踪 git 或 svn 存储库，并且将您的更改上游推送到这些存储库看起来更容易。但是，它需要项目成员下载并安装单独的包。

我还没有使用子模块或外部组件；但是，我花了几个小时阅读所有替代方案，看起来外部设备更适合我的需求。Jon Loeliger ( [http://oreilly.com/catalog/9780596520120](http://oreilly.com/catalog/9780596520120) ) 的“使用 Git 进行版本控制”的第 15 章对这些和其他自定义方法进行了精彩的讨论，我强烈推荐。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T18:45:39.627

Piston 正在重写以支持这一点，反之亦然，加上 Subvresion 存储库和 git+git 中现有的 Subversion URL。

查看[活塞 Github 存储库](http://github.com/francois/piston/tree/master)。

不幸的是，它似乎没有被释放。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-22T21:22:56.950

嗯，有`git-remote-testsvn`，所以我想像

```
git submodule add testsvn::http://www.telegraphics.com.au/svn/bzquips/trunk/ \
    module/bzquips 
```

应该管用。可以？

# .net - 服务器意外重启时自定义服务无法启动？

> ID：465049
> 
> 赞同：0
> 
> 时间：2009-01-21T12:17:23.593
> 
> 标签：.net, service, startup

我创建了一个服务，它的作用是将信息写入 xml 文件。

有时，它似乎主要发生在计划外重新启动时，服务无法启动，因为使用的文件被“锁定”。由于我的服务设置为“自动启动”，因此系统仍在启动时发生此错误。

这是在windows 2003下。

有谁知道为什么会这样？

谢谢。

```
The process cannot access the file 'D:\myService\eventlog.xml' because it is being used by another process.

at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy)
at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share)
at System.Xml.XmlTextWriter..ctor(String filename, Encoding encoding)
at System.Data.DataTable.WriteXml(String fileName, XmlWriteMode mode, Boolean writeHierarchy)
at System.Data.DataTable.WriteXml(String fileName)
at myService.c_control.addXmlLog(eventStatus timeStatus) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T17:37:59.793

您的服务是否有可能会访问它两次，每次都试图获得一个排他锁？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T13:05:09.460

如果问题是由于重新启动后服务启动过早引起的，为什么不查看上次重新启动时间并跳过运行任务，直到重新启动后几分钟。System.Environment.TickCount 将为您提供自上次启动时间以来的毫秒数。

[http://msdn.microsoft.com/en-us/library/system.environment.tickcount.aspx](http://msdn.microsoft.com/en-us/library/system.environment.tickcount.aspx)

# c# - 向转发器添加标记时如何避免“加载视图状态失败”异常？

> ID：465052
> 
> 赞同：0
> 
> 时间：2009-01-21T12:19:09.797
> 
> 标签：c#, repeater, failed-to-load-viewstate

我有一个继承自 Repeater 的自定义控件。我需要在转发器中的项目周围注入一些标记。目前我正在循环Repeater.Items（OnPreRender）并添加包含标记的LiteralControls。这很好用，除了在执行回发时，因为它会抛出“加载视图状态失败”异常。

1）有人有更好的方法吗？
2）或者解决异常的方法？也许我以一种导致这种情况的方式添加标记？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T20:45:54.690

我会尝试 OnItemDataBound 事件而不是预渲染。

# c# - 在 C# 中向现有代码添加自定义功能的最佳方法是什么？

> ID：465057
> 
> 赞同：2
> 
> 时间：2009-01-21T12:20:26.800
> 
> 标签：c#, inheritance

比如说，我有许多 Web 应用程序使用同一个类库编译成 C# 中的 dll，我想为特定应用程序更新类的特定方法。我不想更改现有代码，因为它会影响每个人，我不想从一个类继承来创建一个新的。我只想更改单个应用程序的类的现有方法。

实现这一点的一种方法是将编译的类作为“基”类，并有一个单独的文件，其中包含所有继承基类的覆盖类。然后应用程序将使用继承的类。然后要更改单个应用程序的类，您只需更新继承的类。我看到这种方法的唯一问题是每个应用程序都需要 2 个文件，一个是基类，一个是继承的（可能未编译）。

谁能推荐一个更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T12:28:42.430

也许扩展方法会起作用？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T12:50:45.647

您不能更改已编译方法的实现；多态性是一种选择；另一个是封装，可能通过接口上的装饰器模式，使用工厂创建实例 - 即

```
interface IFoo { void Bar();}
class Foo : IFoo {public void Bar() { /* imp 1 */ } }
class FooWrapper : IFoo {
    IFoo parent;
    public FooWrapper(IFoo parent) {this. parent = parent;}
    public void Bar() { /* imp 2, perhaps using "parent" }
} 
```

（我不会打扰多态性的例子）

多态和装饰实现了相似的目的，但有不同的优点/缺点——例如，装饰器可以针对不同的场景组装成灵活的链。

使用任何其他方法（例如扩展方法），您最终都会调用不同的方法；如果适合，那很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T13:52:06.583

如果您只是想在方法中**添加**东西，而不是修改其内容，则可以使用[面向方面编程](http://en.wikipedia.org/wiki/Aspect-oriented_programming)(AOP)。在 C# 中，这可以使用[PostSharp](http://www.postsharp.org/)或[AspectDNG](http://aspectdng.tigris.org/)来完成。

AOP 专注于关注点分离：您编写的方法只包含业务逻辑，而应用程序的所有其他方面（安全性、日志记录等）都封装在它们自己的模块中。在编译时，这些方面的代码被注入到您指定的特定位置的业务代码中。

你也可以看看[这个问题](https://stackoverflow.com/questions/249021/is-it-possible-to-modify-a-method-body-at-run-time-in-net)。尽管该问题专门针对方法的运行时修改，但一些答案可能会给您一些提示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T12:31:18.820

我认为扩展方法是最好的选择。欲了解更多信息，请访问[此处](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T13:22:32.150

不使用继承类就不能覆盖现有方法，这似乎很奇怪。这在 javascript 等语言中非常简单。上述建议给了我思考的余地，但确实比我最初的想法有所改进。扩展方法不允许您修改现有方法。通过封装，我仍然需要使用一个新类。

假设我有 10 个应用程序都使用类 User 和方法 login()。我不想更改调用此方法的位置（即更改类名或方法参数）。我只想更改该应用程序的方法本身，以便在返回之前可以进行额外的检查。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T13:25:41.550

是否可以将类库中的方法设为虚拟？这将允许您在您想要的地方覆盖它，但在其他情况下保持“原样”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T16:09:57.490

多态性似乎是最好的解决方案。通过这种方式，可以编译并保留基类，并且可以为单个应用程序更改继承的类，而无需更改原始类的使用方式（除非必要）。

基类.cs

```
public class BaseUser {

    public BaseUser() {}

    public bool login() {

        return false;

    }

} 
```

类.cs

```
public class User : BaseUser {} 
```

应用

```
User u = new User();
u.login(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T16:13:24.473

扩展方法。这应该添加到静态类中。您应该访问：[http ://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx](http://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx)

DateTime 类使其返回周数的扩展方法示例：

```
public static int WeekNumber(this DateTime dtPassed)
    {
        CultureInfo ciCurr = CultureInfo.CurrentCulture;
        int weekNum = 0;
        try
        {
            weekNum = ciCurr.Calendar.GetWeekOfYear(dtPassed,
           CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Sunday);
        }
        catch (Exception ex)
        {
            //TODO: Add error handling code
        }

        return weekNum;
    } 
```

# apache - 您如何在 Apache 中维护会话状态？

> ID：465062
> 
> 赞同：0
> 
> 时间：2009-01-21T12:22:04.487
> 
> 标签：apache, restful-authentication

我需要维护对 Apache 服务器的 REST 调用之间的会话信息。从来没有在 Apache 平台上开发过，我希望找到一个可以帮助促进会话信息和应用程序安全性的包/模块。请针对新手的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T13:54:34.550

不平静地做事会使保留会话信息服务器端冒险。

根据定义，它应该是无国籍的。

从技术上考虑，您可以将状态存储在 cookie 中（只要它是加密的），它不是很安静。

只是我的2美分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T13:58:40.097

通过我们的 RESTful Web 服务调用，我们只需使用简单的身份验证在每个调用中包含凭据。仔细想想，这其实还不错。它使 api 易于理解，并且不涉及任何用于身份验证、使令牌过期等的体操。

我还建议您通过 https 执行所有这些操作，因为密码将采用明文形式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T13:50:39.160

我对如何使用 Apache 感到困惑——我一直认为 Apache 要么只提供静态文件，要么运行由其他程序（Perl、PHP 等）解释的脚本。我已经使用 PHP 处理了我的有状态事务（通常使用 cookie，尽管这在技术上不是 REST）。

# python - 在 Django / Python 中编写单元测试

> ID：465065
> 
> 赞同：30
> 
> 时间：2009-01-21T12:22:24.533
> 
> 标签：python, django, unit-testing

除了在 Uni 课程中快速介绍之外，我之前没有使用过单元测试。不过，我目前正在编写一个应用程序，并想在此过程中自学 TDD。问题是，我不知道要测试什么或如何测试。

我正在编写一个 Django 应用程序，到目前为止只创建了模型（并自定义了管理应用程序）。到目前为止，这就是我编写测试框架的方式：

```
class ModelTests(TestCase):
    fixtures = ['initial_data.json',]

    def setUp(self):
        pass

    def testSSA(self):
        ssa = SSA.objects.create(name="sdfsdf", cost_center=1111, street_num=8,
                street_name="dfsdfsf Street", suburb="sdfsdfsdf",
                post_code=3333)

    def testResident(self):
        pass

    def testSSA_Client(self):
        pass 
```

我计划编写一个函数来测试 ModelTests 类中的每个模型。这是编写测试的好方法吗？另外，我到底应该测试什么？创建一个包含所有已完成字段的模型？那个半完整的模型失败了？是否测试了任何特殊情况（如 null 和 is_required=False）？我信任 ORM，据我所知，它已经过大量测试，所以我不需要测试所有方法吗？

对于用 Django/Python 编写的 Web 应用程序，我需要测试什么？一些例子会很好。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-21T15:08:38.630

**在 ModelTests 类中测试每个模型的函数是编写测试的好方法吗？**

不。

**我到底应该测试什么？**

*   创建一个包含所有已完成字段的模型？

*   那个半完整的模型失败了？

*   是否测试了任何特殊情况（如 null 和 is_required=False）？

*   我信任 ORM，据我所知，它已经过大量测试，所以我不需要测试所有方法吗？

不多。

您可能会测试验证规则，但这在您定义了一些 Form 对象之前是没有意义的。然后你有一些东西要测试——表单是否强制执行所有规则。每个表单至少需要一个 TestCase 类。一个函数将是一个场景——允许或不允许的不同输入组合。

对于每个 Model 类，您至少需要一个 TestCase 类定义。测试用例很便宜，定义很多。

您的模型体现了您的“业务实体”定义。您的模型将具有实现业务规则的方法。你的方法会做总结、过滤、计算、聚合、减少等各种事情。您将拥有模型类的每个这些功能的功能。

你不是在测试 Django。您正在测试您的业务规则如何在 Django 中实际工作。

稍后，当您的应用程序中有更多内容（表单、视图、url 等）时，您将希望使用 Django unittest 客户端来为每个 url 练习每个方法。同样，每个测试用例

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-21T13:12:53.590

我不确定您要在这里测试的具体内容，为此我需要更多代码片段，但我可以给您一些一般性建议。

首先，阅读“Dive into Python”的单元测试章节（在线免费！[http://diveintopython3.ep.io/unit-testing.html](http://diveintopython3.ep.io/unit-testing.html)），这是对单元测试的一个很好的解释，你需要做什么，以及为什么。

其次，关于 TDD，这是一种有价值的实践，但要小心不要过于依赖它，因为我发现它会导致过度指定软件，并进一步导致无法重新开发和调整的软件到新任务。这只是我的经验，请注意。此外，如果您不教条地使用它，TDD 是有价值的。

第三，令我震惊的是，针对您的具体情况的最佳建议是*努力测试您的逻辑，而不是您所依赖的框架的逻辑*。这意味着经常测试半完整模型失败等等可能不合适，因为这不是你的逻辑，而是 django 的，所以应该已经测试过了。更有价值的是测试一些预期的情况、预期的实例化、预期的异常等，以确保您的模型规范是合理的，然后继续进行应用程序的更实质性的逻辑。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-21T13:24:11.850

想必您已经阅读了测试[Django 应用程序](http://docs.djangoproject.com/en/dev/topics/testing/)。

开始测试应用程序的正常用例、创建新用户、添加博客条目等。首先只是典型的 CRUD 操作，然后移至边缘用例。基本上，您对您的应用程序建立信心，即您以后更改的任何内容都不会破​​坏我期望应用程序的行为方式。

在您的 URL 上模拟 GET/POST 请求并观察响应（标题、状态代码和内容）。您的应用程序是否呈现了正确的视图？使用正确的模板？在您的应用程序抛出异常的部分，尝试触发它们（例如查看/编辑不存在的记录以引发 ObjectDoesNotExist）。

通常值得加入一个跟踪系统（例如 Trac），这样您就可以为每个记录的缺陷添加一个新测试。

# javascript - ASP.NET MVC 框架中的 Ajax

> ID：465071
> 
> 赞同：0
> 
> 时间：2009-01-21T12:24:52.237
> 
> 标签：javascript, ajax, asp.net-mvc

我正在寻找一种简单的“鼠标悬停”效果的方法。（我希望页面显示一个对话框）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T12:34:33.120

我会选择Jörn Zaefferer的[jQuery Tooltip 插件](http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T12:36:34.317

使用一些 Javascript。

Jquery 使这些事情变得非常容易。您是否已经拥有信息，或者当鼠标悬停时您想从服务器中提取信息？

使用 Jquery 你可以做这样的事情

```
<script type="javascript">
$(document).ready(
  function(){
     $("divToShow").hide();
     $('#objectWithMouseOver').mouseover(onMouseOver());
});

function onMouseOver()
{
  $('#divToShow').show();    
}
</script>
<body>
<div id="divToShow">
  whatever info you want to show....
</div>
<div id="objectWithMouseOver">
  when you drag mouse over here the other will show
</div> 
```

我会使用 addclass removeclass 而不是显示/隐藏来获得更好的控制。将其扩展为调用 mvc 控件并使用 ajax 填充数据并不难。向函数添加一些参数并使用 jquery.ajax 函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T12:37:00.837

[微软现在在智能感知中支持](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)添加到该 jQuery ，因此它值得与 ASP.NET MVC 框架一起使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T13:56:09.307

**使用 CSS**

有一个隐藏的 div 和一个 :hover 在您希望将弹出窗口附加到的单词上

您需要有一个辅助 JS 脚本才能在 IE6 中加载它

```
<span class="WordHighlight">word 
  <div class="hiddenPopup">some words about the word</div></span> 
```

CSS

```
.WordHighlight{text-decoration:dotted}
.WordHighlight .hiddenPopup{display:none;/* add popup style */}
.WordHighlight:hover .hiddenPopup{display:inline;}
.WordHighlightHover .hiddenPopup{display:inline;} 
```

将脚本添加到

我会稍后再回来完成这个

# .net - 控制台应用程序优于 Windows 服务的优势

> ID：465074
> 
> 赞同：16
> 
> 时间：2009-01-21T12:25:13.997
> 
> 标签：.net

我有一个 .Net 控制台应用程序，它将使用预定事件启动，调用 mweb 服务方法并关闭。每小时/每天运行一次。虽然实现没有任何“错误”，但我想知道将其实现为 Windows 服务是否有任何好处。

有没有人对这种情况下的最佳做法有任何看法？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-21T12:32:01.207

我发现 Windows 服务很难调试，所以我倾向于只在以下情况下使用它们：

(A) 我正在做的事情相当复杂或

(B) 需要一直运行（例如：监控某些东西的变化）

我发现大多数事情通常可以通过控制台应用程序、一些命令行参数和 Windows 调度程序来完成。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-21T12:45:56.030

服务在三个方面不同于应用程序：

1.  它在没有用户登录系统的情况下运行
2.  它不能有任何用户界面（控制台也是一个 UI）
3.  它可以在提升的权限（系统帐户）下运行，从而执行用户不允许的操作。

这里要问的问题是：*您需要服务可以为您提供的不同选择吗？*如果答案是否定的，则不要使用服务。

我从您的问题推断出您需要一个没有任何用户界面的后台应用程序（上面的第 2 项）。您似乎不需要项目 1 或 3。您可以通过不创建一个没有任何窗口（控制台或其他）的纯后台应用程序。只需创建一个简单的 Windows 应用程序并更改

```
static class Program
{       
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }
} 
```

到

```
static class Program
{       
    [STAThread]
    static void Main()
    {
        // Application.EnableVisualStyles();
        // Application.SetCompatibleTextRenderingDefault(false);
        // Application.Run(new Form1());

        DoWhateverYouWant();
    }
} 
```

哦，是的，Chris 完全正确地认为调试服务真的很痛苦！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T13:03:56.213

我认为你所做的是最好的做法。没有什么比添加自己的服务只是为了定期做一些小事的应用程序更让我讨厌的了。通过在 >Vista 中更新的事件日志/任务调度程序集成，真正需要服务的应用程序更少了，如果他们这样做了，就可以按需提供服务。

你正在让世界变得更美好。

:-)

哦，作为一个控制台应用程序，因此您可以在需要时轻松手动运行它，这对可调试性非常有用。

澄清：继续，你做对了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T14:09:23.523

好处：如果您的机器重新启动（即服务器），您无需登录即可重新开始工作。

我同意调试 Windows 服务很糟糕！这太可怕了，MS 应该真正解决调试服务的能力。

但是...有一些免费软件工具可以大大帮助该过程。Anderson Imes 有一个很好的实用程序，它使编写 Windows 服务就像编写控制台应用程序一样，即使在调试周期中也是如此。

[在http://theimes.com/files/](http://theimes.com/files/)上查看他的服务调试实用程序

关于他的实现最好的部分是它是代码中的 1 行更改，如果您不希望在生产实例中使用他的库，您可以使用 #if DEBUG 参数轻松管理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T08:37:06.810

调试服务有一个简单的解决方法。您创建了一个组合控制台/服务应用程序。

您检查一些命令行参数（例如 -debug），然后执行您的 OnStart 代码，等待按键，执行 OnStop 代码。

我使用相同的方法来提供一个界面来从同一个 EXE 安装、卸载、启动和停止我的服务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T13:06:27.237

要考虑的一件重要事情是控制台应用程序支持**System.Drawing**命名空间，这意味着您可以打印。它在 Windows 服务中工作，但不受支持且不完全稳定。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-07T16:15:50.263

Creego 的 2 分和 treb 的 3 分是不可否认的。但是，我发现 SQL Server Agent 05/08/R2 是一个非常可靠和有用的任务调度程序。它比 Windows 任务计划更可靠，您不必担心批处理权限或用户登录。

我有一个后台系统程序，通过 SQL Server 代理每 2 分钟运行一次。我强烈考虑将其转换为 Windows 服务，但我无法证明它的合理性。

不过，在另一种情况下，天平很容易倾斜。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-04T18:51:40.917

这不是你的问题，但我通常将这两种方法结合起来。

我使用控制台进行调试，并使用共享相同库和规则的 Windows 服务。

# sql - 如何预览破坏性 SQL 查询？

> ID：465083
> 
> 赞同：42
> 
> 时间：2009-01-21T12:28:24.320
> 
> 标签：sql, sql-server

在 SQL Server Management Studio 中编写破坏性查询（例如，DELETE 或 UPDATE）时，我总是希望自己能够在不实际运行的情况下预览查询的结果。Access 非常方便地允许您执行此操作，但我更喜欢手动编写我的 SQL，遗憾的是，Access 非常不擅长。

所以我的问题是双重的：

1.  是否有 SSMS 的附加组件，或者配备了良好的 SQL 手动编码工具的单独工具，也可以预览破坏性查询的结果，类似于 Access？

2.  是否有任何“手动”预览的技术或最佳实践？例如，以某种方式使用交易？

在我看来，做这种事情从根本上来说很重要，但我似乎无法通过谷歌找到任何东西（我可能只是在寻找错误的东西——我对这件事非常无知）。目前，我正在采取一种相当多毛的腰带和大括号方法来评论输入和输出选择/删除/更新行并确保我进行备份。肯定有更好的方法吧？

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-01-21T12:40:08.227

我会使用 SQL SERVER 2008 及以后版本中的 OUTPUT 子句...

[**输出子句 (Transact-SQL)**](http://msdn.microsoft.com/en-us/library/ms177564.aspx)

就像是...

```
BEGIN TRANSACTION

DELETE [table] OUTPUT deleted.* WHERE [woof] 

ROLLBACK TRANSACTION 
```

INSERT 和 UPDATE 也可以使用“插入”表。MSDN 文章涵盖了所有内容。

**编辑：**

这就像事务中的 SELECT 然后 DELETE 的其他建议一样，除了它实际上是一起做的。因此，您打开一个事务，使用 OUTPUT 子句删除/插入/更新，并且在输出所做的操作的同时进行更改。然后你可以选择回滚或提交。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-21T12:46:16.980

我害怕有人对我的数据库这样做，所以我总是要求我的团队执行以下操作：

```
BEGIN TRAN

DELETE FROM X
-- SELECT * FROM X
FROM Table A as X JOIN Table B ON Blah blah blah
WHERE blah blah blah

ROLLBACK TRAN
COMMIT TRAN 
```

这样，如果您不小心按了 F5（完成了！），您将不会做任何更改。您可以通过 SQL 语句的末尾突出显示 SELECT 部分，以查看将更改哪些记录（以及更改的数量）。然后，突出显示 BEGIN TRAN 和整个 Delete 语句并运行它。如果您删除了与预期相同数量的记录，请突出显示 COMMIT TRAN 并运行它。如果有任何东西看起来很奇怪，请突出显示 ROLLBACK TRAN 并运行它。

我使用任何 UPDATE 或 DELETE 语句来执行此操作。它救了我几次，但它总是让我安心。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-08-18T04:57:59.863

删除时：

```
BEGIN TRANSACTION

   DELETE FROM table1 
   OUTPUT deleted.*
   WHERE property1 = 99 

ROLLBACK TRANSACTION 
```

更新/插入时：

```
BEGIN TRANSACTION

   UPDATE table1
   SET table1.property1 = 99
   OUTPUT inserted.*

ROLLBACK TRANSACTION 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T12:35:17.597

当您处于事务的上下文中时，您可以在事务提交之前的任何时间回滚更改。（通过显式调用 commit tran 或者如果出现会导致服务器隐式提交事务的条件）

```
create table x (id int, val varchar(10))

insert into x values (1,'xxx')
begin tran

delete from x
select * from x

rollback tran
select * from x 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T13:59:35.897

当我想查看将要删除的内容时，我只需将“delete”语句更改为“select *”即可。我比使用事务更喜欢这个，因为我不必担心锁定。

# performance - 您对使用 Web 服务获取大数据列表有何看法？

> ID：465095
> 
> 赞同：0
> 
> 时间：2009-01-21T12:31:50.350
> 
> 标签：performance, web-services

我与开发人员进行了一些关于使用 Web 服务获取数据列表的会议，他们说这取决于站点、商业、博客等的类型。

你对这个问题有什么看法？使用 Web 服务获取大量数据是一种明智的性能方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T14:34:40.117

就我个人而言，我认为这与应用程序本身没有太大关系（尽管面向用户的应用程序肯定会与机器间的应用程序有不同的要求，并且一些面向用户的应用程序会比其他应用程序更优雅地容忍延迟); 真正的问题是，将我的数据提供给客户的最佳方式是什么？它的答案总是会有所不同，“好吧，这取决于。”

就我而言，我可以说，对于面向公众的面向用户的应用程序，一般来说，应该避免或至少回避“大列表”，不是因为它们本质上是邪恶的，而是因为它们会影响用户经验（客户端应用程序在检索或处理大型数据集时可能会挂起），它们不能很好地扩展（如果您的主页针对每个请求通过网络推送大量 SOAP 镶嵌的东西，无论是否缓存服务器，您随着流量的增加，重新会遇到麻烦），等等。根据项目的进展情况，您可能会发现您需要重写以支持增加的负载或增强滞后的性能或响应能力，这对于面向服务的应用程序来说可能是一项重要的、不那么有趣的工作。

也就是说，我也以这种方式编写了很多我自己的服务层，在响应性对我来说不是很重要的项目（例如，个人项目）上，或者当我真的不期望有那么多负载时，因为他们'快速开发、部署和维护。用户确实会受到启动打击，但这种打击也可以通过良好的设计来掩饰，并且在客户端上拥有大量数据，特别是当它不经常更改时，会很方便。

所以很难说一种或另一种。有时它很好，有时不是——“这取决于。” 在不了解您的特定要求的情况下，我可能会建议您继续使用大列表锤子编写一些简单的代码，使用真实（或接近真实）数据，进行一些测量，推断它们，然后看看情况如何. 您可能会发现没有什么可担心的，您最不想做的就是陷入不必要的复杂设计，因为 StackOverflow 上的一群人告诉您“大列表不好”。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T12:44:44.927

你可以看看[Apache Wicket](http://wicket.apache.org) list 组件是如何解决这个问题的。

您很少想显示一个大列表的全部内容。在某个时刻只有一个页面，并链接到结果集中的其他页面。

第一次调用 ws 运行查询时，返回所有 ID 的列表和记录的子列表，它们最初将显示在客户端上。您可以使用 ID 列表的大小来创建页面链接。

在客户端上，您可以使用 ID 列表来构建对其他页面的请求。

如果您使用一些会话管理，则 ID 列表可以存储在服务器上，并且对页面的请求只能具有页码和每页的记录数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T12:56:44.887

哦....由于性能问题，我们没有在这里工作，据说这是针对 CRM 类型的应用程序，从业务线应用程序获取未决案例列表必须在 3 秒内返回。我们最终直接访问了数据库。

所以我想这就是答案是什么类型的应用程序，是否涉及用户？

如果它的系统到系统 - 我们有那些 - 由 BizTalk 编排 - 已关闭的案例列表。然后它只是可用的系统资源 - 所以我们安排了那些在办公时间之外的时间，以确保两个用户组的性能都不会受到影响

# sql-server - SQL server ADO.NET over low bandwidth TCP/IP connection 有什么技巧/经验吗？

> ID：465096
> 
> 赞同：2
> 
> 时间：2009-01-21T12:32:00.957
> 
> 标签：sql-server, ado.net, tcp

您好，我们有一个通过低带宽连接运行的 SQL Server 应用程序。我们使用 ADO.NET。

我想知道是否有人对减少频道流量有任何建议。我正在寻找有关 ADO.NET/SQL-Server 特定提示的答案，以使其更高效。没有明显的答案，例如“不要获取很多记录”。

MySql 的示例将是连接字符串中的“启用压缩=真”。我在 SQL Server 中找不到有关传输层压缩的任何内容。

你们中有人有这方面的经验吗？是否有我们必须知道的重要的注意事项？

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T13:54:44.410

除了返回更少的数据并尽可能缩短查询文本之外，您无能为力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T00:02:54.027

我会将通信包装在 Web 服务或 WCF 中。并在数据交换上使用压缩。

如果你不能这样做，我会使用大量缓存。如果应用程序不必经常返回服务器，您实际上将使用更少的带宽。
在此说明中，请查看本地数据缓存 - 同步。
也许这会有所帮助：[The Moth - ADO.NET Sync Services](http://www.danielmoth.com/Blog/2008/02/adonet-sync-services.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T06:01:50.927

我想除了完全不同的编程方式之外，没有任何东西可以帮助......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-09T16:09:01.550

最好是在通道中工作（低带宽连接并使用 QoS 选项来减少和组织流量

# java - 使用 Java 构建插件系统的最佳方法

> ID：465099
> 
> 赞同：153
> 
> 时间：2009-01-21T12:33:01.983
> 
> 标签：java, design-patterns, plugins, frameworks, plugin-architecture

您将如何为您的 Java 应用程序实现插件系统？

是否有可能拥有一个易于使用（对于开发人员）的系统，它可以实现以下目标：

*   用户将他们的插件放入应用程序的子目录中
*   该插件可以提供一个配置屏幕
*   如果使用框架，许可证是否与商业开发兼容？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-01-21T12:45:48.980

首先，您需要一个所有插件都需要实现的接口，例如

```
public interface Plugin {
    public void load(PluginConfiguration pluginConfiguration);
    public void run();
    public void unload();
    public JComponent getConfigurationPage();
} 
```

然后插件作者应该将他们的插件捆绑到 JAR 文件中。您的应用程序打开 JAR 文件，然后可以使用 JAR 清单中的属性或 JAR 文件中所有文件的列表来查找实现插件接口的类。实例化那个类，插件就可以使用了。

当然，您可能还想实现某种沙盒，以便插件限制它可以做什么和不能做什么。我创建了一个包含两个插件的小型[测试应用程序](http://pterodactylus.net/download/security-test.tar.bz2)（并[写了一篇博客](http://blog.pterodactylus.net/2013/07/19/sandboxing/)），其中一个插件被拒绝访问本地资源。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-01-21T12:44:35.673

使用[OSGi](http://en.wikipedia.org/wiki/OSGi)。

它是 Eclipse 插件系统的基础。[Equinox](http://en.wikipedia.org/wiki/Equinox_OSGi)是 Eclipse 的实现（获得许可的 EPL），[Felix](http://felix.apache.org/)是 Apache 项目的实现（获得许可的 Apache Public License）。

Eclipse 提供了一个具体示例，OSGi 可以涵盖您提到的要点（或者，如果您想要一个完整的 Eclipse/SWT/JFace 堆栈，您可以在[Eclipse RCP](http://wiki.eclipse.org/index.php/Rich_Client_Platform)之上构建您的应用程序）。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-01-21T14:34:20.070

从 1.6 开始，如果您想编写自己的简单系统，可以使用[java.util.ServiceLoader 。](http://download.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html)

但是，如果您想要的不仅仅是基本功能，请使用现有框架之一。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2014-11-24T14:12:57.583

使用[PF4J](https://pf4j.org/ "PF4J")。它支持 Web、Spring 和 Wicket。易于使用和构建应用程序

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-01-21T14:26:01.977

还有[JPF（Java 插件框架）](http://jpf.sourceforge.net/index.html)。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-12-10T19:34:44.770

我在 OSGi 上工作了一周——这是一个紧张的，除了 OSGi 的一周。最后，这就像一场噩梦，但我学到了很多。

我能够让 OSGi 正常工作（不容易，所有示例都已过时，网络上的所有内容都至少有 3 年历史，如果不是 5 年的话），但由于存在问题，我很难将它集成到现有项目中jar 体现。

简而言之，用于构建清单的工具很少，并且没有很好的文档记录（BND 工具并不晦涩，但它是为 Eclipse 中的某个进程设计的）。此外，大多数可用的 OSGi 信息并不针对拥有现有桌面应用程序的应用程序开发人员。

这使得信息的很多上下文模糊或不恰当。Neil Bartlett 的博客文章是最大的帮助，但即使是那些也未能获得一个工作系统（我从 Felix 教程中获取了一些代码并将它们拼凑在一起以使嵌入式框架滚动）。我找到了他多年前免费发布的书稿，非常好，但是由于 Eclipse OSGi 支持的变化，Eclipse 中的示例无法正常工作。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-01-29T18:24:59.867

我认为推荐 OSGi 来解决上述问题是非常糟糕的建议。OSGi 是“正确的选择”，但对于上述场景，我认为 JPF 或一些本土的简约框架就足够了。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-10-23T14:03:41.743

几年前，我开始了一个这样的项目，我希望很快就能准备好。我受到了 NetBeans 和 Eclipse 等项目的启发，但与此同时，它变得有点不同。OSGi 现在看起来是一个不错的选择，但我没有机会将它与我的项目进行比较。它与上面提到的 JPF 相似，但同时在很多方面有所不同。

激励我的基本想法是尽可能简单地构建 Java 应用程序，不将 Web 应用程序、桌面应用程序或 applet/JWS 应用程序（当然这还不包括 UI）作为核心功能分开。

我建立这个项目时有几个目标：

*   无论您构建 Web 应用程序还是桌面应用程序，都应该以相同的方式启动应用程序，一个普通的 main 方法，没有花哨的 web.xml 声明（不是我反对使用标准的 Web 描述符，而是它不适用于插件系统，您可以在其中添加“servlet” - 我称它们为 RequestHandler(s) - 随意动态）。
*   易于围绕“扩展点”插入“扩展”——来自 Eclipse，但方法不同。
*   可自我部署，因为所有插件都已注册（XML 文件），所以应用程序必须能够独立于构建系统进行自我部署——当然还有 Ant 任务和 Maven MOJO，它们是与我们的世界的链接，但在最后它调用应用程序并指示它在特定位置自我部署。
*   从 Maven 借来的，它可以从存储库（包括 Maven 1 和 2 存储库）下载代码，因此只要您可以访问存储库，您的应用程序就可以部署为单个小 jar（有时很有用，基本上这提供了对 auto-更新 - 你不喜欢你的网络应用程序通知你有一个更新的版本，它已经下载并且只需要你的许可来安装它吗？我知道我喜欢那个）。
*   有关系统运行状况的基本应用程序监控，发生故障时的电子邮件通知

# agile - 鼓励团队沟通的最佳方式是什么？

> ID：465104
> 
> 赞同：7
> 
> 时间：2009-01-21T12:34:34.510
> 
> 标签：agile

我在一个中型团队（20 多名开发人员）中工作，我认为团队成员之间的沟通不如预期的那么好。

像大多数团队一样，我想，我们有几个我们构建和维护的系统。我们还在工作中使用了数十种不同的工具，例如 Visual Studio 2008、Subversion、Resharper、Tibco、TeamCity 等。

我们还使用“敏捷”方法进行开发......我把它放在引号中，因为它看起来更像是“急于尽快获得这个功能......我们将在大约一周内为您提供规范......只是现在开始工作，但一定要对其进行单元测试并让某人对其代码进行审查”。

正因为如此，我们的系统设计不佳，因此变得难以维护……所以我们最终得到了少数人作为“大师”，他们非常熟悉他们创建的系统。

此外，由于整个 IT 行业的发展步伐，我们经常需要使用新技术和我们开发的工具的最新版本。

我的意思不是抱怨并说“哦，不幸的是我的事情很困难”……而是我担心的是，除非我们的团队开始更好地沟通，否则我们将陷入这种困境。

让我试着通过更好的沟通来解释我的意思......

最近我们刚刚从 VS2005 升级到 VS2008……这在我眼中很棒，因为我喜欢使用最新的技术。我们还从 CruiseControl.Net 迁移到了 TeamCity……这一切都很好。

...但是....我们从未真正接受过任何有关 VS2008 或 C# 3.0 新功能的培训...甚至没有关于 TeamCity 的备忘录...作为 IT 人员，我们似乎应该适应和学习我们去。

现在很明显，我可以通过阅读博客并关注我使用的工具的最新消息来找到自己的信息……我这样做了……但是团队中的每个人都没有真正实践持续学习的做法，所以你最终导致人们在没有真正了解它们的情况下使用新功能......

此外，我们的团队最近被指示开始进行代码审查......但没有任何关于这真正意味着什么的指导......目前它只是意味着将您的代码提供给团队中的某人......任何人......并让他们查看您的代码...无论是两秒钟还是两个小时，它在整个团队中都不是很好建立或统一的......如果他们甚至正在完成......

编写单元测试也是如此……我们一直被鼓励编写它们……但是在团队范围内并没有真正传达出编写它们的最佳方法是什么……所以一些开发人员尝试编写它们，发现这很困难，要么编写糟糕的单元测试，要么放弃并决定单元测试是一个坏主意......

我提出来帮助改善这种情况的想法是组织一系列会议作为开发者论坛......在这些会议中，团队成员将提出一个不同的主题，剩下的时间用于讨论开发商。

一周的主题可能是 C# 的一项高级新特性以及围绕它推荐的最佳实践......下一个可能是关于代码审查和寻找什么......而下一个可能是对一个不起眼的遗产的介绍系统.....然后开发人员可以使用讨论来分享他们的经验和问题。最终的目标是拥有一个可以在开发人员之间自由分享想法和信息的地方。

我得到了我的经理和我的几位开发人员的支持，让我开始做一些事情……但有人告诉我，这种想法以前曾尝试过，但最终消失了。

我希望这个想法能够成功，而不是成为我自己推动的东西，当我最终离开这家公司时，它就会死掉。

那么我该如何鼓励我的团队更好地沟通呢？我对开发者论坛的想法听起来是个好主意吗？我能做些什么来防止它消失？

有没有更好的事情我可以做，而不是我没有考虑？

不仅仅是开始一系列会议......我如何鼓励和影响我的团队开始作为一个团队执行？我真的很喜欢我的工作，并且相信我正在与一群优秀的开发人员一起工作......但我也真的想在我认为目前有点缺乏的领域为团队增加价值。我如何有效地做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T12:50:06.163

团队精神很难勉强。大多数试图让人们更好地合作的尝试适得其反。它需要被培育和成长。

与其召开一系列会议，不如每月一次左右（在公司）进行一次团队午餐。一些非正式的东西，不会影响任何工作时间。没有什么正式的，而是人们相互交谈和“联系”的机会。如果人们可以的话，晚上喝几杯酒或打牌会有所帮助。重要的是它是自愿的和非正式的。

结对编程可以帮助传递知识，帮助人们相互了解和理解，因此可能值得思考。

然而，贵公司的管理风格似乎与事情不符。

> “急于尽快获得此功能......我们将在大约一周内为您提供规范......现在就开始工作，但一定要对其进行单元测试并让某人对其代码进行审查”。

这让事情变得悬而未决。有人读过开发团队应该做的事情，但不愿意把时间（也就是金钱）花在正确地做事情上。这将使开发人员被剥夺权利和动力，从而损害团队。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T12:53:34.440

很难给出一个明确的答案.. 除了尝试一些东西并希望他们中的一些人坚持

**避免本地知识孤岛**- [PairProgramming](http://c2.com/xp/PairProgramming.html)可能会起作用。如果 A 在 X 有一些专业知识或时钟时间的领域报名参加任务，他可以要求 X 与他配对。执行任务的过程在 X 的头脑中传播事物，是实时代码审查，有助于提高平均团队技能/专业知识/代码熟悉度。它还鼓励人们互相交谈而不是躲起来。

**技术发展的动态步伐**- 生活的事实......需要习惯它。使用开发者论坛、午餐盒论坛、棕色包会议、维基、读书俱乐部、在线论坛等可以工作。取决于您团队中的个人选择什么作为他们首选的摄取方式。处理反馈……如果团队认为他们从开发者论坛中受益，他们会坚持下去。如果它消失了，想想为什么它没有坚持下去..尝试其他吸取教训的东西..

**松弛**- 一个经常被忽略的方面。确保人们有时间帮助别人……而不是长期落后于最后期限。

创造一个鼓励和促进人们畅所欲言的环境......帮助他人......然后让个人团结起来。祝你好运。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-21T13:30:07.767

在我看来，您的团队缺少技术主管。

这个人会接受管理层的指导，并将其转化为团队其他成员可以使用的实际步骤。

例如：

1.  你提到你在你的团队中使用了许多产品，有时在没有给团队任何笔记或培训的情况下更新这些产品。
    技术负责人将记录产品以及如何使用它们，最好是在 wiki 上，以便其他人可以做出贡献，并且将拥有新产品的经验，因此他们可以在需要时帮助任何人。
    技术主管还将提供有关如何使用新产品的指导，无论是电子邮件、文档、维基文章等。

2.  在与管理层、高级开发人员等会面后，此人将就如何进行代码审查提供指导。

3.  对于任何新的开发或主要功能请求，技术主管都将参与设计它，因此将进行同行评审，并且知识将在团队中传播。

所有这一切的关键是让每个人的工作更轻松、更有效率。这个人是谁可能很清楚，因为他们将是最受尊敬的成员，每个人碰壁都会去。需要给那个人一些时间来扮演这个角色。

不幸的是，如果不是你，那么你可能无法说服人们改变他们的工作方式。

此外，每月一次的非正式午餐、足球或任何团队成员可以非正式联系的地方都会有很大帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T12:59:53.460

也许您关心的不是沟通，而是队友的动力。在像编程这样的知识领域中，动力必须来自从业者内部。没有它，很难走得太远。如果是这种情况，你需要搬到另一个地方。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T13:17:29.103

首先是通过将团队移动到同一个位置来打破所有物理墙，让每个人都坐在同一个房间里。

其次，开始使用发布计划会议。也就是说，您的团队与客户一起估计需要为即将发布的版本开发的每个故事。我将改善团队成员之间的沟通，因为他们一起讨论技术问题和解决问题。他们正在估计，如果做得正确，就会就估计和设计方法达成共识。通过迭代计划会议跟进发布计划，并在每次迭代（一周迭代最好）时进行。在这里，团队将每个故事分解为许多计划在本次迭代中实施的小任务。

第三，开始使用结对编程。不要强迫它，但要大力鼓励它。此外，请确保配对仅配对一天左右。即旋转对。这建立了集体代码所有权和团队精神，因为它是“我们的代码”而不是“他的代码”。

哦，最后：学会总是谈论“我们”和“团队”。永远不要指指点点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T13:20:21.343

你如何鼓励你的同事更好地沟通？以身作则。

在我的公司中，我们经常使用“驾驶某物”这个词。有人需要推动一个项目，需要推动测试等。这意味着要承担这项任务的责任并积极地推动它。不要只期望您的同事分享信息，向他们展示该做什么以及如何去做。

当你发现一些关于 VS2008 的不错的新细节时，与他们分享。但是要专业一点。不要只告诉今天晚些时候与你一起喝咖啡的两个人，准备一份描述你的发现的小型演示文稿或文字文档，并将其传达给所有团队成员。我肯定更愿意做一个简短的介绍，而不是只给他们发一封电子邮件，但这可能是不可能的。

您可以将此纳入定期的信息交流会议，但我认为在日常工作中保持相同的态度至关重要。不要只是这样做，要活下去。

（哦，天哪，我听起来像是那些愚蠢地高薪的激励教练之一！好吧，也许他们是对的，应该得到所有的钱 ;-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-21T20:17:35.433

*   **同地**。同一个房间里的每个人都鼓励自我组织（通过无意中听到的谈话。但是，您必须将干扰因素计入您的估计中。
*   **禁止即时消息/IRC**用于除最小的事情之外的任何事情。或者一起。你不会受欢迎（我也不喜欢它），但它会迫使人们开始公开交流，并打破派系。
*   **定期召开快速、集中的技术会议。**每日站会就是一个很好的例子。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-21T20:27:01.387

总会有人分享你的热情并加入你。总会有 9 到 5 岁的开发人员。对此无能为力。

如果你有管理层的支持，那就继续吧。管理层的支持是我认为最难的。希望当其他人加入您的行列时，其余的将符合要求。祝你好运！

# java - 我怎样才能在 JAVA swing 的文件中使用类似 html 文件按钮的浏览器？

> ID：465107
> 
> 赞同：3
> 
> 时间：2009-01-21T12:36:18.453
> 
> 标签：java, swing, file, browser

我正在尝试通过 Swing 创建我的第一个 UI 页面。在此页面中，我希望浏览文件。有人可以帮我实现这一目标吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T12:42:10.860

查看 Sun 的本教程页面：http: [//java.sun.com/docs/books/tutorial/uiswing/components/filechooser.html](http://java.sun.com/docs/books/tutorial/uiswing/components/filechooser.html)。

基本实现包括：

```
//Create a file chooser
final JFileChooser fc = new JFileChooser();
...
//In response to a button click:
int returnVal = fc.showOpenDialog(aComponent); 
```

返回值为您提供有关用户是单击“确定”还是“取消”等的信息，然后您可以查询文件选择器对象以找出选择的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T12:41:17.273

您似乎想要一个[JFileChooser](http://java.sun.com/javase/6/docs/api/javax/swing/JFileChooser.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T13:05:20.720

在此页面上，您将找到JFileChooser 如何工作的[CodeExample](http://www.exampledepot.com/egs/javax.swing.filechooser/CreateDlg.html)。

```
// This action creates and shows a modal open-file dialog.
    public class OpenFileAction extends AbstractAction {
        JFrame frame;
        JFileChooser chooser;

    OpenFileAction(JFrame frame, JFileChooser chooser) {
        super("Open...");
        this.chooser = chooser;
        this.frame = frame;
    }

    public void actionPerformed(ActionEvent evt) {
        // Show dialog; this method does not return until dialog is closed
        chooser.showOpenDialog(frame);

        // Get the selected file
        File file = chooser.getSelectedFile();
    }
};

// This action creates and shows a modal save-file dialog.
public class SaveFileAction extends AbstractAction {
    JFileChooser chooser;
    JFrame frame;

    SaveFileAction(JFrame frame, JFileChooser chooser) {
        super("Save As...");
        this.chooser = chooser;
        this.frame = frame;
    }

    public void actionPerformed(ActionEvent evt) {
        // Show dialog; this method does not return until dialog is closed
        chooser.showSaveDialog(frame);

        // Get the selected file
        File file = chooser.getSelectedFile();
    }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T12:42:05.507

在按钮上添加一个 actionListener 以打开一个 JFileChooser

# grails - 如何在 Groovy/Grails 中记录标记库（或一般的闭包）

> ID：465111
> 
> 赞同：11
> 
> 时间：2009-01-21T12:37:08.170
> 
> 标签：grails, documentation, groovy

我正在编写我的第一个 taglib 作为插件的一部分，我想记录它。添加 javadoc （有没有记录 groovydoc 的地方，或者它真的是一回事吗？）似乎不适用于非方法。

具体来说，如何在以下文件中记录 def mytag：

```
/**
 * This doc shows up
 */
class MyTagLib {
  static namespace = "myns"

  /**
   * This doc does not show up, but I'd like to document attrs.
   */
  def mytag = {attrs ->
    out << "something"
  }
} 
```

由于 Grails 中的很多东西都是使用闭包来指定的，如果真的无法记录它们，那么看起来我们就有问题了。是否有其他一些涉及我应该使用的单独文档文件的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T23:22:03.250

我刚刚读到了新的 Groovy 1.6 RC，它把我带到了 Jira，它有几个关于 groovydoc 的开放错误，包括一个专门关于记录[字段和属性](http://jira.codehaus.org/browse/GROOVY-2762)的错误，它仍然是开放的。最新评论谈到了主干中的部分实现，所以我必须检查一下。

这样就清除了当前状态。与此同时，我强迫自己将我的 taglib 发布到野外并记录它，这是我使用常规 HTML 页面（wiki 生成）所做的。对此有话要说，因为如果发现包含标签库详细信息的唯一文档被埋在许多自动生成的垃圾中，我实际上会被推迟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T17:43:52.683

你的问题让我很好奇，我环顾四周。似乎没有什么好的方法可以做到这一点。

我认为目前执行此操作的最佳方法是将可用标签及其参数记录在类级别的 javadoc 标头中。至少这样它们会出现在您的最终 API 规范中供人们查看。

我注意到那里有一些关于 groovydoc 的讨论，但我似乎找不到任何关于它的完全官方的东西，尤其是在与 Grails 的使用方面。我能够让 groovydoc 使用以下代码在我的一个 grails 1.0.3 应用程序上工作，但是当我添加它们时，它没有拾取我的 taglib 闭包上的任何文档注释。

```
<property environment="env"/>
<target name="groovydoc">
  <taskdef name="groovydoc" classname="org.codehaus.groovy.ant.Groovydoc">
    <classpath>
      <path path="${env.GRAILS_HOME}/lib/groovy-all-1.5.6.jar"/>
    </classpath>
  </taskdef>
  <mkdir dir="docs/gapi"/>
  <groovydoc destdir="docs/gapi" sourcepath="grails-app" use="true" windowtitle="groovydoc" private="true"/>
</target> 
```

如果您使用 groovydoc 的时间足够长，您可能可以按摩它以使其与 taglibs 一起使用，或者如果您有时间尝试它，它也可以与 Grails 1.1 beta 一起使用。

# asp.net-mvc - 在 MVC 中使用代码隐藏模型

> ID：465115
> 
> 赞同：3
> 
> 时间：2009-01-21T12:38:03.550
> 
> 标签：asp.net-mvc

我正在尝试将 ASP.NET 服务器控件（ASP.TextBox 等）与 MVC 一起使用（以利用验证能力、设计器支持等）。我怎样才能将它硬塞到 MVC 架构中？例如，我如何`button.click`路由到控制器或我的服务器控制器内的数据如何通过`viewPage`？

可以给我指出一篇文章或参考资料，以帮助清理我凌乱的设计吗？或者，坚持 MVC 和内联样式对我来说更好吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T12:50:17.753

我会坚持使用 MVC 方式或恢复到 Web 表单...您是否正在尝试为使用 Dreamweaver 的设计师获得支持？这实际上是一个好点，mvc 的 HtmlHelper 对dreamweaver 不友好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T13:03:53.937

我不会尝试将两者混为一谈。它们是非常不同的方法，并且在同一页面请求期间彼此并不真正兼容。RenderPartial*可能会*起作用，但我不会下注任何钱。

请注意，对于 MVC 视图，代码隐藏文件（通常为空）也在 RC 中被删除。

# java - Lucene 句子搜索

> ID：465118
> 
> 赞同：2
> 
> 时间：2009-01-21T12:39:06.637
> 
> 标签：java, lucene

是否可以在 Lucene 中搜索类似***Searching is fun的短语？***

当我尝试用这个进行搜索时，Lucene 最终只找到了***fun***这个词。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T12:50:30.467

如果您使用 QueryParser 对象来解析您的查询，您可以将其配置为自动假定 Aku 在他的回答中谈到的“+”运算符（抱歉 Aku 不仅仅是评论，但评论显然不支持代码格式）。例如：

```
String defaultField = ...;
Analyzer analyzer = ...;
QueryParser queryParser = new QueryParser(defaultField, analyzer);

queryParser.setDefaultOperator(QueryParser.Operator.AND);

Query query = queryParser.parse("Searching is fun"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T12:40:49.160

尝试用引号括起来：*“搜索很有趣”*或在必填词中添加“+” *+搜索+有趣*

有关可用选项，请参阅“ [Lucene - 查询解析器语法”](http://lucene.apache.org/java/2_3_2/queryparsersyntax.html)

# sharepoint - 如何在并行审批工作流中实现拒绝？

> ID：465122
> 
> 赞同：3
> 
> 时间：2009-01-21T12:41:08.083
> 
> 标签：sharepoint, sharepoint-2007, moss, workflow, workflow-foundation

我开发了一个带有复制器活动的 SharePoint 工作流，以便为每个审批者复制一个自定义活动。自定义活动为特定用户实现了一个批准分支。它具有 CreateTask、While、OnTaskChanged 和 CompleteTask 活动的经典形式。

我在复制器上设置了 UntilCondition 以在一位批准者选择拒绝批准然后工作流程完成后取消执行。问题发生在其他“挂起”在当前状态的未完成任务上。用户在打开任务时看不到此状态。

我将 UpdateAllTask​​s 放在替换器之后以将任务状态设置为已取消。但是由于 CompleteTask（对于被拒绝的任务）和 UpdateAllTask​​s 之间没有事件活动，因此 UpdateAllTask​​ 活动也为被拒绝的任务设置了 Canceled。

问题是，我该怎么做才能在 UpdateAllTask​​s 之前刷新 CompleteTask 所做的待处理更改？

或者，也许还有另一种方式来实现这样的工作流程。我正在考虑使用 UpdateTask 为自定义活动实现 Cancel 处理程序的方法。但我不知道如何实现它并告诉取消处理程序它在拒绝的情况下执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-23T18:32:39.093

在面对同样的问题并花费大量时间研究和尝试不同的选择之后，我认为我找到了一个非常好的解决方案。我把它贴在这里以供后代使用。

1.  创建一个扩展名为 ReviewActivity 的 SequenceActivity 的自定义活动
2.  ReviewActivity 包括典型的 CreateTask -> While -> OnTaskChanged -> CompleteTask 场景
3.  在我的工作流程中，我有一个复制器，它创建了许多 ReviewActivity 实例（因此也创建了许多任务）。
4.  复制器实现了一个 UntilCondition 来检查任务是否被拒绝（这是在 ChildCompleted 中设置的）
5.  在复制器之后，我有一个 UpdateAllTask​​s 来关闭剩余的任务

如果您对这种情况有任何经验，那么您准备告诉我，UpdateAllTask​​s 还会更新最初被拒绝的任务，因为“CompleteTask”尚未持久化到数据库中。神奇之处在于您可以为名为 PersistOnClose 的自定义活动 (ReviewActivity) 定义一个属性。

```
[Designer(typeof(ActivityDesigner), typeof(IDesigner))]
[PersistOnClose]
public partial class ReviewActivity : SequenceActivity 
```

此属性确保一旦 ReviewActivity 完成，所有更改都将持久保存到数据库中。由于 ReviewActivity 中的最后一个活动是“CompleteTask”，因此该任务被保存到数据库中。因此，UpdateAllTask​​s 不会触及它。

我希望这可以帮助别人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-25T13:26:03.303

我今天遇到了类似的问题。我解决了它：

1.  如果任务被取消，则在 ontaskchanged 方法中将变量 taskCancelled 设置为 true（基于字段已完成和百分比已完成）
2.  updateAllTask​​s 方法运行以在每个 ontaskchanged 事件后取消每个任务（在复制器内的序列中），仅当 taskCancelled 变量为真时
3.  如果 taskCancelled 变量为真，则将复制器的直到条件设置为真

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-18T22:15:14.993

您是否尝试在完成任务和 updatealltasks 活动之间放置一个代码活动？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-24T18:10:36.043

将您的活动构造如下： Create Task -> OnTaskChanged -> If/Else Activity（如果批准者决定为“reject”，则将条件设置为 true）->（在 If 分支内）UpdateAllTask​​s Activity（将状态设置为在Activity 属性）->（在 If 分支之外）CompleteTask Activity。

当审批者决定拒绝某个任务时，WF 将取消所有任务。它还将取消拒绝的人的任务，但在“CompleteTask”活动将触发并将相应的任务设置为已完成之后。

# database-design - 用缩写表名为表中的每个字段名添加前缀是一种好习惯吗？

> ID：465136
> 
> 赞同：10
> 
> 时间：2009-01-21T12:43:13.120
> 
> 标签：database-design, schema

您是否使用缩写表名作为表中每个字段的前缀？

例子：

```
Table: User

Fields:
user_id
user_name
user_password 
```

或者你是否至少命名你的字段？

```
Fields:
id
name
password 
```

如果您两者都使用过，那么从长远来看，您认为哪种格式对您的帮助最大？

编辑：这个问题似乎没有明确的答案，双方都提出了很好的观点。但是我将这个问题保持开放太久了，也许是时候将一个答案标记为已接受了。因此，我将投票率最高的标记为已接受。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-21T12:45:58.027

不要那样做。这是多余的，从长远来看会导致挫败感。

唯一*可以*应用它的字段可能是`id`，因为`user_id`显然是用户的 id，它会简化 SQL 中的连接编写。但我什至不会那样做。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-21T12:50:59.157

如果你这样做，你最终会编写如下查询：

```
SELECT user.user_name, user.user_password, user.user_firstname ... 
```

代替

```
SELECT user.name, user.password, user.firstname 
```

所以IMO你的问题的答案很清楚。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-21T12:51:22.150

你不再需要这样做了，你真的不应该这样做。[saua 指出](https://stackoverflow.com/questions/465136/is-prefixing-each-field-name-in-a-table-with-abbreviated-table-name-a-good-practi#465146)的唯一例外可能是用于寻求连接清晰度的 ID 字段。

使用表名作为字段名前缀的概念来自旧系统的旧时代，当时整个数据库中的每个字段都需要是唯一的。

因此，除非您处理的是要求整个数据库中的每个字段都具有唯一名称的遗留系统；不要做。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-21T12:54:04.907

我不会这样做的。如果您想要某个字段属于哪个表的信息，您可以随时将查询编写为

```
select user.id, user.name from user where ... 
```

但是想象一下，您出于某种原因决定重命名您的一张表（可能从“用户”更改为“客户”）。您还必须重命名所有字段，以保持一致。

我的观点：你应该这样做没有充分的理由，不这样做有几个充分的理由。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-21T14:49:18.980

将前缀放在列名上可能是一个好习惯。如果您正在处理一个正式的（并且可能是大型的）数据库并且您正在关注 ISO 11179（特别是数据元素名称的概念），那么最好将完整的三个（或四个）部分名称放入：对象 - 属性 - 表示术语。（第四个可选部分是限定符。）例如，“user_first_name”。这样，您的数据字典和数据库模式之间就会保持一致。由于已经评论过的原因，我不会对较小的数据库执行此操作，但在复杂的模式中，这会降低一些错误风险。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-21T13:03:08.447

我们通常也不使用缩写表前缀，我也不建议这样做。

但是，我们会在一种情况下进行：**保留字段**。

```
 e.g. OH_Reserve_Field_Alpha3 in table ORDER_HEADER 
```

简短背景：我们的数据库有 250 多个表，我们将其中的大多数保留列用于将来的功能实现。可以想象，如果没有前缀，您最终将拥有 50 个 Reserve_Field_Alpha3，它们在整个代码中具有完全不同的含义但名称相同。现在已经很难了，但是没有前缀会更糟。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-20T13:39:22.697

我建议坚持使用表别名，例如：

```
SELECT 
    user.id,
    user.email, 
    user.firstname, 
    user.secondname,
    avatar.filename
FROM
    pain_in_the_butt_table_name user
LEFT JOIN
    table_with_the_avatars avatar
ON avatar.user_id = user.id 
```

优点：

*   维护您选择的字段的易于理解的列表，以及您从哪些表中获取它们

*   避免输入长的或难以理解的表名，并用一个简短且易于理解的名称替换它们（创建表时应该这样做）

*   执行可读的连接（您的示例将显示为：

`LEFT JOIN table_with_the_avatars.user_id ON user.user_id = table_with_the_avatars.avatars_user_i`

*   创建更短的别名，在我的示例中，这意味着 u 而不是 user，a 而不是 avatar，从而缩短您的查询

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-21T13:28:41.840

当我将字段“序数”添加到表中时，我喜欢添加前缀，这样我就不必在 JOINS 中为其他表中的序数字段设置别名。有时它对 JOINS 很方便……不确定我是否看到了其他好处。

[MediaWiki](http://en.wikipedia.org/wiki/MediaWiki)（维基百科软件）使用该约定。下载源代码。它们将自己限制为两个字符的前缀。

我不推荐这种做法。对于大多数数据库来说，它不是必需的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-21T13:54:45.550

以这种方式（最少）命名字段是可以的，但对于主键和标题/名称。如果您始终将所有主键命名为 ID，并将名称命名为 Name，则构造查询将退化为多余的别名：

```
select i.id as invoice_id

v.id as vendor_id, p.id as product_id, 
v.name as vendor, p.name as product, b.name as branch, c.name as parcel,

i.total_amount,
i.discount,
i.invoice_date

from invoice i
join product p on i.product_id = p.id
join vendor v on i.vendor_id = v.id
join branch b on i.branch_id = b.id
join parcel c on i.parcel_id = c.id 
```

由于加入表格并显示实体的标题/名称是常态而不是例外，因此我以完整形式命名我的主键，并且对于标题/名称字段，与表名称相同。

```
create table product
(
product_id uuid not null, -- primary key
product text not null,
bar_code text not null default '',
rfid_code text  not null default '',
current_qty int default 0
);

create table vendor
(
vendor_id uuid not null, -- primary key
vendor text not null,
is_active boolean not null default true
);

create table branch
(
branch_id uuid not null, -- primary key
branch text not null,
sub_branch_of_id uuid,
current_sales money not null default 0,        
);

create table user
(
user_id uuid not null, -- primary key
user text not null,
password text not null default ''
); 
```

所以你的查询不会有多余的别名：

```
select i.invoice_id, p.product_id, v.vendor, p.product, b.branch, c.parcel,

i.total_amount,
i.discount,
i.invoice_date

from invoice i
join product p on o.product_code = p.product_code
join vendor v on o.vendor_code = v.vendor_code
join branch b on o.branch_code = b.branch_code
join parcel c on o.parcel_code = c.parcel_code 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-21T14:50:57.307

就个人而言，在“用户”表上，我的列只是“id”。

但是，指向该列的不同表上的任何外键列，我都会称该列为“user_id”。

所以你最终可能会得到这样的结果：

```
select  *
from    order
        inner join user
            on user.id=order.user_id 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-21T13:21:33.073

由于给出的所有原因，我认为这不是一个好主意。此外，您不会在类中的所有方法前面加上类名，对吗？那么为什么要对数据库对象这样做呢？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-21T12:55:52.953

前缀变体只是需要更长的时间来编写，并且使读取具有许多字段的 sql 语句变得更加困难。

即使您从多个表中进行选择，这也只会给您带来不必为不明确的字段加上表名前缀的好处。但

```
SELECT user.name, image.name FROM user, image 
```

与

```
SELECT user_name, image_name FROM user, image 
```

查询中没有歧义字段的好处很快就会被每次使用列名时必须键入表名的开销所消耗。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-21T13:00:41.430

这是一个**很棒**的练习：

1.  您会看到每个字段的含义，至少在它是什么领域。你无法弄清楚`amount`( `transactions`, `incomes`) 是什么意思——除非它们是`xac_amount`and `inc_amount`。大多数查询工具不会将别名与字段名称一起输出。
2.  当然，您可以使用表别名。但是 SQL 不需要它们，根据墨菲定律，如果不需要，就不会使用。没有标准，因此一位开发人员将使用`x`的别名 `transaction`，另一位将使用 `tran`，依此类推。

其实前缀只是强制的表别名，所以你可以很容易地看到哪个字段属于哪个表。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-05-03T05:01:28.697

如果您为每个表使用 UNIQUE PREFIX，则

*   无需使用别名进行连接（自连接除外）
*   数据库中的所有列的名称都应该是唯一的
*   您可以从列名本身（来自输出或选择查询）轻松识别表

# html - ie6不渲染图片

> ID：465141
> 
> 赞同：2
> 
> 时间：2009-01-21T12:45:30.663
> 
> 标签：html, internet-explorer-6

我这里有个小谜团：一个html页面在img声明之前有注释，像这样：

```
<!---->
<img src='shar.gif' alt='' class='center'/> 
```

另一个没有：

```
<img src='shar.gif' alt='' class='center'/> 
```

前一个图像在 ie6 中渲染，而后一个不是。两个页面都被声明为 XHTML 1.0 过渡，并且 w3c 验证器对两个页面的 html 和 css 都说 OK。Opera、Firefox、Safari 在这两种情况下都会渲染图像。即使 ie 7.0 和 ie 8.0 渲染相同。

这是一个小型本地版本的[健壮示例](http://dl.getdropbox.com/u/458861/working.zip)。这是一个[失败](http://dl.getdropbox.com/u/458861/notworking.zip)的例子。任何想法为什么（是否为空）在图像使其在 ie 中“可见”之前发表评论？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T13:08:26.733

我做了一个测试页：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
    <head>
        <title>img</title>
        <meta http-equiv=content-type content="text/html; charset=utf-8">
    </head>
    <body>
    <!---->
    <img src='smaller.jpg' alt='' class='center'/>
    </body>
</html> 
```

在 FF 3 和 IE 6 中对我来说效果很好。也许它与 CSS 有关？
请发布更广泛的样本...

# java - 奇怪的 JDBC 执行查询异常

> ID：465142
> 
> 赞同：0
> 
> 时间：2009-01-21T12:45:42.163
> 
> 标签：java, mysql, jdbc, large-query

我有以下代码：

```
 public Object RunQuery(String query) throws Exception{
    System.out.println("Trying to run query");
    Statement stmt = null;
    ResultSet rs = null;
    try {
        stmt = conn.createStatement();
        System.out.println("Got Statement");
        rs = stmt.executeQuery(query);
        System.out.println("Query executed");
        ...

    } catch (SQLException ex) {
        // handle any errors
        System.out.println("SQLException: " + ex.getMessage());
        System.out.println("SQLState: " + ex.getSQLState());
        System.out.println("VendorError: " + ex.getErrorCode());
    }
    catch (Exception ex) {
        System.out.println("Exception: " + ex.getMessage());
    }
    finally {
       if (rs != null) {
            try {
                rs.close();
            } catch (SQLException sqlEx) {
            } // ignore
            rs = null;
        }
        if (stmt != null) {
            try {
                stmt.close();
            } catch (SQLException sqlEx) {
            } // ignore
            stmt = null;
        }
       return ret;
    }
} 
```

运行时效果很好

```
query = "SELECT * FROM smalltable" 
```

但是失败了

```
query = "SELECT * FROM bigtable" 
```

其中有大约 20 万条记录。调试器优雅地忽略了 catch 块，直接进入 finally 块；当我将 stmt.executeQuery(query) 添加到监视列表时，NetBeans 给了我这个堆栈帧：

```
>Exception occurred in target VM: Communications link failure  Last packet sent to the server was 0 ms ago.  
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure  Last packet sent to the server was 0 ms ago.

at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)

at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)

at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)

at java.lang.reflect.Constructor.newInstance(Constructor.java:513)

at com.mysql.jdbc.Util.handleNewInstance(Util.java:406)

at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1074)

at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3009)

at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2895)

at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3438)

at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1951)

at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2101)

at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2548)

at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2477)

at com.mysql.jdbc.StatementImpl.executeQuery(StatementImpl.java:1422)

at RunQuery
Caused by: java.net.SocketException: Software caused connection abort: recv failed

at java.net.SocketInputStream.socketRead0(Native Method)

at java.net.SocketInputStream.read(SocketInputStream.java:129)

at com.mysql.jdbc.util.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:157)

at com.mysql.jdbc.util.ReadAheadInputStream.read(ReadAheadInputStream.java:188)

at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:2452)

at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2962)

... 9 more 
```

如何在这个框架中进行大型查询？

编辑：我正在使用 J 连接器和 mysql 服务器 5.1；连接字符串是

```
jdbc:mysql://localhost?user=root&password=password 
```

是的，我知道 select * 是一种不好的做法，但是正如您所见，我才刚刚开始，这或多或少是我正在做的第二次测试

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T14:31:28.050

我的直接想法是获取所有数据可能存在内存问题。我不知道如何为此目的设置 MySQL，但您可能想尝试在 ResultSet 中设置获取大小或通过选择更少的列来限制 ResultSet 大小。JDBC 驱动程序可能试图在一次操作中获取整个表。

作为旁注，请永远不要执行 stmt.executeQuery(query)。始终使用 PreparedStatement 并绑定您的查询参数。在您的示例中，没有参数，但这是一种对安全目的至关重要的做法。切勿将 SQL 与“文字”参数一起使用（例外情况是当您的文字是受信任的字符串时，例如代码中的常量或非字符串类型，例如您已经解析的数字）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T12:53:10.323

我能想到的唯一会导致差异的是某种网络级超时，Netbeans 输出肯定会指向这个方向。您使用的 JDBC 连接字符串是什么；也许有一个可以提高的超时参数？

如果问题仍然存在，则可能值得插入网络数据包嗅探器并查看该级别的通信情况。通过短查询和长查询来“找出差异”，您可能会很好地了解是什么导致一个失败而另一个成功。

（通常`select *`是一个坏主意，因为它不必要地带回了所有额外的数据。在这种情况下，与从较小的表中选择相比，从大表中的所有行中选择所有列显然会给连接带来麻烦。我知道在这种情况下您的问题仍然有效，因为有时您可能需要这样做，并且除了选择更大表的子集可能会做同样的事情，但我只是指出这一点作为一般准则以防万一您在生产中使用它作为快捷方式。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T01:46:37.830

如果它直接跳到finally，那么在其他代码中抛出的“异常”实际上是Error的后代吗？那将完全避免你的捕获。

你可能得到了 OutOfMemoryError，然后因为 OOME 关闭了一些东西而得到了网络异常？

# python - 将文本创建为位图的工具（消除锯齿文本、自定义间距、透明背景）

> ID：465144
> 
> 赞同：5
> 
> 时间：2009-01-21T12:45:55.423
> 
> 标签：python, fonts, bitmap, spacing, unix

我需要批量创建带有文本的图像。要求：

1.  任意大小的位图
2.  PNG格式
3.  透明背景
4.  黑色文本抗锯齿透明度
5.  可调整字符间距
6.  可调整的文本位置（文本开始的 x 和 y 坐标）
7.  TrueType 和/或 Type1 支持
8.  Unix 命令行工具或 Python 库

到目前为止，我已经评估了以下内容：

*   [Python 图像库](http://www.pythonware.com/library/pil/)：失败 5。
*   [ImageMagick](http://www.imagemagick.org/)（“标题”选项）：很难弄清楚 6。
*   [PyCairo](http://www.cairographics.org/documentation/pycairo/)：失败 5。
*   [SVG](http://www.w3.org/Graphics/SVG/) + [ImageMagick 转换](http://www.imagemagick.org/script/convert.php)：最有前途，虽然需要多种工具

PIL 的问题在于，例如 Verdana 的默认间距太稀疏了。我需要文本更紧凑一些，但没有办法在 PIL 中调整它。

在 ImageMagick 中，我还没有找到一种简单的方法来指定图像中文本的开始位置（我使用的是 -size WIDTHxHEIGHT 和标题：'TEXT'）。添加透明边框会将文本从它所锚定的角落移开，但是

*   由于边框增加了范围，因此需要相应调整图像大小
*   无法独立调整水平和垂直偏移

我是否错过了一些明显的替代方案或未能从上述内容中找到必要的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T13:51:57.007

(5) 确实看起来很棘手，没有在字符串中插入虚拟窄空格（这会破坏字距调整）或使用更高级别的东西，如 SVG 或 HTML/CSS 渲染器。

然而，如果你不介意弄脏你的手，看起来很容易破解 PIL 的 freetype 渲染器来添加水平空间。见[_imagingft.c](http://svn.effbot.org/public/pil/_imagingft.c)；在 font_getsize 和 font_render 中的以下代码之后：

```
if (kerning && last_index && index) {
    FT_Vector delta;
    FT_Get_Kerning(self->face, last_index, index, ft_kerning_default,
                   &delta);
    x += delta.x >> 6;
} 
```

添加：

```
if (last_index && index) {
    x += tracking;
} 
```

首先尝试使用纯整数进行跟踪（根据'>>6'判断可能相当大）；编译并查看它是否有效。下一步是将跟踪值从 Python 获取到 C 函数中，为此您必须将 font_render 中的 ParseTuple 调用更改为：

```
long tracking;
if (!PyArg_ParseTuple(args, "Ol|il:render", &string, &id, &mask, &tracking))
    return NULL; 
```

在 font_getsize 中：

```
long tracking;
if (!PyArg_ParseTuple(args, "O|l:getsize", &string, &tracking))
    return NULL; 
```

然后看你想要什么Python接口。这是通过界面的每一层添加额外的“跟踪”参数的一个微不足道但相当乏味的案例，例如：

```
def truetype(filename, size, index=0, encoding="", tracking= 0): # added optional tracking
    "Load a truetype font file."
    try:
        return FreeTypeFont(filename, size, index, encoding, tracking) # added tracking
    ...

class FreeTypeFont:
    "FreeType font wrapper (requires _imagingft service)"

    def __init__(self, file, size, index=0, encoding="", tracking= 0): # added tracking
        import _imagingft
        self.font = _imagingft.getfont(file, size, index, encoding)
        self.tracking= tracking # add this line

    ...

    def getmask2(self, text, mode="", fill=Image.core.fill):
        size, offset = self.font.getsize(text, self.tracking) # use tracking
        im = fill("L", size, 0)
        self.font.render(text, im.id, mode=="1", self.tracking) # use tracking
        return im, offset 
```

我没有测试过这些！如果它有效，可能值得作为补丁提交。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T13:53:48.797

这是 SVG + ImageMagick 解决方案：

基于此模板以编程方式创建 SVG 文档，将“TEXT HERE”替换为所需的文本内容：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE svg PUBLIC
      "-//W3C//DTD SVG 1.0//EN"
      "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg version="1.0" width="152px" height="50px">
  <text style="font-size: 22px; font-weight:bold; font-family: Verdana-Bold;
               letter-spacing: -1.3%;">
    <tspan x="10" y="39">TEXT HERE</tspan>
  </text>
</svg> 
```

使用 ImageMagick 将文档转换为背景透明的 PNG `convert`：

```
$ convert -background none input.svg output.png 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T14:36:45.887

一眼看去，[Pango](http://www.pango.org/)支持[字母间距](http://library.gnome.org/devel/pango/unstable/pango-Text-Attributes.html#pango-attr-letter-spacing-new)。Pango 具有 Python 绑定并与 Cairo 集成。

# java - JDBC Wrapper 教程 - 它仍然相关吗？

> ID：465157
> 
> 赞同：-1
> 
> 时间：2009-01-21T12:48:43.170
> 
> 标签：java, jdbc

IBM 的这篇关于 JDBC 包装器的文章看起来不错，我很想使用它：

[http://www.ibm.com/developerworks/java/library/j-jdbcwrap/index.html](http://www.ibm.com/developerworks/java/library/j-jdbcwrap/index.html)

但它的日期是 2001 年 - 它仍然与今天的最佳实践相关还是已经被其他更好的东西所取代？

非常感谢您的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T12:57:00.347

如果您不介意添加第三方库 - 看看 Spring。

他们有一些非常好的 JDBC 包装器和抽象——它们可以显着减少代码混乱。您最终会添加一个 XML 配置文件，但这未必是件坏事。

Spring 可以使用池库来帮助进行连接管理——这在企业环境中很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T13:04:16.587

还可以查看 Java Persistence API (JPA)。它是另一个抽象层，可以帮助您完全避免任何 SQL 或 DAO。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T12:53:47.357

简要浏览一下[Table](http://www.ibm.com/developerworks/java/library/j-jdbcwrap/sidetablejava.html)的源代码后，我强烈建议不要使用它，因为它对防止 SQL 注入没有任何作用。使用“普通 JDBC”，尤其是[PreparedStatement](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/PreparedStatement.html)会好很多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T12:28:28.547

[Spring](http://www.springsource.org/download) with [Hibernate](http://www.hibernate.org)是您所需要的。

# programming-languages - 您对于 Ioke 的观点是？

> ID：465168
> 
> 赞同：5
> 
> 时间：2009-01-21T12:50:52.137
> 
> 标签：programming-languages, ioke

JRuby 背后的大人物之一[Ola Bini](http://olabini.com/blog/)[`Ioke`](http://ioke.org)正在开发一种新的编程语言，名为： . 它受[`Io`](https://stackoverflow.com/questions/tagged/iolanguage)、[`Lisp`](https://stackoverflow.com/questions/tagged/lisp)和[`Smalltalk`](https://stackoverflow.com/questions/tagged/smalltalk)的影响[`Ruby`](https://stackoverflow.com/questions/tagged/ruby)。分享您对这种新的动态编程语言的看法

注意。[schildmeijer](https://stackoverflow.com/users/148909/schildmeijer)提出的问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T15:34:27.937

看起来很有趣，但目前只是一个概念证明。

如果您现在需要类似的东西，只需看看[IO 语言](http://iolanguage.org)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-09T03:48:54.870

Ioke 是一种用于创建 DSL 的非常有趣的语言。我发现可以扩展的简单语法（一切，甚至控制流，都是一条消息）很有趣。Ioke 中的宏支持很棒（在评估[或'激活']之前检索部分消息）。

Ioke 显然仍然是一个非常年轻的项目，但非常有前途。

进一步考虑，我对简单化的语法有点矛盾，因为我仍然希望有更多的语法糖——例如，在使用特殊语法时，恕我直言，控制块更具表现力——而不是纯粹的消息必须使用与任何其他消息相同的括号语法来实现。

我想这是一个品味问题——你是保持语言定义简单和“纯粹”，还是用更多的语法“玷污”它，让它更具表现力？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T13:28:30.780

AFAIK 这只是一场单人秀。一个人似乎极不可能承担使编程语言流行所需的所有工作，例如编写工具、库等。

因此，除非他能得到一家大公司的支持并使用他的语言或建立一个 IOKE 开发者社区，否则我认为他的语言注定要失败，无论它的性能/优雅程度如何。

在更肤浅的层面上，我不喜欢 IOKE 这个名字，主要是因为它应该如何发音并不明显。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T07:13:13.007

Ioke 给了我很大的启发。Ioke ebnf 语法是十几行。但它可以给我在 Forth、C++ 和 JS 中我喜欢的一切。此外，Ioke 还勇敢地使用 ascii-127 以外的字符作为运算符。

人的头脑只能处理非常简单的事物，但可以很容易地将它们抽象成高阶结构，然后像处理新的简单事物一样处理抽象。然后把几个抽象放在一起，一次又一次地抽象它们。每次都使用一些不同的方法将简单的事情概括为非常简单的事情。

Ioke 允许您创建新的方法来在每个不同的抽象级别上表达您的想法。你需要一种新的语法或新的方式来表达每个级别。您需要一个工具来创建工具。你不想迷失在抽象和细节中。

与其他语言的作者相比，Ioke 作者看到了人类思维的属性，他们没有足够的勇气看到有东西不仅在显示器后面，而且在它前面，这是一个人。但他们不应该受到责备，因为语言用户也对自己的思维机制视而不见。所以 Ioke 确实是对其他语言的扁平化进行攻击的勇敢尝试，因此也是对我们学习思维方式的扁平化的攻击。

# c# - 在 C#/.NET 中合并两个图像

> ID：465172
> 
> 赞同：94
> 
> 时间：2009-01-21T12:52:44.253
> 
> 标签：c#, .net, image

简单的想法：我有两张要合并的图像，一张是 500x500，中间是透明的，另一张是 150x150。

基本思路是这样的：创建一个 500x500 的空画布，将 150x150 的图像放在空画布的中间，然后将 500x500 的图像复制到上面，这样它的透明中间就可以让 150x150 的图像透过。

我知道如何在 Java、PHP 和 Python 中做到这一点......我只是不知道在 C# 中使用什么对象/类，一个将图像复制到另一个图像的快速示例就足够了。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-01-21T12:59:58.297

基本上我在我们的一个应用程序中使用它：我们想在视频帧上覆盖一个播放图标：

```
Image playbutton;
try
{
    playbutton = Image.FromFile(/*somekindofpath*/);
}
catch (Exception ex)
{
    return;
}

Image frame;
try
{
    frame = Image.FromFile(/*somekindofpath*/);
}
catch (Exception ex)
{
    return;
}

using (frame)
{
    using (var bitmap = new Bitmap(width, height))
    {
        using (var canvas = Graphics.FromImage(bitmap))
        {
            canvas.InterpolationMode = InterpolationMode.HighQualityBicubic;
            canvas.DrawImage(frame,
                             new Rectangle(0,
                                           0,
                                           width,
                                           height),
                             new Rectangle(0,
                                           0,
                                           frame.Width,
                                           frame.Height),
                             GraphicsUnit.Pixel);
            canvas.DrawImage(playbutton,
                             (bitmap.Width / 2) - (playbutton.Width / 2),
                             (bitmap.Height / 2) - (playbutton.Height / 2));
            canvas.Save();
        }
        try
        {
            bitmap.Save(/*somekindofpath*/,
                        System.Drawing.Imaging.ImageFormat.Jpeg);
        }
        catch (Exception ex) { }
    }
} 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-01-21T12:58:41.077

这会将图像添加到另一个图像。

```
using (Graphics grfx = Graphics.FromImage(image))
{
    grfx.DrawImage(newImage, x, y)
} 
```

图形在命名空间中`System.Drawing`

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2012-07-13T14:56:56.453

毕竟，我发现了一个新的更简单的方法试试这个..

它可以将多张照片连接在一起：

```
public static System.Drawing.Bitmap CombineBitmap(string[] files)
{
    //read all images into memory
    List<System.Drawing.Bitmap> images = new List<System.Drawing.Bitmap>();
    System.Drawing.Bitmap finalImage = null;

    try
    {
        int width = 0;
        int height = 0;

        foreach (string image in files)
        {
            //create a Bitmap from the file and add it to the list
            System.Drawing.Bitmap bitmap = new System.Drawing.Bitmap(image);

            //update the size of the final bitmap
            width += bitmap.Width;
            height = bitmap.Height > height ? bitmap.Height : height;

            images.Add(bitmap);
        }

        //create a bitmap to hold the combined image
        finalImage = new System.Drawing.Bitmap(width, height);

        //get a graphics object from the image so we can draw on it
        using (System.Drawing.Graphics g = System.Drawing.Graphics.FromImage(finalImage))
        {
            //set background color
            g.Clear(System.Drawing.Color.Black);

            //go through each image and draw it on the final image
            int offset = 0;
            foreach (System.Drawing.Bitmap image in images)
            {
                g.DrawImage(image,
                  new System.Drawing.Rectangle(offset, 0, image.Width, image.Height));
                offset += image.Width;
            }
        }

        return finalImage;
    }
    catch (Exception ex)
    {
        if (finalImage != null)
            finalImage.Dispose();

        throw ex;
    }
    finally
    {
        //clean up memory
        foreach (System.Drawing.Bitmap image in images)
        {
            image.Dispose();
        }
    }
} 
```

# sql-server-2005 - 如何在数据库之间切换

> ID：465173
> 
> 赞同：2
> 
> 时间：2009-01-21T12:52:59.823
> 
> 标签：sql-server-2005

我们的应用程序使用一个每天更新一次的大型产品数据库。更新需要大量时间和资源。这就是为什么我们更新产品数据库的备份并在更新完成后切换到它。

现在在数据库之间切换的唯一方法是滥用我们的负载均衡器。应用程序始终使用相同的 ip 访问数据库服务器。负载均衡器决定如何解析这个 IP：更新后它使用更新服务器的 ip。

这是一个可怕的黑客攻击。有什么好方法可以在数据库之间切换吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T14:28:33.687

听起来你只是从数据库中读取。如果是这种情况，请查看 SQL Server 2005 的快照功能。您可以拥有数据库的只读快照，并像普通数据库一样查询它。

不要指向您的实时数据库，而是指向一个固定的快照名称，例如 ReadOnlyCopy。在实时数据库中进行正常加载，加载完成后，删除快照并拍摄另一个快照。快照过程非常快。

这也有其他一些优点：

*   它避免了负载均衡器的成本/延迟问题。
*   如果您的负载出现严重错误，您可以使用快照在实时数据库中插入/更新记录
*   它需要更少的磁盘空间，因为两个完整副本不需要两倍的空间
*   它释放了您的备份/恢复计划，因此您可以在正确的时间为应用程序执行此操作，而不是在正确的时间执行日常负载

这是一篇来自 Simple Talk 的好文章，解释了 2005 年快照的概念：

[http://www.simple-talk.com/sql/database-administration/sql-server-2005-snapshots/](http://www.simple-talk.com/sql/database-administration/sql-server-2005-snapshots/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T12:58:14.010

一些不同的选择：

1）修改您的应用程序连接到的数据库。在两者之间来回切换。

2）将您的处理和更新到临时数据库中，然后将更改复制到您的实时数据库中。

# sql-server - 通过 TSQL 的 SQL Server 安全性

> ID：465180
> 
> 赞同：5
> 
> 时间：2009-01-21T12:54:13.673
> 
> 标签：sql-server, security, tsql

我想构建一个事务 sql 脚本，该脚本将阻止指定人员对所有数据库运行某些命令：

```
drop database, drop table or preferbly drop *

delete

update 
```

这可能吗？用户将已经可以访问服务器。

注意：我不是在尝试为服务器开发安全模型，也不是为了防止恶意攻击。这是一个现有的服务器，人们可以通过他们所属的各种 Windows 组拥有一系列访问权限。我只想知道是否有一种快速的保护措施来防止人们在错误的服务器上错误地运行命令。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T12:57:41.450

（**警告**，这是每个数据库；我不知道任何服务器范围的东西，因为数据库是主要的独立单元）

大概您的用户不是架构（或 dbo）的所有者？在这种情况下，除非您 GRANT，否则他们应该无法访问任何东西。因此，不要[授予](http://msdn.microsoft.com/en-us/library/ms188371.aspx)他们不需要的访问权限，[撤消](http://msdn.microsoft.com/en-us/library/ms187719.aspx)您错误授予的任何访问权限，并[拒绝](http://msdn.microsoft.com/en-us/library/ms173724.aspx)您绝对不希望他们做的任何事情。

另请参阅[MSDN](http://msdn.microsoft.com/en-us/library/aa215478(SQL.80).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T12:58:32.010

我知道可靠地限制特定权限的唯一方法是使用存储过程。非常安全，但不是动态的。

> 在安全性方面，存储过程提供了显着的好处。通过使用存储过程，您可以向某些用户授予访问数据的权限，从而减少您需要在客户端应用程序中执行的大量编码。这是控制对数据的访问的最佳方法之一。

[http://www.wwwcoder.com/main/parentid/191/site/4004/68/default.aspx](http://www.wwwcoder.com/main/parentid/191/site/4004/68/default.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T19:03:58.870

如果您使用的是 SQL Server 2005 或 2008，最好的答案是已经给出的答案，那就是 DDL 触发器。正确编写的 DDL 触发器甚至会阻止具有系统管理员权限的人执行任何类型的 DDL 操作。系统管理员可以禁用触发器来执行工作，或者可以编写触发器以允许某些人执行工作，因此您仍然可以根据需要进行修改。

如果您使用的是 SQL Server 2000（或更低版本），您唯一的办法就是检查每个登录名/用户的安全权限。最终，即使您使用的是 SQL Server 2005 或 2008，这也是需要完成的事情，但在以前的版本中没有捷径可走。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T15:26:16.253

你不能真正检查你是否看到 drop 命令，因为有人可能会做这样的事情

想象一下这有 exec 而不是 print

```
print ( convert(varchar(50), 0x64726F7020646174616261736520616263)) 
```

你可以只给他们读权限，只给他们对存储过程的执行权限

您还可以使用 DDL 触发器 [http://msdn.microsoft.com/en-us/library/ms190989.aspx](http://msdn.microsoft.com/en-us/library/ms190989.aspx)

这是一个例子

```
CREATE TRIGGER safety 
ON DATABASE 
FOR DROP_TABLE, ALTER_TABLE 
AS 
   PRINT 'You are not allowed to drop or alter tables!' 
   ROLLBACK
; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T15:43:48.417

Cindi - 查看 DENY 权限命令以获得对用户功能的细粒度控制。

不过，我还必须问一个更深层次的问题。为什么这些人*可以通过 SQL 命令行访问您的数据库？* 也就是说，如果他们甚至不应该能够删除或更新记录，那么他们有什么可能的理由来获得对 SQL 命令行的访问权限呢？

我真的不认为你需要知道如何拒绝权限。您需要重新考虑您的整体数据访问策略，以便完全避免为这些人提供帐户。听起来您需要仅通过前端应用程序来限制他们对数据的访问。

更新：我可以设想的一种情况是，如果您有一些只生成报告的人。在这种情况下，您应该创建一个具有一揽子 DENY 状态的帐户，然后仅对 Select 和特定存储过程（仅提取对报告有用的数据的那些）授予权限。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T18:01:04.973

虽然我在我目前工作的地方使用 SQL Server，但我并没有过多地处理它的安全方面。我想你可以对 SQL Server 做同样的事情，就像在 Oracle 中一样（我有更多的经验）。

撤消所有访问权限，然后只添加每个用户需要的访问权限。使用用户组将它们聚集在一起并便于权限管理。

看起来您要限制的用户应该只有：

*   连接到服务器所需的任何特权（并可能选择数据库）
*   选择访问特定模式中的所有表和视图
*   插入对特定模式中所有表的访问
*   可能对某个模式中的某些存储过程执行特权

不应该授予其他任何东西。

# c# - 计算带宽 #2

> ID：465212
> 
> 赞同：1
> 
> 时间：2009-01-21T13:04:13.590
> 
> 标签：c#

我使用 [this][1] [1] 成功计算了我的应用程序（连接到 Web 服务以发送文件）消耗的带宽：[计算带宽](https://stackoverflow.com/questions/442409)我使用了 Rasmus Faber 提供的代码...有一件事情让我感到困惑：收到字节远远多于发送的字节......就我而言，我正在发送图像，xml文件等并返回错误代码..因此发送的字节应该更多？……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T13:24:19.807

[我会使用System.Net](http://blogs.msdn.com/dgorti/archive/2005/09/18/471003.aspx) tracking 或[Wireshark](http://www.wireshark.org)查看我通过网络发送的内容。这将准确地告诉您通话中发生了什么。

# url-rewriting - Helicon Tech - ISAPI_Rewrite：特定域的 RewriteRule

> ID：465216
> 
> 赞同：1
> 
> 时间：2009-01-21T13:04:39.987
> 
> 标签：url-rewriting

有人可以帮我将以下伪代码翻译成[Helicon Tech 的 ISAPI_Rewrite 模块](http://www.isapirewrite.com/)可以理解的代码：

```
if (domain == something.com OR domain == www.something.com)
{
    // The rules inside this scope will only apply to the domain:
    // something.com / www.something.com

    // This should match "something.com/test" and/or "www.something.com/test"
    RewriteRule /something /something/something.aspx
}

if (domain == test.com OR domain == www.test.com)
{
    // The rules inside this scope will only apply to the domain:
    // test.com / www.test.com

    // This should match "test.com/test" and/or "www.test.com/test"
    RewriteRule /test /test/test.aspx
} 
```

[文档](http://www.isapirewrite.com/docs/)让我很困惑。

非常感谢任何和所有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T13:10:00.537

如果 ISAPI_Rewrite 和 Apache 的 mod_rewrite 一样，试试这个：

```
RewriteCond %{HTTP_HOST} ^(www\.)?something\.example$
RewriteRule ^/something$ /something/something.aspx

RewriteCond %{HTTP_HOST} ^(www\.)?test\.example$
RewriteRule ^/test$ /test/test.aspx 
```

[注意：我根据RFC 2606](http://www.rfc-editor.org/rfc/rfc2606.txt)使用了其他域名。

* * *

**编辑：**似乎对于 ISAPI_Rewrite 您必须替换`%{HTTP_HOST}`by[`Host:`](http://www.isapirewrite.com/docs/#RewriteCond)才能获取当前主机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T13:23:31.290

这是版本 3 之前使用的“旧”语法：

```
RewriteCond Host: ^(www\.)?something\.com$
RewriteRule ^/something$ /something/something.aspx

RewriteCond Host: ^(www\.)?something\.com$
RewriteRule ^/test$ /test/test.aspx 
```

这将是版本 3 及更高版本的新语法。这更接近 mod_rewrite：

```
RewriteCond %{HTTP:Host} ^(www\.)?something\.com$
RewriteRule ^/something$ /something/something.aspx

RewriteCond %{HTTP:Host} ^(www\.)?something\.com$
RewriteRule ^/test$ /test/test.aspx 
```

正则表达式本身在两个版本中都是相同的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-12T07:05:56.150

请注意，ISAPI 3 轻量版不支持上述每个目录的 httpd.ini 方法：[http ://www.helicontech.com/isapi_rewrite/doc/litever.htm](http://www.helicontech.com/isapi_rewrite/doc/litever.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T13:54:17.780

感谢 Gumbo 和 Tomalak 的努力。真的很感激。

不过，我想出了另一种方法：您将一个包含特定重写的文件（httpd.ini）放在该虚拟目录/域的根文件夹中的特定虚拟目录/域中。

这也消除了对全局配置文件的污染。

# linux - 安装后的 Bugzilla 错误：“TEST-FAILED Web 服务器未执行 CGI 文件”

> ID：465222
> 
> 赞同：3
> 
> 时间：2009-01-21T13:07:25.113
> 
> 标签：linux, apache, bugzilla

我想在我的 linux 服务器上安装 Bugzilla。安装成功，但出现以下错误：

```
TEST-FAILED Web 服务器未执行 CGI 文件

```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T13:16:57.060

从[Bugzilla 配置指南](http://www.bugzilla.org/docs/2.18/html/configuration.html)：

**2.2.4.1。阿帕奇 httpd**

要配置您的 Apache Web 服务器以使用 Bugzilla，请执行以下操作：

1.  在编辑器中加载 httpd.conf。在 Fedora 和 Red Hat Linux 中，该文件位于 /etc/httpd/conf 中。
2.  Apache 使用指令来允许细粒度的权限设置。将以下行添加到适用于 Bugzilla 安装位置的指令。（如果这样的部分不存在，您需要添加一个。）在此示例中，Bugzilla 已安装在 /var/www/html/bugzilla。

检查这个：

```
<Directory /var/www/html/bugzilla>
   AddHandler cgi-script .cgi
   Options +Indexes +ExecCGI
   DirectoryIndex index.cgi
   AllowOverride Limit
</Directory> 
```

这些指令允许 Apache 运行在 bugzilla 目录中找到的 .cgi 文件；如果有人只在浏览器中键入目录名称，则指示服务器查找名为 index.cgi 的文件；并允许 Bugzilla 的 .htaccess 文件覆盖全局权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-06T19:41:04.607

将 SELinux 设置更改为许可对我有用。

在 Fedora Core 和 RedHat Enterprise 中，编辑 /etc/selinux/config，您将看到如下几行：

```
# This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
# enforcing - SELinux security policy is enforced.
# permissive - SELinux prints warnings instead of enforcing.
# disabled - No SELinux policy is loaded.
SELINUX=enforcing
# SELINUXTYPE= can take one of these two values:
# targeted - Only targeted network daemons are protected.
# strict - Full SELinux protection.
SELINUXTYPE=targeted 
```

...只需更改`SELINUX=enforcing`为`SELINUX=permissive`，您就完成了。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-21T13:09:48.917

您可以尝试阅读[Apache 文档](http://httpd.apache.org/docs/2.2/)，它应该包含您需要的所有内容。

# php - curl和php问题——空白页

> ID：465225
> 
> 赞同：0
> 
> 时间：2009-01-21T13:08:17.233
> 
> 标签：php, curl

我正在尝试将保存在 url 中的图像下载到本地文件夹，并使用 curl 进行了以下尝试。我想知道是否有必要包含 curl 或单独下载它，或者我的功能是否可以正常工作。我想知道我在下面的实现是否有任何明显的问题。我知道 sql 漏洞，我正在切换到准备好的语句。为简洁起见，我已经修剪了代码的不相关部分。

编辑：函数不在while循环中。如果我注释掉该函数的调用，该页面就会显示，否则我只会得到一个空白页面。为什么是这样

```
<?php
header("Content-Type: text/html; charset=utf-8");
if (isset($_GET["cmd"]))

  $cmd = $_GET["cmd"];

else

  die("You should have a 'cmd' parameter in your URL");

 $pk = $_GET["pk"];

$con = mysql_connect("localhost","someuser","notreal");

if(!$con)

{

die('Connection failed because of' .mysql_error());

}
mysql_query('SET NAMES utf8'); 

mysql_select_db("somedb",$con);

if($cmd=="GetAuctionData")

{

$sql="SELECT * FROM AUCTIONS WHERE ARTICLE_NO ='$pk'";

$sql2="SELECT ARTICLE_DESC FROM AUCTIONS WHERE ARTICLE_NO ='$pk'";

$htmlset = mysql_query($sql2);

$row2 = mysql_fetch_array($htmlset);

$result = mysql_query($sql);

function savePicture($imageUrl) {
    $ch = curl_init();
    curl_setopt ($ch, CURLOPT_URL, $lastImg);
    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, 0);
    $fileContents = curl_exec($ch);
    curl_close($ch);
    $newImg = imagecreatefromstring($fileContents);
    return imagejpeg($newImg, "./{$pk}.jpg",100);
}

while ($row = mysql_fetch_array($result))
{

$lastImg = $row['PIC_URL']; 

savePicture($lastImg);

<div id='rightlayer'>

<img src='./".$pk.".jpg' width='".$outputWidth."' height='".$outputHeight."'>

</div>

</div>

</div>";

}

}

mysql_free_result($result); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T13:59:11.157

如果在循环运行多次时在循环内声明函数，则会出现错误。所以你应该在`savePicture`外面声明这个函数`while`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T13:56:53.970

我会将函数定义从 while 块中取出。

在我看来，您使用 curl 是为了在这里使用 curl，更简单的方法是使用[file get contents](http://php.net/file_get_contents)。

# java - Jfreechart 选择

> ID：465229
> 
> 赞同：7
> 
> 时间：2009-01-21T13:09:46.777
> 
> 标签：java, graph, jfreechart

有没有办法能够单击绘图上的一段并让 jfreechart 告诉我该点的 x/y 坐标或以某种方式返回与该线关联的相应数据？

jfreechart 是否有任何与情节交互的包？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T16:35:43.447

实现[ChartMouseListener](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/ChartMouseListener.html)接口将在用户单击图表时为您提供 ChartMouseEvents。ChartMouseEvent 提供了一个[ChartEntity](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/ChartMouseEvent.html#getEntity())来为您提供有关所单击内容的特定信息。

我相信在 JFreeChart 开发人员指南中有一个演示如何捕获图表鼠标事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T13:52:43.087

在 JFreeChart 类中查看此方法：

```
public BufferedImage createBufferedImage(int width, int height,
                                             ChartRenderingInfo info) 
```

您传递了一个 ChartRenderingInfo 实例，您可以稍后使用它来获取有关各个部分的信息，使用如下代码：

```
ChartEntity entity = info.getEntityCollection().getEntity(x, y); 
```

有关其他可用信息，请参阅 ChartRenderingInfo 的 javadoc。

# c# - 在命令窗口中从 WindowsForms 应用程序获取退出代码

> ID：465231
> 
> 赞同：2
> 
> 时间：2009-01-21T13:09:51.257
> 
> 标签：c#, winforms, command-line, exit-code

我正在从命令提示符启动一个 Windows 窗体应用程序，我需要获取 Windows 窗体应用程序生成的退出代码。命令 promt 启动应用程序并立即返回。但应用程序在后台执行。有没有办法获得退出代码？

亲切的问候

基督教。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-21T13:43:37.770

答案是

```
开始 /wait [你的命令]

```

进而

```
回显%错误级别%

```

提取返回值。

--

而且因为我喜欢写批处理文件……（这是我的问题……）

```
@echo 关闭
echo 等待程序退出...
开始/等待 %*
echo 返回码是 %errorlevel%

```

使用 .bat 扩展名将其保存在某处。使用要运行的程序的命令行作为参数运行它。它会运行你给它的命令，等待它结束，然后打印返回值。

您还可以通过用您的应用程序替换 start /wait 行来对程序进行硬编码，因为正如文档（start /？）所说：

> 执行 32 位 GUI 应用程序时，CMD.EXE 不会等待应用程序终止，然后返回命令提示符。如果在命令脚本中执行，则不会发生此新行为。

无论是否启用命令扩展，如果从脚本调用 CMD 将等待 winform。

# cocoa-touch - 如何水平翻转 UILabel？

> ID：465234
> 
> 赞同：4
> 
> 时间：2009-01-21T13:10:15.373
> 
> 标签：cocoa-touch

我想使用实用程序模板开发一个 iPhone 应用程序，其中反面是半透明的，显示主视图的内容，水平翻转。

> 编辑：为了创建半透明翻转侧的错觉，我会在翻转视图上显示与主视图相同的内容，但镜像内容并降低 alpha。

是否可以使用 UILabel 显示文本，但镜像文本，即水平翻转它？苹果开发页面在这个问题上没有给我任何帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-21T14:08:26.817

正如 August 所说，我不确定您对此的用例，但使用 Core Animation 有一种相当简单的方法。首先，您需要将 QuartzCore 框架添加到您的项目中并执行

```
#import <QuartzCore/QuartzCore.h> 
```

在你的标题中的某个地方。

然后，您可以使用以下命令对 UILabel 的底层应用旋转变换：

```
yourLabel.layer.transform = CATransform3DMakeRotation(M_PI, 0.0f, 1.0f, 0.0f); 
```

这会将标签的 CALayer 绕 Y 轴旋转 180 度（pi 弧度），从而产生您正在寻找的镜像效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T13:38:47.890

在实用程序模板中，背面未显示为半透明。这很可能是出于 iPhone 上的性能原因。如果标签不提供任何功能，我不确定翻转标签是否有任何价值。

也就是说，我会调查 UIView 的`transform`属性。

# c# - Silverlight 是否有任何可用的 C# Dynamic Mock 框架？

> ID：465235
> 
> 赞同：1
> 
> 时间：2009-01-21T13:10:39.383
> 
> 标签：c#, silverlight, unit-testing, mocking

我想在测试 Silverlight 应用程序时使用动态模拟。我尝试过 Moq 和 Rhino，但这些框架程序集无法添加到 silverlight 项目，因为它们与 silverlight 运行时不兼容。

是否存在允许我在 silverlight 运行时中使用模拟对象的现有 silverlight 模拟框架（或 moq 补丁）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T05:35:55.507

Moq 的最新版本也具有完全支持的 Silverlight 版本...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T10:59:48.300

[Ayende Rahien](http://ayende.com/projects/rhino-mocks/downloads.aspx)提供了一个工作版本的 Rhino Mocks ，我在上周尝试过，它在 Silverlight 运行时中正常工作。很高兴看到 Silverlight 中现在可以使用模拟对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T15:13:46.230

[有一个名为SilverUnit](http://www.typemock.com/Silverlight_unit_testing_page.php)的开源框架，它位于 Typemock 之上。它是模拟[Silverlight的好工具](http://www.typemock.com/Silverlight_unit_testing_page.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-24T07:23:10.040

嗨，我会推荐[telerik 的 JustMock 框架](http://www.telerik.com/products/mocking.aspx)。它与 Silverlight 单元测试框架（Toolkit 2010 年 4 月）配合得很好。

不幸的是，它不是开源的，但有试用版...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T15:47:25.853

是和不是:-)

我相信 Moq 目前可以在 Silverlight 内部运行，但无法获得状态。据我所知，没有可以在 Silverlight 下运行的模拟框架。

但是，您可以在 Visual Studio 中运行 Silverlight 代码并在那里对其进行单元测试。不完全一样，但它确实提供了一些有趣的功能，比如使用现有工具。有关详细信息，请查看Roy Osherove 的[这篇博文。](http://weblogs.asp.net/rosherove/archive/2008/12/27/unit-testing-in-silverlight-land-with-typemock-isolator.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-22T16:04:29.380

Moq 已移植到 Silverlight 下运行。它将与 Moq 的下一个版本（即将推出）一起发布。或者您可以从 code.google.com/p/moq 中拉出后备箱并自己编译...

# .net - XPathReader 发生了什么

> ID：465237
> 
> 赞同：21
> 
> 时间：2009-01-21T13:11:29.770
> 
> 标签：.net, xml, xpath, sax

XPathReader 是/是正读 XML 解析器（基于 XMLReader 构建）的实现，它允许您注册 XPath 查询以供它查找（或至少称为[Sequential XPath](http://www.idealliance.org/papers/xml2001/papers/html/05-01-01.html)的 XPath 子集）。这似乎是轻松访问 xml 流元素的完美选择，或者您只需要从大型 xml 文档的开头提取一些信息，因此不想将整个内容加载到内存中的情况。

对于其中一位 MS 人员在 2003/2004 年发布的开源实现，似乎有一阵兴奋，例如：

[http://donxml.com/allthingstechie/archive/2004/02/26/430.aspx](http://donxml.com/allthingstechie/archive/2004/02/26/430.aspx)

[http://msdn.microsoft.com/en-us/library/ms950778.aspx](http://msdn.microsoft.com/en-us/library/ms950778.aspx)

[http://www.tkachenko.com/blog/archives/000472.html](http://www.tkachenko.com/blog/archives/000472.html)

但在那之后，这条小路似乎干涸了。对托管实施的位置 ( [http://workspaces.gotdotnet.com/xpathreader](http://workspaces.gotdotnet.com/xpathreader) ) 的引用似乎不再有效。有谁知道发生了什么事，为什么感兴趣的人消失了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T17:45:56.020

XNode.ReadFrom 将 Linq to XML 的强大功能（和支持的状态）与处理流而不是将整个文件加载到内存中的能力相结合

[http://msdn.microsoft.com/en-us/library/system.xml.linq.xnode.readfrom.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xnode.readfrom.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-27T16:14:52.457

似乎ms在[这里](http://www.microsoft.com/downloads/details.aspx?FamilyID=db0c5fae-111d-4b24-b10c-e4cdb13705da&DisplayLang=en)发布了这个并且安装包括源代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-21T16:10:40.173

我怀疑 LINQ-to-XML 发生了。但是，[CodePlex 上的 Mvp.Xml 项目](http://www.codeplex.com/MVPXML)有许多与此相关的功能。您可能想看看他们开发的[XPointer.NET](http://www.codeplex.com/MVPXML/Wiki/View.aspx?title=XPointer.NET&referringTitle=XInclude.NET)[`XPointerReader`](http://www.codeplex.com/MVPXML/Wiki/View.aspx?title=XPointer.NET&referringTitle=XInclude.NET)库和.

另外，您可能想看看[CodeProject 上的这个 FastXPathReader](http://www.codeproject.com/Articles/18740/Fast-screen-scraping-with-XPath-over-a-modified-Xm)（我不知道它的效果如何）。

至于 XPathReader，我只能找到您提供的链接以及与这些链接相关的链接。好像消失了一样。就像我说的，我认为 LINQ-to-XML 是结果，但我只是猜测。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-27T07:36:00.807

今天发现自己问了同样的问题，因为我打算构建一个 BizTalk 管道组件来解析特定元素的传入消息。

经过一番谷歌搜索，我发现 XPathReader 程序集随 BizTalk 一起提供，并且驻留在 GAC 中。

只需引用 GAC 程序集 Microsoft.BizTalk.XPathReader.dll 即可启动并运行！

# c# - 从列表中提取结果 使用 LINQ

> ID：465238
> 
> 赞同：0
> 
> 时间：2009-01-21T13:11:30.440
> 
> 标签：c#, .net, linq

我有一份客户名单

```
List<Customers> cust = new List<Customers>();
cust.Add(new Customers(){ID=1, Name="Sam", PurchaseDate=DateTime.Parse("01/12/2008")});
cust.Add(new Customers(){ID=2, Name="Lolly" PurchaseDate=DateTime.Parse("03/18/2008")}); 
```

我想显示 2 个单独的结果，例如：

客户在 Yr 中的购买 // 按年份分组并显示 id,name
按客户在 Yr - Month 中购买 // 按年份然后月份分组并显示 id,name

另外，如果我想订购年份怎么办？

更新：

只是多了一个。如果我在 Customer 类中有一个名为“Status”的字段，其中任何一个值“Y”、“N”、“C”代表是、否并取消我将如何创建查询以给出百分比

Y - 20% N - 30% C - 50%

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T13:30:07.440

按年份分组：

```
var groupByYear = customers.GroupBy(customer => customer.PurchaseDate.Year);

foreach (var group in groupByYear)
{
    Console.WriteLine("Year: {0}", group.Key);
    foreach (var customer in group)
    {
        Console.WriteLine("{0}: {1}", customer.ID, customer.Name);
    }
} 
```

按年和月分组：

```
var groupByYearMonth = customers.GroupBy(customer => 
     new DateTime(customer.PurchaseDate.Year, customer.PurchaseDate.Month, 1));
foreach (var group in groupByYear)
{
    Console.WriteLine("Year/month: {0}/{1}", group.Key.Year, group.Key.Month);
    foreach (var customer in group)
    {
        Console.WriteLine("{0}: {1}", customer.ID, customer.Name);
    }
} 
```

订购：

```
var ordered = customers.OrderBy(customer => customer.PurchaseDate.Year); 
```

所有这些都使用“点表示法”而不是查询表达式，因为它们非常简单 - 但如果您愿意，您可以使用查询表达式。

编辑：对于状态部分，只需使用[David B's answer](https://stackoverflow.com/questions/465238/extract-results-from-listcustomers-using-linq#465561)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T14:40:29.997

```
int total = customer.Count()

var counts = customers.GroupBy( c => c.Status )
  .Select( g => new
  {
    Status = g.Key,
    TheRatio = (g.Count() * 100) / total;
  }) 
```

# asp.net - 复杂的 ASP.NET Web 应用程序和 nant

> ID：465240
> 
> 赞同：4
> 
> 时间：2009-01-21T13:12:10.953
> 
> 标签：asp.net, visual-studio-2008, build-process

在一个内部网上工作，我们有大约 20 个不同的 Web 应用程序——一些是 .net，一些是经典的 asp。

目前每个 .net 应用程序都有自己的解决方案。这样做有好处——我们可以只构建和部署一个应用程序，而不影响其他应用程序，并且所有应用程序共享一个会话——但是我们不能使用母版页，使用本地化资源、共享 css 和 js 存在真正的挑战等。构建和部署完全是手动完成的，这是一个真正的问题。

我正在尝试建立一个结构，使我们能够利用 VS2008 功能，但仍然能够更新一个应用程序而不影响其他应用程序，同时仍然使用母版页和本地化资源等功能，以及在应用程序之间共享会话（所以我们不能为每个应用程序设置虚拟目录）。

如果我设置如下所示的单一解决方案：

```
/根
 - App_GlobalResources/
 - 共享
   -- 母版页/
   --css/
 - 应用程序1/
 - 应用程序2/
...
 - 应用N/
..
 - 经典ASP1/

```

那么问题是构建只生成一个 DLL (Root.dll) - 这根本无法扩展到 20 多个应用程序，所有这些应用程序都有不同的开发周期。

是否可以（使用 nant 或其他构建工具）构建多个 DLL？在这种情况下，我想最终得到 Root.dll（至少包含全局资源）以及 App1.dll 和 App2.dll。

我应该看看其他任何建议或参考资料吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T14:16:04.273

可悲的是，我不确定你能做你想做的事。VS 倾向于为每个唯一项目（不是解决方案）创建一个 DLL，并且看起来您只有一个项目，因此，只有一个 DLL。

我建议您为每个应用程序保留一个项目 (csproj)，但使用 NANT 将它们全部构建（即，一次一个，一起，按顺序），并将它们全部打包以进行部署。这样，您可以进行单点部署，但仍将应用程序分开。

我很惊讶您不能在子文件夹中使用母版页。您需要为每个 AppN 文件夹复制它们，但同样 - 当您构建部署包时，NANT 可用于从公共位置提取它们。

编写构建和部署脚本需要一段时间才能正确完成，但我发现一旦完成，它很快就会收回成本——即使唯一的回报是你的理智！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T16:01:55.637

我建议使用 MSBuild 而不是 Nant。它更原生于视觉工作室。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T14:35:33.390

这个问题有一个解决方案。简而言之，它需要创建一个网站项目（可以有母版页和诸如此类的东西）和几个子目录，每个子目录都包含一个 Web 项目。在主 Web 项目中，您从项目中排除子目录。然后将项目文件添加到解决方案中。这个（更新的）[链接](http://weblogs.asp.net/scottgu/archive/2006/08/16/tip_2f00_trick_3a00_-creating-sub_2d00_web-projects-using-the-vs-2005-web-application-project-option.aspx)告诉你所有关于它的信息。

-Edoode

# java - 哪个开源 java 库提供了一种简单的方式来读写 ESRI Shapefile？

> ID：465245
> 
> 赞同：3
> 
> 时间：2009-01-21T13:15:40.057
> 
> 标签：java, open-source, shapefile

对于一个项目，我需要读写 ESRI shapefile。这应该很容易，因为我不需要高级功能。外面有东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T14:30:19.830

[GeoTools](http://geotools.codehaus.org/)通过插件支持 shapefile。GIS 是一个复杂的领域，我认为您会发现那里很少有“简单”的库。不幸的是，任何强大到足以执行通用 GIS 的库都会有学习曲线。也就是说，[Shapefile](http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf)并没有那么复杂，并且有很多代码[可供](http://shapelib.maptools.org/)参考。

# html - 在 Windows 窗体上显示 HTML 内容的最佳方式是什么？

> ID：465258
> 
> 赞同：16
> 
> 时间：2009-01-21T13:22:27.597
> 
> 标签：html, vb.net, webbrowser-control

我想在我的应用程序中显示 HTML 格式的内容，最好是在 Web 浏览器控件中。

我可以先创建一个 HTML 文档，然后将它加载到 Web 浏览器控件中，但这太笨拙了。

有什么方法可以将包含 HTML 代码的字符串直接加载到 Web 浏览器中？

```
String = "<b>Hello</b> World" 
```

预期输出：**Hello** World

我正在使用 Visual Basic 9 (VS2008)。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-21T13:33:29.897

您可以通过将`WebBrowser`控件拖到应用程序上然后添加以下代码来执行此操作：

```
 webBrowser1.DocumentText = "<b>Hello</b> World"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T13:29:24.180

然后，您可以在 Web 浏览器控件中打开文档对象：-

```
document.write("<b>Hello</b> World"); 
```

# pdf - 粘合（拼版）PDF 文档

> ID：465271
> 
> 赞同：20
> 
> 时间：2009-01-21T13:26:40.037
> 
> 标签：pdf, automation, imposition

我有几个 A4 PDF 文档，我想（二合一）将它们“粘合”到 A3 格式的 PDF 文档中。所以我将从 2PDFs **A4**得到一个单面 PDF **A3**。我找到了出色的实用程序[PDFToolkit](http://www.pdfhacks.com/pdftk/)和其他一些实用程序，但它们都不能用于将两个文档并排“粘合”。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-07-23T21:26:30.927

我刚刚在 superuser.com 上发现了一个名为[PDFjam](http://www2.warwick.ac.uk/fac/sci/statistics/staff/academic/firth/software/pdfjam/)的好工具，它可以在一个命令中完成上述所有操作：

```
pdfjam --nup 2x1 file1.pdf file2.pdf --outfile DONESKI.pdf 
```

它具有其他标准功能，例如页面大小以及用于更复杂的页面排序的良好语法（真正的小册子样式页面拼版所必需的棘手的页面重新排序）。

它建立在 TeX 之上，不管它是什么。在 Ubuntu 上安装轻而易举：您只需`apt-get install pdfjam`. 在 Mac OS 上，我建议使用 BasicTeX（谷歌“mactex basictex”；所以认为我是垃圾邮件发送者，不会让我发布链接）。

这比同时安装 pdftk*和*Multivalent （在 Mac OS for dev*和*Ubuntu for deploy 上）要容易得多，也更容易维护，反正这对我来说并不顺利......！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-21T17:05:09.673

找到了[以下](http://multivalent.sourceforge.net/index.html)（免费和开源）工具来进行名为[Impose](http://multivalent.sourceforge.net/Tools/pdf/Impose.html)的拼版（感谢[danio](https://stackoverflow.com/users/12663/danio)的提示）。这完美地解决了我的问题。

编辑：这是如何完成的：

使用 PDF Toolkit 将两个 PDF 文件合二为一（两张 A4）

```
pdftk File1.pdf File2.pdf cat output OutputFile.pdf 
```

从此创建一个页面（一个 A3）：

```
java -cp Multivalent.jar tool.pdf.Impose -dim 2x1 -verbose -paper-size "42.2x29.9cm" -layout "1,2" OutputFile.pdf 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-03-13T18:15:25.633

我想宣传我的[pdftools](https://github.com/raffaem/pdftools)

它是用 Python 编写的，因此可以在任何平台上运行。它是 Latex 的包装器（pdfpages 包），但可以用一个命令行做很多事情：合并 pdf 文件，nup 它们（每个输出页面有多个输入页面）并为输出文件的页面编号（您指定位置和数字的格式）它仍然需要一些工作，但我认为现在可以使用它非常稳定:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-02-04T00:57:58.837

这会将两个横向字母页面放在单个纵向字母表上，沿顶部“装订”（即折叠）。

```
pdftops $1 - | 
psbook | 
pstops -w11in -h8.5in '4:1@.65(.5in,0in)+0@.65(.5in,5.5in),2U@.65(8in,5.5in)+3@.65U(8in,11in)' | 
ps2pdf - $(basename $1 .pdf).psbook.pdf 
```

顺便说一句，我经常这样做，所以我可能会为这个问题提交更多“答案”，只是为了跟踪成功的 pstops 页面规范。让我知道这是否是对 SO 的不当使用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-06-13T18:18:17.120

PoDoFo 包中包含一个不错的、强大的开源拼版工具：http://podofo.sourceforge.net/ [它](http://podofo.sourceforge.net/) 适用于我。可以在以下位置找到一些拼版计划： [http](http://www.av8n.com/computer/prepress/) ://www.av8n.com/computer/prepress/ PoDoFo 可以做很多其他的事情，而不仅仅是拼版。

另一个有用的拼版工具是 Bookbinder（在quantumelephant 网站上）。它有一个吸引非专家的 GUI。它不像 PoDoFo 那样灵活或强大，但它可以进行拼版。

pdftk 或多或少是必不可少的，但它*不会* 强制执行。

pdfjam 对我来说毫无用处，因为它无法处理大量有效的 pdf 文件。

我也从来没有能够多价工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-21T14:57:45.373

你想做的是[强加](http://en.wikipedia.org/wiki/Imposition)。有一些商业工具可以拼版 PDF，例如[ARTS crackerjack](http://www.artspdf.com/arts_pdf_crackerjack.asp)和[Quite](http://www.quite.com/imposing/) imposing，但它们非常昂贵（500 美元），需要 acrobat 专业人士的副本，并且对于将 2 A4 页面拼版到 A3 纸上来说太过分了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-21T13:47:40.413

在 Postscript 方面，一个名为*pstops*的工具能够以您可以想象的任何方式重新排列 Postscript 文件的页面。我还没有听说过这样的 PDF 工具。但是存在*pdf2ps*和*ps2pdf*。所以一个不太理想的解决方案可能是*pdf2ps*、*pstops*和*ps2pdf*的组合。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-21T13:57:10.520

我会使用[pdftk](http://www.pdfhacks.com/pdftk/)将两个 A4 页面合并为一个 2 页 PDF 。然后使用[PrimoPDF](http://www.primopdf.com/)之类的打印到 PDF ，并告诉它打印为 A3 格式，每面两页。

我刚刚测试了从 PowerPoint 打印一些幻灯片。效果很好。我在 PowerPoint 中选择 A3 作为纸张尺寸，然后选择每面打印 2 页。打印到 Primo 和瞧，我每个 A3 有两张 A4 幻灯片。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-03-18T11:56:44.447

[您可以使用BookletImposer](http://kjo.herbesfolles.org/bookletimposer/)将多个输入页面放在一个输出页面上。

[您可以使用PDF Mod](https://wiki.gnome.org/Attic/PdfMod)更改页面顺序并合并多个 pdf 文件。

使用这两个工具，您几乎可以对 pdf 文件做任何您想做的事情（除了编辑它们的内容）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-04T15:43:19.480

我有一个类似的问题。我试过强加，但它给了我一个

```
Exception in thread "main" java.lang.NoClassDefFoundError: tool/pdf/Impose
Caused by: java.lang.ClassNotFoundException: tool.pdf.Impose
(...)
Could not find the main class: tool.pdf.Impose.  Program will exit. 
```

然后我尝试了[PDF Snake](http://www.pdfsnake.com/)，它不是免费或开源的，但有一个完全不受限制的 30 天试用版。在调整参数以达到我想要的效果后，它工作得很好。这是一个很棒的工具。如果不是那么贵，我肯定会买的！无论如何，我想我会留下我的 2 美分，以防有人遇到与 Impose 相同的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-12-30T14:38:54.393

看这个

[http://sourceforge.net/projects/proposition/](http://sourceforge.net/projects/proposition/)

它需要 laTex 才能运行，但是当它运行时，效果非常好

问候

# php - php调用bash问题

> ID：465272
> 
> 赞同：0
> 
> 时间：2009-01-21T13:27:48.287
> 
> 标签：php, bash, cgi

我有这个简单的 php 脚本

```
<?php
echo '<pre>';

// Outputs all the result of shellcommand "ls", and returns
// the last output line into $last_line. Stores the return value
// of the shell command in $retval.
$last_line = $output = system ("~/public_html/cgi-bin/srch.sh &> ~/public_html/errors.txt",$retval);

// Printing additional info
echo '
</pre>
<hr />Last line of the output: ' . $last_line . '
<hr />Return value: ' . $retval;
?> 
```

依赖于 srch.sh：

```
#!/bin/bash

for i in ~/mail/home/user/mail/domain.com/josh/cur/*
do
grep -i Value $i . &> ~/public_html/yesno.txt;
done 
```

但是，在 b 行器中显示的只是 Retval 1，并且没有错误记录到任何一个文本文件中。我是否错误地混合了标准错误和标准输出，或者错过了其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T13:49:12.143

> `$last_line = $output = system ("~/public_html/cgi-bin/srch.sh &> ~/public_html/errors.txt",$retval);`

上面的行运行 srch.sh 并将它产生的***所有*****输出****重定向***到 errors.txt。因此，没有输出可以分配给 $output（和 $last_line）。您将在errors.txt 中找到您的最后一行（连同其余的输出）。*

 *如果没有，请尝试直接运行 shell 脚本，看看它是否会产生任何输出。

# java - 公共 IP 地址更改时是否会影响 localhost 套接字

> ID：465284
> 
> 赞同：1
> 
> 时间：2009-01-21T13:30:35.690
> 
> 标签：java, sockets

我已经使用在 127.0.0.1 上打开的套接字实现了一些远程方法调用。在程序运行过程中，电脑的公网IP地址会发生变化，因为我的程序时不时通过GPRS调制解调器上网。你能告诉我这对我打开的套接字有什么影响吗？Java版本是1.3，windows平台。有几个网络接口，它们的 IP 地址会随着时间而变化（+VPN 连接已建立）。但是客户端和服务器在同一台机器上，并使用 127.0.0.1 通过套接字建立连接。通过这些网络接口更改此地址是否会影响 127.0.0.1 通信。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T13:33:26.730

除了为什么在上帝的绿色地球上使用 Java 1.3（不再支持 Java 1.4）这个显而易见的问题之外，localhost 就是 localhost。它不受调制解调器（GPRS 或其他）分配给您的任何 IP 地址的影响。没关系。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T17:36:16.397

你确定绑定到服务器上的本地主机地址吗？

ServerSocket(int port, int backlog, InetAddress bindAddr)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T21:45:21.043

即使您拔出网络连接并禁用或删除所有网络适配器，localhost 也可以工作。

# vb.net - 解析 Microsoft Office 和 PDF 文档的最佳方法是什么？

> ID：465302
> 
> 赞同：7
> 
> 时间：2009-01-21T13:33:14.250
> 
> 标签：vb.net, pdf, ms-office, parsing, lucene.net

我正在使用 VB9 (VS2008) 和 Lucene.NET 开发桌面搜索引擎。Lucene.NET 中的索引器仅接受原始文本数据，无法直接从 Microsoft Office（DOC、DOCX、PPT、PPTX）和 PDF 文档中提取原始文本。从此类文件中提取原始文本数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T13:47:34.317

您可以像 Windows 桌面搜索一样使用实现 IFilter 接口的组件。

*   [.NET 中的使用示例](http://www.codeproject.com/KB/cs/IFilter.aspx)
*   [IFilter 实现的链接](http://ifilter.org)
*   [IFilter 接口说明](http://msdn.microsoft.com/en-us/library/ms691105(VS.85).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T13:53:39.903

我这里只能谈 MS Office 文档。做这件事有很多种方法：

*   使用 COM 自动化
*   使用以更易于访问的格式输出文档的转换器
*   使用第三方库
*   使用微软的 OpenXML SDK

COM 自动化具有并不总是可靠的缺点，主要是因为应用程序往往会由于模式弹出对话框而挂起。

转换器可用于 Word。您可以查看 Microsoft 提供的 Text Converter SDK，它允许您在独立应用程序中使用 Word 附带的文档转换器。需要一些 C 编码，但由于您使用与 Office 相同的转换引擎，您将获得高保真结果。SDK 可以从[http://support.microsoft.com/kb/111716](http://support.microsoft.com/kb/111716)获得。

对于使用第三方库的第三个选项，您可能需要查看 Apache POI 或 SourceForge 上的[b2xtranslator 项目](http://b2xtranslator.sourceforge.net/)。后者提供了一个 C# 库，允许您从二进制 Word 文档中提取文本。PowerPoint 开发仍处于早期阶段，但文本提取应该已经开始工作。

最后一个选项是使用 Microsoft 的 OpenXML SDK。这可能是首选/最简单的方式。在 Google 上搜索示例。您还可以通过首先使用 Office 兼容包（从 Microsoft 下载和安装）转换二进制文档来处理二进制文档：

单词：

```
"C:\Program Files\Microsoft Office\Office12\wordconv.exe" -oice -nme <input file> <output file> 
```

电子表格：

```
"C:\Program Files\Microsoft Office\Office12\excelcnv.exe" -oice <input file> <output file> 
```

微软幻灯片软件：

```
"C:\Program Files\Microsoft Office\Office12\ppcnvcom.exe" -oice <input file> <output file> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T13:55:46.983

对于 PDF，您可以使用我公司的具有文本提取功能的[.NET PDF 阅读器](http://www.atalasoft.com/products/dotimage/pdfrasterizer/default.aspx)组件。

这正是您为从 PDF 中提取文本而编写的代码：

```
public String ReadTextFromPages(Stream s)
{
    using (PdfTextDocument doc = new PdfTextDocument(s))
    {
        PdfTextReader rdr = doc.GetPdfTextReader();
        return rdr.ReadToEnd();
     }
} 
```

# c# - C# windows 应用程序没有关闭

> ID：465306
> 
> 赞同：0
> 
> 时间：2009-01-21T13:33:33.110
> 
> 标签：c#

我有一个 C# windows 应用程序。我把它放在一个测试服务器上，它的设置不受我公司的控制，安全上下文也不受控制。我双击exe。应用程序运行，我看到了我的表格。我关闭应用程序，我打开任务管理器，我仍然看到应用程序的足迹。

taskkill 似乎没有删除它，它仍在任务管理器中运行。

我如何检查是否仍有资源被占用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T13:37:22.433

可能的原因是您的应用程序关闭后后台线程仍在运行。根据您的框架和应用程序配置，即使在主窗口关闭后，后台线程也可能导致进程继续运行。

你的进程中有线程吗？如果是这样，请确保在主应用程序窗口关闭时将它们关闭。这样做的好地方是在 Windows 窗体的 OnClosing 方法中

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T14:02:22.617

滥用 Application.DoEvents() 是陷入这种麻烦的另一种方式。如果您无法从 TaskMgr 中终止 .exe，则您的应用程序将等待驱动程序完成 I/O 请求。

# sql-server - SQL Server 复制连接错误

> ID：465312
> 
> 赞同：4
> 
> 时间：2009-01-21T13:35:24.840
> 
> 标签：sql-server, sql-server-2005, replication

重命名我的 PC 后，我无法为 SQL Server 2005 中的数据库复制创建新的 paublications。我收到错误消息“SQL Server 复制需要实际的服务器名称才能连接到服务器。” 当我返回我的旧 PC 名称时，问题就解决了。重命名PC后如何使用复制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T15:56:58.593

SQL 服务本身仍然认为它有旧的服务器名称，并且由于它有以第三人称引用自己的习惯，所以当底层服务器名称发生变化时，这会导致问题。您需要采取以下步骤来纠正它：

1.  运行“选择@@ServerName”以验证服务器名称 - 它应该是旧名称。
2.  sp_dropserver 'OLDSERVERNAME'</li>
3.  sp_addserver 'NEWSERVERNAME'，本地
4.  重新启动 SQL 服务和代理服务
5.  再次运行步骤 1 以确认服务器名称现在正确

# c# - 是否可以将委托实例转换为 Lambda 表达式？

> ID：465313
> 
> 赞同：0
> 
> 时间：2009-01-21T13:35:43.420
> 
> 标签：c#, lambda, resharper, expression-trees

这是我的问题的上下文：

一种常见的技术是将方法的参数声明为 Lambda 表达式而不是委托。这样该方法就可以检查表达式来做一些有趣的事情，比如找出委托实例主体中方法调用的名称。

问题是您失去了 Resharper 的一些智能感知功能。如果方法的参数被声明为委托，Resharper 会在编写对该方法的调用时提供帮助，提示您使用 x => x 语法作为参数值提供给该方法。

所以......回到我的问题，我想做以下事情：

```
 MethodThatTakesDelegate(s => s.Length);
}

private void MethodThatTakesDelegate(Func<string, object> func)
{
    //convert func into expression
    //Expression<Func<string, object>> expr = "code I need to write"

    MethodThatTakesExpression(expr);
}

private void MethodThatTakesExpression(Expression<Func<string, object>> expr)
{
    //code here to determine the name of the property called against string (ie the Length)
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T15:01:50.140

在您使用术语“lambda 表达式”的任何地方，您实际上的意思是“表达式树”。

lambda 表达式是源代码中的位，它是

```
parameters => code 
```

例如

```
x => x * 2 
```

表达式树是[System.Linq.Expressions.Expression](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expression.aspx)类（或者更确切地说，是派生类之一）的实例，它们将代码表示为数据。

编译器将 Lambda 表达式转换为*表达式*树（或者更确切地说，在执行时生成表达式树的代码）*或*委托实例。

您可以将[LambdaExpression](http://msdn.microsoft.com/en-us/library/system.linq.expressions.lambdaexpression.aspx)（它是 Expression 的子类之一）的实例编译为委托，但不能反过来。

理论上，在*某些情况下**可能*可以根据[MethodBase.GetMethodBody](http://msdn.microsoft.com/en-us/library/system.reflection.methodbase.getmethodbody.aspx)返回的 IL 编写这样的“反编译器” ，但目前存在各种无法用表达式树表示的委托。表达式树表示*表达式*而不是*语句*或语句块 - 因此没有循环、分支（条件除外）、赋值等。我相信这可能会在 .NET 4.0 中发生变化，但我不希望微软提供反编译步骤，除非有一个很好的理由。

 **** * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T14:12:35.967

我不相信有可能在这里实现你想要的。从代码中的注释看来，您正试图捕获在 MethodThatTakesExpression 中进行分配的属性的名称。这需要一个表达式树 lambda 表达式来捕获属性访问的上下文。

在您将委托传递给 MethodThatTakesDelegate 时，此上下文将丢失。委托仅存储方法地址，而不存储有关方法信息的任何上下文。一旦进行了这种转换，就不可能将其取回。

为什么这不可能的一个例子是，甚至可能没有命名方法支持委托。可以使用 ReflectionEmit 生成一个没有任何名称且仅存在于内存中的方法。不过可以将其分配给 Func 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T14:15:56.880

不，这是不可能的。

# performance - 简单的带宽/延迟测试来估计用户体验

> ID：465314
> 
> 赞同：5
> 
> 时间：2009-01-21T13:35:44.790
> 
> 标签：performance, web-applications, bandwidth, latency

我编写基于 Web 的应用程序。性能显然是一个关键因素。虽然数据库加载和页面呈现时间是我可以控制的，但用户的互联网连接却不是。

我正在寻找的是一种指示用户拥有何种连接的方法。类似于网站角落的交通信号灯的东西，向用户显示他们与网站的连接类型，从而表明他们应该期望什么样的感知性能。例如，也许该应用程序看起来很慢，因为您公司中的其他人都在午餐时间浏览 Facebook。

我最初的想法是，这可以通过在每个页面加载时运行的一些 javascript 来实现。

理想情况下，代码是非常“可删除”的，不需要重大代码或基础架构更改即可实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T13:59:27.957

[这](http://crynobone.com/ci/index.php/archive/view/852)似乎是您可以使用的东西。您还可以为 AJAX 请求计时；往返多长时间？您可能必须自己建立一些基准。

# c# - C#中如何通过接口实现事件？

> ID：465318
> 
> 赞同：13
> 
> 时间：2009-01-21T13:36:19.500
> 
> 标签：c#, interface

我有一个问题：想象一下我有一个基于插件的系统。

我需要某种接口，通过它我可以从每个插件中捕获事件，例如实现`IReporting`接口。

```
(IReporting) object.OnSomeEvent += <.....> 
```

但我找不到办法做到这一点。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-21T13:44:11.077

你应该写 ((IReporting)obj).XXX 而不是 (IReporting)obj.XXX

```
public interface IFoo
{
    event EventHandler Boo;
}

class Foo : IFoo
{
    public event EventHandler Boo;
    public void RaiseBoo()
    {
        if (Boo != null)
            Boo(this, EventArgs.Empty);
    }
}

...

private void TestClass_Boo(object sender, EventArgs e)
{
    throw new NotImplementedException();
}

    ...

   object o = new Foo();
   ((IFoo)o).Boo += TestClass_Boo;
   ((Foo)o).RaiseBoo(); 
```

关于插件框架，请查看具有良好架构的现有解决方案，例如[MEF](http://www.codeplex.com/MEF)

# javascript - 在 JavaScript 中查找元素所属的 FORM

> ID：465325
> 
> 赞同：13
> 
> 时间：2009-01-21T13:37:59.687
> 
> 标签：javascript, html, webforms

如何使用简单/少量的 JavaScript 找出 HTML 元素包含在哪个 FORM 中？在下面的示例中，如果我已经掌握了名为“message”的 SPAN，我怎样才能轻松获得 FORM 元素？

```
<form name="whatever">
    <div>
        <span id="message"></span>
    </div>
</form> 
```

SPAN 可能嵌套在其他表或 DIV 中，但似乎太冗长而无法围绕 .parentElement 进行迭代并沿着树向上工作。有没有更简单更短的方法？

如果它不是 SPAN，而是 INPUT 元素，那会更容易吗？他们是否有一个指向包含 FORM 的属性？谷歌说不...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-21T13:41:43.670

**可以通过 访问表单元素所属的表单`element.form`。**

当您用作参考的元素不是表单元素时，您仍然必须遍历`parentElement`或使用其他类型的选择器。

使用原型，您可以使用[Element.up()](http://www.prototypejs.org/api/element/up)来简化它：

```
$(element).up('form'); 
```

[这个问题的其他](https://stackoverflow.com/questions/465325/finding-the-form-that-an-element-belongs-to-in-javascript#465344) [答案](https://stackoverflow.com/questions/465325/finding-the-form-that-an-element-belongs-to-in-javascript#465346)指出了如何在 jQuery 中做同样的事情。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-04-11T13:34:14.717

为什么不直接使用：

```
var nodesForm = node.form; 
```

? 它适用于 FF3、FF4、google chrome、Opera、IE9（我自己测试过）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-21T13:42:52.203

猜猜你必须遍历所有元素。您可以尝试使用 jQuery：

```
$("input").parent("form") 
```

[http://docs.jquery.com/Traversing/parent#expr](http://docs.jquery.com/Traversing/parent#expr)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-04-01T16:19:29.990

**关于 Gumbo 的帖子：** 尽管原型和 jQuery 很有用，但有些人并没有将它们实现到他们的项目中。

有人可以解释为什么 Gumbo 的解决方案被降级，除了他重复了 OP 最初试图避免的事情吗？

```
node = document.getElementById(this.id);
while (node.nodeName != "FORM" && node.parentNode) {
    node = node.parentNode;
} 
```

**回答 OP 的问题：** 遍历 DOM 是实现此效果的最快方法 - 感知速度是通过 1）更好地编写 JS 代码或 2）执行时间（如果您将表单存储在该元素的页面加载中，您仍然会遍历，但是当您需要检索该信息时，您可以更快地调用存储的变量）。

没有嵌套在非表单元素中的属性可以将其与表单相关联（span.form 不存在）。

如果您使用脚本 (php/perl) 来生成您的页面，并且您将对表单进行大量调用，您可以在该元素的 HTML 中嵌入表单 ID。尽管如此，仍需要进行查找。

我希望这有帮助，

vol7ron

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-21T13:42:13.920

您可以在 DOM 树中回溯，直到找到正确的节点：

```
node = document.getElementById("message");
while (node.nodeName != "FORM" && node.parentNode) {
    node = node.parentNode;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-21T13:43:08.893

或者一个小的 jQuery（忽略 jQuery 本身）：

```
$("#message").parents("form:first") 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T13:45:29.390

除了 node.parentNode，我不相信有办法找到给定节点的特定祖先。大多数库通常会按照您的描述进行操作，并通过 parentNode 进行迭代。

如果您不使用原型、jquery 或 Ext 之类的库，那可能是个好主意。到目前为止，他们已经解决了 DOM 中的所有不兼容和怪癖，从而使大多数这样的操作变得轻而易举。

# java - 就数据挖掘和可视化的工具支持而言，日志事件的最佳 XML 格式是什么？

> ID：465329
> 
> 赞同：2
> 
> 时间：2009-01-21T13:39:14.317
> 
> 标签：java, logging, visualization, data-mining, error-logging

我们希望能够从我们的 Java 应用程序创建日志文件，这些文件适合以后由工具处理，以帮助调查错误和收集性能统计信息。

目前我们使用传统的“可能会或可能不会被展平为文本形式并附加到日志文件的日志内容”，但这最适用于人类读取的少量信息。

经过仔细考虑，最好的办法是将日志事件作为 XML 片段存储在文本文件中（然后像任何其他日志文件一样处理），然后使用适当的工具将它们下载到机器上进行后期处理。

我想使用尽可能广泛支持的 XML 格式，现在我正处于“研究-然后-制定-决策”阶段。我很感激在 XML 格式和工具方面的任何帮助，我很乐意编写胶水代码来获得我需要的东西。

到目前为止我发现了什么：

log4j XML 格式：由链锯和 Vigilog 支持。莉莉丝 XML 格式：莉莉丝支持

未经调查的工具：

Microsoft Log Parser：显然支持 XML。OS X 日志查看器：

[加上http://www.loganalysis.org/sections/parsing/generic-log-parsers/](http://www.loganalysis.org/sections/parsing/generic-log-parsers/)上有很多工具

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T03:36:12.207

不幸的是，我无法为您提供您正在寻找的答案，但我想提醒您在记录到 XML 时需要考虑的一些事项。例如：

```
<log>
 <msg level="info">I'm a log message</msg>
 <msg level="info">I'm another message</msg>
 <!-- maybe you won't even get here -->
 <msg level="fatal">My server just ate a flaming death 
```

在上面的潜在 XML 日志片段中，您可以看到记录到 XML 的最大缺点。当发生灾难性故障时，您的日志格式会损坏，因为它需要结束标记。但是，如果您使用的是解析主日志输出的程序，这应该不是什么大问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-23T08:23:10.043

如果您正在定义自己的 XML 日志文件编写方式，则无需担心有结束和开始标记即可生成有效的 XML。Elijah 的回答是正确的，因为如果您想创建 XML*文档*，您确实会遇到问题，但这并不是必须的。W3 标准还定义了 XML*实体*（参见 W3 的 XML 1.0 规范的第 4.3 节，第二版，遗憾的是我无法为您提供链接，因为我没有足够的点数），这将更适合日志样式的连续附加到一个文件而不重写它的一部分。然后，如果您需要使用实际的 XML 文档而不是 XML 实体，则可以创建引用 XML 包装器文档（有关示例，请参见[http://www.perlmonks.org/?node_id=217788#217797 ）](http://www.perlmonks.org/?node_id=217788#217797)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T16:12:38.957

log4j 的优点之一是它为自定义日志格式和写入位置提供了很好的可能性。

因此，我不会选择一些日志文件格式，而是选择一些允许更改格式并允许将日志直接获取到某个程序的日志库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T11:33:17.840

Lilith 日志查看器似乎包含一种 XML 格式，它非常适合处理 logback 中可用的额外工具，而不仅仅是 log4j 的东西。

它是 - 就目前而言 - 迄今为止最好的选择 :)

* * *

我将 log4j xmllayout 类改编为 logback，它适用于电锯。

* * *

由于我找不到合适的日志查看器来可视化事件信息（而不仅仅是在表格中显示所有事件），我现在决定创建一个非常简洁的 xml 布局，其中包含基于上述机器可解析信息的信息，它可以然后由 Microsoft LogParser 后处理为我需要的任何格式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T12:20:25.640

我建议您考虑对事件进行[logback-access](http://logback.qos.ch/access.html)。

除此之外，任何使用 JMX 的东西，因为它是为了匹配 SNMP 的功能集。

# iphone - 除了作为 iPhone 开发者的简单注册之外，iPhone 开发者计划还为我提供了什么？

> ID：465330
> 
> 赞同：11
> 
> 时间：2009-01-21T13:39:57.967
> 
> 标签：iphone, iphone-developer-program

简单的说; 我的 99 美元能给我带来什么，而我还不能免费获得？

好的，好的，听起来像一个愚蠢的问题，但苹果网站对我来说并不清楚。

我的预感是你可以为你的 99 提交应用程序到应用程序商店，但你可以免费获得其他所有东西，但我不清楚因此这个问题。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-21T14:02:14.643

支付 99 美元后，主要收益如下所示：

*   在您的设备上安装您开发的应用程序而无需越狱
*   向 Apple App Store 提交和分发付费和免费应用程序
*   访问优惠券代码以将您的付费应用分发给审阅者（简洁功能）
*   使用临时分发为多达 100 台设备分发内部应用程序
*   如果您的应用程序很受欢迎（通常并非所有人都可以使用），则可以免费进行额外的营销

这些是主要的好处，我认为我没有忘记任何主要的好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T13:55:30.367

如果不支付 99 美元，您实际上无法在任何 iPhone/iPod touch（包括您拥有的那个）上运行您的程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T13:52:24.243

只需 99 美元，您就可以在您的实际设备上运行您的应用程序，并且可以出售您的应用程序。

# cocoa-touch - 如何重置触摸队列？

> ID：465341
> 
> 赞同：0
> 
> 时间：2009-01-21T13:42:33.560
> 
> 标签：cocoa-touch

如何让 iPhone 忘记 UITouch 事件，或者模拟一个`touchesCancelled`事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-10-18T19:28:45.197

UIApplication 中有一个*未记录*的方法`-_cancelAllTouches`，它将取消所有活动的触摸。

```
[[UIApplication sharedApplication] _cancelAllTouches]; 
```

否则，我看不到可靠地获得所有活动触摸的记录方法。

# c++ - 如何在 Visual Studio 2008 中创建 COM DLL？

> ID：465345
> 
> 赞同：10
> 
> 时间：2009-01-21T13:43:03.340
> 
> 标签：c++, visual-studio-2008, com, dll, guid

自从我编写 COM dll 以来已经有好几年了。我现在已经创建了几个类，它们继承自一些 COM 接口，但我想测试一下。我知道我必须在某个地方放置一个 GUID，然后使用 regsvr32 注册它，但是涉及的步骤是什么？

编辑：对不起，忘了提到我正在使用 C++。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-21T20:37:45.080

要创建一个新的 ATL COM 项目，您可以执行以下操作：

1.  文件/新项目
2.  Visual C++/ATL/ATL 项目
3.  自定义它的设置，完成后按完成

您已经创建了一个新的 dll，但它是空的，要添加一个 COM 对象，您可以这样做：

1.  项目/添加类
2.  Visual C++/ATL/ATL 简单对象，按添加
3.  给你想要的名字（比如 MyObject），然后按完成添加它

如果你想让一个对象实现一个接口

1.  在类视图中选择对象类 (CMyObject)
2.  右键单击/添加/实现界面...
3.  您可以选择要实现的接口
    1.  来自项目文件中已有的 .idl 文件
    2.  来自嵌入了类型库的 .tlb/.dll/.exe
    3.  从已注册的对象
4.  完成后按完成

PS：在不同的文件夹中创建一个新的同名ATL项目，并添加您自定义的文件要容易得多。该向导执行多项任务并创建多个自定义文件。

对于难以逐个文件添加的大型项目，我会这样做，但我没有将文件添加到新项目中，而是开始将新项目中的设置复制到旧项目中，并添加向导创建的任何其他文件并修复 stdafx.h 之类的标头以合并新设置。

PPS：如果您希望您的 dll 支持 MFC，您必须选择 MFC/MFC Dll，而不是选择 ATL Project。当您添加 ATL 简单对象时，向导将要求将 ATL 支持添加到项目中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T21:54:34.907

您需要编写一个名为[DllGetClassObject](http://msdn.microsoft.com/en-us/library/ms680760(VS.85).aspx)的函数并将其导出。该函数负责分配一个“类工厂”，您还必须编写它，它又能够分配您的 COM 对象的实例。它必须实现[IClassFactory](http://msdn.microsoft.com/en-us/library/ms694364(VS.85).aspx)。

做起来并不难。另一种方法是使用 ATL（请参阅 xhantt 的回答），理论上它会为您做到这一点，但实际上它是一团糟。不知何故，它设法将 COM 的复杂性封装在一个更加复杂的抽象层中。祝你好运，例如在 DLL 之间移动对象。

但是您可以运行 ATL 向导来查看如何声明`DllGetClassObject`. 实现`IClassFactory`非常容易——只需一种方法来更新对象。

然后您需要注册您的 DLL - 即将密钥放入注册表。如果没有您的进一步帮助，该`regsvr32`工具无法做到这一点。您必须编写和导出另一个名为[DllRegisterServer](http://msdn.microsoft.com/en-us/library/ms682162(VS.85).aspx)的函数，该函数完成所有繁重的工作。所做`regsvr32`的只是加载 DLL，查找`DllRegisterServer`并调用它。

同样，ATL 有一种方法可以为您实现这一点，但它是通过读取一种充满注册表修改指令的脚本来实现的，该脚本存储在嵌入到您的 DLL 资源中的 .rgs 文件中。如果您不小心将任何类型的语法错误放入此文件，则注册会静默失败。

同样，您实际上可能会发现编写几行代码来自己调整注册表更简单。[以下是详细信息](http://msdn.microsoft.com/en-us/library/ms680055(VS.85).aspx)。

如果您改用 C#，则不会遇到任何这些问题。一切都封装得非常干净。作为开发 COM 对象的工具，它实际上比 C++ 好得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T15:46:27.727

构建解决方案时，它会自动注册 dll。它还创建了两个文件 _i.c 和 .h 文件。

**要测试 dll，请创建示例应用程序：**

1.  创建示例 Win32 应用程序。在具有main函数的win32应用程序的cpp文件中包含_i.c和.h

2.  调用 CoInitialize();

3.  声明一个接口指针 CComPtr pMyInterface = NULL; // IMyInterface 在 _i.c 中声明

4.  创建实例 pMyInterface.CoCreateInstance(CLSID_MyClass); // CLSID_MyClass 是代表 CoClass 的
    GUID

5.  调用接口中存在的 API

6.  调用 CoUnInitialize();

# python - 如何在 Windows 命令行中覆盖/打印当前行？

> ID：465348
> 
> 赞同：29
> 
> 时间：2009-01-21T13:43:17.600
> 
> 标签：python, windows, command-line, overwrite, carriage-return

在 Unix 上，我可以使用`\r`(carriage return) 或`\b`(backspace) 来覆盖 shell 中的当前行（打印已经可见的文本）。

我可以通过 Python 脚本在 Windows 命令行中实现相同的效果吗？

我尝试了 curses 模块，但它似乎在 Windows 上不可用。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-21T14:15:10.657

是的：

```
import sys
import time

def restart_line():
    sys.stdout.write('\r')
    sys.stdout.flush()

sys.stdout.write('some data')
sys.stdout.flush()
time.sleep(2) # wait 2 seconds...
restart_line()
sys.stdout.write('other different data')
sys.stdout.flush() 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-11-15T23:42:30.760

我知道这很旧，但我想告诉我的版本（它可以在我的电脑上的 cmd 中工作，但不能在空闲时）覆盖 Python 3 中的一行：

```
>>> from time import sleep
>>> for i in range(400):
>>>     print("\r" + str(i), end="")
>>>     sleep(0.5) 
```

**编辑：** 它适用于 Windows 和 Ubuntu

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-02-10T08:28:27.797

```
import sys 
import time

for i in range(10):
    print '\r',         # print is Ok, and comma is needed.
    time.sleep(0.3)
    print i,
    sys.stdout.flush()  # flush is needed. 
```

如果在 IPython-notebook 上，就像这样：

```
import time
from IPython.display import clear_output

for i in range(10):
    time.sleep(0.25)
    print(i)
    clear_output(wait=True) 
```

[http://nbviewer.ipython.org/github/ipython/ipython/blob/master/examples/notebooks/Animations%20Using%20clear_output.ipynb](http://nbviewer.ipython.org/github/ipython/ipython/blob/master/examples/notebooks/Animations%20Using%20clear_output.ipynb)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-11-27T16:25:56.227

我刚遇到这个问题。即使在 Windows 命令提示符中，您仍然可以使用`\r`，但是，它只会带您回到上一个换行符 ( `\n`)。

如果你做这样的事情：

```
cnt = 0
print str(cnt)
while True:
    cnt += 1
    print "\r" + str(cnt) 
```

你会得到：

```
0
1
2
3
4
5
... 
```

那是因为`\r`只回到最后一行。由于您已经使用最后一个打印语句编写了换行符，因此您的光标将从新空行的开头移动到同一新空行的开头。

为了说明，在您打印第一个 0 后，您的光标将位于此处：

```
0
| # <-- Cursor 
```

当 you 时`\r`，您会转到行首。但你已经在这条线的开始了。

解决方法是避免打印`\n`字符，因此您的光标位于同一行并`\r`正确覆盖文本。你可以用`print 'text',`. 逗号可防止打印换行符。

```
cnt = 0
print str(cnt),
while True:
    cnt += 1
    print "\r" + str(cnt), 
```

现在它将正确地重写行。

请注意，这是 Python 2.7，因此是`print`语句。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-08-01T20:27:20.497

简易方法：

```
import sys
from time import sleep
import os

#print("\033[y coordinate;[x coordinateH Hello")
os.system('cls')
sleep(0.2)
print("\033[1;1H[]")
sleep(0.2)
print("\033[1;1H  []")
sleep(0.2)
print("\033[1;1H    []")
sleep(0.2)
print("\033[1;1H      []")
sleep(0.2)
print("\033[1;1H        []")
sleep(0.2)
print("\033[1;1H      []")
sleep(0.2)
print("\033[1;1H    []")
sleep(0.2)
print("\033[1;1H  []")
sleep(0.2)
print("\033[1;1H[]")
sleep(0.2) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-22T00:37:07.717

如果您只想更新上一​​行，简单的方法：

```
import time
for i in range(20):
    print str(i) + '\r',
    time.sleep(1) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-05T13:58:10.403

最简单的方法是使用两个 \r - 一个在开头，一个在结尾

```
for i in range(10000):
    print('\r'+str(round(i*100/10000))+'%  Complete\r'), 
```

它会很快

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-03-03T05:13:01.137

在 Windows（python 3）上，它似乎可以工作（不直接使用 stdout）：

```
import sys

for i in reversed(range(0,20)):
  time.sleep(0.1)
  if(i == 19):
    print(str(i), end='', file=sys.stdout)
  else:
    print("\r{0:{width}".format(str(i), width = w, fill = ' ', align = 'right'), end='', file=sys.stdout)
  sys.stdout.flush()
  w = len(str(i)) 
```

每次调用 print 函数时都会更新同一行。

此算法可以改进，但发布它是为了展示您可以做什么。您可以根据需要修改方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-08-29T11:44:20.120

在 PyCharm 2020.3 和 Python 3.9 版上测试，为了覆盖书面打印输出，我使用以下内容：

```
from time import sleep

for x in range(10):
    print(f'\r {x}', end='')
    sleep(0.6) 
```

这是我主要用于我的程序的代码。使用`end='\r'`将为我覆盖整个文本，忽略睡眠。

在实际场景中，我设置如下：

```
 def progress_callback(progress):
        print(f'\rDownloading File: {progress.dlable.file_name}  Progress: ' + '{0:.2f}%'.format(progress.percent), end='')
        # `return True` if the download should be canceled
        return False

    print('\nDownload complete!) 
```

覆盖功能后的打印必须换行，否则之前的同一行将被覆盖。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-01-19T22:14:49.987

感谢这里所有有用的答案。我需要这个:)

我发现 nosklo 的答案特别有用，但我希望通过将所需的输出作为参数传递来完全包含在函数中。另外，我真的不需要计时器，因为我希望在特定事件之后进行打印）。

这就是我的诀窍，我希望其他人觉得它有用：

```
import sys

def replace_cmd_line(output):
    """Replace the last command line output with the given output."""
    sys.stdout.write(output)
    sys.stdout.flush()
    sys.stdout.write('\r')
    sys.stdout.flush() 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-04-09T05:35:54.823

是的，这个问题是 11 年前提出的，但很酷。我喜欢即兴创作。附加到 nosklo 的答案：

```
import sys
import time

def restart_line():
    sys.stdout.write("\r")
    sys.stdout.flush()

string_one = "some data that is very long..."
sys.stdout.write(string_one)
sys.stdout.flush()

time.sleep(2)
restart_line()

string_two = "shorter data"
if len(string_two) < len(string_one):
    string_two = string_two+(" "*int((len(string_one)-len(string_two))))
    # This will overwrite the characters that would be left on the console

sys.stdout.write(string_two)
sys.stdout.flush() 
```

# javascript - JavaScript 是什么“类型”的语言？

> ID：465355
> 
> 赞同：22
> 
> 时间：2009-01-21T13:45:04.523
> 
> 标签：javascript

编程语言通常按其结构分类。迄今为止，有许多类型，包括（*但不限于！*）：**Procedural**、**Structured**、**Object-Oriented**、**Concurrent**、**Functional**、**Event-Driven**、**Compiled**和**Interpreted** ( *[Source](http://www.giac.org/resources/whitepaper/architecture/97.php)* )。一些编程语言是这些结构的混合体，而其他编程语言可能只属于上面列出的标题之一。

我的问题是：

**JavaScript 可以归为哪一类语言？**

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-21T13:48:32.800

[Javascript Wikipedia 条目](http://en.wikipedia.org/wiki/JavaScript)告诉您。

> JavaScript (/ˈdʒɑːvəˌskrɪpt/)，通常缩写为 JS，是一种符合 ECMAScript 规范的编程语言。JavaScript 是高级的，通常是即时编译的，并且是多范式的。它具有大括号语法、动态类型、基于原型的面向对象和一流的功能。

第三段接着说：

> 作为一种多范式语言，JavaScript 支持**事件驱动**、**函数**式和**命令式**编程风格（强调）。它具有用于处理文本、日期、正则表达式、标准数据结构和文档对象模型 (DOM) 的应用程序编程接口 (API)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-21T14:46:13.667

关于您选择**Procedural**、**Structured**、**Object-Oriented**、**Concurrent**、**Functional**、**Event-Driven**、**Compiled**和**Interpreted**作为计算机语言的“类型”，Javascript 非常强大；它至少（或可以）是**Procedural**、**Structured**、**Object-Oriented**、**Functional**、**Event-Driven**和**Interpreted**。

但是，正如您的消息来源所说，许多语言不仅属于一类，而且可以以不同的方式使用。例如，Java 可以以相当严格的程序方式使用。

尽管 Javascript 支持函数式编程，但它不是函数式程序员的*通用语言*——但如果他们愿意，他们可以使用它。

Javascript 是如此多才多艺，因为它是基于原型的，并且因为您可以将函数作为参数传递给其他函数，这确实允许一些疯狂的编程技术（阅读：HACKS）与 Javascript 的动态创建相结合，它可以非常强大且令人困惑，因为出色地 ：）

您可能想查找[http://en.wikipedia.org/wiki/Prototype-based_programming](http://en.wikipedia.org/wiki/Prototype-based_programming)以获得更多解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-02T17:31:13.780

[Mozilla 开发者网络](https://developer.mozilla.org/en-US/docs/Web/JavaScript/A_re-introduction_to_JavaScript)

...

JavaScript 是一种具有类型和运算符、标准内置对象和方法的多范式动态语言。它的语法基于 Java 和 C 语言——这些语言的许多结构也适用于 JavaScript。JavaScript 支持使用对象原型而不是类的面向对象编程（请参阅有关原型继承和 ES2015 类的更多信息）。JavaScript 还支持函数式编程——函数是对象，使函数能够保存可执行代码并像任何其他对象一样被传递。

...

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2011-04-21T21:21:09.083

JavaScript 是 ECMAScript 语言标准的实现，主要以客户端 JavaScript 的形式使用，作为 Web 浏览器的一部分实现，以提供增强的用户界面和动态网站。这允许对主机环境中的计算对象进行编程访问。

# vmware - VMWare 镜像修改

> ID：465364
> 
> 赞同：3
> 
> 时间：2009-01-21T13:46:21.773
> 
> 标签：vmware, virtualization

如果我已经有一个存在的图像，我可以根据现有的图像创建一个图像，除非我想对现有的图像进行更改（主要是配置）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T13:53:49.683

我一直这样做。实际上，我将每个 VM 保存在一个单独的目录中，并复制整个目录以进行复制。VMX 文件（配置）中的所有引用都相对于当前目录。

你需要注意的一件事。VMX文件有一行是虚拟网卡的MAC地址：

```
ethernet0.generatedAddress = "00:0c:29:ff:1f:c7" 
```

如果你想同时运行两个虚拟机，你需要改变它——我通常只是将最后一个数字提高 1（到 c8）。

我还更改了该文件中的 displayName，以便在它们运行时可以区分它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T22:25:05.237

我所做的是创建一个基本的“干净”虚拟机，然后在克隆之前运行[Sysprep](http://en.wikipedia.org/wiki/Sysprep)。当您不重置 Windows 安装的“独特”元素并且尝试同时运行它们时，您可能会遇到一些问题。

我目前正在运行大约 20 台虚拟机，如果有任何一台出现严重问题（它们用于测试），我已经准备好 Windows 2000、Windows XP、Vista 和 Server 2003 的干净基础映像，所以我可以在 20 分钟或更短的时间内恢复并运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T13:48:46.200

是的，您可以将图像复制到外部存储。只需在驱动器上找到图像文件并在图像*未*运行时进行复制。然后，您可以随心所欲地更改原始文件。这就是你所追求的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T17:31:40.557

根据您的需求，您可以尝试（免费）[VMWare Converter](http://www.vmware.com/download/converter/)。它允许您更改驱动器大小和其他图像参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T18:29:06.803

正如其他人所说，这正是您为 VM 实施完整备份的方式。

当 VM 未运行时，只需将虚拟磁盘复制到其他位置，然后重新启动 VM。

# windows - 在 Windows 中查看共享内存的程序？

> ID：465378
> 
> 赞同：9
> 
> 时间：2009-01-21T13:50:34.043
> 
> 标签：windows, shared, shared-memory

我正在寻找一个程序来查看和浏览 Windows x32/x64 中的（本地）共享内存。

我知道这是存在的，因为我之前已经在行动中看到过它。出于某种原因，谷歌和 MSDN 在这方面让我失望了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-21T19:01:22.480

我认为[Accesschk](http://technet.microsoft.com/en-us/sysinternals/bb664922.aspx)可以做到这一点。

从命令行：`accesschk.exe -osv > objects.txt`

搜索：“类型：部分”

# c++ - C++。RNG 是否有可能在使用相同种子的两台不同机器中给出不同的随机变量？

> ID：465388
> 
> 赞同：5
> 
> 时间：2009-01-21T13:53:08.843
> 
> 标签：c++, gcc, random

我有这个长而复杂的源代码，它使用带有**修复**种子的 RNG。

这段代码是一个模拟器，这个模拟器的参数是这个RNG给出的随机值。当我在同一台机器上执行代码时，无论我尝试多少次，输出都是一样的。但是当我在两台不同的机器上执行这段代码并比较两台机器的输出时，它们是不同的。

是否有可能两台不同的机器使用相同的随机数生成器和相同的种子给出不同的输出？

编译器版本、库和操作系统是相同的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T13:56:04.313

这当然是可能的，因为 RNG 可能会将机器特定的数据与种子（例如网卡地址）结合起来以生成随机数。它基本上是特定于实现的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-21T13:57:26.323

由于它们确实给出了不同的结果，因此很明显它们可能给出不同的结果。容易回答的问题，下一个！

说真的：如果不知道 RNG 的源代码，很难知道您是在观察错误还是功能。但听起来有问题的RNG正在使用来自其他地方的第二个种子，例如当前时间，或者一些硬件相关的值，如网卡的MAC地址。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-22T14:15:20.373

如果您需要可以在机器之间重复的东西，请尝试[Boost Random Number Library](http://www.boost.org/doc/libs/1_37_0/libs/random/index.html)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-21T13:56:47.807

如果它是一个伪随机生成器，只使用种子来产生一个数字序列，那么根据定义，它们不可能不同。但是，如果您使用的那些使用依赖于机器的东西来扰乱种子，或者很简单，使用不同的算法，那当然是很有可能的。您使用的是哪个实现，如果它是标准库实现，它们是相同的版本吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T13:49:10.067

是的。例如，有浮点 RNG，其结果可能取决于您的 CPU 是否正确实现了 IEEE 浮点数（在 ISO C++ 中不保证）。此外，诸如将 80 位双倍溢出到内存等效果也会影响结果。

关于“种子”的概念也存在一些可能的混淆。有些人将种子定义为设置 RNG 初始状态的所有输入。其他人将其限制为仅代码中的显式输入，并排除来自例如硬件源或 /dev/random 的隐式输入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T13:57:09.973

也许这是一个小/大端问题，或者代码以某种方式检测到处理器。最简单的方法是使用断点或类似的调试例程来观察播种例程和 RNG 本身的工作情况。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-21T14:03:29.493

这很大程度上取决于您使用的是哪个 RNG。诸如`random(3)`or 之`rand48(3)`类的东西被设计为在使用相同的种子运行时返回相同的序列。现在，如果您使用的 RNG 获得`/dev/random`输出，则所有赌注都已关闭，结果将有所不同。

# html - 我可以强制 HTML 文档为一页吗？

> ID：465398
> 
> 赞同：7
> 
> 时间：2009-01-21T13:55:28.760
> 
> 标签：html, printing, document

我正在从 HTML 生成一个文档。有什么方法可以强制将 HTML 页面呈现为一个打印页面吗？

`<table>`我已经用和`<div>`标签完成了大部分页面。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T14:11:21.990

不完全是，但您可以使用打印样式表：

```
<link rel="stylesheet" type="text/css" media="print" href="print.css" /> 
```

将字体大小、填充等设置为诸如“pt”之类的物理单位（绝不应该在屏幕样式表中使用！），以便在典型浏览器中呈现时，它最终或多或少是一个 A4 页面，具有典型的字体，带有跟随风。没有任何保证，但您可以针对常见情况进行优化。

在打印中您不必太担心字体大小偏好或 dpi 设置，但您仍然无法控制浏览器使用的边距或实际页面大小（US Letter 小于 A4），因此请留出大量回旋余地并在主要浏览器上进行测试。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-21T14:01:41.823

不可以。您无法控制用户的缩放级别、打印机设置、纸张大小（他在欧洲使用 A4 纸还是在美国合法？）以及影响使用 HTML 的打印机输出的所有其他各种因素。

使用 HTML 可以做的最好的事情是制作一个非常简单的“打印机友好”页面并保持内容简短。或者，您可以构建 PDF，该 PDF 旨在让您控制其打印方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T14:01:39.717

您可以使用 CSS 设置页面样式并将其设置为特定的高度/宽度......这里有一个很好的[教程](http://martybugs.net/articles/print.cgi)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T14:06:01.110

使用 PDF。您可以强制执行许多事情，例如字体大小、字体类型和许多其他参数，但任何浏览器都可以决定他们不在乎并使用他们想要的任何东西，因此违反了您的先决条件或决定。HTML 不是（在我之后重复：不是）一种表示语言。

在许多情况下，它大部分都会起作用，但没有什么是确定的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-21T14:18:18.013

不可以，但是您可以通过使用打印媒体的专用 CSS 文件来使打印视图更加流畅，就像上面建议的那样。

[然后，您至少可以通过使用“page-break-before：always;”](http://www.w3schools.com/Css/pr_print_pagebb.asp "分页前：总是")来防止表格跨越 2 页 。.

最后你也可以使用 [“display:none;”](http://www.w3schools.com/css/pr_class_display.asp "显示：无；") 在广告、导航栏等不必要的元素上，以保持页面本身更短（希望对于单个页面来说足够短）。

不过，没有保证。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T14:01:52.023

当然。你有几种可能性：

*   将您的页面转换为大图像。
*   将您的页面转换为 PDF。
*   用一个左右滚动的固定尺寸页面惹恼所有用户，因为它太宽并且很难传输信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T14:03:04.033

不，没有办法，因为在呈现 HTML 时您不可能知道打印机类型或纸张尺寸。

我唯一的建议是设置打印机属性以在打印时缩放内容以适合一页。

# php - 与 iSeries 的无 DSN ODBC 连接

> ID：465404
> 
> 赞同：0
> 
> 时间：2009-01-21T13:56:06.980
> 
> 标签：php, odbc, ibm-midrange, unixodbc

我在 Ubuntu 8.04.1 服务器上使用 ibm_db2 v1.8.0 运行 PHP 5.2.4。我正在尝试使用运行 OS/400 v5R3 的 IBM iSeries，但我完全不确定如何在没有 DSN 的情况下实际连接。我查看了[http://www.connectionstrings.com/](http://www.connectionstrings.com/)但 DB2 或 AS/400 连接字符串似乎都不起作用。我最终得到的是：

```
[IBM][CLI Driver] SQL1013N The database alias name or database name "" could not be found. SQLSTATE=42705 SQLCODE=-1013 
```

这是我当前的 DSN 字符串：

```
DRIVER={iSeries Access ODBC Driver};SYSTEM=192.168.0.20;Uid=user;Pwd=password 
```

我也尝试过“IBM DB2 ODBC DRIVER”，但得到与上面的字符串相同的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T15:00:30.673

这是我在 .NET 环境中使用的内容：

```
Provider=IBMDA400.DataSource.1;Data Source=xxx.xxx.xxx.xxx;Password=xxxxxxxxxx;User ID=xxxxxxxxxx;Initial Catalog=SERVERNAME 
```

您可能缺少“初始目录”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-20T22:12:46.807

事实证明，我不得不使用 ODBC，因为没有一种简单的方法可以从 PHP 访问 DBU，而无需设置 DB2-C 并将所有内容通过管道传输。

# c# - 在 WCF 中设计服务和操作

> ID：465419
> 
> 赞同：1
> 
> 时间：2009-01-21T13:59:28.237
> 
> 标签：c#, .net, wcf, design-patterns, soa

我将不胜感激有关 WCF 中建模服务和操作的一些指导。

我有一系列业务领域，每个领域都有我希望能够通过 WCF 使用的定制方法。我猜一个 OO 视图会是这样的：

```
interface IBusinessDomain1
{
    MyClass1 Method1(...)
    MyClass2 Method2(...)
}

interface IBusinessDomain2
{
    MyClass3 Method3(...)
    MyClass4 Method4(...)
} 
```

我的自然倾向是让每个接口成为服务，让每个方法成为操作，我遇到的问题是各个域中的操作很可能需要完全不同的绑定配置。即 Method1 可能需要同步，Method2 可能需要异步。

在为 WCF 定义服务和操作时，更好的方法是考虑数据类型和需要发送数据的方式吗？也许所有业务领域的方法都需要以特定方式工作并在一个服务中使用？我想知道其他人是如何处理类似情况的？

我见过的大多数 WCF 教程和示例都倾向于使用相当简单的模型，通常是提供“添加”、“减去”等操作的“计算器”服务，它们都共享相同的绑定。

一些关于如何定义我的服务和操作的建议将不胜感激，或者只是一些进一步阅读的链接，因为我找不到太多。

提前致谢， 威尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T17:26:50.580

我认为将你的合约组合在一起以确定它们是否以异步方式调用是一个坏主意。您仍然应该为您的合同保留有意义的逻辑分组。

您还需要详细说明您可以将哪些不同的绑定配置应用于您的合同。如果您需要在客户端上异步调用合约上的方法，那么这不是服务必须关心的事情，因为客户端可以选择生成支持异步操作的合约（您将获得 Begin* 和 End * 通道工厂将为您生成的合约上的方法）。

However, if you are doing something like having the service return a token which the client passes back to the service to check on status, you might want to consider a callback interface, as it will make your design much cleaner.

If the different binding configurations have to do with changes in the endpoint (i.e. the transport channel, for example) then you might consider different contracts for different endpoints, but I don't get the impression that is what you are looking for here.

# python - 如何获取一个程序的输出并将其用作另一个程序的输入？

> ID：465421
> 
> 赞同：5
> 
> 时间：2009-01-21T14:01:11.137
> 
> 标签：python, ruby, io

我看过[这个](https://stackoverflow.com/questions/316007/what-is-the-best-way-to-make-the-output-of-one-stream-the-input-to-another)，并没有太大帮助。

我有一个向 cmd 行提出问题的 Ruby 程序，我想编写一个可以返回答案的 Python 程序。有谁知道任何链接或一般来说我可能会如何去做？

谢谢你的帮助。

**编辑**
感谢提到*管道*的人。我没有过多地使用它，很高兴它被提出来，因为它迫使我更多地关注它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-21T14:12:23.970

```
p = subprocess.Popen(['ruby', 'ruby_program.rb'], stdin=subprocess.PIPE, 
                                          stdout=subprocess.PIPE)
ruby_question = p.stdout.readline()
answer = calculate_answer(ruby_question)
p.stdin.write(answer)
print p.communicate()[0]  # prints further info ruby may show. 
```

最后两行可以合并为一行：

```
print p.communicate(answer)[0] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T14:05:22.923

如果您使用的是 unix / linux，则可以使用管道：

```
question.rb | answer.py 
```

然后 question.rb 的输出变成 answer.py 的输入

我最近没有尝试过，但我感觉同样的语法也可以在 Windows 上运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T14:08:51.043

期待

[http://www.noah.org/wiki/Pexpect](http://www.noah.org/wiki/Pexpect)

> Pexpect 是一个纯 Python 的类 expect 模块。Pexpect 使 Python 成为控制其他应用程序的更好工具。
> 
> Pexpect 是一个用于生成子应用程序的纯 Python 模块；控制它们；并响应其输出中的预期模式。Pexpect 的工作方式类似于 Don Libes 的 Expect。Pexpect 允许您的脚本生成子应用程序并控制它，就好像人类正在键入命令一样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-21T14:12:50.707

首先检查一下：[Unix 管道][1]

它适用于 Windows 或 unix，但有点不同，首先是程序：

问题.rb：

```
puts "This is the question" 
```

答案.rb：

```
question = gets
#calculate answer
puts "This is the answer" 
```

然后是命令行：

在 unix 中：

```
question.rb | answer.rb 
```

在窗口中：

```
ruby question.rb | ruby answer.rb 
```

输出：

```
This is the question
This is the answer 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T14:08:57.423

有两种方法（在我脑海中）可以做到这一点。如果您在 Unix 环境中，最简单的方法是使用管道。简单的例子：

```
cat .profile .shrc | more 
```

这会将第一个命令 ( `cat .profile .shrc`) 的输出发送到`more`使用管道字符的命令`|`。

第二种方法是在源代码中从另一个程序调用一个程序。我不知道 Ruby 是如何处理这个问题的，但是在 Python 中，您可以运行一个程序并使用 popen 函数获取它的输出。请参阅[Learning Python 中的此示例章节](http://oreilly.com/catalog/lpython/chapter/ch09.html)，然后使用 Ctrl-F 表示“popen”以获取一些示例代码。

# c# - 在 C# 运行时创建 pdf 文件

> ID：465433
> 
> 赞同：84
> 
> 时间：2009-01-21T14:03:22.503
> 
> 标签：c#, pdf

是否有附加/可以附加到 .NET 3.5 的 pdf 库，它允许在运行时创建 pdf 文件，即打开一个新的 pdf 文件，逐行写入，嵌入图像等并在 C# 代码中关闭 pdf 文件?

我想要的是一组工具和规范，它们允许我在 C# 中实现自定义的 pdf 编写器，而无需使用 Reporting Services 的 pdf 输出选项。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2010-12-05T21:33:08.840

iTextSharp 不再获得 MIT/LGPL 许可。高于 4.1.6 的版本根据 Affero GPL 获得许可，这意味着如果没有根据 GPL 或与 GPL 兼容的许可许可代码，您甚至无法在 SaaS（软件即服务）场景中使用它。

本机 .NET 中的其他开源 PDF 实现包括

*   [PDF Clown](http://pdfclown.wordpress.com)（确保您获得最新版本的补丁）
*   [PDFSharp](http://www.pdfsharp.net)
*   [PDFJet 开源版](http://www.pdfjet.com/os/edition.html)（也提供商业版，您需要安装 JDK 来构建它）

还有几个 Java PDF 库（如 PDFBox）可以使用 IKVM 转换为 .NET。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-01-21T14:07:36.863

iTextSharp [http://itextsharp.sourceforge.net/](http://itextsharp.sourceforge.net/)

复杂但全面。

[itext7](https://github.com/itext/itext7-dotnet)前 iTextSharp

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-01-21T14:19:31.613

看看[PDFSharp](http://www.pdfsharp.net/)

它是开源的，它是用 .NET 编写的，我自己用它来生成一些 PDF 发票。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-21T14:10:59.557

好吧，免费且不是免费的，我使用[WebSuperGoo ABCpdf .NET](http://www.websupergoo.com/products.htm)组件，我就是喜欢它！

**不是免费的，**因为您需要为此付费。

**免费**，因为即使您必须付费，他们也有试用版，如果您不介意，您可以[申请免费许可证，在您的站点中显示“此站点使用 WebSuperGoo ABCpdf .NET 组件”以及指向他们网站的链接。](http://www.websupergoo.com/linktous_legal.aspx)

我这样做了，并且获得了免费许可证（当时是第 5 版）所以，我可以说它可以工作（即使网站不再在线）-我仍然拥有并使用该组件 ~:)

我喜欢这个的一个美妙的事情是你可以做任何你可以做的事情，创建 PDF 表单并动态填写它们并通过邮件发送给用户或让他们下载它，从头开始创建 pdf，转换 HTML页面转换成 PDF 等等等，请阅读文档，这是一个很棒的组件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-21T14:08:21.917

我强烈推荐：**[iTextSharp](http://sourceforge.net/projects/itextsharp/)**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T14:07:39.203

我过去使用过（[iTextSharp](http://itextsharp.sourceforge.net/)），效果很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T14:24:41.993

我在我的一个博客中发布了如何使用 iTextSharp 的示例：

[http://devpinoy.org/blogs/marl/archive/2008/02/14/create-pdf-in-c-2008-a-pdf-sample-app-for-grade-1-pupils.aspx](http://devpinoy.org/blogs/marl/archive/2008/02/14/create-pdf-in-c-2008-a-pdf-sample-app-for-grade-1-pupils.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T14:37:13.543

为此，我研究了运行 LaTeX 应用程序以生成 pdf。尽管此选项可能比此处列出的选项更加复杂和繁重。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-21T16:34:17.863

我过去使用过 Gnostice，发现它们非常好。

[http://www.gnostice.com/PDFOne_dot_Net.asp](http://www.gnostice.com/PDFOne_dot_Net.asp)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-04-16T18:26:09.867

[Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)可以很容易地用于在运行时创建 PDF 文件。该库还可以修改现有的 PDF 文档（提取文本/图像、附加页面、填写表单字段等）

图书馆网站上提供[了常见任务的示例。](https://bitmiracle.com/pdf-library/help/samples.html)

免责声明：我为 Bit Miracle 工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-09-18T17:49:14.440

[Amyuni PDF Converter .Net](http://www.amyuni.com/en/developer/pdfcreator/features)也可以用于此。它还允许您修改现有文件、对其应用 OCR 并提取文本、创建光栅图像（例如用于生成缩略图）、优化输出 PDF 以供 Web 查看等。

*通常的免责声明适用。*

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-29T08:56:35.980

有一个新项目 RazorPDF 可以从 ASP.NET MVC 中使用。它以 nuget 包的形式提供（搜索 RazorPDF）。

这里有更多信息： http: [//nyveldt.com/blog/post/Introducing-RazorPDF](http://nyveldt.com/blog/post/Introducing-RazorPDF)

**@DenNukem 指出的重要更新，它取决于 iTextsharp，当我发现它时忘记编辑答案（当我尝试使用它时），所以如果你的项目不是开源的并且有资格获得他们的 AGPL 许可证，它可能**会**使用起来太贵了。**

 *** * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-01-21T14:08:41.963

[iTextSharp](http://www.1t3xt.com/products/index.php)怎么样？

iText 是一个 PDF（以及其他）生成库，它也被移植（并保持同步）到 C#。

# nhibernate - 从 NHibernate 实体的构造函数中调用虚拟属性可以吗？

> ID：465436
> 
> 赞同：19
> 
> 时间：2009-01-21T14:04:49.507
> 
> 标签：nhibernate

看看这个示例代码：

```
public class Comment
{
    private Comment()
    { }

    public Comment(string text, DateTime creationDate, string authorEmail)
    {
        Text = text;
        CreationDate = creationDate;
        AuthorEmail = authorEmail;
    }

    public virtual string Text { get; private set; }
    public virtual DateTime CreationDate { get; set; }
    public virtual string AuthorEmail { get; private set; }
} 
```

我知道从构造函数调用虚拟成员函数被认为是不好的做法，但是在 NHibernate 中我需要属性是虚拟的以支持延迟加载。在这种情况下认为可以吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T14:08:31.793

我很确定这很好，但是如果您担心，您总是可以在无参数构造函数调用之后分配属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T15:28:13.830

要扩展 Paco 的答案：

在大多数情况下，它不会受到伤害。但是如果类是继承的，virtual 允许属性 get/set 被覆盖，因此行为不再完全封装和控制，因此理论上它可以中断。FxCop 对此提出警告，因为这是一个潜在问题。

FxCop 的目的是帮助警告您潜在的问题。如果您知道谁/什么将从类继承，那么在构造函数中使用属性并没有*错*，但这并不是正式的“最佳实践”。

所以，答案是只要你控制类的任何继承就可以了。否则，不要使用它并直接设置字段值。（这意味着您不能使用 C# 3.0 自动获取/设置属性——您必须自己编写包装字段的属性。）

旁注：就我个人而言，我所有的项目都是我们为客户托管的网站。因此，假设这个设置对于一个项目保持不变，那么值得权衡的是必须复制各种空值/参数检查。但是，在任何其他情况下，如果我不确定我们是否会保持对项目和类的使用的完全控制，我不会走这条捷径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T20:13:21.867

在这个示例中没问题，但是当您继承类并覆盖属性时可能会导致问题。通常，您可以更好地为虚拟属性创建字段。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-04T10:49:54.347

恕我直言，最佳实践是使用带有支持字段的属性：

```
public class Comment
{
    private DateTime _creationDate;
    private string _text;
    private string _authorEmail;
    private Comment() { }
    public Comment(string text, DateTime creationDate, string authorEmail)
    {
        _text = text;
        _creationDate = creationDate;
        _authorEmail = authorEmail;
    }
    public virtual string Text
    {
        get { return _text; }
        private set { _text = value; }
    }
    public virtual string AuthorEmail
    {
        get { return _authorEmail; }
        private set { _authorEmail = value; }
    }
    public virtual DateTime CreationDate
    {
        get { return _creationDate; }
        set { _creationDate = value; }
    }
} 
```

所以你可以避免子类的问题，你不会再看到任何警告

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T14:13:20.847

我知道如果您在构造函数中调用虚拟方法，FxCop 会抱怨，但我不知道 FxCop 说的是您是否在构造函数中调用虚拟属性......
我认为 FxCop 也会抱怨，因为属性被翻译成 IL 中的方法。

您还可以将您的属性创建为“非虚拟”，只需在 NHIbernate 中的“类映射”上指定“lazy=false”。这不会影响集合的延迟加载行为。

（我一直这样做，因为我不喜欢我的基础架构（NHibernate）要求我拥有虚拟属性。
我也不知道在 NHibernate 中使用动态代理的性能优势是否显着）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T15:53:42.593

我认为，您不应该在构造函数中调用它。您可以提供一个方法 Initialize()，您可以在构造对象后调用该方法。

在 Initialize() 中，您可以调用所需的虚拟方法

# c# - 如何在自定义 IOC 容器中使用构造函数参数解析实例？

> ID：465437
> 
> 赞同：0
> 
> 时间：2009-01-21T14:05:17.430
> 
> 标签：c#, dependency-injection, inversion-of-control, ioc-container

我正在尝试构建自己的控制容器反转。现在我将对象及其类型存储在字典中，并在被询问时解析引用。但我想让解析引用或新实例成为可能。我可以使用 Activator 类创建一个新实例。但是，如果要解析的对象的构造函数接受 1、2 或任何参数怎么办？

例如，我希望能够这样说：

```
Container.register<IFoo>(new Foo(Proxy));
Container.register<IBar>(new Boo(Proxy, DataThing)); 
```

并像解决它

```
IFoo MyFoo = Resolver.resolve<IFoo>();
IBar MyBar = Resolver.resolve<IBar>(); 
```

其中 MyFoo 使用给定参数*Proxy*和 MyBar 与*Proxy*和*DataThing*实例化。

*决心*必须做什么才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T02:26:27.803

结帐[http://funq.codeplex.com](http://funq.codeplex.com)。这是一个非常小的容器，它使用 lambda 表达式来定义要解析的函数。处理多个参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T09:18:40.367

我决定将其拆分为方法。一个 Resolve，它返回存储在容器中的实例。和一个创建一个新实例的实例。

就像是：

```
 public T Create<T>()
         {
             if (registeredTypes.ContainsKey(typeof(T)))
                 return (T)Activator.CreateInstance(registeredTypes[typeof(T)].
                                                                       GetType());
             else
                 throw new DependencyResolverException("Can't
                                       create type. Type " + typeof(T) + "
                                                           not found.");
         } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T14:11:45.093

Activator 可以创建具有带参数的构造函数的类的实例。

看看[CreateInstance](http://msdn.microsoft.com/en-us/library/4b0ww1we.aspx)方法的这个重载。

您可以提供自定义[活页夹](http://msdn.microsoft.com/en-us/library/system.reflection.binder.aspx)来手动搜索匹配的构造函数。

在您的情况下，*解析*方法应返回对注册类实例的引用（在您的示例中为 new Boo(Proxy, DataThing)）

# ruby-on-rails - 命名空间项目的 Rails 路由错误

> ID：465442
> 
> 赞同：0
> 
> 时间：2009-01-21T14:06:06.290
> 
> 标签：ruby-on-rails, routes, rails-routing, ruby-on-rails-2

我们有一个 Rails 应用程序，它不断产生我们无法追踪的错误。问题似乎出在路由上，但我们不确定发生了什么。输出路由文件如下所示：

```
 ActionController::Routing::Routes.draw do |map|
    # Default
    map.home '', :controller => "home"

    # Admin

    map.admin_home 'admin', :controller => 'admin/admin', :action => 'index'
    map.admin_login 'admin/login', :controller => 'admin/admin', :action => 'login'
    map.admin_reminder 'admin/forgot', :controller => 'admin/admin', :action => 'reminder'
    map.namespace :admin do |admin|
      admin.resources :bookings,
        :collection => {
          :archive => :get, :reports => :get, :calendar => :get,
          :step_1 => :any, :step_1a => :any, :step_2 => :any, :step_3 => :any, :confirmation => :any }
      admin.resources :events,
        :member => { :status => :get }
      admin.resources :blogs,
        :collection => { :archive => :get }
      admin.resources :blog_replies,
        :member => { :publish => :get }
      admin.resources :minutes,
        :collection => { :archive => :get }
      admin.resources :businesses
      admin.resources :business_categories
      admin.resources :users
      admin.resources :pricings
      admin.backups 'backups', :controller => 'admin/backups'
      admin.download_backup 'backups/download', :controller => 'admin/backups', :action => 'download'
    end
    map.admin 'admin/:action', :controller => 'admin/admin'

    map.connect 'members', :controller => 'admin/admin', :action => 'redirect_to_index'
    map.connect 'members/login', :controller => 'admin/admin', :action => 'redirect_to_index'
    map.connect 'account', :controller => 'admin/admin', :action => 'redirect_to_index'
    map.connect 'account/login', :controller => 'admin/admin', :action => 'redirect_to_index'
    map.connect 'home', :controller => 'admin/admin', :action => 'redirect_to_index'
    map.connect 'home/login', :controller => 'admin/admin', :action => 'redirect_to_index'

    map.blog 'blog/:permalink', :controller => 'blogs', :action => 'show'
    map.connect 'blog/:id', :controller => 'blogs', :action => 'show'
    map.connect 'book-online', :controller => 'bookings', :action => 'step_1'
    map.connect 'book-online/:action', :controller => 'bookings'
    # Defaults
    map.connect ':controller/:action/:id'
    map.connect "*anything", :controller => "public", :action => "unknown_request"
  end 
```

我们在 app/controllers 中有一组公共控制器，在 app/controllers/admin 中有一组管理控制器。我们一直看到的问题是，当用户访问诸如 admin/bookings、admin/bookings/step_1 或 admin/events 之类的 URL 时。有时 url 工作得很好，但有时我可以从日志文件中看到类似以下的事情发生：

```
ActionController::UnknownAction (No action responded to index): 
```

其他时候我们会得到类似的东西：

```
Processing EventsController#index (for [filtered] at 2009-01-21 10:54:38) [GET]
Session ID: [filtered]
Parameters: {"action"=>"index", "controller"=>"admin/events"}
Rendering template within layouts/public
Rendering events/index
Completed in 0.00863 (115 reqs/sec) | Rendering: 0.00338 (39%) | DB: 0.00000 (0%) | 200 OK [http://www.gresfordtrust.org/admin/events] 
```

从最后一个示例中，您可以看到请求的 url`admin/events`应该已经点击了`#index`in ，`Admin::EventsController`但它呈现了in 中的`#index`操作`EventsController`。

我们正在使用 Rails 2.0.2 运行该应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-01T19:40:41.320

您没有为 EventsController 配置路由，因此您的错误正在发生，因为某些请求正在下降到默认路由，`map.connect ':controller/:action/:id'` .

发生这种情况是因为某人/某物正在发送未为您的 AdminEventsController 配置的 HTTP 方法的请求。您`admin.resources :events, :member => { :status => :get }`将匹配以下请求：

```
GET /admin/events
GET /admin/events/<id>
GET /admin/events/<id>/status
POST /admin/events
PUT /admin/events/<id>
DELETE /admin/events/<id> 
```

其他任何事情都会落入默认路线。因此，如果您`ActionController::UnknownAction`在此控制器上看到那些请求，请查找使用错误 HTTP 方法的请求。

您奇怪的日志消息的来源几乎可以肯定是这样的请求：

```
GET /admin/events/index 
```

解决方案是完全摆脱该默认路由，并确保您`resource[s]`在正确的位置为所有控制器添加路由。

# c# - 在 Windows 和 Silverlight 类库之间共享 C# 代码

> ID：465460
> 
> 赞同：14
> 
> 时间：2009-01-21T14:09:40.840
> 
> 标签：c#, windows, silverlight, sharing

我们编写了一个小型 Windows 类库，它实现了一些标准类型（最初是字符串）的扩展方法。我把它放在一个库中，这样我们的任何项目都可以通过简单地引用它并使用 XXX.Extensions 添加来使用它。

当我们想在 Silverlight 中使用其中一些方法时，出现了一个问题。尽管所有代码都是兼容的，但在 Silverlight 中无法引用 Windows 库，因此我们创建了一个 Silverlight 库，该库具有指向相同类文件的链接，并将编译器指令放入类中以允许不同的 using 声明和命名空间。这一直很好，直到今天我向 Windows 扩展库添加了一个新类并意识到我必须记住将这个类也链接到 Silverlight 库。

这并不理想，我想知道是否有人对在 Windows 和 Silverlight 项目之间共享扩展方法和其他帮助代码的更好方法有想法。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-21T16:01:30.923

您不能设置从 Silverlight 程序集到常规 .NET 程序集的引用，但您可以反过来这样做。

因此，创建一个共享 Silverlight 程序集并将您的代码添加到该程序集。现在，您可以设置常规 .NET 和其他 Silverlight 程序集对共享 Silverlight 程序集的引用。

限制是您只能在其中放置适用于 .NET 和 Silverlight CLR 的代码，但这与共享代码没有什么不同。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-07-13T10:35:19.543

既然已经回答了这个问题，微软就有了一个新的解决方案，[便携式类库](http://msdn.microsoft.com/en-us/library/gg597391.aspx)。[这](http://blogs.msdn.com/b/bclteam/archive/2011/01/19/announcing-portable-library-tools-ctp-justin-van-patten.aspx)是他们宣布它的博客文章。

我正要开始和他们一起玩，以便在 silverlight 和我正在编写的一些服务器端代码之间共享代码，所以目前不能在链接之外添加太多内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T14:18:43.783

Silverlight 运行时不同于普通的 .NET 运行时。所以你需要在项目级别做一些技巧来在多个平台之间共享代码。

这是我[为 Autofac IoC container 所做的](http://rabdullin.com/journal/2009/1/4/how-to-target-multiple-net-frameworks.html)。

使用这种方法**，您不必为每个目标平台创建不同的项目**。

[PS：复合 WPF](http://www.codeplex.com/CompositeWPF)中还有一个**项目链接器**工具，它允许链接 Silverlight 和 WPF 项目（创建多个项目）。但它看起来确实很乱。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T14:14:14.153

[XNA](http://creators.xna.com)项目也有类似的问题。由于您可以针对多个不同的平台，因此您需要拥有不同的项目。这样做的原因是因为项目引用的基类库是特定于平台的，所以你不能只有一个项目。

如果你很好奇，你可以从[这个博客](http://badcorporatelogo.spaces.live.com/Blog/cns!43EB71B104A2D711!343.entry)中获得一些见解：

> 要为另一个平台重新编译源代码，您需要另一个项目。这是因为项目需要为 XNA Framework 和底层 .NET Framework 引用不同的程序集（Xbox 360 和 Zune 使用 .NET Compact Framework），而 C# 项目不提供对引用不同程序集的支持不同的平台。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-13T19:37:04.937

试试这个[http://buildassilverlight.codeplex.com/](http://buildassilverlight.codeplex.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-16T11:35:51.940

在 .Net 中引用 Silveright 类库时，我遇到了一些依赖问题。

使用 Visual Studio 2010 和 WCF RIA 1.0 时的另一种方法：

*   创建一个普通的 .Net 库程序集。
*   创建 Silverlight 类库。在程序集的配置中，将第一个 .NET 库指定为“WCF RIA 服务链接”
*   将您的代码作为“ClassName.shared.cs”文件放入 .NET 库中。
*   WCF RIA 将处理将文件复制到 Silverlight 程序集。

# php - 类实例化失败

> ID：465483
> 
> 赞同：1
> 
> 时间：2009-01-21T14:19:01.083
> 
> 标签：php, oop, class

如果在实例化过程中给出了无效参数，我在让我的对象优雅地失败时遇到一些问题。我有一种感觉，这是我需要重新审视的地方的一个小语法。任何帮助都非常感谢。

```
class bib {
   protected $bibid;
   public function __construct($new_bibid) {
      if(!$this->bibid = $this->validate_bibid($new_bibid)) {
        echo 'me';
        return false;
      }
      //carry on with other stuff if valid bibid
    }

    private static function validate_bibid($test_bibid) {
       //call this method every time you get a bibid from the user
       if(!is_int($test_bibid)) {
            return false;
       }
       return (int)$test_bibid;
    }
 } 
```

请注意，我在那里有一条“echo me”行来证明它实际上是返回 false。我在我的 PHP 中调用它的方式如下：

```
if(!$bib=new bib('612e436')) {
    echo 'Error Message';
} else {
    //do what I intend to do with the object
} 
```

这会从上面输出 me，然后继续进入 else 块，执行我打算对有效对象执行的操作。

谁能发现我在那里做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T14:43:36.527

我在这段代码中看到了几个问题。

*   首先，我认为你想做这样的事情：

    $myBib=新围兜（）；if($myBib->validate_bibid('612e436')) { ..do stuff.. }

    （或类似的东西）

    请记住 __construct 不是一个正常的方法。它是一个构造函数，它不应该返回任何东西。它已经隐式返回对您创建的新实例的引用。

*   其次，您的 validate_bibid 返回布尔值或整数。你不会立即遇到问题，但我个人不喜欢这种风格。

*   第三，您已经声明了一个受保护的成员 $bibid，但您没有在任何地方设置或引用它。例如，我希望它在构造函数中设置。之后，您可以直接调用 validate_bibid 而无需任何参数。

这段代码显然会让您感到困惑，因为它有一些奇怪的结构，因此不会以正常方式运行。我建议重新考虑并从头开始重写这篇文章。

**更新：**

另一个问题：

我不认为这条线做你认为它做的事情：

```
 if(!$this->bibid = $this->validate_bibid($new_bibid)) { 
```

你可能是这个意思：

```
 if(!$this->bibid == $this->validate_bibid($new_bibid)) {

 // Or even better:

 if($this->bibid <> $this->validate_bibid($new_bibid)) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T14:24:42.603

您不能在 PHP 中的构造函数中返回 - 该对象仍照常创建。

您可以使用工厂或类似的东西；

```
if(!$bib = Bib_Factory::loadValidBib('612e436')){
    echo 'Error Message';
} else {
    //do what I intend to do with the object
} 
```

或者在构造函数中抛出异常并使用 try catch 代替 if 语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T19:45:50.363

当然，您需要与 == 而不是 = 进行比较，这是一个分配操作。

# c# - 我可以在运行时加载 .NET 程序集并实例化只知道名称的类型吗？

> ID：465488
> 
> 赞同：183
> 
> 时间：2009-01-21T14:20:06.293
> 
> 标签：c#, assemblies

如果我只有 DLL 名称和类名，而不在项目中添加对程序集的引用，是否可以在运行时实例化对象？这个类实现了一个接口，所以一旦我实例化了这个类，我就会把它转换成接口。

大会名称：

> 库.dll

类型名称：

> 公司.项目.类名

* * *

**编辑：**我没有 DLL 的绝对路径，所以`Assembly.LoadFile`不会工作。DLL 可能位于应用程序根目录、system32 中，甚至加载到 GAC 中。

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2009-01-21T14:28:12.830

是的。您需要使用[`Assembly.LoadFrom`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.loadfrom.aspx)将程序集加载到内存中，然后您可以使用[`Activator.CreateInstance`](http://msdn.microsoft.com/en-us/library/d133hta4.aspx)创建您喜欢的类型的实例。您需要先使用反射查找类型。这是一个简单的例子：

```
Assembly assembly = Assembly.LoadFrom("MyNice.dll");

Type type = assembly.GetType("MyType");

object instanceOfMyType = Activator.CreateInstance(type); 
```

### 更新

当您拥有程序集文件名和类型名称时，您可以使用[`Activator.CreateInstance(assemblyName, typeName)`](http://msdn.microsoft.com/en-us/library/d133hta4.aspx)请求 .NET 类型解析将其解析为类型。您可以使用 try/catch 对其进行包装，以便如果失败，您可以搜索目录，您可以在其中专门存储其他可能无法搜索的程序集。这将在那时使用前面的方法。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-01-21T14:46:45.350

考虑不同`Load*`方法的局限性。从[MSDN](http://msdn.microsoft.com/en-us/library/b61s44e8.aspx)文档...

> LoadFile 不会将文件加载到 LoadFrom 上下文中，**也不会**像 LoadFrom 方法那样使用加载路径解析依赖关系。

有关加载上下文的更多信息可以在[`LoadFrom`](http://msdn.microsoft.com/en-us/library/1009fa28.aspx)文档中找到。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-21T14:24:34.600

[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)应该可以工作。

```
IFace object = (IFace)Activator.CreateInstance( "AssemblyName",
                                                "TypeName" )
                               .Unwrap(); 
```

**注意：**类型名称必须是完全限定类型。

例子：

```
var aray = (IList)Activator.CreateInstance("mscorlib","System.Collections.ArrayList").Unwrap();
aray.Add(10);

foreach (object obj in aray)
{
    Console.WriteLine(obj);
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-02-17T17:45:42.780

我发现这个问题和一些答案非常有用，但是我确实遇到了路径问题，所以这个答案将涵盖通过查找 bin 目录路径来加载库。

第一个解决方案：

```
string assemblyName = "library.dll";
string assemblyPath = HttpContext.Current.Server.MapPath("~/bin/" + assemblyName);
Assembly assembly = Assembly.LoadFrom(assemblyPath);
Type T = assembly.GetType("Company.Project.Classname");
Company.Project.Classname instance = (Company.Project.Classname) Activator.CreateInstance(T); 
```

第二种解决方案

```
string assemblyName = "library.dll";
string assemblyPath = HttpContext.Current.Server.MapPath("~/bin/" + assemblyName);
Assembly assembly = Assembly.LoadFile(assemblyPath);
(Company.Project.Classname) instance = (Company.Project.Classname) assembly.CreateInstance("Company.Project.Classname"); 
```

您可以对接口使用相同的原则（您将创建一个类但转换为接口），例如：

```
(Company.Project.Interfacename) instance = (Company.Project.Interfacename) assembly.CreateInstance("Company.Project.Classname"); 
```

此示例适用于 Web 应用程序，但类似的可用于桌面应用程序，只是路径以不同的方式解析，例如

```
Path.GetDirectoryName(Application.ExecutablePath) 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-05-02T12:28:20.557

这很简单。

来自 MSDN 的示例：

```
public static void Main()
{
    // Use the file name to load the assembly into the current
    // application domain.
    Assembly a = Assembly.Load("example");
    // Get the type to use.
    Type myType = a.GetType("Example");
    // Get the method to call.
    MethodInfo myMethod = myType.GetMethod("MethodA");
    // Create an instance.
    object obj = Activator.CreateInstance(myType);
    // Execute the method.
    myMethod.Invoke(obj, null);
} 
```

这是一个参考链接

[https://msdn.microsoft.com/en-us/library/25y1ya39.aspx](https://msdn.microsoft.com/en-us/library/25y1ya39.aspx)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-02-27T14:24:02.597

从 Framework v4.5 开始，您可以使用**Activator.CreateInstanceFrom()**轻松实例化程序集中的类。下面的例子展示了如何使用它以及如何调用传递参数和获取返回值的方法。

```
 // Assuming moduleFileName contains full or valid relative path to assembly    
    var moduleInstance = Activator.CreateInstanceFrom(moduleFileName, "MyNamespace.MyClass");
    MethodInfo mi = moduleInstance.Unwrap().GetType().GetMethod("MyMethod");
    // Assuming the method returns a boolean and accepts a single string parameter
    bool rc = Convert.ToBoolean(mi.Invoke(moduleInstance.Unwrap(), new object[] { "MyParamValue" } )); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-01-12T11:04:18.113

```
Assembly assembly = Assembly.LoadFrom("MyAssembly.dll");

Type type = assembly.GetType("MyType");

dynamic instanceOfMyType = Activator.CreateInstance(type); 
```

因此，通过这种方式，您可以使用不获取方法信息的函数，然后调用它。您将这样做 instanceOfMyType.MethodName(); 但是您不能使用 Intellisense，因为动态类型是在运行时输入的，而不是在编译时输入的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-21T14:26:07.107

是的。我现在没有任何我亲自做过的例子。稍后我找到一些后会发布。基本上，您将使用反射来加载程序集，然后提取您需要的任何类型。

同时，此链接应该可以帮助您入门：

[在运行时使用反射加载未引用的程序集](http://www.dreamincode.net/forums/showtopic78974.htm)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-21T14:30:35.337

根据这种功能对您的项目的内在程度，您可能需要考虑像[MEF](http://www.codeplex.com/MEF)这样的东西，它会为您处理组件的加载和绑定。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-21T14:33:18.560

您可以使用 *Assembly.Load** 方法加载程序集。使用*Activator.CreateInstance*您可以创建所需类型的新实例。请记住，您必须使用要加载的类的完整类型名称（例如*Namespace.SubNamespace.ClassName*）。使用*Type类的**InvokeMember*方法，您可以调用该类型的方法。

 *另外，考虑到一旦加载，程序集在整个 AppDomain 也被卸载之前无法卸载（这基本上是内存泄漏）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-21T14:27:14.080

```
((ISomeInterface)Activator.CreateInstance(Assembly.LoadFile("somePath").GetTypes()[0])).SomeInterfaceMethod(); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-21T14:26:59.103

是的，是的，您将要在 Assembly 类上使用静态 Load 方法，然后调用 Load 调用返回给您的 Assembly 实例上的 CreateInstance 方法。

此外，您可以根据需要在 Assembly 类上调用以“Load”开头的其他静态方法之一。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-26T13:09:16.097

你可以这样做：

```
using System.Reflection;

Assembly MyDALL = Assembly.Load("DALL"); //DALL name of your assembly
Type MyLoadClass = MyDALL.GetType("DALL.LoadClass"); // name of your class
 object  obj = Activator.CreateInstance(MyLoadClass); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-07-24T13:54:04.833

我正在使用 .net5（.net 核心 5）。我需要做的是：

```
 static void Main()
    {
        //...

        AppDomain.CurrentDomain.AssemblyResolve += CciBaseResolveEventHandler;

        Application.Run(new FormMain());
    }

    private static Assembly CciBaseResolveEventHandler(object sender, ResolveEventArgs args)
    {
        return Assembly.LoadFile($@"{Directory.GetCurrentDirectory()}\{nameof(CciBase)}.dll");
    } 
```

1.  将“CciBase”更改为您的 dll 名称。
2.  确保 dll 与 exe 位于同一文件夹中。
3.  在主进程启动之前执行此操作（Application.Run()）。

# delphi - 从类引用构造对象

> ID：465492
> 
> 赞同：3
> 
> 时间：2009-01-21T14:23:29.827
> 
> 标签：delphi, design-patterns, oop

我有一个构造对象、调用 Execute 方法并释放对象的方法。对象的类型由传递给该方法的 TClass 后代确定。请注意，这是我正在谈论的 Win32 的 Delphi，而不是 .NET。

*编辑：我应该指出这是 Delphi 2006，因为在下面的答案中已经指出，在未来的版本中可能不需要 NewInstance 调用。但是，就我而言，这是必需的。因此，我想我的问题的答案（它安全吗？ CreateForm() 是否有潜在的泄漏）需要根据这是 Delphi 2006 来回答*

*编辑#2：似乎为 D2007 和 D2009 提供的解决方案实际上对 D2006 有效。我一定是从早期版本的 Delphi 中养成了“NewInstance”的习惯......*

```
function TPageClassFactory.TryExecute(ScrnClass: TCustomPageClass): boolean;
//TCustomPageClass = class of TCustomPage
var
  ScrnObj: TCustomPage; //TCustomPage defines an abstract Execute() method
begin
  Result := FALSE; //default
  ScrnObj := TCustomPage(ScrnClass.NewInstance); //instantiate
  try
    ScrnObj.Create(Self);  //NB: Create() and Execute() are *virtual* methods
    ScrnObj.Execute;       
  finally
    FreeAndNil(ScrnObj);
  end;
  Result := TRUE;
end; 
```

我想知道这是否安全 - 如果 Create() 引发异常，这里会发生什么？

从 Forms.pas.TApplication.CreateForm() 来看一个类似的例子，对异常处理采取了不同的方法（我已经删除了下面不相关的部分）：

```
procedure TApplication.CreateForm(InstanceClass: TComponentClass; var Reference);
var
  Instance: TComponent;
begin
  Instance := TComponent(InstanceClass.NewInstance);
  TComponent(Reference) := Instance;
  try
    Instance.Create(Self);
  except
    TComponent(Reference) := nil;
    raise;
  end;
end; 
```

在Forms.pas方法中，这是否意味着Create()方法发生异常时内存泄漏？我的理解是 InstanceClass.NewInstance 分配了内存，因此在这种情况下，内存没有被释放/释放/释放？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-21T14:30:45.180

您应该将 create 放在 try finally 块之外。

但更好的解决方案是：

```
type 
  TMyClass = class ()
  public
    constructor Create(...); virtual;
    function Execute: Boolean; virtual;
  end;
  TMyClassClass = class of TMyClass;

procedure CreateExecute(const AClass: TMyClassClass): Boolean;
var
  theclass : TMyClass;
begin
  theclass := AClass.Create;
  try
    Result := theclass.Execute;
  finally
    theclass.Free;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T06:49:46.123

我想澄清一些评论中提出的问题。

首先是构造函数需要是虚拟的持续神话。它**没有**。考虑这个例子：

```
type
  TBase = class
    constructor Create(x: Integer);
  end;
  TDerived = class(TBase)
    field: string;
  end;
  TMetaclass = class of TBase;

var
  instance: TBase;
  desiredClass: TMetaclass;
begin
  desiredClass := TDerived;
  instance := desiredClass.Create(23);
  Assert(instance.ClassName = 'TDerived');
  Assert(instance is TDerived);
  Assert(instance.field = '');
end; 
```

创建的对象将是 class 的完整实例`TDerived`。将分配足够的内存来保存基类中不存在的字符串字段。

在需要虚拟构造函数之前，必须满足两个条件：

1.  构造函数将被虚拟调用。也就是说，您将拥有一个基类元类类型的变量，它将保存派生类的值，并且您将调用该变量的构造函数。这在上面的代码中得到了证明。如果您的所有构造函数调用都直接在类名本身上（即`TDerived.Create(23)`），那么从虚拟方法中就没有任何收获。
2.  基类的子类需要重写构造函数以提供特定于类的初始化。如果所有后代都使用相同的构造，并且仅在其他方法上有所不同，则十没有必要将构造函数设为虚拟。

这里要意识到的重要一点是，这两个规则与决定何时将任何其他方法变为虚拟的因素没有什么不同。构造函数在这方面并不特别。

构造函数知道构造哪个类不是基于定义构造函数的类，而是基于调用构造函数的类，并且该类总是作为隐藏的第一个参数传递给每个构造函数调用。

* * *

其次是是否`NewInstance`应该调用构造函数的位置或补充构造函数的问题。我认为其他评论已经确定它与旧 Delphi 版本的兼容性无关。*所有*版本都支持在类引用上调用构造函数，而无需`NewInstace`. 相反，混淆来自于`TApplication.CreateForm`将其视为应该如何做的一个例子。这是一个错误。

`CreateForm`在调用`NewInstance`构造函数之前调用，因为`CreateForm`存在的主要原因是确保 IDE 声明的全局表单变量在表单自己的事件处理程序期间有效，包括`OnCreate`作为构造函数的一部分运行的。如果该`CreateForm`方法完成了通常的构造模式，那么全局表单变量还没有有效值。以下是您可能期望看到的：

```
TComponent(Reference) := InstanceClass.Create(Application); 
```

简单明了，但这行不通。*直到构造函数返回之后*`Reference`才会被赋值，这是在表单触发一些事件之后很久。如果您遵循良好的编程习惯并且从不从表单类本身中引用该变量，那么您将永远不会注意到。但是，如果您遵循文档的说明，这些说明是为没有经验的读者编写的，那么您*将*在表单自己的方法中引用全局表单变量，因此该方法会尽其所能确保及时分配它。**`CreateForm`**

 **为此，它使用了两步构造技术。首先，分配内存并将引用分配给全局变量：

```
Instance := TComponent(InstanceClass.NewInstance);
TComponent(Reference) := Instance; 
```

接下来，调用实例上的构造函数，将`TApplication`对象作为所有者传递：

```
Instance.Create(Self); 
```

[我认为](http://www.cs.wisc.edu/~rkennedy/createform)应该`CreateForm`在任何程序中只调用一次。我更喜欢零次，但它具有定义的副作用`Application.MainForm`，这对于 Delphi 程序的其他方面很重要。

* * *

第三个概念是对象调用自身的构造函数是不寻常的。

事实上，这种情况*一直在*发生。每次调用继承的构造函数时，都是在调用已经存在的对象的构造函数。继承的构造函数没有分配新对象。同样，VCL 有一些构造函数的非继承调用示例。`TCustomForm.Create`将其大部分构造任务委托给其`CreateNew`构造函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T14:50:55.483

**编辑：**

不完全记得它在旧的 delphi 版本中的情况，但显然这应该基于其他回复。

请注意，只要我记得，Create 就一直在调用 Destroy 失败。不应该是在我想之后。

代码将是：

```
procedure TPageClassFactory.TryExecute(ScrnClass: TCustomPageClass);
var
  ScrnObj: TCustomPage;
begin
  ScrnObj := ScrnClass.Create(Self);  // Exception here calls the destructor
  try
    ScrnObj.Execute; // Exception here means you need to free manually      
  finally
    FreeAndNil(ScrnObj); // Be free!
  end;
end; 
```

我删除了原始函数返回的结果，因为它永远不会是假的，只能是“未分配”（异常）或真。毕竟，在将结果分配给 false 之前，您可能会遇到异常。;)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T15:02:04.337

关于 Create() 引发异常时内存泄漏的问题：您应该自己尝试一下。我刚刚在 Delphi 2007 上做过，你的代码 FastMM4 显示了一个错误对话框，关于尝试在已释放的对象上调用虚拟方法，即 Destroy()。所以 Create 中的异常已经导致析构函数被调用，内存被释放，所以你的代码实际上是错误的。坚持[Gamecat 答案](https://stackoverflow.com/questions/465492/constructing-an-object-from-a-class-reference#465521)中使用的成语，一切都应该有效。

**编辑：**

我刚刚在Delphi 4上试过，行为是一样的。测试代码：

```
type
  TCrashComp = class(TComponent)
  public
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;
  end;

constructor TCrashComp.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  raise Exception.Create('foo');
end;

destructor TCrashComp.Destroy;
begin
  Beep;
  inherited Destroy;
end;

procedure TForm1.Button1Click(Sender: TObject);
var
  C: TComponent;
begin
  C := TComponent(TCrashComp.NewInstance);
  try
    C.Create(nil);
    C.Tag := 42;
  finally
    C.Free;
  end;
end; 
```

使用 FastMM4，finally 块中的 Free 会给出相同的错误，因为 C 已经被释放。但是，在应用程序关闭时，异常和异常字符串会报告为内存泄漏。然而，这不是代码的问题，而是运行时的问题。

# cocoa-touch - 如何确定 CLLocationManager 返回的位置信息是否有效？

> ID：465494
> 
> 赞同：1
> 
> 时间：2009-01-21T14:23:33.213
> 
> 标签：cocoa-touch, geolocation, core-location

如何确定 CLLocationManager 返回的位置信息是否有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T17:20:39.360

你不能绝对确定。你会得到手机关于它在哪里的最佳信息，你可以相信与否，但你不能轻易地验证那个位置。

可能对某些人有所帮助的一件事是检查您获得的位置的时间戳。Core Location 会缓存数据，你得到的第一个结果可能是一个非常古老的读数。如果手机完全移动，则可能不准确。另一方面，它可能仍然是正确的，在新的结果出现之前你真的不能确定。然而，在你的应用程序启动之前从时间戳所在的核心位置丢弃任何数据通常很有用——它可能是好的数据，但很有可能不是。以后的读数将是新的，并且与手机可以使它们一样值得信赖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T00:39:58.320

要查找的两件事，时间戳和 hdop（水平精度）。第一个会告诉你读数的时间，第二个会告诉你读数的错误程度。例如，hdop 为 1000 会告诉您测量结果精确到 1000 米以内。显然，hdop 越低越好。

它们都在您获得的核心位置更新中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T14:41:14.847

另外，如果水平精度为负，则经纬度无效。

# php - SERVER_ADDR 未定义索引

> ID：465504
> 
> 赞同：3
> 
> 时间：2009-01-21T14:26:10.073
> 
> 标签：php

我在我的配置页面上得到一个未定义的索引，它显示：

> **注意**：未定义的索引：第**3**行**inc/config .inc.php中的 SERVER_ADDR**

 **关于如何解决这个问题的任何想法？我知道它的警告，但仍然想了解它。我正在使用它来检查地址是使用我的本地还是远程配置设置。

我在这种情况下使用它：

```
if ($_SERVER['SERVER_ADDR'] == '127.0.0.1' || $_SERVER['SERVER_NAME'] == 'localhost') {        

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T14:29:19.893

你试过[`getenv`](http://docs.php.net/manual/en/function.getenv.php)吗？

```
getenv('SERVER_ADDR') 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-05T20:18:19.727

接受的答案是正确的，但请注意，在 Windows IIS 7（及以上，据我所知）上，您必须使用：

```
$_SERVER['LOCAL_ADDR'] 
```

代替

```
$_SERVER['SERVER_ADDR'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T14:31:58.873

如果您还没有这样做，请确保您正在使用 $_SERVER 数组访问 SERVER_ADDR 以获取 SERVER_ADDR 的值，这是该数组的一个元素。

```
$_SERVER['SERVER_ADDR']; 
```

如果这不起作用，则可能意味着您的服务器未提供该信息。

来自[PHP.net](http://ca.php.net/manual/en/reserved.variables.server.php "PHP.net")：

> 无法保证每个 Web 服务器都会提供其中任何一个；服务器可能会省略一些，或提供此处未列出的其他内容。

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T14:31:09.140

您似乎正在寻找`$_SERVER["SERVER_ADDR"]`未在此处定义的 IIS。

试试`$_SERVER['HTTP_HOST']`吧，只要你强制，它就会一直设置`HTTP 1.1`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-07T16:39:30.830

这个问题非常古老，但这是另一个例子。有时本地主机 IP 只是 ::1

```
if($_SERVER['REMOTE_ADDR'] === "127.0.0.1"  || $_SERVER['REMOTE_ADDR'] === "::1")
{
     echo 'I am using localhost enviroment';
} 
```

# merge - 添加 diff 的两边以合并

> ID：465507
> 
> 赞同：1
> 
> 时间：2009-01-21T14:27:35.997
> 
> 标签：merge, diff

我有两个 XML 文件。它们是相似的，但是有两个节点，其中一个文件只有一个。我想将两组这样的文档合并到一个文档中，首先取 A 面的节点，然后是 B 面的节点。

我不是 diff 工具的经验丰富的用户，我下载了 KDiff3 以从某个地方开始。任何人都可以让我走上正确的道路吗？

**--EDIT--**
[查找差异工具](https://stackoverflow.com/search?q=diff+tool)是我可以自己管理的事情。
但是如何制作这些工具中的一个（不管是哪个）通过首先放入 file1 中的部分然后从 file2 中自动进行合并是我正在寻找的。这是一个相当大量的文件，所以我最好不要对合并过程进行任何干预。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T14:33:15.517

[差异合并](http://www.sourcegear.com/diffmerge/)。它是免费的，适用于 Windows、Mac OS X 和 Unix。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T15:17:05.990

这听起来更像是一个软件来创建，然后是软件来查找。

如果您自己滚动，您可以添加额外的检查以确保两个 XML 都有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T19:29:30.033

This might be very problematic to do with a standard diff tool if the xml "nodes" are in any way similar. For example:

file1:

```
1 <node id="1" />
2 <node id="2a">
3   <content item="1"/>
4   <content item="2a"/>
5 </node>
6 <node id="3" /> 
```

file2:

```
1 <node id="1" />
2 <node id="2b">
3   <content item="1"/>
4   <content item="2b"/>
5 </node>
6 <node id="3" /> 
```

A standard diff tool is going to highlight lines 2 and 4 as needing to be merged, but even if you automatically add the lines from file2, you'll end up with an invalid xml file:

```
1 <node id="1" />
2 <node id="2a">
2 <node id="2b">
3   <content item="1"/>
4   <content item="2a"/>
4   <content item="2b"/>
5 </node>
6 <node id="3" /> 
```

You really need a diff/merge tool that is xml-aware. I found a description of one called [XmlMerge](http://www.javaworld.com/javaworld/jw-07-2007/jw-07-xmlmerge.html), along with an example that shows it doing exactly what you're asking for. It's part of [EL4J](http://sourceforge.net/project/showfiles.php?group_id=147215).

There is a dormant effort called [XUpdate](http://www.oreillynet.com/onlamp/blog/2005/04/xupdate_update.html) that has a fair amount of tools around it (both for generating the XUpdate diffs and for applying them). There are also some [.net classes](http://msdn.microsoft.com/en-us/library/aa302294.aspx) that use a different foundation. You will need to do some scripting to use either of these systems I think.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T14:36:01.910

KDiff3 可以将两个输入版本都放入输出文件。有标记为 A 和 B 的按钮。您可以单击其中一个将一个版本添加到合并结果中。或者您可以同时单击它们，这两个版本都将包含在内。单击这些按钮的顺序将影响插入行的顺序。

它还可以合并整个目录。

唯一的问题似乎是自动化。

KDiff3 的键盘快捷键可以以相当丰富的方式进行配置，所以我会尝试查看这里，然后可能会使用一些键盘脚本应用程序。

可能还有其他更简单的方法:-)

# .net - 你会推荐什么支持 Linq/Iqueryable 的 OR/M 工具？

> ID：465515
> 
> 赞同：-1
> 
> 时间：2009-01-21T14:29:21.220
> 
> 标签：.net, linq, orm

我问[了这个关于](https://stackoverflow.com/questions/460882/linq-to-sql-and-the-repository-pattern)使用 Linq-2-Sql 和[Rob Conery](http://blog.wekeroad.com/)在他的[MVC Storefront](http://www.codeplex.com/mvcsamples/Release/ProjectReleases.aspx?ReleaseId=18861)应用程序中使用存储库的问题，并得到了Matt [Briggs的](https://stackoverflow.com/users/10771/matt-briggs)[出色回应](https://stackoverflow.com/questions/460882/linq-to-sql-and-the-repository-pattern#463415)：

> L2S 用于生成 DAL，但关于 DAL 唯一应该知道的是存储库，因此对他的域对象进行了翻译。
> 
> 我认为 L2S（和 Robs 开源 DAL、SubSonic）是很棒的项目，但更多的是为较小的 2 层应用程序设计的，其中存储库模式之类的东西已经过时了。店面也很好地说明了为什么 NHibernate 的额外复杂性很重要，他可以通过使用专门用于处理这种场景的东西来为自己节省大量代码，而不是手动完成。

所以我的问题是，有哪些 OR/M 工具更健壮、更稳定并支持 Linq IQueryable 功能？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T23:28:25.113

我已经在工作中使用 LLBLGen Pro 几年了。他们很快就添加了 LINQ 支持。该工具的作者 Frans Bourma 在他的博客上有一组不错的文章，介绍了将 Linq 与 LLBLGen 结合使用。该系列从这里开始：[http ://weblogs.asp.net/fbouma/archive/2007/09/11/developing-linq-to-llblgen-pro-day-0.aspx](http://weblogs.asp.net/fbouma/archive/2007/09/11/developing-linq-to-llblgen-pro-day-0.aspx)

您可以轻松地创建由代表数据库的实体对象组成的类型化通用列表，并在它们上使用所有您喜欢的 Linq 函数。

如果您在使用它时遇到任何问题，Frans 和他的论坛成员已经回答了我向他们提出的所有问题。他甚至接受新功能请求。

[您可以在http://www.llblgen.com/](http://www.llblgen.com/)找到 LLBLGen

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T14:36:04.967

[NHibernate](http://www.hibernate.org/343.html)在 Linq 上看起来很有希望（尽管它不是 100% 完成）

PS：我不推荐这种情况下的 DevExpress XPO ORM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T14:53:07.490

实体框架

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T12:02:50.597

SignumFramework 有[自己的完整 Linq 提供程序](http://www.signumframework.com/DatabaseQuerySelectManyJoin.ashx)，但与 Entity Framework 相反，它从实体（您的类）创建 DB 模式，而不是相反。

# c++ - 重载增量的返回值

> ID：465517
> 
> 赞同：3
> 
> 时间：2009-01-21T14:30:14.760
> 
> 标签：c++, operator-overloading

在他的 The C++ Programming Language Stroustrup 中给出了 inc/dec 重载的以下示例：

```
class Ptr_to_T {
    T* p;
    T* array ;
    int size;
public:
    Ptr_to_T(T* p, T* v, int s); // bind to array v of size s, initial value p
    Ptr_to_T(T* p); // bind to single object, initial value p
    Ptr_to_T& operator++(); // prefix
    Ptr_to_T operator++(int); // postfix
    Ptr_to_T& operator--(); // prefix
    Ptr_to_T operator--(int); // postfix
    T&operator*() ; // prefix
} 
```

为什么前缀运算符按引用返回，而后缀运算符按值返回？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-21T14:34:19.650

后缀运算符在值递增之前返回值的副本，因此它几乎必须返回一个临时值。前缀运算符确实返回对象的当前值，因此它可以返回对其当前值的引用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-21T14:48:02.057

为了更好地理解，您必须想象（或查看）这些运算符是如何实现的。通常，前缀 operator++ 或多或少会这样写：

```
MyType& operator++()
{
    // do the incrementation
    return *this;
} 
```

由于`this`已“就地”修改，我们可以返回对实例的引用以避免无用的复制。

现在，这是后缀运算符++的代码：

```
MyType operator++(int)
{
    MyType tmp(*this); // create a copy of 'this'
    ++(*this); // use the prefix operator to perform the increment
    return tmp; // return the temporary
} 
```

由于后缀运算符返回一个临时值，它必须按值返回它（否则，您将获得一个悬空引用）。

[C++ Faq Lite](http://www.parashift.com/c++-faq-lite/operator-overloading.html#faq-13.14)也有一个关于这个主题的段落。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T15:07:47.727

假设我使用重载的预增量来增加一个私有成员。返回对私有成员的引用不会将 ++private_var 表达式转换为左值，从而可以直接修改私有成员吗？

# asp.net - 为会话值的键名创建一个枚举是个好主意吗？

> ID：465522
> 
> 赞同：9
> 
> 时间：2009-01-21T14:31:08.407
> 
> 标签：asp.net, vb.net, session-state, session-variables

而不是做

```
 session("myvar1") = something
 session("myvar2") = something
 session("myvar3") = something
 session("myvar4") = something 
```

是在做

```
enum sessionVar
   myvar1
   myvar2
   myvar3
   myvar4
end enum

 session(sessionVar.myvar1.tostring) = something
 session(sessionVar.myvar2.tostring) = something
 session(sessionVar.myvar3.tostring) = something
 session(sessionVar.myvar4.tostring) = something 
```

会更好？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-21T14:46:00.750

我没有使用会话密钥的常量，而是使用我自己的类型安全会话对象，它看起来像这样（抱歉，这是在 C# 中，请参阅下面的 VB 版本）：

```
public class MySession
{
  // Private constructor (use MySession.Current to access the current instance).
  private MySession() {}

  // Gets the current session.
  public static MySession Current
  {
    get
    {
      MySession session = HttpContext.Current.Session["__MySession__"] as MySession;
      if (session == null)
      {
        session = new MySession();
        HttpContext.Current.Session["__MySession__"] = session;
      }
      return session;
    }
  }

  // My session data goes here:
  public string MyString { get; set; };
  public bool MyFlag { get; set; };
  public int MyNumber { get; set; };
} 
```

每当我需要从会话中读取/写入某些内容时，我可以像这样使用我的类型安全会话对象：

```
string s = MySession.Current.MyString;
s = "new value";
MySession.Current.MyString = s; 
```

该解决方案具有几个优点：

*   我有一个类型安全的会话（不再有类型转换）
*   我可以记录所有基于会话的数据（通过评论 MySession 中的公共属性）
*   向会话中添加新元素时，我不必搜索解决方案来检查是否已在其他地方使用相同的会话密钥。

**更新：** 这是一个 VB 版本（从 C# 版本自动转换）。对不起，但我不懂 VB，所以我不知道如何在 VB 中编写属性：

```
Public Class MySession
    ' Private constructor (use MySession.Current to access the current instance).
    Private Sub New()
    End Sub

    ' Gets the current session.
    Public Shared ReadOnly Property Current() As MySession
        Get
            Dim session As MySession = TryCast(HttpContext.Current.Session("__MySession__"), MySession)
            If session = Nothing Then
                session = New MySession()
                HttpContext.Current.Session("__MySession__") = session
            End If
            Return session
        End Get
    End Property

    ' My session data goes here:
    Public MyString As String
    Public MyFlag As Boolean
    Public MyNumber As Integer
End Class 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-21T14:32:50.887

仅当这些值相关时。否则使用普通的旧常量。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-21T14:42:21.520

怎么样：-

```
public static class  SessionVar
{
  public static readonly string myVar1 = "myVar1";
  public static readonly string myVar2 = "myVar2";
  public static readonly string myVar3 = "myVar3";
  public static readonly string myVar4 = "myVar4";
} 
```

这允许您使用：-

```
session(SessionVar.myVar1) = something; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T14:47:30.403

对于删除所有字符串键引用的简单事情，我将使用在应用程序范围内可见的全局静态/共享常量。

否则，会话变量的强类型简单包装器是一个更好的选择，并且考虑到您获得智能感知和对象浏览器的兼容性，它对 OOP 更加友好。

我可以看到枚举具有很大价值的唯一方法是用于索引数组或类似列表。但即便如此，您也必须将枚举转换为 int。

因此，您可以拥有一个在应用程序启动时加载的数组，其中包含所有会话变量键，然后是索引的枚举。但是，鉴于 Session 对象是从 IEnumerable 派生的 HttpSessionState 派生的，如果需要，您应该能够对会话变量执行 foreach 循环。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T14:47:58.810

我已经使用这样的类来制作一个类型化的会话/缓存包装器。您可能需要向 get/set 添加额外的代码，但我会留给您。

```
internal class SessionHelper
{
    private const string  myVar1Key = "myvar1";

    public static int MyVar1
    {
        get
        {
            return (int)System.Web.HttpContext.Current.Session[myVar1Key];
        }
        set
        {
            System.Web.HttpContext.Current.Session[myVar1Key] = value;
        }
    }
} 
```

对不起C#....

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-14T00:39:34.777

我意识到这个问题是不久前提出的，并且已经选择了一个“答案”。但我只是遇到了它。马丁的回答很好。但是，为了帮助将来遇到此问题的任何人，如果您真的想要一种巧妙的方式来处理 Session，请阅读这篇[文章](http://blog.theobjectguy.com/2009/12/session-with-style.html)。我不认为你会发现任何事情更容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-03-19T14:07:24.927

我想出了一个解决方案，通过保持 Session 变量的结构完整，避免了发布的其他解决方案的某些缺点。它只是获取和设置 Session 变量的类型安全快捷方式。

它是 C#，但我最后发布了一些自动生成的 VB.NET。

我见过的最佳解决方案（接受的答案和 TheObjectGuy 的答案）需要一个自定义类，该类存储在 Session 变量中，然后从 Session 中拉出以使用 MySessionClass.Current.MyProperty 之类的东西访问其属性。

这样做的问题是，如果您当前正在使用（或将来可能使用）InProc 会话状态模式以外的其他东西（请参阅[https://msdn.microsoft.com/en-us/library/ms178586%28v= vs.140%29.aspx](https://msdn.microsoft.com/en-us/library/ms178586%28v=vs.140%29.aspx)），整个类都必须通过序列化来访问单个属性。

此外，如果您需要，这意味着您会丢失实际 Session 提供的 IEnumerable 和 ICollection 实现。使用我的解决方案，如果您需要此功能，您可以简单地访问实际的 Session。

您可以轻松使用这些会话变量，并且它们是类型安全的。它可以与 Session["MyProperty"] 之类的语句一起使用，这将允许一次转换现有项目一个引用。所以：

```
int myInt = (int)Session["MyInt"];
Session["MyInt"] = 3; 
```

变成：

```
int myInt = SessionVars.MyInt; 
SessionVars.MyInt = 3; 
```

这是实际的课程。CallerMemberName 需要 .NET 4.5，但即使您使用的是旧版本，您仍然可以通过显式传递 propertyName 来管理它。此外，属性的类型必须可以为空，以使其行为与标准 Session["MyProp"] 调用完全相同，因为未设置

```
public static class SessionVars
{
    private static T Get2<T>([System.Runtime.CompilerServices.CallerMemberName] string propertyName = "") 
    {
        if (HttpContext.Current.Session[propertyName] == null)
        {
            return default(T);
        }

        return (T)HttpContext.Current.Session[propertyName];
    }

    private static void Set2<T>(T value, [System.Runtime.CompilerServices.CallerMemberName] string propertyName = "")
    {
        HttpContext.Current.Session[propertyName] = value;
    }

    public static int MyInt { get { return Get2<int>(); } set { Set2<int>(value); } }
    public static bool MyBool { get { return Get2<bool>(); } set { Set2<bool>(value); } }
    public static string MyString { get { return Get2<string>(); } set { Set2<string>(value); } }
} 
```

我什至写了一个代码片段来方便添加这些属性：

```
<?xml version="1.0" encoding="utf-8"?>
<CodeSnippet Format="1.0.0" xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
  <Header>
    <Title>SessionVars Property</Title>
    <Author>kevinpo</Author>
    <Shortcut>sv</Shortcut>
    <Description>Adds a property for use in a SessionVars class</Description>
    <SnippetTypes>
      <SnippetType>Expansion</SnippetType>
    </SnippetTypes>
  </Header>
  <Snippet>
    <Declarations>
      <Literal>
        <ID>type</ID>
        <Default>int</Default>
      </Literal>
      <Literal>
        <ID>property</ID>
        <Default>PropertyName</Default>
      </Literal>
    </Declarations>
    <Code Language="CSharp">
      <![CDATA[public static $type$ $property$ { get { return Get2<$type$>(); } set { Set2<$type$>(value); } }]]>
    </Code>
  </Snippet>
</CodeSnippet> 
```

我是 C# 人，所以这个 VB.NET 只是由[http://converter.telerik.com/](http://converter.telerik.com/)自动转换的：

```
Public NotInheritable Class SessionVars
    Private Sub New()
    End Sub
    Private Shared Function Get2(Of T)(<System.Runtime.CompilerServices.CallerMemberName> Optional propertyName As String = "") As T
        If HttpContext.Current.Session(propertyName) Is Nothing Then
            Return Nothing
        End If
        Return DirectCast(HttpContext.Current.Session(propertyName), T)
    End Function

    Private Shared Sub Set2(Of T)(value As T, <System.Runtime.CompilerServices.CallerMemberName> Optional propertyName As String = "")
        HttpContext.Current.Session(propertyName) = value
    End Sub

    Public Shared Property MyInt() As Integer
        Get
            Return Get2(Of Integer)()
        End Get
        Set
            Set2(Of Integer)(value)
        End Set
    End Property
    Public Shared Property MyBool() As Boolean
        Get
            Return Get2(Of Boolean)()
        End Get
        Set
            Set2(Of Boolean)(value)
        End Set
    End Property
    Public Shared Property MyString() As String
        Get
            Return Get2(Of String)()
        End Get
        Set
            Set2(Of String)(value)
        End Set
    End Property
End Class

'=======================================================
'Service provided by Telerik (www.telerik.com)
'Conversion powered by NRefactory.
'Twitter: @telerik
'Facebook: facebook.com/telerik
'======================================================= 
```

# javascript - 行号和复制/粘贴 (HTML/CSS)

> ID：465526
> 
> 赞同：4
> 
> 时间：2009-01-21T14:32:03.023
> 
> 标签：javascript, html, css

我可以使用什么 JS/CSS 技巧来防止在有序列表中复制和粘贴数字？

```
<OL>
<LI>A
<LI>B
<LI>C
</OL> 
```

1.  一种
2.  乙
3.  C

如果它不可行，有什么替代方案可用？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T19:43:33.533

复制 OL 的号码是一种浏览器行为。我相信有些浏览器不会，但大多数浏览器会。

页面加载后，您可以使用 JavaScript 重写代码，使其看起来相同但不在下方。这将解决您的复制问题，但会导致其他问题，例如可访问性。

基本上实现它的方法是将Javascript中的代码重写为2列，1列带有编号，1列带有内容。您可以使用像[YUI Grids](http://developer.yahoo.com/yui/grids/)或[Blueprint](http://code.google.com/p/blueprintcss)这样的网格系统来做到这一点。用户将能够选择其中包含内容的第二列，而无需选择第一列。

这样做的问题是它破坏了屏幕阅读器用户的语义标记，他们不再获得有序列表的好处。可能可以在 onmousedown 上执行此操作，以便仅当用户尝试选择您重写它的文本时。并不是说我已经测试过这个想法。

免责声明：我为雅虎工作！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T01:44:32.273

您无法真正控制浏览器/操作系统的剪贴板行为。您可以做的是提供“复制”链接，并使用 jquery 和[jquery.copy](http://plugins.jquery.com/project/copy)插件。

```
<html>
<head>
<script src="jquery-1.2.6.js" type="text/javascript"></script>
<script src="jquery.copy.js" type="text/javascript"></script>
</head>
<body>
<a href="#" onclick="$.copy($('#theList').find('li').text())">Copy</a>
<OL id="theList">
<LI>A
<LI>B
<LI>C
</OL>
</body>
</html> 
```

免责声明：以上示例可能不是 100% 的功能。;-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T14:40:16.173

我的猜测是它依赖于浏览器。我尝试使用 IE 7、Firefox 3 和 Chrome，但它们都没有复制数字（Chrome“似乎”在选择中复制它们，但粘贴后它们不存在）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T14:41:10.120

对我来说，即使没有选择它们，我也会复制数字（firefox 3）或“#”字符（firefox 2）。在 ie6 上我只是得到了选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-30T01:15:44.470

您可以使用图像来显示数字，然后它们就不会被复制。CSS 可用于偏移数字和文本，使其看起来像一个普通列表。

CSS：

```
OL>li {  list-style-type: none; padding-left: 10px }
OL>li .one { background-image: url('images/one.png') no-repeat left }
OL>li .two { background-image: url('images/two.png') no-repeat left } 
```

所以，在那之后你只需要弄清楚把图像放在哪里。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-31T14:32:55.560

[使用http://bugzilla.gnome.org/attachment.cgi?id=127131](http://bugzilla.gnome.org/attachment.cgi?id=127131)中的表格怎么样

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T19:49:31.007

**编辑** 抱歉忘记添加 javascript 以禁用对数字的取消选择...现在查看代码。

检查此项以禁用跨浏览器选择：[http ://answers.yahoo.com/question/index?qid=20090107041047AAvbI1u](http://answers.yahoo.com/question/index?qid=20090107041047AAvbI1u)

如果 Javascript 是一个选项，您可以自己添加数字：

```
var ol = document.getElementsByTagName("ol")[0];
for(var i=0; i<ol.childNodes.length; i++) {
    ol.childNodes[i].innerHTML = "<span style='MozUserSelect:none;'>"+i+".</span> "+ol.childNodes[i].innerHTML;
} 
```

或类似的东西。

然后当然摆脱CSS编号。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T20:48:49.703

试一试——它写得很快，但可以作为一个很好的开始。您需要做的一些事情是用新元素替换旧列表，而不是像我目前正在做的那样将新元素直接添加到正文中。这很容易使用 (selector).replaceWith(newElement) jQuery 功能。

```
<style type="text/css">
    div.newList {
        position:relative;
        width:300px;
        font-family:verdana;
        font-size:12px;
        line-height:150%;
    }
        div.newList div.column {
            padding-left:30px;
        }
            div.column p {
                margin:0;
                padding:0;
            }
        div.numbers {
            position:absolute;
            top:0;
            left:0;
            width:20px;
        }
            div.numbers p {
                text-align:right;
                padding:0;
                margin:0;
            }
</style>
<script type="text/javascript">

    $(document).ready(function(){

        var newDiv = document.createElement("div");
        $("body").append(newDiv);
        $(newDiv).addClass("newList").html("<div class='column'></div><div class='numbers'></div>");

        $("ol.alphabet li").each(function(){
            var index = $("ol.alphabet li").index(this);
            var content = $(this).text();
            $("div.column").append("<p>"+content+"</p>");
            $("div.numbers").append("<p>"+(index+1)+".</p>");
        });

        $("div.column p").each(function(){
            var index = $("div.column p").index(this);
            var height = $(this).height();
            $("div.numbers p:eq("+index+")").height(height);
        });

    });

</script>
<body>

    <ol class="alphabet">
        <li>This is a sample row that will teach me how to get all of the things lined up.</li>
        <li>Too Short.</li>
        <li>C</li>
    </ol>

</body> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-29T22:09:34.407

我认为答案更多地与您要粘贴到的应用程序有关，而不是浏览器的复制过程，这实际上是浏览器做的正确事情吗？

希望您提供语义 HTML，因此不会复制 OL 是理想的结果？如果用户正在复制和粘贴一组包含链接或图像的段落或文本怎么办？您不会怀疑用户希望能够复制段落并将其粘贴到语义布局完好无损吗？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-04T15:30:39.187

**替代品**

```
<ul>
  <li>Dotted list item</li>
</ul> 
```

打印：**列表项*

```
<ol>
  <li>Numbered list item</li>
</ol> 
```

打印：*1\. 列表项*

```
<dl>
<dt>Category</dt>
<dd>List Item</dd>
<dt>Category</dt>
<dd>List Item</dd>
</dl> 
```

只给“列表项”缩进。

**解决方案**

所以，为了做到这一点没有 JS 魔法，同时打破一些语义规律，就是在 dl 列表中使用一个只有 dt 的。

```
<dl>
  <dt>Item</dt>
  <dt>Item</dt>
</dl> 
```

希望这可以帮助 ：-）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-08-30T02:44:22.147

`OL`&的解决方案`LI`是最语义化的，因为它提供了有关行号的信息，并且每一行都是一个单独的块，所以你可以随意设置它的样式。这些数字在没有 CSS 和 JavaScript 的文本浏览器中仍然可见。屏幕阅读器的用户可以从一行跳到另一行，跳过行，他们总是知道他们在哪一行，有多少行。他们甚至可以跳过整个列表。

选择的问题实际上并不在 HTML/CSS/JS 域中，因为您不能代替您的用户决定他想对复制的文本做什么。他可能想在*有*或*没有*这些行号的情况下同样好地复制它。最好存储尽可能多的语义信息并让用户选择他想要使用的语义信息，而不是只给他没有*任何*选项的普通数据。

但是，如果您想为他提供一种简单的方法来复制纯文本而不需要任何额外的标记或行号，**请给他一个指向纯文本源文件的链接**。然后，他将能够单击它并在单独的页面中显示纯文本源文件。他可以从那里复制粘贴它而无需任何行号等，甚至可以从他自己的文档中链接到纯文本源或从浏览器的地址栏中复制粘贴 URL 以将其发送给他的朋友程序员 ;-) 你甚至可以列出您网站上某处的所有纯文本源文件。

`OL`我在&中使用这种技术时遇到的唯一问题`LI`是标签不能交叉。如果某个片段（例如，块注释）从一行开始并继续到其他行，您必须正确关闭所有标记并在下一行重新打开它，并像这样对每一行执行此操作。

嗯...如果在将来的某个 HTML 版本中可以自动编号任何容器中的行（例如`PRE`等`DIV`）并且它们将出现在没有样式和 JavaScript 的 HTML 中（尽管您可以设置这些行号的样式并分开使用一些伪类的行）......但是现在，吃你所拥有的;-J

# sql-server - 从历史表中获取关联行

> ID：465531
> 
> 赞同：0
> 
> 时间：2009-01-21T14:33:33.303
> 
> 标签：sql-server

如果您有一个包含另一个表的历史记录（更新、删除）的表，如果它发生在删除操作之后，您将如何提取关联的更新行？

表具有与数据 ID int 无关的以下列
， -- Identity
OP varchar -- 删除或更新操作，编码为 'D' 或 'U'
Removed_Date -- 从 'Live' 表中删除行的日期

我试过这样的
选择 *
from historytable as table1
join historytable as table2 on table1.Removed_Date like table2.Removed_Date

这会导致表中的一行出现多行（十行或更多）重复项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T14:39:37.923

如果您绝对确定删除和相应更新的时间戳相同，您可以这样做：

```
select *
from historytable as table1
inner join historytable as table2 on table1.Removed_Date = table2.Removed_Date 
where table1.OP = 'D' 
and table2.op = 'U' 
```

如果时间戳不相同，并且您没有其他方法可以确定哪个 UPDATE 跟随哪个 DELETE，那么您所能做的就是在 DELETE 之后检索第一个 UPDATE。

```
select t1.*, 
  (select top 1 id 
  from historytable t2 
  where t2.Removed_Date > t1.Removed_Date
  and t2.code = 'U')
from historytable t1 where code = 'D' 
```

-Edoode

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T17:26:58.880

这是我最终在 Perl 中所做的事情：

while (<>) {
@cols = split(/,/);
$removeby = $cols[3];
if ($cols[1] eq "D" and $removeby!~/ottr|hksys/) {
if ($hold) {
@oldCols = split(/,/,$hold);
$oldRemoveBy = $oldCols[3];
if ($removeby eq $oldRemoveBy) {
print $hold;
打印;
}
$hold = "";
}
$hold = "";
} 其他 {
$hold = $_;
}
}

这不是一个万无一失的解决方案，但它似乎有效。

# c# - 如何显示 IPAddress 的整数值

> ID：465543
> 
> 赞同：0
> 
> 时间：2009-01-21T14:36:17.027
> 
> 标签：c#, vb.net, ip-address

我正在查看 System.Net 命名空间，它有一个您可以使用的 IPAddress 实例。这有一个 Parse 方法，您可以使用该方法将字符串解析为 IPInstance，然后使用 Address 属性为您提供 long 值。

然而...

返回的数字不是真正的转换。

例如对于 IP 58.0.0.0 ， System.Net 命名空间给了我一个 58 的值......事实上，整数值应该是 973078528

有人可以告诉我正确的代码来转换它吗？

公式应该是..（对于 ip 192.1.20.10）。

192 * (256*256*256) + 1 * (256*256) + 20 * (256) + 10

这个公式正确的原因是它返回的数字可以在 >= 和 <= 查询中用于确定某个范围内的 IP 地址。

（IPAddress 实例的）地址属性不计算/返回此值。任何知道为什么地址属性不返回我认为正确答案的人的奖励点......

其他链接中的其他示例也不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T14:38:58.737

请参阅[如何在 C# 中将 IPv4 地址转换为整数？](https://stackoverflow.com/questions/461742/how-to-convert-an-ip-address-into-an-integer-in-c)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T15:10:07.457

你所看到的似乎是一个字节序问题。

作为一个通用函数，如果您的 IP 地址是`A.B.C.D`您所追求的值，则为：

```
A << 24 +    (= A * 16777216)
B << 16 +    (= B *    65536)
C <<  8 +    (= C *      256)
D 
```

在小端机器上，当四字节数组 ABCD 转换为整数时，它会以 A 作为最低有效字节而不是最高有效字节。

我不编写 vb.net 代码，但敲出一个可以做到这一点的函数应该很简单。

不过，您首先需要确保 A - D 都在 0 .. 255 范围内！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T14:39:39.217

[如何在 C# 中将 IPv4 地址转换为整数？](https://stackoverflow.com/questions/461742/how-to-convert-an-ip-address-into-a-integer-in-c)

示例代码列在选择的答案中

e; f, b

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T16:56:11.330

这可能有效，将尝试并查看。

```
public double IPAddressToNumber(string IPaddress)
    {
        int i;
        string [] arrDec;
        double num = 0;
        if (IPaddress == "")
        {
            return 0;
        }
        else
        {
            arrDec = IPaddress.Split('.');
            for(i = arrDec.Length - 1; i >= 0 ; i = i -1)
                {
                    num += ((int.Parse(arrDec[i])%256) * Math.Pow(256 ,(3 - i )));
                }
            return num;
        }
    } 
```

# c# - 如何在某个控件上获取鼠标位置

> ID：465545
> 
> 赞同：7
> 
> 时间：2009-01-21T14:36:50.207
> 
> 标签：c#, winforms, mouse, cursor-position

Windows 窗体
我在布局面板上使用 DragOver 事件，并且 DragEventArgs 返回鼠标相对于屏幕的 X/Y 坐标。我知道有一个函数可以将它转换为鼠标在控件上的位置，但我很难找到它。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-21T14:38:25.773

尝试[Control.PointToClient](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.pointtoclient.aspx)和[Control.PointToScreen](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.pointtoscreen.aspx)。

# c# - 使用 ManagementClasses 添加 ScriptMap 对象

> ID：465548
> 
> 赞同：2
> 
> 时间：2009-01-21T14:37:45.307
> 
> 标签：c#, wmi

我已经问过一个相关的问题，但遗憾的是答案虽然正确，但并没有真正解决我的问题。

我正在使用 ManagementClass/ManagementObject WMI API（因为它在处理远程管理方面比 DirectoryEntry API 更好）。我想从

使用通用字符串格式解决方案似乎适用于 VBS，但不适用于 ManagementClass API。所以，我一直在尝试编写一些可以创建正确的脚本映射对象数组的东西，例如

```
 foreach (var extension in extensions) {
        var scriptMap = scriptMapClass.CreateInstance();
        SetWmiProperty(scriptMap, "ScriptMap.Extensions", "." + extension); 
```

不幸的是，似乎不可能实现函数 SetWmiProperty。如果我尝试以下

```
wmiObject.Properties.Add(propertyName, CimType.SInt32); 
```

我得到“由于对象的当前状态，操作无效。”。另一方面，如果我只是尝试设置属性，我会被告知该属性不存在。scriptMap 类具有路径“ScriptMap”，这是现有对象显示的内容。

有没有人有任何使用 ManagementClass API 操作 ScriptMaps 的工作代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T15:14:26.477

Richard Berg 概述的技术的 AC# 示例。

```
static void ConfigureAspNet(ManagementObject virtualDirectory, string version, string windowsLocation, IEnumerable<string> extensions)
    {
        var scriptMaps = virtualDirectory.GetPropertyValue("ScriptMaps");
        var templateObject = ((ManagementBaseObject[])scriptMaps)[0];
        List<ManagementBaseObject> result = new List<ManagementBaseObject>();
        foreach (var extension in extensions) {
            var scriptMap = (ManagementBaseObject) templateObject.Clone();
            result.Add(scriptMap);
            if (extension == "*")
            {
                scriptMap.SetPropertyValue("Flags", 0);
                scriptMap.SetPropertyValue("Extensions", "*");
            } else
            {
                scriptMap.SetPropertyValue("Flags", 5);
                scriptMap.SetPropertyValue("Extensions", "." + extension);
            }
            scriptMap.SetPropertyValue("IncludedVerbs", "GET,HEAD,POST,DEBUG");
            scriptMap.SetPropertyValue("ScriptProcessor",
                string.Format(@"{0}\microsoft.net\framework\{1}\aspnet_isapi.dll", windowsLocation, version));
        }
        virtualDirectory.SetPropertyValue("ScriptMaps", result.ToArray());
        virtualDirectory.Put();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T23:52:10.100

我发现从头开始创建 WMI 对象非常困难。更容易 Clone() 您从系统中查询的现有对象，然后对其进行修改。这是我最近编写的用于处理 ScriptMaps 的函数。它在 Powershell 中，而不是 C# 中，但想法是一样的：

```
function Add-AspNetExtension
{
    [CmdletBinding()]
    param (
        [Parameter(Position=0, Mandatory=$true)]
        [psobject] $site  # IIsWebServer custom object created with Get-IIsWeb
        [Parameter(ValueFromPipeline=$true, Mandatory=$true)]
        [string] $extension
    )

    begin 
    {
        # fetch current mappings
        # without the explicit type, PS will convert it to an Object[] when you use the += operator
        [system.management.managementbaseobject[]] $maps = $site.Settings.ScriptMaps

        # whatever the mapping is for .aspx will be our template for mapping other things to ASP.NET
        $template = $maps | ? { $_.Extensions -eq ".aspx" }
    }

    process
    {
        $newMapping = $template.Clone()
        $newMapping.Extensions = $extension
        $maps += newMapping
    }

    end
    {
        $site.Settings.ScriptMaps = $maps
    }
} 
```

# php - PHP 列出目录和文件

> ID：465549
> 
> 赞同：1
> 
> 时间：2009-01-21T14:37:45.650
> 
> 标签：php, directory

拥有一个页面的最简单方法是什么，它将显示用户可以单击以打开的目录列表，其中将有更多目录或最终要下载的文件，并且所有这些都发生在同一页面上？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T14:40:50.167

从文件夹中删除 index.php 并允许在 htaccess 中浏览该文件夹和子文件夹的目录。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-22T02:06:02.140

对于一些基本的东西，您最好将“选项+索引”添加到该文件夹​​的 .htaccess 中。但是，如果您想要更复杂的东西并且在 PHP5 上运行，您可以使用[Directory Iterator](http://us3.php.net/manual/en/class.directoryiterator.php)来完成此操作。要考虑的最重要的事情是安全性。

您**不想**只是将目录路径转储到 $_REQUEST 中，然后盲目地让用户加载该目录。你需要确保你有一些安全措施来防止，例如，有人只是更改请求并要求查看整个 /var 目录。最好的方法是只传递相对于 docroot 的当前文件/文件夹，并确保删除任何 .. 所以有些人不能只说 ../../var 或类似的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T14:44:17.010

把它放在 .htaccess 文件中：

```
Options +Indexes 
```

# air - 为 Adob e Air 应用程序创建类似 Adob e Kuler 的皮肤

> ID：465564
> 
> 赞同：1
> 
> 时间：2009-01-21T14:41:14.580
> 
> 标签：air, adobe, skinning

如何为 Adob​​e Air 1.5 应用程序（如[Adob​​e Kuler](http://kuler.adobe.com/) ）创建皮肤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T11:42:34.197

你可以使用[Degrafa](http://degrafa.org)或者你可以使用 .swf 作为皮肤，使用 .css 或 Adob​​e 扩展来设计[这个网站](http://www.adobe.com/devnet/flex/articles/skins_styles.html)解释了怎么做

让我知道进展如何..再见

# excel - excel中的HTML类型下拉

> ID：465576
> 
> 赞同：0
> 
> 时间：2009-01-21T14:45:09.223
> 
> 标签：excel

有什么方法可以在 excel 中显示一个值而不是文本，例如第一个选项是选项 1，但值是 1

我试图让用户轻松选择一个项目，而不必知道该项目在数据库中的 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T15:05:47.980

是的你可以。

首先将**ListFillRange 属性**设置为多列范围（例如，“A1:B3”）。然后将**ColumnWidths 属性**设置为“50;0”之类的值，这将使第二列不可见。最后，将**BoundColumn 属性**设置为 2。

该列表将显示选项 1、选项 2、选项 3。如果您查询它的值（ComboBox1.Value），它将返回与所选选项（1、2 或 3）关联的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T15:00:52.000

你不能。

但是您可以在数据库中使用您的`Options`as `IDs`，只要它们都不重复（我认为应该是这种情况，否则您的用户将无法区分它们）。

# bytearray - 如何从soapUI响应中提取字节数组？

> ID：465602
> 
> 赞同：2
> 
> 时间：2009-01-21T14:49:44.797
> 
> 标签：bytearray, response, soapui

我正在使用soapUI 测试Web 服务。其中一个响应如下所示：

```
 <S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
   <S:Body>
      <ns2:getInputConfigFilesResponse xmlns:ns2="http://ws.pdb.ericsson.se/">
         <return>UEsDBBQACAAIAO1GNToAAAAAAAAAAAAAAAANAAAAc2NyaXB0cy9lbGxza [...] AATAAAAAAAAAAAAAAAAAAGXAAAbGRhcF9ub2RlX2NvbmZpZ3VyYXRpb24vZ2VuZXJhdGVkX2xkaWZfZmlsZXMvX210YXM0X2N4cDQ0NF9yNF9JbXNtb2JpbGUubGRpZlBLAQIUABQACAAIAO1GNTp8eBuZRAEAABMDAAAmAAAAAAAAAAAAAAAAAKJiAABsZGFwX25vZGVfY29uZmlndXJhdGlvbi9lbGxzaC1jb21tYW5kc1BLBQYAAAAABQAFAIgBAAA6ZAAAAAA=</return>
      </ns2:getInputConfigFilesResponse>
   </S:Body>
</S:Envelope> 
```

响应是一个字节数组，应该代表一个 zip 文件。我该如何验证这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T12:13:40.287

尽管在语义上是正确的，但我相信 Nathan 提出的解决方案有些不完整。

我猜他忘记了在步骤 1 之前对提取的文本进行 Base64 解码。我还将包括一项改进，以便通过使用 3rd 方 ZIP 实用程序验证临时文件而无需人工干预。

这将转化为访问临时 ZIP 文件并检查它是否是有效的 ZIP 文件。因此，实现您的要求的算法将是：

1.  访问元素 Base64 编码的文本内容并对其进行 Base64 解码
2.  将 ZIP 原始文本输出到临时文件中，从而创建 ZIP 文件
3.  检查临时创建的 ZIP 文件是否有效

考虑到所有这些，完整的 Groovy 脚本如下所示：

```
import org.apache.commons.codec.binary.Base64

// Step 1: Access element Base64-encoded text content and Base64 decode it
String tempZipFilename = "temp.zip"
def textBase64 = context.expand(
  '${Step#Request#//ns2:getInputConfigFilesResponse[1]/return[1]}' )
def b64 = new Base64()
def zipTextBytes = b64.decode(textBase64.getBytes())

// Step 2: Output ZIP raw text into a temporary file
def zipFile = new java.io.File(tempZipFilename)
FileOutputStream fos = new java.io.FileOutputStream(zipFile)
fos.write( zipTextBytes )
fos.flush()
fos.close()
log.info "Temporary ZIP file stored as: ${zipFile.getCanonicalPath()}"

// Step 3: Check if the temporarily created ZIP file is valid
boolean responseValid
try {
  zipFile = new java.util.zip.ZipFile(tempZipFilename)
  responseValid = true
  log.info "Number of files in the ZIP file: ${zipFile.size()}"
} catch (java.util.zip.ZipException e) {
  responseValid = false
  log.error "The received response contains a bad ZIP"
}
log.info "Web service response is " + (responseValid ? "valid" : "invalid") 
```

请让我知道这是否对您有用，对我也有用。:-)

干杯!
松兹拉

ps 我建议在这个问题中添加“ZIP”标签，以便人们可以更轻松地找到一个解决方案来处理嵌入在这里的 Groovy 的 ZIP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T19:07:32.667

你将不得不使用一些时髦的东西。

1.  将字节数组输出到文件。
2.  使用您可以解析的输出执行一些命令行（7zip，zip 等等）。
3.  确保它是正确的输出。

编辑：添加了一些示例代码。

`def saveFile = new java.io.File(saveTestDir + "\\testreturn.zip")`

`FileOutputStream fos = new java.io.FileOutputStream(saveFile);`

`def zipBytes = context.expand( '${Step#Request#//ns2:getInputConfigFilesResponse[1]/return[1]}' );`

`fos.write( zipBytes.getBytes() );`

`fos.flush();`

`fos.close();`

# python - 如何让 IPython 按类组织选项卡完成的可能性？

> ID：465605
> 
> 赞同：5
> 
> 时间：2009-01-21T14:50:32.503
> 
> 标签：python, readline, ipython

当一个对象有数百个方法时，tab 补全很难使用。有趣的方法通常是被检查对象的类而不是其基类定义或覆盖的方法。

如何让 IPython 对其选项卡完成可能性进行分组，以便检查对象的类中定义的方法和属性首先出现，然后是基类中的方法和属性？

它看起来像未记录的`inspect.classify_class_attrs(cls)`功能以及`inspect.getmro(cls)`为我提供了我需要的大部分信息（这些最初是为了实现 python 的`help(object)`功能而编写的）。

默认情况下 readline 按字母顺序显示完成，但用于显示完成的函数可以替换为 ctypes 或 Python 2.6 及更高版本包含的 readline 模块。我已经覆盖了 readline 的完成显示并且效果很好。

现在我需要的只是一种将每个类信息（从`inspect.*`上面）与每个实例信息合并的方法，按方法解析顺序对结果进行排序，漂亮的打印和分页。

为了获得额外的功劳，最好存储选择的自动完成，并在下次尝试对同一对象进行自动完成时首先显示最受欢迎的选择。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T16:22:23.313

由于我还没有使用 Python 2.6 或 3.0 并且没有`readline.set_completion_display_matches_hook()`，我可以使用 ctypes 进行设置`completion_display_func`，如下所示：

```
from ctypes import *

rl = cdll.LoadLibrary('libreadline.so')

def completion_display_func(matches, num_matches, max_length):
    print "Hello from Python"
    for i in range(num_matches):
        print matches[i]

COMPLETION_DISPLAY_FUNC = CFUNCTYPE(None, POINTER(c_char_p), c_int, c_int)
hook = COMPLETION_DISPLAY_FUNC(completion_display_func)
ptr = c_void_p.in_dll(rl, 'rl_completion_display_matches_hook')
ptr.value = cast(hook, c_void_p).value 
```

现在，当我按“制表符”完成时，我自己的函数会打印完成列表。这样就回答了“如何更改 readline 显示完成的方式”的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T23:06:42.283

I don't think this can be accomplished easily. There's no mechanism in Ipython to perform it in any case.

Initially I had thought you could modify Ipython's source to change the order (eg by changing the `dir2()` function in genutils.py). However it looks like readline alphabetically sorts the completions you pass to it, so this won't work (at least not without a *lot* more effort), though you could perhaps exclude methods on the base class completely.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T17:04:55.247

看起来我可以使用`readline.set_completion_display_matches_hook([function])`（Python 2.6 中的新功能）来显示结果。完成者会像往常一样返回一个可能性列表，但也会`inspect.classify_class_attrs(cls)`在适用的地方存储结果。必须持有对完成者的`completion_display_matches_hook`引用以检索最新的完成列表以及我正在寻找的分类信息，因为仅在其参数中接收匹配名称列表。然后钩子以令人愉悦的方式显示完成列表。

# .net - Vista 上的 MSI 错误代码 2869

> ID：465606
> 
> 赞同：4
> 
> 时间：2009-01-21T14:50:33.017
> 
> 标签：.net, windows-vista, installation, windows-installer

我有一个使用 Visual Studio 2005 创建的 .NET 应用程序的 MSI，其中包括在安装结束时编写一些注册表项的自定义操作。我发现安装程序在 Windows XP SP2 和 SP3 上运行良好。但是，当我尝试在 Vista PC 上运行安装程序时，安装程​​序似乎几乎一直运行到最后，但随后死机并回滚并给出错误代码 2869。

我使用管理员帐户登录，但仍然出现相同的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-02-13T21:19:56.480

我找到了这个问题的明确答案。错误 2869 是一个毫无意义的错误，意思是“无法显示真正问题的错误”。真正的错误被掩盖了。在许多情况下，该错误与模仿有关，但并非总是如此！

此解决方案既修复了错误显示错误，也修复了 Vista 和 Windows 7 上的 Impersonation/Admin priv 问题。

缺少的一件事是手握（对于像我这样不想了解javascript的人）以使其正常工作。

1.  访问 [http://blogs.msdn.com/b/nikhiln/archive/2007/04/25/post-build-script-to-fix-msi-issues-in-vista-for-vs-2005-setup-and -部署项目.aspx](http://blogs.msdn.com/b/nikhiln/archive/2007/04/25/post-build-script-to-fix-msi-issues-in-vista-for-vs-2005-setup-and-deployment-project.aspx)

2.  获取脚本，并将其作为 PostBuildVistaFix.js 保存到您的部署项目文件夹中

3.  调出部署项目属性
4.  将 PostBuildEvent 更改为

    `cscript.exe ..\PostBuildVistaFix.js your_installer.msi`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T14:54:19.080

好的，我找到了一个解决我的问题的方法：

如果我以管理员用户身份登录，而不是通过双击 msi 或 setup.exe 来运行我的安装程序，如果我右键单击并选择“以管理员身份运行”，我的程序将成功安装。

看起来这与机器上启用了 UAC 的事实有关。我在关闭 UAC 的 Vista 机器上进行了尝试，安装程序在管理员用户正常运行时运行良好。

可以在[此处找到解决此问题的类似快速而肮脏的方法](http://blogs.conchango.com/pauloreichert/archive/2006/11/21/Windows-Installer-MSI-packages-error-code-2869-on-Windows-Vista.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T21:37:24.583

我想出的解决方案是向客户分发一个带有配置为在安装开始时触发 UAC 提升的清单的 EXE，而不是一个 MSI（我们的应用程序必须在每台机器上安装）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-01T18:25:40.277

该问题与 Vista 在自定义操作上强制执行 NoImpersonate 位有关。XP以前忽略了这一点。

您无法在 Visual Studio 2005 中设置该位，但[这里](http://blogs.msdn.com/astebner/archive/2006/10/23/mailbag-how-to-set-the-noimpersonate-flag-for-a-custom-action-in-visual-studio-2005.aspx)有一个流程可以让它工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-13T10:12:37.967

打电话

```
msiexec /a "path-to-package.msi" 
```

帮助过我。

# compilation - 使用 Autoconf 查找可变名称库

> ID：465620
> 
> 赞同：1
> 
> 时间：2009-01-21T14:53:32.030
> 
> 标签：compilation, autoconf, configure

我正在编写我的第一个项目，该项目将使用 autoconf 并在我进行时自学。在大多数情况下，事情进展得非常顺利。我还有最后一个重大障碍。我在定位可能因系统不同而命名不同的库和头文件时遇到问题。

例如，我需要使用 Mozilla 的 SpiderMonkey 进行编译。从源代码编译时，SpiderMonkey 变为 libjs.so。然而，在我的 Linux 变体中，SpiderMonkey 安装为 libmozjs.so。它是同一个库，只是名称不同，因此链接器标志不同。

是否有适当的方法来检测库的名称？我是否只是将其默认为“js”并提供配置选项来覆盖它？

我对头文件也有同样的情况。SpiderMonkey 的头文件安装在我的操作系统上的 /usr/include/mozjs/ 中。我确信在其他系统上，它将是 /usr/include/js/ 或者甚至可能只是 /usr/include/。如何找到正确的头文件位置？我犹豫要不要做一个普通的“查找”，因为它会很慢，而且我可能会找到错误的文件副本（例如，在用户的主目录而不是 /usr/include/ 中查找文件。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:25:56.230

AC_TRY_LINK（有或没有循环）是不必要的冗余。举个例子，这个食谱：

```
LIBS=""
AC_SEARCH_LIBS([spidermonkey_init], [mozjs js], [sp_libs="$LIBS"; LIBS=""], []) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T15:54:12.890

除了添加明确指定路径/​​名称的选项外，如果有一些众所周知的名称或位置，您可以按顺序尝试它们，直到成功，使用如下所示：

```
 AC_TRY_LINK([#include "mpi.h"],[MPI_Init(0, 0);], [mpi_link="yes"], [mpi_link="no"]); 
```

或者只是使用测试。我使用以下内容来获取实际构建的 boost 库，可能名称略有不同：

```
for lib in "date_time" "filesystem" "regex" "unit_test_framework" "signals"; do
    if test -f ${$1_libdir}/libboost_$lib-gcc$boost_thread_flag.a; then
      BOOST_LIBS="$BOOST_LIBS -lboost_$lib-gcc$boost_thread_flag"
    elif test -f ${$1_libdir}/libboost_$lib-gcc$boost_thread_flag-s.a; then
      BOOST_LIBS="$BOOST_LIBS -lboost_$lib-gcc$boost_thread_flag-s"
    elif test -f ${$1_libdir}/libboost_$lib$boost_thread_flag.a; then
      BOOST_LIBS="$BOOST_LIBS -lboost_$lib$boost_thread_flag"
    elif test -f ${$1_libdir}/libboost_$lib.a; then
      BOOST_LIBS="$BOOST_LIBS -lboost_$lib"
    fi
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T14:58:10.897

我会选择一个选项：`--with-spidermonkey-library= --with-spidermonkey-include=`

如果未指定选项，则放置默认值/搜索。（可能只是默认值）

# .net - Biztalk 拆分文件和使用

> ID：465621
> 
> 赞同：0
> 
> 时间：2009-01-21T14:53:40.157
> 
> 标签：.net, file, biztalk, pipeline, split

在 Biztalk 2006 中，我有一个自定义管道，可以在每个文件被映射之前将一个文件拆分为多个文件。在发送管道中，我使用“使用临时文件进行写入”。我的问题是：当拆分消息并使用“使用临时文件进行写入”时，是否将每个拆分的文件同时从 temp 文件夹移动到 out 文件夹，或者每个拆分的文件都移动到 out文件夹一旦完成，不等待其他文件？这些文件非常小，所以我还没有发现。我只想知道标准行为，所以我不必花费太多时间来创建大文件并观察结果。感谢帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T20:31:31.430

您可以在 BizTalk 中通过利用它的几个功能来做到这一点。第一个功能是关于使用信封模式的批处理和分批。这些技术用于将 XML 文档拆分为许多较小的文档（即，包含 500 个采购订单的 XML 文档分为 500 个 XML 文档，每个文档包含一个采购订单）。然后同样在发送时再次组装它们。这是一篇关于如何实现这一点的文章：http: [//msdn.microsoft.com/ja-jp/library/aa578216.aspx](http://msdn.microsoft.com/ja-jp/library/aa578216.aspx)

根据您正在执行的操作，您可以使用 XPath 表达式对编排中的消息进行分批，并处理编排中的每个单独的消息。然后，编排可以将传出消息重新组合到单个实例中。

告诉我们更多关于你想要做什么的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T12:02:18.503

根据您的描述，我不是 100% 确定我完全理解您的情况

我假设您正在通过接收管道中的反汇编程序拆分文件，并且您对“使用临时文件进行写入”的引用是指文件发送适配器设置，并且此发送端口订阅来自接收端口的消息。

在这种情况下，每个输出消息（原始传入消息的片段）都将被独立处理并尽快交付，当然是在消息框之后（在发送端）

如果你在你的反汇编器上有一个 RecoverableInterchangeProcessing 设置，并且你已经将它设置为 True，那么消息将被完全独立地处理；如果此设置为 false，它们将一起提交到消息框，但 BizTalk 可能会以任何顺序接收它们。

# asp.net-mvc - ASP.NET MVC 视图 - 替代框架

> ID：465625
> 
> 赞同：0
> 
> 时间：2009-01-21T14:55:15.503
> 
> 标签：asp.net-mvc

我知道存在用于创建视图的替代框架，与在 ASP.NET MVC 中创建视图的标准方式不同。你建议什么替代方案，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T15:00:46.883

这是我的清单....

*   [NVelocity](http://nvelocity.sourceforge.net/) 这里有一些例子... [使用 ASP.NET MVC (NVelocity) 的替代视图引擎](http://www.chadmyers.com/Blog/archive/2007/11/28/testing-scottgu-alternate-view-engines-with-asp.net-mvc-nvelocity.aspx)

*   [NHAML 查看引擎](http://code.google.com/p/nhaml/downloads/list) [NHAML 简介](http://andrewpeters.net/2007/12/19/introducing-nhaml-an-aspnet-mvc-view-engine/)

我喜欢 NHAML 因为

*   更少的噪音更多的内容
*   永远不要忘记结束标签
*   标识符和选择器，对 Css 友好
*   服务器端代码/令牌语法

更多细节在

[NHAML 和 ASP.NET MVC 简介](http://andrewpeters.net/2007/12/19/introducing-nhaml-an-aspnet-mvc-view-engine/) （这一篇包含有用的信息）。

和

[ASP.NET 和 NHAML](http://devlicio.us/blogs/sergio_pereira/archive/2008/10/29/asp-net-mvc-and-nhaml.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-02T08:59:01.890

另一种 ASP.NET MVC 框架是（开源）[Vici MVC 框架](http://viciproject.com/mvc "ASP.NET MVC 替代框架")。

# java - Java中String(String)构造函数的使用

> ID：465627
> 
> 赞同：11
> 
> 时间：2009-01-21T14:56:04.567
> 
> 标签：java, string, coding-style

我读过`String s = new String("...");`几乎所有时间都应该避免使用的文章和书籍。我明白为什么会这样，但是使用 String(String) 构造函数有什么用处吗？我认为没有，也没有看到任何其他证据，但我想知道 SO 社区中是否有人知道它的用途。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-21T15:08:24.900

这是一篇好文章：[被认为无用的字符串构造函数毕竟是有用的！](http://kjetilod.blogspot.com/2008/09/string-constructor-considered-useless.html)

> 事实证明，这个构造函数实际上至少在一种情况下是有用的。如果您曾经看过 String 源代码，您会发现它不仅包含 char 数组值和字符数的字段，还包含到 String 开头的偏移量。这是为了让字符串可以与其他字符串共享 char 数组值，通常是调用 substring() 方法之一。几年前，在 jwz 的 Java 咆哮中，Java 因这一点而受到严厉批评：
> 
> 这种开销的唯一原因是 String.substring() 可以返回共享相同值数组的字符串。这样做的代价是向每个 String 对象添加 8 个字节并不是净节省......
> 
> 除了节省字节，如果你有这样的代码：
> 
> ```
> // imagine a multi-megabyte string here  
> String s = "0123456789012345678901234567890123456789";  
> String s2 = s.substring(0, 1);  
> s = null; 
> ```
> 
> 您现在将拥有一个 String s2，虽然它看起来是一个单字符的字符串，但它包含对在 String s 中创建的巨大 char 数组的引用。这意味着数组不会被垃圾回收，即使我们已经明确地清空了 String s！
> 
> 解决这个问题的方法是使用我们之前提到的“无用” String 构造函数，如下所示：
> 
> ```
> String s2 = new String(s.substring(0, 1)); 
> ```
> 
> 众所周知，如果旧数组大于字符串中的字符数，则此构造函数实际上会将旧内容复制到新数组中。这意味着旧的 String 内容将按预期进行垃圾收集。快乐快乐快乐快乐。

最后，[Kat Marsen](http://hanuska.blogspot.com/2006/03/how-useful-is-stringstring-constructor.html?showComment=1169976540000#c5481901777730175548)提出了这些观点，

> 首先，字符串常量永远不会被垃圾回收。其次，字符串常量是实习生的，这意味着它们在整个 VM 中共享。这样可以节省内存。但这并不总是你想要的。
> 
> String 上的复制构造函数允许您从 String 文字创建私有 String 实例。这对于构造有意义的互斥对象（出于同步目的）非常有价值。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-21T15:00:27.460

如果我没记错的话，唯一“有用”的情况是原始 String 是更大的后备数组的一部分。（例如创建为子字符串）。如果您只想保留小子字符串并垃圾收集大缓冲区，那么创建一个新字符串可能是有意义的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-21T15:19:56.673

只是为了扩展[道格拉斯的答案](https://stackoverflow.com/questions/465627/use-of-the-stringstring-constructor-in-java#465639)*，我可以举一个我在哪里使用它的可靠例子。考虑阅读一个包含数千行的字典文件，每行只有一个单词。阅读本文的最简单方法是使用`BufferedReader.readLine()`.

不幸的是，`readLine()`默认情况下分配一个 80 个字符的缓冲区作为预期的行长。这意味着它通常可以避免无意义的复制——而且一点点浪费的内存通常也不会太糟糕。但是，如果您在应用程序期间加载短词词典，最终会永久浪费大量内存。我的“小应用程序”占用了比它应该做的更多的内存。

解决方案是改变这一点：

```
String word = reader.readLine(); 
```

进入这个：

```
String word = new String(reader.readLine()); 
```

......当然有评论！

`*`我不记得当这件事真的出现时我是否正在与道格拉斯一起工作，或者他回答这个特定问题是否只是巧合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T15:09:13.137

构造函数在很大程度上是多余的，不推荐用于一般目的。除了创建现有字符串变量的独立副本外，很少使用带有 String 参数的 String 构造函数。基本上用它来“澄清”你的代码。一点也不差。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T15:12:37.670

来自[javadoc](http://java.sun.com/javase/6/docs/api/java/lang/String.html#String(java.lang.String))

```
/**
 * Initializes a newly created {@code String} object so that it represents
 * the same sequence of characters as the argument; in other words, the
 * newly created string is a copy of the argument string. Unless an
 * explicit copy of {@code original} is needed, use of this constructor is
 * unnecessary since Strings are immutable.
 *
 * @param  original
 *         A {@code String}
 */
public String(String original){.....} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-21T15:00:13.903

如果您不想为原始字符串提供句柄，则如果您需要原始字符串的*副本，则可以使用它。*但是由于字符串是不可变的，我看不到这个用例*；*）

# winapi - 如何验证 exe/dll/sys 是否来自 Microsoft？

> ID：465646
> 
> 赞同：2
> 
> 时间：2009-01-21T15:01:21.843
> 
> 标签：winapi, digital-signature, capicom

我需要一些*简单*的 API 来验证 PE 文件是否有效并且 Microsoft 签名，就像[SignTool](http://msdn.microsoft.com/en-us/library/aa387764(VS.85).aspx)一样。我应该从哪里开始？这可以用 CAPICOM 完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T15:08:25.807

示例 C 程序：验证 PE 文件的签名：http:
[//msdn.microsoft.com/en-us/library/aa382384 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa382384(VS.85).aspx)

# delphi - 在 NestedDataSet 字段上过滤 TClientDataSet

> ID：465647
> 
> 赞同：3
> 
> 时间：2009-01-21T15:01:49.453
> 
> 标签：delphi, tclientdataset

感谢那些在这里帮助过我的人，我正在开发一个小型应用程序，该应用程序几乎完成了。不过，我还有最后一项任务。我需要能够在 NestedDataSet 字段上过滤 TClientDataSet。

```
ClientDataset1
Field0: Name (Lake Name)
ClientDataset2
Field0: Species (Fish Species)

type
  TDataModule1 = class( TDataModule )
    ClientDataSet1: TClientDataSet;
    ClientDataSet2: TClientDataSet;
    ClientDataSet1Name: TStringField;
    ClientDataSet1County: TStringField;
    ClientDataSet1Town: TStringField;
    ClientDataSet1Area: TStringField;
    ClientDataSet1MaximumDepth: TStringField;
    ClientDataSet1MeanDepth: TStringField;
    ClientDataSet1MapFilename: TStringField;
    ClientDataSet1Species: TDataSetField;
    ClientDataSet2Species: TStringField;
    procedure DataModuleDestroy( Sender: TObject );
  private
    { Private declarations }
  public
    { Public declarations }
  end;

Data:
Nate Pond
    Brook trout
    Creek chub
    Golden shiner
Black Pond
    Brook trout
    Brown bullhead
    Common shiner
Lake Placid
    Lake trout
    Smallmouth bass
    Yellow perch 
```

我需要过滤 ClientDataset1 以在 ClientDataset Species 字段中显示所有有 Brook trout 的湖泊。

```
Filtered:
Nate Pond
    Brook trout
    Creek chub
    Golden shiner
Black Pond
    Brook trout
    Brown bullhead
    Common shiner 
```

如何创建过滤器（或其他方式）来完成此任务？是否有任何第三方组件可以做到这一点？

谢谢，

账单

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T20:43:04.383

尝试将 OnFilterRecord 处理程序添加到主数据集，并在处理程序内的嵌套数据集上使用定位来查看记录是否存在。

# database - 清理 SQL 数据库中的所有记录

> ID：465653
> 
> 赞同：2
> 
> 时间：2009-01-21T15:02:16.957
> 
> 标签：database, tsql

我想知道在投入生产之前你会用什么来清理所有测试数据的数据库（保持结构完整）？

我使用类似的东西：

```
-- disable referential integrity
EXEC sp_MSForEachTable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL'
GO

EXEC sp_MSForEachTable '
 IF OBJECTPROPERTY(object_id(''?''), ''TableHasForeignRef'') = 1
  DELETE FROM ?'
DBCC CHECKIDENT (''?'', RESEED, 0)
GO

-- enable referential integrity again
EXEC sp_MSForEachTable 'ALTER TABLE ? CHECK CONSTRAINT ALL'
GO 
```

我想我是在网上某处找到的，但是，它似乎并不总是将所有内容重新归零。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T15:06:30.613

常见的方法是使用设置脚本删除所有表，然后重新创建它们。这也比仅擦除保留任何更改的数据有好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T15:04:50.057

我通常从开发数据库生成 DDL 语句，然后在生产服务器上从头开始创建数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T15:05:04.127

我们保留脚本以在版本控制中构建数据库。当我们需要清除测试数据时，我们删除数据库并重新创建它。另一种选择是恢复处于所需状态的备份。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T15:06:15.793

我会为您需要清理的表创建创建/删除脚本，然后将它们清除并重新创建它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T16:55:53.717

要重新设定您的身份列，您可以将以下行添加到您的重置脚本中。

```
EXEC sp_MSForEachTable 'DBCC CHECKIDENT('?', RESEED, 0)'
```

您可以将命令中的 0 更改为您的默认值。

# windows - Windows 移动 Windows 消息跟踪实用程序

> ID：465654
> 
> 赞同：0
> 
> 时间：2009-01-21T15:02:17.317
> 
> 标签：windows, winapi, windows-mobile

我正在寻找在 Windows 手机上运行并跟踪它收到的所有 Windows 消息的小型实用程序。不是消息代码，而是名称，如果它可以弄清楚的话。

我可能可以自己写，但不知道在哪里可以得到 WM 字典。解析 .H 文件透视图让我发疯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-25T07:02:19.483

大多数 Windows Mobile SDK 的远程工具下都安装了一个“Spy”版本。因此，如果您拥有带有内置 Windows Mobile SDK 的 MSVC，或者您已经安装了 Windows Mobile SDK，那么您应该能够找到它：（至少对于 vc2008 安装）

\Program Files\CE 远程工具\5.01\bin\ccspy.exe

在windows下运行它并连接到windows移动设备。它的工作方式类似于标准的 spy++，但更有限。

# svn - 用于分支和标记的 CVS/SVN 最佳实践

> ID：465658
> 
> 赞同：11
> 
> 时间：2009-01-21T15:03:34.787
> 
> 标签：svn, version-control, branch, tagging

我将负责决定如何在我们的 CVS/SVN 存储库中进行标记分支。

是否有任何文献可以帮助我了解使用 CVS 的最佳方式？分支/标记等？

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-21T15:08:07.740

我在 FreeBSD 项目的 10 多年 CVS 中的个人经验是：尽可能快地切换到其他东西。CVS 是面向文件的而不是面向快照/变更集的，这使得分支之间的合并相当痛苦。无论如何，CVS 的分支都很痛苦。

至于 CVS 的资源，请参阅[CVS 主页](http://ximbiot.com/cvs/cvshome/docs/)

如果您想谈论 SVN，我建议您[阅读 SVN Book](http://svnbook.red-bean.com/)和 this [question](https://stackoverflow.com/questions/464417/how-to-use-svn-branch-tag-trunk)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-21T15:22:14.717

我建议阅读关于 SVN 和 CVS 的两本实用程序员书籍，名为“[使用 CVS 的实用版本控制](http://www.pragprog.com/titles/vcc/pragmatic-version-control-using-cvs)”和“[使用 Subversion 的实用版本控制](http://www.pragprog.com/titles/svn2/pragmatic-version-control-using-subversion)”。

两者都是极好的资源，充满了描述你想要做什么的食谱，而不是前面提到的书中对技术本身的具体细节描述。

高温高压

干杯，

抢

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-21T15:08:55.197

明智的经验法则：

*   标记每个构建（即，每个构建都带有构建号——任何您可能发送给测试人员或其他任何人的东西）。
*   每次需要分支时都进行分支。

通常，您需要对已发布的版本进行分支，以便测试和发布补丁。您可能有其他原因进行分支。

使用 Subversion 肯定会更好。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-21T15:14:22.190

我推荐你在 Windows上使用**SVN** ，在 Linux上使用**Git 。**不要使用 CVS，恕我直言，这太糟糕了。

[SVN Book](http://svnbook.red-bean.com/)是您首先需要的。

标记每个公共构建（发布）。由于某种原因，分支是一个复制主干 - 例如另一种开发方式。每次需要时分支存储库:)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-22T14:05:32.080

我相信这是来自编码恐惧：

Chris Birmele 的关于分支和合并的论文是我发现的对这一重要源代码控制任务的最佳介绍。分支的方法有几十种，没有一种正确的方法可以做到。熟悉您的选项，以便了解每个选项的权衡。

[分支和合并引物](http://msdn.microsoft.com/en-us/library/aa730834(VS.80).aspx)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-21T15:43:58.543

[Eric Sink 的 Source Control HOWTO](http://www.ericsink.com/scm/source_control.html)后面的条目涵盖了分支和合并。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-22T14:26:23.707

如果你想要一个 10 的启动器进行颠覆：

将“主干”视为您开发的完整历史。任何被释放的东西都必须在某个时间点以某种形式出现在主干中。

在复杂的开发任务中使用开发分支（主干的分支）。任务完成后，使用重新集成合并将更改从分支拉到主干。这样，您可以对主干进行一些特定的提交，而不是与同一任务相关的许多提交。不再需要时删除这些开发分支。将它们命名为“FeatureX”

使用版本分支（再次来自主干）来管理注定要发布给客户/部署到生活的营销版本。版本是主干中修订的子集。要使用它们，请在适当的修订版（可能不是 head）从主干分支，手动记录来自主干的修订作为合并到该分支，合并您需要从主干（仅来自主干）的任何其他修订。不要直接开发到版本分支，只从主干合并 - 尽管合并可能需要额外的工作以使其与版本兼容。名称如“2.4 版”

每当您制作发布给客户或部署到现场的构建或修补程序时，从您的版本分支创建特定标签。名称如“2.4.1”、“2.4.2”等。

以这种方式工作，您可以使用 subversion 的合并跟踪（1.5 版及更高版本）来准确查看每个版本中每个标签中的内容。为此，请获取标签或版本分支的工作副本并执行 'svn mergeinfo --show-revs merge [http://svn/trunk](http://svn/trunk) c:\workingcopy\'

这对于审核员、自动生成的发布说明、测试人员以及您对确切内容和内容的信心非常有用。使用包含此信息的自动生成矩阵，一目了然地查看不同版本包含的内容。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-15T23:43:40.650

阅读：http: [//oreilly.com/catalog/practicalperforce/chapter/ch07.pdf](http://oreilly.com/catalog/practicalperforce/chapter/ch07.pdf)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-21T18:16:28.640

你应该离开 CVS。CVS 是旧的并且在分支/标记方面不是很快（分支/标记的创建线性依赖于项目中的文件数量）

你应该首先考虑你的**分支策略**：你想拥有一个

*   稳定的树干
*   特征分支
*   开发者分支
*   不稳定的主干/发布分支
*   平台分支

这在很大程度上取决于您的项目和开发理念

如果你想使用 SVN，你真的必须考虑你的存储库布局，因为几乎所有的软件项目都是基于模块的，你应该找到一个可以轻松标记所有需要的模块的结构。SVN 及其基于文件夹的分支/标签方法很难实现这一要求。

这应该很清楚，多存储库布局更难以维护稳定的标记系统。我更喜欢“标记所有”的方法，但这是我个人的选择。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-22T14:50:00.833

几年前去我的第一个真正的 SCM（从源代码安全）时，我发现以下内容很有帮助 - 当时我认为 perforce 有一份白皮书：

[http://www.perforce.com/perforce/bestpractices.html](http://www.perforce.com/perforce/bestpractices.html)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-21T15:06:57.370

Cederqvist通常被认为是[CVS](http://ximbiot.com/cvs/manual/cvs-1.11.23/cvs.html)的指南*。*

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-21T18:18:57.903

我建议使用 GIT，因为标记/分支过程非常易于使用。使用 SVN（尤其是在 windows 上）的好处是 GUI 工具的数量和 windows shell 的集成。

我还支持关于 SVN 的实用程序员书籍的推荐。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-03-02T19:10:15.927

好吧，你使用什么源代码控制系统并不重要，它们基本上都遵循某种形式的主干/分支/标签结构。即使它是一个分布式模型，存储库也会以反映这一点的方式设置。

有一个非常简单的解释可以帮助您从[这里](http://www.duchnik.com/tutorials/vc/svn-best-practices)开始。

# language-agnostic - 如何从字符串创建 SEO 友好的破折号分隔 url？

> ID：465659
> 
> 赞同：17
> 
> 时间：2009-01-21T15:03:40.730
> 
> 标签：language-agnostic, string, seo, slug

取一个字符串，例如：

> 在 C# 中：如何在以逗号分隔的字符串列表中的字符串周围添加“引号”？

并将其转换为：

> 在-c-how-do-i-add-quotes-around-string-in-a-comma-delimited-list-of-strings

要求：

*   用破折号分隔每个单词并删除所有标点符号（考虑到并非所有单词都用空格分隔。）
*   函数接受最大长度，并获取低于该最大长度的所有标记。示例：`ToSeoFriendly("hello world hello world", 14)`返回`"hello-world"`
*   所有单词都转换为小写。

另外，是否应该有最小长度？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-21T16:40:57.537

这是我在 C# 中的解决方案

```
private string ToSeoFriendly(string title, int maxLength) {
    var match = Regex.Match(title.ToLower(), "[\\w]+");
    StringBuilder result = new StringBuilder("");
    bool maxLengthHit = false;
    while (match.Success && !maxLengthHit) {
        if (result.Length + match.Value.Length <= maxLength) {
            result.Append(match.Value + "-");
        } else {
            maxLengthHit = true;
            // Handle a situation where there is only one word and it is greater than the max length.
            if (result.Length == 0) result.Append(match.Value.Substring(0, maxLength));
        }
        match = match.NextMatch();
    }
    // Remove trailing '-'
    if (result[result.Length - 1] == '-') result.Remove(result.Length - 1, 1);
    return result.ToString();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-21T15:40:55.960

我会按照以下步骤操作：

1.  将字符串转换为小写
2.  用连字符替换不需要的字符
3.  ~~用一个连字符替换多个连字符~~ *（没有必要，因为`preg_replace()`函数调用已经阻止了多个连字符）*
4.  如有必要，在开头和结尾删除连字符
5.  如果需要，从位置 x 之前的最后一个连字符修剪到末尾

因此，所有这些都在一个函数中（PHP）：

```
function generateUrlSlug($string, $maxlen=0)
{
    $string = trim(preg_replace('/[^a-z0-9]+/', '-', strtolower($string)), '-');
    if ($maxlen && strlen($string) > $maxlen) {
        $string = substr($string, 0, $maxlen);
        $pos = strrpos($string, '-');
        if ($pos > 0) {
            $string = substr($string, 0, $pos);
        }
    }
    return $string;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-21T15:53:39.863

C＃

```
public string toFriendly(string subject)
{
    subject = subject.Trim().ToLower();
    subject = Regex.Replace(subject, @"\s+", "-");
    subject = Regex.Replace(subject, @"[^A-Za-z0-9_-]", "");
    return subject;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T15:22:35.933

这是php的解决方案：

```
function make_uri($input, $max_length) {
  if (function_exists('iconv')) {  
    $input = @iconv('UTF-8', 'ASCII//TRANSLIT', $input);  
  }

  $lower = strtolower($input);

  $without_special = preg_replace_all('/[^a-z0-9 ]/', '', $input);
  $tokens = preg_split('/ +/', $without_special);

  $result = '';

  for ($tokens as $token) {
    if (strlen($result.'-'.$token) > $max_length+1) {
      break;
    }

    $result .= '-'.$token;       
  }

  return substr($result, 1);
} 
```

用法：

```
echo make_uri('In C#: How do I add "Quotes" around string in a ...', 500); 
```

除非您需要可键入的 uri，否则它们不需要很小。但是您应该指定一个最大值，以便 url 与代理等很好地配合使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-08T12:21:00.360

更好的版本：

```
function Slugify($string)
{
    return strtolower(trim(preg_replace(array('~[^0-9a-z]~i', '~-+~'), '-', $string), '-'));
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-02T14:33:15.007

Perl 中的解决方案：

```
my $input = 'In C#: How do I add "Quotes" around string in a comma delimited list of strings?';

my $length = 20;
$input =~ s/[^a-z0-9]+/-/gi;
$input =~ s/^(.{1,$length}).*/\L$1/;

print "$input\n"; 
```

完毕。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-02T14:37:28.013

shell中的解决方案：

```
echo 'In C#: How do I add "Quotes" around string in a comma delimited list of strings?' | \
    tr A-Z a-z | \
    sed 's/[^a-z0-9]\+/-/g;s/^\(.\{1,20\}\).*/\1/' 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-26T03:34:39.973

这与 Stack Overflow 生成 slug 的方式很接近：

```
public static string GenerateSlug(string title)
{
    string slug = title.ToLower();
    if (slug.Length > 81)
      slug = slug.Substring(0, 81);
    slug = Regex.Replace(slug, @"[^a-z0-9\-_\./\\ ]+", "");
    slug = Regex.Replace(slug, @"[^a-z0-9]+", "-");

    if (slug[slug.Length - 1] == '-')
      slug = slug.Remove(slug.Length - 1, 1);
    return slug;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-13T01:04:38.910

至少在 PHP 中执行此操作的一种稍微干净的方法是：

```
function CleanForUrl($urlPart, $maxLength = null) {
    $url = strtolower(preg_replace(array('/[^a-z0-9\- ]/i', '/[ \-]+/'), array('', '-'), trim($urlPart)));
    if ($maxLength) $url = substr($url, 0, $maxLength);
    return $url;
} 
```

最好`trim()`在一开始就做，这样以后处理的事情就更少了，完全替换是在`preg_replace()`.

感谢 cg 提出大部分内容：[清理字符串以放置在 URL 中的最佳方法是什么，例如 SO 上的问题名称？](https://stackoverflow.com/questions/539920/what-is-the-best-way-to-clean-a-string-for-placement-in-a-url-like-the-question/540491#540491)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-11-12T00:27:56.447

*另一个季节，另一个原因，选择 Ruby* :)

```
def seo_friendly(str)
  str.strip.downcase.gsub /\W+/, '-'
end 
```

就这样。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-11-12T00:43:31.370

在 python 中，（如果安装了 django，即使您使用的是另一个框架。）

```
from django.template.defaultfilters import slugify
slugify("In C#: How do I add "Quotes" around string in a comma delimited list of strings?") 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-12T20:54:10.357

为此，我们需要：

1.  规范化文本
2.  删除所有变音符号
3.  替换国际字符
4.  能够缩短文本以匹配 SEO 阈值

我想要一个函数来生成整个字符串，并有一个可能的最大长度的输入，这就是结果。

```
public static class StringHelper
{
/// <summary>
/// Creates a URL And SEO friendly slug
/// </summary>
/// <param name="text">Text to slugify</param>
/// <param name="maxLength">Max length of slug</param>
/// <returns>URL and SEO friendly string</returns>
public static string UrlFriendly(string text, int maxLength = 0)
{
    // Return empty value if text is null
    if (text == null) return "";

    var normalizedString = text
        // Make lowercase
        .ToLowerInvariant()
        // Normalize the text
        .Normalize(NormalizationForm.FormD);

    var stringBuilder = new StringBuilder();
    var stringLength = normalizedString.Length;
    var prevdash = false;
    var trueLength = 0;

    char c;

    for (int i = 0; i < stringLength; i++)
    {
        c = normalizedString[i];

        switch (CharUnicodeInfo.GetUnicodeCategory(c))
        {
            // Check if the character is a letter or a digit if the character is a
            // international character remap it to an ascii valid character
            case UnicodeCategory.LowercaseLetter:
            case UnicodeCategory.UppercaseLetter:
            case UnicodeCategory.DecimalDigitNumber:
                if (c < 128)
                    stringBuilder.Append(c);
                else
                    stringBuilder.Append(ConstHelper.RemapInternationalCharToAscii(c));

                prevdash = false;
                trueLength = stringBuilder.Length;
                break;

            // Check if the character is to be replaced by a hyphen but only if the last character wasn't
            case UnicodeCategory.SpaceSeparator:
            case UnicodeCategory.ConnectorPunctuation:
            case UnicodeCategory.DashPunctuation:
            case UnicodeCategory.OtherPunctuation:
            case UnicodeCategory.MathSymbol:
                if (!prevdash)
                {
                    stringBuilder.Append('-');
                    prevdash = true;
                    trueLength = stringBuilder.Length;
                }
                break;
        }

        // If we are at max length, stop parsing
        if (maxLength > 0 && trueLength >= maxLength)
            break;
    }

    // Trim excess hyphens
    var result = stringBuilder.ToString().Trim('-');

    // Remove any excess character to meet maxlength criteria
    return maxLength <= 0 || result.Length <= maxLength ? result : result.Substring(0, maxLength);
}
} 
```

该助手用于将一些国际字符重新映射为可读字符。

```
public static class ConstHelper
{
/// <summary>
/// Remaps international characters to ascii compatible ones
/// based of: https://meta.stackexchange.com/questions/7435/non-us-ascii-characters-dropped-from-full-profile-url/7696#7696
/// </summary>
/// <param name="c">Charcter to remap</param>
/// <returns>Remapped character</returns>
public static string RemapInternationalCharToAscii(char c)
{
    string s = c.ToString().ToLowerInvariant();
    if ("àåáâäãåą".Contains(s))
    {
        return "a";
    }
    else if ("èéêëę".Contains(s))
    {
        return "e";
    }
    else if ("ìíîïı".Contains(s))
    {
        return "i";
    }
    else if ("òóôõöøőð".Contains(s))
    {
        return "o";
    }
    else if ("ùúûüŭů".Contains(s))
    {
        return "u";
    }
    else if ("çćčĉ".Contains(s))
    {
        return "c";
    }
    else if ("żźž".Contains(s))
    {
        return "z";
    }
    else if ("śşšŝ".Contains(s))
    {
        return "s";
    }
    else if ("ñń".Contains(s))
    {
        return "n";
    }
    else if ("ýÿ".Contains(s))
    {
        return "y";
    }
    else if ("ğĝ".Contains(s))
    {
        return "g";
    }
    else if (c == 'ř')
    {
        return "r";
    }
    else if (c == 'ł')
    {
        return "l";
    }
    else if (c == 'đ')
    {
        return "d";
    }
    else if (c == 'ß')
    {
        return "ss";
    }
    else if (c == 'þ')
    {
        return "th";
    }
    else if (c == 'ĥ')
    {
        return "h";
    }
    else if (c == 'ĵ')
    {
        return "j";
    }
    else
    {
        return "";
    }
}
} 
```

该功能会像这样工作

```
const string text = "ICH MUß EINIGE CRÈME BRÛLÉE HABEN";
Console.WriteLine(StringHelper.URLFriendly(text));
// Output: 
// ich-muss-einige-creme-brulee-haben 
```

这个问题已经在[这里](https://stackoverflow.com/questions/25259/how-does-stack-overflow-generate-its-seo-friendly-urls/25486#25486)回答了很多次，但没有一个优化过。您可以[在 github 上](https://github.com/zarxor/url-friendly-slug)找到完整的源代码以及一些示例。您可以从[Johan Boström 的博客](https://johanbostrom.se/blog/how-to-create-a-url-and-seo-friendly-string-in-csharp-text-to-slug-generator/)中阅读更多内容。更多信息与 .NET 4.5+ 和 .NET Core 兼容。

# c - 如何为动态二维数组的整行赋值？

> ID：465660
> 
> 赞同：2
> 
> 时间：2009-01-21T15:04:09.887
> 
> 标签：c, arrays, dynamic

我需要对一个坐标执行 9 种不同的操作，具体取决于坐标的位置。我有一个函数，它返回给定坐标（下、上、左、右或对角线）周围的位置坐标。9 种不同的操作是不同可能的坐标“类型”；如果我正在处理坐标 (0, 0)，则唯一有效的操作是右、右下和下。

我有一个结构，用于存储对每种坐标类型有效的方向。角坐标为 4，所有内部坐标为 1，边缘行的非角列为 4。

我存储所有方向的结构中的字段是一个称为“库”的动态二维数组。库的每一行都对应一种坐标类型，包含该类型坐标的所有有效方向。不过，我还没有找到一种方法来一次分配一行的值，而且我不能用循环单独分配它们。

我尝试过的是：

```
searches->library[0][0] = {2, 3, 4, -1};
searches->library[1][0] = {4, 5, 6, -1};
searches->library[2][0] = {2, 3, 4, 5, 6, -1};
searches->library[3][0] = {0, 1, 2, 3, 4, 5, 6, 7, -1};
searches->library[4][0] = {0, 1, 2, -1};
searches->library[5][0] = {0, 6, 7, -1};
searches->library[6][0] = {0, 1, 2, 6, 7, -1};
searches->library[7][0] = {0, 1, 2, 3, 4, -1};
searches->library[8][0] = {0, 4, 5, 6, 7, -1}; 
```

但这给了我`p2AdjacencyMatrix.c:179: error: parse error before '{' token`每一行。

我也试过：

```
searches->library[][9] = {{2, 3, 4, -1},
                         {4, 5, 6, -1},
                         {2, 3, 4, 5, 6, -1},
                         {0, 1, 2, 3, 4, 5, 6, 7, -1},
                         {0, 1, 2, -1},
                         {0, 6, 7, -1},
                         {0, 1, 2, 6, 7, -1},
                         {0, 1, 2, 3, 4, -1},
                         {0, 4, 5, 6, 7, -1}}; 
```

结果呢`p2AdjacencyMatrix.c:189: error: parse error before ']' token`

这是结构定义：

```
typedef struct{
    int active_length;  // Size of active array of searches
    int* active;        // Active array of searches
    int** library;  // Library of array of searches
} SearchLibrary; 
```

以及动态数组的内存分配：

```
SearchLibrary* searches;
searches = (SearchLibrary *) malloc(sizeof(SearchLibrary*));
int search_cases = 9, search_directions = 9;
searches->library = (int **) malloc(search_cases * sizeof(int *));
searches->active = (int *) malloc(search_directions * sizeof(int));

int i;
for(i = 0; i < search_cases; i++){
    searches->library[i] = (int *) malloc(search_directions * sizeof(int));
} 
```

**如何将这些值添加到数组的每一行？**我尝试将我的结构定义更改为静态数组，但这也不起作用。这是因为我使用了指向结构的指针吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T15:21:19.727

假设 C99，您可以使用复合文字并将`memcpy()`其覆盖在您的行上。对于`k`第 - 行，这可能如下所示：

```
#define SEARCH_DIRECTIONS 9

memcpy(searches->library[k], ((int [SEARCH_DIRECTIONS]){ 1, 2, 3 }),
    sizeof(int) * SEARCH_DIRECTIONS); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T15:10:41.590

你不能这样做，在 C 中。没有数组文字供你分配，只有数组初始化表达式。

我认为解决方案是简单地从坐标和字段的大小计算所需的值，据我了解这应该很简单。

此外，具有恒定大小的文字初始化值似乎违背了动态分配所有这些内容的观点。

还：

*   不要在 C 中强制转换 malloc() 的返回值
*   不必要时不要在类型上使用 sizeof，例如 searchs = malloc(sizeof *searches); 等等

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T15:20:56.717

```
static const int Library0[] = {2, 3, 4, -1};
static const int Library1[] = {4, 5, 6, -1};
static const int Library2[] = {2, 3, 4, 5, 6, -1};
static const int Library3[] = {0, 1, 2, 3, 4, 5, 6, 7, -1};
static const int Library4[] = {0, 1, 2, -1};
static const int Library5[] = {0, 6, 7, -1};
static const int Library6[] = {0, 1, 2, 6, 7, -1};
static const int Library7[] = {0, 1, 2, 3, 4, -1};
static const int Library8[] = {0, 4, 5, 6, 7, -1};

static const int * Library[] = { 
    Library0, Library1, Library2,
    Library3, Library4, Library5,
    Library6, Library7, Library8,
};

typedef struct{
    int active_length;  // Size of active array of searches
    const int* active;                // Active array of searches
    const int** library;      // Library of array of searches
} SearchLibrary;

searches->library = Library; 
```

编辑：修复语法错误。

# asp.net - 使用 asp.net 和 ajax 测试来自客户端的身份验证

> ID：465661
> 
> 赞同：1
> 
> 时间：2009-01-21T15:04:12.053
> 
> 标签：asp.net, forms-authentication

从客户端，有没有办法从 asp.net 页面获取真/假值，以显示您有权访问该页面。使用表单身份验证我被重定向到登录页面。我只需要一个简单的布尔值。

亚伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T15:46:58.333

我会选择 User.Identity.IsAuthenticated

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T15:59:54.050

提到的所有这些方法都是服务器端 Asp.net 调用。如果您想从客户端执行此操作，我将创建一个通用处理程序来包装 Page.User.IsInRole("YourRoleName") 或 System.Web.HttpContext.Current.User.IsInRole("YourRoleName") 调用。

然后你可以只使用 javascript 来调用处理程序并返回结果。

# firefox - 在 Firefox 中访问第三方 cookie

> ID：465662
> 
> 赞同：9
> 
> 时间：2009-01-21T15:04:12.880
> 
> 标签：firefox, facebook, cookies, redirect, safari

我们在这里使用 iframe 方法构建一个 Facebook 应用程序。要使应用程序正常工作，它需要从 iframe 中设置 cookie。

Safari 默认禁用第三方 cookie，因此我们目前正在将整个浏览器重定向到我们的服务器，设置跟踪会话所需的 cookie，然后再次重定向回 Facebook 应用程序页面。

这种方法有效，而且效果很好。除非有人使用 Firefox 手动禁用第三方 cookie，因为 Firefox 默认启用它们。Safari 可以正常工作，因为它不允许您从 iframe 设置 cookie，但您可以阅读它们。另一方面，Firefox 不允许您读取 cookie，因此它变得有点不可能。

当第三方 cookie 被禁用时，无论如何让 Firefox 将 cookie 发送到外部服务器上的 iframe？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T16:30:41.567

> 当第三方 cookie 被禁用时，无论如何让 Firefox 将 cookie 发送到外部服务器上的 iframe？

不，那很好。禁用 3rd 方 cookie 应该会**禁用**它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-09-22T10:44:41.913

一种技术是使用 JavaScript 在初始页面加载时对隐藏的 iframe 执行后台 POST。一旦 POST 响应成功返回，您就可以设置 cookie。这消除了影响用户体验的需要（强制交互的插页式广告是另一种技术）。更多想法和示例代码在这里： http: [//gist.github.com/586182](http://gist.github.com/586182)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-04T23:15:10.530

是的，当您取消选中第 3 方 cookie 时，它​​不会发送或接受第 3 方 cookie。然而; 复选框是“接受第三方 cookie”，所以看起来它仍然应该 / 发送 / cookie，只是不接受任何新的 cookie ...... wack。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T15:09:21.203

与其针对浏览器，不如针对行为。

设置 cookie 并在下一个页面加载时使用您的 JS 检查它们。如果它们不存在，请使用替代方法设置它们。

（并确保没有 cookie 的用户不会陷入无限循环）

编辑：嗯，如果 FF 无法读取它们，那可能是个问题。让每个人都通过这个系统怎么样？

# c# - 搜索 ASP.Net 配置文件

> ID：465668
> 
> 赞同：0
> 
> 时间：2009-01-21T15:05:51.210
> 
> 标签：c#, .net, asp.net-membership, asp.net-3.5, membership-provider

我正在寻找一种使用标准 ASP.Net 配置文件提供程序搜索每个用户配置文件的方法。这可能吗，还是我应该创建一个新的配置文件提供程序？

这是场景：

*   用户注册
*   用户设置他们的个人资料（最喜欢的颜色、最喜欢的书、国家等）
*   然后，用户可以浏览其他用户，例如，喜欢“绿色”颜色的用户

我想通过会员/个人资料提供者来使用它，而不必直接对数据库进行编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T17:23:12.757

您想要的功能包含在 Profile API 中。

您可以使用以下方法获取个人用户配置文件：

```
HttpProfile profile = Profile.GetProfile("Fred"); 
```

您可以使用以下方式获取所有配置文件：

```
var allUsers = Membership.GetAllUsers();
foreach (MembershipUser user in allUsers)
{
    var prof = ProfileBase.Create(user.UserName, true);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T15:37:37.807

我相信标准提供者只适用于当前用户。您将需要一个自定义配置文件提供程序来检索其他用户的信息。幸运的是，这真的很[容易做到](http://weblogs.asp.net/jgalloway/archive/2008/01/19/writing-a-custom-asp-net-profile-class.aspx)。该链接有一个自定义提供程序的示例，允许您检索其他用户的配置文件。如果您使用他的示例，请务必注意此人关于从您的 web.config 中删除配置文件部分的评论。我必须这样做才能使我的工作正常。

# c# - 如何从 Excel 解析“剪切 n 粘贴”

> ID：465669
> 
> 赞同：4
> 
> 时间：2009-01-21T15:06:04.453
> 
> 标签：c#, asp.net, excel

对于 Web 应用程序的一部分，用户需要从电子表格中导入一些数据。例如姓名和电子邮件地址列表。目前，我们通过要求用户浏览并上传 CSV 文件来做到这一点。

不幸的是，这并不总是可行的，因为各种企业 IT 系统只允许用户从文档管理系统访问文件，并且他们没有权限将这些文件保存到本地驱动器或网络共享。

我们的解决方案是允许用户将整个工作表 (CSV) 剪切并粘贴到文本区域并提交。这样做你会得到一个很好的制表符分隔的数据列表，如下所示很容易解析。

```
Lorem   ipsum   dolor   sit amet
consectetur adipiscing  elit    Vivamus fermentum
Vivamus et  diam    eu  eros
egestas rutrum  Morbi   id  neque
id  enim    molestie    tincidunt   Nullam 
```

不幸的是，各种细胞可能会产生意想不到的结果。在下面的集合中，您可以看到单词 prerium 中的 "，单词 Suspendisse 的选项卡和单词 sollicitudin 中的换行符。

```
bibendum    ante    molestie    lectus  Sed
pret"ium    "Susp   endisse"    "sollic
itudin" nisi    at
urna    Sed sit amet    odio
eu  neque   egestas tincidunt   Nunc
metus   Curabitur   at  nibh    Nulla 
```

在这种情况下，如果没有更多增强机制来处理实际数据中的制表符、引号和换行符，我不能只拆分制表符和换行符。

有谁知道任何可以可靠地处理这个问题的代码？或者即使可以依靠 excel 和这样的剪贴板来产生一致的结果？

我正在使用 C# 在 Asp.net 3.5 中工作。用户的 excel 版本可能会有所不同，但应始终为 Windows 2000/XP/Vista 和 IE 6/7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T15:38:45.667

对我来说，这看起来像是一个“分隔值”列表，因此与以 TAB 作为字段分隔符和换行符作为行分隔符的 CSV 基本相同。您可以使用[CodeProject 的 CSV Reader 库进行](http://www.codeproject.com/KB/database/CsvReader.aspx)尝试，它应该可以处理不同的分隔符，而不仅仅是逗号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T15:20:12.350

[尝试在System.Windows.Forms.Clipboard 成员](http://msdn.microsoft.com/en-us/library/system.windows.forms.clipboard_members.aspx)中找到有用的东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T15:31:27.943

我见过一种解决方案，其中粘贴 csv 文件涉及从 IDataObject 中的剪贴板获取数据，然后使用带有 IDataObject.GetData("csv") 的 StreamReader 将 csv 的每一行读入数据对象

这可能比将 csv 粘贴到文本框然后将其塞进另一个数据对象更可靠。

抱歉，我没有示例代码，我会在有时间的时候尝试编辑它并尝试一下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T17:36:42.200

通过快速检查，可以创建一个包含选项卡（尝试`="abc"&CHAR(9)&"def"`将单元格复制到 html 文本区域）和一个或多个引号（例如`="this has""one quote"`）的 Excel 单元格值。我看不到任何完全万无一失的方法来确定你得到了什么。

问题是您无法真正控制 Excel（作为源）和浏览器中的文本区域（作为粘贴目标）之间的交互。我什至不确定不同浏览器的结果是否一定相同！

我想知道是否有一种方法可以通过一些中间应用程序来更好地管理这个，这些应用程序可以与 Excel 协商更广泛的剪贴板交换，以便可以将明确的格式传递给浏览器？我知道，这并不完全是一种无缝的用户体验，但是当你接触到这项技术时，你很快就会发现应用程序间的复制和粘贴真的*很难*。

鉴于格式错误的数据应该是例外，我想我会继续为“正常”情况编写一个解析器（您可能可以使用一两个正则表达式来完成）并将解析后的数据呈现给用户进行确认，能够编辑未正确解析的行。用一点 Ajax 魔法，我猜你可以提供一些相当漂亮的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-01T04:22:29.140

您可以使用 Microsoft 已经提供的 TextFieldParser 类：http: [//msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio%28v=vs.110%29.aspx)

# sql - 制定查询优先级队列表的 SQL

> ID：465692
> 
> 赞同：6
> 
> 时间：2009-01-21T15:12:15.003
> 
> 标签：sql, queue, priority-queue, queue-table

我正在实现一个小队列来处理哪个进程首先运行。我正在使用数据库中的表来执行此操作。这是表的结构（我在 SQLite 中模拟它）：

```
 "id" INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL ,
        "identifier" VARCHAR NOT NULL ,
        "priority_number" INTEGER DEFAULT 15,
        "timestamp" DATETIME DEFAULT CURRENT_TIMESTAMP,
        "description" VARCHAR 
```

我正在尝试编写 SQL 来给我接下来可以运行哪个进程的行。以下是一些示例数据：

```
id  identifier  priority_number timestamp   description
1   test1   15  2009-01-20 17:14:49 NULL
2   test2   15  2009-01-20 17:14:56 NULL
3   test3   10  2009-01-20 17:15:03 NULL
4   test4   15  2009-01-20 17:15:08 NULL
5   test5   15  2009-01-20 17:32:23 NULL
6   test6   14  2009-01-20 17:32:30 NULL
7   test7   7   2009-01-20 17:32:38 NULL
8   test8   20  2009-01-20 17:32:57 NULL
9   test9   7   2009-01-21 13:47:30 NULL
10  test10  15  2009-01-21 13:50:52 NULL 
```

如果我使用这个 SQL，我可以按正确的顺序获取数据：

```
select * from queue_manager order by priority_number, timestamp; 
```

这将为我提供顶部具有最低优先级编号（最重要）的项目，并且在这些优先级编号中，最早进入队列（按时间戳）在顶部。

我可以运行此查询，并且只获取第一行，但我宁愿使用 SQL 查询来执行此操作，该查询将为我提供位于队列顶部的进程的一行（在上面的示例数据中，行id=7）。

我尝试进行自我连接和子查询，但我一定有心理障碍——我似乎无法正确处理。

提前致谢！

**编辑**

我忘了提到我正在寻找一个独立于数据库的查询。我在 SQlite 中对此进行了模拟，但很有可能我会在 DB2 或 Oracle 中实现它。我曾想过在我的查询中使用“limit 1”类型的运算符，但这在不同的数据库引擎之间是不同的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T15:18:20.793

看看这是否有效：

```
select * from queue_manager where priority_number = 
(select min(priority_number) from queue_manager) and  
timestamp = (select min(timestamp) 
from queue_manager qm2 
where qm2.priority_number = queue_manager.priority_number) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T15:15:28.570

```
select * from queue_manager order by priority_number, timestamp LIMIT 1; 
```

至于所谓的“数据库独立性”，对于大多数现实世界的任务来说都是一个神话。通常，您甚至不能以独立于数据库的方式创建模式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T15:37:03.953

如果您希望它在 InnoDB 之类的东西上“并发安全”，请执行以下操作：

1) 添加一个“in_progress”字段。

2）关闭自动提交

3) SELECT * FROM queue_manager where in_progress = 0 order by priority_number, timestamp LIMIT 1 FOR UDPATE;

4) 更新 queue_manager SET in_progress = 1 其中 id = X;

5) 提交

6）做好工作。然后在完成满意后删除该行。有一个“主进程”处理/重新委托/清理旧的“in_progress”作业。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T15:24:12.670

最好的方法是依赖于数据库；与游标或其他结构的所有开销相比，为不同的目标 DBMS 提供不同的检索过程要简单得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T15:42:56.937

选择有限数量的行在不同风格的 SQL 中以不同的方式完成，因此根据您使用的方式，可能会有内置的方法来执行此操作。例如，在 MS SQL Server 中：

```
SELECT TOP 1
     identifier,
     priority_number,
     timestamp,
     description
FROM
     dbo.Queue_Manager
ORDER BY
     priority_number,
     timestamp 
```

要在 ANSI 兼容的 SQL 中执行此操作，应使用以下方法：

```
 SELECT
         QM1.identifier,
         QM1.priority_number,
         QM1.timestamp,
         QM1.description
    FROM
         Queue_Manager QM1
    LEFT OUTER JOIN Queue_Manager QM2 ON
         QM2.priority_number < QM1.priority_number OR
         (QM2.priority_number = QM1.priority_number AND QM2.timestamp < QM1.timestamp)
    /* If you're concerned that there might be an exact match by priority_number
and timestamp then you might want to add a bit more to the join */
    WHERE
         QM2.identifier IS NULL 
```

或者您可以尝试：

```
SELECT
     QM1.identifier,
     QM1.priority_number,
     QM1.timestamp,
     QM1.description
FROM
     Queue_Manager QM1
INNER JOIN
     (
          SELECT
               priority_number
               MIN(timestamp) AS timestamp,
          FROM
               Queue_Manager
          WHERE
               priority_number = 
                    (
                         SELECT
                              MIN(priority_number)
                         FROM
                              Queue_Manager
                    )
          GROUP BY
               priority_number
     ) SQ1 ON
          SQ1.priority_number = QM1.priority_number AND
          SQ1.timestamp = QM1.timestamp 
```

这两种方法都不考虑priority_number 和timestamp 中的完全匹配，所以如果你认为这是可能的（即使你不这样做），你需要添加一两行以使用标识符或其他东西再上一层保证唯一性。或者只是编写你的前端来处理偶尔返回两行的情况（也许只是忽略第二行 - 你下次会得到它）。

测试每种方法，看看哪种方法更适合您。

另外，您希望队列有多大？仅使用您的 ORDER BY 进行查询并且仅让前端检索第一行可能是合理的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T15:22:29.787

阅读[本](http://troels.arvin.dk/db/rdbms/#select-limit)节并选择为您提供最合适兼容性的变体。可能使用游标是唯一或多或少普遍兼容的方式，但有一些性能损失可能不值得（配置文件！）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T15:55:31.577

关系数据库不擅长管理队列。

尝试查看 Windows 世界中的 MSMQ、Java 世界中的 ActiveMQ 或商业世界中的 Websphere MQ。

这些产品只做一件事，管理队列，但它们做得很好。

# c++ - 有哪些可用于 C++ 的垃圾收集器？

> ID：465693
> 
> 赞同：6
> 
> 时间：2009-01-21T15:12:32.910
> 
> 标签：c++, garbage-collection

有哪些可用于 C++ 的垃圾收集器？你在使用它们中的任何一个吗？有什么结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T15:26:34.880

[Boost](http://www.boost.org/)库包含一些 shared_ptr 东西，它们基本上充当引用计数垃圾收集器。如果您接受 C++ 设计的[RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)原则，那么 auto_ptr 将满足您对“垃圾收集器”的需求。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-21T15:31:09.863

[wikipedia](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)#External_links)上列出了几个 C++ GC 。

但是，我不使用任何，RAII也是我的朋友。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-21T16:14:07.077

Boehm 垃圾收集器非常适合 C，但在 C++ 下使用起来很棘手。检查[http://www.hpl.hp.com/personal/Hans_Boehm/gc/gcinterface.html](http://www.hpl.hp.com/personal/Hans_Boehm/gc/gcinterface.html)上的“C++ 接口”部分。

我的观点是，如果您需要垃圾收集，请选择一种内置的语言。

C++ 的最佳通用解决方案是共享指针（例如来自 boost），您可以处理循环依赖关系。您可以做两件事： 1\. 设计没有循环依赖的事物 2\. 设计具有打破圆圈以允许回收对象的“安全销”的事物

要么使用 C++ 的垃圾收集器处理真正糟糕的、复杂的、难以调试的问题，要么处理完成后释放对象的更简单的经典问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-21T15:17:19.470

我个人听说过的唯一一个是[Boehm 垃圾收集器](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)，我确信其他人存在，但我没有处理过它们（或者也没有寻找它们）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-21T16:22:06.327

总有，咳咳：[C++/CLI——.NET](http://msdn.microsoft.com/en-us/magazine/cc163852.aspx?ppud=4) Framework 的 C++。那里的垃圾收集非常好。:p

虽然，老实说，有了他们在那里放置的所有语法糖，你几乎可以认为它是一种全新的语言，恰好可以很好地与 C/C++ 一起工作。

如果您没有将 C++ 作为一种语言结合使用，您还可以查看[D](http://www.digitalmars.com/d/)，它可以编译为 C++ 之类的本机代码（与 C++/CLI 不同），但也具有垃圾收集功能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-21T20:02:20.627

[你可以在这里](http://www.codeproject.com/KB/cpp/#C++%20/%20MFC%20/%20STL%20-%20Memory%20Management)找到几个实现。我从未尝试过其中任何一个，总的来说，我发现非确定性 GC 弊大于利。

# asp.net - 将 a:link 的 css 属性继承到 asp:label 文本属性

> ID：465699
> 
> 赞同：0
> 
> 时间：2009-01-21T15:15:13.297
> 
> 标签：asp.net, css

好的，这可能是一个不可能的问题，但我正在向现有的 cms 系统添加一个用户控件（Kentico 使用他们的 InlineControl 基类），并且我添加了一个标签，我已经覆盖了点击事件以在其下方显示一个 div 区域。我遇到的问题是继承颜色的已经设置的css属性，font-family；等等......从父页面到标签的文本。

我试图`<a href=""></a>`在标签周围放一个，它确实继承了正确的属性，但现在它需要点击并重定向，因为它遵循空白href。如果我只是将标签包装在 /a 中，它不会继承，因为 css 类正在寻找 a href 标记。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T15:29:37.883

好的，如果我理解正确，您希望标签文本像页面上的链接一样呈现？根据您正在开发的浏览器，它可能无法理解诸如`:link`或之类的东西`:hover`。如果您有以下 CSS：

```
a, label { color: blue; } // NOT a:link as only <a> tags can have href
a:hover, label:hover { text-decoration: underline; } 
```

..你是那里的一部分（IE6除外）。尝试在`<a>`标签中或标签周围添加标签时的另一个问题是点击事件被应用于`<label>`标签而不是`<a>`标签，因此链接被正常跟踪。如果您使用链接或两者的组合，请确保您覆盖链接上的点击事件`return false`以停止链接被跟踪。

我的偏好是将链接放在标签内，然后希望相关的表单字段以及显示的 div 都会获得焦点。你也不会有任何 IE6 样式问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T15:20:18.263

代替`<asp:Label >`控件，使用`<asp:HyperLink >`. 这将作为锚 ( `<a >`) 呈现为 html，因此样式正确。

此外，根据您的受众和您正在做的事情，这一切都可以在 javascript 中完成，而不是强制回发到服务器以重新呈现可见的 div。

# asp.net-mvc - ASP.NET MVC 在 ajax 链接上保存数据的状态

> ID：465703
> 
> 赞同：0
> 
> 时间：2009-01-21T15:16:31.203
> 
> 标签：asp.net-mvc, asp.net-ajax

[在史蒂夫的“编辑 ASP.NET MVC 中的可变长度项目列表”中](http://blog.codeville.net/2008/12/22/editing-a-variable-length-list-of-items-in-aspnet-mvc/)阅读并安装了该应用程序后，我发现它非常有用。另一方面，“添加另一个项目”ajax 中缺少一些东西链接，因为它不保存未提交记录的状态。当我单击链接并输入新的“礼物名称”时，再次单击相同的“添加另一个项目”链接后，我已经输入的数据会丢失. 我想存储（不丢失）在每个 ajax 调用（“添加另一个项目”）时输入到文本框的数据，并能够在提交调用中保存所有这些数据。

实际上，我试图从变量中重新加载已经输入但未提交的变量；但是，我无法访问包含已编辑但未提交的记录的表单数据。

任何帮助/想法将不胜感激，sarp

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T18:22:04.683

[http://www.codeplex.com/aspnet/WorkItem/View.aspx?WorkItemId=2893](http://www.codeplex.com/aspnet/WorkItem/View.aspx?WorkItemId=2893)

> 说明 如果您使用 Ajax.ActionLink() 在元素的顶部或底部插入附加内容，它还会重置该元素中任何输入控件的状态，从而丢失用户的更改。

这听起来像一个错误。

提供的代码应该保存多个添加的项目，但是当您单击“添加另一个项目”时，它会重置输入值。对于现有项目，这将是服务器提供的值（任何用户更改都会丢失），而对于其他新项目，这将是一个空字符串。

查看您的体验是否与错误链接中的行为相匹配，以及使用 IE 7 是否按预期工作。

# language-agnostic - 是否应该彻底了解运算符优先级？

> ID：465706
> 
> 赞同：3
> 
> 时间：2009-01-21T15:17:45.617
> 
> 标签：language-agnostic, operator-precedence

程序员是否应该彻底了解运算符优先级？使用大括号对表达式进行分组应该没问题，不是吗？我总是使用牙套来更安全。当被问及优先级问题时，我不能轻易回答。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-21T15:23:15.043

对于非常常见的运营商 - 是的，值得了解。如果您将括号括*起来*，否则将依赖于运算符优先级，您的代码将不可读（或容易与 Lisp 混淆）。

对于更晦涩的运算符 - 我明确*避免*学习它们。如果我开始认为有太多我无法合理地期望其他开发人员知道的事情是理所当然的，那么我将开始编写我可以轻松阅读但其他人无法阅读的代码。最好的例子是移位运算符。我什至不知道（当然 - 我有一个暗示）如果没有括号，哪些会被同等对待，但我绝对确定哪个更清楚：

```
int x = (y << shift) + offset; 
```

或者

```
int x = y << (shift + offset); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-21T15:22:00.053

是的，了解运算符优先级很重要。但是，我认为使用括号来完全清楚您的意图是有价值的。它将有助于可读性和可维护性。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-21T16:39:35.340

几年前，我看到了 C 的优先级表：

*   乘法和除法发生在加法和减法之前。
*   使用括号。

这有点过于简化，但它有正确的想法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-21T15:32:07.083

除了最常见的算术运算符外，我使用备忘单。如果有一点点棘手，我会使用明确的括号来明确我的意图。

我喜欢使用书面指南而不是记住优先级的原因是我经常使用多种语言工作，但规则略有不同。当我开始过度依赖记忆时，记住最常见运算符之外的任何内容都会导致错误。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-21T15:30:29.257

你应该理解它，但你不应该假设其他人会。我总是使用括号来明确优先级。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T15:22:59.037

我知道基础知识（例如，除法和乘法高于加法和减法），但我必须查找更深奥的东西。

我通常用括号来表达我的意图。我认为它读起来更好，并且避免了由于不正确的假设而导致的错误。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-21T15:23:00.690

它当然不会有什么坏处，并且可以帮助您阅读其他人编写的优先级微妙的代码。

但是，在实践中，最好不要假设那些维护您的代码的人将具有相同的技能，因此虽然应该能够阅读此代码，但您可能不想编写过多利用交互的代码。最好使用明确无误的结构，即使这意味着这里和那里有一些额外的括号。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-21T15:23:21.003

我和你在这件事上；使用大括号明确优先级始终是一个好主意。它使您的代码更易于阅读，并且您的意图很明确。

话虽如此，您应该知道在哪里查找有关运算符优先级的信息，以防您维护其他人的代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-21T15:23:42.950

您应该理解它以便能够阅读由没有在任何地方使用过括号的人编写的代码。

我不认为“总是大括号”是一个好的经验法则。有太多括号的代码变得比必要的更难阅读。像：

```
(a * b) + c 
```

很傻。某处存在平衡，而挑战在于找到它。像许多其他事情一样，它是关于应用常识的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-21T15:26:21.543

实际上：不是。如果它太复杂以至于您必须知道运算符优先级，那么您可能应该将表达式分解成块。另外，括号会拯救你！

专业：学习您选择的语言的顺序并不需要很长时间，并且在阅读其他人的代码时可以派上用场。如果不出意外，只需将其放在立方体墙上的备忘单上。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-21T16:10:33.030

Quick，在 T-SQL 中具有更高的优先级：AND 与 OR。

```
SELECT c.Name
FROM [Customer] c LEFT JOIN [Order] o
  ON c.CustomerKey = o.CustomerId
WHERE c.Name like 'B%'
  OR c.Name like 'Z%'
  AND o.CustomerId is NULL 
```

一旦您了解了这些运算符的优先级到您*依赖该优先级*的程度，您就注定要：

*   自己错误地使用它们。
*   遭受其他人的错误，他们不会学习这些运算符，也无法阅读您的代码。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-21T15:23:07.507

我认为了解基本的优先规则很重要。我发现了解细节并不值得花时间。主要是因为任何先行不明确的情况都可以通过一组简单的括号来解决。其次，因为不是每个人都知道它们，最好让你的代码对你组中的用户可读。

在大学的时候，我曾经牢记所有的优先规则。一旦我进入现实世界，我发现大多数人并没有熟记于心。如果我签入了一些取决于某些优先规则的有效代码，我始终会得到相同的反馈“添加括号以使其明显”。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-21T15:51:28.013

不！

如果您不确定优先级，那么其他阅读代码的人很可能会错误地解释它。

如果你不确定只是

```
( .. )
```

相关的代码位，那么对您或其他任何人来说都没有歧义。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-21T15:52:17.853

还有第三种选择。而不是记住所有这些规则，*或者*使用括号来确保一切......

如果您的表达式太长以至于不清楚首先发生什么，请将其分成多行，使用临时变量作为中间结果。然后，您将在没有括号的混乱情况下引入清晰度，并且您可以为临时变量使用描述性名称以使事情更加清晰。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-21T16:01:23.967

我从来没有 100% 地掌握优先规则，因为我使用多种语言（C、C++、perl、bash，偶尔还会使用一些 TCL/TK）。多年来，我曾多次使用过几种不同的汇编语言和一两个不合格的编译器。

我无法将完整详细的优先规则直接记在脑海中——我不得不经常在规则集之间切换。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-21T16:22:09.900

是 对于：

*   * / + -
*   && || 或者

否/也许：

*   << >> & | ^

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-06-24T13:22:05.290

写作时很容易自欺欺人`a == a & some_flag`。

即使我建议*不要*学习优先规则，为了清楚起见使用括号和临时规则（记住：代码是供*人类*阅读的），有时运算符优先表也会派上用场。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-02-15T13:37:26.907

假设您了解运算符优先级的概念（我假设每个人都知道，来自数学课），我宁愿不假设读者有任何知识......

...除了常识：正如已经指出的那样，`a * b + c`可以使用数学课上的知识来理解诸如此类的表达式。布尔表达式 like`a < 4 && a > 0`可以理解，因为比较绑定比`&&`.

另一方面，将按位运算符与普通算术混合没有常识，因此最好在此处使用括号。`&&`over的优先级也没有常识`||`（或者相反？），所以也使用括号。

# asp.net - 简单的 aspx 页面、客户端输入和 ssrs 报告查看器控件

> ID：465718
> 
> 赞同：2
> 
> 时间：2009-01-21T15:21:20.617
> 
> 标签：asp.net, reportviewer

我正在尝试使用一些 html 输入控件（而不是 asp.net 服务器控件）来捕获报表参数的输入，并希望将参数值发布到 ReportViewer 控件，并从报表服务器加载报表。

我是否必须模拟回发才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T00:54:18.197

好吧，这些值需要以某种方式到达服务器端，对吧？或者这是一个 AJAX 实现？

如果您使用手动 <FORM> POST 而不是基于 ASP.NET 的回发，您仍然可以从 Request.Form 集合中获取表单参数。即：`ServerControl1.ParameterToSet = ValidateInput(Request.Form["input1"])`。

（并确保仍然验证输入！这就是上面的 ValidateInput 方法提示。）;-)

# wpf - 如何使工具栏按钮可展开？

> ID：465724
> 
> 赞同：2
> 
> 时间：2009-01-21T15:22:16.183
> 
> 标签：wpf, toolbar

我想在我的工具栏上有一个按钮，它有一个小向下箭头，当我按下它时，会给我子工具栏选项。想想 Visual Studio 中的撤消/重做按钮；当我单击图标旁边的箭头时，它会弹出打开我可以返回的编辑列表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T15:27:33.630

使用拆分按钮。请参阅[此示例](http://www.codeproject.com/KB/WPF/WpfSplitButton.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T05:59:42.170

我使用 Menus/MenuItems 做了类似的事情。您可以根据自己的喜好设置 MenuItem 的样式，并且仍然可以实现切换下拉功能。

# mysql - 如何在 MySQL 函数中引发错误

> ID：465727
> 
> 赞同：73
> 
> 时间：2009-01-21T15:22:37.290
> 
> 标签：mysql, function, exception, stored-procedures

我创建了一个 MySQL 函数，如果为参数传递的值无效，我想引发错误。在 MySQL 函数中引发错误的选项有哪些？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-08-06T13:39:44.940

MySQL 5.5 引入了信号，类似于其他语言中的异常：

[http://dev.mysql.com/doc/refman/5.5/en/signal.html](http://dev.mysql.com/doc/refman/5.5/en/signal.html)

例如，在`mysql`命令行客户端中：

```
mysql> SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Custom error';
ERROR 1644 (45000): Custom error 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-04-22T18:31:03.460

它实际上是所有三个答案的组合。您调用一个不存在的过程来引发错误，然后声明一个退出处理程序来捕获您生成的错误。下面是一个示例，如果要删除的行设置了外键 id，则使用 SQLSTATE 42000（过程不存在）在删除前抛出错误：

```
DROP PROCEDURE IF EXISTS decount_test;

DELIMITER //

CREATE DEFINER = 'root'@'localhost' PROCEDURE decount_test ( p_id bigint )
DETERMINISTIC MODIFIES SQL DATA
BEGIN
  DECLARE EXIT HANDLER FOR SQLSTATE '42000'
    SELECT 'Invoiced barcodes may not have accounting removed.';
  IF (SELECT invoice_id 
       FROM accounted_barcodes
       WHERE id = p_id
    ) THEN
    CALL raise_error;
 END IF;
 DELETE FROM accounted_barcodes WHERE id = p_id;
END //

DELIMITER ; 
```

输出：

```
call decount_test(123456);
+----------------------------------------------------+
| Invoiced barcodes may not have accounting removed. |
+----------------------------------------------------+
| Invoiced barcodes may not have accounting removed. | 
+----------------------------------------------------+ 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-12T19:56:10.640

为什么不将 a 存储`VARCHAR`在声明的`INTEGER`变量中？

```
DELIMITER $$ DROP FUNCTION IF EXISTS `raise_error` $$
CREATE FUNCTION `raise_error`(MESSAGE VARCHAR(255)) 
RETURNS INTEGER DETERMINISTIC BEGIN
  DECLARE ERROR INTEGER;
  set ERROR := MESSAGE;
  RETURN 0;
END $$ DELIMITER ;
-- set @foo := raise_error('something failed'); -- or within a query 
```

错误信息是：

> 不正确的整数值：第 1 行的“错误”列“失败”

它并不完美，但它提供了一个非常具有描述性的消息，并且您不必编写任何扩展 DLL。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-31T23:45:42.923

在 MySQL 5 中，您可能会通过调用不存在的存储过程 (CALL raise_error) 或将无效值传递给查询（如将 null 传递给 NOT NULL 约束字段）来引发错误。这是 Roland Bouman 关于从 MySQL 函数中引发错误的有趣帖子：

[http://rpbouman.blogspot.com/2005/11/using-udf-to-raise-errors-from-inside.html](http://rpbouman.blogspot.com/2005/11/using-udf-to-raise-errors-from-inside.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-06T17:45:52.477

您还可以使用无效数量的参数调用现有函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T20:24:23.220

您必须定义异常处理程序。看看[http://dev.mysql.com/doc/refman/5.0/en/declare-handler.html](http://dev.mysql.com/doc/refman/5.0/en/declare-handler.html)

# sql-server - 删除行会导致更新触发器触发吗？

> ID：465747
> 
> 赞同：1
> 
> 时间：2009-01-21T15:27:48.903
> 
> 标签：sql-server, triggers

在 SQL Server 2000 中，默认情况下，DELETE 查询是否会导致执行表的 UPDATE 触发器？

我知道我可以定义一个将在 DELETE 和 UPDATE 上执行的触发器，但我想我会验证这实际上是首先需要的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T15:35:58.230

DELETE 不会触发 UPDATE 触发器。如果您定义了在 DELETE 和 UPDATE 上触发的触发器，那么它将在 DELETE 上执行，但那是因为它也是一个 DELETE 触发器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T15:30:38.710

将其转储到您的触发器中并自己检查

```
IF @@ROWCOUNT > 0 
BEGIN 
    IF EXISTS (SELECT 1 FROM inserted) 
    BEGIN 
        IF EXISTS (SELECT 1 FROM deleted) 
            PRINT 'update'; 
        ELSE 
            PRINT 'insert'; 
    END 
    ELSE 
        PRINT 'delete'; 
END 
```

# xml - 在 Axis2 中使用 XML 1.1

> ID：465748
> 
> 赞同：3
> 
> 时间：2009-01-21T15:27:53.630
> 
> 标签：xml, web-services, axis2, xml-1.1

我有一个 Web 服务和客户端，它们正在传递包含字符引用的字符串，例如 (0x1A)。这些在 XML 1.0 中无效，但在 XML 1.1 中有效。由于这些字符引用，Axis 的 XML 解析器会抛出异常。有没有办法强制它将响应解析为 XML 1.1，或者插入 XML 声明？（目前没有。）我研究过使用处理程序，但我的理解是它们在 XML 已经被解析之后被调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T20:26:38.690

我想你会在这方面度过一段艰难的时光。我的理解是 WSDL 2.0 标准是建立在 XML 1.0 之上的。那么，您调用的是哪种服务，它使用 WSDL（假设 XML 1.0）来描述自己，然后开始向您发送包含 XML 1.1 字符的消息？

定义 Axis2 服务时，可以在 services.xml 文件中定义它具有的处理程序。例如，在[这个页面上](http://ws.apache.org/axis2/0_95/userguide2.html#Step2_:Write_the_services_xml_file)，他们有一个使用 org.apache.axis2.receivers.RawXMLINOutMessageReceiver 的服务......我知道这不是你想要做的，但也许这是一个开始寻找或思考的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-01T12:57:06.437

你是在传递一个`InputStream`or`Reader`吗？如果是这样，您可以将源代码包装在另一个类中（如`BufferedReader`作品），但使用它来删除不必要的字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-20T13:58:13.587

还有另一种选择 - 让解析器将输入视为 XML 1.1。由于 Axis2 使用 Woodstox 解析器，您可以扩展`WstxInputFactory`and override 方法`createPrivateConfig()`：

```
@Override
public ReaderConfig createPrivateConfig() {
    ReaderConfig config = super.createPrivateConfig();
    config.enableXml11(true);
    return config;
} 
```

然后通过系统属性使用该自定义工厂：*-Djavax.xml.stream.XMLInputFactory=mypackage.MyWstxInputFactory*

请注意，这种解决方法仅适用于您绝对无法更改产生无效 XML 的有问题的 Web 服务的情况。可能会遇到副作用。

# .net - 重定向程序集绑定是否适用于使用测试运行器进行单元测试？

> ID：465754
> 
> 赞同：19
> 
> 时间：2009-01-21T15:30:23.187
> 
> 标签：.net, unit-testing, assembly-resolution

好的，这是我遇到的问题的完整描述：

我正在尝试使用[NUnit ExtensionMethods](http://code.google.com/p/nunit-extmethods/)，但是每当我使用 TestDriven.Net 运行包含其中一种扩展方法的测试时，或者如果我只是尝试使用测试运行程序 GUI（Icarus 或 NUnit）加载程序集，我就会得到 FileNotFoundException。

用头撞墙并进一步挖掘，我想我知道出了什么问题。提示反射器，是的，我可以看到 NUnit.Framework>ExtensionMethods.dll 引用了

```
nunit.framework, Version=2.4.6.0, Culture=neutral, PublicKeyToken=96d09a1eb7f44a77 
```

我当前包含的 nunit 版本是

```
nunit.framework, Version=2.4.8.0, Culture=neutral, PublicKeyToken=96d09a1eb7f44a77 
```

现在我以前从未使用过程序集重定向，但似乎只需添加一个带有以下行的 App.Config 就很简单了：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <runtime>
        <assemblyBinding  xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity
                    name="nunit.framework.dll"
                    publicKeyToken="96d09a1eb7f44a77" />
                <bindingRedirect oldVersion="2.4.6.0" newVersion="2.4.8.0" />
            </dependentAssembly>
        </assemblyBinding>
    </runtime>
</configuration> 
```

我的理解是调用 2.4.6 版本（这台机器上不存在）应该自动重定向到 2.4.8 版本。

但是这不起作用，我怀疑（但尚未确认）这是因为测试运行器不会自动读取 app.config 文件。

所以我的问题如下：

1.  我对问题的诊断是否正确？

2.  程序集重定向是适当的解决方案吗？我做得对吗？

3.  我如何让它与测试运行器一起工作？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-21T16:01:47.023

如果您将配置设置放在正确的 .config 文件中，这应该可以工作。哪一个取决于您用于运行测试的环境，但 NUnit 和 TestDriven.NET 都应该支持使用*testassembly* .dll.config。
至于这是适当的解决方案，我会说是的。唯一的另一种可能性是使用发布者策略文件，但您需要用于编译 NUnit 的私钥。

# asp.net-mvc - 将样式应用于 ASP.Net MVC ViewData 对象

> ID：465760
> 
> 赞同：1
> 
> 时间：2009-01-21T15:31:13.263
> 
> 标签：asp.net-mvc, css

我在 MVC 用户控件中有以下代码（已更改字段名称以保护无辜者）：

这些将显示在调用此控件的页面标题下方的列表中。

考虑到我对 CSS 的打击，我如何将标签应用于标题和这些字段，以便所有内容都正确排列？

非常感谢，

凯夫狗

**更新：** 目标是使用户控件中的字段位于下方，并在标题中的标签下方左对齐。我的第一个问题是向上面的 ViewData 项添加一个类。它们是在其他标签内还是在标签本身内应用的属性？我试过后者，但它似乎不是正确的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T17:13:00.063

从您的示例代码中可以看出，但您只是直接将字符串属性输出到网页中。在这种情况下，您需要用 span 或 div 包围输出字符串，以便为其分配一个类，如下所示：

```
<div class="foo"><%=ViewData.Model.foo %></div> 
```

另一方面，您可能会在其他地方使用 HTML 助手，在这种情况下，您可以将类传递给助手方法：

```
<%= Html.TextBox("foo", ViewData.Model.Foo, new { @class="foo" })%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T15:38:15.933

您可能想查看[960 网格系统](http://960.gs/)。它仍然需要一些 CSS，但它会让你的生活更轻松。网站上有一些示例/教程。

# vmware - 虚拟化问题

> ID：465762
> 
> 赞同：11
> 
> 时间：2009-01-21T15:31:46.633
> 
> 标签：vmware, virtualization, virtual-pc

我从未使用过虚拟化，并且正在努力加快速度。我的新桌面今天要来了，我特意买了它来尝试在一台机器上运行我的所有需求（即 vista 桌面、xp 桌面、vs 2005、vs20008、windows 服务器、sharepoint、sql server 2000/2005/2008 等）。过去，我总是在我的家庭办公室为这些应用程序中的每一个购买和设置单独的物理机器。（这就是为什么我的地下室有时会与小型数据中心混淆。）

我设置的这些虚拟服务器都不会有很重的负载，只是希望它们“在线”进行开发和测试。

所以我的问题是，哪个免费虚拟化是最容易（最快、最不痛苦）的设置？如果我的需求应该改变，是否有任何途径可以从一种工具更改为另一种工具？（即确保我首先做出“正确”决定有多重要？）

其次，由于我可能会运行 64 位 Vista 作为“基本”操作系统（除非有人说服我否则），您是否基本上不在该操作系统上安装任何东西，而是在虚拟机“内部”安装所有东西？甚至我的“主要”开发环境？（甚至我的电子邮件、办公套件等？）从我在这里阅读的消息来看，移动和备份整个“图像”的能力似乎是一个很大的优势，我不清楚这对于那些应用程序是否可行直接在“主机”上运行。

该机器是双 CPU 四核型号，具有 16G 内存和 15K 硬盘驱动器 - 所以它应该可以处理任何事情。

顺便说一句：我需要设置 Windows 平台以外的任何东西的可能性可能不到 5%，所以虽然能够设置 Unix/Linux 机器很好，但这不是必需的。

所以只是为了重新解决这个问题：哪个虚拟机会让我以最少的麻烦启动并运行，我真的不应该直接在“主机”操作系统上安装*任何东西吗？*关于让我的桌面虚拟机策略正确启动的任何其他建议 - 我真正想避免的任何错误都会让我陷入困境？

**更新 12/2011：**在这个原始问题和所有有用的回答之后，我最终选择了 VMware 工作站，并且没有后悔一秒钟。它不是免费的，但对于你得到的一切来说都很便宜。我怀疑其他产品也会起作用。

如果有人阅读本文正在考虑虚拟化，坦率地说，这太棒了——你还在等什么？在我的第一个 VMware 设置中，我将我的主要开发人员保留在“主机”操作系统中，并且只将 VM 用于我的测试服务器，但就在 6 个月前，我购买了一台较新的机器，现在在主机操作系统（Windows 7）中什么都不运行，并且运行我在一个或多个虚拟机中的所有工具/桌面。将虚拟机用于我的主桌面会导致性能轻微（非常轻微）下降，但能够随时提供完全可运行的备份，远远超过负面影响 - 我什至可以使用我的主桌面如果/当我上路时，我的笔记本电脑。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-21T15:38:38.333

我已经使用 VMWare 三年了，它真的很好。我的主机是最基本的 XP64，我有一个开发虚拟机和一个我同时启动的“办公室”虚拟机。根据我的经验，创建分配大量内存的 VM 无济于事，保持在 3gb 限制内，否则性能可能会很差（YMMV）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-21T16:17:06.527

我已经广泛使用[Microsoft Virtual PC](http://www.microsoft.com/downloads/details.aspx?FamilyID=04d26402-3199-48a3-afa2-2dc0b40a73b6&displaylang=en)和最近的[VMware](http://www.vmware.com/download/server/)来设置具有各种已安装应用程序组合的测试环境。

MS VPC 是两者中最省事的。这真的非常简单 - 创建 VM 只需指向并单击一些设置，然后您最好将 OS DVD 作为 ISO 文件附加，然后就可以离开（您需要为您安装的每个操作系统副本提供许可证）。启动操作系统后不要忘记安装虚拟机附加组件，因为这样可以使鼠标指针集成变得不那么笨重。

您只需复制 VHDD 文件即可备份整个计算机。

我遇到的 MS VPC 的唯一限制是，如果主机操作系统是 32 位，则无法安装 64 位来宾操作系统。

然而，这不是 VMware 的限制，这就是我开始使用它的原因。我已经创建了一台以 Windows 2003 Server x64 作为客户机，在 XP Pro x86 下运行的机器，它很好，包括 .NET 应用程序中编译器开关的效果。

VMWare 控制台有点笨拙，但功能齐全，一旦全部设置好，使用起来也很容易。

你永远不会回头。

只有一件事 - 预计会花费大量时间下载和安装 Windows 更新。我的虚拟机数量现在是 14，而且更新有点小问题，特别是如果我已经恢复了一个并且它可以恢复原状。其中之一是 Windows 7 beta，运行良好。

至于将一个转换为另一个......理论上你可以使用 VMWare 的转换器（也是免费的）来吸入和虚拟化整个物理计算机（我做过一次，它确实有效），我看不出为什么那不可能是MSVPC。你不能走另一条路。

我不在虚拟机中运行我的普通桌面。我希望我的正常开发环境尽可能快，并且性能确实受到很大影响。我了解 VMware 在这方面的表现优于 MS VPC，但我无法证实这一点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-21T16:33:18.070

免费的 Microsoft Virtual PC 很难被击败。VMware 的明显缺点是价格标签。VMware 和 Ms VPC 的优缺点在其他答案中得到了很好的概述，但这里还有几点：

*   请注意，如果 Vista 是您的主机环境，请确保您运行的是 Enterprise、Ultimate 或 Business。MS 不允许在 Vista Home Basic 或 Home Premium 上运行 VPC。VMware 不受此限制。这不是技术限制，而是许可限制。
*   在虚拟机中运行日常生产力应用程序可以使备份更容易，但它确实会减慢启动时间，因为您必须启动主机，然后启动虚拟机。增量备份很难，因为在主机上运行的任何备份软件都会将 VM 磁盘视为一个大文件，并且无法查看已更改和未更改的内容。因此，它将支持整个 blob。就备份存储而言，这可能会变得昂贵。对于增量备份，您可能会发现 Drive Snapshot 更容易：[http ://www.drivesnapshot.de/en/](http://www.drivesnapshot.de/en/)
*   作为运行测试平台的解决方案，您需要回滚到已知良好状态的系统，或者您无法击败 VM 的很少使用的系统。

我建议开始为您的测试机器尝试 Ms VPC 并习惯它。然后您可以稍后决定是否要完全虚拟化。从第一天开始完全虚拟化可能会很痛苦，您可能会发现您希望自己没有这样做。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-21T15:42:02.837

坦率地说，Virtualbox 可能会让您以最少的麻烦启动并运行，但它不支持虚拟化 SMP。如果做不到这一点，VMWare Server 是免费的，ESXi 也是免费的（除非您对 ESX 有一定的经验，否则配置起来更麻烦），而 VirtualPC 是一个可用的选项。

如果您不打算在主机操作系统上安装任何东西，请在带有 Hyper-V 机器的 Server 2k8 上运行它（这也为您提供了从 VHD 文件本地启动的选项）。就我而言，我不倾向于将虚拟机视为我的桌面。在主机操作系统上安装你想要的任何东西，让虚拟机运行机器现在运行的服务。毕竟，如果您想在 VM 中运行桌面，无论如何都可以在 ESX 机器上使用 RDP 来实现。

至于15k驱动器？呃……好吧。我希望它们是 SAS（不是 Velociraptors），因为您需要大量便宜的二级存储来存储快照、对性能不重要的图像（除了 SQL 服务器之外的任何东西），而 Velociraptors 则不完全相同可靠性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T10:43:46.680

我在我的 Vista 操作系统上设置了一个虚拟机并同时运行 xp。它很棒，因为某些应用程序不能在 64 位中运行（即那些旧的 16 位应用程序。）。您可以尝试 Microsoft Virtual PC 2007，它可能是最用户友好的。这是我用的。你也可以试试 Virtualbox。您可以设置一个分区并为新操作系统分配空间以使其正常工作。或者，如果您有一个备用格式化辅助驱动器，并且我希望分配 10gig 就足够了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T15:44:48.183

我使用 VMWare 开源服务器（最新的免费服务器），它非常易于使用和设置。而且它使用的资源不像其他一些资源那样多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T17:42:02.453

请记住，*许多*虚拟化平台缺乏对 OpenGL/DirectX/3D 的良好支持。如果您需要运行/测试这些类型的应用程序，您可能必须升级到非免费版本。

很多时候，应用程序可以通过软件 3D 仿真“运行”，但性能将难以承受。如果您使用 OpenGL 加速来执行图形或动画（例如科学应用程序），或者如果您正在构建 3D 应用程序（如 ArcGIS Explorer）的扩展，这是一个常见问题。

就个人而言，我不会在虚拟机上运行我的日常环境，因为我倾向于使用在虚拟机中性能不佳的应用程序，两个最大的违规者是桌面搜索和基于 3D 的应用程序。但是，如果您使用的是标准的办公产品套件并且不以任何方式（尤其是磁盘）推送系统，那么您应该没问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T22:20:35.887

查看非常适合调试的 VMware 记录/重播功能（[此处有很棒的视频演示）。](http://e.blip.tv/scripts/flash/showplayer.swf?file=http://blip.tv/rss/flash/1057363)它不包含在任何免费产品中，因此您必须支付许可证费用，但考虑到您还可以获得相当不错的 DirectX 支持，这是非常值得的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-24T18:26:59.570

另外，我建议研究一下 VMware 的[ESXi——](http://www.vmware.com/products/esxi/)它是他们完整 ESX 产品的精简免费版本。这是一个裸机管理程序安装，所以它不会看到像 Parallels、Virtual PC 或 VMware 自己的服务器工具这样的托管解决方案所看到的性能水平。

构建虚拟机需要付出一些努力，为此我建议使用 VMware Server（也是免费的）工具来构建您的虚拟机。

构建完成后，它们就可以在 ESXi 上运行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-04-05T07:00:09.687

我刚从虚拟化开始，并得到了这本书名为 microsoft virtualization 4.6 ...直到现在它真的帮助了我。如果你愿意，可以查看它...

[https://www.packtpub.com/getting-started-microsoft-application-virtualization-46/book](https://www.packtpub.com/getting-started-microsoft-application-virtualization-46/book)

# windows - 在 Windows (XP/2003) 下可以重定向到文件的数据量是否有限制？

> ID：465767
> 
> 赞同：2
> 
> 时间：2009-01-21T15:33:56.363
> 
> 标签：windows, redirect, file-io

我正在使用 WSF、VBS 和 JavaScript 脚本系统进行 Web 服务负载测试。负载驱动程序在我的工作站上运行，向远程应用程序服务器发送请求。我`WScript.StdOut.Write`在驱动程序脚本中使用来编写结果，并在运行测试时将输出重定向到文本文件：

```
cscript //nologo driver.wsf > test_results.txt 
```

当我使用只有 100 个事务的“烟雾测试”输入文件时，测试运行得相当快，而且没有问题。当我使用包含 200,000 个事务的“负载测试”输入文件时，驱动程序的性能会随着时间的推移而下降，直至运行它的工作站变得无响应并且正在使用 85% 的页面文件。我的`test_results.txt`文件大小刚刚超过 43GB。

我怀疑 Windows 正在将 StdOut 输出缓存到内存而不是将其写入文件；有没有人有其他解释或其他想法？将输出作为文件系统对象从我的脚本中管理而不是使用 StdOut 会更好吗？

更新：我的驱动程序基本上是这样做的（伪代码）：

```
Open input file 
Read a record 
While not EOF 
    Encode record 
    Create SOAP message containing record 
    Make web service request 
    Write time to get response to StdOut 
    Read another record 
End While 
Close input file 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T02:31:13.540

我非常怀疑问题出在重定向的输出上。我经常创建数百兆字节的重定向 StdOut 文件。

更有可能的是，有关编码记录、创建 SOAP 消息或发出 Web 服务请求的某些事情正在泄漏内存。

您可以考虑注释掉将响应时间写入 StdOut 的行，然后重新运行程序。如果程序仍然开始变慢，那么您已经消除了输出作为原因。

# svn - 使用 AnkhSVN 控制非解决方案文件

> ID：465769
> 
> 赞同：0
> 
> 时间：2009-01-21T15:34:09.497
> 
> 标签：svn, version-control, ankhsvn

我们的项目有一个不属于解决方案的文件夹。如何让 AnkhSVN 识别和管理这个文件以及解决方案文件？我不能将它添加为解决方案下的目录，因为该结构超出了我的控制范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T00:56:35.010

在许多项目类型中，您可以在属性网格中添加标记为“内容”或“无”的文件

这些文件不会成为您项目构建的一部分，但这些文件是解决方案的一部分，因此它们将被 AnkhSVN 跟踪。

为了更新工作副本，AnkhSVN 对工作副本中的项目根进行递归更新（很可能是工作副本根，除非您在 File->Subversion->Change Source Control 中更改它）。

文件应该是您的解决方案的一部分，这只是为了提交/挂起更改状态。

# javascript - Flash 在 IE6 和 IE7 中将自身定位在 javascript lightwindow 上的问题

> ID：465773
> 
> 赞同：2
> 
> 时间：2009-01-21T15:36:09.620
> 
> 标签：javascript, flash, internet-explorer

我在 IE6 和 IE7 中将自己置于所有内容之上的 Flash 对象存在问题。

Firefox 正确呈现页面。

我敢打赌，其他人也遇到过这个问题，并找到了一些解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T15:46:02.610

因为 Flash 在 IE 浏览器中的 ActiveX 控件中运行，所以它不遵循堆栈规则，因为 ActiveX 控件总是呈现在普通 HTML 内容上（除了下拉，烦人）。

有一种解决方法可以强制 Flash 服从，在您的对象标签中设置 wmode="transparent"，也可以选择嵌入标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T15:58:21.650

[wmode=transparent](https://stackoverflow.com/search?q=wmode+transparent)是要走的路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-22T18:38:43.277

是的，我在 lightwindow 面板上的 flash 菜单有问题，在对象中添加 wmode="transparent" 并嵌入标签有效。

# .net-3.5 - 我在哪里可以获得 VS 2008 的 Plinq？

> ID：465775
> 
> 赞同：3
> 
> 时间：2009-01-21T15:36:15.110
> 
> 标签：.net-3.5, plinq

由于它与框架集成，因此该包似乎已从网络上删除。有人可以指向我可以下载它并将其与我的 .net 3.5 应用程序一起使用的下载站点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T15:43:03.457

这个链接有用吗：http: [//www.microsoft.com/downloads/details.aspx? FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en)

这是CTP版本。

问候，

约臣

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-15T20:01:30.457

CTP 不再可用。来自 Nuget：

> 在 v1.0.2856.0 之前，此反向移植随 Reactive Extensions (Rx) 库一起提供。

[您可以从http://www.microsoft.com/en-us/download/details.aspx?id=24940](http://www.microsoft.com/en-us/download/details.aspx?id=24940)的 Reactive Extensions for .Net或从[http://nuget.org/packages](http://nuget.org/packages/TaskParallelLibrary)的 Nuget下载不受支持的版本[/任务并行库](http://nuget.org/packages/TaskParallelLibrary)

# maven-2 - 在引用 POM 而不是定义 POM 时评估嵌套的 Maven 属性

> ID：465777
> 
> 赞同：7
> 
> 时间：2009-01-21T15:36:51.863
> 
> 标签：maven-2, maven-plugin, findbugs

我在我的父 pom 中定义了一个报告配置，它将在每个子项目和孙项目中运行。

像这样：

```
<reporting>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>findbugs-maven-plugin</artifactId>
            <version>1.2</version>
            <configuration>
                <xmlOutput>true</xmlOutput>
                <threshold>Low</threshold>
                <effort>Min</effort>
                <includeFilterFile>${basedir}/findbugsFilter.xml</includeFilterFile>
            </configuration>
        </plugin>
    </plugins>
</reporting> 
```

问题是每个孩子都插入了它的`basedir`而不是定义的 POM。我想我正在寻找相当于 ANT 的`<property name="name" location="${basedir}"/>`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T22:55:41.957

**简短版本：**[findbugs-maven-plugin](http://mojo.codehaus.org/findbugs-maven-plugin/examples/multi-module-config.html)的文档中描述了您的问题的解决方案。您只需为包含您的构建配置创建一个单独的（顶级）项目，`findbugsFilter.xml`并将该项目作为依赖项引用。

**长版本：**不幸的是，在 Maven 中从父项目或兄弟项目访问资源有点复杂。原因：在构建子项目时，Maven 不能假定父模块在文件系统中的上一级或兄弟项目在同一级别。事实上，它不能假设这些项目中的任何一个都已在某个地方签出！只签出一个子项目并按原样构建它是完全合法的。因此，当使用 Maven 构建时，所有内容（很少有例外）都是从本地存储库加载的。这就是为什么您必须为要在多个模块中使用的资源创建单独的项目。然后可以将单独的项目添加为依赖项，并由一堆不同的 Maven 插件使用。示例如下：[checkstyle](http://maven.apache.org/plugins/maven-checkstyle-plugin/)findbugs 插件用于读取配置文件，[maven-dependency-plugin](http://maven.apache.org/plugins/maven-dependency-plugin/)用于将外部文件复制到您的工件中，或者[properties-maven-plugin](http://haroon.sis.utoronto.ca/zarar/properties-maven-plugin/)用于加载外部属性文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-26T16:11:25.217

我有一个类似的问题，我希望子 POM 具有与父 POM 相同的属性文件，但我无法使 ${project.parent.basedir} 变量工作。

然而，我所做的是在父级中创建一个变量，并在每个子级 Pom 中覆盖相同的变量（这也适用于 Grand-pom ......虽然我没有）。

例如：

```
Parent POM:
    <properties>
        <my_basedir>${basedir}</my_basedir>
    </properties>

Child POMs:
    <properties>
        <my_basedir>${basedir}/../</my_basedir>
    </properties> 
```

现在我只在父级中列出过滤器一次，其他人都会得到它。如果您移动孩子，您只需更改相对路径。

```
 <filters>
       <filter>${my_basedir}/myfile.properties</filter>
   </filters> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T15:43:56.577

我不确定这是否可以解决您的问题，但我有两个想法可以尝试：

*第一个想法*

在父 pom 中定义一个属性，并在报告配置中使用它：

```
<properties>
    <parent-basedir>${basedir}</parent-basedir>
</properties>
...
<reporting>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>findbugs-maven-plugin</artifactId>
            <version>1.2</version>
            <configuration>
                <xmlOutput>true</xmlOutput>
                <threshold>Low</threshold>
                <effort>Min</effort>
                <includeFilterFile>${parent-basedir}/findbugsFilter.xml</includeFilterFile>
            </configuration>
        </plugin>
    </plugins>
</reporting> 
```

*第二个想法*

另一个想法是使用 ${project.parent.basedir}：

```
...
<includeFilterFile>${project.parent.basedir}/findbugsFilter.xml</includeFilterFile>
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T17:43:12.560

这与[您的其他问题有关](https://stackoverflow.com/questions/462151/which-scopes-are-present-during-maven-site-lifecycle)。

您是否放弃了将过滤器文件部署在单独的工件中的想法？为什么？

绝对路径的问题在于，当您构建子项目时，您无法保证父项目的源代码会出现在机器上。这就是拥有存储库机制的全部意义所在。

您是否尝试过我对您的其他问题的建议？

# windows - 异常日志文件的最佳位置 (Windows)

> ID：465785
> 
> 赞同：14
> 
> 时间：2009-01-21T15:39:37.303
> 
> 标签：windows, logging, directory

异常日志应该去哪里的问题已经在这里讨论过一次或两次（或更多），其中一个建议是应用程序永远不应该写入安装文件夹。
但是，如果我将日志放在 %appdata% 的某个位置，这意味着每个用户都有自己的一组日志。我更喜欢将所有日志放在一个位置。
在最后一个 MSDN mag 问题中，安装文件夹中有一个单独的日志子文件夹（例如 %programfiles\myapp\logs）被称为规则中的有效例外。当然，此文件夹的 ACL 必须相应设置。
在安装文件夹中有一个日志文件夹是常见的做法还是绝对不行？你把你的异常日志放在哪里？

编辑：
事实上，我们使用的是 log4net，所以日志的位置和类型是完全可配置的。但是，我希望有一个合理的默认值。我更喜欢在事件日志上有一个文件。对于大多数用户来说，文件比事件日志更容易处理。
但是，让我们假设我想要文件。安装文件夹中有日志文件夹可以吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T15:42:07.563

对于 Windows，使用事件日志。创建自己的日志非常容易，或者您可以将消息添加到标准日志之一。

这样做的好处是，地球上几乎所有的技术人员（和程序员）都希望在事情不顺利时会在事件日志中显示一些内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-21T16:37:55.250

要在没有特殊 ACL 的情况下登录到公共文件，请使用类似

```
string saveFolder = Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) + @"\MyCompany"; 
```

其中引用了文件夹

```
C:\Documents and Settings\All Users\Application Data\MyCompany 
```

在 XP 上，以及类似的东西

```
C:\ProgramData\MyCompany 
```

在 Vista 下。您需要在某个时候验证该文件夹是否存在 - 可能在应用程序启动时。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-21T16:03:11.780

使用较新的 OS vista 和 win 2008 写入程序文件目录可能需要 ACL 或虚拟化到用户的文件夹。我建议在 %AllUsersProfile% 下设置一个目录，这样您就可以为所有用户的日志文件提供一个公共位置，并且您的应用程序无需以管理员身份运行即可将它们写入那里。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T15:57:11.527

如果您不能或不会使用事件日志，那么对于放置日志文件的位置确实没有任何标准化。您只需要确保该位置有据可查，并且您的代码中确实需要有逻辑，以确保日志文件可以增长到的大小存在限制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T15:45:16.590

这主要取决于应用程序，这就是为什么我猜有这么多可能的答案。

对于网站，我会在服务器上有一个“C:\log”，然后是单个网站的“C:\log\website”，并使用 Log4Net 或类似的。

对于 Web 服务、窗口服务、计划作业等，我会写入 Windows 事件日志。我的电脑 -> 管理 -> 系统工具 -> 事件视图 -> (我的服务)

对于部署在我控制的环境中的 Windows 应用程序（即内部公司应用程序），我会让它通过电子邮件发送“IT 团队”异常报告。

对于分发给未知用户的 Windows 应用程序。没做什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T16:01:19.367

您需要注意写入日志文件夹的权限。

这是使用应用程序数据文件夹而不是安装文件夹的关键原因之一，因为在 Vista 和向前发展中，默认情况下您可能无权写入安装文件夹。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-21T16:15:47.743

我认为您应该更喜欢 AppData 文件夹，但如果您想将所有日志合并到一个文件夹中，则使用所有用户目录（Environment.SpecialFolder.CommonApplicationData）并在您的应用程序文件夹中为每个用户创建子文件夹。这样，您不仅可以摆脱权限问题，还可以避免弄乱自己的空间:) 恕我直言。

# wix - WiX：CopyFile 属性

> ID：465788
> 
> 赞同：8
> 
> 时间：2009-01-21T15:40:37.300
> 
> 标签：wix

在安装时，我想选择将一些 .ini 文件从 SOURCEDIR 复制到 TARGETDIR，这意味着从 .msi 文件所在的目录到应用程序设置到的目标文件夹。

我做了`<CopyFile Id="CopyIniFile" DestinationProperty="INSTALLDIR" SourceProperty="SOURCEDIR" SourceName="Dreem15.ini" Delete="no" />`，但它似乎什么也没做。日志文件没有多大帮助。

我已经成功地用 CopyFile 做了一个更复杂的场景，我对这个简单的场景感到困惑。

编辑：我在 MoveFile 表中有这些行：

```
|FileKey |组件 |SourceName |SourceFolder|DestFolder|选项
|CopyIniFile |CoAppLicAndIni|Dreem15.ini |SOURCEDIR |INSTALLDIR|0
|MoveDataFile|CoAppLicAndIni|Dreem10_Personal.mdf|DB_DIR10 |INSTALLDIR|0
```

第二个正在工作。`DB_DIR10`像这样在注册表中搜索

```
<属性 ID="DB_DIR10">
    <RegistrySearch Id='DbDirSearch10' Type='raw' Root='HKLM' Key='Software\$(var.CompanyName)\$(var.MsdeInstance)' Name='Dreem10_Personal' />
</属性>
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T20:10:02.763

根据 windows 安装程序文档中的[sourcedir 属性](http://msdn.microsoft.com/en-us/library/aa371857(VS.85).aspx)，它指向“包含源压缩包文件或安装包的源文件树的根目录”。

因此，要么您不知道 SourceDir 是预定义的 Windows 安装程序属性，要么您正试图从包含 msi.xml 的安装介质中复制未打包的文件。在后一种情况下，像普通组件一样安装文件可能更有意义，以便正确卸载它。

**编辑：**我已经测试了“从安装介质复制”方案，它对我有用。另外，我已经安装了

```
misexec /lvx* install.log /i mymsi.msi 
```

并且日志确实显示了正在复制的文件。日志在您的情况下说什么？

**Edit2：**虽然 CopyFile 对我有用，但更好的解决方案是向您的 wxs 添加未压缩的介质，如下所示：

```
<Media Id='2'/> 
```

然后为您的可自定义配置文件调整 File 元素，如下所示：

```
<File Source='path\to\default\config.ini' Compressed='no' DiskId='2' /> 
```

这将使安装程序在与 msi 相同的文件夹中查找 config.ini，结合了可定制性和干净卸载的优点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T15:56:02.403

您可以`DestinationDirectory="INSTALLDIR"`改用，还是必须即时创建属性？

[WIX Wiki CopyFile 元素](http://wix.sourceforge.net/manual-wix2/wix_xsd_copyfile.htm)

这个 wxs，会将文件放入 MSI

```
<Component Id="myIni.ini" Guid="*">
  <File Id="myIni.ini" Name="myIni.ini" KeyPath="yes" Source="!(wix.Files)\myIni.ini">
    <CopyFile Id="CopyIni" DestinationProperty="TARGETDIR" />
  </File>
</Component> 
```

# python - 从文本生成关键字的简单方法是什么？

> ID：465795
> 
> 赞同：18
> 
> 时间：2009-01-21T15:43:36.157
> 
> 标签：python, perl, metadata

我想我可以取一个文本并从中删除高频英语单词。通过关键字，我的意思是我想提取最能表征文本内容的词（标签）。它不一定是完美的，一个好的近似值非常适合我的需求。

有没有人做过这样的事情？你知道有这样的 Perl 或 Python 库吗？

Lingua::EN::Tagger 正是我所要求的，但是我需要一个也可以用于法语文本的库。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-21T16:14:29.853

“高频英语单词”的名称是[停用词](http://en.wikipedia.org/wiki/Stop_words)，有很多可用的列表。我不知道有任何 python 或 perl 库，但是您可以将停用词列表编码为二叉树或散列（或者您可以使用 python 的frozenset），然后当您从输入文本中读取每个单词时，检查它是否是在您的“停止列表”中并将其过滤掉。

请注意，删除停用词后，您需要进行一些[词干](http://en.wikipedia.org/wiki/Stemming)处理以规范化结果文本（删除复数、-ings、-eds），然后删除所有重复的“关键字”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-21T16:44:49.497

您可以尝试使用 perl 模块[Lingua::EN::Tagger](http://search.cpan.org/~acoburn/Lingua-EN-Tagger-0.15/Tagger.pm)来获得快速简便的解决方案。

更复杂的模块[Lingua::EN::Semtags::Engine](http://code.google.com/p/lingua-en-semtags-engine/)使用 Lingua::EN::Tagger 和 WordNet 数据库来获得更结构化的输出。两者都非常易于使用，只需在安装模块后查看 CPAN 上的文档或使用 perldoc。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-21T17:47:07.717

要查找文本中最常用的单词，请执行以下操作：

```
#!/usr/bin/perl -w

use strict;
use warnings 'all';

# Read the text:
open my $ifh, '<', 'text.txt'
  or die "Cannot open file: $!";
local $/;
my $text = <$ifh>;

# Find all the words, and count how many times they appear:
my %words = ( );
map { $words{$_}++ }
  grep { length > 1 && $_ =~ m/^[\@a-z-']+$/i }
    map { s/[",\.]//g; $_ }
      split /\s/, $text;

print "Words, sorted by frequency:\n";
my (@data_line);
format FMT = 
@<<<<<<<<<<<<<<<<<<<<<<...     @########
@data_line
.
local $~ = 'FMT';

# Sort them by frequency:
map { @data_line = ($_, $words{$_}); write(); }
  sort { $words{$b} <=> $words{$a} }
    grep { $words{$_} > 2 }
      keys(%words); 
```

示例输出如下所示：

```
john@ubuntu-pc1:~/Desktop$ perl frequency.pl 
Words, sorted by frequency:
for                                   32
Jan                                   27
am                                    26
of                                    21
your                                  21
to                                    18
in                                    17
the                                   17
Get                                   13
you                                   13
OTRS                                  11
today                                 11
PSM                                   10
Card                                  10
me                                     9
on                                     9
and                                    9
Offline                                9
with                                   9
Invited                                9
Black                                  8
get                                    8
Web                                    7
Starred                                7
All                                    7
View                                   7
Obama                                  7 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-21T16:40:40.097

在 Perl 中有[Lingua::EN::Keywords](http://search.cpan.org/perldoc?Lingua::EN::Keywords)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-21T15:54:43.997

做你想做的最简单的方法是......

```
>>> text = "这是一些示例文本"
>>> words = [set(text.split(" ")) if len(word) > 3]
>>> 话
['this', 'some', 'sample', 'text']

```

我不知道有什么标准模块可以做到这一点，但是用查找一组常见的英语单词来替换对三个字母单词的限制并不难。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-22T14:36:23.343

一种衬线解决方案（超过两个字符的单词出现两次以上）：

```
perl -ne'$h{$1}++while m/\b(\w{3,})\b/g}{printf"%-20s %5d\n",$_,$h{$_}for sort{$h{$b}<=>$h{$a}}grep{$h{$_}>2}keys%h' 
```

**编辑：**如果想按字母顺序对频率相同的单词进行排序，可以使用这个增强的：

```
perl -ne'$h{$1}++while m/\b(\w{3,})\b/g}{printf"%-20s %5d\n",$_,$h{$_}for sort{$h{$b}<=>$h{$a}or$a cmp$b}grep{$h{$_}>2}keys%h' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-12-23T19:58:21.807

TF-IDF（词频 - 逆文档频率）就是为此而设计的。

基本上它会问，与所有文档相比，该文档中哪些词是频繁出现的？

它会给所有文档中出现的单词打低分，给给定文档中频繁出现的单词打高分。

您可以在此处查看计算工作表：

[https://docs.google.com/spreadsheet/ccc?key=0AreO9JhY28gcdFMtUFJrc0dRdkpiUWlhNHVGS1h5Y2c&usp=sharing](https://docs.google.com/spreadsheet/ccc?key=0AreO9JhY28gcdFMtUFJrc0dRdkpiUWlhNHVGS1h5Y2c&usp=sharing)

（切换到底部的 TFIDF 选项卡）

这是一个python库：

[https://github.com/hrs/python-tf-idf](https://github.com/hrs/python-tf-idf)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T15:54:08.163

我认为仍然保持简单的最准确方法是计算源中的单词频率，然后根据它们在普通英语（或任何其他语言）使用中的频率对它们进行加权。

较不常用的词（如“咖啡屋”）比出现频率更高的词（如“狗”）更有可能成为关键字。尽管如此，如果您的消息来源提到“狗”500 次和“咖啡屋”两次，则“狗”更有可能是关键字，即使它是一个常用词。

决定权重方案将是困难的部分。

# asp.net - 如何使用外部 css 覆盖内联样式？

> ID：465805
> 
> 赞同：6
> 
> 时间：2009-01-21T15:45:31.643
> 
> 标签：asp.net, css

我正在尝试重新设置由 asp.net gridview 控件生成的表格。我遇到的问题是 gridview 正在生成内联样式。如何让浏览器呈现我的 css 而不是 html 样式属性？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-21T15:48:10.297

您可以在您的 CSS 文件中尝试[!important 。](http://www.w3.org/TR/CSS2/cascade.html#important-rules)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T15:48:28.877

你可以使用 !important; 但这不适用于所有浏览器。

这是[一篇关于 !important 用法的文章](http://www.yellowjug.com/web-design/the-importance-of-important-in-css/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T15:47:31.560

[您可以尝试按照本文](http://www.w3.org/TR/CSS2/cascade.html)将“！important”附加到您的 css 样式定义中，或者遵循 Ryan Lanciaux 的先前建议

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T15:56:48.843

根据CSS规范，元素选择器的特异性为1，类选择器的特异性为10，ID选择器的特异性为100，内联样式的特异性为1000。较高的特异性会覆盖较低的特异性，所以内联风格总是赢。但是，有一条出路。**!important**声明会覆盖所有不重要的声明。无论样式的来源是什么，它都会输给带有**!important**声明的任何东西。

资料来源：Eric A. Meyer 的 CSS 网页设计。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T15:47:23.323

我认为您需要使用 JavaScript 覆盖样式。[jQuery](http://jquery.com/)将使这非常容易。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T15:51:04.940

您可能想看看这个：http: [//justgeeks.blogspot.com/2008/09/override-any-css-style-even-inline.html](http://justgeeks.blogspot.com/2008/09/override-any-css-style-even-inline.html)。使用 !Important 修饰符来实现它

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T15:48:04.120

你在使用主题吗？主题创建内联样式。要摆脱它们，您可以关闭 gridview 的主题：

```
<asp:GridView EnableTheming="false" ... /> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T15:49:53.273

不幸的是，内联 CSS 始终是应用于元素的最后一个样式，因此内联样式将始终覆盖外部样式。

如果 Gridview 生成的样式适合您，请查看 ASP.NET CSS Friendly Control Adapters ( [http://www.asp.net/CssAdapters/](http://www.asp.net/CssAdapters/) )。这是一个伟大的项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-21T19:32:22.467

内联样式优先于外部样式。**除非您使用!Important**，否则它不能被覆盖。

 **# python - 用于 Python 的类似 Delphi 的 GUI 设计器

> ID：465814
> 
> 赞同：8
> 
> 时间：2009-01-21T15:47:39.783
> 
> 标签：python, user-interface, form-designer

是否有任何用于 Python 的 GUI 工具包，带有类似于 Delphi 的表单设计器，例如，可以拖放控件以形成表单、移动它们等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T16:02:16.010

我推荐使用[Qt Designer的](http://www.qtsoftware.com/products/appdev/developer-tools/developer-tools?currentflipperobject=73543fa58dda72c632a376b97104ff78)[PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/intro)（现在来自诺基亚）。Qt 设计器生成 XML 文件 (.ui)，您可以使用名为 的实用程序将其转换为 Python 模块，或从 Python 程序动态加载。`pyuic`

您*必须*在不同的编辑器中编写您的 Python 代码，即 Designer 只是 GUI 设计器部分，而不是完整的 IDE。他们有一个名为 Qt Creator 的测试版 IDE，但我认为现阶段它对 Python 的支持不是很好。

如果您更愿意使用[wxPython](http://www.wxpython.org/)，[wxGlade](http://wxglade.sourceforge.net/)将输出 Python 代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T16:20:28.127

使用 Glade + PyGTk 在 Python 中进行 GUI 编程。Glade 是一个允许您通过拖放小部件来创建图形界面的工具。反过来，Glade 会生成 XML 中的接口定义，您可以使用 libglade 将其与您的代码挂钩。查看[Glade](http://glade.gnome.org/)的网站了解更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T16:21:20.057

如果您使用 wxPython，请查看[BoaConstructor](http://boa-constructor.sourceforge.net/)，它是一个带有 GUI 设计器的完整 Python IDE。

# .net - 如何反序列化带有前缀命名空间但没有 ns 前缀元素的 XML 文档？

> ID：465825
> 
> 赞同：3
> 
> 时间：2009-01-21T15:50:45.097
> 
> 标签：.net, xml, xml-serialization, xml-namespaces

我有一个来自外部来源的 XML 文档。

```
<?xml version="1.0" encoding="utf-8"?>
<ns0:Info xmlns:ns0="http://www.ZomboCorp.com/">
  <Name>Anthony</Name>
  <Job>Developer</Job>
</ns0:Info> 
```

我需要将它反序列化为这样的对象。

```
public class Info
{
    public String Name { get; set; }
    public String Job { get; set; }
} 
```

按原样使用，`Serializer`抛出一个`InvalidOperationException`

> `<Info xmlns='http://www.ZomboCorp.com/'>`没想到。

如果我添加`[XmlElement(Namespace = "http://www.ZomboCorp.com/")]`到类定义中，则`Serializer`返回一个`Info`具有空属性的新对象。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-21T17:02:00.927

您还必须将 XmlElement 属性添加到每个属性，将 Namespace 属性设置为空字符串（因为在您的情况下不会继承命名空间）。

您对 Info 的定义应如下所示：

```
XmlRoot(Namespace = "http://www.ZomboCorp.com/")]
public class Info
{
    [XmlElement(Namespace = "")]
    public String Name { get; set; }
    [XmlElement(Namespace = "")]
    public String Job { get; set; }
} 
```

然后它将正确反序列化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-21T21:06:33.727

我使用了[xsd.exe](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx)（一个 VS 工具）并从 XML 文件生成了一个模式，然后从该模式生成了一个类文件。它建议

```
[XmlType(AnonymousType = true, Namespace = "http://www.ZomboCorp.com/")]
[XmlRoot(Namespace = "http://www.ZomboCorp.com/", IsNullable = false)]
public class Info
{
    [XmlElement(Form = XmlSchemaForm.Unqualified)]
    public String Name { get; set; }
    [XmlElement(Form = XmlSchemaForm.Unqualified)]
    public String Job { get; set; }
} 
```

但是，我能够逃脱

```
[XmlType(AnonymousType = true)]
[XmlRoot(Namespace = "http://www.ZomboCorp.com/")]
public class Info
{
    [XmlElement(Form = XmlSchemaForm.Unqualified)]
    public String Name { get; set; }
    [XmlElement(Form = XmlSchemaForm.Unqualified)]
    public String Job { get; set; }
} 
```

# javascript - 单击表单字段部分时在 FireFox3 中打开文件浏览窗口？

> ID：465852
> 
> 赞同：0
> 
> 时间：2009-01-21T15:59:19.243
> 
> 标签：javascript, css, file, input

单击`<input type="file" />`FireFox3 中的文本框部分时，将打开一个文件浏览窗口。

这在 IE7 中不会发生。您必须单击“浏览”按钮才能打开文件浏览窗口。

当用户单击文本框区域时，如何防止文件浏览窗口在 FireFox 中打开？我想要它，所以它只有在按下按钮时才会打开。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-21T16:02:24.713

为什么你不能不理会预期的行为？大多数使用 FireFox 的人都希望它会发生。除非您没有说明实现这一点的实际“设计”原因，否则请不要尝试更改它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-21T16:11:14.760

Firefox 这样做是为了防止使用文件输入的漏洞。

[请参阅此博客条目](http://codangaems.blogspot.com/2008/06/firefox-3s-file-upload-box.html)的结尾和下面的一些评论。

我同意这很烦人，不是作为网站设计师/开发人员，而是作为 Firefox 的用户；有时我只想粘贴文件名而不必单击对话框。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T16:06:00.777

即使你真的想这样做，我认为这是不可能的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T17:01:56.107

> 当用户单击文本框区域时，如何防止文件浏览窗口在 FireFox 中打开？

用另一个元素掩盖它。

```
<div style="position: relative">
    <input type="file" />
    <div style="position: absolute; top: 0; left: 0; width: 11em; height: 2em;"> </div>
</div> 
```

但不要这样做。它非常脆弱，在许多情况下都会破裂。

> 我想要它，所以它只有在按下按钮时才会打开。

不过，我怀疑您的用户会喜欢它。它从浏览器中删除了预期的功能，并且不会用更好的东西代替它。或者实际上任何东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T16:30:49.617

是的，它没有，网页对此无能为力。

我不知道可以控制这个的 FF 配置设置，所以你被 #3 困住了：

使用扩展程序*可能*会改变这种行为，但是您必须让您的用户安装您的扩展程序（对于内部应用程序可能是可行的）并处理它可能引入应用程序的错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-16T01:37:08.890

一个简单的解决方法不是创建一个文本输入字段和一个按钮，该按钮用于触发文件浏览器，然后将信息填充回文本字段？我对这一切都很陌生，并且正在阅读很多关于这个问题的问题，包括 FF3 没有将相同的 css 样式应用于 input=file 的事实，因为它在以前的版本中所做的。

# variables - 您如何建议表示静态类成员？

> ID：465856
> 
> 赞同：1
> 
> 时间：2009-01-21T16:01:12.907
> 
> 标签：variables, naming-conventions

我有一个命名策略来表示代码实体（变量、方法等）的性质，它解释了范围、实体类型和可变性的最常见排列，但我无法选择一种表示私有静态的方式成员字段（不是属性）。

有哪些推荐的表示方式？

> **更新：**对于它的价值，我知道这已经过时了，尤其是对于 C#，微软反对它。我应该明确指出，我的目标不是提供一定程度的“文档”，而只是能够以尽可能少的动作和交叉引用获得尽可能多的信息。
> 
> 我个人认为，如果可以将标识符限制为传达有关目的的信息，并将代码上下文信息留给 IDE 传达，那将是理想的。但是，由于 VS2008 似乎没有提供基于范围或可变性的突出显示/样式选项，并且由于需要鼠标移动和等待，我不觉得工具提示在这方面特别有效，我发现自己的选择有限.

作为参考，我主要使用 C# 进行编程，下面是我当前命名约定的示例：

*   方法参数或局部变量：thisIsMyVariable
*   实例级私有字段：_thisIsMyVariable
*   公共实例级或类级属性或方法：ThisIsMyVariable
*   常数：THIS_IS_MY_VARIABLE

对于私有静态字段，我一直在考虑这些：

*   s_thisIsMyVariable
*   _ThisIsMyVariable

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T16:08:22.033

我`s_`用于静态成员和`m_`例如成员。

但是，您所要求的以及我所做的违反了 Microsoft 推荐的 C# 命名约定，这些约定在此处列出：[类型成员的名称](http://msdn.microsoft.com/en-us/library/ms229012.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T16:23:19.023

我让我的 IDE 以不同的方式格式化它们。更容易看到斜体=静态。然后，当我必须重构代码时，我也不必担心重命名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T16:19:04.697

您应该遵守您的语言已有的约定。您的 IDE 应该明确哪个变量是公共/私有、静态/实例……在我们使用语法着色编辑器之前，需要将变量的可见性或类型放在其名称中。但是现在我们有了它，我发现如果代码没有杂乱无章的前缀，它会更清晰，更容易阅读。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T16:08:35.920

我不区分私有静态变量或实例变量。它们都是驼峰式的，带有一个前导下划线：

```
private static readonly ILog _someLog = ...; 
```

而且我认为我从来没有因此而摸不着头脑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T16:18:23.903

我使用 g_ ，因为静态变量只不过是一个美化的全局变量

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T16:11:06.693

我毫不怀疑这将退化为关于谁的方式更好的争论（将这些大括号放在同一行该死！）但除了常量之外，我不喜欢做或看到这样的事情。*我可以看到你背后的推理，但除非你是一个人的商店，否则当其他人*正在编辑你的代码并且不坚持它时，它只会引起混乱。

我个人更喜欢不关心它的方法、实例、静态等范围，并在我确实需要知道的时候让 IDE 帮助我。此外，没有为您的语言发布的命名约定吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T16:11:37.300

像 Kent 一样，我的驼峰式大小写带有前导下划线。为声明添加前缀已经有一段时间了。我发现将我的声明组织成区域以及您在 IDE 中获得的工具提示足以跟踪这些内容。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T16:12:22.633

我不会使用下划线，因为一切都`public`应该看起来不错。

至于我，我使用 prefix `the`， like `theApplication`，`theSettings`等。

# asp.net - 在 ASP.NET 中使用 FDF 的最佳方式是什么？

> ID：465858
> 
> 赞同：0
> 
> 时间：2009-01-21T16:01:19.723
> 
> 标签：asp.net, fdf

我需要构建一个基于 FDF 的 PDF。我看到 Adob​​e 有 FDF 工具包，但看到其他人使用 ITextSharp。我在 Adob​​e 的工具包和 ASP.NET 上找不到任何东西，但在 ITextSharp 上看到了示例。我想知道我应该使用哪个，如果是 Adob​​e，有没有人举个例子。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T22:54:24.407

我会使用 iTextSharp，我以前用它来处理服务器上的 PDF 表单。我当时没有使用 Adob​​e FDF 工具包的原因是因为 Adob​​e 不再支持它，而且它的许可非常严格，因为您开发的大多数解决方案基本上都会与他们制作的产品之一竞争.

对于我正在尝试做的事情（处理表单回复），当我与 Adob​​e 的一位支持人员交谈时，他们推荐 LifeCycle Enterprise，这对我们的预算来说太贵了。

# php - 为什么我的 PHP 电子邮件正则表达式不起作用？

> ID：465866
> 
> 赞同：1
> 
> 时间：2009-01-21T16:02:25.043
> 
> 标签：php, regex

我在 Javascript 中有相同的表达式，但它在 PHP 中无法用于服务器端验证。这是代码

```
if (ereg('/^([a-zA-Z0-9_.-])+@([a-zA-Z0-9_.-])+\\.([a-zA-Z])+([a-zA-Z])+/',$_POST['email-address']))
    echo "valid email";
else
    echo "invalid email"; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T16:12:58.623

PHP自带的过滤器：

```
if(!filter_var($email, FILTER_VALIDATE_EMAIL)) {

echo "E-mail is not valid";

} else {

echo "E-mail is valid";

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-21T16:12:59.700

[不要使用正则表达式来“验证”电子邮件地址](http://mail.python.org/pipermail/python-list/2006-September/404146.html)

*编辑：*链接已损坏。[这可能是正确的链接](http://mail.python.org/pipermail/python-list/2006-September/455468.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-21T16:13:25.970

使用 preg_match，而不是 ereg。ereg 正则表达式字符串不使用封闭的斜杠字符。

此外，在 PHP 中的单引号字符串中可能不需要双反斜杠（但不确定）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-21T16:07:18.480

我使用以下。在比较之前，我还会在输入字符串上运行 TRIM()：

```
function is_email($string) {
  if (preg_match('/^[^0-9][a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*[@][a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*[.][a-zA-Z]{2,4}$/',$string)) {
    return true;
  } else {
    return false;
  }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T16:12:24.183

我现在整理了来自 Cal Henderson、Dave Child、Phil Haack、Doug Lovell 和 RFC 3696 的测试用例。总共有 158 个测试地址。

我针对我能找到的所有验证器运行了所有这些测试。比较在这里： http: [//www.dominicsayers.com/isemail](http://www.dominicsayers.com/isemail)

随着人们增强他们的验证器，我将尝试使此页面保持最新。感谢 Cal、Dave 和 Phil 在编译这些测试时提供的帮助和合作，以及对[我自己的验证器](http://code.google.com/p/isemail/source/browse/trunk/is_email.php)的建设性批评。

人们应该特别注意[针对 RFC 3696 的勘误表](http://www.rfc-editor.org/errata_search.php?rfc=3696)。其中三个规范示例实际上是无效地址。地址的最大长度是 254 或 256 个字符，**而不是**320。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-21T16:08:06.810

这可能是因为您用于连接表达式 (+) 的符号。

不管怎样，你应该试试这个：

\w+([-+.']\w+) *@\w+([-.]\w+)* .\w+([-.]\w+)*

# css - 打印模式弹出窗口的内容

> ID：465872
> 
> 赞同：1
> 
> 时间：2009-01-21T16:04:42.197
> 
> 标签：css, ajax, asp.net-ajax, printing

我有一个显示项目列表的应用程序。

用户可以单击一个项目并在模式弹出窗口中查看其详细信息（居中的 DIV，使用 JavaScript 显示）。我需要在该弹出窗口上有一个按钮，该按钮将允许用户仅打印出模式弹出窗口的内容。

这适用于只需要在 IE7+ 中运行的内部应用程序。当用户单击模式弹出窗口上的打印按钮时，项目的状态将更改为“已打印”（出于内部业务原因......）。

我正在使用 ASP.NET 和[ASP.NET AJAX Control Toolkit ModalPopupExtender](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ModalPopup/ModalPopup.aspx)，但我猜测实现这一点的技术将以浏览器为中心，并且与服务器技术无关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T19:56:37.347

您可以将“noprint”类名添加到包含您不想打印的所有内容的 div 中。

如果您还希望主页在没有对话框的情况下可打印，您可以在用户按下 PRINT 按钮时将类名添加到包装器 DIV 并在之后删除类名。

```
@media print {
.noprint {
 display:none
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T16:45:48.403

您可以重定向到具有模式弹出内容的可打印页面。确保该页面在加载事件中有 window.print()。一旦您的用户到达该页面，您就可以标记它。

如果用户到达那里并取消打印会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:55:22.510

试试这个

```
function PrintContent() {

var DocumentContainer = document.getElementById('nameofDiv');
var WindowObject = window.open("", "PrintWindow",
"width=750,height=650,top=50,left=50,toolbars=no,scrollbars=yes,status=no,resizable=yes");
WindowObject.document.write();
WindowObject.document.write('<link rel="stylesheet" type="text/css" href="path-to-my-stylesheet.css">')
WindowObject.document.writeln(DocumentContainer.innerHTML);
WindowObject.document.close();
WindowObject.focus();
WindowObject.print();
WindowObject.close();
} 
```

这将使用您的样式表在另一个窗口中打印出内容

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-12T16:45:17.603

为了以不同的样式（例如不居中，100% 宽度）呈现弹出内容，我在打印时动态更新 _foregroundElement（PopupControlID）和 _backgroundElement（由弹出扩展程序创建）的位置。

```
var basePrint = window.print;
window.print = function() {
  var popup = $find( '<%= [PopupExtenderID].ClientID %>' );
  popup._backgroundElement.style.position = 'static';
  popup._foregroundElement.style.position = 'static';
  popup._layout();
  basePrint();
  // Restore settings for display
  popup._backgroundElement.style.position = 'fixed';
  popup._foregroundElement.style.position = 'fixed';
  popup._layout();
  } 
```

注意：不适用于浏览器的打印按钮。

# parsing - 构建 IDE/编译器所需的概念

> ID：465873
> 
> 赞同：21
> 
> 时间：2009-01-21T16:04:50.200
> 
> 标签：parsing, compiler-construction, ide

在制作 IDE（例如 SharpDevelop）或编译器/语言解析器时，我需要了解哪些计算机科学主题？我不希望有完整的深入教程列表，而只是一个有助于我改进的主题列表。

我是否认为解析器对语言的语法/语义有一些规则，并根据这些规则验证代码？这似乎是一个简单的方法？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T16:44:00.027

IDE、编译器和调试器是三种不同的野兽。

以下是我在考虑为模拟语言构建建模工具时发现的一些有趣或鼓舞人心的链接的快速且略微随机的选择，这些链接与我接近 IDE 一样：

*   [高性能图形用户界面](http://www.infoworld.com/article/06/01/25/74658_05OPstrategic_1.html)
*   [Magic Ink](http://worrydream.com/MagicInk/) - 可编程信息而非交互
*   [爱德华·塔夫特](http://www.edwardtufte.com/tufte/index)——想象一下，如果你的工作生涯都花在了看信息上，这让这一切变得美好。
*   [用于动态语言的动态 IDE](http://gbracha.blogspot.com/2008/11/dynamic-ides-for-dynamic-languages.html)（Bracha 还设计了 Java 的调试镜像接口，IDE 需要的另一件事）
*   [信息设计模式](http://interface.fh-potsdam.de/infodesignpatterns/news.php)- GUI 的一般示例
*   [选项卡式界面的问题](http://www.codinghorror.com/blog/archives/000946.html)（尽管当每一页代码看起来都一样时，图标也没有多大用处；也许像这里生成的图标会起作用）
*   [开发多模式用户界面的常识性建议](http://www.w3.org/TR/2006/NOTE-mmi-suggestions-20060911/)- 如果表达代码的最佳方式是挥手致意，或者严厉地与错误交谈，那该怎么办。
*   [Pinocchio 问题](http://steve-yegge.blogspot.com/2007/01/pinocchio-problem.html)- 类似于 Bracha 的帖子，关于修补正在运行的框架

这些链接有些偏向于帮助阅读和浏览而不是编写代码的模式，以及用户在使用它们时扩展的系统，而不是作为一个单独的循环；如果您想要一个面向任务的界面或静态插件，那么现有 IDE（例如 Eclipse）的项目就是您可以查看的地方。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-21T16:08:19.757

为了实现编译器/语言，您需要对以下内容有基本的了解：

*   [BNF](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form "BNF") & [EBNF](http://en.wikipedia.org/wiki/EBNF "EBNF") - 上下文无关语法（语法规则）
*   词法分析技术和工具（Lex / Bison）
*   解析技术（例如 Recursive Decent、LL、LR）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-31T04:45:51.677

编写编译器和解释器：一种软件工程方法 [平装本] Ronald Mak -> 这是一本入门的好书。它引导您完成构建编译器和带有调试器的 ide 以及您需要的许多其他东西的整个过程。在本书的最后，您将很好地了解如何自己进行分支。

您可能还想查看 PragProg.com 发布的语言实现模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T16:21:31.773

如果您正在编写编译器，那么语言翻译理论或类似内容的良好计算机科学课程非常重要。麻省理工学院开放课件按照这些思路提供[“计算机语言工程”课程。](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-035Fall-2005/CourseHome/index.htm)那应该教您 mmattax 提到的概念并提供一个良好的开端。

至于 IDE，它实际上更像是一个桌面应用程序项目。您可能从 IDE 调用编译器，但实际上并没有编译代码（但公平地说，在复杂的 IDE 中，您可能正在解析代码）。因此，构建调用外部编译器/链接器的 IDE 所需的知识将更多地集中在您使用的任何平台的 UI 工具包上，可能还有一些编译器前端理论（正如您在编译器课程中所学的那样） ) 如果你想解析代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-17T10:13:47.703

为了开发编译器，您需要掌握以下主题

*   有限自动化 (DFA)
*   上下文无关语法（您需要在开始编码之前定义语法，它是您的语言/编译器的蓝图）

完成理论部分后，您需要为您的编译器开发以下组件

1.  词法分析器（为您的语言验证标记）
2.  解析器（验证你的语言的句子）
3.  翻译方案（将您的代码（高级）转换为 3 地址代码（机器语言代码））
4.  虚拟机（代码生成/生成代码的实际输出）

注意：每个组件的输出输入到下一个组件，词法分析器的输入是您的实际代码，并且大多数编译器是使用形式方法（一种程序设计模式）开发的

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-01-21T16:27:50.793

抱歉，答案是“整个计算机科学和多年的实践经验”。

对于普通人来说，它的主题太大了，eclipse、intellij、netbeans 和 Visual ......已经很好地涵盖了这个主题。

看看一些更小、更容易实现的东西，比如你感兴趣的 Eclipse 插件。

# asp.net - 现在 ASP.NET 动态数据与 Nhibernate 的工作情况如何？

> ID：465875
> 
> 赞同：3
> 
> 时间：2009-01-21T16:05:39.043
> 
> 标签：asp.net, nhibernate, orm, dynamic-data

我知道有一些人致力于让 Nhibernate 支持 ASP.NET 动态数据。有人有使用它的真实生活经验吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T13:46:08.963

NHContrib 中的当前实现基于将查询转换为 ICriteria。

当您查询集合成员时，我们遇到了一个问题。说：

```
Get .../Parent(1)/Children 
```

在这种情况下，您不会得到预期的孩子列表，而是一些父母列表（据我所知）。

我认为问题就在那里，因为 FROM 语句被转换为根标准。例如

```
From parent In Parents Where parent.Id = 1 Select parent.Children 
```

...选择部分现在应该是我认为不是 ATM 的标准的根源。

然而，正在开发一个新的 Linq2NHib 实现。也许在某个时间我们会有一个适当的实现。此时 - 它不是（与动态数据一起使用）。

# com - 为免注册 COM 生成清单文件

> ID：465882
> 
> 赞同：87
> 
> 时间：2009-01-21T16:07:46.730
> 
> 标签：com, manifest, dll, regfreecom, typelib

我有一些使用清单文件的应用程序（一些本机，一些 .NET），因此它们可以[完全隔离部署](http://msdn.microsoft.com/en-us/library/fh1h056h.aspx)，而无需任何全局 COM 注册。例如，对 dbgrid32.ocx com 服务器的依赖在 myapp.exe.manifest 文件中声明如下，该文件与 myapp.exe 位于同一文件夹中：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<assembly manifestVersion="1.0" xmlns="urn:schemas-microsoft-com:asm.v1">
  <assemblyIdentity type="win32" name="myapp.exe" version="1.2.3.4" />
  <dependency>
    <dependentAssembly>
      <assemblyIdentity type="win32" name="dbgrid32.ocx" version="5.1.81.4" />
    </dependentAssembly>
  </dependency>
</assembly> 
```

dbgrid32.ocx 与它自己的 dbgrid32.ocx.manifest 文件一起部署到同一文件夹：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<assembly manifestVersion="1.0" xmlns="urn:schemas-microsoft-com:asm.v1">
  <assemblyIdentity type="win32" name="dbgrid32.ocx" version="5.1.81.4" />
  <file name="dbgrid32.ocx">
     <typelib
        tlbid="{00028C01-0000-0000-0000-000000000046}"
        version="1.0"
        helpdir=""/>
    <comClass progid="MSDBGrid.DBGrid"
       clsid="{00028C00-0000-0000-0000-000000000046}"
       description="DBGrid  Control" />
  </file>
</assembly> 
```

这一切都很好，但是手动维护这些清单文件有点痛苦。有没有办法自动生成这些文件？理想情况下，我只想声明应用程序对 COM 服务器（本机和 .NET）列表的依赖关系，然后让其余的自动生成。是否可以？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-01-25T00:50:47.190

看起来完美的解决方案还不存在。总结一些研究：

**制作我的清单**（[链接](http://mmm4vb6.atom5.com/)）

该工具扫描 VB6 项目以查找 COM 依赖项，但它也支持手动声明后期绑定的 COM 依赖项（即通过 CreateObject 使用的那些）。

有趣的是，该工具将所有有关依赖项的信息放入应用程序清单中。应用程序 exe 及其依赖项被描述为由多个文件组成的单个程序集。之前我没有意识到这是可能的。

看起来是一个很好的工具，但从 0.6.6 版开始，它有以下限制：

*   仅适用于 VB6 应用程序，从 VB6 项目文件开始。很遗憾，因为它所做的很多事情都与 VB6 无关。
*   向导风格的应用程序，不适合集成到构建过程中。如果您的依赖关系没有太大变化，这不是一个大问题。
*   没有源代码的免费软件，依赖它是有风险的，因为它随时可能成为废弃软件。

我没有测试它是否支持 .NET com 库。

**regsvr42**（[代码项目链接](http://www.codeproject.com/KB/COM/regsvr42.aspx)）

此命令行工具为本地 COM 库生成清单文件。它调用 DllRegisterServer，然后在将信息添加到注册表时监视自注册。它还可以为应用程序生成客户端清单。

此实用程序不支持 .NET COM 库，因为这些库不公开 DllRegisterServer 例程。

该实用程序是用 C++ 编写的。源代码可用。

**mt.exe**

Windows SDK 的一部分（可以从[MSDN](http://www.microsoft.com/downloads/details.aspx?FamilyID=4377f86d-c913-4b5c-b87e-ef72e5b4e065&displaylang=en)下载），如果你安装了 Visual Studio，你已经拥有了。它[记录在这里](http://msdn.microsoft.com/en-us/library/aa375649.aspx)。您可以使用它为本地 COM 库生成清单文件，如下所示：

```
mt.exe -tlb:mycomlib.ocx -dll:mycomlib.ocx -out:mycomlib.ocx.manifest 
```

您可以使用它为 .NET COM 库生成清单文件，如下所示：

```
mt.exe -managedassemblyname:netlib.dll -nodependency -out:netlib.dll.manifest 
```

但是，此工具存在一些问题：

*   第一个片段不会生成 progid 属性，从而破坏了将 CreateObject 与 progid 一起使用的客户端。
*   第二个片段将生成 需要在清单实际工作之前删除的元素`<runtime>`。`<mvid>`
*   不支持为应用程序生成客户端清单。

也许未来的 SDK 版本会改进这个工具，我在 Windows SDK 6.0a (vista) 中测试了这个工具。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-06-14T15:22:57.750

通过 MSBuild 任务[GenerateApplicationManifest](http://msdn.microsoft.com/en-us/library/6wc2ccdc.aspx)，我在命令行生成了一个与 Visual Studio 生成的清单相同的清单。我怀疑 Visual Studio在构建过程中使用了[GenerateApplicationManifest 。](http://msdn.microsoft.com/en-us/library/6wc2ccdc.aspx)下面是我的构建脚本，可以使用 msbuild "msbuild build.xml" 从命令行运行

感谢 Dave Templin 和他[为我指出 GenerateApplicationManifest 任务的帖子](https://web.archive.org/web/20120810070249/http://windowsclient.net:80/Articles/ClickOnce_MsBuild.aspx)，以及 MSDN 的[该任务的进一步文档](http://msdn.microsoft.com/en-us/library/6wc2ccdc.aspx)。

构建.xml

```
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Target Name="Build">
        <ItemGroup>
            <File Include='MyNativeApp.exe'/>
            <ComComponent Include='Com1.ocx;Com2.ocx'/>
        </ItemGroup>
        <GenerateApplicationManifest
            AssemblyName="MyNativeApp.exe"
            AssemblyVersion="1.0.0.0"
            IsolatedComReferences="@(ComComponent)"
            Platform="x86"
            ManifestType="Native">
            <Output
                ItemName="ApplicationManifest"
                TaskParameter="OutputManifest"/>
        </GenerateApplicationManifest>
    </Target>   
</Project> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-21T16:17:49.143

[Make My Manifest (MMM)](http://mmm4vb6.atom5.com/)是一个很好的工具。也可以编写一个脚本来处理所有 DLL/OCX 文件，使用[mt.exe](http://msdn.microsoft.com/en-us/library/aa375649.aspx)为每个文件生成清单，然后将它们合并在一起。MMM 通常更好/更容易，因为它还可以处理许多特殊/奇怪的情况。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-10-14T19:22:08.933

您可以使用[Unattended Make My Manifest](https://github.com/wqweto/UMMM)分拆直接在自动构建中生成清单。它使用脚本文件来添加依赖的 COM 组件。这是带有可用命令的示例 ini 的摘录：

```
# Unattended MMM script
#
# Command names are case-insensitive. Reference of supported commands:
#
# Command: Identity
#
#   Appends assemblyIdentity and description tags.
#
#   Parameters       <exe_file> [name] [description]
#      exe_file      file name can be quoted if containing spaces. The containing folder 
#                    of the executable sets base path for relative file names
#      name          (optional) assembly name. Defaults to MyAssembly
#      description   (optional) description of assembly
#
# Command: Dependency
#
#   Appends dependency tag for referencing dependent assemblies like Common Controls 6.0, 
#     VC run-time or MFC
#
#   Parameters       {<lib_name>|<assembly_file>} [version] [/update]
#     lib_name       one of { comctl, vc90crt, vc90mfc }
#     assembly_file  file name of .NET DLL exporting COM classes
#     version        (optional) required assembly version. Multiple version of vc90crt can
#                    be required by a single manifest
#     /update        (optional) updates assembly_file assembly manifest. Spawns mt.exe
#
# Command: File
#
#   Appends file tag and collects information about coclasses and interfaces exposed by 
#     the referenced COM component typelib.
#
#   Parameters       <file_name> [interfaces]
#     file_name      file containing typelib. Can be relative to base path
#     interfaces     (optional) pipe (|) separated interfaces with or w/o leading 
#                    underscore
#
# Command: Interface
#
#   Appends comInterfaceExternalProxyStub tag for inter-thread marshaling of interfaces
#
#   Parameters       <file_name> <interfaces>
#     file_name      file containing typelib. Can be relative to base path
#     interfaces     pipe (|) separated interfaces with or w/o leading underscore
#
# Command: TrustInfo
#
#   Appends trustInfo tag for UAC user-rights elevation on Vista and above
#
#   Parameters       [level] [uiaccess]
#     level          (optional) one of { 1, 2, 3 } corresponding to { asInvoker, 
#                    highestAvailable, requireAdministrator }. Default is 1
#     uiaccess       (optional) true/false or 0/1\. Allows application to gain access to 
#                    the protected system UI. Default is 0
#
# Command: DpiAware
#
#   Appends dpiAware tag for custom DPI aware applications
#
#   Parameters       [on_off]
#     on_off         (optional) true/false or 0/1\. Default is 0
#
# Command: SupportedOS
#
#   Appends supportedOS tag
#
#   Parameters       <os_type>
#     os_type        one of { vista, win7 }. Multiple OSes can be supported by a single 
#                    manifest
# 
```

它将在 32 位或 64 位 Windows 上运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-06T02:32:19.930

要填写 mt.exe 不包含的 ProgID，您可以调用`ProgIDFromCLSID`从注册表中查找它们。这需要在完成清单文件之前进行传统的 COM 注册，但随后，清单文件将是自给自足的。

此 C# 代码将 ProgID 添加到清单中的所有 COM 类：

```
var manifest = XDocument.Load(fileName);
var namespaceManager = new XmlNamespaceManager(new NameTable());
namespaceManager.AddNamespace("s", "urn:schemas-microsoft-com:asm.v1");
foreach (var classElement in manifest.XPathSelectElements("s:assembly/s:file/s:comClass", namespaceManager)) {
    var clsid = Guid.Parse(classElement.Attribute("clsid").Value);
    int result = ProgIDFromCLSID(ref clsid, out string progId); if (result != S_OK) throw new COMException($"ProgID lookup failed for {clsid}.", result);
    classElement.SetAttributeValue("progid", progId);
}
manifest.Save(fileName); 
```

该代码依赖于这些互操作定义：

```
[DllImport("ole32.dll")] static extern int ProgIDFromCLSID([In] ref Guid clsid, [MarshalAs(UnmanagedType.LPWStr)] out string lplpszProgID);
const int S_OK = 0; 
```

# java - 确定使用了哪个提交按钮？

> ID：465886
> 
> 赞同：4
> 
> 时间：2009-01-21T16:08:33.827
> 
> 标签：java, html, http, forms, servlets

是否可以确定使用了哪个提交按钮？我有一个带有 2 个提交按钮的确认表。第一个将确认订单，执行一些数据库任务，然后重定向。第二个是取消按钮，它只会重定向到同一页面，而不执行任何数据库任务。

是否可以在 servlet 中（最好通过请求对象）确定使用了哪个提交按钮？我宁愿不依赖 Javascript，因为这很简单，但如果唯一的可能性，我会求助于它。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-21T16:14:19.480

```
<button name="someName" value="someValue" type="submit">Submit</button>
<button name="otherName" value="otherValue" type="submit">Cancel</button> 
```

您将拥有`someName=someValue`或`otherName=otherValue`在您的请求数据中

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-21T16:16:24.797

当然，只要给你的每个`submit`按钮一个`name`属性，无论哪个被点击都会出现在提交的变量中：

```
<input type="submit" name="doConfirm" value="Confirm"  />
<input type="submit" name="doCancel"  value="Cancel"  /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T16:47:43.920

正如其他人提到的那样，拥有两个不同名称的按钮将实现您的目标。但是，在您的应用程序中依赖它时，需要注意一些潜在的问题。我认为它们是特定于 Internet Explorer 的，因此如果您不需要支持旧版本的 IE，您可以忽略。两者都涉及当表单元素之一具有焦点时用户按 Enter 键时提交的表单的行为。[本文](http://aspnet.4guysfromrolla.com/articles/010908-1.aspx "Web 表单输入关键陷阱")使用 ASP 来演示问题，但 HTML 方面是相关的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T19:40:45.320

当使用多个提交按钮时，我喜欢使用 javascript 来设置隐藏表单字段的值，该字段描述应该发生的操作。

例如：

```
<input type="hidden" name="action" id="form-action" />
<input type="submit" value="Save" onClick="document.getElementById('form-action').value='save'" />
<input type="submit" value="Copy" onClick="document.getElementById('form-action').value='copy'" /> 
```

# asp.net - 带有 Eval 的中继器的 SeparatorTemplate

> ID：465889
> 
> 赞同：4
> 
> 时间：2009-01-21T16:09:29.847
> 
> 标签：asp.net, data-binding, repeater, eval

是否可以在中继器的 SeparatorTemplate 中使用 Eval 或类似语法？

我想在分隔符模板中显示最后一项的一些信息，如下所示：

```
<table>
    <asp:Repeater>
        <ItemTemplate>
            <tr>
                <td><%# Eval("DepartureDateTime") %></td>
                <td><%# Eval("ArrivalDateTime") %></td>
            </tr>
        </ItemTemplate>
        <SeparatorTemplate>
            <tr>
                <td colspan="2">Change planes in <%# Eval("ArrivalAirport") %></td>
            </tr>
        </SeparatorTemplate>
    <asp:Repeater>
<table> 
```

希望它会产生这样的东西：

```
<table>
    <asp:Repeater>
            <tr>
                <td>2009/01/24 10:32:00</td>
                <td>2009/01/25 13:22:00</td>
            </tr>
            <tr>
                <td colspan="2">Change planes in London International Airport</td>
            </tr>
            <tr>
                <td>2009/01/25 17:10:00</td>
                <td>2009/01/25 22:42:00</td>
            </tr>
    <asp:Repeater>
<table> 
```

但是 SeparatorTemplate 似乎忽略了 Eval() 调用。我也尝试使用像这样的以前的语法： <%# DataBinder.Eval(Container.DataItem, "ArrivalAirport")%> 具有相同的结果。

是否可以在 SeparatorTemplate 中显示上一项的信息？如果没有，您能否建议另一种生成此代码的方法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T17:17:39.773

尝试这个：

在 WebForm 的类中添加一个（或两个）私有变量，当您在项目级别执行数据绑定时，您可以使用它来增加/跟踪航班信息。

然后在 ItemDatabound 事件中，如果正在数据绑定的项目是 ListItemType.Seperator 类型，则可以执行简单的评估，并以这种方式显示/隐藏/修改您的分隔符代码。

您的 WebForm 页面在顶部看起来像这样：

```
public partial class ViewFlightInfo : System.Web.UI.Page
{

    private int m_FlightStops;

    protected page_load
    {

        // Etc. Etc.

    }
} 
```

然后，当您着手进行数据绑定时：

```
protected void rFlightStops_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    Repeater rFlightStops = (Repeater)sender;

    if (e.Item.ItemType == ListItemType.Header)
    {
        // Initialize your FlightStops in the event a new data binding occurs later. 
           m_FlightStops = 0;
    }

    if (e.Item.ItemType == ListItemType.Item
        || e.Item.ItemType == ListItemType.AlternatingItem)
    {
         // Bind your Departure and Arrival Time
         m_FlightStops++;
     }

    if (e.Item.ItemType == ListItemType.Seperator)
    {
       if (m_FlightStops == rFlightStops.Items.Count - 1)
       {
           PlaceHolder phChangePlanes = 
                    (PlaceHolder)e.Item.FindControl("phChangePlanes");
           phChangePlanes.Visible = false;
       }
    }
 } 
```

......或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T16:43:08.970

嘿，我会用一种方法来识别转发器中的最后一项，这样我就可以避免在那里生成分隔符：

```
<table>
    <asp:Repeater>
        <ItemTemplate>
            <tr>
                <td><%# Eval("DepartureDateTime") %></td>
                <td><%# Eval("ArrivalDateTime") %></td>
            </tr>
            <% if (<<<isn't the last item>>) { %>
            <tr>
                <td colspan="2">Change planes in <%# Eval("ArrivalAirport") %></td>
            </tr>
            <% } %>
        </ItemTemplate>
    <asp:Repeater>
<table> 
```

谢谢

# c# - 寻找适用于桌面应用程序的 Visual Studio 工具箱样式导航

> ID：465898
> 
> 赞同：1
> 
> 时间：2009-01-21T16:11:51.870
> 
> 标签：c#, .net-2.0, navigation, mdi

我正在开发一个使用 MDI 应用程序和侧面导航面板的项目。目前它是一个 ListView。但是，我想将其重新设计为类似于 Visual Studio 2008 中的工具箱。

如果这需要覆盖默认的绘制方法，那么如果您可以提供一些关于如何使用绘制方法的良好参考，这也会有所帮助，因为我目前没有任何使用它的经验。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T16:19:08.393

查看 Nevron 用户界面： http: [//www.nevron.com/Products.UserInterfaceFor.NET.Overview.aspx](http://www.nevron.com/Products.UserInterfaceFor.NET.Overview.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T16:16:38.600

我相信您需要的是 PanelBar 控件。我不会详细介绍如何创建一个，因为这不符合帖子的主题，但是如果您要多次使用它，我强烈建议您寻找第三方实现在项目中，或在多个项目中。

这是一个例子：[http ://www.telerik.com/products/winforms/panelbar.aspx](http://www.telerik.com/products/winforms/panelbar.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T16:18:50.017

您想使用 ToolBox 控件。一些免费提供的工具是我使用过的最友好的工具，由 Gordon Robinson 提供： http: [//gordondrobinson.com/post/Toolbox-control-written-in-C.aspx](http://gordondrobinson.com/post/Toolbox-control-written-in-C.aspx)

# visual-studio-2008 - 为 setup.exe 和 .MSI 创建面向未来的 .NET 3.5 SP1 安装程序先决条件

> ID：465899
> 
> 赞同：0
> 
> 时间：2009-01-21T16:11:57.410
> 
> 标签：visual-studio-2008, installation, windows-installer, .net-3.5, launch-condition

我要求 .NET 3.5 SP1[一个 VS2008 安装项目会更新 Net 3.5 SP1 吗？](https://stackoverflow.com/questions/88136/will-a-vs2008-setup-project-update-net-3-5-sp1). 这使得 setup.exe 检查正确。

我还在我的 MSI 中添加了“SP1”启动条件，因此它不会让用户通过启动 MSI 安装我的 .NET 3.5SP1 应用程序（并将`[VSDNETMSG]`框架条件消息中的消息替换为实际提到 SP1 的消息）。

从未来证明的角度来看，这感觉是错误的。我希望条件是：

```
(NETVer=3.5 AND Net35SPLevel=1) OR (NETVer=>3.5) 
```

不是

```
(NETVer=3.5 AND Net35SPLevel=1) 
```

有没有办法做到这一点？框架检查没有条件属性来允许我添加子条件......

是的，我也可以不用担心我漂亮的小脑袋：P

如果那里的一位 MS 版本控制专家读到此，如果您要将代码依赖的内容放入 SP，您能否让安装程序能够检查它的 OOTB。

（我真的希望他们能想出一个更好的编号方案——世界和它的狗可以看到这会变得混乱）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-26T09:38:57.143

啊，正如[我引用的另](https://stackoverflow.com/questions/88136/will-a-vs2008-setup-project-update-net-3-5-sp1.)[一篇文章](http://jelle.druyts.net/2005/04/09/CheckingForNET11ServicePack1InAnMSI.aspx)链接到的文章中所指出的那样，您可以使用这样一个事实，即失败的注册表搜索将产生一个空白字符串（而如果实际安装了 3.5 并使用表达式，则会产生结果：`#0``#1`

```
(NET35SPLEVEL="") OR NOT (NET35SPLEVEL>>"0") 
```

这使检查成为析取，而不是合取[1]

这解决了问题 - 在没有 SP 的 4.0 上检查不会失败。

剩下的问题是，仍然没有涵盖安装了 4/4.1/4/5/5/6 并且机器上有 unservicepacked 3.5 的情况......（所以不接受我的回复！）

[1] 不对，亚当！

# asp.net - ASP.Net：通过浏览器的登录窗口进行身份验证

> ID：465910
> 
> 赞同：1
> 
> 时间：2009-01-21T16:14:52.303
> 
> 标签：asp.net, forms-authentication, security

我有一个似乎相当常见的场景：我有一个包含用户/密码列表的数据库，理想情况下，当有人访问该站点时，我想使用他们的 windows 名称（内部），否则无论名称用户提供（外部）。

我的主要问题是如何向浏览器发送响应，强制它提示外部用户输入用户名/密码（例如当您访问使用 Windows 身份验证的页面时）？有没有人这样做过？

我的主要目标是避免创建登录屏幕，而只使用浏览器内置的内容。有没有办法可以利用内置的表单身份验证来做到这一点？

谢谢！

*更新：我发现了类似于我在这里寻找的东西：http: [//blog.codeville.net/2008/08/25/using-the-browsers-native-login-prompt/](http://blog.codeville.net/2008/08/25/using-the-browsers-native-login-prompt/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T16:27:24.057

您可以将 ASP.net 成员库与 Windows 身份验证一起使用。这是[ScottGu 博客](http://weblogs.asp.net/scottgu/archive/2006/07/12/Recipe_3A00_-Enabling-Windows-Authentication-within-an-Intranet-ASP.NET-Web-application.aspx)谈论它

# delphi - 我在哪里可以找到使用 TMetafile 和 TMetafileCanvas 的文档和/或示例？

> ID：465911
> 
> 赞同：1
> 
> 时间：2009-01-21T16:15:43.253
> 
> 标签：delphi, printing, metafile

当我正在向我的应用程序添加自定义打印时，我决定使用 TMetafile 创建页面，然后使用它来预览和/或打印，但我发现缺少文档。

有没有什么好的资源来学习使用 TMetafile 和 TMetafileCanvas 的来龙去脉？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T16:55:33.797

从我使用它的痛苦经历来看，使用 TMetaFile/Canvas 的来龙去脉更多地与元文件相关，而不是与 TMetaFile 和 TMetaFileCanvas 实现相关。Aka，您应该寻找有关 EMF（或 WMF）如何工作的信息。Delphi 实现只是调用 Windows 来完成我所理解的所有事情。

您可能希望更具体地了解您需要了解的内容，尽管超出了有关如何执行此操作的逐步指南。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T16:38:53.390

其实比你想象的要简单...

这是我的一些代码：

```
var
   m: TMetafile;
   mc: TMetafileCanvas;
begin
   m := TMetafile.Create;
   m.Width := 1000;
   m.Height := 1000;
   mc := TMetafileCanvas.Create(m, 0);
   //use mc just like any canvas...
   mc.Free;
   // you can use m for anything you want, preview, print, save ...etc.
end; 
```

要将元文件复制到剪贴板：

```
Clipboard.Assign(m); 
```

保存到 emf 文件：

```
m.SaveToFile(filename); 
```

我用它在快速报告中打印元文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T17:14:59.483

我自己并没有深入研究它，但我知道 QuickReports 代码在后台使用元文件来创建打印预览并发送到打印机。如果你有这方面的来源，它可能会有所帮助。

# ruby-on-rails - 3 用例和索引方法

> ID：465913
> 
> 赞同：1
> 
> 时间：2009-01-21T16:16:04.623
> 
> 标签：ruby-on-rails

我编写了下面的代码，它似乎不起作用，但如果我删除最后一个 if 语句，它确实有效，显然仅适用于前两个用例。有没有更好的方法来编写这段代码？在我的路线文件中，我有

```
map.resources :galleries
map.resources :users, :has_many => :galleries 
```

用户单击链接“画廊”并查看所有已发布画廊的列表。( `mysite.com/galleries`)

用户可以单击“我的画廊”链接并查看她自己的所有画廊。( `mysite.com/users/21/galleries`)

用户可以单击其他用户个人资料上的链接，并查看该人发布的画廊。( `mysite.com/users/35/galleries`)

```
if params[:user_id].blank?
   @galleries = Gallery.find(:all, :conditions => ['visibility_status=  ?', true])
   end

if (params[:user_id] && current_user.id.to_s == params[:user_id])
    @galleries = current_user.galleries
end

if params[:user_id]
    @galleries = Gallery.find(:all, :conditions => ['user_id=? and
    visibility_status = ?', params[:user_id], true])
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T16:24:22.377

好的 - 首先 - 我不是 Ruby 程序员。

但是 - 你不应该使用 if - else if - else if - end 等吗？

如果第二个条件为真，您的第三个条件将始终为真，因此`@galleries`即使您已经在第二个测试中设置了第三个测试，您也总是会覆盖它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T16:42:04.773

您的路由看起来很合适，使用这些路由，您的控制器和视图中有一堆可用的辅助方法：例如`user_galleries_url(@user)`和`user_galleries_url(@user, @gallery)`其他。查看[资源路由](http://api.rubyonrails.org/classes/ActionController/Resources.html#M000354)以了解您可以做什么。

唯一的建议是稍微修改你的逻辑并将其放入之前的过滤器中
`app/controllers/galleries_controller.rb`

```
class GalleriesController < ActionController::Base
  before_filter :get_galleries, :only => 'index'

  private
    def get_galleries
      if params[:user_id]
        if params[:user_id] == current_user.id.to_s
          @galleries = current_user.galleries
        else
          @galleries = Gallery.find(:all, :conditions => ['user_id=? and visibility_status = ?', params[:user_id], true])
        end
      else
        @galleries = Gallery.find(:all, :conditions => ['visibility_status=  ?', true])
      end
    end
end 
```

您也可以`get_gallery`对`show`、`edit`和操作执行类似的`delete`操作。

# c++ - c++ xml数据绑定

> ID：465914
> 
> 赞同：8
> 
> 时间：2009-01-21T16:16:24.170
> 
> 标签：c++, xml, data-binding, serialization

网上有几种不同java xml数据绑定工具的对比。我希望看到这成为用于 xml 数据绑定的不同 c++ 工具之间的有用比较。

您在 c++ 中使用哪个工具进行 xml 数据绑定？CodeSynthesis 和 xmlbeanscxx 是几个可用的选择。

我希望每个人都在下面添加有关他们对这项技术的体验的信息，包括选择一种工具而不是另一种工具的理由、易用性和性能。还可以随意添加有关命名空间支持、解析选项（树/流）等的技术信息。

* * *

## [代码合成 XSD](http://www.codesynthesis.com/products/xsd/)

（请随时在此处添加信息）

许可证：GPL2 有例外/专有

缺点：生成的代码应该是开源的。

* * *

## [xmlbeanscxx](https://github.com/rafalrusin/xmlbeansxx)

（请随时在此处添加信息）

许可证：阿帕奇

缺点：

*   没有公共问题跟踪器
*   [孵化器页面](http://incubator.apache.org/xmlbeanscxx/)未激活（项目似乎已被放弃）
*   [项目页面](http://xmlbeansxx.touk.pl/)不可用 (404)

* * *

## [Boost 序列化库](http://www.boost.org/doc/libs/1_37_0/libs/serialization/doc/index.html)

（请随时在此处添加信息）

执照：升压

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-30T02:29:39.020

我正在使用 SourceForge 的开源[GSOAP](http://sourceforge.net/projects/gsoap2)工具包进行 XML C++ 自动序列化。也适用于纯 C。它自动将 C/C++ 绑定到 XML 模式，并且完全符合 XML、WSDL、SOAP、REST、XML-RPC、JSON 和 WS-* 协议的行业标准。它也很有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T01:17:24.890

[Codalogic LMX](http://www.codalogic.com/lmx/)

它也有免费版本和付费许可证版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T01:12:11.750

[Boost 序列化库](http://www.boost.org/doc/libs/1_37_0/libs/serialization/doc/index.html)Boost，没有它就不要离开家。

# javascript - 使用 jQuery 删除第二个表单元素而不丢失子元素

> ID：465923
> 
> 赞同：2
> 
> 时间：2009-01-21T16:18:50.157
> 
> 标签：javascript, jquery

我有一些 AJAX 工作带来了我在 DOM 中不需要的额外表单元素。我没有能力在服务器端删除它，所以我正在寻找一些 jQuery 或经典 JavaScript，它们可以让我捕获表单的所有子元素，删除我不需要的表单，最后重新将子元素附加回 DOM。

任何帮助将非常感激

编辑：感谢您的快速回答，以下是我实际使用的，并且效果很好

```
 // Captures the children
            var children = $("form:eq(1)").children();
            // Removes the form
            $("form:eq(1)").remove();
            // append the child elements back into the DOM 
            $("#fillDiv").append(children); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T16:23:59.710

而不是使用该`.html()`方法（这将导致您丢失与表单元素关联的任何事件），您应该移动子节点：

```
// grab the child nodes
var children = $('#badForm').children();
// or var children = $('#badForm > *');

// move them to the body
$(body).append(children);

// remove the form
$('#badForm').remove(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T16:26:51.263

如果你有这样的 ajax 代码：

```
$.ajax({
    type: "get",
    url: "url",
    data: ,
    cache: false,
    success: function(data){

    }
}); 
```

您可以添加以下`success`功能：

```
$(data).find('#whatYouNeed').appendTo('#whereYouNeed') 
```

通过这种方式，您可以从该页面中提取您想要的任何内容:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-25T14:40:54.623

您的问题仍然是实际的，但是这些天有更好的答案。

1.  `unwrap`方法：[http ://api.jquery.com/unwrap/](http://api.jquery.com/unwrap/)
2.  `$element.replaceWith($element.contents());`

# excel - 在我的程序中启动和控制两个 excel 实例？

> ID：465933
> 
> 赞同：-1
> 
> 时间：2009-01-21T16:21:47.327
> 
> 标签：excel

我有一个奇怪的需要打开两个单独的 excel 实例，并让每个实例打开一个不同的电子表格以进行各种操作。

目前，我正在使用命令行参数简单地执行 excel 以打开两个电子表格，但两个电子表格最终都出现在一个 excel 实例中。

是的，这很笨拙，不，我无法轻易解释我对这个奇怪要求的推理。

但是，希望您有一些我可以尝试的建议。

-亚当

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T18:40:45.957

如果您不尝试以编程方式访问 Excel 的每个实例，则可以将 Windows 资源管理器设置为在新实例中打开每个工作簿：

[http://www.vadriano.com/excel-vb/2007/04/12/how-to-open-excel-files-in-a-new-application-instance/](http://www.vadriano.com/excel-vb/2007/04/12/how-to-open-excel-files-in-a-new-application-instance/)

在您的命令行调用中，您是否指定了 Excel 的完整程序路径？当我从命令行执行此操作时，我会在自己的实例中获取每个文件......

据我所知，您不能同时以编程方式打开/控制两个单独的 Excel 实例......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T16:44:42.133

您没有说您使用的是什么语言，但请查看这些链接。对于 perl [http://www.xav.com/perl/faq/Windows/ActivePerl-Winfaq12.htm](http://www.xav.com/perl/faq/Windows/ActivePerl-Winfaq12.htm)对于 vb.net 看看[http://support.microsoft.com/kb/302094](http://support.microsoft.com/kb/302094)

# identity - 单点登录、多配置文件的实现？

> ID：465937
> 
> 赞同：0
> 
> 时间：2009-01-21T16:22:32.567
> 
> 标签：identity, accounts

我的雇主正在考虑在其各种 Web 资产中实施一个单一帐户、多个配置文件系统。想法是 SSO 对用户来说会更方便，但他们可能不希望他们在约会网站上的活动与他们对另一个网站上的论坛的贡献相关联。

我对这种方法非常谨慎 - 我很确定 Yahoo! 曾经这样做过，这非常令人困惑。我的预感是，用户不会理解在一个站点网络上的单个 SSO 帐户背后拥有多个身份。

但是......这只是一种预感，我愿意被证明是错误的。有没有人有这种模式的实现示例（好或坏）？SSO，但您可以创建多个面向公众的“配置文件”并在站点或站点网络的不同部分使用它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T16:25:32.763

也许只是因为我是一名程序员，但我不觉得 OpenID 的系统令人困惑（嗯，至少[是 MyOpenId](http://myopenid.com)）。进行身份验证时，您只需选择要发送到站点的“角色”（如果有的话）。

# algorithm - 哪种算法可以有效地找到路径一定距离内的一组点？

> ID：465942
> 
> 赞同：14
> 
> 时间：2009-01-21T16:24:16.510
> 
> 标签：algorithm, geometry, geospatial

给定一组点*s （一组 x,y 坐标）和一条由连接一组点**l*的线段组成的路径，描述一种有效的算法，该算法可用于从*s*中找到点的子集，它们是在路径*l*的指定距离*d*内。

 *这方面的一个实际应用可能是沿着城市之间的公路旅行路径在 10 英里范围内的任何地方查找餐馆列表。

例如，在下图中，绿色点将包含在搜索结果中。![点图](https://farm4.static.flickr.com/3480/3214970769_80e18b4d47_d.jpg)

解决方案在 C# 中是首选，但基于 SQL 的方法可能会获得奖励积分 :-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T17:11:57.383

前段时间我也想过这个问题。我认为，高效是一种误导。只需测试每个点的所有线段就足够了。[计算距离很](http://www.intmath.com/Plane-analytic-geometry/Perpendicular-distance-point-line.php)便宜。如果有很多点，您还可以考虑使用水平集方法来细化选择哪些点的策略。IE

*   沿着这条线走，步长是您要检查的距离的 2 倍（或多或少？）并创建“接近”的人工点。
*   迭代：在“附近”的点周围选择新点（不计算欧几里德距离，只计算 1 范数并简单地测试 x 和 y 坐标） - 然后测试它们的距离（您甚至可以从人工指向找到的“近”点并首先选择那个进行测试，但要扩大搜索范围，因为可能会有曲折！）

这可能不完整，但应该很快并且避免检查点很远而且很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T16:34:31.887

1.  定义一条“左路”和“右路”：对于原始路径的每个线段，在该线段的“左侧”创建一个 d 个单位，在“右侧”创建一个 d 个单位的线段。

2.  将两端的左路和右路连接起来，形成一个多边形。

3.  应用标准算法来确定哪些兴趣点位于多边形内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T16:30:18.387

艰巨的家庭作业是吗？

也许一个好的开始可能是查看广度优先寻路算法——也许像洪水填充方法这样的东西对此有用？

编辑：所以如果它*看起来像*一个家庭作业，也许我可以更有帮助......

我首先会定义一个包含直线和其中可能包含的点的矩形，因为这可以让我们摆脱大量远离我们的直线的点。

然后，您可以为每个点创建一个正方形，表示该点半径内的点列表。这又是一种减少要搜索的元素数量的方法。

不幸的是，除了简单地通过基本触发计算它们与圆心之间的距离之外，我不知道足够的几何知识来知道一种聪明的方法来决定点列表是落在圆内还是圆外 - 我是肯定有一个。通过使用前面提到的简单细分或一些变体，您应该会发现您可以先发制人地减少需要搜索的可能点的数量。

此外，如果您将所有要搜索的点保留在一个列表中，并在测量后续形状时删除第一个圆的命中点。我已经使用了这个的蛮力版本来根据位置数据进行简单的邮政编码距离检查 - 这在网上很多地方都有记录，但是沿着一条路径运行它可能会在计算上非常昂贵。

这种几何方法可能更适合您没有进行大量重复搜索的情况 - 如果连续有很多，您可能希望将您的 ponts 组织成一个网络，以便您可以对它们使用标准寻路。值得做一些原型设计来看看哪个更有效，但我希望如果您要创建一个合适的网络来表示您的数据，那么您可以更灵活地搜索它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T17:09:01.430

对此的唯一解决方案是：

```
for each point
  for each line
    is distance to line within constraints 
```

一旦找到位于约束内的点，就可以提前终止内部循环。请注意，内部和外部循环可以调换。

那么问题就变成了确定一个点是否在约束范围内。mbeckish 建议使用简单的矩形测试，其中矩形是通过沿线的垂线挤压形成的，但是对于端点附近但在该矩形之外的点，这将失败。沿线的方向挤压矩形也将失败，因为靠近末端的点应该真正使用圆测试中的点：

```
|-------------
| *    /
|    --
|   /
|  /
| |
| |
|/
|         |--------| <- the line segment 
```

其中 * 在扩展矩形内部但在圆形端盖外部，这将是一个更严格的测试。

现在，距离测试可能不是“乌鸦飞”测试，而是图形搜索，例如，仅使用道路将它们连接在一起的道路 x 英里内的点：

```
--------------------------------------------------- < the road
   |
   |              * <- target
...|..............|................................ < check distance
   |              |
   |--------------| <- roads to target 
```

在上图中，目标位于搜索区域内，但沿可用道路到达目标将大于允许的距离。

无论您选择实施测试，都将需要循环算法中的基本循环。

检查约束是“如乌鸦飞”约束的约束的方法：

1.  几何上：首先，确定点 P 到直线的距离。然后，如果该点在约束范围内，则将点 P 投影到线段上，其中线定义为：

    ```
    L = P1 + (P2-P1).n 
    ```

    其中 P1 和 P2 是端点，n 是参数变量。如果投影 P 的 n 值在 0 <= n <= 1 范围内，则该点位于 P1 和 P2 之间。最后，对以 P1 和 P2 为中心的圆进行圆点测试。

2.  变换：为每个线段创建一个变换矩阵，使 P1 变换为原点，P2 变换为 (|P1-P2|, 0)。然后将每个变换应用于所有点，然后测试矩形（0，-约束）-（|P1-P2|，约束）中的每个点。此方法可以使用 SIMD 或 GPU 进行高度优化

3.  以图形方式：使用带有圆形端盖且宽度与约束距离成比例的笔将线段绘制到位图。然后，对于每个测试点，检查该点对应的位图中的像素。这并不准确（但更大的位图会产生更准确的结果，但需要更多内存），但一旦创建位图就会很快。

    如果约束是由沿图的路线定义的，它会变得更加复杂。您需要查看广度优先搜索，其中起点是每条线段的终点，终点是潜在目标。如果线段沿其长度有交汇点，则将线段分成没有交汇点的线段。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T17:22:35.053

我不确定我是否正确理解了这个问题，但[Dijkstra 的算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)不适合吗？它从源节点找到最短路径，您可以在达到最大距离后中止并检查已找到*s中的哪些点。*我不确定它在 SQL 上的表现如何。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-29T12:25:30.523

1.) 使用几何数据类型（或地理，如果它们是使用纬度/经度坐标定义的）将您的点存储在 SQL Server 2008 表中 这是一个脚本，用于创建随机分布在 (0,0) 和 ( 40,20):

```
DECLARE @Points table (
  id int,
  position geometry
  );

DECLARE @i int = 0, @x int, @y int;
WHILE (@i < 100)
BEGIN
  INSERT INTO @Points VALUES 
    (@i, geometry::Point(RAND() * 40, RAND() * 20, 0))
  SET @i = @i + 1;
END 
```

2.) 将您的线定义为线串，使用与您的点相同的数据类型和 SRID：

```
DECLARE @line geometry = 'LINESTRING(0 10, 10 15, 20 8, 40 10)'; 
```

3.) 在针对点表的 SELECT 查询的谓词中使用 STDistance() 方法。例如，要选择直线 5 个单位内的所有点：

```
SELECT * FROM @Points
WHERE @line.STDistance(position) < 5; 
```

更重要的是，由于 SQL Server 的空间方法在可再发行的 dll 中可用（Microsoft.SqlServer.Types.dll - SQL Server 功能包的一部分[http://www.microsoft.com/downloads/en/details.aspx? FamilyID=ceb4346f-657f-4d28-83f5-aae0c5c83d52](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=ceb4346f-657f-4d28-83f5-aae0c5c83d52)），您可以在 C# 中或直接在 SQL Server 中使用相同的方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-23T06:09:37.577

如果您想在 SQL 中至少完成一些工作，您可以计算路径的边界框，然后将位置在边界框内的条件合并到查询中。您仅针对返回的行运行其他算法之一。

这至少可以防止您必须为每个路径下载整个数据库。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T21:48:36.560

您应该能够通过矢量数学和触发来完成此操作，尽管确切的方法使我无法理解。

对于每个线段，计算需要将点从世界坐标转换为相对于线段的局部坐标的值（因此通过计算运行的任何点都将相对于线段为 x 轴的坐标系）

对于每个点运行以下检查：

1-如果该点在任一端点的距离内，我们知道它应该被包括在内。这是通过每个端点和目标点之间的简单距离^2 <= (x2 - x1)^2 + (y2 - y1)^2 计算来完成的。

2-通过变换运行目标点。如果 x >= 0 且 x <= (线段的长度) 且 |y| 转换后 <= 距离，则应包括目标点，否则应将其排除。

我的向量数学有点生疏，所以我无法提供更好的代码/示例对不起！但也许我的帖子会激励其他人写出正确的方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-16T14:13:23.897

I'm surprised no one has mentioned the A* alogirithm for this. It seems like a perfect fit. What am I missing here? If you're not familar with it, google and ye shall find =). (Yes, it does come from the gaming world...)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-22T16:54:39.193

I believe these two classes will answer your question. I built the GetArea() function using [Heron's Formula](http://en.wikipedia.org/wiki/Triangular#Using_Heron.27s_formula). Make sure that the Segment Points are always passed first to the IsPointWithinDistanceToLineSegment and the TestPoint is always passed 3rd.

EDIT: I stupidly used Point which only allows integers for X and Y. You'll need to fix this with another class that takes doubles or floats as X and Y...

```
public class Geometry
{
    public static double GetDistanceBetweenTwoPoints(Point SegmentStart, Point SegmentEnd)
    {
        return Math.Sqrt(Math.Pow(SegmentEnd.X - SegmentStart.X, 2) + Math.Pow(SegmentEnd.Y - SegmentStart.Y, 2));
    }

    public static bool IsPointWithinDistanceToLineSegment(Point SegmentStart, Point SegmentEnd, Point TestPoint, double TestDistance)
    {
        if (GetDistanceBetweenTwoPoints(SegmentStart,SegmentEnd) <= TestDistance || GetDistanceBetweenTwoPoints(SegmentEnd,TestPoint) <= TestDistance)
        {
            return true;
        }
        var T = new Triangle(SegmentStart, SegmentEnd, TestPoint);
        var BaseLength = GetDistanceBetweenTwoPoints(SegmentStart, SegmentEnd);
        var Area = T.GetArea();
        var TriangleHeight = 2* Area / BaseLength;
        return T.AB >= T.BC && T.AB >= T.AC && TriangleHeight <= TestDistance;
    }
}

public class Triangle
{
    public Triangle(Point a, Point b, Point c)
    {
        this.a = a;
        this.b = b;
        this.c = c;
    }

    public Point a
    {
        get;
        set;
    }

    public Point b
    {
        get;
        set;
    }

    public Point c
    {
        get;
        set;
    }

    //Lengths of Sides
    public double AB
    {
        get
        {
            return Geometry.GetDistanceBetweenTwoPoints(a, b);
        }
    }

    public double AC
    {
        get
        {
            return Geometry.GetDistanceBetweenTwoPoints(a, c);
        }
    }

    public double BC
    {
        get
        {
            return Geometry.GetDistanceBetweenTwoPoints(b, c);
        }
    }

    public double GetArea()
    {
        var Term1 = Math.Pow((Math.Pow(AB, 2) + Math.Pow(AC, 2) + Math.Pow(BC, 2)), 2);
        var Term2 = 2 * (Math.Pow(AB, 4) + Math.Pow(AC, 4) + Math.Pow(BC, 4));
        var result = .25 * Math.Sqrt(Term1 - Term2);
        return result;
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-21T16:49:47.303

您可以使用四叉树将空间划分为段，然后仅用于靠近路径的段中的点吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-29T10:59:18.503

给定通用计算工具，您最好的算法将是过滤掉明显不感兴趣的点并找到从每个线段到每个剩余点的距离的一些变化。（建议的多边形解决方案是错误的——感兴趣的区域是该多边形与围绕*l上每个点的半径为**d*的圆的并集——实际上比简单地找到每个点到每个线段的距离效率低。）

 *哪些过滤器最好取决于您的数据的性质——例如，在示例图中，过滤*l*的边界框（加上*d*）将非常有用。

一个有趣的过滤器是：给定点*p*定义*l*，取一个半径为*r*的圆，其中*r*是部分由*p*加上*d*定义的两个段的最大长度。只有这个圆内的点才能与这两个线段足够接近才能在我们的解决方案集中，因此我们可以快速确定是否可以跳过这两个线段距离计算。（如果某些线段很长，这将降低效率，但如果它们是，这些线段可以很容易地分解成更小的块。）

# asp.net - ASP.NET Web 应用程序测试体验

> ID：465943
> 
> 赞同：0
> 
> 时间：2009-01-21T16:24:18.680
> 
> 标签：asp.net, unit-testing, testing, custom-server-controls

在我们的项目中，我们有 20 个简单的 Web 控件，8 个复合 Web 控件，包括 Ajaxable Custom Grid。并且所有模块都是依赖于这些控件而开发的。

现在我害怕更改控件，因为它对模块的影响比我想象的要大。

我知道为时已晚，但我需要为我的控件编写一些测试用例。

我在网上搜索并找到了 WatiN。它看起来不错，但我需要知道它是否有效？

我也想听听你在 WatiN 或其他工具上的经验。如果您有不同的解决方案/技术来测试您的 Web 应用程序/核心自定义控件，我想了解详细信息，您遇到的问题。

感谢所有的答复 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T21:30:13.837

+1 为[WatiN](http://watin.sourceforge.net/)，就像一个魅力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T16:29:42.287

[Selenium](http://seleniumhq.org/)对我来说是一个很好的工具。它在 Firefox 中提供了一个 IDE 来手动创建测试，并且有一个可以相当容易地自动化的测试运行器。[它由对工作非常扎实的ThoughtWorks](http://www.thoughtworks.com/)提供支持/开发，因此它不太可能很快消失。

硒的一些特性：

*   适用于大多数主流浏览器（不确定谷歌浏览器）*   支持javascript（可以写case来检查javascript值）*   支持 Java、C#、Ruby、Perl、PHP 和 Python

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T16:37:17.640

硒 +100。我在上一份工作（一个高流量的公共网站）中将它用于回归测试，它极大地增强了我对发布不会破坏网站的信心。

# c# - 以编程方式停止导航

> ID：465946
> 
> 赞同：0
> 
> 时间：2009-01-21T16:25:04.060
> 
> 标签：c#, asp.net

在 .NET（特别是 C#）中，如何停止导航？

情况：用户点击了一个链接并触发了 _Click() 事件。

click 事件触发 save 方法，该方法验证一些信息。如果任何信息不符合要求，我们希望阻止其余的点击事件发生。

ASP.NET 的内置验证在这种情况下不起作用。根据数据的初始状态，可能需要以多种不同的方式填写表单（表单由多个不同的控件构建，每个控件用于多个页面）。例如，如果他们是第一次点击此表单（并且他们之前从未添加过其中包含的任何信息），则 NOTHING 是必需的……但如果他们填写任何内容，他们必须填写（几乎）所有内容。

在验证中有这么多条件逻辑，在页面上粘贴（空）标签并在需要时用验证消息填充它们比使用实际验证器更容易。

我们的问题是触发 Save() 的方法然后将用户移动到另一个页面。

没有我们可以用来指定“停止导航”的返回值......所以我怎样才能触发该方法，设置“错误”标签，然后阻止调用返回堆栈（并将用户从这页纸）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T16:31:55.433

响应。结束（）；

听起来你有一些意大利面条逻辑。您想将验证分解为一个方法，如果它返回 false，则停止处理 Save 等。

我希望您的代码看起来像；

```
if (Validation())
{
    if (DoSaveFunction())
    {
         Response.Redirect("theNextPage.aspx");
    }
    else
    {
         lblWarning.Text = "Something went wrong saving the file";
    }
}
else
{
    lblWarning.Text = "Invalid inputs";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T16:33:18.600

不过，您可以使用 CustomValidator 并处理 ServerValidate 事件以执行此自定义验证？

可以通过调用 Response.End() 来结束 HTTP 请求；如果页面无效，听起来您应该能够阻止执行重定向操作。

# .net - 拖放控制 - 邪恶？

> ID：465947
> 
> 赞同：3
> 
> 时间：2009-01-21T16:25:17.257
> 
> 标签：.net, controls, drag-and-drop

我不能忍受像线程和计时器这样的拖放控件。这些控制感觉与它们存在的实际本质相去甚远。拖放线程？我希望拖放器在他们这样做之前了解幕后发生的事情。

这些抽象是不是离金属太远了？他们是在帮助还是伤害程序员？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T16:32:57.850

我不认为他们是邪恶的。在窗体上删除控件只是“new Thread()”或“new Timer()”的另一种说法，许多程序员也并不真正理解。

简单的解决方案并不总能满足您的需求，但当它们满足时，使用它们有什么问题？

然而，如果使用拖放的东西是程序员知道如何做事的*唯一*方法，那不是一个很好的程序员。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T16:29:11.307

我认为他们正在伤害程序员。拖放不是编程。

我可能会用大笔画笔，但令我震惊的是，我遇到的大多数 Web 应用程序开发人员（特别是 .NET WebForm 开发人员）在涉及 HTTP 模型、POST 和 POST 等基本知识时完全缺乏知识。由于他们遇到了抽象，GET 超出了他们的掌握。

[这篇文章](http://www.charlespetzold.com/etc/DoesVisualStudioRotTheMind.html)读起来很有趣，完全反映了我的观点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T16:26:52.467

就个人而言，我没有理由在我的职业生涯中使用多线程编程，尽管我确实在大学学习过。所以 Timer 控件对我有很大帮助，特别*是因为*我不想学习如何在 .NET 中进行多线程编程，只是为了获得一个简单的功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T16:30:10.040

“拖放”意味着使用 IDE 的所见即所得部分？

我是在 VB6 和 Dreamweaver 代码中长大的，所以如果是这样的话，我会选择**“非常肯定”**。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-21T16:52:06.627

BackgroundWorker 增加了真正的价值。它生成的代码（通过使用事件模型）比通过使用委托调用手动执行线程，然后使用 Control.Invoke 将结果编组回 UI 线程来生成更简洁的代码。

我在没有测试 Control.IsHandleCreated 的情况下测试 Control.InvokeRequired 已经被烧死了。当代码已经在 UI 线程上执行并且控件不存在时，Control.InvokeRequired 将返回 false。如果我使用 BackgroudWorker，我可能不会遇到这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T17:19:55.183

（从问题上的 .Net 标记来看，我假设我们在谈论拖放控件时谈论的是 Visual Studio 设计者。）

我不认为它们是邪恶的，尽管我同意它并不总是最适合组件（如 Thread）的隐喻。

对我来说，控件的拖放并不是“这是一个远离金属的 UI 组件”的声明。相反，这是我“希望设计师为我管理此组件的生命周期”的声明。从这个角度来看，通过拖放添加诸如后台工作者之类的东西是非常明智的。事实上，这是我最喜欢的将任何 IDisposable 对象包含为（例如）UserControl 或 Form 的成员的方法。这样，代码生成器就为我处理好了，我可以更多地关注我的代码*所做*的事情，而不是布线。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T16:30:50.100

我认为对于基本的长期运行；或一种情况，后台工作人员控制非常适合这些情况。如果您正在做比这更高级的事情，那么您应该研究线程和多线程设计的高级用途。

因此，对于一种快速启动和运行线程的方法，它并没有什么坏处。但是将其用作执行线程的唯一方法，那么它肯定会伤害程序员。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T16:34:04.463

它是一个 UI 隐喻。

您拖放的东西应该是文件、文档或其他“东西”到容器、垃圾箱、碎纸机、打印机或其他“东西”的“东西”。

将线程/任务拖放到计时器会失去基本的比喻并且感觉不对。

右键单击和下拉对于像“开始计时器”这样的“动词”来说要好得多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-21T17:06:00.093

好消息是，由于 .NET，拖放控件不需要使用拖放样式。我个人认为，虽然拖放对于原型制作来说是可以的，但您的要求越复杂，您就越有可能发现设计师的限制和阻碍。一个简单的例子是当您调整包含窗口大小时应该扩展的表单。您很快就会发现自己编写了如此多的代码，以致于完全放弃设计器会更好。

那是在我们讨论设计器中的错误之前，例如，删除所有事件......

# css - HTML / CSS - DIV 元素不应该隐藏？

> ID：465950
> 
> 赞同：7
> 
> 时间：2009-01-21T16:26:37.223
> 
> 标签：css, html, visibility

[![](https://i.stack.imgur.com/ocrX1.jpg)](https://i.stack.imgur.com/ocrX1.jpg) （可点击）

Mainad 具有有效的高度和宽度，但它不像 subad1/subad2 那样显示。本质上是完全一样的！（只是不同的背景图像）。

Firebug 出于某种奇怪的原因将我的 div 显示为灰色。仅用一些文本替换 mainad 的内容并不能解决问题（问题与内部元素无关）..

这是怎么回事？！:(

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-21T16:41:44.667

你有安装 AdBlock 吗？那可能隐藏了那个div。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T09:57:48.570

一个额外的小提示：当 AdBlock Plus 阻止它时，FireBug 实际上会在样式窗格中显示类似这样的内容（为清楚起见包装）：

```
.mainad, #mainad {             undefined (line 233)
    -moz-binding:url(chrome://global/content/bindings/
     general.xml?abphit:707307897865#basecontrol) !important;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-01T19:29:09.793

Firebug 将没有 HTML 内容的选择器或块元素样式显示为灰色。如果您编辑 HTML 并添加一些副本，您将看到选择器恢复其颜色。

# java - 抛出异常来控制流程 - 代码异味？

> ID：465953
> 
> 赞同：6
> 
> 时间：2009-01-21T16:26:55.367
> 
> 标签：java, exception-handling

考虑这段代码（特别是Java）：

```
public int doSomething()
{
    doA();

    try {
        doB();
    } catch (MyException e) {
        return ERROR;
    }

    doC();
    return SUCCESS;
} 
```

其中`doB()`定义为：

```
private void doB() throws MyException 
```

基本上，`MyException`仅在`doB()`满足某些条件（这不是灾难性的，但确实需要以某种方式提高此条件）的情况下才存在，以便`doSomething()`知道退出时出错。

您是否发现使用异常（在这种情况下用于控制流程）可以接受？或者这是代码的味道？如果是这样，您将如何重构它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-21T16:34:59.140

doB() 失败时执行 doC() 真的很重要吗？如果不是，为什么不简单地让异常向上传播到可以有效处理的堆栈。就个人而言，我认为使用错误代码是一种代码气味。

**编辑：**在您的评论中，您已经准确描述了您应该简单声明的场景

```
public void doSomething() throws MyException 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-21T16:44:42.383

这完全取决于错误条件是什么，以及方法的工作是什么。如果返回`ERROR`是为调用函数处理该错误的有效方法，为什么它会不好？

然而，它通常*是*一种气味。考虑一下：

```
bool isDouble(string someString) {
    try {
        double d = Convert.ParseInt32(someString);
    } catch(FormatException e) {
        return false;
    }
    return true;
} 
```

这是一个非常大的代码气味，因为您不期望双值。您只想知道字符串是否包含双精度。

有时，您使用的框架没有其他方法可以做您想做的事。对于上述情况，有一个更好的方法：

```
bool isDouble(string someString) {
    bool success;
    Convert.TryParseInt32(someString, ref success);
    return success;
} 
```

这类例外有一个特殊的名称，由我最近读到的某个人的博客所创造，但遗憾的是，我忘记了它的名字。如果您知道，请发表评论。最后但同样重要的是，上面是伪代码。我不是 C# 开发人员，所以上面的内容无法编译，我敢肯定，但是`TryParseInt32`/`ParseInt32`证明了我认为的很好，所以我将使用 C#。

现在，到你的代码。让我们检查两个函数。一个有气味，另一个没有：

### 1\. 气味

```
public int setupSystem() {
    doA();

    try { doB(); }
    catch (MyException e)
    { return ERROR; } 

    doC();
    return SUCCESS;
} 
```

那是*代码异味*，因为当您想设置系统时，您不希望它失败。未能设置系统意味着如果不处理该错误就无法继续。

### 2.好的

```
public int pingWorkstation() {
    doA();

    try { doB(); }
    catch (MyException e)
    { return ERROR; } 

    doC();
    return SUCCESS;
} 
```

没关系，因为该方法的目的是测试工作站是否仍然可以访问。如果不是，那么这是该方法结果的一部分，而不是需要替代返回路径的例外情况。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-21T16:39:02.223

我对 OP 代码的唯一问题是您正在混合范式—— doB 通过抛出异常来显示错误，而 doSomething 通过返回代码来显示错误。理想情况下，您会选择其中一个。当然，在遗留维护中，您可能没有那么奢侈。

如果您选择返回错误代码，那没关系，但我不喜欢它，因为它鼓励您使用侧通道（如全局变量）在失败时传达状态，而不是将该状态捆绑到异常中并让它在堆栈中冒泡，直到您可以做点什么。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-21T16:31:35.310

我从不喜欢对控制流使用异常（在某些语言中，比如 CLR，它们很昂贵）。

如果您可以修改**doB()**，最好将其更改为返回一个指示成功或失败的布尔值，因此您的示例如下所示：

```
public int doSomething()
{
    doA();

    if (!doB()) {
        return ERROR;
    }

    doC();
    return SUCCESS;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-21T17:27:19.393

在以下情况下应使用例外：

*   功能无法正常完成，并且
*   当没有可用于指示失败的返回值时，或
*   当抛出的异常传递的信息多于`return FAILURE;`嵌套异常等时。

首先要记住，异常，如返回值或方法参数，只是在代码的不同部分之间发送的消息。努力优化通过这些方法传递的信息与 API 的简单性之间的平衡。如果只需要一个简单的 SUCCESS/FAILURE 标志（并且该方法不需要返回其他值），请使用它。如果该方法已经必须返回一个值，您通常需要使用异常（也就是说，从一种方式来看，只是该方法的“异常”返回值）。如果必须传达的故障信息太丰富而无法在返回值中传达（例如，I/O 失败的原因），请使用异常。

最后，错误处理是一种设计决策，没有一套适用于所有情况的通用规则。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-21T16:32:45.073

使用异常来*控制流程*，绝对是不好的。只有在异常情况下才应该抛出异常。

但是，拥有一个简单地抛出异常或什么都不做的实用方法并不是特别糟糕。例如，您可能希望在进入方法时验证所有参数，或者检查内部状态在复杂计算之间是否仍然有效（由于某种原因您不能在内部强制执行，也许您正在接受闭包并执行它们）。在这些情况下，将一致性检查提取到自己的方法中并不是一个坏主意，以提高“实际”方法实现的可读性。

真正的分界线是，当遇到超出正常操作参数的情况时，您应该抛出异常，并且情况非常糟糕，以至于该方法没有真正的方法来继续它所做的事情。

作为不做什么的一个例子**，**这将使用异常进行流控制：

```
public int calculateArraySize(Object[] array)
{
   int i = 0;
   try
   {
      array[i++];
   }
   catch (ArrayIndexOutOfBoundsException ignore) {}
   return i;
}
```

我相信它会返回正确的结果，但它会非常缓慢和低效，并且对于习惯于正确使用异常的人来说难以阅读。;-)

另一方面，在我看来，这样的事情是可以的：

```
public void myMethod(int count, Foobar foo) throws MyPackageException
{
   validateArgs(count, foo);

   // Stuff
}

private void validateArgs(int count, Foobar foo) throws MyPackageException
{
   if (m_isClosed)
   {
      throw new IllegalStateException("Cannot call methods on a closed widget");
   }

   if (count < 0)
   {
      throw new IllegalArgumentException("count must be greater than zero");
   }

   foo.normalise(); // throws MyPackageException if foo is not fully initialised at this point
}
```

尽管第二种方法所做的所有事情都可能引发异常，但这样做并不是为了控制程序流，而是为了响应异常情况而引发它们。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-21T16:34:57.097

发生错误时抛出 Exception 是可以的，如 doB()。但问题是函数doSomething()。

您不应该使用 return 语句来指示成功或失败。你应该做：

```
try { 
    doB();
} catch (MyException e) {
    throw MyException2(e);
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-08-04T02:54:11.267

异常不应仅用于控制流程。应使用检查的异常来告诉调用代码 API 合约的某些条件没有得到满足。我不会设计通过使用块`doSomething`来处理调用经常失败的情况。如果频繁失败是您需要处理的情况，我会设计返回成功或失败以指示其调用方法是否继续使用它们自己的-type 方法：`doB``try/catch``doB``boolean``doC`

```
public int doSomething() {
    doA();

    if ( doB() )
       doC();
       return SUCCESS;
    } else { 
       return ERROR; 
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-21T16:32:49.083

根据 doB 的逻辑，您可以有一些返回值指向它是否正常，然后 doSomething 可以使用返回的值以适当的方式处理这种情况。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-21T16:41:46.583

非标准行为例外。所以**是**的，可以使用它们来控制流量。

正如孙所说：

> 一般来说，不要仅仅因为您不想为指定方法可以抛出的异常而烦恼，就抛出 RuntimeException 或创建 RuntimeException 的子类。
> 
> 这是底线准则：如果可以合理地期望客户端从异常中恢复，则将其设为已检查异常。如果客户端无法从异常中恢复，请将其设为未经检查的异常。

请记住不要子类 RuntimeException 而是 Exception 因为它们更快。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-21T16:32:19.163

我认为这是非常糟糕的异常使用，简单明了。我将创建返回正常值的正常函数，并为它们的设计目的留下异常。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-21T18:48:54.037

正如其他人所指出的，这实际上取决于此处涉及的方法的预期功能。if`doSomething()`的作用是检查某些东西，返回一个允许正常执行其调用方法的代码（尽管根据返回的代码在不同的路径上）然后让它返回该 int 可能没问题。但是，在这种情况下，`doB()`可能应该是一致的并返回一个布尔值或`doSomething()`可以检查的东西，而不是抛出一个不会真正做任何其他事情的异常。

如果`doB()`是另一个类的公共方法，该方法可能在外部有其他用途`doSomething()`（与您指示的同一类中的私有方法相反）并且它引发异常并且您想在`doSomething()`其中使用它（指示的角色相同上面），那么你的例子就可以了。

`doB()`但是，您在抛出异常时返回的代码被调用这一事实`ERROR`表明，它可能是一个失败，它会阻止`doSomething()`作为其中一部分的任何操作完成。在这种情况下，您可能不应该捕获抛出的异常`doB()`，而是让它被抛出堆栈，直到它到达可以处理的点或直到它到达可以报告/记录它或其他任何内容的一般错误处理程序。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-21T20:25:03.733

在 C# 中，抛出异常在性能方面相对昂贵——因此是避免将它们用于流控制的另一个原因。Java中是这种情况吗？是的，有一个理由是不要提前过度分析性能。但如果你知道某事需要额外的时间，而且很容易避免，你不应该这样做吗？除非你真的不在乎！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-02-20T20:59:19.417

请参阅此问题的最佳答案：

[Java 异常有多慢？](https://stackoverflow.com/questions/299068/how-slow-are-java-exceptions)

事实证明，它们至少比正常代码流慢 50 倍。所以我想说在通常的代码运行中使用异常绝对是个坏主意。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-01-21T19:37:08.370

这是我将如何处理它：

```
public void doSomething() 
        throws MyException{
    doA();

    try { 
        doB();
    } finally {
        doC();
    }
} 
```

如果 doB() 中发生错误，异常将向上传播到堆栈。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-01-21T20:38:42.987

你们在这里杀了我。您永远不想使用异常来控制流程。这与到处使用 goto 语句没有太大区别！

异常就是异常，意味着发生了意想不到的事情。如此之多，以至于我们正在停止应用程序的执行。任何在应用程序上工作过的人都会希望找到这样做的开发人员并扼杀他（或她）。

使用异常作为流控制使维护和新功能开发成为一场噩梦！

# asp.net - ASP.NET 动态单选按钮 - 如何添加验证

> ID：465954
> 
> 赞同：0
> 
> 时间：2009-01-21T16:27:05.210
> 
> 标签：asp.net, validation, radio-button

目前我有这样的事情

```
<asp:Repeater ID="rptEventsList" DataSourceID="srcQuestionList" runat="server"> 
<ItemTemplate>

<td><span><%# Eval("orderBy").ToString()%>)</span></td>

<td><%# Eval("question").ToString()%></td>

<td><asp:RadioButton ID="RadioButton1" runat="server" /></td>

<td><input name="question<%# Eval("orderBy").ToString()%>" type="radio" id="True" value="True" class="styled" /></td>

<td><input name="question<%# Eval("orderBy").ToString()%>" type="radio" id="False" value="False" class="styled" /></td> 
</tr>

</ItemTemplate> 
</asp:Repeater> 
```

在后面的代码中，我捕获了`Request.Form("question1")`例如值，这一切都很好。

现在我想知道如何为此添加验证，我想我必须对`RadioButton`控件应用更改，但我看不到如何在其中添加动态`RadioButton`名称和存储过程中的 id。

我还想将验证添加到屏幕顶部作为验证摘要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T16:32:31.877

查看[验证服务器控件](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp)。

# objective-c - 缓存结构对象

> ID：465956
> 
> 赞同：0
> 
> 时间：2009-01-21T16:27:25.927
> 
> 标签：objective-c, cocoa-touch

如何在 Objective-C 中为结构指针对象创建缓存？是否有任何第三方组件可以像 Java 和 .NET 那样缓存对象？

我有以下结构：

```
typedef struct _news {
  references
  char *headline;
  char *story_url;
} news; 
```

我在接口类中有一个用于上述结构的双指针。我想使用Objective-C将它缓存一段时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T19:10:42.523

你在寻找这样的东西吗？

```
// save
NSMutableData *data = [[NSMutableData alloc] init];
[data appendBytes:&p length:sizeof(news)];

// read
struct news *begin = (struct news *)[data bytes]; 
```

# delphi - 线性变换函数

> ID：465971
> 
> 赞同：2
> 
> 时间：2009-01-21T16:32:08.413
> 
> 标签：delphi, math, transformation

我需要编写一个以 4 个字节作为输入的函数，对此执行可逆线性变换，并将其作为 4 个字节返回。

但是等等，还有更多：它还必须是可分配的，因此在输入上更改一个字节应该会影响所有 4 个输出字节。

问题：

*   如果我使用乘法，它在通过存储作为字节修改 255 后将不可逆（并且它需要保持为字节）
*   如果我使用加法，它就不能可逆和分配

一种解决方案：我可以创建一个长度为 256^4 的字节数组并以一对一的映射方式填充它，这会起作用，但是存在问题：这意味着我必须搜索大小为 256^8 的图形，因为必须为每个值搜索免费数字（应注意分配性应该是基于 64*64 字节数组的 sudo 随机数）。该解决方案还存在需要 8GB RAM 的次要 (lol) 问题，这使得该解决方案毫无意义。

输入的域与输出的域相同，每个输入都有一个唯一的输出，换句话说：一对一映射。正如我在“一个解决方案”中指出的那样，这是很有可能的，当有一个较小的域（只有 256 个）存在问题时，我使用了该方法。事实是，随着数字变大，该方法变得异常低效，delta 缺陷`O(n^5)`和 omega`O(n^8)`在内存使用方面也有类似的缺陷。

我想知道是否有一个聪明的方法来做到这一点。简而言之，它是域的一对一映射（4 字节或 256^4）。哦，像 N+1 这样简单的东西不能使用，它必须是一个 64*64 字节值数组，这些字节值是 sudo 随机的，但可以重新创建以进行反向转换。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T16:43:42.230

[平衡块混合器](http://www.ciphersbyritter.com/BBM.HTM)正是您正在寻找的。

谁知道？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T18:08:41.947

编辑！如果您确实想要线性变换，这是**不可能的。**这是数学解决方案：

您有四个字节，`a_1, a_2, a_3, a_4`我们将其视为**`a`**具有 4 个分量的向量，每个分量都是一个模 256 的数字。线性变换只是一个 4x4 矩阵`M`，其元素也是模 256 的数字。您有两个条件：

1.  从`M`**`a`**，我们可以推断**`a`**（这意味着它`M`是一个*可逆*矩阵）。
2.  如果**`a`**和**`a'`**在单个坐标上不同，那么`M`**`a`**和`M`**`a'`**必须在*每个*坐标上都不同。

条件 (2) 有点棘手，但这就是它的含义。由于`M`是线性变换，我们知道

> `M`( **`a`**- **`a`**) = `M`**`a`**-`M`**`a'`**

在左边，因为**`a`**和**`a'`**在单个坐标上不同，所以**`a`**-**`a`**恰好有一个非零坐标。在右边，因为`M`**`a`**和`M`**`a'`**必须在每个坐标上不同，`M`**`a`**-`M`**`a'`**必须使*每个*坐标都非零。

因此，矩阵`M`必须将具有单个非零坐标的向量变为具有所有非零坐标的向量。所以我们只需要 的每个条目`M`都是一个*非零除数*模 256，即奇数。

回到条件（1），`M`可逆是什么意思？由于我们正在考虑它 mod 256，我们只需要它的[行列式](http://en.wikipedia.org/wiki/Determinant)是可逆 mod 256；也就是说，它的行列式必须是奇数。

因此，您需要一个 4x4 矩阵，其中包含奇数项 mod 256，其行列式是奇数。但这是不可能的！为什么？通过对条目的各种乘积求和来计算行列式。对于 4x4 矩阵，有 4 个！= 24 个不同的加数，每个加数都是*奇数*项的乘积，都是奇数。但是24个奇数的和是偶数，所以这样的矩阵的行列式一定是偶数！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T16:36:35.410

我不确定我是否理解你的问题，但我想我明白你想要做什么。

Bitwise Exclusive Or 是您的朋友。

如果 R = A XOR B，则 R XOR A 给出 B 并且 R XOR B 返回 A。所以这是一个可逆的转换，假设你知道结果和输入之一。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T18:07:21.123

据我了解，这是您的要求：

1.  设`B`为字节空间。你想要一个一对一（因此也就是）函数`f: B^4 -> B^4`。
2.  如果您更改任何单个输入字节，则所有输出字节都会更改。

这是我*迄今为止*最简单的解决方案。我有一段时间避免发帖，因为我一直在尝试提出更好的解决方案，但我没有想到任何事情。

好的，首先，我们需要一个`g: B -> B`接收单个字节并返回单个字节的函数。这个函数必须有两个性质：g(x) 是可逆的，x^g(x) 是可逆的。[注意：^ 是 XOR 运算符。] 任何这样的 g 都可以，但我稍后会定义一个特定的。

给定这样的 ag，我们定义 f 为 f(a,b,c,d) = (a^b^c^d, g(a)^b^c^d, a^g(b)^c^d, a^b^g(c)^d)。让我们检查您的要求：

1.  可逆：是的。如果我们对前两个输出字节进行异或，我们得到 a^g(a)，但是通过 g 的第二个属性，我们可以恢复 a。对于 b 和 c 也是如此。在得到 a、b 和 c 后，我们可以通过用 (a^b^c) 对第一个字节进行异或来恢复 d。
2.  分配：是的。假设 b、c 和 d 是固定的。然后函数采用 f(a,b,c,d) = (a^const, g(a)^const, a^const, a^const) 的形式。如果 a 发生变化，那么 a^const; 同样，如果 a 改变，g(a) 也会改变，g(a)^const 也会改变。（如果 a 发生，g(a) 发生变化的事实是 g 的第一个属性；如果没有，则 g(x) 将不可逆。）b 和 c 也是如此。对于 d，它更容易，因为 f(a,b,c,d) = (d^const, d^const, d^const, d^const) 所以如果 d 改变，每个字节都会改变。

最后，我们构造了这样一个函数g。令 T 为两位值的空间，`h : T -> T`函数满足 h(0) = 0、h(1) = 2、h(2) = 3 和 h(3) = 1。该函数有两个g 的期望性质，即 h(x) 是可逆的，x^h(x) 也是可逆的。（对于后者，检查 0^h(0) = 0、1^h(1) = 3、2^h(2) = 1 和 3^h(3) = 2。）所以，最后，计算 g(x)，将 x 分成四组，每组两位，分别取每个四分之一的 h。因为 h 满足两个期望的性质，并且四等分之间没有相互作用，所以 g 也是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T17:16:24.377

假设我了解您要做什么，我认为任何[分组密码](http://en.wikipedia.org/wiki/Block_cipher)都可以完成这项工作。
块密码采用一个比特块（比如 128）并将它们可逆地映射到具有相同大小的不同块。

此外，如果您使用的是[OFB 模式](http://en.wikipedia.org/wiki/OFB)，您可以使用分组密码来生成无限的伪随机位流。将这些位与您的位流进行异或运算将为您提供任何长度数据的转换。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T17:15:17.797

您所说的“线性”转换是什么意思？O(n)，或者一个函数 f 与 f(c * (a+b)) = c * f(a) + c * f(b)？

一种简单的方法是旋转位移（不确定这是否满足上述数学定义）。它是可逆的，每个字节都可以更改。但是有了这个，它并不强制每个字节都被改变。

编辑：我的解决方案是这样的：

```
b0 = (a0 ^ a1 ^ a2 ^ a3)
b1 = a1 + b0 ( mod 256)
b2 = a2 + b0 ( mod 256)
b3 = a3 + b0 ( mod 256) 
```

它是可逆的（只需从另一个字节中减去第一个字节，然后在第一个字节上对 3 个结果字节进行异或运算），并且一个位的变化会改变每个字节（因为 b0 是所有字节的结果并影响所有其他字节） .

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T17:23:43.507

我将抛出一个可能行不通的想法。

使用一组线性函数 mod 256，具有奇数素数系数。

例如：

```
b0 = 3 * a0 + 5 * a1 + 7 * a2 + 11 * a3;
b1 = 13 * a0 + 17 * a1 + 19 * a2 + 23 * a3; 
```

如果我正确地记住了中国剩余定理，并且我多年没有看过它，那么斧头可以从 bx 中恢复。甚至可能有一种快速的方法来做到这一点。

我相信这是一个可逆的转变。它是线性的，因为 af(x) mod 256 = f(ax) 和 f(x) + f(y) mod 256 = f(x + y)。显然，改变一个输入字节将改变所有输出字节。

所以，去查一下中国剩余定理，看看这是否有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T17:58:40.843

将所有字节粘贴到 32 位数字中，然后执行 shl 或 shr（左移或右移）一、二或三。然后将其拆分回字节（可以使用变体记录）。这会将位从每个字节移动到相邻字节。

这里有很多很好的建议（XOR 等），我建议将它们结合起来。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-21T17:59:28.737

您可以重新映射这些位。让我们使用 ii 作为输入，使用 oo 作为输出：

```
oo[0] = (ii[0] & 0xC0) | (ii[1] & 0x30) | (ii[2] & 0x0C) | (ii[3] | 0x03)
oo[1] = (ii[0] & 0x30) | (ii[1] & 0x0C) | (ii[2] & 0x03) | (ii[3] | 0xC0)
oo[2] = (ii[0] & 0x0C) | (ii[1] & 0x03) | (ii[2] & 0xC0) | (ii[3] | 0x30)
oo[3] = (ii[0] & 0x03) | (ii[1] & 0xC0) | (ii[2] & 0x30) | (ii[3] | 0x0C) 
```

它不是线性的，但是显着改变输入中的一个字节会影响输出中的所有字节。我不认为您可以进行可逆转换，例如更改输入中的一位会影响输出的所有四个字节，但我没有证据。

# php - PHP 中可能的多实例对象问题

> ID：465975
> 
> 赞同：1
> 
> 时间：2009-01-21T16:32:45.370
> 
> 标签：php, class, object, instantiation

即使对象已被调用，我也会在第 35 行的 page.class.php 中的非对象上调用成员函数 process_data()。

这是 index.php 提取显示正在实例化的对象

```
// require our common files
require("modules/module.php");
require("registry/objects/datetime.class.php");
require("registry/objects/page.class.php");

// load in all the objects
$datetime = new dateandtime;
$page = new page;
$module = new module; 
```

然后它传递给 Process 类

```
 require("template.class.php");
        $template = new template($php_path . "controllers/themes/adm/" . $page . ".html");

        // Place in both commonly used language and page specific language
        $template->language($php_path . "controllers/language/en/adm/common.php");
        $template->language($php_path . "controllers/language/en/adm/" . $page . ".php");

        // Tell the page's module to load in data it needs
        $module->process_data("module_" . $page);

        // Output the final result
        $template->output(); 
```

正是在这一点上，PHP 正在抛出错误。module.php文件内容如下

```
class module {

    public function process_data ($child) {
        require($child . ".php");
        read_data();
        return true;
    }
} 
```

我已经尝试将实例声明移动到第二个粘贴的代码中，但这会产生更多错误，因为“模块”调用的类也使用了一些“模板”类 - 所以同样的问题发生在更远的地方线。

我哪里错了她，或者完全错过了，我确定是后者，但我真的需要帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T16:40:49.490

当您尝试调用对象方法时，它看起来好像变量 $module 不在范围内。你能在 $module->process_data("module_" . $page) 之前尝试 var_dump($module)。这个函数的结果是什么？快速解决方案可能是声明 $module 全局变量，但全局变量无论如何都不是一个好主意（但您可以检查它是否有效）。

# java - java问题中的正则表达式，多个匹配项

> ID：465979
> 
> 赞同：4
> 
> 时间：2009-01-21T16:33:13.483
> 
> 标签：java, regex

我正在尝试匹配 HTML 文档中的多个 CSS 样式代码块。此代码将匹配第一个但不会匹配第二个。我需要什么代码来匹配第二个。我可以只得到我的“风格”括号内的组列表吗？我应该调用“查找”方法来获得下一场比赛吗？

这是我的正则表达式模式

```
^.*(<style type="text/css">)(.*)(</style>).*$ 
```

用法：

```
final Pattern pattern_css = Pattern.compile(css_pattern_buf.toString(), 
                    Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);

 final Matcher match_css = pattern_css.matcher(text);
        if (match_css.matches() && (match_css.groupCount() >= 3)) {
            System.out.println("Woot ==>" + match_css.groupCount());
            System.out.println(match_css.group(2));
        } else {
            System.out.println("No Match");
        } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-21T17:28:06.960

> 我正在尝试匹配 HTML 文档中的多个 CSS 样式代码块。

标准答案：不要使用正则表达式来解析 HTML。正则表达式无法可靠地解析 HTML，无论您的表达式多么复杂和聪明。除非您绝对确定目标文档的确切格式是完全固定的，否则字符串或正则表达式处理是不够的，您必须使用 HTML 解析器。

```
(<style type="text/css">)(.*)(</style>) 
```

那是贪婪的表情。中间的 (.*) 将尽可能匹配。如果您有两个样式块：

```
<style type="text/css">1</style> <style type="text/css">2</style> 
```

那么它会很高兴地匹配'1</style> <style type="text/css">2'。

使用 (.*?) 获得一个非贪婪表达式，这将允许尾随 (</style>) 在第一时间匹配。

> 我应该调用“查找”方法来获得下一场比赛吗？

是的，你也应该用它来获得第一场比赛。通常的成语是：

```
while (matcher.find()) {
    s= matcher.group(n);
} 
```

请注意，标准字符串处理（indexOf 等）可能比正则表达式更简单，因为您只使用完全固定的字符串。但是，标准答案仍然适用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T17:31:51.727

您可以按如下方式简化正则表达式：

```
(<style type="text/css">)(.*?)(</style>) 
```

如果您不需要第 1 组和第 3 组（可能不需要），我会删除括号，仅保留：

```
<style type="text/css">(.*?)</style> 
```

# c# - Type.IsSubclassOf() 不能跨 AppDomains 工作？

> ID：465984
> 
> 赞同：7
> 
> 时间：2009-01-21T16:33:27.693
> 
> 标签：c#, reflection, types, appdomain

我在使用以下代码时遇到了一些问题：

```
private class ClientPluginLoader : MarshalByRefObject
{
    public bool IsPluginAssembly(string filename)
    {
        AppDomain.CurrentDomain.ReflectionOnlyAssemblyResolve += new ResolveEventHandler(CurrentDomainReflectionOnlyAssemblyResolve);

        Assembly asm = Assembly.ReflectionOnlyLoadFrom(filename);

        Type[] types = asm.GetTypes();
        foreach (Type type in types)
        {
            if (type.IsSubclassOf(typeof(ClientPlugin)))
            {
                return true;
            }
        }

        return false;
    }
} 
```

该代码是通过我通过自定义应用程序域的 CreateInstanceFromAndUnwrap() 创建的代理调用的。这意味着 IsPluginAssembly() 在我的自定义应用程序域的上下文中执行。

问题是对 IsSubclassOf() 的调用总是返回 false，即使恕我直言它应该返回 true。有问题的“类型”确实继承自 ClientPlugin - 毫无疑问。

ClientPlugin 是在另一个私有程序集中定义的，我正在手动解析它，如上面的代码片段所示。

我`if (type.IsSubclassOf(...))`在行上放了一个断点并确认这个表达式是错误的：

```
type.BaseType == typeof(ClientPlugin) 
```

另一方面，这个表达式是真的：

```
type.BaseType.FullName == typeof(ClientPlugin).FullName 
```

这怎么可能？这是怎么回事？

更新：Kent Boogaart 为我指明了正确的方向。我在网上搜索了更多，然后遇到了[这篇](http://blogs.microsoft.co.il/blogs/sasha/archive/2007/03/06/Assembly-Load-Contexts-Subtleties.aspx)博文。看来我必须解决我的 Load/LoadFrom/ReflectionOnlyLoadFrom 冲突才能完成这项工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T16:53:54.173

这是由于加载到不同的上下文中。如何加载程序集（Load / LoadFrom / ReflectionOnlyLoad）决定了它被加载到哪个上下文。这个简单的例子也说明了这个问题：

```
using System;
using System.Reflection;

class Foo
{
    public static void Main()
    {
        var type = typeof(Foo);
        var reflectionLoadType = Assembly.ReflectionOnlyLoad("ConsoleApplication1").GetType("Foo");
        Console.WriteLine(type == reflectionLoadType);  //false
        Console.WriteLine(type.Equals(reflectionLoadType));  //false

        Console.WriteLine("DONE");
        Console.ReadKey();
    }
} 
```

请参阅[此处](http://blogs.msdn.com/suzcook/archive/2003/05/29/57143.aspx)了解更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T16:43:17.347

我有一个类似的问题。我也有这个架构——一个包含 ClientPlugin 基类的 .DLL；几个引用此 .DLL 的插件；和一个主应用程序，它也引用了这个 .DLL。问题是带有 ClientPlugin 基类的 .DLL 被复制到两个文件夹中——插件文件夹和主应用程序文件夹。因此它在我的 AppDomain 中加载了两次（插件也间接加载了它）。而当主应用程序试图做反射类型魔法时，它失败了，因为有两个 ClientPlugin 类型的实例。

虽然我不认为这正是你的情况，但这里仍然有一个教训要学习 - 如果 .DLL 被加载两次，类型也会被复制。在您的情况下，我会怀疑单独的 AppDomain 或“ReflectionOnlyLoad”，因为 .DLL 然后以某种方式加载。

# php - 重写“漂亮的 URL”时如何处理变音符号（口音）

> ID：465990
> 
> 赞同：19
> 
> 时间：2009-01-21T16:34:54.977
> 
> 标签：php, url-rewriting, diacritics

我重写了 URL 以包含用户生成的旅游博客的标题。

我这样做是为了 URL 的可读性和 SEO 目的。

```
http://www.example.com/gallery/280-Gorges_du_Todra/

```

第一个整数是 id，其余的是我们人类（但与请求资源无关）。

现在人们可以编写包含任何 UTF-8 字符的标题，但大多数都不允许在 URL 中。我的听众一般说英语，但由于他们旅行，他们喜欢包括像这样的名字

```
阿伊特·本·哈杜

```

什么是在 linux 上使用 PHP 在 URL 中显示的正确方法。

到目前为止，我已经看到了几种解决方案：

1.  只是去掉所有不允许的字符，替换空格这会产生奇怪的结果：
    `'Aït Ben Haddou' → /gallery/280-At_Ben_Haddou/`
    不是很有帮助。

2.  只需删除所有不允许的字符，替换空格，留下字符代码（stackoverflow.com），很可能是因为使用了“regex-hammer”，
    这会产生奇怪的结果： `'tést tést' → /questions/0000/t233st-t233st`

3.  翻译为“最接近的等价物”
    `'Aït Ben Haddou' → /gallery/280-Ait_Ben_Haddou/`
    但这对德语来说是错误的；例如“ü”应音译“ue”。

对我来说，作为一个荷兰人，第三个结果“看起来”是最好的。
然而，我很确定（1）很多人会有不同的意见，（2）在德国的例子中这是完全错误的。

第三个选项的另一个问题是：如何找到可以转换为 7 位等效字符的所有可能字符？

所以问题是：

1.  在您看来，最理想的结果是什么。（在技术限制内）

2.  如何在技术上解决它。（达到预期的结果）用 PHP。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-21T17:06:37.080

最终，对于这个问题，你将不得不放弃“正确”的想法。无论您如何翻译字符串，都会以兼容性和可读性的名义破坏准确性。所有三个选项都同样兼容，但＃1和＃2在可读性方面受到影响。因此，只需运行它并选择看起来最好的东西 - 选项＃3。

是的，德语的翻译是错误的，但是除非您开始要求您的用户指定他们的标题所用的语言（并将它们限制为只有一种语言），否则您不会不付出更多的努力就解决这个问题。（例如，通过字典为每种已知语言运行标题中的每个单词并根据其语言规则翻译该单词的变音符号会*起作用*，但这是过度的。）

或者，如果德语比其他语言更受关注，当存在德语版本时，让您的翻译*始终*`ä`使用德语版本： →<code>ae, `ë`→<code>e, `ï`→<code>i, `ö`→<code>oe, `ü`→<代码>ue。

**编辑：**

哦，至于实际的方法，我会翻译特殊情况，如果有的话，通过`str_replace`，然后使用`iconv`其余的：

```
$text = str_replace(array("ä", "ö", "ü", "ß"), array("ae", "oe", "ue", "ss"), $text);
$text = iconv('UTF-8', 'US-ASCII//TRANSLIT', $text); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T16:41:06.743

对我来说，第三个是最易读的。

您可以使用一个小字典，例如`ï -> i`并`ü -> ue`指定您希望如何翻译各种字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T17:23:27.953

作为一个有趣的旁注，在 ID 之后似乎没有什么真正重要 - 这是此页面的链接：

[重写“漂亮的 URL”时如何处理变音符号（口音）](https://stackoverflow.com/questions/465990/why-does-this-link-go-to-the-same-place)

显然，这样做的动机是允许在不中断链接的情况下更改标题，您可能也需要考虑该功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-23T21:38:11.650

不错的话题，前段时间我也遇到了同样的问题。
这是我修复它的方法：

```
function title2url($string=null){
 // return if empty
 if(empty($string)) return false;

 // replace spaces by "-"
 // convert accents to html entities
 $string=htmlentities(utf8_decode(str_replace(' ', '-', $string)));

 // remove the accent from the letter
 $string=preg_replace(array('@&([a-zA-Z]){1,2}(acute|grave|circ|tilde|uml|ring|elig|zlig|slash|cedil|strok|lig){1};@', '@&[euro]{1};@'), array('${1}', 'E'), $string);

 // now, everything but alphanumeric and -_ can be removed
 // aso remove double dashes
 $string=preg_replace(array('@[^a-zA-Z0-9\-_]@', '@[\-]{2,}@'), array('', '-'), html_entity_decode($string));
} 
```

这是我的功能的工作原理：

1.  将其转换为 html 实体
2.  去掉重音
3.  删除所有剩余的奇怪字符

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T17:40:58.103

> 现在人们可以编写包含任何 UTF-8 字符的标题，但大多数都不允许在 URL 中。

相反，大多数是允许的。参见例如 Wikipedia 的 URL——像[http://en.wikipedia.org/wiki/Café](http://en.wikipedia.org/wiki/Caf%C3%A9)（又名[http://en.wikipedia.org/wiki/Caf%C3%A9](http://en.wikipedia.org/wiki/Caf%C3%A9)）这样的东西显示得很好——即使 StackOverflow 的荧光笔没有t 正确挑选它们:-)

诀窍是在任何托管环境中可靠地读取它们；例如，CGI 和 Windows 服务器（尤其是 IIS）存在问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-24T12:54:02.123

这是一个很好的功能：

```
function friendlyURL($string) {
    setlocale(LC_CTYPE, 'en_US.UTF8');
    $string = iconv('UTF-8', 'ASCII//TRANSLIT//IGNORE', $string);
    $string = str_replace(' ', '-', $string);
    $string = preg_replace('/\\s+/', '-', $string);
    $string = strtolower($string);
    return $string;
} 
```

# java - 使用 JOGL 在屏幕外绘制

> ID：465994
> 
> 赞同：4
> 
> 时间：2009-01-21T16:35:13.570
> 
> 标签：java, graphics, jogl

作为一个更大项目的一部分，我正在尝试使用 JOGL 实现一个设施，它将 3D 渲染导出为位图格式。为此，我们创建一个 GLJPanel 并绘制我们想要的场景，然后提取位图。只要系统在屏幕上至少有一个可见窗口，这一切都可以正常工作 - 不一定是包含我们正在绘制的面板的窗口。

但是如果我们尝试在不使任何窗口可见的情况下执行此操作，则 GLJPanel 将不会绘制。逐步浏览 JOGL 源代码，我发现它不会绘制，除非它有一个有效的对等点 - 基本上除非 addNotify() 已经调用它。文档说 addNotify() 仅在面板成为可见窗口层次结构的一部分时才被调用。更改为 GLCanvas 并没有太大区别 - 故障模式不同。未设置 WindowsOnscreenGLDrawable.realized ，这意味着 lockSurface 返回`LOCK_SURFACE_NOT_READY`，导致 makeCurrent() 失败。

欢迎提供有关如何创建可以创建和导出 3D 场景而无需使其窗口可见的 Java 应用程序的任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T18:47:42.307

不确定我是否应该回答我自己的问题，但我发现现在似乎可行。

关键是**GLPbuffer**，它是一个屏幕外的 GLAutoDrawable 并且可以在没有可见组件层次结构的情况下创建。

[这篇文章](http://today.java.net/pub/a/today/2008/10/30/integrating-glpbuffer-and-graphics2d.html)有助于让它发挥作用。在我确认它完全正常运行之前，我将不再接受这个答案。

我还应该说答案来自[这个论坛](http://www.javagaming.org/index.php/board,25.0.html)，而不是我自己微薄的大脑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T17:58:36.803

您应该查看方法：glReadPixels() 更多信息[here](http://www.felixgers.de/teaching/jogl/rwcPixels.html)。基本上它或多或少像这样工作：

```
Init(); //doing some initializations in your JOGL app

glDrawBuffer(GL_BACK);

DrawGLScene(); //doing drawing here

glReadBuffer(GL_BACK);

//Copy the image to the array imageData
glReadPixels(0, 0, WIDTH, HEIGHT, GL_RGBA, GL_UNSIGNED_BYTE, imageData); 
```

# security - 我的网站被黑了，htaccess 文件被盗，它应该是什么样子？

> ID：465997
> 
> 赞同：2
> 
> 时间：2009-01-21T16:36:09.123
> 
> 标签：security, apache, .htaccess

我维护的一个无偿网站被黑客入侵，向游戏网站等发送 302。www.rebekahshouse.org。在通过我的托管公司的控制面板进行大量搜索后，我在 htaccess 文件中找到了罪魁祸首。它看起来像这样：
`RewriteEngine on
RewriteCond %{HTTP_REFERER} .oogle.com [NC,OR]
RewriteCond %{HTTP_REFERER} .ahoo.com [NC,OR]
RewriteRule .*hxxp://87.248.180.89/topic.html?s=s- [C,L]`

（我认为那是 C，L；我重写了它并尝试在上面重新创建它，可能在这里和那里错过了一部分）

无论如何，我用这个覆盖了它：

`order allow,deny deny from all`

这对我有用吗？我的 .htaccess 文件中应该有什么？这纯粹是一个静态 html 网站。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T16:41:33.950

如果您正在运行一个静态站点，则很可能您的 .htaccess 中不需要任何内容​​。然后，您应该检查您的网站实际上是如何被黑客入侵的……就好像您还没有解决它会再次发生一样。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-21T16:49:39.750

您真正关心的应该是它最初是如何发生的。破坏者等经常回去，并会在以前破解的网站上再次尝试同样的事情，因为很多时候漏洞都没有修复。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-21T16:51:46.643

htaccess 文件是附带的。您已被俄罗斯恶意软件团伙之一入侵。如果您不关闭允许黑客发生的漏洞，您将再次被黑客入侵。

服务器本身完全有可能遭到入侵，并且上面还有更多您不知道的东西，例如木马软件，它不仅可能破坏您的网站，而且还会对他人发起攻击、发送垃圾邮件等。假设对包含 htaccess 文件的目录具有适当的权限，即使您在那里有不安全的 Web 应用程序，也不应该在其中写入文件。当然，如果您只处理静态文件，那么此类文件可能到达那里的唯一方法是通过您的上传帐户，或者服务器本身受到损害。

如果它是您的服务器，正如我从它响应 IP 地址直接查询的事实中猜测的那样，您需要将其展平并从最新软件重新安装，使用新密码，并检查您自己的客户端计算机从感染重新上传。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T17:52:30.950

（根据@YGomez 的评论：首先，您需要关闭允许创建该 .htaccess 文件的漏洞，否则恶意软件几乎会立即返回；我可能应该明确提到这一点）

第一部分会将所有来自 yahoo 和 google 的访问者重定向到 87.248.180.89

第二部分（“允许，拒绝”）将拒绝所有人访问您的网站。

我建议简单地删除 .htaccess 并完成它 - 如果你使用 .htaccess 文件，你会知道里面有什么，否则你不需要它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T16:40:38.630

不，这对你没有任何帮助。对于静态站点，您可能根本不需要 .htaccess 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-13T06:46:58.030

*   第一步：修改FTP密码
*   第 2 步：下载所有文件并清理
*   第三步：上传文件
*   第 4 步：为所有文件设置 444 权限，自定义上传文件夹除外

记住不要在您的 FTP 客户端中保存 FTP 密码。

如果您怀疑您的系统被感染，请格式化并安装操作系统，然后安装一个好的杀毒软件+防火墙。我建议 Avast 免费版和 Comodo Firewall。

我们收到了很多询问，我们清理了那些受感染的网站。***************