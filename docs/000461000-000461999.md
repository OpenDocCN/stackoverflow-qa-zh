# StackOverflow 问答 000461000-000461999

# sql - 将记录复制到另一个表添加字段

> ID：461004
> 
> 赞同：2
> 
> 时间：2009-01-20T11:54:56.413
> 
> 标签：sql, oracle

我有 2 张桌子：

`tab1`( `field1, field2, field3`)
`tab2`( `field1, field2,field3, field4`)

我想复制一条记录`tab1`以`tab2`获取所有字段**并**为`field4`.

如何选择`field1`,`field2`和`field3`from`tab2`并添加一个值？我知道`SELECT`和`VALUES`在`INSERT`查询中是互斥的。

提前致谢。
古斯塔沃。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-20T11:58:33.367

我不了解 Oracle，但在 MS SQL 中，它的工作方式如下：

```
insert into tab2 (field1, field2, field3, field4) 
select field1, field2, field3, 'New Value' from tab1 
```

# java - Java 和 Swing 中的跨平台按钮排序

> ID：461011
> 
> 赞同：3
> 
> 时间：2009-01-20T11:57:02.167
> 
> 标签：java, netbeans, cross-platform

我正在使用 Swing 和 Netbeans（组布局）创建一个跨平台应用程序。我是否缺少一个技巧来帮助开发具有不同平台的正确顺序的“确定”和“取消”按钮的对话框 - 特别是 Windows（确定-取消）和 Mac（取消-确定），而不是像`JOptionPane`那样？我可以从上面的两个按钮派生出我自己的类`JDialog`，并交换文本和动作——我只是想知道是否有一些“开箱即用”的东西我错过了。（这*不是*关于圆形按钮应该是哪种方式的问题，也不是关于动词使用的问题，例如 Save 而不是 Ok。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T12:12:32.057

[MiGLayout 开箱即用地](http://www.migcalendar.com/miglayout/ "米格布局")支持这一点。要么使用这个布局管理器，要么看看它是如何发挥它的魔力的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T12:16:41.190

Eclipse SWT 还提供平台感知布局。

# .net - 在 C# 3.0+ 中使用“var”声明时的性能损失（如果有）

> ID：461012
> 
> 赞同：3
> 
> 时间：2009-01-20T11:57:06.253
> 
> 标签：.net, c#-3.0

在 c# 3.0+ 中使用 var 声明是否有任何性能损失？Resharper 一直在唠叨我要自由地使用它，我想知道它是否有任何缺点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-20T11:59:02.973

var 关键字只告诉编译器从赋值中推断类型，所以本质上没有运行时差异，所以不，没有性能损失。

有没有坏处，那就另当别论了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T11:58:55.283

没有性能损失，因为类型推断是在编译时进行的。但是，由于缺少显式类型，它会使您的代码更难遵循。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T11:59:38.840

不，没有。生成的 IL 代码完全相同。增益是更具可读性的源代码（在大多数情况下无论如何）。

另请参阅[此问题](https://stackoverflow.com/questions/17032/should-i-always-favour-implictly-typed-local-variables-in-c-3-0)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T22:51:13.703

没有任何惩罚。在有效编译之前，编译器将 var 替换为适当的在编译时确定的类型。为了更可信，我什至制作了一个小应用程序来演示这一点，使用前 Lutz Roeder 的反射器，现在是 Red Gate 的反射器：

版本 1：

代码 ：

```
namespace ConsoleApplication28
{
    class Program
    {
        static void Main(string[] args)
        {
            var p = new Person("Andrei Rinea");
            System.Console.WriteLine(p);
        }
    }

    class Person
    {
        private string _name;
        public Person(string name) { _name = name; }
        public override string ToString() { return _name; }
    }
} 
```

CIL 生成（CIL 表示通用中间语言……有点像 Java 的字节码）：

```
.method private hidebysig static void Main(string[] args) cil managed
{
    .entrypoint
    .maxstack 2
    .locals init (
        [0] class ConsoleApplication28.Person p)
    L_0000: nop 
    L_0001: ldstr "Andrei Rinea"
    L_0006: newobj instance void ConsoleApplication28.Person::.ctor(string)
    L_000b: stloc.0 
    L_000c: ldloc.0 
    L_000d: call void [mscorlib]System.Console::WriteLine(object)
    L_0012: nop 
    L_0013: ret 
} 
```

版本 2（请注意在代码片段的第 7 行将“Var”替换为“Person”）

代码 ：

```
namespace ConsoleApplication28
{
    class Program
    {
        static void Main(string[] args)
        {
            Person p = new Person("Andrei Rinea");
            System.Console.WriteLine(p);
        }
    }

    class Person
    {
        private string _name;
        public Person(string name) { _name = name; }
        public override string ToString() { return _name; }
    }
} 
```

生成的 CIL

```
.method private hidebysig static void Main(string[] args) cil managed
{
    .entrypoint
    .maxstack 2
    .locals init (
        [0] class ConsoleApplication28.Person p)
    L_0000: nop 
    L_0001: ldstr "Andrei Rinea"
    L_0006: newobj instance void ConsoleApplication28.Person::.ctor(string)
    L_000b: stloc.0 
    L_000c: ldloc.0 
    L_000d: call void [mscorlib]System.Console::WriteLine(object)
    L_0012: nop 
    L_0013: ret 
} 
```

生成的 CIL 完全没有区别！

所以这就是最重要的;)

*编辑 1：这是在调试模式下编译的... prolly 在 Release 中 nop 将不存在... ;)*

# javascript - javascript中包含特殊字符的多行字符串？

> ID：461015
> 
> 赞同：0
> 
> 时间：2009-01-20T11:57:29.903
> 
> 标签：javascript, processing

我正在尝试使用[http://ejohn.org/blog/processingjs/](http://ejohn.org/blog/processingjs/)处的 javascript 处理端口我想使用以下构造函数。`Processing(CanvasElement, "some massive block of code");`我知道 javascript 本身并不支持多行字符串，但是有没有办法传递类似下面的内容而不必连接每一行并转义每个特殊字符？

```
/**
 * Array. 
 * 
 * An array is a list of data. Each piece of data in an array 
 * is identified by an index number representing its position in 
 * the array. Arrays are zero based, which means that the first 
 * element in the array is [0], the second element is [1], and so on. 
 * In this example, an array named "coswav" is created and
 * filled with the cosine values. This data is displayed three 
 * separate ways on the screen.  
 */

size(200, 200);

float[] coswave = new float[width];

for (int i = 0; i < width; i++) {
  float amount = map(i, 0, width, 0, PI);
  coswave[i] = abs(cos(amount));
}

for (int i = 0; i < width; i++) {
  stroke(coswave[i]*255);
  line(i, 0, i, height/3);
}

for (int i = 0; i < width; i++) {
  stroke(coswave[i]*255 / 4);
  line(i, height/3, i, height/3*2);
}

for (int i = 0; i < width; i++) {
  stroke(255 - coswave[i]*255);
  line(i, height/3*2, i, height);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T12:04:42.730

Javascript 实际上确实支持多行字符串：在每行的末尾附加一个反斜杠：

```
alert('1\
    2\
    3'); 
```

不是很漂亮，但它有效。

另一种方法是使用脚本对文本进行编码...我建议使用 PHP，因为它是 1-liner：

```
<?=json_encode('your text');?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T12:48:33.920

对于更易于维护的解决方案，我会将其放在页面正文中的脚本标签中，例如：

```
<script type="text/processing" id="code">
/**
 * Array. 
 * ...
 */

size(200, 200);
...
</script> 
```

并构造您的处理对象，例如：

```
var canvas = document.getElementById('canvas');
var code = document.getElementById('code');
Processing(canvas , code.textContent); 
```

[对于一个快速而肮脏的解决方案，按照RoBorg 的建议](https://stackoverflow.com/questions/461015/multi-line-string-containing-special-characters-in-javascript#461039)，通过 JSON 编码器运行您的处理代码，您将获得一个字符串，您可以将其复制并粘贴到第二个参数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T12:02:59.627

将“大量代码块”放在服务器上自己的文件中，使用 AJAX 获取并确保它具有合理的缓存标头。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T12:09:57.600

或者，您可以将文本放入 HTML 页面（例如，隐藏）并从那里获取...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T12:11:53.323

另一种选择是使用 E4X 文字

```
var s = "" + <r><![CDATA[
line 1
line 2
]]></r>; 
```

虽然我怀疑 IE6 是否支持它。

# java - 我的 Java 代码如何读取操作系统环境变量？

> ID：461018
> 
> 赞同：11
> 
> 时间：2009-01-20T11:58:31.853
> 
> 标签：java, operating-system, environment-variables

这可能是一个非常简单的问题，但我在谷歌上找不到答案，我很着急——所以我很感激快速的代码示例。

我想使用 Java 代码读取操作系统上的环境变量。我试过`System.getProperty`了，但这似乎只适用于`-D`直接为 JVM 提供的变量。

我的 Java 代码如何读取操作系统变量？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-20T12:01:32.360

尝试[System.getenv（字符串名称）](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#getenv(java.lang.String))

# asp.net-mvc - 从 Application_OnError (ASP.NET MVC) 获取正确的 Response.StatusCode

> ID：461026
> 
> 赞同：1
> 
> 时间：2009-01-20T11:59:34.330
> 
> 标签：asp.net-mvc, http-status-codes, application-onerror

我正在尝试为我的 ASP.NET MVC 应用程序中的未处理异常创建一些基本日志记录，但由于我使用的是 IIS6，所有请求都来自 .NET。现在，虽然我同意丢失的图像是一个重要的标记，但它们不是显示停止器，所以我想将 404 的事件优先级设置为高，除非它们是图像（这将获得中等优先级）。

问题是在`Application_OnError`里面`Response.StatusCode`是200，但是最后发出来的结果却是404。为此，我好像没能注意404s来设置合适的优先级。

有没有办法知道`StatusCode`会*发生*什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T21:32:21.943

您可以通过以下方式获得`Context.Server.GetLastError()`：

```
if ((Context.Server.GetLastError() is HttpException) && ((Context.Server.GetLastError() as HttpException).GetHttpCode() == 404))
{
    // do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T12:20:18.580

您必须将所有流量发送到 .net isapi 层并自己进行手动 404 检查（如果文件存在）我想

# sharepoint - BDC 寻呼

> ID：461037
> 
> 赞同：0
> 
> 时间：2009-01-20T12:03:55.150
> 
> 标签：sharepoint, paging, bdc

我将 SharePoint（业务数据列表 Web 部件）与 BDC 一起使用。我用它从数据库中取回数据，既简单又好。

但是，当我进行搜索时，我会收到一些由网页分页的结果。这需要一段时间才能恢复任何搜索结果（即使在分页数据之间导航时）。我猜测（请原谅我的无知）所有结果都返回并且分页是在 SharePoint 服务器上完成的，而不是在 SQL 级别。我们可以进行 SQL 分页吗，例如[SQL 分页](http://weblogs.asp.net/scottgu/archive/2006/01/01/434314.aspx)

请问有人可以对此有所了解吗？

亲切的问候骨头

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-14T05:38:09.040

你确定这会带回所有数据吗？这真的不是我看到它工作的方式。见[这里](http://blogs.msdn.com/enterprisesearch/archive/2008/05/22/understanding-total-hits-paging-in-the-moss-2007-search-api.aspx)和[这里](http://blog.mastykarz.nl/sharepoint-people-search-lessons-learned-covering-basics/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-23T10:28:43.653

使用带有列表视图 Web 视图的 JQuery 分页`part.List`Web 部件用于从共享点内容数据库填充数据

# .net - .NET 库从位图序列生成视频文件

> ID：461046
> 
> 赞同：4
> 
> 时间：2009-01-20T12:08:59.070
> 
> 标签：.net, video

是否有任何 .NET 库可以从给定的位图图像序列生成视频文件（任何类型）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T13:27:24.107

您可以使用[Splicer](http://www.codeplex.com/splicer)来执行此操作。

请参阅[http://www.codeplex.com/splicer/Wiki/View.aspx?title=News%20Feeds&referringTitle=Home上的示例 3](http://www.codeplex.com/splicer/Wiki/View.aspx?title=News%20Feeds&referringTitle=Home)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T12:35:45.070

你可以试试这个：

*[http://www.codeproject.com/KB/audio-video/avifilewrapper.aspx](http://www.codeproject.com/KB/audio-video/avifilewrapper.aspx)*

它是用 C# 编写的，它可以从位图列表中创建一个 avi 视频流。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-21T11:51:49.720

抱歉，这个线程有点晚了，但我[位图到视频](http://www.i-programmer.info/projects/38-windows/220-bitmaps-into-videos.html)使用旧的 vfw 技术在 C# 中完成工作

# .net - 有谁知道在各种 .Net 框架之间进行的任何性能基准测试

> ID：461048
> 
> 赞同：3
> 
> 时间：2009-01-20T12:09:24.590
> 
> 标签：.net

框架之间的性能差异是什么（对于相同/等效的代码）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T12:51:42.337

“等效代码”很棘手……例如，在引擎盖下和看不见的地方，代码可能会使用`Reflection.Emit`//之类的东西来生成动态（但高度优化的）代码`DynamicMethod`。`Delegate.CreateDelegate`这些不能普遍工作（例如，不适用于 CF 2.0）。

即使对于基本代码，JIT/GC 在平台和/或框架之间（甚至在不同的 CPU / 内核上）的工作方式也可能非常不同。例如，服务器 GC 与桌面 GC 不同。x86 和 x64 之间存在差异（不同的优化和成本）。所以恐怕它归结为特定领域的特定测试。粗略的“快 20%”不一定适用于代码的 CPU 密集型部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T12:11:45.710

[Mono 与 .NET 性能测试](http://geekswithblogs.net/CISCBrain/articles/Mono_vs_dotNet_Performance_Test.aspx)

# c# - gridview上复选框的事件？

> ID：461049
> 
> 赞同：2
> 
> 时间：2009-01-20T12:09:48.227
> 
> 标签：c#, .net

我在 Windows 应用程序的 gridview 上有一个复选框列。只要有人点击复选框，我就想要一个事件。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T12:41:14.997

这是一个示例：

```
<%@ Page Language="C#" AutoEventWireup="true" %>

<script runat="server">
    public class Item
    {
        public string Name { get; set; }
        public bool Checked { get; set; }
    }

    protected void Changed(object sender, EventArgs e)
    {
        CheckBox checkBox = sender as CheckBox;
        Response.Write(checkBox.Checked.ToString());
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            grid.DataSource = new[] 
            { 
                new Item() { Name="1", Checked = true },
                new Item() { Name="2", Checked = false } 
            };
            grid.DataBind();
        }
    }
</script>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:GridView ID="grid" runat="server" AutoGenerateColumns="false">
            <Columns>
                <asp:TemplateField>
                    <ItemTemplate>
                        <%# Eval("Name") %>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField>
                    <ItemTemplate>
                        <asp:CheckBox ID="check" runat="server" Checked='<%# Eval("Checked") %>' OnCheckedChanged="Changed" AutoPostBack="true" />
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </asp:GridView>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T15:28:00.960

新答案，因为现在我知道它是 Windows 窗体

首先，您需要将行设置为可编辑，以便用户在复选框中单击，以避免在客户端单击某行的 CELL 时您可以看到。

可以说第一个单元格是复选框：

第二个是一些文字...

我的 Form1.cs 代码

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        dgv.DataSource = new testData[] {
            new testData{ CheckBox = true, Name = "One" },
            new testData{ CheckBox = true, Name = "Two" },
            new testData{ CheckBox = false, Name = "Three" },
            new testData{ CheckBox = false, Name = "Four" }            
        };
    }

    private void dgv_CellMouseClick(object sender, DataGridViewCellMouseEventArgs e)
    {
        if (e.ColumnIndex == 0) // It's the Checkbox Column
        {
            DataGridViewRow dgvr = dgv.Rows[e.RowIndex];
            MessageBox.Show(String.Format("Row {0} was cliked ({1})", (e.RowIndex + 1).ToString(), 
                dgvr.Cells[1].Value));
        }
    }
}

public class testData
{
    public Boolean CheckBox { get; set; }
    public String Name { get; set; }
} 
```

设计...只需将 DataGridView 组件拖到窗口窗体中，命名为**dgv**并在事件中，双击事件**CellMouseClick**

# smalltalk - Smalltalk 学习项目：有什么推荐吗？

> ID：461052
> 
> 赞同：12
> 
> 时间：2009-01-20T12:10:25.917
> 
> 标签：smalltalk

目前我正在学习 Smalltalk。我这样做是因为我想在一周内尽可能多地学习一种新的编程语言，以提高我的技能。下周我会尝试别的。

到目前为止，我能够阅读 Smalltalk 代码，但我的写作经验非常有限。您能否向我推荐任何可以帮助我在短时间内更好地理解这种语言的小型项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T12:19:27.067

看一本书[Squeak by Example](http://www.squeakbyexample.org)，有很多例子可以练习和练习。一段时间后，您将为一些真实但迷你的项目做好充分准备。

我认为一本带有示例的书只需要几天时间，所以即使你只有一个星期，这也是花时间的好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-15T18:57:00.460

我真的非常喜欢[激光游戏教程](http://squeak.preeminent.org/tut2007/html/index.html)

> 教程：Squeak 3.9 的 Squeak 开发示例
> 
> 又名“激光游戏教程”这个由 Stephan Wessels 编写的优秀教程将指导您安装 Squeak，使用 Morphic 图形系统创建有趣的游戏，同时遵守可靠的面向对象设计原则

它分为 6 节课，所以每天 1 节课，尽管我必须说每个节课花了我两个小时左右。

非常适合您的目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T13:26:22.313

任何不太琐碎的事情都很顺利。如果你打算继续尖叫，我建议你写一个纸牌游戏、彩票或其他类似的东西。

不过，找出一些示例代码对您来说会更有用。是什么阻止您在 smalltalk 中编写 C？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T14:55:52.993

你可以看看用机器人编程。

我认为[BotsInc](https://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&cad=rja&uact=8&ved=0CCwQFjACahUKEwjD5K_k-JPJAhWFMBoKHXqJD7o&url=https%3A%2F%2Fgforge.inria.fr%2Ffrs%2Fdownload.php%2F10764%2FBotsInc-OriginalEnglish.pdf&usg=AFQjCNGnxxCTfhMrzMSaMxvRmAdDGm_lug&sig2=wgnlJGA6JoJ-Ff8GoB4aLg)的材料可以在一周内掌握——尽管所花费的时间可能会有所不同。有[免费书籍](http://squeak.org/documentation/)版本可供下载。对于小型现实世界项目，[NXTalk](http://haupz.blogspot.com/2008/11/its-alive.html)将于今年年初宣布。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T06:26:52.340

用你已经知道的语言做任何你想做的事。像写一个简单的 TODO 列表甚至是简单的博客这样的小任务无疑会提高你的 Smalltalk 技能。

记住要对自己轻松一点。期待太多太快可能会令人生畏。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-10T12:16:12.293

如果您想尝试一些不同的东西，请查看[http://skim.la/gnu_smalltalk_koans/](http://skim.la/gnu_smalltalk_koans/)上的 GNU Smalltalk Koans ，这是一组测试，以按照 Edgecase 的 Ruby Koans 和 Python Koans 的传统教您 Smalltalk。

它有望通过测试逐步加深您对语言的理解。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-15T19:05:41.333

除了激光游戏教程。（我在之前的回答中推荐过）

有“[保龄球比赛](http://ronjeffries.com/xprog/articles/bowlingforsmalltalk/)”

> 文章：发现更好的代码系列
> 
> 又名“保龄球示例”通过 Smalltalker 的思维导览：如何从头开始构建商业模式，并在此过程中将其分解。如果您不了解 Smalltalkers 的想法或为什么他们会这样想，您需要阅读本系列。

这个项目的真正好处是它就像是一个伟大的开发人员的结对程序员。

作者 Ron Jeffries 是极限编程的创始人之一和书籍作者。

所以它是一个非常好的资源。我希望有更多这样写的教程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-30T15:01:09.620

我真的很喜欢 Ted Bracht 的 Dolphin Smalltalk 教程：

[http://www.amazon.co.uk/Dolphin-SmallTalk-Tutorial-Ted-Bracht/dp/0201737930](http://www.amazon.co.uk/Dolphin-SmallTalk-Tutorial-Ted-Bracht/dp/0201737930)

它会带您逐步完成基于 GUI 的 Windows 应用程序。这是一个很好的教程。

# c++ - C++ anonymous variables

> ID：461062
> 
> 赞同：7
> 
> 时间：2009-01-20T12:13:52.943
> 
> 标签：c++, c-preprocessor

Why won't this work?

```
 0\. #define CONCAT(x, y) x ## y
 1\. 
 2\. #define VAR_LINE(x) \
 3\.     int CONCAT(_anonymous, __LINE__) = x
 4\. 
 5\. #define VAR_LINE2(x) \
 6\.     int _anonymous ## x = 1
 7.
 8\. int main()
 9\. {
10\.     VAR_LINE(1);
11\.     VAR_LINE(1);
12\.     VAR_LINE(1);
13\.     VAR_LINE2(__LINE__);
14\. } 
```

The result from the above macro expansion

```
int _anonymous__LINE__ = 1;
int _anonymous__LINE__ = 1;
int _anonymous__LINE__ = 1;
int _anonymous13 = 1; 
```

It would be convenient if I didn't have to write that `__LINE__` macro as an argument.

I'm thinking the problem is pretty clear. I want to be able to generate anonymous variables so that this macro doesn't fail with redefinition error when declaring several variables within the same scope. My idea was to use the predefined `__LINE__` macro because no variable will ever be declared on the same line like this. But the macro expansion troubles me, can you help?

# Update: Correct answer

Thanks to Luc Touraille. However, there was a tiny problem with the suggested solution. There has to be whitespace between the operands and the ## operator (apparently the standard says otherwise but the the PS3 flavoured GCC would not expand the macro properly if there were no whitespace between the operator and operands).

```
#define _CONCAT(x,y) x ## y
#define CONCAT(x,y) _CONCAT(x,y) 
```

The VAR_LINE macro now yields:

```
int _anonymous10 = 1;
int _anonymous11 = 1;
int _anonymous12 = 1; 
```

This has been verified to work under Win32 (Visual Studio 2008), XBOX360 (Xenon) and PS3.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-20T12:55:28.273

You need to add a level of indirection so that `__LINE__` will be expanded:

```
#define _CONCAT_(x,y) x ## y
#define CONCAT(x,y) _CONCAT_(x,y)

#define VAR_LINE(x) int CONCAT(_anonymous, __LINE__) = x 
```

# jquery - JQuery 与 WPF？可能在 Adob e AIR 上？

> ID：461068
> 
> 赞同：0
> 
> 时间：2009-01-20T12:16:57.977
> 
> 标签：jquery, wpf

根据我对 Adob​​e AIR 的了解，您可以使用 Javascript/HTML 开发桌面应用程序。

WPF 是否也允许使用 Javascript/JQuery 来构建控件？或者微软在这里的交互性解决方案仅仅是 XAML？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T12:20:44.537

WPF 只是一种桌面技术。即使在 wpf 中编写 xbap 时，浏览器也只是一个容器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T08:00:25.683

Silverlight 是您的答案。Blounty 是对的，我不相信此时您能够轻松地使用 Javascript/JQuery 和 WPF 来开发自定义控件。他还在评论中提到使用 Silverlight。

这是一个带有示例代码的博客条目的链接：[JQuery with Silverlight](http://www.cynotwhynot.com/blog/post/Fun-with-Silverlight-and-jQuery.aspx)

# bash - 使用 bash 创建缩进文本

> ID：461074
> 
> 赞同：6
> 
> 时间：2009-01-20T12:18:27.507
> 
> 标签：bash, string

我想以可读的方式将列表打印到屏幕上。我使用循环遍历每个元素并创建一个新列表，该列表用逗号和换行符格式化。问题是在输出的第一行，我想要一个标题。例如，我想打印这样的东西：

```
List: red, green, blue, black, cars,
      busses, ... 
```

问题是在第二行和以下行中创建缩进。我希望缩进具有给定的长度。因此，问题被简化为创建一个给定长度的空行。也就是说，我想要一个函数，`create_empty_line_of_length`输出给定数量的空格。

```
length=5
echo "start:$(create_empty_line_of_length $length) hello" 
```

在这种情况下，输出应该是：

```
start:      hello 
```

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-20T12:45:50.977

```
 printf '%7s' 
```

将可能是最有效的方法。

它在大多数情况下都是内置的，如果不是 /usr/bin/printf 作为 coreutils 的后备存在。

所以

```
 printf '%7s%s\n%7s%s\n' '_' 'hello' '_' 'world' 
```

生产

```
 _hello
      _world 
```

（我在这里使用 _ 而不是空格，但空格也可以，因为 bash 理解 ' ' ）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-20T12:24:01.457

这将是

```
yes ' ' | head -7 | tr -d '\n' 
```

将“7”更改为您的号码。

也许你应该看看

```
man fmt 
```

还。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T11:49:38.390

不确定这是否会对您有所帮助[http://unstableme.blogspot.com/2008/12/awk-formatting-fields-into-columns.html](http://unstableme.blogspot.com/2008/12/awk-formatting-fields-into-columns.html)

# multithreading - 操作系统多线程差异

> ID：461088
> 
> 赞同：8
> 
> 时间：2009-01-20T12:23:31.567
> 
> 标签：multithreading, operating-system, haiku

我问这个问题是因为我正在研究 Haiku OS（BeOS 的后代）。

BeOS 操作系统的目标是创建一个能够很好地处理多媒体并且响应速度非常快的桌面环境。他们通过创建具有“普遍多线程”的内核来管理这一点。

其他操作系统（Linux、Windows 等）没有这种“普遍多线程”，因此响应速度不快。（请不要进行火焰战争......）

有人可以解释“普遍多线程”（如 BeOS/Haiku 中）与 Windows 或 Linux 中使用的多线程之间的（细微）差异吗？

开发人员对不同的多线程系统有何影响？

* * *

我发现了一个关于 BeOS 多线程的有趣网站... [BeOS 多线程](http://testou.free.fr/www.beatjapan.org/mirror/www.be.com/aboutbe/benewsletter/volume_III/Issue6.html#Insight)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T23:01:59.970

复制自我为现已关闭的问题“BeOS [关闭] 有什么或曾经如此了不起”的答案，但在这里非常适用：

从记忆中看，BeOS 开发的奇怪之处在于 GUI 确实是多线程的，这与其他平台上的 GUI 框架不同，后者往往是绝对单线程的。

这意味着为 BeOS 开发 GUI 应用程序是完全不同的，但我认为这意味着 GUI 的响应速度更快，不需要在应用程序级别进行显式设计来处理 GUI 交互。

当然，这确实意味着使用互斥锁等更为重要，并且将 GUI 应用程序从其他操作系统移植到 BeOS 是很困难的，除非通过使用和执行单个应用程序范围内的单个应用程序将 BeOS GUI 库有效地转变为单线程库互斥体。

Linux、Windows 和几乎所有其他我认为我在过去十年中使用的操作系统都支持多线程，Linux 和 Windows 都以截然不同的方式利用多线程但做得非常好 - 但是，BeOS 确实普遍使用多线程 -这通过例如 GUI 框架很明显，而大多数其他框架都是严格的单线程的。（或者，在最极端的情况下，*允许*多个线程访问具有未定义的后果......）

# msbuild - MSBuild ContinueOnError

> ID：461091
> 
> 赞同：1
> 
> 时间：2009-01-20T12:25:38.553
> 
> 标签：msbuild, biztalk

我有一个 MSBuild 项目，如下所示：

```
<Target Name="StopApplications">
    <BizTalk.BuildGenerator.Tasks.StopApplication MessageBoxConnection="$(BizTalkManagementDatabaseConnectionString)" ApplicationName="x.Direct.Brackmills"/>
    <BizTalk.BuildGenerator.Tasks.StopApplication MessageBoxConnection="$(BizTalkManagementDatabaseConnectionString)" ApplicationName="x.Direct.Manhattan"/>
</Target>

<Target Name="RemoveApplications">
    <Exec Command="BTSTask RemoveApp -ApplicationName:x.Direct.Brackmills -Server:$(BizTalkDatabaseServerName) -Database:$(BizTalkManagementDatabaseName)" />
    <Exec Command="BTSTask RemoveApp -ApplicationName:x.Direct.Manhattan -Server:$(BizTalkDatabaseServerName) -Database:$(BizTalkManagementDatabaseName)" />
</Target> 
```

我的问题是，当调用“RemoveApplications”目标时，ContinueOnError 不能按我的预期工作。我有一长串要停止和删除的应用程序。它们不会一直都在，所以我需要脚本在发现它们不存在时继续。这似乎适用于“StopApplications”目标，但是当它遇到“RemoveApplications”目标中丢失的应用程序时，我收到以下消息：

“在项目“cleardownApplications.proj”中完成构建目标“RemoveApplications”——失败。构建继续，因为任务“CallTarget”上的“ContinueOnError”设置为“true”。

但随后，它退出“RemoveApplications”并移至“AddApplications”

感激地收到任何帮助，

谢谢

抢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T16:13:31.667

我以不同的方式解决了这个问题，并在删除应用程序之前使用单独的目标来检查应用程序是否存在。

```
<Target Name="ApplicationExists">
    <BizTalk2006.Application.Exists Application="$(ApplicationName)">
        <Output TaskParameter="DoesExist" PropertyName="ApplicationExists" />
    </BizTalk2006.Application.Exists>
</Target> 
```

我使用该存在目标作为其他目标中的“条件”。

```
<Target Name="DeleteApplication" Condition="$(ApplicationExists)=='True'" DependsOnTargets="ApplicationExists">
    <BizTalk2006.Application.Stop Application="$(ApplicationName)"/>
    <BizTalk2006.Application.Delete Application="$(ApplicationName)"/>
</Target> 
```

# c++ - 查看编译器扩展代码 - C++

> ID：461093
> 
> 赞同：12
> 
> 时间：2009-01-20T12:26:53.543
> 
> 标签：c++, templates, macros, compiler-construction

我了解到编译器会在编译时扩展宏。模板也在编译时展开。有没有办法看到这个扩展的代码？我正在使用 Visual Studio 2008 进行编译。

有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-20T12:32:07.260

VC++ 编译器 (cl.exe) 为此支持一些命令行开关：

```
/E preprocess to stdout
/P preprocess to file
/EP preproscess to stdout with no #lines 
```

可以在项目属性中添加其他命令行开关。在我的版本（VC2005）中，配置选项 -> C/C++ -> 命令行 -> 附加选项

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-20T12:40:26.260

编译器实际上并不做任何宏扩展。那是预处理器的任务。这一切看起来都是一步，但编译器实际上分叉到一个单独的预处理器任务并为您捕获输出。

模板在编译时不会“扩展”。它们在编译期间被实例化。不同之处在于编译器立即为模板生成目标代码；没有中间源代码出来。您不能将实例化的模板代码视为源代码，它会在需要时作为程序集被丢弃。

如果您有 GCC，您还可以使用带有正确参数的“cpp”直接调用预处理器（主要包括路径和命令行宏定义）。其他人已经回答了 MSVC。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-20T12:44:51.167

请注意，VC++ 中的 /E 仅扩展预处理器语句（即 #include、#ifdef、#define 等）

我不知道任何允许扩展模板的现代编译器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T12:34:49.300

要发出预处理代码，请直接调用 cpp 或在 gcc 和相关编译器中使用 -E 选项；我确信其他编译器或套件也有类似的东西（实际上，根据其他答案，它是 VC++ 中的 /E 或 /P）。

不确定输出实例化模板。我认为这更难做到，因为它实际上是编译的一部分而不是预处理（至少在现代编译器中，因为原始的 cfront 版本是一个 c++ 到 c 的翻译器，如果我没记错的话）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T14:49:52.443

It's easy to add an option to compilers to show the output after macro substitution. That's defined as a simple text substitution option anyway. Many compilers implement this as a separate stage, sometimes even handled as a separate tool. In any case, the result of the macro substitution is a collection of Translation Units in text form.

Templates, on the other hand, are compiled. There are multiple stages to this. Names are resolved twice, for instance. In either stage, the compiler would store the result of the name lookup. That's a table entry. How would you show that in text form? There's no trivial C++ expression for that.

# c# - 前导零日期格式 C#

> ID：461098
> 
> 赞同：32
> 
> 时间：2009-01-20T12:28:35.723
> 
> 标签：c#, datetime

我有这个功能...

```
private string dateConvert(string datDate)
{
        System.Globalization.CultureInfo cultEnGb = new System.Globalization.CultureInfo("en-GB");
        System.Globalization.CultureInfo cultEnUs = new System.Globalization.CultureInfo("en-US");

        DateTime dtGb = Convert.ToDateTime(datDate, cultEnGb.DateTimeFormat);
        datDate = dtGb.ToString(cultEnUs.DateTimeFormat.ShortDatePattern);

        return datDate;
} 
```

但我希望它的前导零仍然在较低的数字（1-9）上，所以日期是 11-09-2009（mm-dd-yyyy）...

现在如果我没有转换它 id 使用 string.Format("{0:d}", dateVar) 我如何在转换中做到这一点？

******* 解决方案 *******

使用了以下答案的略微修改版本（即可以渲染的版本）。

```
Convert.ToDateTime(datDate).ToString("MM-dd-yyyy"); 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-20T12:31:47.323

```
return dateTimeValue.ToString("MM-dd-yyyy"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T12:33:56.303

`string.Format`完成转换后不能使用吗？

IE`return string.Format("{0:d}", datDate);`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-04-03T13:24:12.577

为了可用性和可读性，我建议使用最新的 C# 速记（格式说明符）：

```
return dateTimeValue:MM-dd-yyyy; 
```

干净简洁。

# compiler-construction - 通用语言构建编译器

> ID：461099
> 
> 赞同：12
> 
> 时间：2009-01-20T12:29:03.880
> 
> 标签：compiler-construction

受到 Eric Sink 在 stackoverflow 播客上的采访的启发，我想在业余时间构建一个完整的编译器来获得学习体验。我最初的想法是构建一个 C 编译器，但我不确定它是否会花费太多时间。

我想知道是否有一种更小的通用语言更适合作为第一个编译器工作来实现？或者 C 实现在合理的时间范围内（200 小时）是否可行？

我打算以 CLR 为目标。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-20T12:45:52.537

你会很高兴为旧的、更小的语言编写编译器。 例如，[Pascal被设计为学习工具。](http://www.lrz-muenchen.de/~bernhard/Pascal-EBNF.html)Pascal 语言小巧优雅；编译器可以相当简单地编写。

即使是[Oberon](http://en.wikipedia.org/wiki/Oberon_(programming_language))或[Modula-2](http://en.wikipedia.org/wiki/Modula-2)编译器的复杂度也与 Pascal 相似；他们的设计是由同一个人 Niklaus Wirth 推动的。

像 C 这样有机进化的语言充满了怪癖，无法成为良好的学习体验。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-20T12:34:12.733

编写一个 Scheme 编译器。

请参阅：[编译器构造的增量方法](http://scheme2006.cs.uchicago.edu/#anincrementalapproachtocompilerconstruction)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-20T12:37:17.530

我的建议是选择你最喜欢的语言。通常，您所掌握的知识将超过为它编写编译器的难度。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-20T12:50:03.213

如果您想要一个*紧凑*的教程，为什么不考虑 Wirth 的[编译器构造](http://www.cs.inf.ethz.ch/~wirth/books/CompilerConstruction/)(pdf)。源语言 (Oberon-0) 足够简单以使编译器易于理解。任何进行过一些编程的人都应该可以阅读实现语言（Oberon）。

至于使用哪种语言来*实现*编译器。使用你熟悉的东西。如有疑问，请选择一种不会使尝试不必要地复杂化的语言：带有垃圾收集的东西。可以轻松打印或以其他方式转储内部数据结构以供检查的东西。[Python](http://www.python.org/)、[Scheme](http://www.plt-scheme.org/)和[Lua](http://www.lua.org/)都会浮现在脑海中。

最后的考虑是编译器的*目标是什么。*虚拟机 JVM 和 CLR 已经被提及，我敢肯定。你可以走那条路。第一次尝试使用精简 RISC 处理器的模拟器作为目标可能更容易。（Wirth 的编译器书就是这样做的。）

我不建议将 x86 用于您的第一个编译器，因为它难以言喻。我也不会针对像 C 这样的高级语言，因为你会错过很多有趣的细节，比如如何为布尔运算符实现短路语义等。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-21T01:25:29.430

支持 Scheme 的另一点是：对于初学者来说，为它编写一个*自托管*编译器是很实用的，比如 Kragen Sitaker 的[Ur-Scheme](http://www.canonical.org/~kragen/sw/urscheme/)，他的第一个编译器。几乎没有其他足够强大的“教程”编译器可以自行编译（尽管链接上有一些指针）。这给问题带来了更多的现实主义和兴趣。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T13:51:11.187

无论您选择哪种语言，请记住您可以定义自己的一组支持的功能来自定义它以适应您的学习目标。如果您想了解编译器（听起来像您这样做），那么您可以编写一个 C 编译器，但只是放弃对某些随机功能的支持，例如指针，或者只实现关键字的子集，只是为了使它更易于管理。

当然，如果您的目标是真正熟悉一种特定语言，您将希望完全实现该语言的编译器。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-20T13:55:16.813

已经提到了 Pascal，但我想补充一下 Niklaus Wirth 的书[*Algorithms + Data Structures = Programs*](https://rads.stackoverflow.com/amzn/click/com/0130224189)包含使用递归下降的类似 Pascal 的小型语言的完整实现。如果您正在寻找有关解析的理论密集型讨论，请查看其他地方；但是如果你想要简单的代码让你边做边学，那么我推荐 A + DP = P。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T12:42:30.470

无论您选择哪种语言，都可以考虑编译为中间语言 (IL) 以针对公共语言运行时 (CLR)。我认为针对非 Windows 的 Java 虚拟机 (JVM) 是类似的，或者在 Mono 中预先实现 CLR？这可能会大大简化工作，并让你有一些从一开始就表现良好的东西。如果您想走得更远，您稍后会重新定位特定架构。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-20T12:48:23.843

我想不出任何一种语言足够简单，可以用作第一次编译器编写练习。我不认为我会尝试 C 进行第一次剪辑。为什么不发明自己的语言？也许这将是一个真正的打击。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-05-03T00:34:55.530

在编译器课程中，我们为 C 的一个子集编写了编译器（我喜欢将其视为 C--）。这并不难，因为你知道你的界限在哪里。您可以随时重构并在以后添加更多功能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-20T12:47:57.993

就简单性而言，[FORTH](http://en.wikipedia.org/wiki/Forth_(programming_language))将成为更容易开发的语言之一。它是线程解释的，而不是真正编译的，但您仍将处理解析、变量存储等。

对于编译器，我会使用 C 或 Pascal，它们都非常紧凑并且有可用的编译器源代码。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-20T12:51:32.557

编写一个brainfuck 或forth 编译器。BASIC 可能也是这样的语言，功能不太丰富。我认为C会中等难度。不要羡慕目标拱门。使用你拥有的任何东西。

如果您不想实现汇编程序，则将编译器输出汇编代码并将其推送到 gas 或 nasm。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-05-03T00:29:47.123

我建议编写一个brainf**k 编译器。对于第一个编译器来说，这是一个非常简单和好的。时间尺度更像是 1 个半小时。其他一些好的语言是 Forth、Logo 和 Lisp。

# java - Java：如何检查泛型类类型定义？

> ID：461106
> 
> 赞同：5
> 
> 时间：2009-01-20T12:32:04.373
> 
> 标签：java, generics, types

这个想法是定义一个可以调用派生类中定义的方法的基类，但是在创建时我想确保这些方法是完全根据要求定义的，即这些方法只接受一个参数，一个 HashMap `<String String`> .

到目前为止，我能够使用以下代码检查该方法是否仅包含一个参数并且它属于 HashMap 类，但是如何检查泛型定义是否为`<String, String`> ？

```
public boolean isMethodParameterValid(final Method method) {
  final Class<?>[] parameters = method.getParameterTypes();
  return ((parameters.length == 1) && parameters[0].isAssignableFrom(HashMap.class));
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-03T22:03:54.913

实际上，存在类型擦除，但它不适用于变量/字段 - 仅适用于类型参数被擦除并替换为其上限的类的定义。

这意味着您所要求的可以实现。以下是检查方法第一个参数的通用参数的方法：

```
class Z
{
  public void f(List<String> lst) { }
}

...

Method m = Z.class.getMethod("f", List.class);
Type t = m.getGenericParameterTypes()[0];
if(t instanceof ParameterizedType) {
  ParameterizedType pt = (ParameterizedType) t;
  System.out.println("Generic params of first argument: " + Arrays.toString(pt.getActualTypeArguments()));
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-20T12:35:12.043

你不能。Java 泛型类型被编译器“擦除”，即`HashMap<String, String>`仅`HashMap`在运行时变为。看到[这个](https://stackoverflow.com/questions/313584/what-is-the-concept-of-erasure-in-generics-in-java)问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T12:59:52.663

我真的不明白你想要做什么的目标。我有一种感觉，应该可以在编译时通过仔细设计你的类层次结构来检查它。但是，如果没有有关您要解决的问题的更多详细信息，我将无法为您提供帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T20:58:37.400

如前所述，在运行时您无法查看类型的泛型部分。

您是否有理由像在模板模式中那样定义一个抽象方法？

然后将静态地进行检查。

```
protected abstract void process(HashMap<String, String>); 
```

（也有理由要求 HashMap 而不是 Map？）

# java - Java Swing 中带有换行和换行的面板

> ID：461112
> 
> 赞同：1
> 
> 时间：2009-01-20T12:34:07.100
> 
> 标签：java, swing, user-interface, jpanel, jtextpane

如何实现支持换行和换行的面板？我只会在此面板中添加文本标签和换行符。标签应该从左到右流动，如果需要，可以换行到下一个“行”。换行符会导致跳转到下一行。我还想让面板垂直滚动。

该解决方案应该在 Java 5 中运行。可以使用 SwingX。

澄清：文本标签实际上是`JXHyperlink`s（来自 SwingX），即面板包含可点击的标签。这就是我不能只使用 `JTextArea`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T12:38:07.467

更新：我错过了超链接支持的请求。不知道如何使用 EditorPane 来做到这一点。

JTextArea 完全符合您的描述。

```
JTextArea textArea = new JTextArea();
JScrollPanel sPane = new JScrollPane(textArea); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T19:52:43.923

[替代文字 http://img187.imageshack.us/img187/3238/wraprn0.png](http://img187.imageshack.us/img187/3238/wraprn0.png)

此示例不是来自面板（即容器），而是来自 JLabel，旨在显示内容。

您可以在内容中使用 HTML，并在每次中断时使用 <br>。**您**应该根据组件调整大小的规则以编程方式计算中断。

这是代码：

```
import javax.swing.*;
import java.awt.*;

public class Wrap {

    public static void main( String [] args ) { 

        JFrame frame = new JFrame("Wrap test");

        String text =  "<html>This<br>is<br>a<br>multiline<br>label</html>";

        frame.add( new JLabel( text ) );

        frame.pack();

        frame.setVisible( true );

    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T22:24:22.243

我发现`JTextPane`了，我以前由于某种原因忽略了它。这门课做我需要的。

不过感谢您的帮助。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T14:01:58.733

虽然它可能不是您正在寻找的解决方案，但从您的要求来看，似乎定制`LayoutManager`可能能够实现您所追求的。通过设计和分配一个允许换行的自定义布局管理器[`Container`](http://java.sun.com/javase/6/docs/api/java/awt/Container.html)（例如[`Panel`](http://java.sun.com/javase/6/docs/api/java/awt/Panel.html)），应该可以有一个`Panel`允许换行的。

[Java 教程](http://java.sun.com/docs/books/tutorial/index.html)中的[在容器中布局组件一](http://java.sun.com/docs/books/tutorial/uiswing/layout/index.html)文将提供有关布局管理器如何在 Java 中工作的一般信息，特别是，[创建自定义布局管理器](http://java.sun.com/docs/books/tutorial/uiswing/layout/custom.html)将提供有关如何使自定义布局管理器应用于.`Container`

[`FlowLayout`](http://java.sun.com/javase/6/docs/api/java/awt/FlowLayout.html)（的默认布局管理器）的行为`Panel`似乎与您可能追求的行为非常接近。为换行添加功能似乎是缺失的部分。

**建议：**或许自定义的LayoutManager可以通过a`Component`表示换行符来添加换行符，`Container`使用`add()`方法可以添加到a中。

例如，`Component`在自定义布局管理器中有一个类常量，例如 (a hypothetical) `LineBreakLayout.LINE_BREAK`，并将其添加到`Container`可以告诉自定义布局管理器移动到下一行。也许实现可以像：

```
Panel p = new Panel(new LineBreakLayout());
p.add(new Label("First Line"));
p.add(LineBreakLayout.LINE_BREAK);
p.add(new Label("Second Line")); 
```

然后，上述*假设* 将在一行中`LineBreakLayout`呈现第一个，在第二行中呈现第二个。`Label``Label`

# database - 将数据上传到远程数据库

> ID：461120
> 
> 赞同：1
> 
> 时间：2009-01-20T12:36:39.997
> 
> 标签：database, security

什么是最安全和最简单的发送大约的方式。1000 条不同的记录存入无法直接访问的数据库 - Web 提供商服务器上的 MySQL 数据库 - 使用 Windows 应用程序。数据将存储到不同的表中。

编辑：该应用程序将分发给不知道什么是数据库或腻子的用户，或者......他们只需安装我的应用程序，打开它，输入一些数据并按提交。

目前我正在使用 php 将生成的脚本上传到网络服务器并在那里处理它。我认为我还应该在文件中包含一些签名，以避免一些“丢弃......”黑客攻击。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T12:41:16.400

如果您可以将数据导出为 sql 脚本，您可以使用您选择的应用程序在远程服务器上运行它。1000 条记录不会创建那么大的脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T13:46:51.400

在我工作的当前项目中，我们有同样的情况 - 远程（遥远的）数据库。

我提出了下一个解决方案：将 sql 查询序列化为 xml 并通过 HTTP 将其放入 web 守护程序，该守护程序运行在远程服务器上，而不是打开的 sql 服务器上。守护进程检查凭据并执行查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T07:11:04.490

由于我无法在外部服务器上执行任何外部程序，我创建了以下解决方案：

*   我的程序创建脚本文件并计算它的盐渍哈希
*   程序将此文件与用户凭据和哈希一起发送到服务器上的 PHP 页面
*   PHP页面检查用户名和密码，然后检查哈希，然后执行脚本。只允许插入和更新命令。

这种方法是否足够安全？

# java - 使用 Java IO 函数读取文件时出现神秘的 EOF 异常

> ID：461130
> 
> 赞同：2
> 
> 时间：2009-01-20T12:41:12.047
> 
> 标签：java

当我尝试查找某个文件时出现以下异常。

> > 在 myFile 中寻找 38128 时出错，文件长度：85742 java.io.RandomAccessFile.readInt(RandomAccessFile.java:725) at java.io.RandomAccessFile.readLong(RandomAccessFile.java:758) 处的 java.io.EOFException >

但是如果你看到我试图寻找'38128'，因为文件长度是'85742'。它报告了EOF异常。我想知道怎么可能？另一个进程定期将内容附加到该文件并关闭文件处理程序。它使用 DataOutputStream 附加内容。我的过程是试图寻找一些位置并阅读它。还有一件事是我只遇到过一次这个异常。我试图重现它，但它再也没有发生过。该文件仅在本地磁盘中。没有文件管理器。

谢谢 DL 库马尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T13:05:43.307

在尝试对同时从另一个进程写入的文件进行随机访问时，我会非常小心。正如您现在所遇到的那样，它可能会导致各种奇怪的同步问题。

您是否从与执行 seek() 的进程相同的进程中确定文件的长度？其他修改处理是否完成了flush()？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T13:09:20.460

写入数据的进程可能已被告知写入数据，但数据可以被缓冲写入。在尝试读取数据之前，请务必在输出流上调用 flush()。

# .net - 需要澄清：.NET 运行时如何解析父文件夹中的程序集引用？

> ID：461136
> 
> 赞同：1
> 
> 时间：2009-01-20T12:43:28.203
> 
> 标签：.net, assemblies, reference, resolution

我的解决方案中有以下可执行文件的输出结构：

```
%程序文件%
    |
    +-[我的应用程序名称]
          |
          +-[客户]
          | |
          | +-(EXE & 几个 DLL 程序集)
          |
          +-[常用]
          | |
          | +-[架构程序集]
          | | |
          | | +-（几个 DLL 程序集）
          | |
          | +-（几个 DLL 程序集）
          |
          +-[服务器]
                |
                +-(EXE & 几个 DLL 程序集)

```

解决方案中的每个项目都引用了不同的 DLL 程序集，其中一些是解决方案中其他项目的输出，而另一些则是普通的第 3 方程序集。例如，[Client] EXE 可能会引用 [Common] 中的程序集，该程序集位于不同的目录分支中。

所有引用都将“复制本地”设置为 false，以反映最终安装的应用程序中文件的布局。

现在，如果我查看 Visual Studio IDE 中的引用属性，我会发现每个引用的“路径”都是绝对的，并且它对应于程序集的实际输出位置。这是可以理解和正确的。正如预期的那样，解决方案编译并运行得很好。

我不明白的是，为什么即使我关闭 IDE，重命名 [MyAppName] 目录并手动运行 [Client] EXE，一切似乎都正常？如果引用路径与链接时的路径不同，运行时如何找到程序集？

需要明确的是 - 这实际上正是我所追求的：一组半分散的应用程序文件，无论 [MyAppName] 目录位于何处，甚至它的名称如何，都能正常运行。我只想知道，在我没有任何特定路径解决方案的情况下，它是如何以及为什么起作用的。

我已经阅读了[这个类似问题](https://stackoverflow.com/questions/385129/referencing-private-net-assemblies-in-a-subfolder)的答案，但我仍然不明白。

非常感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T10:13:13.950

AFAIK 唯一的解决方案是在 MyAppBase 中至少有“存根”exe，然后在每个应用程序的 app.config 中将子目录定义为 DLL 的源。

NTFS 确实支持将其他目录（即硬链接）“挂载”为子目录，但它们是非常不自动的，因为除了理论化之外我没有尝试过这种方式，我不知道这是否可以作为一个黑客。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T12:51:33.743

以下是 .Net 查找所需程序集的方式：http: [//msdn.microsoft.com/en-us/library/yx7xezcf (VS.71).aspx](http://msdn.microsoft.com/en-us/library/yx7xezcf(VS.71).aspx)

第 4 步可能会让您感兴趣：http: [//msdn.microsoft.com/en-us/library/15hyw9x3 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/15hyw9x3(VS.71).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T12:53:44.097

您是否考虑过使用[GACutil](http://msdn.microsoft.com/en-us/library/ex0ss12c(VS.71).aspx)将共享程序集添加到[全局程序集缓存](http://msdn.microsoft.com/en-us/library/yf1d93sz(VS.71).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-05T02:00:11.067

也许Common文件夹在编译时被指定为binpath参数？

（请参阅探测私有 binpath）

[http://msdn.microsoft.com/en-us/library/15hyw9x3%28VS.71%29.aspx](http://msdn.microsoft.com/en-us/library/15hyw9x3%28VS.71%29.aspx)

-马特

# security - 我在哪里可以详细了解安全问题？

> ID：461137
> 
> 赞同：0
> 
> 时间：2009-01-20T12:43:34.397
> 
> 标签：security

我一直认为，编写任何类型的恶意软件所需的时间和资源最好花在其他事情上。然而，作为一名开发人员，我一直担心我工作的系统中可能存在的安全漏洞。

当然，我知道验证输入，我完全理解代码和 sql 注入是如何工作的，并着迷地清理这些风险。此外，只要我有能力，我就会利用手头的任何资源（例如文章、白皮书、演示文稿等）来应对新的安全风险，但我经常觉得我错过了重点，也许是因为我的大部分知识很可能是被归类为“新奇”（C#、MSSQL、PHP、一些 Python、少量 Ruby）：我所知道的最古老的语言是 Classic ASP。

有时，当我阅读诸如跨站点脚本和 URL 劫持之类的内容时，我会阅读它们所依据的文章，但我觉得我并没有 100% 关注。

您知道哪些最好的资源可以帮助您解决安全问题并真正了解它们的工作原理？可以是任何东西，书籍，网站，其他类型的资源。我知道我对这些问题了解得不够多，所以我可以去哪里了解更多信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T12:47:16.293

[http://www.owasp.org/](http://www.owasp.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T12:49:13.107

好吧，您可以从 Jeff 最近的一篇文章开始： [前 25 个最危险的编程错误](https://blog.codinghorror.com/top-25-most-dangerous-programming-mistakes/)，然后从那里继续前进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T12:53:01.913

试试 James Whittaker 的[如何破解软件安全](https://rads.stackoverflow.com/amzn/click/com/0321194330)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T15:45:24.937

一只猴子，

您提出问题的事实意味着您正在顺利进行。真正的问题是，很多人不问，不像你那样担心。

我要修改的一件事是改变您完全了解某些安全问题的想法。那里有一些非常狡猾的小混蛋。我认为你最好假设他们比你聪明，所以尽可能地把事情固定下来。我发现这是一种更好的心态。

您应该查看的两个资源： [XSS 备忘单](http://ha.ckers.org/xss.html)

[SQL注入的一个很好的例子](http://www.unixwiz.net/techtips/sql-injection.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T11:56:22.637

我必须承认对这个问题的冷淡反应感到有些惊讶。这是否意味着：

a) 其他人都知道 OWASP，而我却远远落后于潮流？
b) 其他人都对其代码的安全性有足够的信心，不需要一点帮助来保持最新状态？
c) 没有人关心？
d) 其他？

我发现对 OWASP 的参考最有帮助，到目前为止，我将安装他们的一些项目软件以查看它是如何工作的，一旦我觉得查看他们的网站我在安全方面会更好将该答案标记为已接受，除非同时出现更好的答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T11:58:31.570

[http://www.securityfocus.com/](http://www.securityfocus.com/)和[分类邮件列表](http://www.securityfocus.com/archive)。

# javascript - eval() 的线程行为是否因浏览器而异？

> ID：461138
> 
> 赞同：0
> 
> 时间：2009-01-20T12:43:36.333
> 
> 标签：javascript, eval, timing

我目前正在使用包含某些交互时间的消息记录 AJAX 应用程序。所以我有几个地方的代码遵循这样的模式：

```
var startTime = new Date();
this.doFunction();
var endTime = new Date();
logger.log("doFunction took " + (endTime - startTime) + " milliseconds."); 
```

我要做的是将时间分离到一个库函数中，该函数将函数作为参数，看起来像：

```
time : function(toTime) {
    var startTime = new Date();
    eval(toTime);
    var endTime = new Date();
    logger.log(toTime + " took " + (endTime - startTime) + " milliseconds.");
} 
```

（语法可能不对，我对 JavaScript 不太熟悉）

这样一来，我就不会做时间安排了：

```
time(this.doFunction); 
```

我的问题是，不同的浏览器是否有不同的行为`eval()`？例如将 eval 触发到一个新线程中，从而使我的时间不正确？

任何其他有关时间的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T12:48:00.987

不，所有浏览器在 javascript 引擎中都是单线程的。我怀疑你也可以简单地通过调用 toTime() 作为函数而不是使用 eval() 来解决这个问题。您可能需要查看 javascript[参数](http://www.seifi.org/javascript/javascript-arguments.html)对象和 javascript“[调用](http://docstore.mik.ua/orelly/webprog/jscript/ch07_05.htm)”和“应用”方法，以透明地将传递给外部“时间”函数的参数转发到内部“toTime”函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T12:49:47.957

eval 应该是同步的。

你不应该使用`eval()`but `toTime.call()`，因为你应该避免使用 eval。

# c# - 有没有办法检索 C# 应用程序的当前内存使用情况？

> ID：461139
> 
> 赞同：26
> 
> 时间：2009-01-20T12:44:20.263
> 
> 标签：c#, .net, garbage-collection, clr, memory-management

我正在自动化一些分析任务，并希望实时记录堆空间和生成大小。对于我需要的东西，[分析 API似乎非常复杂，而且它似乎在监听各个分配和集合，这对我来说并不重要。](http://msdn.microsoft.com/en-us/library/bb384547.aspx)分析工具当然有很大的帮助，但我一直在寻找更灵活、可编程的接口。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-20T12:47:49.147

术语“当前内存使用情况”的定义有点松散。你是说工作集吗？无论是什么意思，您都可以使用流程类中的不同属性（例如`VirtualMemorySize`、`WorkingSet`、`PrivateMemorySize`等）来检索它。

```
long workingSet = System.Diagnostics.Process.GetCurrentProcess().WorkingSet64; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-20T12:46:54.530

很多这些东西都有性能计数器，如果你不能使用 Perfmon，你可以通过 Diagnostics API 访问计数器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-04T14:24:06.613

一旦我不得不在遗留代码中找到内存泄漏，我就遇到了这个解决方案：使用适当的参数作为进程启动“任务列表”，然后从流或文件中读取输出。

例如

```
tasklist /fi "IMAGENAME eq notepad++.exe" /FO CSV /NH 
```

输出是：

```
"notepad++.exe","7132","Console","1","21.004 K" 
```

不是那么优雅，但是可以在 Windows 上的任何编程语言中使用，而无需额外的依赖（在我的例子中是 C++/Qt）。

# extjs - 渲染时如何在面板中居中遮罩

> ID：461140
> 
> 赞同：2
> 
> 时间：2009-01-20T12:44:49.340
> 
> 标签：extjs

我有一个简单的场景，其中面板在加载内容时需要一个蒙面的加载指示器。我使用以下代码使掩码工作正常，但第一次调用时加载指示器出现在顶部。在显示面板后调用它时，即。在按钮事件上，掩码正确显示在面板的中心。有任何想法吗？

```
var pnl = new Ext.Panel({
    title: 'test',
    width: 500,
    height: 500,
    renderTo: 'controls',
    listeners: {
        render: function(comp) {
            comp.load();
        }
    },
    load: function() {
       this.el.mask('loading...', 'loadingMask');
    }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T13:19:52.030

似乎在完全呈现 html 之前，掩码已应用于面板。一个简单的解决方案是在应用前不久延迟遮罩。

```
render: function(comp) {
    setTimeout(function() { comp.loadPermissions(); }, 100);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T15:30:26.073

只需从“渲染”侦听器中调用 this.el.mask() 即可。在 this.load 方法中调用掩码之前还要检查 this.rendered 属性。

# nhibernate - PostgreSQL 全文搜索与 NHibernate.Search 通过 Lucene.Net

> ID：461145
> 
> 赞同：5
> 
> 时间：2009-01-20T12:45:08.047
> 
> 标签：nhibernate, postgresql, full-text-search, lucene

我正在考虑是否为我当前的项目选择 NHibernate.Search 或 PostgreSQL 的嵌入式全文搜索支持。

正如您已经猜到的，我们在 .NET 平台上使用带有 NHibernate ORM 的 PostgreSQL RDBMS。您对上述全文引擎有什么经验？有什么我应该注意的陷阱吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T01:17:06.240

我会推荐使用 Lucene，虽然我认为 Postgres 是一个很棒的产品。Lucene 的算法非常适合“开箱即用”的自然语言文本搜索。换句话说，当您只构建最简单的搜索时，它似乎只是“做正确的事”（也就是说，您的直觉会建议它应该做什么）。

Postgres 很好地完成了 RDb 管理。这就是它的设计目的。但是比较两者的以下实现：

```
Search for "google" or "yahoo" or "msn" followed by "search engine". 
```

现在重用相同的查询代码来执行以下搜索：

```
Search for "google" and "yahoo" and "msn" and "search engine". 
```

想象一下在 NHibernate.Search 与 Postgresql 中实现查询需要什么。用 NHibernate 构建灵活的文本查询功能应该不会花费很长时间。它只是更自然地适合它。

# sql-server - 存储过程序列化问题

> ID：461146
> 
> 赞同：1
> 
> 时间：2009-01-20T12:45:41.897
> 
> 标签：sql-server, visual-studio, sql-server-2005, stored-procedures

以下存储过程代码对于多用户应用程序是否健壮。它工作正常。我想知道是否有更好的方法可以做到这一点，以及是否有任何性能问题。

proc 共有三个 sql 语句，如 1.更新分配表中的硬件状态 2.计算要插入到 DEFECT_LOG 表中的新记录的下一个适当的主键值 3.将值插入到 DEFECT_LOG 表中。如果交易成功，我还使用变量返回 1。

```
ALTER PROCEDURE spCreateDefective

(

    @alloc_ID nvarchar(50),
    @cur_date datetime,
    @problem_desc nvarchar(MAX),
    @got_defect_date datetime,
    @trans_status tinyint OUTPUT --Used to check transaction status
)

AS

/*  Transaction Maintainer Statements   */

BEGIN TRAN transac1

    SET XACT_ABORT ON

    SET TRANSACTION ISOLATION LEVEL SERIALIZABLE

/*  Declaration Area    */

    DECLARE @temp nvarchar(10)

    DECLARE @def_ID nvarchar(20)

/*  Updating Inventory Status to 'Defective' and Updating Release Date to current System date   */  

    UPDATE INV_Allocation_DB

    SET INV_STATUS = 'Defective' , RELEASE_DATE=@cur_date
    WHERE INV_ID=@alloc_ID

/*  Calculates New Primary Key for the DEFECT_LOG Table */

--  Returns the largest number or 1 if no records are present in the table  

    SELECT @temp=COALESCE(CONVERT(int,SUBSTRING(MAX(DEFECT_ID),5,5))+1,1) FROM DEFECT_LOG

    SET @def_ID = 'DEF_'+ RIGHT(replicate('0',5)+ convert(varchar(5),@temp),5)

/*  Insert statement for inserting data into DEFECT_LOG */

    INSERT INTO DEFECT_LOG (DEFECT_ID,INV_ID,PROB_DESC,GOT_DEFECT_DATE) 
    VALUES(@def_ID,@alloc_ID,@problem_desc,@got_defect_date)

    SET @trans_status = 1

    COMMIT TRAN transac1

/*  Returns 1 if transaction successful */

RETURN @trans_status 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T12:53:25.203

不建议使用 SERIALIZABLE 事务级别，除非您绝对必须拥有一个。它将增加阻塞的可能性并降低吞吐量。

您似乎在使用它来保证唯一的 DEFECT_ID？为什么不对 DEFECT_ID 使用 IDENTITY 列呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:25:54.473

就我个人而言，我会使用 IDENTITY 字段作为真正的主键，但随后会有一个带有字母数字标识符的附加列。（可能作为持久计算字段）

这应该会减少与并发相关的问题数量。

# .net - 需要技术推荐/建议

> ID：461160
> 
> 赞同：2
> 
> 时间：2009-01-20T12:48:45.370
> 
> 标签：.net, asp.net, sharepoint, architecture, wss

我们（我的公司）正在尝试开发文档管理的解决方案（应用程序）。我们曾考虑使用 MS Sharepoint Server 2007 或 Sharepoint Services，但我们需要对此提出建议或建议。

我们计划将 Windows 工作流基金用于各种任务，例如（任务分配、文档审批、信息收集......）。但是我们需要关于选择哪种产品和/或技术的建议。

示例：用户登录门户网站以申请房屋建筑许可。他在表格中输入所需信息并提交请求。然后根据请求当前所在的体育场，将请求分配给不同的人员或部门。用户可以随时登录到门户网站并查看其请求的状态，并在需要时输入一些不同的信息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T13:12:04.450

好吧，我应该说我对 Sharepoint 的一次体验并不好，而且我每天都对它的局限性感到恼火，这不断增加我对它的挫败感。我确信它可以变得更有用，但目前还没有。

您正在寻找的是与文档管理相关的业务流程管理（工作流）解决方案。我在这十年的大部分时间里都在做这项工作，所以我知道有几家公司提供这些产品。（其中一些可能是矫枉过正，但话说回来，sharepoint 也是如此）

*   [FileNet](http://en.wikipedia.org/wiki/FileNet) - 提供 BPM 和 DM。价格昂贵，但有 30 年的工作经验，他们的产品坚如磐石。（培训也在南加州。很好！）
*   [Epitome](http://epitomesystems.com/) - 同时提供 BPM 和 DM（称为 EPM - 我讨厌营销）。许可可以按席位或按交易运行。（所有 .NET api 并且可以根据需要设计或托管解决方案）
*   [OpenCMS](http://www.opencms.org/en/) - 只是 DM，免费，但您需要连接 BPM (WWFF)。
*   [OTG](http://www.otg.com/) - 提供 BPM 和 DM。目前没有定价的想法，但很容易理解产品结构并且很容易排除故障。

不要打扰

*   [OnBase](http://www.opencms.org/en/) - 支持很困难，它们都是 COM 组件，.NET 集成很困难，而且他们不太愿意帮助集成商。
*   [Fortis / FileMagic](http://www.westbrooktech.com/) - 上次我和他们一起工作时还不够成熟。

如果您要自己动手，请确保您至少拥有这几样东西。

*   文档版本控制/变更审计。每个更改都应记录为一个新的单独文件。（即使您可能正在使用电子表格，但每次更改数据时，都应保留旧版本）
*   锁定/结帐文件。源代码控制的工作方式大致相同。
*   把事情简单化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T16:05:11.697

我相信 Windows Sharepoint Services (WSS) 3.0 可以提供您所需要的一切。

您可以按照您的计划使用 Windows Workflow Foundation，文档库提供文档管理，包括版本控制、文档签出和搜索。

除非您计划将门户与旧系统集成或需要其他复杂功能（如文档中的权限管理），否则我认为您不需要 Microsoft Office Sharepoint Server (MOSS) 2007。

使用 SharePoint 时，您应该使用 Microsoft Office（如果可能，请使用 2007 版）；请参阅[白皮书：好、更好、最好：Office 和 SharePoint 产品和技术](http://technet.microsoft.com/en-us/library/cc263391.aspx)

此处有更多详细信息：[什么是 Microsoft Sharepoint？](https://stackoverflow.com/questions/89101/what-is-microsoft-sharepoint)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T21:01:04.970

k2 BlackPearl 已用于通过 SharePoint 提供复杂的 Workflow 解决方案，BlackPearl 使用 Windows Workflow Foundation，如果您想要 SharePoint 中的 Microsoft Office 集成和协作功能，这两个产品值得探索。

SharePoint 是一个庞大而复杂的平台，对于小型解决方案来说可能是多余的，但如果您计划整合您的整个组织，它可能会提供一个具有成本效益的解决方案。

SharePoint 最大的问题是知识。很难找到具有必要经验的人来指导您解决一些在 SharePoint 部署中很容易造成并且难以从其中恢复的陷阱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T08:02:11.453

在与客户的沟通中，我得到了客户要求平台必须是SharePoint Services 3.0 的需求清单。所以现在我所有的决定都将基于开发基于此的解决方案。因此，我感谢大家在这里提出的许多好的建议，尤其是 StingyJack，他建议了我将在未来项目中考虑的其他一些产品。

现在我必须专注于我的项目的建筑设计。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T05:47:20.990

我还建议 k2 blackPearl .. 它具有出色的工作流程功能并与 sharepoint 集成

但是 K2 blackPoint（另一个 k2 软件）也很好地与 SharePoint 集成，实际上您只能将它与 sharepoint 一起使用。如果您想削减成本，k2 blackPoint 可能是一种选择，而不是 k2 blackPearl。并且因为 BlackPoint 可以与 infopath 集成，所以您可以制作更好的 gui，而不是在制作新项目时填写 Sharepoint 列表。并不是说我反对填写清单，外观对我很重要（我猜是个人喜好）

反正，

使用任何 k2 应用程序都可以缩短开发时间，因为它相对容易开发（拖放有点东西）。K2 说是没有编码，但你可以添加代码。

# php - PHP中的任意图像大小调整

> ID：461167
> 
> 赞同：3
> 
> 时间：2009-01-20T12:50:38.113
> 
> 标签：php

将图像（可以是任何尺寸）调整为固定大小或至少适合固定大小的最佳方法是什么？

图像来自不受我控制的随机 url，我必须确保图像不会超出大约 250 像素 x 300 像素或图层的 20% x 50% 的区域。

我认为我会首先确定大小，如果它超出范围，则按一个因子调整大小，但如果图像大小可以是任何东西，我不确定如何制定调整大小的逻辑。

编辑：我没有对图像的本地访问权限，并且图像 url 在一个变量中，使用 img src=... 输出，我需要一种方法来指定宽度和高度标签的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T13:00:25.033

使用 ImageMagick 很容易做到。您可以通过 exec 使用 convert 命令行工具，也可以使用[http://www.francodacosta.com/phmagick/resizing-images](http://www.francodacosta.com/phmagick/resizing-images)。
如果您使用“转换”，您甚至可以告诉 ImageMagick 只调整较大图像的大小而不转换较小的图像：[http ://www.imagemagick.org/Usage/resize/](http://www.imagemagick.org/Usage/resize/)

如果您没有本地访问权限，您将无法使用 ImageMagick：

```
<?php
$maxWidth  = 250;
$maxHeight = 500;

$size = getimagesize($url);
if ($size) {
    $imageWidth  = $size[0];
    $imageHeight = $size[1];
    $wRatio = $imageWidth / $maxWidth;
    $hRatio = $imageHeight / $maxHeight;
    $maxRatio = max($wRatio, $hRatio);
    if ($maxRatio > 1) {
        $outputWidth = $imageWidth / $maxRatio;
        $outputHeight = $imageHeight / $maxRatio;
    } else {
        $outputWidth = $imageWidth;
        $outputHeight = $imageHeight;
    }
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T13:00:36.440

您是否查看过 GD 库文档，尤其是[imagecopyresized](http://uk.php.net/manual/en/function.imagecopyresized.php)方法？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T13:04:49.190

如果您必须保持图像的纵横比不变，那么您应该将其缩放一个因子，以便图像的较长边（高度或宽度）适合该边的限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T13:00:23.817

您可以使用以下内容：

```
$maxWidth  = 250;
$maxHeight = 500;

$validSize = true;
$imageinfo = getimagesize($filename);
if ($imageinfo) {
    $validSize &= $imageinfo[0] <= $maxWidth;
    $validSize &= $imageinfo[1] <= $maxHeight;
} 
```

`&=`是[按位与运算符`&`](http://docs.php.net/manual/en/language.operators.bitwise.php)和[赋值运算符`=`](http://docs.php.net/manual/en/language.operators.assignment.php)的组合运算符。因此`$foo &= *expr*`和`$foo = $foo & *expr*`是等价的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T13:01:50.243

我不确定您的答案的确切解决方案，但我知道一个用 PHP 编写的项目有解决方案。去看看为 Drupal CMS 构建的 ImageCache，它是用 PHP 编写的。

它基本上让你定义一些对任意图像采取的操作，并产生几乎任何你想要的图像缩放/裁剪。

你必须学习一些 Drupal API 才能理解这个例子，但是它很广泛，如果你理解他们的算法，你就能解决其他更复杂的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T15:11:21.993

我创建了以下函数来根据比例智能调整图像大小，甚至还有一个参数可以放大较小的图像（如果缩略图尺寸怪异时 HTML 布局搞砸，这很关键）。

```
function ImageIntelligentResize( $imagePath, $maxWidth, $maxHeight, $alwaysUpscale )
{
    // garbage in, garbage out
    if ( IsNullOrEmpty($imagePath) || !is_file($imagePath) || IsNullOrEmpty($maxWidth) || IsNullOrEmpty($maxHeight) )
    {
        return array("width"=>"", "height"=>"");
    }

    // if our thumbnail size is too big, adjust it via HTML
    $size = getimagesize($imagePath);
    $origWidth = $size[0];
    $origHeight = $size[1];

    // Check if the image we're grabbing is larger than the max width or height or if we always want it resized
    if ( $alwaysUpscale || $origWidth > $maxWidth || $origHeight > $maxHeight )
    {   
        // it is so let's resize the image intelligently
        // check if our image is landscape or portrait
        if ( $origWidth > $origHeight )
        {
            // target image is landscape/wide (ex: 4x3)
            $newWidth = $maxWidth;
            $ratio = $maxWidth / $origWidth;
            $newHeight = floor($origHeight * $ratio);
            // make sure the image wasn't heigher than expected
            if ($newHeight > $maxHeight)
            {
                // it is so limit by the height
                $newHeight = $maxHeight;
                $ratio = $maxHeight / $origHeight;
                $newWidth = floor($origWidth * $ratio);
            }
        }
        else
        {
            // target image is portrait/tall (ex: 3x4)
            $newHeight = $maxHeight;
            $ratio = $maxHeight / $origHeight;
            $newWidth = floor($origWidth * $ratio);
            // make sure the image wasn't wider than expected
            if ($newWidth > $maxWidth)
            {
                // it is so limit by the width
                $newWidth = $maxWidth;
                $ratio = $maxWidth / $origWidth;
                $newHeight = floor($origHeight * $ratio);
            }
        }
    }
    // it's not, so just use the current height and width
    else
    {
        $newWidth = $origWidth;
        $newHeight = $origHeight;
    }   

    return array("width"=>$newWidth, "height"=>$newHeight);
} 
```

# iphone - iOS 开发的软硬件要求

> ID：461173
> 
> 赞同：4
> 
> 时间：2009-01-20T12:51:45.787
> 
> 标签：iphone, ios, sdk

开发 iPhone 应用程序有哪些选择？
目前我已经尝试为 Linux 安装 gnu 工具包但没有成功！步骤太多，并且我无法编译单个应用程序。
Apple SDK 似乎要容易得多，但我没有 Mac。
所以我错过了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T13:43:11.453

毫无疑问，您需要 Mac。您还需要在 iPhone 或 iPod Touch 上进行开发，因为虽然模拟器非常好，但它**并不**完美 - 我的示例代码在模拟器中运行良好，但在硬件上失败。还必须修改硬件以添加开发密钥，因此使用真正的 iPhone 存在一定的风险 - 许多人证明它足够安全，但我自己却畏缩并购买了 iPod Touch 进​​行开发。密钥还必须安装在您的 Mac 上并集成到 Xcode 中——即使使用标准的 Apple 设置，这也很棘手。Xcode 是免费的，而且确实是一个相当不错的 IDE。

因此，您的最低要求是

运行最新 Mac OS 的 Intel Mac。最便宜的选择是 Mac Mini - 599 美元，尽管您可能会在 Ebay 上以 400 美元或更低的价格购买一台。

一个 iPod Touch（或 iPhone，如果你的应用需要相机/电话功能） - 229 美元

来自苹果的开发者许可证，因此您可以获得必要的密钥 - 99 美元

需要强调的是，您绝对*必须*在真实硬件上测试代码，并且尝试使用除 Mac 和 Xcode 之外的任何其他东西时所经历的痛苦很容易吃掉购买 Mac 的成本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-20T12:57:21.453

是的，Mac。没有工具，这可能不值得付出努力。尤其是没有模拟器。Apple 设计了 ​​iPhone，它运行一个 OSX 版本，并且他们已经制作了这些工具。您甚至不需要编译器，因为您没有调试、加载和管理应用程序的工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T22:26:34.797

从您当地的图书馆查看 [http://oreilly.com/catalog/9780596155193/](http://oreilly.com/catalog/9780596155193/)，它说您不需要 Mac，只需要越狱的 iPhone/iPodTouch 和 Linux。我不知道你可以使用SDK来做，我正在等待2g越狱甚至开始，但我当然希望我不需要Mac。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T12:59:47.970

除了官方 MAC 之外，您在 google code 上还有一个项目，该项目试图为 Linux 和 Windows 创建一个工具链。[iphone-dev](http://code.google.com/p/iphone-dev/wiki/Building)此链接向您展示如何构建它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T13:15:05.397

还有另一个常见问题解答网站可以回答许多类似这样的基本 iPhone 开发问题，我发现这些问题很有用。所以你可能想看看[iPhoneDevelopmentFAQ.com](http://www.iphonedevelopmentfaq.com/)

# c# - 如何在我的应用程序中添加 toast 样式的弹出窗口？

> ID：461184
> 
> 赞同：11
> 
> 时间：2009-01-20T12:54:05.173
> 
> 标签：c#, winforms

我创建了一个在任务栏中运行的应用程序。当用户单击应用程序时，它会弹出等。当我的一个朋友登录时，我想要的功能类似于 MSN 中的功能。显然这被称为 toast 弹出窗口？我基本上希望从任务栏中的应用程序中每隔 20 分钟吐司样式弹出一些东西。

我现有的应用程序是基于 .net 3.5 用 C# 编写的 winforms

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-20T13:44:24.010

这很简单。您只需要在屏幕外区域设置窗口并为其位置设置动画，直到它完全可见。这是一个示例代码：

```
public partial class Form1 : Form
{
    private Timer timer;
    private int startPosX;
    private int startPosY;

    public Form1()
    {
        InitializeComponent();
        // We want our window to be the top most
        TopMost = true;
        // Pop doesn't need to be shown in task bar
        ShowInTaskbar = false;
        // Create and run timer for animation
        timer = new Timer();
        timer.Interval = 50;
        timer.Tick += timer_Tick;
    }

    protected override void OnLoad(EventArgs e)
    {
        // Move window out of screen
        startPosX = Screen.PrimaryScreen.WorkingArea.Width - Width;
        startPosY = Screen.PrimaryScreen.WorkingArea.Height;
        SetDesktopLocation(startPosX, startPosY);
        base.OnLoad(e);
        // Begin animation
        timer.Start();
    }

    void timer_Tick(object sender, EventArgs e)
    {
        //Lift window by 5 pixels
        startPosY -= 5; 
        //If window is fully visible stop the timer
        if (startPosY < Screen.PrimaryScreen.WorkingArea.Height - Height)
            timer.Stop();
        else
           SetDesktopLocation(startPosX, startPosY);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-20T13:56:50.583

Win32 中支持通知气球（我不是 .net 程序员），具有一些有用的属性，正如[旧的新事物所解释的](http://blogs.msdn.com/oldnewthing/archive/2005/01/10/349894.aspx)那样。

还有一个系统范围的信号量，您应该锁定它以防止任何应用程序同时出现多个弹出窗口。

在 msdn 上有几页关于 toast semaphor - [toast semaphor](http://msdn.microsoft.com/en-us/library/ms632289(VS.85).aspx)和[更广泛的可用性上下文](http://msdn.microsoft.com/en-us/library/aa468595.aspx)。我还遇到了一些[示例代码](http://blogs.msdn.com/coding4fun/archive/2006/10/31/912382.aspx)，可以在查找时使用 C# 中的气球 API，但不能保证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-10T16:54:42.620

对于可定制和更好看的通知..

检查这个链接..

*   [Windows Toast 通知 - GitHub](https://github.com/noxad/windows-toast-notifications)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-04-17T01:04:11.643

您将窗体向右移出屏幕，然后将其抬起。它永远不会真正提升到桌面视图中。X轴是左右，Y轴是上下。添加到 X 轴使其更向右，添加到 Y 轴使其更向下。

# wpf - 此列表是否正确理解了 Microsoft 当前的应用程序部署选项？

> ID：461186
> 
> 赞同：18
> 
> 时间：2009-01-20T12:54:30.290
> 
> 标签：wpf, silverlight, xbap

我正在尝试了解 Microsoft 当前提供的许多应用程序部署选项。

做一些研究发现了几十个令人困惑的术语：

*   “WPF 应用程序”
*   “点击一次应用程序”
*   “WPF ClickOnce 应用程序”
*   “微星应用”
*   “XBAP 应用程序”
*   “使用 ClickOnce 部署的 XBAP 应用程序”
*   “已安装 ClickOnce 应用程序”
*   “WPF 网络应用程序”
*   “ASP.NET 网络应用程序”
*   “ASP.NET MVC Web 应用程序”
*   “银光应用”
*   “完整的 WPF 应用程序”
*   “带有同步框架支持的 ClickOnce”

我将我的发现整理成以下七种不同的方法。希望得到反馈：

1.  “使用 MSI 部署的 WPF 应用程序”（允许大量安装选项）

    *   目标计算机上需要 MSI 运行时
    *   带有选项的向导
    *   可以指定每个用户或每台机器
    *   可以修改目标计算机上的文件和注册表，仅受管理员设置的访问权限限制
    *   可以在桌面上放置快捷方式
    *   替换系统文件等可以很容易地进入目标计算机上的DLL地狱
    *   更新是一个很大的负面影响：检测可用更新需要额外的工具/自定义编程，而不是内置的
    *   用户无需在线即可使用应用程序
2.  “使用 ClickOnce 部署的 WPF 应用程序”：（如果您想要自动更新但在沙箱中运行则很好）

    *   需要两次点击（点击超链接，点击是），无需用户输入
    *   仅适用于当前用户，没有每台机器安装
    *   桌面没有快捷方式
    *   像普通应用程序一样出现在程序列表中
    *   应用程序文件始终复制到 ../My Documents/My Applications
    *   您的应用程序的快捷方式将放在开始菜单/您的公司名称中
    *   无法修改目标计算机，与操作系统隔离
    *   自动检测并更新较新版本
    *   只需将它们放在网络服务器上（客户端检测并获取它们）即可发布
    *   需要 .NET 2.0 或更高版本
    *   与 Java Web Start 相媲美
    *   解决了四个问题：（1）易于部署，（2）易于更新，（3）对目标计算机影响小，（4）无需管理员权限。
    *   被认为是“低影响”
    *   如果两个用户在同一台​​机器上安装了相同的 ClickOnce 应用程序，他们不会互相破坏
    *   采用 CAS 确保安全
    *   用户无需在线即可使用应用程序
    *   独立的 ClickOnce 应用程序现在无法在 Firefox 和 Mac 上使用 Firefox，因为它需要 .NET 运行时
    *   仅限于单窗口应用程序，因为它们在浏览器中运行
    *   构建 ClickOnce 清单比 Silverlight 等容易得多，因为 IDE 将为您完成几乎所有工作；您只需将文件托管在某处（可以是 Web URL；可以是网络 UNC）。
3.  「XBAP App」：xcopy 部署.xbap 文件，IE 和火狐浏览器像网页一样立即显示

    *   XBAP 模型的真正目标是创建一个等效于传统 HTML 和 JavaScript 网站（或 Flash 小程序）的 WPF
    *   目标计算机只需运行应用程序，无需在其网络浏览器（IE 或 Firefox）中通过网络安装
    *   它们适用于您希望非常容易部署的 Intranet 应用程序、完整的 .NET 框架（与 Silverlight 相对）和浏览器的导航模型。
    *   99% WPF 功能（相对于 Silverlight 的 WPF 功能子集）
    *   也可以通过 ClickOnce 自动部署，但 XCOPY 更常见
    *   YourApp.xbap 确实是 ClickOnce 部署清单
    *   在沙箱中运行
    *   用户必须在线才能使用应用程序
    *   这些必须是“基于页面”的应用程序，而不是“基于 Windows”的应用程序
    *   “XBAP 似乎在浏览器内部运行只是因为它在浏览器窗口中显示其所有内容。这与加载在浏览器进程中的 ActiveX 控件（和 Silverlight）使用的模型不同。”
    *   XBAP 提供“无提示”体验，只要安装了 .NET 3.5，它就会像网页一样显示在浏览器中。
    *   不允许 XBAP 通过 Interop 使用 WinForm 控件
    *   不允许使用窗口拖放
    *   不允许使用最高级的 WCF 功能，并且 XBAP 无法与托管 XBAP 的服务器以外的任何服务器通信
    *   “如果您的应用程序需要完全信任，您应该考虑构建一个独立的 WPF 应用程序并使用 ClickOnce 进行部署”（[C# 2008 中的 Pro WPF](http://tanguay.info/web/index.php?pg=books&id=1)）
    *   技巧：您可以将多个 xbap 应用程序嵌入到一个 HTML 页面上的多个 iframe 中。
4.  “Silverlight App”：在客户端浏览器中运行，使用下载的 .NET 框架的 4MB 子集，即没有 3D）

    *   跨浏览器（Opera 和 Safari 也可以使用应用程序）
    *   更新应用程序就像使用 ClickOnce 或 XBAP 一样简单
    *   单窗口应用
    *   应用程序当然在沙箱中
    *   仅异步
5.  《ASP.NET MVC with JQuery/AJAX》：在RAD和TDD方面等同于WPF开发的新开发平台

    *   这种方法值得与 WPF/Silverlight 方法一起考虑
6.  “ASP.NET App”：随着 ASP.NET MVC 获得认可，带有 ViewState 等的经典 Web 应用程序可能会越来越少使用

7.  “WinForm App”：经典的windows应用，随着WPF的接受度会越来越少

我将特别感谢以下方面的反馈：

*   控件的可重用性如何（例如，如果我们在 Silverlight 中开发，我们可以在 XBAP 中重用我们的代码/控件吗？）
*   对于有时离线，有时在线并且需要访问 WCF 的客户的最佳方法是什么（我认为可能是 clickOnce 应用程序）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T16:39:38.807

伟大的总结，爱德华。

Silverlight 中的大部分代码可以直接在 WPF 和 WPF XBAP 应用程序中使用，因为 Silverlight 是 WPF 的子集。对于 XAML，您将不得不更改命名空间 URI，并且可能需要进行一些轻微的手动调整。
对于 XAML 到 Silverlight 的转换，您还必须更改命名空间 URI，但如果使用了 Silverlight 中不存在的 WPF 元素，则可能需要重构。WPF 和同步框架是在线/离线应用程序的绝佳选择。有关WPF/Sync 框架应用程序的示例，请参阅[Syndicated Client Experience Starter Kit 。](http://windowsclient.net/wpf/starter-kits/sce.aspx)Silverlight + Windows Live Mesh 还将提供在线/离线功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T18:44:15.543

MS 支持的客户端应用程序的部署选项是

*   [MSI](http://msdn.microsoft.com/en-us/library/cc185688(VS.85).aspx)（任何 Windows 应用程序）
*   [Clickonce](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)（仅适用于 .Net 客户端应用程序）

Clickonce 不是 WPF 特定的。

XBAPS 是在受信任的安全沙箱中单击一次部署、浏览器托管的 WPF 应用程序。WinForms 应用程序可以单击部署，并且可以托管在浏览器中。

Silverlight（大部分）与 WPF 源兼容。您可以将 SL 控件重新编译为 WPF 控件。

非浏览器托管的 clickonce 可能非常适合您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T00:16:54.420

应用启动体验：

MSI = 仅 Windows。很多点击。使用前安装。适用于非常庞大且资源密集型的应用程序。应用程序可以在 DVD 上分发。应用程序可以做任何事情。没有技术限制。

ClickOnce = 仅 Windows。可以从网页激活。下载一次。保留有关其来源（服务器）的信息，并可以自动更新。应用程序受到限制。需要.NET

Silverlight = 在 Windows/Max/Linux（很快）和未来的手机（计划中）上运行。是网页还是可以嵌入到html中。代码在服务器上，永远不会安装。需要 Silverlight-Runtime。提供 WPF 的子集

XBAP = 与 silverlight 类似，但仅适用于 windows。没有人会需要它。银光更好

编程技术：

Silverlight = 在客户端机器上运行。使用 WPF*

ASP.NET = 在 .NET 中的服务器机器上运行，但在客户端机器上运行 Javascript/html。

WinForms = 旧技术

WCF = 不适用于基于浏览器的应用程序。适用于分布式应用程序。可以打开所有进入客户端混搭的大门。使用 WCF = 需要 MSI。

WCF 为服务器提供了一个很好的框架。当您使用 REST 进行接口时，您将永远不需要客户端上的 WCF。客户端可以在 ClickOnce 和 MSI 安装的应用程序中连接/断开连接。您必须在 silverlight 和 ASP 中连接到 appstart 的网页。

XAML 可用于 silverlight/wpf/xbap。wpf/silverlight 的微小变化。据我所知，wpf/xbap 没有变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T22:33:32.350

我不会这么快就将 XBAP 视为“仅适用于 Windows 的 Silverlight”。因为它使用完整的 WPF 集，所以只要您在对 XBAP 施加的部分信任限制范围内工作，就可以为 WPF 应用程序和 XBAP 使用相同的代码库。

此外，从 .NET 3.5 开始，WCF 确实在部分信任下的 XBAP 中工作。您不能像在完全信任的 WPF 应用程序中那样做，但它仍然很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T17:40:56.357

您列出了“MSI 应用程序”。Windows Installer 是 Microsoft 在 Windows 上安装和升级程序的技术。它创建的安装包具有“.msi”扩展名。（它最初将被称为“Microsoft Installer”。他们将其更改为“Windows Installer”，但保留扩展名。）它定义了创建安装包的标准方法。可以通过许多不同的工具（InstallShield、WiX、Visual Studio 等）创建包。它不仅限于 WPF 应用程序。您可以使用它来安装几乎任何类型的应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T09:08:08.940

Live Framework (Live Mesh vNext) 提供的另一个部署选项是支持网格的 Web 应用程序 (MEWA)。这使您可以打包 Silverlight、DHTML 和 Flash 应用程序以在 Live Desktop 中在线运行或在 Windows 桌面上在线/离线运行。您可以将 MEWA 安装到 Mesh 中，并将其自动部署到 Mesh 中的所有设备。如果发布了新版本的应用程序，则更新也可以同步到所有设备。

有迹象表明，除了 Silverlight/DHTML/Flash 之外，未来版本的 Live Framework 将支持 MSI 和 CAB 打包应用程序，大概具有类似的部署功能。

支持网格的 Web 应用程序文档：http: [//msdn.microsoft.com/en-us/library/dd199554.aspx](http://msdn.microsoft.com/en-us/library/dd199554.aspx)

# version-control - 版本号从何而来？

> ID：461202
> 
> 赞同：6
> 
> 时间：2009-01-20T12:58:20.313
> 
> 标签：version-control, version-numbering

我有一个版本控制系统（例如 Subversion），现在我想建立一个构建过程。现在我必须创建一个版本号并将其插入系统。但是版本号是从哪里来的呢？假设我想使用这个常见的 <major>.<minor>.<bugfix/revision> 方案。我应该将一个数字传递给构建脚本吗？或者我应该传递像 increaseMajor、increaseMinor、increaseRevision 这样的参数吗？或者您会建议使用构建脚本将检测到的编号创建一个分支吗？

我可以想象主要和次要版本号必须手动输入某个地方。修订号可以自动增加。但是我仍然不知道将主要和次要号码放在哪里。

就我而言，我有一些我想压缩的 php 文件，但在我必须将一些版本号插入 php 文件之前。

* * *

我编辑了这篇文章，试图让我的要求更清楚：

我不使用 Subversion，这只是一个例子。而且我不想讨论版本号方案。

想象一下，我想创建 3.5.0 或 3.5.1 版本。我会将此版本号传递给构建脚本吗？脚本会在存储库中使用此编号创建分支，还是希望有人已经创建了此分支？手动？或者构建脚本会查找分支的名称（例如'3.5.1）并将其用于其他事情吗？版本号是来自我的大脑还是自动创建的（我猜它来自我的小大脑并创建了修订号）？或者您会将数字放入可能插入存储库的文件中？

我想如果会使用发布管理工具，我会在那里插入版本号。但我还没用过。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T13:06:39.453

对于颠覆，要么采用全局修订号并将其用作“构建”号，或者更好的是，根本不依赖它并使用标签和/或分支管理版本。全局修订的主要问题正是，它对 repo 是全局的。即使回购的某些部分没有改变，它也会增加。

恕我直言，将版本与 repo 的修订完全分离更好。你有标签，使用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T12:19:39.047

同意所有以前关于使用分支和标签的意见。另外，分支名称和标签名称可以通过一些巧妙的脚本合并到构建过程中。

我想补充的唯一一点是您应该将您的 SVN 修订版偷偷带入每个构建中。有时很容易通过修订返回到某个点，而不是知道标签或分支。99% 的标签/分支已经足够好，但修订版非常适合增量/内部/连续/测试构建。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T13:28:23.993

所有分支都应手动创建。构建脚本应该处理一个标签和/或分支，从检查它开始（或者可能正在更新它）。作为构建过程的一部分，在构建的确切快照上创建标签是个好主意。

您通常会有内部版本号和版本。内部版本号可以自动增加并作为构建的一部分签入版本控制（基于标签的构建除外，其中内部版本号必须保留在存储库之外 - 避免基于标签的构建的另一个原因）。

版本通常存储在一个文件中，您在每个发布周期手动更新一次。它被检入正确的分支，然后单独离开。例如，主线文件中的 version = "3"，release 分支上的第一个修订版本 = "3.5"，如果需要补丁版本，则将其从 release 分支分支并签入 version = “3.5.1”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T13:08:19.870

svn 或任何其他版本控制系统中的修订版与您的产品版本号（甚至您的内部版本号）不同。

您可以通过多种方式强制执行版本号。通常在颠覆中，您可以为构建创建一个分支（或标签，它们本质上是相同的），如果这是一个发布版本，您为此创建一个标签，例如 svn://my-repo/releases/1.0.0

您可以将参数传递给构建脚本以获取代码并将其用作构建号，或者拥有构建脚本使用的目录，然后 svn 将其切换到您想要构建的分支，脚本可以使用 svn信息来确定它正在构建什么版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T12:08:33.143

```
x.y.i.j 
```

其中`x`- 主要版本，`y`- 次要版本，`i`- 内部版本号，`j`- 修订号

`Major version`主要更改的增量（新架构、新 UI 等）

`Minor version`微小变化的增量（性能改进，主要错误修复等），

`Build number`每次公开发布时都会增加。

`Revision number`每次提交对项目源代码树的更改时递增。

我更喜欢将 0 作为修订号指向 AssemblyInfo.cs，并将实数指向发布包的名称（foo-1.1.7.110-source.zip）

# c++ - 何时使用虚拟析构函数？

> ID：461203
> 
> 赞同：1724
> 
> 时间：2009-01-20T12:58:21.280
> 
> 标签：c++, polymorphism, shared-ptr, virtual-destructor

我对大多数理论都有扎实的理解，`OOP`但让我很困惑的一件事是虚拟析构函数。

我认为析构函数总是被调用，不管是什么，对于链中的每个对象。

你打算什么时候把它们变成虚拟的，为什么？

* * *

## 回答 #1

> 赞同：1761
> 
> 时间：2009-01-20T13:04:58.677

当您可能通过指向基类的指针删除派生类的实例时，虚拟析构函数很有用：

```
class Base 
{
    // some virtual methods
};

class Derived : public Base
{
    ~Derived()
    {
        // Do some important cleanup
    }
}; 
```

在这里，您会注意到我没有将 Base 的析构函数声明为`virtual`. 现在，让我们看一下以下代码段：

```
Base *b = new Derived();
// use b
delete b; // Here's the problem! 
```

由于 Base 的析构函数不是`virtual`并且`b`是`Base*`指向`Derived`对象，`delete b`因此具有[未定义的行为](https://stackoverflow.com/q/2397984/20984)：

> [在`delete b`]中，如果待删除对象的静态类型与其动态类型不同，则静态类型应为待删除对象动态类型的基类，且**静态类型应具有虚析构函数或行为未定义**。

在大多数实现中，对析构函数的调用将像任何非虚拟代码一样被解析，这意味着将调用基类的析构函数而不是派生类的析构函数，从而导致资源泄漏。

总而言之，`virtual`当要对基类进行多态操作时，请始终创建基类的析构函数。

如果要防止通过基类指针删除实例，可以使基类析构函数受保护且非虚拟；通过这样做，编译器不会让您调用`delete`基类指针。

[您可以在Herb Sutter](http://www.gotw.ca/publications/mill18.htm)的这篇文章中了解有关虚拟性和虚拟基类析构函数的更多信息。

* * *

## 回答 #2

> 赞同：273
> 
> 时间：2013-04-09T13:39:51.147

虚拟构造函数是不可能的，但虚拟析构函数是可能的。让我们进行实验......

```
#include <iostream>

using namespace std;

class Base
{
public:
    Base(){
        cout << "Base Constructor Called\n";
    }
    ~Base(){
        cout << "Base Destructor called\n";
    }
};

class Derived1: public Base
{
public:
    Derived1(){
        cout << "Derived constructor called\n";
    }
    ~Derived1(){
        cout << "Derived destructor called\n";
    }
};

int main()
{
    Base *b = new Derived1();
    delete b;
} 
```

上面的代码输出如下：

```
Base Constructor Called
Derived constructor called
Base Destructor called 
```

派生对象的构造遵循构造规则，但是当我们删除“b”指针（基指针）时，我们发现只调用了基析构函数。但这绝不能发生。为了做适当的事情，我们必须将基本析构函数设为虚拟。现在让我们看看下面会发生什么：

```
#include <iostream>

using namespace std;

class Base
{ 
public:
    Base(){
        cout << "Base Constructor Called\n";
    }
    virtual ~Base(){
        cout << "Base Destructor called\n";
    }
};

class Derived1: public Base
{
public:
    Derived1(){
        cout << "Derived constructor called\n";
    }
    ~Derived1(){
        cout << "Derived destructor called\n";
    }
};

int main()
{
    Base *b = new Derived1();
    delete b;
} 
```

输出更改如下：

```
Base Constructor Called
Derived Constructor called
Derived destructor called
Base destructor called 
```

所以基指针的销毁（它在派生对象上进行分配！）遵循销毁规则，即首先是派生，然后是基。另一方面，没有什么能比得上虚拟构造函数。

* * *

## 回答 #3

> 赞同：212
> 
> 时间：2009-01-20T13:11:51.597

在多态基类中声明析构函数为虚拟的。这是 Scott Meyers 的[Effective C++](https://rads.stackoverflow.com/amzn/click/com/0201924889)中的第 7 项。Meyers 继续总结说，如果一个类有*任何*虚函数，它就应该有一个虚析构函数，并且那些不是设计为基类或不是设计为多态使用的类不应该*声明*虚析构函数。

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2009-01-21T01:09:49.150

另请注意，在没有虚拟析构函数时删除基类指针将导致***未定义的行为***。我最近学到的东西：

[在 C++ 中重写 delete 应该如何表现？](https://stackoverflow.com/questions/408196/how-should-overriding-delete-in-c-behave)

多年来我一直在使用 C++，但我仍然设法上吊。

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2009-01-20T13:01:01.400

只要您的类是多态的，就使析构函数成为虚拟的。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2015-05-18T13:38:00.997

### 通过指向基类的指针调用析构函数

```
struct Base {
  virtual void f() {}
  virtual ~Base() {}
};

struct Derived : Base {
  void f() override {}
  ~Derived() override {}
};

Base* base = new Derived;
base->f(); // calls Derived::f
base->~Base(); // calls Derived::~Derived 
```

虚拟析构函数调用与任何其他虚拟函数调用没有什么不同。

对于`base->f()`，调用将被分派到`Derived::f()`，并且对于`base->~Base()`- 它的覆盖函数 -`Derived::~Derived()`将被调用是相同的。

当间接调用析构函数时也会发生同样的情况，例如`delete base;`. 该`delete`语句将调用`base->~Base()`将被分派到`Derived::~Derived()`.

### 具有非虚拟析构函数的抽象类

如果您不打算通过指向其基类的指针来删除对象 - 那么就不需要虚拟析构函数。让它`protected`不会被意外调用：

```
// library.hpp

struct Base {
  virtual void f() = 0;

protected:
  ~Base() = default;
};

void CallsF(Base& base);
// CallsF is not going to own "base" (i.e. call "delete &base;").
// It will only call Base::f() so it doesn't need to access Base::~Base.

//-------------------
// application.cpp

struct Derived : Base {
  void f() override { ... }
};

int main() {
  Derived derived;
  CallsF(derived);
  // No need for virtual destructor here as well.
} 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2015-01-29T07:11:34.577

当您希望不同的析构函数在通过基类指针删除对象时遵循正确的顺序时，析构函数的虚拟关键字是必要的。例如：

```
Base *myObj = new Derived();
// Some code which is using myObj object
myObj->fun();
//Now delete the object
delete myObj ; 
```

如果您的基类析构函数是虚拟的，那么对象将按顺序销毁（首先是派生对象，然后是基类）。如果您的基类析构函数不是虚拟的，那么只有基类对象将被删除（因为指针属于基类“Base *myObj”）。所以派生对象会有内存泄漏。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2016-08-26T05:33:24.043

简单来说，虚拟析构函数就是在删除指向派生类对象的基类指针时，按正确的顺序销毁资源。

```
 #include<iostream>
 using namespace std;
 class B{
    public:
       B(){
          cout<<"B()\n";
       }
       virtual ~B(){ 
          cout<<"~B()\n";
       }
 };
 class D: public B{
    public:
       D(){
          cout<<"D()\n";
       }
       ~D(){
          cout<<"~D()\n";
       }
 };
 int main(){
    B *b = new D();
    delete b;
    return 0;
 }

OUTPUT:
B()
D()
~D()
~B()

==============
If you don't give ~B()  as virtual. then output would be 
B()
D()
~B()
where destruction of ~D() is not done which leads to leak 
```

* * *

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2012-11-08T16:28:11.940

我喜欢思考接口和接口的实现。在 C++ 中，接口是纯虚拟类。析构函数是接口的一部分，并有望实现。因此析构函数应该是纯虚拟的。构造函数呢？构造函数实际上不是接口的一部分，因为对象总是被显式实例化。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-05-18T14:50:44.757

我认为这个问题的核心是关于虚拟方法和多态性，而不是具体的析构函数。这是一个更清晰的例子：

```
class A
{
public:
    A() {}
    virtual void foo()
    {
        cout << "This is A." << endl;
    }
};

class B : public A
{
public:
    B() {}
    void foo()
    {
        cout << "This is B." << endl;
    }
};

int main(int argc, char* argv[])
{
    A *a = new B();
    a->foo();
    if(a != NULL)
    delete a;
    return 0;
} 
```

将打印出：

```
This is B. 
```

没有`virtual`它会打印出来：

```
This is A. 
```

现在您应该了解何时使用虚拟析构函数。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2017-01-24T16:22:09.720

虚拟基类析构函数是“最佳实践”——您应该始终使用它们来避免（难以检测）内存泄漏。使用它们，您可以确保类的继承链中的所有析构函数都被调用（以正确的顺序）。使用虚拟析构函数从基类继承会使继承类的析构函数也自动成为虚拟的（因此您不必在继承类析构函数声明中重新键入“virtual”）。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2019-03-06T19:27:34.700

如果使用`shared_ptr`（仅 shared_ptr，而不是 unique_ptr），则不必将基类析构函数设为虚拟：

```
#include <iostream>
#include <memory>

using namespace std;

class Base
{
public:
    Base(){
        cout << "Base Constructor Called\n";
    }
    ~Base(){ // not virtual
        cout << "Base Destructor called\n";
    }
};

class Derived: public Base
{
public:
    Derived(){
        cout << "Derived constructor called\n";
    }
    ~Derived(){
        cout << "Derived destructor called\n";
    }
};

int main()
{
    shared_ptr<Base> b(new Derived());
} 
```

输出：

```
Base Constructor Called
Derived constructor called
Derived destructor called
Base Destructor called 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2013-07-17T14:03:54.683

什么是虚拟析构函数或如何使用虚拟析构函数

类析构函数是与前面的类同名的函数 ~ 它将重新分配由类分配的内存。为什么我们需要一个虚拟析构函数

请参阅以下带有一些虚拟功能的示例

该示例还告诉您如何将字母转换为大写或小写

```
#include "stdafx.h"
#include<iostream>
using namespace std;
// program to convert the lower to upper orlower
class convertch
{
public:
  //void convertch(){};
  virtual char* convertChar() = 0;
  ~convertch(){};
};

class MakeLower :public convertch
{
public:
  MakeLower(char *passLetter)
  {
    tolower = true;
    Letter = new char[30];
    strcpy(Letter, passLetter);
  }

  virtual ~MakeLower()
  {
    cout<< "called ~MakeLower()"<<"\n";
    delete[] Letter;
  }

  char* convertChar()
  {
    size_t len = strlen(Letter);
    for(int i= 0;i<len;i++)
      Letter[i] = Letter[i] + 32;
    return Letter;
  }

private:
  char *Letter;
  bool tolower;
};

class MakeUpper : public convertch
{
public:
  MakeUpper(char *passLetter)
  {
    Letter = new char[30];
    toupper = true;
    strcpy(Letter, passLetter);
  }

  char* convertChar()
  {   
    size_t len = strlen(Letter);
    for(int i= 0;i<len;i++)
      Letter[i] = Letter[i] - 32;
    return Letter;
  }

  virtual ~MakeUpper()
  {
    cout<< "called ~MakeUpper()"<<"\n";
    delete Letter;
  }

private:
  char *Letter;
  bool toupper;
};

int _tmain(int argc, _TCHAR* argv[])
{
  convertch *makeupper = new MakeUpper("hai"); 
  cout<< "Eneterd : hai = " <<makeupper->convertChar()<<" ";     
  delete makeupper;
  convertch *makelower = new MakeLower("HAI");;
  cout<<"Eneterd : HAI = " <<makelower->convertChar()<<" "; 
  delete makelower;
  return 0;
} 
```

从上面的示例中，您可以看到 MakeUpper 和 MakeLower 类的析构函数都没有被调用。

使用虚拟析构函数查看下一个示例

```
#include "stdafx.h"
#include<iostream>

using namespace std;
// program to convert the lower to upper orlower
class convertch
{
public:
//void convertch(){};
virtual char* convertChar() = 0;
virtual ~convertch(){}; // defined the virtual destructor

};
class MakeLower :public convertch
{
public:
MakeLower(char *passLetter)
{
tolower = true;
Letter = new char[30];
strcpy(Letter, passLetter);
}
virtual ~MakeLower()
{
cout<< "called ~MakeLower()"<<"\n";
      delete[] Letter;
}
char* convertChar()
{
size_t len = strlen(Letter);
for(int i= 0;i<len;i++)
{
Letter[i] = Letter[i] + 32;

}

return Letter;
}

private:
char *Letter;
bool tolower;

};
class MakeUpper : public convertch
{
public:
MakeUpper(char *passLetter)
{
Letter = new char[30];
toupper = true;
strcpy(Letter, passLetter);
}
char* convertChar()
{

size_t len = strlen(Letter);
for(int i= 0;i<len;i++)
{
Letter[i] = Letter[i] - 32;
}
return Letter;
}
virtual ~MakeUpper()
{
      cout<< "called ~MakeUpper()"<<"\n";
delete Letter;
}
private:
char *Letter;
bool toupper;
};

int _tmain(int argc, _TCHAR* argv[])
{

convertch *makeupper = new MakeUpper("hai");

cout<< "Eneterd : hai = " <<makeupper->convertChar()<<" \n";

delete makeupper;
convertch *makelower = new MakeLower("HAI");;
cout<<"Eneterd : HAI = " <<makelower->convertChar()<<"\n ";

delete makelower;
return 0;
} 
```

虚拟析构函数将显式调用类的最派生的运行时析构函数，以便能够以适当的方式清除对象。

或访问链接

[https://web.archive.org/web/20130822173509/http://www.programminggallery.com/article_details.php?article_id=138](https://web.archive.org/web/20130822173509/http://www.programminggallery.com/article_details.php?article_id=138)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2017-03-23T17:50:24.113

我认为讨论“未定义”行为，或者至少是通过没有虚拟析构函数或更准确地说没有 vtable 的基类（/结构）删除时可能发生的“崩溃”未定义行为是有益的。下面的代码列出了一些简单的结构（类也是如此）。

```
#include <iostream>
using namespace std;

struct a
{
    ~a() {}

    unsigned long long i;
};

struct b : a
{
    ~b() {}

    unsigned long long j;
};

struct c : b
{
    ~c() {}

    virtual void m3() {}

    unsigned long long k;
};

struct d : c
{
    ~d() {}

    virtual void m4() {}

    unsigned long long l;
};

int main()
{
    cout << "sizeof(a): " << sizeof(a) << endl;
    cout << "sizeof(b): " << sizeof(b) << endl;
    cout << "sizeof(c): " << sizeof(c) << endl;
    cout << "sizeof(d): " << sizeof(d) << endl;

    // No issue.

    a* a1 = new a();
    cout << "a1: " << a1 << endl;
    delete a1;

    // No issue.

    b* b1 = new b();
    cout << "b1: " << b1 << endl;
    cout << "(a*) b1: " << (a*) b1 << endl;
    delete b1;

    // No issue.

    c* c1 = new c();
    cout << "c1: " << c1 << endl;
    cout << "(b*) c1: " << (b*) c1 << endl;
    cout << "(a*) c1: " << (a*) c1 << endl;
    delete c1;

    // No issue.

    d* d1 = new d();
    cout << "d1: " << d1 << endl;
    cout << "(c*) d1: " << (c*) d1 << endl;
    cout << "(b*) d1: " << (b*) d1 << endl;
    cout << "(a*) d1: " << (a*) d1 << endl;
    delete d1;

    // Doesn't crash, but may not produce the results you want.

    c1 = (c*) new d();
    delete c1;

    // Crashes due to passing an invalid address to the method which
    // frees the memory.

    d1 = new d();
    b1 = (b*) d1;
    cout << "d1: " << d1 << endl;
    cout << "b1: " << b1 << endl;
    delete b1;  

/*

    // This is similar to what's happening above in the "crash" case.

    char* buf = new char[32];
    cout << "buf: " << (void*) buf << endl;
    buf += 8;
    cout << "buf after adding 8: " << (void*) buf << endl;
    delete buf;
*/
} 
```

我并不是建议您是否需要虚拟析构函数，尽管我认为一般来说拥有它们是一个好习惯。我只是指出如果您的基类（/struct）没有 vtable 而您的派生类（/struct）有并且您通过基类（/struct）删除对象，您最终可能会崩溃的原因指针。在这种情况下，您传递给堆的空闲例程的地址是无效的，因此是崩溃的原因。

如果你运行上面的代码，你会在问题发生时清楚地看到。当基类（/struct）的this指针与派生类（/struct）的this指针不同时，你就会遇到这个问题。在上面的示例中，结构 a 和 b 没有 vtable。结构 c 和 d 确实有 vtables。因此，指向 ac 或 d 对象实例的 a 或 b 指针将被修复以解释 vtable。如果你将这个 a 或 b 指针传递给 delete，它会因为地址对堆的空闲例程无效而崩溃。

如果您计划从基类指针中删除具有 vtable 的派生实例，则需要确保基类具有 vtable。一种方法是添加一个虚拟析构函数，无论如何您都可能希望正确清理资源。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-09-09T07:02:02.327

当您需要从基类调用派生类析构函数时。您需要在基类中声明虚拟基类析构函数。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-09-23T20:13:03.240

我认为这里的大多数答案都没有抓住重点，除了接受的答案，这是一件好事。然而，让我再添加一个关于这个问题的不同观点：如果你想多态地删除这个类的实例，你需要一个虚拟析构函数。

这种回避了这个问题，所以让我详细说明一下：正如许多人指出的那样，如果你调用`delete base_ptr`并且析构函数不是虚拟的，你会得到不希望的行为。但是，有几个假设需要明确：

*   如果您的类不是基类，那么您希望不要编写这样的代码。在这种情况下，我不是指手动内存管理，它本身就是不好的，而是从这个类公开派生的。不应该被设计为基类的类不应该被继承，例如`std::string`。C++ 允许你在脚下射击自己。这是你的错，而不是没有虚拟析构函数的基类。
*   如果析构函数不可访问（受保护或私有），则此代码将无法编译，因此不会发生不希望的行为。拥有一个受保护的析构函数是很有用的，特别是对于 mixin，而且（在较小程度上）对于接口也是如此。除非您实际使用它们，否则您不想招致虚函数的开销。相反，使析构函数受保护可以防止不良行为，但不会限制您。
*   如果您实际上编写了一个应该派生的类，那么无论如何您通常都会有虚函数。作为它们的用户，您通常只会通过指向基类的指针来使用它们。当这种用途包括处置它们时，它也需要是多态的。这就是你应该将析构函数设为虚拟的情况。

有关该主题的类似不同观点，另请阅读[何时不应该使用虚拟析构函数？](https://stackoverflow.com/questions/300986/when-should-you-not-use-virtual-destructors)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-05-20T07:45:05.823

关于它的基本定义`virtual`是确定类的成员函数是否可以在其派生类中被覆盖。

一个类的 D-tor 基本上是在作用域的末尾调用的，但是有一个问题，比如我们在 Heap 上定义一个实例（动态分配），我们应该手动删除它。

指令一执行，就会调用基类析构函数，但不会调用派生的析构函数。

一个实际的例子是，在控制领域，您必须操纵效应器、执行器。

在作用域结束时，如果不调用其中一个动力元素（Actuator）的析构函数，将会产生致命的后果。

```
#include <iostream>

class Mother{

public:

    Mother(){

          std::cout<<"Mother Ctor"<<std::endl;
    }

    virtual~Mother(){

        std::cout<<"Mother D-tor"<<std::endl;
    }

};

class Child: public Mother{

    public:

    Child(){

        std::cout<<"Child C-tor"<<std::endl;
    }

    ~Child(){

         std::cout<<"Child D-tor"<<std::endl;
    }
};

int main()
{

    Mother *c = new Child();
    delete c;

    return 0;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-09-23T18:51:10.790

除非您有充分的理由不这样做，否则将所有析构函数设为虚拟。

否则会发生这样的邪恶：

假设您有一个包含 Apple 和 Orange 对象的 Fruit 指针数组。

当您从 Fruit 对象的集合中删除时，~Apple() 和 ~Orange() 将无法调用，除非 ~Fruit() 是虚拟的。

正确完成的示例：

```
#include <iostream>
using namespace std;
struct Fruit { // good
  virtual ~Fruit() { cout << "peel or core should have been tossed" << endl; } 
};
struct Apple:  Fruit { virtual ~Apple()  {cout << "toss core" << endl; } };
struct Orange: Fruit { virtual ~Orange() {cout << "toss peel" << endl; } };

int main() { 
  Fruit *basket[]={ new Apple(), new Orange() };
  for (auto fruit: basket) delete fruit;
}; 
```

良好的输出

```
toss core
peel or core should have been tossed
toss peel
peel or core should have been tossed 
```

例子做错了：

```
#include <iostream>
using namespace std;
struct Fruit { // bad 
  ~Fruit() { cout << "peel or core should have been tossed" << endl; } 
};
struct Apple:  Fruit { virtual ~Apple()  {cout << "toss core" << endl; } };
struct Orange: Fruit { virtual ~Orange() {cout << "toss peel" << endl; } };

int main() { 
  Fruit *basket[]={ new Apple(), new Orange() };
  for (auto fruit: basket) delete fruit;
}; 
```

输出不良

```
peel or core should have been tossed
peel or core should have been tossed 
```

（注意：为了简洁起见，我使用 struct 的地方，通常使用 class 并指定 public）

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2015-01-02T16:27:51.690

任何公开继承的类，无论是否多态，都应该有一个虚拟析构函数。换句话说，如果它可以被基类指针指向，那么它的基类应该有一个虚析构函数。

如果是虚拟的，则调用派生类析构函数，然后调用基类析构函数。如果不是虚拟的，则仅调用基类析构函数。

# sql - Django：生成博客的活动条目列表。这有效率吗？

> ID：461204
> 
> 赞同：1
> 
> 时间：2009-01-20T12:58:41.950
> 
> 标签：sql, database, django, performance

以下查询做了我想做的事情，但是，我不知道它是否有效。我浏览了[Django 聚合](http://docs.djangoproject.com/en/dev/topics/db/aggregation/)文档，将它们放在一起，看着查询，然后像一只迷糊的狗一样侧着头。

查询实际所做的是获取已发布条目的“name”和“name_slug”，其中包含一个或多个已批准的评论，并按最新评论的“date_published”字段对结果进行排序。结果是最近活动条目的列表。

所以有几个问题。(1) 您在查询中看到的任何内容都只是一个明确的禁忌。(2) 有没有办法可以看到查询数据库的 RAW SQL？

楷模：

```
class Entry(models.Model):
    name = models.CharField(max_length=200, unique=True)
    name_slug = models.SlugField(max_length=200, blank=True, editable=False, unique=True)
    date_published = models.DateTimeField()
    is_published = models.BooleanField(default=False)

class Comment(models.Model):
    entry = models.ForeignKey('Entry')
    date_published = models.DateTimeField()
    approved_choices = (('N', 'No'), ('Y', 'Yes'), ('M', 'Needs Moderation'),)
    approved = models.CharField(max_length=1, choices=approved_choices, default='N') 
```

询问：

```
active_entry_list = Entry.objects
    .values('name', 'name_slug')
    .filter(is_published=True, comment__approved='Y')
    .annotate(latest_comment=Max('comment__date_published'),comments=Count('comment'))
    .filter(comments__gte=1)
    .order_by('-latest_comment')
    [:6] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T13:05:50.017

2) 是的，如果 settings.DEBUG 为 true，原始 sql 查询存储在 django.db.connection.queries 中。

[http://blog.michaeltrier.com/2007/8/11/display-the-sql-django-orm-is-generating](http://blog.michaeltrier.com/2007/8/11/display-the-sql-django-orm-is-generating)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T18:00:39.173

我已将查询简化为：

```
active_entry_list = Entry.objects
    .values('name', 'name_slug')
    .filter(is_published=True, comment__approved='Y')
    .annotate(latest_comment=Max('comment__date_published'))
    .order_by('-latest_comment')
    [:6] 
```

如果它正在过滤，`comment__approved='Y'`则无需计算评论并再次使用`comments__gte=1`.

我会调查的`django.db.connection.queries`。接缝很简单。谢谢！

# .net - 使用本机 .NET 配置 DCOM 设置？

> ID：461218
> 
> 赞同：0
> 
> 时间：2009-01-20T13:02:47.930
> 
> 标签：.net, custom-action, dcom

前段时间，我发现了 .NET 3.5 中的 System.Directory 命名空间，它使我能够使用本机 .NET 方法轻松管理本地和域帐户，而不是使用 API 调用和导入非托管 DLL。

现在我需要在 MSI 设置中为某些旧版应用程序配置 DCOM 设置。据我所知，使用 InstallShield 2009 的板载方式无法做到这一点。

有什么方法可以使用.NET 配置 DCOM 设置，以便我能够编写托管的自定义操作，例如？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T13:19:13.577

据我所知，不在.NET 中。以编程方式查看[dcomcnfg 功能](https://stackoverflow.com/questions/454368/dcomcnfg-functionality-programmatically#455903)

# c# - c#从PDF中读取行

> ID：461220
> 
> 赞同：6
> 
> 时间：2009-01-20T13:03:50.863
> 
> 标签：c#, pdf, .net-2.0

我希望能够从 pdf 中逐行读取，将其与字符串（文件名）进行比较，如果字符串出现在该行中，则将该行写入列表。

到目前为止，我快速浏览了 ITextSharp 和 PDFSharp，但这些工具似乎不是适合这项工作的工具，因为它们最专注于更改和打印 pdf。

有谁知道从 pdf 中读取行的另一种方式，还是我应该继续尝试使用 ITextSharp 和 PDFSharp？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T14:12:16.980

我将[PDFBox](http://www.pdfbox.org/userguide/dot_net.html)与 Lucene 一起使用。很容易找出它是如何工作的并且完成了这项工作。它是开源和免费的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-23T16:10:20.810

您可能想尝试[Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)。

该库可用于从 PDF 的所有页面中提取多行纯文本，然后您可以在该文本中搜索文件名或其他任何内容。

请查看我对其他[类似问题](https://stackoverflow.com/q/4893898/249690)[的回答](https://stackoverflow.com/questions/4893898/pdf-text-search-c/4896440#4896440)中的示例。

免责声明：我为 Bit Miracle 工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T13:41:42.283

如您所知（我想）Pdf 不是文本文件格式。您可以使用许多工具来提取文本。
两个例子：
- Xpdf.PdftoText (www.foolabs.com/xpdf/) 免费 - Exe 命令行
- Pdflib.Tet (www.pdflib.com) $$$ - 库 (net, java, com, ...)

# language-agnostic - 我是否不道德地使用仅按大小写与其类型不同的变量名？

> ID：461231
> 
> 赞同：95
> 
> 时间：2009-01-20T13:08:46.717
> 
> 标签：language-agnostic, coding-style, naming-conventions, variable-names

例如，以这段代码为例：

```
var person = new Person(); 
```

或者对于你 Pythonistas：

```
person = Person() 
```

我经常被告知这是多么糟糕，但还没有看到这两行代码不道德的例子。对我来说，人就是一个人，试图给它取另一个名字是浪费时间。我想在语法高亮之前的日子里，这将是一件大事。但是现在，很容易将类型名称与变量名称区分开来。哎呀，在SO上很容易看出这里的区别。

还是我缺少什么？如果是这样，如果您能提供一个导致问题的代码示例，将会很有帮助。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-01-20T13:12:44.387

那些告诉你这不好的人的理由是什么？我一直这样做。这是命名一个类型的单个变量的最简单、最有表现力的方式。如果您需要两个对象，那么您可以使用有意义的形容词作为`Person`前缀，例如`person`

```
fastPerson
slowPerson 
```

否则只是

```
person 
```

我很好。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-01-20T13:13:01.983

我在方法签名中经常使用这种模式。如果我无法提供替代的描述性名称，那么恕我直言，这没有任何问题。

如果你有两种类型 Person 和 person ，那是非常非常错误的。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-01-20T13:15:30.450

我一直将它用于临时对象引用。我会像原始数据类型的瘟疫一样避免它。

```
Person person = new Person(); // okay

int Int = 42; // pure evil 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-01-20T19:25:57.737

如果有人说这是邪恶的，请问他们这样是否更好：

```
var abc = new Person(); 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-01-20T13:18:41.207

如果 Person 是上下文中的一般人，那么“人”是一个非常好的名字。当然，如果 Person 在代码中具有特定的角色，那么最好使用该角色来命名她。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-04-29T14:04:26.387

我想我会因为这样说而被否决，但是......

刚刚经历了一个世纪见证了史诗般的谋杀和贪婪，如果我们能做的最不道德的事情就是命名一个变量，我们程序员真的很幸运。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-20T13:12:59.533

我不认为它一定是“坏的”，但显然如果你可以限定它以提供更多上下文，比如它是什么样的人（你只与可能的许多人中的一个打交道），那么其他人就会选择它up可能会更好理解。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-20T13:14:00.110

杰森 - 我不确定谁告诉过你这很糟糕。许多作者使用它作为表达*类*（大写）的*实例*（小写）的标准方式。

 *我经常使用它，因为我发现小写变量实际上不仅向我传达了这是一个实例，而且还传达了类的名称。

除非有人有相反的有力论据，否则我肯定会继续这样做。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-20T14:40:38.607

它被认为不好的原因是，如果您将来需要 2 个人，那么您最终可以得到看起来像这样的代码。

人人 = 新人（）；

人 person2 = new Person();

那将接近“坏”。但是，在这种情况下，您应该重构您的原始人以区分两者。

至于您的示例，变量名称“person”是对象“Person”的完美描述性名称。因此，它没有任何问题。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-20T13:14:22.213

我说出它的名字：如果变量代表一个有 2 条狗的人，就叫它`personWith2Dogs`。如果变量的范围很短（如循环变量），那么人就可以了。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-20T16:55:18.790

我在我的代码中经常使用它，并且不认为它有什么问题。也就是说，我（可能）不会在一个方法中使用它超过一个屏幕，如果有多个 Person 类的实例。绝对不要将它们命名为 person1、person2、person3... 而是使用更具描述性的名称，例如 person_to_del、person_to_ban、person_to_update 等。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-20T17:16:14.520

这不是不道德的，但如果您未能激活区分大小写`Person`，全局搜索会找到两者。`person`我更喜欢前缀来使全局搜索/替换更容易，但绝对不是匈牙利语或长/复杂的东西。所以，我用...

`Person`类/类型 `aPerson`局部变量 `thePerson`方法参数 `myPerson`实例变量 `ourPerson`类变量

在极少数情况下，我可能会`p`在有很多引用的本地上下文中使用，但这通常只适用于循环索引等。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-01-20T17:20:53.603

这取决于。

如果你有严格的大写风格，所以变量以小写开头（并使用 under_scores 或 camelCase 进行分词），并且类以大写字母开头，那么很明显 person 是一个变量，Person 是一个类，当有人理解这一点时，它们似乎不会在重叠的命名空间中。（类似地，人们几乎不会混淆动词或名词“波兰语”和形容词“波兰语”。）

如果你没有这样的风格，那么你就有两个很容易混淆的名字，而且只是大小写不同。那很糟。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-20T13:16:18.763

人们使用的确切论点是什么？

如果他们不允许您使用 person 作为变量名，您可以考虑添加 'a' 前缀。

```
aPerson = Person() 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-20T13:16:22.320

我想说的是，每当您创建对象时，您可能都会想到一些特定的用途。单独的类型很少反映这种用途。

因此，如果您想在地址簿应用程序中创建一个新联系人，您可能需要调用变量`newContact`.

如果您正在对代码进行单元测试以检查`Person`未设置名称的对象的行为，您可能需要调用它们`unnamedPerson`或类似的东西。

调用它只是`person`放弃了使您的代码自我记录的大好机会。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-20T16:23:53.203

我认为你正在做的很好。我认为一般来说，达成一致的编码标准很重要。

例如，我将 lowerCamelCase 用于实例、变量，将 UpperCamelCase 用于类等

编码标准应该消除这个问题。

当我看到成功的开源程序时，它们通常具有编码标准

[http://drupal.org/coding-standards](http://drupal.org/coding-standards)

[http://help.joomla.org/content/view/826/125/](http://help.joomla.org/content/view/826/125/)

[http://wiki.rubyonrails.org/rails/pages/CodingStandards](http://wiki.rubyonrails.org/rails/pages/CodingStandards)

[http://lxr.linux.no/linux/Documentation/CodingStyle](http://lxr.linux.no/linux/Documentation/CodingStyle)

同意编码标准应该是你在这方面的最后一场战斗。

事实上看看维基百科条目（来自[http://en.wikipedia.org/wiki/CamelCase](http://en.wikipedia.org/wiki/CamelCase)）

编程和编码风格

编写源代码的编码风格指南（例如，Mesa 编程语言和 Java 编程语言）有时建议使用内部大写来指示单词边界。其中一些指南中包含的建议得到了静态分析工具的支持，这些工具检查源代码的遵守情况。

这些建议通常区分 UpperCamelCase 和 lowerCamelCase，通常指定应为特定类型的实体使用哪种类型：变量、记录字段、方法、过程、类型等。

一种广泛使用的 Java 编码风格规定 UpperCamelCase 用于类，lowerCamelCase 用于实例和方法。 [19] 认识到这种用法，一些 IDE（例如 Eclipse）实现了基于 CamelCase 的快捷方式。例如，在 Eclipse 的内容辅助功能中，仅键入 CamelCase 单词的大写字母将提示任何匹配的类或方法名称（例如，键入“NPE”并激活内容辅助可能会提示“NullPointerException”）。

用于编程的原始匈牙利符号指定“使用类型”（不是数据类型）的小写缩写应作为所有变量名称的前缀，名称的其余部分为 UpperCamelCase；因此，它是 lowerCamelCase 的一种形式。CamelCase 是 Java 和 Amiga 个人计算机文件名的官方约定。

Microsoft .NET 建议将 lowerCamelCase 用于参数和非公共字段，将 UpperCamelCase（又名“Pascal 样式”）用于其他类型的标识符。 [20]

Python 推荐使用 UpperCamelCase 作为类名。[21]

NIEM 注册表要求 XML 数据元素使用 UpperCamelCase，而 XML 属性使用 lowerCamelCase。

在 CamelCase 名称中包含大写缩写（主要是首字母缩写词和首字母缩写词）没有单一约定。方法包括将整个缩写保留为大写（例如在“useHTTPConnection”中）并仅将第一个字母保留为大写（例如在“useHttpConnection”中）。

骆驼案例在计算中绝不是通用的。几种现代编程语言的用户，尤其是 Lisp 和 Forth 系列的用户，几乎总是使用连字符。有时给出的原因包括这样做不需要在大多数键盘上进行切换，单词分开时更易读，并且驼峰式大小写可能根本无法在不区分大小写或大小写折叠的语言中可靠地保留（例如Common Lisp，虽然在技术上是一种区分大小写的语言，但默认情况下将标识符规范化（折叠）为大写）。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-01-20T18:24:00.827

可以做出更有力的论点，即这种方法名称不仅无害，而且可以作为优质代码的指标。

*   良好代码粒度的指标：如果您的方法简短、用途单一且具有描述性名称，则您不需要变量名称中的大量信息。如果你有很长的方法来做很多事情并且需要跟踪很多上下文和状态，那么你的变量名需要更具描述性。

*   通用计算被推入通用方法的指标：如果您在业务方法中对数据结构进行中间操作，例如必须对用户数组进行重复数据删除，则必须在范围内包含变量用`users[]`和之类的名字`deduplicatedUsers[]`。如果将重复数据删除移动到实用程序方法，则可以调用方法`Utils.dedup(array)`，并且可以调用重复数据删除的数组`deduplicatedArray`或仅调用`result`.

*   Java 反编译器经常使用类似的方案来命名局部变量（实例和类变量通常在字节码中可用，但局部变量不可用），结果比您预期的更具可读性，实际上通常比原始来源。

*   请参阅 Larry Wall 的“局部歧义是可以的”原则 - [http://www.wall.org/~larry/natural.html](http://www.wall.org/~larry/natural.html) 。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-09-14T06:29:30.637

仅当您使用 VB6 编程时。在这种*情况下*，你的行为是非法的，但不是不道德的。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-20T13:14:25.833

我也这样做，我也不明白为什么它应该是“不道德的”。虽然我可以理解它“可能”有时会令人困惑，但今天我们有带有智能感知和语法突出显示的 IDE，这将确保（如果你犯了错误并引用你的变量而不是你的类，反之亦然）你会很快就能看到你的错误。我们也有编译器。:)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-20T13:21:26.223

我也认为这种做法没有任何问题。只要该类只有一个变量，就容易写易读。Imo，这甚至适用于基本的文本编辑器。我个人不记得有人说这很糟糕，甚至是不道德的。继续这样做:)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-01-20T13:33:16.310

我认为您可能想到的“规则”更多地适用于原始类型，以及类名使变量名不佳的类。

例如，如果您正在处理计算在线商店中特定商品的成本，则以下代码不是很好的形式：

```
Decimal _decimal = item.BaseCost + item.Tax; 
```

相反，建议使用更具描述性的名称，例如“_total”或“_cost”。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-20T13:41:44.453

我发现这种事情的唯一问题是，如果您希望私有成员和公共财产具有相同的名称。

如果这些仅在大小写上有所不同，那么它在区分大小写的语言（如 C#）中可以正常工作，但在 VB.NET 中则不行。

所以，例如，在 VB 中，我会写

```
Private _name As String 
```

但

```
Public Property Name() As String
    Get
        Return _name
    End Get
    Set(ByVal Value As String)
        _name = Value
    End Set
End Property 
```

我会在 C# 中做同样的事情，所以从一个到另一个的翻译是无痛的。它也减少了出错的可能性，因为它很容易被误读，或者实际上是错误类型的单词，只是大小写不同。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-01-20T13:42:37.367

我经常用`Person person = new Person()`自己。常用于 Java/C#。

虽然我昨天最终想知道为什么

```
private enum DataType {NEW, OLD} 
```

在 C# 中不起作用...

尤其是看看如何在 C# 中随意使用`String`, `string`, `Double`, `double`,... 。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-01-20T13:52:32.870

这不是不道德的，但是如果您对变量的最佳名称是类型的名称，则有问题，或者您只是在进行概念证明或类似的事情。对我来说，变量名必须指的是业务上下文中的含义，而不是编程语言。理解代码会更加困难。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-01-20T14:45:03.997

```
Person person = new Person() 
```

在我的书中很好。

当你有以下情况时，它变得可怕：

```
string Person;
string person; 
```

很容易混淆2。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-01-20T15:43:00.027

除了不符合我们的编码标准外，向我表达的内容是避免在其他人阅读我的代码时增加混乱。我个人认为没有问题，只要意思清楚。

至于 CLR 类型（int、string 等），您可以使用 String 或 string（等）来声明类型，所以我会避免使用类似

```
int Int = 0;
string String = "hi there"; 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-01-20T15:45:53.797

使大写成为唯一的区别是危险的……继续为一个大项目这样做，我**保证**你会遇到你似乎无法找到的奇怪错误。

像上面这样的 fastPerson/slowPerson 很好......它们是描述性的，并且与变量类型名称有区别......但是来吧，调用 int “Int” 会很懒惰。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-09-14T07:13:39.220

我会说它绝不是不道德的——它实际上只是你的基线变量名。如果你想不出一个更好的名字，那么在它的类型之后命名是一个很好的默认值。（**仅**适用于复杂类型- 对于内置类型它是*邪恶*的）而且很多时候真的没有更好的名字，因为你没有'对变量一无所知。喜欢这个方法

```
void SaveToDatabase(Person person) {...} 
```

关于你可以合理地称之为人的唯一其他东西是`person_to_save`或类似的东西似乎是多余的。

但是在很多情况下，您可以通过将 person 替换为更具描述性的名称来提高代码的可读性。例如，这描述性较差

```
void AddToAccount(Account account, Person person)  {...} 
```

比这个

```
void AddToAccount(Account account, Person dependent)  {...} 
```

但是请，请 - 请不要在类型名称前加上“a”或“t”。IE aPerson 代表“一个人”或 tPerson 代表“那个人”。它过于复杂，如果有任何价值，也不会增加太多。另外，你开始用一堆以 a 或 t 开头的变量污染你的范围，这可以最小化智能感知的价值。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-01-20T14:31:57.550

我不会说这很可怕。在这种情况下，我通常在变量名称前加上“a”，以表明它是该类型的单个实例，所以我会这样做

```
Person aPerson = new Person(); 
```

我认为它使代码阅读更自然。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2010-07-06T13:00:06.283

根据其他人指出的警告（为了方便起见，在这里总结一下），它绝对没有错：不使用原始类型，如果稍后添加另一个实例，则重构原始实例，不使用 char-case 来区分类名等。

我的经验法则？代码中的语句应该读起来像简单的英语句子。

人人 = 新人（）；

员工员工 = person.getRole(EMPLOYEE);

父父 = person.getRole(PARENT);

人.getFullName();

雇员.getSalary();

parent.getChildren();

父.getFullName(); // 假设装饰器模式在起作用

if (person.hasRole(EMPLOYEE)) {

  ...

}

等等。

如果变量的范围有限（例如，封装方法是 10-15 行），我什至可以使用 'p' 而不是 'person'。尝试在脑海中保留上下文时，较短的变量名称不会分散注意力。避免无缘无故的前缀，例如“a”或（不寒而栗）匈牙利符号及其分支。（请注意，在适当的上下文中使用此类前缀 - C++ / COM / ATL / Win32 API 代码等，它有助于保持分配/类型转换的直接性）。

我的两个（！）位:-)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2010-07-13T19:24:49.973

不仅没问题，而且合理。

微软甚至提出了类似的建议（这可能会让一些人感到惊讶），将属性命名为与其类型相同。我知道这不是一回事，但它可能会打开你的想法。

[http://msdn.microsoft.com/en-us/library/fzcth91k(VS.71).aspx](http://msdn.microsoft.com/en-us/library/fzcth91k(VS.71).aspx)

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2010-12-04T05:09:27.340

不，将其命名为不同的名称也不错，例如

```
Person clerk = new Person();
Person manager = new Person(); 
```

不好的是编造如下无意义的名称：

```
Person xyz = new Person(); 
```

* * *

## 回答 #33

> 赞同：-3
> 
> 时间：2009-01-20T13:14:07.863

不道德...不。比重构更困难，...是的。

试试“_person”

# iphone - 通过互联网从相机流式传输视频

> ID：461235
> 
> 赞同：0
> 
> 时间：2009-01-20T13:09:28.933
> 
> 标签：iphone

我想编写一个应用程序来流式传输从互联网上的摄像机（IP 摄像机）获得的视频内容。通过阅读一些帖子，我怀疑只有 iPhone 的内置摄像头才能进行视频流式传输。我可以访问任何其他相机并从中捕获图像吗？

我可以访问 iPhone 上的其他摄像头并显示实时视频吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T13:47:51.350

> “通过阅读一些帖子，我怀疑只有 iPhone 的内置摄像头可以进行视频流传输。我可以访问任何其他摄像头并从中捕获图像吗？”

从这里我不完全确定你的意思。您是否在问是否可以从 iPhone 上的其他相机拍摄图像？还是您在问是否可以从 iPhone 流式传输实时视频？

因此，在没有真正理解您的要求的情况下，这是我能想到的最佳回应：

*   iPhone 可以流式传输，并且[有可用的服务](http://qik.com/video/100699)。
*   iPhone 可以通过编程方式访问[它出现](http://code.google.com/p/iflickr/source/browse/trunk/bkp/PhotoLibrary.h?r=10)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-02-12T10:04:33.333

查看适用于 iPhone 的 ustream.tv 应用程序。我认为它在应用商店中不可用，但在 cydia 商店中 - 这涉及您的 iPhone 越狱

# c++ - 如何在 C++ 中转换指针

> ID：461236
> 
> 赞同：3
> 
> 时间：2009-01-20T13:10:55.543
> 
> 标签：c++, casting, pointers, types

```
void foo(void **Pointer);

int main ()
{
    int *IntPtr;

    foo(&((void*)IntPtr));
} 
```

为什么我会收到错误消息？

```
error: lvalue required as unary ‘&amp;’ operand 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T13:13:28.253

```
void foo(void **Pointer);

int main ()
{
    int *IntPtr;

    foo((void**)&IntPtr);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-20T13:14:24.883

当你这样做

```
(void*)IntPtr 
```

您创建一个临时变量，它只是一个右值，因此不能取消引用。

你需要做的是：

```
int main()
{
  int* IntPtr;
  void* VoidPtr = (void*)IntPtr;
  foo(&VoidPtr);
} 
```

或同等学历

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-20T13:14:30.390

(void*) 不是左值，它是一种强制转换运算符，您需要在变量 (lvalue) 的紧邻左侧有与号。这应该是对的：

```
foo(((void**)&IntPtr)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T14:30:08.800

更多 C++ 风格：

```
foo( reinterpret_cast< void** >( IntPtr ) ); 
```

但请记住，根据标准，这样的演员表是特定于实现的。标准不保证此类演员的行为。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-21T06:14:21.250

正如其他人指出的那样，你有演员的顺序和`&`错误。但是你为什么要使用`void**`呢？这意味着您接受*指向 void 指针的指针*。但这根本不是你想要的。只需将参数设为 a `void*`，它将接受指向某个对象的任何指针：

```
void foo(void*);

int main () {
    int *IntPtr;
    foo(&IntPtr);
    assert(IntPtr == NULL);
} 
```

这`void*`就是为了。稍后，使用`static_cast`. *与 C 风格的演员表(type)*不同，这是一个非常严格的演员表，不允许危险的变体：

```
void foo(void* p) {
    int** pint = static_cast<int**>(p);
    *pint = NULL;
} 
```

如果函数接受指向 的指针`void*`，则该函数不能接受指向 的指针`int*`。但是，如果函数接受 or ，那么函数应该接受`void*`，并且您应该在函数内部强制转换为正确的类型。也许粘贴您真正想做的事情，我们可以更好地帮助您。C++ 有一些很好的工具可用，包括模板和重载，在这种情况下，这两种工具听起来都很有用。

# xml - 将 XML 命名空间属性添加到第 3 方 xml？

> ID：461251
> 
> 赞同：1
> 
> 时间：2009-01-20T13:14:58.873
> 
> 标签：xml, vb.net, namespaces, linq-to-xml

我正在使用 VB 2008，并且正在尝试将 xmlns="mynamespace" 属性添加到 XDocument 的根元素。

XML 文档由第 3 方创建，我已将其加载到 VB XDocument 对象中。就它而言，它没有命名空间。[我一直在处理本地副本，并在文本编辑器中添加了命名空间，这样我就可以按照MSDN](http://msdn.microsoft.com/en-us/vbasic/bb887653.aspx)的 Beth Massi vids 中的说明使用 VB 中的 XMLToSchema 来启用智能感知等。现在其余的代码工作我想再次打开实时文档。如果没有命名空间，我的 XML 文字将无法解析。

我尝试使用几种方法将 XMLNS 属性添加到根标记中，但未成功，我得到的最接近的是以下三个代码示例。

```
Dim myNS As XNamespace = "urn:nbf:namespacename"
myXML.Element("nameofrootelement").Add(myNS) 
```

^^^^ 命名空间是作为根元素的值添加的，而不是作为属性。

```
XML.Root.Add(New XAttribute("xmlns", "name")) 
```

^^^^ 生成错误：抛出运行时异常：System.Xml.XmlException - 前缀 '' 不能在同一起始元素标记内从 '' 重新定义为 'name'。

但

```
XML.Root.Add(New XAttribute("test", "name")) 
```

^^^^ 工作正常。大概它不喜欢我手动尝试设置保留属性？从我所做的一些谷歌搜索来看，这种命名空间似乎过于复杂。

我该如何解决这个问题？:D

谢谢！

* * *

**更新**

谢谢安东尼。

我想我需要更好地理解命名空间。

我以为。`ToString`它，然后修改，然后。`Parse`它也是，但我想要一个更好的解决方案，这样它可以帮助我更好地理解它！不过，我确实尝试过，正如您正确指出的那样，它也会影响所有后代，因此它仍然会中断。

我将使用由不同第三方生成的多个 XML 提要，我认为为简单起见，我将完全省略命名空间！

我自己的自定义解析函数将第三方提要重写为一个统一的文档，然后由另一个例程处理。我将能够将 ns 添加到 XML 的中间部分，这将有助于编写辅助函数。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T13:29:49.563

您需要了解任何标记的真正全名是 XML 中的标记名（称为本地名称）和命名空间。通过尝试将 xmlns="xxx" 放置到一个元素上，您实际上是在尝试重命名该元素及其所有未明确分配其自己的命名空间的后代。

正如标记名在元素上是只读的一样，该元素的命名空间也是只读的。

也许最简单的解决方案（假设您首先无法让第三方正确生成 XML）是在解析之前将 xmlns 注入到文本中。

# java - 在 Eclipse 中可能发生在 IntelliJ 中不可能的事情？

> ID：461255
> 
> 赞同：60
> 
> 时间：2009-01-20T13:15:58.543
> 
> 标签：java, eclipse, ide, intellij-idea

我从那些发誓其中之一的人那里听说过。两者都是功能齐全的优秀 IDE。但每个人的优势都略有不同。这并不意味着变成一场神圣的 IDE 战争。请对任何火焰诱饵答案投反对票。谢谢。

这是[这个问题](https://stackoverflow.com/questions/239732/things-possible-in-intellij-that-arent-possible-in-eclipse)的类比。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-20T18:34:09.387

IDEA 中我最喜欢的小烦恼（也是 Eclipse 中最喜欢的小功能）是在键入左大括号（例如“{”）或分号时字符的定位。您必须在 Eclipse 中启用它（Window/Preferences/Java/Editor/Typing：“自动在正确的位置插入：分号，大括号”）

有了这个，只需提前输入（“|”是插入符号的位置）

```
while(| 
```

结果（还没有魔法）

```
while(|) 
```

现在输入*true{*，结果

```
while(true) {| 
```

如此简单，却又如此强大。

此外，在（例如）

```
System.out.println("Hello world") 
```

*在该行中的任何位置*使用插入符号，键入分号将自动在行尾键入它。退格更正，就像您最喜欢的文字处理器中通常的自动更正一样。

无价。在第一次尝试时，我物理上不再能够在正确的位置键入分号:)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-01-06T05:20:37.050

即使在不相关的代码中[存在编译器错误](http://james-iry.blogspot.com/2012/01/type-errors-as-warnings.html)， Eclipse 的增量编译器也允许您运行单元测试。IntelliJ 依赖 javac，除非所有代码都有效，否则它不会发出字节码。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-05-18T12:21:39.537

由于新的 Android Studio，我尝试切换到 IntelliJ。但我现在非常失望。我正在使用带有**[Code Recommenders](http://eclipse.org/recommenders/)**插件的 Eclipse。这是一个为什么 Eclipse 如此出色的简单示例：

我想创建一个新的`SimpleTimeZone`. `SimpleTimeZone`没有零参数的构造函数。

Eclipse 中的 Ctrl + 空格

![在此处输入图像描述](https://i.stack.imgur.com/RAmrm.png)

IntelliJ 中的 Ctrl + 空格

![在此处输入图像描述](https://i.stack.imgur.com/HLH3M.png)

在 IntelliJ 中，我没有得到任何构造函数类型的信息`SimpleTimeZone`。

进入 Eclipse 后

![在此处输入图像描述](https://i.stack.imgur.com/Rqj5y.png)

我得到了先前选择的构造函数，其中填充了预定义的变量名称。我可以看到每个参数的类型。使用 Code Recommenders，Eclipse 通过当前范围内先前定义的变量类型猜测正确的构造函数，并用这些 var 填充构造函数。

进入 IntelliJ 后没有任何反应。我得到一个空的构造函数。我必须按 Ctrl + P 才能看到预期的参数。

![在此处输入图像描述](https://i.stack.imgur.com/Ky67Y.png)

或尝试一些简单的事情。类型

```
syso<Ctrl+Space> 
```

蚀：`System.out.println()`

智能：`syso`

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-01-20T15:01:51.983

据我所知，在 IntelliJ 中没有替代 Eclipse 出色的[Mylyn](http://www.eclipse.org/mylyn/)任务插件。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-02-05T15:50:49.610

从 Eclipse 3.3 开始（但可以在使用[插件](http://code.google.com/p/formatonsave/)之前完成），您可以在保存 Java 文件的同时自动执行操作：

*   组织进口
*   格式化源代码
*   其他一些操作（如添加注释、删除不必要的强制转换......）

这可以在*Preferences > Java > Editor > Save actions*中进行配置。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-20T22:02:53.427

Eclipse 平台的开放性使插件编写者社区蓬勃发展。有大量插件可用于各种任务。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-26T00:54:05.097

我最喜欢的 Eclipse 功能：

*   AspectJ 集成，包括方面和代码之间的导航、显示方面应用位置的注释标记、交叉引用视图、显示方面类型的通用打开类型对话框（最近添加）
*   OSGi 工具（又名 PDE）、编辑和优化 OSGI 清单、特定于 OSGi 的重构和声明式服务编辑器（目前正在开发中）

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-02-01T06:56:27.970

我不知道如何在 Intellij 中自动添加 javadoc，而在 Eclipse 中它只是：Shift-Alt-j

我不喜欢 IntelliJ 的事情（来自 Eclipse 开发人员）

*   只需按一下 Tab 键，Tab 键就不会缩进到正确的位置。

*   多项目是第一个......但很多人之前已经介绍过，所以我会离开它。

*   窗户的分割。在 Eclipse 中，您只需将窗口拖到任何您想要的位置，它就会到那里。

*   字体很烂。我改成了我能找到的下一个最好的：Liberation Mono，14 号。（设置>编辑器>颜色和字体>字体）

*   XML 的突出显示是讨厌的......删除了粗体。

*   将编辑器窗口与项目导航器中选择的文件同步。我不能默认做到这一点，我每次都必须按下按钮？？？找到了：

*   在项目导航器中双击有时不会打开文件。有时甚至连三次点击都不会这样做。只需单击四下即可打开它！** 这里有一个答案...只是双击速度太快了：关于IDEA中的双击，双击打开文件很难的原因是Java程序例如IDEA读取了双击来自 X11 资源的速度。如果未明确设置，则默认为 200 毫秒，速度快如闪电。为了获得更合理的阈值，请创建 ~/.Xresources 并添加： *.multiClickSpeed: 400

*   无法弄清楚如何获得建议：Ctrl-1 在 Eclipse 中给出的“将语句分配给局部变量”。我一直在使用它。

** 是的！这是引入变量重构。默认情况下，选择一些文本，然后按 Ctrl + Alt + V。如果表达式不完整或无效，IntelliJ 仍会很好地猜测您的意思并尝试为您修复它。

*   制表符不会立即纠正位置。

*   无法正确自动完成 ** Ctrl-Shift-Space 帮助...

*   热代码重新运行。在 Eclipse 中，我可以在调试器中修改一个方法，并重新加载框架。** 右击：丢帧

*   双击变量以突出显示它，不会突出显示该变量的其他出现。

*   不推荐使用的方法不会被划掉。

*   可以在设置菜单中正确搜索。它过滤掉的只是顶级名称，而不是菜单本身内的所有字符串。找不到在哪里设置我的jdk！

*   不会即时编译，只有当我点击“调试”时它才会编译。

*   没有“右键单击类并选择新建> JUnit”功能。

*   调试时，窗口出现在底部，无法移动到我想要的位置。** 将折叠的小图标拖动到您希望它弹出的任何一侧。

我喜欢的事情：

*   粘贴历史很好：

Ctrl-Shift-V

*   只需单击调试/运行图标实际上会运行最后一个配置，eclipse 并不那么聪明（或者它太聪明？？？），我不喜欢它的方式。

*   自动完成非常好。

*   只需单击一次即可添加断点

*   代码折叠/扩展似乎更好。

*   Ctrl-Shift--（减号）折叠/折叠所有。

*   “列模式”可以打开它“编辑 - 列模式”或使用 alt + shift + insert

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-20T14:19:30.757

只有 eclipse 允许您在调试器中单步执行 ant 构建。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-20T18:04:38.073

Idea 没有[drools](http://jboss.org/drools/)插件，外部编辑器（如excel）很难集成。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-21T13:32:46.607

在eclipse中你可以最大化编辑器，在IntelliJ中你可以点击escape，这是类似的功能。但是在eclipse中你可以恢复。IntelliJ 中没有等效的“未最大化”，这更令人沮丧。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-20T15:13:44.377

我发现（同时使用两者）最大的烦恼是在 Eclipse 中我可以创建 Ant Launch 任务。这些任务允许我使用不同的属性/参数集在同一个构建文件中运行相同的 ant 任务，而无需每次都进行编辑。

在 IDEA 中，属性是在整个构建文件中设置的。因此，您不仅不能在不编辑的情况下运行具有不同属性的相同 ant 任务，而且您不能运行具有不同属性的不同 ant 任务，除非它们位于不同的构建文件中。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-10-21T10:33:00.103

我在博客中总结了我[对 Eclipse 3.6 和 IntelliJ 10.5 的比较（与 Eclipse 相比，](http://theholyjava.wordpress.com/2011/10/18/comparison-of-eclipse-3-6-and-intellij-idea-10-5-pros-and-cons/)我更关注我在 II 中喜欢或错过的地方）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-11-10T10:12:06.120

总的来说，我在这两个 IDE 中都有很好的工作经验，所以两者都有很多好的特性。在 IDEA 9_0_3 中，我在使用 SVN 时遇到了一个奇怪的问题。我可以在存储库视图中看到更改的历史记录，但它没有显示任何令人沮丧的传入更改。另一种方法是更新带来最新但没有任何选择的目录..它得到了所有

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-20T13:22:38.047

一个有效的颠覆集成，看看[想法颠覆插件的错误](http://www.jetbrains.net/jira/browse/IDEA/component/10721)。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-01-20T21:53:04.087

在 Eclipse 中，创建一个 10x10 的编辑区域（ cols/row ）并同时查看所有其他窗口可能会让人烦恼。

在 IntelliJ 中这是不可能的，因为 'ESC' 键会将它们全部关闭。

*好的，好的，对不起，我必须这样做，现在就开枪打我*

# java - 尝试增加 jvm 内存时，您可以将 Xmx 设置为最大数量吗？

> ID：461260
> 
> 赞同：47
> 
> 时间：2009-01-20T13:17:36.827
> 
> 标签：java, eclipse, jvm

有最大值吗？您可以将 Xmx 设置为的大小？我将它设置为 1024m 并且 Eclipse 可以正常打开。当我将其设置为 1024 以上时，eclipse 无法打开，并且出现错误“jvm 已终止。退出代码=-1”...

我这样做是因为我不断收到“java.lang.OutOfMemoryError：Java 堆空间”。我正在读取一个 35.5Mb 的 .txt 文件，当它只是使用“ `while((line = reader.readLine()) != null)`”循环读取文件时会发生此错误。我原以为1024mb就足够了。谁能帮我？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-20T13:35:14.247

是的，有一个最大值，但它取决于系统。试试看，加倍直到达到极限，然后向下搜索。至少对于 Linux 上的 Sun JRE 1.6，如果不总是提供信息丰富的错误消息，您会得到有趣的信息（peregrino 是运行 32 位 ubuntu 的上网本，具有 2G RAM 并且没有交换）：

```
peregrino:$ java -Xmx4096M -cp bin WheelPrimes 
Invalid maximum heap size: -Xmx4096M
The specified size exceeds the maximum representable size.
Could not create the Java virtual machine.

peregrino:$ java -Xmx4095M -cp bin WheelPrimes 
Error occurred during initialization of VM
Incompatible minimum and maximum heap sizes specified

peregrino:$ java -Xmx4092M -cp bin WheelPrimes 
Error occurred during initialization of VM
The size of the object heap + VM data exceeds the maximum representable size

peregrino:$ java -Xmx4000M -cp bin WheelPrimes 
Error occurred during initialization of VM
Could not reserve enough space for object heap
Could not create the Java virtual machine.

(experiment reducing from 4000M until)

peregrino:$ java -Xmx2686M -cp bin WheelPrimes 
(normal execution) 
```

大多数都是不言自明的，除了 -Xmx4095M 这很奇怪（可能是有符号/无符号比较？），并且它声称在没有交换的 2GB 机器上保留 2686M。但它确实暗示了 32 位 VM 的最大大小是 4G 而不是 2G，如果操作系统允许您处理那么多的话。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T13:27:26.180

我认为 32 位 JVM 最多有 2GB 内存。不过这可能已经过时了。如果我理解正确，您可以在 Eclipse 启动器上设置 -Xmx。如果您想增加从 Eclipse 运行的程序的内存，您应该在“运行->运行配置...”中定义 -Xmx（选择您的类并打开“参数”选项卡，将其放在 VM 参数区域）菜单, 而不是在 Eclipse 启动时

编辑：您要求的详细信息。在 Eclipse 3.4 中

1.  运行->运行配置...

2.  如果你的类没有在“Java Application”子树左侧的列表中列出，点击左上角的“New Launch configuration”

3.  在右侧，“Main”选项卡确保项目和类是正确的

4.  选择右侧的“参数”选项卡。这个有两个文本区域。一个是用于进入提供给您的 main 方法的 args[] 数组的程序参数。另一个用于 VM 参数。将以下内容放入带有VM参数（较低的一个iirc）的那个：
    -Xmx2048m

    我认为 1024m 应该足以满足您的需求！

5.  单击应用，然后单击运行

6.  应该管用 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-19T21:43:22.770

我认为它大约是2GB。虽然 Pete Kirkham 的回答非常有趣并且可能是正确的，但我已经毫无错误地分配了 3GB 以上的空间，但实际上它并没有使用 3GB。这或许可以解释为什么您能够在没有交换空间的情况下在 2GB RAM 上分配 2.5GB。实际上，它没有使用 2.5GB。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T13:27:56.540

看看[这个](http://javahowto.blogspot.com/2006/06/6-common-errors-in-setting-java-heap.html)关于设置 java 堆的一些常见错误。您可能已将堆大小设置为大于计算机物理内存的值。

您应该通过增加堆大小来避免解决此问题。相反，您应该分析您的应用程序以查看您在哪里花费了如此大量的内存。

# c# - 如何以编程方式将附加行插入 ASP.NET DataGrid？

> ID：461281
> 
> 赞同：0
> 
> 时间：2009-01-20T13:26:34.840
> 
> 标签：c#, asp.net, datagrid

我想以编程方式将其他行插入 DataGrid（作为子标题）。我在网上关注了许多文章（即来自[http://aspalliance.com/723](http://aspalliance.com/723)的选项 3 ），但它们都导致该行正确显示，但没有内容。

这是我正在使用的代码的重要部分：

```
private void MyDataGrid_ItemCreated(object sender, DataGridItemEventArgs e)
{

    // This method will create a subheading row if needed
    if (e.Item.ItemType == ListItemType.AlternatingItem || e.Item.ItemType == ListItemType.Item)
    {
        // TableCell
        TableCell tc = new TableCell();
        tc.Controls.Add(new LiteralControl("foo"));
        tc.ColumnSpan = e.Item.Cells.Count;

        // DataGridItem
        DataGridItem di = new DataGridItem(e.Item.ItemIndex + 1, 0, ListItemType.Item);
        di.Height = new Unit(100, UnitType.Pixel);
        di.CssClass = "testClass";
        di.Controls.Add(tc);

        // DataGrid Table
        DataGrid dg = (DataGrid)sender;
        Table childTable = (Table)dg.Controls[0];
        childTable.Rows.Add(di);
    }      

} 
```

这会导致在正确的位置生成以下标记，但没有 LiteralControl("foo")

```
<tr class="testClass" style="height:100px;">
</tr> 
```

我想使用这种方法而不是操纵数据源本身。可能出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T14:22:22.793

问题解决了——在现有代码隐藏的 2500 行中的某处，隐藏了第一列，有效地删除了我的添加。如果其他人有类似的问题需要注意。

编辑 - 这是我编写的以合理通用的方式解决问题的代码：

```
private void InsertDataGridRow(DataGrid dataGrid, int index, TableCell tc)
{
    DataGridItem di = new DataGridItem(index, 0, ListItemType.Item);

    // Check which columns are visible
    bool foundFirstVisibleColumn = false;
    int numberOfVisibleColumns = 0;
    foreach (DataGridColumn column in dataGrid.Columns)
    {
        if (column.Visible == true)
        {
            numberOfVisibleColumns++;
            foundFirstVisibleColumn = true;
        }

        // Add dummy columns in the columns that are hidden
        if (!foundFirstVisibleColumn)
        {
            di.Cells.Add(new TableCell());
        }

    }

    tc.ColumnSpan = numberOfVisibleColumns;
    di.Cells.Add(tc);
    Table t = (Table)dataGrid.Controls[0];
    t.Rows.Add(di);
} 
```

上面可以这样称呼：

```
private void MyDataGrid_ItemCreated(object sender, DataGridItemEventArgs e)
{
    // This method will create a subheading row if needed
    if (e.Item.ItemType == ListItemType.AlternatingItem || e.Item.ItemType == ListItemType.Item)
    {
        TableCell tc = new TableCell();
        tc.Controls.Add(new LiteralControl("foo"));

        InsertDataGridRow(
            (DataGrid)sender,
            e.Item.ItemIndex + 1,
            tc);
    }      

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:23:51.513

我刚刚使用您发布的代码尝试了一个孤立的示例，它工作得很好。它必须与 DataGrid 的配置或代码中的其他地方有关。

# http - 我可以使用 HTTP 传输的最大文件大小是多少？并使用 FTP？

> ID：461282
> 
> 赞同：25
> 
> 时间：2009-01-20T13:26:59.350
> 
> 标签：http, ftp, file-transfer

**补充**：我正在研究一个我们将在我的工作中开发的新系统。它包括对用户进行身份验证，显示他们想要下载的文件并下载它们。此外，如果文件不可用，则用户无法下载它们，但服务器会获取所请求文件的副本，并在用户可以获取文件时通过邮件通知用户。目前，我们预计文件的大小通常为 2 到 50 GB。

我只是想检查是否可以编写一个 Web 应用程序来解决这个问题，或者我们是否需要制作一个客户端-服务器解决方案。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-20T13:27:52.670

没有最大值。您遇到的任何最大值都是特定于应用程序或特定于站点的。

我已经使用 HTTP 和 FTP 从 Microsoft 下载了 DVD iso，没有问题（~4gb）。

我还通过这两种方法上传了大文件。

你能详细说明你想做什么吗？

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-20T15:15:32.187

正如已经回答的那样，该协议没有限制，但大多数 HTTP*服务器*都有开箱即用的默认上传限制：

[IIS6在](http://support.microsoft.com/kb/327659)[metabase.xml](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/a0ea8e51-fb2a-4e80-9d5a-7fe3ae246570.mspx?mfr=true)中使用[MaxRequestEntityAllowed](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/468d6cea-04cd-4b10-b1e1-c17b9e909d07.mspx?mfr=true)（默认为 4GB）和[AspMaxRequestEntityAllowed](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/a6401b5e-c902-4035-90aa-ee46c270d357.mspx?mfr=true)（默认为 200000 字节）。

IIS7 使用[maxRequestEntityAllowed](http://forums.iis.net/t/1130837.aspx)： **appcmd set config /section:asp /maxRequestEntityAllowed:***int* （默认为 200000 字节）

Apache 使用[LimitRequestBody](http://httpd.apache.org/docs/1.3/mod/core.html#limitrequestbody)（默认为 2GB）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T13:38:47.127

您所说的协议中没有这种设计限制。仅在具体服务器上超时

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T13:35:19.723

HTTP 中的上传通常受到限制，因为服务器必须等到（通常很慢）上传完成才能响应请求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T13:53:41.573

还有一个重要的问题——你要上传还是下载？

我可以说下载的限制比上传要少得多。我不知道为什么。也许是因为 HTTP 和 FTP 的主要目的是发送数据，而不是接收。

这就是为什么 HTTP/FTP 服务器可以更频繁地中断上传会话而不是下载会话的原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-07T09:38:57.180

由于传输的大小可能会在开头附近说明，我敢打赌您的文件大小限制与无符号整数的限制相同。从 HTTP 和 FTP 变得流行和有用的时间段来看，我会说这是一个 32 位无符号整数，所以**2^32 Bytes 或 4.0 GiB**。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-09T18:22:53.623

对于 TCP 协议，您有从 0 到 2^32-1 的序列号。假设最坏的情况是您将每个字节的序列增加 1。现在最大文件大小为 4GB。你有一个 1GBps 的连接。所有序列在 4 秒内完成，这是环绕时间。如果 TTL 大于环绕时间，则我们无法重用序列，因此最大文件大小为 4GB。

但是魔术在 TCP 选项中，在选项中我们可以添加时间戳。现在问题解决了，即使我们得到相同的源和相同的目标相同的序列号，但我们有不同的时间戳来识别。

# windows - WP_FRAMELEFT 主题部分用于什么？

> ID：461285
> 
> 赞同：0
> 
> 时间：2009-01-20T13:27:48.460
> 
> 标签：windows, themes

有人知道主题部分`WP_FRAMELEFT`等`WP_SMALLFRAMERIGHT`是用来做什么的吗？谷歌没有提供任何有用的东西。我用[Windows XP 主题资源管理器](http://www.soft-gems.net/)查看了它们，它们看起来像停靠面板的标题。

编辑：我忘了提到我还搜索了 MSDN 并且只得到了一个结果（[Parts 和 States](http://msdn.microsoft.com/en-us/library/bb773210(VS.85).aspx)），这对各种常量的含义并不完全冗长（并宣布自己是初步的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T14:05:44.357

它们在 vsstyle.h 中定义为 WINDOWPARTS 枚举的一部分，该枚举也被定义为 WINDOWSTYLEPARTS。据我所知，这些似乎都没有在 Platform SDK 的其他任何地方引用。我猜它们是从未完成或部分删除的功能的残余。vsstyle.h 将自己描述为定义“VisualStyle 样式指南符号”。

# c# - 如何在 c#/.net 中记录抛出的异常

> ID：461306
> 
> 赞同：150
> 
> 时间：2009-01-20T13:39:28.310
> 
> 标签：c#, .net, documentation, intellisense

我目前正在编写一个小型框架，公司内部其他开发人员将在内部使用该框架。

我想提供良好的 Intellisense 信息，但我不确定*如何*记录抛出的异常。

在以下示例中：

```
public void MyMethod1()
{
    MyMethod2();

    // also may throw InvalidOperationException
}

public void MyMethod2()
{
    System.IO.File.Open(somepath...); // this may throw FileNotFoundException

    // also may throw DivideByZeroException
} 
```

我知道记录异常的标记是：

```
/// <exception cref="SomeException">when things go wrong.</exception> 
```

我不明白的是如何记录由**调用的** `MyMethod1()`代码引发的异常？

*   我应该记录抛出的异常吗`MyMethod2()`
*   我应该记录抛出的异常`File.Open()`吗？

记录可能的例外情况的最佳方式是什么？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-01-20T13:51:29.567

您应该记录您的代码可能引发的每个异常，包括您可能调用的任何方法中的异常。

如果列表有点大，您可能想要创建自己的异常类型。捕获您在方法中可能遇到的所有问题，将它们包装在您的异常中，然后抛出它。

另一个你可能想要这样做的地方是，如果你的方法是在你的 API 上。就像外观将多个接口简化为单个接口一样，您的 API 应该将多个异常简化为单个异常。使调用者更容易使用您的代码。

* * *

为了回答 Andrew 的一些担忧（来自评论），有三种类型的例外：您不知道的例外、您知道但无能为力的例外，以及您知道但可以做某事的例外。

那些你不知道的你想放手。它的原则是快速失败 - 最好让您的应用程序崩溃而不是进入可能最终破坏数据的状态。崩溃会告诉你发生了什么以及为什么，这可能有助于将该异常从“你不知道的”列表中移出。

您知道但无能为力的是 OutOfMemoryExceptions 之类的异常。在极端情况下，您可能希望处理这样的异常，但除非您有一些非常显着的要求，否则您将它们视为第一类——让他们去吧。您是否*必须*记录这些例外情况？在新建对象的每个方法上记录 OOM 看起来很愚蠢。

你知道并且可以做一些事情的是你应该记录和包装的那些。

[您可以在此处找到有关异常处理的](http://msdn.microsoft.com/en-us/library/ms229014.aspx)更多指南。

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2009-01-20T13:46:28.263

您应该使用[标准的 xml 文档](http://msdn.microsoft.com/en-us/library/5ast78ax(VS.80).aspx)。

```
/// <exception cref="InvalidOperationException">Why it's thrown.</exception>
/// <exception cref="FileNotFoundException">Why it's thrown.</exception>
/// <exception cref="DivideByZeroException">Why it's thrown.</exception>
public void MyMethod1()
{
    MyMethod2();
    // ... other stuff here
}

/// <exception cref="FileNotFoundException">Why it's thrown.</exception>
/// <exception cref="DivideByZeroException">Why it's thrown.</exception>
public void MyMethod2()
{
    System.IO.File.Open(somepath...);
}

/// <exception cref="FileNotFoundException">Why it's thrown.</exception>
public void MyMethod3()
{
    try
    {
        MyMethod2();
    }
    catch (DivideByZeroException ex)
    {
        Trace.Warning("We tried to divide by zero, but we can continue.");
    }
} 
```

这样做的价值在于您提供了可能发生的已知异常的文档。如果您使用的是 Visual Studio，则此文档在智能感知中可用，并且可以稍后提醒您（或其他人）您可以预期的异常。

您要指定具体的异常类型，因为您可能能够处理一种类型的异常，而其他类型是严重问题的结果，无法纠正。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-01-20T14:28:11.550

您可以通过使用几个很棒的插件来简化您的文档过程。其中之一是[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)，它是 Visual Studio 的免费插件，可生成 XML-doc 注释。此外，如果您使用[ReSharper](http://www.jetbrains.com/resharper/)，请查看适用于 ReSharper 的出色[Agent Johnson 插件](http://code.google.com/p/agentjohnsonplugin/)，它添加了一个选项来为抛出的异常生成 XML 注释。

**更新：**似乎 Agen Johnson 不适用于 R# 8，请查看[Exceptional for ReSharper](http://exceptional.codeplex.com)作为替代方案......

> 第 1 步：GhostDoc 生成 XML 注释 (Ctrl-Shift-D)，而 ReSharper 的 Agent Johnson 插件也建议记录异常：

[![第1步](https://i.stack.imgur.com/9oxz6.png)](https://i.stack.imgur.com/9oxz6.png)

> 第 2 步：使用 ReSharper 的快捷键 (Alt-Enter) 来添加异常文档：

[第 2 步 http://i41.tinypic.com/osdhm](http://i41.tinypic.com/osdhm)

希望有帮助:)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-20T13:44:49.500

据我了解，使用 <exception> 元素的目的是在装饰方法时使用它，而不是异常：

```
/// <summary>Does something!</summary>
/// <exception cref="DidNothingException">Thrown if nothing is actually done.</exception>
public void DoSomething()
{
// There be logic here
} 
```

应该在这些方法中捕获、处理和记录可以被其他调用方法抛出的异常。应该记录可能由 .NET 引发的异常，或由您自己的代码*显式引发的异常。*

至于比这更具体，也许您可​​以捕获并抛出您自己的自定义异常？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-20T14:10:29.323

您的方法的部分合同应该是检查先决条件是否有效，因此：

```
public void MyMethod2()
{
    System.IO.File.Open(somepath...); // this may throw FileNotFoundException
} 
```

变成

```
/// <exception cref="FileNotFoundException">Thrown when somepath isn't a real file.</exception>
public void MyMethod2()
{
    FileInfo fi = new FileInfo( somepath );
    if( !fi.Exists )
    {
        throw new FileNotFoundException("somepath doesn't exists")
    }
    // Maybe go on to check you have permissions to read from it.

    System.IO.File.Open(somepath...); // this may still throw FileNotFoundException though
} 
```

使用这种方法，可以更轻松地记录您显式抛出的所有异常，而不必同时记录`OutOfMemoryException` *可能*抛出的 a 等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T13:43:51.390

您应该记录您的方法可能引发的所有异常。

为了隐藏实现细节，我会尝试自己处理 MyMethod2 的一些异常。

如果您无法处理或解决异常，您可以考虑追溯它们。主要打包/包装在调用者更有意义的异常中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T09:29:44.317

事实上，正如已经回答的那样，记录异常的方法是使用 XML 注释。

除了插件之外，您还可以使用可与 TFS 集成的静态分析工具，以确保记录异常。

在下面的链接中，您可以看到如何为 StyleCop 构建自定义规则，以验证您的方法引发的异常是否被记录在案。

[http://www.josefcobonnin.com/post/2009/01/11/Xml-Documentation-Comments-Exceptions-I.aspx](http://www.josefcobonnin.com/post/2009/01/11/Xml-Documentation-Comments-Exceptions-I.aspx) [http://www.josefcobonnin.com/post/2009/01/15/Xml-Documentation -Comments-Exceptions-II.aspx](http://www.josefcobonnin.com/post/2009/01/15/Xml-Documentation-Comments-Exceptions-II.aspx)

问候。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T13:44:18.050

在您的方法中记录预期的异常，在您的示例中，我会让用户知道该方法可以抛出未找到文件的异常。

请记住，这是为了通知调用者会发生什么，以便他们可以选择如何处理它。

# usability - 您的组织如何处理可用性？

> ID：461307
> 
> 赞同：3
> 
> 时间：2009-01-20T13:40:57.653
> 
> 标签：usability

我有一个好朋友（实际上是我以前的大学室友），他每隔一段时间就会批评我的个人项目。他是一家大型银行的可用性工程师，我经常对他捕捉到/提出的建议类型感到惊讶。在我上大学的时候，我一直都知道可用性在某种程度上很重要，但我并没有那么在意。这些天来，我开始意识到一个好的可用性专家是物超所值的。

我的问题有两个部分：

1.  您的组织是否有一个致力于可用性的团队？如果是这样，它们如何适应您的开发过程？
2.  你能为那些在自己开发 UI 时无法访问可用性专家的软件工程师推荐任何可用性“检查表”吗？我搜索了这个主题并找到了一些指南，但它们很长。我正在寻找一些小的东西，我可以将其粘贴到钉板上并参考，而无需浏览在线书籍。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T13:47:29.590

首先——恭喜！您已经意识到很少有项目负责人意识到——可用性是软件极其重要的一个方面。如果人们*不想*使用您的软件，或者不知道如何使用它，那么它的所有技术实力都毫无意义。如果他们不*喜欢*你的软件，他们会在它可用时跳到下一个最好的东西。

在我的组织中，我们从拥有专门的可用性专家转变为对我们的工程师的可用性非常积极主动。拥有具有可用性意识的领导者会有所帮助，即使他不是正式的 UI 人员。

我问了一个与您类似的问题，**[开发人员易于理解的 UI 技巧](https://stackoverflow.com/questions/284906/easily-digestible-ui-tips-for-developers)**。那里的答案可能是您正在寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:24:37.703

这与我不久前提出的问题几乎相同： [https ://stackoverflow.com/questions/184073/how-important-is-usability-to-your-workplace-employer](https://stackoverflow.com/questions/184073/how-important-is-usability-to-your-workplace-employer)

我在公司的研究团队，团队中有两个人是可用性分析师。该公司最近为他们创建了一个可用性测试实验室来满足和进行可用性测试。这给我留下了深刻的印象，因为他们把不怎么使用的建筑物的一部分拿走了，盖了一些墙，买了一些家具。整个事情一定花了一点钱。我与可用性团队没有太多的互动，所以我不知道他们在做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T13:46:59.417

在我工作过的那些组织（也包括银行）中，没有这样的职位。测试人员和测试用户习惯于获得一些关于可用性的反馈。最好的方法当然是在超过 5 分钟的时间内使用您自己的程序。这将向您展示一些明显的缺点 - 例如糟糕的菜单结构、缺少/冲突的键盘快捷键、排序/过滤数据的能力、记住用户设置等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T13:48:45.703

我们并没有真正的可用性团队……（这可能就是为什么我们的软件不如它本来可以使用的原因）。我通常会借此机会与几个最终用户进行走廊测试，因为我们缺乏团队资源......

它也有助于吃你自己的狗粮（尽可能多地在你的工作中实际做）......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T14:12:34.000

几年前，我的一位同事为一家大型零售商工作，在阅读了 Steven Krug 的“不要让我思考”（[http://www.amazon.co.uk/Dont-Make-Me-Think-Usability /dp/0321344758/ref=sr_1_1?ie=UTF8&s=books&qid=1232460515&sr=8-1](http://www.amazon.co.uk/Dont-Make-Me-Think-Usability/dp/0321344758/ref=sr_1_1?ie=UTF8&s=books&qid=1232460515&sr=8-1) )，决定尝试为自己打造一个新的角色，作为公司的可用性顾问。
相反，他被裁掉了。

我的观点是，有时推动正式的可用性流程/团队有时会让你不受欢迎（取决于组织），但如果你只是让你的应用程序可用，那么人们就会喜欢它们。

# sql-server - SQLServer 中是否默认允许事务？

> ID：461310
> 
> 赞同：0
> 
> 时间：2009-01-20T13:41:54.077
> 
> 标签：sql-server, sql-server-2005, transactions

我需要使用 DbTransactions（在单个数据库上），但我不确定如何确保它在部署到生产环境时继续工作。

应用程序能够使用 SQL DbTransactions 的要求是什么？SQLServer 中是否默认允许它们（以及与 MSDTC 有什么关系）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T13:45:05.397

是的，交易是默认启用的——我不认为这是你可以禁用的。每次运行查询时，它都可能作为自动提交、隐式事务运行，除非另有说明。

如果您运行分布式事务，MSDTC 就会发挥作用。如果可以的话，我会避免它。*可以*禁用该方面。如果这就是您正在使用的，那么您需要确保它已在目标系统上进行配置。

只需将 DBTransaction 对象用于存储过程中的简单、连续查询或事务就不需要 MSDTC。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T14:08:45.333

除了迈克尔所说的，

有显式和隐式事务，如果你不启动一个事务显式 SQL Server 会为你启动一个隐式事务，这个是必须的使它成为 ACID（原子性，一致性，隔离性，持久性）

# protocol-buffers - 您会推荐 Google Protocol Buffers 或 Caucho Hessian 用于跨语言的无线二进制格式吗？

> ID：461319
> 
> 赞同：9
> 
> 时间：2009-01-20T13:44:35.337
> 
> 标签：protocol-buffers, thrift, hessian, caucho

您会推荐 Google Protocol Buffers 或 Caucho Hessian 用于跨语言的无线二进制格式吗？或者其他什么，例如 Facebook Thrift？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-06-26T11:20:57.340

我们使用 Caucho Hessian 是因为集成成本降低且简单。它的性能非常好，因此非常适合大多数情况。

对于一些跨语言集成不那么重要的应用程序，有一个更快的库可以压缩更多的性能，称为[Kryo](http://code.google.com/p/kryo/)。不幸的是，它并没有被广泛使用，而且它的协议不像 Hessian 的协议那样准标准。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T01:22:44.677

取决于用例。PB 更紧密耦合，最好在内部与紧密耦合的系统一起使用；不适合共享/公共接口（如在超过 2 个特定系统之间共享）。Hessian 更具自我描述性，在 Java 上有很好的性能。在我的测试中比 PB 好，但我确信这取决于用例。PB 似乎对文本数据有问题，也许它已经针对整数数据进行了优化。

我认为两者都不是特别适合公共接口，但考虑到您想要二进制格式，这可能不是一个大问题。

[编辑：根据jvm-serializers](https://github.com/eishay/jvm-serializers/wiki)基准，Hessian 的性能实际上并不那么好。只要您确保添加强制在 Java 上使用快速选项的标志，PB 就非常快。如果 PB 不适合公共接口，那又是什么呢？IMO，像 JSON 这样的开放格式在外部是优越的，而且通常速度不够快，性能并不重要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-07-22T01:39:42.543

对我来说，Caucho Hessian 是最好的。

上手非常容易，性能也不错。我在本地测试过，潜伏期约为 3 毫秒，在局域网上你可以预期约 10 毫秒。

使用 hessian，您不必编写另一个文件来定义模型（我们使用 java + java）。它节省了大量的开发和维护时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-18T11:27:28.417

如果您需要支持从多种语言/平台互连应用程序，那么 Hessian 是最好的。如果您只使用 Java，则比 Kryo 更快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T13:42:26.243

我自己正在研究这个.. 到目前为止没有好的结论，但我发现[http://dewpoint.snagdata.com/2008/10/21/google-protocol-buffers/](http://dewpoint.snagdata.com/2008/10/21/google-protocol-buffers/)总结了所有选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T19:57:14.053

[Muscle](https://public.msli.com/lcs/muscle/index.html) has a binary message transport. Sorry that I can't comment on the others as I haven't tried them.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-24T23:06:32.767

我试过谷歌协议缓冲区。它适用于 C++/MFC、C#、PHP 和更多语言（请参阅：[http](http://code.google.com/p/protobuf/wiki/ThirdPartyAddOns) ://code.google.com/p/protobuf/wiki/ThirdPartyAddOns ），并且无论传输和磁盘保存/加载如何，它都能很好地工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-13T10:50:24.477

我会说 ProtocolBuffers、Thrift 或 Hessian 就其二进制格式而言非常相似——它们提供跨语言序列化支持。固有的序列化可能在它们之间有一些小的性能差异（大小/空间权衡），但这不是最重要的事情。ProtocolBuffers 无疑是一种性能良好的 IDL 定义格式，它具有使其具有吸引力的可扩展性特性。

但是，在问题中使用“在线”意味着使用通信库。这里谷歌提供了protobuf RPC的接口定义，相当于制定了一个规范，所有的实现细节都留给实现者。这是不幸的，因为这意味着事实上没有跨语言实现 - 除非您可以找到此处可能提到的跨语言实现[http://code.google.com/p/protobuf/wiki/ThirdPartyAddOns](http://code.google.com/p/protobuf/wiki/ThirdPartyAddOns)。我见过一些支持 java 和 c，或 c 和 c++，或 python 和 c 等的 RPC 实现，但在这里你只需要找到一个满足你具体要求的库并进行评估，否则你可能会感到失望。（至少我对编写 protobuf-rpc-pro 感到失望）

Kyro 是一种类似 protobuf 的序列化格式，但仅限于 java。Kyro/Net 是一个使用 Kryo 消息的纯 Java RPC 实现。因此，对于“跨语言”通信来说，这不是一个好的选择。

[今天，ICE http://www.zeroc.com/](http://www.zeroc.com/)和提供开箱即用的 RPC 实现的 Thrift似乎是目前最好的跨语言 RPC 实现。

# javascript - 如何最好地传递几乎总是相同的可选函数参数

> ID：461324
> 
> 赞同：2
> 
> 时间：2009-01-20T13:46:06.690
> 
> 标签：javascript, function

传递几乎总是相同的可选参数的最佳方法是什么？例如 Javascript 的 parseInt 函数；radix 的第二个参数是可选的，但为了避免以零开头的字符串被视为八进制，通常公认的良好做法是始终指定 10 作为第二个参数。很公平，所以我想知道如何最好地处理这种情况；具体来说，我是否应该创建一个仅返回 parseInt(str, 10) 的便捷函数，例如 parseBaseTenInt(str)？我继承了一个代码文件，其中对 parseInt 进行了大约 10 次调用，而没有第二个参数，并且创建便利函数随后将允许我用 parseBaseTenInt 进行简单的 parseInt 替换。但是我可以想到便利功能的缺点，特别是它没有被其他开发人员使用。因为它现在只有一个文件，而且我将主要开发人员继续前进，所以将第二个参数添加到所有 parseInt 函数调用不会太不方便。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T13:53:18.703

我会选择您的解决方案-将其包装在一个适当命名的函数中，使其行为/调用约定与库函数保持一致，并使用包装函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T13:55:57.857

如果传递的值为空，我们会使用很多应用默认值的函数。

```
// base defaults to 10
function ParseInteger(str,base)
{
    if(base==null)
        base=10;
    return parseInt(str,base);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T13:55:59.167

您可以使用函数内部检查传递了多少参数`arguments.length`。
或者，您可以使用`||`运算符为每个变量设置默认值：

```
function foo(bar, baz) {
    bar = bar || "default";
    baz = baz || 0;
    return bar + ", " + baz;
}
foo();                 // "default, 0"
foo("some string");    // "some string, 0"
foo("some string", 1); // "some string, 1" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T13:54:34.723

根据您可能希望[引入参数对象](http://books.google.com/books?id=1MsETFPD3I0C&pg=PA295&lpg=PA295&dq=Introduce+parameter+object&source=bl&ots=pKO0o2YJ7e&sig=34mQHO8J_fNBiKRudydeXV6SiwI&hl=en&sa=X&oi=book_result&resnum=8&ct=result#PPA295,M1)以及您的便利功能的参数数量。然后你可以为你的参数对象设置默认值，并且只设置在你使用函数时变化的属性。

# c - 如何在 linux 上创建自定义文件描述符

> ID：461335
> 
> 赞同：3
> 
> 时间：2009-01-20T13:48:36.437
> 
> 标签：c, linux, file, file-descriptor

我想创建一个文件，其描述符将具有一些可自定义的行为。特别是，我想创建一个文件描述符，当写入该文件描述符时，它将在每一行前面加上进程名称和 pid（也许还有时间），但我可以想象它对做其他事情会很有用。

我不想更改编写程序 - 一方面，我希望它适用于我系统上的所有程序，甚至是 shell/perl/等。脚本，如果不是不可能更改所有内容的源代码，那将是不切实际的。

请注意，在这种情况下管道不会这样做，因为当写入进程`fork()`s 时，新创建的子进程共享 fd 并且通过管道的读取端无法区分其父进程。

有一些方法可以做到，但我认为它们相当笨拙：

1.  创建一个将创建此类 fd 的内核模块。例如，您可以打开一些`/dev/customfd`然后指示模块进行一些转换等或将数据发送到用户空间或套接字等。
2.  使用 LD_PRELOAD 将覆盖 fd 操作函数并在“特殊”fd 上执行此类操作。

但是，这两种方法都非常费力，所以我想知道是否有更好的方法，或者任何可以提供帮助的基础设施（如现成的库）。

我更喜欢不涉及内核更改的解决方案，但如有必要，我已准备好接受它们。

只是一个想法：FUSE 会是一个答案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T14:42:55.157

您有很多选择，正如您提到的，使用包装 write()/read() 函数的 LD_PRELOAD 是一个好方法。

我建议您使用 unix ptrace(2) 来捕获所需的系统调用并将参数传递给您自己的函数。

例子 ：

```
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <unistd.h>
#include <linux/user.h>
#include <sys/syscall.h>   /* For SYS_write etc */
int main()
{   pid_t child;
    long orig_eax, eax;
    long params[3];
    int status;
    int insyscall = 0;
    child = fork();
    if(child == 0) {
        ptrace(PTRACE_TRACEME, 0, NULL, NULL);
        execl("/bin/ls", "ls", NULL);
    }
    else {
       while(1) {
          wait(&status);
          if(WIFEXITED(status))
              break;
          orig_eax = ptrace(PTRACE_PEEKUSER,
                     child, 4 * ORIG_EAX, NULL);
          if(orig_eax == SYS_write) {
             if(insyscall == 0) {
                /* Syscall entry */
                insyscall = 1;
                params[0] = ptrace(PTRACE_PEEKUSER,
                                   child, 4 * EBX,
                                   NULL);
                params[1] = ptrace(PTRACE_PEEKUSER,
                                   child, 4 * ECX,
                                   NULL);
                params[2] = ptrace(PTRACE_PEEKUSER,
                                   child, 4 * EDX,
                                   NULL);
                printf("Write called with "
                       "%ld, %ld, %ld\n",
                       params[0], params[1],
                       params[2]);
                }
          else { /* Syscall exit */
                eax = ptrace(PTRACE_PEEKUSER,
                             child, 4 * EAX, NULL);
                    printf("Write returned "
                           "with %ld\n", eax);
                    insyscall = 0;
                }
            }
            ptrace(PTRACE_SYSCALL,
                   child, NULL, NULL);
        }
    }
    return 0;
} 
```

# iphone - 无法使用 imageNamed 方法获取 UIImage 对象

> ID：461343
> 
> 赞同：1
> 
> 时间：2009-01-20T13:51:35.213
> 
> 标签：iphone

我想从指定路径位置的 IImage 对象中获取图像。这是代码。

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,  
                                                         NSUserDomainMask,   YES);

NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *writablePath = [documentsDirectory stringByAppendingPathComponent:@"image1.png"];
NSLog(writablePath);
UIImage *image=[UIImage imageNamed:writablePath]; 
```

我得到图像对象为零。那么可能是什么问题？我还确认 image1.png 存在于 writablePath 中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T14:23:55.443

我相信 UIImage imageNamed 从应用程序包中查找图像，而不是通过完整路径。您可以使用 UIImage imageWithContentsOfFile 从完整路径加载（但它不会被缓存），或者只是将图像放入您的包中并使用 imageNamed。

您还需要检查该文件是否实际放置在您的应用程序包中，而不仅仅是位于您的项目目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T18:45:35.623

我认为使用这个：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,  
                                                         NSUserDomainMask,   YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *writablePath = [documentsDirectory stringByAppendingPathComponent:@"image1.png"];
NSLog(writablePath); 
```

===上面写这个===

**`UIImage *image=[UIImage imageWithContentsOfFile:writablePath];`**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T10:19:32.687

你的问题的确切答案是你得到 nil 因为你正在使用 imageNamed: 它使用给定的（路径）名称*相*对于包根目录（即部署的应用程序中的 .app 目录）查找图像，而你给它一个文档目录的*绝对*路径。

您实际上可以使用 imageNamed 从包的子目录中加载图像。这需要两件事：

1.  您的图像实际上位于已部署包的子目录中，而不仅仅是 XCode 项目中的子目录或组 - 因为它们被折叠到根目录中。换句话说，您需要 XCode 中的“蓝色组”（文件夹参考）。

2.  您在 imageNamed 中使用相对路径。

因此 [UIImageView imageNamed:@"subdir/foo"] 将加载 foo.png 或 foo@2x.png，这些文件出现在 XCode 中称为“subdir”的“蓝色”组中。

您还可以使用它在文档的子目录中查找图像，因为您知道相对于您的包将在哪里创建文档，但这有点 hacky。要从文档中加载图像，您应该使用 imageWithContentsOfFile: 而不是 imageNamed:

我厌倦了寻找这种事情的答案并做了一些测试，并在回答这个问题时详细说明了这个和其余的结果（用图片！）：

[UIImage imageNamed 需要 pathForResource？](https://stackoverflow.com/questions/10380842/uiimage-imagenamed-requires-pathforresource)

# parsing - 在 ANTLR 上编写 subshel l 解析规则

> ID：461359
> 
> 赞同：2
> 
> 时间：2009-01-20T13:55:16.093
> 
> 标签：parsing, antlr

我正在尝试在 ANTLRv3 上创建一个简单的类似 BaSH 的语法，但无法解析（和检查）子 shell 命令中的输入。

进一步说明：

我想解析以下输入：

```
$(命令参数*)

`命令参数`

“一些文本$（命令参数*）”

```

并且能够像使用简单输入（例如：命令参数）一样检查它的内容。

IE：

解析它会生成一棵树

```
(SUBSHELL (CMD 命令(PARAM 参数*)))
```

*（标记为大写）*

我可以忽略 '$('s 和 '`'s，但这不会涵盖在双引号字符串中使用子 shell 的情况，例如：

```
$ echo "字符串测试 $(ls -l) end"
```

所以......关于如何实现这一目标的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T14:46:28.580

我对 Antlr v3 的细节不是很熟悉，但我可以告诉你，你不能在传统风格的词法分析器中处理双引号字符串中的 bash 风格的命令替换，因为嵌套不能使用常规来表达语法。大多数传统的编译器 - 编译器限制词法分析器使用常规语法，以便可以为它们构造有效的 DFA。（词法分析器不得不扫描源代码的每个字符，历来是编译器中最慢的部分之一。）

您必须将 " 解析为标记并（理想情况下）对字符串的内部使用不同的词法分析器或词法分析器模式，以便大多数 shell 元字符，例如 '{'，不会被解析为标记而是文本；或者，做摆脱词法分析器划分并使用无扫描仪方法，以便双引号字符串的“词法分析器”规则可以调用“分析器”规则进行命令替换。

我赞成无扫描仪的方法。我将研究 Antlr v3 支持编写直接在字符流上工作的语法，而不是使用令牌流。

# asp.net - asp.net mvc框架，自动发送邮件

> ID：461361
> 
> 赞同：13
> 
> 时间：2009-01-20T13:55:24.457
> 
> 标签：asp.net, visual-studio-2008, email

我希望我的 asp.net mvc 框架系统在每次触发某个操作（在某个控制器内）时发送一封电子邮件。是否有任何第三方库或 .net 标准方法来实现这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-20T14:32:15.893

更新的方法是使用[System.Net.Mail](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx) - 这是 System.Web.Mail 的 2.0 替代品。

像这样的东西，从一个 BaseController （如果有其他控制器需要这个）调用实际的控制器。

我在静态类中有以下代码来处理从服务器发送简单的纯文本项目：

```
internal static void SendEmail(MailAddress fromAddress, MailAddress toAddress, string subject, string body)
{
    var message = new MailMessage(fromAddress, toAddress)
                      {
                          Subject = subject,
                          Body = body
                      };

    var client = new SmtpClient("smtpServerName");
    client.Send(message);
} 
```

显然，您可能希望在其中进行一些错误处理等 - 例如，如果服务器拒绝连接，Send 可能会引发异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T14:02:20.510

创建一个 BaseController ，所有其他控制器都从它继承。在 BaseController 中覆盖 OnActionExecuted 方法并插入用于发送电子邮件的代码。

```
public class BaseController : Controller
{
    protected override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        // Send mail here
        base.OnActionExecuted(filterContext);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T14:43:01.223

[SmtpClient](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx)类和其他[System.Net.Mail](http://msdn.microsoft.com/en-us/library/system.net.mail.aspx)类很容易从任何*.NET*程序中用于发送邮件。您只需将其指向一个可用且愿意使用的[SMTP](http://en.wikipedia.org/wiki/Smtp)服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T14:03:03.457

好吧，使用 .NET 发送电子邮件并不难。您可以从您的操作中发送邮件。

但是，我认为我们在这里很少谈论日志记录，而对于日志记录，有一系列第三方库。我知道有一个叫做 Log4Net。

这些日志框架中的大多数都可以配置日志的存储方式，并且可能还可以配置在记录某些内容时发送电子邮件的设置。

但是在您的场景中，它只会编写一个简单的邮件函数，当用户输入操作时发送邮件。您可以查看： http: [//www.developer.com/net/asp/article.php/3096831](http://www.developer.com/net/asp/article.php/3096831) - 它是使用 .NET 发送邮件的演示 - 虽然是 webforms，但基本的东西仍然适用于 MVC。

# testing - 是否有可以替代浏览内容的 HTTP 代理工具？

> ID：461367
> 
> 赞同：1
> 
> 时间：2009-01-20T13:57:03.033
> 
> 标签：testing, proxy

我正在寻找的是某种代理工具，它允许我指定要加载的本地文件，而不是正在浏览的网页中指定的文件。我已经尝试过 Burp Suite，它几乎可以工作 - 它允许我们拦截文件并通过将我们正在交换的文件的内容粘贴到输入字段来替换它。文件内容是编译后的代码（Flash 内容），所以我们正在粘贴字节码，但有些东西不起作用。

原因是我们是第 3 方软件开发人员，无法访问我们客户的开发或测试环境。我们的内容必须与他们网页上的其余内容正确交互（他们的页面上有与我们的内容通信的元素）并且为了测试我们所做的任何更改需要几个小时的周转时间才能将我们的文件上传到他们的服务器。所以我们需要某种黑客工具来让我们用他们的网页测试我们的工作，因此需要在网页中指定一个文件以与本地版本交换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T14:34:27.187

[如果只是静态内容， Fiddler Web 调试代理](http://www.fiddler2.com/)中的自动回复功能可能会满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:06:33.840

我已经使用[HTTP::Proxy](http://search.cpan.org/dist/HTTP-Proxy)很长一段时间了，它总是帮助我处理各种事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T14:05:08.353

您也许可以使用[Greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/748)来做到这一点，但我不确定测试是否完全可靠。 [http://diveintogreasemonkey.org/patterns/replace-element.html](http://diveintogreasemonkey.org/patterns/replace-element.html)

如果 Greasemonkey 对你来说显然是错误的，我会把它作为尝试[mouseHole](http://github.com/why/mousehole/tree/master)的完美借口。现在我不得不承认我从未尝试过[它，](http://redhanded.hobix.com/inspect/mousehole11InPlainView.html)但自从 _why 也制作了[Hpricot](http://github.com/why/hpricot/tree/master)我希望它有趣、富有成效和与众不同。

# coding-style - 在嵌套方法中执行参数验证的位置

> ID：461375
> 
> 赞同：2
> 
> 时间：2009-01-20T13:58:04.623
> 
> 标签：coding-style

给定以下场景/代码，执行验证的正确位置在哪里：

仅在 MethodA 中：因为这是外部程序集使用的公共方法？在 MethodA 和 B 中，因为这两者都可以在类外访问？或者方法 A、B 和 C，因为方法 C 可能被另一个内部方法使用（但它可能效率不高，因为程序员已经可以看到 MethodC 的代码，因此应该能够知道要传递的有效参数）？

感谢您的任何意见。

```
public class A  
{     
    public void MethodA(param)  
    {  
         MethodB(param);  
    }  

    internal void MethodB(param)
    {
          MethodC(param);
    }

    private void MethodC(param)
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T14:00:21.200

无论调用者的位置如何（在程序集内部或外部），都应始终执行参数验证。防御性编程，可以说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:03:29.167

方法C；这样参数总是会被检查，即使有人稍后出现并从类 A 中添加对 MethodC 的调用，或者他们将 MethodC 公开。任何异常都应该提出到可以最好地处理的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T14:01:12.103

除了遵守 DRY 原则并避免将验证代码复制到多个地方外，没有“合适”的地方。我通常建议您将验证延迟到可能的最新阶段，因为如果该参数从未使用过，您不需要花时间验证它。这也使验证在使用它的地方具有一定的局部性，您永远不需要考虑“哦，这个参数已经验证了吗？” 因为验证就在那里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T14:22:42.217

鉴于更可能的情况将涉及具有不同参数的每种方法，并且可能还有一些

```
如果（P1 == 1）{方法A（P2）}否则{方法B（P2）}

```

从长远来看，在 hte 中类型逻辑更有意义的是在入口点验证每个参数，尤其是因为您可能需要根据调用 hte 方法的位置进行不同的错误处理。

如果给定参数的验证逻辑开始变得复杂（即超过五行代码），则考虑使用私有方法来验证该参数。

# language-agnostic - 停止代码腐烂

> ID：461377
> 
> 赞同：6
> 
> 时间：2009-01-20T13:59:06.693
> 
> 标签：language-agnostic, project-management

鉴于在任何给定时间点，工作功能对公司来说都比好的代码更有价值，而糟糕的代码使得添加更多功能变得困难：

你如何阻止代码随着时间的推移而恶化？

在任何时候，让一个特性工作比让它与需要更长时间的精心设计的代码一起工作更重要。尽管随着时间的推移，每个功能的工作量都会增加。

你如何阻止代码随着时间的推移变成不可维护的糊状？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-20T14:00:34.057

一套全面的单元测试

编辑：如果它们编写得很好，可以以人类可读的方式准确地测试你的所有类/接口，这将很有帮助。

编辑 2：正如 svelil 所说，重构您的代码以保持其干净，但能够做到这一点是进行单元测试的结果。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-20T14:14:26.553

单元测试不会自行停止腐烂。我仍然可以编写通过单元测试的可怕的、不可维护的代码。

更好的答案是单元测试。**+ 定期重构 + 同行评审**（在配对阶段或之后）**+ 标准**

你知道没有灵丹妙药。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T14:05:36.777

使用迭代开发过程：

1.  实现功能
2.  重构代码
3.  跳转到 1。

你必须有一些纪律，但没有它，你最终会一团糟。即使您认为“哦，代码足够可读”，也不要跳过第 2 步。当然，开发应该始终伴随着测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T14:04:55.170

定期重构，特别是在您当前工作的代码部分（“童子军”规则）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T14:10:01.930

这个问题的最高和接受的答案应该是“综合单元测试”。

这个答案不会重复。

但是，将单元测试添加到现有项目要困难得多，并且通常很难模仿如果它自己编写的应用程序代码是考虑到单元测试的，那么可以实现什么。

此外，极端的进度压力可能会让人无法考虑，那些没有使用过单元测试的人仍然是一个大赌注。

在这些情况下，我的建议是尽可能地写作以实现当前目标。准备好在添加新功能之前重构现有代码。虽然单元测试会使这种方法更安全，但即使没有单元测试，这种方法仍然有用。

当然，良好的一般测试和质量保证很重要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T14:03:46.717

一套体面的编码标准。

它们不需要完整，但它们应该意味着您知道大括号缩进之类的东西，因此您无需考虑（这意味着代码匆忙且格式不正确的地方会脱颖而出，例如拇指酸痛）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T14:17:19.123

在我的工作中，当我们接近代码冻结时，有时需要“快速而肮脏”的方法。这通常会导致一些非常狡猾的代码有效但会冒犯你的眼睛。

然而，在发货后，会有一段相对平静的时期。这是重新审视一些臭代码并将其修改成某种形状的绝佳机会。

它有助于保留您想要整理的区域列表并为它们分配某种优先级。尽管你相信自己的记忆力有多好，你还是会忘记。

这种方法对我来说效果很好，但我想这取决于您特定的项目工作流程。

# vb.net - 在 ASP.NET 中显示异常消息的递归方式

> ID：461378
> 
> 赞同：1
> 
> 时间：2009-01-20T13:59:37.443
> 
> 标签：vb.net, exception, recursion, messages

我已经开始大量使用异常，我相信我会从它中成长，因为我会通过艰苦的方式学习优缺点，但是在我成为异常大师之前，我想知道这种技术是否是可以接受的。

我打算在我自己的“SorryFailedToSaveYourData”异常中包装一个数据库异常，然后递归地移动显示消息的异常，有点像这样：

```
Try
    DoSomeWork
Catch
    BuildErrorMessage(lblError,ex)
End Try

Public Sub BuildErrorMessage(ByVal lbl As Label, ByVal ex As Exception)
    lbl.Text += "<br />" & ex.Message
    While Not ex.InnerException Is Nothing
        BuildErrorMessage(lbl, ex.InnerException)
    End While
End Sub 
```

这种做法有用吗，还是在处理异常时我完全错过了这条船？我知道您可以创建自己的例外，但对于我们正在从事的项目的规模来说，这似乎有点矫枉过正。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T22:31:24.633

ex.ToString() 将构建格式化的异常文本，您应该使用它而不是 .Message ，因为它可能无法为您提供调试所需的完整信息。

我还建议使用 AppendLine() 将字符串构建器传递给递归而不是标签，这样您还可以使用该文本发送电子邮件通知、编写事件查看器以及日志文件。为了在您的 UI 中显示（看起来您想要 html），只需将标签文本值设置为

```
StringBuilder.ToString().Replace(Environment.NewLine, "<br />") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T04:42:42.247

我不会向您的应用程序用户显示每条内部异常消息。我会捕获真正的异常（即 SqlException）并将其作为您自己的异常重新抛出（即 throw new YouCantSaveThisTwiceException("This customer ID already exists") ）。然后只需在漂亮的显示屏上向用户显示该手写信息即可。向自己发送一封包含完整堆栈跟踪的电子邮件/日志文件/等。

这有两个目的：

1）您可以看到真正的堆栈跟踪，这使您更容易找到并解决问题。

2) 不必向用户显示可怕的堆栈跟踪。相反，他们阅读了您写的一条好消息，让他们放心，尽管存在问题，但他们并没有“破坏”应用程序。

这适用于您不希望用户能够使用不同输入修复的异常。对于验证用户输入的异常，您通常可以在表示层中捕获这些异常，并在标签上将您的好消息显示给它们，而无需离开表单。

只有（仅！！！）如果您确切地知道您将要捕获什么并且您向用户提供有关如何修复它的明确说明，才使用此技术。否则，你最终会两全其美。用户不知道该怎么做，您也不会被告知存在错误。永远不要仅仅为了“捕获所有”异常而将整个方法包装在 try-catch 中。这种类型的处理应该在应用程序级别全局完成。

我在 Global.asax 中的 application_error 处理程序方法中执行所有全局异常处理（电子邮件、日志记录等）。您还可以创建一个处理应用程序错误的 HttpModule。然后，您可以从一个项目到另一个项目携带该功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T14:25:57.577

您正在异常内部构建标签，大概是因为您想向用户显示消息。如果您的异常跨越应用程序的多个层（您提到包装自己的数据异常），那么这是一个糟糕的主意，因为它会违反封装并强制您的异常处理使用 UI 元素。

但是，通常，您不希望向用户显示错误消息。用户关心堆栈溢出发生了什么？他只关心应用程序是否损坏以及是否记录了错误报告并将其发送给相应的团队。

通常，当且仅当应用程序处于无法再运行的状态时，您才希望出现异常。如果它只是有条件地发生，您将希望使用条件显式处理它以检查它，而不是使用异常机制。

例如，如果您知道用户将在家中进行连接，并且您不能保证一定会有 Internet 连接，您可以检查 Internet 连接并显示一条消息说用户需要连接，而不是仅仅尝试使用 Internet连接并在不存在时创建异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T14:27:16.077

# 编辑

我起初误读了您的问题，如果您向最终用户显示信息，您可能不想这样做。如果您要记录异常以便稍后排除故障，您将需要执行我的建议。

====

这是标准的，尽管我也会捕获堆栈跟踪和 Data 属性中的任何项目（尽管我没有看到任何框架代码使用这个你永远不知道的，如果你要抛出自己的异常或重新抛出异常，它很有用。

尽管您的实际代码中有错误，但您可能最终会陷入无限循环，因为您的外部异常将始终具有内部异常。

```
Public Sub BuildErrorMessage(ByVal lbl As Label, ByVal ex As Exception)   
 lbl.Text += "<br />" & ex.Message    
 If Not ex.InnerException Is Nothing     Then
    BuildErrorMessage(lbl, ex.InnerException)    
  End If 
End Sub 
```

# sql - 将备份恢复到不同的服务器 - 用户权限

> ID：461385
> 
> 赞同：10
> 
> 时间：2009-01-20T14:00:28.830
> 
> 标签：sql, sql-server, backup, ssms, database-restore

我已将 MS SQL Server 2005 数据库备份并恢复到新服务器。

**重新创建登录名、用户和用户权限的最佳方法是什么？**

在 SQL Server 2000 的企业管理器上，我能够分别编写登录脚本、用户脚本和用户权限脚本。然后我可以一个接一个地运行，剩下的唯一手动步骤是设置登录密码（出于安全原因，不编写脚本）

这在 SQL Server 2005 的 Management Studio 中似乎是不可能的，这使得一切都非常繁琐且耗时。（我最终不得不编写整个数据库的脚本，从新数据库中删除所有登录名和用户，运行脚本，然后通过混合错误消息来查看哪些有效，哪些无效。）

有没有人有这方面的经验和建议？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-20T14:54:57.237

最简单的方法是使用 Microsoft 的`sp_help_revlogin`，这是一个存储过程，用于编写所有 SQL Server 登录、默认值和密码，并保持相同的 SID。

您可以在此知识库文章中找到它：

[http://support.microsoft.com/kb/918992](http://support.microsoft.com/kb/918992)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-08T17:31:01.583

运行这个：

```
EXEC sp_change_users_login 'Report' 
```

这将显示所有孤立用户的列表，例如：

![在此处输入图像描述](https://i.stack.imgur.com/OOaLL.png)

现在在这里为每个用户执行这个脚本，例如

```
exec sp_change_users_login 'Update_One', 'UserNameExample', 'UserNameExample' 
```

这解决了我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T14:52:28.367

我使用 Red Gate ( [http://www.red-gate.com/products/SQL_Compare/index.htm](http://www.red-gate.com/products/SQL_Compare/index.htm) ) 的 SQL Compare 产品。周围还有其他类似的产品，但我没有理由去寻找，因为 SQL Compare 从未让我失望。

您会发现它的用处远不止您当前的需求，因为它有助于同步所有类型的数据库对象，而不仅仅是登录和权限。

# winapi - 从 tagRECT/CRect 转换为 Gdiplus::Rect

> ID：461396
> 
> 赞同：4
> 
> 时间：2009-01-20T14:02:33.380
> 
> 标签：winapi, mfc, gdi+

`RECT`将struct ( `tagRECT`) 或 a转换为`CRect`a的最简单方法是`Gdiplus::Rect`什么？

```
Gdiplus::Rect tmpRect(rect.top, rect.left, rect.Width(), rect.Height()); 
```

有效，但打字很多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T23:00:28.543

签名`Rect([in] INT x, [in] INT y, [in] INT width, [in] INT height);`应该是这样

```
Gdiplus::Rect CopyRect(RECT &rect)
{
    return Gdiplus::Rect(rect.left, rect.top, rect.Width(), rect.Height());
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T14:09:25.817

如果 Gdiplus::Rect 的接口没有方便的构造函数，您可以创建自己的函数一次并在任何地方使用它。

```
Gdiplus::Rect CopyRect(const RECT &rect)
{
    return Gdiplus::Rect(rect.left, rect.top, rect.Width(), rect.Height());
} 
```

# java - 奇怪的java枚举错误

> ID：461398
> 
> 赞同：0
> 
> 时间：2009-01-20T14:02:56.360
> 
> 标签：java, enums

我在 Java 中有一个非常奇怪的枚举错误。

```
for(Answer ans : assessmentResult.getAnswersAsList()) { //originally stored in a table
    //AnswerStatus stat = ans.getStatus();
    if (ans.getStatus() == AnswerStatus.NOT_ASSESSED) {
        assessed = false;
    }
} 
```

答案是对测试问题的回答。评估结果是学生在测试中获得的结果（包括一系列答案）。

我已经调试了上面的代码，并`ans.getStatus()`返回`AnswerStatus.ASSESSED`. 尽管如此，if 行返回 true，并且评估设置为 false。

但是，我认为最奇怪的是；当我声明`AnswerStatus`stat 变量时，它可以工作，即使我在 if 测试中不使用 stat 变量。有人可以告诉我发生了什么事吗？

我已经阅读了一些关于序列化/RMI-IIOP 中的枚举错误的内容，但我在这里没有使用它。`enum AnswerStatus`可以是`ASSESSED`或。`NOT_ASSESSED`

类中的`getStatus`方法`Answer`只返回状态，没有别的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T14:18:39.883

> 我已经调试了上面的代码，ans.getStatus() 返回了 AnswerStatus.ASSESSED。尽管如此，if 行返回 true，并且评估设置为 false。
> 
> 但是，我认为最奇怪的是；当我声明 AnswerStatus stat 变量时，它可以工作，即使我在 if 测试中不使用 stat 变量。有人可以告诉我发生了什么事吗？

这听起来像该`getStatus()`方法并不总是返回相同的结果 - 它是如何实现的？

顺便说一句，使用值 ASSESSED 和 NOT_ASSESSED 的枚举有什么意义？为什么不使用布尔 isAssessed()？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T15:01:05.150

解决了。

欺骗我的是 NetBeans 调试器。它没有通过 if 测试（尽管 NetBeans 这么说）。

带来不便敬请谅解 ：-）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T14:08:52.603

如果使用 .equals 而不是 == 会发生什么？

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-01-20T15:40:27.973

没有回答您的问题，但有一个建议：

最好将修复枚举值放在比较语句中的第一位，将变量部分放在第二位。因为，如果在任何情况下变量部分提供 NULL，您都不会得到 NullPointerException。

在您的示例中，它看起来像这样

```
...
if (AnswerStatus.NOT_ASSESSED == ans.getStatus())
... 
```

**错误：**

当然，我犯了一个错误，把两件事混为一谈。如果您使用 equals 方法将固定枚举值与包含此枚举的变量进行比较，则最好将常量枚举值与变量进行比较，反之亦然。例如：

写

```
if (AnswerStatus.NOT_ASSESSED.equals(ans.getStatus())) 
```

代替

```
if (ans.getStatus().equals(AnswerStatus.NOT_ASSESSED)) 
```

因为，如果 ans.getStatus() == null，这可能会损害 NullPointerException。

# javascript - 错误：“CanvasElement”未定义

> ID：461403
> 
> 赞同：0
> 
> 时间：2009-01-20T14:04:12.487
> 
> 标签：javascript, processing

尝试使用处理的 javascript 端口运行以下代码时出现错误：“CanvasElement”未定义。

```
var p = 处理（CanvasElement）；
    p.size(100, 100);
    p.背景（0）；
    p.fill(255);
    p.ellipse(50, 50, 50, 50);

```

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T14:30:58.300

您需要在页面上的某处有一个可以选择的画布元素：

```
<canvas id="theCanvas" width="500" height="500"></canvas> 
```

然后，您可以随意选择元素并将其（或其 ID）传递给处理函数：

```
var p = Processing(document.getElementById("theCanvas")); // or Processing("theCanvas")
p.size(100, 100);
p.background(0);
p.fill(255);
p.ellipse(50, 50, 50, 50); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T14:08:17.037

在哪里`CanvasElement`定义？听起来您发布的代码在定义`CanvasElement`.

# c# - C# 如何更改 windows.forms.listview 中的网格线颜色

> ID：461404
> 
> 赞同：3
> 
> 时间：2009-01-20T14:04:14.483
> 
> 标签：c#, listview

如何更改 windows.forms.listview 中的网格线颜色

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T14:22:41.217

我不认为有一种方法可以在不覆盖 Paint 事件的情况下在列表视图上执行此操作。但是，如果您能够切换到网格视图，您可以这样做：

```
this.dataGridView1.GridColor = Color.BlueViolet; 
```

[参考](http://msdn.microsoft.com/en-us/library/ehz9ksfa(VS.80).aspx)

# javascript - 在javascript中设置默认参数值的最有效方法是什么？

> ID：461406
> 
> 赞同：3
> 
> 时间：2009-01-20T14:05:08.180
> 
> 标签：javascript, parameters, default-value

我知道设置默认参数的两种方法，但我想知道首选方法是什么。

```
function Foo(par1, par2)
{
    if(par2 == null)
        par2 = "my default"
} 
```

或者

```
function Foo(par1, par2)
{
    par2 = par2 || "my default"
} 
```

还是有比这两种方法更好的方法？

编辑：

我还想知道其他人如何处理多个可选参数，例如：我们在内部库中有几个这样的函数（我认为它们非常丑陋）。

```
function Foo(par1, par2, par3)
{
    if(par2 == null)
        par2 = "my default"
    if(par3 == null)
        par3 = "my default"
    // Do something
} 
```

并称之为：

```
Foo("Parameter one",null,true) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T14:16:19.127

第一个实际上是错误的，因为它们是未定义的，而不是空的。

`par2 !== null`在这种情况下将返回 true。

由于 javascript，如果松散比较，将 null、undefined、false 与相同的值进行比较，我建议明确检查未定义的值。

```
如果 (par2 !== 未定义)
        par2 = "我的默认值";

```

或者

```
    par2 = par2 !== 未定义？par2 : "我的默认值";

```

这将允许您传递 false 或 null 等值。

但是，您的第二种方法很方便，但仅在您知道永远不会传递 false 或 null 的情况下。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-20T14:16:52.963

更好和更可靠的方法是：

1) 验证传递的参数数量（假设您希望允许传入未定义的值或 null，就像在 DOM insertBefore 函数的情况下一样），并且只有在此之后尝试设置它们的值（如果省略）：

```
函数 Foo(par1, par2)
{
    if (arguments.length < 2)
        par2 = "我的默认值"
    别的
    if (arguments.length < 3)
        par3 = "我的默认值"
}

```

2) 或者，如果您想禁止传递 undefined，请将其包含在构造中：

```
函数 Foo(par1, par2)
{
    if (arguments.length < 2 && par2 === 未定义)
        par2 = "我的默认值"
    别的
    if (arguments.length < 3 && par3 === 未定义)
        par3 = "我的默认值"

}

```

3) 或者，如果您想禁止传递 null，请将其包含在构造中：

```
函数 Foo(par1, par2)
{
    if (arguments.length < 2 && (par2 === undefined || par2 === null))
        par2 = "我的默认值"
    别的
    if (arguments.length < 3 && (par3 === undefined || par3 === null))
        par4 = "我的默认值"
}

```

顺便说一句：我建议避免使用函数重载，实际上几乎没有必要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T14:10:28.433

我通常使用第二个，因为它增加的信号较少。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T14:33:41.507

就我个人而言，我认为第二种形式更简洁、更易读，当然比 sergey 的参数检查更重要——尽管它可以占据一席之地——但我更喜欢为 args 传递可扩展对象，而不是必须维护 arg 签名。

*例如*

```
function Foo(myArgs)
{
    myArgs.par1 = myArgs.par1 || "my default"
    myArgs.par2 = myArgs.par2 || "my default"
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-21T10:57:54.453

这个如何：

```
function myFunc(arg1, arg2, arg3) {
    switch (arguments.length) {
        case 0 : arg1 = "default1";
        case 1 : arg2 = "default2";
        case 2 : arg3 = "default3";
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T14:16:25.600

之前已经提出过[类似](https://stackoverflow.com/questions/411352/how-best-to-determine-if-an-argument-is-not-sent-to-the-javascript-function)和[相关的问题。](https://stackoverflow.com/questions/430937/what-is-the-best-way-to-tell-users-of-my-library-functions-that-passed-variables)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T14:17:00.903

我所做的选择取决于参数类型和所需的默认值。

例如，如果 par2 为 false、0、空字符串、null 或未定义，这将分配“默认值”：

```
par2 = par2 || 'default value'; 
```

这种行为可能不是预期或要求的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T14:10:29.747

从来没有听说过你提到的第二种方式，这很有趣。我会做：

```
function Foo(par1, par2)
{
    par2 = par2 ? par2 : 'default value';
} 
```

但是现在你让我注意到你的第二种方法，我想我会使用它，因为它打字更少。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-20T14:14:04.620

如果你使用 jquery，你可以这样做：

```
function foo(params){
 var params = $.extend({}, {bar: '2'}, params);
 alert(params.bar);
}
foo(); //Alerts 2 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-20T15:05:29.230

使用解决方案时必须考虑的一件事

var foo = 酒吧 || 123;

是什么 bar 的值评估为 false。它可能会给你带来麻烦。

埃里克

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-20T15:06:07.980

如果您将许多参数传递给函数，您可以执行以下操作：

```
function myFunc() {
    arguments[0] = arguments[0] || "default value for first argument";
    arguments[3] = arguments[3] || "default value for fourth argument";
    alert(arguments[3]);
} 
```

# java - 配置 ant 以运行单元测试。图书馆应该在哪里？类路径应该如何配置？避免 ZipException

> ID：461417
> 
> 赞同：19
> 
> 时间：2009-01-20T14:07:56.083
> 
> 标签：java, ant, junit

我正在尝试使用 ant 运行我的 junit 测试。使用 JUnit 4 测试套件开始测试。如果我直接从 Eclipse 运行此测试，则测试完成而不会出错。但是，如果我从 ant 运行它，那么许多测试都会失败，并且会一遍又一遍地重复此错误，直到 junit 任务崩溃。

```
    [junit] java.util.zip.ZipException：打开 zip 文件时出错
    [junit] 在 java.util.zip.ZipFile.open（本机方法）
    [junit] 在 java.util.zip.ZipFile.(ZipFile.java:114)
    [junit] 在 java.util.zip.ZipFile.(ZipFile.java:131)
    [junit] 在 org.apache.tools.ant.AntClassLoader.getResourceURL(AntClassLoader.java:1028)
    [junit] 在 org.apache.tools.ant.AntClassLoader$ResourceEnumeration.findNextResource(AntClassLoader.java:147)
    [junit] 在 org.apache.tools.ant.AntClassLoader$ResourceEnumeration.nextElement(AntClassLoader.java:130)
    [junit] 在 org.apache.tools.ant.util.CollectionUtils$CompoundEnumeration.nextElement(CollectionUtils.java:198)
    [junit] 在 sun.misc.CompoundEnumeration.nextElement(CompoundEnumeration.java:43)
    [junit] 在 org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.checkForkedPath(JUnitTask.java:1128)
    [junit] 在 org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeAsForked(JUnitTask.java:1013)
    [junit] 在 org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:834)
    [junit] 在 org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeOrQueue(JUnitTask.java:1785)
    [junit] 在 org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:785)
    [junit] 在 org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)
    [junit] 在 sun.reflect.GeneratedMethodAccessor1.invoke（未知来源）
    [junit] 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    [junit] 在 java.lang.reflect.Method.invoke(Method.java:597)
    [junit] 在 org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    [junit] 在 org.apache.tools.ant.Task.perform(Task.java:348)
    [junit] 在 org.apache.tools.ant.Target.execute(Target.java:357)
    [junit] 在 org.apache.tools.ant.Target.performTasks(Target.java:385)
    [junit] 在 org.apache.tools.ant.Project.executeSortedTargets(Project.java:1337)
    [junit] 在 org.apache.tools.ant.Project.executeTarget(Project.java:1306)
    [junit] 在 org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
    [junit] 在 org.apache.tools.ant.Project.executeTargets(Project.java:1189)
    [junit] 在 org.apache.tools.ant.Main.runBuild(Main.java:758)
    [junit] 在 org.apache.tools.ant.Main.startAnt(Main.java:217)
    [junit] 在 org.apache.tools.ant.launch.Launcher.run(Launcher.java:257)
    [junit] 在 org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)

```

我的测试运行任务如下：

```
    <target name="run-junit-tests" 依赖="compile-tests,clean-results">
        <mkdir dir="${test.results.dir}"/>
        <junit failureproperty="tests.failed" fork="true" showoutput="yes" includeantruntime="false">
            <classpath refid="test.run.path" />
            <formatter type="xml" />
            <test name="project.AllTests" todir="${basedir}/test-results" />
        </junit>
        <fail if="tests.failed" message="单元测试失败"/>
    </目标>

```

我已验证类路径包含以下内容以及所有程序代码和库：

```
ant-junit.jar
ant-launcher.jar
蚂蚁罐子
easymock.jar
easymockclassextension.jar
junit-4.4.jar
```

我尝试调试以找出它试图打开的 ZipFile 没有运气，我尝试切换*includeantruntime*和*fork*，我尝试使用*ant -lib test/libs*运行 ant，其中 test/libs 包含 ant 和 junit图书馆。

任何有关导致此异常的原因或您如何配置 ant 以成功运行单元测试的信息都非常感谢。

蚂蚁 1.7.1 (ubuntu)、java 1.6.0_10、junit 4.4

谢谢。

**更新 - 已修复** 发现我的问题。我使用文件集而不是路径元素将我的类目录包含在我的路径中，这导致 .class 文件以 ZipFiles 的形式打开，这当然会引发异常。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-20T15:30:04.313

发现了我的问题。**我使用文件集**而不是路径元素将我的类目录包含在我的路径中，这导致 .class 文件以**ZipFiles**的形式打开，这当然会引发异常。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-05-30T09:19:20.713

此错误是由于类路径包含对一个或多个不是 JAR 的 [文件] 的显式引用而引起的。对“打开 zip 文件时出错”的引用当然是 JAR 实际上是一个 ZIP 文件，而其他文件 [JUNIT] 发现的类文件*不是*，因此没有 zip 格式。所以类路径应该只包含对 JAR [文件] 的显式引用和/或可以找到其他资源（如类文件）的 [目录] 的名称。

因此，在构建您的类路径（在 ANT 中）时，请使用：

```
<path id="proj.class.path">
    <pathelement location="c:/my/project/root" />       :one for each of the [directories] where class files, log4j property files and other resources etc are to be found
    <fileset refid="my.file.set">                   :to describe all the explicit JAR [files] that need to be on the class path.
</path> 
```

在哪里

```
<fileset id="my.file.set" dir="c:/where/i/keep/my/jars">
    <filename name="myjar1.jar" />
    <filename name="myjar2.jar" />
    <filename name="myjar3.jar" />
</fileset> 
```

或者

注意：当使用通配符时`[**/*]`，您需要确保通配符不匹配不是 JAR 文件的文件

```
<fileset id="my.file.set" dir="c:/where/i/keep/my/jars">
    <include name="**/*.jar" />
</fileset> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T14:23:21.310

听起来路径有问题。

检查以下错误来源：

*   classpath：在junit测试中打印出classpath变量，从eclipse和ant中运行，这样就可以比较
*   检查您的项目的绝对路径。可能，ant 使用 eclipse 以外的其他路径前缀。

更多信息将有助于帮助:)

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-30T00:01:04.530

谢谢你们提供这些信息。我只是想根据我的经验添加一些提示。当 junit 尝试在 *.jar 所在的 lib 文件夹中打开 license*.txt 文件时，我对 junit 有同样的问题。（常春藤解析过程将它们放在这里）所以

```
<path id="lib.path.id">
    <fileset dir="${lib.dir}" includes="**.jar"/>
</path> 
```

也有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-18T01:18:19.743

如果您使用的是 Ubuntu 或 Debian，这将使 JUnit（和其他一些库）始终可用于 Ant：

```
sudo apt-get install ant-optional 
```

# vb6 - 分析 COM 应用程序？

> ID：461431
> 
> 赞同：3
> 
> 时间：2009-01-20T14:11:34.673
> 
> 标签：vb6, profiling, profiler

我有一个用[Visual Basic](http://en.wikipedia.org/wiki/Visual_Basic) 6 编写的大型应用程序，我需要对其进行分析。有没有像[ANTS Profiler](http://www.red-gate.com/products/ants_profiler/index.htm)这样的东西，但适用于[COM](http://en.wikipedia.org/wiki/Component_Object_Model)应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T14:23:13.323

我曾经使用[VBWatch](http://www.aivosto.com/vbwatch.html)。我对它有很好的体验，它帮助我确定并解决了一些讨厌的性能问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:15:54.803

看看[Intel 的 VTune，](http://www.intel.com/cd/software/products/asmo-na/eng/250099.htm)它也有本机分析。如果您在使用 VTune 时遇到问题，请尝试使用[AutomatedQA 的 AQTime profiler](http://www.automatedqa.com/products/aqtime/) 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T22:26:41.087

[GlowCode](http://www.glowcode.com/)是另一个很好的工具。我已经成功地将它与 VB6 一起使用。好的部分是您不需要检测或重新编译代码。您所需要的只是 VB6 已经可以为您创建的符号（.pdb 文件）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-16T13:50:49.407

迟到总比不到好？VB6 有一个“暂停”按钮，对吧？它不仅免费，而且不需要安装，而且在我看来，它是[迄今为止定位性能问题的最佳工具](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T14:15:44.570

[自动化质量保证](http://www.automatedqa.com/products/testcomplete/supported_dev_tools.asp)

那是你最好的选择。

# c# - 我将如何使用 C# 搜索一系列范围值

> ID：461439
> 
> 赞同：5
> 
> 时间：2009-01-20T14:13:09.567
> 
> 标签：c#, algorithm

我有一个这样的值列表

```
1000, 20400
22200, 24444 
```

范围不重叠。

我想要做的是拥有 ac# 函数，它可以存储（从 db 加载值然后在本地缓存它）这些值的相对较大的列表，然后有一种方法来查找提供的值是否在任何范围内？

这有意义吗？

需要最快的解决方案

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-20T14:18:20.027

您已经指定了值，但随后谈到了范围。

对于值，我会使用`HashSet<int>`. 对于范围，它变得更加复杂......让我们知道这是否真的是你所追求的，我会考虑更多。如果它们*是*范围，您是否有任何关于它们的额外信息？你知道它们是否会重叠吗？您只是对某个范围的存在感兴趣，还是需要查找某个值所属的所有范围？

编辑：通过对问题的编辑，巴里的回答完全正确。只需在初始化时进行排序（按下限就足够了），然后进行二进制搜索以查找包含该值的范围，或者缺少该值。

编辑：我最近在[对类似问题的回答中](https://stackoverflow.com/questions/454250#454312)找到了以下代码。

范围需要预先排序 -`List<Range>.Sort`假设您没有重叠，将正常工作。

```
public class Range : IComparable<Range>
{
      private readonly int bottom; // Add properties for these if you want
      private readonly int top;

      public Range(int bottom, int top)
      {
             this.bottom = bottom;
             this.top = top;
      }

      public int CompareTo(Range other)
      {
             if (bottom < other.bottom && top < other.top)
             {
                   return -1;
             }
             if (bottom > other.bottom && top > other.top)
             {
                   return 1;
             }
             if (bottom == other.bottom && top == other.top)
             {
                   return 0;
             }
             throw new ArgumentException("Incomparable values (overlapping)");
      }

      /// <summary>
      /// Returns 0 if value is in the specified range;
      /// less than 0 if value is above the range;
      /// greater than 0 if value is below the range.
      /// </summary>
      public int CompareTo(int value)
      {
             if (value < bottom)
             {
                   return 1;
             }
             if (value > top)
             {
                   return -1;
             }
             return 0;
      }
}

// Just an existence search
public static bool BinarySearch(IList<Range> ranges, int value)
{
    int min = 0;
    int max = ranges.Count-1;

    while (min <= max)
    {
        int mid = (min + max) / 2;
        int comparison = ranges[mid].CompareTo(value);
        if (comparison == 0)
        {
            return true;
        }
        if (comparison < 0)
        {
            min = mid+1;
        }
        else if (comparison > 0)
        {
            max = mid-1;
        }
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T14:18:34.080

二进制搜索就可以了。保持范围列表按排序顺序排列，确保它们都不相交（如果它们相交，则合并它们）。然后编写一个二分搜索，而不是针对单个值进行测试，而是在寻找上方或下方时针对范围的任一端进行测试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-20T14:30:20.720

我会先尝试最简单的选项，如果不满足您的需求则进行优化。

```
class Range {
   int Lower { get; set; }
   int Upper { get; set; }
}

List<Range>.FirstOrDefault(r => i >= r.Lower && i <= r.Upper); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-28T15:44:26.010

如前所述，如果范围集很大且不重叠，则最好进行二分搜索。一种方法是使用`SortedDictionary`，它实现了一个红黑树以提供 O(log(n)) 搜索时间。我们可以将范围用作键，并通过将我们要匹配的单个值转换为单个点的范围来进行字典查找。如果我们实现该`CompareTo`方法，以便将重叠的范围视为相等/匹配，则字典查找将找到匹配范围以供使用。

```
public struct Range : IComparable<Range>
{
    public int From;
    public int To;

    public Range(int point)
    {
        From = point;
        To = point;
    }

    public Range(int from, int to)
    {
        From = from;
        To = to;
    }

    public int CompareTo(Range other)
    {
        // If the ranges are overlapping, they are considered equal/matching
        if (From <= other.To && To >= other.From)
        {
            return 0;
        }

        // Since the ranges are not overlapping, we can compare either end
        return From.CompareTo(other.From);
    }
}

public class RangeDictionary
{
    private static SortedDictionary<Range, string> _ranges = new SortedDictionary<Range, string>();

    public RangeDictionary()
    {
        _ranges.Add(new Range(1, 1000), "Alice");
        _ranges.Add(new Range(1001, 2000), "Bob");
        _ranges.Add(new Range(2001, 3000), "Carol");
    }

    public string Lookup(int key)
    {
        /* We convert the value we want to lookup into a range,
         * so it can be compared with the other ranges */
        var keyAsRange = new Range(key);
        string value;
        if (_ranges.TryGetValue(keyAsRange, out value))
        {
            return value;
        }
        return null;
    }
} 
```

例如，运行以下代码

```
var ranges = new RangeDictionary();
var value = ranges.Lookup(1356); 
```

`value`在这种情况下将包含字符串`"Bob"`，因为 1356 匹配范围 1001-2000。

在您的情况下，如果您有兴趣获取范围本身，则可以将该范围用作字典中的键和值。示例代码可以很容易地扩展到保存通用值。

作为旁注，这个技巧也可以使用`SortedList`几乎相同的代码来完成，它使用更少的内存（数组而不是树）但对于未排序的数据有更慢的插入/删除时间。它们都使用键类型（或指定的比较器）的默认比较器来比较值。`Dictionary`另一方面，普通的 C#使用`GetHashCode`and`Equals`来比较值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T15:41:15.490

```
class Ranges
{
    int[] starts = new[] { 1000, 22200 };
    int[] ends = new[] { 20400, 24444 };

    public int RangeIndex(int test)
    {
        int index = -1;

        if (test >= starts[0] && test <= ends[ends.Length - 1])
        {
            index = Array.BinarySearch(ends, test);

            if (index <= 0)
            {
                index = ~index;
                if (starts[index] > test) index = -1;
            }
        }

        return index;
    }
} 
```

显然，如何实例化类取决于您。也许传入一个 DataTable 并从中构造数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T14:31:40.653

假设您的范围不重叠：

> -> 将所有范围数字放入一个数组中。
> 
> -> 对你的数组进行排序。
> 
> -> 还为您的起始值保留一个 HashSet。
> 
> -> 现在对你的号码进行二分搜索。两种可能：
> 
> --> 数组左边（小于）你的数字是一个起始值：你的数字在范围内。
> 
> --> 您的号码左侧（小于）的数组范围不是起始值：您的号码不在范围内。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T14:36:31.253

这在功能上是您所追求的吗？如果是这样，并且您只是希望它具有更高的性能，而不是将 ValueRangeCollection 中的 foreach 更改为二进制搜索..

```
 public struct ValueRange 
    { 
       public int LowVal; 
       public int HiVal; 
       public bool Contains (int CandidateValue) 
       { return CandidateValue >= LowVal && CandidateValue <= HiVal; } 
       public ValueRange(int loVal, int hiVal)
       {
          LowVal = loVal;
          HiVal = hiVal;
       }
   }

    public class ValueRangeCollection: SortedList<int, ValueRange> 
    { 
        public bool Contains(int candValue) 
        {  
            foreach ( ValueRange valRng in Values)
                if (valRng.Contains(candValue)) return true;
            return false; 
        }
        public void Add(int loValue, int hiValue)
        {
            Add(loValue, new ValueRange(loValue, hiValue));
        }
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T14:43:04.687

```
class Range
{
   public int Start { get; set; }
   public int End { get; set; }

   static Dictionary<int, Range> values;
   static int[] arrToBinarySearchIn;
   public static void BuildRanges(IEnumerable<Range> ranges) { 
        values = new Dictionary<int, Range>();
        foreach (var item in ranges)
            values[item.Start] = item;
        arrToBinarySearchIn = values.Keys.ToArray();
        Array.Sort(arrToBinarySearchIn);
   }
   public static Range GetRange(int value)
   {
       int searchIndex = Array.BinarySearch(arrToBinarySearchIn, value);
       if (searchIndex < 0)
           searchIndex = ~searchIndex - 1;
       if (searchIndex < 0)
           return null;
       Range proposedRange = values[arrToBinarySearchIn[searchIndex]];
       if (proposedRange.End >= value)
           return proposedRange;
       return null;
   }
} 
```

# html - 如何表达anchor标签所引用的内容

> ID：461440
> 
> 赞同：0
> 
> 时间：2009-01-20T14:13:42.937
> 
> 标签：html, semantics

我想在 HTML 文档中表达锚标记 ( `<a>`) 指向的文档类型。例如，它是日期列表还是人员列表等...所有引用的文档都是 Atom 提要，但链接会根据提要包含的内容而不同地显示。

我看到 2 个选项：

1.  **使用“rel”属性：**该属性应该包含当前文档和引用文档之间的*关系。*我不认为这是一个最佳解决方案，因为这个属性应该定义关系而不是真正的内容。引用的文档将是引用它的所有文档的日期列表。

2.  **使用“类型”属性：**该属性应该包含被引用文档的内容类型。这个解决方案似乎更接近我试图实现的目标，但是这个属性应该包含一个内容类型，而不是一个更通用的链接描述。

您会推荐哪种解决方案？您是否看到了一种更清洁的方法来实现相同的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T14:16:50.373

也许像[微格式](http://microformats.org/)这样的东西会有所帮助？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:18:43.457

`title`链接上的属性允许您给链接一个标题，当它悬停时显示。

这可能就是你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T14:33:31.773

使用 class 属性，因为您的意图是让它们看起来不同，这似乎是最好的选择。

# wpf - WPF Window无法识别同一个项目中定义的用户控件怎么办？

> ID：461443
> 
> 赞同：4
> 
> 时间：2009-01-20T14:14:11.250
> 
> 标签：wpf, user-controls, c#-3.0, wpf-controls

我在 XAML 中有一个窗口“操作”，它使用在同一项目中定义的用户控件“状态”。当我构建解决方案时，它返回正常，但是当我打开窗口的设计视图时，Visual Studio 说“无法创建'状态'类型的实例。窗口“操作”的 XAML 如下：

```
<Window x:Class="TCI.Indexer.UI.Operacao"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:tci="clr-namespace:TCI.Indexer.UI.Controles"
        Title=" "
        MinHeight="550"
        MinWidth="675"
        Loaded="Load"
        ResizeMode="NoResize"
        WindowStyle="None"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Focusable="True">
  <Canvas Name="canv">      
    <tci:Status x:Name="ucStatus"/>
    <Grid Canvas.Top="0" Canvas.Left="0">        
      <StackPanel Orientation="Horizontal">
        <!-- Indices -->
        <Label Width="200"/>        
      </StackPanel>
    </Grid>
  </Canvas>
</Window> 
```

`xmlns:tci`是 Status Usercontrol 所在的命名空间。并`tci:Status`在发生此错误时变为蓝色下划线。如何使用这样的 UserControl？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-30T10:15:12.630

我一直在我的项目中使用一个控件来解决这个问题，并通过将我的所有图像更改为`DynamicResource`而不是`StaticResource`.

真正奇怪的是，设计师为控件本身工作得很好，并按预期显示了图像。只有当我在主窗口中使用控件时，设计师才给我“无法创建实例”消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-15T11:35:54.067

与 Jon Norton 所说的类似，我还发现了这个链接（*-link 已删除，见下文*-），它涉及资源。我有链接中描述的情况，乔恩的修复对其进行了排序。

**编辑**

抱歉，该链接现在需要登录，并且该页面不再存在。三年后我找不到它应该是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T14:19:12.643

我不知道确切的解决方案是什么，但这也时常发生在我身上。我最终删除了命名空间的声明，重新构建并重试。:\

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T14:22:55.930

尝试清理整个项目，然后进行完全重建。在我看来，VS 中的 WPF 设计器做得很差，而且到处都有这样的奇怪问题。

在这一点上，我建议不要依赖设计视图——它太不稳定了。试试Expression Blend，这样的东西会好一点。如果你不想走那条路，你最好构建和运行你的应用程序:-(

如果您运行的是 VS 2008，您是否安装了 SP1？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T20:36:43.433

当我没有构建控件时，我通常会看到这一点。确保构建控件并查看是否仍然存在问题。有时，VS 会感到困惑，您需要关闭并打开您遇到问题的控件。在这种情况下，那将是您的窗口。

# c++ - main() 中的 return 语句与 exit()

> ID：461449
> 
> 赞同：216
> 
> 时间：2009-01-20T14:15:10.780
> 
> 标签：c++, c, coding-style, return, exit

我应该使用`exit()`还是只使用`return`语句`main()`？就我个人而言，我喜欢这些`return`陈述，因为我觉得它就像阅读任何其他函数一样，并且当我阅读代码时流程控制很流畅（在我看来）。即使我想重构`main()`函数，拥有`return`似乎比`exit()`.

做一些没有`exit()`做的特别的事情`return`吗？

* * *

## 回答 #1

> 赞同：298
> 
> 时间：2009-01-20T14:30:54.290

其实*还是* 有区别的，但是很微妙。它对 C++ 有更多的影响，但差异很重要。

当我调用`return`时`main()`，将为我的本地范围对象调用析构函数。如果我调用`exit()`，**则不会为我的本地范围对象调用析构函数！**再读一遍。`exit()` **不返回**。这意味着，一旦我称它为，就“没有后盾”。您在该函数中创建的任何对象都不会被销毁。通常这没有任何影响，但有时确实如此，例如关闭文件（您肯定希望所有数据都刷新到磁盘吗？）。

请注意，`static`即使您调用`exit()`. 最后请注意，如果您使用`abort()`，则不会销毁任何对象。也就是说，不会调用全局对象、静态对象和局部对象的析构函数。

**在倾向于退出而不是返回时要谨慎行事。**

[http://groups.google.com/group/gnu.gcc.help/msg/8348c50030cfd15a](http://groups.google.com/group/gnu.gcc.help/msg/8348c50030cfd15a)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-20T15:50:02.400

另一个区别： `exit`是标准库函数，因此您需要包含标头并与标准库链接。为了说明（在 C++ 中），这是一个有效的程序：

```
int main() { return 0; } 
```

但要使用`exit`你需要一个包括：

```
#include <stdlib.h>
int main() { exit(EXIT_SUCCESS); } 
```

另外，这增加了一个额外的假设：调用`exit`from`main`与返回零具有相同的副作用。正如其他人指出的那样，这取决于您正在构建什么样的可执行文件（即，谁在调用`main`）。您是否正在编写使用 C 运行时的应用程序？玛雅插件？Windows 服务？一个司机？每个案例都需要研究，看看是否`exit`等同于`return`. 恕我直言，`exit`当您*真正的意思* `return`时使用只会使代码更加混乱。OTOH，如果你*真的是意思* `exit`，那么一定要使用它。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2011-05-02T12:07:32.970

至少有一个理由更喜欢`exit`：如果您的任何处理`atexit`程序在未定义的行为，但调用是有效的。`main``setvbuf``setbuf``main``main``exit`

另一个潜在用途（通常保留给玩具程序）是从具有递归调用的程序中退出`main`.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-20T14:17:48.780

我总是使用`return`，因为标准原型`main()`说它确实返回一个`int`.

也就是说，某些版本的标准给予`main`特殊处理，并假设如果没有明确的`return`声明它返回 0。给定以下代码：

```
int foo() {}
int main(int argc, char *argv[]) {} 
```

G++ 仅生成警告`foo()`并忽略来自 的缺失返回`main`：

```
% g++ -Wall -c foo.cc
foo.cc: In function ‘int foo()’:
foo.cc:1: warning: control reaches end of non-void function 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-06-26T21:29:57.463

我**强烈**支持 R. 关于使用 exit() 的评论，以避免在`main()`程序实际结束之前回收自动存储。in的`return X;`语句`main()`并不完全等同于对 的调用`exit(X);`，因为动态存储在返回`main()`时会消失`main()`，但如果改为调用，它不会消失`exit()`。

此外，在 C 或任何类似 C 的语言中，一条`return`语句强烈暗示读者将在调用函数中继续执行，虽然如果计算调用`main()`函数的 C 启动例程，这种继续执行通常在技术上是正确的，但事实并非如此当您打算结束该过程时，这正是*您*的意思。

毕竟，如果你想从任何其他函数中结束你的程序，除了`main()`你*必须*调用`exit()`. 始终如一地这样做`main()`也会使您的代码更具可读性，并且还使任何人都可以更轻松地重构您的代码；`main()`即，从其他函数复制的代码不会因为本*应*调用的意外`return`语句而行为不端。*`exit()`*

 *因此，将所有这些点结合在一起，得出的结论是，至少对于 C 来说，使用语句结束程序是一个*坏习惯*。`return``main()`

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-12-04T18:46:59.040

> exit() 会做任何“return”没有做的特殊事情吗？

对于不常见平台的一些编译器，`exit()`可能会将其参数转换为程序的退出值，而 return from`main()`可能只是将值直接传递给主机环境而无需任何转换。

在这些情况下，该标准需要相同的行为（具体来说，它表示返回与`int`- 兼容的内容`main()`应该等同于`exit()`使用该值进行调用）。问题是不同的操作系统有不同的解释退出值的约定。在许多（很多！）系统上，0 意味着成功，其他任何东西都是失败。但是在 VMS 上，奇数表示成功，偶数表示失败。如果您从 中返回 0 `main()`，则 VMS 用户会看到一条关于访问冲突的令人讨厌的消息。实际上并没有访问冲突——这只是与失败代码 0 相关的标准消息。

然后 ANSI 出现并得到祝福`EXIT_SUCCESS`，并且`EXIT_FAILURE`可以作为参数传递给`exit()`. 该标准还说`exit(0)`应该与 的行为相同`exit(EXIT_SUCCESS)`，因此大多数实现都定义`EXIT_SUCCESS`为`0`。

因此，该标准将您置于 VMS 的约束中，因为它没有留下任何标准方法来返回恰好具有值 0的*故障代码。*

因此，1990 年代早期的 VAX/VMS C 编译器没有解释 from 的返回值`main()`，它只是将任何值返回给主机环境。但是，如果您使用`exit()`它，它将执行标准要求的操作：将`EXIT_SUCCESS`（或`0`）转换为成功代码和`EXIT_FAILURE`通用失败代码。要使用`EXIT_SUCCESS`，你*必须*把它传递给`exit()`，你不能从它返回`main()`。我不知道该编译器的更现代版本是否保留了这种行为。

一个可移植的 C 程序曾经看起来像这样：

```
#include <stdio.h>
#include <stdlib.h>

int main() {
  printf("Hello, World!\n");
  exit(EXIT_SUCCESS);  /* to get good return value to OS */
  /*NOTREACHED*/ /* to silence lint warning */
  return 0;  /* to silence compiler warning */
} 
```

另外：如果我没记错的话，退出值的 VMS 约定比奇数/偶数更细微。它实际上使用像低三位这样的东西来编码严重性级别。然而，一般来说，奇数严重级别表示成功或杂项信息，偶数严重级别表示错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-21T14:14:45.073

在 C 中，从返回与使用相同的值`main`调用`exit`完全相同。

[C 标准](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)的第 5.1.2.2.3 节规定：

> 如果 main 函数的返回类型是与 int 兼容的类型，**则从初始调用到 main 函数的 return 等效于以 main 函数返回的值作为参数调用 exit 函数**；11）到达终止main函数的}返回值0。如果返回类型与int不兼容，则返回给宿主环境的终止状态是未指定的。

正如其他答案中提到的，C++ 的规则有点不同。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-05-23T13:35:12.733

当你的函数被多次调用时`exit(0)`，实际上是有区别`return(0)`的。`main``main`

以下程序

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char** argv) {
  if (argc == 0)
    return(0);
  printf("%d", main(argc - 1, argv));
} 
```

运行方式

```
./program 0 0 0 0 
```

将产生以下输出：

```
00000 
```

然而这个：

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char** argv) {
  if (argc == 0)
    exit(0);
  printf("%d", main(argc - 1, argv));
} 
```

无论参数如何，都不会打印任何内容。

如果您确定没有人会`main`明确地调用您，那么从技术上讲，这通常不会有很大的不同，但是保持更清晰的代码`exit`看起来会更好。如果您出于某种原因想要打电话`main`- 您应该根据自己的需要进行调整。

谈到C。

# html - 如何在新窗口中打开 pdf 文件中的链接？

> ID：461479
> 
> 赞同：2
> 
> 时间：2009-01-20T14:20:45.013
> 
> 标签：html, pdf, browser, pdf-generation

我在嵌入在浏览器实例中的 pdf 文档 (PDF1) 中有一个链接。或者假设 Adob​​e Reader 嵌入在浏览器窗口中。

在这个 pdf 文档 (PDF2) 中是一个 servlet 的链接，该视图会打开另一个 pdf 文件。

现在，新的 pdf 文档在同一浏览器窗口中的嵌入式 Adob​​e Reader 中打开。如何使用新的嵌入式 Adob​​e Reader 在新的浏览器窗口中打开此文档 (PDF2)？

这是否取决于用于生成 pdf 文档的编辑器工具？

PS：我没有创建第一个（PDF1），但我面临一个问题，如何在新窗口中打开第二个（PDF2），所以第一个文档不会“丢失”并且必须再次重新打开.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T15:28:35.173

我认为如果不更改 Acrobat Reader 就无法做到这一点。会发生什么：

*   您下载第一个文件。
*   IE 注意到“PDF”并嵌入了 Acrobat Reader。阅读器获取 URL 作为参数。尽管 AR在 IE 窗口内*呈现*文档，但 AR 现在完全控制了文档。因此，当您单击链接时，处理事件并下载第二个文档的是 AR（而不是 IE）。

我建议尝试[Foxit Reader](http://www.foxitsoftware.com/pdf/rd_intro.php)或其他不使用“单文档”用户界面的 PDF 阅读器。Foxit 使用选项卡，可以显示多个 PDF 文档。

它们速度更快，使用起来也更舒适。

[编辑] 实际上，AR 调用操作系统来处理链接。您可以通过将 URL 复制到剪贴板中来实现相同的效果，然后单击“开始”按钮和“运行...”。将 URL 粘贴到对话框中。或者打开命令行提示符并在提示符处粘贴 URL。

操作系统将开始下载文件，确定类型，然后直接调用为该类型注册的应用程序。IE 做了同样的事情，这在过去导致了一些安全漏洞（网站向 IE 提供了一些似乎是 XXX 类型但实际上是病毒的数据。IE 会调用操作系统来执行它，用户想知道他是如何得到的已感染）。

# c# - LINQ to XML、ORM 或“完全不同”的东西？

> ID：461499
> 
> 赞同：3
> 
> 时间：2009-01-20T14:24:46.003
> 
> 标签：c#, linq, silverlight, orm

我正在从事具有所有功能和限制的 Silverlight 项目。这是对以前产品的更新。为了快速推向市场，其目的是尽可能多地维护后端（Web 服务、数据库等）。如果没有其他方法，我们要求它只接触后端。我们将主要专注于重写前端。很快就会有一个重要的行业会议，我们将在其中演示产品的早期外观。在正式发布之前可能有时间做一些返工，但是后端可能需要等到 V2.

好的，所以我想要做的是将 MVVM 模式与我负责的前端的数据绑定一起使用（MVVM 模式由上面规定）。我有一个提供一些 XML 的预先存在的 Web 服务。该 XML 的示例如下所示：

```
<CODEBOOKINDEX>
    <ME Words="1" Score="25" Highscore="1">Main Entry Item
        <NM>attack</NM>
        <NM>cardiac</NM>
        <NM>chest</NM>
        <NM>effort</NM>
        <NM>heart</NM>
        <NM>pectoris</NM>
        <NM>syndrome</NM>
        <NM>vasomotor</NM>
        <IE>413.9</IE>

        <M1 Words="1" Score="25">An M1 Item (Same as ME, just first level Child)
            <IE>557.1</IE>
        </M1>

        <M1 Words="1" Score="25">Another M1 Item
        <IE>443.9</IE>
            <M2 Words="1" Score="25">An M2 Item (again same as ME, just a child of an M1 item)
                <CF>Arteriosclerosis,extremities</CF>
                <IE>440.20</IE>
            </M2>
        </M1>
    </ME></CODEBOOKINDEX> 
```

所以，我的问题是，由于我想使用 MVVM 模式将其绑定到 UI，因此在我看来，我需要将其转换为自定义对象。如您所见，有许多“Entry”项，MainEntry (ME) 和 Subentries（在本例中为 M1 或 M2），它们都将包含某些其他节点（例如，它们都将具有 IE 节点），它们可以包含 0 个或多个其他节点类型（例如，它们可以包含或不包含一个或多个 NM 节点，或者它们可以包含或不包含一个 CF 节点）。Whihc 意味着（至少对我而言）我不能真正直接绑定到 XML，因为：

1.  它违反了 MVVM 模式（我可能会为演示证明这一点，但稍后必须重构）。
2.  我无法真正将 UI 元素绑定到给定项目可能不存在的 XML 节点。
3.  在某些情况下，我必须将一个集合（例如一堆 NM 项目）转换为一个格式化的字符串以用于显示目的，我不认为这是一件微不足道的事情。

因此，我试图了解将此 XML 转换为可绑定对象的最佳方法，在我看来，这意味着将此 XML 转换为模型的对象，然后在该模型上覆盖视图模型。

这可以通过 LINQ to XML 查询轻松完成，还是我真的进入了诸如 NHibernate 或实体框架之类的 ORM 领域（请不要对哪个 ORM 进行圣战）？
我刚刚确定了我将为 UI 使用的控件，我需要尽快向我的经理演示我将**如何**处理翻译。

所以，真正的问题：

1.  我**需要**ORM 吗？我不反对使用它们，但我想保持 XAP 文件的大小很小，并且想限制我（和我的队友）一次需要学习的新技术的数量。
2.  如果我确实需要一个，我可以减小文件大小，并且可以使用 EF 或 NHibernatge 快速增加并很快展示一个模型吗？我在这里谈论了一个星期，有一些**东西** 可以从 web 服务中获取输出并将其变成一个对象，即使地图最初并不完美，我也需要展示一些进展。
3.  有没有我不认为可能更容易的另一种选择，限制修改现有代码（即网络服务）和产品可用结果的需要？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-20T14:36:36.963

> 我需要 ORM 吗？

不，您没有映射到关系源，因此对象关系映射器无济于事。

* * *

使用[Linq to Xml](http://msdn.microsoft.com/en-us/library/system.xml.linq.aspx)完成它。

```
public CustomClass TranslateME(XElement source)
{
  CustomClass result = new CustomClass();
  result.Words = (int) source.Attribute("Words");
  result.Score = (int) source.Attribute("Score");

  XAttribute highScore = source.Attribute("HighScore");
  result.HighScore = (highScore == null) ? 0 : (int) highScore;

  result.NMs = source
    .Elements("NM")
    .Select(x => x.Value)
    .ToList();

  result.IE = source
    .Element("IE").Value;

  result.SubEntries = source
    .Elements("M1")
    .Select(x => TranslateM1(x))
    .ToList();

  return result;
} 
```

# c++ - 如何使用带有 boost::ptr_map 的 BOOST_FOREACH？

> ID：461507
> 
> 赞同：12
> 
> 时间：2009-01-20T14:26:55.377
> 
> 标签：c++, boost

如何通过 boost::ptr_map 有效地使用 BOOST_FOREACH（字符数/可读性）？

Kristo 在他的[回答](https://stackoverflow.com/questions/461507/how-to-use-boostforeach-with-a-boostptrmap#461908)中证明了可以将 BOOST_FOREACH 与 ptr_map 一起使用，但与使用迭代器迭代 ptr_map 相比，它并没有真正为我节省任何打字（或使我的代码真正更具可读性）：

```
typedef boost::ptr_container_detail::ref_pair<int, int* const> IntPair;
BOOST_FOREACH(IntPair p, mymap) {
    int i = p.first;
}

// vs.

boost::ptr_map<int, T>::iterator it;
for (it = mymap.begin(); it != mymap.end(); ++it) {
    // doSomething()
} 
```

下面的代码是我想要的。它遵循如何将 BOOST_FOREACH 与 std::map 一起使用的标准方式。不幸的是，这不能编译：

```
boost::ptr_map<int, T> mymap;
// insert something into mymap
// ...

typedef pair<int, T> IntTpair;
BOOST_FOREACH (IntTpair &p, mymap) {
    int i = p.first;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-26T11:30:00.960

作为 STL 风格的容器，指针容器有一个`value_type`你可以使用的 typedef：

```
#include <boost/ptr_container/ptr_map.hpp>
#include <boost/foreach.hpp>

int main()
{
    typedef boost::ptr_map<int, int> int_map;
    int_map mymap;

    BOOST_FOREACH(int_map::value_type p, mymap)
    {
    }
} 
```

我发现对容器使用 typedef 可以使代码更容易编写。

此外，您应该尽量避免`detail`在 boost 中使用命名空间的内容，这是一个 boost 约定，它们包含实现细节。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-01-07T05:29:18.493

我今天遇到了同样的问题。不幸的是，丹尼尔的建议不适用于不断引用地图。在我的例子中，ptr_map 是一个类的成员，我想在一个 const 成员函数中循环它。借用丹尼尔的例子，这就是我必须做的事情：

```
#include "boost/ptr_container/ptr_map.hpp"
#include "boost/foreach.hpp"

int main()
{
    typedef boost::ptr_map<int, int> int_map;
    int_map mymap;
    const int_map& mymap_const_ref(mymap);

    BOOST_FOREACH(int_map::const_iterator::value_type p, mymap_const_ref)
    {
    }
} 
```

似乎`int_map::const_iterator::value_type`相当于`boost::ptr_container_detail::ref_pair<int, const int* const>`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-01-24T02:09:00.523

通过使用元组来节省打字并提高可读性：

```
boost::ptr_map<int, T> mymap;
int key;
T * value;
BOOST_FOREACH(boost::tie(key, value), mymap)
{
    ...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T16:01:55.777

这个示例代码使用 g++ 4.1.2 为我编译：

```
#include "boost/ptr_container/ptr_map.hpp"
#include "boost/foreach.hpp"

int main()
{
    boost::ptr_map<int, int> mymap;

    typedef boost::ptr_container_detail::ref_pair<int, int* const> IntPair;
    BOOST_FOREACH(IntPair p, mymap)
    {
        int i = p.first;
    }

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-16T23:50:01.793

我使用这个自制模板，它添加了一个可以由**BOOST_FOREACH处理的迭代类型**

```
namspace homebrew
{
  template
  <
    class Key,
    class T,
    class Compare        = std::less<Key>,
    class CloneAllocator = boost::heap_clone_allocator,
    class Allocator      = std::allocator< std::pair<const Key,void*> >
  >
  class ptr_map :
    public boost::ptr_map<Key,T,Compare,CloneAllocator,Allocator>
  {
  public:
    typedef boost::ptr_container_detail::ref_pair<Key,const T* const> const_ref;
    typedef boost::ptr_container_detail::ref_pair<Key,T* const> ref;
  };
} 
```

假设**foo**和**bar**是您最喜欢的两种类型；）

```
typedef homebrew::ptr_map<foo,bar> Map;
int f( const Map& m )
{
  BOOST_FOREACH(Map::const_ref v, m)
  {
    v.first;  // foo
    v.second; // const bar* const
  }
} 
```

或者

```
int f( Map& m )
{
  BOOST_FOREACH(Map::ref v, m)
  {
    v.first;  // foo
    v.second; // bar* const
  }
} 
```

您必须使用哪一个似乎并不取决于您在循环中使用它的方式（常量或非常量），而是取决于地图的常量！所以下面会报错...

```
int f( Map& m )
{
  BOOST_FOREACH(Map::const_ref v, m)  // can't use const_ref because m isn't const
  {
    ...
  }
} 
```

奇怪的！不是吗？

对我来说最棒的是这里建议的所有这些解决方案，这是第一个由 Eclipse CDT 语法着色正确处理的解决方案（使用“代码/问题”语法着色属性时）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T14:55:50.480

它应该在没有参考的情况下编译：

```
BOOST_FOREACH (IntTpair p, mymap) 
```

我认为问题在于地图实际上并没有将对象存储为对，而是作为一个以第一个元素为键的树结构，因此 BOOST_FOREACH 无法获取对一对的引用，但它可以创建一个的临时副本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-15T14:28:28.633

使用 ::value_type 不会让您对容器进行常量迭代。我使用迭代器引用类型

```
typedef boost::ptr_map< myKey, myPtrType > MyMap;
MyMap m;
BOOST_FOREACH( MyMap::iterator::reference it, m )
  do_something( it.second );
BOOST_FOREACH( MyMap::const_iterator::reference it, m )
  do_something_const( it.second ); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-11T15:33:46.627

最后，我在循环之前声明了迭代变量。

```
std::pair<std::string, TrailStep*> step;
BOOST_FOREACH(step, m_steps)
{
    SAFE_DELETE(step.second);
} 
```

但实际上，应该有更简单的方法。（用 D 代替？）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-08T18:45:21.477

您可以尝试这种超酷的方式来迭代地图、ptr 或其他方式： [https ://svn.boost.org/trac/boost/attachment/ticket/3469/foreach_field.hpp](https://svn.boost.org/trac/boost/attachment/ticket/3469/foreach_field.hpp)

```
// no typedef needed
BOOST_FOREACH_FIELD((int i)(const T& t), mymap)
   // do something with i or t instead of first/second 
```

我不确定它是否可以与模板参数一起使用，但也许您只是将它用于抽象。

# asp.net - 如何制作大型网站的原型？

> ID：461514
> 
> 赞同：2
> 
> 时间：2009-01-20T14:28:08.353
> 
> 标签：asp.net, prototyping

我正在重写一个基于 VB6 的大型应用程序。我们正在从 Windows 窗体迁移到使用 ASP .Net 的基于 Web 的部署。大约有 50 个核心用户，都是公司内部的。

我们需要一种有效的方法来尝试不同的设计，以研究网站的信息架构、工作流程和整体外观。理想情况下，原型看起来足够好，可以向用户展示以收集反馈。

一些 ajax 风格的下拉菜单或控件将有助于展示我们的想法，但不会以牺牲快速原型为代价。

打破 Visual Studio 感觉还为时过早，我们需要的不仅仅是笔和纸或 Visio……有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T14:30:28.707

杰夫阿特伍德不久前有一篇很好的文章：

[http://www.codinghorror.com/blog/archives/001091.html](http://www.codinghorror.com/blog/archives/001091.html)

我们在最后一个项目中使用了 Visio，虽然 Visio 文档屏幕看起来与最终结果几乎相同，但我建议不要制作像素完美的原型。简单的矩形和简单的着色更好，给设计者和网络开发者更多的自由。

在我们的案例中，一些屏幕是由不了解 Web 应用程序限制的人开发的。根据团队成员的不同，这可能会导致关于什么是可能的，什么是不可能的无休止的讨论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T14:36:28.553

你看过优秀的[Balsamiq](http://www.balsamiq.com/products/mockups/desktop)吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:18:01.520

我使用 JustProto.com - 它非常简单但运行速度非常快。我很遗憾没有现成的组件可供使用，但您可以创建自己的母版。

无论如何 - 我用 JP 做了一些原型，对我来说已经足够好了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T14:41:13.787

过去，我们使用整页图形——要么是我们设计团队的漂亮设计，要么只是 Visio/PowerPoint（不要问）模型——作为背景放入 HTML 页面，然后添加 ImageMap 链接并在其上放置一些动态控件顶部 - 下拉菜单、弹出/手风琴菜单等将它们中的大多数链接在一起。

这在与我们的用户进行 A/B 可用性测试时效果很好——有些人对漂亮的设计版本有点困惑，因为它们看起来更像是可用的网页，但他们很快就掌握了窍门。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-11T20:29:02.753

您可以使用 Balsamiq 模型，它是一款非常好的软件，并且易于用于原型制作，模型可以制作您需要的动态和复杂性，并且不是很贵，并且在线上有评估版和限量版。

如果你想要一个更复杂的软件，有组件和功能，你可以使用 Axure 是一个非常完整的原型设计软件，你可以在浏览器中导出和测试具有所有功能的原型，我邀请你去那里的官方页面可以找到例子。

Balsamiq 链接：[http ://balsamiq.com/products/mockups/](http://balsamiq.com/products/mockups/)

Axure 链接：[http ://www.axure.com/](http://www.axure.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-18T23:01:48.477

对于大型系统，您确实需要具有母版/模板的东西。SO上有两个很好的主题：

1.  有什么工具： [https ://stackoverflow.com/questions/156937/balsamiq-mockups-alternative-for-building-wireframes](https://stackoverflow.com/questions/156937/balsamiq-mockups-alternative-for-building-wireframes)

2.  为什么要使用模型工具而不是 IDE： [创建交互式应用程序原型的最佳方式是什么？](https://stackoverflow.com/questions/139555/whats-the-best-way-to-create-interactive-application-prototypes/17120734#17120734)

这是我所知道的最完整的模型工具列表： [http ://c2.com/cgi/wiki?GuiPrototypingTools](http://c2.com/cgi/wiki?GuiPrototypingTools)

（我是这个的作者：[MockupScreens](http://MockupScreens.com)）。

# unit-testing - .NET Framework 上的单元测试和 Web 测试？

> ID：461521
> 
> 赞同：0
> 
> 时间：2009-01-20T14:30:08.427
> 
> 标签：unit-testing, testing, csla

我想知道 .NET Framework 中的单元测试和 Web 测试是什么，这些测试有什么区别？它对 CSLA.NET 的实施有何影响？请帮忙，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T14:33:36.267

我猜你指的是在 Visual Studio 下使用 MSTest，它们有两种模式——代码测试或通过 http 调用测试网站。

在 .NET 中开发时，开发人员可以从多个单元测试框架中进行选择，例如 MSTest-NUnit、MBUnit、XUnit 等。有关更多信息，请查看[此问题](https://stackoverflow.com/questions/127687/favorite-net-unit-testing-framework)。

[单元测试这个词指的是一个更广泛的领域——你可以在这里](http://en.wikipedia.org/wiki/Unit_testing)阅读它。

单元测试是指程序员编写简单的小测试来验证他的代码确实可以工作，因此不会影响 CLSA.NET 的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T14:33:47.983

> 我想知道 .NET 中的单元测试和 Web 测试是什么

您的意思是，.NET 有哪些单元测试框架？我推荐你 NUnit

# svn - 在开发服务器上使用 Subversion 的最佳实践？

> ID：461527
> 
> 赞同：1
> 
> 时间：2009-01-20T14:30:51.343
> 
> 标签：svn, version-control

我在服务器上安装了 VisualSVN，用于“暂存”我编写的 Web 应用程序——目前这些应用程序是经典的 ASP/VBScript。我编写代码的开发工作站安装了 TortoiseSVN，我可以连接到我创建的存储库文件夹 - 我使用以下结构：

```
development (repository)
  -- my_application
     -- branches
     -- tags
     -- trunk
  -- another_application
     -- branches
     -- tags
     -- trunk 
```

我还配置了 IIS 并指向服务器硬盘驱动器上的另一个文件夹来存储提供的文件。是否有将提交推送到链接到 IIS 的文件夹的“最佳实践”，所以在提交/迭代之后，我可以给我的用户一个 URL 来查看演示站点（以及自己测试它）？我很惭愧地说我以前从未真正使用过版本控制，所以我对使用它的最佳方式有点不知所措。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T15:20:50.383

首先，我同意其他评论，您的存储库格式是由带有分支、标签和主干的书组成的。如前所述，我还建议按项目拆分存储库。我参与了具有一个共享存储库和拆分存储库的项目，并且拆分存储库工作得更好。另外，如果有任何理由限制对其中一个存储库的访问（即，您让其他人访问存储库，而您只希望他们看到两个项目之一）将它们分开会更容易。

无论如何，我建议您使用 MSBuild 进行部署。您可以创建一个从 SVN 签出的 MSBuild 项目文件，构建您的解决方案文件，然后将其部署到网站。您可以在您的 MSBuild 项目文件中添加这样的一行来进行检出：

``<`Exec command="svn checkout %22https://server:8443/svn/Project/Trunk/%22 %22c:\Project%22"/`>``

您还可以做一些事情，例如在发布版本后创建一个项目以检查特定版本/标签。沿着这条路线进行部署时，可以做的事情有很大的灵活性。

有关 MSBuild 的更多详细信息，您可以在[此处](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)找到 Microsoft MSBuild 参考指南。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T14:49:53.580

我可以看到您已经完成了作业，您的存储库布局是由本书设置的。我不确定 VisualSVN 在签出方面做了什么，但如果你想将更改推送到网站，很容易做到，无论是交互的还是计划的。

cd 到 webhome

svn co [svn-project-uri]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T14:55:39.250

首先，我建议您将不同的应用程序保存在不同的存储库中。

每次提交都会增加修订号，因此您可能会遇到下一种情况：第一个应用程序很长时间没有更新，但是由于第二个应用程序更新，它的修订号不断增加。

# c++ - 在 RegExp 中使用星号来提取由特定模式包围的数据

> ID：461535
> 
> 赞同：1
> 
> 时间：2009-01-20T14:32:11.620
> 
> 标签：c++, regex, qt4

我有一个文本，其中包含由某种模式包围的信息。我唯一知道的是模式： "${template.start}" 和 ${template.end} 为了简单起见，我将在例子。

所以文本中的一个条目是：

```
aINFORMATIONHEREa 
```

我不知道在文本中连接了多少这些条目。所以以下也是正确的：

```
aFOOOOOOaaASDADaaASDSDADa 
```

我想写一个正则表达式来提取由“a”包围的信息。

我的第一次尝试是：

```
a(.*)a 
```

只要文本中只有一个条目，它就可以工作。一旦有多个条目，它就会失败，因为`.*`匹配所有内容。因此，使用`a(.*)a`on`aFOOOOOOaaASDADaaASDSDADa`只会导致一个捕获组包含文本的第一个和最后一个字符之间的所有内容，即“a”：

```
FOOOOOOaaASDADaaASDSDAD 
```

我想得到的是

```
captureGroup(0):  aFOOOOOOaaASDADaaASDSDADa
captureGroup(1): FOOOOOO
captureGroup(2): ASDAD
captureGroup(3): ASDSDAD 
```

如果能够从文本中提取每个条目，并从每个条目中提取“a”之间的信息，那就太好了。顺便说一句，我正在使用 Qt4 的 QRegExp 类。

有什么提示吗？谢谢！马库斯

* * *

之前已经看到过这个问题的多种变体。各种相关讨论：

*   [正则表达式替换字符串中的所有 \n，但没有 [code] [/code] 标记内的那些](https://stackoverflow.com/questions/328387/regex-to-replace-all-n-in-a-string-but-no-those-inside-code-code-tag)
*   [使用正则表达式如何找到一个被其他两个模式包围的模式而不包括周围的字符串？](https://stackoverflow.com/questions/191704/using-regular-expressions-how-do-i-find-a-pattern-surrounded-by-two-other-pattern)
*   [使用 RegExp 匹配括号内的数字，然后将其递增](https://stackoverflow.com/questions/423107/use-regexp-to-match-a-parenthetical-number-then-increment-it)
*   [正则表达式用于在没有被单引号或双引号包围时使用空格分割字符串](https://stackoverflow.com/questions/366202/regex-for-splitting-a-string-using-space-when-not-surrounded-by-single-or-double)
*   [什么正则表达式将匹配文本，不包括 HTML 标记中的内容？](https://stackoverflow.com/questions/179779/what-regex-will-match-text-excluding-what-lies-within-html-tags)

可能还有其他人......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T14:35:35.030

只需使用非贪婪表达式，即：

```
a(.*?)a 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T14:39:29.733

您需要匹配以下内容：

```
a[^a]*a 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T15:08:36.307

您已经有几个可行的答案，但我会添加一些无偿的建议：

> **使用正则表达式进行解析是一条充满危险的道路**

**编辑：**为了不那么神秘：对于所有的力量、灵活性和优雅，正则表达式的表达能力不足以描述除了最简单的语法之外的任何内容。对于此处提出的问题，它们已经足够了，但如果输入语言变得更复杂，则不适合替代状态机或递归体面的解析器。

因此，选择使用 RE 来解析输入流是一个应该谨慎并着眼于未来的决定。

# asp.net-2.0 - 替代查询字符串 C# (asp.net)

> ID：461537
> 
> 赞同：1
> 
> 时间：2009-01-20T14:33:17.187
> 
> 标签：asp.net-2.0, c#-2.0, query-string

是否有一种快速而肮脏的方式来使用如下传递的查询：

domain.com/mypage.aspx/product/toycar/

我以前在 PHP 中做过，但这需要在页面中完成（在本例中）。

-- 我只能访问 aspx 页面和后面的代码，并且必须在 asp.net 2 中工作*（我希望我使用的是 3.5）*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T15:03:14.973

又快又脏：

```
public class ModuleRewriter : IHttpModule
{
    public void Init(HttpApplication application)
    {
        application.BeginRequest += (new EventHandler(this.Application_BeginRequest));
    }

    private void Application_BeginRequest(Object source, EventArgs e)
    {
        // The url will look like: http://domain.com/mypage.aspx/product/toycar/ 
        // The module will rewrite it to: http://domain.com/mypage.aspx?product=toycar

        HttpApplication application = source as HttpApplication;
        string[] urlInfo = application.Request.RawUrl.ToString().Split('/');
        if (urlInfo.Length > 2)
        {
            string page = urlInfo[urlInfo.Length - 3];
            string action = urlInfo[urlInfo.Length - 2];
            string id = urlInfo[urlInfo.Length - 1];
            if (string.IsNullOrEmpty(page))
            {
                page = "default.aspx";
            }
            application.Server.Transfer(string.Format(
                "~/{0}?{1}={2}", page, action, id));
        }
    }

    public void Dispose()
    {
    }
} 
```

网络配置：

```
<httpModules>
    <add name="ModuleRewriter" type="ModuleRewriter, MyWebApplication"/>
</httpModules> 
```

和一个测试页：

```
<%@ Page Language="C#" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <%= Request["product"] %>    
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:43:09.977

您可能想查看 ASP.NET System.Web.Routing 命名空间，我相信它是在 .NET 3.5 SP1 中添加的：

[http://blogs.msdn.com/mikeormond/archive/2008/05/14/using-asp-net-routing-independent-of-mvc.aspx](http://blogs.msdn.com/mikeormond/archive/2008/05/14/using-asp-net-routing-independent-of-mvc.aspx)

[http://msdn.microsoft.com/en-us/library/system.web.routing.aspx](http://msdn.microsoft.com/en-us/library/system.web.routing.aspx)

您也可以摆脱 .aspx 扩展名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T14:43:27.103

这将涉及制作自定义 HTTP 处理程序。

检查[这个](http://msdn.microsoft.com/en-us/library/ms972974.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T14:48:31.620

如果您只想从 .aspx 中读取路径：

Request.ServerVariables["PATH_INFO"]

澄清：

他只能访问aspx（+代码隐藏）本身，所以他必须知道查询是如何的，但由于格式原因，它不在Request.QueryString中。所以唯一的方法是 Request.ServerVariables["PATH_INFO"] (Request.RawUrl)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T15:13:11.927

您有几个选项，但所有选项都需要访问 web.config 并更改 IIS 以将所有文件扩展名映射到 dotNet ISAPI dll：

1.  使用 MVC（就像 stackoverflow 一样，注意 url）
2.  使用 asp.net 路由（3.5 新增）
3.  在这里编写您自己的 http 处理程序[来自 Microsoft 的大量指南](http://msdn.microsoft.com/en-us/library/ms972974.aspx)
4.  使用优秀的[urlrewriting.net](http://www.urlrewriting.net)，它几乎可以完美地完成所有事情，包括解决一些尴尬的身份验证和图像路径问题。

我个人使用 urlrewriting.net 效果很好。

既然你提到除了背后的代码和页面之外你无权访问任何东西，我唯一能想到的就是创建这些目录（如果你有权这样做）并使用 server.transfer 页面传递值到您上面文件夹中的实际页面。凌乱，但如果你不能访问其他的东西，你的选择是有限的。

# computer-science - 理论计算机科学主题有“现实世界”的开发应用吗？

> ID：461539
> 
> 赞同：19
> 
> 时间：2009-01-20T14:33:21.523
> 
> 标签：computer-science, theory

通过“理论计算机科学主题”，我指的是诸如常规语言与非常规语言、抽引引理和语法之类的东西。

我熟悉有限自动机和正则表达式在现实世界中的应用，但是诸如此类的其他主题给我带来了更多问题，因为我没有看到任何现实世界的应用。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-20T14:36:03.250

如果您想知道尝试做某事是否对正则表达式无效，这些东西很有用。例如，如果您想到使用正则表达式解析 XML 的想法，那么知道 XML 是非常规的会很有用。而且，如果您不知道 XML 是非常规的，那么抽水引理会让您简单地证明它。

然后是编译器，如果你不知道这些东西，你就完蛋了。这仅取决于应用程序。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-20T14:46:29.890

以下是[Steve Yegge](http://steve-yegge.blogspot.com/2007/06/rich-programmer-food.html)对编译器有用性的看法，总结如下：

> 事实上，编译器构建，在我自己的谦虚和可能令人尴尬的错误观点中，是你可以在本科计算机科学课程中学习的第二重要的 CS 课程。

语法对于解析递归结构是必不可少的，递归结构出现在编程语言、自然语言和复杂的数据结构中。我相信有些程序员根本不认识他们，但是编写编译器、IDE、序列化等的人却经常认识他们。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T04:26:41.093

正如 Yuval F 所指出的，语法对于语言解析至关重要。如果您看一下解析器生成器，例如 ANTLR，您会发现语法结构与您在学校学到的惊人地相似。

# java - 作为 Windows 服务启动的 Java 应用程序的远程调试

> ID：461544
> 
> 赞同：4
> 
> 时间：2009-01-20T14:34:09.213
> 
> 标签：java, windows-services, remote-debugging

我的 Java 应用程序是通过 java.dll 从本机程序中启动的。此本机程序在 Windows 上作为服务启动。

以下选项已添加到 JVM 参数中以进行远程调试：

```
-Xdebug -Xnoagent -Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=n 
```

在此配置中，无法从例如我的 Eclipse 工作区进行连接。如果程序是从命令行启动的，即不是作为服务，我可以连接到端口 8787。

如何允许远程调试连接到该服务？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T14:37:11.173

如果它作为服务运行或从命令行运行，则没有区别。

请仔细检查 java.exe 在作为服务启动时是否接收到这些命令行参数。

# php - 插入mysql问题

> ID：461555
> 
> 赞同：0
> 
> 时间：2009-01-20T14:36:37.947
> 
> 标签：php

我在表 opt 中有一个名为确认类型为 tinyint 的字段。我想通过这个语句插入值（1），但它不起作用，任何人都可以帮忙吗？

```
$connect= mysql_connect("localhost","root") or die ("Sorry, Can not connect to database");

mysql_select_db("login") or die (mysql_error());

$user=$_POST['staff'];
echo $user;

$query="SELECT  * from users where username='$user' ";
$result=mysql_query($query,$connect) or die(mysql_error());
$row=mysql_fetch_array($result);

$uid=$row['userid'];
echo $uid;

$query="SELECT  * from opt where userid='$uid' ";
$result=mysql_query($query,$connect) or die(mysql_error());
$row=mysql_fetch_array($result);

if($row['confirm']==0)
{

$query = "INSERT INTO opt (confirm) values(1)";
echo 'The user selected options has confirmed';

}
?> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T14:38:47.067

您没有执行查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T14:48:09.293

添加一个额外的

$result=mysql_query($query,$connect) 或 die(mysql_error());

行后

$query = "INSERT INTO opt (confirm) values(1)";

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T14:42:04.893

$query 是一个变量，它不会导致记录神奇地插入到 opt 表中。

您需要在 $query = "..." 之后插入以下行：

```
mysql_query($query); 
```

另外，我希望这不是您在生产中运行的代码。

您需要在某处拥有以下内容：

```
$user = mysql_real_escape_string($user); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T14:50:22.427

除了不执行“插入语句”之外，

您可能应该使用

```
“UPDATE OPT SET CONFIRM = '1' WHERE USERID = $user;”

```

因为该行已经存在（因为您设法选择了它！）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T18:29:22.127

为什么不工作？抛出什么错误？

检查表的其他字段...

# .net - 使用服务器激活对象使用 .NET Remoting 时，SingleCall 和 Singleton 激活之间的权衡是什么？

> ID：461569
> 
> 赞同：1
> 
> 时间：2009-01-20T14:41:28.717
> 
> 标签：.net, remoting

在使用 .NET Remoting 实现服务器以托管对象时，我试图辨别 SingleCall 和 Singleton 激活方法之间的区别。看起来 SingleCall 具有必须为每个客户端调用构造和清理对象的开销，而 Singleton 具有只能为有限数量的同时请求提供服务的限制。我希望使性能尽可能好。我应该选择哪个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T14:51:56.027

你说的对。SingleCall 为每个调用构建对象，并且可以接受多个同时请求，但数据不能在调用之间共享，而 Singleton 构建单个对象来处理多个调用，允许数据共享，但限制同时连接。但是，如果您对如何构建线程安全对象有一些概念，则可以进行一些调整。

首先，我建议使用 Singleton，因为它只为多次创建一次。这还具有允许您存储信息并在连接到它的用户之间共享信息的优势，而无需经常访问外部商店。

其次，我会考虑将 ConcurrencyMode=ConcurrencyMode.Multiple 添加到您的服务的 ServiceBehaviors 中。这允许多个用户同时点击你的单例。

```
[ServiceBehavior(ConcurrencyMode=ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.Single)] 
public class CalculatorService : ICalculatorConcurrency 
{ 
    …
} 
```

第三，清理任何会使这个类不是线程安全的代码。当访问多个线程可以同时访问的局部变量时，您应该锁定对象。

可以在这里找到很多关于这些主题的好信息：

[http://msdn.microsoft.com/en-us/library/ms731193.aspx](http://msdn.microsoft.com/en-us/library/ms731193.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T14:46:21.653

默认情况下，您应该使用 SingleCall。

另外，请记住，在使用 SingleCall 对象时，您不能在调用之间共享状态。

当谈到 .NET 远程处理时，我发现这个站点是一个很好的资源： [http ://www.thinktecture.com/resourcearchive/net-remoting-faq/remotingusecases](http://www.thinktecture.com/resourcearchive/net-remoting-faq/remotingusecases)

# c++ - C++ 的持久性解决方案（带有 SQL 数据库）？

> ID：461580
> 
> 赞同：8
> 
> 时间：2009-01-20T14:43:42.533
> 
> 标签：c++, sql, database, frameworks, persistence

我想知道带有 SQL 数据库的 C++ 有什么样的持久性解决方案？除了使用自定义 SQL 做事（以及封装对 DAO 的数据访问或类似的东西）之外，还有其他一些（更通用的）解决方案吗？

像一些通用库或框架（比如 Hibernate & co for Java 和 .NET）或其他东西？（我还没想到的也欢迎提出建议）

编辑：是的，我正在寻找更多的 ORM 解决方案或类似的东西来处理 sql 查询以及表和对象之间的关系，而不是数据库引擎本身。无论如何，感谢所有的答案！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T14:56:34.893

[SQLite](http://www.sqlite.org/)很棒：它快速、稳定、经过验证、易于使用和集成。

还有[Metakit](http://www.equi4.com/metakit/)，虽然学习曲线有点陡峭。但我在一个专业项目中成功地使用了它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T17:57:39.350

听起来您正在寻找一些 ORM，这样您就不必费心手写 SQL 代码。

[这里](https://stackoverflow.com/questions/74141/good-orm-for-c-solutions)有一篇文章介绍了 C++ 的 ORM 解决方案。

您也没有提到您正在编写的应用程序类型，如果它是桌面应用程序、移动应用程序、服务器应用程序。

移动：最好使用 SQLite 作为数据库引擎，因为它可以嵌入并且占用空间小。

桌面应用程序：您仍然应该考虑在此处使用 SQLite，但您也可以选择大多数桌面应用程序始终连接到 Internet，在这种情况下，您可能需要为此任务提供网络服务器。我建议使用 Apache + MySQL + PHP 并使用轻量级 ORM，例如[Outlet ORM](http://www.outlet-orm.org/site/)，然后使用标准 HTTP post 调用来访问您的资源。

服务器应用程序：您在这里有更多选择，但我仍然建议使用 Apache + MySQL + PHP + ORM，因为我发现用脚本语言维护这一层比用 C++ 容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T08:23:44.043

MySQL Connector/C++ 是 JDBC 4.0 的 C++ 实现

使用 MySQL Connector/C++ 的参考客户有： - OpenOffice - MySQL Workbench

了解更多： http: [//forums.mysql.com/read.php?167,221298](http://forums.mysql.com/read.php?167,221298)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T05:50:49.117

SQLite + Hiberlite 是一个不错且有前途的项目。虽然我希望看到它更积极地发展。见 http://code.google.com/p/hiberlite/

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T04:43:52.133

我使用 MYSQL 或 SQLite。

MYSQL：提供您的应用程序必须动态连接到的基于服务器的数据库。
SQLite：提供内存或文件数据库。

使用内存数据库对于快速开发很有用，因为仅为单个项目设置和配置数据库服务器是一项艰巨的任务。但是，一旦您启动并运行了数据库服务器，就很容易提起诉讼。

在内存中，数据库对于保存小型数据库（例如配置等）很有用。而对于较大的数据集，数据库服务器可能更实用。

从这里下载： [http](http://dev.mysql.com/)
://dev.mysql.com/ 从这里下载： [http ://www.sqlite.org/](http://www.sqlite.org/)

# java - 持续集成：使测试数据库模式保持最新

> ID：461581
> 
> 赞同：12
> 
> 时间：2009-01-20T14:43:51.283
> 
> 标签：java, unit-testing, continuous-integration, hudson

我正在设置一个持续集成服务器 (Hudson) 来构建一个 Java 项目并运行相关的单元/集成测试。这些测试中的大多数都访问数据库，并且测试数据保存在 DbUnit XML 文件中。

我正在寻找一种自动保持测试数据库模式最新的方法。当前，特定发行版的 SQL 脚本存储在以发行版命名的目录中：

```
└───scripts
    ├───0.1.0
    ├───0.1.1
    ├───0.1.2
    ├───0.1.4 
```

例如，版本 0.1.4 的 SQL 脚本是

```
scripts\0.1.4\script-0.1.4.sql 
```

问题是这些脚本包含模式更改（例如 ALTER TABLE...）和静态表更改（例如向 USER_TYPE 表添加新角色）的混合。

在单元测试的情况下，我只想应用架构更改，因为如上所述，单元测试的所有数据都保存在 DbUnit XML 文件中。尽管我可以将这两种类型的数据库更改分离到不同的文件中，但架构更改和数据更改之间通常存在依赖关系，当发布应用于 QA、生产等时，需要以某种方式强制执行。

无论如何，这只是询问是否有人提出了一种强大的方法来自动保持他们的测试模式最新的一种非常冗长的方式？我知道[Unitils](http://www.unitils.org/summary.html)对保持测试模式保持最新有一些支持，但我不确定它是否可以“忽略”SQL 增量脚本中的数据更新语句。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-11T22:12:45.890

之前的一张海报将 Liquibase 列为一个选项，但是他们没有提到 Liquibase 定义在特定上下文中运行的规则的能力（[Liquibase](http://www.liquibase.org/manual/contexts)中的上下文）。这允许您将架构更新不标记为任何特定上下文，并将单元测试的固定装置标记为`test`. 这样，只有在您运行单元测试时才会插入固定装置。

以下是包含架构和固定装置的 Liquibase 更改集示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9 http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">
  <changeSet author="avalade" id="1">
    <createTable tableName="users">
      <column autoIncrement="true" name="id" type="long">
        <constraints nullable="false" primaryKey="true" />
      </column>
      <column name="email" type="varchar(255)" />
    </createTable>
  </changeSet>
  <changeSet author="avalade" id="2" context="test">
    <insert tableName="user">
      <column name="id" value="1" />
      <column name="email" value="test@test.com" />
    </insert>
  </changeSet>
</databaseChangeLog> 
```

然后，如果您使用 Spring 来管理您的 DAO，您可以将以下内容放入您正在部署的应用程序上下文文件中：

```
<bean id="liquibase" class="liquibase.spring.SpringLiquibase">
  <property name="dataSource" ref="dataSource" />
  <property name="changeLog" value="classpath:dbChangelog.xml" />
</bean> 
```

对于您在单元测试中使用的应用程序上下文文件，请使用附加上下文属性配置 Liquibase：

```
<bean id="liquibase" class="liquibase.spring.SpringLiquibase">
  <property name="dataSource" ref="dataSource" />
  <property name="changeLog" value="classpath:dbChangelog.xml" />
  <property name="contexts" value="test" />
</bean> 
```

这样，您可以将所有数据库定义放在一个地方，并且仅在运行测试代码时插入您的固定装置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T15:03:25.597

我们发现管理实时/测试数据库模式逐渐演变的最易于管理的方法是使用像[Liquibase这样的模式迁移管理工具](http://www.liquibase.org/)

这允许我们以一致的方式将最新的模式更改应用于我们选择、测试或其他方式的任何环境，然后允许我们针对最新模式运行我们希望的任何类型的自动化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T16:26:09.207

我目前使用类似的方法。我一直在研究数据库迁移工具，但没有找到解决您描述的问题的工具。

问题是，有时模式更改需要更改数据以允许创建新的约束等......在这种情况下，如果忽略数据更新语句，迁移将失败。

将删除数据库中所有数据的 sql 脚本添加到您的测试套件对您有用吗？

所以这个过程是：

1.  运行数据库迁移。
2.  运行脚本以删除数据库中的所有数据。
3.  加载测试数据
4.  运行测试

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T15:00:12.827

我在测试中做了什么：

*   我在某处保留了数据库版本
*   在第一个测试中，我拆除了整个数据库并从头开始构建它
*   我在单独的测试中运行每个模式更新
*   我将“更新数据库”模块作为单独的测试运行（不能做任何事情，因为所有更改都已应用）。或者，我再次拆除数据库并运行一次。
*   我将测试数据加载到数据库中（如果它们修复数据错误，上面的一些测试会这样做）。

现在，测试数据库已准备好进行“真实”（应用程序）测试。在每个应用程序测试之后，我回滚当前事务，以便测试数据库在设置后永远不会更改。

为了使测试更快，我通常有三个测试套件：一个包含数据库设置，一个仅包含应用程序测试，另一个包含其他两个套件。这使我可以快速重置测试数据库并从应用程序套件运行单个测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T15:33:00.827

我使用[migrateDB](http://migratedb.sourceforge.net/)来管理这个问题。

该工具基于这样一种概念，即您可以（通过 SQL）在数据库上执行“测试”以查看是否应用了给定的数据库更改，以及在测试“失败”时执行的相关操作集。例如，您可能需要查询元表模式以查看表或列是否存在，如果不存在，则创建它。或者，您可能想查看表中是否存在某一行，如果不存在，则插入它。它带有一些预先配置的常见测试和操作，并且很容易添加您自己的（仅使用 XML 配置 - 不需要新代码来执行此操作。）

作为一个小奖励，这些测试和操作中的每一个都是为 SQL 的每个“方言”配置的（例如，您可以有一个“oracle”方言和一个“mySQL”方言。）这意味着一旦你定义了查询对于每种方言的给定测试和操作，测试或操作的每个新实例都不需要新的 SQL，并且可以针对多个目标数据库执行。

然后，您只需维护一个列出测试和相应操作的小型 XML 文件，并在每次构建后针对您的数据库运行该工具。

它对我们来说效果很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-26T16:52:19.457

这是我们所做的：

```
$ find src/sql/ | grep -v /.svn
src/sql/
src/sql/0000-system.sql
src/sql/0000-system.sql.dev.log
src/sql/0000-system.sql.prod.log
src/sql/0000-system.sql.test.log
src/sql/0001-usgn.sql
src/sql/0001-usgn.sql.dev.log
src/sql/0001-usgn.sql.prod.log
src/sql/0001-usgn.sql.test.log
src/sql/0002-usgn.sql
src/sql/0002-usgn.sql.dev.log
src/sql/0002-usgn.sql.prod.log
src/sql/0002-usgn.sql.test.log
src/sql/0003-usgn.sql
src/sql/0003-usgn.sql.dev.log
src/sql/0003-usgn.sql.prod.log
src/sql/0003-usgn.sql.test.log
src/sql/0004-system.sql
src/sql/0004-system.sql.dev.log
src/sql/0005-usgn.sql
src/sql/purge.sql 
```

我们有scriptseq###-databaseusercredential.sql

现在我们的测试，总是允许数据库中数据的未知起始状态。如果您不能这样做，那么我建议您使用 SEQ-CRED-TYPE.sql，其中类型为 dml / ddl 并过滤掉 dml 脚本。

# c# - .net 应用程序在内存中的大小

> ID：461582
> 
> 赞同：3
> 
> 时间：2009-01-20T14:43:56.870
> 
> 标签：c#, .net, winforms, memory-management

有什么方法可以减少我的应用程序在 RAM 中占用的内存量？..因为即使是 30kb 的应用程序也会加载大约 20Mb 的“不需要”的 dll。当我认为任何 .NET 应用程序在工作集中至少需要 10Mb 时，我是不是误会了当我们需要一个包含文本的表单时记忆？找不到任何解释:(

PS问题已关闭。但我建议所有对 CLR 工作原理感兴趣的人阅读以下内容：[CLR via C#](https://rads.stackoverflow.com/amzn/click/com/0735621632)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T14:46:12.700

第一个 .NET 应用程序启动需要大量内存来加载大量 .NET 内部数据，但此应用程序或另一个应用程序的所有其他启动将花费更少的内存。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T14:48:44.863

我发现[这篇文章](http://www.itwriting.com/dotnetmem.php)很有帮助。

# c# - 使用强类型 XSD 反序列化 XML 文档时出错

> ID：461584
> 
> 赞同：2
> 
> 时间：2009-01-20T14:44:10.583
> 
> 标签：c#, xml, xsd, serialization

我在尝试使用 XmlSerializer.Deserialize() 方法反序列化特定 XML 文档时遇到了一个非常烦人的问题。

基本上，我有一个带有 double 类型元素的强类型 XSD。当尝试反序列化特定 XML 文档的元素时，我得到通常的“System.FormatException：输入字符串格式不正确”。例外，因为在该特定文档中，该元素没有值。

这是给那些书呆子的一些代码。

**示例 XML 文档：**

```
<TrackInfo>
  <Name>Barcelona</Name>
  <Length>4591</Length>
  <AverageSpeed />
</TrackInfo> 
```

**XSD：**

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
<xs:element name="TrackInfo">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="Name" type="xs:string" />
      <xs:element name="Length" type="xs:double" default="0.0" />
      <xs:element name="AverageSpeed" type="xs:double" default="0.0" />
    </xs:sequence>
  </xs:complexType>
</xs:element> 
```

**TrackInfo 类：**

```
[Serializable]
public class TrackInfo
{
  private string name = string.Empty;
  private double length = 0.0;
  private double averageSpeed = 0.0;

  [XmlElement]
  public string Name
  { ... }

  [XmlElement]
  public double Length
  { ... }

  [XmlElement]
  public double AverageSpeed
  { ... }
} 
```

**示例反序列化代码：**

```
XmlDocument xmlDocument = new XmlDocument();
xmlDocument.Load("TrackInfo.xml");

// Deserialise XML string into TrackInfo object
byte[] buffer = ASCIIEncoding.UTF8.GetBytes(xmlDocument.InnerXml);
MemoryStream stream = new MemoryStream(buffer);
System.Xml.XmlReader reader = new System.Xml.XmlTextReader(stream);

XmlSerializer xSerializer = new System.Xml.Serialization.XmlSerializer(typeof(TrackInfo));
TrackInfo trackInfo = (TrackInfo)xSerializer.Deserialize(reader); 
```

我知道反序列化异常来自空字符串无法转换为双精度的事实。我也知道默认值没有分配给 AverageSpeed，因为实际上空字符串是一个完全可以接受的值。

如果在 XML 文档中找到空字符串值，是否有一种简单的方法可以在反序列化时将双精度值默认为 0.0（或任何其他类型）？理想情况下，我想避免实现 ISerializable，因为我真的不想把剩下的时间花在地狱的燃烧坑中（即为大约一百个类实现 ISerializable）。

干杯! 让-米歇尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T15:22:17.993

查看有关 DefaultValueAttribute 的 MSDN 文档：http: [//msdn.microsoft.com/en-us/library/system.componentmodel.defaultvalueattribute.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.defaultvalueattribute.aspx)

> **注意：** DefaultValueAttribute 不会导致成员使用属性值自动初始化。您必须在代码中设置初始值。

我认为字段初始化将始终优先于 DefaultValueAttribute 值。无论如何，这似乎正是我想要的。

非常感谢你塞巴斯蒂安！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:54:15.977

一种可能的解决方案是使用*双重？*（带有问号，或 Nullable<double>）。这允许您的值类型存储空值，并且反序列化器不会阻塞空值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T15:02:50.560

您可以指定默认值，例如

```
 [XmlElement]
    [System.ComponentModel.DefaultValueAttribute(0.0)]
    public double AverageSpeed
    { ... } 
```

/edit：好的，这里有奇怪的行为。无论我在属性中设置什么值，它始终是字段值：

```
private double averageSpeed = 2.0; 
```

但没有异常发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T14:53:38.817

您可以编辑架构以指定 AverageSpeed 值不可为空。当然，这要求生成 XML 的任何东西实际上都遵循模式。

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
<xs:element name="TrackInfo">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="Name" type="xs:string" />
      <xs:element name="Length" type="xs:double" default="0.0" />
      <xs:element name="AverageSpeed" type="xs:double" default="0.0" nillable="false" />
    </xs:sequence>
  </xs:complexType>
</xs:element> 
```

# sql-server - 在 SQLServer 中是否有一个 DMV 来获取对象的依赖关系？

> ID：461593
> 
> 赞同：0
> 
> 时间：2009-01-20T14:46:14.587
> 
> 标签：sql-server, metadata

我正在寻找可以让我获得与选择“查看依赖项”+“[some_table] 所依赖的对象”时显示的信息相同的信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T14:52:05.247

不不准确，看看你是否依赖我不久前写的[sp_depends （不是双关语）](http://sqlblog.com/blogs/denis_gobo/archive/2008/05/06/6653.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-16T20:21:31.860

如果您使用的是 SQL Server 2008，那么下面的一段 SQL 将显示所有依赖于 DBO 架构中 FUND 表的对象。

SELECT QUOTENAME(S2.name) + N'.' + QUOTENAME(O2.name) 作为参考对象，

```
 QUOTENAME(S.name) + N'.' + QUOTENAME(O.name) AS ReferencedObject, 

SED.referenced_server_name, SED.referenced_database_name, 

SED.referenced_schema_name, SED.referenced_entity_name 
```

FROM sys.objects AS O

INNER JOIN sys.schema AS S ON S.schema_id=O.schema_id

INNER JOIN sys.sql_expression_dependencies SED ON SED.referenced_id=O.object_id

INNER JOIN sys.objects O2 ON O2.object_id=SED.referencing_id

INNER JOIN sys.schema S2 ON S2.schema_id=O2.schema_id

其中 O.name='FUND' AND S.name='DBO'

请注意，从这个 DMV 返回的信息不应被视为 100% 准确 - 如果您真的需要获得准确的信息，那么 Red-Gate 的 SQL 依赖跟踪器或 ApexSQL 的 Doc 产品都相当不错。

# multithreading - 多线程代码 - 强制执行顺序

> ID：461595
> 
> 赞同：3
> 
> 时间：2009-01-20T14:46:26.443
> 
> 标签：multithreading, locking

我有一些将从两个线程访问的代码：

```
 class Timer{
public:
   void Start(){
      start_ = clock_->GetCurrentTime();
      running_ = true;
   }

   void Read(){
      if(running_){
         time_duration remaining = clock_->GetCurrentTime() - start_;
         Actions(remaining)
      }
   }

private:
   void Actions(time_duration remaining);
   time start_;
   bool running;
}; 
```

我查看了各种库中可用的其他一些计时器，但没有找到任何符合我要求的计时器，因此我正在滚动自己的......

Start() 方法从一个线程调用（仅一次）。Read() 方法从另一个线程被非常快速地调用，调用将在 Start() 被调用之前开始进入。

显然，在设置 running_ 标志*之前*初始化 start_ 变量是非常重要的。这可以通过添加一个互斥体来解决，该互斥体在输入 Start() 方法时被抓取......并且在在 Read() 方法中检查 running_ 之前被抓取......但这似乎有点不必要。如果这里的一切都按顺序执行，那么就没有问题。当另一个线程在 Start() 路由中时可能会发生 Read() ，例如从时钟中获取时间……Read() 发生得足够快以至于它只是不是大不了。

无论如何，我一直在寻找一种方法来确保编译器/处理器将执行

```
 start_ = clock_->GetCurrentTime();
  running_ = true; 
```

按上面列出的顺序进行说明。（或者如果我忽略了别的东西）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T14:52:47.833

你需要做 start_ 和 running_ `volatile`，然后在`Start()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T14:56:47.093

Why not get rid of the "running" flag and use whether the "start" variable is empty as the condition? You don't specify a language but some sort of volatile marker for "start" would be a good idea too. This also assumes that "start" can be written atomically. For example:

```
class Timer{
public:   
  void Start(){
    start_ = clock_->GetCurrentTime(); 
  }
  void Read(){
  if(nullptr != start_){
     time_duration remaining = clock_->GetCurrentTime() - start_;
     Actions(remaining)      
  }   
}
private:   
  void Actions(time_duration remaining);
  volatile time start_;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T14:52:09.177

我不确定我是否理解您的问题，但我认为您想防止在尚未设置 Start 方法（或尚未完全执行）时执行 Read ？

如果是这种情况，您不能通过使用 AutoResetEvent 或 ManualResetEvent 来解决您的问题（取决于您想要的行为）。

在 Read 方法中，您可以指定 Read 方法在 Auto/ManualResetEvent 尚未设置时等待，并在 Start 方法结束时设置 Event。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T14:55:55.097

为什么不只是坚持一个

```
if (_running == false) 开始();

```

在 Read() 方法中。并且要么使用互斥锁保护开始，要么将其定义为“关键”以确保其单线程。

# asp.net - 生成的 Webresource.axd 参数无效

> ID：461605
> 
> 赞同：14
> 
> 时间：2009-01-20T14:48:59.480
> 
> 标签：asp.net, webresource.axd, invalid-url

原始问题：

我们在生成 WebResource.axd url 时遇到了一个奇怪的错误。（这似乎与相当常见的“WebRsource.axd 填充无效且无法删除”问题无关）。

我们有一个 ASP.NET 网页，它在创建时会添加对 WebResource.axd 的脚本引用。

在这种情况下，我们看到 WebResource.axd 链接偶尔会在某个时间点变成垃圾，取而代之的是看起来像 javascript 的内容。更糟糕的是，url 生成失败似乎并不一致。

在我们的例子中，链接应该（并且通常*看起来*像）：

```
/WebResource.axd?d=D-wd7RbHCvSp_p0mHAmE4g2&amp;t=633464867255568315 
```

一切都很好。但是，我们收到用户记录的错误......他们尝试访问的 url 看起来像（在一种情况下）：

```
/WebResource.axd?d=D-wd7RbHCvS/../../images/icons/Ico_resize.gif')}}function%20ShowFilter_Manufacturer(){var%20div....... 
```

[该链接中剩余的编码 javascript 已被删除，因为不相关]

更奇怪的是，我们从同一个用户那里快速连续地获得了其中的一些，显然他正试图重新加载页面......每个 url 略有不同。

```
/WebResource.axd?d=D-wd7RbHCvS<garbage>
/WebResource.axd?d=D-wd7RbHCvSp<garbage>
/WebResource.axd?d=D-wd7RbHCvSp_<garbage> 
```

在某些情况下，垃圾是用 JavaScript 编码的，我看到了 url 的一部分……完全为空的参数字符串……我没有看到明显的模式。

顺便说一句，如果它是相关的，应该注意的是，我不相信这个 WebResource 不是股票 WebResource 之外的任何东西，当页面上包含某些功能时，.NET 会自动包含它......在这种情况下，一个字段验证器。查看实际 WebResource.axd 的内容会发现一组看起来非常标准的 Javascript 函数，这些函数似乎旨在处理通用 .NET 事件。不是我们创造的任何东西。

有没有人见过这样的事情？（或者更好的是，有没有人理解为什么会发生这种情况，并想出一种方法来消除它？）

**编辑 0：**一些附加信息：

第 1 项：针对一个答案，我们确保我们的脚本用 CDATA 标记封装，因为我们的 doctype 是 xhtml 过渡：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

不幸的是，虽然我们寄予厚望，但它似乎并没有解决问题。我们在 IE 8 作为浏览器时更经常注意到这一点，这会让人相信这是与浏览器相关的想法......也许是浏览器解析流的方式......但是为什么我们会得到微妙的不同响应在随后的尝试中让我感到困惑。

第 2 项：事实证明，省略的部分似乎是相当规则大小的块。有人报告说他看到 1k 或 4k 块丢失，我（到目前为止……我只看过两个案例）会同意（我的都丢失了 4096 字节的数据）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T15:03:11.583

根据这篇文章：

[http://bytes.com/topic/asp-net/answers/861764-invalid-viewstate-system-string-decryptstringwithiv](http://bytes.com/topic/asp-net/answers/861764-invalid-viewstate-system-string-decryptstringwithiv)

似乎问题是由于未指定文档类型时浏览器呈现页面的方式不同引起的。

这是我在这个主题上发现的另一篇有趣的帖子，但仍然不是解决方案：

[http://blog.aproductofsociety.org/?p=11](http://blog.aproductofsociety.org/?p=11)

在上面的页面上，它在评论中有“Response.Cache.SetNoStore()”作为可能的解决方案，我接下来会试试这个，看看它是否有帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-06T13:48:55.127

微软已对此问题作出回应：

注意是 Internet Explorer 8 中的一个错误。Internet Explorer 团队一直在调查此问题。

-=影响=- 到目前为止，我们认为该问题不会影响最终用户使用 Web 应用程序的体验；唯一的负面影响是 JavaScript 推测下载引擎发送的虚假/格式错误的请求。当解析器实际需要该脚本时，将在那时正确下载和使用该脚本。

-=Circumstances=- 虚假请求似乎仅在某些时间情况下发生，仅当包含带有 CHARSET 指令的 Content-Type 的 META HTTP-EQUIV 标记出现在文档中时，并且仅当 JavaScript SRC URL 跨越第 4096 个时HTTP 响应正文的字节。

-=Workaround=- 因此，我们目前认为可以通过使用 HTTP Content-Type 标头声明页面的 CHARSET 而不是在页面中指定它来缓解此问题。

所以，而不是把

[META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"]

相反，在您的 head 标记中，发送以下 HTTP 响应标头：

内容类型：文本/html；字符集=utf-8

请注意，HTTP 标头中的字符集规范会提高所有浏览器的性能，因为浏览器的解析器在遇到字符集声明时无需从头重新开始解析。此外，使用 HTTP 标头有助于缓解某些 XSS 攻击向量。

注意：有报道称，当 META HTTP-EQUIV 不在页面上时，仍然会发生此问题。当我们进行更多调查时，我们将更新此评论。Microsoft 于 2009 年 6 月 30 日下午 12:25 发布

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-05T19:15:47.737

我来自 ASP.NET 团队——我们正在寻找愿意与我们合作研究此问题的客户。如果有人能够通过请求自己的页面和检查日志来可靠地重现问题，并且愿意与我们的支持小组合作，请回复或直接给我发送消息。谢谢！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T07:02:54.303

您正在针对哪个版本的 .NET 进行编译？如果您将构建更改为针对较旧或较新版本构建会发生什么？（不确定这是否会做任何事情，但值得一试）

[如果它仍然发生，我认为你应该在Microsoft Connect](http://connect.microsoft.com/)上发布一个关于它的错误。他们应该很快就会回到你身边。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T08:25:32.797

您是否有任何在 Web 配置中注册的 HttpHandlers 或 Modules 在将呈现的 HTML 发送给用户之前对其进行修改？

这些通常可以是：

*   缩小 JS 和 CSS
*   确保 HTML 有效

也许值得一瞧。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-27T00:31:42.073

这是一篇旧帖子......但我通过谷歌搜索发现并提醒我这个......

[http://www.troyhunt.com/2010/09/fear-uncertainty-and-and-padding-oracle.html](http://www.troyhunt.com/2010/09/fear-uncertainty-and-and-padding-oracle.html)

会不会有关系？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-01T21:47:26.277

微软最终修复了这个问题：

[http://blogs.msdn.com/b/ieinternals/archive/2010/04/01/ie8-lookahead-downloader-fixed.aspx](http://blogs.msdn.com/b/ieinternals/archive/2010/04/01/ie8-lookahead-downloader-fixed.aspx)

# linq-to-sql - 使用 Linq to SQL 和 Sql Reporting Services

> ID：461609
> 
> 赞同：11
> 
> 时间：2009-01-20T14:51:10.927
> 
> 标签：linq-to-sql, reporting-services

我有一个关于集成使用 Linq To Sql 开发的业务对象进行数据查询和与 Sql Server Reporting Services 集成的问题。

我们有一组业务对象查询使用 Linq to SQL 开发的几个后端数据库。生成的 SQL 是相对动态的（基于用户选择的条件）并且涉及多个连接，一些内部连接，一些外部连接等。Linq to SQL 非常适合这一点。但是，当我们在最初推出后尝试使用 SQL Reporting Services 实现报告时遇到了问题。我们没有能力将 SSRS 报告绑定到我们的业务层。我们基本上最终做的是获取从 SQL Profiler 执行的 SQL 并创建存储过程，并在报告中使用存储过程。可以想象，当我们维护代码时，这成为了一个问题，需要更新我们的业务层和存储过程。

我做了一些查看，发现自定义数据扩展似乎是一种方法。这是解决问题的方法吗？有没有人有更好的方法？有没有使用 LINQ 实现这样的解决方案的示例？

[http://www.devx.com/dbzone/Article/31336](http://www.devx.com/dbzone/Article/31336)

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T00:38:09.787

顺便说一句，您不需要使用 Profiler 来查看生成的 SQL。

> var query = (from c in db.Customers where c.LastName = "Someone" select c);
> 
> // 输出查询 SQL Debug.WriteLine(query);
> 
> 返回查询.ToList();

或者，我们所做的是挂钩 DataContext 的 Log 属性。每次我们访问数据库时，它都会自动写出我们的 SQL 和参数。我们发现这对于识别不必要的数据库调用非常有用。

> ```
> public class DataBase : DataBaseModelDataContext
> {
>     internal DataBase()
>     {
>     }
> 
>     public DataBase(CommonObjects.BaseParameters param) {
>         #If (DEBUG) 
>         Log = new DataBaseLoger();
>         #endIf //(DEBUG) 
>     }
> 
>     public override void SubmitChanges(System.Data.Linq.ConflictMode failureMode)
>     {   
>         System.Data.Linq.ChangeSet cs = GetChangeSet();
> 
>         // update audit fields for each insert
>         foreach (object entity in cs.Inserts)
>         {
>             UpdateAuditFields(entity);                               
>         }
> 
>         // update audit fields for each update
>         foreach (object entity in cs.Updates)
>         {
>             UpdateAuditFields(entity);
>         }
> 
>         base.SubmitChanges(failureMode);
>     }
> } 
> ```
> 
> 公共类DataBaseLoger：System.IO.TextWriter {公共覆盖编码编码{获取{返回新的System.Text.UTF8Encoding(); } }
> 
> ```
>  public override void WriteLine(string value)
>     {
>         System.Diagnostics.Trace.WriteLine(System.DateTime.Now.ToString("hh:mm:ss") + " " + value, "Information");
>     }
> 
>     public override void WriteLine()
>     {
>         System.Diagnostics.Trace.WriteLine("", "Information");            
>     }
> 
>     public override void WriteLine(string format, params object[] arg)
>     {
>         WriteLine(string.Format(format, arg));
>     }
> } 
> ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T11:52:05.663

在本地模式下使用 ReportViewer 控件，针对 ObjectDataSource，后者又使用带有“Get”方法的简单类，每个返回`IEnumerable<ClassNeededForReport>`.

执行上述操作的示例（减去 Linq）：http: [//msdn.microsoft.com/en-us/library/ms251692 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms251692(VS.80).aspx)

只需编写您的“Get”方法来使用 Linq，如果需要，可以选择执行 .ToList()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-12T19:57:46.440

只是想稍微关闭一下这个循环......

我们已经通过 LINQ to SQL 应用程序实现了这一点，但它也应该与 EF 一起正常工作。

本质上，它已在上面列出的 devx 文章中列出。

[http://www.devx.com/dbzone/Article/31336](http://www.devx.com/dbzone/Article/31336)

我们遇到了几件事，其中之一是需要“扁平化”我们的数据。我们有自定义例程来将数据扁平化为可供 SSRS 报告使用的行集。您还需要注意上面文章中的设置说明。

提醒一下，我们需要在实现中使用 SSRS 的 Web Service 功能。如果您可以使用本地报告，那就容易多了。如果您对使用域模型的本地报告感兴趣，这是我刚刚遇到的一个很好的系列，它使用 nHibernate 和 SSRS。

[http://codebetter.com/blogs/peter.van.ooijen/archive/2009/07/01/reporting-against-a-domain-model.aspx](http://codebetter.com/blogs/peter.van.ooijen/archive/2009/07/01/reporting-against-a-domain-model.aspx)

[http://codebetter.com/blogs/peter.van.ooijen/archive/2009/07/08/domain-driven-reports-adding-custom-code.aspx](http://codebetter.com/blogs/peter.van.ooijen/archive/2009/07/08/domain-driven-reports-adding-custom-code.aspx)

约翰

# infrastructure - 当您需要在公司中建立软件开发基础架构时，最重要的是什么？

> ID：461618
> 
> 赞同：6
> 
> 时间：2009-01-20T14:52:33.297
> 
> 标签：infrastructure

假设您为一家突然决定进行定制内部软件开发的大公司工作。此外，他们还希望能够为客户提供成功的开发（如果有的话）。

现在你负责它。

**您认为构建成功的软件开发基础架构最重要的是什么？**

*   灵活应对未来增长
*   灵活使用技术（使用 c、java、.net、web、mobile 的项目......）
*   什么样的工具（源代码控制、锻造……）、硬件（虚拟的、单独的开发和生产……）、流程（指南、代码审查……）等。

**更新：**请不要回答您需要合适的人员和合适的工具。这正是我正在寻找的。什么是正确的工具，你会首先雇佣什么样的人加入你的团队？想一想，您将成为该发展的领导者。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-20T15:05:01.820

让自己以至少 10 分的成绩通过[Joel 测试。](http://www.joelonsoftware.com/articles/fog0000000043.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T14:55:15.787

我认为拥有合适的人将是最重要的。如果你的程序员很臭，其他的都无关紧要。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-20T14:56:09.200

负责人知道他们在做什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-20T14:56:32.587

显然，有很多因素，但我想说的是至关重要的因素：

*   雇用聪明的人（并支付他们的价值）
*   选择适合开发类型的好工具（不要选择便宜的工具）
*   建立版本控制系统和政策
*   建立测试机制和政策
*   不要害怕外包你不知道怎么做的东西

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T15:04:23.117

*   找到最适合工作的人。如果他们不愿意支付最好的费用，或者让你在人事预算方面遇到困难，那么你的开端就很糟糕。
*   从您的供应商处获得合适的工具...软件、硬件、支持合同等。
*   尽早为您的开发生命周期建立程序，并确保您有合适的人员来使用它。从您如何评估机会评估到开发、测试和后期制作支持，这一切都是如此。确保您拥有适用于生命周期每个部分的人员和工具。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T15:04:29.073

不要试图在技术上保持灵活。首先从专注于一种技术（Java、.NET 等）开始，然后在需要时转向其他技术。您将能够使用任何技术解决问题，但是很难找到擅长多种技术的人。

在基础架构级别，源代码控制是必须的。持续集成是一个加分项。花时间制定一个标准的项目布局，您将能够发展。它使开发人员更容易切换项目。花时间建立一个良好的构建过程（Ant、Maven，在 Java 世界中）。将您的构建过程与您的 IDE 集成，这样开发人员每次想要测试代码更改时都不必等待 5 分钟来部署他们的项目。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-20T16:06:10.230

我同意纪尧姆的观点：如果你想从头开始建立一个部门，你需要集中精力。你需要建立你的团队，让每个人都成长为他们的新职责，相互了解等等。试图同时进入太多的方向是走向失败的方向。

因此，请确定您想要开发的技术。由于您的示例中的主要目标是内部开发，因此内部需求将决定您的决定。以这个主要目标来建立你的团队。

对于内部开发，您至少需要两个已经了解公司及其流程的人。（两个是因为当第一次重大危机袭击你时，一个人肯定会生病或在度假）。另一方面，你需要一些局外人，他们不被“我们一直这样做”的思维定势，他们可以跳出框框思考。出于上述原因，这些人也应该至少是两个人。作为团队负责人，您的工作是平衡这两个团队并将他们整合到一个团队中。

对于未来的增长，始终考虑有机增长。不要将团队规模增加 200%，在这里雇佣一个新人，在那里雇佣另一个人（或女孩）。慢慢*建立*你的团队。当您承担一个新项目时，请始终考虑扩展您的团队专业知识。在每个项目中尝试新的东西。这可以是一个新的源代码库、一个自动化的日常构建过程、一个编写规范或文档的新系统，甚至是一种不同的技术（例如，当您通常使用 .Net、Delphi 或 C++ 进行开发时使用 Java）。只要确保你*永远不会* 尝试在一个重要项目中取得重大进展。（我曾经在一家公司工作，该公司决定从 VB 6.0 切换到 .Net 以完成他们之前尝试过的最大项目。他们幸存下来。勉强。）

这样，您的部门将缓慢但不断地扩展其能力。然后，当有机会为外部客户进行开发时，您将已经积累了完成它所需的大部分知识。

哦，是的，smacl 也是对的：如果您希望您的部门长期生存，您需要可靠的 QA/QM。

从第一天开始制定（并遵循）您的 QA 规则。使它们尽可能短而灵活。添加您发现丢失的内容，并丢弃证明不必要或不切实际的内容。

不确定这是你想知道的，但我觉得有必要说出来；-)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T15:39:04.870

制定强有力的质量保证战略，包括验收标准和变更控制。最好保持轻量级以适应内部客户。此外了解如何进行需求分析、期望管理和资源管理。

换句话说，不要只是随意创建蹩脚的解决方案，浪费的时间多于节省的时间，而且无法维护。花时间想想你想要什么，需要什么，如何实现它，以及它的成本。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-11T19:05:51.170

除了之前关于团队、版本控制、质量保证等的答案之外，我将提供一个更专注于编码和开发人员/架构师角色的答案，这些答案当然都很重要。

您的许多决定在很大程度上取决于您的特定业务和软件结构（单个产品代码库、SOA、许多项目等）。但总的来说，您应该始终花大量时间预先开发核心软件基础设施，这将在SDLC。

## 软件基础设施

*   编码命名约定例外

*   处理策略

*   策略设置和配置

*   基类和助手类

*   一般架构和层

    （演示、外观、领域实体、数据存储等）

*   UML 2.0 要求等设计工具

*   管理/最终用户交互

还有很多，但这些肯定是需要考虑的一些基础知识。我参与的所有成功项目都包含了不错的软件基础设施。我还要指出，许多失败的项目都有一个共同的主题……缺乏一个共同的基础设施。在大多数情况下，这些失败的项目是由一个非技术人员领导的，他们认为他们可以简单地向几个程序员提出一堆想法，并期望他们在几周内交付。

最重要的是，您需要进行一些前期规划和原型设计，以确保长期成功！

祝你好运。

莱福德
www.blacksaber.com

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-20T15:51:39.823

您应该雇用的第一批人应该是经验丰富的高级专业人员。然后从他们/他们的输入中建立起来。稍后添加初级人员。

# theory - 用 Layman 的话来说，抽水引理是什么？

> ID：461619
> 
> 赞同：86
> 
> 时间：2009-01-20T14:52:46.010
> 
> 标签：theory, proof, pumping-lemma

我看到了[这个问题](https://stackoverflow.com/questions/461539/do-theoretical-computer-science-topics-such-as-regular-vs-non-regular-languages)，并且很好奇**引理**是什么（[维基百科](http://en.wikipedia.org/wiki/Pumping_lemma)没有太大帮助）。

我知道这基本上是一个理论证明，为了使一种语言进入某个类别，它必须是正确的，但除此之外，我真的不明白。

有人愿意尝试以非数学家/计算机科学博士可以理解的方式在相当细化的层面上解释它吗？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-12-19T16:46:47.537

抽水引理是一个简单的证明，它表明一种语言是不规则的，这意味着无法为其构建有限状态机。典型的例子是语言`(a^n)(b^n)`。这是一种简单的语言，就是任意数量的`a`s，后跟相同数量的`b`s。所以字符串

```
ab
aabb
aaabbb
aaaabbbb 
```

等等都在语言中，但是

```
aab
bab
aaabbbbbb 
```

等等都不是。

为这些示例构建 FSM 非常简单：

[![密克罗尼西亚联邦](https://i.stack.imgur.com/eqcKN.jpg)](https://i.stack.imgur.com/eqcKN.jpg)

这个可以一直工作到 n=4。问题是我们的语言没有对 n 施加任何限制，并且有限状态机必须是有限的。无论我向这台机器添加多少个状态，有人可以给我一个输入，其中 n 等于状态数加一，我的机器就会失败。因此，如果可以建造一台机器来读取这种语言，那么其中一定有一个循环来保持状态的数量是有限的。添加了这些循环：

[![密克罗尼西亚联邦 2](https://i.stack.imgur.com/bSNTe.jpg)](https://i.stack.imgur.com/bSNTe.jpg)

我们语言中的所有字符串都将被接受，但是有一个问题。在前四个`a`s 之后，机器失去了输入了多少`a`s 的计数，因为它保持在相同的状态。这意味着在四个之后，我可以`a`在字符串中添加任意数量的 s，而无需添加任何`b`s，并且仍然获得相同的返回值。这意味着字符串：

```
aaaa(a*)bbbb 
```

`(a*)`表示任意数量的s `a`，都将被机器接受，即使它们显然不是全部都在语言中。在这种情况下，我们会说这部分字符串`(a*)`可以被抽吸。有限状态机是有限的并且 n 是无界的这一事实保证了任何接受该语言中所有字符串的机器都必须具有此属性。机器必须在某个点循环，并且在它循环的点上，语言可以被抽出。因此无法为这种语言构建有限状态机，并且语言不规则。

记住[正则表达式和有限状态机是等价的](http://lara.epfl.ch/dokuwiki/equivalence_of_finite_state_machine_and_regular_expression_languages)，然后将`a`and替换`b`为可以相互嵌入的打开和关闭 Html 标签，您就会看到为什么[不能使用正则表达式来解析 Html](http://blog.codinghorror.com/parsing-html-the-cthulhu-way/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-30T20:01:41.027

它是一种旨在证明给定语言不能属于某个类别的设备。

让我们考虑平衡括号的语言（意思是符号'（'和'）'，包括所有在通常含义中平衡的字符串，没有一个不是）。我们可以使用抽水引理来证明这不是规则的。

（语言是一组可能的字符串。解析器是我们可以用来查看字符串是否属于该语言的某种机制，因此它必须能够区分该语言中的字符串或外部的字符串语言。如果有一个可以识别它的常规（或其他）解析器，区分该语言中的字符串和不在该语言中的字符串，则该语言是“常规”（或“无上下文”或“上下文敏感”或其他）语言。）

LFSR Consulting 提供了很好的描述。我们可以将常规语言的解析器绘制为框和箭头的有限集合，其中箭头代表字符，而框连接它们（充当“状态”）。（如果比这更复杂，它就不是一种常规语言。）如果我们可以得到一个比盒子数更长的字符串，这意味着我们不止一次地通过了一个盒子。这意味着我们有一个循环，我们可以根据需要多次循环。

因此，对于常规语言，如果我们可以创建一个任意长的字符串，我们可以将其划分为 xyz，其中 x 是我们需要到达循环开头的字符，y 是实际循环，z 是我们需要的任何字符需要在循环后使字符串有效。重要的是 x 和 y 的总长度是有限的。毕竟，如果长度大于盒子的数量，我们显然在执行此操作时已经通过了另一个盒子，所以有一个循环。

所以，在我们平衡的语言中，我们可以从写任意数量的左括号开始。特别是，对于任何给定的解析器，我们可以写比盒子更多的左括号，因此解析器无法知道有多少左括号。因此，x 是一些左括号，这是固定的。y 也是一些左括号，这可以无限增加。我们可以说 z 是一些右括号。

这意味着我们的解析器可能识别出 43 个左括号和 43 个右括号的字符串，但是解析器无法从 44 个左括号和 43 个右括号的字符串中分辨出来，这不是我们的语言，所以解析器无法解析我们的语言。

由于任何可能的常规解析器都有固定数量的框，我们总是可以写出比这更多的左括号，并且通过泵引理我们可以以解析器无法分辨的方式添加更多的左括号。因此，平衡括号语言不能被正则解析器解析，因此不是正则表达式。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-20T15:03:51.727

用外行的话来说是一件困难的事情，但基本上正则表达式中应该有一个非空子字符串，可以根据需要重复多次，而整个新词对该语言仍然有效。

在**实践**中，泵引理不足以证明语言正确，而是作为一种通过矛盾进行证明并通过显示泵引理来表明语言不适合语言类别（常规或无上下文）的方法不为它工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-20T15:00:36.227

基本上，您有一种语言的定义（如 XML），这是一种判断给定字符串（“单词”）是否属于该语言的一种方法。

抽水引理建立了一种方法，您可以通过该方法从语言中选择一个“单词”，然后对其进行一些更改。该定理指出，如果语言是规则的，这些变化应该产生一个仍然来自同一种语言的“词”。如果您想出的词不在该语言中，那么该语言一开始就不可能是常规的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-20T15:47:55.867

简单的泵引理是常规语言的引理，它是由有限自动机描述的字符串集，等等。有限自动化的主要特征是它只有有限数量的内存，由其状态描述。

现在假设你有一个字符串，它被一个有限自动机识别，并且它的长度足以“超过”自动机的记忆，即其中的状态必须重复。然后有一个子串，其中自动机在子串开头的状态与子串末尾的状态相同。由于读取子字符串不会改变状态，因此它可能会被删除或复制任意次数，而自动机不会更聪明。所以这些修改后的字符串也必须被接受。

对于上下文无关语言，还有一个更复杂的抽水引理，您可以在其中删除/插入可能直观地被视为匹配括号的字符串中的两个位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T18:34:58.570

By definition regular languages are those recognized by a finite state automaton. Think of it as a labyrinth : states are rooms, transitions are one-way corridors between rooms, there's an initial room, and an exit (final) room. As the name 'finite state automaton' says, there is a finite number of rooms. Each time you travel along a corridor, you jot down the letter written on its wall. A word can be recognized if you can find a path from the initial to the final room, going through corridors labelled with its letters, in the correct order.

The pumping lemma says that there is a maximum length (the pumping length) for which you can wander through the labyrinth without ever going back to a room through which you have gone before. The idea is that since there are only so many distinct rooms you can walk in, past a certain point, you have to either exit the labyrinth or cross over your tracks. If you manage to walk a longer path than this pumping length in the labyrinth, then you are taking a detour : you are inserting a(t least one) cycle in your path that could be removed (if you want your crossing of the labyrinth to recognize a smaller word) or repeated (pumped) indefinitely (allowing to recognize a super-long word).

There is a similar lemma for context-free languages. Those languages can be represented as word accepted by pushdown automata, which are finite state automata that can make use of a stack to decide which transitions to perform. Nonetheless, since there is stilla finite number of states, the intuition explained above carries over, even through the formal expression of the property may be slightly [more complex](http://en.wikipedia.org/wiki/Pumping_lemma_for_context-free_languages).

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T18:49:21.857

In laymans terms, I think you have it almost right. It's a proof technique (two actually) for proving that a language is *NOT* in a certain class.

Fer example, consider a regular language (regexp, automata, etc) with an infinite number of strings in it. At a certain point, as starblue said, you run out of memory because the string is too long for the automaton. This means that there has to be a chunk of the string that the automaton can't tell how many copies of it you have (you're in a loop). So, any number of copies of that substring in the middle of the string, and you still are in the language.

This means that if you have a language that does NOT have this property, ie, there is a sufficiently long string with *NO* substring that you can repeat any number of times and still be in the language, then the language isn't regular.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-26T07:08:00.247

例如，采用这种语言*L* = *a ^n b ^n*。

现在尝试为一些*n*可视化上述语言的有限自动机。

如果*n* = 1，则字符串*w* = *ab*。*在这里，如果n* = 2，字符串*w* = a ² b ² ，我们可以制作一个没有循环的有限自动机。在这里我们可以制作一个没有循环的有限自动机

如果*n* = *p*，则字符串*w* = *a ^p b ^p*。本质上可以假设一个有限自动机具有 3 个阶段。第一阶段，它需要一系列输入并进入第二阶段。同样从第 2 阶段到第 3 阶段。让我们将这些阶段称为*x*、*y*和*z*。

有一些观察

1.  肯定*x*将包含 'a' 而*z*将包含 'b'。
2.  现在我们必须清楚*y*：
    *   case *a* : *y*可能只包含 'a'
    *   case *b* : *y*可能只包含 'b'
    *   case *c* : *y*可能包含 'a' 和 'b' 的组合

*所以阶段y*的有限自动机状态应该能够接受输入 'a' 和 'b' 并且它不应该接受更多不可数的 a's 和 b's。

1.  如果阶段*y*只取一个“a”和一个“b”，那么需要两个状态
2.  如果它需要两个“a”和一个“b”，则需要三个状态而没有循环，依此类推....

所以阶段*y*的设计纯粹是无限的。我们只能通过放置一些循环来使其有限，如果我们放置循环，有限自动机可以接受*L* = *a ^n b ^n*之外的语言。所以对于这种语言，我们不能构造一个有限自动机。因此它是不规则的。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-03-07T13:04:34.693

这不是一个解释，但它很简单。对于 a^nb^n，我们的 FSM 应该以这样一种方式构建，即 b 必须*知道*已经解析的 a 的数量，并且将接受相同的 n 个 b。FSM 不能简单地做那样的事情。

# java - 从末尾解析文本（使用正则表达式）

> ID：461631
> 
> 赞同：1
> 
> 时间：2009-01-20T14:56:07.797
> 
> 标签：java, regex

我有一个看似简单的问题，但我无法理解它。

假设我有以下字符串：'abcabcabcabc'，我想得到最后一次出现的'ab'。有没有一种方法可以做到这一点*，而无需*从字符串的开头遍历所有其他'ab'？

我读到了锚定字符串的结尾，然后用所需的正则表达式解析字符串。我不确定如何在 Java 中执行此操作（是否支持？）。

**更新：**我想我对我的（过度）简化示例造成了很多混乱。让我试试另一个。说，我有一个字符串 - '12/08/2008 some_text 21/10/2008 some_more_text 15/12/2008 and_finally_some_more'。在这里，我想要**最后一个日期**，因此我需要使用正则表达式。我希望这是一个更好的例子。

谢谢，阿尼鲁德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T15:05:03.927

这将为您提供匹配对象第 1 组中的最后一个日期。

```
.*(\d{2}/\d{2}/\d{4}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T15:38:56.773

首先，感谢所有的答案。

这是我尝试过的，这对我有用：

```
Pattern pattern = Pattern.compile("(ab)(?!.*ab)");
Matcher matcher = pattern.matcher("abcabcabcd");
if(matcher.find()) {
  System.out.println(matcher.start() + ", " + matcher.end());
} 
```

这将显示以下内容：

```
6, 8 
```

所以，概括地说 -`<reg_ex>(?!.*<reg_ex>)`应该在哪里解决这个问题？！表示它后面的字符串不应出现在 '?!' 之前的字符串之后。

**更新：** [此页面](http://www.kleenecode.net/2008/10/10/regex-fu-not-followed-by/)提供了有关使用正则表达式“不跟随”的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T15:00:10.597

```
Pattern p = Pattern.compile("ab.*?$");
Matcher m = p.matcher("abcabcabcabc");
boolean b = m.matches(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T15:04:39.340

我不明白你想做什么。如果它们都相同，为什么只有最后一个？为什么是正则表达式，为什么不是 int pos = s.lastIndexOf(String str) ？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T15:58:34.130

对于日期示例，您可以使用 Pattern API 而不是正则表达式本身来执行此操作。基本思想是获取所有匹配项，然后返回最后一个匹配项。

```
public static void main(String[] args) {

    // this may be over-kill, you can replace with a much simpler but more lenient version
    final String dateRegex = "\\b(0?[1-9]|[12][0-9]|3[01])[- /.](0?[1-9]|1[012])[- /.](19|20)?[0-9]{2}\\b";
    final String sample = "12/08/2008 some_text 21/10/2008 some_more_text 15/12/2008 and_finally_some_more";

    List<String> allMatches = getAllMatches(dateRegex, sample);
    System.out.println(allMatches.get(allMatches.size() - 1));        
}

private static List<String> getAllMatches(final String regex, final String input) {

    final Matcher matcher = Pattern.compile(regex).matcher(input);
    return new ArrayList<String>() {{
        while (matcher.find())
            add(input.substring(matcher.start(), matcher.end()));
    }};
} 
```

# iis - 诊断经典 ASP 中的 HTTP 500 错误

> ID：461638
> 
> 赞同：5
> 
> 时间：2009-01-20T14:58:05.327
> 
> 标签：iis, asp-classic

我最近继承了一个用 Classic ASP 编写的网站，目前正在尝试了解事物的状态。该网站正在生产中运行，但是当您尝试导航到该开发环境（托管在 Windows Server 2003 机器上）时，会产生 HTTP 500 错误。

我意识到 HTTP 500 错误只是意味着发生了意外的服务器错误，而且这也很可能是 ASP 代码由于某种原因而崩溃。我尝试了许多浏览器（IE、Firefox 和 Chrome），但它们都具有相同数量的信息。

作为 ASP.NET 开发人员，我习惯了[黄屏死机](http://en.wikipedia.org/wiki/Yellow_Screen_of_Death#Yellow)，可以将其配置为显示堆栈跟踪。

所以我的问题是，我如何说服 IIS 和/或 Classic ASP 给我一个更好的提示，说明是*什么*导致了错误？

**更新：** 我本来应该更详细的，但这里有一些我看过的东西。

*   我查看了事件日志（应用程序、安全性、系统等），那里没有任何相关内容。

*   我查看了 IIS 访问日志，看到了访问尝试，只有 500 个错误。它甚至在 favicon.ico 上产生 500 个错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T15:11:31.743

如果您按照 Wayne 的建议通过关闭“显示友好的 HTTP 错误消息”无法找到违规行，请尝试将“On Error Resume Next”与 response.write 语句一起添加到代码中。我发现了这样的问题，你只需要开始逐行浏览代码，直到找到令人反感的代码。

只是出于好奇，在开发服务器上的 IIS 中的 Web 服务器扩展中是否设置为允许活动服务器页面？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T15:01:14.853

您是否检查过 Web 服务器事件查看器的应用程序部分是否有错误条目？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T15:08:28.770

*亚历克斯*所说的，还要确保在 Internet Explorer 中关闭“显示友好的 HTTP 错误消息”，然后浏览到该站点；这往往会为您提供更具体的错误消息（尽管与 ASP.NET 的堆栈跟踪相比仍然是通用的）以及行号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T16:17:55.010

如果您的 web 目录中有 global.asa 文件，您可以重命名该文件并尝试再次加载 favicon.ico 文件。如果加载，则问题出在 global.asa

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-15T15:22:34.770

显然是一个老问题，但是对于它的价值，如果您可以访问开发服务器（直接或远程桌面），您可以从那里访问该站点。本地主机请求显示有关经典 ASP 的更多调试信息，包括行号。

# sql - 分组聚合的 SQL 选择标准

> ID：461641
> 
> 赞同：0
> 
> 时间：2009-01-20T14:59:49.490
> 
> 标签：sql, mysql

我正在尝试为以下两个问题找到一个简单的 MySQL 语句：

我有 4 个表：员工、客户、订单、产品（订单中的每个条目都包含一个日期、一个产品的引用、一个数量和对客户的引用以及对员工的引用）。

现在，我试图让 1996 年的销售量（数量 * product.price）大于 1995 年的所有客户。

并且：我想列出所有销售量低于平均销售量的员工。

任何帮助将不胜感激。我已经设法使用 php 脚本获取信息，但我认为这可以通过一些巧妙的 SQL 语句来完成。

有谁能够帮助我？

* * *

员工表：ID# 姓名

产品表：ID# NAME# PRICE

订单表：ODERID# CUSTOMERID # DATE # EMPLOYEE# PRODUCTID# QUANTITY

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T15:10:02.730

对于第一部分（假设相当多的架构）：

```
SELECT Customers.ID
FROM Customers 
    LEFT JOIN orders AS o1 ON o1.CustomerID=Customers.ID AND YEAR(o1.DATE) = 1995
    LEFT JOIN products AS p1 ON p1.id = o1.productID
    LEFT JOIN orders AS o2 ON o2.CustomerID=Customers.ID AND YEAR(o2.DATE) = 1996
    LEFT JOIN products AS p2 ON p2.id = o2.productID
HAVING SUM(o1.quantity* p1.price) < SUM(o2.quantity*p2.price) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T15:10:08.127

我不知道您使用的数据库类型，所以我将使用 sqlserver。大多数数据库都提供“年份”功能，因此您应该能够为您的数据库重写查询。

我认为这是为 1996 年的总数高于 1995 年的客户返回所有 customerid's + ordertotal 的查询，但我尚未对其进行测试。至关重要的是 HAVING 子句，您可以在其中根据分组结果指定 WHERE 类型的子句。

```
SELECT  o.CustomerId, SUM(o.Quantity * p.Price) AS Total
FROM    Orders o INNER JOIN Products p
        ON o.ProductId = p.ProductId
WHERE   YEAR(o.Date) == 1996
GROUP BY o.CustomerId
HAVING SUM(o.Quantity * p.Price) > 
(
    SELECT  SUM(o.Quantity * p2.Price) AS Total
    FROM    Orders o2 INNER JOIN Products p2
            ON o2.ProductId = p.ProductId
    WHERE   YEAR(o.Date) == 1995
            AND o2.CustomerId = o.CustomerId
    GROUP BY o.CustomerId
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T15:16:23.043

类似的东西：

1.  select * from customers c where (select sum (o.quantity * p.price) from orders o, product p where o.productID = p.productID and o.dateyear = 1996 and o.customerID = c.customerID) < (select sum (o.quantity * p.price) from orders o, product p where o.productID = p.productID and o.dateyear = 1995 and o.customerID = c.customerID)

2.  select * from employees e where (select avg (o.quantity * p.price) from orders o, product p where o.productID = p.productID and o.empID = e.EmpID) < (select avg (o.quantity * p.price) 来自订单 o，产品 p，其中 o.productID = p.productID)

# junit - 如何让 Junit 4 忽略基本测试类？

> ID：461644
> 
> 赞同：67
> 
> 时间：2009-01-20T15:00:15.497
> 
> 标签：junit, junit4

我有一个用于许多测试的基类，这些测试有一些他们都需要的辅助方法。

它本身没有任何测试，但 JUnit（在 eclipse 中）正在调用它的测试运行器并抱怨没有测试方法。

我怎样才能让它忽略这个类？

我知道我可以添加一个`dummyTest`可以解决问题的方法，但它也会出现在所有子类中。

建议？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-01-20T15:12:12.553

用于`@Ignore`注释。它也适用于类。看到这个：

```
@Ignore public class IgnoreMe {
                        @Test public void test1() { ... }
                        @Test public void test2() { ... }
                } 
```

> 此外，您可以使用 @Ignore 注释包含测试方法的类，并且不会执行任何包含测试。

来源：[JUnit JavaDoc](http://junit.sourceforge.net/javadoc/org/junit/Ignore.html)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-01-29T13:05:39.903

正如一个注释，我总是建议给出忽略的理由：

```
@Ignore("This test will prove bug #123 is fixed, once someone fixes it") 
```

我希望在从 ant 运行测试时使用的 junit xml 报告格式化程序有一天会包括忽略的计数（和原因）以及通过、失败和错误。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-03-26T15:27:40.743

为 JUnit 4 创建类`abstract`应该足够了。如果它不起作用，请仔细检查您使用的 JUnit 版本。

这也传达了您的意图，即这只是测试的一部分。

它还可以防止 JUnit 将类中的测试计为“忽略”（因此忽略测试的最终计数将是您所期望的）。

或者，重命名该类。大多数运行器使用类名来确定哪些类是测试，哪些是助手。在具有默认设置的 Maven 中，您只需确保基类不`Test`以`TestCase`( [http://maven.apache.org/surefire/maven-surefire-plugin/examples/包含-排除.html](http://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html) )

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-12-26T14:14:13.213

有三个选项：

1.  在 JUnit 4 或 5 中足以使基类**抽象**。如果您使用`@Igonre`属性，它将显示为被忽略的测试（并将其添加到测试总数中）。

2.  您可以使用`@Ignore`注释。此注释也适用于类。测试`@Ignore`注释用于忽略特定测试或测试组以跳过构建失败。

    ```
    @Ignore("Base class not yet ready") 
    class MyBaseClassTestCases {...} 
    ```

3.  您可以更改测试类的名称，**使其在测试名称的开头或结尾不包含单词** *Test*（区分大小写）/或结尾不包含单词*TestCase*。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2020-01-10T09:59:59.223

# JUnit5

`@Ignore`在未来的版本中不退出，如果你使用的是 JUnit5，你可以[`@Disabled`](https://junit.org/junit5/docs/current/user-guide/#writing-tests-disabling)从 JUnit Jupiter使用

```
import org.junit.jupiter.api.Disabled; 
```

您甚至可以`@Disabled`与评论一起使用`@Disabled("some comment here")`

### 班级

注释类，将禁用类中的所有测试：

```
@Disabled
public class DemoTest { } 
```

* * *

```
@Disabled("some comment here")
public class DemoTest { } 
```

### 方法

```
@Disabled
public void whenCaseThenResult() { } 
```

* * *

```
@Disabled("some comment here")
public void whenCaseThenResult() { } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2022-02-18T20:13:49.883

添加一个空测试有效。

```
@Test(expected = Test.None.class)
public void ATest() {} 
```

请注意，不添加它`(expected = Test.None.class)`会添加“添加至少一个断言”声纳问题。

# sql - 是否可以在 SQL 中将多个常量选择到多个结果集行中？

> ID：461645
> 
> 赞同：2
> 
> 时间：2009-01-20T15:00:25.387
> 
> 标签：sql, sql-server

我知道我可以“选择 5 AS foo”并获得结果集：

> **富**
> 
> 5
> 
> (1 行)

...有什么方法可以“选择 5,6,7 AS foo”并获取结果集：

> **富**
> 
> 5
> 
> 6
> 
> 7
> 
> (3 行)

...我很清楚这不是典型的数据库用法，任何可以想象的用法都可能最好使用更普通的技术。更多的是技术问题。

*注意：我知道我可以使用大量的 UNION 列表——我正在尝试寻找其他东西。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T15:04:47.453

使用数字表很容易，这是一个示例

```
select number as foo
 from master..spt_values
where type = 'p'
and number between 5 and 7 
```

或者如果你想使用

```
select number as foo
 from master..spt_values
where type = 'p'
and number in(5,6,7) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T15:13:06.390

```
select foo
from (select 1 as n1, 2 as n2, 3 as n3) bar
unpivot (foo for x in (n1, n2, n3)) baz; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T15:15:54.933

使用这些和其他技术是可能的（任何面试过数据库开发人员职位的人都会告诉你）。但是在另一个抽象层中执行此操作通常更容易（并且工具更合适）；即您的 DAL 或更高版本，您将数据视为某种列表。尽管 rdbms 产品提供了促进者，但它是对关系概念模型的扭曲。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T15:22:27.213

只是为了好玩，不会梦想真正使用它：

```
WITH numbers AS
(
    SELECT ROW_NUMBER() OVER (ORDER BY name) AS 'RowNumber'
    FROM sys.all_objects
) 
SELECT RowNumber 
FROM numbers 
WHERE RowNumber BETWEEN 5 AND 7; 
```

# c# - 将 XML 文档转换为流利的 C#

> ID：461646
> 
> 赞同：3
> 
> 时间：2009-01-20T15:00:28.210
> 
> 标签：c#, xml, .net-3.5, xsd, fluent-interface

我想将没有任何与之关联的 XSD 架构的外部 XML 文档转换为流畅的 .NET 对象。

我有一个简单的 XML 文件，例如：

```
<application>
    <parameters>
        <param></param>
        <param></param>
    </parameters>
    <generation />
    <entities>
        <entity ID="1">
            <PropTest>Test</PropTest>
        </entity>
        <entity ID="2">
            <PropTest>Another Test</PropTest>
        </entity>
     </entities>
</application> 
```

我想浏览文档，例如：

```
var xConfig = new XmlConfig("file.xml");

// testValue should be assigned "Test"
string testValue = xConfig.Generation.Entities.Entity(1).PropTest; 
```

**在 .NET 3.5 中实现这一目标**的最佳方法是什么？

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T15:34:39.577

可以说，目前最好的方法是使用 Linq to XML。这比搞乱 XSD 和复杂的类定义要容易得多。

```
XDocument doc = XDocument.Load("file.xml");
var val = doc
    .Descendants("entity")
    .Where(p => p.Attribute("ID").Value == "1")
    .Descendants("PropTest")
    .FirstOrDefault();
if (val != null)
    Console.WriteLine(val.Value); 
```

我使用的示例 file.xml 是：

```
<?xml version="1.0" encoding="utf-8" ?>
<application>
    <parameters>
        <param></param>
        <param></param>
    </parameters>
    <generation>
        <entities>
            <entity ID="1">
                <PropTest>Test</PropTest>
            </entity>
            <entity ID="2">Another Test</entity>
        </entities>
    </generation>
</application> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T15:50:33.397

我刚刚注意到[Lusid](https://stackoverflow.com/questions/461646/converting-an-xml-document-to-fluent-c/461786#461786)在我写答案时也写了关于 Linq to SQL 的文章，但他使用的是 XDocument。

这是我的版本（`file.xml`是问题中给出的 XML）：

```
string testValue =
    (string) XElement.Load("file.xml")
        .Element("entities")
        .Elements("entity")
        .FirstOrDefault(entity => entity.Attribute("ID")
            .Value == "1") ?? string.Empty; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T15:03:59.480

我会看看[xsd.exe](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx)。您也可以[在此处](http://asp.dotnetheaven.com/howto/doc/xmlserialization/XSDToCls.aspx)获取有关如何使用它的更多信息的教程。

基本上，您将创建 XSD 的 .NET 类等价物。然后，您将能够序列化和反序列化您的 XML 和对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-27T11:26:48.177

[Kevin Hazzard 使用 .NET 4.0 动态类型第 1](http://blogs.captechconsulting.com/blog/kevin-hazzard/fluent-xml-parsing-using-cs-dynamic-type-part-1)部分和[第 2](http://blogs.captechconsulting.com/blog/kevin-hazzard/fluent-xml-parsing-using-cs-dynamic-type-part-2)部分为 C# 编写了流畅的 XML 接口。这将允许如下代码：

```
var v = dx.application.entities.entity[0].PropTest.Value; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T15:20:49.633

如果您只是提取架构（使用 xsd.exe 应该很容易），那么这个[在线工具](http://www.bware.biz/CodeXS/CodeXS.asmx)（也可以下载）可以帮助您，我试过了，没关系。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T16:01:02.550

定义派生自 ConfigurationSection/ConfigurationElement 等的类。它们很好地映射到 xml 文件（这就是它们构建的目的），请参阅 MSDN。另一种方法是创建 POCO 对象并在属性上设置 XML 序列化属性，然后使用 System.XML.XMLSerializer 对 XML 进行序列化/反序列化。有关 XML 序列化的信息，请参阅 MSDN。

# apache-flex - Flex3 中文本的流畅布局

> ID：461649
> 
> 赞同：2
> 
> 时间：2009-01-20T15:00:55.947
> 
> 标签：apache-flex, user-interface, text, layout, flex3

在我的 Flex3 应用程序中，我有一些包含可变数量文本的浮动窗口。窗口旨在用户可调整大小。目前，虽然我可以调整窗口大小，但在调整窗口大小时，我无法让窗口中 TextArea 中的文本重新流动。我在博客文章中发现 TextArea 中存在大小错误，这意味着设置文本内容不会正确调整 TextArea 的大小以及建议的解决方法。就我而言，内容保持不变，但容器的几何形状发生了变化。似乎正在发生的事情是 TextArea 在第一次渲染时采用了固定大小，并且没有任何调整容器大小会改变它。谁能建议一种在 Flex 中创建流畅文本区域的方法？

伊恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T10:01:42.780

我找到了一个很好的[流体窗口](http://examples.adobe.com/flex3/devnet/dashboard/main.html)示例，请访问它。他们也提供源代码，所以你可能会得到更好的主意。

[http://examples.adobe.com/flex3/devnet/dashboard/main.html](http://examples.adobe.com/flex3/devnet/dashboard/main.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T21:40:13.467

您可以尝试 Adob​​e 的文本布局框架：http: [//labs.adobe.com/technologies/textlayout/](http://labs.adobe.com/technologies/textlayout/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-07T00:16:33.670

我可以对此进行打击......但不要笑......我不确定您是否需要使用特定的容器，但无论如何，将宽度和高度设置为 100% 并使用 Grid > GridRow 和 GridItem 来大小和调整文本控件的大小，您可以指定表格的宽度，或者像 Flex 中的 HTML 表格一样使用它来操作控件和容器的大小...。

希望有帮助...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-11T10:15:58.857

通过将 textArea 的宽度绑定到其容器的宽度，您可以设法保持边距和边框，而不必处理百分比。
此外，您的 textArea 将在其父级每次更改大小时调整大小。
我在想这样的事情：

```
<fx:Script>
    <![CDATA[
        import spark.layouts.supportClasses.LayoutBase;

        protected function onButtonClicked(event:MouseEvent):void
        {
            currentState = (event.target.selected ? 'largeState' : 'smallState');
        }

    ]]>
</fx:Script>
<s:TitleWindow id="window" width="300" height="200">
    <s:TextArea width="{window.width - 10}" height="{window.height - 60}" 
        text="{IMyConsts.LOREMIPSUM}" borderVisible="false" />
    <s:ToggleButton id="btnEffect" bottom="5"  click="onButtonClicked(event)"
        label="{btnEffect.selected ? 'Go smaller' : 'Go larger'}" />
</s:TitleWindow>
<s:states>
    <s:State name="smallState" />
    <s:State name="largeState" />
</s:states>
<s:transitions>
    <s:Transition fromState="smallState" toState="*">
        <s:Resize target="{window}" widthTo="400" heightTo="300" />
    </s:Transition>
    <s:Transition fromState="largeState" toState="*">
        <s:Resize target="{window}" widthTo="300" heightTo="250" />
    </s:Transition>
</s:transitions> 
```

# asp.net - ASP.NET - 信任级别 = 完整？

> ID：461650
> 
> 赞同：5
> 
> 时间：2009-01-20T15:00:59.160
> 
> 标签：asp.net, security, sharepoint, web-config, cas

我最近加入了一家公司，在分析他们的环境时，我注意到 SharePoint web.config 的信任级别设置为完全。我知道这绝对是一种糟糕的做法，并希望 stackoverflow 社区可以帮助我概述这个决定中的缺陷。

哦，看来这个决定是为了允许开发人员在不创建 CAS 策略的情况下将 dll 部署到 Bin 文件夹。叹。

只是想澄清一下，让事情变得更糟，我们也在为这个 Web 应用程序部署第三方代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-11T12:50:54.993

托德，

Dino Espisito所著的《[Programming Microsoft ASP.Net 3.5](http://www.google.com/search?sourceid=navclient&ie=UTF-8&rlz=1T4DMUS_enUS233US239&q=Programming+Microsoft+ASP.Net+3.5)》一书为不允许在 ASP.Net 应用程序中完全信任提供了一些合理的理由。

除其他原因外，Dino 表示暴露于互联网的 Web 应用程序是“您可以想象的对计算机安全最不利的环境之一”。和：

> 公开暴露的完全受信任的应用程序是黑客发动攻击的潜在平台。应用程序的可信度越低，该应用程序就越安全。

我很惊讶 StackOverflow 社区没有更好地概述完全信任的问题。我希望同样的事情，所以我不必去翻阅我的一堆书来寻找答案，懒惰的我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T15:12:14.660

如果他们无视 CAS 政策，那么让他们回拨可能很难，因为这会使他们的工作变得更加困难（或者，至少不那么宽容）。改变安全实践总是很困难的——比如当我不得不说服我的老板在我们的 Web 应用程序的 SQL 连接字符串中使用 SA 帐户是一个坏主意时——但坚持下去。

完全信任允许应用程序升级以控制计算机上的任何资源。虽然您的应用程序中必须存在安全漏洞才能允许这些，并且他们可能会声称他们已经通过精明的编程阻止了任何升级，但请提醒他们，如果发生某些事情，他们不是宁愿Web 应用程序无法控制整个计算机？我的意思是，以防万一？

编辑：我在这里对我的语言有点过分热心。完全信任将允许应用程序控制它想要的任何东西，但前提是应用程序池进程具有足够的权限来执行此操作。因此，如果您以受限用户的身份运行，除了应用程序需要之外，在服务器上没有任何权限，那么我认为“完全信任”基本上没有风险。现实情况是，应用程序池所有者很可能拥有许多您不希望您的应用程序拥有的权利（在某些情况下，很多很多），因此限制应用程序安全性并单独授予额外的权利需求要安全得多到应用程序。谢谢你的纠正，巴里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T15:07:57.117

缺陷？许多。但最糟糕的是直接来自 CAS 实用程序：

“......它允许完全访问您计算机的资源，例如文件系统或网络访问，可能在安全系统的控制之外运行。”

这意味着，获得完全信任的代码可以在系统上执行任何其他代码（托管或其他），可以通过网络调用任何机器，可以在文件系统中执行任何操作（包括更改受限文件的权限 - 甚至是操作系统文件）。

大多数网络程序员会说“这不是问题，只是我的代码”，这很好......直到他们的代码中出现安全漏洞，允许攻击者使用它来做令人讨厌的事情。然后，先前授予的完全信任变得非常不幸。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T15:38:07.493

老实说，我发现 sharepoint 过于严格。

请查看以下页面，了解基于信任级别可以做什么和不可以做什么 [http://msdn.microsoft.com/en-us/library/ms916855.aspx](http://msdn.microsoft.com/en-us/library/ms916855.aspx)

我立即遇到的一个问题是我无法使用缓存应用程序块。我们使用这个应用程序块而不是 ASP.NET 缓存，因为我们使用了 MVP 模式并且可能会打开一个 win forms 应用程序。

另一个问题是没有反射，这导致 About 页面失败，因为版本号是从程序集的元数据中提取的。

我认为最好的解决方案是不使用 Sharepoint 作为应用程序主机。如果编码量太小以至于不会影响信任级别，我只会将 Sharepoint 用作应用程序主机，并且与设置新应用程序相比，它的工作量会更少。如果您正在执行某种类型的编码，它开始触及信任级别的障碍，请将您的应用程序移动到适当的 ASP.NET 环境中。但这只是我，我有偏见。也许您应该尝试以中等信任级别妥协为目标。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-03T09:56:08.560

我在我的开发机器上使用完全信任......所以我可以在构建新代码时部署到 BIN。我相信我自己的代码并在 GAC 中运行它，因为创建 CAS 策略很痛苦。

第三方的事情会让我担心..但是：

大多数在网络上找到的第 3 方解决方案也部署到 GAC（假设出于相同的原因）。无论信任级别如何，这都会赋予他们所有权利。感觉这与您是否信任第 3 方有关。您真的信任自己的开发人员吗？

黑客会做什么？黑客在您的 BIN 文件夹中放置一个邪恶的 dll 的情况我认为不太现实。无论他是否可以这样做，他也可能会更改信任级别。

# c - 动态链接错误

> ID：461655
> 
> 赞同：1
> 
> 时间：2009-01-20T15:02:42.807
> 
> 标签：c, linker

我正在观察一些我觉得很难推理的行为。

我有一段代码如下：

```
int timer_temp_var;

if ((timer_temp_var/1000.0) > 5.0) 
{
  //Do something
} 
```

这块导致链接错误。

```
> 
> dld: warning: Undefined symbol _d_fle"
> dld: no output written make[1]: ***
> [app.elf] Error 1 
```

但是将相等性检查替换为：

```
if ((timer_temp_var/1000.0) < 5.0)  // replace '>' with '<'. 
```

我看不出问题。

如果我除以 1000，也不是除以 1000.0，如下所示：

```
 if ((timer_temp_var/1000) > 5) 
    {
      //Do something
    } 
```

无论哪种平等检查，我都看不到任何问题。

该应用程序被编译为在 pSOS 操作系统上运行。

这种行为的原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T15:23:39.927

似乎您的编译器用`_d_fle()`函数调用替换了“>”运算符，因此您需要将一些库链接到您的可执行文件。

令人惊讶的是，“<”可以工作，尽管它应该被`d_fgt()`最有可能位于同一个库中的函数替换。

`100.0`从to更改`100`为 ">" 整数的左操作数，似乎整数比较不需要任何函数调用 - 可能它被编译为 CPU 指令而不是函数调用。

编辑：看起来您需要 SFPE（软件浮点仿真）库。你有类似 libsfpe 的东西吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T20:35:44.740

您缺少一个浮点库。尝试包含数学库（libm.a），看看是否可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T15:27:34.910

从 1000.0 到 1000 的变化表明浮点运算存在问题。尝试将 1000.0 转换为 (int) 并查看是否有任何进展。

将符号 < 更改为 > 听起来不合理导致任何更改......

# java - 如何在单元测试中处理大字符串？

> ID：461678
> 
> 赞同：5
> 
> 时间：2009-01-20T15:06:09.010
> 
> 标签：java, unit-testing, junit

我有一个关于字符串测试方法的问题。每次，我都会在一个以字符串为参数的方法上编写一个新测试。

现在，出现了一些问题：

*   如何包含带有\n、\r、\t、变音符号等的测试字符串？
*   如何设置编码？
*   我应该使用由 FileInputStream 打开的外部文件吗？（太多的开销，恕我直言）

那么......你有什么方法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T15:10:51.183

*   如果您有很多，请将测试字符串与字符串常量一起保存在单独的类中
*   除非必须，否则尽量不要将文件保存在磁盘上。我同意你的说法——这会带来太多的开销（更不用说如果你开始出现 I/O 错误会发生什么）
*   确保为不同的操作系统测试具有不同换行符 ( `\n`, `\r\n`, ) 的字符串`\r\n\r`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T15:19:01.743

> 如何包含带有\n、\r、\t、变音符号等的测试字符串？

嗯……按你想要的方式输入？您可以使用 \n、\r 和 \t、变音符号 stc。在 Java 字符串文字中；如果你担心源代码文件的编码，你可以使用[Unicode 转义序列](http://en.wikibooks.org/wiki/Java_Programming/Syntax/Unicode_Escape_Sequences)，你可以使用 JDK 自带的 native2ascii 工具生成它们。

> 如何设置编码？

一旦有了 Java 字符串，再担心编码为时已晚——它们使用 UTF-16，并且在字符串和字节数组之间进行转换时会出现任何编码问题（与 C 不同，Java 将这些概念清楚地分开）

**编辑：** 如果您的字符串太大而无法在源代码中舒适地使用，或者您真的担心换行符和空格的处理，那么将每个字符串保存在单独的文件中可能是最好的；在这种情况下，必须在读取文件时指定编码（在的构造函数中`InputStreamReader`）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T16:21:56.360

对于大字符串，我会使用文件。对于单元测试，性能足够快。为了这个小小的权衡，你：

1.  不必担心转义字符
2.  可以区分源代码管理中的内容
3.  可以独立验证文件（即xml/html）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T15:43:06.330

您可以使用脚本语言来编写测试代码。

[JRuby](http://jruby.codehaus.org/)和[Groovy](http://groovy.codehaus.org/)支持 HERE 文档，可以更轻松地定义跨多行的大字符串

```
# In JRuby
mystring = <<EOS
This is a long string that
spans multiple lines.
EOS

# In Groovy
def mystring = """This is a long string that
spans multiple lines.""" 
```

这也将使您的测试代码更容易编写，因为两种语言都有许多有助于编写更简单代码的快捷方式（但有些人可能会说不太健壮，如果它只是单元测试代码，这并不重要）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T16:01:35.060

如果您反复使用难以在字面字符串中表达的字符（例如，、、`"`不在`\`中的字符`[ -~]`），那么您可能需要考虑在使用之前对字符串进行快速查找和替换。例如，如果您经常使用 \，那么您可能会编写一个函数来交换 \ 和 /。您可以使用多字符序列来表示重音字符。

然而，最终得到一个与问题不成比例的解决方案显然是危险的。有时`\u####`只是更容易。

如果您要查找非 Java 文件，我建议将它们作为资源 ( `Class.getResourceAsStream`/ `getResource`) 而不是松散文件打开。

# c# - 区分大型数据列表的最佳方法、算法、方法是什么？

> ID：461685
> 
> 赞同：1
> 
> 时间：2009-01-20T15:09:44.697
> 
> 标签：c#, sql, algorithm

我每天都会收到大量当前帐号，并将它们存储在数据库中。我的任务是从每个文件中找到添加和释放的帐户。现在，我有 4 个 SQL 表（AccountsCurrent、AccountsNew、AccountsAdded、AccountsRemoved）。当我收到一个文件时，我会将它完全添加到 AccountsNew。然后运行以下查询以查找我们添加和删除的查询。

```
INSERT AccountsAdded(AccountNum, Name) SELECT AccountNum, Name FROM AccountsNew WHERE AccountNumber not in (SELECT AccountNum FROM AccountsCurrent)

INSERT AccountsRemoved(AccountNum, Name) SELECT AccountNum, Name FROM AccountsCurrent WHERE AccountNumber not in (SELECT AccountNum FROM AccountsNew)

TRUNCATE TABLE AccountsCurrent

INSERT AccountsCurrent(AccountNum, Name) SELECT AccountNum, Name FROM AccountsNew

TRUNCATE TABLE AccountsNew 
```

现在，我正在区分大约 250,000 个帐户，但这将继续增长。这是最好的方法吗，您还有其他想法吗？

编辑：这是一个 MSSQL 2000 数据库。我正在使用 c# 来处理文件。

我关注的唯一数据是在上一个文件和当前文件之间添加和删除的帐户。AccountsCurrent 仅用于确定添加或删除了哪些帐户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T15:18:22.400

听起来像是一个历史/审计过程，最好使用触发器来完成。有一个单独的历史表来捕获更改（例如，时间戳、操作、执行更改的人员等）

新的和删除的帐户很容易理解。“当前”帐户意味着在新帐户和已删除帐户之间存在中间状态。我看不出“新”和“添加”之间有什么区别。

我不会有四张桌子。我将有一个具有不同可能状态的 STATUS 表，并且 ACCOUNTS 或 HISTORY 表将有一个外键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T15:30:37.057

老实说，我认为我会遵循您的方法。一件事是您可以删除截断，将“新”重命名为“当前”并重新创建“新”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T16:52:12.213

在长列表上使用 IN 子句可能会很慢。

如果表被索引，使用 LEFT JOIN 可以证明更快......

```
INSERT INTO [table] (
    [fields]
    )
SELECT
    [fields]
FROM
    [table1]
LEFT JOIN
    [table2]
        ON [join condition]
WHERE
    [table2].[id] IS NULL 
```

这假设 1:1 关系而不是 1:many。如果你有 1:many 你可以做任何...
1\. SELECT DISTINCT
2\. 使用 GROUP BY 子句
3\. 使用不同的查询，见下文...

```
INSERT INTO [table] (
    [fields]
    )
SELECT
    [fields]
FROM
    [table1]
WHERE
    EXISTS (SELECT * FROM [table2] WHERE [condition to match tables 1 and 2])

-- # This is quick provided that all fields to match the two tables are
-- # indexed in both tables.  Should then be much faster than the IN clause. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T17:21:58.797

您还可以减去交集以获得一张表中的差异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T17:29:13.947

如果初始文件以合理且一致的方式排序（大 IF！），它将作为逻辑比较文件的 C# 程序运行得更快。

# c# - 在c#中找出谁在监听PropertyChangedEventHandler

> ID：461690
> 
> 赞同：0
> 
> 时间：2009-01-20T15:11:08.780
> 
> 标签：c#, wpf, data-binding, inotifypropertychanged

我有一个 WPF 表单，我正在处理数据绑定。我得到了从 INotifyPropertyChanged 引发的事件，但我想看看如何获​​取正在监听的项目的列表，我启动了连接的处理程序。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T15:16:36.023

[http://msdn.microsoft.com/en-us/library/system.delegate.getinvocationlist.aspx](http://msdn.microsoft.com/en-us/library/system.delegate.getinvocationlist.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T15:14:13.267

你对正在听的项目是什么意思？

您是否想知道哪些控件数据绑定到您的属性，或者您是否想要一个连接到 PropertyChanged 事件的事件处理程序列表？

后者可以通过在事件上调用 GetInvocationList 来完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T15:41:31.653

在您的事件实例上调用 GetInvocationList()。你会得到一个代表数组（如果有的话）：Delegate[]. 对于每个委托，您可以检查 Method 属性 - 以获取充当侦听器的方法的 MethodInfo；或 Target 属性 - 获取定义了监听器方法的对象实例

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T15:50:04.523

感谢所有的答案，我设法将其追踪到不同属性的空引用（非常幸运的发现！）

# c# - 在没有第三方控件的情况下，如何在 Win Form [.Net] 中深入报告？

> ID：461701
> 
> 赞同：0
> 
> 时间：2009-01-20T15:14:08.370
> 
> 标签：c#, .net, winforms

看起来我唯一的选择是创建树视图和数据网格视图的突变子视图，但我主要是 asp.net 开发人员，因此我缺乏对所有事物窗口的了解。但我确定有一个替代的更简单的解决方案，所以在我走这条丑陋的道路之前，有没有人知道在winform应用程序中创建向下钻取报告的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T15:18:27.127

为什么不现在使用 .NET 附带的 Crystal Reports 查看器？

[.NET 中的 Crystal Reports 简介](http://www.c-sharpcorner.com/UploadFile/mahesh/CrystalReportsIntroduction11082005014959AM/CrystalReportsIntroduction.aspx)

# c# - 在 C# 中将关系数据库映射到 XML

> ID：461706
> 
> 赞同：1
> 
> 时间：2009-01-20T15:15:59.690
> 
> 标签：c#, xml, database, xsd

我有一个需要将关系数据库映射到 XML 的应用程序。问题是给出了数据库结构（我无法更改它）并且给出了 XML 模式（来自 WSDL）。

我需要让我的应用程序的用户告诉系统表中的给定列映射到模式中的给定元素。然后我的应用程序需要根据数据库数据创建 XML。

有什么技术可以帮助我吗？是否有 C# 控件。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-01T20:29:53.657

XSLT。我认为您应该动态地（基于用户输入）创建 xslt 并将数据从数据库（数据集？）转换为 xml。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T06:32:49.477

你的数据库是什么——SQL Server？您可以使用 SQL Server 中的 SELECT .... FOR XML 语句获得很多 XML 灵活性（最肯定的是在 2005 年及更高版本）。

如果这还不够灵活，那么我会提出第二个“peeles”建议——首先执行 SELECT...FOR XML 并使用 XSLT 转换输出。

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-20T21:02:05.387

选择...听起来更简单；但 C# 中的 LINQ 可能是另一种选择。

# c# - 如何使用 Winforms 显示和存储复杂项目的列表？

> ID：461707
> 
> 赞同：0
> 
> 时间：2009-01-20T15:16:09.097
> 
> 标签：c#, winforms, listview, custom-controls

我想存储和显示复杂项目的列表。每个（图形）项目必须显示一个图像、一个色卡列表、一个标签和一个索引（一个字母）。用户还可以放大每个项目，以显示图像的详细信息（在鼠标滚轮上），

项目将显示在垂直列表中，可滚动且可调整大小。

仅在必要时使用 C#、.net2.0 或 3.5 语言。

我正在考虑对项目使用自定义用户控件（每个项目都由一个图片框、2 个标签和一个自定义用户控件组成，以显示颜色芯片）。对于列表，我真的不知道在 ListBox、ListView 或 DataGridView 之间选择什么，或者我还不知道的另一个。

为了简单起见，我基本上会选择 ListBox。你能帮我澄清一下使用其他列表的好处吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T16:09:34.310

如果您希望拥有大量这些项目，我强烈建议您不要将每个项目都设置为 UserControl。如果您打算在某个时候对应用程序进行本地化和全球化，这一点非常重要。这些项目的创建将阻碍性能。

取而代之的是，采用更轻量级的方法，这样项目就不会产生全面控制的开销。假设每个项目都是矩形的，您可以轻松地创建一个用户控件来绘制它们，包括一个滚动条来滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T08:49:11.717

感谢您的回答。这对我很有帮助。很抱歉，我没有提到列表及其项目必须使用其他控件管理拖放。然后，我认为项目必须是单独的控件。此外，列表将是动态的，并且不会包含超过 30 个项目。

因此，如果我理解您的建议，我应该为列表和项目创建一个自定义 UserControl。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T16:07:31.007

在您的情况下，自定义（第三方）列表控件似乎是要走的路。鉴于您的要求，ListBox、ListView 或 DataGridView 过于有限。

问候，坦伯格

# spring - Spring中的自动配置重新初始化

> ID：461710
> 
> 赞同：13
> 
> 时间：2009-01-20T15:17:02.060
> 
> 标签：spring

在 Log4j 中，有一个功能可以初始化系统以执行配置和间隔监视。这允许 log4j 系统在属性文件更改时重新加载其属性。spring 框架是否有这样的 Configuration Observer 工具，其中 Configuration 在更改时重新加载。需要重新加载的配置不是 Springs 的 applicationContext.xml，而是使用 Spring 初始化 bean 初始化的各种其他配置文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T15:32:15.087

[我在这里](http://www.wuenschenswert.net/wunschdenken/archives/138)找到了一个类似于 Log4J 的实用程序。它基本上是 PropertyPlaceholderConfigurer 的扩展，可在属性更改时重新加载它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T15:21:43.813

AFAIK Spring 不提供这样的实用程序。但是，有一个第三方工具[JRebel](http://zeroturnaround.com/software/jrebel/)可以让您更新整个 Web 应用程序（包括 Spring 配置），而无需重新启动服务器。

可以免费试用，而且购买价格相当便宜。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T18:36:43.780

重新加载 spring 应用程序上下文时我会格外小心。

你期望单例 bean 会发生什么？如果一个对象引用了单例 bean，是否应该更新它？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-26T14:04:11.970

我使用 JRebel 进行开发，我会非常警惕期望它会刷新您的配置。可以在 Java 上正常工作，但不能在 Spring 上工作。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-09T10:04:09.807

如果您想添加上下文，我已通过以下方式完成：

```
public class ApplicationContextUtil
{
   static String[] configFiles = {"applicationContextParent.xml"};

   private static ApplicationContext context = null;

   static
   {
       context = new ClassPathXmlApplicationContext ( configFiles );
   }

   public static void addContext( String[] newConfigFiles )
   {
       // add the new context to the previous context
       ApplicationContext newContext =  new ClassPathXmlApplicationContext ( newConfigFiles, context );
       context = newContext;
   }   
   public static ApplicationContext getApplicationContext ()
   {
       // return the context
       return context;
   }
} 
```

这是您的上下文提供程序类。详细可以看[我的博客](https://sites.google.com/site/sohelasrafblog/spring/spring-configuration)

# c++ - 在 Cygwin 中处理“C 编译器无法创建可执行文件”

> ID：461711
> 
> 赞同：4
> 
> 时间：2009-01-20T15:17:51.420
> 
> 标签：c++, gcc, compiler-construction, cygwin, g++

无论我尝试在 Cygwin 中编译什么，我都会得到以下输出：

```
检查mingw32环境...否
检查 EMX OS/2 环境...否
检查如何运行 C 预处理器... gcc -E
检查 gcc ... gcc
检查 C 编译器 (gcc) 是否工作...否
配置：错误：安装或配置问题：C编译器无法创建
e 可执行文件。

```

日志文件的最后几行如下所示：

```
配置：2810：检查 EMX OS/2 环境
配置：2822：gcc -c conftest.c 1>&5
配置：在函数“主”中：
配置：2818：错误：`__EMX__' 未声明（在此函数中首次使用）
配置：2818：错误：（每个未声明的标识符只报告一次
配置：2818：错误：对于它出现的每个函数。）
配置：失败的程序是：
#line 2815 “配置”
#include "confdefs.h"

int main() {
返回 __EMX__;
; 返回0；}
配置：2838：检查如何运行 C 预处理器
配置：2859：gcc -E conftest.c >/dev/null 2>conftest.out
配置：2943：检查 gcc
configure:3056: 检查 C 编译器 (gcc) 是否工作
配置：3072：gcc -o conftest conftest.c -llib 1>&5
/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld：找不到
 -llib
collect2: ld 返回 1 个退出状态
配置：失败的程序是：

#line 3067 “配置”
#include "confdefs.h"

主要（）{返回（0）；}

```

这是一个全新的 Cygwin 安装，带有 G++ 和许多其他开发工具。知道我需要做什么才能让这件事正常工作吗？

更新 0：尼克，您已经尝试了指向[http://www.geektimes.com/linux/troubleshooting/c-cant-create-executables.html](http://www.geektimes.com/linux/troubleshooting/c-cant-create-executables.html)的链接- 不幸的是，此说明适用于 redhat，似乎不适用于 cygwin。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-05-29T20:13:44.833

您的配置错误。通常`autoreconf -f`会有所帮助。如果不是，您需要检查失败的规则并修复它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T15:27:02.757

'-llib' 对我来说似乎有点不寻常，但我远非专家。只是出于好奇，是否安装了 autoconf？在我安装 autoconf 之前，我遇到了一些类似的问题。似乎配置脚本错误地生成了“-llib”值，但仅根据发布的片段很难说出原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T00:53:55.157

当我遇到这个问题时，这是由 Cygwin 寻找“library.o”而不是“library.obj”或“library.so”而不是“library.dll”引起的链接错误。

# vb.net - VB.NET中跨多行的单个语句，不带下划线字符

> ID：461714
> 
> 赞同：40
> 
> 时间：2009-01-20T15:18:29.017
> 
> 标签：vb.net

有没有办法在没有下划线字符的情况下跨多行声明？

在 SQL 语句等多行字符串中，尤其是[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)查询中，这确实很烦人。

除了换行时的丑陋和困难（不再排队）之外，您不能在多行语句的中间使用注释。

我的日常个人地狱的例子。

```
dim results = from a in articles _
              where a.articleID = 4 _ ' articleID     - Nope, can't do this
              select a.articleName

dim createArticle as string = _
    "Create table article " & _
    "    (articleID int " & _
    "    ,articleName varchar(50) " & _
    "    )" 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-20T16:25:25.230

不，您必须使用下划线，但我相信 VB.NET 10 将允许多行不带下划线，仅在无法确定结束位置时才需要。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-11-01T02:34:53.290

对于大多数使用带有内部 CDATA 块的 XML 元素的多行字符串，更容易避免必须为简单的原始字符串数据转义任何内容。

```
Dim s as string = <s><![CDATA[Line 1
line 2
line 3]]></s>.Value 
```

请注意，我见过很多人声明相同的格式，但没有包装“< s >”标签（只是 CDATA 块），但是 Visual Studio 自动格式化接缝以改变每行的前导空格。我认为这是由于 Linq“X”对象背后的对象继承结构。CDATA 不是“容器”，外部块是从 XContainer 继承的 XElement。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-01-19T17:23:10.913

从 VB.NET 10 开始，许多语法元素都支持*隐式续行（请参阅*[Visual Basic 中的语句：在多行上继续语句](https://msdn.microsoft.com/en-us/library/865x40k4.aspx)）。连接运算符 (&) 在支持隐式续行的语法元素列表中。还支持散布的评论，因此您的第二个示例可以重写为：

```
dim createArticle as string = 
    "Create table article " &
    "    (articleID int " &           ' Comment for articleID
    "    ,articleName varchar(50) " & ' Comment for articleName
    "    )" 
```

隐式续行也适用于查询运算符，但有一些限制：

> 前后查询运算符（**Aggregate**、**Distinct**、**From**、**Group By**、**Group Join**、**Join**、**Let**、**Order By**、**Select**、**Skip**、**Skip While**、**Take**、**Take While**、**Where**、**In**、**Into**、**On**、**Ascending**和**Descending**） . 您不能在由多个关键字（**Order By**，**Group Join**、**Take While**和**Skip While**）。

同样，允许散布注释，因此您的第一个示例可以重写为：

```
dim results = from a in articles
              where a.articleID = 4  ' articleID - now perfectly legal
              select a.articleName 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-20T15:21:58.790

我会说不。

但我拥有的唯一证据是个人经验以及在线延续文档中没有其他任何内容的事实。

[http://msdn.microsoft.com/en-us/library/aa711641(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa711641(VS.71).aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T15:34:26.813

不，下划线是唯一的延续字符。就个人而言，我更喜欢偶尔使用延续字符，而不是像在 C# 中那样被迫始终使用它，但除了评论问题（我同意这有时很烦人）之外，让事情排队并不是问题。

无论如何，使用 VS2008，只需选择第二行和以下行，按几次 Tab 键，它就会移动整个区域。

如果它有点过分，您可以一次删除一个字符的多余空间。这有点繁琐，但一旦保存，它就会保持原样。

在这还不够好的极少数情况下，我有时会使用以下技术来对齐：

```
dim results as String = ""
results += "from a in articles "
results += "where a.articleID = 4 " 'and now you can add comments
results += "select a.articleName" 
```

它并不完美，我知道那些喜欢 C# 的人会啧啧称奇，但确实如此。这是一种风格选择，但我仍然更喜欢它而不是无尽的分号。

现在我只是在等待有人告诉我我应该使用 StringBuilder ;-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-03T14:03:47.373

我知道这有一个公认的答案，但它是我在搜索这个问题时找到的顶级文章，现在已经非常过时了。我做了更多研究，[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/865x40k4%28v=vs.100%29.aspx)包含一个语法元素列表，这些元素隐含地继续 VB.Net 2010 的下一行代码中的语句。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-06-06T17:43:56.037

不确定是否可以使用多行代码执行此操作，但可以执行多行变量：

[VB.NET 中的多行字符串](https://stackoverflow.com/a/24087600/3715973)

这是相关的块：

我想出了如何将 <![CDATA[ 与 <%= 一起用于变量，这使您可以放心编码。

您基本上必须在 VB 变量之前终止 CDATA 标记，然后在之后重新添加它，这样 CDATA 就不会捕获 VB 代码。您需要将整个代码块包装在标签中，因为您将拥有多个 CDATA 块。

```
Dim script As String = <code><![CDATA[
  <script type="text/javascript">
    var URL = ']]><%= domain %><![CDATA[/mypage.html';
  </script>]]>
</code>.value 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-14T16:56:52.977

您可以使用 XML 文字来执行此操作：

```
Dim s = <sql>
  Create table article
  (articleID int  -- sql comment
  ,articleName varchar(50)  <comment text="here's an xml comment" />
  )
</sql>.Value 
```

警告：应用 XML 文本规则，例如 & 对于 & 符号，< 对于 < 等。

```
Dim alertText = "Hello World"
Dim js = <script>
          $(document).ready(function() {
           alert('<%= alertText %>');
          });
         </script>.ToString  'instead of .Value includes <script> tag 
```

注意：当上面包含需要转义的字符时，上面是有问题的。更好用`"<script>"+js.Value+"</script>"`

# c# - 如何以部分信任从剪贴板中检索文本

> ID：461717
> 
> 赞同：0
> 
> 时间：2009-01-20T15:19:41.307
> 
> 标签：c#, wpf, .net-3.5, clipboard, copy-paste

我们有一个 RichTextBox WPF 控件，由于我们控制布局，我们根本不允许任何丰富的内容......

因此，我们需要从剪贴板中删除除文本之外的所有数据。例如，如果有人试图直接从 Microsoft Word 复制/粘贴表格中的文本，RichTextBox 还会考虑该文本是 1\. 最初来自表格、2\. 粗体和 3\. 下划线，并创建所有各种内联内容来容纳文本的所有这些属性......

在我们的例子中，这不是适当的行为，因为它会破坏我们的内联布局......我们只想要干净的文本......

最简单的方法是，在预览粘贴命令中：

```
Clipboard.SetText(Clipboard.GetText()); 
```

并完成它......但你猜对了......剪贴板操作在部分信任中是不允许的......

我们还尝试了一个肮脏讨厌的黑客，使用此链接建议的隐藏文本框：http:
[//social.msdn.microsoft.com/Forums/en-US/wpf/thread/5b5bcd71-2eea-4762-bf65-84176c919fce/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/5b5bcd71-2eea-4762-bf65-84176c919fce/)

像这样：

```
public static class ClipboardManager
{
    private static readonly TextBox textBox = new TextBox {AcceptsReturn = true, AcceptsTab = true};

    public static void SetText(string text)
    {
        textBox.Text = text;
        textBox.SelectAll();
        textBox.Copy();
    }

    public static string GetText()
    {
        textBox.Clear();
        textBox.Paste();
        return textBox.Text;
    }
} 
```

然后这样称呼它：

```
ClipboardManager.SetText(ClipboardManager.GetText()); 
```

这在完全信任下运行良好，但由于某种原因，TextBox 的 Copy 和 Paste 方法在部分信任下都不起作用......

有谁知道如何在 WPF/部分信任中检索剪贴板的内容？

谢谢

**编辑：**正如 Nir ​​指出的那样..我知道从剪贴板中改变数据并不是很好。但是如果有人能指出我如何在部分信任的情况下仅从剪贴板中检索文本，我的问题将得到同样的回答:)..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-03-26T11:53:19.393

这根本不可能。

最后，我们使用了一个切换按钮，您可以在其中切换到一个文本框，将其粘贴到那里，然后切换回我们的控件。讨厌，但它的工作原理。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-20T15:26:27.563

[http://msdn.microsoft.com/en-us/library/aa970910.aspx](http://msdn.microsoft.com/en-us/library/aa970910.aspx)在部分信任中仅表示“纯文本和墨水剪贴板支持”。“富文本格式剪贴板”需要完全信任

# c# - OracleDataReader 在检查后丢失结果

> ID：461730
> 
> 赞同：0
> 
> 时间：2009-01-20T15:23:25.993
> 
> 标签：c#, visual-studio, oracle, debugging

我在 Visual Studio 中遇到了一个古怪的“功能”，我很想看看其他人是否注意到了这一点。或者，如果它是针对我自己的。

我有一些方法可以在数据库上执行 SQL 查询，然后返回 OracleDataReader

```
method()
{
OracleCommand cmd = new command(query, connection);
OracleDataReader r = cmd.ExecuteReader();

return r;
} 
```

当我调试使用这种方法的代码时。我可以点击非公共成员来查看结果中的行。但是，一旦我查看了这些结果，尝试在 OracleDataReader 上执行 reader.Read() 不包含任何结果。检查调试器视图中的结果显示阅读器为空。

每当我不检查结果时，执行 Read 的代码都可以正常工作。

我没有通过谷歌找到这方面的证据，但我的搜索技巧往往有很多不足之处。如果有人可以在他们自己的系统上确认这一点或阐明原因，我将不胜感激。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T15:29:11.117

从 IDataReader 派生的 ADO.NET 对象（如您的 OracleDataReader）提供对查询返回的数据的连接的、只进的访问，因此当您在调试可视化工具中查看结果时，您实际上是在逐步浏览真实数据。当程序运行时，DataReader 已经遍历数据并（正确地）报告它现在是空的。

如果您希望灵活地在调试器中查看数据，您可以考虑使用断开连接的随机访问数据访问类，如 DataSet 或 DataTable。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T17:56:31.737

我看到的恰恰相反。我愿意

```
 OracleDataReader reader = cmd.ExecuteReader();
    return reader;
    .... return it up the stack a couple more levels; 
```

除非我调用`reader.hasRows`堆栈的每一层，否则我的结果似乎会偏离，当我尝试访问它们时会得到空指针。

# visual-studio - 将项目的现有版本和分支置于版本控制之下

> ID：461735
> 
> 赞同：2
> 
> 时间：2009-01-20T15:24:08.363
> 
> 标签：visual-studio, version-control

我是软件项目的唯一开发人员。直到现在我还没有使用任何版本控制。我知道我可以将项目的最后一个版本置于版本控制之下。问题是是否可以将项目的旧版本和分支置于版本控制之下。如果可能，如何？我应该使用哪个版本控制软件？（我正在使用 Visual Studio 2008）

编辑：我几乎有所有以前的版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T15:28:29.760

您可以这样做，前提是您有想要放入源代码控制的旧版本的副本（当然，您不能神奇地让它们出现）。

我要做的是将最旧的版本放在某个地方，然后将该文件夹提交到您的源代码管理（这将成为修订版 1）。然后，取第二旧的版本，用它覆盖硬盘上的第一个版本，然后再次签入（这在源代码控制中成为修订版 2）。重复，每次都用下一个最新的版本覆盖，直到您想要的所有版本都被签入。

有很好的免费版本控制系统可用。我使用 SVN（带有 TortoiseSVN shell 插件），我对此非常满意。CVS 也不错，但是随着项目变大变得非常慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T15:30:23.390

您应该使用哪种 VCS 完全取决于您。我推荐[Mercurial](http://selenic.com/wiki/Mercurial)，因为它是一个非常好的分布式 VCS，并且在 Windows 下运行得相当好。我不知道 VS 支持什么，但您可能想使用受支持的 VCS（我猜这可能意味着 Subversion）。[那里](http://tortoisehg.sourceforge.net/)也有 TortoiseHg 。

如果您拥有所有以前的版本，则可以手动导入它们，一个接一个地进入最后一个，然后从那里开始工作。

# f# - F# - 我应该在有还是没有#light 的情况下学习？

> ID：461739
> 
> 赞同：32
> 
> 时间：2009-01-20T15:24:50.687
> 
> 标签：f#

我正在学习 F#，到目前为止我很享受。几乎所有在线示例都使用轻量级语法（#light）；但是，在大多数情况下，还要对上述示例进行评论。

使用启用或禁用#light 来学习 F# 更好吗？我计划最终在不打开它的情况下学习它，但我很好奇是在开始时学习它还是在我更了解核心语言后继续应用它会更好。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-20T16:05:52.260

我肯定更喜欢使用#light 语法来学习 F#。non-light 版本有时有助于理解 F# 语法的一些技巧，但 #light 语法会给您带来很多愉快的体验。

例如 - 使用#light

```
let add a b c = 
  let ab = a + b
  printfn "%d" ab
  c - ab 
```

使用 non-light 你可以这样写：

```
let add a b c = 
  let ab = a + b in // 'in' keyword specifies where the binding (value 'ab') is valid
  printfn "%d" ab;  // ';' is operator for sequencing expressions
  c - ab;;          // ';;' is end of a function declaration 
```

例如，这表明您不能编写如下内容：

```
let doNothing a b = 
  let sum = a + b in 
```

最后有一个'in'关键字，但函数没有任何主体（因为'in'后面没有表达式）。在这种情况下，非轻量级语法有时有助于理解正在发生的事情……但正如您所见，#light 代码要简单得多。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-21T02:03:20.400

“#light”可能会成为该语言未来版本的默认设置，所以我会这样学习。我认为除了 OCaml 兼容性之外，很少有人使用较重的语法（在交叉编译时，或者因为坐在键盘上的人知道 OCaml 并且正在更平滑地过渡到 F#）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-23T20:45:50.663

因为我从 OCaml 书籍中学习了 F#（并且我使用 Emacs 的 OCaml 模式来编辑 F# 代码），所以我更喜欢使用“重”语法。我使用过#light 代码，当然，大多数 F# 示例都是使用 light 语法编写的，因此熟悉一些基本知识是很有用的。也就是说，从重到轻切换比从其他方式切换要容易得多，因此使用重语法学习它当然不是一个坏主意。

我偶尔会遇到烦人的错误，其中繁重的语法被视为二等公民（计算表达式的组合被破坏了几个版本），但这些非常罕见。一般来说，我认为差异不是很显着，我需要仔细观察才能确定在单独查看代码时使用的是哪种语法。YMMV。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T20:48:49.610

如果我没记错的话，“Expert C#”一书提到 #light 将是 F# 发布时的默认值，并且非轻型语法仅用于兼容性。

# c# - 如何在 C# 中将 IPv4 地址转换为整数？

> ID：461742
> 
> 赞同：113
> 
> 时间：2009-01-20T15:25:57.347
> 
> 标签：c#, integer, ip, ipv4

我正在寻找将标准 IPv4 地址转换为整数的函数。可用于相反的功能的奖励积分。

解决方案应该在 C# 中。

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-01-20T15:30:52.627

32 位无符号整数**是**IPv4 地址。同时，该`IPAddress.Address`属性虽然已被弃用，但它是一个 Int64，它返回 IPv4 地址的无符号 32 位值（问题是，它按网络字节顺序排列，因此您需要交换它）。

例如，我的本地 google.com 位于`64.233.187.99`. 这相当于：

```
64*2^24 + 233*2^16 + 187*2^8 + 99
= 1089059683 
```

确实，[http://1089059683/](http://1089059683/)按预期工作（至少在 Windows 中，用 IE、Firefox 和 Chrome 测试；但在 iPhone 上不起作用）。

这是一个显示两种转换的测试程序，包括网络/主机字节交换：

```
using System;
using System.Net;

class App
{
    static long ToInt(string addr)
    {
        // careful of sign extension: convert to uint first;
        // unsigned NetworkToHostOrder ought to be provided.
        return (long) (uint) IPAddress.NetworkToHostOrder(
             (int) IPAddress.Parse(addr).Address);
    }

    static string ToAddr(long address)
    {
        return IPAddress.Parse(address.ToString()).ToString();
        // This also works:
        // return new IPAddress((uint) IPAddress.HostToNetworkOrder(
        //    (int) address)).ToString();
    }

    static void Main()
    {
        Console.WriteLine(ToInt("64.233.187.99"));
        Console.WriteLine(ToAddr(1089059683));
    }
} 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2012-11-12T19:49:21.440

这是一对从 IPv4 转换为*正确*整数并返回的方法：

```
public static uint ConvertFromIpAddressToInteger(string ipAddress)
{
    var address = IPAddress.Parse(ipAddress);
    byte[] bytes = address.GetAddressBytes();

    // flip big-endian(network order) to little-endian
    if (BitConverter.IsLittleEndian)
    {
        Array.Reverse(bytes);
    }

    return BitConverter.ToUInt32(bytes, 0);
}

public static string ConvertFromIntegerToIpAddress(uint ipAddress)
{
    byte[] bytes = BitConverter.GetBytes(ipAddress);

    // flip little-endian to big-endian(network order)
    if (BitConverter.IsLittleEndian)
    {
        Array.Reverse(bytes);
    }

    return new IPAddress(bytes).ToString();
} 
```

**例子**

```
ConvertFromIpAddressToInteger("255.255.255.254"); // 4294967294
ConvertFromIntegerToIpAddress(4294967294); // 255.255.255.254 
```

**解释**

IP 地址按网络顺序（大端），而`int`s 在 Windows 上是小端，因此要获得正确的值，您必须在小端系统上转换之前反转字节。

此外，即使对于`IPv4`， an`int`也不能保存大于`127.255.255.255`的地址，例如广播地址`(255.255.255.255)`，所以使用 a `uint`。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-01-21T08:41:30.843

@Barry Kelly 和@Andrew Hare，实际上，我认为乘法并不是最明确的方法（完全正确）。

一个 Int32 “格式化”的 IP 地址可以看成如下结构

```
[StructLayout(LayoutKind.Sequential, Pack = 1)] 
struct IPv4Address
{
   public Byte A;
   public Byte B;
   public Byte C;
   public Byte D;
} 
// to actually cast it from or to an int32 I think you 
// need to reverse the fields due to little endian 
```

所以要转换 IP 地址 64.233.187.99 你可以这样做：

```
(64  = 0x40) << 24 == 0x40000000
(233 = 0xE9) << 16 == 0x00E90000
(187 = 0xBB) << 8  == 0x0000BB00
(99  = 0x63)       == 0x00000063
                      ---------- =|
                      0x40E9BB63 
```

所以你可以使用 + 将它们相加，或者你可以二进制或它们一起。导致 0x40E9BB63 即 1089059683。（在我看来，以十六进制查看更容易查看字节）

所以你可以把函数写成：

```
int ipToInt(int first, int second, 
    int third, int fourth)
{
    return (first << 24) | (second << 16) | (third << 8) | (fourth);
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-28T14:55:53.927

试试这个：

```
private int IpToInt32(string ipAddress)
{
   return BitConverter.ToInt32(IPAddress.Parse(ipAddress).GetAddressBytes().Reverse().ToArray(), 0);
}

private string Int32ToIp(int ipAddress)
{
   return new IPAddress(BitConverter.GetBytes(ipAddress).Reverse().ToArray()).ToString();
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-11-08T20:13:47.047

当面对具有非常大值的 IP 地址时，我在所描述的解决方案中遇到了一些问题。结果是，byte[0] * 16777216 的东西会溢出并变成负 int 值。为我解决的问题是简单的类型转换操作。

```
public static long ConvertIPToLong(string ipAddress)
{
    System.Net.IPAddress ip;

    if (System.Net.IPAddress.TryParse(ipAddress, out ip))
    {
        byte[] bytes = ip.GetAddressBytes();

        return
            16777216L * bytes[0] +
            65536 * bytes[1] +
            256 * bytes[2] +
            bytes[3]
            ;
    }
    else
        return 0;
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-11-01T13:52:45.490

由于没有人发布使用`BitConverter`并实际检查字节顺序的代码，这里是：

```
byte[] ip = address.Split('.').Select(s => Byte.Parse(s)).ToArray();
if (BitConverter.IsLittleEndian) {
  Array.Reverse(ip);
}
int num = BitConverter.ToInt32(ip, 0); 
```

然后回来：

```
byte[] ip = BitConverter.GetBytes(num);
if (BitConverter.IsLittleEndian) {
  Array.Reverse(ip);
}
string address = String.Join(".", ip.Select(n => n.ToString())); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-12-21T18:46:48.020

戴维兰德曼函数的反转

```
string IntToIp(int d)
{
  int v1 = d & 0xff;
  int v2 = (d >> 8) & 0xff;
  int v3 = (d >> 16) & 0xff;
  int v4 = (d >> 24);
  return v4 + "." + v3 + "." + v2 + "." + v1;
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-22T09:18:08.307

我的问题被关闭了，我不知道为什么。这里接受的答案与我需要的不同。

这为我提供了 IP 的正确整数值..

```
public double IPAddressToNumber(string IPaddress)
{
    int i;
    string [] arrDec;
    double num = 0;
    if (IPaddress == "")
    {
        return 0;
    }
    else
    {
        arrDec = IPaddress.Split('.');
        for(i = arrDec.Length - 1; i >= 0 ; i = i -1)
            {
                num += ((int.Parse(arrDec[i])%256) * Math.Pow(256 ,(3 - i )));
            }
        return num;
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-01-17T21:01:03.983

使用正确的小端格式的 UInt32，这里有两个简单的转换函数：

```
public uint GetIpAsUInt32(string ipString)
{
    IPAddress address = IPAddress.Parse(ipString);

    byte[] ipBytes = address.GetAddressBytes();

    Array.Reverse(ipBytes);

    return BitConverter.ToUInt32(ipBytes, 0);
}

public string GetIpAsString(uint ipVal)
{
    byte[] ipBytes = BitConverter.GetBytes(ipVal);

    Array.Reverse(ipBytes);

    return new IPAddress(ipBytes).ToString();
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-05-31T18:34:08.070

将上述几个答案组装成一个扩展方法，该方法处理机器的字节序并处理映射到 IPv6 的 IPv4 地址。

```
public static class IPAddressExtensions
{
    /// <summary>
    /// Converts IPv4 and IPv4 mapped to IPv6 addresses to an unsigned integer.
    /// </summary>
    /// <param name="address">The address to conver</param>
    /// <returns>An unsigned integer that represents an IPv4 address.</returns>
    public static uint ToUint(this IPAddress address)
    {
        if (address.AddressFamily == AddressFamily.InterNetwork || address.IsIPv4MappedToIPv6)
        {
            var bytes = address.GetAddressBytes();
            if (BitConverter.IsLittleEndian)
                Array.Reverse(bytes);

            return BitConverter.ToUInt32(bytes, 0);
        }
        throw new ArgumentOutOfRangeException("address", "Address must be IPv4 or IPv4 mapped to IPv6");
    }
} 
```

单元测试：

```
[TestClass]
public class IPAddressExtensionsTests
{
    [TestMethod]
    public void SimpleIp1()
    {
        var ip = IPAddress.Parse("0.0.0.15");
        uint expected = GetExpected(0, 0, 0, 15);
        Assert.AreEqual(expected, ip.ToUint());
    }
    [TestMethod]
    public void SimpleIp2()
    {
        var ip = IPAddress.Parse("0.0.1.15");
        uint expected = GetExpected(0, 0, 1, 15);
        Assert.AreEqual(expected, ip.ToUint());
    }
    [TestMethod]
    public void SimpleIpSix1()
    {
        var ip = IPAddress.Parse("0.0.0.15").MapToIPv6();
        uint expected = GetExpected(0, 0, 0, 15);
        Assert.AreEqual(expected, ip.ToUint());
    }
    [TestMethod]
    public void SimpleIpSix2()
    {
        var ip = IPAddress.Parse("0.0.1.15").MapToIPv6();
        uint expected = GetExpected(0, 0, 1, 15);
        Assert.AreEqual(expected, ip.ToUint());
    }
    [TestMethod]
    public void HighBits()
    {
        var ip = IPAddress.Parse("200.12.1.15").MapToIPv6();
        uint expected = GetExpected(200, 12, 1, 15);
        Assert.AreEqual(expected, ip.ToUint());
    }
    uint GetExpected(uint a, uint b, uint c, uint d)
    {
        return
            (a * 256u * 256u * 256u) +
            (b * 256u * 256u) +
            (c * 256u) +
            (d);
    }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-04-16T22:01:30.230

```
 public static Int32 getLongIPAddress(string ipAddress)
    {
        return IPAddress.NetworkToHostOrder(BitConverter.ToInt32(IPAddress.Parse(ipAddress).GetAddressBytes(), 0));
    } 
```

上面的例子就是我要走的路。你唯一需要做的就是转换为 UInt32 用于显示目的或字符串目的，包括将其用作字符串形式的长地址。

这是使用 IPAddress.Parse(String) 函数时需要的。叹。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-20T15:36:38.107

如果您对该功能感兴趣，那么这里的答案不仅仅是它是如何完成的：

```
int ipToInt(int first, int second, 
    int third, int fourth)
{
    return Convert.ToInt32((first * Math.Pow(256, 3))
        + (second * Math.Pow(256, 2)) + (third * 256) + fourth);
} 
```

其中`first`through`fourth`是 IPv4 地址的段。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-05-29T20:58:47.377

```
public bool TryParseIPv4Address(string value, out uint result)
{
    IPAddress ipAddress;

    if (!IPAddress.TryParse(value, out ipAddress) ||
        (ipAddress.AddressFamily != System.Net.Sockets.AddressFamily.InterNetwork))
    {
        result = 0;
        return false;
    }

    result = BitConverter.ToUInt32(ipAddress.GetAddressBytes().Reverse().ToArray(), 0);
    return true;
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-12-23T02:56:52.573

将 IP 编号的所有部分乘以 256 的幂（256x256x256、256x256、256 和 1。例如：

IPv4 地址：127.0.0.1 32 位数：= (127x256^3) + (0x256^2) + (0x256^1) + 1 = 2130706433

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-05T21:59:31.827

这是我今天制定的解决方案（应该先用谷歌搜索！）：

```
 private static string IpToDecimal2(string ipAddress)
    {
        // need a shift counter
        int shift = 3;

        // loop through the octets and compute the decimal version
        var octets = ipAddress.Split('.').Select(p => long.Parse(p));
        return octets.Aggregate(0L, (total, octet) => (total + (octet << (shift-- * 8)))).ToString();
    } 
```

我正在使用 LINQ、lambda 和一些泛型扩展，所以虽然它产生相同的结果，但它使用了一些新的语言特性，你可以用三行代码来完成。

如果你有兴趣，我在我的博客上有解释。

干杯，-jc

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-03-16T16:50:38.410

@Davy Ladman，您的 shift 解决方案是正确的，但仅适用于以小于或等于 99 的数字开头的 ip，事实上，第一个八位字节必须转换为 long。

无论如何，用 long 类型转换回来是相当困难的，因为存储 64 位（不是 32 用于 Ip）并用零填充 4 个字节

```
static uint ToInt(string addr)
{
   return BitConverter.ToUInt32(IPAddress.Parse(addr).GetAddressBytes(), 0);
}

static string ToAddr(uint address)
{
    return new IPAddress(address).ToString();
} 
```

享受！

马西莫

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-05T23:18:09.980

我认为这是错误的："65536" ==> 0.0.255.255" 应该是："65535" ==> 0.0.255.255" 或 "65536" ==> 0.1.0.0"

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-06-06T01:16:28.857

假设您有一个字符串格式的 IP 地址（例如 254.254.254.254）

```
string[] vals = inVal.Split('.');
uint output = 0;
for (byte i = 0; i < vals.Length; i++) output += (uint)(byte.Parse(vals[i]) << 8 * (vals.GetUpperBound(0) - i)); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-08-26T00:22:42.387

```
var ipAddress = "10.101.5.56";

var longAddress = long.Parse(string.Join("", ipAddress.Split('.').Select(x => x.PadLeft(3, '0'))));

Console.WriteLine(longAddress); 
```

输出：10101005056

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-03-16T04:01:28.253

```
var address = IPAddress.Parse("10.0.11.174").GetAddressBytes();
long m_Address = ((address[3] << 24 | address[2] << 16 | address[1] << 8 | address[0]) & 0x0FFFFFFFF); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-02-15T09:08:09.927

我注意到 System.Net.IPAddress 具有 Address 属性（System.Int64）和构造函数，它们也接受 Int64 数据类型。因此，您可以使用它来将 IP 地址转换为数字（虽然不是 Int32，而是 Int64）格式。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2009-01-22T08:32:05.497

看看 .Net 的 IPAddress.Parse 中一些疯狂的解析示例：（[MSDN](http://msdn.microsoft.com/en-us/library/system.net.ipaddress.parse.aspx)）

“65536” ==> 0.0.255.255
“20.2” ==> 20.0.0.2
“20.65535” ==> 20.0.255.255
“128.1.2” ==> 128.1.0.2

# eclipse - 如何在 Eclipse IDE 中修改键盘快捷键？

> ID：461743
> 
> 赞同：158
> 
> 时间：2009-01-20T15:26:04.803
> 
> 标签：eclipse, keyboard-shortcuts

标题或多或少说明了一切。`Alt`具体来说，为了运行 ant 脚本，我必须使用++ , ，这让我越来越`Shift`恼火。但我认为，如果我有这种能力，我会做很多事情，我会为目前没有的东西更改快捷方式/添加快捷方式。`x``q`

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2009-01-20T15:30:57.227

*窗口 > 首选项 > 常规 > 键*

特别是，编辑“Run Ant Build”命令。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-20T15:30:43.593

对于 Windows：

*窗口 > 首选项 > 常规 > 键*

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-11-18T22:44:44.593

对于mac，那将是

*Eclipse > 首选项 > 常规 > 键*

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-07-26T11:57:46.437

按`Ctrl`+ `Shift`+`L`将打开当前定义的快捷方式列表，再次按`Ctrl`+ `Shift`+`L`将打开可以修改快捷方式的首选项页面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-27T19:30:59.913

作为旁注，请确保您新映射的快捷方式在“键”窗口/菜单的右侧不会有任何冲突。

如果是这样，请选择一个可行的组合；与现有（默认）设置没有任何冲突。

希望这可以帮助。

# .net - 在将 SOAP 消息发送到 .NET 中的 WebService 之前获取它

> ID：461744
> 
> 赞同：22
> 
> 时间：2009-01-20T15:26:16.677
> 
> 标签：.net, web-services, soap

我正在调用外部 HTTPS 网络服务。

为了检查出了什么问题，所有者需要我发送的 SOAP 请求。

我有一个 Web 参考和 VS 2008 生成的代理类...

**有没有办法在发送之前查看 SOAP 消息？**

我正在考虑一些 .net 代码......因为我尝试的嗅探器没有“看到”网络服务调用不知道为什么。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-04-12T17:13:13.123

您可以在提交之前简单地序列化请求对象，如下所示：

```
var sreq = new SomeSoapRequest();

// ... fill in here ...

var serxml = new System.Xml.Serialization.XmlSerializer(sreq.GetType());
var ms = new MemoryStream();
serxml.Serialize(ms, sreq);
string xml = Encoding.UTF8.GetString(ms.ToArray());

// in xml string you have SOAP request 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-20T15:37:58.383

你需要的是一个 SoapExtension。这里有很多很好的例子：

[如何访问 SOAP 响应](https://stackoverflow.com/questions/256234/how-do-i-get-access-to-soap-response)

[从 ASP.net 中运行的 Web 参考客户端获取 RAW Soap 数据](https://stackoverflow.com/questions/300674/getting-raw-soap-data-from-a-web-reference-client-running-in-asp-net)

[处理 SOAP 响应时出现 XML 解析错误](https://stackoverflow.com/questions/381403/xml-parse-error-while-processing-the-soap-response)

其中一篇文章链接到：http: [//msdn.microsoft.com/en-us/magazine/cc164007.aspx](http://msdn.microsoft.com/en-us/magazine/cc164007.aspx)

同时搜索：[https ://stackoverflow.com/search?q=SoapExtension](https://stackoverflow.com/search?q=SoapExtension)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-10-20T22:16:47.603

您可以使用 IClientMEssageInspector 和 IEndpointBehavior 来完成此操作。我发现使用这种方式可以像提琴手一样捕获确切的肥皂​​请求：

在同一个项目中创建一个这样的类：

```
public class ClientMessageInspector : System.ServiceModel.Dispatcher.IClientMessageInspector
    {
        #region IClientMessageInspector Members
        public string LastRequestXml { get; private set; }

        public void AfterReceiveReply(ref System.ServiceModel.Channels.Message reply, object correlationState)
        {

        }

        public object BeforeSendRequest(ref System.ServiceModel.Channels.Message request, System.ServiceModel.IClientChannel channel)
        {
            string requestHeaderName = request.Headers.Action.Replace("urn:#",string.Empty);
            LastRequestXml = request.ToString();
            string serializedRequestFile = string.Format(requestHeaderName + "_request_{0}.xml", DateTime.Now.ToString("yyyyMMddHHmmss"));
            string exportedFolder = ConfigurationManager.AppSettings["SubmittedRequestXmLocation"];
            printSoapRequest(request, exportedFolder, serializedRequestFile);

            return request;
        }

        public void printSoapRequest(System.ServiceModel.Channels.Message request, string exportedFolder, string fileName)
        {
            if (exportedFolder.Equals(string.Empty))
                return;

            if (!Directory.Exists(exportedFolder))
            {
                Directory.CreateDirectory(exportedFolder);
            }
            string exportedFile = string.Format("{0}\\{1}", exportedFolder, fileName);
            if (File.Exists(exportedFile))
            {
                File.Delete(exportedFile);
            }

            string strRequestXML = request.ToString();
            XDocument xDoc = XDocument.Parse(strRequestXML);
            XmlWriter xw = XmlWriter.Create(exportedFile);
            xDoc.Save(xw);
            xw.Flush();
            xw.Close();
            LogOutput("Request file exported: " + exportedFile);

        }

    }

    public class CustomInspectorBehavior : IEndpointBehavior
    {
        private readonly ClientMessageInspector clientMessageInspector = new ClientMessageInspector();

        public string LastRequestXml
        {
            get { return clientMessageInspector.LastRequestXml; }
        }

        public string LastResponseXml
        {
            get { return clientMessageInspector.LastRequestXml; }
        }

        public void AddBindingParameters(
            ServiceEndpoint endpoint,
            System.ServiceModel.Channels.BindingParameterCollection bindingParameters)
        {
        }

        public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)
        {
        }

        public void Validate(ServiceEndpoint endpoint)
        {
        }

        public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)
        {
            clientRuntime.MessageInspectors.Add(clientMessageInspector);
        }
    } 
```

然后你可以像下面这样调用它：

```
ProxyClass _class = new ProxyClass();
var requestInterceptor = new CustomInspectorBehavior();
           _client.Endpoint.Behaviors.Add(requestInterceptor); 
```

当你调用服务方法时，它会自动执行拦截器并打印输出。使用这种方式，您还可以在发送到服务器之前操作肥皂消息！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-08-20T01:31:59.200

@mting923 的建议真的很有帮助，谢谢！

其他想法（例如，利用 SoapExtension，或创建“间谍”类，例如[How do I get access to SOAP response](https://stackoverflow.com/questions/256234/how-do-i-get-access-to-soap-response)）很有趣，但不能在 .NET Core 中使用。但是生成的 SOAP 代理类在底层仍然只是一个 WCF 客户端，因此 IClientMessageInspector 方法很有效，即使对于调用旧 SOAP Web 服务的 .NET Core Azure 函数也是如此。

在上面的示例中，响应连接是隐含的，但未完全显示。此外，在最新的 .NET Core API 中，`MessageInspectors`is now`ClientMessageInspectors`和`Behaviors`is now `EndpointBehaviors`. 因此，为了完整起见，以下内容适用于 .NET Core 3.1 Azure 函数：

```
public class SoapMessageInspector : IClientMessageInspector
{
    public string LastRequestXml { get; private set; }
    public string LastResponseXml { get; private set; }

    public object BeforeSendRequest(ref Message request, IClientChannel channel)
    {
        LastRequestXml = request.ToString();
        return request;
    }

    public void AfterReceiveReply(ref Message reply, object correlationState)
    {
        LastResponseXml = reply.ToString();
    }
}

public class SoapInspectorBehavior : IEndpointBehavior
{
    private readonly SoapMessageInspector inspector_ = new SoapMessageInspector();

    public string LastRequestXml => inspector_.LastRequestXml;
    public string LastResponseXml => inspector_.LastResponseXml;

    public void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)
    {
    }

    public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)
    {
    }

    public void Validate(ServiceEndpoint endpoint)
    {
    }

    public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)
    {
        clientRuntime.ClientMessageInspectors.Add(inspector_);
    }
} 
```

然后可以这样设置：

```
 var client = new ServiceClient();
    var soapInspector = new SoapInspectorBehavior();
    client.Endpoint.EndpointBehaviors.Add(soapInspector); 
```

在客户端代理上调用 Web 服务调用后，`soapInspector.LastRequestXml`将`soapInspector.LastResponseXml`包含原始 SOAP 请求和响应（作为字符串）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-12T19:45:18.197

将此添加到 web.config 或 App.config 文件的元素中。它将在项目的 bin/Debug 文件夹中创建一个 trace.log 文件。或者，您可以使用 initializeData 属性指定日志文件的绝对路径。

```
 <system.diagnostics>
    <trace autoflush="true"/>
    <sources>
      <source name="System.Net" maxdatasize="9999" tracemode="protocolonly">
        <listeners>
          <add name="TraceFile" type="System.Diagnostics.TextWriterTraceListener" initializeData="trace.log"/>
        </listeners>
      </source>
    </sources>
    <switches>
      <add name="System.Net" value="Verbose"/>
    </switches>
  </system.diagnostics> 
```

它警告说 maxdatasize 和 tracemode 属性是不允许的，但它们会增加可以记录的数据量，并避免以十六进制记录所有内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-10T15:42:03.963

如果您在更受限制的环境中工作并且没有使用 Fiddler 之类的应用程序的奢侈，您可以执行以下操作：

1.  像往常一样生成您的网络参考。
2.  编写代码来执行你要给我的任何网络方法调用。
3.  创建一个您选择的新 ASP .NET 项目，我使用 MVC 4。
4.  创建一个处理程序或控制器/动作，并像这样提取请求流：

`using (var reader = new System.IO.StreamReader(Request.InputStream)) { result = reader.ReadToEnd(); }`

1.  在其上放置一个断点并在调试模式下运行它。
2.  在您的客户端上，将 SOAP 请求的 Url 设置为您的新控制器/处理程序。
3.  运行你的客户端。您应该使用 SOAP 消息捕获 Web 应用程序上的断点。

这不是一个理想或漂亮的解决方案，但如果您在适度受限的环境中工作，它可以完成工作。

# wpf - 如何在不切断选项卡的情况下向我的 WPF TabItems 添加水平边距？

> ID：461748
> 
> 赞同：5
> 
> 时间：2009-01-20T15:27:31.477
> 
> 标签：wpf, wpf-controls

在尝试应用 10 的左边距之前，我的 TabItems 看起来像：

![替代文字](https://farm4.static.flickr.com/3487/3213045582_6830246427.jpg?v=0)

尝试将左边距 10 应用于蓝色选项卡后，蓝色选项卡被切断，如下所示：

![替代文字](https://farm4.static.flickr.com/3512/3213045546_20400f1226.jpg?v=0)

我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T20:33:44.890

有几种方法可以解决这个问题，但最简单的方法是简单地自定义 TabItem.Header 内容，如下所示：

```
 <TabControl Margin="29,29,25,23" Name="tabControl1">
        <TabItem Name="tabItem1">
            <TabItem.Header>
                <TextBlock Margin="20,0,20,0">tabItem1</TextBlock>
            </TabItem.Header>
        </TabItem>
        <TabItem  Name="tabItem2">
            <TabItem.Header>
                <TextBlock Margin="20,0,20,0">tabItem2</TextBlock>
            </TabItem.Header>
        </TabItem>
        <TabItem Header="tabItem3" Name="tabItem3">
            <Grid />
        </TabItem>
    </TabControl> 
```

如果您计划为每个选项卡执行此操作，并且您可能应该这样做，我会考虑使用一种样式来应用这些边距。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-20T17:32:25.517

我的猜测是您在蓝色选项卡上设置了宽度。当您添加边距时，宽度的一部分被边距占据，因此选项卡的一部分被切断。移除 Width 属性并尝试使用 Padding 代替。

# web-services - 使用安全 UserNameToken 的 web 服务

> ID：461753
> 
> 赞同：0
> 
> 时间：2009-01-20T15:28:29.183
> 
> 标签：web-services, glassfish, ws-security, usernametoken

出于安全原因，我正在尝试解决我们使用 glassfish V2 使用普通 UserNameToken 发布简单 Web 服务的问题。由于我们使用 Netbeans 6.5 来存档，因此我们正在研究[本教程](http://testwww.netbeans.org/kb/60/javaee/identity-amsecurity.html)。

因此，完成了以下步骤： 在我们的开发环境中，我们安装了 Sun Java(TM) 系统访问管理器，并且可以通过管理控制台和 Netbeans IDE 来管理它。都好。本教程中的示例运行良好，因此我们认为我们可以继续前进。

在更改了 Web 服务的安全选项后，我们在没有安装任何 Netbeans 的情况下将其发布到了我们的测试环境中。

之后，完成了以下步骤：

1.  部署服务
2.  在 Access Manager 中为 IP 地址配置领域
3.  设置预期用户以访问 Web 服务。

当我们的合作伙伴现在访问 Web 服务时，实际的 Web 服务代码没有被访问，我们总是在服务器日志中发现安全标头未被理解。

这是我们在服务器收到的消息：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<soapenv:Header>
<wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" soapenv:mustUnderstand="1">
<wsu:Timestamp xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="Timestamp-10034404">
<wsu:Created>2009-01-19T16:33:38.537Z</wsu:Created>
<wsu:Expires>2009-01-19T16:34:08.537Z</wsu:Expires></wsu:Timestamp><wsse:UsernameToken xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="UsernameToken-10034094">
<wsse:Username>myUser</wsse:Username>
<wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">myPasswd</wsse:Password>
</wsse:UsernameToken>
</wsse:Security>
<wsa:MessageID soapenv:mustUnderstand="0">uuid:ecc3b150-e646-11dd-96e5-9f80a576275b</wsa:MessageID>
<wsa:To soapenv:mustUnderstand="0">http://62.154.241.166:8080/HTNGService/WebServiceForTrustService</wsa:To>
<wsa:Action soapenv:mustUnderstand="0">http://webservice.trustinternational.com/ws/services/Htng2ReservationService</wsa:Action>
<wsa:From xmlns="http://schemas.xmlsoap.org/ws/2004/08/addressing" soapenv:mustUnderstand="0">
<wsa:Address>http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous</wsa:Address></wsa:From>
</soapenv:Header>
<soapenv:Body>
...
</soapenv:Body></soapenv:Envelope> 
```

我们的 wsit.xml 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<definitions
xmlns="http://schemas.xmlsoap.org/wsdl/"
xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" name="WebServiceForTrustService" targetNamespace="http://wstrust/" xmlns:tns="http://wstrust/" xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:wsp1="http://www.w3.org/ns/ws-policy" xmlns:fi="http://java.sun.com/xml/ns/wsit/2006/09/policy/fastinfoset/service" xmlns:tcp="http://java.sun.com/xml/ns/wsit/2006/09/policy/soaptcp/service"
>

<message name="otaHotelResNotif"/>
<message name="otaHotelResNotifResponse"/>
<portType name="WebServiceForTrust">
<operation name="otaHotelResNotif">
<input message="tns:otaHotelResNotif"/>
<output message="tns:otaHotelResNotifResponse"/>
</operation>
</portType>
<binding name="WebServiceForTrustPortBinding" type="tns:WebServiceForTrust">
<wsp:PolicyReference URI="#WebServiceForTrustPortBindingPolicy"/>
<operation name="otaHotelResNotif">
<input/>
<output/>
</operation>
</binding>
<service name="WebServiceForTrustService">
<port name="WebServiceForTrustPort" binding="tns:WebServiceForTrustPortBinding"/>
</service>
<wsp:Policy wsu:Id="WebServiceForTrustPortBindingPolicy">
<wsp:ExactlyOne>
<wsp:All/>
</wsp:ExactlyOne>
</wsp:Policy>
</definitions> 
```

有谁知道这里可能缺少什么配置？

我们还意识到，在打开安全性（AM 安全性）后，在 IDE 中会在 configuration files/amserver 下创建一个名为 amconfig.xml 的文件。

部署服务后，我们在网络服务器上、*.war 或 addons/amserver 下都找不到这个文件。

该文件内部如下所示：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns2:AMConfig xmlns:ns2="http://identity.netbeans.org/access_manager_config_1_0">
<ProviderConfig type="WSP" name="WebServiceForTrustService">
<SecurityMechanism uri="urn:sun:wss:security:null:UserNameToken-Plain"/>
</ProviderConfig>
</ns2:AMConfig> 
```

由于信息已经在`sun-web.xml`服务器上发布，我认为这不应该是问题，但可能对您有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T16:41:29.800

因为我们在上面进一步研究了一些新的东西，即使它没有解决。

示例教程已重建并部署在测试服务器上。客户端和服务器测试应用程序。在测试服务器上本地启动时，两者都工作正常。

如果我们将远程客户端配置为使用具有相同安全信息的相同 Web 服务，我们会发现与其他应用程序相同的错误。

因此，我认为它与 Access Manager 的配置有关，但不知道是哪一个。

我希望这可以帮助任何人帮助我。谢谢！

# javascript - 显示某些页面时强制左（导航）框架

> ID：461756
> 
> 赞同：0
> 
> 时间：2009-01-20T15:28:37.823
> 
> 标签：javascript, html, iframe

我有一个旧网站，左侧框架导航，右侧页面。

我想当一个页面直接被 url'd 时，导航（左框架）也显示。

直到现在我是一个 js 工作，但我不知道它从什么时候开始不工作，现在返回这个消息：

*Forbidden 您无权访问此服务器上的 /master.html。此外，在尝试使用 ErrorDocument 处理请求时遇到 404 Not Found 错误。Apache/2.2.10 (Unix) mod_ssl/2.2.10 OpenSSL/0.9.8i DAV/2 mod_auth_passthrough/2.1 mod_bwlimited/1.4 FrontPage/5.0.2.2635 服务器在 www.cpis.es 端口 80*

我使用的代码是

```
http://www.webmasterworld.com/forum21/1205.htm

Call this javascript code from the HEAD section of each child page. The code creates a variable from the URL of the page, and then passes that variable in the new location's URL. This means a "master" frameset can load this exact page in the content section: 

<SCRIPT LANGUAGE="JavaScript">
passpage = document.URL 
if (top.location == self.location) 
    top.location.href="master.html?" + passpage 
</script>
Then create just one "master.html" page. It holds the JavaScript code to decipher whatever URL is passed after the "?" and it writes that page into the content frame: 
<html> 
<head> 
<title>Master Frameset</title> 
</head> 
<script language="JavaScript" type="text/javascript"> 
origURL = parent.document.URL 
contentURL = origURL.substring(origURL.indexOf('?')+1, origURL.length) 
document.write('<frameset cols="20%,80%"><frame src="leftnav.html" name="nav"><frame src="' + contentURL + '" name="content"><\/frameset>') 
</script> 
</html> 
```

谢谢，吉列尔莫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T15:50:05.863

我刚刚检查了该网站，它似乎现在可以正常工作。我的猜测是服务器上没有位于[http://www.cpis.es/master.html](http://www.cpis.es/master.html)的文件。

如果问题仍然存在，请提供步骤，以便我们可以重现它并查看问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T04:46:59.043

不好意思推迟了。

看起来问题出在javascript的这个小和平中：

```
passpage = document.URL 
if (top.location == self.location) 
 top.location.href="master.html?" + passpage 
```

它应该是：

```
passpage = window.location.pathname;
if (top.location == self.location) {
    top.location.href="master.html?" + passpage;
} 
```

您必须在链接列表中的每个页面中更改该代码。我认为这应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T08:35:37.050

谢谢Maiku Mori，

为了正确测试问题，请执行以下操作：

*   去 www.cpis.es
*   单击菜单中的第二个选项 (CoPrint)
*   好的，你看到了 leftnav + 页面

现在直接进入页面

*   访问 www.cpis.es/coprint.htm
*   错误，您进入了禁止页面。

# character - Cruisecontrol config.xml 特殊字符 svnbootstrapper

> ID：461760
> 
> 赞同：1
> 
> 时间：2009-01-20T15:29:11.413
> 
> 标签：character, cruisecontrol

我有这样一行：

```
 <svnbootstrapper LocalWorkingCopy="${projects.dir}/${project.name}" Password="4udr=qudafe$h$&e4Rub" Username="televic-education" /> 
```

在我的 config.xml 中。由于密码巡航控制服务中的特殊字符无法启动。有没有办法解决这个问题？

也许设置一个属性？还是转义字符？

谢谢，列文卡登

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T15:37:02.583

将 & 替换为 & 在密码属性中。我不知道这是否是问题，但这绝对*是一个*问题。

# jsf - 使用面在数据表上的多行数据记录

> ID：461761
> 
> 赞同：2
> 
> 时间：2009-01-20T15:29:22.923
> 
> 标签：jsf, datatable

在 JSF 中是否可以让数据表显示如下记录？

```
 [Name  ][Last Name][Age]
1\.    John     Doe         20
      Extra info on record 1

2\.    John     Smith       20
      Extra info on record 2 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T16:49:31.687

我敢肯定有很多方法可以做到这一点。

如果您不介意嵌套表格，可以使用*panelGrid*标签和 CSS。

看法：

```
<f:view>
    <h:dataTable value="#{peopleBean.people}" var="row">
        <h:column id="column1">
            <f:facet name="header">
                <h:panelGrid columns="3" columnClasses="cell,cell,age">
                    <h:outputText value="First Name" />
                    <h:outputText value="Last Name" />
                    <h:outputText value="Age" />
                </h:panelGrid>
            </f:facet>
            <h:panelGrid columns="3" columnClasses="cell,cell,age">
                <h:outputText value="#{row.firstname}" />
                <h:outputText value="#{row.lastname}" />
                <h:outputText value="#{row.age}" />
            </h:panelGrid>
            <h:outputText styleClass="extra" value="#{row.extraInfo}" />
        </h:column>
    </h:dataTable>
</f:view> 
```

样式表：

```
TABLE {
    width: 100%;
}

TABLE TR TD {
    text-align: left;
}

.cell {
    width: 40%;
}

.age {
    width: 20%;
}

.extra {
    background-color: silver;
    padding: 4px;
    display: block;
    width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T15:35:06.050

第三个库，例如 RichFaces，允许您使用 subTable 的原理来做到这一点。您可以从 RichFaces查看此[示例。](http://livedemo.exadel.com/richfaces-demo/richfaces/dataTable.jsf)与您想要做的相比，它有点复杂，但它显示了 subTable 组件的用法......

# c# - 在 C# 或 C++ 中将压缩的 wav 文件转换为未压缩的 wav 文件的最简单方法是什么？

> ID：461773
> 
> 赞同：1
> 
> 时间：2009-01-20T15:31:50.860
> 
> 标签：c#, c++, audio, compression, wav

以编程方式将压缩的 wav 文件（例如 MPEG 编解码器，但可以是任何已安装的编解码器）转换为未压缩的 wav 文件（16 位 PCM）的最简单方法是什么？

我听说使用直接显示并用本机 C++ 编写代码可以做到这一点，但我对直接显示没有太多经验。

有没有更简单的方法来做到这一点？C# 是理想的，但 C++ 也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T15:41:44.617

假设我们谈论的是 Windows，[DirectShow可能是进行解码的最佳方式。](http://msdn.microsoft.com/en-us/library/dd375454(VS.85).aspx)DirectShow 是一个 COM API，因此您可以编写本机 C++ COM 代码，可以使用可用的[DirectShow .Net](http://directshownet.sourceforge.net/)包装器之一，也可以使用 C++/CLI。您选择哪一个取决于您的应用程序架构的其余部分 - 如果您需要使用 .Net，那么 C++/CLI 绝对是最简单的途径。您确实需要更具体地说明您要实现的目标——例如，[MPEG](http://www.mpeg.org/)本身不是编解码器——它们只是定义标准。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T11:32:52.417

您可以使用安装在 PC 上的任何 ACM 编解码器使用[NAudio](http://www.codeplex.com/naudio)解压缩 C# 中的 WAV 文件。这是一些示例代码：

```
using (WaveFileReader reader = new WaveFileReader(inputFileName))
{
    using (WaveStream convertedStream = 
        WaveFormatConversionStream.CreatePcmStream(reader))
    {
        WaveFileWriter.CreateWaveFile(outputFileName, convertedStream);
    }
} 
```

# open-source - 重用代码时，如何明确每个文件的版权所有者是谁？

> ID：461774
> 
> 赞同：10
> 
> 时间：2009-01-20T15:31:55.760
> 
> 标签：open-source, licensing

我想重用一些在 BSD 许可下许可的代码，但我不知道如何明确我写的内容、重用的内容和修改的内容。

假设我要重用代码的项目具有以下目录结构：

```
project/
|-- LICENSE.txt
|-- module1/
|   |-- file1.c
|   |-- file2.c
|   `-- file3.c
|-- module2/
`-- module3/ 
```

LICENSE.txt 的内容是一个 BSD 许可证，即它的内容是：

```
Copyright (c) <year>, <copyright holder>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
[...] 
```

（有关全文模板，请参见[维基百科](http://en.wikipedia.org/w/index.php?oldid=264699273#Terms)。）

此外，版权仅在 LICENSE.txt 文件中声明，而不是在每个单独的源代码文件中。

如果我现在将 project/module1/ 下的所有内容复制到我自己的项目中：

```
my_project/
|-- module1/
|   |-- file1.c
|   |-- file2.c
|   `-- file3.c
|-- my_file1.c
|-- my_file2.c
|-- my_source_code1/
`-- my_source_code2/ 
```

我应该如何声明我不是 module1 下文件的版权所有者？将原始 LICENSE.txt（标题中包含原始版权所有者）复制到 module1 子目录就足够了吗？或者我应该为每个单独的文件添加版权标题？

如果我修改了 module1 下的任何文件怎么办？然后我应该以某种方式将自己添加为我修改的文件的额外版权所有者吗？

注意：我完全可以对我编写的代码使用相同（或兼容）的许可证。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T16:01:37.947

复制`LICENSE.txt`到您的`module1`目录中，并在您的文档（自述文件、许可证等）中提及您使用项目的这一部分。BSD 风格的许可证非常自由：只要您给予应有的信任并尊重其要求（这通常涉及提供未经修改的许可证和版权声明），您可以对代码做任何您想做的事情。

如果您修改任何文件，一个好的做法是在文件标题、更改周围和全局文档中提及它。如果修改后的文件没有版权声明，只需添加一个描述您的更改的内容。这样用户就可以知道哪些文件被修改了，谁修改了，为什么以及如何修改。

就这么简单：以非常描述性的方式进行。与 GPL 风格的许可证相反，没有正式的程序可遵循。这是比法律工作更多的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T15:57:27.313

我喜欢在源代码的注释中引用许可证——这样更容易，因为人们更有可能打开源文件并四处玩弄，而不是先检查目录结构。一个简单的注释说明代码的版权归 X 所有，并由 Y 许可，这有助于将某人引导到适当的许可文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T09:07:57.093

您不想在这里误读版权。所以，我会尽量采用以下结构：

```
my_project/
|-- the_other_project
|    |-- LICENSE.txt
|    |-- module1/
|    |   |-- file1.c
|    |   |-- file2.c
|    |   `-- file3.c
|-- my_file1.c
|-- my_file2.c
|-- my_source_code1/
`-- my_source_code2/ 
```

除此之外：

*   每个文件都应有一个标题，提及版权、所有者和许可
*   在您自己的许可证中提及您正在使用另一个项目的部分代码
*   如果您修改其他项目中的代码，请在项目的源文件中添加您的版权和名称。

那是如果您没有对其他源代码进行太多修改。如果您要重写所有内容，只需在您的许可证中提及其他代码的来源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T13:41:08.697

我刚刚发现[在 GPL 许可项目中维护许可许可文件：开发人员指南](http://www.softwarefreedom.org/resources/2007/gpl-non-gpl-collaboration.html)，由软件自由法律中心发布。尽管它专门讨论了将 BSD 风格的许可证（他们称之为许可）合并到 GPL 许可代码中，但我认为第 2.1 节中的建议，*包括未修改的许可文件*，将是一个很好的一般性建议。我引用：

> 如果外部项目使用单个 COPYRIGHT 文件方法，则开发人员应从该文件中复制所有版权所有者的姓名，并将其连同许可许可要求的任何版权、许可和保修免责声明一起放在顶部合并的源文件。

如果您修改包含的文件并且您的项目**是**GPL，则上述文档中有两个相关部分：

*   [2.2 将 GPL 修改添加到许可许可文件](http://www.softwarefreedom.org/resources/2007/gpl-non-gpl-collaboration.html#x1-40002.2)
*   [2.3 在更大的 GPL 作品中保持修改后的文件许可](http://www.softwarefreedom.org/resources/2007/gpl-non-gpl-collaboration.html#x1-50002.3)

您修改包含的文件并且您的项目**不是**GPL 的情况显然没有在文档中解决。但是根据我从其他答案中收集到的信息，我想说，只要您用于项目的许可证不是病毒式的，那么正确的做法是将自己作为版权所有者添加到版权标题中您修改的文件并在文档中的某处提及包含代码的来源。

# c# - 水晶报表运行时间

> ID：461775
> 
> 赞同：0
> 
> 时间：2009-01-20T15:31:56.663
> 
> 标签：c#, .net, crystal-reports

我在 C# (.net 2) 中有应用程序，我使用 Crystal Report 11。

当我将在整个安装程序中分发应用程序时，如何安装 Crystal Report 运行时文件？

除了安装整个 Crystal Report Runtime (43 MB) 之外，还有其他简单的方法吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T22:31:41.293

您应该能够[从 SAP 下载合并模块](http://service.sap.com/sap/bc/bsp/spn/bobj_download/main.htm)（当然，现在谁拥有 Crystal）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T02:15:15.443

此解决方案适用于 CR10。大约 29 Mb 的文件：

第一个文件包含一些关于 CR 公用文件夹的数据。如果要求更改/更新它：

```
crdeploy.reg
------------
REGEDIT4

[HKEY_LOCAL_MACHINE\SOFTWARE\Crystal Decisions\10.0\Crystal Reports]
"CommonFiles"="c:\\program files\\common files\\crystal decisions\\2.5\\bin" 
```

以下文件必须放在 CR“通用文件”文件夹下（定义在 crDeploy.reg/registery 文件中）：

```
C:\pfd\DLL\CRYSTAL_10\TO_COMMONFILES
------------------------------------    
crdb_ado.dll        'if you use an ado connection. There is one specific dll for each type of connexion'
crheapalloc.dll
crtowords_en.dll    'this one is computer/language specific. Transforms numbers '
                    'in words. If your computer is turned into french, you ll'
                    'have to get the corresponding dll to have the function work properly'
crxf_html.dll
crxf_pdf.dll
crxf_rtf.dll
crxf_wordw.dll
crxf_xls.dll
exlate32.dll
GDIPLUS.DLL
Implode.dll
querybuilder.dll
sscdlg.dll
sscsdk80.dll
u252000.dll            'you might not need all of these ....'
u25dts.dll
u25samp1.dll
u2dapp.dll
u2ddisk.dll
u2dmapi.dll
u2dpost.dll
u2fcr.dll
u2frdef.dll
u2frec.dll
u2fsepv.dll
u2ftext.dll
u2fxml.dll
u2l2000.dll
u2lcom.dll
u2ldts.dll
u2lexch.dll
u2lfinra.dll
ufmanager.dll 
```

以下文件必须在同一个文件夹中，并且必须通过regsvr32注册

```
C:\pfd\DLL\CRYSTAL_10\TO_COMMONFILES\TO_REGISTER
----------------------------------------------
CRAnalyzer.dll
craxdrt.dll          'is the free dll for manipulating report objects.'
                     'You can use the licensed 'craxddrt.dll' that allows'
                     'you to modify reports at runtime.'
crqe.dll
crtslv.dll
crviewer.dll         'is the dll for the viewer you can display on your GUI'
ExportModeller.dll
keycode.dll
pageObjectModel.dll
ReportRenderer.dll
webReporting.dll 
```

以下文件应添加到系统文件夹中（可以从其他来源获得......）

```
C:\pfd\DLL\CRYSTAL_10\TO_SYSTEM
-------------------------------
cxlibw-1-6.dll
dbghelp.dll
msvcrt.dll
riched20.dll
usp10.dll 
```

# reporting-services - 摆脱报告中的分页符

> ID：461782
> 
> 赞同：45
> 
> 时间：2009-01-20T15:33:12.230
> 
> 标签：reporting-services, page-break

如何摆脱 SSRS 报告中的分页符，使报告显示在单页中？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-12-09T15:42:02.487

在文本编辑器中打开报告的 .rdl 文件并找到该`<Page></Page>`部分。在该部分中，插入以下内容：

```
<InteractiveHeight>0in</InteractiveHeight>
<InteractiveWidth>8.5in</InteractiveWidth> 
```

在 SSRS 中，交互高度为 0 意味着报表具有无限长度，因此它将存在于单个页面上。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-20T15:49:52.337

确保您没有将**PageBreakAtEnd**或**PageBreakAtStart**的其中一个报告项的属性之一设置为 true 。此外，请确保报告的宽度小于实际纸张的宽度，记住页边距的额外空间（报告>报告属性>布局）

根据微软的说法：“虽然不推荐，但你可以通过将 InteractiveHeight 设置为 0 来禁用软分页符。” 我认为这仅适用于 HTML 渲染，但我自己没有使用过。

我不确定是否有任何规模的规模，无论您的报告有多大，如果您正在寻找它，它仍然会打印在一页上。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-09-04T15:45:36.100

右键单击正文中的任意位置并选择`Properties`。

`Reports`从下拉菜单中选择。（当您在报告中选择一个元素时，下拉列表将更改为 TextBox/Header 或您选择的项目）

在`Report`属性中，展开`InteractiveSize`属性。

放`Height -> 0in`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-06-26T21:31:05.490

如果您想在一页中显示报告数据，在 SSRS 中很简单。您所要做的就是选择整个表，然后转到属性窗格。更新*KeepTogather = True*。

[![在此处输入图像描述](https://i.stack.imgur.com/Xo353.png)](https://i.stack.imgur.com/Xo353.png)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-05-10T04:52:40.960

您可以将报表的 InteractiveHeight 设置为 0 以禁用分页。

转到报告属性 -> 页面 -> InteractiveSize -> 高度。将此值设置为 0 英寸。

[这](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/6c240863-216b-4e6a-9c67-197d98b0f18c)是类似的问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-27T10:27:17.890

达斯汀布鲁克斯写道：

> 此外，请确保您的报告宽度小于实际纸张的宽度，记住页边距的额外空间（报告>报告属性>布局）

在使用子报表时也要格外小心。当我不小心制作的子报表比主报表宽时，我已经记不清有多少次我最终得到额外的空白页。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-05T20:20:15.990

在为网络创建报告时，我会通过将 InteractiveSize 设置为非常疯狂的值来禁用分页符，例如 1000x1000"。（我刚刚检查过，并将其设置为 0x0"，正如 Dustin Brooks[在他的回答中提到的那样](https://stackoverflow.com/questions/461782/ssrs-report-get-rid-of-page-breaks-in-report/461854#461854)具有相同的效果。）

我将 PageSize 属性保留为 8.5x11"，并且报告正常打印在多个页面上。

# apache-flex - flex 3 和自动完成

> ID：461784
> 
> 赞同：0
> 
> 时间：2009-01-20T15:34:20.653
> 
> 标签：apache-flex, autocomplete

我试图让自动完成工作，当我在我的 mxml 中创建一个数组然后在初始化关键字中初始化文件顶部的 arrayCollection 时，我可以做得很好。

但是我想从 web 服务填充 arraycollection，但我似乎无法得到它；

我是我的应用程序标签，我有以下内容

```
creationComplete="init()"
initialize="data2 = new ArrayCollection(data1);" 
```

然后在我的初始化方法中；

```
 private function init():void 
{
userRequest.loadWSDL(wsdlUrl);
userRequest.getAllCountries();
} 
```

//当我从 userRequest.getAllCountries() 得到结果时调用它；

```
 private function getAllCountriesResult(e:ResultEvent):void 
    {
    data1 = new Array(e.result);
        } 
```

但是我的文本框没有得到任何价值。

有想法的人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T15:55:50.047

首先，Array 不可绑定，因此更改变量 data1 不会产生连锁反应。

arrayCollection 是可绑定的。

所以假设结果（e.result）实际上是一个数组（你应该在调试时检查这个）然后你可以执行以下操作

```
[Bindable]
priavte var ac : ArrayCollection; 
```

然后在里面你是 getAllCountriesResult 函数。

```
ac = new ArrayCollection(e.result); 
```

然后将更新设置为 var ac 的 dataprovider 的任何内容。

如果您希望更新 textArea 或类似内容中的文本值，则应在 arrayCollection 中侦听更改事件，然后采取适当的操作。

* * *

从下面的附加点（只需编辑您的原始问题）

我认为您所说的自动完成是来自 adobe 交换区域的自动完成文本输入框，因为普通文本框不需要 arrayCollection。如果您发布了一些代码，它可能会更容易帮助您。预初始化，然后初始化，然后是 creationComplete，然后是 applicationComplete（这是它们被调用的顺序）。

如果您使用我正在考虑的组件，请查看[http://www.websector.de/blog/2008/04/30/quick-tip-avoid-issues-using-adobes-autocomplete-input-component-using -flex-3/](http://www.websector.de/blog/2008/04/30/quick-tip-avoid-issues-using-adobes-autocomplete-input-component-using-flex-3/) 看来 flex 3 可能存在一些问题，因此请查看[http://blogs.adobe.com/flex/2006/09/component_autocomplete_text_in.html](http://blogs.adobe.com/flex/2006/09/component_autocomplete_text_in.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-11T03:33:47.533

试试这个：

```
private function getAllCountriesResult(e:ResultEvent):void 
{
   data2.source = new Array(e.result); // or data2.source = e.result as Array
} 
```

确保 data2 已初始化为 ArrayCollection。

至于自动完成，我正在尝试自己解决问题。

# xml - 如何处理属于另一个集合的集合的项目？

> ID：461788
> 
> 赞同：0
> 
> 时间：2009-01-20T15:34:49.670
> 
> 标签：xml, vb.net, collections

我在读取和加载属于 VB 2005 中另一个集合的集合的项目时遇到问题。这些都是 XML 文件的节点。例如：

Toto是XML文件中的一个节点，是集合Tocollect的一个项目，也是Tocollect的一个子节点，Tocollect是Collect的一个项目，也是它的一个子节点。

在写代码的时候，这种情况和单个对象属于一个集合还是一个集合属于一个对象有什么区别吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T20:14:25.687

一般来说，如果您的对象以层次结构连接，那么您的 xml 应该反映该层次结构。

您的节点有一堆节点，其中有一堆节点。

这与你有一个 all 列表然后另一个列表 all 然后另一个单独列表的方案相反。现在，如果您使用唯一 id 将节点绑定在一起，您可以维护三个单独的列表（将其视为数据库中的表）。但是，当您读入 XML 以将其转换为对象层次结构时，您将有一个额外的步骤。

至于存储层次结构。基本上，每个对象都实现了一个 Read 和一个 Store 方法。如果父级包含子级，那么它应该循环遍历每个调用它的存储方法的子级，向其传递将其存储在正确位置所需的流或参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T15:44:04.907

在 .NET 中有引用类型和值类型。绝大多数类都是引用类型，这意味着作为某个类实例的变量是 C++ 指针的类似物。

所以两个不同集合的两个项目是相同的事物/变量/实例/指针。

# ruby-on-rails - Rails 中的多个提交按钮/表单

> ID：461790
> 
> 赞同：13
> 
> 时间：2009-01-20T15:34:55.910
> 
> 标签：ruby-on-rails, ruby, forms, submit

我正在尝试编写一个 Rails 应用程序，它可以让你转到某个页面，比如 /person/:id。在此页面上，它显示了一组可用资源。我希望每个资源旁边都有一个按钮，该按钮将该资源保留给该人（通过创建分配模型的新实例。）作为扩展，我希望每个资源都有几个按钮，可以取消保留并执行其他事情。我还想在一些按钮旁边输入数据，例如分配一些资源的百分比。

我的问题是如果不重复自己或拥有一个非常老套的控制器，我无法弄清楚如何明智地做到这一点。如何在不匹配提交按钮的值部分（按钮上的文本）或使用任何 JavaScript 的情况下做到这一点？

此外，如果您在一个页面上有两个表单，您如何设置它以便在单击任何提交按钮时保存两个表单上的更改？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-07-08T07:26:49.503

我正在使用 jQuery，这就是我所做的：

```
<script type="text/javascript">
    $(document).ready(function() {

        $('#bulk_print').click(function(){
            var target = '<%= bulk_print_prepaid_vouchers_path(:format => :pdf) %>';
            $('#prepaidvoucher_bulk_print').attr('action', target);
            $('#prepaidvoucher_bulk_print').submit();
        });

        $('#bulk_destroy').click(function(){
            var target = '<%= bulk_destroy_prepaid_vouchers_path %>';
            $('#prepaidvoucher_bulk_print').attr('action', target);
            $('#prepaidvoucher_bulk_print').submit();
        });

    });
</script>

<% form_tag '#', :method => :post, :id => 'prepaidvoucher_bulk_print' do %>

your form details

<button class="button" type="submit" id="bulk_print">
   <%= image_tag("web-app-theme/printer.png", :alt => "Print Selected Vouchers") %> Print Selected Vouchers
</button>

<button class="button" type="submit" id="bulk_destroy">
    <%= image_tag("web-app-theme/cross.png", :alt => "Delete Selected Vouchers") %> Delete Selected Vouchers
</button>

<% end %> 
```

这个想法是根据单击的按钮动态更改表单操作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T22:10:21.493

使列表中的每一行成为一个表格，并将有关项目的信息放在那里。当然，您需要使用每个操作提交并重新加载页面。解决这个问题的唯一方法是使用复选框而不是按钮并使其成为一种大表单——或者使用 Javascript。

至于你的第二个问题，如果你想让一个提交按钮影响两个“表单”，你应该让它们都成为同一个表单的一部分。如果需要，您可以在表单上有多个提交按钮。否则，您可以使用 Javascript 填充原始表单中的值动态生成第三个表单——但这并非在所有情况下都有效（例如，文件输入）。

# javascript - 是否可以使用 JavaScript 写入文件（在磁盘上）？

> ID：461791
> 
> 赞同：14
> 
> 时间：2009-01-20T15:35:05.283
> 
> 标签：javascript, ajax

我是一名初级中级程序员，正在尝试 AJAX。在阅读 JavaScript 时，我发现我一直在绘制的大多数示例都使用 PHP 进行这样的操作很奇怪。我知道你们中的许多人可能会争辩说“我做错了”或“JavaScript 是一种客户端语言”等，但问题仍然存在。. . 你能只用 JavaScript 写一个文件吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-20T15:39:00.720

是的，当然可以。这仅取决于您的 javascript 引擎为您提供的 API 对象。

但是，您正在考虑的 javascript 引擎很可能不提供此功能。绝对没有一个主要的网络浏览器会允许它。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-20T15:41:29.173

您可以使用 Javascript 编写 cookie，在较新的浏览器上，您还可以使用 SQLite 数据库来存储客户端数据。但是，您不能将数据存储在磁盘上的任意位置。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-20T15:45:14.763

~~您可以使用[Google Gears](http://code.google.com/apis/gears/)之类的工具来生成能够将数据存储在本地缓存或数据库中的 JS 应用程序。但是，您不能读取或写入磁盘的任意区域。~~（这是 2009 年编写的 - [Google Gears 现在已弃用](http://gearsblog.blogspot.com/2011/03/stopping-gears.html)）

这些天，您应该关注[HTML5 提供的本地存储功能](http://diveintohtml5.info/storage.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-20T15:39:57.817

不可以。你可以使用 JavaScript 向服务器端处理脚本创建 AJAX 请求，但允许 JS 直接写入磁盘——无论是客户端还是服务器端——将是一个巨大的、讨厌的、明显的、不可原谅的浏览器安全漏洞.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T15:46:27.633

最简洁的答案是不; 默认情况下，您不能通过在浏览器中使用纯 JavaScript 将文件写入本地磁盘。你需要一个帮手来做到这一点。例如，[TiddlyWiki](http://www.tiddlywiki.com/)是一个 wiki 引擎，它只是一个单一的静态 HTML 文件，但它可以在 Java 小程序（Tiddly Saver）的帮助下将自己写入磁盘。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-20T19:22:53.077

您可以在 Windows Scripting Host 中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-08T09:23:00.387

下一个版本的 chrome (v52) 使用 fetch api + service worker + 流使这成为可能，您现在可以使用标志启用流...

你可以去[StreamSaver.js](https://github.com/jimmywarting/StreamSaver.js)看看如何使用它的一些例子。

你可以这样做：

```
const writeStream = fs.createWriteStream('filename.txt')
const encoder = new TextEncoder
let data = 'a'.repeat(1024)
let uint8array = encoder.encode(data + "\n\n")

writeStream.write(uint8array)
writeStream.close() 
```

或者直接看演示：[https ://jimmywarting.github.io/StreamSaver.js/example.html](https://jimmywarting.github.io/StreamSaver.js/example.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T15:39:56.397

不，根本不允许 Javascript 访问文件系统，这是浏览器中的一个安全限制。真正做到这一点的唯一方法是使用 ActiveX，但随后您将自己限制为使用 IE。

**编辑：** 正如上面的帖子所述，如果您的引擎允许它是可能的，但是我不知道有一个浏览器引擎（我假设您正在编写它）会允许您这样做。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-18T10:38:09.507

如果您只需要让用户*通过浏览器下载对话框*`.txt`下载文件（ 、、`.csv`图像等），则可以使用带有标签的[数据 URI 。](https://en.wikipedia.org/wiki/Data_URI_scheme)*`<a href=... download=.../>`*

 *例如（对于文本文件）：

```
<a href="data:text/plain;charset=utf-8,TEXT_HERE" download="filename.txt"> Click to download </a> 
```

您还可以设置属性`href`并`download`使用javascript，并使用`element.click()`触发下载。

但是，如果没有用户确认文件下载对话框，此方法无法写入文件。

# serial-port - 什么是用于逆向工程的好的免费串行端口监视器？

> ID：461794
> 
> 赞同：45
> 
> 时间：2009-01-20T15:35:20.387
> 
> 标签：serial-port, reverse-engineering

我正在对串行协议进行逆向工程，并对坏工具感到沮丧。有谁知道一个很好的免费工具，用于在 Windows 上将数据记录到串行端口/从串行端口记录数据？

要求：

*   必须是免费的
*   不得控制端口（即必须挂钩文件 API 或内核，而不是尝试打开设备）
*   必须具有某种过滤功能
*   写入人类可读或二进制日志，最好以易于解析的格式

有任何想法吗？Portmon 可以工作，但它的日志很难使用，而且它的过滤器实际上是无用的；我还尝试了一些商业工具，但似乎没有任何东西符合要求。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-20T16:05:33.023

我听到很多关于[com0com](http://com0com.sourceforge.net/)的好消息，它是一个软件端口仿真器。您可以通过它“连接”物理串行端口，以便您的软件使用（受监控的）虚拟端口，并将所有流量转发到/来自物理端口。我自己没有使用过它，但我已经看到它在这里推荐了很多。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-29T15:50:35.087

[sysinternals（现在的 MSFT）的Portmon](http://technet.microsoft.com/en-us/sysinternals/bb896644.aspx)可能是最好的监视器。

我还没有找到一个很好的免费工具来模拟端口和记录/重播通信。如果您想响应我最终在第二台机器上使用[expect和 python 的命令，那么商业的价格昂贵，要么非常有限，要么非常复杂。](http://en.wikipedia.org/wiki/Expect)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T15:50:09.700

我一直在走这条路，最终选择了进行非侵入式在线监控的硬件数据示波器。我尝试过的软件解决方案对我不起作用。如果你有一台备用 PC，你可能会建造一台，尽管它相当笨重。这个[软件数据范围](http://touch-base.com/documentation/scope.htm)可能会起作用，就像[this](http://www.winsite.com/bin/Info?500000017824)一样，但我也没有尝试过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T15:53:44.623

我会得到一个逻辑分析仪并将其连接到串行端口。我认为您可能只需要两条线（Tx/Rx），所以应该有很多便宜的逻辑分析仪可用。不过，你手边没有时钟线，所以这可能会变得很棘手。

# visual-studio-2008 - 连接到 Team Foundation Server

> ID：461795
> 
> 赞同：6
> 
> 时间：2009-01-20T15:35:29.607
> 
> 标签：visual-studio-2008, tfs

我有 2 台机器，一台在位置 A，另一台在位置 B。B 机器通过 VPN 连接到 A 的 newtwork。两台机器上都安装了VS2008 Team System。**A 机器在工具**>**连接到 Team Foundation Server...**下有一个菜单选项，但 B 机器没有此选项。

我在B机上安装VS2008TS有什么遗漏的吗？如何启用此菜单项？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-20T15:37:58.570

你安装了[Team Explorer](http://www.microsoft.com/downloads/details.aspx?familyid=0ED12659-3D41-4420-BBB0-A46E51BFCA86&displaylang=en)吗？这是一个单独的安装。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T15:40:27.940

您是否正确设置了源代码管理插件？

工具 -> 选项 -> 源代码管理

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T15:39:40.627

您是否检查过机器 B 上是否安装了 Team Explorer？你需要它来连接到 TFS。

# dataflow - 数据流编程语言

> ID：461796
> 
> 赞同：85
> 
> 时间：2009-01-20T15:35:30.463
> 
> 标签：dataflow

什么是数据流编程语言？为什么要使用它？它有什么好处吗？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-06-04T10:40:08.683

在控制流语言中，您有一个对外部数据进行操作的指令流。条件执行、跳转和过程调用会改变要执行的指令流。这可以看作是流经数据的指令（例如，指令对寄存器进行操作，这些寄存器通过指令加载数据——除非指令流移动数据，否则数据是静态的）。控制流“if”语句跳转到指令流中的正确分支，但数据不会移动。

在数据流语言中，您有一个数据流，它从指令传递到要处理的指令。条件执行、跳转和过程调用将数据路由到不同的指令。这可以看作是流经其他静态指令的数据，例如电信号如何流经电路或水如何流经管道。数据流“if”语句会将数据路由到正确的分支。

**数据流功能和语言的一些示例：**

*   电子表格本质上是数据流
*   Unix管道
*   [期货和承诺](https://en.wikipedia.org/wiki/Futures_and_promises)是在许多现代语言中发现的数据流或类似数据流的结构
*   [Actor 模型](https://en.wikipedia.org/wiki/Actor_model)中的消息传递是数据流
*   某些语言具有数据流功能：
    *   [Oz](https://mozart.github.io/)有[数据流变量](https://en.wikipedia.org/wiki/Oz_%28programming_language%29#Dataflow_variables_and_declarative_concurrency)
    *   [Groovy](http://groovy.codehaus.org/)有[GPars](http://www.gpars.org/0.12/guide/index.html)
    *   [Clojure](http://clojure.org)有[clojure.contrib.dataflow](http://richhickey.github.com/clojure-contrib/dataflow-api.html)、[Reagi](https://github.com/weavejester/reagi)和[Javelin](https://github.com/tailrecursion/javelin)

**文本语言**

*   [VHDL](https://en.wikipedia.org/wiki/VHDL) , [Verilog](https://en.wikipedia.org/wiki/Verilog)等[硬件描述语言](https://en.wikipedia.org/wiki/Hardware_description_language)本质上是数据流
*   [查克](http://chuck.cs.princeton.edu/)
*   [楔形文字](https://en.wikipedia.org/wiki/Cuneiform_(programming_language))
*   [光泽](https://en.wikipedia.org/wiki/Lustre_%28programming_language%29)，用于国防、航空航天和发电厂行业
*   [托勒密二世](http://ptolemy.berkeley.edu/ptolemyII/)
*   [奈奎斯特](http://nyquist.sourceforge.net/)

**视觉语言**

*   [LabVIEW](http://www.ni.com/labview/) ([截图](http://www.ni.com/images/labview/us/multicore_prog_large.jpg)[[来源](http://www.ni.com/labview/whatis/)])
*   [Max/MSP](http://cycling74.com) ([截图](http://rhoadley.org/images/screenshots/max-msp/msp1.gif)[[来源](http://rhoadley.org/courses/tech_resources/max-msp/index.php)])
*   [纯数据](http://puredata.info)（[截图](http://screens.alternativeto.net/d3a291c3-8e40-df11-b12b-0022190f5762_4_full.png)[[来源](http://alternativeto.net/software/pure-data/about)]）
*   [Reaktor](http://www.native-instruments.com/#/en/products/producer/reaktor-55/) ([截图](http://upload.wikimedia.org/wikipedia/en/d/d6/Reaktor_structure.PNG)[[来源](https://en.wikipedia.org/wiki/Reaktor)])
*   [SCADE](http://www.esterel-technologies.com/products/scade-suite/) ( [screenshot](http://www.railway-technology.com/contractor_images/esterel-technologies/5-scade-drive-editor.gif) [ [source](http://www.railway-technology.com/contractors/computer/esterel-technologies/esterel-technologies5.html) ])，Lustre的图形化编程环境
*   [SynthMaker](http://synthmaker.co.uk/) ( [screenshot](http://www.fumi2kick.com/rrtalk/wp-content/uploads/2009/01/ano03.jpg) [ [source](http://www.fumi2kick.com/rrtalk/archives/1187) ]) 和[FlowStone](http://www.dsprobotics.com/)
*   [vvvv](http://vvvv.org) ([截图](http://screens.alternativeto.net/412439a4-37f0-df11-aa71-0200d897d049_2_full.png)[[来源](http://alternativeto.net/software/vvvv/about)])
*   [Expecco](https://www.exept.de/en/products/expecco.html) ([截图](http://wiki.expecco.de/images/thumb/3/3f/Expecco-web-network-view.jpg/700px-Expecco-web-network-view.jpg)[[来源](http://wiki.expecco.de/wiki/Expecco_web)])
*   [摇一摇](https://en.wikipedia.org/wiki/Shake_(software))（[截图](http://images.macworld.com/images/legacy/2005/05/images/content/shake_big.jpg)[[来源](http://www.macworld.com/article/44831/2005/05/shake35.html)]）
*   [[BLOK]](http://www.blokmodular.com/)（[截图](http://lazytrap.com/img/blok10.png)[[来源](http://www.lazytrap.com/?p=166)]）
*   [Quartz Composer](https://developer.apple.com/technologies/mac/graphics-and-animation.html)（[截图](http://alex4d.files.wordpress.com/2008/12/quartz-composer-ui.jpg)[[来源](http://alex4d.wordpress.com/2008/12/23/final-cut-and-quartz/)]）
*   [AudioMulch](http://www.audiomulch.com/) ([截图](http://www.audiomulch.com/images/info/audiomulch-screenshot-1.png)[[来源](http://www.audiomulch.com/info.htm)])

嵌入可视化数据流语言的产品：

*   [搅拌机](https://www.blender.org/)
*   [沃琳](http://www.voreen.org/)（[截图](http://upload.wikimedia.org/wikipedia/commons/4/44/Voreen-devmode.png)）
*   虚幻引擎的[Kismet](http://www.unrealengine.com/features/kismet/)（[截图](http://www.unrealengine.com/files/features/kismet1.jpg)）
*   [ANKHOR 流程图](http://www.ankhor.com)（[截图](http://www.ankhor.com/images/stories/ankhor/learn-more-2/ANKHOR-FlowSheet-Main-Window-480.png)）
*   [Autodesk Revit 的Dynamo](http://dynamobim.org/)（[截图](http://3.bp.blogspot.com/-Ym-GX0jCaas/UcJXLeC5gGI/AAAAAAAAEjE/YuOolj80t0w/s1600/2013-06-19_2112.png)）
*   [LiveBlox](https://liveblox.org/)（[截图](https://liveblox.org/wp-content/uploads/2016/03/main_product_screenshot.png)）

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-15T06:10:51.563

数据流编程语言是专注于程序状态并根据状态的任何变化导致操作发生的语言。数据流编程语言本质上是并行的，因为操作依赖于输入，当满足时会导致操作执行。这意味着与一个操作之后是下一个操作的正常程序不同，在数据流中，只要满足输入，操作就会执行，因此没有设置顺序。

数据流编程语言通常使用大型哈希表，其中键是程序的数据，表的值是指向程序操作的指针。这使得多核程序更容易在数据流编程语言中创建，因为每个核只需要哈希表即可工作。

数据流编程语言的一个常见示例是电子表格程序，该程序具有受其他数据列影响的数据列。如果一列中的数据发生变化，其他列中的其他数据可能会随之发生变化。尽管电子表格程序是数据流编程语言的最常见示例，但它们中的大多数往往是图形语言。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-01-10T00:43:19.747

一种数据流编程是[反应式编程](http://en.wikipedia.org/wiki/Reactive_programming)。当这种编程风格在函数式语言中使用时，它被称为[函数式反应式编程](http://en.wikipedia.org/wiki/Functional_reactive_programming)。用于 Web 的函数式反应式编程语言的一个示例是[Flapjax](http://www.flapjax-lang.org/)。

此外，[anic](http://code.google.com/p/anic/)是最近在 Hacker News 上[讨论的一种数据流语言。](http://news.ycombinator.com/item?id=1042122)

另一个例子是来自牛津的[Martlet 。](http://portal.acm.org/citation.cfm?id=1242572.1242705)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-07-21T11:02:29.140

**数据流编程语言**建议在所谓的“**参与者**”中隔离一些本地行为，这些参与者应该并行运行并通过点对点通道交换数据。[与冯诺依曼计算机模型](https://en.wikipedia.org/wiki/Von_Neumann_architecture)不同，没有中央存储器（代码和数据）的概念。

这些参与者在其输入上**使用**数据令牌并在其输出上**生成**新数据。

这个定义并没有强加在实践中运行它的方法。但是，数据的生产/消费需要仔细分析：例如，如果参与者 B 的消费速度与生产数据的参与者 A 的速度不同，那么它们之间就需要潜在的无界内存 (FIFO) . 可能会出现许多其他问题，例如[死锁](http://en.wikipedia.org/wiki/Deadlock)。

在许多情况下，这种分析会失败，因为内部行为的交织是难以处理的（超出了当今正式方法的范围）。

尽管如此，**数据流编程语言在许多领域仍然具有吸引力**：

*   例如定义视频编码的参考模型：纯 C 程序无法完成这项工作，因为它假设一切都作为一系列操作运行，这在计算机（管道、VLIW、多核和 VLSI）中是不正确的. 也许你可以看看这个：[最近的博士论文](http://library.epfl.ch/en/theses/?nr=5069)。CAL 数据流语言被提议作为下一代视频编码器/解码器参考的统一语言。
*   需要安全的关键任务：如果您对数据的生产/消费添加一些强有力的假设，那么您将获得一种在代码生成、证明等方面具有强大潜力的语言（请参阅[同步语言](http://www.irisa.fr/espresso/Polychrony/)）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-20T16:05:21.230

Excel（和其他电子表格）本质上是数据流语言。数据流语言很像函数式编程语言，不同之处在于整个程序图的叶子上的值根本不是值，而是变量（或值流），因此当它们发生变化时，变化会涟漪并向上流动.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-15T07:56:16.707

[Mozart](http://www.mozart-oz.org/)支持类似数据流的同步，并且确实有一些商业应用。您也可以争辩说[make](http://www.gnu.org/software/make/)是一种数据流编程语言。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-08-16T19:41:20.837

这实际上是一个相当古老的概念——在 1970 年代，甚至有一种语言 + 机器用于高效的数据流编程和执行（[曼彻斯特数据流](https://en.wikipedia.org/wiki/Dataflow_architecture#History) [机器](https://www.sciencedirect.com/science/article/pii/0010465585901353)）。

它的伟大之处在于它与 Haskell 等惰性函数式语言的双重性。因此，如果您的处理步骤是纯函数式的，并且如果您有足够的处理单元来评估它们并传递结果，您将免费获得最大的并行性 - 自动且无需任何编程工作！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-01-17T16:43:53.400

许多 ETL 工具也在这个领域。MS SSIS 中的数据流任务就是一个很好的例子。本例中的图形工具。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-12-12T15:20:57.817

在某些领域，数据流编程更有意义。实时媒体就是一个例子，两个广泛使用的图形数据流编程环境 Pure Data 和 Max/MSP 都专注于实时媒体编程。我想它们的视觉性质也很好地映射到数据流编程。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-04-25T13:46:23.607

你可以试试**Cameleon**：[www.shinoe.org/cameleon](http://www.shinoe.org/cameleon)，它似乎很容易使用。它是一种用于函数式编程的图形语言，具有数据（工作）流方法。

它是用 C++ 编写的，但它可以调用以任何编程语言编写的任何类型的本地或远程程序。

它具有多尺度方法，并且似乎是[图灵完备](https://en.wikipedia.org/wiki/Turing_completeness)的（这是[Petri 网](https://en.wikipedia.org/wiki/Petri_net)扩展）。

# php - 您可以将 php crypt() 的输出转换为有效的 MD5 吗？

> ID：461800
> 
> 赞同：6
> 
> 时间：2009-01-20T15:36:26.810
> 
> 标签：php, hash, cryptography, md5, crypt

我有一些使用[PHP 函数`crypt()`](http://php.net/crypt)加密的字符串。

输出看起来像这样：

```
$1$Vf/.4.1.$CgCo33ebiHVuFhpwS.kMI0
$1$84..vD4.$Ps1PdaLWRoaiWDKCfjLyV1
$1$or1.RY4.$v3xo04v1yfB7JxDj1sC/J/ 
```

虽然我相信 crypt() 使用的是 MD5 算法，但输出不是有效的 MD5 哈希。

有没有办法将生成的哈希转换为有效的 MD5 哈希（16 字节十六进制值）？

* * *

*更新：*

感谢您的回复，所以到目前为止的答案。我很确定使用的 crypt 函数正在使用某种 MD5 算法。我要做的是将我拥有的输出转换为 MD5 哈希，如下所示：

```
9e107d9d372bb6826bd81d3542a419d6  
e4d909c290d0fb1ca068ffaddf22cbd0  
d41d8cd98f00b204e9800998ecf8427e 
```

*（取自[维基百科](http://en.wikipedia.org/wiki/MD5)）*

有没有办法从我必须的哈希转换为上面的哈希？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-02-10T15:05:11.593

好的，所以也许这个答案晚了一年，但我会试一试。在您自己的回答中，您注意到`crypt()`使用的是 FreeBSD MD5，它还在运行哈希之前对 salt 进行了一些有趣的转换，因此我将要给您的结果永远不会与 a 的结果完全匹配打电话给`md5()`. 也就是说，您看到的输出与您习惯的格式之间的唯一区别是您看到的输出编码如下

```
$1$        # this indicates that it is MD5
Vf/.4.1\.   # these eight characters are the significant portion of the salt
$          # this character is technically part of the salt, but it is ignored
CgCo33eb   # the last 22 characters are the actual hash
iHVuFhpw   # they are base64 encoded (to be printable) using crypt's alphabet
S.kMI0     # floor(22 * 6 / 8) = 16 (the length in bytes of a raw MD5 hash) 
```

据我所知，crypt 使用的字母表如下所示：

```
./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz 
```

因此，考虑到所有这些，以下是如何将 22 个字符的 crypt-base64 散列转换为 32 个字符的 base16（十六进制）散列：

首先，您需要一些东西来将 base64（带有自定义字母）转换为原始的 16 字节 MD5 散列。

```
define('CRYPT_ALPHA','./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz');
/**
 * Decodes a base64 string based on the alphabet set in constant CRYPT_ALPHA
 * Uses string functions rather than binary transformations, because said
 * transformations aren't really much faster in PHP
 * @params string $str  The string to decode
 * @return string       The raw output, which may include unprintable characters
 */
function base64_decode_ex($str) {
    // set up the array to feed numerical data using characters as keys
    $alpha = array_flip(str_split(CRYPT_ALPHA));
    // split the input into single-character (6 bit) chunks
    $bitArray = str_split($str);
    $decodedStr = '';
    foreach ($bitArray as &$bits) {
        if ($bits == '$') { // $ indicates the end of the string, to stop processing here
            break;
        }
        if (!isset($alpha[$bits])) { // if we encounter a character not in the alphabet
            return false;            // then break execution, the string is invalid
        }
        // decbin will only return significant digits, so use sprintf to pad to 6 bits
        $decodedStr .= sprintf('%06s', decbin($alpha[$bits]));
    }
    // there can be up to 6 unused bits at the end of a string, so discard them
    $decodedStr = substr($decodedStr, 0, strlen($decodedStr) - (strlen($decodedStr) % 8));
    $byteArray = str_split($decodedStr, 8);
    foreach ($byteArray as &$byte) {
        $byte = chr(bindec($byte));
    }
    return join($byteArray);
} 
```

现在您已经获得了原始数据，您需要一种方法将其转换为您期望的 base-16 格式，这再简单不过了。

```
/**
 * Takes an input in base 256 and encodes it to base 16 using the Hex alphabet
 * This function will not be commented.  For more info:
 * @see http://php.net/str-split
 * @see http://php.net/sprintf
 *
 * @param string $str   The value to convert
 * @return string       The base 16 rendering
 */
function base16_encode($str) {
    $byteArray = str_split($str);
    foreach ($byteArray as &$byte) {
        $byte = sprintf('%02x', ord($byte));
    }
    return join($byteArray);
} 
```

最后，由于 crypt 的输出包含很多我们不需要（实际上也不能使用）这个过程的数据，一个简短而巧妙的函数不仅可以将这两者联系在一起，而且允许直接输入输出从地穴。

```
/**
 * Takes a 22 byte crypt-base-64 hash and converts it to base 16
 * If the input is longer than 22 chars (e.g., the entire output of crypt()),
 * then this function will strip all but the last 22\.  Fails if under 22 chars
 *
 * @param string $hash  The hash to convert
 * @param string        The equivalent base16 hash (therefore a number)
 */
function md5_b64tob16($hash) {
    if (strlen($hash) < 22) {
        return false;
    }
    if (strlen($hash) > 22) {
        $hash = substr($hash,-22);
    }
    return base16_encode(base64_decode_ex($hash));
} 
```

鉴于这些功能，您的三个示例的 base16 表示是：

```
3ac3b4145aa7b9387a46dd7c780c1850
6f80dba665e27749ae88f58eaef5fe84
ec5f74086ec3fab34957d3ef0f838154 
```

当然，重要的是要记住它们总是有效的，只是格式不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T15:50:38.840

$1$ 确实意味着这是一个 MD5 哈希，但 crypt 生成一个随机盐。这就是您找到不同 MD5 值的原因。如果包含生成的盐，您会发现相同的结果。

盐在输出中被 base64 编码，作为散列。

使用的算法是系统范围的参数。通常这是MD5，你是对的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T16:02:31.453

我相信我最初问题的答案是否定的，您不能从一种格式转换为另一种格式。

php crypt() 生成的哈希似乎是由 Poul-Henning Kamp 创建的 FreeBSD MD5 哈希实现的一个版本生成的。

[http://people.freebsd.org/~phk/](http://people.freebsd.org/~phk/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T15:47:22.967

从文档来看，这取决于系统。您可以通过设置 salt 参数来强制使用算法。从文档：

> 加密类型由 salt 参数触发。在安装时，PHP 会确定 crypt 函数的功能，并将接受其他加密类型的盐。如果没有提供盐，PHP 将默认自动生成一个标准的两个字符的盐，除非系统上的默认加密类型是 MD5，在这种情况下会随机生成一个与 MD5 兼容的盐。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T15:49:28.343

来自[http://php.net/crypt](http://php.net/crypt)：

> crypt() 将使用基于标准 Unix DES 的加密算法或系统上可能可用的替代算法返回加密字符串。

你想要的[`md5()`](http://php.net/md5)功能：

> 使用 » RSA Data Security, Inc. MD5 Message-Digest Algorithm 计算 str 的 MD5 哈希，并返回该哈希。
> 如果可选的 raw_output 设置为 TRUE，则 md5 摘要以长度为 16 的原始二进制格式返回。默认为 FALSE。

# regex - 正则表达式匹配替换帮助

> ID：461809
> 
> 赞同：3
> 
> 时间：2009-01-20T15:38:28.040
> 
> 标签：regex, .htaccess, mod-rewrite

我正在尝试对 .htaccess 文件进行正则表达式匹配和替换，但我不太清楚替换位。我认为我的比赛部分是正确的，但也许有人可以提供帮助。

我有这个 网址 - [http://www.foo.com/MountainCommunities/Lifestyles/5/VacationHomeRentals.aspx](http://www.foo.com/MountainCommunities/Lifestyles/5/VacationHomeRentals.aspx)

我正试图把它变成这个- [http://www.foo.com/mountain-lifestyle/Vacation-Home-Rentals.aspx](http://www.foo.com/mountain-lifestyle/Vacation-Home-Rentals.aspx)

(MountainCommunities/Lifestyles)/\d/(.*)(.aspx)

然后我想我会有一个像这样开始的重写规则-

山地生活方式/$2$3

但在这种情况下，我需要取 $2 中的内容并重写它以在大写字母的单词之间放置破折号。现在我难住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T16:19:33.387

我认为您必须分两步完成...取出 2 美元，在每个大写字母（除了第一个大写字母）之前加上 -，然后使用将结果附加到[http://www.foo.com/mountain -lifestyle/](http://www.foo.com/mountain-lifestyle/)以 .aspx 结尾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T16:49:24.417

尝试这个：

```
RewriteRule ^(([A-Z][a-z]+-)*)([A-Z][a-z]+)(([A-Z][a-z]+)+)(\.aspx)?$ /$1$3-$4 [N]
RewriteRule ^([A-Z][a-z]+-)+[A-Z][a-z]+$ /$0.aspx [R=301] 
```

请注意，mod_rewrite 使用内部计数器来检测和避免无限循环。因此，您的 URL 可能不会包含太多需要转换的单词（请参阅Apache < 2.1 的[`MaxRedirects`选项和 Apache ≥ 2.1 的](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewriteoptions)[`LimitInternalRecursion`指令](http://httpd.apache.org/docs/2.1/mod/core.html#limitinternalrecursion)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T18:35:59.677

我认为主要的正则表达式是由其他人编写的，但是为了匹配请求名称以放置破折号（假设所有文件名都有一个三名骆驼大小写表示 ala 'VacationHomeRentals.aspx'：

```
RewriteRule: ^/MountainCommunities/Lifestyles/\d+/([A-Z][a-z]+)([A-Z][a-z]+)([A-Z][a-z]+)\.aspx$ /mountain-lifestyle/$1-$2-$3.aspx 
```

这是@Gumbo 响应的受限版本，因为我没有机会测试他的递归。对于任何场景，递归技术绝对是最好和最有用的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T16:53:58.450

您可以在中间位“VacationHome”上使用正则表达式“（[AZ]）”，替换为正则表达式“-$1” - 这将给你“-Vacation-Home-Rentals” - 然后你可以砍掉第一个字符，并将 URL 的第一部分放在前面，将 .aspx 放在最后。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T16:10:14.043

我不认为你用大写字母做什么是可能的正则表达式......

您最好在 URL 中保留破折号并删除 .aspx

例如：[http ://www.foo.com/MountainCommunities/Lifestyles/5/Vacation-Home-Rentals](http://www.foo.com/MountainCommunities/Lifestyles/5/Vacation-Home-Rentals)

这将需要以下规则：

```
^/MountainCommunities/Lifestyles/5/([^/]+)/\?([^/]+)   /mountain-lifestyle/$1.aspx?$2 [I] 
```

这也考虑了发送到页面的任何查询字符串。

顺便说一句：您如何将 .htaccess 与 IIS 一起使用？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T18:19:42.597

我认为我不太了解您要做什么。为什么你不能简单地搜索：

`http://www.foo.com/MountainCommunities/Lifestyles/5/VacationHomeRentals.aspx`

并将其替换为：

`http://www.foo.com/mountain-lifestyle/Vacation-Home-Rentals.aspx`?

或者这是您尝试转换的模式的具体示例？

# performance - 紧凑框架和 JIT。可能需要多长时间

> ID：461811
> 
> 赞同：2
> 
> 时间：2009-01-20T15:38:39.303
> 
> 标签：performance, compact-framework, jit

我们的应用程序有/有一个幻影延迟。这可以追溯到第一次触摸对象时对单例的初始化，并归咎于 JIT。我并不完全相信这一点，因为没有测量 JIT 的机制（或者有吗？），整个延迟是 7 秒。七秒的JIT？！？那会是真实的吗？

无论哪种方式，我都很难责怪那些无法轻易衡量的事情。不久前，当我看到这个问题时，我注释掉了一堆代码，并在应用程序的其他地方看到了 7 秒的延迟“跳跃”。暗示它以某种方式发生在某处的后台进程中（我猜这会将 JIT 视为潜在原因）。

如果有一个碰巧引用了许多其他对象的静态对象只是为了好玩，是否有人对 JIT 可能需要多长时间有一个经验法则？有没有人有进一步的参考，所以我可以了解更多关于 JIT 的信息，这样我就有机会了解 JIT 是否应该/应该归咎于这种减速？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T16:04:39.233

我只看到 JIT 在一个奇怪的错误中花费了很长时间（大于 1 秒），该错误与模板化集合中的模板化项目有关（参见下面的编辑）。

无论如何，您看到它“移动”的事实肯定向我表明这可能不是问题所在。为了尝试明确地确定这一点，我会考虑使用 RPM 来查看延迟前后发生的情况。

预期的 JIT 时间是一件非常模糊的事情，因为有很多因素会影响它。处理器速度是一个显而易见的问题，但不太明显的可能是应用存储介质和设备内存压力等问题。

存储介质会影响 JIT 速度，因为 JITter 在需要 JIT 时必须从介质中拉出 IL，如果拉得很慢，那么 JIT 就会很慢。

内存压力是一项艰巨的任务，并且会对 CE 设备产生严重影响。这里的问题是，当您开始耗尽内存时，EE 将在收集期间开始投放 JITted 代码 - 除了调用堆栈之外的所有内容。现在，如果你在一个例程中，例如，调用一些工人或助手的东西，或者有一个线程正在运行，那么那个助手方法可能会被调整、JITted、pitched JITted 等。这被称为“鞭打。”

使用 RPM 识别后者相当容易（修复它可能不是那么容易）。查看要频繁提升的代码数量，并寻找提升数量的增加与您感知的锁定之间的强相关性。

**编辑：**我终于[在这里找到了错误描述](http://social.msdn.microsoft.com/Forums/en-US/netfxcompact/thread/150261e9-4be2-4675-842e-fbde0448e25c/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T16:11:49.563

JIT（和 GC）计时器等可以在这里找到：

.NET Compact Framework 中的性能计数器 ( [http://msdn.microsoft.com/en-us/library/ms172525.aspx](http://msdn.microsoft.com/en-us/library/ms172525.aspx) )

在 .NET Compact Framework 上监控应用程序性能第一部分 - 启用性能计数器 ( [http://blogs.msdn.com/davidklinems/archive/2005/10/04/476988.aspx](http://blogs.msdn.com/davidklinems/archive/2005/10/04/476988.aspx) )

使用 .Net Compact Framework 远程性能监视器分析设备应用程序性能 ( [http://blogs.msdn.com/stevenpr/archive/2006/04/17/577636.aspx](http://blogs.msdn.com/stevenpr/archive/2006/04/17/577636.aspx) )

.NET Framework 中的性能计数器
( [http://msdn.microsoft.com/en-us/library/w8f5kw2e(VS.80).aspx](http://msdn.microsoft.com/en-us/library/w8f5kw2e(VS.80).aspx) )

问候，坦伯格

# java - 如何解决java中的流关闭错误？

> ID：461826
> 
> 赞同：1
> 
> 时间：2009-01-20T15:41:35.850
> 
> 标签：java, sockets

我非常感谢所有阅读本文并尝试帮助我的人，以下是我尝试为大学套接字编程项目的服务器类编写的代码：

```
import java.io.*;
import java.net.*;
import java.io.File;

class Server{
    public static void main (String[]args)throws IOException{
        ServerSocket socket1 = new ServerSocket (8000);
        while (true) {
            Socket incoming = socket1.accept();
            new newclass(incoming).start();
        }
    }
}

class newclass extends Thread implements Runnable {

    Socket incoming;

    public newclass(Socket incoming) {
        this.incoming = incoming;
    }

    public void run() {
        try {
            byte x = 0;
            String z;
            String s = "HTTP 1.0 200 Document follows";
            String s1 = "Bad request message";
            BufferedReader input = new BufferedReader(new InputStreamReader(incoming.getInputStream()));
            PrintWriter output = new PrintWriter(incoming.getOutputStream(), true);
            DataOutputStream sending = new DataOutputStream(incoming.getOutputStream());
            File directory = new File("C:\\Documents and Settings\\Ahmed\\Desktop\\bla\\Server");
            File[] files = directory.listFiles();
            int x1 = files.length;
            if ((x1 - 3) < 10) {
                boolean done = false;
                while (!done) {
                    String line = input.readLine();
                    System.out.println(line);
                    if (line.equals("BYE")) {
                        output.println("BYE");
                        done = true;
                    } else {
                        if (line.trim().substring(0, 3).equals("GET ")) {
                            if (line.equals("<javalogo.png> HTTP    1.0")) {
                                File f = new File("javalogo.png");
                                int size = (int) f.length();
                                if (f.exists() == true) {
                                    output.println(s);
                                    output.println(size);
                                    output.println("javalogo1.png");
                                    DataInputStream bytefile = new DataInputStream(new BufferedInputStream(new FileInputStream(f)));
                                    while (bytefile.available() != 0) {
                                        x = bytefile.readByte();
                                        sending.write(x);
                                    }
                                } else {
                                    System.out.println("Getting file from main server");
                                    Socket socket2 = new Socket("127.0.0.1", 8100);
                                    BufferedReader bUsr = new BufferedReader(new InputStreamReader(System.in));
                                    PrintWriter pOut = new PrintWriter(socket2.getOutputStream(), true);
                                    BufferedReader bIn = new BufferedReader(new InputStreamReader(socket2.getInputStream()));
                                    pOut.println("GET <javalogo.png> HTTP 1.0");
                                    String rep = bIn.readLine();
                                    if (rep.equals("HTTP 1.0 200 Document follows")) {
                                        int len = Integer.parseInt(bIn.readLine());
                                        String fname = bIn.readLine();
                                        File f1 = new File(fname);
                                        f1.createNewFile();
                                        FileOutputStream fos = new FileOutputStream(f1);
                                        DataInputStream dis = new DataInputStream(socket2.getInputStream());
                                        for (int i = 0; i < len; i++) {
                                            fos.write(dis.read());
                                        }
                                        fos.close();
                                    } else if (rep.equals("File does not exist")) {
                                        output.println("Sorry, but the file was neither found in the proxy server or the main server or the name is wrong.");
                                    }

                                }
                            }
                            File f2 = new File("javalogo.png");
                            if (f2.exists() == true) {
                                int size = (int) f2.length();
                                output.println(s);
                                output.println(size);
                                output.println("javalogo.png");
                                DataInputStream bytefile = new DataInputStream(new BufferedInputStream(new FileInputStream(f2)));
                                while (bytefile.available() != 0) {
                                    x = bytefile.readByte();
                                    sending.write(x);
                                }
                            }
                        } else {
                            System.out.println(s1);
                            output.println(s1);
                        }
                    }
                }
                incoming.close();

            }
            output.println("Connecting to main server");
        } catch (Exception ex) {
            System.out.println(ex.getMessage());
        }
    }
} 
```

现在我不明白为什么在上面运行以下客户端时会出现错误。
我得到了这个非常奇怪的错误，缓冲的阅读器正确地从用户那里读取了第一行，但是第二个它给了我一个 null 异常，就好像客户端写了 null 或其他东西一样，我不明白。

无论如何，这是客户端代码，如果有人可以帮助我，我将非常感激。

```
import java.net.*;
import java.io.*;

public class Client {

    public static void main(String[] args) throws Exception {

        Socket socket1 = new Socket("127.0.0.1", 8000);

        BufferedReader bUsr = new BufferedReader(new InputStreamReader(System.in));
        PrintWriter pOut = new PrintWriter(socket1.getOutputStream(), true);
        BufferedReader bIn = new BufferedReader(new InputStreamReader(socket1.getInputStream()));
        String cmd;
        String rep;
        while (true) {
            cmd = bUsr.readLine();
            pOut.println(cmd);

            System.out.println(rep = bIn.readLine());

            if (cmd.equals("BYE") || cmd.equals("END"))
                break;
            else if (rep.equals("HTTP 1.0 200 Document follows")) {
                int len = Integer.parseInt(bIn.readLine());
                String fname = bIn.readLine();
                File f = new File(fname);
                f.createNewFile();
                FileOutputStream fos = new FileOutputStream(f);
                DataInputStream dis = new DataInputStream(socket1.getInputStream());
                for (int i = 0; i < len; i++) {
                    fos.write(dis.read());
                }

                fos.close();
                System.out.println("Success");

            } else if (rep.equals("Connecting to main server")) {
                Socket socket1 = new Socket("127.0.0.1", 8100);
                BufferedReader bUsr = new BufferedReader(new InputStreamReader(System.in));
                PrintWriter pOut = new PrintWriter(socket1.getOutputStream(), true);
                BufferedReader bIn = new BufferedReader(new InputStreamReader(socket1.getInputStream()));
                String cmd;
                String rep;
                while (true) {
                    cmd = bUsr.readLine();
                    pOut.println(cmd);

                    System.out.println(rep = bIn.readLine());

                    if (cmd.equals("BYE") || cmd.equals("END"))
                        break;
                    else if (rep.equals("HTTP 1.0 200 Document follows")) {
                        int len = Integer.parseInt(bIn.readLine());
                        String fname = bIn.readLine();
                        File f = new File(fname);
                        f.createNewFile();
                        FileOutputStream fos = new FileOutputStream(f);
                        DataInputStream dis = new DataInputStream(socket1.getInputStream());
                        for (int i = 0; i < len; i++) {
                            fos.write(dis.read());
                        }

                        fos.close();
                        System.out.println("Success");
                    }
                }
            }

            bIn.close();
            pOut.close();
            socket1.close();
        }
    } 
```

这是第一次在这个网站上问任何东西，所以如果我做错了什么，我会非常乐意改变我写的东西。

顺便说一句，服务器中声明“从主服务器获取文件”的部分是服务器本身成为主服务器的客户端的部分，它从那里获取文件并将其发送给客户端，我没有添加主服务器代码，因为它的代码太多，但基本上它与服务器相同，没有 if 条件将其限制为仅目录中的 10 个文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T18:01:06.217

通常，当出现 NullPointerException 时：

*   你还没有实例化你的对象
*   您的对象已被销毁（关闭），因此不存在
*   您的演员阵容无效
*   您的代码已覆盖您的对象指针

您需要检查您的堆栈转储以查看其中哪些是正确的。

从[Jav Docs](http://java.sun.com/j2se/1.4.2/docs/api/java/io/InputStreamReader.html)中，如果发生 I/O 错误，读取可以抛出 IOException，并且[IOException](http://java.sun.com/j2se/1.4.2/docs/api/java/io/IOException.html)可以为您提供指定的详细消息。稍后可以通过 java.lang.Throwable 类的 Throwable.getMessage() 方法检索错误消息字符串。

两点：

*   IOException 细节给你什么？
*   由于这是针对您的大学课程，请尝试向您的同学或助教寻求帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T19:57:27.293

如果您从 BufferedReader.readLine() 获得 null ，则意味着您已到达输入的末尾，因为它在该方法的 javadoc 中声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T00:04:09.407

Ahemd，我在发布的类中也看到了一些潜在的错误和一些实际的错误，但是代码太复杂了，我无法专注于您所看到的问题。如果您仍然遇到网络错误，请尝试将代码以及客户端和服务器减少到最低限度以进行通信（发送/读取一行）。如果这对您不起作用，请发布这些课程，我们将能够比此处发布的较大课程更快地发现问题。

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T15:51:54.750

如果我说我完全理解您的代码在做什么，那我是在撒谎 - 但是，如果您在从希望包含数据的流中读取数据时得到空数据，则可能是输出流没有“刷新”数据。

确保在写入输出流后调用[flush()方法](http://java.sun.com/javase/6/docs/api/java/io/OutputStream.html#flush())

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-15T12:29:11.627

找到错误解决方案的最佳方法是查看跟踪。没有它，我会在您的代码中看到不止一个错误。

问候。

# c++ - Arduino C++ 代码：可以使用虚函数和异常吗？

> ID：461836
> 
> 赞同：15
> 
> 时间：2009-01-20T15:44:46.810
> 
> 标签：c++, arduino, virtual-functions, firmware

从问题编写[固件](https://stackoverflow.com/questions/452139/writing-firmware-assembly-or-high-level#452401)[：组装还是高级？](https://stackoverflow.com/questions/452139/writing-firmware-assembly-or-high-level)：

[为Arduino](http://arduino.cc)平台编译C++代码时，可以使用虚函数、异常等吗？还是您想（必须）使用 C++ 的一个子集（如[评论中所述](https://stackoverflow.com/questions/452139/writing-firmware-assembly-or-high-level#452401)）？

为 Arduino 平台编程时还有其他注意事项吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-07T22:23:32.950

Arduino 环境使用 GCC 工具链的 AVR 版本。代码编译为 C++，因此您可以使用类。虚拟功能是可能的；vtables 将存储在 .data 部分并具有正确的地址。事实上，Print 基类使用虚函数来使各种“打印”方法适应不同的输出类型。

由于代码空间原因，不支持异常。Arduino 环境将“-fno-exceptions”传递给编译器命令行。请参阅[来源](http://code.google.com/p/arduino/source/browse/trunk/app/Compiler.java#518)以验证这一点。

支持模板。例如，[这种免费的流插入运算符技术](http://arduiniana.org/libraries/streaming/)使用简单的模板和内联运算符就可以很好地工作。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-17T13:02:14.427

Arduino 软件使用 avr-gcc 来编译草图。以下限制来自[avrlibc 常见问题解答（我可以在 AVR 上使用 C++ 吗？）](http://www.nongnu.org/avr-libc/user-manual/FAQ.html#faq_cplusplus)：

**支持的**

*   虚函数
*   构造函数和析构函数（包括全局的）

**不支持**

*   C++ 标准函数、类和模板类（但请参阅[uClibc++ for Arduino 的这个端口](https://github.com/maniacbug/StandardCplusplus)）
*   运算符`new`和`delete`（尝试使用它们将导致链接器抱怨未定义的外部引用）。这意味着对象只能在堆栈上创建。如果需要动态内存分配，则必须使用`malloc()`and `free()`of`C`类型来实现
*   例外。`-fno-exceptions`由于 C++ 前端默认启用异常，因此需要在编译器选项中明确关闭它们。这是由 Arduino IDE 在启动时自动完成的`avr-gcc`

**其他问题**

*   一些提供的包含文件不是 C++ 安全的，即它们需要用
    `extern "C" { . . . }`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T04:38:12.740

功能的可用性不受平台限制，而是受您使用的编译器的限制。

我会检查您的编译器文档以了解支持哪些语言功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T14:29:17.663

[Comeau 计算](http://www.comeaucomputing.com/)有一个 C++ 到 C 编译器，它支持所有 C++ 特性。不只是虚函数或异常，还有导出。您需要调用 Comeau 以使其以 Arduino 语言为目标，但应该不会太难。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T06:46:14.667

文档说：

> Arduino 语言基于 C/C++，支持所有标准 C 结构和一些 C++ 特性。

它没有说明我能找到的虚函数。

我尝试了一个简单的程序，它编译得很好。不过，我还没有在 Arduino 硬件上测试过它。

编辑：我也没有测试异常。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T18:05:15.097

[我在这个 Makefile](http://electrons.psychogenic.com/articles/Makefile.tpl)中使用了 g++并从[这个代码](http://blog.brush.co.nz/2008/07/protothreads/)开始。C++ 浪费了一些空间。但是 protothreads 太酷了，不能用。

# vba - copy Word document contents without using clipboard (VBA)

> ID：461840
> 
> 赞同：8
> 
> 时间：2009-01-20T15:45:47.137
> 
> 标签：vba, ms-word

I was wondering how to avoid using Windows clipboard, when you want to "replicate" multiple sections of a Word document (using VBA in macros)

Why to avoid? Because we're using Word on a server, in a multiuser environment (I know that it is officially frowned upon)

Otherwise, this would be easily accomplished with Selection.Copy and Selection.Paste methods.

Thanks.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T15:12:01.600

I finally resolved to copy word by word. FormattedText seemed to work fairly well, until the last word (some special (evidently) characters), where suddenly the cell that I just filled with copied content would go blank. When I increased the number of cells, other run-time errors would pop up, like Your table got corrupted, and other ambiguous ones. Somehow, the source cell that I was copying from always seemed to have these peculiar chars in the end with ASCII codes 13 and 7\. I know what 13 means, but 7? Anyway, I decided to copy everything apart from this last character with code 7\. It seems to work alright. Both formatting and fields are copied too. In any case, the whole story proved to me for one more time that programming in VBA is mostly trial-and-error occupation. You are never sure when something might break.. unless I am missing update on some crucial concepts..

Here's the chunks of the code I used. The idea is that first we have a document with a single 1x1 cell table, with some rich text content. In the first piece of the code (inside a macro) I multiply the cells:

```
Dim cur_width As Integer, i As Integer, max_cells As Integer, cur_row As Integer
Dim origin_width As Integer
   If ActiveDocument.Tables.Count = 1 _
      And ActiveDocument.Tables(1).Rows.Count = 1 _
      And ActiveDocument.Tables(1).Columns.Count = 1 _
   Then
      max_cells = 7   ' how many times we are going to "clone" the original content
      i = 2           ' current cell count - starting from 2 since the cell with the original content is cell number 1
      cur_width = -1  ' current width
      cur_row = 1     ' current row count
      origin_width = ActiveDocument.Tables(1).Rows(1).Cells(1).Width

      ' loop for each row
      While i <= max_cells

          ' adjust current width
          If cur_row = 1 Then
             cur_width = origin_width
          Else
             cur_width = 0
          End If

          ' loop for each cell - as long as we have space, add cells horizontally 
          While i <= max_cells And cur_width + origin_width < ActiveDocument.PageSetup.PageWidth 
              Dim col As Integer

              ' \ returns floor() of the result
              col = i \ ActiveDocument.Tables(1).Rows.Count 

              // 'add cell, if it is not already created (which happens when we add rows)
              If ActiveDocument.Tables(1).Rows(cur_row).Cells.Count < col Then
                 ActiveDocument.Tables(1).Rows(cur_row).Cells.Add
              End If

              // 'adjust new cell width (probably unnecessary
              With ActiveDocument.Tables(1).Rows(cur_row).Cells(col)
                .Width = origin_width
              End With

              // 'keep track of the current width
              cur_width = cur_width + origin_width
              i = i + 1
          Wend

          ' when we don't have any horizontal space left, add row
          If i <= max_cells Then
            ActiveDocument.Tables(1).Rows.Add
            cur_row = cur_row + 1
          End If

      Wend
   End If 
```

In the second part of the macro I populate each empty cell with the contents of the first cell:

```
 ' duplicate the contents of the first cell to other cells
   Dim r As Row
   Dim c As Cell
   Dim b As Boolean
   Dim w As Range
   Dim rn As Range
   b = False
   i = 1

   For Each r In ActiveDocument.Tables(1).Rows
       For Each c In r.Cells
            If i <= max_cells Then
                // ' don't copy first cell to itself
                If b = True Then

                    ' copy everything word by word
                    For Each w In ActiveDocument.Tables(1).Rows(1).Cells(1).Range.Words

                        ' get the last bit of formatted text in the destination cell, as range
                        ' do it first by getting the whole range of the cell, then collapsing it
                        ' so that it is now the very end of the cell, and moving it one character
                        ' before (because collapsing moves the range actually beyond the last character of the range)
                        Set rn = c.Range
                        rn.Collapse Direction:=wdCollapseEnd
                        rn.MoveEnd Unit:=wdCharacter, Count:=-1

                        ' somehow the last word of the contents of the cell is always Chr(13) & Chr(7)
                        ' and especially Chr(7) causes some very strange and murky problems
                        ' I end up avoiding them by not copying the last character, and by setting as a rule
                        ' that the contents of the first cell should always contain an empty line in the end
                        If c.Range.Words.Count <> ActiveDocument.Tables(1).Rows(1).Cells(1).Range.Words.Count Then
                            rn.FormattedText = w
                        Else
                            'MsgBox "The strange text is: " & w.Text
                            'the two byte values of this text (which obviously contains special characters with special
                            'meaning to Word can be found (and watched) with
                            'AscB(Mid(w.Text, 1, 1)) and  AscB(Mid(w.Text, 2, 1))
                            w.MoveEnd Unit:=WdUnits.wdCharacter, Count:=-1
                            rn.FormattedText = w
                        End If
                    Next w

                End If
                b = True
            End If

            i = i + 1
       Next c
   Next r 
```

Here are the images of the Word document in question. First image is before running the macro, second is between the first chunk of code and the last, while the third image is the resulting document.

[Image 1](http://i41.photobucket.com/albums/e276/morninghalo/stackovfl/1.jpg) [Image 2](http://i41.photobucket.com/albums/e276/morninghalo/stackovfl/2.jpg) [Image 3](http://i41.photobucket.com/albums/e276/morninghalo/stackovfl/done.jpg)

That's it.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-24T21:25:52.200

In Office 2007+ VSTO, you can export the block with [Range.ExportFragment](https://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range.exportfragment%28v=office.15%29.aspx) and then go to your new document and import it with [Range.ImportFragment](https://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range.importfragment.aspx?f=255&MSPPError=-2147217396). I haven't used this in production, but experimented with it and it seems to work OK.

One caveat, I got errors when trying to export as a .docx, but RTF seemed to work ok.

Both methods exist in VBA as well, but I only tested the VSTO methods.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-06T18:38:07.913

This doesn't always work, with text fields, diagramms, for example, or if you need to copy it to another document, but it's good for copying simple formatted text inside one document.

```
'First select something, then do
Word.WordBasic.CopyText
'Then move somewhere
Word.WordBasic.OK; 
```

To copy the whole document to a new document use this:

```
Word.Application.Documents.Add Word.ActiveDocument.FullName 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-04T16:07:26.933

I ran into a similar issue. I wanted to copy a table from one word doc to another using Powershell without using the clipboard. Since a user using the computer while the script ran could break the script by using the clipboard. The solution I came up with was:

1.  Open the source document and put a bookmark covering the range of what I wanted (in my case a single table).
2.  Save the source document with its bookmark in another location (to avoid changing the source document).
3.  Opened the destination document and created a range object for where I wanted the table placed.
4.  Used `range.InsertFile` with the first parameter of the source file with my bookmark and the second parameter of my bookmark name. This single operation pulled the entire table plus source formatting directly into the destination document.

I then added code based on where the insertion was being done and how much longer the story was to select the inserted table to allow further operations on it.

I tried many any other methods to move the table and this was by far the best. Sorry I can't provide VBA code for this solution.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-20T19:35:36.627

Use the Text property of the Selection object to put the data into a string variable rather than onto the clipboard:

Dim strTemp as String

strTemp = Selection.Text

You can then insert the text stored in the variable elsewhere as needed.

# c# - 在设置和部署中预编译网站

> ID：461842
> 
> 赞同：3
> 
> 时间：2009-01-20T15:46:16.587
> 
> 标签：c#, asp.net, visual-studio-2008, setup-deployment

每次我使用 Setup & Deployment 创建一个新的 Web 设置并运行它（在编辑属性中的所有好东西之后），输出始终是网站项目的副本......

如何输出网站项目的 PreCompile 版本？

我所做的是，发布网站（所以我得到了预编译版本），将这个新的预编译网站作为现有网站添加到我的解决方案中，并将其添加到安装程序的内容输出中......

好吧，这个想法很好，但我收到一条错误消息：

```
"This application is already precompiled." 
```

[替代文字 http://www.balexandre.com/temp/stackoverflow_precompiledquestion.png](http://www.balexandre.com/temp/stackoverflow_precompiledquestion.png)

:-(

底线是我只想要一个安装文件，它为我提供了我的 Web 项目的预编译版本，我该如何完成呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T22:13:57.880

我看到您尝试了 VS 的标准 Web 设置项目。Scott Gu 的博文将您带到此页面：

[Visual Studio 2008 Web 部署项目](http://www.microsoft.com/downloads/details.aspx?FamilyID=0aa30ae8-c73b-4bdd-bb1b-fe697256c459&DisplayLang=en)

它是 Visual Studio 的一个插件，可激活任何网站项目的附加“右键单击”选项以添加此类部署项目。您可以在这里看到我创建的内容......输出是一个预编译的 Web 应用程序。现在，如果您将常规 Web 安装项目添加到您的解决方案中，并将其指向之前创建的 Web 部署项目作为其内容，...我得到了一个有效的构建，没有错误，并且创建了一个 MSI 文件...使用 dll在里面。

[http://img222.imageshack.us/img222/6177/71881923mj9.jpg](http://img222.imageshack.us/img222/6177/71881923mj9.jpg)

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T07:51:51.810

我一直在从谷歌搜索这个解决方案。我所做的是将我的网站预编译到一个文件夹中，并将该文件夹作为新网站添加到我的解决方案中（添加时会发出警告消息，指出它已经是预编译的内容。没有问题）。现在将此项目输出添加到我的设置项目中，更重要的是在我的 Web 部署项目中，我刚刚禁用了预编译网站的构建。

我只是让我的想法起作用。如果你愿意，你可以试试。

问候， Rousseau.A

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-16T08:35:26.030

您的 Web 应用程序的根目录中可能有“PrecompiledApp.config”文件（请检查解决方案资源管理器）。

我遇到了这个问题并从解决方案资源管理器中删除了“PrecompiledApp.config”并解决了这个问题。

# css - 用于MusiSync 字体的 Internet Explorer CSS 行高

> ID：461850
> 
> 赞同：1
> 
> 时间：2009-01-20T15:49:07.363
> 
> 标签：css, internet-explorer, fonts

我正在尝试使用 MusiSync 字体在一行文本中嵌入一个尖锐而扁平的符号。为了防止这些符号变得很小，我必须将它们的磅值设置为文本其余部分的两倍。不幸的是，这弄乱了 Internet Explorer 中的行高，我找不到控制它的方法。您可以在以下位置下载 MusicSync 字体：

[http://www.icogitate.com/~ergosum/fonts/musicfonts.htm](http://www.icogitate.com/~ergosum/fonts/musicfonts.htm)

我在网页中使用此字体的尝试可以在以下位置找到：

[http://www.williamsportwebdeveloper.com/MusiSync.htm](http://www.williamsportwebdeveloper.com/MusiSync.htm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T17:00:18.607

我打开了 Photoshop 并使用了您链接到的字体。字体本身的每个字形上方都有大量空白。字体设计得很差。

如果您将样式设置为此，您将看到问题：

```
.style2 {
    font-family: MusiSync;
    font-size: 24pt;
    border:1px solid #000000;
} 
```

该问题也出现在 FireFiox 3 中，只是表现方式略有不同。

您也许可以以某种方式解决此问题，但这会很丑陋。除非您使用许多不同的字体大小，否则您最好使用图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T21:41:27.807

看到你在尝试使用一种非常不常见的字体，为什么不实现 sIFR？

它也将（可能）解决您的一些行高问题。

[在这里阅读。](http://en.wikipedia.org/wiki/Scalable_Inman_Flash_Replacement)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T14:35:02.817

sIFR 是非标准字体的绝佳选择。

您将字体嵌入到 Flash 电影中（不用担心大部分工作已为您完成）并向您的页面添加一些代码，sIFR javascript 将用包含文本的 Flash 电影替换类/id/标签等/font 你的目标：

来自[http://www.mikeindustries.com/blog/sifr/](http://www.mikeindustries.com/blog/sifr/)

1.  一个普通的 (X)HTML 页面被加载到浏览器中。
2.  运行一个 javascript 函数，它首先检查是否安装了 Flash，然后查找您指定的任何标记、ID 或类。
3.  如果没有安装 Flash（或者显然关闭了 javascript），则 (X)HTML 页面会正常显示，并且不会再发生任何事情。如果安装了 Flash，javascript 会遍历您的页面源，测量您指定为“sIFRed”的每个元素。
4.  测量后，该脚本会创建相同尺寸的 Flash 电影并将它们覆盖在原始元素之上，将原始浏览器文本作为 Flash 变量注入。
5.  然后，每个 Flash 文件中的 Actionscript 以您选择的字体以 6 磅大小绘制该文本，并将其放大，直到它紧贴在 Flash 电影中。

非标准字体的优秀跨浏览器平台独立解决方案。

# ssl - 未经授权的用户可以捕获 ssl 数据包，重新发送并登录吗？

> ID：461853
> 
> 赞同：0
> 
> 时间：2009-01-20T15:49:39.467
> 
> 标签：ssl

这是场景：

我们让用户通过安全连接登录。未经授权的用户是否可以捕获从用户机器发送到服务器的数据包然后重新发送它们？这会允许他们登录吗？

这是一个在 Coldfusion 上运行的国产登录系统。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T15:54:33.357

简短的回答：不是普通的浏览器。

长答案：是的，如果用户不小心，并丢弃浏览器提供的与服务器名称/证书不匹配的警告。

[很好地解释](https://www.securetrust.com/resources/how-ssl-works)了 SSL 的工作原理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T01:06:35.937

不。

因为在这种情况下攻击者仍然需要与服务器协商他自己的 SSL 握手，他将无法逐字重放受害者的数据包。

# sql - 截断所有 MySql 表的 shell 脚本

> ID：461863
> 
> 赞同：3
> 
> 时间：2009-01-20T15:50:39.870
> 
> 标签：sql, mysql, bash, truncate

我正在寻找一个 Unix shell 脚本，它将截断模式中的所有表。已经提出了一个类似的问题，但我有一些额外的要求，这使得所提供的答案都不令人满意：

*   必须是 Unix shell 脚本（即没有 python、perl、PHP）
*   该脚本必须按照尊重外键约束的顺序截断表
*   我宁愿不必使用存储过程

在此先感谢，唐

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T15:54:48.270

像这样厚脸皮的东西怎么样：

```
mysqldump  --no-data mydb | mysql mydb 
```

获取模式的转储并将其重放到数据库中！

或者，查看[Maatkit中的](http://www.maatkit.org/tools.html)[mk-find](http://www.maatkit.org/doc/mk-find.html)，您应该能够执行以下操作：

```
mk-find -exec "truncate %s" 
```

mk-find 的说明：

> 这个工具是 UNIX 'find' 命令的 MySQL 对应工具。它接受测试（例如“查找所有大于 1GB 的表”）并执行操作，例如执行 SQL（“DROP TABLE %s”）。使用此工具，您可以自动执行许多繁琐的任务，例如测量表和索引的大小，保存数据以供历史趋势使用，删除旧的临时表等等。它在定期计划任务（例如 cron 作业）中特别有用。

# c# - 您如何在 .NET 中命名这些相关的属性、类、参数和字段？

> ID：461865
> 
> 赞同：13
> 
> 时间：2009-01-20T15:51:22.130
> 
> 标签：c#, .net

我经常发现我想在 C# 中编写类似这样的代码，但我对标识符名称感到不舒服：

```
public class Car
{
    private Engine engine;
    public Engine Engine
    {
        get
        {
            return engine;
        }
        set
        {
            engine = value;
        }
    }
    public Car(Engine engine)
    {
        this.engine = engine;
    }
} 
```

这里我们有四个不同的东西叫做“引擎”：

*   `Engine`班上。引擎似乎是一个不错的自然名称。
*   `Engine`公共财产。将其称为 MyEngine 或 TheCarsEngine 似乎很愚蠢。
*   `engine`支持该属性的私有字段。一些命名方案会推荐`m_engine`or `_engine`，但其他人说应该避免使用所有前缀。
*   `engine`构造函数上的参数名称。我见过建议在所有参数上加上下划线前缀的命名方案，例如`_engine`. 我真的不喜欢这个，因为调用者可以通过 Intellisense 看到该参数。

我不喜欢编写的代码的特别之处是：

*   如果您在构造函数中更改了参数名称，但在构造函数主体中没有使用它，您会得到一个编译器可能无法发现的细微错误。
*   Intellisense 有一个坏习惯，即自动为您完成错误的事情，有时您不会注意到它改变了大小写。如果构造函数主体意外结束，您将再次遇到一个微妙的错误`this.engine = Engine;`

似乎每个名字都适合单独使用，但它们在一起是不好的。有些东西必须让步，但是什么？我更喜欢更改私有字段，因为它对用户不可见，所以我通常会以 . 结尾`m_engine`，这可以解决一些问题，但会引入前缀并且不会阻止 Intellisense 更改`engine`为`Engine`.

您将如何重命名这四个项目？为什么？

（注意：我意识到这个例子中的属性可能是一个自动属性。我只是不想让这个例子过于复杂。）

另请参阅： [我是否不道德地使用仅按大小写与其类型不同的变量名？](https://stackoverflow.com/questions/461231/am-i-immoral-for-using-a-variable-name-that-differs-from-its-type-only-by-case)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-20T15:54:59.580

在这种情况下，我将完全按照示例中的方式命名它们。

这是因为命名清楚地表明每个元素保存和/或将用于什么数据。

对于 C#3，我唯一要更改的是使用自动属性来删除局部变量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T15:59:51.647

对于私人成员，我总是在前缀下划线：

```
private Engine engine; 
```

变成：

```
private Engine _engine; 
```

每当我看到`m_`它，它让我的胃翻腾。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T16:06:12.647

像这样：

```
public class Car
{    
    #region fields

    private Engine _engine;

    #endregion

    #region public properties

    public Engine Engine { get { return _engine; } set { _engine = value; } }  

    #endregion 

    #region constructors 

    public Car(Engine engine)    
    { 
        _engine = engine; 
    }

    #endregion
} 
```

遗憾的是，SO 代码样式表省略了我的空白行，这使它更清晰、更易于阅读。我们在所有生产代码中使用的区域指令有助于避免混淆。下划线前缀是我使用的唯一前缀（嗯，除了 I 在接口上，但每个人都这样做）但我确实使用它，所以我们从不混淆字段和本地人（如在构造函数中）。我认为属性名称和类型名称相同没有什么大问题（在 VS 中，突出显示会区分它们）。如果您尝试使用该类型的静态成员或方法，这只是一个问题，如果您这样做了，那么您将不得不给它起别名或显式引用它（即`MyNamespace.VehicleParts.Engine.StaticMethod()`）。

对我来说似乎可读，但这都是非常主观的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T15:56:17.817

*   成员：m_engine；
*   静态成员：sm_engine；
*   参数：发动机
*   局部变量：_engine
*   类别：引擎
*   属性：引擎

这使得以不同方式命名参数和局部变量成为可能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T15:57:28.767

我更喜欢为私有字段使用一些前缀（我使用'_'），否则它们看起来与参数和本地相同。除此之外，我使用与您在此处所做的类似的命名方法，尽管 Engine 可能有点通用，具体取决于程序的通用程度。

我认为我更喜欢 CarEngine 或 AutoEngine 或类似的东西，因为程序员喜欢使用 Engine 作为与现实引擎完全不对应的事物的隐喻。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T15:57:44.193

我通常在私有字段前加上下划线，所以我称它为 _engine。而且我经常使用非常短的（例如首字母）参数名称，所以这将是*Engine e*（毕竟，智能感知用户获取类型*和*名称）。我要么保持类和对象名称相同，要么（更通常）提出不同的名称，即使它是*MyEngine*或*carEngine*。

所以：
公共类车

```
{    
    #region fields

    private Engine _engine;

    #endregion

    #region public properties

    public Engine carEngine { get { return _engine; } set { _engine = value; } }  

    #endregion 

    #region constructors 

    public Car(Engine e)    
    { 
        _engine = e; 
    }

    #endregion
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T16:01:09.833

我不喜欢匈牙利符号:`m_foo`等。我使用的是骆驼风格: `engine, myEngine, myBigEngine`。

我会写得像你一样。

在 MSDN 中，我看到了一条评论：使用`public Car(Engine e)`- 我的意思是将输入参数命名为其他东西作为局部变量。但我不这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T16:08:25.937

可以离开它们，因为它们与一件小事无关。在智能感知中，项目是参数、本地成员还是私有成员并不是很明显，因为它们都具有相同的符号（蓝色立方体）。但是，如果您将光标移动到特定项目，则工具提示会告诉您它是哪一个。

作为视觉帮助，您可能希望在您的私有成员前加上下划线 _engine，以便无需移动光标即可立即看出它是私有成员。这是我使用的约定，也是我在您的示例中要更改的唯一名称。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-20T18:23:34.710

```
public class Car
{

    public Car(Engine engine)
    {
        Engine = engine;
    }

    public Engine Engine { get; set; }

} 
```

如果我有一个字段，我会在它前面加上下划线 (_)。所以私有Engine引擎；会变成私有引擎_engine；

# perl - 在 perl 中自动处理 excel 文件并避免对话框/UI 交互

> ID：461869
> 
> 赞同：5
> 
> 时间：2009-01-20T15:52:04.313
> 
> 标签：perl, excel, automation, dialog, ole

我如何保证通过 OLE 自动化 Microsoft Excel 时不会出现弹出对话框？我正在使用 Perl 模块（Win32::OLE）。我可以使用以下代码避免大多数对话框弹出：

```
use Win32::OLE;
use Win32::OLE::Variant;
use Win32::OLE::Const;

my $excel_symbols = Win32::OLE::Const->Load('Microsoft Excel');
my $excel = Win32::OLE->new('Excel.Application', sub { $_[0]->Quit();} );
$excel->{'Visible'} = 0;
$excel->{'DisplayAlerts'} = 0;
$excel->Workbooks->Open('c:\some_excel_file.xls',
  { 'UpdateLinks' => $excel_symbols->{'xlUpdateLinksNever'},
    'ReadOnly' => 1,
    'IgnoreReadOnlyRecommended' => 1
  }); 
```

但是对于某些文件，我会继续收到一个包含以下文本的对话框：

> 此文件不是可识别的格式。
> 
> *   如果您知道该文件来自另一个与 Microsoft Excel 不兼容的程序，请单击“取消”，然后在其原始应用程序中打开该文件。如果您想稍后在 Microsoft Excel 中打开该文件，请将其保存为兼容的格式，例如文本格式。
> *   如果您怀疑文件已损坏，请单击帮助以获取有关解决问题的详细信息。
> *   如果您仍想查看文件中包含的文本，请单击“确定”。然后在文本导入向导中单击完成。
> 
> 确定 取消

有时会出现一个类似的对话框，其中包含“确定”、“取消”和“帮助”按钮。

我无法控制提供给脚本的文件的质量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T16:39:57.633

您可以考虑使用[Spreadsheet::ParseExcel](http://search.cpan.org/dist/Spreadsheet-ParseExcel/lib/Spreadsheet/ParseExcel.pm)（尽管它可能缺少您需要的功能）或[Apache POI](http://poi.apache.org/)（尽管它需要一些包装才能在 Perl 脚本中使用）而不是通过 OLE 调用 Excel 引擎。这样您就不会得到任何 Excel 生成的对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-07T16:07:26.980

我重新审视了这个问题并找到了解决方案。

在处理之前将文件复制到临时位置。然后在 Excel 中关闭之前保存文件：

```
File::Copy::copy('c:\some_excel_file.xls', 'c:\temp\SFO3jfd.xls');
my $book = $excel->Workbooks->Open('c:\temp\SFO3jfd.xls',
  { 'UpdateLinks' => $excel_symbols->{'xlUpdateLinksNever'},
    'ReadOnly' => 1,
    'IgnoreReadOnlyRecommended' => 1
  });
$book->Save();
$book->Close(); 
```

**为什么这样有效：**

Excel 2003 会自动重新计算在旧版 Excel 中创建的文档中的公式。此外，可以在打开文档时调用宏。所有这些都意味着可能会对文档进行更改，即使您的脚本没有执行任何此类操作。

通过在关闭之前保存文档，您可以避免出现要求您保存文件的对话框。使用临时文件可确保在验证操作期间不会更改原始文件。如果您不关心这一点，您可以考虑就地验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T17:58:13.357

[这](http://msdn.microsoft.com/en-us/library/aa195811(office.11).aspx)是 Open 方法的完整文档。我想知道 CorruptLoad 参数是否是您所需要的。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-03-26T15:01:15.733

如果您尝试处理树中的所有 xl 文件，其中一些可能已被其他用户打开并带有 ~ 前缀。

# c++ - 在 QListView 中选择索引

> ID：461870
> 
> 赞同：9
> 
> 时间：2009-01-20T15:53:10.270
> 
> 标签：c++, user-interface, qt

这可能是一个愚蠢的问题，但我一生都无法弄清楚如何在 QListView 中选择给定索引的行。

QAbstractItemView ，QListView 的父级有一个 setCurrentIndex(const QModelIndex &index)。问题是，我不能用我想要的行号构造一个 QModelIndex，因为 QModelIndex 的行和列字段没有修改器。

同样继承自QAbstractItemView的QTableView有一个selectRow(int row)函数，为什么七大地狱里的QListView没有这个？

好的 ol' windows 窗体在其列表视图上具有 SelectedIndex 属性。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-30T20:28:20.603

[这](http://doc.trolltech.com/4.4/model-view-selection.html)应该可以帮助您入门

```
QModelIndex index = model->createIndex( row, column );
if ( index.isValid() )
    model->selectionModel()->select( index, QItemSelectionModel::Select ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-20T16:18:46.633

您可以使用您提供给视图的模型的 createIndex(int row, int column) 函数来构造 QModelIndex。QModelIndexes 只能使用一次，并且必须由模型中的工厂创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-22T12:51:16.693

我基于 Michael Bishop 在 Qt4.8.0 (MSVC2010 Compiller) 上的工作示例

```
QStandardItemModel *Model = (QStandardItemModel *)this->ui->listView_OptionsCategories->model();
QModelIndex index = Model->index(this->ui->stackedWidget->currentIndex(), 0);
if ( index.isValid() )
    this->ui->listView_OptionsCategories->selectionModel()->select( index, QItemSelectionModel::Select ); 
```

# mysql - 在列中查找具有非 ascii 值的行

> ID：461871
> 
> 赞同：2
> 
> 时间：2009-01-20T15:53:39.960
> 
> 标签：mysql

如何评估一列是否包含 mysql 中的任何非 ascii 字符？在这种情况下，字符集实际上是 latin1，所以我只是在寻找高字节字符。

我试过这个：

```
select * from company where ticker regexp concat('[', x'7f', '-', x'ff', ']') 
```

但这会返回此错误：

错误 1139 (42000)：从正则表达式中得到错误“无效字符范围”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-20T16:39:13.173

必须有一种更简单的方法来做到这一点，但我认为所有典型的逃脱都行不通。所以这是一个丑陋的解决方案：

```
select * from company 
where ticker regexp(concat('[',char(128),'-',char(255),']')); 
```

# java - Java EE 身份验证错误处理

> ID：461886
> 
> 赞同：2
> 
> 时间：2009-01-20T15:57:23.150
> 
> 标签：java, security, authentication, jakarta-ee

我们目前正在尝试在 Websphere 6.1 Web 容器内实现一个 Web 应用程序，该应用程序使用 Java EE 身份验证机制和基于 FORM 的登录。如果身份验证成功，则一切正常；正在检索 LDAP 成员组，正在执行组到角色的映射，并且正在将角色返回给 Web 应用程序并由 Web 应用程序正确解释。

如果认证不成功，则返回 form-login-error 页面。然而，这是一个静态页面，只是简单地说“出现错误”之类的内容。我们如何捕获阻止成功登录的特定错误（用户名/密码不正确、LDAP 存储库不可用、帐户锁定、密码过期等）？似乎应该有一些简单的方法来做到这一点，因为您希望以不同于其他方式处理某些“安全”异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T14:52:31.800

我使用 Struts，所以它会为你做转发。如果您没有框架（为什么没有？），您将不得不手动完成。

Java EE 规范涵盖了 j_security_check servlet。

登录页面将 j_username 和 j_password 发布到 j_security_check servlet。您的应用程序将被配置为错误到未经授权的页面（请参阅 web.xml），但会（最初）调用 servlet。401 或 403 将转到禁止页面（同样是 web.xml）

在那个 servlet（它扩展了 HttpServlet）里面——你会检查所有的好东西。

```
public final void doGet(javax.servlet.http.HttpServletRequest request,
    javax.servlet.http.HttpServletResponse response)
    throws javax.servlet.ServletException, java.io.IOException
{
    // initialize the app
    AppInit initializer = new AppInit();

    // get the logger
    log = new Log4jWrapper(this.getClass());

    // initialize the application session
    HttpSession sess = request.getSession(true);
    sess.setAttribute(CommonConstants.SESSION_CURR_USER_ID, request.getRemoteUser());

    // initialize the JSP to forward to based on the user role
    String fwdJSP = "SetupMainPage.jsp";
    if (request.isUserInRole(CommonConstants.ROLE_MANAGER)) {
        log.debug("User is a Manager");
    }
    //else other role checks - (these are users in groups in the LDAP)
    // initialize the application session and set a variable to indicate that
    // we are coming from a first time login (not a timeout login)
    sess.setAttribute(CommonConstants.SESSION_COMING_FROM_INITIAL_LOGIN,"TRUE");
    disp = getServletContext().getRequestDispatcher("SetupMainPage.jsp");
    disp.forward(request, response);
}
//else failure 
```

未知用户

> [11/22/08 8:54:47:993 EST] 7f6ac69c FormLoginServ E SECJ0118E: 用户 s 身份验证期间的身份验证错误

正确的用户 - 错误的密码，但 request.getRemoteUser() 将有一个值

> [11/22/08 8:56:45:082 EST] 7f51469c FormLoginServ E SECJ0118E: 用户 jbsymolo 身份验证期间的身份验证错误

不幸的是 - 我没有任何人被锁定的例子，但我假设您将在主安全目录 (LDAP) 中有一个用户条目。

这是别人的（所以我不能相信）

> 我认为这个[页面](http://publib.boulder.ibm.com/...es/ae/tsec_pacs.html)描述了如何做你想做的事。
> 
> 特别是如何从任意底层身份验证源检索身份验证异常（看起来像 Websphere 将它们称为用户注册表）。
> 
> Throwable t = com.ibm.websphere.security.auth.WSSubject.getRootLoginException();
> if (t != null)
> t = determineCause(t);
> 
> 其中确定原因（）是在同一页面上定义的。这样，即使您的服务器配置为针对 John Deer 拖拉机进行身份验证，您也可以访问“OutOfGasLoginException”（如果有的话）。上面的代码可以进入容器重定向到的 Servlet、Servlet 过滤器或 JSP（如上面 jsymolon 所述）。它只是检查异常，然后在结果页面上放置相应的友好错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T21:51:41.983

这是古老的知识-我相信用tomcat做过这样的事情。据我所知，没有标准方法，因为实现与请求和前端 Web 内容完全解耦，因此很难在身份验证组件和前端之间建立任何通信方式（例如错误页面）。

我们最终得到了一种特定于 tomcat 的方式，严重依赖于当前的实现。我不再在那家公司工作，所以我无法说出代码的当前状态或我们当时选择的解决方案。我相信您还必须有一些特定于 Websphere 的解决方案 - 无论是使用线程局部变量、使用尝试登录的用户名键入消息、以某种方式获取会话标识符或类似的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T21:50:07.350

查看这篇文章[使用 Servlet 过滤器保护 J2EE 应用程序](http://www.developer.com/java/ent/article.php/3467801)。我相信它涵盖了您能够通过身份验证错误原因的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-26T14:55:21.250

JavaEE 规范没有提供像错误代码这样的标准方法来获得认证反馈。

根据以下[关于 z/OS 安全集成](http://www.redbooks.ibm.com/abstracts/redp4161.html)的 IBM Redpaper 第 57 页的灰色注释： IBM 特定扩展可用，因此错误页面 JSP 可以根据错误状态代码报告特定消息（如密码过期）。

根据[WebSphere InfoCenter](http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/index.jsp?topic=/com.ibm.websphere.express.doc/info/exp/ae/xsec_formlogin.html)，您的 WebSphere 安装中*TechSamp*包中的*FormLoginWeb*示例（[该文件中详细](http://vervient.com/tech/writing/security_websphere.html)说明的登录后操作。*`samples/src/TechSamp/FormLoginWeb``LoginFilter``/j_security_check`*

 *通过这种机制，可以从 JAAS Subject 获取登录异常，并在 HttpSession 中设置登录错误代码，以便错误页面可以生成特定消息。

# c# - 在没有 Outlook 的情况下发送 Outlook 会议请求？

> ID：461889
> 
> 赞同：39
> 
> 时间：2009-01-20T15:57:37.300
> 
> 标签：c#, .net, outlook

我只是想知道是否可以在没有在服务器上安装 Outlook 并使用 COM Interop 的情况下向人们发送会议请求（我想不惜一切代价在服务器上避免这种情况）。

我们在 Windows 2003 域中有 Exchange 2003，所有用户都是域用户。我想我可以发送'round iCal/vCal 或其他东西，但我想知道是否有适当的标准方法可以在没有 Outlook 的情况下通过 Exchange 发送会议请求？

如果重要的话，这是 C#/.net。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-20T16:45:17.407

向 Outlook 发送会议请求（并使其被识别）的方式如下：

*   准备一个 iCalendar 文件，请务必设置这些附加属性，因为 Outlook 需要它们：
    *   [`UID`](http://www.kanzaki.com/docs/ical/uid.html)
    *   [`SEQUENCE`](http://www.kanzaki.com/docs/ical/sequence.html)
    *   [`CREATED`](http://www.kanzaki.com/docs/ical/created.html)
    *   [`LAST-MODIFIED`](http://www.kanzaki.com/docs/ical/lastModified.html)
    *   [`DTSTAMP`](http://www.kanzaki.com/docs/ical/dtstamp.html)
*   准备`multipart/alternative`一封邮件：
    *   第 1 部分：（`text/html`或您喜欢的任何内容）- 这显示给“普通”邮件阅读器或作为后备，并包含人类可读形式的事件摘要
    *   第 2 部分：`text/calendar; method=REQUEST`，保存 ics 文件的内容（header`method`参数必须与 ics 中的方法匹配）。注意正确的文本编码，声明`charset`标题参数不会有任何伤害。
    *   第 3 部分：可选地，附加 .ics 文件本身，这样普通邮件阅读器就可以为用户提供一些可以点击的东西。Outlook 并不真正需要附件，因为它只是读取该`text/calendar`部分。
*   将邮件发送给 Outlook 用户。如果一切正确，邮件将显示为会议请求，并带有出席按钮，并在接受后自动进入用户日历。
*   设置处理响应的东西（它们转到会议组织者）。我还不能让自动与会者跟踪与 Exchange 邮箱一起使用，因为该活动将不存在于组织者日历中。Outlook 需要 UID 和 SEQUENCES 来匹配它的期望，但是使用你自己制作的 UID，这几乎不会奏效。

有关 ics 文件格式的详细信息和特性的帮助，请务必访问[Masahide Kanzaki 的 iCalendar 规范摘录](http://www.kanzaki.com/docs/ical/)。[它们是黑暗中的一盏明灯，比通过RFC 2445](https://www.rfc-editor.org/rfc/rfc2445)啃你的方式要好得多。但话又说回来，也许 .NET 有一个方便的库。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-17T18:59:42.473

请参阅 sourceforge 上的 DDay.iCal C# 库：http:
[//sourceforge.net/projects/dday-ical/](http://sourceforge.net/projects/dday-ical/)

然后阅读此代码项目文章： http:
[//www.codeproject.com/Articles/17980/Adding-iCalendar-Support-to-Your-Program-Part-1](http://www.codeproject.com/Articles/17980/Adding-iCalendar-Support-to-Your-Program-Part-1)

并阅读：
[Export event with C# to iCalendar and vCalendar format](https://stackoverflow.com/questions/5461681/export-event-with-c-sharp-to-icalendar-and-vcalendar-format)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-08-18T23:34:22.330

iCalendar 是一个很棒的通用解决方案，而 DDay.iCal 库是从 .NET 执行此操作的好方法，但我相信[Exchange Web Services](http://msdn.microsoft.com/en-us/library/office/dd877045%28v=exchg.140%29.aspx) (EWS) 在原始问题的上下文中是一个更好的解决方案（Exchange、C# /。网）。

如果您使用的是 .NET 语言（例如 C#），则应使用[EWS 托管 API](http://msdn.microsoft.com/en-us/library/office/dd633696%28v=exchg.80%29.aspx)包装器，它极大地简化了 EWS 的使用。

在[docs](http://msdn.microsoft.com/en-us/library/office/dd633661%28v=exchg.80%29.aspx)中，以下是如何使用 EWS 托管 API 创建会议并将请求发送给受邀者：

```
// Create the appointment.
Appointment appointment = new Appointment(service);

// Set properties on the appointment. Add two required attendees and one optional attendee.
appointment.Subject = "Status Meeting";
appointment.Body = "The purpose of this meeting is to discuss status.";
appointment.Start = new DateTime(2009, 3, 1, 9, 0, 0);
appointment.End = appointment.Start.AddHours(2);
appointment.Location = "Conf Room";
appointment.RequiredAttendees.Add("user1@contoso.com");
appointment.RequiredAttendees.Add("user2@contoso.com");
appointment.OptionalAttendees.Add("user3@contoso.com");

// Send the meeting request to all attendees and save a copy in the Sent Items folder.
appointment.Save(SendInvitationsMode.SendToAllAndSaveCopy); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-04-24T01:57:06.673

下面的代码将以 Outlook 呈现接受/拒绝按钮的方式发送会议请求。

请注意，每个会议的 UID 必须是唯一的，我使用了 GUID。

另请注意，您需要替换 CREATED、DTSTART、DTEND、DTSTAMP、LAST-MODIFIED。这些是 UTC 日期/时间。

```
 var m = new MailMessage();

    m.Subject = "Meeting";

    m.Body = "";

    string iCal = 
@"BEGIN:VCALENDAR
PRODID:-//Microsoft Corporation//Outlook 14.0 MIMEDIR//EN
VERSION:2.0
METHOD:PUBLISH
X-MS-OLK-FORCEINSPECTOROPEN:TRUE
BEGIN:VEVENT
CLASS:PUBLIC
CREATED:20140423T045933Z
DESCRIPTION:desc
DTEND:20140430T080000Z
DTSTAMP:20140423T045933Z
DTSTART:20140430T060000Z
LAST-MODIFIED:20140423T045933Z
LOCATION:location...
PRIORITY:5
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Summary...
TRANSP:OPAQUE
UID:D8BFD357-88A7-455C-86BC-C2CECA9AC5C6
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
X-MICROSOFT-CDO-IMPORTANCE:1
X-MICROSOFT-DISALLOW-COUNTER:FALSE
X-MS-OLK-AUTOFILLLOCATION:FALSE
X-MS-OLK-CONFTYPE:0
BEGIN:VALARM
TRIGGER:-PT60M
ACTION:DISPLAY
DESCRIPTION:Reminder
END:VALARM
END:VEVENT
END:VCALENDAR";

    using (var iCalView = AlternateView.CreateAlternateViewFromString(iCal, new System.Net.Mime.ContentType("text/calendar")))
    {
        m.AlternateViews.Add(iCalView);

        var c = new SmtpClient();

        // Send message
        c.Send(m);
    } 
```

这假设您在配置文件中配置了本地 SMTP 服务器：

```
 <system.net>
    <mailSettings>
      <smtp deliveryMethod="Network" from="no-reply@example.com">
        <network defaultCredentials="true" host="smtp.example.local" />
      </smtp>
    </mailSettings>
  </system.net> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-10-04T16:34:20.233

[您可以使用iCal 标准 (RFC 5545)](https://www.rfc-editor.org/rfc/rfc5545)通过邮件将会议请求发送到 Outlook

您不能以这种方式发送待办事项。您可以发送“约会”，但这些在 Outlook 中显示为 .ics 附件，必须“盲目”接受。

会议请求以漂亮的预览出现在 Outlook 中，可以接受或拒绝。发送程序可以在发送后修改或取消会议。

[使用DDay.iCal .Net 库](http://sourceforge.net/projects/dday-ical/)可以轻松创建有效的 iCal 项目

下面的代码是一个完整的工作示例。它使用有效的 iCal 会议请求构建字符串并通过邮件发送。

该代码使用以下内容创建邮件：

*   简单邮件客户端的纯文本正文
*   用于在现代邮件客户端中显示的 HTML 正文
*   iCal 会议请求为 AlternateView（将显示在 Outlook 中）
*   iCal 会议请求作为附件（可用于 Outlook 以外的邮件客户端）

代码显示了如何添加：

*   描述文本为 HTML，在 Outlook 中看起来更好
*   优先级、可见性（公共/私人/机密）
*   可选组织者（将显示在 Outlook 中而不是邮件发件人中）
*   可选的与会者
*   可选报警
*   会议的可选附件。将显示在 Outlook 的日历中

一些重要的细节：

*   邮件发件人（或可选的组织者）和邮件收件人必须不同才能在 Outlook 中使用
*   .ics 中的 METHOD 和 Mime.ContentType 中的 METHOD 必须匹配
*   会议必须在未来进行，以使这项工作在前景中发挥作用
*   .ics 部分必须是 MIME 邮件中的最后一个 alternateView 部分

[[MS-OXCICAL]：iCalendar to Appointment Object Conversion Algorithm](http://msdn.microsoft.com/en-us/library/cc463911%28v=exchg.80%29.aspx)中详细介绍了 Outlook 解释 .ics 文件的方式的确切细节

我们将使用这些程序集：

```
using System;
using System.IO;
using System.Net.Mail;
using DDay.iCal;
using DDay.iCal.Serialization.iCalendar; 
```

对于 DDay.iCal 来说，下载[DDay.iCal 二进制文件](http://sourceforge.net/projects/dday-ical/files/)就足够了。如果您想添加一些功能，最好查看 DDay.iCal 源代码，因为文档已过时，并且源代码包含相当完整的测试，可以执行其所有功能。

```
const string filepath = @"C:\temp\ical.test.ics";
// use PUBLISH for appointments
// use REQUEST for meeting requests
const string METHOD = "REQUEST";

// Properties of the meeting request
// keep guid in sending program to modify or cancel the request later
Guid uid = Guid.Parse("2B127C67-73B3-43C5-A804-5666C2CA23C9");
string VisBetreff = "This is the subject of the meeting request";
string TerminVerantwortlicherEmail = "mr.asker@myorg.com";
string bodyPlainText = "This is the simple iCal plain text msg";
string bodyHtml = "This is the simple <b>iCal HTML message</b>";
string location = "Meeting room 101";
// 1: High
// 5: Normal
// 9: low
int priority = 1;
//=====================================
MailMessage message = new MailMessage();

message.From = new MailAddress("sender@myorg.com");
message.To.Add(new MailAddress(TerminVerantwortlicherEmail));
message.Subject = "[VIS-Termin] " + VisBetreff;

// Plain Text Version
message.Body = bodyPlainText;

// HTML Version
string htmlBody = bodyHtml;
AlternateView HTMLV = AlternateView.CreateAlternateViewFromString(htmlBody,
  new System.Net.Mime.ContentType("text/html"));

// iCal
IICalendar iCal = new iCalendar();
iCal.Method = METHOD;
iCal.ProductID = "My Metting Product";            

// Create an event and attach it to the iCalendar.
Event evt = iCal.Create<Event>();
evt.UID = uid.ToString();

evt.Class = "PUBLIC";
// Needed by Outlook
evt.Created = new iCalDateTime(DateTime.Now);

evt.DTStamp = new iCalDateTime(DateTime.Now);
evt.Transparency = TransparencyType.Transparent;

// Set the event start / end times
evt.Start = new iCalDateTime(2014, 10, 3, 8, 0, 0); 
evt.End = new iCalDateTime(2014, 10, 3, 8, 15, 0); 
evt.Location = location;

//var organizer = new Organizer("the.organizer@myCompany.com");
//evt.Organizer = organizer;

// Set the longer description of the event, plain text
evt.Description = bodyPlainText;

// Event description HTML text
// X-ALT-DESC;FMTTYPE=text/html
var prop = new CalendarProperty("X-ALT-DESC");
prop.AddParameter("FMTTYPE", "text/html");
prop.AddValue(bodyHtml);
evt.AddProperty(prop);

// Set the one-line summary of the event
evt.Summary = VisBetreff;
evt.Priority = priority;

//--- attendes are optional
IAttendee at = new Attendee("mailto:Peter.Black@MyOrg.com");
at.ParticipationStatus = "NEEDS-ACTION";
at.RSVP = true;
at.Role = "REQ-PARTICIPANT";
evt.Attendees.Add(at);

// Let’s also add an alarm on this event so we can be reminded of it later.
Alarm alarm = new Alarm();

// Display the alarm somewhere on the screen.
alarm.Action = AlarmAction.Display;

// This is the text that will be displayed for the alarm.
alarm.Summary = "Upcoming meeting: " + VisBetreff;

// The alarm is set to occur 30 minutes before the event
alarm.Trigger = new Trigger(TimeSpan.FromMinutes(-30));

//--- Attachments
string filename = "Test.docx";

// Add an attachment to this event
IAttachment attachment = new DDay.iCal.Attachment();
attachment.Data = ReadBinary(@"C:\temp\Test.docx");
attachment.Parameters.Add("X-FILENAME", filename);
evt.Attachments.Add(attachment);

iCalendarSerializer serializer = new iCalendarSerializer();
serializer.Serialize(iCal, filepath);

// the .ics File as a string
string iCalStr = serializer.SerializeToString(iCal);

// .ics as AlternateView (used by Outlook)
// text/calendar part: method=REQUEST
System.Net.Mime.ContentType calendarType = 
  new System.Net.Mime.ContentType("text/calendar");
calendarType.Parameters.Add("method", METHOD);
AlternateView ICSview =
  AlternateView.CreateAlternateViewFromString(iCalStr, calendarType);

// Compose
message.AlternateViews.Add(HTMLV);
message.AlternateViews.Add(ICSview); // must be the last part

// .ics as Attachment (used by mail clients other than Outlook)
Byte[] bytes = System.Text.Encoding.ASCII.GetBytes(iCalStr);
var ms = new System.IO.MemoryStream(bytes);
var a = new System.Net.Mail.Attachment(ms,
  "VIS-Termin.ics", "text/calendar");
message.Attachments.Add(a);     

// Send Mail
SmtpClient client = new SmtpClient();
client.Send(message); 
```

这里是 ReadBinary() 函数：

```
private static byte[] ReadBinary(string fileName)
{
    byte[] binaryData = null;
    using (FileStream reader = new FileStream(fileName,
      FileMode.Open, FileAccess.Read))
    {
        binaryData = new byte[reader.Length];
        reader.Read(binaryData, 0, (int)reader.Length);
    }
    return binaryData;
} 
```

在配置文件中配置 SmtpClient 最简单，如下所示：

```
<configuration>
  ...
  <system.net>  
    <mailSettings>
      <smtp>
        <network host="mysmtp.server.com" port="25" userName="mySmtpUserName" password="myPassword" />
      </smtp>
    </mailSettings>
  </system.net>
  ... 
```

# c# - 创建 n 个几乎未知类型的新实例

> ID：461893
> 
> 赞同：1
> 
> 时间：2009-01-20T15:58:14.473
> 
> 标签：c#, generics, oop

我想编写一个通用*方法*来创建指定类型的新实例。我试过

```
protected T CreateNew<T>()
    where T : new()
{
    return new T();
} 
```

这有效，但前提是我在编译时指定了类型，就像

```
var x = CreateNew<Point>(); 
```

关键是，我需要做这样的事情

```
ISomeInterface inter;
if (selection == 1)
    inter = new SomeClass();
else
    inter = new SomeClass2();
// ...
ISomeInterface inter2 = CreateNew<typeof(inter)>(); 
```

SomeClass 实现了 ISomeInterface。但这无法编译，因为 CreateNew() 需要指定一个实际类型。我不知道是否可以在运行时提供类似的东西，但是上面的代码无法编译。

所以我有一个未知引用类型的实例，我需要创建几个相同类型的实例。

有谁知道实现这种行为的技术？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-20T16:00:32.317

泛型的重点是提供一种机制，当在*编译*时类型已知时，代码可以重用于不同的类型。在这种情况下，您在编译时不知道类型。

我建议你使用`Activator.CreateInstance(inter.GetType());`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T16:06:15.113

您可以使用 lambda 来做到这一点：

```
Function<ISomeInterface> creationDelegate;
if (selection == 1)
    creationDelegate = () => CreateNew<SomeClass>;
else
    creationDelegate = () => CreateNew<SomeClass2>;
ISomeInterface inter = creationDelegate();

// ...
ISomeInterface inter2 = creationDelegate(); 
```

根据您的示例代码，我看不到在这种情况下使用 CreateNew 方法的好处，但我假设您的“真实”代码更复杂。

# java - What is the most frequent concurrency issue you've encountered in Java?

> ID：461896
> 
> 赞同：193
> 
> 时间：2009-01-20T15:58:38.763
> 
> 标签：java, multithreading, concurrency

This is a poll of sorts about common concurrency problems in Java. An example might be the classic deadlock or race condition or perhaps EDT threading bugs in Swing. I'm interested both in a breadth of possible issues but also in what issues are most common. So, please leave one specific answer of a Java concurrency bug per comment and vote up if you see one you've encountered.

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2009-01-20T22:44:37.913

My **#1 most painful** concurrency problem ever occurred when **two different** open source libraries did something like this:

```
private static final String LOCK = "LOCK";  // use matching strings 
                                            // in two different libraries

public doSomestuff() {
   synchronized(LOCK) {
       this.work();
   }
} 
```

At first glance, this looks like a pretty trivial synchronization example. However; because Strings are **interned** in Java, the literal string `"LOCK"` turns out to be the same instance of `java.lang.String` (even though they are declared completely disparately from each other.) The result is obviously bad.

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2009-01-20T19:09:41.543

The most common concurrency problem I've seen, is not realizing that a field written by one thread is *not guaranteed* to be seen by a different thread. A common application of this:

```
class MyThread extends Thread {
  private boolean stop = false;

  public void run() {
    while(!stop) {
      doSomeWork();
    }
  }

  public void setStop() {
    this.stop = true;
  }
} 
```

As long as stop is not *volatile* or `setStop` and `run` are not *synchronized* this is not guaranteed to work. This mistake is especially devilish as in 99.999% it won't matter in practice as the reader thread will eventually see the change - but we don't know how soon he saw it.

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2009-01-20T16:02:25.853

One classic problem is changing the object you're synchronizing on while synchronizing on it:

```
synchronized(foo) {
  foo = ...
} 
```

Other concurrent threads are then synchronizing on a different object and this block does not provide the mutual exclusion you expect.

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2009-01-20T16:17:36.680

A common problem is using classes like Calendar and SimpleDateFormat from multiple threads (often by caching them in a static variable) without synchronization. These classes are not thread-safe so multi-threaded access will ultimately cause strange problems with inconsistent state.

* * *

## 回答 #5

> 赞同：48
> 
> 时间：2009-01-20T16:16:43.093

Not properly **synchronizing** on objects returned by `Collections.synchronizedXXX()`, especially during iteration or multiple operations:

```
Map<String, String> map = Collections.synchronizedMap(new HashMap<String, String>());

...

if(!map.containsKey("foo"))
    map.put("foo", "bar"); 
```

That's **wrong**. Despite single operations being `synchronized`, state of map between invoking `contains` and `put` can be changed by another thread. It should be:

```
synchronized(map) {
    if(!map.containsKey("foo"))
        map.put("foo", "bar");
} 
```

Or with a `ConcurrentMap` implementation:

```
map.putIfAbsent("foo", "bar"); 
```

* * *

## 回答 #6

> 赞同：47
> 
> 时间：2009-01-20T17:06:52.057

Double-Checked Locking. By and large.

The paradigm, which I started learning the problems of when I was working at BEA, is that people will check a singleton in the following way:

```
public Class MySingleton {
  private static MySingleton s_instance;
  public static MySingleton getInstance() {
    if(s_instance == null) {
      synchronized(MySingleton.class) { s_instance = new MySingleton(); }
    }
    return s_instance;
  }
} 
```

This never works, because another thread might have gotten into the synchronized block and s_instance is no longer null. So the natural change is then to make it:

```
 public static MySingleton getInstance() {
    if(s_instance == null) {
      synchronized(MySingleton.class) {
        if(s_instance == null) s_instance = new MySingleton();
      }
    }
    return s_instance;
  } 
```

That doesn't work either, because the Java Memory Model doesn't support it. You need to declare s_instance as volatile to make it work, and even then it only works on Java 5.

People that aren't familiar with the intricacies of the Java Memory Model mess this up *all the time*.

* * *

## 回答 #7

> 赞同：37
> 
> 时间：2009-01-20T16:14:23.723

Though probably not exactly what you are asking for, the most frequent concurrency-related problem I've encountered (probably because it comes up in normal single-threaded code) is a

`java.util.ConcurrentModificationException`

caused by things like:

```
List<String> list = new ArrayList<String>(Arrays.asList("a", "b", "c"));
for (String string : list) { list.remove(string); } 
```

* * *

## 回答 #8

> 赞同：30
> 
> 时间：2009-01-21T17:57:25.997

It can be easy to think synchronized collections grant you more protection than they actually do, and forget to hold the lock between calls. I have seen this mistake a few times:

```
 List<String> l = Collections.synchronizedList(new ArrayList<String>());
 String[] s = l.toArray(new String[l.size()]); 
```

For example, in the second line above, the `toArray()` and `size()` methods are both thread safe in their own right, but the `size()` is evaluated separately from the `toArray()`, and the lock on the List is not held between these two calls.

If you run this code with another thread **concurrently** removing items from the list, sooner or later you will end up with a new `String[]` returned which is larger than required to hold all the elements in the list, and has null values in the tail. It is easy to think that because the two method calls to the List occur in a single line of code this is somehow an atomic operation, but it is not.

* * *

## 回答 #9

> 赞同：29
> 
> 时间：2009-01-20T17:01:15.517

The most common bug we see where I work is programmers perform long operations, like server calls, on the EDT, locking up the GUI for a few seconds and making the app unresponsive.

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2009-01-20T16:25:55.713

Forgetting to wait() (or Condition.await()) in a loop, checking that the waiting condition is actually true. Without this, you run into bugs from spurious wait() wakeups. Canonical usage should be:

```
 synchronized (obj) {
     while (<condition does not hold>) {
         obj.wait();
     }
     // do stuff based on condition being true
 } 
```

* * *

## 回答 #11

> 赞同：26
> 
> 时间：2009-01-20T17:06:30.250

Another common bug is poor exception handling. When a background thread throws an exception, if you don't handle it properly, you might not see the stack trace at all. Or perhaps your background task stops running and never starts again because you failed to handle the exception.

* * *

## 回答 #12

> 赞同：22
> 
> 时间：2009-01-25T14:07:13.780

Until I took a class with Brian Goetz I didn't realize that the non-synchronized `getter` of a private field mutated through a synchronized `setter` is *never* guaranteed to return the updated value. Only when a variable is protected by synchronized block on **both reads AND writes** will you get the guarantee of the latest value of the variable.

```
public class SomeClass{
    private Integer thing = 1;

    public synchronized void setThing(Integer thing)
        this.thing = thing;
    }

    /**
     * This may return 1 forever and ever no matter what is set
     * because the read is not synched
     */
    public Integer getThing(){
        return thing;  
    }
} 
```

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2009-01-20T16:45:15.987

Thinking you are writing single-threaded code, but using mutable statics (including singletons). Obviously they will be shared between threads. This happens surprisingly often.

* * *

## 回答 #14

> 赞同：15
> 
> 时间：2009-01-20T19:12:25.407

**Arbitrary method calls should not be made from within synchronized blocks.**

Dave Ray touched on this in his first answer, and in fact I also encountered a deadlock also having to do with invoking methods on listeners from within a synchronized method. I think the more general lesson is that method calls should not be made "into the wild" from within a synchronized block - you have no idea if the call will be long-running, result in deadlock, or whatever.

In this case, and usually in general, the solution was to reduce the scope of the synchronized block to just protect a critical *private* section of code.

Also, since we were now accessing the Collection of listeners outside of a synchronized block, we changed it to be a copy-on-write Collection. Or we could have simply made a defensive copy of the Collection. The point being, there are usually alternatives to safely access a Collection of unknown objects.

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2009-01-22T05:25:47.103

The most recent Concurrency-related bug I ran into was an object that in its constructor created an ExecutorService, but when the object was no longer referenced, it had never shutdown the ExecutorService. Thus, over a period of weeks, *thousands* of threads leaked, eventually causing the system to crash. (Technically, it didn't crash, but it did stop functioning properly, while continuing to run.)

Technically, I suppose this isn't a concurrency problem, but it's a problem relating to use of the java.util.concurrency libraries.

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2009-01-20T16:07:50.460

Unbalanced synchronization, particularly against Maps seems to be a fairly common problem. Many people believe that synchronizing on puts to a Map (not a ConcurrentMap, but say a HashMap) and not synchronizing on gets is sufficient. This however can lead to an infinite loop during re-hash.

The same problem (partial synchronization) can occur anywhere you have shared state with reads and writes however.

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2009-01-20T17:27:25.260

I encountered a concurrency problem with Servlets, when there are mutable fields which will be setted by each request. But there is only one servlet-instance for all request, so this worked perfectly in a single user environment but when more than one user requested the servlet unpredictable results occured.

```
public class MyServlet implements Servlet{
    private Object something;

    public void service(ServletRequest request, ServletResponse response)
        throws ServletException, IOException{
        this.something = request.getAttribute("something");
        doSomething();
    }

    private void doSomething(){
        this.something ...
    }
} 
```

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2009-01-21T11:22:43.453

Not exactly a bug but, the worst sin is providing a library you intend other people to use, but not stating which classes/methods are thread-safe and which ones must only be called from a single thread etc.

More people should make use of the concurrency annotations (e.g. @ThreadSafe, @GuardedBy etc) described in Goetz's book.

* * *

## 回答 #19

> 赞同：9
> 
> 时间：2009-01-20T16:04:56.783

My biggest problem has always been deadlocks, especially caused by listeners that are fired with a lock held. In these cases, it's really easy to get inverted locking between two threads. In my case, between a simulation running in one thread and a visualization of the simulation running in the UI thread.

EDIT: Moved second part to separate answer.

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2009-01-29T02:23:48.707

Starting a thread **within the constructor** of a class is problematic. If the class is extended, the thread can be started **before subclass' constructor** is executed.

* * *

## 回答 #21

> 赞同：8
> 
> 时间：2009-01-20T18:05:26.963

Mutable classes in shared data structures

```
Thread1:
    Person p = new Person("John");
    sharedMap.put("Key", p);
    assert(p.getName().equals("John");  // sometimes passes, sometimes fails

Thread2:
    Person p = sharedMap.get("Key");
    p.setName("Alfonso"); 
```

When this happens, the code is far more complex that this simplified example. Replicating, finding and fixing the bug is hard. Perhaps it could be avoided if we could mark certain classes as immutable and certain data structures as only holding immutable objects.

* * *

## 回答 #22

> 赞同：8
> 
> 时间：2009-01-20T19:24:50.563

I believe in the future the main problem with Java will be the (lack of) visibility guarantees for constructors. For example, if you create the following class

```
class MyClass {
    public int a = 1;
} 
```

and then just read the MyClass's property *a* from another thread, MyClass.a could be either 0 or 1, depending on the JavaVM's implementation and mood. Today the chances for 'a' being 1 are very high. But on future NUMA machines this may be different. Many people are not aware of this and believe that they don't need to care about multi-threading during the initialization phase.

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2009-01-20T20:55:44.060

Synchronizing on a string literal or constant defined by a string literal is (potentially) a problem as the string literal is interned and will be shared by anyone else in the JVM using the same string literal. I know this problem has come up in application servers and other "container" scenarios.

Example:

```
private static final String SOMETHING = "foo";

synchronized(SOMETHING) {
   //
} 
```

In this case, anyone using the string "foo" to lock on is sharing the same lock.

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2009-01-20T16:12:13.650

The dumbest mistake I frequently make is forgetting to synchronize before calling notify() or wait() on an object.

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2009-01-20T17:38:24.270

Using a local "new Object()" as mutex.

```
synchronized (new Object())
{
    System.out.println("sdfs");
} 
```

This is useless.

* * *

## 回答 #26

> 赞同：7
> 
> 时间：2009-01-20T19:27:25.190

Another common 'concurrency' issue is to use synchronized code when it is not necessary at all. For example I still see programmers using `StringBuffer` or even `java.util.Vector` (as method local variables).

* * *

## 回答 #27

> 赞同：6
> 
> 时间：2009-01-20T16:15:37.200

Multiple objects that are lock protected but are commonly accessed in succession. We've run into a couple of cases where the locks are obtained by different code in different orders, resulting in deadlock.

* * *

## 回答 #28

> 赞同：5
> 
> 时间：2009-01-20T16:53:09.730

Not realising that the `this` in an inner class is not the `this` of the outer class. Typically in an anonymous inner class that implements `Runnable`. The root problem is that because synchronisation is part of all `Object`s there is effectively no static type checking. I've seen this at least twice on usenet, and it also appears in Brian Goetz'z Java Concurrency in Practice.

BGGA closures don't suffer from this as there is no `this` for the closure (`this` references the outer class). If you use non-`this` objects as locks then it gets around this problem and others.

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2009-01-20T16:03:01.187

Use of a global object such as a static variable for locking.

This leads to very bad performance because of contention.

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2009-01-20T16:11:51.047

Honesly? Prior to the advent of `java.util.concurrent`, the most common problem I routinely ran into was what I call "thread-thrashing": Applications that use threads for concurrency, but spawn too many of them and end up thrashing.

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2009-01-20T16:48:33.327

Not realising the `java.awt.EventQueue.invokeAndWait` acts as if it holds a lock (exclusive access to the Event Dispatch Thread, EDT). The great thing about deadlocks is that even if that happens rarely you can grab a stack trace with jstack or the like. I've seen this in a number of widely used programs (a fix to a problem I have only seen occur once in Netbeans should be included in the next release).

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2009-01-21T08:16:35.590

1) A common mistake that I have encountered involves iterating over a synchronized Collection class. It is required to manually synchronized before getting the iterator and while iterating.

2) Another mistake is that most textbooks give the impression that making a class thread safe is just a matter of adding synchronized on every method. That in itself is not a guarantee - it will only protect the integrity of the particular class, but the results can still be undeterministic.

3) Putting too much time-costly operations in a synchronized block often result in very bad performance. Fortunately the Future pattern in the concurrency package can safe the day.

4) Caching mutable objects to improve performance often leads to multithreading issues as well (and sometimes very hard to track since you assume you are the only user).

5) Using multiple synchronisation objects must be carefully handled.

* * *

## 回答 #33

> 赞同：3
> 
> 时间：2009-01-21T10:51:21.020

Starting Java RMI causes a background task to run that forces the garbage collector to run every 60 seconds. In itself, this may be a good thing, however it may be that the RMI server wasn't started by you directly, but by a framework/tool you use (eg. JRun). And, the RMI might not actually be being used for anything.

The net result is a System.gc() call once a minute. On a heavily loaded system, you will see the following output in your logs - 60 seconds of activity followed by a long gc pause followed by 60 seconds of activity followed by a long gc pause. This is fatal to throughput.

The solution is to turn off explicit gc using -XX:+DisableExplicitGC

* * *

## 回答 #34

> 赞同：3
> 
> 时间：2010-12-31T09:58:31.297

Try this code..

```
public class MyServlet implements Servlet{
    private Object something;

    public void service(ServletRequest request, ServletResponse response)
        throws ServletException, IOException{
        this.something = request.getAttribute("something");
        doSomething();
    }

    private void doSomething(){
        this.something ...
    }
} 
```

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2009-01-20T16:31:24.283

Race conditions during an object's finalize/release/shutdown/destructor method and normal invocations.

From Java, I do a lot of integration with resources that need to be closed, such as COM objects or Flash players. Developers always forget to do this properly and end up having a thread call an object that has been shutdown.

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2009-01-20T17:08:47.607

Failure to provide clearly defined lifecycle methods on objects that manage long-running threads. I like to create pairs of methods named init() and destroy(). It is also important to actually call destroy() so your app can exit gracefully.

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2009-01-21T07:34:46.253

Keeping all threads busy.

This is most frequent with having to go fix problems in other people's code, because they abused the locking constructs. As of late, my coworkers seem to have found reader/writer locks quite fun to sprinkle around whereas a little thought removes their need entirely.

In my own code, keeping the threads busy is less obvious but challenging. It requires deeper thought into algorithms, such as writing new data structures, or carefully designing a system to ensure that when locking is used it will never be contended.

Solving concurrency mistakes is easy - trying to figure out how to avoid lock contention can be hard.

* * *

## 回答 #38

> 赞同：2
> 
> 时间：2009-01-29T18:57:22.470

A method saving data to an instance variable in order to "save effort" passing it to helper methods, when another method which can be called concurrently uses the same instance variables for its own purposes.

The data should instead be passed around as method parameters for the duration of the synchronized call. This is only a slight simplification of my worst memory:

```
public class UserService {

    private String userName;

    public String getUserName() {
        return userName;
    }

    public void login(String name) {
        this.userName = name; 
        doLogin();
    }

    private void doLogin() {
        userDao.login(getUserName());
    }

    public void delete(String name) {
        this.userName = name; 
        doDelete();
    }

    private void doDelete() {
        userDao.delete(getUserName());
    }

} 
```

The login and logout methods do not have to be synchronized, logically speaking. But written as-is you get to expeience all sorts of fun customer service calls.

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2009-02-10T05:18:15.840

Concurrency problem of using different lock objects with wait and notify.

I was trying to use wait() and notifyAll() methods and here is how i used and fell in hell.

Thread1

```
Object o1 = new Object();

synchronized(o1) {
    o1.wait();
} 
```

And in other thread. Thread - 2

```
Object o2 = new Object();

synchronized(o2) {
    o2.notifyAll();
} 
```

Thread1 will wait on o1 and Thread2 which should have invoked o1.notifyAll(), is invoking o2.notifyAll(). Thread 1 will never wake up.

And offcourse the common problem of not invoking wait() or notifyAll() within synchronized blocks and not invoking them using the same object that is used to sycnhronze the block.

```
Object o2 = new Object();

synchronized(o2) {
    notifyAll();
} 
```

This will cause IllegalMonitorStateException, since the thread that invoked notifyAll() has invoked notifyAll() using this object but is not the owner of the this lock object. But the current thread is owner of o2 lock object.

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2009-01-20T16:33:58.537

The biggest problem I have run across is developers that add multi-threading support as an afterthought.

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2009-01-20T17:59:56.163

Since Java 5 there is Thread.getUncaughtExceptionHandler but this UncaughtExceptionHandler is never called when a ExecutorService/ThreadPool is used.
At least I was not able to get the UncaughtExceptionHandler with an ExcutorService working.

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2009-01-21T09:41:50.037

My two cents on trying to avoid synchronization problems from the start — watch out for the following issues/smells:

1.  When writing code, always **know in which thread you're in**.
2.  When designing a class or API for reuse, always **ask yourself whether the code has to be thread-safe**. It's better to make a deliberate decision, and document that your unit is *not* thread-safe, than to put in unwise synchronization with potential for deadlock.
3.  **Invocations of `new Thread()` are a smell**. Use dedicated ExecutorServices instead, which force you to think about your application's overall threading concept (see 1) and encourage others to follow it.
4.  **Know and use library classes** (like `AtomicBoolean` *et al*, synchronized Collections, etc). Again: make a conscious decision on whether thread-safety is important in a given context, don't just use them blindly.

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2009-01-22T05:43:33.870

I ran into a pseudo-deadlock from an I/O thread that created a countdown latch. A vastly simplified version of the problem is like:

```
public class MyReader implements Runnable {

  private final CountDownLatch done = new CountDownLatch(1);
  private volatile isOkToRun = true;

  public void run() {
    while (isOkToRun) {
       sendMessage(getMessaage());
    }
    done.countDown();
  }

  public void stop() {
    isOkToRun = false;
    done.await();
  }

}

```

The idea of stop() is that it didn't return until the thread had exited, so when it returned the system was in a known state. This is OK, unless sendMessage() results in the invokation of stop(), where it will wait forever. As long as stop() is never invoked from the Runnable, everything will work as you expect. In a large application, however, the activity of the Runnable's thread may not be obvious!

The solution was to call await() with a timeout of a few seconds, and to log a stack dump and complaint any time the timeout occurred. This preserved the desired behavior when it was possible, and exposed coding problems as they were encountered.

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2009-09-11T18:06:20.297

Updating a Swing UI component (typically a progress bar) in a worker thread instead of in the Swing thread (one should of course use `SwingUtilities.invokeLater(Runnable)`, but if you forget to do this then the bug can take a long time to surface.)

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2009-01-20T19:05:23.380

```
public class ThreadA implements Runnable {
    private volatile SharedObject obj;

    public void run() {
        while (true) {
            obj = new SharedObject();
            obj.setValue("Hallo");
        }
    }

    public SharedObject getObj() {
        return obj;
    }
} 
```

The problem I'm trying to point out here (among others) is that the flush of the SharedObject obj happens before setting the value "Hallo". That means that the consumer of getObj() might retrieve an instance where getValue() returns null.

```
public class ThreadB implements Runnable {
    ThreadA a = null;

    public ThreadB(ThreadA a) {
        this.a = a;
    }

    public void run() {
        while (true) {
            try {
                System.out.println("SharedObject: " + a.getObj().getVal());
                Thread.sleep(50);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
}

public class SharedObject {
    private String val = null;

    public SharedObject() {
    }

    public String getVal() {
        return val;
    }

    public void setVal(String val) {
        this.val = val;
    }
} 
```

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2009-01-21T08:38:11.477

Assisting with the Implementation of Actors in Functional Java and benchmarking millions of threads on multi-core machines.

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2009-01-21T09:10:29.663

```
while(true)
{
   if (...)
     break

   doStuff()
} 
```

Invariably when developers write while loops they miss the "resource commit" in their own code.

Namely if that block does not exit, the application and maybe even the system will lock up and die. Just because of a simple `while(fantasy_land)...if(...) break`.

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2009-12-30T23:15:46.430

A nasty gotcha I've found in java is having multiple threads access a HashMap without synchronization. If one is reading and one is writing then there is a good chance of the reader ending up in an infinite loop (the bucket node list structure gets corrupted into a looped list).

Obviously you shouldn't be doing this in the first place (use ConcurrentHashMap or Collections.synch... wrapper), but it seems to be the one that always gets through the net and causes proper thread stuck, system completely broken, usually due to a utility class containing such a map being a few levels down the stack and nobody thinking of it.

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2010-12-31T11:01:39.413

I think the most frequent concurrency problem in Java is code that actually seems to work so far, although it is not really thread-safe at all. Thanks to a tiny error, it becomes a time bomb and in almost all cases, you don't know that in advance, because it is not obvious to you. While regular faulty code hopefully fails during tests, concurrent code often only fails eventually and non-reproducible.

# asp.net - 将单一的 asp.net 站点分解为库时将 AppSettings 放在哪里？

> ID：461898
> 
> 赞同：4
> 
> 时间：2009-01-20T15:59:37.823
> 
> 标签：asp.net, architecture, configuration, web-config

我有一些使用的业务对象：

```
Web.Configuration.WebConfigurationManager.AppSettings.Item("SomeSetting") 
```

现在我将这些对象分解到它们自己的库中，当库中没有任何其他内容与 web 有任何关系时，依赖 System.Web 感觉很脏。

这样做的正确方法是什么？

更新：发现[这个例子](http://www.bearcanyon.com/dotnet/#AssemblySettings)显示了每个程序集的配置文件。这是一个坏主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T16:16:19.943

将其放入 web.config 并调用 ConfigurationManager.AppSettings["KEY"]

您的库中不需要 system.web。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T16:21:27.203

如果你有一堆 appSettings，我也很喜欢通过从 System.Configuration 继承 ConfigurationSection、ConfigurationElement 等来使用自定义配置部分。如果这些设置与代码的特定区域紧密耦合，这尤其适用。

这允许您以强类型属性的形式访问设置，并且还可以更好地控制需要哪些设置、每个设置的允许值（您可以使用枚举），并且您还可以拥有集合。

[如何：使用 ConfigurationSection 创建自定义配置部分](http://msdn.microsoft.com/en-us/library/2tw134k3.aspx "如何：使用 ConfigurationSection 创建自定义配置部分")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T16:09:25.700

为什么不使用 Web.config？我在 MSDN 中看到提到它是 web 应用程序的 app.config 的正确模拟。

# javascript - jquery slideDown而不是slideAndPush

> ID：461899
> 
> 赞同：1
> 
> 时间：2009-01-20T15:59:42.973
> 
> 标签：javascript, jquery, dom, slidedown

我有一个 div，我在其中单击指向 slideDown 的链接。正如预期的那样，它实现了它的承诺，但我更喜欢它滑开而不向下推其他元素。就像在其他层之上的一层。这可能吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T16:05:55.300

这是可能的，但并不完全简单。我以前在[这里做过（视频悬停）](http://nidostudentliving.com/london/kings-cross/home.php)。

这个概念基本上是：

1.  在当前元素上设置相对位置（您正在浮动的元素，或者它的父元素，如果这更有意义的话）。这可以在您的 CSS 中静态设置。
2.  `position:absolute`创建一个新元素，使用相同的尺寸对其进行类似的样式设置，然后使用和将其放置在当前元素的正上方`z-index:...`
3.  使用 slideDown （或再次更改高度，具体取决于最有意义的内容），它应该高于您的其余内容

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-20T16:04:30.437

尝试浮动你的元素。如果它们是 div，它们应该彼此滑过。

# asp.net - ASP.NET 控件到 HTML 标记等效

> ID：461901
> 
> 赞同：62
> 
> 时间：2009-01-20T15:59:58.917
> 
> 标签：asp.net, html, tags, servercontrols

我正在寻找一个备忘单，它可以让我向 HTML 设计师展示标准 HTML 标记的等效 asp.net 控件。例如，<asp:Panel> 将呈现为 HTML <div>，而 <asp:Label> 将呈现为 HTML <span>。我一直在谷歌搜索无济于事。有人可以发布一个好的备忘单的链接，以便该项目的设计人员可以更清楚地理解 aspx 页面上的标记。

为了清楚起见，我想要一个指向主要 ASP.NET 控件列表的链接，并说明它们与标准 HTML 的关系。如果这是 PDF 格式或易于阅读和打印的网页，那就太好了。就我而言，原因是我们有一个非常熟悉 HTML 的 PHP 开发人员来处理我们的项目，我觉得如果可以的话，更好地理解标准 ASP.NET 服务器控件会很有用递给他这样的“备忘单”。

我主要指的是 .NET 2.0 框架，但我们也在使用 3.0/3.5。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-01-20T16:20:56.533

这不是一个简单的问题，因为它取决于您正在谈论的 .NET 版本以及有时控制的状态。例如，PANEL，在 1 和 1.1 中呈现为 TABLE，而在更高版本中，它是 DIV。

但总的来说（2/3），这里是：

*   面板 - 分区

*   面板 -- GroupingText="###" 是字段集，图例

*   标签 - 跨度

*   按钮 - 输入、类型按钮

*   链接按钮 - 带有 JS 回发脚本的 Href

*   超链接 - 标准 HREF

*   图像按钮 - 输入、输入图像

*   文本框——默认为输入，输入文本

*   文本框 -- 模式 = 密码为输入，输入密码

*   文本框——模式=多行是文本区域

*   DropDownList - 选择

*   列表框 - 选择

*   RadioButton - 输入，带有 GroupName 的 Radio

*   复选框 - 输入，复选框

*   中继器/列表视图——复杂。

*   Gridview - 表格

*   表 - 表

*   文件 - 输入，类型=文件

    这就是基础。更深奥的控件（例如 LOGIN 控件）是一个表格，其中包含一堆赔率和结尾。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-20T16:50:27.287

[Stephen](https://stackoverflow.com/questions/461901/asp-net-control-to-html-tag-equivalent#462013)的清单非常全面。不过，我会在其中添加以下注释：

大多数情况下，它取决于已知的[BrowserCaps](https://msdn.microsoft.com/en-us/library/sk9az15a(v=vs.90).aspx)。

1.x 面板将在 IE6+ 中呈现为 div - 但是在 Firefox（或其他“DownStream”浏览器 - 被视为 DownStream，因为默认情况下 Machine.Config 中没有它的详细信息）它将呈现为单个单元格表 -这可以通过在 Machine.Config 或 Web.Configs 中为 Firefox/Opera/Safari/etc 提供更新的 BrowserCaps 来解决。

此外，控制适配器可以更改输出 - 例如，[CSS 控制适配器](http://www.asp.net/CssAdapters/)将为大多数表格控件（登录、注册、转发器等）输出样式化的 div。

请注意，在 TechEd/PDC 上宣布 ASP.NET 4.0 将默认内置 CSS 控件适配器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-20T16:06:28.187

这不会直接回答您的问题，但在很多情况下，您可以将 runat="server" 添加到常规 HTML 标记中，以使 ASP.Net 知道它。如果您希望能够动态更改页面，但仍然允许设计人员处理它，这可能会使设计人员的工作变得更容易。

```
<div id="myDiv" runat="server"></div>
<span id="mySpan" runat="server"></span> 
```

编辑：

我忘记提到的一件事（正如 steve_c 所指出的）是添加 runat="server" 将更改标签的 ID，这可能会有点痛苦。如果您在 CSS 中使用 ID，那么您有点不走运，但在您的 JavaScript 中，您可以添加类似 <%= myDiv.ClientID %> 的内容来获取由 .Net 生成的 ID。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T16:40:24.733

如果您需要呈现特定标签，htmlgenericcontrol 可能会有所帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-20T12:36:58.703

```
protected void CreateHeaders(List<Group_Info> group_Info)
{
    foreach (Group_Info gi in group_Info)
    {
        HtmlGenericControl groupContainer = new HtmlGenericControl("DIV");
        String lastLableID = "disp" + gi.GroupName.ToString().Replace(" ", "");
        groupContainer.ID = lastLableID;
        groupContainer.Attributes.Add("class", "content-groups");

        HtmlGenericControl groupTitle = new HtmlGenericControl("DIV");
        groupTitle.ID = lastLableID + "Sub1";
        if (gi.GroupName.Trim().Length == 0)
            groupTitle.Attributes.Add("class", "titlebar-hidden");
        else
        {
            groupTitle.Attributes.Add("class", "titlebar");
            groupTitle.InnerText = gi.GroupName.ToString().Trim();
        }

        groupContainer.Controls.Add(groupTitle);

        CreateFields(gi, ref groupContainer);

        this.pageContainer.Controls.Add(groupContainer);
    }
} 
```

# installation - 尝试在 Wix 中使用 EnsureTable 修复验证错误

> ID：461907
> 
> 赞同：3
> 
> 时间：2009-01-20T16:01:38.507
> 
> 标签：installation, wix, windows-installer, merge-module

当我尝试使用`msvbvm60.msm`合并模块时，我在 Wix 3.0 中遇到了许多错误：

```
C:\[...]: error LGHT0204 : ICE03: Table: Registry Column: Registry Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Registry Column: Root Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Registry Column: Key Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Registry Column: Name Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Registry Column: Value Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Registry Column: Component_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Extension Column: Extension Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Extension Column: Component_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Extension Column: ProgId_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Extension Column: MIME_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Extension Column: Feature_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: MIME Column: ContentType Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: MIME Column: Extension_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: MIME Column: CLSID Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: CLSID Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: Context Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: Component_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: ProgId_Default Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: Description Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: AppId_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: FileTypeMask Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: Icon_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: IconIndex Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: DefInprocHandler Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: Argument Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: Feature_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Class Column: Attributes Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: ProgId Column: ProgId Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: ProgId Column: ProgId_Parent Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: ProgId Column: Class_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: ProgId Column: Description Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: ProgId Column: Icon_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: ProgId Column: IconIndex Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Verb Column: Extension_ Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Verb Column: Verb Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Verb Column: Sequence Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Verb Column: Command Missing specifications in _Validation Table (or Old Database)
C:\[...]: error LGHT0204 : ICE03: Table: Verb Column: Argument Missing specifications in _Validation Table (or Old Database) 
```

我在某个地方读到了可以`EnsureTable`用来解决此问题的文章，因此我尝试`<EnsureTable Id="Key" />`将`Product`. 这导致我得到一个错误：

C:\Users...(28)：错误 LGHT0094：未解决对“产品：[GUID]”部分中符号“WixCustomTable:Key”的引用。

有什么建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-20T18:27:55.513

EnsureTable/@Id 应该引用您想要拉入的表。在您的情况下，您需要：

```
<EnsureTable Id="Registry"/>
<EnsureTable Id="Extension"/>
<EnsureTable Id="MIME"/> 
```

等等。这样做是为了确保 WiX 工具集在合并模块引入其没有 _Validation 表条目的表定义之前引入其*具有*适当 _Validation 表条目的表定义。

PS：根本原因是您使用的合并模块不是按照规范构建的。您可能会通知您从中获得合并模块的人他们正在生产破坏的东西（是的，我很欣赏这可能是微软）。

# .net - ASP.NET - 从内容页面访问母版页元素

> ID：461911
> 
> 赞同：7
> 
> 时间：2009-01-20T16:02:43.823
> 
> 标签：.net, asp.net, master-pages

可以从内容页面访问母版页的元素吗？

假设我有从 MasterPage1 继承的 MasterPage1 和 ContentPage1，而 MasterPage1 有一个按钮：Button1。

我可以从内容页面更改该按钮的属性，例如使 Button1 不可见、不活动等吗？我怎样才能做到这一点？

我正在使用.net2.0

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-20T16:07:04.847

是的...如果您需要使用 MasterPage 从 aspx 页面执行此操作，它将是：

```
Button myButton = (Button)Master.FindControl("myButton");
myButton.Visible = false; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-20T16:06:59.777

您必须在页面/用户控件标记中引用 MasterPage。

```
<%@ Reference VirtualPath="..." %> 
```

然后在代码隐藏中，您只需将 Page.MasterPage 转换为您的 MasterPage 并访问其属性。

```
MyMasterPage myMasterPage = (MyMasterPage)Page.Master; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-28T11:01:26.677

Master.FindControl("myButton").Visible = False

请注意，用于运行上述命令的控件不应位于更新面板内。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-20T16:07:36.887

是的，他们可以，并且有一些方法可以解决这个问题。

我使用的方法是在母版页中创建公共方法，这些方法将对母版页中的数据进行修改/访问。例如，我通常喜欢修改我所在的当前页面/类别的链接样式，所以我的母版页中有这样一个方法：

```
 Public Sub SetNavigationPage(ByVal MenuName As String)

      DirectCast(Me.FindControl(MenuName), HyperLink).CssClass = "MenuCurrent"

   End Sub 
```

然后在我的内容页面中，我只需像这样访问此方法：

```
Dim myMaster As EAF = DirectCast(Me.Master, EAF)
myMaster.SetNavigationPage("hypViewEmployee") 
```

...其中 EAF 是我的母版页类的名称。

我发现的一个有趣的问题是，在尝试以这种方式显示/隐藏它们时，我在使用 .NET 控件的 Visibility 属性时遇到了麻烦。这是由于母版页和内容页的呈现顺序。为了解决这个问题，我为可见和隐藏设置了一个基本的 CSS 样式，并相应地设置了 CssClass 属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-23T01:29:39.987

我遇到了一个问题，除非我在 ContentPlaceHolder 中查找它，否则我无法确定控件。在本例中为标签 (Label.ID = "lblMstrMessage")。我的代码如下（其中 ContentPlaceHolder.ID = "ContentTopPortion"）

```
 Control cph = this.Master.FindControl("ContentTopPortion");
  Label mpLabel = (Label)cph.FindControl("lblMstrMessage"); 
```

# javascript - 完成一个动画然后开始另一个

> ID：461912
> 
> 赞同：15
> 
> 时间：2009-01-20T16:02:53.387
> 
> 标签：javascript, jquery

我有两个 div 和两个触发 div 的 slideDown 和 slideUp 的单独链接。

当其中一个 div 向下滑动并单击另一个 div 时，我隐藏第一个 div (slidingUp) 然后打开另一个 div (slidingDown) 但是，此时就像一个 div 向下滑动，另一个，也在同一时间，正在向上滑动。

有没有一种方法可以告诉 jQuery 等待完成一个 div 的向下滑动，然后才开始向上滑动另一个？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-20T16:05:32.243

```
$('#Div1').slideDown('fast', function(){
    $('#Div2').slideUp('fast');
}); 
```

编辑：你检查过手风琴插件（如果这是你想要做的）？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T16:07:03.490

你应该像这样链接它

```
function animationStep1()
{
   $('#yourDiv1').slideUp('normal', animationStep2);
}

function animationStep2()
{
   $('#yourDiv2').slideDown('normal', animationStep3);
}

// etc 
```

当然，您可以根据需要使用递归函数、保存动画队列的数组等来为它增添趣味。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-06-25T16:10:46.413

一个更干净的例子，动画之间有延迟：

```
$("#elem").fadeIn(1000).delay(2000).fadeOut(1000); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T16:06:15.707

当第一个效果完成时，您可以使用回调来触发下一个效果：

```
$("#element1").slideUp(
    "slow", 
    function(){
        $("#element2").slideDown("slow");
    }
); 
```

在此示例中，定义为 slideUp 方法的第二个参数的函数在 slideUp 动画完成后被调用。

请参阅文档：[http ://docs.jquery.com/Effects/slideUp](http://docs.jquery.com/Effects/slideUp)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T16:04:14.943

大多数 jquery 函数都有一个回调参数，您可以将一个函数传递给它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T16:04:45.473

```
$("#thisDiv").slideUp("slow", function() {
    // This function is called when the slideUp is done animating
    $(this).doNextThing();
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T16:12:50.810

这方面的一个例子可以在[JQuery for Beginners - Day 2中看到](http://blog.themeforest.net/tutorials/jquery-for-absolute-beginners-day-2/)

这些教程有 15 天，它们是一个很好的资源。享受！

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-20T16:05:25.397

使用函数的第二个参数：回调。例如，

```
$(this).slideDown(速度，函数(){
    $(this).slideUp();
});

```

# c++ - 用模板定义异常是个好主意吗？

> ID：461918
> 
> 赞同：5
> 
> 时间：2009-01-20T16:04:33.040
> 
> 标签：c++, exception, templates

我在想用模板定义异常是个好主意。定义不同类型的异常是一项超级冗长的任务。你必须继承异常，没有任何改变，只是继承。像这样..

```
class FooException : public BaseException {
public:
    ...
};

class BarException : public BaseException {
public:
    ...
};

... 
```

那是一场噩梦不是吗？所以我正在考虑用模板定义不同的异常

```
/**
    @brief Exception of radio
**/
class Exception : public runtime_error {
private:
    /// Name of file that throw
    const string m_FileName;

    /// Line number of file that throw
    size_t m_Line;
public:
    Exception(const string &what, const string &File, size_t Line)
throw()
        : runtime_error(what),
        m_FileName(File),
        m_Line(Line)
    {}

    virtual ~Exception() throw() {}

    /**
        @brief Get name of file that throw
        @return Name of file that throw
    **/
    virtual const string getFileName() const throw() {
        return m_FileName;
    }

    /**
        @brief Get throw exception line
        @return Throw exception line
    **/
    virtual size_t getLine() const throw() {
        return m_Line;
    }

    /**
        @brief Get description of this exception
        @return Description of this exception
    **/
    virtual const string getMessage() const throw() {
        return what();
    }

    virtual void print(ostream &stream = cerr) const throw() {
        stream << "# RunTimeError #" << endl;
        stream << "Error : " << what() << endl;
        stream << "File : " << getFileName() << endl;
        stream << "Line : " << getLine() << endl;
    }
};

/**
    @brief Template exception of radio
**/
template <typename T>
class TemplateException : public Exception {
public:
    TemplateException (const string &what, const string &File, size_t
Line) throw()
        : Exception(what, File, Line)
    {}

    virtual ~TemplateException () throw() {}
};

}

#define THROW(type, error) (throw TemplateRadioException<type>(
(error), __FILE__, __LINE__)) 
```

所以如果我必须定义一个新的异常，我可以像这样定义一个空类。

```
class NuclearException {}; 
```

抛出异常

```
THROW(NuclearException , "Boom!!"); 
```

去抓

```
try {

} catch (TemplateException<NuclearException> &e) {
    // ...
} 
```

如果我们想捕获所有异常，我们可以这样写

```
try {

} catch (Exception &e) {
   // ...
} 
```

它工作正常，但我不确定是否有任何副作用？这是定义不同类型的异常的好主意吗？还是有更好的解决方案？我不知道：S

谢谢。维克多·林。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T09:00:20.667

这是一个有趣的想法，但除了已经指出的缺点之外，它也不允许您定义异常层次结构：假设您要定义

```
class InvalidArgumentException {};
class NullPointerException : public InvalidArgumentException {}; 
```

那么 TemplatedException<NullPointerException> 将不会从 TemplatedException<InvalidArgumentException> 继承，并且您的异常处理机制最终可能会比“普通”机制更笨拙。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T17:21:10.407

这绝对是可能的并且工作正常，但我会避免它。它掩盖了诊断。GCC 将显示异常类型的名称，包括通常的模板内容。我会花几分钟时间来亲自定义新的异常类。这不像你会一直这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T17:28:01.937

如果您很懒惰并且不想编写声明新异常类所需的内容，您总是可以使用为您完成它的宏。

# apache-flex - 从动作脚本库中检测 AIR 与 Flash Player

> ID：461923
> 
> 赞同：7
> 
> 时间：2009-01-20T16:05:06.003
> 
> 标签：apache-flex, flash, actionscript-3, air

我有一个 swc，它需要根据它是否由 AIR 托管而略有不同。我在网上看到了两个建议：

*   测试 WindowedApplication 的 Application.application。
*   为 Security.APPLICATION 测试 Security.sandboxType。

但是，这些似乎在我的 .swc 中不起作用，因为编译器找不到 WindowedApplication 或 Security.APPLICATION。我的库不需要任何其他 AIR 功能，因此我认为它没有链接到 AIR 库，并且我认为不应该这样才能继续在 Flash 播放器中工作。

有什么建议么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-21T09:07:50.417

您可以使用[flash.system.Capabilities](http://livedocs.adobe.com/flex/3/langref/index.html?flash/system/Capabilities.html&package-frame.html)对象来确定您是否在 AIR 下运行。

```
var isAir : Boolean = (Capabilities.playerType == "Desktop");
var isFlashPlayer : Boolean = (Capabilities.playerType == "StandAlone");
var isBrowser : Boolean = (Capabilities.playerType == "ActiveX" || Capabilities.playerType == "PlugIn");
var isOther : Boolean = (Capabilities.playerType == "External"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T16:12:48.110

我会尝试 flash.utils.getDefinitionByName() 这将允许您将 AIR API 类之一作为字符串传递。这应该会引发一个错误，您可以在 Flex 环境中捕获该错误，或​​者在 AIR 环境中成功。

# c# - 选择要实例化的类c#

> ID：461939
> 
> 赞同：4
> 
> 时间：2009-01-20T16:06:39.793
> 
> 标签：c#, design-patterns

我想要做的是根据传入的括号选择适当的类来实例化。目前我有两个类（ClassA 和 ClassB），并根据括号使用两种方法调用这些 im。我想要实现的是仅使用一种方法根据传递的字符串括号来实例化 ClassA 或 ClassB。

我真的不知道如何将类对象传回使用..

我的旧方法是在方法 A 中调用类进行实例化，然后我可以使用它。ClassA myclass = new ClassA();

我确实考虑过使用以下内容，但我不（如果我诚实的话）知道我如何实例化对象 o 或在 MyMethod 传回对象时使用它。object o 似乎没有让我访问 Class A 或 Class B 中的公共字符串方法。

```
public class ClassA
{
    public ClassA()
    {
        //Do something for Class A
    }
    public string msgA()
    {
        return "Here is msg A";
    }
}

public class ClassB
{
    public ClassB()
    {
        //Do something for Class B
    }
    public string msgB()
    {
        return "Here is msg B";
    }
}

private string MyMethod()
{
    object o = GetClassToInstantiate("ClassA");
    //Use object o 
}

private object GetClassToInstantiate(string parameter)
{
    object temp = null;
    switch (parameter)
    {
        case "ClassA":
            temp = new ClassA();
            break;
    }

    return temp;
} 
```

任何关于我如何解决这个问题的建议都可能非常简单。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-20T16:10:49.363

您需要的是基类中的工厂方法：

```
enum ClassType { ClassA, ClassB }

class ClassBase
{
   public static ClassBase Create(ClassType  classType)
   {
       switch (classType)
       {
           case ClassType.ClassA: return new ClassA();
           case ClassType.ClassB: return new ClassB();
           default: throw new ArgumentOutOfRangeException();
       }
   }
}

class ClassA : ClassBase
{
}

class ClassB : ClassBase
{
} 
```

[查看有关工厂方法模式](http://en.wikipedia.org/wiki/Factory_method_pattern)的 Wikipedia 文章以获取更多信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-20T16:28:40.230

我会为你的类使用一个通用接口和一个带有通用工厂方法的单独工厂类，如下所示：-

```
class Program
{
    static void Main(string[] args)
    {
        IAnimal animal = AnimalFactory.CreateAnimal<Dog>();

        animal.Speak();

        Console.ReadKey();
    }
}

public abstract class AnimalFactory
{
    public static IAnimal CreateAnimal<T>() where T : IAnimal, new()
    {
        return new T();
    }
}

public interface IAnimal
{
    void Speak();
}

public class Dog : IAnimal
{
    public void Speak()
    {
        Console.WriteLine("Woof");
    }
}

public class Cat : IAnimal
{
    public void Speak()
    {
        Console.WriteLine("Meow");
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-20T16:14:18.090

您想要做的通常不被认为是非常有用的操作。完成后，您所知道的结果就是它是一个对象。您不知道它提供的任何方法或属性。由于 C# 不允许（当前在 v4 中即将推出）允许后期绑定，因此您无法对结果做任何事情。

当 A 类和 B 类实现一个公共接口或从一个公共基类继承时，它变得更加有趣。在这种情况下，您可以有一个通用方法来实例化您的真实类，但将其作为公共接口返回。这更有用，例如插件架构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T16:12:01.140

你最好使用设计模式来做到这一点。看看 Gang of Four 网站上的抽象工厂和工厂方法模式。

[抽象工厂](https://www.dofactory.com/net/abstract-factory-design-pattern)

[工厂方法](https://www.dofactory.com/net/factory-method-design-pattern)

# visual-studio - 有没有办法将 VS 2005 项目文件列表转换为文本或 xml 格式？

> ID：461954
> 
> 赞同：0
> 
> 时间：2009-01-20T16:10:13.653
> 
> 标签：visual-studio, visual-studio-2005, file

有谁知道我如何或在哪里可以快速从 VS 2005 中提取我所有项目文件的列表？我需要将文件名带入 Excel/Access/SharePoint 以执行项目管理职责（即更新日志等），因此 XML 或其他一些文本/分隔文本格式将是理想的。

我想将实际文件名（即 Default1.aspx、Default1.aspx.vb、Default2.aspx、Default2.aspx.vb、UserControl.ascx、UserControl.ascx.vb）转换为列表格式。我不一定只想要一个文件计数。我需要完整的清单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T16:29:03.163

[总司令](http://www.ghisler.com/download.htm)_

1.  导航到文件夹
2.  菜单 > 命令 > 搜索并回车
3.  按“馈送至列表框”按钮
4.  选择窗格中的所有文件
5.  菜单>标记>将名称复制到剪贴板并粘贴到Excel中
6.  在 Excel 中对名称进行排序

您还可以使用搜索对话框中的过滤器来排除某些扩展名。

# windows-mobile - 通过 ActiveSync 连接时从 windows mobile 获取主机 pc 的 IP 地址

> ID：461957
> 
> 赞同：5
> 
> 时间：2009-01-20T16:10:32.233
> 
> 标签：windows-mobile, compact-framework, activesync

我有一个在 Windows Mobile 上运行的 .Net Compact 应用程序，我希望通过 ActiveSync 连接时能够连接到运行在“主机”机器（即 PDA 插入的桌面）上的 Web 服务，但我没有知道主机的ip地址。如何在 PDA 上以编程方式找到台式 PC 的 ip？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T11:13:35.640

我找到了一篇知识库文章[How To Retrieve the IP Address of the Remote PPP Peer](http://kbalertz.com/183988/Retrieve-Address-Remote.aspx)，它使用主机“PPP_Peer”。所以我尝试了：

```
Dns.GetHostEntry("PPP_Peer").AddressList[0] 
```

这确实给了我正在寻找的东西（我目前正在使用的 PC 上的 169.254.2.2）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T16:20:25.147

获取地址与连接到任何其他网络适配器时没有什么不同（现在 ActiveSync 通常在 RNDIS 上运行）。

```
Dns.GetHostEntry(Dns.GetHostName()).AddressList[0]; 
```

也就是说，ActiveSync 总是会创建一个本地网络，因此设备总是会获得 192.168.55.101（以及主机 PC 的 192.168.55.100）。理论上它可能会有所不同，但在我与 CE 合作的十年中，我从未见过它给出任何其他地址（除了在 Vista 的 WMDC 下，它倾向于使用不同但非常可预测的寻址方案） .

**编辑**：看来您不是在尝试获取自己的 IP，而是在连接的 PC 上。ActiveSync 不是一个成熟的网络连接。它会过滤某些数据包类型并且您无法获得名称解析，因此您无法通过对 PC 名称执行 Dns.Resolve 从设备代码中获取 PC 的 IP 地址。您必须将 IP 直接提供给设备应用程序。

# javascript - 为什么 JavaScript 中有一个“null”值？

> ID：461966
> 
> 赞同：124
> 
> 时间：2009-01-20T16:12:46.097
> 
> 标签：javascript, null, language-features, undefined

在 JavaScript 中，有两个值基本上表示“我不存在” -`undefined`和`null`.

程序员没有分配任何东西的属性 will be `undefined`，但为了让属性成为`null`，`null`必须显式分配给它。

我曾经认为有必要`null`因为`undefined`是一个原始值和`null`一个对象。不是，即使`typeof null`会 yield `'object'`：实际上，两者都是原始值 - 这意味着既不能`undefined`也不`null`能从构造函数返回，因为两者都将转换为空对象（必须抛出错误才能在构造函数中声明失败）。

它们也都`false`在布尔上下文中求值。我能想到的唯一真正的区别是，一个评估为`NaN`，另一个评估为`0`在数字上下文中。

那么为什么两者都存在`undefined`，`null`如果这只会让程序员`null`在试图找出是否设置了属性时错误地检查呢？

我想知道的是，是否有人有一个合理的例子，必须使用`null`它不能用`undefined`代替来表达。

所以普遍的共识似乎是这`undefined`意味着“没有这样的财产”，而`null`意味着“财产确实存在，但没有价值”。

如果 JavaScript 实现实际上会强制执行此行为，我可以忍受 - 但`undefined`它是一个完全有效的原始值，因此可以轻松地将其分配给现有属性以破坏此合同。因此，如果要确定属性是否存在，则必须使用`in`运算符或`hasOwnProperty()`无论如何。再说一遍： 和 的单独值有什么实际`undefined`用途`null`？

`undefined`当我想取消设置不再使用但我不想的属性值时，我实际上会使用`delete`。我应该`null`改用吗？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-01-21T00:00:05.297

问题并不是真正的“为什么 JS 中有一个空值”——在大多数语言中都有某种空值，它通常被认为非常有用。

问题是，“为什么 JS 中有*未定义*的值”。主要使用场所：

1.  当您声明`var x;`但未分配给它时，`x`保持未定义；
2.  当你的函数得到的参数比它声明的少时；
3.  当您访问不存在的对象属性时。

`null`对于 (1) 和 (2)* 肯定也同样有效。(3) 真的应该立即抛出异常，而事实上它没有返回这个`undefined`稍后会失败的怪异，这是调试困难的一大来源。

*：您也可以争辩说 (2) 应该抛出异常，但是您必须为默认/变量参数提供更好、更明确的机制。

然而，JavaScript 最初并没有例外，也没有任何方式来询问对象是否有某个名称下的成员 - 唯一的方法是（有时仍然是）访问该成员并查看你得到了什么。鉴于它`null`已经有了一个目的，并且您可能希望为其设置一个成员，因此需要一个不同的带外值。所以我们有了`undefined`，正如你所指出的那样，它是有问题的，它是我们永远无法摆脱的另一个伟大的 JavaScript“功能”。

> 当我想取消设置不再使用但我不想删除的属性的值时，我实际上使用了 undefined。我应该改用 null 吗？

是的。当其他语言可能引发异常时，请保留`undefined`作为信号的特殊值。

`null`通常会更好，除了在某些 IE DOM 接口上设置某些内容`null`可能会给您带来错误。通常在这种情况下，设置为空字符串往往会起作用。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-01-20T16:18:16.103

最佳描述[here](http://saladwithsteve.com/2008/02/javascript-undefined-vs-null.html)，但总结如下：

undefined 是缺少类型和值，null 是缺少值。

此外，如果您正在进行简单的“==”比较，那么您是对的，它们的结果是一样的。但是试试 ===，它比较类型和值，你会注意到不同之处。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-10-18T19:38:23.367

我认为没有任何理由同时拥有`null`and `undefined`，因为许多人建议的唯一原因（“`undefined`意味着没有这样的变量/属性”）是无效的，至少在 JavaScript 中是这样。`undefined`无法告诉您变量/属性是否存在。

```
console.log(foo);               // "ReferenceError: foo is not defined"
                                // foo does not exist
var foo;
console.log(foo);               // "undefined", a different response
console.log(foo === undefined); // "true", but it does exist

var obj = {};
console.log(obj.hasOwnProperty("foo")); // "false", no such property
obj.foo = undefined;
console.log(obj.hasOwnProperty("foo")); // "true", it exists and has the value "undefined"
console.log(obj.foo === undefined);     // "true", but it does exist

obj.bar = "delete me";
obj.bar = undefined;
console.log(obj.hasOwnProperty("bar")); // "true", not actually deleted
delete obj.bar;
console.log(obj.hasOwnProperty("bar")); // "false", deleted 
```

如您所见，检查`foo === undefined`并不能告诉您是否`foo`存在，而设置`obj.bar = undefined`实际上并没有删除`bar`。

`undefined`应该代表“不存在”的可能是 JavaScript 作者的初衷。然而，实施的结果并非如此。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-20T16:17:52.763

两者都需要是完全可能的。例如，如果您查询 WMI，则完全有可能让一个类返回具有空值的属性。它们是被定义的，它们恰好在当时保持为空。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-20T17:45:24.397

我认为您将 JavaScript 定义`undefined`为“没有这样的属性”和`null`“该属性没有价值”的结论是完全正确的。在像 JavaScript 这样动态的语言中，这是一个非常重要的区别。使用鸭子类型意味着我们需要能够区分不存在的属性和不具有值的属性。它是我们获取类型信息的主要方式。在静态类型语言中，字段为空和字段不存在之间有明确的区别。在 JavaScript 中，这没有什么不同。然而，它在运行时被检查，并且可以在那个时候被修改。

我将不得不同意实施很奇怪，因为很多时候区分是模糊的。但是我认为在 JavaScript 中区别很重要。并且能够分配`undefined`是必不可少的。

我记得不久前读过一篇关于用 JavaScript 编写的在线 RPG 的博客文章。它使用了一些示例，其中对象被创建为现有实例的副本而不是原型（类、函数等），然后被更改。这真的让我明白了`undefined`修改现有对象时的强大功能，但我不记得是谁写的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-20T16:21:23.040

从语义上讲，它们意味着不同的东西。null 类型在其域中只有一个值，null 并且可以为属性分配此特定值。未定义表示明显缺乏已分配的任何值。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-04-11T14:25:06.083

作为一名 Java 程序员，我看到了 undefined 和 null 之间的巨大差异。编写 JavaScript 代码不多，因为 JavaScript 不是强类型的，并且 undefined 和 null 之间的区别被运行时经常执行的自动转换模糊了。顺便说一句，我经常利用这些转换；它们使我的 JS 代码更加紧凑和可读。

要回答您的问题，未定义意味着从未设置过值。实际上，这通常指向一个错误。如果 yourObject.property 未定义，则意味着您出于某种原因没有设置该属性，或者我正在寻找根本不存在的东西。在与多个编码员一起处理项目时，这是一个真正的问题。

null 表示明确设置了“无值”。实际上，您是在告诉我有关该属性的一些信息，可能是在此上下文中未使用它，或者尚未确定值。

在 Java 中，尝试访问未定义的字段总是会导致异常。事实上，编译器可以在你的代码中警告你这一点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T17:04:05.260

试试这个例子：

```
<html>
<head>
    <script type="text/javascript">
        function ShowObjProperties(obj) {
            var property, propCollection = "";

            for(property in obj) {
                propCollection += (property + ": " + obj[property] + "\n");
            }

            alert(propCollection);
        }

        var obj = {
            userid: 3,
            name: 'me!',
            speak: function() { alert('Hi! My name is ' + this.name + ' and my ID is ' + this.userid + '.'); }
        }

        //Shows all properties
        ShowObjProperties(obj);

        //The Speak function is no longer in the list!
        delete obj.speak;
        alert(typeof obj.speak);
        ShowObjProperties(obj);

        //The UserID is still listed, it just has no value!
        obj.userid = null;
        ShowObjProperties(obj);
    </script>
</head>
<body>

</body>
</html> 
```

我认为这里有两种不同类型的非常实际的用途。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-20T17:30:40.310

它归结为javascripts动态性质。

事物可能是未定义的，以便以后可以添加。这可以说是 javascript 如此强大和可扩展的原因。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-02-24T21:25:06.867

如果您将程序包装在 javascript 的事件范式中，这是一个重要的语言功能。

```
// a key exists as a placeholder for something
if(obj[name] === null) 
// no key exists int eh hashtable that is in this object
if(obj[name] === undefined) 
```

如果您正在处理一组数据，这些数据需要一个值来表示“无”以指示与使用“无”指示默认操作不同的某些操作，这将非常有用。

```
filter_func_pt = {
  date:function(d){ return Math.round(d.getTime()/1000);},
  user: null,
}

function transform(obj){
    var ret = {};
    for( var prop in obj){
       var f = filter_func_pt[prop];
       if(f)
          ret[prop] = f(obj);
       else if(filter_func_pt[prop] === null)
         continue;
       else
         ret[prop] == obj;
    }
  return ret;
}

var a = {
   date: new Date(),
   user: 'sam'
   votes: [23, 41, 55] 
};

var b = transform(a);

/* b = {
 *    date: 1298582417
 *    votes: [23, 41, 55]
 * }
 */ 
```

在上面的代码中，*null*关键字和*undefined* server 很清楚，用途不同。*在返回undefined*的 filter_func_pt 对象中找不到的查找意味着将属性按原样添加到返回对象中，而*null*值表示应该保留该值，而不是添加该值，并且此值中存在任何真值case 表示一个函数，用于在将值添加到*ret*对象之前对其进行转换。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-02-09T01:16:11.200

## **空是美丽的**

与所有其他类型的实时脚本一样。

> 引用：在 JavaScript 中，有两个值基本上表示“我不存在” - undefined 和 null。

为什么要说不正确的话？！

**"null"**是*"empty Object"*，就像 "0" 是*"empty Number"*。0，什么都不是——但它作为数字类型存在。 *null*当然也是空的，但“它是”，它是一个明确定义的*对象类型*。

通常将这些东西称为“类型”，而实际上它们不是。事实上，它们是“类别”。但现在已经结束了。

所以会坚持说“null”是一种没有种类的对象类型。“null”表示“我非常存在[！]，但我没有我的内容”。

而*undefined*既缺少 Type 也缺少 Kind，其中*undefined*恰好也是它的 Type 定义。类型的未定义类型成为其独特的类型。一种[“无”存在吗？你如何定义“无”？]问题。

> cite: undefined 或 null 可以从构造函数返回，因为两者都将转换为空对象

你又一次说了不正确的话。当然不是，“未定义”不是 Object，它是我们人类理解的普通 Token；但与*null*相反的是 - 它告诉你：*它的 Type 是正确的，但你正在寻找的 Kind 不包含在其中，或者至少 - 目前不包含。稍后当我们将一些对象放入\分配给它时来拜访我们。*

> 引用：我能想到的唯一真正的区别是，在数字上下文中，一个计算为 NaN，另一个计算为 0。

如前所述，这就是它们的核心区别的全部要点：*undefined*是一个简单的标记，并且由于它由与其远亲相同的“遗传”材料组成：字符串，[ +undefined ] 操作会将其转换为NaN，同样，null 当然会将自身变形为正确的类型 0 \Number，而不是*undefined*将变形为字符串（！这不是空的！），这正是它产生*NaN*的原因。其中：+undefined >> +"undefined" >> NaN。由于数字上下文需要显式值。

虽然布尔上下文需要引用 - 找不到任何要转换的内容并产生“假”。

现在让我们切入...

> 引用：所以再一次：未定义和空值的单独值的实际用途是什么？

我将尝试只给你两个经验性的例子，希望就足够了

```
oElement.onclick >> null 
```

//表示-该属性存在；它的预期值为 Type: *Object*，并且 oElement 支持“onclick”事件！

```
oElement.innerText >> "" 
```

//表示 - 属性存在；其预期值为 Type: *String*，这意味着 oElement 支持“innerText”属性。

在这两种情况下 - 如果您收到“未定义”，则表示该属性不存在；不受支持或有错误的（ua 供应商）实现。

保持霜冻，玩得开心。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-03-17T10:36:23.530

在阅读了关于 undefined vs null 的惊人讨论后，在谷歌上的小搜索把我带到了 Mozilla 文档 [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null) 它被提到 - 通常是 null在可以预期对象但没有对象相关的地方检索。

不是类似于 Null 对象模式 [https://en.wikipedia.org/wiki/Null_object_pattern](https://en.wikipedia.org/wiki/Null_object_pattern)

所以我想拥有 Null 数据类型是有意义的。

文档也提到了 typeof null // “object”（不是“null”，因为遗留原因）

不确定遗留原因是什么

# xml - PL/SQL 中是否有将文本转换/编码为 XML 兼容文本的方法？

> ID：461970
> 
> 赞同：10
> 
> 时间：2009-01-20T16:13:02.197
> 
> 标签：xml, oracle, plsql

我有一位同事需要将文本从 PL/SQL 方法转换为符合 XML 的文本，因为他正在通过更新文本模板来构建 excel 电子表格。

PL/SQL 中是否有将文本转换/编码为 XML 兼容文本的方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-21T15:51:34.703

好吧，如果你只是想转换 XML 字符，你会想做类似的事情......

```
 outgoing_text := DBMS_XMLGEN.CONVERT(incoming_text) 
```

其中`outgoing_text`和`incoming_text`都是 VARCHAR2 或 CLOB。

您可以指定第二个参数，但默认为`DBMS_XMLGEN.ENTITY_ENCODE`... 它还可以通过`DBMS_XMLGEN.ENTITY_DECODE`作为第二个参数传递来解码 XML 实体。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T16:45:22.880

更高版本的 oracle 具有用于操作 XML 数据的内置[XML 包。](http://www.orafaq.com/wiki/DBMS_XMLGEN)
例如，这是您的同事想做的事情吗？：

```
SELECT DBMS_XMLGEN.getXML('SELECT * FROM emp') FROM dual; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T18:35:26.737

除了 dbms_xmlgen 之外，还可以使用 sql 方法，xmlelement 然后将值提取回来。

```
select extract(xmlelement("mytest",my_variable),'mytest/text()') from dual; 
```

xmlelement 函数将使文本符合 XML，然后使用提取函数，它将按原样提取文本。（注意：extractValue 函数会将文本转换回不符合 XML 的版本。）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T17:03:38.880

hamischmcn 选项简单明了，但它在 oracle 表单中不起作用，我尝试了很多使用它，但什么也没有……你可以手动生成 xml，使用类似这样的东西

utl_file.put_line_nchar (file_id, 'xml version="1.0" encoding="utf-8"');

utl_file.put_line_nchar (file_id, '开始');

--A FOR 循环，您可以在其中定义标签

utl_file.put_line_nchar (file_id, '/Start');

**注意：编辑器不允许我将 < > 符号放在 xml 和标签标题中**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T15:20:09.307

关于 Rulas 在 Oracle Forms 上的问题，Forms 有很多不能做的事情（在各种版本中），您需要使用数据库包。

因此，编写一个执行 dbms_xmlgen 并返回 varchar2 或 clob 的数据库 PL/SQL 函数，具体取决于 XML 的大小。然后您可以从 Forms 中调用该函数。当您将数据返回到 Forms 时，使用 text_io 或 webutil 将 XML 文件推送到 Excel。

或者留在数据库端并使用 utl_file 将 XML 输出推送到您可以获取它的目录。

# crystal-reports - 水晶报表-子报表

> ID：461974
> 
> 赞同：0
> 
> 时间：2009-01-20T16:13:59.310
> 
> 标签：crystal-reports

我无法打印创建的子报表。每当我单击打印按钮时，它都会将我带到主报告并以 pdf 格式导出主报告，而不是对子报告执行相同的操作。请您告诉我为什么在 Crystal Report 10.5 和 Asp.Net (VS 2008) 中会发生这种情况。它在 VS 2005（ASP.Net 和 Crystal Report 10.2）中运行良好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-13T01:12:50.800

这有点牵强，但也许您要打印的子报表不包含任何记录，并且选中了“如果没有记录则禁止打印”的子报表选项。如果子报表没有任何记录，那么要检查第二部分，您可以右键单击子报表并选择“编辑子报表”。然后选择文件/报告选项并查看是否选中了“如果没有记录则禁止打印”。

我怀疑是这种情况，因为默认情况下它是未选中的，但它是值得尝试的。

# random - 为什么在 lua 的某些平台上第一个随机数总是相同的？

> ID：461978
> 
> 赞同：5
> 
> 时间：2009-01-20T16:14:24.190
> 
> 标签：random, lua

考虑以下 lua 代码片段：

```
local time = os.time()
for _= 1, 10 do
    time = time + 1
    print('Seeding with ' .. time)
    math.randomseed(time)
    for i = 1, 5 do
        print('\t' .. math.random(100))
    end
end 
```

在 Linux 机器上，结果如预期的那样是随机数。但似乎至少在 Mac OS X 上，改变种子后的第一个随机数总是一样的！

我想这与 Lua 依赖 C rand() 函数生成随机数有关，但有人解释一下吗？

编辑：这是Linux机器上上述代码输出的摘录（即输出如预期）：

```
$ lua test.lua
Seeding with 1232472273
    69
    30
    83
    59
    84
Seeding with 1232472274
    5
    21
    63
    91
    27
[...] 
```

在 OS X 机器上，“Seeding with ...”之后的第一个数字始终是 66。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T17:54:37.530

Lua 的 random 用于使用 C`rand(3)`和`srand(3)`函数（[参见此处](http://www.lua.org/source/5.1/lmathlib.c.html#math_random)）。更新：较新的 Lua 版本[在可用的地方使用 random(3)](http://www.lua.org/source/5.3/lmathlib.c.html#l_rand)。

C90 标准和 POSIX 都建议跨平台实现，`rand`这`srand`并不是最好的。它尤其缺乏低位的随机性。

像 Linux 这样的一些平台从标准推荐转向更好的实现（例如[random(3)](http://linux.die.net/man/3/random)）。

OS/X 仍然忠实于经典`rand`实现，Lua 继承了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T17:51:12.983

使用数字接近的种子多次调用 srand 通常是一个坏主意（尤其是使用时间值这样做更糟糕）。在很多情况下，第一个随机数的方差类似于种子的方差。在处理必须转换数字表示的脚本语言时，情况可能更是如此。

如果您将种子值更改得更大，是否也会发生同样的事情？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T07:21:45.513

正如其他人所指出的，Lua 出于可移植性的目的故意使用 C90 随机生成器——而 C90 RNG 并不是很好。

如果您需要好的随机数，请使用一些 Lua 模块来获取它。例如，[这里](http://www.tecgraf.puc-rio.br/~lhf/ftp/lua/#lrandom)是 Lua 作者之一的 Mersenne Twister RNG binding。

# c++ - 析构函数与成员函数竞赛

> ID：461981
> 
> 赞同：9
> 
> 时间：2009-01-20T16:15:07.123
> 
> 标签：c++, multithreading, destructor

当我在析构函数中时，是否有其他线程将开始执行对象的成员函数？如何处理这种情况？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-20T16:29:55.767

C++ 没有内在的保护来防止在对象被删除后使用它——忘记竞争条件——另一个线程可以在你的对象被完全删除后使用它。

任何一个：

1.  确保代码中只有一个地方拥有该对象，并且在没有人使用该对象时负责删除。
2.  使对象引用计数 - 通过添加显式引用计数代码，或找到实现引用计数的适当基类

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-20T16:17:55.433

除非您确定没有其他东西会尝试使用它，否则您不应该破坏一个对象 - 理想情况下，没有其他东西可以引用它。当您调用 delete 时，您需要更仔细地查看。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T16:36:55.877

如果您由于异常处理程序中的堆栈展开而处于析构函数中，我建议您重新排列代码，以便在序列化块中捕获异常。

在块之后，您检查对象是否仍然有效并调用您的方法。这样一个线程中的异常将允许其他线程优雅地处理对析构函数的调用。

# vba - 如何在vba中复制范围？

> ID：461983
> 
> 赞同：1
> 
> 时间：2009-01-20T16:15:30.150
> 
> 标签：vba, excel

我正在尝试这个，但它给了我一个类型不匹配。还有另一种方法可以做到这一点吗？我假设 rSource 不是来自活动表。

另外，我只需要价值观。

编辑：rSource 应该有行和列。它也将是一个单一的连续区域。

编辑：此操作完成后，我应该能够独立过滤每个范围。

```
Function CopyRange(rSource As range) As range
    ' Declarations
    Dim rTemp As range

    ' Create new range starting at cell A1
    Set rTemp = Range(Cells(1, 1), Cells(rSource.Rows.Count, rSource.Columns.Count))

    rTemp.Value = rSource.Value

    Set CopyRange = rTemp
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T16:38:03.503

我相信你的功能很好。

我创建了一个测试存根：

```
Function Check()
  Dim x As Range
  Dim c As Range
  Set c = Range("A1", "A2")
  Set x = CopyRange(c)
End Function 
```

将单元格 A1 设置为 2，将 A2 设置为 3。

在步入这一点，并使用以下方法评估 x 变量：
?x.Range("A1")
（我的类型与 ?x 不匹配，就像你所做的那样。）

我得到2。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T16:43:07.457

假设此代码位于 Worksheet 的代码模块中，那么它应该可以正常工作。我刚刚尝试过，它对我来说运行良好（假设传递给函数的范围是连续的）。

或者，试试这个： -

```
Function CopyRange(rSource As Range) As Range

   Call rSource.Copy(Cells(1, 1))

   Set CopyRange = Range(rSource.Address).Offset(1 - rSource.Row, 1 - rSource.Column)

End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T16:28:56.423

这是一个连续的区域吗？它是否被空单元格包围？如果是这样，您应该能够使用 currentregion 属性来设置范围。

我认为您收到错误的原因是因为您没有在第一个单元格声明中设置 rSource。

# database - 构建 PL/SQL IF THEN 语句的更好方法？

> ID：461985
> 
> 赞同：3
> 
> 时间：2009-01-20T16:16:15.047
> 
> 标签：database, oracle, syntax, plsql

只是想知道是否有更好的方法在 ORACLE 中编写以下 PL/SQL 代码？

```
IF(p_c_courtesies_cd is not null 
OR  p_c_language_cd is not null
OR v_c_name is not null
OR v_c_firstname is not null
OR v_c_function is not null
OR p_c_phone is not null
OR p_c_mobile is not null
OR p_c_fax is not null
OR v_c_email is not null
) THEN
     -- Do something
END IF; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-20T16:20:03.993

```
If coalesce( expr1, expr2, ... expr_n ) is not null then do something end if; 
```

[看这里。](http://www.techonthenet.com/oracle/functions/coalesce.php)

（感谢托尼的纠正）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T23:34:44.100

我的回答是简单的“不”。

尽管有几种替代方法可以编写相同的构造，但我认为没有一种必然“更好”。

任何人都可以查看 IF 语句并确切地知道它的含义。基于连接或使用合并运算符的替代方案只是模糊了意图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T16:24:59.740

如果 coalesce(expr1,expr2,...exprn) 不为空，那么 ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T16:57:01.937

另一种方式，利用 Oracle 将 NULL 和 '' 视为相同的事实：

```
IF p_c_courtesies_cd 
   || p_c_language_cd 
   || v_c_name 
   || v_c_firstname 
   || v_c_function 
   || p_c_phone 
   || p_c_mobile p_c_fax 
   || v_c_email is not null
THEN
     -- Do something
END IF; 
```

# c# - 在 OO 语言中，您将包含 Main 方法的类命名为什么？

> ID：461988
> 
> 赞同：14
> 
> 时间：2009-01-20T16:16:33.873
> 
> 标签：c#, oop, naming-conventions

例如，在 C# 或 Java 中，您总是有一个 main() 方法用于让您的程序运行。你给它所在的班级起什么名字？我会使用的一些想法只是“程序”或程序本身的名称。在这种情况下，什么会被认为是传统的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-20T16:23:45.390

这些天，Visual Studio 创建了“Program.cs”，这似乎很合理。我更喜欢的另一个自我记录名称是“EntryPoint”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T16:36:15.550

我使用 Main 或 Main

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T16:58:58.143

“发射器”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T16:17:52.623

我以应用程序本身命名主类。例如，一个计算器程序可能有一个“CalculatorProgram”或​​只有一个“Calculator”类。

考虑到 VS 将您的主类命名为无论您如何命名应用程序，我认为这是非常标准的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T16:21:24.380

在 Objective-C Cocoa 中，main() 是 C 函数本身。*它向代表正在运行的应用程序的NSApplication*对象发送一条消息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T16:28:40.730

我更喜欢 ConsoleStub.cs 用于控制台应用程序和 Core.cs 用于其他应用程序

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T16:41:24.153

程序似乎是标准。为我工作：D

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T17:08:12.100

主要的。放置它的包装说明了其余部分。

```
com.finance.calculator.Main 
```

在主要我只有：

```
public static void main( String [] args ) { 
    FinanceCalculator calc = new FinanceCalculator();
    calc.show(); // or start(); or init. or whatever.
} 
```

:SI 希望我永远不必编写财务计算器 :S :S

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-20T17:12:52.077

我一直使用 FooLauncher，因为它允许我将有关命令行解析的所有逻辑封装在一个类中（而不是试图将其放入一个方法中），这也允许更好的可测试性。这也是更好的关注点分离： Foo 可能是您在命令行之外使用的东西，但 FooLauncher 在那里启动 Foo 给定的命令行处理。

这在一个总体上有多个命令行工具可用的应用程序中尤其重要：每个都有自己的启动器。如果您的“程序”有多个命令行工具，那么仅仅说 Program 是没有意义的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-20T16:17:53.123

*XApplication*，其中 X 是程序的描述性名称。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-20T16:28:04.290

我认为使用语言的默认名称是个好主意...其他人会知道有 main()

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-20T16:30:25.330

我认为程序是一个常规案例。就我而言，我更费心去想我应该给命名空间起什么名字，特别是如果它只包含一个类的话。在没有明确的命名空间只包含一个类的指导方针的情况下，我想出了这样的模式：抽象类的存根，实现的 Impl，编译的 dll/exe 的名称的项目。

例子：

FootwearRemotingStubProject.dll：

```
namespace FootwearRemotingStubProject
{
    public class FootwearRemotingStub
    {
        ...
    }
} 
```

FootwearRemotingImplProject.exe：

```
using FootwearRemotingStubProject;

namespace FootwearRemotingImplProject
{
    public class FootwearRemotingImpl: FootwearRemotingStub
    {
        ...
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-20T16:33:34.713

我喜欢“启动”

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-20T17:01:58.433

VB.NET：

`Public Module Main
Public Sub Main(String args())
End Sub
End Module`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-20T19:16:25.230

我不把它放在课堂上。事实上，我什至没有使用方法，只是一段代码：

```
#!/usr/bin/env ruby

puts 'Look Ma, no class, no method!' 
```

# flash - svn 和带有 FLA 的分支（闪存文件）

> ID：461992
> 
> 赞同：0
> 
> 时间：2009-01-20T16:16:53.687
> 
> 标签：flash, svn

我们正在使用 flex builder 开发一个应用程序，我们所有的代码 + fla 文件都在 svn 中，我们现在不会使用分支，我可以做些什么来在分支之间合并这些文件，或者这样做时的工作程序是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T16:23:14.453

FLA 不是文本文件（它是二进制文件），因此我们将无法在 Subversion 服务器中使用 MERGE（也不是 DIFF）。

最好的解决方案是使用[Adob​​e Version Cue](http://www.adobe.com/products/creativesuite/versioncue/)，它将拥有您需要的一切。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T16:34:50.733

将 fla 文件用作任何其他二进制文件 - 您必须从最新版本覆盖或手动生成合并。使用颠覆时没有其他选择。

这就是我要做的：

锁定分支中的 fla 文件，以便没有人覆盖它们，这样您就不需要尝试比较两个都已更改的 fla 文件。（向团队解释这一点，锁定在 SVN 中可以撤消，这更像是一个提醒而不是绝对停止）而不是更改 fla 文件添加具有替换功能的新文件，而是在提交期间添加关于如何将这些更改包含在主文件中的注释.fla 文件。

将 fla 文件拆分为多个较小的文件，以便您可以更轻松地隔离更改。

确保 fla 文件的提交始终伴随着描述更改内容的良好提交消息。

尽可能多地移出 fla —— 图像可以使用代码嵌入，当然源代码不应该在 fla 中。

确保团队中的每个人都知道颠覆和二进制文件的问题。

它并不完美，但这将使它在一定程度上易于管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-09T22:50:16.387

我必须同意 Simon 的观点——仔细的评论和手动合并是保持它与其他 SVN 或 CVS 文件的唯一方法。Version Cue 是不够的。

我的理解是，Version Cue 是一个功能齐全的版本控制，它执行非常适合媒体文件的文件锁定（仅存储对文件的更改以实现更有效的存储、排名、大量缩略图等......）。我在文档中没有看到任何关于合并版本的内容（只是文件不同）。事实上，我看到的文档（[http://www.scribd.com/doc/7868549/Using-Adobe-Bridge-and-Adobe-Version-Cue-CS4](http://www.scribd.com/doc/7868549/Using-Adobe-Bridge-and-Adobe-Version-Cue-CS4)）说您可以放弃您的编辑或其他用户的编辑，这意味着没有合并。唯一比没有好一点的是，您可以直接在 Flash 中打开以前的版本进行手动合并。

并发工作失败。******