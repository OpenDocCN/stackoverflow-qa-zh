# StackOverflow 问答 10770000-10770999

# python-2.7 - 需要帮助安装 Biopython

> ID：10770000
> 
> 赞同：2
> 
> 时间：2012-05-26T21:40:18.940
> 
> 标签：python-2.7, biopython

安装了 mac OS 10.6 并安装了 python 版本 2.7 32 位以及 numpy 和 scipy。还有xcode 3.2版，我真的很困惑此时该做什么。我下载了 biopython 1.59 版并尝试在 python 中运行设置代码，但它不会工作。我错过了什么？

当我尝试在空闲状态下运行安装文件时，我收到以下错误消息：

```
Traceback (most recent call last):
File "/Users/Cliff/Downloads/biopython-1.58/setup.py", line 379, in <module>
'Bio.PopGen': ['SimCoal/data/*.par'],
File   "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/core.py", line    140, in setup
raise SystemExit, gen_usage(dist.script_name) + "\nerror: %s" % msg
SystemExit: usage: setup.py [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]
or: setup.py --help [cmd1 cmd2 ...]
or: setup.py --help-commands
or: setup.py cmd --help

error: no commands supplied 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T21:54:17.310

您需要`python setup.py install`从 Terminal.app 运行。您应该在 bash、tcsh 等 shell 中，而不是在 Python shell 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T21:56:24.193

该错误表明您没有向安装脚本提供命令。通常的命令是“安装”，所以试试：

```
python setup.py install 
```

无论如何，正如错误所暗示的那样，您可以使用：

```
python setup.py --help 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-28T10:25:39.560

就像一个可能更简单的选择：Biopython 也可以通过 pip 获得：

```
pip install biopython 
```

或者（甚至更好）通过 bioconda（试试看，很棒）：

```
conda install biopython 
```

[为此，只需从此处](https://conda.io/miniconda.html)安装 miniconda（非常简单且不需要管理员权限）。然后按照[这些简单的说明](https://bioconda.github.io/http://)添加 bioconda 通道。

奇怪的是 biopython 教程中缺少这两个简单的选项

# asp.net - ASP.NET 不在页面中显示 eval - ASPxGridView

> ID：10770001
> 
> 赞同：0
> 
> 时间：2012-05-26T21:40:33.233
> 
> 标签：asp.net, aspxgridview

我希望有一个简单的问题。我有一个 ASPxGridView，我需要从中提取数据并将其传递给函数。我想这样做的一个简单方法是使用会话变量。

但是当我进行 Eval 绑定时，它会在屏幕上显示字符（以及将它们放入变量中）。如何从屏幕上删除字符？或者也许有更简单的方法来做到这一点。

代码在这里（真正的肉是第 4 行）：

```
 <dx:GridViewDataButtonEditColumn Caption="" Name="Schedule" 
            VisibleIndex="11">
            <DataItemTemplate>
             <%# Session["PatientID"] = Eval("PatientID")%>
                  <dx:ASPxButton ID="ASPxButton1"  runat="server" Text="Schedule"  OnClick="Button_Click" >
                  </dx:ASPxButton>
            </DataItemTemplate>

        </dx:GridViewDataButtonEditColumn> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T21:54:05.343

尝试放置一个隐藏字段并绑定其值，如下所示

```
<asp:HiddenField ID="hdnPatientID" runat="server" Value='<%# Eval("PatientID")%>' /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:04:02.387

试试这个

```
 <dx:GridViewDataButtonEditColumn Caption="" Name="Schedule" VisibleIndex="11">
     <DataItemTemplate>
       <dx:ASPxButton ID="ASPxButton1"  
        runat="server" Text="Schedule"  
        OnClick="Button_Click" 
        CommandName='SomeCoolCommandName' 
        CommandArgument='<%#Eval("PatientID")'>
       </dx:ASPxButton>
      </DataItemTemplate>
 </dx:GridViewDataButtonEditColumn> 
```

在它上面 rowcommand 或 Itemcommand 事件检查命令并做一些事情..

```
protected YourGrid_ItemCommand(sender, e)
{
   if(e.CommandName.Equals("SomeCoolCommandName"))
   {
       var id = Convert.ToInt32(e.CommandArgument); // Give you your Patient ID
       // do whatever you want to do with your ID
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T10:12:56.290

我在这里添加功能代码。谢谢大家！使用命令效果很好。

```
protected void Button_Click(object sender, CommandEventArgs e)
{
    string patID = e.CommandArgument.ToString();
    Response.Redirect("schedule.aspx?PatientID=" + patID);
}

    <dx:GridViewDataButtonEditColumn Caption="" Name="Schedule" 
        VisibleIndex="11">
        <DataItemTemplate>
            <dx:ASPxButton ID="ASPxButton1"  runat="server" Text="Schedule"  
CommandName = "PatientID" CommandArgument = '<%# Eval("PatientID")%>' OnCommand="Button_Click" >
                </dx:ASPxButton>
            </DataItemTemplate>
        </dx:GridViewDataButtonEditColumn> 
```

# php - 带有 Codeigniter 和 Ci-Smarty“不可调用”错误的 Smarty 输出过滤器

> ID：10770002
> 
> 赞同：1
> 
> 时间：2012-05-26T21:40:35.417
> 
> 标签：php, codeigniter, smarty, codeigniter-2, smarty3

我目前正在使用带有 ci-Smarty 的 codeigniter 2。只是试图添加一个聪明的输出过滤器，但运气不佳。好像找不到功能还是什么？

我使用插件作为输出过滤器功能，并具有以下代码：

**位置：** /libraries/Smarty.php

```
// Set email output filter
$this->loadFilter('output', 'protect_email'); 
```

**位置：** /third_party/Smarty/plugins/function.protect_email.php

```
function smarty_function_protect_email($tpl_output, Smarty_Internal_Template $template)
{
    $tpl_output =
       preg_replace('!(\S+)@([a-zA-Z0-9\.\-]+\.([a-zA-Z]{2,3}|[0-9]{1,3}))!',
                    '$1%40$2', $tpl_output);
    return $tpl_output;
} 
```

以上似乎引发了以下聪明错误：

> 致命错误：在 /home/something/public_html/application/third_party/Smarty/sysplugins/smarty_internal_templatebase.php:717 中包含消息“outputfilter“protect_email”不可调用的未捕获异常“SmartyException”：717 堆栈跟踪：#0 /home/something/public_html /application/libraries/Smarty.php(46): Smarty_Internal_TemplateBase->loadFilter('output', 'protect_email') #1 /home/something/public_html/system/core/Loader.php(1095): CI_Smarty->__construct(数组）#2 /home/something/public_html/system/core/Loader.php(975): CI_Loader->_ci_init_class('Smarty', '', NULL, NULL) #3 /home/something/public_html/system/core /Loader.php(216): CI_Loader->_ci_load_class('smarty', NULL, NULL) #4 /home/something/public_html/application/libraries/MY_Parser.php(29):CI_Loader->library('smarty') #5 /home/something/public_html/system/core/Loader.php(1099): MY_Parser->__construct() #6 /home/something/public_html/system/core/Loader. php(938): CI_Loader->_ci_init_class('Parser', 'MY_', NULL, NULL) #7 /home/something/public_html/system/core/Loader.php(216): CI_Loa in /home/something/public_html /application/third_party/Smarty/sysplugins/smarty_internal_templatebase.php 在第 717 行/home/something/public_html/application/third_party/Smarty/sysplugins/smarty_internal_templatebase.php 中的 CI_Loa 位于第 717 行/home/something/public_html/application/third_party/Smarty/sysplugins/smarty_internal_templatebase.php 中的 CI_Loa 位于第 717 行

抱歉拖了这么久！只是认为看到整个错误可能会有所帮助。

非常感谢阅读，希望有人能提供帮助。

--> EDIT 还尝试使用以下命令显式设置插件目录位置：

```
$this->setPluginsDir(config_item('plugin_directory')); 
```

回显出正确的位置但仍然遇到同样的问题:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T22:10:09.777

好吧，这是一个愚蠢的错误。

对于其他有同样问题的人，我只是在查看并意识到插件不应该被称为常规功能。例如，它应该被称为：

```
outputfilter.protect_email.php 
```

还要对函数名称进行相同的修改，所以在我的情况下，它应该被调用：

```
smarty_outputfilter_protect_email 
```

这对我很有用。

# java - 使用不同唯一 ID 的每个线程的性能改进

> ID：10770003
> 
> 赞同：0
> 
> 时间：2012-05-26T21:40:50.970
> 
> 标签：java, multithreading, threadpool, executor

***问题陈述是：-***

**每个线程使用 1 到 1000 之间的唯一 ID，并且程序必须运行 60 分钟或更长时间，所以在那 60 分钟内，所有 ID 都可能完成，所以我需要再次重用这些 ID，**

我知道几种方法，一种方法是我在 StackOverflow 的帮助下编写的下面的方法，但是当我尝试运行它时，我发现，在运行几分钟后，这个程序变得非常慢并且需要很多时间是时候在控制台上打印 ID。而且我有时也会遇到 OutOfMemory 错误。有没有更好的方法来解决这类问题？

```
class IdPool {
    private final LinkedList<Integer> availableExistingIds = new LinkedList<Integer>();

    public IdPool() {
        for (int i = 1; i <= 1000; i++) {
            availableExistingIds.add(i);
        }
    }

    public synchronized Integer getExistingId() {
        return availableExistingIds.removeFirst();
    }

    public synchronized void releaseExistingId(Integer id) {
        availableExistingIds.add(id);
    }
}

class ThreadNewTask implements Runnable {
    private IdPool idPool;

    public ThreadNewTask(IdPool idPool) {
        this.idPool = idPool;
    }

    public void run() {
        Integer id = idPool.getExistingId();
        someMethod(id);
        idPool.releaseExistingId(id);
    }

    private void someMethod(Integer id) {
        System.out.println("Task: " +id);
    }
}

public class TestingPool {
    public static void main(String[] args) throws InterruptedException {
        int size = 10;
        int durationOfRun = 60;
        IdPool idPool = new IdPool();   
        // create thread pool with given size
        // create thread pool with given size
    ExecutorService service = new ThreadPoolExecutor(size, size, 500L, TimeUnit.MILLISECONDS, new ArrayBlockingQueue<Runnable>(10), new ThreadPoolExecutor.CallerRunsPolicy()); 

        // queue some tasks
        long startTime = System.currentTimeMillis();
        long endTime = startTime + (durationOfRun * 60 * 1000L);

        // Running it for 60 minutes
        while(System.currentTimeMillis() <= endTime) {
            service.submit(new ThreadNewTask(idPool));
        }

        // wait for termination        
        service.shutdown();
        service.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS); 
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T21:48:15.037

我已经在您之前的问题中向您解释过，您的代码向执行程序提交了数百万个任务，因为它在 60 分钟内循环提交任务，无需等待。

目前还不清楚您的最终目标是什么，但实际上，您正在填充任务队列，直到您不再有任何可用内存。由于您没有解释程序的目标，因此很难为您提供任何解决方案。

但是您可以做的第一件事是限制执行程序的任务队列的大小。这将强制主线程在每次队列已满时阻塞。

# imagemagick - 用于 MIPS 架构的 ImageMagick “导入”工具

> ID：10770008
> 
> 赞同：0
> 
> 时间：2012-05-26T21:41:23.667
> 
> 标签：imagemagick, mips

有一个我想让 ImageMagick 命令行工具“导入”工作的数字媒体设备。尝试从其他系统运行二进制文件会出现“无法执行二进制文件”错误，因为架构不同（我猜）。

我如何让这个工具在这个 MIPS 架构上运行 - 设备上没有编译器或包管理器。

最终目标是在任何给定时间使用导入来截取附加显示器上的内容。

**unname -a**

```
Linux 4310 2.6.22.19-27-sigma #2 PREEMPT Mon May 16 01:03:35 PDT 2011 mips GNU/Linux 
```

**更多 /proc/cpuinfo**

```
system type                : Sigma Designs TangoX
processor                : 0
cpu model                : MIPS 74K V4.9  FPU V0.0
Initial BogoMIPS        : 330.13
wait instruction        : yes
microsecond timers        : yes
tlb_entries                : 32
extra interrupt vector        : yes
hardware watchpoint        : yes
ASEs implemented        : mips16 dsp
shadow register sets        : 1
VCED exceptions                : not available
VCEI exceptions                : not available
System bus frequency        : 330750000 Hz
CPU frequency                : 661500000 Hz
DSP frequency                : 330750000 Hz 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T21:48:42.700

是的，Mips 有完全不同的指令集。

最好的办法是使用交叉编译器并在普通的 Linux 或 Windows 开发系统上编译程序。您可以从头构建 gcc 作为 Mips 的交叉编译器，或者您可能会找到可下载的 Mips 预编译编译器。

这将让您在开发系统上编译源代码。当然，如果您尝试在那里运行二进制文件，您会得到“无法执行二进制文件”。

[您可以在http://ellcc.org/demo](http://ellcc.org/demo)上比较 Mips 和 x86 编译并查看汇编语言差异

# c++ - std::vector 在代码拆分后无法引用要推入的对象

> ID：10770011
> 
> 赞同：0
> 
> 时间：2012-05-26T21:41:57.570
> 
> 标签：c++, std, stdvector

编辑：在我的代码的这个版本中，aList 被作为指针引用，但在我的当前版本中没有，它仍然存在同样的问题。

在尝试将其拆分为接口文件和实现文件之前，我让这段代码完美运行。但是当我拆分它时，编译器告诉我我正在使用不正确的参数调用 push_back()。所以我知道它不能引用我正在推动它的对象的类型，尽管它是相同的（afaik，当然：D）。

```
#ifndef _MYHEADER_HPP_
#define _MYHEADER_HPP_
class A{
public:
    std::string someString;
};

class B{
public:
    std::vector<A> aList;
public:
    void addA();
};

#endif /* _MYHEADER_HPP_ */

//implementation file

#include <string>
#include <vector>
#include "myheader.hpp"

void B::addA(){
    A a;
    a.someString = "Hola";
    // Here compiler says : Invalid arguments 'Candidates are: void push_back(const A &)' line 18 Semantic Error
    aList.push_back(a);
} 
```

AFAIK，std::vector 总是做一个对象的副本来推送，并且该副本被存储到向量中，所以我认为这不是“a”被堆栈分配的问题，对吗？

我做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T22:57:59.447

好的，在寻找问题的根源 3 个多小时后，我发现 Eclipse CDT IDE 有一个关于我的代码的损坏的缓存文件。所以，从命令行编译一切都很好，我不得不删除那个缓存文件，然后 Eclipse 没有报告任何错误。

# java - Android SDK 突然停止工作

> ID：10770012
> 
> 赞同：6
> 
> 时间：2012-05-26T21:42:26.523
> 
> 标签：java, android, windows, sdk, 64-bit

在没有开发 Android 的几个月后，我昨天运行了 SDK Manager，并从 r16 升级到了 r18。升级后，一切都停止了。我从 Google 下载了 SDK 工具的新副本。Windows 安装程序抱怨没有安装 Java（[这里](https://stackoverflow.com/questions/4382178/android-sdk-installation-doesnt-find-jdk)的解决方案，以前可以工作，现在不起作用）。

我下载了 ZIP 文件并将其放在正确的位置。运行`SDK Manager.EXE`什么都不做（它只是立即返回到命令提示符）。运行 tools\android.bat 会显示错误提示“无法将路径转换为短 DOS 路径：c:\windows\system32\java.exe”，然后建议我安装 Java。

我正在运行 Windows 7 64 位，并正确安装了 Java 1.7（64 位）（Eclipse 运行良好，Android 工具 r16 运行良好，直到昨天）。c:\windows\system32\java.exe 存在并且可以正常工作。

我究竟做错了什么？

更新：我发现了一个旧的 r16 设置。我安装了它，一切恢复正常。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-12T08:26:19.067

我把这个放在一边一段时间，但现在我必须让它重新运行。我不想在我拥有的 64 位 Java VM 旁边安装 32 位 Java VM。

我找到了罪魁祸首。里面有`android_sdk\tools\lib`一个名为`find_java.bat`. 它调用`find_java.exe -s`以查找潜在 Java 位置的列表。像这样运行 exe 文件会返回我一直看到的错误：

```
Failed to convert path to short DOS path: c:\windows\system32\java.exe 
```

-s 代表缩写。在没有 -s 的情况下运行它会导致 find_java.exe 工作，导致 find_java.bat 工作，导致其他一切工作。所以修复是编辑 find_java.bat，并删除 -s 。

老实说，我不知道谷歌在想什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T18:15:01.720

我的解决方法是从我的 JAVA_HOME 中删除 /bin，如 C:\Java\jdk1.6.0_26\bin --> C:\Java\jdk1.6.0_26\

我在 W7 上运行 64 位 java。

这个谷歌问题很有帮助： [http ://code.google.com/p/android/issues/detail?id=23648](http://code.google.com/p/android/issues/detail?id=23648)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-26T21:50:19.373

这只是一个猜测，但我建议你安装 JDK 6。在[SDK 要求](http://developer.android.com/sdk/requirements.html)中说你必须使用它。我记得我安装了 JDK 7，但我也遇到了一些麻烦。

此外，使用 32 位版本更安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-26T21:50:29.180

您还需要通过 Help > Install New Software 更新 Eclipse 插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-06T15:10:15.820

通过将 jdk 路径添加到环境变量中的 PATH 变量，我能够解决同样的问题。

# javascript - jquery函数消耗数组

> ID：10770015
> 
> 赞同：0
> 
> 时间：2012-05-26T21:42:38.553
> 
> 标签：javascript, jquery, arrays, variables

我不太明白我写的函数有什么问题，

当我将数组传递给它时，例如：

```
var pvars=['health/1/1.jpg','health/1/2.jpg','health/1/3.jpg','health/1/4.jpg'];
cache_threads(pvars,1); 
```

然后我得到一个空变量，例如：

```
alert(pvars); 
```

返回一个空字符串。

这是我的功能：

```
var cache_threads=function (arruy,quant){
    if (quant==undefined) quant=1;
var div=Math.ceil(arruy.length/quant);
var a = arruy;
while(a.length) {
    cache_bunch(a.splice(0,div));
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T21:44:10.233

`a`并且`arruy`是*同一个数组*。

当你`.splice`一个人时，你也会拼接另一个人！

如果您想要数组的（浅）*副本*`.slice()`，请使用：

```
var a = arruy.slice(0); 
```

# xml - 有条件地删除部分 XML 文件

> ID：10770018
> 
> 赞同：1
> 
> 时间：2012-05-26T21:42:53.403
> 
> 标签：xml, awk

我正在寻找这个问题的解决方案，并且怀疑 awk 应该提供一个足够简单的解决方案，而不是我笨拙的 shell 脚本。

我有一个由多个部分组成的 xml 文件，如下所示。我还有一个值列表。

`<top_tag> ... </top_tag>`对于value_x 在我的列表中的每个部分，删除（即：不打印）该部分`<top_tag> ... </top_tag>`

```
<xml>
<outer_tag>
   <top_tag>
      <tag>value_1</tag>
      <other_tags></other_tags>
   </top_tag>
   <top_tag>
      <tag>value_2</tag>
      <other_tags></other_tags>
   </top_tag>
    ...
   <top_tag>
      <tag>value_n</tag>
      <other_tags></other_tags>
   </top_tag>
</outer_tag> 
```

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T21:50:49.403

您在这里需要的不是 awk，而是专门为此类任务创建的 XSLT。它使您可以将 xml 文档转换为不同的 xml。

对于像您这样的输入：

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="example.xsl"?>
<outer_tag>
   <top_tag>
      <tag>value_1</tag>
      <other_tags></other_tags>
   </top_tag>
   <top_tag>
      <tag>value_2</tag>
      <other_tags></other_tags>
   </top_tag>
   <top_tag>
      <tag>value_3</tag>
      <other_tags></other_tags>
   </top_tag>
   <top_tag>
      <tag>value_n</tag>
      <other_tags></other_tags>
   </top_tag>
</outer_tag> 
```

下面的 XSLT通过简单地不复制它们并忽略它们的内容来删除所有`top_tag`元素。`value_3`

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="*">
        <xsl:element name="{name()}">           
            <xsl:apply-templates select="child::node()"></xsl:apply-templates>
        </xsl:element>
    </xsl:template>

    <xsl:template match="top_tag[tag = 'value_3']">     
    </xsl:template>
</xsl:stylesheet 
```

每种主要的编程语言都至少有几个库可以根据 XSLT 处理 XML 输入。命令行工具和基于 UI 的应用程序（IDE，但不仅限于这些）也可以做到这一点。最后，如果您在 xsl 文件中包含如下处理指令，则 Web 浏览器可以使用 XSLT 转换文件：

```
<?xml-stylesheet type="text/xsl" href="example.xsl"?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T00:37:33.840

这可能对您有用：

```
 sed -i '/<top_tag>/,/<\/top_tag>/!b;/<top_tag>/{h;d};H;/<\/top_tag/!d;x;/<tag>value.*<\/tag>/d' file 
```

# c++ - c++文本框不允许你输入

> ID：10770019
> 
> 赞同：2
> 
> 时间：2012-05-26T21:42:53.900
> 
> 标签：c++, winapi

我正在创建一个简单的聊天程序，客户端可以在其中向服务器发送消息，该服务器显示收到的消息。出于某种原因，即使文本框未设置为只读，我也无法输入。如果没有我发布整个代码，任何人都可以看到简单的错误吗？这是我创建文本框的地方：

```
static HWND text;

switch(msg)
{
    case WM_CREATE:
    {
        text = CreateWindow(TEXT("Edit"), TEXT("Enter text here..."),
                     WS_VISIBLE | WS_CHILD | WS_BORDER,
                     0, 0, 300, 25,
                     hwnd, (HMENU) ID_EDIT, NULL, NULL);

        CreateWindow(TEXT("Button"), TEXT("Post"),
                     WS_VISIBLE | WS_CHILD,
                     310, 0, 70, 25,
                     hwnd, (HMENU) ID_POST, NULL, NULL);

        CreateWindow(TEXT("Button"), TEXT("Connect"),
                     WS_VISIBLE | WS_CHILD,
                     0, 35, 70, 25,
                     hwnd, (HMENU) ID_CONNECT, NULL, NULL);

        break;
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-26T21:56:43.707

运用我的精神力量，我会说您在 main 函数中编写了自己的消息循环，并且您没有调用`TranslateMessage()`.

函数[`TranslateMessage()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644955%28v=vs.85%29.aspx)负责将关键消息转换为字符消息（不，这不是自动完成的:-)。最终结果是您的 EDIT 窗口（所有窗口）都没有收到`WM_CHAR`消息。

所以你的消息循环至少应该有这样的东西：

```
MSG msg;
while (GetMessage(&msg))
{
    TranslateMessage(&msg);
    DispatchMessage(&msg);
} 
```

# jquery - YouTube HTML5 嵌入代码适用于桌面，但不适用于 iOS

> ID：10770020
> 
> 赞同：2
> 
> 时间：2012-05-26T21:43:02.110
> 
> 标签：jquery, ios, html, youtube, mobile-safari

我已使用此页面中的 HTML5 嵌入代码：http: [//apiblog.youtube.com/2010/07/new-way-to-embed-youtube-videos.html](http://apiblog.youtube.com/2010/07/new-way-to-embed-youtube-videos.html)

```
<iframe class="youtube-player" type="text/html" width="640" height="385" src="http://www.youtube.com/embed/VIDEO_ID" frameborder="0">
</iframe> 
```

在代码中我这样使用它：

```
var str = 'http://www.youtube.com/v/' + videoid + '&rel=0&autoplay=' + autoplay;
var $video = $("<iframe class=\"youtube-player\" type=\"text/html\" width=\"297\" height=\"249\" src=\"" + str + "\" frameborder=\"0\"></iframe>");
$("#"+elemid).html($video);

} 
```

在所有桌面浏览器中都很好用，但在我的 iPad 上却不行。在 iPad 上没有任何反应，我不知道为什么。**当我在不使用 jQuery 插入的情况下直接嵌入代码时，该视频确实可以在 iPad 上运行**。

**编辑：http:** [//jsfiddle.net/gGby6/](http://jsfiddle.net/gGby6/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:54:59.240

按照教程，

`http://www.youtube.com/v/...`

应该

`http://www.youtube.com/embed/...`

这在 Mobile Safari (iOS 5.1.1) 上得到确认。

# javascript - 可点击图像的事件处理程序

> ID：10770032
> 
> 赞同：1
> 
> 时间：2012-05-26T21:46:45.493
> 
> 标签：javascript, jquery, javascript-events, event-handling

我有这个功能，当点击链接时会执行。但这似乎有问题。当我对同一个链接使用一些文本时。该功能似乎执行得很好。但是，当我将图像放在同一个地方时。事件处理函数似乎不起作用。

我为此创建了一个小提琴：http: [//jsfiddle.net/bkvirendra/5QqUB/](http://jsfiddle.net/bkvirendra/5QqUB/)

单击链接时，将显示 ul 列表。当用户点击任何地方而不是链接时，ul 列表就会消失。因此，当我放置图像而不是文本时，它似乎不起作用！单击图像时如何显示相同的 ul 列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T21:50:52.637

问题是当你点击图片时，事件目标变成了`img`标签，而不是`a`标签。

试试这个：

```
$(".item").hide();
$("#a").click(function(e) {
    e.stopPropagation();
    $(".item").show();
});

$(document).click(function() {
    $(".item").hide();
}); 
```

[**示例小提琴**](http://jsfiddle.net/5QqUB/1/)

您还应该考虑删除该`$(".item").hide()`行并`display: none`改为在 CSS 中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T21:51:31.870

发生这种情况是因为`e.target`返回了单击的元素，所以它返回了图像。试试这个代码：

```
$("html").click(function(e) {
    if (e.target == document.getElementById("a") || e.target.nodeName=='IMG') {
        $(".item").show();
        //alert(1);
    } else {
        $(".item").hide();
        //alert(2);
    }
});​ 
```

# php - htaccess 具有不同数量的变量

> ID：10770035
> 
> 赞同：1
> 
> 时间：2012-05-26T21:48:07.817
> 
> 标签：php, .htaccess, variables, get, rewrite

我有一个网站，在一个特定页面上它需要一个额外的变量。

目前，我使用的 htaccess 是：

```
RewriteEngine On
RewriteRule ^([^/]*)/$ /index.php?page=$1 [L] 
```

这适用于一个变量。

我将如何使用它： [http ://tessite.com/index.php?page=test&id=1](http://tessite.com/index.php?page=test&id=1)

所以它看起来像： [http ://tessite.com/test/1](http://tessite.com/test/1)

感谢您的任何帮助或回复。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-26T21:53:41.963

它可以这样编码：

```
RewriteRule ^([^/]*)/([^/]*)/$ index.php?page=$1&id=$2 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T21:49:57.173

```
RewriteEngine On
RewriteRule ^(.*)/(.*)/$ /index.php?page=$1&id=$2 [L]
RewriteRule ^(.*)/$ /index.php?page=$1 [L] 
```

只需添加`$2`！

此外，`[^/]`不是必需的，您可以简单地使用`.`.

# android - Android Text 函数强制关闭 rand 问题

> ID：10770037
> 
> 赞同：-1
> 
> 时间：2012-05-26T21:48:22.790
> 
> 标签：android, random, arraylist, forceclose

在上一次修复之后，我现在有一个新问题。有人建议提出一个新问题，所以就在这里！它仍然强制关闭，但现在在一条新线上。

```
public void AI(String text) {
    // initiate new lists to be on the safe side
    List<String>    indexer = new ArrayList<String>();
    List<String>    sentence = new ArrayList<String>();
    List<String>    explode = new ArrayList<String>();
    List<String>    ary = new ArrayList<String>(); 

    explode = Arrays.asList(text.split(" "));  

    // initiate randint and trigger variable
    Random rand = new Random();
    int randint = rand.nextInt(explode.size());

    // initiate the trigger variable
    String trigger = explode.get(randint); 

    //check if word exists in database and add if it not.
    int i = 0;
    for(String word : explode) {
        if(common.get(word) == null) {
            words.add(word);
            common.put(word, 1);
            context.put(word, explode);
            pos.put(word, i);
            length.put(word, explode.size());

            if(word.equals(trigger)) {
                ary = new ArrayList<String>(explode);
            }
        }else{

            common.put(word, common.get(word)+1 );  
        }

        i++;
    }

    // fill the arraylist sentence with words to be used, some in context, some random from the database.
    for(int i2 = 0; i2 < length.get(trigger); i2++ ) {

        randint = rand.nextInt(length.get(trigger));

        if(randint < length.get(trigger)/2) {
            //
            if(ary.get(i2)!=null) {
                sentence.add(ary.get(i2));
            }
        }else{
            sentence.add(words.get(rand.nextInt(words.size())));
        }

    }    

    // use to the pos-hashmap to check at which index the word was detected at, if not  place it at the deliberate index.
    for(int i3 = 0; i3 < sentence.size(); i3++) {
        if(sentence.get(i3)!=null) {    
            indexer.add(pos.get(sentence.get(i3)),   sentence.get(i3)); 
        }
    }

    // compose the final string that is to be passed to the speak function
    for(int i4 = 0; i4 < indexer.size(); i4++) {
        say = say + indexer.get(i4)+" ";    
    }   

    // pass the string to the speak function
    mTts.speak(say, TextToSpeech.QUEUE_FLUSH, null);     

    // removing final string to be ready for next iteration
    say = "";

    // end of AI stuff          
} 
```

变量：

```
 // arraylists
public List<String> explode = new ArrayList<String>();
public List<String> words = new ArrayList<String>();
public List<String> sentence = new ArrayList<String>();
public List<String> indexer = new ArrayList<String>();
// hashmaps
public Map<String, Integer> common = new HashMap<String, Integer>();
public Map<String, List<String>> context = new HashMap<String, List<String>>();
public Map<String, Integer> pos = new HashMap<String, Integer>();
public Map<String, Integer> length = new HashMap<String, Integer>();
 //strings
    public String say; 
```

和logcat：

```
05-26 19:24:42.926: W/dalvikvm(543): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
05-26 19:24:42.926: E/AndroidRuntime(543): Uncaught handler: thread main exiting due to uncaught exception
05-26 19:24:42.956: E/AndroidRuntime(543): java.lang.IndexOutOfBoundsException: Invalid location 0, size is 0
05-26 19:24:42.956: E/AndroidRuntime(543):  at java.util.ArrayList.get(ArrayList.java:341)
05-26 19:24:42.956: E/AndroidRuntime(543):  at sarah.namespace.SarahActivity.AI(SarahActivity.java:186) 
```

第二个日志：

```
 05-26 21:38:44.555: W/dalvikvm(571): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
05-26 21:38:44.555: E/AndroidRuntime(571): Uncaught handler: thread main exiting due to uncaught exception
05-26 21:38:44.575: E/AndroidRuntime(571): java.lang.IndexOutOfBoundsException
05-26 21:38:44.575: E/AndroidRuntime(571):  at java.util.ArrayList.add(ArrayList.java:145)
05-26 21:38:44.575: E/AndroidRuntime(571):  at sarah.namespace.SarahActivity.AI(SarahActivity.java:188) 
```

日志猫在尖叫什么：

第一的：

```
sentence.add(words.get(rand.nextInt(words.size()))); 
```

第二：

```
for(int i3 = 0; i3 < sentence.size(); i3++) {
                                            if(sentence.get(i3)!=null) {    
                                            indexer.add(pos.get(sentence.get(i3)), sentence.get(i3));   
                                                                       }
                                            } 
```

如果有人能帮助我再次破解这个谜题，我会非常高兴！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T22:00:19.383

嗯，我不确定哪一行是 186 和 188（这两条会引发 OutOfBounds 异常）。但看看这个循环，我有一些建议：

```
for(int i2 = 0; i2 < length.get(trigger); i2++ ) { 
```

从上面我们注意到它`length.get(trigger)`总是设置为`explode.size()`，我们可以看到它`explode.size()`永远不会改变。我们可以`explode.size()`改为检查或再次使用 for-each 循环。进行：

```
 randint = rand.nextInt(length.get(trigger));

    if(randint < length.get(trigger)/2) { 
```

这看起来像你想要一个 50/50 的机会：将原始单词添加到`sentence`或

```
 if(ary.get(i2)!=null) {
            sentence.add(ary.get(i2));
        }
    }else{
        sentence.add(words.get(rand.nextInt(words.size())));
    }
} 
```

... 一个随机词`sentence`。

我也相信这可能会引发异常：

```
 if(ary.get(i2)!=null) {
            sentence.add(ary.get(i2)); 
```

`i2`因为您正在检查反对`length.get(trigger)`not的有效性`ary.size()`。现在请记住，这`ary`只是`explode`.

所以让我们把这个循环压缩成：

```
for(String word : explode) {
    if(rand.nextInt(1)) // 50/50 chance of being false or true (0 or 1)
        sentence.add(word);
    else
        sentence.add(words.get(rand.nextInt(words.size())));
} 
```

看看剩下的两个循环，如果你应用一个类似的 for-each 循环，你也可以压缩和加速这些循环。我不知道应用程序的其余代码，但您也许可以完全删除一些列表和地图。干杯!

# c# - 如何获得在给定时间内发送超过 X 个数据包的 IP

> ID：10770038
> 
> 赞同：0
> 
> 时间：2012-05-26T21:48:32.323
> 
> 标签：c#, .net, datetime, winpcap, sharppcap

我有一个 C# 程序，可以检测任何给定以太网设备上的传入 TCP/IP 数据包。每个数据包都在以下结构中处理：

```
struct Packet{
   String sourceIp;
   DateTime arrivalDate;
} 
```

如果我有每个传入数据包的列表（列表），我如何在不到 Y 秒（比如 1 秒）内获得超过 X 个数据包的那些 IP？

我不知道如何解决这个问题，任何帮助/提示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:04:25.493

使用 Linq，它将是这样的：

```
 List<Packet> allPackets =
     new List<Packet>
        {
           new Packet {arrivalDate = DateTime.Parse("2000-01-01 0:00:00"), sourceIp = "a"},
           new Packet {arrivalDate = DateTime.Parse("2000-01-01 0:00:01"), sourceIp = "a"},
           new Packet {arrivalDate = DateTime.Parse("2000-01-01 0:00:01"), sourceIp = "a"},
           new Packet {arrivalDate = DateTime.Parse("2000-01-01 0:01:00"), sourceIp = "a"},
           new Packet {arrivalDate = DateTime.Parse("2000-01-01 0:00:00"), sourceIp = "b"},
           new Packet {arrivalDate = DateTime.Parse("2000-01-01 0:01:00"), sourceIp = "b"},
           new Packet {arrivalDate = DateTime.Parse("2000-01-01 0:02:00"), sourceIp = "b"},
           new Packet {arrivalDate = DateTime.Parse("2000-01-01 0:03:00"), sourceIp = "b"},
        };
  var xPackets = 2;
  var interval = TimeSpan.FromSeconds(15);

  // We group all the packets by ip, then within that, order the packets by date.
  var ips =
     allPackets
        .GroupBy(
           p => p.sourceIp,
           (ip, packets) => new
                                {
                                   ip,
                                   packets = packets.OrderBy(p => p.arrivalDate).ToList()
                                })
        .ToList();
  // Build a list of IPs with at least x packets in y interval.
  var rapidIps = new List<string>();
  foreach (var ipPacket in ips)
  {
     for (int i = 0, j = xPackets; j < ipPacket.packets.Count; i++, j++)
     {
        if (ipPacket.packets[i].arrivalDate + interval >= ipPacket.packets[j].arrivalDate)
        {
           rapidIps.Add((ipPacket.ip));
           break;
        }

     }
  } 
```

最后，`rapidIps`包含`[a]`.

# c++ - 为什么 C 样式转换允许您转换为私有基类？

> ID：10770044
> 
> 赞同：10
> 
> 时间：2012-05-26T21:50:00.607
> 
> 标签：c++, class, casting, upcasting

假设我们有这个代码

```
class A {
public:
    A() : x(1) {}
    virtual ~A() {}

    int x;
};

class B {
public:
    B() : y(2) {}
    virtual ~B() {}

    void g()
    {
        cout << "B::" << y << endl;
    }

    int y;
};

class C : private A, private B {
public:
    void f()
    {
        B* p = static_cast<B*>( this );
        p->g();
    }
};

int main()
{
    C c;
    ((B*)&c)->g();

    return 0;
} 
```

main 函数中的 C 风格转换不能正确地用 C++ 转换 ( `static_cast`, `dynamic_cast`, `reinterpret_cast`) 表示。但是首先允许这样做的原因是什么？它不会伤害封装吗？

**更新** 这不是链接问题的重复，因为这个问题是关于 C++ 中的设计决策。它不问我能用这种语言做什么或不能做什么，它问为什么会做出某些决定。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-26T21:52:15.970

当在指向基类和派生类的指针之间使用 C 风格的指针转换时，它的行为类似于`static_cast`- 即使基类是私有的。

（不相关的指针类型之间的 C 风格转换是`reinterpret_cast`s）。

该标准说：

> 执行的转换
> 
> — 一个 const_cast (5.2.11)，
> 
> — 一个 static_cast (5.2.9)，
> 
> — 一个 static_cast 后跟一个 const_cast，
> 
> — reinterpret_cast (5.2.10)，或
> 
> — reinterpret_cast 后跟 const_cast，
> 
> 可以使用显式类型转换的强制转换表示法来执行。相同的语义限制和行为适用，但在以下情况下执行 static_cast 时，**即使基类不可访问，转换也是有效的**：
> 
> — 指向派生类类型对象的指针或派生类类型的左值或右值可以分别显式转换为指向明确基类类型的指针或引用；
> 
> — 指向派生类类型成员的指针可以显式转换为指向明确的非虚拟基类类型成员的指针；
> 
> — 指向明确非虚拟基类类型对象的指针、明确非虚拟基类类型的左值，或指向明确非虚拟基类类型成员的指针可以显式转换为指针，引用或指向派生类类型成员的指针。

您的情况在第一点中描述，因此转换完成`static_cast`并调整指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T21:55:30.823

这是因为在 C 中，允许使用此强制转换将任何指针转换为任何其他指针，并且 C++ 尝试尽可能地与 C 兼容，但在涉及到类时试图做好正确的工作，所以 C 风格cast 比`reinterpret_cast`这种情况下要强。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-26T21:52:35.377

C 风格的转换允许您将任何类型转换为任何其他类型。如果你愿意，你可以这样做`(std::istream*)&c`，但不建议这样做。

# android - 日期选择器在 Android 中不起作用

> ID：10770046
> 
> 赞同：1
> 
> 时间：2012-05-26T21:50:11.340
> 
> 标签：android, datepicker, logcat

我有一个日期选择器设置，它不断使应用程序崩溃。我遵循了本[教程](http://developer.android.com/resources/tutorials/views/hello-datepicker.html)，但我不知道为什么它不起作用。

我将发布下面类的完整代码以显示应用程序崩溃时我得到的 logcat

主要代码：

```
public class WorkoutChoice extends Activity
{
 private TextView mDateDisplay;
 private Button mPickDate;
 private int mYear,mMonth,mDay;
 private int cYear,cMonth,cDay;
 static final int DATE_DIALOG_ID = 0;
 Button   mButton;
 EditText cweight;
 EditText nweight;
 TextView t;
 String s,s2,cDate;
 int current,target;
 DataBaseHelper db = new DataBaseHelper(this);
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.choice);

    mDateDisplay = (TextView) findViewById(R.id.dateDisplay);
    mPickDate = (Button) findViewById(R.id.pickDate);
    mPickDate.setOnClickListener(new View.OnClickListener(){
        public void onClick(View v) {
            showDialog(DATE_DIALOG_ID);
        }
    });
    final Calendar c = Calendar.getInstance();
    cYear = c.get(Calendar.YEAR);
    cMonth = c.get(Calendar.MONTH);
    cDay = c.get(Calendar.DAY_OF_MONTH);
    cDate = (""+cYear+""+cMonth+""+cDay);
    Date past = new Date(112, cMonth, cDay); // current Date
    Date today = new Date(112, 11, 18); // date Choosen by the user
    final int days = Days.daysBetween(new DateTime(past), new DateTime(today)).getDays()+1;
     mDateDisplay.setText(cDate);
     //display the current date (this method is below)
     updateDisplay();

    mButton = (Button)findViewById(R.id.get);
    cweight   = (EditText)findViewById(R.id.cweight);
    nweight   = (EditText)findViewById(R.id.nweight);
    t = (TextView)findViewById(R.id.out);

    mButton.setOnClickListener(
        new View.OnClickListener()
        {
            public void onClick(View view)
            {
                db.open();
               s = WorkoutChoice.this.cweight.getText().toString();
               current =  Integer.parseInt(s);
               s2 = WorkoutChoice.this.nweight.getText().toString();
               target =  Integer.parseInt(s2);
               db.deleteFirst();
               db.insertTitle("001", current, target);
               db.close();
            }

        });

}
public void convert(View view) 
{
    Intent i = new Intent();
    i.setClassName("com.b00348312.workout","com.b00348312.workout.convert");
    startActivity(i); 
}
 private void updateDisplay() {
        mDateDisplay.setText(
            new StringBuilder()
                    // Month is 0 based so add 1
                    .append(mMonth + 1).append("-")
                    .append(mDay).append("-")
                    .append(mYear).append(" "));
    } 
 private DatePickerDialog.OnDateSetListener mDateSetListener =
            new DatePickerDialog.OnDateSetListener() {

                public void onDateSet(DatePicker view, int year, 
                                      int monthOfYear, int dayOfMonth) {
                    mYear = year;
                    mMonth = monthOfYear;
                    mDay = dayOfMonth;
                    updateDisplay();
                }
            };
           @Override
           protected Dialog onCreateDialog(int id) {
                switch (id) {
                case DATE_DIALOG_ID:
                    return new DatePickerDialog(this,
                                mDateSetListener,
                                mYear, mMonth, mDay);
                }
                return null;
            }
} 
```

日志猫：

```
05-26 21:37:25.928: E/AndroidRuntime(334): FATAL EXCEPTION: main
05-26 21:37:25.928: E/AndroidRuntime(334): java.lang.IllegalArgumentException: current should be >= start and <= end
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.widget.NumberPicker.setCurrent(NumberPicker.java:288)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.widget.DatePicker.updateDaySpinner(DatePicker.java:364)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.widget.DatePicker.updateSpinners(DatePicker.java:350)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.widget.DatePicker.init(DatePicker.java:346)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.app.DatePickerDialog.<init>(DatePickerDialog.java:124)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.app.DatePickerDialog.<init>(DatePickerDialog.java:83)
05-26 21:37:25.928: E/AndroidRuntime(334):  at com.b00348312.workout.WorkoutChoice.onCreateDialog(WorkoutChoice.java:123)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.app.Activity.onCreateDialog(Activity.java:2472)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.app.Activity.createDialog(Activity.java:881)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.app.Activity.showDialog(Activity.java:2547)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.app.Activity.showDialog(Activity.java:2514)
05-26 21:37:25.928: E/AndroidRuntime(334):  at com.b00348312.workout.WorkoutChoice$2.onClick(WorkoutChoice.java:56)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.view.View.performClick(View.java:2408)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.view.View$PerformClick.run(View.java:8816)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.os.Handler.handleCallback(Handler.java:587)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.os.Handler.dispatchMessage(Handler.java:92)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.os.Looper.loop(Looper.java:123)
05-26 21:37:25.928: E/AndroidRuntime(334):  at android.app.ActivityThread.main(ActivityThread.java:4627)
05-26 21:37:25.928: E/AndroidRuntime(334):  at java.lang.reflect.Method.invokeNative(Native Method)
05-26 21:37:25.928: E/AndroidRuntime(334):  at java.lang.reflect.Method.invoke(Method.java:521)
05-26 21:37:25.928: E/AndroidRuntime(334):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)  
05-26 21:37:25.928: E/AndroidRuntime(334):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-26 21:37:25.928: E/AndroidRuntime(334):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T21:53:42.563

您从不初始化`mYear`, `mMonth`, 或`mDay`在使用它们之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T11:57:12.737

这很简单，使用以下，

`dtpStart.init(now.getYear(), now.getMonth(), now.getDay(),new OnDateChangedListener() { @Override public void onDateChanged(DatePicker view, int year,int monthOfYear, int dayOfMonth) { dateStart = (Date) new Date(year, monthOfYear,dayOfMonth); } }`
其中 dtpStart 是我的日期选择器的 ID，而 dateStart 是一个 java.util.Date 对象，它是全局声明的，以便可以在我的 Activity 中的任何函数/处理程序中访问它

希望能帮助到你！

# android - 在 Fragment 中使用 Toast

> ID：10770055
> 
> 赞同：74
> 
> 时间：2012-05-26T21:51:35.940
> 
> 标签：android, android-fragments, android-activity, toast

当用户单击片段内的按钮时，我正在尝试显示 Toast 消息。问题是我无法访问活动以在其上显示 Toast。

这里的来源`Fragment`：

```
 public class FrgTimes extends Fragment
    {
        ScrollView sv;
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) 
        {
            if (container == null) { return null; }

            sv = (ScrollView)inflater.inflate(R.layout.frg_times, container, false);

            btnTime1.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {

            //******  HERE's the PROBLEM  ********
            Toast.makeText(<The Activity>, "Please long press the key", Toast.LENGTH_LONG );

            }});

            return sv;
        } 
```

这就是我尝试过的。

```
Toast.makeText( getActivity()  , ...
Toast.makeText( getView().getContext()  , ...
Toast.makeText( getActivity().getApplicationContext()  , ...
Toast.makeText( sv.getContext()  , ...
Toast.makeText( sv.getRootView().getContext()  , ... 
```

在 Debug 中，我可以看到所有这些代码都运行没有任何异常，但没有`TOAST`显示。

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-05-26T21:56:04.983

您没有调用您正在创建`show()`的.`Toast``makeText()`

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2013-07-17T14:26:16.843

正如 alfo888_ibg 所说：

```
@Override
public void onClick(View arg0) {
   Toast.makeText(activity,"Text!",Toast.LENGTH_SHORT).show();
} 
```

做就是了：

```
 Toast.makeText(getActivity(),"Text!",Toast.LENGTH_SHORT).show(); 
```

这对我有用。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-01-18T17:54:02.620

为了帮助其他人解决我同样的问题，在 Fragment 中使用 Toast 的完整答案是：

```
Activity activity = getActivity();

@Override
public void onClick(View arg0) {

    Toast.makeText(activity,"Text!",Toast.LENGTH_SHORT).show();
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2015-09-02T11:18:05.340

在片段中进行吐司时，请执行以下操作：

`Toast.makeText(getActivity(),"Message", Toast.LENGTH_SHORT).show();`

当类扩展片段时，有必要使用**getActivity()**因为片段是活动的*子类*。

干杯

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2017-11-11T06:23:04.410

您可以使用 getActivity() 获取当前活动

```
Toast.makeText(getActivity(),"Toast your message" ,Toast.LENGTH_SHORT).show(); 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-06-21T05:48:21.377

在 Fragment 中烤面包

```
 Toast.makeText(getActivity(), "Your Text Here!", Toast.LENGTH_SHORT).show(); 
```

或者

```
 Activity activityObj = this.getActivity();

    Toast.makeText(activityObj, "Your Text Here!", Toast.LENGTH_SHORT).show(); 
```

或者

```
Toast.makeText(this, "Your Text Here!", Toast.LENGTH_SHORT).show(); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-08-05T10:40:40.423

如果您使用的是 kotlin，那么上下文将已经在片段中定义。因此，只需使用该上下文。尝试以下代码以显示 toast 消息。

```
Toast.makeText(context , "your_text", Toast.LENGTH_SHORT).show() 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-05-24T06:13:45.510

在 android 片段中调用 Toast 时：

```
1\. Activity mActivity=this.getActivity();  

2\. Toast.makeText(mActivity,"Text you want to display",Toast.LENGTH_SHORT).show(); 
```

这对我有用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-02-03T16:52:35.480

user2564789 说的对
但是你也可以`this`在其中使用`getActivity()`
它会让你的吐司看起来像这样

```
 Toast.makeText(this,"Message",Toast.LENGTH_SHORT).show(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-02-11T21:22:16.960

一个简单的 [Fragment] 子类。
科特林！
contextA - 是父（主）活动。将其设置在创建对象上。

```
class Start(contextA: Context) : Fragment() {

var contextB: Context = contextA;

override fun onCreateView(
    inflater: LayoutInflater, container: ViewGroup?,
    savedInstanceState: Bundle?
): View? {
    // Inflate the layout for this fragment
    val fl = inflater.inflate(R.layout.fragment_start, container, false)

    // only thet variant is worked on me
    fl.button.setOnClickListener { view -> openPogodaUrl(view) }

    return fl;
}

fun openPogodaUrl(view: View) {        
    try {
        pogoda.webViewClient = object : WebViewClient() { // pogoda - is a WebView
            override fun shouldOverrideUrlLoading(view: WebView?, url: String?): Boolean {
                view?.loadUrl(url)
                return true
            }
        }
        pogoda.loadUrl("http://exemple.com/app_vidgets/pogoda.html");
    }
    catch (e: Exception)
    {
        Toast.makeText(contextB, e.toString(), Toast.LENGTH_LONG).show();
    }
} 
```

}

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-03-23T22:27:12.773

**使用 Kotlin**

```
Toast.makeText(view!!.context , "your_text", Toast.LENGTH_SHORT).show() 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-17T18:57:34.563

在 Kotlin android Toast.makeText(activity!!, "Your Text Here!", Toast.LENGTH_SHORT).show()

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2016-06-21T01:00:08.887

```
 public void onClick(View v) {
            Context context = v.getContext();
            CharSequence text = "Message";
            int duration = Toast.LENGTH_SHORT;
            Toast toast = Toast.makeText(context, text, duration);
            toast.show();
        } 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2017-11-11T07:03:53.217

### 独特的方法

（适用于 Dialog、Fragment、Even Util 类等...）

### `ApplicationContext.getInstance().toast("I am toast");`

相应地在 Application 类中添加以下代码。

```
public class ApplicationContext extends Application {

private static ApplicationContext instance;

@Override
public void onCreate() {
    super.onCreate();
    instance = this;
}

public static void toast(String message) {
    Toast.makeText(getContext(), message, Toast.LENGTH_SHORT).show();
}
} 
```

# windows - 如何在 Windows 7 下安装 Skipfish 安全扫描仪？

> ID：10770056
> 
> 赞同：3
> 
> 时间：2012-05-26T21:51:51.887
> 
> 标签：windows, security

我有一台装有 Windows 7（APACHE / MYSQL / PHP）的开发电脑，我想安装“Skipfish”（http://code.google.com/p/skipfish/）以检查我的网络应用程序的安全性/漏洞问题。我阅读了说明，但我无法理解。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T11:44:34.173

我引用源页面

> 该工具被认为支持 Linux、FreeBSD、MacOS X 和 Windows (Cygwin) 环境

由于它不是“真正的”windows 应用程序，因此您没有任何文件 windows 可以执行（例如 .exe 或 .msi 文件）。您需要使用[http://www.cygwin.com/](http://www.cygwin.com/)工具，然后或多或少地将其用作 Linux 应用程序。

阅读有关 skipfish 和 Cygwin 的说明，然后返回您可能遇到的任何更具体的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-20T13:58:03.267

我认为，为时已晚，但是......编译版本在这里：[https ://didasec.wordpress.com/2012/12/17/skipfish-2-10b-for-windows/](https://didasec.wordpress.com/2012/12/17/skipfish-2-10b-for-windows/)

# macos - 如何将上下文相关的菜单项（使用“右键单击”）添加到 mac OS X finder 中的文件？

> ID：10770059
> 
> 赞同：6
> 
> 时间：2012-05-26T21:52:05.333
> 
> 标签：macos, cocoa, contextmenu, finder

我需要在查找器中的文件图标中添加上下文相关菜单。所以基本上如果我右键单击“filename.txt”图标，应该会弹出一个子菜单，其中包含“打开”、“获取信息”等，但应该有一个附加项目，比如“我的程序”。如果用户选择“我的程序”菜单选择，系统将执行：“my_program.rb filename.txt”。

我有 Mac OS 10.6 32 位。

我检查了堆栈溢出，并发布了解决方案，但对它们有点困惑。首先，根据[这篇堆栈溢出文章](https://stackoverflow.com/questions/6515965/mac-contextual-menu)，您必须“添加一个启用共享设施的服务”，但这让我感到困惑。什么是“服务”？那是一个与操作系统有特殊挂钩的程序吗？

还有[一篇关于“提供服务”的苹果文章，](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/SysServices/Articles/providing.html)但我再次对此感到有些困惑。ruby 脚本可以算作“服务”吗？或者我是否必须在目标 C 中做一些奇怪的 Cocoa 事情才能访问子菜单，然后参考那里的脚本？

有没有更简单的方法来做到这一点？也许是我还没有遇到过的开源程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T05:15:34.763

您应该使用服务。请查看[服务实施指南](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/SysServices/introduction.html)和[MakingServices](http://cocoadev.com/wiki/MakingServices)。

> 服务是您的应用程序为了其他应用程序的利益而导出的功能。服务允许您与系统中的其他应用程序共享应用程序的资源和功能。

可以从上下文菜单访问服务。

# ruby-on-rails - 使用 Postgres 进行分页 - 避免重复项目

> ID：10770062
> 
> 赞同：0
> 
> 时间：2012-05-26T21:52:28.493
> 
> 标签：ruby-on-rails, pagination

我正在尝试使用 Postgres 数据库对项目列表进行分页，但我正在努力避免在每一页上重复这些项目。我一直在尝试集成 'setseed()' 功能，但无法使其工作。下面是我的代码：

```
@listings = Listing.find_by(approved_and_not_expired).select(['setseed(.5)', '*']).order('random()').page(params[:page]).per(items_loaded) 
```

# java - 在 Java 中，为什么在父类和子类中声明的变量在子类的实例中是不可见的？

> ID：10770066
> 
> 赞同：0
> 
> 时间：2012-05-26T21:52:54.757
> 
> 标签：java, inheritance

具体来说，为什么在父类和子类中声明的变量在传递给参数是父类的方法的子类实例中是不可见的？

这是一个令我困惑的问题的简化示例。有三个类，一个父子类型和两个子子类型。这些类有一个 Foo 对象作为字段和这种静态的工厂方法：

```
class Parent {
    public Foo myFoo;

    public static ThinChild createThinChild(Foo someFoo) {
        ThinChild thinChild = new ThinChild(someFoo);
        return thinChild;
    }

    public Foo getFoo() {
        return myFoo;
    }
}

class ThinChild extends Parent {
    public Foo myFoo;

    public ThinChild(Foo someFoo) {
        myFoo = someFoo;
    }
}

class ThickChild extends Parent {
    public Foo myFoo;

    public ThickChild(Foo someFoo) {
        myFoo = someFoo;
    }
} 
```

现在考虑这个处理程序类：

```
class ChildHandler {
    private void doSomethingToThinChild(ThinChild thinChild) {
        assert(thinChild.getFoo() != null);
        doSomethingToAllChildren(thinChild);
    }

    private void doSomethingToAllChildren(Parent thinOrThickChild) {
        assert(thinOrThickChild.getFoo() != null);
    }
} 
```

当我打电话`doSomethingToThinChild`时，断言通过了。但在方法`doSomethingToAllChildren`中，断言失败。这不是我所期望的。

此外，如果我将类中的相同`getFoo`方法添加`Parent`到我的`ThinChild`类中，断言现在可以工作。这解决了我眼前的问题，但对我来说似乎不受欢迎，因为我现在在每个子类中维护相同的代码，而我更愿意在父类中维护它。

我的实际情况有点复杂，但我希望我已经掌握了所有相关的细节。假设我有，是否有任何解释为什么这是预期的行为？

我的实际代码中可能还有一个我没有在这里表示的复杂情况。但我首先要确认我对 Java 中的类继承的理解是正确的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:18:43.650

删除`public Foo myFoo`. 在嵌套类中，此字段从父类扩展。您无法更改它，因为您有 2 个同名变量。所以JVM用较小的范围初始化变量。

另外一个好方法是在父级中创建构造函数：

```
public Parent(Foo someFoo) {
    myFoo = someFoo;
} 
```

然后在子类中调用它：

```
public ThinChild(Foo someFoo) {
    super(someFoo);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T05:35:26.753

myFoo 在直接子类中可见，您只需使用“super.myFoo”对其进行限定。不过，这只适用于链上一级。因此，如果 ThinChild 也有一个带有 myFoo 的子类 ThinnerChild，则您无法访问位于 Parent 类中的“myFoo”实例。这个想法是你应该能够覆盖你自己对父母的行为，但你不应该能够覆盖你的父母（因此为什么不允许像 super.super 这样的东西）。

话虽如此，删除子类上的实例很可能是您想要的，因为在这种情况下，每个 ThinChild 和 ThickChild 实际上都有两个“myFoo”实例，一个属于它，一个属于它的父级。

# php - Memcache->get 返回不同的数组

> ID：10770067
> 
> 赞同：2
> 
> 时间：2012-05-26T21:52:56.390
> 
> 标签：php, mysql, object, memcached

我做了这个函数：/* MEMCACHE */

```
function cache_query($sql,$nombre,$tiempo = -1){
    $cache = new Memcache();
    $cache->pconnect('localhost',11211);
    $query_cacheada = $cache->get($nombre);
    if ( $query_cacheada  === false ) {
             /* key not in memcache, perfom query, cache it and return */
         $res = mysql_query($sql);
         $cache->set($nombre,$res, 0, 60*60*24);  
         return $res; /* this looks good */
    }else{
             /* key in memcache, just return cached  */
         return $query_cacheada;  /* this doesnt return right elements */
    }
} 
```

我使用的是这样的：

```
class text{

    protected $id;
    protected $key;
    protected $language;
    protected $text;

    function __construct($clave,$lan){
       $consulta = cache_query("SELECT * FROM textos  
                                WHERE clave = '$clave' AND lengua = '$lan'" ,"TRANSLATION_".$clave."_".$lan);

        if(mysql_num_rows($consulta)>0){
            while($item = mysql_fetch_array($consulta)){
                $this->id = $item['id'];
                $this->clave = $item['key'];
                $this->lengua = $item['language'];
                $this->texto = $item['text'];

            }
                return true;
         }
    }
    function get_text(){
          return $this->text;
    }
}
function translation($key,$language){
     $tem = new text($key,$language);
     return $tem->get_text();
} 
```

然后：

```
$translationText = translation('hello','fr'); 
```

问题是它存储在缓存数组中（总是零），`var_dump($m->get(k))`返回：

`int(0) int(0) int(0) int(0) int(0) int(0) int(0) int(0) int(0) int(0) int(0)`......

并且**$sql 查询很好**，因为行收集得很好并且打印得很好，问题在于存储的值..

我已经清除了缓存（几次，以确保这些值不是来自以前的错误输出）：

```
$consulta = $cache->get($nombre);
             /* manually*/
             $consulta = false;
        if ( $consulta === false) {
            $consulta = mysql_query($sql);
            $cache->set($nombre,$consulta, MEMCACHE_COMPRESSED, 60*60*24);
        }; 
```

所以..我错过了什么？

编辑

这是一个键盘，问题是 mysql_query 和 memecache 没有启用，但万一有人想摆弄它

[http://codepad.viper-7.com/PJNepH](http://codepad.viper-7.com/PJNepH)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T23:19:41.900

您只能缓存可以[序列化](http://ca3.php.net/manual/en/function.serialize.php)的内容。这包括除了类型[资源](http://www.php.net/manual/en/language.types.resource.php)（从成功的[mysql_query](http://php.net/manual/en/function.mysql-query.php)返回）之外的所有内容。您需要稍微更改您的逻辑，以便缓存数组。改变这个：

```
$res = mysql_query($sql);
$cache->set($nombre,$res, 0, 60*60*24); 
```

至：

```
$res = mysql_query($sql);
$rows = array();
while($row = mysql_fetch_array($res)) $rows[] = $row;
$cache->set($nombre, $rows, 0, 60*60*24); 
```

然后改变这个：

```
if(mysql_num_rows($consulta)>0){
    while($item = mysql_fetch_array($consulta)){
        $this->id = $item['id'];
        $this->clave = $item['key'];
        $this->lengua = $item['language'];
        $this->texto = $item['text'];

    }
    return true;
} 
```

至：

```
foreach($consulta as $item){
       $this->id = $item['id'];
       $this->clave = $item['key'];
       $this->lengua = $item['language'];
       $this->texto = $item['text'];
}

// This is your old code written to work with a 2D array instead of a resource,
// But this keeps overwriting the same variables in a loop,
// if you selected multiple rows; otherwise you don't even need a loop and can just do:

$this->id = $consulta[0]['id'];
$this->clave = $consulta[0]['key'];
$this->lengua = $consulta[0]['language'];
$this->texto = $consulta[0]['text']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:17:34.813

需要注意的重要一点是，您**不能**存储从`mysql_query`. 我建议遍历结果集，使用 获取它们`mysql_fetch_array`，然后将这些对象存储在缓存中。

**编辑**正如 PaulP.RO 指出的那样，显式序列化/反序列化是多余的。

```
$result = mysql_query($sql) or die("Query failed");

$results = array();

while ($array = mysql_fetch_array($result))
{
    $results[] = $array;
}

$cache->set($nombre, $results, MEMCACHE_COMPRESSED, 60*60*24); 
```

从 memcached 中检索时，只需使用未序列化的数组。

```
$cachedItem = $cache->get($nombre);

if ($cachedItem !== false) {
    var_dump($cachedItem);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T21:01:11.620

Memcache 不接受超过 30 天的 TTL。您还可以使用 0 的 ttl 将密钥设置为永不过期，或者将 ttl 设置为小于 30 天。

[消除 memcached 的 30 天限制](https://stackoverflow.com/questions/3628995/eliminating-memcacheds-30-day-limit)

要创建一个易于序列化的变量，您可以执行以下操作。

```
$consulta = mysql_query($sql);   
while ($row = mysql_fetch_assoc($consulta)) {
  $data[] = $row;
}
$cache->set($nombre,$data, MEMCACHE_COMPRESSED, 60*60*24); 
```

# algorithm - 从子集列表中查找所有分区

> ID：10770068
> 
> 赞同：2
> 
> 时间：2012-05-26T21:52:57.017
> 
> 标签：algorithm, subset, data-partitioning

给定一个特定子集的列表，例如

```
S = [ {1, 2}, {3, 4}, {1}, {2, 3}, {4}, {3} ] 
```

和一个“宇宙”集合

```
U = {1, 2, 3, 4} 
```

有什么优雅而简单的算法可以用来从 S 中找到由集合组成的 U 的所有可能分区？在此示例中，此类分区包括

```
{1, 2} {3, 4}
{1, 2} {3} {4} 
```

等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T21:56:06.573

使用[递归](http://en.wikipedia.org/wiki/Recursion)。

根据是否使用第一个元素，将问题拆分为两个较小的问题：

*   分区使用`{1,2}`和任何剩余的集合。
*   `{1,2}`不使用但使用任何剩余集合进行分区。

这两个选项涵盖了所有可能性。

*   第一个是通过`{3,4}`仅使用分区来解决的`[ {3, 4}, {1}, {2, 3}, {4}, {3} ]`。
*   第二个是通过`{1,2,3,4}`仅使用分区来解决的`[ {3, 4}, {1}, {2, 3}, {4}, {3} ]`。

要了解如何解决这些较小的问题，请参阅[此类似问题](https://stackoverflow.com/questions/10770068/find-all-partitions-from-a-list-of-subsets)。

# android - Android 支持不同的语言

> ID：10770079
> 
> 赞同：0
> 
> 时间：2012-05-26T21:55:00.807
> 
> 标签：android, localization

有没有办法让我的设备认为我在不同的位置以测试支持不同的语言？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T21:59:15.340

尝试更改语言设置。另一方面，我发现了一篇有趣的[文章](http://www.androidsocialmedia.com/apps/fool-change-your-gps-location-on-android)，它谈到了一个可以改变你的实际 GPS 坐标的应用程序。

# xampp - 通过路由器访问本地网站

> ID：10770082
> 
> 赞同：1
> 
> 时间：2012-05-26T21:55:18.717
> 
> 标签：xampp, wamp

几个月前，我使用 Wamp Server 实现了它，但现在我试图通过路由器进入本地网站，连接到 xampp 和 wamp 服务器。

wamp 在端口 80 上破坏 xampp 在端口 81 上我的本地 ip 是`192.168.1.100` 所以我试图进入 `192.168.1.100`并`192.168.1.100:81`

从这里它可以工作，但从另一台计算机（连接在同一网络中）找不到它。

我已经在线设置了 wamp，并且在 wamp 和 xampp 中都设置了“全部允许”，所以它不起作用？

另外，我正在尝试这样做，因为我想在 Node.js 上测试一些东西（我知道我可以使用 2 个选项卡或浏览器来做）当我启动 node.js 服务器时，它可能会在它运行时`127.0.0.1:8000`可以通过`192.168.1.100:8000`？

感谢您的阅读，抱歉英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:07:38.037

我猜你正在使用Windows 7？您是否启用了防火墙？如果是这样，请按照以下链接中的步骤通过设置自定义入站规则来打开端口 80 和 81。

[http://maximumpcguides.com/windows-7/open-a-port-in-windows-7s-firewall/](http://maximumpcguides.com/windows-7/open-a-port-in-windows-7s-firewall/)

# c++ - VS2010：“找不到资源编译器DLL。请确保路径正确。”

> ID：10770084
> 
> 赞同：9
> 
> 时间：2012-05-26T21:55:45.763
> 
> 标签：c++, visual-studio-2010

我一直在关注[Forger 的 win32 API 教程](http://www.winprog.org/tutorial/menus.html)，我决定`menu_one.rc`在 VS2010 中打开文件以查看其内容，但出现此错误：

![错误（imgur.com）](../Images/8bc9b9f7ed639b62143bc9ce7ad6b22b.png)

我已经仔细检查了这两个位置，但实际上两个文件都不存在。我拥有的 rcdll.dll 的唯一副本位于：

```
C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\rcdll.dll and 
C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\x64\rcdll.dll 
```

我尝试过[修复安装 Windows SDK](http://msdn.microsoft.com/en-us/library/ms717422%28v=vs.110%29.aspx#sectionToggle2)，但这并没有解决问题。我该怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-26T22:00:13.627

[该线程](http://connect.microsoft.com/VisualStudio/feedback/details/525412/missing-rcdll-dll-file)提到了一个注册表问题：

> 我已经能够在安装了 Windows 7 SP1 64 位和 VS2010 Sp1 的电脑上重现该问题。
> 
> 我必须修改以下注册表项

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Microsoft SDKs\Windows]
"CurrentVersion"="7.0"
"CurrentInstallFolder"="C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0\\" 
```

> 到

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Microsoft SDKs\Windows]
"CurrentVersion"="7.0.30319"
"CurrentInstallFolder"="C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\" 
```

> 下面有2把钥匙

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Microsoft SDKs\Windows] 
```

> 哪个是

```
v7.0
v7.0A 
```

> 我删除了 v7.0 及其所有子项。问题就解决了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-09T20:44:07.843

因为我在 v8.0A 上运行，所以我有点担心更改注册表，但我可以通过简单地将 rcdll.dll 从以前的版本复制到错误消息中列出的目录中来修复错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-26T22:24:34.927

[VonC 的回答](https://stackoverflow.com/a/10770114/975724)很有帮助，但就我而言，它并没有解决问题。还有另一个注册表项需要更改。

为了找到那个键，我搜索了**regedit**，`v6.0A`因为那是我的错误对话框路径中的版本。
对话路径是`C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bin\rcdll.dll`

找到包含的密钥`v6.0A`后，我将路径替换为我机器上的路径：
`C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin`

我还将版本字符串更新为`v7.0A`或`7.0.30319`取决于原始值是什么。我在搜索结果的子键中发现了一些版本字符串，因此我也在那里应用了更改。

在我的机器上，Visual Studio 使用的密钥位于：

```
[HKEY_USERS\S-1-5-21-627493193-880714491-1605132347-6179\Software\Microsoft\Microsoft SDKs\Windows] 
```

# iphone - 在 NSSET 中添加多个值

> ID：10770088
> 
> 赞同：1
> 
> 时间：2012-05-26T21:56:13.367
> 
> 标签：iphone, xcode, nsmutablearray, nsset

我有一个包含以下内容的可变数组：

```
2012-05-26 23:38:09.606 [8147:f803] log (
        {
        send = david;
        receive = mike;
        message = test me;
    },
        {
        send = david;
        receive = daddy;
        message = test me;

    },
        {
        send = david;
        receive = daddy;
        message = test me;

    }
) 
```

我发现这样的重复值：

```
NSSet *uniquearray = [[NSSet alloc] init];
uniquearray = [[NSSet setWithArray: myArray] valueForKey:@"receive"];

2012-05-26 23:38:09.609  [8147:f803]  log (
    mike,
    daddy
) 
```

但是，如果我想检索消息，我该怎么做呢？我只想要像 take 之类的东西（也许重建一个 nsarray）

```
2012-05-26 23:38:09.609 [8147:f803]  log (
   {
       receive = mike,
       message = test me;
},
{
       receive = daddy
       message = test me;
}) 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T01:52:15.973

你需要澄清你对你想要什么的想法。例如，如果给“爸爸”的两条消息内容不同怎么办？你想要哪一个？或者你想保留两者？

如果您想保留所有唯一消息并且不关心订单，您可以执行以下操作：

```
NSSet* uniqueSet = [NSSet setWithArray:myArray]; 
```

如果您可以要求 iOS 5.0 或更高版本，您可以使用`NSOrderedSet`保留顺序：

```
NSOrderedSet* uniqueSet = [NSOrderedSet orderedSetWithArray:myArray]; 
```

如果您只想保留来自每个接收者的一条消息，则可以执行以下操作：

```
NSMutableArray* uniqueArray = [NSMutableArray array];
NSMutableSet* seen = [NSMutableSet set];
for (NSDictionary* dict in myArray)
{
    NSString* receiver = [dict objectForKey:@"receiver"];
    if (![seen containsObject:receiver])
    {
        [uniqueArray addObject:dict];
        [seen addObject:receiver];
    }
} 
```

`uniquearray`顺便说一句，当变量不是数组而是集合时，您不应该命名它。二、这段代码：

```
NSSet *uniquearray = [[NSSet alloc] init];
uniquearray = [[NSSet setWithArray: myArray] valueForKey:@"receive"]; 
```

分配一个空集，然后丢弃指向它的指针，将指针替换为指向不同集的指针。第一个对象完全浪费了。如果你不使用 ARC，它也会被泄露。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T22:43:15.367

您可能想使用 NSDictionary ，我知道您可以使用 keysOfEntriesPassingTest 或其他帮助您使用键的方法创建一个数组。

[http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html)

# javascript - 在 Ember.js 中，如何使用 super() 遍历对象继承树？

> ID：10770092
> 
> 赞同：0
> 
> 时间：2012-05-26T21:56:25.123
> 
> 标签：javascript, ember.js

如果我有以下情况：

```
var ObjectA = Ember.Object.extend({
  init: function() {
    this._super();
    document.write('init object A<br>');
  }
});

var ObjectB = ObjectA.extend({
  init: function() {
    this._super();
    document.write('init object B<br>');
  }
});

var ObjectC = ObjectB.extend({
  init: function() {
    this._super();
    document.write('init object C<br>');
  }
});

var myobj = ObjectC.create(); 
```

如何使 ObjectC 的 init() 方法不调用 ObjectB 的 init 方法？

[http://jsfiddle.net/QYKb3/](http://jsfiddle.net/QYKb3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T22:29:45.347

raycohen 在#emberjs 中回答了这个问题。当然答案很简单，只需要调用 ObjectA 的原型即可：

```
ObjectA.prototype.init.call(this); 
```

更新小提琴：http: [//jsfiddle.net/QYKb3/1/](http://jsfiddle.net/QYKb3/1/)

# c# - 如何在 C# 中创建一个创建通用列表的函数

> ID：10770098
> 
> 赞同：0
> 
> 时间：2012-05-26T21:57:37.737
> 
> 标签：c#, list, generics

我在数据库中有 4 个表，每个表都有 Id 和 Name，但它们代表不同的东西。对于每个“事物”，我都有一个不同的类，它们都继承自“事物”。我有 4 个功能：

```
List<thing1> getAllThings1();
List<thing2> getAllThings2();
List<thing3> getAllThings3();
List<thing4> getAllThings4(); 
```

每个函数从不同的表中读取并创建所需的列表。

因为我想避免代码重复，所以我想创建一个实用函数来接收表名（作为字符串）和类型（thing1、thing2 ... 等），然后返回`List<t>`.

不幸的是，这是不可能的（没有反射）： [创建变量类型列表](https://stackoverflow.com/questions/2493215/create-list-of-variable-type)

我目前的解决方案是我有一个返回列表的函数，我在每个“getAllThings#”中调用她，然后使用 ConvertAll 手动将列​​表中的每个“事物”转换为正确的事物，并将一些转换器传递给他。

我不喜欢这个解决方案，感觉不对，因为我创建了一个列表并创建了一个新列表。非常低效。有更好的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T22:07:08.070

为什么不使用泛型？

```
public IList<T> GetAllThings<T>(string tableName) where T : Thing {
    return new List<T>();
} 
```

您将可以调用它

```
IList<Thing4> things4 = thingProvider.GetAllThing<Thing4>( "thing4Table" ); 
```

您还可以有一个 Dictionary 用于存储每种类型的表名，因此您不必向该方法提供表名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:39:56.927

试试这个又快又脏。不实际，可能有错误，可以作为参考。

创建具有所有共同属性的事物的基类

```
abstract ThingBase
{
   protected abstract   int Id {get;set;}
   protected abstract   string Name {get;set;}
} 
```

将该基础实现到您的四个事物类

```
public Thing1 :ThingBase
{
   public int Id {get;set;}
   public string Name {get;set;}
}
public Thing2 :ThingBase
{
   public int Id {get;set;}
   public string Name {get;set;}
}
public Thing3 :ThingBase
{
   public int Id {get;set;}
   public string Name {get;set;}
}
public Thing4 :ThingBase
{
   public int Id {get;set;}
   public string Name {get;set;}
} 
```

再创建一个帮助类，它将包含所有 4 件事的列表

```
public class YourThings
{
    public IList<Thing1> thing1 {get;set;}
    public IList<Thing2> thing2 {get;set;}
    public IList<Thing3> thing3 {get;set;}
    public IList<Thing4> thing4 {get;set;}

} 
```

现在在您的 SP 中编写 4 个不同的选择查询并将其作为数据集捕获到您的数据层中。提取表格并填写其各自的列表并将您的东西类返回给 UI 层。

```
public YourThings FunctionToReturnSingleYourThing()
{
} 
```

如果您需要 YourThings 的集合，请重建您的逻辑并像这样返回

```
public List<YourThings> FunctionToReturnMultipleYourThings()
{
} 
```

# python - 将csv导入python并对数字行求和

> ID：10770101
> 
> 赞同：0
> 
> 时间：2012-05-26T21:57:55.207
> 
> 标签：python, excel, csv

我开始怀着极大的热情学习python，并设法完成了程序、函数和一些列表。并准备好通过构建一个有用的应用程序来推进学习。

我希望用户将一个 Excel 文件导出到 csv 中，其中只有一行数字，其中一些是负数、正数和零。并想计算正数的平均值和负数的平均值。

计算位不是问题，它是导入 csv 位。我一直在阅读 python 文档，但看起来很困惑。

请让我开始导入 csv 文件并对数字行求和。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T22:01:14.950

这应该让你开始。

```
import csv

with open("file.csv", "rb") as ins:
    for row in csv.reader(ins):
        print sum(map(int, row)) 
```

[with 语句](http://effbot.org/zone/python-with-statement.htm)是一种使这个异常安全的方法。在大多数情况下，以下内容就足够了：

```
import csv

ins = open("file.csv", "rb")
for row in csv.reader(ins):
    print sum(map(int, row))
ins.close() 
```

上述解决方案不适用于 Python 3。相反，试试这个：

```
import csv

with open("test.csv", "r") as ins:
    for row in csv.reader(ins):
        print(sum(map(int, row))) 
```

# php - Facebook PHP API 发布到粉丝页面/新闻提要的链接不再显示分享动作

> ID：10770103
> 
> 赞同：2
> 
> 时间：2012-05-26T21:58:17.437
> 
> 标签：php, facebook, share

我正在使用 Facebook PHP Api 发布指向粉丝页面和用户新闻提要的链接。所有这些都 100% 有效。最近，我发现我在帖子中的“分享”操作不再存在。我只有“喜欢”和“评论”。

谁能帮我取回“共享”链接，或者将我指向正确的方向，使用“操作”参数来重新启动并运行它？

先谢谢大家了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T08:25:41.913

在做了一些广泛的研究并像疯子一样在网上拖钓之后，我找到了解决方案。

[使用 API Graph 和缺少的分享按钮发布到 facebook 墙上](https://stackoverflow.com/questions/6143932/post-to-facebook-wall-using-api-graph-and-missing-share-button)

[https://developers.facebook.com/bugs/335325956484296](https://developers.facebook.com/bugs/335325956484296)

简而言之 ：

发布到 facebook ('/me/feed', 'POST', ...) 时，分享链接将不可见，但发布到 ('/me/links', 'POST', ...) 时，分享链接将不可见链接将可见。保持您的帖子详细信息完全相同，只需将“提要”更改为“链接”，共享按钮就会可见。

真的希望这也能让其他人感到头疼！

# php - 如何在远程服务器上运行 zend 框架

> ID：10770105
> 
> 赞同：0
> 
> 时间：2012-05-26T21:58:27.777
> 
> 标签：php, zend-framework

我正在使用**zend 框架**，我已经使用 zend 框架创建了一个网站，但现在我想在远程服务器上运行我的项目。但是，当我将所有项目数据传输到远程服务器时，它不起作用。

我的 zend 框架项目在**localhost**上很好。

我还阅读了手册`Getting Started with Zend Framework By Rob Allen, www.akrabat.com.`

因此，在阅读本手册后，我发现了这篇重要的文章。

```
You must also ensure that Apache is configured to support .htaccess files. This is usually done by
changing the setting:
! AllowOverride None
to
! AllowOverride All
in your httpd.conf file. Check with your distribution’s documentation for exact details. You will not be able
to navigate to any page other than the home page in this tutorial if you have not configured mod_rewrite
and .htaccess usage correctly. 
```

但实际上我正在使用**共享远程服务器**，所以从我更改的位置`apache config`以及`mod_rewrite`.

注意：-我的项目在 localhost 上运行，因为我在阅读本文档后做了一些更改。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T08:27:46.830

我觉得有一个没有显示的错误。您确定要显示所有错误吗？

1.  将以下内容添加到您的`index.php`:

    ```
    error_reporting(E_ALL);
    ini_set('display_errors', 'on'); 
    ```

2.  你有没有在你的配置文件中设置这些（很可能`[development : production]`是你的部分`application.ini`）？

    ```
    [development : production]
    phpSettings.display_startup_errors = 1
    phpSettings.display_errors = 1
    resources.frontController.params.displayExceptions = 1 
    ```

3.  您的应用程序在`development`环境中吗？您很可能可以`index.php`这样设置：

    ```
    // Define application environment
    defined('APPLICATION_ENV')
        || define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : 'development')); 
    ```

这可能会显示对您隐藏的错误。我希望错误可以帮助您解决问题。

# r - 向量化模拟

> ID：10770107
> 
> 赞同：2
> 
> 时间：2012-05-26T21:59:00.620
> 
> 标签：r, vectorization

试图将我的思想围绕矢量化，试图使一些模拟更快，我发现了这个非常基本的流行病模拟。代码来自本书[http://www.amazon.com/Introduction-Scientific-Programming-Simulation-Using/dp/1420068725/ref=sr_1_1?ie=UTF8&qid=1338069156&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/1420068725)

```
#program spuRs/resources/scripts/SIRsim.r

SIRsim <- function(a, b, N, T) {
  # Simulate an SIR epidemic
  # a is infection rate, b is removal rate
  # N initial susceptibles, 1 initial infected, simulation length T
  # returns a matrix size (T+1)*3 with columns S, I, R respectively
  S <- rep(0, T+1)
  I <- rep(0, T+1)
  R <- rep(0, T+1)
  S[1] <- N
  I[1] <- 1
  R[1] <- 0
  for (i in 1:T) {
    S[i+1] <- rbinom(1, S[i], (1 - a)^I[i])
    R[i+1] <- R[i] + rbinom(1, I[i], b)
    I[i+1] <- N + 1 - R[i+1] - S[i+1]
  }
  return(matrix(c(S, I, R), ncol = 3))
} 
```

模拟的核心是`for`循环。我的问题是，由于代码从and值生成`S[i+1]`and值，是否可以使用 apply 函数对其进行矢量化？`R[i+1]``S[i]``R[i]`

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T23:55:22.530

很难“矢量化”迭代计算，但这是一个模拟，模拟可能会运行很多次。`M`因此，通过添加一个参数（要执行的模拟次数），分配一个 M x (T + 1) 矩阵，然后填充每个模拟的连续列（次），编写此代码以同时进行所有模拟。这些更改似乎非常简单（所以我可能犯了一个错误；我特别担心在 的第二个和第三个参数中使用向量`rbinom`，尽管这与文档一致）。

```
SIRsim <- function(a, b, N, T, M) {
    ## Simulate an SIR epidemic
    ## a is infection rate, b is removal rate
    ## N initial susceptibles, 1 initial infected, simulation length T
    ## M is the number of simulations to run
    ## returns a list of S, I, R matricies, each M simulation
    ## across T + 1 time points
    S <- I <- R <- matrix(0, M, T + 1)
    S[,1] <- N
    I[,1] <- 1
    for (i in seq_along(T)) {
        S[,i+1] <- rbinom(M, S[,i], (1 - a)^I[,i])
        R[,i+1] <- R[,i] + rbinom(M, I[,i], b)
        I[,i+1] <- N + 1 - R[,i+1] - S[,i+1]
    }
    list(S=S, I=I, R=R)
} 
```

# parsing - 解析applescript中的段落无法按预期工作

> ID：10770108
> 
> 赞同：0
> 
> 时间：2012-05-26T21:59:01.867
> 
> 标签：parsing, applescript, delimiter

**发布代码会丢失导致问题的格式，复制我在帖子中的内容实际上会做它应该做的事情。**糟糕的是，这不是使用脚本的选项，因此我在[此处](http://www.sendspace.com/file/zownb6)上传了脚本文件，其中包含导致问题的内置文本示例。我将尝试传达问题仍然存在。

我正在从 mail.app 中提取文本。我正在解析的电子邮件中有一个日期列表（除其他外）：

2012 年 5 月 27 日

2012 年 5 月 28 日

2012 年 5 月 29 日

2012 年 5 月 30 日

2012 年 5 月 31 日

2012 年 6 月 1 日

2012 年 6 月 3 日

2012 年 6 月 4 日

2012 年 6 月 5 日

2012 年 6 月 6 日

现在我正在尝试将日期放入列表中。没问题我以为...

以下没有工作：

*使用段落不起作用，将整个内容作为段落返回*

```
set AppleScript's text item delimiters to (ASCII character 13) -- (Carriage Return)

set AppleScript's text item delimiters to (ASCII character 10) -- (LF) 
```

两个分隔符都不起作用。我想知道“返回”的 ASCII 码到底是什么，所以我做了以下内容：

将运行日期设置为“5/27/2012 5/28/2012 5/29/2012 5/30/2012 5/31/2012 6/1/2012 6/3/2012 6/4/2012 6/5/2012 6 /6/2012 6/7/2012 6/8/2012 6/10/2012 6/11/2012"

```
 set mylist to {}

 repeat with z from 1 to count of characters of rundates
        copy (ASCII number (character z of rundates)) to end of mylist
   end repeat

 --return mylist ---{53, 47, 50, 55, 47, 50, 48, 49, 50, 13, 53, 47, 50, 56, 47, 50, 48, 49, 50, 13, 53, 47, 50, 57, 47, 50, 48, 49, 50, 13, 53, 47, 51, 48, 47, 50, 48, 49, 50, 13, 53, 47, 51, 49, 47, 50, 48, 49, 50, 13, 54, 47, 49, 47, 50, 48, 49, 50, 13, 54, 47, 51, 47, 50, 48, 49, 50, 13, 54, 47, 52, 47, 50, 48, 49, 50, 13, 54, 47, 53, 47, 50, 48, 49, 50, 13, 54, 47, 54, 47, 50, 48, 49, 50, 13, 54, 47, 55, 47, 50, 48, 49, 50, 13, 54, 47, 56, 47, 50, 48, 49, 50, 13, 54, 47, 49, 48, 47, 50, 48, 49, 50, 13, 54, 47, 49, 49, 47, 50, 48, 49, 50} 
```

---===== 注意到 13s 了吗？所以这应该有效吗？====---

所以我使用 13 的分隔符应该可以工作，但它没有。

有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:44:41.070

我从你的 ascii 数字帖子中得到了不同的结果。实际上，现在 applescript 是 unicode，我们现在使用“id”而不是 ascii 编号。看来你的角色是“8232”。因此，在获取文本项之前，请在代码中使用它...

```
set AppleScript's text item delimiters to character id 8232 
```

# android - 获取 Mobli 的公共访问令牌时出错

> ID：10770111
> 
> 赞同：0
> 
> 时间：2012-05-26T21:59:40.430
> 
> 标签：android, api, mobli

我在为我的应用程序获取公共访问令牌时遇到问题。我收到以下错误：05-26 14:43:17.194: D/Mobli(1219): Response {"error":"invalid_request","error_description":"The request contains an unsupported parameters","error_uri": “http://dev.mobli.com/error/invalid_request”}

我用来发出请求的代码如下：

```
Mobli mobli = new Mobli(ID, SECRET);  
SampleRequestListener mobliListner =  new SampleRequestListener();
runner = new AsyncMobliRunner(mobli);  
runner.obtainPublicToken(mobliListner, null);

public class SampleRequestListener extends BaseRequestListner {
    public void onComplete(final String response, final Object state) {
        try {
            // process the response here: executed in background thread
            Log.d("Mobli", "Response " + response.toString());
        } catch (MobliError e) {
            Log.w("Mobli Error", "Error" + e.getMessage());
        }
    }
 } 
```

知道代码可能有什么问题吗？

我还验证了 URL 的格式是否正确。我在 util.java 中得到了 filenotfoundexcetion

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T03:06:29.380

原来 util.java 中的 openUrl 函数存在问题，它是 mobli sdk 的一部分。在 openUrl 函数中，一个额外的参数被附加到 post 请求中，这导致了上述错误。具体来说，注释掉 openUrl 函数中的以下行解决了上述问题。

```
// use method override
if (!params.containsKey("method")) {
    params.putString("method", method);
} 
```

# facebook - 无法解决 Facebook Open Graph 元标记未为我的 Wordpress 网站抓取的问题

> ID：10770115
> 
> 赞同：0
> 
> 时间：2012-05-26T22:00:14.443
> 
> 标签：facebook, wordpress, internet-explorer, debugging, facebook-opengraph

这是我第一次在这个网站上发布问题，但肯定不是第一次在其中找到答案。

我使用 stackoverflow 作为资源来解决我在新博客中遇到的几个问题，直到昨晚，当我发现这个我无法解决的问题时。

当我尝试分享我博客的主页时，我没有得到 og:image 标记中指定的正确图像...一旦我通过 de FB 调试器检查了我的网站，它就会向我显示：

[https://developers.facebook.com/tools/debug/og/object?q=ivanfuentes.com](https://developers.facebook.com/tools/debug/og/object?q=ivanfuentes.com)

奇怪的是，我在检查页面或帖子时没有发现任何问题： https://developers.facebook.com/tools/debug/og/object?q=ivanfuentes.com%2Fvideos%2F [https://developers.facebook.com/tools/debug/og/object?q=ivanfuentes.com%2Fvideos%2F](https://developers.facebook.com/tools/debug/og/object?q=ivanfuentes.com%2Fvideos%2F) https:// /developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fivanfuentes.com%2Fthe-popularity-contest%2F

所以，我知道这是一个仅在主页中生成的问题，但在过去 18 小时内，一直无法找到它。

我有通过 wordpress 插件动态指定的 OG 元标签……目前，它是“Facebook AWD”，但我还有其他几个 Facebook 共享、一体机和 OG 插件，它们给了我相同的结果调试器，这让我觉得我在其他地方搞砸了。我承认我是一个新手并不尴尬，所以我很可能在尝试修改一些代码时搞砸了......可能是当我添加了几行以使网站符合 IE 标准时？

希望我提供了足够的信息，并且有人可以帮助我，因为这不仅是关于在 Facebook 链接上显示正确的图像，而且是关于我的代码可能有混乱，这可能（将）意味着麻烦一次我将来会对我的网站进行任何修改/更新。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T22:29:50.230

您的 html 完全是一团糟，这就是调试器抱怨的原因。

访问您的页面并查看代码，我可以看到：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<div id="fb-root"></div>
<script>
...
</script>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#" xmlns:fb="https://www.facebook.com/2008/fbml">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<div id="fb-root"></div>
<script>
...
</script>
<title>Ivan Fuentes Hagar</title> 
```

那里有两个问题：

1.  sdk代码插入两次
2.  在这两种情况下`div`，身体之前都有一个位置

在单击底部链接时此页面的调试器结果中（**Scraped URL:** [See exactly what our scraper sees for your URL](http://developers.facebook.com/tools/debug/og/echo?q=http://ivanfuentes.com/)）您还可以看到损坏的 html，但有另一种变体：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><body>
<div id="fb-root"></div>
<script>
...
</script><meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>
...
</script><title>Ivan Fuentes Hagar</title> 
```

这里有问题：

1.  正文定义就在 html 之后
2.  没有头部定义
3.  所有假设存在于头部的标签都在体内
4.  sdk 脚本加载插入两次

在这两种情况下，我都发现了 3 个`<div id="fb-root"></div>`.

正如您所看到的，您对 wordpress 的 html 输出有一些问题。
我不确定为什么调试器的输出不同，我认为可能是由于用户代理字符串，但尝试`curl --user-agent "facebookexternalhit/1.1 (+http://www.facebook.com/externalhit_uatext.php)" "http://ivanfuentes.com/"`返回与浏览器一样的确切结果。

# java - 何时覆盖 writeObject/readObject？

> ID：10770120
> 
> 赞同：0
> 
> 时间：2012-05-26T22:01:15.360
> 
> 标签：java, serialization

似乎是一个非常直截了当的问题，但我在谷歌上找不到直接答案。

我在两个进程之间通过 UDP 有一个简单的 IPC 通道。每条消息都包装在一个标头类中（例如，数据驱动的）。

前任。

```
enum Type 
{ 
 HELLO,
 BYE,
 LISTEN,
}

class Message
{
Type type;
Object data;
} 
```

这`Message`就是我发送给`ObjectOutputStream writeObject`. 这适用于没有`data`有效负载的消息（例如`HELLO`和`BYE`）。但是，该`LISTEN`消息将`data`属性设置为自定义类（具有所有 POD 类型），并且它似乎永远不会到达其他进程。当我`readObject`在另一边时，我什么也得不到。

所以我的问题是我是否需要一个工具`writeObject`并`readObject`在我的`Message`班级和/或`data's`班级类型内部？

**--- 更新 1 ---**

是的，`Message`类型和底层`data`类型都有`implements Serializable`，所有的 Eclipse 都是`serialVersionUID`为我生成的。这足够了吗？我仍然没有看到`data`消息的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T22:07:38.420

确保写入的所有对象`ObjectOutputStream`都是`Serializable`.

[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/io/ObjectOutputStream.html)明确指出：

> 只有支持 java.io.Serializable 接口的对象才能写入流。

确保`class Message`实现`Serializable`或[`Externalizable`](http://docs.oracle.com/javase/6/docs/api/java/io/Externalizable.html)接口。

* * *

根据您的更新，`Object data`is an`Object`并且默认情况下`Object`is not `Serializable`。您可以将其声明为`Serializable data`. 如前所述，*只有 Serializable 对象可以写入 OutputStream*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:13:13.607

实现`writeObject`并且`readObject`不是对象可序列化的必要条件 - 它们仅用于自定义序列化，而不是启用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T22:27:24.540

只需实现 Serializable 接口，对象就可以进行序列化了。但是，您可以覆盖这些方法以允许自定义序列化。例如，您可能想要序列化 ​​GregorianCalendar。GregorianCalendar 有大量数据（时区等），例如，您知道您只使用日、月和小时。然后，您可以通过使这些方法只编写那些部分来避免保存其他所有内容。

# javascript - Phonegap - 如何在使用 Phonegap 的 media.startRecord 录制后上传音频文件

> ID：10770122
> 
> 赞同：3
> 
> 时间：2012-05-26T22:01:22.880
> 
> 标签：javascript, cordova, file-upload

我已经用 Phonegap 完成了标准的录音：

```
function recordSound() {

    var src = "mysound.mp3";
    var mediaRec = new Media(src, onSuccess, onError);

    // Record audio
    mediaRec.startRecord();

    // Stop recording after 10 sec
    var recTime = 0;
    var recInterval = setInterval(function() {
        recTime = recTime + 1;
        setAudioPosition(recTime + " sec");
        if (recTime >= 10) {
            clearInterval(recInterval);
            mediaRec.stopRecord();
        }
    }, 1000);

} 
```

我现在想上传这个文件（mysound.mp3）而不让用户自己选择。任何帮助将不胜感激。

到目前为止，我已经完成了：

```
function win(r) {
    console.log("Code = " + r.responseCode);
    console.log("Response = " + r.response);
    console.log("Sent = " + r.bytesSent);
}

function fail(error) {
    alert("An error has occurred: Code = " + error.code);
    console.log("upload error source " + error.source);
    console.log("upload error target " + error.target);
}

function up() {// !! Assumes variable fileURI contains a valid URI to a text
    // file on the device

    var fileURI = "/mnt/sdcard/mysound.mp3";
    var options = new FileUploadOptions();
    options.fileKey = "file";
    options.fileName=fileURI.substr(fileURI.lastIndexOf('/')+1);
    options.mimeType = "audio/mp3";

    var params = new Object();
    params.value1 = "test";
    params.value2 = "param";

    options.params = params;

    var ft = new FileTransfer();
    ft.upload(fileURI, "http://myserver/upload.php", win, fail, options);
} 
```

我得到：`java.io.IOException: Received from server`

和

`JSCallback Error: Request failed`

很高兴得到帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T09:39:20.407

您可以使用此功能上传文件

```
function uploadVoice(fileName, dirName, fileMime, uploadURL) {

    var win = function (r) {
        console.log("Code = " + r.responseCode);
        console.log("Response = " + r.response);
        console.log("Sent = " + r.bytesSent);
    };

    // upload failure
    var fail = function(error) {
        alert("An error has occurred: Code = " + error.code);
    };

    // file system fail
    var fsFail = function(error) {
        alert("failed with error code: " + error.code);

    };

    var dirFail = function(error) {
        alert("Directory error code: " + error.code);

    };

    var fileURI;

    var gotFileSystem = function (fileSystem) {
        fileSystem.root.getDirectory(dirName, {
            create: false
        }, function (dataDir) {

            fileURI = dataDir.fullPath;
            fileURI = fileURI + '/' + fileName;

            var options = new FileUploadOptions();
            options.fileKey = "file";
            options.fileName = fileURI.substr(fileURI.lastIndexOf('/') + 1);
            options.mimeType = fileMime;

            var params = new Object();
            params.value1 = "test";
            params.value2 = "param";

            options.params = params;

            var ft = new FileTransfer();
            ft.upload(fileURI, uploadURL, win, fail, options);

        }, dirFail);

    };

    // get file system to copy or move image file to
    window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, gotFileSystem, fsFail);

} 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-09T16:23:23.800

出色的。对ios真的很有帮助。

**var**中的简单拼写错误修复如下。

```
var fail = function(error) {
    alert("An error has occurred: Code = " + error.code);
}; 
```

# php - 将未知数量的文件发布到php

> ID：10770123
> 
> 赞同：0
> 
> 时间：2012-05-26T22:01:34.877
> 
> 标签：php, file-upload

我目前正在处理需要上传文件的 php 项目，但我无法知道用户将上传多少文件。

默认情况下，表单上会上传一个文件，并带有添加另一个文件上传的链接。提交表单时，如果我不知道要上传的文件数量，我将如何将所有文件发布到 php 脚本。

它是否以与复选框数组相同的方式工作，所以你可以有类似的东西

```
<input type="file" name"myFile[]" />
<input type="file" name"myFile[]" /> 
```

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:05:50.960

是的，它的工作原理与复选框数组完全一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:09:03.687

是的，工作正常。

在使用文件发布表单后尝试这样做：

```
<pre>
    <?php print_r($_FILES['myFile']['tmp_name']); ?>
</pre> 
```

你会得到一个数组。使用索引访问每个文件信息：

```
$_FILES['myFile']['tmp_name'][0];
$_FILES['myFile']['tmp_name'][1]; 
```

# wpf - 如何设置按钮样式

> ID：10770125
> 
> 赞同：13
> 
> 时间：2012-05-26T22:02:05.627
> 
> 标签：wpf

![按钮常规/禁用](../Images/bf18e6a7b6d8bd23f6709c475701fbf3.png)

![按钮悬停](../Images/1d47d54aee1707cd8f3cdbe581c815a6.png)

我的 UX 设计师把这些交给了我，我不知道从哪里开始设计我的 WPF 应用程序。任何帮助，将不胜感激。也许我可以为其他两个扩展一个示例。

这些将是除视觉显示之外的所有其他方面的标准按钮。我认为我不需要实现自定义控件。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-26T23:57:28.323

[有关按钮样式](https://msdn.microsoft.com/en-us/library/ms753328(v=vs.100).aspx)的 MSDN 文档可能会对您有所帮助。它提供了一个 WPF 按钮模板示例，您应该能够根据您的要求对其进行编辑。`Windows.Resources`如果样式仅用于该表单，则可以将 Xaml 放入，或者如果要用于整个应用程序，则可以编辑**Application.xaml**文件并将样式信息放入Section 中。`Application.Resources`

* * *

修改上面的样式链接给你一个例子：

```
<Application x:Class="Application"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
StartupUri="MainWindow.xaml">
    <Application.Resources>
        <!--Control colors.-->
        <Color x:Key="ControlNormalColor">#FFC0C0CE</Color>
        <Color x:Key="ControlMouseOverColor">#FFAFA3B9</Color>
        <Color x:Key="DisabledControlColor">#FFF2F2F2</Color>
        <Color x:Key="DisabledForegroundColor">#FFBFBFBF</Color>
        <Color x:Key="ControlPressedColor">#FF211AA9</Color>

        <!-- FocusVisual -->

        <Style x:Key="ButtonFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Border>
                            <Rectangle Margin="2" StrokeThickness="1" Stroke="#60000000" StrokeDashArray="1 2" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Button -->
        <Style TargetType="Button">
            <Setter Property="SnapsToDevicePixels" Value="true" />
            <Setter Property="OverridesDefaultStyle" Value="true" />
            <Setter Property="FocusVisualStyle" Value="{StaticResource ButtonFocusVisual}" />
            <Setter Property="MinHeight" Value="29px" />
            <Setter Property="MinWidth"  Value="103px" />
            <Setter Property="Foreground" Value="#FFFFFFFF" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border TextBlock.Foreground="{TemplateBinding Foreground}" x:Name="Border">
                            <Border.Background>
                                <SolidColorBrush  Color="{DynamicResource ControlNormalColor}" />
                            </Border.Background>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualStateGroup.Transitions>
                                        <VisualTransition GeneratedDuration="0:0:0.5" />
                                        <VisualTransition GeneratedDuration="0" To="Pressed" />
                                    </VisualStateGroup.Transitions>
                                    <VisualState x:Name="Normal" />
                                    <VisualState x:Name="MouseOver">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)"
                                                Storyboard.TargetName="Border">
                                                <EasingColorKeyFrame KeyTime="0" Value="{StaticResource ControlMouseOverColor}" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Pressed">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)"
                                                Storyboard.TargetName="Border">
                                                <EasingColorKeyFrame KeyTime="0" Value="{StaticResource ControlPressedColor}" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Disabled">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)"
                                                Storyboard.TargetName="Border">
                                                <EasingColorKeyFrame KeyTime="0" Value="{StaticResource DisabledControlColor}" />
                                            </ColorAnimationUsingKeyFrames>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)"
                                                Storyboard.TargetName="Border">
                                                <EasingColorKeyFrame KeyTime="0" Value="{StaticResource DisabledForegroundColor}" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <ContentPresenter Margin="2"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            RecognizesAccessKey="True" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Application.Resources>
</Application> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-26T22:10:33.897

使用**样式**自定义您的 UI 控件。

有关示例，请参见以下链接：

[http://wpftutorial.net/Styles.html](http://wpftutorial.net/Styles.html)

[http://geekswithblogs.net/cskardon/archive/2008/06/20/roundedbutton-button-style-wpf.aspx](http://geekswithblogs.net/cskardon/archive/2008/06/20/roundedbutton-button-style-wpf.aspx)

[http://gregandora.wordpress.com/2011/02/06/wpf-minimal-button-styling/](http://gregandora.wordpress.com/2011/02/06/wpf-minimal-button-styling/)

# objective-c - 为什么我不能在objective-c中使用release

> ID：10770126
> 
> 赞同：-1
> 
> 时间：2012-05-26T22:02:06.353
> 
> 标签：objective-c, ios5

在objective-c中使用后我无法释放对象我发现错误

> 发布不可用

例子 ;

```
strokes *current = [strokesarray] objectAtIndex:0];

[current release] 
```

最后一行是错误为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T22:03:27.153

您的问题是这样的：由于您在项目中打开了[自动引用计数（ARC）](http://clang.llvm.org/docs/AutomaticReferenceCounting.html)，因此您不能`release`在对象上调用“”。

即使您没有打开 ARC，该代码也不会正确，因为 A），您在“ `[strokesarray] objectAtIndex:0]`”中的括号不平衡（语法错误）和 B）释放存储在数组中的对象意味着您的应用程序将崩溃下次尝试访问数组中的该对象时会出现 EXEC_BAD_ACCESS 错误。

# graph - 绘制一个边有半圆的多边形

> ID：10770134
> 
> 赞同：0
> 
> 时间：2012-05-26T22:03:47.603
> 
> 标签：graph, polygon, pascal

我需要在 Pascal(dev-pascal) 中绘制一个多边形，它的侧面有半圆。我会给出到目前为止我提出的代码。它也有对角线。

```
uses crt,graph;
var a,b:smallint;
    x0,y0,n,j,k,r:integer;
    xevi,yoni:array[1..50] of integer;
    i:real;

begin
 write('n?.. ');readln(n);
 detectgraph(a,b);
 initgraph(a,b,'');
 x0:=getmaxx div 2;
 y0:=getmaxy div 2;
 j:=0;
 i:=0;
 repeat
  inc(j);
  xevi[j]:=trunc( x0+200*cos(i) );
  yoni[j]:=trunc( y0-200*sin(i) );
  i:=i+2*pi/n;
 until i>2*pi;

 r:=trunc( sqrt( sqr((xevi[1]-xevi[2])) + sqr((yoni[1]-yoni[2])))) div 2;

 for j:=1 to n do begin
    if (xevi[j+1]-xevi[j])<>0 then begin
    k:=trunc( arctan(
    //abs(
    ((yoni[j+1]-yoni[1])/(xevi[j+1]-xevi[j])-1)
    /(1+(yoni[j+1]-yoni[1])/(xevi[j+1]-xevi[j]))
    //)
    )*180/pi); end
    else k:=90;
    if k>0 then arc( (xevi[j]+xevi[j+1]) div 2, (yoni[j]+yoni[j+1]) div 2, k, k+180, r )
           else begin
                k:=360+k;
                if k+180>360 then k:=360-k;
                arc( (xevi[j]+xevi[j+1]) div 2, (yoni[j]+yoni[j+1]) div 2, k, k+180, r );
                end;

 end;

 for j:=1 to n do
     for k:=1 to n do
         line( xevi[j],yoni[j],xevi[k],yoni[k]);

 readln;
 closegraph;
end. 
```

如您所见，我尝试使用解析几何来找到多边形的两个相邻顶点之间的斜率，然后计算直线与该斜率的角度，然后使用该角度绘制弧线。

所以基本上，我不知道为什么它不起作用，而且我也确信有一个更简单的方法来做到这一点！任何帮助都将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:40:43.283

我不知道帕斯卡所以只会使用伪代码。

```
x0, y0 = ... # one end of side
x1, y1 = ... # other end of side
x, y = (x0 + x1) / 2, (y0 + y1) / 2 # midpoint
angle1 = atan2(y0 - y, x0 - x) # angle from midpt back to start
angle2 = atan2(y1 - y, x1 - x) # angle from midpt forwards to end 
```

鉴于此，对 arc 的调用应该是：

```
arc(x, y, angle1, angle2) 
```

或者

```
arc(x, y, angle1, angle1 + 180) 
```

而且我认为您不需要针对不同的角度进行调整。

这与您所拥有的非常相似，只是您的 atan2 中有一些奇怪`+1`的`-1`值，并且您不必太担心角度。

# ruby-on-rails-3 - 用 Thinking Sphinx Facets 向下钻取

> ID：10770140
> 
> 赞同：3
> 
> 时间：2012-05-26T22:05:06.453
> 
> 标签：ruby-on-rails-3, search, thinking-sphinx, faceted-search

我有一个应用程序，它使用思考狮身人面像进行搜索，我可以让构面正确显示在视图中，但是链接没有返回具有给定选项的结果列表。这是我为模型控制器和视图提供的代码：

控制器：

```
@facets = Load.facets(
  (params[:trucks]),
  :page => (params[:page] || 1),
  :per_page => 25,
  :geo => degrees_to_radians(@location),
  :with => { "@geodist" => 0.0..miles_to_meters(params[:radius].to_i) },
  :sort_mode => :expr,
  :order => sort_by_select(params[:sort])
  )
  @results = @facets.for 
```

该模型：

```
define_index do 
  indexes commodity
  indexes truck_type
  has latitude, longitude
  has distance, :facet => true
  has weight, :facet => true
  has current_asking_price, :facet => true
  has created_at, :facet => true
  where sanitize_sql(["active", true])
  set_property :delta => :delayed
end 
```

风景：

```
<% @facets.each do |facet, facet_options| %>
  <h5><%= facet %></h5>
  <ul>
    <% facet_options.each do |option, count| %>
    <li><%= link_to "#{option} (#{count})", :params => {facet => option, :page => 1}</li>
    <% end %>
  </ul>
<% end %> 
```

如果我在 ":with =>" 散列的值部分包含构面选项，我可以获得正确的结果。但是我不确定如何配置链接，以便它执行另一个搜索，并将该值插入到控制器代码中。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T23:07:28.050

乍一看，它看起来像线

```
<li><%= link_to "#{option} (#{count})", :params => {facet => option, :page => 1}</li> 
```

应该改为阅读

```
<li><%= link_to "#{option} (#{count})", :params => {:facet => option, :page => 1} %></li> 
```

通过这些更改：

*   `<%=`没有结束标签
*   `:params``:`哈希之前缺少符号标识符`facet`

但是我不确定这是否能回答你的问题。

听起来您需要执行以下操作：

1.  将 Thinking Sphinx 参数嵌入到`link_to`标签中。
2.  在控制器中，使用逻辑处理参数，然后将它们添加到`:with`哈希中。

逻辑可能包括错误检查、格式化、验证*等*。

# javascript - 简单的小书签创建无限循环

> ID：10770141
> 
> 赞同：1
> 
> 时间：2012-05-26T22:05:07.503
> 
> 标签：javascript, infinite-loop, bookmarklet, document.write

这个书签：

```
javascript:document.write('hello world'); 
```

当您单击它时会创建一个无限循环。或者我猜是这样，因为该浏览器选项卡曾经正确显示 hello world，但忙碌指示符始终存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:08:58.740

请参阅此相关问题： [新手：在函数调用时挂起浏览器](https://stackoverflow.com/questions/575222/newbie-hanging-browser-on-function-call)

如果在页面完成加载后使用 document.write() 函数会导致问题。如果您正在寻找一个简单的概念验证选项，我建议您使用 alert() 代替。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T14:55:36.117

添加*文档.close();* 停止 Firefox 中的“挂起”。

```
javascript:document.write('hello world');document.close(); 
```

# wpf - 在列表框中显示 XML 文件中的数据

> ID：10770142
> 
> 赞同：1
> 
> 时间：2012-05-26T22:05:27.137
> 
> 标签：wpf, xaml, xmldataprovider

我有一个名为 Data.xml 的 xml 文件，它看起来像这样

```
<Data>
  <NumberID>23423 </NumberID>
  <NumberID>34234 </NumberID>
  <NumberID>45435 </NumberID>
  <NumberID>67867 </NumberID>
</Data> 
```

我想在我的应用程序的 ListBox 控件上显示这些数字。如何将此 xml 文件绑定到列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:15:06.137

使用 XmlDataProvider：

```
<Window.Resources>
   <XmlDataProvider x:Key="Items" Source="Data.xml" XPath="Data/NumberID" />
</Window.Resources>

...

<ListBox ItemsSource="{Binding Source={StaticResource Items}}" /> 
```

# php - 从图像中获取雷达数据

> ID：10770144
> 
> 赞同：3
> 
> 时间：2012-05-26T22:05:44.313
> 
> 标签：php, image-processing

我有一个问题..有一些图片，像这样：

![在此处输入图像描述](../Images/e33e9621b400485973bd1a96450b27c4.png)

我想为这个雷达图像添加新的分辨率、背景和更好的质量（抗锯齿）。如何使用 PHP 脚本从此图像中获取雷达详细信息？

我已经有了这段代码，但输出不是最好的：S 你可以在这里看到：

![在此处输入图像描述](../Images/830d2acaa09e4613591259ae7dbd00cb.png)

```
<?
$im = imagecreatefromjpeg('a.jpg');
$f1 = imagecolorallocate($im, 39, 78, 231); 
$a = imagecreatetruecolor ( 520, 370 );
$red = imagecolorallocate($a, 39,78,231); 
for($x =130;$x<520;$x++)
{
for($y = 130; $y<370;$y++)
{
    $rgb = imagecolorat($im, $x, $y);
    $r = ($rgb >> 16) & 0xFF;
    $g = ($rgb >> 8) & 0xFF;
    $b = $rgb & 0xFF;

    $red = imagecolorallocate($a, $r,$g,$b); 
    //echo $r.$     g.$b."|";

    if( ($r < 100 && $r > 0) && ($g < 150 && $g > 0) && ($b < 255 && $b > 150))
        imagesetpixel($a, $x, $y, $red);
    if( ($r < 100 && $r > 0) && ($g < 255 && $g > 130) && ($b < 255 && $b > 0))
        imagesetpixel($a, $x, $y, $red);
    if( ($r < 200 && $r > 100) && ($g < 255 && $g > 180) && ($b < 80 && $b > 0))
        imagesetpixel($a, $x, $y, $red);
    if( ($r < 255 && $r > 0) && ($g < 255 && $g > 0) && ($b < 50 && $b > 0))
        imagesetpixel($a, $x, $y, $red);
    if( ($r < 255 && $r > 200) && ($g < 255 && $g > 70) && ($b < 70 && $b > 0))
        imagesetpixel($a, $x, $y, $red);
    if( ($r < 255 && $r > 200) && ($g < 100 && $g > 0) && ($b < 70 && $b > 0))
        imagesetpixel($a, $x, $y, $red);
    if( ($r < 120 && $r > 0) && ($g < 50 && $g > 0) && ($b < 50 && $b > 0))
        imagesetpixel($a, $x, $y, $red);
}
} 
//$rgb = imagecolorat($im, 550, 465);
//$r = ($rgb >> 16) & 0xFF;
//$g = ($rgb >> 8) & 0xFF;
//$b = $rgb & 0xFF;
//echo "$r $g $b";
header('Content-Type: image/png');
imagepng($a);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T23:08:26.060

用图像替换 kép.jpg。第一次尝试。我想我可以调整事情以更接近。

第二次尝试：地板似乎比圆形好得多。

第三次尝试：在代码中添加了 2 个过滤器。

```
<?php
header('content-type: image/png');
//header('content-type: text/plain');

$im = imagecreatefromjpeg ('images/a.jpg');
list($width, $height, $type, $attr) = getimagesize('images/a.jpg');

$im2 = imagecreate($width, $height);

$x = 540;
$y = 353;

$colors = array();

$num = 100;
$num2 = 15 * 11 * $num;
$num3 = 100;

$num4 = 65;
$num5 = 15 * 11 * $num4;
$num6 = 65;

imagecolorallocate($im2, 255, 255, 255);
for ($k = 0; $k < 7; $k ++) {
    $ar = 0;
    $ag = 0;
    $ab = 0;

    for ($i = 0; $i < 15; $i ++) {
        for ($j = 0; $j < 11; $j ++) {
            $tc = imagecolorat($im, $x + $i, $y + $j + $k * 18);
            $ar += ($tc >> 16) & 0xFF;
            $ag += ($tc >> 8) & 0xFF;
            $ab += $tc & 0xFF;
        }
    }

    $c = new STDClass();
    if ($k == 0) {
        $c->r = floor ($ar / $num5) * $num4;
        $c->g = floor ($ag / $num5) * $num4;
        $c->b = floor ($ab / $num5) * $num4;
    } else {
        $c->r = floor ($ar / $num2) * $num;
        $c->g = floor ($ag / $num2) * $num;
        $c->b = floor ($ab / $num2) * $num;
    }

    $c->c = imagecolorallocate($im2, $c->r, $c->g, $c->b);

    $colors[] = $c;

    imagefilledrectangle($im2, 0, $k * 11, 15, $k * 11 + 11, $c->c);
}

$pixelmap = array();
$pm2 = array();
for ($i = 0; $i < $width; $i ++) {
    $pixelmap[$i] = array();
    $pm2[$i] = array();
    for ($j = 0; $j < $height; $j ++) {
        $pixelmap[$i][$j] = false;
        $pm2[$i][$j] = false;
        $c = imagecolorat($im, $i, $j);

        $r = ($c >> 16) & 0xFF;
        $g = ($c >> 8) & 0xFF;
        $b = $c & 0xFF;

        $r = floor ($r / $num3) * $num3;
        $g = floor ($g / $num3) * $num3;
        $b = floor ($b / $num3) * $num3;

        $r2 = floor ($r / $num6) * $num6;
        $g2 = floor ($g / $num6) * $num6;
        $b2 = floor ($b / $num6) * $num6;

        for ($k = 0; $k < 7; $k ++) {
            $colorOK = true;
            if ($k == 0) {
                if ($r2 != $colors[$k]->r) { $colorOK = false; }
                if ($g2 != $colors[$k]->g) { $colorOK = false; }
                if ($b2 != $colors[$k]->b) { $colorOK = false; }
            } else {
                if ($r != $colors[$k]->r) { $colorOK = false; }
                if ($g != $colors[$k]->g) { $colorOK = false; }
                if ($b != $colors[$k]->b) { $colorOK = false; }
            }
            if ($colorOK) { break; }
        }

        if ($k < 7) { // else no mathing color was found
            $pixelmap[$i][$j] = $colors[$k]->c;
            //imagesetpixel($im2, $i, $j, $pixelmap[$i][$j]);
        }
    }
}

for ($i = 1; $i < $width - 1; $i ++) {
    for ($j = 1; $j < $height - 1; $j ++) {
        if ($pixelmap[$i][$j] !== false) {
            if ($pixelmap[$i    ][$j - 1] !== false ||
                $pixelmap[$i + 1][$j - 1] !== false ||
                $pixelmap[$i + 1][$j    ] !== false ||
                $pixelmap[$i + 1][$j + 1] !== false ||
                /*$pixelmap[$i  ][$j + 1] !== false ||*/
                $pixelmap[$i - 1][$j + 1] !== false ||
                $pixelmap[$i - 1][$j    ] !== false) {
                //imagesetpixel($im2, $i, $j, $pixelmap[$i][$j]);
            } else {
                $pixelmap[$i][$j] = false;
            }
            $pm2[$i][$j] = $pixelmap[$i][$j];
        } else {
            $surroundColors = array();
            if (isset($surroundColors[$pixelmap[$i - 1][$j - 1]])) { $surroundColors[$pixelmap[$i - 1][$j - 1]]++; } else { $surroundColors[$pixelmap[$i - 1][$j - 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i    ][$j - 1]])) { $surroundColors[$pixelmap[$i    ][$j - 1]]++; } else { $surroundColors[$pixelmap[$i    ][$j - 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i + 1][$j - 1]])) { $surroundColors[$pixelmap[$i + 1][$j - 1]]++; } else { $surroundColors[$pixelmap[$i + 1][$j - 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i + 1][$j    ]])) { $surroundColors[$pixelmap[$i + 1][$j    ]]++; } else { $surroundColors[$pixelmap[$i + 1][$j    ]] = 1; };
            if (isset($surroundColors[$pixelmap[$i + 1][$j + 1]])) { $surroundColors[$pixelmap[$i + 1][$j + 1]]++; } else { $surroundColors[$pixelmap[$i + 1][$j + 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i    ][$j + 1]])) { $surroundColors[$pixelmap[$i    ][$j + 1]]++; } else { $surroundColors[$pixelmap[$i    ][$j + 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i - 1][$j + 1]])) { $surroundColors[$pixelmap[$i - 1][$j + 1]]++; } else { $surroundColors[$pixelmap[$i - 1][$j + 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i - 1][$j    ]])) { $surroundColors[$pixelmap[$i - 1][$j    ]]++; } else { $surroundColors[$pixelmap[$i - 1][$j    ]] = 1; };

            $c = array_keys ($surroundColors);
            $pm2[$i][$j] = ($c[0] == false ? false : $c[0]);
            //imagesetpixel($im2, $i, $j, $c[0]);
        }
    }
}

$pixelmap = $pm2;
for ($i = 1; $i < $width - 1; $i ++) {
    for ($j = 1; $j < $height - 1; $j ++) {
        if ($pixelmap[$i][$j] !== false) {
            if ($pixelmap[$i    ][$j - 1] !== false ||
                $pixelmap[$i + 1][$j - 1] !== false ||
                $pixelmap[$i + 1][$j    ] !== false ||
                $pixelmap[$i + 1][$j + 1] !== false ||
                /*$pixelmap[$i  ][$j + 1] !== false ||*/
                $pixelmap[$i - 1][$j + 1] !== false ||
                $pixelmap[$i - 1][$j    ] !== false) {
                imagesetpixel($im2, $i, $j, $pixelmap[$i][$j]);
            } else {
                $pixelmap[$i][$j] = false;
            }
        } else {
            $surroundColors = array();
            if (isset($surroundColors[$pixelmap[$i - 1][$j - 1]])) { $surroundColors[$pixelmap[$i - 1][$j - 1]]++; } else { $surroundColors[$pixelmap[$i - 1][$j - 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i    ][$j - 1]])) { $surroundColors[$pixelmap[$i    ][$j - 1]]++; } else { $surroundColors[$pixelmap[$i    ][$j - 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i + 1][$j - 1]])) { $surroundColors[$pixelmap[$i + 1][$j - 1]]++; } else { $surroundColors[$pixelmap[$i + 1][$j - 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i + 1][$j    ]])) { $surroundColors[$pixelmap[$i + 1][$j    ]]++; } else { $surroundColors[$pixelmap[$i + 1][$j    ]] = 1; };
            if (isset($surroundColors[$pixelmap[$i + 1][$j + 1]])) { $surroundColors[$pixelmap[$i + 1][$j + 1]]++; } else { $surroundColors[$pixelmap[$i + 1][$j + 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i    ][$j + 1]])) { $surroundColors[$pixelmap[$i    ][$j + 1]]++; } else { $surroundColors[$pixelmap[$i    ][$j + 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i - 1][$j + 1]])) { $surroundColors[$pixelmap[$i - 1][$j + 1]]++; } else { $surroundColors[$pixelmap[$i - 1][$j + 1]] = 1; };
            if (isset($surroundColors[$pixelmap[$i - 1][$j    ]])) { $surroundColors[$pixelmap[$i - 1][$j    ]]++; } else { $surroundColors[$pixelmap[$i - 1][$j    ]] = 1; };

            $c = array_keys ($surroundColors);
            //$pixelmap[$i][$j] = $c[0];
            imagesetpixel($im2, $i, $j, $c[0]);
        }
    }
}

imagepng ($im2);
?> 
```

# c - c中argc的分段错误错误

> ID：10770149
> 
> 赞同：0
> 
> 时间：2012-05-26T22:07:30.120
> 
> 标签：c

我收到 argc 参数的分段错误错误。我是 C 语言的新手。请帮我解决这个问题。

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
    int row1, row2, col1, col2, i, j, cnt=0;
    int mat1[2000][2000], mat2[2000][2000];

    printf("argc=%d", argc);

    if (argc<5)
    {
    printf("\nPlease enter correct arguments <row_no_matrix1> <col_no_matrix1> <row_no_matrix2> <col_no_matrix2>\n");
    exit(0);
    }

    row1 = atoi(argv[1]);
    col1 = atoi(argv[2]);
    row2 = atoi(argv[3]);
    col2 = atoi(argv[4]);

    printf("%d %d %d %d\n", row1, row2, col1, col2);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T22:09:37.493

您的矩阵对于您机器上的堆栈来说太大了。每个数组有 400 万个整数，或大约 16 MiB 的存储空间；这是一个非常大的堆栈要求。

要么减小它们的大小，要么动态分配它们。

或者（如评论中所述），将它们变成具有“静态持续时间”的变量，或者在前面`main`的关键字中：`static`

```
int main(int argc, char *argv[])
{
    int row1, row2, col1, col2, i, j, cnt=0;
    static int mat1[2000][2000], mat2[2000][2000]; 
```

或作为外部定义的文件范围变量，前面`main()`也有关键字：`static`

```
static int mat1[2000][2000], mat2[2000][2000];

int main(int argc, char *argv[])
{
    int row1, row2, col1, col2, i, j, cnt=0; 
```

`main()`或作为没有关键字在外部定义的全局变量`static`（但仅当您有多个需要按名称访问它们的源文件时才这样做）：

```
int mat1[2000][2000], mat2[2000][2000];

int main(int argc, char *argv[])
{
    int row1, row2, col1, col2, i, j, cnt=0; 
```

您还可以（再次如评论中所述）增加堆栈大小。但是，我恭敬地建议这可能是最不令人满意的解决方案。

> 如何动态分配数组的大小？

公平的问题。您认为您真正需要一对 400 万个单元阵列的频率与您处理 100x100 阵列以下的频率相比？另外，您使用的是 Windows（使用 MSVC 和 C89）还是非 Windows（使用 C99 或更高版本），还是使用 GCC 的 Windows？

另外，你了解过指针吗？

总的来说，我认为你应该选择更小的数组。这是迄今为止最简单的解决方案。如果您必须有大数组，请使用静态分配的数组。

如果这不起作用，我们将不得不通过指针，但这并不漂亮。

# uipopovercontroller - 带有 UIPageViewController 的 UIPopoverController 不显示任何内容

> ID：10770152
> 
> 赞同：1
> 
> 时间：2012-05-26T22:07:49.617
> 
> 标签：uipopovercontroller, uipageviewcontroller

我尝试在弹出控制器的视图中显示不同视图控制器的视图。我现在尝试了三个小时，但没有成功。基本上这就是我所做的：

```
- (IBAction)buttonTapped:(id)sender {

    NSDictionary *options = [NSDictionary dictionaryWithObject: [NSNumber numberWithInteger:UIPageViewControllerSpineLocationMin] forKey:UIPageViewControllerOptionSpineLocationKey];
    UIPageViewController *pageVC = [[UIPageViewController alloc] initWithTransitionStyle:UIPageViewControllerTransitionStylePageCurl navigationOrientation:UIPageViewControllerNavigationOrientationHorizontal options:options];
    UIStoryboard *sb = [UIStoryboard storyboardWithName:@"MainStoryboard_iPad" 
                                             bundle:[NSBundle mainBundle]];
    UIViewController *firstVC = [sb instantiateViewControllerWithIdentifier:@"FirstTableViewController"];
    UIViewController *secondVC = [sb instantiateViewControllerWithIdentifier:@"SecondViewController"];
    NSArray *viewControllers = [[NSArray alloc] initWithObjects:firstVC, secondVC, nil];
    [pageVC setViewControllers:viewControllers direction:UIPageViewControllerTransitionStylePageCurl animated:NO completion:nil];

    UIButton *button = sender;
    UIPopoverController *popover = [[UIPopoverController alloc] initWithContentViewController:pvc];               
    [popover presentPopoverFromRect:button.frame inView:self.view permittedArrowDirections:UIPopoverArrowDirectionUp animated:YES];
} 
```

这就是我看到的：

![在此处输入图像描述](../Images/6827a6f4b97efe8f891e72b3aa10e495.png)

我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:54:00.247

好的，如果有人遇到类似的问题，我解决了：

似乎在初始化之后，您必须**准确设置一次所需的视图控制器的数量**。

因此，如果您创建一个`UIPageViewController`一次显示一个页面，请将一个包含完全（！）一个视图控制器的数组放入`setViewControllers:direction:animated:completion:`. 不止一个导致我的控制器什么也没显示。稍后可以通过实现`UIPageViewControllerDelegate`和`UIPageViewControllerDataSource`协议来延迟添加其他视图控制器。

# java - 通过本机 SQL 删除的子实体仍然存在于 entityManager 中

> ID：10770153
> 
> 赞同：1
> 
> 时间：2012-05-26T22:07:55.220
> 
> 标签：java, sql, hibernate

我在Java（hibernate 3.1）中有这样的代码：

```
EntityManager manager = ...;
Entity parent = manager.find(...);
removeChildrenSQL(parent, manager); // here DELETE FROM ... is executed
manager.flush(); 
```

我需要不再从休眠中看到已删除的实体。

我试过了（这些都没用）：

1) manager.refresh(父);

2）手动刷新删除的实体

3）重新加载所有孩子的父母。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T22:25:41.450

尝试

```
manager.detach(parent);
parent = manager.find(Entity.class, parent.getId()); 
```

（您可能还需要分离孩子，特别是如果您在移除它们之前对其进行了修改）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T22:26:04.477

呼吁`session.evict(childEntity)`所有孩子，其中 session 是您的休眠会话。

要获得休眠会话，请使用：

```
org.hibernate.Session session = (org.hibernate.Session)manager.getDelegate(); 
```

或者，如果您在会话 bean 中，您可以使用`@PersistenceContext`注释将其注入。

更新：也许您的问题与休眠的缓存有关。尝试设置

```
<shared-cache-mode>NONE</shared-cache-mode> 
```

在你的`prersistence.xml`. 之后， manager.refresh(parent) 应该可以解决问题。

更新2：或者孩子们可能在一个懒惰的集合中，在这种情况下你有两个解决方案：用以下方式注释孩子：

```
@OneToMany(cascade=CascadeType.REFRESH,fetch=FetchType.LAZY) 
```

在这种情况下，您仍然需要执行 manager.refresh(parent); 或使用：

```
 Hibernate.initialize(parent.getChidren()); 
```

# angularjs - AngularJS 中的模板引用之类的东西？

> ID：10770154
> 
> 赞同：10
> 
> 时间：2012-05-26T22:08:06.090
> 
> 标签：angularjs

我正在尝试创建一个布局完全由数据驱动的表单。

示例数据源：

```
{
    title : "Form Test",
    fields : [{
            name : "FieldA",
            type : "string",
            value : "initial value"
        }, {
            name : "FieldB",
            type : "selection",
            options : ["1", "2", "3"],
            value : "2"
        }, {
            name : "FieldC",
            type : "struct",
            value :
            [{
                    name : "FieldC1",
                    type : "string",
                    value : "initial value"
                }, {
                    name : "FieldC2",
                    type : "string",
                    value : "initial value"
                }
            ]
        }
    ]
} 
```

我认为可以使用 ng-repeat 和 ng-switch 来根据“类型”选择表单元素，但是当我到达“FieldC”时，当我递归地执行此操作时我会卡住。

```
<span ng-switch on="field.type">
    <div ng-switch-when="string">STRING: {{field.value}}</div>
    <div ng-switch-when="selection">SELECTION: {{field.value}}</div>
    <div ng-switch-when="struct">STRUCT: ????</div>
    <div ng-switch-default>DEFAULT:{{field.value}}</div>
</span> 
```

本质上，我想要一种方法，当我遇到“结构”时，它递归地将 ng-switch 应用于结构字段？有什么方法可以“引用”模板，以便可以在同一页面的多个位置使用它？对模板“部分”的支持似乎需要通过路由在服务器端进行协调，这在此处似乎有些过分。这是我需要开始深入研究创建自己的指令的地方吗？

**编辑**我只是偶然发现了[这个](http://jsfiddle.net/brendanowen/uXbn6/8/)看起来它有很大的机会做我想做的事情（我还没有正确测试它），这是在正确的方向吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-27T01:30:56.087

您需要构建一个指令来获取此类数据并从中构建表单。

处理递归的方法是将包括顶层在内的每一层都视为另一个结构。我在这里建立了一个版本：http: [//jsfiddle.net/U5Kyp/9/](http://jsfiddle.net/U5Kyp/9/)

确保您阅读了文档中的指令指南，以便了解发生了什么： http: [//docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-21T16:21:50.323

这是 angular.js 1.0.1 接受答案的更新 稳定版本中有一些不兼容的更改：

1.  ng-app 现在是必需的指令
2.  范围语法和语义已更改

[http://jsfiddle.net/9qAfM/1/](http://jsfiddle.net/9qAfM/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T00:45:07.567

在我看来，这是[内部平台效应](http://en.wikipedia.org/wiki/Inner-platform_effect)的一个糟糕案例。引用维基百科：“软件架构师倾向于创建一个可定制的系统，以成为他们正在使用的软件开发平台的复制品，而且通常是糟糕的复制品”。

AngularJS 已经有一个强大的机制来遍历对象树并从中构建一堆范围和控制器。你可能会争辩说这**正是 AngularJS 的本质**。

如果您被迫用这种可恶的 JSON 构建表单，我认为最简单的方法是将它们转换为 HTML（通过任何类型的简单模板语言，服务器端或客户端），然后使用 $compile 服务把它们变成一个 angularjs 应用程序。

# java - 类似于 Airbrake.io 的 Java 应用程序服务？

> ID：10770155
> 
> 赞同：4
> 
> 时间：2012-05-26T22:08:09.770
> 
> 标签：java, error-handling, airbrake

我们用java为[airbrake.io制作了自己的 api。](http://www.airbrake.io)这工作正常，但 airbrake 以某种 Rails 样式显示参数和堆栈跟踪。这有点烦人。任何人都知道为java制作的类似服务？

数据显示方式示例：

**参数**

```
{"controller"=>"", "action"=>""} 
```

**堆栈跟踪**

```
/testapp/app/models/user.rb:53:in `public'
/testapp/app/controllers/users_controller.rb:14:in `index' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T21:09:27.857

**更新 2015-02-13：**此服务不再存在。下面链接的 GitHub 帐户已消失，公司网站也已消失。

~~您是否尝试过使用 Coalmine [https://github.com/coalmine/coalmine_java](https://github.com/coalmine/coalmine_java)它意味着与 Coalmine 服务一起使用：[https ://getcoalmine.com/](https://getcoalmine.com/)~~

~~我在煤矿工作，我们已经在内部使用了一段时间。本周我们刚刚开源了 Java 连接器，我很乐意帮助您开始使用它。您可以通过 brad@builtfromsource.com 给我发送电子邮件~~

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:46:47.200

您是否尝试过使用[http://code.google.com/p/hoptoad/](http://code.google.com/p/hoptoad/)。它有点过时了，但它应该只需要将端点更新为[http://api.airbrake.io](http://api.airbrake.io)。

一个快速的谷歌将我带到[http://logdigger.com/](http://logdigger.com/)，它是专为 JAVA 特定网站设计的。

我在 Airbrake 工作，很高兴与您合作，让我们的网站对 JAVA 更友好。请联系 ben@airbrake.io，我会看看如何更好地显示 java 特定信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-07T01:37:31.990

只是添加到此处建议的其他内容，但 Raygun ( [http://raygun.io](http://raygun.io) ) 对 Java 具有一流的支持。

在这里阅读更多：[http ://raygun.io/java](http://raygun.io/java)

我为创建 Raygun 的 Mindscape 工作，因此可以回答您可能有的任何问题：jd@mindscape.co.nz。我们已经有大量的组织在他们的 Java 应用程序中使用 Raygun，尽管 Raygun 确实支持其他平台（.NET、Node、Rails、PHP 等）

# jquery - 捕获 DOM 元素的事件，除了具有特定类的事件

> ID：10770156
> 
> 赞同：0
> 
> 时间：2012-05-26T22:08:22.820
> 
> 标签：jquery, jquery-selectors

我有一组选项卡，想为`mouseover`它们添加功能。我不希望将此功能应用于`.active`.

标记：

```
<ul>
    <div class='tab'>my tab</div>
    <div class='tab' data-id='1'>your tab</div>
</ul>

<script>
  $('.tab').on('click',function(){
     $(this).addClass('active');
  });
</script> 
```

我试过这个：

```
$('.tab').not('.active').on('mouseover', function(){ 
```

和

```
$('.tab:not(.active)').on('mouseover', function(){ 
```

但这些都不起作用。我如何从该功能中排除该活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T22:30:41.293

> 一个可能的问题是我通过 addClass 添加活动以响应在另一部分中的单击。上面的语法会处理这个吗？

这就是问题所在。在加载时添加`mouseover`事件时，活动类不存在，因此`.not()`不排除任何内容。相反，您需要检查处理程序本身内部的类。

试试这个：

```
$('.tab').on('mouseover', function() {
    if (!$(this).hasClass("active")) {
        // your code here
        $(this).css("background-color", "#C00");
    }
});

$(".tab:last").addClass("active"); 
```

[**示例小提琴**](http://jsfiddle.net/9vJP2/2/)

# ruby-on-rails - rspec 触发“弃用警告：ActiveSupport::Concern 中的 InstanceMethods 模块将不再自动包含在内。”

> ID：10770160
> 
> 赞同：2
> 
> 时间：2012-05-26T22:08:58.447
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, scaffolding

我按照[http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)上的教程使用脚手架并添加了 rspec。到目前为止，我没有添加任何特殊代码。

做的时候...

```
rake spec 
```

...我收到以下大约 20 个警告：

> 弃用警告：ActiveSupport::Concern 中的 InstanceMethods 模块将不再自动包含在内。请直接在 RSpec::Rails::ViewExampleGroup 中定义实例方法。（从 /Users/pixtur/Projects/website-com/spec/views/welcome/index.html.haml_spec.rb:3 调用）

我不明白，这个错误试图告诉我什么。`index.html.haml_spec.rb`由脚手架创建，如下所示：

```
require 'spec_helper'

describe "welcome/index.html.haml" do
  pending "add some examples to (or delete) #{__FILE__}"
end 
```

我在用着`rails 3.2.3 / ruby 1.9.2`

我必须安装以下宝石：

*   actionmailer (3.2.3)

*   动作包（3.2.3）

*   活动模型（3.2.3）
*   活动记录（3.2.3）
*   活动资​​源（3.2.3）
*   主动支持 (3.2.3)
*   充当可标记 (2.2.2)
*   可寻址 (2.2.8)
*   雷尔 (3.0.2)
*   自动测试轨道（4.1.2）
*   建设者（3.0.0）
*   捆绑器 (1.1.3)
*   capistrano (2.12.0)
*   水豚 (1.1.2)
*   子进程（0.3.2）
*   咖啡轨 (3.2.2)
*   咖啡脚本（2.2.0）
*   咖啡脚本源 (1.3.3)
*   diff-lcs (1.1.3)
*   厄鲁比斯 (2.7.0)
*   执行js (1.4.0)
*   菲（1.0.11）
*   哈姆 (3.1.6)
*   haml-rails (0.3.4)
*   高线 (1.6.12)
*   远足 (1.2.1)
*   i18n (0.6.0)
*   旅程 (1.0.3)
*   jquery-rails (2.0.2)
*   json (1.7.3)
*   libv8 (3.3.10.4 x86_64-darwin-10)
*   libwebsocket (0.1.3)
*   邮件 (2.4.4)
*   哑剧类型 (1.18)
*   mini_magick (3.4)
*   multi_json (1.3.5)
*   mysql (2.8.1)
*   网络SCP（1.0.4）
*   网络 sftp (2.0.5)
*   网络SSH（2.5.2）
*   网络 ssh 网关 (1.1.0)
*   nokogiri (1.5.2)
*   多语言（0.3.3）
*   机架 (1.4.1)
*   机架缓存 (1.2)
*   机架 SSL (1.3.2)
*   机架测试（0.6.1）
*   导轨 (3.2.3)
*   铁路 (3.2.3)
*   耙子 (0.9.2.2, 0.8.7)
*   rdoc (3.12)
*   rspec (2.6.0)
*   rspec 核心 (2.6.4)
*   rspec-expectations (2.6.0)
*   rspec 模拟 (2.6.0)
*   rspec-rails (2.6.1)
*   rubygems 更新 (1.8.24)
*   rubyzip (0.9.8)
*   rvm (1.11.3.3)
*   rvm-capistrano (1.2.2)
*   萨斯（3.1.19）
*   sass-rails (3.2.5)
*   硒网络驱动程序（2.21.2）
*   链轮 (2.1.3)
*   子执行 (0.2.2)
*   therubyracer (0.10.1)
*   雷神 (0.14.6)
*   倾斜 (1.3.3)
*   树顶 (1.4.10)
*   tzinfo (0.3.33)
*   丑化者 (1.2.4)
*   xpath (0.1.4)
*   禅测 (4.8.0)

强烈欢迎任何有关如何摆脱警告的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-26T23:53:03.747

升级到最新版本的 rspec 后警告消失了：

rspec (2.10.0) rspec-core (2.10.1) rspec-expectations (2.10.0) rspec-mocks (2.10.1) rspec-rails (2.10.1)

# c# - 在新线程中使用 AnimateWindow

> ID：10770163
> 
> 赞同：0
> 
> 时间：2012-05-26T22:09:04.860
> 
> 标签：c#, multithreading, animatewindow

如何同时为两个窗口设置动画？我试过了：

```
 [DllImport("user32.dll", CharSet = CharSet.Auto)]
    static extern bool AnimateWindow(IntPtr hwnd, int time, int flags);
    ...

    AnimateWindow(panel1.Handle, speed, AW_SLIDE | AW_HOR_Top);
    AnimateWindow(panel2.Handle, speed, AW_SLIDE | AW_HOR_Top); 
```

但是在 panel1 完成动画之前， panel2 不会动画。

我必须使用线程..但即使我使用了调用我也不能..它也在第一个动画之后运行第二个动画

那我该怎么做呢？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-12-03T15:57:20.550

如果你想同时为 2 个windws 设置动画，那么我认为你将不得不使用一些线程的东西。但是正如您所说，您已经使用过它-我认为您的线程没有同步，您可能只是使用了两个线程而没有同步它们。将调用 animatewindow 的方法声明为同步并且它必须工作。

谢谢你。！！

# xml - WCF 400 错误请求错误

> ID：10770165
> 
> 赞同：1
> 
> 时间：2012-05-26T22:09:30.207
> 
> 标签：xml, rest, jquery, xml-parsing, wcf-rest

我有两个 Wcf 宁静服务 1\. 建议和 2.**搜索**。建议服务工作正常，但使用**Search 服务时****出现 400 错误**。**搜索服务被模拟为从 xml 返回**。搜索服务解析 xml 并返回对象。下面是代码。

 ****界面：

```
public interface IAirSearchResultsnew
    {
        [WebInvoke(Method = "GET", ResponseFormat = WebMessageFormat.Xml, BodyStyle = WebMessageBodyStyle.Bare, UriTemplate = "/GetAirsearchResults?" +
            "FT={FT}&SL={SL}&EL={EL}&SD={SD}&ED={ED}&FD={FD}&AD={AD}&CD={CD}&IN={IN}&" +
            "CL={CL}&DT={DT}&RT={RT}")]
        [OperationContract]
        airsearchresult GetAirSearchResult(string FT, string SL, string EL, string SD, string ED, string FD, string AD,
            string CD, string IN, string CL, string DT, string RT);
    } 
```

服务：

```
namespace Rickshaw.Services
{
    // NOTE: You can use the "Rename" command on the "Refactor" menu to change the class name "AirSearchResultsnew" in code, svc and config file together.
    public class AirSearchResultsnew : IAirSearchResultsnew
    {

        public airsearchresult GetAirSearchResult(string flightType, string from, string to, string start, string end, string flexibleDates, string adults, string children, string infants, string classPreference, string departTimePreference, string returnTimePreference)
        {
            #region Parameters read and convert to Proper form
            var startDate = start.Split('/');
            var endDate = end.Split('/');
            var SD = new DateTime(int.Parse(startDate[2]), int.Parse(startDate[0]), int.Parse(startDate[1]));
            var ED = new DateTime(int.Parse(endDate[2]), int.Parse(endDate[0]), int.Parse(endDate[1]));
            var FD = bool.Parse(flexibleDates);
            var AD = int.Parse(adults);
            int CD = 0;
            CD = int.Parse(children == "select" ? "0" : children);
            int IN = 0;
            IN = int.Parse(infants == "select" ? "0" : infants);
            var CL = string.Empty;
            CL = classPreference == "undefined" ? "NA" : classPreference;
            var DT = string.Empty;
            DT = departTimePreference == "undefined" ? "NA" : departTimePreference;
            var RT = string.Empty;
            RT = returnTimePreference == "undefined" ? "NA" : returnTimePreference;
            #endregion

            #region Mocked Service
            var reader = XmlReader.Create(@"C:\Users\Yash\Documents\Visual Studio 2010\Projects\WcfService1\Samples\sample2.xml");

            XmlSerializer serializer = new XmlSerializer(typeof(airsearchresult));

            var airsearchresults = serializer.Deserialize(reader) as airsearchresult;

            return airsearchresults;

            #endregion
        }
    }
} 
```

配置：

```
<configuration>
  <system.web>
    <trace enabled="true" requestLimit="100" />
    <customErrors defaultRedirect="~/Default.aspx" />
    <authorization>
      <allow roles="Administrators" />
    </authorization>
    <roleManager enabled="true" />
    <authentication mode="Forms" />
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="Suggest">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
          <dataContractSerializer ignoreExtensionDataObject="true" maxItemsInObjectGraph="999999999" />
        </behavior>
        <behavior name="AirSearch">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false"/>
          <dataContractSerializer ignoreExtensionDataObject="true" maxItemsInObjectGraph="999999999"/>
        </behavior>
      </serviceBehaviors>

      <endpointBehaviors>
        <behavior name="Rickshaw.Services.Suggest">
          <webHttp/>
        </behavior>
        <behavior name="Rickshaw.Services.AirSearchResultsnew">
          <webHttp/>
        </behavior>
      </endpointBehaviors>

    </behaviors>

    <services>
      <service name="Rickshaw.Services.Suggest" behaviorConfiguration="Suggest">
        <endpoint address="" binding="webHttpBinding" behaviorConfiguration="Rickshaw.Services.Suggest" contract="Rickshaw.Services.ISuggest" />
      </service>
      <service name="Rickshaw.Services.AirSearchResultsnew" behaviorConfiguration ="AirSearch">
        <endpoint address="" binding="webHttpBinding" behaviorConfiguration="Rickshaw.Services.AirSearchResultsnew" contract ="Rickshaw.Services.IAirSearchResultsnew" />
      </service>
    </services>

  </system.serviceModel>
</configuration> 
```

和Javascript代码：

```
var query = "http://localhost:4696/Services/AirSearchResultsnew.svc/GetAirSearchResults?" +
      "FT=" + FT + "&SL=" + SL + "&EL=" + EL + "&SD=" + SD + "&ED=" + ED + "&FD=" + FD + "&AD=" + AD + "&CD=" + CD + "&IN=" + IN + "&" +
            "CL=" + CL + "&DT=" + DT + "&RT=" + RT + "";
var result = getAirSearchResults(query);

function getAirSearchResults(query) {
    var module = {
        data: [null]
    };
    $.ajax({
        url: query,
        success: function (e) {
            console.log(e);
            module.data = e;
        },
        async: false,
        error: function (XHR, textStatus, errorThrown) {
            alert(textStatus + ":" + errorThrown);
        }
    });
    console.log(module.data);
    return module.data;
}; 
```

[重要的是我从这里](http://www.cleartrip.com/api/docs/air-api/schemas/search-result.xsd)提供的 xsd 创建了服务代理

[以及此处](http://www.cleartrip.com/api/docs/air-api/schemas/search-result.xml)提供的用于返回数据的 XML

我确信**调用会命中服务**并且**服务会正确解析 XML，**因为**我已经**通过服务对其进行了调试，但我不明白问题出在哪里。有什么帮助吗？****

# c++ - 如何在不使用 mutex、semorphore、spinLock 和 futex 的情况下进行线程同步？

> ID：10770171
> 
> 赞同：8
> 
> 时间：2012-05-26T22:10:24.763
> 
> 标签：c++, linux, multithreading, pthreads, mutex

这是一个面试问题，面试已经完成。

如何在不使用 mutex、semorphore、spinLock 和 futex 的情况下进行线程同步？

给定 5 个线程，如何让其中 4 个线程同时等待来自左线程的信号？这意味着当所有线程（1、2、3、4）在其线程函数中的某个点执行时，它们会停止并等待来自线程 5 的信号发送信号，否则它们将不会继续。

我的点子：

使用全局 bool 变量作为标志，如果线程 5 未将其设置为 true，则所有其他线程在某一时刻等待并将其标志变量设置为 true。线程 5 发现所有线程的 flag 变量为 true 后，将其设置 flag var true。

这是一个忙碌的等待。

有更好的主意吗？

谢谢

```
 the pseudo code:
 bool globalflag = false; 
 bool a[10] = {false} ;  
 int main()
 {
  for (int i = 0 ; i < 10; i++)
  pthread_create( threadfunc, i ) ; 

      while(1)
      {
         bool b = true; 
         for (int i = 0 ; i < 10 ; i++)
         {  
              b = a[i] & b ; 
         }
         if (b) break; 
    }
  }
  void threadfunc(i)
  {
   a[i] = true; 
   while(!globalflag); 
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T22:24:09.533

从等待线程的空链表开始。头部应设置为 0。

使用 CAS，比较和交换，在等待者列表的头部插入一个线程。如果head =-1，则不要插入或等待。如果操作正确，您可以安全地使用 CAS 在链表的头部插入项目。

插入后，等待线程应该在 SIGUSR1 上等待。使用 sigwait() 来执行此操作。

准备就绪后，信令线程使用 CAS 将等待列表的头部设置为 -1。这可以防止更多线程将自己添加到等待列表中。然后信号线程迭代等待列表中的线程并调用 pthread_kill(&thread, SIGUSR1) 唤醒每个等待线程。

如果 SIGUSR1 在调用 sigwait 之前发送，sigwait 将立即返回。因此，在将线程添加到等待列表和调用 sigwait 之间不会存在竞争。

编辑：

为什么 CAS 比互斥锁快？外行的回答（我是外行）。在某些情况下，它对某些事情的速度更快，因为在没有比赛时它的开销较低。因此，如果您可以将并发问题减少到需要更改 8-16-32-64-128 位的连续内存，并且不会经常发生争用，那么 CAS 获胜。CAS 基本上是一个稍微花哨/昂贵的 mov 指令，无论如何你都要做一个常规的“mov”。它是一个“锁交换”或类似的东西。

另一方面，互斥锁是一大堆额外的东西，它会使其他缓存线变脏并使用更多的内存屏障等。尽管 CAS 在 x86、x64 等上充当内存屏障。当然你必须解锁互斥量可能是大约相同数量的额外东西。

以下是使用 CAS 将项目添加到链表的方法：

```
while (1)
{
  pOldHead = pHead;  <-- snapshot of the world.  Start of the race.
  pItem->pNext = pHead;
  if (CAS(&pHead, pOldHead, pItem))  <-- end of the race if phead still is pOldHead
    break; // success
} 
```

那么，您认为您的代码多久会在该 CAS 行同时具有多个线程？实际上……不是很常见。我们做了测试，只是循环添加了数百万个项目，同时具有多个线程，而且发生的时间不到 1%。在真正的程序中，它可能永远不会发生。

显然，如果有一场比赛，你必须回去再做一次那个循环，但在链表的情况下，你要花多少钱？

不利的一面是，如果要使用该方法将项目添加到头部，则无法对该链接列表执行非常复杂的操作。尝试实现一个双链表。多么痛苦。

**编辑：**

在上面的代码中，我使用了一个宏 CAS。如果您使用的是 linux，CAS = 使用 __sync_bool_compare_and_swap 的宏。请参阅[gcc atomic builtins](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Atomic-Builtins.html)。如果您使用的是 Windows，则 CAS = 使用 InterlockedCompareExchange 之类的宏。下面是 Windows 中的内联函数的样子：

```
inline bool CAS(volatile WORD* p, const WORD nOld, const WORD nNew) { 
  return InterlockedCompareExchange16((short*)p, nNew, nOld) == nOld; 
}
inline bool CAS(volatile DWORD* p, const DWORD nOld, const DWORD nNew) {
  return InterlockedCompareExchange((long*)p, nNew, nOld) == nOld; 
}
inline bool CAS(volatile QWORD* p, const QWORD nOld, const QWORD nNew) {
  return InterlockedCompareExchange64((LONGLONG*)p, nNew, nOld) == nOld; 
}
inline bool CAS(void*volatile* p, const void* pOld, const void* pNew) {
  return InterlockedCompareExchangePointer(p, (PVOID)pNew, (PVOID)pOld) == pOld; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T08:18:35.600

1.  选择要使用的信号，例如 SIGUSR1。
2.  使用 pthread_sigmask 阻止 SIGUSR1。
3.  创建线程（它们继承信号掩码，因此必须先完成 1！）
4.  线程 1-4 调用 sigwait，阻塞直到收到 SIGUSR1。
5.  线程 5 使用 SIGUSR1 调用 kill() 或 pthread_kill 4 次。由于 POSIX 指定信号将被传递给未阻塞信号的线程，因此它将被传递给在 sigwait() 中等待的线程之一。因此，不需要跟踪哪些线程已经接收到信号，哪些没有，以及相关的同步。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T08:59:52.077

您可以使用 SSE3`MONITOR`和`MWAIT`指令来执行此操作，这些指令可通过[`_mm_mwait`](http://msdn.microsoft.com/en-US/library/7d7ytc18%28v=vs.80%29)和内在函数获得，英特尔在[此处](http://software.intel.com/en-us/articles/how-to-use-the-monitor-and-mwait-streaming-simd-extensions-3-instructions/)[`_mm_monitor`](http://msdn.microsoft.com/en-us/library/88w8339f%28v=vs.80%29.aspx)有一篇关于它的文章。（这里还有一个使用 memory-monitor-wait for lock contention 的专利，[这](http://www.google.com/patents/US20040267996)可能很有趣）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T03:05:51.913

我认为您正在寻找[Peterson 算法](http://en.wikipedia.org/wiki/Peterson%27s_algorithm)或[Dekker 算法](http://en.wikipedia.org/wiki/Dekker%27s_algorithm)

他们仅基于共享内存同步线程

# javascript - 使用 getElementBy 选择所有 ID 或类

> ID：10770172
> 
> 赞同：2
> 
> 时间：2012-05-26T22:10:28.030
> 
> 标签：javascript, getelementbyid, getelementsbyclassname

我有一个正在运行的脚本，我希望它选择所有 ID 或类，而不仅仅是第一个。

```
<script type = "text/Javascript" >
    function color(){
        var d=document.getElementsByClassName("black")[0];
        d.setAttribute("style", "background-color:#333;");
    }
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:14:55.090

1.  `[0]`in`document.getElementsByClassName("black")[0]`意味着您实际上在选择它们之后*丢弃*了除第一个之外的所有内容。如果要遍历返回的值，请使用循环`gEBCN`。
2.  `document.getElementsByTagName('*')`如果您想要*所有*元素，请使用。

* * *

```
function color() {
    var allElements = document.getElementsByTagName('*');
    for (var i=0; i<allElements.length; i++) {
        allElements[i].setAttribute('style', 'background-color:#333;');
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:17:07.177

要获取具有特定 ID 的所有元素，您可以依赖`querySelectorAll`，如

```
var d = document.querySelectorAll("#temp"); 
```

请记住一些事情：

1.  即使在句法上，具有相同 id 的多个元素在语义上也是错误的。
2.  `querySelectorAll`返回一个`NodeList`对象，而不是实时集合。这意味着如果您添加另一个 id 为“temp”的元素，那将不会出现在您获得的集合中，您必须再次调用 querySelectorAll。
3.  `querySelectorAll`IE7 和以前的版本不支持。

你已经有了答案`getElementsByClassName`。

# java - 标准输入/输出流

> ID：10770176
> 
> 赞同：0
> 
> 时间：2012-05-26T22:10:49.153
> 
> 标签：java, stdout, stdin

关于标准输入/输出，System 类的结构/设计如何？

System 类有一个公共的 final`out`方法，它返回一个`PrintStream`. 该`println()`方法是嵌套方法还是如果我调用它究竟是如何工作的`System.out.println();`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T22:15:06.470

`out`是一个`public static final`变量，因为它是静态的，所以可以得到`out`as `System.out`（即以静态方式）。

`out`是一个`PrintStream`包含该方法的`println()`方法，并且您正在从（即，从）访问该`println()`方法。`PrintStream``out`

# c++ - 将矩阵写入字符串

> ID：10770179
> 
> 赞同：0
> 
> 时间：2012-05-26T22:11:17.017
> 
> 标签：c++, matrix

假设您有一个 N*M 浮点矩阵，我想要一个 C++ 函数将此矩阵转换为字符串缓冲区（使用 \t 作为同一行的值之间的分隔符，使用 \n 作为返回新行），一些像：

```
String converteMatrixToString( vector< vector<float> > )
{
   /* ... */
   return converted;
} 
```

是否有任何现有的 C++ 函数可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:19:03.947

如果您的矩阵是实际类型，则可以使其输出可流式传输，这是使事物“可转换为字符串”的首选方式。这将允许您将矩阵输出到`std::cout`或任何其他类型的流，包括使用`std::lexical_cast`.

现在，您能做的最好的事情就是使用`std::ostringstream`. 这里是伪代码：

```
std::ostringstream stream;

foreach( row in matrix )
{
   foreach( value in row )
       stream << value << '\t';
   stream << '\n';
}

return stream.str(); 
```

# ios - AVAudioRecorder 通过将 FFT 加速到频率 - 执行

> ID：10770180
> 
> 赞同：4
> 
> 时间：2012-05-26T22:11:29.927
> 
> 标签：ios, fft, avaudiorecorder, accelerate-framework

我的主要目标：找到通过 AVAudioRecorder 引入的噪音的频率。我遵循了这个：

[http://www.ehow.com/how_12224909_detect-blow-mic-xcode.html](http://www.ehow.com/how_12224909_detect-blow-mic-xcode.html)

我已经阅读了许多关于 SO 的问题，询问如何检测频率。大多数答案说：“使用 FFT！” 然后提问者说：“哦，太好了！”。

我的问题是，你如何从这里得到：

```
- (void)levelTimerCallback {
    [recorder updateMeters];

    const double ALPHA = 0.05;
    double peakPowerForChannel = pow(10, (0.05 * [recorder peakPowerForChannel:0]));
    lowPassResults = ALPHA * peakPowerForChannel + (1.0 - ALPHA) * lowPassResults;  

    if (lowPassResults > sensitivitySlider.value) {
        NSLog(@"Sound detected");

        //What goes here so I can spit out a frequency?
    }

} 
```

不知何故神奇地使用 FFT...（我将使用加速.h），

并以“频率= 450.3”结束？

如果有人可以向我展示我将使用的实际代码

1.  将来自 AVAudioRecorder 的声音插入 Accelerate 和
2.  如何将结果转化为频率...

那将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T19:39:13.793

什么都没有，因为 AVRecorder API 没有插入 Accelerate 框架。相反，您必须使用完全不同的 API，Audio Queue 或 RemoteIO Audio Unit API，来捕获音频输入，完全不同的代码安排，例如等待回调获取数据，缓冲区大小管理以获取数据数组合适的大小来馈送 FFT，然后知道足够的 DSP 以对您正在寻找的特定类型的频率测量的 FFT 结果进行后处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-16T15:12:52.677

好吧，事实证明有些东西可以“去那里”。我没有使用 Accelerate，而是在亚马逊上买了一本关于傅立叶分析的书，并用它来构建我自己的 FFT。它吐出的不是一个单一的频率，而是许多频率中每个频率的电平，这基本上是我想要的。

这是我的 FFT 计算课程：

```
class FFTComputer: NSObject {

class func integerBitReverse(_ input:Int,binaryDigits:Int) -> Int {

    return integerForReversedBooleans(booleansForInt(input, binaryDigits: binaryDigits))
}

class func integerForReversedBooleans(_ booleans:[Bool]) -> Int {

    var integer = 0

    var digit = booleans.count - 1
    while digit >= 0 {
        if booleans[digit] == true {
            integer += Int(pow(Double(2), Double(digit)))
        }
        digit -= 1
    }

    return integer
}

class func Pnumber(_ k:Int,placesToMove:Int, gamma:Int) -> Int {

    var booleans = booleansForInt(k, binaryDigits: gamma)

    for _ in 0 ..< placesToMove {
        booleans.removeLast()
        booleans.insert(false, at: 0)
    }

    return integerForReversedBooleans(booleans)
}

class func booleansForInt(_ input:Int,binaryDigits:Int) -> [Bool] {

    var booleans = [Bool]()
    var remainingInput = input

    var digit = binaryDigits - 1
    while digit >= 0 {
        let potential = Int(pow(Double(2), Double(digit)))
        if potential > remainingInput {
            booleans.append(false)
        } else {
            booleans.append(true)
            remainingInput -= potential
        }
        digit += -1
    }

    return booleans
}

class func fftOfTwoRealFunctions(_ realX1:[CGFloat], realX2:[CGFloat], gamma:Int) -> (([CGFloat],[CGFloat]),([CGFloat],[CGFloat])) {

    let theFFT = fft(realX1, imaginaryXin: realX2, gamma: gamma)
    var R = theFFT.0
    var I = theFFT.1
    let N = Int(pow(2.0, Double(gamma)))

    var realOut1 = [CGFloat]()
    var imagOut1 = [CGFloat]()
    var realOut2 = [CGFloat]()
    var imagOut2 = [CGFloat]()

    for n in 0..<N {

        var Rback:CGFloat
        var Iback:CGFloat
        if n == 0 {
            Rback = R[0]
            Iback = I[0]
        } else {
            Rback = R[N-n]
            Iback = I[N-n]
        }

        realOut1.append(CGFloat(R[n]/2 + Rback/2))
        realOut2.append(CGFloat(I[n]/2 + Iback/2))
        imagOut1.append(CGFloat(I[n]/2 - Iback/2))
        imagOut2.append(-CGFloat(R[n]/2 - Rback/2))
    }

    return ((realOut1,imagOut1),(realOut2,imagOut2))
}

class func fft(_ realXin:[CGFloat], imaginaryXin:[CGFloat], gamma:Int) -> ([CGFloat],[CGFloat]) {

    var realX = realXin
    var imaginaryX = imaginaryXin

    let N = Int(pow(2.0, Double(gamma)))
    var N2 = N/2
    var NU1 = gamma - 1 // Always equals (gamma - l)

    var realWP:Double = 1
    var imaginaryWP:Double = 0
    var redoPCounter = 0

    func redoP(_ k:Int, places:Int) {

        let P = Pnumber(k, placesToMove:places, gamma: gamma)
        let inside = (-2*Double.pi*Double(P))/Double(N)
        realWP = cos(inside)
        imaginaryWP = sin(inside)
    }

    var l = 1
    while l <= gamma {
        var k = 0
        var I = 1
        while k < N - 1 {

            if redoPCounter == N2 {
                redoP(k,places: NU1)
                redoPCounter = 0
            }
            redoPCounter += 1
//                Swift.print(realX.count,imaginaryX.count,k+N2)
            let realT1 = (realWP*Double(realX[k + N2]))-(imaginaryWP*Double(imaginaryX[k + N2]))
            let imaginaryT1 = (realWP*Double(imaginaryX[k + N2]))+(imaginaryWP*Double(realX[k + N2]))

            realX[k+N2] = realX[k] - CGFloat(realT1)
            imaginaryX[k+N2] = imaginaryX[k] - CGFloat(imaginaryT1)

            realX[k] = realX[k] + CGFloat(realT1)
            imaginaryX[k] = imaginaryX[k] + CGFloat(imaginaryT1)

            k += 1
            if I == N2 {
                k += N2
                I = 1
            } else {
                I += 1
            }
        }
        N2 = N2/2
        NU1 = NU1 - 1
        redoPCounter = 0
        realWP = 1
        imaginaryWP = 0
        l += 1
    }
    for k in 0 ..< N - 1 {
        let i = integerBitReverse(k, binaryDigits:gamma)
        if i > k {

            let placeholderReal = realX[k]
            let placeholderImaginary = imaginaryX[k]

            realX[k] = realX[i]
            imaginaryX[k] = imaginaryX[i]

            realX[i] = placeholderReal
            imaginaryX[i] = placeholderImaginary
        }
    }

    return (realX,imaginaryX)
}

class func magnitudeAndPhasePresentations(_ realX:[CGFloat], imaginaryX:[CGFloat]) -> ([CGFloat],[CGFloat]) {

    var magnitudes = [CGFloat]()
    var phases = [CGFloat]()

    var lastMagnitude:CGFloat = 0
    var lastPhase:CGFloat = 0

    for n in 0 ..< realX.count {
        let real = realX[n]
        let imaginary = imaginaryX[n]

        if real != 0 {
            lastMagnitude = sqrt(pow(real, 2)+pow(imaginary, 2))
            lastPhase = atan(imaginary/real)
        }
        magnitudes.append(lastMagnitude)
        phases.append(lastPhase)
    }
    return (magnitudes,phases)
}

class func magnitudePresentation(_ realX:[CGFloat], imaginaryX:[CGFloat]) -> [CGFloat] {

    var magnitudes = [CGFloat]()

    var lastMagnitude:CGFloat = 0

    for n in 0 ..< realX.count {
        let real = realX[n]
        let imaginary = imaginaryX[n]

        if real != 0 {
            lastMagnitude = sqrt(pow(real, 2)+pow(imaginary, 2))
        }
        magnitudes.append(lastMagnitude)
    }
    return magnitudes
}
} 
```

为了获得音频，我使用了 Novocaine：[https ://github.com/alexbw/novocaine](https://github.com/alexbw/novocaine)

我建议阅读一些有关傅立叶变换的内容，但将 Novocaine（麦克风）中的数据插入 FFTComputer 并取回一些频率确实并不难。

（2 到 gamma 是 realXin 的计数。我本来可以计算 gamma，所以如果你想更改它，请继续。只需将 Novocaine 数据转换为 CGFloats 数组，将其放入 realXin，放入一个空数组在 imagXin 中设置相同的大小，然后输入正确的 gamma。然后，可以绘制输出以查看频率。）

# c++ - 移动构造函数应该采用 const 还是非 const 右值引用？

> ID：10770181
> 
> 赞同：42
> 
> 时间：2012-05-26T22:11:55.417
> 
> 标签：c++, c++11, rvalue-reference, move-constructor

在几个地方，我看到推荐的复制和移动构造函数签名如下：

```
struct T
{
    T();
    T(const T& other);
    T(T&& other);
}; 
```

复制构造函数采用 const 引用，而移动构造函数采用非 const 右值引用。

但据我所见，这阻止了我在从函数返回 const 对象时利用移动语义，例如以下情况：

```
T generate_t()
{
    const T t;
    return t;
} 
```

使用 VC11 Beta 进行测试，`T`调用的是复制构造函数，而不是移动构造函数。即使使用`return std::move(t);`复制构造函数仍然被调用。

我可以看到这是有道理的，因为`t`const 所以不应该绑定到`T&&`. 在移动构造函数签名中使用`const T&&`效果很好，并且很有意义，但是您会遇到问题，因为`other`是 const，如果需要将其成员清空，则不能将其清空 - 只有当所有成员都是标量时，它才会起作用或具有正确签名的移动构造函数。

它看起来是确保在一般情况下调用移动构造`t`函数以首先制作非常量的唯一方法，但我不喜欢这样做 - 构造事物是一种很好的形式，我不希望客户`T`知道他们必须反对这种形式才能提高性能。

所以，我想我的问题是双重的；首先，移动构造函数应该采用 const 还是非 const 右值引用？第二：我的推理是否正确？我应该停止返回 const 的东西吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-26T22:21:40.810

它应该是一个非`const`右值引用。

如果一个对象被放置在只读内存中，你就不能从中窃取资源，即使它的正式生命周期即将结束。允许在 C++ 中创建的对象`const`存在于只读内存中（`const_cast`尝试更改它们会导致未定义的行为）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-26T22:38:27.647

移动构造函数通常应该采用非常量引用。

如果可以从 const 对象移动，通常意味着复制对象与从对象“移动”一样有效。在这一点上，拥有移动构造函数通常没有任何好处。

你也是正确的，如果你有一个你可能想要从中移动的变量，那么它需要是非常量的。

据我了解，这就是 Scott Meyers 改变了他关于从 C++11 的函数中按值返回类类型对象的建议的原因。通过 const 限定值返回对象确实可以防止无意修改临时对象，但它也禁止从返回值移动。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-26T22:38:39.273

**移动构造函数应该采用 const 还是非 const 右值引用？**

它应该采用**非常量右值引用**。右值引用首先在它们的 const 形式中没有意义，仅仅因为你想修改它们（在某种程度上，你想**“移动”**它们，你自己想要它们的内部结构）。

此外，它们被设计为在**没有const 的情况下使用，我相信 const 右值引用的唯一用途是 Scott Meyers 在**[本次](http://skillsmatter.com/podcast/home/move-semanticsperfect-forwarding-and-rvalue-references)演讲中提到的非常神秘的东西（从 42:20 到 44:47）。

**我的推理是否正确？我应该停止返回 const 的东西吗？**

这是一个太笼统的问题，我认为无法回答。在这种情况下，我认为值得一提的是，有一些`std::forward`功能可以同时保留右值性和左值性以及常量性，并且如果您返回传递给它的任何内容，它还将避免像普通函数那样创建临时函数.

这种返回还会导致**右值引用**被“损坏”为**左值引用**，您通常不希望这样，因此，使用上述功能进行完美转发可以解决问题。

话虽如此，我建议您只需看一下我发布链接的演讲。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-05-31T04:49:25.140

除了其他答案中所说的之外，有时移动构造函数或函数接受`const T&&`. 例如，如果您将一个`const`按值返回对象的函数的结果传递给构造函数，`T(const T&)`它将被调用而不是`T(T&&)`像人们可能期望的那样（参见`g`下面的函数）。

这就是删除接受的重载[而](https://en.cppreference.com/w/cpp/utility/functional/ref)不是接受的重载的原因。**`const`**`T&&`[`std::ref``std::cref`](https://en.cppreference.com/w/cpp/utility/functional/ref)`T&&`

具体来说，重载解析期间的优先顺序如下：

```
struct s {};

void f (      s&);  // #1
void f (const s&);  // #2
void f (      s&&); // #3
void f (const s&&); // #4

const s g ();
s x;
const s cx;

f (s ()); // rvalue        #3, #4, #2
f (g ()); // const rvalue  #4, #2
f (x);    // lvalue        #1, #2
f (cx);   // const lvalue  #2 
```

有关更多详细信息，请参阅[本文](https://codesynthesis.com/~boris/blog/2012/07/24/const-rvalue-references/)。

# objective-c - 此处是否需要使用#import？

> ID：10770183
> 
> 赞同：0
> 
> 时间：2012-05-26T22:12:28.520
> 
> 标签：objective-c

`Rectangle`在我遗漏的实施部分中，`#import "XYpoint"`它对我来说仍然有效。是在进行`#import "XYpoint"`良好的实践还是会影响计划？

```
#import <Foundation/Foundation.h>

@interface XYPoint : NSObject 
@property int x, y;

-(void) setX: (int) xVar andY: (int) yVar;

@end 
```

* * *

```
#import "XYpoint.h"

@implementation XYPoint
@synthesize x, y;

-(void) setX:(int)xVar andY:(int)yVar {
    x = xVar;
    y = yVar;
}

@end 
```

* * *

```
 #import <Foundation/Foundation.h>

    @class XYPoint;
    @interface Rectangle: NSObject

    -(XYPoint *) origin;
    -(void) setOrigin: (XYPoint *) pt; 
@end 
```

* * *

```
#import "Rectangle.h"
#import "XYpoint.h"

@implementation Rectangle {
    XYPoint *origin;
}

-(void) setOrigin:(XYPoint *)pt {
    origin = pt;
}
-(XYPoint *) origin {
    return origin;
}

@end 
```

* * *

```
#import "XYpoint.h"
#import "Rectangle.h"

int main (int argc, char * argv[]) {
    @autoreleasepool {
        Rectangle *rect = [[Rectangle alloc] init];
        XYPoint *pointy = [[XYPoint alloc] init];

        [pointy setX:5 andY:2];
        rect.origin = pointy;

        NSLog(@"Origin %i %i", rect.origin.x, rect.origin.y);
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T01:37:47.260

您的实现`Rectangle`不使用`XYPoint`该类的任何细节。它只是将其视为通用指针，从不发送消息或取消引用它。因此，前向声明（接口文件`@class`中的语句`Rectangle`）就足够了。导入头文件对编译后的程序没有任何影响。

您的类很可能`Rectangle`最终会演变为关心`XYPoint`类的接口。当它这样做时，它将需要导入该接口声明。如果您忽略导入它，编译器会警告您。

也就是说，几乎没有理由不导入它。

# c++ - 根据用户输入排序或合并排序

> ID：10770185
> 
> 赞同：0
> 
> 时间：2012-05-26T22:13:36.040
> 
> 标签：c++

我正在尝试根据用户输入调用函数。我无法弄清楚我做错了什么。我不断收到此错误

```
error: no matching function for call to 'sort(std::vector<int, std::allocator<int> >&)' 
```

有人可以告诉我我做错了什么。请彻底解释任何建议，因为我是 C++ 的新手。这是我的代码：

```
#include <iterator>
#include <algorithm>
#include <vector>
#include <fstream>
#include <iostream>
#include <string>

std::ifstream in("");
std::ofstream out("outputfile.txt");
std::vector<int> numbers;
std::string sortType = "";
std::string file = "";

int main()
{
  std::cout << "Which type of sort would you like to perform(sort or mergesort)?\n";
  std::cin >> sortType;

  std::cout << "Which file would you like to sort?\n";
  std::cin >> file;

  //Check if file exists
  if(!in)
  {
    std::cout << std::endl << "The File is corrupt or does not exist! ";
    return 1;
  }

  // Read all the ints from in:
  copy(std::istream_iterator<int>(in), std::istream_iterator<int>(),
            std::back_inserter(numbers));

  //check if the file has values
  if(numbers.empty())
  {
      std::cout << std::endl << "The file provided is empty!";
      return 1;
  } else
  {
      if(file == "sort")
      {
          sort(numbers);
      }else
      {
          mergeSort();
      }
  }
}

void sort(std::vector<int>)
{

  // Sort the vector:
  sort(numbers.begin(), numbers.end());

  unique(numbers.begin(), numbers.end());

  // Print the vector with tab separators:
  copy(numbers.begin(), numbers.end(),
            std::ostream_iterator<int>(std::cout, "\t"));
  std::cout << std::endl;

    // Write the vector to a text file
  copy(numbers.begin(), numbers.end(),
            std::ostream_iterator<int>(out, "\t"));
    std::cout << std::endl;
}

void mergeSort()
{
      //mergesort code..
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T22:18:03.280

您需要`sort`在调用它之前声明该函数。把它的定义移到上面`main`，或者放在`void sort(std::vector<int>);`前面`main`。

也是如此`mergeSort`。

您还应该将调用完全限定`sort(numbers.begin(), numbers.end());`为,`std::sort(numbers.begin(), numbers.end());`和 , 相同。如果你不这样做，那么由于技术原因称为“ADL”，如果你愿意，你可以查找它，那么只有当你调用它的参数（迭代器）是 namespace 中的类时，调用才会编译。这取决于具体的实现，因此调用在某些编译器上不起作用。`copy``unique``std`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T09:57:19.683

我同意@steve 在 main() 之前声明排序函数。

我认为这里的问题是您正在`sort()`使用参数调用函数，`std::vector`但是在函数的定义中您刚刚编写了接收参数的类型，您还应该为变量编写一些名称。例如。

`void sort(std::vector<int> <variable_name>) { //definition }`

我要指出的另一件事是，由于您已经`number`全局声明了向量，因此无需调用 like `sort(number)`，因为函数会自动找到全局定义的向量`number`。所以基本上如果你想`number`全局定义向量，那么函数`sort()`应该是无参数的。

您还在任何地方都使用了范围，而是可以在s -`std::`之后添加一行`#include`

`using namespace std;`

我希望它有效！

# jquery - 使用嵌套 jQuery $.when 时，异步处理会产生意想不到的结果

> ID：10770188
> 
> 赞同：1
> 
> 时间：2012-05-26T22:13:57.040
> 
> 标签：jquery, asynchronous, jquery-deferred

我有许多 ajax 调用，每个调用都会触发其他 ajax 调用。然后我想等待后者以处理来自它们的数据。这是（伪）代码：[https](https://gist.github.com/2795435) ://gist.github.com/2795435 问题是第二个`$.when-always`表达式的回调函数在`promises2`数组的所有延迟都被解析/拒绝之前被触发。怎么会这样？正如我所看到的，第一个`$.when-always`回调将不会被调用，直到 promises1 数组的所有延迟都被解决/拒绝，并且到那时所有 ajax 调用都已经完成，因此在所有延迟之前不应该调用`promises2`第二个回调已解决/拒绝`$.when-always`。`promises2`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T01:21:10.743

看起来，在`await()`jQuery中，总是在触发与*last*`promises1`关联的回调之前触发回调以进行响应。因此，在 中，当内部触发其始终回调时，数组缺少一个承诺。 *`getJson``await()``promises2``.when()`*

 *如果我是对的，那么您应该能够运行测试以显示（`.get()`每个 json 响应一个），在每种情况下，除了一个内部`.get`s（永远不会更多也永远不会更少）将在`doSomethingToTheDataStoredInSomeGlobalVariableBelow()`被调用时完成。

无论我是否正确，一种解决方法（不是我确定的唯一一种）将是以下几点：

```
function A() {
    var promisesA = [];
    for (var i = start; i < end; i++) {
        promisesA.push( B(someUri) );
    }
    $.when.apply($, promisesA).always(function() {
        doSomethingToTheDataStoredInSomeGlobalVariableBelow();
    });
}

function B(uri) {
    var d = new $.Deferred(),
        promisesB = [];
    $.getJSON(uri, function(data) {
        someCollectionFrom_data.each(function () {
            promisesB.push($.get(someUriFrom_this, function(data) {
                extractSomeStuffFrom_data_AndStoreInSomeGlobalVariable();
            }));
        });
        $.when.apply($, promisesB).done(function() {
            d.resolve();
        }).fail(function() {
            d.reject();
        });

    }).error(function(){
        d.reject();
    });
    return d;
} 
```

[这是一个演示](http://jsfiddle.net/mcdmz/)- 修改了代码以使其像小提琴一样工作。

在这里（除了错误），数组像以前一样`promisesA`填充了一个，但是这`$.Deferred`一次，当它们对应的解析/失败`uri`时，不允许这些 Deferred 自动解析。`getJSON`相反，每个 Deferred 都是“手动”解决的，因为它的所有关联`.get()s`都已解决/失败，由 function`B()`的数组管理`promisesB`（其中将有几个实例，每个实例都在由 形成的闭包中捕获`B()`）。

该模式可以被视为 ajax 调用 (`.json()s`和`.get()s`) 的“向下”级联，而`.always()s`. （混合`.done()`//将同样适用。）`.fail()``.always()`*

# php - 结构：包含需要的文件

> ID：10770191
> 
> 赞同：1
> 
> 时间：2012-05-26T22:14:38.223
> 
> 标签：php, structure

在一个新项目中，我正在考虑在他们自己的单独文件中分离一些功能，因此我需要在需要时包含它们。例如，数据库对象将有一个启动它的文件。我将有一个“会话”文件来处理所有会话初始化（session_start() 劫持检查等）这将导致我只需要包含所需的文件。

**这是一种可维护的方法吗？将所有这些功能分开在不同的文件中并仅在需要时才需要它们是否有意义？**

例如，在静态“关于”页面上，我不需要 db 文件，因此我不会包含 db 文件。我有时间限制，我并没有很强烈地开始使用 MVC，但我想保持一个仍然可维护的结构，并且不会对未来的性能造成任何问题。我正在使用 php，因此是 php 标签。

一个文件可能如下所示：

```
<?php
require_once 'session.php';
require_once 'config.php';
require_once 'db.php';

//... 
```

意思是另一个人只会有这个：

```
<?php
require_once 'config.php';

//... 
```

等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T22:18:03.900

我的眼睛完全可以接受。

当然，只要您的代码经过良好的注释和清洁，就可以维护。确保保持正确的导入顺序，因为可能在会话一之前包含数据库一，例如会使后者停止工作。

如果这就是您所要求的，这比到处都有重复的代码更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:05:44.410

In my opinion it is good practice to separate such functionality as you have done so. This make the code more maintainable and easier to correct bugs.

What may be of interest to you is the autoload feature that was added in PHP5\. This may make it easier [http://php.net/manual/en/language.oop5.autoload.php](http://php.net/manual/en/language.oop5.autoload.php)

# jquery - 按钮不显示

> ID：10770202
> 
> 赞同：1
> 
> 时间：2012-05-26T22:16:45.087
> 
> 标签：jquery, xhtml

你知道为什么对话框关闭后文档中的按钮在Firefox 12中没有重新出现吗？

```
<html>
    <head>
        <link type="text/css" href="jqueryui/css/smoothness/jquery-ui-1.8.20.custom.css" rel="Stylesheet" />    

        <script type="text/javascript" src="jqueryui/js/jquery-1.7.2.min.js"></script>
        <script type="text/javascript" src="jqueryui/js/jquery-ui-1.8.20.custom.min.js"></script>

        <style></style>

        <script type="text/javascript">
            $(document).ready(function() {
                $("#click").click(function() {
                    $("#dialog").attr("title", "save").text("This is the dialog box!").dialog({
                        buttons: {
                            "OK": function() {
                                $(this).dialog("close");
                            }
                        }
                    });
                });
            });
        </script>
    </head>

    <body>
        <div id="dialog" title="Basic dialog">
            <input type="button" value="click" id="click" />
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T22:30:47.030

**工作演示** [http://jsfiddle.net/jyy96/6/](http://jsfiddle.net/jyy96/6/)

您的按钮位于`dialog`输入内部，因此它会丢失。

移入移出对话框外提交`div`

**珠宝代码**

```
$(document).ready(function() {
    $("#click").click(function() {
        $("#dialog").attr("title", "save").text("This is the dialog box!").dialog({
            buttons: {
                "OK": function() {
                    $(this).dialog("close");
                }
            }
        });
    });
});​ 
```

**html**

```
<body>
    <input type="button" value="click" id="click" />
    <div id="dialog" title="Basic dialog"></div>
</body> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T22:26:42.103

您在对话框中有**按钮**，在对话框关闭后，**它会被**`CSS`内联`dialog()`：

```
display: none;
... 
```

如果您需要按钮始终存在，它应该在对话框内容之外。

**示例 HTML**

```
<body> 
    <input type="button" value="click" id="click" /> 
    <div id="dialog" title="Basic dialog"></div> 
</body> 
```

# java - 如何发送键盘输出

> ID：10770205
> 
> 赞同：4
> 
> 时间：2012-05-26T22:17:43.297
> 
> 标签：java, keyboard

我可以导入什么来模拟java中的键盘按下？

因此，例如，我可以使用它来制作一个程序，以便在事件发生时自动按下“a”键。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-26T22:19:06.180

你需要的一切都在`java.awt.Robot`

例子：

```
Robot robot = new Robot(); 
robot.keyPress(KeyEvent.VK_A); 
```

# c++ - 将参数作为对函数/方法的引用的性能相关问题

> ID：10770207
> 
> 赞同：0
> 
> 时间：2012-05-26T22:17:44.680
> 
> 标签：c++, performance, function, constants, pass-by-reference

当将参数传递给将在短时间内被调用数百万次的函数和方法时，传递所述参数的开销开始显现。

void foo(const SomeType& st) { ... }

对于 std::string、std::vector 等类型，规则是通过引用传递，这样就不会出现无意义的复制。然而，在处理诸如双打、整数等 POD 时，情况就完全不同了。

关于性能，如果函数/方法不需要改变参数，那么在决定是否应该通过引用、常量引用或复制传递时，常见的“需要注意的事项”是什么？

```
void foo1(SomeType& st)
{
   ...
}

void foo2(const SomeType& st)
{
   ...
}

void foo3(SomeType st)
{
   ...
}

void foo4(SomeType* st)
{
   ...
} 
```

*   是否应该始终通过副本传递 int/unsigned int？
*   是否应该仅在 64 位或更高的目标上通过副本传递双精度？
*   如果函数可以内联 - 参数的传递方式是否重要？
*   通过 ref/const ref 传入时，别名如何影响问题？
*   在什么情况下，参数的显式副本对堆栈有益？

注意：这不是关于 const 正确性的问题。还寻找与 32/64 位平台上的 gcc 和 msvc 相关的答案。

一些可能相关的问答：

["const T &arg" 与 "T arg"](https://stackoverflow.com/questions/1567138/const-t-arg-vs-t-arg)

[https://stackoverflow.com/a/2139254/754951](https://stackoverflow.com/a/2139254/754951)

[在 C++ 中通过引用/值传递](https://stackoverflow.com/questions/410593/pass-by-reference-value-in-c)

[为什么要通过 const 引用而不是按值传递？](https://stackoverflow.com/questions/2582797/why-pass-by-const-reference-instead-of-by-value)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-26T22:27:49.633

最好的答案是让您阅读平台中的调用约定，但一般来说，对于小类型（那些适合寄存器甚至有时稍大的类型），按值传递通常会更快。当您通过指针或引用传递时，*指针*是按值传递的，这与复制原始对象的成本相同，而且还需要取消引用。

当对象变大时，复制指针加上取消引用的成本通常会小于复制大对象的成本，因此您应该使用引用。如果您不打算修改对象，请通过`const&`.

> 是否应该始终通过副本传递 int/unsigned int？是否应该仅在 64 位或更高的目标上通过副本传递双精度？

即使在 32 位架构中，您也应该按值传递整数和双精度数。同样，查看您的体系结构的调用约定（通常与编译器一起记录）。

> 如果函数可以内联 - 参数的传递方式是否重要？

如果函数是内联的，编译器可以对其进行优化，例如，通过将引用的使用替换原对象的使用来消除引用的成本。

> 通过 ref/const ref 传入时，别名如何影响问题？

如果您不打算修改参数（正如您在问题中声称的那样），别名将无关紧要。如果您传递可以以算法不期望的方式修改的指针/引用，您将遇到别名问题。

> 在什么情况下，参数的显式副本对堆栈有益？

忽略*堆栈*部分：当对象很*小时*。请注意，使用的调用约定甚至可能不使用堆栈（它可能会在寄存器中传递值）。我建议你阅读这篇关于不同[调用约定的文章](http://www.agner.org/optimize/calling_conventions.pdf)

# haskell - 在 Haskell 中表达一系列脚本化的 Python 字符串替换

> ID：10770208
> 
> 赞同：3
> 
> 时间：2012-05-26T22:18:02.890
> 
> 标签：haskell, file-io, text-processing, replace

我经常使用 Python 来替换文本中的各种类型的字符，使用如下所示的脚本：

```
#!/usr/bin/env python                                                                                                                                                                                                                                                         
# coding=UTF-8

import sys

for file in sys.argv[1:]:                                                                                                                                                                                                                                                     
    f = open(file)                                                                                                                                                                                                                                                            
    fs = f.read()
    r1 = fs.replace('\n',' ')
    r2 = r1.replace('\r',' ')                                                                                                                                                                                                                                                   
    r3 = r2.replace('. ','.\n\n')                                                                                                                                                                                                                                                   
    r4 = r3.replace('é','e')
    r5 = r4.replace('\xc2',' ')
    r6 = r5.replace('\xa0',' ')
    r7 = r6.replace(' ',' ')
    r8 = r7.replace(' ',' ')
    r9 = r8.replace('\n ','\n')
    f.close()                                                                                                                                                                                                                                                                 
    print r8 
```

但是我现在正在学习 Haskell，因为我厌倦了 Python。

我在 Haskell 中最好的尝试是

```
#!/usr/bin/runhaskell 

import System.IO

main :: IO ()
main = do 
       inh <- getArgs >>= withFileLines
       outh <- -- ??
       mainloop inh outh
       hClose inh
       hClose outh

replacements :: String -> String
replacements = unwords $ map -- hmm.... 
```

...而且，我不知道从那里去哪里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T22:28:19.420

Haskell 中最简单的方法包括在输入上映射一个`Char -> Char`替换函数（`f`如下），产生一个新的输出（该`interact`函数负责 fopen/fclose 模式）：

```
main = interact $ map f
      where
        f '\n'   = ' '
        f '\r'   = ' '
        f 'é'    = 'e'
        f '\xa0' = ' '
        f c      = c 
```

你可以修改它来做你自己的 IO，使用`Text`包等，但是字符转换的基本模式是一样的。

# filter - 需要 RegExpr 匹配组 8 包含，2+ 大写，2+ 小写和 1+ 数字

> ID：10770216
> 
> 赞同：2
> 
> 时间：2012-05-26T22:19:15.027
> 
> 标签：filter, spam

我正在尝试使用与以下情况匹配的正则表达式创建垃圾邮件过滤器。

*   有一组正好 8 个字母数字字符要匹配。
*   它必须包含 2 个或多个大写字母；
*   并且必须包含 2 个或更多小写字母；
*   并且它必须包含 1 个或多个数字。

到目前为止，我所能想到的就是：

```
(?i)[A-Za-z0-9]{8} 
```

我的代码确实匹配 8 个混合大小写组，但不强制大写或小写或指定每种类型必须出现多少次。因此，我将它与相关消息中始终存在的其他必备要素结合在一起。

这是我试图检测的模式示例：

```
WbNDSk9e 
```

这是垃圾邮件 URL 的一部分。我见过的其他组遵循相同的模式，即每个 UC 和 LC 字母至少 2 个，以及 1 个或多个数字，并且总是正好有 8 个字符。我还没有看到其他字符或变体。

据我所知，我能使用的唯一开关是使用 (?i) 打开大小写敏感。我在一些回复中看到的其他一些开关在我使用的程序中不起作用。我是否对单行 RegExpr 规则要求太多？

我目前使用 RegEx Match 来测试我的规则，而我的反垃圾邮件程序使用相同的引擎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T22:23:02.620

```
^(?=.*?[A-Z].*?[A-Z])(?=.*?[a-z].*?[a-z])(?=.*?\d).{8}$ 
```

分解：

`(?=.*?[A-Z].*?[A-Z])`强制至少 2 个大写字母。

`(?=.*?[a-z].*?[a-z])`强制至少 2 个小写字母。

`(?=.*?\d)`强制至少 1 位数字。

`^ ... $`它匹配整个字符串的插入符号和美元力量。

您不需要该`(?i)`标志，因为它会使它不区分大小写。

# php - 重写 php url 的规则

> ID：10770217
> 
> 赞同：0
> 
> 时间：2012-05-26T22:19:17.423
> 
> 标签：php, .htaccess, mod-rewrite

我试图为我脑海中的一个问题找到答案，但似乎我找不到它。

如何用“？”制作一些 php url 和“=”到/

示例一 (1)：

```
example.com/user.php?profile=example 
```

到：

```
example.com/user/profile/example 
```

示例二 (2)：

```
example.com/forum.php?thread=example-in-an-example 
```

到：

```
example.com/forum/thread/example-in-an-example 
```

就像将第二个“/”（斜杠）作为“？”的代码一样。第三个和其余的作为“=”，所以我可以自由使用它，而不是为每一页制作一个新的......

LIKE：/forum（或任何其他）就像页面本身 AND：/thread（或任何其他）就像 $_GET AND：/example-in-an-example（或任何其他）就像 $ 的值_得到

额外：这是来自 Jeroen 的代码：

```
RewriteRule ^(.*)/(.*)/(.*)/$ $1.php?$2=$3 [L] 
```

问题一 (1)：当喜欢：“example.com/forum”或“example.com/user”时会出现 404 错误问题二 (2)：当使用“example.com/forum/thread/”之类的链接时test-thread/reply/2" 它给出 404 错误，（假设在制作第一个真实的之后使用“&”和“=”循环，这样它就可以使用多个 $_GET）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T22:23:41.450

将此添加到您的 .htaccess 文件中：

```
RewriteEngine On
RewriteRule ^user/profile/(.*)/$ user.php?profile=$1 [L]
RewriteRule ^forum/thread/(.*)/$ /forum.php?thread=$1 [L] 
```

或者更通用的版本...

```
RewriteEngine On
RewriteRule ^(.*)/(.*)/(.*)/$ $1.php?$2=$3 [L] 
```

*确保启用 Apache 的[mod 重写](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)！*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T23:07:34.283

如果您对应用程序具有完全访问权限并且可以修改代码，我可以向您提交一些我通常用于 REST 实用程序的技巧。

将**AllowOverride All**放入 apache 配置中以启用 .htaccess 文件。确保也**加载**您的**mod_rewrite**模块。

在您的 Web 服务器文档根目录（您的应用程序路径）中创建一个 .htaccess 文件并将这些内容放入其中：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php [L] 
```

创建一个名为 index.php 的文件并将其放入其中，这将是您的控制器：

```
<?
        // echo "REQUEST_URI: " . $_SERVER['REQUEST_URI'] . "</br>\n";
        $controller = explode("/", $_SERVER['REQUEST_URI']);
        //print_r($controller);

        $resource = $controller[1];
        $operation = $controller[2];
        $operation_value = $controller[3];

        echo "Requested resource: $resource, opetation: $operation, value: $operation_value<br>\n";

        switch($resource) {
        case 'user':
                echo "User requested\n";
                //require_once("user.php");
                break;
        case 'forum':
                echo "Forum requested\n";
                //require_once("forum.php");
                break;
        /* add any other resource */
        default:
                echo "Requested page was not found.\n";
                break;
        }
?> 
```

当用户调用[http://example.com/user/profile/ZeroXitreo](http://example.com/user/profile/ZeroXitreo)时，页面将呈现为：

```
Requested resource: user, opetation: profile, value: ZeroXitreo
User requested 
```

当用户调用[http://example.com/forum/thread/example-in-an-example](http://example.com/forum/thread/example-in-an-example)时，页面将是：

```
Requested resource: forum, opetation: thread, value: example-in-an-example
Forum requested 
```

阅读控制器的 PHP 代码，我认为这很自我解释。

# android - AndroidPlot : 在 X 轴上设置标签

> ID：10770220
> 
> 赞同：5
> 
> 时间：2012-05-26T22:19:26.957
> 
> 标签：android, androidplot

随着 AndroidPlot 网站的关闭，我有点陷入这个问题。已经问了几个类似的问题，但没有一个得到正确的回答，所以我开始了。

我想知道如何重新标记我的 X 轴。例如，如果我想绘制有关每月数据的值，我会像`(1, 82)`Januari、`(2,67)`Februari 等那样绘制它。之后，我想将 X-labels 从 更改`[1, 2, 3, ...]`为`x_labels = ["Januari", "Februari", ...]`。我怎样才能做到这一点？

哦，请提供一个`x_labels`可以是任何东西的答案（如果有每月标签的特定方法，你永远不知道）。

有谁能帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-27T00:46:29.887

我自己想通了：

```
this.getGraphWidget().setDomainValueFormat(new GraphXLabelFormat());

// ...

private class GraphXLabelFormat extends Format {

    private static LABELS = ["Label 1", "Label 2", "Label 3"];

    @Override
    public StringBuffer format(Object object, StringBuffer buffer, FieldPosition field) {
        int parsedInt = Math.round(Float.parseFloat(object.toString()));
        String labelString = = LABELS[parsedInt];

        buffer.append(labelString);
        return buffer;
    }

    @Override
    public Object parseObject(String string, ParsePosition position) {
        return java.util.Arrays.asList(LABELS).indexOf(string);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-13T12:24:50.820

我使用了@Aegonis 编写的代码，并为设置`String`标签制作了完整的代码。

我在我的案例中使用了这 3 个数组。

```
Number[] yValues = {1, 3, 2 ,7 ,6};
Number[] xValues = {0, 1, 2, 3, 4};

final String[] xLabels = {"Jan", "Feb", "Mar", "Apr", "May"}; 
```

现在是`Format`@Aegonis 提供的扩展类的代码。

```
class GraphXLabelFormat extends Format {

    @Override
    public StringBuffer format(Object arg0, StringBuffer arg1, FieldPosition arg2) {
        // TODO Auto-generated method stub

        int parsedInt = Math.round(Float.parseFloat(arg0.toString()));
        Log.d("test", parsedInt + " " + arg1 + " " + arg2);
        String labelString = xLabels[parsedInt];
        arg1.append(labelString);
        return arg1;
    }

    @Override
    public Object parseObject(String arg0, ParsePosition arg1) {
        // TODO Auto-generated method stub
        return java.util.Arrays.asList(xLabels).indexOf(arg0);
    }
} 
```

现在来自`onCreate`方法的代码。

```
XYPlot plot = (XYPlot) findViewById(R.id.mySimpleXYPlot);

plot.setDomainLabel("TestDomain");
plot.setRangeLabel("TestRange");
plot.setTitle("Height/Weight");

//set domain labels as string [x-axis]
plot.getGraphWidget().setDomainValueFormat(new GraphXLabelFormat());

XYSeries series = new SimpleXYSeries(Arrays.asList(xValues), Arrays.asList(yValues), "Line");

plot.addSeries(series, new LineAndPointFormatter()); 
```

# matlab - MATLAB：以不同的顺序删除具有相同值的重复行

> ID：10770221
> 
> 赞同：1
> 
> 时间：2012-05-26T22:19:33.837
> 
> 标签：matlab

我正在尝试使用以下函数从数据中查找和删除相关列

```
function [ correlated ] = correlated( data, threshold )
% data is m x m matrix
% threshold is correlation threshold

c=corr(data);
[i,j] = find(c>threshold);
A = [i,j]; 
A=A(find(arrayfun(@(i)length(unique(A(i,:))),1:size(A,1))==size(A,2)),:); 
% as A also includes 1 1; 2 2; 3 3; etc so I used above line that I found somewhere

%      6     4
%      8     4
%      4     6
%      8     6
%      4     8
%      6     8
%     14    11
%     11    14

% it should not contain both 6 4; and 4 6; how do I remove all such rows?

end 
```

它不应同时包含 6 4；和 4 6；如何删除所有这些行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T22:39:45.900

```
uniqueA = unique(sort(A,2), 'rows'); 
```

# django - 如何从 Django 查询中获取唯一值

> ID：10770224
> 
> 赞同：-2
> 
> 时间：2012-05-26T22:20:01.217
> 
> 标签：django, django-models, django-queryset

我有一个方法：

```
 def get_netmask(user=None):
     user = User.objects.get(username=user)
     id_user = user.id
     obj = Host.objects.get(user=id_user)
     obj = obj.ipv4_sub_net.distinct('ipv4_sub_net').order_by('ipv4_sub_net')

     # In this line i am getting an error: `'unicode' object has no
     # attribute 'distinct'` but the query is not complete . For full
     # question please follow the lines and given example

     return obj 
```

Host 模型的对象是`ipv4_sub_net`和`ipv6_sub_net`。我定义上述方法的动机是从 `ipv4_sub_net`+`ipv6_sub_net`模型字段中获取值，该字段将从`Host model`对应于请求用户（登录用户）中获取。为此，我在调用它时传递`reuest.user.username`给 `get_netmask`参数。`ipv4_sub_net`除此之外，我还想`ipv6_sub_net`单独返回 count os 类似的条目。

例如：在表中有四个列存在：

```
id      user_id        ipv4_sub_net       ipv6_sub_net
1       2              1.0.0.1             /23
2       2              8.9.7.3             /23
3       1              23.2.3.4            /43
4       2              1.0.0.1             /23 
```

所以，假设请求用户是`user_id` `2`. 因此，根据方法定义，它将返回字典。字典的第一个索引包含唯一`IPv4_sub_net + ipv6_sub_net`的，`"1.0.0.1"`并且第二个索引将返回为 ipv4的sub_net 2为ipv6`/23`的返回相似的计数。`sub_net``ipv4 and the third index will return the count of similar``for ipv6 which``and`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:22:11.090

尝试改变

```
obj = obj.ipv4_sub_net.distinct('ipv4_sub_net').order_by('ipv4_sub_net') 
```

至

```
obj = obj.distinct('ipv4_sub_net').order_by('ipv4_sub_net') 
```

**编辑**

在第一次通过时，我错过了另一个错误。你也应该改变

```
obj = Host.objects.get(user=id_user) 
```

至

```
obj = Host.objects.filter(user=id_user) 
```

`get`如果返回多个对象，将始终返回单个对象并引发错误。如果您期待一个对象，那么我不确定您要做什么。

# c# - 带有可以调整大小和自动调整大小的部分的 Winform

> ID：10770225
> 
> 赞同：1
> 
> 时间：2012-05-26T22:20:05.913
> 
> 标签：c#, winforms, resize

我正在创建一个包含两个部分的 C# winform（不是 asp.net）。左侧部分是一种工具栏，用户将在其中输入一些要显示的图像。右侧部分将显示信息、图像。

图像可以是任意大小，但工具栏几乎总是相同大小。

我希望这两个部分是分开的，也就是它们之间的分隔线，我可以拖动。同样，无论何时选择图像，右侧屏幕都会调整大小，或者至少调整大小并给我一个滚动条。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:07:39.250

您可以使用[SplitContainer](http://msdn.microsoft.com/en-us/library/system.windows.forms.splitcontainer)。您需要将[FixedPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.splitcontainer.fixedpanel%28VS.100%29.aspx)属性设置为要保持相同大小的面板。

# javascript - .js.erb 中的 NoMethodError

> ID：10770228
> 
> 赞同：1
> 
> 时间：2012-05-26T22:22:08.970
> 
> 标签：javascript, ruby, ruby-on-rails-3.1

我正在尝试编写不显眼的 javascript，我认为：

```
<%= javascript_include_tag "trend" %> 
```

在我的trend.js.erb 中有：

```
$(document).ready(function() {

    <% @testsss.each do |t|%>

        $('#<%= "t-"+t.id.to_s %>').click(function(event){
            //alert("sometext");
            $.ajax({type: "GET", url: "/returngraph?test=<%= t.id.to_s %>", dataType: "html",success: 
            function(data){ $("#chart").html(data)} });

        }); 

    <% end %>

}); 
```

但我得到了 NoMethodError ......我做错了什么？@testsss 是一组对象，相同的 @testsss.each 在trend.html.erb 中工作，我称之为 javascript_include_tag “trend”

谢谢你

编辑：

这是实际错误：

```
NoMethodError in Statisticall#trend

Showing /xxxx/app/views/statisticall/trend.html.erb where line #1 raised:

undefined method `each' for nil:NilClass
  (in /xxxx/app/assets/javascripts/trend.js.erb)
Extracted source (around line #1):

1: <%= javascript_include_tag "trend" %>
2: <div id="hhead"> 
```

我有控制器统计和动作趋势

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T23:04:51.917

我猜@testsss 是在控制器中定义的。

资产管道没有被动作控制器编译或接触过，所以......你不能在管道的控制器中分配实例变量。

解决方法包括 @testsss.to_json 并将其作为 JS 变量包含在您的视图中

就像是

```
#app/views/some/view.html.erb
<script type='text/javascript'>
 window.testsss = <%= @testsss.tojson %>
</script> 
```

然后在你的 javascript 中使用 underscore.js 做这样的事情

```
 _(testsss).each(function(t){
    $('#t-'+ t.id).click(function(event){
         //alert("sometext");
         $.ajax({type: "GET", url: "/returngraph?test=" + t.id, dataType: "html",success: 
         function(data){ $("#chart").html(data)} });
     }); 
  }); 
```

或者您可以在视图而不是资产管道中呈现该 js

```
#app/views/some/view.html.erb
<script type='text/javascript'>
  $(document).ready(function() {
    <% @testsss.each do |t|%>
      $('#<%= "t-"+t.id.to_s %>').click(function(event){
        $.ajax({
          type: "GET",
          url: "/returngraph?test=<%= t.id.to_s %>",
          dataType: "html",
          success: function(data){ $("#chart").html(data)}
        });
      }); 
    <% end %>
  });
</script> 
```

这样做的好处是可以在 js 的动作控制器中分配实例变量，但缺点是加载时间较长。

我更喜欢第一种方法，但这取决于你吗？

# api - REST API 可在浏览器中使用，但不能在客户端中使用

> ID：10770233
> 
> 赞同：1
> 
> 时间：2012-05-26T22:23:05.927
> 
> 标签：api, rest, post, methods, get

我正在开发一个 REST API，并且发现了一个非常有趣的问题。

当我在网络浏览器（在我的情况下为 Chrome）中访问资源时，一切正常。但是，当我使用 REST 客户端（Google Chrome 插件、基于 Web 的客户端和 Java 小程序）访问资源时，没有任何变量传递给 API。GET 和 POST 方法都会发生这种情况。

我完全不知道为什么会这样，而且在将它们投入生产之前测试这些方法非常困难（尤其是使用 POST 方法）。

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:03:04.910

乍一看，这听起来可能是两件事：

1.  您没有通过客户端或小程序正确传递 API 参数
2.  身份验证或 cookie 管理问题。API 是否需要任何类型的授权？
3.  您是否忘记设置必要的 HTTP 标头？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T12:21:02.370

您是否也可以控制 API 还是第三方 API？如果是这样，参数是完全到达还是空着到达？错误代码是什么？- 403 未授权（如果密钥未通过，这将是有意义的）或由于缺少参数而导致的其他问题。

尝试在命令行中使用 CURL 执行此操作的中间步骤 - 这将为您提供有关返回内容的更多详细信息。

# python - 使用没有继承的其他类的方法

> ID：10770241
> 
> 赞同：1
> 
> 时间：2012-05-26T22:25:25.423
> 
> 标签：python, django, inheritance

这个问题是关于*Python*继承的，但用 Django 示例进行了解释，但这应该不会受到伤害。

我有这个 Django 模型，`Page`还有`RichText`模型：

```
class Gallery(Page, RichText):
    def save(self, *args, **kwargs):
        # lot of code to unzip, check and create image instances.
        return "something" 
```

我只对`save`在另一个类中使用该方法感兴趣。

一个解决方案可能是：

```
class MyGallery(models.Model):
    def save(self, *args, **kwargs):
        # here goes the code duplicated from Gallery, the same.
        return "something" 
```

我想避免代码重复，而且我对从`Page`and继承成员不感兴趣`RichText`（所以我不想这样做`class MyGallery(Gallery):`。如果它是合法的，我会写这样的东西：

```
class MyGallery(models.Model):
    # custom fields specific for MyGallery
    # name = models.CharField(max_length=50)
    # etc

    def save(self, *args, **kwargs):
        return Gallery.save(self, *args, **kwargs) 
```

但它不起作用，因为`save()`in需要一个, not`Gallery`的实例。`Gallery``MyGallery`

有什么方法可以“分离”该`save()`方法并按照那里定义的方式`Gallery`使用它？`MyGallery`

**编辑：**

我忘了说这`Gallery`是给定的，不能改变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T22:31:51.740

您可以访问[方法的](http://docs.python.org/dev/reference/datamodel.html#index-35)[`__func__`属性`save`](http://docs.python.org/dev/reference/datamodel.html#index-35)：

```
class Gallery(object):
    def save(self, *args, **kwargs):
        return self, args, kwargs

class MyGallery(object):
    def save(self, *args, **kwargs):
        return Gallery.save.__func__(self, *args, **kwargs)
    # or 
    # save = Gallery.save.__func__

mg = MyGallery()
print mg.save('arg', kwarg='kwarg')
# (<__main__.MyGallery object at 0x04DAD070>, ('arg',), {'kwarg': 'kwarg'}) 
```

但如果可能的话，你最好重构：

```
class SaveMixin(object):
    def save(self, *args, **kwargs):
        return self, args, kwargs

class Gallery(SaveMixin, object):
    pass

class MyGallery(SaveMixin, object):
    pass 
```

或者

```
def gallery_save(self, *args, **kwargs):
    return self, args, kwargs

class Gallery(object):
    save = gallery_save

class MyGallery(object):
    save = gallery_save 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:15:47.400

我不确定您为什么反对继承，尤其是在方法方面。我经常创建一个`MixIn`由我的所有 Django 继承的类，`models.Model`它包含用于 URL 创建、转储等的各种有用方法。我确实使这些方法具有防御性，因为它们`hasattr()`用来确保它们适用于特定的课程，但这样做可以节省大量时间。

# actionscript-3 - AS3：如何使用 ActionScript3 访问 XMLListCollection 中的数据？

> ID：10770246
> 
> 赞同：0
> 
> 时间：2012-05-26T22:26:03.103
> 
> 标签：actionscript-3, apache-flex, actionscript, flex4

我正在使用 XMLListCollection 作为 spark ComboBox，受此链接的启发

[http://blog.shortfusion.com/index.cfm/2009/4/15/FlexAS3-Custom-ComboBox-for-Countries-with-XML](http://blog.shortfusion.com/index.cfm/2009/4/15/FlexAS3-Custom-ComboBox-for-Countries-with-XML)

XMLListCollection 在这里定义：

```
public class ComboBox_Country extends ComboBox {

    private var Country:XML=new XML(
        <countries>
         <country code="US" iso="840" label="United States" />
         <country code="CA" iso="124" label="Canada" />
         <country code="GB" iso="826" label="United Kingdom" />
                     ....
         <country code="ZM" iso="894" label="Zambia" />
         <country code="ZW" iso="716" label="Zimbabwe" />
        </countries>);

    public function ComboBox_Country() {
        dataProvider = new XMLListCollection(Country.children());
        labelField = '@label';
    } 
```

并在 mxml 中调用为：

```
<mycomp:ComboBox_Country id="countryComboBox" width="100%"/> 
```

当用户进行选择时，我可以从以下位置获取索引：`countryComboBox.selectedIndex`. 但是，我需要该国家/地区的字符串，但我不确定如何从 XMLListCollection 中提取该字符串。当我查看调试器时，我看到：

![在此处输入图像描述](../Images/3377e6d0e6d12192c8d302b618dd11f5.png)

假设用户选择了索引 2（例如英国）。我需要在调试器中输入什么才能返回`United Kingdom`？我试过这样的事情：

```
countryComboBox.Country.getItemAt(2)
countryComboBox.Country.getItemAt(2).label
countryComboBox.Country[2]
countryComboBox.Country.label.getItemAt(2)
etc... 
```

无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:05:13.377

我不完全确定您是否正确填充组合框，通常您会使用数据提供程序（请参阅[http://help.adobe.com/en_US/flex/using/WS70f0d54f063b9b081aac8d1d1247252e4a0-8000.html](http://help.adobe.com/en_US/flex/using/WS70f0d54f063b9b081aac8d1d1247252e4a0-8000.html)）

假设它为您正确显示数据，那么您已经非常接近了

```
// Should give you the country object selected
var obj:Object = countryComboBox.selectedItem;

// You should also be able to use .code or .iso
return obj.label; 
```

如果`obj.label`不起作用，您可以尝试`obj['label'];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T23:07:08.900

ComboBox 有一个您可能应该使用的属性 selectedItem。在这种情况下 selectedItem 将是 XML 对象。[在此处](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7e6b.html)阅读如何从 XML 对象获取数据。在您的情况下，您可以使用获取标签

```
countryComboBox.selectedItem.@label 
```

# spring - Spring，modelmap，从jsp获取属性

> ID：10770251
> 
> 赞同：1
> 
> 时间：2012-05-26T22:26:33.633
> 
> 标签：spring, spring-mvc

我使用 spring 框架和其他一些框架（我是初学者）开发了一个 MVC 应用程序。我有一个控制器来管理 jsp 处理，例如，当我想将新人员添加到我的“人员列表”时，我调用实例化人员对象并将其传递给与 add 方法对应的 jsp 视图。我通过这样的方法做到这一点：

```
@RequestMapping(value = "/persons/add", method = RequestMethod.GET)
public String getAdd(Model model) {
    logger.debug("Received request to show add page");

    // Create new UserDomain and add to model
    // This is the formBackingOBject
    model.addAttribute("personAttribute", new UserDomain());

    // This will resolve to /WEB-INF/jsp/addpage.jsp
    return "addpage-tiles";
} 
```

我的问题是，现在，我想通过向模型添加两个不同的对象，例如，我想通过'new UserDomain（）'以及来自我数据库中另一个表的另一个对象，例如一个“新用户安全（）”。我想我应该使用'modelMap'而不是'model.addAttribute ...'，但我不能这样做，所以如果有人可以帮助我。我通过以下代码从 jsp 获取我的模型：

```
<form:form modelAttribute="personAttribute" method="POST" action="${saveUrl}">
<table>
    <tr>
        <td><form:label path="firstName">First Name:</form:label></td>
        <td><form:input path="firstName"/></td>
    </tr>
    <tr>
        <td><form:label path="lastName">Last Name</form:label></td>
        <td><form:input path="lastName"/></td>
    </tr>   
     <tr>
        <td><form:label path="userName">User name</form:label></td>
        <td><form:input path="userName"/></td>
    </tr>   
    <tr>
        <td><form:label path="email">E-mail</form:label></td>
        <td><form:input path="email"/></td>
    </tr>           
</table>
<input type="submit" value="Save" /> 
```

非常感谢你帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T07:06:26.510

简单地将多个对象传递给视图不是问题——只需`model.addAttribute`多次使用，然后您就可以访问这两个对象。

但是，如果要在其中编辑多个模型，则`<form:form>`需要创建一个包含两个对象的类：

```
public class UserDomainSecurity {

    private UserDomain userDomain;
    private UserSecurity userSecurity;

    // getters and setters for both

} 
```

然后将 this 的一个实例传递给视图：

```
 model.addAttribute("userDomainSecurity", new UserDomainSecurity()); 
```

并以下列形式使用它：

```
<form:form commandName="userDomainSecurity" method="POST" action="${saveUrl}">
...
  <form:input path="userDomain.firstName"/>
  ....
  <form:input path="userSecurity.someSecurityProperty"/> 
```

有时不得不创建所有这些额外的类很烦人，但这有点合乎逻辑。包装类在表单中创建一种命名空间，从而分隔您要编辑的各个对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T18:53:52.637

我想补充一下，因为这确实是我几分钟前遇到的当前问题。

在这种情况下，我假设你是`UserSecurity`并且`UserDomain`是相对的。

假设你有，

```
public class UserDomain {

     public UserSecurity userSecurity
     public String firstName;
     public String lastName;

     // getters and setters...
} 
```

你有你的 UserSecurity 之类的东西，

```
public class UserSecurity {

     public String someSecurityProperty;

     // getters and setters...
} 
```

由于`userSecurity`可以公开访问属性，因此您可以执行您在 Controller 中所做的操作，

```
@RequestMapping(value = "/persons/add", method = RequestMethod.GET)
public String getAdd(Model model) {
logger.debug("Received request to show add page");

// Create new UserDomain and add to model
// This is the formBackingOBject
model.addAttribute("userDomainSecurity", new UserDomain());

// This will resolve to /WEB-INF/jsp/addpage.jsp
return "addpage-tiles";
} 
```

然后只需在您的 addpage.jsp 中访问它，就像它是下面的对象属性一样，

```
<form:form commandName="userDomainSecurity" method="POST" action="${saveUrl}">
...
<form:input path="firstName />
<form:input path="lastname />
  ....
  <form:input path="userSecurity.someSecurityProperty"/> 
```

如您所见，我通过类中声明的属性访问 someSecurityProperty `UserDomain`。

# qt4 - 调整 QGraphicsView 大小不会移动小部件

> ID：10770255
> 
> 赞同：2
> 
> 时间：2012-05-26T22:27:15.940
> 
> 标签：qt4, qgraphicsview, qgraphicsscene

我有一个 QMainWindows ，里面有一个 QGraphicsView ，它占据了所有的客户区。在视图中，我渲染了一些 QGraphicsTextItem 项。只要我不调整主窗口的大小，一切正常。如果我这样做，这些项目将保持在原来的位置，并且不会移动到新的正确位置。基本上我会做的是在布局小部件中具有类似的行为，如果需要，它会扩展

**更新 1**

![在此处输入图像描述](../Images/e0e59053220f54f6329c16bfb879afef.png)

**更新 2**![在此处输入图像描述](../Images/461bdd375d55922ce4cd8f9db1ed386d.png)![在此处输入图像描述](../Images/c2e7b4882cd04749f12ef4c8f513dbc2.png)

**更新 3**

使用以下代码，按钮位于客户区的右侧。944 是从 QGraphicsView 的 Qt Designer 定义的宽度。我对该区域左侧的小部件具有相同的代码，从 10 开始 xPos 并在每次添加新按钮时递增它。如果我调整窗口大小，左侧小部件总是移动到新位置，右侧没有相同的行为。为什么？

```
this->ui.setupUi(this);

qreal xPos = 944 - 10;

QGraphicsTextItem *myButton1 = new QGraphicsTextItem("my text");

myButton1 ->adjustSize();
myButton1 ->setPos(xPos - myButton1 ->textWidth(), 10);

xPos -= myButton1 ->textWidth();

this->m_graphicsScene->addItem(myButton1);

QGraphicsTextItem *myButton2 = new QGraphicsTextItem("my text 2");

myButton2 ->adjustSize();
myButton2 ->setPos(xPos - myButton2->textWidth(), 10);

xPos -= myButton2 ->textWidth();

this->m_graphicsScene->addItem(myButton2); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T23:22:17.237

QGraphicsView 没有直接连接到场景内的 QGraphicsItem 对象。它的唯一目的是在视口中可视化场景的一部分，并将用户交互传输到场景。没有布局，但是添加了布局以与 QGraphicsWidget 一起使用（但这是一个特殊的需求案例）。无论如何，这只是与视图的翻译有关，而不是场景中项目的位置（彼此完全无关）

您最可能需要做的是子类 QGraphicsView，并在您的视图中重新实现 resizeEvent：http: [//qt-project.org/doc/qt-4.8/qgraphicsview.html#resizeEvent](http://qt-project.org/doc/qt-4.8/qgraphicsview.html#resizeEvent)
在 resizeEvent 中，您将翻译基于调整大小的视图：http: [//qt-project.org/doc/qt-4.8/qgraphicsview.html#translate](http://qt-project.org/doc/qt-4.8/qgraphicsview.html#translate)

本质上，您正在自定义 QGraphicsView 中创建自己的布局管理器功能。

**更新**

我明白你的意思，当 sceneRect 比 QGraphicsView 大时，它会使用滚动条，而不是让你的视图以调整大小为中心。理想情况下，如果您正在创建内容不需要滚动的图形场景类型，您应该保留 sceneRect 默认值，或者将其设置为视口的大小。

否则，这是一个关于如何使用 resizeEvent 的非常基本的示例。这是在 PyQt 中，但我相信你可以翻译：

```
class Dialog(QtGui.QDialog):

    def __init__(self):
        super(Dialog, self).__init__()
        self.resize(640,480)
        layout = QtGui.QVBoxLayout(self)

        self.scene = QtGui.QGraphicsScene(self)
        self.scene.setSceneRect(-500,-500,1000,1000)
        self.view = GraphicsView(self)
        self.view.setScene(self.scene)
        layout.addWidget(self.view)

        text = self.scene.addText("Foo")

        self.view.updateCenter()

class GraphicsView(QtGui.QGraphicsView):

    def __init__(self, parent=None):
        super(GraphicsView, self).__init__(parent)
        self._center = None

    def resizeEvent(self, event):
        super(GraphicsView, self).resizeEvent(event)
        if self._center:
            self.centerOn(self._center)

    def updateCenter(self):
        center = self.geometry().center()
        self._center = self.mapToScene(center) 
```

调用时保存您感兴趣的场景点`updateCenter()`。然后，每次您的视图调整大小时，它都会以该场景点为中心。

**更新 2**：在您的图片发布和更新之后

如果你真的需要在 QGraphicsScene 中使用这种带有布局的正常 QWidget 行为，那么你应该查看支持布局的 QGraphicsWidgets。然后，您可以制作一个大的根“画布”小部件，并在布局内使其他所有内容成为该小部件的子级。然后你只需要担心保持根小部件的大小合适。然后，您将能够使用上面的相同示例来管理根小部件的大小和位置。

请参阅此问题以获取更多详细信息，因为它与想要将 QGraphicsItem 集成到布局中的人的情况相同：
[QGraphicsWidget vs. QGraphicsLayoutItem](https://stackoverflow.com/questions/4116657/qgraphicswidget-vs-qgraphicslayoutitem)

# c - C 编程：将 Hex Int 转换为 Char*

> ID：10770257
> 
> 赞同：3
> 
> 时间：2012-05-26T22:27:24.800
> 
> 标签：c, char, int

我的问题是我将如何转换如下内容：

```
 int i = 0x11111111; 
```

到字符指针？我尝试使用 itoa() 函数，但它给了我一个浮点异常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T22:32:55.157

`itoa`是非标准的。远离。

一种可能性是使用`sprintf`正确的十六进制格式说明符，即`x`：

```
char str[ BIG_ENOUGH + 1 ];
sprintf(str,"%x",value); 
```

但是，这种计算`value`数组大小的问题。您必须进行一些猜测，[FAQ 12.21](http://c-faq.com/stdio/sprintfsize.html)是一个很好的起点。

表示任何基数所需的字符数`b`可以通过以下公式近似：

> ⌈log [b] (n + 1) ⌉

`0x`如果需要，再添加几个来按住，然后你`BIG_ENOUGH`就准备好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:29:22.140

```
char buffer[20]; 
```

然后：

```
sprintf(buffer, "%x", i); 
```

或者：

```
itoa(i, buffer, 16); 
```

指向缓冲区的字符指针可以是`buffer`它本身（但它是 const）或其他变量：

```
char *p = buffer; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T22:53:04.350

像这样使用 sprintf() 函数`sprintf(charBuffer, "%x", i);` ——我认为会很好用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T14:03:53.233

使用该`sprintf()`函数将整数转换为十六进制应该可以完成您的任务。

这是一个例子：

```
int i = 0x11111111;

char szHexPrintBuf[10];

int ret_code = 0;

ret_code = sprintf(szHexPrintBuf, "%x", i);

if(0 > ret_code)
{ 
   something-bad-happend();
} 
```

# ruby - 如何获取一个数组并针对其他元素操作每个元素

> ID：10770259
> 
> 赞同：2
> 
> 时间：2012-05-26T22:27:44.430
> 
> 标签：ruby, arrays

这是我正在做的事情：

```
(1..999).each do |a|
    (1..999).each do |b|
      if Math.sqrt(a**2 + b**2) % 1 == 0 && a + b + Math.sqrt(a**2 + b**2) == 1000 && a >= b
            puts a * b * Math.sqrt(a**2 + b**2) 
        end     
    end
end 
```

正在发生的事情是，`a`并且`b`在公式中可以互换，因此有两个匹配项，因此`puts`被输出两次。为了解决这个问题，我添加了`a >= b`，现在它只输出一次。但是，如果`a == b`它输出两次。我知道在我使用的示例中 a 和 b 总是不同的，但这对我来说似乎是糟糕的设计。

两个问题：

1.  Ruby 中是否有更好的模式来获取数组并将其与自身进行比较？

2.  我怎样才能避免它*总是*输出两次。我可以设置一个变量，如果在下一个循环开始之前发生更改，它将中断。这是正确的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T22:38:02.473

```
#using combination
(1..999).to_a.combination(2).each do |low, high|
  if Math.sqrt(low**2 + high**2) % 1 == 0 && low + hight + Math.sqrt(low**2 + high**2) == 1000
    puts low * high * Math.sqrt(low**2 + high**2)
  end
end 
```

编辑以使用更好的做法（每个块都有第一和第二个数组）

# php - CodeIgniter Image Lib 类不调整图像大小但返回 true

> ID：10770262
> 
> 赞同：1
> 
> 时间：2012-05-26T22:28:19.717
> 
> 标签：php, codeigniter

我正在尝试使用 codeigniter 的图像库库来调整图像的大小。很简单。但是，图像没有调整大小，而且函数返回 true，display_errors() 没有显示任何错误。

这是我传递给图像库的配置：

```
 //A file is uploaded using codeigniter's upload library, then:

    $imgData = $this->upload->data();

    $config['image_library'] = 'GD';
    $config['source_image'] = $imgData['full_path'];
    $config['new_image']    = $imgData['full_path'];
    $config['create_thumb'] = false;
    $config['maintain_ratio'] = true;
    $config['width'] = $newWidth;
    $config['height'] = $newHeight; 
```

$config 设置后的 print_r ：

```
Array
(
    [image_library] => GD
    [source_image] => C:/wamp/www/uploads/8ddbfb2cce91ee314e1f296355aec8c6.jpg
    [new_image] => C:/wamp/www/uploads/8ddbfb2cce91ee314e1f296355aec8c6.jpg
    [create_thumb] => 
    [maintain_ratio] => 1
    [width] => 400
    [height] => 350
) 
```

路径是正确的，但是调整大小后图像保持不变。

执行`var_dump`on`$this->image_lib->display_errors()`返回：

```
string '' (length=0) 
```

如果有任何区别，则图像正在通过 Uploadify 上传。

关于有什么问题的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-11T17:16:59.443

尝试从您的文档根目录而不是从 C 设置完整路径。试试这个代码：

```
if($this->upload->do_upload()){
    $this->load->library('image_lib');

    $config_res['source_image'] = 'uploads/'.$this->upload->file_name;
    $config_res['maintain_ratio'] = TRUE;
    $config_res['width'] = $newWidth;
    $config_res['height'] = $newHeight;

    $this->image_lib->initialize($config_res);

    $this->image_lib->resize();

    $this->image_lib->clear();
}
else{
     echo $this->upload->display_errors();
} 
```

这样你就不需要指定 new_image 并且它会被覆盖

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:44:46.280

您是否设置`create_thumb`为空字符串？查看 CodeIgniter 源，将此参数设置为布尔值`FALSE`（这是默认值）以外的任何值都被识别为“true”值。

create_thumb 模式的目的是为生成的文件的名称附加一个后缀，默认为“_thumb”。[http://codeigniter.com/user_guide/libraries/image_lib.html](http://codeigniter.com/user_guide/libraries/image_lib.html)

也许您的上传文件夹中有“filename_thumb.jpg”文件？如果是这样，则发现问题；）只需删除或修复您的`create_thumb`参数。

作为旁注，`maintain_ratio = 1`不起作用，只能`TRUE`起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T05:28:08.243

您是否尝试在 create_thumb 函数上避免此错误？& 大写字母中的布尔值？

```
$config['create_thumb'] = FALSE;
$config['new_image'] = $this->image_thumb_name($img); 
```

参考：[https ://stackoverflow.com/a/9040862/1444072](https://stackoverflow.com/a/9040862/1444072)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-26T22:40:19.833

确保**注意：为了允许图像类进行任何处理，包含 imags.**e 文件的文件夹必须具有写入权限。**

**注意：图像处理可能需要大量服务器内存来执行某些操作。如果您在处理图像时遇到内存不足错误，您可能需要限制其最大大小，和/或调整 PHP 内存限制

# java - decodeByteArray 和 copyPixelsToBuffer 不起作用。SkImageDecoder::Factory 返回 null

> ID：10770263
> 
> 赞同：8
> 
> 时间：2012-05-26T22:28:39.750
> 
> 标签：java, android, bitmap, bytearray, serializable

我有一个实现 Serializable 的类 TouchPoint，因为它包含位图，所以我为该类编写了 writeObject 和 readObject：

```
private void writeObject(ObjectOutputStream oos) throws IOException {
    long t1 = System.currentTimeMillis();
    oos.defaultWriteObject();
    if(_bmp!=null){
        int bytes = _bmp.getWidth()*_bmp.getHeight()*4;

        ByteBuffer buffer = ByteBuffer.allocate(bytes); 
        _bmp.copyPixelsToBuffer(buffer);

        byte[] array = buffer.array();      

        oos.writeObject(array);

    }
    Log.v("PaintFX","Elapsed Time: "+(System.currentTimeMillis()-t1));
}

private void readObject(ObjectInputStream ois) throws IOException, ClassNotFoundException{
    ois.defaultReadObject();
    byte[] data = (byte[]) ois.readObject();
    if(data != null && data.length > 0){
        _bmp = BitmapFactory.decodeByteArray(data, 0, data.length);
    }
} 
```

问题是我得到

> SkImageDecoder::Factory 返回 null

那么我该如何解决它。我知道可能的解决方案是将 writeObject() 更改为

```
ByteArrayOutputStream byteStream = new ByteArrayOutputStream();
_bmp.compress(Bitmap.CompressFormat.PNG, 100, byteStream);
oos.writeObject(byteStream.toByteArray); 
```

但是这种方法慢了近 10 倍以上。

*   copyPixelsToBuffer ~14ms 用于写入图像
*   _bmp.compress ~ 160ms

**UPDATE** 发现实际的问题是之后

```
buffer.array(); 
```

所有 byte[] 数组元素为：0

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-03T14:38:00.697

最后，我找到了一种让它工作并同时变得更快的方法。使用这种方法我遇到了两个问题：

1.  我也应该传递 Bitmap.Config 参数，否则我无法解码字节数组
2.  _bmp.compress 和 _bmp.copyPixelsToBuffer 给出不同的数组，所以我不能使用 decodeByteArray。

我用这种方式解决了它们

```
private void writeObject(ObjectOutputStream oos) throws IOException {
    oos.defaultWriteObject();

    if(_bmp!=null){
        int bytes = _bmp.getWidth()*_bmp.getHeight()*4;

        ByteBuffer buffer = ByteBuffer.allocate(bytes);
        _bmp.copyPixelsToBuffer(buffer);

        byte[] array = new byte[bytes]; // looks like this is extraneous memory allocation

        if (buffer.hasArray()) {
            try{
                array = buffer.array();
            } catch (BufferUnderflowException e) {
                e.printStackTrace();
            }
        }

        String configName = _bmp.getConfig().name();

        oos.writeObject(array);
        oos.writeInt(_bmp.getWidth());
        oos.writeInt(_bmp.getHeight());
        oos.writeObject(configName);
    } else {
        oos.writeObject(null);
    }
}

private void readObject(ObjectInputStream ois) throws IOException, ClassNotFoundException{
    ois.defaultReadObject();

    byte[] data = (byte[]) ois.readObject();
    if (data != null) {
        int w = ois.readInt();
        int h = ois.readInt();
        String configName = (String) ois.readObject();

        Bitmap.Config configBmp = Bitmap.Config.valueOf(configName);
        Bitmap bitmap_tmp = Bitmap.createBitmap(w, h, configBmp);
        ByteBuffer buffer = ByteBuffer.wrap(data);

        bitmap_tmp.copyPixelsFromBuffer(buffer);

        _bmp = bitmap_tmp.copy(configBmp,true);

        bitmap_tmp.recycle();
    } else {
        _bmp = null;
    }
} 
```

这对我来说已经足够快了——比 bmp.compress 方式快大约 15 倍。希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T18:10:48.347

位图到字节[]：

```
Bitmap bmp; // your bitmap
ByteArrayOutputStream stream = new ByteArrayOutputStream();
bmp.compress(Bitmap.CompressFormat.PNG, 100, stream);
byte[] byteArray = stream.toByteArray(); 
```

使用 Bufferedstreams 以获得更好的性能。

# c# - 如何使用 C# 创建和使用我的通用类型？

> ID：10770264
> 
> 赞同：-1
> 
> 时间：2012-05-26T22:28:44.510
> 
> 标签：c#, list, generics, search

我正在尝试学习泛型类型，并且编写了以下代码：

```
public class MyProp<TDictonary, TValor>
    {
        private List<TDictonary> MyDictionary = new List<TDictonary>();
        private List<TValor> TValue = new List<TValue>();

        public MyProp<TDictonary, TValue> Search(TDictonary dictionary)
        {
            MyProp<TDictonary, TValor> dic = new MyProp<TDictonary, TValor>();
            var test = MyDictionary.FirstOrDefault(item => item == dictionary);
            return dic;
        } 
```

所以我尝试创建类似 C# 字典的东西。我试图做的是将 TDictionary 和 TValue 关联到列表，将它们添加到我的泛型类型并返回 MyProp 及其内容。我还计划添加其他方法，如添加、删除等，但如果我无法在列表中执行简单的搜索，我肯定无法再进一步。

有谁知道我是否走在正确的道路上？如果没有，你能指出正确的路径吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:36:12.203

添加泛型类型约束，以便您可以调用`.Equals`

```
public class MyProp<TKey, TValue>
   where TValue : IEquatable<TKey>

MyProp<TDictonary, TValor> prop = new MyProp<TDictonary, TValor>();
var val = MyDictionary.FirstOrDefault(item => item.Equals(dictionary));
prop.Key = val;
prop.Value = val;
return dic; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:43:44.387

> 我试图创建类似 C# 字典的东西

不过你知道的[`System.Collections.Generic.Dictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)，对吧？

无论如何，我不确定您的泛型（甚至类型）实际上是为了表示什么（给它们更清晰的名称！），所以我不能准确地告诉您必须更改哪些内容才能实际搜索您的字典。

不过有几点提示：

*   在该方法中，您创建一个实例`dic`，对其不执行任何操作，然后简单地返回它——不管您之前做了什么。
*   您只在该领域工作，`MyDictionary`但完全忽略了该`TValue`领域。
*   私有字段通常以 命名`camelCase`，即以小写字符开头。
*   命名私有字段`TValue`非常混乱，*因为*`T`. 这通常只为泛型类型保留。

> 它给了我这个错误：错误1运算符'=='不能应用于'TDictonary'和'TDictonary'类型的操作数

那是因为该类型是没有任何限制的泛型类型。因此它可以是引用类型或值类型，因此编译器无法决定对`==`运算符进行哪个比较。一个简单但可能具有限制性的修复方法是指定一个基类型，它要么是值类型，要么是引用类型：

```
public class MyProp<TDictonary, TValor>
    where TDictionary : class 
```

# javascript - 通过javascript在客户端进行价格（十进制）计算是否安全？

> ID：10770265
> 
> 赞同：1
> 
> 时间：2012-05-26T22:28:51.623
> 
> 标签：javascript, .net, web, decimal

我必须操纵十进制计算。所有数据都已经在客户端，并且操作正在通过用户交互（选择）而改变。因此，我当然可以为每个用户选择更改访问服务器，但这是一项耗时的工作和额外的复杂性。

我开始在客户端操作十进制计算，并抛出了全球化解析问题。我也担心服务器端的十进制计算可能不等于客户端的处理结果。

因此，最好在服务器端计算十进制值，或者仅出于显示目的通过 JavaScript 计算它没有任何问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:33:18.963

这就像在做加法时问科学计算器是否比普通计算器好。

是的，这很好，但要谨慎行事。JS 有一个关于不精确小数的已知问题。据我所知，人们以“美分”（整数）计算，然后除以 100 得到“美元”（浮点数/小数）。

当然，您还应该在之后进行验证。众所周知，不能轻易相信客户端的输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:33:39.993

首先，在处理货币时，总是以整数工作。如果您以美元工作，则乘以 100 并以美分工作。无论您使用哪种货币，请以尽可能小的数量为单位工作。

这将消除任何舍入错误的机会。

只有在您获得以便士为单位的最终值之后，才能将其除以 100（或者更好的是使用字符串操作）以最精确地呈现它。

这将保证客户端和服务器获得相同的结果。

# c - C typedef'd array - 初始值是多少？

> ID：10770266
> 
> 赞同：0
> 
> 时间：2012-05-26T22:29:19.563
> 
> 标签：c, arrays, initialization

我知道数组的初始值在定义为静态时为 0，否则为未定义，但我不完全确定当数组是 typedef 时这是否相同。我想是的，但我想确认一下。

为了清楚起见，我的意思是这样的：

```
typedef float vector3[3];

int main (int argc, char* argv) {
    vector3 vec;
    static vector3 vec2;
} 
```

vec 变量将是未定义的，不是吗？那么vec2呢？应该都是0吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T22:33:09.667

是的，其中的值`vec`是未定义的；中的值`vec2`将全为零。

在定义或声明变量时，使用 a`typedef`对类型的行为没有影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:31:17.720

`typedef`s 对代码的语义绝对没有影响。这包括初始值。

# ruby-on-rails - Rails 3.2：没有方法错误

> ID：10770284
> 
> 赞同：0
> 
> 时间：2012-05-26T22:33:20.333
> 
> 标签：ruby-on-rails, ruby-on-rails-3

如果他们已登录，我试图在我的导航中的按钮中显示当前用户的名称。我不使用 Home 控制器做任何事情，为什么要求在其中定义名称？尝试在导航中呈现 user.name 时，任何涉及不同控制器的页面都会出错。

```
NoMethodError in Home#index

Showing /Users/nelsonkeating/Desktop/ReminDeal/app/views/layouts/_navigation.html.erb where line #10 raised:

undefined method `name' for nil:NilClass
Extracted source (around line #10):

7: <% if user_signed_in? %>
8:  <div class="logout1">
9:      <div class="btn-group">
10:             <button class="btn"><Action> <%= @user.name %> </button>
11:             <button class="btn dropdown-toggle" data-toggle="dropdown">
12:                 <span class="caret"></span>
13:             </button> 
              <ul class="dropdown-menu">
            <li><%= link_to 'Logout', destroy_user_session_path, :method=>'delete' %></li>
            <li><%= link_to 'My Account', edit_user_path(current_user.id)  %></li>
            <li><%= link_to "Help", help_path %></li>
        </ul>
    </div>
</div>
</li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:41:26.350

您是否在控制器中声明了@user？尝试将第 10 行更改为：

```
 <button class="btn"><Action> <%= current_user.name %> </button> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:21:27.540

我在stackoverflow中找到了这个另一个线程，它似乎是同样的问题：

[设计：NoMethod 错误和 user_signed_in](https://stackoverflow.com/questions/4116484/devise-nomethod-error-user-signed-in)

您似乎错过了在您的用户模型中设计 :database_authenticable 的调用。

# php - 使用 AJAX 删除表格行

> ID：10770285
> 
> 赞同：0
> 
> 时间：2012-05-26T22:33:27.080
> 
> 标签：php, javascript, jquery, ajax, datatables

我正在使用 AJAX 从 jQuery Datatable 中删除特定行。这些行在第 10 列中的值为 0（如果我们从 0 开始计数）。下面你可以看到我的代码。出于某种原因，它不会删除任何行。我检查了 aData[10] => 在某些行中它的值绝对等于 0。

```
 $(document).ready(function(){
          $('#newspaper-b').dataTable({
          "sPaginationType":"full_numbers",
          "aaSorting":[[4, "asc"]],
          "aoColumns": [null,null,null,null,null,null,null,null,null,null,
                        {"bSearchable": true, "bVisible": false},null,null],
          "bJQueryUI":true,
          'fnRowCallback': function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                if(aData[10]=="0"){
                    $(nRow).remove();
                }
                return nRow;
            }
          }); 
```

更新

当我这样做时：

```
'fnRowCallback': function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                      var r=confirm(aData[10]);
                  if (parseInt(aData[10], 10) === 0) {
                        $(nRow).remove();
                    }
                    return nRow;
                } 
```

...然后我可以看到其中一行有 0。但是当我这样做时：

```
'fnRowCallback': function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                  if (parseInt(aData[10], 10) === 0) {
var r=confirm(aData[10]);
                        $(nRow).remove();
                    }
                    return nRow;
            } 
```

...然后警报JS消息（即`var r=confirm(aData[10])`）没有出现，这意味着IF语句返回false。但为什么？？？

![在此处输入图像描述][1]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T22:36:08.123

这可能是打字问题。尝试将列值转换为整数，如下所示：

```
if (parseInt(aData[10], 10) === 0) {
    $(nRow).remove();
} 
```

# javascript - 在移动浏览器中加载 javascript

> ID：10770289
> 
> 赞同：1
> 
> 时间：2012-05-26T22:36:02.563
> 
> 标签：javascript, jquery

当浏览器宽度减小时，我在我的网站中应用了这个 javascript 来隐藏某个元素。

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $(window).bind("resize", function() {
            $('#slideshow').toggle($(this).width() >= 960);  
        }).trigger("resize");
    });
</script> 
```

但在移动浏览器中，它会在删除元素之前快速显示元素。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:39:23.827

在文档准备好之前，您的代码不会运行；这意味着您将简要地看到该元素，直到该`document.ready`方法在 jQuery 中被触发。您可以使用代码隐藏元素并将其直接放在元素之后，将其从`document.ready`包装器中删除。

```
<div id="slideshow"></div>
<script>
    $('#slideshow').toggle( $(window).width() >= 960 );
</script> 
```

或者，您可以默认隐藏元素，并在满足适当条件时使用 JavaScript 显示它。

```
<style>#slideshow { display: none }</style>

<div id="slideshow"></div>

<script>
    $('#slideshow').toggle( $(window).width() <= 960 );
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T22:40:29.120

您是否为此尝试过 twitter 引导解决方案？ [http://twitter.github.com/bootstrap/scaffolding.html](http://twitter.github.com/bootstrap/scaffolding.html)

# javascript - backbone.js - 解除绑定和交换视图

> ID：10770295
> 
> 赞同：1
> 
> 时间：2012-05-26T22:37:19.180
> 
> 标签：javascript, binding, backbone.js

我正在经历学习 Backbone.js 的过程，我遇到了一些*看起来*像它们工作的东西......但在幕后，它们可能会导致一些问题。其中一个问题是交换视图的设计模式。

我在左侧（和相应的视图）有一个包含用户列表的菜单。每个用户在单击时都会将其相应的电影列表显示在另一个视图的右侧。我通过获取点击用户的模型、基于该模型构建一个新的电影集合并渲染一个新的电影视图（在右侧）来做到这一点。如果我点击另一个用户，它会做同样的事情：它获取用户模型，构建一个新的电影集合，并在右侧呈现一个新的电影视图，替换 DOM 元素。这看起来不错——但我担心正在创建的所有新对象/绑定，以及可能出现的潜在问题。那么，我的替代方案是什么？

(1) 当集合发生变化时，我是否应该尝试重绘视图？如果我正在创建新集合，我该怎么做？

(2) 或者我应该在点击另一个用户时解除所有内容的绑定？

这是我的用户列表视图：

```
Window.UsersList = Backbone.View.extend({
    el: $("#users"),

    initialize: function(){
        this.collection.bind('reset', this.render, this);
    },
    render: function(){
        var users = []; 
        this.collection.each(function(user){
            users.push(new UsersListItem({model: user}).render().el);
        },this);

        $(this.el).html(users);

        return this; 
    }
}); 
```

在我的 UsersListItem 视图中，我捕获了单击事件并在我的控制器中调用 show_user_movies：

```
show_user_movies: function(usermodel){
// fetchMovies() lazy-loads and returns a new collections of movies
        var movie_collection = usermodel.fetchMovies();
        movie_list = new MovieList({collection: movie_collection, model: usermodel});
        movie_list.render(); 
    }, 
```

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:40:10.187

只需重新使用相同的`MovieList`视图及其关联的集合，`reset(models)`用于更新集合中的模型，这应该重新渲染视图。您可以使用与上面相同的模式，将 MovieList 视图绑定到集合的`reset`事件并在那时重新呈现自身。请注意，`usermodel.fetchMovies()`它不遵循接受`success/error`回调的主干异步模式，所以我认为代码不会按原样工作（也许你为了这个问题而简化了），但关键是当新的模型集从服务器，将其传递给`movie_list.collection.reset`您就可以开始了。这样您就不必担心解除绑定事件和创建新视图。

```
show_user_movies: function(usermodel){
    // fetchMovies() lazy-loads and returns a new collections of movies
    movie_list.collection.reset(usermodel.fetchMovies().models); 
}, 
```

# android - 编译 android jni 示例时出错：无效 -march= 选项：`armv5te'

> ID：10770296
> 
> 赞同：6
> 
> 时间：2012-05-26T22:37:24.390
> 
> 标签：android, java-native-interface

当我尝试编译一些 android ndk 示例时，我总是会收到此错误：

```
$ cd ~/Dev/Android/ndk/samples/hello-jni
$ ~/Dev/Android/ndk/ndk-build
Gdbserver      : [arm-linux-androideabi-4.4.3] libs/armeabi/gdbserver
Gdbsetup       : libs/armeabi/gdb.setup
Compile thumb  : hello-jni <= hello-jni.c
Assembler messages:
Fatal error: invalid -march= option: `armv5te'
make: *** [obj/local/armeabi/objs-debug/hello-jni/hello-jni.o] Error 1 
```

我或我的系统出了什么问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-27T16:24:38.763

我找到了一个解决方案：

```
$ ln -s $NDK_PATH/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/arm-linux-androideabi-as $NDK_PATH/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/libexec/gcc/arm-linux-androideabi/4.4.3/as 
```

首先，我运行带有选项的构建器以显示正在执行的命令：

```
$ ndk-build -B V=1 
```

所以我发现了它如何执行编译器并将相同的命令传递给 strace

```
strace arm-linux-androideabi-gcc -MMD -MP -MF ./obj/local/armeabi/objs-debug/hello-jni/hello-jni.o.d -fpic -ffunction-sections -funwind-tables -fstack-protector -D__ARM_ARCH_5__ -D__ARM_ARCH_5T__ -D__ARM_ARCH_5E__ -D__ARM_ARCH_5TE__  -Wno-psabi -march=armv5te -mtune=xscale -msoft-float -mthumb -Os -fomit-frame-pointer -fno-strict-aliasing -finline-limit=64 -Ijni -DANDROID  -Wa,--noexecstack -O0 -g -I/home/aleck/Dev/Android/ndk/platforms/android-8/arch-arm/usr/include -c  jni/hello-jni.c -o ./obj/local/armeabi/objs-debug/hello-jni/hello-jni.o 
```

这表明由于某种未知原因 arm-linux-androideabi-gcc 会按照标准搜索汇编程序，但在这种情况下，名称为 'as' 而不是 'arm-linux-androideabi-as'

```
stat64("/home/aleck/Dev/Android/ndk/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../libexec/gcc/arm-linux-androideabi/4.4.3/as", 0xbfedea68) = -1 ENOENT (No such file or directory)
stat64("/home/aleck/Dev/Android/ndk/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../libexec/gcc/as", 0xbfedea68) = -1 ENOENT (No such file or directory)
stat64("/home/aleck/Dev/Android/ndk/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/../../../../arm-linux-androideabi/bin/arm-linux-androideabi/4.4.3/as", 0xbfedea68) = -1 ENOENT (No such file or directory)
stat64("/home/aleck/Dev/Android/ndk/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/../../../../arm-linux-androideabi/bin/as", 0xbfedea68) = -1 ENOENT (No such file or directory)
vfork()                                 = 6931
waitpid(6931, Assembler messages:
Fatal error: invalid -march= option: `armv5te' 
```

所以我首先在预期的位置创建了一个名为“as”的软链接。

# android - 滑动标签（水平滚动）android中的片段之一中的GridView

> ID：10770297
> 
> 赞同：0
> 
> 时间：2012-05-26T22:37:41.207
> 
> 标签：android, gridview

我从谷歌名称“viewpager 遇到 swipey tabs”中实现了这个 swipey tabs 代码。现在对于片段活动，每个活动都使用 xml 布局进行设置。我希望这个活动显示一个网格视图。我尝试实现在[http://developer.android.com](http://developer.android.com)上解释的网格视图示例，但它为 gridview.setAdapter 上的 findgridviewbyid 和 imageadapter 构造函数提供了一些错误。我如何实现网格视图以仅在此片段中显示图像。

```
public class StockTabFragment extends Fragment {

  public static Fragment newInstance(String title) {
    StockTabFragment f = new StockTabFragment();
    Bundle args = new Bundle();
    args.putString("title", title);
    f.setArguments(args);
    return f;
  }

  @Override
  public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    ViewGroup root = (ViewGroup) inflater.inflate(R.layout.stock_tab_fragment, null);

    return root;
  }

  private ViewGroup createGridView(ViewGroup root) {
    GridView gridview = (GridView) findViewById(R.id.gridview);
    gridview.setAdapter(new ImageAdapter(this));

    gridview.setOnItemClickListener(new OnItemClickListener() {
      public void onItemClick(AdapterView<?> parent, View v, int position, long id) {                
        Toast.makeText(StockTabFragment.this, "" + position, Toast.LENGTH_SHORT).show();
      }
    });

    return root;
  }
} 
```

Stock_Tab_Fragment.xml

```
 <?xml version="1.0" encoding="utf-8"?>
 <GridView xmlns:android="http://schemas.android.com/apk/res/android" 
android:id="@+id/gridview"
android:layout_width="fill_parent" 
android:layout_height="fill_parent"
android:columnWidth="90dp"
android:numColumns="auto_fit"
android:verticalSpacing="10dp"
android:horizontalSpacing="10dp"
android:stretchMode="columnWidth"
android:gravity="center"
      /> 
```

# java - 如何在 JUnit 测试中测试列表？

> ID：10770304
> 
> 赞同：1
> 
> 时间：2012-05-26T22:38:36.963
> 
> 标签：java, eclipse, list, testing, junit

我创建了一个 Survey.java 类和一个 SurveyTest.java JUnit 测试。但我不确定如何在调查类中测试列表。如何在 JUnit 测试中测试它们？

调查.java

```
package com.jhaksurvey.model;

import java.util.List;

public class Survey {

private long id;
private String title;
private boolean active = true;
private List<Question> questions;

public Survey() {

}

public Survey(long id, String title) {
this.id=id;
this.title=title;   
}

public long getId() {
return id;
}

public void setId(long id) {
this.id = id;
}

public String getTitle() {
return title;
}

public void setTitle(String title) {
this.title = title;
}

public boolean isActive() {
return active;
}

public void setActive(boolean active) {
this.active = active;
}

public List<Question> getQuestions() {
return questions;
}

public void setQuestions(List<Question> questions) {
this.questions = questions;
}

} 
```

调查测试.java

```
package com.survey.model.test;

import junit.framework.Assert;
import junit.framework.TestCase;

import com.survey.model.Survey;

public class SurveyTest extends TestCase {

private Survey survey;

protected void setUp() throws Exception {
    super.setUp();  
    survey = new Survey();
}

public void testSurvey() {
    survey.toString();
}

public void testSurveyLongString() {
    fail("Not yet implemented");
}

public void testGetId() {
    long expected = (long) Math.random();
    survey.setId(expected);
    long actual = survey.getId();
    Assert.assertEquals(expected, actual);
}

public void testGetTitle() {
    String expected = "surveytitle";
    survey.setTitle(expected);
    String actual = survey.getTitle();
    Assert.assertEquals(expected, actual);  
}

public void testIsActive() {
    Boolean expected = true;
    survey.setActive(expected);
    Boolean actual = survey.isActive();
    Assert.assertEquals(expected, actual);
}

public void testGetQuestions() {
    fail("Not yet implemented");
}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T22:41:12.953

那个类没有真正的逻辑，所以你不需要测试这个类。您应该只测试包含某种逻辑的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T03:26:46.240

Survey.java 是一个隐藏值的模型/数据结构。理想情况下，您应该测试使用调查类的类。例如。CreateSurvey 可能是创建调查的类，因此您可以对 create 方法进行单元测试，以确保它正确设置了调查对象的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-12T09:17:59.063

您可以测试列表是否为空

# android - 在哪里可以找到默认的小部件样式值

> ID：10770306
> 
> 赞同：0
> 
> 时间：2012-05-26T22:39:03.717
> 
> 标签：android

我需要找到一些默认样式值。在我的情况下，这是 edittext 的默认填充值。我在 中找到了一些东西`android-sdk-windows\platforms\android-xx\data\res\values\styles.xml`，但是没有关于`edittext`填充的信息。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T22:40:26.073

`EditText`s 使用 9-patch 图像作为背景，因此填充实际上是在引用自`styles.xml`as的 .9.png 文件中定义的`background`。

# java - 绑定线程运行时间

> ID：10770317
> 
> 赞同：1
> 
> 时间：2012-05-26T22:40:34.560
> 
> 标签：java, multithreading, threadpool

我正在尝试查找有关如何限制使用[ThreadPoolExecutor](http://docs.oracle.com/javase/1.5.0/docs/api/index.html?java/util/concurrent/ThreadPoolExecutor.html)创建的任务的运行时间的更多信息。

我想创建一个自毁，例如当时间过去（例如1m）然后线程将自动终止并返回一个空值。这里的关键点是等待线程完成不应该阻塞主线程（在我们的例子中是 UI 线程）。

我知道我可以使用[get](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/FutureTask.html#get%28%29)方法，但是它会阻止我的应用程序。

我正在考虑运行一个额外的内部线程，它将休眠 1m，然后在主线程上调用中断。

我附上了一个示例代码，它看起来是个好主意，但我需要另一双眼睛告诉我它是否有意义。

```
public abstract class AbstractTask<T> implements Callable<T> {
private final class StopRunningThread implements Runnable {
    /**
     * Holds the main thread to interrupt. Cannot be null.
     */
    private final Thread mMain;

    public StopRunningThread(final Thread main) {
        mMain = main;

    }
    @Override
    public void run() {
        try {
            Thread.sleep(60 * 1000);
            // Stop it.
            mMain.interrupt();
        } catch (final InterruptedException exception) {
            // Ignore.
        }
    }
} 
```

call() 通过 ThreadPool 调用

```
public T call() {
    try {
        // Before running any task initialize the result so that the user
        // won't
        // think he/she has something.
        mResult = null;
        mException = null;
        // Stop running thread.
        mStopThread = new Thread(new StopRunningThread(
                Thread.currentThread()));
        mStopThread.start();

        mResult = execute(); <-- A subclass implements this one
    } catch (final Exception e) {
        // An error occurred, ignore any result.
        mResult = null;
        mException = e;
        // Log it.
        Ln.e(e);
    }
    // In case it's out of memory do a special catch.
    catch (final OutOfMemoryError e) {
        // An error occurred, ignore any result.
        mResult = null;
        mException = new UncheckedException(e);
        // Log it.
        Ln.e(e);
    } finally {
        // Stop counting.
        mStopThread.interrupt();
    }

    return mResult;
} 
```

我害怕有几点：

*   如果 execute() 有异常会发生什么，然后我的外部线程将立即中断，那么我将永远不会捕获异常。
*   内存/CPU 消耗，我使用线程池来避免创建新线程。

您是否看到实现相同功能的更好主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T04:58:19.067

这样做会有些麻烦。首先，您需要扩展 ThreadPoolExecutor 类。您需要覆盖“beforeExecute”和“afterExecute”方法。他们将跟踪线程开始时间，并在之后进行清理。然后你需要一个收割者来定期检查哪些线程需要清理。

此示例使用 Map 来记录每个线程的启动时间。beforeExecute 方法填充它，而 afterExecute 方法清除它。有一个 TimerTask 定期执行并查看所有当前条目（即所有正在运行的线程），并在所有超过给定时间限制的条目上调用 Thread.interrupt()。

请注意，我提供了两个额外的构造函数参数：maxExecutionTime 和 reaperInterval 来控制任务的执行时间，以及检查要终止的任务的频率。为了简洁起见，我在这里省略了一些构造函数。

请记住，您提交的任务必须表现良好并允许自己被杀死。这意味着您必须：

1.  在执行期间定期检查 Thread.currentThread().isInterrupted()。
2.  尽量避免任何未在其 throws 子句中声明 InterruptedException 的阻塞操作。一个典型的例子是 InputStream/OutputStream 的使用，你可以使用 NIO Channels。如果必须使用这些方法，请在此类操作返回后立即检查中断标志。

.

```
public class TimedThreadPoolExecutor extends ThreadPoolExecutor {
    private Map<Thread, Long> threads = new HashMap<Thread, Long>();
    private Timer timer;

    public TimedThreadPoolExecutor(int corePoolSize, int maximumPoolSize,
            long keepAliveTime, TimeUnit unit, BlockingQueue<Runnable> workQueue,
            long maxExecutionTime,
            long reaperInterval) {
        super(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue);
        startReaper(maxExecutionTime, reaperInterval);
    }

    @Override
    protected void afterExecute(Runnable r, Throwable t) {
        threads.remove(Thread.currentThread());
        System.out.println("after: " + Thread.currentThread().getName());
        super.afterExecute(r, t);
    }

    @Override
    protected void beforeExecute(Thread t, Runnable r) {
        super.beforeExecute(t, r);
        System.out.println("before: " + t.getName());
        threads.put(t, System.currentTimeMillis());
    }

@Override
protected void terminated() {
    if (timer != null) {
        timer.cancel();
    }
    super.terminated();
}

    private void startReaper(final long maxExecutionTime, long reaperInterval) {
        timer = new Timer();
        TimerTask timerTask = new TimerTask() {
            @Override
            public void run() {
                // make a copy to avoid concurrency issues.
                List<Map.Entry<Thread, Long>> entries = 
                        new ArrayList<Map.Entry<Thread, Long>>(threads.entrySet());
                for (Map.Entry<Thread, Long> entry : entries) {
                    Thread thread = entry.getKey();
                    long start = entry.getValue();
                    if (System.currentTimeMillis() - start > maxExecutionTime) {
                        System.out.println("interrupting thread : " + thread.getName());
                        thread.interrupt();
                    }
                }
            }

        };
        timer.schedule(timerTask, reaperInterval, reaperInterval);
    }

    public static void main(String args[]) throws Exception {
        TimedThreadPoolExecutor executor = new TimedThreadPoolExecutor(5,5, 1000L, TimeUnit.MILLISECONDS, new ArrayBlockingQueue<Runnable>(20),
                1000L,
                200L);

        for (int i=0;i<10;i++) {
            executor.execute(new Runnable() {
                public void run() {
                    try {
                        Thread.sleep(5000L);
                    }
                    catch (InterruptedException e) {

                    }
                }
            });
        }

        executor.shutdown();
        while (! executor.isTerminated()) {
            executor.awaitTermination(1000L, TimeUnit.MILLISECONDS);
        }
    }

} 
```

# javascript - 按下后退按钮时 Firefox 记住的文档修改

> ID：10770318
> 
> 赞同：2
> 
> 时间：2012-05-26T22:40:35.790
> 
> 标签：javascript, jquery, firefox

提交表单时，我会显示加载动画并禁用按钮。不幸的是，当我单击后退按钮时，Firefox 仍然显示加载图像并且该按钮仍然被禁用。这在 Chrome 中不会发生。有任何想法吗？

```
$(document).ready(function() {
    $('#go').removeAttr('disabled');
    $('#loading').replaceWith('<img id="loading" src="/static/images/loading.gif" style="display:none; vertical-align:middle" />');

    $('#go').click(function(e) {
        e.preventDefault();
        $('#go').attr('disabled', 'disabled');
        $('#loading').show();
        $('#go_form').submit();
    });
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T22:59:19.140

Firefox 在浏览器会话中对整个网页（包括其 JavaScript 状态）使用内存缓存。在访问的页面之间来回移动不需要页面加载。此功能使页面导航非常快。

为了检测到这一点，请使用`pageshow`事件。该事件将有一个名为的属性`persisted`，如果您在缓存中导航，该属性将为真。如果您看到此状态，您可以重置页面的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T22:51:32.250

这可能是由于 Chrome 和 Firefox 中的缓存机制不同。一个简单的解决方法是在`onunload`事件中隐藏加载图像。

# c - 带有 PlayBook NDK 的 libpurple

> ID：10770321
> 
> 赞同：2
> 
> 时间：2012-05-26T22:40:50.080
> 
> 标签：c, google-talk, libpurple, playbook

我和我的朋友都有 PlayBooks，但上面没有可靠的 Google Talk 应用程序。

我们想开始一个，我想知道是否有人可以提供任何提示。

我正在考虑使用 libpurple，因为它是一个基于 C 的库和 PlayBook NDK。

这可行吗？有推荐的起点吗？有什么一般提示吗？

谢谢，

帕思

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-30T06:44:13.347

黑莓使用基于Qt的QNX平台。

目前 libpurple 不与 Qt 交互。然而，有一个 Google Summer of Code 项目可以为 libpurple 创建一个[Qt 用户界面](https://kingant.net/2013/05/four-pidgin-summer-of-code-students/)。理论上，一旦这项工作完成，那么移植到 Playbook 将是一项中短任务。

# asp.net-mvc - 从 ASP.NET MVC 中的 ViewModel 中删除前缀

> ID：10770326
> 
> 赞同：2
> 
> 时间：2012-05-26T22:42:18.647
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, viewmodel, model-binding

我有一个由几个嵌套类组成的 ViewModel 类：

```
 public class UserAccountViewModel : UserProfileViewModel
    {
        public UserAccountEmailViewModel UserAccountEmail { get; set; }
        public UserAccountLocationViewModel UserAccountLocation { get; set; }
        public UserAccountPasswordViewModel UserAccountPassword { get; set; }
    } 
```

由此呈现的 HTML（注意 **model.UserAccountEmail.Email**）：

```
<div class="editor-label">
        @Html.LabelFor(model => model.UserAccountEmail.Email)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.UserAccountEmail.Email)
        @Html.ValidationMessageFor(model => model.UserAccountEmail.Email)
    </div> 
```

这是：

```
name="UserAccountEmail.Email" 
```

我宁愿名字简单`Email`

改变`ViewData.TemplateInfo.HtmlFieldPrefix`没有帮助。重载`htmlFieldName`in`@Html.EditorFor`不起作用，因为我仍然希望标签和验证消息与呈现的 HTML 元素匹配（这些函数中没有 htmlFieldName 重载）。

我宁愿不为此创建部分。

**编辑：**

**嗯...使用部分实际上并不算太糟糕。这实际上很有意义。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T22:55:32.520

在这里查看我关于这个设计的回答，这可能对这个特定的策略有意义

[许多模型以许多局部视图查看](https://stackoverflow.com/questions/10769997/many-models-to-view-with-many-partial-views/10770097#10770097)

# java - 为什么 adapter.add() 会创建一个无限循环并崩溃？

> ID：10770327
> 
> 赞同：0
> 
> 时间：2012-05-26T22:42:28.657
> 
> 标签：java, android, loops, adapter, android-arrayadapter

我正在制作一个 Android 应用程序，我的实现`adapter.add()`似乎使应用程序崩溃。我不得不使用 Log 标签来发现我的代码奇怪地陷入了循环。这是代码：

```
int i =0;
if(cards.size()>0){
    Log.i("KOOL","Checked arraylist size =" + cards.size());
    while(i < cards.size()){
        Log.i("KOOL","Inside while loop");
        adapter.add(cards.get(i));
        i++;
    }
    Log.i("KOOL","Added data to adapter");
    adapter.notifyDataSetChanged();
    Log.i("KOOL","Finished OnActivityResult");
} 
```

应用程序到达日志标签“内部 while 循环”并重复它，直到应用程序崩溃。我知道`cards.size()`在 while 循环之前是 2，所以我认为应用程序没有崩溃的原因。我是否正确使用了适配器？请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:47:15.900

您的问题缺少一些上下文。幸运的是，我知道您的适配器是 type`ArrayAdapter`并且它被初始化为`cards`. 当你的循环开始时，`cards.size()`是**2**。但后来你`add`有所作为， `cards.size()`成为**3**。然后……我想你明白了。`add`您可以通过适配器或通过您的列表将某些内容添加到您的适配器/列表对`add`。如果您将其添加到两者，那么您将添加两次。

这是代码`ArrayAdapter::add`：

```
public void add(T object) {
    synchronized (mLock) {
        if (mOriginalValues != null) {
            mOriginalValues.add(object);
        } else {
            mObjects.add(object);
        }
    }
    if (mNotifyOnChange) notifyDataSetChanged();
} 
```

`mOriginalValues`您用来构建适配器的相同列表在哪里。`mObjects`是它们的过滤版本。

# database - Neo4j 可以处理超过 60,000 个节点的遍历吗？

> ID：10770328
> 
> 赞同：1
> 
> 时间：2012-05-26T22:42:52.437
> 
> 标签：database, graph, neo4j

我正在使用具有超过 60,000 个节点的相当大的 Neo4J 设置。每个节点大约有 4~5 个属性和简单的父->子关系。在处理这 60,000 个节点时，特别是在昂贵且重复的查询中，我通过 Neo4J 的 REST 接口收到各种 500 HTTP 错误。

在查看日志后，我发现 Java 堆空间是问题所在。我将 512 MB 限制提高到 2048 MB，但它仍然给我 500。如果我将堆设置为 3GB 或 4GB，neo4j 甚至都不会启动。我正在一台相当不错的笔记本电脑（i5、4GB RAM）上对此进行测试，我真的很想知道这是否是配置问题，或者应用程序是否会在我的服务器（亚马逊超大型高 CPU 实例）上正常运行。是否有某种缓存可以帮助我更快地获得东西？基本上，我多次迭代整个节点网络。

我正在运行两个查询。第一个是：

```
start referrer=node(3) match path=referrer-[*1..1]->referral return referral 
```

这样做是为了发现引荐人 #3 的第 1 层节点。然后，我必须从他的所有层中发现所有节点，返回节点，第一层的节点，然后是层号。

```
start referrer=node(3) match path=referrer-[*1..1]->firsttier-[*0..]->referral return referral, firsttier, length(path) 
```

它工作得很好，而且速度很快。但是，我正在为我网络中的所有节点执行此操作。我在 for 循环中运行这两个查询（并使用它们应用业务逻辑）。循环运行 60,000 次。

现在我正在我的笔记本电脑上测试这个，但是，这个“任务”已经为分布式处理做好了准备，因为我用 ZeroMQ 做了一切。for 循环向工作人员发送消息，工作人员进行查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:35:47.333

60,000 个节点对于 Neo4j 来说是很小的——它可以达到 320 亿+——但是你需要增加配置中的堆大小。

见[http://blog.neo4j.org/2011/03/neo4j-13-abisko-lampa-m04-size-really.html](http://blog.neo4j.org/2011/03/neo4j-13-abisko-lampa-m04-size-really.html)

但是，您可能希望限制通过 REST 返回的节点数量并对它们进行分页。

或者您可能会考虑返回所有 ID，将它们缓存在您的应用程序或 Redis 之类的东西中，然后在 ID 上使用 Cypher 进行多次获取。这样您就不会每次都运行查询。

# c++ - C ++在不知道位置的情况下删除向量中的特定值

> ID：10770336
> 
> 赞同：0
> 
> 时间：2012-05-26T22:44:56.350
> 
> 标签：c++, vector, stack, erase

```
if (find(visitable.begin(), visitable.end(), ourstack.returnTop())) { ... } 
```

我想确定是否`ourstack`可以在向量中找到堆栈中的顶部字符`visitable`。如果是，我希望从`visitable`.

我将如何编码？我知道向量使用`erase`，但这需要该字符的特定位置（我不知道）。

这是给我的[迷宫寻路任务](https://stackoverflow.com/questions/10763233/algorithm-to-print-to-screen-paths-through-a-text-maze)。

另外，我`returnTop`给了我一个错误：`class "std.stack<char..." has no member returnTop`. 我在我的程序顶部声明了#include。这里发生了什么事？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T22:51:53.683

如果您正在使用`find`，那么您已经知道角色的位置。`find`将迭代器返回到找到字符的位置，如果找不到则返回用作 end 的值。

```
vector<?>::const_iterator iter =
    find(visitable.begin(), visitable.end(), ourstack.top());
if( iter != visitable.end() )
{
    visitable.erase( iter );
} 
```

至于`stack`，你要找的功能是`top()`。标准 C++ 库不使用驼峰式标识符，这看起来更像是 Java 或 C# 的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T22:56:56.770

像这样：

```
// Note assume C++0x notation for simplicity since I don't know the type of the template
auto character = ourstack.top();

auto iter = std::find(visitable.begin(), visitable.end(), character);
if (iter != visitable.end())
    visitable.erase(iter); 
```

returnTop 在 stack 类中不存在，但 top 存在。

或者，如果您想要一些通用（而且相当华丽的方式）这样做：

```
// Assume type of vector and stack are the same
template <class T>
void TryRemoveCharacter(std::vector<T>& visitable, const std::stack<T>& ourStack)
{
    // Note, could have passed a ref to the character directly, which IMHO makes more sense
    const T& ourChar = ourStack.top();

    visitable.erase(std::remove_if(visitable.begin(), visitable.end(), [&ourChar](const T& character)
    {
        // Note, this will not work http://www.cplusplus.com/reference/algorithm/find/
        // says that std::find uses the operator== for comparisons but I doubt that
        // as compilers typically do not generate equal comparison operator.
        // See http://stackoverflow.com/questions/217911/why-dont-c-compilers-define-operator-and-operator
        // It's best to either overload the operator== to do a true comparison or
        // add a comparison method and invoke it here.
        return ourChar == character;
    }));
} 
```

注意：这种替代方式对于作业可能不是一个好主意，因为您的老师可能会怀疑您突然引入高级 C++ 功能 (C++0x)。
然而，出于求知欲，它可以工作；）

以下是您可以如何使用它：

```
TryRemoveCharacter(visitable, ourstack); 
```

# c# - 每个用户的实体框架行级安全性

> ID：10770338
> 
> 赞同：2
> 
> 时间：2012-05-26T22:45:43.793
> 
> 标签：c#, entity-framework, security, dry

我正在使用实体框架和 SQL Server 2008 作为数据存储的 ASP.Net MVC3 网站。此外，我正在使用存储库模式将所有数据访问代码集中在一个区域中。

在我的应用程序中，我有很多用户，每个用户都可以有很多项目。用户应该只能访问他们自己的项目。目前我有这个代码：

```
 public IQueryable<Project> All
    {
        get { 
            return context.Projects
                .Where(p => p.Owner.ID == Util.GetCurrentUserID())
                .Select(p=>p); 
        }
    }

    public Project Find(System.Guid id)
    {
        return context.Projects
                .Where(p => p.Owner.ID == Util.GetCurrentUserID())
                .FirstOrDefault();
    } 
```

如果你注意到`.Where(p => p.Owner.ID == Util.GetCurrentUserID())`是重复的。我还有很多其他地方到处都是这些确切的条件。

DbContext 中有没有办法让这个条件总是自动附加到任何查询到 Projects 表中？

就像是：

```
public class MyContext : DbContext
{
    public DbSet<Project> Projects
         .Where(p => p.Owner.ID == Util.GetCurrentUserID()) { get; set; }
} 
```

或者

```
public class MyContext : DbContext
{
    public DbSet<Project> Projects { get {
           // Insert a cast from IQuerieable to DBSet below
       return Projects
              .Where(p => p.Owner.ID == Util.GetCurrentUserID())
              .Select(p => p);
    } 
    set; }
} 
```

**UPD**在写这个问题的时候，意识到最后一个版本可以正常工作——需要尝试一下。仍然希望听到其他代码优化选项并使其更加干燥。

提前致谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T00:45:55.010

您始终可以编写一个名为“WhereProject”的扩展方法。然后在将条件附加到谓词后，在扩展方法中调用标准的“Where”方法。

```
public static IEnumerable<TSource> WhereProject<TSource>(this IEnumerable<TSource> source, Func<TSource, bool> predicate) where TSource: Project
{
     return source.Where(p=> p.Owner.ID == Util.GetCurrentUserID() && predicate);
} 
```

您可以根据需要跳过谓词，也可以在参数列表中将其设置为 null 以获得默认值，然后在您不想使用谓词时采取相应措施。

* * *

**这可能是你想要**的，很简单：

```
public static IEnumerable<TSource> WhereProject<TSource>(this IEnumerable<TSource> source) where TSource: Project
{
     return source.Where(p=> p.Owner.ID == Util.GetCurrentUserID());
} 
```

**编辑** 这些解决方案对我来说听起来不对。我认为您希望将行数据保护更高一级，在我的情况下，它将是**服务层**。考虑你的服务类中的一个方法，如下所示：

```
public List<Project> GetUserProjects(User user)
{
    return repo.All().Where(p => p.Owner.ID == Util.GetCurrentUserID()).ToList();
} 
```

这样，从方法名上，就很清楚自己在做什么了。存储库不负责包含您的特定逻辑。它仅用于处理您的数据访问。

# java - 使用对象的特定变量对 LinkedList 进行排序？

> ID：10770341
> 
> 赞同：0
> 
> 时间：2012-05-26T22:46:54.407
> 
> 标签：java, sorting, object

我有一个冒泡排序函数，它通过“a”变量对 SomeObj 的 LinkedList 进行排序。如果我想同时按“b”变量对列表进行排序怎么办？我能做什么而不是用 b 编写另一个函数？

```
public static void BubbleSort(LinkedList<SomeObj> objs) {
    int len = objs.size();

    for(int pass = 1; pass < len; pass++) {
        for (int i=0; i < len - pass; i++) {
            if(objs.get(i).a > objs.get(i + 1).a) {
                SomeObj p = objs.get(i);
                objs.set(i,objs.get(i+1));
                objs.set(i + 1, p);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T22:56:35.533

**使用 compare 方法在类中**实现 Comparator 接口。**接受两个对象并比较它们，返回 -ve,0,+ve 值以告知小于、等于或大于。**

 **创建此 Comparator 的对象并将其传递给冒泡排序方法，并让它使用其比较方法来比较两个对象。

您的对象应该具有所有此类字段的吸气剂。

此外，每当您想更改对象的比较标准时，请使用不同的比较器。

检查这个 [例子](http://www.javadeveloper.co.in/java-example/java-comparator-example.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T22:55:01.027

您将让您的 SomeObj 实现该`Comparable`接口，然后让您的排序使用该接口与它进行交互。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-26T22:57:26.563

如果您可以通过第一个“a”进行排序，那么“b”是在您的 SomeObj 类中实现 Comparable 并创建一个比较 a 和 b 的 compareTo 方法。[http://www.javapractices.com/topic/TopicAction.do?Id=10](http://www.javapractices.com/topic/TopicAction.do?Id=10)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-26T22:55:23.120

决定哪个优先级最高。检查更高优先级的变量 - 如果它们不同，只需排序，就好像你只是在排序一样。如果高优先级变量匹配，那么您必须返回到较低优先级的变量，并以此为基础进行整个比较。

```
if (obj1.getA() != obj2.getA()) {
    // do compare on As
    // e.g. return onj2.getA() - obj1.getA()
}
else { // A's match, so do compares on B
    // e.g. return obj2.getB() - obj1.getB()
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-26T22:58:16.047

我认为最简单的方法是交换变量值而不是列表项。使用这种方法，您可以同时以不同的方式“排序”列表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-26T23:02:45.160

我想有一种误解 - 这不是按 a 排序然后按 b 排序，它是一种 2 个列表合二为一，用户希望对它们进行独立排序但不创建第二个列表，或者我不对？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-26T23:10:22.220

对于排序列表，您可以使用

```
Collections.sort(List list, Comparator c)); 
```

就像在这个主要方法中

```
class Pair{
    int a;
    int b;

    public Pair(int a, int b) {
        this.a=a;
        this.b=b;
    }

    public String toString() {
        // TODO Auto-generated method stub
        return "["+a+","+b+"]";
    }

    //test
    public static void main(String[] args) {
        Comparator<Pair> comparatorA=new Comparator<Pair>() {
            @Override
            public int compare(Pair o1, Pair o2) {
                if (o1.a>o2.a) return 1;
                if (o1.a<o2.a) return -1;
                return 0;
            }
        };
        LinkedList<Pair> list=new LinkedList<>();
        list.add(new Pair(1,2));
        list.add(new Pair(2,1));
        list.add(new Pair(3,1));
        list.add(new Pair(1,3));

        Collections.sort(list, comparatorA);
        System.out.println(list);
    }
} 
```

现在您可以为 b 值制作比较器并将 Collections.sort 与该比较器一起使用**

# json - 如何基于丰富动态调度？

> ID：10770344
> 
> 赞同：2
> 
> 时间：2012-05-26T22:47:08.143
> 
> 标签：json, scala, spray, enrich-my-library

[Spray-json](http://github.com/spray/spray-json "喷雾-json")库使用方法扩展了基本的 Scala 类型`toJson`。如果底层类型存在这样的皮条客，我想将其转换`Any`为 a 。[`JsValue`](http://spray.github.com/spray/api/spray-json/#cc.spray.json.JsValue "价值")我最好的尝试有效，但很冗长：

```
import cc.spray._

val maybeJson1: PartialFunction[Any, JsValue] = {
  case x: BigDecimal => x.toJson
  case x: BigInt => x.toJson
  case x: Boolean => x.toJson
  case x: Byte => x.toJson
  case x: Char => x.toJson
  case x: Double => x.toJson
  case x: Float => x.toJson
  case x: Int => x.toJson
  case x: Long => x.toJson
  case x: Short => x.toJson
  case x: String => x.toJson
  case x: Symbol => x.toJson
  case x: Unit => x.toJson
} 
```

理想情况下，我更喜欢这样的东西（不可能）：

```
def maybeJson2(any: Any): Option[JsValue] = {
  if (pimpExistsFor(any))
    Some(any.toJson)
  else
    None  
} 
```

有没有一种方法可以做到这一点，而无需枚举已丰富的每种类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T23:33:20.013

有一种方法，但它需要*大量*的反思，因此很头疼。基本思路如下。该`DefaultJsonProtocol`对象继承了一堆包含隐含对象的特征，这些隐含对象包含`write`方法。它们中的每一个都有一个访问器函数，但你不会知道它叫什么。基本上，您只需采用*所有*不带参数的方法并返回一个对象，该对象具有一个`write`方法，该方法采用您的对象的类并返回一个`JsValue`. 如果您恰好找到一种这样的方法返回一个这样的类，请使用反射来调用它。否则，保释。

它看起来*像*这样（警告，未经测试）：

```
def canWriteMe(writer: java.lang.Class[_], me: java.lang.Class[_]): 
  Option[java.lang.reflect.Method] =
{
  writer.getMethods.find(_.getName == "write").filter{ m =>
    classOf[JsValue].isAssignableFrom(m.getReturnType) && {
      val parm = m.getParameterTypes()
      m.length == 1 && parm(0).isAssignableFrom(me)
    }
  }
}
def maybeJson2(any: Any): Option[JsValue] = {
  val couldWork = {
    DefaultJsonProtocol.getClass.getMethods.
      filter(_.getParameterTypes.length==0).
      flatMap(m => canWriteMe(m.getReturnType, any.getClass).map(_ -> m))
  }
  if (couldWork.length != 1) None else {
    couldWork.headOption.map{ case (wrMeth, obMeth) =>
      val wrObj = obMeth.invoke(DefaultJsonProtocol)
      val answer = wrMeth.invoke(wrObj, any)
    }
  }
} 
```

无论如何，您最好`DefaultJsonProtocol`在 REPL 中逐步将类分开，并找出如何可靠地识别定义编写器的对象，然后从中获取`write`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T11:39:54.150

我不确定它是否适合您的需求，但这是一种非常简单且类型安全的替代方法。

如果您保留参数的类型（而不是使用`Any`），则可以依靠隐式参数解析在编译时找到正确的转换：

```
def toJson[T:JsonFormat]( t: T ): JsValue = implicitly[JsonFormat[T]].write(t) 
```

您不需要选项，因为如果您尝试传递一个不是“pimpable”的参数，程序将在编译时失败。

# html - Looking for a (httpd like) way/server to access static files (html/images etc) from my windows pc using http

> ID：10770347
> 
> 赞同：0
> 
> 时间：2012-05-26T22:47:47.850
> 
> 标签：html, windows, redirect, apache

I have a static html project which contains some files I want to have access to using my cell phones or laptop's internet browser.

The concept is I have a folder in my pc which contains the files. I would hit my computer's IP through the web browser of my laptop

```
(like http://192.168.1.5/myProject/index.html) 
```

and then a server (like apache httpd works for redirecting to servers) would return me the wanted file.

NOTES: -It should be EASY and FAST to install and Configure.

Any suggestions? Most acceptable answers are for Windows and then I accept for mac!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T22:56:57.737

Have you tried xampp for an apache server? There is a portable app version as well.

Also iisexpress is a nice standalone version of IIS that runs under current user profile. Not sure if there are any limitations w the bindings tho.

# java - 带有 ArrayBlockingQueue 的 ThreadPoolExecutor

> ID：10770348
> 
> 赞同：6
> 
> 时间：2012-05-26T22:47:58.977
> 
> 标签：java, multithreading, threadpool, executorservice

当我在我的一个项目中使用它时，我开始从 Java Doc 中阅读更多关于 ThreadPoolExecutor 的信息。那么谁能解释一下这条线的实际含义是什么？-我知道每个参数代表什么，但我想从这里的一些专家那里以更一般/外行的方式理解它。

```
ExecutorService service = new ThreadPoolExecutor(10, 10, 1000L,
TimeUnit.MILLISECONDS, new ArrayBlockingQueue<Runnable>(10, true), new 
ThreadPoolExecutor.CallerRunsPolicy()); 
```

**更新：-** 问题陈述是：-

每个线程使用 1 到 1000 之间的唯一 ID，并且程序必须运行 60 分钟或更长时间，因此在这 60 分钟内，所有 ID 都可能完成，因此我需要再次重用这些 ID。所以这是我使用上面的执行器编写的下面的程序。

```
class IdPool {
    private final LinkedList<Integer> availableExistingIds = new LinkedList<Integer>();

    public IdPool() {
        for (int i = 1; i <= 1000; i++) {
            availableExistingIds.add(i);
        }
    }

    public synchronized Integer getExistingId() {
        return availableExistingIds.removeFirst();
    }

    public synchronized void releaseExistingId(Integer id) {
        availableExistingIds.add(id);
    }
}

class ThreadNewTask implements Runnable {
    private IdPool idPool;

    public ThreadNewTask(IdPool idPool) {
        this.idPool = idPool;
    }

    public void run() {
        Integer id = idPool.getExistingId();
        someMethod(id);
        idPool.releaseExistingId(id);
    }

// This method needs to be synchronized or not?
    private synchronized void someMethod(Integer id) {
        System.out.println("Task: " +id);
// and do other calcuations whatever you need to do in your program
    }
}

public class TestingPool {
    public static void main(String[] args) throws InterruptedException {
        int size = 10;
        int durationOfRun = 60;
        IdPool idPool = new IdPool();   
        // create thread pool with given size
        ExecutorService service = new ThreadPoolExecutor(size, size, 500L, TimeUnit.MILLISECONDS, new ArrayBlockingQueue<Runnable>(size), new ThreadPoolExecutor.CallerRunsPolicy()); 

        // queue some tasks
        long startTime = System.currentTimeMillis();
        long endTime = startTime + (durationOfRun * 60 * 1000L);

        // Running it for 60 minutes
        while(System.currentTimeMillis() <= endTime) {
            service.submit(new ThreadNewTask(idPool));
        }

        // wait for termination        
        service.shutdown();
        service.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS); 
    }
} 
```

我的问题是：- 就性能而言，此代码是否正确？还有什么我可以在这里使它更准确？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-27T04:16:55.777

[首先，我很抱歉，这是对先前答案的回应，但我想要格式化]。

除非在现实中，当一个项目被提交到具有完整队列的 ThreadPoolExecutor 时，您不会阻塞。原因是 ThreadPoolExecutor 调用了 BlockingQueue.offer(T item) 方法，该方法定义为非阻塞方法。它要么添加项目并返回 true，要么不添加（满时）并返回 false。ThreadPoolExecutor 然后调用注册的 RejectedExecutionHandler 来处理这种情况。

从javadoc：

> 在未来的某个时间执行给定的任务。该任务可以在新线程或现有池线程中执行。如果任务无法提交执行，要么是因为这个执行器已经关闭，要么是因为它的容量已经达到，任务由当前的 RejectedExecutionHandler 处理。

默认情况下，使用 ThreadPoolExecutor.AbortPolicy() 从 ThreadPoolExecutor 的“提交”或“执行”方法抛出 RejectedExecutionException。

```
try {
   executorService.execute(new Runnable() { ... });
}
catch (RejectedExecutionException e) {
   // the queue is full, and you're using the AbortPolicy as the 
   // RejectedExecutionHandler
} 
```

但是，您可以使用其他处理程序来做一些不同的事情，例如忽略错误（DiscardPolicy），或者在调用“执行”或“提交”方法的线程中运行它（CallerRunsPolicy）。此示例让调用“提交”或“执行”方法的线程在队列已满时运行请求的任务。（这意味着在任何给定时间，您都可以在池本身的内容之上运行 1 个额外的东西）：

```
ExecutorService service = new ThreadPoolExecutor(..., new ThreadPoolExecutor.CallerRunsPolicy()); 
```

如果你想阻塞并等待，你可以实现你自己的 RejectedExecutionHandler 它将阻塞直到队列上有一个可用的插槽（这是一个粗略的估计，我没有编译或运行它，但你应该明白）：

```
public class BlockUntilAvailableSlot implements RejectedExecutionHandler {
  public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {
     if (e.isTerminated() || e.isShutdown()) {
        return;
     }

     boolean submitted = false;
     while (! submitted) {
       if (Thread.currentThread().isInterrupted()) {
            // be a good citizen and do something nice if we were interrupted
            // anywhere other than during the sleep method.
       }

       try {
          e.execute(r);
          submitted = true;
       }
       catch (RejectedExceptionException e) {
         try {
           // Sleep for a little bit, and try again.
           Thread.sleep(100L);
         }
         catch (InterruptedException e) {
           ; // do you care if someone called Thread.interrupt?
           // if so, do something nice here, and maybe just silently return.
         }
       }
     }
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T23:15:07.850

It's creating an `ExecutorService` which handles the execution of a pool of threads. Both the initial and maximum number of threads in the pool is 10 in this case. When a thread in the pool becomes idle for 1 second (1000ms) it will kill it (the idle timer), however because the max and core number of threads is the same, this will never happen (it always keeps 10 threads around and will never run more than 10 threads).

It uses an `ArrayBlockingQueue` to manage the execution requests with 10 slots, so when the queue is full (after 10 threads have been enqueued), it will block the caller.

If thread is rejected (which in this case would be due to the service shutting down, since threads will be queued or you will be blocked when queuing a thread if the queue is full), then the offered `Runnable` will be executed on the caller's thread.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T11:27:53.367

考虑信号量。这些都是为了相同的目的。请检查下面使用信号量的代码。不确定这是否是您想要的。但是，如果没有更多的许可证可以获取，这将被阻止。ID对您来说也很重要吗？

```
import java.util.concurrent.ArrayBlockingQueue;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Semaphore;
import java.util.concurrent.ThreadPoolExecutor;
import java.util.concurrent.TimeUnit;

class ThreadNewTask implements Runnable {
    private Semaphore idPool;

    public ThreadNewTask(Semaphore idPool) {
        this.idPool = idPool;
    }

    public void run() {
//      Integer id = idPool.getExistingId();
        try {
            idPool.acquire();
            someMethod(0);
        } catch (InterruptedException e) {
            e.printStackTrace();
        } finally {
            idPool.release();
        }
//      idPool.releaseExistingId(id);
    }

    // This method needs to be synchronized or not?
    private void someMethod(Integer id) {
        System.out.println("Task: " + id);
        // and do other calcuations whatever you need to do in your program
    }
}

public class TestingPool {
    public static void main(String[] args) throws InterruptedException {
        int size = 10;
        int durationOfRun = 60;
        Semaphore idPool = new Semaphore(100); 
//      IdPool idPool = new IdPool();
        // create thread pool with given size
        ExecutorService service = new ThreadPoolExecutor(size, size, 500L,
                TimeUnit.MILLISECONDS, new ArrayBlockingQueue<Runnable>(size),
                new ThreadPoolExecutor.CallerRunsPolicy());

        // queue some tasks
        long startTime = System.currentTimeMillis();
        long endTime = startTime + (durationOfRun * 60 * 1000L);

        // Running it for 60 minutes
        while (System.currentTimeMillis() <= endTime) {
            service.submit(new ThreadNewTask(idPool));
        }

        // wait for termination
        service.shutdown();
        service.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-07T14:37:21.193

另一种解决方案是破解底层队列以替换`offer`为`offer`大超时（最长 292 年，可以认为是无限的）。

```
 // helper method
private static boolean interruptibleInfiniteOffer(BlockingQueue<Runnable> q, Runnable r) {
    try {
        return q.offer(r, Long.MAX_VALUE, TimeUnit.NANOSECONDS); // infinite == ~292 years
    } catch (InterruptedException e) {
        return false;
    }
}

// fixed size pool with blocking (instead of rejecting) if bounded queue is full
public static ThreadPoolExecutor getFixedSizePoolWithLimitedWaitingQueue(int nThreads, int maxItemsInTheQueue) {
    BlockingQueue<Runnable> queue = maxItemsInTheQueue == 0
            ? new SynchronousQueue<>() { public boolean offer(Runnable r) { return interruptibleInfiniteOffer(this, r);} }
            : new ArrayBlockingQueue<>(maxItemsInTheQueue) { public boolean offer(Runnable r) { return interruptibleInfiniteOffer(this, r);} };
    return new ThreadPoolExecutor(nThreads, nThreads, 0, TimeUnit.MILLISECONDS, queue);
} 
```

# performance - 追问【Segmenting Redis By Database】

> ID：10770350
> 
> 赞同：1
> 
> 时间：2012-05-26T22:48:34.777
> 
> 标签：performance, redis, key, time-complexity

这是一个后续问题[Segmenting Redis By Database](https://stackoverflow.com/questions/10760786/segmenting-redis-by-database)。我最初询问了一个redis实例中不同数据库中redis**键操作的时间复杂度。**我问的原因是因为我正在尝试实现一个缓存，其中有***x 个***多段键，每个键可能有***y***个实际数据实例，导致***xy***个总键。

但是，我想支持主键的通配符搜索，似乎在 redis 中唯一实现的键通配符查询是*keys*命令，不鼓励使用。***在我看来，将x***键放在单独的数据库中似乎是一个不错的折衷方案，其中较少数量的键将使**键**操作令人满意地执行。

任何人都可以提出更好的选择吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T07:58:38.303

我仍然认为使用 KEYS 确实无法通过 Redis 进行扩展，无论您可以采用何种巧妙的方案来解决线性复杂性问题。

分区就是其中一种方案，在传统的RDBMS中常用来降低对平面表的表扫描成本。你的想法其实是这个概念对 Redis 的改编。

但与提供此功能的传统 RDBMS（Oracle、MySQL...）相比，有一个重要的区别：Redis 是一个单线程事件循环。因此，扫描不能与任何其他活动同时进行（例如服务其他客户端连接）。Redis 扫描数据时，所有连接都会被阻塞。

您必须设置大量分区（即数据库）才能获得良好的性能。类似于全局键数的 1/1000 或 1/10000。这就是它不可扩展的原因：Redis 并不是为处理如此多的数据库而设计的。您可能会遇到在所有数据库上迭代的内部机制的问题。这是从源代码中提取的列表：

*   自动重新散列
*   物品过期管理
*   数据库状态记录（每 5 秒）
*   信息命令
*   最大内存管理

您可能必须限制数据库的数量，这也限制了可伸缩性。如果您设置 1000 个数据库，那么对于 100 万个项目将可以正常工作，对于 100 万个项目会更慢，而对于 100 万个项目则无法使用。

如果您仍想坚持使用线性扫描来实现此功能，那么其​​他支持并发扫描的商店（如 MySQL、MongoDB 等）将为您提供更好的服务。对于其他商店，关键是要以有效的方式实施商品过期。

如果你真的要使用 Redis，你可以很容易地对数据进行分段，而不需要依赖多个数据库。例如，您可以使用我在[此处](https://stackoverflow.com/questions/9127736/redis-sorted-sets-and-best-way-to-store-uids/9195219#9195219)描述的方法。使用这种策略，键列表以增量方式检索，搜索实际上是在客户端完成的。主要的好处是你可以拥有大量的分区，这样 Redis 就不会阻塞。

现在，AFAIK 没有存储引擎提供使用任意正则表达式有效搜索数据的能力（即避免线性扫描）。但是，此功能由某些搜索引擎提供，通常使用 n-gram 索引。

这是来自 Russ Cox 的一篇很好的文章：http: [//swtch.com/~rsc/regexp/regexp4.html](http://swtch.com/~rsc/regexp/regexp4.html)

这种索引机制可能适用于 Redis（您将使用 Redis 存储键的三元组索引），但它需要编写大量代码。

您还可以想象将正则表达式限制为前缀搜索。例如 U:SMITH:(.*) 实际上是一个带有前缀 U:SMITH 的搜索：

在这种情况下，您可以使用 zset 索引您的键，并在检索到您感兴趣的键范围后在客户端执行线性搜索。zset 中项目的分数是根据客户端的键计算的，因此分数顺序与键的字典顺序相对应。

使用这样的 zset，可以通过 zscore 和 zrange 命令的组合检索必须逐块扫描的键范围。其后果是扫描的键数量受到限制（受前缀），搜索发生在客户端，并且对 Redis 并发模型很友好。缺点是复杂性（尤其是处理项目过期）和网络带宽消耗。

# ios - UITableViewCell 文本颜色在选择行时发生变化，为什么？

> ID：10770352
> 
> 赞同：0
> 
> 时间：2012-05-26T22:49:55.220
> 
> 标签：ios, ios5, uitableview, ios4

我已经将 UITableView 与默认 UITableViewCell 一起使用。

这里我在 cellForRowAtIndexPath 方法中给出了深灰色，还将一个 imageView 设置为 selectedBackgroundView。

所以现在当我选择该行时，会显示特定的选定图像，但我的 textColor 会从深灰色变为白色。

为什么这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T23:02:40.903

The `UILabel` is getting highlighted together with it's master view. Change it's `highlightedTextColor`, the default is white for you. For example

```
 cell.textLabel.highlightedTextColor = [UIColor blackColor]; 
```

# markdown - 如何将带有图像的 reStructuredText 文件转换为 markdown？

> ID：10770353
> 
> 赞同：15
> 
> 时间：2012-05-26T22:50:00.717
> 
> 标签：markdown, restructuredtext, pandoc

我有包含以下行的第一个文件

```
.. figure:: examples/foo.png 
    :scale: 80%

    Fig. 1 : Illustration of the awesomeness of stackoverflow 
```

现在我希望将此文件转换为降价。我尝试使用`pandoc`，

```
pandoc -s -w rst --toc foo.rst -o foo.md 
```

但输出文件`foo.md`似乎忽略了图形包含行。那么，我怎样才能在不丢失数字的真棒的情况下转换成 Markdown 文件呢？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T23:25:58.500

[Pandoc的这个](http://johnmacfarlane.net/pandoc/try)在线演示转换了以下markdown：

```
![Map to buried treasure](/path/to/img.jpg "Optional title") 
```

进入以下 reStructuredText：

```
.. figure:: /path/to/img.jpg
   :align: center
   :alt: Optional title

   Map to buried treasure 
```

所以这应该是你如何定义一个可以转换为markdown的图形。但是，在在线转换器中使用此 reStructuredText 会导致错误，并显示非常无用的错误消息。运行 Pandoc 时是否收到任何错误消息？

也许您的 reStructuredText 语法不正确：图形（和任何其他）指令的选项应该相对于指令名称缩进。尝试使用

```
.. figure:: examples/foo.png 
   :scale: 80%

   Fig. 1 : Illustration of the awesomeness of stackoverflow 
```

看看这是否有所作为。

# ruby-on-rails - 在 rails 中正确显示 @obj#{count}

> ID：10770355
> 
> 赞同：0
> 
> 时间：2012-05-26T22:51:05.743
> 
> 标签：ruby-on-rails, ruby

我如何才能`<%= "@obj#{count}" %>`在 DOM 中实际显示变量值而不是 @obj0、@obj1 等

我有需要显示的变量@obj0、@obj1、@obj2 等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T23:04:24.597

A couple of ways.

First, the most correct (IMHO) is to put all your vars to an array and index that.

```
 arr = [@obj0, @obj1, @obj2]

 <%= arr[count] %> 
```

Another option is to use `eval`. Avoid this (unless you **really** know what you're doing).

```
<%= eval("obj#{count}") %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T22:53:38.660

我不太确定你想要什么，但我想你想要

```
<%= @obj.count %> 
```

# html - jQuery 1.7+ 中等效的 jQuery livequery 插件

> ID：10770359
> 
> 赞同：6
> 
> 时间：2012-05-26T22:51:33.200
> 
> 标签：html, jquery, jquery-events, livequery

是否有 jQuery 1.7+ 的 jQuery livequery 插件的等价物？

我正在尝试动态绑定事件，读取 DOM 元素应基于 data-* 元素绑定的事件。

```
<a href="#" class="js-test" data-events="click">Test 1</a>
<a href="#" class="js-test" data-events="mouseover">Test 2</a>
 .. etc .. 
```

我想将所有元素与类绑定，`.js-test`但仅限于其`data-events`属性中列出的事件。

jQuery.on/live/bind/delegate 都要求将事件作为参数传入。

这适用于页面上存在的 DOM 元素 when `document.ready`，但是当我更新 DOM（AJAX、JS 等）时，我希望任何具有类`.js-test`的新元素也能够绑定其事件。

livequery 插件（它是旧的，从 jQuery 1.3 时代开始）似乎允许这样做，因为它简单地需要一个选择器和一个函数来针对与选择器匹配的任何东西运行。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-26T23:27:50.750

从[jQuery 1.7 开始，`on`方法](http://api.jquery.com/on/)取代了 live 方法。虽然它没有像您描述的那样传递或匹配选择器的简单方法，但可以通过传入动态值`data-events`代替事件类型来完成此操作，只要数据事件值与该事件匹配.

然而，由于传递给 on 方法的事件参数的参数——第一个参数——是从每个 data-events 属性中获取的，从匹配元素集中的每个元素中，我们必须遍历匹配元素的集合，以便我们分别访问每个元素的单独 data-events 属性值：

```
$('.js-test').each(function() { 
    $(this).on( $(this).attr("data-events"), function() {

        // event pulled from data-events attribute           
        alert("hello - this event was triggered by the " + $(this).attr("data-events") + " action.");

    });
}); 
```

> 我希望所有事件都映射到同一个函数，但有不同的事件触发对不同 DOM 元素的函数调用。

由于您希望将所有事件映射到单个函数，因此此解决方案可以满足您的特定要求并解决您的问题。

但是，如果您的需求发生变化并且您发现需要映射一组函数事件以匹配每种事件类型，这应该可以帮助您开始：

```
var eventFnArray = [];
eventFnArray["click"] = function() { 
    alert("click event fired - do xyz here");
    // do xyz
};
eventFnArray["mouseover"] = function() { 
    alert("mouseover fired - do abc here"); 
    // do abc
};

$('.js-test').each( (function(fn) { 

   return function() {   
     $(this).on( $(this).attr("data-events"), function() {

        alert("hello - this is the " + $(this).attr("data-events") + " event");

        // delegate to the correct event handler based on the event type
        fn[ $(this).attr("data-events") ]();

     });
   }
})(eventFnArray)); // pass function array into closure 
```

## **更新：**

这已经过测试，并且确实适用于添加到 div#container 的新元素。问题在于`on`方法的运作方式。The delegating nature of `on`only works if the parent element is included in the selector, and only if a selector is passed into the second parameter, which filters the target elements by data-events attribute:

**HTML：**

```
<div id="container">
    <a href="#" class="js-test" data-events="click">Test 1</a>
    <a href="#" class="js-test" data-events="mouseover">Test 2</a>
</div> 
```

**JavaScript：**

```
$(document).ready(function() {
  $('.js-test').each(function() { 
      var _that = this;
      alert($(_that).attr("data-events"));

      $(this).parent().on(
          $(_that).attr("data-events"), 
              '.js-test[data-events="'+ $(_that).attr("data-events") +'"]', 
              function() {

                  // event pulled from data-events attribute           
                  alert("hello - this event was triggered by the " + $(_that).attr("data-events") + " action.");
              }
          );
      }
  ); 
}); 
```

此外，使用以下 jQuery 将项目添加到容器以对其进行测试：

```
$('#container')
    .append("<a href='#' class='js-test' data-events='mouseover'>Test 3</a>"); 
```

**试试看：**

**这是一个演示测试和工作功能的[jsfiddle](http://jsfiddle.net/SYMnA/)。**

# android - 尝试接收启动完成或屏幕关闭时，Android 广播接收器不工作

> ID：10770361
> 
> 赞同：0
> 
> 时间：2012-05-26T22:51:57.847
> 
> 标签：android, android-intent, broadcastreceiver, intentfilter

所以我正在尝试开发自定义锁屏

但我的广播接收器不会开火

我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="org.alexander.fuchs.lockscreen"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".app"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <receiver 
            android:name=".myreceiver">
            <intent-filter>
                <action android:name="android.intent.action.SCREEN_OFF"/>
                <action android:name="android.intent.action.SCREEN_ON"/>
                <action android:name="android.intent.action.BOOT_COMPLETED"/>
            </intent-filter>
        </receiver>
    </application>

</manifest> 
```

我的接收器：

```
public class myreceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.d("receiver","works");
        Toast.makeText(context,"works",Toast.LENGTH_LONG).show();
        Intent in=new Intent(context,app.class);
         context.startActivity(in);
    }
} 
```

接收器应该告诉我它被解雇了：D但logcat中没有任何日志

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T23:43:14.140

好吧，对于屏幕关闭和屏幕打开，这不能在清单中，而只能在运行时。看到这个： [http ://thinkandroid.wordpress.com/2010/01/24/handling-screen-off-and-screen-on-intents/](http://thinkandroid.wordpress.com/2010/01/24/handling-screen-off-and-screen-on-intents/)

对于启动，它必须在清单中，所以它有其他问题。检查类的路径。这肯定是问题的原因。

# python - 如何使用 SQLAlchemy 在 MySQL 中创建数据库？

> ID：10770377
> 
> 赞同：44
> 
> 时间：2012-05-26T22:56:47.797
> 
> 标签：python, mysql, sqlalchemy

我需要使用 SQLAlchemy 在 MySQL 中创建一个数据库，如果它已经存在，我可以连接到它，但如果它不存在，我希望能够创建它。这些是我的表：

```
 #def __init__(self):
Base = declarative_base()

class utente(Base):
    __tablename__="utente"
    utente_id=Column(Integer,primary_key=True)
    nome_utente=Column(Unicode(20))
    ruolo=Column(String(10))
    MetaData.create_all()

    def __repr(self):
        return "utente: {0}, {1}, id: {2}".format(self.ruolo,self.nome_utente,self.utente_id)

class dbmmas(Base):

    __tablename__="dbmmas"
    db_id=Column(Integer,primary_key=True,autoincrement=True)
    nome_db=Column(String(10))
    censimento=Column(Integer)
    versione=Column(Integer)
    ins_data=Column(DateTime)
    mod_data=Column(DateTime)
    ins_utente=Column(Integer)
    mod_utente=Column(Integer)
    MetaData.create_all()

    def __repr(self):
        return "dbmmas: {0}, censimento {1}, versione {2}".format(self.nome_db,self.censimento,self.versione)    

class funzione(Base):
    __tablename__="funzione"
    funzione_id=Column(Integer,primary_key=True,autoincrement=True)
    categoria=Column(String(10))
    nome=Column(String(20))
    def __repr__(self):
        return "funzione:{0},categoria:{1},id:{2} ".format(self.nome,self.categoria,self.funzione_id)

class profilo(Base):
    __tablename__="rel_utente_funzione" 
    utente_id=Column(Integer,primary_key=True)
    funzione_id=Column(Integer,primary_key=True)
    amministratore=Column(Integer)
    MetaData.create_all()

    def __repr(self):
        l=lambda x: "amministratore" if x==1 else "generico"
        return "profilo per utente_id:{0}, tipo: {1}, funzione_id: {2}".format(self.utente_id,l(self.amministratore),self.funzione_id)    

class aree(Base):
    __tablename__="rel_utente_zona"
    UTB_id=Column(String(10), primary_key=True) # "in realta' si tratta della seatureSignature della feature sullo shapefile"
    utente_id=Column(Integer, primary_key=True)
    amministratore=Column(Integer)
    MetaData.create_all()
    def __repr(self):
        l=lambda x: "amministratore" if x==1 else "generico"
        return "zona: {0}, pe utente_id:{1}, {2}".format(self.UTB_id,self.utente_id,l(self.amministratore))

class rel_utente_dbmmas(Base):
    __tablename__="rel_utente_dbmmas"
    utente_id=Column(Integer,primary_key=True)
    db_id=Column(Integer,primary_key=True)
    amministratore=(Integer)
    MetaData.create_all()
    def __repr(self):
        l=lambda x: "amministratore" if x==1 else "generico"
        return "dbregistrato: {0} per l'utente{1} {2}".format(self.db_id,self.utente_id,l(self.amministratore)) 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-05-26T23:28:03.513

要创建`mysql`数据库，您只需连接到服务器并创建数据库：

```
import sqlalchemy
engine = sqlalchemy.create_engine('mysql://user:password@server') # connect to server
engine.execute("CREATE DATABASE dbname") #create db
engine.execute("USE dbname") # select new db
# use the new db
# continue with your work... 
```

当然，您的用户必须具有创建数据库的权限。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2018-07-05T05:51:50.813

您可以为此使用[SQLAlchemy-Utils](http://sqlalchemy-utils.readthedocs.io/en/latest/index.html)。

`pip install sqlalchemy-utils`

然后你可以做类似的事情

```
from sqlalchemy_utils import create_database, database_exists
url = 'mysql://{0}:{1}@{2}:{3}'.format(user, pass, host, port)
if not database_exists(url):
    create_database(url) 
```

[我在这里](https://stackoverflow.com/a/30971098/3846716)找到了答案，它对我帮助很大。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-02-25T01:30:23.300

我不知道规范的方法是什么，但这里有一种方法可以通过检查数据库列表来检查数据库是否存在，如果不存在则创建它。

```
from sqlalchemy import create_engine

# This engine just used to query for list of databases
mysql_engine = create_engine('mysql://{0}:{1}@{2}:{3}'.format(user, pass, host, port))

# Query for existing databases
existing_databases = mysql_engine.execute("SHOW DATABASES;")
# Results are a list of single item tuples, so unpack each tuple
existing_databases = [d[0] for d in existing_databases]

# Create database if not exists
if database not in existing_databases:
    mysql_engine.execute("CREATE DATABASE {0}".format(database))
    print("Created database {0}".format(database))

# Go ahead and use this engine
db_engine = create_engine('mysql://{0}:{1}@{2}:{3}/{4}'.format(user, pass, host, port, db)) 
```

如果您不需要知道数据库是否已创建，这是另一种方法。

```
from sqlalchemy import create_engine

# This engine just used to query for list of databases
mysql_engine = create_engine('mysql://{0}:{1}@{2}:{3}'.format(user, pass, host, port))

# Query for existing databases
mysql_engine.execute("CREATE DATABASE IF NOT EXISTS {0} ".format(database))

# Go ahead and use this engine
db_engine = create_engine('mysql://{0}:{1}@{2}:{3}/{4}'.format(user, pass, host, port, db)) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-09-07T07:23:50.363

```
CREATE DATABASE IF NOT EXISTS dbName; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-02-25T02:51:20.517

建议使用`with`：

```
from sqlalchemy import create_engine

username = ''
password = ''
host = 'localhost'
port = 3306
DB_NAME = 'db_name'

engine = create_engine(f"mysql://{username}:{password}@{host}:{port}")

with engine.connect() as conn:
    # Do not substitute user-supplied database names here.
    conn.execute(f"CREATE DATABASE IF NOT EXISTS {DB_NAME}") 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2022-01-07T16:57:38.983

**mysqlclient**在基准测试中似乎比**PyMySQL**快 10 倍，请参阅：[MySQLdb、mysqlclient 和 MySQL 连接器/Python 之间有什么区别？](https://stackoverflow.com/a/46396881/11154841).

然而，为什么不为 Python 使用 Python-ready 包，至少，如果不是每秒查询时间呢？**以下链接建议使用PyMySQL**，例如：

*   [使用 SQLAlchemy 访问 MySQL 而不会遇到令人沮丧的库安装问题](https://blog.rtwilson.com/using-sqlalchemy-to-access-mysql-without-frustrating-library-installation-issues/)
*   [如何使用 Python+SQLAlchemy 远程连接 MySQL 数据库？](https://stackoverflow.com/questions/29355674/how-to-connect-mysql-database-using-pythonsqlalchemy-remotely).

### Python 包：

使用 pip 安装，最好放在“requirements.txt”中：

*   PyMySQL
*   SQL炼金术

*同样，如果它是关于查询的最佳速度，请使用 mysqlclient 包。然后你需要安装一个额外的 Linux 包`sudo apt-get install libmysqlclient-dev`。*

### `import`陈述

只需要一个：

`import sqlalchemy`

### 连接字符串 (= db_url)

[以{dialect/DBAPI}](https://docs.sqlalchemy.org/en/14/dialects/mysql.html) +{driver}开头的连接字符串：

db_url =`mysql+pymysql://`

其中`pymysql`代表使用的 Python 包“PyMySQL”作为驱动程序。

*同样，如果它是关于查询的最佳速度，请使用 mysqlclient 包。那么此时你需要`mysql+msqldb://`。*

对于远程连接，您需要添加到连接字符串：

*   主持人
*   用户
*   密码
*   数据库
*   端口（仅当它不是标准 3306 时的端口）

您可以使用多种方法创建 db_url。不要直接在字符串中写入用户名和密码以及最多任何其他变量值，以避免可能的攻击：

*   [sqlalchemy.engine.URL.create()](https://docs.sqlalchemy.org/en/14/core/engines.html#sqlalchemy.engine.URL)或使用`.url.URL`，请参阅[从 Cloud Functions 连接到 Cloud SQL](https://cloud.google.com/sql/docs/mysql/connect-functions)中的示例或自动添加`?`后缀的示例，例如，在[为 mssql+pyodbc 构建连接 URL](https://stackoverflow.com/a/46101255/11154841)`?driver=SQL+Server`的字符串末尾[使用 sqlalchemy.engine.url.URL](https://stackoverflow.com/a/46101255/11154841)
*   `f"""...{my_var}..."""`
*   `"""...{my_var}...""".format(my_var=xyz_var)`
*   ...

没有 SQLAlchemy 的 url 助手的示例：

```
db_url = "{dialect}+{driver}://{user}:{password}@{host}:{port}/{database}".format( 
```

或者：

```
db_url = "{dialect}+{driver}://{user}:{password}@{host}/{database}?host={host}?port={port}".format(
         dialect = 'mysql',
         driver = 'pymysql',
         username=db_user,
         password=db_pass,
         database=db_name,
         host=db_host,
         port=db_port
     ) 
```

### 其他发动机配置

有关其他连接驱动程序、方言和方法，请参阅[SQLAlchemy 1.4 文档 - 引擎配置](https://docs.sqlalchemy.org/en/14/core/engines.html)

### 如果不存在则创建数据库

请参阅[如何使用 SQLAlchemy 创建新数据库？](https://stackoverflow.com/questions/6506578/how-to-create-a-new-database-using-sqlalchemy).

```
engine = sqlalchemy.create_engine(db_url)
if not sqlalchemy.database_exists(engine.url):
    create_database(engine.url)
with engine.connect() as conn:
    conn.execute("commit")
    conn.execute("create database test") 
```

# multithreading - 使用并行编程和 webrequest 请求建议

> ID：10770383
> 
> 赞同：0
> 
> 时间：2012-05-26T22:57:56.347
> 
> 标签：multithreading

目前，我的 Windows 窗体上的列表框中有大约 20 个网站，其中包含 url。

每个 url 将导航到网站下载图片并将图片放入 windows 窗体上的图片框

我已经为要输入的图片设置了 4 个图片框。

用户将看到动物的图片，然后输入图片并点击提交按钮，将结果发送回网站进行确认。

我的问题是，当我尝试实现线程池时，我没有足够的时间在下一张图片加载之前输入动物的名称。

我手动创建每个线程然后切换将图片提交到站点的按钮以销毁线程并获取下一个线程会更好吗？我很困惑。任何帮助都是极好的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T23:03:43.173

you can use workers to do your background stuff, and a setinterval hack to simulate threads.

start throwing events, and move up the thread ladder when the event signifying completion is thrown.

# javascript - 如果`if`语句匹配，如何将图像附加到表中？

> ID：10770385
> 
> 赞同：2
> 
> 时间：2012-05-26T22:58:04.960
> 
> 标签：javascript, jquery, html

我不知道这是否可能，但下面我有一个简单的 html 表：

```
<table id="plus" align="center">
  <tr>
    <th>
    </th>
  </tr>
</table> 
```

如果`if`语句匹配，那么是否可以将图像附加到`<th>`上面的标签内？如果语句不匹配，那么我可以在`<th>`标签内附加图像链接吗？

下面是`if`语句，它实际上是 jQuery，其中包含一些 php 来尝试查找“textQuestion”：

```
if (qnum == <?php echo (int)$_SESSION['textQuestion']; ?>) {
  <img src="Images/plussigndisabled.jpg" width="30" height="30" alt="Look Up Previous Question" class="plusimage" name="plusbuttonrow"/>
} else {
  <a onclick="return plusbutton();">
  <img src="Images/plussign.jpg" width="30" height="30" alt="Look Up Previous Question" class="plusimage" name="plusbuttonrow"/>
  </a>
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T23:07:22.773

既然你说你正在使用 jQuery，你可以这样做

```
....
    var enabledImage = "plussign.jpg";
    var disabledImage = "plussigndisabled.jpg";
    var selectedImage;
    var imageHtml;

    if(...) {
        selectedImage = enabledImage;
    } else {
        selectedImage = disabledImage;
    }  

    imageHtml = getImageHtml(selectedImage);
    $('#ElementID').append($(imageHtml));
....

function getImageHtml(imageFileName) {
    return '<img src="Images/' + imageFileName + '" width="30" height="30" alt="Look Up Previous Question" class="plusimage" name="plusbuttonrow"/>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:02:32.787

将唯一 ID 应用到 TH，如下所示：

```
<table id="plus" align="center">
  <tr>
    <th id="foo">
    </th>
  </tr>
</table> 
```

然后只需使用内部 HTML 属性。

```
var bar=document.getElementByID('foo');
bar.innerHtml="<img />"; 
```

（这假设 javascript 是响应用户输入运行的，即在页面完成加载之后）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T23:02:56.517

无论哪种方式，您都将附加某些内容，因此请确定*您*要附加的内容`if-statement`，然后附加它。无论哪种方式，它都在同一个地方。

```
$("#plus th").html(function(){
    return ( qnum === 5 )
        ? "<img />"
        : "<a><img /></a>" ;
}); 
```

此时，追加`data`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-26T23:10:05.670

**工作演示** [http://jsfiddle.net/26Jaf/](http://jsfiddle.net/26Jaf/)

好的 API：[http ://api.jquery.com/append/](http://api.jquery.com/append/)

**代码**

```
var qnum = 1;  
var append_data = "";
if (qnum == 1) { // i.e. if condition satisfy.

   append_data = '<img src="http://images.wikia.com/maditsmadfunny/images/5/54/Hulk-from-the-movie.jpg" width="30" height="30" alt="Look Up Previous Question" class="plusimage" name="plusbuttonrow"/>';

} else {
   //do something else

alert('d');
}
$("#plus tr th").append(append_data);
​ 
```

# c# - 现有索引的 While 循环

> ID：10770392
> 
> 赞同：-4
> 
> 时间：2012-05-26T22:59:47.267
> 
> 标签：c#, while-loop, indexof

我怎么能写一个说以下（伪代码）的while循环：

```
While the index of "blahblah" in string 1 exists

do this 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T23:01:42.677

```
while(string1.Contains("blahblah")) {
    // do this
} 
```

成功编译为 C# 的伪代码。0 个错误，0 个警告。所用时间：0:00:01.860。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:06:10.773

```
 var string1 = "blahblah blahblah blahblah blahblah ";
  int pos = -1;
  while (0 >= (pos = string1.IndexOf("blahblah", pos + 1)))
  {
     // do this.
  } 
```

# demoscene - 创建演示场景的教程

> ID：10770393
> 
> 赞同：19
> 
> 时间：2012-05-26T23:00:00.653
> 
> 标签：demoscene

## 语境：

*   观看：[http ://www.youtube.com/watch?v=AWcbj7ksqwE](http://www.youtube.com/watch?v=AWcbj7ksqwE)
*   我熟悉 OpenGL / GLSL / C++ / C
*   我做了一些音频编程。

    暂时不要介意将其压缩到 64k 或 4k。

    我什至不知道如何在程序上合成类似上述演示的东西。

## 问题：

我意识到演示场景有点像地下魔法。但是，是否有任何关于创建其中之一的好的教程/演练？就像是：

“了解 OpenGL / GLSL / C++ / C 的傻瓜演示场景”

我也意识到有一些工具包旨在压缩代码——但对我来说压缩目前并不重要。我很乐意学习如何创建这样的东西。

## 简洁的问题：

任何人都可以建议一个关于逐步创建演示场景的好教程/演练，以便具有足够技术背景的人了解各个步骤（但无法看到整个画面）。

谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-29T03:01:06.573

Here's a link to a pdf written by the programmer behind the technical magic. It's a really great read.

[http://www.iquilezles.org/www/material/function2009/function2009.pdf](http://www.iquilezles.org/www/material/function2009/function2009.pdf)

His site itself is a treasure trove of information regarding demoscene programming techniques.

I wrote a 4k demo which won 1st place at an Australian demoscene party (Syntax)... [http://www.youtube.com/watch?v=t7anicyRI3w](http://www.youtube.com/watch?v=t7anicyRI3w)

# php - 只显示最后一个结果

> ID：10770395
> 
> 赞同：0
> 
> 时间：2012-05-26T23:00:03.520
> 
> 标签：php, regex, foreach

我正在寻找在多个网站上搜索单个数据。数据已正确提取，但仅显示最后一个搜索案例。单个搜索工作正常。

例如，我做了三个搜索，只显示第三个结果——其余的都是空白的。

任何人都可以解释一下吗？

```
if($_POST)
{

$domains = explode("\n", $_POST[domains]);
foreach($domains as $domain)
{
$domain = explode('|', $domain);
$domain = str_replace(array('http://','/'),'',$domain[0]);

echo '<b>Providing Data for '. $domain .'.. </br></br>';

unset($urls);
unset($url);
unset($blacklinka[1]);
unset($blacklinka);
unset($AskApache_result);
unset($regex);

$domainshort = str_replace('www.','',$domain);

$domainshortdash = str_replace('.','-',$domainshort);

$urls[] = 'http://data.alexa.com/data?cli=10&dat=snbamz&url=' . $domain;

$ch = curl_init();

    foreach($urls as $url)
{

curl_setopt ($ch, CURLOPT_URL, $url);
    curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;     rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6");
    curl_setopt ($ch, CURLOPT_TIMEOUT, 60);
    curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1);
    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt ($ch, CURLOPT_REFERER, 'http://www.google.com/');
    $AskApache_result = curl_exec ($ch);

$regex = '/LINKSIN NUM="(.+?)"/';
preg_match($regex,$AskApache_result,$blacklinka);
echo '</br>';
echo 'Indexed Backlinks: '. $blacklinka[1];

    echo '</br></br>';

    flush();
    ob_flush();
}

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T12:16:31.363

I've tried your code and it works just fine for me. So I have a few ideas as to why it doesn't work for you.

*   Since the `foreach($domains as $domain)` loop does `unset($urls)`, if the loop using `$urls` is actually located outside the foreach, then it will only contain the last one.
*   You explode `$domains` on `\n` and then `$domain` on `|` which may suggest you have an odd input format, and it may not quite work as you had intended, so looking at `$domains` and `$domain` in your loop might shed some light into what you actually get from your input.

As far as I can tell the curl and preg_match works properly. So either you aren't doing all the curl calls (due to the unset) or your inputted list of domains doesn't get interpreted as you expected.

# asp.net-mvc-3 - 单元测试使用 NHibernate 的 MVC 控制器，有和没有实现存储库模式

> ID：10770399
> 
> 赞同：2
> 
> 时间：2012-05-26T23:02:07.500
> 
> 标签：asp.net-mvc-3, unit-testing, nhibernate, mocking, repository-pattern

我有一个将 NHibernate 用于 ORM 的 MVC 应用程序。每个控制器都采用一个 ISession 构造参数，然后使用该参数对域模型对象执行 CRUD 操作。例如，

```
public class HomeController : Controller
{
    public HomeController(ISession session)
    {
        _session = session;
    }
    public ViewResult Index(DateTime minDate, DateTime maxDate)
    {
        var surveys = _session.CreateCriteria<Survey>()
                              .Add( Expression.Like("Name", "Sm%") )
                              .Add( Expression.Between("EntryDate", minDate, maxDate) )
                              .AddOrder( Order.Desc("EntryDate") )
                              .SetMaxResults(10)
                              .List<Survey>();

        // other logic that I want to unit test that does operations on the surveys variable
        return View(someObject);
    }
    private ISession _session;
} 
```

我想通过使用 Moq 或 RhinoMocks 模拟 ISession 对象来单独对该控制器进行单元测试，而无需实际访问数据库。但是，在单元测试中模拟 ISession 接口将非常困难，因为它是通过一个流畅的接口使用的，该接口将许多调用链接在一起。

一种替代方法是通过存储库模式包装 ISession 使用。我可以写一个像这样的包装类：

```
public interface IRepository
{
   List<Survey> SearchSurveyByDate(DateTime minDate, DateTime maxDate);
}

public class SurveyRepository : IRepository
{
    public SurveyRepository(ISession session)
    {    
        _session = session;
    }
    public List<Survey> SearchSurveyByDate(DateTime minDate, DateTime maxDate)
    {
        return _session.CreateCriteria<Survey>()
                          .Add( Expression.Like("Name", "Sm%") )
                          .Add( Expression.Between("EntryDate", minDate, maxDate) )
                          .AddOrder( Order.Desc("EntryDate") )
                          .SetMaxResults(10)
                          .List<Survey>();
    }
    private ISession _session;
} 
```

然后我可以重写我的控制器以采用 IRepository 构造函数参数，而不是 ISession 参数：

```
public class HomeController : Controller
{
    public HomeController(IRepository repository)
    {
        _repository = repository;
    }

    public ViewResult Index(DateTime minDate, DateTime maxDate)
    {
        var surveys = _repository.SearchSurveyByDate(minDate, maxDate);
         // other logic that I want to unit test that does operations on the surveys variable
        return View(someObject);
    }
    private IRepository _repository;
} 
```

第二种方法更容易进行单元测试，因为 IRepository 接口比 ISession 接口更容易模拟，因为它只是一个方法调用。但是，我真的不想走这条路，因为：

1）创建一个全新的抽象层和更多的复杂性只是为了使单元测试更容易，这似乎是一个非常糟糕的主意，并且

2) 有很多评论反对在 nHibernate 中使用存储库模式的想法，因为 ISession 接口已经是一个类似于存储库的接口。[（特别是在这里](http://ayende.com/blog/3955/repository-is-the-new-singleton)和[这里](http://ayende.com/blog/4784/architecting-in-the-pit-of-doom-the-evils-of-the-repository-abstraction-layer)查看 Ayende 的帖子）我倾向于同意这个评论。

所以我的问题是，有什么方法可以通过模拟 ISession 对象来对我的初始实现进行单元测试？如果不是，我唯一的办法是使用存储库模式包装 ISession 查询，还是有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T05:12:55.463

奥伦经常四处游荡。他曾经是 Repositories 和 Unit of Work 的大力支持者。他可能会再次转向它，但有不同的要求。

Repository 有一些非常具体的优势，Oren 的评论都没有找到解决方案。此外，他的建议有它自己的一系列限制和问题。有时我觉得他只是在用一组问题交换另一组问题。当您需要提供相同数据的不同视图（例如 Web 服务或桌面应用程序）同时仍保留 Web 应用程序时，它也很好。

话虽如此，他有很多优点。我只是不确定他们是否有好的解决方案。

存储库对于高度测试驱动的场景仍然非常有用。如果您不知道您是否会坚持使用给定的 ORM 或持久层并且可能希望将其换成另一个，它仍然很有用。

Oren 的解决方案倾向于将 nHimbernate 更紧密地耦合到应用程序中。在许多情况下这可能不是问题，但在其他情况下可能是。

他创建专用查询类的方法很有趣，并且是[CQRS](http://martinfowler.com/bliki/CQRS.html)的第一步，这可能是一个更好的整体解决方案。但是软件开发仍然是艺术或工艺，而不是科学。我们还在学习。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T23:46:30.080

您是否考虑过让您的测试从使用 SQLite 的基本夹具继承，而不是模拟 ISession？

```
public class FixtureBase
{
    protected ISession Session { get; private set; }
    private static ISessionFactory _sessionFactory { get; set; }
    private static Configuration _configuration { get; set; }

    [SetUp]
    public void SetUp()
    {
        Session = SessionFactory.OpenSession();
        BuildSchema(Session);
    }

    private static ISessionFactory SessionFactory
    {
        get
        {
           if (_sessionFactory == null)
           {
                var cfg = Fluently.Configure()
                    .Database(FluentNHibernate.Cfg.Db.SQLiteConfiguration.Standard.ShowSql().InMemory())
                    .Mappings(configuration => configuration.FluentMappings.AddFromAssemblyOf<Residential>())
                    .ExposeConfiguration(c => _configuration = c);

                _sessionFactory = cfg.BuildSessionFactory();
           }

            return _sessionFactory;
        }
    }

    private static void BuildSchema(ISession session)
    {
        var export = new SchemaExport(_configuration);
        export.Execute(true, true, false, session.Connection, null);
    }

    [TearDown]
    public void TearDownContext()
    {
        Session.Close();
        Session.Dispose();
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T08:51:12.963

使用命名查询方法引入存储库不会增加系统的复杂性。实际上，它降低了复杂性并使您的代码更易于理解和维护。对比原版：

```
public ViewResult Index(DateTime minDate, DateTime maxDate)
{
    var surveys = _session.CreateCriteria<Survey>()
                          .Add(Expression.Like("Name", "Sm%"))
                          .Add(Expression.Between("EntryDate", minDate, maxDate))
                          .AddOrder(Order.Desc("EntryDate"))
                          .SetMaxResults(10)
                          .List<Survey>();

     // other logic which operates on the surveys variable
     return View(someObject);
} 
```

坦率地说，在我了解您方法的实际逻辑之前，我所有的内存插槽都已经被占用了。读者需要时间来了解您正在构建哪些标准、您传递了哪些参数以及返回了哪些值。而且我需要在代码行之间切换上下文。我开始考虑数据访问和 Hibernate，然后突然回到业务逻辑级别。如果您有多个地方需要按日期搜索调查怎么办？复制所有这些员工？

现在我正在阅读带有存储库的版本：

```
public ViewResult Index(DateTime minDate, DateTime maxDate)
{
    var surveys = _repository.SearchSurveyByDate(minDate, maxDate);
    // other logic which operates on the surveys variable
    return View(someObject);
} 
```

我需要零努力才能理解这里发生的事情。此方法具有单一职责和单一抽象级别。所有数据访问相关的逻辑都消失了。查询逻辑不会在不同的地方重复。其实我不在乎它是如何实现的。如果这种方法的主要目标是，我应该关心`some other logic`吗？

而且，当然，您可以毫不费力地为您的业务逻辑编写单元测试（如果您使用 TDD 存储库，您可以在实际编写数据访问逻辑之前测试您的控制器，当您开始编写存储库实现时，您将已经设计了存储库接口）：

```
[Test]
public void ShouldDoOtherLogic()
{
    // Arrange
    Mock<ISurveryRepository> repository = new Mock<ISurveryRepository>();
    repository.Setup(r => r.SearchSurveyByDate(minDate, maxDate))
              .Returns(surveys);

    // Act
    HomeController controller = new HomeController(repository.Object);
    ViewResult result = controller.Index(minDate, maxDate);

    // Assert
} 
```

顺便说一句，内存数据库的使用对于验收测试很有用，但对于单元测试，我认为它有点过头了。

还可以查看 NHibernate 3.0 中的[NHibernate Lambda Extensions](http://code.google.com/p/nhlambdaextensions/)或 QueryOver，它们使用表达式而不是字符串来构建标准。如果您重命名某个字段，您的数据访问代码不会中断。

并查看[Range](https://stackoverflow.com/a/4781727/470005)以传递成对的最小值/最大值。

# email - 如何在部门代理后面使用 node.js Context.IO？

> ID：10770401
> 
> 赞同：2
> 
> 时间：2012-05-26T23:02:40.507
> 
> 标签：email, node.js, rest, proxy, socks

这是我的 node.js 代码，它以 RESTful 方式而不是 IMAP 使用 Context.IO。

```
var ContextIO = require('contextio');
var ctxioClient = new ContextIO.Client({
  key: 'MY_KEY',
  secret: 'MY SECRET'
});
ctxioClient.accounts().get(function(err, res) {
  if (err) throw err;
  console.log(res);
}); 
```

当我在宿舍电脑上执行上述代码时，一切正常。但是，当我在部门代理后面的办公室计算机上执行代码时，代码只是超时了。我的部门同时提供用于 Internet 访问的 http 和 socks 代理。问题是如何在 node.js 中设置它？

顺便说一句，我也试过

```
socksify node code.js 
```

它没有超时。相反，它只是没有回应。

# android - Incorrect image size when debugging program on physical device

> ID：10770409
> 
> 赞同：0
> 
> 时间：2012-05-26T23:03:22.583
> 
> 标签：android, image, user-interface, resolution, image-size

I'm new to android and am having a problem with the UI. Specifically, I have placed an image on the screen with dimensions 767x441\. The resolution of the tablet I'm using is 800x480\. When I view the image in the WYSIWYG editor it looks correct but when I view it on the physical device it is only about half the size!

I've attached two screen shots to show what I am talking about.

My layout config is: sw480dp, w800dp, h480dp, Normal Screen, Short screen aspect ratio, Landscape Orientation, Medium Density

My resource files are in the drawable-mdpi directory and I have the manifest targetSDK set to 11\. I've been trying a lot of things but don't know what I'm missing.

Thanks.

![WYSIWYG](../Images/810eed8acc2d1f078968125c665c7687.png)

![Physical Device](../Images/57008440dd15bb52316a8bc4e92d1e5c.png)

# c++ - 不通过引用传递简单类型的原因？

> ID：10770410
> 
> 赞同：8
> 
> 时间：2012-05-26T23:03:23.227
> 
> 标签：c++, performance

据我了解，您不应该在 c++ 中通过引用传递简单类型，因为它不会提高性能，甚至对性能不利（？）。至少那是我设法从网上收集到的。

但是我找不到它对性能不利的**原因**，是因为 c++ 创建一个新的简单类型比它查找变量要快还是它是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-26T23:07:26.483

如果你创建一个引用，它是：

```
pointer to memory location -> memory location 
```

如果你使用一个值，它是：

```
memory location 
```

由于必须以任何一种方式（引用或值）复制值，因此通过引用传递不会提高性能；必须进行一次额外的查找。所以理论上它会“恶化”性能，但不会有任何你会注意到的程度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-27T02:08:31.900

这是一个很好的问题，而且你问它的事实表明你正在关注你的代码。然而，好消息是，在这种特殊情况下，有一个简单的出路。

Dave Abrahms 的这篇出色的文章回答了你所有的问题，然后回答了一些问题：[想要速度吗？按值传递。](http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)

老实说，总结它并没有做到链接公正，这是一个真正的必读。但是，长话短说，您的编译器足够聪明，可以正确执行，如果您尝试手动执行，您可能会阻止编译器进行某些优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T23:06:32.507

内部引用在指针处处理，每次访问它们时都需要取消引用。这显然需要额外的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-26T23:06:40.667

例如，在 32 位模式下，`int`大小为 4 字节，`int *`指针大小为 4 字节。直接传递 4 字节`int`比传递 4 字节指针然后`int`通过该指针加载更快。

# architecture - 共享一个维度的两个事实表的问题

> ID：10770414
> 
> 赞同：1
> 
> 时间：2012-05-26T23:04:29.807
> 
> 标签：architecture, ssas

我对连接到一个日期维度的两个事实表有疑问。这两个事实表具有不同日期的范围，但所有日期都存在于日期维度中。

当我尝试处理多维数据集时遇到问题，我收到一条错误消息，指出我的日期维度没有我知道维度中的日期的 FK。请参见下图：

![在此处输入图像描述](../Images/1cb11f095e864877b71d0be5ad77c0f4.png)

只有当我的两个事实表共享相同的日期范围时，我的多维数据集才会处理。如果任一多维数据集的任何日期不在另一个多维数据集中，则该过程将失败。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T06:42:40.250

我找到了导致多维数据集进程失败的罪魁祸首。有一个过滤器应用于 DSV 中的日期维度，我已经忘记了。删除了过滤器和立方体处理没有问题。

这是一个痛苦的提醒，要让故障排除变得简单。

# objective-c - Issue with UINotification in iOS / objective C

> ID：10770415
> 
> 赞同：0
> 
> 时间：2012-05-26T23:04:34.033
> 
> 标签：objective-c, ios, nsnotifications

I am making an app with different nav controllers. All of them are initially initialized.

Say, I have 3 nav controllers A, B and C.

A View controller from B (say B1) sends a notification that is supposed to be heard from view controller in A (say A1). After that, we go to view controller A1.

However, if we are in the view controller B1 from the beginning (and never went to View controller A1), then A1 doesnt get the notification. However, it gets it the second time.

OR, if I go inside A1 once, then the notifications are properly received.

Can anyone kindly help me out ? Thanks.

NB: the listeners code is in the init of A1\. It gets hit (i checked by using breakpoints).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T23:15:31.333

由于您说在视图显示一次后收到通知，因此我怀疑您正在以一种在显示视图之前不会运行的方法注册通知（`viewDidLoad`,`viewDidAppear:`等）。

如果是这种情况，请尝试将通知注册移动到`init`您在 ViewControllers 中使用的任何方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T16:57:08.750

NSNotification 可以通过所有应用程序观察到。因此，要执行您计划执行的操作，我会使用布尔标志或计数器。您可以将这些指标放在 appDelegate 类中或使用全局变量。

# apache-flex - Flex: Child Canvas on top of Shapes

> ID：10770416
> 
> 赞同：0
> 
> 时间：2012-05-26T23:04:41.603
> 
> 标签：apache-flex

I have a master canvas and am adding child Canvases. On my master canvas I have shapes added with baseCanvas.rawChildren.addChild(). But I want to draw canvases on top of the master canvas. These canvases can be moved around with the mouse. Whenever I move a child canvas over a shape, the shape bleeds through. It seems shapes rest on a layer above the child canvases. Anyway to have shapes not bleed through other child canvases?

# excel - SUMPRODUCT IF 是否有任何 Excel 内置函数？

> ID：10770418
> 
> 赞同：7
> 
> 时间：2012-05-26T23:04:54.177
> 
> 标签：excel

我有一张桌子（一张桌子），如下图所示。要找到总 $ 订单 1，我可以使用 SUMPRODUCT(Price,QTY1), SUMPRODUCT(Price,QTY2)，但是我想知道总 $ 订单但设计为 A、B、C。我真正喜欢保持表格结构的重要事项。

![在此处输入图像描述](../Images/c3ca3d447cf6abae6de85aba93877bd4.png)

有没有像 SUMPRODUCTIF 这样的函数。如果没有，有没有办法实现我想要实现的目标？

我可以制作另一列并使用 QTY*Price 来进行 SUMIF。但是，它添加了额外的列

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-26T23:13:58.957

```
=SUMPRODUCT(Price*QTY1*(Category="A")) 
```

应该做这项工作，类别是您的“产品类别”列的名称（包含字母“A”、“B”、“C”）。

# java - 多次调用 CountDownLatch.await(int) 超时

> ID：10770419
> 
> 赞同：6
> 
> 时间：2012-05-26T23:05:04.630
> 
> 标签：java, android, synchronization, countdownlatch

我使用 CountDownLatch 来等待来自另一个组件的某个事件（在不同的线程中运行）。以下方法适合我的软件的语义，但我不确定它是否按我的预期工作：

```
mCountDownLatch.await(3000, TimeUnit.MILLISECONDS)
otherComponent.aStaticVolatileVariable = true;
mCountDownLatch.await(3500, TimeUnit.MILLISECONDS);
... <proceed with other stuff> 
```

场景应该是这样的：我等待3秒，如果latch没有倒数到0，我用那个变量通知其他组件，然后我最多等待3.5秒。如果再次超时，那么我不在乎，将继续进行其他操作。

注意：我知道它看起来不像，但上面的场景在我的软件中是完全合理和有效的。

我确实阅读了 await(int,TimeUnit) 和 CountDownLatch 的文档，但我不是 Java/Android 专家，所以我需要确认。对我来说，所有场景看起来都有效：

*   如果第一个 await 成功，那么另一个 await 会立即返回
*   如果第一个 await 超时，那么另一个 await 仍然有效；因此，如果其他线程注意到静态信号，第二个等待可能会成功返回
*   两个等待调用都超时（根据我的软件语义这很好）

我使用 await(...) 正确吗？即使同一对象上的前一个 await(...) 超时，是否可以按上述方式使用第二个 await(...) ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T23:34:36.677

如果我正确理解了您的问题，则此测试证明您的所有假设/要求都是正确/满足的。（使用 JUnit 和 Hamcrest 运行。）请注意`runCodeUnderTest()`方法中的代码，尽管它穿插了时间记录，并且超时减少了 10 倍。

```
import org.junit.Before;
import org.junit.Test;

import java.util.concurrent.CountDownLatch;
import java.util.concurrent.TimeUnit;

import static org.hamcrest.Matchers.closeTo;
import static org.hamcrest.Matchers.lessThan;
import static org.junit.Assert.assertThat;

public class CountdownLatchTest {
    static volatile boolean signal;
    CountDownLatch latch = new CountDownLatch(1);
    long elapsedTime;
    long[] wakeupTimes = new long[2];

    @Before
    public void setUp() throws Exception {
        signal = false;
    }

    @Test
    public void successfulCountDownDuringFirstAwait() throws Exception {
        countDownAfter(150);
        runCodeUnderTest();
        assertThat((double) elapsedTime, closeTo(150, 10));
        assertThat(wakeupTimeSeparation(), lessThan(10));
    }

    @Test
    public void successfulCountDownDuringSecondAwait() throws Exception {
        countDownAfter(450);
        runCodeUnderTest();
        assertThat((double) elapsedTime, closeTo(450, 10));
        assertThat((double) wakeupTimeSeparation(), closeTo(150, 10));
    }

    @Test
    public void neverCountDown() throws Exception {
        runCodeUnderTest();
        assertThat((double) elapsedTime, closeTo(650, 10));
        assertThat((double) wakeupTimeSeparation(), closeTo(350, 10));
    }

    @Test
    public void countDownAfterSecondTimeout() throws Exception {
        countDownAfter(1000);
        runCodeUnderTest();
        assertThat((double) elapsedTime, closeTo(650, 10));
        assertThat((double) wakeupTimeSeparation(), closeTo(350, 10));
    }

    @Test
    public void successfulCountDownFromSignalField() throws Exception {
        countDownAfterSignal();
        runCodeUnderTest();
        assertThat((double) elapsedTime, closeTo(300, 10));
    }

    private int wakeupTimeSeparation() {
        return (int) (wakeupTimes[1] - wakeupTimes[0]);
    }

    private void runCodeUnderTest() throws InterruptedException {
        long start = System.currentTimeMillis();
        latch.await(300, TimeUnit.MILLISECONDS);
        wakeupTimes[0] = System.currentTimeMillis();
        signal = true;
        latch.await(350, TimeUnit.MILLISECONDS);
        wakeupTimes[1] = System.currentTimeMillis();
        elapsedTime = wakeupTimes[1] - start;
    }

    private void countDownAfter(final long millis) throws InterruptedException {
        new Thread(new Runnable() {
            @Override
            public void run() {
                sleep(millis);
                latch.countDown();
            }
        }).start();
    }

    private void countDownAfterSignal() {
        new Thread(new Runnable() {
            @Override
            public void run() {
                boolean trying = true;
                while (trying) {
                    if (signal) {
                        latch.countDown();
                        trying = false;
                    }
                    sleep(5);
                }
            }
        }).start();
    }

    private void sleep(long millis) {
        try {
            Thread.sleep(millis);
        } catch (InterruptedException e) {
            throw new IllegalStateException("Unexpected interrupt", e);
        }
    }
} 
```

# javascript - 向 TinyMCE 添加自定义按钮

> ID：10770423
> 
> 赞同：1
> 
> 时间：2012-05-26T23:06:23.397
> 
> 标签：javascript, tinymce

一直在尝试添加自定义按钮大约 2 小时，但我无法让它工作。我对javascript不太了解，也许这就是原因。我确实设法让按钮显示并打开一个弹出窗口，但这就是我所得到的。

我希望按钮将以下内容插入到 tinymce 的 HTML 部分：

'

这是我的 dialog.js 文件：

```
tinyMCEPopup.requireLangPack();

var InsertQuoteDialog = {
    init: function () {
        var s = tinyMCEPopup.editor.selection.getContent({ format: 'text' });
        if (s.trim().length > 0) {
            document.forms[0].blizzQuote.value = s.trim();
        }
    },

    insert: function () {
        var s1 = '<p class="blizzardQuote" ';
        s1 += Encoder.htmlEncode(document.forms[0].blizzQuote.value.trim()) + '</p>';

        tinyMCEPopup.editor.execCommand('mceInsertContent', false, s1);
        tinyMCEPopup.close();
    }
};

String.prototype.trim = function () {
    return this.replace(/^\s*/, "").replace(/\s*$/, "");
}

tinyMCEPopup.onInit.add(InsertQuoteDialog.init, InsertQuoteDialog); 
```

还有我的 Dialog.htm 文件：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>{#example_dlg.title}</title>
    <script type="text/javascript" src="../../tiny_mce_popup.js"></script>
    <script type="text/javascript" src="js/dialog.js"></script>
</head>
<body>

<form onsubmit="InsertQuoteDialog.insert();return false;" action="#">
    <p>Blizzard Quote</p>
    <p>Blizzard Quote: <input id="blizzQuote" name="blizzQuote" type="text" class="text" /></p>

    <div class="mceActionPanel">
    <div style="float: left">
        <input type="button" id="insert" name="insert" value="{#insert}" onclick="InsertQuoteDialog.insert();" />
    </div>
    <div style="float: right">
        <input type="button" id="cancel" name="cancel" value="{#cancel}" onclick="tinyMCEPopup.close();" />
    </div>
    </div>
</form>

</body>
</html> 
```

基本上，当我单击插入时，什么也没有发生。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T03:40:22.637

快速浏览一下 javaScript 控制台应该会告诉您，您在对话框中遇到 JavaScript 错误，并且**Encoder**对象未知。

只需在对话框中包含定义**Encoder**的 JS 文件，就可以了。

# c - 在 C 中查找压缩结构大小的便携式方法

> ID：10770433
> 
> 赞同：2
> 
> 时间：2012-05-26T23:07:50.510
> 
> 标签：c, struct, sizeof

我正在编写网络层协议，需要找到用 C 定义的压缩结构的大小。因为编译器可能会添加额外的填充字节，这`sizeof`在我的情况下使函数无用。我查了一下谷歌，发现我们可以使用`___attribute(packed)___`这样的东西来防止编译器添加额外的填充字节。但我相信这不是可移植的方法，我的代码需要同时支持 windows 和 linux 环境。

目前，我已经定义了一个宏来映射我的代码中定义的每个结构的打包大小。考虑下面的代码：

```
typedef struct {
...
} a_t;

typedef struct {
...
} b_t;

#define SIZE_a_t 8;
#define SIZE_b_t 10;

#define SIZEOF(XX) SIZE_##XX; 
```

然后在主函数中，我可以使用上面的宏定义如下：-

```
int size = SIZEOF(a_t); 
```

这种方法确实有效，但我相信它可能不是最好的方法。有关如何在 C 中有效解决此问题的任何建议或想法？

## 例子

考虑下面的 C 结构：-

```
typedef struct {
   uint8_t  a;
   uint16_t b;
} e_t; 
```

在 Linux 下，`sizeof`函数返回 4 个字节而不是 3 个字节。为了防止这种情况，我目前正在这样做：-

```
typedef struct {
   uint8_t  a;
   uint16_t b;
} e_t;

#define SIZE_e_t 3
#define SIZEOF(XX) SIZE_##e_t 
```

现在，当我调用`SIZEOF(e_t)`我的函数时，它应该返回 3 而不是 4。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T23:47:50.587

`sizeof` *是*查找结构或任何其他 C 数据类型大小的可移植方法。

您面临的问题是如何确保您的结构具有您需要的大小*和布局*。

`#pragma pack`或者`__attribute__((packed))`很可能为您完成这项工作。它不是 100% 可移植的（在 C 标准中没有提到打包），但它可能对于您当前的目的来说足够可移植，但请考虑您的代码将来是否需要移植到其他平台。它也可能不安全。看到[这个问题](https://stackoverflow.com/q/8568432/827263)和[这个答案](https://stackoverflow.com/a/8568441/827263)。

唯一 100% 可移植的方法是使用数组`unsigned char`并跟踪哪些字段占用哪些字节范围。当然，这要麻烦得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T23:16:08.773

你的宏告诉你你认为结构*应该*有的大小，如果它已经按照你的意图布局。

如果这不等于`sizeof(a_t)`，那么您编写的任何认为它已打包的代码都将无法正常工作。假设它们是相等的，您不妨将其`sizeof(a_t)`用于所有目的。如果它们不相等，那么您应该仅将它用于某种检查 that `SIZEOF(a_t) == sizeof(a_t)`，这将失败并阻止您的非工作代码编译。

因此，您不妨将检查放在头文件中`sizeof(a_t) == 8`，而不必费心定义`SIZEOF`.

除此之外，它的`SIZEOF`行为并不像`sizeof`. 例如考虑`typedef a_t foo; sizeof(foo);`，这显然不适用于`SIZEOF`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T23:10:36.783

我不认为手动指定大小比使用 sizeof 更便携。

如果大小更改，您的 const 指定大小将是错误的。

打包的属性是可移植的。在 Visual Studio 中，它是[#pragma pack](http://msdn.microsoft.com/en-us/library/2e70t5y1%28v=vs.80%29.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T17:40:22.223

我建议不要尝试通过将数据覆盖在结构上来读取/写入数据。我建议改为编写一系列在概念上类似于 printf/scanf 的例程，但它们使用指定二进制数据格式的格式说明符。我建议不要使用基于百分号的标签，而是简单地使用数据格式的二进制编码。

有几种方法可以采取，包括在序列化/反序列化例程本身的大小、使用它们所需的代码大小以及处理各种反序列化格式的能力之间进行权衡。最简单（也是最容易移植）的方法是使用例程，而不是使用格式字符串，而是通过采用双间接指针来单独处理项目，从中读取一些数据类型，并适当地增加它。因此：

```
uint32_t read_uint32_bigendian(uint8_t const ** src)
{
  uint8_t *p;
  uint32_t 时间；

  p = *src;
  tmp = (*p++) << 24;
  tmp |= (*p++) << 16;
  tmp |= (*p++) << 8;
  tmp |= (*p++);
  *src = p;
}

...
  字符缓冲区[256]；
...
  uint8_t *buffptr = buff；
  first_word = read_uint32_bigendian(&buffptr);
  next_word = read_uint32_bigendian(&buffptr);

```

这种方法很简单，但缺点是打包和解包代码有很多冗余。添加格式字符串可以简化它：

```
#define BIGEND_INT32 "\x43" // 或者任何合适的标记
  uint8_t *buffptr = buff；
  read_data(&buffptr, BIGEND_INT32 BIGEND_INT32, &first_word, &second_word);

```

这种方法可以通过一个函数调用读取任意数量的数据项，`buffptr`只传递一次，而不是每个数据项一次。在某些系统上，它可能仍然有点慢。另一种方法是传入一个字符串，指示应该从源接收哪种数据，然后还传入一个字符串或结构，指示数据应该去哪里。这可以允许通过单个调用解析任意数量的数据，为源提供一个双间接指针，一个指示源数据格式的字符串指针，一个指示如何解包数据的结构的指针，以及aa 指向保存目标数据的结构的指针。

# c++ - 数组指针类型

> ID：10770435
> 
> 赞同：1
> 
> 时间：2012-05-26T23:07:57.557
> 
> 标签：c++, pointers

下面是代码

```
void printLoop(type?? p){

for(int i  = 0; i<2;i++)
{
   for(int e = 0;e<3;e++)
        {
             cout<<p[i][e]<<" ";
         }
      cout<<"\n";
  }
}
void array()
{
int a[2][3] = {{1,2,3},{4,5,6}};
int (*p)[3] = a;
printLoop(p);
} 
```

基本思想是我想在 printLoop 函数中使用 for 循环打印出数组。但是，我需要知道具有二维数组地址的指针的类型。指针的类型是什么？是`int (*)[]`吗？我很困惑。

还有“”是什么`(*p)`意思（来自`int (*p)[3])`？非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T23:17:05.557

> "(*p)" 是什么意思（来自 int (*p)[3]) ？

`p``3`是指向类型为对象大小的数组的指针`int`。

您的`printLoop`函数有多种可能性（尽管具有一般 C 限制，您最多可以保留一个 - 最外面的声明符为空）：

*   您可以明确指定尺寸：

    `void printLoop(int p[ 2 ][ 3 ]);`

这种方法的唯一优点是实现*可以*考虑将传递的数组具有所需的大小（即`int`s 的 2x3 矩阵）作为先决条件。

*   您可以完全省略 [ 2 ] 部分：

    `void printLoop(int p[][ 3 ]);`

或者，

```
void printLoop(int (*p)[ 3 ]); 
```

*   您可以使用指向指针的指针`int`

您还需要传递维度（如果您跳过一个维度）以确保您不会访问越界内存。所以，你的函数签名应该是这样的：

```
void printLoop(int (*p)[ 3 ], int dim); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-26T23:12:10.257

对于`printLoop`函数，`int p[2][3]`作为参数应该可以工作。

```
int (*p)[3] = a; 
```

`p`是一个指向 3 s 数组的指针`int`，初始化为指向`a`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-26T23:19:03.527

首先，您的代码不是很现代的 C++。它基本上是“ **c with iostreams** ”。

其次，`printLoop(int p[2][3])`是您要寻找的签名，尽管这又不是最好的做事方式。

第三，`int (*p)[3]`分析如下：从名字是什么开始，`p`然后环顾四周（先到右边再到左边但这里没关系），直到你“打”大括号。它只有一颗星，所以你可以说**p 是一个指针**。现在您再次递归地执行相同的分析，您会看到`[3]`，这意味着它`p`是一个指向具有 3 `int`s 的数组的指针。

现在我想提以下几点：

用于`std::array`静态大小的数组。
用于`std::vector`动态大小的数组。

哦，另外，我自己不会使用二维数组，它们很笨重，只是一个语法糖（围绕基本的“数组”概念，它也是一个语法糖）。

所以也许，像这样，大脑编译，希望是正确的，C++11 滥用：

```
std::array<int, 3 * 2> p = {{1, 2, 3, 4, 5, 6}};
std::for_each(std::begin(p), std::end(p), [](int elem){ std::cout<<elem; }); 
```

漂亮又花花公子。如果需要，您还可以对某些“二维数组”大小进行 lambda 检查并插入换行符。

# url - Yahoo Pipes - How Do I Truncate the last 5 Characters

> ID：10770440
> 
> 赞同：-1
> 
> 时间：2012-05-26T23:08:55.677
> 
> 标签：url, truncate, yahoo-pipes

I am using Yahoo Pipes to rewrite a URL. Everything is fine but the last 6 characters of the URL need to be removed from all the links.

Ex.

[http://www.mysite.com/blahblah/34567](http://www.mysite.com/blahblah/34567)

needs to be rewritten to

[http://www.mysite.com/blahblah](http://www.mysite.com/blahblah)

The number at the end is always changing, so I am hoping to just chop the last 6 characters off of each url.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T12:47:51.397

似乎 (.*)(.....) 和 takinq 中的正则表达式只有第一个匹配项应该可以解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:20:08.067

您需要[Sub string module](http://pipes.yahoo.com/pipes/docs?doc=string#SubString)。假设它的功能与其他语言类似，您将需要未定义的 From 值和 -6 的 Length 值，这应该从 URL 的末尾删除 6 个字符。

# asp.net - ASP.Net MVC2 page render takes up 70% CPU

> ID：10770441
> 
> 赞同：0
> 
> 时间：2012-05-26T23:09:14.000
> 
> 标签：asp.net, asp.net-mvc, performance, asp.net-mvc-2

I am doing stress tests on my ASP.Net MVC2 application, and I have set

`<compilation debug="false" />` in web.config.

Simulating 200 connections in the IIS7, which hosts this application, the CPU load goes up to 100%. Simulated requests only access simple home page without the database operations.

Meanwhile, I run the `dotTrace` to profile the application, which shows the page render procedure (like `RenderControl`, `RenderControlInternal`, etc.....) takes about 69% CPU time.

Is this normal? How many connections can an MVC2 application support for one machine?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T23:19:17.397

这绝对不正常。我认为可能还有其他一些问题，但是当您从 action 中返回时，mvc2 花费了更多时间来查找相关视图。一些事情要做：

更新您的库。从操作中提供视图名称，然后重试。

```
public ActionResult Index() {
     ///other operations
     return View("Index",yourmodel);
} 
```

等等

# jquery - 是否可以仅在特定浏览器宽度下执行功能？

> ID：10770444
> 
> 赞同：2
> 
> 时间：2012-05-26T23:09:34.687
> 
> 标签：jquery, media-queries, document-ready

我正在尝试通过 CSS 媒体查询从我的“桌面”网站创建一个移动网站。

我有一个简单的下拉菜单（桌面），可以转换为下推菜单（移动）。浏览器宽度为 768 像素以上的任何地方都会为桌面加载 CSS，而在 767 像素以下的任何地方都可以加载移动下推菜单。

问题是下推菜单需要一个 js 文件才能正常运行。js文件强制隐藏包含菜单的div。因此，在 767 像素的浏览器宽度下，下推工作正常，在 768 像素时，桌面导航不可见。

我是 JavaScript 和 Jquery 的新手，但我试图用我最少的知识让它有效地运行。我需要它尽可能简单，因为站点必须尽可能小。

目前这是我最接近正常运行的方法：

```
function hideDiv(){
    if ($(window).width() < 768) {

        $(".togglebox").hide();

    }else{

        $(".togglebox").show();

    }

}

//run on document load and on window resize
$(document).ready(function () {

    //on load
    hideDiv();

    //on resize
    $(window).resize(function(){
        hideDiv();
    });

});

$(document).ready(function(){

    $(".togglebox").hide();

    $("h1").click(function(){

    $(this).next(".togglebox").slideToggle("slow");
    return true;
    });
}); 
```

笔记：

切换框 div 需要隐藏才能使下推菜单起作用，但是相同的 div 需要在超过 768px 的宽度上可见，以便桌面导航可见。

上面的代码使它工作正常，但是当我输入页面 url 时，在我尝试调整浏览器宽度之前没有导航。我知道我有两个 (document).ready 函数，也许这就是问题所在，但我尝试过使用代码，但我没有任何运气。必须有一个我忽略的简单解决方案？

我想也许只在 767px 宽度下执行下推菜单功能，然后在上面的任何东西上简单地显示切换框 div。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T23:14:42.110

当您已经在使用媒体查询时，您不需要加载 JavaScript 文件来隐藏元素。例如，我可以将其隐藏`.toggleBox`在宽度不超过 767 像素的任何窗口中：

```
@media screen and ( max-width: 767px ) {
  .toggleBox {
    display:none;
  }
} 
```

没有任何理由使用 JavaScript 轮询浏览器的宽度来完成媒体查询的发明。

演示：http: [//jsfiddle.net/HPsu8/show/](http://jsfiddle.net/HPsu8/show/)

### 支持说明

正如下面评论中所指出的，旧版本的 Internet Explorer 不支持媒体查询。如果您希望使用它们，同时保持对旧版本 IE 的支持，请考虑使用 polyfill。你可以在这里找到几个：[https ://github.com/Modernizr...HTML5-Cross-Browser-Polyfills](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T23:39:08.120

您的代码在页面首次加载时不起作用，因为您总是在页面首次加载时隐藏它。无需在页面首次加载时始终隐藏它，您只需调用已有的函数`hideDiv()`，它将确定它最初是否应该可见。将您的代码更改为此（删除该`.hide()`行并让一个调用`hideDiv()`完成其自然工作）：

```
function hideDiv(){
    if ($(window).width() < 768) {
        $(".togglebox").hide();
    }else{
        $(".togglebox").show();
    }
}

//run on document load and on window resize
$(document).ready(function () {
    //on load
    hideDiv();

    //on resize
    $(window).resize(function(){
        hideDiv();
    });
});

$(document).ready(function(){
    $("h1").click(function(){
        $(this).next(".togglebox").slideToggle("slow");
        return true;
    });
}); 
```

# android - How to resize an ImageView in Android?

> ID：10770454
> 
> 赞同：0
> 
> 时间：2012-05-26T23:12:14.483
> 
> 标签：android, android-layout

I am trying to do something similar to the image below in Android. The problem is, whenever the screen size changes (when the user rotates the device), the checkboxes and the button disappear from the screen. This is my layout

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<ImageView
android:id="@+id/preview"
android:layout_width="fill_parent"
android:contentDescription="@string/content_description"
android:layout_height= "1.5in" />

<CheckBox
android:id="@+id/location"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_below="@+id/preview"
android:text="@string/location_text" />

<CheckBox
android:id="@+id/timestamp"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_below="@+id/location"
android:text="@string/timestamp_text" />

<Button
android:id="@+id/buttonUpload"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentRight="true"
android:layout_below="@+id/timestamp"
android:layout_marginRight="19dp"
android:gravity="center_vertical"
android:onClick="uploadClicked"
android:text="@string/upload_button_text" />

</RelativeLayout> 
```

I need to display the image and all controls and support all screen sizes. How do I make the size of the `ImageView` dynamic?

![shot](../Images/b06d9632277f964c6f0996bf9f2db2c1.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T23:55:05.173

我从来没有让 scaleType 为我工作。

我将 ImageView 子类化：

```
package your.pkg;

import android.content.Context;
import android.util.AttributeSet;
import android.widget.ImageView;

public class AspectRatioImageView extends ImageView {

  public AspectRatioImageView(Context context) {
    super(context);
  }

  public AspectRatioImageView(Context context, AttributeSet attrs) {
    super(context, attrs);
  }

  public AspectRatioImageView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
  }

  @Override
  protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    int width = MeasureSpec.getSize(widthMeasureSpec);
  if (getDrawable() != null && getDrawable().getIntrinsicWidth() != 0) {
    int height = width * getDrawable().getIntrinsicHeight() / getDrawable().getIntrinsicWidth();
    setMeasuredDimension(width, height);
  } else {
    setMeasuredDimension(0, 0);
  }

 }
} 
```

并使用它而不是常规的 ImageView：

```
<your.pkg.AspectRatioImageView
            android:id="@+id/photo"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_alignParentTop="true"
            android:adjustViewBounds="true"
/> 
```

这会缩放到父视图的整个宽度，并在这样做时保持纵横比。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T23:15:33.657

如果您使用 a`LinearLayout`而不是 a `RelativeLayout`，则可以进行`ImageView`扩展以占用屏幕中的所有空白空间。该`scaleType`属性将让您指定如何拉伸图像。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<ImageView
android:id="@+id/preview"
android:layout_width="fill_parent"
android:contentDescription="@string/content_description"
android:layout_height="0dp"
android:layout_weight="1"
android:scaleType="fitCenter" />

<CheckBox
android:id="@+id/location"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="@string/location_text" />

<CheckBox
android:id="@+id/timestamp"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="@string/timestamp_text" />

<Button
android:id="@+id/buttonUpload"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_marginRight="19dp"
android:layout_gravity="right"
android:onClick="uploadClicked"
android:text="@string/upload_button_text" />

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T00:17:21.727

基于所有反馈。这是我使用的：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/scroller"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:fillViewport="true" >
    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

<ImageView
android:id="@+id/preview"
android:layout_width="fill_parent"
android:contentDescription="@string/content_description"
android:layout_height= "1.5in" />

<CheckBox
android:id="@+id/location"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_below="@+id/preview"
android:text="@string/location_text" />

<CheckBox
android:id="@+id/timestamp"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_below="@+id/location"
android:text="@string/timestamp_text" />

<Button
android:id="@+id/buttonUpload"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentRight="true"
android:layout_below="@+id/timestamp"
android:layout_marginRight="19dp"
android:gravity="center_vertical"
android:onClick="uploadClicked"
android:text="@string/upload_button_text" />

</RelativeLayout>
</ScrollView> 
```

# php - 为 PHP 存储临时图像文件的正确方法

> ID：10770456
> 
> 赞同：1
> 
> 时间：2012-05-26T23:12:31.330
> 
> 标签：php

我有一个使用`imagecopyresampled`. 我需要将该图像传递给一组期望字符串输入而不是资源的方法。但我不需要在本地存储文件。

这是正确的方法吗：

1.  `imagepng`使用和存储图像`imagejpeg`
2.  将字符串（文件名）传递给方法
3.  销毁存储的文件`@unlink`

是对的吗？看起来很马虎

*注意：图像不是来自文件上传，因此无法访问`$_FILES["Filedata"]["tmp_name"]`*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T00:05:29.230

我查看了 Amazon S3 PHP API： [http ://docs.amazonwebservices.com/AWSSDKforPHP/latest/index.html#m=AmazonS3/upload_part](http://docs.amazonwebservices.com/AWSSDKforPHP/latest/index.html#m=AmazonS3/upload_part)

我假设您使用的方法类似于`upload_part`采用 string的方法`filename`。在这种情况下，除非您打算修改他们的库，否则您需要将文件存储到磁盘并将文件名传递给他们，以便他们可以读取文件并执行上传。

除了问题中提到的步骤之外，您还可以查看`imagedestroy`以确保在使用`imagepng`. 然后，正如您所说，您可以`unlink`在上传完成后删除您的临时文件。

我同意，这似乎有点浪费，但在这种情况下是必要的，因为 API 似乎没有提供替代方案。

# java - Observer Pattern : How to differentiate Observables

> ID：10770457
> 
> 赞同：-1
> 
> 时间：2012-05-26T23:12:54.070
> 
> 标签：java, observer-pattern

In a swing application, text box 1 depends on combo box 1's selected item. It also depends on Text Box 2's text.Like this, the text box 1 may depend on a variety of components. For all these changes, text box 1's update() method is called (following Observable Pattern rules). How to distinguish as to which component has changed?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:33:07.087

我不确定我是否理解你。但我认为观察者模式是错误的选择，观察者模式解决了忙等待问题，并通知许多对象主体（可观察者）发生了变化，反之亦然。您可以改变模式规则并让观察者向主题发送他们已更改的消息，但这不再是观察者模式。

注意：在处理设计模式时，请始终查看它们解决了什么问题，因为在许多情况下实现方式非常接近，以至于无法将它们与代码区分开来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:22:35.970

根据您实现观察者的方式，通常您会提供“发送者”或触发事件的组件。

这样做..虽然您的 Textbox1 订阅了 3 个事件..它可以检查发件人/组件是谁。

# c# - How to define an array with equal value in c#?

> ID：10770460
> 
> 赞同：1
> 
> 时间：2012-05-26T23:13:57.610
> 
> 标签：c#, arrays

I want to create a new array. Let's say

```
int[] clickNum = new int[800]; 
```

Then I want to do something like `clickNum = 2`, which would make all array elements starting from `clickNum[0]` to `clickNum[800]`, set to `2`. I know there's a way to do it by using a loop; but what I am after is just a function or a method to do it.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-26T23:16:54.387

我想你可以`Enumerable.Repeat`在初始化数组时使用：

```
int[] clickNum = Enumerable.Repeat(2, 800).ToArray(); 
```

它当然会更慢，但*除非你要启动数百万个元素，否则会很好*。

我的机器上的一个快速基准测试表明，使用`for`循环初始化 1,000,000 个元素需要`2ms`，但使用`Enumerable.Repeat`take `9ms`。

[此页面](http://www.dotnetperls.com/initialize-array)表明它可能会慢 20 倍。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-26T23:24:09.173

我认为没有任何内置函数可以填充现有数组/列表。如果您需要在几个地方进行操作，您可以为此编写一个简单的辅助方法：

```
static void Fill<T>(IList<T> arrayOrList, T value)
{
    for (int i = arrayOrList.Count - 1; i >= 0; i--)
    {
        arrayOrList[i] = value;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T23:42:16.637

我猜您正在寻找您创建的函数，但您没有时间输入它。因此，如果您想在一行中使用它，请尝试：

```
for(int i = 0; i < clickNum.Length; i++, clickNum[i] = 2); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T08:30:23.947

如果您正在处理非常大的数组并且性能是一个问题，那么使用 Array.ConvertAll 应该会更有效：

```
int[] clickNum = Array.ConvertAll(new int[800], x => x = 2); 
```

如果性能不让您担心，您还可以使用标准 LINQ Select：

```
int[] clickNum = new int[800].Select(x => x = 2).ToArray(); 
```

# java - catch (Exception ex) block misses

> ID：10770463
> 
> 赞同：1
> 
> 时间：2012-05-26T23:14:15.260
> 
> 标签：java, exception-handling

There are a few similar questions, but for C# mostly.

```
@Override
public void setExtraItemsDone(XMPPResourceConnection session) throws NotAuthorizedException 
{
    try
    {
        cp1 = Calendar.getInstance().getTimeInMillis();

        try 
        {
             ...

        } catch (TigaseDBException e) {

                         ...

        } catch (UnsupportedOperationException e) {

                         ...
        }

    } catch (Exception e) {

        cp2 = Calendar.getInstance().getTimeInMillis();
        throw new NotAuthorizedException(e.getMessage() + "; method took " + (cp2 - cp1) + " ms", e); 
    } 
```

I am basically looking to catch a MySQLTimeoutException and turn it into a NotAuthorizedException (while keeping an eye for any other stuff besides TigaseDBException and UnsupportedOperationException) in the last catch block. Somehow, java eludes my master plan.

Logs show a straight

```
com.mysql.jdbc.exceptions.MySQLTimeoutException: Statement cancelled due to timeout or client request
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1754)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2019)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:1937)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:1922)
at tigase.db.jdbc.JDBCRepository.addDataList(JDBCRepository.java:183)
at tigase.db.jdbc.JDBCRepository.setDataList(JDBCRepository.java:1175)
at tigase.db.UserRepositoryMDImpl.setDataList(UserRepositoryMDImpl.java:651)
at tigase.xmpp.RepositoryAccess.setDataList(RepositoryAccess.java:1152)
at tigase.xmpp.RepositoryAccess.setOfflineDataList(RepositoryAccess.java:1204)
**at tigase.xmpp.impl.XGateRoster.setExtraItemsDone(XGateRoster.java:370)**
at tigase.xmpp.impl.DynamicRoster.setExtraItemsDone(DynamicRoster.java:377)
at tigase.xmpp.impl.JabberIqRoster.dynamicSetRequest(JabberIqRoster.java:178)
at tigase.xmpp.impl.JabberIqRoster.process(JabberIqRoster.java:329)
at tigase.server.xmppsession.SessionManager$ProcessorWorkerThread.process(SessionManager.java:2135)
at tigase.util.WorkerThread.run(WorkerThread.java:132) 
```

As far as i can tell, the bolded line in the stack trace should have changed the exception to a NotAuthorizedException breed. What am I missing ?

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T14:09:59.737

我同意。问题不在于发布的代码。检查你的假设。XGateRoster.setExtraItemsDone 是否还有其他重载？尝试使用 Jad 反编译您正在运行的类文件。如果您启用显示行号的选项，您可以确定您正在查看的（反编译的）源代码正是正在执行的代码。您是否确切知道您正在查看的日志消息来自哪里？也许它来自更高的堆栈，在它被抛出之后但在这个 catch 块和异常转换代码甚至被命中之前。

# winapi - 在登录屏幕向远程计算机发送密码 [Windows 7]

> ID：10770469
> 
> 赞同：2
> 
> 时间：2012-05-26T23:15:35.900
> 
> 标签：winapi, windows-7, login, network-drive

我写了一个软件，它可以让你远程控制计算机，它的一个功能是打开它通过 Magic Packets 控制的所有计算机。

由于网络驱动器的限制和帐户密码的需要，我遇到了一个问题。

当计算机启动时，我卡在每台计算机的登录屏幕上，必须手动四处走动并输入密码。

无论如何，我可以将密码发送到个人计算机或让计算机自己登录吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T23:50:42.500

您可能希望将程序安装为服务。您将其启动设置为`automatic`，这意味着它会在计算机启动时自动启动并运行，即使没有用户登录也是如此。

请注意，也可以将服务的启动设置为`Boot`. 不过，您可能希望避免这种情况。`Boot`启动主要用于设备驱动程序，而不是普通服务。它在启动过程中运行得更早。您不需要（或可能想要）那个——您只希望它在系统准备好供某人选择登录时大致运行。

我还要注意，服务（通常）编写方式与普通程序略有不同。它有一个 Windows 样式的事件循环，但响应一组不同的“消息”，这些“消息”启动服务、停止服务、暂停服务等等。其中大部分都不是很困难，但它与普通程序有些不同。

# xslt-1.0 - 使用 在 xsl 中选择真或假

> ID：10770471
> 
> 赞同：-1
> 
> 时间：2012-05-26T23:16:03.293
> 
> 标签：xslt-1.0

首先，如果我发错了，那么我道歉......好吧，我正在寻求有关如何使用 xsl 文件的帮助，以便能够通过选择说 true/false will to icall 来选择使用 xsl 中的以下内容来选择一个或另一个...任何帮助都是伟大的，因为刚刚开始了解 xsl

```
<xsl:choose>  
<li><a href="#" >Home</a></li>
<xsl:otherwise>
<li><a href="#" id="current">Products</a></li> 
```

可以通过选择是否为真来做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:08:19.660

> ```
> <xsl:choose>  
> <li><a href="#" >Home</a></li>
> <xsl:otherwise>
> <li><a href="#" id="current">Products</a></li> 
> ```

**这在语法上是非法的，也毫无意义**。

一个语法正确且有意义的例子**[`xsl:choose`](http://www.w3.org/TR/1999/REC-xslt-19991116#section-Conditional-Processing-with-xsl:choose)**是：

```
<xsl:choose>
  <xsl:when test="someCondition">  
   <li><a href="#" >Home</a></li>
  </xsl:when>
  <xsl:otherwise>
    <li><a href="#" id="current">Products</a></li>
  </xsl:otherwise>
</xsl:choose> 
```

**对新手的最佳建议是阅读有关 XSLT 和 XPath 的好书**。

**可以在此处找到一份好的资源列表**：

[https://stackoverflow.com/questions/339930/any-good-xslt-tutorial-book-blog-site-online/341589#341589](https://stackoverflow.com/questions/339930/any-good-xslt-tutorial-book-blog-site-online/341589#341589)

# c# - Linq to SQL - 删除子属性

> ID：10770474
> 
> 赞同：1
> 
> 时间：2012-05-26T23:16:58.973
> 
> 标签：c#, linq-to-sql

我正在尝试删除域实体的子属性。在 UI 中，用户选择 Delete 以`CustomVariableGroup`从`Application`实体中删除 a。

我认为从 LINQ-to-SQL 实体中删除该属性然后提交更改，会导致 LINQ-to-SQL 处理数据库端的工作。但是该行永远不会从表中删除。当我在我的应用程序中刷新页面时，该属性仍然存在，因为它仍然存在于数据库中。

```
public void Save(Application application)
{
    ApplicationRecord appRecord = application.Map();  // Maps domain entity to L2S entity

    // Before this line executes, appRecord has 0 CustomVariableGroups, which is correct.
    this.Database.ApplicationRecords.Attach(appRecord, true);
    // After the attach, appRecord now has 1 CustomVariableGroup again. This is wrong.

    appRecord = application.Map();  // Hack to remove the CustomVariableGroup again.

    // This doesn't delete the CustomVariableGroup from appRecord. Do I need
    // to delete it explicitly? Or should removing it from appRecord, and
    // calling SubmitChanges() do it?
    this.Database.SubmitChanges();
} 
```

我摆脱实体上的这个子属性的正确方法是什么？我想我可以遍历列表并单独删除每个项目，但我认为 LINQ-to-SQL 不应该以这种方式工作。

任何想法表示赞赏。

**注意：**该属性`ApplicationCustomVariableGroupRecords`表示解析`many-to-many`数据库中的关联的表。一个`Application`罐子有一个或多个`CustomVariableGroups`，一个`CustomVariableGroup`罐子属于一个或多个`Applications`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T05:14:10.887

通常，您必须专门删除该对象 - 从父集合中删除它只是意味着您不希望它再与该特定父项关联。它不能告诉您不想将其与不同的父级关联。如果您希望它被删除，您需要拨打电话将其删除（DeleteOnSubmit for L2S, IIRC）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T01:46:34.170

如果我没有错，它们之间有 n 到 n 关系的表就像嵌套一样工作。所以尝试首先从第三个表（包含 2 个表的 ID）中删除，然后从主表中删除。

[对不起，我在页面上看不到添加评论按钮..所以我写了这个想法作为答案]

# java - I'm having trouble returning a List from a method in Java

> ID：10770477
> 
> 赞同：0
> 
> 时间：2012-05-26T23:17:15.450
> 
> 标签：java, list, arraylist

I'm learning about Lists in java but I'm having a hard time returning it from a method like I would any primitive data type. All I'm trying to do is return a list of nodes and then print out all their labels. What am I doing wrong?

```
import java.util.ArrayList;

import java.util.List;

public class TestingArrays 
{

    List<Node> myList1  = new ArrayList<Node>();

    List<Node> myList2 = new ArrayList<Node>();

    List<Node> myList3 = new ArrayList<Node>();

    List<Node> myList4 = new ArrayList<Node>();

    private Node Node1 = new Node("One", myList1);
    private Node Node2 = new Node("Two", myList2);
    private Node Node3 = new Node("Three", myList3);
    private Node Node4 = new Node("Four", myList4);

    public static void main(String arg[])
    {
        List<Node> nodeList = nodeArray();

        for (int i = 0; i < nodeList.size(); i++)
        {
            System.out.println(nodeArray.get(i).label);
        }
    }

    public List<Node> nodeArray()
    {
        List<Node> tempList = new ArrayList<Node>();
        tempList.add(Node1);
        tempList.add(Node2);
        tempList.add(Node3);
        tempList.add(Node4);
        return tempList;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T23:23:45.587

you can't call non static method from static context. make method `nodeArray()` `static`. That'll fix your problem.

also you cannot make a static reference to the non-static field i.e. `Node1`, `Node2`, `Node3`, `Node4`. so make them `static` too.

also `nodeArray.get(i).label` is wrong as it should be `nodeList.get(i).label`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T23:24:08.847

this is weird:

```
nodeArray.get(i) 
```

nodeArray is a function . how could it even compile? that's why it's important to give good names to both functions and variables.

also , since it's a list , you can use foreach , like this: [http://www.leepoint.net/notes-java/flow/loops/foreach.html](http://www.leepoint.net/notes-java/flow/loops/foreach.html)

oh , and in the main function you should either create a new instance of the class and use it , or set all of the methods and variables as static.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T23:27:52.207

The nodeArray() method is a method for the TestingArrays object. All the nodes and lists are attributes of the TestingArrays object.

You need to create a TestingArrays object to access those things.

Replace your main method with this code:

```
public static void main(String arg[])
{
    List<Node> nodeList = new TestingArrays().nodeArray();

    for (int i = 0; i < nodeList.size(); i++)
    {
        System.out.println(nodeList.get(i).label);
    }
} 
```

# ruby - 使用 net-http-digest_auth 的未知算法 MD5

> ID：10770478
> 
> 赞同：1
> 
> 时间：2012-05-26T23:17:42.853
> 
> 标签：ruby, nokogiri, digest-authentication, net-http

我正在尝试对服务器进行一些摘要授权，然后使用 nokogiri 解析生成的 HTML。我正在使用 net-http-digest_auth gem (https://github.com/drbrain/net-http-digest_auth) 进行 url 连接。一切都很好，直到我启动了 digest_auth 代码（第 20 行）；它抛出一个“未知算法“MD5”错误'..

来自控制台的完整错误消息： `~/.rvm/gems/ruby-1.9.3-p194@rails32/gems/net-http-digest_auth-1.2.1/lib/net/http/digest_auth.rb:105:in 'auth_header': unknown algorithm ""MD5"" (Net::HTTP::DigestAuth::Error) from ./server_connection.rb:20:in '<main>'`

第 20 行是 auth 行： `auth = digest_auth.auth_header uri, res['www-authenticate'], 'GET'`

这是我的完整代码（几乎完全逐字逐句地来自 github 链接上使用的示例代码）：

```
#!/usr/bin/env ruby
require 'uri'
require 'net/http'
require 'net/http/digest_auth'

digest_auth = Net::HTTP::DigestAuth.new

uri = URI.parse 'http://url/controlpage?name=_internal_variables_&asList=1&useJS=True'
uri.user = 'username'
uri.password = 'password'

h = Net::HTTP.new uri.host, uri.port

req = Net::HTTP::Get.new uri.request_uri

res = h.request req

# res is a 401 response with a WWW-Authenticate header
auth = digest_auth.auth_header uri, res['www-authenticate'], 'GET'

# create a new request with the Authorization header
req = Net::HTTP::Get.new uri.request_uri
req.add_field 'Authorization', auth

# re-issue request with Authorization
res = h.request req

if res.code == "200"
  page = Nokogiri::HTML(res)
  isDaylight = page.css('.controlTitle:contains("isDaylight") ~ .controlValue');
  puts isDaylight.content
end 
```

通过 Chrome 的开发工具更新了这个问题以包含请求标头：

```
GET /_getupdatedcontrols?name=_internal_variables_&asList=True&folderFilter=0&changeCount=479&serverState=idle HTTP/1.1
Host: url
Connection: keep-alive
Cache-Control: no-cache
Authorization: Digest username="username", realm="Indigo Control Server", nonce="71079e9f29f7210325ae451d0f423f07", uri="/_getupdatedcontrols?name=_internal_variables_&asList=True&folderFilter=0&changeCount=479&serverState=idle", algorithm=MD5, response="bc056cc472d35f7967973cb51c5b1a65", qop=auth, nc=00005649, cnonce="18dfcf3e4a7b809d"
X-Indigo-Web-Server-Version: 1
X-Prototype-Version: 1.6.0.3
X-Requested-With: XMLHttpRequest
Pragma: no-cache
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.17 Safari/536.11
Accept: text/javascript, text/html, application/xml, text/xml, */*
Referer: http://url/controlpage?name=_internal_variables_&asList=1&useJS=True
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T17:48:09.223

我最终使用[httpclient gem](https://github.com/nahi/httpclient)来完成同样的事情。

完成我所追求的最终代码：

```
#!/usr/bin/env ruby
require 'httpclient'
require 'nokogiri'

c = HTTPClient.new
c.debug_dev = STDOUT

c.set_auth("http://domain.com", "username", "password")

doc = Nokogiri::HTML(c.get_content("http://domain.com"))
isDaylight = "";
doc.css('.controlTitle:contains("isDaylight") ~ .controlValue').each do |var|
  isDaylight = var.content
end

if (!isDaylight)
  system("curl -X PUT --digest -u username:password -d isOn=1 http://domain.com")
else
  system("curl -X PUT --digest -u username:password -d isOn=0 http://domain.com")
end 
```

我希望这可以帮助其他可能正在使用家庭自动化服务器并需要轻松进行基于摘要的身份验证的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T01:03:40.363

Seth，我在使用 ruby​​ 编写脚本时遇到了同样的问题。我是 ruby​​ 的新手，但经过一些谷歌搜索和一些 Charles Proxy 向我展示了发生了什么，我发现 HTTP 实现在 Auth 标头的 algorithm="MD5" 部分中包含引号是很常见的，这是不正确的根据规范（应该是算法=MD5，不带引号）。您从 Chrome devtools 更新的标头日志显示您的服务器响应符合规范，但 ruby​​ 库在解释该响应字符串时不是。这可以看出

您服务器的 401 响应包括：

注意 **算法=MD5**

```
Authorization: Digest username="username", realm="Indigo Control Server", nonce="71079e9f29f7210325ae451d0f423f07", uri="/_getupdatedcontrols?name=_internal_variables_&asList=True&folderFilter=0&changeCount=479&serverState=idle", algorithm=MD5, response="bc056cc472d35f7967973cb51c5b1a65", qop=auth, nc=00005649, cnonce="18dfcf3e4a7b809d" 
```

但是使用这个 Ruby 库的初始请求的控制台输出显示：

注意 **算法=\“MD5\”**

```
<- "GET /some/request HTTP/1.1\r\nAccept: */*\r\nUser-Agent: Ruby\r\nConnection: close\r\nHost: 10.1.0.15\r\n\r\n"
-> "HTTP/1.1 401 Unauthorized\r\n"
-> "Content-Length: 530\r\n"
-> "Server: SomeServer/5.0\r\n"
-> "Allow: GET, HEAD, POST, PUT\r\n"
-> "Date: Sun, 27 Jan 2013 00:29:23 GMT\r\n"
-> "Content-Type: text/html;charset=utf-8\r\n"
-> "Www-Authenticate: Digest realm=\"Some Realm\", nonce=\"5a8b8b46cfb84466431baf454eb9ddb9\", algorithm=\"MD5\", qop=\"auth\"\r\n" 
```

**对于原始帖子中的脚本示例，我将插入以下两行：**

```
www_auth_response = res['www-authenticate']
www_auth_response["algorithm=\"MD5\""] = "algorithm=MD5" 
```

**并修改第三行：**

```
auth = digest_auth.auth_header uri, www_auth_response, 'GET' 
```

**如下：**

...

```
res = h.request req

# res is a 401 response with a WWW-Authenticate header
www_auth_response = res['www-authenticate']
www_auth_response["algorithm=\"MD5\""] = "algorithm=MD5"
auth = digest_auth.auth_header uri, www_auth_response, 'GET'

# create a new request with the Authorization header
req = Net::HTTP::Get.new uri.request_uri
req.add_field 'Authorization', auth 
```

...

这里发生的重要事情是我们正在修改从您最初的未经授权的 401 请求返回的 www-authenticate 字符串（由这个 ruby​​ 库解释）。将修改后的标头字符串 (www_auth_response) 发送到 digest_auth.auth_header 方法不会产生错误。至少这在我的剧本中对我有用！

我希望这会有所帮助！

马特

# oracle-apex - Oracle Application Express 图表

> ID：10770479
> 
> 赞同：1
> 
> 时间：2012-05-26T23:17:48.067
> 
> 标签：oracle-apex

在尝试使用 APEX 制作 Flash 图表时，我仍然收到“图表查询无效”错误。我的查询代码：

```
select null, sum(kwota), to_char(data_zakupow,'YY-MM')
from zakupy
group by to_char(data_zakupow,'YY-MM') 
```

当我将它用作数据库查询时，我得到：

```
NULL|SUM(KWOTA)|TO_CHAR(DATA_ZAKUPOW,'YY-MM')
-   10  12-11
-   4   12-03
-   63  12-01 
```

IDK 为什么我会收到此错误以及如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T12:14:01.347

尝试给您的字段别名：

```
select null as link, sum(kwota) as value, to_char(data_zakupow,'YY-MM') as label
from zakupy
group by to_char(data_zakupow,'YY-MM') 
```

# java - 是否可以使用 HttpClient 下载 PDF 等文件？

> ID：10770483
> 
> 赞同：8
> 
> 时间：2012-05-26T23:19:19.927
> 
> 标签：java, pdf, httpurlconnection, apache-commons-httpclient

我在这里找到了一些关于如何下载文件的示例，但其中大多数似乎都在使用 HttpURLConnection。是否可以使用 HttpClient 下载文件？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-27T03:47:53.203

使用 httpclient 非常简单。这是它的教程的链接。

[http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html#d5e43](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html#d5e43)

```
HttpClient httpclient = new DefaultHttpClient();
HttpGet httpget = new HttpGet(urltofetch);
HttpResponse response = httpclient.execute(httpget);
HttpEntity entity = response.getEntity();
if (entity != null) {
    long len = entity.getContentLength();
    InputStream inputStream = entity.getContent();
    // write the file to whether you want it.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T23:28:32.807

通过查看他们有关文件传输的示例，您可以做的任何事情`HttpURLConnection`通常会更好，`HttpClient`您将了解如何做。

# c++ - 以 200 字节为单位读取二进制文件

> ID：10770485
> 
> 赞同：0
> 
> 时间：2012-05-26T23:20:12.450
> 
> 标签：c++, fread

我需要以 200 字节为单位读取文件。所以我正在使用这个：

```
int readData(char* data, FILE* fp){
sizeReturn=fread(data, 200, 1, fp);
cerr << sizeReturn << endl;
return sizeReturn;
}
while((size=readData(data, fp))>0)
    write(fileno(stdout), data, size); 
```

我只是想读取前 200 个字节，我知道我需要执行 fseek 才能前进，但我什至无法读取前 200 个字节。它返回读取的 0 个字节。我需要在每个循环上读取 200 x 200，因为我使用 udp 发送它，所以我使用少量字节进行测试。有人可以帮我阅读前 200 个字节。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T23:22:57.907

解决了：

只是`fread(data, 1, 200, fp);` 我想读取一个 200 字节的元素，而不是 1 字节的 200 个元素

谢谢

# c - 有没有一种有效的方法来列出给定进程的所有线程？

> ID：10770486
> 
> 赞同：0
> 
> 时间：2012-05-26T23:20:28.693
> 
> 标签：c, multithreading, winapi, enumerate

我的问题是 - 给定 PID，是否有一种快速查看当前进程已打开的所有线程的方法？

我知道 toolhelp 快照，但枚举系统中的所有线程听起来有点……不舒服。

我正在寻找更快的解决方案，很高兴听到您的建议。

谢谢 ！

# c++ - 前向迭代器 C++：for_each 行为

> ID：10770489
> 
> 赞同：0
> 
> 时间：2012-05-26T23:21:28.670
> 
> 标签：c++, foreach, iterator, forward

所以我们知道 foreach 是这样的：

```
template<class InputIterator, class Function>
  Function for_each(InputIterator first, InputIterator last, Function f)
  {
    for ( ; first!=last; ++first ) f(*first);
    return f;
  } 
```

我已经实施了一个

```
template <typename T>
class Range 
```

问题是当我将此函数与 for_Each 一起使用时：

```
static void add1(float &v)
{
  ++v;
} 
```

由于第一个“！=”最后一个（它不是第一个“<”最后一个），它进入无限循环，那么当人们实现自己的前向迭代器以使用 for_each 时，他们会怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T23:46:50.783

您的方法的问题是您的迭代器增量运算符不会更改迭代器，而是更改存储的值。这意味着在`for_each`循环内部，条件在迭代器的增量运算符和函数中都被修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:57:55.553

无论如何，您要达到什么目的……您的班级是否有任何内部存储空间，还是仅代表数字序列？

如果是这样，那么问题出在运算符上`T &operator*()`，`T *operator->()`它们允许更改迭代器指向的值。但如果它只是范围类，它显然不能以这种方式编辑，你应该使用`cons_iterator`.

如果你的类有一个内部存储，那么你的交互器应该有指向它的指针（`T* pData_;`而不是`T pData_;`），然后你不需要删除星号，`T &operator*()` 其中令人惊讶的是已经为正确的版本做好了准备；）关键是 incrementivg 迭代器应该增加这个指针并增加值在你的`add1`函数中应该增加指向值。现在这两个操作都增加了同一个变量，所以你得到了那些`+=2`.

编辑：

@DavidRodríguez-dribeas - 您正在考虑不同的输入迭代器类别，这些类别旨在描述允许的顺序访问（可以访问哪些序列元素）之间的区别，但所描述的问题是`Range`类实例是设计常量（至少不是可以仅使用迭代器进行修改）。我看不出任何反对给予它随机访问类别的东西。

唯一的选择是在任何地方都用 const_iterator 替换迭代器，这样迭代的值就不能被修改。现在这有点违反 ISO C++，它将容器分为几个类别，并且对于它需要的每个类别，`begin()`并且只有在容器本身被声明时才`end()`返回。但是我认为在 ISO C++ 视图中类甚至是容器是有争议的，因为（根据 23.1.1）`const_iterator``const``Range`

> 容器是存储其他对象的对象。它们通过构造函数、析构函数、插入和擦除操作来控制这些对象的分配和释放。

在 Range 类中似乎没有任何实际的迭代对象存储，我认为我们在这里很疯狂，不需要那么遵守标准。

编辑2：

首先`const iterator`是不一样的`const_iterator`。第一个是无法更改的迭代器（指向序列中的不同值，例如递增），另一个允许这样做，但不允许更改指向的值，因此`(*i)=3`会失败。

其次，我会这样做：

```
template <typename T>
class Range {
public: 
    class const_iterator;
    typedef const_iterator iterator; //For stl-compliance - some algorythms use that.

    IntegerRange(T low, T high) : low_(low), high_(high) { assert(low <= high);}
    const_iterator begin() const { return const_iterator(low_); }
    const_iterator end() const { return const_iterator(high_); }
private:
    const T low_;
    const T high_;
};

template<typename T>
class Range<T>::const_iterator : public std::iterator<std::forward_iterator_tag, T>
{
public:

 // default constructor                                                                         
  const_iterator() : pData_(0)
  {
  }

  // constructor from const T&                                                                   
  const_iterator(const T &pData) : pData_(pData)
  {
  }

  // constructor from T&                                                                         
  const_iterator(T &pData) : pData_(pData)
  {
  }

  // operator =                                                                                  
  const_iterator &operator=(const const_iterator &other)
  {
    this->pData_ = other.pData_;
    return *this;
  }

  // pre-increment operator                                                                      
  const_iterator & operator++()
  {
    ++(this->pData_);
    return *this;
  }
  // post-increment operator                                                                     
  const_iterator operator++(int)
  {
    const_iterator temp(*this);
    this->operator++();
    return temp;
  }

  // operator ==                                                                                 
  bool operator==(const const_iterator &other) const
  {
    return this->pData_ == other.pData_;
  }

  // operator !=                                                                                 
  bool operator!=(const iterator &other) const
  {
    return !operator==(other);
  }

  // operator* r-value                                                                           
  const T &operator*() const
  {
    return (this->pData_); // had to remove the *                                                
  }

  // operator-> r-value                                                                          
  const T *operator->() const
  {
    return &(this->pData_);
  }

private:
  T pData_;
}; 
```

只要您遵守 const_iterator 规范，您显然可以自由地保留名称迭代器而不是 const_iterator（或使用 qqwfmnghng 作为类名） - 在这种情况下，不提供左值运算符，因为它们旨在修改指向值 - 什么这有意义吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T03:20:46.303

```
#include <assert.h>     // assert
#include <iterator>     // std::forward_iterator
#include <utility>      // std::pair
#include <stddef.h>     // ptrdiff_t, size_t

typedef size_t          UnsignedSize;
typedef ptrdiff_t       Size;
typedef Size            Index;

template< class TpValue >
class ValueRange
{
public:
    typedef TpValue     Value;

private:
    Value   first_;
    Size    span_;

public:
    class It
        : public std::iterator< std::forward_iterator_tag, Value >
    {
    friend class ValueRange;
    private:
        Value       first_;
        Index       i_;

        It( Value const first, Index const i )
            : first_( first )
            , i_( i )
        {}

    public:
        void operator++()           { ++i_; }
        Value operator*() const     { return first_ + i_; }

        bool operator!=( It const& other ) const
        { assert( first_ == other.first_ );  return (i_ != other.i_); }

        bool operator<( It const& other ) const
        { assert( first_ == other.first_ );  return (i_ < other.i_); }
    };

    Value first() const     { return first_; }
    Value last() const      { return first_ + span_; }

    It begin() const        { return It( first_, 0 ); }
    It end() const          { return It( first_, span_ + 1 ); }

    ValueRange( Value const first, Value const last )
        : first_( first )
        , span_( Size( last - first ) )
    {
        assert( first_ + span_ == last );
    }
};

#include <algorithm>    // std::for_each
#include <iostream>     // std::wcout, std::endl

int main()
{
    using namespace std;

    ValueRange< double > const   r( 1.0, 6.0 );

    for_each( r.begin(), r.end(), []( double x )
    {
        using std::wcout;       // For Visual C++ 10.0.
        wcout << x << " ";
    } );
    wcout << endl;
} 
```

# actionscript-3 - 无法动态实例化我的自定义类

> ID：10770490
> 
> 赞同：1
> 
> 时间：2012-05-26T23:21:52.870
> 
> 标签：actionscript-3, actionscript

我使用以下代码从具有链接名称的库中动态检索和实例化影片剪辑：

```
var className:Class = getDefinitionByName(shortcutsArray[i][0]) as Class;
        var object:Object = new className();
        var mc:MovieClip = MovieClip(object); 
```

它可以工作，但是我现在要做的是实例化我的自定义类。所以我想输入一个字符串，这将是我的类名：“myClass”并动态创建 var mc:myClass = new myClass(); 但就像我说的，上述方法在这种情况下不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T00:11:55.367

确保您已在代码中的某处明确包含该类。如果没有至少一次使用该类的场合，它不会被编译成二进制文件，并且只是一个变量声明。

在没有类的地方，就不可能有动态实例化......有关更多详细信息，请参阅[此博客](http://www.jeffdepascale.com/index.php/flash/dynamically-referencing-classes-getdefinitionbyname/)。

# c++ - 具有多重继承的 C++ LinkedList 模板？

> ID：10770491
> 
> 赞同：0
> 
> 时间：2012-05-26T23:22:01.810
> 
> 标签：c++, templates, multiple-inheritance

我正在尝试创建一个具有多态性和继承自 Stack 和 Queue 头文件的 LinkedList 类。这是我第一次尝试使用模板，但不断收到诸如“类模板已定义”或“不允许抽象类类型”之类的错误。我如何实现模板，因为我显然做错了？

```
// LinkedList.h File
#include "Stack.h"
#include "Queue.h"
#include "Node.h"

using namespace std;

template <typename T>
class LinkedList : public Queue<T>, public Stack<T>
{
public:
    LinkedList();
    ~LinkedList(void);

protected:
    Node<T> *first;
    Node<T> *last;
    int numItems;
};

// LinkedList.cpp File
#include "LinkedList.h"

using namespace std;

template <typename T>
class LinkedList
{
    LinkedList()
    {
        first = NULL;
        last = NULL;
        numItems = 0;
    }

    LinkedList::~LinkedList(void)
    {
        while (first != NULL)
        {
            Node* cur = first;
            first = first->next;
            delete cur;
        }
    }

    LinkedList::clear() {}    
    LinkedList::size() {}

    // Stack Functions
    LinkedList::push(T item) {}    
    LinkedList::pop() {}    
    LinkedList::top() {}

    // Queue Functions
    LinkedList::enqueue(T item) {}    
    LinkedList::dequeue() {}    
    LinkedList::peek() {}
}

// Stack.h File (Queue is the same except push/pop/top = enqueue/dequeue/peek)
#pragma once

template <typename T> class Stack
{

public:

  virtual ~Stack() {}

  virtual int size() = 0;
  virtual void clear() = 0;
  virtual void push(T item) = 0;
  virtual T pop() = 0;
  virtual T top() = 0;

}; 
```

更新代码

```
// LinkedList.h File
#pragma once
#include "Stack.h"
#include "Queue.h"
#include "Node.h"

template <typename T>
class LinkedList : public Queue<T>, public Stack<T>
{
public:
    LinkedList();
    ~LinkedList(void);

    void clear();
    int size();

    void push(T item);
    T pop();
    T top();

    void enqueue(T item);
    T dequeue();
    T peek();

protected:
    Node<T> *first;
    Node<T> *last;
    int numItems;
};

// LinkedList.cpp File
#include "LinkedList.h"

class LinkedList
{
    LinkedList::LinkedList()
    {
        first = NULL;
        last = NULL;
        numItems = 0;
    }

    LinkedList::~LinkedList(void)
    {
        while (first != NULL)
        {
            Node* cur = first;
            first = first->next;
            delete cur;
        }
    }

    LinkedList::clear(){}
    LinkedList::size(){}

    // Stack Functions
    void LinkedList::push(T item){}
    T LinkedList::pop(){}
    T LinkedList::top(){}

    // Queue Functions
    void LinkedList::enqueue(T item){}
    T LinkedList::dequeue(){}
    T LinkedList::peek(){}
}

// Stack.h File (Queue is the same except push/pop/top = enqueue/dequeue/peek)
#pragma once

template <typename T> class Stack
{

public:

  virtual ~Stack() {}

  virtual int size() = 0;
  virtual void clear() = 0;
  virtual void push(T item) = 0;
  virtual T pop() = 0;
  virtual T top() = 0;

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:25:27.583

我懂了

```
// LinkedList.cpp File 
```

模板定义必须在每个翻译单元上可见，您不能将它们的定义放在 cpp 文件中并期望它能够工作（就像它对常规类所做的那样）。所有模板函数的定义都应该出现在头文件中。

此外，编译器错误是正确的。您正在为两个`LinkedList`类编写定义。我假设您正在寻找：

```
LinkedList::LinkedList(){ ... } 
```

# php - 在指定区域外回显的值

> ID：10770492
> 
> 赞同：0
> 
> 时间：2012-05-26T23:22:02.527
> 
> 标签：php, html

我们有一个这样的函数：

```
function getthis($x){
    $dbc = getDBCon();

    if ($dbc) {
        $sql = "SELECT * FROM `names`";
        $res = mysqli_query($dbc, $sql);

        while($data = mysqli_fetch_array($res)){
            SOME PROCESS...
            echo $results; 
        }

        closeDBCon($dbc)
    } 
```

并在页面中：

```
<?php

$get = getthis($x)
echo '<td>'.$get.'</td>';

?> 
```

但它不会`echo`在`<tr>`标签内产生，它们会出现在页面顶部。它可能是`echo`ing 而不是`return`，但是是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:26:32.027

当您运行该函数时，页面会在页面上的请求之前处理函数中的回显请求，因此会回显它，但不返回任何值。

由于您显然想要关闭数据库连接，一个不错的选择是在循环期间将结果存储为变量，然后在关闭连接后返回变量。这样，当您回显 $get 时，它会回显函数返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T23:26:33.540

是的，这就是问题所在。您可以`echo`按正确的顺序：

```
<?php
echo '<td>';
getthis($x);
echo '</td>';
?> 
```

转换为`return`：

```
function getthis($x) {
    $output = '';
    $dbc = getDBCon();

    if($dbc) {
        $sql = "SELECT * FROM `names`";
        $res = mysqli_query($dbc, $sql);

        while($data = mysqli_fetch_array($res)) {
            SOME PROCESS...

            $output .= $results;
        }

        closeDBCon($dbc);
    }

    return $output;
} 
```

或者执行输出缓冲：

```
<?php

ob_start();
getthis($x);
$get = ob_get_contents();
ob_end_clean();

echo '<td>'.$get.'</td>';

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T23:26:37.283

您的函数需要`return`数据，而不是`echo`ing 它。现在你正在调用函数`getthis()`，它在内部打印数据。相反，您希望它返回值，以便您可以控制打印结果的位置：

```
function getthis( $x ) {
    $dbc = getDBCon();
    $response = false; /* Return false if no db connection was made */
    if( $dbc ) {
        $sql = "SELECT * FROM `names`";
        $res = mysqli_query( $dbc, $sql );
        $response = "";
        while( $data = mysqli_fetch_array( $res ) ){ 
            /* SOME PROCESS... */
            $response .= $results; /* Assuming you're returning a string */
        }
    closeDBCon($dbc);
    }
    return $response;
} 
```

在旁注中，我不会在这样的函数中打开和关闭连接。您可能会增加不必要的开销。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-26T23:24:00.577

在函数中回显 td 标记，否则返回 $results

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-26T23:25:33.857

正如您自己所说，`echo`而不是`return`问题所在。`echo`只是在遇到该方法时准确地打印到屏幕上。一个可能的解决方案是在`$output`整个 while 循环中将结果累积到一个变量中。完成后，返回`$output`.

```
function getthis($x){
    $dbc = getDBCon();
    $output = "";
    if($dbc) {
        $sql = "SELECT * FROM `names`";
        $res = mysqli_query($dbc, $sql);
        while($data = mysqli_fetch_array($res)){
            // SOME PROCESS...
            $output .= $results;
        }
        closeDBCon($dbc);
    }
    return $output;
} 
```

# scheme - 这个功能给我“程序内存不足”？

> ID：10770496
> 
> 赞同：1
> 
> 时间：2012-05-26T23:22:48.830
> 
> 标签：scheme, racket

我写了一个名为的函数`(element-at x k)`，它有两个参数：一个 list`x`和一个 number `k`。它返回列表的第 K 个元素。

例如，表达式`(element-at '(a b c d) 3)`返回`c`. 然后是一个被调用的函数`(remove-at x y)`，它有两个参数：一个列表`x`和一个数字`k`。它从列表中删除第 K 个元素。例如，表达式`(remove-at '(a b c d) 3)`返回`(a b d)`.

在`(remove-at x y)`我使用了该功能`(element-at x k)`但该功能`(remove-at x y)`不起作用的定义中，Dr.racket 给我“程序内存不足”，任何人都可以知道原因并尽快修复它吗？

```
(define (element-at lis k) (if (null? lis) (if (> k 0) #f '()) (let ((head (car lis)) (tail (cdr lis))) (if (< k 2) head (element-at tail (- k 1))))))

(define (remove-at x y) (let ((first (element-at x y)) (tail x)) (if (equal? (car x) first) (append (remove-at x y) (cdr tail)) (cdr tail)))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T02:05:53.237

首先，如果安排得当，您的代码将显示为

```
(define (element-at lis k)
  (if (null? lis)
      (if (> k 0) #f '())
      (let ((head (car lis))
            (tail (cdr lis)))
        (if (< k 2)
            head
            (element-at tail (- k 1))))))

(define (remove-at x y)
  (let ((first (element-at x y))
        (tail x))
    (if (equal? (car x) first)
        (append (remove-at x y) (cdr tail))
        (cdr tail)))) 
```

你为什么用`element-at`分配`first`in `remove-at`？为什么要分配`tail`给传入的完整列表？正如所写的那样，即使它没有给您带来内存错误，`(remove-at '(a b c d e f c d) 7)`也要考虑会返回什么，因为您决定要删除哪个元素。

如前所述，既然你在做`(append (remove-at x y) (cdr tail))`，你的列表和数字实际上永远不会变小。您编写了一个不接近结果的递归。结果，将`remove-at`永远自转，自转`append`（除非碰巧最初`x`是自转）。`cdr``(car x)``equal?``(element-at x y)`

我认为这是一项家庭作业，所以我只指出了你的错误并将修复它们作为练习。如果不是这种情况，请告诉我，以便我们查看工作版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T17:54:33.717

这有效

```
(define (element-at lis k) 
   ( if(null? lis)
       (if(> k 0) #f '()) 
       ( let( (head (car lis))(tail (cdr lis)) ) 
       (if(< k 2) head (element-at tail (- k 1 )))) ) )

(define (remove-at x y)
   (let ((first (element-at x y))
        (tail x))
    (if (equal? (car x) first)
        (cdr tail)
        (cons (car x) (remove-at (cdr tail) (- y 1)))))) 
```

(remove-at (list 'a 'b 'c 'd) 3) 返回 '(abd)。但我可以说，这可能是一个非常糟糕的实现这样一个简单的要求。是不是为了更深入地理解if条件而特意写成这样的？这是一个没有使用辅助功能的简化代码。警告：- 在上述函数中，如果您输入 (remove-at (list 'a 'b 'c 'd) 5)，它会给出错误而不是预期的“假”。这是一个更简单的实现：

```
(define (remove-at2 x y)
  (local ((define (remove x y ans-lst)
            (cond ((null? x)
                  (if (> y 0) #f
                      ans-lst))
                  ((= y 1) (append ans-lst (cdr x)))
                  (else
                    (remove (cdr x) (- y 1) (append ans-lst (list (car x))))))))
    (remove x y '()))) 
```

(remove-at2 (list 'a 'b 'c 'd) 5) 返回错误。(remove-at2 (list 'a 'b 'c 'd) 3) 返回 '(abd)

# mysql - MySQL 嵌套集地理树

> ID：10770497
> 
> 赞同：1
> 
> 时间：2012-05-26T23:22:48.520
> 
> 标签：mysql, nested-sets

晚上，

我有一个嵌套的设置表，其中包含大约 14,000 个位置：

```
placeId        name        type        lft        rgt
1              England     Cty         1          22878
2              Bedfords.   Co          2          259
3              Ampthill    AP          3          4 
```

我有三个国家 (Cty)、88 个县 (Co)，每个县都有儿童定居点（AP、EP、Ch 和 Unk）。类型列有效地告诉您深度。

城市 = 0

钴 = 1

AP、EP、Ch 或 Unk = 2

但是，稍后我将添加更多具有不同深度的国家，例如美国：

城市 = 0

圣 = 1

钴 = 2

城镇/城市 = 3

我想要的是一个查询，它将根据在站点上查看的位置将我拉出所有兄弟节点和所有子节点的深度为 1。

因此，如果正在查看英格兰，我想得到：

```
England
**Bedfordshire
**Berkshire
**Buckinghamshire
***More Counties*
Scotland
Wales 
```

如果选择贝德福德郡，我想得到：

```
England
**Bedfordshire
****Ampthill
****Arlesey
****Aspley Guise
*****More Towns*
**Berkshire
**Buckinghamshire
***More Counties*
Scotland
Wales 
```

虽然我开始构建的查询花费了 30 多秒，并且没有做我想做的所有事情，所以没有必要再进一步了。

我可以通过在大约 100 毫秒内为每个深度运行一个查询来获得我想要的结果，但如果可能的话，我更喜欢单个查询和最少的 PHP 使用。

有任何想法吗？

提前致谢。

这是我能想到的最好的：

```
(
SELECT parent.name, parent.lft, parent.rgt,
(
CASE
WHEN parent.type = 'Co' THEN 1
WHEN parent.type IN( 'AP', 'EP', 'Ch','Unk' ) THEN 2
END
) AS depth
FROM places AS node, places AS parent
WHERE ( parent.lft BETWEEN node.lft AND node.rgt AND ( node.placeId IN( 1, 7553) ) AND ( parent.lft BETWEEN node.lft AND node.rgt ) )
ORDER BY parent.name
)
UNION
(
SELECT name, lft, rgt, 0 AS depth FROM places WHERE type = 'Cty'
)
ORDER BY lft 
```

唯一的问题是我无法在保持 lft-rgt 顺序的同时按字母顺序将其取出。现在表格已经按字母顺序排列，但是当我添加其他地方时，情况会改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T07:07:19.540

我认为嵌套集是不可能的。信息不够。也许您可以通过空间索引或四叉树获得更好的运气。当您有一个四键并且想要查询英格兰的所有县时，您可以在四键中从左到右搜索所有缩放级别。因此，您可以通过仅查询 2 个缩放级别来查询 2 个深度。但通常你会从一个分支获得所有级别。我不确定您是否可以按字典顺序对结果进行排序，但是使用空间索引可以将 4 个方向添加到索引中。这是一篇关于碰撞检测和四叉树的博客：lab.polygonal.de/?p=202。

# matlab - 每列选择单独的行

> ID：10770499
> 
> 赞同：4
> 
> 时间：2012-05-26T23:23:19.653
> 
> 标签：matlab, octave

说

```
X = [1 2;
     3 4];
c = [1 2]'; 
```

我想找到一些方法来做我认为`X(:,c)`应该做的事情。将其编写为 for 循环：

```
for i=1:n
   res(i) = X(i, c(i));
end
% res = [1 4] 
```

是否有一个单一的语句/矢量化方式来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-26T23:26:15.383

`diag(X(:,c))`应该做的伎俩

说明：一个（稍微复杂一点的）例子将有助于理解。

```
>>X = [1 2; 3 4; 5 6; 7 8]

X =

     1     2
     3     4
     5     6
     7     8

>> c = [1 1 2 1];
>> R = X(:,c)

R =

     1     1     2     1
     3     3     4     3
     5     5     6     5
     7     7     8     7 
```

那么这里发生了什么？对于 vector 中的每个元素`c`，您从原始矩阵中选择一列`X`：对于 的第一列`R`，使用 的第一列`X`。对于 的第二列`R`，使用`X`（再次）的第一列。对于 的第三列`R`，使用`X`... 的第二列，依此类推。

这样做的效果是您感兴趣的元素（在 中定义`c`）位于矩阵的对角线上`R`。使用以下方法获取对角线`diag`：

```
>>diag(R)

ans =

1
3
6
7 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-26T23:56:14.333

使用[sub2ind](http://www.mathworks.nl/help/techdoc/ref/sub2ind.html)转换为[线性索引](http://www.mathworks.nl/company/newsletters/articles/Matrix-Indexing-in-MATLAB/matrix.html)

```
X = [1 2;
     3 4];
c = [1 2]';

idx = sub2ind(size(X),1:numel(c),c(:)');
res = X(idx); 
```

（我曾经`c(:)'`得到`c`正确的尺寸。）

结果：

```
res =

 1     4 
```

# java - 找到一个模式，这样我就可以通过不重复计算来改进排列算法

> ID：10770505
> 
> 赞同：2
> 
> 时间：2012-05-26T23:24:13.993
> 
> 标签：java, algorithm

这是我的问题的一些背景（不是家庭作业）。我在杂货店有 4 种物品可供选择，我想弄清楚我的购物篮中每种物品的百分比，但我设置了一个范围，即任何物品都不能低于 20% 且不超过 60%。该程序当前从 0 开始并向上运行（在这种情况下，0 是最小值 20，高于它的任何值都等于它是最小值的百分比）。使用上面最小值为 20 的示例，那么 [`20,0,0,0]`将等于 40 + 20 + 20 + 20 = 100 并为所有项目生成排列。

运行后，我意识到（使用上面的例子）第一项是`[20,0,0,0]`，最后一项是`[0,0,0,20]`。我通过将所有结果与自身的反向版本进行比较来测试它，它们都存在，所以我想我可以找到一种方法，通过只处理一半列表然后获取结果并将它们翻转过来，将我的处理时间缩短一半。当我开始检查反向匹配时，我遇到了一个问题，而程序仍在生成结果，似乎没有一个点可以翻转并开始复制（我希望它正好在一半时会这样做）。这是[结果的输出](http://pastebin.com/6vXRvVit)，第一列是结果本身，第二列是它的反转版本的索引（-1 表示未找到）。它从全 -1 开始，然后开始找到一些反向匹配，但仍然有许多 -1，然后它最终过渡到所有重复的结果，但它似乎以可预测的清晰方式进行。

我的最终目标是使用更大的列表，并且我试图找到一种方法来生成尽可能多的数据，因此任何关于如何识别模式或其他速度改进的建议都会很棒。我在想，在这种情况下，我要么需要一种方法来识别模式一旦完全开发（即不再有机会`-1`），要么调整算法以便它以完全切换而不是缓慢的部分变化的顺序生成。

如果有帮助，这是我正在使用的代码（注意：项目和范围的数量是变量，所以我试图找到一个通用模式，而不是特定于任何硬数字）：

```
import java.util.*;

public class Distributor {
    //correct output is 1771
    private ArrayList<int[]> result =  new ArrayList <int[]> ();
    /*

    */
    public Distributor (final String [] names, int [] low, int [] high) 
    {
        final int rest = 100;
        int minimum = 0;
            for (int l : low)
                minimum += l; 
        int [] sizes = new int [names.length];
        distribute (0, low, high, rest - minimum, sizes);
        System.out.println ("total size of results are " + result.size ());
    }

    public static void main (String [] args) {
        System.out.println("starting..Hold on!!");
        final String [] names = new String [] {"a", "b", "c", "d"}; //name of items
        int [] low = new int [names.length];
        int [] high = new int [names.length];
        Arrays.fill(low, 20); //auto fill the range of items with a min/max range
        Arrays.fill(high, 60);
        new Distributor (names, low, high);
    }

    /*
        distribute the rest of values over the elements in sizes, beginning with index i.           
    */
    void distribute (int i, int [] low, int [] high, final int rest, int [] sizes) {  
        if (i == sizes.length - 1) { //this area procesess the final item and adds it to the solution queue
            if (rest < high [i]) {
                sizes[i] = rest; 
                checkResultsDuringRuntime(Arrays.copyOf (sizes, sizes.length),result);
                result.add (Arrays.copyOf (sizes, sizes.length));
            }
        }
        else {
            int StartLoop = 0;
            //this area checks if the remaining value can be reached used the max values of remaining items
            //if its not possible then the current min range of the loop must be increased
            if ( rest > (low.length-(i + 1))*high[i]) {
                System.out.println("rest is higher than high");
                StartLoop = (rest - (low.length-(i + 1))*high[i]);
            }
            //this area runs a loop for each coeffient and then sends it back to this function to further processing
            for (int c = StartLoop; 
                c <= java.lang.Math.min (high [i] - low [i], rest); 
                ++c) {  
                sizes [i] = c;
                    distribute (i + 1, low, high, rest - c, sizes);                 
            }
        }
    }

    private static void checkResultsDuringRuntime(int[] defaultlist, ArrayList<int[]> result2) {
        //check results list for list
        //first lets flip the list around
        int[] ReversedList = new int[defaultlist.length];
        for (int x = defaultlist.length-1, y=0; x>=0;x--, y++) {
            ReversedList[y] = defaultlist[x];
        }       
        int MatchLocation = -1;
        for (int[] item : result2) {
            if ( Arrays.toString(item).equals(Arrays.toString(ReversedList)))
            {   
                //System.out.println("theres a match");
                MatchLocation = result2.indexOf(item);
            }
        }
        System.out.println(Arrays.toString(defaultlist) + " = " + MatchLocation);
    }
} 
```

输出： http: [//pastebin.com/6vXRvVit](http://pastebin.com/6vXRvVit)

编辑：该程序不会生成重复项。它的产生似乎最终会逆转。我想尝试捕获反向排列将全部匹配现有结果的点，因此我无需进一步处理数据，而是可以反转现有结果。查看上面的输出以了解我所描述的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:35:34.213

我不完全理解这个问题，但有一个解决类似问题的技巧。假设你想生成 3 个从 1 到 6 的数字，例如 [1, 4, 2]，但你想忽略 dups；即 [1,2,3] = [3,2,1]

就是这样：

```
for(int i=1; i <= 6; i++) {
    for(int j=i+1; j <= 6; j++) {
        for(int k=j+1; k <= 6; k++) {
            System.out.println(i+","+j+","+k);
            }
        }
    } 
```

输出将包括所有可能性，但没有重复的排列。

编辑 - 这是输出......

```
1,2,3
1,2,4
1,2,5
1,2,6
1,3,4
1,3,5
1,3,6
1,4,5
1,4,6
1,5,6
2,3,4
2,3,5
2,3,6
2,4,5
2,4,6
2,5,6
3,4,5
3,4,6
3,5,6
4,5,6 
```

编辑 2 - 对于 OP 的问题，其中有 4 个项目的限制为 20 和 60，有 101,270 个排列。假设整数百分比是可以接受的。也就是说，25%，而不是 25.1%

编辑 3 - 是的，这个很有趣。OP说百分比必须加起来为100。我错过了。有 108 种可能性。他们是：

```
1 : [20,20,20,40]
2 : [20,20,21,39]
3 : [20,20,22,38]
4 : [20,20,23,37]
5 : [20,20,24,36]
6 : [20,20,25,35]
7 : [20,20,26,34]
8 : [20,20,27,33]
9 : [20,20,28,32]
10 : [20,20,29,31]
11 : [20,20,30,30]
12 : [20,21,21,38]
13 : [20,21,22,37]
14 : [20,21,23,36]
15 : [20,21,24,35]
16 : [20,21,25,34]
17 : [20,21,26,33]
18 : [20,21,27,32]
19 : [20,21,28,31]
20 : [20,21,29,30]
21 : [20,22,22,36]
22 : [20,22,23,35]
23 : [20,22,24,34]
24 : [20,22,25,33]
25 : [20,22,26,32]
26 : [20,22,27,31]
27 : [20,22,28,30]
28 : [20,22,29,29]
29 : [20,23,23,34]
30 : [20,23,24,33]
31 : [20,23,25,32]
32 : [20,23,26,31]
33 : [20,23,27,30]
34 : [20,23,28,29]
35 : [20,24,24,32]
36 : [20,24,25,31]
37 : [20,24,26,30]
38 : [20,24,27,29]
39 : [20,24,28,28]
40 : [20,25,25,30]
41 : [20,25,26,29]
42 : [20,25,27,28]
43 : [20,26,26,28]
44 : [20,26,27,27]
45 : [21,21,21,37]
46 : [21,21,22,36]
47 : [21,21,23,35]
48 : [21,21,24,34]
49 : [21,21,25,33]
50 : [21,21,26,32]
51 : [21,21,27,31]
52 : [21,21,28,30]
53 : [21,21,29,29]
54 : [21,22,22,35]
55 : [21,22,23,34]
56 : [21,22,24,33]
57 : [21,22,25,32]
58 : [21,22,26,31]
59 : [21,22,27,30]
60 : [21,22,28,29]
61 : [21,23,23,33]
62 : [21,23,24,32]
63 : [21,23,25,31]
64 : [21,23,26,30]
65 : [21,23,27,29]
66 : [21,23,28,28]
67 : [21,24,24,31]
68 : [21,24,25,30]
69 : [21,24,26,29]
70 : [21,24,27,28]
71 : [21,25,25,29]
72 : [21,25,26,28]
73 : [21,25,27,27]
74 : [21,26,26,27]
75 : [22,22,22,34]
76 : [22,22,23,33]
77 : [22,22,24,32]
78 : [22,22,25,31]
79 : [22,22,26,30]
80 : [22,22,27,29]
81 : [22,22,28,28]
82 : [22,23,23,32]
83 : [22,23,24,31]
84 : [22,23,25,30]
85 : [22,23,26,29]
86 : [22,23,27,28]
87 : [22,24,24,30]
88 : [22,24,25,29]
89 : [22,24,26,28]
90 : [22,24,27,27]
91 : [22,25,25,28]
92 : [22,25,26,27]
93 : [22,26,26,26]
94 : [23,23,23,31]
95 : [23,23,24,30]
96 : [23,23,25,29]
97 : [23,23,26,28]
98 : [23,23,27,27]
99 : [23,24,24,29]
100 : [23,24,25,28]
101 : [23,24,26,27]
102 : [23,25,25,27]
103 : [23,25,26,26]
104 : [24,24,24,28]
105 : [24,24,25,27]
106 : [24,24,26,26]
107 : [24,25,25,26]
108 : [25,25,25,25] 
```

我们注意到 60 的上限太大了——在最小值 20% 时无法添加其他三个项目。那将是 120%。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:31:28.357

我建议使用[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filter) ，它可以保证不会出现误报：

假阳性是可能的，但假阴性是不可能的；即查询返回“在集合内（可能是错误的）”或“绝对不在集合内”

Java[实现](https://stackoverflow.com/questions/4546447/bloom-filter-implementation)

[源代码](https://svn.apache.org/repos/asf/accumulo/trunk/core/src/main/java/org/apache/accumulo/core/bloomfilter/DynamicBloomFilter.java)

现在当然问题是比较数组是否相等，我建议您执行以下操作：

```
Arrays.sort(arrayToCompare);  
Arrays.equals(initialArray,arrayToCompare); 
```

您承担了排序的开销，但它会告诉您两个数组是否相等，因此之前的布隆过滤器就足够了。

# javascript - 使用事件监听器 EXTJS 覆盖按钮类

> ID：10770510
> 
> 赞同：0
> 
> 时间：2012-05-26T23:25:16.540
> 
> 标签：javascript, extjs, dom-events, extjs4.1

我正在使用 EXTJS 4 并使用 Button 类。有了它，我无法访问 dblclick 事件侦听器。有没有办法可以将此侦听器作为属性添加到按钮类？

```
Ext.define('MemOS.controller.Icon', {
    extend: 'Ext.app.Controller',

    models: ['Icon'],
    stores: ['Icons'],
    views: ['Icon'],
    refs: [{
        ref: 'icon',
        selector: 'icon'
    }],

    init: function () {
        this.control({          
            icon: {
                click: function(c) {
                    Ext.create('MemOS.view.Window', {
                        title: 'Project',
                        items: [{
                            xtype: 'projectsgrid'
                        }]
                    }).show();
                }
            }
        });
    },
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T03:24:32.360

您可以使用 clickEvent 属性：[http ://docs.sencha.com/ext-js/4-1/#!/api/Ext.button.Button-cfg-clickEvent](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.button.Button-cfg-clickEvent)

# oauth - 使用 OAuth 的 POST 请求

> ID：10770513
> 
> 赞同：0
> 
> 时间：2012-05-26T23:25:31.740
> 
> 标签：oauth

我想知道 OAuth 签名仅与 URL 相关还是与使用 POST 协议时发布数据中的某些内容相关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T23:34:39.730

实际参数在规范中定义为签名基字符串： [https ://www.rfc-editor.org/rfc/rfc5849#section-3.4.1](https://www.rfc-editor.org/rfc/rfc5849#section-3.4.1)

仅当满足第 3.4.1.3.1 节中的条件时才包含 POST 正文：

```
 *  The entity-body is single-part.

  *  The entity-body follows the encoding requirements of the
     "application/x-www-form-urlencoded" content-type as defined by
     [W3C.REC-html40-19980424].

  *  The HTTP request entity-header includes the "Content-Type"
     header field set to "application/x-www-form-urlencoded". 
```

换句话说，如果您要发布 XML 或 JSON 数据，则不包括参数。但是，如果它是基本形式的编码数据，它可能是。

# c++ - 在对象的构造函数中声明对象数组？

> ID：10770515
> 
> 赞同：0
> 
> 时间：2012-05-26T23:25:34.860
> 
> 标签：c++

如果我有一个类 MyClass，我可以在 MyClass 的构造函数中在堆上声明一个 MyClass 数组吗？

我可以在 C# 中执行此操作，但在 C++ 中似乎不喜欢它？

我还收到关于 MyClass 类型没有合适的构造函数的错误？

```
class MyClass
{
    public:
        MyClass(int);
    private
        MyClass* array;
};

MyClass::MyClass(int size){
    array = new MyClass[size];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T23:27:38.330

为了有一个数组，所说的东西必须是*default-constructible*。你`MyClass`不是，因为它需要`int`构建。

C# 的作用类似于：

```
MyClass** array = new MyClass*[size]; 
```

其中指针是默认可构造的，因此是允许的。基本上，无论何时你`SomeObject`在 C# 中执行它都相当于`SomeObject*`在 C++ 中。除了代码效率极低，甚至比 C# 对应的代码还要糟糕，而且到处都会出现泄漏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-26T23:49:30.897

与如何构造数组相比，您的方法存在更基本的问题。

这样想：

```
class A
{
   A* a;
public:
   A();
};
A::A()
{
   a = new A();
} 
```

发生什么了？您尝试创建一个`A`; 在构造函数中，`new A`创建了 a。在*该*构造函数中，`new A`创建了另一个...

砰，内存不足。

# php - 从 PHP 函数中获取特定值

> ID：10770522
> 
> 赞同：0
> 
> 时间：2012-05-26T23:27:16.363
> 
> 标签：php, function

我知道下面的 PHP 代码是不正确的，但我想知道如何实现这个想法。

```
function A(){
    $a = 'Hello';
    $b = 'World';
    $c = $a.' '.$b;
    echo 'blah blah blah times 1,000';

    function B($c){
        return $c;
    }
}
echo function B(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T23:35:27.610

有几种方法。这是最简单的：

```
function B($c){
    return $c;
}

function A(){
    $a = 'Hello';
    $b = 'World';
    $c = $a.' '.$b;
    echo 'blah blah blah times 1,000';
    B($c);
}

}
echo B(); 
```

但鉴于这`B`无济于事，您可以选择：

```
function A(){
    $a = 'Hello';
    $b = 'World';
    $c = $a.' '.$b;
    echo 'blah blah blah times 1,000';
    return $c;
}

echo A(); 
```

我怀疑您想在函数之间交换值以获得更大的输出。为此，您应该研究面向对象的编程，PHP 正在尽力追赶。

## 面向对象的方法：

```
Class ChatterBox {

   public function sayHello() {
        $a = 'Hello';
        $b = 'World';
        $c = $a.' '.$b;        
        return $c 
    }

    public function rambleOn() {

       echo 'blah blah blah times 1,000';

     }

}

$small_talk = new ChatterBox();

echo $small_talk -> sayHello(); // Hello World!

$small_talk -> rambleOn() // 'blah blah blah times 1,000'; 
```

您获得的好处不仅是拥有一个具有多个函数（方法）的变量，而且在一个对类全局的方法中设置一个值可以被其他方法访问，因此假设您想始终包含您的姓名，您可以再进一步：

```
Class ChatterBox {

  function __construct($name) {
        $this -> name = (!empty($name)) ? $name : 'Mysterion';
  }

   public function set_intro() {

        $this -> intro = "My name is " . $this ->name . ".";

    }

   public function sayHello() {
        $a = 'Hello';
        $b = 'World';
        $c = $a.' '.$b;
        return $c . $this -> set_intro();
    }

    public function rambleOn() {

       echo $this -> intro . 'blah blah blah times 1,000';

     }

}

$small_talk = new ChatterBox("Rick");

echo $small_talk -> sayHello(); // Hello World! My name is Rick.

$small_talk -> rambleOn() // 'My name is Rick. blah blah blah times 1,000'; 
```

当然，OOP 变得更加复杂（正如我之前所说，PHP 仍在迎头赶上），但作为初学者，我认为将所有函数捆绑在一起并能够共享变量等是很整洁的。也许是 lambda 函数是事情的发展方式，但由于我仍然掌握 OOP 的窍门，我认为最好同时涉足这两种情况，而不是选择哪一个是“最好的”。特别是因为在您的示例中，lambda（匿名）函数（对我来说）为什么一个函数位于另一个函数内部并没有真正意义。在 OOP 中，这是有道理的，因为您可能有不同的选项/选择/等要根据上下文调用，同时又不想丢失对象中的数据或必须在函数之间来回传递值当它们将在整个对象中使用时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T23:29:45.037

如果你有 PHP 5.3 或更高版本，使用匿名函数很容易：

```
function A() {
    global $B;

    $a = 'Hello';
    $b = 'World';
    $c = $a.' '.$b;
    echo 'blah blah blah times 1,000';

    $B = function() use ($c) {
        return $c;
    };
}

A(); // blah blah blah times 1,000
echo $B(); // Hello World 
```

如果没有，您可以使用[`create_function`](http://php.net/create_function).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T23:32:59.747

您的脚本的工作方式，默认情况下未定义 B。当您调用函数 A 时，B 将被定义为脚本的其余部分。例如：

```
echo B('blah'); // Returns a 'function doesn't exist' error

A();
echo B('blah'); //Echos 'blah', as B is now defined. 
```

# iphone - 向 Facebook 和 Google+ 好友发送邀请

> ID：10770527
> 
> 赞同：0
> 
> 时间：2012-05-26T23:28:12.500
> 
> 标签：iphone, ios, facebook, google-plus

我想允许用户为他们的 Facebook 和 Google+ 朋友发送邀请。

目前我有两个解决方案

1.  在用户的墙上分享他的邀请
2.  使用 Facebook 或 Google+ 邮件发送邀请

这样做的最佳方式是什么？有没有人有比上述两个解决方案更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-21T22:24:14.453

您应该查看带有“INVITE”号召性用语标签的 Google+ 交互式帖子。

*   [功能概述](https://developers.google.com/+/features/interactive-posts)
*   [在 iOS 上分享互动帖子](https://developers.google.com/+/mobile/ios/share#adding_interactive_posts)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T00:42:28.273

为了完成您想做的事情，请使用 Graph API。这很简单，只需参考此 URL [http://developers.facebook.com/docs/reference/api/上的发布部分](http://developers.facebook.com/docs/reference/api/)

您需要在您的应用程序中进行一些准备工作，以允许您的用户进行身份验证并授权您的应用程序代表他们发布。不过这很简单。

如果您正在寻找一种更先进的方式在 Facebook 上传播您的应用程序，“社交应用程序发现”是实现此目的的最新方式。您将能够在墙上直接显示链接，如果用户安装了您的应用程序，则可以将其带到应用程序商店进行下载（全部由 Facebook 处理）。在这里阅读它 [https://developers.facebook.com/blog/post/2012/02/21/improving-app-distribution-on-ios/](https://developers.facebook.com/blog/post/2012/02/21/improving-app-distribution-on-ios/)

# objective-c - MKAnnotationView 帧大小在缩放之前不会更新 MapView

> ID：10770528
> 
> 赞同：3
> 
> 时间：2012-05-26T23:28:18.273
> 
> 标签：objective-c, ios, mkannotation, mkannotationview

我正在尝试使用内部自定义按钮实现自定义 MKAnnotationView。我不想使用 MKAnnotation 的标注属性，因为无法访问该视图的框架。相反，我使用 MKAnnotationView 视图来添加我的 UIView，其中包含我的自定义标注气泡。一切正常，即使是触摸也被按钮捕获。唯一的问题是调整 MKAnnotationView 框架的大小。我可以`(void)setSelected:(BOOL)selected animated:(BOOL)animated`在我的自定义 MKAnnotationView 中的子类 MKAnnotationView 的方法中做到这一点，但是当调整大小的视图应该显示在 MapView 上时，这只能通过放大或缩小地图来实现。我尝试过传递诸如`needsLayout`and之类的东西，`needsDisplay`但没有成功。

我究竟做错了什么？MapView在放大和缩小时调用的方法是什么，所以我可以调用它来刷新自定义的MKAnnotationView框架？

下面是我创建的 CustomMKAnnotationView 类的一些代码：

```
- (void)setSelected:(BOOL)selected animated:(BOOL)animated{

[super setSelected:selected animated:animated];

if (selected) { 
     self.frame = CGRectMake(0, 0, 170, 66);
     self.backgroundColor = [UIColor lightTextColor];
     self.centerOffset = CGPointMake(54.5, -33);
     self.image = nil;
     [self createBubble];
     [self animateIn];
     [self addSubview:bubbleView];
}else{
     [bubbleView removeFromSuperview];
     self.frame = CGRectMake(0, 0, 13, 17);
     self.centerOffset = CGPointMake(0, 0);
}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:23:30.410

我已经设法让事情正常进行。我很确定我还没有找到完美的方法来做到这一点，但它符合我的需求，最终并没有影响用户体验。

我发现框架实际上已添加到视图中，但正如我所说的那样`frame origin`，`0,0`视图已添加到我正在检查的缩放位置之外。

在注意到我注意到我能够将 更改为`frame`我想要自定义气泡的正确位置之后。但是当我放大或缩小时，`frame`重新定位到不同的位置。事实证明该`centerOffset`属性正在这样做，因此我必须匹配`frame`和`centerOffset`属性以使它们指向屏幕上完全相同的点，结果非常令人满意。用户体验是流动的。

`MKAnnotationView`这是我创建的子类下的代码：

```
- (void)setSelected:(BOOL)selected animated:(BOOL)animated{
[super setSelected:selected animated:animated];

if (selected) {

    //here's the trick: setting the frame to a new position and with different size.
    //as the bubble view is added here and matching that point in view with the
    //centerOffset position. The result looks doesn't affect user experience.
    CGRect frame;
    frame = self.frame;
    frame.size = CGSizeMake(170, 66);
    frame.origin = CGPointMake((self.frame.origin.x)-16.5,(self.frame.origin.y)-49);
    self.frame = frame;
    self.centerOffset = CGPointMake(61, -24.5);

    //remove the pin image from the view as the bubble view will be added
    self.image = nil;

    [self createBubble];
    [self animateIn];
    [self addSubview:bubbleView];

}else {

    [bubbleView removeFromSuperview];

    //reset the center offset and the frame for the AnnotationView to reinsert the pin image
    self.centerOffset = CGPointMake(0, 0);
    CGRect frame;
    frame = self.frame;
    //this is the size of my pins image
    frame.size = CGSizeMake(14, 17);
    frame.origin = CGPointMake((self.frame.origin.x)+16.5 ,(self.frame.origin.y)+49);
    self.frame = frame;

    //discover whats the point view image (I have different pin colors here)
    UIImage *pointImage = [[UIImage alloc] init];

    if ([flagStyle isEqualToString:@"friends"]) {

        pointImage = [UIImage imageNamed:@"point_f.png"];

    }else if([flagStyle isEqualToString:@"world"]){

        pointImage = [UIImage imageNamed:@"point_w.png"];        

    }else if([flagStyle isEqualToString:@"my"]){

        pointImage = [UIImage imageNamed:@"point_m.png"];        

    }

    self.image = pointImage;

}

} 
```

我一直在寻找一种解决方案来创建一个带有标注气泡的自定义 MKAnnotationView，其中有一个按钮，但我无法在互联网上找到任何适合我需要的东西。此解决方案有效。这不是完美的实现，但可以完成工作。我希望能帮助某人。

# java - Android：选定微调器更改的事件

> ID：10770531
> 
> 赞同：0
> 
> 时间：2012-05-26T23:28:34.647
> 
> 标签：java, android, spinner

我的视图顶部的微调器中有三个项目。假设这三个微调项目是城市 A、城市 B 和城市 C。

我有包含 2 个选项卡主机的选项卡活动。第一个选项卡主机包含列表视图，第二个选项卡主机包含日历的网格视图。

列表视图包含有关我从服务器检索到的特定城市的详细信息。如果我按下微调器并选择城市 B，那么我应该使用有关城市 B 的详细信息更新我的列表视图。日历的网格视图之一。

问题是如何获取选定微调器项目的按下事件，以便我可以启动新的选项卡活动并更新列表视图。

我试过在里面开始活动`spinner.setOnItemSelectedListener`，但它给了我一个没有结束的循环。我试过在里面开始活动`spinner.setOnItemClickListener`，但`spinner`还不支持。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-27T01:26:58.643

您可以像这样使用 ChangeEvent 事件：

```
private void init()
{
    spinner = new javax.swing.JSpinner();

    spinner.addChangeListener(new javax.swing.event.ChangeListener()
    {
        public void stateChanged(javax.swing.event.ChangeEvent evt)
        {
            spinnerChange(evt);
        }
    });
}

private void spinnerChange(javax.swing.event.ChangeEvent evt)
{
    // Code for what to do when the spinner is changed
} 
```

# javascript - 如何运行 Javascript 单元测试？

> ID：10770533
> 
> 赞同：1
> 
> 时间：2012-05-26T23:29:21.237
> 
> 标签：javascript, unit-testing

我有一些 *.js 应该是单元测试。我不确定如何调用它们。

```
describe('test123', function() {
        blah blah blah;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T23:45:47.417

这似乎是茉莉花。如果是这种情况，您可以在[http://pivotal.github.com/jasmine/](http://pivotal.github.com/jasmine/)了解更多信息，并且可以使用 SpecRunner 调用它们。您可以在此处在线查看一个简单的项目示例：[https](https://github.com/pivotal/jasmine/wiki/A-simple-project) ://github.com/pivotal/jasmine/wiki/A-simple-project 。

# java - 是否有任何方法可以在 servlet 中获取码头上所有有效的会话键值？

> ID：10770535
> 
> 赞同：2
> 
> 时间：2012-05-26T23:29:38.803
> 
> 标签：java, session, servlets, jetty, session-variables

我有一个带有两个不同 servlet 的码头容器，然后调用 A 和 B。在特殊情况下，servlet A（用户已经登录并正在使用他的桌面）和用户使用他的移动设备出现二维码阅读此二维码并在其移动设备上重定向 servlet B。这里的问题是我不能保持他的会话。

二维码带来了用户会话密钥，但是我无法验证此会话是否有效。我想知道是否有任何特殊方法可以在码头上请求有效的会话密钥，因为两个 servlet 都在同一个服务器中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-27T16:37:23.693

那么我找到的最好的解决方案是建立一个 HttpSessionListener :) 我们必须重写一些方法：

```
public class HttpSessionCollector implements HttpSessionListener {
private static final Map<String, HttpSession> sessions = new HashMap<String, HttpSession>();

@Override
public void sessionCreated(HttpSessionEvent event) {
    HttpSession session = event.getSession();
    sessions.put(session.getId(), session);
}

@Override
public void sessionDestroyed(HttpSessionEvent event) {
    sessions.remove(event.getSession().getId());
}

public static HttpSession find(String sessionId) {
    return sessions.get(sessionId);
}

public static Map<String, HttpSession> getSessions() {
    return sessions;
} 
```

}

然后在 /WEB-INF/web.xml 上设置监听器

```
<web-app>
  <listener>
    <listener-class>[yourpack].HttpSessionCollector</listener-class>
  </listener>
...
</web-app> 
```

现在我们可以在包内的任何地方调用 HttpSessionCollector。例如，要获得所有有效会话，我们只需：

```
private Map<String, HttpSession> sessions;
sessions=HttpSessionCollector.getSessions(); 
```

# java - 检查对象是否在Java中有方法？

> ID：10770539
> 
> 赞同：5
> 
> 时间：2012-05-26T23:30:10.980
> 
> 标签：java, android, reflection, methods

我对 Java 的经验并不是很丰富，我现在知道的足以让我通过，但我还不完美，所以如果这是一个愚蠢的问题，我深表歉意。

我正在尝试编写一个可以将任何类型的对象传递给它的类，但我需要检查传递的对象是否具有特定的方法。我将如何进行测试？

我希望这是有道理的。干杯。

**编辑**

感谢所有快速回复！我对接口等不太熟悉，所以我不完全确定如何使用它们。但是，为了更好地了解我在做什么，我正在尝试创建一个会影响一个对象的 alpha 的类，例如，`ImageView`或者一个`TextView`实例。当我只需要确保它们具有方法时，我将如何为此创建一个接口，而不单独列出每个对象`.setAlpha()`？这有意义吗？干杯。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-26T23:32:19.137

一个更好的主意是使用该方法创建一个接口并将其设为参数类型。传递给您的方法的每个对象都必须实现该接口。

这叫做与客户表达你的合同。如果您*需要*该方法，请说出来。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-26T23:31:57.580

使用获取实例的类`Object.getClass()`，然后使用[`Class.getMethod(String, Class...)`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Class.html#getMethod%28java.lang.String,%20java.lang.Class...%29)并捕获 a`NoSuchMethodException`如果该类没有该方法。

另一方面，这在 Java 中并不是一个很好的做法。尝试改用接口。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-26T23:32:55.113

您可以使用 Java 反射来做到这一点。

类似于`object.getClass().getMethods()`获取对象数组`Method`，或者您可以使用`getMethod()`获取具有特定名称的对象（您必须定义参数）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-26T23:42:17.543

首先，定义一个接口，要求所有实现它的对象都实现一个`setAlpha()`方法：

```
public interface AlphaChanger {
    public void setAlpha(int alpha); // concrete classes must implement this
} 
```

然后，定义实现此接口的类：

```
public class Thing implements AlphaChanger {
    public void setAlpha(int alpha) { // must be present
        // implementation
    }
} 
```

现在您可以要求传递给您的方法的所有对象都必须实现该`AlphaChanger`接口：

```
public void yourMethod(AlphaChanger changer) {
    changer.setAlpha(10); // you know for sure the method exists
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-26T23:34:59.953

您可以尝试像这样列出类的方法（例如：FooBar 类）：

```
Class fooBar= FooBar.class;
Method[] methods = fooBar.getDeclaredMethods();
if (methods.length == 0){
...
} else{
...
} 
```

# wordpress - 如何在 Wordpress 中显示随机帖子？

> ID：10770542
> 
> 赞同：-1
> 
> 时间：2012-05-26T23:31:13.640
> 
> 标签：wordpress

当 url 样式像 : 时，如何为每个类别显示随机帖子`http://www.whatever.com/category/all-english/poetry/`，所以每次我点击类别链接时，它都会显示不同的帖子

我试过这个：

```
$cat=get_query_var( 'cat' );
query_posts('cat=$cat&orderby=rand');
if (have_posts()) : 
    if ( $is_top_single ) $GLOBALS['more'] = false; //important
    while (have_posts()) : the_post(); ?> 
```

但结果不正确，它显示所有类别的随机帖子！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:47:51.563

您需要学习如何使用[query_posts](http://codex.wordpress.org/Template_Tags/query_posts)。您可以编辑您的`archive.php`或`category.php`如下：

```
query_posts(array(
    'showposts' => 6,
    'orderby' => 'rand',
    'category_name' => 'News' //You can insert any category name
));
if (have_posts()) : while (have_posts()) : the_post(); 
```

# c++ - 在链表中插入创建循环

> ID：10770543
> 
> 赞同：0
> 
> 时间：2012-05-26T23:31:23.707
> 
> 标签：c++

所以，我试图在 C++ 中实现一个简单的链表，但是我的类的 push 方法有问题。基本上，当我将第一个节点添加到列表时，一切正常；但是，当我添加第二个节点时，它最终指向自身（即 secondNode.next == &secondNode）。

```
class linkedList
{
    public:
    node head;
    linkedList()
    {
        head.next = NULL;
    }
    void push(node new)
    {
        if(head.next == NULL)
        {
            head.next = &new;
            new.next = NULL;
        }
        else
        {
            new.next = head.next;
            head.next = &new;
        }
    }
}; 
```

我不知道出了什么问题...任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T23:35:18.653

```
void push(node new) 
```

您不必**复制**对象，如下所示：

```
void push(node& new) 
```

否则，您将获取在函数末尾删除的对象的地址

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T00:09:43.897

至少在我看来，你有一些在某种程度上是错误的。

首先，`head`不应该真的是`node`- 它应该是`node *`. 至少从外观上看，你使用它的只是它的`next`指针，所以你不妨把它变成一个指针并完成它。

其次，要在列表的开头插入新项目，您实际上不需要检查列表的头部是否为空指针。

第三，虽然@lezebulon 建议使用对节点的引用*会*起作用，但我认为在这种情况下这并不是*最好的方法。*与其让用户传递指向*节点*的指针或引用，他们实际上应该只传递一个数据项，并且您的链表类应该分配一个节点来保存列表中的该项。

```
template <class T>
class linked_list { 

    class node { 
        T item;
        node *next;
    public:
        node(T const &data, node *next_node) : item(data), next(next_node) {}
    };

    node *head;
public:

    linked_list() : head(NULL) {}

    void push(T const &data) {
        head = new node(data, head);
    }
}; 
```

# unit-testing - 使 ravendb 单元测试失败

> ID：10770547
> 
> 赞同：0
> 
> 时间：2012-05-26T23:31:55.790
> 
> 标签：unit-testing, ravendb

我正在使用 RavenDB（顺便说一句很棒的产品）开展一个项目，并且我正试图咬紧牙关，实际上从一开始就对我的代码进行单元和集成测试。我的第一组测试只是基本的健全性测试，以查看我的代码是否可以实际连接到数据库，因为我想查看我的连接代码和测试环境是否实际配置正确。我尝试进行这样的测试，以防万一以后事情真的失败了，这样我就可以确定我是否在较低级别上做了一些愚蠢的事情。

我正在创建一个 DocumentStore，然后从中初始化一个会话。显然，即使服务器上不存在数据库本身，到目前为止，该过程中的代码仍然可以正常工作而不会出错。我怎样才能真正测试我可以用这个东西连接到一个工作数据库？我应该只是伪造一份文件并尝试将其推入那里，还是我错过了一种更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T10:19:04.967

威尔，我不确定我是否明白你的意思。您想看到尝试访问不存在的数据库会失败吗？在这种情况下，这里会抛出一些东西：

```
using(var store = new DocumentStore{Url = "http://localhost:8080"}.Initialize())
using(var session = store.OpenSession("Database-Name-That-Does-Not-Exist"))
{
    session.Load<object>("some-doc-id");

} 
```

# image - r- 如何在 image.plot 中编辑 x 轴上的元素

> ID：10770550
> 
> 赞同：6
> 
> 时间：2012-05-26T23:32:26.563
> 
> 标签：image, r

我为此数据创建了一个图像图：

```
sample
         p         p.1         p.2         p.3         p.4
  p    1.0000000  0.24077171 -0.66666667 -0.49009803  0.61237244
  p.1  0.2407717  1.00000000  0.09028939 -0.83444087  0.14744196
  p.2 -0.6666667  0.09028939  1.00000000  0.21004201  0.10206207
  p.3 -0.4900980 -0.83444087  0.21004201  1.00000000 -0.08574929
  p.4  0.6123724  0.14744196  0.10206207 -0.08574929  1.00000000 
```

使用此代码：

```
 image.plot(sample,col=redblue(191), zlim=c(-1,1)) 
```

我得到这张图片： ![](../Images/629da8da3dd05510ff7848f313f29e57.png)

而不是 0.0 0.2 0.4.. 在 x 和 y 轴上，我想要 p p.1 p.2 ......我怎么得到那个？感谢您的时间和考虑？

我的热图如下所示：

![在此处输入图像描述](../Images/00b35fe4132f989b00d45b26fb42733a.png)

它不是对称的。你能解决这个问题吗？我正在使用这段代码：

> shades=c(seq(-1,-0.5,length=64), seq(-0.5,0.5, length=64), seq(0.5,1,length=64))
> heatmap.2(sample, dendrogram='none ', symm=TRUE, Rowv=FALSE, Colv=FALSE, key=TRUE, cexCol=0.7, cexRow=1,scale="row", keysize=1, col=redblue(191), breaks=shades)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-27T03:51:45.307

这是一个更好的解决方案：

```
 par(mar=c(5,4.5,4,7))
 image(sample, col=rainbow(25), axes=F)  #redblue() doesn't work on my computer.
 axis(2)
 axis(1, at=seq(0,0.8,0.2), labels=rownames(sample))
 image.plot(sample, legend.only=T) 
```

![在此处输入图像描述](../Images/93cc8a850ee4ed6e28200b64bb2964c5.png)

编辑：下面的情节看起来像你要找的吗？

```
 sample = cor(matrix(rnorm(400), nrow=20))
 image(cor(matrix(rnorm(400), nrow=20)), axes=F)
 mtext(text=c(paste("country",1:21)), side=2, line=0.3, at=seq(0,1,0.05), las=1, cex=0.8)
 mtext(text=c(paste("country",1:21)), side=1, line=0.3, at=seq(0,1,0.05), las=2, cex=0.8)
 image.plot(sample, legend.only=T) 
```

![在此处输入图像描述](../Images/bb27059bb86f5ee024aa853108083efa.png)

# cakephp - CakePHP 1.3：在模型中的查找操作期间检查日期是否为今天

> ID：10770559
> 
> 赞同：0
> 
> 时间：2012-05-26T23:33:52.353
> 
> 标签：cakephp

我想找到今天已经注册的会员。我不确定这是否是最好的方法，但这就是我所拥有的：

```
function getMembersToday(){
    $members = $this->find(
        'count',
        array(
            'conditions' => array(
                'User.created' => //Expression with today's date
            )
        )
    );

    return $members;
} 
```

我想将今天创建的所有用户返回为“计数”。我该如何实现这一点。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T03:11:42.483

以下是功能：

**MySQL：**`'User.created' => 'CURDATE()'`
**SQLite：**`"User.created" => "date('now')"`
**PostgreSQL：**`"User.created" => 'now()::date'`
**甲骨文：**`"User.created" => 'SYSDATE'`

# ruby-on-rails - 无法确定“A 型属于 B 型”还是“B 型属于 A 型”？

> ID：10770560
> 
> 赞同：0
> 
> 时间：2012-05-26T23:33:57.157
> 
> 标签：ruby-on-rails, associations

考虑两个模型：

1.  `User`=>（id：整数，名称：字符串，created_at：日期时间，updated_at：日期时间，department_id：整数）
2.  `Department`=>（id：整数，名称：字符串，created_at：日期时间，updated_at：日期时间）

现在，这两个表之间有明显的关系。这是

*   每个`User`部门都有一个部门
*   A`Department`属于多个用户，即一个部门有多个用户

所以，我选择了与以下相同的epress`A belongs_to B`

```
class User < ActiveRecord::Base
  has_one :department
end
class Department < ActiveRecord::Base
  belongs_to :user
end 
```

但您可能知道这不起作用并引发以下错误：

```
> @user = User.find(1)
> @user.department.name
  Department Load (1.0ms)  SELECT "departments".* FROM "departments" WHERE "departments"."user_id" = 1 LIMIT 1
ActiveRecord::StatementInvalid: PG::Error: ERROR:  column departments.user_id does not exist 
```

经过大量的打击和试验。我偶然发现了定义这个的正确方法，这只是另一种方式，即`B belongs to A`

```
class Department < ActiveRecord::Base
  has_many :users
end
class User < ActiveRecord::Base
  belongs_to :department
end
> @user = User.find(1)
> @user.department.name
Department Load (1.0ms)  SELECT "departments".* FROM "departments" WHERE "departments"."id" = 1 LIMIT 1
 => "HR" 
```

现在，这与我的大脑对这些关联的看法完全相反。所以，我有点困惑，所以如果有人能解释发生了什么？

为什么`B belongs to A`& NOT `A belongs to B`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T02:02:01.833

你的模型错了。它们应该是这样的：

```
class User < ActiveRecord::Base
  belongs_to :department
end

class Department < ActiveRecord::Base
  has_many :users
end 
```

因此，要将部门添加到用户，您可以执行以下操作：

```
@user.department.create(:name => 'Science Department') 
```

要将用户添加到部门，您可以执行以下操作：

```
@department.users.create(:name => 'John') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T23:57:07.687

乍一看，这种`:has_one`关系有点奇怪。考虑一个用户和一个帐户，每个帐户都连接到（属于）一个用户，从另一端用户 has_one 帐户，只有一个，他的帐户。帐户是用户拥有的东西。

在这些情况下，您`has_one`在模型上使用关系`User`，Rails 将在表中搜索`user_id`列`accounts`（请参阅 Rails 指南中的[has_one 文档](http://guides.rubyonrails.org/association_basics.html#the-has_one-association)）。

在您的具体情况下，我认为说“一个部门有很多用户”和“一个用户属于一个部门”是完全正确的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-26T23:46:13.237

在第一个示例中，您需要将列和索引添加到迁移文件中的表中

```
class AddRelationToDeparments < ActiveRecord::Migration
  def change
    add_column, :deparments, :user_id, :integer
    add_index, :deparments: :user_id
  end
end 
```

# html - 带有针对 iframe 的锚点的图像翻转

> ID：10770563
> 
> 赞同：-1
> 
> 时间：2012-05-26T23:34:12.980
> 
> 标签：html, css, iframe, anchor, rollover

我正在制作的网站存在一些问题，需要帮助解决。这是现场示例的链接：

[http://scissormanmusic.com/index_new4.html](http://scissormanmusic.com/index_new4.html)

新闻、节拍和音乐翻转和锚点在 Firefox 12 和 Chrome 16 上对我来说很好用。但是，联系人翻转不起作用，它的锚点也不起作用。仅当您将鼠标悬停在 links.png 右侧的 30% 上时，链接翻转和锚点才起作用。

此外，twitter.png 不显示。我知道我上传了它，而且我很确定我正确地链接到它，因为它在 Dreamweaver 和浏览器上的本地测试中运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:45:34.997

您的左侧菜单与右侧菜单重叠，您可以使用 Inspect Element 看到：

![在此处输入图像描述](../Images/9ea7eb65587e37abb27191a956d316db.png)

把它变小，或者把右边的菜单移到前面。

```
#rightMenu {
    z-index: 3; /* Instead of 1 */
} 
```

# apache - htaccess 添加不需要的字符

> ID：10770564
> 
> 赞同：0
> 
> 时间：2012-05-26T23:34:13.637
> 
> 标签：apache, .htaccess, trailing-slash

我有一个看起来像这样的 htaccess 文件

```
Options +FollowSymLinks
Options -Indexes
RewriteEngine on
RewriteBase /website/

# add slashes after link/folder
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
#RewriteCond %{REQUEST_URI} !(\.[a-zA-Z0-9]{1,5}|/)$
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*)$ http://localhost/website/$1/ [L,R=301]

# shorten URLs
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/\.]+)/([^/\.]+)/([^/\.]+)/([^/\.]+)/?$ index.php?page=$1&beta=$2&gamma=$3&delta=$4 [L]
RewriteRule ^([^/\.]+)/([^/\.]+)/([^/\.]+)/?$ index.php?page=$1&beta=$2&gamma=$3 [L]
RewriteRule ^([^/\.]+)/([^/\.]+)/?$ index.php?page=$1&beta=$2 [L]
RewriteRule ^([^/\.]+)/?$ index.php?page=$1 [L] 
```

一切正常，直到它必须向根目录上具有匹配文件夹的链接添加斜杠。

示例：如果我记下**www.example.com/live**并且 www.example.com/ 中没有名为“live”的文件夹，则脚本将添加一个斜杠。但是，由于有一个名为“live”的文件夹，脚本将再次添加斜杠，但它也会添加这个 ?page=live 所以 URL 看起来像这个**www.example.com/live/?page =直播**

我的问题是为什么 ?page=something&beta=something&gamma=...等。被添加到后面，我应该如何让它停止？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:56:30.740

```
DirectorySlash Off 
```

应该解决这个问题。

**编辑：**执行 DirectorySlash 通常使用的操作：

```
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^(.*)$ /$1/ [L,R=301] 
```

# c - K&R malloc 代码没有意义？

> ID：10770570
> 
> 赞同：4
> 
> 时间：2012-05-26T23:35:07.503
> 
> 标签：c, malloc, kernighan-and-ritchie

此代码来自 K&R 书 - 第 8 章第 7 节：示例 - 存储分配器。至少对我来说，这段代码没有意义。“Header”是一个结构体和一个“最严格的对齐类型”的联合，它是一个长类型。然后，Malloc 将找到一个足够大的可用空间，其大小是标头大小的倍数。

```
static Header base;            /* empty list to get started */
static Header *freep = NULL;   /* start of free list */

/* malloc: general-purpose storage allocator */
void *malloc(unsigned nbytes)
{
  Header *p, *prevp;
  Header *morecore(unsigned);
  unsigned nunits;
  nunits = (nbytes+sizeof(Header)-1)/sizeof(Header) + 1;
  if ((prevp = freep) == NULL) {     /* no free list yet */
    base.s.ptr = freeptr = prevptr = &base;
    base.s.size = 0;
  }
  for (p = prevp->s.ptr; ; prevp = p, p = p->s.ptr) {
    if (p->s.size >= nunits) { /* big enough */
      if (p->s.size == nunits) /* exactly */
        prevp->s.ptr = p->s.ptr;
      else {     /* allocate tail end */
        p->s.size -= nunits;
        p += p->s.size;
        p->s.size = nunits;
      }
      freep = prevp;
      return (void *)(p+1);
    }
    if (p == freep) /* wrapped around free list */
      if ((p = morecore(nunits)) == NULL)
        return NULL; /* none left */

  }
} 
```

这段代码的奇怪部分是语句`nunits = (nbytes+sizeof(Header)-1)/sizeof(Header) + 1;`，然后在比较中使用它`if (p->s.size >= nunits)`来找到一个足够大的空间，其中包含以 Header 大小为单位的单位。不应该`nunits = (nbytes+sizeof(Header)) / sizeof(Header)`只有前者吗？原始代码将评估为小于应有的值。+-1 是怎么回事？为什么分配的空间少于预期。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-26T23:43:07.933

`-1`和将`+1`考虑不是块大小倍数的值。

例如，假设块大小为 10。如果您尝试使用公式`n / 10`来获取所需块的数量，那么对于 n = 15，您将得到 1 个块。这是错误的，您需要 2 个。

如果您将公式更改为，`n / 10 + 1`那么它也将是错误的。当 n = 20 时，您只需要 2 个块，但该公式将返回 3。

正确的公式是`(n - 1) / 10 + 1`。这就是你用整数除法四舍五入的方式。这与您询问的公式的唯一区别是 extra `sizeof(Header)`，这只是标题本身所需的额外空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-26T23:39:36.840

`(nbytes+sizeof(Header)-1)/sizeof(Header) + 1`是代码中的一个非常标准的习惯用法，用于通过正确的舍入来获取某物的单位数。如果您尝试使用一些值，您会发现它可以正常工作。

实际的成语更好地表示为`(nbytes - 1)/unitSizeInBytes + 1`。

澄清一下，根据已接受答案的最后一段，`sizeof(Header)`除法双方的使用方式不同。它在股息中的使用是因为它需要为 Header 和 nbytes 分配字节。它在除数中的使用是因为这是分配的块的大小。在这种情况下，它们是相同的值，`sizeof(Header)`。

# objective-c - 创建具有不同子类属性的子类

> ID：10770578
> 
> 赞同：8
> 
> 时间：2012-05-26T23:37:55.953
> 
> 标签：objective-c, cocoa, subclass

说我有这门课

```
@interface CustomClass : NSObject

@property (nonatomic, strong) NSArray * nicestArrayEver;

@end 
```

我想创建一个CustomClass的子类，但这里有一个问题

```
@interface ASubClassCustomClass : CustomClass

@property (nonatomic, strong) NSMutableArray * nicestArrayEver;

@end 
```

您可以想象的问题是，当我初始化 ASubClassCustomClass 并将其称为超级初始化程序（因为需要其他属性）时，创建了不可变的 nicestArrayEver .. 我怎样才能避免它的创建，以便我可以设置可变的？

注意：这只是一个示例，真正的实现调用了一个重创建和真正自定义的子类（不是 NSArray）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T00:00:39.983

您可以通过使用不同的支持变量使其工作，合成时看起来像这样：`@synthesize nicestArrayEver = nicestArrayEverSubClass_;`

```
#import <Foundation/Foundation.h>

@interface CustomClass : NSObject

@property (nonatomic, strong) NSArray * nicestArrayEver;

@end

@implementation CustomClass
@synthesize nicestArrayEver ;

-(id)init
{
    if (self = [super init]) {
        nicestArrayEver = [[NSArray alloc] init];
    }
    return self;
}
@end

@interface ASubClassCustomClass : CustomClass

@property (nonatomic, strong) NSMutableArray * nicestArrayEver;

@end

@implementation ASubClassCustomClass
@synthesize nicestArrayEver = nicestArrayEverSubClass_;

-(id)init{
    if (self = [super init]) {
        nicestArrayEverSubClass_ = [[NSMutableArray alloc] init];
    }
    return self;
}
@end

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        CustomClass *c1 = [[[CustomClass alloc] init] autorelease];
        ASubClassCustomClass *c2 = [[[ASubClassCustomClass alloc] init] autorelease];

        NSLog(@"%@", NSStringFromClass([[c1 nicestArrayEver] class]));
        NSLog(@"%@", NSStringFromClass([[c2 nicestArrayEver] class]));

    }
    return 0;
} 
```

*输出*

```
2012-05-27 01:59:16.221 NicestArray[2312:403] __NSArrayI
2012-05-27 01:59:16.225 NicestArray[2312:403] __NSArrayM 
```

* * *

另一种方法可能是在基类中有 2 个 init 方法，一个将实例化属性，一个不会，但将任务留给子类 - 这将防止您创建昂贵的对象只是为了扔掉它们离开。
现在，基类可以直接使用第二个 init 实例化并进入错误状态。您可以通过检查 self 类类型来避免这种情况`isMemberOfClass:`，如果类类型是基类，则抛出错误。

```
@interface CustomClass : NSObject

@property (nonatomic, strong) NSArray * nicestArrayEver;
-(id)initWithoutArray;
@end

@implementation CustomClass
@synthesize nicestArrayEver ;

-(id) initWithoutArray
{
    if (self = [super init]) {
        if ([self isMemberOfClass:[CustomClass class]]) {
            [NSException raise:@"AbstractMethodCall" format:@"%@ should be called only from Subclasses of %@", NSStringFromSelector(_cmd), NSStringFromClass([self class])];
        }
    }
    return self;
}

-(id)init
{
    if (self = [super init]) {
        nicestArrayEver = [[NSArray alloc] init];
    }
    return self;
}
@end

@interface ASubClassCustomClass : CustomClass

@property (nonatomic, strong) NSMutableArray * nicestArrayEver;

@end

@implementation ASubClassCustomClass
@synthesize nicestArrayEver = nicestArrayEverSubClass_;

-(id)init{
    if (self = [super initWithoutArray]) {
        nicestArrayEverSubClass_ = [[NSMutableArray alloc] init];
    }
    return self;
}

@end

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        CustomClass *c1 = [[[CustomClass alloc] init] autorelease];
        ASubClassCustomClass *c2 = [[[ASubClassCustomClass alloc] init] autorelease];

        NSLog(@"%@", NSStringFromClass([[c1 nicestArrayEver] class]));
        NSLog(@"%@", NSStringFromClass([[c2 nicestArrayEver] class]));

        //this works, as it is the subclass
        ASubClassCustomClass *shouldWork = [[[ASubClassCustomClass alloc] init] autorelease];

        // ouch!
        CustomClass *shouldCrash = [[[CustomClass alloc] initWithoutArray] autorelease];

    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T00:32:01.593

我不明白您为什么要这样做，但我建议您执行以下操作：在您的子类中声明一个单独的 NSMutableArray 属性（我们称之为 nicestMutableArrayEver）并覆盖您的超类 NSArray 属性的 getter 以返回mutableArray 实例：

```
- (NSArray *)nicestArrayEver {
    return [self nicestMutableArrayEver];
} 
```

这样，每当您引用超类属性时，您都可以取回 mutableArray。

最好的，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T00:45:21.217

属性几乎不应该有可变类型。如果他们这样做了，那么调用者可以获得指针并在其背后改变对象的属性。如果一个属性应该是外部可变的，那应该是通过变异方法。

请记住，属性定义接口，而不是实现。`@synthesize`可以从属性声明创建实现，但如果这样做会做错事，你不应该使用它。

所以，第一步是为你的类和子类定义接口，而不考虑实现。只有在您知道接口应该是什么之后，您才应该设计每个接口的实现。

无论属性是否在外部可变，支持实例变量可能需要是可变的。类可能需要纯粹在内部改变它自己的属性。

您可以使基类具有指定的初始化程序，该初始化程序将数组对象作为参数（类型`id`以便子类的覆盖不必强制转换以将其视为`NSMutableArray*`）。然后，类的“普通”初始化程序将调用指定的初始化程序并`NSArray`使用。子类的指定初始化器将调用超类的指定初始化器，传入`NSMutableArray`要使用的。

Alternatively, the base class initializer(s) could call out to another method to obtain the array. The base class implementation would return an `NSArray`. The subclass could override that method to return an `NSMutableArray`.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-26T23:41:29.247

你真的不能那样做。只需`CustomClass`创建`NSMutableArray`. 您可以将它们创建为类型`id`并检查`isKindOfClass:`，但这只是一件苦差事，并不是真正必要的。

实际上只有两个原因我可以看到做你要求的事情：

1.  为了避免额外的开销`NSMutableArray`
2.  为了防止`CustomClass`修改数组的内容，除非它是一个`ASubClassCustomClass`.

虽然这些都是很好的目标，但我想说在这种情况下，稍微简化一下是值得的。

# c# - 生成随机序列的奇怪行为

> ID：10770584
> 
> 赞同：0
> 
> 时间：2012-05-26T23:40:16.310
> 
> 标签：c#, random, multidimensional-array, nunit

我有生成随机线性方程组的类

```
public class MatrixGenerator: IMatrixGenerator
    {
        private int vSize;
        private int hSize;
        private double[,] _matrix;
        private double[] _right;
        private double[] _solution;
        private double maxValue;

        public MatrixGenerator(int vSize, int hSize, double maxValue)
        {
            this.vSize = vSize;
            this.hSize = hSize;
            this.maxValue = maxValue;
            _matrix = new double[vSize, hSize];
            _right = new double[vSize];
            _solution = new double[hSize];
        }

        public void Next()
        {
            _matrix = new double[vSize, hSize];
            _right = new double[vSize];
            Random r = new Random();
            _solution = Enumerable.Repeat(0.0, hSize).Select(m => m = r.NextDouble()*maxValue).ToArray();

            for (int i = 0; i < vSize; i++)
            {
                for (int j = 0; j < hSize; j++)
                {
                    _matrix[i, j] = r.NextDouble() * maxValue;
                }
                for (int j = 0; j < hSize; j++)
                {

                    _right[i] += _solution[j] * _matrix[i, j];
                } 
            } 
        }

        public double[,] Matrix
        {
            get { return _matrix; }
        }

        public double[] RightVector
        {
            get { return _right; }
        }

        public double[] SolutionVector
        {
            get { return _solution; }
        }
    } 
```

和此类的 NUnit 测试：

```
[Test]
        public void CanGenerateAnotherMatrixandVector()
        {
            MatrixGenerator mGen = new MatrixGenerator(vSize, hSize, maxValue);
            mGen.Next();
            double[,] firstMatrix = new double[mGen.Matrix.GetLength(0), mGen.Matrix.GetLength(1)];
            double[] firstVector = new double[mGen.RightVector.GetLength(0)];
            for (int i = 0; i < mGen.Matrix.GetLength(0); i++)
            {
                firstVector[i] = mGen.RightVector[i]; 
                for (int j = 0; j < mGen.Matrix.GetLength(1); j++)
                {
                    firstMatrix[i,j] = mGen.Matrix[i, j];
                }
            }
            mGen.Next();

            Assert.That(firstMatrix, Is.Not.EqualTo(mGen.Matrix));
            Assert.That(firstVector, Is.Not.EqualTo(mGen.RightVector));
        } 
```

测试失败，但此代码有效。我尝试使用来自 TestDriven.Net 的调试器工具调试此测试，一切正常，测试通过。谁能描述我为什么这个测试失败了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T00:02:14.577

比你创建新的 Random 实例，它的[种子从当前时间初始化，](http://msdn.microsoft.com/en-us/library/h343ddh9%28v=vs.100%29.aspx)以毫秒为单位。如果一个接一个地创建一个实例，那么种子可能会用一个值初始化。为了防止这种情况，您需要将一个随机实例传递给 Next 方法。

测试：

```
 var random = new Random();
        var mGen = new MatrixGenerator(4, 5, 10);
        mGen.Next(random);

        var firstMatrix = new double[mGen.Matrix.GetLength(0),mGen.Matrix.GetLength(1)];
        var firstVector = new double[mGen.RightVector.GetLength(0)];

        for (int i = 0; i < mGen.Matrix.GetLength(0); i++) {
            firstVector[i] = mGen.RightVector[i];
            for (int j = 0; j < mGen.Matrix.GetLength(1); j++) {
                firstMatrix[i, j] = mGen.Matrix[i, j];
            }
        }
        mGen.Next(random);

        CollectionAssert.AreNotEqual(firstMatrix, mGen.Matrix);
        CollectionAssert.AreNotEqual(firstVector, mGen.RightVector); 
```

新的下一个方法：

```
 public void Next(Random random) {
        _matrix = new double[vSize,hSize];
        _right = new double[vSize];

        _solution = Enumerable.Repeat(0.0, hSize).Select(m => random.NextDouble()*maxValue).ToArray();

        for (int i = 0; i < vSize; i++) {
            for (int j = 0; j < hSize; j++) {
                _matrix[i, j] = random.NextDouble()*maxValue;
            }
            for (int j = 0; j < hSize; j++) {
                _right[i] += _solution[j]*_matrix[i, j];
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:45:23.440

尽管这不是完全重复的，但@LB 的链接回答了这个问题。A`Random`使用当前时间戳作为种子进行初始化。如果您使用相同的时间，您将获得相同的“随机”数字。

但是因为您正在创建一个随机数数组，并且该方法还可以执行其他操作，所以它可能会按需要工作。但只是因为它需要更多时间在您当前的机器上执行，所以下一次调用`Next`crates 会生成另一个 double 值列表。

因此，这个软件有可能在一台机器上运行得足够快，以至于总是创建相同的序列。这就是测试失败的原因。

一种解决方案是始终使用相同的实例`Random`，例如使用成员变量而不是局部变量。

```
public class MatrixGenerator: IMatrixGenerator
{
    // ...
    Random r = new Random();

    // ...

    public void Next()
    {
        _matrix = new double[vSize, hSize];
        _right = new double[vSize];
        _solution =  Enumerable.Repeat(new Random(), hSize)
                               .Select(r => r.NextDouble() * maxValue)
                               .ToArray(); 
        // ... 
```

在这种情况下，最好将随机实例传递给构造函数`MatrixGenerator`或作为`Next`方法的参数。

```
var random = new Random();
for(int i = 0; i< 1000; i++)
{
    var mGen = new MatrixGenerator(4, 5, 10, random);
    mGen.Next();
} 
```

# java - 为什么多态性不以相同的方式对待泛型集合和普通数组？

> ID：10770585
> 
> 赞同：18
> 
> 时间：2012-05-26T23:40:25.440
> 
> 标签：java, generics, collections, polymorphism

假设类 Dog 扩展类 Animal：为什么不允许这种多态语句：

```
List<Animal> myList = new ArrayList<Dog>(); 
```

但是，它允许使用普通数组：

```
Animal[] x=new Dog[3]; 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-30T12:47:36.060

其原因是基于 Java 如何实现泛型。

**数组示例**

使用数组，您可以做到这一点（数组是协变的，正如其他人所解释的）

```
Integer[] myInts = {1,2,3,4};
Number[] myNumber = myInts; 
```

但是，如果你尝试这样做会发生什么？

```
Number[0] = 3.14; //attempt of heap pollution 
```

最后一行可以编译得很好，但是如果你运行这段代码，你可以得到一个`ArrayStoreException`. 因为您试图将双精度数放入整数数组（无论通过数字引用访问）。

这意味着你可以欺骗编译器，但不能欺骗运行时类型系统。之所以如此，是因为数组就是我们所说*的可具体化类型*。这意味着在运行时 Java 知道这个数组实际上被实例化为一个整数数组，它恰好是通过 type 的引用访问的`Number[]`。

所以，如您所见，一件事是对象的实际类型，另一件事是您用来访问它的引用的类型，对吧？

**Java泛型的问题**

现在，Java 泛型类型的问题是类型信息被编译器丢弃并且在运行时不可用。这个过程称为[类型擦除](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.6)。在 Java 中实现这样的泛型是有充分理由的，但这是一个很长的故事，它与与预先存在的代码的二进制兼容性有关。

但这里重要的一点是，由于在运行时没有类型信息，因此无法确保我们不会造成堆污染。

例如，

```
List<Integer> myInts = new ArrayList<Integer>();
myInts.add(1);
myInts.add(2);

List<Number> myNums = myInts; //compiler error
myNums.add(3.14); //heap polution 
```

如果 Java 编译器没有阻止你这样做，那么运行时类型系统也不能阻止你，因为在运行时没有办法确定这个列表应该只是一个整数列表。Java 运行时允许你将任何你想要的东西放入这个列表中，而它应该只包含整数，因为当它被创建时，它被声明为一个整数列表。

因此，Java 的设计者确保您不能欺骗编译器。如果你不能欺骗编译器（就像我们可以用数组做的那样），你也不能欺骗运行时类型系统。

因此，我们说泛型类型是*不可具体化的*。

显然，这会妨碍多态性。考虑以下示例：

```
static long sum(Number[] numbers) {
   long summation = 0;
   for(Number number : numbers) {
      summation += number.longValue();
   }
   return summation;
} 
```

现在你可以像这样使用它：

```
Integer[] myInts = {1,2,3,4,5};
Long[] myLongs = {1L, 2L, 3L, 4L, 5L};
Double[] myDoubles = {1.0, 2.0, 3.0, 4.0, 5.0};

System.out.println(sum(myInts));
System.out.println(sum(myLongs));
System.out.println(sum(myDoubles)); 
```

但是如果你试图用泛型集合实现相同的代码，你将不会成功：

```
static long sum(List<Number> numbers) {
   long summation = 0;
   for(Number number : numbers) {
      summation += number.longValue();
   }
   return summation;
} 
```

如果您尝试这样做，您会得到编译器错误...

```
List<Integer> myInts = asList(1,2,3,4,5);
List<Long> myLongs = asList(1L, 2L, 3L, 4L, 5L);
List<Double> myDoubles = asList(1.0, 2.0, 3.0, 4.0, 5.0);

System.out.println(sum(myInts)); //compiler error
System.out.println(sum(myLongs)); //compiler error
System.out.println(sum(myDoubles)); //compiler error 
```

解决方案是学习使用 Java 泛型的两个强大特性，即协变和逆变。

**协方差**

使用协方差，您可以从结构中读取项目，但不能向其中写入任何内容。所有这些都是有效的声明。

```
List<? extends Number> myNums = new ArrayList<Integer>();
List<? extends Number> myNums = new ArrayList<Float>()
List<? extends Number> myNums = new ArrayList<Double>() 
```

你可以阅读`myNums`：

```
Number n = myNums.get(0); 
```

因为您可以确定无论实际列表包含什么，它都可以向上转换为一个数字（毕竟任何扩展数字的东西都是一个数字，对吧？）

但是，不允许将任何内容放入协变结构中。

```
myNumst.add(45L); //compiler error 
```

这是不允许的，因为 Java 无法保证泛型结构中对象的实际类型。它可以是任何扩展 Number 的东西，但编译器不能确定。所以你可以读，但不能写。

**逆变**

使用逆变器，您可以做相反的事情。您可以将事物放入通用结构中，但无法从中读出。

```
List<Object> myObjs = new List<Object();
myObjs.add("Luke");
myObjs.add("Obi-wan");

List<? super Number> myNums = myObjs;
myNums.add(10);
myNums.add(3.14); 
```

在这种情况下，对象的实际性质是一个对象列表，通过逆变，你可以将数字放入其中，基本上是因为所有数字都有对象作为它们的共同祖先。因此，所有数字都是对象，因此这是有效的。

然而，假设你会得到一个数字，你就不能安全地从这个逆变结构中读取任何内容。

```
Number myNum = myNums.get(0); //compiler-error 
```

如您所见，如果编译器允许您编写此行，您将在运行时收到 ClassCastException。

**获取/放置原则**

因此，当你只打算从结构中取出泛型值时使用协变，当你只打算将泛型值放入结构时使用逆变，当你打算两者都使用时使用精确的泛型类型。

我拥有的最好的例子是以下将任何类型的数字从一个列表复制到另一个列表。它只从源头*获取*物品，它只*将*物品放在命运中。

```
public static void copy(List<? extends Number> source, List<? super Number> destiny) {
    for(Number number : source) {
        destiny.add(number);
    }
} 
```

由于协变和逆变的力量，这适用于这样的情况：

```
List<Integer> myInts = asList(1,2,3,4);
List<Double> myDoubles = asList(3.14, 6.28);
List<Object> myObjs = new ArrayList<Object>();

copy(myInts, myObjs);
copy(myDoubles, myObjs); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-26T23:48:32.500

> 数组在两个重要方面不同于泛型类型。首先，数组是协变的。这个听起来很吓人的词的意思很简单，如果 Sub 是 Super 的子类型，那么数组类型 Sub[] 就是 Super[] 的子类型。相比之下，泛型是不变的：对于任何两个不同的类型 Type1 和 Type2，List<Type1> 既不是 List<Type2> 的子类型也不是超类型。
> 
> [..]数组和泛型之间的第二个主要区别是数组被具体化了[JLS，4.7]。这意味着数组在运行时知道并强制执行它们的元素类型。
> 
> [..]相比之下，泛型是通过擦除实现的 [JLS, 4.6]。这意味着它们仅在编译时强制执行其类型约束，并在运行时丢弃（或擦除）其元素类型信息。擦除是允许泛型类型与不使用泛型的遗留代码自由互操作的原因（第 23 条）。由于这些根本差异，数组和泛型不能很好地混合。例如，创建泛型类型、参数化类型或类型参数的数组是非法的。这些数组创建表达式都不合法：**new List<E>[]、new List<String>[]、new E[]**。所有这些都会在编译时导致通用数组创建错误。[..]

*Prentice Hall - 有效的 Java 第 2 版*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T00:23:11.910

```
List<Animal> myList = new ArrayList<Dog>(); 
```

是不可能的，因为在那种情况下你可以把猫变成狗：

```
private void example() {
    List<Animal> dogs = new ArrayList<Dog>();
    addCat(dogs);
    // oops, cat in dogs here
}

private void addCat(List<Animal> animals) {
    animals.add(new Cat());
} 
```

另一方面

```
List<? extends Animal> myList = new ArrayList<Dog>(); 
```

是可能的，但在这种情况下，您不能使用具有通用参数的方法（只接受 null ）：

```
private void addCat(List<? extends Animal> animals) {
    animals.add(null);      // it's ok
    animals.add(new Cat()); // compilation error here
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-26T23:46:36.667

这很有趣。我不能告诉你答案，但如果你想将 Dogs 列表放入 Animals 列表中，这很有效：

```
List<Animal> myList = new ArrayList<Animal>();
myList.addAll(new ArrayList<Dog>()); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-26T23:47:45.233

对集合版本进行编码以便编译的方法是：

```
List<? extends Animal> myList = new ArrayList<Dog>(); 
```

数组不需要这个的原因是由于类型擦除 - 非原始数组都是公正的`Object[]`，而 java 数组不是类型化的类（就像集合一样）。语言从来没有为迎合它而设计。

数组和泛型不能混用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-27T00:41:13.513

最终的答案是那样，因为 Java 是那样指定的。更准确地说，因为这是 Java 规范演变的方式^*。

我们不能说 Java 设计者的实际想法是什么，但请考虑一下：

```
List<Animal> myList = new ArrayList<Dog>();
myList.add(new Cat());   // compilation error 
```

相对

```
Animal[] x = new Dog[3];
x[0] = new Cat();        // runtime error 
```

这里将抛出的运行时错误是[`ArrayStoreException`](http://docs.oracle.com/javase/7/docs/api/java/lang/ArrayStoreException.html). 这可能会在对任何非基元数组的任何分配上抛出。

有人可能会认为 Java 对数组类型的处理是错误的……因为上面的例子。

^(* 请注意，Java 数组的类型是在 Java 1.0 之前指定的，但泛型类型仅在 Java 1.5 中添加。Java 语言具有向后兼容的总体要求；即语言扩展不应该破坏旧代码。除此之外，这意味着无法修复历史错误，例如数组类型的工作方式。（假设这是一个错误被接受*......*）)

* * *

在泛型类型方面，类型擦除无法解释编译错误。编译错误实际上是由于使用非擦除泛型类型进行编译类型检查而发生的。

事实上，您可以通过使用未选中的类型转换（忽略警告）来破坏编译错误，并最终导致您在运行时`ArrayList<Dog>`实际包含`Cat`对象。（*这*是类型擦除的结果！）但是请注意，使用未经检查的转换对编译错误的颠覆可能会导致在意想不到的地方出现运行时错误......如果你弄错了。这就是为什么这是一个坏主意。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-28T20:34:19.993

在泛型之前的日子里，编写一个可以对任意类型的数组进行排序的例程需要能够（1）以协变方式创建只读数组并以与类型无关的方式交换或重新排列元素，或者（2）创建以协变方式读写数组，可以安全地读取，并且可以使用以前从同一数组中读取的内容安全地写入，或者 (3) 数组提供了一些与类型无关的比较元素的方法。如果从一开始就在语言中包含协变和逆变泛型接口，那么第一种方法可能是最好的，因为它可以避免在运行时执行类型检查以及此类类型检查的可能性可能会失败。尽管如此，由于不存在这种通用支持，因此没有

# asp.net-mvc-3 - 带有 Ienumerable 的 Asp.net mvc 返回模型

> ID：10770586
> 
> 赞同：0
> 
> 时间：2012-05-26T23:40:39.853
> 
> 标签：asp.net-mvc-3, linq-to-sql, c#-4.0, model

我遇到了模型的返回类型 IEnumerable<> 的问题，我试图更好地理解：

我有一个模型视图：

```
public class Photoview
{
    public int IdPhoto { get; set; }
    public DateTime Date { get; set; }
    public string Nom { get; set; }
    public int Category { get; set; }
    public string Lien { get; set; }
    public bool Actif { get; set; }
    public string Description { get; set; }
} 
```

和一个模型，它从数据库中获取数据：

```
 public IEnumerable<Photoview> GetAllPhotos()
    {
        var a = from o in _ajAentities.Photos
                select o;

        return a.ToList();
    } 
```

但是，我遇到编译错误：无法将 Generic.List 类型转换为

数据库的表是：

```
id_photo    int         Unchecked
date    smalldatetime   Checked
nom         nvarchar(250)   Checked
categorie   int         Checked
lien    nvarchar(250)   Checked
actif   bit         Checked
description nvarchar(800)   Checked 
```

我的问题是：如何才能将 GetAllPhotos() 的 Linq 查询返回为 IEnumerable<> 类型？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T06:56:27.047

似乎`_ajAentities.Photos`is 类型`IEnumerable<Models.DB.Photo>`，但您正试图`IEnumerable<Photoview>`从您的方法返回 an 。

因此，第一种可能性是修复您的返回类型以匹配您的数据库实体：

```
public IEnumerable<Photo> GetAllPhotos()
{
    var a = 
        from o in _ajAentities.Photos
        select o;
    return a.ToList();
} 
```

第二种可能性是在两种类型之间进行映射：

```
public IEnumerable<Photoview> GetAllPhotos()
{
    var a = 
        from o in _ajAentities.Photos
        select new Photoview
        {
            IdPhoto = o.Id,
            Date = o.Date,
            Nom = o.Nom,
            ....
        };

    return a.ToList();
} 
```

您还可以查看[AutoMapper](http://automapper.org/)来执行域模型和视图模型之间的映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-07T02:06:12.640

尝试这个：

```
var a = (IEnumerable<Object>)
        from o in _ajAentities.Photos
        select o; 
```

它将从 Linq 返回的`IQueryable`。`IEnumerable`不要使用，`.ToList()`因为您正在将其转换为`List<object>`类型集合。只需返回变量。

# c# - 从数据库中删除条目

> ID：10770588
> 
> 赞同：1
> 
> 时间：2012-05-26T23:41:17.870
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-3, entity-framework

我最近注意到有两种不同的方法可以从实体框架中的数据库中删除一个条目。

我最初使用以下方法实现了它

```
db.Courses.Remove(course); 
```

但是后来我发现您还可以执行以下操作

```
db.Entry(course).State = EntityState.Deleted; 
```

两者有什么区别吗？我认为切换到后者的唯一原因是在我的实现中更加一致，因为这是我用来编辑条目的方法。

有什么想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:05:21.217

这两种方法都将实体标记为已删除，因此下一个 db.SaveChanges(); 将它们从数据库和上下文中删除。

本文介绍了添加、修改和删除实体的所有方法。

[http://msdn.microsoft.com/en-us/library/gg696174(v=vs.103).aspx](http://msdn.microsoft.com/en-us/library/gg696174(v=vs.103).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T00:31:22.813

是的，两者之间存在差异。

如果您在模型上设置级联选项，以便当客户被标记为已删除时，在上下文中加载的订单也被标记为删除。

例如

`var customer = db.Customers.Include(c => c.Orders).First(c => c.CustomerId == 1); db.Customers.Remove(customer); // at this point all orders in teh context are also marked as deleted.`

但是，当您这样做时

`db.Entry(customer).State = EntityState.Deleted;`

没有将订单标记为已删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T00:04:45.683

他们都做大致相同的事情。

后者仅将记录状态设置为已删除，前者设置为已分离。您仍然需要调用以保存更改以反映记录删除。

```
using (var context = new SchoolEntities ()) 
{
     var dpt = new Department { Name = "Mathematics", DepartmentID = 1};
     context.Entry(dpt).State = EntityState.Added;
     context.SaveChanges(); 
} 
```

显示的代码与其他答案来自相同的资源

# javascript - 插入标签的 Javascript。并找到父母 ID

> ID：10770591
> 
> 赞同：1
> 
> 时间：2012-05-26T23:41:54.533
> 
> 标签：javascript, parent, nodes

我有一个正在尝试处理的脚本。我希望能够找到父 id，以便我可以调整它的样式背景颜色。我还想在父 div 内的某个“输入”中插入一个值。

```
function changeBGC(color) {
    var testObj = this.parentNode;
    document.getElementById(testObj).style.backgroundColor = color;
}

function changeValue(value) {
    var changer = document.getElementById('DIVELEMENT?');
    changer.value = value;
}​ 
```

所有这些都在 Divs 中完成。我知道我可以定义一个特定的 id 或类，但我的网站设计的所有 DIV 的名称都相同。所以我只希望脚本在那些特定的 Div 中工作。

任何人都可以请帮忙。我似乎无法弄清楚，我主要认为这只是我需要的parent.id。

# javascript - 用于定位平台（不是浏览器）的脚本

> ID：10770603
> 
> 赞同：0
> 
> 时间：2012-05-26T23:45:07.867
> 
> 标签：javascript

我似乎无法得到一个直接的答案，不确定我做错了什么，但一个多月来一直在寻找解决方案。

我需要调用单独的样式表，在平台（而不是浏览器）上挂起。我有一个脚本，我发现它应该这样做，但它不起作用。

该网站是fish-fry.com/dev

我放在脑海中的脚本是：

```
<script type="text/javascript">

/***********************************************
* Different CSS depending on OS (mac/pc)- © Dynamic Drive (www.dynamicdrive.com)
* This notice must stay intact for use
* Visit http://www.dynamicdrive.com/ for full source code
***********************************************/

var csstype="external" //Specify type of CSS to use. "Inline" or "external"

var mac_externalcss='http://www.fish-fry.com/dev/wp-content/themes/FISH-FRY-MUSIC-AND-SOUND-CUSTOM-THEME/style.css' //if "external", specify Mac css file here
var pc_externalcss='http://www.fish-fry.com/dev/wp-content/themes/FISH-FRY-MUSIC-AND-SOUND-CUSTOM-THEME/style-windows.css' //if "external", specify PC/default css file here

///////No need to edit beyond here////////////

var mactest=navigator.userAgent.indexOf("Mac")!=-1
if (csstype=="inline"){
document.write('<style type="text/css">')
if (mactest)
document.write(mac_css)
else
document.write(pc_css)
document.write('</style>')
}
else if (csstype=="external")
document.write('<link rel="stylesheet" type="text/css" href="'+ (mactest? mac_externalcss : pc_externalcss) +'">')

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T00:02:41.420

我[将从 jslint.com](http://jslint.com)开始运行该脚本。
似乎有很多格式错误。

也检查[一下](http://www.javascripter.net/faq/operatin.htm)。
也许用户代理不是要检查的地方？

**注意**：导航器。**appVersion** .indexOf("Win")

# php - 修复 rewrite mod 以与 get 一起工作

> ID：10770611
> 
> 赞同：0
> 
> 时间：2012-05-26T23:45:55.373
> 
> 标签：php, .htaccess

我正在尝试修改一个 htaccess 文件，以便它为搜索表单提供一个不错的 url。

```
RewriteRule ^search/([a-zA-Z0-9]+)$ look.php?q=$1 [nc]
RewriteRule ^search/?q=([a-zA-Z0-9]+)$ look.php?q=$1 [nc]
RewriteRule ^search/?q=([a-zA-Z0-9]+)/([a-zA-Z0-9]+)$ look.php?s=$1&q=$2 [nc] 
```

如果单击搜索按钮，则 url 返回`/search/?q=tom`-- 不返回任何内容

如果我输入`/search/tom`url - 它返回与 tom 匹配的结果

如果单击搜索按钮，则 url 返回`/search/?q=tom+jerry`-- 不返回错误的结果，因为如果我这样做`look.php?s=tom+jerry`，它会返回正确的结果..

我的目标是这个`/search/?q=tom` 或 `/search/?q=tom+jerry`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T23:50:09.143

您必须使用`%{QUERY_STRING}`来匹配查询字符串 - 它不会在 RewriteRule 中匹配。

所以你会用这样的东西替换你的第二条规则：

```
RewriteCond %{QUERY_STRING} ^q=([a-zA-Z0-9]+)$
RewriteRule ^search/ look.php?q=%1 [L,NC] 
```

而且我不明白你的第三条规则，所以我不会尝试修复它。

# php - PHP：通过回显变量的类别和子类别

> ID：10770621
> 
> 赞同：0
> 
> 时间：2012-05-26T23:47:35.263
> 
> 标签：php

我只能回显第一个选择框，但不能回显子类别。我检查了代码中的语法错误，但没有找到。我猜逻辑是不正确的。谁能告诉我为什么不显示子类别选择框？

```
 <?php 

    $dbh = new PDO("mysql:host=" . $host . ";dbname=" . $db, $user, $pass);

    if(isset($_GET["category"]) && is_numeric($_GET["category"]))
    {
        $category = $_GET["category"];
    }

    ?>

    <form name="theForm" method="get">

        <!-- Category SELECTION -->

   <select name="category" size="6" onChange="autoSubmit();">
                <?php
        $categories = $dbh->query('SELECT * FROM category ORDER BY c_id');

        while ($row = $categories->fetch()) {
        echo '<option value="' . $row['c_id'] . '"';
        if ($row['c_id'] == $category) echo ' selected';
        echo '>' . htmlentities($row['category']);
      }
                ?>
   </select>

        <br><br>

    </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:51:44.967

由于您使用单引号在字符串中使用了变量，因此您的查询很可能返回 0 结果。

```
$subcategories = $dbh->query('SELECT s_id, subcategory FROM subcategory Where c_id = $category'); 
```

在查询周围使用双引号，或将值连接起来`'... c_id = ' . $category`

但更好的是，学习如何使用参数化查询并绑定值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T23:55:36.613

首先，为什么你有两个数据库表？一个用于类别，一个用于子类别？当一个子类别有另一个子类别时怎么办？然后你会创建另一个表吗`subsubcategory`？？？

更好的方法是只有一个`categories`包含列`id`、`parent`、`title`等的表，其中如果`parent`列包含主类别`0`，则当子类别时，`parent`列包含父类别的 ID。在实现遍历树或类似方法时会更好。

我在您的代码中没有看到错误，但可能`$_GET["subcategory"]`不包含任何值或没有数值，因此`$subcategory`未设置...

你试过调试吗？

# jquery-selectors - jQuery隐藏显示列表元素与选择

> ID：10770628
> 
> 赞同：2
> 
> 时间：2012-05-26T23:48:51.940
> 
> 标签：jquery-selectors, show-hide

我被困在我认为应该很容易的事情上......我有一个选择，可以在更改时获取 id 值，并且我想隐藏所有并显示具有相同 id 值的那些，因此它只适用于首先请帮帮我

```
<select name="" id="estado_list">
 <option value="0">-</option>
 <option value="1">Nuevo León</option>
 <option value="2">Puebla</option>
</select>

<ul style="list-style: none outside none;">
 <li class="forli" id="1">data</li>
 <li class="forli" id="1">data</li>
 <li class="forli" id="1">data</li>
 <li class="forli" id="1">data</li>
 <li class="forli" id="1">data</li>
 <li class="forli" id="1">data</li>
 <li class="forli" id="2">data</li>
</ul>

 $(document).ready(function(){  
        $("#estado_list").change(function(){  
         var id = $(this).val();

          if (id == 0 ){$('.forli').show();}
       else{$('.forli').hide();
            $('li').each(function(){
             $('#'+ id).show();

         });
         }
        }); 
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:00:26.273

您应该修改您的标记，以便不使用数字作为`id`值，也不要`id`一遍又一遍地使用相同的值。我鼓励您进一步使用类值：

```
<select id="estado_list">
 <option value="zero">-</option>
 <option value="one">Nuevo León</option>
 <option value="two">Puebla</option>
</select>

<ul>
 <li class="forli one">1</li>
 <li class="forli one">2</li>
 <li class="forli one">3</li>
 <li class="forli one">4</li>
 <li class="forli one">5</li>
 <li class="forli one">6</li>
 <li class="forli two">7</li>
</ul>​ 
```

完成此操作后，您可以在选择更改时过滤结果：

```
$("#estado_list").on("change", function(e){
    $("li.forli").each(function(){
      $(this).toggle( $(this).hasClass( e.target.value ) );  
    });
});​ 
```

演示：http: [//jsfiddle.net/JtFvK/1/](http://jsfiddle.net/JtFvK/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T00:02:21.723

id 字段应该是唯一的，并且在从 DOM 对象访问时会导致问题。尝试改用类字段。

```
<select name="" id="estado_list">
 <option value="list0">-</option>
 <option value="list1">Nuevo León</option>
 <option value="list2">Puebla</option>
</select>

<ul style="list-style: none outside none;">
 <li class="forli list1">data</li>
 <li class="forli list1">data</li>
 <li class="forli list1">data</li>
 <li class="forli list1">data</li>
 <li class="forli list1">data</li>
 <li class="forli list1">data</li>
 <li class="forli list2">data</li>
</ul>

 $(document).ready(function(){  
   $("#estado_list").change(function(){  
      $('.forli').hide().filter("."+$(this).val()).show();
   });
 }); 
```

# protocols - apache如何从自定义端口重定向到https协议？

> ID：10770631
> 
> 赞同：1
> 
> 时间：2012-05-26T23:50:14.997
> 
> 标签：protocols, apache

如何将[http://secure.domain.com:444](http://secure.domain.com:444)重定向到[https://secure.domain.com:444](https://secure.domain.com:444)？

使用此代码时出现 400 (Bad Request) 错误：

```
RewriteEngine
RewriteCond %{HTTPS} !=on
RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R,L] 
```

提前致谢。

编辑：

这是完整的配置：

```
 Listen 444
    NameVirtualHost ip:444

    <VirtualHost ip:444>
            ServerName secure.domain
            DocumentRoot "/var/www/.phpmyadmin/3.5.1/"

            RewriteEngine On
            RewriteCond %{HTTPS} !=on
            RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R,L]

            SSLEngine on
            SSLProtocol all -SSLv2
            SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:RC4+RSA:+HIGH:+MEDIUM

            SSLCertificateFile /etc/httpd/conf/domain.crt
            SSLCertificateKeyFile /etc/httpd/conf/domain.pwdless.key
            SSLCertificateChainFile /etc/httpd/conf/sub.class1.server.ca.pem
            SSLCACertificateFile /etc/httpd/conf/ca.pem

            <Directory "/var/www/.phpmyadmin/3.5.1/">
                    Options None
                    AllowOverride None
                    Order allow,deny
                    Allow from all
                    AuthType Basic
                    AuthName "Restriected Access"
                    AuthUserFile "/var/www/.phpmyadmin/.access"
                    Require valid-user
            </Directory>
    </VirtualHost>

    <VirtualHost ip:444>
            ServerName domain
            ServerAlias *.domain
            RedirectMatch 404 ".*"
    </VirtualHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T00:10:26.337

这是不可能的。服务器设置为仅接受该端口上的 SSL 请求。有一个 RFC 可以支持您所要求的内容（RFC 2817），但普通浏览器不支持它。[Chrome 错误跟踪器](http://code.google.com/p/chromium/issues/detail?id=4527)中的票证上有一些链接。

# internet-explorer - IE中的IFRAME无法显示透明度

> ID：10770633
> 
> 赞同：1
> 
> 时间：2012-05-26T23:51:39.440
> 
> 标签：internet-explorer, firefox, iframe

我有一个在 IE9 中工作的带有透明胶片的网站：`http://199.193.248.80/transparency.html`

但是如果我 iframe 那个页面，透明胶片在 IE 中停止工作：`http://199.193.248.80/iframe.html`

如何修复？我已经尝试了在谷歌上可以找到的所有技巧，包括`allowtransparency="true" frameborder=0`似乎没有任何效果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:59:44.453

完全重写的答案：

您处于怪癖模式。

IE 将 iframe 呈现为单独的文档节点，doctype 不被继承，quirks 是默认设置。您需要更改 iframe 中 HTML 文档的 DOCTYPE 以指示浏览器以标准模式运行。看看[这个链接](https://stackoverflow.com/questions/3717932/will-an-iframe-render-in-quirks-mode)。我想它会对你有所帮助。

# android - R.java 错误。不知道从哪里来。不知道如何解决

> ID：10770635
> 
> 赞同：3
> 
> 时间：2012-05-26T23:51:47.913
> 
> 标签：android, r.java-file

我正在创建一个 android 应用程序，当更改一些代码并运行它时，我被告知应用程序的 R.Java 文件中存在错误。我不知道这个错误来自哪里，我似乎无法修改它。

R.Java 中的代码是

```
public final class R {
    public static final class array {
    public static final int races_array=0x7f040000;
}
public static final class attr {
}
public static final class drawable {
    public static final int icon=0x7f020000;
    public static final int logo=0x7f020001;
}
public static final class id {
    public static final int 1=0x7f060007;//this line has the error 
    public static final int BMI=0x7f06001f;
    public static final int Cdate=0x7f060005;
    public static final int Current=0x7f060006;
    public static final int Days=0x7f06001e;
    public static final int activity=0x7f06001b;
    public static final int advice=0x7f060004;
    public static final int cals=0x7f060022;
    public static final int cheight=0x7f060013;
    public static final int choice=0x7f060019;
    public static final int code=0x7f06001d;
    public static final int cweight=0x7f06000a;
    public static final int date=0x7f060020;
    public static final int dateDisplay=0x7f060008;
    public static final int details=0x7f06001c;
    public static final int eheight=0x7f060011;
    public static final int eweight=0x7f060012;
    public static final int get=0x7f06000d;
    public static final int goal=0x7f060025;
    public static final int group=0x7f060023;
    public static final int newheight=0x7f060017;
    public static final int newweight=0x7f060016;
    public static final int nweight=0x7f06000c;
    public static final int out=0x7f06000e;
    public static final int out_text=0x7f060002;
    public static final int pass=0x7f060018;
    public static final int pickDate=0x7f060009;
    public static final int progress=0x7f06001a;
    public static final int start=0x7f060003;
    public static final int step=0x7f060001;
    public static final int steps=0x7f060021;
    public static final int t1=0x7f06000f;
    public static final int t2=0x7f060010;
    public static final int textView1=0x7f06000b;
    public static final int textView2=0x7f060024;
    public static final int textView3=0x7f060014;
    public static final int textView4=0x7f060015;
    public static final int tv=0x7f060000;
}
public static final class layout {
    public static final int activity=0x7f030000;
    public static final int advice=0x7f030001;
    public static final int choice=0x7f030002;
    public static final int convert=0x7f030003;
    public static final int main=0x7f030004;
    public static final int notes_row=0x7f030005;
    public static final int progress=0x7f030006;
    public static final int splash=0x7f030007;
}
    public static final class string {
        public static final int app_name=0x7f050001;
        public static final int hello=0x7f050000;
        public static final int race_elf=0x7f050003;
        public static final int race_goblin=0x7f050007;
        public static final int race_halfling=0x7f050006;
        public static final int race_human=0x7f050005;
        public static final int race_orc=0x7f050002;
        public static final int race_troll=0x7f050004;
    }
} 
```

我不知道这是否对任何人有帮助，但我只想知道是什么造成了这个错误以及如何解决它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-26T23:53:58.287

您在某处定义为 id `@+id/1`。`1`不会生成有效的 Java 标识符，因此会出现错误。出于同样的原因，不能创建名称以数字开头、包含空格或与保留关键字匹配的 ID 或资源。

# android - 为什么三星 Galaxy Ace 上的相机闪光灯不关闭？

> ID：10770637
> 
> 赞同：1
> 
> 时间：2012-05-26T23:52:12.590
> 
> 标签：android, camera, galaxy

我试过这段代码来打开/关闭闪光灯：

[在三星 Galaxy Ace 2.2.1 和 Galaxy Tab 中打开/关闭相机 LED/闪光灯](https://stackoverflow.com/questions/6939816/turn-on-off-camera-led-flash-light-in-samsung-galaxy-ace-2-2-1-galaxy-tab)

它对我有用，我的意思是它打开了闪光灯，但现在按下关闭按钮后我无法关闭闪光灯。

这是我的代码：

```
public class Main extends Activity
{
private Camera camera;
private Button buttonOn;
private Button buttonOff; 

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.main);

    buttonOn = (Button) findViewById(R.id.buttonOn);
    buttonOff = (Button) findViewById(R.id.buttonOff);

    buttonOn.setOnClickListener(new OnClickListener()
    {
        @Override
        public void onClick(View v)
        {
            try {
                 turnOn();
            } catch (Exception ex) {

            }
        }
    });

    buttonOff.setOnClickListener(new OnClickListener()
    {
        @Override
        public void onClick(View v)
        {
            try {
                 turnOff();
            } catch (Exception ex) {

            }
        }
    }); 
}

@Override
public void onPause(){
    super.onPause();
    if( camera != null )
       {
          camera.release();
          camera = null;
       }
       super.onPause(); 
}

@Override
public void onResume(){
    super.onResume();               
} 

@Override
public void onStart(){
    super.onStart();
}

@Override
public void onStop(){
    super.onStop();
}

@Override
public void onDestroy(){
    super.onDestroy();
}

@Override
public void onRestart(){
    super.onRestart();
}   

private void turnOff()
{               
        camera.stopPreview();
        camera.release();

   }

 private void turnOn() 
   {
            camera = Camera.open();  
            camera.startPreview();
            camera.autoFocus(new AutoFocusCallback() {
                        public void onAutoFocus(boolean success, Camera camera) {
                        }
                    });

            Parameters params = camera.getParameters();
            params.setFlashMode(Parameters.FLASH_MODE_ON);
            camera.setParameters(params);

            params = camera.getParameters();
            params.setFlashMode(Parameters.FLASH_MODE_OFF);
            camera.setParameters(params);

   }
} 
```

这样，在我先单击 buttonOff 后，LED 就会亮起。如果我在单击 buttonOff 之前单击 buttonOn，则它不起作用。一旦我这样做了，那么led就会一直亮着，但是当我点击buttonOff时我无法关闭它。

如果我把这部分代码：

```
 params = camera.getParameters();
            params.setFlashMode(Parameters.FLASH_MODE_OFF);
            camera.setParameters(params); 
```

在“关闭”功能而不是现在的位置，然后 LED 仅在 5 秒左右亮起。我尝试在两个部分之间使用 thread.sleep：Flash 模式打开和 Flash 模式关闭，正如我在帖子中所读到的，但它也不起作用。

对此有任何想法吗？

先谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:59:29.187

根据您提供的链接，您需要调用`Camera.release()`您的按钮...

# wordpress - WordPress：大空（？）空白

> ID：10770645
> 
> 赞同：0
> 
> 时间：2012-05-26T23:54:11.227
> 
> 标签：wordpress, containers, space

我的网站网址： http: [//piquantblog.com](http://piquantblog.com)

认为它不会回来困扰我，我给我的容器一个固定的高度，因为我无法弄清楚你在主页上看到的内容下方和页脚上方的巨大空白的原因。显然，当我开始编写帖子页面时，这最终干扰了我的布局。

现在我已经完成并制作了所有可能的容器 height:auto ，我似乎无法找到大量空白的原因。该空间在 Chrome 和 Firefox 中都可见，因此它似乎不是浏览器问题。

有任何想法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T00:18:19.537

chrome，右键单击空白，检查此元素。您现在可以将所有元素和 css 属性编辑为 html，直到找到解决方案。当你找到它时，编辑你的 css 和核心文件来解决它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T00:37:26.257

你的问题是相对定位。

我检查了您的代码，#container 元素中的所有元素都使用负上/左坐标和相对定位进行定位。

每次使用相对定位时，您应该想象应该被元素占用的空间仍然被占用，而位置坐标只是将元素的可视化移动到其他地方。

如果将这些元素的高度加起来，它们的总和将是 460+620+6*300 = 2880px。

为了以灵活的方式获得您想要的结果，您应该只在元素上使用**float: left**，确保所有元素都有一个明确定义的**宽度**（这很重要），最好还有一个**高度**（但这不是那么重要） .

并以 <br style="clear: both" /> 结束元素列表

这是一个经典的菜鸟错误。使用 relative 会产生额外的间距，使用 fixed/absolute 会使设计变得僵硬，使用 float 允许灵活性并避免空间。

## TL;博士

删除**位置：相对**；**顶部：NNpx**；**left：**来自#container 内所有项目的NNpx，例如#post-16，然后对#container 中的所有项目使用**float:left**。

您必须调整边距/填充等以在应用浮动后调整元素的距离。

# ruby-on-rails - 使用资源的简单 Rails 路由

> ID：10770646
> 
> 赞同：0
> 
> 时间：2012-05-26T23:54:35.167
> 
> 标签：ruby-on-rails, routing

我无法理解路由。另外，我正在尝试了解 routes.rb 中的资源（和资源）关键字。

我创建了 home_controller.rb，并将“资源：home”放在 routes.rb 中。我跑了 rake 路线，我可以看到所有这些东西，但我不知道如何处理它。我只是想显示一个带有表单的页面，比如 index.html.erb，提交表单，在控制器中执行一些操作，然后再次显示完全相同的页面。

我想我想调用一个 PUT "/home" 或其他东西，但我不确定我的 href 在 erb 页面中应该是什么样子。

那么，home_controller.rb 中的什么方法会捕获该提交？

然后，我是否可以重定向回 index.html.erb？

我尽量不使用脚手架或生成器，以便我能理解发生了什么。任何帮助表示赞赏。顺便说一句，导轨 3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T23:58:04.697

这太基本了。请参阅比我们的答案更详细的 Rails 文档。看

1.  [http://guides.rubyonrails.org/getting_started.html#rest](http://guides.rubyonrails.org/getting_started.html#rest)
2.  [http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T01:04:18.287

以下是您入门所需的简要说明：

1.  rails 应用程序中的每个 HTTP 请求都被路由到一个控制器方法。该控制器方法通过呈现某些内容或发出 302 重定向（这会导致浏览器发出不同的请求）来满足请求。

2.  ROR 中的路由描述了每个 HTTP 请求如何映射到每个控制器方法。HTTP 请求基于两个属性进行映射：**请求的 url**和**HTTP 动词**（`GET` `POST` `PUT`等）。

3.  当您`resources :homes`在`routes.rb`文件中执行此操作时，您是在告诉 Rails 您有一个名为的控制器，`HomesController`您是在要求 Rails 为该控制器设置其传统的 RESTful 路由。这些如下：

**网址`GET`上的HTTP`/homes`**

*   映射到`index`方法
*   通常用于列出所有的家庭记录

**网址`GET`上的HTTP`/homes/1`**

*   映射到`show`方法
*   通常用于显示家庭记录`id = 1`

**网址`GET`上的HTTP`/homes/new`**

*   映射到`new`方法
*   通常用于渲染表单以创建新的家庭记录

**网址`POST`上的HTTP`/homes`**

*   映射到`create`方法
*   `new`提交表格的地方
*   用于创建新的家庭记录
*   通常以重定向响应

**网址`GET`上的HTTP`/homes/1/edit`**

*   映射到`edit`方法
*   通常用于呈现用于编辑主记录的表单`id=1`

**网址`PUT`上的HTTP`/homes/1`**

*   映射到`update`方法
*   `edit`提交表格的地方
*   用于编辑记录`id=1`
*   通常以重定向响应

**网址`DELETE`上的HTTP`/homes/1`**

*   映射到`delete`方法
*   通常用于销毁记录`id=1`
*   通常以重定向响应

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T01:51:09.250

简而言之，resources 关键字指定您有一个对象（如用户、文章、帖子、评论等），您希望对其执行 Create Read Update 和 Delete 操作。它指定了 7 个操作，称为 RESTful 操作，可让您列出对象（索引）、更新（编辑、更新）、创建（新建、创建）或删除（销毁）。

这对应于控制器中的 7 个操作和 4 个视图文件（创建、更新和删除通常不会有自己的视图）。

rake 路线吐出路线、它们的路径和它们的路径助手。因此，您可以通过以下方式链接到索引操作/页面

```
<%= link_to 'New Article', new_article_path %> 
```

或其他各种用途，使您不必对可能随您的设计而改变的路径进行硬编码。

听起来，根据您的设计，您不需要所有 7 个动作。您只需要显示一个表单并根据输入的内容创建模型对象。所以你可能会做

```
resources :home, only => [:new, :create] 
```

您将在哪里显示新表单并在创建时将记录插入数据库。

# objective-c - Objective-C 堆栈跟踪

> ID：10770648
> 
> 赞同：15
> 
> 时间：2012-05-26T23:54:46.673
> 
> 标签：objective-c, exception, stack-trace

在 iPad 设备（以调试模式编译）上运行的 Objective-C 应用程序中使用`NSAssert()`引发`NSInternalInconsistencyException`异常的 a 后，我得到类似于：

```
2012-05-27 02:31:36.830 appname[10821:707] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'reason'
*** First throw call stack:
(0x3800788f 0x33338259 0x38007789 0x371f13a3 0x791a1 0x79555 0x79e03 0x7a44d 0x798d3 0x737fd 0x30e19c8b 0x30e18461 0x30e0ae87 0x30e7b7d5 0x30e18e6d 0x30e127dd 0x30de0ac3 0x30de0567 0x30ddff3b 0x3644122b 0x37fdb523 0x37fdb4c5 0x37fda313 0x37f5d4a5 0x37f5d36d 0x30e1186b 0x30e0ecd5 0x7343f 0x733e4)
terminate called throwing an exception 
```

我怎样才能找到*有用*的堆栈跟踪，它至少给我一个简单的列表，列出在抛出异常之前调用的所有函数？

Xcode 也无济于事：

[![](../Images/066dd67d0c2d86d0b0f27d17ac9e419e.png)](https://i.stack.imgur.com/3k3LQ.png)

`bt`在`lldb`节目中：

```
(lldb) bt
* thread #1: tid = 0x1c03, 0x30c6832c libsystem_kernel.dylib`__pthread_kill + 8, stop reason = signal SIGABRT
    frame #0: 0x30c6832c libsystem_kernel.dylib`__pthread_kill + 8
    frame #1: 0x331f920e libsystem_c.dylib`pthread_kill + 54
    frame #2: 0x331f229e libsystem_c.dylib`abort + 94
    frame #3: 0x37682f6a libc++abi.dylib`abort_message + 46
    frame #4: 0x3768034c libc++abi.dylib`_ZL17default_terminatev + 24
    frame #5: 0x33338356 libobjc.A.dylib`_objc_terminate + 146
    frame #6: 0x376803c4 libc++abi.dylib`_ZL19safe_handler_callerPFvvE + 76
    frame #7: 0x37680450 libc++abi.dylib`std::terminate() + 20
    frame #8: 0x37681824 libc++abi.dylib`__cxa_rethrow + 88
    frame #9: 0x333382a8 libobjc.A.dylib`objc_exception_rethrow + 12
    frame #10: 0x37f5d50c CoreFoundation`CFRunLoopRunSpecific + 404
    frame #11: 0x37f5d36c CoreFoundation`CFRunLoopRunInMode + 104
    frame #12: 0x30e1186a UIKit`-[UIApplication _run] + 550
    frame #13: 0x30e0ecd4 UIKit`UIApplicationMain + 1080
    frame #14: 0x0007343e appname`main + 86 at main.m:5 
```

这更好，但仍然不是很有用。我仍然不知道是什么导致了异常被抛出。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-05-27T00:03:02.423

一些有用的东西：

1.  如果您在 Xcode 之外运行应用程序，请添加异常断点。在断点导航器（command-6）中，点击左下角的“+”进行添加。这将在引发异常的行暂停执行，并允许您检查当前范围、堆栈等。

2.  如果您使用`bt`的是 gdb，请使用打印回溯

3.  如果您使用的是 lldb，请`thread backtrace`改用

# php - PHP - 复选框输入验证 - 将复选框的状态存储为会话变量？

> ID：10770652
> 
> 赞同：0
> 
> 时间：2012-05-26T23:55:37.597
> 
> 标签：php, validation, checkbox

我在为我的电子商务相关网站的 cms 部分构建一个验证和存储用户信息的页面时遇到了一些麻烦。

该页面的一部分包含一个选项，供用户选择是否需要与其送货地址不同的帐单地址。这是页面上的两种形式之一。

第一个表格是用户在需要备用帐单地址时选择的表格。

根据该选择，生成第二个表单，如果需要，则包含用于帐单地址的附加空间，或者不包含。

这是与第一种形式相关的 html，用于将事物置于上下文中：

```
<form name="isSameAsPostal" action="" method="post">
<table class="adminTable" align="center">
<thead class="tableAddEdit">
    <tr>
        <th colspan="4">Details</th>
        <th colspan="1">Active</th>
    </tr>
</thead>
<tfoot class="tableFooter">
    <tr>
        <td colspan="5">This table stores the users addittional information.</td>
    </tr>
</tfoot>
<tbody>
<tr>
    <td colspan="4">User has different billing address?</td>
    '.$topCont.'
</tr>
</tbody>
</table>
</form> 
```

如您所见，其自身的输入不包含在表单中，它被应用为在脚本控制器中设置的变量。

这是将事情放到上下文中的php：

```
if (isset($_POST['sameAsPostal']) && $_POST['sameAsPostal'] == 1)
{
    $_SESSION['sameAsPostal'] = 1;
    $topCont = '<td colspan="1"> <input type="checkbox" name="sameAsPostal" id="sameAsPostal" value="0" checked="checked" onChange="javascript:document.isSameAsPostal.submit();" title="Tick if user has alternate billing information." /> </td>';
    $otherCont = 'postal';
}
else if (isset($_POST['sameAsPostal']) && $_POST['sameAsPostal'] == 0)
{
    $_SESSION['sameAsPostal'] = 0;
    $topCont = '<td colspan="1"> <input type="checkbox" name="sameAsPostal" id="sameAsPostal" value="1" onChange="javascript:document.isSameAsPostal.submit();" title="Tick if user has alternate billing information." /> </td>';
    $otherCont = 'postal and billing';
}
else
{
    $_SESSION['sameAsPostal'] = 0;
    $topCont = '<td colspan="1"> <input type="checkbox" name="sameAsPostal" id="sameAsPostal" value="1" onChange="javascript:document.isSameAsPostal.submit();" title="Tick if user has alternate billing information." /> </td>';
    $otherCont = 'postal and billing';
} 
```

如您所见，javascript 用于在输入状态发生更改时自动提交表单。

现在基于此，一切都几乎可以正常工作，就像我最初开始使用它时所想的那样。

根据控制器，勾选复选框，会话变量`$sameAsPostal`设置为“1”，用于触发在第二个表单中生成额外计费选项。

与此一起，复选框的值变为“0”，因此允许取消选中该复选框，并删除第二种形式的计费信息，如`$sameAsPostal`控制器脚本的第二部分所示，将设置为 0。控制器的最后一部分作为输入添加到页面的第一个实例包含在内。没有它就没有输入。

太好了，就像我说的那样，这一切都有效。但是我现在面临的问题是下一个合乎逻辑的补充。当第二个表单被验证并遇到输入错误时，页面会刷新并应用正确的错误突出显示。在此范围内，复选框也被重置，导致计费信息部分消失。（填充各个输入的信息仍被存储，但它的实际 html 已消失，因为复选框已被重置）

所以我尝试了对控制器的这个添加：

```
if (isset($_POST['sameAsPostal']) && $_POST['sameAsPostal'] == 1)
{
    $_SESSION['sameAsPostal'] = 1;
    $topCont = '<td colspan="1"> <input type="checkbox" name="sameAsPostal" id="sameAsPostal" value="0" checked="checked" onChange="javascript:document.isSameAsPostal.submit();" title="Tick if user has alternate billing information." /> </td>';
    $otherCont = 'postal';
}
else if (isset($_POST['sameAsPostal']) && $_POST['sameAsPostal'] == 0)
{
    $_SESSION['sameAsPostal'] = 0;
    $topCont = '<td colspan="1"> <input type="checkbox" name="sameAsPostal" id="sameAsPostal" value="1" onChange="javascript:document.isSameAsPostal.submit();" title="Tick if user has alternate billing information." /> </td>';
    $otherCont = 'postal and billing';
}
else if (isset($_SESSION['sameAsPostal']) && $_SESSION['sameAsPostal'] == 1)
{
    $topCont = '<td colspan="1"> <input type="checkbox" name="sameAsPostal" id="sameAsPostal" value="0" checked="checked" onChange="javascript:document.isSameAsPostal.submit();" title="Tick if user has alternate billing information." /> </td>';
    $otherCont = 'postal';
}
else if ((isset($_SESSION['sameAsPostal']) && $_SESSION['sameAsPostal'] == 1) && (isset($_POST['sameAsPostal']) && $_POST['sameAsPostal'] == 0))
{
    $_SESSION['sameAsPostal'] = 0;
    $topCont = '<td colspan="1"> <input type="checkbox" name="sameAsPostal" id="sameAsPostal" value="1" onChange="javascript:document.isSameAsPostal.submit();" title="Tick if user has alternate billing information." /> </td>';
    $otherCont = 'postal and billing';
}
else
{
    $_SESSION['sameAsPostal'] = 0;
    $topCont = '<td colspan="1"> <input type="checkbox" name="sameAsPostal" id="sameAsPostal" value="1" onChange="javascript:document.isSameAsPostal.submit();" title="Tick if user has alternate billing information." /> </td>';
    $otherCont = 'postal and billing';
} 
```

老实说，还有很多其他人......但似乎我的逻辑和这项任务所涉及的实际逻辑似乎有所不同。

对控制器的此添加使复选框在选中时无法取消选中。

我添加了会话变量以捕获复选框的状态，然后首先将正确的输入应用于第一个表单，然后在需要时生成账单信息部分。

但似乎无论我如何配置控制器脚本，我似乎都无法让它以这种方式工作。

可以提供一些有关我在哪里出错的信息或提出建议吗？

提前感谢您抽出宝贵时间阅读本文！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:21:08.790

如果要使用`$_SESSION`变量，则需要确保每次都开始会话，以保存这些值。我将假设您在第一次提交表单后存储复选框值，从`$_POST`数组中获取它。

您可以改为从提交的表单中检查该值，但为了将其与您的问题联系起来，我所能想到的就是您没有正确启动会话。

顺便说一句，您只需要像这样检查它，因为即使没有设置它也不会破坏您的代码。我认为你把事情复杂化了一点。

```
if($_SESSION['sameAsPostal'] == 1){
    //Do your code for checked
}else{
    //Do your code for unchecked
} 
```

总而言之，确保您`session_start()`在代码中的第一件事，并从提交的表单中获取值 (0,1)。要根据变量的值标记一个复选框，您可以执行以下更简单的操作：

```
$checked = ($_SESSION['variable'] == 1)?1:0;
echo "<input type='checkbox' value='$checked' title='My checkbox' />"; 
```

**请注意**，如果您使用 AJAX 发送表单并且页面从未真正重新加载，那么 PHP 当然不会做任何其他事情，因为它只执行一次，在用户看到实际页面之前。也许您假设将反映变量客户端的更改，但除非您重新执行该服务器端代码（刷新页面），否则它不会。

# xslt - xslt 重复元素和排序

> ID：10770656
> 
> 赞同：-2
> 
> 时间：2012-05-26T23:57:05.410
> 
> 标签：xslt, sorting, copy, element

> **可能重复：**
> [xslt 复制然后修改元素并排序](https://stackoverflow.com/questions/10761186/xslt-copy-then-modify-element-and-sort)

我有一些xml：

```
 <?xml version="1.0" encoding="utf-8"?>
<fruit namespace="basket">  
  <apple>
    <type>cox</type>
    <size>medium</size>
  </apple>  
  <orange>  
    <type>valencia</type>
    <size>large</size>
  </orange>  
</fruit> 
```

想象有更多的水果实例，订单可以是任何东西。我想使用 xslt：

1.  复制 apple 元素并将 type 元素更改为“cooking apple”。
2.  在结果树中为下一位添加该元素
3.  按类型对所有水果进行排序，包括新添加的苹果元素

我需要它看起来像

```
<?xml version="1.0" encoding="utf-8"?>
<fruit namespace="basket">  
  <apple>
    <type>cooking</type>
    <size>large</size>
  </apple>  
  <apple>
    <type>cox</type>
    <size>medium</size>
  </apple>  
  <orange>  
    <type>valencia</type>
    <size>large</size>
  </orange>  
</fruit> 
```

谁能告诉我 xslt 对此有何要求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T01:22:27.093

如果您有 XSLT 2.0 或被允许使用 EXSLT，那么您[`exslt:node-set`](http://www.exslt.org/exsl/functions/node-set/index.html)可以这样做。

声明一个包含要添加的节点的变量，像这样

```
<xsl:variable name="fruit">
  <apple>
    <type>cooking</type>
    <size>large</size>
  </apple>
</xsl:variable> 
```

并将其与`exslt:node-set()`sorted 中的现有节点一起使用`<xsl:for-each>`，如下所示

```
<xsl:template match="/*">
  <xsl:copy>
    <xsl:copy-of select="@*" />
    <xsl:for-each select="*|exslt:node-set($fruit)">
      <xsl:sort select="type" />
      <xsl:copy-of select="current()" />        
    </xsl:for-each>
  </xsl:copy>
</xsl:template> 
```

如果您使用的是 XSLT 2.0，那么您可以`exslt:node-set()`从变量周围删除调用。否则记得使用`exclude-result-prefixes="exslt"`以保持输出整洁！

# python - 如何实时监控子进程

> ID：10770660
> 
> 赞同：1
> 
> 时间：2012-05-26T23:57:29.570
> 
> 标签：python, subprocess, multiprocessing, monitor, interactive

我是python的新手。

我目前正在做一个项目。

通过单击按钮 A，命令“adb shell getevent”将在一个子进程中执行。结果将写入文件。如果有人点击连接的设备，则会不时出现结果。

它将通过单击按钮 B 停止。

```
class MyClass():
...
    def recordCmd(self):
        cmd = []
        cmd.append("adb")
        cmd.append("shell")
        cmd.append("getevent")
        cmd.append("/dev/input/event0")
        p = subprocess.Popen(cmd, stdin=PIPE, stdout=PIPE)
        for line in p.stdout:
            print line

    def OnRecordEvent(self, event):
    '''
     call "adb shell getevent /dev/input/event0 " to collect events
     '''
    mp = multiprocessing.Process(target=self.recordCmd, args=(self,))
    mp.daemon= True
    mp.start()
.... 
```

这不起作用，会引发以下错误：

```
File "C:\Python27\lib\multiprocessing\forking.py", line 271, in __init__
dump(process_obj, to_child, HIGHEST_PROTOCOL)
File "C:\Python27\lib\multiprocessing\forking.py", line 193, in dump
ForkingPickler(file, protocol).dump(obj)
File "C:\Python27\lib\pickle.py", line 224, in dump
self.save(obj)
File "C:\Python27\lib\pickle.py", line 331, in save
self.save_reduce(obj=obj, *rv)
File "C:\Python27\lib\pickle.py", line 419, in save_reduce
save(state)
File "C:\Python27\lib\pickle.py", line 286, in save
f(self, obj) # Call unbound method with explicit self
File "C:\Python27\lib\pickle.py", line 649, in save_dict
self._batch_setitems(obj.iteritems())
File "C:\Python27\lib\pickle.py", line 681, in _batch_setitems
save(v)
File "C:\Python27\lib\pickle.py", line 286, in save
f(self, obj) # Call unbound method with explicit self
File "C:\Python27\lib\multiprocessing\forking.py", line 66, in dispatcher
self.save_reduce(obj=obj, *rv)
File "C:\Python27\lib\pickle.py", line 401, in save_reduce
save(args)
File "C:\Python27\lib\pickle.py", line 286, in save
f(self, obj) # Call unbound method with explicit self
File "C:\Python27\lib\pickle.py", line 548, in save_tuple
save(element)
File "C:\Python27\lib\pickle.py", line 331, in save
self.save_reduce(obj=obj, *rv)
File "C:\Python27\lib\pickle.py", line 419, in save_reduce
save(state)
File "C:\Python27\lib\pickle.py", line 286, in save
f(self, obj) # Call unbound method with explicit self
File "C:\Python27\lib\pickle.py", line 649, in save_dict
self._batch_setitems(obj.iteritems())
File "C:\Python27\lib\pickle.py", line 681, in _batch_setitems
save(v)
File "C:\Python27\lib\pickle.py", line 331, in save
self.save_reduce(obj=obj, *rv)
File "C:\Python27\lib\pickle.py", line 419, in save_reduce
save(state)
File "C:\Python27\lib\pickle.py", line 286, in save
f(self, obj) # Call unbound method with explicit self
File "C:\Python27\lib\pickle.py", line 649, in save_dict
self._batch_setitems(obj.iteritems())
File "C:\Python27\lib\pickle.py", line 686, in _batch_setitems
save(v)
File "C:\Python27\lib\pickle.py", line 331, in save
self.save_reduce(obj=obj, *rv)
File "C:\Python27\lib\pickle.py", line 396, in save_reduce
save(cls)
File "C:\Python27\lib\pickle.py", line 286, in save
f(self, obj) # Call unbound method with explicit self
File "C:\Python27\lib\pickle.py", line 748, in save_global
(obj, module, name))
pickle.PicklingError: Can't pickle <type 'PySwigObject'>: it's not found as __builtin__.PySwigObject 
```

谁可以帮我这个事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T06:30:41.643

`multiprocessing``pickle`在进程之间复制对象时使用。错误消息似乎表明`MyClass`包含无法腌制的东西。

您可以将该`recordCmd`函数从类中取出，因为它`self`无论如何都没有引用。

# c++ - 链表数组的堆栈溢出问题

> ID：10770663
> 
> 赞同：-1
> 
> 时间：2012-05-26T23:58:13.090
> 
> 标签：c++

对于初学者，我的程序是创建一个名称哈希表，其中通过链接处理 collison。所以我创建了一个链表数组。问题是我的数组非常大，确切地说是 88801。我想这就是为什么我让堆栈溢出但我不确定。我的代码如下。有人试图告诉我让数组成为一组指向链表的指针。
IE 将 LinkedList* hashbucket1[88801] 这消除了堆栈溢出问题但导致其他链接错误。猜猜我试图找出实现字符串链表数组的最佳方法是什么。如果我在正确的轨道上并且它的一些小东西在看，请指出它或告诉我放弃它并从给定的路径重新开始。如果我需要链接或压缩我的其他文件，请告诉我，我可以。

```
#include <iostream>
#include "LinkedList.h"
#include <string>
#include <fstream>

using namespace std;

 unsigned long djb2(string& str) 
 { 
 unsigned long hash = 5381; 

  for(string::iterator it = str.begin();it!=str.end();it++)  
    hash = ((hash << 5) + hash) + *it; /* hash * 33 + character */ 

 return hash; 
 }

  static unsigned long sdbm(string& str)
{
    unsigned long hash = 0;
    int c;

   for(string::iterator it = str.begin();it!=str.end();it++)
        hash = *it + (hash << 6) + (hash << 16) - hash;

    return hash;
  }

  void insert(LinkedList HashList1[], LinkedList HashList2[], int listSize);

    int main() {
char command;
int listSize = 88801;
LinkedList HashList1[88801];
LinkedList HashList2[88801];
bool invalidcommand;
do{
    do{
        cout << "MENU" << endl;
        cout << "(I)nsert new entry" << endl;
        cout << "(S)earch" << endl;
        cout << "(D)elete Entry" << endl;
        cout << "(C)reate Hast Table" << endl;
        cout << "(L)og File" << endl;
        cout << "(Q)uit and Exit Program" << endl;

        cin >> command;

    if(command == 'I'){
        insert(HashList1, HashList2, listSize);
    }else if(command == 'S'){
  //            search(HashList1, HashList2, listSize);
    }else if(command == 'D'){

    }else if(command == 'L'){ 
    //  save(HashList1, HashList2, listSize);
    }else if(command == 'C'){
    //  load(HashList1, HashList2, listSize);
    }
}while(command != 'Q');

return 0;
    };

    void insert(LinkedList HashList1[], LinkedList HashList2[], int listSize){

string lastName;
bool invalidID;
//Person newPerson;
do
{
    invalidID = false;
    cout << "Please enter Last Name: ";
    cin >> lastName;
    while(cin.fail())
    {
        cin.clear();
        cin.ignore();
    }
}while(invalidID);
//newPerson.setLastName(lastName);
int hashBucket1;
int hashBucket2;
hashBucket1 = djb2(lastName) % listSize;
hashBucket2 = sdbm(lastName) % listSize;
LinkedList bucket1;
if(!HashList1[hashBucket1].find(lastName)){     
    //HashList1[hashBucket1].insert(newPerson);
    HashList1[hashBucket1].insert(lastName);

}else{
    if(!bucket1.find(lastName)){

        HashList1[hashBucket1].insert(lastName);
    }else{
    cout << "List already contains an entry with the last name " << lastName << endl;
    }
}
LinkedList bucket2;
if(HashList2[hashBucket2].find(lastName)){
//  bucket2.insert(newPerson);
}else{
    if(!bucket2.find(lastName)){
        //bucket2.insert(newPerson);
    }else{
    cout << "List already contains an entry with the last name " << lastName << endl;
    }
}
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:02:17.540

正如您正确怀疑的那样，您的问题是您的堆栈空间不足。您不应该将这么大的对象放在堆栈上，这是一种有限且宝贵的资源。相反，您可以使用指针并在堆上动态分配它们。

有问题的代码在这里：

```
int main() {
char command;
int listSize = 88801;
LinkedList HashList1[88801]; // << this
LinkedList HashList2[88801]; // << and this 
```

另请注意，这`LinkedList* hashbucket1[88801]`是一个指针数组，而不是指向数组的指针。你想要的是：

```
LinkedList (*HashList1)[88801] 
```

或者，`typedef`为了使其更具可读性：

```
typedef LinkedList LinkedListArray[88801];
LinkedListArray* HashList1; 
```

但到那时最好这样做：

```
LinkedList *HashList1 = new LinkedList[88801]; 
```

# ios5 - 当我的segue发生在另一个segue太近时，为什么它不会出现？

> ID：10770664
> 
> 赞同：1
> 
> 时间：2012-05-26T23:58:19.960
> 
> 标签：ios5, segue

我有一个 iOS 应用程序使用带有视图控制器的情节提要，该视图控制器连接到两个不同的模式视图控制器。一个segue由按钮触发，一个由计时器触发。除非按钮内部的触摸和计时器太靠近，否则它们都可以正常工作。如果按钮的转场发生在计时器的转场之前，按钮的转场会运行，但计时器的转场不会出现，即使调用了 prepareForSegue 也是如此。

这是 prepareForSegue 代码，

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"segueFromTimer"]) {        

        // Get destination view
        fromTimerViewController *vcTimer = [segue destinationViewController];

        // do some stuff
        // ...
    }

    if ([[segue identifier] isEqualToString:@"segueFromButton"]) { 

        // Get destination view
        fromButtonViewController *vcButton = [segue destinationViewController];

        // do some stuff
        // ...
     }
} 
```

我可以在 prepareForSegue 中设置断点，并看到它被 id = segueFromTimer 调用，并且 destinationViewController 看起来有效，但 segueFromTimer segue 从未出现。

# php - 用于编辑信息的 cakephp auth 组件

> ID：10770667
> 
> 赞同：0
> 
> 时间：2012-05-26T23:59:05.993
> 
> 标签：php, mysql, cakephp

我正在尝试创建一个链接来编辑用户的信息。id 为 1 的人的 url 将是 users/edit/1

```
echo $this->Html->link('Edit Info', array( 
   'controller' => 'users',  
   'action' => 'edit',
    AuthComponent::user('id')
)); 
```

URL 正确显示。但是，我试图限制它，以便只有具有该 ID 的用户才能编辑他们的页面。因此，假设用户 4 尝试编辑用户 1 的信息，它将重定向。

这是用户控制器中应该重定向的编辑操作的一部分。

```
if($id !== AuthComponent::user('id')){
        $this->redirect(array('controller'=>'posts','action'=> 'index'));
    } 
```

我收到以下错误

```
Parse error: syntax error, unexpected '=', expecting ')' in /Applications/XAMPP/xamppfiles/htdocs/cake/app/Controller/UsersController.php on line 42 
```

**编辑 - 让它工作，感谢您的帮助**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:13:16.433

您可能不想按照您描述的方式进行操作。如果我是你，我会单独路由到类似的东西，然后让它转到控制器`/profile/edit`中的特定操作。`user`在该操作中，您将从会话中获取登录用户的用户 ID，查找用户，然后向他们显示编辑视图以获取他们的信息。

这将使您的链接生成看起来像：

```
echo $this->Html->link('Edit Info', array( 
   'controller' => 'users',  
   'action' => 'edit_profile'
)); 
```

# c++ - 将数据流写入磁盘的最快方法

> ID：10770675
> 
> 赞同：3
> 
> 时间：2012-05-27T00:01:37.080
> 
> 标签：c++

我有一个以大约 100 帧/秒的速度从相机传入的图像流，每个图像大约 2 MB。现在仅仅因为磁盘写入速度，我知道我无法写入每一帧，所以我只尝试每秒保存大约三分之一的帧。

流是大型字符数组的循环缓冲区。现在我正在使用 fwrite 将每个数组转储到一个临时文件，因为它被缓冲，但它似乎只以大约 20-30 MB/s 的速度写入，而硬盘驱动器理论上应该达到 80-100 MB/ s

有什么想法吗？有没有比 fwrite() 更快的编写方法或优化它的方法？更一般地说，将大量数据转储到标准硬盘驱动器的最快方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T01:31:02.970

如果您将使用限制为例如每个 1GB 的内存映射文件怎么办？这应该提供足够的速度和缓冲区来处理所有帧，尤其是在您设法执行零拷贝帧分配的情况下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T00:17:11.350

`fwrite`被缓冲，这就是你想要的。尽管有了这么大的文件/写入，它不应该有太大或任何区别。也许在调用时尝试使用更大的流缓冲区`setbuf`。

由于您受到物理磁盘 i/o 速度的限制，只要您尽可能简单地让系统有效地使用每个可用的磁盘 io，您就无能为力了。

`vmstat`在 linux 上（其他系统上的其他类似工具）可以告诉您磁盘正在执行多少磁盘 i/os，因此您可以测试您的更改是否有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T04:25:45.490

在您的案例中，异步非缓冲输出是成功的关键。缓冲 IO 只会导致双缓冲开销，而同步 IO 会使 HDD 磁头丢失顺序扇区。

Boost.Asio 为流行平台提供了一个相对较好的系统特定 API 封装。

有几件事要记住：

*   在大多数非 Windows 平台上，您将不得不写入原始分区以获取系统的缓冲和内部线程。
*   始终保持写入队列非空，因此 SATA 控制器可以通过 NCQ 帮助您。
*   注意系统特定的缓冲区对齐和大小要求，以使异步非缓冲 IO 正常工作。
*   文件打开模式对于使系统做你想做的事情也很重要。

# stored-procedures - Sql Server 查询优化技巧

> ID：10770684
> 
> 赞同：0
> 
> 时间：2012-05-27T00:04:14.560
> 
> 标签：stored-procedures, query-optimization, user-defined-functions, indices

我的存储过程需要很长时间才能执行。任何人都可以建议我做什么来加快存储过程，除了使用一些好的做法来写下查询。我听说过创建索引，但我不确定它们是什么。请建议所有加快查询速度的最佳方法。谢谢

```
CREATE PROCEDURE [dbo].[usp_GetAlternates]
(
  @NNumber CHAR(11) ,
  @pid INT ,
  @pbmid INT
)
AS 
BEGIN
    TRUNCATE TABLE TempTherapeuticAlt
    INSERT  INTO TempTherapeuticAlt
            SELECT  NULL AS MedicationID ,
                    PR.ePrescribingName AS MedicationName ,
                    U.Strength AS MedicationStrength ,
                    FRM.FormName AS MedicationForm ,
                    PR.DEAClassificationID AS DEASchedule ,
                    NULL AS NDCNumber
            FROM    Product PR
                    JOIN ( SELECT   MP.MarketedProductID
                           FROM     table2 TCTSP
                                    JOIN table3 MP ON MP.SpecificProductID = TCTSP.SpecificProductID
                                    JOIN ( SELECT   TCTSP.TherapeuticConceptTreeID
                                           FROM     table3 MP
                                                    JOIN table2 TCTSP ON MP.SpecificProductID = TCTSP.SpecificProductID
                                                    JOIN ( SELECT
                                                          PR.MarketedProductID
                                                          FROM
                                                          table4 PA
                                                          JOIN Product PR ON PA.ProductID = PR.ProductID
                                                          WHERE
                                                          PA.NDC11 = @NNumber
                                                         ) PAPA ON MP.MarketedProductID = PAPA.MarketedProductID
                                         ) xxx ON TCTSP.TherapeuticConceptTreeID = xxx.TherapeuticConceptTreeID
                         ) MPI ON PR.MarketedProductID = MPI.MarketedProductID
                    JOIN ( SELECT   P.ProductID ,
                                    O.Strength ,
                                    O.Unit
                           FROM     Product AS P
                                    INNER JOIN table3 AS M ON P.MarketedProductID = M.MarketedProductID
                                    INNER JOIN table5 AS S ON M.SpecificProductID = S.SpecificProductID
                                    LEFT OUTER JOIN table6 AS O ON S.SpecificProductID = O.SpecificProductID
                           GROUP BY P.ProductID ,
                                    O.Strength ,
                                    O.Unit
                         ) U ON PR.ProductID = U.ProductID
                    JOIN ( SELECT   PA.ProductID ,
                                    S.ScriptFormID ,
                                    F.Code AS NCPDPScriptFormCode ,
                                    S.FormName
                           FROM     table4 AS PA
                                    INNER JOIN table7 AS S ON PA.NCPDPScriptFormCode = S.NCPDPScriptFormCode
                                    INNER JOIN table8 AS F ON S.FormName = F.FormName
                           GROUP BY PA.ProductID ,
                                    S.ScriptFormID ,
                                    F.Code ,
                                    S.FormName
                         ) FRM ON PR.ProductID = FRM.ProductID
            GROUP BY PR.ePrescribingName ,
                    U.Strength ,
                    FRM.FormName ,
                    PR.DEAClassificationID
            ORDER BY pr.ePrescribingName

    SELECT  LL.ProductID AS MedicationID ,
            temp.MedicationName ,
            temp.MedicationStrength ,
            temp.MedicationForm ,
            temp.DEASchedule ,
            temp.NDCNumber ,
            fs.[ReturnFormulary] AS FormularyStatus ,
            copay.CopaTier ,
            copay.FirstCopayTerm ,
            copay.FlatCopayAmount ,
            copay.PercentageCopay
    FROM    TempTherapeuticAlt temp
            OUTER APPLY ( SELECT TOP 1
                                    ProductID
                          FROM      Product
                          WHERE     ePrescribingName = temp.MedicationName
                        ) AS LL
            OUTER APPLY function1(@pid, LL.ProductID, @pbmid) AS fs
            OUTER APPLY function2(LL.ProductID, @pbmid) AS copay
    ORDER BY LL.ProductID

    TRUNCATE TABLE TempTherapeuticAlt
END 
```

去

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:07:55.283

这里有几个：

1.  WHERE 子句中的每一列都应该有索引。请参阅您的 SQL 语言以了解如何执行此操作。
2.  学习如何解释计划，看看什么是慢的。
3.  存储过程语言是功能性的，不是基于集合的。使用 JOIN 并且不要陷入 (n+1) 查询/迭代陷阱。
4.  了解使用某些函数如何迫使您在 WHERE 子句中进行 TABLE SCAN。

# opengl - 在 GLSL 中设置矩阵不起作用

> ID：10770689
> 
> 赞同：4
> 
> 时间：2012-05-27T00:05:25.003
> 
> 标签：opengl, glsl

我有这个着色器代码（GLSL）：

`#version 420`

 ````
in vec4 vertex;

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;

void main()
{
    gl_Position = modelViewMatrix * projectionMatrix * vertex;
} 
````  `如果我*不*设置modelViewMatrix 和projectionMatrix，它运行没有错误。如果我这样做了，当我尝试绘制时，OpenGL 会抛出一个 Invalid Operation 异常。

我通过以下代码设置矩阵：

`glUniformMatrix4fv(location, 1, false, sendArray);` 我已经验证“location”和“sendArray”包含正确的数据。这里发生了什么？

编辑：问题似乎出在 glUniformMatrix4fv 调用中，但我不知道它有什么问题。

要设置的代码`location`如下：

`GLint location;`

 ````
GLint location = glGetUniformLocation(this->programID, uniform.c_str());

if (location == -1)
{
    throw ShaderVariableNotFoundException(uniform, this->programID);
} 
````  `* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-27T01:09:36.510

我修复了它，但我不愿意告诉你所有的解决方案，因为它是多么令人尴尬......

一世...

我忘了绑定着色器程序。

我很抱歉浪费了你所有的时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-27T00:09:56.103

您正在通过`16`计数，这是错误的。

从[文档中](http://www.opengl.org/sdk/docs/man/xhtml/glUniform.xml)：

> 该`count`参数指示要传递的矩阵的数量。`count`如果修改单个矩阵的值，应使用 1 的A ，`count`大于 1 可用于修改矩阵数组。

你得到了预期的错误，每

> `GL_INVALID_OPERATION`如果`count`大于 1 并且指示的统一变量不是数组变量，则生成。

文档的注释部分再次告诉您

> 如果`count`大于 1 并且指示的统一变量不是数组，`GL_INVALID_OPERATION`则会产生错误并且指定的统一变量将保持不变。``

# php - 在php中使用ajax json响应数组

> ID：10770691
> 
> 赞同：1
> 
> 时间：2012-05-27T00:06:28.750
> 
> 标签：php, javascript, ajax, json

我用 json 响应制作了一个 ajax 表单。json 数组包含来自 mysql 数据库的信息。现在我想在表格中显示这些数据。

我在隐藏的 html 文件中创建了一个占位符。

这是我的 ajax/json 部分代码：

```
$("#select_coffee_talk_year").button().click(function() {
    var form = $('#coffee_talk_year');  
    var data = form.serialize();

    $.ajax({
        url: "include/scripts/select_event.php",
        type: "POST",
        data: data,
        dataType: 'json',
        success: function (select) {
            //alert(select.ID[0]);
            //alert(select.ID[1]);
            //alert(select.ID.length);

            $("#coffee_talk").fadeOut();
            $("#coffee_talk").fadeIn();
        }   
    });
    return false;
}); 
```

这是我的html：

```
<p class="bold underline headline">Bereits eingetragen:</p>
    <form id="coffee_talk_year" action="include/scripts/select_event.php" method="post" accept-charset="utf-8"> 
        <select name="year_coffee_talk" id="year_coffee_talk">
            <option value="none" class="bold italic">Jahr</option>
            <?php
                for($i=2008; $i<=$year; $i++){
                    if ($i == $year) {
                        echo "<option value=\"".$i."\" selected=\"$i\">".$i."</option>\n";
                    } else  echo "<option value=\"".$i."\">".$i."</option>\n";
                }   
            ?>
        </select>
        &nbsp;&nbsp;
        <button id="select_coffee_talk_year">anzeigen</button>
        <input type="hidden" name="coffee_talk_year_submit" value="true" />​​​​​​​​​​​​​​​​​
    </form>
    <br />
    <div id="coffee_talk"></div>
    <br />
    <button id="add_coffee_talk">hinzufügen</button> 
```

选择事件.php：

```
if ('POST' == $_SERVER['REQUEST_METHOD']) {
    /*******************************/
    /** Erzaehlcafe auswählen
    /*******************************/
    if (isset($_POST['coffee_talk_year_submit'])) {
        $getID = array();
        $getDate = array();
        $getTheme = array();
        $getContributer = array();
        $getBegin = array();
        $getPlace = array();
        $getEntrance = array();
        $getFlyer = array();

        $sql = "SELECT 
                    ID,
                    Date,
                    Theme,
                    Contributer,
                    Begin,
                    Place,
                    Entrance,
                    Flyer
                FROM 
                    Coffee_talk
                WHERE
                    YEAR(Date) = '".mysqli_real_escape_string($db, $_POST['year_coffee_talk'])."'
                ";

        if (!$result = $db->query($sql)) {
            return $db->error;
        }

        while ($row = $result->fetch_assoc()) {
            $getID[$i] = $row['ID'];
            $getDate[$i] = $row['Date'];
            $getTheme[$i] = $row['Theme'];
            $getContributer[$i] = $row['Contributer'];
            $getBegin[$i] = $row['Begin'];
            $getPlace[$i] = $row['Place'];
            $getEntrance[$i] = $row['Entrance'];
            $getFlyer[$i] = $row['Flyer'];
            $i++;
        }

        $result->close();

        $response['ID'] = $getID;
        $response['Date'] = $getDate;
        $response['Theme'] = $getTheme;
        $response['Contributer'] = $getContributer;
        $response['Begin'] = $getBegin;
        $response['Place'] = $getPlace;
        $response['Entrance'] = $getEntrance;
        $response['Flyer'] = $getFlyer;

        echo json_encode($response);
    }
} 
```

id=coffee_talk 的 div 是我的占位符。现在我希望使用其数据淡入表格，如果我更改年份并使用按钮提交它，我希望将旧的淡出并淡入新的。

我唯一的问题是我需要用循环在 php 中编写这个表。但我认为这在 Java Script 中是不可能的。我该怎么办？

PS我使用了ajax，因为我不想一直重新加载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:22:24.787

您的快速解决方案是：

```
$("#select_coffee_talk_year").button().click(function() {
    var form = $('#coffee_talk_year');  
    var data = form.serialize();

    $.ajax({
        url: "include/scripts/select_event.php",
        type: "POST",
        data: data,
        dataType: 'json',
        success: function (select) {
            var coffee_talk = $("#coffee_talk");
            coffee_talk.fadeOut('fast', function() {
                for(i in select) {
                    row = select[i];
                    div = coffee_talk.append('<div id="row_'+i+'" />');
                    for(column in row) {
                       div.append('<span class="column_'+column+'">'+row[column]+'</span>');
                    }
                }
                coffee_talk.fadeIn();
            });
        }   
    });
    return false;
}); 
```

对于更好的方法，您应该查找**Moustache.js**，它是一个客户端 JavaScript 模板引擎（它在 PHP/Java/Ruby/Python/Go 和其他语言中具有等价物，并且基于 Google CTemplates）。

它将允许您创建 HTML 模板并使用变量中的数据填充它们，例如 AJAX 请求可能收到的 JSON 变量。

# ruby-on-rails - 你可以使用 Ruby on Rails 创建一个可以访问手机位置的移动网站吗？

> ID：10770696
> 
> 赞同：0
> 
> 时间：2012-05-27T00:07:58.320
> 
> 标签：ruby-on-rails, web-applications, mobile

我正处于规划一个可以访问手机位置的移动网站的初期阶段。

我没有移动开发经验，我的经验在于 Ruby on Rails。我的问题是我是否可以使用 Ruby on Rails 构建这种类型的网站。是否可以在移动网站上获取用户的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:19:34.237

尝试类似这个库[http://code.google.com/p/geo-location-javascript/](http://code.google.com/p/geo-location-javascript/)。它应该有助于从您的移动设备获取位置。

# r - 了解日期并在 R 中使用 ggplot2 绘制直方图

> ID：10770698
> 
> 赞同：67
> 
> 时间：2012-05-27T00:08:44.797
> 
> 标签：r, datetime, ggplot2, histogram

## 主要问题

在尝试使用 ggplot2 制作直方图时，我无法理解为什么日期、标签和中断的处理不像我在 R 中所期望的那样工作。

**我在找：**

*   我的约会频率的直方图
*   在匹配栏下方居中的刻度线
*   日期标签`%Y-b`格式
*   适当的限制；最小化网格空间边缘和最外层条之间的空白空间

我已将[我的数据上传到 pastebin](http://pastebin.com/sDzXKFxJ)以使其可重现。我创建了几列，因为我不确定最好的方法：

```
> dates <- read.csv("http://pastebin.com/raw.php?i=sDzXKFxJ", sep=",", header=T)
> head(dates)
       YM       Date Year Month
1 2008-Apr 2008-04-01 2008     4
2 2009-Apr 2009-04-01 2009     4
3 2009-Apr 2009-04-01 2009     4
4 2009-Apr 2009-04-01 2009     4
5 2009-Apr 2009-04-01 2009     4
6 2009-Apr 2009-04-01 2009     4 
```

这是我尝试过的：

```
library(ggplot2)
library(scales)
dates$converted <- as.Date(dates$Date, format="%Y-%m-%d")

ggplot(dates, aes(x=converted)) + geom_histogram()
+      opts(axis.text.x = theme_text(angle=90)) 
```

这产生[了这张图](https://i.imgur.com/rks0y.png)。不过，我想要`%Y-%b`格式化，所以我四处寻找并尝试了以下内容，基于[这个 SO](https://stackoverflow.com/questions/10576095/formatting-dates-with-scale-x-date-in-ggplot2)：

```
ggplot(dates, aes(x=converted)) + geom_histogram()
+    scale_x_date(labels=date_format("%Y-%b"),
+    breaks = "1 month")
+    opts(axis.text.x = theme_text(angle=90))

stat_bin: binwidth defaulted to range/30\. Use 'binwidth = x' to adjust this. 
```

这给了我[这张图](https://i.stack.imgur.com/HaGsV.png)

*   正确的 x 轴标签格式
*   频率分布已改变形状（binwidth 问题？）
*   刻度线未在条形下方居中显示
*   xlims 也发生了变化

我在该部分的[ggplot2 文档](http://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf)中完成了示例，当我将它与相同的 x 轴数据一起使用时，它似乎正确地中断、标记和居中刻度。我不明白为什么直方图不同。`scale_x_date``geom_line()`

* * *

## 根据 edgester 和 gauden 的回答进行更新

我最初认为gauden的回答帮助我解决了我的问题，但现在仔细观察后感到困惑。请注意代码后两个答案的结果图之间的差异。

假设两者：

```
library(ggplot2)
library(scales)
dates <- read.csv("http://pastebin.com/raw.php?i=sDzXKFxJ", sep=",", header=T) 
```

根据@edgester 下面的回答，我能够做到以下几点：

```
freqs <- aggregate(dates$Date, by=list(dates$Date), FUN=length)
freqs$names <- as.Date(freqs$Group.1, format="%Y-%m-%d")

ggplot(freqs, aes(x=names, y=x)) + geom_bar(stat="identity") +
       scale_x_date(breaks="1 month", labels=date_format("%Y-%b"),
                    limits=c(as.Date("2008-04-30"),as.Date("2012-04-01"))) +
       ylab("Frequency") + xlab("Year and Month") +
       theme_bw() + opts(axis.text.x = theme_text(angle=90)) 
```

这是我根据高登回答的尝试：

```
dates$Date <- as.Date(dates$Date)
ggplot(dates, aes(x=Date)) + geom_histogram(binwidth=30, colour="white") +
       scale_x_date(labels = date_format("%Y-%b"),
                    breaks = seq(min(dates$Date)-5, max(dates$Date)+5, 30),
                    limits = c(as.Date("2008-05-01"), as.Date("2012-04-01"))) +
       ylab("Frequency") + xlab("Year and Month") +
       theme_bw() + opts(axis.text.x = theme_text(angle=90)) 
```

基于 edgester 方法的绘图：

![边缘图](../Images/971d8acb7e156c8e4c602480099a5106.png)

基于高登方法的绘图：

![高登图](../Images/37e0bfc53ed3612da04914df01030a7f.png)

请注意以下事项：

*   2009 年 12 月和 2010 年 3 月 gauden 图中的差距；显示数据`table(dates$Date)`中有 19 个实例`2009-12-01`和 26 个实例`2010-03-01`
*   edgester 的情节从 2008 年 4 月开始，到 2012 年 5 月结束。根据 2008 年 4 月 1 日数据中的最小值和 2012 年 5 月 1 日的最大值，这是正确的。由于某种原因，高登的情节从 2008 年 3 月开始，但不知何故仍设法在 2012 年 5 月结束。在计算垃圾箱并阅读月份标签之后，对于我的生活，我无法弄清楚哪个情节有额外的或缺少直方图的垃圾箱！

对这里的差异有什么想法吗？edgester 的创建单独计数的方法

* * *

## 相关参考

顺便说一句，这里还有其他位置，其中包含有关日期和 ggplot2 的信息，供路人寻求帮助：

*   从learnr.wordpress 开始，这是一个流行的 R 博客[。](http://learnr.wordpress.com/2010/02/25/ggplot2-plotting-dates-hours-and-minutes/)它说我需要将我的数据转换为 POSIXct 格式，我现在认为这是错误的并且浪费了我的时间。
*   [另一个学习者帖子](http://learnr.wordpress.com/2009/05/05/ggplot2-two-time-series-with-different-dates/)在 ggplot2 中重新创建了一个时间序列，但并不真正适用于我的情况。
*   [r-bloggers 对此有一个帖子](http://www.r-bloggers.com/plotting-time-series-data-using-ggplot2/)，但它似乎已经过时了。简单的`format=`选项对我不起作用。
*   [这个 SO 问题](https://stackoverflow.com/questions/6638696/breaks-for-scale-x-date-in-ggplot2-and-r)正在使用中断和标签。我尝试将我的`Date`向量视为连续的，但认为它效果不佳。看起来它一遍又一遍地覆盖相同的标签文本，所以这些字母看起来有点奇怪。分布是正确的，但有一些奇怪的休息。我基于接受的答案的尝试是这样的（[结果here](https://i.stack.imgur.com/ntDPD.png)）。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-27T20:18:50.937

**更新**

# 版本 2：使用 Date 类

我更新了示例以演示对齐标签并在图上设置限制。我还证明了`as.Date`在一致使用时确实有效（实际上它可能比我之前的示例更适合您的数据）。

## 目标情节 v2

![基于日期的直方图](../Images/15c0af094500e7045aa54fa533649a1b.png)

## 守则 v2

这是（有点过分）注释代码：

```
library("ggplot2")
library("scales")

dates <- read.csv("http://pastebin.com/raw.php?i=sDzXKFxJ", sep=",", header=T)
dates$Date <- as.Date(dates$Date)

# convert the Date to its numeric equivalent
# Note that Dates are stored as number of days internally,
# hence it is easy to convert back and forth mentally
dates$num <- as.numeric(dates$Date)

bin <- 60 # used for aggregating the data and aligning the labels

p <- ggplot(dates, aes(num, ..count..))
p <- p + geom_histogram(binwidth = bin, colour="white")

# The numeric data is treated as a date,
# breaks are set to an interval equal to the binwidth,
# and a set of labels is generated and adjusted in order to align with bars
p <- p + scale_x_date(breaks = seq(min(dates$num)-20, # change -20 term to taste
                                   max(dates$num), 
                                   bin),
                      labels = date_format("%Y-%b"),
                      limits = c(as.Date("2009-01-01"), 
                                 as.Date("2011-12-01")))

# from here, format at ease
p <- p + theme_bw() + xlab(NULL) + opts(axis.text.x  = theme_text(angle=45,
                                                                  hjust = 1,
                                                                  vjust = 1))
p 
```

# 版本 1：使用 POSIXct

我尝试了一个解决方案，它可以在`ggplot2`2009 年初和 2011 年底之间完成所有操作，绘制而不进行聚合，并在 x 轴上设置限制。

## 目标情节 v1

![在 ggplot2 中设置限制的绘图](../Images/8cac2dac7cbdd9568b5febd92c54da2e.png)

## 代码 v1

```
library("ggplot2")
library("scales")

dates <- read.csv("http://pastebin.com/raw.php?i=sDzXKFxJ", sep=",", header=T)
dates$Date <- as.POSIXct(dates$Date)

p <- ggplot(dates, aes(Date, ..count..)) + 
    geom_histogram() +
    theme_bw() + xlab(NULL) +
    scale_x_datetime(breaks = date_breaks("3 months"),
                     labels = date_format("%Y-%b"),
                     limits = c(as.POSIXct("2009-01-01"), 
                                as.POSIXct("2011-12-01")) )

p 
```

当然，它可以通过使用轴上的标签选项来完成，但这是为了在绘图包中使用一个干净的简短例程来完成绘图。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2021-03-11T13:00:52.073

`breaks=`我知道这是一个老问题，但对于任何在 2021 年（或以后）提出这个问题的人来说，使用参数 for`geom_histogram()`并创建一个小快捷函数来制作所需的序列，这可以更容易地完成。

```
dates <- read.csv("http://pastebin.com/raw.php?i=sDzXKFxJ", sep=",", header=T)

dates$Date <- lubridate::ymd(dates$Date)

by_month <- function(x,n=1){
  seq(min(x,na.rm=T),max(x,na.rm=T),by=paste0(n," months"))
}

ggplot(dates,aes(Date)) +
  geom_histogram(breaks = by_month(dates$Date)) +
  scale_x_date(labels = scales::date_format("%Y-%b"),
               breaks = by_month(dates$Date,2)) + 
  theme(axis.text.x = element_text(angle=90)) 
```

[![直方图](../Images/c4acef3c0ca08a235bb691cba7591123.png)](https://i.stack.imgur.com/uWCVC.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-27T15:57:14.270

我认为关键是您需要在 ggplot 之外进行频率计算。将 aggregate() 与 geom_bar(stat="identity") 一起使用以获得没有重新排序因子的直方图。这是一些示例代码：

```
require(ggplot2)

# scales goes with ggplot and adds the needed scale* functions
require(scales)

# need the month() function for the extra plot
require(lubridate)

# original data
#df<-read.csv("http://pastebin.com/download.php?i=sDzXKFxJ", header=TRUE)

# simulated data
years=sample(seq(2008,2012),681,replace=TRUE,prob=c(0.0176211453744493,0.302496328928047,0.323054331864905,0.237885462555066,0.118942731277533))
months=sample(seq(1,12),681,replace=TRUE)
my.dates=as.Date(paste(years,months,01,sep="-"))
df=data.frame(YM=strftime(my.dates, format="%Y-%b"),Date=my.dates,Year=years,Month=months)
# end simulated data creation

# sort the list just to make it pretty. It makes no difference in the final results
df=df[do.call(order, df[c("Date")]), ]

# add a dummy column for clarity in processing
df$Count=1

# compute the frequencies ourselves
freqs=aggregate(Count ~ Year + Month, data=df, FUN=length)

# rebuild the Date column so that ggplot works
freqs$Date=as.Date(paste(freqs$Year,freqs$Month,"01",sep="-"))

# I set the breaks for 2 months to reduce clutter
g<-ggplot(data=freqs,aes(x=Date,y=Count))+ geom_bar(stat="identity") + scale_x_date(labels=date_format("%Y-%b"),breaks="2 months") + theme_bw() + opts(axis.text.x = theme_text(angle=90))
print(g)

# don't overwrite the previous graph
dev.new()

# just for grins, here is a faceted view by year
# Add the Month.name factor to have things work. month() keeps the factor levels in order
freqs$Month.name=month(freqs$Date,label=TRUE, abbr=TRUE)
g2<-ggplot(data=freqs,aes(x=Month.name,y=Count))+ geom_bar(stat="identity") + facet_grid(Year~.) + theme_bw()
print(g2) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-18T22:38:17.277

标题“基于 Gauden 方法的绘图”下的错误图是由于 binwidth 参数： ... + Geom_histogram (binwidth = 30, color = "white") + ... 如果我们将 30 的值更改为值小于 20，例如 10，您将获得所有频率。

在统计数据中，数值比显示更重要，平淡的图形对非常漂亮的图片但有错误。

# python - 选择所有的 dd 标签，直到一个带有 Xpath 的新 dl 标签

> ID：10770699
> 
> 赞同：1
> 
> 时间：2012-05-27T00:09:01.717
> 
> 标签：python, xpath, scrapy

我是一个 Scrapy & Xpath 初学者，我正在寻找一个具有以下结构的网站

```
<dl class="ismSummary ismHomeSummary">
        <dt>cat1</dt>
            <dd>value1</dd>
            <dd>value2</dd>
        <dt>cat2</dt>
            <dd>value1</dd>
            <dd>value2</dd>
</dl> 
```

使用 Xpath 我只想获取`dd`cat1 的 value1 和 value2 （的）

这就是我现在所拥有的

```
//dt[text()="cat1"]/following-sibling::dd 
```

问题是它不会停止在 cat2 并继续从 cat2 中选择 value1 和 value2。:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T01:26:27.893

**使用**：

```
//dt[. = 'cat1']
     /following-sibling::dd
       [count(.| //dt[. = 'cat2']/preceding-sibling::dd)
       =
        count(//dt[. = 'cat2']/preceding-sibling::dd)
       ] 
```

**如果每个都选择一个元素，上面的表达式就会准确地选择想要的两个`//dt[. = 'cat1']`元素。`//dt[. = 'cat2']``dd`**

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:copy-of select=
  "//dt[. = 'cat1']
     /following-sibling::dd
       [count(.| //dt[. = 'cat2']/preceding-sibling::dd)
       =
        count(//dt[. = 'cat2']/preceding-sibling::dd)
       ]

  "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档**时（修改了最后两个`dd`s 的值，因此我们确定选择了所需的元素）：

```
<dl class="ismSummary ismHomeSummary">
    <dt>cat1</dt>
    <dd>value1</dd>
    <dd>value2</dd>
    <dt>cat2</dt>
    <dd>value3</dd>
    <dd>value4</dd>
</dl> 
```

**计算 XPath 表达式并将其选择的节点复制到输出：**

```
<dd>value1</dd>
<dd>value2</dd> 
```

**说明**：

在这里，我们在 XPath 1.0中使用*Kayessian 方法进行节点集交集：*

**两个节点集的交集：`$ns1`和`$ns2`是**：

```
$ns1[count(.|$ns2) = count($ns2)] 
```

**在我们的例子中，我们替换`$ns1`为**：

```
//dt[. = 'cat1']/following-sibling::dd 
```

**我们`$ns2`用**：

```
//dt[. = 'cat2']/preceding-sibling::dd 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T01:12:50.993

这里的所有节点都是 的子节点`dl`，所以自然都是 first 的兄弟节点`dt`，所以当你使用时，`following-sibling`你会得到它们。

Xpath 是在考虑 xml 的情况下制作的，在 xml 中，您可能会将`dd`元素作为 的子级`dt`，但不幸的是，这里并非如此。

woule 最简单的方法是只包括`dt`（不仅仅是`dd`s）的所有兄弟姐妹，并遍历结果集直到出现 a `dt`。使用 Xpath 函数做同样的事情是可能的，但肯定更复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-06T09:29:34.717

尝试：

```
dt[text()="cat1"]/following-sibling::dd[preceding-sibling::dt[1]/text()='cat1'] 
```

# window - PyQt4窗口没有正确关闭信号和插槽，只有“x”按钮

> ID：10770703
> 
> 赞同：0
> 
> 时间：2012-05-27T00:09:59.987
> 
> 标签：window, pyqt, pyqt4

正如标题所暗示的，当我创建一个按钮或一个用于结束程序的菜单选项时，窗口不会关闭。

所以我试图找出结束程序并同时关闭窗口。我一直在使用教程：

[http://zetcode.com/tutorials/pyqt4/](http://zetcode.com/tutorials/pyqt4/)

否则很好。那么如何将按钮与结束和关闭小部件连接起来？

这是我一直在使用的一些示例代码（从教程中复制）。我似乎无法准确复制结局，但我认为这不是问题所在：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

"""
ZetCode PyQt4 tutorial 

This program creates a quit
button. When we press the button,
the application terminates. 

author: Jan Bodnar
website: zetcode.com 
last edited: October 2011
"""

import sys
from PyQt4 import QtGui, QtCore

class Example(QtGui.QWidget):

    def __init__(self):
        super(Example, self).__init__()

        self.initUI()

    def initUI(self):               

        qbtn = QtGui.QPushButton('Quit', self)
        qbtn.clicked.connect(QtCore.QCoreApplication.instance().quit)
        qbtn.resize(qbtn.sizeHint())
        qbtn.move(50, 50)       

        self.setGeometry(300, 300, 250, 150)
        self.setWindowTitle('Quit button')    
        self.show()

def main():

    app = QtGui.QApplication(sys.argv)
    ex = Example()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T21:41:31.417

该代码有效。我有同样的问题，但是在 IDLE 之外运行它可以工作。无需更改代码即可调用 QtGui 模块上的退出方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:42:58.373

您的应用程序是 QtGui.QApplication，那么为什么要使用 QtCore.QCoreApplication 连接到退出信号？将其更改为`QtGui.QApplication.instance().quit`有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-14T09:15:50.023

用 qbtn.clicked.connect(self.close)替换**qbtn.clicked.connect(QtCore.QCoreApplication.instance().quit)****我** 也遇到了同样的问题（试图从相同的 zetcode 教程中学习 Qt4）并来这里看看寻求解决方案

# c++ - Opengl屏幕到地图坐标转换

> ID：10770706
> 
> 赞同：0
> 
> 时间：2012-05-27T00:10:53.483
> 
> 标签：c++, opengl

我有一个高度图，`glVertex3f`并且需要一种可以使用鼠标动态更改某些点的高度的方法，这与像 Simcity 这样的游戏在创建像[这个 youtube 剪辑这样](http://www.youtube.com/watch?v=wQMCze2GOfw)的地形时所做的非常相似。

这是我创建地形的高度图循环

```
for(float x = 0.0; x < MAP_WIDTH; x += d)
{
    for(float z = 0.0; z < MAP_HEIGHT; z += d)
    {
        glColor3f(1.0f,1.0f,1.f);

        glBegin(GL_TRIANGLE_FAN);   

            Color(HeightMap[(int)x][(int)z]);
            glVertex3f( x, HeightMap[(int)x][(int)z], -z);

            Color(HeightMap[(int)x+d][(int)z]);
            glVertex3f( x+d, HeightMap[(int)x+d][(int)z], -z);

            Color(HeightMap[(int)x+d][(int)z+d]);
            glVertex3f( x+d, HeightMap[(int)x+d][(int)z+d], -z+-d);

            Color(HeightMap[(int)x][(int)z+d]);
            glVertex3f( x, HeightMap[(int)x][(int)z+d], -z+-d);
        glEnd();
    }
} 
```

如您所见，高度图从二维数组中获取其“高度”数据。因此，当用鼠标单击地图时，需要更改二维数组中的正确元素。

如果这有什么不同，我`gluLookAt`会在我的相机课程中使用。

*   解决此问题的最佳方法是什么？
*   如何将屏幕坐标转换为地图坐标？

旁注：我听说它`glBegin / glEnd`已被弃用，我会用什么来代替，或者我根本不需要它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T01:02:13.303

您将不得不查看顶点数组对象 (VAO) 来替换 glBegin/glEnd。

尽管如此，我认为您仍然可以先使用现有的东西，然后再担心使用最有效的 API 使用。

您需要的是[gluUnproject](http://www.opengl.org/sdk/docs/man/xhtml/gluUnProject.xml)，它获取鼠标的屏幕坐标、地形的模型、视图和投影矩阵，并在对象空间中返回鼠标光标。
然后，您可以在地形上执行射线投射并提升射线相交的顶点。

# symfony - 如何将 css 类添加到特定的 symfony2 表单选项？

> ID：10770707
> 
> 赞同：9
> 
> 时间：2012-05-27T00:11:00.747
> 
> 标签：symfony, symfony-forms

我可以使用 Javascript 来做到这一点，但我想知道是否可以将 css 类添加到特定的 symfony2 表单选择（不是选择字段本身，而是个人选择）。

例如，我想将不同的 CSS 样式应用于“选择”内的单个“选项”标签。我只能找到一种将类添加到标签的方法。

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-27T10:05:28.540

我认为你可以简单地做：

```
{{  form_widget(form.name, { 'attr' : { 'class' : 'myClass' } })  }} 
```

... 如此[处](http://symfony.com/doc/current/reference/forms/twig_reference.html)所述，无需创建自己的表单样式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-27T08:01:39.850

您可以覆盖表单中特定小部件的布局，这意味着您可以覆盖选择呈现的方式并放入自定义代码以检查选项的值是什么并在那里输出您的自定义类。

您需要将自定义布局应用于表单，如下所示

```
{% form_theme form 'form_theme.html.twig' %} 
```

然后在布局文件中，您需要覆盖该特定表单的特定字段（当然，除非您想直接编辑choice_widget，在这种情况下，所有使用choice 的字段都将具有该功能）。

为此，您必须复制小部件，因此选择小部件，然后将其命名 `[_formName_fieldName_widget]`

因此，如果您的表单名称是 events 而您的字段名称是 requireTickets，那就是`_events_requireTickets_widget`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-06T01:23:24.037

已经提供的答案非常好，我认为@CriticalImpact 是最灵活的。但我只想提一下，如果您使用的是表单类，您还可以通过表单构建器定义本身向字段添加额外的属性：

```
class SomeType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('someField', "text", array("attr" => array("class" => "someCssClass")))
            ->add("save", "submit");
    }
} 
```

我发现这对基本表单很有帮助，因为它仍然允许您`{{ form(someForm) }}`在 Twig 文件中进行简单的调用。

[（请注意，这个解决方案仍然有上面](https://stackoverflow.com/questions/10770707/how-can-i-add-css-classes-to-specific-symfony2-form-choices/19204443#comment14009978_10773131)提到的@CriticalImpact 的缺点）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-12-16T16:30:32.000

现在可以使用[choice_attr](http://symfony.com/app.php/doc/current/reference/forms/types/choice.html#choice-attr)为个人选择添加CSS 样式等属性，例如：

```
use Symfony\Component\Form\Extension\Core\Type\ChoiceType;
// ...

$builder->add('attending', ChoiceType::class, array(
    'choices' => array(
        'Yes' => true,
        'No' => false,
        'Maybe' => null,
    ),
    'choice_attr' => function($val, $key, $index) {
        // adds a class like attending_yes, attending_no, etc
        return ['class' => 'attending_'.strtolower($key)];
    },
)); 
```

# ocr - 训练 tesseract 和多页 tiff

> ID：10770710
> 
> 赞同：1
> 
> 时间：2012-05-27T00:11:17.343
> 
> 标签：ocr, tesseract

我在 Windows 7 64 位上使用 tesseract 3.0.1。

培训文档说：

> 每种字体都应放在一个多页 tiff 中（**仅当您使用 libtiff 时！**）

我不熟悉libtiff。我使用 ImageMagick 创建多页 tiff。到目前为止，这运作良好，或者至少看起来如此。我以后会遇到一些障碍吗？如果是这样，如何处理 libtiff - 运行它的设置是否足够或者我需要配置一些东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T07:54:10.153

Tesseract 并不关心您如何生成多页 tiff，只要它可以使用 leptonica 读取它（内部依赖于 libtiff）。如果 tesseract 现在可以处理您的 tiff，那么它可以在其余的训练过程中执行相同的操作以及运行 OCR，所以您可以开始了。我已经用 .Net 标准库制作了我的多页 tiff，而 tesseract 没有问题。

# twitter-bootstrap - Bootstrap 崩溃显然不起作用

> ID：10770715
> 
> 赞同：2
> 
> 时间：2012-05-27T00:12:51.707
> 
> 标签：twitter-bootstrap, collapse

我花了很长时间试图弄清楚为什么我的 twitter bootsrap 崩溃不起作用。我知道我需要 jquery 用于动画方面，除了路径不正确之外，任何人都可以想到我缺少的东西吗？

打开和关闭甚至没有被呈现为链接。

的HTML：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">      
    <title>Intermediate-jQuery</title>
</head>
<body>
    <a data-target="#foo" data-toggle="collapse">open</a>
    <div id="foo" class="collapse in">
        opened
    </div>
    <a data-target="#bar" data-toggle="collapse">close</a>
    <div id="bar" class="collapse">
       closed
    </div>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
    <script src="/Users/tony/Desktop/collapsefinal/collapsefinal.js"></script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T23:47:36.393

愚蠢的问题——但是你是否也包括了 Bootstrap 的 CSS？JQuery 插件通过操纵带有 Bootstrap 样式的类来工作，当我第一次尝试使用它时，这对我来说并不是很明显。

# ocr - 训练 tesseract 时的正确间距

> ID：10770719
> 
> 赞同：3
> 
> 时间：2012-05-27T00:13:55.247
> 
> 标签：ocr, tesseract

我在 Windows 7 64 位上使用 tesseract 3.0.1。我用一种新语言训练图书馆。

我的样本数据间隔很好。当我为每个角色的框定义坐标时，框紧贴角色有多重要？我使用其中一个插件，在每个包含一些（或很多）空白的字符上定义粗粒度框要快得多。当然，盒子永远不会与其他角色重叠。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-17T13:36:49.807

实际上，建议您放置与真实案例（测试）中相似的空间。然后通过使用[tesseract-box-editor](http://code.google.com/p/tesseract-box-editor/)或[jTessBoxEditor](http://vietocr.sourceforge.net/training.html)您将能够更正字母框的边界。

# android - Android：如何在 webview 中通过 JSON 或 JSONP 加载外部 JSON 数据

> ID：10770722
> 
> 赞同：0
> 
> 时间：2012-05-27T00:15:55.827
> 
> 标签：android, android-webview, android-scripting

我有一个带有 WebView 的应用程序

我尝试通过 Ajax (Get) 加载外部数据，但它失败且没有错误，尝试 JSONP 并且失败也没有错误。

现在这里有更多信息：

当我的外部源是基于 IP 的**http://192.168.0** ......../path/data JSON 和 JSONP 都可以正常工作

但是当外部源是域 **http://subdomain.mydomain.com** 事情不起作用（它永远不会完成加载）

我什至尝试将 JSONP 源指定为

```
<script src="http://subdomain.mydomain.com/path/?callback=callbackFunc"></script> 
```

但是这个脚本仍然没有完成加载

请注意，外部 URL 在 Web 浏览器甚至我的 PC 上都能正常工作（使用 JSONP 方法）。

我相信这是我不知道如何解决的跨域策略问题。

或 DNS 问题（我也不知道如何解决）。

或者可能有更好的方法在android的WebView中加载外部数据

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T01:07:18.670

好的，我找到了问题的答案，

我的 Android 的 UserAgent 在我的服务器上被阻止指定路径，

我使用的 IP 是网络 IP，而域是另一台服务器。.

现在它已修复..

# c++ - 为什么我不能访问我的成员变量？

> ID：10770723
> 
> 赞同：0
> 
> 时间：2012-05-27T00:16:17.790
> 
> 标签：c++

我在头文件和源文件之间拆分了以下代码。在函数 insert 中，它声明 AllBridges 向量没有初始化（它甚至似乎都没有识别它？）并且 nextBridge 没有被赋值——除非我认为我在构造函数中做了？

```
#include <vector>

using namespace std;

class Bridge
{
    public:
        Bridge(int);
        void insert(Bridge);

    private:

        int nextBridge;
        vector<Bridge> AllBridges;
};

#include "StdAfx.h"
#include "Bridge.h"

using namespace std;        

    Bridge::Bridge(int size){
        AllBridges.reserve(size);
        nextBridge= 0;      
    }

    void insert(Bridge AddBridge){
        AllBridges[nextBridge] = AddBridge;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T00:17:53.470

应该

```
void Bridge::insert(Bridge AddBridge) 
```

代替

```
void insert(Bridge AddBridge) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T00:24:28.527

您正在尝试复制已经属于`vector`.

与其自己跟踪 nextBridge，不如让其`vector`完成它的工作，并跟踪`bridge`您插入了多少个 s。而不是`insert`在指定位置 ing，您只需要使用`push_back`添加到末尾`vector`，因此您的代码变为：

```
Bridge::Bridge(int size){
    AllBridges.reserve(size);
}

void Bridge::insert(Bridge AddBridge){
    AllBridges.push_back(AddBridge);
} 
```

...您可以简单地`nextBridge`从您的定义中`Bridge`完全删除。

顺便说一句，我认为您犯了一个根本性错误：您将单个桥的概念与所有桥的集合的概念混为一谈。这是一个常见的错误（有时肯定不是初学者会犯），但它几乎不可避免地会导致问题。举个例子，`Bridge`你插入的每`AllBridges`一个`AllBridges`都有自己的（可能是空的，但谁知道呢）。

你真的`Bridge`只想代表*一个*桥，然后（如果需要）有一个单独的类型来代表桥的集合——如果它真的添加了一些有用的东西`std::vector<Bridge>`。

编辑：我想我应该添加另一种可能性：也许您确实希望该`Bridge`类型跟踪所有实例化的自身实例。如果是这样，您希望成为`AllBridges`一个`static`成员，因此您为该类提供一个它的实例，而不是为该类的每个对象提供一个单独的实例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-27T00:18:21.820

调用`reserve`a`std::vector`可确保它有足够的容量来容纳如此多的元素（如果添加了这些元素）。它不会调整向量的大小，只会改变它的容量。您正在寻找的是`resize`.

您的成员函数定义中也缺少`Bridge::`您。`insert`

# javascript - 使用 javascript 在图像上标记区域

> ID：10770726
> 
> 赞同：6
> 
> 时间：2012-05-27T00:16:48.747
> 
> 标签：javascript, jquery, html

我的问题是：我有一张图片，想在上面标记一些区域并存储坐标。比如在 Facebook 上的照片中标记某人。用户应该能够标记正方形和多边形。

有人知道任何可以帮助我做到这一点的图书馆吗？可能是jquery中的东西。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T03:44:06.220

我最近发现了这个： http: [//www.maschek.hu/imagemap/imgmap](http://www.maschek.hu/imagemap/imgmap)

好像很有用！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T02:30:19.423

你可以使用 Jquery 和 HTML5 [Jcrop](http://deepliquid.com/content/Jcrop.html)是一个很棒的插件

# c# - 根据另一个列表对列表进行排序，然后使用 LINQ 对列表进行排序

> ID：10770727
> 
> 赞同：3
> 
> 时间：2012-05-27T00:17:01.020
> 
> 标签：c#, linq, list, sorting, dictionary

以下字典表示目标城市 ID 的键/值对以及与该城市关联的过滤器数量：

```
Dictionary<int, int> totalCityFilters 
```

这本字典按过滤器数量的降序排序，这是我需要的方式。然后我有一个未排序的航班列表：

```
List<Flight> unsortedFlights 
```

每个`Flight`对象都有一堆属性，其中与我的问题最相关的是`DestinationID`和`FinalPrice`。我需要创建一个新的航班列表，根据以下两个前提对其进行排序：

1.  该列表应首先根据 的顺序进行排序`totalCityFilters`，该字典上的键与属性匹配`DestinationID`。航班列表可能有多个相同的航班`DestinationID`（这不是主键）。
2.  然后应按`FinalPrice`属性对列表进行排序（升序）。

**但是，第二种不能破坏第一种。**我的意思是，如果比on`B.DestinationID`最先出现，更便宜的航班 (A) 一定不能在更昂贵的航班 (B)之上。`A.DestinationID``totalCityFilters`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-27T00:26:25.193

如果我对您的理解正确：

```
var result = unsortedFlights
             .OrderByDescending(f => totalCityFilters[f.DestinationID])
             .ThenBy( f => f.FinalPrice)
             .ToList(); 
```

如果 的值`totalCityFilters`是您首先要订购的数字。

# jquery - 将边框图像与背景图像对齐；

> ID：10770728
> 
> 赞同：1
> 
> 时间：2012-05-27T00:17:07.950
> 
> 标签：jquery, css

我有一个用 CSS :before 和 :after 伪元素制作的六边形。我试图在这个网站上重现效果：[http](http://www.upperfirst.com) ://www.upperfirst.com （我知道他们使用画布）

问题是，如果我使用多个元素，悬停时的尺寸增加不会正确设置动画。我通过使用带有边框的 :before 和 :after 来修复动画。现在我想让图像工作，但我似乎无法弄清楚如何排列边框图像和中间部分的图像，使其看起来无缝。

这是我到目前为止所拥有的小提琴：http: [//jsfiddle.net/uwZ8w/](http://jsfiddle.net/uwZ8w/)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:22:28.810

这个答案基于您修改后的代码，该代码有点使用[我的六边形技术](https://stackoverflow.com/questions/10062887/generate-repeating-hexagonal-pattern-with-css3/10068351#10068351)。关于避免您提到[的图形对齐问题](http://cl.ly/GwVj)，我有两个建议。

1.  将您的图像缩放到您想要的大小，这样您就可以避免`background-size`像当前所做的任何缩放。
2.  同样，避免在宽度和高度上缩放`.inner`div `200%`（您不必这样做，它们应该与`.hexagon`div 和您归类为`.before`and的直接子级的大小相同`.after`）。然而，关于那...

...我很好奇你为什么使用`.inner`div 而不是`:before`伪元素（以避免混乱你的代码）。在我看来，您可能不了解伪元素是什么（因为您`content: '';`的`.inner`css 中有 a，如果它不是伪元素而是真实元素，则无关紧要）。要么，要么当您从伪元素切换到真实元素时`div`（无论出于何种原因进行了切换），您不小心将代码留在了那里。

# php - 高半字节和低半字节它们是什么？

> ID：10770735
> 
> 赞同：14
> 
> 时间：2012-05-27T00:18:02.970
> 
> 标签：php

php 中的函数 pack() 是什么？

我可以打包一个带有高半字节和低半字节的十六进制字符串有什么区别？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-27T00:20:56.203

半字节是半个字节（0-15，或一个十六进制数字）。低半字节是 0-3 位；高半字节是 4-7 位。

# database - 为什么自动增量 id 用作 DATA 字典中的主键，即使主键在 ER 图中已经可用？

> ID：10770741
> 
> 赞同：0
> 
> 时间：2012-05-27T00:19:34.423
> 
> 标签：database, database-design

在这里，我看到 ER 图中没有可用的自动递增 id 键，但在数据字典中我看到了 id。在 er 图中，哪个属性用作主键用作数据字典中的唯一键，而自动递增 id 用作主键哪个不在 ER 图中。为什么会发生这种情况？

```
field    KEY              other                     NULL?

id      Primary key      auto increment             Not null

Name    Unique key                                  Not Null
....     ...........                                 ........... 
```

谁能说出为什么使用主键 id 而不在 ER 图中显示它？为什么 ER 图的主键用作数据字典中的唯一键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T09:38:27.743

主键和任何其他键在原则上没有区别。无论您是否选择将它们指定为“主要”密钥，所有密钥都应该是不可约唯一且不可为空的。因此，当您有多个可能的候选键时指定任何一个主键是一个有点灵活、非正式的概念，它仅与设计者希望的一样重要。也许您看到的差异只是反映了不同的观点或预期用途。当然，另一种可能是有人犯了一个简单的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T00:28:54.640

使用 Id 可能是为了保持一致性；一些框架假设每个表都有 id 作为主键，这标准化/简化了表的工作。但是 ER 图中的“真实”主键将是一个有效键，那么为什么不通过将其标记为 UNIQUE 来通知数据库呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T01:08:18.683

一种可能的 ID 是代理键，NAME 是自然的，使用代理键的设计有许多优点。例如，它们（应该是）不可变的。

如果有另一个通过 ID 链接的表，您可以更改名称（例如修复溢出的 mestike）而不破坏参照完整性，或者重新设置相关表的密钥。

另一个可能是您不希望 Name 不再是唯一的，也许为上下文添加另一列，并使 Name 和 Context 成为复合唯一键，想象一下重新处理所有相关表将是多么痛苦。

但是，代理人的规则 1，不要暴露他们。

# objective-c - 使用 NSOperationQueues 的核心数据和并发

> ID：10770742
> 
> 赞同：3
> 
> 时间：2012-05-27T00:19:59.567
> 
> 标签：objective-c, ios5, core-data, concurrency

在使用 Instruments 之后，我发现我的代码中有一个地方运行时间很长并且阻塞了我的 UI：大量核心数据获取（这是摄取大型 JSON 数据包和构建托管对象同时确保对象的过程的一部分）没有重复）。

虽然我的意图是将这个请求分解成更小的部分并连续处理它们，但这仅意味着我将分散这些提取 - 我预计效果将是应用程序中的小突发而不是长时间的打嗝。

我在 Apple 的文档和在线的各种博客文章中读到的所有内容都表明，Core Data 和并发类似于戳蜂箱。所以，我胆怯地坐下来试一试。以下是我想出的，如果有人更聪明地指出我确定我写过的任何错误，我将不胜感激。

下面发布的代码有效。我读到的东西让我害怕我肯定做错了什么。我觉得如果把别针从手榴弹中拔出来，我就在等它意外爆炸！

```
NSBlockOperation *downloadAllObjectContainers = [NSBlockOperation blockOperationWithBlock:^{
    NSArray *containers = [webServiceAPI findAllObjectContainers];
}];

[downloadAllObjectContainers setCompletionBlock:^{

    NSManagedObjectContext *backgroundContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
    [backgroundContext setPersistentStoreCoordinator:[_managedObjectContext persistentStoreCoordinator]];

    [[NSNotificationCenter defaultCenter] addObserverForName:NSManagedObjectContextDidSaveNotification
                                                      object:backgroundContext
                                                       queue:[NSOperationQueue mainQueue]
                                                  usingBlock:^(NSNotification *note) {
                                                      [_managedObjectContext mergeChangesFromContextDidSaveNotification:note];
                                                  }];

        Builder *builder = [[Builder alloc] init];
        [builder setManagedObjectContext:backgroundContext];

        for (ObjectContainer *objCont in containers) {  // This is the long running piece, it's roughly O(N^2) yuck!
            [builder buildCoreDataObjectsFromContainer:objCont];
        }

    NSError *backgroundContextSaveError = nil;
    if ([backgroundContext hasChanges]) {
        [backgroundContext save:&backgroundContextSaveError];
    }
}];

NSOperationQueue *background = [[NSOperationQueue alloc] init];
[background addOperation:downloadAllObjectContainers]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T15:02:29.367

由于您使用的是 NSPrivateQueueConcurrencyType，因此您必须为 iOS5 使用它，您不必费心在后台线程中创建上下文并将其合并到主线程中。

您只需要在主线程中创建一个并发类型为 NSPrivateQueueConcurrencyType 的托管对象上下文，并在传递给 managedObjectContext:performBlock 方法的块内对托管对象执行所有操作。

我建议你看看**WWDC2011 session 303 - What's New in Core Data on iOS**。另外，请查看[iOS5 的核心数据发行说明](http://developer.apple.com/library/ios/#releasenotes/DataManagement/RN-CoreData/_index.html)。

以下是发行说明中的​​引述：

> NSManagedObjectContext 现在为并发操作提供结构化支持。当您使用 initWithConcurrencyType: 创建托管对象上下文时，您有三个选项用于其线程（队列）关联
> 
> 限制（NSConfinementConcurrencyType）。
> 
> 这是默认设置。您保证上下文不会被除您创建它的线程之外的任何线程使用。（这与您在以前的版本中使用的线程要求完全相同。）
> 
> 专用队列 (NSPrivateQueueConcurrencyType)。
> 
> 上下文创建和管理私有队列。与您创建和管理与上下文相关联的线程或队列不同，这里上下文拥有队列并为您管理所有细节（前提是您使用如下所述的基于块的方法）。
> 
> 主队列（NSMainQueueConcurrencyType）。
> 
> 上下文与主队列相关联，因此与应用程序的事件循环相关联，但它在其他方面类似于私有的基于队列的上下文。您将此队列类型用于链接到控制器和 UI 对象的上下文，这些对象只需要在主线程上使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-15T12:12:00.303

**并发**

并发性是同时处理多个队列上的数据的能力。如果您选择使用 Core Data 的并发性，您还需要考虑应用程序环境。在大多数情况下，AppKit 和 UIKit 不是线程安全的。特别是在 OS X 中，Cocoa 绑定和控制器不是线程安全的[核心数据、多线程和主线程](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/CoreData/Concurrency.html#//apple_ref/doc/uid/TP40001075-CH24-SW1)

# html - src="some.js?var=val" 它实际上是什么意思？

> ID：10770743
> 
> 赞同：2
> 
> 时间：2012-05-27T00:20:07.797
> 
> 标签：html

在查看了一些 HTML 源之后，我发现了一些针对 css 和 js 的“毫无意义”的文件包含。

我称之为“毫无意义”，因为，

1.  `<script src="some_file.js?123"></script>`总是完全等于（大小以字节为单位）到
2.  `<link href="some.css?var=val" rel="stylesheet" type="text/css" />`=== 和前面提到的一样。
3.  正如我们所知，通常客户端技术无法解析来自 HTTP（意味着来自 POST 和 GET）的变量，这项工作适用于服务器端。

所以问题是，为什么人们使用这个？想/不使用这个？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T00:24:57.577

通常这样做是为了防止浏览器缓存静态文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T05:05:05.597

正如 WojtekT 所建议的那样，查询部分可用于防止缓存（是否成功或有用是另一个问题），但它也可用于将数据传递给生成或提供资源的进程。例如，`some.css?var=rel`可能会导致生成的样式表版本不同，或样式表完全不同`some.css`。例如，该参数可以用于传递用户选项（可能比 cookie 或 HTML 存储更笨拙，但仍然可能）。

您的假设 3 在两个方面是错误的。首先，常见的客户端技术（client-side JavaScript）可以轻松处理 GET 变量。其次，这与客户端无关。浏览器处理该引用`some.css?var=val`以构造一个绝对 URL，保留查询部分，然后向服务器生成一个 GET 请求（传递查询部分），除非它发现资源在浏览器的缓存中。

# c - 寻找好的小型 DES 实现

> ID：10770745
> 
> 赞同：3
> 
> 时间：2012-05-27T00:20:55.830
> 
> 标签：c, cryptography, embedded, des

我正在寻找一个好的许可许可（BSD/MIT 或 PD）DES 实现在 C 中，最小的运行时内存使用（即最小的读写内存，最好也是小的代码/表大小）。速度不是问题；事实上，在某些方面，越慢越好，因为它为暴力登录尝试提供了一些自然防御。

我见过的所有传统实现都会对大表进行惰性/运行时初始化，这是我试图避免的。我很乐意`static const`在二进制文件中包含数据表，事实上，这就是我已经部分破解了我现在拥有的实现，但我想知道是否有任何现有的实现可以做更好地以牺牲性能为代价最小化表的大小，这样二进制文件就不会那么大（大约 50kb 的表）。

注意：是的，DES 很烂。预期的用例是用于实现`crypt`处理传统密码登录的功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T15:24:06.533

[具有MIT 许可证](https://github.com/keplerproject/md5/blob/master/src/des56.c)的示例和来自[libtomcrypt](https://github.com/libtom/libtomcrypt/blob/master/src/ciphers/des.c)的版本对于所有目的都是完全免费的。

第一个版本似乎也对表进行了惰性初始化，而它们是 libtomcrypt 中的静态常量。但是 libtomcrypt 似乎为您提供了速度与大小的编译标志，`#ifndef LTC_SMALL_CODE`较大的表前面有一个，也许可以解决您的问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T04:51:59.763

Applied Cryptography的[源代码部分](http://www.schneier.com/book-applied-source.html)包含大量 DES 实现的链接——我没有全部查看，但很有可能其中至少有一个满足您的需求。

# mysql - MySQL 正则表达式与日文假名

> ID：10770748
> 
> 赞同：1
> 
> 时间：2012-05-27T00:21:03.227
> 
> 标签：mysql, regex, cjk, ruby-characters

我有一个庞大的词汇数据库（约 2700 个条目）。每行包含一个英文单词、对应的日文单词以及与此问题无关的其他数据。我创建了一个工具来搜索并在表格中显示结果，但是我在使用*furigana*时遇到了一个小问题。

日语句子是由汉字（*汉字*）和拼音文字（*假名*）混合而成的。不是每个人都能读懂每一个*汉字*，有时同一个*汉字*有多种读法。在这些情况下，*假名*放在*汉字*上方- 这称为*假名*：

![在此处输入图像描述](../Images/4671a96341e953979b2bbf23fd24086a.png)

我使用 <ruby> 标记以下列格式将这些语音读数呈现给用户：

```
<ruby>
  <rb>勉強</rb>    <!-- the kanji -->
  <rp>（&lt;/rp>      <!-- define where the phonetic part starts in the string -->
    <rt>べんきょう&lt;/rt>   <!-- the phonetic kana itself -->
  <rp>）&lt;/rp>      <!-- define the end of the phonetic part -->
</ruby>する        <!-- the last part is already phonetic so needs no ruby --> 
```

字符串存储在我的数据库中，如下所示：

```
勉強（べんきょう）する 
```

括号之间的任何内容都是紧接在它前面的汉字的读数。以这种方式存储字符串允许不支持 ruby​​ 标签的浏览器（例如，令人惊讶的 Firefox）回退。

所有这些都很好，但是当用户搜索时问题就来了。如果他们搜索

```
勉強 
```

然后它就会出现。但如果他们试图寻找

```
勉強する 
```

它不会起作用，因为在数据库中有一个字符串定义了中间的语音发音。

上例中的全角括号仅用于表示该拼音文字。鉴于此，我正在寻找一种方法来基本上告诉 MySQL 搜索忽略它在圆括号之间找到的任何内容。我对如何在 MySQL 中进行最简单的查询有基本的了解，但我当然不是专家。我查看了文档，但是（至少对我而言）它们不是很友好。也许对初学者不太友好。我认为某种涉及正则表达式的构造可能是可能的，但我不知道如何。

有没有办法做我想做的事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T01:31:21.563

我建议不要使用 LIKE 查询，因为您必须在每个字符之间有一个 % （因为您不知道何时会出现假名）并且最终可能会产生误报（例如，如果有效字符出现在勉和强之间）。

正如@Jill-Jênn Vie 简要提到的那样，我建议添加一个新列来保存带有假名的文本。

我正在开发一个对韩文文本执行搜索的应用程序。问题是韩语变位改变了字符。例如：

```
하다 + 아요 = 해요 
```

“하다”是字典形式的动词“to do”，“아요”是标准的礼貌形式变位。想必你会说日语，所以你知道这种礼貌形式有多普遍！注意 하 如何变为 해。显然，如果用户尝试在字符串“해요”中搜索“하다”，他们将找不到。但是如果用户想在语料库中看到“하다”的所有实例，我们需要能够返回它。

我们的解决方案是两列：“form”（共轭形式）和“analytic_string”，将“해요”表示为“하다+아요”。您可以采用类似的方法并制作第二列，其中包含您的句子而没有假名。

这种方法的主要缺点是您实际上将数据库大小增加了一倍，并且在输入两列具有相同数据的数据时需要特别注意（我在我的数据库中发现了几行表格和分析字符串其中有不同的词）。优点是您可以轻松搜索数据，同时忽略假名。

这是您的标准“尺寸与性能”权衡。哪个更重要：数据库大小还是执行时间？我能想到的任何其他解决方案都涉及返回太多行，然后单独分析它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T01:11:12.830

如[如何在 MySQL 中进行正则表达式替换？](https://stackoverflow.com/questions/986826/how-to-do-a-regular-expression-replace-in-mysql)，似乎没有用户定义的函数是不可能的（只能替换显式序列）。

相当肮脏的解决方案：您可以容忍两个连续日文字符之间的任何内容，`LIKE '勉%強%す%る'`. 我从来没有建议过。

或者，您可以在表中保留一个可选字段，该字段可能包含带有*furigana*的版本。

# nhibernate - 如何映射队列的类型 与休眠

> ID：10770751
> 
> 赞同：0
> 
> 时间：2012-05-27T00:21:20.597
> 
> 标签：nhibernate, nhibernate-mapping

例如：

```
 public class Product
    {
        public Queue<string> strings{get;set;}
    } 
```

在 nhibernate 中，如何映射 Queue 的类型，帮帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:11:59.140

为什么不更新和存储 DTO 列表，它是字符串和添加到队列的索引/顺序的组合，并将其存储在数据库中。您的 Queue 属性从此列表中读取，然后建立队列，并且您设置的队列属性更新列表。

这对您来说是一种可能的解决方法吗？

# android - android mediaplayer 在 ICS 上永远循环

> ID：10770752
> 
> 赞同：7
> 
> 时间：2012-05-27T00:21:21.867
> 
> 标签：android, loops, notifications, media-player

我想播放通知声音，我的问题是声音永远循环播放，而它应该只响一次。

我尝试了两种方法：

```
notification.sound = Uri.parse("content://media/internal/audio/media/38"); 
```

和

```
mMediaPlayer = new MediaPlayer();
mMediaPlayer.setAudioStreamType(AudioManager.STREAM_NOTIFICATION);
mMediaPlayer.setDataSource(this, Uri.parse("content://media/internal/audio/media/38"));
mMediaPlayer.setLooping(false);
mMediaPlayer.prepare();
mMediaPlayer.setOnPreparedListener(new OnPreparedListener() {
    @Override
    public void onPrepared(MediaPlayer mp) {
        Log.v(Utils.TAG, "onprepared");
        mp.start();
    }
});

mMediaPlayer.setOnCompletionListener(new OnCompletionListener() {
    @Override
    public void onCompletion(MediaPlayer mp) {
        Log.v(Utils.TAG, "end, we should release");
        mp.stop();
        mp.release();
    }
}); 
```

在第二种情况下，我从来没有看到“结束，我们应该释放”的痕迹，音频一遍又一遍地播放。

任何想法？

非常感谢

**更新：**

我尝试了两种设备，并且：

*   它在带有 ICS 4.0.4 的 Galaxy Nexus 上永远循环
*   它在 HTC Hero 2.2.1 上运行良好

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T11:36:45.663

有些带有“内置”循环的声音会永远播放。这与将 MediaPlayer 设置为循环播放不同。如果您开始播放带有内置循环的声音，它将永远不会结束。这些主要是铃声（与警报音或通知音相反）。您可以将 RingtoneManager 设置为仅返回通知音或警报音，`myringtonemanager.setType(RingtoneManager.TYPE_ALARM|RingtoneManager.TYPE_NOTIFICATION)` 它们将排除大多数循环声音，但不幸的是，这不能保证在任何设备上都排除它们。**:-(**

因此，Tiago Almeida 的解决方案是一个很好的解决方法（我已经投了赞成票），尽管它也会截断所有只有几个（并且没有无限）循环的声音。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-01T08:48:16.817

尝试这个：

```
try {
    mp.setDataSource(uri.toString());
    mp.setAudioStreamType(AudioManager.STREAM_ALARM);
    mp.prepare();
    mp.start();
    mp.setOnSeekCompleteListener(new OnSeekCompleteListener() {
        public void onSeekComplete(MediaPlayer mp) {
            mp.stop();
            mp.release();
        }
    });
} catch (Exception e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-30T11:25:07.803

此问题的另一种解决方法

```
boolean soundPlayedOnce = true;

if(soundPlayedOnce){
   mp.start();
   soundPlayedOnce = false;
} 
```

在您想要播放声音之前将此布尔值设置为 true

# c++ - 在 C++ 中从向量中搜索和删除特定项

> ID：10770753
> 
> 赞同：-1
> 
> 时间：2012-05-27T00:21:32.397
> 
> 标签：c++, vector

我正在做一个具有以下属性的用户类的程序：

```
private:
    char* username;
    char* firstname;
    char* lastname;
    ... 
```

在 main.cpp 中，我有一个 User 类的向量：

```
#include <vector>
#include "User.h"

using std::vector;

void main (int argc, char* argv[])
{
    vector<User*> users;

    /*
        ... Some Code ...
    */
} 
```

我在这个`/* ... Some Code ... */`地方添加了一些用户。

但是现在我想从程序中做的事情：

*   添加用户
    *   搜索是否已添加用户（用户名 in `users[i]`= 新用户中的用户名）
        *   不添加
        *   `return false; // Confirm not added`
    *   别的
        *   添加用户
        *   `return true; // Confirm added`

另一方面，我想通过用户名搜索用户并将其从向量中删除：

*   删除用户
    *   搜索用户是否在列表中（用户名在`users[i]`=要删除的用户名）
        *   删除用户 i
        *   `return true; // confirm deleted`
    *   别的
        *   `return false; // confirm not deleted`

我希望你明白我的意思。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:32:02.860

使用 lambda

```
User newUser( name );
if ( std::find_if( user.begin(), users.end(), []( const User& u )->bool { strcmp( u.username, newUser.username ) == 0; } ) == users.end() )
{
    user.push_back( newUser );
} 
```

（那是我的头顶，所以我可能犯了一个错误......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T06:07:50.703

不要将指针用作 stl 容器的有效负载。这不是推荐的方式。而是使用可复制的类型。所以你会有这样的东西 - *vector<User> users;*

我认为你应该使用*列表*而不是*向量*，因为*向量*在从中间删除时效率不高，除非你启用了移动语义。

# android - 小部件更新滞后

> ID：10770755
> 
> 赞同：0
> 
> 时间：2012-05-27T00:21:53.270
> 
> 标签：android, widget

我在这里构建一个简单的时钟小部件很有趣。我想知道最好的做法是什么？大多数时候它工作正常，但有些人说我的时钟小部件落后了。实际时间是上午 10 点，然后我的小部件显示可能是上午 9 点 48 分

我的清单上有这个

> ```
>  <receiver
>         android:name="my.package.name.MyClock"
>         android:label="@string/widget_name">
> 
>         <intent-filter>
>             <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
>         </intent-filter>
> 
>         <meta-data
>             android:name="android.appwidget.provider"
>             android:resource="@xml/my_clock" />
>     </receiver>
> 
>     <service
>         android:name="MyClock$UpdateService"
>         android:label="UpdateService" >
>         <intent-filter>
>             <action android:name="my.package.name.UPDATE" />
>         </intent-filter>             
>     </service> 
> ```

这是我的主要java类

> 公共类 MyClock 扩展 AppWidgetProvider {
> 
> ```
> @Override
> public void onDisabled(Context context) {
>     super.onDisabled(context);
>     context.stopService(new Intent(context, UpdateService.class));
> }
> 
> @Override
> public void onEnabled(Context context) {
>     super.onEnabled(context);
>     context.startService(new Intent(UpdateService.ACTION_UPDATE));
> }    
> 
> @Override
> public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
>     super.onUpdate(context, appWidgetManager, appWidgetIds);
>     context.startService(new Intent(UpdateService.ACTION_UPDATE));
> } 
> 
> public static final class UpdateService extends Service {
>     static final String ACTION_UPDATE = "my.package.name.UPDATE";
> 
>     private final static IntentFilter sIntentFilter;
> 
>     private String mMinuteFormat;
>     private String mHourFormat;
> 
>     private Calendar mCalendar;
> 
>     static {
>         sIntentFilter = new IntentFilter();
>         sIntentFilter.addAction(Intent.ACTION_TIME_TICK);
>         sIntentFilter.addAction(Intent.ACTION_TIMEZONE_CHANGED);
>         sIntentFilter.addAction(Intent.ACTION_TIME_CHANGED);
>     }
> 
>     @Override
>     public void onCreate() {
>         super.onCreate();
>         reinit();
>         registerReceiver(mTimeChangedReceiver, sIntentFilter);
>     }
> 
>   @Override
>     public void onDestroy() {
>         super.onDestroy();
>         unregisterReceiver(mTimeChangedReceiver);
>     }
> 
>     @Override
>     public void onStart(Intent intent, int startId) {
>         super.onStart(intent, startId);
>         reinit();
>         update();
>     }
> 
>     @Override
>     public IBinder onBind(Intent intent) {
>         return null;
>     }
> 
>     private void update() {
>         mCalendar.setTimeInMillis(System.currentTimeMillis());
>         final CharSequence minute = DateFormat.format(mMinuteFormat, mCalendar);
>         final CharSequence hour = DateFormat.format(mHourFormat, mCalendar);
> 
>         RemoteViews views = null;             views = new RemoteViews(getPackageName(), R.layout.main);
>         views.setTextViewText(R.id.HOUR, hour);
>         views.setTextViewText(R.id.MINUTE, minute);                   
> 
>         //Refresh the widget
>         ComponentName widget = new ComponentName(this, MyClock.class);
>         AppWidgetManager manager = AppWidgetManager.getInstance(this);
>         manager.updateAppWidget(widget, views);          
>     }    
> 
>     private void reinit() {
>         mHourFormat = "hh";
>         mMinuteFormat = "mm";            
>     }
> 
>     private final BroadcastReceiver mTimeChangedReceiver = new BroadcastReceiver() {
>         @Override
>         public void onReceive(Context context, Intent intent) {
>             final String action = intent.getAction();
> 
>             if (action.equals(Intent.ACTION_TIME_CHANGED) ||
>                 action.equals(Intent.ACTION_TIMEZONE_CHANGED))
>             {
>                 reinit();
> 
>             }
> 
>             update();
> 
>         }
>     };
> 
> }     } 
> ```

我错过了什么？为什么小部件落后了？你能帮我发现这里的问题吗？我在做正确的方法吗？使用 Service 而不是 AlarmManager 每分钟更新时钟小部件？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T00:30:56.703

导致这个问题的原因有很多，但最有可能的是，服务被系统杀死了。没有办法防止后台服务被系统杀死，只有让前台服务在大多数情况下都是安全的，但是通知图标对用户来说很烦人。

我认为使用`AlarmManager`会是最好的，我最近也使用这种技术更新了我的时钟小部件。由于 AlarmManager 进行广播，即使您的应用程序被杀死，它也会在发送之前重新创建它。

# c++ - 整数类的 C++ 范围 - 选择的迭代器类型

> ID：10770758
> 
> 赞同：2
> 
> 时间：2012-05-27T00:22:30.643
> 
> 标签：c++, iterator, forward

这是 Range 类：

```
template <typename T>
class Range
{
public:
  class iterator;

  Range(T low, T high) : low_(low), high_(high)
  {
  }

  const iterator begin() const
  {
    return iterator(low_);
  }

  const iterator end() const
  {
    return iterator(high_);
  }

}; 
```

哪个迭代器之王（前向、随机、输入）是最好的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T02:14:00.890

您可以提供任何类型的迭代器，包括如果您希望使用随机迭代器，只要您不允许从`operator*`或修改迭代器状态`operator->`。也就是说，如果您将计数保留在迭代器中，`operator*`则应返回 a `T`(value) 和`operator->`a `T const *`，以便无法通过这些运算符修改迭代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T00:41:33.790

@K-ballo 是对的，随机是最好的方法，但取决于算法。请你也描述一下它们好吗？

# c# - 按钮不起作用

> ID：10770759
> 
> 赞同：0
> 
> 时间：2012-05-27T00:22:32.663
> 
> 标签：c#, arrays, user-interface, methods

嗨，我在这里遇到问题。因此，您可以看到，每当单击 txtBtn0 和 txtBtn1 时，它都会增加自己的数组，然后将其用于 squareChecked 字符串。但是我首先要做的是，如果 txtBtn0 和 txtBtn1 没有被点击，就会给出一个错误信息。但它不会弹出任何东西。

```
 public partial class MainForm : Form
{
    public int[] clickNumBoxArray = Enumerable.Repeat(1, 81).ToArray();

    public MainForm()
    {
        InitializeComponent();

     }  ... ... ...

        private void btn1_Click(object sender, EventArgs e) {
         UserSquare checkClickedBox = new UserSquare();

        string checkClickBox = checkClickedBox.squareChecked();
        if (checkClickedBox == null) {
        MessageBox.Show("You did not enter any text on the form");
        }
    }

    private void txtBtn1_Click(object sender, EventArgs e) {
        clickNumBoxArray[1]++;
        if (clickNumBoxArray[1] % 2 == 0) {
            txtBtn1.BackColor = System.Drawing.Color.DarkOrange;
        } else {
            txtBtn1.BackColor = System.Drawing.Color.WhiteSmoke;
        }
    }

    private void txtBtn0_Click(object sender, EventArgs e) {
        clickNumBoxArray[0]++;
        if (clickNumBoxArray[0] % 2 == 0) {
            txtBtn0.BackColor = System.Drawing.Color.DarkOrange;
        } else {
            txtBtn0.BackColor = System.Drawing.Color.WhiteSmoke;
        }
    } 
```

这是另一个类

> ```
>  class UserSquare {
>     public string squareChecked() {
>         string clickedBoxes = null;
>         MainForm numBoxArray = new MainForm();
>         int[] clickNumBoxArray = numBoxArray.clickNumBoxArray;
>          for (int i = 0; i < 81; i++) {
>              if (clickNumBoxArray[i] % 2 == 0) {
>                  clickedBoxes += "txtBtn" + i + ", ";
>              }
>          } return clickedBoxes; 
>     } 
> ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T00:28:15.427

该行：

```
for (int i = 0; i < 81; i++) 
```

应该：

```
for (int i = 0; i < 80; i++) 
```

该数组`clickNumBoxArray`只有 80 个元素，索引从 0 到 79。您正在循环 81 个项目，索引从 0 到 80。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T00:57:48.140

关于`IndexOutOfRange Exception`您的问题是您在此处实施列表

```
public int[] clickNumBoxArray = Enumerable.Repeat(1, 80).ToArray(); 
```

从 1 开始，完成 80 = 80 个元素

但是在方法中，您`for loop`从 0 开始并完成 81 = 81 个元素

以及关于错误控制..简单而棘手..您可以将`internal`/`public boolean`作为默认值`false`并根据需要`true`在鼠标事件中设置（iemouseclick 事件）..错误方法的结束或您需要的其他位置，设置为 false为另一个点击事件控制做好准备

关于 ButtonClick 不会触发其事件（如果我没有误解的话）：您是否删除了某些按钮方法？你会忘记实施它吗？

打开您的设计模式单击一次要检查的控件，然后打开属性=>事件..如果您的事件已实现，则应该是这样：（即）

(属性) MouseClick (值) Button1_MouseClick

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T01:13:32.133

我通过移动来修复它

```
public int[] clickNumBoxArray = Enumerable.Repeat(1, 81).ToArray(); 
```

到 UserSquare 类。我发现 UserSquare 类仅在程序运行而不是更新时获取值。

# build - 将 Visual Studio 解决方案文件移植到 scons 的最佳实践

> ID：10770761
> 
> 赞同：4
> 
> 时间：2012-05-27T00:23:33.910
> 
> 标签：build, scons

我是 scons 的新手，并试图移植现有的 Visual Studio 解决方案（.sln），该解决方案在内部引用了许多 VS 项目文件（.vcxproj）。这是多个输出，包括各种库和不同的可执行文件。

从概念的角度来看，我不确定我是否走在正确的道路上，并且会感谢任何关于如何做得更好的建议。

这是我的设置：

我在代码仓库的根目录中有一个顶级 SConstruct 文件。此外，我的每个旧 VS 项目文件都有一个 SConscript 文件。SConstruct 文件为这些 SConscript 文件中的每一个调用 SConscript 函数一次，它在其中指定源目录以及输出应作为参数的位置。

此外，SConstruct 文件创建并向每个 SConstruct 文件传递​​一个 scons 环境实例数组。例如，有一个用于编译库，一个用于编译可执行文件，一个用于调试配置，一个用于发布等，然后每个 SConscript 文件根据它要完成的任务选择它想要的一个。

有几件事我想知道：1）有没有比创建多个不同环境更好的方法，每个配置变体一个？这是预期的使用模式吗？2）在Visual Studio中，我可以右键单击特定项目并选择构建以仅构建该项目及其所依赖的项目，而忽略sln中的其余依赖关系图。使用 scons，它是否会在每次触发特定库的构建时重新计算整个依赖关系图，即使理论上它只需要计算整个依赖关系图的一小部分。

感谢您的任何建议。

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T10:47:09.970

您让 SConstruct 调用多个附属 SConscript 文件的方法确实是组织项目的好方法，称为[Hierarchical SCons build](http://www.scons.org/doc/production/HTML/scons-user/c3181.html)。

关于你的问题，这里有一些事情需要考虑：

1.  **几种不同的环境：**除非您对每个构建器或目标（库、可执行文件等）有不同的编译器或编译器标志，否则我会说您使用的方法有点矫枉过正。您很可能只使用一种环境就可以达到同样的效果。如果您确实需要每个子目录/构建器的附加标志，那么您可以考虑将“主”环境传递给子目录，并在相应的 SConscript 中克隆 env 并添加/附加您需要的内容，如此[处](https://stackoverflow.com/a/10366384/1158895)所述。这样，整个解决方案将更加模块化，避免重复并将所有通用的东西放在一个中心位置。

2.  **构建某些项目/目标：**您可以通过在命令行上选择目标来对 SCons 执行相同的操作，如下所示`$ scons yourTarget`。[您可以使用env.Alias()](http://www.scons.org/doc/production/HTML/scons-user/c4348.html)函数使目标名称更易于管理。SCons 确实在构建之前分析了所有内容，但是根据项目的大小，这应该不是问题，它仍然很快。如果构建性能确实成为问题，[这里](http://www.scons.org/wiki/GoFastButton)有一些改进性能的建议。

这里有一些额外的好东西要知道：

*   [SCons 文档](http://www.scons.org/doc/production/HTML/scons-user/index.html)对于其他开源工具来说是不错的 WRT。在该文档页面的底部，有几个包含大量额外信息的附录。[SCons 手册页](http://www.scons.org/doc/production/HTML/scons-man.html)也很完整。
*   如果您不使用[此处提到的“#”，则 SCons 中的路径可能会令人困惑](https://stackoverflow.com/a/9807067/1158895)
*   如果你需要处理 MSVS 项目，你可以使用[这里](http://www.scons.org/doc/production/HTML/scons-user/a8121.html)提到的 MSVSProject() 和 MSVSSolution() 构建器。

# asp.net-mvc-3 - MVC3 Razor - 模型和视图

> ID：10770762
> 
> 赞同：0
> 
> 时间：2012-05-27T00:24:15.577
> 
> 标签：asp.net-mvc-3, razor, model, views, partial

我有一个创建列表并将其返回到我的视图的操作。

```
public ActionResult GetCustomers()
    {
        return PartialView("~/Views/Shared/DisplayTemplates/Customers.cshtml", UserQueries.GetCustomers(SiteInfo.Current.Id));
    } 
```

在“~/Views/Shared/DisplayTemplates/Customers.cshtml”视图中，我有以下内容：

```
@model IEnumerable<FishEye.Models.CustomerModel>
@Html.DisplayForModel("Customer") 
```

然后我在“~/Views/Shared/DisplayTemplates/Customer.cshtml”视图中：

```
@model FishEye.Models.CustomerModel
@Model.Profile.FirstName 
```

我收到错误消息：

```
The model item passed into the dictionary is of type System.Collections.Generic.List`1[Models.CustomerModel]', but this dictionary requires a model item of type 'Models.CustomerModel'. 
```

它不应该为 Customers.cshtml 中集合中的每个项目显示 Customer.cshtml 吗？

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:29:46.097

您的视图需要一个模型：

```
@model FishEye.Models.CustomerModel  // <--- Just one of me 
```

您正在向它传递一个匿名列表：

```
... , UserQueries.GetCustomers(SiteInfo.Current.Id)  // <--- Many of me 
```

您应该更改您的视图以接受列表或在将列表中的哪个项目传递给视图之前确定应该使用它。请记住，包含 1 个项目的列表仍然是列表，不允许 View 猜测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T01:11:52.600

我不确定您为什么要调用这样的局部视图。如果是特定于客户的视图，为什么不将其放在`Views/Customer`文件夹下？记住 ASP.NET MVC 更多的是**约定**。所以我会一直遵守约定（除非绝对有必要配置自己）以保持简单。

为了处理这种情况，我会这样做，

一个`Customer`和`CustomerList`模型/视频模型

```
public class CustomerList
{
    public List<Customer> Customers { get; set; }
    //Other Properties as you wish also
}

public class Customer
{
    public string Name { get; set; }
} 
```

在 action 方法中，我会返回一个 CustomerList 类的对象

```
CustomerList customerList = new CustomerList();
customerList.Customers = new List<Customer>();
customerList.Customers.Add(new Customer { Name = "Malibu" });
// you may replace the above manual adding with a db call.
return View("CustomerList", customerList); 
```

现在应该有一个名为文件夹`CustomerList.cshtml`下的视图。`Views/YourControllerName/`该视图应如下所示

```
@model CustomerList
<p>List of Customers</p>
@Html.DisplayFor(x=>x.Customers) 
```

有一个`Customer.cshtml`在`Views/Shared/DisplayTemplate`s 下被称为这个内容的视图

```
@model Customer
<h2>@Model.Name</h2> 
```

这将为您提供所需的输出。

# mysql - 在哪里（如何）在我的数据库中存储类别（某种）树？

> ID：10770765
> 
> 赞同：0
> 
> 时间：2012-05-27T00:24:31.753
> 
> 标签：mysql, database-design, csv, entity-relationship

所以，我正在使用 MySQL Workbench 对数据库进行建模。我有一个名为 Category 的表（两个字段，id 和 description）和一个名为 Event 的表。我想在 Event 中有一个列，其中包含来自类别的任意数量的 id（作为 CSV，并且它们的顺序很重要）。我如何在 MySQL Workbench 中表示这一点（我的意思是在 ER 模型中）？还是我这样做真的错了？

它看起来像这样：

```
| ID | Descripion
|  1 | Lorem...
|  2 | Ipsum...
|  3 | Dolor...
|  4 | Sit...
|  5 | Amet...

| ID | Name   | Categories
|  1 | John   | 2,1,5,4
|  2 | Reese  | 3,5,4
|  3 | Ben    | 1,5
|  4 | Linus  | 3,4,2
|  5 | Jack   | 5
|  6 | Lemon  | 4,5,2 
```

（我已经读过这篇文章：[如何在数据库中构建“类别”数据？](https://stackoverflow.com/questions/7941228/how-to-structure-categories-data-in-the-database)但我不确定我是否处于同样的情况。我的类别更像是“树”而不是标签......）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:40:12.373

对于多对多关系，您需要一个中间表，其中包含您正在创建的关系的两个表中的 id。在此表上，您还可以设置一个排序列，指示如何对您的类别进行排序。

```
| ID_Event | ID_Cat | Order
| 1        | 1      | 2000 
| 1        | 2      | 1000
| 1        | 5      | 3000
| 1        | 4      | 4000 
```

等等。

您可以选择在订购列中留出 1000 多个值的间距，以便您可以轻松地在现有订购商品之间放置类别。

# jquery - 简单的 jQuery 算法

> ID：10770766
> 
> 赞同：1
> 
> 时间：2012-05-27T00:24:33.247
> 
> 标签：jquery, math

从理论上讲，如果我有一个未排序项目的列表

```
<ul>
    <li><a>Link1</a></li>
    <li><a>Link1</a></li>
</ul> 
```

我怎么能用 jQuery 做以下事情？

`a`1）找到每个单独元素的宽度

`li`2）找到每个单独元素的宽度

`a`3）从其父`li`元素的宽度中减去每个子元素的宽度

4）然后将总计添加到每个父`li`元素

这不起作用：

```
$('ul > li').each(function() {
  var liWidth = (this).width();
  var aWidth = ('ul > li > a').width();
  var subractedWidth = parseFloat(liWidth) - parseFloat(aWidth);
  var newWidth = subtractedWidth + parseFloat(liWidth);
  $(this).css('width',newWidth);  
}); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:28:53.000

您忘记`$`在几个地方使用 ，并且您正在尝试获取您所在`<a>`的特定范围内的宽度`<li>`，因此您不应该重新查询整个 DOM。这会做到：

```
$('ul > li').each(function() {
    var liWidth = parseFloat($(this).width());
    var aWidth = parseFloat($(this).find('a').eq(0).width());
    $(this).width((liWidth - aWidth) + liWidth);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T00:53:10.650

你可以做

```
$('ul > li > a').each(function () {
    var li = $(this).closest('li'), 
        liWidth = li.width(),
        aWidth = $(this).width();

    li.width(liWidth + (liWidth - aWidth));
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T00:30:56.653

看起来你忘记了一些美元。

```
$('ul > li').each(function() {
  var liWidth = $(this).width();
  var aWidth = $(this).find('a').width();
  var subractedWidth = parseFloat(liWidth) - parseFloat(aWidth);
  var newWidth = subtractedWidth + parseFloat(liWidth);
  $(this).css('width',newWidth);  
}); 
```

# javascript - 使用 javascript 和 ajax 等待图像

> ID：10770771
> 
> 赞同：2
> 
> 时间：2012-05-27T00:25:32.787
> 
> 标签：javascript, ajax, xmlhttprequest

有没有办法在使用 XMLHttpRequest 时放置一个机智的图像（即 wait.gif）？

我有一个名为“loader”的“隐藏”div。我在哪里将显示更改为阻止，然后返回无？

这里基本上是我的代码：

```
var xmlhttp;
if (window.XMLHttpRequest){
  xmlhttp=new XMLHttpRequest();
  }
else {
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    ///Do Something with answer
    }
  }
xmlhttp.open("GET","gtservice01.php?s="+req01,true);
xmlhttp.send(); 
```

我还没有准备好进行 jquery 跳跃。

谢谢

R

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T00:32:04.293

```
xmlhttp.onreadystatechange=function( ) { 
    if(xmlhttp.readyState==4){
        //set display to none
        document.querySelector("div#loader").style.display="none";
        if(xmlhttp.status==200){ 
            //Do Something with answer 
        }
    } 
} 

xmlhttp.open("GET","gtservice01.php? s="+req01,true);
//set display to block
document.querySelector("div#loader").style.display="block";
xmlhttp.send(); 
```

# java - Tomcat 7 受限 (ContainerServlet) 错误

> ID：10770773
> 
> 赞同：6
> 
> 时间：2012-05-27T00:25:51.903
> 
> 标签：java, tomcat, httpclient

我已经坚持了一段时间了。我正在尝试访问我使用 HttpClient 和 Tomcat 7 实现的 ContainerServlet。我不断收到错误消息“Restricted(ContainerServlet)”。我添加了基本身份验证并尝试像内置的主机管理器应用程序一样设置它，但没有运气。

我的 HostManagerServlet 以：

```
public class HostManagerServlet
extends HttpServlet implements ContainerServlet {... 
```

我的 web.xml 包含：

```
<servlet>
            <servlet-name>virtualHostCreator</servlet-name>
            <servlet-class>com.eatmyfish.servlets.HostManagerServlet</servlet-class>
          </servlet>
          <servlet-mapping>
            <servlet-name>virtualHostCreator</servlet-name>
            <url-pattern>/virtualhostcreator/*</url-pattern>
          </servlet-mapping>
    <security-constraint>
        <web-resource-collection>
          <web-resource-name>HostManager commands</web-resource-name>
          <url-pattern>/virtualhostcreator/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
           <!-- NOTE:  This role is not present in the default users file -->
           <role-name>admin-script</role-name>
        </auth-constraint>
      </security-constraint>
      <security-constraint>
        <web-resource-collection>
          <web-resource-name>HTMLHostManager commands</web-resource-name>
          <url-pattern>/virtualhostcreator/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
           <!-- NOTE:  This role is not present in the default users file -->
           <role-name>admin-gui</role-name>
        </auth-constraint>
      </security-constraint>
<login-config>
    <auth-method>BASIC</auth-method>
  </login-config>
<security-role>
    <description>
      The role that is required to log in to the Host Manager Application HTML
      interface
    </description>
    <role-name>admin-gui</role-name>
  </security-role>
  <security-role>
    <description>
      The role that is required to log in to the Host Manager Application text
      interface
    </description>
    <role-name>admin-script</role-name>
  </security-role> 
```

我的 tomcat-users.xml 包含：

```
.
.
.
<role rolename="admin-gui"/>
  <role rolename="admin-script"/>
  <role rolename="manager-gui"/>
  <role rolename="tomcat"/>
  <role rolename="role1"/>
  <user username="tomcat" password="tomcat" roles="tomcat,admin-gui,admin-script,manager-gui"/>
.
.
. 
```

进行 HttpClient 调用的代码（我尝试了几种不同的方法）：

方法一 -

```
String url = environment.getProperty("baseurl");
        url += "virtualhostcreator/createVirualHost?name="+group.getGroupName();
        HttpClient httpclient = new DefaultHttpClient();

        HttpGet httpget = new HttpGet(url);
        httpget.addHeader(BasicScheme.authenticate(
                 new UsernamePasswordCredentials("tomcat", "tomcat"),
                 "UTF-8", false));
        HttpResponse response = httpclient.execute(httpget); 
```

方法二 -

```
String url = environment.getProperty("baseurl");
        url += "virtualhostcreator/createVirualHost?name="+group.getGroupName();
        DefaultHttpClient httpclient = new DefaultHttpClient();
        httpclient.getCredentialsProvider().setCredentials(
                new AuthScope("localhost", 8080),
                new UsernamePasswordCredentials("tomcat", "tomcat"));
        // Create AuthCache instance
        AuthCache authCache = new BasicAuthCache();
        // Generate BASIC scheme object and add it to the local
        // auth cache
        HttpHost targetHost = new HttpHost("localhost", 8080, "http");
        BasicScheme basicAuth = new BasicScheme();
        authCache.put(targetHost, basicAuth);

        // Add AuthCache to the execution context
        BasicHttpContext localcontext = new BasicHttpContext();
        localcontext.setAttribute("http.auth.auth-cache", authCache);

        HttpGet httpget = new HttpGet(url);

        HttpResponse response = httpclient.execute(targetHost, httpget,localcontext); 
```

错误的堆栈跟踪：

```
SEVERE: Allocate exception for servlet virtualHostCreator
java.lang.SecurityException: Restricted (ContainerServlet) class com.eatmyfish.servlets.HostManagerServlet
    at org.apache.catalina.core.DefaultInstanceManager.checkAccess(DefaultInstanceManager.java:536)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:509)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:124)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1136)
    at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:857)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:135)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:581)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

任何想法我做错了什么？我无法通过 Restricted(ContainerServlet) 错误。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-25T00:39:58.170

我在 Tomcat 7 中遇到了类似的问题，并且能够通过编辑顶级元素`./conf/context.xml`使其看起来像

```
<Context privileged="true"> 
```

我想不通的是 Tomcat 自己的管理器 servlet 是如何在没有这种配置的情况下加载的。有人有任何线索吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T01:04:21.857

我找到了答案。我需要在 server.xml 内的主机上下文中设置 privileged=true

# codeigniter - 尝试使用 _remap 创建页面控制器

> ID：10770776
> 
> 赞同：0
> 
> 时间：2012-05-27T00:26:32.490
> 
> 标签：codeigniter

我正在尝试为带有 h​​ttp://www.example.com/about 之类的网址的网站创建默认页面[控制器](http://www.example.com/about)。因此，如果没有“关于”控制器，则在数据库中查找具有该 url 字符串的页面。

我已将 404_override 设置为我的“页面”控制器，并使用 _remap() 函数来确定下一步要去哪里，加载主页（页面控制器的 index() 方法）或加载页面。

但是，就目前而言，如果我使用不同的控制器（在本例中为产品）和路径中的方法（http://www.example.com/product/widget，它不存在），我正在为页面控制器的 index() 方法提供服务。

我认为问题出在我检查请求的页面是否是我的 _remap() 中的主页的方式上，所以我在我的重映射的开头添加了一个回显，看看它是否重要。_remap() 似乎没有被调用。相反，在尝试处理 404_override CI 时，只显示索引方法。

有什么想法可以让我更有效地做到这一点吗？

```
 public function _remap($method)
{
    echo 'Method '.$method;
    if($this->uri->segment(1) == null)
    {
        // $this->index();
    } else {
        $this->view();
    };
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T00:53:58.783

我似乎在这篇博文中找到了一个可行的解决方案：http: [//pinoytech.org/blog/post/codeigniter-route-everything-except-these-controllers](http://pinoytech.org/blog/post/codeigniter-route-everything-except-these-controllers)

在路由定义中使用正则表达式允许忽略其他控制器（产品、订单等），同时仍将其他所有内容发送到页面控制器。

```
$route['^(?!product|order|misc_controller)\S*'] = "page/$1"; 
```

尚未对其进行测试，但据我所知，它应该可以正常工作。

# java - Java 保存和加载程序的状态

> ID：10770777
> 
> 赞同：2
> 
> 时间：2012-05-27T00:26:39.647
> 
> 标签：java, swing, savestate

在我的 java 项目中，我有几个类/java 文件，但在存储所有使用的东西列表的 Menu 类中。在数据方面，我存储了 6 个列表（2 个 ArrayLists 和 4 个 HashMaps），其中 1 个在 Menu 类中定义，其他在不同的类中。所以我需要在关闭程序时创建一个*savestate*和一个*loadstate*来恢复以前的状态。所有的列表都是用*Serializable实现的*

是否可以保存所有菜单的状态并重新加载它，或者我必须单独保存所有列表？将所有内容保存在一个文件中会很棒。

这是我拥有的功能，工作（没有警告/错误）并编译但不创建文件“*数据文件*”。

有任何想法吗？

```
 private void MenuSave(){
    String wd = System.getProperty("user.dir");

    JFileChooser fc = new JFileChooser(wd);
    int rc = fc.showDialog(null, "Select Data File Location to Save");

    if (rc == JFileChooser.APPROVE_OPTION)
    {
    File file = fc.getSelectedFile();
    String filename = file.getAbsolutePath();

    savestate(lf, lc, lv, lcl,filename);}
    }

public void savestate(Cars la, Bikes l2, Motos l3, Planes l4, People n1, Food n2, String filename){

    int i;
    File out = new File(filename);

    ObjectOutputStream output = null;

    try{
        output = new ObjectOutputStream(new FileOutputStream(filename));
        for(Car c : la.getCars().values()){
            output.writeObject(c);
        }
        for(Bike b : l2.getBikes().values()){
            output.writeObject(b);
        }
        for(Moto m : l3.getMotos().values()){
            output.writeObject(m);
        }
        for(i=0;i<n1.size();i++)
        {output.writeObject(n1.get(i)));
        }
        for(i=0;i<n2.size();i++)
        {output.writeObject(n2.get(i)));
        }

    }catch (FileNotFoundException ex) {
        ex.printStackTrace();
    } catch (IOException ex) {
        ex.printStackTrace();
    } finally {
        try {
            if (output != null) {
                output.flush();
                output.close();
            }
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T05:50:48.980

> 不创建文件“数据文件”。

我敢打赌它确实如此，只是不是你期望找到它的地方。不要“将文件放在任何地方”，将它们放在可读/可写、合乎逻辑且可重现的地方。

```
String filename = "datafiles";
File out = new File(System.getProperty("user.home"), filename);
// ...
    output = new ObjectOutputStream(new FileOutputStream(out)); 
```

然后在用户主页中查找`datafiles`（为什么它没有文件类型/扩展名？）文件。

1.  [`File`接受 2 个`String`（父级和名称）参数](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#File%28java.lang.String,%20java.lang.String%29)的构造函数使用`File`操作系统的正确分隔符。
2.  `user.home`是一个[系统属性](http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)，它指向具有读/写访问权限的稳定、可重现的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:28:48.203

所以我想我只需要单独保存列表而不*需要*. 1-选择保存文件的位置，然后将类保存在那里。2-读取只是解析输入并存储替换当前类。...

```
 String wd = System.getProperty("user.dir");
    this.setAlwaysOnTop(false);
    JFileChooser fc = new JFileChooser(wd);

    fc.setDialogType((int)JFileChooser.SAVE_DIALOG);

    int rc = fc.showDialog(null, "Select Data File");
    this.setAlwaysOnTop(true);

    if (rc == JFileChooser.APPROVE_OPTION)
    {
    File file = fc.getSelectedFile();

    ObjectOutputStream output = null;

    try{
    output = new ObjectOutputStream(new FileOutputStream(file));
    output.writeObject(list1);
    output.writeObject(list2);
    output.writeObject(list3);
    ....

    output.close();

    }catch (IOException x){
     ....
    }catch(NullPointerException n){
     ....    
    }} 
```

阅读是一样的：

```
 String wd = System.getProperty("user.dir");
    this.setAlwaysOnTop(false);
    JFileChooser fc = new JFileChooser(wd);
    fc.setDialogType((int)JFileChooser.OPEN_DIALOG);
    int rc = fc.showDialog(null, "Select Data File to Load");
    this.setAlwaysOnTop(true);

    if (rc == JFileChooser.APPROVE_OPTION)
    {
    File file = fc.getSelectedFile();
    String filename = file.getAbsolutePath();

    ObjectInputStream input = null;
    try{
    input = new ObjectInputStream(new FileInputStream(file));
    this.list1=(ListType1)input.readObject();
    this.list2=(ListType2input.readObject();
    ....
    }catch (IOException x){
      ...  

    }catch(ClassNotFoundException x){
      ...
    }
    } 
```

# android - 从处理程序返回一个字符串..从服务

> ID：10770781
> 
> 赞同：0
> 
> 时间：2012-05-27T00:27:48.737
> 
> 标签：android, service, handler

这是我的应用程序布局。

```
 MainActivity
    |
    Service
    |__Handler
       |__Runnable 
```

在 Runnable 中，我从 Internet 检索字符串。如果这很重要，它足够小以适应意图。我想将字符串一直传递回 MainActivity 并通知它已更新。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:51:17.147

两种方法：

1.  从 Runnable 进行广播
2.  从 Runnable 启动 MainActivity

两者都需要将结果作为 String Extra 放在 Intent 中。

我想您的 Handler 和 Runnable 是 Service 下的内联类，因此您可以访问`Context`. 如果没有，您必须将服务上下文传递给这些类。

```
> There seem to be some scope issues. 
```

不，任何类都可以调用`Context.sendBroadcast`or `Context.startActivity`，并且不需要在主线程上完成。

# php - socket.io + php + 在这个时间点这是一个现实的解决方案吗

> ID：10770787
> 
> 赞同：0
> 
> 时间：2012-05-27T00:29:40.113
> 
> 标签：php, javascript, socket.io

我一直在阅读有关 websockets 和 socket.io 的信息。

我了解不支持 websockets，但有足够的浏览器尚未实际使用。

socket.io 有浏览器支持，但似乎需要 node.js。使用我的托管解决方案，我在共享服务器上有一些空间，对服务器的控制非常有限，并且可以访问 php，但没有 node.js。

我读过人们可以让 socket.io 与 PHP 一起工作。

问题：看到我的服务器访问权限非常有限，无法控制端口、命令行等，是否可以让 socket.io 与 PHP 一起使用，或者我应该坚持使用 AJAX 调用（我目前正在使用）？

注意：我开发了一个聊天解决方案，如果它与套接字解决方案一起运行，它的重量似乎会轻得多。

另外 - Sockets.io 有很好的安全性吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:44:25.850

尝试让 PHP 与 socket.io 对话，我怀疑这将是一项艰巨的任务。

当然，通过 pre-fork 或线程 apache 运行 websockets 不是一个好主意。如果您可以处理 PHP 进程的数量，任何基于事件的服务器都应该没问题。更好的方法是*在*php.ini 中编写基于事件的服务器。[像这个](http://code.google.com/p/phpws/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T14:31:09.160

我研究了一些 websocket 服务器实现。我读到，有一种方法可以在生产中使用 node.js。使用 apache 多年，我还搜索了一个模块来处理 apache 中的 websockets，但只找到了半心半意的东西。没有任何东西看起来很坚固。

我偶然发现了 yaws，这是一个用 erlang 编写的支持 websocket 的服务器，它的优点是为高度并行的应用程序（如聊天）提供了正确的语言，并且还因为 websockets 应该很好地集成到主服务器中。

现在，我正在开发一个 php 聊天服务器，它使用一个名为 ratchet 的框架。-> 谷歌搜索“棘轮 php”。他们有一个很好的教程。

我通过命令行启动它，虽然对你来说应该可以通过浏览器调用启动棘轮服务器，但我不建议这样做。

所以在您受限的托管环境中，我会坚持使用 ajax。

# javascript - jQuery href 属性添加在 Firebug 中可见但在源代码中不可见

> ID：10770788
> 
> 赞同：0
> 
> 时间：2012-05-27T00:29:42.527
> 
> 标签：javascript, jquery

这可能是微不足道的，但我有以下代码动态地向元素添加一些`href`属性`<a>`，其中重要的变量在弹出窗口中传递给 php 生成的页面。

```
jQuery(document).ready(function(){    

   var url = jQuery("a.special-links").attr("href");
   var data = "?iframe=true&width=800&height=350&format=popup";

   jQuery("a.special-links").attr("href", url + data);
}); 
```

当使用 Firebug 检查页面时，该`<a>`元素获得了`href`正确的 url 属性，但链接不起作用。当我检查查看源代码的代码时，我发现`href`实际上没有添加数据部分！

这是运行时问题还是其他问题？感谢提供线索...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:42:20.973

查看页面源代码时看不到更改，因为当您`view source`查看加载访问的 URL 时浏览器下载的实际 HTML 文档时。这永远不能被javascript改变。

当您编写 javascript 时，您会更改称为`Document Object Model`aka 的`DOM`. 这是浏览器在解析 HTML 文档后构建的内存数据结构。这就是 firebug 使您能够检查的内容。

# c++ - 在 Windows 中将原始数据写入磁盘失败，错误代码 83（无效参数）

> ID：10770790
> 
> 赞同：1
> 
> 时间：2012-05-27T00:29:50.123
> 
> 标签：c++, disk

我有一小段代码，我试图用它来将一个大约 100 字节长的字符串写入地址 0x600 的磁盘。

```
UCHAR szStr[0x4C] = {0};
memcpy(szStr, "Example string", 8);
DWORD bytes, cb;
HANDLE hDisk = CreateFile("\\\\.\\I:", GENERIC_WRITE | GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL);
if (hDisk == INVALID_HANDLE_VALUE)
{
    cout << "CreateFile error"<< endl << GetLastError();
}
if (!DeviceIoControl(hDisk, FSCTL_LOCK_VOLUME, NULL, 0, NULL, 0, &cb, NULL))
{
    cout << "IO Error"<< endl << GetLastError();
}
if (SetFilePointer(hDisk, 0x600, NULL, FILE_BEGIN) == INVALID_SET_FILE_POINTER)
{
    cout << "Pointer error"<< endl << GetLastError();
}
if (!WriteFile(hDisk, szStr, 0x4C, &bytes, 0))
{
    cout << "Write error" << endl << GetLastError();    //Only one that triggers (err code 87)
}
CloseHandle(hDisk); 
```

出于某种原因，一切都很好，直到我打电话`WriteFile()`失败。`GetLastError()`返回代码 83，表示`INVALID_PARAMETER`. 我尝试通过在桌面上指定一个普通文件而不是驱动器来调试它，`I:\`并且操作成功启动，所以我最好的猜测是问题出在驱动器的磁盘句柄上`I:\`。

[我在此处](http://msdn.microsoft.com/en-us/library/ff551353.aspx)阅读了 MSDN 的一篇文章，该文章解释了如果您不先锁定/卸载驱动器，原始磁盘 I/O 会被阻塞。我很困惑为什么这会是一个问题，因为我在执行任何其他操作之前调用`DeviceIoControl`了我的代码来锁定设备。`FSCTL_LOCK_VOLUME`磁盘有一个活动文件系统（FAT32/FAT16），0x600 区域可能位于文件系统内，但根据文章，如果我锁定驱动器，我应该能够写入它。知道这里发生了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T05:00:57.587

您是否正在检查`DeviceIoControl`并`SetFilePointer`查看错误指示？您是否有权执行您正在尝试的操作？原始磁盘写入 IIRC 需要管理员帐户。

你试图打开的磁盘是系统盘吗？（它是否包含操作系统文件？）如果是，Lock IOCTL 将失败。

如果磁盘上有页面文件，您尝试锁定 Lock IOCTL 将失败。

# ios5 - 未在多个视图控制器应用程序中调用 remoteControlReceivedWithEvent

> ID：10770795
> 
> 赞同：3
> 
> 时间：2012-05-27T00:31:05.740
> 
> 标签：ios5, avaudioplayer, remote-control

我有一个应用程序在 iOS 4.3.3 上运行良好。但是我发现在iOS 5上存在一些问题。这个应用程序通过avaudioplayer播放mp3文件，并且遥控器在iOS 5上无法正常工作。

这个 App 中有四个视图控制器。为了实现远程控制的功能，我在每个视图控制器上添加了以下代码。问题是，当视图控制器第一次打开时。遥控器按钮效果很好，即使应用程序在后台运行或锁定屏幕。但是当我单击另一个视图控制器并返回上一个视图时，遥控器不再工作了。但是每次都会调用 canBecomeFirstResponder 函数。

我什至尝试把 [[UIApplication sharedApplication] beginReceivingRemoteControlEvents]; 在委托函数 (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 它不起作用。

我不明白为什么会这样。它折磨了我好几天。有没有更好的方法在多个视图控制器中实现远程控制功能？

顺便说一句，我将 UIBackgroundModes 音频键添加到 info.plist。这个应用程序在后台运行良好。

任何帮助将不胜感激。

```
- (void)viewDidAppear:(BOOL)animated {
[super viewDidAppear:animated];

[[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
[self becomeFirstResponder];
}
- (void)viewWillAppear:(BOOL)animated {
[[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
[self becomeFirstResponder];
}  
- (void)viewWillDisappear:(BOOL)animated {
[super viewWillDisappear:animated];
[[UIApplication sharedApplication] endReceivingRemoteControlEvents];
[self resignFirstResponder];
}
- (BOOL) canBecomeFirstResponder {
NSLog(@"Can be first responder!");
return YES;
}
- (void)remoteControlReceivedWithEvent:(UIEvent *)event
{
if (event.subtype == UIEventSubtypeRemoteControlTogglePlayPause) {
    NSLog(@"UIEventSubtypeRemoteControlTogglePlayPause");
    [self playAndpause:nil];
}
} 
```

# iphone - UIViewController initWithNibName 导致 nil 视图

> ID：10770796
> 
> 赞同：0
> 
> 时间：2012-05-27T00:31:10.153
> 
> 标签：iphone, ios, uiview, uiviewcontroller, nib

我正在尝试制作一个始终加载相同笔尖的视图控制器。我的初始化代码如下所示：

```
-(id)init
{
    NSString* nibName;

    if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
        nibName = @"XIB_iPad";
    else
        nibName = @"XIB_iPhone";

    self = [super initWithNibName:nibName bundle:nil];
    if (self)
    {
        ...
    }
    return self;
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    return [self init];
} 
```

问题是这段代码导致视图控制器的视图为零。我在这里做错了吗？有一个更好的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-27T02:45:21.910

检查以下内容：

1.  XIB_iPad.xib 和 XIB_iPhone.xib 都存在于您的项目中。
2.  每个 xib 文件的“文件所有者”都属于正确的类 (YourViewController)。
3.  每个文件所有者视图出口（在 xib 文件中）都正确链接到视图。

如果您在检查这三个步骤后仍然遇到问题，请提供您用于实例化和设置自定义视图控制器的代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-25T17:29:08.940

我有同样的问题。

我按照所选答案检查了所有选项，并没有为我解决问题。

我的问题是视图的自动布局已启用（但我不知道为什么，由于此功能，视图总是为零；如果有人知道，请发表评论）。

要禁用自动布局，请转到“文件检查器”并取消选中“使用自动布局”选项（见图）。

希望帮助某人。

![在此处输入图像描述](../Images/dcf15b9500c0bb72e341a170b23654d2.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-14T16:20:58.823

需要注意的是，如果您传递`nil`，`nibName`根据文档，请按以下顺序进行搜索（强调添加）：

> 如果视图控制器类名以单词“Controller”结尾，如 MyViewController 中，它会查找名称与类名匹配但不包含单词“Controller”的 nib 文件，如**MyView.nib**中。
> 
> 它查找名称与视图控制器类的名称匹配的 nib 文件。例如，如果类名为 MyViewController，它会查找**MyViewController.nib**文件。

我有一个简单的香草视图，其名称基本相同，最后*没有*“控制器”后缀。它正在加载这个而不是预期的笔尖。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T00:37:30.507

你的代码对我来说很合适。您的 XIB 文件是否有可能以不同的方式命名（设备上的大小写问题），并且它们是正确目标的成员？

# spring - Spring MVC 3.0，404错误，控制器用于服务主页

> ID：10770798
> 
> 赞同：0
> 
> 时间：2012-05-27T00:31:40.310
> 
> 标签：spring, jakarta-ee, spring-mvc

我想在启动/启动时将我的应用程序（在 Apache Tomcat 7.0 上运行的 Spring）路由到提供主视图的控制器

所以：

1）我在web.xml的欢迎文件标签中定义了一个index.htm

2) 我用 @Controller @RequestMapping("/index.htm") 注释了 HomeController

3) 我还在 xml bean 中映射了 HomeController

* * *

我的 web.xml：

```
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>yourmarketnet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>yourmarketnet</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>index.htm</welcome-file>
    </welcome-file-list> 
</web-app> 
```

* * *

我的 spring-servlet.xml 的片段：

```
<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"     
        p:prefix="/WEB-INF/views/" p:suffix=".jsp" p:viewClass="org.springframework.web.servlet.view.JstlView" />
<!-- Controller beab mappinh -->
   <bean class="com.yourmarketnet.controller.spring.HomeController" 
   name="HomeController"/>

    <bean id="unAuthenticatedUrlMapping"
      class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="/index.htm">HomeController</prop>
            </props>
        </property>
    </bean> 
```

* * *

来自 applicationContext.xml 的片段：

```
<!-- Activates various annotations to be detected in bean classes --> 
    <context:annotation-config />
    <!-- Scans the classpath for annotated components that will be auto-registered as Spring beans.   For example @Controller and @Service. Make sure to set the correct base-package--> 
    <context:component-scan base-package="com.yourmarketnet.mvc.controller.spring" />    
    <!-- Configures the annotation-driven Spring MVC Controller programming model.  Note that, with Spring 3.0, this tag works in Servlet MVC only!  --> 
    <mvc:annotation-driven />      
    <!-- mapping of static resources-->
    <mvc:resources mapping="/resources/**" location="/resources/" />
    <import resource="hibernate-context.xml" /> 
```

* * *

我的家庭控制器：

```
package com.yourmarketnet.controller.spring;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

       @Controller 
        @RequestMapping(value={"/","/index.htm"})
        //If have also tried RequestMapping("/index.htm") OR //If have also tried RequestMapping("index.htm")
        public class HomeController {

            @RequestMapping(method = RequestMethod.GET)
            public String requestHandler()
            {
                return "Home"; 
            }
        } 
```

这也是我的项目结构：

![在此处输入图像描述](../Images/75c5881896cd34c4ae67d83def760dfc.png)

## 然而

我在应用程序启动时收到 404 错误“请求的资源 () 不可用。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T06:08:05.307

做这个

```
@Controller 
public class HomeController {
            @RequestMapping({"/"})
            public String requestHandler()
            {
                return "Home"; 
            }
        } 
```

你都准备好了。

你不需要

```
<bean id="unAuthenticatedUrlMapping"
      class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="/index.htm">HomeController</prop>
            </props>
        </property>
    </bean> 
```

如果您使用注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T07:27:22.553

尝试对你的控制器进行上下文组件扫描。

在您的 ..-servlet.xml 中添加以下行

```
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:context="http://www.springframework.org/schema/context"
   xsi:schemaLocation="http://www.springframework.org/schema/beans 
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd">

 <context:component-scan base-package="com.yourmarketnet.controller.spring"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T05:54:11.360

您的 index.htm 在项目结构中到底在哪里？

而且您不能将**index.htm**定义为欢迎文件并将其与控制器映射。

你有两个解决方案。

1.  如果您没有使用 index.htm，则将其从欢迎文件列表中完全删除，然后仅使用**“/”**值映射您的控制器。

2.  或者您可以将 index.htm 仅作为控制器中的映射，而不使用**“/”**映射。并且不要使用任何欢迎文件列表。

希望这对您有所帮助。

干杯。

# mysql - phpMyAdmin 中的 CREATE TABLE 语句中的 MySQL 错误 1064

> ID：10770808
> 
> 赞同：0
> 
> 时间：2012-05-27T00:33:27.717
> 
> 标签：mysql, sql

```
createTable('members', 'user VARCHAR(16), pass VARCHAR(16),
            INDEX(user(6))');

createTable('messages', 
           'id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
            auth VARCHAR(16), recip VARCHAR(16), pm CHAR(1),
            time INT UNSIGNED, message VARCHAR(4096),
            INDEX(auth(6)), INDEX(recip(6))');

createTable('friends', 'user VARCHAR(16), friend VARCHAR(16),
            INDEX(user(6)), INDEX(friend(6))');

createTable('profiles', 'user VARCHAR(16), text VARCHAR(4096),
            INDEX(user(6))'); 
```

***有人可以帮我找出问题所在吗？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T02:33:19.843

您的 sql 语法不正确。试试这个。

```
CREATE Table `members`
(
    `user` VARCHAR(16), 
    `pass` VARCHAR(16),
    INDEX (`user`)
);

Create Table `messages`
(
    `id` INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    `auth` VARCHAR(16), 
    `recip` VARCHAR(16), 
    `pm` CHAR(1),
    `time` INT UNSIGNED, 
    `message` VARCHAR(4096),
    INDEX(`auth`, `recip`)
);

CREATE Table `friends`
(
    `user` VARCHAR(16), 
    `friend` VARCHAR(16),
    INDEX(`user`, `friend`)
);

create Table `profiles` 
(
    `user` VARCHAR(16), 
    `text` VARCHAR(4096),
    INDEX(`user`)
); 
```

# android - 主屏幕上的 Android 书签不刷新页面

> ID：10770811
> 
> 赞同：0
> 
> 时间：2012-05-27T00:34:48.460
> 
> 标签：android, caching, bookmarks

所以我注意到 Android 浏览器书签的行为不一致。从浏览器中启动的那些将从服务器获取最新页面。从放置在主屏幕上的快捷方式启动的那些通常会简单地重新打开浏览器并重新显示缓存页面。这可能会出现问题，因为更新后缓存的页面可能与服务器版本不一致。例如，用户在书签页面 A 上进行更改，提交到服务器，服务器重定向到页面 B，显示所做的更改。当用户点击主屏幕上的书签时，原始页面A显示没有变化。解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:38:10.857

让 ajax 轮询服务器以查看页面的最新版本。如果这与内部 id 不匹配，则使用添加到 url 的随机数刷新页面。

# c++ - 是否可以使用 SFML 绘制曲线？

> ID：10770817
> 
> 赞同：0
> 
> 时间：2012-05-27T00:37:38.413
> 
> 标签：c++, sfml

我正在使用 SFML 库，它在其最新的 RC 中允许您像这样操作顶点并绘制它们：

```
 // define a 100x100 square, red, with a 40x40 texture mapped on it
 sf::Vertex vertices[] =
 {
     sf::Vertex(sf::Vector2f(  0,   0), sf::Color::White, sf::Vector2f( 0,  0)),
     sf::Vertex(sf::Vector2f(  0, 100), sf::Color::White, sf::Vector2f( 0, 40)),
     sf::Vertex(sf::Vector2f(100, 100), sf::Color::White, sf::Vector2f(40, 40)),
     sf::Vertex(sf::Vector2f(100,   0), sf::Color::White, sf::Vector2f(40,  0))
 }; 
```

现在我的问题是：绘制曲线/角扇区的最佳方法是什么？渲染过程调用OpenGL，所以你可能比SFML更熟悉。基本上可以通过不为每个像素定义 1 个点来绘制曲线吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:47:07.533

不直接使用OpenGL，不行。但通常曲线是由一系列线组成的。只需计算曲线的点（不需要每个像素一个），然后画一条线。

# jquery-mobile - 为什么我无法在 jquery mobile 中加载我的谷歌地图？

> ID：10770818
> 
> 赞同：0
> 
> 时间：2012-05-27T00:37:59.670
> 
> 标签：jquery-mobile, google-maps-api-3

我正在打开此页面的链接上执行 rel="external"，因此 DOM 会重新加载，这应该可以排除很多问题。

然而，使用下面的代码，我得到了一个带有漂亮页眉和页脚的巨大红色背景——尽管正在调用该函数，但地图并没有*初始化*。谁能发现问题？这个错误一直困扰着我；我已经尝试了一百万种方法，包括将其重新设计为没有 rel="external" 的多页模板，但这也不起作用。

```
<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css"/>
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
        <script type="text/javascript">
            $(function(){initializeMap(42,-73);});

            function initializeMap(lat,lng) {
                var latlng = new google.maps.LatLng(lat, lng);
                var myOptions = {
                zoom: 8,
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);
            var crosshairLayer = new google.maps.KmlLayer('http://freezoo.alwaysdata.net/justcrosshair2.kml',
            {preserveViewport: true});

            crosshairLayer.setMap(map);

            google.maps.event.trigger(map, 'resize');
            map.setZoom( map.getZoom() );
            }
        </script>
    </head>
    <body>
        <div data-role="page" data-theme="e" data-add-back-btn="true" class="map1" id="testing">
            <div data-role="header"><h1>Map Page</h1></div>
            <div id="content" style="position:absolute; bottom:40px; top:40px; left:0px; right:0px; background:green;"> 
                <div id="map_canvas" style="position:absolute; top:0px; bottom:0px; width:100%; background:red;"></div>
            </div>
            <div data-role="footer" style="position:absolute; bottom:0px; width:100%;">
                <h1>Working!</h1>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:43:36.213

您的代码不会加载谷歌地图脚本。像这样的例子：

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
```

# assembly - 我的内核在 qemu 中运行正常，但在 bochs 中出现双重故障

> ID：10770819
> 
> 赞同：1
> 
> 时间：2012-05-27T00:38:02.450
> 
> 标签：assembly, operating-system, x86, kernel

我的内核在执行第一个页面错误时崩溃。我的页面错误处理程序如下所示：

```
asm_page_error_wrapper:
    PUSHA  
    movl %esp, %esi
    pushl 48(%esi)/*esp,pusha has already been calculated*/
    pushl 32(%esi)/*error*/
    CALL page_error_interrupt
    popl %ecx
    popl %ecx
    POPA
    addl $4, %esp
    IRET 
```

在 gdb 中，它在“”处崩溃`pushl 48(%esi)`。

这是bochs日志所说的：

![在此处输入图像描述](../Images/128e0dd58158a34cd335a7ed81fb5c03.png) 我不知道原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T19:36:14.623

从屏幕截图看来，您`IDT`的 #GP 处理程序条目无效。我不确定你是如何得出坠机发生在`pushl 48(%esi)`. 这是可能的，但这里似乎并非如此。

如果模拟器产生不同的结果，可能只有几个原因：

1.  您的代码操作未初始化的数据（在寄存器或内存中）
2.  您的代码中有竞争条件
3.  有一个仿真错误

# ruby - Ruby：将位数组转换为整数

> ID：10770821
> 
> 赞同：1
> 
> 时间：2012-05-27T00:38:41.450
> 
> 标签：ruby, bitarray

我正在尝试转换位数组，例如`[0,0,1,0].to_i = 2`or `[0,1,0,1].to_i = 5`。

在 Ruby 中有哪些可能的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-27T00:43:37.353

这是一种方法：

```
 [1] pry(main)> [0,0,1,0].join.to_i(2)
  => 2
  [2] pry(main)> [0,1,0,1].join.to_i(2)
  => 5
  [3] pry(main)> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T00:51:19.247

这是一个稍微复杂的片段（与 Ryan 相比）。

```
a1 = [0,0,1,0]
a2 = [0,1,0,1]

def convert a
  a.reverse.each.with_index.reduce(0) do |memo, (val, idx)|
    memo |= val << idx
  end
end

convert a1 # => 2
convert a2 # => 5 
```

# ios - 为什么我的 UIWebView 在我将它拉到屏幕上后什么都不显示？

> ID：10770822
> 
> 赞同：0
> 
> 时间：2012-05-27T00:38:46.040
> 
> 标签：ios, xcode, uiwebview

我有一系列三个 UIWebViews，并排排列，每个尺寸都是全屏的。

其中一个是“当前”，一个是“下一个”，最后一个是“上一个”。我目前每一个都填充了测试数据（恰当地命名为“测试一”“测试二”“测试三”）。从长远来看，我将处理三个以上的项目。

滑动会导致整个 shebang 向左或向右“旋转”，显示循环中的下一个/上一个项目。据我所知，旋转的代码是正确的。当前采用前一帧，前一帧采用下一帧，下一个采用当前帧。然后我调整指针，使当前指向下一个（现在放置为当前），依此类推。听起来比实际上更复杂：

```
//code to animate this process properly ommited
previous.hidden=1
CGrect tempFrame=current.frame;
current.frame=previous.frame;
previous.frame=next.frame;
next.frame=tempFrame;
previous.hidden=0

//Adjust the actual pointers so they accurately describe their current positions
UIWebView *temp=current;
current=previous;
previous=next;
next=current; 
```

我唯一的问题是，如果您在“空白”的给定直接幻灯片中进行 2 次或更多次浏览，则 Web 视图。EG 向右滑动，您从测试 1 转到测试 2。再次向右滑动，您会看到一个空白屏幕。框架都正确，webview 放置正确，但它的内容是空白的。

令人困惑的是，如果您向相反方向滑动一次，然后返回，它会正确显示。（例如，向右滑动三个，您有一个空白；向左然后向右滑动，它会显示“正确”屏幕。）

有没有人有任何想法可能导致这种情况？我怀疑一旦我进入下一步（“真实数据”，其中下一个/上一个在滑入时加载了适当的项目），它会导致当前问题消失，但我想了解这个问题。

编辑：

我设法将问题部分追溯到我“隐藏”不应该可见的面板。过去，我仍然不确定发生了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T21:26:38.553

原来这与在随机播放中隐藏“未使用”视图有关。为什么当我向后移动时它会起作用我不知道。通过将“未使用”视图移到订单的最后面，一切正常。

# css - 将我的 CSS 测量单位从绝对转换为相对

> ID：10770823
> 
> 赞同：1
> 
> 时间：2012-05-27T00:38:52.750
> 
> 标签：css

我想将我的 CSS 样式表测量单位从绝对转换为相对。

现在我正在使用 px 值。我想把它改成 em。

首先，我这样做是因为我已经看到使用 em 将使页面对所有查看者更加通用。这是正确的决定吗？

如果是这样，我该如何为所有其他人设置默认值？

我应该在正文标签中放置字体的像素大小吗？
因为我通常只是将背景信息分配给 body 标签，然后我创建一个名为 .whole 的 div，并为其分配宽度等，所有内容都在 .whole div 内部，而不仅仅是 body 容器。

那么我应该将默认值放在正文中吗？还是我应该把它放在.whole 中？

我什至应该使用 em 吗？也许rem，恩？或者只是 %'s、em、pt's 和 px 的混合体，在哪里合适？

这个问题主要是通过检查我的 css 样式表与“juicyStudio CSS Analyzer”产生的，因为我大部分时间都使用 px，结果给了我一堆“注意：单位是绝对的”等。并显示了 Web Content Accessibility 的准则 3.4指南 1.0，建议使用相对测量。

现在我应该担心设置在某些浏览器/操作系统或其他东西中变得混乱吗？无论如何，我可以在之后进行测试，以确保我的布局在不同的分辨率、浏览器、操作系统等下始终保持同步？

谢谢你们的时间，我很感激。我知道这可能会给你们带来很多麻烦，希望不会太多..

照顾大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:55:14.047

“2em”的意思是“正常大小的两倍”，或继承的大小。“em”优于“px”的优势在于它与默认/继承值相关。

如果我将浏览器配置为用户 16px 默认大小，则 2em = 32px。如果你输入“20px”，无论用户的配置如何，它都是“20px”。

通常，最好只使用相对值，因为它看起来更适合用户的配置/平台。

您不应该真正指定“默认值”，这应该是浏览器分配的默认值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T00:54:43.937

当客户端的 dpi 与普通的不同时，大多数现代浏览器都会使用缩放来改变字体大小。

所以使用 px 是可以的，你可以利用 px 来做出更好的设计。

# python - 检查项目是否与正则表达式字符串匹配

> ID：10770825
> 
> 赞同：0
> 
> 时间：2012-05-27T00:39:09.467
> 
> 标签：python, regex, list

我正在使用这个脚本：

```
import re

message = 'oh, hey there'
matches = ['hi', 'hey', 'hello']

def process(message):
    for item in matches:
        search = re.match(item, message)

    if search == None:
        return False
    return True

print process(message) 
```

基本上，我的目标是检查 的任何部分`message`是否在 中的任何项目内`matches`，但是使用此脚本，它总是返回`False`（不匹配）。

有人可以指出我在这段代码中是否做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T00:40:46.073

使用[`search`](http://docs.python.org/library/re.html#re.search)而不是[`match`](http://docs.python.org/library/re.html#re.match). 作为一种优化，[`match`只开始查看字符串的开头，而不是其中的任何位置](http://docs.python.org/library/re.html#search-vs-match)。

此外，您只查看最后一次匹配尝试的结果。您应该检查循环内部并在任何匹配时尽早返回：

```
for item in matches:
    if re.search(item, message):
        return True
return False 
```

请注意，如果您只关心子字符串并且不需要匹配正则表达式，只需使用[运算](http://docs.python.org/reference/expressions.html#membership-test-details)[符`in`](http://docs.python.org/reference/expressions.html#membership-test-details)：

```
for item in matches:
    if item in message:
        return True
return False 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T00:44:23.463

正如 icktoofay 的回答所表明的那样，如果您想在字符串中的任何位置搜索，您应该使用`re.search()`而不是，但是对于这么简单的事情，您可以使用普通的子字符串测试：`re.match()`

```
message = 'oh, hey there'
matches = ['hi', 'hey', 'hello']

def process(message):
    return any(item in message for item in matches)

print process(message) 
```

# javascript - jquery if (css_attribute = value)

> ID：10770826
> 
> 赞同：15
> 
> 时间：2012-05-27T00:39:29.617
> 
> 标签：javascript, jquery, css

是否可以在 javascript/jquery 中执行 if 语句来确定：

**如果某个元素的css属性的值等于给定的值？**

如：

```
if( $('.box').css(background-color = blue) ){
    // do this...
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-27T00:45:13.807

JQuery 方法，当[`css`](http://api.jquery.com/css/)只给定一个参数时，将返回给定参数的值。你可以试试这个：

```
var color = $('.box').css('background-color');
if (color == 'rgb(0, 0, 255)' || color == 'blue') // =='blue' <- IE hack
    alert("it's blue!\nColor detected: " + color); 
```

上面的示例仅适用于 JQuery 选择器中的第一个元素，因此`.each`如果您有多个元素，则应使用 JQuery 方法遍历整个选择器。

请注意，`.css`JQuery 方法在大多数浏览器（IE 除外）中返回 RGB 组合，因此`blue`针对非 IE 浏览器的字符串测试它是不够的。您可以在[JQuery API 站点](http://api.jquery.com/css/)和[我的小提琴](http://jsfiddle.net/6nj3q/6/)中进行测试。

这是适当的`.each`迭代：

```
$('.box').each(function(i){
    var color = $(this).css('background-color');
    if (color == 'rgb(0, 0, 255)' || color == 'blue') // =='blue' <- IE hack
        alert("div " + i + " is blue!\nColor detected: " + color);
});​ 
```

***[JSFiddle](http://jsfiddle.net/6nj3q/6/)***

* * *

**编辑：**一年半后，我觉得这个答案值得更新。

对于大多数用例，我建议使用 CSS 类：

```
.blue {
    color: blue;
} 
```

这允许使用[`addClass()`](http://api.jquery.com/addClass/), [`removeClass()`](http://api.jquery.com/removeClass/),[`toggleClass()`](http://api.jquery.com/toggleClass/)方法进行操作以及[`hasClass()`](http://api.jquery.com/hasClass/)检查：

```
if ( $('#myElem').hasClass('blue') ) {
    //it has the .blue class!
} 
```

这可以在所有浏览器中无缝运行，无需 hack，而且您可以更好地分离关注点——也就是说，如果您的样式发生变化，例如`.blue { color: lightblue; }`，JS 将继续工作而无需修改。

注意：当然，这种方法不适合动态生成颜色值的几个罕见用例（例如，使用`Math.random()`或从画布像素中选择颜色值），在这些罕见用例中，您仍然可以使用第一个解决方案这个答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-27T00:44:13.897

你应该能够做这样的事情：

```
if ($('.box').css('background-color') === 'blue') 
{// do this...} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-24T02:17:51.350

检查空格

```
if($(this).css('color') == 'rgb(251, 176, 64)') 
```

“昏迷后的空间”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T00:51:16.507

```
boxes = $('.box');
for(var i = 0;i<boxes.length;i++) {
  if(boxes[i].style.backgroundColor =="blue") {
    //do stuff
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-07T16:19:02.880

以上似乎都没有在 2015 年在这里工作。对我来说，在 Chrome 的所有情况下，针对 :visited 颜色测试链接的颜色似乎都是正确的。此外，如果您不是“嗅探”并且真的想知道在他们访问您的网站期间是否点击了链接，我发现一个简单的：

```
$("a").addClass('visited'); 
```

并且检查班级工作得很好。

```
if ( $("a").hasClass('visited'); ){ console.log('do something honorable'); } 
```

# wordpress - Wordpress 中的动态电话号码

> ID：10770832
> 
> 赞同：0
> 
> 时间：2012-05-27T00:41:10.690
> 
> 标签：wordpress, wordpress-theming

我正在为 Wordpress 开发一个自定义主题，我想在标题中插入一个动态电话号码，可以在仪表板中更改。

除了小部件还有其他方法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T04:39:31.603

您应该尝试[制作选项页面](https://codex.wordpress.org/Creating_Options_Pages)

# python - 找不到使用经典映射在映射器上配置的绑定

> ID：10770840
> 
> 赞同：4
> 
> 时间：2012-05-27T00:42:25.723
> 
> 标签：python, sqlalchemy, python-2.7, bottle

我正在尝试从 mysql 加载用户对象，但我不断收到 UnboundExecutionError：无法找到在映射器 Mapper|UserDo|user、SQL 表达式或此会话上配置的绑定。我正在使用经典映射。

```
Base = declarative_base()

# A default constructor is created if one is not already present,
# which accepts keyword arguments of the same name as that of the mapped attributes.

class UserDo(Base):
    __tablename__ = 'user'

    id = Column(Integer, primary_key = True)
    fname = Column(String(100))
    lname = Column(String(100))
    email = Column(String(200))
    salt = Column(String(100))
    created_on = Column(TIMESTAMP) # from sqlalchemy.dialects.mysql import TIMESTAMP

class BaseService(object):

    def __init__(self):
        self._engine = create_engine('mysql://root@localhost/my_db', pool_recycle = 3600)
        self._Session = sessionmaker(bind = self._engine)
        self._session = Session()

class UserService(BaseService):

    def create(self, data):
        print self._session.query(UserDo).first() # Error 
```

我想知道我是否因为我的 create_engine 语句而收到错误。也许我没有为连接提供正确的格式。我没有本地数据库的密码。

另外，我注意到的其他事情： print self._session.query(UserDo)

打印 SELECT "user".id AS user_id, "user".fname AS user_fname, "user".lname AS user_lname, "user".email AS user_email, "user".salt AS user_salt, "user".created_on AS user_created_on FROM “用户”

这是一个语法错误。无论哪种方式，我都不关心 SQLAlchemy 在内部做什么，只要按照定义执行 User.fname、User.lname （等）。

有人看到发生了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T03:49:46.647

由于某种原因，当我这样做（创建实例变量）时，SQLAlchemy 0.8 不喜欢它：

```
class BaseService(object):

    def __init__(self):
        self._engine = create_engine('mysql://root@localhost/my_db', pool_recycle = 3600)
        self._Session = sessionmaker(bind = self._engine)
        self._session = Session() 
```

解决方法是使它们变为静态：

```
class BaseService(object):
    engine = create_engine('mysql://root@localhost/my_db', pool_recycle = 3600)
    Session = sessionmaker(bind = engine)
    session = Session() 
```

然后你可以这样做：

```
class UserService(BaseService):

    def create(self, data):
        BaseService.session.query(UserDo).first() 
```

# java - ObjectOutputStream 建议

> ID：10770844
> 
> 赞同：0
> 
> 时间：2012-05-27T00:43:29.563
> 
> 标签：java, objectoutputstream

我的程序的目标是让它在关闭时保存，并在打开时重新加载。

我有一个驱动程序（包含所有图形），我希望它创建和保存文件。我在互联网上看过很多教程，但他们没有解释的是如何在*实际*程序中正确实现这个系统。

我是否在我的主要方法中创建 OutputStrema？我是否需要检查是否已创建文件，如果未创建文件，是否需要从中读取？我如何完成这一切？我应该有一个用于退出的 WindowListener 以便它可以保存所有数据吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T01:52:50.327

> 我是否在我的主要方法中创建 OutputStrema？

最好在保存状态的位置创建流。

> 当我的程序运行时，它将使用其 ObjectInputStream 接收保存的数据文件。我是否将完成此操作的代码放在我的 Main 方法中？

听起来是个不错的选择。基本上，您需要在尝试执行需要该数据的操作之前执行此操作。任何可以实现这一点的东西都可以工作（尽管使用静态初始化是一个坏主意......）

> 我是否需要检查是否已创建文件，如果未创建文件，是否需要从中读取？

这个问题使*编写*状态文件和*阅读*它感到困惑。它们发生在生命周期的不同点，并使用不同的代码来完成任务。

在创建一个保存文件之前检查是否存在是没有意义的......除非您建议重命名现有的保存文件。

相反，如果在启动应用程序时保存文件不存在，则尝试打开它的构造函数将抛出`FileNotFoundException`. 只需捕获异常并跳过读取已保存状态的代码。

> ...如果还没有创建文件，这会导致错误吗？

是的。一个 FileNotFoundException；看上面。所以你的代码必须处理这个问题，或者在尝试打开之前测试文件是否存在；见`File.exists()`及相关方法。

> 我应该有一个用于退出的 WindowListener 以便它可以保存所有数据吗？

这听起来像是解决方案的一部分。（但是程序崩溃或被杀死的情况呢？你想在这些情况下保存状态......还是不？）

* * *

有几点需要注意：

*   许多与 GUI 相关的对象没有实现`Serializable`，因此无法使用`ObjectOutputStream`. 线程、流、套接字和其他一些东西也不能序列化。

*   当您使用 保存类`ObjectOutputStream`的实例、更改类或其名称，然后尝试使用 重新加载它们`ObjectInputStream`时，您可能会遇到保存的实例与类的新版本不匹配的问题。如果您*必须*能够读取该序列化状态，那么您就有麻烦了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T00:46:33.630

是的，WindowListener 听起来是个好主意。保存程序状态的一种方法是使用[Properties](http://docs.oracle.com/javase/tutorial/essential/environment/properties.html)。请查看上面链接的教程。我不确定为您的“图形”推荐什么。请告诉我们更多关于您在这里的意思的详细信息。

**编辑**

> 我是否在我的主要方法中创建 OutputStrema？

您在 main 方法中创建 OutputStream 的问题是询问我们一无所知的程序结构。我的直觉告诉我，我不会在 main 方法中创建类似的东西，即使 JFrame 是在那里创建的（或在从 main 调用的静态方法中）。OutputStream 将在实现 WindowListener 的类中创建，这可以是它自己的独立类。您想让 main 方法尽可能小。

> 我是否需要检查是否已创建文件，如果未创建文件，是否需要从中读取？

可能。这个问题围绕着您将如何处理创建后的存储信息。也许您会在程序启动时搜索并阅读它？我不知道，因为这完全取决于您的需求，您必须弄清楚。

> 我如何完成这一切？我应该有一个用于退出的 WindowListener 以便它可以保存所有数据吗？

如果这是一个 Swing 应用程序，那么是的，WindowListener 将帮助您控制应用程序的关闭。

# c++ - 查找数组中的元素和出现次数

> ID：10770854
> 
> 赞同：0
> 
> 时间：2012-05-27T00:46:01.887
> 
> 标签：c++, search

我需要帮助以升序查找排序列表中元素的出现次数。

我设置了以下代码，但在最后一行代码的“预期参数声明符”末尾出现错误。还说我没有以前的函数 binarySearch 原型。这甚至意味着什么？我查了一下，一开始就声明了 int binarySearch 但我没有运气。我真的不知道为什么这段代码没有运行，我花了过去两个小时调试。

```
#include <iostream>
#include <algorithm>
#include <vector>

using namespace std;  

//sort then search

int binarySearch(int arr[], int value, int left, int right) {
    while (left <= right) {
        int middle = (left + right) / 2;

        if (arr[middle] == value)
            return middle;
        else if (arr[middle] > value)
            right = middle - 1;
        else
            left = middle + 1;
    }

    return -1;

}

int main()  
{  
    int a[] = {12,3,4,4,4,5,6,7};

    int num;  

    num = sizeof(a)/sizeof(int);

    for(int i=0; i<num; i++)  
        cout<<a[i]<<" ";  
    cout<<endl;

    int value;

    cout<<"Enter a value you want to find in the array."<<endl;
    cin>>value;

    cout<<"The element is at "<<int binarySearch(int a[], value, 0, int num);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:53:44.560

这不是你调用函数的方式。您不能只复制函数定义行并替换一两个参数。将该行替换为：

```
cout<<"The element is at "<<binarySearch(a, value, 0, num); 
```

注意：这不会解决算法本身的任何问题，只是调用它的问题。

# bash - 关于在 rabbitmq 的 bash 脚本中使用 HOSTNAME

> ID：10770855
> 
> 赞同：3
> 
> 时间：2012-05-27T00:46:09.033
> 
> 标签：bash, erlang, rabbitmq

在“rabbitmq-env”的rabbitmq脚本文件中，有以下几行。

```
[ "x" = "x$HOSTNAME" ] && HOSTNAME=`env hostname`
NODENAME=rabbit@${HOSTNAME%%.*} 
```

第一行是什么意思？检查`$HOSTNAME`是否设置，如果没有设置，设置为`'env hostname'`？

它是第一行的编程模式，占据了另一个相关脚本文件的大部分`"rabbitmq-server"`。所以我想知道这条线的明确含义。

对于第二行， 的含义是`HOSTNAME%%.*`什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T01:03:45.777

此表达式检查是否`HOSTNAME`未设置：

```
[ "x" = "x$HOSTNAME" ] 
```

如果`HOSTNAME`未设置，这最终看起来像：

```
[ "x" = "x" ] 
```

哪个当然评估为`true`. 表达方式：

```
[ "x" = "x$HOSTNAME" ] && HOSTNAME=`env hostname` 
```

将设置`HOSTNAME`为`env hostname`if 之前的表达式`&&`is的输出`true`。调用与调用`env hostname`完全相同`hostname`，只是输出本地主机的名称。

第二种表达方式：

```
NODENAME=rabbit@${HOSTNAME%%.*} 
```

正在使用`bash`变量扩展来剥离除主机名的第一个组成部分之外的所有内容。给定`HOSTNAME="host.example.com"`，`${HOSTNAME%%.*}`回报`host`。您可以在`bash`手册页中阅读更多内容：

```
${parameter%%word}
  Remove matching suffix pattern.  The word is expanded to produce
  a pattern just as in pathname expansion.  If the pattern matches
  a trailing portion  of  the expanded value of parameter, then
  the result of the expansion is the expanded value of parameter
  with the shortest matching pattern (the ``%'' case) or the longest 
  matching pattern (the ``%%'' case) deleted. 
```

所以这设置`NODENAME`为`rabbit@host`，假设您的本地主机名是`host.example.com`。

# mysql - 众多WHERE条件mysql

> ID：10770856
> 
> 赞同：1
> 
> 时间：2012-05-27T00:46:24.060
> 
> 标签：mysql, join, where

我有以下代码可以执行我想要的操作。但是，我需要第二个条件，其中表项目中接受的列等于是。我不知道如何将它输入到我当前的连接中，因为用户表的位置。

```
$query_Name = "SELECT u.Student_Surname, u.Student_Forename, Project_Title, Project_id
FROM users u
INNER JOIN projects p2 ON u.id = p2.Project_Lecturer
INNER JOIN project_course pc ON p2.Project_id = pc.Proj_id
INNER JOIN courses c ON pc.Cour_id = c.Course_id
INNER JOIN users u2 ON c.Code = u2.Course
WHERE u2.Username = ".$_SESSION['MM_Username']." 
ORDER BY Project_id ASC" ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T00:51:49.240

```
WHERE u2.Username = ".$_SESSION['MM_Username']."  AND p2.Accepted = 'yes' 
```

或者你可以使用

```
INNER JOIN projects p2 ON u.id = p2.Project_Lecturer AND p2.Accepted = 'yes' 
```

第二种选择可能更快，但取决于其他事情

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T00:48:41.343

```
$query_Name = "SELECT u.Student_Surname, u.Student_Forename, Project_Title, Project_id  
 FROM users u
 INNER JOIN projects p2 ON u.id = p2.Project_Lecturer
 INNER JOIN project_course pc ON p2.Project_id = pc.Proj_id
 INNER JOIN courses c ON pc.Cour_id = c.Course_id
 INNER JOIN users u2 ON c.Code = u2.Course
 WHERE u2.Username = ".$_SESSION['MM_Username']." AND p2.Accepted = 'yes'
 ORDER BY Project_id ASC" ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T02:25:25.120

`AND`在 where 子句中添加运算符。

```
$query_Name = "SELECT u.Student_Surname, 
                      u.Student_Forename, 
                      Project_Title, 
                      Project_id  
               FROM users u INNER JOIN projects p2 
                       ON u.id = p2.Project_Lecturer
                    INNER JOIN project_course pc 
                       ON p2.Project_id = pc.Proj_id
                    INNER JOIN courses c 
                       ON pc.Cour_id = c.Course_id
                    INNER JOIN users u2 ON c.Code = u2.Course
               WHERE u2.Username = ".$_SESSION['MM_Username']." 
                     AND p2.Accepted = 'yes'
               ORDER BY Project_id ASC" ; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T01:05:22.240

WHERE 实际上适用于所有连接的表，因此您在 WHERE 子句中明确说明您正在使用哪些表，否则如果查询不明确，则查询将无法工作。

所以，你使用：

```
WHERE
u2.Username = ".$_SESSION['MM_Username']." -- this is for the u2 table
AND
p2.Accepted = 'yes' -- this is for p2 table 
```

您只需使用 AND 在此处添加更多逻辑。因此，整个查询将是：

```
$query_Name = "SELECT u.Student_Surname, u.Student_Forename, Project_Title, Project_id  
 FROM users u
 INNER JOIN projects p2 ON u.id = p2.Project_Lecturer
 INNER JOIN project_course pc ON p2.Project_id = pc.Proj_id
 INNER JOIN courses c ON pc.Cour_id = c.Course_id
 INNER JOIN users u2 ON c.Code = u2.Course
 WHERE u2.Username = ".$_SESSION['MM_Username']." AND p2.Accepted = 'yes'
 ORDER BY Project_id ASC" ; 
```

# php - 在 PHP 中 - sleep(); & 睡眠（）；不能正常工作。另外，循环登录有问题

> ID：10770859
> 
> 赞同：-1
> 
> 时间：2012-05-27T00:46:40.003
> 
> 标签：php, login, sleep, flush, usleep

我有2个问题。这是我的脚本......

```
<?php

   echo "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">";
echo "<html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"en\" xml:lang=\"en\">";
echo "<head>";
echo "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />";
echo "<link href=\"/library/skin/tool_base.css\" type=\"text/css\" rel=\"stylesheet\" media=\"all\" />";
echo "<link href=\"/library/skin/default/tool.css\" type=\"text/css\" rel=\"stylesheet\" media=\"all\" />";
echo "<meta http-equiv=\"Content-Style-Type\" content=\"text/css\" />";
echo "<title>Etudes</title>";
echo "<script type=\"text/javascript\" language=\"JavaScript\" src=\"/library/js/headscripts.js\"></script>";
echo "</head>";
echo "<body>";

echo "<script type=\"text/javascript\" language=\"JavaScript\">";
echo "focus_path = [\"eid\"];";
echo "</script>";

echo "<form id=\"form\" method=\"post\" target='_blank' action=\"www.xxxxx.com" enctype=\"application/x-www-form-urlencoded\">";
echo "<table border=\"0\" class=\"loginform\" summary=\"layout\">";         
echo "<label for=\"eid\">User id</label>";                                      
echo "<input name=\"eid\" id=\"eid\"  type=\"text\" value=\"USERNAME\"/>";                                      
echo "<label for=\"pw\">Password</label>";

$pass1 = "0";
$pass2 = "0";
$pass3 = "0";
$pass4 = "0";

set_time_limit(0);

for($i = 0; $i < 2; $i++)
{
$pass = $pass1.$pass2.$pass3.$pass4;

echo "$pass";

echo "<input name=\"pw\" id=\"pw\"  type=\"password\" value=\"$pass\"/>";

echo "<script language=\"Javascript\" type=\"text/javascript\">";

echo "document.forms[\"form\"].submit();";

echo "</script>";

   $pass4 = $pass4 + 1; 

if($pass4 == 10)
{
    $pass3 = $pass3 + 1;
    $pass4 = 0;
}
if($pass3 == 10)
{
    $pass2 = $pass2 + 1;
    $pass3 = 0;
}
if($pass2 == 10)
{   
    $pass1 = $pass1 + 1;
    $pass2 = 0;
}
if($pass1 == 10)
{
    echo "Fail";
    break;
}
  usleep(10000000);
  flush();
  ob_flush;
}

?>                      
</table>                        
</form>                 

</table>

</body>
</html> 
```

**///////////////////////////////////////// ///////////////**

问题1）我试过usleep（）和sleep（），一开始工作了几次，执行文件，然后延迟时间，然后执行，然后延迟，等等。但是在第三次之后它没有工作。

问题2）如果我在没有循环的情况下登录“www.xxx.com”，它工作得很好，但是当我把它放在一个循环中时，例如（假设密码是0002）：登录：用户名密码：0000

登录无效！

登录：用户名密码：0001

登录无效！

登录：用户名密码：0002

登录无效！

..仍然给我一个无效的登录！任何帮助将不胜感激:) 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T01:48:30.997

问题 1）我认为您正在达到最大执行时间，这是 PHP 对脚本施加的可配置限制。PHP 脚本通常不是长期存在的程序。它们应该快速执行，一个页面浏览，一个脚本，因此作为一种安全措施（防止拒绝服务攻击），寿命超过 60 秒的脚本会被简单地中止。检查您的 php.ini 以获取该配置值。

问题 2）您是否注释掉了脚本的“提交”部分并检查了输出？我认为您的程序只打印表单的开头一次，然后尝试打印其余的 9999 次。此外，它只会在第一次工作，因为如果您提交表单，浏览器将简单地离开您的页面（和您的脚本），并且无法提交第二次。

您应该使用[CURL](http://php.net/manual/es/book.curl.php)从外部站点获取响应。

# cordova - Phonegap Media.startRecord() 音频格式

> ID：10770860
> 
> 赞同：2
> 
> 时间：2012-05-27T00:47:05.253
> 
> 标签：cordova

Phonegap 的 Media.startRecord() 录音格式和采样率是多少？每个平台的格式不同吗？

```
mediaRec = new Media("test.mp3", onSuccess, onError);

mediaRec.startRecord(); 
```

当我尝试将文件从 MP3 转换为带有 lame 的 WAV 时，它给了我一个错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-25T06:23:27.607

在 android 平台 Media.startRecord() 以 MP3 格式录制音频。在 iOS 中，它以 WAV 格式录制，这是唯一的选择。如果您想以其他附加格式记录，例如 android 中的 AMR 使用

```
navigator.device.capture.captureAudio( 
CaptureCB captureSuccess, CaptureErrorCB captureError,  [CaptureAudioOptions options] 
```

);

参考：[http ://docs.phonegap.com/en/1.0.0/phonegap_media_capture_capture.md.html#capture.captureAudio](http://docs.phonegap.com/en/1.0.0/phonegap_media_capture_capture.md.html#capture.captureAudio)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T20:38:49.317

事实证明，编码取决于平台。所以在android上，编码是AMR。

参考：http: [//developer.android.com/guide/appendix/media-formats.html](http://developer.android.com/guide/appendix/media-formats.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-08T03:46:51.453

编码并不像 amr 那样简单（至少根据我的经验）。在我的 Droid Razr (4.1.2) 和我工作的三星 Galaxy Tab 2 (4.1.1) 上，格式是 amr。在我的同事 Droid Razr M (4.2.x) 上，格式是 qcelp。在另一台工作平板电脑 Asus ME301T (4.1.1) 上，在 AAC 中记录

参考：上周和phonegap打架（对不起，这是我最好的参考）

# c++ - 检查向量中是否存在元素

> ID：10770861
> 
> 赞同：0
> 
> 时间：2012-05-27T00:47:21.933
> 
> 标签：c++, vector, std

我有一个向量，它最多可以容纳 10 个对象。当我创建向量时，我相信它会创建它将持有的类的 10 个“空白”对象。因此我遇到了一个问题，因为我的代码依赖于检查向量元素是否为空，并且显然它永远不会为空。

如何检查向量对象是否包含我插入的元素，或初始化时的默认构造函数“空白”对象之一？

这个有技巧吗？

（我需要检查null，因为我正在编写递归算法和终止点，当递归函数返回时，向量中的对象为null）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T01:12:47.553

`std::vector`仅插入“真实”对象。它（至少通常）分配原始内存，并根据需要使用新位置在该内存中构造对象。它将包含的唯一对象将是您放置在那里的对象。

当然，如果您*愿意*，您可以创建一个向量，其中包含您传递给构造函数的对象的多个副本。同样，当你`resize`是一个向量时，你传递一个对象，如果你让它变大，它会复制到新的位置。

不过，这两者都不是真正的常态。在典型情况下，您只需创建一个`vector`，它将开始包含 0 个对象。您将使用`push_back`将对象添加到`vector`. 当您搜索 时`vector`，唯一的对象将是您与 一起放在那里的对象`push_back`，您无需担心它是否包含任何其他对象。

如果您只想检查是否`vector`为空，您可以使用：

```
if (your_vector.empty()) 
```

`true`...如果它是空的并且`false`它包含至少一个对象，它将（显然足够）返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T00:49:38.297

类的实例不能为空。只有一个指针。

但是，您确实拥有可以使用的 size() 。

```
typedef stdd::vector<SomeClass> vec;
//define some vec, v
for (vec::size_type i = 0, s = vec.size(); i < s; ++i) {
    //do something with v[i]
} 
```

使用递归函数，您可以通过传递最大索引来使用这个想法。

```
void recursiveFunc(vec& v, vec::size_type s); 
```

然后当检查你的条件递归时，你需要检查“我在向量的末尾吗？”

或者，您可以使用迭代器，而不是处理索引：

```
template <typename Iterator>
void recursiveFunc(Iterator begin, const Iterator& end); 
```

如果做得正确（如果可能的话），这可以使您的操作与了解存储在向量中的基础数据脱钩。

遍历向量的循环将如下所示：

```
while (begin != end) {
    //do something with *begin
    ++begin;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T00:51:30.697

正如@Corbin 提到的， size() 将返回向量中的元素数。保证中间没有任何孔（连续），所以你保证 vector[vector.size()] 是空的。

# php - Aptana Studio 3 终端中的 PHP CLI

> ID：10770862
> 
> 赞同：0
> 
> 时间：2012-05-27T00:47:33.257
> 
> 标签：php, ide, aptana

我认为 Aptana Studio 3 是一个很棒的 Web IDE（我将在其他时间检查带有插件的 Eclipse）。但是，我在终端中使用 Git，有时我还需要在命令提示符/终端（无论我在哪个操作系统上）中使用 PHP，我无法在 IDE 的终端中执行此操作。

有没有办法更改 Aptana 终端上的设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:01:52.247

我希望我能正确理解你的问题：

您可以在“首选项 -> Aptana Studio -> 终端”下更改设置。

例如，您可以将工作目录定义为“C:\Program Files (x86)\Git\bin”

# android - 使用 Android 的 AudioTrack

> ID：10770864
> 
> 赞同：1
> 
> 时间：2012-05-27T00:48:14.287
> 
> 标签：android, loops, record, playback, audiotrack

我编写了一个基本上是节拍垫的应用程序，屏幕上出现了一系列按钮，您可以按下每个按钮来发出不同的声音，我正在尝试实现另一个按钮来录制这些声音，然后在您按下另一个按钮时播放它们按钮，但即使有文档，我也无法弄清楚如何使用 AudioTrack 对象创建、初始化和录制。有什么帮助吗？

这是我初始化的尝试：

```
tracker = new AudioTrack(AudioManager.STREAM_MUSIC, 4410 , 4,2, AudioTrack.getMinBufferSize(samplerateinHz, channelconfig, audioformat),AudioTrack.MODE_STATIC); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T08:05:11.400

您必须使用 AudioRecord 的对象。AudioTrack 用于播放。

[http://developer.android.com/reference/android/media/AudioRecord.html](http://developer.android.com/reference/android/media/AudioRecord.html)

# android - Android 应用程序：启动时的帮助屏幕，除非用户将首选项设置为不。如何？

> ID：10770869
> 
> 赞同：0
> 
> 时间：2012-05-27T00:49:47.813
> 
> 标签：android, sharedpreferences, preferences, oncreate, launching

有些帖子涉及到这个问题，但我找不到真正直接接近或解决它的帖子。

当用户第一次进入应用程序时，我有一个主要活动，我想调用/创建一个帮助屏幕（它实际上是第二个活动）。

但是，对于熟悉该应用程序的用户，我想让他们选择在每次启动时不显示帮助屏幕。

因此，我在 SharedPreferences 文件中设置了首选项。所有代码都运行良好，包括 SharedPreferences 的东西（我可以通过查看我在设置屏幕中设置的复选框来检查这一点，我允许用户选择退出（或稍后进入）打开帮助屏幕。）

这是我在 onCreate() （覆盖）方法开头的代码：

```
spSettings = getSharedPreferences(strPrefsFilename, 0);
bHelpOnStart = spSettings.getBoolean(strHelpParamName, true); 
```

然后，我简单地使用：

```
if (bHelpOnStart)
{
    // Show help screen.
} 
```

问题是每次我从其他活动返回时，我的主要活动的 onCreate() 都会被调用！我希望我的测试是否仅在用户从“外部”进入应用程序时才会显示帮助屏幕，特别是从主页-> 应用程序页面。

在我刚才提到的意义上，只有当 Activity 来自“外部”时才调用 Activity 中的方法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T01:00:21.867

可能的解决方案：

在应用程序类中：

```
public static boolean firstStart = true; 
```

在活动类中：

```
onCreate(){
   boolean firstStart = ((MyApplication)getApplicationContext()).firstStart;
   if (bHelpOnStart && firstStart) { startHelp(); }

   ((MyApplication)getApplicationContext()).firstStart = false;
} 
```

请注意，这不是一种好的编码风格（单例更好），但您应该明白这一点。当然，如果您的应用程序停留在内存中并且用户从启动器再次打开它，它不会显示 firstStart；但至少当它从（您的应用程序的）一项活动返回到主要活动时，它不会再次显示帮助。没有简单的方法来确定谁开始您的活动。

# c++ - 如何限制通过 cin 输入的字符数？

> ID：10770870
> 
> 赞同：9
> 
> 时间：2012-05-27T00:49:59.097
> 
> 标签：c++

我希望限制用户可以输入的字符数，使用`cin`. 例如，我可能希望将其限制为两个字符。我该怎么做？

我的代码如下所示：

```
cin >> var; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-27T00:55:57.637

您可以使用`setw()`

```
 cin >> setw(2) >> var; 
```

[http://www.cplusplus.com/reference/iostream/manipulators/setw/](http://www.cplusplus.com/reference/iostream/manipulators/setw/)

> 设置用作下一次插入操作的字段宽度的字符数。

@chris 提供的工作示例：http: [//ideone.com/R35NN](http://ideone.com/R35NN)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T00:55:36.327

嗯，您可以将 'var' 设为字符数组并使用 while 循环读取输入，直到数组已满？

```
char var[somenumber + 1];
int count = 0;

while(count < somenumber){
  cin >> var[count];
  count++;
}

var [somenumber] = '\0'; 
```

# c# - 当文件确实存在时，System.IO.File 怎么会返回 false？

> ID：10770878
> 
> 赞同：1
> 
> 时间：2012-05-27T00:51:34.850
> 
> 标签：c#

我`System.IO.File.Exists`用来检查文件是否存在。但是，对于我知道存在的文件，它返回 false。代码如下：

```
Assert.IsTrue(System.IO.File.Exists(@"\ImportRepositoryTest\Version2.xml")); 
```

`System.IO.File`当文件确实存在时，为什么返回false？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T14:57:15.030

尝试

```
Assert.IsTrue(System.IO.File.Exists(Path.Combine(TestContext.TestDeploymentDir,  @"\ImportRepositoryTest\Version2.xml"))); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T00:59:43.733

将其更改为`Assert.IsTrue(System.IO.File.Exists(@".\ImportRepositoryTest\Version2.xml"));`（使用“.”）并仔细检查您是否将文件标记为“始终复制”。

# objective-c - 目标 C 的 shared_ptr / weak_ptr 实现

> ID：10770879
> 
> 赞同：-1
> 
> 时间：2012-05-27T00:51:35.050
> 
> 标签：objective-c, memory-management, raii, reference-counting

注意到当前 Objective-C 中引用计数的实现有多糟糕（请参见[此处](https://stackoverflow.com/q/156243/170521)和[此处](https://stackoverflow.com/q/3549649/170521)），我确信那里必须有一个库提供类似于 c++`shared_ptr`和`weak_ptr`语义的东西，而没有所有那些荒谬的额外调用，`retain`并且`release`应该自动调用当（指针）变量超出范围时

这在 ObjC 上可行吗？我知道 ObjC 没有析构函数，因此当变量超出范围时无法自动调用某些东西，但是这些`retain`/`release`调用怎么可能真的有必要呢？我会以错误的方式解决这个问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-27T01:01:30.100

> 注意到当前 Objective-C 中引用计数的实现有多糟糕......

我对此有异议。它的实施*并不*差。只是*你*对它不熟悉。 *我*认为这真的很简单，因为你只需要知道几条规则。所以不要因为你不熟悉就敲它。

> 这在 ObjC 上可行吗？

是的，这是可能的。它被称为 ARC（“自动引用计数”）。有关详细信息，请参阅“[过渡到 ARC 发行说明](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)”。

> 我知道 ObjC 没有析构函数

事实上，确实如此。这就是`-dealloc`方法。

> ...当变量超出范围时

关于 Objective-C 要理解的是*对象*不会超出范围，因为对象只能在堆上分配（<在此处插入关于非复制块的正常警告>）。指向这些对象（即变量）的指针可以进出范围，但对象本身始终在范围内，因为从技术上讲，堆在范围内被视为全局。（只是如果你丢失了一个对象的地址，几乎不可能再次找到它）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T01:01:47.290

这由 ARC 负责。除了 ARC，没有真正的好方法。在 C++ 中，您有堆栈对象，并且可以重载赋值 (=) 和遵从 (->)。共享指针都需要两者。Niether 可以在目标 C 中完成。

# javascript - 是否可以使用 Javascript 从 HTTP 数据包中检索提交的表单信息？

> ID：10770881
> 
> 赞同：-1
> 
> 时间：2012-05-27T00:52:30.210
> 
> 标签：javascript, html, forms

我正在尝试使用`method="post"`.
提交后，表单中的数据将通过 HTTP 数据包发布 - 因此它们不会使 URL 栏看起来凌乱。
问题是我不知道如何使用在客户端运行的简单 javascript 来检索数据。

或者，是否可以在用户点击提交后恢复 URL 地址栏？（因为 URL 看起来像：`form.html?area1=x&area2=y&...`这使得地址栏充满了字符。我希望让它看起来与用户提交表单之前的相同。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T01:01:58.850

不，在客户端 JavaScript 中不可能做到这一点；这就是服务器的用途。如果您只需要在同一个应用程序之间传递变量，请考虑使用哈希值不同的 URL 来启用链接；然后，您甚至不必更改页面，并且可以保留相同的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T00:58:24.950

你在客户端运行什么？除非您正在运行 node.js 或类似的东西，否则 javascript 只是客户端。

此外，POST 和 GET 有不同的含义，不仅仅是“它看起来有多好”。

您可能会发现[这篇文章](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)在这方面很有趣。

# bash - rabbitmq bash script -f -h 含义

> ID：10770887
> 
> 赞同：1
> 
> 时间：2012-05-27T00:55:05.577
> 
> 标签：bash, rabbitmq

在同一rabbitmq的“rabbitmq-env”脚本中，存在“-h”，“-f”，在以下几行中：

```
while [ -h "$SCRIPT_PATH" ] ; do

[ ! -f ${CONF_ENV_FILE} ] ; then 
```

这些符号的含义是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T00:59:07.887

`[`是`test`。来自`help test`：

```
 -f FILE        True if file exists and is a regular file.
   ...
  -h FILE        True if file is a symbolic link. 
```

# php - mysql 性能问题，在表上持续读/写

> ID：10770889
> 
> 赞同：0
> 
> 时间：2012-05-27T00:55:15.687
> 
> 标签：php, mysql

目前我有一个页面每天访问 500K 次，每次用户查看此页面时，

1）我写入name-A表，每天清理，最多保持700条记录；

2）我拉列出最后50条记录；

这是非常缓慢的。我必须优化表格或更改逻辑。我的问题是

1）可以对表进行什么样的优化？

2）如果不能做太多，那么我必须改变设计，对吧？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T01:14:55.497

1）在主键和您经常检索结果的任何其他字段上使用索引。

2) 在您经常写入的表上使用 InnoDB 可能会更好，因为它支持行级锁定（与 MyISAM 提供的表级锁定相反）。

3) 在您的应用程序逻辑中，如果可能，开始缓存查询结果。它将显着减轻数据库的压力。

# c# - 方法已明确定义，但 VS 抱怨它不是

> ID：10770890
> 
> 赞同：0
> 
> 时间：2012-05-27T00:55:20.493
> 
> 标签：c#

我在通常可实例化的类中有一个工厂方法。Intellisense 显示它是有效的（即，当我键入“Entity”时它会显示出来）并在构建之前显示正确的工具提示。但是，当我构建时，我收到此错误：

> “EvergreenEngine.Entity”不包含“加载”的定义

这里发生了什么？这是我的课。忽略该方法现在实际上并没有做任何事情。

```
// Represents an object in the game world
public class Entity
{
    // Snip other methods and stuff

    // Loads an entity from an XML file
    public static Entity Load(string filename) // Apparently undefined
    {
        Entity newEntity = new Entity();

        XmlTextReader reader = new XmlTextReader(filename);
        while(reader.Read())
        {
            Logger.Log(reader.Name);
        }

        return newEntity;
    }
} 
```

**解决了**

显然，我将它编译为 x86（我在 64 位机器上），而 VS 不喜欢这样。很奇怪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T01:05:41.113

显然，我将它编译为 x86（我在 64 位机器上），而 VS 不喜欢这样。很奇怪。

当我将它设置回混合平台时它起作用了。

# c - 如何编写使用#ifdef 的宏函数

> ID：10770892
> 
> 赞同：0
> 
> 时间：2012-05-27T00:55:53.830
> 
> 标签：c, gcc, macros

有可能写这样的东西吗？

```
#define ISWINDOWS() (#if defined(_WIN32) || defined(_WIN64) \
                        1 \
                   #elif  \
                        0 \
                  #endif) 
```

接着：

```
void foo() {
  if(ISWINDOWS()) {
   // ..
  } else {
   // ...  
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T00:58:14.660

您不能在宏中定义宏。你可以这样做，但它可能不是你想要的：

```
#if defined(_WIN32) || defined(_WIN64)
    #define ISWINDOWS() 1
#elif 
    #define ISWINDOWS() 0
#endif 
```

# php - PHP排序最近的坐标

> ID：10770893
> 
> 赞同：11
> 
> 时间：2012-05-27T00:55:55.763
> 
> 标签：php, mysql, sorting

我在包含经度和纬度的 PHP Web 服务中有一个 MySQL 表。我只想向用户发送 5 个最近的坐标。我编写了计算从坐标到用户在 POST 请求中发送的坐标的距离的方法，但我不确定如何对其进行排序，只发回一些。

这是距离方法：

```
function  distance($longToCompare,$latToCompare) {
    $dlong = $request_long - $longToCompare;
    $dlat = $request_lat - $latToCompare;
    $a = pow(sin($dlat/2)) + cos($latToCompare)*cos($request_lat)*pow(sin($dlong/2));
    $c = 2*atan2(sqrt($a),sqrt(1-$a));
    return 6373*$c; 
} 
```

并且用户当前获得了整个数据库（目前，虽然开发它很小，但将来它可能会相当大）

```
$q = mysql_query("SELECT * FROM Coordinates");
$coordinates = array ();
while ($e = mysql_fetch_assoc($q)) {
    $coordinates[] = $e;
}
print (json_encode($coordinates)); 
```

谁能指出我正确的方向？我对 PHP 比较陌生，我知道我可以使用 uasort 创建自定义排序，但我不太确定如何使用这个距离函数来使用它。

编辑：使用@Norse 的解决方案，当前查询是：

```
$request_long = $_POST['longitude'];
$request_lat = $_POST['latitude'];
    $km = 0.5;
        $query = "SELECT *, 
    ( 6373 * acos( cos( radians('$request_lat') ) * 
    cos( radians( latitude ) ) * 
    cos( radians( longitude ) - 
    radians('$request_long') ) + 
    sin( radians('$request_lat') ) * 
    sin( radians( latitude ) ) ) ) 
    AS distance FROM Coordinates HAVING distance < '$km' ORDER BY distance ASC LIMIT 0, 5";
        $coordinates = array ();
        while ($e = mysql_fetch_assoc($query)) {
            $coordinates[] = $e;
        }
        print (json_encode($coordinates)); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-27T01:28:35.420

使用谷歌的算法：

```
$lon = //your longitude
$lat = //your latitude
$miles = //your search radius

$query = "SELECT *, 
( 3959 * acos( cos( radians('$lat') ) * 
cos( radians( latitude ) ) * 
cos( radians( longitude ) - 
radians('$lon') ) + 
sin( radians('$lat') ) * 
sin( radians( latitude ) ) ) ) 
AS distance FROM yourtable HAVING distance < '$miles' ORDER BY distance ASC LIMIT 0, 5" 
```

`latitude``longitude`在此查询中将是您的纬度/经度列名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T01:23:25.663

我最近遇到了同样的问题。我决定写一个mysql函数来计算距离，然后在sql查询中使用它。mysql函数：

```
CREATE FUNCTION distance(lat1 float, lon1 float, lat2 float, lon2 float) 
RETURNS float
RETURN ACOS(SIN(RADIANS(lat1))*SIN(RADIANS(lat2))+COS(RADIANS(lat1))*COS(RADIANS(lat2))*COS(RADIANS(lon2-lon1)))*6371 
```

如果您的`Coordinates`表有 fe 列`latitude`，`longitude`那么代码可能如下所示：

```
$q = mysql_query("SELECT * FROM Coordinates ORDER BY 
     distance(latitude, longitude, $lat, $lon) LIMIT 5"; 
```

在哪里`$lat`并`$lon`包含提供的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T01:24:00.657

将排序嵌入到查询中会更有效。

这个精彩的教程将为您提供帮助（并提供满足您需求的查询）： [https ://developers.google.com/maps/articles/phpsqlsearch_v3#findnearsql](https://developers.google.com/maps/articles/phpsqlsearch_v3#findnearsql)

# mysql - django 中的复合查询——使用额外的、注释的还是原始的 sql？

> ID：10770896
> 
> 赞同：0
> 
> 时间：2012-05-27T00:56:36.250
> 
> 标签：mysql, sql, django

我需要执行以下查询：

```
open_positions = Jobs.objects.all()
open_positions_with_apply = open_positions.extra(`has_applied` = 
            JobApplication.objects.filter(profile=profile, job=job).exists() 
```

为了澄清我想要做的事情：

```
profile = UserProfile.objects.get(id=1)
new_query_set = []
for job in Jobs.objects.all():
    has_applied = JobApplication.objects.filter(job=job, profile=profile)
    new_query_set.append(job with its has_applied value) # in pseudocode, not sure how this would be done 
```

基本上给定一个配置文件（访问页面的用户）和一个工作查询集，我需要找到一个用户是否已申请的布尔值。我将如何使用 django 查询来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T01:18:42.340

`job_id`对于它的价值，我通过获取用户申请的工作的 values_list 来解决这个问题，并在模板中 -

```
{% for job in jobs %}
    {% if job.id not in jobs_user_has_applied_to %}
    <form>...
    {% else %}
    You've applied for this
{% endfor %} 
```

# iphone - NSNotification 未由 UINavigationController 中包含的子视图处理

> ID：10770898
> 
> 赞同：0
> 
> 时间：2012-05-27T00:56:58.883
> 
> 标签：iphone, objective-c, cocoa-touch, nsnotificationcenter

在我的 AppDelegate 中，我正在实例化 UINavigationController 并将我的“主”视图（我们称之为*MainViewController*）添加为导航控制器的根视图控制器。然后将导航控制器作为子视图添加到应用程序委托的窗口，并使窗口可见。IE，

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
   // viewController is a property of the app delegate
   viewController = [[MainViewController alloc] init];
   viewController.context = [self managedObjectContext];

   UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:viewController];

   [self.window addSubview:navController.view];
   [self.window makeKeyAndVisible];
   return YES;
} 
```

*MainViewController*为一些 NSNotification 添加观察者，这些 NSNotification 由视图控制器的子视图发布，以编程方式实例化并添加为*MainViewController*的子视图。所以，

*   *MainViewController*（在 UINavigationController 中）
    *   *子视图控制器*
        *   *发布通知的*子视图**

 *一旦我将 UINavigationController 添加到组合中，*MainViewController*将不再正确处理*SubView*发布的通知。如果我删除 UINavigationController 并简单地将*MainViewController*添加为 AppDelegate 窗口的子视图，则会正确处理通知。

*我尝试为SubView*发布的其中一个通知向 AppDelegate 添加观察者，它会正确处理它，并且在处理该通知时，*MainViewController*不为零。

任何指导将不胜感激。如果您需要任何澄清，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T02:07:37.480

好的，这里发生了几件事：

1.  `viewController`实际上不是我的应用程序委托的属性。使其成为属性会导致 NSNotification 再次被处理。
2.  处理完之后，由 NSNotification 触发的选择器中的代码无法正常工作——它应该将一个新视图推送到*MainViewController*的 navigationController 中，结果为 nil。在应用程序委托中为 UINavigationController 创建一个属性也解决了这个问题。*

# c - 如何仅打印字符串的第一部分

> ID：10770901
> 
> 赞同：1
> 
> 时间：2012-05-27T00:57:42.037
> 
> 标签：c, ip, printf, cut

我用 C 编写了一个小程序来从登录 SSH 会话的远程用户那里获取 IP

代码 ：

```
int main (){
    char * getIP ;
    getIP = getenv ("SSH_CLIENT");
    printf ("%s", getIP);
    printf("\n");
    return 0;
} 
```

它工作得很好，我有输出

```
shell# ./a.out 
```

192.168.1.33 39840 22

但我只想打印 IP 地址而不是字符串的其余部分。我不知道如何剪切字符串以仅打印第一部分（255.255.255.255）

我搜索一整天的解决方案但没有成功：/

谢谢你的帮助 ： ）

**更新 ！**

我发现您可以使用 REMOTEHOST 代替 SSH_CLIENT :)
但是 Larsks 解决方案非常有帮助，值得记住

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T01:09:34.120

您甚至不需`strtok()`要这样做，因为您只关心空格前的第一个字符串。使用`strchr()`定位第一个空格，将其设置为`NUL`，您就完成了：

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main (){
    char *getIP, *mark;
    int i;
    getIP = getenv ("SSH_CLIENT");

    // get the location of the first space character
    mark = strchr(getIP, ' ');

    // set it to 0 (ascii NUL)
    *mark = 0;
    printf ("%s\n", getIP);
    return 0;
} 
```

您实际上可以通过执行以下操作将其折叠一点：

```
*(strchr(getIP, ' ')) = 0; 
```

代替：

```
mark = strchr(getIP, ' ');
*mark = 0; 
```

但这不是很清楚，而且进行正确的错误检查会更难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T01:00:23.710

您可以拆分`getenv()`使用返回的字符串`strtok()`，将字符串拆分为空格。您获得的第一个令牌是 IP 地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T11:24:50.937

你**永远不**应该改变 getenv-result

```
int main() {

  char firstword[BUFSIZ], *getIP = getenv("SSH_CLIENT");
  if( getIP )
  {
    sscanf( getIP , "%*s", BUFSIZ-1, firstword );
    puts(firstword);
  }
    return 0;
} 
```

# node.js - 在 intelliJ 中创建一个 Node.js Express 项目

> ID：10770904
> 
> 赞同：2
> 
> 时间：2012-05-27T00:58:08.103
> 
> 标签：node.js, intellij-idea, express

我在 intelliJ 中安装了 nodejs 插件，但我找不到创建 Node.js Express 项目的方法，就像[可以使用 WebStorm 一样](http://blog.jetbrains.com/webide/2012/04/web-projects-templates/)。请参阅下面的 WebStorm 屏幕截图。 ![在此处输入图像描述](../Images/45739fa4977a37e4cd0e01cf625199e0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T01:21:34.850

此功能将在 IntelliJ IDEA **11.1.3**版本中提供。11.1.2 版本在此功能出现在 WebStorm 之前发布。

请参阅 IDEA YouTrack 项目中的[相关问题](http://youtrack.jetbrains.com/issue/IDEA-85027)。

# c# - 在单独的表单上添加图片描述

> ID：10770907
> 
> 赞同：0
> 
> 时间：2012-05-27T00:58:32.680
> 
> 标签：c#, vb.net, visual-studio-2010, visual-studio

我将图片框添加到`FlowLayout`面板和`ContextMenu`带有项目的条带（与图片框相关联）`'Add description'`。

当我右键单击 a`PictureBox`并选择`'Add description'`时，会弹出一个新表单，其中包含图片的大预览和一个用于编写描述的文本框。

如何在新表单关闭后保留用户在新表单上编写的文本，这样如果用户想要编辑描述，他就不必再次从头开始输入？

我想当用户再次单击同一张图片时，我必须将描述存储在某处并将其加载到表单中，但是我怎么知道他点击了哪张图片？

可能有一种更聪明的方法可以解决这个问题，但我现在想不出一个，所以我希望你们能帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T03:29:06.167

您应该能够使用`Tag`属性来保存图片描述信息。

至于确定`PictureBox`您可以使用`MouseEnter`事件的上下文。基本上定义一个类级`PictureBox`变量（`PictureBoxOnContext`）。

然后，您可以将`MouseEnter`事件处理程序添加到`PictureBox`实例并将其强制`sender`转换为 a`PictureBox`并将其分配给`PictureBoxOnContext`变量。

当您右键单击 时`PictureBox`，`MouseEnter`已经触发并且相关项`PictureBox`被选择到`PictureBoxOnContext`变量中。

然后在“添加描述”上下文菜单上单击您可以检查是否`PictureBoxOnContext != null`并将其传递给预览表单。

（剩下的你应该能够弄清楚；可能利用代表将信息传回给父表单）

```
private PictureBox PictureBoxOnContext;

private void AddPicture_Click(object sender, EventArgs e)
{
  PictureBox picBox = new PictureBox();   
  //Your code logic to add PictureBox to FlowLayout 

  picBox.MouseEnter += new EventHandler(PictueBox_MouseEnter);

}

void PictueBox_MouseEnter(object sender, EventArgs e)
{
   PictureBoxOnContext = (PictureBox)sender;
}

private void AddDescriptionToolStripMenuItem_Click(object sender, EventArgs e)
{
    if (PictureBoxOnContext != null)
    {
        //Pass this PictureBoxOnContext to your preview window/ your opearations

    PictureBoxOnContext = null;

    } 
} 
```

# c# - 属性/访问器的 XML 注释

> ID：10770912
> 
> 赞同：9
> 
> 时间：2012-05-27T00:59:22.423
> 
> 标签：c#, .net, xml-comments

是否可以为对象**浏览器（VS 2010）**中可见的**XML 注释**`set`和访问器添加？`get`

 **```
/// <summary>
/// Something about property.
/// </summary>

public bool IsSomething
{
    // get description

    get
    {
        return isSomething;
    }

    // set description

    set
    {
        // do some work
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-27T01:25:31.903

不，您不能直接在访问器上设置这些注释。然而，关于该属性的注释可能非常全面，当您开始键入它们时，您将获得 IntelliSense 建议。如果您有扩展评论，您可能希望将额外的内容放在评论的备注部分：

```
/// <summary>
///   Something about the property.
/// </summary>
/// <remarks>
/// Some extra remarks that won't show up in the property's IntelliSense later.
/// </remarks> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T01:23:12.137

不这么认为，至少不在那个位置。我只想在其他现有标签中添加信息，如下所示：

```
/// <summary>
/// Gets or sets the x.
/// </summary>
/// <value>
/// The x.
/// </value>
/// <returns> this saves the world</returns>
/// <remarks> when you set this the world ends</remarks> 
```**

# .net - NodeJs 用于在 .net 上的 Google 地图上列出标记

> ID：10770919
> 
> 赞同：0
> 
> 时间：2012-05-27T01:00:38.973
> 
> 标签：.net, node.js

我们有一个在 .net 上开发的项目，该项目的一部分是从数据库中读取数据并将它们显示为谷歌地图上的标记，但现在我们需要使用 NodeJs 来实现相同的功能，我们是使用 node 的新手，但也从我们在互联网上能够找到的内容来看，与 javascript、php 或 html 站点的相关性更高，与 .net 没有任何关系。如果有人至少可以指导我们，如何解决这个问题，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T16:27:37.157

从 npm 网站安装节点包管理器：

> [https://npmjs.org/](https://npmjs.org/)

并使用合适的页面，这是一个安装命令。

> npm install {包名}

更多详细信息：尝试此页面中的以下步骤：

> [https://npmjs.org/package/googlemaps](https://npmjs.org/package/googlemaps)

安装 npm（节点包管理器）

> 卷曲[http://npmjs.org/install.sh](http://npmjs.org/install.sh) | 嘘

安装谷歌地图

> npm 安装谷歌地图

# c# - 如何更改另一个类的标签？时间：2019-05-10 标签：c#windowsformsvisual studio

> ID：10770920
> 
> 赞同：0
> 
> 时间：2012-05-27T01:01:04.407
> 
> 标签：c#, forms, class, methods, label

我知道有很多线程在谈论这个并且相信我我已经看到了所有这些，但我认为我有点慢并且无法弄清楚如何做到这一点所以这就是事情！我有一个表格

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

    }

    private void button4_Click(object sender, EventArgs e)
    {
        adi mYadi= new adi();
        adi.paso(); 
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    public void l8u(string l )
    {
       label8.Text = l; 
    }
} 
```

该`l8u`方法应该更改中的文本`label8`，因此它不能是静态的，因为`label8`它不是静态的（是公共的）而且我有这个其他类

```
public class adi :instrucion
{
    private  int paso;
    private  int registroD;
    private  int registroO; 
    private  int valor;
    private  int vsin; 

    public adi()
    {
        paso = 1;
    }

    public  void setRD(int i){
        registroD = i; 
    }

    public  void setR0(int i)
    {
        registroO = i;
    }
    public void setV(int i)
    {
        valor = i;
    }

    public  int getRD()
    {
        return registroD ;
    }

    public  int getR0()
    {
        return registroO;
    }

    public int getVf()
    {
        return vsin;
    }

    public void paso(){
         //in this method I need change the value of label8
    }  
} 
```

方法 paso 是负责更改值的方法，`label8`但我就是做不到！我尝试了许多不同的方法，例如做类似的事情

```
public void paso()
{
    Form1.l8u();
} 
```

但这是不可能的，因为`Form1`只是类的名称而 l8u 不是静态方法，也尝试设置`label8`为公共静态但 Visual Studio 不喜欢这样，每当我使用 VS 形式的新控件时，将公共静态更改为只是公开。

希望你能帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T01:10:04.930

以这种方式更改标签不是一个好主意，并且违反了一些编程范式。通常，底层业务逻辑类不应该直接操作 UI。

该表单包含一个 adi 实例。因此，如果没有将表单的实例（即 . `this`）传递给`adi`构造函数（或 paso 方法），您就有点沉没了。

`Form1`最好使用 adi 在需要更改其显示时可以触发的某种事件。

[http://msdn.microsoft.com/en-us/library/aa645739(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa645739(v=vs.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-10T12:41:57.750

I know this is 2 years ago but couldnt you just do this

```
public static void function(label l)
  {
    l.Text = "Changed text"
  } 
```

and then in the Form do

```
private void timer_tick(object sender, EventArgs e)
{
    function(label);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-03T12:25:28.443

我也在寻找答案，但我终于找到了如何从另一个类中更改 form1 的标签。

通常 Form1.Designer.cs 看起来像这样：

```
 this.label6.AutoSize = true;
        this.label6.Location = new System.Drawing.Point(59, 174);
        this.label6.Name = "label6";
        this.label6.Size = new System.Drawing.Size(72, 13);
        this.label6.TabIndex = 16;
        this.label6.Text = "Output String:"; 
```

Form1.Designer.cs 应该如下所示，以便您可以在另一个类上调用它：

```
 label8 = new System.Windows.Forms.Label();

            label8.AutoSize = true;
        label8.Location = new System.Drawing.Point(219, 26);
        label8.Name = "label8";
        label8.Size = new System.Drawing.Size(35, 13);
        label8.TabIndex = 25;
        label8.Text = "label8";  

         // 
        // Form1
        // 
        this.Controls.Add(label8); 
```

一些“这个”。Form1.Designer.cs 中 label8 中“this.Controls.Add”部分除外的文本

你应该像这样从另一个类中调用它：

```
WindowsFormsApplication999.Form1.label8.Text = "your text here."; //This should modify label8.Text. 
```

编辑：

您还应该在 Form1.Designer.cs 中修改它

```
 private System.Windows.Forms.Label label8; 
```

进入这个：

```
 public static System.Windows.Forms.Label label8; 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-27T01:29:13.680

只需将标签的修饰符属性更改为内部或公共，然后调用您的表单并直接更改标签文本。

IE

```
Form2 frm = new Form2(); // Form 2 contains label8 and calling in a method (i.e.buttonclick) of form1

if (List<WhoLovesMe>.Count > 0)
{
   frm.Label8.Text = "Someone Loves Me :)";
}
else
{
   frm.Label8.Text = "Noone Loves Me :(";
} 
```

# ruby-on-rails-3 - AWS::S3.url_for 方法很少创建无效的 url

> ID：10770925
> 
> 赞同：1
> 
> 时间：2012-05-27T01:02:39.103
> 
> 标签：ruby-on-rails-3, rubygems, amazon-s3

我使用“AWS::S3.url_for”方法获取对 S3 对象的访问 url。我成功获取访问 url 并成功从 S3 获取 obj。

但是，我很少无法通过“AWS::S3.url_for”方法获得的访问 url 从 S3 获取 obj。S3 返回 403 错误。

（我再次尝试使用“AWS::S3.url_for”方法获取同一 obj 的访问 url，我成功从 S3 获取 obj ..）

有谁知道为什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:00:14.747

默认情况下，来自的 URL`AWS::S3::S3Object#url_for`会在一小时后过期。指定一个`:expires`参数来更改此行为。

[http://docs.aws.amazon.com/AWSRubySDK/latest/AWS/S3/S3Object.html#url_for-instance_method](http://docs.aws.amazon.com/AWSRubySDK/latest/AWS/S3/S3Object.html#url_for-instance_method)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-08T07:21:24.203

根据您执行的获取对象数量并保持“挂起”，您可能会达到“打开连接”的限制。

# database-design - 为什么数据字典中不能显示多对多关系？

> ID：10770926
> 
> 赞同：0
> 
> 时间：2012-05-27T01:03:07.123
> 
> 标签：database-design

我已经阅读并看到可以通过添加另一个表来显示 ER 图中的多对多关系，该表包括两个表的主键作为引用键。这里`payment_party_id`是表的主键，是`payment_party`表`receipt_party_id`的主键`receipt_party`。这背后的逻辑原因是什么：

```
 field                  key
  ---------------------  -----------------------       
  payment_party_id       reference key
  receipt_party_id       reference key 
```

谁能解释为什么这个附加表只添加了参考键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T10:59:23.210

多对多关系可以直接显示在***逻辑*实体关系图**上。一些建模工具不描述逻辑 ERD。它们仅描述***物理*ERD**。**在物理 ERD 中，使用交集表**实现多对多关系。

任何交集表都需要一个外键（OP：“引用键”）到作为关系一部分的每个表。如果交集表实现了简单的多对多关系，那么两个外键的组合也形成了交集表的**复合主键**。

换句话说，问题中的示例实际上如下所示：

```
field                  key
---------------------  -------------------------------------
payment_party_id       primary key, foreign (reference) key
receipt_party_id       primary key, foreign (reference) key 
```

# ruby-on-rails - Rails - 无法将符号转换为整数

> ID：10770927
> 
> 赞同：0
> 
> 时间：2012-05-27T01:03:20.787
> 
> 标签：ruby-on-rails, ruby

我有一个哈希如下：

```
display_helpers => { :helper_1 => { :helper => lambda { d.is_master_account? }, :text => "Master Account" } } 
```

我还有一个包含内容的数组：

```
a => [ :helper_1, :other_symbol ] 
```

我正在尝试从哈希中打印 :text 的值，如下所示：

```
<%= display_helpers[ a[0] [ :text ] ] %> 
```

执行此操作时，我不断收到错误“无法将符号转换为整数”。

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T01:11:01.420

看到这个有点晕，不过我觉得应该是这样的：

```
<%= display_helpers[ a[0] ] [ :text ]  %> 
```

# windows - 在 Win7 登录屏幕上运行应用程序

> ID：10770929
> 
> 赞同：3
> 
> 时间：2012-05-27T01:04:02.833
> 
> 标签：windows, api, winapi, authentication, createprocessasuser

我想通过服务在 Windows 7 的登录屏幕上运行应用程序。

我已经对此进行了长期研究并尝试了不同的方法，但不幸的是到目前为止还没有完全成功。我设法在当前登录用户的锁定屏幕上运行该应用程序 - 起初我认为这是我基本上试图实现的目标。但是，我随后意识到每个用户和一般用户（独立于用户）都有不同的登录屏幕。

我的猜测是，这个用户独立登录屏幕（当多个帐户可用或单击锁定屏幕上的“切换用户”时直接在启动后出现）在会话 0 中运行，而用户 1 在会话 1 中运行，用户 2 在会话中运行2 以此类推。问题是，如果我在会话 0 中运行应用程序（使用“winsta0\winlogon”），它是不可见的；在会话 1 中运行可以正常工作，但没有多大帮助，因为用户必须已经为此登录。

那么如何在独立于用户的登录/欢迎屏幕上运行应用程序呢？为此目的，正确的参数和功能是什么？有人有演示的工作示例吗？（Delphi 是首选，但实际上任何其他语言也可以！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T02:48:52.747

根据 RRUZ 的评论，唯一受支持的方法是实现凭证提供程序。

如果您不介意违反规则，作为本地系统运行的服务应该能够在您选择的会话中启动子进程。用于[`OpenProcessToken`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379295%28v=vs.85%29.aspx)获取您的安全令牌的句柄，使用 复制它[`DuplicateTokenEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446617%28v=vs.85%29.aspx)，用于[`SetTokenInformation`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379591%28v=vs.85%29.aspx)更改令牌会话标识符，然后调用[`CreateProcessAsUser`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682429%28v=vs.85%29.aspx)以启动子进程。（最初，使用单独的可执行文件是最简单的，但是一旦你消除了错误，你可以将服务和子进程滚动到一个可执行文件中，例如通过使用命令行参数或环境变量来区分两种情况。）

该[`WTSGetActiveConsoleSessionId`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383835%28v=vs.85%29.aspx)功能将告诉您当前连接到物理控制台的会话。

# php - 以相反的顺序在 PHP 中使用 ksort 获取 SQL 日期时间格式

> ID：10770930
> 
> 赞同：0
> 
> 时间：2012-05-27T01:04:08.557
> 
> 标签：php, sql, date, ksort

是否可以使用`ksort`SQL 日期时间格式按最大（即最近）日期排序？我有一个当前是键值的数组，其中键是 SQL 日期时间格式，值是字符串。当我对它执行 a`ksort`时，它首先返回最近的（我猜是“最小的”），我想要相反的结果。是否有一个我不知道的标志可以设置这个或另一个可以做得更好的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T03:35:46.360

如果您只想要 的相反顺序`ksort`，请使用[`krsort`](http://www.php.net/krsort)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T04:00:25.960

如果数据来自 SQL，为什么不让 DBMS 将日期数据排序为正确的顺序？

# matlab - MATLAB 的“fminsearch”与 Octave 的“fmincg”不同

> ID：10770934
> 
> 赞同：5
> 
> 时间：2012-05-27T01:04:30.487
> 
> 标签：matlab, octave, mathematical-optimization

我试图在 MATLAB 和 Octave 中的两个函数之间为一个简单的优化问题获得一致的答案。这是我的代码：

```
 options = optimset('MaxIter', 500 , 'Display', 'iter', 'MaxFunEvals', 1000);

  objFunc = @(t) lrCostFunction(t,X,y);

  [result1] = fminsearch(objFunc, theta, options);
  [result2]=  fmincg (objFunc, theta, options); 
```

（请记住，X、y 和 theta 是前面定义的并且是正确的）。问题如下：当我使用 fmincg 在 MATLAB 中运行上面的代码时，（推荐 fminsearch），我得到了正确的答案。

但是，如果我注释掉 fmincg 并让我们运行 fminsearch，我将不会得到任何转换。实际上输出看起来像这样：

```
 491          893         0.692991         reflect
   492          894         0.692991         reflect
   493          895         0.692991         reflect
   494          896         0.692991         reflect
   495          897         0.692991         reflect
   496          898         0.692991         reflect
   497          899         0.692991         reflect
   498          900         0.692991         reflect
   499          901         0.692991         reflect
   500          902         0.692991         reflect

Exiting: Maximum number of iterations has been exceeded
         - increase MaxIter option.
         Current function value: 0.692991 
```

增加迭代次数不会做千斤顶。相反，当使用 fmincg 时，我看到它会收敛，它最终给了我正确的结果：

```
Iteration     1 | Cost: 2.802128e-001
Iteration     2 | Cost: 9.454389e-002
Iteration     3 | Cost: 5.704641e-002
Iteration     4 | Cost: 4.688190e-002
Iteration     5 | Cost: 3.759021e-002
Iteration     6 | Cost: 3.522008e-002
Iteration     7 | Cost: 3.234531e-002
Iteration     8 | Cost: 3.145034e-002
Iteration     9 | Cost: 3.008919e-002
Iteration    10 | Cost: 2.994639e-002
Iteration    11 | Cost: 2.678528e-002
Iteration    12 | Cost: 2.660323e-002
Iteration    13 | Cost: 2.493301e-002

.
.
.

Iteration   493 | Cost: 1.311466e-002
Iteration   494 | Cost: 1.311466e-002
Iteration   495 | Cost: 1.311466e-002
Iteration   496 | Cost: 1.311466e-002
Iteration   497 | Cost: 1.311466e-002
Iteration   498 | Cost: 1.311466e-002
Iteration   499 | Cost: 1.311466e-002
Iteration   500 | Cost: 1.311466e-002 
```

这给出了正确的答案。

那么给了什么？为什么 fminsearch 在这种最小化情况下不起作用？

附加上下文：

1) Octave 是具有 fmincg 顺便说一句的语言，但是快速的谷歌结果也检索到这个函数。我的 MATLAB 也可以调用。

2）我的问题有一个凸误差面，它的误差面处处可微。

3）我只能访问 fminsearch，fminbnd（我不能使用它，因为这个问题是多变量的而不是单变量的），所以离开 fminsearch。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T01:10:35.343

我假设 fmincg 正在实现共轭梯度类型优化。fminsearch 是一种无导数优化方法。那么，您为什么期望他们给出相同的结果。它们是完全不同的算法。

我希望 fminsearch 能够找到凸成本函数的全局最小值。至少，到目前为止，这是我的经验。

fminsearch 输出的第一行表明 objFunc(theta) 约为 0.69，但该值与 fmincg 输出中的成本值有很大不同。所以，我会在 fminsearch 之外寻找可能的错误。确保为两种算法提供相同的成本函数和初始点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T02:24:18.703

这是我有时会注意到这个算法的问题。这可能不是您正在寻找的答案，但在这些情况下，似乎对我有用的是修改它终止的公差值。我看到的是两点之间的振荡，提供了相同的结果。我知道这发生在 LabView 中，只能推测它发生在 Matlab 中。

除非我看到你的数据，否则我无法发表更多评论，但这就是我的建议。

注意：通过增加容差，目标是在算法达到该状态之前捕获它。它变得不那么精确，但通常有效数字的数量还是相当少的。

# python - 在 Python 与 C 中打印空字符（“\x00”）

> ID：10770940
> 
> 赞同：3
> 
> 时间：2012-05-27T01:07:21.750
> 
> 标签：python, c, null, string-formatting

当我编码并运行语句时：

```
 print "\x00\x00\x00" 
```

在 Python 中，它输出三个空格，后跟一个换行符。但是在 C 中，当我编写代码并运行语句时：

```
 char hex[] = "\x00\x00\x00";
   printf("%s\n", hex); 
```

它像我想的那样解释 NULL 字节：它什么都不做。那么为什么在 Python 中将 NULL 字节视为空格？...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-27T01:10:01.120

> 那么为什么在 Python 中将 NULL 字节视为空格呢？

它不是。您的终端/控制台将它们视为空间。C 恰好在第一个 NUL 处停止，而 Python 输出它们。尝试将三个 NUL 写入标准输出。

# c++ - C++：将迭代器传递给函数的语法？

> ID：10770946
> 
> 赞同：4
> 
> 时间：2012-05-27T01:08:39.487
> 
> 标签：c++, iterator

我正在创建一个类，它是一种容器，我想创建一个构造函数，它可以采用“第一个”和“最后一个”迭代器，如 std::vector 和其他标准容器。什么是正确的语法？（我想要一个模板，一个可以采用任何可用的第一个/最后一个迭代器类型的函数（就像我认为的标准库）。非常感谢！

例如，我想要这样的东西：

```
template<class ...> MyClass(... first, ... last) 
```

但是……是什么？

非常感谢你。

关于第一个答案：我想要一个将迭代器作为参数的特定构造函数（因为我已经有将值和指针作为参数的构造函数）

编辑：这样可以吗？

```
template<class T1, class T2> MyClass(std::iterator<T1, T2> first, std::iterator<T1, T2> last) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T01:10:13.793

`...`可以是任何你想要的，它只是一个占位符名称，用于任何类型。我认为你需要读[一本好书](https://stackoverflow.com/q/388242/500104)。

```
template<class Iter> MyClass(Iter first, Iter last) 
```

`Iter`如果类型应表示迭代器，则为通用名称。另一种选择可能是`InIt`指示迭代器不应是输出迭代器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T01:44:11.160

我认为你可以利用`std::iterator`有一个名为的成员这一事实来做你想做的事`iterator_category`。将其与[SFINAE](http://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error)结合，您将得到如下内容：

```
#include <iostream>
#include <vector>

template <class X>
class my_class {
public:
    my_class(X a, X b) {
        std::cout << "in my_class(X,X)" << std::endl;
    }

    template <class Iter>
    my_class(Iter a, Iter b, typename Iter::iterator_category *p=0) {
        std::cout << "in my_class(Iter,Iter)" << std::endl;
    }
};

int
main()
{
    char buf[] = "foo";
    std::vector<char> v;

    my_class<int> one(1, 2);
    my_class<char*> two(&buf[0], &buf[3]);
    my_class<char> three(v.begin(), v.end());

    return 0;
} 
```

这打印：

```
in my_class(X,X)
in my_class(X,X)
in my_class(Iter,Iter) 
```

# java - 为什么摆动窗口的背景在 Mac 上发生变化而不在 Windows 上发生变化？

> ID：10770947
> 
> 赞同：1
> 
> 时间：2012-05-27T01:08:54.573
> 
> 标签：java, windows, macos, swing, awt

我有一个在 MacBook 上开发的全屏 JFrame，效果很好。背景能够改变颜色和东西。现在我把它移到我的 Windows 盒子里，背景是白色的，当我告诉它时它似乎不想改变。为什么会这样？

这是设置我的窗口的代码（简而言之）：

```
JFrame frame;
DisplayMode dm;
frame = new JFrame();
frame.setBackground(new Color(0.3F, 0.3F, 0.3F));
dm = new DisplayMode(Main.width, Main.height, 32, DisplayMode.REFRESH_RATE_UNKNOWN);
screen = new ScreenManager();
screen.setFullScreen(dm, frame); 
```

这是设置 JFrames 全屏的代码。

```
import java.awt.DisplayMode;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.Window;

import javax.swing.JFrame;

public class ScreenManager
{
    public static GraphicsDevice vc;

    public ScreenManager()
    {
        GraphicsEnvironment env = GraphicsEnvironment.getLocalGraphicsEnvironment();
        vc = env.getDefaultScreenDevice();
    }

    public void setFullScreen(DisplayMode dm, JFrame window)
    {
        window.setUndecorated(true);
        window.setResizable(false);
        vc.setFullScreenWindow(window);
        if (dm != null && vc.isDisplayChangeSupported())
        {
            try
            {
                vc.setDisplayMode(dm);
            }
            catch (IllegalArgumentException e)
            {
                //No need to do anything.
            }
            catch (Exception e)
            {
                e.printStackTrace();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T01:31:44.753

我唯一能想到的是 JFrame 被设置为一种颜色——这不会做任何事情。

试试这个

```
JFrame frame = new JFrame();
frame.getContentPane().setBackground(new Color(0.3F, 0.3F, 0.3F)); 
```

您将设置窗格本身的颜色，而不仅仅是框架。

# eclipse - Scala错误定义对象

> ID：10770952
> 
> 赞同：1
> 
> 时间：2012-05-27T01:09:59.917
> 
> 标签：eclipse, scala, eof, scala-ide

我一直在尝试使用 Scala 插件在 Eclipse 上运行 Scala hello world 示例。编写以下内容：

```
package scala_test

object Test {
  def main(args: Array[String]) {
    println("Hello, World") 
  }  
} 
```

产生以下错误：

```
<console>:1: error: eof expected but '}' found.
       }
       ^ 
```

我在 Windows 机器和 Mac 上都试过这个（都使用 Eclipse 3.7）。我已经尝试注释掉函数定义（只为 Test 对象留下一个空主体），但错误仍然存​​在。关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-18T13:28:58.533

您需要在控制台中查看输出，而不是在 scala 解释器中。只需右键单击 scala 文件并选择“作为 scala 应用程序运行”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T04:41:42.727

确保您已将 Scala 特性添加到项目中。在某些版本的插件上，如果 Scala 透视图处于活动状态，则该选项仅在上下文“配置”菜单中可用。如果您进行了此更改，您的项目图标的角落应该有一个“S”而不是“J”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T01:26:29.623

确保它在正确的包装中，为我运行。我正在使用这个插件

[http://scala-ide.org/](http://scala-ide.org/)

# python - 有没有一种简单的方法可以更改 Django 表单的日期时间输入字段的格式？

> ID：10770956
> 
> 赞同：1
> 
> 时间：2012-05-27T01:10:10.297
> 
> 标签：python, django, django-forms, django-templates, django-template-filters

我知道在一个名为[`date`](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#date).

我想修改 a 的日期格式`DateTimeInput`，但如果不实际手动写出整个 HTML，我就无法弄清楚。所以目前我做这样的事情：

```
<input id="{{ field.id_for_label }}" type="text" name="{{ field.name }}" value="{{ field.value|date:"F j, Y, g:i a" }}"
    class="round datetimepicker {% if field.errors %}error-input{% endif %}"
/> 
```

注意我是如何使用`value="{{ field.value|date:"F j, Y, g:i a" }}"`的（那些双引号实际上是有效的）。

有没有更简单的方法来做到这一点？最好我想保持它与我的其他输入字段相同的格式：

```
{{ field|add_class:"round datetimepicker"|add_error_class:"error-input" }} 
```

来自[Django 小部件调整应用程序](http://pypi.python.org/pypi/django-widget-tweaks)的位置`add_class`和位置。`add_error_class`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T02:16:12.933

我检查了文档。[DateTimeInput 小部件](https://docs.djangoproject.com/en/dev/ref/forms/widgets/#datetimeinput) 采用一个可选参数作为其初始值的格式。
希望有帮助

# java - RXTX 问题 - 接收到的字节数错误

> ID：10770962
> 
> 赞同：0
> 
> 时间：2012-05-27T01:11:15.413
> 
> 标签：java, serial-port, inputstream, rxtx, bufferedinputstream

我在从微控制器检索数据时遇到了一些困难。我正在以正好 2000 字节的块传输数据，并编写了一个线程来处理这 2000 字节，然后再进行新的调用以发送下一个 2k 字节。在大多数情况下，它工作得很好，但有时我倾向于得到一个字节太多，或者由于某种原因一个字节太少，这仅在**case #2**期间。如果我使用**案例#1**，它总是完美无缺，但由于某种原因它非常慢。我们在 10 秒内谈论了大约 2000 个字节，当我将串行端口设置为以 115.200 波特工作时，这太慢了。

案例#1（总是有效，但速度很慢）

```
public void serialEvent(SerialPortEvent event)
{
    switch (event.getEventType())
    {
        case SerialPortEvent.BI:
        case SerialPortEvent.OE:
        case SerialPortEvent.FE:
        case SerialPortEvent.PE:
        case SerialPortEvent.CD:
        case SerialPortEvent.CTS:
        case SerialPortEvent.DSR:
        case SerialPortEvent.RI:
        case SerialPortEvent.OUTPUT_BUFFER_EMPTY:
            break;
        case SerialPortEvent.DATA_AVAILABLE:

            try
            {
                byte singleData = (byte) buffer.read();
                gasArray.setMessage(singleData);
                    if (gasArray.isBusy())
                    {
                        gasArray.setProcessing();
                        while (gasArray.isProcessing())
                        {
                            continue;
                        }
                    }
                    else
                        gasArray.appendChat("Incoming data: " + singleData);
                }
        } 
```

案例 #2（有时会卡住，但非常快）

```
public void serialEvent(SerialPortEvent event)
{

    switch (event.getEventType())
    {
        case SerialPortEvent.BI:
        case SerialPortEvent.OE:
        case SerialPortEvent.FE:
        case SerialPortEvent.PE:
        case SerialPortEvent.CD:
        case SerialPortEvent.CTS:
        case SerialPortEvent.DSR:
        case SerialPortEvent.RI:
        case SerialPortEvent.OUTPUT_BUFFER_EMPTY:
            break;
        case SerialPortEvent.DATA_AVAILABLE:

            try
            {
                while (buffer.available() > 0)
                {
                    byte singleData = (byte) buffer.read();
                    gasArray.setMessage(singleData);
                    if (gasArray.isBusy())
                    {
                        gasArray.setProcessing();
                        while (gasArray.isProcessing())
                        {
                            continue;
                        }
                    }
                    else
                        gasArray.appendChat("Incoming data: " + singleData);
                }
        } 
```

还有另一个工作线程处理传入的数据并执行一些操作，这不是同步问题或类似问题。它归结为要么得到一个太多字节，要么得到一个字节到几个字节，这导致我的计算字节数的线程卡住了，期待多一个字节。我使用 RealTerm（一个串行控制台程序）来检索相同的东西，而且它每次都能快速准确地完成它。**在添加 BufferedInputStream 时，情况 #2**的情况似乎更好一些，但问题仍然偶尔发生。

我的问题是：available() 方法真的不可靠会导致这些问题吗？或者这是串行通信或 RXTX 库的问题？有没有更好的方法来处理这个？检索 2000 个字节，处理它们，然后再请求 2000 个字节。#1 案例在串行端口上接收数据是否应该这么慢？

任何带有示例的想法都会有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T01:38:58.737

在案例 1 中，您应该读入一个字节*数组*并处理您获得的所有数据。

在 99% 的情况下，available() 方法并没有多大用处，当然在从已经告诉您数据已准备好的输入设备读取数据时也不会使用。

# linux - Eclipse makefile 构建速度很慢......什么给了？

> ID：10770965
> 
> 赞同：4
> 
> 时间：2012-05-27T01:12:33.563
> 
> 标签：linux, eclipse, performance, makefile, eclipse-cdt

我们是 Eclipse 的狂热粉丝——太棒了！但是我们有大约 40 个 c++ 项目（并且还在增长），并且构建所有这些项目，当所有项目都是最新的时，大约需要半分钟（总共）。如果我要简单地创建一个在所有 40 个项目上执行“make all”的 bash 脚本，它将在不到一秒的时间内执行。

Eclipse 似乎每次都想通过执行以下命令来测试合适的工具：

```
g++ -E -P -v -dD /myfolder/.metada/.plugins/org.eclipse.cdt.make.core/specs.cpp 
```

其中 specs.cpp 是一个空文件。此步骤似乎占用了大部分构建时间。

任何人的任何见解？有什么方法可以告诉 Eclipse 信任这些工具吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T01:35:53.360

我建议您尝试使用项目属性的[C/C++ Build Discovery 选项](http://help.eclipse.org/indigo/topic/org.eclipse.cdt.doc.user/reference/cdt_u_prop_build_discovery.htm)页面。我会尝试的第一件事是关闭“**启用生成扫描仪信息命令**”选项。

![发现选项](../Images/2805d687974513f4f6840a73e888d7b2.png)

# javascript - Javascript动态更改另一个页面，我正在尝试做的事情可能吗？

> ID：10770968
> 
> 赞同：3
> 
> 时间：2012-05-27T01:13:05.630
> 
> 标签：javascript, html, dom, xhtml

我想知道当用户单击第一页的链接时，是否可以更改尚未打开的另一个页面。这很难解释，但我将尝试通过下面的示例向您展示我的意思。

实际站点的 html 更复杂，但这里有一个简化的版本：

**指数：**

```
<head>
<script type="text/javascript" src="external.js"></script>
</head>

<body>
<div id="container">
    <div class="img">
   <a href="PRODUCTPAGE.html">
   <img src="product.jpg"/> </a>
</div>

<div class="img">
   <a href="PRODUCTPAGE.html">
   <img src="product2.jpg"/></a>        
</div>
</body> 
```

**产品页面：**

```
<head>
<script type="text/javascript" src="external.js"></script>
</head>

<body>
<div id="container">

<div id = "product1">
  all of product 1 info and pictures
</div>

<div id = "product2">
  all of product 2 info and pictures
</div> 
```

所以基本上，是否有可能只使用 javascript，没有 php 或任何东西，当单击 product1 图像仅在产品页面上显示 product1 信息时，当单击 product2 时仅在页面上显示产品 2 的信息。我一直在尝试找到类似的东西，但到目前为止还没有，这让我相信我可能做不到，但我想我会问。

我的 javascript 文档中没有太多内容，因为我无法弄清楚，但我一直在尝试让它们的 display = none。如果您知道我的意思，我无法让变量继续到下一页。对不起，我对Javascript只有一个基本的了解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T01:32:50.153

您正在寻找的技术是 DHTML（动态 HTML）和 AJAX（异步 JavaScript 和 XML）的组合。

## **DHTML：**

DHTML 背后的想法是，当用户从服务器请求 HTML 页面时，服务器会响应该页面以及用户执行某些操作（例如单击产品图像）时可能需要的其他数据。

服务器在初始页面加载时返回到 HTML 页面的数据通常默认隐藏。例如，页面的 DOM 已加载，但元素上可能有 style="display:none"。

一旦用户启动某个操作，页面就会使用 JavaScript 来操作页面上可见的元素以及可能隐藏的元素。

考虑以下页面：

```
<body>
  <div id="page1">
    <div id="container">
        <div class="img">
           <a id="product1" onclick="showProduct1();" href="#">
           <img src="product.jpg"/> </a>
        </div>

        <div class="img">
           <a id="product2" onclick="showProduct2();" href="#">
           <img src="product.jpg"/> </a>
        </div>
    </div>
  </div>

  <div id="page2" style="display:none">
      <div id="product_page_wrapper">
          <a href="#" onclick="backToCategories()">back to Product Categories</a>
          <div id="productDetails">
              <div id="prod1">
                 ...
                 ...
               </div>
               <div id="prod2">
                 ... 
                 ...
               </div>
          </div
       </div>
  </div>
</body> 
```

上面的页面分为两个部分，一个是 id="page1"，另一个是 id="page2"。默认情况下，我们隐藏第 2 页。

当用户点击产品链接时，我们隐藏第 1 页并显示第 2 页：

```
document.getElementById("page1").setAttribute("style","display:none");
document.getElementById("page2").setAttribute("style","display:block"); 
```

此外，根据单击的链接，我们还取消隐藏被单击产品的产品详细信息，并隐藏未单击产品的详细信息。例如，如果点击产品 1，我们会显示产品 1：

```
document.getElementById("prod2").setAttribute("style","display:none");
document.getElementById("prod1").setAttribute("style","display:block"); 
```

最终结果是只显示 page2 div。如果用户单击“返回产品类别”链接，我们会反转该过程，隐藏 page2 并显示 page1。

总之，这种类型的操作可以完全在客户端完成，无需任何 PHP 或服务器端代码，只需使用[HTML、JavaScript 和 CSS](http://www.w3.org/DOM/#why)，正如 @Marcel 所指出的那样。然而，使用纯 DHTML 更多的是一种学术练习，而不是一种实际的解决方案，因为服务器端维护客户数据、产品数据以及专业的、产生收入的产品所需的一切。

## **阿贾克斯：**

另一方面，AJAX 与 DHTML 非常相似，甚至可以被视为 DHTML 的扩展。AJAX 背后的想法是——当用户启动一个动作时——页面从服务器请求数据。当服务器响应时，数据被传递给回调函数，然后使用数据操作页面。

在您的特定示例中，您可能会使用 DHTML 和 AJAX 的组合来实现所需的效果。考虑以下页面，该页面使用 AJAX 为用户选择的产品提取相关 HTML：

```
<head>
<script type="text/javascript" src="external.js"></script>

<script>

  function makeRequest(url) {
    if (window.XMLHttpRequest) { // Mozilla, Safari, ...
      httpRequest = new XMLHttpRequest();
    } else if (window.ActiveXObject) { // IE
      try {
        httpRequest = new ActiveXObject("Msxml2.XMLHTTP");
      } 
      catch (e) {
        try {
          httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
        } 
        catch (e) {}
      }
    }

    if (!httpRequest) {
      alert('Giving up :( Cannot create an XMLHTTP instance');
      return false;
    }
    httpRequest.onreadystatechange = displayContents;
    httpRequest.open('GET', url);
    httpRequest.send();
  }

  function displayContents() {
    if (httpRequest.readyState === 4) {
      if (httpRequest.status === 200) {
        //alert(httpRequest.responseText);
        document.getElementById("container").innerHTML = httpRequest.responseText;
    } else {
      alert('There was a problem with the request.');
    }
  }

</script>
</head>

<body>

    <div id="container">
        <div class="img">
           <a id="product1" onclick="makeRequest('/getproduct?id=1')" href="#">
           <img src="product.jpg"/> </a>
        </div>

        <div class="img">
           <a id="product2" href="#" onclick="makeRequest('/getproduct?id=2')">
           <img src="product2.jpg"/></a>        
        </div>
    </div>
</body> 
```

在上面的示例中，当用户单击产品的链接时，服务器会以足够的 HTML 响应来充分替换页面的 div#container 部分：

```
<span id="product">
    <p>Product Name 1</p>
    <p>Product details...</p>
</span> 
```

这被注入到页面中，以便 DOM 看起来像这样：

```
<body>

    <div id="container">
        <span id="product">
            <p>Product Name 1</p>
            <p>Product details...</p>
        </span>
    </div>

</body> 
```

## **概括：**

这个问题被标记为 JavaScript，而不是 jQuery，因此答案集中在 JavaScript 上，但 DHTML 部分中描述的技术在许多 JavaScript 库中都有使用。例如，有关您描述的技术的演示，请参阅[jQuery Mobile 的多页模板](http://jquerymobile.com/demos/1.1.0/docs/pages/multipage-template.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T01:22:09.733

您可以更改链接以添加参数。这样 PRODUCTPAGE.html 就知道您点击了哪个链接。

```
 <a href="PRODUCTPAGE.html?product1"><img src="product1.jpg"/></a>

   <a href="PRODUCTPAGE.html?product2"><img src="product2.jpg"/></a> 
```

在 PRODUCTPAGE.html 中，您可以使用 JavaScript 解析 URL 并仅显示特定产品的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T01:22:50.340

是的，您可以通过 javascript 隐藏和显示 DOM 的不同部分。

查看[此切换示例，](http://www.randomsnippets.com/2008/02/12/how-to-hide-and-show-your-div/)了解您需要做什么。

# css - Ul 不环绕图像

> ID：10770970
> 
> 赞同：0
> 
> 时间：2012-05-27T01:13:32.803
> 
> 标签：css, image, html-lists

我有一个浮动到左边的图像，可以很好地环绕它的文本，但是，当 Ul 和 Li 发挥作用时，我遇到了问题。我不太清楚如何解释，所以这是一张图片：![在此处输入图像描述](../Images/96c51279314d53672dc26b55e1e8cf6c.png)

代码：

```
<div style="overflow:auto;">
<center>
<h2>Ultimath V. 1.6.1 Released</h2>
</center>
<img align="left" src="images/ultimath_quadratic_tablet_land.png">
<center>Many new features and updated features, such as:</center><br>
<ul margin-left="15px">
        <li>Changed Search function to no longer bring you to homepage if not activated</li>
        <li>Multiple UI Fixes and upgrades</li>
        <li>Tablet specific layouts! (example to left)</li>
        <li>All inputs now automatically accept numbers (no more fumbling with switching to number keyboard!)</li>
        <li>Major Step by Step revamp! All solvers are now MUCH more specific!</li>
</ul>
</div>
<br>
<hr> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T01:38:41.843

错误的：

```
<ul margin-left="15px"> 
```

正确的语法：

```
<ul style="margin-left: 15px"> 
```

也尝试`margin-right: 15px;`为您的图像设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T01:42:20.863

而不是`float: left`，您应该使用`display:inline-block`.

**[现场演示](http://jsfiddle.net/xYyaY/3/)**

# php - 使用 zend_service_amazon，但没有看到任何输出

> ID：10770971
> 
> 赞同：0
> 
> 时间：2012-05-27T01:14:10.597
> 
> 标签：php, zend-framework, amazon

我正在玩弄亚马逊开发人员的 API，但什么也没得到。

这是我的代码。我`echo`用来查看是否有任何事情发生，而我得到的只是一个空白网页。我希望搜索结果数组得到回显。

```
<?php
error_reporting(E_ALL); 
ini_set("display_errors", 1); 
require_once('Zend/Service/Amazon.php');

$amazon = new Zend_Service_Amazon('AKIAJQBYUXIFWUIX6W6A', 'US', 'YGV9zePfKejV6C3dpaP/NtnhjGLfWQsccdGSSL50');
$results = $amazon->itemSearch(array('SearchIndex' => 'Books',
                                     'Keywords' => 'php'));
foreach ($results as $result) {
    echo $result->Title . '<br />';
}

    ?> 
```

仍然得到一个空白页

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T07:04:53.437

您的页面是空白的，因为您没有得到任何结果：

这是使用您发布的代码的 $results 转储：

```
Amazon object(Zend_Service_Amazon_ResultSet)#103 (4) {
  ["_results":protected] => object(DOMNodeList)#105 (0) {
  }
  ["_dom":protected] => object(DOMDocument)#101 (0) {
  }
  ["_xpath":protected] => object(DOMXPath)#104 (0) {
  }
  ["_currentIndex":protected] => int(0)
} 
```

要完成这项工作，有几个问题需要解决，其中最大的一个是：

> **以下更改将于 2011 年 11 月 1 日生效：**
> *关联标签参数：*向 API 发出的每个请求都应包含有效的关联标签。任何不包含有效关联标签的请求都将被拒绝并显示相应的错误消息。有关 Associate Tag 参数的详细信息，请参阅我们的开发人员指南。

当前的构造函数`Zend_Service_Amazon`不包括*Associate Tag*参数，并且该`_prepareOptions()`方法不设置选项。

我确定有人对此有解决方案，否则是时候深入挖掘并扩展......祝你好运

[亚马逊产品广告 API](http://docs.amazonwebservices.com/AWSECommerceService/latest/DG/Welcome.html)
[对产品广告 API 的更改](https://affiliate-program.amazon.com/gp/advertising/api/detail/api-changes.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:56:24.620

Zend_Service_Amazon 已经过时并且使用旧的 WSDL。见[http://zendframework.com/issues/browse/ZF-12046](http://zendframework.com/issues/browse/ZF-12046)

等待 1.12 或使用提供的批处理文件。

# php - 序列化（数据）的哪个mysql列类型？

> ID：10770974
> 
> 赞同：13
> 
> 时间：2012-05-27T01:16:08.070
> 
> 标签：php, mysql

我在 php 中序列化了很多要使用 mysql 存储在数据库中的数组。

最终字符串的长度可以从 2000 到 100,000+ 之间变化很大，我想知道最好的列类型是什么？

我目前将其设置为，`LONGTEXT`但我觉得这有点矫枉过正！该数据库已经处于活动状态，大约有 300 万行，这是一个很快就会添加的新列。

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-27T01:46:49.743

始终使用任何[`BLOB`数据类型](https://dev.mysql.com/doc/refman/5.0/en/blob.html)来序列化数据，这样它就不会被切断并以二进制安全的方式破坏序列化。如果最终字符串的长度没有最大值，那么您将需要`LONGBLOB`. 如果您知道数据不会填充 2^24 个字符，则可以使用`MEDIUMBLOB`. `MEDIUMBLOB`大约 16MB 而`LONGBLOB`大约 4GB 所以我会说你对`MEDIUMBLOB`.

为什么是二进制数据类型？MySQL 中的文本数据类型具有编码。字符编码将影响序列化数据在不同编码之间的转置方式。例如，当存储为 Latin-1 但随后读取为 UTF-8 时（例如，由于数据库驱动程序连接编码设置），序列化数据可能会被破坏，因为二进制偏移确实发生了偏移，但序列化数据并未针对此类偏移进行编码。PHP 的序列化字符串是二进制数据，没有任何特定的编码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-09T21:31:12.400

您应该根据 PHP 手册为 serialize() 选择 BLOB（如 Marc B 所述）：

> “请注意，这 [输出] 可能包含空字节的二进制字符串，需要按原样存储和处理。例如，serialize() 输出通常应存储在数据库的 BLOB 字段中，而不是 CHAR 或文本域。”

来源： http: [//php.net/serialize](http://php.net/serialize)

当然，还必须牢记 J.Money 关于大小的输入 - 即使 BLOB 也有其限制，如果您要超过它们，那么您将需要 MEDIUMBLOB 或 LONGBLOB。

# android - 灰度 PictureDrawable

> ID：10770976
> 
> 赞同：2
> 
> 时间：2012-05-27T01:16:26.377
> 
> 标签：android, svg

要对可绘制对象进行灰度化，我会这样做：

```
ColorMatrix matrix = new ColorMatrix();
matrix.setSaturation(200);
ColorMatrixColorFilter filter = new ColorMatrixColorFilter(matrix);
drawable.setColorFilter(filter); 
```

正如[贾斯汀所说](https://stackoverflow.com/questions/1793338/drawable-grayscale)。它工作正常。

我正在使用 svg-android 库。所以我正在尝试：

```
PictureDrawable pictureDrawable = svg.createPictureDrawable();
ColorMatrix matrix = new ColorMatrix();
matrix.setSaturation(200);
ColorMatrixColorFilter filter = new ColorMatrixColorFilter(matrix);
pictureDrawable.setColorFilter(filter);
imageView.setImageDrawable(pictureDrawable); 
```

但是什么也没有发生……怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T03:59:36.670

恐怕我在Android源代码中找到了原因：

可绘制的.java

```
public abstract void setColorFilter(ColorFilter cf); 
```

PictureDrawable.java

```
@Override
public void setColorFilter(ColorFilter colorFilter) {} 
```

简单地说，任何对 s 的调用`setColorFilter`都是无用`PictureDrawable`的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T16:49:24.650

我刚刚通过谷歌搜索找到了这个页面。如果有人仍然感兴趣，我正在使用一些解决方法来解决同样的问题：

```
Picture pic = svg.getPicture();
Bitmap bm = Bitmap.createBitmap(pic.getWidth(), pic.getHeight(), Bitmap.Config.ARGB_4444);
Canvas c = new Canvas(bm);
c.drawPicture(pic, new Rect(0,0,pic.getWidth(), pic.getHeight()));
c.save();
BitmapDrawable drawable = new BitmapDrawable(getResources(), bm);
drawable.setColorFilter(getBlackAndWhiteFilter());
imageView.setImageDrawable(drawable); 
```

而不是使用 pic.getWidth() 和 pic.getWidth() 你当然可以使用你喜欢的图像大小 - 所以位图不会画得太大，因为这可能会降低一些性能。

# ruby - 包含嵌套资源的列表

> ID：10770977
> 
> 赞同：0
> 
> 时间：2012-05-27T01:16:44.327
> 
> 标签：ruby, ruby-on-rails-3, nested

我有一个 Rails 3.2.1 应用程序，其中：

```
 class Article < ActiveRecord::Base
   belongs_to :category

  class Category < ActiveRecord::Base
   has_many :articles 
```

在路线：

```
 resources :categories, :shallow => true do
      resources :articles
   end 
```

我想在我的 Articles#index 中显示所有类别及其文章列表。在我的文章控制器中：

```
def index

#Categories
@categories = Category.all
@category = Category.find(params[:category_id]) if params[:category_id].present?
@category_articles = @category.present? ? @category.articles : Article.where("created_at >= ?", Time.now - 3.days).order("views DESC", :limit => 5).offset(1)
@feature_article = @category.present? ? @category.articles : Article.where("created_at >= ?", Time.now - 3.days).order("views DESC").first
end 
```

我的观点（文章#索引）

```
 <% @categories.each do |category| %>
<%= link_to category.name, category %> <!-- category name -->
    <%= link_to @feature_article.title, @feature_article %> <!-- feature article -->
    <% @category_articles.each do |article| %> <!-- Each category articles -->
              <%= link_to article.title, article %>
    <% end %>
 <% end %> 
```

问题是它列出了所有类别，但似乎不尊重 category_id 参数。在每个类别中，它显示所有文章，而不是每个类别的文章。

# javascript - Javascript 整个单词 w

> ID：10770978
> 
> 赞同：2
> 
> 时间：2012-05-27T01:16:59.643
> 
> 标签：javascript, regex, replace

我正在寻找一种显示一段文本并允许用户单击单个单词以突出显示它的方法。

我发现一些代码会在每个单词周围放置一个跨度。所有这一切都很好，但是......

当我有一些像说 Soufflé 这样的文字时，它不会将其识别为一个单词。

这是我正在使用的代码。

```
var p = $('#storyText');

p.html(function(index, oldHtml) {
    return oldHtml.replace(/\b([\w+-éñó\u00F1\u00E9]+)\b/g, '< span class="storyWord">$1< /span>');
}) 
```

它似乎可以正常工作，直到我在单词的开头或结尾有口音。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T01:42:30.333

问题是javascript RegExp 中的*单词字符*`[a-zA-z0-9_]`被简单地定义为，因此`\b`匹配它们之间的“边界”和重音字符。直接匹配单词是一种改进：

```
$.fn.highlightWords = function(){
  return this.html(function(i, html){
    return html.replace(/([\w'+-éñó\u00F1\u00E9])+/g, function(m){
        return '<span>'+m+'</span>'
    })
  })
}

$('p').highlightWords() 
```

演示：http: [//jsbin.com/elegod](http://jsbin.com/elegod)

# android - 是否可以直接从 OpenSL ES（适用于 Android）中的音频资产获取字节缓冲区？

> ID：10770979
> 
> 赞同：33
> 
> 时间：2012-05-27T01:18:13.730
> 
> 标签：android, audio-streaming, opensl

我想使用 OpenSL ES FileDescriptor 对象从音频资产中获取字节缓冲区，因此我可以将其反复排入 SimpleBufferQueue，而不是使用 SL 接口来播放/停止/查找文件。

我想直接管理样本字节有三个主要原因：

1.  OpenSL 使用 AudioTrack 层来播放/停止/等播放器对象。这不仅引入了不必要的开销，而且还存在一些错误，并且播放器的快速启动/停止会导致很多问题。
2.  我需要直接为自定义 DSP 效果操作字节缓冲区。
3.  我要播放的剪辑很小，都可以加载到内存中以避免文件 I/O 开销。另外，将我自己的缓冲区排入队列将允许我通过将 0 写入输出接收器来减少延迟，并在播放时简单地切换到采样字节，而不是停止、暂停和播放 AudioTrack。

好的，所以理由完成了 - 这是我尝试过的 - 我有一个**Sample**结构，它本质上包含一个输入和输出轨道，以及一个保存样本的字节数组。输入是我的 FileDescriptor 播放器，输出是 SimpleBufferQueue 对象。这是我的结构：

```
typedef struct Sample_ {
    // buffer to hold all samples
    short *buffer;      
    int totalSamples;

    SLObjectItf fdPlayerObject;
    // file descriptor player interfaces
    SLPlayItf fdPlayerPlay;
    SLSeekItf fdPlayerSeek;
    SLMuteSoloItf fdPlayerMuteSolo;
    SLVolumeItf fdPlayerVolume;
    SLAndroidSimpleBufferQueueItf fdBufferQueue;

    SLObjectItf outputPlayerObject; 
    SLPlayItf outputPlayerPlay; 
    // output buffer interfaces
    SLAndroidSimpleBufferQueueItf outputBufferQueue;        
} Sample; 
```

在初始化文件播放器**fdPlayerObject**并为我的字节缓冲区分配内存之后

```
sample->buffer = malloc(sizeof(short)*sample->totalSamples); 
```

我得到了它的 BufferQueue 接口

```
// get the buffer queue interface
result = (*(sample->fdPlayerObject))->GetInterface(sample->fdPlayerObject, SL_IID_ANDROIDSIMPLEBUFFERQUEUE, &(sample->fdBufferQueue)); 
```

然后我实例化一个**输出播放器**：

```
// create audio player for output buffer queue
const SLInterfaceID ids1[] = {SL_IID_ANDROIDSIMPLEBUFFERQUEUE};
const SLboolean req1[] = {SL_BOOLEAN_TRUE};
result = (*engineEngine)->CreateAudioPlayer(engineEngine, &(sample->outputPlayerObject), &outputAudioSrc, &audioSnk,
                                               1, ids1, req1);

// realize the output player
result = (*(sample->outputPlayerObject))->Realize(sample->outputPlayerObject, SL_BOOLEAN_FALSE);
assert(result == SL_RESULT_SUCCESS);

// get the play interface
result = (*(sample->outputPlayerObject))->GetInterface(sample->outputPlayerObject, SL_IID_PLAY, &(sample->outputPlayerPlay));
assert(result == SL_RESULT_SUCCESS);

// get the buffer queue interface for output
result = (*(sample->outputPlayerObject))->GetInterface(sample->outputPlayerObject, SL_IID_ANDROIDSIMPLEBUFFERQUEUE,
                                                   &(sample->outputBufferQueue));
assert(result == SL_RESULT_SUCCESS);    

  // set the player's state to playing
result = (*(sample->outputPlayerPlay))->SetPlayState(sample->outputPlayerPlay, SL_PLAYSTATE_PLAYING);
assert(result == SL_RESULT_SUCCESS); 
```

当我想播放样本时，我正在使用：

```
Sample *sample = &samples[sampleNum];
// THIS WORKS FOR SIMPLY PLAYING THE SAMPLE, BUT I WANT THE BUFFER DIRECTLY 
//    if (sample->fdPlayerPlay != NULL) {
//        // set the player's state to playing
//        (*(sample->fdPlayerPlay))->SetPlayState(sample->fdPlayerPlay, SL_PLAYSTATE_PLAYING);
//    }

// fill buffer with the samples from the file descriptor
(*(sample->fdBufferQueue))->Enqueue(sample->fdBufferQueue, sample->buffer,sample->totalSamples*sizeof(short));
// write the buffer to the outputBufferQueue, which is already playing
(*(sample->outputBufferQueue))->Enqueue(sample->outputBufferQueue, sample->buffer, sample->totalSamples*sizeof(short)); 
```

但是，这会导致我的应用程序冻结并关闭。这里不对劲。 **另外**，我不希望每次都从文件描述符的 BufferQueue 中获取样本。相反，我想将它永久存储在一个字节数组中，并在我喜欢的时候将它排入输出。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-18T04:22:31.440

API 级别 14 及更高级别可解码为 PCM。

创建解码器播放器时，您需要将 Android 简单缓冲区队列设置为数据接收器：

```
// For init use something like this:
SLDataLocator_AndroidFD locatorIn = {SL_DATALOCATOR_ANDROIDFD, decriptor, start, length};
SLDataFormat_MIME dataFormat = {SL_DATAFORMAT_MIME, NULL, SL_CONTAINERTYPE_UNSPECIFIED};
SLDataSource audioSrc = {&locatorIn, &dataFormat};

SLDataLocator_AndroidSimpleBufferQueue loc_bq = {SL_DATALOCATOR_ANDROIDSIMPLEBUFFERQUEUE, 2};
SLDataSink audioSnk = { &loc_bq, NULL };

const SLInterfaceID ids[2] = {SL_IID_PLAY, SL_IID_ANDROIDSIMPLEBUFFERQUEUE};
const SLboolean req[2] = {SL_BOOLEAN_TRUE, SL_BOOLEAN_TRUE};

SLresult result = (*engineEngine)->CreateAudioPlayer(engineEngine, &(sample->fdPlayerObject), &outputAudioSrc, &audioSnk, 2, ids1, req1); 
```

对于解码器队列，您需要将一组空缓冲区排入 Android 简单缓冲区队列，其中将填充 PCM 数据。

您还需要在解码器队列中注册一个回调处理程序，当 PCM 数据准备好时将调用该处理程序。回调处理程序应处理 PCM 数据，将现在为空的缓冲区重新入队，然后返回。应用程序负责跟踪解码的缓冲区；回调参数列表不包含足够的信息来指示哪个缓冲区已被填充或接下来要排队的缓冲区。

解码到 PCM 支持暂停和初始搜索。不支持音量控制、效果、循环和播放速率。

阅读从[适用于 Android 的 OpenSL ES 将](http://mobilepearls.com/labs/native-android-api/ndk/docs/opensles/)**音频解码为 PCM**以了解更多详细信息。

# c++ - C++ 矢量错误消息：

> ID：10770989
> 
> 赞同：-1
> 
> 时间：2012-05-27T01:21:58.393
> 
> 标签：c++, std

此错误消息是因为我使用 int 而不是 size_t 调整向量的大小吗？还是因为我必须声明一个复制构造函数？

我正在使用 分配元素`vector_name[pos] = MyClass_Obj`，而不是使用`vector_name.push_back(MyClass_Obj)`

> 没有合适的默认构造函数可用：
> 
> 请参阅正在编译的函数模板实例化 'void std::_Uninit_def_fill_n<_FwdIt,_Diff,_Tval,_Alloc,Node>(_FwdIt,_Diff,const _Tval *,_Alloc &,_Valty *,std::_Nonscalar_ptr_iterator_tag)' 的引用
> 
> 请参阅正在编译的函数模板实例化 'void std::_Uninitialized_default_fill_n>(_FwdIt,_Diff,const _Tval *,_Alloc &)' 的参考
> 
> 编译类模板成员函数 'void std::vector<_Ty>::resize(unsigned int)'
> 
> 请参阅正在编译的类模板实例化 'std::vector<_Ty>' 的引用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T01:25:21.460

你不应该那样插入。 `operator[]`用于访问，而不是用于创建。

如果您`vec[pos]`在`pos >= vec.size()`进入未定义行为领域的地方进行操作。 `vec[pos]`返回对存储在索引处的元素的引用`pos`。如果该位置*没有*元素，则实现可以随意做任何事情。

我希望您的代码能够安静地崩溃和烧毁，而不是给出编译器错误。可能发生的情况是向量实现正在尝试帮助您，并且它正在填充默认构造实例之间的空格`size()`（`pos`好吧，试图 - 这将需要存在默认构造函数）。

简而言之：“我正在使用 vector_name[pos] = MyClass_Obj 分配元素”

那是滥用`operator[]`. `operator[]`应该只用于访问存在的元素。它不应该用于添加新元素。我实际上很惊讶矢量实现并没有因此而窒息，因为我想它会尝试返回对不是该类型实例的东西的引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T01:44:37.467

存储在 a 中的对象`vector<>`必须是默认可构造的。你的不是。

```
class MyClass {
public:
  MyClass() { /* This ctor is required. */ }
};

int main () {
  std::vector<MyClass> vec_name;
  vec_name.resize(10); // or else this will fail.
} 
```

# jquery - jQuery在点击时删除所有类

> ID：10770990
> 
> 赞同：2
> 
> 时间：2012-05-27T01:22:01.917
> 
> 标签：jquery, css

我有几个按钮。单击时，我想从我的文本字段中删除所有类。
目前这就是我所拥有的，但代码没有优化。

```
var maintextarea = $('.myTextArea');
$('#styleBtn1').click(function(){
    maintextarea.removeClass('fromStyleBtn2 fromStyleBtn3');
    maintextarea.addClass('fromStyleBtn1');
    return false;
});
$('#styleBtn2').click(function(){
    maintextarea.removeClass('fromStyleBtn1 fromStyleBtn3');
    maintextarea.addClass('fromStyleBtn2');
    return false;
});
$('#styleBtn3').click(function(){
    maintextarea.removeClass('fromStyleBtn1 fromStyleBtn2');
    maintextarea.addClass('fromStyleBtn3');
    return false;
}); 
```

**问题**：如何重写该`removeClass`部分，以便在单击按钮时所有以前的类都将被清空并添加我的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T01:31:36.590

在这里，直接来自[.removeClass() 的 jQuery 文档](http://api.jquery.com/removeClass/)：

> 要将所有现有类替换为另一个类，我们可以使用 `.attr('class', 'newClass')`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T01:35:35.633

您可以简单地使用方法链接

```
maintextarea.removeClass().addClass('fromStyleBtn1'); 
```

不带任何参数调用 removeClass() 将删除所有类。

**编辑**：您的整个代码可以像这种通用形式一样替换。假设您的类名将始终采用“from”+elementID 格式。（例如：来自StyleBtn2）

```
var maintextarea = $('.myTextArea'); 
$('.fromStyleBtn1,.fromStyleBtn2,.fromStyleBtn3').click(function(){
    var item=$(this);
    var newClassName="from"+item.attr("id");
    maintextarea.removeClass().addClass(newClassName);
    return false;
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T01:35:39.393

如果您确实想删除类属性而不是某些属性值，请使用[removeAttr()](http://api.jquery.com/removeAttr/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T01:38:31.747

您可以像这样覆盖 removeClass 的功能：

```
$(function() {
    var originalRemoveClass=$.fn.removeClass;

    $.fn.extend({
        removeClass:function(toRemove, toAdd) {
            originalRemoveClass.call(this, toRemove);
            this.addClass(toAdd);            
        }
    });
}); 
```

你可以在这里看到一个例子：http: [//jsfiddle.net/NuGdM/1/](http://jsfiddle.net/NuGdM/1/)
另一种选择是创建你的插件来做到这一点（如果你需要一个例子 - 问我）。
祝你好运！

# apache-flex - flex 4 air app 在新的模态窗口中打开模块

> ID：10770992
> 
> 赞同：0
> 
> 时间：2012-05-27T01:22:24.693
> 
> 标签：apache-flex, module, window

我是 flex 新手，我正在尝试在新窗口模式中打开模块。我已经设法在容器（ vbox ）中加载和添加模块，但我真正需要的是在单独的窗口中打开它们。我能找到的所有帖子都是关于如何加载模块的示例，但没有关于如何显示它们的示例。我在这里找到了一个帖子 [Modules and Panels issue](https://stackoverflow.com/questions/1623705/modules-and-panels-issue/10762887#10762887) ，它通过屏幕截图看起来正是我正在寻找的。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T01:08:00.010

我找到了一种方法。感谢所有的指点

这就是我是如何做到的，供大家查看和使用。如果您有改进的建议，请随时发表评论。

我正在使用一个组件：collapsabletitlewindow

主应用程序.mxml

```
<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
   xmlns:s="library://ns.adobe.com/flex/spark" 
   xmlns:mx="library://ns.adobe.com/flex/mx"
   xmlns:components="de.aggro.components.*">
<fx:Script>
<![CDATA[

import de.aggro.components.*;

private function createWindow():void{
var w:window = new window;
w.title = "Window " + container.numChildren;
container.addChild(w);
}
]]>
</fx:Script>
<components:CollapsableTitleWindowContainer id="container" width="100%" height="100%" >
</components:CollapsableTitleWindowContainer>
<s:Button buttonDown="createWindow()" label="Create Window" />
<fx:Declarations>
<!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>
</s:WindowedApplication> 
```

* * *

窗口.mxml

```
<?xml version="1.0" encoding="utf-8"?>
<components:CollapsableTitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009" 
   xmlns:s="library://ns.adobe.com/flex/spark" 
   xmlns:mx="library://ns.adobe.com/flex/mx" xmlns:components="de.aggro.components.*"     layout="absolute" width="400" height="300"
   creationComplete="initApp()" >
<fx:Script>
<![CDATA[
import mx.events.ModuleEvent;
import mx.modules.ModuleManager;
import mx.modules.IModuleInfo;        
import mx.core.IVisualElement;

public var info:IModuleInfo;

private function initApp():void {
info = ModuleManager.getModule("mod.swf");
info.addEventListener(ModuleEvent.READY, modEventHandler);           

/* Load the module into memory. Calling load() makes the
IFlexModuleFactory available. You can then get an
instance of the class using the factory's create()
method. */
info.load(null, null, null, moduleFactory);
}

/* Add an instance of the module's class to the display list. */        
private function modEventHandler(e:ModuleEvent):void {

this.addElement(info.factory.create() as IVisualElement);
}
]]>
</fx:Script>
<fx:Declarations>
<!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>

</components:CollapsableTitleWindow> 
```

* * *

模组.mxml

```
<?xml version="1.0" encoding="utf-8"?>
<s:Module xmlns:fx="http://ns.adobe.com/mxml/2009" 
  xmlns:s="library://ns.adobe.com/flex/spark" 
  xmlns:mx="library://ns.adobe.com/flex/mx" width="400" height="300">
<fx:Declarations>
<!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>
<mx:LinkButton x="131" y="124" label="Module link"/>
</s:Module> 
```

# sql - 在带有heroku的Django中使用sql初始数据？

> ID：10770997
> 
> 赞同：1
> 
> 时间：2012-05-27T01:23:44.783
> 
> 标签：sql, django, heroku

为什么当我使用sql文件并通过sql语句加载我的初始数据以及在heroku上部署应用程序时，默认情况下没有执行sql文件并且在数据库中找不到数据，以及如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T02:50:41.087

Heroku 不使用 SQLlite 数据库。你必须使用 Heroku 的共享 postgresql 数据库，因为 heroku 是一个“生产”环境。

当您将 django 应用程序推送到 heroku 时，它会覆盖您的 settings.py 文件中的数据库设置。您必须对您的应用程序现在使用的生产 postresql 数据库执行 syncdb 或南迁移。

顺便说一句 - 您需要在您的开发环境中安装 postgres 并 pip install psycopg2 以获得 postgres/python 支持。

# ruby-on-rails-3 - 制作最高效的 Rails 3 has_many：通过查询

> ID：10770998
> 
> 赞同：0
> 
> 时间：2012-05-27T01:23:57.173
> 
> 标签：ruby-on-rails-3, postgresql

我有两个 Rails 3 模型，`Product`并`Room`在下面定义。每个 Room 可以有多个产品，每个产品可以在多个房间中：

```
class Product < ActiveRecord::Base
  #...
  has_many :rooms, :through => :product_selection
  has_many :product_selection
end

class Room < ActiveRecord::Base
  #...
  has_many :products, :through => :product_selection
  has_many :product_selection
end

class ProductSelection < ActiveRecord::Base
  #...
  belongs_to :product
  belongs_to :room
end 
```

我想在其中创建一个查询`rooms_controller.rb`以返回前 10 个房间的记录，并为每个房间包括推送到该房间的产品数量的计数（以了解每个房间中有多少产品）和总和Product 中的一列要求`cost`房间中的所有产品（以获取房间中所有产品的总成本）。调用查询后，理想情况下，我可以调用`@rooms[i].total_products`和`@rooms[i].total_cost`（或类似的东西）以及 Room 字段，这样它就可以很容易地被模板消化和迭代。

我知道我可以创建 10 个不同的调用，然后以 @room.products.count 和 @room.products.sum(cost) 的形式循环遍历每个调用，但必须有一种更有效的方法......而且我有一种感觉俯瞰明显的东西。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T21:09:49.620

天真的实现会让你做 N+1 个查询......

如果您只想有效地计算您的产品，我建议您实施[:counter_cache](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

尽管您还想执行计算（成本总和），但更希望使用房间查询预先加载产品。这个想法是返回您的房间列表及其产品。

```
room_array = Room.includes(:products).limit(10) 
```

如果有进一步提高效率的愿望，您可能希望数据库也进行求和。