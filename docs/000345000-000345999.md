# StackOverflow 问答 000345000-000345999

# web-applications - 智能客户端比 Web 应用程序更易于维护？

> ID：345001
> 
> 赞同：7
> 
> 时间：2008-12-05T20:20:38.917
> 
> 标签：web-applications, smartclient

我一直在研究一个有 2 个界面的项目——windows 窗体和 web。在过去的 8 个月中，我们在维护我们的 Web 应用程序方面遇到了更多问题（在 IE 中工作而不是在 FF 中，ajax 以一些不容易调试的奇怪方式中断......）等等。

另一方面，winform 应用程序易于安装。我们有一个 xcopy 版本并单击一次部署它允许用户单击浏览器中的链接进行下载和安装。当我们升级应用程序时，我们需要做的就是将其发布到服务器并发送电子邮件带链接。当用户单击下载链接时……他们有一个新版本……所需要的只是 2.0 运行时。

现在潮流正在转向智能客户端吗？

**编辑：浏览器现在是否会导致困扰客户端应用程序的 Web 应用程序问题（平台太多.. 并非所有平台都遵循相同的标准）？**

**编辑：Web 应用程序必须在多达 4 个浏览器上进行测试（更不用说 IE - IE 6、IE 7 和 IE 8）。而智能客户端在框架之上运行，因此它们不需要在所有操作系统上进行测试。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T20:43:06.407

我自己对这个问题有一些经验。我发现的一件事是，一些业务和软件管理人员将 Web 开发的浅层学习曲线* 误认为是廉价的开发成本。如果您的项目要求足够轻，那么构建和部署 Web 应用程序可能会更便宜，但我发现与开发桌面应用程序相比，让 Web 应用程序变得更复杂会成为一个巨大的痛苦。人们求助于 Flash 或 AJAX 等技术来弥补差距，但有时编写一个在本地运行并发出 Web 请求的应用程序比将 UI 作为网站提供要简单得多。

.NET 的积极营销肯定有助于扭转局面。:) 我有一些客户并不真正关心应用程序是在本地运行还是作为网站运行，只要它使用.NET 平台即可。这使得将 WinForms API 轻松用于那些真正的 UI 繁重的项目，这些项目会导致作为 Web 应用程序的噩梦。

* “浅学习曲线”是指 Web 开发人员可以从 HTML 和 CSS 开始，一点一点地混入 JavaScript，然后从那里继续使用 PHP——与 C++ 或 C# 相比，所有这些都是友好的工具。新手视角。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T20:24:30.763

也许潮流正在变成银光？

但是智能客户端的部署通常很容易（clickonce）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T20:30:50.893

传统上，Web 应用程序的优势在于它们很容易跨平台，部署不再是问题。

使用 ClickOnce 等技术，部署变得不那么麻烦……因此，如果您的应用只需要针对一组有限的平台，它确实可以提供一致、可控的用户体验。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T20:33:58.843

我们的 Intranet 实用程序有一个 PHP 网站。自 2 年以来，我们一直在使用 ClickOnce 切换 C# 应用程序，每个人都喜欢使用桌面应用程序。更新是自动完成的，开发团队已将所有 GUI/Visual 时间减少到约 70%。我们可能会取得如此高的水平或成功，因为大多数计算机都几乎相同（所有相同的操作系统和几乎所有相同的配置）但是很好：对我们来说是成功。希望这段经历能给你一些帮助，帮助你做出决定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T22:01:54.420

编程范式是钟摆。事情将转移回胖客户端，然后又回到瘦客户端。

以云计算机为例——分布式计算已经存在了 30 多年。但它现在是“新的”，因为我们已经在它上面加上了一个俗气的名字。

Web 2.0现在已经**出现**，但它会退出，“智能”客户端会重新出现。然后“Web 3.0 - 这次有更多的口哨”将会出现，并将“智能”推出。

*已经发生的事情将再次发生，已经完成的事情将再次发生；太阳底下没有新鲜事。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T20:30:52.467

自千年以来也存在像 java web start 这样的东西，但它并没有起飞......

从程序员的角度来看，这些技术绝对是更好的方法。要在 Web 上创建应用程序，您实际上只是在胡闹。他们有一天会起飞吗？只有时间证明一切。不过我希望如此。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T20:45:38.897

当您控制客户端群时，您可以更好地控制您的应用程序，并且胖客户端可以在这些域中正常工作（尤其是在企业环境中的防火墙后面）。

但是您的 winform 应用程序依赖于：操作系统、.NET 安装等。因此，只要您运行的是 Windows 和兼容的 .NET 框架，就可以了。但显然，随着客户的进步，这些假设将需要保持。

除了“奇怪的 Ajax 问题”之外，如果您要求每个人都使用相同的浏览器（就像您要求每个人都使用 Windows 和 .NET），那么这些不兼容问题就会“消失”。

显然，Ajax 开发和浏览器不像其他开发模型和工具套件那样成熟，但它正在变得更好，而且速度非常快。浏览器平台的成熟，特别是在这个新领域，是“Fat Ajax”模型的主要缺陷。

但是，我们现在有四家主要公司/组织非常努力地推动该模型，并认为“Fat Ajax”模型将继续提高标准，使其成为更广泛应用的更好选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T21:51:03.100

在我看来，为各种浏览器编写代码并不像试图让原生 GUI 应用程序在 mac、windows 和 *nix 上正常运行（更不用说 *nix 领域中的各种窗口平台）那样困难。但是如果你只需要支持比较现代的windows电脑，那你可能就有点意思了。

# c++ - 在模块（exes和dlls）之间使用STL（TR1）shared_ptr是否安全

> ID：345003
> 
> 赞同：16
> 
> 时间：2008-12-05T20:21:04.080
> 
> 标签：c++, visual-c++, memory-management, stl, shared-ptr

我知道在一个模块中添加新内容并在另一个模块中删除它通常会导致 VC++ 出现问题。不同运行时的问题。如果我没记错的话，将模块与静态链接的运行时和/或动态链接的版本控制不匹配混合起来都会搞砸。

**但是，跨模块使用 VC++ 2008 的 std::tr1::shared_ptr 是否安全？**

由于只有一个版本的运行时甚至知道什么是 shared_ptr，所以静态链接是我唯一的危险（现在......）。我以为我已经读过 boost 的 shared_ptr 版本可以像这样安全使用，但我使用的是 Redmond 的版本......

我试图避免在分配模块中对释放对象进行特殊调用。（或类本身中的“删除这个”之类的东西）。如果这一切看起来有点 hacky，我正在使用它进行单元测试。如果您曾经尝试过对现有 C++ 代码进行单元测试，那么您就会明白有时您需要发挥多大的***创造力。***我的内存由 EXE 分配，但最终将在 DLL 中释放（如果引用计数按我认为的方式工作）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-05T23:10:09.993

释放内存是安全的，只要它都来自相同的*内存管理*上下文。您已经确定了最常见的问题（不同的 C++ 运行时）；拥有单独的堆是您可能遇到的另一个不太常见的问题。

另一个您没有提到但可能会因共享指针而加剧的问题是，当一个对象的代码存在于 DLL 中并由 DLL 创建时，但 DLL 之外的另一个对象最终会引用它（通过共享指针）。如果该对象在 DLL 被卸载后被销毁（例如，如果它是模块级静态的，或者如果 DLL 被显式卸载`FreeLibrary()`，则共享对象的析构函数将崩溃。

如果您尝试编写基于 DLL 的松散耦合插件，这可能会给您带来麻烦。这也是 COM 让 DLL 决定何时*可以*卸载它们的原因，而不是让 COM 服务器按需卸载它们。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-04-29T17:02:41.530

你开始看到是多么令人难以置信`shared_ptr`:)

跨 DLL 边界的安全正是`shared_ptr`设计的初衷（当然，除其他外）。

与其他人所说的相反，您甚至不需要在构造时传递自定义删除器`shared_ptr`，因为默认值已经类似于

```
template <typename T>
struct default_deleter {
    void operator()( T * t ) { delete t; }
}; 
```

和

```
shared_ptr<Foo> foo( new Bar ); 
```

相当于

```
shared_ptr<Foo> foo( new Bar, default_deleter<Bar>() ); 
```

（即，没有删除器就没有 a 这样的东西`shared_ptr`）。

由于在删除器上执行的类型擦除，`delete`被调用的将*始终*是 DLL 中*实例化*的那个`shared_ptr`，而不是来自 DLL 中最后一个`shared_ptr`超出范围的那个（即，`shared_ptr`调用删除器将通过一个指向原始函数放在那里的函数的指针`shared_ptr`）。

将此与 比较`auto_ptr`，后者将`delete`运算符直接嵌入其（内联）析构函数中，这意味着使用*破坏*DLL的`delete`DLL ，产生与删除裸指针相同的问题。*`auto_ptr`*

 *通过同样的技术，总是保存在`shared_ptr`s 中的多态类甚至不需要虚拟析构函数，因为删除器总是会调用正确的析构函数，即使最后一个`shared_ptr`超出范围的是为基类实例化的析构函数。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-05T23:09:22.477

如果您担心，请使用带有删除器参数的 shared_ptr 构造函数的形式。删除器可以回调分配对象的模块，以便删除发生在正确的上下文中。

Boost 的文档声称它与 TR1 100% 兼容，所以希望这不会引起任何误导：

[http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm#constructors](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm#constructors)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T20:47:56.943

我猜想它与`std`跨模块使用任何类一样安全。

也就是说：如果模块使用完全相同的运行时库，以及完全相同的编译器开关和选项，则应该是安全的。

永远不要使用静态运行时库，因为每个模块都会在其中获得所有全局变量的自己的实例。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-05T20:56:16.067

我在一般主题上看到的最佳建议是，应该在分配内存的同一上下文中释放内存。但是，这并不排除库传回应用程序代码应该释放的指针，所以我会说您以这种方式传递 shared_ptr 可能是安全的，因为这是相同的一般情况。

如果您的系统语义意味着指针实际上是从您的 exe 传输到您的 dll（在所有权意义上），那么 auto_ptr 可能是一个更好的解决方案。但是，如果您的指针是真正共享的，那么 shared_ptr 可能是最好的解决方案。

# silverlight - Silverlight 有 VirtualizingStackPanel 吗？

> ID：345004
> 
> 赞同：1
> 
> 时间：2008-12-05T20:21:04.437
> 
> 标签：silverlight, virtualizingstackpanel

Silverlight 有[VirtualizingStackPanel](http://msdn.microsoft.com/en-us/library/system.windows.controls.virtualizingstackpanel.aspx)吗？如果没有内置类型，是否有任何第三方控件可以实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-06T17:10:41.570

是的，在 Silverlight 3 的发布中添加了[VirtualizingStackPanel](http://msdn.microsoft.com/en-us/library/system.windows.controls.virtualizingstackpanel(VS.95).aspx)（MSDN 库）。

# wpf - 打印 WPF FlowDocument

> ID：345009
> 
> 赞同：38
> 
> 时间：2008-12-05T20:22:54.777
> 
> 标签：wpf, printing

我正在 WPF 中构建一个演示应用程序，这对我来说是新的。我目前在 FlowDocument 中显示文本，需要打印它。

我正在使用的代码如下所示：

```
 PrintDialog pd = new PrintDialog();
        fd.PageHeight = pd.PrintableAreaHeight;
        fd.PageWidth = pd.PrintableAreaWidth;
        fd.PagePadding = new Thickness(50);
        fd.ColumnGap = 0;
        fd.ColumnWidth = pd.PrintableAreaWidth;

        IDocumentPaginatorSource dps = fd;
        pd.PrintDocument(dps.DocumentPaginator, "flow doc"); 
```

fd 是我的 FlowDocument，现在我使用默认打印机，而不是允许用户指定打印选项。它工作正常，除了文档打印后，屏幕上显示的 FlowDocument 已更改为使用我指定的打印设置。

我可以通过在打印后手动重置所有内容来解决此问题，但这是最好的方法吗？我应该在打印之前制作一份 FlowDocument 的副本吗？还是我应该考虑另一种方法？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-12T15:44:34.497

是的，在打印之前制作 FlowDocument 的副本。这是因为分页和边距会有所不同。这对我有用。

```
 private void DoThePrint(System.Windows.Documents.FlowDocument document)
    {
        // Clone the source document's content into a new FlowDocument.
        // This is because the pagination for the printer needs to be
        // done differently than the pagination for the displayed page.
        // We print the copy, rather that the original FlowDocument.
        System.IO.MemoryStream s = new System.IO.MemoryStream();
        TextRange source = new TextRange(document.ContentStart, document.ContentEnd);
        source.Save(s, DataFormats.Xaml);
        FlowDocument copy = new FlowDocument();
        TextRange dest = new TextRange(copy.ContentStart, copy.ContentEnd);
        dest.Load(s, DataFormats.Xaml);

        // Create a XpsDocumentWriter object, implicitly opening a Windows common print dialog,
        // and allowing the user to select a printer.

        // get information about the dimensions of the seleted printer+media.
        System.Printing.PrintDocumentImageableArea ia = null;
        System.Windows.Xps.XpsDocumentWriter docWriter = System.Printing.PrintQueue.CreateXpsDocumentWriter(ref ia);

        if (docWriter != null && ia != null)
        {
            DocumentPaginator paginator = ((IDocumentPaginatorSource)copy).DocumentPaginator;

            // Change the PageSize and PagePadding for the document to match the CanvasSize for the printer device.
            paginator.PageSize = new Size(ia.MediaSizeWidth, ia.MediaSizeHeight);
            Thickness t = new Thickness(72);  // copy.PagePadding;
            copy.PagePadding = new Thickness(
                             Math.Max(ia.OriginWidth, t.Left),
                               Math.Max(ia.OriginHeight, t.Top),
                               Math.Max(ia.MediaSizeWidth - (ia.OriginWidth + ia.ExtentWidth), t.Right),
                               Math.Max(ia.MediaSizeHeight - (ia.OriginHeight + ia.ExtentHeight), t.Bottom));

            copy.ColumnWidth = double.PositiveInfinity;
            //copy.PageWidth = 528; // allow the page to be the natural with of the output device

            // Send content to the printer.
            docWriter.Write(paginator);
        }

    } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-09T15:45:49.653

您可以使用下面 URL 中的代码，它将流文档包装在一个固定文档中并打印出来，最大的优点是您可以使用它来添加边距、页眉和页脚。

[https://web.archive.org/web/20150502085246/http://blogs.msdn.com:80/b/fyuan/archive/2007/03/10/convert-xaml-flow-document-to-xps- with-style-multiple-page-page-size-header-margin.aspx](https://web.archive.org/web/20150502085246/http://blogs.msdn.com:80/b/fyuan/archive/2007/03/10/convert-xaml-flow-document-to-xps-with-style-multiple-page-page-size-header-margin.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-22T15:25:56.617

以下适用于文本和非文本视觉效果：

```
//Clone the source document
var str = XamlWriter.Save(FlowDoc);
var stringReader = new System.IO.StringReader(str);
var xmlReader = XmlReader.Create(stringReader);
var CloneDoc = XamlReader.Load(xmlReader) as FlowDocument;

//Now print using PrintDialog
var pd = new PrintDialog();

if (pd.ShowDialog().Value)
{
  CloneDoc.PageHeight = pd.PrintableAreaHeight;
  CloneDoc.PageWidth = pd.PrintableAreaWidth;
  IDocumentPaginatorSource idocument = CloneDoc as IDocumentPaginatorSource;

  pd.PrintDocument(idocument.DocumentPaginator, "Printing FlowDocument");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-01T19:26:25.260

我还从 Flow 文档中生成 WPF 报告，但我故意将 flow 文档用作打印预览屏幕。我在那里希望边距相同。你可以在这里阅读[我是如何做到这一点的](http://kiwiingenuity.net.nz/post/My-First-WPF-Report)。

在您的场景中，我在想为什么不只是复制您的设置，而不是整个流程文档。如果您希望将文档恢复到原始状态，则可以重新应用设置。

# performance - 具有高性能 Web 服务的企业消息传递 API？

> ID：345010
> 
> 赞同：0
> 
> 时间：2008-12-05T20:23:09.253
> 
> 标签：performance, web-services, soap, jms

将企业消息传递解决方案与 Web 服务相结合是否会比通过套接字的简单 HTTP 请求获得真正的性能提升？

（如果实现细节有帮助，对带有 SOAP 网络服务的 JMS 感兴趣）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T20:26:28.107

通常，使用消息传递解决方案是为了消息的可靠性，而不是性能。如果您需要有保证的消息传递，请使用 JMS 之类的东西。

HTTP 是如此轻量级，我无法想象任何其他消息传递解决方案会有更高的性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T20:37:35.043

一如既往，这取决于。如果您使用 http 协议通过套接字发送 xml 文档，那么不会.. 您的性能将与企业框架大致相同（因为 Web 服务实际上就是这样，数据编码在 soap 协议中，通过套接字上的 http 协议）。

如果您通过套接字发送更轻量级的数据流，那么您可能会获得更好的性能。

最终，这取决于您发送的内容、发送的数量以及发送的频率。

# database - 在对数据库建模时如何处理“特殊情况”数据？

> ID：345021
> 
> 赞同：5
> 
> 时间：2008-12-05T20:27:15.487
> 
> 标签：database, data-modeling

我们的组织为我们的客户提供各种服务（例如，网络托管、技术支持、定制编程等）。我们网站上有一个页面列出了所有可用的服务及其相应的价格。这是静态数据，但我的老板希望它全部从数据库中提取。

列出了大约 100 项服务。然而，其中只有两个具有“价格”的非数字值（特别是字符串“ISA”和“成本 + 8%”——我真的不知道它们应该是什么意思，所以不要问我）。

我不想仅仅因为这两个列表就将“价格”列设为 varchar。我目前的方法是创建一个特殊的“price_display”字段，该字段要么为空白，要么包含要显示的文本来代替价格。这个解决方案感觉太像一个肮脏的黑客（它会使查询不必要地复杂化），那么有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T20:48:08.220

考虑到此列是**向客户显示的价格**，可以包含任何内容。

如果你试图把它变成一个数字列，你会招来悲伤。你已经在两个不合规的价值观上苦苦挣扎，明天你的老板可能想要更多……

*   申请价格！
*   打电话给我们今天特别！

你明白了。

如果您确实需要一个数字列，则将其称为**internalPrice**或其他名称，然后将您的数字约束放在该列上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-20T19:32:24.340

当我过去不得不做这种事情时，我用过：

```
Price   Unit   Display
10.00   item   null
100.00  box    null
null    null   "Call for Pricing" 
```

价格将是十进制数据类型（任何精确的数字，不是浮点数或实数），单位和显示将是某种类型的字符串数据类型。

然后使用 case 语句以单价或显示器显示价格。还要在显示列上放置一个约束或触发器，使其必须为空，除非价格为空。如果 price 不为 null，则约束或触发器也应该需要单位值。

这样，您可以在可能的情况下计算订单的价格，并在未指定价格但同时显示两者时将其排除在外。我还制定了一项业务规则，以确保在解决定价要求之前无法总计总计（您还必须有一种方法将特殊定价插入到订单详细信息中，而不是仅仅从价格表）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T20:48:23.510

问你自己...

我会添加这些值吗？我会按价格排序吗？我需要转换成其他货币价值吗？

或者

我会在网页上显示这个值吗？

如果这只是一个洗衣清单而不用于计算，最简单的解决方案是将价格存储为字符串（varchar）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T20:38:33.403

也许在主表中使用“类型”指示符，一个子表允许数字价格，另一个子表允许字符值。这些可以合并到一张表中，但我通常避免这样做。如果您想根据购买的数量确定价格，您也可以使用带有数量的中间链接表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T20:38:50.253

很多选择：

1.  所有价格都存储为 varchars
2.  以数字形式存储的价格和额外的 price_display 字段，如果填充，则覆盖该数字
3.  以数字方式存储的价格和用于显示目的的额外 price_display 字段手动填充或在更新数字价格时触发（数据重复并且可能不同步 - yuk）
4.  存储映射到特殊情况的特殊情况负价格（简直是哇！！）
5.  varchar price，可用前缀表的前缀键字段（'cost +'，...），可用后缀表的后缀键字段，价格类型列表的类型字段键（'$' ， '％'， '描述'）。如果您将来需要针对价格编写复杂的查询，这很有用。

我可能会选择 2 作为一个实用的解决方案，如果我需要通用定价系统的一些非常通用的东西，我可能会选择 5 的扩展。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-05T20:50:06.720

如果这是您的数据模型的范围，那么 varchar 字段就可以了。无论如何，您的正常价格（可能是小数）可能对计算毫无用处。您如何比较“数据传输”10 美元/GB 和“域托管”25 美元/月？

这个特定项目的数据模型不是关于定价，而是关于显示定价。考虑到这一点进行设计。

当然 - 如果您要存储特定客户为特定项目支付的价格，或者试图弄清楚向特定客户收取什么费用 - 那么您有一个不同的（更复杂的）域。你需要一个不同的模型来支持它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-05T21:06:30.697

至少其中一个替代价格涉及一个数字，那么价格列，价格类型呢？正常条目可以是美元值和类型“dollar”的数字，另一个可以是 8 和“PercentOverCost”以及 null 和“ISA”（用于 Price 和 PriceType 列）。

如果你走这条路，你可能应该有一个 PriceType 表来验证和 PriceTypeID。

这将允许将来添加其他类型的定价（单位定价，外币），给你一个数字，也让你更容易知道你正在处理什么类型的定价。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-21T07:55:41.693

[http://books.google.co.in/books?id=0f9oLxovqIMC&pg=PA352&lpg=PA352&dq=How+do+you+handle+%E2%80%9Cspecial-case%E2%80%9D+data+when+modeling+ a+database%3F&source=bl&ots=KxN9eRgO9q&sig=NqWPvxceNJPoyZzVS4AUtE-FF5c&hl=en&ei=V3RlSpDtI4bVkAWkzbHNDg&sa=X&oi=book_result&ct=result&resnum=3](http://books.google.co.in/books?id=0f9oLxovqIMC&pg=PA352&lpg=PA352&dq=How+do+you+handle+%E2%80%9Cspecial-case%E2%80%9D+data+when+modeling+a+database%3F&source=bl&ots=KxN9eRgO9q&sig=NqWPvxceNJPoyZzVS4AUtE-FF5c&hl=en&ei=V3RlSpDtI4bVkAWkzbHNDg&sa=X&oi=book_result&ct=result&resnum=3)

# sql-server-2005 - 查找表中唯一值的数量

> ID：345023
> 
> 赞同：1
> 
> 时间：2008-12-05T20:28:04.830
> 
> 标签：sql-server-2005, tsql

我有一个有四列的表：

零件编号、阀门零件编号、执行器零件编号、价格

我想找到 ValvePartNumber 和 ActuatorPartNumber 的每个组合的不同价格的数量。

这是使用 SQL Server 2005

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T20:36:13.940

您可以组合`COUNT(DISINTCT)`并`GROUP BY`完成此操作。

```
SELECT ValuePartNumber, ActuatorPartNumber, COUNT(DISTINCT Price) AS Prices
FROM [Table]
GROUP BY ValuePartNumber, ActuatorPartNumber 
```

# c# - 使用 LinqToXml 使用过滤器选择唯一的 XElement（按属性）

> ID：345025
> 
> 赞同：7
> 
> 时间：2008-12-05T20:28:49.990
> 
> 标签：c#, xml, linq-to-xml, unique

我有一个类似于此的 XML 文档：

```
<items>
 <item cat="1" owner="14">bla</item>
 <item cat="1" owner="9">bla</item>
 <item cat="1" owner="14">bla</item>
 <item cat="2" owner="12">bla</item>
 <item cat="2" owner="12">bla</item>
</items> 
```

现在我想使用 linq 查询获取属于指定类别的所有唯一所有者（我实际上只需要所有者的属性值）。在我的示例中，对 cat 1 的查询将返回一个包含 9 和 14 的列表。我该怎么做？Linq 语法比 Lambda 更受欢迎。提前致谢 ;）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-05T20:56:22.823

假设片段在 itemsElement 中：

```
var distinctOwners = (from item in itemsElement.Element("item") 
 where itemElements.Attribute("cat") == 1 
select item.Attribute("owner")).Distinct(); 
```

为格式化和缩进道歉！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T20:58:54.860

试试这个功能： -

```
static IEnumerable<int> GetOwners(XDocument doc, string cat)
{
    return from item in doc.Descendants("item")
        where item.Attribute("cat").Value == cat
        select (int)item.Attribute("owner")).Distinct();

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T21:00:11.533

```
 XElement ele = XElement.Parse(@"<items><item cat=""1"" owner=""14"">bla</item><item cat=""1"" owner=""9"">bla</item>" +
                                @"<item cat=""1"" owner=""14"">bla</item><item cat=""2"" owner=""12"">bla</item>" +
                                @"<item cat=""2"" owner=""12"">bla</item></items>");

  int cat = 1;

  List<int> owners = ele.Elements("item")
    .Where(x=>x.Attribute("cat").Value==cat.ToString()).Select(x=>Convert.ToInt32(x.Attribute("owner").Value)).Distinct().ToList(); 
```

# mysql - mysql更新数学

> ID：345041
> 
> 赞同：5
> 
> 时间：2008-12-05T20:36:51.347
> 
> 标签：mysql

说 p.products_price 等于 1

为什么：

> ```
> UPDATE products p
> SET p.products_price = (1 + p.products_price)
> WHERE p.products_id = 8 
> ```

使 p.products_price 等于 3？

它是在价格上加 1，然后从头再来？我正在尝试做一些更复杂的事情，但是当它不起作用时，我将其分解为有史以来最简单的事情。我可以在这里制作某种临时值并计算新价格然后将其设置为该值吗？

请帮助我愤怒，谢谢。

MySQL客户端版本：4.1.22

编辑：该列是十进制类型，我在 int 列上尝试了相同的更新，结果相同。

编辑：这不是在代码中运行，因此代码不可能两次调用相同的更新

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T21:29:07.403

```
UPDATE products    
SET products_price = (1 + products_price)    
WHERE products_id = 8 
```

像它应该的那样工作（删除表别名'p'）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T20:41:48.187

那绝对应该将 products_price 设置为 2。一定还有其他事情发生。

这类似于[使用 PHP 更新 MySQL 字段的问题，](https://stackoverflow.com/questions/238800/problem-with-updating-a-mysql-field-with-php)但那里没有好的解决方案，所以我也会让这个问题保持打开状态。

您是从客户端运行它，还是通过脚本运行它？

您是否有任何交易打开或其他脚本访问数据库？

编辑：您在评论中提到了联接 - 我愿意打赌您的联接不止一次拉回同一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T20:45:12.063

您的 SQL 看起来不错。“某事”列是独一无二的吗？确保您只更新一条记录。

# javascript - 根据宽度（以像素为单位）缩短长文本

> ID：345042
> 
> 赞同：2
> 
> 时间：2008-12-05T20:37:16.400
> 
> 标签：javascript, gwt, label

我想缩短对可用表格列宽的很长的描述。我有以像素为单位的列宽信息。现在我想将此度量转换为字符数，以便可以将文本缩短为指定的数字。

我不必 100% 正确，一个近似的假设也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T20:51:50.913

将您的文本包装在 DIV 中的单元格中。这将告诉您 DIV 内的文本是否大于单元格：

```
<div id='test' style='width:200px;height:100px;overflow:hidden'>
<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse at felis. Etiam ullamcorper. Aenean fringilla, eros eu dapibus tristique, erat lacus vestibulum metus, nec pharetra leo ante et quam. Nunc ac mi molestie justo placerat laoreet. Morbi eget dolor. Curabitur pretium, mi quis iaculis molestie, dolor ligula sagittis orci, at sodales quam dolor quis sem. Suspendisse vitae risus. Maecenas vestibulum dolor vel augue. Sed purus. Ut nisi massa, vestibulum id, lobortis eget, aliquet eu, enim. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos.</p>
</div>
<script type="text/javascript">
alert($('test').scrollHeight)
</script> 
```

如果您想在单词末尾截断并添加省略号 (...)，您可以在脚本中开始删除单词，直到高度等于或小于容器。（我使用[Protoype](http://prototypejs.org)作为 $ 快捷方式）

这是一个工作示例：

```
<div id='test' style='width:300px;height:100px;overflow:hidden'>
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse at felis. Etiam ullamcorper. Aenean fringilla, eros eu dapibus tristique, erat lacus vestibulum metus, nec pharetra leo ante et quam. Nunc ac mi molestie justo placerat laoreet. Morbi eget dolor. Curabitur pretium, mi quis iaculis molestie, dolor ligula sagittis orci, at sodales quam dolor quis sem. Suspendisse vitae risus. Maecenas vestibulum dolor vel augue. Sed purus. Ut nisi massa, vestibulum id, lobortis eget, aliquet eu, enim. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos.
</div>
<script type="text/javascript">
function shorten(element) { 
    if($(element).scrollHeight>$(element).getHeight()) {
        var myText = $(element).innerHTML.split(" ")
        myText.length=myText.length-2
        $(element).update(myText.join(" ")+" ...")
        window.setTimeout('shorten("'+element+'")',1)
    }

}
shorten('test')
</script> 
```

您可以通过拆分句号而不是空格来处理句子，但如果没有找到句点，或者截断后剩余的内容太短，则需要回退。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-13T20:10:08.243

他所说的 CSS 属性是“文本溢出”。

尝试将以下内容添加到您元素的类中，所有内容都是必需的：

```
overflow: hidden;
text-overflow: ellipsis;
white-space: nowrap; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-01T15:26:24.310

我正在使用 jquery 1.4.2，早期的答案并没有解决问题，但有所帮助.. 这是经过一些小调整的代码。请记住，容器需要固定高度并隐藏溢出。

```
p#descr1 { height:46px; overflow:hidden; }

<script type="text/javascript">

    function shorten(element) {
        if ($(element).attr('scrollHeight') > $(element).height()) {
            var myText = $(element).text().split(" ")
            myText.length = myText.length - 2
            $(element).html(myText.join(" ") + " ...")
            window.setTimeout('shorten("' + element + '")', 1)
        }
    }

    $(document).ready(function () {
        shorten('#descr1'); // the id of the container

    });

</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T20:42:13.613

这是为了网络？如果是这样，为什么不使用更简单的方法，例如使用 css 来隐藏溢出？

# c++ - 从 VB6 访问 C++ DLL 中的位图资源

> ID：345045
> 
> 赞同：1
> 
> 时间：2008-12-05T20:38:09.583
> 
> 标签：c++, dll, vb6, bitmap, resources

我有一个 C++ DLL，包括由 Visual Studio 创建的位图资源。

虽然我可以使用 LoadLibrary 在 VB6 中加载 DLL，但我无法使用 LoadImage 或 LoadBitmap 加载图像资源。当我尝试使用 GetLastError() 获取错误时，它不会返回任何错误。

我曾尝试在另一个具有相同 DLL 的 C++ 程序中使用 LoadImage 和 LoadBitmap，它们可以正常工作。

有没有其他方法可以使用 VB6 访问 C++ DLL 中的资源位图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T21:30:14.250

由于您使用位图的数字 ID 作为字符串，因此必须在其前面添加一个“#”：

```
DLLHandle = LoadLibrary("Mydll.dll")
myimage = LoadBitmap(DLLHandle, "#101")  ' note the "#" 
```

在 C++ 中，您还可以使用 MAKEINTRESOURCE 宏，它只是对 LPCTSTR 的强制转换：

```
imagehandle = LoadBitmap(DLLHandle, MAKEINTRESOURCE(101)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T20:56:51.603

你有正确的想法。你可能打错电话了。也许您可以显示一些代码，因为我无法猜测您传递的是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T21:02:10.593

在 VB6 中：

```
Private Declare Function LoadLibrary Lib "kernel32" Alias "LoadLibraryA" (ByVal lpLibFileName As String) As Long

Private Declare Function LoadBitmap Lib "user32" Alias "LoadBitmapA" (ByVal hInstance As Long, ByVal lpBitmapName As String) As Long

DLLHandle = LoadLibrary("Mydll.dll")

myimage = LoadBitmap(DLLHandle, "101") 
```

附带即使`myimage`是非零的，但是，在 C++ 中：`0``DLLHandle`

```
imagehandle = LoadBitmap(DLLHandle,LPCSTR(101)); 
```

作品！

非常感谢

# c# - 在 FOR 循环中声明变量

> ID：345047
> 
> 赞同：5
> 
> 时间：2008-12-05T20:38:41.313
> 
> 标签：c#, scope

生产中发生了一个奇怪的错误，我被要求调查。
该问题被追踪到在 For 循环中声明的几个变量，并且没有在每次迭代中初始化。假设由于它们声明的范围，它们将在每次迭代时“重置”。
有人可以解释为什么他们不会）？
（我的第一个问题，真的很期待回复。）
下面的示例显然不是问题代码，而是反映了场景：
请原谅代码示例，在编辑器预览中看起来很好？？

```
for (int i =0; i< 10; i++)
{
    decimal? testDecimal;
    string testString;

    switch( i % 2  )
    {
        case 0:
        testDecimal = i / ( decimal ).32;
        testString = i.ToString();
            break;
        default:
            testDecimal = null;
            testString = null;
            break;
    }

    Console.WriteLine( "Loop {0}: testDecimal={1} - testString={2}", i, testDecimal , testString );
} 
```

* * *

### 编辑：

抱歉，因为托儿问题不得不赶出去。问题在于，prod 代码的 switch 语句很大，并且在某些“情况”下，正在检查类的属性，例如 if (myObject.Prop != null) 然后 testString = myObject.Stringval。 .. 在切换结束时，（外部）对 testString == null 进行了检查，但它保存了上次迭代的值，因此不像编码器假设的那样为 null，并且在循环中声明了变量。
抱歉，如果我的问题和示例有点不对劲，当我把它放在一起时，我接到了关于日托的电话。我应该提到我比较了循环内外两个变量的 IL。那么，是否普遍认为“变量显然不会在每个循环上重新初始化”？
更多信息，变量 WHERE 在每次迭代中被初始化，直到有人对 ReSharper 过度热情指出“从未使用过该值”并删除它们。

* * *

### 编辑：

各位，谢谢大家。作为我的第一篇文章，我看到我将来应该更加清晰。我们意外变量分配的原因可以归咎于一个没有经验的开发人员做 ReSharper 告诉他的所有事情，并且在他对整个解决方案运行“代码清理”后没有运行任何单元测试。查看 VSS 中这个模块的历史，我看到变量 Where 声明在循环之外，并且在每次迭代时初始化。有问题的人希望他的 ReSharper 显示“全绿色”，因此“将他的变量移近赋值”然后“删除多余的赋值”！我认为他不会再这样做了……现在要在周末运行他错过的所有单元测试！
如何将问题标记为已回答？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-05T23:40:19.370

**大多数**时候，在循环内部还是外部声明变量都没有关系。明确分配的规则确保它无关紧要。在调试器中，您可能偶尔会看到旧值（即，如果您在分配断点之前查看变量），但静态分析证明这不会影响执行代码。变量永远不会在每个循环中重置，因为显然没有必要。

在 IL 级别，**通常*变量只为方法声明一次 - 循环内的放置只是为我们程序员提供便利。

**但是**有一个重要的例外；任何时候捕获变量，范围规则都会变得更加复杂。例如（2 秒）：

```
 int value;
        for (int i = 0; i < 5; i++)
        {
            value = i;
            ThreadPool.QueueUserWorkItem(delegate { Console.WriteLine(value); });
        }
        Console.ReadLine(); 
```

与以下非常**不同**：

```
 for (int i = 0; i < 5; i++)
        {
            int value = i;
            ThreadPool.QueueUserWorkItem(delegate { Console.WriteLine(value); });
        }
        Console.ReadLine(); 
```

由于第二个示例中的“值”**确实**是每个实例，因为它已被捕获。这意味着第一个示例可能显示（例如）“4 4 4 4 4”，而第二个示例将显示 0-5（以任何顺序） - 即“1 2 5 3 4”。

那么：原始代码中是否涉及捕获？任何带有 lambda、匿名方法或 LINQ 查询的东西都符合条件。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-05T21:45:30.383

**概括**

将生成的用于在循环内声明变量的 IL 与生成的用于在循环外声明变量的 IL 进行比较，证明这两种类型的变量声明之间没有性能差异。（生成的 IL 几乎是相同的。）

* * *

这是原始来源，据说使用“更多资源”，因为变量是在循环内声明的：

```
using System;

class A
{
    public static void Main()
    {
        for (int i =0; i< 10; i++)
        {
            decimal? testDecimal;
            string testString;
            switch( i % 2  )
            {
                case 0:
                    testDecimal = i / ( decimal ).32;
                    testString = i.ToString();
                    break;
                default:
                    testDecimal = null;
                    testString = null;
                    break;
            }

            Console.WriteLine( "Loop {0}: testDecimal={1} - testString={2}", i, testDecimal , testString );
        }
    }
} 
```

这是来自低效声明源的 IL：

```
.method public hidebysig static void Main() cil managed
{
    .entrypoint
    .maxstack 8
    .locals init (
        [0] int32 num,
        [1] valuetype [mscorlib]System.Nullable`1<valuetype [mscorlib]System.Decimal> nullable,
        [2] string str,
        [3] int32 num2,
        [4] bool flag)
    L_0000: nop 
    L_0001: ldc.i4.0 
    L_0002: stloc.0 
    L_0003: br.s L_0061
    L_0005: nop 
    L_0006: ldloc.0 
    L_0007: ldc.i4.2 
    L_0008: rem 
    L_0009: stloc.3 
    L_000a: ldloc.3 
    L_000b: ldc.i4.0 
    L_000c: beq.s L_0010
    L_000e: br.s L_0038
    L_0010: ldloca.s nullable
    L_0012: ldloc.0 
    L_0013: call valuetype [mscorlib]System.Decimal [mscorlib]System.Decimal::op_Implicit(int32)
    L_0018: ldc.i4.s 0x20
    L_001a: ldc.i4.0 
    L_001b: ldc.i4.0 
    L_001c: ldc.i4.0 
    L_001d: ldc.i4.2 
    L_001e: newobj instance void [mscorlib]System.Decimal::.ctor(int32, int32, int32, bool, uint8)
    L_0023: call valuetype [mscorlib]System.Decimal [mscorlib]System.Decimal::op_Division(valuetype [mscorlib]System.Decimal, valuetype [mscorlib]System.Decimal)
    L_0028: call instance void [mscorlib]System.Nullable`1<valuetype [mscorlib]System.Decimal>::.ctor(!0)
    L_002d: nop 
    L_002e: ldloca.s num
    L_0030: call instance string [mscorlib]System.Int32::ToString()
    L_0035: stloc.2 
    L_0036: br.s L_0044
    L_0038: ldloca.s nullable
    L_003a: initobj [mscorlib]System.Nullable`1<valuetype [mscorlib]System.Decimal>
    L_0040: ldnull 
    L_0041: stloc.2 
    L_0042: br.s L_0044
    L_0044: ldstr "Loop {0}: testDecimal={1} - testString={2}"
    L_0049: ldloc.0 
    L_004a: box int32
    L_004f: ldloc.1 
    L_0050: box [mscorlib]System.Nullable`1<valuetype [mscorlib]System.Decimal>
    L_0055: ldloc.2 
    L_0056: call void [mscorlib]System.Console::WriteLine(string, object, object, object)
    L_005b: nop 
    L_005c: nop 
    L_005d: ldloc.0 
    L_005e: ldc.i4.1 
    L_005f: add 
    L_0060: stloc.0 
    L_0061: ldloc.0 
    L_0062: ldc.i4.s 10
    L_0064: clt 
    L_0066: stloc.s flag
    L_0068: ldloc.s flag
    L_006a: brtrue.s L_0005
    L_006c: ret 
} 
```

这是在循环外声明变量的源代码：

```
using System;

class A
{
    public static void Main()
    {
        decimal? testDecimal;
        string testString;

        for (int i =0; i< 10; i++)
        {
            switch( i % 2  )
            {
                case 0:
                    testDecimal = i / ( decimal ).32;
                    testString = i.ToString();
                    break;
                default:
                    testDecimal = null;
                    testString = null;
                    break;
            }

            Console.WriteLine( "Loop {0}: testDecimal={1} - testString={2}", i, testDecimal , testString );
        }
    }
} 
```

这是在循环外声明变量的 IL：

```
.method public hidebysig static void Main() cil managed
{
    .entrypoint
    .maxstack 8
    .locals init (
        [0] valuetype [mscorlib]System.Nullable`1<valuetype [mscorlib]System.Decimal> nullable,
        [1] string str,
        [2] int32 num,
        [3] int32 num2,
        [4] bool flag)
    L_0000: nop 
    L_0001: ldc.i4.0 
    L_0002: stloc.2 
    L_0003: br.s L_0061
    L_0005: nop 
    L_0006: ldloc.2 
    L_0007: ldc.i4.2 
    L_0008: rem 
    L_0009: stloc.3 
    L_000a: ldloc.3 
    L_000b: ldc.i4.0 
    L_000c: beq.s L_0010
    L_000e: br.s L_0038
    L_0010: ldloca.s nullable
    L_0012: ldloc.2 
    L_0013: call valuetype [mscorlib]System.Decimal [mscorlib]System.Decimal::op_Implicit(int32)
    L_0018: ldc.i4.s 0x20
    L_001a: ldc.i4.0 
    L_001b: ldc.i4.0 
    L_001c: ldc.i4.0 
    L_001d: ldc.i4.2 
    L_001e: newobj instance void [mscorlib]System.Decimal::.ctor(int32, int32, int32, bool, uint8)
    L_0023: call valuetype [mscorlib]System.Decimal [mscorlib]System.Decimal::op_Division(valuetype [mscorlib]System.Decimal, valuetype [mscorlib]System.Decimal)
    L_0028: call instance void [mscorlib]System.Nullable`1<valuetype [mscorlib]System.Decimal>::.ctor(!0)
    L_002d: nop 
    L_002e: ldloca.s num
    L_0030: call instance string [mscorlib]System.Int32::ToString()
    L_0035: stloc.1 
    L_0036: br.s L_0044
    L_0038: ldloca.s nullable
    L_003a: initobj [mscorlib]System.Nullable`1<valuetype [mscorlib]System.Decimal>
    L_0040: ldnull 
    L_0041: stloc.1 
    L_0042: br.s L_0044
    L_0044: ldstr "Loop {0}: testDecimal={1} - testString={2}"
    L_0049: ldloc.2 
    L_004a: box int32
    L_004f: ldloc.0 
    L_0050: box [mscorlib]System.Nullable`1<valuetype [mscorlib]System.Decimal>
    L_0055: ldloc.1 
    L_0056: call void [mscorlib]System.Console::WriteLine(string, object, object, object)
    L_005b: nop 
    L_005c: nop 
    L_005d: ldloc.2 
    L_005e: ldc.i4.1 
    L_005f: add 
    L_0060: stloc.2 
    L_0061: ldloc.2 
    L_0062: ldc.i4.s 10
    L_0064: clt 
    L_0066: stloc.s flag
    L_0068: ldloc.s flag
    L_006a: brtrue.s L_0005
    L_006c: ret 
} 
```

我将分享秘密，除了指定的顺序外`.locals init ( ... )`，IL 完全相同。在循环内声明变量不会产生额外的 IL。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-05T21:21:55.580

> 无论如何，您都不应该将声明放在 for 循环中。它会为一遍又一遍地创建变量而消耗额外的资源，而您应该做的只是在每次迭代中清除变量。

不，它*没有*！应该做与你的建议完全相反的事情。但是，即使重置变量更有效，在其尽可能严格的范围内声明变量也会更加清晰。并且清晰胜过（几乎）任何时候的微优化。此外，一种变量，一种用法。不要不必要地重用变量。

也就是说，变量在这里没有被重置或重新初始化——实际上，它们甚至没有被 C# 初始化！要解决这个问题，只需初始化它们并完成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T21:18:01.873

这是您的代码的输出：

```
Loop 0: testDecimal=0 - testString=0
Loop 1: testDecimal= - testString=
Loop 2: testDecimal=6.25 - testString=2
Loop 3: testDecimal= - testString=
Loop 4: testDecimal=12.5 - testString=4
Loop 5: testDecimal= - testString=
Loop 6: testDecimal=18.75 - testString=6
Loop 7: testDecimal= - testString=
Loop 8: testDecimal=25 - testString=8
Loop 9: testDecimal= - testString= 
```

我没有更改您发布的源中的任何内容来生成此输出。请注意，它也不会引发异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T21:10:04.073

您是否收到 NullReferenceException 错误？

从上面的代码中，当您在将变量分配为空后尝试打印变量时，您会在循环的每个奇数迭代中得到该错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T22:15:19.137

这里发生了一些奇怪的事情，如果它们从未被初始化，那么它应该抛出一个编译错误。

当我运行你的代码时，我得到了我所期望的，奇数循环上没有任何东西，偶数循环上没有正确的数字。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-05T21:44:35.737

这也让我感到惊讶。我原以为范围会在“for”循环中发生变化。情况似乎并非如此。值被保留。编译器似乎足够聪明，可以在第一次进入“for”循环时声明变量。

我同意之前的帖子，你不应该把声明放在“for”循环中。如果您初始化变量，您将在每个循环中消耗资源。

但是如果你将“for”循环的内部部分分解为一个函数（我知道这仍然很糟糕）。您超出范围，每次都会创建变量。

```
private void LoopTest()
{
    for (int i =0; i< 10; i++)
    {
        DoWork(i);
    }
}

private void Work(int i)
{
    decimal? testDecimal;
    string testString;

    switch (i % 2)
    {
        case 0:
            testDecimal = i / (decimal).32;
            testString = i.ToString();
            break;
        default:
            testDecimal = null;
            testString = null;
            break;
    }
    Console.WriteLine( "Loop {0}: testDecimal={1} - testString={2}", i, testDecimal , testString );
} 
```

好吧，至少我学到了一些新东西。以及在循环内声明变量到底有多糟糕。

# php - PHP 和 SQL Server 调试

> ID：345051
> 
> 赞同：1
> 
> 时间：2008-12-05T20:39:09.190
> 
> 标签：php, sql-server

我正在使用 PHP 编写一个脚本，该脚本需要从 SQL Server 数据库中获取一些信息。但是，我无法连接到数据库。当我使用 mssql_connect() 函数时，它给了我一个错误并说它无法连接到数据库。但是，它没有给出任何理由。有什么办法可以查出为什么连接不上？似乎没有函数 mssql_error() 或任何与 mysql 库类似的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T21:17:36.820

尝试使用 pdo ( [http://php.net/pdo](http://php.net/pdo) )。mssql 扩展是一团糟。

而不是 '' 它为空字符串返回 ' '。这似乎是 ntwdblib 中从未修复过的错误。当我遇到这个问题时，我几乎要疯了......

要连接客户端：您是否在 sql-server 上激活了 tcp/ip？在 MSSQL 2005 Express 上，默认情况下它*没有*被激活！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T20:42:12.850

您是否尝试过查看 Windows 事件日志？我不确定那里是否有足够的信息，但它可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T00:19:04.037

我会检查你的 PHP MSSQL 扩展设置，我曾经启用了安全性，需要关闭它才能访问特定的 MSSQL 服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T16:34:01.010

肯定会迁移到 PDO，从长远来看，当您将来需要更多功能时，您将获得更多好处。

# java - 是否可以创建一个 Java UDP 套接字来监听所有地址？

> ID：345068
> 
> 赞同：3
> 
> 时间：2008-12-05T20:44:05.437
> 
> 标签：java, networking

我想要一个 DatagramSocket 来监听单播和广播消息。这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T12:51:18.493

根据定义，广播是一种*传输*功能。

如果您的 UDP 套接字正在侦听特定端口并绑定到`INADDR_ANY`（又名 0.0.0.0），那么它将接收发送到该端口的所有数据包，无论它们是否发送到本地机器的特定 IP 地址（即单播），或者到本地子网的广播地址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T20:49:20.120

我认为如果您将地址设置为 0.0.0.0，它就可以完成工作。

# sql-server - 来自 SQL Server 的 Soap Web 服务调用

> ID：345069
> 
> 赞同：0
> 
> 时间：2008-12-05T20:44:08.337
> 
> 标签：sql-server, web-services

我不完全确定这是否可能，但有谁知道如何，或者您是否可以从 SQL Server 调用 SOAP Web 服务？似乎它在数据同步应用程序领域的性能方面可能很好。我觉得这可能是一个很长的镜头。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T22:49:27.150

创建基于 CLR 的调用非常乏味，并不推荐。你为什么要这样做？也许我们可以提供另一种选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T13:39:07.120

您可能想参考这个 stackoverflow 问题：[SQL Server - Using CLR integration to consume a Web Service](https://stackoverflow.com/questions/180046/sql-server-using-clr-integration-to-consume-a-web-service)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T20:46:09.643

如果您使用的是 SQL Server 2005 或更高版本，则可以通过创建执行该任务的 CLR 过程来调用 Web 服务。

# algorithm - 三角函数如何工作？

> ID：345085
> 
> 赞同：108
> 
> 时间：2008-12-05T20:49:25.067
> 
> 标签：algorithm, math, trigonometry

所以在高中数学，可能还有大学，我们被教导如何使用三角函数，它们做什么，以及它们解决了什么样的问题。但它们总是作为一个黑匣子呈现给我。如果你需要某个东西的正弦或余弦，你点击计算器上的 sin 或 cos 按钮，你就可以设置了。这很好。

我想知道的是三角函数通常是如何实现的。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2008-12-05T20:59:17.403

首先，您必须进行某种范围缩小。Trig 函数是周期性的，因此您需要将参数减少到标准间隔。对于初学者，您可以将角度减小到 0 到 360 度之间。但是通过使用一些身份，你意识到你可以用更少的钱过日子。如果您计算 0 到 45 度之间角度的正弦和余弦，则可以引导您计算所有角度的所有三角函数。

一旦你减少了你的论点，大多数芯片都会使用[CORDIC](http://en.wikipedia.org/wiki/Cordic)算法来计算正弦和余弦。您可能会听到人们说计算机使用泰勒级数。这听起来很合理，但事实并非如此。CORDIC 算法更适合高效的*硬件*实现。（*软件*库可能使用泰勒级数，比如在不支持三角函数的硬件上。）可能会有一些额外的处理，使用 CORDIC 算法来获得相当好的答案，然后做一些其他的事情来提高准确性。

上面有一些改进。例如，对于非常小的角度 theta（以弧度为单位）， sin(theta) = theta 到您拥有的所有精度，因此简单地返回 theta 比使用其他算法更有效。因此，在实践中，有很多特殊情况逻辑可以挤出所有可能的性能和准确性。市场较小的芯片可能不会进行太多优化工作。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-12-27T00:39:00.610

编辑：Jack Ganssle 在他关于嵌入式系统的书[“固件手册”](http://books.google.com/books?id=ERc_AHIyuTsC&pg=PA181)中有一个不错的讨论。

仅供参考：如果您有准确性和性能限制，则不应使用泰勒级数**来**逼近用于数值目的的函数。（将它们保存在您的微积分课程中。）它们利用函数*在单个点的*[分析](http://en.wikipedia.org/wiki/Analytic_function)性，例如，它的所有导数都存在于该点这一事实。它们不一定会在感兴趣的区间内收敛。通常他们在分配函数逼近的准确性方面做得很糟糕，以便在评估点附近“完美”；当您远离它时，错误通常会向上放大。如果你有一个带有任何非连续导数的函数（例如方波、三角波和它们的积分），泰勒级数会给你错误的答案。

 *当使用最大次数 N 的多项式在区间 x0 < x < x1 上逼近给定函数 f(x) 时，最好的“简单”解决方案来自[切比雪夫近似](http://mathworld.wolfram.com/ChebyshevApproximationFormula.html)；请参阅数字食谱进行很好的讨论。请注意，我链接到的 Wolfram 文章中的 Tj(x) 和 Tk(x) 使用了 cos 和反余弦，这些是多项式，实际上您使用递归公式来获得系数。再次，请参阅数字食谱。

[编辑：维基百科有一篇关于近似理论](http://en.wikipedia.org/wiki/Approximation_theory)的半体面的文章。他们引用的其中一个来源（Hart，“计算机近似”）已绝版（并且使用过的副本往往很昂贵），但对此类内容进行了很多详细说明。（Jack Ganssle 在他的时事通讯[The Embedded Muse 的](http://www.ganssle.com/tem-back.htm)第 39 期中提到了这一点。）

编辑 2：这是 Taylor 与 Chebyshev 的 sin(x) 的一些有形错误指标（见下文）。需要注意的一些要点：

1.  泰勒级数逼近在给定范围内的最大误差远大于同阶切比雪夫逼近的最大误差。（对于大约相同的错误，您可以使用 Chebyshev 少一个术语，这意味着更快的性能）
2.  范围缩小是一个巨大的胜利。这是因为当近似的间隔更小时，高阶多项式的贡献会缩小。
3.  如果您无法摆脱范围缩减，则需要更精确地存储您的系数。

不要误会我的意思：泰勒级数适用于正弦/余弦（在 -pi/2 到 +pi/2 范围内具有合理的精度；从技术上讲，只要有足够的术语，您就可以对所有实际输入达到任何所需的精度，但是尝试使用泰勒级数计算 cos(100)，除非你使用任意精度的算术，否则你不能这样做）。如果我被一个非科学计算器困在荒岛上，我需要计算正弦和余弦，我可能会使用泰勒级数，因为系数很容易记住。但是，在现实世界中必须编写自己的 sin() 或 cos() 函数的应用非常少见，因此最好使用有效的实现来达到所需的精度——泰勒级数**不是**。

范围 = -pi/2 到 +pi/2，5 级（3 项）

*   Taylor：最大误差在 4.5e-3 左右，f(x) = xx ³ /6+x ⁵ /120
*   Chebyshev：最大误差在 7e-5 左右，f(x) = 0.9996949x-0.1656700x ³ +0.0075134x ⁵

范围 = -pi/2 到 +pi/2，7 级（4 项）

*   Taylor：最大误差在 1.5e-4 左右，f(x) = xx ³ /6+x ⁵ /120-x ⁷ /5040
*   Chebyshev：最大误差约为 6e-7，f(x) = 0.99999660x-0.16664824x ³ +0.00830629x ⁵ -0.00018363x ⁷

范围 = -pi/4 到 +pi/4，3 级（2 项）

*   Taylor：最大误差在 2.5e-3 左右，f(x) = xx ³ /6
*   Chebyshev：最大误差约为 1.5e-4，f(x) = 0.999x-0.1603x ³

范围 = -pi/4 到 +pi/4，5 级（3 项）

*   Taylor：最大误差在 3.5e-5 左右，f(x) = xx ³ /6+x ⁵
*   Chebyshev：最大误差约为 6e-7，f(x) = 0.999995x-0.1666016x ³ +0.0081215x ⁵

范围 = -pi/4 到 +pi/4，度数 7（4 项）

*   Taylor：最大误差在 3e-7 左右，f(x) = xx ³ /6+x ⁵ /120-x ⁷ /5040
*   Chebyshev：最大误差约为 1.2e-9，f(x) = 0.999999986x-0.166666367x ³ +0.008331584x ⁵ -0.000194621x ⁷

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-05T20:58:33.910

我相信它们是使用[Taylor Series](http://en.wikipedia.org/wiki/Taylor_series)或[CORDIC](http://en.wikipedia.org/wiki/CORDIC)计算的。一些大量使用三角函数（游戏、图形）的应用程序在启动时会构建三角表，这样它们就可以只查找值而不是一遍又一遍地重新计算它们。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-05T21:03:52.433

查看有关三角函数[的 Wikipedia 文章。](http://en.wikipedia.org/wiki/Trigonometric_function)学习在代码中实际实现它们的好地方是[Numerical Recipes](http://www.nr.com/)。

我不是一个数学家，但我对 sin、cos 和 tan “从何而来”的理解是，在某种意义上，当你使用直角三角形时可以观察到它们。如果您测量一堆不同直角三角形的边长并将点绘制在图表上，您可以从中得到 sin、cos 和 tan。正如 Harper Shelby 所指出的，这些函数被简单地定义为直角三角形的属性。

通过了解这些比率与圆的几何形状之间的关系，可以获得更复杂的理解，圆的几何形状导致弧度和所有这些优点。这一切都在维基百科条目中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-19T03:51:54.080

最常用于计算机，幂级数表示用于计算正弦和余弦，这些用于其他三角函数。将这些系列扩展到大约 8 项计算所需的值以接近机器 epsilon（可以保持的最小非零浮点数）的精度。

CORDIC 方法更快，因为它是在硬件上实现的，但它主要用于嵌入式系统而不是标准计算机。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-11-06T12:38:33.187

我想扩展@Jason S 提供的答案。使用类似于@Jason S 描述的域细分方法并使用 Maclaurin 级数近似，在 tan()、sin() 上平均加速 (2-3)X , cos(), atan(), asin(), 和 acos() 函数内置到 gcc 编译器与 -O3 优化实现。下面描述的最好的 Maclaurin 级数逼近函数实现了双精度精度。

对于 tan()、sin() 和 cos() 函数，为简单起见，重叠的 0 到 2pi+pi/80 域被划分为 81 个相等的间隔，“锚点”位于 pi/80、3pi/80、 ...，161pi/80。然后评估并存储这 81 个锚点的 tan()、sin() 和 cos()。在三角恒等式的帮助下，为每个三角函数开发了一个麦克劳林级数函数。±无穷大之间的任何角度都可以提交给三角函数逼近函数，因为这些函数首先将输入角度转换为 0 到 2pi 域。此转换开销包含在近似开销中。

为 atan()、asin() 和 acos() 函数开发了类似的方法，其中重叠的 -1.0 到 1.1 域被划分为 21 个等间隔，锚点位于 -19/20、-17/20、... ., 19/20, 21/20。然后只存储了这 21 个锚点中的 atan()。同样，在逆三角恒等式的帮助下，为 atan() 函数开发了一个 Maclaurin 级数函数。然后使用 atan() 函数的结果来近似 asin() 和 acos()。

由于所有反三角逼近函数都基于 atan() 逼近函数，因此允许任何双精度参数输入值。然而，asin() 和 acos() 逼近函数的参数输入被截断为 ±1 域，因为它之外的任何值都是无意义的。

为了测试近似函数，强制评估十亿个随机函数评估（也就是说，不允许 -O3 优化编译器绕过评估某些东西，因为某些计算结果将不会被使用。）消除评估十亿的偏差随机数和处理结果，首先执行不评估任何三角函数或反三角函数的运行成本。然后从每个测试中减去该偏差，以获得更具有代表性的实际功能评估时间的近似值。

表 2\. 执行指定函数或函数十亿次所花费的时间（以秒为单位）。估计值是通过从表 1 的其余行中减去评估表 1 第一行中显示的十亿个随机数的时间成本获得的。

在 tan() 中花费的时间：18.0515 18.2545

在 TAN3() 中花费的时间：5.93853 6.02349

在 TAN4() 中花费的时间：6.72216 6.99134

在 sin() 和 cos() 中花费的时间：19.4052 19.4311

在 SINCOS3() 中花费的时间：7.85564 7.92844

在 SINCOS4() 中花费的时间：9.36672 9.57946

在 atan() 中花费的时间：15.7160 15.6599

在 ATAN1() 中花费的时间：6.47800 6.55230

在 ATAN2() 中花费的时间：7.26730 7.24885

在 ATAN3() 中花费的时间：8.15299 8.21284

在 asin() 和 acos() 中花费的时间：36.8833 36.9496

在 ASINCOS1() 中花费的时间：10.1655 9.78479

在 ASINCOS2() 中花费的时间：10.6236 10.6000

在 ASINCOS3() 中花费的时间：12.8430 12.0707

（为了节省空间，表 1 未显示。）表 2 显示了对每个近似函数进行十亿次评估的两次单独运行的结果。第一列是第一次运行，第二列是第二次运行。函数名称中的数字“1”、“2”、“3”或“4”表示 Maclaurin 级数函数中用于评估特定三角函数或逆三角函数逼近的项数。SINCOS#() 表示同时计算 sin 和 cos。同样，ASINCOS#() 表示同时评估了 asin 和 acos。同时评估这两个数量几乎没有额外的开销。

结果表明，如预期的那样，增加术语的数量会略微增加执行时间。除了 tan() 近似值接近±无穷大的地方，即使是最少数量的项也能提供大约 12-14 位的准确度。人们会认为即使是 tan() 函数也会出现问题。

在 Unix 中的高端 MacBook Pro 笔记本电脑和 Linux 中的高端台式计算机上获得了类似的结果。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-01-29T06:09:26.677

如果您要求对 sin、cos 和 tan 进行更物理的解释，请考虑它们与直角三角形的关系。cos(lambda) 的实际数值可以通过形成一个直角三角形，其中一个角为 lambda，并将与 lambda 相邻的三角形边的长度除以斜边的长度。同样，对于罪，使用对边除以斜边。对于切线，使用对边除以相邻边。记住这一点的经典记忆词是 SOHCHAHTOA（发音为 socatoa）。

# c# - 如果我在 Try 块中返回一个值，Finally 语句中的代码会触发吗？

> ID：345091
> 
> 赞同：249
> 
> 时间：2008-12-05T20:50:17.390
> 
> 标签：c#, .net, exception-handling, try-catch

我正在为一位朋友查看一些代码，并说他在 try-finally 块中使用了 return 语句。即使 try 块的其余部分没有触发，Finally 部分中的代码是否仍然触发？

例子：

```
public bool someMethod()
{
  try
  {
    return true;
    throw new Exception("test"); // doesn't seem to get executed
  }
  finally
  {
    //code in question
  }
} 
```

* * *

## 回答 #1

> 赞同：280
> 
> 时间：2008-12-05T20:50:47.030

简单的回答：是的。

* * *

## 回答 #2

> 赞同：209
> 
> 时间：2008-12-05T20:53:23.157

通常，是的。finally 部分保证执行任何发生的事情，包括异常或返回语句。此规则的一个例外是线程 ( `OutOfMemoryException`, `StackOverflowException`) 上发生的异步异常。

要了解有关这种情况下的异步异常和可靠代码的更多信息，请阅读[受约束的执行区域](https://blogs.msdn.microsoft.com/bclteam/2005/06/13/constrained-execution-regions-and-other-errata-brian-grunkemeyer/)。

* * *

## 回答 #3

> 赞同：158
> 
> 时间：2008-12-05T21:45:00.803

这是一个小测试：

```
class Class1
{
    [STAThread]
    static void Main(string[] args)
    {
        Console.WriteLine("before");
        Console.WriteLine(test());
        Console.WriteLine("after");
    }

    static string test()
    {
        try
        {
            return "return";
        }
        finally
        {
            Console.WriteLine("finally");
        }
    }
} 
```

结果是：

```
before
finally
return
after 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2008-12-05T21:03:42.057

引用 MSDN

> **finally**用于保证语句块的执行，而不管前面的**try**块是如何**退出**的。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2011-06-23T15:09:38.333

通常是的，finally 会运行。

对于以下三种情况，finally 将*始终*运行：

1.  **没有异常发生**
2.  **同步异常**（正常程序流程中发生的异常）。
    这包括派生自 System.Exception 的 CLS 兼容异常和不派生自 System.Exception 的非 CLS 兼容异常。不符合 CLS 的异常由 RuntimeWrappedException 自动包装。C# 不能抛出非 CLS 投诉异常，但 C++ 等语言可以。C# 可能正在调用以一种可以引发不符合 CLS 的异常的语言编写的代码。
3.  **异步 ThreadAbortException**
    从 .NET 2.0 开始，ThreadAbortException 将不再阻止 finally 运行。ThreadAbortException 现在被提升到 finally 之前或之后。finally 将始终运行并且不会被线程中止中断，只要在线程中止发生之前实际输入了 try。

以下场景，finally 不会运行：

**异步 StackOverflowException。**
从 .NET 2.0 开始，堆栈溢出将导致进程终止。finally 不会运行，除非应用进一步的约束以使 finally 成为 CER（受约束的执行区域）。CER 不应用于一般用户代码。它们只应在清理代码始终运行至关重要的情况下使用 - 在所有进程无论如何都会因堆栈溢出而关闭并且因此默认情况下将清理所有托管对象之后。因此，CER 唯一相关的地方是分配在进程之外的资源，例如非托管句柄。

通常，非托管代码在被用户代码使用之前由某个托管类包装。托管包装类通常会使用 SafeHandle 来包装非托管句柄。SafeHandle 实现了一个关键终结器和一个在 CER 中运行的 Release 方法，以保证清理代码的执行。出于这个原因，您不应该看到 CER 散布在整个用户代码中。

因此，finally 不在 StackOverflowException 上运行的事实应该对用户代码没有影响，因为该进程无论如何都会终止。如果您确实需要在 SafeHandle 或 CriticalFinalizerObject 之外清理一些非托管资源的边缘情况，则按如下方式使用 CER；但请注意，这是不好的做法——非托管概念应抽象为托管类和适当的 SafeHandle 设计。

例如，

```
// No code can appear after this line, before the try
RuntimeHelpers.PrepareConstrainedRegions();
try
{ 
    // This is *NOT* a CER
}
finally
{
    // This is a CER; guaranteed to run, if the try was entered, 
    // even if a StackOverflowException occurs.
} 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2018-01-29T14:36:10.043

有一个非常重要的例外，我在任何其他答案中都没有提到过，而且（在 C# 编程 18 年后）我不敢相信我不知道。

如果你在你的块中抛出或触发*任何*类型的异常`catch`（不仅仅是奇怪`StackOverflowExceptions`的和类似的东西），并且你没有将整个`try/catch/finally`块放在另一个`try/catch`块中，你的`finally`块将不会执行。这很容易证明 - 如果我自己没有看到它，考虑到我经常读到它只是非常奇怪的微小的角落案例，可能导致`finally`块不执行，我不会相信它。

```
static void Main(string[] args)
{
    Console.WriteLine("Beginning demo of how finally clause doesn't get executed");
    try
    {
        Console.WriteLine("Inside try but before exception.");
        throw new Exception("Exception #1");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"Inside catch for the exception '{ex.Message}' (before throwing another exception).");
        throw;
    }
    finally
    {
        Console.WriteLine("This never gets executed, and that seems very, very wrong.");
    }

    Console.WriteLine("This never gets executed, but I wasn't expecting it to."); 
    Console.ReadLine();
} 
```

我敢肯定这是有原因的，但奇怪的是它并没有更广为人知。（例如，[此处](https://stackoverflow.com/a/28483789/68231)已注明，但在此特定问题的任何地方都没有。）

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-02-26T08:25:46.027

我意识到我迟到了，但在确实抛出异常的情况下（不同于 OP 的示例）MSDN 状态（[https://msdn.microsoft.com/en-us/library/zwc8s4fz.aspx](https://msdn.microsoft.com/en-us/library/zwc8s4fz.aspx)）：**“如果没有捕获到异常，finally块的执行取决于**操作系统是否选择触发异常展开操作。”

finally 块只有在调用堆栈中的某些其他函数（例如 Main）捕获到异常时才能*保证执行。*这个细节通常不是问题，因为所有运行时环境（CLR 和 OS）C# 程序都在进程退出时拥有的大部分资源（文件句柄等）上运行。在某些情况下，它可能是至关重要的：您想要提交的数据库操作正在进行一半。放松; 或者一些远程连接可能不会被操作系统自动关闭，然后阻塞服务器。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-05T20:54:23.903

是的。这实际上是 finally 语句的要点。除非发生灾难性事件（内存不足、计算机拔掉电源等），否则应始终执行 finally 语句。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-07-01T12:33:47.287

它也不会触发未捕获的异常并在 Windows 服务中托管的线程中运行

[在 Windows 服务中运行的线程中时不执行 finally](https://stackoverflow.com/questions/31118912/finally-not-executed-within-threading-timer-in-combination-with-windows-service)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-07-03T06:18:36.507

如果您使用 System.exit(0) 退出应用程序，最终将不会运行；如在

```
try
{
    System.out.println("try");
    System.exit(0);
}
finally
{
   System.out.println("finally");
} 
```

结果将是：尝试

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-12-16T12:47:31.747

99% 的场景都可以保证`finally`块内的代码会运行，但是，请考虑以下场景：您有一个线程具有`try`->`finally`块（否`catch`）并且您在该线程中得到一个未处理的异常。在这种情况下，线程将退出并且它的`finally`块不会被执行（这种情况下应用程序可以继续运行）

这种情况非常罕见，但这只是表明答案并不总是“是”，大多数时候是“是”，有时在极少数情况下是“否”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-04-14T12:41:31.670

finally 块的主要目的是执行其中写入的任何内容。它不应该依赖于 try 或 catch 中发生的任何事情。但是使用 System.Environment.Exit(1) 应用程序将退出而不移动到下一行代码。

# visual-studio - 部署 windowsform 客户端应用程序但缺少程序集

> ID：345098
> 
> 赞同：0
> 
> 时间：2008-12-05T20:51:27.933
> 
> 标签：visual-studio, assemblies, gac

我正在尝试使用外部 dll 从报告应用程序中完成一个小模块。我将文件放入 bin 文件夹，但是当我使用 ClickOnce 部署应用程序并完成安装时，我发现所有外部 dll 都丢失了。例如，`Microsoft.SqlServer.Types version 10.0.0.0`缺少 。

有没有办法在客户端 GAC 中自动安装这些程序集？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-12T14:41:56.840

解决方案：使用单击一次时，转到项目属性，然后到部署选项卡并在所需文件中为您已经在项目或 Fx 中引用的任何程序集选择“包含”

# vb6 - 如何强制 VB6 使用 app 目录中的 DLL 和 OCX？

> ID：345111
> 
> 赞同：16
> 
> 时间：2008-12-05T20:57:01.290
> 
> 标签：vb6, regfreecom

我想把我的依赖文件放在 app 目录中。

我似乎记得您可以强制 VB6 仅使用本地目录中的文件。

有什么提示吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-08T18:47:41.800

您可能还想尝试为您的项目设置[Reg-Free COM](http://msdn.microsoft.com/en-us/magazine/cc188708.aspx)。有一个名为[Unattended Make My Manifest](https://github.com/wqweto/UMMM)的免费软件可以为您完成大部分工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-09T17:36:02.583

Clay Nichol 关于搜索顺序的回答并不完全正确。该搜索顺序仅适用于非 COM 组件。即只有一些DLL，而不是OCX。如果您注册您的 COM 对象，则无论本地目录中有什么，它们都将从注册它们的目录中使用，**除非**您使用无 reg 的 COM 或 .local 文件。

编辑：

[MakeMyManifest 被誉为](http://mmm4vb6.atom5.com/)为 VB6 项目创建清单的自动工具，我自己没有尝试过。 [DirectCOM](http://www.thecommon.net/10.html)也有粉丝，我也没试过。

*编辑*MMM 网站已关闭。我[在这里](http://web.archive.org/web/20140829021337/http://mmm4vb6.atom5.com/)看到作者在托管方面遇到了问题，并提供了另一个位置来获取 Make My Manifest -[在此处下载](https://app.box.com/s/yvm0wk95e1lachm7juf5)。

有一种半自动技术可以生成无注册的 COM 清单。您可以使用 Visual Studio 2008 创建清单（您可以使用免费版本，如 Visual Basic Express Edition）。然后手动进行一些编辑以使清单适用于 VB6。有关分步说明，请参阅[此 MSDN 文章的这一部分- 忽略有关 ClickOnce 的其余文章。](http://msdn.microsoft.com/en-us/library/aa697429(VS.80).aspx#atupvb6ap2_topic4)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-17T18:55:34.793

将组件库放在 EXE 文件夹中（带有或不带有 .local 文件）也可能对目标机器的卫生有害。

如果之前没有注册，VB6 程序将通过您背后的 self-reg 入口点在此处注册组件。然后，如果应用程序被移动或删除，您会给用户留下一个损坏的重新注册 - 对于随后使用某些相同组件安装的应用程序可能是致命的。这对于特定于应用程序的组件可能很好，即您自己的 DLL 或 OCX，其他应用程序**永远不会**需要。

.local 技巧实际上并不适用于 VB6 程序，如果使用它，您的安装程序需要了解并正确安装和注册组件（如果它们尚未在机器上）。它的目的是手动破解单个机器上的 DLL 版本兼容性问题，而不是部署策略。

升级到 SxS 应用程序和程序集清单（Reg-Free COM 等）以获得更好的解决方案。DLL/COM 重定向 (.local) 是一个很好的尝试，但它有很多缺点。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-06T08:09:55.630

这可能有点令人困惑，因为每个版本的 Windows，规则都会改变。旧版本的 Windows 在当前目录之前搜索路径。

一个没有清单的简单解决方案：

如果您的可执行文件是`A.EXE`，请在名为 -- 对于旧版本的 Windows 的同一目录中添加一个（0 字节，空）文件，`A.EXE.local`这会将应用程序目录放在搜索顺序中的路径之前。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-05T21:11:43.477

自己找到的：

Windows 确实会先查看 App Directory：如果启用了 SafeDllSearchMode，则搜索顺序如下：

1.  加载应用程序的目录。
2.  系统目录。使用 GetSystemDirectory 函数获取该目录的路径。
3.  16 位系统目录。没有函数获取这个目录的路径，但是被搜索了。
4.  Windows 目录。使用 GetWindowsDirectory 函数获取该目录的路径。
5.  当前目录。
6.  PATH 环境变量中列出的目录。请注意，这不包括 App Paths 注册表项指定的每个应用程序路径。计算 DLL 搜索路径时不使用 App Paths 键。

如果禁用 SafeDllSearchMode，则搜索顺序如下：

*1\. 加载应用程序的目录。2\. 当前目录。3.系统目录。使用 GetSystemDirectory 函数获取该目录的路径。4\. 16位系统目录。没有函数获取这个目录的路径，但是被搜索了。5\. Windows 目录。使用 GetWindowsDirectory 函数获取该目录的路径。6\. PATH 环境变量中列出的目录。请注意，这不包括 App Paths 注册表项指定的每个应用程序路径。计算 DLL 搜索路径时不使用 App Paths 键。*

根据：http: [//msdn.microsoft.com/en-us/library/ms682586.aspx](http://msdn.microsoft.com/en-us/library/ms682586.aspx)

但是您可以使用 Manifest 重定向查找 .dll 的位置：

[http://msdn.microsoft.com/en-us/library/aa375365(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa375365(VS.85).aspx)

# asp.net - 我是否需要取消订阅（手动订阅）asp.net 中的事件？

> ID：345130
> 
> 赞同：5
> 
> 时间：2008-12-05T21:03:51.607
> 
> 标签：asp.net, events, garbage-collection, page-lifecycle

关于订阅/取消订阅事件的最佳实践规则是否适用于 asp.net？

我知道这可能看起来像一个愚蠢的问题，但是当我想到它时，我从未真正见过人们首先订阅页面上的事件然后稍后在 Web 请求中取消订阅的任何代码。

示例 1：在页面上，在 Page_Load 方法中，我订阅了 ListView 上的更新事件。我是否应该稍后取消订阅该事件，例如在 OnPreRenderComplete 方法中？

示例 2：在被动视图模式中，视图（页面控件/用户控件）将在需要演示者执行任何操作时引发事件。所以presenter需要订阅视图上的事件，但是是否也需要再次取消订阅事件呢？

最好的问候，埃吉尔。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T21:22:17.590

当请求完成时，页面实例及其所有组件将“超出范围”，例如它们有资格进行 GC。因此，您的 ListView 将连同其上的页面/用户控件一起超出范围。您不需要取消订阅（例如，除非您订阅了属于某种单例的事件，该单例在每个请求中都存在并使用页面的一种方法作为事件处理程序）。

同样的事情对演示者有效（同样，只要此演示者仅用于一页并且之后超出范围）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T21:07:48.400

一般来说，没有。页面卸载时应该自动转储事件。应该是。我之前（在 .NET 1.1 中）遇到过一个错误，但情况并非如此。

除非我注意到页面有问题，否则我不会取消订阅（例如，从调用堆栈中的幻象调用了 20 次方法：这通常表明某些内容未正确取消订阅）。

# asp.net - 如何在 VS2008/VSS8.0/ASP.NET/IIS 上运行两个并发 Web 应用程序，用于主干和分支版本？

> ID：345133
> 
> 赞同：1
> 
> 时间：2008-12-05T21:03:54.133
> 
> 标签：asp.net, visual-studio, iis, visual-sourcesafe

我正在使用的应用程序：Visual Studio 2008 (C#/ASP.NET) Visual Source Safe 8.0 IIS 5.1

我有两个名称相同的 Web 应用程序，但一个用于主要版本，另一个用于次要版本（主干和分支）。我想知道 Visual Studio 中是否有一个选项可以阻止它使用 Web 应用程序的项目名称在 IIS 中创建 ASP.NET 应用程序。由于它们的名称相同，我必须进入 IIS 并更改应用程序的路径，以便当我在两者之间切换时它指向主要（或次要）文件夹。

我想做的是有这样的事情：

```
http://localhost/webapp_major
http://localhost/webapp_minor 
```

但是 Web 项目仍然具有相同的名称。我知道我可以进入每个项目文件的属性并让它们指向不同的位置，但我认为当你想在两者之间合并时会破坏一些东西。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T21:11:57.550

不要在您的 Visual Studio 解决方案中使用基于 HTTP 的项目，而是将它们添加为文件项目，其中网站将在 Visual Studio 中以 c:\inetput\wwwroot\major_version （例如）访问（而不是[http://localhost](http://localhost)）。这样，您可以在 IIS 中进行任何类型的设置，并且在合并它们时您的项目不会发生冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T00:20:37.120

您的 Web 应用程序项目将允许您将虚拟目录命名为任何您想要的名称。VS2008 扩展了这一点，允许您在每个用户的基础上进行设置，因此这些信息不会保存在项目文件中，因此不会传播到源代码管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T08:23:35.793

您可以在 IIS 中手动创建一个新的 Web 应用程序并让它指向您的工作目录。Visual Studio 应该遵守这些设置。

# windows - 如何以编程方式分析（和更改）IIS 的配置

> ID：345139
> 
> 赞同：2
> 
> 时间：2008-12-05T21:05:48.340
> 
> 标签：windows, iis, scripting, shell, wsh

我对 Windows Server 世界比较陌生（来自 *nix 领域）。我习惯于通过 grepping 通过 apache 配置文件来分析 Web 服务器的配置。

IIS 是否有等效的文件/文件组？缺少这些，是否有 IIS 的官方脚本接口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T21:31:17.947

PowerShell 将是要走的路。

以下是一些堆栈溢出帖子：

[https://stackoverflow.com/questions/tagged/powershell+iis6](https://stackoverflow.com/questions/tagged/powershell+iis6)

此外，谷歌搜索**powershell IIS**将帮助您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T04:55:04.053

IIS 中的默认脚本工具是 \InetPubs\Scripts 目录中的 ADSUTIL.VBS 脚本。

[使用 Adsutil.vbs 管理脚本](http://technet.microsoft.com/en-us/library/cc781546.aspx)

您几乎可以使用该工具对 IIS 元数据库执行任何操作。

# windows - 如何模拟键盘输入到远程桌面会话？

> ID：345147
> 
> 赞同：9
> 
> 时间：2008-12-05T21:09:24.417
> 
> 标签：windows, automation, timeout, remote-desktop

我正在尝试将假键盘输入发送到在远程桌面会话中运行的应用程序。我正在使用：

```
Byte key = Ord("A");

keybd_event(key, 0, 0, 0); // key goes down
keybd_event(key, 0, KEYEVENTF_KEYUP, 0); // key goes up 
```

现在此代码确实将字符“a”发送到任何本地窗口，但不会发送到远程桌面窗口。

这意味着我使用远程桌面连接到服务器，然后在该服务器上打开记事本。如果我在键盘上手动敲击键：它们出现在记事本的编辑器窗口中。但是 keybd_event 的假键盘输入不会导致“a”出现在记事本中。

如何从本地计算机上运行的应用程序以编程方式将假键盘输入发送到在远程桌面连接中运行的应用程序？

* * *

**吹毛求疵的角落**

在这种特殊情况下，我想这样做，因为我试图击败空闲超时。但我也可以尝试

*   执行 UI 自动化测试
*   界面压力测试
*   UI 故障查找测试
*   界面单元测试
*   UI 数据输入测试
*   UI 绘画测试
*   或 UI 弹性测试。

换句话说，我想要它的理由并不重要

**注意：**超时可能来自远程桌面不活动，也可能不是。我不知道，这不影响我的问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-05T21:54:56.493

## 回答

尽管 Microsft 说您不需要也不[应该](http://msdn.microsoft.com/en-us/library/aa453245.aspx)发送 OEM 代码，但您需要发送 OEM 扫描代码。在这个例子中，我需要发送 OEM 扫描码

*   键 A 下降
*   A键上升

CodeProject 上有[一张图表图片，](http://msdn.microsoft.com/en-us/library/aa453245.aspx)其中列出了各种键的成败扫描代码：

![替代文字](https://www.codeproject.com/KB/system/keyboard/keyboard1.jpg)

在我的情况下，对 keybd_event 的原始调用需要更改为：

```
Byte key = Ord("A");

keybd_event(key, 0x1E, 0, 0); // key goes down
keybd_event(key, 0x9E, KEYEVENTF_KEYUP, 0); // key goes up 
```

我对此进行了测试，并且可以正常工作。所以一切都很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T21:16:29.770

也许您可以使用**[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)**[执行autoit](http://www.autoitscript.com/autoit3/)脚本，这是一个轻量级的 telnet 替换，可让您在其他系统上执行进程，并与控制台应用程序完全交互，而无需手动安装客户端软件。

（AutoIt 非常有能力将任何信号（键或其他）发送到任何窗口应用程序，并且可以在远程桌面上使用 PsExec 启动）

[例如，像KillSaver](http://www.autoitscript.com/forum/index.php?showtopic=13075)这样的 AutoIt 脚本旨在移动鼠标以避免延长计算机的空闲时间！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-25T06:49:38.570

这很好用，谢谢。为了获得键盘扫描码，可以使用：

```
int scan;
scan = MapVirtualKey(key & 0xff, 0);
keybd_event(key, scan, 0, 0); // key goes down
keybd_event(key, scan | 0x80, KEYEVENTF_KEYUP, 0); // key goes up 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-22T10:45:00.647

您可以使用 SendMessage(); 它确实是一个更好的按键模拟器。好吧，祝你好运！

# asp.net - 如何在注销时清除会话

> ID：345157
> 
> 赞同：63
> 
> 时间：2008-12-05T21:12:58.623
> 
> 标签：asp.net, .net, asp.net-session

当用户单击注销时，我将用户重定向到登录页面，但是我认为它不会清除任何应用程序或会话，因为当用户重新登录时所有数据都会保留。

目前登录页面有一个登录控件，页面后面的代码只是连接登录验证。

有人可以指导我阅读有关处理登录和退出 ASP.NET 网站的好教程或文章吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-12-05T21:15:51.177

```
Session.Abandon() 
```

[http://msdn.microsoft.com/en-us/library/ms524310.aspx](http://msdn.microsoft.com/en-us/library/ms524310.aspx)

`HttpSessionState`以下是有关该对象的更多详细信息：

[http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate_members.aspx](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate_members.aspx)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2014-11-14T18:13:58.127

我使用以下来清除会话并清除`aspnet_sessionID`：

```
HttpContext.Current.Session.Clear();
HttpContext.Current.Session.Abandon();
HttpContext.Current.Response.Cookies.Add(new HttpCookie("ASP.NET_SessionId", "")); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-12-05T21:18:21.060

我会选择`Session.Abandon()`

`Session.Clear()`不会导致 End 触发，来自客户端的进一步请求也不会引发 Session Start 事件。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-08-18T09:36:25.113

`Session.Abandon()`销毁会话并`Session_OnEnd`触发事件。

`Session.Clear()`只是从对象中删除所有值（内容）。`session with the same key`还在`alive`。_

因此，如果您使用`Session.Abandon()`，您将丢失该特定会话，并且用户将获得一个`new session key`. 例如，当用户`logs out`.

使用`Session.Clear()`，如果您希望用户留在同一会话中（例如，如果您不希望他重新登录）并重置他的所有会话特定数据。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-01-19T05:29:42.787

对于 .NET Core，清除会话的方式略有不同。没有`Abandon()`功能。

**ASP.NET Core 1.0 或更高版本**

```
//Removes all entries from the current session, if any. The session cookie is not removed.
HttpContext.Session.Clear() 
```

[请参阅此处的 api 参考](https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.isession?view=aspnetcore-2.0#Methods)

**.NET Framework 4.5 或更高版本**

```
//Removes all keys and values from the session-state collection.
HttpContext.Current.Session.Clear(); 

//Cancels the current session.
HttpContext.Current.Session.Abandon(); 
```

[请参阅此处的 api 参考](https://docs.microsoft.com/en-us/dotnet/api/system.web.sessionstate.httpsessionstate?view=netframework-4.7.1#Methods)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-25T12:33:20.797

```
<script runat="server">  
    protected void Page_Load(object sender, System.EventArgs e) {  
        Session["FavoriteSoftware"] = "Adobe ColdFusion";  
        Label1.Text = "Session read...<br />";  
        Label1.Text += "Favorite Software : " + Session["FavoriteSoftware"];  
        Label1.Text += "<br />SessionID : " + Session.SessionID;  
        Label1.Text += "<br> Now clear the current session data.";  
        Session.Clear();  
        Label1.Text += "<br /><br />SessionID : " + Session.SessionID;  
        Label1.Text += "<br />Favorite Software[after clear]: " + Session["FavoriteSoftware"];  
    }  
</script>  

<html xmlns="http://www.w3.org/1999/xhtml">  
<head id="Head1" runat="server">  
    <title>asp.net session Clear example: how to clear the current session data (remove all the session items)</title>  
</head>  
<body>  
    <form id="form1" runat="server">  
    <div>  
        <h2 style="color:Teal">asp.net session example: Session Clear</h2>  
        <asp:Label   
            ID="Label1"   
            runat="server"   
            Font-Size="Large"  
            ForeColor="DarkMagenta"  
            >  
        </asp:Label>  
    </div>  
    </form>  
</body>  
</html> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-13T07:08:49.180

session.abandon() 不会从浏览器中删除 sessionID cookie。因此，此后的任何新请求都将采用相同的会话 ID。因此，使用 Response.Cookies.Add(new HttpCookie("ASP.NET_SessionId", "")); 在 session.abandon() 之后。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T21:14:36.967

会话.清除（）；

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-01-06T06:00:43.640

转到项目中的文件**Global.asax.cs**并添加以下代码。

```
 protected void Application_BeginRequest()
    {
        Response.Cache.SetCacheability(HttpCacheability.NoCache);
        Response.Cache.SetExpires(DateTime.Now.AddHours(-1));
        Response.Cache.SetNoStore();
    } 
```

它对我有用..！参考链接 [Clear session on Logout MVC 4](https://stackoverflow.com/questions/27738174/clear-session-on-logout-mvc-4)

# nhibernate - 如何在长期存在的 Windows 窗体应用程序中管理 NHibernate 会话？

> ID：345160
> 
> 赞同：10
> 
> 时间：2008-12-05T21:14:10.803
> 
> 标签：nhibernate

我们正在使用 NHibernate 来管理我们在复杂的模块化 Windows 窗体应用程序中的持久性 - 但一个想法一直困扰着我。我们目前在启动时打开一个会话并通过该会话打开所有对象。我担心所有加载的对象都被加载到 NHibernate 会话缓存中，因此它们不能被垃圾收集，最终我们将整个数据库都放在内存中。

Web 应用程序永远不会发生这种情况，因为网页请求（甚至更好的 Ajax 请求）代表了完美的短暂事务，因此可以打开和关闭会话来处理每个请求。

但是，如果我在表单应用程序中加载对象树，然后将其放入屏幕上的导航窗格中，它们可能会在应用程序的整个生命周期内保持不变 - 并且在任何时候用户都可以点击它们，导致我们的代码需要将对象关系导航到其他对象（仅在 NHibernate 会话中有效）。

StackOverflow 读者如何在没有我描述的问题的情况下保持 NHibernate 的好处？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T22:52:39.857

Ayende 和公司通常建议每次“对话”使用一个会话。这通常会使会话生命周期持续很短的操作，因此它的行为更像是一个 Web 应用程序。

对于您的树案例，您可以使用 Bruno 的解决方案 #2 就好了。对象可以被延迟映射。然后，每次您需要访问子集合时，您都会开始对话并通过 ISession.Lock 重新连接父集合。然后当数据绑定完成后，关闭该会话。不需要太多维护开销，只需几行任何形式的代码即可进行对话；如果您觉得很时髦，您可以扩展 Form 和您使用的控件来自动执行此操作。

因此，棘手的部分是来自不同会话的并发编辑。我们不要去那里！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T22:56:07.943

当我需要一个会话时我会打开它，当我知道我不再需要它时我会关闭它。

更具体地说，例如，如果我有一个允许我编辑客户信息的表单，我将在表单实例化时打开一个会话，并在表单关闭时关闭会话。当我打开该表单的 2 个实例时，我也打开了 2 个会话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T02:38:21.120

我可以看到几个替代方案：

1.  急切加载对象树（从我可以从[文档](http://nhforge.org/doc/nh/en/#collections-lazy)中收集到的是默认值）
2.  分离对象，拦截“点击”事件，然后使用新会话从数据库加载数据。这迫使您自己处理集合，而不是依赖 nhibernate，这可能超出了问题的范围（它要求 NHibernate 的好处，其中之一是集合管理）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T14:27:28.987

您可以查看我的帖子，了解如何使用 uNHAddins 在 Windows 窗体应用程序中处理每个对话的会话（uNHAddins 是一个项目，由现任 NH 负责人 Fabio Maulo 领导，对 NHibernate 进行了一些补充）

第一个帖子是这个

[http://gustavoringel.blogspot.com/2009/02/unhaddins-persistence-conversation-part.html](http://gustavoringel.blogspot.com/2009/02/unhaddins-persistence-conversation-part.html)

从那里你有到 uNHAddins 主干的链接。

# c# - 有没有办法捕捉 ContainsFocus 的变化？

> ID：345174
> 
> 赞同：0
> 
> 时间：2008-12-05T21:18:11.357
> 
> 标签：c#, winforms, events

我需要能够确定何时`ContainsFocus`更改`Control`（特别是 Windows 窗体）。覆盖`OnGotFocus`不是答案。当我把表格带到前台时，`ContainsFocus`是真的`Focused`还是假的。那么有没有`OnGotFocus`等价的`ContainsFocus`？还是有什么其他方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T22:18:08.757

注意：如果您有子控件，则会触发子控件的 GotFocus 事件。否则调用表单的 OnGotFocus。

如果我正确理解了这个问题，那么这应该有效：

```
 bool lastNotificationWasGotFocus = false;

    protected override void OnControlAdded(ControlEventArgs e)
    {
        SubscribeEvents(e.Control);
        base.OnControlAdded(e);
    }

    protected override void OnControlRemoved(ControlEventArgs e)
    {
        UnsubscribeEvents(e.Control);
        base.OnControlRemoved(e);
    }

    private void SubscribeEvents(Control control)
    {
        control.GotFocus += new EventHandler(control_GotFocus);
        control.LostFocus += new EventHandler(control_LostFocus);
        control.ControlAdded += new ControlEventHandler(control_ControlAdded);
        control.ControlRemoved += new ControlEventHandler(control_ControlRemoved);

        foreach (Control innerControl in control.Controls)
        {
            SubscribeEvents(innerControl);
        }
    }

    private void UnsubscribeEvents(Control control)
    {
        control.GotFocus -= new EventHandler(control_GotFocus);
        control.LostFocus -= new EventHandler(control_LostFocus);
        control.ControlAdded -= new ControlEventHandler(control_ControlAdded);
        control.ControlRemoved -= new ControlEventHandler(control_ControlRemoved);

        foreach (Control innerControl in control.Controls)
        {
            UnsubscribeEvents(innerControl);
        }
    }

    private void control_ControlAdded(object sender, ControlEventArgs e)
    {
        SubscribeEvents(e.Control);
    }

    private void control_ControlRemoved(object sender, ControlEventArgs e)
    {
        UnsubscribeEvents(e.Control);
    }

    protected override void OnGotFocus(EventArgs e)
    {
        CheckContainsFocus();
        base.OnGotFocus(e);
    }

    protected override void OnLostFocus(EventArgs e)
    {
        CheckLostFocus();
        base.OnLostFocus(e);
    }

    private void control_GotFocus(object sender, EventArgs e)
    {
        CheckContainsFocus();
    }

    private void control_LostFocus(object sender, EventArgs e)
    {
        CheckLostFocus();
    }

    private void CheckContainsFocus()
    {
        if (lastNotificationWasGotFocus == false)
        {
            lastNotificationWasGotFocus = true;
            OnContainsFocus();
        }
    }

    private void CheckLostFocus()
    {
        if (ContainsFocus == false)
        {
            lastNotificationWasGotFocus = false;
            OnLostFocus();
        }
    }

    private void OnContainsFocus()
    {
        Console.WriteLine("I have the power of focus!");
    }

    private void OnLostFocus()
    {
        Console.WriteLine("I lost my power...");
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T21:19:38.733

解决此问题的一种方法是使用计时器。这绝对是蛮力，但它完成了工作：

```
private Timer m_checkContainsFocusTimer = new Timer();
private bool m_containsFocus = true;

m_checkContainsFocusTimer.Interval = 1000; // every second is good enough
m_checkContainsFocusTimer.Tick += new EventHandler(CheckContainsFocusTimer_Tick);
m_checkContainsFocusTimer.Start();

private void CheckContainsFocusTimer_Tick(object sender, EventArgs e)
{
    if (!m_containsFocus && ContainsFocus)
        OnAppGotFocus();

    m_containsFocus = ContainsFocus;
} 
```

但是有没有更简单的方法？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T21:23:12.830

处理 GotFocus 和 LostFocus 事件应该这样做。

另一件需要注意的事情...... SDK 对 ContainsFocus 属性进行了说明：

> 您可以使用此属性来确定控件或其中包含的任何控件是否具有输入焦点。若要确定控件是否具有焦点，无论其任何子控件是否具有焦点，请使用 Focused 属性。

编辑：

处理 GotFocus 事件时，您可能仍需要检查 Focused/ContainsFocus 属性，具体取决于控件层次结构的设置方式。

*如果控件或其任何子*控件具有焦点，则 ContainsFocus 将为真。仅当特定控件本身具有焦点时，焦点才会为真，而不管其子控件如何。

# vba - 关于 VB6/VBA 中 CreateObject() 的问题

> ID：345178
> 
> 赞同：13
> 
> 时间：2008-12-05T21:19:43.727
> 
> 标签：vba, vb6, late-binding, createobject

我可以做这个：

```
Dim fso As New FileSystemObject 
```

或者我可以这样做：

```
Dim fso As Object
Set fso = CreateObject("Scripting.FileSystemObject") 
```

我如何知道 CreateObject 使用什么字符串？例如，我怎么会知道使用“脚本”。“Scripting.FileSystemObject”的一部分？你去哪里查这个？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-05T21:22:02.693

它是在 Windows 注册表中 HKCR 键下注册的组件的[ProgID ：](http://www.vbaccelerator.com/progid.htm)

```
HKEY_CLASSES_ROOT\Scripting.FileSystemObject 
```

ProgID 是 COM 对象的人类可读标识符。它们指向实际的 CLSID，在本例中为：

```
HKEY_CLASSES_ROOT\CLSID\{0D43FE01-F093-11CF-8940-00A0C9054228} 
```

这是您可以找到包含组件实现的实际 COM .dll 的地方。

在您提供的第一个示例代码中，您正在执行早期绑定，而在第二个示例代码中，您正在执行后期绑定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T10:55:56.540

使用 VB6 IDE，选择 Project、References，然后选择引用“Microsoft Scripting Runtime”。

如果您不知道引用的名称，您可以使用“引用”对话框的“浏览”按钮选择文件 /system 32/scrrun.dll。

选择参考后，关闭参考对话框，然后打开对象浏览器（视图菜单）。将下拉列表更改为最有可能的候选者，即“脚本”。这将显示库的类，其中之一是“FileSystemObject”。因此，您会发现 CreateObject 所需的字符串是“Scripting.FileSystemObject”。

如果您不知道引用名称或文件名，但您知道类名，那么您可以在注册表中搜索“FileSystemObject”，很快就会发现您需要的完全限定名称是“Scripting.FileSystemObject” .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T21:35:20.030

[我将首先在http://msdn.microsoft.com/library](http://msdn.microsoft.com/library)的 MSDN 库中搜索 FileSystemObject

该站点充满了文档，包括如何调用 CreateObject 的详细信息。

# deployment - 如何从 Windows 的命令提示符中删除文件夹的内容？

> ID：345179
> 
> 赞同：0
> 
> 时间：2008-12-05T21:19:48.297
> 
> 标签：deployment, command-line, msbuild

我正在使用 MSBuild 编写部署脚本。我想在复制所有新文件之前清理我的 Web 目录。我当前的“清理”目标如下所示：

```
 <Target Name="Clean">
    <Exec Command="del %(DeploymentSet.LocalWebRoot)\* /Q /F /S" IgnoreExitCode="true" />
  </Target> 
```

这需要相当长的时间，因为每个文件都是从每个子文件夹中单独删除的。

有没有一种很好的方法可以从给定文件夹中删除所有内容而不删除该文件夹？我想维护我的权限和 vdir 设置信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T21:27:42.900

您可以`rmdir /s /q`单独将每个子目录，然后是`del %(DeploymentSet.LocalWebRoot)\* /Q /F`您的干净目标。例如：

```
 <Target Name="Clean">
    <Exec Command="rmdir %(DeploymentSet.LocalWebRoot)\subdir1 /Q /S" IgnoreExitCode="true" />
    <Exec Command="rmdir %(DeploymentSet.LocalWebRoot)\subdir2 /Q /S" IgnoreExitCode="true" />
    ...
    <Exec Command="rmdir %(DeploymentSet.LocalWebRoot)\subdirN /Q /S" IgnoreExitCode="true" />
    <Exec Command="del %(DeploymentSet.LocalWebRoot)\* /Q /F" IgnoreExitCode="true" />
  </Target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T08:25:44.357

如果您不想指定每个子目录的名称，请使用：

```
<Target Name="Clean">
    <Exec Command="del /F /Q %(DeploymentSet.LocalWebRoot)\*.*" />
    <Exec Command="for /d /r &quot;%(DeploymentSet.LocalWebRoot)&quot; %v IN (*) DO rd /S /Q &quot;%v&quot;" />
</Target> 
```

# .net - 在 VBScript 中访问自定义 .NET DLL

> ID：345180
> 
> 赞同：8
> 
> 时间：2008-12-05T21:20:31.307
> 
> 标签：.net, dll, vbscript, dllregistration

我在 .NET 中编写了一个 DLL，我想在 VBScript 中访问它。我不想将它添加到程序集目录中。

有没有办法指向 DLL 并创建它的实例？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-19T11:14:47.810

我只需要自己做，我的发现是：

使类型对 COM 可见：

1.  确保您的类是公共的、非静态的并且具有公共的默认构造函数，即不是参数。
2.  确保您的方法是公开的、非静态的。
3.  确保您的程序集具有以下设置 - 通常在 AssemblyInfo.cs 中

    ```
    [assembly: ComVisible(true)] 
    ```

4.  构建 DLL 后，从 SDK 命令行运行：

    ```
    regasm yourdll.dll 
    ```

    这应该回应：

    > 类型注册成功

    如果你得到

    > RegAsm：警告 RA0000：未注册任何类型

    那么您需要设置`ComVisible`或没有公共的非静态类型。

**从 PowerShell**

```
$a = New-Object -comobject Your.Utils.Logging
$a.WriteError2("Application", "hello",1,1) 
```

**来自 vbs**

```
Set logger = CreateObject("Your.Utils.Logging")
logger.WriteError2 "Application", "hello from vbs",1,1 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-07T16:37:25.680

huseyint 的回答是关于钱，但是，我想补充一点。这是我用于这个问题的一些示例代码，也许它可以加快你的速度......

```
// bind a variabe to WScript.Shell
Set WshShell = CreateObject("WScript.Shell")

// define the path to the regasm.exe file
RegAsmPath = "c:\Windows\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe"

// register the dll
WshShell.run "cmd /c " & RegAsmPath & " c:\temp\cbsecurity.dll /codebase /nologo /s", 0, True

// bind a variable to the dll
Set cbUtil = CreateObject("CBSecurity.Utilities") 
```

我在 dll 中包含了一个 IsAlive 方法...

```
Public Function IsAlive() As Boolean
    Return True
End Function 
```

...并且可以使用以下语法检查它是否正确注册：

```
//check if dll is available to your code
msgbox "cbUtil is alive: " & cbUtil.IsAlive 
```

希望这可以帮助某人...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-05T21:38:43.750

您可以通过指定参数向[regasm 实用程序](http://msdn.microsoft.com/en-us/library/tzat5yw6.aspx)注册该 .NET dll 。`/codebase`不鼓励将此参数与未签名的程序集一起使用，但当您无法将程序集放入 GAC 时它可以工作。

```
regasm your.dll /codebase 
```

请注意，您不应在此操作后更改 .dll 的路径，因为它会将此路径插入 Windows 注册表。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-08-23T20:45:09.533

如果有人需要调试/单步执行仅从 VBScript 调用的 .Net dll：

1.  在 .Net dll 项目调试设置屏幕上，通过浏览到 wscript.exe 程序（位于 C:\WINDOWS\system32\wscript.exe）设置“启动外部程序”。

2.  在“命令行参数”中，设置 VBScript 文件的文件名和路径位置 (C:\Test\myTest.vbs)。确保 vbs 文件和 dll 文件位于同一位置。

3.  最后，在 .Net 项目 DLL 源代码中设置断点并点击“开始调试”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T21:25:28.053

不是直接的。您将需要一个 COM 可调用包装器来连接您将从 COM（以及因此 VBScript）调用的任何 .NET 库。因此，您应该直接为 DLL 创建一个 CCW，或者您可以为代理 DLL 创建一个 CCW，该代理 DLL 提供了加载 .NET DLL 的通用方法，并为您提供了调用组件上的实际方法并返回结果的方法。真的一点都不干净。所以，总的来说，答案是否定的。

# c# - 返回空集合

> ID：345185
> 
> 赞同：5
> 
> 时间：2008-12-05T21:22:12.037
> 
> 标签：c#, linq

看看这个测试：

```
[TestFixture]
public class Quick_test
{
   [Test]
   public void Test()
   {
      Assert.AreEqual(0, GetByYield().Count());
      Assert.AreEqual(0, GetByEnumerable().Count());
   }

   private IEnumerable<string> GetByYield()
   {
      yield break;
   }

   private IEnumerable<string> GetByEnumerable()
   {
      return Enumerable.Empty<string>();
   }
} 
```

当我编写存根方法时，我通常使用 Enumerable.Empty 方法。我偶然发现了一些我写的旧代码，我是用 yield 方式做的。

这让我想知道：

*   哪个对其他开发人员更具视觉吸引力？
*   是否有任何隐藏的陷阱会导致我们更喜欢一个而不是另一个？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T21:44:17.500

我更喜欢向开发人员提供最清晰含义的任何方法。就个人而言，我什至不知道***产量突破是什么；***行确实如此，因此在我的任何代码库中都首选返回“Enumerable.Empty();”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-06T18:30:51.413

[Enumerable.Empty](http://msdn.microsoft.com/en-us/library/bb341042.aspx) : the documentation claims that it "caches an empty sequence". Reflector confirms. If caching behavior matters to you, there's one advantage for Enumerable.Empty

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T21:26:22.933

更快的可能是：

```
T[] e = {};
return e; 
```

# math - 数学 - 映射数字

> ID：345187
> 
> 赞同：112
> 
> 时间：2008-12-05T21:22:21.053
> 
> 标签：math, numbers, mapping, interpolation, linear-algebra

如何在 a 和 b 之间线性映射数字以在 c 和 d 之间移动。

也就是说，我希望 2 到 6 之间的数字映射到 10 到 20 之间的数字......但我需要广义的情况。

我的大脑被炸了。

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2008-12-05T21:28:03.523

如果您的数字 X 介于 A 和 B 之间，并且您希望 Y 介于 C 和 D 之间，则可以应用以下线性变换：

```
Y = (X-A)/(B-A) * (D-C) + C 
```

这应该给你你想要的，虽然你的问题有点模棱两可，因为你也可以在相反的方向上映射间隔。只要注意被零除，你应该没问题。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-05T21:28:01.353

除以得到两个范围大小之间的比率，然后减去初始范围的起始值，乘以比率并添加第二个范围的起始值。换句话说，

```
R = (20 - 10) / (6 - 2)
y = (x - 2) * R + 10 
```

这将第一个范围的数字均匀地分布在第二个范围内。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-12-11T15:56:39.460

在课堂上拥有这个功能会很好`java.lang.Math`，因为这是一个广泛需要的功能，并且可以在其他语言中使用。这是一个简单的实现：

```
final static double EPSILON = 1e-12;

public static double map(double valueCoord1,
        double startCoord1, double endCoord1,
        double startCoord2, double endCoord2) {

    if (Math.abs(endCoord1 - startCoord1) < EPSILON) {
        throw new ArithmeticException("/ 0");
    }

    double offset = startCoord2;
    double ratio = (endCoord2 - startCoord2) / (endCoord1 - startCoord1);
    return ratio * (valueCoord1 - startCoord1) + offset;
} 
```

我把这段代码放在这里作为自己未来的参考，可能会对某人有所帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-05T23:57:35.763

顺便说一句，这与经典的将摄氏度转换为华氏度的问题相同，您想要映射一个等于 0 - 100 (C) 到 32 - 212 (F) 的数字范围。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-03-17T22:23:27.247

[https://rosettacode.org/wiki/Map_range](https://rosettacode.org/wiki/Map_range)

```
[a1, a2] => [b1, b2]

if s in range of [a1, a2]

then t which will be in range of [b1, b2]

t= b1 + ((s- a1) * (b2-b1))/ (a2-a1) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-19T10:57:19.977

除了@PeterAllenWebb 答案，如果您想反转结果，请使用以下命令：

```
reverseX = (B-A)*(Y-C)/(D-C) + A 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-05T21:31:32.690

第一个范围上的每个单位间隔占用第二个范围上的 (dc)/(ba)“空间”。

伪：

```
var interval = (d-c)/(b-a)
for n = 0 to (b - a)
    print c + n*interval 
```

如何处理舍入取决于您。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-10-13T16:03:03.190

其中**X**是从**A** - **B**映射到**C** - **D**的数，**Y**是结果：采用线性插值公式，lerp( *a* , *b* , *m* )= *a* +( *m* *( *b* - *a* ))，并且用**C**和**D**代替*a*和*b*得到**Y** = **C** +( *m* *( **D** - **C** ))。然后，代替*m*，将 ( **X** -**A** )/( **B** - **A** ) 得到**Y** = **C** +((( **X** - **A** )/( **B** - **A** ))*( **D** - **C** ))。这是一个不错的地图功能，但可以简化。取 ( **D** - **C** ) 部分，并将其放在被除数内，得到**Y** = **C** +((( **X** - **A** )*( **D** - **C** ))/( **B** - **A** ))。这给了我们另一个可以简化的部分， ( **X** - **A** )*( **D**- **C** )，相当于 ( **X** * **D** )-( **X** * **C** )-( **A** * **D** )+( **A** * **C** )。弹出它，你得到**Y** = **C** +((( **X** * **D** )-( **X** * **C** )-( **A** * **D** )+( **A** * **C** ))/( **B** - **A** ))。您需要做的下一件事是添加 + **C**位。为此，您将**C**乘以( **B** - **A**) 得到 (( **B** * **C** )-( **A** * **C** ))，并将其移入被除数中得到**Y** =((( **X** * **D** )-( **X** * **C** )-( **A** * **D** )+( **A** * **C** )+( **B** * **C** )-( **A** * **C** ))/( **B** - **A** ))。这是多余的，包含一个 +( **A** * **C** ) 和一个 -( **A** * **C** )，它们相互抵消。删除它们，您将获得以下最终结果：**Y** =(( **X** * **D** )-( **X** * **C** )-( **A** * **D** )+( **B** * **C** ))/( **B** - **A** )

TL;DR：标准映射函数**Y** = **C** +((( **X** - **A** )/( **B** - **A** ))*( **D** - **C** )) 可以简化为**Y** =(( **X** * **D** )-( **X** * **C** )-( **A** * **D** )+( **B** * **C** ))/( **B** - **A** )

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-01-09T07:51:21.747

如果您的范围从 [a 到 b] 并且您想将其映射到 [c 到 d] 中，其中 x 是您要映射的值，请使用此公式（线性映射）

```
double R = (d-c)/(b-a)
double y = c+(x*R)+R
return(y) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-05T23:28:22.063

```
int srcMin = 2, srcMax = 6;
int tgtMin = 10, tgtMax = 20;

int nb = srcMax - srcMin;
int range = tgtMax - tgtMin;
float rate = (float) range / (float) nb;

println(srcMin + " > " + tgtMin);
float stepF = tgtMin;
for (int i = 1; i < nb; i++)
{
  stepF += rate;
  println((srcMin + i) + " > " + (int) (stepF + 0.5) + " (" + stepF + ")");
}
println(srcMax + " > " + tgtMax); 
```

当然，检查除以零。

# jquery - jQuery中的正则表达式字段验证

> ID：345194
> 
> 赞同：76
> 
> 时间：2008-12-05T21:24:09.270
> 
> 标签：jquery, regex

在 jQuery 中，是否有一个函数/插件可以用来匹配字符串中的给定正则表达式？

例如，在一个电子邮件输入框中，我得到一个电子邮件地址，想看看它的格式是否正确。我应该使用什么 jQuery 函数来查看我的验证正则表达式是否与输入匹配？

我已经用谷歌搜索了一个解决方案，但我找不到任何东西。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-12-06T02:50:27.473

如果您想根据正则表达式搜索某些元素，您可以使用该`filter`功能。例如，假设您想确保在所有输入框中，用户只输入了数字，那么让我们找出所有不匹配的输入并突出显示它们。

```
$("input:text")
    .filter(function() {
        return this.value.match(/[^\d]/);
    })
    .addClass("inputError")
; 
```

当然，如果只是这样的话，你可以使用表单验证插件，但是这种方法可以应用于你喜欢的任何类型的元素。另一个例子来说明我的意思：找到所有`id`匹配的元素`/[a-z]+_\d+/`

```
$("[id]").filter(function() {
    return this.id.match(/[a-z]+_\d+/);
}); 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2010-06-01T17:04:15.823

我正在使用 jQuery 和 JavaScript，它对我来说很好用：

```
var rege = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
if(rege.test($('#uemail').val())){ //do something } 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-12-05T21:31:17.557

我相信这样做：

[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

它具有用于 URL 和电子邮件地址等内容的内置模式，我认为您也可以使用自己的模式。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2008-12-05T21:41:59.377

除非您正在寻找特定的东西，否则您已经可以使用带有字符串的常规 Javascript 进行正则表达式匹配。

例如，您可以通过类似这样的方式使用字符串进行匹配...

```
var phrase = "This is a phrase";
phrase = phrase.replace(/is/i, "is not");
alert(phrase); 
```

除了一般的正则表达式匹配之外，您是否还在寻找其他东西？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-08-10T13:19:15.637

我的代码：

```
$("input.numeric").keypress(function(e) { /* pour les champs qui ne prennent que du numeric en entrée */          
            var key = e.charCode || e.keyCode || 0;                     
            var keychar = String.fromCharCode(key);
            /*alert("keychar:"+keychar + " \n charCode:" + e.charCode + " \n key:" +key);*/
            if (  ((key == 8 || key == 9 || key == 46 || key == 35 || key == 36 || (key >= 37 && key <= 40)) && e.charCode==0) /* backspace, end, begin, top, bottom, right, left, del, tab */
                    || (key >= 48 && key <= 57) ) { /* 0-9 */
                return;
            } else {
                e.preventDefault();
            }
        }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-08T12:03:39.307

现在一个简单的例子：

```
$('#some_input_id').attr('oninput',
"this.value=this.value.replace(/[^0-9A-Za-z\s_-]/g,'');") 
```

这意味着所有与正则表达式不匹配的东西都没有，即`''`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-06-21T15:59:47.823

来自 jquery.validate.js（由 joern），由 Scott Gonzalez 贡献： [http ://projects.scottsplayground.com/email_address_validation/](http://projects.scottsplayground.com/email_address_validation/)

```
/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i 
```

如果您使用 MVC Razor，请确保将 @@ 加倍：

```
 /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i 
```

想吃意大利面吗？

# .net - 如何根据 WPF 中的 bool 属性设置背景颜色

> ID：345198
> 
> 赞同：25
> 
> 时间：2008-12-05T21:25:45.117
> 
> 标签：.net, wpf, data-binding, c#-3.0, styles

我想为 GridViewColumn 设置背景颜色，它是 WPF 中列表视图内部的数据绑定。我不知道如何问这个对 WPF 来说相当新的问题，否则我不会打扰你们所有人。

我想根据我的数据绑定对象中的布尔标志更改整行的背景颜色。

在这种情况下，我有一个“CaseDetail”对象，当有内部注释“IsInternalNote”时，我希望行的颜色发生变化。

如何在 WPF 中实现这一点？

我现在拥有的（非常简单），不会改变颜色。

```
<ListView ItemsSource="{Binding}" IsSynchronizedWithCurrentItem="True"  >
            <ListView.View>
                <GridView>
                    <GridViewColumn DisplayMemberBinding="{Binding Date, StringFormat=MMM dd\, yyyy h:mm tt}" Header="Date" Width="Auto" />
                    <GridViewColumn DisplayMemberBinding="{Binding SubmittedBy}" Header="Submitted By" Width="Auto" />
                    <GridViewColumn Width="Auto" Header="Description" x:Name="colDesc">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>                              
                                <ScrollViewer MaxHeight="80" Width="300">
                                    <StackPanel Orientation="Vertical">
                                        <TextBlock Text="{Binding Description}"  TextWrapping="Wrap"   />
                                        <TextBlock Text="{Binding File.FileName}" TextWrapping="Wrap"  />
                                    </StackPanel>
                                </ScrollViewer>                             
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>                    
                </GridView>
            </ListView.View>
        </ListView> 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-12-05T22:41:53.827

我在尝试这样做时遇到了一些麻烦，结果是这样

```
<ListBox ...>
  <ListBox.ItemTemplate>
    <DataTemplate>
      <Border x:Name="BGBorder">
         <!-- --> 
      </Border>
      <DataTemplate.Triggers>
        <DataTrigger 
          Binding="{Binding Path=DataContext.IsAborted, RelativeSource={RelativeSource TemplatedParent}}" 
          Value="True">
          <Setter Property="Background" TargetName="BGBorder" Value="Red">
          </Setter>
        </DataTrigger>
      </DataTemplate.Triggers>
    </DataTemplate>
  </ListBox.ItemTemplate>
</ListBox> 
```

可能有其他选择，但是一旦我让它工作，我就停止寻找:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T21:42:38.343

我还没有对此进行测试，所以它可能需要一些调整，但你会想要触发值来设置你的背景颜色。

```
<DataTemplate.Triggers>
    <Trigger Property="IsInternalNote" Value="True">
        <Setter Property="Background" Value="Red" />
    </Trigger>
</DataTemplate.Triggers> 
```

# c# - WMI 进程监视使用过多的 CPU！有什么更好的方法吗？

> ID：345199
> 
> 赞同：3
> 
> 时间：2008-12-05T21:26:14.447
> 
> 标签：c#, wmi, wmi-query

我需要观察 Windows 机器上的某些进程何时启动或停止。我目前正在接入 WMI 系统并每 5 秒查询一次，但这会导致 CPU 每 5 秒出现一次峰值，因为 WMI 是 WMI。有没有更好的方法来做到这一点？我可以列出正在运行的进程并通过 System.Diagnostics 命名空间将退出事件附加到它们，但是没有用于创建的事件处理程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T03:30:30.607

在我无法在退出/清理时正确分离事件的情况下，我在监听 WMI 事件时出现 CPU 峰值。您可能想要检查您是否没有“泄露”WMI 事件订阅。以防万一尽早脱离事件，并确保你总是这样做。

[为了进一步说明，这是我的 PowerShell 书中](https://rads.stackoverflow.com/amzn/click/com/1590599403)的一个示例，它使用 PSEventing 库侦听 WMI 事件：

> 添加-PSSnapin PSEventing -ErrorAction SilentlyContinue
> 
> $queryString = @' SELECT * FROM __InstanceModificationEvent WITHIN 10 WHERE TargetInstance ISA 'Win32_Service' AND TargetInstance.Name = 'w3svc' AND TargetInstance.State = 'Stopped' '@
> 
> $query = 新对象 System.Management.WQLEventQuery `-argumentList $queryString
> 
> $watcher = 新对象 System.Management.ManagementEventWatcher($query)
> 
> Connect-EventListener 观察者 EventArrived
> 
> $watcher.Start()
> 
> echo "等待 W3CSVC 服务停止..." Get-Event -wait | `foreach {` Write-Host -foreground Red "W3SVC 服务已停止！" }
> 
> $watcher.Stop()
> 
> Disconnect-EventListener 观察者 EventArrived
> 
> 回声“完成”

如果我在脚本退出时不执行**Disconnect-EventListener**位，我会在第三次或第四次附加到事件时获得 CPU 峰值。我的猜测是系统仍在尝试传递事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-22T23:15:36.147

如果您只查找进程的 PID/名称，则可能希望使用 WQL 查询（如“SELECT * FROM Win32_ProcessTrace WHERE TargetInstance.ProcessName = 'name'”（**如果适用）*** ）来获取 Win32_ProcessTrace 事件。

使用“SELECT * FROM __InstanceModificationEvent WITHIN 10 WHERE TargetInstance ISA 'Win32Process' AND TargetInstance.Name = 'name'”的缺陷在于它在后端的工作方式。如果您在 %windir%\system32\wbem\logs 目录中检查 wbemess.log，您会注意到以下日志（使用 __InstanceDeletionEvent）：

```
（2009 年 7 月 22 日星期三 13:58:31 2009.73889577）：在命名空间 //./root/CIMV2 中使用查询 select * from __InstanceDeletionEvent 注册通知接收器 10 where TargetInstance ISA 'Win32_Process'。
（2009 年 7 月 22 日星期三 13:58:31 2009.73889577）：在命名空间 //./root/CIMV2 中使用查询 select * from __InstanceDeletionEvent 激活过滤器 047209E0，其中 TargetInstance ISA 'Win32_Process' 在 10 内。
（2009 年 7 月 22 日星期三 13:58:31 2009.73889577）：使用查询 select * from __ClassOperationEvent 激活过滤器 0225E560，其中 TargetClass 是命名空间 //./root/CIMV2 中的“Win32_Process”。
（2009 年 7 月 22 日星期三 13:58:31 2009.73889577）：使用提供程序 $Core 激活过滤器'select * from __ClassOperationEvent where TargetClass isa "Win32_Process"'
（2009 年 7 月 22 日星期三 13:58:31 2009.73889587）：使用提供程序 $Core 激活过滤器 'select * from __InstanceDeletionEvent 10 where TargetInstance ISA 'Win32_Process''
（2009 年 7 月 22 日星期三 13:58:31 2009.73889587）： 发起轮询查询 select * from Win32_Process 以满足事件查询 select * from __InstanceDeletionEvent 10 where TargetInstance ISA 'Win32_Process'
（Wed Jul 22 13:58:31 2009.73889587）：在命名空间“//./root/CIMV2”中执行轮询查询“select * from Win32_Process”
（2009 年 7 月 22 日星期三 13:58:31 2009.73889697）：轮询查询 'select * from Win32_Process' 完成
（Wed Jul 22 13:58:41 2009.73899702）：在命名空间“//./root/CIMV2”中执行轮询查询“select * from Win32_Process”
（2009 年 7 月 22 日星期三 13:58:41 2009.73899792）：轮询查询 'select * from Win32_Process' 完成

```

如您所见，远程计算机上的实际事件实现是按​​您在 WITHIN 子句中的值指定的时间间隔对 Win32_Process 执行查询。因此，在该轮询中启动和停止的任何进程都不会触发事件。

您可以将 WITHIN 子句设置为一个较小的值来尝试最小化这种影响，但更好的解决方案是使用像 Win32_ProcessTrace 这样的真实事件，它应该**始终**触发。

*请注意，MSDN 指出 Win32_ProcessTrace 至少需要客户端计算机上的 Windows XP 和服务器计算机上的 Windows 2003 才能工作。如果您使用的是较旧的操作系统，则可能无法使用 __InstanceModificationEvent 查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T03:20:45.823

这不完全是你在现实世界中的做法，但应该有所帮助。这似乎根本无法驱动我的 CPU。

```
 static void Main(string[] args)
    {
        // Getting all instances of notepad
        // (this is only done once here so start up some notepad instances first)
        // you may want use GetProcessByPid or GetProcesses and filter them as required
        Process[] processesToWatch = Process.GetProcessesByName("notepad");

        foreach (var process in processesToWatch)
        {
            process.EnableRaisingEvents = true;
            process.Exited +=
                (s, e) => Console.WriteLine("An instance of notepad exited");
        }

        Thread watchThread = new Thread(() =>
            {
                while (true)
                {
                    Process[] processes = Process.GetProcesses();
                    foreach (var process in processes)
                    {
                        Console.WriteLine("{0}:{1}", process.Id, process.ProcessName);
                    }
                    // Don't dedicate a thread to this like I'm doing here
                    // setup a timer or something similiar
                    Thread.Sleep(2000);
                }
            });
        watchThread.IsBackground = true;
        watchThread.Start();

        Console.WriteLine("Polling processes and waiting for notepad process exit events");
        Console.ReadLine();
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-13T12:08:08.723

My answer here mentions an alternative other than WMI:[https://stackoverflow.com/a/50315772/3721646](https://stackoverflow.com/a/50315772/3721646) WMI queries can cost heavy CPU performance if not designed properly. If an intrinsic event from Win32_Process class is used to track process creation event, this impacts performance heavily. An alternate approach is to leverage Security Audit logs. You can enable Process Tracking using Local Security Policy or using a GPO in case of multiple machines. Once the process tracking starts, you can subscribe to security event logs with a custom XML query to monitor certain processes of your interest. The process creation event ID is 4688\. `

```
<QueryList>
 <Query Id="0" Path="Security">
   <Select Path="Security">
       *[EventData[Data[@Name='NewProcessName'] ='C:\Windows\explorer.exe']]
       and
       *[System[(EventID=4688)]]
   </Select>
 </Query>
</QueryList> 
```

# gmail - 不过，真的，gmail 怎么可能仍然是“测试版”？

> ID：345201
> 
> 赞同：8
> 
> 时间：2008-12-05T21:26:46.723
> 
> 标签：gmail

*   它已经发布了将近五年。
*   它拥有数千万用户
*   我怀疑有几家企业依赖它。

怎么还是“beta”？什么时候它不再是测试版？它何时完全拥有电子邮件市场？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-05T21:30:06.840

[据谷歌发言人称](http://www.networkworld.com/community/node/33131)：

> “我们的消费产品在推出测试版之前必须满足非常高的内部指标。我们的团队继续努力改进这些产品并为用户提供更好的体验。 **我们相信，当应用于应用程序时，测试版具有不同的含义。 Web，人们期望产品不断改进。** 在 Web 上，您不必等待下一个版本上架或更新可用。改进会随着开发而推出。而不是几十年前打包的、停滞不前的软件，我们正在进入一个定期更新和不断改进功能的世界，其中应用程序存在于云中。”

维基百科将[Beta 版](http://en.wikipedia.org/wiki/Beta_version)定义为：

> “测试版”是在开发软件的组织或社区之外发布的第一个版本，用于评估或真实世界的黑盒/灰盒测试。向用户交付测试版的过程称为测试版发布。Beta 级软件通常包括所有功能，但也可能包括已知问题和不太严重的错误。

所以这证实了谷歌对这个词的使用是非标准的。我找到了这篇 Slashdot 文章，[Google 是否重新定义了 Beta？](http://tech.slashdot.org/article.pl?sid=08/09/25/1235216&from=rss)，相当有趣。

我认为谷歌借用这个词是为了他们自己的目的，不应该用传统的“Beta”定义来理解它。将“Beta”放在您的应用名称旁边看起来会更好，而不是“我们仍在不断地向该产品添加功能”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T21:30:01.600

好吧，大约两个月前它下降了[30 个小时。](http://www.macworld.com/article/136216/2008/10/gmail.html)看起来即使在五年后也有一些问题需要解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T23:08:58.403

谷歌本身多年来一直处于测试阶段。创始人对其产品的标准比其他公司高得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T23:09:59.883

就像 C++ 在很长一段时间内都不是标准一样 :) 此外，他们不断添加和更改功能，所以它是一个测试版。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T21:58:04.570

我怀疑，在这种情况下，测试版意味着他们正在避免被指控为垄断者的麻烦和并发症。有人阴谋吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T10:12:57.340

它（至少正式地）处于永久测试状态。 [http://en.wikipedia.org/wiki/Perpetual_beta](http://en.wikipedia.org/wiki/Perpetual_beta)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-18T23:42:58.620

自 2009 年 7 月以来，它不再处于测试阶段 - 因此，如果您看到“测试版”徽标仍然是因为有人启用了“[返回测试版](http://gmailblog.blogspot.com/2009/07/gmail-leaves-beta-launches-back-to-beta.html)”功能。对真的...

# security - SharePoint 网站安全：如何以编程方式监控更改？

> ID：345217
> 
> 赞同：2
> 
> 时间：2008-12-05T21:30:58.603
> 
> 标签：security, sharepoint

我有一个案例，如果 SharePoint 网站所有者决定中断权限继承并直接管理网站成员资格，我还想相应地修改顶级网站中特定列表中项目的查看权限。

我怎样才能最好地捕捉这些更改，以便我知道何时将适当的更改应用于列表项？

我希望在更改站点权限时通知一些 C# 代码，以便我可以以编程方式修改适当的列表项权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T14:49:22.217

最好的方法（不幸的是）是定期查询所有站点并检查是否禁用了继承。我遇到了类似的问题，并使用了 powershell 脚本来创建[关于站点安全的报告](http://www.mobiusdevelopment.com/dev/Download.asp?ArticleID=7156531513977360024)。如果您以前没有使用过 Powershell，请不要害怕。语法与 C# 非常相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T17:24:03.607

您可以使用 SharePoint 审核来监控权限更改。它将跟踪到项目级别的更改。缺点是您必须打开此功能，它会在一定程度上影响性能。

至于通知，我认为审核不会告诉您有关更改的信息。我很确定您需要轮询审核日志。

[在 MSDN 上](http://msdn.microsoft.com/en-us/library/bb397403.aspx)的这篇文章中有大量关于审计的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-05T10:46:14.573

我认为可以很好地完成此工作的另一种方法是使用 SharePoint ChangeLog。基本上，这是由 SharePoint 在索引期间使用的，日志告诉收集器确切的更改内容，以及在增量爬网期间应该索引的内容。

当您有权限更改时，应该在增量爬网期间获取该更改。ChangeLog 具有特定的参数，可以传递这些参数来识别权限的更改。看看这里的 SPChangeQuery 类：

[http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spchangequery.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spchangequery.aspx)

具体来说，您可以查找 ChangeTypes：http: [//msdn.microsoft.com/en-us/library/microsoft.sharepoint.spchangetype.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spchangetype.aspx)

包括：AssignmentAdd AssignmentDelete MemberAdd MemberDelete ...等等

# c# - 从 .Net 打印服务器端（没有 WinForms）

> ID：345224
> 
> 赞同：3
> 
> 时间：2008-12-05T21:32:08.850
> 
> 标签：c#, printing, webforms, point-of-sale

嘿，印刷迷们需要一些指示来指导我朝着正确的方向发展。

我正在为一家本地商店开发一个 epos 系统，我们稍后将把它绑定到一个电子商务网站。

epos 系统的前端将是 WinForms，因此我们可以轻松处理 USB 设备，并且我们将使用 WebForms/MVC 管理控制台。

我们缺乏经验的一个领域是印刷。我们需要打印条形码，并希望通过管理控制台（基于 Web）来执行此操作。

所以（最后）这个问题。我们从哪里开始寻找允许我们从 webforms 的 .net 的服务器 (IIS) 实例直接打印到连接的打印机的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T21:54:35.340

```
System.Drawing.Printing 
```

[http://msdn.microsoft.com/en-us/library/system.drawing.printing.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.printing.aspx)

创建文档很像创建动态图像。我实际上并没有从网络应用程序向打印机发送文档，但我不明白为什么你不能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T13:58:05.100

您的 Web 应用程序可能必须使用远程处理连接到在同一台机器上运行的 Windows 服务（或选择您最喜欢的 IPC 机制——可能是数据库中的队列）。此服务可以在完全信任的上下文中运行，并且应该能够为您打印。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T00:10:48.900

您可以设置一个本地打印机，它只是将流量传递到网络打印机。这更容易设置直接打印到网络打印机。见[链接文字](http://blog.suddenelfilio.net/2007/02/15/how-to-print-from-aspnet-on-a-network-server/)

# c# - 如何将 Control.Enabled 数据绑定到！（字段）？

> ID：345225
> 
> 赞同：1
> 
> 时间：2008-12-05T21:32:09.457
> 
> 标签：c#, winforms, data-binding

我有一个 (varchar) 字段 Foo 只能在 (bit) Bar*不*为真时指定。我希望在 Bar 为真时*禁用*`FooBox.Enabled = !isBar`显示 Foo 的文本框 - 本质上是. 我正在尝试做类似的事情

```
FooBox.DataBindings.Add(new Binding("Enabled", source, "!isBar")); 
```

但当然，那里的砰砰声会引发异常。我也尝试过像“isBar != true”或“isBar <> true”这样的结构，但没有一个工作。我在这里吠错树了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T21:35:23.757

据我所知，Databind 使用反射来查找作为第三个字符串参数传递的成员。您不能在那里传递表达式，只能传递成员名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T22:05:50.683

我不久前尝试做这样的事情，我能想到的最好的就是

a) 将源类更改为也具有 NotBar 属性并绑定到该属性

b）围绕具有 NotBar 属性的源创建一个哑包装类并绑定到该类。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-05T21:37:37.590

如果 isBar 是源类的属性（否则您需要类的属性来进行绑定），这应该有效：

```
FooBox.DataBindings.Add("Enabled", source, "isBar"); 
```

但请记住 source.isBar 必须存在并且是一个布尔值。

# visual-studio - 在 LINQ to SQL 设计器中刷新表时出现问题

> ID：345227
> 
> 赞同：10
> 
> 时间：2008-12-05T21:32:55.947
> 
> 标签：visual-studio, visual-studio-2008, linq, linq-to-sql

我使用 LINQ to SQL 已经有一段时间了，有一件事情一直困扰着我。每当我修改表的架构时，为了在设计器中刷新它，我必须将其删除然后重新添加。很好，但这意味着我必须在设计器中实际*找到*表格。我的数据库中有大约 100 多个表，每次我这样做时，就像大海捞针一样。好吧，也许它并没有那么糟糕，但说真的，它需要的时间比它应该的要长。

是否有另一种用于刷新我不知道的表格的选项？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T23:38:20.420

有些人使用[SqlMetal](http://msdn.microsoft.com/en-us/library/bb386987.aspx "喜欢 MSDN 对 SqlMetal 的解释")来“刷新/更新”他们的 Linq2Sql 设计器。当数据库更改时，设计器不支持刷新模式。您必须手动删除表并重新添加。

[ADO Entity Framework](http://www.asp.net/learn/3.5-SP1/video-245.aspx)我相信可以刷新。我没有使用过它，但我想我在今年的 TechEd 演示中看到了它。

有用信息：[Google 的](http://www.google.com.au/search?hl=en&q=sqlmetal&meta=)SqlMetal 结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T23:11:02.410

使用 VS linq to sql 设计器无法做到这一点。

您可以使用第三方工具 LLBLGEN PRO 来完成此操作，而不是使用内置的 linq to sql 设计器。它不是免费的，但它也可以做很多其他的事情，当然你可能需要也可能不需要。

LLBLGEN PRO 实际上是一套完整的 ORM 工具，但还包括一个增强的 linq-to-sql 设计器，具有“从 SQL 刷新模型”功能。

有关问题的描述，请参见此处 - [http://weblogs.asp.net/fbouma/archive/2008/05/01/linq-to-sql-support-added-to-llblgen-pro.aspx](http://weblogs.asp.net/fbouma/archive/2008/05/01/linq-to-sql-support-added-to-llblgen-pro.aspx) 这里是工具- [http://www.llblgen.com/](http://www.llblgen.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T00:00:55.633

我没有对设计器上的内容进行任何自定义，因此在表格更改后，我只需按 CTRL+A，然后按 DEL。然后轮换选择我所有的桌子，然后把它们拍回到设计师身上。我还没有 100 张桌子，所以不确定事情是否会在某个时候变慢，但是有 20 多张桌子只需要一秒钟。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T06:26:59.940

我编写了一个可以做到这一点的插件（双向；数据库-> DBML*或*DBML --> SQL-DDL 差异脚本）。

与另一个回复中提到的 SQLMetal（或 EF 的“从数据库更新模型”）不同，加载项执行真正的同步/刷新；应用仅对应于模型和基础数据库之间差异的更改。

这意味着您在模型的其他区域中所做的任何自定义（重命名属性/导航属性等）都不会被删除/覆盖，除非它们与底层数据库模式冲突。（在这种情况下，您仍然可以通过将它们添加到加载项的“排除列表”来保留它们）

[您可以从http://www.huagati.com/dbmltools/](http://www.huagati.com/dbmltools/)下载并获得 30 天免费试用许可证

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-21T17:08:10.060

我有一个类似的评论，认为它可能适合任何人在谷歌搜索这个问题的解决方案......

当我更改存储过程返回的列时，从设计器中删除该过程并重新添加它不起作用。设计器生成的自定义返回类型实体不反映对 SP 的更改。

我尝试在服务器资源管理器中断开数据库，甚至删除并重新添加连接。

我发现的唯一解决方案是： 1\. 从设计器中删除 SP。2\. 保存 dbml 文件（或整个解决方案，等等） 3\. 完全关闭 Visual Studio。4\. 重新打开 Visual Studio 和您的解决方案。5\. 将存储过程重新添加到设计器中。

我认为这相当于臀部的蓝丝带疼痛。有人有更简单的解决方案吗？

PS- 对于那些拥有 100 多个表的人：去获取一个真正的（真正的 == 成熟的）ORM 工具。我个人投票给 NetTiers。它摇摆不定。多年来一直使用它，没有（或至少很少）抱怨。您可能必须购买 CodeSmith 才能有效地使用它，但这是值得的。模板是开源的。nHibernate 也有模板。但我发现我并没有真正挖掘 Java 端口。如果我要在 MS 平台上编写代码，我想要那些“出生”在那里的代码......

...编辑完成。:P

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T22:07:58.823

我与设计师有过类似的问题——我能建议的最好的事情是为你的数据访问的不同区域创建多个上下文——我将我的问题分解为尽可能少的相关表，因为我可以为每个功能区域摆脱困境。您可以跨上下文重复使用表，所以这没什么大不了的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-06T18:48:30.927

有一个替换设计器的 VS 2008 模板，它应该可以轻松刷新您的 LINQtoSQL 类：[http ://damieng.com/blog/2008/09/14/linq-to-sql-template-for-visual-studio-2008](http://damieng.com/blog/2008/09/14/linq-to-sql-template-for-visual-studio-2008)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-06T19:09:51.537

还有其他几个选项：

1.  编辑设计者用来绘制表格和生成代码的 .dbml 文件。当更改很小时，我使用了这种方法（添加几列，创建一个简单的表）
2.  使用 sqlmetal 为更改的表创建所需的 xml，并手动将声明移动到 .dbml 文件。当更改更复杂或更大时，这个更好。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-05T22:16:26.170

我个人*讨厌*使用设计器，每当我敢于使用它时，我都会遇到各种问题。

我主要将 LINQ 用于非常简单的 CRUD（没有链接实体或任何东西），如果您是这种情况，那么可能值得远离设计师的拐杖。特别是因为定义 LINQ-to-SQL 实体就像这样简单：

```
[Table("dbo.my_table")]
public class MyTable
{
[Column("id", AutoSync = AutoSync.OnInsert, IsDbGenerated = true, IsPrimaryKey = true)]
public Int32 Id { get; set; }

[Column("name", DbType="NVarChar(50) NOT NULL")]
public String Name { get; set; }
} 
```

这样，您的所有实体都有自己的文件，这使得查找它们变得更加容易，尽管您仍然必须手动添加/更新属性。

当然，如果您要重构 100 多个表，那可能不是一个选择；）

# visual-studio - 在 VS2008 中运行批处理文件

> ID：345251
> 
> 赞同：5
> 
> 时间：2008-12-05T21:39:24.577
> 
> 标签：visual-studio, visual-studio-2008, batch-file

是否可以在 studio 2008 中将批处理文件作为菜单项运行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T21:45:24.877

是的，转到**工具 | 菜单中的外部工具**并将批处理文件添加为命令。您还可以传入任何您想要的参数，例如构建目标、项目目录等。

完成此操作后，您的批处理文件将显示为工具菜单上的项目之一。如果需要，您可以通过**工具 |添加工具栏按钮。定制 | 工具并将与您的工具匹配的***外部命令#*拖动到工具栏。然后，您需要将其更改为图标并为其选择图像。

这些工具按照它们在菜单中出现的顺序编号为 1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-21T13:30:26.657

## 直接在 VS 解决方案资源管理器中运行批处理文件

这比使用外部工具要好得多，因为您只需在解决方案资源管理器中双击它即可执行批处理文件，就像打开代码文件一样。我已经写[了一篇关于它的博客文章](http://erraticdev.blogspot.com/2010/11/running-batch-files-bat-from-within.html)，它将帮助您大量配置它，当然也可以使用它。

## 旁注

您在 2 年前问过这个问题，但我看到没有人提到这种技术，所以我提供这个答案以供将来参考。我希望它得到支持，所以它将接近顶部供读者查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T21:44:45.173

使用“工具”/“外部工具...”菜单项并将您的 bat 文件添加到“工具”菜单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T15:18:22.777

作为给定答案的改进：

假设您的项目/解决方案有几个特定于项目的 BAT - 您不想从另一个项目运行一个 - 这就是上述答案可能发生的情况 - 因为您已经硬连接到 bat 的路径。

只需设置一个名为“Run BAT”的外部工具，将其命令设置为 $(ItemPath)，并将初始目录设置为 $(ItemDirectory)，对话框会抱怨这不是一个真正的可执行文件 - 但忽略它。

如果需要，可以将工具绑定到按钮上。

现在从项目或解决方案中运行选择的 BAT - 只需打开 .bat 进行编辑并选择“运行 BAT”外部工具。

您也可以设置“使用输出”选项，蝙蝠输出将在输出窗口中。

# python - 新手的 Python 版本

> ID：345255
> 
> 赞同：5
> 
> 时间：2008-12-05T21:41:22.233
> 
> 标签：python, python-3.x

我对 python 非常陌生，不到一个月前就开始学习它，但对其他一些编程语言（主要是 C# 和 SQL）有经验。但是既然 Python 3.0 已经发布并且不向后兼容，那么决定专注于 Python 3.0 还是 Python 2.6 会有什么优缺点呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-05T21:44:52.957

使用 2.6，因为这是大多数库（pygame、wxpython、django 等）的目标。

3.0 中的差异并没有那么大，所以稍后过渡到它应该不是什么大问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-05T21:43:06.923

由于它们不兼容，我建议您开始使用 Python 3.0，无论如何它在将来会更有用。这是一种更好的语言。您可以在其网站上的 What's new 页面中看到确切的差异。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-05T21:49:02.920

我会说从 2.6 开始，因为关于 Python 的绝大多数文档都将适用于 2.6，而且您可能想要贡献的大多数开源项目将在 2.6 中出现一段时间。那么，一旦你在 2.6 打好基础，就可以学习 3.0。这样你就可以体会到语言是如何演变的，以及代码的“美学”从何而来。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-06T04:35:40.103

从 2.6 开始，当您对该语言更加熟练时（编写了几千行代码），过渡到 3.0 将变得容易和自然。在学习的过程中，我建议你忽略经典类，并特别注意迭代器、生成器和列表推导。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-06T13:40:39.003

这取决于你愿意做什么。

Python 3.0 是较新的版本，随着时间的推移应该成为标准。但是，它几乎没有可用的库或框架，甚至工具也不是最新的（例如，用于 Python 的 Eclipse 插件仍处于迁移阶段）。

另一方面，没有太大的差异，一旦你学会了一个，转移到另一个是很容易的。

所以，如果你只是想玩玩，你可以选择 3.0。如果您打算在新项目中使用它，我会坚持使用旧版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-05T21:55:56.243

不过要小心。mysql驱动等库还在2.5

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-06T16:17:10.687

如果你从找工作的角度来看，我肯定至少也会学习 2.x。我工作的代码仍然以 python 2.4 为目标，据我所知，甚至没有计划迁移到 2.6，更不用说在不久的将来 3.0。未来几年将会有大量的 2.x python 代码出现，绝大多数的 python 工作都将涉及到使用这些代码。

所以我会从学习 python 2.6 开始，同时一直关注 3.0，这样你至少知道你的 2.x 代码的哪些位在 3.0 中不起作用

# machine-learning - 贝叶斯网络教程

> ID：345280
> 
> 赞同：14
> 
> 时间：2008-12-05T21:46:46.603
> 
> 标签：machine-learning, bayesian-networks

对于初学者来说，学习贝叶斯网络的最佳书籍是哪本书？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-12-14T17:31:42.670

我会推荐 Daphne Koller 和 Nir ​​Friedman 的“概率图形模型”。它是一本关于有向（贝叶斯网络）和无向（马尔可夫网络）图形模型的优秀入门到中级手册。给出的例子很详细，很容易理解。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-05T19:06:12.213

一本关于通用机器学习的好书是[1](http://www.cs.ubc.ca/~murphyk/Bayes/bnintro.html) . 但对BN来说却很轻。我没有读过[2]，但我读过他的[3]，这很好（所以，[2] 可能像dwf 推荐的那样好）。除非您正在攻读博士学位，否则我根本不会推荐 Pearl 的书！

但是，我实际上会推荐 Kevin Murphy [4] 的在线教程“**图形模型和贝叶斯网络简介**”。学习 BN 的最佳方法是阅读这篇文章，下载他的 Matlab 工具箱 [5] 并在十分钟内构建您自己的 BN。

1.  Duda/Hart/Stork 的模式分类
2.  Chris Bishop 的模式识别和机器学习
3.  用于模式识别的神经网络 作者 Chris Bishop
4.  [http://www.cs.ubc.ca/~murphyk/Bayes/bnintro.html](http://www.cs.ubc.ca/~murphyk/Bayes/bnintro.html)
5.  Matlab 的贝叶斯网络工具箱

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-05T21:49:27.100

您应该查看 AI（人工智能）书籍。我在[人工智能“现代方法](http://aima.cs.berkeley.edu/)”中了解了贝叶斯。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-05T22:27:08.800

这本在线书籍在机器学习的各个方面都对我非常有帮助，包括贝叶斯推理：

[http://www.inference.phy.cam.ac.uk/mackay/itila/book.html](http://www.inference.phy.cam.ac.uk/mackay/itila/book.html)

如果您熟悉基本的概率论，它是一个很好的资源。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-05T21:56:28.723

到目前为止提到的所有书籍都非常好。Pearl's 通常被认为有点难以追随，它也相当昂贵，但如果你能管理它，所有的权力都归你。

我真的*非常*推荐您查看 Chris Bishop 的书[*Pattern Recognition and Machine Learning*](http://research.microsoft.com/en-us/um/people/cmbishop/prml/)。我认为这绝对是教科书中图形模型的最佳处理方式，至少在[迈克尔乔丹](http://www.cs.berkeley.edu/~jordan/)完成并出版他关于该主题的书之前。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-12-27T08:22:56.740

在我看来，这个领域最好的教授是这两个人：[link text](http://see.stanford.edu/see/lecturelist.aspx?coll=348ca38a-3a6d-4052-937d-cb017338d7b1) Ng。安德鲁和[链接文本](http://www.eetindia.co.in/VIDEO_DETAILS_700000078.HTM)教授 Pallab Dasgupta。

我一直在看他们关于 BBN 的所有教程，它们非常有用。只需点击链接，您就会发现这 2 个有趣的家伙的更多 AI 讲座。

与他们一起学习愉快，迈克

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-05T23:40:22.820

珀尔 1988 年*的《智能系统中的概率推理》*是贝叶斯网络上被引用次数最多的著作之一。我发现它很清楚。也就是说，自 1988 年以来，该领域已经做了很多工作。明智的做法是用最近的作品补充本书。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-05T22:56:25.357

Mitchell 的*机器学习*是人工智能领域极其重要的入门读物。它涵盖了贝叶斯网络，我记得用了一整章的篇幅来介绍它。

我还会查看 Weka 的贝叶斯网络课程以了解实际实现。如果您不了解 Weka，请在此处查看：[http ://www.cs.waikato.ac.nz/ml/weka/](http://www.cs.waikato.ac.nz/ml/weka/)

# firefox - 有没有办法强制 Firefox 在新进程中启动？

> ID：345281
> 
> 赞同：20
> 
> 时间：2008-12-05T21:47:05.323
> 
> 标签：firefox

是否有一个命令行参数会强制 firefox.exe 为特定 URL 启动一个新进程，而不管另一个 firefox 实例是否已经在运行？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-05T22:03:21.687

如果您有第二个配置文件（如“sidekick”），以下将启动一个新的 Firefox 进程：

```
firefox.exe -no-remote -p sidekick 
```

但是，如果该配置文件已被当前的 Firefox 会话使用，那将不起作用。

要创建新的配置文件，请使用 -P 标志从命令行启动 Firefox 并创建它。

```
firefox.exe -P 
```

[OP ykaganovich](https://stackoverflow.com/users/10026/ykaganovich)[在评论](https://stackoverflow.com/questions/345281/is-there-a-way-to-force-firefox-to-launch-in-a-new-process/345320#comment113587161_345320)中补充道（2020 年 10 月，三年后）：

> 最新版本的 Firefox（截至 2020 年）还提供配置文件管理 UI，网址为`about:profiles`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-25T13:25:13.500

在重建我的 Web 应用程序后测试我的更改时，我经常需要关闭多个实例、清除缓存并打开多个 firefox 窗口。为此，我使用 Firefox 便携版来允许多个实例。我在下面编写了修改 FirefoxPortable 安装的批处理脚本，如果尚未修改，请停止当前的 firefox 进程并重新启动它。我通常有四个使用不同的可执行名称运行的实例。一个用于我的常规浏览，另外三个用于测试网络应用程序。当您想要测试和验证您的网络应用程序是否适用于当前和以前版本的 Firefox 时非常有用。

我可能会在同一个浏览器中打开三个选项卡，但在处理浏览器时我倾向于偏执。我更喜欢在重新测试之前为不同的应用程序清理并重新打开浏览器的新实例，而不是 F5 或 Ctrl F5。

**该脚本将使用单独的进程名称和单独的配置文件运行单独的 firefox 可移植进程。**

希望这些对你有所帮助。随意使用它们。请在此线程上发回您的修改和错误修复。

将 FirefoxPortable 安装到名为 FirstFirefoxPortable 的文件夹（或任何其他适当的名称）

```
REM ==============

setlocal

set URL=%1

REM FirefoxPortable installation folder
set FIREFOX_PORTABLE_HOME=C:\portables\FirstFirefoxPortable

REM Name of the FirefoxPortable executable file
set FIREFOX_FILENAME_NOEXT=FirstFirefoxPortable

REM Name of the Firefox executable file within App/firefox
set FIREFOX_EXEC_NOEXT=firstfirefox

set FIREFOX_PORTABLE_EXEC=%FIREFOX_PORTABLE_HOME%\%FIREFOX_FILENAME_NOEXT%.exe

REM Name of the other profile folder.
set FIREFOX_PROFILE=firstprofile

set CLEAR_HISTORY=true
set CLEAR_CACHE=true
set CLEAR_SAVED_PASSWORDS=true
set CLEAR_SESSION=true

set WAIT_DURATION=4
set ADDITIONAL_WAIT_DURATION=2

if not exist %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini (

@echo off
echo.
echo.
echo Setting up Firefox Profile
echo.
echo.
pause
@echo on

echo [FirefoxPortable]>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo FirefoxDirectory=App\firefox>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo ProfileDirectory=%FIREFOX_PROFILE%\profile>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo SettingsDirectory=%FIREFOX_PROFILE%\settings>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo PluginsDirectory=%FIREFOX_PROFILE%\plugins>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo FirefoxExecutable=%FIREFOX_EXEC_NOEXT%.exe>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo AdditionalParameters=>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo LocalHomepage=>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo DisableSplashScreen=false>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo AllowMultipleInstances=false>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo DisableIntelligentStart=false>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo SkipCompregFix=false>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini
echo RunLocally=false>>%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini

rem create dirs
pushd %FIREFOX_PORTABLE_HOME%
mkdir %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%
mkdir %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile
mkdir %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\settings
mkdir %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\plugins
popd

rem copy profile
xcopy /e %FIREFOX_PORTABLE_HOME%\App\DefaultData\profile %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile

copy /y %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%.ini %FIREFOX_PORTABLE_HOME%\FirefoxPortable.ini
rename %FIREFOX_PORTABLE_HOME%\FirefoxPortable.exe %FIREFOX_FILENAME_NOEXT%.exe
rename %FIREFOX_PORTABLE_HOME%\App\Firefox\firefox.exe %FIREFOX_EXEC_NOEXT%.exe
)

rem check if firefox is running
REM tasklist /FI "IMAGENAME eq %FIREFOX_FILENAME_NOEXT%.exe" 2>NUL | find /I /N "%FIREFOX_FILENAME_NOEXT%.exe">NUL
REM if "%ERRORLEVEL%"=="0" (
REM echo Firefox running
REM taskkill /t /FI "IMAGENAME eq %FIREFOX_FILENAME_NOEXT%.exe"
REM ping -n 4 127.0.0.1 > NUL
REM tasklist /FI "IMAGENAME eq %FIREFOX_FILENAME_NOEXT%.exe"
REM echo retrying killing Firefox
REM taskkill /f /t /FI "IMAGENAME eq %FIREFOX_FILENAME_NOEXT%.exe"
REM ping -n 2 127.0.0.1 > NUL
REM taskkill /f /t /FI "IMAGENAME eq %FIREFOX_EXEC_NOEXT%.exe"
REM ) else (
REM echo Firefox not running.. starting..
REM )

taskkill /t /FI "IMAGENAME eq %FIREFOX_FILENAME_NOEXT%.exe"

ping -n %WAIT_DURATION% 127.0.0.1 > NUL
echo ==== try killing
tasklist /FI "IMAGENAME eq %FIREFOX_FILENAME_NOEXT%.exe"
tasklist /FI "IMAGENAME eq %FIREFOX_EXEC_NOEXT%.exe"
taskkill /t /FI "IMAGENAME eq %FIREFOX_FILENAME_NOEXT%.exe"
taskkill /t /FI "IMAGENAME eq %FIREFOX_EXEC_NOEXT%.exe"

ping -n %ADDITIONAL_WAIT_DURATION% 127.0.0.1 > NUL
echo ==== retry killing forcefully 
tasklist /FI "IMAGENAME eq %FIREFOX_FILENAME_NOEXT%.exe"
tasklist /FI "IMAGENAME eq %FIREFOX_EXEC_NOEXT%.exe"
taskkill /f /t /FI "IMAGENAME eq %FIREFOX_FILENAME_NOEXT%.exe"
taskkill /f /t /FI "IMAGENAME eq %FIREFOX_EXEC_NOEXT%.exe"

REM clear everything - delete profile
REM del /f /s /q %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\*
REM rmdir %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\
REM mkdir %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\

REM clear all sqlite files
rem for /d %%x in (%FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\*) do del /q /s /f %%x\*sqlite

if "%CLEAR_HISTORY%"=="true" (
echo.
echo Clearing History
echo.
rem clear history (Bookmarks, browsing and download history)
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\places.sqlite*

rem clear form history (Saved form data)
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\formhistory.sqlite*
)

if "%CLEAR_SESSION%"=="true" (
echo.
echo Clearing browsing session
echo.
rem clear previous browsing session
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\sessionstore.js
)

if "%CLEAR_SAVED_PASSWORDS%"=="true" (
echo.
echo Clearing saved passwords
echo.
rem clear saved passwords
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\logins.json
)

if "%CLEAR_CACHE%"=="true" (
echo.
echo Clearing cache
echo.
rem clear permissions (Permission database for cookies, pop-up blocking, image loading and add-ons installation.)
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\permissions.sqlite*

rem clear content preferences (Individual settings for pages.)
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\content-prefs.sqlite*

rem clear cookies
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\cookies.sqlite*

rem clear cache
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\cache2\*

rem clear offline cache
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\OfflineCache\*

rem clear DOM Storage
del /q /s /f %FIREFOX_PORTABLE_HOME%\%FIREFOX_PROFILE%\profile\webappsstore.sqlite*
)

if "%URL%"=="" (
set URL=www.google.com?q=DidYouPassTheURLArgument
)
@echo on
start /MAX "%FIREFOX_FILENAME_NOEXT%.exe" %FIREFOX_PORTABLE_EXEC% -P "%FIREFOX_PROFILE%" -no-remote -new-tab %URL%
endlocal

REM ================== 
```

为第二个应用程序打开 Firefox 的脚本。它与上面的脚本相同。

复制并保存在单独的文件中，例如 secondfirefox.bat。将 FirefoxPortable 安装在另一个文件夹中，例如 C:\portables\SecondFirefoxPortable。更改 secondfirefox.bat 中的变量以指向另一个便携式 firefox 安装文件夹。

```
setlocal

set URL=%1

REM FirefoxPortable installation folder
set FIREFOX_PORTABLE_HOME=C:\portables\SecondFirefoxPortable

REM Name of the FirefoxPortable executable file
set FIREFOX_FILENAME_NOEXT=SecondFirefoxPortable

REM Name of the Firefox executable file within App/firefox
set FIREFOX_EXEC_NOEXT=secondfirefox

set FIREFOX_PORTABLE_EXEC=%FIREFOX_PORTABLE_HOME%\%FIREFOX_FILENAME_NOEXT%.exe

REM Name of the other profile folder.
set FIREFOX_PROFILE=secondprofile

REM --- snip --- 
```

**- - 更新 - -**

错误修复 - 更正了配置文件路径。

分离出用于清除密码的变量。记住我的网络应用程序登录页面的密码。少打字。

---- 更新---- 2014-10-01

不再需要手动重命名 FirefoxPortable.exe 文件。该脚本在首次运行 FirefoxPortable 安装时执行此操作。

---- 更新---- 2014-11-09

允许通过运行 FirefoxPortable 安装程序进行更新的更改。当这批要求您覆盖首选项和书签时，键入 N。这将保留书签和一些设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T21:53:52.673

是的，如[Firefox 命令行参数](http://kb.mozillazine.org/Command_line_arguments)中所述：

`firefox -new-window`

编辑：重新阅读你实际上说的“过程”，在这种情况下不，我认为你不能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-25T10:11:04.657

启动一个新进程（[实例](https://developer.mozilla.org/en-US/docs/Mozilla/Command_Line_Options#-new-instance)）由

> **-new-instance**
> 打开新实例，而不是运行实例中的新窗口，它允许一次打开多个应用程序副本。
> 
> ```
> firefox -new-instance -P "Another Profile" 
> ```
> 
> 注意：不适用于 Windows，请参阅错误 855899。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-16T13:53:18.673

如果您使用的是 Mac，则可以使用此命令每次使用新的空白配置文件打开一个新实例：

```
open -n -a Firefox.app --args -profile `mktemp  -d /tmp/fx-profile.XXXX` -no-remote -new-instance 
```

# sql-server - How do I map (local) to a non-standard named SQL Server?

> ID：345298
> 
> 赞同：1
> 
> 时间：2008-12-05T21:53:18.277
> 
> 标签：sql-server, sql-server-2008

I installed SQL Server 2008 (SQL Server 2005 was already installed) on my XP box and name the local instance of the database so that it wouldn't clash with SQL Server 2005.

Now I want to change the mapping of (local) from SQL Server 2005 to my non-standard named SQL Server 2008 instance. Anybody know how to do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T22:42:58.147

nope. you'll have to reinstall both.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T09:53:56.013

I'm afraid Mladen is correct.

*   You can move the db's from one instance to another using attach/detach or backup/restore.

*   You can transfer all logins (if needed) with [this method](http://support.microsoft.com/kb/246133).

*   You can move SQL Agent scripts by right-clicking on them on the existing server and selecting *generate script* then running that script on the new server.

.

You will have to do the following (Assuming you'd like to make 2008 your default instance):

1.  Install 2005 named instance.
2.  Move the default to the named using above method.
3.  Uninstall 2005 default instance.
4.  Install 2008 default instance.
5.  Move the named to the default using above method.
6.  Uninstall 2008 named instance.

Good luck!

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-12-05T23:32:19.683

Create an alias in the sql config manager. Enable named pipes for your instance with surface area config and you will be in business.

# c++ - 任何人都可以为 C++ 推荐一个好的数据包嗅探器类吗？

> ID：345305
> 
> 赞同：3
> 
> 时间：2008-12-05T21:55:59.380
> 
> 标签：c++, packet-capture, winpcap, sniffing

任何人都可以为 C++ 推荐一个好的数据包嗅探器类吗？寻找一个可以在我的 c++ 程序中使用的简单可插入类，没有什么复杂的。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-05T22:09:50.973

仅仅通过在项目中插入一个类，您将永远无法拦截网络流量。数据包捕获功能需要内核模式支持，因此您至少需要让您的应用程序需要或安装 libpcap/WinPcap，正如 Will Dean 指出的那样。

大多数现代类 Unix 发行版都包含开箱即用的 libpcap，在这种情况下，您可以查看这个非常简单的示例：[http ://www.tcpdump.org/pcap.htm](http://www.tcpdump.org/pcap.htm)

如果您使用的是 Windows，则您或多或少是靠自己的，尽管[WinPcap](http://www.winpcap.org/)编程与 libpcap 编程非常相似（不足为奇，因为它是 Win32 的 libpcap 端口。）可以在此处找到 SDK：[http://www .winpcap.org/devel.htm](http://www.winpcap.org/devel.htm)

无论如何，无论操作系统如何，您*都*需要 root / 管理员访问权限才能实际执行捕获。当然，仅使用该库来重放或分析预先捕获的数据不需要任何特殊权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T21:58:28.733

你需要谈谈你的平台，因为这是一个平台而不是语言。

但是假设您使用的是常见的东西，请查看 pcap 或 winpcap。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T22:30:55.517

Microsoft Network Monitor 有一个数据包捕获和分析 API，有关一些基本信息，请参阅[netmon 博客](http://blogs.technet.com/netmon/archive/2008/10/29/intro-to-the-network-monitor-api.aspx)。

# excel - VBA-对列表框中的数据进行排序，排序有效，但列表框中的数据未更改

> ID：345315
> 
> 赞同：3
> 
> 时间：2008-12-05T22:01:34.080
> 
> 标签：excel, vba

传递一个列表框，将数据放入数组中，对数组进行排序，然后将数据放回列表框中。起作用的部分是将数据放回列表框中。就像列表框是按值而不是通过引用传递的。

这是执行排序的子程序和调用排序子程序的代码行。

```
Private Sub SortListBox(ByRef LB As MSForms.ListBox)

Dim First As Integer
Dim Last As Integer
Dim NumItems As Integer
Dim i As Integer
Dim j As Integer
Dim Temp As String
Dim TempArray() As Variant

ReDim TempArray(LB.ListCount)

First = LBound(TempArray)               ' this works correctly
Last = UBound(TempArray) - 1            ' this works correctly

For i = First To Last
    TempArray(i) = LB.List(i)           ' this works correctly
Next i

For i = First To Last
    For j = i + 1 To Last
        If TempArray(i) > TempArray(j) Then
            Temp = TempArray(j)
            TempArray(j) = TempArray(i)
            TempArray(i) = Temp
        End If
    Next j
Next i                               ! data is now sorted

LB.Clear                             ! this doesn't clear the items in the listbox

For i = First To Last
    LB.AddItem TempArray(i)          ! this doesn't work either
Next i

End Sub

Private Sub InitializeForm()

'   There's code here to put data in the list box    

Call SortListBox(FieldSelect.CompleteList)

End Sub 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T03:20:16.250

This works for me on Excel 2003 on a very basic UserForm with a single ListBox called ListBox1:

```
Private Sub UserForm_Initialize()

ListBox1.AddItem "john"
ListBox1.AddItem "paul"
ListBox1.AddItem "george"
ListBox1.AddItem "ringo"

SortListBox ListBox1

End Sub 
```

and then your SortListBox as written apart from fixing the three comments which start with ! rather than '

The only difference to your initializer is the name (`UserForm_Initialize` vs `InitializeForm`). Make sure to use the object and event selectors at the top of the code page for the userform to ensure that the event handlers get named correctly

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T23:10:22.800

您不能按值传递对象。由于您不会将另一个列表框实例返回给调用者，因此您应该将 LP 声明为 ByVal。但这并不影响代码。它有效并且列表被排序。我认为你省略了一些重要的细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-13T19:26:33.203

这是我使用它的方式，例如，带有一个关系字典和两列：

```
Private Sub UserForm_Initialize()

 Call HideTitleBar(Me)

 Set ExtraFiltersDic = CreateObject("scripting.dictionary")
 ExtraFiltersDic.CompareMode = 1
 Set ExtraFiltersDic = GetExtraFiltersDic()

 Dim k
 For Each k In ExtraFiltersDic.Keys
  ListBox1.AddItem k
 Next

 Call SortListBox(ListBox1, ListBox2, ExtraFiltersDic)

End Sub

Public Sub SortListBox(ByRef ListBox As MSForms.ListBox, Optional ByRef ListBox2 As MSForms.ListBox, Optional ByRef RelationalDic As Object)

 Dim First As Integer, Last As Integer, NumItems As Integer
 Dim i As Integer, j As Integer
 Dim TempArray() As Variant, Temp As String

 ReDim TempArray(ListBox.ListCount)

 First = LBound(TempArray)
 Last = UBound(TempArray) - 1
 For i = First To Last
    TempArray(i) = ListBox.List(i)
 Next i

 For i = First To Last
    For j = i + 1 To Last
        If TempArray(i) > TempArray(j) Then
            Temp = TempArray(j)
            TempArray(j) = TempArray(i)
            TempArray(i) = Temp
        End If
    Next j
 Next i

 ListBox.Clear

 If Not ListBox2 Is Nothing And Not RelationalDic Is Nothing Then
  Set KeyValDic = CreateObject("scripting.dictionary")
  Set KeyValDic = RelationalDic
 End If

 For i = First To Last
    ListBox.AddItem TempArray(i)
    If Not ListBox2 Is Nothing And Not RelationalDic Is Nothing Then
     ListBox2.AddItem KeyValDic(TempArray(i))
    End If
 Next i

End Sub 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-11-02T04:23:38.777

我不知道这是否适合你，但试试这种方式。

首先，将列表框中的所有项目组成一个数组

将该数组传递给您的函数

对该数组进行排序

将数组返回到主程序

清除列表框

用新数组覆盖列表框项

# c# - 在 C# 中附加到调用堆栈中的事件的最佳方法是什么？

> ID：345318
> 
> 赞同：4
> 
> 时间：2008-12-05T22:02:55.760
> 
> 标签：c#, events

将“顶级”类附加到调用堆栈中可能位于“5+ 层以下的类”的事件的最佳设计决策是什么？

例如，也许 MainForm 产生了一个对象，并且该对象产生了一个由其他几个对象调用组成的调用堆栈。最明显的方法是将事件链接到对象层次结构，但这看起来很混乱并且需要大量工作。

我看到的另一种解决方案是通过创建一个可公开访问的静态对象来使用观察者模式，该对象公开事件，并充当底层对象和顶层“表单”之间的代理。

有什么建议吗？

这是一个伪代码示例。在此示例中，MainForm 实例化“SomeObject”，并附加到一个事件。'SomeObject' 附加到它实例化的对象，以便将事件传递到 MainForm 侦听器。

```
class Mainform
{
   public void OnLoad()
   {
      SomeObject someObject = new SomeObject();
      someObject.OnSomeEvent += MyHandler;
      someObject.DoStuff();
   }

   public void MyHandler()
   {
   }
}

class SomeObject
{
   public void DoStuff()
   {
      SomeOtherObject otherObject = new SomeOtherObject();
      otherObject.OnSomeEvent += MyHandler;
      otherObject.DoStuff();
   }

   public void MyHandler()
   {
      if( OnSomeEvent != null )
          OnSomeEvent();
   }

   public event Action OnSomeEvent;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T19:58:31.143

如果您的应用程序不是基于复合 UI 应用程序块，最简单的解决方案是在主窗体和您的其他组件之间放置一个“侦听器”类，这两个类都可以轻松访问。从概念上讲，这些类的布局如下：

```
     ---------- ----------------
    | 主窗体 | | 一些组件 |
      --------- ----------------
          | |
      挂钩通知
          | |
           \ /
            -----------------
           | 代理通知器 |
            -----------------

```

这是一些示例代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            FakeMainForm form = new FakeMainForm();
            form.CreateComponentAndListenForMessage();
            Console.ReadKey(true);
        }
    }

    class FakeMainForm
    {
        public FakeMainForm()
        {
            Listener.AddListener(MessageRecieved);
        }

        void MessageRecieved(string msg)
        {
            Console.WriteLine("FakeMainForm.MessageRecieved: {0}", msg);
        }

        public void CreateComponentAndListenForMessage()
        {
            ComponentClass component = new ComponentClass();
            component.PretendToProcessData();
        }
    }

    class Listener
    {
        private static event Action<string> Notify;

        public static void AddListener(Action<string> handler)
        {
            Notify += handler;
        }

        public static void InvokeListener(string msg)
        {
            if (Notify != null) { Notify(msg); }
        }
    }

    class ComponentClass
    {
        public void PretendToProcessData()
        {
            Listener.InvokeListener("ComponentClass.PretendToProcessData() was called");
        }
    }
} 
```

该程序输出以下内容：

```
FakeMainForm.MessageRecieved：ComponentClass.PretendToProcessData() 被调用
```

此代码允许您直接在任何侦听器上调用方法，无论它们在调用堆栈中相距多远。

重写您的 Listener 类很容易，使其更加通用并适用于不同类型，但您应该明白这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T22:13:02.760

我最初的意图是尽量避免这种情况，以便对象的范围有明显的界限。在表单的特定情况下，我会尝试让孩子的父表单管理与其祖先的所有必需通信。你能更具体地谈谈你的情况吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T22:28:31.107

我的第一个想法是，从您的 MainForm 的角度来看，它应该不知道 5 层以下发生了什么。它应该只知道它与它产生的对象的交互。

这样，如果您的主窗体想要异步执行某些操作，它应该能够通过异步调用生成的对象上的方法来做到这一点。

现在从您生成的对象的角度来看，如果您允许调用者异步执行某些方法，则无需将事件模型进一步向下推......只需直接调用堆栈中的方法即可。你已经在另一个线程上。

希望这会有所帮助。请记住，您的应用程序的级别应该只知道紧接在它们下方的级别中发生的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T23:09:29.293

WPF 使用[路由事件](http://msdn.microsoft.com/en-us/library/ms742806.aspx)。这些是静态的，可以在元素树中向上冒泡或向下隧道。我不知道您是否使用 WPF，但静态事件的想法可能会帮助您。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T17:26:39.470

我不会说这是一个设计错误，主窗体想要听一个对象在做什么是有正当理由的。我遇到的一种情况是向用户显示状态消息，以指示后台进程正在做什么，或者多个控件在多线程应用程序中正在做什么，从而让您一次打开多个屏幕/“页面”。

在复合 UI 应用程序块中，依赖注入容器的基本等价物在其在同一工作项中实例化对象时连接事件（工作项只是一组相关用户控件的对象容器）。它通过扫描`[EventPublication("StatusChanged")]`事件和`[EventSubscription("StatusChanged")]`公共方法等特殊属性来做到这一点。我的一个应用程序使用此功能，以便在应用程序内部实例化的用户控件可以广播状态信息（例如“正在加载客户数据...45%”），而不知道该数据最终会在主窗体的状态栏。

所以一个 UserControl 可以做这样的事情：

```
 public void DoSomethingInTheBackground()
{
    using (StatusNotification sn = new StatusNotification(this.WorkItem))
    {
        sn.Message("Loading customer data...", 33);
        // Block while loading the customer data....
        sn.Message("Loading order history...", 66);
        // Block while loading the order history...
        sn.Message("Done!", 100);
    }
} 
```

...`StatusNotification`类有一个`event`带有 a 签名的地方

```
 [EventPublication("StatusChanged")]
public event EventHandler<StatusEventArgs> StatusChanged; 
```

...以及该类的上述方法`Message()`和方法适当地调用该事件。`Dispose()`但是那个类并没有明确地将那个事件与任何东西联系起来。对象实例化器将自动将事件连接到具有同名订阅属性的任何人。

所以 MainForm 有一个看起来像这样的事件处理程序：

```
 [EventSubscription("StatusChanged", ThreadOption=ThreadOption.UserInterface)]
public void OnStatusChanged(object sender, StatusEventArgs e)
{
   this.statusLabel.Text = e.Text;
   if (e.ProgressPercentage != -1)
   {
      this.progressBar.Visible = true;
      this.progressBar.Value = e.ProgressPercentage;
   }
} 
```

……或类似的。它比这更复杂，因为它会在给定的秒数内循环显示多个状态通知，因为多个用户控件可以在同一时间广播状态消息。

因此，要在不实际切换到 CAB 的情况下重新创建这种行为（老实说，这比我认为它真正需要的复杂得多），您可以拥有一个`MessageNotificationService`在您的应用程序中传递的对象，或者您变成一个静态/单例对象（我通常避免这种方法，因为它更难测试），或者您可以让您的子用户控件由为您完成事件连接的工厂类实例化。对象可以通过您自己创建的属性或通过显式调用方法向工厂注册，这些方法说“嘿，无论何时您创建具有此签名事件的对象，我都想知道它。”

当一个对象被释放时，请小心让您实现的任何类取消事件，因为在这种情况下很容易得到不会被垃圾收集的东西。

希望这可以帮助！

# .net - 没有 DBType 的 AddWithValue 导致查询运行缓慢

> ID：345323
> 
> 赞同：1
> 
> 时间：2008-12-05T22:04:29.503
> 
> 标签：.net, sql, ado, prepared-statement

我一直在使用 cmd.Parameters.AddWithValue，并且没有指定 DBType (int, varchar,...) 来运行查询。查看 SQL Profiler 后，使用此方法运行的查询似乎比指定数据类型时运行得慢很多。

为了让您了解它有多慢，这里有一个例子。该查询是对单个表的简单查找，并且对 where 语句中的列进行索引。指定数据类型时，某个查询运行大约 0 MS（对于 sql server 来说太小无法测量），并且需要 41 次读取。当我删除 DBType 时，完成查询可能需要大约 200 毫秒和 10000 次读取。

我不确定这是否只是 SQL Profiler 误报的值，或者这些值实际上是否正确，但它是可重现的，因为我可以添加和删除 DBType，它会生成 SQL Profiler 中给出的值。

有没有其他人遇到过这个问题，以及解决它的简单方法。我意识到我可以在整个代码中添加数据类型，但这似乎需要添加很多东西，如果有更简单的方法来修复它，那将不胜感激。

[编辑]

经过一些初始测试（在循环中运行两个场景）后，探查器给出的值似乎是准确的。

正如添加的信息一样，我在 Windows XP Pro 上运行 .Net 2.0，在 Windows 2000 上为 DB 运行 SQL Server 2000。

[更新]

经过一番挖掘，我找到了这篇[博文](http://www.u2u.info/Blogs/U2U/Lists/Posts/Post.aspx?ID=11)，这可能是相关的。似乎 .Net 中的字符串值（因为它们是 unicode）被自动创建为 nvarchar 参数。我将不得不等到星期一开始工作，看看我是否可以解决这个问题。似乎我必须设置数据类型，这是我试图避免的。

这个问题并没有出现在我所做的每个查询中，只是选择了几个，所以我仍然可能只是在有问题的查询中设置 DBType，但我正在寻找一个更通用的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T15:50:58.973

该问题与 SQL Server 如何进行隐式类型转换有关。如果使用 NVARCHAR 值（即 N'some text'）过滤 VARCHAR 列，SQL 将别无选择，只能将该列转换为 NVARCHAR，因为 NVARCHAR 不能隐式转换回 VARCHAR。

最好的解决方法是指定类型或将数据库列更改为 NVARCHAR。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:08:18.843

我刚刚遇到了这个确切的问题。我有一个带有很多 char 列的旧数据库。在不指定列类型的情况下，我的一个查询的结果需要几分钟时间。（它默认为 nvarchar。）指定列类型导致结果需要几秒钟。

```
cmd.Parameters.AddWithValue("charcolumn", "stringvalue");
cmd.Parameters[0].SqlDbType = SqlDbType.Char; 
```

我想我将尝试将每个字符串查询都设为 char 类型，看看效果如何。

[编辑]

实际上......阅读此内容后： [http ://www.u2u.info/Blogs/U2U/Lists/Posts/Post.aspx?ID=11](http://www.u2u.info/Blogs/U2U/Lists/Posts/Post.aspx?ID=11)

我决定采用这个解决方案：

```
cmd.Parameters.AddWithValue(colName, val);
if(val is string)
  cmd.Parameters[i].DbType = DbType.AnsiString; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T22:37:01.480

两种情况下生成的 SQL 语句是什么？

我怀疑当您没有明确指定它时，它会将值假定为 varchar 。

例如`SELECT OrderId FROM Orders WHERE OrderId = 1001`
与`SELECT OrderId FROM Orders WHERE OrderId = '1001'`

# design-patterns - 处理多个状态的输入和状态更改的最佳方法？

> ID：345324
> 
> 赞同：1
> 
> 时间：2008-12-05T22:04:35.553
> 
> 标签：design-patterns, refactoring

我有一个具有多个状态的应用程序，每个状态对输入的响应不同。

最初的实现是通过一个大的 switch 语句完成的，我使用状态模式对其进行了重构（至少，我认为它是状态模式。我对使用设计模式有点陌生，所以我倾向于让他们感到困惑） -

```
class App {

  public:
    static App * getInstance();
    void addState(int state_id, AppState * state) { _states[state_id] = state; }
    void setCurrentState(int state_id) { _current_state = _states[state_id]; }

  private:
    App()
    ~App();
    std::map<int, AppState *> _states;
    AppState * _current_state;
    static App * _instance;
}

class AppState {

  public:
    virtual void handleInput() = 0;
    virtual ~AppState();

  protected:
    AppState();

} 
```

目前，每个状态都在轮询操作系统的输入，并采取相应的行动。这意味着每个具体状态都有一个巨大的 switch 语句，每个有效按键都有一个 case。某些情况调用函数，而其他情况使用 App::setCurrentState(newstate) 发出状态更改。问题是，在一个状态下做某事的键在另一种状态下可能不会做任何事情（或者在极少数情况下，可能会做不同的事情）。

好的，我认为这是相关的背景。这是实际的问题-

首先，消除具体状态中巨大的 switch 语句的最佳方法是什么？ [这个问题](https://stackoverflow.com/questions/126409/ways-to-eliminate-switch-in-code#126475)暗示了命令模式，但我不明白我将如何在这里使用它。有人可以帮忙解释一下，或提出其他解决方案吗？

附带说明一下，我考虑过（并且不反对）让 App 类轮询操作系统，然后将输入传递给 _current_state->handleInput 的想法。事实上，有些事情告诉我，我希望将其作为重构的一部分。我只是还没做。

其次，通过调用 App::setCurrentState(newstate) 进行状态更改。我意识到这类似于使用全局变量，但我不确定是否有更好的方法来做到这一点。我的主要目标是能够在不修改 App 类的情况下添加状态。这里也欢迎提出建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T05:17:14.823

我已经重构了一些东西 -

通过要求将指向状态机 (App) 的指针传递给 AppState 构造函数，我消除了对 App::setCurrentState 的直接调用。这样，所有必要的调用都可以通过该指针进行。

我已经向handleInput 添加了一个参数，并使其能够让App 执行操作系统输入轮询并将任何输入传递到当前状态。

新代码如下所示 -

```
class App {

  public:
    static App * getInstance();
    void addState(int state_id, AppState * state) { _states[state_id] = state; }
    void setCurrentState(int state_id) { _current_state = _states[state_id]; }

  private:
    App()
    ~App();
    std::map<int, AppState *> _states;
    AppState * _current_state;
    static App * _instance;
}

class AppState {

  public:
    virtual void handleInput(int keycode) = 0;
    virtual ~AppState();

  protected:
    AppState(App * app);
    AppState * _app;

} 
```

所以这仍然会在每个状态中留下一个大的 switch 语句，将按键转换为特定于状态的操作。我想我可以用动作键映射替换开关，但我仍然想知道是否有更好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T16:52:28.257

鉴于您的重构，现在的问题似乎是如何减少将在您的各种具体 AppState 实现中重复的键码解析代码的数量。正如您所提到的，这会导致多个 switch 语句选择调用哪个代码来处理击键输入。

根据此代码的性能关键程度，您可以将该键码解码逻辑分离为 App 中的 processInput(int keycode) 方法（或作为 AppState 中的具体方法）并在 AppState 类中创建一组 handle*Pressed() 函数. 根据您要处理的击键类型的数量，这可能是合理的，或者可能导致实现的方法太多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T22:11:23.827

我写了一个库，在那里我重构了很多状态的东西。它很干净而且非常面向对象，并且并没有真正增加很多开销，但它是一种完全不同的状态机编码方式。

它包括几个测试，如果没有别的，他们可能会给你一些想法。

如果您喜欢，欢迎您查看：[http ://code.google.com/p/state-machine/](http://code.google.com/p/state-machine/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T22:18:21.737

如果您能够捕获一个类中的所有操作系统输入，那么您可以拥有一个侦听输入的对象，并使用责任链模式来通知操作系统输入的特定操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T00:53:46.367

你把事情看成：

我有一个用于状态（您的应用程序）的静态容器，以及许多状态（您的 AppState），它们可以包含数据并且只有一个处理程序。

而是将其视为：

我有一个 StateMachine 类。（我可能有也可能没有很多实例。）这包含与外部世界交互所需的数据。还包含一组静态事件处理程序，每个状态一个。这些 eventHandler 类不包含数据。

```
class StateMachine {
public:
    void handleInput() { //there is now only one dispatcher
        if( world.doingInput1() )
            _current_state->handleInput1( *this );

        else if( world.doingInput2() )
            _current_state->handleInput2( *this, world.get_Input2Argument() );

        //...
    }

    //the states, just a set of event handlers
    static const State& state1;
    static const State& state2;
    //...

    StateMachine( OutsideWorld& world )
       :world( world )  
    {
        setCurrentState( StateMachine::state1 );
    }

    void setCurrentState( const State& state ) { _current_state = &state; }

    OutsidWorld& world;
private:
    State* _current_state;
};

class State {
public:
    //virtual ~State(); //no resources so no cleanup
    virtual void handleInput1( StateMachine& sm ) const {};
    virtual void handleInput2( StateMachine& sm, int myParam ) const {};
    //...
};

class State1 {
public:
    //define the ones that actually do stuff
    virtual void handleInput1( StateMachine& sm ) const { 
       sm.world.DoSomething();
       sm.setCurrentState( StateMachine::state27 );
    }
    virtual void handleInput27( StateMachine& sm, int myParam ) const { 
       sm.world.DoSomethingElse( myParam );
    };
};
const State& StateMachine::state1 = *new State1();

//... more states 
```

# asp.net-mvc - ASP.Net MVC UserControls 中处理 CSS 的策略

> ID：345329
> 
> 赞同：2
> 
> 时间：2008-12-05T22:06:15.833
> 
> 标签：asp.net-mvc, css

我刚刚开始使用 ASP.Net MVC 框架，今天我创建了一个使用一些 CSS 的简单 UserControl。由于 CSS 在单独的文件中声明并包含在调用 UserControl 的视图中，而不是在 UserControl 本身中，因此 Visual Studio 找不到 UserControl 中使用的任何 CSS 类。这让我开始思考在 UserControls 中处理 CSS 的最合适方式是什么。

如果在不同的上下文中使用相同的控件并且需要能够适应调用视图的样式，则在使用 UserControl 的视图中声明 CSS 会提供更大的灵活性。

让 UserControl 提供它自己的 CSS 将导致更清晰的分离，并且视图不需要知道有关 UserControl 生成的 HTML/CSS 的任何信息，但代价是控件的固定外观。

由于我对框架完全陌生，我猜人们已经对此得出了一些好的结论。

那么，你会让 UserControl 处理它自己的 CSS，它应该依赖于调用视图中声明的 CSS，还是有另一个更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T22:21:39.577

它应该始终在您的全局 CSS 中。如果你把它传递给设计师，你不想解释哪个控件定义了 x 样式等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T04:00:42.700

如果您查看像 Yahoo UI 这样的可皮肤工具包，它会记录每个控件使用的类，然后为整个工具包提供单个皮肤文件。通过换出单个皮肤文件，您可以更改整个站点的外观。

我假设 99.9% 的时间你会想要自定义你的控件的皮肤，而不是让它们预定义的外观和感觉。

作为示例[，这里](http://developer.yahoo.com/yui/tabview/#cssref)是 Yahoo 的 TabView 控件的 CSS 定义

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T22:34:22.250

快速点...您的视图可以了解 HTML...这就是它们的用途。我会推荐（如果你想变得更酷），是在你的“ [MVC UserControl](http://www.singingeels.com/Articles/Building_Custom_ASPNET_MVC_Controls.aspx) ”中添加一个参数来指定类名。例子：

```
<%= MyHelperClass.Marquee("This text will scroll!!!", "important-text") %> 
```

我当然假装“重要文本”是我想添加到我的控件的类名。

我假设当您说“UserControl”时，您指的是上面那个链接中的示例。

# reporting-services - Project Server 2007 报告数据库中的“工作”字段之间的关系是什么？

> ID：345341
> 
> 赞同：0
> 
> 时间：2008-12-05T22:10:02.423
> 
> 标签：reporting-services, project-server

Project Server 2007 中的报告数据库有大约 7 个基于分配、资源、任务和项目的“用户视图”。它们都有 Work、OvertimeWork、ActualWork、MaterialWork、BudgetWork、ActualRegularWork 的字段。所有这些字段如何根据公式相关联。我找不到关于它的好资源。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T17:58:00.207

从 Microsoft Office Online 中尝试此参考： [项目：字段参考](http://office.microsoft.com/en-us/project/HA102369301033.aspx?pid=CH100788901033)

# asp.net - 计算访问 ASP.NET Web 应用程序的最简单方法？

> ID：345343
> 
> 赞同：3
> 
> 时间：2008-12-05T22:11:26.977
> 
> 标签：asp.net

在 ASP.NET Web 应用程序中计算用户访问次数的最简单方法是什么？

我们的应用程序服务匿名用户、注册用户和中间用户，称为“潜在客户”。潜在客户是请求信息但不创建帐户的用户。

我们为每种类型的用户留下一个 ID cookie，这是我们数据库中访问信息的关键。

潜在客户本身永远不会“登录”，但我们仍然想计算这些访问量。我们还希望计算会员访问次数，即使他们没有登录。

我正在考虑存储 ASP.NET 会话 cookie，然后在每次会话 cookie 更改时递增我们的计数器。

有人已经解决了这个问题，或者有什么建议吗？

PS：我们是 ASP.NET 1.1

细化：我们希望这些数据在我们的应用程序的数据库中，所以谷歌分析不是一个合理的解决方案......我们正在使用谷歌分析。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T22:27:52.823

使用[谷歌分析](http://www.google.com/analytics/)。您可以很容易地指定导致这些目标的“目标”和“漏斗”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T22:26:44.527

由于您在 Global.aspx... 中使用 1.1... 在 App_EndRequest （或其他）中，将一条记录插入到具有名称、IPAddress、时间戳等的数据库中。

编辑：不要做会话的事情，会话可以被清除，加上你将如何在几天或几周后报告它们......插入一条记录（包括 Request.Url.Path 如果你想拥有这些类型的统计数据）。

因为它在 EndRequest 方法上，所以即使出现某种故障也是相当安全的……而且，性能并不重要，因为用户已经将他的页面发送给了他。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T22:27:27.897

> 我们为每种类型的用户留下一个 ID cookie，**这是我们数据库中访问信息的关键**

听起来你已经有了一个计数器，你只需要想办法让这些数据有用。

```
SELECT COUNT(1) FROM TblUsers WHERE UserType = 'Prospect' AND DateRange Between.... 
```

# apache-flex - PlotChart/LineChart 直线系列上的垂直线性渐变

> ID：345352
> 
> 赞同：2
> 
> 时间：2008-12-05T22:13:53.820
> 
> 标签：apache-flex, actionscript-3, graph

我想构建一个 LineChart 组件，其中线条的颜色指示值的高低。我应该能够只使用渐变笔划（见下文）进行此购买，但由于某种原因，渐变仅从左到右，并且“角度”属性被忽略。我怎么能这样做？

```
 <mx:PlotChart id="bpChart" width="514" height="144" dataProvider="{measurementsXLC}"   >
    <mx:series>
        <mx:LineSeries id="bpSeries" displayName="Series 1" yField="value" xField="date" showDataEffect="fade" stroke="{lstroke}">
            <mx:lineStroke>
                <mx:LinearGradientStroke angle="270.0" weight="3"  scaleMode="vertical"  >
                    <mx:entries>
                        <mx:GradientEntry color="#ff0000" ratio="0.0"/>
                        <mx:GradientEntry color="#00ff00" ratio="1.0"/>                         
                    </mx:entries>
                </mx:LinearGradientStroke>
            </mx:lineStroke>
            <mx:itemRenderer>
                <mx:Component>
                    <mx:CircleItemRenderer >

                    </mx:CircleItemRenderer>
                </mx:Component>                 
            </mx:itemRenderer>
        </mx:LineSeries>
        <mx:LineSeries id="bpSeries2" displayName="Series 1" yField="value2" xField="date" showDataEffect="fade"  />
    </mx:series>
    <mx:horizontalAxis>
        <mx:DateTimeAxis id="dateAxis" dataUnits="milliseconds" labelUnits="days" />
    </mx:horizontalAxis>
    <mx:verticalAxis>
        <mx:LinearAxis baseAtZero="false" autoAdjust="true" interval="5" />

    </mx:verticalAxis>
</mx:PlotChart> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T08:34:28.873

在遇到同样的问题并使用上面 James Hay 的解释/示例后，我构建了自己的 LineSegmentRenderer。

基本上我想在我的 lineChart 中有一个从上到下的渐变笔画。我也发现LineSegmentRenderer中LinearGradientStroke的角度或更准确的旋转属性无效，所以我复制了ShadowLineRenderer并编辑了它的updateDisplayList方法（见下面的代码）。

在此 updateDisplayList 方法中，LineSeries lineStroke 属性设置为 LinearGradientStroke，因此我可以使用在“调用”/lineChart 构造 MXML 模块中设置的描边颜色条目（其中还设置了描边粗细）。

我发现创建从上到下渐变的基本部分是在定义 lineGradientStyle 时使用 GradientBox。对于从上到下的渐变，GradientBox 旋转属性设置为 PI/2（相当于 90 度）。可以从笔画旋转属性（可以在 LineSeries lineStroke 属性中设置）派生此旋转属性（使用度数到弧度的转换），因此您可以避免在此渲染器中对旋转属性进行硬编码，而是使用此自定义渲染器时使其成为可调整的参数。

见代码：

```
 override protected function updateDisplayList(unscaledWidth:Number,
                                                  unscaledHeight:Number):void
    {
        super.updateDisplayList(unscaledWidth, unscaledHeight);

        var stroke:LinearGradientStroke = getStyle("lineStroke");
        var form:String = getStyle("form");
        var gradientBoxMatrix:Matrix = new Matrix();
        gradientBoxMatrix.createGradientBox(unscaledWidth,0.9*(unscaledHeight),Math.PI/2,0,-0.05*(unscaledHeight));
        graphics.clear();
        graphics.lineStyle(stroke.weight,0);

        graphics.lineGradientStyle(GradientType.LINEAR,[stroke.entries[0].color,stroke.entries[1].color],[1,1],[0,255],gradientBoxMatrix);

        graphics.moveTo(_lineSegment.items[_lineSegment.start].x,_lineSegment.items[_lineSegment.start].y);
        graphics.lineTo(_lineSegment.items[_lineSegment.end].x,_lineSegment.items[_lineSegment.end].y);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T09:39:08.933

我希望您需要为线系列图表创建一个自定义 lineSegmentRenderer。当前 lineSegmentRenderer 是 ShadowLineRenderer。如果我自己没有真正解决整个问题，我会创建一个基于 ShadowLineRenderer 的新类并更改 updateDisplayList 方法以完全按照您的需要绘制线条。然后更改线条系列的 lineSegmentRenderer 属性以使用此渲染器。

如果它有帮助，我必须做一个非常相似的事情，但使用 AreaRenderer。区域渐变必须基于总图表，而不是为显示的任何区域着色完整渐变（例如，使用常规区域渲染器，如果区域仅覆盖 y 轴的前 20%，它仍然使用完整的渐变，这对我的项目来说是一个不受欢迎的功能）。这是我的问题的解决方案，我创建了自己的 AreaRenderer 并更新了 updateDisplayList 方法：

```
override protected function updateDisplayList(unscaledWidth:Number,
                                                  unscaledHeight:Number):void
    {
        super.updateDisplayList(unscaledWidth, unscaledHeight);

        var fill:IFill = GraphicsUtilities.fillFromStyle(getStyle("areaFill"));
        var stroke:IStroke = getStyle("areaStroke");
        var form:String = getStyle("form");

        var g:Graphics = graphics;
        g.clear();

        if (!_area)
            return;

        var boundary:Array /* of Object */ = _area.filteredCache;
        var n:int = boundary.length;
        if (n <= 1)
            return;

        var xMin:Number;
        var xMax:Number = xMin = boundary[0].x;
        var yMin:Number;
        var yMax:Number = yMin = boundary[0].y;

        var i:int;
        var v:Object;

        for (i = 0; i < n; i++)
        {
            v = boundary[i];

            xMin = Math.min(xMin, v.x);
            yMin = Math.min(yMin, v.y);
            xMax = Math.max(xMax, v.x);
            yMax = Math.max(yMax, v.y);

            if (!isNaN(v.min))
            {
                yMin = Math.min(yMin, v.min);
                yMax = Math.max(yMax, v.min);
            }
        }

        if (fill)
            fill.begin(g, new Rectangle(0, 0, unscaledWidth, unscaledHeight));

        GraphicsUtilities.drawPolyLine(g, boundary, 0, n,
                                        "x", "y", stroke, form);

        g.lineStyle(0,0,0); 

        if(boundary[0].element.minField != null && boundary[0].element.minField != "")
        {
            g.lineTo(boundary[n - 1].x, boundary[n - 1].min);       

            GraphicsUtilities.drawPolyLine(g, boundary, n - 1, -1,
                                            "x", "min", noStroke, form, false);
        }
        else
        {
            g.lineTo(boundary[n - 1].x, _area.renderedBase);        
            g.lineTo(boundary[0].x, _area.renderedBase);
        }

        g.lineStyle(0, 0, 0);
        g.lineTo(boundary[0].x, boundary[0].y);

        g.endFill();
    } 
```

# visual-studio - VS2008 Windows 窗体设计器不喜欢我的控件

> ID：345354
> 
> 赞同：0
> 
> 时间：2008-12-05T22:14:04.117
> 
> 标签：visual-studio, winforms, visual-studio-2008, windows-forms-designer

我有一个这样创建的控件：

```
public partial class MYControl : MyControlBase
{
    public string InnerText {
        get { return textBox1.Text; }
        set { textBox1.Text = value; } 
    }
    public MYControl()
    {
        InitializeComponent();
    }
}

partial class MYControl
{
    /// <summary> 
    /// Required designer variable.
    /// </summary>
    private System.ComponentModel.IContainer components = null;

    /// <summary> 
    /// Clean up any resources being used.
    /// </summary>
    /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
    protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
    }

    #region Component Designer generated code

    /// <summary> 
    /// Required method for Designer support - do not modify 
    /// the contents of this method with the code editor.
    /// </summary>
    private void InitializeComponent()
    {
        this.textBox1 = new System.Windows.Forms.TextBox();
        this.listBox1 = new System.Windows.Forms.ListBox();
        this.label1 = new System.Windows.Forms.Label();
        this.SuspendLayout();
        // 
        // textBox1
        // 
        this.textBox1.Location = new System.Drawing.Point(28, 61);
        this.textBox1.Name = "textBox1";
        this.textBox1.Size = new System.Drawing.Size(100, 20);
        this.textBox1.TabIndex = 0;
        // 
        // listBox1
        // 
        this.listBox1.FormattingEnabled = true;
        this.listBox1.Location = new System.Drawing.Point(7, 106);
        this.listBox1.Name = "listBox1";
        this.listBox1.Size = new System.Drawing.Size(120, 95);
        this.listBox1.TabIndex = 1;
        // 
        // label1
        // 
        this.label1.AutoSize = true;
        this.label1.Location = new System.Drawing.Point(91, 42);
        this.label1.Name = "label1";
        this.label1.Size = new System.Drawing.Size(35, 13);
        this.label1.TabIndex = 2;
        this.label1.Text = "label1";
        // 
        // MYControl
        // 
        this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
        this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
        this.Controls.Add(this.label1);
        this.Controls.Add(this.listBox1);
        this.Controls.Add(this.textBox1);
        this.Name = "MYControl";
        this.Size = new System.Drawing.Size(135, 214);
        this.ResumeLayout(false);
        this.PerformLayout();

    }

    #endregion

    private System.Windows.Forms.Label label1;
} 
```

MyControlBase 包含 ListBox 和 TextBox 的定义。现在，当我尝试在表单设计器中查看此控件时，它给了我这些错误：

> 变量“listBox1”要么未声明，要么从未赋值。
> 
> 变量“textBox1”要么未声明，要么从未赋值。

这显然是错误的，因为它们是在具有公共访问权限的 MyControlBase 中定义的。有什么方法可以让表单设计器让我直观地编辑我的控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T22:31:21.210

我认为您必须使用**base.listBox1**和**base.textBox1**。它们是在基类 MyControlBase 中定义的，而不是您需要使用*this*关键字的子类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T22:41:27.150

不知道这是不是您的问题，但是当在同一个 .cs 文件中定义多种类型时，设计器会遇到麻烦。如果是这种情况，请尝试为每个类使用一个 .cs 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T22:46:54.940

有时（总是？）VS 需要您重新编译您的项目，然后才能在设计器中成功显示您的用户控件。

还要考虑到 VS 设计器实际上会加载并实例化您的控件以在表单上显示它。您的代码实际上是在后台运行的。然而，它不会拥有它可能期望的所有东西——比如一些全局应用程序变量，甚至是同一表单上的其他东西。您的控件必须为“设计模式”做好准备。否则，如果它生成异常，设计器将不会显示它。每个控件都有一个属性（不记得名称，但您应该很容易找到它），它允许您确定控件是处于“设计模式”还是实际运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T23:02:12.600

编译器是正确的（因为它往往是）。

源代码中既没有定义 textbox1 也没有定义 listbox1。它们不会出现在派生类或基类中。

您应该将以下内容添加到您的基类中：

```
protected System.Windows.Forms.TextBox textbox1; 
protected System.Windows.Forms.ListBox listbox1; 
```

如果您决定对 textbox1 和 listbox1 使用 private 而不是 protected，您还需要执行 Nazgulled 概述的更改。

# python - 为什么 Python 2.6 没有设置文字和理解或 dict 理解？

> ID：345356
> 
> 赞同：14
> 
> 时间：2008-12-05T22:14:21.900
> 
> 标签：python, python-3.x

Python 2.6 基本上是让转换到 Python 3 更容易的垫脚石。如果不破坏与语法和类库的向后兼容性，许多注定要用于 Python 3 的特性都是在 2.6 中实现的。

为什么其中没有集合文字 ( `{1, 2, 3}`)、集合推导 ( `{v for v in l}`) 或 dict 推导 ( `{k: v for k, v in d}`)？特别是 dict 理解将是一个巨大的福音......我发现自己`dict([(k, v) for k, v in d])`最近使用相当丑陋的东西。

是否有明显的我遗漏的东西，或者这只是一个没有成功的功能？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-05T23:35:46.120

It wasn't done because nobody took the time to do it. There are bugs opened for months, and no one commented on them:

*   [http://bugs.python.org/issue2333](http://bugs.python.org/issue2333)
*   [http://bugs.python.org/issue2334](http://bugs.python.org/issue2334)
*   [http://bugs.python.org/issue2335](http://bugs.python.org/issue2335)

So it wasn't important enough for anybody to care, probably.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-05T23:29:40.093

# java - JOGL 如何搜索 OpenGL 库？

> ID：345363
> 
> 赞同：4
> 
> 时间：2008-12-05T22:16:26.263
> 
> 标签：java, opengl, jogl

我正在使用 JOGL 编写一个桌面应用程序，并在 Win/Mac/Linux 上进行部署。在 Linux 上，我们发现安装的 OpenGL 库并不总是能够胜任工作，我们需要能够切换我们自己的软件仿真 OpenGL。自然我们希望我们可以将库放置*在*/usr/lib 之后或/*之前*usr/lib 支持我们的或默认的。

事实证明，我们的被 JOGL 优先接收。有谁知道 JOGl 库是否进行特殊处理以寻找 libGL 等，可能更喜欢更高版本而不是更早版本？欢迎任何信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-05T13:19:50.727

我假设 JOGL 的 Java 端使用 JNI（Java 本机接口）与本机库进行交互。JNI 使用这个 Java 系统变量**java.library.path**来查找本地库。您可以在运行 Java 应用程序时使用 -D 开关在命令行上设置它：

```
java -Djava.library.path=/some/path mypackage.MyProgram 
```

也可能是本机系统本身没有选择正确的 OpenGL 库。在 Linux 上，您可以设置环境变量 LD_LIBRARY_PATH 来指定 Linux 应该在哪里查找共享库。[本页](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)解释更多（参见第 3.3.1 节）。

请注意，您可以在 JOGL 主页上获得 JOGL 的源代码，所以如果您真的想知道，可以下载并开始深入研究。

（为什么会有一个愚蠢的限制“新用户只能发布一个超链接”？？？？）

# iphone - iPhone 键盘上的 shift 键被禁用

> ID：345367
> 
> 赞同：6
> 
> 时间：2008-12-05T22:19:06.993
> 
> 标签：iphone, cocoa-touch, keyboard, shift

我有一个`UITextField`弹出的键盘`Shift`禁用了它的键。键盘类型设置为`UIKeyboardTypeNamePhonePad`，这似乎应该允许大写字母。

如果我将键盘类型更改为“默认”但不理会其他设置，则该`Shift`键处于活动状态。其他设置是：

*   自动大写和自动更正关闭
*   默认外观
*   返回键“完成”

我正在运行 iPhone OS 2.2。

有人见过这个吗？我不明白为什么“姓名电话键盘”类型会禁用该`Shift`键。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-31T17:43:05.333

我不确定这个决定背后的逻辑是什么，但*看起来没有办法在这个键盘上启用 shift 键*。我自己玩了一段时间，发现[这篇](https://stackoverflow.com/questions/4707449/iphone-uikeyboardtypenamephonepad-with-shift-key)文章似乎同意。您可能需要使用默认键盘并过滤掉您不想要的任何符号（不是理想的 UI，但很容易做到），或者创建[自定义键盘](http://blog.carbonfive.com/2012/03/12/customizing-the-ios-keyboard/)（[示例](https://github.com/lnafziger/Numberpad)）

# asp.net-mvc - 如何让 R# 不重新格式化 ASP.NET MVC 意大利面条代码

> ID：345374
> 
> 赞同：1
> 
> 时间：2008-12-05T22:20:51.590
> 
> 标签：asp.net-mvc, resharper

当我在 MVC 视图中编写意大利面条式代码时，R# 会自动将大括号放到下一行并缩进等。有没有办法只为我的视图页面关闭它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T19:48:28.990

正如克里斯在评论中所说，这是不可能的。

# sql - SQL Server 2005 密钥死锁

> ID：345380
> 
> 赞同：1
> 
> 时间：2008-12-05T22:22:38.827
> 
> 标签：sql, sql-server

我在 uniqueidentifier 列上有一个带有聚集主键索引的表。我有一个运行以下伪函数的过程：

```
begin transaction
read from table 1
insert into table 2
update table 1 with pointer to table 2 record
commit transaction 
```

这一切都很好，直到从其他地方同时执行相同的过程。一旦发生这种情况，每次执行都会在主键上陷入死锁并终止。

知道我能做些什么来防止这种情况，除了简单地说“不要同时运行它”吗？事务当前以 READ COMMITTED 隔离级别运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T22:48:17.510

1.  正如 eulerfx.myopenid.com 所暗示的那样，增加事务隔离级别。

2.  使用 sql "mutexes" 来简单地等待一个过程完成，然后再允许另一个过程运行。[http://weblogs.sqlteam.com/mladenp/archive/2008/01/08/Application-Locks-or-Mutexes-in-SQL-Server-2005.aspx](http://weblogs.sqlteam.com/mladenp/archive/2008/01/08/Application-Locks-or-Mutexes-in-SQL-Server-2005.aspx)

3.  使用快照隔离级别。取决于您的应用程序可以做什么。然而，这带来了其他问题。[http://msdn.microsoft.com/en-us/library/ms189050.aspx](http://msdn.microsoft.com/en-us/library/ms189050.aspx)

数字 2 需要比 1 更多的代码更改。但有时你不能只增加隔离级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T22:29:12.573

看这里：

[http://msdn.microsoft.com/en-us/library/aa213026(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa213026(SQL.80).aspx)

和这里：

[http://msdn.microsoft.com/en-us/library/aa213039(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa213039(SQL.80).aspx)

# c++ - 通过内存捕获 MSN 聊天

> ID：345382
> 
> 赞同：2
> 
> 时间：2008-12-05T22:24:03.863
> 
> 标签：c++, chat, capture, msn

是否有可能，或者有人知道捕获 MSN 聊天的最佳方法吗？我正在考虑附加到 MSN 进程，并搞砸搜索静态地址以进行对话，以捕获它们。

（这都是在windows平台上使用c++）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T22:54:20.353

在已知由 MSN 使用的端口上嗅探数据包可能是最容易的。这具有与 Microsoft 以外的客户（例如 Pidgin）合作的额外好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T22:46:12.240

假设协议是未加密的，那么附加到进程并拦截网络流量可能比搜索所有应用程序内存中的聊天更容易。但这也不是一项小任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T23:06:50.483

天哪，我刚用谷歌搜索，发现周围有一个完整的家庭手工业。支付 60 美元以上来录制 MSN 聊天 - 你在开玩笑吗？..拜托~有人发布一个开源解决方案。

# wpf - WPF 文本块与 List 的绑定

> ID：345385
> 
> 赞同：15
> 
> 时间：2008-12-05T22:26:31.890
> 
> 标签：wpf, generics, text, binding

有谁知道是否有一种简单的方法可以将文本块绑定到列表。到目前为止我所做的是创建一个列表视图并将其绑定到列表，然后我在列表视图中有一个使用单个文本块的模板。

我真正想做的只是将列表绑定到一个文本块并让它显示所有行。

在 Winforms 中有一个“Lines”属性，我可以将 List 放入其中，但在 WPF 文本块或 TextBox 上看不到它。

有任何想法吗？

我错过了一些简单的事情吗？

这是代码

```
<UserControl x:Class="QSTClient.Infrastructure.Library.Views.WorkItemLogView"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         Width="500" Height="400">
<StackPanel>
    <ListView ItemsSource="{Binding Path=Logs}" >
        <ListView.View>
            <GridView>
                <GridViewColumn Header="Log Message">
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding}"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView>
</StackPanel> 
```

和 WorkItem 类

```
public class WorkItem
{
    public string Name { get; set; }
    public string Description { get; set; }
    public string CurrentLog { get; private set; }
    public string CurrentStatus { get; private set; }
    public WorkItemStatus Status { get; set; }
    public ThreadSafeObservableCollection<string> Logs{get;private set;} 
```

我正在使用 Prism 创建控件并将其放入 WindowRegion

```
 WorkItemLogView newView = container.Resolve<WorkItemLogView>();
        newView.DataContext = workItem;
        regionManager.Regions["ShellWindowRegion"].Add(newView); 
```

谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-12-05T23:35:29.147

将您的列表转换为单个字符串，其中 "\r\n" 作为分隔符。并将其绑定到 TextBlock。确保 TextBlock 不受其高度的限制，以便它可以根据行数增长。我会将其实现为 XAML 绑定的值转换器，它将字符串列表转换为单个字符串，并在其间添加新行

```
<TextBlock Text="{Binding Path=Logs,Converter={StaticResource ListToStringConverter}}"/> 
```

ListToStringConverter 看起来像这样：

```
[ValueConversion(typeof(List<string>), typeof(string))]
public class ListToStringConverter : IValueConverter
{

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if (targetType != typeof(string))
            throw new InvalidOperationException("The target must be a String");

        return String.Join(", ", ((List<string>)value).ToArray());
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-09T08:20:06.823

如果您使用转换器，它第一次可以完美运行，但是如果一个或多个日志记录出现在日志记录列表中，则您的绑定没有更新，因为转换器仅在第一次工作。所有不是项目控件的控件都不会订阅 listchanged 事件！

这是这种情况的一些代码

```
using System;
using System.Collections.ObjectModel;
using System.Windows;

namespace BindListToTextBlock
{
  /// <summary>
  /// Interaction logic for MainWindow.xaml
  /// </summary>
  public partial class MainWindow : Window
  {
    private WorkItem workItem;

    public MainWindow() {
      this.WorkItems = new ObservableCollection<WorkItem>();
      this.DataContext = this;
      this.InitializeComponent();
    }

    public class WorkItem
    {
      public WorkItem() {
        this.Logs = new ObservableCollection<string>();
      }

      public string Name { get; set; }
      public ObservableCollection<string> Logs { get; private set; }
    }

    public ObservableCollection<WorkItem> WorkItems { get; set; }

    private void Button_Click(object sender, RoutedEventArgs e) {
      this.workItem = new WorkItem() {Name = string.Format("new item at {0}", DateTime.Now)};
      this.workItem.Logs.Add("first log");
      this.WorkItems.Add(this.workItem);
    }

    private void Button_Click_1(object sender, RoutedEventArgs e) {
      if (this.workItem != null) {
        this.workItem.Logs.Add(string.Format("more log {0}", DateTime.Now));
      }
    }
  }
} 
```

xml

```
<Window x:Class="BindListToTextBlock.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:BindListToTextBlock="clr-namespace:BindListToTextBlock"
        Title="MainWindow"
        Height="350"
        Width="525">
  <Grid>
    <Grid.Resources>
      <BindListToTextBlock:ListToStringConverter x:Key="ListToStringConverter" />
    </Grid.Resources>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition />
    </Grid.RowDefinitions>
    <Button Grid.Row="0"
            Content="Add item..."
            Click="Button_Click" />
    <Button Grid.Row="1"
            Content="Add some log to last item"
            Click="Button_Click_1" />
    <ListView Grid.Row="2"
              ItemsSource="{Binding Path=WorkItems}">
      <ListView.View>
        <GridView>
          <GridViewColumn Header="Name">
            <GridViewColumn.CellTemplate>
              <DataTemplate>
                <TextBlock Text="{Binding Path=Name}" />
              </DataTemplate>
            </GridViewColumn.CellTemplate>
          </GridViewColumn>
          <GridViewColumn Header="Log Message">
            <GridViewColumn.CellTemplate>
              <DataTemplate>
                <TextBlock Text="{Binding Path=Logs, Converter={StaticResource ListToStringConverter}}" />
              </DataTemplate>
            </GridViewColumn.CellTemplate>
          </GridViewColumn>
        </GridView>
      </ListView.View>
    </ListView>
  </Grid>
</Window> 
```

转换器

```
using System;
using System.Collections;
using System.Globalization;
using System.Linq;
using System.Windows;
using System.Windows.Data;

namespace BindListToTextBlock
{
  public class ListToStringConverter : IValueConverter
  {
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture) {
      if (value is IEnumerable) {
        return string.Join(Environment.NewLine, ((IEnumerable)value).OfType<string>().ToArray());
      }
      return "no messages yet";
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) {
      return DependencyProperty.UnsetValue;
    }
  }
} 
```

**编辑**

这是更新问题的快速解决方案（也可以使用附加属性进行）

```
public class CustomTextBlock : TextBlock, INotifyPropertyChanged
{
  public static readonly DependencyProperty ListToBindProperty =
    DependencyProperty.Register("ListToBind", typeof(IBindingList), typeof(CustomTextBlock), new PropertyMetadata(null, ListToBindPropertyChangedCallback));

  private static void ListToBindPropertyChangedCallback(DependencyObject o, DependencyPropertyChangedEventArgs e)
  {
    var customTextBlock = o as CustomTextBlock;
    if (customTextBlock != null && e.NewValue != e.OldValue) {
      var oldList = e.OldValue as IBindingList;
      if (oldList != null) {
        oldList.ListChanged -= customTextBlock.BindingListChanged;
      }
      var newList = e.NewValue as IBindingList;
      if (newList != null) {
        newList.ListChanged += customTextBlock.BindingListChanged;
      }
    }
  }

  private void BindingListChanged(object sender, ListChangedEventArgs e)
  {
    this.RaisePropertyChanged("ListToBind");
  }

  public IBindingList ListToBind
  {
    get { return (IBindingList)this.GetValue(ListToBindProperty); }
    set { this.SetValue(ListToBindProperty, value); }
  }

  private void RaisePropertyChanged(string propName)
  {
    var eh = this.PropertyChanged;
    if (eh != null) {
      eh(this, new PropertyChangedEventArgs(propName));
    }
  }

  public event PropertyChangedEventHandler PropertyChanged;
} 
```

这是`CustomTextBlock`（未测试）的用法

```
<TextBlock Text="{Binding Path=ListToBind, RelativeSource=Self, Converter={StaticResource ListToStringConverter}}"
           ListToBind={Binding Path=Logs} /> 
```

@Fueled 希望这会有所帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-24T14:20:39.100

我会无耻地发布一个链接，指向我对一个非常相似的问题的回答：[Binding ObservableCollection<> to a TextBox](https://stackoverflow.com/questions/4353186/binding-observablecollection-to-a-textbox/8847910#8847910)。

就像 punker76 所说，如果您将 Text 绑定到一个集合，它将在您设置集合时更新，但不会在集合更改时更新。此链接演示了 punker76 解决方案的替代方案（诀窍也是多绑定到集合的计数）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-31T09:05:13.963

对于对象的 concat 集合：

```
 /// <summary>Convertisseur pour concaténer des objets.</summary>
[ValueConversion(typeof(IEnumerable<object>), typeof(object))]
public class ConvListToString : IValueConverter {
    /// <summary>Convertisseur pour le Get.</summary>
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture) {
        return String.Join(", ", ((IEnumerable<object>)value).ToArray());
    }
    /// <summary>Convertisseur inverse, pour le Set (Binding).</summary>
    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture) {
        throw new NotImplementedException();
    }
} 
```

只是想覆盖你的对象的 ToString() 。

# asp.net-mvc - MVC 和单选按钮列表

> ID：345396
> 
> 赞同：21
> 
> 时间：2008-12-05T22:29:45.083
> 
> 标签：asp.net-mvc, html.radiobuttonlist

我试过这样做，但这只会显示单选按钮，旁边没有文字..

```
<% foreach (string s in Html.RadioButtonList("rbl")) {%>
    <% =s %>
<% } %> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-02T20:22:48.007

[Elijah Manor](https://stackoverflow.com/users/4481/elijah-manor)在 ASP.NET MVC 1.0 中写过同样的问题：

[ASP.NET MVC Html.RadioButtonList 蓝调](http://www.elijahmanor.com/asp-net-mvc-html-radiobuttonlist-blues/)

他决定遍历他的 DataSource 并创建单独的 Html.RadioButton 和 Label 组合。

```
<!-- After using and looking at the code for the Html.RadioButtonList in the ASP.NET MVC 1.0 RTM codebase, I'm not sure how it is supposed to be useful. It only outputs the actual input radio button and doesn't render any corresponding labels. To get around this I ended up writing a foreach creating individual Html.RadioButton and labels -->
<%
var radioButtonList = new SelectList(new List<ListItem> {
    new ListItem { Text = "Current", Value="false", Selected=true },
    new ListItem { Text = "Other", Value="true"}}, "Value", "Text", "false");
var htmlAttributes = new Dictionary<string, object> {
    { "class", "radioButtonList" },
    { "onclick", "if(eval(this.value)) { $('#tblDate').show('slow'); } else { $('#tblDate').hide('slow'); }" }
};
foreach (var radiobutton in radioButtonList) { %>
    <%=Html.RadioButton("rblDate", radiobutton.Value, radiobutton.Selected, htmlAttributes)%>
    <label><%=radiobutton.Text%></label>
<% } %> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-04T02:16:35.627

它曾经在预览中，但已被删除。

如果您在期货中找不到它，请尝试这样的事情

```
<% foreach (Model model in Models))
   {
%><%= String.Format("<input type=\"radio\" value=\"{0}\" name=\"{1}\" id=\"{2}\"><label for=\"{2}\">{3}</label>",
        model.ID, "fieldName", model.modelID, model.Name)  %><br />
<% } %> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-09T18:21:42.460

如果是我，我会使用一系列静态 HTML 元素。我知道有些人考虑做这样的回归到 ASP 时代，但它简化了 IMO 的事情，最终形成了一个更可靠和可预期的 [所以我编造了一个词] GUI。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-30T05:37:12.623

```
@{
    var radioButtonList = new SelectList(new List<ListItem> {
    new ListItem { Text = "1", Value="true", Selected=true },
    new ListItem { Text = "2", Value="false"},
    new ListItem { Text = "3", Value="false"},
    new ListItem { Text = "4", Value="false"},

    }, "Value", "Text", "false");

    var htmlAttributes = new Dictionary<string, object> {
    { "class", "radioButtonList" },
    { "onclick", "if(eval(this.value)) { $('#tblDate').show('slow'); } else { $('#tblDate').hide('slow'); }" }
};    
            }

@foreach (var radiobutton in radioButtonList) { 

  @Html.RadioButtonFor(m => m.ContactDepartment,  @radiobutton.Text) @radiobutton.Text

    <br/>
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-27T07:21:05.123

请参阅 Daniel Gidman 的好帮手，2012 年 6 月 14 日， [在这里](http://www.codeproject.com/Articles/404022/MVC-Enum-RadioButtonList-Helper?msg=4622386#xx4622386xx)。他为 MVC 中的 RadioButtonList 创建了一个不错且完美的助手。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-10T04:28:16.323

查看codeplex 上[MVC 源代码中提供的 MVC Futures DLL。](http://www.codeplex.com/aspnet)其中有一个 HtmlHelper 扩展来呈现 RadioButton 列表。它可以在 ViewData 中自动呈现 SelectList，或者您可以显式传递它。有几种重载可满足不同的需求。

# vba - 布尔表达式 - 运算顺序

> ID：345399
> 
> 赞同：2
> 
> 时间：2008-12-05T22:32:06.590
> 
> 标签：vba, excel, boolean, operator-precedence

我在 Excel VBA 中有一个测试：

```
如果 (test1) And (test2) And (test3) Then
    '做点什么
万一

```

在 C、Java 等中，首先运行 test1，然后是 test2，然后是 test3。至关重要的是，如果 test1 为假，则整个测试都是假的，因此剩余的测试不会运行。

在这种情况下使用 VBA 会发生这种情况吗？如果是这样，测试按什么顺序运行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-05T22:49:32.220

在 .NET 之前的所有 VB 中，没有短路之类的东西。即使不需要，也会评估所有表达式。如果您想要短期课程，请执行嵌套 IF。

# c# - 从 WCF 服务返回时出现 System.EngineExecutionException

> ID：345400
> 
> 赞同：2
> 
> 时间：2008-12-05T22:32:31.600
> 
> 标签：c#, .net, asp.net, wcf, .net-3.5

这让我们都在工作中感到困惑。我们有两个在 .net 3.5 SP1 上运行的服务，它们命中共享点，并返回非常相似的模型对象列表。其中一个工作正常，另一个在返回时抛出 EngineExecutionException。

我知道这有点模糊，但在那之前一切都执行得很好。当您在调试器中查看 List 时，一切看起来都很正常。

以前有没有人发生过这种情况？如果是这样，你做了什么来解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T22:41:30.487

好的，事实证明，如果你的数据合约中有 IList，那么框架就会崩溃。将 IList 更改为 List 作为您的返回类型，它可以工作

# python - Django MTMField：limit_choices_to = other_ForeignKeyField_on_same_model？

> ID：345401
> 
> 赞同：6
> 
> 时间：2008-12-05T22:32:52.940
> 
> 标签：python, django, foreign-keys, manytomanyfield, limit-choices-to

我有几个看起来像这样的 django 模型：

```
from django.contrib.sites.models import Site

class Photo(models.Model):
    title = models.CharField(max_length=100)
    site = models.ForeignKey(Site)
    file = models.ImageField(upload_to=get_site_profile_path) 

    def __unicode__(self):
        return self.title

class Gallery(models.Model):    
    name = models.CharField(max_length=40)
    site = models.ForeignKey(Site)
    photos = models.ManyToManyField(Photo, limit_choices_to = {'site':name} )    

    def __unicode__(self):
        return self.name 
```

我在尝试制作 Gallery 模型时获得了各种*乐趣。*`limit_choices_to`我只希望管理员显示与该画廊属于同一站点的照片的选择。这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-12-10T14:03:46.887

是的。您需要覆盖管理员用于`Gallery`模型的表单，然后限制该`photos`表单中字段的查询集：

```
class GalleryAdminForm(django.forms.ModelForm):

    class Meta:
        model = Gallery

    def __init__(self, *args, **kwargs):
        super(GalleryAdminForm, self).__init__(*args, **kwargs)
        self.fields['segments'].queryset = Photo.objects.filter(site=self.instance.site)

class GalleryAdmin(django.contrib.admin.ModelAdmin):
    form = GalleryAdminForm

django.contrib.admin.site.register(Gallery, GalleryAdmin) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T23:41:56.653

我会删除模型`site`上的字段`Photo`并添加`ForeignKey`到`Gallery`. 我会`limit_choices_to`从模型`photos`上的字段中删除`Gallery`。

因为您使用的是`ForeignKey`s to `Site`s，这意味着网站不共享画廊和照片。因此，拥有我上面提到的那些已经没有用了。

```
class Photo(models.Model):
    title = models.CharField(max_length=100)
    gallery = models.ForeignKey(Gallery, related_name='photos')
    file = models.ImageField(upload_to=get_site_profile_path) 

    def __unicode__(self):
        return self.title

class Gallery(models.Model):    
    name = models.CharField(max_length=40)
    site = models.ForeignKey(Site)

    def __unicode__(self):
        return self.name 
```

在画廊上设置后`site`，其所有照片都将继承此属性。该网站将可以通过以下方式访问`photo_instance.gallery.site`：

```
@property
def site(self):
    return self.gallery.site 
```

这应该像你有一个`site`字段一样工作。但我没有测试过。

如果您决定画廊或照片可以出现在多个站点中，事情就会发生变化。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-05T22:41:04.327

根据[文档](http://docs.djangoproject.com/en/dev/ref/models/fields/#manytomanyfield)，“limit_choices_to 在带有中间表的 ManyToManyField 上使用时无效”。根据我的阅读，这意味着它根本没有效果，因为 ManyToManyFields 使用中间表......

我没有尝试让它在管理站点中工作，但是从您自己的角度来看，您可以创建一个表单并[覆盖](https://stackoverflow.com/questions/291945/how-do-i-filter-foreignkey-choices-in-a-django-modelform)用于填充选项列表的查询集：

```
form.fields["photos"].queryset = request.user.photo_set.all() 
```

# c# - 使用 Linq 和 Trim.Text 进行搜索

> ID：345406
> 
> 赞同：1
> 
> 时间：2008-12-05T22:35:20.750
> 
> 标签：c#, linq

我正在尝试将此测试代码转换为 C# 并且 Trim 命令出现问题。有没有人在 C# 中做过类似的事情，将使用它和文本框来搜索 aspx 页面。

```
Dim q = From b In db.Blogs _
        Where b.BlogContents.Contains(txtSearch.Text.Trim()) Or _
              b.BlogTitle.Contains(txtSearch.Text.Trim()) _
        Select b 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T23:29:55.227

你有什么问题？这是什么 LINQ 提供程序？内存集（LINQ-to-Objects）？还是 LINQ-to-SQL？还是 LINQ 到实体？

我*怀疑*您对不知道 Trim() 的 db LINQ 提供程序有所了解 - 在这种情况下，请先尝试进行修剪：

```
string s = txtSearch.Text.Trim();
var q = from b in db.Blogs
        where b.BlogContents.Contains(s) || b.BlogTitle.Contains(s)
        select b; 
```

这解决~~了两个~~三个不同的问题：

1：captures：原来是`txtSearch`被捕获到查询中，有复杂性；通过评估第`Trim`一个，它`s`被捕获，这是一个简单的不可变字符串

2：表达式复杂性：使用基于表达式的LINQ（即到数据库），*整个*表达式（包括`.Text`、`.Trim`等）都是表达式的一部分。如果 LINQ 提供程序不能识别其中的一个或多个，它将​​失败。通过首先将其简化为字符串，LINQ 提供程序需要处理的只是一个字符串，每个提供程序都应该可以处理它。

（补充）3：重复计算：LINQ-to-Objects 非常字面化；如果您要求它在 Where （等）中使用复杂的操作，它*会*，即使很明显每行的答案都没有变化；即`txtSearch.Text.Trim()`不应该每行改变，那么为什么要每行评估呢？在查询之前对其进行评估，并且只执行一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T22:40:02.287

不知道你在问什么，但 c# 中的 Trim 函数是一样的。

[http://msdn.microsoft.com/en-us/library/t97s7bs3.aspx](http://msdn.microsoft.com/en-us/library/t97s7bs3.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T23:34:53.093

我在切换到 C# 时也遇到过这个问题。C# 中的智能感知要差得多：<

确保您没有`()`遗漏修剪后的内容。

# .net - '错误序列化正文'。通过 .NET 3.5 调用 Fedex Web 服务时出现问题

> ID：345411
> 
> 赞同：9
> 
> 时间：2008-12-05T22:37:39.467
> 
> 标签：.net, web-services

我正在使用 Fedex 的网络服务，并在我真正到达任何地方之前就收到了一个恼人的错误。

序列化消息 addressValidationRequest1 的正文时出错：'无法生成临时类（结果 = 1）。错误 CS0030：无法将类型“FedEx.InterOp.AddressValidationServiceReference.ParsedElement[]”转换为“FedEx.InterOp.AddressValidationServiceReference.ParsedElement”错误 CS0029：无法将类型“FedEx.InterOp.AddressValidationServiceReference.ParsedElement”隐式转换为“FedEx.InterOp.AddressValidationServiceReference” .ParsedElement[]''。有关更多详细信息，请参阅 InnerException。

我正在使用 .NET 3.5 并为我生成了一个可怕的命名类（我不确定为什么它不仅仅是 AddressValidationService）：

`AddressValidationPortTypeClient addressValidationService = new ...;`

在这堂课上，我进行了网络服务调用：

`addressValidationService.addressValidation(request);`

这是我收到此错误的时候。

我能找到的关于这个错误的唯一参考来自古老的 1.1 项目。就我而言，我的 DLL 引用了 System.Web 和 System.Web.Services，这在当时似乎是个问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-09T20:56:52.517

您只需要更改 [][]，而不是单个 []。

在 Reference.cs 中更改

```
private ParsedElement[][] parsedStreetLineField;
to
private ParsedElement[] parsedStreetLineField;
and
public ParsedElement[][] ParsedStreetLine {
to
public ParsedElement[] ParsedStreetLine { 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-05T22:59:23.073

原来 Fedex 自己的文档专门涵盖了这一点！

**我正在使用 Microsoft 的 wsdl.exe 生成代码，但收到错误 CS0029：无法将类型“fedexreq.ParsedElement”隐式转换为“fedexreq.ParsedElement[]”。**

这是由 Web 服务描述语言工具 (Wsdl.exe) 生成的错误，用于生成客户端信息。当您发布包含嵌套节点的架构时，将 maxOccurs 属性设置为“无界”值，Wsdl.exe 工具会在生成的代码文件中创建多维数组。因此，生成的代码包含不正确的嵌套节点类型。通过从数据类型选择语句中删除括号 ([]) 数组字符来解决修改生成的代码的问题。有关详细信息，请参阅[http://support.microsoft.com/kb/326790/en-us](http://support.microsoft.com/kb/326790/en-us)和[http://support.microsoft.com/kb/891386](http://support.microsoft.com/kb/891386)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-23T18:35:34.380

注意：要访问 Simon_Weaver 引用的 Reference.cs 文件，请在 Visual Studio 中打开项目，然后在解决方案资源管理器中，单击 Web 参考，然后查看解决方案资源管理器顶部的小图标。单击“显示所有文件”图标以显示隐藏文件。现在展开 web 引用，然后展开里面的 Reference.map，最后你会看到 Reference.cs 可以编辑，将 [][] 替换为 []

在下载他们的示例代码时，不要将此 Reference.cs 与您可能从 Fedex 获得的 Reference.cs 混淆。

# c# - IsAssignableFrom() 在应该返回 true 时返回 false

> ID：345413
> 
> 赞同：24
> 
> 时间：2008-12-05T22:39:10.570
> 
> 标签：c#, .net, reflection

我正在开发一个插件系统，它加载包含在指定文件夹中的 .dll。然后我使用反射来加载程序集，遍历它们包含的类型并识别任何实现我的`IPlugin`接口的类型。

我正在使用类似于以下的代码进行检查：

```
foreach(Type t in myTypes )
{
    if( typeof(IPlugin).IsAssignableFrom(t) )
    {
       ...
    }
} 
```

出于某种原因，IsAssignableFrom() 在应该返回 true 时一直返回 false。我尝试`t`通过显式地给它一个应该通过的类型来替换它，它工作正常，但由于某种原因，它不适用于从加载的程序集返回的类型。为了让事情变得更奇怪，代码在我同事的机器上运行良好，但在我的机器上却不行。

有谁知道可能导致这种行为的任何事情？

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-05T23:05:56.460

当包含当前程序集引用的类型 IPlugin 的程序集与包含您正在迭代的类型的程序集引用的程序集之间存在不匹配时，通常会发生这种情况。

我建议你打印：

```
typeof (IPlugin).Module.FullyQualifiedName 
```

和

```
foreach (var type in t.GetInterfaces ()) 
{    
    Console.WriteLine (type.Module.FullyQualifiedName)
} 
```

看看哪里错位了。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-05-12T10:40:57.520

当在单独的程序集中定义接口以实现类型时，我遇到了同样的问题。从包含具有类的 dll 和具有接口的 dll 的根文件夹中迭代和加载程序集导致如上所述的类型不匹配。

一种解决方案是更改`LoadFrom()`为该方法有一些缺点，`LoadFile()` 这`LoadFrom`就是其中之一：

> 如果已加载具有相同标识的程序集，即使指定了不同的路径，LoadFrom 也会返回加载的程序集。

另一种克服这个问题的方法是将所有具有实现接口的类型的 dll 放入单独的文件夹中，而不是复制引用的程序集 ( `CopyLocal = False`)，这样`Assembly.LoadFrom`就不会在内存中加载包含接口的 dll。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-09-30T05:05:19.210

其他一些答案提到方法名称缺乏明确性`IsAssignableFrom`。我同意，因此以错误的方式使用它。

尝试在代码中**反转对象**，看看它是否有效。例如：

代替：

```
if (typeof(IPlugin).IsAssignableFrom(t)) 
```

和：

```
if (t.IsAssignableFrom(typeof(IPlugin))) 
```

通过这样做，我不仅让它发挥作用，而且开始了解这种方法的实际作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T15:12:59.760

有时，动态程序集引用另一个程序集是一个问题。

一件简单的事情就是禁用程序集上的本地复制（在 Visual Studio 中右键单击引用并将本地复制设置为 false）。这应该更容易确定程序集所在的目录。

您还可以实现程序集解析器，以防 .NET 不知道如何初始化类型。

```
 AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler([Resolve Function]); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-12-02T19:17:09.307

如果您正在使用 .net core 并按照**[此链接](https://docs.microsoft.com/en-us/dotnet/core/tutorials/creating-app-with-plugin-support)**上的教程进行操作，请确保您记得将其添加到您的插件项目中

```
<ItemGroup>
    <ProjectReference Include="..\PluginBase\PluginBase.csproj">
        <Private>false</Private>
        <ExcludeAssets>runtime</ExcludeAssets>
    </ProjectReference>
</ItemGroup> 
```

如链接中所述。如果你不这样做，你会得到上述错误。[这也帮助了我](https://stackoverflow.com/questions/60209723/net-core-and-plugins)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T22:53:28.217

我在 Java 中工作，它具有相同的 API 方法，但在阅读代码时（出于某种原因）我无法理解它；因此，我总是反过来读它，因为在你的情况下，“t 可分配给 IPlugin）。所以如果 C# 有 Jonathon 建议的“is”，我会一直使用它 - 当在 Java 中反映“instanceof”不起作用时类对象，只有对象的实例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-21T04:50:54.333

我有一个类似的问题，这是由于插件的依赖注入引起的。假设程序集包含实现 ISomeInterface 的 MyConcreteClass 的定义。MyConcreteClass 构造函数需要我添加到 serviceProvider 的依赖项。我正在尝试使用实例化对象

```
 using Microsoft.Extensions.DependencyInjection;

 private IEnumerable<ISomeInterface> CreatePlugins(Assembly assembly)
 {
        ServiceCollection serviceCollestion = new ServiceCollection();
        serviceCollestion.AddSingleton(dependency1);
        serviceCollestion.AddSingleton(dependency2);
        serviceCollestion.AddSingleton(dependency3);
        var serviceProvider = serviceCollestion.BuildServiceProvider();

        foreach (Type type in assembly.GetTypes())
        {
            if (typeof(My.Namespace.ISomeInterface).IsAssignableFrom(type))
            {
                ISomeInterface result = ActivatorUtilities.CreateInstance(serviceProvider, type) as ISomeInterface;
            }
        }
 } 
```

我得到了例外：

> 尝试激活“Another.Namespace.MyConcreteClass”时无法解析“My.Namespace.ISomeInterface”类型的服务。在 Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance（IServiceProvider 提供程序）在 Microsoft.Extensions.DependencyInjection.ActivatorUtilities.CreateInstance（IServiceProvider 提供程序，类型 instanceType，对象 [] 参数）

然后我发现调用 ActivatorUtilities.CreateInstance 的进程已经引用了 MyConcreteClass 的依赖项，这就是实例化失败的原因。为了解决这个问题，我遵循下面链接中的建议，并在加载之前从我的进程引用的任何程序集中清除了 Another.Namespace 的文件夹。

[.NET：无法将对象转换为它实现的接口](https://stackoverflow.com/questions/1596796/net-unable-to-cast-object-to-interface-it-implements)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2011-10-26T18:15:55.740

当应用于测试继承或检测接口实现时，Type.IsAssignableFrom 方法的名称含糊不清。用于这些目的的以下包装器会更有意义：

```
 public static bool CanBeTreatedAsType(this Type CurrentType, Type TypeToCompareWith)
    {
        // Always return false if either Type is null
        if (CurrentType == null || TypeToCompareWith == null)
            return false;

        // Return the result of the assignability test
        return TypeToCompareWith.IsAssignableFrom(CurrentType);
    } 
```

然后，可以有更易于理解的应用程序代码，例如：

```
 bool CanBeTreatedAs = typeof(SimpleChildClass).CanBeTreatedAsType(typeof(SimpleClass));
    CanBeTreatedAs = typeof(SimpleClass).CanBeTreatedAsType(typeof(IDisposable)); 
```

这种方法而不是 'is' 关键字的优点是它可以在运行时用于测试未知的任意类型，而 'is' 关键字（和泛型类型参数）需要特定类型的编译时知识.

# asp.net - ASP.NET 网站 + Windows 窗体应用程序 + WCF 服务：客户端凭据

> ID：345414
> 
> 赞同：18
> 
> 时间：2008-12-05T22:39:19.650
> 
> 标签：asp.net, wcf, authentication, architecture

假设我正在考虑设计一个 WCF 服务，其主要目的是提供可供三个不同应用程序使用的广泛服务：面向公众的网站、内部 Windows 窗体应用程序和无线移动设备。该服务的目的是双重的：(1) 将与业务流程相关的代码整合到一个中心位置；(2) 锁定对遗留数据库的访问，最终一劳永逸地将其隐藏在一套服务后面。

目前，这三个应用程序中的每一个都有自己的持久层和域层，对同一数据库的视图略有不同。不是所有三个应用程序都与数据库通信，而是与 WCF 服务通信，启用来自某些客户端的新功能（显然，移动选择器当前无法触发发送电子邮件的进程）和集中通知系统（而不是计划任务每​​五分钟轮询一次数据库以获取新订单，当`AcceptNewOrder()`这些客户端之一调用服务方法时，只需 ping 开销分页系统）。总而言之，到目前为止，这听起来很正常。

然而，就整体设计而言，在安全性方面我被难住了。Windows 窗体应用程序当前仅使用 Windows 主体；员工存储在 Active Directory 中，在应用程序启动时，他们可以作为当前 Windows 用户登录（在这种情况下不需要密码），也可以提供他们的域名和密码。移动客户端没有任何用户的概念；它与数据库的连接是一个硬编码的字符串。该网站有成千上万的用户存储在遗留数据库中。那么如何实现身份模型并配置 WCF 端点来处理这个问题呢？

就 Windows 窗体应用程序而言，这不是什么大问题：WCF 代理可以启动一次，并且可以在内存中徘徊，所以我只需要一次客户端凭据（如果代理出现故障，可以再次提示它们）。移动客户端可以是特殊情况并使用 X509 证书对 WCF 服务进行身份验证。但是我对网站做些什么呢？

在网站的情况下，允许匿名访问某些服务。对于在假设的“客户”角色中需要身份验证的服务，我显然不想在每个请求上都对它们进行身份验证，原因有两个：

*   我每次都需要他们的用户名和密码。将这对信息存储在几乎任何地方——会话、加密的 cookie、月亮——似乎是个坏主意。
*   对于每个请求，我都必须点击数据库中的用户表。哎哟。

我能想出的唯一解决方案是将 Web 站点视为一个受信任的子系统。WCF 服务需要来自网站的特定 X509 证书。该网站在内部使用 Forms Authentication（它调用`AuthenticateCustomer()`服务上的一个返回布尔结果的方法），可以在凭据列表中添加一个附加声明，例如“joe@example.com 作为客户登录”。然后以某种方式可以在具有该声明的服务上构造自定义 IIdentity 对象和 IPrincipal，WCF 服务确信网站已正确验证了客户（它会知道声明没有被篡改，至少，因为它会提前知道网站的证书）。

有了所有这些，WCF 服务代码将能够说出类似`[PrincipalPermission.Demand(Role=MyRoles.Customer)]`or的内容`[PrincipalPermission.Demand(Role=MyRoles.Manager)]`，并且`Thread.CurrentPrincipal`将具有代表用户的内容（客户的电子邮件地址或员工的专有名称，它们都很有用用于记录和审计）。

换句话说，每个服务将存在两个不同的端点：一个接受众所周知的客户端 X509 证书（用于移动设备和网站），一个接受 Windows 用户（用于员工）。

对不起，这么久。所以问题是：这些有意义吗？提议的解决方案有意义吗？我让这太复杂了吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-09T01:52:43.347

好吧，既然我已经花了几个小时研究各种方法，我想我会尝试解决我自己的问题。

我的第一种方法是在 WCF 服务和面向公众的网站（网站是服务的消费者/客户端）之间设置基于证书的身份验证。使用 生成的一些测试证书`makecert`，将它们放入`Personal`,`Trusted People`和`Trusted Root Certification Authorities`（因为我懒得针对我们域的证书服务生成真实证书），一些配置文件修改，很好，我们都准备好了。

为了防止网站必须为用户维护用户名和密码信息，其想法是，一旦用户通过表单身份验证登录到网站，网站可以仅将用户名（可通过 访问）`HttpContext.Current.User.Identity.Name`作为可选选项传递`UserNameSecurityToken`到`X509CertificateSecurityToken`实际用于保护消息的那个。如果找到可选的用户名安全令牌，那么 WCF 服务会说“嘿，这个受信任的子系统说这个用户已经过正确的身份验证，所以让我`MyCustomPrincipal`为那个用户设置一个并将它安装在当前线程上，以便实际的服务代码可以检查这个。” 如果不是，则将安装匿名版本`MyCustomPrincipal`。

所以我花了五个小时尝试实现这一点，并在[各种](http://www.leastprivilege.com/UserNameSupportingTokenInWCF.aspx) [博客](http://weblogs.asp.net/cibrax/archive/2008/01/22/authenticating-users-with-supporting-tokens-in-wcf.aspx)的帮助下，我能够做到。（我大部分时间都在调试一个问题，我让每个配置和支持类都正确，然后在我启动主机之后安装我的自定义授权*，*而不是之前，所以我的努力​​实际上都没有生效。有些日子我讨厌计算机。）我有一个`TrustedSubsystemAuthorizationPolicy`进行 X509 证书验证，安装一个匿名`MyCustomPrincipal`，一个`TrustedSubsystemImpersonationAuthorizationPolicy`接受带有空白密码的用户名令牌并安装一个客户角色`MyCustomPrincipal`，如果它看到已安装匿名受信任子系统主体，以及一个`UserNameAuthorizationPolicy`它对未使用 X509 证书的其他端点进行了基于用户名和密码的常规验证。它奏效了，而且非常棒。

但。

当我摆弄生成的客户端代理代码时，网站将使用该代码与该服务进行对话，这让我目瞪口呆的时刻到来了。指定生成对象的`UserName`on属性很容易。但主要问题是凭证特定于 a ，而不是特定的方法调用。`ClientCredentials``ClientBase<T>``ChannelFactory`

你看，new() 一个 WCF 客户端代理比[你想象的](http://caught-in-a-web.blogspot.com/2008/05/increasing-wcf-client-applications.html)[要昂贵](http://weblogs.asp.net/pglavich/archive/2007/05/07/wcf-client-channel-pool-improved-client-performance.aspx)。我自己编写了一个快速而肮脏的应用程序来测试性能：new() 建立一个新代理并调用一个方法十次大约需要 6 秒，而 new() 建立一个代理并仅调用该方法 10 次成本大约 3/5 秒。这只是令人沮丧的性能差异。

所以我可以为客户端代理实现一个池或缓存，对吗？好吧，不，它不容易解决：客户端凭据信息处于通道工厂级别，因为它可能用于保护传输，而不仅仅是消息，并且某些绑定在服务调用之间保持实际传输打开。由于客户端凭据对于代理对象是唯一的，这意味着我必须为当前在网站上的每个用户拥有一个唯一的缓存实例。这可能是很多代理对象位于内存中，并且非常接近我一开始试图避免的问题！而且由于无论如何我都必须触摸该`Endpoint`属性才能为可选的支持用户名令牌设置绑定，因此我无法利用[自动通道工厂缓存](http://blogs.msdn.com/wenlong/archive/2007/10/27/performance-improvement-of-wcf-client-proxy-creation-and-best-practices.aspx)微软在 .NET 3.5 中“免费”添加。

回到绘图板上：我的第二种方法，也是我认为我现在将最终使用的方法，是坚持客户端网站和 WCF 服务之间的 X509 证书安全性。我将在我的消息中发送一个自定义的“UserName”SOAP 标头，WCF 服务可以检查该 SOAP 标头，确定它是否来自受信任的子系统（例如网站），如果是，则以`MyCustomPrincipal`类似方式安装像之前一样。

[Google 上的Codeproject](http://www.codeproject.com/KB/WCF/AutomaticCultureFlow.aspx)和[random people](http://weblogs.asp.net/paolopia/archive/2008/02/25/handling-custom-soap-headers-via-wcf-behaviors.aspx)是很棒的东西，因为他们帮助我快速启动并运行它，即使[在配置中的自定义端点行为遇到奇怪的 WCF 错误](http://nayyeri.net/blog/configuration-error-for-custom-behavior-extensions-in-wcf/)之后也是如此。通过在客户端和服务端实现消息检查器——一个用于添加 UserName 标头，一个用于读取它并安装正确的主体——此代码位于一个我可以简单地忘记它的地方。由于我不必触摸该`Endpoint`属性，因此我免费获得了内置的通道工厂缓存。而且自从`ClientCredentials`对于任何访问网站的用户来说都是一样的（实际上，它们始终是 X509 证书——只有消息本身中的 UserName 标头的值会发生变化），添加客户端代理缓存或代理池要简单得多。

所以这就是我最终做的。WCF 服务中的实际服务代码可以执行以下操作

```
 // Scenario 1: X509Cert + custom UserName header yields for a Web site customer ...
    Console.WriteLine("{0}", Thread.CurrentPrincipal.Identity.Name); // prints out, say, "joe@example.com"
    Console.WriteLine("{0}", Thread.CurrentPrincipal.IsInRole(MyRoles.Customer)); // prints out "True"

    // Scenario 2: My custom UserNameSecurityToken authentication yields for an employee ...
    Console.WriteLine("{0}", Thread.CurrentPrincipal.Identity.Name); // prints out, say, CN=Nick,DC=example, DC=com
    Console.WriteLine("{0}", Thread.CurrentPrincipal.IsInRole(MyRoles.Employee)); // prints out "True"

    // Scenario 3: Web site doesn't pass in a UserName header ...
    Console.WriteLine("{0}", Thread.CurrentPrincipal.Identity.Name); // prints out nothing
    Console.WriteLine("{0}", Thread.CurrentPrincipal.IsInRole(MyRoles.Guest)); // prints out "True"
    Console.WriteLine("{0}", Thread.CurrentPrincipal.IsInRole(MyRoles.Customer)); // prints out "False" 
```

不管这些人是如何通过身份验证的，或者有些人生活在 SQL Server 中，或者有些人生活在 Active Directory 中：`PrincipalPermission.Demand`现在用于审计目的的日志记录变得轻而易举。

我希望这对将来的一些可怜的灵魂有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T18:14:38.660

对于匿名公共访问，请使用 basichttpbinding，并且在 web.config 文件中还有以下内容

# linq-to-sql - linq to sql：连接同一个表中的多个列

> ID：345427
> 
> 赞同：17
> 
> 时间：2008-12-05T22:43:44.133
> 
> 标签：linq-to-sql, join

如何通过 Linq 内部连接来自同一个表的多个列？

例如：我已经有了这个...

```
join c in db.table2 on table2.ID equals table1.ID 
```

我需要添加这个...

```
join d in db.table2 on table2.Country equals table1.Country 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-06T01:04:20.637

这是我能够让它工作的唯一方法（在 c# 中）。

```
var qry = from t1 in table1
          join t2 in table2
          on new {t1.ID,t1.Country} equals new {t2.ID,t2.Country}
          ... 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-30T13:25:01.387

您可以将查询放在 Where 子句中，而不是使用连接运算符。

连接运算符支持 VB.NET 中的多个子句，但不支持 C#。

或者，您可以使用 ANSI-82 样式的“SQL”语法，例如：

```
from t1 in table1
from t2 in table1
where t1.x == t2.x
&& t1.y == t2.y 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-07-16T17:36:48.373

来自[http://www.onedotnetway.com/linq-to-sql-join-on-multiple-conditions/](http://www.onedotnetway.com/linq-to-sql-join-on-multiple-conditions/)

这两个表都有 PostCode 和 CouncilCode 作为公共字段。假设我们要从 ShoppingMall 中检索所有 PostCode 和 CouncilCode on House 匹配的记录。这要求我们使用两列进行连接。在 LINQ 中，可以使用匿名类型来完成这样的连接。这是一个例子。

```
var query = from s in context.ShoppingMalls
        join h in context.Houses
        on
        new { s.CouncilCode, s.PostCode }
        equals
         new { h.CouncilCode, h.PostCode }
        select s; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-18T06:26:46.583

```
var query = from s in context.ShoppingMalls
join h in context.Houses
on
new {CouncilCode=s.CouncilCode, PostCode=s.PostCode }
equals
new {CouncilCode=h.District, PostCode=h.ZipCode }
select s; 
```

这适用于任何类型的数据类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T23:02:58.637

在 VB 中：

```
 dim qry = FROM t1 in table1 _
           JOIN t2 in table2 on t2.ID equals t1.ID _
           AND t2.Country equals t1.Country 
```

# visual-studio - Windows下编译libgadu

> ID：345428
> 
> 赞同：1
> 
> 时间：2008-12-05T22:43:59.250
> 
> 标签：visual-studio, visual-studio-2008, cygwin, unresolved-external

我想在 Visual Studio 2008 下使用 libgadu（即时通讯协议库）。我已经下载了 libgadu [http://toxygen.net/libgadu/files/libgadu-1.8.2.tar.gz](http://toxygen.net/libgadu/files/libgadu-1.8.2.tar.gz)并在 cygwin 下编译了它- ./configure 、 make 、 make 安装。出现在包含文件夹中的文件 libgadu.h 我复制到另一个文件夹，该文件夹在 VS 中标记为包含文件目录。

我想从文档中编译代码

```
#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <libgadu.h>

using namespace std;

int main(void)
{
    char password[]= "haslo";
    struct gg_session *sesja;
    struct gg_login_params parametry;
    struct gg_event *zdarzenie;

    memset(&parametry, 0, sizeof(parametry));
    parametry.uin = 12345;
    parametry.password = password;
    parametry.async = 1;
    parametry.status = GG_STATUS_INVISIBLE;

    sesja = gg_login(&parametry);
    if (!sesja) {
        cout << "Can't connect" << endl;
       exit(1);
    }

    system("PAUSE");
} 
```

在编译期间，我收到两个错误：

```
Error   1   error LNK2019: unresolved external symbol _gg_login referenced in function _main    1.obj
Error   2   fatal error LNK1120: 1 unresolved externals 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T22:48:44.607

您需要找到已编译的 DLL 和 LIB 文件，如果已编译为静态库，则只需找到 LIB 文件。这些文件可能被命名为 libgadu.dll 和 libgadu.lib。

一旦你有了这些，你可以通过选择 Project Properties 并在 Linker settings 下找到 Additional Dependencies 来指示 Visual Studio 与 LIB 文件链接。

只需添加`libgadu`到所有配置的附加依赖项列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T00:53:11.503

正如弗兰克已经说过的，这通常意味着一个库（.lib 或 .dll）没有被链接到。但是，如果成功的编译没有创建 .dll 或 .lib 文件，那么最有可能的情况是 Cygwin 和 VS 之间的构建系统不同步。

具体来说，VS 项目文件中没有引用文件。我感觉它本身就是[libgagdu.c](http://toxygen.net/libgadu/doc/libgadu_8c.html)，因为其中定义了一个 gg_login 函数。

只需将该文件添加到项目并重建。如果可行，请联系 libgadu 开发人员，以便他们最终修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T22:58:41.750

这很奇怪，因为在 Cygwin 中进行 ./configure 时，它​​不会创建任何 .dll 和 .lib 文件。

# ios - 是否可以缓存 iPhone UIWebView 中加载的资源？

> ID：345432
> 
> 赞同：11
> 
> 时间：2008-12-05T22:46:26.080
> 
> 标签：ios, iphone, cocoa-touch, caching, uiwebview

我有一个简单的应用程序加载一个针对 iPhone 优化的网站`UIWebView`。

问题是，缓存似乎不起作用：

```
[webView loadRequest: [NSURLRequest requestWithURL: [NSURL URLWithString: url]
                                       cachePolicy: NSURLRequestUseProtocolCachePolicy
                                   timeoutInterval: 60.0]]; 
```

此远程页面中引用的任何内容（css、图像、外部 javascript 文件）永远不会被缓存（请求永远不会发送 If-Modified-Since 标头或任何其他缓存控制方式。）

可能吗？使用常规的 Cocoa WebView 似乎有一个委托方法，可以为每个资源请求和后加载（`-didFinishLoadingFromDataSource:`）调用，您可以使用它们来滚动您自己的缓存..但这在这里似乎不适用。

我的整个页面（页面及其引用的资源）被压缩了大约 89K.. 在某些地方这比 3G 慢，甚至比 EDGE 更糟。传入的请求至少表明它接受压缩（`accept-encoding=gzip, deflate`），所以我想这很好。

我读[了这个 yui study](http://yuiblog.com/blog/2008/02/06/iphone-cacheability/)，这似乎表明 iPhone 将缓存每个项目 25k。唯一引用超过 25k 未压缩的是 jquery（打包但未压缩 - 它是 30k）。其他一切都应该是可缓存的。对获取的页面中引用的任何内容的请求都不会在服务器端触发 304。

那个 yui 的研究是差不多一年前的事了，我猜只有移动 safari。

这是`UIWebView`在原生 iPhone 应用程序中使用的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-28T18:25:36.827

如我所见，此问题的一种解决方法是

1）下载HTML代码

2）将其存储在字符串中

3）找到其中的所有外部链接，如

```
<img src="img.gif" width="..." height="..." /> 
```

4）全部下载

5) 用嵌入式 Base64 编码版本替换它们

```
<img src="data:image/gif;base64,R0lGODlhUAAPA...JADs= " width="..." height="..." /> 
```

6) 最后根据需要存储带有嵌入图像的完整 HTML。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-10T21:33:02.857

From [https://github.com/phonegap/phonegap-iphone/issues/148](https://github.com/phonegap/phonegap-iphone/issues/148):

```
NSURLCache* cache = [NSURLCache sharedURLCache];
[cache setMemoryCapacity:4 * 1024 * 1024];
[cache setDiskCapacity:512*1024];

[NSURLRequest requestWithURL:appURL
                 cachePolicy:NSURLRequestReturnCacheDataElseLoad
             timeoutInterval:10.0]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-06T10:40:25.443

您现在可以[`ASIWebPageRequest`](http://allseeing-i.com/ASIWebPageRequest-a-new-class-for-downloading-complete-webpages)通过 All Seeing Interactive 进行尝试：

> ASIWebPageRequest 是 ASIHTTPRequest 系列的一个新的实验性补充。它可用于在单个请求中下载完整的网页，包括图像和样式表等外部资源。下载网页后，请求将解析内容，查找外部资源，下载它们，然后使用 Data URIS 将它们直接插入到 html 源中。然后，您可以获取响应并将其直接放入 Mac 上的 UIWebView / WebView 中。

无论如何，我只能建议大家使用 Ben Copsey 的优秀库进行各种 HTTP 操作。

**更新**：Ben 已停止使用 ASIHTTPRequest。我不再建议使用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-22T14:21:27.587

您始终可以手动执行请求，尽管这会很棘手 - 然后您可以将内容缓存到您心中的内容。构建一个`UIWebViewDelegate`在 中启动请求`webView:shouldStartLoadWithRequest:navigationType:`，缓存结果，并使用 UIWebView`loadHTMLString:baseURL:`更新视图。

它会很丑陋，事情不会像你想要的那样顺利，但它可能足以满足你的需要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T23:28:09.163

与普通计算机相比，ihone 的缓存容量有限。它将*未压缩*的缓存项限制为 25k。

这里有很好的信息：http: [//yuiblog.com/blog/2008/02/06/iphone-cacheability/](http://yuiblog.com/blog/2008/02/06/iphone-cacheability/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-17T11:42:39.203

您应该能够继承`NSURLCache`并替换它使用的共享缓存，`UIWebView`如这篇 Cocoa with Love 文章中所述：用[本地数据替换远程 UIWebView 请求](http://www.cocoawithlove.com/2010/09/substituting-local-data-for-remote.html)

对于另一种方法，请查看[Drop-in offline caching for UIWebView (and NSURLProtocol)](http://robnapier.net/blog/offline-uiwebview-nsurlprotocol-588)。

# .net - 在 .NET 中用于 Web 服务的“好”生成的类名发生了什么？

> ID：345438
> 
> 赞同：1
> 
> 时间：2008-12-05T22:48:51.083
> 
> 标签：.net, web-services, generated-code, porttype

我正在使用 .NET 3.5 调用 FedEx Web 服务。

在 Fedex 的示例代码 (VS2005) 中，它具有以下内容：

```
AddressValidationService addressValidationService = new AddressValidationService();
AddressValidationReply reply = addressValidationService.addressValidation(request); 
```

这很好。我喜欢。我正在调用“服务”上的方法。

但在 .NET 3.5 中，我从相同的 WSDL 生成了这个：

```
AddressValidationPortTypeClient addressValidationService = new AddressValidationPortTypeClient();
AddressValidationReply reply = addressValidationService.addressValidation(request); 
```

这是什么'PortTypeClient' *#&$。我对进步很满意，但这似乎有点疯狂。我不知道这意味着什么。

是否有任何文档告诉我发生了什么变化以及为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T23:55:52.477

你用的是什么工具？[wsdl.exe](http://msdn.microsoft.com/en-us/library/7h3ystb6(VS.71).aspx) ? 还是[svcutil.exe](http://msdn.microsoft.com/en-us/library/aa347733.aspx)？如果您要添加“服务引用”，那就是 WCF，因此使用 svcutil.exe - 这会将事物命名为客户端。但是，仍然可以选择使用旧的 wsdl.exe 工具。在 IDE 中，您可以通过“高级...”->“添加 Web 引用...”来执行此操作 - 这将生成 2.0 样式的服务代理。

重新命名；WCF 是正确的 - 代理类是客户端，而不是服务。

# jpa - 如何检索通过级联与 JPA 持久保存的实体的 ID

> ID：345443
> 
> 赞同：2
> 
> 时间：2008-12-05T22:51:05.430
> 
> 标签：jpa, cascade

如果一个人有一个常规的 Foo 实体并调用 persist(foo) ，则 @Id 会自动设置在实体上。但是，如果所述 Foo 实体具有通过绑定到它的 Bars 集合

```
(...)
@OneToMany(cascade=Cascade.ALL) 
Set<Bar> getBars()
(...) 
```

并且这样的实例已经被持久化，如果创建一个新的 Bar 并将其添加到 foo 的 Bars 集合并调用 merge(foo) 刚刚创建的 Bar 将被持久化，但它的 @Id 没有更新！

有没有办法检索这个 id，而无需稍后调用 find(Foo.class, foo.getId())？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-05T23:02:12.817

对 merge() 的调用不会更新传入的对象。但是它将返回更新的对象。

从休眠文档：

[http://www.hibernate.org/hib_docs/v3/reference/en/html/objectstate-saveorupdate.html](http://www.hibernate.org/hib_docs/v3/reference/en/html/objectstate-saveorupdate.html)

和 merge() 非常不同：

*   如果存在与当前会话关联的具有相同标识符的持久实例，则将给定对象的状态复制到持久实例上
*   如果当前没有与会话关联的持久化实例，尝试从数据库中加载它，或者创建一个新的持久化实例
*   返回持久实例
*   给定的实例没有与会话关联，它保持分离

# sql-server - SQL Server 2005 - 启用命名管道和 TCP/IP 协议？

> ID：345450
> 
> 赞同：1
> 
> 时间：2008-12-05T22:55:14.220
> 
> 标签：sql-server, tcp, network-protocols, named-pipes

我们有一个 SQL Server 2005 数据库，目前我们所有的用户都通过 TCP/IP 协议连接到数据库。

SQL Server 配置管理器允许您同时“启用”命名管道和 TCP/IP 连接。这是一个好主意吗？我的问题不是我们是否应该使用命名管道而不是 TCP/IP，而是启用两者是否存在相关问题？

我们客户的一位 IT 人员说，启用两种协议的数据库通信将限制任何一种协议可以使用的带宽 - 大约为总带宽的 50%。我认为 TCP/IP 可以使用的带宽将直接（反向地）与命名管道（或任何其他类型的流量）当时在网络上占用的流量量相关联。但是，这位 IT 人员表示，我们在服务器上启用了两种协议，人为地限制了 TCP/IP 可以使用的带宽。它是否正确？

我做了谷歌搜索，但无法找到这个问题的答案。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T23:10:22.787

这是不正确的。您对网络流量的想法是正确的 - 容量不是“保留”的。

如果不需要，您不应该启用命名管道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T23:19:30.163

不，带宽没有限制。命名管道的问题在于，它们在慢速网络中可能非常“健谈”，并且会占用大量带宽。有一个优先尝试的协议列表。但据我所知，这没有内部门槛。

# javascript - 如何使用 Javascript 在 Safari 中生成按键事件？

> ID：345454
> 
> 赞同：6
> 
> 时间：2008-12-05T22:58:14.947
> 
> 标签：javascript, safari

如何以编程方式从 Safari 中运行的 Javascript 代码生成按键事件？看起来 WebKit 正在使用 DOM 3 级模型从 Javascript 创建键盘事件，而 DOM 3 级键盘事件模型不支持 keypress 事件。我还有其他方法可以使用吗？

我正在寻找尽可能纯粹的 Safari/WebKit DOM 解决方案。我真的不想修改网页，也不想添加对外部库的依赖。我需要激活任何现有的按键处理程序，因此添加新的处理程序并直接调用它是行不通的。

看起来 WebKit 在其 UIEvent 类中定义了按键事件的 keyCode 和 charCode 属性，但它们是只读的。有没有办法设置这些属性？以下不起作用：

```
var evt = document.createEvent('UIEvents');
evt.initUIEvent('keypress', true, true, window, 0);
evt.keyCode = 114; // 'r'
evt.charCode = 114;
alert("keyCode = " + evt.keyCode + ", charCode = " + evt.charCode); // both 0 
```

在对 initUIEvent 的调用中设置 detail 属性似乎也没有效果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T09:08:58.107

使用 TextEvent（由 DOM3 引入）。由于您正在寻找生成按键事件，我猜您正在使用字符。在下面的代码中，textToInsert 是一个字符串，而 textarea 是我将事件分派到的元素。

```
var eventObject = document.createEvent('TextEvent');
eventObject.initTextEvent('textInput',
                          true,
                          true,
                          null,
                          textToInsert);

textarea.dispatchEvent(eventObject); 
```

这适用于 Safari 3.1.2（因此适用于 Chrome）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T18:13:01.213

听起来已经提出并回答了一个非常相似的（非浏览器特定的）问题：

[使用 jQuery 触发按键...并指定按下了哪个键](https://stackoverflow.com/questions/202285/trigger-a-keypress-with-jqueryand-specify-which-key-was-pressed)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T02:11:43.740

我曾经也有过一样的问题。我希望能够编写一个测试，当在 GUI 上按下回车键时，一个行项目 (li) 被添加到列表中。那时，我需要“生成”一个按键。尝试生成事件、模拟事件、模拟事件 (jqMock)，这是一个非常简单的解决方案。

我可以继续使用 jsSpec 和 jQuery 代码对我的代码进行 BDD。如果您使用插件来管理按键（例如热键 jQuery 插件），这个测试会有点困难

这是我想要做的：

```
describe 'I need to be able to edit items in a list', {

... [setup code and other tests]

'should create a new item if I press enter': function(){
    value_of($('#todo').items().size()).should_be(7)
    // be on the last item in the list
    task = $('#todo').items().filter(':last').focus()
    // press enter
    task.__keypress(13)
    // check that an item was added 
    value_of($('#todo').tasks().size()).should_be(8)
    },
} 
```

这是绑定处理程序的代码。请注意，使用此解决方案我会拦截事件并仅传递`which`代码 - 这允许我传递来自测试的值。这就是我目前所需要的。显然，如果我想拦截更多，我需要扩展传入的内容（例如，参见 jquery.hotkeys 插件）：

```
$().items().bind('keypress', function(event){$().__keypress(event.which)})
```

这是处理程序：

```
 __keypress: function(which){
      switch(which)
      {
        ...

        case 13:  // enter
          [my code that creates a new item]        
          break;
        default:
      }       
  }, 
```

ps：如果有人能够模拟 window.event 让我知道。我没有任何运气使用 jqMock。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-05T23:03:01.693

[http://docs.jquery.com/Events/keypress#fn](http://docs.jquery.com/Events/keypress#fn)

换句话说，您将按键事件附加到某个元素。使用 ID 为“someid”的元素，例如：

```
<script language="text/javascript" src="jquery.js"></script>
<script language="text/javascript">
$(function() {
    // add a keypress handler
    $("#someid").keypress(function(e){
        alert('you just pressed ' + e.which);
    });
    // imitate the keypress
    $("#someid").keypress();
});
</script> 
```

# asp.net - C# web 项目，所有依赖从何而来？

> ID：345479
> 
> 赞同：0
> 
> 时间：2008-12-05T23:14:08.333
> 
> 标签：asp.net, asp.net-mvc

今天我的 ASP.NET MVC 项目发生了最奇怪的事情。今天下午我构建了安装程序项目，突然之间，所有这些新的依赖项都出现了！呸。

```
Microsoft.SqlServer.BatchParser.dll
Microsoft.SqlServer.ConnectionInfo.dll
Microsoft.SqlServer.Dmf.dll
Microsoft.SqlServer.Management.Sdk.Sfc.dll
Microsoft.SqlServer.ServiceBrokerEnum.dll
Microsoft.SqlServer.Smo.dll
Microsoft.SqlServer.SqlClrProvider.dll
Microsoft.SqlServer.SqlEnum.dll
Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll
Microsoft.VisualStudio.TeamSystem.Data.dll
Microsoft.VisualStudio.TeamSystem.Data.UnitTesting.dll
Microsoft.Web.Mvc.dll 
```

这是对正常依赖项的补充（我想要这些）......

```
Microsoft.Web.Mvc.dll
System.Web.Abstractions.dll
System.Web.Mvc.dll
System.Web.Routing.dll 
```

知道我可以做些什么来导致这些新的依赖项显示出来。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-08T19:47:11.447

好吧，我们开始：

*Microsoft.Web.Mvc.dll*用于 MVC 框架的实验性功能，可能不会进入最终版本

*Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll、Microsoft.VisualStudio.TeamSystem.Data.dll、Microsoft.VisualStudio.TeamSystem.Data.UnitTesting.dll*可能在那里，因为您在首次创建项目时选择了在项目中包含单元测试。

*Microsoft.SqlServer.*.dll*可能在那里，因为您使用了附加的数据库文件或 LINQ to SQL 类（我假设您对模型有*某种*形式的数据访问，对吗？）这很奇怪，因为这些是通常仅对数据访问不是必需的。

如果您不想要这些依赖项，您可以尝试将它们从部署项目中一一排除，直到出现问题（在解决方案资源管理器中右键单击依赖项并选择排除依赖项）。有时 VS 部署工具对依赖检查有点过分热情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T05:27:49.437

老实说，我对设置项目一无所知。

但看起来您的解决方案有某种数据库项目（或数据库单元测试项目）。您可能需要将其从要构建和部署的事物列表中排除。

# vba - 设置/获取网络 Cookie

> ID：345485
> 
> 赞同：1
> 
> 时间：2008-12-05T23:16:40.933
> 
> 标签：vba, cookies, get, set

假设我没有运行任何类型的服务器端脚本，我如何从 VBA 代码中获取 cookie `set`？`get`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T23:50:29.523

我看到了一个可能有助于设置 cookie 的帖子：

[链接文本](http://objectmix.com/xml-soap/86831-excel-vba-xmthttp-cookies.html)

这是他的代码片段：

```
Sub test()
Dim w As New WinHttp.WinHttpRequest
Dim t As String, qs As String
qs = "this=that&more=less"
w.Open "POST", "http://www.comparity.net/perl/form.pl?a=b", False
w.setRequestHeader "Cookie", "one=foo"
w.setRequestHeader "Cookie", "two=bar"
w.send qs
t = w.responseText
WriteTextFile "c:\test.html", t
Debug.Print w.Status
Debug.Print t
End Sub 
```

不确定获取 cookie - 主要海报之一提到 XmlHttp 出于安全原因去除了 cookie。

希望这可以让你开始！

# c# - 当 SQL Select 不返回任何内容时如何避免引发错误

> ID：345489
> 
> 赞同：0
> 
> 时间：2008-12-05T23:19:42.907
> 
> 标签：c#, mysql, null, catch-block

我在某处读到，永远不应该将错误条件用作正常的程序流程。对我来说很有意义......但是

位于 MySQL 数据库之上的 C# 应用程序。我需要将一个字符串值解析为两部分，一个 ID 和一个值。（原始数据来自泥盆纪数据库），然后根据查找表验证该值。因此，一些原始字符串可能如下所示：

《6776紫食人》

“BIK 黄色波点比基尼（正在使用中）”

“DCP平分政变”

所以，我的小工具根据第一个空格的索引（幸运的是，一致）将每个字符串解析为 ID 和描述。然后我将 ID 传递给查找，获取新值，然后我们就走了。

不幸的是，TPTB 还决定我们不再需要臭黄色波点比基尼（目前正在使用）。因此，BIK 不会返回一行。这是一个代码片段：

```
 foreach (string product in productTokens) {
      tempProduct = product.Trim();
      if (tempProduct.Length > 0) {
        if (tempProduct.Length < 10) {
          product_id = tempProduct;
        }
        else {
          int charPosition = tempProduct.IndexOf(" ");
          product_id = tempProduct.Substring(0, charPosition);
        }
        try {
          s_product = productAdapter.GetProductName(product_id).ToString();
        }
        catch (Exception e) {
          if (e.Message.ToString() == "Object reference not set to an instance of an object.") {
            s_product = "";
          }
          else {
            errLog.WriteLine("Invalid product ID " + e.Message.ToString());
            Console.WriteLine("Invalid product ID " + e.Message.ToString());
            throw;
          } //else
        } //catch
        if (s_product.Length > 0) {
          sTemp = sTemp + s_product + "; ";
        }
      } //if product.length > 0
    } //foreach product in productTokens 
```

真的，真的很丑！特别是我在 catch 块中测试无效 ID 的部分。必须有更好的方法来处理这个问题。

如果有人可以帮助我，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T23:26:13.207

那时你不应该调用 ToString() ，首先你应该检查返回的值是否为空；

```
object productName = productAdapter.GetProductName(product_id);
if ( productName != null )
{
    s_product = productName.ToString();
}
else
{
    s_product = String.Empty;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T00:12:14.253

除了 Rob 和 Marc 的建议之外，根据您上面的代码，我建议进行另一个调整；`productAdapter.GetProductName()`如果还没有返回 a ，我会感到非常惊讶，*在*`String`这种情况下调用 ToString() 是完全多余的。如果它确实已经返回 a `String`，那么你的整个 try/catch 块变成一行：

```
s_product = productAdapter.GetProductName(product_id) ?? string.Empty; 
```

*另外，我认为提及已经*返回`String`-的其他内容可能很有用`Exception.Message`。因此，您在代码中调用 ToString() 的所有不同位置也是完全多余的。

另外，我建议使用实例方法`String.Split()`而不是`IndexOf`and的组合`SubString`：

```
product_id = tempProduct.Split(" ", 2)[1]; 
```

最后，`Exception`通过检查房产来决定你抓住了什么样的人`Message`应该是一个完全最后的方案。即使你真的*需要*在这里捕捉，你也应该*明确地*`NullReferenceException`这样做：

 *```
catch (NullReferenceException) {
    s_product = "";
}
catch (Exception e) {
    // Log your invalid ID error condition here
} 
```

*PS：我也不确定这个问题与 MySQL 有什么关系，因为在您的代码中没有任何 DB API 的证据。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T23:27:26.090

您不能简单地检查 GetProductName 是否返回 null 吗？

```
var productName = s_product = productAdapter.GetProductName(product_id);
if(productName == null) { ... do something }
else {
    string name = productName.ToString();
} 
```

# linq-to-sql - LINQ DBML 不允许我从任何表中插入、更新、删除或选择数据？为什么？

> ID：345492
> 
> 赞同：1
> 
> 时间：2008-12-05T23:25:16.127
> 
> 标签：linq-to-sql

我已经为 LINQ to SQL 映射创建了一个 DBML 文件，并将我的所有表拖到设计器表面之后。在每个表的属性中，“删除”、“插入”和“更新”都是灰色的，因此它们无法像被禁用一样进行编辑。我不确定这是为什么。有谁知道如何制作，以便我可以插入、更新和删除这些表中的值？

我也知道我有写权限，因为我已经在同一个用户 ID 上写入了这些表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T05:16:08.490

你的表有主键吗？如果没有要使用的密钥，LINQ to SQL 将不允许您更改数据。我在遗留系统中遇到了很多。很多时候该表使用的是事实上的键，但它并没有在数据库中专门设置。在这些情况下，您可以将字段标记为主要字段（在数据库中），它应该可以工作。否则，您可能必须添加一个主键列，以便为 LINQ 提供一些用于唯一标识每一行的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T23:37:42.340

如果您在设计器中右键单击表格并选择属性，则删除、插入和更新将灰显。我不确定您是否可以提供替代的删除、插入和更新方法...

但是，如果您的问题是关于在表中插入、更新和删除值，一旦将表拖到 dbml 设计器上，您就可以在代码中使用 linq 插入、更新和删除。dbml 不需要做任何其他事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-18T22:24:40.273

在不修改数据库的情况下，您也可以解决此问题。在 DBML 文件中设置主键，它会正常工作。LINQ 只需要知道事实上的密钥。您还可以将多个列设置为键。

LINQ很棒！

# silverlight - Silverlight 2 的 .Net 版本缺少什么？

> ID：345494
> 
> 赞同：0
> 
> 时间：2008-12-05T23:26:14.720
> 
> 标签：silverlight, silverlight-2.0

我刚刚开始在 Silverlight 2 中进行开发，并且没有遇到我在完整版中使用的 .Net 的任何“缺失部分”。您是否发现 Silverlight 2 的 .Net 版本中缺少任何 (1) 您错过了，(2) 确实需要，或者 (3) 因为缺少 Silverlight 2 而不得不放弃的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T00:54:05.053

刷子对我来说也是一种痛苦。尽管 ImageBrush 派生自 TileBrush，但它实际上并没有平铺填充的能力。这使得纹理映射非常困难。此外，没有可用于创建自定义画笔类的基类或接口，因此我们只需要等待此功能在未来版本中可用。呜呜呜……

除此之外，我发现功能集非常丰富。他们甚至添加了一些很棒的特性，比如依赖属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T13:45:12.160

使用数据集/数据表，将它们绑定到对象或仅使用它们。

我知道他们是故意遗漏的，以减少 Silverlight 的部署足迹，但这是框架的一个非常重要的部分，即使在 2009 年也是如此。

System.Data 迷你版！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T21:28:25.833

我肯定想念VisualBrush，我真的习惯了反射和东西，我想念它。我也很怀念位图效果。Dropshadows 对于创建 RIA 至关重要，而我看到的 Dropshadows 解决方案是非常糟糕的 hack。

不过，这主要是从 XAML 的角度来看的。

# crud - 你会如何象征“改变”？

> ID：345498
> 
> 赞同：0
> 
> 时间：2008-12-05T23:27:59.460
> 
> 标签：crud, choice, convention

由于空间问题，我必须为 crud 操作创建“单字符链接”：

在字符中，我将象征：
'删除' 与字符**x**
'添加' 与**+**
...<br> 你将如何象征 '改变'？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-05T23:29:26.040

delta字符怎么样？Δ
或者，+/- 字符呢？±

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-05T23:34:30.210

`*`也可以标记“改变”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-05T23:34:23.923

为什么不只使用标准差异指标：

添加：+

消除： -

改变： ！

...虽然当您说“链接”时，我猜您的意思是 HTML 超链接？目标受众是谁？如果是非程序员，那么 change 应该是 'c'，代表 'c'change。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T23:35:30.927

也许 ± 或 ~ 可以工作？± 因为变化可以用“删除旧的，添加新的”来表示。

或者，要求 Unicode 联盟在标准中添加一个 Barack Obama 符号。（对不起，由于标题无法抗拒）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-31T16:51:38.787

✍ (U+270D) 或✎ (U+270E) 怎么样。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-05T23:45:32.903

如果您仅限于 ASCII，我会使用“>”，因为它表示向前移动。在 Unicode 中，您可以选择大量的符号（我一直想使用 plethora 这个词 :-)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T23:31:42.120

**^**

也许象征“更新”？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T23:38:58.967

你有足够的空间放置小图标吗？如果可能的话，我会把它们挤进去。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-05T23:43:12.423

我会避免任何具有现有数学或逻辑含义的东西（+、-、！等）。不清楚你的意思是帽子变化，但对我来说，老式的 ' 意味着像 x、x' 等的变化（尽管它可以被解释为推导）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-31T16:44:08.787

怎么样：

¢

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-31T16:52:48.330

* 符号在某些软件（VS，SSMS ...）中用于标记已更改但未保存的文档...我也喜欢 Δ，但这取决于人们使用哪种（=数学思维方式）软件

因此，就“预期行为”而言，我也会像 VonC 已经发布的那样选择*。

（我读到你的标题的第一件事就是一个小奥巴马图标*gg*）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-31T16:54:23.537

恕我直言，三个点是编​​辑/更改命令的良好指标。
像这样 ：

`...`

**编辑**：我刚刚意识到你要求一个字符。但不会删除它，因为您可能喜欢它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-31T17:17:36.507

哇，你们没有人在上次选举中注意到改变的标志是O。就像奥巴马一样？

对不起，我试图反抗。但说真的，如果你在 google 中查找更改符号，你会得到类似这样的 Ұ。

# bash - 你如何区分 Bash 中的两个管道？

> ID：345505
> 
> 赞同：148
> 
> 时间：2008-12-05T23:30:55.520
> 
> 标签：bash, diff, pipeline

如何在不使用 Bash 中的临时文件的情况下区分两个管道[？](http://en.wikipedia.org/wiki/Diff)假设您有两个命令管道：

```
foo | bar
baz | quux 
```

你想`diff`在他们的输出中找到。一种解决方案显然是：

```
foo | bar > /tmp/a
baz | quux > /tmp/b
diff /tmp/a /tmp/b 
```

是否可以在不使用 Bash 中的临时文件的情况下这样做？您可以通过在其中一个管道中进行管道来区分一个临时文件：

```
foo | bar > /tmp/a
baz | quux | diff /tmp/a - 
```

但是您不能同时将两条管道通过管道传输到 diff 中（至少不是以任何明显的方式）。是否有一些巧妙的技巧`/dev/fd`可以在不使用临时文件的情况下做到这一点？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2008-12-05T23:40:58.060

包含 2 个 tmp 文件（不是您想要的）的单行代码将是：

```
 foo | bar > file1.txt && baz | quux > file2.txt && diff file1.txt file2.txt 
```

使用**bash**，您可以尝试：

```
 diff <(foo | bar) <(baz | quux)

 foo | bar | diff - <(baz | quux)  # or only use process substitution once 
```

第二个版本将更清楚地提醒您哪个输入是哪个，通过显示
`-- /dev/stdin`vs.`++ /dev/fd/63`或其他内容，而不是两个编号的 fd。

* * *

文件系统中甚至不会出现命名管道，至少在 bash 可以通过使用文件名来实现进程替换的操作系统上，例如`/dev/fd/63`获取命令可以打开和读取的文件名，以实际从 bash 设置的已打开文件描述符中读取在执行命令之前启动。（即 bash`pipe(2)`在 fork 之前使用，然后在 fd 63 上`dup2`从 的输出重定向`quux`到 的输入文件描述符`diff`。）

在没有“神奇” `/dev/fd`or的系统上`/proc/self/fd`，bash 可能会使用命名管道来实现进程替换，但与临时文件不同，它至少会自己管理它们，并且您的数据不会被写入文件系统。

您可以检查 bash 如何实现进程替换`echo <(true)`以打印文件名而不是从中读取文件名。`/dev/fd/63`它在典型的 Linux 系统上打印。或者有关 bash 使用的系统调用的更多详细信息，Linux 系统上的此命令将跟踪文件和文件描述符系统调用

```
strace -f -efile,desc,clone,execve bash -c '/bin/true | diff -u - <(/bin/true)' 
```

* * *

**如果没有 bash，您可以创建一个命名管道**。用于`-`告诉`diff`从 STDIN 读取一个输入，并将命名管道用作另一个：

```
mkfifo file1_pipe.txt
foo|bar > file1_pipe.txt && baz | quux | diff file1_pipe.txt - && rm file1_pipe.txt 
```

* * *

请注意，您只能使用 tee 命令将*一个输出*传送到*多个输入：*

```
ls *.txt | tee /dev/tty txtlist.txt 
```

上面的命令将 ls *.txt 的输出显示到终端，并输出到文本文件 txtlist.txt。

但是通过流程替换，您可以使用`tee`将相同的数据提供给多个管道：

```
cat *.txt | tee >(foo | bar > result1.txt)  >(baz | quux > result2.txt) | foobar 
```

* * *

## 回答 #2

> 赞同：132
> 
> 时间：2008-12-05T23:49:51.397

在 bash 中，您可以使用子shell 来单独执行命令管道，方法是将管道括在括号中。然后，您可以在它们前面加上 < 以创建匿名命名管道，然后您可以将其传递给 diff。

例如：

```
diff <(foo | bar) <(baz | quux) 
```

匿名命名管道由 bash 管理，因此它们会自动创建和销毁（与临时文件不同）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-08-01T08:40:27.280

到达此页面的一些人可能正在寻找逐行差异，`comm`或者`grep -f`应该使用它来代替。

需要指出的一件事是，在所有答案的示例中，差异实际上不会在两个流完成之前开始。用例如测试这个：

```
comm -23 <(seq 100 | sort) <(seq 10 20 && sleep 5 && seq 20 30 | sort) 
```

如果这是一个问题，您可以尝试[sd](https://github.com/MarianoGappa/sd) (stream diff)，它不需要排序（就像`comm`上面的例子一样）也不需要处理替换，比上面的例子快几个数量级，`grep -f` 并且支持无限流。

我建议的测试示例将这样写`sd`：

```
seq 100 | sd 'seq 10 20 && sleep 5 && seq 20 30' 
```

但不同的是，这`seq 100`将立即有所不同`seq 10`。请注意，如果其中一个流是 a `tail -f`，则无法通过进程替换来完成差异。

这是我写的[一篇](http://marianogappa.github.io/software/2016/07/30/diffing-streams-on-the-terminal/)关于在终端上区分流的博文，其中介绍了`sd`.

# c# - c#'bracketed'类型转换的运行时等价物是什么

> ID：345506
> 
> 赞同：1
> 
> 时间：2008-12-05T23:31:08.593
> 
> 标签：c#, casting, enums, runtime

假设我有一个枚举

```
[Flags]
public enum E { 
    zero = 0,
    one = 1
} 
```

然后我可以写

```
E e;
object o = 1;
e = (E) o; 
```

它会起作用。

但是如果我尝试在运行时这样做，比如

```
(o as IConvertible).ToType(typeof(E), null) 
```

它会抛出 InvalidCastException。

那么，有什么我可以在运行时调用的东西，它会从 int32 转换为 enum，就像我在上面写一个演员表一样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T00:19:18.060

```
 object o = 1;
object z = Enum.ToObject(typeof(E), o); 

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T23:32:42.350

您保存转换结果的变量看起来如何？即你用哪种类型声明它？

如果您想拥有一个对象变量，请这样做。而不是`null`，用于`Activator.CreateInstance`创建枚举的默认实例：

```
object o = Activator.CreateInstance(typeof(E)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T05:22:47.760

你也可以使用

```
Enum.Parse(typeof(E), (int)o) 
```

# perl - 如何删除文件的最后 N 行？

> ID：345513
> 
> 赞同：3
> 
> 时间：2008-12-05T23:34:26.480
> 
> 标签：perl, lines

有人可以给出一些关于如何从 Perl 中删除文件的最后 n 行的提示吗？我有一个大约 400 MB 的非常大的文件，我想从中删除大约 125,000 行的最后一行。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-05T23:38:06.927

您可以使用[Tie::File](http://search.cpan.org/dist/Tie-File)将文件作为数组处理。

```
使用领带::文件；
tie (@File, 'Tie::File', $Filename);
拼接 (@File, -125000, 125000);
解开@File;

```

另一种方法是在 shell中使用`head`和。`wc -l`

*编辑：* grepsedawk 提醒我们`-n`选项 to `head`，没有`wc`必要：

```
头 -n -125000 文件 > 新文件
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-07T06:17:38.303

正如人们已经建议的那样，Tie::Array 可以很好地完成工作，如果您想手动完成，我将列出基本算法。有一些草率、缓慢的方法可以很好地处理小文件。这是处理大文件的有效方法。

1.  查找文件中从末尾数第 N 行之前的位置。
2.  在那之后截断所有内容（使用`truncate()`）。

1是棘手的部分。我们不知道文件中有多少行或它们在哪里。一种方法是将所有行数起来，然后返回第 N 行。这意味着我们每次都必须扫描整个文件。更有效的是从文件末尾向后读取。您可以这样做，但使用[File::ReadBackwards](http://search.cpan.org/dist/File-ReadBackwards)`read()`更容易，它可以逐行向后（同时仍然使用有效的缓冲读取）。

这意味着您只阅读了 125,000 行而不是整个文件。 `truncate()`应该是 O(1) 并且是原子的，并且无论文件有多大，几乎都不会花费任何成本。它只是重置文件的大小。

```
#!/usr/bin/perl

use strict;
use warnings;

use File::ReadBackwards;

my $LINES = 10;     # Change to 125_000 or whatever
my $File = shift;   # file passed in as argument

my $rbw = File::ReadBackwards->new($File) or die $!;

# Count backwards $LINES or the beginning of the file is hit
my $line_count = 0;
until( $rbw->eof || $line_count == $LINES ) {
    $rbw->readline;
    $line_count++;
}

# Chop off everything from that point on.
truncate($File, $rbw->tell) or die "Could not truncate! $!"; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-05T23:47:06.160

你知道有多少行，或者关于这个文件还有其他线索吗？你必须一遍又一遍地这样做，还是只做一次？

如果我必须这样做一次，我会在 vim 中加载文件，查看最后一行号，然后从我想要的最后一行删除直到最后：

```
:1234567,$d 
```

一般的编程方式是分两遍进行：一是确定行数，二是去掉行数。

简单的方法是将正确数量的行打印到新文件中。它仅在周期和磁盘抖动方面有效，但大多数人都有很多。[perlfaq5](http://faq.perl.org/perlfaq5.html)中的一些东西应该会有所帮助。你完成了工作，然后继续生活。

```
尽管（ ）
   {
   打印$输出；
   最后如果 $。> $last_line_I_want;
   }

```

如果这是您必须做的很多事情或者数据太大而无法重写它，您可以创建行和字节偏移的索引并将文件[truncate()](http://perldoc.perl.org/functions/truncate.html)到正确的大小。当你保留索引时，你只需要发现新的行尾，因为你已经知道你离开的地方。一些文件处理模块可以为您处理所有这些。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-06T01:32:39.863

对于这个问题，我只会使用一个 shell 脚本：

```
tac file | sed '1,125000d' | tac 
```

（tac 类似于 cat，但以相反的顺序打印行。作者 Jay Lepreau 和 David MacKenzie。GNU coreutils 的一部分。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-06T00:19:39.370

1.  转到文件末尾：fseek
2.  倒数那么多行
3.  找出文件位置： ftell
4.  将文件截断到该位置作为长度：ftruncate

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T01:06:38.480

Schwern：你脚本中的`use Fnctl`和`$rbw->get_handle`行是必要的吗？此外，我建议`truncate`在它不返回 true 的情况下报告错误。

-- Douglas Hunter（如果可以的话，他会评论那篇文章）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-20T06:46:58.467

试试这个代码：

> 我的 $i =0 ;
> sed -i '\$d' 文件名 while( $i++ < n ) ;

反引号也将在那里，但我无法打印它们:(

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-19T08:50:37.067

试试这个

```
:|dd of=urfile seek=1 bs=$(($(stat -c%s urfile)-$(tail -1 urfile|wc -c))) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-19T09:01:16.047

我的建议，使用`ed`：

```
printf '$-125000,$d\nw\nq\n' | ed -s myHugeFile 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-20T06:29:51.423

此示例代码将在扫描文件时保留最后 10 行的索引。然后它使用缓冲区中最早的索引来截断文件。当然，这只有在 truncate 在您的系统上有效时才有效。

```
#! /usr/bin/env perl
use strict;
use warnings;
use autodie;

open my $file, '+<', 'test.in'; # rw
my @list;
while(<$file>){
  if( @list <= 10 ){
    push @list, tell $file;
  }else{
    (undef,@list) = (@list,tell $file);
  }
}

seek $file, 0, 0;
truncate $file, $list[0] if @list;
close $file; 
```

这有一个额外的好处，它只为最后十个索引和当前行占用了足够的内存。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-06T15:48:14.613

最有效的方法是查找文件末尾，然后增量读取段，同时计算每个段中的换行数，然后使用 truncate（请参阅 perldoc -f truncate）将其修剪掉。CPAN 上还有一两个模块用于向后读取文件。

# bash - 在 bash 中解析一行

> ID：345518
> 
> 赞同：4
> 
> 时间：2008-12-05T23:36:18.723
> 
> 标签：bash, parsing

我有一个文件，每行一个条目。每行具有以下格式：

```
 "group:permissions:users" 
```

权限和用户可以有多个值，用逗号分隔，如下所示：

```
 "grp1:create,delete:yo,el,ella" 
```

我想要的是返回以下内容：

```
yo
el
ella 
```

这是我到目前为止所拥有的：

```
cat file | grep grp1 -w | cut -f3 -d: | cut -d "," -f 2 
```

这返回`yo,el.ella`，我怎样才能让它每行返回一个值？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-05T23:41:14.313

您可以使用 awk，通过 -F 选项使用 : 作为字段分隔符：

```
[user@host]$ echo "grp1:create,delete:yo,el,ella" | awk -F ':' '{print $3}'
yo,el,ella 
```

这将为您提供用户字符串，以逗号分隔。然后你可以用那个字符串做任何你想做的事情。如果您想逐行打印每个用户，可以使用 tr 将逗号替换为换行符：

```
[user@host]$ echo "grp1:create,delete:yo,el,ella" | awk -F ':' '{print $3}' | tr ',' '\n'
yo
el
ella 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T16:04:50.427

这是完全在 shell 脚本中完成的一种方法。您只需要更改 IFS 即可在正确的字符上打断“单词”。注意：这根本不会处理转义（例如某些文件格式中的“:”）。

这是为了让您可以执行以下操作：

```
cat file | name-of-script 
```

剧本：

```
#!/bin/bash
while IFS=: read group permissions users; do
  if [ "$group" = "grp1" ]; then
    IFS=,
    set -- $users
    while [ $# -ne 0 ]; do
      echo $1
      shift
    done
  fi
done 
```

# javascript - 如何禁用不在表单内的选择框？

> ID：345540
> 
> 赞同：2
> 
> 时间：2008-12-05T23:53:04.150
> 
> 标签：javascript

当Select标记未嵌套在表单标记中时，我似乎无法禁用一个选择框。我尝试过的一些事情是（使用 Firefox 3）：（通过 Jquery）

```
$("#mySelect").attr("disabled", true);
$("#mySelect").attr("disabled", "disabled"); 
```

（还）

```
document.getElementById('mySelect').disabled = true;
document.getElementById('mySelect').disabled = true; 
```

这是HTML：

```
<select id="mySelect" onchange="updateChoice();">
<option value="1">First</option>
<option value="2" selected="">Second</option>
</select> 
```

我必须在表单元素中有这个选择框吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T23:58:21.283

简短回答：不，您不需要在表单中包含选择框。

`body`相对于HTML 中的标记，您的 JavaScript 当前包含在哪里？请记住，如果您的页面头部包含内联 JavaScript，那么它将在页面加载时触发。此时，选择框不会被解析，因此您的代码无法访问它以禁用它。

我不喜欢将 JavaScript 和标记混合在一起，但这个演示应该适用于所有意图和目的。

```
<html>
 <head>
  <title>JavaScript Select Demo</title>
 </head>
 <body>
    <select id="mySelect" onchange="updateChoice();">
        <option value="1">First</option>
        <option value="2" selected="">Second</option>
    </select>
 </body>
 <script type="text/javascript">
     document.getElementById('mySelect').disabled = true;
 </script>
</html> 
```

如果出于某种原因，您必须将脚本保留在页面中而不是外部文件中，您可以设置一个事件处理程序以在页面加载后执行相同的功能。您可以将其包含在头节点中，而不是将代码保留在标记的底部：

```
 <head>
  <title>JavaScript Select Demo</title>
  <script type="text/javascript">
    window.onload = function() {
        document.getElementById('mySelect').disabled = true; ;
    }
 </script>
 </head> 
```

最后，`onchange`您可以选择在 JavaScript 中设置事件处理程序来执行相同的行为，而不是在标记的属性中包含处理程序。[jQuery 使这非常容易](http://docs.jquery.com/Events/change)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T21:45:45.967

使用 jQuery 库时，请确保您编写的代码始终包含在`$.ready`函数中：

```
$(function () {
    //Type in your code here
}); 
```

这确保了**您编写的代码将在页面完成加载后执行**

# naming-conventions - 站点管理区域 URL 的安全名称？

> ID：345541
> 
> 赞同：0
> 
> 时间：2008-12-05T23:53:17.723
> 
> 标签：naming-conventions

主要针对 Web 开发人员的问题。

当您开发 Web 应用程序并为其添加管理区域时，您如何命名它？将其保留为“管理员”有点过时且不安全。

请注意分享任何其他名词、动词、形容词或诸如此类的东西，它们包含您知道/可以想到的任何网站的标题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-06T00:14:02.330

如果你有真正的安全保护管理区域，那么你怎么称呼它都无关紧要。通过默默无闻的安全是一个坏主意。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-07T18:35:24.370

默默无闻的安全是虚假的安全。

我打电话给我的/HackTheSiteHere。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T00:07:29.770

我喜欢用“超级”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T00:15:04.043

有时我使用 /controlpanel/ 或类似的东西，有时使用 /admin/ 或 /_admin/，使用难以猜测的东西并没有什么坏处，但你的安全性不应该以任何方式依赖于此。

默默无闻的一点安全性至少可以阻止一些攻击，但是用不了多久，中途的攻击者就可以找出它在哪里，更不用说心怀不满的前雇员因素等了。充其量它会只阻止最初不应该成为问题的攻击者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T23:58:53.670

我不会使用 /admin/ 因为它太明显了，但我真的不明白为什么你称之为它很重要。

不过，我要做的一件事是确保它可以通过更改一个配置变量随时更改该 url。

我宁愿不让人们知道我使用什么，因为当您甚至不知道后端区域在哪里时，访问后端区域要困难得多:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T00:09:36.147

我称我的管理员为管理员，因为我通常将文件夹映射到应用程序中的各种用户角色。我意识到这并不晦涩，但是该文件夹（以及与此相关的页面背后的代码）已正确锁定，因此匿名用户或未经适当授权的用户无法查看它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-07T18:07:12.600

我坚持使用管理员。为什么会不安全？无论如何，我对用户进行身份验证。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-07T18:28:44.193

我将管理页面与普通用户页面放在同一目录中。如果他们猜测 URL，那又怎样？他们只是收到拒绝访问消息并浪费时间，因为无论如何它都是开源的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-30T11:21:47.160

除了主站点之外，我根本不希望维护一个单独的管理区域。我宁愿根据登录用户的角色/级别和 ACL 显示不同的选项和可用操作。

是的，通过默默无闻的安全是一个坏主意！

# linux - 类似于 Linux 的 Perfmon？

> ID：345543
> 
> 赞同：15
> 
> 时间：2008-12-05T23:54:42.290
> 
> 标签：linux, performance, monitoring

在 Windows 中有 perfmon 来监视系统的各种性能方面（称为*计数器*）。

**Linux 有类似 perfmon 的吗？**

特别是对...感兴趣

*   CPU 使用率（总/每个进程/内核中）
*   内存使用量（总/每个进程/内核中）

...是否可以将此信息存储在文件中以供将来分析？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-06T00:10:09.327

[DStat](http://dag.wieers.com/home-made/dstat/)是我个人最喜欢的此类工具。从它的页面：

*   结合 vmstat、iostat、ifstat、netstat 信息等
*   在完全相同的时间范围内显示统计数据
*   启用/订购计数器，因为它们在分析/故障排除期间最有意义
*   处理额外计数器的插件框架。（例如 Wifi 质量）

我喜欢它！它绝对比 sar 更灵活（也更容易使用），我们只是让 dstat 定期写入文件。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-05T23:57:41.333

程序“top”完成了大部分工作。但它不处理网络流量。

编辑：

如果您需要记录此信息以进行后处理/分析，您可以使用标准包“sar”来执行此操作。它支持许多不同的性能数字，包括：磁盘、cpu、内存、网络等。

[sar 联机帮助页](http://linux.die.net/man/1/sar)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-07T10:57:46.257

如果你正在寻找一种在服务器上监控这些东西的方法，你应该看看像[Zabbix](http://www.zabbix.com)这样的监控框架。这将使您可以监视有关您的系统以及使用插件、您的应用程序的各种有趣的事情 - 以及存储一段时间的趋势数据，并让您对触发阈值等发出警报。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-01T06:51:15.843

我使用 nmon。它为您提供了非常清晰的视图。您还可以在单​​个页面中选择 CPU、网络、内核、磁盘 IO 负载、顶级进程等。这使得很容易关联事物，分析性能问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T01:41:57.333

我是[gkrellm](http://members.dslextreme.com/users/billw/gkrellm/gkrellm.html)的忠实粉丝，它将大量信息打包到显示器上的一个小竖条中。它是可配置的；我得到 CPU 使用、磁盘使用、内存使用、*温度*、网络流量等。当我的系统变慢时，我会立即知道是 CPU、磁盘、内存还是网络连接。信息设计不错；我会说每个像素的信息量很高。与“顶部”不同，您通常可以将其在屏幕的一侧打开。（“顶部”消耗了太多的屏幕空间，无法一直保持打开状态。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-12-12T12:18:08.087

使用“top”及其各种选项可以轻松查看您要查找的主要内容。当然，正如@grepsedawk 所说，sar 非常适合调试。但是，如果您需要在界面上监控它，有许多可用的监控工具**SeaLion**、**New Relic**、**munin**等。这些还可以让您检查其他参数，如磁盘使用情况、占用内存的顶级进程、占用 CPU 等。对我来说， [SeaLion](https://sealion.com)似乎很适合我使用，因为您也需要记录，所以您可以尝试一下。您无需将这些保存为文件以供将来分析。它们出现在一个很棒的界面中，您可以随时跳转到该界面查看当时的输出。

PS如果你还需要将它们存储为文件，那也是sealion提供的

# linux - 如何在 Linux 中获取 Apache 的“每秒请求数”？

> ID：345546
> 
> 赞同：23
> 
> 时间：2008-12-05T23:56:33.240
> 
> 标签：linux, apache, monitoring

在 Windows for ASP 中，您可以获得 perfmon，但是...

如何在 Linux 中获取 Apache 的**“每秒请求数” ？**

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-12-11T22:03:43.013

这是我为采样请求率而编写的一个简短的 bash 脚本（基于[dicroce](https://stackoverflow.com/questions/345546/how-to-get-requests-per-second-for-apache-in-linux/345588#345588)`wc -l`对在日志文件上使用的建议）。

```
#!/bin/sh

##############################################################################
# This script will monitor the number of lines in a log file to determine the
# number of requests per second.
#
# Example usage:
# reqs-per-sec -f 15 -i /var/www/http/access.log
#
# Author: Adam Franco
# Date: 2009-12-11
# License: http://www.gnu.org/copyleft/gpl.html GNU General Public License (GPL)
##############################################################################

usage="Usage: `basename $0` -f <frequency in seconds, min 1, default 60> -l <log file>"

# Set up options
while getopts ":l:f:" options; do
 case $options in
 l ) logFile=$OPTARG;;
 f ) frequency=$OPTARG;;
 \? ) echo -e $usage
  exit 1;;
 * ) echo -e $usage
  exit 1;;

 esac
done

# Test for logFile
if [  ! -n "$logFile" ]
then
 echo -e $usage
 exit 1
fi

# Test for frequency
if [  ! -n "$frequency" ]
then
 frequency=60
fi

# Test that frequency is an integer
if [  $frequency -eq $frequency 2> /dev/null ]
then
 :
else
 echo -e $usage
 exit 3
fi

# Test that frequency is an integer
if [  $frequency -lt 1 ]
then
 echo -e $usage
 exit 3
fi

if [ ! -e "$logFile" ]
then
 echo "$logFile does not exist."
 echo 
 echo -e $usage
 exit 2
fi

lastCount=`wc -l $logFile | sed 's/\([0-9]*\).*/\1/'`
while true
do
 newCount=`wc -l $logFile | sed 's/\([0-9]*\).*/\1/'`
 diff=$(( newCount - lastCount ))
 rate=$(echo "$diff / $frequency" |bc -l)
 echo $rate
 lastCount=$newCount
 sleep $frequency
done 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-05T23:58:53.420

实时，或者你可以使用[mod_status](http://www.cyberciti.biz/faq/apache-server-status/)吗？

显然，有一个[用于 apache 的 top](http://www.linuxhaxor.net/2008/01/15/real-time-display-of-apache-usage/)版本......

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-10-29T13:50:49.677

总而言之，您可以使用[mod_status](http://www.cyberciti.biz/faq/apache-server-status/)和[apachetop](http://www.howtogeek.com/howto/ubuntu/monitor-your-website-in-real-time-with-apachetop/)。

或者，您可以使用 Adam Franco 和 Jon Daniel 的漂亮脚本来进行现场查看。

如果您想查看特定的日期和时间，可以发出以下小命令：

```
grep "29/Oct/2014:12" /var/log/apache2/example.com.log | cut -d[ -f2 | cut -d] -f1 | awk -F: '{print $2":"$3}' | sort -nk1 -nk2 | uniq -c | awk '{ if ($1 > 10) print $0}' 
```

替换为您感兴趣的日期和时间以及日志文件的正确路径文件名。

它将打印出如下内容：

```
1913 12:47
 226 12:48
 554 12:49
 918 12:50 
```

[这里](http://www.inmotionhosting.com/support/website/server-usage/view-level-of-traffic-with-apache-access-log)有一篇不错的文章，其中提供了更多关于使用 awk、cut 和 uniq 命令组合来快速获取此类统计信息的选项。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-06T00:11:16.487

您可以在访问日志上使用'wc -l'来获取行数（大致对应于请求数......）每分钟执行一次并减去最后一个值以获得增量......

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-08-26T12:34:22.737

我不喜欢我找到的任何解决方案，所以我自己写了。

*   mod_status 不够准确。它基于服务器启动的时间，在我们的例子中通常是几个月。我正在寻找的是流量高峰。
*   上面的 shell 脚本使用了一个不理想的 sleep() 语句，因为实际检索数据需要 x 秒。

所以这个解决方案在access_log 15000个请求前取了一个特定的行，并使用记录的时间与当前时间进行比较。

```
# This check is needed because if the logs have just rolled over, then we need a minimum
# amount of data to report on.
# You will probably need to adjust the 3500000 - this is roughly the file size when the
# log file hits 15000 requests.
FILESIZE=`ls -l /var/log/httpd/access_log | awk '{print $5}' `
if [ $FILESIZE -le 3500000 ]
then
        # not enough data - log file has rolled over
        echo "APACHE_RPS|0"
else
        # Based on 15000 requests.  Depending on the location of the date field in
        # your apache log file you may need to adjust the ...substr($5... bit
        LASTTIME=`tail -15000 /var/log/httpd/access_log | head -1 | awk '{printf("%s\n",substr($5,2,20));}' `
        APACHE_RPS=`echo $LASTTIME | gawk -vREQUESTS=15000 ' {
                # convert apache datestring into time format accepted by mktime();
                monthstr = substr($0,4,3);
                if(monthstr == "Jan"){ monthint = "01"; }
                if(monthstr == "Feb"){ monthint = "02"; }
                if(monthstr == "Mar"){ monthint = "03"; }
                if(monthstr == "Apr"){ monthint = "04"; }
                if(monthstr == "May"){ monthint = "05"; }
                if(monthstr == "Jun"){ monthint = "06"; }
                if(monthstr == "Jul"){ monthint = "07"; }
                if(monthstr == "Aug"){ monthint = "08"; }
                if(monthstr == "Sep"){ monthint = "09"; }
                if(monthstr == "Oct"){ monthint = "10"; }
                if(monthstr == "Nov"){ monthint = "11"; }
                if(monthstr == "Dec"){ monthint = "12"; }
                mktimeformat=sprintf("%s %s %s %s %s %s [DST]\n", substr($0,8,4), monthint, substr($0,1,2), substr($0, 13,2), substr($0, 16,2), substr($0, 19,2) );
                # calculate difference
                difference = systime() - mktime(mktimeformat);
                # printf("%s - %s = %s\n",systime(), mktime(mktimeformat), difference);
                printf("%s\n",REQUESTS/difference);
        } ' `

        echo "APACHE_RPS|${APACHE_RPS}"
fi 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-05T23:58:45.653

我认为 mod_status 可以做到...

[http://httpd.apache.org/docs/2.0/mod/mod_status.html](http://httpd.apache.org/docs/2.0/mod/mod_status.html)

您还可以使用 zenoss 使用社区 apache 插件从 mod_status 收集数据。

[http://www.zenoss.com/](http://www.zenoss.com/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-09-19T10:55:50.497

脚本显示不一致的数字。`-f`参数对输出影响很大！并且一读也不准确。

我最终使用：

```
while true; do tail -n0 -f access.log>/tmp/tmp.log & sleep 2; kill $! ; wc -l /tmp/tmp.log | cut -c-2; done 2>/dev/null 
```

[在这里](http://www.commandlinefu.com/commands/view/5490/lines-per-second-in-a-log-file)找到。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-06-22T18:38:51.843

我编写了一组 Perl 脚本，显示过去 1、5 和 15 分钟的平均每秒请求数（如顶部）。它位于[https://gist.github.com/1040144](https://gist.github.com/1040144)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-05-23T13:52:56.150

mod_status 就是其中之一！如果你用以下方式调用它：

http://{ip}/server-status?refresh=1&auto-refresh=true

然后它每 2 秒自动刷新一次，因此您可以看到恒定的实时视图 :-)

# matlab - 如何自动化 Matlab/Simulink/Real-TimeWorkshop 代码生成？

> ID：345547
> 
> 赞同：6
> 
> 时间：2008-12-05T23:56:33.847
> 
> 标签：matlab, build-process, continuous-integration, build-automation

我想使用 Simulink mdl 以自动方式生成 C 文件。我目前正在尝试使用 m-script 和 dos 命令 shell，但我遇到了挂起 m-script 的“是否要保存”对话框的问题。通过实验，我知道在运行“set_param”行时正在修改 mdl（即，如果删除了 set_param 调用，则不会出现“保存”对话框问题），但我需要在生成代码之前对 mdl 进行一些设置。

m脚本：

```
rtwdemo_counter
set_param(gcs,'SystemTargetFile','ert.tlc')
rtwbuild(gcs)
exit 
```

多斯

```
matlab -r samplebuild -nosplash -nodesktop 
```

Windows XP 上的 Matlab 7.7.0,471

我的最终目标是在持续集成服务器 (CruiseControl) 上自动生成代码，我觉得必须有一种更强大的方法来使用 matlab 工具链来完成此任务。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-08T20:57:20.493

使用以下命令强制关闭模型而不保存：

```
 close_system(gcs, false); 
```

例如

```
 rtwdemo_counter
 set_param(gcs,'SystemTargetFile','ert.tlc')
 rtwbuild(gcs)
 close_system(gcs, false);
 exit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T00:21:46.450

你能做类似的事情：

> matlab -r samplebuild -nosplash -nodesktop < 是

?

其实我知道你可以做到，只是不确定它会起作用......;）

# graph-layout - 哪些算法适用于交互式/实时绘图？

> ID：345549
> 
> 赞同：3
> 
> 时间：2008-12-05T23:57:31.910
> 
> 标签：graph-layout, graph-drawing, information-visualization

哪些算法适用于实时数据和直接操作的交互式/实时图形绘制？

做不到这一点-您使用哪些库来绘制图形？

建议；

*   [Prefuse](http://prefuse.org/)信息可视化工具包
*   还有其他人吗？

顺便说一句-我的意思是图论意义上的图-点和线

*   任何语言
*   现场我的意思是图表应该在屏幕上一次可操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-01-20T16:35:18.177

我会推荐 Jeff Heer 研究过的任何库：

*   [D3](http://d3js.org/)
*   [普罗托维斯](http://vis.stanford.edu/protovis/)
*   [耀斑](http://flare.prefuse.org/)
*   [预熔](http://prefuse.org/)

我相信这三个项目都是开源的。Jeff Heer 非常擅长在他的代码中引用论文，至少在 Prefuse 库中是这样。查看 Prefuse 源代码：

**BalloonTreeLayout**：使用的算法是 G. Melançon 和 I. Herman 的算法，来自他们的研究论文 Circular Drawings of Rooted Trees，数学和计算机科学中心报告，报告编号 INS–9817，1998。

**ForceDirectedLayout.java**：没有提到参考，但是有很多评论描述了它是如何工作的。

**FruchtermanReingoldLayout.java**：参考[Jung](http://jung.sourceforge.net)。在他们的网站上，我发现了[一篇论文，其中提到了各种算法](http://jung.sourceforge.net/doc/JUNG_journal.pdf)

**NodeLinkTreeLayout.java**：使用的算法是 Christoph Buchheim、Michael Jünger 和 Sebastian Leipert 的研究论文[改进 Walker 的算法以在线性时间运行](http://citeseer.ist.psu.edu/buchheim02improving.html)，图形绘图 2002。该算法纠正了 Walker 算法中的性能问题，该算法推广了 Reingold 和 Tilford 的算法用于整理树的绘图方法，以支持在任何给定节点具有任意数量的子树的树。

**RadialTreeLayout.java**：使用的算法是 Ka-Ping Yee、Danyel Fisher、Rachna Dhamija 和 Marti Hearst 在他们的研究论文[Animated Exploration of Dynamic Graphs with Radial Layout](http://citeseer.ist.psu.edu/448292.html) , InfoVis 2001 中使用的算法。该算法计算了一个径向布局，它考虑了可能的因素尺寸变化，并保持方向和排序约束，以促进布局配置之间的平滑和可理解的转换。

**SquarifiedTreeMapLayout**：这个特定的算法取自 Bruls、DM、C. Huizing 和 JJ van Wijk，“Squarified Treemaps”在*Data Visualization 2000 中，Proceedings of the Joint Eurographics and IEEE TCVG Sumposium on Visualization*，2000，第 33-42 页。[可在http://www.win.tue.nl/~vanwijk/stm.pdf](http://www.win.tue.nl/~vanwijk/stm.pdf)在线获取。有关 TreeMaps 的更多信息，请参阅[http://www.cs.umd.edu/hcil/treemap-history](http://www.cs.umd.edu/hcil/treemap-history)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-28T18:09:10.867

[prefuse 可视化工具包](http://prefuse.org/)看起来是个不错的选择。

> Prefuse 支持一组丰富的数据建模、可视化和交互功能。它为表格、图形和树提供优化的数据结构、大量布局和视觉编码技术，并支持动画、动态查询、集成搜索和数据库连接。Prefuse 是用 Java 编写的，使用 Java 2D 图形库，并且很容易集成到 Java Swing 应用程序或 Web 小程序中。Prefuse 根据 BSD 许可条款获得许可，可自由用于商业和非商业目的。（来自主页）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-29T09:17:23.060

绘图是一个很大的领域。这是[图形绘图研究社区网站](http://www.graphdrawing.org/)的链接。他们有一个专门关于绘图的年度会议。我还可以建议阅读一些[David Harel 教授的出版物](http://www.wisdom.weizmann.ac.il/~harel/papers.html)——他的研究领域之一是绘图，例如[这篇论文](http://www.wisdom.weizmann.ac.il/~harel/papers/ms_jgaa.pdf)。在一般情况下，这似乎是一个很难解决的问题。也许您可以将您的应用程序限制为某些受限制的图形子集（平面图可能过于严格）。带有一小组顶点的简单图可能会产生更容易的操作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-27T16:07:56.030

有一些与[Graphviz](http://www.graphviz.org)相关的漂亮论文。尤其：

*   [ER Gansner、E. Koutsofios、SC North 和 K.-P。Vo (1993) “绘制有向图的技术”](http://www.graphviz.org/Documentation/TSE93.pdf)
*   [SC North 和 G. Woodhull (2002) “在线层次图绘图”](http://www.graphviz.org/Documentation/NW01.pdf)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-06T00:58:09.853

我使用 Dot 语言来描述图形。而且，Dot 编译器的输出包括 SVG，它是 XML 格式，可以嵌入到 XHTML 中。

```
http://en.wikipedia.org/wiki/DOT_language 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-06T00:05:24.813

不知道你在追求什么...

听起来您可能正在寻找类似于 rrdtool 的东西？

也许他们的网站上有一些信息会有所帮助：

[http://oss.oetiker.ch/rrdtool/](http://oss.oetiker.ch/rrdtool/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-14T04:28:51.993

我是stackflow的新手，很抱歉回复晚了。根据您想要获得的交互方式......您可能还不想检查[Flot](http://code.google.com/p/flot/)（使用 JQuery，交互性较低）或[处理](http://www.processing.org/)......更具交互性。

# asp.net - 设置默认 AspNetSqlProvider 以指向远程数据库

> ID：345559
> 
> 赞同：6
> 
> 时间：2008-12-05T23:59:58.007
> 
> 标签：asp.net, sql-server, asp.net-membership

在开始一个需要使用成员资格提供程序的新项目时，我发现我无法连接到包含成员资格数据库的远程数据库。

我运行了 aspnet_regsql 并能够在远程服务器上创建成员数据库，但是当我转到 ASPNET 配置（cassini 开发服务器）时，它不会连接到远程服务器。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-06T00:07:23.013

经过大量搜索，我发现 machine.config (c:\windows\Microsoft.NET\Framework\v2.0.50727\CONFIG) 中指定的默认 Membership Provider 始终指向在 localhost 上运行的 SQL Server。

除了修改 machine.config 之外，还有一种方法可以在项目 web.config 中进行设置：

1）设置远程数据库的连接字符串

```
 <connectionStrings>
      <add name="aspnet_membership" connectionString="<your_connection_string>"/>
    </connectionStrings> 
```

2）在`<system.web>`重新定义默认提供者：

```
 <membership>
    <providers>
        <remove name="AspNetSqlMembershipProvider"/>
        <add name="AspNetSqlMembershipProvider" 
            type="System.Web.Security.SqlMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" 
            connectionStringName="aspnet_membership"
            enablePasswordRetrieval="false" 
            enablePasswordReset="true" 
            requiresQuestionAndAnswer="true" 
            applicationName="/" 
            requiresUniqueEmail="false" 
            passwordFormat="Hashed" 
            maxInvalidPasswordAttempts="5" 
            minRequiredPasswordLength="7" 
            minRequiredNonalphanumericCharacters="1" 
            passwordAttemptWindow="10" 
            passwordStrengthRegularExpression=""/>
    </providers>
  </membership> 
```

是`<remove name="AspNetSqlMembershipProvider"/>`关键！所有其他键/值直接取自 machine.config

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T00:53:40.260

```
<membership>
       <providers>
           <clear/>
           <add name="AspNetSqlMembershipProvider"
               type="System.Web.Security.SqlMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
               connectionStringName="aspnet_membership"
               enablePasswordRetrieval="false"
               enablePasswordReset="true"
               requiresQuestionAndAnswer="true"
               applicationName="/"
               requiresUniqueEmail="false"
               passwordFormat="Hashed"
               maxInvalidPasswordAttempts="5"
               minRequiredPasswordLength="7"
               minRequiredNonalphanumericCharacters="1"
               passwordAttemptWindow="10"
               passwordStrengthRegularExpression=""/>
       </providers>
   </membership> 
```

我需要添加此行以使我的 Roles 和 Profile 员工基于 Membership 类工作：

```
 <profile>
       <providers>
           <clear/>
           <add name="AspNetSqlProfileProvider"
           connectionStringName="aspnet_membership"
           applicationName="/"
           type="System.Web.Profile.SqlProfileProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
       </providers>
   </profile>

   <roleManager enabled="true">
       <providers>
           <clear/>
           <add name="AspNetSqlRoleProvider"
           connectionStringName="aspnet_membership"
           applicationName="/"
           type="System.Web.Security.SqlRoleProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
           <add name="AspNetWindowsTokenRoleProvider"
           applicationName="/"
           type="System.Web.Security.WindowsTokenRoleProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
       </providers>
   </roleManager> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-12T14:15:02.033

第2步：复制这个：

```
<remove name="LocalSqlServer"/>

<add name="LocalSqlServer" connectionString="Data Source=VMK\sqlexpress;Initial Catalog=commodity_exchange;Integrated Security=True" providerName="System.Data.SqlClient"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-12T14:11:48.820

这是解决方案：

第 1 步：启动 Visual Studio 命令提示符 类型：aspnet_regsql 指定您的服务器：if sqlexpress then server = hostname\sqlexpress ***** ** *** ** *** ***** *使用 Windows 身份验证

第 2 步：将其复制到 web config。不要指定用户名或密码，因为您使用 Windows 身份验证进行连接，这就是我们集成安全性 =true 的原因。

第 3 步：将 Web 管理工具上的安全性>身份验证类型更改为“来自 Internet”。

现在享受。

# algorithm - 你能在文本中隐藏数据吗？

> ID：345562
> 
> 赞同：5
> 
> 时间：2008-12-06T00:03:39.073
> 
> 标签：algorithm, design-patterns, steganography

我希望在页面上放置一些文本并在该文本中隐藏一些数据。有谁知道过去用来解决这个问题的任何方法/模式？

示例：我有以下文字：“猫坐在狗身上，很开心。”

我也有数字 123。我想在那个句子中隐藏这个数字，这样句子就可以放在网页上，只有知道的人才能找到数据。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-06T00:10:30.963

当然这是可以做到的。

您所描述的是一个广泛的描述，称为[隐写术](http://en.wikipedia.org/wiki/Steganography)。

例如，您可能会以这样一种方式对数字进行编码，即计算单词的数量，直到看到字母 B，在这种情况下，123 可以编码为：

```
You belong to the beautiful group of people being elite. 
```

问题是，想要解码您的*消息*的人必须知道您的算法。

**编辑**我注意到我的数字差了一个。从 0 开始计数，您会看到数字 123。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-06T08:18:43.537

实际上，HTML 使执行此操作变得非常容易。不需要真正狡猾的隐写术等。让我们看看：

这句话嵌入了123，然后停止嵌入。

这句话嵌入0102，然后停止嵌入。

（我们必须看看它是否真的在降价中起作用，但我怀疑是这样。）诚然，如果你知道有*什么东西*要寻找，那是很明显的，但我想你会同意这对普通的观察者来说并不明显。

我把它作为一个小谜题来制定这个方案，但如果你想明确地解释它，请添加评论。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T10:50:50.670

这个问题有很复杂的方法，但是你可以用一个非常简单的方法。例如为每个数字定义一个形容词：

```
0\. beautiful
1\. harmless
2\. evil
3\. colorful
4\. weird 
```

等等。现在选择您选择的句子并将占位符放入形容词所属的句子中。

```
"The {adj} cat sat on the {adj} dog and the {adj} cat was happy." 
```

你的号码是123，所以你的句子是

```
"The harmless cat sat on the evil dog and the colorful cat was happy." 
```

解析器可以轻松获取句子，将其拆分为单词，在上表中找到形容词，然后将它们转换回数字。

```
The -> ?
harmless -> 1
cat -> ?
sat -> ?
on -> ?
the -> ?
evil -> 2
: 
```

最后你又得到了 123。

人们一旦知道句子中隐藏着信息，算法就很容易被破解。如果您通过为每个数字定义多个形容词来添加变体，则可以使其更难中断。代替

```
1\. harmless 
```

你可以定义

```
1\. harmless/stupid/blue/fashionable 
```

当您需要编码 1 时，随机选择上面的任何单词。由于这些都映射到数字 1，反向解析器不会关心其中打印了哪些单词，结果将始终为 1。这种随机化将使算法更难逆向工程。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-06T00:08:08.020

我认为在高层次上你所说的是隐写术。 [http://en.wikipedia.org/wiki/Steganography](http://en.wikipedia.org/wiki/Steganography)

现代技术部分应该让你开始：[http ://en.wikipedia.org/wiki/Steganography#Modern_steganographic_techniques](http://en.wikipedia.org/wiki/Steganography#Modern_steganographic_techniques)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T00:08:12.623

我认为你正在寻找的是一种叫做隐写术的东西。Corinna John 在 CodeProject 上收集了关于该主题的优秀文章。

[http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=475133](http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=475133)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T00:07:12.483

可能有一种算法可以将该句子转换为 123，但我认为一般来说，如果您需要存储任何可能的数值，您将需要接受对文本的一些修改！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-06T00:10:45.737

如果“文本”实际上是图像，那么您可以使用[隐写术隐藏](http://lifehacker.com/software/privacy/geek-to-live--hide-data-in-files-with-easy-steganography-tools-230915.php)其中的数据 - 数据隐藏在二进制图像文件中，而不会影响图像的外观。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-06T00:14:38.273

根据这个[线程](http://www.watermarkingworld.org/WMMLArchive/0112/msg00024.html)：

[Mikhail Atallah](http://www.cs.purdue.edu/people/faculty/mja/)教授等。人。普渡大学对**[水印文本](http://www.springerlink.com/content/3qxf4rjkh7pecqu6/)**做了很多研究。

该方法使用短语的 TMR（[文本含义表示](http://crl.nmsu.edu/Research/Projects/mikro/htmls/oldstuff-htmls/tmr-intro.html)）通过执行将 TMR 定位在与定义的规范形式一定距离处的微小变换来对位进行编码。

[（这里介绍了](http://www.google.fr/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.cs.usyd.edu.au%2F~vip2000%2Fpapers%2Fhuang_watermark.doc&ei=HcQ5SdWEBoau0gWtz-mxBQ&usg=AFQjCNEtvP45_vSuDrn8XOOBljY0U69LxQ&sig2=hXqGIxwm-UEFjcvn3qqbeg)另一种给文本加水印的方法）

这可能是在文本中隐藏文本的另一种方法，以及其他答案中描述的隐写术方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-24T18:53:47.640

[Jon Skeet 提到的方法与 Matthew Kwan 的“ SNOW](http://www.cotse.com/tools/stega.htm) ”方法非常相似。它们都在文本中隐藏少量任意信息，而不添加、删除或更改源文本中的任何单词。两者都以通常不相关、通常不可见的空白对秘密消息进行编码——单词之间和行尾的额外空格和制表符。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-28T23:36:34.797

这是一个将加密数据转换为“自然”文本消息的原型。

[http://herosys.net/w/project/text-steganography-hide-text-in-spam-sms](http://herosys.net/w/project/text-steganography-hide-text-in-spam-sms)

将“明天早上 8 点在大学东门见你”之类的源文本转换为看起来像垃圾邮件的短文本消息。

“有史以来最好的房子！你不应该错过它。1000-3000 平方英尺。每平方英尺 15-80 美元。请致电 123-456-7890”。

该算法是您只需创建一个语法图，并为每个单词创建一个候选表。就像 BASE64 一样，但索引表会根据您预定义的上下文进行更改。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-06T00:06:31.377

好吧，你可以尝试这样的[事情](https://www.spammimic.com/)......不过，不确定这是否正是你想要的。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-05-06T14:01:35.590

我有两个方案具有良好的安全性，但要权衡相当低的隐写嵌入率。其中一个非常简单，但对于任意用户给定的文本，每行的嵌入率只有 1 位，而另一个需要用户在软件的指导下编写封面文本，嵌入率在 [0.5 , 1.0] 每字。查看我的主页 mok-kong-shen.de

# testing - 为什么可用性评估方法很少使用？

> ID：345566
> 
> 赞同：5
> 
> 时间：2008-12-06T00:06:22.453
> 
> 标签：testing, user-interface, usability, user-experience

在软件开发的历史上已经开发了许多可用性评估技术。但在我看来，它们在实践中很少使用。

为什么可用性评估工具和方法实际上没有被大量使用？

或者它们的使用比我被引导相信的更多？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T00:26:14.753

它们很少见，[HCI](http://en.wikipedia.org/wiki/Human-computer_interaction)是 IT 的专业领域。我对此几乎一无所知，但我的一个朋友是 HCI 工程师，她可以背诵有关该主题的大量数据，展示网站，群组，学术论文等。

HCI 仍然是一个（不应有的）很少受到关注的领域，可能是因为它被认为对销售软件的业务不那么重要 - 收缩包装的软件是根据营销声明销售的，而不是它的实际可用性，因此对于那些支付软件开发费用来支付 HCI 费用。

如果你想了解更多（它的好处是你应该鼓励使用它——我使用了太多糟糕的界面，虽然我尝试开发得更好，但我经常没有机会真正为我的用户改进东西），试试[这个网站/书](http://www.hcibook.com/e3/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T00:30:16.853

问题主要源于这样一个事实，即大多数制作软件的公司从来没有停下来问“我怎样才能使这个用户界面更易于使用？”，而更多地只是问“用户是否能够对界面进行 XYZ 操作？” .

通常，公司只会问“如果用户知道我们所做的一切，用户可以用这个界面做 XYZ 吗？” 更糟糕的是。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T01:59:54.393

通常不应用可用性方法是因为做出购买决定的人不会为可用性买单。

我个人经验的一个领域是会议管理软件（Cyber​​Chair、START 和其他一百万种软件）。这些东西一定很容易写，因为它们太多了，但我发誓大多数写它们的人*从未*观察过裁判或程序主席在工作。回到*为什么的问题*，在这种情况下，项目主席和委员会成员高度分布在空间中——开发人员很难找到一个并观察他或她的工作。模拟工作流程需要大量的设置成本，并且在任何一个城镇中，可能很少有人有资格成为可用性研究的对象，他们的时间很宝贵。而且没有足够的利润来证明可用性是合理的。我的专业协会 SIGPLAN 最近签约在其会议上使用劣质软件，因为劣质产品被认为比备受推崇的竞争对手便宜十倍。使用该产品的志愿者的时间一如既往地被认为是零。

另一个战争故事，我会闭嘴：当我为电话公司工作时，一个开发团队实际上有一个可用性专家。但他是*唯一*被允许与客户互动的人。我认为很多商店的管理层都害怕让开发人员和客户直接互动。这种态度使得应用可用性方法变得困难。

那些底线取决于可用性的人会进行研究。eBay 就是一个很好的例子。我曾经是他们的主题，花了 90 分钟令人难以置信的疲惫，只是想卖一些书。他们派了 2 名训练有素的工程师带着视频设备*到我家*，这些人非常专业。当我感到沮丧时，他们没有为我保释，直到研究结束，他们才告诉我，我之所以有如此糟糕的经历，是因为我在他们的软件中遇到了错误。哦，他们为我 90 分钟的时间付了 200 美元。eBay 显然认为，在他们的网站上轻松销售会让他们更有利可图，他们愿意花真金白银去找出真正的用户遇到麻烦的地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T00:48:25.863

这可能有点切题，但我所知道的两个最好的可用性建议来源是 Steve Krug 和 Kathy Sierra。

遗憾的是，凯西不再写博客了，但你可以在她的博客“[创造热情用户](http://headrush.typepad.com/)”的存档中看到多年的观察。

Steve Krug 的书[“不要让我思考”](http://www.sensible.com/)可能是有史以来最好的可用性圣经之一（他花了相当多的时间讨论可用性测试工具和策略）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T01:43:45.050

可用性分析（尤其是用户测试）需要大量的前期成本，包括时间和金钱。它通常还揭示了一整批人们宁愿忽略的要解决的问题……

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-11T15:44:48.023

可用性测试（或我们中的一些人所知道的用户研究）必须涉及大量的前期成本，这是一个谬论。当然，如果您“正式”进行，并带着测试和后续分析去城里，它可能会花费大量费用。但是，如果开发继续沿着不正确的路径发展并且必须在以后重新工作，那么这个成本将要小得多。

与许多技术一样，有很多方法可以以较低的成本从用户研究中获得优质、相关和快速的信息。即使你只采访少数人，你也会得到关键问题的评论。您可以在同一次会议上与所有利益相关者快速讨论输出，而不是正式分析，尤其是当您的研究专注于特定目标时。您可以通过采访更大的产品团队（技术作家、销售、培训师等）而不是用户本身来获得良好的反馈。

即使发现的问题没有得到解决，至少它们是公开的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-08T17:23:16.547

“未来已经到来，只是分布不均而已。”

可用性评估工具和方法**一直在**使用……但在某些领域比其他领域更多。在我的整个职业生涯中，我一直是一名用户体验 (UX) 专家——从我的立场来看，*不*使用这些工具和方法是更不寻常的。

电子商务网站已广泛采用可用性和用户体验研究。为什么？因为可用性和创收之间存在非常直接的联系。

其他行业就没有那么幸运了，因为链接不是那么直接。当购买者和用户之间存在差距时，就没有动力在以用户为中心的设计 (UCD) 上花钱。例如，企业软件主要根据功能列表出售给实际上不必每天使用该软件的人。因此，这些应用程序的可用性可能非常令人震惊。当然，在企业软件中构建出色的可用性（降低培训成本、提高任务完成时间、员工士气等）有一个非常好的论据，但由于它不会影响销售，因此可用性会以某种方式被搁置一旁。（这将在未来发生变化，但目前可用性军备竞赛还没有在这个利基市场开始）。

当然，只要一家企业供应商开始生产具有出色可用性的产品，竞争格局就会发生变化。成为第一个需要勇气和金钱。这都是关于行为经济学的。

无论如何，听起来你碰巧在一个不关注用户体验的利基市场工作。你应该把它看作一个机会。

顺便说一句，你们中那些说用户体验研究不需要昂贵的人——这是一个流行的论点，但在我看来，这不是一个好的论点。无论您以 10,000 英镑的价格外包对 10 个用户的一轮可用性测试（是的，这确实是成本），或者您是否在内部几乎一无所获，项目时间表都必须延长以适应这一点。测试后，需求规格受到质疑，然后您必须做出决定并实施更改。如果变化很大，您将不得不再次测试。这不可避免地很耗时，而且这本身就是昂贵的。让您的组织专注于用户体验的更好理由是**不进行研究的代价**. 这可能是灾难性的。大多数组织都有一两次火车失事，在启动后发现可用性差，并破坏了原本不错的项目。找到你的火车残骸，然后把重点放在家里。

# iphone - 通过 UIActionSheet 自定义 UIView

> ID：345572
> 
> 赞同：1
> 
> 时间：2008-12-06T00:07:30.737
> 
> 标签：iphone, objective-c, cocoa-touch

是否可以使用自定义 UIView 修改 UIActionSheet？我的一个表格中有一个首选项单元格，它将极大地受益于带有 UIDatePicker 的模式窗口。让它显示为警报也很棒。理想情况下，获得与 UIActionSheet 一起使用的免费动画会很好。否则，只需创建 UIView、设置自定义背景、添加 UIDatePicker 并手动对其进行动画处理。

有没有比复制 Apple 通常开箱即用的许多功能更智能/更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T00:43:33.783

UIActionSheet 是一个 UIView。您应该能够将其他视图添加到其子视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-21T08:14:30.270

作为对此问题的任何人的后续行动，Apple 不支持修改 UIActionSheet。这样做的应用程序很可能会在主要操作系统更新时中断。

# sorting - 按时间顺序对评论列表进行排序

> ID：345589
> 
> 赞同：1
> 
> 时间：2008-12-06T00:11:16.877
> 
> 标签：sorting, html-helper, alphabetized

我正在尝试按时间顺序对电影评论列表进行排序。我们有两个选项可供用户选择，按时间顺序排列和按字母顺序排列。该页面默认按字母顺序排列，但是当人们单击按时间顺序排列的选项时，什么也没有发生。

这是我们现在拥有的代码：

```
// category 3 is 'reviews', category 12 is 'dvd reviews'
                if (($GLOBALS["CategoryId"] == 3 || $GLOBALS["CategoryId"] == 12) && !isset($_GET['unsort']))
                {
                    $output = AL_HELPER::GetArticles($articleResult);
                }
                else
                {
                    $output = AL_HELPER::GetArticlesABC($articleResult);
                } 
```

我所做的是翻转两个ifs。将 GetArticles 放在第一位，GetArticlesABC 放在第二位——这意味着它看起来像这样：

```
// category 3 is 'reviews', category 12 is 'dvd reviews'
                if (($GLOBALS["CategoryId"] == 3 || $GLOBALS["CategoryId"] == 12) && !isset($_GET['unsort']))
                {
                    $output = AL_HELPER::GetArticlesABC($articleResult);
                }
                else
                {
                    $output = AL_HELPER::GetArticles($articleResult);
                } 
```

它确实按时间顺序对评论进行了排序，但它去掉了所有按字母顺序排列的选项。本质上，这是一长串按时间顺序排列的评论。所以显然这不是我们想要的。

有谁知道如何限制它在页面上列出的项目数量？或者，这里可能需要一种完全不同的方法，如果是这样，有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T01:38:16.980

限制每页的结果数量，如果使用后端数据库和 SQL 就像使用 LIMIT 运算符只检索一组结果一样简单。然后，您可以通过在页面之间传递与您提取的结果集相关的变量来实现下一个/上一个操作。

例如：

```
SELECT <Whatever> FROM <review table> LIMIT 0,10 
```

将检索前 10 个结果。

```
SELECT <Whatever> FROM <review table> LIMIT 10,20 
```

将检索下一个 10。通过用变量替换数字，您可以实现分页：

```
SELECT <Whatever> FROM <review table> LIMIT resultIndex,resultIndex+10 
```

# visual-studio - 如何只使用 Visual Studio 的命令行窗口构建文件的项目？

> ID：345604
> 
> 赞同：2
> 
> 时间：2008-12-06T00:18:20.620
> 
> 标签：visual-studio, build, projects-and-solutions, command

默认情况下，Ctrl-Shift-B 构建一个完整的解决方案。一个完整的解决方案可能包含许多项目。同时编译可能会很慢，尤其是当开发只发生在一个项目上时。

我尝试将 Ctrl-Shift-B 重新映射到 Build.BuildOnlyProject，但它不起作用。没发生什么事。

从菜单中，以下选项完全符合我的要求：

```
Build -> Build [MY PROJECT NAME] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T00:25:49.997

命令是**Build.BuildSelection**

要将其绑定到键，请单击**工具 | 定制 | 键盘...**然后搜索它来绑定它。

**注意**：至少在 VS2010 中，Build.BuildOnlyProject 不能一直工作。

# c++ - 使用 STL 从文件中删除除最后 500,000 个字节之外的所有字节

> ID：345610
> 
> 赞同：1
> 
> 时间：2008-12-06T00:19:49.697
> 
> 标签：c++, logging, stl

我们的日志记录类在初始化时会将日志文件截断为 500,000 字节。从那时起，日志语句将附加到文件中。

我们这样做是为了保持较低的磁盘使用率，我们是一种商品最终用户产品。

显然保留前 500,000 个字节是没有用的，所以我们保留最后 500,000 个字节。

我们的解决方案存在一些严重的性能问题。什么是有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T12:28:33.953

> “我可能会创建一个新文件，在旧文件中查找，从旧文件到新文件进行缓冲读/写，将新文件重命名为旧文件。”

我认为你最好简单地：

```
#include <fstream>
std::ifstream ifs("logfile");  //One call to start it all. . .
ifs.seekg(-512000, std::ios_base::end);  // One call to find it. . .
char tmpBuffer[512000];
ifs.read(tmpBuffer, 512000);  //One call to read it all. . .
ifs.close();
std::ofstream ofs("logfile", ios::trunc);
ofs.write(tmpBuffer, 512000); //And to the FS bind it. 
```

这可以避免文件重命名，只需将最后的 512K 复制到缓冲区，以截断模式打开日志文件（清除日志文件的内容），然后将相同的 512K 吐回文件的开头。

请注意，上面的代码尚未经过测试，但我认为这个想法应该是合理的。

您可以将 512K 加载到内存中的缓冲区中，关闭输入流，然后打开输出流；这样，您将不需要两个文件，因为您输入、关闭、打开、输出 512 个字节，然后继续。您可以通过这种方式避免重命名/文件重定位魔术。

如果您在某种程度上不反对将 C 与 C++ 混合使用，您也可以：

（注意：伪代码；我不记得我脑海中的 mmap 调用）

```
int myfd = open("mylog", O_RDONLY); // Grab a file descriptor
(char *) myptr = mmap(mylog, myfd, filesize - 512000) // mmap the last 512K
std::string mystr(myptr, 512000) // pull 512K from our mmap'd buffer and load it directly into the std::string
munmap(mylog, 512000); //Unmap the file
close(myfd); // Close the file descriptor 
```

取决于许多事情，mmap*可能*比寻找更快。如果你好奇的话，谷歌搜索“fseek vs mmap”会产生一些有趣的阅读。

高温高压

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T01:22:06.157

我可能会：

*   创建一个新文件。
*   在旧文件中寻找。
*   从旧文件到新文件进行缓冲读/写。
*   将新文件重命名为旧文件。

执行前三个步骤（省略了错误检查，例如，如果文件小于 500k 大，我不记得 seekg 做了什么）：

```
#include <fstream>

std::ifstream ifs("logfile");
ifs.seekg(-500*1000, std::ios_base::end);
std::ofstream ofs("logfile.new");
ofs << ifs.rdbuf(); 
```

然后我认为你必须做一些非标准的事情来重命名文件。

显然，您需要 500k 的可用磁盘空间才能使其工作，因此，如果您截断日志文件的原因是因为它刚刚填满了磁盘，那么这并不好。

我不确定为什么搜索速度很慢，所以我可能会遗漏一些东西。我不希望寻找时间取决于文件的大小。可能取决于文件的是，我不确定这些函数是否在 32 位系统上处理 2GB+ 文件。

如果复制本身很慢，那么根据平台的不同，您可能可以通过使用更大的缓冲区来加速它，因为这减少了系统调用的数量，也许更重要的是磁盘头必须在读取之间寻找的次数点和写入点。去做这个：

```
const int bufsize = 64*1024; // or whatever
std::vector<char> buf(bufsize);
...
ifs.rdbuf()->pubsetbuf(&buf[0], bufsize); 
```

用不同的值测试它，看看。您也可以尝试增加 ofstream 的缓冲区，我不确定这是否会有所作为。

请注意，在“实时”日志文件上使用我的方法很麻烦。例如，如果在副本和重命名之间附加了一个日志条目，那么您将永远丢失它，并且您尝试替换的文件上的任何打开句柄都可能导致问题（它在 Windows 上会失败，在 linux 上会失败）将替换文件，但旧文件仍将占用空间并仍会被写入，直到句柄关闭）。

如果截断是从执行所有日志记录的同一线程完成的，那么就没有问题，您可以保持简单。否则，您将需要使用锁或其他方法。

这是否完全健壮取决于平台和文件系统：移动和替换可能是也可能不是原子操作，但通常不是，因此您可能必须重命名旧文件，然后重命名新文件，然后删除旧文件，并进行错误恢复，在启动时检测是否有重命名的旧文件，如果有，则将其放回并重新启动截断。STL 不能帮助您处理平台差异，但是有 boost::filesystem。

抱歉，这里有很多警告，但很大程度上取决于平台。如果您在 PC 上，那么我很奇怪为什么复制区区半兆的数据需要任何时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T10:29:31.760

如果您碰巧使用 Windows，请不要费心复制零件。[`FSCTL_SET_SPARSE`](http://msdn.microsoft.com/en-us/library/aa364596%28VS.85%29.aspx)只需通过调用和告诉 Windows 您不再需要第一个字节[`FSCTL_SET_ZERO_DATA`](http://msdn.microsoft.com/en-us/library/aa364597%28VS.85%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T12:53:44.607

如果您可以在重新初始化之间生成几 GB 的日志文件，那么似乎仅在初始化时截断文件并没有真正的帮助。

我认为我会尝试提出一种专门的文本文件格式，以便始终将内容替换到位，并带有指向“当前”行的指针。您将需要一个恒定的线宽来仅分配一次磁盘空间，并将指针放在该文件的第一行或最后一行。

这样，文件将永远不会增长或缩小，并且您将始终拥有最后*N*个条目。

*N* = 6的插图（“|”表示空格填充直到那里）：

```
#myapp 日志文件，行 = 6，宽度 = 80，指针 = 4 |
[2008-12-01 15:23] foo烤蛋糕|
[2008-12-01 16:15] foo 烤好了蛋糕 |
[2008-12-01 16:16] foo 吃蛋糕 |
[2008-12-01 16:17] foo告诉bar：我给你做了蛋糕，但是我吃过了|
[2008-12-01 13:53] 酒吧想点蛋糕|
[2008-12-01 14:42] bar告诉foo：sudo给我烤个蛋糕|
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T17:28:56.750

另一种解决方案是让日志记录类检测日志文件大小何时超过 500k，并打开一个新的日志文件，然后关闭旧的。

然后日志记录类会查看旧文件，并删除最旧的文件

记录器将有两个配置参数。

1.  500k 用于何时开始新日志的阈值
2.  要保留的旧日志的数量。

这样，日志文件管理将是一个自我维护的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T00:31:13.497

我认为这与计算机无关，而是你们如何编写日志类。您将最后 500k 读入字符串对我来说听起来很奇怪，您为什么要这样做？

只需附加到日志文件。

```
 fstream myfile;
  myfile.open("test.txt",ios::app); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-06T00:40:33.947

[Widefinder 2 有很多关于可用的高效 IO 的讨论](http://wikis.sun.com/display/WideFinder/Results)（或者更准确地说，“注释”列下的链接有很多关于可用的高效 IO 的信息）。

回答你的问题：

1.  （标题）使用 [标准库] 从文件中删除前 500,000 个字节

标准库在文件系统操作方面有些限制。如果您不限于标准库，您可以很容易地过早结束一个文件（也就是说，说“此点之后的所有内容都不再是该文件的一部分”），但很难晚启动一个文件（“所有内容在此之前不再是该文件的一部分”）。

简单地在文件中寻找 500,000 字节然后开始缓冲副本到新文件会很有效。但是一旦你这样做了，标准库就没有现成的“重命名这个文件”功能。本机操作系统函数可以有效地重命名文件，Boost.Filesystem 或 STLSoft 也可以。

2.  （实际问题）我们的日志记录类，在初始化时，在文件结束前寻找 500,000 个字节，将其余部分复制到 a`std::string`然后将其写回文件。

在这种情况下，您将删除文件的最后一位，并且在标准库之外很容易做到这一点。只需使用文件系统操作将文件大小设置为 500,000 字节（例如[`ftruncate`](http://pubs.opengroup.org/onlinepubs/007908799/xsh/ftruncate.html), [`SetEndOfFile`](https://msdn.microsoft.com/en-us/library/windows/desktop/aa365531.aspx)）。之后的任何内容都将被忽略。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-06T00:40:57.003

所以你想要文件的结尾——你把它复制到某种缓冲区来做什么？你是什​​么意思'写回'到文件中。您的意思是它会覆盖文件，在初始化时将其截断为原始文件的 500k 字节+它添加的内容？

建议：

*   重新考虑你在做什么。如果这行得通并且是所期望的，那么它有什么问题？为什么要改变？有性能问题吗？您是否开始想知道所有日志条目都去了哪里？对于此类问题，提供比发布现有行为更多的问题最有帮助。除非他们知道完整的问题，否则没有人可以对此发表完全评论——因为它是主观的。

*   如果是我并且我的任务是重新设计您的日志记录机制，我会建立一种机制来将日志文件切断为：时间长度或大小。

# php - PHP 文件上传...文件消失在巨大的空白中......没有人能听到它们的尖叫声

> ID：345617
> 
> 赞同：1
> 
> 时间：2008-12-06T00:26:31.180
> 
> 标签：php, upload

我正在运行 Ubuntu8.041。Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.3 配置了 Suhosin-Patch

根本无法上传文件。已经在 Ubuntu 盒子上进行了本地测试......以及我的 Vista 盒子。Ubuntu 在 Vista 盒子上的 VMWare 中运行。

这是uploadTestBrowse.php

```
<?php
?>
<form enctype="multipart/form-data" action="uploadTestBrowse.php" method="post">
<input type="hidden" name="MAX_FILE_SIZE" value="1000000" />
<input type="file" name="fileName" /> <br><br>
<input type="submit" value="Upload Images"/> 
</form> 
```

这是uploadTestSubmit.php

```
<?php
error_reporting(E_ALL|E_STRICT);  

$uploaddir = "var/www/ig/images/";
$uploadfile = $uploaddir . basename($_FILES['userfile']['name']);

if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {
    echo "Success.\n";
} else {
    echo "Failure.\n";
}

echo 'Here is some more debugging info:';
print_r($_FILES);
?> 
```

这是uploadTestSubmit.php的输出

> 注意：未定义索引：第 5 行 /var/www/ig/admin/uploadTestSubmit.php 中的用户文件
> 
> 注意：未定义的索引：/var/www/ig/admin/uploadTestSubmit.php 中的用户文件第 7 行失败。这是更多调试信息：Array ( [fileName] => Array ( [name] => aq.jpg [type] => image/pjpeg [tmp_name] => /tmpUpload/phpMBwMi9 [error] => 0 [size] => 10543))

php.ini file_uploads = on upload_max_filesize = 2M upload_tmp_dir = /tmpUpload

我已经 chmod -R 777 tmpUpload

我在 tmpUpload 中永远看不到任何文件

Apache2 错误日志没有显示任何内容

Apache2 访问日志显示：192.168.21.1 - - [06/Dec/2008:13:13:09 +1300] "GET /ig/admin/uploadTestBrowse.php?=PHPE9568F35-D428-11d2-A769-00AA001ACF42 HTTP/1.1" 200 2146 " [http://192.168.21.128/ig/admin/uploadTestBrowse.php](http://192.168.21.128/ig/admin/uploadTestBrowse.php) " "Mozilla/4.0（兼容；MSIE 7.0；Windows NT 6.0；SLCC1；.NET CLR 2.0.50727；Media Center PC 5.0；.NET CLR 3.5.21022；.NET CLR 1.1.4322；.NET CLR 3.5.30729；.NET CLR 3.0.30618)"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T00:32:59.703

这可能不是您问题的答案，但我注意到您缺少 var/www/... 前面的 /

它应该是：“/var/www/ig/images/”

我的第一个建议是改变它并再试一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T00:36:01.910

您的 uploadTestBrowse.php 和 uploadTestSubmit.php 不匹配。`action`和上传字段中的不同名称。

# java - 如何避免使用异常进行流控制？

> ID：345626
> 
> 赞同：9
> 
> 时间：2008-12-06T00:34:28.840
> 
> 标签：java, exception, return-type, control-flow

我被分配了一个项目来开发一组充当存储系统接口的类。要求是该类支持具有以下签名的 get 方法：

```
public CustomObject get(String key, Date ifModifiedSince) 
```

基本上，该方法应该返回`CustomObject`与`key`if 关联的且仅当对象在 之后被修改时`ifModifiedSince`。如果存储系统不包含，`key`则该方法应返回 null。

我的问题是这样的：

**如何处理密钥存在但对象未修改的**情况**？**

这很重要，因为使用此类的一些应用程序将是 Web 服务和 Web 应用程序。这些应用程序需要知道是返回 404（未找到）、304（未修改）还是 200（好的，这是数据）。

我正在权衡的解决方案是：

1.  当存储系统不包含 `key`
2.  失败时抛出自定义异常 `ifModifiedSince`。
3.  将状态属性添加到 CustomObject。要求调用者检查属性。

我对这三个选项中的任何一个都不满意。我不喜欢选项 1 和 2，因为我不喜欢使用异常进行流控制。当我的意图是表明**没有值时，我也不喜欢返回值**。

尽管如此，我倾向于选项3。

有没有我不考虑的选项？有没有人对这三个选项中的任何一个有强烈的感觉？

* * *

**这个问题的答案，意译：**

1.  提供一个`contains` 方法并要求调用者在调用之前调用它`get(key, ifModifiedSince)`，如果key不存在则抛出异常，如果object没有被修改则返回null。
2.  将响应和数据（如果有）包装在复合对象中。
3.  使用预定义的常量来表示某种状态 ( `UNMODIFIED, KEY_DOES_NOT_EXIST`)。
4.  调用者实现了用作回调的接口。
5.  设计很烂。

* * *

**为什么我不能选择答案#1**

我同意这是理想的解决方案，但我已经（不情愿地）驳回了它。这种方法的问题在于，在使用这些类的大多数情况下，后端存储系统将是第三方远程系统，如 Amazon S3。这意味着一种`contains`方法将需要到存储系统的往返行程，在大多数情况下，这之后会进行另一次往返行程。因为这**会花费时间和金钱**，所以这不是一种选择。

**如果没有这种限制，这将是最好的方法。**

（我意识到我没有在问题中提到这个重要元素，但我试图保持简短。显然它是相关的。）

* * *

**结论：**

在阅读了所有答案后，我得出结论，在这种情况下，包装器是最好的方法。本质上，我将模仿 HTTP，使用元数据（标头）包括响应代码和内容主体（消息）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T01:34:17.817

听起来您实际上想要返回两项：响应代码和找到的对象。您可能会考虑创建一个轻量级包装器，将它们保存在一起并将它们一起返回。

```
public class Pair<K,V>{
  public K first;
  public V second;
} 
```

然后您可以创建一个新的 Pair 来保存您的响应代码和数据。作为使用泛型的副作用，您可以将这个包装器重用于您实际需要的任何对。

另外，如果数据还没有过期，你仍然可以返回它，但是给它一个 303 代码，让他们知道它没有改变。4xx 系列将与`null`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-06T01:08:46.527

根据给定的要求，您不能这样做。

*如果您设计了合约*，则添加一个条件并让调用者调用

```
exists(key): bool 
```

服务实现如下所示：

```
if (exists(key)) {
    CustomObject o = get(key, ifModifiedSince);
    if (o == null) { 
      setResponseCode(302);
    } else {
      setResponseCode(200);
      push(o);
   }

} else {
      setResponseCode(400);
} 
```

客户端保持不变，并且永远不会注意到您已经预先验证。

*如果您没有设计合同*可能有一个很好的理由，或者可能只是设计师（或建筑师）的错。但既然你不能改变它，那么你也不必担心。

然后你应该遵守规范并像这样进行：

```
 CustomObject o = get(key, ifModifiedSince);

 if (o != null) {
     setResponseCode(200);
     push(o);
  } else {
     setResponseCode(404); // either not found or not modified.
  } 
```

好的，在这种情况下，您不会发送 302，但可能这就是它的设计方式。

我的意思是，出于安全原因，服务器不应返回更多信息*[探针是 get(key, date) 仅返回 null 或 object ]*

所以不用担心。和你的经理谈谈，让他知道这个决定。也用这个决定评论代码。如果你手头有建筑师确认这个奇怪限制背后的基本原理。

他们很有可能您没有看到这一点，他们可以根据您的建议修改合同。

有时，在想要正确进行的同时，我们可能会错误地进行并危及我们应用程序的安全性。

与您的团队沟通。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T00:37:55.917

您可以创建一个特殊的最终 CustomObject 作为“标记”以指示未更改：

```
static public final CustomObject UNCHANGED=new CustomObject(); 
```

并使用“==”而不是 .equals() 来测试匹配。

它也可以在未更改的情况下返回 null 并在不存在的情况下引发异常？如果我必须选择您的 3 个中的一个，我会选择 1，因为这似乎是最特殊的情况。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-06T00:39:15.413

寻找一个不存在的对象对我来说似乎是个例外。再加上一个允许调用者确定对象是否存在的方法，我认为当它不存在时抛出异常是可以的。

```
public bool exists( String key ) { ... } 
```

来电者可以这样做：

```
if (exists(key)) {
   CustomObject modified = get(key,DateTime.Today.AddDays(-1));
   if (modified != null) { ... }
}

or

try {
    CustomObject modified = get(key,DateTime.Today.AddDays(-1));
}
catch (NotFoundException) { ... } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-06T00:45:56.697

异常的问题在于它们是为了表示由于异常 *和异常*行为而导致的“快速失败”场景（即，如果不处理，异常将***停止应用程序）。***

 *我不认为“密钥存在但对象没有被修改的场景”是异常的，当然也不是异常的。

因此我不会使用异常，而是我会记录调用者需要执行的操作以正确解释结果（属性或特殊对象）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-06T01:02:59.250

该方法签名的要求有多严格？

好像您正在处理一个仍在进行中的项目。如果你的类的消费者是其他开发者，你能说服他们他们要求的方法签名是不够的吗？也许他们还没有意识到应该有两种独特的失败模式（key 不存在并且 object 没有被修改）。

如果可以的话，我会和你的主管讨论。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-06T01:10:43.200

我仍然会返回 null。

该属性的目的是返回在指定日期之后修改的对象。如果没有对象返回 null 是可以的，那么肯定为未修改的对象返回 null 也是可以的。

我个人会为未修改的对象返回 null，并为不存在的对象抛出异常。这似乎更自然。

顺便说一句，您不使用异常进行流量控制是完全正确的，所以如果您只有这 3 个选项，那么您的直觉是正确的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-06T01:10:48.457

您可以遵循 .Net 库模式，并在名为**CustomObject.Empty的自定义对象中拥有一个公共静态只读字段，该字段属于****CustomObject**类型（如 string.Empty 和 Guid.Empty）。如果对象没有被修改，您可以返回它（函数使用者需要与它进行比较）。
**编辑：*我只是发现你正在使用 Java，但原则仍然适用***

这为您提供了以下选项

*   如果键不存在，则返回 null。

*   如果键存在但对象未被修改，则返回**CustomObject.Empty 。**

缺点是消费者需要知道 null 返回值和 CustomObject.Empty 返回值之间的区别。

也许该属性更恰当地称为**CustomObject.NotModified**，因为 Empty 确实适用于 Value 类型，因为它们不能为空。NotModified 还**可以**更容易地向消费者传达该字段的含义。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-06T02:10:43.030

关于需求的（预期的）界面被严重破坏。你试图用一种方法做不相关的事情。这是通往软件地狱的道路。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-08T04:34:33.940

提供一个 Callback 作为参数，其中 Callback 类可以是事件驱动的，也可以是 setter 驱动的。

如果需要，您可以让类的接口定义可能发生的各种错误，并将 CustomObject 作为事件的参数传递。

```
public interface Callback {
  public void keyDoesNotExist();
  public void notModified(CustomObject c);
  public void isNewlyModified(CustomObject c);
  .
  .
  .
} 
```

通过这种方式，您允许回调接口的实现者定义事件发生时要做什么，并且您可以通过接口选择该条件是否需要传递检索到的对象。最后，它降低了返回逻辑的复杂性。你的方法会这样做一次。API 的实现者根本不需要这样做，因为它已经为他们完成了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-06T00:45:05.043

如果可以接受，您可以返回一个放大的 CustomObject（包装器），其中包含表示对象及其修改状态（如果有）等的值。

# parsing - 使用循环执行文本文件

> ID：345632
> 
> 赞同：0
> 
> 时间：2008-12-06T00:38:09.613
> 
> 标签：parsing, text, shell

我已将一些有价值的信息重定向到一个文本文件中。如何循环执行该文本文件的每一行？

我的想法是将我的文本文件加倍空间，然后使用循环单独执行每一行。我希望当我将文本文件加倍空间时，每个命令字符串都有自己的行。

例如，这个文本文件：

> 猫 /etc/passwd | 头-101 | 尾 -3 nl /etc/passwd | 头-15 | cut -d':' -f1 cat /etc/passwd | 剪切 -d':' -f1,5 | tee users.txt nl /etc/passwd | 尾-1 | 剪切-f1 ls ~/home | 荷兰 | 尾-1 | 剪切-f1 ls -lR / 2>/dev/null | 排序 -n -r +4 | 头-1

当我把它加倍时应该是这样的：

> 猫 /etc/passwd | 头-101 | 尾 -3
> nl /etc/passwd | 头-15 | cut -d':' -f1
> cat /etc/passwd | 剪切 -d':' -f1,5 | tee users.txt
> nl /etc/passwd | 尾-1 | 剪切-f1
> ls ~/home | 荷兰 | 尾-1 | 剪切-f1 ls -lR / 2>/dev/null | 排序 -n -r +4 | 头-1

然后我会使用一个循环来执行每一行。

这是我的脚本：

```
FILE="$1"

echo "You Entered $FILE"

if [ -f $FILE ]; then

tmp=$(cat $FILE | sed '/./!d' | sed -n '/regex/,/regex/{/regex/d;p}'| sed -n '/---/,+2!p' | sed -n '/#/!p' | sed 's/^[ ]*//' | sed -e\
s/[^:]*:// | sed -n '/==> /!p' | sed -n '/--> /!p' | sed -n '/"lab3.cmd"/,+1!p'\
 | sed -n '/======/!p' | sed -n '/regex/!p' | sed -n '/commands are fun/\
!p' | sed -n '/regex/!p')

fi

MyVar=$(echo $tmp > hi.txt)
echo "$MyVar"
```

这是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T00:43:17.763

为什么不只用行分隔符分隔命令？除非您的命令必须能够包含行分隔符，否则您不需要空行来分隔它们 - 如果它需要连续包含 2 个呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T01:46:57.073

恐怕我不明白您要解决的问题。如果您将命令写入一个名为 commands.txt 的文件中，您可以简单地执行它们

```
sh commands.txt 
```

执行文件的每一行。如果您想循环执行此操作，我想您可以尝试类似

```
for i in *; do FILE="$i" sh commands.txt; done 
```

也许您可以编辑您的问题以使其更加具体？

# php - PHP：一个 mysql_query 语句中的多个 SQL 查询

> ID：345637
> 
> 赞同：9
> 
> 时间：2008-12-06T00:41:20.513
> 
> 标签：php, sql, mysql

所以我有一个需要使用 mysql_query() 加载的 SQL 转储文件。不幸的是，不可能用它执行多个查询。

-> 不能假设安装了**mysql命令行客户端**（mysql --help）——直接加载SQL文件

-> 不能假设安装了**mysqli**扩展

```
/* contents of dump.sql, including comments */
DELETE FROM t3 WHERE body = 'some text; with semicolons; scattered; throughout';
DELETE FROM t2 WHERE name = 'hello';
DELETE FROM t1 WHERE id = 1; 
```

下面的 explode() 将不起作用，因为某些转储内容的值包含分号。

```
$sql = explode(';', file_get_contents('dump.sql'));
foreach ($sql as $key => $val) {
    mysql_query($val);
} 
```

在不修改转储文件的情况下加载 SQL 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-06T01:34:46.490

您有更多的问题案例，而不仅仅是字符串中的分号。

*   脚本无法执行的[内置](http://dev.mysql.com/doc/refman/5.1/en/mysql-commands.html)`mysql_query()`命令，例如`USE`.
*   不以分号结尾的语句，例如[`DELIMITER`](http://dev.mysql.com/doc/refman/5.1/en/stored-programs-defining.html).
*   包含分号但不在引号内的语句，例如`CREATE PROCEDURE`.

我不知道有一种简单的方法来处理这个任务，而不需要使用 mysql 命令行客户端。我意识到您说过您不能依赖该客户端的存在，但是如果没有该客户端，您需要大量的 PHP 代码来解析脚本并适当地执行语句。

您可以在[phpMyAdmin](http://www.phpmyadmin.net/home_page/index.php)产品中找到此类代码。但是，该产品是根据 GPL 许可的，因此如果您使用任何代码，您还必须根据 GPL 许可您自己的项目。

* * *

另请参阅我对这些相关问题的回答：

*   [在 PHP 中运行 MySQL *.sql 文件](https://stackoverflow.com/questions/4027769/running-mysql-sql-files-in-php/4028289#4028289)
*   [从 PHP 中加载 .sql 文件](https://stackoverflow.com/questions/147821/loading-sql-files-from-within-php/149456#149456)
*   [是否可以从另一个 sql 脚本中的存储过程调用 sql 脚本？](https://stackoverflow.com/questions/547915/is-it-possible-to-call-a-sql-script-from-a-stored-procedure-in-another-sql-script/548119#548119)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-06T01:47:46.150

奥卡姆剃刀又来了。

上面的 explode() 函数不起作用，因为值中有分号。然而，我没有意识到（并提到）的是分号总是在 SQL 转储文件中的换行符之前。唉，

```
$sql = explode(";\n", file_get_contents('dump.sql'));
foreach ($sql as $key => $val) {
    mysql_query($val);
} 
```

另外，感谢您的帮助，比尔。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T16:30:49.863

这里有一个更大的问题。您可能有依赖于其他语句的语句。你不能只是盲目地线性执行它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T14:04:52.113

```
<?php
//STATIC QUERY
$sql1 = "
CREATE TABLE tblTable (
strOne VARCHAR(50) NOT NULL,
strTwo VARCHAR(50) NOT NULL,
strThree VARCHAR(50) NOT NULL
);
INSERT INTO tblTable
(strOne, strTwo, strThree)
VALUES ('String 1', 'String 2', 'String 3');
UPDATE tblTable
SET
strOne = 'String One',
strTwo = 'String Two'
WHERE strThree = 'String 3';
"; 
//GET FROM FILE
$sql2 = file_get_contents('dump.sql');
$queries = preg_split("/;+(?=([^'|^\\\']*['|\\\'][^'|^\\\']*['|\\\'])*[^'|^\\\']*[^'|^\\\']$)/", $sql);
foreach ($queries as $query){
   if (strlen(trim($query)) > 0) mysql_query($query);
}
?> 
```

# mysql - 使用 SSH 的 Aptana Studio MySQL 连接字符串

> ID：345638
> 
> 赞同：0
> 
> 时间：2008-12-06T00:42:49.837
> 
> 标签：mysql, ssh, aptana

我想使用 Aptana Studio 的 SSH 连接到 MySQL 数据库，有人知道连接字符串应该是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T14:28:05.693

试试这个帖子： http: [//mysqlbarbeque.blogspot.com/2008/12/ssh-tunneling-between-databases-with.html](http://mysqlbarbeque.blogspot.com/2008/12/ssh-tunneling-between-databases-with.html)

# .net - .NET 中的 DVD 菜单创建

> ID：345652
> 
> 赞同：0
> 
> 时间：2008-12-06T00:53:15.527
> 
> 标签：.net, dvd

有谁知道 .NET 的一个很好的组件，它可以让我为 DVD 创建菜单和 .iso？对于每张 DVD，我都有几个想要自动转换成 DVD 的视频文件和照片。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T18:17:32.160

YMMV，但是您不太可能找到可以执行此操作的插入式组件。DVD 创作是一项非常复杂的任务，通常仅在支持端到端整个过程的完整软件包中实现。

也就是说，有一些 OSS 项目可以进行 DVD 创作（例如，dvdauthor、DVDStyler 等），您可以将它们合并到您的项目中，当然要遵守它们各自的许可证。我不知道有任何 .NET 文件，这些的重点通常是实际进行创作，而不是公开 API，但其中很多确实使用 XML（或类似）文件来描述菜单等，所以您可能能够从 .NET 生成这些，然后将它们交给他们来完成工作。但是，这与您自己不做大量工作可能会得到的结果差不多。

另一种选择是找到带有脚本或自动化引擎的商业包，尽管这些往往是非常昂贵的高端包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T17:50:42.273

[RocketDVD Professional](http://www.dmapp.com/index.php?option=com_products&task=view&cid=15&Itemid=43)可能是我正在寻找的。

# c# - c# windows-services - 如何处理日志记录异常？

> ID：345656
> 
> 赞同：2
> 
> 时间：2008-12-06T00:55:06.693
> 
> 标签：c#, exception, logging, windows-services, decorator

我正在创建一个 Windows 服务。当发生异常时，我会适当地处理它并创建一个日志。我正在使用[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)，因为人们查看这些日志的方式有很多种。我有一个电子邮件记录器、一个文件记录器和一个 Windows 事件记录器，它们都继承自实现 ILogger 的 LoggingDecorator。因此，没有记录器知道任何其他记录器。

我的问题是：我应该如何处理日志记录异常？

如果写入文件失败或发送电子邮件失败，我该怎么办？我想用其他记录器记录初始日志内容，但是如何处理记录异常？它不也取决于构造函数中记录器的顺序吗？

现在，我只是用空的 catch(Exception) 语句包装 try/catch 块，这感觉很脏，让 FxCop 对我大喊大叫。然而，这是那些[“取决于”](https://stackoverflow.com/questions/21938/is-it-really-that-bad-to-catch-a-general-exception)的时刻之一吗？

```
[Flags]
public enum LoggingCategories
{
    None = 0,
    ServiceEvents = 1, 
    ProcessingInformation = 2,
    ProcessingErrors = 4,
    UnexpectedErrors = 8
}

public interface ILogger
{
    void LogMessage(LoggingCategories category, string message);
}

public abstract class LoggerDecorator : ILogger
{
    private ILogger _decoratedLogger;
    private LoggingCategories _categories;

    protected LoggerDecorator(ILogger logger, LoggingCategories categories)
    {
        this._decoratedLogger = logger;
        this._categories = categories;
    }

    protected bool ShouldLogCategory(LoggingCategories category)
    {
        return ((this._categories & category) == category);
    }

    public virtual void LogMessage(LoggingCategories category, string message)
    {
        _decoratedLogger.LogMessage(category, message);
    }

}

public class ControlLogger : ILogger
{
    public ControlLogger()
    {
    }

    public void LogMessage(LoggingCategories category, string message)
    {
        Console.WriteLine(LoggingHelper.ConstructLog(category, message));
    }
} 
```

（WindowsEventLogger 中有问题的代码）

```
try
{
    this._eventLog.WriteEntry(log, type);
}
catch (Exception)
{
    //Even if this logging fails, we do not want to halt any further logging/processing.
} 
```

（服务构造函数中的代码）

```
ILogger controlLogger = new ControlLogger();
ILogger windowsEventLogger = new WindowsEventLogger(controlLogger, windowsEventLogCategories, windowsEventLogSource);
ILogger emailLogger = new EmailLogger(windowsEventLogger, emailCategories, emailSubject, emailAddresses);
ILogger fileLogger = new FileLogger(emailLogger, fileCategories, logDirectory, logFileNamePrefix, logFileExtension);

this._logger = fileLogger; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T01:02:55.897

如果记录器失败，为什么不把它放在实际的 Windows 事件日志中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T01:52:50.507

这不是一个答案，但很好奇您为什么选择不使用现有的 System.Diagnostics.Trace 方法。您可以在它上面实现某种类型的日志类型分类吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T01:36:45.720

在您认为非常可靠的性能良好的机器上创建单独的 ping 服务。如果您的主要服务失败，那么 ping 也会失败，并且控制服务应该向您发送带有警告的电子邮件。

# javascript - 创建后与 jQuery 插件对象交互

> ID：345680
> 
> 赞同：2
> 
> 时间：2008-12-06T01:14:00.680
> 
> 标签：javascript, jquery

我有一个代码，哪些项目使用轮询更新。我为ticker编写了一个简单的jQuery插件，调用方式如下：

```
$("#cont ul").ticker(); 
```

它将一个 ul 变成一个股票代码，在 li 中滚动。要添加新项目，我必须将 lis 添加到 ul，这很好。但是，我的 OO 希望我可以在代码对象上添加一个 addItem 函数。但是，我不想失去 jQuery 使用的可链接性。

有没有比将 ul 添加到列表中更明显但适合 jQuery 做事方式的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T02:28:52.277

您应该做的是扩展插件的设置：

```
jQuery.ticker = function(settings)
{
var settings = 
jQuery.extend(
{
action : 'create',
item : $(this)
}
,settings);

return $(this).each(function(){
if(settings.action =='create')
{
  //initialize ticker..
}
else if(settings.action == 'add')
{
  //add to ticker.
}
}//end each.
}//end plugin.

$('#ticker').ticker(); //this will initialize it, no problem.

var settings1 = { action : 'add', item : $(expr1) }
$('#ticker').ticker(settings1);//this will execute the "add" action. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T02:21:32.353

jQuery 并不是真正的 OO 解决方案，所以你说它不是真正的“jQuery 方式”是正确的。我听说 Prototype 完全是关于 OO 的，所以有一天你可能想研究一下。

不过，没有理由不能向 jQuery 对象添加另一个函数：

```
$.fn.addTickerItem = function(contents) {
    this.append(
        $("<li></li>").html(contents);
    );
    return this;
}; 
```

..但你会慢慢污染命名空间。

# svn - SVN 在现有存储库上创建主干目录

> ID：345683
> 
> 赞同：46
> 
> 时间：2008-12-06T01:17:36.930
> 
> 标签：svn

我正在处理一个没有主干/分支/标签目录结构的项目 - 即。一切都在 svn repo 的根目录中。

我想在根目录中创建一个主干目录，并将根目录中的所有内容移动到新的主干目录中。

做这个的最好方式是什么？

我考虑的第一件事是

```
svn mkdir trunk
(for each file or directory that is not called trunk: )
svn mv FILEorDIR trunk/ 
```

但这有效地删除了每个文件，然后再次添加。有没有更好的办法？

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-12-02T06:12:41.387

在浏览了几个不同的页面（包括这一页）后，我遇到了完全相同的问题并解决了它。这是我的解决方案：

**注意：**在开始之前，如果您打算使用`svn switch`保留工作副本并避免再次签出 repo，最好确保您的工作副本是最新的并且没有未提交的更改。

继续解决...

```
//REPO_URL = The URL for the repo on the SVN server.
//In my case it was https://IP_ADDRESS:PORT/svn/my_repo

//Make the trunk dir in the root of your SVN repo
svn mkdir REPO_URL/trunk -m "making trunk dir"

//Move everything from your root dir to your new trunk dir
svn move REPO_URL/A_FOLDER REPO_URL/trunk/A_FOLDER -m "moving folders to trunk"
svn move REPO_URL/ANOTHER_FOLDER REPO_URL/trunk/ANOTHER_FOLDER -m "blah"
svn move REPO_URL/A_FILE.TXT REPO_URL/trunk/A_FILE.TXT -m "moving files to trunk"
//Keep going until you've moved everything from your root dir to the trunk dir... 
```

所以现在，在您的 SVN 服务器上，所有内容都在主干文件夹中。甜的！

但是我的仓库是 60GB 并且在远程服务器上。我宁愿不再检查。`svn switch`将让您将现有工作副本指向新`trunk`目录，以便您可以继续使用您拥有的副本。进入工作副本的根文件夹并运行`svn switch REPO_URL/trunk --ignore-ancestry`. 将所有文件从根目录移动到主干目录后，它应该会说明修订版在`At revision X`哪里。`X`就是这样！也许做一个 SVN 更新以获得良好的衡量标准:)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-06T01:26:34.227

这与我过去的做法类似。您的解决方案实际上*复制*了每个文件，然后删除了原始文件。由于 Subversion 实现副本的方式，每个文件的历史都会被保留。

完成此操作后，您可以使用 .将现有结账点指向新位置`svn switch`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-08T15:12:04.593

如果您正在使用 Eclipse IDE 和 Subclipse for SVN，那么您可以继续在 SVN 中创建文件夹并将所有文件/目录从根目录移动到主干目录，然后将 ProjectName/trunk 签出到您的 Eclipse 工作区...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-19T18:08:39.537

旧帖子，但我也有同样的问题，我的所有回购都在根目录中而不是在树干中。这在尝试简单`git svn clone`命令时会出现问题。经过数小时的反复试验，这很简单：

`git svn clone --username byname http://www.MySVNserver.com:81/repos/project1 --no-metadata --trunk=.`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-03-31T07:53:31.377

我自己做了几次并学到了这一点：如果您想保留以前的 SVN 根目录的历史记录 + 保留所有 SVN 属性（如*忽略*），您必须按照以下方式进行。注意：我用 TortoiseSVN 完成了这一切，因为这种方式非常简单。但是您也可能在命令行上取得了成功。您还可以在下面找到使用 CLI 执行此操作的说明。

不要忘记在每个操作中添加适当的 SVN 消息，这样您以后就可以清楚地知道已经完成了什么。

示例仓库：*/svn/my_project*

**TortoiseSVN**的步骤：

1.  *将当前项目目录*重命名*`/svn/my_project`为trunk`/svn/trunk`*
**   *创建*一个新目录`/svn/my_project`*   *移至* `/svn/trunk`_`/svn/my_project`*   *将工作副本*切换到新路径。*选中复选框“Ingore 祖先”。***   放松**

 ****CLI**的步骤（未经测试！）：

1.  *将*目录复制到新目录`/svn/trunk/`
2.  *删除*旧目录`/svn/my_project/`
3.  *将*目录复制到`/svn/trunk/`新目录`/svn/my_project/trunk`
4.  *删除*`/svn/trunk/`目录_
5.  *将工作副本*切换到新目录**

 ** * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T01:22:53.783

您可能需要查看 svnadmin 工具。

*   [http://svnbook.red-bean.com/en/1.0/ch09s02.html](http://svnbook.red-bean.com/en/1.0/ch09s02.html)

老实说，我以前没有尝试过，你可能会从有过的人那里得到答案，但你可以这样工作：

*   [http://www.digitalmediaminute.com/article/2251/how-to-move-a-subversion-repository](http://www.digitalmediaminute.com/article/2251/how-to-move-a-subversion-repository)

您应该能够初始化一个新的存储库，在其中创建一个“主干”目录，然后将以前的存储库转储到“主干”中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-03T17:51:49.873

这里给出使用svn+ssh方法在unix终端的svn根目录下创建trunk文件夹的方法。“projectname”是在 svn 中创建项目时的根“标识符”：

```
svn mkdir svn+ssh://username@host/projectname/trunk -m "Create the trunk folder" 
```

# oop - 糟糕的面向对象设计有哪些明显的迹象？

> ID：345698
> 
> 赞同：33
> 
> 时间：2008-12-06T01:27:47.657
> 
> 标签：oop

在设计一个新系统或了解其他人的代码时，有哪些迹象表明设计阶段出现了问题？在类图和继承层次结构上，甚至在代码本身中是否有寻找设计大修的线索，尤其是在项目的早期？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-12-06T01:33:21.313

对我来说最突出的是“[代码味道](http://www.soberit.hut.fi/mmantyla/BadCodeSmellsTaxonomy.htm)”。

大多数情况下，我对违背“良好做法”的事情很敏感。

像：

*   执行与您从名称中所想的不同的事情的方法（例如： FileExists() 静默删除零字节文件）

*   一些非常长的方法（过程周围的对象包装器的标志）

*   在同一个枚举成员上重复使用 switch/case 语句（需要提取的子类的符号）

*   许多用于处理的成员变量，而不是用于捕获状态（可能表明需要提取方法对象）

*   一个有很多职责的类（违反单一责任原则）

*   成员访问的长链（this.that 很好，this.that.theOther 很好，但是 my.very.long.chain.of.member.accesses.for.a.result 很脆弱）

*   类命名不当

*   在狭小的空间内使用过多的设计模式

*   工作太辛苦（重写框架中已经存在的函数，或者同一个项目的其他地方）

*   拼写错误（任何地方）和语法错误（在评论中），或者仅仅是误导性的评论

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-06T02:04:28.050

我想说糟糕的面向对象设计的第一条规则（是的，我已经犯了太多次了！）是：

*   违反**单一职责原则 (SRP** ) 并执行过多操作的类

其次是：

*   太多的继承而不是组合，即纯粹从子类型派生的类，因此它们可以免费获得功能。 **偏好组合胜于继承**。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-12-06T01:52:37.153

无法正确进行单元测试。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-12-10T19:58:51.127

[**反模式**](http://en.wikipedia.org/wiki/Anti-pattern)

**软件设计反模式**

*   抽象反转：不公开用户所需的已实现功能，以便他们使用更高级别的功能重新实现它
*   模棱两可的观点：呈现一个模型（通常是 OOAD）而不指定它的观点
*   大泥球：没有可识别结构的系统
*   Blob：从面向对象设计中泛化上帝对象
*   煤气厂：不必要的复杂设计
*   Input kludge：未能指定和实现对可能无效输入的处理
*   接口臃肿：让接口功能强大到极难实现
*   魔术按钮：直接在接口代码中编写实现逻辑，而不使用抽象。
*   种族危险：看不到不同顺序的事件的后果
*   Railroaded 解决方案：一种建议的解决方案，虽然很差，但由于设计的其他领域缺乏远见和不灵活，是唯一可用的解决方案
*   重新耦合：引入不必要的对象依赖
*   烟囱系统：几乎无法维护的不良相关组件组合
*   Staralized 架构：包含用于规范化和数据集市的双重用途表的数据库架构

**面向对象的设计反模式**

*   Anemic Domain Model：使用没有任何业务逻辑的领域模型，它不是 OOP，因为每个对象都应该有属性和行为
*   BaseBean：从实用程序类继承功能而不是委托给它
*   调用超：要求子类调用超类的覆盖方法
*   圆椭圆问题：根据值子类型对变量类型进行子类型化
*   空子类失败：创建一个未通过“空子类测试”的类，其行为与从它派生的类不同而无需修改
*   上帝对象：将太多的功能集中在设计的单个部分（类）
*   对象污水池：重用其状态不符合（可能是隐含的）重用合同的对象
*   对象狂欢：未能正确封装允许不受限制地访问其内部的对象
*   Poltergeists：唯一目的是将信息传递给另一个对象的对象
*   顺序耦合：要求按特定顺序调用其方法的类
*   Singletonitis：过度使用单例模式
*   另一个无用的层：向程序、库或框架添加不必要的层。这在第一本关于编程模式的书之后变得流行起来。
*   Yo-yo 问题：由于过度碎片化而难以理解的结构（例如，继承）

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-06T02:26:32.390

这个问题假设面向对象意味着好的设计。在某些情况下，另一种方法更合适。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-06T03:31:15.257

一种气味是对象具有对不属于其自然对象层次结构或域相关组合的其他对象的硬依赖/引用。

示例：假设您有一个城市模拟。如果 Person 对象具有 NearestPostOffice 属性，您可能会遇到麻烦。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-06T01:30:50.210

我讨厌看到的一件事是基类将自身向下转换为派生类。当你看到这个，你就知道你有问题。

其他示例可能是：

*   过度使用 switch 语句
*   覆盖一切的派生类

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-06T01:35:29.887

在我看来，所有 OOP 代码在足够长的时间跨度内都会退化为过程代码。

当然，如果您阅读了我最近的问题，您可能会理解我为什么有点厌倦。

OOP 的关键问题在于它并没有明确表明您的对象构造图应该独立于您的调用图。

一旦你解决了这个问题，OOP 就开始变得有意义了。问题是很少有团队意识到这种设计模式。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-06T01:31:14.607

这里有几个：

*   循环依赖
*   您拥有基类的属性 XYZ 不受保护/私有
*   你希望你的语言支持多重继承

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-06T16:54:22.153

在一个长方法中，用#region / #endregion 包围的部分 - 在我见过的几乎所有情况下，该代码都可以轻松提取到新方法中，或者需要以某种方式重构。

过于复杂的继承树，其中子类做非常不同的事情，并且彼此之间只是切线相关。

违反 DRY - 每个子类都以几乎完全相同的方式覆盖基本方法，只有很小的变化。一个例子：我最近编写了一些代码，其中每个子类都覆盖了一个基本方法，唯一的区别是类型测试（“x is ThisType”与“x is ThatType”）。我在基础中实现了一个采用泛型类型 T 的方法，然后在测试中使用它。然后每个孩子可以调用基本实现，传递它想要测试的类型。这从 8 个不同的子类中的每一个中修剪了大约 30 行代码。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-09-18T00:27:51.427

重复代码 = 做同样事情的代码……我认为根据我的经验，这是 OO 设计中可能发生的最大错误。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-11-10T14:45:36.800

对象是好的，创建大量对象是糟糕的 OO 设计。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-06T01:46:57.417

让所有对象都继承一些基本实用程序类，这样您就可以调用实用程序方法而无需键入太多代码。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-06T16:04:05.813

找一个对代码库有经验的程序员。请他们解释某事是如何运作的。

如果他们说“这个函数调用那个函数”，他们的代码就是程序化的。

如果他们说“这个类与那个类交互”，他们的代码就是 OO。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-02-06T19:31:47.243

以下是不良设计的最突出特征：

1.  刚性
2.  脆弱性
3.  不动

看看[依赖倒置原则](http://lostechies.com/gabrielschenker/2009/01/30/the-dependency-inversion-principle/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-04-22T22:56:38.537

当您不仅有 Money\Amount 类，还有 TrainerPrice 类、TablePrice 类、AddTablePriceAction 类等时。

IDE 驱动开发或自动完成开发。结合极端严格的打字是一场完美的风暴。

在这里，您可以看到很多可能的变量值变成了类名和方法名，以及一般类的无偿使用。您还将看到诸如所有基元变成对象之类的东西。所有文字作为类。作为类的函数参数。然后到处都是转换方法。您还将看到诸如包装另一个类的类将方法的子集传递给另一个类，其中仅包括它目前需要的方法。

这创造了生成几乎无限量代码的可能性，如果您有可计费的时间，这非常棒。当变量、上下文、属性和状态被展开为超显式和过于具体的类时，随着这些事情的增多，这将导致指数级的灾难。把它想象成 [a, b] x [x, y]。尝试创建一个完整的流畅界面并尽可能多地遵守设计模式可能会进一步加剧这种情况。

OOP 语言不像一些松散类型的语言那样多态。松散类型语言通常以静态分析无法处理的浅语法提供运行时多态性。

在 OOP 中，您可能会看到难以自动检测到的重复形式，可以使用映射将其转换为更动态的代码。尽管此类语言的动态性较低，但您可以通过一些额外的工作来实现动态功能。

这里的交易是您节省了数千（或数百万）行代码，同时可能会丢失 IDE 功能和静态分析。性能可以去任何一种方式。运行时多态性通常可以转换为生成的代码。然而，在某些情况下，空间是如此巨大，以至于除了运行时多态性之外的任何事情都是不可能的。

缺乏泛型的 OOP 语言以及 OOP 程序员尝试严格键入动态松散类型语言时，问题更为常见。

没有泛型会发生什么情况是你应该有 A for X = [Q, W, E] 和 Y = [R, T, Y] 你会看到 [AQR, AQT, AQY, AWR, AWT, AWY, AER, AET,艾伊]。这通常是由于害怕或使用无类型或将类型作为变量传递而失去 IDE 支持。

传统的松散类型语言是使用文本编辑器而不是 IDE 编写的，并且通过 IDE 支持失去的优势通常通过其他方式获得，例如组织和结构化代码，使其可导航。

通常 IDE 可以配置为理解您的动态代码（并链接到它），但很少有人以方便的方式正确支持它。

提示：这里的上下文是 PHP 中的 OOP 出现了可怕的错误，使用简单 OOP Java 编程的人们传统上试图将其应用于 PHP，即使有一些 OOP 支持，它也是一种根本不同类型的语言。

针对您的平台进行设计以尝试将其转变为您习惯的平台，为迎合 IDE 或其他工具而设计，为支持单元测试而设计，等等都应该敲响警钟，因为它与设计工作软件有很大的偏差解决给定类别的问题或给定的特征集。

# php - 基本php表单帮助（货币显示）

> ID：345704
> 
> 赞同：0
> 
> 时间：2008-12-06T01:31:49.863
> 
> 标签：php, forms, currency, rounding

你们昨天很有帮助。不过，我在这里仍然有点困惑。

我想让最右边一列的数字四舍五入到最接近的美元：

[http://www.nextadvisor.com/voip_services/voip_calculator.php?monthlybill=50&Submit=Submit](http://www.nextadvisor.com/voip_services/voip_calculator.php?monthlybill=50&Submit=Submit)

该表的代码如下所示：

我希望 $offer[1,2,3,4,5,6,7]calcsavingsann 被四舍五入，怎么做？

```
 <table width="100%;" border="0" cellspacing="0" cellpadding="0"class="credit_table2" >

    <tr class="credit_table2_brd">
     <td class="credit_table2_brd_lbl" width="100px;">Services:</td>
<td class="credit_table2_brd_lbl" width="120px;">Our Ratings:</td>
<td class="credit_table2_brd_lbl" width="155px;">Monthly VoIP Bill:</td>
<td class="credit_table2_brd_lbl" width="155px;">Annual Savings:</td>

   </tr>  

   <?php

 $offer1price="24.99";
 $offer2price="20.00";
 $offer3price="21.95";
 $offer4price="23.95";
 $offer5price="19.95";
 $offer6price="23.97";
 $offer7price="24.99";

 $offer1calcsavings= $monthlybill - $offer1price;
 $offer2calcsavings= $monthlybill - $offer2price;
 $offer3calcsavings= $monthlybill - $offer3price;
 $offer4calcsavings= $monthlybill - $offer4price;
 $offer5calcsavings= $monthlybill - $offer5price;
 $offer6calcsavings= $monthlybill - $offer6price;
 $offer7calcsavings= $monthlybill - $offer7price;

 $monthybill="monthlybill";

 $offer1calcsavingsann= $offer1calcsavings * 12;
 $offer2calcsavingsann= $offer2calcsavings * 12;
 $offer3calcsavingsann= $offer3calcsavings * 12;
 $offer4calcsavingsann= $offer4calcsavings * 12;
 $offer5calcsavingsann= $offer5calcsavings * 12;
 $offer6calcsavingsann= $offer6calcsavings * 12;
 $offer7calcsavingsann= $offer7calcsavings * 12;

   $re=1;
   $offer ='offer'.$re.'name';
 $offername= ${$offer};
   while($offername!=""){
$offerlo ='offer'.$re.'logo';
$offerlogo=${$offerlo};
$offerli ='offer'.$re.'link';
$offerlink=${$offerli};
$offeran ='offer'.$re.'anchor';
$offeranchor=${$offeran};
$offerst ='offer'.$re.'star1';
$offerstar=${$offerst};
$offerbot='offer'.$re.'bottomline';
$offerbottomline=${$offerbot};
$offerca ='offer'.$re.'calcsavings';
$offercalcsavings=${$offerca};
    $offerpr ='offer'.$re.'price';
$offerprice=${$offerpr};
$offersavann ='offer'.$re.'calcsavingsann';
$offercalcsavingsann=${$offersavann};

echo '<tr >
     <td >
 <a href="'.$offerlink.'" target="blank"><img src="http://www.nextadvisor.com'.$offerlogo.'" alt="'.$offername.'" />
 </a>
 </td>
<td ><span class="rating_text">Rating:</span>
 <span class="star_rating1">
 <img src="http://www.nextadvisor.com'.$offerstar.'" alt="" />
 </span>
 <br />
  <div style="margin-top:5px; color:#0000FF;">
 <a href="'.$offerlink.'" target="blank">Go to Site</a>
 <span style="margin:0px 7px 0px 7px;">|</span><a href="'.$offeranchor.'">Review</a>     

 </div> </td>
       <td >$'.$offerprice.'</td>
     <td >$'.$offercalcsavingsann.'</td>

   </tr>';
   $re=$re+1;
   $offer ='offer'.$re.'name';
 $offername= ${$offer};

   }

   ?>

 </table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T01:46:20.193

你想向上/向下/截断到最接近的美元吗？

以下是您可以使用的一些建议功能：

**四舍五入**

[圆形的](http://us.php.net/manual/en/function.round.php)

[地面](http://us.php.net/manual/en/function.floor.php)

[细胞](http://us.php.net/manual/en/function.ceil.php)

**格式化/截断**

[冲刺](http://us.php.net/manual/en/function.sprintf.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-06T12:41:19.793

Grepsedawk 的回答很好；我唯一要补充的是，例如，您可以使用[number_format](http://php.net/number_format)来输出 $336.60，而不是显示 $336.6。

（我知道这不是您的问题，但查看链接，我认为这可能对您有用。）

编辑 - 感谢安迪建议[money_format](http://php.net/money_format)代替。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T06:41:02.750

`money_format()`是一个返回格式化数字的字符串值的函数。您可以控制格式，显然还有您的号码。一个简单的例子，如果你在变量中有你的值`$myNumber`，你可以像这样将结果合并到给定表格的数据单元格中；

```
<?php echo ("<td>".money_format('%n',$myNumber)."</td>"); ?> 
```

而且您需要对每个值都执行此操作，例如，`for`如果您将所有值都放在数组中，则通过循环。这`n`是格式选项之一 - 有几个。[一个很好的查看位置是在http://au2.php.net/manual/en/function.money-format.php](http://au2.php.net/manual/en/function.money-format.php)的 PHP 网页上 希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T22:39:13.837

我似乎无法正确使用。我使用回声的方式是

```
echo '<tr >

  <td ><a href="'.$offerlink.'" target="blank"><img src="http://www.nextadvisor.com'.$offerlogo.'" alt="'.$offername.'" /></a></td>

 <td ><span class="rating_text">Rating:</span><span class="star_rating1"><img src="http://www.nextadvisor.com'.$offerstar.'" alt="" /></span><br />

  <div style="margin-top:5px; color:#0000FF;"><a href="'.$offerlink.'" target="blank">Go to Site</a><span style="margin:0px 7px 0px 7px;">|</span><a href="'.$offeranchor.'">Review</a></div>   </td>

  <td >$'.$offerprice.'</td>

<td >$'.$offercalcsavingsann.'</td>

   </tr>'; 
```

我把“设置语言环境”放在

```
 "<?php" 
```

是。我不明白如何写它，而且我所做的每一种方式都只是返回一个错误。

# hibernate - 休眠：LazyInitializationException：无法初始化代理

> ID：345705
> 
> 赞同：75
> 
> 时间：2008-12-06T01:32:28.223
> 
> 标签：hibernate, initialization, lazy-evaluation

这是让我困惑的一个。我正在尝试实现一个基本的 Hibernate DAO 结构，但是遇到了问题。

这是基本代码：

```
int startingCount = sfdao.count();
sfdao.create( sf );
SecurityFiling sf2 = sfdao.read( sf.getId() );
sfdao.delete( sf );
int endingCount = sfdao.count();

assertTrue( startingCount == endingCount );
assertTrue( sf.getId().longValue() == sf2.getId().longValue() );
assertTrue( sf.getSfSubmissionType().equals( sf2.getSfSubmissionType() ) );
assertTrue( sf.getSfTransactionNumber().equals( sf2.getSfTransactionNumber() ) ); 
```

它在第三个 assertTrue 上失败，它试图将 sf 中的值与 sf2 中的相应值进行比较。这是一个例外：

```
org.hibernate.LazyInitializationException: could not initialize proxy - no Session
    at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:86)
    at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:140)
    at org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer.invoke(JavassistLazyInitializer.java:190)
    at com.freightgate.domain.SecurityFiling_$$_javassist_7.getSfSubmissionType(SecurityFiling_$$_javassist_7.java)
    at com.freightgate.dao.SecurityFilingTest.test(SecurityFilingTest.java:73)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:40) 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2010-09-03T12:15:43.520

问题是您试图访问已[分离](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/objectstate.html)对象中的集合。在将集合访问到当前会话之前，您需要重新附加对象。你可以通过

```
session.update(object); 
```

使用`lazy=false`不是一个好的解决方案，因为您正在丢弃休眠的延迟初始化功能。时`lazy=false`，在请求对象的同时将集合加载到内存中。这意味着如果我们有一个包含 1000 个项目的集合，它们都将加载到内存中，无论我们是否要访问它们。这不好。

请阅读这篇[文章](http://community.jboss.org/wiki/OpenSessioninView)，它解释了问题、可能的解决方案以及为什么以这种方式实施。此外，要了解 Sessions 和 Transactions，您必须阅读[其他文章](http://community.jboss.org/wiki/Sessionsandtransactions)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-06T14:51:40.157

这通常意味着拥有的 Hibernate 会话已经关闭。您可以执行以下操作之一来修复它：

1.  无论哪个对象产生这个问题，使用`HibernateTemplate.initialize(object name)`
2.  `lazy=false`在您的 hbm 文件中使用。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-02-16T20:05:51.333

See my article. I had the same problem - LazyInitializationException - and here's the answer I finally came up with:
[http://community.jboss.org/wiki/LazyInitializationExceptionovercome](http://community.jboss.org/wiki/LazyInitializationExceptionovercome)
Setting lazy=false is not the answer - it can load everything all at once, and that's not necessarily good. Example:
1 record table A references:
5 records table B references:
25 records table C references:
125 records table D
...
etc. This is but one example of what can go wrong.
--Tim Sabin

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-09-26T13:50:21.107

如果您使用带有 JPA 注释的休眠，那么这将很有用。在您的服务类中，应该有一个带有@PersistenceContext 的实体管理器设置器。将其更改为 @PersistenceContext(type = PersistenceContextType.EXTENDED)。然后你可以在任何地方访问惰性属性。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-08-16T00:17:34.867

如果您使用延迟加载，您的方法必须使用注释

`@TransactionAttribute(TransactionAttributeType.REQUIRES_NEW)`对于无状态会话 EJB

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-09-03T08:39:00.917

We encountered this error as well. What we did to solve the issue is we added a **lazy=false** in the Hibernate mapping file.

It appears we had a class A that's inside a Session that loads another class B. We are trying to access the data on class B but this class B is detached from the session.

In order for us to access this Class B, we had to specify in the class A's Hibernate mapping file the lazy=false attribute. For example,

```
 <many-to-one name="classA" 
                 class="classB"
                 lazy="false">
        <column name="classb_id"
                sql-type="bigint(10)" 
                not-null="true"/>
    </many-to-one> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T23:17:42.490

好吧，终于知道我失职的地方了。我错误地认为我应该将每个 DAO 方法包装在一个事务中。大错特错！我已经吸取了教训。我已经从所有 DAO 方法中提取了所有事务代码，并在应用程序/管理器层严格设置了事务。这完全解决了我所有的问题。数据在我需要的时候被适当地延迟加载，一旦我提交，就会被打包并关闭。

生活是美好的... :)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-03-12T07:36:27.410

默认情况下，第一次访问时会延迟获取所有`one-to-many`和关联。`many-to-many`

在您的用例中，您可以通过将所有 DAO 操作包装到一个逻辑事务中来解决此问题：

```
transactionTemplate.execute(new TransactionCallback<Void>() {
    @Override
    public Void doInTransaction(TransactionStatus transactionStatus) {

        int startingCount = sfdao.count();

        sfdao.create( sf );

        SecurityFiling sf2 = sfdao.read( sf.getId() );

        sfdao.delete( sf );

        int endingCount = sfdao.count();

        assertTrue( startingCount == endingCount );
        assertTrue( sf.getId().longValue() == sf2.getId().longValue() );
        assertTrue( sf.getSfSubmissionType().equals( sf2.getSfSubmissionType() ) );
        assertTrue( sf.getSfTransactionNumber().equals( sf2.getSfTransactionNumber() ) );

        return null;
    }
}); 
```

另一种选择是在加载实体时获取所有 LAZY 关联，以便：

```
SecurityFiling sf2 = sfdao.read( sf.getId() ); 
```

也应该获取 LAZY `submissionType`：

```
select sf
from SecurityFiling sf
left join fetch.sf.submissionType 
```

这样，您可以急切地获取所有惰性属性，并且您也可以在 Session 关闭后访问它们。

您可以获取尽可能多的`[one|many]-to-one`关联和一个“[one|many]-to-many”列表关联（因为运行笛卡尔积）。

要初始化多个“[one|many]-to-many”，您应该在加载根实体后立即使用[Hibernate.initialize(collection) 。](https://docs.jboss.org/hibernate/orm/4.3/javadocs/org/hibernate/Hibernate.html#initialize%28java.lang.Object%29)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-11-04T02:08:02.340

如果您知道它的影响`lazy=false`并且仍然希望将其设为默认值（例如，出于原型设计目的），您可以使用以下任何一种：

*   如果您使用 XML 配置：添加`default-lazy="false"`到您的`<hibernate-mapping>`元素
*   如果您使用注释配置：添加`@Proxy(lazy=false)`到您的实体类

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-05-03T11:39:40.900

似乎只有您的 DAO 正在使用会话。因此，每次调用 DAO 方法时都会打开一个新会话，然后关闭。因此程序的执行可以恢复为：

```
// open a session, get the number of entity and close the session
int startingCount = sfdao.count();

// open a session, create a new entity and close the session
sfdao.create( sf );

// open a session, read an entity and close the session
SecurityFiling sf2 = sfdao.read( sf.getId() );

// open a session, delete an entity and close the session
sfdao.delete( sf );

etc... 
```

默认情况下，实体中的集合和关联是惰性的：它们是按需从数据库中加载的。因此：

`sf.getSfSubmissionType().equals( sf2.getSfSubmissionType() )`

正在引发异常，因为它请求从数据库进行新的加载，并且与实体加载关联的会话已经关闭。

有两种方法可以解决这个问题：

*   创建一个会话来包含我们所有的代码。因此，这意味着更改您的 DAO 内容以避免打开第二个会话

*   创建一个会话，然后在断言之前将您的实体更新（即重新连接）到该会话。

    session.update(对象);

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-08-03T14:15:16.637

对惰性字段使用 Hibernate.initialize

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-09T02:17:15.903

如果您手动管理 Hibernate 会话，您可能需要在此处查看 sessionFactory.getCurrentSession() 和相关文档：

[http://www.hibernate.org/hib_docs/v3/reference/en/html/architecture-current-session.html](http://www.hibernate.org/hib_docs/v3/reference/en/html/architecture-current-session.html)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-07-26T13:07:50.523

我认为 Piko 在他的回复中表示有 hbm 文件。我有一个名为 Tax.java 的文件。映射信息保存在 hbm（=hibernate 映射）文件中。在 class 标记中有一个名为**lazy**的属性。将该属性设置为 true。以下 hbm 示例显示了将惰性属性设置为**false**的方法。

`身份证...'

如果您使用的是注释，请查看休眠文档。 [http://docs.jboss.org/hibernate/stable/annotations/reference/en/html_single/](http://docs.jboss.org/hibernate/stable/annotations/reference/en/html_single/)

我希望这有帮助。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-06-19T11:56:01.703

如果您使用 Spring 和 JPA 注释，避免在延迟初始化中出现会话问题的最简单方法是重放：

```
@PersistenceContext 
```

至

```
@PersistenceContext(type = PersistenceContextType.EXTENDED) 
```

# ruby-on-rails - restful rails 模型验证

> ID：345707
> 
> 赞同：2
> 
> 时间：2008-12-06T01:33:08.317
> 
> 标签：ruby-on-rails, ruby, rest

我正在开发一个 Rails 应用程序（我对 Rails 有一些经验）。但是，这次我使用 RESTful 来构建它。我想知道如何以 RESTful 方式验证我的模型？我的意思是当用户将数据输入表单时，但模型验证会阻止创建模型。什么是 RESTful 方式将用户重定向回**他们输入的数据仍然存在于表单中的**`new`操作？

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T06:43:11.607

REST 只会影响你的控制器和路由！

RESTful Rails 应用程序中的模型验证与任何其他 Rails 应用程序中的验证相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T08:06:16.947

乔希 - 你提到想知道如何将用户重定向回创建，如果它出错了。如果您使用早期版本的 Rails，请确保您使用的是 form_for 帮助程序，而不是早期的 start_form_tag。您的控制器代码看起来与您可能习惯的方式非常相似......例如（客户模型）：

```
def create
  @customer = Customer.new(params[:customer])
  if @customer.save
    flash[:notice] = 'Customer was successfully created.'
    redirect_to(@customer)
  else
    render :action => "new"
  end
end 
```

您现在会注意到`redirect_to(@customer)`转发到在事务中创建的记录。但是在失败时它是相同的旧渲染：动作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T01:59:24.880

无论是以 RESTful 还是常规方式开发，后端实现通常保持不变。就像在非 RESTful 应用程序中一样，您只需使用带有用户尝试创建的实例的表单重新呈现创建页面。真正使用 REST，您所做的只是创建一组统一的 URL 来响应不同的 HTTP 请求，其他一切都保持不变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T07:47:47.467

使用脚手架生成器查看 restful 控制器上的示例代码

# jquery - 带有 asp.net 服务器按钮的 jquery 抛出错误 Invalid postback or callback argument

> ID：345721
> 
> 赞同：2
> 
> 时间：2008-12-06T01:43:56.657
> 
> 标签：jquery, asp.net-2.0

在这种情况下，我试图在我的 ASP.Net 2.0 网站中使用 JQuery：`asp:dropdownlist`在页面上有三个。前两个在服务器端填充，第三个在客户端由 JQuery 填充。还有一个在 Click 事件后`asp:imagebutton`从每个页面中获取选定值的页面。`dropdownlist`那么这会导致错误：`Invalid postback or callback argument`.

除了这个事实，它工作得很好，作为用户，我可以`dropdownlists`毫无问题地更改这三个的任何值，但是一旦我按下按钮它就会爆炸。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T01:56:09.113

您不能将客户端添加到 asp:dropdownlists 并将其回发。该页面将检测到这些值不是控件在呈现时所具有的值，并因您描述的错误而失败。您可以通过使用在客户端构建的 HTML 选择来解决此问题，然后在选择更改时将所选值复制到隐藏字段。在回发时使用隐藏字段中的值。

# coding-style - 这是成语pythonic吗？（someBool 和“True Result”或“False Result”）

> ID：345745
> 
> 赞同：7
> 
> 时间：2008-12-06T01:57:04.087
> 
> 标签：coding-style, python

我刚刚在一些开源 Python 中遇到了这个成语，我被我的饮料噎住了。

而不是：

```
if isUp:
    return "Up"
else:
    return "Down" 
```

甚至：

```
return "Up" if isUp else "Down" 
```

代码如下：

```
return isUp and "Up" or "Down" 
```

我可以看到这是相同的结果，但这是 Python 中的典型习语吗？如果是这样，是不是一些运行速度很快的性能黑客？还是只是一次需要代码审查？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-06T02:14:46.207

在编写和实现[PEP 308](http://www.python.org/dev/peps/pep-0308/)之前，“a 和 b 或 c”习语是在 Python 中表达三元算术的规范方式。这个成语失败了“b”答案本身就是错误的；为了支持一般情况，你可以写

```
 return (a and [b] or [c])[0] 
```

另一种拼写方式是

```
 return (b,c)[not a] 
```

通过引入 bool 类型，可以将其重写为

```
 return (c,b)[bool(a)] 
```

（如果不清楚：如果 a 已经不知道是 bool，则必须转换为 bool 和 not 运算符）

今天，如果事物必须是表达式，则应该使用条件表达式语法；否则我建议使用 if 语句。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-06T02:20:46.443

您应该阅读Mark Pilgrim 所著的[使用与或技巧](http://www.diveintopython.net/power_of_introspection/and_or.html)（第 4.6.1 节）的*Dive Into Python*。事实证明，and-or 技巧有你应该注意的主要缺陷。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T02:03:13.170

该代码对我的口味来说是一个很大的丑陋和聪明，但我想它本身并没有什么问题。我认为这实际上只是“让一切都适合一条线”综合症的一个案例。

我个人会选择第一种形式。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-06T02:10:02.267

不它不是。

前几天我有一个[类似](https://stackoverflow.com/questions/331767)的问题。

如果构造

```
val if cond else alt 
```

不是很受欢迎（至少受到 SO 社区的欢迎），首选的是：

```
if cond:
    val
else:
    alt 
```

你可以得出自己的结论。:)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-06T02:15:53.940

哎呀。根本不可读。对我来说，pythonic 意味着易于阅读。

```
return isUp and "Up" or "Down" 
```

听起来你会在 perl 中做一些事情。

# python - 重构 python 模块配置以避免相对导入

> ID：345746
> 
> 赞同：3
> 
> 时间：2008-12-06T01:57:34.133
> 
> 标签：python, configuration, module

这与我[之前的一个问题](https://stackoverflow.com/questions/343517/how-do-i-work-with-multiple-git-branches-of-a-python-module)有关。

我了解如何存储和读取配置文件。有诸如[ConfigParser](http://www.python.org/doc/2.5.2/lib/module-ConfigParser.html)和[ConfigObj](http://www.voidspace.org.uk/python/configobj.html)之类的选择。

考虑这个假设的“eggs”模块的结构：

```
蛋/
  常见的/
    __init__.py
    配置文件
  富/
    __init__.py
    一个.py

```

'eggs.foo.a' 需要一些配置信息。我目前正在做的是，在'a'中，

```
导入 egg.common.config
```

. 这样做的一个问题是，如果将“a”移动到模块树中的更深层次，则相对导入会中断。绝对导入不会，但它们要求您的模块位于 PYTHONPATH 上。

上述绝对导入的一个可能替代方案是相对导入。因此，在“a”中，

```
导入 .common.config
```

在不讨论相对进口与绝对进口的优点的情况下，我想知道其他可能的解决方案吗？

编辑 - 删除了 VCS 上下文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T14:41:43.233

“导入......要求你的模块在你的 PYTHONPATH 上”

正确的。

那么，设置有什么问题`PYTHONPATH`呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T00:19:24.970

You can trick the import mechanism, by adding each subdirectory to `egg/__init__.py`:

```
__path__.append(__path__[0]+"\\common")
__path__.append(__path__[0]+"\\foo") 
```

then, you simply import all modules from the egg namespace; e.g. `import egg.bar` (provided you have file egg/foo/bar.py).
Note that foo and common should not be a package - in other words, they should not contain `__init__.py` file.

This solution completely solves the issue of eventually moving files around; however it flattens the namespace and therefore it may not be as good, especially in big projects - personally, I prefer full name resolution.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T04:38:19.287

我正在考虑一种更“基于推送”的解决方案。不要导入共享对象（无论是用于配置，还是某种实用功能），而是让顶层**init**导出它，然后每个中间**init**从上层导入它，然后立即重新导出它。

我不确定我的python术语是否正确，如果我错了，请纠正我。

像这样，任何需要使用共享对象（在本示例的上下文中表示配置信息）的模块只需在其自身级别从**init导入它。**

这听起来合理/可行吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T02:35:54.447

来自[pkg_resources](http://peak.telecommunity.com/DevCenter/PkgResources#basic-workingset-methods)的 require 语句可能是您需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T02:41:41.003

正如我从这个问题和以前的问题中了解到的那样，您只需要一条路径即可`sys.path`。`git`如果我们在任何时候只签出一个分支（单个工作目录）时谈论VCS（在上一个问题中提到）。您可以随意切换、合并分支。

# soa - 编排是 ESB 的责任吗？

> ID：345749
> 
> 赞同：15
> 
> 时间：2008-12-06T02:00:49.900
> 
> 标签：soa, esb, bpel, orchestration, alsb

**企业服务总线**（一种充当中介、消息代理、服务启用者、模式转换增强器、透明位置提供者、服务聚合器、负载平衡器、监视器和所有这些东西的工具）是否**负责协调服务**？

在您的企业服务总线中放置一个包含上千个步骤和数十个服务调用的自动化业务流程怎么样？

您会这​​样做，还是会使用编排专家，例如 BPEL 引擎？

请给点意见。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-07T09:25:21.233

是和不是。编排和聚合/服务增强之间有一条细线，有时甚至无法区分。

一般来说，如果您有任何长期运行或复杂的业务流程（流程是关键词，尽管我将避免定义它）——这最适合 BPEL。

简单的任务，例如聚合三个服务调用的结果，可以而且经常应该在 ESB 层中完成。

不过，这不值得失去太多的睡眠

免责声明：我是一名 IBM ESB 顾问，尽管我并非以官方身份撰写本文。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-03T03:45:42.157

不，ESB 的职责不是编排服务（本身）。ESB 在“软件基础架构级别”提供了一个抽象层。

这意味着 ESB 是与在总线上发布的任何服务的“连接的单一逻辑抽象端口”。

ESB 是抽象的，意味着总线上的服务消费者不需要“知道”服务的部署细节，并且可以使用单个文档模型公开“面向内部的服务”。ESB 提供低级服务（例如协议转换和消息转换），以便内部服务可以以简化的方式进行通信。

这意味着一些编排：ESB 提供上述低级服务的编排（例如，当通过 IIOP 调用服务 X 时，将其转换为带有附件的 SOAP。然后将请求从任何序列化数据转换为 XML 有效负载）。

在 ESB 中您通常会避免的编排是：为了处理此（保险）销售，我们首先需要验证买方提供的信息，然后我们需要承保保险风险，最后计算需要的保费支付保险费，之后我们需要……等等。

上述步骤显然是一个业务流程（甚至可能被中断……例如，如果无法自动承保，则需要人工承保人进一步评估风险）。

构成业务流程（例如保险销售）的业务服务（例如验证、承保、保费计算），通常称为编排，最适合在业务流程引擎中发生并使用正式的业务流程进行定义建模语言（如 BPEL）。

还要对流程中的许多步骤进行猜测：在上面的示例中，验证是一项（课程粒度）服务。验证规则本身是该服务的内部。对于复杂的业务规则（即不是业务流程），可能需要使用业务规则引擎。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-06T02:05:24.103

我简短的快速回答是否定的，这不是它的责任。

我宁愿把它交给 BPEL 或 BPM 套件。

嗯，我不知道还有什么要补充的:) ...祝你好运？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-06T02:09:14.640

现在是我自己的愿景。

对于 ESB 必须完成的所有工作，将服务编排放在 SOA 的主要基础架构元素中并不是一个好主意。

合体，好！但是，让您的通信渠道忙于业务逻辑肯定会对交付其他功能的能力产生可怕的影响。

毕竟，像 BEA Aqualogic Service 这样的**大多数 ESB****对编排的支持有限，**包括**缺乏有状态的**功能，以及等待（计时器）或选择（等待某些输入在流程上移动）等活动，拆分/加入功能（ ALSB 3.0 中已添加），依此类推。

没门。只需使用 BPEL 引擎之类的工具或 Weblogic 集成之类的工具。

谢谢。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-30T16:25:00.393

只要您有两个或多个交互的服务，就使用服务编排器，即用于组合和流程控制服务。如果您有 esb，请在 esb 上公开此组合服务。现在，如果您必须编写包含此组合服务的新服务，请使用协调器并再次在 esb 上公开。使用 esb 作为服务交付机制和 Web 服务代理和代理。在编写服务编排器时，将使用 esb 来访问交互服务。如果这些交互服务使用不兼容的 xml 模式，esb 可以在运行时将它们转换/映射到公共模式，并根据内容（例如命名空间）路由服务请求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-25T06:46:24.300

是的，在大多数情况下，编排是 ESB 的责任。或者，或者，如果您在 ESB 基础架构和编排基础架构之间划清界限，那么您是出于性能原因在物理级别上这样做，而不是出于责任的逻辑归属。

您有 2 个选择 - 例如，当 HR 系统接收新员工时 - 您将“合规部门需要先批准和检查，然后如果没问题，HR 部门将需要”的业务逻辑放在哪里？要完成招聘，那么会计部门将需要一个新条目，然后工资系统将需要更新，如果失败，那么我们需要向 HR 发送电子邮件”？如果所有业务流程都被认为是由发起部门/应用程序“拥有”，那么作为企业的整个系统就会变得复杂，具有不同的编排系统。

第二种选择是集中编排，本质上使其成为消息传递平台的逻辑合作伙伴。如果您选择将它们视为单独的工件，这取决于您，但将两者都描述为 ESB 同样有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-14T23:42:03.447

企业服务总线不应该负责编排服务。

编排意味着最低限度的“智能”，特别是补偿失败事务的能力。服务总线工具通常会说它们提供“try-catch”或类似的功能，但运行范围补偿的能力是正确编排工具的标志。此外，等待、了解自身状态或保持悬念的能力是另一个指标，表明您正在与协调器而不是总线打交道。

谈到 1000 多个步骤和数十项服务，请考虑流程中的 if-then。如果 1000 步中的所有 if-then 语句只涉及路由而没有更改有效负载，那么您仍处于“路由”状态，因此仍处于 ESB 中。但是，如果甚至有一个*嵌套*的if-then，我就会开始寻找不同的工具。此外，看起来像路由的 if-then 会很快影响业务逻辑。一旦业务逻辑开始出现，那么更好的语言（例如 BPEL 或 BPMN）会更好。

管弦乐队指挥的例子经常被用来描述管弦乐是如何工作的，一个中心个人根据乐谱指挥音乐家。通常留下的想法是，指挥不仅在指挥，而且在倾听，如果出现问题，可以以可靠、可重复的方式进行补偿。

例如，假设我们的第一个指挥去请大号手，但说大号手决定去做别的事情。一个简单的弹球式“协调员”将带入大号部分，完全知道它不存在，然后等待观众稍后抱怨。一个真正精明的指挥会看到大号消失，并立即调出更深的男中音号角来补偿。

# primary-key - 现在我已将主键转换为 GUID，如何修复性能？

> ID：345753
> 
> 赞同：0
> 
> 时间：2008-12-06T02:03:36.493
> 
> 标签：primary-key, guid, auto-increment, toplink

我使用 TopLink 作为我的 ORM 和 MySQL 作为数据库。

我将我的自动增量主键换成我的一张表的 GUID（好吧，不完全是：我实际上使用的是随机的 64 位整数，但这足以满足我的需要）。

无论如何，现在甚至不使用密钥的查询都需要更长的时间。

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T03:55:58.090

如果您在 MySQL 中使用 innodb 表，[则所有行都由主键引用，](http://www.mysqlperformanceblog.com/2007/03/13/to-uuid-or-not-to-uuid/)因此如果您使用辅助键，性能将受到影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T02:11:35.900

如果您的表由您查询的字段索引。密钥的内容不应有任何明显的性能影响。他们也许还有别的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T02:13:00.857

确保键列确实是 PRIMARY KEY，因此是聚集（物理）索引。

确保您有符合常见查询的索引。

* * *

*随机*整数？你意识到有可能击中相同的 pri 键吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T02:44:08.097

> 我有一个代表创建日期的字段。我怎样才能强制我的表相应地成为索引？

```
create index Table_creationDate on Table(creationDate); 
```

# visual-studio-2008 - 适用于 Visual Studio 2008 的 Silverlight 工具 - 放置控件问题

> ID：345758
> 
> 赞同：2
> 
> 时间：2008-12-06T02:06:23.303
> 
> 标签：visual-studio-2008, silverlight, silverlight-2.0

VS2008 的 Silverlight 工具有什么问题？我似乎无法在设计器表面上放置控件。这对我在两台不同的机器上不起作用。您是否必须调整 XAML 才能放置第一个控件？
光标在表面上时保持像指南针一样的十字形。你应该拖放控件还是绘制它们？

截图（据我所知）![银光问题](https://i264.photobucket.com/albums/ii199/brunotyndall/silverlight-issue.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T03:24:06.113

正如 Aaron Fischer 所指出的，目前 VS Silverlight 设计器是只读的。我只想补充一点，您仍然可以将工具箱中的控件拖放到您的 XAML 标记中。这在您从外部程序集（例如 DataGrid）添加控件时特别有用，因为它会自动创建对程序集的引用并映射适当的命名空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T02:34:42.547

设计器是只读的。在 2010 年之前，您必须使用表达式混合

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T04:39:53.703

这是为了回应您从您对[这篇文章](https://stackoverflow.com/questions/539754/silverlight-getting-the-domain-information)的评论中对这个问题的看法。

正如 Aaron Fischer 和 Boyan 所提到的，由“Microsoft Silverlight Tools for Visual Studio 2008 SP1”包安装的 Visual Studio 2008 Silverlight 2 Designer**目前**是只读的。

在 Visual Studio 2008 中，您当前无法将 Silverlight 2 控件从工具箱拖放到设计器上。但是，如果在开始拖动之前将光标放在 Xaml 编辑器中，则可以将控件从工具箱拖动到 Xaml 编辑器。

这很可能会在未来版本的工具包中发生变化，可能是今年。在 MIX 09 上会有一些关于 Silverlight 3 的公告，我不知道这是否会是其中之一。

要获得对 Silverlight 2 Xaml 的设计控制，您需要安装 Expression Blend 2。您可以[在此处](http://www.microsoft.com/Downloads/details.aspx?FamilyID=5ff08106-b9f4-43cd-abad-4cc9d9c208d7&displaylang=en)下载试用版，确保您还[从此处安装 Service Pack 1](http://www.microsoft.com/Downloads/details.aspx?familyid=EB9B5C48-BA2B-4C39-A1C3-135C60BBBE66&displaylang=en)。如果您已安装此程序，则右键单击 Visual Studio 2008 中的 Page.xaml 并选择“在 Expression Blend 中打开...”

在 Expression Blend 中打开后，您可以将控件从工具箱拖放到设计器中。在 Expression Blend 2 中，工具箱称为“资产库”，可以通过左键单击屏幕左侧列表底部的双右箭头 >> 来访问它：

![替代文字](https://silverlight2blogpost.s3.amazonaws.com/step6.png)

资源库打开后，如果您找不到您要查找的控件（您提到您在 Expression Blend 2 中找不到 Button 控件），一个很好的提示是在左上角的搜索区域中键入它的名称或单击“显示全部...”复选框，如上所示。

这篇博文是一个很好的起点，可以通过大量屏幕截图初步了解如何[将 Expression Blend 与 Silverlight 2结合使用。](http://weblogs.asp.net/scottgu/archive/2008/02/28/first-look-at-using-expression-blend-with-silverlight-2.aspx)您还可以观看该博客文章的一些后续视频，名为[向 Silverlight 开发人员介绍 Blend](http://silverlight.net/learn/learnvideo.aspx?video=53504)和[Silverlight 编程和表达式混合](http://silverlight.net/learn/learnvideo.aspx?video=53503)。

# c# - 枚举应该有未初始化的值。

> ID：345760
> 
> 赞同：9
> 
> 时间：2008-12-06T02:07:23.350
> 
> 标签：c#, enums

我们正在争论枚举是否应该具有未初始化的值。例如。我们有

```
public enum TimeOfDayType
{
   Morning
   Afternoon
   Evening
} 
```

或者

```
public enum TimeOfDayType
{
   None
   Morning
   Afternoon
   Evening
} 
```

我认为不应该有任何内容，但是您必须在初始化时默认为某个有效值。但其他人认为应该通过另一个为 None 或 NotSet 的枚举来表明统一状态。

想法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-06T02:33:36.247

说到可空类型——我认为它们可以用来解决强制/不强制初始化枚举的问题。说我们有

```
enum Color { Red, Blue } 
```

假设你有一个函数：

```
void Draw(Color c); 
```

该函数说它**需要**一个有效的`Color`. 但是，我们也可以有这个功能：

```
void Draw(Color? c); 
```

这表示该函数可以处理不传递颜色（`null`将传递以表示“不关心”）。

嗯，这是成员的一种选择`None`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-06T08:32:39.593

我总是将我的枚举文字之一设置为零。此文字不得总是命名为“None”或“NotSet”。这取决于是否有一个文字可以很好地作为默认值。

我将 1 设置为 0，因为枚举（可空枚举除外）总是由内存中的 CLR 初始化为零。如果您没有定义其中一种文字，则此内存包含非法值。此外，当您使用枚举作为标志时。默认值不能用于按位比较。结果将始终为零。

当您启用 FxCop 时，它会检查您是否已将文字定义为默认值。当他们有规则时，这似乎是一种“好习惯”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-06T04:00:46.490

在之前的一些答案中，提出了一个可以为空的枚举作为解决方案。但是可空枚举的缺点是它使客户端每次使用枚举时都检查空值。相反，如果您有一个默认值“None”，您可以选择使用开关来获取有意义的值，而忽略“None”，而不必担心枚举变量可能为空。

无论如何，我认为只有当枚举用作某个类的默认构造函数中的参数时，才有默认值“无”或使枚举为空才有意义。你必须问自己——那个类的对象不应该有一些有意义的默认值吗？将您的示例与 TimeOfDayType 枚举一起使用 - 如果您使用 TimeOfDayType.None 初始化对象，则在将值更改为 Morning、Afternoon 或 Evening 之前无论如何都不能使用它。所以你不能说默认是 Morning 而不是 None 吗？或者——更好的是——在你已经知道它们需要哪个枚举值之后，你不能创建你的对象吗？我认为，如果在早期设计阶段正确解决了该问题，则根本不需要为枚举设置特殊的默认值。

当然，以上都是概括。也许它不能应用于你的特定场景，所以如果你提供一些关于它的细节，我们可以更彻底地讨论这个问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-06T04:01:20.250

在没有“默认”成员的情况下，我认为拥有一个表示文字 int 0 的值是有价值的。

无论如何，将使用字面值 0 创建给定的枚举。这里最直接的情况是作为结构的成员。AC# struct 将始终有一个空的默认构造函数，它将所有字段初始化为其默认值。在枚举的情况下，这将是文字值 0。问题是如何处理它。

对我来说，这是一个风格问题：如果枚举没有显式初始化为一个值，应该给它一个任意的有效值还是一个表示缺乏显式初始化的特定值？

```
enum Color { Unknown, Red, Blue }
enum Color2 { Red,Blue }
struct Example<T> {
  Color color;
}

static void SomeMethod() {
  var v1 = new Example<Color>();
  var v2 = new Example<Color2>();
} 
```

在 v1 的情况下，如果检查了颜色字段，它将被明确标记为未初始化的字段。在 v2 中，该字段将简单地为“红色”。程序员无法检测到显式设置为“Red”或隐式默认值设置为“Red”。

导致问题的另一种情况是针对枚举值执行 switch 语句。让我们稍微改变 Color2 的定义。

```
enum Color2 { Red = 1, Blue = 2 }
static void SomeOtherMethod(p1 as Example<Color2>) {
  switch ( p1.color ) {
   case Color.Red: {} 
   case Color.Blue: {}
   default: {throw new Exception("What happened?"); }
  }
} 
```

开关处理枚举中的每个显式值。然而，对于 Example<Color2> 的默认构造函数，此代码将失败，并且无法抑制此构造函数。

这带来了一个稍微重要的规则：为字面值 0 有一个显式的枚举值。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-06T02:54:26.763

只是添加到 Franks 的答案，我会在枚举中选择“无”项而不是可为空的唯一一次是当枚举被用作标志时。“无”项目的 id 为 0。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-06T02:14:17.860

取决于类型的使用方式。对于该类型的用户来说，没有“未定义”值通常更容易，因为您不必对一个值进行特殊处理。但是如果你需要一个（因为值有时需要处于一个不是任何枚举值的状态），那么你需要一个。您通常不会通过使用两个枚举而不是一个枚举来保存任何特殊情况代码。

这有点像问你是否应该使用可为空的类型。

# windows - 从托管代码中的 shell 获取 Vista/Windows Search/propsys.dll 属性

> ID：345766
> 
> 赞同：1
> 
> 时间：2008-12-06T02:10:50.330
> 
> 标签：windows, com, com-interop, shell32

有没有人设法做到这一点？我尝试为 IPropertyStore 创建一个托管包装类，但在获取指向 PROPVARIANT 的指针的方法（即 IPropertyStore::GetValue）上获得了 AccessViolationExceptions（在我的托管版本中呈现为 MarshalAs(UnmanagedType.Struct) 输出参数）可能是我的理解COM 和互操作是不够的 --- 我不确定问题是否出在我的 PROPVARIANT 结构声明中（目前只使用 StructLayout.Sequential，声明一个字节序列，并手动操作字节以获取各种类型的值工会等），COM 问题是什么进程拥有什么，或其他什么。我已经尝试过各种其他版本的 PROPVARIANT，例如对联合使用 StructLayout.Explicit，但没有任何效果。使用 IPropertyStore 检索 PROPERTYKEY::

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T03:00:24.897

好吧，这是来自`MS.Internal.Interop`（知识宝库）的版本：

```
[StructLayout(LayoutKind.Sequential), FriendAccessAllowed]
internal struct PROPVARIANT
{
    internal VARTYPE vt;
    internal ushort wReserved1;
    internal ushort wReserved2;
    internal ushort wReserved3;
    internal PropVariantUnion union;
}

[FriendAccessAllowed]
internal enum VARTYPE : short
{
    VT_BSTR = 8,
    VT_FILETIME = 0x40,
    VT_LPSTR = 30,
    // etc...
}

[StructLayout(LayoutKind.Explicit), FriendAccessAllowed]
internal struct PropVariantUnion
{
    [FieldOffset(0)]
    internal BLOB blob;
    [FieldOffset(0)]
    internal short boolVal;
    // etc... see MS.Internal.Interop for full definition
} 
```

这些定义将帮助您确保您的结构至少是正确的。至于你的其他问题，我没有答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-13T01:35:17.980

您应该查看[http://code.msdn.microsoft.com/WindowsAPICodePack](http://code.msdn.microsoft.com/WindowsAPICodePack)。它支持使用 Windows 属性系统，以及许多其他 Windows shell 功能。我认为这正是您正在寻找的。

# iphone - 是否有任何示例代码来执行 iPhone 多线程任务？

> ID：345772
> 
> 赞同：1
> 
> 时间：2008-12-06T02:14:29.013
> 
> 标签：iphone, cocoa-touch, multithreading

我有一些缓慢的互联网任务来保存和加载文件，我想在一些后台线程中执行那些缓慢的任务。我想知道这是否可行，如果可行，有任何示例代码吗？

然后在它完成后，我希望它通知主线程，以便我可以更新 UI。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T02:29:57.297

看看 NSURLConnection。它将在后台加载一个 NSURL（使用 NSURLRequest），并发送有关其状态的委托方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T02:36:41.950

登录 iPhone 开发者中心，搜索 Introduction to Threading Programming。或者，也许您可​​以登录并使用此链接：

[http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/Multithreading/Introduction/chapter_1_section_1.html#//apple_ref/doc/uid/10000057i-CH1-SW1](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/Multithreading/Introduction/chapter_1_section_1.html#//apple_ref/doc/uid/10000057i-CH1-SW1)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T06:46:44.020

最终，您运行代码的设备只有一个处理器，不可能加载大量（千兆字节）数据。最好的路线可能是 Ben 建议的（NSURLConnection 异步），它为您提供了能够干净地取消和处理错误消息的额外优势。虽然它在技术上并没有按照您可能认为的方式进行线程化，但它与事件循环很好地集成并且是非阻塞的。如果这还不够，我建议看看 NSOperation 和 NSOperationQueue。您可以触发 NSOperation 子类对象并在那里执行下载（我仍然建议在那里异步执行以启用取消、暂停等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T04:42:03.927

如果您确实决定即使在使用异步 HTTP 调用来收集数据之后也需要一个后台线程，请不要忘记将后台线程代码包装在一个新的 NSAutoReelasePool 中，然后在最后释放它。

# scala - 延迟加载一些配置参数，试图在 Scala 中提出一个模式

> ID：345788
> 
> 赞同：3
> 
> 时间：2008-12-06T02:34:52.233
> 
> 标签：scala

我希望我的客户端代码看起来像这样：

```
 val config:Config = new MyConfig("c:/etc/myConfig.txt")
    println(config.param1)
    println(config.param2)        
    println(config.param3) 
```

意思就是：

*   Config 接口定义了配置字段
*   MyConfig 是一个 Config 实现——所需的所有连接都是所需实现的实例化
*   数据被延迟加载——它应该发生在第一个字段引用上（在这种情况下为 config.param1）

所以，我希望客户端代码友好，支持可互换的实现，具有静态类型的字段，隐藏延迟加载。我还希望它尽可能简单地进行替代实现，因此 Config 应该在一定程度上指导您。

到目前为止，我对我的想法并不满意：

```
trait Config {
  lazy val param1:String = resolveParam1
  lazy val param2:String = resolveParam2
  lazy val param3:Int = resolveParam3

  protected def resolveParam1:String
  protected def resolveParam2:String
  protected def resolveParam3:Int
}

class MyConfig(fileName:String) extends Config {
  lazy val data:Map[String, Any] = readConfig

  // some dummy impl here, should read from a file
  protected def readConfig:Map[String,Any] = Map[String, Any]("p1" -> "abc", "p2" -> "defgh", "p3" -> 43)

  protected def resolveParam1:String = data.get("p1").get.asInstanceOf[String]
  protected def resolveParam2:String = data.get("p2").get.asInstanceOf[String]
  protected def resolveParam3:Int = data.get("p3").get.asInstanceOf[Int]
} 
```

我确信有更好的解决方案，这就是您可以提供帮助的地方:)

我在这里特别不喜欢的一件事是 MyConfig 定义了一个带有一些任意键的中间容器，因为它是 Map[String, **Any** ]，所以我需要转换值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T06:03:58.427

没有什么可以阻止您将值抽象化。您不能在超级特征中强制执行惰性，但这没关系，因为无论如何延迟加载实际上是一个实现细节：

```
trait Config {
  val param1: String
  val param2: String
  val param3: Int
}

class MyConfig extends Config {
  lazy val param1 = readConfig().("p1")
  ...

  def readConfig(): Map[String, String] = ...
} 
```

在风格上，`readConfig()`应该用括号（而不是不带）声明和调用，因为它是一种副作用方法。无括号语法旨在表示纯函数方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T03:56:55.953

如果您只是想简化它，“参数”字段可能是方法......

```
trait Config {
  def param1:String
  def param2:String
  def param3:Int
}

class MyConfig(fileName:String) extends Config {
  lazy val data:Map[String, Any] = readConfig

  // some dummy impl here, should read from a file
  protected def readConfig:Map[String,Any] = 
    Map[String, Any]("p1" -> "abc", "p2" -> "defgh", "p3" -> 43)

  def param1:String = data.get("p1").get.asInstanceOf[String]
  def param2:String = data.get("p2").get.asInstanceOf[String]
  def param3:Int = data.get("p3").get.asInstanceOf[Int]
} 
```

要摆脱强制转换，您可以`MyConfig`包装一个由`MyConfig`.

```
class MyConfig(fileName:String) extends Config {
  private class NonLazyConfig(val p1:String, p2:String, p3:int) extends Config {
      def param1 = p1
      def param2 = p2
      def param1 = p3
  }
  lazy val inner:Config = readConfig

  // some dummy impl here, should read from a file
  protected def readConfig:Config = {
    return new NonLazyConfig("abc", "defgh", 43)
  }
  def param1:String = inner.param1
  def param2:String = inner.param2
  def param3:Int = inner.param3
} 
```

# php - 如何检索 PHP exec() 错误响应？

> ID：345794
> 
> 赞同：39
> 
> 时间：2008-12-06T02:39:13.923
> 
> 标签：php, shell, exec

以下是我尝试执行的命令，但没有成功：

```
exec('ln -s ' . PLUGIN_DIR . '/.htaccess ' . ABSPATH . '/.htaccess'); 
```

当你在最后添加一个 die() 时，它会发现有一个错误：

```
exec('ln -s ' . PLUGIN_DIR . '/.htaccess ' . ABSPATH . '/.htaccess') or die('what?!'); 
```

对于上面的 exec() 语句，权限问题导致了错误，但 PHP 没有显示它。你如何从 PHP 显示发生了什么错误？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2016-10-27T20:44:02.803

以下代码将捕获正常输出（来自 StdOut）和错误输出（来自 SdtErr）。

```
exec('ln -s ' . PLUGIN_DIR . '/.htaccess ' . ABSPATH . '/.htaccess 2>&1',$output);
var_dump($output); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-06-06T21:52:46.897

如果调用程序将输出吐出到 STDERR，$output 参数似乎不起作用。

处理此问题的更好方法是将输出从 exec 重定向到文件，然后在出现错误情况时显示该文件的内容。

如果 $cmd 持有 exec 命令，请添加如下内容：

```
$cmd.=" > $error_log 2>&1" 
```

然后检查 $error_log 中文件规范的内容，以获取有关命令失败原因的详细信息。

另请注意，如果您在命令末尾使用 & 将其分叉，则立即检查 $error_log 的内容可能不会显示日志信息 - 脚本可能会在操作系统完成之前检查/处理文件。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2017-04-13T08:53:11.700

这在几种情况下对我有用：

```
 ob_start();
 exec($cmd . " 2>&1", $output);
 $result = ob_get_contents();
 ob_end_clean();
 var_dump($output); 
```

***" 2***之间的空间很重要

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-12-06T02:44:55.333

您可以通过传递可选的第二个参数来接收[exec 函数](http://www.php.net/function.exec)的输出结果：

```
exec('ln -s ' . PLUGIN_DIR . '/.htaccess ' . ABSPATH . '/.htaccess',$output);
var_dump($output); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-11-08T20:56:46.990

这对我有用：将 2>&1 附加到命令的末尾。

在这里看到： [执行 svn 命令时，php exec() 未在输出中返回错误消息](https://stackoverflow.com/questions/3863699/php-exec-not-returning-error-message-in-output-when-executing-svn-command)

干杯

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-12-01T23:51:29.447

如果通过第二个参数没有找到错误，可以搜索apache的错误日志，例如在Ubuntu Server 12.10中通过命令 $ tail /var/log/apache2/error.log 我正在运行一个python脚本来自 php，其错误仅在此处打印，因此我能够对其进行诊断。最好的祝福。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-07-18T11:03:43.470

这不是您问题的直接答案，但如果您想知道返回的错误代码到底发生了什么，这非常有用。

如果错误代码（$res），由命令返回：

```
exec('command', $out, $res); 
```

范围为 1-2、126-165、255，而不是由 PHP 调用的 shell（例如 BASH）返回（以执行您的命令）。如果返回的代码不在此范围内，则它是由您的命令（不是 shell）返回的。

请参阅（有关 BASH 错误代码说明）

> [https://www.linuxtopia.org/online_books/advanced_bash_scripting_guide/exitcodes.html](https://www.linuxtopia.org/online_books/advanced_bash_scripting_guide/exitcodes.html)

# functional-programming - 关于 Erlang 中未使用变量的警告

> ID：345795
> 
> 赞同：6
> 
> 时间：2008-12-06T02:41:07.370
> 
> 标签：functional-programming, erlang

我最近开始使用 Erlang，我注意到我在编译时经常收到“警告：变量 X 未使用”。例如，采用以下函数，该函数查找列表中的最大元素：

```
 max([Head|Tail]) ->
       max(Head,Tail).

    max(Element,[Head | Tail]) when Element < Head ->
       max(Head,Tail);
    max(Element,[Head | Tail]) ->
       max(Element, Tail);
    max(Element,[]) ->
       Element. 
```

编译器警告我，在函数的第 3 种情况下，未使用 Head。没有Head怎么写函数？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-14T19:39:28.857

如果您命名一个变量`_`而不是`Name`（例如`_`，代替`Head`）该变量将不会被绑定，并且您不会收到警告。

如果您命名一个变量`_Name`而不是`Name`（例如`_Head`，代替`Head`）该变量*将*被绑定，但您仍然不会收到警告。`_`在代码中引用以开头的变量被认为是*非常*糟糕的做法。

`_Head`建议保留变量的名称以提高代码的可读性（例如，比仅仅猜测它的用途更容易`_`）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-06T02:45:19.217

这应该抑制警告而不会造成混淆：

```
max(Element,[_Head | Tail]) ->
   max(Element, Tail); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-06T02:47:32.317

```
 max([Head|Tail]) ->
       max(Head,Tail).

    max(Element,[Head | Tail]) when Element < Head ->
       max(Head,Tail);
    max(Element,[_| Tail]) ->
       max(Element, Tail);
    max(Element,[]) ->
       Element. 
```

应该做的伎俩。原因是将 'Head' 替换为 '_' 是表示参数将被放置在那里的语法，但我不需要它。

# robotics - 用于构建自动 CD 加载臂的定制机器人

> ID：345805
> 
> 赞同：3
> 
> 时间：2008-12-06T02:47:42.457
> 
> 标签：robotics

你会建议我在哪里找到一家公司来开发或购买类似于：[http ://www.dextimus.com/ 的 CD/DVD 装载臂](http://www.dextimus.com/)

最好通过 USB 进行编程，但如果我只能得到一个带有串行接口的接口就可以了。驱动程序无关紧要 - 我可以直接与设备交互，因为我的情况非常独特。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T04:30:09.217

如果您对电子产品有一定的经验，您可以试一试并自己构建它，例如[this](http://www.sentex.net/~mwandel/tech/changer.html)或[this](http://www.redfrontdoor.org/cd-changer.html)。

我应该补充一点，包括原理图和源代码，在第一个项目中更详细。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T17:04:34.170

我想我可以先给出一个资源列表来缩短这个：

[http://www.embedinc.com/](http://www.embedinc.com/)我相信这家公司会做得很好。昂贵（实际上，它们在设计界定价合理，但大多数爱好者和个人认为它们很昂贵）。不擅长人际交往，但非常非常擅长他们所做的事情。

您应该查看各种微控制器社区和论坛，了解可以做到这一点的爱好者和专业人士。搜索microchip、atmel、msp430、arm、powerpc等。

[Sparkfun](http://www.sparkfun.com)是电子社区的供应商 - 他们有很棒的论坛，您可以在其中发布您的请求，并且您会找到可能只用材料成本来做这件事的人。可能需要更长时间，可能不是“专业”或包装和交付良好，但它可能是您最好的低成本选择。

* * *

有很多电子设计公司可以做到这一点（例如，我可以做这种事情）。

但是有很多问题你没有回答（并且可能没有研究过）可能会阻碍成功：

*   这个有专利吗？
*   哪些 CD 加载/卸载方法未获得专利、不在专利范围内或以其他方式可用？
*   您的设计目标是什么 - 一款专为您量身打造的设备，还是一款可制造数百个用于工业用途的设备，或者一款适用于一般上班族/消费者的设备，可制造数百万个？
*   您是否意识到，如果您只需要一个，那么这种设计肯定比简单地购买一个要花费更多吗？

例如，假设您不需要漂亮的外壳并且不介意“原型”外观，那么仅机械、电子和固件设计（PC 上没有软件）可能需要 100-250 小时的计费时间设计公司。以便宜的 90 美元/小时计算，一个原型的成本是 9000 美元到近 25000 美元。添加PC软件和漂亮的外壳等，你会加倍。

如果你能找到一个当地的“制作”小组（techshop、GoTech 或类似的），那么你可能会找到一个愿意以材料成本来玩这个想法的爱好者。

但是，如果您确定您的目标是什么，并让我们了解您的资源，您可能会找到更好的答案。

-[亚当](http://twitter.com/stienman)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T13:17:15.853

您可以使用无线电控制伺服系统创建一个非常简单的解决方案。它们有多种尺寸，但即使是小尺寸的也有足够的扭矩来移动大臂来移动 cd。

伺服系统的真正好处是它们通常具有 180 度旋转，并且内部有一个可变电阻器（变阻器）用于定位反馈。定位精度通常在 1 度的旋转范围内，这对于 cd 装载机来说应该没问题。

对于拿起 CD，没有什么能比得上真空。我推荐一个小型电池供电的真空吸尘器。将吸力集中到 1/4 英寸的管道中。在管道的另一端，直径为 1 英寸的杯子应该从少量吸力中提供足够的升力。

至于要烧掉的那一堆空白CD，我建议把那堆放在上面，而不是把一只胳膊往下移。可能顶部空白 cd 比 cd 托盘高约 1/4 英寸 - 通过这样做，手臂只需要在一个轴上旋转，真空应该足以将 cd 从托盘中吸回。

现在，对于电子产品。对于伺服控制，我建议使用 rs232 串行伺服控制器。我使用了来自[http://www.basicx.com/Products/servo/servo8t.htm](http://www.basicx.com/Products/servo/servo8t.htm)的那个，因为它还从电流中返回扭矩信息。

对于低采样率数字 I/O，我建议（对于 Windows）inpout32.dll，这是一个 dll，可让您直接访问并行端口的位。这将允许您在正确的时间打开真空吸尘器，并可能在 cd 用完时感觉到。请注意，并行端口可以吸收比其源更多的电流，因此对于输出，您应该连接到 5v 电源线并将输出引脚设置为 0 以打开输出，1 将其关闭。

[另一个不错的选择是从http://www.rev-ed.co.uk/picaxe/](http://www.rev-ed.co.uk/picaxe/)获取一个 picaxe，它的界面非常非常简单且非常便宜。它们使用一种非常简单的编程语言（BASIC 衍生产品），允许您在一个芯片上读取串行数据并控制伺服系统和数字 I/O。上次我使用的时候，语言有点简单——if 语句必须跳转标签，否则不存在。

如果您确实使用微控制器和伺服系统，最好使用双电压电源，因为伺服系统有噪音并且可能导致微控制器复位。

至于打开真空等负载，您需要使用 MOSFET 或（如果钱不是对象）更简单的选择，即固态继电器。

您在微控制器上使用的所有数字输入都应使用 5k 电阻拉至 +V 或接地，这样它们就不会浮动。

我不能强调皮克斯是多么简单和便宜。它们有一个内置的解释器，因此虽然小型 8 针单元上的代码空间很小，但它们可以通过简单的串行引线进行编程。

祝你好运。一旦你进入自动化控制，你将永远无法停止。我正在建造一个 3 轴 CNC 路由器，这样我就可以为其他项目切割零件（我告诉我的女朋友这是为了让她可以切割圣诞装饰品！）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T03:40:38.507

您可能想就他的[Florian](http://www.mini-itx.com/projects/florian/)项目联系 Aaron Shephard。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-26T11:25:31.140

我发现 phidgets 生产了一个非常简单的控制步进电机或伺服电机的电路板[——API](http://www.phidgets.com)非常简单，可用于大量平台。

# windows - 用于区分 Windows 二进制文件的工具？

> ID：345815
> 
> 赞同：3
> 
> 时间：2008-12-06T02:57:42.420
> 
> 标签：windows, diff, compare, build, binaries

我们的 QA 团队希望根据构建之间的 EXE 和 DLL 实际更改来集中他们的测试。我们有一个不错的 svn 更改报告，但是源代码和更改后的二进制文件之间的关系并不总是很明显。我们比较的构建总是完全干净的构建，所以我们不能使用文件系统时间戳。我正在寻找用于比较 Windows（和 Windows CE）PE 二进制文件的工具，这些二进制文件将忽略嵌入的时间戳和其他杂乱无章的东西。对于生成可靠的“哪些二进制文件真正改变了”报告的工具或其他方法有什么建议吗？谢谢。

澄清：感谢到目前为止的答案，但我们无法通过直接的逐字节比较或比较校验和来生成报告，因为每次构建时所有文件看起来都不同，即使源没有改变，因为编译器插入的时间戳。问题是如何忽略误报。我认为拆解和比较的想法最接近我们的需要......

回答！Bindiff 正是我想要的。非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T13:56:39.017

你看过[Bindiff](http://technet.microsoft.com/en-us/library/cc784415.aspx)吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T13:30:39.883

我之前遇到过这个问题。我的解决方案是编写一个工具，将 .EXE/.DLL 中的所有时间戳设置为已知值。我会将它作为构建后的步骤运行。然后二进制差异就可以了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T03:11:02.160

您也许可以反汇编二进制文件，然后对程序集进行比较...

这听起来像是您的 QA 团队采用了错误的方法......对他们来说代码是什么样的并不重要；只是它做了它应该做的事情。

编辑：哦！再次阅读后，我意识到我误解了您的问题。我以为他们想测试已经改变的方法......

在这种情况下，为什么不获取 MD5 哈希值并进行比较呢？最微小的变化将导致生成完全不同的哈希。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T08:23:13.963

不确定哪种二进制文件（DLL？仅限 PE/WinCE 可执行文件？其他？）是否可以在二进制文件中嵌入版本信息，例如使用源代码控制标签在提交时更新源代码中的版本。然后，当创建新版本时，二进制文件也会更新它的版本字符串。不必比较二进制文件，您可以使用版本字符串并检查更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T13:51:52.413

看看[NDepend](http://ndepend.com)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T03:26:30.053

当我在公司开发用于安装验证的“本土”工具时，我们使用**[Beyond Compare](http://www.scootersoftware.com/)**作为后端进行比较。

它具有出色的文件/文件夹比较（以及二进制）和脚本功能，并且可以输出 XML 报告。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-06T08:21:53.687

[项目依赖图生成器](http://www.codeproject.com/KB/trace/dependencygraph.aspx)和[C++ 项目的 Dependency-Grapher](http://www.codeproject.com/KB/macros/classdep.aspx)都使用[GraphViz](http://www.graphviz.org/)来可视化依赖关系。我想你可以使用它们中的任何一个作为你需要的基础，特别突出依赖图中源文件或其他叶子发生变化的分支。

MD5 哈希或校验和（如上所述），一个简单的 diff 忽略空格并过滤掉注释更改，或者来自版本控制系统的 changlist 信息可以指示哪些文件已更改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-06T08:25:01.747

[gnu binutils](http://en.wikipedia.org/wiki/GNU_Binutils)特别是[字符串](http://en.wikipedia.org/wiki/Strings_(Unix))

# asp.net - 如何使用 HttpHandler 限制传输速率

> ID：345820
> 
> 赞同：1
> 
> 时间：2008-12-06T03:03:23.987
> 
> 标签：asp.net, httphandler

我正在编写具有限速功能的文件传输处理程序，该速率基于用户级别。如何控制/计算 HttpHandler 中的传输速率？

一些 asp.net 资源告诉我使用 Thread.Sleep 会阻塞 asp.net 线程池。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T12:00:37.723

休眠 ASP .NET 中的任何线程通常不是一个好主意，因为这些线程可以用于为来自池的请求提供服务。如果说池中有 10 个线程，正在处理下载的 10 个线程休眠将导致所有其他请求堆积在队列中，直到下载完成。

最好通过创建 IHttpAsyncHandler 而不是 IHttpHandler 来为您服务，如下所述：

[http://msdn.microsoft.com/en-us/library/ms227433.aspx](http://msdn.microsoft.com/en-us/library/ms227433.aspx)

您可以使用计时器定期将 x 字节的数据泵送到客户端（但请确保使用 IsClientConnected 或类似的方法定期收集已关闭的连接）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T04:04:55.953

您可能想尝试使用计时器和计时器回调来执行此操作。这个想法是有一个计时器（或两个）来触发您的处理程序何时可以运行以及运行多长时间。每次“go”计时器到期时，它都会启动一个线程，将您的数据写入响应，直到“stop”计时器到期（或相同的计时器再次到期），然后该线程完成它正在做的事情，为下一个线程，重置“go”计时器，然后退出。您的主线程只是设置初始计时器，传输数据，然后调用计时器并退出。大概您需要在某处保留对响应的句柄，以便您可以再次访问它。通过改变处理程序必须等待/执行的时间长度，您可以控制它使用多少资源。

# java - 从 Java 中的后台线程触发主线事件

> ID：345823
> 
> 赞同：1
> 
> 时间：2008-12-06T03:05:35.260
> 
> 标签：java, multithreading, events

我的问题与 Java 中的多线程有关。我正在将我用 Visual Basic 2008 编写的应用程序翻译成 Java。VB 中有一个名为[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker_members.aspx)的类，它允许编码器在另一个线程上执行任务，这很像`SwingWorker`Java 中的。唯一明显的区别是，使用`BackgroundWorker`线程 is`run()`时，它会触发`DoWork()`在主线上调用的事件，其中包含要在后台执行的代码。此外，在代码执行`RunWorkerCompleted()`后，会在前台线程上触发一个事件以解释结果。

我发现该`BackgroundWorker`设置非常有用，而且它似乎比它更灵活一点`SwingWorker`，我只是想知道在 Java 中是否可以（并且可以接受）以相同的方式触发事件？如果是这样，我将如何去做？由于我只对 进行了快速扫描`SwingWorker`，因此它可能具有类似的功能也可以正常工作，在这种情况下，我很乐意知道这一点。

干杯，

胡普拉

编辑：

科尔。干杯伙计们，感谢您的及时回复，并为我的时间松懈的回复道歉。我会给你的想法奥斯卡，对不起 coobird，我没有完全遵循 - 欢迎任何进一步的解释（也许是一个例子）。

回顾一下：我想要一个可运行的类，我在我的代码中实例化一个实例。runnable 类有两个事件，一个从后台线程触发并包含在后台运行的代码 ( `DoWork()`)，另一个事件在后台线程完成其任务后在前台线程触发 ( `RunWorkerCompleted()`)。

如果我正确理解了你的建议，我可以`DoWork()`从可运行类的`run()`方法中触发事件，以便它在后台线程上执行，然后我可以使用该`SwingUtilities.invokeLater()`方法`RunWorkerCompleted()`在前台线程上触发事件，一旦后台线程已完成执行。

是的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T03:14:02.420

主线又是什么？

让我看看我是否做对了。

后台线程触发 GUI 可以拦截的事件以了解数据已准备好。

那是对的吗？

您可以使用 SwingUtilities.invokeLater( Runnable r );

在处理了当前在该线程中的所有事件之后，它将该可运行实例插入到 AWT 事件调度线程（我猜这与主线相同）中。

这样，您可以触发“actionPerformed”事件，注册的侦听器将正确处理。

让我快速编写一些代码，然后你告诉我这是否是你想要的。

同时[看看这里](http://java.sun.com/javase/6/docs/api/javax/swing/SwingUtilities.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T03:31:36.207

不完全确定这是否会有所帮助，但看看 Java 6 中的[SwingWorker](http://java.sun.com/javase/6/docs/api/javax/swing/SwingWorker.html)（它是新的，与以前的版本不同），以及有关此事的 Java 教程，它可能会提供与您可能追求的类似的东西。

查看Java 教程[的 Swing 中的并发部分，它有一个关于](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/index.html)[绑定属性和状态方法](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/bound.html)的部分，其中提到了将 a 注册`PropertyChangeListener`到`SwingWorker`. 这样，任何你想通知另一个线程的事件都可以`PropertyChangeEvent`通过方法创建 s来执行`firePropertyChange`。

[此外，请参阅Java SE 6](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/javase6/enhancements/)中的更多增强一文中关于 SwingWorker 现在包含部分的部分，以获取对上述内容的快速描述。

因此，如果我正确理解了文章的内容，首先，在应该将`PropertyListener`来自线程的消息发送到的线程上实现一个。`SwingWorker`然后，要将消息发送回原始线程，`SwingWorker`从其`doInBackground()`（使用该`firePropertyChange`方法）中触发的触发属性更改可以用作向另一个线程发送消息的手段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T04:04:37.950

以下代码的唯一目的是展示使用 SwingUtilities.invokeLater 方法时的外观。

效果是任务在 AWT-Event 线程（负责绘制组件的线程）中执行。

其余的（创建新线程、创建 gui 等）只是脚手架代码。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class InvokeLaterEffect {

    static JTextArea text = new JTextArea();

    // See the diff by commenting.
    static void done() {
        SwingUtilities.invokeLater( doneAction ); 
        //doneAction.run();
    }

    public static void main( String [] args ) {
        JFrame frame = new JFrame();
        frame.add( text );
        frame.pack();
        frame.setVisible( true );

        bacgroundTask.start();
    }
    // run a task in the background
    static Thread bacgroundTask = new Thread(){
        public void run(){
            try { 
                System.out.println( Thread.currentThread().getName() + " Started background task ");
                Thread.sleep( 5000 );
                System.out.println( Thread.currentThread().getName() + " Finished background task");
                done();
            } catch ( InterruptedException ie ){}
        }
    };

    // called whtn id done
    static Runnable doneAction = new Runnable(){
        public void run(){
            System.out.println( Thread.currentThread().getName() + " start setting text ");
            text.setText("Hello");
            System.out.println( Thread.currentThread().getName() + " finish setting text ");
        }
    };

} 
```

输出如下：

```
Thread-2 Started background task
Thread-2 Finished background task
AWT-EventQueue-0 start setting text
AWT-EventQueue-0 finish setting text 
```

# testing - 要求还是测试？

> ID：345825
> 
> 赞同：1
> 
> 时间：2008-12-06T03:09:14.957
> 
> 标签：testing, project-management, project-planning, requirements

如果你不得不在一个软件项目中没有一个或另一个，你会选择哪一个？我有很多项目，其中客户或 PM 认为他们可以在没有其中一个的情况下逃脱。我们总是付出代价。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-06T03:24:40.697

把它转过来，跟我重复一遍：“测试就是要求。” :-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-06T03:20:13.560

如果您的意思是“正式要求”，那么我可以轻松地做到这一点。我更喜欢有活力、有活力的客户，他们可以告诉我他们想要什么，而不是死板、过时的文件。切换到 TDD 后，我再也不想回到“无测试”环境。我选择非正式要求——故事、现场客户和客户书面验收测试——而不是正式要求并且不进行测试。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-06T03:15:06.550

我会说你可以不用测试而不是需求。如果你没有需求，你怎么知道你在开发什么？

如果程序员足够好，他们应该能够捕捉到测试会发现的大多数严重错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-06T03:38:01.747

您必须针对需求进行测试，因此如果您没有需求，则无法进行测试。所以如果你必须选择一个，你只能选择需求。

但是不做测试是通向失败的道路。保证。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-11T14:57:19.797

如果我*必须*选择一个，那将是要求。
它不必是一份正式的、极其详细的、有 20 个签名的文件，但你*必须*确切地知道客户*想要*什么，更重要的是知道客户**需要**什么。

这些要求也是您与开发团队的第一次沟通。如果你没有问清楚，他们怎么会知道你在问什么？充其量，您将面临正确构建错误事物的巨大风险。我宁愿把正确的东西建得稍有错误。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-07-07T23:55:22.073

如果让我在要求或测试之间做出选择，我会选择润色我的简历。在任何项目中你都不能没有，因为基本的项目生命周期是：

1.  定义需求/目标（AKA 要求）
2.  根据要求设计和建造
3.  验证您是否按照规范（根据要求）构建。

如果您没有可验证（然后经过验证）的成功标准和目标，您如何确保您会成功？如果你没有成功的机会，为什么要开始这个项目？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-06T03:30:54.210

我会说需求，因为当您开发软件时，客户端似乎总是存在某种程度的“功能蠕变”。测试是 SDLC 中的关键部分之一。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-06T03:38:54.553

需求和测试对于大多数项目来说都很重要，但如果你真的必须选择，你应该按照需求去做。与测试相比，选择需求的优点之一是，您可以节省一些开发时间，因为开发人员知道他们必须构建什么，并且如果开发是在手头有额外的时间完成的，您可以将这些时间分配给测试 :)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-06T06:23:36.250

测试（功能和集成）比需求更重要；如果您可以指定测试，那么您还指定了要求，至少是隐含的

注释也是开发人员文档，单元测试是“快速入门”示例；-)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-08T14:55:14.670

不确定这些需求是被称为人工制品还是过程。尽管可以将需求作为人工制品跳过，尤其是对于较小的团队并仍然交付产品，但作为流程跳过需求是不可能的。需求作为人工制品让您以低于构建整个事物的成本对系统进行建模，进行可行性、估计，并让一个更大、更分散的团队减少沟通开销，并在脚下有一个共同点。忽略要求，你会得到糟糕的估计（不管你是提前计划很多还是只是做一个短的冲刺），对可行性的想法很差，沟通可能非常低效，还有很多沟通不畅。

另一方面，作为一个过程的需求将存在，无论它是否被正式承认。你不能真正排除它，你可以假装需求过程不存在，或者集成到设计、编码、测试或直到试点和维护阶段。显然，以这种方式处理流程意味着它不会得到相当多的关注和资源。后果通常从交付最终无用的东西到必须在开发周期后期修复产品现在明显的缺点，甚至在产品在现场失败后发现真正的需求，增加开发成本，拖欠最后期限，破坏团队的好名声，破坏用户信心等。

测试通常归结为验证和验证，最近测试技术的改进让自动化测试成为一种可靠的工具，以实现更高的调试效率并减少回归测试所需的时间。验证是确保团队构建了正确的产品，即范围内的需求是正确的、不矛盾的并且没有差距。另一方面，验证是确保产品构建正确：没有技术缺陷、意外错误等。

正如我们所见，测试在忽略需求的情况下提供了一个安全网。通常，当团队开始测试时，他们需要完善对需求的理解，从而修改软件。由于需求人工制品和软件本身都代表了对现实生活问题的解决方案进行建模时不同级别的保真度，并且软件作为模型的数量级更精确，因此应用程序的测试也可以评估需求（无论它们是隐式的还是显式的） ，正式分析或非正式沟通）。

通常，测试的替代方法是让用户报告大量的缺陷和缺点，并尝试将它们作为维护的一部分进行修复（意味着在产品生命周期的后期），从而增加每次修复的成本。

那么需求与测试呢？解雇经理。好的，如果您希望项目进度在测试阶段滑落，并让自己陷入构建不是用户需要的混乱中，请跳过需求，如果您只是需要完全不尊重您的用户，请跳过测试。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-13T17:41:59.880

没有要求，您不需要测试，因为您最终得到的正是指定的

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-07-08T00:24:49.633

有一些类别的软件可以在没有要求的情况下完美地开发出来，至少不仅仅是一个模糊表达的想法，比如一封电子邮件的长度。

问题是，如果您有特定的客户和项目经理，那么您的软件不太可能在其中之一中。不太可能有人专门付钱给你，比如“让我做一个有趣的游戏，包括一只杂耍猴子”。

唯一无需测试即可开发的软件类别是故障软件：无论软件是否有效，您的公司已经设法吸引一些客户付费（或者如果您有一个*非常*愚蠢的客户，如果它不起作用，则支付更多费用，支持和维护）。

这可能更有可能：合同的结构使得成功比失败更不赚钱，这仍然相当普遍。如果您认为是这种情况，并且您想开发工作软件，那么请考虑切换到您的兴趣和老板之间的对立较少的工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-06-07T04:59:24.330

没有需求我们可以制定测试计划吗？因此，即使我们选择测试而不是需求，我们也无法进行测试。

因此，即使您考虑敏捷测试环境，也应该优先考虑需求。

# visualization - 可视化抽象概念（算法/数据结构）的最佳方式是什么？

> ID：345832
> 
> 赞同：2
> 
> 时间：2008-12-06T03:19:24.967
> 
> 标签：visualization, abstraction

在算法/数据结构中“查看正在发生的事情”的最佳方式是什么？如果它类似于二分搜索，我只是想象一堆盒子排成一排，每次都扔掉一半。有没有更强大的东西可以让我们理解像算法/数据结构这样抽象的东西？

澄清：我正在寻找更通用的东西。示例：为了可视化时间 - 有些人在头上使用时钟，但这很慢，而更自然的感觉是地球，如果您试图“感觉”算法的工作原理，您可以想象两个对象在那个地球上朝不同的方向移动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T03:25:55.390

一般来说，**动画**非常适合可视化随时间发生的过程，例如算法的执行。

例如，查看这些动画：[动画排序算法](http://www.inf.ethz.ch/personal/staerk/algorithms/SortAnimation.html)

[这是一个动画](http://www.cse.iitk.ac.in/users/dsrkg/cs210/applets/sortingII/mergeSort/mergeSort.html)，展示了数据结构如何在 MergeSort 上工作。

现在，您是否想花时间将您的算法与某种动画可视化联系起来是一个不同的问题！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T03:47:14.023

算法动画在 1990 年代是一个很大的研究领域。当时在数字系统研究中心工作的 Marc H. Brown 做了很多有趣的工作。[他的宙斯](http://dcvs.elegosoft.com/cgi-bin/cvsweb.cgi/m3/pm3/graphics/animation/zeus/?cvsroot=PM3)动画系统的源代码仍然可用，并且设置它并不难。几年前我和宙斯一起玩过，如果我没记错的话，它附带了几十个动画。

他们有几个“节日”，非专家聚集在一起为新算法制作动画。[您可以看到1993 年电影节](http://www.hpl.hp.com/techreports/Compaq-DEC/SRC-RR-126.html)的一份报告（带有静止图像）。YouTube 有一个他们的视频[Visualizing Combinatorial Structures](http://www.youtube.com/watch?v=EIOrizawnsc)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T03:31:32.307

用另一种事物来描述事物称为类比。您只是将二进制搜索作为一堆框来完成的。只玩学生的先验知识。

例如，树可以被认为是具有多个“下一个”节点的链表，或者可以将它们解释为类似于层次结构的东西。

至于具体的解释方法，图形和状态机可以很容易地用 Graphviz 可视化。一个非常基本的有向图可以非常简单地表示：

```
digraph G {
   A->B;
   B->C;
   C->D;
   D->B;
} 
```

# graphics - 球对球碰撞 - 检测和处理

> ID：345838
> 
> 赞同：274
> 
> 时间：2008-12-06T03:24:00.247
> 
> 标签：graphics, language-agnostic, collision-detection, physics

在 Stack Overflow 社区的帮助下，我编写了一个非常基本但有趣的物理模拟器。

![替代文字](https://i.stack.imgur.com/EeqSP.png)

您单击并拖动鼠标来发射一个球。它会反弹并最终停在“地板”上。

我要添加的下一个重要功能是球对球碰撞。球的运动被分解为 ax 和 y 速度矢量。我有重力（每一步 y 向量的小减少），我有摩擦（每次与墙壁碰撞时两个向量的小减少）。球以令人惊讶的逼真方式诚实地移动。

我想我的问题有两个部分：

1.  **检测球对球碰撞的最佳方法是什么？**
    我是否只有一个 O(n^2) 循环遍历每个球并检查每个其他球以查看其半径是否重叠？
2.  **我用什么方程来处理球对球的碰撞？物理 101**
    它如何影响两个球的速度 x/y 向量？两个球朝哪个方向飞去？我如何将其应用于每个球？

![替代文字](https://upload.wikimedia.org/wikipedia/commons/2/2c/Elastischer_sto%C3%9F_2D.gif)

处理“墙壁”的碰撞检测和由此产生的矢量变化很容易，但我看到球碰撞更复杂。对于墙壁，我只需要取适当的 x 或 y 向量的负值，然后它就会朝着正确的方向前进。对于球，我不认为是那样的。

一些快速澄清：为简单起见，我现在可以完全弹性碰撞，而且我所有的球现在都具有相同的质量，但我将来可能会改变它。

* * *

编辑：我发现有用的资源

带有向量的 2d Ball 物理：[2-Dimensional Collisions without Trigonometry.pdf](http://www.vobarian.com/collisions/2dcollisions2.pdf)
2d Ball 碰撞检测示例：[添加碰撞检测](http://geekswithblogs.net/robp/archive/2008/05/15/adding-collision-detection.aspx)

* * *

## 成功！

我的球碰撞检测和响应工作得很好！

相关代码：

碰撞检测：

```
for (int i = 0; i < ballCount; i++)  
{  
    for (int j = i + 1; j < ballCount; j++)  
    {  
        if (balls[i].colliding(balls[j]))  
        {
            balls[i].resolveCollision(balls[j]);
        }
    }
} 
```

这将检查每个球之间的碰撞但跳过冗余检查（如果您必须检查球 1 是否与球 2 碰撞，那么您不需要检查球 2 是否与球 1 碰撞。此外，它会跳过检查与自身的碰撞）。

然后，在我的球类中，我有我的 colliding() 和 resolveCollision() 方法：

```
public boolean colliding(Ball ball)
{
    float xd = position.getX() - ball.position.getX();
    float yd = position.getY() - ball.position.getY();

    float sumRadius = getRadius() + ball.getRadius();
    float sqrRadius = sumRadius * sumRadius;

    float distSqr = (xd * xd) + (yd * yd);

    if (distSqr <= sqrRadius)
    {
        return true;
    }

    return false;
}

public void resolveCollision(Ball ball)
{
    // get the mtd
    Vector2d delta = (position.subtract(ball.position));
    float d = delta.getLength();
    // minimum translation distance to push balls apart after intersecting
    Vector2d mtd = delta.multiply(((getRadius() + ball.getRadius())-d)/d); 

    // resolve intersection --
    // inverse mass quantities
    float im1 = 1 / getMass(); 
    float im2 = 1 / ball.getMass();

    // push-pull them apart based off their mass
    position = position.add(mtd.multiply(im1 / (im1 + im2)));
    ball.position = ball.position.subtract(mtd.multiply(im2 / (im1 + im2)));

    // impact speed
    Vector2d v = (this.velocity.subtract(ball.velocity));
    float vn = v.dot(mtd.normalize());

    // sphere intersecting but moving away from each other already
    if (vn > 0.0f) return;

    // collision impulse
    float i = (-(1.0f + Constants.restitution) * vn) / (im1 + im2);
    Vector2d impulse = mtd.normalize().multiply(i);

    // change in momentum
    this.velocity = this.velocity.add(impulse.multiply(im1));
    ball.velocity = ball.velocity.subtract(impulse.multiply(im2));

} 
```

源代码：[球对球对撞机的完整源代码。](https://www.dropbox.com/s/1j4aiu2aahjc19p/ballbounce.zip?dl=0)

如果有人对如何改进这个基本的物理模拟器有一些建议，请告诉我！我还没有补充的一件事是角动量，所以球会更真实地滚动。还有其他建议吗？发表评论！

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2008-12-06T03:50:15.763

要检测两个球是否碰撞，只需检查它们的中心之间的距离是否小于半径的两倍。要在球之间进行完美的弹性碰撞，您只需要担心碰撞方向上的速度分量。两个球的另一个组件（与碰撞相切）将保持不变。您可以通过创建一个指向从一个球到另一个球的方向的单位矢量来获得碰撞分量，然后将点积与球的速度矢量相乘。然后，您可以将这些分量代入一维完美弹性碰撞方程。

[维基百科对整个过程](http://en.wikipedia.org/wiki/Elastic_collision)有很好的总结。对于任何质量的球，新的速度可以使用以下公式计算（其中 v1 和 v2 是碰撞后的速度，u1、u2 是碰撞前的速度）：

![v_{1} = \frac{u_{1}(m_{1}-m_{2})+2m_{2}u_{2}}{m_{1}+m_{2}}](https://upload.wikimedia.org/math/a/b/6/ab6645eaf09c6da1ba47b0f662615140.png)

![v_{2} = \frac{u_{2}(m_{2}-m_{1})+2m_{1}u_{1}}{m_{1}+m_{2}}](https://upload.wikimedia.org/math/e/0/f/e0fa187fc3065bad45710620be5f7687.png)

如果球具有相同的质量，则只需切换速度。这是我写的一些代码，它做类似的事情：

```
void Simulation::collide(Storage::Iterator a, Storage::Iterator b)
{
    // Check whether there actually was a collision
    if (a == b)
        return;

    Vector collision = a.position() - b.position();
    double distance = collision.length();
    if (distance == 0.0) {              // hack to avoid div by zero
        collision = Vector(1.0, 0.0);
        distance = 1.0;
    }
    if (distance > 1.0)
        return;

    // Get the components of the velocity vectors which are parallel to the collision.
    // The perpendicular component remains the same for both fish
    collision = collision / distance;
    double aci = a.velocity().dot(collision);
    double bci = b.velocity().dot(collision);

    // Solve for the new velocities using the 1-dimensional elastic collision equations.
    // Turns out it's really simple when the masses are the same.
    double acf = bci;
    double bcf = aci;

    // Replace the collision velocity components with the new ones
    a.velocity() += (acf - aci) * collision;
    b.velocity() += (bcf - bci) * collision;
} 
```

至于效率，Ryan Fox 是对的，你应该考虑将区域划​​分为多个部分，然后在每个部分中进行碰撞检测。请记住，球可能会在部分边界上与其他球发生碰撞，因此这可能会使您的代码更加复杂。不过，在你有几百个球之前，效率可能并不重要。对于奖励积分，您可以在不同的核心上运行每个部分，或者在每个部分内拆分处理碰撞。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-12-19T09:44:04.157

好吧，几年前我制作了像你在这里介绍的程序。
有一个隐藏的问题（或许多，取决于观点）：

*   如果球的速度太高，你可能会错过碰撞。

而且，几乎在 100% 的情况下，您的新速度都是错误的。好吧，不是*速度*，而是*位置*。您必须在正确的位置*精确计算新速度。*否则，您只需在一些小的“错误”量上移动球，这可从上一个离散步骤中获得。

解决方案很明显：你必须拆分时间步长，首先你移动到正确的位置，然后碰撞，然后在剩下的时间里移动。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-12-06T03:43:14.467

您应该使用空间分区来解决这个问题。

阅读 [二进制空间分区](http://en.wikipedia.org/wiki/Binary_space_partitioning) 和 [四叉树](http://en.wikipedia.org/wiki/Quadtree)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-12-06T04:21:33.173

作为对 Ryan Fox 建议将屏幕分割成区域的建议的澄清，并且只检查区域内的碰撞......

例如，将游戏区域分成一个方格（可以任意说每边有 1 个单位长度），并检查每个方格内的碰撞。

这绝对是正确的解决方案。它的唯一问题（正如另一位海报指出的那样）是跨界碰撞是一个问题。

解决方案是在与第一个网格相距 0.5 单位的垂直和水平偏移处覆盖第二个网格。

然后，在第一个网格中跨越边界（因此未被检测到）的任何碰撞都将在第二个网格中的网格正方形内。只要您跟踪您已经处理过的冲突（因为可能存在一些重叠），您就不必担心处理边缘情况。所有碰撞都将在其中一个网格上的网格正方形内。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-06T03:39:25.520

减少碰撞检查次数的一个好方法是将屏幕分成不同的部分。然后，您只需将每个球与同一部分中的球进行比较。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-12-06T05:45:27.090

我在这里看到要优化的一件事。

虽然我确实同意当距离是它们的半径之和时球击中，但永远不应该实际计算这个距离！相反，计算它的平方并以这种方式使用它。没有理由进行昂贵的平方根运算。

此外，一旦发现碰撞，您必须继续评估碰撞，直到不再有碰撞为止。问题是第一个问题可能会导致其他问题，在您获得准确的图片之前必须解决这些问题。考虑一下如果球在边缘撞到球会发生什么？第二个球击中边缘并立即反弹到第一个球中。如果你撞到角落里的一堆球，你可能会遇到很多必须解决的碰撞，然后才能迭代下一个循环。

至于 O(n^2)，你所能做的就是最小化拒绝那些错过的成本：

1) 一个不动的球不能击中任何东西。如果地板上有合理数量的球，这可以节省大量测试。（请注意，您仍然必须检查是否有东西击中了静止的球。）

2）可能值得做的事情：将屏幕划分为多个区域，但线条应该是模糊的——区域边缘的球被列为所有相关（可能是 4 个）区域。我会使用 4x4 网格，将区域存储为位。如果两个球区域的区域与返回零，则测试结束。

3）正如我所提到的，不要做平方根。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-12-11T22:46:34.437

我找到了一个很棒的页面，其中包含有关 2D 碰撞检测和响应的信息。

[http://www.metanetsoftware.com/technique.html (web.archive.org)](http://web.archive.org/web/20100222200225/http://www.metanetsoftware.com/technique.html)

他们试图从学术的角度解释它是如何完成的。他们从简单的对象到对象的碰撞检测开始，然后转向碰撞响应以及如何扩大它。

**编辑：**更新链接

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-06T05:03:55.613

你有两种简单的方法来做到这一点。杰伊已经涵盖了从球中心检查的准确方法。

更简单的方法是使用矩形边界框，将框的大小设置为球大小的 80%，这样就可以很好地模拟碰撞。

向你的球类添加一个方法：

```
public Rectangle getBoundingRect()
{
   int ballHeight = (int)Ball.Height * 0.80f;
   int ballWidth = (int)Ball.Width * 0.80f;
   int x = Ball.X - ballWidth / 2;
   int y = Ball.Y - ballHeight / 2;

   return new Rectangle(x,y,ballHeight,ballWidth);
} 
```

然后，在你的循环中：

```
// Checks every ball against every other ball. 
// For best results, split it into quadrants like Ryan suggested. 
// I didn't do that for simplicity here.
for (int i = 0; i < balls.count; i++)
{
    Rectangle r1 = balls[i].getBoundingRect();

    for (int k = 0; k < balls.count; k++)
    {

        if (balls[i] != balls[k])
        {
            Rectangle r2 = balls[k].getBoundingRect();

            if (r1.Intersects(r2))
            {
                 // balls[i] collided with balls[k]
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-05-13T16:57:44.907

我看到它在这里和那里暗示，但您也可以先进行更快的计算，例如比较边界框的重叠，然后在第一次测试通过时进行基于半径的重叠。

边界框的加法/差分数学比半径的所有三角要快得多，并且大多数情况下，边界框测试将排除碰撞的可能性。但是，如果您随后使用 trig 重新测试，您将获得您正在寻找的准确结果。

是的，这是两个测试，但总体上会更快。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-07-22T19:05:00.207

这[`KineticModel`](http://sites.google.com/site/drjohnbmatthews/kineticmodel)是在 Java中[引用的方法的实现。](http://www.vobarian.com/collisions/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-10-05T23:32:47.447

我使用 HTML Canvas 元素在 JavaScript 中实现了这段代码，它以每秒 60 帧的速度产生了精彩的模拟。我以随机位置和速度的十几个球的集合开始模拟。我发现在更高的速度下，一个小球和一个大得多的球之间的碰撞会导致小球看起来**粘**在大球的边缘，并在分离之前围绕大球移动了大约 90 度。（我想知道是否有其他人观察到这种行为。）

一些计算记录表明，在这些情况下，最小平移距离不足以防止相同的球在下一个时间步发生碰撞。我做了一些实验，发现我可以通过根据相对速度扩大 MTD 来解决这个问题：

```
dot_velocity = ball_1.velocity.dot(ball_2.velocity);
mtd_factor = 1\. + 0.5 * Math.abs(dot_velocity * Math.sin(collision_angle));
mtd.multplyScalar(mtd_factor); 
```

我验证了在此修复之前和之后，每次碰撞的总动能都是守恒的。mtd_factor 中的 0.5 值大约是发现在碰撞后总是导致球分离的最小值。

尽管此修复在系统的确切物理特性中引入了少量错误，但权衡是现在可以在浏览器中模拟非常快的球，而不会减少时间步长。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-07-01T06:56:47.483

通过问题中给出的圆碰撞检测改进检测圆的解决方案：

```
float dx = circle1.x - circle2.x,
      dy = circle1.y - circle2.y,
       r = circle1.r + circle2.r;
return (dx * dx + dy * dy <= r * r); 
```

它避免了不必要的“如果有两个返回”和使用比必要更多的变量。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-09-23T07:50:39.720

经过反复试验，我使用了本文档的 2D 碰撞方法：[https](https://www.vobarian.com/collisions/2dcollisions2.pdf) ://www.vobarian.com/collisions/2dcollisions2.pdf （OP 链接到）

我在一个使用 p5js 的 JavaScript 程序中应用了它，它运行良好。我之前曾尝试使用三角方程，虽然它们确实适用于特定的碰撞，但无论发生的角度如何，我都找不到适用于每次碰撞的三角方程。

本文档中解释的方法不使用任何三角函数，它只是简单的矢量运算，我向任何尝试实现球对球碰撞的人推荐这个，根据我的经验，三角函数很难推广。我请我大学的一位物理学家教我怎么做，他告诉我不要打扰三角函数，并向我展示了一种类似于文档中链接的方法。

注意：我的质量都是相等的，但这可以使用文档中提供的方程式推广到不同的质量。

这是我用于计算碰撞后产生的速度向量的代码：

```
 //you just need a ball object with a speed and position vector.
    class TBall {
        constructor(x, y, vx, vy) {
            this.r = [x, y];
            this.v = [0, 0];
        }
    }

    //throw two balls into this function and it'll update their speed vectors
    //if they collide, you need to call this in your main loop for every pair of 
    //balls.
    function collision(ball1, ball2) {
        n = [ (ball1.r)[0] - (ball2.r)[0], (ball1.r)[1] - (ball2.r)[1] ];
        un = [n[0] /  vecNorm(n), n[1] / vecNorm(n) ] ;
        ut = [ -un[1], un[0] ];   
        v1n = dotProd(un, (ball1.v));
        v1t = dotProd(ut, (ball1.v) );
        v2n = dotProd(un, (ball2.v) );
        v2t = dotProd(ut, (ball2.v) );
        v1t_p = v1t; v2t_p = v2t;
        v1n_p = v2n; v2n_p = v1n;
        v1n_pvec = [v1n_p * un[0], v1n_p * un[1] ]; 
        v1t_pvec = [v1t_p * ut[0], v1t_p * ut[1] ]; 
        v2n_pvec = [v2n_p * un[0], v2n_p * un[1] ]; 
        v2t_pvec = [v2t_p * ut[0], v2t_p * ut[1] ];
        ball1.v = vecSum(v1n_pvec, v1t_pvec); ball2.v = vecSum(v2n_pvec, v2t_pvec);
    } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-08-20T16:23:00.990

如果您有大量球，我会考虑使用四叉树。为了确定反弹的方向，只需使用基于碰撞法线的简单能量守恒公式。弹性、重量和速度会让它更真实一些。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-07-27T02:10:24.443

这是一个支持质量的简单示例。

```
private void CollideBalls(Transform ball1, Transform ball2, ref Vector3 vel1, ref Vector3 vel2, float radius1, float radius2)
{
    var vec = ball1.position - ball2.position;
    float dis = vec.magnitude;
    if (dis < radius1 + radius2)
    {
        var n = vec.normalized;
        ReflectVelocity(ref vel1, ref vel2, ballMass1, ballMass2, n);

        var c = Vector3.Lerp(ball1.position, ball2.position, radius1 / (radius1 + radius2));
        ball1.position = c + (n * radius1);
        ball2.position = c - (n * radius2);
    }
}

public static void ReflectVelocity(ref Vector3 vel1, ref Vector3 vel2, float mass1, float mass2, Vector3 intersectionNormal)
{
    float velImpact1 = Vector3.Dot(vel1, intersectionNormal);
    float velImpact2 = Vector3.Dot(vel2, intersectionNormal);

    float totalMass = mass1 + mass2;
    float massTransfure1 = mass1 / totalMass;
    float massTransfure2 = mass2 / totalMass;

    vel1 += ((velImpact2 * massTransfure2) - (velImpact1 * massTransfure2)) * intersectionNormal;
    vel2 += ((velImpact1 * massTransfure1) - (velImpact2 * massTransfure1)) * intersectionNormal;
} 
```

# iphone - 注册 iPhone 开发者计划需要多长时间？

> ID：345862
> 
> 赞同：7
> 
> 时间：2008-12-06T03:48:30.337
> 
> 标签：iphone

支付 99 美元后，注册 iPhone 开发者计划需要多长时间？

付款后有什么事情要做吗？（我的意思是文书工作、传真或发送实物）

Apple 将如何支付您的收入？（以什么形式和间隔，如果你不在美国，他们会做什么？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-06T03:52:43.217

在 99 美元之后大约 1 周 - 可能会少一点或多一点。

是的，您必须管理证书和规定。此外，您必须提交您的联系方式、税务和银行信息。不过没什么复杂的——只是标准的东西。

Apple 通过将资金存入您的银行帐户并提供详细的销售报表来付款。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T00:25:52.633

如果您的联系地址与信用卡账单地址不同，您可能还需要将您的护照/身份证复印件传真给他们。

# asp.net - 在 asp.net 中插入后获取主键（visual basic）

> ID：345865
> 
> 赞同：2
> 
> 时间：2008-12-06T03:52:44.777
> 
> 标签：asp.net, vb.net, ms-access, insert

我正在添加这样的记录：

```
 Dim pathString As String = HttpContext.Current.Request.MapPath("Banking.mdb")
    Dim odbconBanking As New OleDbConnection _
             ("Provider=Microsoft.Jet.OLEDB.4.0;" & _
             "Data Source=" + pathString)
    Dim sql As String
    sql = "INSERT INTO tblUsers ( FirstName, LastName, Address, City, Province, Zip, Phone, UserName, [Password])" & _
              " VALUES ('" & firstName & "', '" & lastName & "', '" & address & _
            "', '" & city & "', '" & province & "', '" & zip & "', '" & phone & "', '" & username & "', '" & password & "');"
    odbconBanking.Open()
    Dim cmd As New OleDbCommand(sql, odbconBanking)
    cmd.ExecuteNonQuery()
    odbconBanking.Close() 
```

主键是一个名为 UserID 的自动编号字段。那么，如何获取刚刚插入的记录的主键呢？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T05:41:08.067

我相信参数化查询看起来像这样：

```
Dim pathString As String = HttpContext.Current.Request.MapPath("Banking.mdb")
Dim odbconBanking As New OleDbConnection _
     ("Provider=Microsoft.Jet.OLEDB.4.0;" & _
     "Data Source=" + pathString)
Dim sql As String
sql = "INSERT INTO tblUsers ( FirstName, LastName, Address, City, Province, Zip, Phone, UserName, [Password])" & _
      " VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?);"
odbconBanking.Open()
Dim cmd As New OleDbCommand(sql, odbconBanking)

//Add Params here
cmd.Parameters.Add(new OdbcParameter("@FirstName", firstName))
cmd.Parameters.Add(new OdbcParameter("@LastName", lastName))
//..etc

//End add Params here

cmd.ExecuteNonQuery()
Dim newcmd As New OleDbCommand("SELECT @@IDENTITY", odbconBanking)
uid = newcmd.ExecuteScalar

odbconBanking.Close() 
```

我的语法可能有点偏离，因为我更习惯于使用 Sql Server 库而不是 Odbc 库，但这应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-06T03:57:49.867

`"SELECT @@IDENTITY"`插入后应与 Microsoft.Jet Provider 一起使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T03:58:08.773

你会想要添加

```
;select scope_identity(); 
```

查询后，运行 executeScalar 以取回值。

另外，在一个完全不相关的注释中，您确实应该更改代码以使用参数化查询，这样您就不会陷入 SQL 注入攻击，或者由于连接到您的 sql 语句中的不正确转义字符串而导致崩溃。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-06T04:05:41.927

知道了。上面的代码现在是这样的：

```
 Dim pathString As String = HttpContext.Current.Request.MapPath("Banking.mdb")
    Dim odbconBanking As New OleDbConnection _
             ("Provider=Microsoft.Jet.OLEDB.4.0;" & _
             "Data Source=" + pathString)
    Dim sql As String
    sql = "INSERT INTO tblUsers ( FirstName, LastName, Address, City, Province, Zip, Phone, UserName, [Password])" & _
              " VALUES ('" & firstName & "', '" & lastName & "', '" & address & _
            "', '" & city & "', '" & province & "', '" & zip & "', '" & phone & "', '" & username & "', '" & password & "');"
    odbconBanking.Open()
    Dim cmd As New OleDbCommand(sql, odbconBanking)
    cmd.ExecuteNonQuery()
    Dim newcmd As New OleDbCommand("SELECT @@IDENTITY", odbconBanking)
    uid = newcmd.ExecuteScalar

    odbconBanking.Close() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T15:54:54.660

最简单的方法是在代码级别生成您的 uniqueIdentifier 值，将其添加到您的字符串并将其发送到服务器。

```
Dim sql As String, _
    myNewUserId as variant

myNewUserId = stGuidGen    'this function will generate a new GUID value)'
sql = "INSERT INTO tblUsers ( userId, LastName)" & _
      " VALUES ('" & myNewUserId & "','" & LastName);" 
```

您可以在[此处查看](http://www.trigeminal.com/code/guids.bas)**stGuidGen** guid 生成代码的建议。

这种客户端技术清晰、干净且有用

# awk - 使用正则表达式对整个记录进行 awk 匹配

> ID：345874
> 
> 赞同：1
> 
> 时间：2008-12-06T04:00:39.440
> 
> 标签：awk, gawk

使用 awk 我想使用正则表达式匹配*整个记录。*默认情况下，正则表达式匹配是针对记录的一部分。

理想的解决方案是：

*   无论使用何种字段分隔符，对所有字段都是通用的。
*   不要将整个输入视为单个字段并使用字符串函数手动解析它。
*   例如，以一般方式工作，而不是特定于 gawk。

然而，任何和所有的解决方案都是有意义的，只要它们**使用 Awk 而不调用外部程序**。

一个例子，我有：

```
$ ls
indata.txt  t1.awk
$ cat indata.txt 
a1010_
1010_
1010_b
$ cat t1.awk 
/[01]*_[01]*/ { print $0 } 
```

我得到：

```
$ awk -f t1.awk indata.txt
a1010_
1010_
1010_b 
```

这是我正在寻找的结果：

```
$ awk -f t1.awk indata.txt
1010_ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T04:21:52.003

您只需要在您的正则表达式中添加一个开始和结束锚点：

```
/^[01]*_[01]*$/ { print $0 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T04:23:06.633

```
$ gawk '/^[01]*_[01]*$/' indata.txt
1010_ 
```

# c# - 为什么 VS 2008 在 Intellisense 中不显示 String 类的扩展方法

> ID：345883
> 
> 赞同：13
> 
> 时间：2008-12-06T04:04:55.827
> 
> 标签：c#, visual-studio-2008, string, extension-methods, intellisense

由于 String implements `IEnumerable<char>`，我期待在 Intellisense 中看到 Enumerable 扩展方法，例如，在输入句点时

```
String s = "asdf";
s. 
```

我期待看到`.Select<char>(...)`,`.ToList<char>()`等。然后我惊讶地发现扩展方法实际上**确实**适用于字符串类，它们只是没有出现在 Intellisense 中。有人知道为什么是这样吗？这可能与[这个](https://stackoverflow.com/questions/295287/how-can-i-prevent-a-public-class-that-provides-extension-methods-from-appearing)问题有关。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-06T04:10:57.843

这是通过明确的设计。问题是，虽然 String 最明确地实现了`IEnumerable<T>`，但大多数人并没有想到它，或者更重要的是，以这种方式使用它。

String 有相当少的方法。最初我们没有过滤掉 String 的扩展方法，结果是很多负面反馈。通过正确的导入，有时方法的数量几乎增加了两倍。由于显示了所有扩展方法，人们经常无法在噪音中看到他们正在寻找的 String 方法。

String 是一个......简单的类型，最好以这种方式查看它:)

仍然完全可以在字符串上调用扩展方法。它可能不会出现在智能感知中。

编辑： String 实际上有很多方法。但是因为它们中的许多都是重载，所以它们在智能感知中崩溃了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-01T09:30:47.713

For info, this has changed in VS2010 (in beta 2, at least). It looks like this filtering has been removed (presumably it caused too much confusion), and the methods are now visible, along with the extension-method glyph.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-12-10T05:07:01.940

它应该。

```
For example you can write it public static string myExtensionMethod(this String yuppi){
} 
```

那么它应该在那里。

# certificate - 1 类和 3 类根以及它们签署的证书有什么区别？

> ID：345892
> 
> 赞同：8
> 
> 时间：2008-12-06T04:16:00.483
> 
> 标签：certificate, pki, certificate-authority

问题说的差不多。这两类根有什么区别？这些根签署的证书之间的区别？1 类签名证书有什么用途，而 3 类没有，反之亦然？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-02-15T00:59:53.673

[对于 VeriSign， Wikipedia 给出](https://en.wikipedia.org/wiki/Public_key_certificate#Classification)了一个微薄但明确的答案，并引用了 Symantec（购买了 Verisign 的证书业务）页面作为其来源。

> 用于个人的 1 类，用于电子邮件。
> 
> 需要身份证明的组织的第 2 类。
> 
> 服务器和软件签名的第 3 类，其身份和权限的独立验证和检查由颁发证书颁发机构完成。
> 
> 第 4 类，适用于公司之间的在线业务交易。
> 
> 5 级，用于私人组织或政府安全。

补充一点，

> 其他供应商可能会选择使用不同的类或根本不使用类，因为这在 PKI 标准中没有指定。

所以最好、最可靠、唯一权威的资源是证书供应商的站点定义。对于**CACert**，Andrew Rollings 的回答是完整的，第二个来源可以在[CACert 的技术常见问题解答中找到](https://wiki.cacert.org/FAQ/TechnicalQuestions#What_is_the_difference_between_Class_1_and_Class_3_Certificates)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-06T04:24:36.537

3 类根证书是 CAcert 1 类根证书的高安全子集。

1 类是 CAcert 的“普通”和较旧的根证书。它包括低安全性和高安全性证书。由于可能无法将 1 类证书包含在某些浏览器或发行版中，因此引入了 3 类证书。3 类根证书仅包括高安全性证书，是 1 类证书的子集。

一般来说：3 类证书将来可能会集成到更多的浏览器和发行版中，而 1 类证书可能适用于更多，尤其是较旧的浏览器。

（见[http://www.luga.at/mailing-lists/luga/2006/02/msg00109.html](http://www.luga.at/mailing-lists/luga/2006/02/msg00109.html)）

# labview - 如何在高速率采集多通道数据时定期更新 Labview 图表

> ID：345893
> 
> 赞同：1
> 
> 时间：2008-12-06T04:16:24.697
> 
> 标签：labview, daq-mx

寻求有关 Labview 数据收集程序的帮助。如果我可以在每个通道以 8kHz（提供 16 个数据点）收集 2ms 的数据（我正在使用 National Instruments 数据采集板在 4 个模拟通道上收集数据）。DAQ-MX 采集任务提供 4 个波形的一维数组。

如果我不显示数据，我可以做的所有计算时间大约是 2 毫秒，如果处理循环稍微落后于收集循环，那也没关系。在 Labview 的前面板中更新图表会引入不可接受的延迟。我们不需要非常快速地更新显示，可能 5-10Hz 就足够了。但我不知道如何设置。

我当前的 Labview VI 有三个并行循环

1.  用于数据收集的定时循环
2.  用于分析和处理的循环
3.  用于将数据作为 TDMS 文件缓存到磁盘的低优先级循环

使用队列将数据从收集循环传递到其他循环。Labview 的例子给了我一些想法，但我被卡住了。

任何建议、参考、想法将不胜感激。

谢谢

阿齐姆

***跟进问题***

eaolson 建议我重新采样数据以进行显示。来自 DAQ-MX 读取的数据是一维波形数组。所以我需要以某种方式构建或连接每个通道的波形数据。然后在更新前面板图表之前重新采样数据。我想最好的方法是对数据进行排队，并在显示循环中将堆栈构建出列并根据屏幕分辨率重新采样数据，然后更新图表。有没有其他办法。我将在（NI Labview 论坛）[ [http://forums.ni.com/ni/board?board.id=170]](http://forums.ni.com/ni/board?board.id=170])上查看 eaolson 建议的更多信息。

***更新***

1.  将图表的可接受更新率更改为 5-10Hz（感谢 Underflow 和 eaolson）
2.  磁盘缓存循环是低优先级的（感谢 eaolson）
3.  感谢所有的回复。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T05:25:41.453

您的整体架构描述听起来很可靠，但是......对于任何非平凡的图来说，达到 30Hz 都将是一个挑战。在尝试实现它之前，请确保您*确实需要该速率。*优化到该级别可能需要一些时间。

**应该有帮助的参考资料：**

您可以[推迟面板更新](http://zone.ni.com/reference/en-XX/help/371361E-01/lvprop/pnl_defer_pnl_updts/)。这可以防止前面板刷新，直到您准备好这样做，允许您在后台缓冲数据，并且只偶尔绘制它。

您应该了解[（a）同步显示](http://forums.ni.com/ni/board/message?board.id=170&message.id=213981)。此选项允许对显示速率进行一些控制。

有一些关于加快执行速度的[一般建议。](http://zone.ni.com/reference/en-XX/help/371361E-01/lvconcepts/vi_execution_speed/)

LAVA 论坛上有一份（有些过时的）关于执行速度的[报告。](http://forums.lavag.org/Chart-and-Graph-Performance-Report-t2646.html&mode=linear)如果您需要优化速度，在 LAVA 论坛上进行谷歌搜索是一个好主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T16:17:35.863

电视以大约 30 Hz 的频率更新。任何超过这个速度的速度都超过了人眼所能看到的速度。30 Hz 应该是您应该为显示器考虑的最大更新速率，而不是起点。考虑 5-10 Hz 的更新率。

[LabVIEW图表](http://zone.ni.com/reference/en-XX/help/371361B-01/lvconcepts/types_of_graphs_and_charts/)将最新数据附加到它们存储的历史数据中，并一次显示所有数据。在 8 kHz 时，您每通道每秒至少采集 8000 个数据点。这意味着支持该图的数组必须不断调整大小以保存新数据。此外，即使您的图表跨度为 1000 像素，这也意味着每个屏幕像素显示 8 个数据点。通常没有任何理由每个像素显示一个以上的数据点。如果您真的需要快速更新率，请绘制更少的数据。创建一个数组来保存历史数据并仅绘制每个第 N 个数据点，其中 N 被选择，因此您仅绘制几百个点。

请记住，您的循环可以以不同的速率运行。以比数据收集率低得多的频率运行写入磁盘循环可能会令人满意，可能每隔几秒钟运行一次。

如果可以，请避免使用[属性节点。](http://zone.ni.com/reference/en-XX/help/371361A-01/glang/property_node/)它们在 UI 线程中运行，这比大多数其他执行要慢。

除此之外，如果没有看到代码或更多细节，很难提供很多实质性的建议。[还可以考虑在NI LabVIEW 论坛上](http://forums.ni.com/ni/board?board.id=170)提问。那里有很多乐于助人的人。

# asp.net - 您可以使用 jQuery 连接到 .NET Web 服务吗？

> ID：345896
> 
> 赞同：3
> 
> 时间：2008-12-06T04:20:00.680
> 
> 标签：asp.net, jquery, web-services

是否可以使用 jQuery 连接到 .NET 网络服务？也许我也可以传递一个 wsdl url。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-06-11T04:20:08.023

由于不太可能有人会回答，所以我将尽我所能将人类的知识反向链接起来。

[该线程](https://stackoverflow.com/questions/230401/how-to-use-jquery-to-call-an-asp-net-web-service)专门针对 ASP.NET，但与答案所建议的内容会有重叠。

# apache - 删除阿帕奇

> ID：345897
> 
> 赞同：2
> 
> 时间：2008-12-06T04:20:01.477
> 
> 标签：apache, macos, sysadmin

我在我的 Mac OS X 10.5 上安装了多个 apache，并希望删除它们，包括任何依赖项。

它们安装在 3 个不同的目录中。

如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T08:01:37.377

男人。OSX 带有 Apache。那么为什么以及如何安装另外两个？

我希望您使用 MacPorts 安装其他 2 个（如果您这样做，它们必须是不同的版本）。然后这是一个简单的过程。除此之外，您必须手动移除。确保您不想要的安装不随系统启动。然后删除目录。

另外，看看 [MAMMP](http://www.mamp.info/en/index.php)。是的，它带有 PHP 和 MYSQL，但它们可以停止（关闭）。而且它很容易删除 - 只需删除文件夹即可。

# winforms - winforms的动态数据

> ID：345915
> 
> 赞同：2
> 
> 时间：2008-12-06T04:33:10.840
> 
> 标签：winforms, scaffolding

我玩过动态数据网站。winforms有没有类似的东西。如果没有任何东西可以用winforms做同样的事情，那么问题是为什么不呢？我们有一个庞大的 ERP 应用程序，我们希望将其从 AS400 迁移到 .Net Winform 应用程序。我最初的想法是让所有维护都像动态数据网站项目一样简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-12T18:01:33.550

动态数据使您可以轻松地在网络上编辑您的数据库。对于桌面（和 Web）应用程序，请查看新的 Microsoft LightSwitch：

[http://msdn.microsoft.com/en-us/lightswitch/gg441300](http://msdn.microsoft.com/en-us/lightswitch/gg441300)

LightSwitch 不使用 Windows 窗体。相反，它创建了一个可以在桌面和 Web 上运行的 Silverlight 应用程序。很酷。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-21T12:01:59.463

我认为 WPF 将是一个比 WinForms 更好的起点，因为它支持样式来说明数据项的显示方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T13:17:37.460

Dynamic data is using the routing functionality of the MVC framework. In Windows forms we don't have this approach of fetching data with URLs from a server.
I am not sure how this model could fit into Windows forms.

I think it's pretty hard to create something like dynamic data for Windows Forms.
My biggest concern is here, once you created that Framework, how do you configure it? I mean if you want to change 1 form to be a bit different than the others :-)

I think its better to generate Forms for the various tables in the Database context, using a powerful Grid control from one of the big vendors. And then you can configure those.

**Remember** this is a different approach then the dynamic data one, where no code is generated before compile time

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-20T18:20:19.913

尽管动态数据看起来简单且便宜到足以访问数据库，但它无论如何都不适用于 ERP 系统。业务系统不仅仅是在数据库和用户界面之间移动数据，它们在保存数据时需要业务规则操作，而在检索数据时可能需要一些按摩以确保有意义地呈现存储优化数据。

如果您仍然喜欢使用此选项，那么创建一个构建在 Entity Framework 之上的应用程序将非常容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-18T18:26:43.480

我认为您在 winform 应用程序中看不到类似内容的原因是因为将 HTML 页面存储在数据库中然后在使用 Web 应用程序时将其显示在正确格式化的屏幕上要容易得多，因为您的浏览器知道如何格式化HTML。

您必须存储在数据库中，知道每个标签和字段将以某种坐标方式在表单上的位置（或者您可以使用布局第 3 方控件），但是可能需要的工作量是乏味地做正确。

我工作的动态数据网站没有接受用户的输入。它只向用户显示不同的网页，并允许管理员轻松更改内容。如果您希望用户能够保存数据，那么这将更加复杂，因为您必须担心验证、必填字段等。

如果您有很多用户需要根据他们的访问级别查看不同的信息，那么我建议在数据库中创建一个表来告诉系统他们是否应该看到表单上的字段。然后使用第 3 方布局面板来格式化可见字段。

我的 2 美分

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-24T13:50:03.240

我不知道类似动态数据的，但是（在几年前为 ASP 写过一个）我实际上并不认为它会*那么*难，特别是在 WPF 及其模板支持的情况下。

实际上，如果您真的很聪明，您可能可以从动态数据中“借用”后端，并将 UI 重新实现为 WPF。

实际上会做一个有趣的小项目。

替代答案：使用 Microsoft Access。不完全是。替代答案#2：那么为什么不直接使用动态数据呢？

# vba - 需要骨架代码从 PythonWin 调用 Excel VBA

> ID：345920
> 
> 赞同：2
> 
> 时间：2008-12-06T04:36:50.740
> 
> 标签：vba, excel, com, pywin32

我需要从 python 脚本调用 Excel 工作簿中的 VBA 宏。其他人为 Excel 工作簿提供了宏。该宏从外部数据库中获取更新的值，并对数据执行一些相当复杂的处理。我需要这个按摩的结果，如果可以避免的话，我真的不想在我的 Python 脚本中复制它。所以，如果我可以从我的脚本中调用宏并获取按摩结果，那就太好了。

我从“Win32 上的 Python 编程”中学到的关于 COM 的一切。好书，但不足以完成我手头的任务。我搜索了，但没有找到任何关于如何做到这一点的好例子。有没有人有任何好的例子，或者可能有一些关于如何寻址/调用 VBA 宏的骨架代码？Excel COM 接口上的一般参考资料（书籍、网络链接等）在这里也会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T15:56:33.723

好，我知道了！感谢您对 Application.Run 方法的帮助。此信息，加上“Microsoft Excel Visual Basic 参考”： http: [//msdn.microsoft.com/en-us/library/aa209782](http://msdn.microsoft.com/en-us/library/aa209782(office.10).aspx) (office.10).aspx——正如 Hammond & Robinson 在“Python Programming on Win32"——正是我们所需要的。

这是骨架代码：

```
import win32com.client
xl=win32com.client.Dispatch("Excel.Application")
xl.Workbooks.Open(Filename="<your Excel File>",ReadOnly=1)
xl.Application.Run("<your macro name>")
#...access spreadsheet data...
xl.Workbooks(1).Close(SaveChanges=0)
xl.Application.Quit()
xl=0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T06:01:41.503

对不起，我对python不够了解。但是，以下内容应该会有所帮助。

Excel 的 Application 对象有一个 Run 方法 - 它采用宏的名称及其参数。

让我们假设工作簿有一个名为 test 的宏。

```
 Sub test(ByVal i As Integer)
MsgBox "hello world " & i
End Sub 

```

您可以使用 Application.Run "test", 1234 调用它

这将调用宏并显示带有“hello world 1234”的消息框。

# clr - 再次告诉我为什么我们需要 .NET 和 Windows？为什么 Windows 不能变身为 CLR？

> ID：345924
> 
> 赞同：6
> 
> 时间：2008-12-06T04:41:22.773
> 
> 标签：clr

DOS演变成Windows的方式相同吗？

我们似乎最终支持和开发了微软的三个平台，我不确定界限应该在哪里。

为什么不能将 CLR 的好处（例如类型安全、内存保护等）内置到 Windows 本身中？

还是进入浏览器？为什么要使用完全不同的虚拟机？（我们现在如何处理虚拟机间接级别？我们刚刚添加了 Silverlight - 并且在此之前的 Flash - 在浏览器中运行，在其中运行可能是 VM 安装......）

我可以看到用于服务器的原始 Windows，但为什么不能有一个用于工作站的 CLR 直接与硬件对话（或者至少不是整个 Windows 遗留系统）？

（ooppp - 我这里有两个问题。让我们做这个 - 为什么不能将 .net 内置到 Windows 中？我了解向后兼容性 - 但是 .NET 中的安全性至少可以在 Windows 本身中选择，不能不是吗？它只是许多 API 集合中的另一个？）

Factoid - 我记得 IBM PC 上针对 MS-DOS 销售的竞争对手架构之一是 UCSD-pascal 运行时 - 一个 VM。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-06T05:10:07.647

我们不要忘记 DOS 并没有演变成 Windows，至少不是我们今天所知道和喜爱的 Windows。DOS 是操作系统，Windows 3.1 是位于所述操作系统之上的 GUI 外壳。

当 Windows 95 出现时，确实不再有标有“Microsoft DOS”的盒装产品，但 Windows 95 在架构上是带有 GUI 外壳的 DOS 7.0。

这一直持续到 Win98 和 WinME（又名 Win9X）。

我们今天所知道的 Windows（XP、Vista、2003、2008）的核心来自 Windows NT 项目，这是一个完全独立的野兽。（尽管 NT 被设计为与 3.1 和更高版本的 9x 二进制文件兼容，并且使用了几乎相同但扩展的 API。）

DOS 演变成我们熟悉的 Windows 就像最初的 Linux 核心演变成 KDE 一样。

只要有针对 Windows 原生构建且仍处于支持周期的产品，这两个 API 就需要继续共存。考虑到 Windows API 仍然存在于 Windows Server 2008 和 Windows 7 中，这意味着至少 2017 年。说实话，它可能会更长，因为虽然托管代码是一件很棒的事情，但它并不总是最合适/最好的答案。

另外……作为一名程序员，你应该比任何人都清楚：做某事从来没有从外面看起来那么容易！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-06T09:31:08.273

Windows 包含数百万行代码，其中大部分是 C 语言。这代表了长达数十年的巨大投资。它一直在为今天的用户维护（修复）。在他们用 C# 重写每一行十年，然后再调试和优化另外十年，而不完全破坏他们的业务的情况下，完全不可能阻止这个世界。

一些现有的代码理论上可以编译为在 CLR 上运行，但这样做不会获得任何好处。将 C 的大部分子集编译到 CLR 是可能的（使用 C++/CLI 编译器），但它不会自动启用垃圾收集，例如。你必须从头开始重新设计才能做到这一点。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-06T05:09:39.473

好吧，CLR 不是一个操作系统。这是为什么不这样做的一个很大的原因......我的意思是即使是研究操作系统，Singularity，也不仅仅是 CLR。我认为您应该阅读一些有关 Windows 内核和一般操作系统内容的书籍。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-06T05:17:53.793

微软距离那个版本还有几个 Windows 版本。但他们会从我认为的[奇](http://research.microsoft.com/os/Singularity/)
点之 类的东西开始。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-06T04:44:15.450

因为它会破坏向后兼容性？和主流芯片架构不符合VM架构？他们不久前为 Java VM[制造了硬件](http://www.ebb.org/bkuhn/writings/technical/thesis/node10.html)，但没人关心。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-06T15:22:02.230

我看到的最大问题是 CLR 在 VM 上运行，而 VM 作为抽象层很有用。一些 .NET 应用程序可以在 Linux 上运行（参见 Mono 项目，我认为它们现在可以与 .NET 2 兼容），所以这一切都将不复存在。在 C/C++ 或直接与硬件对话的语言中，您必须针对每个操作系统和硬件架构将代码重新编译为不同的二进制文件。拥有 VM 的目的是将其抽象化，以便您可以编写代码、构建代码并在任何地方使用完全相同的二进制文件。如果您从 Java 的角度来看，他们在将 VM 用作“一次编写，随处运行”模型方面做得更好。相同的 java 类将在 Windows、Mac 和 Linux 上运行而无需重新构建（无论如何，由程序员，从技术上讲，VM 正在做这项工作）。

我认为这里的第一点是 .NET/CLR 不是特定于 Windows 的，而且 IMO 微软只有在跨操作系统兼容性方面付出更多努力时才会帮助 .NET 语言套件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-06T04:45:22.563

因为微软拥有巨大的遗产，他们不能简单地放弃。公司已经为他们无法忽视的 Windows 和 Win32 软件投入了大量资金。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-06T09:59:13.287

可能使用 CLR 或某些 VM（正在使用 VM）在其上运行操​​作系统。但接下来的问题是，应该使用什么来构建 VM？在某些情况下，可能是 C/C++ 或其他类似的语言和（大多数）可能是汇编以加快速度。

这意味着虚拟机仍然会遇到 Windows（或任何操作系统）现在面临的问题。正如其他人所指出的那样，操作系统和相关应用程序的某些部分可能会被移植（或如您所说的变形）以通过 VM，但是将整个操作系统置于 VM 之上并没有多大用处。原因是，VM 将成为真正的操作系统，对 Morphed 操作系统实施垃圾收集和其他保护措施。

那是我的两分钱。:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-20T04:59:01.500

CLR 本身会使用什么语言？它会调用哪些 API？假设它需要打开一个文件或分配内存或创建一个进程，你认为 CLR 会这样做吗？CLR 建立在本机代码之上。托管操作系统会产生开销。

CLR 是用于应用程序开发的，它可以让开发应用程序变得容易，并且可以轻松地制作更少错误的软件。它使用垃圾收集器，它们会破坏性能。它们也可以很好，但是你通常会在开发过程中遇到一些性能问题，这是由垃圾收集引起的。

他们必须使其向后兼容，因此必须使其具有某种本机 API。

如果你说让我们做一个纯 100% 托管的操作系统，然后忘记向后兼容性或者以后有一些巨大的兼容性，那么你真正想说的是让我们强制垃圾收集器到所有东西上，对吗？除了垃圾收集器和通过兼容 CLI 获得的可移植性保证之外，您还获得了什么？算法和所有内容在执行时仍被编译为本机代码，因此唯一真正重要的区别是内存管理。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-12-06T14:32:40.393

实际上，我确实看到了 CLR 将深入软件堆栈的趋势。我记得看到过最新的 Windows 软件堆栈，一些 CLR 相关库被植入到较低级别。

但是CLR不会演变成windows，我们知道向后兼容对于软件生态非常重要。

# sql-server-2005 - 在构建过程中自动确认 MS SQL 2005 数据输入的建议

> ID：345929
> 
> 赞同：1
> 
> 时间：2008-12-06T04:44:50.053
> 
> 标签：sql-server-2005, visual-build-professional

我有一个运行的自动化（可视化构建）构建过程：

一组自动冒烟测试 (AutoIT)，将数据输入到 .Net WinForm 应用程序中，该应用程序写入干净种子的 MS SQL 2005 DB。

返回我想要的数据的 SQL 查询。

```
SELECT i.ID, i.firstname, i.lastname, i.ModDate
FROM app.Individual i
Where lastname = 'Doe' 
```

现在我想做的是确认：

返回的行数（假设应该是 1）

i.ID、i.firstname、i.lastname 的值（假设应该是 1、John、Doe）

ModDate 是今天

可以从 CSV 文件中提取数据的值。VisualBuild 可以启动外部应用程序，因此限制只有 Windows XP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T22:18:41.980

自动化工具 TestComplete 做得很好：[http ://www.automatedqa.com/products/testcomplete/](http://www.automatedqa.com/products/testcomplete/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T12:34:31.520

那么，为什么不在主项目测试之后立即使用 NUnit 测试项目来构建呢？您可以在那里轻松地测试 SQL 数据的断言。

# c++ - 生命模拟的有效方法

> ID：345930
> 
> 赞同：3
> 
> 时间：2008-12-06T04:44:56.153
> 
> 标签：c++, performance, artificial-life

在阅读了很多关于人工生命（我觉得非常有趣的主题）的文章以及关于 SO 的几个问题之后，我开始考虑设计一个（非常、非常、非常）简单的模拟器的想法。甚至不需要图形。如果我忽略了一个问题，请随时向我指出。

就像我说的，这几乎不会是模拟人生级别的模拟。我相信它几乎不会达到“可接受的免费软件”水平，它只是一种学习练习，可以在休息时保持我的技能。基本前提是创造了一个普通人。没有名字、身高或类似的东西（就像我说的，很简单），它会收到的唯一真实的东西是“关联”和通用“使用”、“拾取”和“看”能力的列表。

**我的第一个问题**是关于协会的。SO推荐什么作为处理此类事情的有效方法？我在考虑一个多图，相对容易地设置键是它想要的（食物、饮食、休息等），而另一位（对不起，我的想法已经失效）是它与该需求相关联的。

例如，假设我们有一台冰箱。冰箱里有食物（只是一个通用的基础对象）。最初，这个人并没有将冰箱与食物联系起来，但它确实将食物与饥饿联系起来。因此，当它的饥饿感增加时，它开始任意寻找食物。如果没有食物触手可及，它会“使用”物体来寻找食物。由于它与食物没有已知的关联，它会随意使用事物（可能是寻找最近的物体并向外扩展）。一旦它使用/打开冰箱，它就会看到食物，建立冰箱包含食物的连接（阅读：插入“食物，冰箱”对）。

现在，我意识到这将比看起来要复杂得多，我准备把它敲出来。问题是，多图是否适合（可能）呈指数级扩展的关联列表？如果不是，那会是什么？

**我的第二个问题**可能要容易得多。简而言之，通用对象/项目接口是否适用于大多数项目？换句话说，一个通用的“使用”接口是否适用于我的意图？我不认为我解释得很好。

无论如何，任何意见表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T19:49:04.923

如果您将其作为核心开发项目进行，我建议您使用等效的 Java 反射（在此处替换您选择的语言）。如果您想做一个玩具项目作为入门工作，我建议您至少根据以下基本原理推出您自己的简单反射版本。

您环境中的每个工件都提供了某些功能。该事实的一个简单模型是询问哪些“动词”适用于您的虚拟角色遇到的每个对象（包括可能依赖于该对象的当前状态）。例如，您的角色可以“打开”冰箱、一盒麦片或一本书，前提是它们中的每一个都处于“关闭”状态。打开一本书后，您的角色可以阅读或关闭它。打开冰箱后，您的角色可以“查看”它以获取可见内容列表，可以从中移除对象，将对象放入其中等。

The point is that a typical situation might involve your character looking around to see what is visible, querying an object to determine its current state or what can be done with it (i.e. "what-state" and "what-can-i-do" are general verbs applicable to all objects), and then use knowledge about its current state, the state of the object, and the verb list for that object to try doing various things.

By implementing a set of positive and negative feedback, over time your character can "learn" under what circumstances it should or should not engage in different behaviors. (You could obviously make this simulation interactive by having it ask the user to participate in providing feedback.)

The above is just a sketch, but perhaps it can give you some interesting ideas to play with. Have fun! ;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T07:12:47.257

对于第一个问题：

我的理解是你有一对多的关系。所以是的，多图对我来说似乎很合适。

对于第二个问题：

是的，我相信对象的通用接口是合适的。也许使用类似于[REST](http://en.wikipedia.org/wiki/REST)的东西来操纵对象状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T22:14:32.897

[不久前，我与The Noble Ape Simulation](http://www.nobleape.com/)的开发人员一起听过一个播客，您可能会很感兴趣 - 概念方面的，也可能是代码方面[的，因为您可以访问源代码](http://www.nobleape.com/man/legal.html "虽然它是纯 C")以及[下载二进制文件](http://www.nobleape.com/sim/)。

播客是由 Randal Schwartz 和 Leo Laporte 主持的[FLOSS Weekly 31 。](http://twit.tv/floss31)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-06T07:22:40.780

[生活](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)与 lisp(sbcl) :)

# .net - .NET 会随时接管 C/C++ 吗？

> ID：345936
> 
> 赞同：9
> 
> 时间：2008-12-06T04:49:32.663
> 
> 标签：.net, c++, c

这是一个主观问题。

在进入 .NET 领域之前，我曾在 Visual Basic 6.0 中工作。

一件事我看到有很多事情需要处理 Win32 API。作为 Visual Basic 6.0 开发人员，有很多限制。.NET 修复了一些老问题，但是依赖 Win32 的需求并未得到解决。

是否有任何时候不需要依赖Win32？（我猜只有当 .NET 支持操作系统级别时。）

我知道.NET（编写[LOB](http://en.wikipedia.org/wiki/Line_of_business)应用程序/网站）和 C/C++ 的域到目前为止是不同的。

.NET 或任何其他基础设施真的可以让 C/C++ 变得不那么重要吗？我期待太多了吗？

编辑：它看起来不像是在另一个包装器上构建包装器（并随之带来一组新的复杂性）？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-06T05:21:18.527

它不会很快消失，但至少在 Windows 中，使用 C/C++ 的新项目越来越少。你甚至可以看到微软开始吃自己的狗粮的例子。

C# 编译器就是一个很好的例子。目前，它是用 C/C++ 编写的。C# 团队目前正致力于纯粹在托管代码中重写它。造成这种情况的一个重要原因与 .NET 中的 CAS 策略有关。调用非托管代码需要 FullTrust，因此编译代码也需要 FullTrust。当他们转向托管代码时，这种限制就会消失。

随着越来越多的开发人员将 .NET 作为他们的开发平台，我们看到微软也在效仿。

另一个很好的例子是 Visual Studio 2010。他们正在使用 WPF 和 MEF 重写大部分 IDE，以便它易于扩展。

接下来，查看 Silverlight 运行时。它根本不（特别）依赖于 Win32。它在 Mac 上运行与在 Windows 上运行一样。随着 Silverlight 变得更加强大，我们可能会发现许多当前依赖 Win32 的 .NET 调用不再这样做。

我想我的观点是，我们至少 开始看到**Windows 世界发生了一些变化。**

当然，一旦你需要更加跨平台，C/C++ 又变得更有吸引力了……

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-06T05:06:44.330

不会很快。如果有的话，他们不会在不久的将来用 .NET 重写内核和核心 API。人们一直期待 C 消失很长时间，我只是不认为它会发生。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-10T19:42:08.663

.NET 已经在其设计的领域中接管了 C/C++。没有多少人在.NET 中编写设备驱动程序或其他系统级的东西。但它擅长业务应用程序，这可能构成了已完成的大部分编程。

甚至 C/C++ 也没有消除人们在某些情况下编写程序集的需要，因此 .NET 不太可能消除它。但这不是故意的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-06T05:29:47.653

在某些情况下，C#/.NET 永远无法取代 C/C++：

1.  目标计算机没有 .NET 运行时环境，您不能/不想强制安装。（这也是 Java 或 Parrot/Perl6 的问题）。如果目标的 .NET 环境版本比您的程序旧，这也可能是一个问题。

2.  代码需要在 Windows 和 Linux 或 OSX 上运行。C/C++ 比 C# 更可移植，即使是 Mono。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-06T14:52:39.640

嗯，首先，MS*正在*开发基于托管代码 (.NET) ( [Singularity](http://www.codeplex.com/singularity) ) 的操作系统。现在，这只是一个研究项目，所以不能保证会发生什么，但它确实表明了 MS 的想法。

接下来，我们必须考虑，我们是在谈论 Windows 世界，还是一般的计算机应用程序。C# 并没有大举进入 Linux/Unix 世界，因此 C/C++ 将在那里保持强大。

如果我们仅限于 Windows，那么我认为，对于新的桌面应用程序，.NET 可能已经超过了 C/C++（由于现有的代码库，C++ 总体上仍然具有优势）。但是，对于 Web 开发来说，C/C++ 一开始就不是很大，所以 .NET 很早以前就通过了它们。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-10T19:34:43.013

这与我的一位教授在 1980 年代初所说的类似[——Pascal](http://en.wikipedia.org/wiki/Pascal_%28programming_language%29)应该用于一切。我不这么认为。不同的语言有不同的目的。问题是人们倾向于只看到他们领域中的东西。我从事建模和模拟工作，有时会在金属附近工作。C++ 是我的语言。我希望它不受管理且没有 GC。我不在业务/数据库领域工作，所以所有的 C#/Java/Beans/J2EE [TLA](http://en.wikipedia.org/wiki/Three-letter_acronym)都没有为我带来任何好处。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-06T14:59:55.910

正如您所说，C/C++ 和 C# 涵盖了不同的开发领域。C# 取代一些 C++ 应用程序的原因主要是因为 C++ 不应该首先用于它们（以业务数据为中心的应用程序）。所有的网络浏览器都是用 C++ 编写的，办公系统、游戏、图像处理等也是如此。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-10T19:26:06.650

看到几乎所有高级语言本身都是用 C 编写的，我认为这种情况不会很快发生。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-08T13:23:23.950

在不久的将来，我认为它可能不会接管 c/c++。

因为还有一些其他领域我们不能忽视 C/C++ 的贡献。.net 也很昂贵，所以我们不能指望它在不久的将来取代 C/C++。

尽管业界人士预计 C 会在很长一段时间内过期，但由于它的效率、与硬件交互的能力非常容易，它并没有发生。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-10T19:09:55.780

.NET 主要在 Windows 上运行（在 Linux 上使用 Mono，我认为是 Mac）。但 C/C++ 仍在其他地方使用，例如嵌入式设备。许多其他语言的编译器本身都是用 C/C++ 实现的。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-05T05:54:45.013

考虑到较新的语言本身是使用 C / C++ 编写的，C / C++ 被淘汰（如果有的话）还需要很长时间

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-29T20:19:57.733

C#（或者，更准确地说，.NET Framework）并不是要接管 C/C++。它打算接管的是Java。但是 Java 是真正的多平台。不是“好吧，好吧，在我们无限的仁慈下，我们暂时允许 Mono 存在，但不要太自负”像 .NET 这样的多平台。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-06T17:29:38.497

C# 有很多好的特性。但是，我所知道的 C# 和 C/C++ 之间最大的区别是有人决定不再需要预处理器。

对于预处理器的简单使用，毫无疑问它们是正确的。

然而，许多高技能/经验丰富的程序员利用代码生成来显着减少编程工作并提高软件性能。对于某些问题，预处理器是一种高效的代码生成器。忽略它意味着那些程序员必须找到其他不太方便的方法来进行代码生成。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-05T05:34:55.303

我也不认为这会发生。这可能发生在 Windows 平台上（或不发生），但在 linux/unix 平台上我看不到这种情况发生。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-29T20:39:58.210

如果您的意思是在替换所有任务的意义上“接管”，则不是。

如果你的意思是“接管”变得更受欢迎，它可能已经发生了。

对我来说，C/C++ 就像汇编语言一样古老。我可能有 6 年没有在 PC 上写过任何 C 语言了。我现在唯一一次写 C 是针对 iPhone 等有限的机器。对我来说，解释语言似乎已经超越了编译语言（至少在可用的工作中）。但是 C 不会像汇编不会消失一样消失。只是写的人少。

# azure - 从 Silverlight 使用 Windows Azure 服务总线

> ID：345937
> 
> 赞同：3
> 
> 时间：2008-12-06T04:56:01.263
> 
> 标签：azure, silverlight, azureservicebus

是否可以从 Silverlight 应用程序调用托管在服务总线上的服务？我试着用谷歌搜索，但没有任何结果有帮助。

查看示例（EchoService），他们使用特定的 microsoft DLL 来设置服务的身份验证。我似乎无法将此 DLL 添加到我的项目中（呃，它适用于完整的 CLR），并且不确定如何在客户端复制其行为。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T05:41:41.537

你可以使用它。您必须在服务总线上托管一个交叉访问策略文件服务（为该文件提供服务的服务） Clemens Vaster 的博客中给出了执行此操作的服务示例。（只要谷歌它，它在 msdn 站点上）它包含在反向 Web 代理中。

您必须使用排队的其余 API。请参阅 SDK 中包含的 Http 队列示例。

请注意，使用 Silverlight，您必须使用异步库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T20:37:03.420

~~我查看了 2008 年 11 月的 CTP 代码，并且由于对 NetTcpRelayBinding 的依赖和 Silverlight 有限的 TCP 支持，让 EchoService 客户端从 Silverlight 工作的可能性很小。~~

~~我建议让您的 Silverlight 客户端调用您控制的后端服务，并将请求代理到 Azure 平台。不是一个理想的解决方案，但目前是一种解决方法。~~

更新：现在可以使用 REST API 调用从 Silverlight 访问 Azure 服务总线。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ff797957.aspx](http://msdn.microsoft.com/en-us/library/ff797957.aspx)。

# asp.net - 如何在用户控件中创建保存文件对话框？

> ID：345939
> 
> 赞同：2
> 
> 时间：2008-12-06T04:57:04.927
> 
> 标签：asp.net, winforms, controls

我想在用户控件中打开一个文件对话框。我用过`using System.Windows.Forms`，但我仍然无法访问 SaveFileDialog 类。谁能告诉我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T05:01:55.307

您不能在 asp.net 中使用 SaveFileDialog（如果我查看问题的标签）。

似乎您想让用户单击某个按钮以下载文件并提示用户保存它。

如果这是一个正确的假设，请仅使用纯 html 和 js 文件查看接受的答案[，我如何强制下载 mp3 链接而不是仅仅播放？](https://stackoverflow.com/questions/338616/with-just-a-plain-html-and-js-file-how-can-i-force-a-link-to-an-mp3-to-download)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T05:09:17.710

```
<input type=file> 
```

或者

```
<asp:FileUpLoad id="FileUpLoad1" runat="server" /> 
```

可能是你的想法。它将让用户上传文件作为 POST 的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T08:23:30.953

感谢您的回复。我找到了解决方案及其工作。我使用 HTTPHandler 在客户端下载文件。

# javascript - 自动填充组合框

> ID：345943
> 
> 赞同：-1
> 
> 时间：2008-12-06T05:02:10.237
> 
> 标签：javascript, html

就我而言，我想使用 html、javascript 实现多选自动完成组合框。

是否有任何机构知道如何实施它。

在向任何问题添加多标签时，这将类似于 stackoverflow 中显示的文本字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T12:50:22.723

如果您谈论的是链接的多个下拉框，那么第一个下拉菜单中的选择决定了下一个下拉菜单中的可能性，那么[ASP.NET 工具包有一个很好的级联下拉示例](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/CascadingDropDown/CascadingDropDown.aspx)。当然，这只有在您使用 ASP.NET 进行编程时才会派上用场。我不建议尝试对解决方案进行逆向工程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T10:20:33.353

自动填充是什么意思？如果您想动态填充下拉框，您可以使用普通的 HTML Select 标签并使用 Ajax 获取要显示在下拉列表中的值列表

# .net - 从实体框架绑定数据源时，WPF 设计器不会加载

> ID：345947
> 
> 赞同：8
> 
> 时间：2008-12-06T05:06:27.590
> 
> 标签：.net, wpf, entity-framework, multi-project

**编辑：**我已经提交了一个错误报告，微软承认这是一个错误。目前没有关于何时修复的预计时间。

**错误报告：** [https ://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=386982](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=386982)

**官方反馈：** [http ://social.msdn.microsoft.com/Forums/en-US/vswpfdesigner/thread/ca3cac55-c1de-4e65-9543-e95484ad78c5/](http://social.msdn.microsoft.com/Forums/en-US/vswpfdesigner/thread/ca3cac55-c1de-4e65-9543-e95484ad78c5/)

我有一个按以下方式构建的解决方案。

*   实体框架项目
*   数据访问项目
*   WPF应用项目

WPF 应用程序调用数据访问项目中的方法，这些方法从实体框架项目中获取数据并将其绑定到 XAML 中。

例如

```
<UserControl.Resources>
      <ObjectDataProvider x:Key="tokens" 
                            ObjectType="{x:Type ctl:MerchantNetworkController}" 
                            MethodName="ListMerchantNetworkTokens" />
</UserControl.Resources> 
```

我遇到的问题是，当我从数据访问项目调用函数时，VS 2008 设计器不会加载，但是我可以编译并运行该解决方案。

当我在 XAML 后面的代码中创建一个函数并使用它而不是数据访问项目时，它工作正常并且设计器实际加载。当我调用数据访问项目时，就会出现问题。

我从设计师那里得到的错误信息是

```
"The specified named connection is either not found in the configuration, not intended to be used with the EntityClient provider, or not valid" 
```

我在WPF项目和数据访问项目的App.config中有如下连接字符串

```
<add name="Entities"
     connectionString="metadata=C:\EFModel\Model.csdl|C:\EFModel\Model.ssdl|C:\EFModel\Model.msl;
         provider=System.Data.SqlClient;
         provider connection string='Data Source=localhost;Initial Catalog=database;Persist Security Info=True;User ID=username;Password=password;MultipleActiveResultSets=True'"
         providerName="System.Data.EntityClient" /> 
```

我正在使用 VS 2008 sp1、.NET 3.5 sp1、Vista 32 位

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T05:10:54.797

是的，这很糟糕。我以前不得不处理这个问题。你能做的最好的事情是让你的控制器函数在设计视图中返回假数据。

# events - SDL 事件调试问题

> ID：345966
> 
> 赞同：0
> 
> 时间：2008-12-06T05:29:21.087
> 
> 标签：events, sdl

我目前正在尝试使 SDL 事件正常工作，但问题是该程序无法正常工作。

当我运行程序时；它打开和关闭非常快，并且调试给出了这些错误：

```
线程“Win32 线程”(0xb60) 已退出，代码为 1 (0x1)。
线程“Win32 线程”(0xe00) 已退出，代码为 1 (0x1)。
线程“Win32 线程”(0x628) 已退出，代码为 1 (0x1)。
程序“[868] My Project.exe: Native”已退出，代码为 1 (0x1)。

```

我正在使用 Visual Studio C++ Express Edition 2008，包含的文件是：

```
#include "SDL/SDL.h"
#include "SDL/SDL_image.h"
#include <windows.h>
#include <字符串>

```

我试图开始工作的代码可以在以下位置找到：http: [//lazyfoo.net/SDL_tutorials/lesson04/index.php](http://lazyfoo.net/SDL_tutorials/lesson04/index.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-17T18:45:44.500

该代码正在尝试加载文件名“x.png”。如果您在工作目录中没有具有该名称的正确 PNG 文件，则程序将退出并返回错误代码 1。

# button - 如何从asp.net中动态创建的按钮控件中捕获事件？

> ID：345970
> 
> 赞同：0
> 
> 时间：2008-12-06T05:32:41.813
> 
> 标签：button

程序如何捕获~~生成~~来自asp.net 中动态创建的按钮控件的事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T05:40:05.980

您可以以编程方式附加事件：

```
Button myButton = new Button();
myButton.Click += new ClickEventHandler...etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T06:09:56.573

> 按钮 ButtonDeleteFromDB = new Button();
> 
> ButtonDeleteFromDB.Text = "删除";
> 
> ButtonDeleteFromDB.ID = "btnDeleteFromDB" + ctrlCount.ToString();
> 
> ButtonDeleteFromDB.Click += new EventHandler(ButtonDeleteFromDB_Click);

以下列方式调用事件：

> 私人无效ButtonDeleteFromDB_Click（对象发送者，EventArgs e）{}

# audio - Adobe AIR 1.5 沙盒 + 主板扬声器

> ID：345973
> 
> 赞同：1
> 
> 时间：2008-12-06T05:39:09.193
> 
> 标签：audio, frameworks, air, sandbox

我很好奇是否可以通过 AIR 访问您的主板 PC 扬声器？

它适用于警报类型的程序，并且希望音高控制不仅仅是简单的哔哔声。这可以通过 AIR 实现吗？

或者，如果不在任何基于 Web 的框架中？似乎有点棘手，所以我很想知道是否有人有解决方案。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T00:28:16.267

我已经调查过了，我认为这是不可能的。AIR 运行在应用程序级别，尽管一些系统资源可用，但大多数不可用。

# code-generation - 哪些 .NET 框架允许您首先创建业务实体，然后是数据库

> ID：345981
> 
> 赞同：2
> 
> 时间：2008-12-06T05:47:42.763
> 
> 标签：code-generation, persistence, domain-driven-design, ddl, migration

是否有任何 .NET 框架允许您先创建业务实体，然后再创建数据库。换句话说，允许您稍后使用 DDD / Persistence Ignorance 方法备份到数据库中。允许您编写的模型/类生成 SQL DDL 和迁移脚本的任何工具。

随意修改我的措辞，并使其成为一个更好的问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T05:52:21.430

NHibernate 支持领域驱动设计、持久性无知和自动数据模型生成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T12:01:08.253

[CapableObjects 的Eco](http://capableobjects.com/)可以满足您的要求以及更多功能。有一点学习曲线，但生产力的提高是惊人的。顺便说一句，与公司没有任何关系——只是一个非常高兴的客户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T05:54:58.867

您可以选择 Castle ActiveRecord，它隐藏了 NHibernate 的复杂性，并且可以使用各种选项从业务实体创建模式，例如创建模式文件和直接创建数据库实体。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T07:22:20.720

[DataObjects.Net](http://wiki.dataobjects.net)旨在完全支持这种模式。

# java - .net/java 中有哪些优秀的集体智能开源库？

> ID：345982
> 
> 赞同：3
> 
> 时间：2008-12-06T05:51:50.510
> 
> 标签：java, .net, collective-intelligence

或者任何广泛利用集体智慧的开源项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T08:53:42.437

看看Toby Segaran的《[集体智慧》一书。](https://rads.stackoverflow.com/amzn/click/com/0596529325)它涵盖了很多主题，例如亚马逊如何生成推荐等。书中有很多用 Python 编写的源代码，应该很容易移植到 Java/.Net

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T14:56:32.750

曼宁出版了一本新书，[《行动中的集体智慧》](http://www.manning.com/alag/)。还有一些用 Java 编写的代码示例。我还推荐 Toby Segaran 的书。来自 Java 背景，我能够毫无问题地遵循 Python 代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T08:44:07.760

查找 weka (java) 和 Franke 和 Witten 的数据挖掘一书

# javascript - 如何创建 JavaScript 浮动 div 注册表单

> ID：345987
> 
> 赞同：3
> 
> 时间：2008-12-06T05:56:53.543
> 
> 标签：javascript, html, dhtml

我正在建立一个网站，每个页面上都有一个“登录/注册”链接。每当有人单击此链接时，我希望基于 JavaScript/div 的注册表单浮动在内容顶部，并带有一个链接以“关闭”它（如果他们愿意）。

我还希望 div 的功能显示在他们的鼠标位置附近，也就是说，如果他们单击页面中间附近的链接，它应该显示在中间附近，并且他们不必一直滚动到顶一下看看。（澄清一下，可能是它应该自动确定鼠标坐标，或者有办法指定（x，y）坐标。）

我自己是一名优秀的 JavaScript 开发人员，但不是专家，所以我相信会有一些库比我做得更好。有什么链接/教程要分享吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T16:14:08.217

今天有一个更好的方法。它被称为 jQuery 对话框：http: [//jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

查看模型表单示例：http: [//jqueryui.com/demos/dialog/#modal-form](http://jqueryui.com/demos/dialog/#modal-form)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T06:00:07.390

看看 jQuery Thickbox。

[http://jquery.com/demo/thickbox/](http://jquery.com/demo/thickbox/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T10:50:29.767

你可以试试这个：

```
<div id="loginBox"><!-- insert content here--></div><br />
<style type="text/css"><br />
   #loginBox { <br/>
        display:none; <br/>
        position:absolute; <br/>
        /* left and top */<br/>
   }<br/>
</style><br/>
<script type="text/javascript"><br/>
   function showLoginBox() { document.getElementById('loginBox').style.display = 'block'; }<br/>
</script><br/>
<a href="#" onclick="showLoginBox()" >Show login box</a><br /> 
```

如果您只需要一个简单的解决方案，那应该可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T18:32:01.457

我试过Thickbox，但它总是显示一个空框，而不是我想显示的div的内容。所以我找到[了 Ibox](http://www.ibegin.com/labs/ibox/)，它运行良好 :)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-06T10:18:09.973

您还可以在隐藏工具栏、地址栏等的新窗口中显示登录页面。您可以使用从主页中的鼠标单击事件中检索到的鼠标坐标来设置窗口位置

# python - Python - 找不到记录器“OpenGL.error”的处理程序

> ID：345991
> 
> 赞同：80
> 
> 时间：2008-12-06T05:59:43.397
> 
> 标签：python, logging, opengl, wxpython, pyopengl

好的，它是什么，为什么它出现在Win2003服务器上，而不是在WinXP上。

它似乎根本不会影响我的应用程序，但是当我关闭应用程序时会收到此错误消息。这很烦人（应该是错误消息）。

我正在使用 pyOpenGl 和 wxPython 来处理图形。不幸的是，我是一名 C# 程序员，已经接管了这个 Python 应用程序，我必须学习 Python 才能做到这一点。

我可以提供代码和版本号等，但我仍在学习技术知识，因此将不胜感激。

Python 2.5、wxPython 和 pyOpenGL

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2008-12-06T17:18:34.367

看起来 OpenGL 试图在 Win2003 上报告一些错误，但是您还没有配置系统输出日志信息的位置。

您可以将以下内容添加到程序的开头，您将在 stderr 中看到错误的详细信息。

```
import logging
logging.basicConfig() 
```

签出有关[日志记录](https://docs.python.org/2/library/logging.html)模块的文档以获取更多配置信息，从概念上讲，它类似于 log4J。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-28T21:19:40.043

摆脱此消息的[正确方法是为您的库 (OpenGL) 的根级别记录器配置 NullHandler。](https://github.com/techtonik/rainforce/blob/master/WartsOfPython.wiki#logging)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T17:52:46.277

添加上面的 Logging 后，我可以看到问题是由于缺少 TConstants 类引起的，我在 py2exe setup.py 文件中排除了该类。

从排除列表中删除“Tconstants”后，我不再遇到问题。

# winapi - 对于任何新的 Win32 应用程序开发，您是否都在使用 .NET？

> ID：345993
> 
> 赞同：3
> 
> 时间：2008-12-06T06:01:07.607
> 
> 标签：winapi, clr

您是否选择不对任何新的 Win32 应用程序使用托管代码？为什么？是否有 CLR 无法提供的您需要的资源？

（注意“新” - 不是对现有代码库的增强。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T17:11:40.700

一个重要的原因是易于部署。我可以构建一个 Win32 应用程序（使用 MFC 或 WTL 库），并且使用静态链接**不依赖**于外部库（是的，我知道静态链接不是[推荐的方法](http://msdn.microsoft.com/en-us/library/ms235316.aspx)）。

用户无需先安装其他任何东西即可安装和运行此应用程序：不需要框架库，**也不需要 DLL hell**。作为比较，请阅读Paint.Net 作者的[这些](http://blog.getpaint.net/2008/08/24/the-paintnet-install-experience-part-1-version-3xx/) [帖子，了解用户安装 .Net 应用程序的痛苦程度。](http://blog.getpaint.net/2008/08/25/the-paintnet-install-experience-part-2-version-40/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T06:03:50.597

我想我写 Win32 的最后一个原因是可移植性。C++ 在所有平台上编译，简单且没有疯狂的依赖。所以对于可移植的代码，我最终还是需要访问 Win32 的 GUI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T06:09:24.937

我不会绕过 .NET 来进行 Win32 编程。我绕过它们来进行 Java 编程，因为**我**希望我的应用程序可以在尽可能多的平台上运行。Windows 可能控制着大部分市场，但我看不出有任何理由放弃哪怕是很小的利润机会，尤其是因为我可以比 C++ 或 C# 更快地编写 Java 代码（这是基于我的能力，而不是反映语言本身）。

目前，.NET 和 Win32 都没有给我这种跨平台能力。他们最终可能会使用 Mono，但我仍然认为它还没有做好生产准备，而且我认为它的未来仍然存在问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T06:17:53.640

在我的工作场所，有一些老前辈更喜欢使用 MFC，因为这是他们所熟悉的。几天前，我们要创建一个简单的应用程序，自然而然地，他们想在 MFC 中把它拿出来。仅“淘汰”就需要大约一周的时间，而我们需要一天之内的应用程序。我真的不能责怪他们——旧习惯很难改掉。最终我们选择了 C# 并让 MFC 的人摆弄 GUI 设计（他们非常欣赏）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T17:19:38.407

是和不是。如果我需要做任何 Win32/COM 的事情，我会使用 C++/CLI。C++/CLI 很棒。我们的 UI 完全是 .NET，但有时我们确实需要直接使用 C++。

# svn - 恢复到文件以前的 SVN 版本的更好方法？

> ID：345997
> 
> 赞同：167
> 
> 时间：2008-12-06T06:03:35.853
> 
> 标签：svn

我不小心将太多文件提交到 SVN 存储库，并更改了一些我不想做的事情。（叹气。）为了将它们恢复到以前的状态，我能想到的最好的方法是

```
svn rm l3toks.dtx
svn copy -r 854 svn+ssh://<repository URL>/l3toks.dtx ./l3toks.dtx 
```

天哪！没有更好的办法吗？为什么我不能写这样的东西：

```
svn revert -r 854 l3toks.dtx 
```

好的，我只使用 v1.4.4，但我浏览了 1.5 分支的更改列表，我看不到任何与此直接相关的内容。我错过了什么吗？

* * *

编辑：我想我不够清楚。我不认为我想反向合并，因为那样我会失去我想要做的*改变*！这么说`fileA`并且`fileB`都被修改了，但我只想提交`fileA`；不小心打字

```
svn commit -m "small change" 
```

提交两个文件，现在我想回滚`fileB`. 反向合并使这项任务（据我所知）并不比我上面概述的步骤更容易。

* * *

## 回答 #1

> 赞同：243
> 
> 时间：2008-12-06T09:18:14.087

```
svn merge -r 854:853 l3toks.dtx 
```

或者

```
svn merge -c -854 l3toks.dtx 
```

这两个命令[是等价的](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.merge.html)。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-12-06T06:37:34.460

查看[svn book的“](http://svnbook.red-bean.com/)[撤消更改](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.basicmerging.html#svn.branchmerge.basicmerging.undo)”部分

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2010-11-24T22:31:07.320

很抱歉在重复先前给出的答案时占用了一些空间 - 但这是我总是遇到麻烦的事情。

假设我已将本地文件更新为最新版本，即 854。然后，我想获得一个较旧的版本 - 较早版本的文件版本，例如版本 851。

复制会起作用：

```
svn copy -r 851 svn+ssh://<repository URL>/l3toks.dtx ./l3toks.dtx 
```

.. 但是，我不会为回购 URL 烦恼 :)

更新似乎可能有效：

```
svn up -r 851 ./l3toks.dtx 
```

...但是，它也将本地副本标记为“新签出”，或者更确切地说“与在线修订版相同”（即在 Tortoise/RabbitVCS 中，您会得到一个绿色的 OK 复选标记） - 这意味着您不能这样做`svn ci -m "rolled back to r 851"`：仅仅因为本地`subversion`可执行文件不会注意到任何本地更改，也不会费心将任何内容上传到在线存储库。

而且，正如已经回答的那样，反向合并有效——但在这种情况下，不应该依赖快捷语法；但具体说明：

```
svn merge -r HEAD:851 l3toks.dtx
--- Reverse-merging r854 through r852 into 'l3toks.dtx':
U    l3toks.dtx 
```

我必须承认——我永远不会理解“*将 r854 到 r852 反向合并到文件*中”这句话的意思是“*刚刚得到文件的 r851，并覆盖了你以前在本地拥有的任何内容——它被标记为与最新的在线修订不同，所以您可以将其作为新的“回滚”修订版重新在线查看*”，但我猜（并希望 :)）这就是它的作用 :)

在此之后，我们可以`svn diff`快速确认我们是否在本地获得了正确的修订；而且，该文件在 Tortoise/RabbitVCS 中会被标记为红色感叹号（即与最新提交的版本不同），因此`svn ci -m "rolled back to r 851"`这次可以运行。

另外，请注意，如果您最终在反向合并后改变主意（*即您无论如何都想继续处理最新的 HEAD 修订版，此处为 854 - 在您在本地回滚到 851 但尚未提交回滚之后*)，您不应该使用`svn up`，因为它只会说它已经是“*在修订版 854* ”；使用代替`svn revert --recursive .`或类似...

干杯!

参考：[如何使用 Subversion 回滚更改 - Jacob Wright - Flex、AIR、PHP 等。](http://jacwright.com/blog/75/how-to-roll-back-changes-using-subversion/)

编辑：...显然，与 , 完全相同的效果`svn merge -r HEAD:851 l3toks.dtx`可以通过以下方式实现：

```
svn export -r 851 l3toks.dtx
A    l3toks.dtx
Export complete. 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-07-11T23:14:53.003

我最近不得不恢复到特定版本来调试旧版本，这就像魔术一样：

```
svn up -r 3340 (or what ever your desired revision number) 
```

我必须使用“tc”选项解决所有冲突，因为我不关心本地更改（在还原之前检查了我关心的所有内容）

重新开始修订也很简单：

```
svn up 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-06T06:49:48.320

您正在寻找的内容称为“反向合并”。您应该查阅有关 SVN 书中合并功能的文档（正如 luapyad，或者更准确地说，该帖子的第一个评论者指出）。如果您使用的是 Tortoise，您也可以直接进入日志视图并右键单击并在您犯错的地方选择“恢复此修订版的更改”。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-06T08:52:00.973

反向合并正是您想要的（请参阅 luapyad 的答案）。只需将合并应用于错误提交的文件而不是整个目录。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-01-09T08:37:16.780

如果只想撤消上次签入，可以使用以下

```
svn merge -r head:prev l3toks.dtx 
```

这样，您就不必寻找当前和以前的版本号。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-03-11T10:13:54.643

svn merge 将合并修订，而不是还原它们。即，如果您在 HEAD 版本中添加了一些内容，然后将其与以前的版本合并，那么更改将持续存在。

我使用 svn cat 然后将其重定向到文件中：

```
svn cat -r 851 l3toks.dtx > l3toks.dtx 
```

然后您在该文件中有 851 内容，并且可以将其重新检入。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-02-12T17:20:38.053

如果您使用带有**SVN 插件的****Eclipse IDE** ，您可以执行以下操作：

 **1.  右键单击要还原的文件（或它们所在的文件夹，如果您错误地删除了它们并且想要重新添加它们）
2.  选择“**团队 > 切换**”
3.  选择“修订”单选按钮，然后输入您要恢复到的修订号。点击确定
4.  转到同步透视图
5.  选择要还原的所有文件
6.  右键单击选择并执行“**覆盖并提交...** ”

这会将文件还原为您想要的版本。请记住，SVN 会将更改视为新提交。即变更得到一个新的修订号，旧修订和新修订之间没有联系。您应该在提交注释中指定您将这些文件恢复到特定修订版。***********