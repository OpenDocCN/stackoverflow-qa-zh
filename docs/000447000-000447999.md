# StackOverflow 问答 000447000-000447999

# apache-flex - 在 Flex 中，我如何知道动态对象的属性何时发生变化？

> ID：447002
> 
> 赞同：2
> 
> 时间：2009-01-15T14:45:21.437
> 
> 标签：apache-flex, events, dynamic-class

我有一个动态类，用作配置设置的存储容器。设置是该类的变量，它具有读取和写入配置文件、数据库等的方法。现在我想在类变量更改时触发写入持久存储。由于变量是在运行时动态添加的，因此我不能使用 get/set 方法，而且，如果可以的话，这将导致大量样板代码。

如何触发更改班级属性的事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T17:11:57.880

您可以从[`mx.utils.Proxy`](http://livedocs.adobe.com/flex/3/langref/flash/utils/Proxy.html). 它允许您使对象是动态的，但仍然能够编写一些在访问属性时运行的自定义代码（类似于 getter 和 setter -- 请参阅[`getProperty()`](http://livedocs.adobe.com/flex/3/langref/flash/utils/Proxy.html#getProperty())和[`setProperty()`](http://livedocs.adobe.com/flex/3/langref/flash/utils/Proxy.html#setProperty())。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T20:53:49.553

我会考虑避免使用动态对象，而是使用一种存储方法和一种检索数据的方法创建数据存储类（SettingsModel？）。所以不要使用：

```
configurationSettings.randomSetting = value; 
```

...你会写：

```
configurationSettings.store("randomSetting", value); 
```

您可以将命名设置内部存储在字典中，并在方法中执行任何需要执行的操作`store()`。

这里的主要优点是可读性：当你看到一个方法被调用时，你就知道它背后有功能。出于同样的原因，我倾向于不喜欢 getter/setter 函数。

最后，这是一个品味问题，所以如果您的代码没有损坏，为什么要修复它。:)

# vb6 - Windows 7 是否支持 VB6 运行时？

> ID：447007
> 
> 赞同：25
> 
> 时间：2009-01-15T14:46:31.607
> 
> 标签：vb6, windows-7, legacy-code

我似乎无法找到一个直接的答案。似乎不支持 Visual Studio 6，但我只关心运行时。我们有一些不希望重写的旧版应用程序，但我们的客户希望它们能够在 Windows 7 上运行。

如果有人可以提供有关该主题的 MS 官方内容的链接，那将非常有帮助。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-26T22:25:33.643

**是的！**官方[支持声明](http://msdn.microsoft.com/en-us/vstudio/ms788708.aspx)：

> *核心 Visual Basic 6.0 运行时将在 Windows Vista、Windows Server 2008 和 Windows 7 EDIT 以及现在的 Windows 8*的整个生命周期中得到支持，这是五年的主流支持，随后是五年的扩展支持

我不知道它是什么时候改变的，因为它在几周前没有这样说，但现在确实如此。万岁！

* * *

正如 VonC 在他的回答中指出的那样，IDE 不再受支持，如果您想维护和更新您的 VB6 代码，这是一个令人担忧的问题。

> 在 2008 年 4 月 8 日之前，作为 Visual Basic 6.0 扩展支持策略的一部分，Visual Basic 6.0 IDE 将在 Windows Vista 和 Windows Server 2008 上得到支持

人们一直在使用 Vista[上的 IDE，并进行了一些调整](http://visualstudiomagazine.com/columns/article.aspx?editorialsid=2257)。如有必要，始终可以在虚拟机中运行它。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-15T14:52:59.953

**突发新闻**（2009 年 2 月 27 日，由[MarkJ](https://stackoverflow.com/users/15639/markj)首次报道）

**[Windows Vista、Windows Server 2008 和 Windows 7 上的 Visual Basic 6.0 支持声明](http://msdn.microsoft.com/en-us/vbrun/ms788708.aspx)**

> “核心 Visual Basic 6.0 运行时将在 Windows Vista、Windows Server 2008 和 Windows 7 的整个生命周期内得到支持”

注意：[MarkJ 在下面](https://stackoverflow.com/questions/447007/will-windows-7-support-the-vb6-runtime/592740#592740)（在我更新之前）发布了一个答案，这应该被视为该线程的官方答案。去投票吧；）

* * *

（初步回答）

Windows 7 应该支持运行时，而不是之后，如果我相信这个[软件迁移专家博客条目（2009 年 1 月）](http://blogs.artinsoft.net/fzoufaly/archive/2009/01/13/vb6-runtime-will-be-supported-on-windows-7-but-no-plans-to-support-it-on-future-version-of-windows.aspx) ......

> 我与 Microsoft Visual Basic 团队的项目经理 Paul Yuknewicz 进行了交谈，他非常参与与 VB6 及其迁移过程相关的所有事情。
> Paul 说，我引用：“ **VB6 运行时将作为 Windows 7 的一部分提供和支持，但是没有计划在未来的 Windows 版本中提供它。** ”

正如同[一篇博客](http://blogs.artinsoft.net/jose_aguilar_blog/archive/2008/11/21/yes-vb6-application-run-on-vista-but.aspx)中所述[，Windows®Vista™ 和 Windows®Server 2008™ 上的 Visual Basic 6.0 支持声明</a>，**Visual Basic 6.0 运行时支持文件将至少支持到 2018 年**（Windows Server 2008 出来2008 年 2 月 27 日）：](http://msdn.microsoft.com/en-us/vbrun/ms788708.aspx)

 [> 支持的运行时文件——在操作系统中提供：在大多数应用程序场景中使用的关键 Visual Basic 6.0 运行时文件在 Windows Vista 或 Windows Server 2008 的生命周期内提供并受支持。这个生命周期是五年的主流支持和五年自 Windows Vista 或 Windows Server 2008 发布之日起多年的扩展支持。作为我们测试在 Windows Vista 上运行的 Visual Basic 6.0 应用程序的一部分，这些文件已经过兼容性测试。

我知道这是关于 Vista 的，但如果 Windows 7 与其说是一场革命，不如说是一种进化，那可能也适用于 Windows 7（虽然没有官方消息）。

然而：

> 在 2008 年 4 月 8 日之前，作为 Visual Basic 6.0 扩展支持策略的一部分，Visual Basic 6.0 IDE 将在 Windows Vista 和 Windows Server 2008 上得到支持
> 
> 因此，即使您能够继续使用您的 Visual Basic 6.0 应用程序，您也迟早需要修复其中一个应用程序中发现的问题，或者添加您的业务所需的新功能。而当那一天到来时，**您将面临不再支持 VB6.0 IDE 的严酷现实**。

* * *](http://msdn.microsoft.com/en-us/vbrun/ms788708.aspx) 

[MarkJ](https://stackoverflow.com/users/15639/markj)在评论中建议：

> “您将始终能够在虚拟机中运行 VB6 IDE，因此不支持 IDE 不会是灾难性的”

实际上，您可以使用您最喜欢的旧 IDE 启动 Xp 会话；）（即使在这张图片中，它是从...启动 ubuntu 会话！）

[替代文字 http://www.blogcdn.com/www.downloadsquad.com/media/2008/02/virtualbox-ubuntu.jpg](http://www.blogcdn.com/www.downloadsquad.com/media/2008/02/virtualbox-ubuntu.jpg)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T16:41:16.100

很高兴看到官方声明。一些人已经[在 VB6 新闻组上报道过](http://groups.google.co.uk/group/microsoft.public.vb.general.discussion/browse_thread/thread/6cb68eef78b4dd49?hl=en#)- 并且[再次](http://groups.google.co.uk/group/microsoft.public.vb.general.discussion/browse_thread/thread/fcadfad0c8805f65/97d675c465e5aa6b?hl=en&lnk=gst&q=windows+7#97d675c465e5aa6b)- 包括 VB6 运行时，并且 VB6 程序（甚至 IDE）在 Windows 7 32 位测试版上运行良好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T14:51:35.417

我严重怀疑 Windows 7 会破坏 VB6 运行时。必须有无数最终用户构建的小型库也会损坏。

强硬派也许不会对此有任何问题，但在商业上，我认为 MS 即使在这么多年之后也会如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-17T18:32:30.910

Preview Beta 确实支持 VB6 程序，但这对于零售版本而言可能毫无意义。

Vista 的初始版本支持 IDE，但如上所述“支持”已过期。

这归结为您在不同情况下所说的“支持”是什么意思，但是程序在 Win7 Beta 上运行，人们声称 IDE 也可以在那里运行（尽管我自己没有测试过）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T19:43:39.687

我们的主要软件产品是用 VB6 编写的，它使用在 Windows 7 Beta 上安装和运行的各种旧库，没有任何问题。

我还没有看到微软关于在 Windows 7 中支持 VB6 的官方声明。考虑到 VB6 的流行程度，停止对数百万个 VB6 应用程序和库的运行时支持对它们的商业意义不大。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-27T12:32:36.303

[http://msdn.microsoft.com/en-us/vstudio/ee413549](http://msdn.microsoft.com/en-us/vstudio/ee413549)

如上所述，用 VB6 编写的遗留应用程序将在 Windows 7 的整个生命周期中得到支持。但它也指出，每一个新的开发都应该在 vb.net 中完成，这意味着 vb6 团队只保证它的运行时而不保证它的开发。因此，重要的是要知道，vb6 的开发环境已经死了，每当您尝试使用它进行新开发时，安全漏洞和错误等灾难可能会潜入您的 vb6 代码。我敢打赌，MS 将支持 vb6 遗留应用程序再运行十年左右。因此，无需担心运行它，但请始终记住，这并不意味着您可以继续使用 vb6 进行开发。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-01T13:46:28.457

VB6 在 Windows 8 上受支持并在 Windows 10 上运行

[Windows Vista、Windows 7、Windows 8 和 Windows 8.1 上的 VB6 编程支持声明](http://msdn.microsoft.com/en-us/vstudio/ms788708.aspx)

并且 VB6 编程也在 Windows 10 技术预览版上运行。运行时已包含在内，并且 VB6 IDE 安装正常。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-08-13T09:39:39.330

微软说

> Windows 10 旨在运行 Windows 8.1 和 Windows Phone 8.1 软件程序。是的，大家最喜欢的 VB6 Runtime 也将继续工作。

[Everones 最喜欢的 VB6 编程](http://blogs.windows.com/buildingapps/2015/06/22/getting-ready-for-windows-10-sdks-compatibility-bridges/)

他们还说，Project Centennial 将允许 VB6 应用程序成为通用 Windows 应用程序。

# apache - 使用 Apache 缓存网站图像

> ID：447014
> 
> 赞同：46
> 
> 时间：2009-01-15T14:48:13.553
> 
> 标签：apache, mod-expires, image-caching

如何让 Apache 上的静态内容{被浏览器缓存}而不是{检查新鲜度{每个请求}}？

我正在开发托管在 Apache 网络服务器上的网站。最近，我正在测试一些带有标题的东西（Content-Type 用于不同类型的内容），并看到了很多对图像的条件请求。例子：

```
200 /index.php?page=1234&action=list
304 /favicon.ico
304 /img/logo.png
304 /img/arrow.png
(etc.) 
```

虽然图像文件是静态内容并由浏览器缓存，但每次用户打开链接到它们的页面时，都会有条件地请求它们，并发送“304 Not Modified”。这很好（传输的数据更少），但这意味着每次页面加载都会增加 20 多个请求（由于所有这些往返行程，即使启用了 Keep-Alive 和流水线，页面加载时间也会更长）。

如何告诉浏览器保留现有文件而不检查更新版本？

编辑： mod_expires 方法有效，即使使用 favicon。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-01-15T14:53:25.507

[Apache 中的Expires](http://httpd.apache.org/docs/current/mod/mod_expires.html)模块解决了这个问题

```
a2enmod expires 
```

它需要在服务器配置中加载，并在`.htaccess`（或在服务器配置中）进行设置。

使用[Expires](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.21)标头，仅在第一次请求资源。在到期日期之前，后续请求会从浏览器缓存中完成。在指定的时间到期并且需要资源后，才再次请求它（有条件 - 将返回 304 以获取未更改的资源）。在它过期之前从缓存中清除它的唯一可靠方法是手动或强制刷新（通常是 Ctrl-F5）。（如果资源同时发生变化，这可能是一个问题，但静态图像不会经常变化。）

```
# enable the directives - assuming they're not enabled globally
ExpiresActive on

# send an Expires: header for each of these mimetypes (as defined by server)
ExpiresByType image/png "access plus 1 month"
ExpiresByType image/gif "access plus 1 month"
ExpiresByType image/jpeg "access plus 1 month"

# css may change a bit sometimes, so define shorter expiration
ExpiresByType text/css "access plus 1 days" 
```

对于 favicon.ico，需要做更多的工作（Apache 通常不识别 Windows 图标文件，并将其作为默认文本/纯文本发送）。

```
# special MIME type for icons - see http://www.iana.org/assignments/media-types/image/vnd.microsoft.icon
AddType image/vnd.microsoft.icon .ico
# now we have icon MIME type, we can use it
# my favicon doesn't change much
ExpiresByType image/vnd.microsoft.icon "access plus 3 months" 
```

瞧，It Works™！

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-04-05T18:57:11.740

使用该`filesMatch`指令，而不是`ExpiresByType`，您可以`Content-Type`通过匹配`subtype`（例如`image/*`）进行分组，而不是列出每一`type/subtype`对，而不是`subtype`（例如`image/jpeg`, `image/png`）。

```
#Set caching on image files for 11 months
<filesMatch "\.(ico|gif|jpg|png)$">
  ExpiresActive On
  ExpiresDefault "access plus 11 month"
  Header append Cache-Control "public"
</filesMatch> 
```

根据[这篇 Google 文章](https://developers.google.com/speed/docs/best-practices/caching)，我将过期时间设为不超过 1 年 ( `access plus 11 month`)，并添加`Cache-Control "public"`了为 Firefox 启用 HTTPS 缓存。

对于 CSS 和 JS，Google 建议使用 1 周的有效期。

```
<filesMatch "\.(css|js)$">
  ExpiresActive On
  ExpiresDefault "access plus 1 week"
  Header append Cache-Control "public"
</filesMatch> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T14:57:55.450

如果您`Expires`在静态图像的 http 响应中设置标头，则在第一次下载后，直到指定的时间过去，您的服务器将不会再次检查该图像，例如，如果我现在从您的服务器下载一个文件，它的`Expires`标头为

```
Expires: Fri, 1 Jan 2010 00:00:01 GMT 
```

那么我的浏览器在 2010 年之前不会再次从您的服务器中查找它，除非我清除缓存/强制刷新（Windows 上的 Ctrl+F5）。

[这里](http://jeremy.zawodny.com/blog/archives/009272.html)有一个简单的设置介绍，以及[维基百科](http://en.wikipedia.org/wiki/List_of_HTTP_headers#Responses)上的其他可能有用的回复列表

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-07-09T18:05:32.043

关于 favicon.ico，将它放在您的服务器文档根目录中，例如 /var/www/html 并将其添加到别名部分的 /etc/httpd/conf/httpd.conf 中：-

```
Alias /favicon.ico "/var/www/html/favicon.ico"
<Directory "/var/www/html">
    <Files favicon.ico>
       ExpiresActive On
       ExpiresDefault "access plus 1 month"
    </Files>
</Directory> 
```

然后单个 favicon.ico 将适用于所有虚拟托管站点，因为您正在为其设置别名。用户访问您的网站后，任何进一步的访问都将在一个月内使用浏览器缓存副本，而不是来自网络。

我无法得到

```
ExpiresByType image/ico "access plus 1 month" 
```

工作。也许它需要像上面建议的那样输入 text/plain。在任何情况下，ExpiresDefault 都可以正常工作。

# python - 在哪里获得/如何使用 python 3.0 支持构建 mod_wsgi 的 Windows 二进制文件？

> ID：447015
> 
> 赞同：5
> 
> 时间：2009-01-15T14:48:24.893
> 
> 标签：python, apache, visual-c++, mod-wsgi

我想在家里用 python 3.0 做一些实验。我让 python 3.0 工作，我玩过一些脚本，我认为尝试用它制作一个小型网络项目会很有趣。

当我在谷歌上搜索时，结果发现，由于某些原因，mod_python 将无法支持 python 3.0。

我发现的唯一其他选择是[mod_wsgi](http://code.google.com/p/modwsgi/)。

[在mod_wsgi](http://code.google.com/p/modwsgi/)项目的主页上，它说，如果你想使用 python 3.0，你必须从 subversion 存储库获取最新版本。我想知道，是否有预建的 Windows 二进制文件可用？

如果没有这样的二进制文件，那么我将感谢有关使用 VC++ 2008 构建它的任何资源。或者甚至可能是有关使用 VC++ 2008 构建 apache 及其模块的一般资源。谢谢。

哦，我正在使用最新的 Apache 2.2 版本。

编辑：如果我将使用官方的 apache 构建和我自己的 mod_wsgi 构建（我在 apache 上使用了depends.exe，并且似乎它不是用 VC++ 2008 构建的），这会是一个问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-24T12:06:29.883

现在从 mod_wsgi 站点为 Apache 2.2 和 Python 2.6 和 3.0 提供 Windows 的二进制文件。Python 3.0 仅支持 mod_wsgi 3.0 及更高版本。看：

[http://code.google.com/p/modwsgi/downloads/list](http://code.google.com/p/modwsgi/downloads/list)

* * *

2015 年 7 月更新

上面的链接不再有效。而是看到：

*   [https://github.com/GrahamDumpleton/mod_wsgi/blob/develop/win32/README.rst](https://github.com/GrahamDumpleton/mod_wsgi/blob/develop/win32/README.rst)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T07:41:46.393

我想自己找到 2.6（首选）或 3.0（好的）Windows 二进制文件，并对此进行了一些研究。

mod_wsgi 的 Windows 构建步骤深埋在 Google Group 中。我认为它们已经过时了；似乎只有一个人做过，并告诉全世界它的效果如何。编译时可能会出现需要补丁的问题。

我认为您不需要构建自己的 Apache，或者如果 VC++ 版本不同很重要（尽管我没有大量证据证明这种观点）。VC++ 版本对于 Python 模块构建非常重要，因为它们严重依赖编译器数据结构的内部结构。我认为 Apache 模块接口更加结构化。

如果您尝试此操作并遇到问题，或者如果您成功构建模块，您可能想要发布到 mod_wsgi 组，请发布它们，因为我们中的一些人非常喜欢它们，但太忙无法自己做： (

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T20:28:10.770

对于它的价值，据我所知，这仍然（截至 2008 年 3 月 2 日）悬而未决。看：

[http://groups.google.com/group/modwsgi/browse_thread/thread/93e5e56a04fe37ab/5883f8f6a0fcc945](http://groups.google.com/group/modwsgi/browse_thread/thread/93e5e56a04fe37ab/5883f8f6a0fcc945)

同样的问题 - windows 缺少 2.6 二进制文件 - 影响 mod_python。

我认为这几乎会让在 Windows 上运行的 Django 用户锁定在 2.5 树上...... :-(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-03T09:18:01.843

我能够为 python 2.54 构建 mod_wsgi（我的 python 是 2.5，因此我必须使用 MSVC7）。使用 xampp Apache 2.2.14（它只是一个开发机器，用于测试目的）：

指示：

1.  下载[http://adal.chiriliuc.com/temp/win32.zip](http://adal.chiriliuc.com/temp/win32.zip)
2.  解压例如。c:/tmp/modwsgi/win32
3.  下载并解压 mod_wsgi [http://code.google.com/p/modwsgi/downloads/detail?name=mod_wsgi-3.2.tar.gz&can=2&q=](http://code.google.com/p/modwsgi/downloads/detail?name=mod_wsgi-3.2.tar.gz&can=2&q=)到 c:/tmp/modwsgi
4.  编辑 c:/tmp/modwsgi/win32/generate.py
    *   必须设置正确的路径
    *   我还注释掉了 python24 的部分
5.  然后 cd c:/tmp/modwsgi/win32
6.  python 生成.py
7.  构建.bat

你可以将 mod_wsgi.so 复制到你的 apache

我的设置的 generate.py 的相关部分是：

```
##### 构建机器配置#####

VS2003_PATH = r"C:\Program Files\Microsoft Visual Studio .NET 2003"

PYTHON_PATH = {
    # 如果不存在特定版本，则放置 None 或注释/删除条目
    #24: r"C:\Python24",
    25: r"C:\dev\Python254",
}

APACHE_PATH = {
    # 如果不存在特定版本，则放置 None 或注释/删除条目
    #20: r"c:\dev\xampp\apache",
    22: r"c:\dev\xampp\apache",
}

##### 构建机器配置#####

APACHE_LIBS = {
    #20: "libhttpd.lib libapr.lib libaprutil.lib",
    22：“libhttpd.lib libapr-1.lib libaprutil-1.lib”，
}

```

# php - 字符集问题

> ID：447019
> 
> 赞同：1
> 
> 时间：2009-01-15T14:49:08.900
> 
> 标签：php, mysql, ajax, utf-8, character-set

我有一个用 php 构建的小型 ajax 应用程序。

使用 phpMyAdmin，我将 mysql 数据库设置为 utf-8，并将包含 utf-8 数据的文本文件导入其中。

在将 character-set-server=utf8 和 default-character-set=utf8 添加到 my.cnf 文件后，这在带有 easyphp 的 Windows 机器上运行良好。

我现在尝试将其移至无法访问配置文件的生产服务器，并且不显示元音变音等字符。

是否可以在 php 代码（而不是配置文件）中设置一些东西来解决这个问题，或者我可以给 mysql 一些命令？

我尝试使用 phpMyAdmin ALTER DATABASE `vweb_50`DEFAULT CHARACTER SET utf8 COLLATE utf8_bin 从 utf8_general_ci 尝试，但没有任何区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T14:59:00.817

这里有几件事要做，我不确定我是否正确理解了您的问题，但如果我这样做了，我认为大部分问题都可以使用 PHP 函数**utf8_encode**和**utf8_decode**来解决：

*   [utf8_encode](http://www.php.net/utf8_encode)
    *   将 ISO-8859-1 字符串编码为 UTF-8
*   [utf8_decode](http://www.php.net/utf8-decode)
    *   此函数将假定为 UTF-8 编码的数据解码为 ISO-8859-1。

此外，如果需要，请查看[htmlentities 。](http://www.php.net/htmlentities)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T22:41:29.523

如果您在整个应用程序中使用 utf-8（我会推荐），则不需要 utf8_encode/decode 函数。您是否检查过您的页面以哪种编码方式提供？可能服务器配置为发送 iso-8859-1 作为字符集，而您的测试环境发送 utf-8。使用 Content-Type 标头设置编码：

```
header("Content-Type: text/html; charset=utf-8"); 
```

# apache-flex - 奇怪的 ItemRenderer 行为

> ID：447034
> 
> 赞同：0
> 
> 时间：2009-01-15T14:52:40.627
> 
> 标签：apache-flex, datagrid, itemrenderer, advanceddatagrid

我对 ItemRenderer 有一个非常奇怪的问题。我有一个带有 ViewStack 的 main.mxml 容器。当用户登录时，初始视图包含一个 AdvancedDataGrid——包含一些数据和下面的 ItemRenderer——它只显示一个 Delete 按钮。当用户登录时，这个 AdvancedDataGrid 会自动从数据库中刷新。应根据用户的角色成员身份启用或禁用删除按钮。

**场景 1（以管理员身份登录）：**

1.  管理员用户登录——立即显示数据网格视图，并为每一行正确*启用删除按钮*
2.  登出
3.  以非管理员用户身份登录 - 数据已刷新，所有行仍处于启用状态**，除了一个**。它可能是第一行、第二行或第三行——它是完全随机的。这真的很奇怪。. .

我重新启动浏览器并遵循方案 2。. .

**场景 2（以非管理员身份登录）：**

*   非管理员用户登录 - 立即显示数据网格视图，并且每行都正确*禁用删除按钮*
*   登出
*   **以管理员用户身份登录 -除一个之外，**所有行仍处于禁用状态。它可能是第一行、第二行或第三行——它是完全随机的。与第一种情况相反。

**有趣的事实——如果我在 checkDeleteSecurity 中设置一个断点，只有当第一个用户登录并且第一次刷新 DATAGRID 时它才会到达它。当我注销并且下一个用户登录时，数据网格会刷新，但 checkDeleteSecurity 断点永远不会被捕获。**

```
[Bindable]
private function checkDeleteSecurity ():Boolean
{
     return (SecurityProxy.CheckSecurity(SecurityProxy.UserName));
}

<mx:LinkButton label="Delete" click="onDeleteClick()" id="lbDelete" enabled="{checkDeleteSecurity()}"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T16:49:26.647

听起来您可能会在这里发生一些事情。首先，值得注意的是 ItemRenderers 被重用；在一个网格（或列表等）中，例如包含十个专辑曲目的列表，每个曲目一行，在最初创建列表时，每一行都会正确呈现 - 但是当基础专辑时，扩展示例, 被更改，专辑曲目渲染器本身只有在正确连接时才会自动响应更改。通常，这涉及覆盖渲染器的数据属性的设置器：

```
override public function set data(value:Object):void
{
    super.data = value;

    // .. Take some action
} 
```

这可能是您的 CheckSecurity 方法不会在数据更改时被调用的原因——因为按钮的 enabled 属性是进入它的唯一方法，并且按钮已经被渲染。

此外，绑定到函数也有其自身的问题。昨晚有人实际上问了这个问题，做了一些与你正在做的事情非常相似的事情（通过绑定到布尔函数的结果来设置按钮的状态）：

[我可以将 Flex 组件属性绑定到函数吗？](https://stackoverflow.com/questions/445313/can-i-bind-a-flex-component-property-to-a-function#445669)

希望有帮助！如果您有任何评论，我会密切关注该主题以获取后续评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T16:36:27.467

您应该做的是在刷新数据时调用 lbDelete.enabled = checkDeleteSecurity(); 这将确保每次刷新数据时都会调用安全函数。

我认为正在发生的事情是正在创建调用安全功能的组件，但是一旦创建了它，就没有什么可以更新链接按钮了。

一旦创建了 itemrender，假设它生成 6，然后当您刷新数据时，它将使用已经为下一组数据创建的 6 个 itemrender（但具有更新的数据）。如果下一组数据需要 8 个 itemRenderer，那么它只需要创建另外 2 个渲染器。因此，只有这 2 个 itemrender 会调用安全功能，因为它们尚未创建。

# .net - 什么是 String.Format 的 WPF XAML 数据绑定等效项？

> ID：447035
> 
> 赞同：31
> 
> 时间：2009-01-15T14:52:47.270
> 
> 标签：.net, wpf, binding, formatting, text-formatting

或者，更清楚地说，我如何格式化文本块（在我的情况下，要包含在工具提示中），以便文本的某些部分来自绑定值。

在普通的 C# 中，我会使用：

```
_toolTip.Text = string.Format("{1:#0}% up, {2:#0}% down",
    Environment.NewLine, percentageOne, percentage2); 
```

但是，Text 属性的 WPF XAML 标记似乎只能包含一个绑定。花括号给了我很大的希望，但这是不可能的：

```
<Element>
  <Element.Tooltip>
    <!-- This won't compile -->
    <TextBlock Text="{Binding Path=PercentageOne}% up, {Binding Path=PercentageTwo}% down"/>
  </Element.Tooltip>
</Element> 
```

我读到该`Run.Text`属性不是依赖属性，因此不能绑定。

有没有办法可以在 XAML 中执行这种格式化？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-15T15:08:37.503

您可以使用 MultiBinding + StringFormat（需要 WPF 3.5 SP1）：

```
<TextBox.Text>
    <MultiBinding StringFormat="{}{1:#0}% up, {2:#0}% down">
      <Binding Path="PercentageOne" />
      <Binding Path="PercentageTwo"/>
    </MultiBinding>
</TextBox.Text> 
```

关于 Run.Text - 您无法绑定到它，但有一些解决方法：

*   [http://fortes.com/2007/03/20/bindablerun/](http://fortes.com/2007/03/20/bindablerun/)
*   [http://paulstovell.net/blog/index.php/attached-bindablerun/](http://paulstovell.net/blog/index.php/attached-bindablerun/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-02-09T15:45:06.323

我将拆分为多个文本块，将每个文本块与绑定中的 StringFormat={0:P} 绑定，如下所示：

```
<TextBox Text="{Binding Something, StringFormat=\{0:P\}}" /> 
```

有关示例，请参阅此帖子：[Lester 在 StringFormat 上的 WPF 博客](http://blogs.msdn.com/llobo/archive/2008/05/19/wpf-3-5-sp1-feature-stringformat.aspx)

Checkout VS2010 - 来自属性的绑定包括选项中的格式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T16:34:11.433

如果您使用的是 3.5 SP1，Aku 的答案就是要走的路。如果不是，您可以使用我的[WPF 转换器](http://www.codeplex.com/wpfconverters/)库中的[FormatConverter 。](http://www.codeplex.com/wpfconverters/Wiki/View.aspx?title=User%20Documentation&referringTitle=Home#FormatConverter)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T15:08:15.493

据我所知，WPF 不会做你想做的事。您确实有一个更强大（尽管涉及更多）的解决方案。

看一下[IValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)接口。

MSDN HowTo 链接[在这里](http://msdn.microsoft.com/en-us/library/ms752091.aspx)

**编辑**

根据 aku 的回答，以及您不能使用 3.5 SP1 的断言，这里有一个替代方案。

看看 Phil Haack 最近关于字符串格式化的系列文章：

*   [命名格式、字符串解析和边缘案例的乐趣](http://haacked.com/archive/2009/01/04/fun-with-named-formats-string-parsing-and-edge-cases.aspx)
*   [命名格式 Redux](http://haacked.com/archive/2009/01/14/named-formats-redux.aspx)

创建一个 ValueConverter，因为它将格式作为属性。然后，您应该能够绑定您的数据对象并根据您定义的格式（使用属性名称而不是位置）对其进行格式化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T15:14:04.840

我过去解决这个问题的方法实际上是将列表中的 TextBlock 分解为几个 TextBlock。尝试这样的事情：

```
<Element>
  <Element.Tooltip>
    <StackPanel Orientation="Horizontal">
      <TextBlock Text="{Binding Path=PercentageOne}"/>
      <TextBlock Text="% up, "/>
      <TextBlock Text="{Binding Path=PercentageTwo}"/>
      <TextBlock Text="% down"/>
    </StackPanel>
  </Element.Tooltip>
</Element> 
```

或者，您可以创建类似 StringFormatConverter 的东西，它可以将格式字符串作为参数，并使用 MultiBinding 将参数传递给它。请参阅此链接以获取 MultiBindings：

[多重绑定信息](http://www.stackenbloggen.de/PermaLink,guid,ce63f9a5-ccaa-4777-bf3d-d54e69eadec9.aspx)

这是有关转换器的信息：

[转换器信息](http://learnwpf.com/Posts/Post.aspx?postId=05229e33-fcd4-44d5-9982-a002f2250a64)

您可以很容易地想象一个转换器将“object[] values”而不是“object value”作为它的第一个参数，并将它们传递给 Format 函数。

# css - CSS 中的 Opera 和自定义光标

> ID：447038
> 
> 赞同：4
> 
> 时间：2009-01-15T14:53:14.900
> 
> 标签：css, opera

我通常为 Opera 实现所有真正正确的 CSS 感到非常自豪的地方，似乎用以下行实现自定义光标似乎不起作用

```
cursor:url("../pics/merge.gif"); 
```

该 URL 是正确的，因为它适用于常规背景图像属性。
适用于其他浏览器，但不适用于 Opera。

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-15T15:17:21.807

Opera 尚未添加对此的支持。不过，该行是不正确的，根据规范，需要一个后备光标。所以你必须写例如

光标：url（“路径/到/光标”），等待；

（免责声明：我为 Opera 工作。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-05T09:49:24.143

使用 javascript 的歌剧有一个解决方法：

[http://plugins.jquery.com/project/customcursor](http://plugins.jquery.com/project/customcursor)

工作正常，在 opera 11 中测试，尽管我建议其他浏览器使用常用的 css 方法，尤其是较旧的 ie，即使没有 js 也不会太快。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T14:57:26.467

Opera[似乎不](http://www.quirksmode.org/css/cursor.html)支持 url 属性。它甚至[可能被](http://forums.mozillazine.org/viewtopic.php?f=4&t=3559&start=0&st=0&sk=t&sd=a)从规范中删除（将检查）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-31T13:00:36.960

js版本真的很慢。图像也有文件大小限制。[https://developer.mozilla.org/en/CSS/cursor](https://developer.mozilla.org/en/CSS/cursor)是阅读 CSS 光标的好地方。

# database-design - 处理可变类别层次结构

> ID：447040
> 
> 赞同：1
> 
> 时间：2009-01-15T14:53:44.960
> 
> 标签：database-design, e-commerce

我遇到的问题如下：我公司的供应商为我们提供了一个 Access 数据库（我将其导入 SQL Server），其中包含他们的产品信息（替代方法是使用 XML），我正在尝试将其转换为更可用的格式用于电子商务网站。

我遇到的问题，也许我只是没有想清楚，是他们的类别信息可以是 3-6 个子类别的深度；总是至少有 2 个类别（顶级父类别和更具体的子类别），但根据项目最多可以有 6 个。

他们的数据以下表结构提供给我：

```
CREATE TABLE [dbo].[ECDB2_HIERARCHY](
    [SEQ_ID] [int] NOT NULL,
    [PFX_NUM] [nvarchar](3) NOT NULL,
    [STK_NUM] [nvarchar](12) NOT NULL,
    [ECDB2_LVL_1] [nvarchar](max)  NULL,
    [ECDB2_LVL_1_ID] [int] NULL,
    [ECDB2_LVL_2] [nvarchar](max) NULL,
    [ECDB2_LVL_2_ID] [int] NULL,
    [ECDB2_LVL_3] [nvarchar](max) NULL,
    [ECDB2_LVL_3_ID] [int] NULL,
    [ECDB2_LVL_4] [nvarchar](max) NULL,
    [ECDB2_LVL_4_ID] [int] NULL,
    [ECDB2_LVL_5] [nvarchar](max) NULL,
    [ECDB2_LVL_5_ID] [int] NULL,
    [ECDB2_LVL_6] [nvarchar](max) NULL,
    [ECDB2_LVL_6_ID] [int] NULL 
```

在大多数情况下，我可以忽略 SEQ_ID，因为它没有被使用；PFX_NUM 和 STK_NUM 连接在一起形成产品的 SKU，但这不是问题。我需要能够从站点动态遍历类别。例如，给定以下行：

`SEQ_ID: 364867 (ignored)`

`PFX_NUM: AMP`

`STK_NUM: 73121`

`ECDB2_LVL_1: Office Supplies`

`ECDB2_LVL_1_ID 11`

`ECDB2_LVL_2: Envelopes, Mailers & Shipping Supplies`

`ECBD2_LVL_2_ID: 26`

`ECDB2_LVL_3: Envelopes`

`ECDB2_LVL_3_ID: 195`

`ECDB2_LVL_4: Business Letter Envelopes`

`ECDB2_LVL_4_ID: 795`

`ECDB2_LVL_5: (empty)`

`ECDB2_LVL_5_ID: 0`

`ECDB2_LVL_6: (empty)`

`ECDB2_LVL_6_ID: 0`

用户应该能够浏览各个级别，但让我失望的是提供数据的示例网站（见下文）以随机间隔显示子类别下的所有项目......看起来它处于第 3 级（ecdb2_lvl_3 ) 但对于没有第 3 级的项目，它从第 2 级开始显示。正如您从架构中看到的那样，它们将所有内容放在一个表中，该表列出了产品及其所属的所有类别，而不是像自引用类别表和连接产品表之类的东西。

问题是有些项目只有 2 个级别，有些像这个有多达 4 个，还有一些有全部 6 个 - 供应商的示例网站，可在[http://www.biggestbook.com](http://www.biggestbook.com)很好地完成了我想要的工作，但我无法访问他们的代码，所以我对他们究竟是如何拉回类别并遍历它们感到摸不着头脑。我假设他们有某种全局标志来指示您当前所处的级别（例如，办公用品为 1，信封为 2，等等），因此他们可以跟踪您当前的深度，并且然后检查每个子级别，看看是否有更多的子类别要显示，但是当我想到如何有效地处理这个问题时，我是在画一个空白。他们的命名方案也有很多不足之处，但如果需要，我可以稍后解决。

有人对如何解决这个问题有建议吗？我计划在 C#/ASP.NET 中存储（可能是 MVC，可能不是），所以 C# 示例将是最有用的，但我可以很容易地遵循大多数语言来弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T15:45:48.460

如果您不介意使用递归函数来遍历自引用类别表，那么一定要重新设计数据库以走这条路。有人会认为 SQL 中的递归函数可能会导致性能自杀，但如果设置了适当的索引，它可以非常快地完成。

至于您正在使用的数据集，您可以从示例网站中看到它们将当前类别存储在 URL 查询中：

办公用品 > 信封、邮寄和运输用品 > 信封
？N=4294858589&...

办公用品 > 信封、邮寄和运输用品 > 信封 > 小册子和目录信封
?N=4294858588&...

其中 N 是当前类别。我认为他们的数据库有一个查找表来查看 N 属于哪个级别。或者，他们可能只是在做一个大的 WHERE/ORDER BY 子句，例如：

```
WHERE (ECDB2_LVL_1_ID == @N) OR (ECDB2_LVL_2_ID == @N) OR (ECDB2_LVL_3_ID == @N) ...
ORDER BY ECDB2_LVL_1_ID, ECDB2_LVL_2_ID, ECDB2_LVL_3_ID... 
```

如果 N 是 2 级类别，则没有 3 级类别的产品将首先出现，因为在排序时 null 排在最前面。

附带说明一下，他们会跟踪您在会话中遍历了哪些类别以到达产品。跟随一个类别到一个产品，直到 URL 显示类似 ?R=12345 的内容。面包屑将显示用于查找该产品的类别。清除 cookie 并刷新页面，面包屑将变成最大的书 > 产品详细信息。这对于从搜索引擎访问该页面的人来说并不是非常有用，因为他们无法轻松地选择一个类别来查看有哪些类似的产品可用。

# sharepoint - 更改 SharePoint 网站集标题

> ID：447044
> 
> 赞同：2
> 
> 时间：2009-01-15T14:54:57.343
> 
> 标签：sharepoint, title, sitecollection

我需要更改 SharePoint (MOSS 2007) 中网站集的标题。我发现一篇帖子说可以在 SharePoint Designer 中完成，但我没有看到指定的菜单，也无法在其他任何地方找到它。我假设我可以在必要时以编程方式做到这一点，但我想他们让它比这更容易（我傻了）。

**更新：**我实际上并没有完全听从你的建议。我只是更改了您在其中找到标题的 XML 文件，并且效果很好。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T19:20:47.777

好的，我想我现在明白你的意思了。您想更改 html 页面的标题，而不是网站的标题。我做了一点挖掘，这就是我发现的。

文本“Home”来自这个 xml 文件（在我的装备上）：

**C:\Inetpub\wwwroot\wss\VirtualDirectories\80\App_GlobalResources\wss.en-US.resx**

```
<data name="multipages_homelink_text">
    <value>Home</value>
</data> 
```

默认情况下，Sharepoint 通过连接“主页 - ” + 站点标题来创建标题文本。因此，如果您想要完全自定义文本，请执行以下操作：

打开此文件进行编辑：

**C:\Program Files\Common Files\Microsoft Shared\web 服务器扩展\12\TEMPLATE\SiteTemplates\sts\default.aspx**

接下来，用您的自定义文本替换共享点标题：

**前：**

```
<asp:Content ContentPlaceHolderId="PlaceHolderPageTitle" runat="server">
    <SharePoint:EncodedLiteral runat="server" text="<%$Resources:wss,multipages_homelink_text%>" EncodeMethod="HtmlEncode"/> - <SharePoint:ProjectProperty Property="Title" runat="server"/>
</asp:Content> 
```

**后：**

```
<asp:Content ContentPlaceHolderId="PlaceHolderPageTitle" runat="server">
    Your custom text goes here...
</asp:Content> 
```

希望这就是你要找的！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T15:35:38.743

当您说更改“网站集的标题”时，您是指网站集的顶级网站的标题吗？

如果是这样，以非编程方式，在顶级站点中，转到：站点设置 > 标题、描述和图标。

并且以编程方式，您可以新建顶级站点的 SPWeb，然后设置 Title 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T03:15:47.750

就您而言，我认为最好的方法是通过代码来完成。我认为barneytron的回答可以解决你的问题！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:25:17.743

我面临的问题是在创建子站点时输入了错误的名称。然后我想在导航栏和其他任何地方更改站点的名称。

我去了那个要更改名称的特定子站点。然后站点操作 > 外观 > 标题描述和图标。然后改名字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-13T06:08:34.887

它非常简单。在 Sharepoint Designer 中打开站点，然后单击出现在顶部菜单上的重命名按钮。然后您可以重命名它并保存并刷新站点。

如果它不起作用，请尝试使用具有访问权限的管理员。

！！！！！！！！！

# shell - Unix find 命令，什么是 {} 和 \; 为了？

> ID：447048
> 
> 赞同：17
> 
> 时间：2009-01-15T14:56:28.293
> 
> 标签：shell, unix, find

有了这组命令，`{}`和`\;`字符是干什么用的？

```
find . -name '*.clj' -exec grep -r resources {} \; 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-15T14:59:10.957

见[man find](http://unixhelp.ed.ac.uk/CGI/man-cgi?find)。（特别是关于 的部分`-exec`）

当用于对找到的每个文件`-exec`运行命令时，将`{}`替换为找到的每个文件的名称，并且命令由`\;`

在您的示例中，在当前目录 ( `.`) 下找到的所有文件，匹配名称`*.clj`将在它们上运行命令（如果字符串存在于每个文件中，则`grep -r resources`查找该字符串）。`resources`

它实际上有点多余，因为`-r`它是用于递归搜索子目录，这`find`就是已经在做的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T14:59:40.783

在 find 中，-exec 参数抓取其余参数直到 ; （分号）必须被转义，因此 \;。在此范围内，{} 被替换为正在检查的文件名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T01:25:49.817

考虑这个我觉得更容易理解的替代命令：

```
find . -name *.clj | xargs grep -r resources 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T15:00:55.103

字符串“{}”将替换为当前正在处理的文件。转义的分号终止 -exec 选项的命令参数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-18T12:27:03.183

`{}`in的字符串`find`替换为当前文件的路径名。

分号用于终止`find`实用程序调用的 shell 命令。

它需要被转义或引用，因此它不会被 shell 解释，因为`;`它是 shell 使用的特殊字符之一（列表运算符）。

另请参阅：[为什么 find 命令的 -exec 选项需要反斜杠和分号？](https://stackoverflow.com/questions/20913198/why-are-the-backslash-and-semicolon-required-with-the-find-commands-exec-optio)

# linux - 将命令更改为不分叉和使用资源的命令

> ID：447052
> 
> 赞同：0
> 
> 时间：2009-01-15T14:58:15.247
> 
> 标签：linux, file-io, command-line, fedora

我有以下命令删除一天前的 mp3 文件类型的文件。

```
find /home/get/public_html/audio -daystart -maxdepth 1 -mtime +1 
-type f -name "*.mp3" |xargs rm -f 
```

问题是当我运行它时，它有时会说，

> “fork”：资源 xargs 不可用。

这是否意味着该命令首先找到文件，然后启动多个进程来删除每个文件？

我如何（当找到文件时）立即删除它而不是通过管道传输到 xargs？

^(我不能使用它`-delete`（“无效谓词”）。)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:44:56.637

试试呢：

```
找到 /home/get/public_html/audio -daystart -maxdepth 1 -mtime +1
    -type f -name "*.mp3" -exec rm -f {} \;
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T15:10:22.853

检查您的手册页以查找，它可能支持-delete，使其像

```
find /home/get/public_html/audio -daystart -maxdepth 1 \
   -mtime +1 -type f -name "*.mp3" -delete 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T15:11:20.697

也许您可以使用“-delete”标志来查找，而不是通过管道连接到 xargs？

# ruby-on-rails - 在 Rails 装置中，昆汀是谁？

> ID：447058
> 
> 赞同：6
> 
> 时间：2009-01-15T14:59:54.793
> 
> 标签：ruby-on-rails, fixtures

在 act-as-authenticated 和现在的 restful-authentication 中，第一个用户夹具是“Quentin”。

只是好奇有没有人知道这个名字的由来？昆汀·塔伦蒂诺？某人的狗或孩子？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-16T19:55:27.827

Rick Olson 的回答 = [http://en.wikipedia.org/wiki/Quentin_Quire](http://en.wikipedia.org/wiki/Quentin_Quire)

# .net - 使用 Net 3.5 通过 List Intersect 改进编码

> ID：447063
> 
> 赞同：0
> 
> 时间：2009-01-15T15:00:59.830
> 
> 标签：.net, vb.net, linq, .net-3.5

我有一个类，它有一个 ID 列表，它具有从对象列表中添加新 ID 的功能。

我已经解决了这个问题，但我确信这可以用更少的代码来完成。

```
Public Class Page

  Private _IdList As List(Of Integer)
  Private _HasNewItems As Boolean = False

  Public Sub AddItems(ByVal Items As List(Of Item))

    Dim itemsID = From itemX In Items _
                  Select itemX.ID

    Dim list As List(Of Integer) = itemsID.ToList

    If _IdList.Intersect(list).Count = list.Count Then
      _HasNewItems = False
    Else
      _HasNewItems = True
      _IdList.AddRange(list)
      _IdList = _IdList.Distinct
    End If

  End Sub

End Class 
```

那么从 NET 3.5 的角度来看，如何用更少的代码和更多的代码来完成......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:05:58.557

尝试以下

```
Public Sub AddItems(ByVal items as List(Of Item))
  Dim oldCount = _IdList.Count
  _IdList.AddRange(items.Select(Function(x) x.ID).Except(_IdList))
  _HasNewItems = oldCount < _IdList.Count
End Sub 
```

这里的技巧是，当它们出现在作为参数传递的可枚举项中时（在本例中为 _IdList），Except 将返回所有项。所以 items.Except(_IdList) 是所有新项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T15:11:39.637

如果您的代码允许，您可以将 id 存储在[HashSet](http://msdn.microsoft.com/en-us/library/bb359438.aspx)而不是 List 中。然后，您可以将所有“新”ID 添加到 HashSet 而无需创建重复项。

编辑 - 添加代码（对不起 c#）：

```
 HashSet<int> idList;
    void AddItems(List<Item> items)
    {
        idList.UnionWith(from item in items select item.Id);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T22:54:20.043

为了完整起见，这里有一个 VB 版本，它取决于使用 HashSet 的建议：

```
Public Class Page

  Private _IdList As HashSet(Of Integer)
  Private _HasNewItems As Boolean = False

  Public Sub AddItems(ByVal Items As List(Of Item))

    Dim itemsID = From itemX In Items _
                  Select itemX.ID

    Dim localResult as Boolean

    For Each id As Integer In itemsID
     localResult = _IdList.Add(id)         
     _HasNewItems = _HasNewItems OrElse localResult
    Next
  End Sub

End Class 
```

# asp.net - SQL Server 2005：事务死锁

> ID：447067
> 
> 赞同：8
> 
> 时间：2009-01-15T15:01:32.947
> 
> 标签：asp.net, sql-server-2005, deadlock, transactions

我经常收到此错误，但在生产环境中的应用程序中的 2 页上并不一致。我只有以下错误的一些屏幕截图。

**事务（进程 ID XX）在锁上死锁 | 与另一个进程通信缓冲区资源，并已被选为死锁牺牲品。重新运行事务。**

解决此错误的方法应该是什么。数据库服务器是 SQL Server 2005。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T15:06:40.783

这是关于死锁故障排除的圣经：

[http://blogs.msdn.com/bartd/archive/2006/09/09/Deadlock-Troubleshooting_2C00_-Part-1.aspx](http://blogs.msdn.com/bartd/archive/2006/09/09/Deadlock-Troubleshooting_2C00_-Part-1.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T15:03:13.960

Brad McGehee 的这篇[文章](http://www.simple-talk.com/sql/learn-sql-server/how-to-track-down-deadlocks-using-sql-server-2005-profiler/)是一个很好的起点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T15:10:25.177

另请参阅：[主动死锁通知](http://blogs.lessthandot.com/index.php/DataMgmt/DBAdmin/MSSQLServerAdmin/proactive-deadlock-notifications)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T15:23:14.713

您需要在发生错误时运行死锁配置文件跟踪。Brad McGehee的[文章](http://www.simple-talk.com/sql/learn-sql-server/how-to-track-down-deadlocks-using-sql-server-2005-profiler/)是一个概述。您需要确定这两个有问题的进程。之后，查看两页中的代码，了解发出了哪些 SQL 命令以及发出的频率。大多数时候，我发现只需查看正在运行的 SQL 代码并了解它的运行频率即可快速识别冲突。修复它有时需要更长的时间...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T15:14:14.700

您可以按照错误消息的建议进行操作，并让程序重试事务！

很大程度上取决于事务的“原子”程度！即，如果您陷入僵局，则其他进程可能已成功更新您感兴趣的行。在 htese 情况下将更新应用于该行是否仍然有意义？

至少向用户显示一个更好的错误消息（“另一个用户更改了您尝试更新的 xxxx。请检查新值并重试。）

# wcf - 我可以将 System.Net.MailMessage 传递给 WCF 服务吗？

> ID：447071
> 
> 赞同：3
> 
> 时间：2009-01-15T15:03:54.923
> 
> 标签：wcf, mailmessage

我想设置 WCF 服务来发送电子邮件。System.Net.MailMessage 似乎不是可序列化的，并且不能传入`[DataContract]`

我收到的错误是

> 无法序列化类型“System.Net.Mail.MailAddress”。考虑用 DataContractAttribute 标记它

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T15:09:52.260

传递给 WCF 服务的任何内容都必须是 XML 或二进制可序列化的。

“经典”消息传递方法是：

1.  创建一个简单的 DataContract 类，该类具有 MailMessage 的所有必需属性
2.  在调用服务之前，在 DataContract 类的新实例中设置 MailMessage 的所有属性
3.  调用服务，传递 DataContract
4.  在服务内部，创建 MailMessage 的新实例并将属性分配给它，然后发送它

# c# - 获取具有特定属性的属性和值的最佳方法是什么？

> ID：447082
> 
> 赞同：1
> 
> 时间：2009-01-15T15:09:11.387
> 
> 标签：c#, reflection, attributes

鉴于此定义：

```
[UniqueId("Ident")]
public class MyClass : MyBase
{
    public int Ident{ get; }
} 
```

从“MyBase”类中获取“UniqueId”属性、找到匹配的属性名称并获取基础值的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:12:04.393

基类中的抽象方法/属性不是更合适吗？

```
public abstract int UniqueId {get;} 
```

通过属性，如下所示：

```
object GetUniqueId() // or int
{
    Type type = GetType();
    UniqueIdAttribute attrib = null;
    foreach(UniqueIdAttribute tmp in 
        type.GetCustomAttributes(typeof(UniqueIdAttribute), true))
    {
        attrib = tmp;
        break;
    }
    if (attrib == null) throw new InvalidOperationException();
    return type.GetProperty(attrib.PropertyName).GetValue(this, null);
    // perhaps cast here...         
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T15:47:15.150

我不完全明白你为什么要在课堂上使用那个属性。将它添加到属性中不是更明显，如下所示：

```
public class MyClass
{
    [UniqueId]
    public int Ident{ get; }
} 
```

您可以使用类似的方式访问此值

```
var identity = objectThatHasAnIdentity.GetId(); 
```

`GetId`现在可以是一个扩展方法，`object`它实现类似于 Marc 上面发布的代码

# mysql - 将 ORDER BY 子句添加到 MySQL 查询使其在 ~30 秒内返回，从 ~0.5

> ID：447083
> 
> 赞同：2
> 
> 时间：2009-01-15T15:09:24.303
> 
> 标签：mysql, performance, indexing, sql-order-by

所以我有这个查询在 ~0.5 秒时相对较快，但是当我添加 ORDER BY 子句时，它会跳到近 30 秒。

原始查询：（在 ~0.5 秒内返回）

```
SELECT table1.*,table2.* FROM table1 LEFT OUTER JOIN table2 ON table1.column2=table2.column3 WHERE table1.column1='value' LIMIT 4 
```

使用 ORDER BY 查询：（大约 30 秒后返回）

```
SELECT table1.*,table2.* FROM table1 LEFT OUTER JOIN table2 ON table1.column2=table2.column3 WHERE table1.column1='value' ORDER BY table1.column4 DESC LIMIT 4 
```

请注意，我向 ORDER BY 正在使用的列添加了一个索引，它没有改变任何内容。

关于什么会导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-15T15:12:02.740

这需要更长的时间，因为查询不能只选择它找到的前 4 个项目。它必须订购整个列表，然后从中选择前 4 个。

通过添加包含 table1{column4, ...} 的索引来解决此问题。如果您只需要表 1 中的几列（并且它们很窄），我会将它们**全部**添加到索引中（[覆盖索引](http://peter-zaitsev.livejournal.com/6949.html)）。

如果索引正确，SQL 引擎可以只提取您想要的前四列，而不是整个集合。

如果您*确实*有索引并且它没有帮助，请使用[EXPLAIN](http://dev.mysql.com/doc/refman/5.0/en/explain.html)运行查询以查看执行计划的样子（好提示，@IronGoofy）：

```
EXPLAIN 
  SELECT table1.*,table2.* 
  FROM table1 
  LEFT OUTER JOIN table2 ON table1.column2=table2.column3 
  WHERE table1.column1='value' ORDER BY table1.column4 DESC LIMIT 4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T15:26:22.913

同意迈克尔的解释，+1。

至于索引没有影响，请查看执行计划（不确定如何在 MySQL 中执行此操作 - 也许有人可以编辑它？）。同样，我同意迈克尔的观点，这应该会使事情变得更快（只要 column4 是“选择性的”）。

@kogus：将整个结果集检索到客户端与对结果集进行排序不同，排序应该在服务器上进行，而不需要通过网络传输所有结果

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T15:22:51.720

table1.column1 是否被索引？如果是，那么查询优化器将使用该索引从 table1 中选择初始行集，因为它在最坏的情况下是索引范围扫描（非常快）。

如果此查询是一个经常运行的查询，您可以通过在 (column1,column4) 上建立索引来获得所需的性能。我不太了解 MySQL，但是使用 Oracle，您可以通过索引 (column1,column4,column2) 进一步提高性能，这将使优化器从索引中完成所有工作，而根本不接触表数据。

**但是**，添加索引是一种折衷：它会增加每次插入（或更新索引列）所花费的时间，使您的数据库变得更大，并可能导致整体速度变慢，因为稀缺的内存资源（即缓冲区缓存）被分配给新的索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T15:33:05.100

尝试运行[解释](http://dev.mysql.com/doc/refman/5.1/en/explain.html)：

```
EXPLAIN SELECT table1.*,table2.* FROM table1 LEFT OUTER JOIN table2 ON table1.column2=table2.column3 WHERE table1.column1='value' ORDER BY table1.column4 DESC LIMIT 4 
```

这可能会告诉您 MySQL 正在执行文件排序。你可以在（column1，column4）上放一个索引吗？

你能多谈谈你的模型吗？你使用什么索引？你能显示一些解释输出吗？字段使用了哪些类型？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T15:34:13.677

[同意迈克尔](https://stackoverflow.com/questions/447083/adding-order-by-clause-to-mysql-query-makes-it-return-in-30-seconds-up-from-0#447093)提到的索引内容。

此外，在 MySQL 中，您可以通过检查将 EXPLAIN 附加到查询的结果来了解查询的性能，例如

```
EXPLAIN SELECT * FROM foo_tbl WHERE foobar = 'foo' 
```

将帮助您更好地设计查询，并适当地索引。阅读[EXPLAIN 语法](http://dev.mysql.com/doc/refman/5.0/en/explain.html)和[使用 EXPLAIN 优化查询](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T15:13:08.807

你是如何运行查询的？

某些工具通常只检索前 100 条左右的记录，并根据需要拉下更多记录。

添加 ORDER BY 会强制该工具检索整个数据集。

如果您在 MySql 浏览器中，请尝试不使用 ORDER BY 运行，然后使用 CTRL-END 滚动到数据网格的底部。这需要多长时间？

# python - Python的re模块——保存状态？

> ID：447086
> 
> 赞同：12
> 
> 时间：2009-01-15T15:09:57.207
> 
> 标签：python, regex

我在 Python 中发现的最大烦恼之一是`re`模块无法在没有明确在匹配对象中执行的情况下保存其状态。通常，需要解析行，如果它们符合某个正则表达式，则通过相同的正则表达式从它们中取出值。我想写这样的代码：

```
if re.match('foo (\w+) bar (\d+)', line):
  # do stuff with .group(1) and .group(2)
elif re.match('baz whoo_(\d+)', line):
  # do stuff with .group(1)
# etc. 
```

但不幸的是，不可能到达上一次调用的匹配对象`re.match`，所以它是这样写的：

```
m = re.match('foo (\w+) bar (\d+)', line)
if m:
  # do stuff with m.group(1) and m.group(2)
else:
  m = re.match('baz whoo_(\d+)', line)
  if m:
    # do stuff with m.group(1) 
```

随着 s 列表的增长，这不太方便并且变得非常笨拙`elif`。

一个骇人听闻的解决方案是将 re.match 和 re.search 包装在我自己的对象中，这些对象将状态保存在某处。有人用过这个吗？您是否知道半标准实现（在大型框架或其他东西中）？

您还可以推荐哪些其他解决方法？或者，我是否只是在滥用该模块并且可以以更清洁的方式满足我的需求？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T15:20:54.517

您可能会喜欢这个实现您正在寻找的包装器的[模块。](http://code.activestate.com/recipes/456151/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T19:07:53.763

尝试一些想法...

看起来您理想情况下想要一个带有副作用的表达式。如果在 Python 中允许这样做：

```
if m = re.match('foo (\w+) bar (\d+)', line):
  # do stuff with m.group(1) and m.group(2)
elif m = re.match('baz whoo_(\d+)', line):
  # do stuff with m.group(1)
elif ... 
```

...那么您将清楚而干净地表达您的意图。但事实并非如此。如果嵌套函数中允许有副作用，您可以：

```
m = None
def assign_m(x):
  m = x
  return x

if assign_m(re.match('foo (\w+) bar (\d+)', line)):
  # do stuff with m.group(1) and m.group(2)
elif assign_m(re.match('baz whoo_(\d+)', line)):
  # do stuff with m.group(1)
elif ... 
```

现在，这不仅变得丑陋，而且仍然不是有效的 Python 代码——嵌套函数“assign_m”不允许修改`m`外部范围内的变量。我能想到的最好的方法**真的**很丑，使用允许副作用的嵌套类：

```
# per Brian's suggestion, a wrapper that is stateful
class m_(object):
  def match(self, *args):
    self.inner_ = re.match(*args)
    return self.inner_
  def group(self, *args):
    return self.inner_.group(*args)
m = m_()

# now 'm' is a stateful regex
if m.match('foo (\w+) bar (\d+)', line):
  # do stuff with m.group(1) and m.group(2)
elif m.match('baz whoo_(\d+)', line):
  # do stuff with m.group(1)
elif ... 
```

但这**显然**是矫枉过正。

您可以考虑使用内部函数来允许本地范围退出，这允许您删除`else`嵌套：

```
def find_the_right_match():
  # now 'm' is a stateful regex
  m = re.match('foo (\w+) bar (\d+)', line)
  if m:
    # do stuff with m.group(1) and m.group(2)
    return # <== exit nested function only
  m = re.match('baz whoo_(\d+)', line)
  if m:
    # do stuff with m.group(1)
    return

find_the_right_match() 
```

这可以让你将嵌套=(2*N-1) 扁平化为嵌套=1，但你可能刚刚解决了副作用问题，嵌套函数很可能会让大多数 Python 程序员感到困惑。

最后，有一些无副作用的方法来处理这个问题：

```
def cond_with(*phrases):
  """for each 2-tuple, invokes first item.  the first pair where
  the first item returns logical true, result is passed to second
  function in pair.  Like an if-elif-elif.. chain"""
  for (cond_lambda, then_lambda) in phrases:
    c = cond_lambda()
    if c:
      return then_lambda(c) 
  return None

cond_with( 
  ((lambda: re.match('foo (\w+) bar (\d+)', line)), 
      (lambda m: 
          ... # do stuff with m.group(1) and m.group(2)
          )),
  ((lambda: re.match('baz whoo_(\d+)', line)),
      (lambda m:
          ... # do stuff with m.group(1)
          )),
  ...) 
```

现在代码甚至**看起来都**不像 Python，更不用说 Python 程序员可以理解了（那是 Lisp 吗？）。

我认为这个故事的寓意是 Python 没有针对这种习语进行优化。你真的需要稍微冗长一点，并忍受 else 条件的大量嵌套因素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T19:05:47.697

您可以编写一个实用程序类来执行“保存状态并返回结果”操作。我认为这不是那么骇人听闻。实现起来相当简单：

```
class Var(object):
    def __init__(self, val=None): self.val = val

    def set(self, result):
        self.val = result
        return result 
```

然后将其用作：

```
lastMatch = Var()

if lastMatch.set(re.match('foo (\w+) bar (\d+)', line)):
    print lastMatch.val.groups()

elif lastMatch.set(re.match('baz whoo_(\d+)', line)):
    print lastMatch.val.groups() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T19:12:13.613

```
class last(object):
  def __init__(self, wrapped, initial=None):
    self.last = initial
    self.func = wrapped

  def __call__(self, *args, **kwds):
    self.last = self.func(*args, **kwds)
    return self.last

def test():
  """
  >>> test()
  crude, but effective: (oYo)
  """
  import re
  m = last(re.compile("(oYo)").match)
  if m("abc"):
    print("oops")
  elif m("oYo"): #A
    print("crude, but effective: (%s)" % m.last.group(1)) #B
  else:
    print("mark")

if __name__ == "__main__":
  import doctest
  doctest.testmod() 
```

`last`也适合作为装饰者。

意识到在我努力使其自我测试并在 2.5、2.6 和 3.0 中工作时，我有点模糊了真正的解决方案。重要的行在上面标记为#A 和#B，您使用相同的对象来测试（命名它`match`或`is_somename`）并检索它的最后一个值。很容易被滥用，但也很容易调整，如果不推得太远，就会得到令人惊讶的清晰代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T09:38:38.667

基于对这个问题的出色回答，我制定了以下机制。这似乎是解决 Python 的“无条件赋值”限制的一般方法。重点是透明度，由静默委托实现：

```
class Var(object):
    def __init__(self, val=None):
        self._val = val

    def __getattr__(self, attr):
        return getattr(self._val, attr)

    def __call__(self, arg):
        self._val = arg
        return self._val

if __name__ == "__main__":
    import re

    var = Var()

    line = 'foo kwa bar 12'

    if var(re.match('foo (\w+) bar (\d+)', line)):
        print var.group(1), var.group(2)
    elif var(re.match('baz whoo_(\d+)', line)):
        print var.group(1) 
```

在一般情况下，这是一个线程安全的解决方案，因为您可以创建自己的`Var`. 当线程不是问题时，为了更易于使用，可以导入和使用默认的 Var 对象。这是一个包含 Var 类的模块：

```
class Var(object):
    def __init__(self, val=None):
        self._val = val

    def __getattr__(self, attr):
        return getattr(self._val, attr)

    def __call__(self, arg):
        self._val = arg
        return self._val

var = Var() 
```

这是用户的代码：

```
from var import Var, var
import re

line = 'foo kwa bar 12'

if var(re.match('foo (\w+) bar (\d+)', line)):
    print var.group(1), var.group(2)
elif var(re.match('baz whoo_(\d+)', line)):
    print var.group(1) 
```

虽然不是线程安全的，但对于许多简单的脚本来说，这提供了一个有用的快捷方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-12-05T19:47:28.447

Python 3.8 现在为我们提供了一个简洁的解决方案：（`:=`海象[运算符](https://realpython.com/lessons/assignment-expressions/)）。

它将右侧的值分配给左侧的变量，然后返回该值。

基本上，我们终于可以实现@aaron 的愿望，简单地写：

```
if m := re.match('foo (\w+) bar (\d+)', line):
  # do stuff with m.group(1) and m.group(2)
elif m := re.match('baz whoo_(\d+)', line):
  # do stuff with m.group(1)
elif ... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-10T09:29:32.893

可能最简单的解决方案是提前返回，这样您就可以重新创建变量，而无需立即进行测试。

```
def get_results(line):
    m = re.match('foo (\w+) bar (\d+)', line)
    if m:
      # do stuff with .group(1) and .group(2)
      return result
    m = re.match('baz whoo_(\d+)', line)
    if m:
      # do stuff with .group(1)
      return other_result
    # etc. 
```

这样可以避免过度嵌套。

# c# - 将图像嵌入文本框

> ID：447089
> 
> 赞同：2
> 
> 时间：2009-01-15T15:11:08.187
> 
> 标签：c#, winforms

我有一个 Windows Forms (.Net 2.0) 应用程序，并且我有一个将一些自定义图像嵌入到一些文本框中的请求（就像新版本的 Tortoise 一样）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:17:49.840

我没有在文本框上使用 OwnerDraw，但我在其他控件（例如列表框和列表视图）上使用过它，并且我看到其他人使用文本框这样做。我找到了一个应该为您指明正确方向的教程，它本身并不用于在文本框中显示图像，但它可以用于：

[http://www.codedblog.com/2007/09/17/owner-drawing-a-windowsforms-textbox/](http://www.codedblog.com/2007/09/17/owner-drawing-a-windowsforms-textbox/)

希望这至少能让你开始......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T07:31:25.243

唔。为什么不创建一个具有 TextBox 的 BackColor 的新用户控件。隐藏文本框的边框。然后订阅 UC 的 Paint 事件并绘制边框以类似于文本框之一。在 Paint Handler 中，您还可以绘制图像。在 UserControl 中，您可以轻松设置任何子控件（如文本框）的边界，或编写自定义布局并将文本框放置在您想要的任何位置。我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T08:39:24.187

您可以做的是创建一个继承自 System.Windows.Forms.TextBox 类的新类。然后您必须使用设置控件的 UserPaint 样式

```
SetStyle(ControlStyles.UserPaint, true) 
```

在构造函数中使您能够自己绘制文本框，最后您必须覆盖 OnPaint 或 OnPaintBackground 以绘制控件。

我怀疑这不会是微不足道的，因为文本绘图可能非常复杂，但它应该是可能的。

# crystal-reports - 从水晶报表 8 迁移到水晶报表 2008

> ID：447092
> 
> 赞同：2
> 
> 时间：2009-01-15T15:11:41.647
> 
> 标签：crystal-reports, migration

如何将 Crystal Reports 8.0 迁移到 Crystal Reports 2008？

8.0存储过程的水晶报表在2008年没有执行，谁能帮忙？

我们正在使用 Seagate Crystal Reports 8 并希望将所有程序迁移到 Crystal Reports 2008 Visual Studio

你能解释一下这个的利弊吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:15:27.990

我已经从 8 迁移到 XI 没有问题（只需在 XI 中打开报告并另存为）。

您是否尝试过像 XI 这样的中间版本，然后在 2008 年从那个版本开始？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-11T13:44:37.593

您会在公式中发现一些细微的句法差异，主要与分号有关。例如，这适用于 Crystal 8 和 Crystal 8.5 ：

```
If {tblMaster.StatusID} In [1,3] Then
    Select {tblLinkTranx.TranxCodeID}
        Case 3 :
            {tblLinkTranx.TranxAmt}
        Case 4 :
            - {tblLinkTranx.TranxAmt}
        Default :
            0;
Else
    0 
```

要在 Crystal 9、10、11、11.5 或 2008 中使用相同的公式，您需要删除 ; 或将 Select 子句括在括号中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-11T13:28:05.937

如果您的 v8 报告使用 store()/fetch() 在主报告和子报告之间传递数据，则需要将其更改为使用共享变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-06T16:03:33.593

我建议制作一份报告副本作为备份。原因是您可以升级版本，但不能降级版本。

完成备份后，只需在 Crystal Developer 中打开文件即可。它会立即提示您正在使用旧的报告格式，如果您想将报告更新到您正在使用的 Developer 版本，则会提供确定/取消提示。Crystal 已构建为支持向后兼容性。升级过程应该是无缝的。

# java - java和javascript回调比较

> ID：447097
> 
> 赞同：2
> 
> 时间：2009-01-15T15:12:41.600
> 
> 标签：java, javascript, closures, callback

看来我并不像我想象的那样理解 javascript 回调。

在以下示例中，我认为 setTimeout 中的每个函数副本都将引用其自己的变量“index”副本。因此，运行该示例应产生以下警报：“零”“一”“二”。

```
var array = ["zero", "one", "two"];
var out = "";
for(var i = 0; i < 3; i++){
    var index = i;
    setTimeout(  function(){alert(array[index])},  1 );
} 
```

但是，似乎索引变量只有一个副本，并且回调函数的所有副本都指向同一个变量，给我以下警报：“两个”“两个”“两个”。

java中的以下类似（我认为）示例按预期打印“零”“一”“二”。

```
import java.util.ArrayList;
import java.util.List;

public class CallBacks {

  public static void main(String[] args) {

    String[] array = {"zero", "one", "two"};
    List<Callback> callBacks = new ArrayList<Callback>();
    for(int i = 0; i<3; i++){
      final String print = array[i];
      callBacks.add(
              new Callback(){
                public void execute(){
                  System.out.println(print);
                }
              }
      );
    }
    for(Callback cb : callBacks){
      cb.execute();
    }
  }

  private interface Callback{
    public void execute();
  }

} 
```

谁能向我解释为什么 js 示例不起作用，或许可以比较两个示例中发生的情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T15:17:36.533

`index`随着循环的每次迭代而变化。您想要的是`index`放入不受循环影响的闭包中：

```
var array = ["zero", "one", "two"];
var out = "";
for(var i = 0; i < 3; i++) {
    (function(index) {
        setTimeout(  function(){alert(array[index])},  1 );
    })(i)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T15:20:27.450

在 javascript 中，for 循环没有它自己的范围 - 所以您在循环内创建的 var 与在循环外定义的 var 没有什么不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:53:30.943

[JavaScript 中的私有成员](http://www.crockford.com/javascript/private.html)是我最喜欢的关于闭包的参考。它被编写为在 JS 对象中提供私有变量的秘诀（可能有用，也可能没有），但在此过程中，它很好地介绍了闭包的一般工作原理，尤其是在 JS 中。

[comp.lang.javascript FAQ](http://www.jibbering.com/faq/faq_notes/closures.html#clClDo)也有一个关于闭包的有价值的部分。

闭包可能会令人困惑，所以我整理了一个[我遇到的最短有用闭包的工作示例，](http://onemorebug.com/blog/2007/05/06/neat-little-example-of-a-useful-javascript-closure-2/)它在 Rhino 书中。

哦，我还没有足够的代表发表评论 :) 但我在上面看到了你关于为什么有时必须在函数周围加上括号的问题。仅当您内联*调用*匿名函数时才需要这样做。例如这里需要括号：

```
(function (arg) {alert(arg);})('hi world'); 
```

因为您正在创建一个函数，然后立即调用它。但是在您只是声明一个命名函数供以后使用的通常情况下，括号不是必需的。

# bash - 在 bash 脚本中临时重定向 stderr

> ID：447101
> 
> 赞同：4
> 
> 时间：2009-01-15T15:13:21.037
> 
> 标签：bash, segmentation-fault, redirect, stdin, stderr

我有一个简单的脚本，用于启动另一个程序。这个其他程序有时可能会产生一个`SIGSEGV`，这会破坏我的输出。因此，我添加了几行应该临时将 重定向`stderr`到被忽略`/dev/null`的行。`SIGSEGV`以下是我的代码草稿：

```
exec 2> /dev/null
progname >& ./tmp/run.txt && run_status='OK'
exec 2>1 
```

问题是最后一行没有做我想要的。第一行显然有效，并将`stderr`. 最后一行应该返回`stderr`到它之前的位置（我只认为它与 相同`stdout`）。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T15:48:55.893

另一种选择是：

```
exec 3> /dev/stderr 2> /dev/null
progname >& ./tmp/run.txt && run_status='OK'
exec 2>&3 
```

甚至

```
exec 3>&2 2> /dev/null
progname >& ./tmp/run.txt && run_status='OK'
exec 2>&3 
```

这样，脚本保留了脚本的 stdout 和 stderr 的分离（即脚本 stdout 和 stderr 可以单独重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T15:15:45.633

为什么不只为 progname 运行重定向它？

```
 progname > ./tmp/run.txt 2>/dev/null && run_status='OK' 
```

或者可能

```
{
   progname > ./tmp/run.txt && run_status='OK'
} 2>/dev/null 
```

# asp.net - ASCX 文件

> ID：447103
> 
> 赞同：1
> 
> 时间：2009-01-15T15:13:29.117
> 
> 标签：asp.net

我有一个仅包含 .ascx 文件的 Web 应用程序项目。我构建它以创建一个 dll，然后从另一个 Web 应用程序项目中引用该 dll。我是否还需要在网站上复制 .ascx 文件。如果我需要复制它们，我需要将它们放在哪里？

**编辑：我能够解决这个问题的原因。**

 **包含 ascx 文件的 Web 应用程序是一个转换为 Web 应用程序的网站项目。在这个转换过程中，一些命名空间被破坏了，因此我们得到了如下命名空间：SmartDev.SmartDev 而不仅仅是 SmartDev。** 

**我不得不修改 web.config 文件中的标签前缀条目以使用“SmartDev.SmartDev”并且它起作用了。我不得不去html中的每个位置并更改修改后的类文件名......**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T15:24:55.740

是的，您需要 .ascx 文件。将它们放在目录结构中的某个逻辑位置，您可以从实例化控件的任何位置引用该目录结构。

# user-interface - 您如何处理针对不同客户的表单定制？

> ID：447105
> 
> 赞同：4
> 
> 时间：2009-01-15T15:13:39.820
> 
> 标签：user-interface, forms, customization

在我们的应用程序中，我们有时必须为不同的客户进行少量的 GUI 修改：

*   一位客户有一个其他客户没有的输入字段。
*   另一位客户拥有所有默认字段，但其中一个可选输入字段是强制性的。
*   第三位客户拥有默认字段，但其中一个字段的标题已更改
*   第四个客户有几个新的输入字段，一个现有的多行输入字段必须更改为单行输入字段（为新字段腾出空间）
*   ...

（注意：虽然这些例子听起来很尴尬，但这些都是我们的客户要求的）

您如何处理这些案件？

*   一般来说
*   在 Java/Swing 中

目前我们以最常见的方式设计表单。在运行时，我们会进行调整，例如隐藏、调整大小或重新定位字段。在输入验证时，我们根据活跃客户验证内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T15:20:52.940

有几种不同的方法可以解决这个问题。但是，它非常依赖于情况。

1.  不要在同一个屏幕中添加不同的客户逻辑，而是为每个客户设置一个不同的屏幕，每个人都使用一个默认屏幕。

2.  自定义构建或客户分支。尽管这可能会变得非常复杂。

3.  完全像您所做的那样在屏幕中嵌入客户特定的逻辑。

4.  使用某种类型的规则引擎来驱动您的界面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T15:34:55.453

我可以想到4种方法：

1.  不。是的，我知道现在为时已晚，但如果您能侥幸逃脱，请始终销售标准产品。

如果那不可能……

2.  建立一个特征矩阵，每个客户都可以通过勾选框（禁用字段、当前强制、当前可选等）来定义自己的要求。它限制了您在 UI 中呈现信息的方式——您倾向于更简单的设计，但它具有可扩展性和灵活性。
3.  每个客户都有一个自定义页面，每个页面在业务逻辑和验证方面都支持自己。也许您可以为每位客户提供 3 或 4 个变体。
4.  分枝。如果您这样做，请确保客户付款，因为它是昂贵的 PITA。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T15:57:50.073

本期有表单布局、数据库存储和可配置业务逻辑三个方面。

**配置驱动的表单布局**

可以通过将布局移动到描述符文件来实现表单布局的灵活方法。支持此功能的三个 GUI 工具包是 QT、WPF 和 XUL。但是，AFAIK Swing 不直接支持此功能。QT Jambi 确实允许您在 Java 上使用 QT 作为 Swing 的替代方案，并且 QT 4.5 将提供 LGPL 许可。这不是一个纯 java 的解决方案，但如果这个和随之而来的 UI 代码的重写是可以接受的，那么它可能是一种可能性。

配置驱动的表单布局的优点是可以进行定制，而无需为每个客户维护单独的构建，因此即使您有现有的代码库，您也可能希望检查是否存在采用此类的商业案例一个工具包与维护多个客户特定的构建。但是，对于编译语言，您可能仍需要为生成的表单代码设置某种插件框架。

**可配置的数据库存储**

这更复杂。您可以通过三种方式做到这一点，它们各有利弊。

1.  第一种方法是在表上设置一系列“用户”字段，例如“用户 1”、“用户 2”等。表单上的配置字段可以映射到这些字段 - 并且不应该使用通用用户字段映射工具难以实施。从数据库查询的角度来看，这是最有效的，但受到可能字段数量有限的限制。如果您有“User1”到“User20”字段，则只能支持 20 个用户定义的属性。此外，它们必须是很好的、广泛的泛型 varchar，因此您不会从数据库中获得类型安全。

2.  第二种方法是将属性表挂在实体上。这不会为您提供类型安全性，但确实可以让您拥有任意数量的属性。为此构建一个通用处理程序也是非常可行的，但是当您对属性表进行多次连接时，查询性能会受到影响。

3.  在 XML blob 中保留用户定义的字段。这没什么可推荐的，因为它使通过数据库访问数据变得更加困难。但是，我已经看到它完成了。

**可配置的业务逻辑**

这是一个更加棘手的问题。在不添加自定义代码和更改构建的情况下，您可以使用一些选项来执行可配置的业务规则：规则引擎、脚本语言或一组标准的开/关功能，例如必填字段。

1.  规则引擎：你真的必须从头开始设计你的应用程序才能使用它们，它们有自己的局限性和弱点。ILOG，这个领域的老牌，也是相当昂贵的。对于 java，JESS 可能是一个选项。

2.  嵌入式脚本语言：通过为 Jython、Groovy 或其他一些 JVM 友好的解释语言添加解释器，您可以为系统编写插件，而无需发布新的构建。仍然会产生一些测试工作量，但这可能是总体上的维护胜利。

3.  功能的开/关配置。这是最不灵活的选项，但相对简单，并且在外部依赖和许可成本方面增加的相对较少。如果您尝试将配置改造成作为定制应用程序开始生活的东西，它也可能是您唯一的选择。

**以上都不是**

如果答案是“以上都不是”，那么您可能会被自定义构建所困扰。在这种情况下，为表单创建一个插件架构，这样您至少可以将客户特定的项目隔离到一个单独的模块中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T15:18:41.290

我不确定这是什么类型的应用程序，但是当我们收到有冲突的功能请求时，我们通常会分支出每个客户端的版本，并且在每个分支中只包含相关代码。

您是否使用任何类型的代码控制/版本控制系统？SVN 是我们使用的，它允许您在更改主代码时更新每个分支，因此代码永远不会过时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T15:26:11.697

我会做一些类似于 MS Access 内的表格创建屏幕的事情，允许客户自己添加/删除/修改和设置输入。它还允许他们设置哪些字段是强制性的，哪些不是。这意味着您需要在前端做更多的工作，而在后端做更少的工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T15:33:07.237

我建议使用某种插件系统。对于每个客户，只需创建一个插件来修改应用程序的 UI 并在启动时加载它。我不是 Java 程序员，所以恐怕我不能发布任何特定的代码片段。

# python - 编码/解码有什么区别？

> ID：447107
> 
> 赞同：184
> 
> 时间：2009-01-15T15:13:59.850
> 
> 标签：python, string, unicode, character-encoding, python-2.x

我一直不确定我是否理解 str/unicode 解码和编码之间的区别。

我知道这`str().decode()`是因为当你有一个你知道具有某种字符编码的字节字符串时，考虑到该编码名称，它将返回一个 unicode 字符串。

我知道`unicode().encode()`根据给定的编码名称将 unicode 字符转换为字节串。

但我不明白什么`str().encode()`和`unicode().decode()`是为了什么。任何人都可以解释，并可能纠正我在上面弄错的任何其他内容吗？

编辑：

几个答案提供了`.encode`关于字符串的作用的信息，但似乎没有人知道`.decode`unicode 的作用。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-01-16T02:06:33.917

unicode 字符串的`decode`方法实际上根本没有任何应用程序（除非您出于某种原因在 unicode 字符串中有一些非文本数据——见下文）。我认为这主要是出于历史原因。在 Python 3 中，它完全消失了。

`unicode().decode()`将使用默认（ascii）编解码器执行隐式*编码*。`s`像这样验证：

```
>>> s = u'ö'
>>> s.decode()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
UnicodeEncodeError: 'ascii' codec can't encode character u'\xf6' in position 0:
ordinal not in range(128)

>>> s.encode('ascii')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
UnicodeEncodeError: 'ascii' codec can't encode character u'\xf6' in position 0:
ordinal not in range(128) 
```

错误消息完全相同。

因为`str().encode()`它是另一种方式 - 它尝试使用默认编码进行隐式*解码：*`s`

```
>>> s = 'ö'
>>> s.decode('utf-8')
u'\xf6'
>>> s.encode()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 0:
ordinal not in range(128) 
```

这样用，`str().encode()`也是多余的。

**但是**后一种方法的另一个应用是有用的：有些[编码](http://docs.python.org/library/codecs.html#standard-encodings)与字符集无关，因此可以以有意义的方式应用于 8 位字符串：

```
>>> s.encode('zip')
'x\x9c;\xbc\r\x00\x02>\x01z' 
```

不过，您是对的：这两个应用程序对“编码”的模棱两可的用法是……很尴尬。同样，在 Python 3 中使用单独的`byte`和`string`类型，这不再是一个问题。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2009-01-15T20:41:48.377

将 unicode 字符串表示为字节字符串称为**编码**。使用`u'...'.encode(encoding)`.

例子：

```
    >>> u'æøå'.encode('utf8')
    '\xc3\x83\xc2\xa6\xc3\x83\xc2\xb8\xc3\x83\xc2\xa5'
    >>> u'æøå'.encode('latin1')
    '\xc3\xa6\xc3\xb8\xc3\xa5'
    >>> u'æøå'.encode('ascii')
    UnicodeEncodeError：“ascii”编解码器无法对位置 0-5 中的字符进行编码：
    序数不在范围内（128）

```

您通常在需要将 unicode 字符串用于 IO 时对其进行编码，例如通过网络传输它，或将其保存到磁盘文件中。

将字节字符串转换为 unicode 字符串称为**解码**。使用`unicode('...', encoding)`或'...'。解码（编码）。

例子：

```
   >>> u'æøå'
   u'\xc3\xa6\xc3\xb8\xc3\xa5' # 解释器像这样打印 unicode 对象
   >>> unicode('\xc3\xa6\xc3\xb8\xc3\xa5', 'latin1')
   你'\xc3\xa6\xc3\xb8\xc3\xa5'
   >>> '\xc3\xa6\xc3\xb8\xc3\xa5'.decode('latin1')
   你'\xc3\xa6\xc3\xb8\xc3\xa5'

```

每当您从网络或磁盘文件接收到字符串数据时，您通常会解码一串字节。

我相信 python 3 中的 unicode 处理有一些变化，所以上述对于 python 3 可能不正确。

一些很好的链接：

*   [每个软件开发人员绝对、绝对必须了解 Unicode 和字符集的绝对最低要求（没有借口！）](http://www.joelonsoftware.com/articles/Unicode.html)
*   [统一码如何](http://docs.python.org/howto/unicode.html)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-16T23:11:40.193

一个Unicode。**encode** ('encoding') 产生一个**字符串**对象，可以在 unicode 对象上调用

一个字符串。**decode** ('encoding') 产生一个**unicode**对象，可以在字符串上调用，以给定的编码进行编码。

* * *

更多解释：

您可以创建一些没有任何编码集的 unicode 对象。Python 将它存储在内存中的方式与您无关。您可以搜索、拆分并调用您喜欢的任何字符串操作函数。

但是有一段时间，您想将 unicode 对象打印到控制台或某个文本文件中。所以你必须对其**进行编码**（例如 - 在 UTF-8 中），你调用 encode('utf-8') 并且你会得到一个内部带有 '\u<someNumber>' 的字符串，这是完全可打印的。

然后，再次 - 你想做相反的事情 - 读取以 UTF-8 编码的字符串并将其视为 Unicode，因此 \u360 将是一个字符，而不是 5。然后你**解码**一个字符串（使用选定的编码）和获取 unicode 类型的全新对象。

顺便说一句-您可以选择一些变态编码，例如“zip”、“base64”、“rot”，其中一些会从字符串转换为字符串，但我相信最常见的情况是涉及 UTF-8 /UTF-16 和字符串。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-15T16:15:39.677

mybytestring.encode(somecodec) 对以下值有意义`somecodec`：

*   base64
*   bz2
*   zlib
*   十六进制
*   夸普里
*   rot13
*   string_escape
*   你

我不确定解码已经解码的 unicode 文本有什么好处。尝试使用任何编码似乎总是首先尝试使用系统的默认编码进行编码。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-15T15:20:41.053

有一些编码可用于从 str 到 str 或从 unicode 到 unicode 进行解码/编码。例如 base64、hex 甚至 rot13。它们列在[编解码器模块](http://docs.python.org/library/codecs.html)中。

编辑：

unicode 字符串上的解码消息可以撤消相应的编码操作：

```
In [1]: u'0a'.decode('hex')
Out[1]: '\n' 
```

返回的类型是 str 而不是 unicode，这在我看来是不幸的。但是，当您没有在 str 和 unicode 之间进行正确的编码/解码时，无论如何这看起来都是一团糟。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-01-03T07:16:42.207

简单的答案是它们彼此完全相反。

计算机使用最基本的字节单位来存储和处理信息；对人眼来说是没有意义的。

例如，'\xe4\xb8\xad\xe6\x96\x87' 是两个汉字的表示，但计算机只有在给定字典查找时才知道（意味着打印或存储）它是汉字中文单词，在这种情况下，它是一个“utf-8”字典，如果您查看不同或错误的字典（使用不同的解码方法），它将无法正确显示预期的中文单词。

在上述情况下，计算机查找中文单词的过程是`decode()`。

而计算机将中文写入计算机内存的过程是`encode()`。

所以编码信息是原始字节，解码信息是原始字节和要引用的字典的名称（但不是字典本身）。

# sql - SQL Server 中的临时表用法

> ID：447115
> 
> 赞同：5
> 
> 时间：2009-01-15T15:15:16.103
> 
> 标签：sql, sql-server, tsql, star-schema

这是一个悬而未决的问题，但我真的很想听听人们的意见。

我很少使用显式声明的临时表（表变量或常规#tmp 表），因为我相信不这样做会导致更简洁、可读和可调试的 T-SQL。我还认为，在需要时（例如在查询中使用派生表时），SQL 可以比我更好地利用临时存储。

唯一的例外是当数据库不是典型的关系数据库而是星型或雪花模式时。我知道最好先将过滤器应用于事实表，然后使用生成的临时表从您的维度中获取值。

这是普遍观点还是有人持反对意见？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-15T15:38:46.040

临时表对于报告或 ETL 作业等复杂的批处理过程最有用。通常，您希望在事务应用程序中很少使用它们。

如果您正在使用涉及多个大表（可能用于报告）的连接进行复杂查询，则查询优化器实际上可能无法一次优化，因此临时表在这里成为一种胜利 - 它们将查询分解为一系列更简单的那些给查询优化器更少的机会来搞砸计划。有时您的操作根本无法在单个 SQL 语句中完成，因此需要多个处理步骤才能完成这项工作。同样，我们在这里讨论更复杂的操作。

您还可以为中间结果创建一个临时表，然后对该表进行索引，甚至可能在其上放置一个聚集索引以优化后续查询。在不允许将索引添加到数据库模式的系统上，这也可能是一种快速而肮脏的优化报表查询的方法。SELECT INTO 对于这种类型的操作很有用，因为它的日志记录最少（因此速度很快）并且不需要对齐选择和插入的列。

其他原因可能包括使用 CROSS APPLY 和 xpath 查询从 XML 字段中提取数据。通常，将其提取到临时表中然后在临时表上工作会更有效。对于某些任务，它们也比 CTE 快得多，因为它们实现了查询结果而不是重新评估查询。

需要注意的一点是，临时表与查询引擎用于存储中间连接结果的结构完全相同，因此使用它们不会降低性能。临时表还允许使用集合操作进行多阶段任务，并使游标在 T-SQL 代码中几乎（不是完全但几乎）不必要。

'Code Smell' 言过其实，但如果我看到很多涉及临时表的简单操作，我会想知道发生了什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T15:33:09.780

这真的取决于你在做什么。我通常会尽量避免它们，但有时你需要做一些需要多个步骤的复杂操作。通常，这远远超出了从表中选择的简单内容。像其他任何东西一样，它是您必须知道何时使用的工具。

我同意你的观点，我通常让数据库在幕后处理事情，但有时它的优化已关闭，你必须进去手动完成。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T15:16:30.127

我将临时表视为一种 SQL 代码气味，只能作为最后的手段使用。如果您必须在获得最终结果集之前缓存数据，那么这通常表明我的数据库设计不佳。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-02-26T00:24:29.977

临时表当然有适当的用途，如果使用得当，它们不是代码味道。它们的优点之一是它们位于 tempdb 中，它通常设置为简单恢复模式。这意味着，如果您将临时表用于它们的优点（主要是批量操作），那么与相同操作在生产数据库中的表上执行的操作相比，您生成的日志量最少，这可能是在完全恢复模式。

如果，正如另一张海报所建议的那样，您的生产数据库在良好的硬件上，但您的 tempdb 不是，请让您的 DBA 移动它。SQL Server 本身大量使用 tempdb 来处理您的查询，因此 tempdb 拥有一个高性能的主页非常重要。

表变量是完全不同的生物。他们只活在记忆中。它们的一个很好的用途是，如果您有一个函数，您需要使用 CROSS APPLY 为查询中的每一行调用该函数。如果该函数很昂贵，但您可以从中获得的不同结果的数量很少，那么您可能会通过预先计算所有可能调用的结果（或者可能对您的数据集的所有可能调用）的结果并将其存储在表变量，然后加入该表变量而不是使用 CROSS APPLY。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T20:38:29.897

我也避免使用临时表。据我了解，MS SQL Server 上的临时表始终位于主数据库的文件组中。这意味着，虽然您的生产应用程序表很可能位于一些昂贵的高性能 RAID 设置上，但您的临时表位于安装 MS SQL Server 的任何位置，很可能位于 C: 驱动器的 Program Files 目录下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-21T18:30:24.623

当您有一个需要检索一次并在后续语句中反复使用的数据集时也很有用。

使这些长批处理过程更具可读性（有时这比性能更重要）。

# python - Django：将博客条目查看次数加一。这有效率吗？

> ID：447117
> 
> 赞同：28
> 
> 时间：2009-01-15T15:15:31.313
> 
> 标签：python, database, django, performance

我的索引视图中有以下代码。

```
latest_entry_list = Entry.objects.filter(is_published=True).order_by('-date_published')[:10]
for entry in latest_entry_list:
    entry.views = entry.views + 1
    entry.save() 
```

如果从初始查询返回十个（限制）行，保存问题是否会发出 10 次对数据库的单独更新调用，或者 Django 是否“智能”足以仅发出一次更新调用？

有没有更有效的方法来达到这个结果？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-05-20T18:23:57.907

您可以`F()`为此使用对象。

这是您的导入方式`F`：`from django.db.models import F`

**[Django 1.1 中的新功能](http://docs.djangoproject.com/en/dev/topics/db/queries/#updating-multiple-objects-at-once)。**
对更新的调用也可以使用 F() 对象根据模型中另一个字段的值来更新一个字段。这对于根据当前值递增计数器特别有用。

```
Entry.objects.filter(is_published=True).update(views=F('views')+1) 
```

尽管您无法对切片查询集进行更新...**编辑：实际上您可以...**

这可以完全在 django ORM 中完成。您需要两个 SQL 查询：

1.  进行过滤并收集主键列表
2.  对匹配任何这些主键的项目的非切片查询集进行更新。

获取非切片查询集是困难的。我想知道使用[`in_bulk`](http://docs.djangoproject.com/en/dev/ref/models/querysets/#in-bulk-id-list)，但它返回一个字典，而不是一个查询集。人们通常会使用它[`Q objects`](http://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)来执行复杂的 OR 类型查询，这会起作用，但[`pk__in`](http://docs.djangoproject.com/en/dev/ref/models/querysets/#in)做起来更简单。

```
latest_entry_ids = Entry.objects.filter(is_published=True)\
                                      .order_by('-date_published')
                                      .values_list('id', flat=True)[:10]  
non_sliced_query_set = Entry.objects.filter(pk__in=latest_entry_ids)  
n = non_sliced_query_set.update(views=F('views')+1)  
print n or 0, 'items updated' 
```

由于 django 懒惰地执行查询的方式，无论更新多少项目，这只会导致 2 次数据库命中。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-15T16:22:34.437

您可以在单个事务中处理更新，这可以显着提高性能。使用一个单独的函数，用@transaction.commit_manually 装饰。

```
@transaction.commit_manually
def update_latest_entries(latest_entry_list):
    for entry in latest_entry_list:
        entry.views += 1
        entry.save()
    transaction.commit() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T19:50:01.803

如果您真的需要效率，那么此时您必须进入 SQL 并自己运行更新。不过，在这种情况下，这不值得增加复杂性。

[通过 Django 1.1，您将能够通过 ORM 使用F() 对象](http://groups.google.com/group/django-developers/browse_thread/thread/c8cff7e5e16c692a/64f348822f2d43e5?lnk=gst&q=F()#64f348822f2d43e5)在单个 SQL 调用中执行此操作，以引用更新值中的字段。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T15:19:08.730

**修改**

您正在更新 10 个独立的、单独的、不同的对象。

这 10 个独立的、单独的、不同的更新不能轻易地折叠成一个以某种方式触及 10 个对象的神奇更新。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-11T20:50:46.170

对上一个条目的性能改进。这导致一个数据库命中，带有一个子查询。

```
latest_entry_query_set = Entry.objects.filter(is_published=True)
                                      .order_by('-date_published')[:10]  
non_sliced_query_set = Entry.objects.filter(pk__in=latest_entry_query_set.values('id'))  
n = non_sliced_query_set.update(views=F('views')+1)  
print n or 0, 'items updated' 
```

# c# - 当设备在 Windows Mobile 中启动时，如何启动应用程序？

> ID：447121
> 
> 赞同：2
> 
> 时间：2009-01-15T15:16:59.437
> 
> 标签：c#, .net, windows-mobile, compact-framework

正如标题所说。我希望我的应用程序在 Windows Mobile 设备打开时启动？我正在使用 C# 中的 .NET Compact Framework 3.5 开发此应用程序。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T15:33:21.963

要启动您的应用程序，首先我们需要定义“开启”。

有“软复位”：这里有几个选择。到目前为止，最简单的方法是在 \Windows\Startup 文件夹中放置一个 shrtcut。

有“从睡眠中恢复”。这有点复杂，因为您必须在此之前运行一些东西。这里最简单的机制是使用 NOTIFICATION_EVENT_WAKEUP 事件向[CeRunAppAtEvent注册您的应用程序。](http://msdn.microsoft.com/en-us/library/aa932775.aspx)您必须[P/Invoke 它](http://pinvoke.net/default.aspx/coredll/CeRunAppAtEvent.html)，因为它没有内置的托管方法。

编辑：还有“硬重置后”。一些 OEM 提供了一种机制来运行应用程序或从冷启动（例如符号）执行某种形式的逻辑。您必须查看设备 OEM 的文档以了解其工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T07:05:51.227

虽然 Startup 文件夹确实有效，但当您的应用程序需要其他项目（应用程序、驱动程序、硬件等）首先启动并启动和运行时，您可能会遇到问题，具体取决于您的配置。我已经为带有 CF 存储卡的设备开发，其中 CF 卡在启动后需要几秒钟才能挂载并可用，因此无法在重置后立即自动启动位于该 CF 卡上的应用程序，因此启动文件夹解决方案失败. 在这种情况下，您可能需要查看注册表中的 Launchxx 条目，以便您更好地控制起始顺序：http: [//msdn.microsoft.com/en-us/library/aa915408.aspx](http://msdn.microsoft.com/en-us/library/aa915408.aspx)

# sql-server - 我可以有一个外键引用 SQL Server 视图中的列吗？

> ID：447122
> 
> 赞同：89
> 
> 时间：2009-01-15T15:17:15.630
> 
> 标签：sql-server, view, foreign-keys

在 SQL Server 2008 中并给出

```
TableA(A_ID, A_Data)
TableB(B_ID, B_Data)
ViewC(A_or_B_ID, A_or_B_Data) 
```

是否可以定义`TableZ(A_or_B_ID, Z_Data)`这样的`Z.A_or_B_ID`列被限制在中找到的值`ViewC`？这可以通过针对视图的外键来完成吗？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2009-01-15T15:25:06.597

您不能在外键中引用视图。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-03-10T08:59:26.590

在较旧的 SQL Server 版本中，外键只能通过触发器来实现。您可以通过创建一个插入触发器来模拟自定义外键，该触发器检查插入的值是否也出现在相关表之一中。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-15T15:36:45.530

如果你真的需要`A_or_B_ID`在 TableZ 中，你有两个类似的选择：

1)向表 z添加可空列`A_ID`和列，在这两个列上使用 ISNULL 创建一个计算列，并添加一个 CHECK 约束，使得只有一个or不为空`B_ID``A_or_B_ID``A_ID``B_ID`

2) 向表 z 添加一个 TableName 列，限制为包含 A 或 B。现在创建`A_ID`并`B_ID`作为计算列，这些列仅在其适当的表被命名时才为非空（使用 CASE 表达式）。让他们也坚持

在这两种情况下，您现在都拥有`A_ID`和`B_ID`列，这些列可以具有基表的适当外键。不同之处在于计算哪些列。此外，如果 2 个 ID 列的域不重叠，则不需要上面选项 2 中的 TableName - 只要您的案例表达式可以确定哪个域`A_or_B_ID` 属于

（感谢评论修复我的格式）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-15T15:25:17.003

抱歉，您不能 FK 到 SQL Server 中的视图。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-07-27T20:34:36.503

还有另一种选择。`TableA`将和视为`TableB`名为 的新表的子类`TablePrime`。调整`TableB`的 ID 值，使其与 的 ID 值不一致`TableA`。在 PK 中制作 ID`TablePrime`并将所有`TableA`' 和`TableB`' 的（调整后的）ID 插入`TablePrime`. 在他们的 PK 上`TableA`与.`TableB``TablePrime`

您现在拥有超类型/子类型模式，并且可以对`TablePrime`（当您需要*-A-or-B*时）或单个表之一（当您*只需要 A*或*B*时）进行约束。

如果您需要更多详细信息，请询问。有一些变化可以让你确保 A 和 B 是互斥的，或者你正在使用的东西可以同时是两者。如果可能，最好在 FK 中将其正式化。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-29T17:56:50.237

添加引用用户定义函数的约束更容易，该函数为您进行检查， fCheckIfValueExists(columnValue) 如果值存在则返回 true，否则返回 false。

好处是它可以接收多个列，使用它们执行计算，接受空值并接受与主键不精确对应的值或与连接结果进行比较。

缺点是优化器不能使用他所有的外键技巧。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-08-13T02:15:18.983

抱歉，严格来说，不，您不能在视图上设置外键。原因如下：

InnoDB 是 MySQL 唯一具有外键的内置存储引擎。任何 InnoDB 表都将在 information_schema.tables 中注册，其中 engine = 'InnoDB'。

视图虽然注册在 information_schema.tables 中，但有一个 NULL 存储引擎。MySQL 中没有任何机制可以在具有未定义存储引擎的任何表上具有外键。

谢谢！

# delphi - Delphi 的代码片段？

> ID：447129
> 
> 赞同：3
> 
> 时间：2009-01-15T15:18:13.193
> 
> 标签：delphi, organization, code-snippets

是否有适用于 Delphi 或通用 IDE 集成的良好代码片段应用程序？我想存储代码、查询、注释等。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T15:39:36.163

[GExperts](http://www.gexperts.org)具有用于代码片段的代码库功能以及许多其他不错的功能，并与 IDE 集成。即使您不决定使用 Code Librarian 功能，也值得一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T17:38:52.600

Delphi 2006 及更高版本具有[Live Templates](http://delphi.wikia.com/wiki/Live_Templates_Technical_Info)。它们有点棘手，因为您必须编辑 XML 文件才能真正使它们工作，但是当它们这样做时它们是强大的。请参阅[Nick 的实时模板 Camtasia 演示文稿](http://bdntv.borland.com/pix/nickhodges/Camtasia/28LiveTemplates/28LiveTemplates.html)。Ctrl-J 是调用它的快捷方式。

在此之前，Delphi 2005 及更早的版本有简单的代码片段。我相信 Ctrl-J 也调用了它们。

另一种选择是使用[Castalia](http://www.twodesk.com/castalia/)及其[代码模板功能](http://www.twodesk.com/castalia/code_templates.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T23:28:31.647

同上 Ozmosys。

还可以从 delphidabbler 检查 CodeSnip 数据库查看器：http: [//www.delphidabbler.com/software/codesnip](http://www.delphidabbler.com/software/codesnip)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T15:39:58.533

我使用 Ozmosys 的知识库。它已经有一段时间没有更新了，但是它可以工作，而且它是用 Delphi 编写的。[奥兹莫西斯](http://www.ozmosys.net.au/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T17:33:04.903

我也必须支持 Ozmosys 的知识库。它有一段时间没有更新的原因是它可以正常工作。当我在程序开发的早期遇到问题时，作者反应非常迅速并且很快就做到了。发布代码和其他类型的提示是合乎逻辑且容易的。我每天都在使用它，同时处理三个左右似乎永远在我盘子里的项目。

# php - PHP 登录连接故障排除

> ID：447134
> 
> 赞同：0
> 
> 时间：2009-01-15T15:19:26.687
> 
> 标签：php, function

我在使用php设置登录页面时遇到了一个我还没有遇到的问题。

该页面有一条与第 1 行相关的错误消息（`require_once('../Connections/Login.php)`

说明

> [function.require-once]：打开流失败：没有这样的文件或目录致命错误：require_once（）[function.require]：打开失败需要...（include_path ='。：/usr/share/pear-php5 ')

我知道这可能真的很简单和愚蠢，但我真的很难自我排除故障，真的很重视一些帮助吗？

* * *

这是我一直很困惑的地方。我也这么想，就是找不到文件；但是结构就像你说的那样：

htdocs/comparison.php（登录页面）htdocs/Connections/connComparisonLogin.php

抱歉，这会让您感到困惑，我简化了原始问题中的实际脚本，这是实际的错误消息：

> 警告：require_once(../Connections/connComparisonLogin.php) [function.require-once]：无法打开流：/home/fhlinux135/s/suzukigenuine.com/user/htdocs/comparison.php 中没有这样的文件或目录在线 1
> 
> 致命错误：require_once() [function.require]：在 /home/fhlinux135/s/suzukigenuine 中打开所需的 '../Connections/connComparisonLogin.php' (include_path='.:/usr/share/pear-php5') 失败.com/user/htdocs/comparison.php 在第 1 行

我做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T16:12:29.497

我认为您的要求声明应该是：

```
require_once 'Connections/connComparisonLogin.php'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T15:28:15.110

相对于当前的 php 文件，您的“Connections/Login.php”在哪里。

php 将查找相对于当前文件的文件，或者在“include_path”php.ini 设置中指定的目录之一中查找文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T15:29:30.833

该错误只是意味着 php 找不到 Login.php 文件。假设你正在调用的页面是 index.php 你应该有一个像这样的director结构

```
-Dir1 
|-index.php
-Connections 
|-Login.php 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T16:31:12.923

为什么要在 require 语句中查找目录？从 require_once 路径的开头删除“../”。

# .net - 框架 + 客户端代码参考

> ID：447144
> 
> 赞同：0
> 
> 时间：2009-01-15T15:22:33.950
> 
> 标签：.net, dependencies, reference, teamcity

我们正在同时开发一个基础框架和一个基于它的实现（小测试工具）。我想要几件事，我想知道它们是否都是可能的：

（.NET 3.5，VS2008）

*   有一个只有实现（工具）的 .sln - 项目
*   拥有一个带有工具 + 框架项目的 .sln
*   拥有一个仅包含框架项目的 .sln

拥有一个具有 2 个构建配置的构建服务器（Team City）： - 框架 - 工具

现在，虽然这可能在工具和框架之间仅引用 .dll 时都可以工作，但我想从工具+框架解决方案中处理框架，而不是经常面对 [元数据] 代码文件。

有小费吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-26T17:17:39.387

是否可以在一个大解决方案中加入所有项目？您可能有多个 .sln 文件引用相同的 .csproj（或其他）文件。

# git - 本地 git 签入——从主存储库中隐藏？

> ID：447164
> 
> 赞同：3
> 
> 时间：2009-01-15T15:28:02.987
> 
> 标签：git

我想我记得在某个地方读过一种方法来做到这一点，但我找不到它。

我在本地工作，甚至在本地分支机构工作，我会根据需要或每天或其他方式进行检查。当我将代码推送到主存储库时，有没有办法按原样推送文件，而不是推送所有历史记录？或者当我从分支合并回主时，我不能合并历史吗？

这些甚至是好主意吗？感谢您的帮助 - 仍在学习，在这里！

乔

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-15T15:33:15.693

您可以将更改合并为主分支上的单个提交：

```
$ git checkout main
$ git merge --squash local 
```

当然，这会丢弃您所有的本地历史。总而言之，这不是我会做的事情。相反，如果您担心本地历史中的提交令人尴尬或妥协，请使用`git rebase`重写您的本地历史；之后，执行正常的合并并推出你清理过的本地历史。

编辑/澄清：*交互式*变基将允许您轻松删除或“压缩”历史记录中的提交：

```
$ git checkout local
$ git rebase -i main 
```

# c# - 在 c# 中的 winform 上显示多个图像的最佳方法

> ID：447170
> 
> 赞同：0
> 
> 时间：2009-01-15T15:30:01.097
> 
> 标签：c#, winforms, user-interface, image

在 c# 中的 winform 上显示多个图像的最佳方法？数据网格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:34:13.257

几个`PictureBox`es :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T19:17:58.623

这取决于您要显示多少张图像，您想要缩略图还是全分辨率图像？

我将假设由于您要求“图像”，因此您有很多图像要显示。因此，您可能希望在该表单上使用缩略图，如果您想显示全分辨率图像，请使用不同的表单。

在这种情况下，您需要结合 ListView 对象查看 ImageList 对象。

我最近在一个应用程序中使用了这个解决方案。结果非常好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T15:33:29.187

留下一个包含所有图像的树形视图并将图像大型化？很难猜出你想要什么...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T15:42:21.290

我的公司 Atalasoft 有几个可用于显示图像和缩略图的[win 表单控件。](http://www.atalasoft.com/products/dotimage/photopro/default.aspx)[这里](http://www.codeproject.com/KB/showcase/TIFF_editing.aspx)有一个使用缩略图控件的典型示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-16T03:17:53.737

您可以尝试使用 ImageList 并将其绑定到 ListView。您可以将 ListView 设置为 Tile View 状态或任何其他状态。

# ssl - 找出 SSL 版本（V2 或 V3）

> ID：447171
> 
> 赞同：1
> 
> 时间：2009-01-15T15:30:14.030
> 
> 标签：ssl

如何判断客户端和服务器之间的 SSL 通信是 SSLv2 还是 SSLv3？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T15:38:31.750

在[SSL 协议层面](http://en.wikipedia.org/wiki/Transport_Layer_Security#TLS_record_protocol)，头部的第二个字节包含协议的主要版本，对于 SSLv3/TLS 是 3，对于 SSLv2 大概是 2。请注意，客户端在其 ClientHello 消息中发送它支持的最高版本，而服务器则以它在 ServerHello 消息中选择的版本（可能更低）进行响应。

当然，您应该使用允许您查询版本而无需深入到协议级别的 API。

# entity-framework - 您能否使用 .NET 3.5 SP1 进行开发并仅在 .NET 3.5 下运行

> ID：447186
> 
> 赞同：1
> 
> 时间：2009-01-15T15:33:34.193
> 
> 标签：entity-framework, version, .net-3.5, entities

我是否可以开发一个使用 .NET Framework 3.5 SP1 中的 ADO .NET 实体的网站，然后将其部署在仅具有 .NET 3.5 框架的另一台机器上？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T15:49:44.473

No. Your code will be referencing the Entity Framework code, and calling into it. That will fail when you try to run it on a machine which doesn't have the Entity Framework.

I also wouldn't suggest just including "extra" DLLs - getting in a state where you're using some code from 3.5 and some from 3.5SP1 sounds like a recipe for disaster to me.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T15:45:37.210

Perhaps if you include the dll's that SP1 puts in the GAC (like system.web.dynamicdata for example) during setup. Normally these wouldn't be copied into your bin cause they are in the GAC.

Best thing would be to upgrade the machine to SP1, but I guess that is not an option..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:05:19.857

Yes you can do this. Right click on your references and go to properties. Set "Copy Local" to "True". You will essentially be deploying .NET SP1 assemblies in your local bin instead of using what is stored in the GAC.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T15:40:24.180

您的项目的属性，然后是目标框架？

# model-view-controller - 吃豆人游戏类设计

> ID：447187
> 
> 赞同：0
> 
> 时间：2009-01-15T15:33:46.643
> 
> 标签：model-view-controller, class-design

我必须用 Java 编写一个多人吃豆人游戏来完成大学作业，到目前为止，我正在为我的设计提供一些反馈。

所以我正在尝试采用 MVC 风格，[这就是我所勾勒出来的](http://s3.amazonaws.com/twitpic/photos/large/1822927.jpg?AWSAccessKeyId=0ZRYP5X5F6FSMBCCSE82&Expires=1232036013&Signature=%2FA3laziDAr6j4OsEZLXC%2FiEZV%2BE%3D)。

我从来没有使用 MVC 设计过任何东西，所以我的知识实际上只是来自务实的程序员和简短的讲座，所以我很可能会误解或误解它。

此外，我看到的大多数设计简单游戏的教程根本没有提到 MVC，所以这是不是 MVC 不是一个好用的模式的情况？

到目前为止，我的想法是*Game State*类将成为数据存储的主要来源，并将使用 2d 数组来存储游戏状态、幽灵在哪里、吃豆人在哪里等。

*Game*类将是主控制器类，它将包含主游戏循环并控制数据（*游戏状态*）和视图之间的所有交互（可能是*GUI*表示 - 我只是添加了基于文本的示例）。

在我让游戏正常运行后，我将不得不将其拆分为客户端/服务器。在我看来，通过使用这个模型，将大部分数据和处理保留在服务器上并让客户端与控制器交互并绘制自己的视图不会太难。我（还）不知道这会如何影响网络上的游戏性能，所以一旦单人版本完成，我将不得不进一步研究。

任何基于我迄今为止的设计的提示或建议，将不胜感激 - 还要记住它最终必须是一个多人游戏。

干杯，

亚当

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T16:06:01.773

相反：MVC 对于这类问题实际上是一个非常好的东西，而 Swing 框架在支持它方面做得非常好。

您可能应该首先阅读[MVC](http://en.wikipedia.org/wiki/Model-view-controller)。作为概述，您将尝试将游戏的内部表示方式（模型）、游戏的绘制方式（视图）以及状态如何改变（控制器）区分开来。

首先考虑建模当前游戏状态所需的一切。拥有一个定义一些基本行为的实体并像你一样为 PacMan 和 Ghost 子类化它可能是一个很好的开始方式，但你可能希望将你的 Map 称为 GameBoard 或类似的东西（赋予与库相同的名称classes 通常是一个坏主意：您不想将它与 java.util.Map 混淆）。要结束模型部分，您可能希望将它们全部包含在一个“了解”游戏整个状态的类中。由于这是您的 GameState 类，您可能想要重新绘制箭头。

由于确定视图可能相当容易，因此您可以去那里。您可以为您的 GameState 提供一个 draw(Graphics) 方法，并从您的任何视图中调用它（稍后您将决定）。这可能反过来委托你的每个实体，谁又可能将它委托给他们拥有的 Sprite 或 Image 对象。现在，您的视图（可能是 JPanel 等）可以使用其自己的 Graphics 对象从其 paintComponent() 方法中调用 draw()。

现在你仍然需要一个控制器来真正让事情发生。这很可能是一些对象，其中一个 KeyListener 连接到视图中，还有一个 InputStream 和一个 OutputStream 来处理与其他玩家的通信（它可能还需要担心同步游戏状态）。它还需要有一个计时器，以便它可以告诉单元定期更新。您确实需要决定谁来决定这些动作是否合法：控制器可以这样做，GameState 可以，或者它可以只为实体提供他们需要的信息并让他们自己做。

一旦你拥有了所有这些部分，你就可以将它们包装在一个了解所有内容并完成所有设置等的最终课程中。还有很多我要掩饰的内容以及您必须做出的更多决定，但它应该让您继续前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T16:09:55.743

我完全同意 James 的观点，并且想补充一点，您可能还想确保您的游戏状态的这个 2d 数组可以处理一些边缘情况，例如多个幽灵占据一个瓷砖，一个 pacman 和一个幽灵在同一个瓷砖（取决于您在代码中如何处理它），吃豆人的食物点等。

好的计划往往是最好的程序，我很高兴看到你从图表开始。

# erlang - Erlang 和运行时记录限制

> ID：447188
> 
> 赞同：9
> 
> 时间：2009-01-15T15:33:48.733
> 
> 标签：erlang, runtime

我正在开发一个 Erlang 系统，并且由于记录是编译时预处理器宏（几乎），并且它们不能在运行时被操纵......基本上，我正在使用属性模式，其中属性在运行时添加到前端 (AS3) 上的对象。理想情况下，我会在 Erlang 端使用一个列表来反映这一点，因为它是一种基本数据类型，但随后无法使用 QCL [查询 ETS 表] 中的记录，因为要使用它们我必须明确说明我使用哪个记录属性想要查询...我在 larges 表中至少有 15 列，因此将它们全部列在一个巨大的 switch 语句（case X of）中简直丑陋。

有谁知道如何优雅地解决这个问题？也许一些内置函数用于创建具有适当签名的元组以用于模式匹配（用于 QLC）？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T19:35:22.927

听起来您希望能够执行诸如在运行时由用户界面代码确定的位置`get_record_field(Field, SomeRecord)`之类的事情。`Field`

您是对的，因为您不能在标准 erlang 中执行此操作，因为记录和`record_info`函数在编译时被扩展和消除。

我使用或查看过几种解决方案。我的解决方案如下：（该示例提供运行时访问`#dns_rec`和`#dns_rr`记录的权限`inet_dns.hrl`）

```
%% Retrieves the value stored in the record Rec in field Field.
info(Field, Rec) ->
    Fields = fields(Rec),
    info(Field, Fields, tl(tuple_to_list(Rec))).

info(_Field, _Fields, []) -> erlang:error(bad_record);
info(_Field, [], _Rec) -> erlang:error(bad_field);
info(Field, [Field | _], [Val | _]) -> Val;
info(Field, [_Other | Fields], [_Val | Values]) -> info(Field, Fields, Values).

%% The fields function provides the list of field positions
%% for all the kinds of record you want to be able to query
%% at runtime. You'll need to modify this to use your own records.
fields(#dns_rec{}) -> fields(dns_rec);
fields(dns_rec) -> record_info(fields, dns_rec);
fields(#dns_rr{}) -> fields(dns_rr);
fields(dns_rr) -> record_info(fields, dns_rr).

%% Turns a record into a proplist suitable for use with the proplists module.
to_proplist(R) ->
    Keys = fields(R),
    Values = tl(tuple_to_list(R)),
    lists:zip(Keys,Values). 
```

此处提供了一个可编译的版本：[rec_test.erl](http://gist.github.com/71050)

* * *

您还可以将此动态字段查找扩展为匹配规范的动态生成，以便与`ets:select/2`或`mnesia:select/2`如下所示一起使用：

```
%% Generates a matchspec that does something like this
%% QLC psuedocode: [ V || #RecordKind{MatchField=V} <- mnesia:table(RecordKind) ]
match(MatchField, RecordKind) ->
    MatchTuple = match_tuple(MatchField, RecordKind),
    {MatchTuple, [], ['$1']}.

%% Generates a matchspec that does something like this
%% QLC psuedocode: [ T || T <- mnesia:table(RecordKind),
%%                        T#RecordKind.Field =:= MatchValue]
match(MatchField, MatchValue, RecordKind) ->
    MatchTuple = match_tuple(MatchField, RecordKind),
    {MatchTuple, [{'=:=', '$1', MatchValue}], ['$$']}.

%% Generates a matchspec that does something like this
%% QLC psuedocode: [ T#RecordKind.ReturnField
%%                   || T <- mnesia:table(RecordKind),
%%                        T#RecordKind.MatchField =:= MatchValue]
match(MatchField, MatchValue, RecordKind, ReturnField) 
  when MatchField =/= ReturnField ->
    MatchTuple = list_to_tuple([RecordKind
           | [if F =:= MatchField -> '$1'; F =:= ReturnField -> '$2'; true -> '_' end
              || F <- fields(RecordKind)]]),
    {MatchTuple, [{'=:=', '$1', MatchValue}], ['$2']}.

match_tuple(MatchField, RecordKind) ->
    list_to_tuple([RecordKind
           | [if F =:= MatchField -> '$1'; true -> '_' end
              || F <- fields(RecordKind)]]). 
```

* * *

Ulf Wiger 还编写了一个 parse_transform，[Exprecs](http://forum.trapexit.org/viewtopic.php?p=21790)，它或多或少会自动为您执行此操作。我从未尝试过，但 Ulf 的代码通常非常好。

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T00:42:02.317

我通过使用解析转换工具读取 .hrl 文件并生成辅助函数来解决这个问题（在开发中）。

我在[Trap Exit](http://trapexit.org/)写了一篇关于它的[教程](http://trapexit.org/Match_Specifications_And_Records_(Dynamically!))。

我们一直使用它来生成匹配规范。美妙之处在于，您无需了解*开发时*记录的当前状态。

但是，一旦您投入生产，情况就会发生变化！如果您的记录是表的基础（与表中字段的定义相反），那么更改基础记录会更加困难（委婉地说！）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T22:05:29.380

我不确定我是否完全理解您的问题，但在大多数情况下，我已经从记录转移到了[道具列表。](http://erlang.org/documentation/doc-5.2/lib/stdlib-1.11.0/doc/html/proplists.html)它们更灵活，也更慢。使用 (d)ets 我通常使用一些记录字段进行粗略选择，然后检查剩余记录上的 proplists 以进行详细选择。

# c# - C# 中的 String.Split 变体

> ID：447189
> 
> 赞同：0
> 
> 时间：2009-01-15T15:33:55.830
> 
> 标签：c#, string

我想在字符串上使用 Split 函数，但将分隔序列保留为字符串数组每个元素中的第一个字符。我正在使用此函数在 URL 的每个实例上拆分 HTML，以便我可以在网站上的 URL 上运行正则表达式模式。split 函数是否有任何重载来执行此操作？还是我必须编写自己的函数？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T15:39:44.120

没有内置的方法可以做到这一点。但是，如果您要拆分单个模式，则可以使用以下代码进行编码

```
public IEnumerable<string> SplitAndKeepPrefix(this string source, string delimeter) {
  return SplitAndKeepPrefix(source, delimeter, StringSplitOptions.None);
}

public IEnumerable<string> SplitAndKeepPrefix(this string source, string delimeter, StringSplitOptions options ) {
  var split = source.Split(delimeter, options);
  return split.Take(1).Concat(split.Skip(1).Select(x => delimeter + x));
}

string result = htmlStr.SplitAndKeepPrefix("<a"); 
```

**编辑**

更新为不为每个字符串添加前缀:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T15:39:59.610

```
 public static string[] SplitAndKeepDelimiters(this string Original, string[] Delimeters, StringSplitOptions Options)
    {
        var strings = EnumSplitAndKeepDelimiters(Original, Delimeters);

        if (Options == StringSplitOptions.RemoveEmptyEntries)
        {
            return strings.Where((s) => s.Length != 0).ToArray();
        }
        else
        {
            return strings.ToArray();
        }
    }

    static IEnumerable<string> EnumSplitAndKeepDelimiters(this string Original, string[] Delimeters)
    {
        int currIndex = 0;

        while (currIndex < Original.Length)
        {
            var delimiterIndex = Delimeters.Select((d) => new { Source = d, Index = Original.IndexOf(d, currIndex) })
                .Where((d) => (d.Index != -1) && (d.Source != string.Empty) )
                .OrderBy((d) => d.Index)
                .FirstOrDefault();
        int nextIndex = (delimiterIndex != null ) ? delimiterIndex.Index + delimiterIndex.Source.Length : Original.Length;
            yield return Original.Substring(currIndex, nextIndex - currIndex);
            currIndex = nextIndex;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T15:41:11.527

据我所知，使用默认的 Split 方法是不可能的。您可以编写一个扩展方法来解决您的问题。或者简单地遍历字符串 [] 并将分隔符放在每个字符串的前面。

我会选择扩展方法:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T15:41:24.520

答案是否定的，您必须推出自己的版本。

可以在[MSDN上找到有关 String.Split API 的信息](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)

# .net - 解决类而不使用 Castle Windsor 注册它们

> ID：447193
> 
> 赞同：17
> 
> 时间：2009-01-15T15:34:35.690
> 
> 标签：.net, castle-windsor, unity-container, prism

采取以下无用程序：

```
class Program
{
    static void Main(string[] args)
    {
        IUnityContainer unityContainer = new UnityContainer();
        IWindsorContainer windsorContainer = new WindsorContainer();

        Program unityProgram = unityContainer.Resolve<Program>();
        Program castleProgram = windsorContainer.Resolve<Program>();
    }
} 
```

UnityContainer 将返回一个 Program 实例，而 Windsor 容器将抛出 ComponentNotFoundException。

我可以看到这两种行为的论据并且不介意我最终得到的结果，但是 Prism V2 Drop 8（撰写本文时的最新版本）在内部依赖于 Unity 行为，请求尚未注册的类。

与其为 Prism 找到并注册所有这些类，不如让 Windsor 表现得像 Unity。我在谷歌上没有找到任何可以帮助我做到这一点的东西（尽管我的术语可能是错误的）而且温莎文档非常糟糕......

任何人都可以提出解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-31T22:10:40.613

Windsor 目前不支持这一点，这是设计使然。原因是您应该显式注册所需的类型，以免得到错误配置的对象。

然而，在不久的将来，有可能会添加一个钩子来创建非注册类型，因为这是 WCF 集成工具所需要的。（编辑 - 它是在 v2.1 中添加的 - 看看`ILazyComponentLoader`s）

**无论如何**，不​​管惰性组件加载器如何，您能做的最好的事情就是使用 fluent API 来批量注册符合您所需条件的程序集中的所有类型。代码不多，你晚上会睡得更好。

*仅当您在启动时（在您的组合根目录*中）确实没有足够的信息来确定您需要哪些组件时才使用惰性加载器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T15:49:39.617

Windsor 不支持开箱即用，但您可以创建扩展方法来执行此操作：

```
static class WindsorExtensions
{
    public static object ResolveType(this IWindsorContainer container, Type type)
    {
        if ( type.IsClass && !container.Kernel.HasComponent(type) )
            container.Kernel.AddComponent(type.FullName, type, LifestyleType.Transient);
        return container.Resolve(type);
     }

     public static T ResolveType<T>(this IWindsorContainer container)
     { return (T)ResolveType(container, typeof(T)); }
}

class Program
{
    static void Main(string[] args)
    {
        IUnityContainer unityContainer = new UnityContainer();
        IWindsorContainer windsorContainer = new WindsorContainer();

        Program unityProgram = unityContainer.Resolve<Program>();
        Program castleProgram = windsorContainer.ResolveType<Program>();
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-11T15:52:25.283

Krzysztof 不要害怕在这里链接到您自己的博客 :) [http://devlicious.com/blogs/krzysztof_kozmic/archive/2009/11/16/castle-windsor-lazy-loading.aspx](http://devlicious.com/blogs/krzysztof_kozmic/archive/2009/11/16/castle-windsor-lazy-loading.aspx)

另外，我发现这个简单的实现在我的 WPF 应用程序中很有用，删除字符串约束，你接近一般情况

```
public class ViewModelLoader : Castle.MicroKernel.Resolvers.ILazyComponentLoader {
    public IRegistration Load(string key, Type service)
    {
        if (service == null)
            return null;
        if (service.Name.EndsWith("ViewModel", StringComparison.CurrentCultureIgnoreCase))
            return Component.For(service).Named(key);
        else
            return null;
    }
} 
```

# api - 财经新闻API

> ID：447196
> 
> 赞同：6
> 
> 时间：2009-01-15T15:35:13.597
> 
> 标签：api

任何免费/付费**API 来获取**全球/特定国家/地区的财经新闻。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T01:43:58.963

将其作为 RSS 提要从**Yahoo中删除：**

```
http://finance.yahoo.com/rss/topstories 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T15:39:28.427

[](http://mashable.com/2008/05/12/reuters-ap/)**用于非商业用途的[**路透社**](http://mashable.com/2008/05/12/reuters-ap/)[新闻 API 。](http://mashable.com/2008/05/12/reuters-ap/)**

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T16:53:21.707

[**NewsCloud** Web Services](http://www.newscloud.com/learn/apidocs/)有一个开放的 API——商业用途是有问题的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-09T10:11:58.120

[MyAllies Companies 突发新闻](http://www.myallies.com)与 JSON 输出

例子：

[http://www.myallies.com/api](http://www.myallies.com/api)所有公司的最新消息。

或者

[http://www.myallies.com/api/amzn](http://www.myallies.com/api/amzn)获取亚马逊新闻。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-21T08:38:33.237

我可以推荐最近推出 API 的财经新闻聚合器 CityFALCON。他们从互联网上收集新闻并根据专有算法对其进行评分。因此，有可能不是按时间顺序而是按相关性对新闻进行排序。有关更多信息，您可以访问此页面[http://www.cityfalcon.com/blog/investments/financial-news-api-widget/](http://www.cityfalcon.com/blog/investments/financial-news-api-widget/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-11T06:40:10.803

您也可以尝试 www.xignite.com。它们支持 SOAP 并构建您可以从中获取新闻的 REST API。

# jquery - 如何在 jQuery 中定义多个 CSS 属性？

> ID：447197
> 
> 赞同：544
> 
> 时间：2009-01-15T15:35:29.713
> 
> 标签：jquery, css

jQuery中是否有任何语法方式来定义多个CSS属性，而无需像这样将所有内容都串起来：

```
$("#message").css("width", "550px").css("height", "300px").css("font-size", "8pt"); 
```

如果你有 20 个这样的代码，你的代码将变得难以阅读，有什么解决方案吗？

例如，从 jQuery API 中，jQuery 可以理解并返回正确的值

```
.css({ "background-color": "#ffe", "border-left": "5px solid #ccc" }) 
```

和

```
.css({backgroundColor: "#ffe", borderLeft: "5px solid #ccc" }). 
```

请注意，对于 DOM 表示法，属性名称周围的引号是*可选*的，但对于 CSS 表示法，它们是*必需*的，因为名称中的连字符。

* * *

## 回答 #1

> 赞同：1003
> 
> 时间：2009-01-15T15:37:24.467

最好只使用[`.addClass()`](https://api.jquery.com/addClass/)，[`.removeClass()`](https://api.jquery.com/removeclass/)即使您有 1 种或多种样式要更改。它更具可维护性和可读性。

如果你真的有做多个 CSS 属性的冲动，那么使用以下方法：

```
.css({
   'font-size' : '10px',
   'width' : '30px',
   'height' : '10px'
}); 
```

**注意！**
任何带有*连字符*的 CSS 属性都需要被引用。
我已经加了引号，所以没有人需要澄清这一点，并且代码将 100% 正常运行。

* * *

## 回答 #2

> 赞同：170
> 
> 时间：2009-01-15T15:39:16.727

将其作为对象传递：

```
$(....).css({
    'property': 'value', 
    'property': 'value'
}); 
```

[http://docs.jquery.com/CSS/css#properties](http://docs.jquery.com/CSS/css#properties)

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2009-01-15T15:37:32.843

```
$('#message').css({ width: 550, height: 300, 'font-size': '8pt' }); 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2009-01-15T15:39:25.477

使用普通对象，您可以将表示属性名称的字符串与其对应的值配对。例如，更改背景颜色并使文本更粗体如下所示：

```
$("#message").css({
    "background-color": "#0F0", 
    "font-weight"     : "bolder"
}); 
```

或者，您也可以使用 JavaScript 属性名称：

```
$("#message").css({
    backgroundColor: "rgb(128, 115, 94)",
    fontWeight     : "700"
}); 
```

更多信息可以在[jQuery 的文档](http://api.jquery.com/css/#css-properties)中找到。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2012-12-05T10:36:17.720

请试试这个，

```
$(document).ready(function(){
    $('#message').css({"color":"red","font-family":"verdana"});
}) 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2014-01-07T10:29:15.207

您还可以`attr`与 一起使用`style`：

```
$('#message').attr("style", "width:550; height:300; font-size:8px" ); 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-01-15T19:02:17.050

同意 redsquare 但是值得一提的是，如果你有一个像你这样的两个词的属性，`text-align`你会这样做：

```
$("#message").css({ width: '30px', height: '10px', 'text-align': 'center'}); 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2015-04-22T21:54:51.107

```
$("#message").css({"width" : "550px", "height" : "300px", "font-size" : "8pt"}); 
```

此外，最好使用内置的 jQuery`addClass`来使您的项目更具可扩展性。

来源：[如何：jQuery 添加 CSS 和删除 CSS](http://www.syntaxxx.com/how-to-jquery-add-css-and-remove-css/ "如何：jQuery 添加 CSS 和删除 CSS")

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2015-03-04T13:09:01.120

试试这个

```
$(element).css({
    "propertyName1":"propertyValue1",
    "propertyName2":"propertyValue2"
}) 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2017-12-01T00:16:15.870

最好的方法是使用变量。

```
var style1 = {
   'font-size' : '10px',
   'width' : '30px',
   'height' : '10px'
};
$("#message").css(style1); 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2017-12-10T18:43:19.753

**脚本**

```
 $(IDname).css({
    "background":"#000",
    "color":"#000"
}) 
```

**html**

```
<div id="hello"></div> 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2010-08-25T17:41:04.940

你可以试试这个

```
$("p:first").css("background-color", "#B2E0FF").css("border", "3px solid red"); 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2019-04-17T12:01:11.013

如果要更改多个 css 属性，则必须使用如下**对象**结构：

```
$(document).ready(function(){
   $('#message').css({
                   "background-color": "#0F0",
                   "color":"red",
                   "font-family":"verdana"
                });
}); 
```

但是当我们想要**改变很多样式时它会****变得更糟**，所以我建议你添加一个类而不是使用 jQuery 更改 css，并且添加一个类也更具可读性。

 **见下面的例子：

**CSS**

```
<style>
    .custom-class{
       font-weight: bold;
       background: #f5f5f5;
       text-align: center;
       font-size: 18px;
       color:red;
    }
</style> 
```

**jQuery**

```
$(document).ready(function(){
   $('#message').addclass('custom-class');
}); 
```

后一个示例相对于前一个示例的一个优点是，如果您想添加一些 css`onclick`并希望在第二次单击时删除该 css，那么在后一个示例中您可以使用`.toggleClass('custom-class')`

在前面的示例中，您必须使用之前设置的不同值设置所有 css，这会很复杂，因此使用 class 选项将是更好的解决方案。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-03-31T12:54:27.040

您可以使用

```
$('selector').css({'width:'16px', 'color': 'green', 'margin': '0'}); 
```

最好的方法是使用 $('selector').addClass('custom-class') 和

```
.custom-class{
width:16px,
color: green;
margin: 0;
} 
```

# c# - 读取配置部分的通用方法

> ID：447199
> 
> 赞同：10
> 
> 时间：2009-01-15T15:36:05.577
> 
> 标签：c#, .net, version-control

我正在尝试实现一种从配置文件**中读取部分的通用方法。**配置文件可能包含“标准”部分或“自定义”部分，如下所示。

```
<configuration> 
<configSections>
    <section name="NoteSettings" type="System.Configuration.NameValueSectionHandler"/>
</configSections>   
<appSettings>
    <add key="AutoStart" value="true"/>
    <add key="Font" value="Verdana"/>
</appSettings>  
<NoteSettings>
    <add key="Height" value="100"/>
    <add key="Width" value="200"/>
</NoteSettings> 
```

我尝试的方法如下：

```
 private string ReadAllSections()
    {
        StringBuilder configSettings = new StringBuilder();

        Configuration configFile = ConfigurationManager.OpenExeConfiguration(Application.ExecutablePath);

        foreach (ConfigurationSection section in configFile.Sections)
        {
            configSettings.Append(section.SectionInformation.Name);
            configSettings.Append(Environment.NewLine);                

            if (section.GetType() == typeof(DefaultSection))
            {
                NameValueCollection sectionSettings = ConfigurationManager.GetSection(section.SectionInformation.Name) as NameValueCollection;

                if (sectionSettings != null)
                {
                    foreach (string key in sectionSettings)
                    {
                        configSettings.Append(key);
                        configSettings.Append(" : ");
                        configSettings.Append(sectionSettings[key]);
                        configSettings.Append(Environment.NewLine);
                    }
                }
            }

            configSettings.Append(Environment.NewLine);
        }

        return configSettings.ToString();
    } 
```

*假设所有自定义部分都只有 KEY-VALUE*

*   这样的实现可能吗？如果是的话，有没有比这个更“干净”、更优雅的解决方案？
*   上述方法还读取*mscorlib、system.diagnostics*等“不可见”部分。这是可以避免的吗？
*   *System.Data.Dataset*返回一个无法转换为 NameValueCollection 的数据集。如何处理？

欢迎更正/建议。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-15T16:24:20.910

由于配置文件是 XML 文件，因此您可以为此任务使用 XPath 查询：

```
 Configuration configFile = ConfigurationManager.OpenExeConfiguration(Assembly.GetExecutingAssembly().Location);
    XmlDocument document = new XmlDocument();
    document.Load(configFile.FilePath);
    foreach (XmlNode node in document.SelectNodes("//add"))
    {
        string key = node.SelectSingleNode("@key").Value;
        string value = node.SelectSingleNode("@value").Value;
        Console.WriteLine("{0} = {1}", key, value);
    } 
```

如果您需要获取所有 {key, value} 对，那么您需要定义 XPath 查询的三元组： 1 - 用于选择具有相似结构的节点的主查询。2, 3 - 用于从第一个查询检索到的节点中提取键和值节点的查询。在您的情况下，对所有节点进行通用查询就足够了，但是很容易维护对不同自定义部分的支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T16:20:15.503

将您的配置读入 XmlDocument，然后使用 XPath 查找您要查找的元素？

就像是;

```
XmlDocument doc = new XmlDocument();
doc.Load(HttpContext.Current.Server.MapPath("~/web.config"));

XmlNodeList list = doc.SelectNodes("//configuration/appSettings");

foreach (XmlNode node in list[0].ChildNodes) 
```

...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-15T09:44:30.143

您可以按如下方式阅读自定义部分：

```
var sectionInformation = configuration.GetSection("mysection").SectionInformation;
var xml = sectionInformation.GetRawXml();
var doc = new XmlDocument();
doc.LoadXml(xml);
IConfigurationSectionHandler handler = (IConfigurationSectionHandler)Type.GetType(sectionInformation.Type).GetConstructor(new Type[0]).Invoke(new object[0]);
var result = handler.Create(null, null, doc.DocumentElement); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-03T19:27:29.810

当您将 指定`NameValueSectionHandler`为节的类型属性并调用 时`Configuration.GetSection(string)`，您将收到一个`DefaultSection`实例作为返回类型。

`string SectionInformation.SectionInformation.GetRawXml()`在这种情况下，是获取数据的关键。

我用一种有效的方法回答了另一个类似的问题`System.Configuration`，您可以参考它来获取所有详细信息和代码片段。 [NameValueSectionHandler 我可以使用这个部分类型来写回应用程序吗](https://stackoverflow.com/questions/1149443/namevaluesectionhandler-can-i-use-this-section-type-for-writing-back-to-the-app/2194763#2194763)

# sql - sql server bcp xml 数据

> ID：447200
> 
> 赞同：1
> 
> 时间：2009-01-15T15:36:07.120
> 
> 标签：sql, sql-server, xml, bcp

我有一个表，其中有一列是 xml 类型的。我必须从该表中提取数据并将数据加载到另一个环境中。我正在使用 bcp 来提取和加载目标表，但是当我将它们 bcp 到目标表中时，有一些特殊字符会导致一些问题。有什么解决方法吗

谢谢本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T17:03:29.170

定制的 CLR-SP 为我提供了最佳解决方案。现在我可以直接将 XML 类型的数据从 TSQL 写入文件，前提是 SQL 服务帐户有权访问该文件。这允许使用简单的语法：

```
exec dbo.clr_xml2file @xml, @path, @bool_overwrite 
```

SP：

```
CREATE PROCEDURE [dbo].[clr_xml2file]
    @xml [xml],
    @file [nvarchar](max),
    @overwrite [bit]
WITH EXECUTE AS CALLER
AS
EXTERNAL NAME [CLR_FileIO].[FreddyB.FileIO].[Xml2File] 
```

CLR DLL 的 C#：

```
using System;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using System.IO;
using System.Security.Principal;
using System.Text;
using System.Xml;
using System.Xml.XPath;
using Microsoft.SqlServer.Server;

namespace FreddyB
{  
  public class FileIO
  {
    public static void Xml2File(
      SqlXml xml, 
      SqlString sFile, 
      SqlBoolean bOverwrite
    ) {

      SqlPipe sqlpipe = SqlContext.Pipe;
      try
      {
        if (xml == null || xml.IsNull || xml.Value.Length == 0) {
          sqlpipe.Send("Cannot write empty content to file : \n\t"
            +sFile.Value);
          return;
        }

        if (File.Exists(sFile.Value) & bOverwrite.IsFalse) {
          sqlpipe.Send("File already exists : \n\t"+sFile.Value);
          return;
        }

        int iFileSize = 0;
        FileStream fs = null;
        try {
          byte[] ba = Encoding.UTF8.GetBytes(xml.Value);
          iFileSize = ba.Length;

          fs = new FileStream(sFile.Value, FileMode.Create, FileAccess.Write);
          fs.Write(ba, 0, ba.Length);

          sqlpipe.Send("Wrote "
            +String.Format("{0:0,0.0}",iFileSize/1024)
            +" KB to : \n\t"
            +sFile.Value);
        }
        catch (Exception ex) 
        {
          sqlpipe.Send("Error as '"
            +WindowsIdentity.GetCurrent().Name
            +"' during file write : \n\t"
            +ex.Message);
          sqlpipe.Send("Stack trace : \n"+ex.StackTrace);
        }
        finally
        {
          if (fs != null) {
            fs.Close();
          }
        }
      }
      catch (Exception ex)
      {
        sqlpipe.Send("Error writing to file : \n\t"
          +ex.Message);
      }
    }
  }
} 
```

# sql - SQL Server 简单插入语句超时

> ID：447201
> 
> 赞同：23
> 
> 时间：2009-01-15T15:36:31.643
> 
> 标签：sql, sql-server, database, nhibernate, timeout

我有一个 6 列的简单表格。大多数情况下，任何插入语句都可以正常工作，但有时我会遇到 DB Timeout 异常：Timeout expired。在操作完成之前超时时间已过或服务器没有响应。该语句已终止。

超时设置为 10 秒。

我应该提到我正在使用 NHibernate，并且该语句还在插入本身之后包含一个“select SCOPE_IDENTITY()”。

我的想法是该表被锁定或其他什么，但当时该表上没有其他语句运行。

所有的插入都非常简单，在 sql profiler 中一切看起来都很正常，表没有索引，只有 PK（页面填充度：98.57 %）。

关于我应该寻找什么的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-16T05:50:30.487

我认为你最有可能的罪魁祸首是来自另一个事务的阻塞锁（或者可能来自触发器或幕后的其他东西）。

最简单的判断方法是启动`INSERT`，当它挂起时，`EXEC SP_WHO2`在同一服务器上的另一个窗口中运行。这将列出所有当前的数据库活动，并有一个名为的列`BLK`将显示当前是否有任何进程被阻止。检查`SPID`挂起的连接以查看`BLK`列中是否有任何内容，如果有，那就是阻止您的进程。

即使您认为没有任何其他语句正在运行，唯一确定的方法是使用类似的 SP 列出当前事务。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2011-11-11T14:11:55.077

这个问题似乎是一个代码片段的好地方，我用来查看阻塞和阻塞查询的实际 SQL 文本。

下面的代码片段采用了`SP_WHO2`返回“.”的约定。`BlockedBy`用于非阻塞查询的文本，因此它将它们过滤掉并返回剩余查询的 SQL 文本（“受害者”和“罪魁祸首”）：

```
--prepare a table so that we can filter out sp_who2 results
DECLARE @who TABLE(BlockedId INT, 
                   Status VARCHAR(MAX), 
                   LOGIN VARCHAR(MAX), 
                   HostName VARCHAR(MAX), 
                   BlockedById VARCHAR(MAX), 
                   DBName VARCHAR(MAX), 
                   Command VARCHAR(MAX), 
                   CPUTime INT, 
                   DiskIO INT, 
                   LastBatch VARCHAR(MAX), 
                   ProgramName VARCHAR(MAX), 
                   SPID_1 INT, 
                   REQUESTID INT)
INSERT INTO @who EXEC sp_who2

--select the blocked and blocking queries (if any) as SQL text
SELECT 
(
    SELECT TEXT 
    FROM sys.dm_exec_sql_text(
       (SELECT handle 
        FROM (
            SELECT CAST(sql_handle AS VARBINARY(128)) AS handle
            FROM sys.sysprocesses WHERE spid = BlockedId
        ) query)
    )
) AS 'Blocked Query (Victim)',
(
    SELECT TEXT 
    FROM sys.dm_exec_sql_text(
       (SELECT handle 
        FROM (
            SELECT CAST(sql_handle AS VARBINARY(128)) AS handle
            FROM sys.sysprocesses WHERE spid = BlockedById
        ) query)
    )
) AS 'Blocking Query (Culprit)'
FROM @who 
WHERE BlockedById != '  .' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T06:04:35.777

可能是表需要很长时间才能增长。

如果您将表设置为大量增长，并且没有启用即时文件初始化，那么查询肯定会每隔一段时间就会超时。

看看这个烂摊子：[MSDN](http://msdn.microsoft.com/en-us/library/ms175935.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-15T18:02:56.717

> *当时没有其他语句在该表上运行。*

作为事务的一部分，针对其他表运行的语句呢？这可能会在问题表上留下锁。

还要检查当时发生的日志文件或数据文件增长，如果您正在运行 SQL2005，它会显示在 SQL 错误日志中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-19T08:51:15.770

我们的 QA 有一些返回大结果集的 Excel 连接，这些查询因 WaitType 为 ASYNC_NETWORK_IO 而暂停了一段时间。在此期间，所有其他查询都超时，因此特定插入与它无关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T15:38:29.380

查看表格的碎片，您可能会因此而出现页面拆分

# c++ - C++ IsFloat 函数

> ID：447206
> 
> 赞同：25
> 
> 时间：2009-01-15T15:37:15.840
> 
> 标签：c++, string, floating-point

有人知道确定字符串值是否“符合”浮点数的便捷方法吗？

```
bool IsFloat( string MyString )
{
   ... etc ...

   return ... // true if float; false otherwise
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-15T15:55:56.113

如果你不能使用 Boost 库函数，你可以像这样编写自己的 isFloat 函数。

```
#include <string>
#include <sstream>

bool isFloat( string myString ) {
    std::istringstream iss(myString);
    float f;
    iss >> noskipws >> f; // noskipws considers leading whitespace invalid
    // Check the entire string was consumed and if either failbit or badbit is set
    return iss.eof() && !iss.fail(); 
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-15T15:53:24.777

您可能喜欢 Boost 的 lexical_cast（参见[http://www.boost.org/doc/libs/1_37_0/libs/conversion/lexical_cast.htm](http://www.boost.org/doc/libs/1_37_0/libs/conversion/lexical_cast.htm)）。

```
bool isFloat(const std::string &someString)
{
  using boost::lexical_cast;
  using boost::bad_lexical_cast; 

  try
  {
    boost::lexical_cast<float>(someString);
  }
  catch (bad_lexical_cast &)
  {
    return false;
  }

  return true;
} 
```

您可以使用 istream 来避免需要 Boost，但坦率地说，Boost 实在是太好了，不能省略。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-11-03T10:19:50.840

受此[答案](https://stackoverflow.com/a/4654718/531840)的启发，我修改了函数以检查字符串是否为浮点数。它不需要 boost 并且不依赖于 stringstreams failbit - 它只是简单的解析。

```
static bool isFloatNumber(const std::string& string){
    std::string::const_iterator it = string.begin();
    bool decimalPoint = false;
    int minSize = 0;
    if(string.size()>0 && (string[0] == '-' || string[0] == '+')){
      it++;
      minSize++;
    }
    while(it != string.end()){
      if(*it == '.'){
        if(!decimalPoint) decimalPoint = true;
        else break;
      }else if(!std::isdigit(*it) && ((*it!='f') || it+1 != string.end() || !decimalPoint)){
        break;
      }
      ++it;
    }
    return string.size()>minSize && it == string.end();
  } 
```

IE

```
1
2.
3.10000
4.2f
-5.3f
+6.2f 
```

被此函数正确识别为浮点数。

```
1.0.0
2f
2.0f1 
```

是无效浮点数的示例。如果您不想识别 X.XXf 格式的浮点数，只需删除条件：

```
&& ((*it!='f') || it+1 != string.end() || !decimalPoint) 
```

从第 9 行开始。如果您不想识别没有“。”的数字。作为浮点数（即不是'1'，只有'1.'，'1.0'，'1.0f'...），那么您可以将最后一行更改为：

```
return string.size()>minSize && it == string.end() && decimalPoint; 
```

然而：使用 boost 的 lexical_cast 或使用 stringstreams 的解决方案而不是这个“丑陋的函数”有很多很好的理由。但它让我可以更好地控制我想要识别为浮点数的格式（即小数点后的最大位数......）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-05-23T19:54:34.890

我最近写了一个函数来检查一个字符串是否是一个数字。此数字可以是整数或浮点数。

您可以扭曲我的代码并添加一些单元测试。

```
bool isNumber(string s)
{
    std::size_t char_pos(0);

    // skip the whilespaces
    char_pos = s.find_first_not_of(' ');
    if (char_pos == s.size()) return false;

    // check the significand
    if (s[char_pos] == '+' || s[char_pos] == '-') ++char_pos; // skip the sign if exist

    int n_nm, n_pt;
    for (n_nm = 0, n_pt = 0; std::isdigit(s[char_pos]) || s[char_pos] == '.'; ++char_pos) {
        s[char_pos] == '.' ? ++n_pt : ++n_nm;
    }
    if (n_pt>1 || n_nm<1) // no more than one point, at least one digit
        return false;

    // skip the trailing whitespaces
    while (s[char_pos] == ' ') {
        ++ char_pos;
    }

    return char_pos == s.size();  // must reach the ending 0 of the string
}

void UnitTest() {
    double num = std::stod("825FB7FC8CAF4342");
    string num_str = std::to_string(num);

    // Not number
    assert(!isNumber("1a23"));
    assert(!isNumber("3.7.1"));
    assert(!isNumber("825FB7FC8CAF4342"));
    assert(!isNumber(" + 23.24"));
    assert(!isNumber(" - 23.24"));

    // Is number
    assert(isNumber("123"));
    assert(isNumber("3.7"));
    assert(isNumber("+23.7"));
    assert(isNumber("  -423.789"));
    assert(isNumber("  -423.789    "));
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T15:51:16.450

我想你想在输入字符串上运行正则表达式匹配。我认为测试所有边缘情况可能相当复杂。

[这个网站](http://www.regular-expressions.info/floatingpoint.html)有一些很好的信息。如果您只想跳到最后，它会说： `^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$`

如果您了解正则表达式语法，这基本上是有道理的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T15:55:31.293

**[编辑：固定以禁止初始空格和尾随废话。]**

```
#include <sstream>

bool isFloat(string s) {
    istringstream iss(s);
    float dummy;
    iss >> noskipws >> dummy;
    return iss && iss.eof();     // Result converted to bool
} 
```

您可以轻松地将其转换为基于类型`T`而不是`float`. 这本质上就是 Boost 的[lexical_cast](http://www.boost.org/doc/libs/1_37_0/libs/conversion/lexical_cast.htm)所做的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-03-20T15:48:30.663

使用快速而肮脏的解决方案[`std::stof`](http://en.cppreference.com/w/cpp/string/basic_string/stof)：

```
bool isFloat(const std::string& s) {
    try {
        std::stof(s);
        return true;
    } catch(...) {
        return false;
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-07-23T11:20:18.543

我一直很喜欢`strtof`，因为它可以让你指定一个结束指针。

```
bool isFloat(const std::string& str)
{
    char* ptr;
    strtof(str.c_str(), &ptr);
    return (*ptr) == '\0';
} 
```

这是有效的，因为结束指针指向解析开始失败的字符，因此如果它指向一个空终止符，那么整个字符串被解析为一个浮点数。

我很惊讶在这个问题出现的 10 年里没有人提到这种方法，我想是因为它更像是一种*C 风格*的方法。但是，它在 C++ 中仍然完全有效，并且比任何流解决方案都更优雅。此外，它适用于“+inf”“-inf”等，并忽略前导空格。

编辑

不要被空字符串抓住，否则结束指针将在 nul 终止（因此返回 true）。上面的代码应该是：

```
bool isFloat(const std::string& str)
{
    if (str.empty())
        return false;

    char* ptr;
    strtof(str.c_str(), &ptr);
    return (*ptr) == '\0';
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-15T23:17:51.807

您可以使用[如何在 C++ 中将字符串转换为双精度值中描述的方法？](https://stackoverflow.com/questions/392981/how-can-i-convert-string-to-double-in-c), 而不是抛出 a `conversion_error`，而是返回`false`（表示字符串不代表 a `float`），`true`否则。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-02-24T17:09:05.357

其他响应的主要问题是**性能**

通常你不需要每个角落的情况，例如也许 nan 和 -/+ inf，并不像速度一样重要。也许您不需要处理 1.0E+03 表示法。您只需要一种将字符串解析为数字的**快速方法。**

这是一个简单的纯 std::string 方式，速度不是很快：

```
size_t npos = word.find_first_not_of ( ".+-0123456789" );
if ( npos == std::string::npos ) {
   val = atof ( word.c_str() );
} 
```

这很慢，因为它是 O(k*13)，检查每个字符与 0 thur 9

这是一种更快的方法：

```
bool isNum = true;
int st = 0;
while (word.at(st)==32) st++;    // leading spaces
ch = word.at(st);
if (ch == 43 || ch==45 ) st++;   // check +, -

for (int n = st; n < word.length(); n++) {
  char ch = word.at(n);
  if ( ch < 48 || ch > 57 || ch != 46 ) {
     isNum = false;
     break;   // not a num, early terminate
  } 
} 
```

*如果发现任何*非数字字符，这具有提前终止的好处，并且它通过范围而不是每个数字位（0-9）进行检查。所以平均比较是每个字符 3 次，O(k*3)，提前终止。

请注意，此技术与 stdlib 'atof' 函数中使用的实际技术非常相似： [http ://www.beedub.com/Sprite093/src/lib/c/stdlib/atof.c](http://www.beedub.com/Sprite093/src/lib/c/stdlib/atof.c)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-08-04T15:01:14.357

使用 C++17：

```
bool isNumeric(std::string_view s)
{
    double val;
    auto [p, ec] = std::from_chars(s.data(), s.data() + s.size(), val);
    return ec == std::errc() && p == s.data() + s.size();
} 
```

退货时的两项检查都是必要的。第一个检查没有溢出或其他错误。第二个检查是否读取了整个字符串。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-15T15:50:00.230

您可以使用[atof](http://www.cplusplus.com/reference/clibrary/cstdlib/atof.html)然后对 进行特殊处理`0.0`，但我认为这不是一个特别好的解决方案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-15T15:53:07.120

这是关于 SO 的常见问题。查看[this question](https://stackoverflow.com/questions/200090/how-do-you-convert-a-c-string-to-an-int)以获取建议（该问题讨论了string->int，但方法相同）。

注意：要知道字符串是否可以转换，您基本上必须进行转换以检查诸如上溢/下溢之类的事情。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-15T15:57:04.507

您可以做的是使用 istringstream 并根据流操作的结果返回 true/false。像这样的东西（警告 - 我什至没有编译代码，这只是一个指导方针）：

```
float potential_float_value;
std::istringstream could_be_a_float(MyString)
could_be_a_float >> potential_float_value;

return could_be_a_float.fail() ? false : true; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-15T16:24:52.513

这取决于信任级别、您的需要以及输入数据的来源。如果数据来自用户，则与导入的表数据相比，您必须更加小心，因为您已经知道所有项目都是整数或浮点数，而这只是您需要区分的内容。

例如，最快的版本之一会简单地检查“。”的存在。和其中的“eE”。但是，您可能想看看其余的是否都是数字。在开头跳过空格 - 但不在中间，检查单个“。” “eE”等

因此，q&d 快速破解可能会导致更复杂的 regEx 类（调用它或自己扫描）方法。但是，你怎么知道结果——虽然看起来像一个浮点数——确实可以在你的机器中表示（即尝试 1.2345678901234567890e1234567890）。当然，您可以在尾数/指数中使用“最多 N”位数字制作正则表达式，但有时就是机器/操作系统/编译器或任何特定的。

所以，最后，可以肯定的是，你可能不得不调用底层系统的转换，看看你得到了什么（异常、无穷大或 NAN）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-05-13T10:47:47.133

我很想忽略前导空格，因为这也是该`atof`函数的作用：

> 该函数首先根据需要丢弃尽可能多的空白字符，直到找到第一个非空白字符。然后，从这个字符开始，尽可能多地采用类似于浮点文字的语法的有效字符，并将它们解释为数值。最后一个有效字符之后的字符串的其余部分将被忽略，并且对该函数的行为没有影响。

因此，为了匹配这一点，我们将：

```
bool isFloat(string s) 
{ 
    istringstream iss(s); 
    float dummy; 
    iss >> skipws >> dummy; 
    return (iss && iss.eof() );     // Result converted to bool 
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-10-06T10:42:11.447

```
int isFloat(char *s){
  if(*s == '-' || *s == '+'){
    if(!isdigit(*++s)) return 0;
  }
  if(!isdigit(*s)){return 0;}
  while(isdigit(*s)) s++;
  if(*s == '.'){
    if(!isdigit(*++s)) return 0;
  }
  while(isdigit(*s)) s++;
  if(*s == 'e' || *s == 'E'){
    s++;
    if(*s == '+' || *s == '-'){
        s++;
        if(!isdigit(*s)) return 0;
    }else if(!isdigit(*s)){
        return 0;
    }
  }
  while(isdigit(*s)) s++;
  if(*s == '\0') return 1;
  return 0;
} 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2019-05-26T04:07:22.687

我一直在寻找类似的东西，找到了一个比我见过的任何答案都简单得多的答案（虽然适用于浮点数 VS. ints，但仍需要从字符串进行类型转换）

```
bool is_float(float val){
    if(val != floor(val)){
        return true;
    }
    else
        return false;
} 
```

或者：

```
auto lambda_isFloat = [](float val) {return (val != floor(val)); }; 
```

希望这可以帮助 ！

兹马兹

# html - 网页到印刷媒体——解决方案？

> ID：447216
> 
> 赞同：6
> 
> 时间：2009-01-15T15:39:11.560
> 
> 标签：html, printing, media, mediawiki

我一直是 MediaWiki 和类似的基于 wiki 的文本编辑器的忠实粉丝。我喜欢快速添加文本、协作和共享的能力。但是，仍然需要格式良好的打印输出。页眉和页脚（说明我想让他们说的内容）、分页符、页边距等内容。

我见过的大多数解决方案都涉及到某种中间打印媒体格式的转换（可能是 MediaWiki 到 Microsoft Word，或者可能是一些从网页内容生成 PDF 的自定义脚本（有很多硬编码参考） .

这个问题是否存在更通用的解决方案？是否有任何框架试图将 HTML 和 Web 内容一般合并为打印媒体输出格式？

任何解决方案，关于赞成或反对的讨论，或任何受到欢迎的东西。

谢谢！

**更新：**我认为 CSS 只会让我到目前为止......我已经将 CSS 用于类似类型的输出（MediaWiki 默认情况下具有隐藏大部分导航栏内容的打印格式）。想想 MediaWiki 文章——想象一下我能够调整内容中的标签或类似的东西，现在我的边距是 1 英寸而不是 0.5 英寸。这更符合我的目标。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T15:43:34.360

[http://www.princexml.com/](http://www.princexml.com/)

可能适合你。它将 xml 和 html 页面转换为 pdf 文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T15:41:01.183

使用[打印 CSS 文件](http://www.alistapart.com/articles/goingtoprint/)是重新格式化打印页面的一种非常巧妙的方法。

很多人回退到 PDF，因为它*可以*更强大、更容易。

不过，对于大多数事情，我认为 CSS 标记更简单、更容易。

查看 StackOverflow 中页面的源代码，您会看到对`media="print"`(print.css) 的引用——一组仅在浏览器打印页面时应用的样式。

```
<link href="/Content/print.css" rel="stylesheet" media="print" type="text/css" /> 
```

您可以使用它们来隐藏导航栏、广告（或显示不同的广告）。做一些基本的分页等。

如果您需要对边距等内容进行更多控制，则必须离开浏览器（PDF、Word、XPS 等）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T07:56:55.503

您可能听说过[PediaPress](http://pediapress.com/)，这是一家与 Wikimedia Foundation 达成“wiki to print”（即 PDF，也包括 ODF）交易的公司。（请参阅[“Wikis Go Printable”](http://wikimediafoundation.org/wiki/Press_releases/Wikis_Go_Printable)。）他们的代码旨在与 MediaWiki 一起使用并且是[开源](http://code.pediapress.com/)的。

但！它甚至比那更好。看看这个[书签](http://pediapress.com/collection/)。您可以使用它来创建任何可公开访问的 MediaWiki 页面的 PDF 或 ODF（也许它也需要启用 API……）。您可以将来自单个 MediaWiki 或多个 MediaWiki 的多个页面捆绑到单个文档中。在我的书中，这真是太棒了。:)

ETA：PediaPress 投入了大量工作来制作看起来*非常*好读的东西。它不仅相当于将 MediaWiki 的可打印版本转换为 PDF。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T15:42:07.297

我编写了一个[MediaWiki 到 LaTeX 转换器](http://www.osresearch.net/wiki/index.php/LaTeX_and_MediaWiki)，它试图维护源文本的文档结构。然后使用 pdflatex 对文档进行排版以生成质量非常高的分页文档。数学标记直接由 LaTeX 渲染，所以方程看起来很棒。LaTeX 文档类/样式表可通过 wiki 中的专用命令进行配置，以直接控制页边距、页面布局、字体、额外包等。这将属于您的第二类自定义脚本而不是通用框架。

还有很多其他的，例如使用[htmldoc的](https://www.msweet.org/projects.php?Z1)[Extension:](http://www.mediawiki.org/wiki/Extension:Pdf_Export) Pdf_Export 。虽然它更通用，但它的分页工作非常糟糕，并创建了很多孤儿，没有进行最佳的文本对齐，也没有索引、数字、自我引用等。此外，如果你使用 <在 MediaWiki 中的 math> 标记只包含低分辨率的 PNG 文件。

[Princexml](http://www.princexml.com/license/)专门用于 MediaWiki 并生成好看的文档，但在免费许可下不可用。由于它是闭源产品，因此您控制输出的能力有限。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-10T23:02:03.783

一般来说，使用 CSS 打印样式 + 一些网页转 PDF 工具（[headless Chrome](https://developers.google.com/web/updates/2017/04/headless-chrome#create_a_pdf_dom)、[Electron](https://www.npmjs.com/package/electron-pdf)、[wkhtmltopdf](https://wkhtmltopdf.org/)、[Prince XML](https://www.princexml.com/)，或者如果您不需要自动化，则只使用您的网络浏览器的打印到 PDF 功能）。

专门针对 MediaWiki，[ElectronPdfService 扩展](https://www.mediawiki.org/wiki/Extension:ElectronPdfService)为您执行此操作。（此外，打印样式现在[正在改写](https://www.mediawiki.org/wiki/Reading/Web/Projects/Print_Styles)；请在一两个月后回来查看以改进演示。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-03T07:03:50.867

```
<style type="text/css">
    @media print {
        /***css rules for print mode ***/
        aside#sidebar, header[role="banner"], footer, #comments, #respond, #header-v1, .breadcrumbs, #footer-v1,.topbar-v1,.header-v1,.fcbtnremove {
            display: none;
        }

        .container.content-xs {
            width: 98%;
            margin: 0px;
            padding: 0px;
        }
    }

    @media screen {
        /***css rules for screen , it is sometiems opposite of print mode ***/
        #header-v1, .breadcrumbs, #footer-v1,.topbar-v1,.header-v1 {
            display: block;
        }
    }

    table td , table th{text-align:center;vertical-align:middle}
</style> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-24T10:33:42.123

mediawiki2latex 项目提供了一个解决方案。

任何 MediaWiki 页面都可以转换为 PDF、Epub、Odt 或 LaTeX

它可以在维基媒体基金会托管的服务器上在线使用：

[https://mediawiki2latex.wmflabs.org/](https://mediawiki2latex.wmflabs.org/)

还有一篇关于该项目的已发表文章

[http://www.tug.org/TUGboat/tb34-2/tb107huenniger.pdf](http://www.tug.org/TUGboat/tb34-2/tb107huenniger.pdf)

源代码在 GPL 下可用。有一个很好的 Debian 软件包：

```
sudo apt-get install mediawiki2latex
mediawiki2latex -u https://en.wikipedia.org/wiki/Epimorphism -o output.pdf
evince output.pdf 
```

# asp.net - ASP.NET Web 部署项目：摆脱 .compiled 文件

> ID：447217
> 
> 赞同：14
> 
> 时间：2009-01-15T15:39:16.117
> 
> 标签：asp.net, deployment, web-deployment-project

我正在使用 Visual Studio 2008 中的**Web 部署项目**，以便准备将我的**ASP.NET**应用程序（ASP.NET Web 应用程序，*而不是*ASP.NET 网站）复制到多个服务器。我必须通过 FTP 将文件复制到本地临时服务器上、不同服务器上，有时我必须从客户的服务器上获取它们。

因此，最好以紧凑的形式部署所有文件，而无需在源和目标之间进行大量比较。Web 部署项目有一个很好的特性：将所有的 aspx 和 ascx 文件编译成一个（附加的）程序集。

我不知何故发现了[如何摆脱](https://stackoverflow.com/questions/424230/is-there-a-way-to-get-rid-of-aspx-placeholder-files-in-a-asp-net-web-deployment-p)服务器上的 aspx 占位符文件，现在我想知道是否有（可能是自制的）方法来**摆脱这些`.compiled`文件**。

来自[Rick Strahl 的博客](http://www.west-wind.com/presentations/AspNetCompilation/AspNetCompilation.asp)：

> .Compiled 文件是网站中每个页面和控件的标记文件，并标识在程序集中使用的类。这些文件不是可选的，因为它们将 ASPX 页面映射到预编译程序集中的适当预编译类。如果您删除 .Compiled 文件，它所映射的页面将无法执行，并且您会遇到严重的执行错误。

有没有人有创意，可能使用模块/处理程序来拦截对`.compiled`bin 文件夹中文件的检查？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-31T01:30:49.960

.compile 文件来自部署时的预编译。所以你基本上有3个选择：

1.  保留 .compiled 文件
2.  不要预编译和部署源代码
3.  将其转换为 Web 应用程序而不是网站并编译为程序集

我自己也遇到过同样的问题。实际上，在大多数情况下，在处理网站部署时，我会选择 #1，但在极少数情况下，当我知道我将不得不长时间维护网站时，我会花时间将其升级到 Web应用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T16:36:27.673

我也不喜欢 .compiled 文件，但如果它们在那里，没有人会受到伤害。那么为什么要打扰呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T10:30:08.543

您可能想看看ASP.NET 中的[虚拟路径提供程序](http://msdn.microsoft.com/en-us/library/system.web.hosting.virtualpathprovider.aspx)（[KB 如何在此处](http://support.microsoft.com/kb/910441)）。

这个建议的功劳必须[归功于 Cheeso](https://stackoverflow.com/users/48082/cheeso)和他自己回答的问题：

> [我可以使用 ASP.NET 获得“WAR 文件”类型的部署吗？](https://stackoverflow.com/questions/619704/can-i-get-war-file-type-deployment-with-asp-net)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T11:43:18.250

我不知道 .compiled 文件，但您可以设置您的服务器以使用 subversion 更新其文件，而不是在编译时手动复制文件。

因此，您将使用 Web 部署项目（而不是单个程序集）编译文件，将它们放在为此目的创建的存储库中，然后在每台服务器上执行 svn update 以自动获取和比较文件。

我知道这不是您直接要求的，但它可能是一条探索之路。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T17:16:23.243

我记得在我不能用 VWD Express 做 Web 应用程序的日子里，我使用 nant 脚本将项目编译成单个 dll 并部署，这会起作用（所以我也不需要完整的 VS 来进行 dll 部署），所以如果你真的不想把你的项目弄乱到 Web 应用程序，也许这也是一个检查的路径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-26T21:10:46.103

您可以使用带有选项的[aspnet_merge](http://msdn.microsoft.com/en-us/library/bb397866.aspx)工具来删除`.compiled`文件。`-r`

> 删除主代码程序集的 .compiled 文件（App_Code 文件夹中的代码）。如果您的应用程序包含对主代码程序集的显式类型引用，请不要使用此选项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T21:04:31.237

将“排除过滤器”添加到您的部署项目中：

1.  在部署项目中。
2.  右键单击内容文件。
3.  点击“排除过滤器”。
4.  添加“*.Compiled”
5.  单击确定。

就是这样。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-27T07:31:58.833

如果您将代码发布为可更新（在发布设置中），则会生成这些文件。取消选中该值并重新发布。这是我知道的一个老问题，但这里没有明确定义答案。

# c# - 如何从 C# 打开 2 URL？

> ID：447221
> 
> 赞同：1
> 
> 时间：2009-01-15T15:39:26.570
> 
> 标签：c#

好的，听起来很简单，我知道我可以使用 Process.Start(" [http://mysite](http://mysite) ");

但是我需要一次打开2个网站！就像是

Process.Start(" [http://mysite](http://mysite) "); Process.Start(" [http://othersite](http://othersite) ");

我无法让它工作，因为它只打开第二个站点的过程。

任何帮助将不胜感激 ，

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T15:46:57.520

You could try opening each in a new thread.

```
Thread thread1 = new Thread(new ThreadStart(Process.Start("http://mysite")));
thread1.Start();

Thread thread2 = new Thread(new ThreadStart(Process.Start("http://othersite")));
thread2.Start();

thread1.Join();
thread2.Join(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T15:46:57.460

**Edit** Oops, didn't read the whole question, ignore this please :)

Sorry BFree, but i hate it that you force the user to use Internet explorer.

Use this code instead:

```
System.Diagnostics.Process.Start("http://www.geekpedia.com"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T15:56:52.320

Try putting a `Thread.Sleep(15000)` between the process start calls. You should then see more clearly what is happening. My guess is it's something in your default browser settings and the second URL is being loaded into the same window the first one was.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T15:49:55.800

It should work exactly as if you run it from windows run (Win-R). The reason is probably in your browser's settings. Check something like "Use same window for opening links" in your default browser's options.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T15:43:06.297

```
 Process.Start("iexplore","http://www.google.com");
    Process.Start("iexplore", "http://www.yahoo.com"); 
```

这将打开两个 IE 副本。您想要这种行为，还是希望它们在一个浏览器选项卡中？

# c# - Graphics.DrawImage 会无意中修剪图像吗？

> ID：447233
> 
> 赞同：0
> 
> 时间：2009-01-15T15:41:20.123
> 
> 标签：c#, graphics, tiff

我正在使用采用位图并将其转换为 24 BPP 的代码，以便我可以在特别需要该文件格式的程序中使用它。这是代码：

```
 using (Bitmap tempImage = new Bitmap(pageToScan.FullPath))
    {
       if (tempImage.PixelFormat != System.Drawing.Imaging.PixelFormat.Format24bppRgb)
       {
          using (Bitmap tempImage2 = new Bitmap(tempImage.Size.Width, tempImage.Size.Height,
             System.Drawing.Imaging.PixelFormat.Format24bppRgb))
          {
             using (Graphics g = Graphics.FromImage(tempImage2))
             {
                g.DrawImage(tempImage, new Point(0, 0));
             }
             RecognizeBitmap(pageToScan, tempImage2); //Thanks to Tim on this refactoring.
          }
       }
       else
          RecognizeBitmap(pageToScan, tempImage);
    } 
```

我对上面的代码有两个问题：

1.  对于一个特定的图像，我认为这会从 tempImage2 中剪掉最右边的 200 个像素。这可能吗？这怎么可能发生，我该如何阻止它？我的一个朋友建议这可能与正在使用的 TIFF 文件的步幅有关。
2.  有没有更快的方法将图像转换为内存中的 24 BPP？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T16:40:56.117

更好的方法是使用[Bitmap.Clone](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.clone(VS.80).aspx)方法。这需要一个 PixelFormat 作为参数：

```
using (Bitmap tempImage = new Bitmap(pageToScan.FullPath))    
{           
    if (tempImage.PixelFormat != System.Drawing.Imaging.PixelFormat.Format24bppRgb)
    {
        Rectangle r = new Rectangle(0, 0, tempImage.Width, tempImage.Height);
        RecognizeBitmap(pageToScan, tempImage.Clone(r, PixelFormat.Format24bppRgb);          
    }
    else                  
    {
        RecognizeBitmap(pageToScan, tempImage);    
    }
} 
```

# html - 没有javascript是否可以实现行高亮效果？

> ID：447242
> 
> 赞同：3
> 
> 时间：2009-01-15T15:43:05.860
> 
> 标签：html, css

我希望当前悬停在上面的“tr”改变颜色，然后当鼠标不再在它上面时变回来。这可能使用纯 CSS，还是 javascript 是唯一的解决方案？（我目前有一个 javascript 解决方案，所以我不需要这样的例子）

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-15T15:45:24.730

是的，这在 CSS 中是可能的。下面的示例通常将具有红色背景，而当将鼠标悬停在该行上时将具有绿色背景。

```
tr td { background: #f00; } 
tr:hover td { background: #0f0; } 
```

但是，应该注意这在 IE6 中不起作用，因为它不理解除 <a> 之外的任何元素上的 ":hover" 伪类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T15:44:21.503

我相信 javascript 是唯一提供跨浏览器支持的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T15:45:53.047

我认为您可以使用 :hover css 属性。

# javascript - 用 JavaScript 匹配精确的字符串

> ID：447250
> 
> 赞同：76
> 
> 时间：2009-01-15T15:45:05.450
> 
> 标签：javascript, regex

如何测试 RegEx 是否与字符串*完全*匹配？

```
var r = /a/;
r.test("a"); // returns true
r.test("ba"); // returns true
testExact(r, "ba"); // should return false
testExact(r, "a"); // should return true 
```

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-01-15T15:45:59.940

**事先**修改模式，使其仅匹配整个字符串：

```
var r = /^a$/ 
```

或者**之后**检查模式是否匹配整个字符串：

```
function matchExact(r, str) {
   var match = str.match(r);
   return match && str === match[0];
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-15T15:48:57.563

以不同的方式编写您的正则表达式：

```
var r = /^a$/;
r.test('a'); // true
r.test('ba'); // false 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-15T17:21:42.057

如果您不使用任何占位符（正如“确切地”似乎暗示的那样），那么字符串比较怎么样？

如果确实使用占位符，`^`则`$`分别匹配字符串的开头和结尾。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2014-05-13T06:57:22.877

```
var data =   {"values": [
    {"name":0,"value":0.12791263050161572},
    {"name":1,"value":0.13158780927382124}
]};

//JSON to string conversion
var a = JSON.stringify(data);
// replace all name with "x"- global matching
var t = a.replace(/name/g,"x"); 
// replace exactly the value rather than all values
var d = t.replace(/"value"/g, '"y"');
// String to JSON conversion
var data = JSON.parse(d); 
```

* * *

## 回答 #5

> 赞同：-10
> 
> 时间：2020-08-01T02:21:21.067

根据现代javascript标准，这是（IMO）**迄今为止**最好的解决方案：

```
const str1 = 'abc';
const str2 = 'abc';
return (str1 === str2); // true

const str1 = 'abcd';
const str2 = 'abc';
return (str1 === str2); // false

const str1 = 'abc';
const str2 = 'abcd';
return (str1 === str2); // false 
```

# java - Changing the font of text being typed in a JTextArea

> ID：447251
> 
> 赞同：2
> 
> 时间：2009-01-15T15:45:14.310
> 
> 标签：java, swing, fonts, jtextarea, jtextcomponent

I am working on a chat application and I want the user to be able to change their font while typing messages.

I tried using the `setFont()` method but it changes the font for the entire text within the `JTextArea` component and when the text is sent to the display area, another JTextArea component, the font changes do not appear. Instead it displays the text in the font of that set in the display area.

What I want to do is to change the font for either highlighted textarea or for the marker only and when the text is sent to the display area, the font changes should be evident.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-19T10:50:59.987

JTextArea 仅支持具有简单样式的简单纯文本。

我有同样的问题，但似乎答案是你应该使用 JEditorPane 或 JTextPane 而不是 JTextArea。

[编辑器窗格和文本窗格](http://java.sun.com/docs/books/tutorial/uiswing/components/editorpane.html)

# excel - 根据两个输入值在表中查找一个值

> ID：447268
> 
> 赞同：4
> 
> 时间：2009-01-15T15:47:53.183
> 
> 标签：excel, excel-formula

我对Excel中的函数`vlookup`和函数非常熟悉。`hlookup`但是，我正在寻找一种两者兼而有之的方法。举个例子：

```
 A             B        C  
1                     Resources
2   Task            Mgr   Sr. Mgr
3   -----------------------------
4   Task 1          30%       70%
5   Task 2          40%       60%
6   Task 3          50%       50%
7   Task 4          70%       30% 
```

如果我想在新单元格中放置一个公式来查找任务和资源类型以返回适当的百分比，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T16:17:12.653

INDEX 和 MATCH 的组合可以解决问题：

> =INDEX($B$4:$C$7,MATCH("任务 3",$A$4:$A$7,0),MATCH("经理",$B$2:$C$2,0))

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T16:31:53.797

另一种可能：

```
=VLOOKUP(E3,A2:C7,MATCH(E2,A2:C2,0),FALSE) 
```

在哪里

*   E3 包含要查找的任务
*   E2 包含标题列名称（例如 Mgr）
*   A2:A7 是数据表
*   A2:C2 是标题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T16:16:38.897

```
=OFFSET(A3,MATCH("Task 3", A4:A7, 0),MATCH("Mgr",B2:C2,0)) 
```

当然，您可能会从其他单元格中获取要查找的内容，因此请将上面的“Task 3”和“Mgr”替换为对这些单元格的引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T16:27:22.883

好的，假设您有一个具有以下格式的 Excel 工作表，其中您的查找表占据单元格区域 A1:E5

```
 C1    C2    C3    C4
R1  R1C1  R1C2  R1C3  R1C4
R2  R2C1  R2C2  R2C3  R2C4
R3  R3C1  R3C2  R3C3  R3C4
R4  R4C1  R4C2  R4C3  R4C4 
```

还假设您想分别在单元格 G3 和 H3 中输入行标题名称和列标题名称（我有文本值“R3”和“C2”）。

在您希望显示输出值的单元格中，您可以像这样使用 HLOOKUP：

```
=HLOOKUP(H3,A1:E5,MATCH(G3,A1:A5,0)) 
```

或 VLOOKUP 像这样：

```
=VLOOKUP(G3,A1:E5,MATCH(H3,A1:E1,0)) 
```

在我的输出单元格中显示值“R3C2”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-03-18T06:38:52.483

好极了

我刚刚想出了一个替代的、更简单的答案……它是一个 IF 函数！好吧，我的意思如下；

您有 2 个输入单元格，均使用数据验证列表格式化。一个有任务，一个有职位，如问题所示。

现在我们使用 vlookup 函数来确定我们将要获得的行，然后使用 IF 函数来确定列！

现在假设您的输入单元格在 E1 和 F1 处彼此相邻

所以这个公式的一个例子是，

=vlookup($E$1,$A$4:$C$7,IF($F$1="MGR",2,3),FALSE)

这很好用，甚至可以通过使用 IFS 函数与 2 列以上一起使用！

我希望这对将来的一些孩子有所帮助，他们完全按照我的做法去做，并在非常困惑之后上网寻求答案哈哈哈

# c# - How do I access Mouse movement events in WPF regardless of where the mouse is?

> ID：447279
> 
> 赞同：1
> 
> 时间：2009-01-15T15:50:13.707
> 
> 标签：c#, wpf, events, mouse

I have tried to use the MouseMove event to track the position of the mouse.

```
protected override void OnMouseMove(MouseEventArgs e) 
```

This works when the mouse is over the given UIElement (in this case, my application's window,) however I would like to access this data regardless of where the mouse is, and preferably even regardless of whether or not my application has focus.

I thought that Mouse.Capture was the solution, and I have used it to capture to my window, however MouseMove is still only raised when the mouse is over the window.

Does anyone know how to get MouseMove events (or similar) independent of mouse position?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:52:15.047

You could P/Invoke the Win32 GetCursorPos function. I think that would be the most reliable way: [GetCursorPos on MSDN](http://msdn.microsoft.com/en-us/library/ms648390(VS.85).aspx).

The required DllImport declaration can be found here: [http://www.pinvoke.net/default.aspx/user32/GetCursorPos.html](http://www.pinvoke.net/default.aspx/user32/GetCursorPos.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T16:06:55.173

If you want to do this within the bounds of your application, you should use the `PreviewMouseMove` event. Your `Window` will always get this first before it routes down to child elements. If you handle `MouseMove` at the `Window` level, then child elements may mark the event as handled and you may therefore never get the event.

An alternative to using `PreviewMouseMove` is to subclass `Window` and attach a class handler to `MouseMove` and specify that you would always like notification, regardless of whether someone else marked the event as handled. More info available [here](http://msdn.microsoft.com/en-us/library/ms742806.aspx#class_handlers).

# .net - 为什么 Math.DivRem 效率如此之低？

> ID：447282
> 
> 赞同：37
> 
> 时间：2009-01-15T15:50:47.247
> 
> 标签：.net, optimization

在我的电脑中，这段代码需要 17 秒（10 亿次）：

```
static void Main(string[] args) {
   var sw = new Stopwatch(); sw.Start();
   int r;
   for (int i = 1; i <= 100000000; i++) {
      for (int j = 1; j <= 10; j++) {
         MyDivRem (i,j, out r);
      }
   }
   Console.WriteLine(sw.ElapsedMilliseconds);
}

static int MyDivRem(int dividend, int divisor, out int remainder) {
   int quotient = dividend / divisor;
   remainder = dividend - divisor * quotient;
   return quotient;
} 
```

而 Math.DivRem 需要 27 秒。

[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)为我提供了 Math.DivRem 的代码：

```
public static int DivRem(int a, int b, out int result)
{
    result = a % b;
    return (a / b);
} 
```

### CIL

```
.method public hidebysig static int32 DivRem(int32 a, int32 b, [out] int32& result) cil managed
{
    .maxstack 8
    L_0000: ldarg.2
    L_0001: ldarg.0
    L_0002: ldarg.1
    L_0003: rem
    L_0004: stind.i4
    L_0005: ldarg.0
    L_0006: ldarg.1
    L_0007: div
    L_0008: ret
} 
```

从理论上讲，对于具有多核的计算机，它可能会更快，但实际上它不需要首先执行两个操作，因为 x86 CPU在使用 DIV 或 IDIV 进行整数除法时会返回**商和余数（** [http： //www.arl.wustl.edu/~lockwood/class/cs306/books/artofasm/Chapter_6/CH06-2.html#HEADING2-451](http://www.arl.wustl.edu/~lockwood/class/cs306/books/artofasm/Chapter_6/CH06-2.html#HEADING2-451)）！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-15T16:06:54.017

嗯。这个函数存在的唯一原因是为了利用 CPU 指令，他们甚至没有这样做！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-15T17:47:57.450

哇，这看起来真的很愚蠢，不是吗？

问题在于——根据 Lidin 的 Microsoft Press 书籍“.NET IL Assembler”——IL rem 和 div 算法指令正是：计算余数和计算除数。

> 除取反运算外的所有算术运算都从堆栈中取出两个操作数并将结果放入堆栈。

显然，按照 IL 汇编语言的设计方式，不可能有一条 IL 指令产生两个输出并将它们推入 eval 堆栈。鉴于该限制，您不能在 IL 汇编程序中使用除法指令来计算 x86 DIV 或 IDIV 指令的方式。

IL 是为安全性、可验证性和稳定性而设计的，而**不是**为性能而设计的。任何拥有计算密集型应用程序并且主要关心性能的人都将使用本机代码而不是 .NET。

我最近参加了 Supercomputing '08，在其中一个技术会议上，Microsoft Compute Server 的一位布道者给出了粗略的经验法则，即 .NET 通常是本机代码速度的一半——这正是这里的情况！

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-01-23T11:34:23.230

虽然 .NET Framework 4.6.2 仍然使用次优的模和除法，但 .NET Core (CoreCLR)[目前](https://github.com/dotnet/runtime/blob/6072e4d3a7a2a1493f514cdf4be75a3d56580e84/src/libraries/System.Private.CoreLib/src/System/Math.cs#L256)用减法代替了除法：

```
 public static int DivRem(int a, int b, out int result)
    {
        // TODO https://github.com/dotnet/runtime/issues/5213:
        // Restore to using % and / when the JIT is able to eliminate one of the idivs.
        // In the meantime, a * and - is measurably faster than an extra /.

        int div = a / b;
        result = a - (div * b);
        return div;
    } 
```

并且有一个悬而未决的问题需要[专门](https://github.com/dotnet/runtime/issues/4155)[改进`DivRem`](https://github.com/dotnet/runtime/issues/4155)（通过内在），或者[检测和优化](https://github.com/dotnet/runtime/issues/5213)RyuJIT 中的一般情况。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T16:37:51.803

如果我不得不大胆猜测，我会说实现 Math.DivRem 的人不知道 x86 处理器能够在一条指令中完成它，因此他们将其编写为两个操作。如果优化器正常工作，这不一定是坏事，尽管它是另一个指标，表明现在大多数程序员都缺乏低级知识。我希望优化器能够折叠模数，然后将操作分成一条指令，编写优化器的人应该知道这些低级的东西......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T16:00:15.763

答案可能是没有人认为这是一个优先事项——这已经足够好了。任何新版本的 .NET Framework 都没有解决这个问题，这一事实表明它很少使用——很可能没有人抱怨过。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T16:01:07.087

其他人在测试时会得到相反的结果吗？

```
Math.DivRem = 11.029 sec, 11.780 sec
MyDivRem = 27.330 sec, 27.562 sec
DivRem = 29.689 sec, 30.338 sec 
```

FWIW，我正在运行 Intel Core 2 Duo。

上面的数字是调试版本...

随着发布版本：

```
Math.DivRem = 10.314
DivRem = 10.324
MyDivRem = 5.380 
```

看起来“rem”IL 命令的效率低于 MyDivRem 中的“mul,sub”组合。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T16:50:58.810

效率很可能取决于所涉及的数量。您正在测试可用问题空间的一小部分，并且全部是前端加载的。您正在检查前 100 万 * 10 = 10 亿个连续输入组合，但实际问题空间约为 42 亿平方或 1.8e19 个组合。

像这样的通用库数学运算的性能需要在整个问题空间中摊销。我很想看看更规范化的输入分布的结果。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-08T19:30:45.837

这实际上只是一个评论，但我没有足够的空间。

这是一些 C# 使用`Math.DivRem()`：

```
 [Fact]
    public void MathTest()
    {
        for (var i = 1; i <= 10; i++)
        {
            int remainder;
            var result = Math.DivRem(10, i, out remainder);
            // Use the values so they aren't optimized away
            Assert.True(result >= 0);
            Assert.True(remainder >= 0);
        }
    } 
```

这是对应的IL：

```
.method public hidebysig instance void MathTest() cil managed
{
    .custom instance void [xunit]Xunit.FactAttribute::.ctor()
    .maxstack 3
    .locals init (
        [0] int32 i,
        [1] int32 remainder,
        [2] int32 result)
    L_0000: ldc.i4.1 
    L_0001: stloc.0 
    L_0002: br.s L_002b
    L_0004: ldc.i4.s 10
    L_0006: ldloc.0 
    L_0007: ldloca.s remainder
    L_0009: call int32 [mscorlib]System.Math::DivRem(int32, int32, int32&)
    L_000e: stloc.2 
    L_000f: ldloc.2 
    L_0010: ldc.i4.0 
    L_0011: clt 
    L_0013: ldc.i4.0 
    L_0014: ceq 
    L_0016: call void [xunit]Xunit.Assert::True(bool)
    L_001b: ldloc.1 
    L_001c: ldc.i4.0 
    L_001d: clt 
    L_001f: ldc.i4.0 
    L_0020: ceq 
    L_0022: call void [xunit]Xunit.Assert::True(bool)
    L_0027: ldloc.0 
    L_0028: ldc.i4.1 
    L_0029: add 
    L_002a: stloc.0 
    L_002b: ldloc.0 
    L_002c: ldc.i4.s 10
    L_002e: ble.s L_0004
    L_0030: ret 
} 
```

这是生成的（相关）优化的 x86 程序集：

```
 for (var i = 1; i <= 10; i++)
00000000  push        ebp 
00000001  mov         ebp,esp 
00000003  push        esi 
00000004  push        eax 
00000005  xor         eax,eax 
00000007  mov         dword ptr [ebp-8],eax 
0000000a  mov         esi,1 
        {
            int remainder;
            var result = Math.DivRem(10, i, out remainder);
0000000f  mov         eax,0Ah 
00000014  cdq 
00000015  idiv        eax,esi 
00000017  mov         dword ptr [ebp-8],edx 
0000001a  mov         eax,0Ah 
0000001f  cdq 
00000020  idiv        eax,esi 
```

请注意对*2*的调用`idiv`。第一个将余数 ( `EDX`) 存储到`remainder`堆栈上的参数中。第二个是确定商（`EAX`）。第二次调用并不是真正需要的，因为`EAX`在第一次调用`idiv`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T16:25:35.493

这是我的数字：

```
15170 MyDivRem
29579 DivRem (same code as below)
29579 Math.DivRem
30031 inlined 
```

测试略有改变；我为返回值添加了赋值并正在运行发布构建。

酷睿 2 双核 2.4

观点：

您似乎找到了一个不错的优化；）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-26T11:52:52.420

我猜想大部分增加的成本是在静态方法调用的设置和拆除中。

至于它为什么存在，我猜它部分是为了完整性，部分是为了其他语言的好处，这些语言可能不容易使用整数除法和模数计算的实现。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-01-15T16:42:51.403

这部分是野兽的本性。据我所知，没有通用的快速方法来计算除法的余数。这将需要相应大量的时钟周期，即使有 x 亿个晶体管。

# workflow-foundation - 查找代码是否在工作流中运行的最佳方法是什么？

> ID：447285
> 
> 赞同：1
> 
> 时间：2009-01-15T15:51:32.347
> 
> 标签：workflow-foundation

我有可以在许多执行环境中运行的通用代码——在 IIS 中、在 WCF 服务中、在独立应用程序中或在 Windows 工作流实例中。

但是检查代码是否在工作流中运行的最佳方法是什么？目前，我一直在用这段代码寻找`WorkflowEnvironment.WorkflowInstanceID`并捕捉任何异常：

```
...
try
{
  if (WorkflowEnvironment.WorkflowInstanceId != null)
  {
    return ExecutionContext.Workflow;
  }
}
catch
{
}

// return unknown
return ExecutionContext.Unknown; 
```

没有更好的方法吗？我想消除对`try...catch`块的需要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-18T11:05:31.497

确实没有更好的方法可以做到这一点。

您可以首先检查的一件事是 System.Diagnostics.Trace.CorrelationManager.ActivityId。如果这等于 Guid.Empty，那么您不在使用 DefaultWorkflowSchedulerService 的工作流中。不幸的是，手动调度程序没有设置这个 ActivityId 所以在这种情况下它没有帮助。

BTW 这个ActivityId 与工作流无关，而是E2E 跟踪activityId，它也被设置为工作流InstanceId。

# bash - Bash：如何使用一个子命令生成的多个结果来提供命令

> ID：447288
> 
> 赞同：4
> 
> 时间：2009-01-15T15:52:38.257
> 
> 标签：bash, gcc

我想在预处理后处理每个源代码文件：

```
myprocess `gcc -E file1.c`  
myprocess `gcc -E file2.c`  
...  
myprocess `gcc -E fileN.c` 
```

这变得乏味，所以我如何使这个命令成为一个命令？
也就是说，沿着这条线：

```
myprocess SOMETHINGMAGIC(gcc -E file*.c) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T15:55:11.857

你的意思是喜欢

```
 for i in file*.c ; do
        myprocess `gcc -E $i`
    done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T16:01:13.950

如果这是正在进行的过程的一部分（而不是一次性的事情），请使用`make`，它擅长自动化工作管道。

特别是使用带有传统 make 或 gmake 风格隐式规则的后缀规则。

以下是后缀规则实现的概要：

```
.c.cpre:
         $(CC) -E $(CPPFLAGS) -o $@ $<
.cpre.cmy:
         $(MY_PROCESS) $<
         # Or whatever syntax you support..
         #
         # You could 
         # $(RM) $<
         # here, but I don't recommend it
.cmy.o:
         $(CC) -c $(CFLAGS) $(CPPFLAGS) -o $@ $<
         # $(RM) $< 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T16:10:43.480

也许这就是你要找的？：

```
for i in file*.c ; do 
    echo "Header for myprocess: $i" 
    gcc -E $i 2>&1 
done | myprocess 
```

`2>&1`假设您想要获取 stderr，也
`echo ...`为 myprocess 提供了每次编译的起点

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T16:18:11.077

没有魔法，只是

```
my_process $(gcc -E *.c) 
```

请注意，我使用了 $(command) 表单，因为不推荐使用反引号。

顺便说一句：您确定要这样做*吗*？您将 gcc -E 的整个输出作为 my_process 的命令行参数。不确定这是你想要的。也许你想使用一个简单的管道

```
gcc -E file.c | my_process 
```

使 gcc 的输出成为 my_process 的输入。

在后一种情况下，类似于

```
for c_file in *.c ; do
    gcc -E $c_file | myprocess > ${c_file}.processed
done 
```

会成功的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T16:12:08.437

怎么样：

```
myprocess {$(gcc -E file1.c),$(gcc -E file2.c),$(gcc -E file3.c)} 
```

或者，如果您使用管道传输它：

```
{$(gcc -E file1.c),$(gcc -E file2.c),$(gcc -E file3.c)} | myprocess 
```

我已经有一段时间没有使用 bash，所以请指出我的错误！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-03T22:53:30.980

ls 文件*.c | xargs --replace myprocess $(gcc -E {})

# eclipse - Tomcat 6 server creation using eclipse IDE on ubuntu

> ID：447289
> 
> 赞同：57
> 
> 时间：2009-01-15T15:52:49.147
> 
> 标签：eclipse, ubuntu, tomcat6

I'm having a problem running tomcat 6 with eclipse 3 in ubuntu.

I installed tomcat 6 on my machine and when I tested it using `http://localhost:8080`, it worked fine.

But whenever i want to create a server in eclipse, i select Tomcat 6 , i get the following message `"Cannot create a server using the selected type"`, and i can't click next.

Any idea why?

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2010-01-16T13:59:08.230

有一个更好的解决方法，因此您可以保留 Ubuntu 的 Tomcat6（取自[http://ubuntuforums.org/showthread.php?p=8541057](http://ubuntuforums.org/showthread.php?p=8541057)，由 DisDis 获取）

在终端中：

```
sudo apt-get install tomcat6
cd /usr/share/tomcat6
sudo ln -s /var/lib/tomcat6/conf conf
sudo ln -s /etc/tomcat6/policy.d/03catalina.policy conf/catalina.policy
sudo ln -s /var/log/tomcat6 log
sudo chmod -R 777 /usr/share/tomcat6/conf 
```

那里。现在只需转到 Window/Preferences/Sever/Runtime Environments，添加 Apache Tomcat6 服务器并使用 /usr/share/tomcat6 作为安装目录！

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-01-25T21:36:12.673

好的，这对我有用：您必须转到 Window>Preferences

在这里，转到服务器>运行时环境

删除旧服务器或添加您的服务器或更改服务器位置...

（在我的情况下，当我更改 tomcat 服务器位置时出现了这个问题）

现在您应该可以将新服务器添加到您的环境中了 :)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-24T09:59:25.240

您是否一直在使用 ubuntu-tomcat 版本（例如“aptitude install tomcat6”）？[如果是这样，请从tomcat.apache.org](http://tomcat.apache.org)下载一个普通版本并使用它。Debian/Ubuntu 版本重新定位了一些 jar，eclipse 需要“纯”版本和 jar 位置。

（另外：参见[Eclipse 错误 239179](https://bugs.eclipse.org/bugs/show_bug.cgi?id=239179)）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-22T11:22:02.443

删除（或编辑其中的 apache tomcat v6.0 条目）workspace.metadata.plugins\org.eclipse.core.runtime.settings\org.eclipse.jst.server.tomcat.core.prefs

我认为您还需要重新启动

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-04-10T20:44:14.557

我写了一个补丁来解决这个问题，它已被合并到 Ubuntu 和 Debian 中。现在可以毫不费力地在 Eclipse 中配置 tomcat6。

在 Ubuntu 11.04 中，您可以安装 tomcat6-user 包。然后通过运行此命令配置一个 tomcat6 的用户实例

> $tomcat6-instance-create ~/my-tomcat-dir

将在 ~/my-tomcat-dir 目录中配置一个 tomcat6 的用户实例。

现在要在 eclipse 中添加 tomcat6 来设置你的开发环境，只需将 eclipse 指向这个目录，你就可以开始了。

如果您运行的是旧版本的 Ubuntu，那么您只需从 Debian FTP 下载最新版本的 tomcat6-user 软件包：http://packages.debian.org/hu/sid/all/tomcat6-user/download

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-11T17:18:05.743

我有同样的问题，但使用tomcat 5.5。更改 /etc/tomcat5.5/conf（来自 /usr/share/tomcat5.5/conf 的符号链接）的权限有效。谢谢！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-20T15:18:52.907

我遇到了同样的问题

我有最新的 eclipse 3.4.1 GanyMede。将 Ubuntu Tomcat 6 安装更改为来自 tomcat.apache.org 的普通安装

chmod 666 /usr/share/tomcat6/conf*

问题就解决了

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-10-31T06:32:04.247

我有同样的问题，但感谢您的所有反馈，我得到了修复。总之...

我有 Ubuntu 9.04，Eclipse Galileo（java EE 开发者平台 3.5.1）。

我安装Tomcat如下：

sudo tar zxvf apache-tomcat-6.0.20.tar.gz

sudo cp -R apache-tomcat-6.0.20 /usr/share/tomcat6

如解释： [http ://www.ubuntugeek.com/tomcat-6-installation-on-ubuntu-feisty.html](http://www.ubuntugeek.com/tomcat-6-installation-on-ubuntu-feisty.html)

然后我将权限更改为 conf 文件夹 /usr/share/tomcat6/conf$ sudo chmod a+rw *

我从 Windows->Preferences->Server->Runtime Environment 中删除了它（但我认为这一步毕竟没有必要）

瞧！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-02-15T20:33:00.007

转到窗口 > 首选项--转到运行时环境--您可能会找到旧安装 Tomcat 的位置。将其更改为当前位置会有所帮助。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-16T08:57:02.073

如果您有较新版本的 eclipse，请尝试在帮助/软件更新中更新 Web Tool Plateform 插件...如果 eclipse 和 WTP 都是最新的，我看不出问题可能是...

PS：有一个“评论”按钮，不要发布答案来评论答案；）

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-15T16:35:57.780

如果您可以使用[http://localhost:8080](http://localhost:8080)对其进行测试，那么服务器已经在运行，Eclipse 无需创建任何内容。尝试关闭服务器，然后设置eclipse指向安装目录。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-15T15:59:32.487

Not sure, but maybe your version of Eclipse does not support the latest Tomcat version? Try to update Eclipse. I have Eclipse 3.4 and there's no problem.

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-11T14:50:50.317

我一直有同样的问题（在 Fedora 9 上）。您必须将 tomcat conf 目录中的文件的权限更改为 rw (chmod a+rw tomcat6/conf/*)。为我解决了！

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-03-21T16:54:42.743

这个也对我有用 Window -> Options -> Server -> Runtime Environments

编辑现有运行时环境“Apache Tomcat v6.0”并选择您的tomcat 的位置。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2010-07-21T14:24:26.837

您必须将分散在文件系统中的各种文件夹符号链接到所需的 tomcat6 主（或安装）文件夹。

tsaid 建议符号链接到 /usr/share/tomcat6，我宁愿使用 /var/lib/tomcat6。

我的 /var/lib/tomcat6 目录（请参阅我制作的符号链接）：

```
$ ls -g -o /var/lib/tomcat6
lrwxrwxrwx 1   22 2010-07-20 18:15 bin -> /usr/share/tomcat6/bin
drwxr-xr-x 3 4096 2010-07-20 12:22 common
lrwxrwxrwx 1   12 2010-07-20 12:22 conf -> /etc/tomcat6
lrwxrwxrwx 1   22 2010-07-20 18:14 lib -> /usr/share/tomcat6/lib
lrwxrwxrwx 1   17 2010-07-20 12:22 logs -> ../../log/tomcat6
drwxr-xr-x 3 4096 2010-07-20 12:22 server
drwxr-xr-x 3 4096 2010-07-20 12:22 shared
drwxrwxr-x 3 4096 2010-07-20 12:22 webapps
lrwxrwxrwx 1   19 2010-07-20 12:22 work -> ../../cache/tomcat6 
```

另外，不要忘记为您的配置文件提供完整的 rw 权限，在我的例子中是 /etc/tomcat6。由于您还需要从 Catalina/localhost/catalina.policy 对 catalina.policy 进行符号链接，因此不要忘记为这些文件夹授予执行权限。您可以通过对 conf 文件夹的完全权限进行简化，但仅在您是计算机的唯一用户时才建议这样做。

```
cd /var/lib/tomcat6/conf
chmod -R a+xrw * 
```

现在，删除 Eclipse 中的 Window -> Preferences -> Server -> Runtime Environment 下的条目，然后通过 Run on Server 或其他任何地方添加一个新服务器。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-01T14:47:41.193

窗口 -> 选项 -> 服务器 -> 运行时环境

编辑现有运行时环境“Apache Tomcat v6.0”并选择您的tomcat 的位置。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-03-03T12:21:06.623

我有同样的问题，我使用的是 ubuntu 9.04 和 tomcat 6。

我为apt-get安装了tomcat 6，还安装了jre，jdk。（太阳）

为了解决问题，请执行以下操作：

*   关闭日食；
*   删除您的工作区（保存您的文件）；
*   停止 tomcat6 (/etc/init.d/tomcat6 stop)
*   建立一个到conf的链接（ln -s /var/lib/tomcat6/conf /usr/share/tomcat6）；
*   ln -s /var/lib/tomcat6/catalina.policy /etc/tomcat6/
*   初始化日食
*   在服务器 tomcat 配置中 (/usr/share/tomcat6)

# vb6 - VB6 ListBox Click 和 DblClick

> ID：447290
> 
> 赞同：2
> 
> 时间：2009-01-15T15:52:53.857
> 
> 标签：vb6

当用户单击或双击 VB6 ListBox 控件中的项目时，我需要运行不同的代码。当我单击控件时，将执行 Click 事件处理程序。但是，我发现当我双击控件时，Click 和 DblClick 事件处理程序都会执行。

任何人都有一个很好的解决方案，可以让 DblClick 事件处理程序代码在没有首先执行 Click 代码的情况下运行？

在此先感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T15:57:18.717

一个小技巧，但您可以使用 Timer 控件和布尔变量：

*   在 Click 事件上启动计时器，将布尔变量设置为 false
*   在 DoubleClick 事件上将布尔变量设置为 true
*   当计时器 Tick 事件触发时，检查布尔变量以查看用户是否执行了 Click 或 DoubleClick

我建议将计时器间隔设置为 Windows 双击时间设置，再加上一点（应该有一个 Windows API 调用会给你这个值）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T13:21:35.250

Visual Basic 6 中列表控件的行为如下。

1.  当您单击一个项目时，会触发单击事件。

2.  当您单击 SAME 项目时，仍然会触发单击事件。

3.  当您双击该项目时，单击事件和双击事件都会被触发。

笔记2。您需要做的是在您使用的表单中拥有一个当前项目。每次检查单击事件时，您首先查看当前项目是否与您单击的项目相同。如果它不是同一个项目，您将正常处理点击事件。

如果您双击一个新项目，那么用户正在同时做两件事。选择一个新项目并执行双击项目。在这种情况下，首先触发单击，然后触发双击。

此序列与控件执行您想要的操作没有什么不同。这就像您单击一个新项目等待 X 秒然后双击同一个项目一样。

如果您的单击事件涉及将任务移交给 ActiveX EXE 并立即终止或设置稍后由后台计时器处理的数据。然后，您需要有一个信号量或一个标志来指示单击事件产生的进程何时完成。在清除信号量之前，不会处理双击事件。

如果您有其他详细信息，我的回答可能会更具体。以下是您可以运行以查看列表框的一些代码。创建一个表单并将三个项目添加到列表中。然后添加以下代码。

```
Private Sub List1_Click()
    Print "Clicked - " & Me.List1.List(Me.List1.ListIndex)
End Sub

Private Sub List1_DblClick()
    Print "Double Clicked - " & Me.List1.List(Me.List1.ListIndex)
End Sub 
```

执行以下步骤

1.  点击项目#1
2.  点击项目#2
3.  再次单击项目#2
4.  双击项目#2
5.  双击项目#3

您将看到发生的各种操作组合。

# c# - 在 C# 中，有没有办法在选择选项卡的情况下打开第二个表单？

> ID：447292
> 
> 赞同：1
> 
> 时间：2009-01-15T15:53:07.710
> 
> 标签：c#, .net, winforms

有谁知道在 .NET 应用程序中打开第二个表单的方法，并在该表单的选项卡控件中选择了某个选项卡？

这就是我当前的代码的样子，它只是打开了表单：

```
SettingsForm TheSettingsForm = new SettingsForm(this);
TheSettingsForm.Show(); 
```

SettingsForm.cs 是要打开的第二个表单的名称。

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:57:29.230

您只需要在表单上公开一个允许调用代码设置所需选项卡的属性。你可以通过这样的索引来做到这一点：

```
var form = new SettingsForm(this);
form.SelectedTab = 2;
form.Show(); 
```

表单上的属性只会在选项卡控件上设置适当的属性：

```
public int SelectedTab
{
    get { return _tabControl.SelectedIndex; }
    set { _tabControl.SelectedIndex = value; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T15:58:50.087

做这样的事情：

```
SettingsForm TheSettingsForm = new SettingsForm(this);
TheSettingsForm.TabPanel.SelectedIndex = SettingsFormTabIndexes.MyDesiredTab;
TheSettingsForm.Show(); 
```

您在 TheSettingsForm 中创建了一个属性，该属性公开了选项卡控件，而 SettingsFormTabIndexes 是一个友好的枚举，按索引命名所有选项卡。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T16:06:57.513

将事件处理程序添加到[TabControl.SelectedIndexChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.tabcontrol.selectedindexchanged.aspx)事件。

```
myTabControl.SelectedIndexChanged += myTabControl_SelectedIndexChanged;

private void myTabControl_SelectedIndexChanged(object sender, EventArgs e) {
    TabControl tc = sender as TabControl;
    if (tc.SelectedIndex == indexOfTabToShowFormOn) {
        TheSettingsForm.Show();
    }
} 
```

# java - What can I use to connect Java to Video4Linux?

> ID：447298
> 
> 赞同：2
> 
> 时间：2009-01-15T15:53:52.233
> 
> 标签：java, linux, openmoko

I need to talk to Video4Linux (to capture output from a webcam) on a debian system running on an armel system (OpenMoko). JavaMediaFramework won't work in this case as it only have x86 and AMD versions. The linux kernel is 2.6.24 (with the v4l drivers compiled in separatly) and I cannot upgrade it (as it is not available on my hardware.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-01T23:00:52.557

I have been following closely a project called [video4linux4java](http://v4l4j.googlecode.com) . I now works with a lot of drivers (therefore a lot of webcams & capture cards), and produces a JPEG-encoded stream of images captured from a video device. Recently, the author has added classes to report information on the video device itself (webcam, TV tuner, ...). It is simple to use and comes with some examples. One of them (used to test v4l4j) displays a video stream in a JFrame. I use v4l4j in my own app to capture frames from my Logitech Quickcam Sphere AF, and control the pan and tilt. Works Great !

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-01-16T16:41:48.467

视频 4 Linux 设备应该可以通过设备文件（如 /dev/video）访问。因此，我认为您可以像使用普通文件一样打开要访问的设备，然后读取来自它的流。要了解有关设备、视频格式等的更多信息...只需查看[V4L 网站](http://linux.bytesex.org/v4l2/)

# c# - 使用 C# 的更大文件流

> ID：447299
> 
> 赞同：1
> 
> 时间：2009-01-15T15:54:16.087
> 
> 标签：c#, filestream

我需要使用 C#.Net 访问一些文本文件（记录）。但问题是这些文件大于 1GB。（最小大小为 1 GB）

我应该怎么做？我需要关注哪些因素？

有人可以给我一个想法来摆脱这种情况。

编辑：

感谢您的快速回复。是的，它们是固定长度的记录。这些文本文件来自本地公司。（有上个月交易记录）

是否可以像普通文本文件一样访问这些文件（使用普通文件流）。

和

内存管理呢？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T16:04:21.057

扩展 CasperOne 的答案

简单地说，没有办法一次可靠地将 100GB 的文件放入内存中。在 32 位机器上根本没有足够的寻址空间。在 64 位机器中，有足够的寻址空间，但在实际将文件放入内存中的时间里，您的用户会因为沮丧而终止您的进程。

诀窍是增量处理文件。基础 System.IO.Stream() 类旨在处理不同数量的可变（可能是无限）流。它有几个 Read 方法，它们只会在流中前进特定数量的字节。您将需要使用这些方法来划分流。

我无法提供更多信息，因为您的方案不够具体。您能否提供更多详细信息或您的记录分隔符或文件中的一些示例行？

**更新**

如果它们是固定长度的记录，那么 System.IO.Stream 就可以正常工作。您甚至可以使用 File.Open() 来访问底层 Stream 对象。Stream.Read 有一个重载，它请求从文件中读取的字节数。由于它们是固定长度的记录，这应该适用于您的场景。

只要您不调用 ReadAllText() 而是使用采用显式字节数组的 Stream.Read() 方法，内存就不会成为问题。底层 Stream 类将注意不要将整个文件放入内存（当然，除非你要求它:)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T15:58:04.160

您没有具体列出您需要克服的问题。一个文件可以是 100GB，您可以毫无问题地处理它。

如果您必须将文件*作为一个整体*进行处理，那么这将需要一些创造性的编码，但如果您可以一次只处理文件的各个部分，那么移动到文件中您需要的位置相对容易开始，分块处理需要处理的数据，然后关闭文件。

这里的更多信息肯定会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:02:57.613

您目前遇到的主要问题是什么？要记住的重要一点是从流的角度来考虑 - 即尽可能在内存中保持最少的数据量。LINQ 在处理序列方面表现出色（尽管您需要避免一些缓冲操作，例如 OrderBy）。

例如，[这是](https://stackoverflow.com/questions/417878/getting-the-best-record-from-a-file#417932)一种有效处理大文件中的简单记录的方法（注意迭代器块）。

要对来自文件的大数据执行多个聚合/分析，请考虑在[MiscUtil中](http://www.yoda.arachsys.com/csharp/miscutil/)[推送 LINQ](http://msmvps.com/blogs/jon_skeet/archive/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation.aspx)。

您能否为您正在考虑的问题添加更多背景信息？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T16:38:04.437

扩展 JaredPar 的答案。

如果文件是二进制文件（即存储为 4 个字节的整数、固定长度的字符串等），您可以使用 BinaryReader 类。比提取 n 个字节然后尝试询问它更容易。

另请注意，System.IO.Stream 上的读取方法是非阻塞操作。如果您要求 100 个字节，它可能会返回少于该字节数，但仍未到达文件末尾。

BinaryReader.ReadBytes 方法将阻塞，直到它读取请求的字节数或文件结束 - 以先到者为准。

很好的合作小伙子:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-02T09:59:51.267

嘿伙计们，我意识到这篇文章已经有一段时间没有被触及了，但我只是想发布一个可以解决您的问题的网站。

[http://thedeveloperpage.wordpress.com/c-articles/using-file-streams-to-write-any-size-file-introduction/](http://thedeveloperpage.wordpress.com/c-articles/using-file-streams-to-write-any-size-file-introduction/)

希望能帮助到你！

-CJ

# delphi - 是否可以在每次调用不同单元中的函数时添加单元名称？

> ID：447302
> 
> 赞同：3
> 
> 时间：2009-01-15T15:54:25.510
> 
> 标签：delphi

我经常遇到的问题之一是我将在我的 uses 子句中包含“ **Windows** ”，然后我将在稍后为某些特定调用添加“ **JwaWinBase ”。**

但是，“Windows”单元中的许多功能与 JwaWinBase 中的相同，并且我开始在我的主单元中到处出现错误，直到我通过预先挂起正确的单元名称来修复所有调用，例如这：

**老的：**

*   CreateProcessAsUser(...)

**新的：**

*   Windows.CreateProcessAsUser(...)
*   JwaWinBase.CreateProcessAsUser(...)

我想知道的是，是否有办法让单位名称自动添加到对另一个单位中的函数的每次调用之前？这样，在我将 JwaWinBase 添加到我的 uses 子句之前，我可以将“Windows”单元名称预先添加到任何函数调用中。然后添加 JwaWinBase 不会给我任何错误。

我目前正在使用 Delphi 2007。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-15T16:05:48.153

没有。

但是，函数调用的处理顺序与它们在使用子句中的相反顺序，所以如果你有这个：

```
uses
  Windows, JwaWinBase; 
```

...默认情况下它将调用 Jwa 函数。但是，如果您反转它们：

```
uses
  JwaWinBase, Windows; 
```

...它应该默认调用 Windows 函数，您可以根据需要为 Jwa 函数添​​加前缀。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T16:10:12.357

如果您真的需要基于每个例程的解决方案，您可以尝试内联转发器：

```
procedure Blah; inline;
begin
  Windows.Blah;
end;

procedure Blubb; inline;
begin
  JwaWinBase.Blubb;
end;

// later:
procedure UseThem;
begin
  Blah; // calls Windows.Blah
  Blubb; // calls JwaWinBase.Blubb
end; 
```

在实施部分的开头（完全未经测试:-)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T16:04:12.680

也许只需在uses子句中切换两个单元的顺序就足够了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T17:40:46.840

如果您使用像 CodeRush（D7 和更早版本）或 Castalia 之类的编辑器，甚至是 D2009 的模板功能，您可以创建模板，在您输入它们时扩展为您想要的内容。然后你可以在uses部分保持Windows、jwaWinBase的顺序。您可以将 jcpau 设置为扩展为 jwaWinBase.CreateProcessAsUser，而 cpau 扩展为 CreateProcessAsUser 或 Windows.CreateProcessAsUser，具体取决于您的偏好。您只需要浏览 jwaWinBase 中的各种功能并制作模板以确保它们的安全。

否则，我认为它是逐案搜索和替换。

# flash - 谷歌是反Flash的吗？

> ID：447322
> 
> 赞同：5
> 
> 时间：2009-01-15T15:58:52.207
> 
> 标签：flash, actionscript, seo

**除了将文本直接写入 Flash IDE**以静态导出到 SWF 电影之外，Google 似乎不喜欢任何其他方式的 Flash 内容。

这意味着**任何由 ActionScript 绘制**到 TextField 中的文本都不会被编入索引？

从他们的[网站管理员指南](http://www.google.com/support/webmasters/bin/answer.py?answer=35769&hl=en)开始，他们建议：

*   “[避免隐藏文本](http://www.google.com/support/webmasters/bin/answer.py?answer=66353)” - 防止 SEO 的隐藏无脚本 HTML 文本
*   “[不要使用伪装或偷偷摸摸的重定向](http://www.google.com/support/webmasters/bin/answer.py?answer=66355)” - 防止 HTML 页面重定向到 Flash
*   “[避免仅为搜索引擎创建门口页面](http://www.google.com/support/webmasters/bin/answer.py?answer=66355)” - 防止所有页面通过 JavaScript 自动重定向到支持深度链接的 Flash 网站上的特定页面的 HTML 替代网站

那么 Flash 是否**可以用作网站框架**呢？

如果您发现任何**允许我们**在 Google 网站管理员指南中执行 SEO 最佳实践的内容，例如 Flash 网站上的隐藏文本和重定向，请发布。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-15T16:21:17.467

谷歌不是反闪存，闪存是反谷歌;-)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-15T21:04:49.517

> 那么 Flash 是否可以用作网站框架呢？

不，搜索引擎只是问题之一。（甚至可能是您遇到的最少的问题）。

基于 Flash 的网站的其他问题是用户不能

*   为相关页面添加书签，因为不存在页面的概念。您有一个 url，其中包含您的 flash 应用程序。
*   使用外部工具解析页面并提取相关信息（例如微格式，但搜索引擎是另一个示例）
*   浏览页面。在网站中，我希望能够在同一窗口、新选项卡或新窗口中打开链接。在网站中，我希望能够以对我有意义的顺序查看内容。我希望能够在我的浏览器中单击后退或前进。Flash 使这成为不可能，因为一切都在一个大的黑盒应用程序中粘合在一起。

请注意，这仅适用于您尝试将 Flash 用于*所有内容*的情况。Flash 当然可以合法地用于提供*内容*（youtube 是这里明显的例子）。但是，如果您想创建一个网站，那么实际的网站、结构、允许人们浏览您的网站的基础设施永远不会是闪存。如果你想创建一个网络应用程序，那就不同了，Flash 可能会工作。但是，您将失去网站所具有的优势。

Flash 根本不是为创建网站而设计的，幸运的是*大多数*Web 开发人员都明白这一点。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-15T16:45:43.330

Google 不会索引需要运行代码的内容，javascript 和 Flash 也是如此。

整个“闪存不可索引，这意味着它是邪恶的”是一种相当单一的方法。看到不同类型的内容，比如 youtube 视频或图像，它们本身不能被索引，但仍然设法避免成为“邪恶”。

如果您的网站依赖于在 Google 中被编入索引（并非所有网站都这样做），那么您就无法让网站全部闪现。你不能因为人们无法决定什么时候适合使用而责怪技术。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-15T16:13:41.867

它们不是反闪存，它只是帮助您的网站正确编入索引的指导方针。最近他们宣布他们的机器人[可以解析 swf 文件和索引 flash 内容](http://googlewebmastercentral.blogspot.com/2008/06/improved-flash-indexing.html)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-15T21:08:19.680

Adobe 正在与 Google 密切合作，开发一种搜索友好的 Flash 播放器。更多信息请点击这里：

[http://samhassan.co.uk/blog/2008/12/15/how-the-flash-search-player-works/](http://samhassan.co.uk/blog/2008/12/15/how-the-flash-search-player-works/)

和这里：

[http://www.adobe.com/devnet/flashplayer/articles/swf_searchability.html](http://www.adobe.com/devnet/flashplayer/articles/swf_searchability.html)

玩家团队的工程师 Jim Corbett 在今年的 MAX 上就该项目发表了演讲，我有幸参加（但您也可以参加，通过互联网的魔力，通过上面的 Adob​​e TV 链接)，其中他谈到了 Adob​​e 和 Google 正在做的一些事情，以帮助 Flash 获得牵引力，以及 Google 获得有用性。他们正在做的一件事是合作开发一个真正执行代码的“搜索播放器”，本质上是通过 SWF 导航并将信息传回 Google，以便更全面地索引 Flash 内容。漂亮的东西。

当然，Flash 开发人员最终将有责任学习和采用对搜索播放器更友好的做法（例如，深度链接等），但这是意料之中的——我们现在使用基于文本的用户界面。但要回答这个问题，不，Google 绝对不是反 Flash。相反，Google 似乎更喜欢 Flash（他们自己在所有地方都使用它，如前所述），并将其视为一个 UI 交付平台，随着时间的推移只会变得更加突出。

我碰巧同意，但后来我有点偏见。;)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-15T16:12:12.587

在网页“设计师”学会正确使用 Flash 之前，我会认为[Flash 100% 不好](http://www.useit.com/alertbox/20001029.html)（99% 以上）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-15T16:19:31.713

看一眼

[http://finance.google.com/](http://finance.google.com/)

单击该页面上列出的任何股票。然后你会看到他们主要的漂亮工具（股票图表）是一个 Flash 应用程序。

这是一个“知道什么工具适合它的地方”的案例。所有 Flash 网站 - 可能不是有史以来最伟大的想法。根据功能要求集成它——这就是他们基本上所说的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-15T16:25:33.637

我不会说谷歌是反闪存的。

非基于文本的系统很难索引。谷歌索引 Office 文档、PDF、图像、图像中的文本、Flash 文件中的一些文本……它们正在改进，但这些都是难题。

您要求的是 Google 运行 flash 文件并在运行时从中提取文本。这会变得非常棘手。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-02-25T02:18:45.493

我从这个问题中得到了一种独特的 Flash 抨击巨魔的氛围，但我会投入 2 美分：

> 那么 Flash 是否可以用作网站框架呢？

Flash 只是一个插件，所以这个问题可以重新定义为“[一个可以访问 JavaScript 的运行时对象] 是否可以用作网站框架？”

答案是肯定的。了解插件及其与浏览器的关系后，非 Flash 站点的大多数约定都可以在 Flash 中复制。如果您阅读链接到的页面，Google 实际上会详细说明如何解决您的大部分问题。

商业应用程序已经回答了 Flash 是否可以很好地与 SEO 配合使用的问题。我知道是因为我做了一些。也就是说，使插件模仿 HTML 页面行为需要专业知识和努力。

Flash 插件目前的主要失败是在移动浏览器中，但 Adob​​e 似乎非常有动力让它发挥作用。

仅仅因为 Flash 网站执行不力并不意味着该技术无法支持某些用例。也就是说，Flash 只是一个工具。如果它对网站有意义，那么就使用它。如果没有，那就不要。

-编辑-

对于 SEO，它非常简单：使用**noscript**标签加载包含反映 Flash 内容的 HTML 内容的页面。在任何规模合适的项目中，部署过程（或运行时脚本）都会自动执行此任务。假设内容对搜索引擎来说足够重要，它足够重要，可以通过 CMS 移动并动态读取到 Flash 和页面中。

For deep linking, you would use ExternalInterface in ActionScript to communicate with the browser JavaScript and read/write content hashes to the URL. This is SOP for any kind of complex Flash or Flex application. Adobe includes an implementation in the Flex SDK.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-15T16:14:59.850

我对 Flash 的看法在我对这个问题的回答中得到了最好的描述： [Flash for business web applications - 为什么不呢？](https://stackoverflow.com/questions/377285/flash-for-business-web-applications-why-not#377634)

但谷歌似乎并不完全反对它：http: [//googleblog.blogspot.com/2008/06/google-learns-to-crawl-flash.html](http://googleblog.blogspot.com/2008/06/google-learns-to-crawl-flash.html)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-15T16:24:33.297

解码闪存程序以提取文本并不总是那么容易。

漂亮的 javascript 填充内容也是如此。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-15T16:16:32.547

他们的网络聊天客户端是 flash（至少在 iGoogle 上），我知道他们在其他一些地方也使用它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-24T23:50:59.150

我同意这些帖子的作者。Flash 看起来很棒，但不是很实用。我是一个 wordpress 设计师，必须将其合并。我什至在我自己的网站上也有一点，但是用它来构建一个完整的网站是很重要的。尝试将其保留在标题或投资组合中。好帖子。

# asp.net - 如何在 Visual Studio 2008 中只运行一个 ASP.NET 开发服务器？

> ID：447323
> 
> 赞同：3
> 
> 时间：2009-01-15T15:59:05.530
> 
> 标签：asp.net, visual-studio, debugging

我在一个解决方案中有多个 Web 应用程序项目。当我开始调试其中一个 Web 应用程序时，我注意到 ASP.NET 开发服务器为我的解决方案中的所有 Web 应用程序启动。如何确定只启动一个 ASP.NET 开发服务器？这甚至可能吗？

我不想让我的系统托盘充满我所有 Web 应用程序的图标。

谢谢！

* * *

**重复**：[为什么 VS2008 在进入调试模式时为每个网站/应用程序生成一个 Cassini？](https://stackoverflow.com/questions/127093/why-do-vs2008-spawn-one-cassini-for-each-web-site-application-when-going-into-deb)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T16:11:39.937

这可能对你有用，我有一个类似的问题，因为我的解决方案中有几个 Web 远程处理项目。我所做的是在 IIS 中为每个项目设置虚拟目录，然后右键单击每个项目并选择属性。然后，在 Web 选项卡上，我将服务器设置为在调试到 IIS 时使用。这会导致 Visual Studio 使用单个 IIS 实例，而不是为每个项目打开十几个单独的 Web 开发服务器。调试时，附加到 w3wp.exe 进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T16:05:06.720

据我所知，您无法阻止这种行为并且是设计使然。

这是因为 VS 将其调试器附加到目标进程的方式。即你不能有两个 VS 实例附加到同一个进程。因此，cassini Web 服务器的多个实例，每个 VS 会话一个。

# sql-server-2005 - 如何修复错误 DTS_E_CANNOTACQUIRECONNECTIONFROMCONNECTIONMANAGER？

> ID：447324
> 
> 赞同：1
> 
> 时间：2009-01-15T15:59:20.927
> 
> 标签：sql-server-2005, dts, ssis

我在安排 DTS 包时收到以下错误：

`Description: SSIS Error Code DTS_E_CANNOTACQUIRECONNECTIONFROMCONNECTIONMANAGER`

我不确定如何让我的 DTS 包执行。当我手动执行它们时它们运行良好

我正在运行 SQL Server 2005。DTS 包是使用导入/导出向导创建的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T20:32:57.827

我将身份验证从 SQL Server 更改为 Windows Auth，它成功了。不确定技术原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-23T08:06:00.937

[https://imgalib.wordpress.com/2013/01/24/how-to-solve-ssis-error-code-0xc020801c0xc004700c0xc0047017/](https://imgalib.wordpress.com/2013/01/24/how-to-solve-ssis-error-code-0xc020801c0xc004700c0xc0047017/)

这是excel处理的问题。需要更改默认运行时。从左侧面板导航到“调试”选项，然后从右侧面板将 Run64BitRuntime 值更改为 false。在项目属性中。

查看上面的链接了解详细步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:05:18.887

计划包时，它通常在 SQL Server 代理的上下文和权限下运行。

软件包是否与无人参与的 sqlserver 代理帐户不可用的驱动器号或其他机制建立连接？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T16:05:22.273

我认为问题在于 DTS 的连接管理器中的任何连接中的登录名/密码组合，或者访问数据库所在服务器的一些问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T16:06:08.573

如果您的服务器名称超过 31 个字符（包括主机名），则不会触发。

# perl - 在使用 Template Toolkit 的 Catalyst 项目中显示 DBIx::Class ResultSet 的正确方法是什么？

> ID：447325
> 
> 赞同：10
> 
> 时间：2009-01-15T15:59:27.713
> 
> 标签：perl, catalyst, template-toolkit, dbix-class

给定一个 DBIx::Class 结果集，例如：

```
my $rs = $c->model("DB::Card")->search({family_name => "Smith"}); 
```

我读过的教程使用存储来传递行的arrayref：

```
$c->stash->{cards} = [$rs->all]; 
```

这会导致此时执行查询，并将结果对象填充到存储中，因此它们可以在 TemplateToolkit 中用作：

```
[% FOREACH card IN cards %] 
    [% card.given_name %] [% card.family_name %] 
[%END%] 
```

是否有适当的方法让 TT 在从数据库中获取行时对其进行迭代？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-15T16:17:53.043

当然。您可以将结果集直接传递给 TT 并在模板中对其进行迭代。

```
$c->stash->{cards} = $rs; 
```

...进而：

```
[% WHILE (card = cards.next) %]
    [% card.given_name %] [% card.family_name %]
[% END %] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-23T16:35:37.707

或者，甚至更好：

```
$c->stash(cards => $rs); 
```

...在 TT 模板中：

```
[% FOREACH card = cards %]
    [% card.given_name %] [% card.family_name %]
[% END %] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-12T22:23:50.120

我愿意：

```
@{$c->stash->{cards}} = $rs->all; 
```

在模板中：

```
[% FOREACH card IN cards %]
    [% card.given_name %] [% card.family_name %]
[% END %] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-30T16:27:02.133

我在做和作者完全一样的事情。

在尝试创建更严格的 MVC 方法时，我现在正在控制器中处理 DBIC 对象并传递一个非常简单的存储以供模板显示。（主要好处是代码可以被其他脚本重用，而不仅仅是 Web 界面。）

我很好奇是否有人知道这是否更有效，处理或内存方面。我认为第一种方法可以减少处理时间，但可以延长内存。我猜我的新方法暂时需要更多的处理和更多的内存，但是潜在的大结果集对象不会活得那么久。

# flash - 嵌入 Flash Wimpy 播放器，使其在 Firefox 中运行

> ID：447329
> 
> 赞同：2
> 
> 时间：2009-01-15T16:00:06.853
> 
> 标签：flash, firefox, embed, wimpy

有人可以帮我让 Wimpy 播放器在 Firefox 中工作吗？我遵循了[Wimpy 文档页面](http://wimpyplayer.com/docs/mp3/insert.html.html)中的指南，但仍然一无所获。

对于测试，我使用相同的 HTML 代码嵌入不同的 swf 文件，它运行良好。会不会是 SWF 文件本身损坏了？那为什么它在 IE 上运行良好？

这是一个带有两个 Flash 对象[的测试 HTML 代码。](http://www.blastbeat.tv/test.html)左边一个是 Wimpy，另一个只是一个例子。目前只有正确的一个出现。

这是我用来嵌入它的代码：

```
<object width="185" height="292" id="wimpy" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,47,0">
<param name="allowscriptaccess" value="always"></param>
<param name="allownetworking" value="all"></param>
<param name="movie" value="http://www.blastbeat.tv/upload/mp3s/wimpy.swf"></param>
<param name="loop" value="false"></param>
<param name="menu" value="false"></param>
<param name="quality" value="high"></param>
<param name="scale" value="noscale"></param>
<param name="align" value="center"></param>
<param name="salign" value="lt"></param>
<param name="bgcolor" value="ffffff"></param>
<param name="wmode" value="transparent"></param>
<param name="flashvars" value="wimpyApp=http://www.blastbeat.tv/upload/mp3s/wimpy.sql.ed.php&wimpySkin=http://www.blastbeat.tv/upload/mp3s/skin_blackpod8.xml&useMysql=yes&queryValue=21&queryWhere=user_id&startPlayingOnload=no&randomOnLoad=yes&loopPlaylist=all&popUpHelp=no&trackPlays=http://www.blastbeat.tv/upload/mp3s/trackscript.php&scrollInfoDisplay=yes"></param>
<embed width="185" height="292" scale="noscale" src="http://www.blastbeat.tv/upload/mp3s/wimpy.swf"
    allowscriptaccess="always"
    allownetworking="all"
    loop="false"
    menu="false"
    quality="high"
    scale="noscale"
    align="center"
    salign="lt"
    bgcolor="ffffff"
    wmode="transparent"
    flashvars="wimpyApp=http://www.blastbeat.tv/upload/mp3s/wimpy.sql.ed.php&wimpySkin=http://www.blastbeat.tv/upload/mp3s/skin_blackpod8.xml&useMysql=yes&queryValue=21&queryWhere=user_id&startPlayingOnload=no&randomOnLoad=yes&loopPlaylist=all&popUpHelp=no&trackPlays=http://www.blastbeat.tv/upload/mp3s/trackscript.php&scrollInfoDisplay=yes"
    name="wimpy"
    type="application/x-shockwave-flash"
></embed> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T16:53:14.983

我非常推荐使用[swfobject](http://code.google.com/p/swfobject/)，它负责检测 Flash 播放器，为该浏览器嵌入正确的代码，并为您提供一种提供后备内容的好方法。此外，它会在您的代码中看起来更干净！

像这样：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>SWFObject dynamic embed - step 3</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <script type="text/javascript" src="swfobject.js"></script>

    <script type="text/javascript">
    swfobject.embedSWF("myContent.swf", "myContent", "300", "120", "9.0.0");
    </script>

  </head>
  <body>
    <div id="myContent">
      <p>Alternative content</p>
    </div>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T17:01:15.627

事实证明，我使用的 Wimpy 播放器版本有点过时，无法与 Flash 10 一起使用。这是来自他们的支持页面：

> 只有最新版本的 Wimpy 产品才能与 Flash 插件版本 10 一起使用。
> 
> 旧版本的 Wimpy 将不再适用于已将 Flash 插件升级到版本 10 的用户。这是因为插件对 Actionscript 代码在播放器中的解释方式更加严格。

从次要版本号升级是免费的。升级后，Wimpy 又恢复了运行。

# mfc-feature-pack - 如何使用 CMFCRebar 产生可接受的外观和感觉？

> ID：447339
> 
> 赞同：4
> 
> 时间：2009-01-15T16:03:01.047
> 
> 标签：mfc-feature-pack

我正在尝试使用 MFC Feature Pack 中的一些类来改进我的 MFC 应用程序的外观。

在我的应用程序中，我使用一个 CReBar 对象来停靠三个不同的工具栏。我已经更新了这个对象的类以使用 CMFCReBar，但是在使用某些视觉样式时它看起来并不好。

Feature Pack 中似乎存在问题，因为即使使用 package.json 部署的 RebarTest 示例也会发生这种情况。

这是示例应用程序的屏幕截图，只是将视觉样式更改为 Office 2007（使用 app.menu 而不是代码）：

[RebarTest 示例应用程序的屏幕截图 http://img105.imageshack.us/img105/1057/rebartestep5.png](http://img105.imageshack.us/img105/1057/rebartestep5.png)

有人成功使用过 CMFCReBar 吗？有没有其他方法可以在不使用它的情况下达到同样的效果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T16:24:46.053

基本上你不再需要使用钢筋控件了。通过简单地创建您的 CMFCToolbars 和 CMFCMenuBar，在它们上调用 EnableDocking，然后在每个上使用 DockPane，它们将停靠并采用 Office 2007（或您使用的任何其他主题）的外观和感觉。查看 WordPad Feature Pack 示例，或使用 AppWizard 创建一个新项目（使用所有默认设置即可）查看示例。

好的，从您的评论中可以看出：如果您想将工具栏停靠在彼此旁边，您可以在 DockPane 之后使用 DockPaneLeftOf。根据我的经验，如果您不先 DockPane 两个工具栏，它往往会在工具栏放置时出现奇怪的行为。

我还没有找到一个很好的简单解决方案来阻止工具栏被拖动，同时停靠在彼此旁边，您可以删除 CBRS_GRIPPER 样式，但这并不能阻止工具栏被拖动。

您也可以不调用菜单栏或工具栏上的 EnableDocking。这将使他们固定的地方。但是，DockPaneLeftOf 在这种情况下似乎不起作用，因此您会丢失彼此相邻的停靠工具栏。

因此，如果您想停止停靠，或者将工具栏停靠在彼此旁边，现在似乎是其中之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T00:20:42.763

Paul DiLascia 写了一个[类](http://msdn.microsoft.com/en-us/magazine/cc163931.aspx)来锁定 CToolBar，我用它来创建这个类，它将在 CMFCToolbar 上工作。你可以复制它来为 CMFCMenuBar 做同样的事情——只需将 MFCToolBar 更改为 MFCMenuBar 就可以了。

[![替代文字](https://i.stack.imgur.com/f8C6A.jpg)](https://i.stack.imgur.com/f8C6A.jpg)

```
class CLockedMFCToolBar : public CMFCToolBar
{
public:
    CLockedMFCToolBar() : CMFCToolBar() {}

protected:
    LRESULT CLockedMFCToolBar::WindowProc(UINT msg, WPARAM wp, LPARAM lp)
    {
        if ((msg==WM_LBUTTONDOWN || msg==WM_LBUTTONDBLCLK))
        {
            // Got click or double-click and toolbar is locked: if mouse in "dead
            // zone" then ignore the message--don't pass to control bar
            CPoint pt(lp);
            if (OnToolHitTest(pt, NULL) == -1)
                return 0; // return without handling: bypass control bar dragging!
        }
        // pass unhandled messages subclassed window--this is important!*/
        return CMFCToolBar::WindowProc(msg, wp, lp);
    }
};

//////////////////////////////
// in CMainFrame declaration
protected:
    CLockedMFCMenuBar m_wndMenuBar;
    CLockedMFCToolBar m_wndToolBar1;
    CLockedMFCToolBar m_wndToolBar2;

////////////////////////////
// in CMainFrame::OnCreate
if (!m_wndToolBar1.CreateEx(this, TBSTYLE_FLAT, WS_CHILD | WS_VISIBLE | CBRS_TOP | CBRS_GRIPPER | CBRS_TOOLTIPS | CBRS_FLYBY | CBRS_SIZE_DYNAMIC) ||
    !m_wndToolBar1.LoadToolBar(theApp.m_bHiColorIcons ? IDR_MAINFRAME_256 : IDR_MAINFRAME))
{
    TRACE0("Failed to create toolbar\n");
    return -1;      // fail to create
}

if (!m_wndToolBar2.CreateEx(this, TBSTYLE_FLAT, WS_CHILD | WS_VISIBLE | CBRS_TOP | CBRS_GRIPPER | CBRS_TOOLTIPS | CBRS_FLYBY | CBRS_SIZE_DYNAMIC) ||
    !m_wndToolBar2.LoadToolBar(theApp.m_bHiColorIcons ? IDR_MAINFRAME_256 : IDR_MAINFRAME))
{
    TRACE0("Failed to create toolbar\n");
    return -1;      // fail to create
}

EnableDocking(CBRS_ALIGN_ANY);
m_wndMenuBar.EnableDocking(CBRS_ALIGN_ANY);
m_wndToolBar1.EnableDocking(CBRS_ALIGN_ANY);
m_wndToolBar2.EnableDocking(CBRS_ALIGN_ANY);
DockPane(&m_wndMenuBar);
DockPane(&m_wndToolBar2);
DockPane(&m_wndToolBar1);
DockPaneLeftOf(&m_wndToolBar1, &m_wndToolBar2);

m_wndMenuBar.SetPaneStyle(m_wndMenuBar.GetPaneStyle() &
            ~(CBRS_GRIPPER | CBRS_BORDER_TOP | CBRS_BORDER_BOTTOM | CBRS_BORDER_LEFT | CBRS_BORDER_RIGHT));
m_wndToolBar1.SetPaneStyle(m_wndToolBar1.GetPaneStyle() &
            ~(CBRS_GRIPPER | CBRS_BORDER_TOP | CBRS_BORDER_BOTTOM | CBRS_BORDER_LEFT | CBRS_BORDER_RIGHT));
m_wndToolBar2.SetPaneStyle(m_wndToolBar2.GetPaneStyle() &
            ~(CBRS_GRIPPER | CBRS_BORDER_TOP | CBRS_BORDER_BOTTOM | CBRS_BORDER_LEFT | CBRS_BORDER_RIGHT)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:08:41.737

在使用 Office 2007 样式时，我也注意到了一些视觉问题——它似乎有点错误。你可以用其他的一个来代替吗？XP Luna 似乎相当稳定...

# winforms - 我可以更改 DateTimePicker 控件的输入行为吗？

> ID：447340
> 
> 赞同：1
> 
> 时间：2009-01-15T16:03:28.953
> 
> 标签：winforms, c#-3.0, controls

输入日期时 DateTimePicker 的默认输入行为如下：

YYYY(右箭头)MM(右箭头)DD

用户想像这样输入日期：

YYYYMMDD

是否有任何简单的方法来修改 DateTimePicker 的输入行为，使其行为与用户想要的一样？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T19:05:47.503

扩展 PoweRoy 的答案。使用文本框和日期时间选择器。使 datetimepicker 变小（与下拉箭头一样大）并将其放置在文本框旁边（甚至内部）。然后你钩住 datetimepicker 的下拉和特写事件，以从编辑框获取值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T16:21:58.573

我不知道您如何使用 DateTimePicker 但使用简单的编辑框怎么样？（并在输入日期时验证日期）

DateTimePicker 主要用于选择日期而不输入任何数字。

# visual-studio-2008 - 让 VS 2008 与 eVC 4.0 项目配合得很好

> ID：447343
> 
> 赞同：1
> 
> 时间：2009-01-15T16:04:36.363
> 
> 标签：visual-studio-2008, windows-mobile, porting, evc4

我想为一个开源的 Windows Mobile 项目做出贡献，但它是在 eVC 4.0 中开发的，这在 Vista 上完全不起作用（请随时纠正我！），我宁愿避免不得不双重启动或远程进入我唯一剩下的 XP 盒子。我在我的主要开发机器上安装了 VS 2008，并获得了所有的 SDK 等。我需要做 WM 工作。但！一旦我将所有源代码放在一起并开始尝试构建它，我必须进行大量更改以支持已弃用的方法和一些已移动的标头。

理想情况下，我希望能够“就好像”我正在运行 eVC 一样处理该项目。是否有某种“怪癖模式”可以让我在 VS 2008 中模拟 eVC 行为？如果没有，是否有将应用程序从 eVC 移植到 VS 的指南？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T16:12:32.167

不，没有允许它的模式。Studio '08 使用与 eVC 不同的（实际上要好得多）编译器，因此 eVC 让 Studio 无法使用的某些东西。一般来说，来自 Studio 的代码可以在 eVC 下运行。

现在，如果您使用的是 MFC，那就完全不同了。eVC 下的 MFC 和 Studio 下的 MFC 有很大不同，并且在某些情况下（如 CString）只是表现不同（eVC 中的类，Studio 中的模板），特别是如果对象一开始就没有“正确”使用。撤消这可能是一个巨大的混乱。

不推荐使用的方法可以包装在抽象方法中，以便在 Studio 下代码以一种方式路由，而在 eVC 下它以另一种方式路由。在不知道具体是什么方法的情况下，您很难给出更详细的建议。

移动的文件应该不是问题。将包含目录添加到项目中。您当然不应该在代码文件本身中有指向标头的路径。

编辑：最后一点，Studio 通常不擅长导入 eVC 项目，因此您也很可能在迁移过程中丢失了预编译器指令和类似的东西。缺少#defines 肯定会使移植更具挑战性，因此请检查在 eVC 中定义的所有内容是否仍在 Studio 中定义。还要注意任何子系统定义。Studio 也喜欢忘记导入它。

# language-agnostic - 什么是范围蠕变？

> ID：447344
> 
> 赞同：10
> 
> 时间：2009-01-15T16:04:44.817
> 
> 标签：language-agnostic, project-management, scope-creep

这将是所有菜鸟问题中的菜鸟，但究竟什么是范围蔓延，它意味着什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-15T16:06:11.757

范围蔓延“是指项目范围的不受控制的变化。当项目范围没有正确定义、记录或控制时，就会发生这种现象。通常认为这是一种应避免的负面事件。”

[来源](http://en.wikipedia.org/wiki/Scope_creep)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-15T16:08:26.777

你从一只老鼠开始，到一头大象结束。

换句话说，需求每天都在变化，你应该交付的东西看起来不像项目开始时应该交付的东西

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T16:23:33.423

[维基百科](http://en.wikipedia.org/wiki/Scope_creep)比我能更完整地表达它。

> 项目管理中的范围蔓延（也称为需求蔓延或厨房水槽综合症）是指在项目开始后的任何时候，项目范围的变化、持续或不受控制的增长。当项目的范围没有正确定义、记录或控制时，就会发生这种情况。它通常被认为是有害的。它与特征蠕变相关但又不同。
> 
> 范围蔓延可能是以下原因的结果：
> 
> *   变更控制不佳
> *   缺乏对实现项目目标所需内容的适当初步识别
> *   弱项目经理或执行发起人
> *   各方沟通不畅
> *   缺乏初始产品的多功能性

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-15T21:27:21.327

范围蔓延有两种定义。

*   消极的。范围以不受控制的方式改变，增加了成本和风险。

*   积极的。范围以不受控制的方式改变，因为我们的幻想项目计划是错误的，我们开始学习我们没想到的东西。

大多数人似乎喜欢第一个。

然而，第二个更准确。少数认识到范围蔓延 -== 学习的经理能够明智地管理它并完成工作。

其他管理人员将不受控制的学习视为一种威胁。该项目不会在幻想时间表或预算中创建预期的可交付成果。这意味着要么需要缩小范围，要么需要扩大预算。

请注意，大多数敏捷方法似乎不太关心范围或范围蔓延。随着对下一个版本的狭隘关注，大局变得不那么具有威胁性和可怕性。

学习——在敏捷环境中——也会导致范围蔓延，但这是一件好事。永远不会有用的东西被推迟。当我们开始时似乎并不重要的东西得到了加速。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T16:05:50.323

当一个项目不断地变得比最初计划的更大、更复杂，因此永远落后于计划并超出预算。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T16:10:26.927

当你开始你的项目时，你设置了某些参数。这些参数是您的范围。您应该考虑您的项目应该做什么，花费多少，以及完成需要多少时间。当更多的功能、时间、金钱......蔓延到项目中时，这可以称为“范围蔓延”，

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T16:31:45.543

范围蔓延是指需求不断被修改或添加到当前产品版本中。例如，您向客户/用户展示演示，他们请求新的报告/按钮/字段。当开发人员想要添加新的“酷”功能等而不需要它们时，也会发生这种情况。最好通过管理项目发布周期来防止这种情况发生。人们建议功能是一件好事，但每个参与的人都需要了解对项目和预算的影响。考虑将新功能请求添加到列表中并定期开会以决定将哪些新功能添加到“下一个版本”中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-15T16:34:23.197

在我看来，在功能蔓延的情况下，需要有一个因素导致产品的衰落。例如，一个城市的发展是好的——城市扩张是坏的。

或者在 UI 设计的情况下..所有相关功能都卡在一个控制屏幕上 - 新功能不断添加到它们的存在使更多人感到困惑的程度，而不是发现这些功能有用。

为了符合功能蠕变的资格，他们应该通过在系统生命周期中造成不必要的复杂性或抛出不必要的扳手的测试。不符合此标准的原始计划外功能不应被视为功能蠕变。

Scope Creep 仅在产品范围级别与功能蔓延相同的角度被考虑......例如：

您的团队正在建造一个“空气吸盘”（tm），它从一个位置吸入空气并将其运送到两个街区外的工厂。空气吸盘的作用范围是它移动空气。

然后管理实现吸水装置也需要吸运水和沙子。空气吸盘从未设计用于运输液体或颗粒材料，因此将空气吸盘的范围扩大到必须对其进行重大重新设计以满足新的运输要求的程度。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-15T17:27:41.903

如果您有适当的变更控制，可能是摇钱树。

有一张著名的照片，一艘拖着小快艇的大型动力船。小快艇被称为“原始合同”，摩托艇被称为“变更请求”

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-15T17:38:03.537

功能、预算、时间表：选择任何 2 但不是全部 3

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-15T22:12:03.280

范围蔓延是对最初商定的规范/项目范围/定义的任何更改。这种变化可能是由于发现了先前的未知数、内部/外部市场变化、技术变化或计划 ole' 赞助商想要更多的东西。当没有适当的变更控制流程来审查和接受或拒绝变更时，它会对项目产生负面影响。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-15T22:34:00.070

范围蔓延如何影响产品进度？有没有办法让范围蔓延到您的开发过程之外？您的 PM 如何处理范围蔓延？从范围蔓延中脱颖而出的最佳功能是什么？等等等等

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-22T05:06:29.063

范围蔓延就像色情：当你看到它时你就会知道它。

# visual-studio-2008 - VS 2008 开放网站需要永远！

> ID：447346
> 
> 赞同：1
> 
> 时间：2009-01-15T16:04:56.017
> 
> 标签：visual-studio-2008

其他人得到这个或遭受这个？我正在使用 Vista 和 VS 2008，当我打开一个网站时，实际上需要 2~3 分钟才能显示对话框。一旦我真正选择了一个网站，这不是问题，但达到这一点会挂起 VS 真的很糟糕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T16:07:05.453

确保它存储在本地硬盘上。将解决方案存储在 UNC（网络路径）上会使 Visual Studio 进行一些奇怪的检查。我认为这已在 VS 2008 SP1 中修复，但我可能错了。如果没有，请尝试 SP1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T16:07:54.170

很抱歉我无法在 Vista 上提供解决方案，但是在遇到同样的事情后，我切换回 XP 并且问题消失了。您甚至可能想做我们其他一些技术人员所做的事情：继续使用 Vista，但在虚拟机中运行 XP。假设您有足够的 RAM，您会注意到对相当新的计算机的性能影响很小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:24:17.460

我想知道你是否遇到了类似的问题：

> [http://blogs.technet.com/markrussinovich/archive/2006/11/27/532465.aspx](http://blogs.technet.com/markrussinovich/archive/2006/11/27/532465.aspx)

可能值得将调试器附加到 VS 以查看它在做什么，这可能不是同一个问题，但您应该有所了解。

# c++ - 如何知道我们是在控制台还是窗口应用程序中？

> ID：447352
> 
> 赞同：7
> 
> 时间：2009-01-15T16:05:41.587
> 
> 标签：c++, windows, winapi, console

上下文：编程 ac/c++ win32-mfc 库

如何知道我们是在控制台还是窗口应用程序中？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-15T16:25:55.837

[您可以通过调用 win32 函数GetConsoleWindow](http://msdn.microsoft.com/en-us/library/ms683175(VS.85).aspx)来确定当前是否有控制台连接到进程。如果它返回 NULL，则没有控制台连接到该进程。但是，这不一定会告诉您是否在窗口应用程序中运行。例如，我可以有一个窗口应用程序，它在启动时使用[AllocConsole为调试输出分配一个控制台，在这种情况下，您将同时拥有两者。](http://msdn.microsoft.com/en-us/library/ms681944(VS.85).aspx)我可以看到您描述的另一个问题是应用程序可能没有窗口并且没有附加控制台（例如 Windows 服务）。

我也将不得不同意 litb 和 Martin 的观点。如果您的库需要知道这一点，那么它可能还不够解耦。例如，如果您使用它来确定将调试输出发送到何处，最好的方法是使用 cout 或 cerr 并让使用该库的应用程序处理将流重定向到它想要的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T16:20:54.207

我对此不确定（我自己没有尝试过），但您可以调用 GetStartupInfo 函数来完成一个 STARTUPINFO 结构。

也许控制台和 Windows 应用程序设置 dwFlags 成员的 STARTF_USESHOWWINDOW 标志不同，您可以这样区分它们。

正如您问题的评论中所提到的，当图书馆需要知道这些事情时，这通常不是一个好兆头 - 您可以保持它越解耦越好。

希望有帮助。

# c# - 为什么我不能将表单视图绑定到这个数据源？

> ID：447359
> 
> 赞同：0
> 
> 时间：2009-01-15T16:06:41.960
> 
> 标签：c#, asp.net, sql

我在这里有这段代码：

```
SqlCommand CodeStatus = new SqlCommand(SQL, DB);        
DB.Open();
Reader = CodeStatus.ExecuteReader();
FormView1.DataSource = Reader;
FormView1.DataBind();
DB.Close(); 
```

它与 gridview 一起工作，然后显示数据，但使用这个 formview 它不显示数据。为什么不？默认模式是只读的，应该只显示数据..对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T16:20:36.547

你的 FormView 有 ItemTemplate 吗？

[MSDN](http://msdn.microsoft.com/en-us/library/ms228089.aspx)似乎暗示虽然有可能，但您需要一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T16:17:36.443

我知道这并不能直接回答您的问题，但是您是否尝试过使用 DataTable？

```
using(SqlDataAdapter adapter = new SqlDataAdapter(sql,connection))
{
   DataTable table = new DataTable();
   adapter.Fill(table);
   FormView1.DataSource = table;
   FormView1.DataBind();   
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:41:21.403

MSDN 将 FormvView 定义为**“FormView 使用用户定义的模板显示来自数据源的单个记录的值”。**

所以你需要看几件事——

1.  1.测试你的读者有什么。它甚至有行。琐碎但常见的问题。
2.  至少在 itemtemplate 中为 formview 提供一个模板。因为如果您以编程方式绑定它，FormView 将不会推断列。
3.  尝试在标记中为单个模板项（例如 <%# Eval("ColName") %>）进行数据绑定。

# testing - 在测试之前，您倾向于编写多少代码？

> ID：447364
> 
> 赞同：1
> 
> 时间：2009-01-15T16:07:18.027
> 
> 标签：testing

多年来我已经注意到，我倾向于编写一个充满代码的屏幕，然后进行测试以确保它完成了它应该做的事情。

这种技术的一些好处是

> 语法错误是新代码的结果，因此您无需费力寻找原因。
> 
> 设置一个临时条件很便宜，它可以让您测试 if 语句的 else 子句，因此您可以确保在测试成本低时得到正确的错误消息等。

**你倾向于如何编码？
你这样做有什么好处？**

编辑：像我的大多数问题一样，我真的没有很好地设置上下文。我并不是在谈论单元测试级别的粒度。我指的是在实现时确保本地代码完全按照我的意图执行。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-15T16:10:12.093

我想说我总是在编写相应的代码以通过它之前编写一个单元测试，但我会撒谎。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T16:11:23.510

我倾向于编码，直到我有一些应该产生明确定义的可观察行为的东西。通常，这是一个公共 API 函数，有时是一个完整的类。这也鼓励我将问题分解为具有明确定义的可观察行为的小函数。我的大部分功能都小于全屏。如果一个函数太复杂而无法测试，那么从其他角度来看，它可能设计得很糟糕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T12:18:49.980

就个人而言，我发现我倾向于在实际编写测试之前编写明显的接口并拖入实用程序资源（无论是 C# 库、CSS 等）。

我认为在狂热和经验之间有一个平衡点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T16:20:41.853

这听起来可能很傻，但我通常会在每个“处理任务”之后测试我编写的代码。意思是，如果我打开一个文件，我会测试例程。如果我连接到数据库并提取一条记录，我会测试该例程。或者有时我会编写一个测试，只是练习一个类的所有方法，看看它们是否有效。

我不认为我使用硬性或快速规则，但大多数情况下，当我编写代码来执行任务时，我会测试以“验证”它是否完成了它应该做的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T16:20:57.920

和我必须的一样多。有时这意味着几百行，尤其是当我向现有框架添加一个大型系统时，如果没有它的某些部分，应用程序甚至无法运行。

我想我尽可能遵循测试的原则。显然，这并不意味着编写循环的一半，但是当我完成循环后，我会在继续之前尝试一下。自上次测试以来您更改的越少，就越容易找出导致错误情况的更改。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T16:24:36.180

我通常会按照您的描述进行操作，但是在测试之前我没有写完一整页。我发现如果我写一些代码*然后*写一个测试，我通常必须重构代码以使其更可测试。这似乎有点浪费，所以在编写单元测试之前我只写了几行代码。我发现我越来越接近严格遵守 TDD。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T16:34:30.623

正如您没有提到您在哪种语言环境中编码...

当我在 Smalltalk 中工作时，在我键入时在编辑器中检查语法，每当我接受一个方法时，这不是问题。（对于那些不了解 Smalltalk 的人：它不是基于文件的，而是面向对象的；这意味着您一次将一个方法对象添加到一个类对象中，系统会按原样编译每个对象“接受”在编辑器中）。

对于算法或不需要大框架/设置的小方法，我添加了一点注释来测试该方法并且可以通过单击执行。还有一个测试运行器可以提取所有这些并将它们作为单元测试运行。对于更大的东西，每隔几个方法就会更新一个 TestCase 类，并且不时单击测试运行器按钮，让我停下来闯红灯。

所以我想说，每 10 行左右就进行一次测试。我承认，这样做需要一个高度反应和增量的 IDE - 否则，它不能那么容易地完成，我会在测试之前恢复说大约一个字母大小的代码页。我不认为可编译性是“测试”，所以语法正确性不算在内。

编辑：为了您的娱乐，这里是 Collection 类的一个具体示例：
对于那些不知道 smalltalk 的人：
 引用的字符串是注释；
 +/- 是创建测量值的运算符；
 / 创建分数；
  {...} 是数组创建；
最后的测试用例可以在编辑器中直接执行（所谓的 doIt）。

```
sum
    "sum up all elements.
     This is implemented using a variant of the normal inject:into: pattern. 
     The reason for this is that it is not known whether we are dealing with number
     (i.e. if 0 is a good initial value for the sum). 
     Consider a collection of measurement or physical objects, 0 would be the unitless 
     value and would not be appropriate to add with the unit-ed objects."

    | sum sample |

    sample := self anElement.
    sum := self inject: sample into: [:accum :each | accum + each].
    ^ sum - sample.

    "
     TestCase should: [ { } sum ] raise:Error.
     TestCase should: [ ''  sum ] raise:Error.

     TestCase assert: ( { 1 } sum = 1 ).
     TestCase assert: ( { 1\. 2\. 3\. 4\. } sum = 10 ).
     TestCase assert: ( (1 to:10) sum = 55 ).
     TestCase assert: ( 'abc' asByteArray sum = 294 ).

     TestCase assert: ( { 10 +/- 2.
                          20 +/- 4.
                         100 +/- 10 } sum = (130 +/- 16) ).

     TestCase assert: ( { (1 / 9).
                          (1 / 7).
                        } sum = (16 / 63) ).
    " 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-15T16:38:04.517

我不使用 TDD，而是首先构建有效的测试存根，这成为实际的应用程序。

例如，在 WinForms 应用程序中，我首先构建按钮，然后对其进行测试。然后，当我构建类时，我会测试 UI 是否正在调用该类的方法。

然后，例如，如果我要将实际工作放入后台工作程序中，我会在其中没有任何内容的情况下构建它，并测试 Start/Progress/Complete 处理程序是否全部触发，并由创建 BGW 的类处理.

然后我开始将功能放入方法中，因此已经有了一个经过测试的测试工具。我必须为此构建一个单独的工具是非常罕见的，因为每个增量都很小，并且在添加下一个复杂级别之前进行了测试。

好处是我不必一次记住太多的复杂性，而且如果没有它所依赖的基础已经过很好的测试，我几乎不会添加任何东西。

我从来没有发现单元测试是任何类型的问题——我真正想要的是比这更高级别的自动化测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T16:11:40.373

取决于项目的大小/规模。如果它是一个简短的程序（编译和运行很简单），我会尽早测试它，并且经常在我添加任何新功能时进行测试。这让我可以快速发现大多数错误。

在一个大型项目（公司规模）中，如果可以的话，我会像这样孤立地测试我的作品。否则，请注意对这些日常构建的测试。

简而言之，尽可能多地进行测试，只要编译/运行时间不那么长，您就可以考虑参加办公室剑术！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-15T16:14:43.410

我倾向于测试程序的每个功能。不是每个功能，而是一系列功能，形成一个特征。这样的好处是我没有太多的开销来测试每个功能，而是一个接一个地测试它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-15T16:20:24.210

我现在从事的项目应该是先进行单元测试，然后是开发，而且大多数情况下是这样，但有时编写测试的人和实施的人并不总是在同一页面上。

所以我喜欢有一个单元测试来检查所需方法的主要功能，然后让实现代码的人编写几个单元测试来检查代码的各个边缘。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-15T17:12:53.387

我年纪越大，在运行/测试之前编写的代码就越少。

在某种程度上，这是技术进步的结果：我开始在 COBOL 编码表上编写代码，以便每周两次在打卡女孩进来时将其转换为打孔卡。通常我什至不会尝试编译一个新程序，直到它基本上是完整的并且经过桌面检查，通常是几千行和几个星期。

这些天来，当我在玩游戏时，我不会在测试之前编写任何代码，而是在编码之前编写测试。不过，我很虚弱，并不总是确定如何编写测试，所以有时我告诉自己我只是这样做是务实的。然而，令人惊讶的是，这经常是一个坏主意：我编写的作为 TDD 的结果的代码往往更容易测试、更容易修改，而且大多数情况下只是比后来得到测试的代码更好。

但这只是我，YMMV。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-15T17:14:00.123

通常，一旦我完成一个函数，我就会编译它，切换到 REPL，并使用一些临时组成的数据（也包括边缘情况）对其进行测试。有时（比我想要的更多）需要几个调试周期（编辑-编译-测试）来获得所需的行为。当然，这种开发方式只有在你可以单独将函数编译到提供 REPL 的运行时才可行，否则你会花费太多时间等待完整的编译。我将 SBCL 与 SLIME 一起使用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-11-04T11:19:16.270

我尝试让我的代码第一次运行成为 var 单元测试。

有时我先写测试，有时我先写方法/类。

> 我喜欢自我**感觉良好，因此我喜欢****经常**
> 给自己积极的反馈， 因此我尝试**在写完一个新方法后立即“证明”它是**有效的。

 ****# asp.net-ajax - Configure asp.net site with ASP.NET Ajax Control Toolkit

> ID：447369
> 
> 赞同：1
> 
> 时间：2009-01-15T16:08:32.173
> 
> 标签：asp.net-ajax, ajaxcontroltoolkit

I have an application that has been converted from VS2005 2.0 framework to VS2008 3.5 framework. I am attempting to add the ability to use the AjaxControlToolkit DLL [[AjaxControlToolkit-Framework3.5SP1-DllOnly.zip]](http://www.codeplex.com/AjaxControlToolkit/Release/ProjectReleases.aspx?ReleaseId=16488) download only within my project. I have followed the configuration setups to get the project to build, and have not been successful in getting a control to load.

[How do I install and use the ASP.NET AJAX Control Toolkit in my .NET 3.5 web applications?](https://stackoverflow.com/questions/40116/how-do-i-install-and-use-the-aspnet-ajax-control-toolkit-in-my-net-35-web-appli)

and

[Configuring ASP.NET AJAX](http://www.asp.net/AJAX/documentation/live/ConfiguringASPNETAJAX.aspx)

I am currently running into an error after adding all the web.config settings to my web application.

## Server Error in '/' Application.

Configuration Error

Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately.

Parser Error Message: Could not load file or assembly 'System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot find the file specified.

Source Error:

```
<compilation defaultLanguage="vb" debug="true">  
  <assemblies>  
    <add assembly="System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>  
  </assemblies>  
  <expressionBuilders>  

```

I imagine others have had this problem, but can't find any resources that will help me fix this. Thanks in advance for the help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T15:18:19.213

那是旧版本。更改 web.config 中的行以使用 3.5 版本：

```
<add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/> 
```

（是的，这是一个常见的转换错误。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T15:25:23.520

我从 web.config 继承中遇到了很多这个问题。您还可以添加绑定重定向。下面将对旧版本的任何调用重定向到新版本，您也可以将其设置为反过来工作。

```
 <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.61025.0" newVersion="3.5.0.0"/>
            </dependentAssembly>
        </assemblyBinding>
    </runtime> 
```

# wix - 在 wix 中写入注册表 - 示例 wxs 文件说明的问题

> ID：447371
> 
> 赞同：1
> 
> 时间：2009-01-15T16:09:37.617
> 
> 标签：wix

我正在尝试使用 Wix 写入注册表。

它未能显示错误“错误代码为 2727”

要运行此示例，请按照以下步骤操作。

您需要 c:\testinstall.txt 中的文本文件

它将文件 testinstall.txt 安装在 C:\Program Files\testinstall

蜡烛样品.wxs 灯样品.wixobj

sample.msi 将被创建

当我在脚本中添加此条目时，它失败了。

我只需要一个脚本来创建一个键并将一些值写入注册表。

# 示例.wxs 代码

 ``2

```
 <Registry Id="TestKey" 
     Root="HKLM" 
     Key="SOFTWARE\testCorp" 
     Action="createKeyAndRemoveKeyOnUninstall"> 

 <Registry Id="TestValue" 
           Name="TestValue" 
           Action="write" 
           Value="123" 
           Type="string" /> 
 </Registry> 

  </Component>

   </Directory>
  </Directory>
</Directory>

<Feature Id="Feature" Level="1">
 <ComponentRef Id="component0" />
 <ComponentRef Id="ID0EAAA" />
</Feature> 
````  `* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T16:31:45.277

您使用的是 WiX v2 吗？无需使用两个注册表项创建注册表值，只需将其全部合并为一行。

```
<Registry Id="TestKey" Root="HKLM" Key="SOFTWARE\testCorp" Name="TestValue" Value="123" Type="string" Action="write" /> 
```

这通常要容易得多。如果你真的想嵌套它们，那么我建议将 Registry/@Action 属性从父注册表项中移除，这样它实际上就不会出现在 MSI 中。只是组织子元素。

请注意，WiX v3 中的语法有点不同。

# c++ - “删除这个”有什么用？

> ID：447379
> 
> 赞同：28
> 
> 时间：2009-01-15T16:11:14.197
> 
> 标签：c++, memory-management, destructor, self-destruction

今天，我看到了一些遗留代码。在析构函数中有一个类似“ `delete this`”的语句。我认为，这个调用将是递归的。为什么它在工作？

我在 Y! 上快速搜索了一下，发现如果需要限制用户创建堆栈对象，我们可以将析构函数设为私有并提供删除实例的接口。在提供的接口中，我们必须对该指针调用delete。

还有其他情况可以使用此类语句吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-15T16:16:04.123

“删除这个”通常用于引用计数的对象。对于引用计数的对象，何时删除的决定通常放在对象本身上。下面是一个 Release 方法的示例 [1]。

```
int MyRefCountedObject::Release() {
  _refCount--;
  if ( 0 == _refCount ) {
    delete this;
    return 0;
  }
  return _refCount;
} 
```

ATL COM 对象是这种模式的主要示例。

[1] 是的，我意识到这不是线程安全的。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-15T16:44:55.627

`delete this`在析构函数中无效。它可以在其他地方使用。但这很少是一个好主意。框架将`wxWidgets`它用于他们的线程类。它有一种模式，当线程结束执行时，它会自动释放系统资源和自身（wxThread 对象）。我觉得这很烦人，因为从外面看，你不知道引用它是否有效——你不能再调用这样的函数`IsValid`，因为对象不存在。这闻起来像是 的主要问题`delete this`，除了它不能用于非动态对象的问题。

如果您这样做，请确保您不要触摸任何数据成员，或者在您以这种方式删除的对象上再调用任何成员函数。最好将其作为非虚拟、受保护或私有函数中的最后一条语句。调用 delete 在虚拟和/或公共函数中也是有效的，但我会限制这样做的方法的可见性。

[C++ FAQ](https://isocpp.org/wiki/faq/freestore-mgmt#delete-this)有一个关于此的条目。C++ 标准引用我上面的声明（`3.8p5`）：

> 在对象的生命周期开始之前但在对象将占用的存储空间分配之后，或者在对象的生命周期结束之后并且在对象占用的存储空间被重用或释放之前，指向该存储空间的任何指针可以使用对象将要或曾经位于的位置，但只能以有限的方式使用。[...]*如果对象将是或曾经是具有非平凡析构函数的类类型，并且指针用作删除表达式的操作数，则程序具有未定义的行为。*

当对象的析构函数开始执行时，生命周期结束。请注意，该段之后的规则有一些例外，用于构建和销毁的对象（例如，您可以访问非静态数据成员），详见`12.7`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T17:06:34.427

在早期的 C++ 时代，有充分的理由这样做。例如，引用计数对象的自我删除（如 JaredPar 所说）。据我所知，从长远来看，它们都被认为是一个坏主意。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-30T02:20:19.723

在双向链表中，可以在不引用任何外部结构（例如高级“列表”对象）的情况下删除节点。这使得每个节点处理自己的释放是合理的（可能与互补的静态方法相结合来处理来自同一内存池的初始分配）。在这种情况下，节点对象删除自身（当用户请求时）可能是有意义的。

```
void RemoveAndDeallocate()
{
    LinkedListNode *current_prev = prev, *current_next = next;
    current_prev->next = current_next;
    current_next->prev = current_prev;
    delete this;
} 
```

虽然，从一个列表中取消链接并链接到另一个列表中的节点也是合理的，而不释放任何内存，因此单个删除操作无条件释放内存是不可取的。

# math - 排列组合面试

> ID：447384
> 
> 赞同：20
> 
> 时间：2009-01-15T16:11:51.450
> 
> 标签：math, probability, bayesian

这是一个很好的方法，因为它非常违反直觉：

> 想象一个装满球的瓮，其中三分之二是一种颜色，三分之一是另一种颜色。一个人从瓮中抽出 5 个球，发现其中 4 个是红色的，1 个是白色的。另一个人抽了20个球，发现12个是红色的，8个是白色的。两个人中的哪一个应该更确信骨灰盒中有三分之二的红球和三分之一的白球，而不是相反？每个人应该给出什么赔率？

我知道正确的答案，但也许我不太了解赔率计算。谁能解释一下？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-15T19:07:35.527

[Eliezer Yudkowsky对贝叶斯定理](http://yudkowsky.net/rational/bayes)有一个（真的，真的很长，但很好）的解释。大约下降了70%，有一段以“在你面前是一个书包”开头，这解释了这个问题的核心。

妙语是，重要的是绘制了多少红球和白球之间的*差异。*因此，与其他人所说的**相反**，您不必进行*任何*计算。（这是做出合理的假设（a）球是*用replacement*绘制的，或者（b）骨灰盒有*很多*球。那么球的数量就无关紧要了。）这是论点：

回忆贝叶斯定理：P(A|B) = P(B|A) * P(A) / P(B)。（关于术语的注释：P(A) 是*先验*，P(A|B) 是*后验*。B 是您所做的一些观察，术语反映了您在观察前后的信心*。**）*这种形式的定理是很好，@bobince 和 @Adam Rosenfield 正确应用了它。但是，直接使用这种形式会使您容易出现算术错误，并且并不能真正传达*内心***贝叶斯定理。亚当在他的帖子中提到（我在上面提到过），重要的是绘制了多少红球和白球之间的差异，因为“其他一切都在方程式中抵消了”。不做任何计算我们怎么能看到呢？**

 **我们可以使用*优势比*和*似然比*的概念。什么是优势比？好吧，我们不会考虑 P(A) 和 P(¬A)，而是考虑它们的比率 P(A) : P(¬A)。任何一个都可以从另一个中恢复，但是算法在优势比上效果更好，因为我们不必进行标准化。此外，更容易以另一种形式“获得”贝叶斯定理。

我的意思是我们不必标准化，什么是替代形式？好吧，让我们计算一下。贝叶斯定理说后验概率是

> P(A|B) : P(¬A|B) = (P(B|A) * P(A) / P(B)) : (P(B|¬A) * P(¬A) / P （乙））。

P(B) 是使概率总和为 1 的归一化因子；但是，我们正在使用比率，其中 2 : 1 和 4 : 2 的几率是相同的，所以 P(B) 取消了。我们只剩下一个简单的表达式，它恰好是因数：

> P(A|B) : P(¬A|B) = (P(B|A) * P(A)) : (P(B|¬A) * P(¬A)) = (P(B| A) : P(B|¬A)) * (P(A) : P(¬A))

我们已经听说过那里的第二个任期；这是先验优势比。什么是 P(B|A) : P(B|¬A)？这叫做*似然比*。所以我们的最终表达式是

> **后验几率=似然比*先验几率。**

我们如何在这种情况下应用它？好吧，假设我们有一些先验概率 x : y 表示瓮中的东西，其中 x 代表 2/3 红色，y 代表 2/3 白色。假设我们画了*一个*红球。似然比是 P(drew red ball | urn is 2/3rds red) : P(drew red ball | urn is 2/3rds white) = (2/3) : (1/3) = 2 : 1\. 所以后验赔率是 2x : y; 如果我们画了一个白球，通过类似的推理，后验概率将是 x : 2y。现在我们*按顺序*对每个球执行此操作；如果平局是独立的，那么我们只需将所有优势比相乘。所以我们得到，如果我们以 x : y 的赔率比开始并抽出 r 个红球和 w 个白球，我们得到的最终赔率比为

> (x : y) * (2 : 1)^r * (1 : 2)^w = (x * 2^r) : (y * 2^w) = (x : y) * (2^(rw) ：1）。

所以我们看到重要的是r和w之间的区别。它也让我们轻松解决问题。对于第一个问题（“谁应该更有信心？”），先验几率无关紧要，只要它们不是 1 : 0 或 0 : 1 并且两个人都有相同的先验。确实，如果他们相同的先验是 x : y，那么第一个人的后验是 (2^3 * x) : y，而第二个人的后验是 (2^4 * x) : y，所以第二个人更当然。

此外，假设先验概率是一致的，即 1:1。那么第一个人的后验概率是 8:1，而第二个人的概率是 16:1。我们可以很容易地将这些概率转换为 8/9 和 16/ 17、确认其他计算。

**这里的重点**是，如果你*得到*上面加粗的等式，那么这个问题*真的很简单*。但*同样重要的是*，你可以确定你没有搞砸任何算术，因为你必须做的很少。

所以这是一个糟糕的编程问题，但它*是*对粗体方程的一个很好的测试。只是为了练习，让我们将其应用于另外两个问题：

> 我随机选择两个硬币中的一个，一个公平的硬币或一个假的双头硬币，每个都有 50% 的概率。我把它翻了三遍，三遍都是正面。它是真币的概率是多少？

如问题中所述，先前的赔率是真实的：假= 1：1。我看到真币三个正面的概率是 1 / 8，但假币是 1，所以似然比是 1：8。所以后验概率是 = 先验 * 似然 = 1：8。因此它是真币的概率是 1 / 9。

这个问题还提出了一个重要的警告：每个可能的观察结果都可能存在*不同*的似然比。这是因为 B 的似然比是 P(B|A) : P(B|¬A)，这不一定与 ¬B 的似然比有关，即 P(¬B|A) : P(¬ B|¬A)。不幸的是，在上面的所有示例中，它们都是彼此相反的，但在这里，它们不是。

确实，假设我抛硬币一次并得到反面。它是真币的概率是多少？显然是一个。贝叶斯定理如何检验？好吧，*这个观察*的似然比是真币与假币看到这个结果的概率，即 1/2 : 0 = 1 : 0。也就是说，看到一个*尾巴*会杀死硬币存在的概率假的，这符合我们的直觉。

这是我在 Eliezer 的页面中提到的问题：

> 你面前是一个书包，里面装着 1,000 个扑克筹码。我从两个这样的书包开始，一个包含 700 个红色和 300 个蓝色筹码，另一个包含 300 个红色和 700 个蓝色筹码。我掷了一个公平的硬币来决定使用哪个书包，所以你面前的书包是红色书包的先验概率是 50%。现在，您随机抽样，在每个芯片后更换。在 12 个样本中，您得到 8 个红色和 4 个蓝色。这是主要是红色的袋子的概率是多少？（您不需要精确 - 粗略的估计就足够了。）

先验概率为红色：蓝色 = 1：1。似然比为 7：3 和 3：7，因此后验概率为 (7:3)^8 * (3:7)^4 = 7^4:3 ^4。此时我们只是将 7 : 3 估计为 2 : 1，得到 2^4 : 1 = 16 : 1。我们最终的答案更大，所以肯定大于 95% 左右；正确答案约为 96.7%。将此与大多数人的答案进行比较，后者在 70--80% 范围内。

我希望你同意，从这个角度来看，问题变得非常容易和*直观*。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-15T19:25:46.987

让**A**是 2/3 的球是红色的事件，然后 ¬ **A**是 2/3 的球是白色的事件。设**B**是第一个观察者看到 5 个红球中有 4 个的事件，设**C**是第二个观察者看到 20 个中有 12 个红球的事件。

应用一些简单的组合，我们得到了

*   P( **B** | **A** ) = (5 选择 4)(2/3) ⁴ (1/3) ¹ = 80/243
*   P( **B** |¬ **A** ) = (5 选择 4)(1/3) ⁴ (2/3) ¹ = 10/243

因此，根据贝叶斯定律，观察者 1 的置信水平为 80/(80+10) = 8/9，即**A**为真。

对于第二个观察者：

*   P( **C** | **A** ) = (20 选择 12)(2/3) ^(12) (1/3) ⁸ = 125970 * 2 ^(12) /3 ^(20)
*   P( **C** |¬ **A** ) = (20 选择 12)(1/3) ^(12) (2/3) ⁸ = 125970 * 2 ⁸ /3 ^(20)

因此，再次根据贝叶斯定律，观察者 2 的置信水平为 2 ^(12) /(2 ^(12) + 2 ⁸ ) = 16/17，即**A**为真。

因此，**观察者二**具有较高的置信水平，即 2/3 的球是红色的。关键是要了解贝叶斯定律是如何工作的。事实上，重要的是观察到的红球和白球的数量*不同*。其他所有内容（特别是抽出的球总数）都在方程式中抵消了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T18:00:02.120

我假设一个假设与另一个假设的“先验”概率是 1/2，此外，两个人都在提取每个球后重新插入它（提取彼此独立）。

正确答案是*第二个*观察者应该比第一个观察者更有信心。由于计算中的一个微不足道的错误，我之前的答案是错误的，非常感谢 Adam Rosenfield 的纠正并 +1。

令**2/3R 1/3W**表示事件“瓮中有 2/3 的红球和 1/3 的白球”，让**4R,1W**表示事件“取出 4 个红球和 1 个白球”。然后，使用贝叶斯规则，

P[ **2/3R 1/3W** | **4R,1W** ] = P[ **4R,1W** | **2/3R 1/3W** ] P[ **2/3R 1/3W** ] / P[ **4R,1W** ] = (2/3) ⁴ (1/3) ¹ (1/2) / P[ **4R, 1W** ]

现在，由于假设**2/3R 1/3W**和**1/3R 2/3W**是互补的，

P[ **4R,1W** ] = P[ **4R,1W** | **2/3R 1/3W** ] P[ **2/3R 1/3W** ] + P[ **4R,1W** | **1/3R 2/3W** ] P[ **1/3R 2/3W** ] = (2/3) ⁴ (1/3) ¹ (1/2) + (1/3) ⁴ (2/3) ¹ (1/ 2)

因此，

P[ **2/3R 1/3W** | **4R,1W** ] = (2/3) ⁴ (1/3) ¹ (1/2) / { (2/3) ⁴ (1/3) ¹ (1/2) + (1/3) ⁴ (2 /3) ¹ (1/2) } = 2^4 / (2^4 + 2) = **8/9**

**P[ 2/3R 1/3W** |的计算相同。**12R,8W** ]（即具有 (2/3) ^(12) (1/3) ⁸而不是 (2/3) ⁴ (1/3) ¹）现在产生**16/17**，因此第二个观察者的置信度大于第一个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T18:28:37.367

> P[2/3R 1/3W | 4R, 1W] = (2/3)^4 * (1/3)^1 * (1/2) / { (2/3)^4 * (1/3)^1 * (1/2) + (1/3)^4 * (2/3)^1 * (1/2) } = 2^4 / (2^4 + 1) = 16/17

呃，

```
= ⅔^4*⅓ / (⅔^4*⅓ + ⅓^4*⅔)
= 16/243 / (16/243 + 2/243)
= 16/18 
```

然而，P(⅔R⅓W | 12R8W) 确实 = 16/17，因此 12R8W 可以更有信心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-18T14:04:22.743

呵呵。可能我完全错了，但答案应该是第二个人不是很直观吗？

一见之比：4：1 4/5：1/5

二见比例 3:1 3/4 : 1/4

这么简单的问题是谁更接近 2/3 : 1/3 ？因此答案是 Obs。二。

可能是我犯了两个错误，并且对复杂的事情得到了简单的答案，但请原谅我耐心地对我认为实际上很直观的东西进行冗长的解释。

# regex - 如何删除中间的首字母并在末尾添加一个点？

> ID：447391
> 
> 赞同：3
> 
> 时间：2009-01-15T16:12:38.217
> 
> 标签：regex, perl, parsing, expression

我在一个字段中有一堆名字，中间的首字母带有“。” 最后..

我需要一个正则表达式来转换这个例子：

Kenneth R.

into

Kenneth

我试图建立自己的并发现这个有用的网站顺便说一句..

[http://www.gskinner.com/RegExr/](http://www.gskinner.com/RegExr/)

但我Perl 和正则表达式的新手，只能得到 "...$" - 当名字的末尾没有中间首字母时，这是没用的......

* * *

我刚刚找到了另一种需要考虑的名称格式...'R. 凯利'需要是'凯利'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T16:17:53.247

如果它以 dot 结尾，则删除最后一个“单词”：

```
my $name =~ s/\w+\.$//i; 
```

（这假设你在那之后没有任何空间）

要删除以点结尾的任何单词：

```
my $name =~ s/\w+\.//i; 
```

如果要全部删除它们，请查看 /g 修饰符...

顺便说一句，为自己制作一个测试用例列表来检查您的解决方案，然后尝试使用真实的单词数据，您可能会得到一些惊喜......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T21:18:00.783

处理 R. Kelly 案：

```
s/\w\. *//g 
```

这是一个快速测试：

```
$ echo 'R. Kelly
Kenneth R.
R. Kemp R.
John Q. Smith' | perl -pe 's/\w\. *//g'
Kelly
Kenneth 
Kemp 
John Smith 
```

我建议：

1.  全局选项 ( `g`) 是必需的。
2.  不区分大小写的选项 ( `i`) 不是。
3.  您可能会考虑仅查找大写 ( `[:upper:]`) 首字母。
4.  应该怀疑地看待多个字符“首字母”。（`w+`除非您的数据有相关案例，否则这可能是一个错误。）
5.  阅读`perldoc perlre`以获取更多信息。

# xml - .NET 开发人员的 xls 文件有多重要？

> ID：447399
> 
> 赞同：0
> 
> 时间：2009-01-15T16:15:25.700
> 
> 标签：xml, xls, xmldatasource

有时，我们使用 .XLS 文件来转换存储在 XML 文件中的数据，并使用 XmlDataSource 对象填充一些下拉列表和其他服务器控件。我只是想知道.Net 项目中.XLS 文件的使用有多受欢迎？我们已经习惯于填充国家列表和州列表以及其他大量的项目特定列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T17:22:48.420

嗯，Excel (XLS) 在许多管理和项目规划人员中非常流行——铁杆开发人员可能更喜欢直接的 XML。

XLS 没问题 - 但处理、创建和读取有点混乱（在 Excel 2007 XLSX 基于 xml 的格式之前）。

所以 - 如果您要交换数据和/或跟踪要在下拉列表中显示的数据 - 使用适当的数据库表，或者如果这不可能，我建议使用 XML over Excel (XSL)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T17:41:34.400

我发现 XLST（我假设这就是您所说的）在我个人的与 XML 和 HTML 相关的 .NET 开发经验中非常方便。它有一些我并不特别关心的明显怪癖，但总而言之，我发现它值得使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T18:07:36.427

使用基于 gui 的 COM 与应用程序服务器端的互操作是绝对禁忌的。要么将来自 xml 的数据缓存/保存在内存中，要么将其放入数据库中。

我专注于您提到的服务器控制。如果您使用的是 .Net 3.5，请对 xml 源使用 Linq-to-XML 查询，并将结果放入 asp.net 缓存中，缓存依赖于原始 xml，这是您最好的选择。如果它是列表框的键/值对，这就是 Dictionary 的用途。

Excel 可以成为许多自动化任务的一个很好的快捷方式，但服务器端和大概的 Web 上下文特别不适合。特别是用于存储已处理的 XML。

# c# - 为什么可为空的布尔值不允许 if(nullable) 但允许 if(nullable == true)？

> ID：447408
> 
> 赞同：36
> 
> 时间：2009-01-15T16:17:33.653
> 
> 标签：c#, .net, nullable

此代码编译：

```
private static void Main(string[] args)
{
    bool? fred = true;

    if (fred == true)
        Console.WriteLine("fred is true");
    else if (fred == false)
         Console.WriteLine("fred is false");
    else Console.WriteLine("fred is null");
} 
```

此代码*无法*编译。

```
private static void Main(string[] args)
{
    bool? fred = true;

    if (fred)
        Console.WriteLine("fred is true");
    else if (!fred)
         Console.WriteLine("fred is false");
    else Console.WriteLine("fred is null");
} 
```

我认为`if(booleanExpression == true)`应该是冗余。为什么不在这种情况下？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-15T16:21:24.317

没有从`Nullable<bool>`to的隐式转换`bool`。有一个从to的隐式转换，这*就是*第一个版本中每个 bool 常量发生的情况（用语言术语）。然后应用运算符。（这与其他提升运算符不太一样 - 结果只是，而不是。）`bool``Nullable<bool>``bool operator==(Nullable<bool>, Nullable<bool>``bool``Nullable<bool>`

换句话说，表达式 'fred == false' 是 type `bool`，而表达式 'fred' 是 type ，`Nullable<bool>`因此您不能将其用作“if”表达式。

编辑：为了回答评论，从来没有隐式转换从`Nullable<T>`to`T`并且有充分的理由 - 隐式转换不应该抛出异常，除非你想`null`被隐式转换为`default(T)`，否则没有什么可以做的。

此外，如果有两种方式*的*隐式转换，像“nullable + nonNullable”这样的表达式会非常混乱（对于支持 + 的类型，比如`int`）。+(T?, T?) 和 +(T, T) 都可用，具体取决于转换的操作数 - 但结果可能非常不同！

我 100% 支持仅从 to 进行显式转换的`Nullable<T>`决定`T`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-15T16:20:40.823

因为 fred 不是布尔值。它是一个结构，它有一个名为 IsNull 或 HasValue 或其他的布尔属性...名为 fred 的对象是包含一个布尔值和一个值的复杂复合对象，而不是原始布尔值本身...

例如，下面是如何实现 Nullable Int 的。几乎可以肯定通用 Nullable 的实现方式类似（但通常）。你可以在这里看到隐式和显式转换是如何实现的。

```
public struct DBInt
   {
       // The Null member represents an unknown DBInt value.
       public static readonly DBInt Null = new DBInt();
       // When the defined field is true, this DBInt represents a known value
       // which is stored in the value field. When the defined field is false,
       // this DBInt represents an unknown value, and the value field is 0.
       int value;
       bool defined;
       // Private instance constructor. Creates a DBInt with a known value.
       DBInt(int value) 
       {
              this.value = value;
              this.defined = true;
       }
       // The IsNull property is true if this DBInt represents an unknown value.
       public bool IsNull { get { return !defined; } }
       // The Value property is the known value of this DBInt, or 0 if this
       // DBInt represents an unknown value.
       public int Value { get { return value; } }
       // Implicit conversion from int to DBInt.
       public static implicit operator DBInt(int x) 
       { return new DBInt(x); }

       // Explicit conversion from DBInt to int. Throws an exception if the
       // given DBInt represents an unknown value.
       public static explicit operator int(DBInt x) 
       {
              if (!x.defined) throw new InvalidOperationException();
              return x.value;
       }
       public static DBInt operator +(DBInt x) 
       { return x; }
       public static DBInt operator -(DBInt x) 
       { return x.defined? -x.value: Null; }
       public static DBInt operator +(DBInt x, DBInt y) 
       {
              return x.defined && y.defined? 
                      x.value + y.value: Null;
       }
       public static DBInt operator -(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                      x.value - y.value: Null;
       }
       public static DBInt operator *(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                      x.value * y.value: Null;
       }
       public static DBInt operator /(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                     x.value / y.value: Null;
       }
       public static DBInt operator %(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                      x.value % y.value: Null;
       }
       public static DBBool operator ==(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                     x.value == y.value: DBBool.Null;
       }
       public static DBBool operator !=(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                     x.value != y.value: DBBool.Null;
       }
       public static DBBool operator >(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                     x.value > y.value: DBBool.Null;
       }
       public static DBBool operator <(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                     x.value < y.value: DBBool.Null;
       }
       public static DBBool operator >=(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                      x.value >= y.value: DBBool.Null;
       }
       public static DBBool operator <=(DBInt x, DBInt y) 
       {
              return x.defined && y.defined?  
                     x.value <= y.value: DBBool.Null;
       }
       public override bool Equals(object o) 
       {
              try { return (bool) (this == (DBInt) o); } 
              catch  { return false; }
       }
       public override int GetHashCode() 
       { return (defined)? value: 0; }   
       public override string ToString() 
       { return (defined)? .ToString(): "DBInt.Null"; }   
   } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T16:24:10.737

该语句`Nullable<bool> == true`隐式检查`Nullable<bool> == (Nullable<bool>)true`.

请注意，`Nullable<bool>`它本身不是布尔值。它是一个布尔值的包装器，也可以设置为 null。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T16:26:32.463

如果你将 fred 转换为布尔值，它将编译：

```
 if (( bool )fred )
      (...) 
```

我认为当你比较布尔？bool，编译器进行隐式转换，进行比较，然后返回真或假。结果：表达式计算为布尔值。

当你不比较布尔？对于某事，表达式计算为布尔值？，谁在那里是非法的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-29T20:48:32.853

从技术上讲，如果您有 true 运算符的实现，那么裸条件测试不需要隐式转换为 bool。

```
bool? nullableBool = null;
SqlBoolean sqlBoolean = SqlBoolean.Null;
bool plainBool = sqlBoolean; // won't compile, no implicit conversion
if (sqlBoolean) { } // will compile, SqlBoolean implements true operator 
```

最初的问题是寻找一种 SQL 风格的 null 实现，其中 null 更像是一个未知数，而 Nullable 实现更像是添加 null 作为额外的可能值。例如比较：

```
if (((int?)null) != 0) { } //block will execute since null is "different" from 0
if (SqlInt32.Null != 0) { }  // block won't execute since "unknown" might have value 0 
```

更多类似数据库的行为可从`System.Data.SqlTypes`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-09T23:34:13.723

实现问题完美地表述为：`Fred`is of type `Nullable<bool>`and the `!`operator is not defined for `Nullable<bool>`。没有理由说明`!`运算符 on`Nullable<bool>`应该用 来定义`bool`。

引用微软：

> 与可空类型执行比较时，如果可空类型之一为空，则比较总是被评估为假。

该规则没有提及隐式转换。这只是一个任意约定，旨在保证没有布尔表达式有异常。一旦规则到位，我们就知道如何编写代码。遗憾的是，微软错过了这个一元运算符。为了与二元运算符的行为保持一致，以下代码应该有一个美好的结局。

所以

```
static void Main(string[] args)
{
    bool? fred = null;

    if (!fred)
    {
        Console.WriteLine("you should not see this");
    }
    else
    {
        Console.WriteLine("Microsoft fixed this in 4.5!!!");
    }
} 
```

我敢打赌，有些程序员现在不得不`fred==false`在微软修复这个看似最后一个空问题的同时编写代码。

# .net - 使用 .net 从 Exchange 服务器获取收件箱消息

> ID：447413
> 
> 赞同：4
> 
> 时间：2009-01-15T16:18:16.240
> 
> 标签：.net, email, exchange-server

有人知道该怎么做吗？

我需要创建一个服务，该服务将连接到交换服务器并每 x 分钟下载一次消息......

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T16:36:41.273

您可能想要使用 WebDAV。这是一篇关于这个主题[的好文章](http://blog.downtownsoftwarehouse.com/2006/10/26/using-net-and-webdav-to-access-an-exchange-server/)

[此外，这是Exchange Store](http://msdn.microsoft.com/en-us/library/aa486312(EXCHG.65).aspx)上的 MSDN 参考

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T16:39:43.607

您使用的是哪个版本的 Exchange Server？如果是 2007 年，您可以使用[Web 服务 API](http://msdn.microsoft.com/en-us/library/aa579187.aspx)。[FindItem](http://msdn.microsoft.com/en-us/library/aa566107.aspx)方法将允许您访问特定文件夹中的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T10:46:46.787

或者，如果它是 2007 年，您可以使用托管在 .net 应用程序中的 powershell

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-19T20:40:25.230

如果您有兴趣使用 3rd 方库，请访问[http://www.aspose.com/documentation/.net-components/aspose.network-for-.net/managing-emails-on-exchange-server.html 。](http://www.aspose.com/documentation/.net-components/aspose.network-for-.net/managing-emails-on-exchange-server.html)Aspose.Network 支持从 Exchange Server 收件箱访问电子邮件并以 eml 或 msg 格式保存到文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T14:35:38.820

我在 C# 中使用 Exchange Server 2010 和 Windows 服务完成了这项工作。我从收件箱中检索邮件，访问邮件数据，编辑电子邮件的主题（当前是硬编码的）并将其从收件箱中移至另一个文件夹“已​​保存”。我在控制台应用程序中显示结果以进行测试，直到我需要部署它。要使其每 x 分钟检查一次，请将 exe 任务/作业添加到 Windows 计划任务。这是代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Exchange101;
using Microsoft.Exchange.WebServices.Data;

namespace Exchange101
{      
    class Notifications
    {
      static ExchangeService service = Service.ConnectToService(UserDataFromConsole.GetUserData(), new TraceListener());

    static void Main(string[] args)
    {
        //SetStreamingNotifications(service);
        RecieveMails(service);

        Console.WriteLine("\r\n");
        Console.WriteLine("Press or select Enter...");
        Console.Read();
    }

    static void RecieveMails(ExchangeService service)
    {
        // Create a view with a page size of 100.
        ItemView view = new ItemView(10);

        // Indicate that the base property will be the item identifier
        view.PropertySet = new PropertySet(BasePropertySet.FirstClassProperties);
        view.PropertySet.Add(ItemSchema.IsAssociated);

        // Set the traversal to associated. (Shallow is the default option; other options are Associated and SoftDeleted.)
        view.Traversal = ItemTraversal.Associated;

        // Send the request to search the Inbox.
        FindItemsResults<Item> findResults = service.FindItems(WellKnownFolderName.Inbox, view);

        // Output a list of the item classes for the associated items
        foreach (Item item in findResults)
        {
            Console.WriteLine(item.ItemClass);
        }

        findResults = service.FindItems(
        WellKnownFolderName.Inbox,
        new ItemView(10)); //10 is the number of mails to fetch

        foreach (Item item in findResults.Items)
        {        
            //this needs to be here to recieve the message body
            MessageBody messageBody = new Microsoft.Exchange.WebServices.Data.MessageBody();
            List<Item> items = new List<Item>();
            if (findResults.Items.Count > 0) // Prevent the exception
            {
                foreach (Item item2 in findResults)
                {
                    items.Add(item2);
                }
            }
            service.LoadPropertiesForItems(items, PropertySet.FirstClassProperties);

            messageBody = item.Body.ToString();

            Console.WriteLine("==========================================================================");
            Console.WriteLine("IsNew: " + item.IsNew);
            Console.WriteLine("To: " + item.DisplayTo);
            Console.WriteLine("Subject: " + item.Subject);
            Console.WriteLine("Message Body: " + item.Body.ToString());
            Console.WriteLine("Date & Time Received: " + item.DateTimeReceived);
            Console.WriteLine("HasAttachments: " + item.HasAttachments);               

            //this is just what I have to do later
            //CreateNewWorkflowFromEmail();
            //if (WorkflowWasCreated) then move email to saved folder

            //here I change the subject and move the mail to my custom folder "Saved"
            Folder rootfolder = Folder.Bind(service, WellKnownFolderName.MsgFolderRoot);
            rootfolder.Load();

            foreach (Folder folder in rootfolder.FindFolders(new FolderView(100)))
            {
                // This IF limits what folder the program will seek
                if (folder.DisplayName == "Saved")
                {
                    var fid = folder.Id;
                    //Console.WriteLine(fid);                        
                    item.Load();
                    item.Subject = ("WF1234567 - " + item.Subject);
                    item.Update(ConflictResolutionMode.AlwaysOverwrite);
                    item.Move(fid);                            
                    }
                }
        }
    } 
```

# jquery - 使用 click() 在 jQuery 中调用函数

> ID：447414
> 
> 赞同：60
> 
> 时间：2009-01-15T16:19:01.450
> 
> 标签：jquery, function

在下面的代码中，为什么**open**函数有效而**close**函数无效？

```
$("#closeLink").click("closeIt"); 
```

你如何只*调用*一个函数`click()`而不是在方法中*定义*它`click()`？

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#openLink").click(function() {
            $("#message").slideDown("fast");
        });
       $("#closeLink").click("closeIt");
    });

    function closeIt() {
        $("#message").slideUp("slow");
    }
</script> 
```

我的 HTML：

```
Click these links to <span id="openLink">open</span> 
and <span id="closeLink">close</span> this message.</div>

<div id="message" style="display: none">This is a test message.</div> 
```

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-01-15T16:21:30.430

```
$("#closeLink").click(closeIt); 
```

假设您想调用您的函数，将一些参数传递给它，即`closeIt(1, false)`. 然后，您应该构建一个匿名函数并`closeIt`从中调用。

```
$("#closeLink").click(function() {
    closeIt(1, false);
}); 
```

# html - 下面的代码在 CSS 中做了什么？

> ID：447417
> 
> 赞同：0
> 
> 时间：2009-01-15T16:19:46.580
> 
> 标签：html, css

我对 CSS 一无所知，但我试图弄清楚这种语法的含义：

```
body {
    margin: 0;
    font-family: "Trebuchet MS", Helvetica;
    background: #FFFFFF;
    color: #FE6600;
    overflow-x: hidden;
    position: absolute;
    margin: 0;
    padding: 0;
    left: 0;
    top: 45px;
    width: 100%;
    min-height: 372px;
}

body > *:not(.toolbar) {
    /*display: block;*/
    position: absolute;
    margin: 0;
    padding: 0;
    left: 0;
    top: 45px;
    width: 100%;
    min-height: 372px;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T16:24:28.413

您是在谈论 :not 伪选择器吗？它听起来像是要从当前集合中选择与此选择器不匹配的所有元素。

虽然它是 CSS3，但我应该说它的支持不够广泛。

好文章[在这里](http://kilianvalkhof.com/2008/css-xhtml/the-css3-not-selector/)。

* * *

编辑，您的具体示例`body > *:not(.toolbar)`匹配所有 ( `*`) 的直接子 ( `>`) body 不是工具栏类 ( `:not(.toolbar)`)的实例

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T16:28:03.287

我假设你的意思是这部分：

```
body > :not(.toolbar) 
```

这同时使用 :not 选择器和 > 子选择器。

据我所知，这会将以下css应用于身体的孩子，除了“.toolbar”项目

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T16:30:26.637

```
 body > *:not(.toolbar) 
```

将给定样式应用于“没有类名'toolbar'的body元素的所有直接子元素”

截至目前，IE6/7 将无法正确呈现这些样式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T16:24:13.047

没有快速的答案可以告诉您 CSS 的全部内容......

这是一个相当广泛的主题！

看一下 ：

[http://www.w3.org/Style/CSS/learning](http://www.w3.org/Style/CSS/learning)

只是一个评论：在分号之后允许甚至推荐返回，然后一切都会更好地阅读......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T16:37:25.360

我不确定它有什么作用，真的。

第一种样式设置默认的正文规则（左上角位置、隐藏任何溢出、占据整个宽度、最小高度 372px、Trebuchet 字体、黑色 b/g、橙色 f/g 等）（尽管 "margin: 0"出于某种原因重复）。

第二条规则似乎试图设置一个例外，该例外适用于 body 元素的所有子标签，除了那些具有“工具栏”类的标签。问题是它的所有属性都是body标签属性的重复，所以我不确定它会有什么效果。看起来那里也有一个损坏的评论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T16:47:08.053

CSS 是 DHTML 的一部分。

我还推荐了 siukurnin 的建议。

最好从 CSS 开始

[http://www.w3schools.com/](http://www.w3schools.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T16:52:37.403

好吧，我的其他用户已经从每个 CSS 指令的作用的角度回答了您的问题，但我不确定该代码的作者试图完成什么。

它似乎并没有以一种非常扭曲的方式做任何特别的事情。不是我见过的最规范的代码，我不会向任何人推荐它:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-15T16:52:51.867

```
margin: 0; 
```

这条线意味着在正文周围保留的空间量将为零（以任何单位）。所以相邻的框只会将距离作为它们自己的边距设置，如果有的话。

我将把其他行留给其他答案。

# database - 单向存储和转发数据库复制架构问题

> ID：447425
> 
> 赞同：0
> 
> 时间：2009-01-15T16:20:56.547
> 
> 标签：database, replication

我正在寻找一些输入。我正在设计一个多用户、多供应商、n 层数据库应用程序。

该系统的每个本地安装都必须将其记录复制到单个中央服务器。安装的数据库应用程序的用户不能直接使用此服务器，并且 Internet 是访问它的唯一途径。中央数据库仅用于报告，因此复制只需单向到中央服务器。

主要目标是尽可能快地将记录发送到中央数据库，以确保“伪实时”快照。

这是我到目前为止所得到的：

1.  使用 Internet 上的 Web 服务器（SOAP 服务）上传压缩/加密文件（XML 数据）。“中央”数据库服务器定期轮询 Web 服务器以收集和导入数据。

2.  本地数据库系统不会删除记录，而是将它们标记为已删除。

3.  数据库中的每个表都有一个主键，使用类似 GUID 的代理键（即没有 auto-inc 字段）来防止中央数据库上的键违规。

4.  我已经打折使用客户端的数据库服务器来运行提取和上传过程，因为在客户站点上对该系统的 IT 支持很少，所以如果上传失败（由于本地防火墙/代理服务器问题），那么我想要用户尽快知道，这样他们就可以对其进行分类。

5.  提取过程一次只需要由一个客户端应用程序运行，因为它将查询*整个*本地数据库以提取更改。

我正在努力解决的问题是数据库结构能够有效（和准确）地提取最近更改的记录。这也会在用户工作时发生，即需要注意用户在提取过程中打开记录以供编辑，并且需要它“在后台”运行，以免过多地打扰用户。

即我是否使用基于日期和时间的方法？我是否使用某种状态字段，甚至是可以查询然后清除的单独更改日志表？

为这篇长文道歉，但我会重视任何人在开发此解决方案方面的任何经验。

TIA,

斯图尔特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T18:06:41.140

您可能想看看[Slony](http://www.slony.info/ "Slony-I 网站") for PostgreSQL 是如何做到的。

实际上，它不是查询实际表的更改，而是使用表上的触发器将更改的数据记录到单独的日志记录表中（这些插入/更新/删除）。然后，它变得简单，在日志表中增加一个字段（无论是事务 ID、时间等），以仅获取自上次以来的更改，并在所有相关方拥有日志条目后删除它们。请注意，这也消除了您修改原始表（及其客户端）以了解存在但在逻辑上已删除的行的 #2 点。

当然，根据您的数据库引擎，有几个细节可能会使事情复杂化。最初的[Slony 设计文档](http://developer.postgresql.org/%7Ewieck/slony1/Slony-I-concept.pdf)很好地涵盖了这些问题以及为什么它会以这种方式做事。即使您不使用 PostgreSQL，它也可能值得一读。

# mysql - 单台机器上的多个 MySQL 实例

> ID：447427
> 
> 赞同：10
> 
> 时间：2009-01-15T16:21:05.847
> 
> 标签：mysql, installation

如何在一台机器上配置多个 MySQL 实例？网上有很多资料，但都不是很有用。

我正在寻找一个从头到尾指导我的教程，而不是只能由具有多年 MySQL 管理经验的头脑理解的通用信息。我将不胜感激自给自足的答案或指针，即不需要用户方面的大量知识，而不是晦涩的参考。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-16T01:10:54.903

好的，这个问题应该作为与编程无关的问题关闭，这确实是即将到来的“姐妹”网站的问题，但无论如何我都会尝试回答它。现在我从来没有使用过 MySQL，有人可能会做一个更好的答案。

让我们从[谷歌搜索开始](http://www.google.com/search?q=How+to+configure+multiple+MySQL+instances+on+a+single+machine)

（5 分钟后……在浏览了几个结果后决定冒险尝试）

*   下载+安装mysql必备包（mysql-essential-5.1.30-win32.msi）
*   运行配置向导
*   再次运行配置向导（修改数据库路径，端口号）
*   看看[http://dev.mysql.com/doc/refman/5.1/en/multiple-windows-services.html](http://dev.mysql.com/doc/refman/5.1/en/multiple-windows-services.html)
*   看看 my.ini （和备份）
*   弄清楚我需要复制数据目录并将 ini 与备份 ini 文件合并，并且不需要运行配置向导两次。应该刚开始编辑 INI（但这需要阅读手册.. 工作量太大！无论如何，Ini 文件都有很好的文档记录）
*   合并ini文件，修改服务名
*   运行命令：mysqld --install mysql1、mysqld --install mysql2、net start mysql1、net start mysql2

20分钟，完成。

现在我们有了在单台机器上运行多个 MySQL 实例的分步说明，下次有人搜索它时，它可能会成为谷歌的第一个结果；）

# regex - 如果另一个字符串的子字符串，如何从匹配中排除

> ID：447447
> 
> 赞同：1
> 
> 时间：2009-01-15T16:25:28.490
> 
> 标签：regex

我有个问题。我想匹配我的文本中出现的所有 \t （并且 \ti 的意思是它实际上不是制表符）但如果它是 \t 字符串的一部分，我想排除匹配。怎么做？

例子

```
<HTML>Blah</HTML>\t
D:\\UserData\\tui 
```

我想在第一行匹配 \t 但不在第二行匹配（因为它是 \\t 的一部分）。

这完全可能使用正则表达式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T16:31:18.570

您必须更准确地定义“字符串的一部分”的含义。例如，您可能的意思是：如果 \t 后面跟着更多的字母数字或斜线，则不要匹配它。所以这将变成（在 Perl 中）：

```
 \\t(?![\w\\]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T16:32:55.820

```
/\\t\b/ 
```

`\b`匹配单词边界（从类似单词的字符到非类似单词的转换，反之亦然）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:32:34.357

您将需要准确定义在哪些情况下 \t 应该匹配，以及在哪些情况下不应该匹配，然后才能确定它的正则表达式。您当前的定义似乎是“当我看到它时我会知道它”的种类，这还不够。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T16:34:22.497

另一种方法：匹配除反斜杠以外的任何内容，匹配反斜杠并匹配“t”字符。

```
/[^\\](\\t)/
```

# html - 1024x768 屏幕上的典型视口大小是多少？

> ID：447456
> 
> 赞同：25
> 
> 时间：2009-01-15T16:28:01.260
> 
> 标签：html, browser, cross-browser

我正在设计一个 Web 应用程序，我想知道我可以设计的最大尺寸（x 和 y）。

[截至 2008 年 1 月](http://www.w3schools.com/browsers/browsers_display.asp)，大约一半的用户使用 1024x278 屏幕，可能只有不到 10% 的用户使用较小的屏幕。（手机和掌上电脑用户在这里是个例外。）所以我们设计的最小屏幕尺寸为 1024x768。

*但是*，这是屏幕尺寸，当我们布置内容时，我们需要知道*视口*尺寸。[有证据表明](http://www.baekdal.com/articles/Usability/actual-browser-size-preliminary/)，大多数用户都将浏览器最大化，但仍然必须为操作系统装饰和浏览器镶边减去空间。人们自定义他们的 chrome，因此没有单一的“正确”答案；我正在寻求一个可以容纳大多数用户的合理范围。

我看到[很多设计师](https://stackoverflow.com/questions/202557/what-is-the-best-absolute-width-for-a-webpage)说他们使用 960 像素的宽度，因为它有很多因素并且可以平均划分——但在决定这个之前，我想知道我可以逃脱的*最大*尺寸，那么我可能会选择少用一点。我已经看到引用的最大宽度为 960、974 甚至 990……我自己的实验似乎显示 1000 的宽度可以正常工作。

高度更难获得：我发现我可以在我尝试过的浏览器上安装 595 像素的垂直视口高度，具有典型的默认操作系统和 chrome 设置。但是我尝试的不是很多，我宁愿看一个更权威的来源。肯定有人做过这项研究，而且做得比我好。

所以我真正的问题是：我可以设计的最大视口尺寸是多少，并期望它适合 80-90% 的所有用户不使用滚动条？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-12-17T13:57:01.670

今天我刚刚遇到一个与我的这个老问题高度相关的网站。显然谷歌愿意分享他们关于浏览器窗口大小的知识。他们的新服务位于[http://browsersize.googlelabs.com/](http://browsersize.googlelabs.com/)，它基本上只是向您显示他们在典型浏览器门户大小上的数据。

**注意**：Google Labs 浏览器尺寸现在已经过时（图片标题为`2009-11-18-day_google_com_100_donate_example.png`），[很快就会关闭](http://analytics.blogspot.ca/2012/06/new-feature-conduct-browser-size.html)。Google 建议可以使用 Google Analytics 来确定您自己网站的浏览器大小分布：http: [//analytics.blogspot.ca/2012/06/new-feature-conduct-browser-size.html](http://analytics.blogspot.ca/2012/06/new-feature-conduct-browser-size.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-15T17:11:39.423

确保您的网站将以 800x600 呈现，但使其扩展以填充用户拥有的任何大小。

没有什么比在 1600x1200 或更大的分辨率下冲浪时遇到一个宽度不会超过 700-800 像素的愚蠢网站更令人讨厌的了。

查看 The man in blue 了解如何处理页面大小变化的一个很好的例子...... [http://themaninblue.com/experiment/ResolutionLayout/](http://themaninblue.com/experiment/ResolutionLayout/)

**更新：** 我找到了一个不错的网站，它使用一些统计数据来确定有多少用户可以看到什么尺寸的屏幕：[http ://www.methodologie.com/webcanvas/](http://www.methodologie.com/webcanvas/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-01-19T20:32:04.163

绝大多数用户在 1024x 768 屏幕上以最大化的窗口在 IE7 中查看 Web，并且没有修改他们的浏览器。所以我找到了一只豚鼠并截屏了。我假设任务栏是一行并且是可见的——同样是默认行为——并且窗口大小为**1003 x 589**。我个人会使用 960 x 560 的活动区域。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-16T02:06:53.993

值得一提的是，在全屏 XGA 下默认打开侧边栏宽度的 XP IE7 用户获得的视口宽度为 862 像素。高度并不像我们期望的垂直滚动那么重要，但必须水平滚动也是死亡。

当然，这可能与*实际*可用的内容不同的原因有很多，这就是为什么我们都是优秀的网页设计师并使用适当的液体布局，不是吗？

（那是什么，stackoverflow？真的吗？令人震惊，tsk。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-16T03:15:27.570

我目前正在使用屏幕分辨率为 1024x600 的 Acer 上网本。请记住，我们是一个不断增长的细分市场！（或者至少，尽量不要让你的垂直空间假设 768 作为最小屏幕高度）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-21T18:14:44.507

这似乎是最近的，我想我会提到它，在搜索互联网时发现它......

[http://www.nealgrosskopf.com/tech/thread.php?pid=43](http://www.nealgrosskopf.com/tech/thread.php?pid=43)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-16T03:04:33.457

我打开的 Firefox 大小（包括 chrome）为 1024x1000。我不会全屏浏览。

我的 chrome 包括菜单栏、导航工具栏（带有小图标）、书签工具栏、标签栏、右侧滚动条和底部的状态栏。

我的实际视口正好是 1000x843。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-27T01:40:12.493

我在索尼笔记本电脑 WUXGA 屏幕 (1920x1200) 上。

我的任务栏在屏幕的左侧，所以减去浏览器 chrome，我仍然有一个相当可观的可用 1831 像素。通常发现这对大多数用途都有好处。

我只希望 stackoverflow 能检测到我的宽屏并在右侧栏中显示我的答案预览。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-14T03:26:01.347

只是想我会补充一点，Shaun Inman 的[Mint](http://haveamint.com/) stats 应用程序有一个跟踪窗口大小而不是屏幕分辨率的[插件](http://haveamint.com/peppermill/pepper/9/real_estate/)，并考虑了最坏情况下的浏览器 chrome。然后，它将结果分组为 x% 的访问者的窗口宽度 >y% 或 >z% 高度，这对于做出有关特定站点的明智决策非常有用，并消除了过程中的一些猜测工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-12-17T14:00:41.310

1007px 是您在没有水平滚动条的 Internet Explorer（[详细信息）中使用的绝对最大值。](http://philfreo.com/blog/largest-website-width-to-support-1024x768-resolution/)但这就是说，除非您需要，否则我认为您不应该追求最大。相反，依赖于许多人的浏览器没有最大化的假设。

Google 的[浏览器大小](http://browsersize.googlelabs.com/)是一个很棒的工具。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-05-12T22:50:54.930

最初的问题 - 尽管这是一个好问题！- 以及一些答案在 2014 年变得越来越过时。

我们现在需要承认越来越多的不同屏幕尺寸的智能手机、上网本、宽屏 iMac、视网膜、（Android / Mac）平板电脑等。

除此之外，触摸和点击之间的鸿沟越来越大，后者不再是罕见的情况。

我们现在需要**`device-specific style with a tap-based UI for handheld devices with fixed browser sizes`**并且**`fluid-responsive style with mouse-hover effects etc. for desktop computers.`**

这应该是今天讨论的重点。

从这个意义上说，答案是原始的。问题不能再轻易提出了。一个非常常见的 1024x768 屏幕很可能是 iPad - 或按比例缩小的浏览器窗口。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-16T01:52:14.367

您已经找到的所有答案可能都是正确的。

对于普通用户（Stereotypical：Win XP 或 Vista，IE6-7，没有自定义皮肤），接近 1000 像素的宽度可能适合。如果人们修改了他们的浏览器，而不是全屏运行，或者在他们的操作系统上有自定义皮肤，这个数字可能会改变。

如果我要设计一个 1024 像素宽度的分辨率，我可能会选择接近 980 像素的宽度。这完全取决于您，没有“唯一的答案”。大约 960-1000 像素，取决于很多事情。

说到页面的高度，不要想太多。将最重要的信息（导航、标志、重要内容）放在页面顶部，不要害怕让用户滚动找到其余部分。人们习惯并且知道他们必须滚动。这是一个自然的限制，没有人希望你做任何事情。

对于最重要的信息，可能需要一个高度约为 550 像素或更高的视口。

因此，~980px * ~550px 可能是一个或多或少的标准视口，可用作起点:-)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T10:00:13.913

960px 的宽度是一个很好的尺寸，因为它是如此可分割。1000px 对于许多系统来说太大了。在 Vista/Firefox 上，滚动条宽度加上框架加起来约为 33 像素。

我认为检查高度很有用，因为它可以很好地了解查看者在第一次打开页面时可以看到什么和看不到什么。在这些信息饱和的日子里，您不能依赖任何访问者向下滚动。

我在 Firefox 上的视口、标签打开、快速链接和出色的 Web 开发人员工具栏扩展在设置为 1024x768 时只有 572 像素。

如果您使用 Web 开发人员工具栏，许多有用的功能之一就是能够立即将浏览器调整为您设置的任何大小：例如。1024x768、800x600 等。因此，您可以以与这些屏幕尺寸的访问者相同的方式查看您的网站。

Web 开发人员非常值得一试：[https ://addons.mozilla.org/en-US/firefox/addon/60](https://addons.mozilla.org/en-US/firefox/addon/60)

# php - PHP 如果日期 > 13 天前

> ID：447460
> 
> 赞同：0
> 
> 时间：2009-01-15T16:29:03.380
> 
> 标签：php, mysql

我正在从数据库中提取一行，并且有一个日期字段（ymd）。我需要创建一个 if 语句，以便如果该日期比 13 天前更长，我可以做一些事情。如果有帮助的话，我已经知道如何显示所有比 13 天前更长的结果。

```
SELECT * FROM links WHERE (TO_DAYS(NOW()) - TO_DAYS(date))>13 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T16:34:55.460

在 php 中，您可以使用：

```
$date = '2008-11-05';
if (strtotime("now") > strtotime("+13 days", strtotime($date))) {
  //Do something
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T16:35:13.977

一种方法是将 ymd 字符串转换为时间戳，并查看它是否大于 13*86400 秒（86400 = 一天中的秒数）

```
$age=time() - strtotime($date);
if ($age > (13*86400))
{
     //do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:36:15.800

您并没有给我们太多的内容，但是如果您使用以下 SQL（或您喜欢的等效 SQL），您将获得一个额外的列，其中包含名为“days_diff”的日期差异：

```
SELECT *, DATEDIFF(datecolumn,CURDATE()) AS days_diff FROM links 
```

然后你可以`$row["days_diff"]`在你的PHP中访问。

# django - django下拉菜单公共模板错误

> ID：447462
> 
> 赞同：0
> 
> 时间：2009-01-15T16:29:43.660
> 
> 标签：django, drop-down-menu

我的公共模板从 Postgres 抓取数据到下拉菜单。模板在下拉菜单中显示数据。激活选择时，会发生以下错误：

商品（）正好需要 2 个参数（1 个给定）

模板代码、视图和 URL 在这里：

[http://dpaste.com/109411/](http://dpaste.com/109411/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T16:33:57.800

您忘记在 url 文件中添加正则表达式

```
(r'^commodity/(\d+)$', 'commodity'), 
```

看看这是否有效。

编辑：在这里查看更多示例 [http://docs.djangoproject.com/en/dev/topics/http/urls/#example](http://docs.djangoproject.com/en/dev/topics/http/urls/#example)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T16:36:01.493

您的商品视图需要一个索引，但 url 中没有给出任何索引。

将您的网址更改为：

```
(r'^commodity/(?P<commodity_id>\d+)$', 'commodity') 
```

并使用以下网址触发它：

```
http://localhost:8000/commodity/5 
```

5 是从 url 捕获的 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:51:33.213

谢谢大家的帮助。至少最初的错误没有发生，但两个正则表达式都不起作用。我收到的错误现在是这样的：

当前 URL fsafety/commodity/ 与其中任何一个都不匹配。这些是： ^fsafety/ ^commodity/(?P\d+)$

至少我现在知道，错误出在 URL 中，但是否也有可能没有从表单传递 ID？数据直到在表单中的此语句之后才会出现：

{% 商品列表中的商品 %}

再次感谢你！！

安娜

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T20:01:27.960

你的网址应该是：

```
^fsafety/commodity/(\d+)$ 
```

或者，如果您想要一个命名表达式：

```
^fsafety/commodity/(?P<commidity_id>\d+)$ 
```

你有两个主要问题。首先是您的商品 ID 组必须命名或编号。 `(?P<group_name_here>\d+)`是一个命名组，而`(\d+)`是一个编号组，并根据顺序捕获。其次，您需要完全限定您的 URL，除非您使用`include()`命令来包含另一个 Django 应用程序的 urls.py 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T20:02:42.793

我误读了你最初的帖子。使用原始正则表达式并从函数中删除商品 ID 参数。

现在改变这个：

```
commodity_id = request.POST['commodity'] 
```

对此：

```
commodity_id = request.POST['commodity_id'] 
```

现在它应该可以工作了。

# asp.net-mvc - 基于角色成员或数据关系（所有权）的 ASP.NET MVC 授权

> ID：447464
> 
> 赞同：1
> 
> 时间：2009-01-15T16:30:06.717
> 
> 标签：asp.net-mvc, linq-to-sql, reflection, attributes, dynamic-linq

我想扩展 ASP.NET MVC 中的 AuthorizeAttribute 以便它支持基于用户角色成员身份或相关数据的“所有权”的用户授权的概念。我正在使用 LINQ2SQL 进行数据访问。[在asp.net mvc authorization using roles](https://stackoverflow.com/questions/390930/asp-net-mvc-authorization-using-roles)有一个类似的问题。

我在想的是向我扩展的 AuthorizeAttribute 类添加 EntityProperty、UserProperty、RouteParameter 和 JoinTableType 参数。前两个将是连接表中要检查的属性的名称。RouteParameter 将是要为要匹配的 EntityProperty 的值提取的路由参数的名称。我会使用当前用户名从用户表中获取用户 ID。JoinTableType 参数将是数据上下文中表的类型，其中包含路由参数值和用户 ID 必须匹配的实体和用户属性。

基本思想是，在伪代码中：

```
 if authorizecore result is true
    user is granted access based on role
 else if user is not authenticated
    redirect to logon
 else if user is related to request
    user is granted access based on relation
 else
    user is not authorized, redirect to not authorized error view 
```

相关测试如下所示：

```
 result = false
 find the matching user from user name
 find the entity property value in route data
 if user exists and entity property value exists
    get table from context matching join table type
    if table exists
       find row in table matching user id and entity property value
       if row exists
          result = true
       endif
    endif
 endif

 return result 
```

我的问题是如何在构建 LINQ 查询时使用类型和属性名称？或者我将不得不通过`object`反思来完成这一切。我真的在寻找有关如何使这更容易的想法，因此其他建议也会受到赞赏。我更喜欢使用该属性，而不是将检查直接嵌入到操作中，以使其与我处理其他操作的方式保持一致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T20:06:01.443

我能够使用 VS2008 示例中的 Dynamic Linq 扩展以非常合理的方式完成此操作。这是代表上面第二个伪代码示例的代码。它通过了我的初始单元测试，但我需要使它更健壮。

用法：

```
[RoleOrMemberAuthorization( UserTable = "Participants",
                            UserNameProperty = "UserName",
                            UserSelectionProperty = "ParticipantID",
                            JoinTable = "GroupLeaders",
                            EntityProperty = "GroupID",
                            UserEntityProperty = "ParticipantID",
                            RouteParameter = "id",
                            Roles = "SuperUser, ViewGroups" )] 
```

称为：

```
else if (IsRelated( filterContext,
                    this.GetTable( dc, this.JoinTable ), 
                    this.GetTable( dc, this.UserTable ) ))
{
    SetCachePolicy( filterContext );
} 
```

相关来源：

```
protected bool IsRelated( AuthorizationContext filterContext,
                          IQueryable joinTable,
                          IQueryable userTable )
{
    bool result = false;
    try
    {
        object entityIdentifier = filterContext.RouteData
                                               .Values[this.RouteParameter];
        object userIdentifier = this.GetUserIdentifer( filterContext, userTable );
        if (userIdentifier != null && entityIdentifier != null)
        {
            result = joinTable.Where( this.EntityProperty + "=@0 and "
                                      + this.UserEntityProperty + "=@1",
                                      entityIdentifier,
                                      userIdentifier )
                              .Count() > 0;
        }
    }
    catch (NullReferenceException) { }
    return result;
}

private object GetUserIdentifer( AuthorizationContext filterContext,
                                 IQueryable userTable )
{
    string userName = filterContext.HttpContext.User.Identity.Name;

    var query = userTable.Where( this.UserNameProperty + "=@0", userName )
                         .Select( this.UserSelectionProperty );

    object userIdentifer = null;
    foreach (var value in query)
    {
        userIdentifer = value;
        break;
    }
    return userIdentifer;
}

private IQueryable GetTable( DataContext context, string name )
{
    PropertyInfo info = context.GetType().GetProperty( name );
    if (info != null)
    {
        return info.GetValue( context, null ) as IQueryable;
    }
    else
    {
        return null;
    }
} 
```

# mysql - 比较难的mySQL问题

> ID：447470
> 
> 赞同：1
> 
> 时间：2009-01-15T16:31:29.957
> 
> 标签：mysql, mysql-management

我的一个朋友在使用大型 mySQL 数据库时遇到问题，并且在多个表中存在大量重复列。

为了更好地描述问题，该数据库提供多种服务，如 FTP、Postfix、webmail，几乎所有您将在通用 Linux 服务器上运行的常见服务，所有这些服务都使用这个数据库。问题是大多数服务不知道如何从多个表中读取，因此如果您使用多个表条目，如用户名、密码，则必须在这些特定于服务的表中重复开关。兴前。UserProfile 表包含所有用户相关数据。（用户名、密码）ACL 表包含与访问相关的数据（AccountEnabled、FTPEnabled、AccessType） FTP 表包含与 FTP 相关的数据（配额、目录等）我想你明白了……所以如果我需要 ftp 服务，我必须阅读UserProfile 表、ACL 表和 FTP 表，但由于我无法从多个表中读取，

现在他们正在尝试创建一个应用程序来管理所有这些服务，您可以想象到现在这一直是手工完成的，并且服务器正在为数百个用户提供服务。所以，现在他们正试图创建一个管理所有这些表的管理界面。问题是必须写入的 30% 是重复数据。前任。用户名和密码必须在不同的表中写入 6 次。

有没有可能用“符号链接”或类似的东西创建一个表？这样您就可以将所有数据都放在一个临时表中，所有服务都可以访问并动态更新。或者有没有其他“聪明”的方法，你能想到，让这一切变得更容易？

提前感谢您的时间，标题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T16:34:55.647

您要查找的内容称为[VIEW](http://dev.mysql.com/doc/refman/5.0/en/create-view.html)。

这样，您就可以拥有一个包含所有信息的中央表，每个应用程序一个视图，结构正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T16:34:46.223

为什么服务不能访问多个表？

如果您真的想“符号链接”表格，请查看视图。

# sql-server - 在 DB 之间导出/导入存储过程

> ID：447472
> 
> 赞同：1
> 
> 时间：2009-01-15T16:31:45.323
> 
> 标签：sql-server, database, sql-server-2005, stored-procedures, migration

我有两个 SQL Server 2005 数据库，一个用于开发，另一个用于最终生产服务器。我想知道确保生产数据库具有完全相同的存储过程（编号和最新版本）的最快方法。

假设：

1.  数据库具有相同的表模式。

2.  生产数据库目前正在使用，并且比开发数据库具有更新的数据

3.  开发数据库具有生产数据库中不存在的存储过程

4.  开发数据库不再具有当前在生产数据库中找到的 [过时] 存储过程。

5.  开发数据库的存储过程版本比当前在生产数据库中找到的版本更新。

编辑：注意两个数据库的服务器不在同一个网络上，生产数据库在客户端的防火墙后面（我们与服务器建立了 VPN，可以远程桌面）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T16:41:21.903

[Redgate 的 SqlCompare](http://www.red-gate.com/products/SQL_Compare/index.htm)是一个很好的工具。

它基本上为您提供了两个数据库之间所有存储过程和架构差异的差异，并让您可以选择同步一组选定的差异，或生成一个脚本来做同样的事情。

# html - 将 .asp 文件包含到 html 文件中

> ID：447477
> 
> 赞同：3
> 
> 时间：2009-01-15T16:32:43.107
> 
> 标签：html, asp-classic, include, ssi

除了必须用 asp 处理所有 html 文件之外，如何在 html 文件中包含 .asp 文件并对其进行处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T16:44:14.300

您可以使用 IFRAME 标签……但这有点糟糕。我会按照[Phantom Watson](https://stackoverflow.com/users/52530/phantom-watson)所说的去做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T16:42:10.903

我不完全确定你在问什么。如果您尝试将 .asp 文件包含到 .html 文件中，我认为这是不可能的。如果将文件的扩展名更改为 .shtml，则可以将以下行放入 HTML 文件中：

```
<!--#include virtual="path to asp file/include-file.asp" --> 
```

现在，是否解析 ASP 或显示代码必须由比我更了解服务器解析的人来解决。

更好的解决方案是将一个 ASP 文件包含到另一个 ASP 文件中。如果您想要页面包含等功能，那么为您的文件提供 .html 或 .shtml 扩展名只会让您更难完成您正在尝试的事情。

**基本上，将 .asp 用于您想要解析的文件，将 .html 用于可以按原样提供给用户的文件。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T12:00:15.677

您可以更改可执行扩展名，因此，如果需要，您可以使 .html 可执行，以便您可以包含文件或执行其他任何操作。转到 IIS 管理器（运行->inetmgr），在选项卡下选择站点的属性主目录'按'配置..'您可以在那里添加扩展名和可执行文件（您可以插入与.asp中相同的内容）

但我不认为这是一个最佳选择 :) 如果它是可执行的，它应该是 .asp，如果不是 - html

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-30T13:36:49.387

可能的解决方案之一是将页面的扩展名从 .html 更改为 .asp，因为它不会影响您的页面及其执行。然后您可以正常包含 .asp 文件，就像我们将其包含在 .asp 文件中一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-25T19:32:49.503

我知道这是一个老问题，但对于那些感兴趣的人来说，如果你编码正确，就有一个解决方案，我想出了如何通过我所做的一些测试来解决这个问题。我得到了它的工作编码版本，所以我知道它有效，但我会尝试解释它。

假设您有页眉、导航栏或页脚（Boris 在他的评论中提到的版权年份/信息的通常位置）。然而，您不想更改其中许多文件的 .html / .htm 文件扩展名，因为所涉及的链接以及其他站点是否链接到您的网站。

尽管对于 Boris 来说它只是每个文件的页脚，但简单的方法是将以下内容放入您的 html 文件中放置页脚代码的位置。

```
<script type="text/javascript" src="Footer.asp"></script> 
```

这是它的第一部分，下一部分是在页脚 ASP 文件中使用 JavaScript，如下所示：

```
var Code ='';
Code+='your html here';
Code+='more html here if needed';
document.write(Code); 
```

您甚至可以将函数放在 var 之上，这些函数将与您在以下内容中的任何内容一起使用：`Code+='your html here';`现在，在这段代码中，您可能拥有例如：`Code+='<form id="UserSignUp" name="UserSignUp" method="post" action="AddUser.asp">';`并且您可以说例如将用户添加到数据库。

但在 Boris 的情况下，它是版权年，所以在同一个 Footer.asp 文件中，您有几个选项。在其中，`Code+='your html here';`您可以使用您制作/发现的代码逐年更新，或者您可以每年仅在一个文件上手动更新一次。

然而它引出了一个问题，为什么你不首先在版权年使用 JavaScript，`document.write();`而是在 Footer.js 文件中使用 JavaScript。除非您的版权年份代码在 ASP 中？

在这种情况下，在 JavaScript 函数上方的 Footer.asp 文件中，只需添加您的 ASP 代码，例如：`rsYear("CopyrightYear") = Now`以及您可能需要的其余 ASP 代码。

在 JavaScript 中添加以下内容：

`Code+='<script>document.write("Copyright: <%=rsYear("CopyrightYear")%>");</script>';`

# java - 如何使用 Hibernate for Java 将 CHAR(1) 映射到布尔值？

> ID：447478
> 
> 赞同：7
> 
> 时间：2009-01-15T16:32:43.857
> 
> 标签：java, hibernate

如何使用 Hibernate for Java 将 CHAR(1) 映射到布尔值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T16:38:33.440

`true_false`or`yes_no`类型将为您执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T16:38:52.360

CharBooleanType 可能是您正在寻找的[http://www.hibernate.org/hib_docs/v3/api/org/hibernate/type/class-use/CharBooleanType.html](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/type/class-use/CharBooleanType.html)

编辑：如果您只想开始使用字符 y/n 或 t/f，dtsazza 的答案可能更有用。如果这些与您的用法不匹配，您可以使用 CharBooleanType 实现您自己的类型。

# java - 如何使用 JProgressBar 显示文件复制进度？

> ID：447481
> 
> 赞同：3
> 
> 时间：2009-01-15T16:33:55.350
> 
> 标签：java, jprogressbar

我正在做一个通过网络传输文件的项目，我想合并一个`JProgressBar`来显示文件传输过程中的进度，但我需要帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T17:42:27.190

您可能会发现 ProgressMonitorInputStream 最简单，但如果这对您来说还不够，请查看它的源代码以获得您想要的内容。

```
 InputStream in = new BufferedInputStream(
                     new ProgressMonitorInputStream(
                              parentComponent,
                              "Reading " + fileName,
                              new FileInputStream(fileName)
                     )
                  ); 
```

要使用不同的传输方法，请用适当的流替换 FileInputStream。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T22:59:24.023

```
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.URL;
import java.net.URLConnection;
import javax.swing.JProgressBar;

....

public OutputStream loadFile(URL remoteFile, JProgressBar progress) throws IOException
{
    URLConnection connection = remoteFile.openConnection(); //connect to remote file
    InputStream inputStream = connection.getInputStream(); //get stream to read file

    int length = connection.getContentLength(); //find out how long the file is, any good webserver should provide this info
    int current = 0;

    progress.setMaximum(length); //we're going to get this many bytes
    progress.setValue(0); //we've gotten 0 bytes so far

    ByteArrayOutputStream out = new ByteArrayOutputStream(); //create our output steam to build the file here

    byte[] buffer = new byte[1024];
    int bytesRead = 0;

    while((bytesRead = inputStream.read(buffer)) != -1) //keep filling the buffer until we get to the end of the file 
    {   
        out.write(buffer, current, bytesRead); //write the buffer to the file offset = current, length = bytesRead
        current += bytesRead; //we've progressed a little so update current
        progress.setValue(current); //tell progress how far we are
    }
    inputStream.close(); //close our stream

    return out;
} 
```

我很确定这会奏效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T17:22:41.930

听起来您应该使用[`SwingWorker`](http://java.sun.com/javase/6/docs/api/javax/swing/SwingWorker.html).，如[本核心 Java 技术提示](http://blogs.oracle.com/CoreJavaTechTips/entry/making_progress_with_swing_s)中所述。另请参阅[使用 Swing 工作线程](http://java.sun.com/products/jfc/tsc/articles/threads/threads2.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T16:38:52.813

那么[这里](http://java.sun.com/docs/books/tutorial/uiswing/components/progress.html)是 JProgressBar 的教程，也许会有所帮助。

# c# - 在同一页面上使用两个用户控件？

> ID：447484
> 
> 赞同：2
> 
> 时间：2009-01-15T16:34:15.537
> 
> 标签：c#, asp.net, user-controls

我在母版页中有一个用户控件，并且直接在 aspx 中有相同的用户控件。母版页中的用户控件工作正常，但是当我尝试直接嵌入在 aspx 页面中的用户控件时，它不起作用。用户控件是 2 个带有登录按钮的文本框。看起来它试图做的是，当我输入嵌入式用户控件的用户名和密码时，它看到母版页中的用户控件文本框是空白的并且它会抱怨。有没有办法正确处理这个问题？

未调用直接嵌入在页面中的用户控件的事件处理程序。

这是登录控件的按钮：

```
<asp:ImageButton ID="ibtnLoginButton" runat="server" CommandName="Login"   
ImageUrl="~/images/sign-in.png"
ValidationGroup="ctl00$Login1" OnClick="LoginButton_OnClick"
meta:resourcekey="LoginButtonResource1" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T17:00:43.237

如果没有更多信息，很难准确判断问题出在哪里。

根据您的说法，可能是客户端验证启动。如果是这种情况，您可以将控件上的 ValidationGroup 设置为 UserControl 的 ID。然后 UserControl 的同一实例上的控件将具有相同的验证组，因此作为一个单元进行验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T17:00:42.817

听起来您的控件正在共享一个 ValidationGroup - 您可以发布一些代码以便我们查看吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T17:03:18.473

问题必须在您的自定义用户控件中，该控件似乎无法正确处理它可以在同一页面中多次使用的事实。

它通常是由编写不当的 JavaScript 或用户控件的每个实例的 ValidationGroup 属性相同引起的。

# networking - 如何修改多播 TCP/IP 数据包的 TTL？

> ID：447500
> 
> 赞同：1
> 
> 时间：2009-01-15T16:36:52.943
> 
> 标签：networking, multicast, ttl

我支持发送 TTL 为 1 的多播数据包的第 3 方应用程序。我们无法修改应用程序，但需要更高的 TTL 才能将数据包路由到另一个客户的网络。是否有网络设备或 windows (server 2003) 应用程序可以让我修改它？

在这种情况下，有没有更好的方法来连接发送方和接收方？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T20:24:43.280

Linux netfilter，更广为人知的 iptables 命令：

TTL mangeling 被记录为“扩展”，但它似乎已经包含在流行的 Linux 发行版中。

从手册页（man iptables）：

## TTL

这用于修改 IPv4 TTL 标头字段。TTL 字段决定了一个数据包可以经过多少跳（路由器），直到超过它的生存时间。设置或增加 TTL 字段可能非常危险，因此应不惜一切代价避免。永远不要设置或增加离开本地网络的数据包的值！

**破坏**表：

`--ttl-set value`- 将 TTL 值设置为“值”。

`--ttl-dec value`- 将 TTL 值 'value' 次递减。

`--ttl-inc value`- 增加 TTL 值“值”倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T17:53:32.960

它在发送主机上是可行的（例如，使用 ipfw 并在 FreeBSD 上转移；我不知道 MS-Windows 的等价物）但可能比它值得付出更多的努力。

一个简单的选择可能是使用 VPN（虚拟专用网络）使应用层看起来发送和接收主机位于同一（虚拟）网络上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T01:18:46.273

您可以查看[mTunnel](http://staff.www.ltu.se/~peppar/progs/mTunnel/)，它用于隧道多播流量。

# django - 如何覆盖 Django 的管理更改密码页面？

> ID：447512
> 
> 赞同：9
> 
> 时间：2009-01-15T16:39:01.330
> 
> 标签：django, django-admin

我想覆盖 Django 的管理“更改密码”页面 (change_password.html)。因此，我已将 Django 的“/contrib/admin/templates/registration/password_change_form.html”放在我项目的“/templates/admin/registration/password_change_form.html”目录中。不幸的是，这似乎没有奏效。

在这一点上，我难住了。我猜它与 Django 的 /contrib/auth/urls.py 文件有关（它将管理员更改密码调用定向到“django.contrib.auth.views.password_change”），但管理模板更改是微不足道的到目前为止，我很惊讶这个没有效仿。

有什么想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-13T15:08:34.040

您必须使用：

```
templates/registration/password_change_form.html 
```

**如果您仍然看到 Django 的 Admin 模板**，则必须更改您的顺序`INSTALLED_APPS`（例如，如果您的模板在某个应用程序中，则此应用程序必须出现在`django.contrib.admin`之前`INSTALLED_APPS`）

[https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.views.password_change](https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.views.password_change)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-15T16:46:58.647

快速查看源代码表明您应该将模板放置在：

```
/templates/registration/password_change_form.html 
```

注意：那里没有“管理员/”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-01T05:36:02.790

我有同样的问题; 我相信它必须完成 django 模板加载器的工作方式。

如果您使用类似的东西

```
TEMPLATE_LOADERS = (
'django.template.loaders.filesystem.Loader',
'django.template.loaders.app_directories.Loader',
) 
```

使用类似 TEMPLATE_DIRS = ( os.path.join(PROJECT_DIR, 'templates'), )

然后您会期望（其中 localstore 是您的本地 satchmo 覆盖的名称）localstore/templates/registration/password_change_form.html 会起作用。但是，它不适用于 password_change_form，因为管理员正在覆盖它。所以，它是这样的：

1.  文件加载器模板目录（例如模板）
2.  （django 管理模板）
3.  本地应用模板目录

因此，我的解决方案是将我的注册模板覆盖从我的 localstore/templates 目录移动到项目的 /templates 目录。

# wcf - 在 IIS6 上托管 WCF，是否需要任何特殊设置？

> ID：447515
> 
> 赞同：16
> 
> 时间：2009-01-15T16:39:46.337
> 
> 标签：wcf, configuration, iis-6

托管 WCF 服务是否需要在 IIS6 上进行任何特殊配置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T19:14:20.410

[对于您的问题，这](http://blogs.msdn.com/amitlale/archive/2007/05/21/hosting-wcf-service-in-iis.aspx)是一篇非常方便的博客文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-25T09:47:57.013

您可以使用 WCF 的 ServiceHostReg：

该工具可以在以下位置找到：

```
%SystemRoot%\Microsoft.Net\Framework\v3.0\Windows Communication Foundation\ 
```

命令行是：

```
ServiceHostReg /x /i 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-03T11:56:13.617

步骤1）VirtualDirectoryName->Properties->Virtual Directory Tab->Configuration Button->

插入新的通配符映射 C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll 取消选中验证文件是否存在

第2步）

VirtualDirectoryName->Properties->Directory Security Tab->Authentication and access control->Edit Button->

取消选中集成 Windows 身份验证

Step3) 重置 IIS

# unit-testing - 如何编写模拟对象？

> ID：447516
> 
> 赞同：3
> 
> 时间：2009-01-15T16:39:48.647
> 
> 标签：unit-testing, mocking

我的第一份编程工作向我介绍了单元测试和模拟对象的概念，但总觉得有些不对劲。

假设我们正在编写一个银行应用程序，并且需要模拟一个 BankAccount 对象：

```
 // boilerplate code
    public interface IBankAccount {
        void Deposit(int amount);
        void Withdrawal(int amount);
        int getBalance();
        int getAccountNumber();
    }

    public interface IBankAccountFactory {
        IBankAccount getAccount(int accountNumber);
    }

    public class ProductionBankAccountFactory implements IBankAccountFactory { 
        public IBankAccount getAccount(int accountNumber) {
            return new RealBankAccount(accountNumber);
        }
    }

    public class MockBankAccountFactory implements IBankAccountFactory {
        public IBankAccount getAccount(int accountNumber) {
            return new MockBankAccount(accountNumber);
        }
    }

    public static class BankAccountFactory {
        // ewww, singletons!
        public static IBankAccountFactory Instance;
    }

    // finally, my actual business objects
    public class MockBankAccount implements IBankAccount {
        public MockBankAccount(int accountNumber) { ... }
        // interface implementation
    }

    public class RealBankAccount implements IBankAccount {
        public RealBankAccount(int accountNumber) { ... }
        // interface implementation
    } 
```

每个班级都有一个目的：

*   工厂和工厂接口的存在是为了将构造函数包装到我们的模拟对象和真实对象中。
*   静态 BankAccountFactory 类允许我们`BankAccountFactory.Instance`分别在生产应用程序或测试开始时分配 IRealBankAccountFactory 或 MockBankAccountFactory 的实例。
*   一旦一切设置正确，任何类都可以简单地通过调用来获取 IBankAccount 的实例：

```
 BankAccountFactory.Instance.getAccount(accountNum); 
```

这可行，但会导致*大量*样板代码。我不应该为每个要模拟的类编写 5 个新类。我相信有一种更简单的方法，所以我不得不问 SO 社区：

**是否有更好或首选的方式来编写模拟对象？**

*[编辑添加：]*我很欣赏到模拟和 DI 框架的链接，但现在我正在开发一个 500 KLOC 应用程序，并且至少 60% 的代码由上述样式的样板模拟类组成。

我只是想减少代码库的大小，而不需要为 Yet-Another-Framework™ 重新编写大量代码，所以它可以帮助我更多地看到手工编写的模拟类。:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T16:45:41.613

更好的方法是让别人写。这里的一些选项是：

起订量 - [http://code.google.com/p/moq/](http://code.google.com/p/moq/)

犀牛模拟 - [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T16:55:13.030

我想我的第一个问题是为什么需要使用工厂模式来包装对象的构造；特别是您的 Mock 对象。由于套件中的每个单元测试都应该完全独立于任何其他单元测试运行，因此您似乎可以直接在单元测试类的 setUp 方法中，甚至在测试本身中实例化您的 MockBankAccount。如果我处于上述情况，我会写这样的东西：

```
public interface IBankAccount {
    void Deposit(int amount);
    void Withdrawal(int amount);
    int getBalance();
    int getAccountNumber();
}

public class MockBankAccountFactory implements IBankAccountFactory {
    public IBankAccount getAccount(int accountNumber) {
        return new MockBankAccount(accountNumber);
    }
}

public class BankAccountUnitTest extends TestCase {
    IBankAccount testBankAccount;

    public void setUp() {
        testBankAccount = new MockBankAccount(someAccountNumber);
    }

    // Unit tests here
} 
```

如果您使用工厂来对另一个*使用*IBankObject 的类进行单元测试，那么您应该研究[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)来为该类提供一个模拟对象，而不是让被测试的类实例化一个模拟对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:47:04.077

有一些 Mock 库通过允许您在单元测试代码中指定对象及其行为来简化该过程。

一个很好的例子是 Moq 库 ( [http://code.google.com/p/moq/](http://code.google.com/p/moq/) )

# wcf - SOA 或 WCF 的反模式

> ID：447518
> 
> 赞同：21
> 
> 时间：2009-01-15T16:40:18.897
> 
> 标签：wcf, soa

虽然我可以找到很多提倡 SOA 或 WCF 的文章，但我的问题是，什么不应该作为服务公开，我们从 SOA 失败中学到了什么。WCF 是实现 SOA 的一种方式，如果我们使用 WCF，是否意味着我们正在实现 SOA。肯定有很多人使用 C# 编写无法维护的代码。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-29T19:54:12.077

我觉得你是对的。在我当前的任务（Web 开发）中，对数据库的每一次访问都是作为服务实现的。正如首席架构师所说，我们是“纯 SOA”……哇！

事实上，这给一切增加了很多复杂性。当我想读取一个简单表格的内容时，我必须生成 8 个项目、42 个文件、8 个程序集，可能还有 9 个配置文件！

正如我所说，很多复杂性。有可能某个地方的某个人会忘记一个文件……将简单的流程公开为服务是愚蠢的。

在我的书中，您应该在以下情况下将流程公开为服务：

*   许多使用不同语言和框架的应用程序必须调用你的东西。
*   涉及的平台不止一个（Windows、Unix ...）。
*   正在处理的数据是企业的核心。

另外，请注意必须将服务设计为服务，并且设计服务至少与设计库一样复杂：必须精心设计错误捕获，日志必须足够灵活，文档必须完整等。

好吧，正如我所看到的，我每天使用的大部分服务都不会被其他人使用：没有文档、错误处理能力差、代码经常更改、第二区数据……

非常有趣的问题。1分:o)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-15T16:56:45.430

SOA 作为一个概念是一个好主意。

使用 HTTP-WS/BPEL 等实现的 SOA 是一个笑话，在我不那么谦虚的观点中应该死掉。在得知分布式事务的唯一概念是补偿事务后不久，我就不再认真对待系统了... bzzt NEXT！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-10T04:46:41.033

我知道有两种主要的反模式：

*   通过服务层直接从业务层公开对象
*   公开特定的细粒度方法，例如业务层中的方法

建议您的服务层包含粗粒度的通用方法，并让它们接受和返回较大的基于消息的请求和响应。目标是提供一个相当通用的接口，而不会对服务的使用方式做太多假设，也不需要大量调用来实现基本功能。尽量减少 Web 服务调用的次数。

以下是一些高水平的优秀建议：[http ://apparchguide.codeplex.com/Wiki/View.aspx?title=Chapter%2013%20-%20Service%20Layer%20Guidelines](http://apparchguide.codeplex.com/Wiki/View.aspx?title=Chapter%2013%20-%20Service%20Layer%20Guidelines)

这是指南正在谈论的“消息”类类型的具体示例，以及如何在 WCF 中实现一个：http: [//dotnet.org.za/hiltong/pages/windows-communication-foundation-tutorial-part -3-messaging-messagecontracts.aspx](http://dotnet.org.za/hiltong/pages/windows-communication-foundation-tutorial-part-3-messaging-messagecontracts.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-11-24T04:21:19.623

我发布了一些 SOA 反模式

*   [事务集成反模式](http://arnon.me/wp-content/uploads/2010/10/TransactionalIntegration.pdf)
*   [Knot 反模式](http://rgoarchitects.bit.ly/5VvPNT)
*   [纳米服务反模式](http://arnon.me/wp-content/uploads/2010/10/Nanoservices.pdf)

关键是很多人认为 SOA 将 Web 服务前端置于逻辑之前，而忘记了由此产生的 RPC 的含义（也称为[分布式计算的谬误](http://blogs.oracle.com/jag/resource/Fallacies.html)）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-31T02:25:43.830

SOA 是最糟糕的概念之一。SOA 是一种架构风格，与 Web 服务或任何技术无关。我同意通过 Web 服务和 BPEL 解释 SOA 显然是一种误导，BPEL 通常与 SOA 无关，而是一种实现 WS 编排的方式。供应商把它弄得一团糟。

我推荐一本非常不错的可下载书籍，它真正解释了 SOA 是什么：

[http://www.infoq.com/minibooks/enterprise-soa](http://www.infoq.com/minibooks/enterprise-soa)

然后你可以阅读[这个有趣的博客条目](http://www.thinkovation.com/blog/index.php/2009/01/14/soa-dude-its-alive-and-kicking/)

问候

# c++ - 如果 numeric_limits，推荐的解决方法是什么 ::has_infinity 是假的？

> ID：447520
> 
> 赞同：2
> 
> 时间：2009-01-15T16:40:54.353
> 
> 标签：c++, linux, double, limit, infinity

我需要在 Linux 上的 C++ 应用程序中检查无穷大的双精度值。在大多数平台上，这通过与`std::numeric_limits<double>::infinity()`. 但是，在某些旧平台上（例如 RedHat 9，使用 gcc 3.2.2），这是不可用的，并且`std::numeric_limits<double>::has_infinity`在那里是错误的。

您会为这些平台推荐什么解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T17:06:04.570

如果您使用 IEEE 754 算术，几乎可以肯定的是，无穷大是定义明确的值，并且为所有算术运算定义了结果。尤其，

```
infinity - infinity = NaN 
```

正负无穷大和`NaN`值是唯一正确的值。NaN 是特殊的“非数字”值，用于指示函数的域错误，例如`sqrt(-1)`. 还：

```
NaN != NaN 
```

`NaN`s 是唯一正确的值。

所以：

```
bool is_infinite(double x) {
    double y = x - x;
    return x == x && y != y;
} 
```

当且仅当`x`是正无穷或负无穷时才会返回真。`x > 0`如果您只想检查正无穷大，请添加一个测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T16:44:11.820

在大多数情况下，std::numeric_limits::max() 可以有效替代 std::numeric_limits::infinity()。

但是，您必须更加小心地使用它。对于溢出，我相信如果检测到溢出，您将不得不手动检测溢出并将结果显式设置为最大值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T10:13:50.690

好的，我现在已经在该特定机器上使用`INFINITY`and`NAN`宏 - 似乎工作正常。他们来自`math.h`.

# jquery - JQuery 初学者: :has 仅适用于直系后代

> ID：447525
> 
> 赞同：1
> 
> 时间：2009-01-15T16:41:52.013
> 
> 标签：jquery

假设树结构如下：（丑陋的遗留布局，抱歉）

```
<tr>                          (1) dont want to select this one  
   <td>
       <table>
           <tr>               (2) not a "special" td, dont select       
               <td.normal>        
           <tr>                (3) this is what I want to select
               <td.special>       
           <tr>
               <td.normal> 
```

我想选择具有类 special 的 td 作为直系后代的 tr，即只有 (2)，而不是 (3) [它的 td 不是特殊的]，也不是 (1) [特殊的 td 不是直系后代，而是一个“孙子”]

我试过了

```
$("tr:has(td.special)"); 
```

但这给了我（1）和（2），因为 :has 的意思是“在我所有的后代中都有某个地方”。

我需要的是类似 :has 的东西，但意思是“在我的直系子女中拥有”。

或者，一种向上横向的方法，例如“仅选择当前选定元素的父元素”。

很抱歉这个简单的问题，但我似乎无法在 API 文档的任何地方找到它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T16:51:40.447

你试过`$("td.ptextno:contains('Betreuung')").parent()`吗？

编辑：看起来问题的例子改变了......尝试`$("td.special").parent()`
编辑2：你知道，关于遍历的文档在这里：[http ://docs.jquery.com/Traversing](http://docs.jquery.com/Traversing)

# javascript - jQuery Validation 插件：如何检查元素是否有效？

> ID：447537
> 
> 赞同：20
> 
> 时间：2009-01-15T16:46:50.443
> 
> 标签：javascript, jquery, jquery-validate

一点上下文：

我正在使用*jQuery Validation 插件*来验证注册表单。我现在想实现一个**ajax 调用来检查用户名在系统中是否可用**，并且我只想在 userName 值是根据设置的规则有效的情况下进行这个 ajax 调用`$(form).validate();`

我想要类似的东西：

```
$("#userName").keyup(function () {
    if ($("#userName").isValid()) {
        //make ajax called
    }
}); 
```

我搜索了文档，但我无法确定我的问题的解决方案。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2011-04-25T13:50:45.070

```
$("#userName").keyup(function () {
    if ($("#userName").valid() == true ) {
        //make ajax called
    }
}); 
```

[http://docs.jquery.com/Plugins/Validation/valid](http://docs.jquery.com/Plugins/Validation/valid)

*注意：*给那些没有点击链接的人。你必须先打电话`$("#myform").validate();`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-10-28T10:33:09.030

验证器.element()

> 说明：验证单个元素，如果有效则返回 true，否则返回 false。

[http://jqueryvalidation.org/Validator.element](http://jqueryvalidation.org/Validator.element)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-06-06T18:45:59.807

这在 JQuery 1.11 上对我有用

```
$("#userName").keyup(function () {
    if ($(this)[0].validity.valid) {
        // AJAX here
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-01T16:32:36.633

您好，我找到了独家解决方案，我和其他 47k 人有同样的问题，我发现没有其他 jquery 插件或库的解决方案：-首先我们需要在变量中注册我们的输入，-然后更改 checkValidity() 如果为真：意思是如果有效，我们将注册的 var 分配给我们的输入以将其休息以进行下一次更改。

```
 ivar=$('input[name="y-i-name"]')[0];
        $('input[name="y-i-name"]').on('change',function(){
             if($('input[name="y-i-name"]')[0].checkValidity()){

                     // your custom code here!

                     $('input[name="y-i-name"]')[0]=ivar; // & now we rest the input for next change validation
             }
        }); 
```

# html - 如何在 TD 元素中垂直对齐图像和文本？

> ID：447539
> 
> 赞同：18
> 
> 时间：2009-01-15T16:46:53.953
> 
> 标签：html, alignment, html-table

```
<td>
<img src="http://blog.garethjmsaunders.co.uk/wp-content/feed-icon-16x16.gif"/>
 My feed
 </td> 
```

这是它的样子：

[![](https://i.stack.imgur.com/tnWYq.gif)](https://i.stack.imgur.com/tnWYq.gif)
[（来源：[garethjmsaunders.co.uk](http://blog.garethjmsaunders.co.uk/wp-content/feed-icon-16x16.gif)）]
我的饲料

图标和文本垂直错位。图标位于表格单元格的顶部，文本位于底部。文本和图标都占用 16 个像素，但单元格仍然占用 19 个像素。如何对齐它们以节省这 3 个像素？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-15T17:14:42.680

好吧，如果你选择背景图片的方式，那么就很简单了：

```
background: url(feed.png) left center no-repeat 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-15T17:08:36.000

图像与文本的基线对齐，这不包括下降高度，即 g 或 y 等字母中的“刻度”。

如果要固定行/单元格的高度，您可以添加 line-height 以使其垂直居中。例如，假设你的单元格是 16px 高：

```
td.feed {
    line-height:16px;
} 
```

另一种选择是将图标添加为背景图像，将 padding-left 添加到单元格：

```
td.feed {
    background: transparent url(/wp-content/feed-icon-16x16.gif) no-repeat left center;
    padding-left: 18px; /* width of feed icon plus 2px spacing */
} 
```

第二个意味着您可以完全消除对表格的需求，现在有一个想法......

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T19:53:39.443

其他说明图像不应成为内容的一部分而仅用于装饰的答案，这是值得商榷的。我确实认为您应该`alt`为图像添加一个空属性，以便屏幕阅读器在您选择保留当前方法时可以忽略该图像。

该`vertical-align`属性是您需要在此处使用的属性，但您要使用的是`text-bottom`. 我还将假设您希望这是一个链接，所以这里有一个完整的代码示例：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>garethjmsaunders.co.uk</title>
    <style type="text/css">
    a { text-decoration: none; }
    a img { border: 0; vertical-align: text-bottom; }
    </style>
  </head>
<body>
<table>
<tr>
<td>
  <a href="" title="garethjmsaunders.co.uk rss feed">
    <img alt="" src="http://blog.garethjmsaunders.co.uk/wp-content/feed-icon-16x16.gif" />
    My feed
  </a>
</td>
</tr>
</table>
</body>
</html> 
```

如果这仍然不理想，您可以尝试使用`line-height`其他值`vertical-align`来查看最适合您的值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T18:45:10.860

将其设置为背景图像有什么问题？

```
.feed {
  background: transparent url("http://blog.garethjmsaunders.co.uk/wp-content/feed-icon-16x16.gif") no-repeat scroll left center;
  padding-left: 16px;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T20:01:50.720

试试这个：

```
<td>
   <img src="http://blog.garethjmsaunders.co.uk/wp-content/feed-icon-16x16.gif"/>
   <span class="feedTxt">My feed</span>
 </td>

 .feedTxt { line-height: 20px; } /* Or whatever the height of the image is.  Adjust as needed. */ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T17:03:12.703

只需在 IMG 标签上尝试“垂直对齐：中间”，之后您还可以为 TD 设置填充

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-10-11T05:39:13.797

我尝试了背景图像的方法，但并不像这样喜欢它......

在 CSS...

```
.iconLabel {
    position: relative;
    top: -6px;
    padding-left: 8px;
} 
```

在页面...

```
<td style="text-align:center;">
    <a href="overview.cfm"
        ><img alt="Overview" src="Globe.png" 
        align="middle" border="0" height="60" width="60"
        ><span class="iconLabel">Overview</span
    ></a> 
</td> 
```

*   使用**“top”**属性上下移动文本/标签。
*   使用**padding**属性来改变图标和文本/标签之间的水平间距。
*   您应该在您关心的任何浏览器上检查它，因为它们的渲染可能略有不同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-15T16:50:57.923

你可以`position: relative; top: 3px;`在`<img>`标签上做。您也可以尝试`vertical-align: middle;`使用`<td>`标签，但我认为它不会正常工作，因为我很确定我以前遇到过这种情况。您也可以将它们放在单独`<td>`的标签中，但这是一种禁忌。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T16:54:22.503

我会将这两个元素（图像和文本）放在各自单独的表格单元格中。您可以嵌套另一个表。这是一个很好的起点。然后你可以玩填充等来调整。

```
<td>
<table><tr style="vertical-align:top;"><td><img src="path_here" /></td><td>my feed</td></tr></table>
</td> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-10-05T22:03:23.990

您可以在 td 内添加一个表格，其中包含一行和两个 td

```
 <td>
        <table><tr>
            <td><img src="image/myimage.gif" alt="myimage.gif"/></td>
            <td>My text</td>
        </tr></table>
    </td> 
```

# c++ - ptr->你好（）；/* VERSUS */ (*ptr).hello();

> ID：447543
> 
> 赞同：12
> 
> 时间：2009-01-15T16:47:20.190
> 
> 标签：c++, operators, pointers, dereference

我正在学习 C++ 指针，而`->`操作符对我来说似乎很奇怪。而不是 `ptr->hello();`一个可以写`(*ptr).hello();`，因为它似乎也可以工作，所以我认为前者只是一种更方便的方式。

是这样还是有什么不同？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-15T16:49:50.577

-> 运算符**只是语法糖**，因为`(*ptr).hello()`它是要键入的 PITA。就在 ASM 级别生成的指令而言，没有区别。事实上，在某些语言中（想到 D），编译器会根据类型计算出所有内容。如果你这样做`ptr.hello()`，它就可以工作，因为编译器知道 ptr 是一个指针并且没有 hello() 属性，所以你必须是`(*ptr).hello()`.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-15T18:37:03.543

其他人已经回答了有关内置指针的问题。关于类，可以重载 operator->()、[operator&()](http://www.artima.com/cppsource/YourAddress.html)和 operator*()，但不能重载 operator.()。

这意味着对象可能会根据您调用的语法而有所不同。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-15T17:18:05.700

当您必须链接函数调用时，可读性方面的主要优势就出现了，即：

```
ptr->getAnotherPtr()->getAThirdPtr()->print() 
```

我什至不会费心用 * 运算符来做这件事。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-15T16:51:32.273

拥有操作员的唯一原因`'->'`是使其更方便并保存错误，例如：

```
*ptr.hello(); 
```

因为很容易忘记括号。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-15T16:51:21.137

它们生成完全相同的机器代码，但对我来说，ptr->arg() 比 (*ptr).arg() 更容易阅读。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T17:02:23.717

这些替代语法模式是从 C 中采用的，您可能会从[A Tutorial on Pointers and Arrays in C 中](http://home.netcom.com/~tjensen/ptr/pointers.htm)获得一些额外的理解，特别是第 5 章，[指针和结构](http://home.netcom.com/~tjensen/ptr/ch5x.htm)。

# c# - 从 C# 创建 Win32 事件

> ID：447546
> 
> 赞同：12
> 
> 时间：2009-01-15T16:47:34.137
> 
> 标签：c#, events, interop

我想从 C# 创建一个内核（又名事件）。

我是否必须互操作服务并包装本机 CreateEvent 函数，或者是否已经有一个 .NET 类可以完成这项工作？

我需要运行的函数应该是这样的： hEvent = CreateEvent ( NULL , false , false , "MyCSHARPEvent" );

这应该通知所有探测 forMyCSHARPEvent 事件的 procs。

如果需要包装函数，我如何将 SECURITY_ATTRIBUTES 结构从 C# 转换为 win32？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-15T16:50:57.970

看一下[EventWaitHandle](http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle.aspx)类。从 .Net 2.0 开始支持它并允许创建命名事件。它还支持设置事件安全性，具体取决于您使用的构造函数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-15T17:01:40.320

如果你仍然想使用互操作，你可以像这样定义函数：

```
[DllImport("kernel32.dll")]
static extern IntPtr CreateEvent(IntPtr lpEventAttributes, bool bManualReset, bool bInitialState, string lpName); 
```

和这样的结构（您可能必须弄乱 Pack 属性才能使其适合）：

```
[StructLayout(LayoutKind.Sequential)]
struct SECURITY_ATTRIBUTES{
  public int length;
  public IntPtr securityDesc;
  public bool inherit;
} 
```

此外，这是一个将所有内容组合在一起的[代码示例。](http://pinvoke.net/default.aspx/kernel32.CreateEvent)

# jquery - 如何使用 jQuery 找到所有只包含不间断空格的表格单元格？

> ID：447550
> 
> 赞同：1
> 
> 时间：2009-01-15T16:48:36.273
> 
> 标签：jquery

我只需要在表格中找到包含`&nbsp;`使用 jQuery 的单元格。

```
 <table>
      <tr>
           <td>&nbsp;</td>
           <td>Something</td>
           <td>something else</td>
           <td>&nbsp;</td>
     </tr>
    </table> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T17:05:17.673

快速猜测，也许是更好的方法

更新 - 感谢 Tomalak

```
var x = $('table tr td').filter( function(){
     return $(this).text() == String.fromCharCode(160); 
}) 
```

# c++ - 如何使用 C++ API 找出 Symbian 设备上可用的语言？

> ID：447556
> 
> 赞同：1
> 
> 时间：2009-01-15T16:50:29.140
> 
> 标签：c++, symbian, s60

有谁知道如何在运行时查询 Symbian（特别是 S60）设备已安装的显示语言列表？我已经能够查询语言集，但无论如何我还没有找到在运行时获取该集的语言。

这需要是实际的语言代码（即，英国英语的 ELangEnglish，美国英语的 ELangAmerican 等），而不仅仅是电话上有任何英语变体。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T17:04:42.340

您可以查看[CPtiEngine 类参考](http://www.forum.nokia.com/document/Cpp_Developers_Library/GUID-759FBC7F-5384-4487-8457-A8D4B76F6AA6/html/classCPtiEngine.html)。直接从页面引用：

> 这是 PtiEngine API 的主要类。这是 PtiEngine 的主要客户端 API。PtiEngine API 的目的是为所有低级（在 UI 之下）文本输入功能提供单个调用点。API 提供了查询和激活已安装语言、更改输入模式和文本大小写以及执行实际文本输入操作的方法。

# php - PHP 邮件对主题行进行编码

> ID：447560
> 
> 赞同：13
> 
> 时间：2009-01-15T16:51:12.260
> 
> 标签：php, email, encoding

当我尝试从 PHP 发送 HTML 编码的电子邮件时，如果主题行包含特殊字符，例如`"Here's the information you requested"`，PHP 会将其编码为`"Here&#039;s the information you requested."`

我该如何解决？

* * *

下面是使用 PHP mail() 的代码：

```
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

$headers .= 'To: ' . $mod_params['name'] . '<' . $mod_params['email'] . '>' . "\r\n";

$headers .= 'From: <do_not_reply@a4isp.com>' . "\r\n";  

$email_to = $mod_params['email'];

$email_sub = "Here's the Information You Requested";

$body = html_entity_decode("<html><body>" . $email_html_body . "</body></html>");

mail($email_to,$email_sub,$body,$headers); 
```

它给出了与通过 SugarPHPMailer 类运行它相同的错误。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2011-06-25T18:12:25.637

尝试这个：

```
 $newsubject='=?UTF-8?B?'.base64_encode($subject).'?='; 
```

通过这种方式，您无需依赖 PHP 或 MTA 的编码，您就可以完成这项工作，并且邮件客户端应该能够理解它。您的新主题中不会出现特殊字符，因此在发送电子邮件时不会出现任何问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-03-26T16:11:25.847

我在正在开发的一个 Wordpress 插件中遇到了类似的问题，我绞尽脑汁一遍又一遍地尝试从这里和其他各种谷歌搜索结果中获得不同的建议。我终于找到了一个适合我情况的解决方案，所以我会分享它。我会说这是我最初尝试过的 Paul 的解决方案，但没有奏效，但原因是我试图“速记”解决方案。就我而言，仅调用 html_entity_decode() 不起作用。为什么？如果我更仔细地阅读了 PHP 文档，那将是显而易见的。我的问题是在单引号上进行编码，而 html_entity_decode() 的默认值是 'ENT_COMPAT' ，它只留下单引号。解决方案是设置所有参数并且有效。实际上，自从我编码 UTF-8 以来，我可能已经放弃了字符集，但我认为我是彻底的。

```
$decoded_str = html_entity_decode (  $value_to_decode, ENT_QUOTES, 'UTF-8' ); 
```

这里的课程很好，“阅读文档”。我并不是说你没有（你可能做到了），但我们中的很多人都匆匆忙忙地掩盖了解决方案，如果我们只看的话，它就坐在那里盯着我们的脸。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T16:59:39.247

如果字符串在您发送之前确实不包含编码值，请查看[以下](http://us2.php.net/manual/en/function.mail.php#80662)内容：

```
$subject= mb_encode_mimeheader($subject,"UTF-8", "B", "\n");
// or
$subject= mb_encode_mimeheader($subject,"UTF-7", "Q", "\n"); 
```

* * *

看看这些与 SugarCRM 相关的帖子：

*   [http://www.sugarcrm.com/forums/showthread.php?t=11940](http://www.sugarcrm.com/forums/showthread.php?t=11940)
*   [http://www.sugarcrm.com/forums/showthread.php?t=11106&highlight=iso-8859-1](http://www.sugarcrm.com/forums/showthread.php?t=11106&highlight=iso-8859-1)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-19T10:40:57.213

你应该使用[mb_encode_mimeheader](http://dk1.php.net/manual/en/function.mb-encode-mimeheader.php)，只记得之前设置。

```
mb_internal_encoding("UTF-8"); //has to be set (of course your internal encoding may not be UTF-8).
$subject = mb_encode_mimeheader($subject,'UTF-8','Q'); 
```

它会在需要时将编码处理为（人类可读的）Quoted-printable，并根据长度自动将主题分成适当数量的行。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-15T16:57:09.767

尝试通过[html_entity_decode()](http://php.net/html_entity_decode)运行主题行，看起来主题行中可能有一些实体。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-15T17:25:49.613

经常提交有问题的代码块将确保您更快地做出更好的响应。在此操作发生之前，您可能会在某处对文本进行编码。如前所述，您可以找出该操作并进行更正，或者您可以在发送电子邮件之前简单地解码主题行。

# javascript - 是什么导致此代码不起作用？

> ID：447561
> 
> 赞同：1
> 
> 时间：2009-01-15T16:51:14.847
> 
> 标签：javascript, closures

我试图理解为什么这不起作用。（尚未验证的基本示例）

当我测试它时，萤火虫状态 Product.addPage 没有找到。

```
var Product = function ()
{
    var Page = function ()
    {
        var IMAGE = '';

        return {
            image : function ()
            {
                return IMAGE;
            },
            setImage : function (imageSrc_)
            {
                IMAGE = '<img id="image" src="' + imageSrc_ + '" height="100%" width="100%">';
            }
        };
    };
    var PAGES = [];

    return {
        addPage : function ()
        {
            var len = PAGES.length + 1;
            PAGES[len] = new Page();
            return PAGES[len];
        },
        page : function (pageNumber_)
        {
            var result = PAGES[pageNumber_];
            return result;
        }
    };
};

// Begin executing
$(document).ready(function ()
{
    Product.addPage.setImage('http://site/images/small_logo.png');
    alert(Product.page(1).image());
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T16:57:12.807

您正在尝试引用 Product*函数*（在本例中为构造函数）的 addPage 属性，而不是在返回的对象上。

你可能想要这样的东西：

```
// Begin executing
$(document).ready(function ()
{
    var product = new Product();
    product.addPage().setImage('[http://site/images/small_logo.png](http://site/images/small_logo.png)');
    alert(product.page(1).image());
});
```

它还将括号添加到 addPage 调用中（尽管这不是 FireBug 一直抱怨的问题，因为它无论如何都无法找到该方法）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T16:56:42.293

怎么样？`Product.addPage`**`()`**`.setImage('http://site/images/small_logo.png');`

* * *

编辑：原来我只发现了一半的问题。看看 dtsazza 对整个事情的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:21:13.307

这也可以：

```
Product().addPage().setImage('http://site/images/small_logo.png'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T15:37:10.857

怎么样：

```
var Product = {
    Page : function() {             
        return {
            _image : '',
            Image : function() {
                return this._image;
            },
            setImage : function(imageSrc_) {
                this._image = '<img id="image" src="' + imageSrc_ + '" height="100%" width="100%">';
            }
        };
    },
    Pages : [],
    addPage : function() {
        var Page = new Product.Page();
        this.Pages.push(Page);
        return Page;
    },
    GetPage : function(pageNumber_) {
        return this.Pages[pageNumber_];
    }
};

// Begin executing
$(document).ready(function ()
{
    Product.addPage().setImage('http://site/images/small_logo.png');
    alert(Product.GetPage(0).Image());
}); 
```

# flash - Flash 中的哪些文本被 Google 索引？

> ID：447565
> 
> 赞同：1
> 
> 时间：2009-01-15T16:52:06.843
> 
> 标签：flash, actionscript, seo

*以下是否意味着动态文本字段不会被索引？*

> 我们目前**不附加**由您的 Flash 文件加载的外部资源的内容。如果您的 Flash 文件加载一个 HTML 文件、一个 **XML 文件**、另一个 SWF 文件等，Google 将单独索引该资源，但它不会被视为您的 Flash 文件内容的一部分。

*以下是否意味着只有静态文本字段才会被索引？*

> 此时，**从资源文件动态加载的内容没有被索引。**我们已经注意到几位网站管理员提出的此功能请求，请在不久的将来更新中寻找此功能。

来自[改进的 Flash 索引](http://googlewebmastercentral.blogspot.com/2008/06/improved-flash-indexing.html)，谷歌博客

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-28T08:11:39.520

浓缩了 Jim Corbett的整个 45 分钟视频[The Searchable SWF](http://tv.adobe.com/#vi+f15384v1000)。

**遵循**所有这些规则的 TextFields 中的****所有文本**都将由虚拟用户 (Google) 编制索引**

 **1.  **是静态的还是动态的**——不是输入
2.  **在 displayList 上/舞台上的一个实例**——不仅仅是在 RAM 中
3.  **舞台边界内的 4 个角中的任何 1 个**- 不在舞台外
4.  **可见**——不是不可见，不是 alpha=0
5.  **不在位图图像内**- 图像未经过 OCR 处理
6.  **不是看起来像文本的形状或图形**- 形状不是 OCR
7.  **无需登录即可公开访问**- 不在登录/身份验证之后
8.  **不依赖外部数据文件**——没有加载外部文件，没有 XML/SWF/TXT/etc
9.  **任何字体大小**——太小可能被视为垃圾邮件
10.  **在 Flash IDE 中输入或生成的 ActionScript，甚至是组件**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T17:00:38.137

我认为它严格来说并不是说动态字段的内容没有被索引，从代码而不是从外部来源设置内容似乎不被本文排除。但由于这不是常见的情况，所以没那么重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T14:04:52.113

这是一个奇怪的问题，有几个原因：

1.  文本字段可以是“动态的”而不依赖于“外部资源”
2.  该职位已有六个月的历史，并且
3.  Flash[搜索播放器项目](http://www.adobe.com/devnet/flashplayer/articles/swf_searchability.html)正在积极开发中。

因此，很难从从事搜索播放器项目的 Google 或 Adob​​e 工程师以外的任何人那里得到可靠的答案，即便如此，这仍然是一个有点复杂的问题，具体取决于实施。因此，无论如何，现在最安全、最可靠的答案可能是*也许——但我还不一定会指望它*。

尽管如此，search-player 项目的全部目的是解决这类问题，所以虽然今天的答案不一定是肯定的（可能是肯定的，只是我们不确定），随着时间的推移，它肯定会更接近是。

您现在可以做的一件事是[观看此视频](http://tv.adobe.com/#vi+f15384v1000)，其中 Jim Corbett（来自 Flash 播放器团队，直接与 Google 合作）解释了所有这些内容，其详细程度与您今天可能从任何人那里得到的一样多。（在大约 19 分钟后，他还现场演示了工作中的虚拟用户索引/文本字段的东西。）它应该让你非常清楚地了解它们现在的状态、它们的发展方向、什么是有效的什么不是，等等，因此您可以权衡选项并为您的项目做出正确的决定。祝你好运！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T09:16:15.783

确认所做的事情：

1.  **所有 ActionScript**都已执行，因此所有逻辑都将按预期工作
2.  将执行所有版本的**ActionScript 1、AS2、AS3**
3.  所有**按钮**都滚动/退出并单击/ mousedown / mouseup
4.  基于**Flash Player 9.0.124**的代码，带有精确的 ActionScript 引擎。
5.  目前唯一支持的搜索引擎是**Google**。

确认未完成的事项：

1.  **深层链接**生成的 URL 将不起作用*（Flash Search Player 不会传递给 Google）*
2.  Adobe 曾考虑**请求 SWF**发回深层链接 URL 列表。*（黑帽搜索引擎优化）*
3.  **外部文件**不会发送到 SWF，也不会加载。
4.  XML/SWF/其他文件将被**独立**处理/执行。
5.  **雅虎！**和其他搜索引擎正在讨论使用 Flash Search Player。
6.  **可访问文本**（不可见）尚未编入索引。
7.  视频**元数据**尚未编入索引。
8.  不是基于**Flash Player 10**的代码，但计划这样做。
9.  **不读取**字体大小，因此标题/内容没有区别。****
***   **外部**接口不起作用。*（没有 JavaScript 或 ActiveX 后端）***

 **# c# - 休眠查询中的 Unicode 字符串

> ID：447566
> 
> 赞同：2
> 
> 时间：2009-01-15T16:52:29.637
> 
> 标签：c#, nhibernate, hibernate, unicode, hql

在 SQL 中，可以编写一个查询来搜索一个人的姓名，如下所示：

```
SELECT * FROM Person P WHERE P.Name LIKE N'%ike%' 
```

此查询将使用 unicode 字符运行（假设 Name 列和数据库已设置为处理 unicode 支持）。

我在 Hibernate (NHibernate) 运行的 HQL 中有一个类似的查询。生成的查询如下所示：

```
SELECT P FROM SumTotal.TP.Models.Party.Person P join P.Demographics PD WHERE (PD.LastName LIKE '%カタカ%'  ) 
```

不幸的是，在 HQL 中的文字前面放置一个“N”会导致错误。我尝试转义字符串中的 unicode 字符，但仍然没有成功。

数据库正在接受并保存来自 Hibernate 的 unicode 字符。我已经能够成功地用一个 unicode 字符串填充一个对象，用 Hibernate 保存它，并在数据库中验证它。在我看来，我不能在自定义查询中使用 unicode 字符串（或者我也假设命名查询）有点奇怪。

这是 Hibernate (Nhibernate) 的已知问题还是限制？你如何在 HQL 中使用 unicode？

一些网站建议使用 Criteria 查询。由于我正在使用的框架中的限制，这是不可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T17:34:39.457

您是否尝试过使用参数：

```
IList<Person> people = session
    .CreateQuery("from Person p where p.Name like :name")
    .SetParameter("name", "%カタカ%")
    .List<Person>(); 
```

它们还具有保护您的查询免受 SQL 注入的优势。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T19:47:02.857

我找到了一个可行的解决方案。我高度怀疑这是最好的解决方案。然而，在我可以授权重写我正在开发的软件的整个查询构建部分之前，这是我将要实施的解决方案。

在实例中：

```
SELECT P FROM SumTotal.TP.Models.Party.Person P join P.Demographics PD WHERE (PD.LastName LIKE '%カタカ%') 
```

where 子句包含以下文字：

```
'%カタカ%' 
```

这个文字可以分解成 nchars，Hibernate (Nhibernate) 会在不知不觉中传递给它生成的 SQL。奇怪，但它有效。因此前面的查询可以写成：

```
SELECT P FROM SumTotal.TP.Models.Party.Person P join P.Demographics PD WHERE (PD.LastName LIKE '%' + nchar(0x30AB) + nchar(0x30BF) + nchar(0x30AB)+ '%') 
```

该解决方案远非最佳，因为它需要遍历每个字符并确定它是否是多字节字符。但是，在此代码位于其应用程序中的情况下，它用于在不同操作下处理多个不同条件的动态查询生成器中。在我给出的示例中，它正在字符串中的任何位置查找 unicode。此函数可能会返回等于特定数值的列的 where 子句部分，或者它可能正在查找字符串的起始字符。构建运算符的方法使用运算符类型和术语来回传字符串。我可以重写它，但这将是一项艰巨的任务。上述修复将允许我处理传递给此方法的字符串。我提供这个解决方案是因为它确实有效，但不敢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-07T09:54:42.357

出现这个问题是因为 NHibernate 试图访问没有类型长度的列。因此，在 HBM.xml 中提及 Legacy 数据库的长度非常重要，否则 UNIcode 相关内容将失败。

谢谢， 塔尼

# c# - 实体框架：创建自定义属性

> ID：447574
> 
> 赞同：3
> 
> 时间：2009-01-15T16:54:26.027
> 
> 标签：c#, entity-framework, properties

考虑在 DAL 程序集中实现实体框架。我需要向实体添加自定义只读属性。

**数据库中定义的**Person Class包含以下字段：****

 **```
PersonID
FirstName
LastName 
```

在上面的示例中，我想创建一个名为 FullName 的属性。这将是的串联

`FirstName + " " + LastName;`

任何人都可以帮助在文件中指出`.edmx`定义这个新属性的下落吗？也许它是在 GUI 设计器中完成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T16:59:00.497

在当前版本的 EF 中，执行此操作的唯一方法是作为实体的部分类中的 .NET 函数。这意味着您不能在 LINQ to entity 或 ESQL 中使用新属性，但它在其他方面工作得很好。

一种可能的解决方法是在数据库服务器上执行此操作，但 EF 将完全不知道属性之间的关系。

在 EF 的未来版本中，[EDMX 将支持此功能](http://blogs.msdn.com/efdesign/archive/2009/01/13/update-on-computed-properties.aspx)。

# delphi - INNO Setup：如何根据应用的不同版本实现文件更新

> ID：447586
> 
> 赞同：3
> 
> 时间：2009-01-15T16:57:15.553
> 
> 标签：delphi, installation, inno-setup

我有一个用 Delphi 编写的应用程序，它有几个版本，其中包含二进制文件和数据库 (MDB) 以及目录数据。

在产品生命周期中，修复/增强要么在数据库文件中，要么在某些二进制文件中。

版本保存在注册表中。

当新补丁可用时，用户可能有不同版本的程序。

现在用户有不同的版本如何在 Inno Setup 中实现以下场景：

1.  如果用户有版本 A 阻止安装。
2.  如果用户有版本 B 复制 db 和 file1、file2、file3。
3.  如果用户有版本 C，只需更新 file1。

在 Inno 设置中实现这一点的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T17:30:22.150

我不确定这是否是正确的方法，但您可以使用 [code] 部分和 BeforeInstall Flags

像这样

```
[Files]
Source: "MYPROG.EXE"; DestDir: "{app}"; BeforeInstall: MyBeforeInstall('{app}')
Source: "MYFILE.EXE"; DestDir: "{app}"; BeforeInstall: MyBeforeInstall('{app}')
Source: "MYDB.MDB"; DestDir: "{app}"; BeforeInstall: MyBeforeInstall('{app}')

[Code]

function MyBeforeInstall(InstallPath): Boolean;
begin
  Result:= FALSE;
    //Check if this file is ok to install
    MsgBox(CurrentFileName , mbInformation, MB_OK);
end; 
```

然后使用 CurrentFileName 来确定文件是否可以安装，如果结果为假，我不确定它是否会退出安装程序，或者跳过单个文件。

您还可以使用 [Types]/[Components] 部分来确定将安装哪些文件，但我不知道是否有办法自动选择它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T17:33:19.023

Inno 默认会查看文件版本信息。因此，如果您的补丁只需要在补丁中的版本较新时更新文件，则什么也不做；Inno 已经这样做了。

另一方面，如果您的补丁需要替换具有相同版本的文件（或文件中没有版本信息），请使用**replacesameversion**标志。这会导致 Inno 比较文件的内容，如果不同则替换它。有关此标志的更多信息，请参阅文件的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T16:30:38.510

您可以创建用于检查版本的函数。

**有关详细信息，请参阅[此网站(](http://agiletracksoftware.com/blog.html?id=4) [http://agiletracksoftware.com/blog.html?id=4](http://agiletracksoftware.com/blog.html?id=4) )**

```
[Code]
; Each data file contains a single value and can be loaded after extracted.
; The filename and DestDir from the [Files] section must match the names
; and locations used here
function GetAppMajorVersion(param: String): String;
     var
          AppVersion: String;
     begin
          ExtractTemporaryFile('major.dat');
          LoadStringFromFile(ExpandConstant('{tmp}\major.dat'), AppVersion);
          Result := AppVersion;
     end;

function GetAppMinorVersion(param: String): String;
     var
          AppMinorVersion: String;
     begin
          ExtractTemporaryFile('minor.dat');
          LoadStringFromFile(ExpandConstant('{tmp}\minor.dat'), AppMinorVersion);
          Result := AppMinorVersion;
     end;

function GetAppCurrentVersion(param: String): String;
     var
          BuildVersion: String;
     begin
          ExtractTemporaryFile('build.dat');
          LoadStringFromFile(ExpandConstant('{tmp}\build.dat'), BuildVersion);
          Result := BuildVersion;
     end; 
```

*来自 AgileTrack 博客的代码摘录：* [使用 Inno Setup 创建版本化安装程序](http://agiletracksoftware.com/blog.html?id=4)

# python - 使用正确的密码解密受 aes-256bit 保护的 pdf

> ID：447600
> 
> 赞同：3
> 
> 时间：2009-01-15T17:02:54.623
> 
> 标签：python, pdf, command-line, aes

有什么方法可以解密受 aes-256 位密钥保护的 pdf？

我有正确的密码，我需要一个命令行工具（或库 - 可能在 python :P 中）来解密文件，然后对其进行一些操作。

最好的事情可能是如果文件可以保存解密，然后我会详细说明它，然后我可以删除它......

有人知道吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T03:29:25.013

```
import pyPdf                                                                
pdf = pyPdf.PdfFileReader(open("file.pdf"))
pdf.decrypt("password") 
```

然后，您可以对内容做任何您想做的事情。这将适用于用户或所有者密码。

# sql - SQL：你如何处理条件删除？

> ID：447604
> 
> 赞同：1
> 
> 时间：2009-01-15T17:04:52.543
> 
> 标签：sql

我对如何编写存储过程来处理条件删除感到困惑。

我有一个有 4 列（`ID`, `A`, `B`, `C`）的表，表中的数据如下所示：

```
ID  | A             | B     | C
----------------------------------
1   | Debbie Jones  |       |   
2   | John Jones    |       |
3   | James Jones   |       | 
```

列`A`, `B`, 并`C`保存一个人的名字。我将如何编写一个存储过程来删除`Debbie Jones`行而不影响其他两行，其中`B`列`C`是空字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T17:10:22.203

```
delete from YourLousyTableName
where A='Debbie'AND B='Jones' 
```

假设 ID=1 A='Debbie' B='Jones' C=''

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T17:09:13.987

那你需要另一个条件。如果您想删除 Debbie Jones，则需要在您的条件中指明这一点，方法是指定列 A =“Debbie Jones”或 ID 列等于 1。

当然，这假设 ID 和 A 列中的值是唯一的，并且可以唯一标识该行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T17:10:39.677

我可能不完全理解你的问题，但你在寻找这样的东西吗？

```
delete from Table
where [Name] = 'Debbie Jones'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T17:10:16.027

你的意思是`DELETE FROM table WHERE A = "Debbie Jones";`？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T17:28:14.743

首先，您的示例需要在您的问题中正确格式化（使用代码标签！）

其次，我假设您试图避免按名称删除的错误，因为可能存在重复名称。在这种情况下，您可能只想按 ID 号删除。

```
DELETE FROM MyTable WHERE ID=4

|ID|       A      |  B  |  C  |
|==|==============|=====|=====|
| 1| Debbie Jones | " " | " " |
| 2| John Jones   | " " | " " |
| 3| James Jones  | " " | " " | 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T17:49:30.143

对于这种情况，我认为您不需要像存储过程这样的东西。任何如何尝试这个，

```
create procedure prcDelUsingID
@UID <Data Type of the ID column> 
as
delete from <Your Table Name>
where ID=@UID 
```

执行存储过程如下，

```
prcDelUsingID <ID of the Debbie Jones> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-07T21:30:51.990

您可以尝试以下命令：

```
x=sqldf(select * from [table_name] where A!='Derbie Jones') 
```

# oracle - 如何更改 oracle jdbc 客户端的默认 nls_date_format

> ID：447608
> 
> 赞同：11
> 
> 时间：2009-01-15T17:08:26.000
> 
> 标签：oracle, jdbc

我在 Oracle 10.2 XE 上定义了全局 nls_date_format 如下：

```
alter system set nls_date_format='YYYY-MM-DD HH24:MI:SS' scope=spfile; 
```

在 Windows 上连接时，客户端会使用特定于会话的格式覆盖它，因此我需要在每个会话开始时运行此行：

```
alter session set nls_date_format='YYYY-MM-DD HH24:MI:SS'; 
```

但是，我有一些无法更改的自定义代码（jdbc 代码，使用 ojdbc14.jar），因此在接收连接时无法执行此行。有没有办法更改所有 jdbc 连接的 nls_date_format 的默认值？也许在连接字符串中添加一些东西，或者我可以使用的一些环境变量？

顺便说一句，sqlplus 和 sqldeveloper 也用自己的格式覆盖了服务器的格式，但我发现了如何更改它们的默认值，所以问题只是 jdbc 连接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T17:30:52.740

在登录后触发器中设置 nls 日期格式

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T18:47:22.897

谢谢，这对我有用。我插入的触发器是这样的：

```
CREATE OR REPLACE TRIGGER LOGINTRG
AFTER LOGON ON DATABASE
BEGIN
EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_DATE_FORMAT=''YYYY-MM-DD HH24:MI:SS''';
END LOGINTRG; 
```

# tex - 如何在普通 TeX 中修改纸张尺寸？

> ID：447617
> 
> 赞同：5
> 
> 时间：2009-01-15T17:10:44.763
> 
> 标签：tex

我的意思是整篇论文，而不仅仅是其中的文本区域。

如果我在 tex 文件中设置这些尺寸，我希望 dvi 输出在查看器中看起来是 1 厘米 x 10 米。

而且我不想为此使用 LaTeX。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T19:23:30.143

在文档的第一页添加 \special{papersize=1cm,1000cm}。这确实是一个 dvips 扩展，但许多 dvi 观众都理解它。（当然还有设置 \hsize、\vsize 等来控制文本的定位。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T07:45:36.113

几个有用的链接： [打印输出的大小](http://www.tex.ac.uk/cgi-bin/texfaq2html?label=papersize)和 [从 (La)TeX 获取正确的纸张几何形状](http://www.tex.ac.uk/cgi-bin/texfaq2html?label=papergeom)。

当然，一旦我得到答案，谷歌搜索会更有效率。

# linux - 从空环境访问 X11 显示器 (bash)

> ID：447619
> 
> 赞同：4
> 
> 时间：2009-01-15T17:11:36.820
> 
> 标签：linux, bash, x11

问候！

我正在实施一个备份解决方案，我需要访问 X11 显示屏以从用户那里获取密码并显示状态信息。我尝试将脚本中的 $DISPLAY 设置为 :0.0（硬编码），但 xhost 和 misc 抱怨他们无法打开显示。我该怎么办？

PS：脚本在这里：[http ://dpaste.com/109435/](http://dpaste.com/109435/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T17:22:37.267

您需要 X 身份验证信息。我不相信它`xhost`可以“闯入” X 会话并允许在没有它的情况下进行访问（您需要让用户为您执行此操作），如果您拥有它，那么根本不需要使用 xhost。

尝试

```
export DISPLAY=:0.0
export XAUTHORITY=/home/user/.Xauthority 
```

然后运行你的命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T20:38:43.970

如上所述，用户必须允许您访问他们的显示。他们需要执行 xhost + 命令。向任何人开放您的显示器并不是一个好主意！

你最好让他们跑

```
xhost +jeeger 
```

或您的用户正在运行的任何内容。

高温高压

干杯，

抢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T21:06:08.720

谢谢，你让我走上了正确的道路。现在我在我的 .xinitrc 中执行 xhost +local:，这允许我访问 X11 显示（当我导出 DISPLAY 时）。

# php - 在 PHP 中创建函数/方法时，最佳实践是使用数组还是单个变量？

> ID：447622
> 
> 赞同：3
> 
> 时间：2009-01-15T17:12:13.167
> 
> 标签：php, coding-style

创建这样的函数是否被认为是“不好的做法”：

```
// $arr_member_fields['first_name'] = $_POST['first_name'];
// $arr_member_fields['last_name']  = $_POST['first_name'];
// $arr_member_fields['email']      = $_POST['email'];
// $arr_member_fields['dob']        = $_POST['dob'];
// $arr_member_fields['gender']     = $_POST['gender'];

function update_member($int_member_id $arr_member_fields)
{
    //some code
} 
```

或者应该创建一个没有数组的函数而只​​使用变量——就像这样：

```
function update_member($int_member_id, $str_first_name, $str_last_name, str_email, $str_dob, $chr_gender)
{
    //some code
} 
```

我更喜欢第一种方法（带有数组的方法）的原因是我总是可以选择循环遍历数组以进行数据库插入/更新。

很想知道其他人对此的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T17:17:32.440

取决于功能。这里没有最佳实践可以在编写函数时充分捕捉大多数情况。如果您不需要遍历参数怎么办？

在这种情况下，您最好不要传递数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T22:37:15.430

这样的事情最终归结为对性能和代码可读性的影响。虽然传递一个数组非常方便，但它也使其他人难以阅读您的代码（或者如果您在 6 个月后返回它，甚至对您来说也是如此）。如果数组是在一个大文件的其他地方定义的，或者完全是另一个文件，则尤其如此。

归根结底，这实际上归结为您首先尝试优化代码的原因。是为了性能，还是为了更容易理解/阅读？

如果是为了可读性，请选择似乎最容易理解的方法。当你必须在几个月后回去调整一些东西时，你会感谢自己。

如果是为了性能，请确保您确实需要提高性能，并且您不是为了优化而优化某些东西。通常，您会创建一个非常真实的*可读性*问题来解决不存在的*性能*问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:18:17.023

在这种情况下，我会考虑使用一种结构来保存数据。这样我可以将结构或结构数组传递给方法，或者我可以访问结构的各个元素。

当然，如果我想更进一步，我会创建一个类而不是一个结构。然后我可以拥有方法以及数据、setter、带验证的 getter 等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T19:34:00.817

我会选择第二种方法，因为您的 IDE 可以告诉您它应该采用哪些参数，而无需转到该文件。现在对一个小项目使用数组似乎没问题，但是随着您的项目变大，以后可能会成为问题。当您尝试使用它时，它还可以避免您以后问自己“我是先使用 name_ 还是 first_ name ？” 这些字段看起来都在一个表中，无论如何都会在单个语句中更新，所以我看不出有任何理由要循环遍历数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T19:43:30.207

我认为通过数组传递参数通常是一个坏主意。如果参数列表太长以至于它们证明作为数组传递是合理的，则可能表明代码没有以最佳方式设计。

在数组中传递参数更难使用 PHPDocumentor 之类的东西来记录，并且也不会被 IDE 中的代码完成拾取。显式传递参数还允许类型提示，并且对代码的读者更透明。

显然，如果您将要处理的项目数组作为函数参数传递，那么将其作为数组传递是有意义的。

# sql-server - 使用 Start 和 Length 参数从 SQL 2000 分页的好方法是什么？

> ID：447623
> 
> 赞同：2
> 
> 时间：2009-01-15T17:12:15.663
> 
> 标签：sql-server, stored-procedures, sql-server-2000, pagination

我的任务是重构现有的存储过程，以便对结果进行分页。SQL 服务器是 SQL 2000，所以我不能使用 ROW_NUMBER 分页方法。存储过程已经相当复杂，在执行 sp_executesql 之前一起构建大型 sql 语句的块，并且有各种可用的排序选项。

谷歌的[第一个结果](http://ehockeycoach.net/devgenuity/Articles/SQL/SQL2000Pagination.aspx)似乎是一个好方法，但我认为这个例子是错误的，因为第二次排序需要反转，并且开始小于页面长度的情况会被打破。该页面上的第二个示例似乎也是一个好方法，但 SP 采用的是 pageNumber 而不是开始记录。整个临时表的事情似乎会消耗性能。

我正在沿着这条道路取得进展，但它似乎缓慢而令人困惑，我必须在排序顺序上执行相当多的 REPLACE 方法才能让它正确出现。

我还缺少其他更简单的技术吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T21:41:50.100

[此 StackOverflow 问题](https://stackoverflow.com/questions/284784/is-there-a-start-at-equivilant-in-ms-sql)中有两个符合 SQL Server 2000 的答案- 跳过已接受的答案，它仅适用于 2005：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T17:16:44.390

不，恐怕没有 - SQL Server 2000 没有 2005 年的任何细节，如公用表表达式 (CTE) 等...... Google 链接中描述的方法似乎是一种方法。

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:19:08.083

也看看这里 [http://databases.aspfaq.com/database/how-do-i-page-through-a-recordset.html](http://databases.aspfaq.com/database/how-do-i-page-through-a-recordset.html)

向下滚动到存储过程方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T18:31:55.050

根据您的应用程序架构（以及您的数据量、结构、数据库服务器负载等），您可以使用数据库访问层进行分页。

例如，使用 ADO，您可以在记录集（ADO.NET 中的 DataSet）对象上定义页面大小并在客户端进行分页。经典 ADO 甚至允许您使用服务器端光标，尽管我不知道它是否可以很好地扩展（我认为这在 ADO.NET 中已完全删除）。

MSDN 文档：[通过查询结果进行分页 (ADO.NET)](http://msdn.microsoft.com/en-us/library/tx1c9c2f.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T20:08:57.850

在玩了一段时间之后，似乎只有一种方法可以真正做到这一点（使用 Start 和 Length 参数），那就是使用临时表。

我的最终解决方案是**不**使用 @start 参数，而是使用 @page 参数，然后使用

```
 SET @sql = @sql + N'

    SELECT * FROM
    (
    SELECT TOP ' + Cast( @length as varchar) + N' * FROM 
            (
            SELECT TOP ' + Cast( @page*@length as varchar) + N'
                 field1,
                 field2 
                 From Table1
                 order by field1 ASC
            )  as Result   
            Order by Field1 DESC
     )  as Result
     Order by Field 1 ASC' 
```

原始查询比这里显示的要复杂得多，并且 order by 至少在 3 个字段上排序，并由一个长 CASE 子句确定，需要我使用一系列 REPLACE 函数来以正确的顺序获取字段。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T15:47:10.753

多年来，我们一直在使用此查询的变体。此示例给出了 50,000 到 50,300 项。

```
select top 300 
  Items.*
from Items
where 
  Items.CustomerId = 1234 AND
  Items.Active = 1 AND
  Items.Id not in
  ( 
    select top 50000 Items.Id
    from Items
    where 
      Items.CustomerId = 1234 AND
      Items.Active = 1
    order by Items.id
  )
order by Items.Id 
```

# linux - Linux：启动窗口、捕获屏幕

> ID：447624
> 
> 赞同：2
> 
> 时间：2009-01-15T17:12:27.443
> 
> 标签：linux, screenshot, capture, image-capture, screen-grab

我需要编写一个 Red Hat Linux 命令行工具来启动一个窗口并将其外观以 JPEG 格式捕获到磁盘。

通常目标机器没有显卡，但我们可以安装任何软件组件（例如，X）。

一两个问题：

您可能会为此建议哪些库或工具？

如果我使用 GTK+ 之类的东西来创建这个工具，缺少显卡会妨碍它的执行吗？

我看到了`scrot`，但它似乎不支持在没有用户交互的情况下捕获特定窗口。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T17:24:30.773

听起来您需要为 X.org 服务器使用“[虚拟帧缓冲区”](http://www.x.org/archive/X11R6.8.2/doc/Xvfb.1.html)驱动程序，并结合[xwd](http://en.wikipedia.org/wiki/Xwd)、[NetPBM](http://en.wikipedia.org/wiki/Netpbm)和[cjpeg](http://en.wikipedia.org/wiki/Libjpeg)实用程序。

我不确定 X 服务器所需的特定配置，但您可能必须确保您使用的服务器具有内置的虚拟帧缓冲区驱动程序。虚拟帧缓冲区驱动程序是一个显示驱动程序，就像您用来连接到 NVidia 或 ATI 视频卡的驱动程序一样，除了它的“输出”是一块包含像素的内存，而不是 LCD 屏幕。

xwd 是标准的 X 工具之一，可以创建 X Window Dump。可以在命令行上告诉 xwd 要转储哪个窗口。它将时髦的“xwd”格式流输出到标准输出。

NetPBM 实用程序是一组命令行工具，可将一种图像格式转换为另一种图像格式。它包括一个转换 xwdtoppm 的功能。PPM 是一种非常基本的非压缩格式，是大多数 NetPBM 工具都能理解的中间格式。

cjpeg 是标准 JPEG 工具集的一部分，如果您还拥有 NetPBM，则可​​能已安装。cjpeg 可以采用 PPM 字节流并发出 JPEG 字节流。

通过 Unix 脚本和管道的魔力，您可以将这些实用程序串在一起以使用窗口启动应用程序，调用 xwd、xwdtoppm 和 cjpeg 将图像转储到文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T07:02:48.633

您可以尝试运行 vncserver 来创建虚拟 X 窗口显示 - 不需要显卡。确保将 DISPLAY 变量设置为 vncserver 启动时打印的显示编号。接下来，在创建的显示器（在 hte 后台）上启动您的应用程序，并使用 xwd 和数据格式化程序或 gimp 命令将屏幕图像捕获为 jpeg。

顺便说一句，检查[Command line program to create website screenshots (on Linux)](https://stackoverflow.com/questions/125951/command-line-program-to-create-website-screenshots-on-linux)的类似答案。

# asp.net - 使用 SQL Membership Provider 的 ASP.NET 会话超时

> ID：447625
> 
> 赞同：2
> 
> 时间：2009-01-15T17:12:28.660
> 
> 标签：asp.net, session, asp.net-membership, sqlmembershipprovider

我从进程内成员资格提供程序转换为 sql 成员资格提供程序，以防止人们在网站进程回收时丢失他们的会话，但会话似乎仍然超时。

在使用 sql 成员资格提供程序时，是否有任何其他事情（除了 web.config 中设置的会话超时变量）会导致会话超时。即使用户关闭并打开浏览器，我也希望会话持续存在。我必须做一些特别的事情来做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T16:55:34.653

With persistent cookies ('the remember me checkbox'), the user is logged in by 3 days. If you want to make this window bigger, you'll need to build it yourself.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T17:00:26.500

You're confusing session (which by its nature expires and should be for transient data only applicable to a single session) and profiles. You can use the membership database features of ASP.NET to set persistent settings, but they will only reappear if a user remains logged in.

However ... there is also anonymous identification. You can enable this in web.config

```
<anonymousIdentification enabled="true"/> 
```

And then mark your profile settings as available to an anonymous user;

```
<profile>
  <properties>
    <add name="Name" allowAnonymous="true" />
  </properties>
</profile> 
```

The anonymous cookie lasts for about 70 days. If you decide to support registration and full blown membership you'd need to move the anonymous settings to a user's settings when they register.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:13:56.020

我认为关闭窗口后不可能保持会话。用户帐户由会话 cookie 编制索引，并在他们关闭窗口时被删除。

您*可以*做的是存储用户*配置文件*信息，并在他们登录或以其他方式识别自己（例如普通 cookie）时将其恢复。

# asp.net - 如何在 ASP.NET 中监视网络上的活动计算机？

> ID：447629
> 
> 赞同：0
> 
> 时间：2009-01-15T17:13:09.623
> 
> 标签：asp.net, networking, monitoring

我如何使用 ASP.NET 知道哪些机器与我的 PC 在同一个 LAN 上处于活动状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T17:20:55.070

您可以 ping 网络上的计算机。

```
// addressToPing can be an IPaddress or host name.
// returns a boolean indicating successful ping
public static bool PingComputer (string[] addressToPing)
{
    Ping pingSender = new Ping ();
    PingOptions options = new PingOptions ();

    // Use the default Ttl value which is 128,
    // but change the fragmentation behavior.
    options.DontFragment = true;

    // Create a buffer of 32 bytes of data to be transmitted.
    string data = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";
    byte[] buffer = Encoding.ASCII.GetBytes (data);
    int timeout = 120;
    PingReply reply = pingSender.Send (args[0], timeout, buffer, options);
    return reply.Status == IPStatus.Success;
} 
```

[http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)

您可以使用此 ping 代码并遍历 LAN ( `for(i = 1; i < 255; i++)`) 上的 IP 地址。不过，您可能应该阅读有关进行 IP 地址计算的内容：

[http://blogs.msdn.com/knom/archive/2008/12/31/ip-address-calculations-with-c-subnetmasks-networks.aspx](http://blogs.msdn.com/knom/archive/2008/12/31/ip-address-calculations-with-c-subnetmasks-networks.aspx)

这称为“ping 扫描”。它确实假定网络上的计算机尚未配置为忽略 ICMP 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T17:35:36.943

我将分两部分处理这个问题；一个 ASP.NET 页面和一个始终运行的服务。

始终运行的服务监控 ARP 请求，以了解哪些机器处于活动状态。为了查看 ARP 回复，它必须发出自己的 ARP 请求。在 Windows 网络上，总是有足够的空闲流量（用于浏览计算机）来很好地了解哪些计算机处于活动状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:49:27.897

如果您有能力在网络上的各种计算机上安装监控软件，那么我很幸运地使用[nagios](http://www.nagios.org/)来跟踪生产网络中哪些服务器启动/负载过重/磁盘空间不足/等。它还有一个不错的 Web 前端，您甚至根本不需要使用 ASP。

如果您必须使用 ASP 创建一些本地开发的东西，我会使用[nmap](http://insecure.org/)扫描您的 C 类子网，然后在您的 ASP 页面中打印结果。这不是一个非常有效的方法，但它会非常简单并且几乎可以保证工作（使用适当的选项）。

# php - PHP 最佳设计实践

> ID：447630
> 
> 赞同：9
> 
> 时间：2009-01-15T17:13:15.787
> 
> 标签：php, oop, templates

好的，有一堆我在过去几天一直在思考的问题。目前我有一个网站，它只是一堆 PHP 文件，其中包含混合了 PHP、HTML 和 CSS 的 MySQL 语句，基本上是一团糟。我的任务是清理网站并为自己制定了以下要求：

*   该站点需要高效且布局合理（源代码），我希望能够编写尽可能少的代码。
*   结构、表示和逻辑之间必须有良好的分离。
*   无论出于何种原因，我都不能使用框架，并且需要保持代码可维护和“简单”，因为将来会有开发人员使用它。
*   至少需要有几个页面的管理部分。

话虽如此，这就是我现在对该网站的了解：

*   由 10-12 页组成，少数是完全静态的，大多数是通过数据库动态驱动的，并且有一个巨大的表单供用户填写（20-30 个字段），需要验证和检查。
*   网站的层次结构基本上是 5-6 个主页面，然后是其中的子页面。

所以，知道这些事情，我想知道是否有人对如何以最少的头痛进行此操作有任何提示/建议。

*   在这种情况下，OO 方法会是最好的吗？
*   既然静态页面很多，而动态页面只需要填写内容，那最好使用某种基本模板吗？

**编辑：**感谢您的回答，当我说没有框架时，我基本上是指任何需要 PHP 以外的新语法的东西，因为在我之后被雇用在这个网站上工作的人可能只会知道 PHP。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-15T17:30:09.467

这是一篇关于如何组织 PHP 项目的文章，来自创建该语言的架构师 Rasmus Lerdorf：

[http://toys.lerdorf.com/archives/38-The-no-framework-PHP-MVC-framework.html](http://toys.lerdorf.com/archives/38-The-no-framework-PHP-MVC-framework.html)

尽管 PHP 的 OO 框架很受欢迎，但 Rasmus 提倡较少的 OO 方法。他比任何人都更了解 PHP 的预期用途，以及如何将其架构用于高性能网站。

**编辑：** 作为对@theman 评论的回应，我承认这篇文章写得不是很好，但我认为内容很重要。按照预期使用 PHP 比努力克服其弱点以使其适合 OO 模型要好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T17:30:50.213

我强烈推荐所有 PHP 项目的[Smarty](http://www.smarty.net/)模板引擎。它为您提供了一种将逻辑与表示分离的简单方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T18:04:21.347

看看这个 SO[问题](https://stackoverflow.com/questions/446502/please-critique-my-first-attempt-at-mvc-in-php)和答案。这是一个非常好的、简单的 MVC 设计，并提供了一些关于如何改进它的技巧。如果您关心维护，那么至少您需要将表示与逻辑分开（您需要一个视图和控制器）。Smarty 强制执行此操作，但它是一种框架类型，您将需要学习额外的语法。

在您加入 Rasmus 的“无框架 php mvc 框架”潮流之前，请阅读一些批评性评论。任何 Web 应用程序结构都是一个框架，而 Rasmus 的方法并不是我见过的最好的。

# iphone - 访问 iPhone 的 USB 端口？

> ID：447635
> 
> 赞同：0
> 
> 时间：2009-01-15T17:15:45.203
> 
> 标签：iphone

开发者有没有办法将数据发送到 iPhone 的 USB 端口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T17:20:56.847

不，SDK 无法做到这一点。如果这是您希望看到的，您应该[提交增强请求](http://bugreporter.apple.com)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:56:09.877

不是现在。USB 功能在[iPhone OS 3.0](http://www.apple.com/iphone/preview-iphone-os/)中得到扩展。

# asp.net - 一个合理的 PasswordStrengthRegularExpression

> ID：447638
> 
> 赞同：12
> 
> 时间：2009-01-15T17:17:10.693
> 
> 标签：asp.net, authentication, passwords

我们正在使用标准的 ASP.NET 身份验证提供程序（AspNetSqlMembershipProvider，因为它发生了），并且默认密码强度要求对于我们的需求来说有点过分。

我们要求我们的用户输入至少包含字母数字的密码（即，如果用户愿意，可以输入字母和至少一个强制数字、混合大小写和非字母数字字符）。

谁能建议什么 PasswordStrengthRegularExpression 设置可以实现这一点？

此外，如果用户尝试使用的密码未通过正则表达式检查，我们如何控制向用户显示的错误消息？

## 笔记

发现该`minRequiredNonalphanumericCharacters`属性必须设置为`0`，否则此设置会覆盖任何使用的正则表达式

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2010-05-18T19:24:36.657

我们刚刚实现了以下表达式来验证 8 到 16 个字符的密码，并包含以下 4 项中的 3 项：大写字母、小写字母、符号、数字

```
(?=^[^\s]{8,16}$)((?=.*?\d)(?=.*?[A-Z])(?=.*?[a-z])|(?=.*?\d)(?=.*?[^\w\d\s])(?=.*?[a-z])|(?=.*?[^\w\d\s])(?=.*?[A-Z])(?=.*?[a-z])|(?=.*?\d)(?=.*?[A-Z])(?=.*?[^\w\d\s]))^.* 
```

单个组件的解释：

*   (?=^[^\s]{8,16}$) - 包含 8 到 16 个非空白字符
*   (?=.*?\d) - 包含 1 个数字
*   (?=.*?[AZ]) - 包含 1 个大写字符
*   (?=.*?[az]) - 包含 1 个小写字符
*   (?=.*?[^\w\d\s]) - 包含 1 个符号

请注意，在长度段之后是双括号，稍后在表达式中您会看到几个 |。这允许对允许的 4 种可能组合进行非此即彼的比较。

写完这篇文章后，我才注意到一年多以前有人问过这个问题。由于我在搜索中遇到了这个问题，我希望其他人也可以从我们的解决方案中受益。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-15T17:29:13.460

这是一个允许所有字符并且需要至少一个数字和至少 6 个字符的正则表达式。

```
^.*(?=.{6,})(?=.*\d).*$ 
```

如果您想定义更多或更少的字符，只需更改`(?=.{6,})`以反映您想要的最少字符数。

# c# - 如何从头开始构建 ASP.NET TreeView...？

> ID：447639
> 
> 赞同：1
> 
> 时间：2009-01-15T17:17:31.660
> 
> 标签：c#, asp.net, treeview, threaded-comments

我正在尝试在 ASP.NET 中构建嵌套/线程评论系统。我不知道 PHP 的人是如何做到的。它比最初想象的要难得多。

我正在尽我最大的努力将分层数据输出给用户，但它不起作用。

我有一个带有文本、itemID 和 parentID 的表格。

我想以树形视图格式显示信息，但是 asp.net 的标准控件不起作用...

谁能指出我如何将其输出到树视图的正确方向。我尝试过嵌套中继器，直接从代码隐藏和树视图控件构建 html。

我还没有找到解决办法...谁能帮帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T18:06:28.847

很快，通过头部（现在无法签入 VS2k8），我会使用 Linq to SQL 来做这样的事情

```
private void BuildTree()
{
   List<Item> items = from item in dataContext.Items
                      select item;

   List<Item> rootItems = items.FindAll(p => p.ParentID == null );

   foreach ( Item item in rootItems )
   {
      TreeViewNode tvi = new TreeViewNode(item.text);
      BuildChildNodes(tvi, items, item.ID);
      YourTreeNodeName.Nodes.Add(tvi);
   }   
}

private void BuildChildNodes(TreeViewNode parentNode, List<Item> items, long parentID)
{
   List<Item> children = items.FindAll ( p => p.ParentID = parentID );
   foreach( Item item in children)
   {
      TreeViewNode tvi = new TreeViewNode(item.text);
      parentNode.Nodes.Add(tvi);
      BuildChildNodes(tvi, items, item.ID);         
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T17:39:33.673

据我了解，如果您有一个包含分层数据的数据库表，您有两个选择：创建自己的自定义数据源，或者以编程方式将树视图绑定到数据库表。

我没有适合您的代码，但您可以使用以下步骤：

1.  在 asp.net 页面中声明树视图控件
2.  使用您的层次数据（SELECT itemID、parentID FROM...）填充 DataTable（通过 SqlDataAdapter）
3.  使用相同的 DataTable 创建顶级项目的 DataView（parentID 将为空）
4.  对于 DataView 的每一行，通过过滤另一个 DataView 递归地添加树视图项，其中每个 DataViewRow 的 parentID 等于您在步骤 4 中循环的行

几乎所有这些都是使用 TreeView.Nodes.Add(theNewNode) 完成的，其中 theNewNode 是 TreeNode 对象的一个​​实例

我知道这一切听起来很令人困惑，但我过去做过。我在 Stephen Walther ASP.NET Unleashed 一书中找到了很好的信息，其中有完整的部分致力于实现这一目标。

# asp.net - 强制 CascadingDropDown 刷新而不重新加载页面

> ID：447641
> 
> 赞同：0
> 
> 时间：2009-01-15T17:17:44.217
> 
> 标签：asp.net, ajax, cascadingdropdown

如何在不`CascadingDropDown`刷新页面的情况下强制刷新其数据？我在页面上有一个按钮，它向 Session 添加了一个变量，然后用于设置所有下拉列表的选定值。但是，如果不完全刷新页面，我似乎无法强制刷新 DropDownList。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T18:23:19.547

让我们看看——你页面上的按钮可能有一个与之关联的事件来响应它被点击，对吧？

你不能重新加载数据并将数据重新分配给按钮`OnClick`事件中的下拉列表吗？

```
public void OnButtonClick(.....)
{
  .....
  CascadingDropDown.DataSource = .......;
  CascadingDropDown.DataBind();
} 
```

还是我错过了什么？

# sql - SQL Server - 同步两个数据库

> ID：447647
> 
> 赞同：1
> 
> 时间：2009-01-15T17:19:50.017
> 
> 标签：sql, sql-server, database, database-design

我们有一个仓库数据库，其中包含到目前为止一年的数据。我想创建代表过去 3 个月数据的报告数据库以用于报告目的。我希望能够使两个数据库保持同步。现在，我每 10 分钟执行一次包，该包将从仓库中获取最新的行并将它们添加到报告数据库中。问题是我只得到新行而不是新更新。

我想知道解决这种情况的各种方法是什么。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T17:23:13.350

查看复制、镜像或日志传送

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T21:22:43.240

如果您使用的是 SQL 2000 或更低版本，复制是您的最佳选择。由于您每十分钟执行一次，因此您绝对应该查看事务复制。

如果您使用的是 SQL 2005 或更高版本，则可以使用更多选项。SQLMenace 上面建议的数据库快照、日志传送和镜像。这些的适用性取决于您的硬件。您必须进行一些研究才能选择最适合您需求的产品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:22:00.153

您可能应该阅读有关复制的信息，或者询问您的数据库管理员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T17:25:31.377

是否可以向该数据库添加列？您可以将 Last_Activity 列添加到数据库并编写一个触发器来更新该行上的日期/时间戳以反映最新的编辑。对于任何新条目，日期/时间将反映添加行时的时间戳。

这样，当您抓取过去三个月时，您将抓取过去三个月的活动，而不仅仅是新的东西。

# excel - 从 Excel 合并列中检索值

> ID：447657
> 
> 赞同：8
> 
> 时间：2009-01-15T17:22:06.487
> 
> 标签：excel, formula, excel-formula

我正在`hlookup`反对一个跨越多列的值。我的数据与此类似：

```
 A      B      C      D 
  ---------------------------  
1|       Col1          Col2
2|     x      y      z      w
3|
4| 
```

在第 3 行和第 4 行（A3、B3、C3、D3 等）中，我想在工作簿的其他位置放置可以进行 hlookup 的公式。诀窍是，我希望它在 A 和 B 列中查找“Col1”，在 C 和 D 列中查找“Col2”。“Col1”在 A1 中，但实际上是 A1 和 B1 合并的。当我引用 A1 时，出现“Col1”，但当我引用 B1 时，返回值为空白。

有任何想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-06-12T17:52:58.953

这是另一种解决方案，当合并的单元格具有不同的宽度时也可以使用，让我用一个例子来说明：

1.  打开一个新的Excel，合并*B1、C1、D1*
2.  在合并的单元格中键入**Col1**
3.  在*B2*中，键入公式**=B1**，在*C2* **=C1**中，在*D2* **=D1中**
4.  您应该看到*B2*是**Col1**而*C2、D2*是**0**
5.  在*B3*中，输入公式**=A3**，复制它
6.  右键单击合并的单元格*B1:D1*，选择“选择性粘贴 -> 公式”
7.  您应该看到合并的单元格为**0**
8.  在合并的单元格中键入**Col1**
9.  您现在应该看到所有*B2、C2、D2*都是**Col1**，即现在您可以按照您的预期引用合并的单元格。

如果您可以合并多个单元格，每个单元格的宽度都不同，只需将公式一次性粘贴到所有单元格中。

这项工作背后的原因是因为微软的[设计选择更加复杂](http://support.microsoft.com/kb/983435)。似乎当您在合并的单元格中粘贴公式时，每个底层单元格都会收到公式（相反，如果您输入一个值，只有左上角的单元格会收到它）所以您可以利用它并粘贴引用的公式它旁边的单元格，然后用您想要的值覆盖左上角的单元格，然后合并单元格下面的每个单元格都将具有该值。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-15T17:43:47.020

要访问“Col1”和“Col2”标签，您可以使用以下命令：

> =INDEX($1:$1,1,COLUMN()-MOD(COLUMN()-1,2))

注意：这假设您将相同数量的单元格组合在一起。如果是三个单元格，您只需将公式中的最后一个数字更改为 3，依此类推。

**编辑：**这是它的工作原理：

INDEX($1:$1,1, x ) 返回第 1 行第 x 列中单元格的值。如果您的表格实际上不在工作表的左上角，您可以将其更改为包含所有合并标签的实际范围。在这种情况下，它将是： INDEX($A$1:$D$1,1, x )

COLUMN() 返回当前单元格的列号（A 列 1，B 列 2 等）

MOD(COLUMN()-1,x) 返回从当前列到保存正确标签的列的偏移量

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-07-22T15:31:38.627

我在 vba 中构建了一个简单的函数来解决这个问题：

```
Function mergedText(rngMergedCell As Range)

    If rngMergedCell.MergeCells = True Then
        mergedText = rngMergedCell.MergeArea(1, 1)
    Else
        mergedText = rngMergedCell
    End If

End Function 
```

如果单元格是合并单元格，该函数将返回合并单元格的第一个元素中的值 - 这是合并单元格存储其值的位置

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-22T11:34:24.243

e.James 提议的一个更通用的变体是：

```
={INDEX($A$1:A1, 1, MAX(NOT(ISBLANK($A$1:A1))*COLUMN($A$1:A1)-COLUMN($A$1)+1))} 
```

这依赖于合并的单元格除了第一个单元格之外是空的这一事实（除非您遇到像 Martin 的提议那样的情况）。

注意：大括号用于标记数组公式（不要输入它们，只需按 alt+return 即可验证单元格中的公式）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-28T16:36:36.993

我意识到我迟到了这个线程，但我找到了一个非常简单的答案。

例如，如果您的标签在 a1:d1 的 4 列中合并，并且如果您引用 b1，您将返回 ""。要动态查找正确的标签，请在新表中使用此 fx：

```
=if(OriginalTable!B1="",ThisTable!A1,OriginalTable!B1) 
```

我相信您会意识到，当您拖过时，这将捕获 e1:h1 等中的范围。

就是这样。希望它可以帮助某人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T17:39:03.177

单元格 B1 和 D2 不包含任何值，只有 A1 和 C1 里面有东西。

因此，您只需确保 A 列和 B 列中的公式都将 A1 引用为查找值，并且 C 列和 D 列中的公式都将 C1 引用为查找值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-29T17:39:54.963

有了新的动态参考，现在有更多的选择。这是我编写的一个通用函数，它将搜索单元格的左侧并返回第一个值。它没有优化，但它为我完成了这项工作。

```
=LET(
TargetCell, A1,
TargetRow, ROW(TargetCell),
TargetCol, COLUMN(TargetCell),
RowReference, INDIRECT(TargetRow & ":" & TargetRow),
RowValues, TRANSPOSE(FILTER(RowReference,ISBLANK(RowReference)=FALSE)),
RowValueColumns, MATCH(RowValues, RowReference,0),
ReturnColumn, MAX(FILTER(RowValueColumns,RowValueColumns<=TargetCol)),
Return, INDIRECT(ADDRESS(TargetRow,ReturnColumn)),

Return
) 
```

# javascript - 我可以在 JavaScript 中复制/克隆一个函数吗？

> ID：447658
> 
> 赞同：21
> 
> 时间：2009-01-15T17:22:10.217
> 
> 标签：javascript, jquery, validation, jquery-validate

我将 jQuery 与验证器插件一起使用。我想用我自己的一个替换“必需的”验证器。这很简单：

```
jQuery.validator.addMethod("required", function(value, element, param) {
    return myRequired(value, element, param);
}, jQuery.validator.messages.required); 
```

到现在为止还挺好。这工作得很好。但我*真正*想做的是在某些情况下调用我的函数，其余情况下调用默认验证器。不幸的是，这是递归的：

```
jQuery.validator.addMethod("required", function(value, element, param) {
    // handle comboboxes with empty guids
    if (someTest(element)) {
        return myRequired(value, element, param);
    }
    return jQuery.validator.methods.required(value, element, param);
}, jQuery.validator.messages.required); 
```

我查看了验证器的源代码，“required”的默认实现在 jQuery.validator.messages.required 中定义为匿名方法。所以没有其他（非匿名）对我可以使用的函数的引用。

在调用 addMethod 之前在外部存储对函数的引用并通过该引用调用默认验证器没有区别。

我真正需要做的是能够通过值而不是通过引用来复制默认所需的验证器函数。但经过相当多的搜索，我无法弄清楚如何做到这一点。是否可以？

如果不可能，那么我可以复制原始函数的源代码。但这会产生维护问题，除非没有“更好的方法”，否则我宁愿不这样做。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-15T17:42:35.620

> 在调用 addMethod 之前在外部存储对函数的引用并通过该引用调用默认验证器没有区别。

这正是*应该起作用*的。

```
jQuery.validator.methods.oldRequired = jQuery.validator.methods.required;

jQuery.validator.addMethod("required", function(value, element, param) {
    // handle comboboxes with empty guids
    if (someTest(element)) {
        return myRequired(value, element, param);
    }
    return jQuery.validator.methods.oldRequired(value, element, param);
}, jQuery.validator.messages.required); 
```

这也应该有效：（问题`this`已解决）

```
var oldRequired = jQuery.validator.methods.required;
jQuery.validator.addMethod("required", function(value, element, param) {
    // handle comboboxes with empty guids
    if (someTest(element)) {
        return myRequired(value, element, param);
    }
    return oldRequired.call(this, value, element, param);
    // return jQuery.oldRequired.apply(this, arguments);
}, jQuery.validator.messages.required); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-03-29T20:20:05.177

```
Function.prototype.clone = function() {
    var fct = this;
    var clone = function() {
        return fct.apply(this, arguments);
    };
    clone.prototype = fct.prototype;
    for (property in fct) {
        if (fct.hasOwnProperty(property) && property !== 'prototype') {
            clone[property] = fct[property];
        }
    }
    return clone;
}; 
```

唯一不好的是原型没有被克隆，所以你不能真正改变它......我正在研究一种克隆任何类型对象的方法，我只剩下 RegExp 要做。所以我明天可能会编辑并放置整个代码（如果你只将它用于函数和对象，那么它有点长并且没有优化。

并评论其他答案，使用 eval() 是完全愚蠢的，而且太长了，并且 Function 构造函数是一样的。字面量要好得多。并且仅仅为此包括 JQuery，而且如果它不能正常工作（我认为它不能正常工作）并不是你能做的最聪明的事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-07-21T07:30:42.643

这是一个更新的答案

```
var newFunc = oldFunc.bind({}); //clones the function with '{}' acting as it's new 'this' parameter 
```

然而 .bind 是 JavaScript 的一个新特性，但是 Mdn 有一个解决方法

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)

此外，它不会克隆函数的附加属性。

**注意：**正如@gsnedder 指出的那样：绑定语句，您提供的“this”参数（上面的空白{}）。无论是否通过 apply()/call() 函数覆盖，都将保留该函数的任何未来调用。

这可以对您有利或不利，具体取决于您如何处理它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-15T17:58:38.800

我认为您只是缺少一些范围界定。试试这个：

```
jQuery.validator.methods._required = jQuery.validator.methods.required;
jQuery.validator.addMethod("required", function(value, element, param) {
    // handle comboboxes with empty guids
    if (someTest(element)) {
        return myRequired(value, element, param);
    }
    return jQuery.validator.methods._required.call(this, value, element, param);
}, jQuery.validator.messages.required); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-03-18T21:53:02.740

（这应该只是对[Can I copy/clone a function in JavaScript?](https://stackoverflow.com/questions/447658/can-i-copy-clone-a-function-in-javascript/539104#539104)的评论......不幸的是，rep < 50 只能发布）

```
Function.prototype.clone=function(){
    return eval( '('+this.toString()+')' );
} 
```

就够了，甚至

```
Object.prototype.clone=function(){
    return eval( '('+this.toString()+')' );
} 
```

关于效率的想法：

*   人的效率远比浪费人力资源来优化或改善机器的“寿命”重要得多
*   计算机和自动化系统应该减少人力而不是增加人力
*   计算开销必须严重影响结果对许多人的可口性，以证明在优化代码方面投入的努力是合理的“理解”逻辑

关于克隆：这个问题可能是相当修辞的

*   “克隆”一个javascript对象是什么意思？尤其是在递归函数论的背景下
    *   使克隆合理化的一个共同主题是，它隔离并“保护”始创者免受其分身变化的影响
    *   如果`a = new Object(); b = new Object();` 是`a`和`b`克隆？怎么样`o = Object; a = new o(); b = new o();`
*   真的需要吗？
*   克隆在哪里停止？原型属性是否也被隔离，因此克隆对象对这些属性的更改不会影响与克隆对象无关的实例？在这种情况下，克隆必须一直沿原型链向上到达原始构造函数，它们本身需要以某种方式克隆和隔离（浏览器中的一个技巧是打开一个新窗口并用警告重新填充它`opener .`等仍然可以泄漏交叉效应）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-11T22:20:31.840

如果你想克隆一个函数，试试这个：

```
Function.prototype.clone=function(){
    return eval('['+this.toString()+']')[0];
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T17:31:54.767

听起来没有“更好的方法”。我想您可以尝试为自己制作自定义所需的功能，例如：

```
jQuery.validator.addMethod("customRequired", function(value, element, param) {
  return myRequired(value, element, param);
}, jQuery.validator.messages.required); 
```

听起来您已经尝试了其他所有方法。如果我误解了这个问题，我深表歉意。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-09T19:32:24.857

回答上一篇文章，当我需要共享一个构造函数，同时保持不同的原型时，我在一个新的 Function 中使用了一个包装器：

`

```
init_from_arg_obj = function () {
    return new Function('init', 'for (var i in init) this[i] = init[i];');
};

constructor_A = init_from_arg_obj();
constructor_A.prototype = {a: 'A'};

constructor_B = init_from_arg_obj();
constructor_B.prototype = {b: 'B'}; 
```

`

我运行了几个测试来验证这不会减慢好的 JS 引擎的执行速度。

# xml - 使用 XML 解析器动态创建 XHTML 代码

> ID：447659
> 
> 赞同：1
> 
> 时间：2009-01-15T17:22:32.977
> 
> 标签：xml, xhtml, parsing, server-side

开发服务器端代码我终于看到了我的眼睛 X-crossed 试图编写 - 然后当然理解 - 表单或其他 html 代码，其中双引号内的文本字符串（属性）必须出现在标记字符串（标记）中正确打开和关闭; 但通常必须实例化撇号内的 javascript 文本，经常引用其他文本（当然，在引号内）或实例化必须放置在语言相关标记中的计算值

这是一团糟，是通向失明和疯狂的主要道路，也是浪费我时间试图弄清楚为什么表格中的最后一个单元格在表格标题之前呈现的肯定方法 - 当然，我错过了一串撇号512 个字符。在尝试重新发明轮子，制作一些 API 来管理无法管理的问题之后，我看到了这个可能的解决方案：好吧，该死的 xhtml 实际上是 XML。那么为什么不使用 XMl 解析器（在服务器上）从头开始创建文档片段，根据我的意愿添加子节点来填充它，然后让解析器序列化所有片段树，处理诸如打开和关闭标记等愚蠢的细节，添加撇号和所有其他类似的东西？仅在后台使用它应该保持服务器上的低工作量 - 这个星球上只有少数人可以验证和访问重要的东西，所以对象的创建和释放是可以接受的。

我的问题是：您认为这是解决上述问题的好方法吗？也许我忽略了更简单的解决方案？有什么问题我没看到？是不是有点矫枉过正？具有讽刺意味的“恭喜，你终于明白了”被接受了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T17:41:28.240

在服务器端动态构建 DOM，然后转储生成的 HTML（或 XHTML）是最**严肃**的服务器端技术所做的。也许他们不使用原始 XML 来做这件事——也许他们有自己的类结构/API 可以用来做这件事，但这是他们遵循的基本范式。

至于“恭喜，你终于明白了”，我会说你走在正确的道路上。您没有提到具体的技术，但我猜您一直在使用基本的 PHP 或 Perl 创建原始 HTML。恭喜，你最终完成了我们其他人所做的事情：想知道是否有更好的方法。我建议您研究一些重要的 Web 应用程序框架，例如 ASP.NET MVC、Ruby on Rails、Struts 或 Twisted。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T17:29:20.777

是的，我正在使用框架的与 XML 相关的类来解析 XHTML，并创建 XHTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:30:44.613

我认为具有讽刺意味的“恭喜，你终于明白了”是这里最合适的答案。XHTML 是 XML 的一个子集，因此任何 XML 工具都能够为您正确地完成这项工作，并允许您专注于内容，而不是内容的格式。

基本上，有更多的 XML 解析器和文档模型，你无法动摇。除非您对性能有特殊需求并且制作自定义 XML 字符串对您来说更有意义，否则使用这些库之一是最好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T02:56:34.730

这正是 XSLT 的发明目的：将 XML 文档转换为 XML 文档而不会搞砸任何事情。一旦您了解了 XSLT（遗憾的是，这需要做一些事情），那些困扰您的问题现在就完全从您的生活中消失了。

# c# - 处理带有已删除记录和数据绑定控件的查找表

> ID：447676
> 
> 赞同：1
> 
> 时间：2009-01-15T17:28:57.127
> 
> 标签：c#, database

我有一个带有字段*Type的表**Resource*。*Type*是对表*ResourceType*的查找。

 ***因此，例如 ResourceType 可能有： 1：书籍 2：糖果 3：两者

Resource 可能有 1：Tom's Grocery，2 2：Freds News，3

它将显示为：Tom's Grocery Candy

现在假设我正在为资源类型使用数据绑定组合框，并且从 ResourceType 中删除了第三条记录，当显示*Fred 的新闻*时我们当然会得到一个错误。我可以简单地在里面放一个标记（也许是一个星号），表明它已被删除，而不是实际删除它。它在组合的文本框部分显示为 **Both*，我很满意。

但是，我不希望它在下拉列表中显示为*选项*。这对数据绑定字段来说要求太多了吗？我必须编写自己的代码来加载下拉菜单吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T17:31:16.983

在查找表中添加一个已删除的列。当你删除一个类型时，设置Deleted = 1。当你拉回ResourceTypes时，只拉出Deleted = 0的ResourceTypes，然后绑定到下拉列表。

**编辑：** 您如何获取绑定到下拉列表的数据集？您是否使用拖放数据集？多年来我真的没有使用过这样的数据集，但我很确定你可以将 Get sql 更改为你需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T17:35:42.183

好的，我已经在解决方案中内置了大部分内容 - 但我必须绑定错误。如果我只拉回已删除 = 0 的记录，我会得到异常 - 我猜是因为无法从记录集中填充文本框。

我想我不确定如何将文本框显示绑定到一个数据集 - 一个包含所有记录的数据集 - 以及下拉到过滤数据集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T12:21:19.360

仅添加已删除的列是不够的 - 必须有一种方法可以在组合框的文本部分查看已删除的记录，同时在下拉列表中过滤掉已删除的记录。

最后，我编写了一个自定义用户控件来处理这个问题。

# http - HTTP 标头字段“Content-Location”的用途是什么？

> ID：447679
> 
> 赞同：42
> 
> 时间：2009-01-15T17:29:33.210
> 
> 标签：http, http-headers

对我的问题的评论感到困惑/受到启发[搜索引擎是否尊重 HTTP 标头字段“Content-Location”？](https://stackoverflow.com/questions/438413/do-search-engines-respect-the-http-header-field-content-location)，我想知道，[`Content-Location`HTTP 中的 header 字段](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.14)的确切用途是什么以及如何使用它。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-15T20:25:53.947

作为对 GET 请求的响应，当请求的资源具有多种可用的表示形式（例如多种语言）时，可以使用 HTTP 中的 Content-Location。返回的资源的选择将取决于原始 GET 请求中的 Accept 标头。

通常，Content-Location 标头中指定的位置与原始请求的 URI 中指定的位置不同。

响应 PUT 或 POST 请求，

*   如果 Content-Location URI 与请求的 URI 不同，则指定 URI 处的缓存条目无效。（见[https://www.rfc-editor.org/rfc/rfc7234#section-4.4](https://www.rfc-editor.org/rfc/rfc7234#section-4.4)和[https://www.rfc-editor.org/rfc/rfc2616#section-13.10](https://www.rfc-editor.org/rfc/rfc2616#section-13.10)）
*   如果 Content-Location URI 与请求的 URI 相同，那么这向缓存表明对 PUT/POST 请求的响应与在同一位置对 GET 请求的 200 响应将收到的响应相同因此可以被缓存。（请参阅[https://www.rfc-editor.org/rfc/rfc7231#section-3.1.4.2](https://www.rfc-editor.org/rfc/rfc7231#section-3.1.4.2)）请注意，Firefox 和 Chrome 似乎没有实现这一点。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-06-27T10:07:23.260

Content-Location HTTP 标头应该声明用于响应 HTTP GET 的资源的唯一位置（例如 request was `GET /frontpage HTTP/1.1`，服务器可以添加 HTTP 标头通知用户代理，如果以后需要此特定响应，则提供位置应该使用，因为原始位置可能取决于各种事物，然后应通过“ ”标题进行解释）。`Content-Location: [http://domain.com/frontpage.english.msie-optimized](http://domain.com/frontpage.english.msie-optimized)``Vary`

但是，请注意 HTTP Content-Location 标头在实际使用中存在问题，因为不同的浏览器（用户代理）处理它的方式不同： http: [//mail.python.org/pipermail/web-sig/2004-October/000985.html](http://mail.python.org/pipermail/web-sig/2004-October/000985.html)

这是因为 RFC 2616 第 14.14 节说“Content-Location 的值还定义了实体的基本 URI”。简而言之，一个兼容的用户代理将使用 Content-Location 标头计算获取的文档的 BASE URL，如果获取的文档没有定义 BASE url 并且实际获取的 URL 和 Content-Location 差异足够大，这可能会导致使用不同的相对 URL （URL 的“目录”/“路径”部分不同）。

此外，我还没有看到使用 HTTP Content-Location 的任何优势（我曾经希望这可以用于提示永久书签位置，以防当前查看的 URL 不稳定，例如 domain.com/news/latest 但情况似乎并非如此）。

我目前的建议是忘记 HTTP 的 Content-Location，但您可以将它用于 MIME 电子邮件。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-02T09:20:57.047

[RFC 2616 的第 14.14 节](http://greenbytes.de/tech/webdav/rfc2616.html#rfc.section.14.14)规定：

> 当该实体可从与请求资源的 URI 不同的位置访问时，可以使用 Content-Location 实体头字段为消息中包含的实体提供资源位置...

这在[AtomPub (RFC 5023, Section 9.2)](http://greenbytes.de/tech/webdav/rfc5023.html#rfc.section.9.2.p.4)中使用：

> 如果创建请求包含一个 Atom 条目文档，并且来自服务器的后续响应包含一个与 Location 标头逐字符匹配的 Content-Location 标头，则客户端有权将响应实体解释为以下内容的完整表示新创建的条目。如果没有匹配的 Content-Location 标头，客户端不得假定返回的实体是已创建资源的完整表示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-27T00:41:42.830

如果您有兴趣，请查看 RFC2557： http: [//www.faqs.org/rfcs/rfc2557.html](http://www.faqs.org/rfcs/rfc2557.html)以获得更深入的解释。我目前正在为一堂课写这篇文章。它有点旧，但仍然相关。

# asp.net - 在 ASP.NET 中，您如何处理会话和多个选项卡？

> ID：447681
> 
> 赞同：4
> 
> 时间：2009-01-15T17:30:00.137
> 
> 标签：asp.net, session-state

我在 ASP.net 中编写了一个应用程序，旨在让用户将记录添加到数据库中。页面设置当用户添加记录时，在session中设置新添加记录的ID号，页面Response.Redirects到一个“Thank you for submit”页面，然后重定向回原来的页面允许进一步的编辑。用户还可以使用此屏幕上的返回按钮返回到原始记录添加页面，这允许他们对数据进行编辑。

但是，我发现将 ID 存储在会话中并不是一个非常好的解决方案，因为用户可能会尝试在不同的选项卡或窗口中创建两个文档。我也尝试在文字控件中设置 ID，但这会导致问题，即当用户使用后退按钮时，文字控件未设置为 ID，并且会添加新记录而不是编辑记录。

有什么解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T17:36:19.110

我建议将您的 ID 存储在 QueryString 中。添加记录后，重定向到您的“谢谢”页面，然后我猜该页面包含指向编辑表单的链接，您将使用查询字符串中的 ID 生成该链接。当该链接被点击时，编辑页面应该将 ID 从查询字符串中提取出来，以便加载正确的记录进行编辑。

您的添加和编辑表单甚至可以是同一个页面，当在查询字符串中提供 ID 时，您的表单知道要编辑该记录，否则您的表单会添加新记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T17:36:29.717

您是否尝试在查询字符串中添加 ID？然后您可以阅读它，并根据需要将其添加到会话中（比如用户单击后退按钮）。

似乎有很多问题允许在使用后退按钮时在呈现的页面中编辑对象。给他们一个编辑按钮会不会太过分了？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T18:27:20.223

愚蠢的问题，为什么用户可以使用后退按钮来编辑帖子中刚刚接受的数据？

如果编辑以前发布的数据是一种常见情况，为什么不直接在接受数据时重定向到允许他们编辑的页面。然后，如果点击后退按钮，他们将回到原来的“干净”插入/添加新数据页面。

这将给出以下流程 Add->[Post]->Edit->..... Add->[Post]->Edit->[Back button]->Add->[Post]->Edit-> [发布]->编辑....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T17:33:02.347

控件将其状态保存在 ViewState 中。如果您选择使用 SessionState 而不是 ViewState 来存储信息，则控件会将其状态保存在会话状态中，并且无法与多个选项卡一起正常工作。

我还没有找到在仍然使用 SessionState 的同时绕过这个问题的方法。我们的解决方案是使用普通的 ViewState。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T18:02:19.697

我已经尝试将 ID 存储在查询字符串中（这对于编辑来说非常好），但问题是当他们使用后退按钮时信息存储在会话中。如果用户执行以下操作：

1.  用户创建一条记录（第一条记录），ID 在查询字符串中传递，并临时存储在会话中。
2.  用户创建另一条记录（第二条记录），ID 在查询字符串中传递，临时存储在会话中。
3.  用户使用第一条记录上的后退按钮转到没有查询字符串的页面。

这可能是一个牵强的场景，但它可能会发生。我唯一的解决方案是阻止使用后退按钮返回添加页面，方法是在 JavaScript 中使用 window.history.forward()。但这作为一种解决方案是可怕的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T18:13:10.987

我的问题是你为什么要在会话中存储任何内容？如果您可以避免在会话中存储任何内容，我认为您会更好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T19:19:32.850

考虑到这一点，以下听起来像是我上面概述的问题的一个不错的解决方案吗？

*   首次添加记录时，将访问添加页面时的时间戳存储在隐藏字段中。
*   当用户单击保存时，此时间戳会通过会话传递。连同身份证。
*   如果用户同时打开另一个选项卡并保存，则新页面的时间戳将通过会话传递。
*   如果用户尝试访问第一条记录的添加页面（使用后退按钮），系统会查找会话，并查看是否有时间戳，以及它是否与该页面的隐藏字段中的时间戳匹配。
*   如果不匹配，则用户会收到提示，并被告知正确编辑记录。

这听起来合理，还是过于复杂？

# java - 使用 HttpClient 发布文件的内容？

> ID：447700
> 
> 赞同：2
> 
> 时间：2009-01-15T17:34:13.140
> 
> 标签：java, post, apache-commons-httpclient

我想使用 Apache HttpClient 将文件的内容作为 http 请求的一部分发送，但我不知道如何在请求正文中传递文件内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T04:50:53.833

你没有指定格式....

最有可能的是，您想发送一个 POST 请求，内容将是*multipart/form-data* MIME 类型。这模拟了浏览器从 <INPUT type="file" ...> 表单元素发送的内容。这需要在服务器端进行一些非常复杂的解析，以从正文中提取多个部分，并从其他字段（如果有）中正确提取文件数据。幸运的是，[commons-fileupload](http://commons.apache.org/fileupload/)完美地做到了这一点。关于[FilePart](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/methods/multipart/FilePart.html)的第一个答案是完全正确的。

[或者，您可以使用InputStreamRequestEntity](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/methods/InputStreamRequestEntity.html)简单地将文件的原始内容发布为请求的主体。如果您正在编写自己的服务器端来接收数据，这可能会简单得多。服务器端就像将请求的 InputStream 流式传输到磁盘一样简单。我使用这种技术通过 Google Gears 进行上传。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T17:58:14.167

查看[FilePart](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/methods/multipart/FilePart.html)和相关的。

这是[示例](http://svn.apache.org/viewvc/httpcomponents/oac.hc3x/trunk/src/examples/MultipartFileUploadApp.java?view=markup)。

# delphi - 自定义 TListBox 以类似于 Outlook 列表

> ID：447704
> 
> 赞同：0
> 
> 时间：2009-01-15T17:34:51.843
> 
> 标签：delphi, article, tlistview

如果这不合适，请给我投反对票，但我迫切地想要拔出我的头发来寻找这个链接。这真的是不得已而为之。

最近，我浏览了一个博客（至少我认为是这样），该博客非常详细地描述了如何修改 TListBox 以使其具有类似于 Outlook 电子邮件列表中的某些条目的多行外观，并带有标题和初始内容。这是一个特别好的示例，因为它包含修改后的 TItem 和 TItemList 对象的所有代码以及具有该外观的图像加载

我搜索了我的 Firefox 历史、我的 Chrome 历史、我的 FeedDemon 订阅源和我的 Google 书签，但无济于事。我已经用 TListBox、TListView、TItems、TItemList、Custom、Extended 和其他一些变体进行了 Google 搜索，甚至查看了 3 页结果无济于事......

有没有人偶然发现这篇文章？
请让一个“老人”恢复他的记忆和他的理智:)

干杯，
格斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T18:41:43.020

[如何使用](http://www.delphidabbler.com/articles?article=16)是“TListbox Ownerdraw Delphi”为我找到的。当然，Ownerdraw 就是你正在寻找的做这种事情的东西。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-03T14:05:06.147

用正确的答案回答我的问题：

[Blaise Pascal 杂志](http://www.blaisepascal.eu/) [2008 年 11 月 4 日](http://blaise-pascal.eu/index.php?actie=./blaisepascal_4/issue4) [第 27 页](http://blaise-pascal.eu/paydownloads/Nr4/BlaiseUK4Downloadable.pdf)。

# multithreading - 锁定 HttpRuntime.Cache 以进行延迟加载

> ID：447705
> 
> 赞同：3
> 
> 时间：2009-01-15T17:35:06.383
> 
> 标签：multithreading, caching, synchronization, locking, httpruntime

我们有一个运行 .NET 2.0 的网站，并已开始使用 ASP.Net HttpRuntime.Cache 来存储频繁数据查找的结果，以减少我们的数据库访问。

片段：

```
 lock (locker)
{
    if (HttpRuntime.Cache[cacheKey] == null)
    {
        HttpRuntime.Cache.Insert(cacheKey, GetSomeDataToCache(), null, DateTime.Today.AddDays(1), Cache.NoSlidingExpiration);       
    }
    return ((SomeData)HttpRuntime.Cache[cacheKey]).Copy();
} 
```

每当我们想查看缓存时，我们都会悲观地锁定。但是，我已经看到网络上发布的各种博客建议您在检查缓存值后锁定，以免产生锁定的开销。这似乎不对，因为检查后另一个线程可能已写入缓存。

所以最后我的问题是这样做的“正确”方法是什么？我们甚至使用了正确的线程同步对象吗？我知道 ReaderWriterLockSlim() 但我们正在运行 .NET 2.0。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-15T17:40:33.063

据我所知 Cache 对象是线程安全的，所以你不需要锁。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T17:45:59.107

.NET 中的 Cache 对象是线程安全的，因此不需要锁定。参考：http: [//msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-11T17:25:20.937

您的代码可能让您认为您会将该项目缓存 1 天，并且您的最后一行将始终向您提供该数据，但事实并非如此。正如其他人所说，缓存操作是同步的，所以你不应该在那个时候锁定。

看看这里[的正确方法](https://stackoverflow.com/questions/1029823/problem-using-httpruntime-cache/1096544#1096544)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-23T08:59:34.780

**线程安全。这是否意味着所有其他进程都在等待您的代码完成？**

线程安全是您可以确保在读取项目的同时，您获取的项目不会被“切成两半”或因缓存更新而部分拆除。

```
item = cache.Get(key); 
```

但是你之后做的任何事情——另一个线程可以对缓存（或任何其他共享资源）进行操作。如果你想根据你获取的项目是否为空来对缓存做一些事情，我不会 100% 确定它还没有被你自己的代码的另一个实例修复，因为前面有一些 CPU 指令为另一个阅读器提供服务您的在线电机杂志的同一页。

*你需要一些坏运气。在几行代码中，其他进程干扰同一个非原子缓存对象的风险随机小。但如果发生这种情况，您将很难弄清楚为什么雪佛兰的形象有时是第二页中的小手提箱。*

# c# - 在调试时编辑 C#

> ID：447706
> 
> 赞同：24
> 
> 时间：2009-01-15T17:35:16.897
> 
> 标签：c#, visual-studio-2008, debugging, editing

我知道我以前处理过这个问题，但是覆盖它的设置似乎总是在变化。

我在 Visual Studio 2008 中有一个 C# 项目。当我在调试时，VS 不会让我编辑我的代码。我不想编辑并继续 - 我只想为我的下一个版本进行更改。编辑并继续被禁用。当我在调试项目时尝试编辑文件时，我收到一条消息，指出文件现在是只读的。

有人最近在 VS2K8 中处理过这个问题吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-15T17:52:03.477

工具 + 选项，调试 + 编辑并继续。关闭启用复选框。您现在可以编辑源代码。进行更改后继续调试时会收到警告。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T17:36:44.367

我不确定为什么“编辑并继续”对您不起作用。如果您正在调试并附加到您正在调试的进程，您的页面应该被锁定，否则调试器无法向您显示正在运行的内容。

这是对编辑并继续的参考。 [http://whyiamright.wordpress.com/2007/12/20/aspnet-edit-and-continue-in-visual-studio-2005/](http://whyiamright.wordpress.com/2007/12/20/aspnet-edit-and-continue-in-visual-studio-2005/)

如果您正在为下一个构建进行编程，那么尝试调试您当前的构建对我来说没有意义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T17:48:48.337

上次我遇到这个问题时，我通过更改以下设置来修复它：
项目属性 -> 编译 -> 高级编译选项 -> 将“生成调试信息”设置为“**完整**”并取消选中“启用优化”。

为我工作。不过不知道你怎么样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T17:50:41.077

我刚刚在 VS2k8 中尝试过这个。我所要做的就是在“工具”>“选项”>“调试”菜单中启用“编辑并继续”。

当您将项目设置为发布模式时，您将无法使用 E&C

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T18:00:08.640

感谢大家的意见，即使是直接相互矛盾的评论。我曾尝试启用和禁用 Edit-and-Continue 几次，但没有任何效果。但是，我刚刚重新启动了 VS，现在我的启用/禁用 E&C 正在影响我在调试期间的编辑能力，正如我所期望的那样。我猜这只是VS中的一个错误......

再次感谢。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-15T07:10:49.790

在 VS 2010 中，转到 Debug->Options->tick Enable Address Level Debugging :) reverse 进行反向操作 :)

# c# - 将 IoC 容器引入遗留代码

> ID：447715
> 
> 赞同：10
> 
> 时间：2009-01-15T17:36:46.800
> 
> 标签：c#, .net, design-patterns, dependency-injection

我正在编写一个新的 .NET 库供我公司内部使用，它将通过依赖注入使用 IoC。当然，如果我们使用 IoC 容器来解析实例，这个库会更容易使用。

但是，将调用此库的代码当前不使用任何类型的依赖注入，并且重构遗留代码以使用 DI 超出了我的项目的范围。那么，在这个遗留代码中开始使用容器从我的新库中获取实例的最佳方法是什么？

如果可能的话，我想避免在我选择的任何 IoC 容器中使用硬引用的旧代码乱扔垃圾。由于我对 DI 比较陌生，因此我们很可能会在某个时候改变我们想要使用哪个 Container 的想法。

如果我将容器包装在 CodePlex 上的[CommonServiceLocator](http://www.codeplex.com/CommonServiceLocator)库之类的东西中，那会是一种合理的方法吗？

其他人做了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T18:20:43.670

您可以使用外观/代理模式从旧容器中隐藏 DI 容器。您实际上是将您的遗产硬连接到您实现的自定义类，该类将了解 DI 容器。现在，如果您修改您的 DI，您将更新您的外观而不是您的遗留代码。

我没有对 Common Service Locator 进行大量研究，但前提是它可能是一个很好的解决方案。您可能希望将外观与 CSL 联系起来，这将从您的遗留代码中完全隐藏 DI 概念。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-20T21:47:23.087

据我了解您的问题，您想从旧代码中调用启用 DI 的代码。

最好的选择是保持新库[DI 友好，但与容器无关](https://stackoverflow.com/questions/2045904/dependency-inject-di-friendly-library/2047657#2047657)。

这样做，您可以提供遗留代码可以使用的简单外观。旧版应用无需使用任何 DI 容器，也无需 Common Service Locator。

# user-interface - D 的 GUI 库

> ID：447717
> 
> 赞同：22
> 
> 时间：2009-01-15T17:37:53.507
> 
> 标签：user-interface, d

用 D 语言进行 GUI 编程的现状如何？语言开发人员计划在标准库中包含 GUI 吗？

**清单（根据答案编译）**

[DWT（SWT 绑定）](http://www.dsource.org/projects/dwt)

[GtkD（GTK 绑定）](http://www.dsource.org/projects/gtkd)

[wxD（wxWidgets 绑定）](http://wxd.sourceforge.net)

[QtD（Qt 绑定）](http://code.google.com/p/qtd/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T17:43:47.863

最成熟的一个是[DWT](http://www.dsource.org/projects/dwt)，它是 SWT 到 D 的一个端口。还有[DFL](http://www.dprogramming.com/dfl.php)和大量与其他语言编写的 GUI 库的[绑定。](http://www.prowiki.org/wiki4d/wiki.cgi?GuiLibraries)其中大多数还没有那么成熟，但 DWT 是。但是，要记住的一件事是 D2 即将推出，因此您可能需要检查该库是否有可能快速移植到 D2。

我怀疑这些中的任何一个都会很快包含在标准库中。“官方”标准库 Phobos 的态度相当简约。“非官方”标准库 Tango 不是那么简约，但仍然有更多的系统编程倾向。顺便说一句，如果它不在*标准*库中有什么区别？我可以明白为什么这对于小型杂项功能很重要，其中查找、安装等库的工作量与库添加的功能量相比意义重大，但对于 GUI 之类的大功能则不重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T17:42:46.180

你可能想看看[wxd](http://wxd.sourceforge.net/)，一个用于 D 的 wxWindows 库。

这听起来像你想要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-11T14:02:20.857

从站点 dlang.org（来自 FAQ dlang.org/faq.html）：http://wiki.dlang.org/GUI_Libraries 我发现：[http :](http://www.prowiki.org/wiki4d/wiki.cgi?action=browse&id=GuiLibraries&oldid=AvailableGuiLibraries)
[//www.prowiki.org/wiki4d/wiki.cgi? action=](http://wiki.dlang.org/GUI_Libraries) [browse&id=GuiLibraries&oldid=AvailableGuiLibraries](http://www.prowiki.org/wiki4d/wiki.cgi?action=browse&id=GuiLibraries&oldid=AvailableGuiLibraries) 有一个 GUI 库列表和它们的状态。 最后，从[http://www.dsource.org](http://www.dsource.org) : [http://www.http://www.dsource.org/projects](http://www.http://www.dsource.org/projects) 有一个分组项目列表。 其中一组名为“Libraries-GUI”。 我认为有一个完整的 D 语言 GUI 库列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T18:28:52.017

我认为 DWT 看起来是目前最成熟的可用解决方案，特别是如果您需要跨平台。至于标准库中包含的 gui，之前已经声明不会发生，无论是对于 Phobos 还是 Tango。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-16T23:55:31.447

[**Hybrid**](http://h3.team0xf.com/devlog/?p=6)看起来很有趣（虽然从未尝试过）。如果您是 java 开发人员，那么[**DWT**](http://dsource.org/projects/dwt)是从 swt 的自然迁移，否则我会推荐[**DFL**](http://www.dprogramming.com/dfl.php)。也可以查看[**dsource 列表**](http://dsource.org/projects)并向下滚动到 GUI-Libraries。

我认为 gui 库与标准库分开是一件好事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T18:27:47.057

作品中还有一个对[QT](http://code.google.com/p/qtd/)的绑定。目前没有用，但似乎是由 QT 工程师完成的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-23T03:25:12.927

DWT 现在不在 dsource 上，而是在 bitbucket 上：[DWT2](http://bitbucket.org/torhus/dwt2/)

# vb6 - 如何在vb6中判断系统状态是否空闲睡眠等

> ID：447718
> 
> 赞同：3
> 
> 时间：2009-01-15T17:38:03.240
> 
> 标签：vb6, system, state

我正在尝试制作自己的即时通讯工具，并希望用户在长时间未使用计算机的情况下进入空闲/离开模式。有没有人知道如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T20:20:09.617

这是我几年前实现此功能的方式。函数 fnIdleTime 将告诉您自用户触摸鼠标或键盘以来已经过了多少秒。

```
Public Declare Function timeGetTime Lib "WINMM.DLL" () As Long

Private Type LASTINPUTINFO
  cbSize As Long
  dwTime As Long
End Type

Public Declare Function GetLastInputInfo Lib "user32.dll" (plii As LASTINPUTINFO) As Long

Public Function fnIdleTime() As Long

  Dim lii As LASTINPUTINFO

  lii.cbSize = Len(lii)

  If (GetLastInputInfo(lii) > 0) Then
    fnIdleTime = (timeGetTime - lii.dwTime) \ 1000
  End If

End Function 
```

# tfs - 在 Team Foundation Server Universe 中发布网站

> ID：447729
> 
> 赞同：4
> 
> 时间：2009-01-15T17:40:21.333
> 
> 标签：tfs, publishing

这似乎应该很明显，所以也许我不明白一些事情。我有 TFS 设置。我的网络应用程序代码在源代码管理中。我可以签入/签出并创建构建，但我不太明白将代码发布到生产环境的推荐方法是什么？我正在寻找类似“发布到网络服务器”的东西，但找不到任何东西。我认为我更大的问题是我找不到一个好的工作流程图来说明团队应该如何从编辑代码转移到测试，然后再部署到 TFS 系统内的生产服务器。如果有人对在 TFS 内发布网站有任何想法或链接，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-06-25T23:11:54.230

对于工作流程，我建议使用代码提升模型。

在 TFS 中，您有构建质量的概念。因此，当您最初检查构建中的代码时，如果构建通过，测试人员可以决定何时要进行构建进行测试，当他们测试构建时，他们可以标记它作为“准备部署”，您可以使用该 realeas 进行部署。

除非 TFS 2010 中的情况发生了变化，否则您必须滚动自己的实现以进行部署。我们使用 MS build 使用 Wix 构建 MSI，然后让测试人员为我们测试部署过程。

查看以下 msbuild 扩展，以帮助部署到测试/实时环境：

*   [http://msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/-)

*   [http://msbuildextensionpack.codeplex.com/](http://msbuildextensionpack.codeplex.com/)

我真的建议你花一点时间在你的构建过程上，并把它弄得水泄不通，没有什么比部署一个无法正常工作的发布版本以及客户对它失去信心更尴尬的了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:38:13.250

我不相信 Team Build 中存在发布网站的内置机制，但这可以通过在构建定义中覆盖 AfterDropBuild 或 AfterEndToEndIteration 以包含将构建输出复制到 Web 服务器的必要任务来实现。

# c# - 使用 FBA 向 CreateUserWizard 控件添加列

> ID：447735
> 
> 赞同：0
> 
> 时间：2009-01-15T17:42:09.130
> 
> 标签：c#, asp.net, forms-authentication

我想在我们的网站上为未注册的用户创建一个用户帐户创建部分。我想问与 CreateUserWizard 控件相同的问题，但有一些更改。我希望问题来自 SQL 中的问题查找表。用户将有一个可用问题的下拉列表，我将存储他们选择的 questionid 和答案。另外，我想存储另一条关于用户（SSN）的数据。

我的问题是：1）如果使用 SSL，基于表单的身份验证是否是可接受的解决方案？2) 我可以在会员表或其他表中添加额外的列（questionid 和 ssn）吗？我该怎么做才能以“有福”的方式保存信息？如果我想添加密码重置/恢复，该解决方案是否会产生负面影响？

添加列时，调用 Membership.CreateUser 而不是使用 CreateUserWizard 是否有意义？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T17:59:14.463

1) 是的。[您可以使用Profiles](http://www.odetocode.com/articles/440.aspx)扩展 Membership ，并添加您喜欢的任意字段

2）您可以自定义 CreateUserWizard 很多，但在幕后它只是最终调用 Membership.Create 用户。就个人而言，除非您想使用默认向导，否则我只会自己动手（因为它真的不是那么难）。但这更多是个人喜好，而不是其他任何东西。

注意：我为 Profiles 提供的链接假定​​您使用的是 WebSite 项目。[如果您正在使用 Web 应用程序项目，您可以在此处](http://blog.falafel.com/2007/07/01/UsingASPNetMembershipProfilesInWebApplicationProjects.aspx)阅读一些额外的步骤。

# java - Java 性能测试

> ID：447739
> 
> 赞同：52
> 
> 时间：2009-01-15T17:43:21.263
> 
> 标签：java, performance, performance-testing

我想对 Java 应用程序进行一些计时测试。这就是我目前正在做的事情：

```
long startTime = System.currentTimeMillis();
doSomething();
long finishTime = System.currentTimeMillis();
System.out.println("That took: " + (finishTime - startTime) + " ms"); 
```

这样的性能测试有什么“错误”吗？有什么更好的方法？

**重复**：[秒表基准测试是否可以接受？](https://stackoverflow.com/questions/410437/is-stopwatch-benchmarking-acceptable)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-15T17:57:39.893

这种方法的一个缺陷是，`doSomething()`执行所需的“实际”时间可能会因系统上正在运行的其他程序及其负载情况而有很大差异。这使得性能测量有些不精确。

假设代码是单线程的，跟踪执行代码所花费的时间的一种更准确的方法是查看调用期间线程消耗的 CPU 时间。您可以使用 JMX 类来做到这一点；特别是，与[`ThreadMXBean`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/management/ThreadMXBean.html)。`ThreadMXBean`您可以检索from的实例[`java.lang.management.ManagementFactory`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/management/ManagementFactory.html)，并且，如果您的平台支持它（大多数都支持），请使用该[`getCurrentThreadCpuTime`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/management/ThreadMXBean.html#getCurrentThreadCpuTime())方法代替 进行`System.currentTimeMillis`类似的测试。请记住，`getCurrentThreadCpuTime`报告时间以纳秒为单位，而不是毫秒。

这是可用于执行测量的示例 (Scala) 方法：

```
def measureCpuTime(f: => Unit): java.time.Duration = {

  import java.lang.management.ManagementFactory.getThreadMXBean
  if (!getThreadMXBean.isThreadCpuTimeSupported)
    throw new UnsupportedOperationException(
      "JVM does not support measuring thread CPU-time")

  var finalCpuTime: Option[Long] = None
  val thread = new Thread {
    override def run(): Unit = {
      f
      finalCpuTime = Some(getThreadMXBean.getThreadCpuTime(
        Thread.currentThread.getId))
    }
  }
  thread.start()

  while (finalCpuTime.isEmpty && thread.isAlive) {
    Thread.sleep(100)
  }

  java.time.Duration.ofNanos(finalCpuTime.getOrElse {
    throw new Exception("Operation never returned, and the thread is dead " +
      "(perhaps an unhandled exception occurred)")
  })
} 
```

（请随意将以上内容翻译成 Java！）

这种策略并不完美，但它较少受到系统负载变化的影响。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-15T20:23:44.980

问题中显示的代码不是一个很好的性能测量代码：

1.  编译器可能会选择通过重新排序语句来优化您的代码。是的，它可以做到这一点。这意味着您的整个测试可能会失败。它甚至可以选择内联被测方法并将测量语句重新排序到现在内联的代码中。

2.  热点可能会选择重新排序您的语句、内联代码、缓存结果、延迟执行......

3.  即使假设编译器/热点没有欺骗您，您测量的是“墙上时间”。您应该测量的是 CPU 时间（除非您使用操作系统资源并希望也包括这些资源，或者您在多线程环境中测量锁竞争）。

解决方案？使用真正的分析器。周围有很多，免费的分析器和演示/广告强度的时间锁定试验。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T06:40:12.833

使用 Java Profiler 是最好的选择，它将为您提供对代码所需的所有洞察力。即响应时间、线程调用跟踪、内存利用率等

我会向你[**推荐 JENSOR**](http://jensor.sourceforge.net)，一个开源的 Java Profiler，因为它易于使用并且没有 CPU 开销。您可以下载它，检测代码，并获得您需要的有关代码的所有信息。

**您可以从以下网址下载： http : [//jensor.sourceforge.net/](http://jensor.sourceforge.net)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T17:49:43.887

请记住，`System.currentTimeMillis()`不同操作系统的分辨率不同。我相信 Windows 大约是 15 毫秒。因此，如果您的`doSomething()`运行速度快于时间分辨率，您将获得 0 的增量。您可以`doSomething()`在循环中运行多次，但随后 JVM 可能会对其进行优化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T17:45:14.070

我想你也想在开始计时之前 doSomething() ，以便代码被 JITted 和“热身”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T17:46:49.667

这只是性能测试的一部分。根据您正在测试的东西，您可能需要查看堆大小、线程数、网络流量或一大堆其他东西。否则，我会将这种技术用于简单的事情，我只是想看看它们需要多长时间才能运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T17:53:46.923

当您将一种实现与另一种实现进行比较或试图在代码中找到缓慢的部分时，这很好（尽管它可能很乏味）。这是一种非常好的技术，您可能会比其他任何技术都更频繁地使用它，但也要熟悉分析工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-15T18:06:46.163

您是否查看过[netbeans](http://profiler.netbeans.org/)和[eclipse](http://eclipsecolorer.sourceforge.net/index_profiler.html)中的分析工具。这些工具可以让您更好地处理代码中真正占用的时间。我发现了使用这些工具没有意识到的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T18:37:54.447

[Japex](https://japex.java.net/)可能对您有用，既可以作为一种快速创建基准的方法，也可以作为一种通过源代码研究 Java 中的基准问题的方法。

# javascript - Greasemonkey：更改网页中的文本？

> ID：447744
> 
> 赞同：5
> 
> 时间：2009-01-15T17:44:23.150
> 
> 标签：javascript, greasemonkey

我使用了以下功能：

```
document.getElementsByTagName('strong') 
```

获取具有该格式类型的页面中的所有文本。HTML 看起来像：

```
<td align="center" valign="bottom"><H1><font size="+4"><strong>TEXT_HERE</strong></font> <br> 
```

我想将“TEXT_HERE”更改为其他内容或将其全部删除。我该怎么做呢？

在此先感谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T17:54:17.047

用for循环？

```
var strongElems = document.getElementsByTagName('strong');
var wantToHide  = true || false;

for (var i=0; i<strongElems.length; i++)
{
  var thisElem = strongElems[i];
  if (wantToHide)
  {
    thisElem.style.display = "none"; // hide it
  }
  else
  {
    thisElem.textContent = "something else"; // change it
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T08:34:15.807

```
// ==UserScript==
// @name           MyScript
// @namespace      http://example.com
// @description    Example
// @include        *
//
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js
// ==/UserScript==

var shouldHide = false;

$('strong').each(function() {
  if(shouldHide) {
    $(this).hide();
  } else {
    $(this).text("New Text");
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T02:40:17.260

当我想更改网页中的某些文本时，我的 Greasemonkey 解决方案基于[DumbQuotes](http://diveintogreasemonkey.org/casestudy/dumbquotes.html)。我喜欢我可以轻松地将替换对定义到列表中：

```
replacements = {
  "old": "new",
  "foo": "bar",
}; 
```

也就是说，我也会检查 Tomalak 的解决方案。感谢您发布这个问题。

# sql - 如何最好地处理历史数据的存储？

> ID：447746
> 
> 赞同：13
> 
> 时间：2009-01-15T17:44:35.240
> 
> 标签：sql, database, data-storage

我正在尝试确定我应该如何存储历史交易数据。

我是否应该将它存储在一个表中，每次都会用新的时间戳重新插入记录？

我是否应该将历史数据分解为单独的“历史”表，并且只将当前数据保留在“活动”表中。

如果是这样，我该怎么做才能最好？使用自动将数据复制到历史表的触发器？或者在我的应用程序中使用逻辑？

**根据 Welbog 的评论更新：**

将有大量历史数据（数十万行 - 最终可能是数百万行）

主要搜索和报告操作将在历史数据上运行。

性能是一个问题。搜索不应该整夜运行以产生结果。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-15T17:53:42.430

如果要求仅用于报告，请考虑构建单独的数据仓库。这使您可以使用数据结构，例如缓慢变化的维度，这些数据结构更适合历史报告，但在事务系统中效果不佳。由此产生的组合还将历史报告从您的生产数据库中移出，这将是性能和维护方面的胜利。

如果您需要在应用程序中使用此历史记录，那么您应该实现某种版本控制或逻辑删除功能，或者使所有内容完全相反并重新声明（即事务永远不会被删除，只是被撤消和重新声明）。仔细考虑你是否***真的***需要这个，因为它会增加很多复杂性。制作一个可以正确重建历史状态的事务应用程序比看起来要困难得多。财务软件（例如保险承保系统）在这方面做得比您想象的要多得多。

如果您仅需要将历史记录用于审计日志，请制作影子表和审计日志触发器。这比尝试在应用程序中正确和全面地实现审计日志记录更简单、更健壮。触发器还将从应用程序外部的源中获取对数据库的更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T18:35:28.397

这个问题符合业务逻辑。首先了解您的业务需求，然后从那里开始。对于这种情况，数据仓库是一个很好的解决方案。ETL 将为您提供许多处理数据流的选项。您对“历史”与“活动”的基本概念是非常正确的。如果将历史数据保存在包含所有维度和事实表的数据仓库中，您的历史数据将更加高效和灵活。

# automation - 应用启动排序器

> ID：447757
> 
> 赞同：-2
> 
> 时间：2009-01-15T17:48:06.573
> 
> 标签：automation

每天早上当我开始工作时，我都会启动大约十几个应用程序和诸如此类的东西（FF、TB、VSx2-3、Eclipse、SSH、SVN 更新 x2-3）。需要说这可以很好地为我的硬盘预热一天。我宁愿怀疑如果它们按顺序启动它会运行得更快（更不用说我不需要在 17 个不同的地方单击）。

*是否有可以启动一系列任务/应用程序/等的预先存在的产品？每个任务只有在最后一个应用程序完成敲击硬盘后才开始？*

能够踢 VS 和 firefox 之类的应用程序，并且还能够触发 TortoiseSVN 中的 SVN 更新等资源管理器上下文菜单项，这将是一个书呆子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T17:55:52.673

不幸的是，我不知道有任何软件可以自动为您执行此操作。

但是，您不能通过控制台 SVN 任务触发更新吗？如果是这样，这不能通过创建批处理文件来完成吗？它的技术含量很低，您可能希望在每个任务之间添加一些暂停，但它应该可以满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T17:56:24.390

试试[SlickRun](http://www.bayden.com/SlickRun/1033/SlickRunHelp.htm)，它是免费的，我已经用了很多年了，我经常使用它，没有它我会迷路的。

把它想象成一个可配置的 Start->Run 命令，它会做你想做的事（你可以在多个命令之间配置 n 秒暂停），如果你安装它，你将在第一周之前将它用于一千种不同的事情出来了。

PS 我在 SlickRun 没有股份，我只是喜欢它 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T17:57:30.410

正如您提到的 TortoiseSVN，我假设您的操作系统是 windows。

您可以在启动时启动[Autohotkey](http://www.autohotkey.com/)脚本。我不认为它可以轻松检测到 HDD 活动，但您至少可以等到每个窗口出现时使用[WinWaitActive](http://www.autohotkey.com/docs/commands/WinWaitActive.htm)命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T18:17:15.423

如果每个应用程序都有完成所需的平均时间，您可以简单地使用 Windows 的计划任务应用程序。显然，您需要运行 Windows，但可以在控制面板中找到计划任务。

执行“添加计划任务”，选择程序、频率，然后选择具体时间。

# add-in - 为 MS Project 开发附加组件/扩展

> ID：447773
> 
> 赞同：3
> 
> 时间：2009-01-15T17:52:31.013
> 
> 标签：add-in, ms-project

我想为 MS Project 编写一个快速的 UI 插件，但我不知道如何继续。理想情况下，它应该完全集成到 Project 中。只需要知道如何开始。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T18:14:57.440

如果使用 Visual Studio：查看 Visual Studio Tools for Office (VSTO)！

[http://msdn.microsoft.com/en-us/office/aa905533.aspx](http://msdn.microsoft.com/en-us/office/aa905533.aspx)

# windows - 使用 schtasks.exe 指定计划任务的运行目录

> ID：447774
> 
> 赞同：44
> 
> 时间：2009-01-15T17:52:36.037
> 
> 标签：windows, windows-server-2008, scheduled-tasks, windows-task-scheduler

我有一个被计划任务调用的应用程序。它从 Windows Server 2003 移动到 Windows Server 2008。2003 年，该应用程序在可执行文件所在的目录中运行。On 2008 `Environment.CurrentDirectory`(C#) 报告它在 C:\Windows\System32 中运行。如何设置运行目录？我正在使用 schtasks.exe 进行命令行部署。

**UPD**：通过界面，似乎是动作编辑屏幕上的“开始（可选）”字段。

**UPD**：看起来使用 XML 文件可能会有所帮助，但我希望不用它。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2014-12-10T12:35:31.433

只是想添加对 Windows Server 2008 和 2012 有效的详细信息。许多人可以更好地理解屏幕截图，这里有一个屏幕截图：
![在此处输入图像描述](https://i.stack.imgur.com/em8uZ.png)

把它们加起来。当您为计划任务创建操作时，您可以选择设置“开始于（可选）”字段（在屏幕截图中以红色四舍五入）。这将是您的进程被触发的目录。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-21T14:02:04.193

我最近遇到了同样的问题。我解决它的方法是将 /V1 开关添加到 schtasks 命令。

/V1 创建一个 pre-vista 兼容的计划任务并自动填充 Start In 目录。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-18T17:53:39.460

您可以使用以下命令设置目录中的开始

关键是 /tr 开关中的 \。

```
SCHTASKS /Create /u username /p pswd /ru "NT AUTHORITY\SYSTEM"
  /rp /sc ONSTART /tn task-name /tr "\"D:\name-of-file-to-run\" " 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-06T18:45:01.617

请参阅[我对类似问题的回答](https://stackoverflow.com/questions/497945/using-schtasks-from-the-command-line-what-parameter-will-wake-the-computer-from/506362#506362)，即如何设置“唤醒计算机以运行此任务...”选项，该选项只能从任务计划程序 UI（和通过 XML）获得，而不是`schtasks.exe /create`命令行。

它的螺母和螺栓是：

1.  通过创建您的任务`schtasks.exe /create /tn MyTask ...`
2.  通过将您的任务导出到 XML`schtasks.exe /query /xml /tn MyTask > MyTask.xml`
3.  通过 XSLT 或搜索/替换更新此 XML
4.  通过重新导入（覆盖旧任务）`schtasks.exe /create /tn MyTask /xml MyTask.xml /f`

[详情在这里](https://stackoverflow.com/questions/497945/using-schtasks-from-the-command-line-what-parameter-will-wake-the-computer-from/506362#506362)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-08-01T23:35:24.753

我希望人们**会看到 XML 方法的答案**（坦率地说，我认为它是一种更简洁的方法，并且有一些更好的文档围绕您可以设置哪些参数来配置任务中的特定功能）。

**第 1 步：创建设置所有任务设置的 XML 文件**，多个位置可获取有关 XML 元素的更多信息：

*   [https://msdn.microsoft.com/en-us/library/windows/desktop/aa383609(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/aa383609(v=vs.85).aspx)
*   [https://msdn.microsoft.com/en-us/library/windows/desktop/aa446863(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/aa446863(v=vs.85).aspx)
*   [https://msdn.microsoft.com/en-us/library/windows/desktop/aa383611(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/aa383611(v=vs.85).aspx)
*   [PowerShell 脚本在 Windows 任务计划程序中无法正常工作](https://stackoverflow.com/questions/36878362/powershell-script-doesnt-work-correctly-from-windows-task-scheduler)
*   [来自命令行的任务计划程序](https://stackoverflow.com/questions/24879741/task-scheduler-from-command-line)

**第2步：具体到“哪里”任务将从中执行**（如在起始目录中脚本将在命令行中开始，这与OP的问题直接相关....您需要像这样配置参数...

```
<?xml version="1.0" encoding="UTF-16"?> 
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task"> 
  <RegistrationInfo> 
    <Date>2012-08-19T16:49:14.6182</Date> 
    <Author>YOUR-COMPUTER-DOMAIN\YOUR-USERNAME</Author> 
  </RegistrationInfo>

    ... a bunch of other stuff in between here ....

  <Actions Context="Author"> 
    <Exec> 
      <Command>C:\PythonEXE\mini_program_test.exe</Command> 
      <Arguments></Arguments> 
      <WorkingDirectory>C:\Some\where\here\</WorkingDirectory> 
    </Exec>
  </Actions> 
</Task> 
```

**请注意，****WorkingDirectory**参数中没有任何引号——我之前犯了这个错误。

**第 3 步：由于您将使用 schtasks.exe**来通过 XML 创建此新任务，因此请查看此处了解更多信息：[https ://msdn.microsoft.com/en-us/library/bb736357.aspx](https://msdn.microsoft.com/en-us/library/bb736357.aspx)

**第 4 步：在 windows 命令行中，**您将执行类似这样的操作（一旦您的 XML 准备就绪）

```
C:\>schtasks /CREATE /TN "TASK-NAME-HERE" /RU "YOUR-USERNAME" /RP "YOUR-PASSWORD" /XML C:\YOUR-XML-FILE-LOCATION\ready.xml 
```

希望这会有所帮助——玩得开心！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-30T07:58:27.260

尝试`cd /d "<WorkingDirectory>" & schtasks <SchtasksParams>`

更改工作目录，然后运行**​​schtasks**。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-01-28T05:40:13.010

在 App 中使用 My.Application.Info.DirectoryPath 无需 XML 设置。

# user-interface - Qt 中的 GLWidget 仅在 mousemove 上更新

> ID：447781
> 
> 赞同：0
> 
> 时间：2009-01-15T17:54:11.117
> 
> 标签：user-interface, qt, opengl, animation

我目前正在使用 Qt 尝试建立一个小型粒子系统。其中，我将 GLWidget 子类化并破解了它。一切都很顺利，直到我做了一些未知的更改，现在小部件只在我移动鼠标时重新绘制（由于我已经触发了 QTimer，它应该一直在这样做）。相关代码：

OpenGLWidget.h

```
class OpenGLWidget :  public QGLWidget  {

   Q_OBJECT

public:
   OpenGLWidget(QWidget * parent = 0);
   ~OpenGLWidget();

public slots:
   void toggleEmitter();

protected:
   void initializeGL();
   void paintGL();
   void resizeGL(int width, int height);
   QSize minimumSizeHint() const;
   QSize sizeHint() const;
   void mousePressEvent(QMouseEvent *event);
   void mouseMoveEvent(QMouseEvent *event);

protected slots:
   void timeOut();

private:

   void testFunc(Particle & p, unsigned int t);

   QTime time;
   QTimer timer;

   Emitter emitter; 
```

.cpp 中的相关代码

```
// in the constructor
time.start();
connect(&timer, SIGNAL(timeout()), this, SLOT(timeOut()));
timer.start(0);

void OpenGLWidget::initializeGL()  {
   GLuint tex = 0;

   qglClearColor(bgColor);
   glEnable(GL_DEPTH_TEST);   
   glClearDepth(1.0f);
    glDepthFunc(GL_LEQUAL);
   glShadeModel(GL_SMOOTH); 

   glDisable(GL_CULL_FACE);
   glEnable(GL_TEXTURE_2D); 
   glEnable( GL_BLEND );
   glBlendFunc( GL_SRC_ALPHA, GL_ONE); // _MINUS_SRC_ALPHA );

   glPointSize(3.0f);

   tex = bindTexture(QPixmap(QString("testparticle2.png")), GL_TEXTURE_2D);
   emitter = Emitter(Vector(0, 0, 0.0f), tex, 50, fastdelegate::FastDelegate2<Particle &, unsigned int>(this, &OpenGLWidget::testFunc));
}

void OpenGLWidget::paintGL()  {
   makeCurrent();
   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

   mainCam.SetView();

   glRotatef(xRot, 1, 0, 0);
   glRotatef(yRot, 0, 1, 0);

   emitter.Process(time.elapsed());

   totalTime += time.elapsed();
   time.restart();

}

void OpenGLWidget::resizeGL(int width, int height)  {
   contextWidth = width;
   contextHeight = height;

   glViewport(0, 0, width, height);

   glMatrixMode(GL_PROJECTION);
   glLoadIdentity();
   gluPerspective(55.0f, width / (float) height, 0.01f, 100.0f);

   glMatrixMode(GL_MODELVIEW);
   glLoadIdentity();

}

void OpenGLWidget::timeOut()  {
   updateGL();
}

void OpenGLWidget::mousePressEvent(QMouseEvent *event)  {
    lastX = event->pos().x();
    lastY = event->pos().y();
}

void OpenGLWidget::mouseMoveEvent(QMouseEvent *event)  {
    int dx = event->x() - lastX;
    int dy = event->y() - lastY;

    if (event->buttons() & Qt::LeftButton) {
        xRot += 3 * dy;
        yRot += 3 * dx;
    } else if (event->buttons() & Qt::RightButton) {
        xRot += 3 * dy;
        yRot += 3 * dx;
    }

    lastX = event->pos().x();
    lastY = event->pos().y();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T19:03:11.430

考虑到 updateGL() 调用 glDraw() 调用 paintGL()，您会认为计时器应该调用与 mousemove 事件相同的功能。

你确定计时器真的在滴答作响吗？

顺便说一句，没有必要在 paintGL() 中调用 makeCurrent [()](http://doc.trolltech.com/3.3/qglwidget.html#paintGL)。

编辑：添加额外信息后：

[QTimer 说](http://doc.trolltech.com/3.3/qtimer.html)：

> “作为一种特殊情况，一旦窗口系统事件队列中的所有事件都已处理完毕，超时时间为 0 的 QTimer 就会超时。”

因此，如果您希望它尽可能快地运行（尽管 10 毫秒可能是 Windows 和大多数基于 x386 的系统上的最小值），那么以 1 而不是 0 的值启动您的计时器。我认为这是问题所在，只有当它*完成*从队列中读取消息时才会滴答作响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:22:38.197

具有 0 秒超时的 QTimer 仅在事件循环获得控制权时触发。我怀疑情况并非如此。但是，当您移动鼠标时，事件循环（再次）处理一些事件，然后传递未决的计时器事件。也许您需要在更新循环中调用[processEvents()](http://doc.trolltech.com/4.5/qcoreapplication.html#processEvents)以确保来自 QTimer 的未决计时器事件得到处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-22T10:02:07.093

定时器根本无法在少于 20 毫秒的情况下工作。它等于 0。您可以使用简单的循环来测量从一次迭代到另一次迭代的时间。测量方法可能应该使用您操作系统的 API。

# math - 如何计算以 3 为底的组合数中的排列数？

> ID：447783
> 
> 赞同：1
> 
> 时间：2009-01-15T17:54:33.380
> 
> 标签：math, permutation

我从来没有太多的数学，我希望有人可以帮助我解决以下问题。

我有5个盒子：

```
 1   2   3   4   5
[ ] [ ] [ ] [ ] [ ] 
```

这些框可以是白色、灰色或黑色（或将其视为 0、1、2）

盒子集合可以有多少种可能的状态？

生成所有可能结果的伪代码（或任何语言）是什么？

IE...

```
00000
00001
00011
00111 
```

等等等等……

我真的很感谢任何人可以为此提供的任何帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T18:02:26.373

组合数量的答案是：3x3x3x3x3 (3^5)，因为每个盒子可以有 3 种可能的颜色。

至于生成结果，看看你能不能用这个矩阵用 0、1 或 2 来表示盒子的颜色。在较小的规模上（假设 3 个盒子），它看起来像这样：

```
0 0 0
0 0 1
0 0 2
0 1 0
0 1 1
0 1 2
0 2 0
0 2 1
0 2 2
1 0 0
1 0 1
1 0 2
1 1 0
1 1 1
1 1 2
1 2 0
1 2 1
1 2 2
2 0 0
2 0 1
2 0 2
2 1 0
2 1 1
2 1 2
2 2 0
2 2 1
2 2 2 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-15T18:04:29.380

这是一个经典的置换生成问题。每个职位有 3 种可能性，以及 5 个职位。生成的字符串总数为 3^5 = 243。如果需要通用解决方案，则需要递归（简单的迭代循环仅适用于问题的单个实例）。

这是一个简单的例子：

```
public static void Main(string[] args){

    Generate("", 5);
}

private void Generate(string s, int limit)
{
    if (s.Length == limit)
        Console.WriteLine(s);
    else
    {
        Generate(s+"0", limit);
        Generate(s+"1", limit);
        Generate(s+"2", limit);
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-15T17:59:43.400

要回答您的第一个问题，如果这些框只能包含两个值中的一个，答案会是什么？那么，如果这些框包含三个值之一，答案是什么？

要回答您的第二个问题，什么伪代码会生成一个盒子的所有可能结果？现在，伪代码生成两个框的所有可能结果？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T18:00:00.780

我建议先在纸上解决问题。尝试用较少数量的盒子（也许三个）来解决它，并列出所有可能性。然后，想想你的推理是如何进行的，或者你会如何向一个小孩解释你做了什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T17:59:14.477

这似乎是一个家庭作业问题。那我就给你一些关于解决方案的帮助。

你说的是每个盒子都有三个状态，它们都是独立的。一个盒子有 3 个解决方案，两个盒子有 3 * 3 个解决方案 - 对于第一个盒子的每个状态，第二个盒子也有三个状态。将其扩展到 5 个盒子。

要生成每个解决方案，您可以循环浏览它。很容易为每个盒子制作嵌套的 for 循环，乘以 10 的幂可以让你一次显示数字。

您可以以类似的方式概括多个框的代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T16:31:16.193

谢谢大家的回答，至少是那些真正给我答案的人。

虽然我可以理解这个问题听起来像是直接从计算机科学 101 中提取出来的，但事实并非如此。具有讽刺意味的是，这是在真正的截止日期前的现实生活，我没有时间回想当我被教这些东西并对自己说：“我什么时候需要这个废话”

如果我想像小学生一样受到光顾和对待，我会回到我的小学，问我五年级的老师我是否*可以*去洗手间

再次感谢

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T17:58:53.510

可能性的数量是 3 的 5 次方

如果您从 0 循环到该数字 - 1 并以基数 3 表示它，您将拥有所有可能性（请记住在必要时添加 0）

在红宝石中：

```
number_of_possibilities = 3**5-1

for i in (0..number_of_possibilities)
  base_3_number = i.to_s(3)
  puts "%05d" % base_3_number # number formatting used to prepend 0s where necessary
end 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-15T17:59:26.223

状态数为 3^5。

伪代码是

```
for value from 0 to 3^5-1
    print base3(value) 
```

其中 base3 是一个函数，它反复取模 3 来获得一个数字，然后删除该数字（除以 3）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T18:01:09.543

提示：想象每个方框是一个数字中的一个位置，每种颜色是一个不同的数字。在现实世界中，2 个位置和 10 个可能的数字有多少种组合（包括零）？3个职位呢？给定您可用的位数，添加额外位置和组合数量之间有什么关系？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-15T18:03:19.587

唯一组合数：`3^5=243`

代码：

```
n = 0
for i = 0 to 3^5-1
{
    s = ""
    for j = 1 to 5
    {
        d = n mod 3
        s = toascii(d) . s
        n = n / 3
    }
    println s
    i = i + 1
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-15T18:16:15.660

这是我第一次学会这样做的方法：首先考虑一下您正在做出多少选择。您正在做出五个选择，每个框一个。所以写下五个带乘号的空行：

```
__ x __ x __ x __ x __ = ? 
```

在每个空白处，写下您必须为该框选择的对象数量。因为每个方框有 3 个数字可供选择，所以在*每个*空白处写一个 3：

```
3 x 3 x 3 x 3 x 3 = 243 
```

这为您提供了这些选择的排列总数。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-15T18:18:34.017

我能问一下您对此有什么不理解或绊倒您的原因吗？我看到这里的每个人都只是简单地回答了这个问题，但是如果你复制他们的答案，你什么也没学到，因此完全错过了作业的重点。假设你的下一课建立在这一课的基础上，你只会落后得更远。

如果您为我工作或在我的班上，我只会问以下问题...

“你觉得这个问题应该怎么解决？” 答案可能会揭示你挂断电话的地方。我在 CMU 的一位睿智教授曾经说过“我无法帮助你理解这一点，除非你知道你不明白什么”我。

我知道可能为时已晚，但对于这些家庭作业问题，我真的认为我们应该帮助人们学习，而不是简单地提供答案并为他们做作业。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-15T18:56:05.283

甚至不要尝试编写代码来回答这个问题！原因是您需要一些非常大的数字（阶乘）来计算它。这些创建的数字比 CLR 中的任何基本类型都大得多。您可以使用这个[开源库](http://iridium.mathdotnet.com)来进行计算。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-15T23:32:42.463

您的问题只需要组合[数学中的乘积规则](http://en.wikipedia.org/wiki/Rule_of_product)即可。

您可以通过 3 种方式选择第*一个*框的状态，并以 3 种方式选择*第二个*框的状态，以及...以及 3 种方式选择第 5 个框的状态。您可以设置所有框的状态的方式数是所有五个（相等）方式数的乘积，即 3x3x3x3x3 = 3 ⁵。

类似的问题：在十进制系统中，您可以用 5 位数字组成多少个数字，计算前导零？也就是说，从 00000 到 99999 有多少个数字？您可以通过 10 种方式（0...9）选择第一个数字，依此类推，答案是 10x10x10x10x10 = 100000，正如您已经知道的那样。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-01-06T11:25:06.910

```
void solve(int p=0,int n=5,int d=0)
{
    if (n==p)
    {
        int rev=d;
        int i=0;
        while (i<5) {
            cout << rev%10;
            rev /= 10;
            i++;## Heading ##
        }
        cout << endl;
        return;
    }
    for(int i=0; i<3 ; i++)
    {
        solve(p+1,n, d*10 + i);
    }
} 
```

# c# - 计算机 A 可以访问网络 web 服务，而计算机 B 不能。有任何想法吗？

> ID：447785
> 
> 赞同：1
> 
> 时间：2009-01-15T17:55:11.897
> 
> 标签：c#, .net, web-services, security, networking

你得原谅我，因为我不知道把这个放在哪里。我想这在 C# Web 服务和网络/安全管理领域重叠。

我有一台运行各种 Web 应用程序的服务器。其中之一是网络服务。一切运行的帐户是机器上的本地帐户。它不是域帐户。我不知道为什么要这样做，但这是其中的一件事，因为它就是这样做的。

超棒的吧？

好的，所以我的域名帐户名获得了网络服务的完全权限。现在，虽然运行 Web 服务的帐户不是域帐户，但机器在我们的域和我们的网络中。所以，在我的电脑上，我可以启动浏览器并以这种方式输入 Web 服务的 url：

[http://serverhere:portthere/servicename](http://serverhere:porthere/servicename)

现在有趣的部分。从同一网络上的另一台机器并登录我的域帐户，我无法加载 Web 服务。

这是真正非常疯狂的部分。从机器 A 和 B，我无法 ping 托管 Web 服务的服务器。可能是因为 ping 已关闭。

所以百万美元的问题是，有没有人知道为什么计算机 B 不能访问网络服务而计算机 A（我的机器）可以？

托管 Web 服务的服务器运行的是 windows 2000。我的机器运行的是 windows xp。无法加载 Web 服务的机器正在运行 Windows 2003 SP 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T18:01:14.833

检查以确保两台机器的子网掩码相同；如果一个子网比另一个子网更严格，它基本上会忽略来自该机器的消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T18:05:25.243

有太多的选择。而且我不会打赌帐户权限问题。您应该检查与网络嗅探器的通信，如wireshark 或网络监视器。检查代理设置。并发布有关您收到的错误的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T18:06:43.713

愚蠢的建议，但是您是否检查了 2003 机器上的防火墙设置？

# javascript - jQuery 展开和折叠列表

> ID：447789
> 
> 赞同：0
> 
> 时间：2009-01-15T17:56:22.300
> 
> 标签：javascript, jquery, coding-style

该代码展开和折叠一个列表，其中列表项可以有子列表。重构此代码的任何想法 - 尤其是切换部分。有必要在这里使用闭包吗？

```
$(function()
{
    $('li:has(ul)')
    .click(function(event){
        if (this == event.target) 
        {
            var that = this;
            $('li:has(ul)').children().filter(':not(:hidden)').parent().each(function(x){
                if(this != that)
                    toggleList(this);
            });
            toggleList(this);
        }
    })
    .css({cursor:'pointer', 'list-style-image':'url(plus.gif)'})
    .children().hide();

    $('li:not(:has(ul))').css({cursor: 'default', 'list-style-image':'none'});
}); 
function toggleList(L)
{
    $(L).css('list-style-image', (!$(L).children().is(':hidden')) ? 'url(plus.gif)' : 'url(minus.gif)');
    $(L).children().toggle('fast');
} 
```

**编辑：**

该脚本适用于以下 HTML 片段（来源：jQuery in Action）。实际上，我试图扩展书中给出的脚本。

```
 <ul>
        <li>Item 1</li>
        <li>Item 2</li>
        <li>
          Item 3
          <ul>
            <li>Item 3.1</li>
            <li>
              Item 3.2
              <ul>
                <li>Item 3.2.1</li>
                <li>Item 3.2.2</li>
                <li>Item 3.2.3</li>
              </ul>
            </li>
            <li>Item 3.3</li>
          </ul>
        </li>
        <li>
          Item 4
          <ul>
            <li>Item 4.1</li>
            <li>
              Item 4.2
              <ul>
                <li>Item 4.2.1</li>
                <li>Item 4.2.2</li>
              </ul>
            </li>
          </ul>
        </li>
        <li>Item 5</li>
      </ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T04:49:08.160

您的代码在 Safari 中对我不起作用。当我单击子列表时，顶部列表被切换。

怎么样：

```
$(document).ready(function() {
  $('li:has(ul)').click(function(event) {
    $(this).css('list-style-image', $(this).children().is(':hidden') ? 'url(minus.gif)' : 'url(plus.gif)')
    $(this).children().toggle('fast')
    return false
  })
  .css({cursor:'pointer', 'list-style-image':'url(plus.gif)'})
  .children().hide()

  $('li:not(:has(ul))').click(function(event) { return false })
  .css({cursor:'default', 'list-style-image':'none'})
}) 
```

# asp.net - 设置值到 TextBox - Ajaxified Aspx

> ID：447802
> 
> 赞同：0
> 
> 时间：2009-01-15T17:59:26.490
> 
> 标签：asp.net, ajax

我在 aspx 中使用 AjaxToolKit，所以提示是如何为文本框设置值？我正在使用javascript从另一个aspx中检索值，所以现在我（例如）在本地var（在代码隐藏中）中有一个价格总和，我想在带有runat =“server”的TextBox中设置该值

我必须使用 jquery 或 javascript？使用网络方法？怎么会这样？谢谢

我也在代码隐藏中尝试了这个：

```
((TextBox)FindControl("txtTotalAmount")).Text = total;
```

我发现了一些提示，例如，在 html 上下文中 id 会发生变化，显然类似于

```
ctl00_cphMainContent_
```

我怎么能驯服这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T10:57:47.193

您可以尝试以下步骤：

1.  在后面的页面加载代码中，将文本框的 ClientID 属性分配给 javascript 变量（这将允许您使用 getElementById 方法访问文本框）
2.  使用 PageMethod 检索要在文本框中显示的价格总和
3.  使用getElementById（步骤1中存储在js变量中的id）获取文本框的句柄，然后将其“value”属性设置为步骤2中PageMethod返回的值

# perl - 如何检查 Test::More 中的退出代码？

> ID：447810
> 
> 赞同：2
> 
> 时间：2009-01-15T18:01:08.827
> 
> 标签：perl, testing

根据 Test::More[文档](http://search.cpan.org/~mschwern/Test-Simple-0.86/lib/Test/More.pm#EXIT_CODES)，它将根据您的测试结果以某些退出代码退出。我的问题是，如何检查这些退出代码？

附言。我正在尝试自己建立一个安全带。有没有我可以使用的简单线束？

ps2。Test::Harness 帮了我大忙。特别是 execute_tests 函数。此函数返回我想要的所有统计信息。感谢所有提供有用链接的人。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T18:46:42.087

任何体面的利用程序（例如[证明](http://search.cpan.org/~andya/Test-Harness-3.14/bin/prove)）都会为您做到这一点，您绝对没有理由自己这样做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T18:11:45.433

这是一个进程返回码。如果在某些 Unix 变体的 shell 下运行，您通常可以将其检索为`$?`. （这可能使您的问题更多地是关于 bash 而不是 perl）

常用成语：

```
perl your_file.t
if [[ $? -gt 10 ]]; then
  echo "Wow, that's a lot of failures"
elif [[ $? -gt 0 ]]; then
  echo "Tests failed"
else
  echo "Success!"
fi 
```

或者，如果您只对成功/失败感兴趣：

```
perl your_file.t || echo "Something bad happened." 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T03:19:01.680

如果你从 Perl 调用你的测试程序，那么困难的（和传统的）方法包括对`$?`. 如果您真的想了解如何操作，可以在[系统功能文档中阅读相关内容。](http://perldoc.perl.org/functions/system.html)

*好的*方法是使用一个模块，该模块为您提供一个样式`system`函数，为您处理返回值：

```
use IPC::System::Simple qw(systemx EXIT_ANY);

my $exit_value = systemx( EXIT_ANY, 'mytest.t' ); 
```

该`EXIT_ANY`符号允许您的脚本返回任何退出值，然后我们可以捕获该退出值。如果您只是想确保您的脚本正在通过（即返回零退出状态），并在任何失败时立即停止，那是[IPC::System::Simple](http://search.cpan.org/perldoc?IPC::System::Simple)的默认行为：

```
use IPC::System::Simple qw(systemx);

systemx( 'mytest.t' );  # Run this command successfully or die. 
```

在上述所有示例中，您可以请求替换`system`命令，而不是`systemx`对 shell 参与其中的可能性感到高兴。有关详细信息，请参阅[IPC::System::Simple](http://search.cpan.org/perldoc?IPC::System::Simple)文档。

还有其他模块可以让您轻松运行命令并捕获其退出值。蒂姆托迪。

话虽如此，所有好的工具都应该为您检查返回值，因此只有在您编写我们自己的测试测试器时，您才需要自己查看。

祝一切顺利，

*保罗*

披露：我写了 IPC::System::Simple，因此可能对它有一些积极的偏见。

# c# - 如何取消订阅 C# 中特定类的事件的所有处理程序？

> ID：447821
> 
> 赞同：38
> 
> 时间：2009-01-15T18:03:57.527
> 
> 标签：c#, .net, events

基本前提：

我有一个房间，当头像“进入”房间内的所有头像时，它会发布一个事件。当头像离开房间时，我希望它删除该房间的所有订阅。

在将头像添加到新房间并订阅新房间的事件之前，如何最好地取消订阅房间中的所有事件？

代码是这样的：

```
class Room
{
   public event EventHandler<EnterRoomEventArgs> AvatarEntersRoom;
   public event EvnetHandler<LeaveRoomEventArgs> AvatarLeavesRoom;
   public event EventHandler<AnotherOfManyEventArgs> AnotherOfManayAvatarEvents;

   public void AddPlayer(Avatar theAvatar)
   {
      AvatarEntersRoom(this, new EnterRoomEventArgs()); 

      AvatarEntersRoom += new EventHandler<EnterRoomEventArgs>(theAvatar.HandleAvatarEntersRoom);

      AvatarLeavesRoom += new EventHandler<EnterRoomEventArgs>(theAvatar.HandleAvatarEntersRoom);

      AnotherOfManayAvatarEvents += new EventHandler<EnterRoomEventArgs>(theAvatar.HandleAvatarEntersRoom);          

   }

}

class Avatar
{
   public void HandleAvatarEntersRoom(object sender, EnterRoomEventArgs e)
   {
       Log.Write("avatar has entered the room");
   }

   public void HandleAvatarLeaveRoom(object sender, LeaveRoomEventArgs e)
   {
       Log.Write("avatar has left room");
   }

   public void HandleAnotherOfManayAvatarEvents(object sender, AnotherOfManyEventArgs e)
   {
       Log.Write("another avatar event has occurred");
   }
} 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-15T18:46:12.370

每个委托都有一个名为的方法，该方法`GetInvocationList()`返回所有已注册的实际委托。因此，假设委托类型（或事件）命名为 say `MyDelegate`，并且处理程序实例变量命名为`myDlgHandler`，您可以编写：

```
Delegate[] clientList = myDlgHandler.GetInvocationList();
foreach (var d in clientList)
       myDlgHandler -= (d as MyDelegate); 
```

涵盖它可能为空的情况，

```
 if(myDlgHandler != null)
  foreach (var d in myDlgHandler.GetInvocationList())
       myDlgHandler -= (d as MyDelegate); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T18:15:28.000

实现这一点的最简单方法可能是将您为化身订阅的所有事件存储在事件`ArrayList`的委托中。

当头像离开房间时，只需循环执行标准删除 ( `-=`) 的代表列表。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-15T18:06:09.767

标准删除有什么问题吗？

```
public void RemovePlayer(Avatar theAvatar) {
 AvatarEntersRoom -= new EventHandler<EnterRoomEventArgs>(theAvatar.HandleAvatarEntersRoom);

} 
```

**编辑**

根据您的更新，您似乎需要从特定类的所有事件中删除特定对象的代码。没有现实的方法来实现这一目标。它通常有点冗长，但最好的方法是从每个事件中单独添加/删除特定的对象方法组合。

**接近**此功能的唯一方法是使用反射。您可以反思性地抓取类中的所有事件，然后做一些魔术来找到事件链中类的所有实例。这只是部分解决方案，因为它会忽略诸如 lambda 表达式事件处理程序之类的东西。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-15T18:48:48.073

您可以在所有事件订阅者上运行：

```
_Event.GetInvocationList() 
```

并删除每个事件处理程序。

```
Delegate[] subscribers = myEvent.GetInvocationList();

for(int i = 0; i < subscribers.Length; i++)    
{    
    myEvent -= subscribers[i] as yourDelegateType;   
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-25T07:32:03.630

我想做的是在调试中（不要认为这对发布有很好的性能，应该在开发过程中捕获它）当一个类的事件没有被取消订阅时抛出异常，这是我使用的方法：

```
#if DEBUG
private void CheckEventHasNoSubscribers(Delegate eventDelegate)
{
    if (eventDelegate != null)
        if (eventDelegate.GetInvocationList().Length != 0)
        {
            var subscriberCount = eventDelegate.GetInvocationList().Length;

            // determine the consumers of this event
            var subscribers = new StringBuilder();
            foreach (var del in eventDelegate.GetInvocationList())
                subscribers.AppendLine((subscribers.Length != 0 ? ", " : "") + del.Target);

            // throw an exception listing all current subscription that would hinder GC on them!
            throw new Exception(
                $"Event:{eventDelegate.Method.Name} still has {subscriberCount} subscribers, with the following targets [{subscribers}]");
        }
}

#endif 
```

在我处理拥有委托的项目或您的工作流应该释放对象的任何其他位置，我会这样称呼它。

```
protected virtual void Dispose(bool disposing)
{
    if (!disposedValue)
    {
        if (_orderCacheLock != null)
            _orderCacheLock.Dispose();

        if(_SettingTradeTimeOut!=null)
            _SettingTradeTimeOut.Dispose();

        _orderCacheLock = null;
#if DEBUG
        CheckEventHasNoSubscribers(OnIsProfitable);
        CheckEventHasNoSubscribers(OnPropertyChanged);
#endif
        disposedValue = true;
    }
} 
```

然后很容易找到这些“孤立”事件的订阅者并修复代码

ps：这个“练习模式”的扩展看起来是这样的。

```
public static void CheckEventHasNoSubscribers(this Delegate eventDelegate)
{
    if (eventDelegate != null)
        if (eventDelegate.GetInvocationList().Length != 0)
        {
            var subscriberCount = eventDelegate.GetInvocationList().Length;
        // determine the consumers of this event
        var subscribers = new StringBuilder();
        foreach (var del in eventDelegate.GetInvocationList())
            subscribers.AppendLine((subscribers.Length != 0 ? ", " : "") + del.Target);

        // point to the missing un-subscribed events
        throw new Exception( $"Event:{eventDelegate.Method.Name} still has {subscriberCount} subscribers, with the following targets [{subscribers}]");
    } 
```

}

# console - 如何配置 Msys 的默认大小、颜色和字体？

> ID：447824
> 
> 赞同：15
> 
> 时间：2009-01-15T18:04:45.153
> 
> 标签：console, mingw, msys

我最近一直在探索使用 MSys 作为我的 windows 开发的替代方案，类似于 nix 的 shell。然而，默认的颜色和尺寸让我抓狂。任何人都知道如何更改默认大小、颜色和/或字体？老实说，如果我可以使 shell 的默认字符宽度/高度更大，我会很高兴，但其他的也会很好......

澄清：msys shell 是一个独立于 windows shell 的应用程序 - 不存在正常的“右键单击左上角 -> 属性”配置（如 windows shell）。

看起来它正在启动 rxvt。谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-15T18:09:15.533

如果你从命令行运行 MSYS bash，在后台它是一个 windows 命令 shell 窗口，所以配置它是一样的。

*   右键单击 shell 窗口顶部的标题栏，然后选择“属性”

*   使用对话框选项卡上的选项配置窗口；这些应该是不言自明的。

*   关闭对话框时，选择“修改启动此窗口的快捷方式”以将配置保存为默认值。

**编辑：**如果您通过 X 服务器在 xterm 或 RXVT 窗口中运行 shell，请使用 -fg（前景）、-bg（背景）和 -fn（字体）启动 xterm 窗口。不记得 RXVT 开关是什么，但您应该能够在手册页中看到它们。您还可以通过 .Xdefaults 文件配置它们。再次，请参阅手册页了解详细信息。

**编辑：**谢谢 Paulo - 请注意，MSYS 还附带了一个 X-less 版本的 RXVT，OP 似乎正在使用它。[这是在 MSYS 上配置 RXVT](http://www.mingw.org/wiki/Configure_RXVT)的链接。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-15T18:27:34.013

在第 72 行打开 msys.bat 文件，其内容如下：

```
rem Setup the default colors for rxvt.
if "x%MSYSBGCOLOR%" == "x" set MSYSBGCOLOR=White
if "x%MSYSFGCOLOR%" == "x" set MSYSFGCOLOR=Black
if "x%MINGW32BGCOLOR%" == "x" set MINGW32BGCOLOR=LightYellow
if "x%MINGW32FGCOLOR%" == "x" set MINGW32FGCOLOR=Navy
if "%MSYSTEM%" == "MSYS" set BGCOLOR=%MSYSBGCOLOR%
if "%MSYSTEM%" == "MSYS" set FGCOLOR=%MSYSFGCOLOR%
if "%MSYSTEM%" == "MINGW32" set BGCOLOR=%MINGW32BGCOLOR%
if "%MSYSTEM%" == "MINGW32" set FGCOLOR=%MINGW32FGCOLOR% 
```

用您喜欢的颜色更改前 4 行，以更改字体，如下所示：

```
start %WD%rxvt -backspacekey  -sl 2500 -fg %FGCOLOR% -bg %BGCOLOR% -sr -fn Courier-12 -tn msys -geometry 80x25 -e /bin/sh --login -i 
```

将 Courier-12 更改为您喜欢的字体，将 80x25 更改为您喜欢的窗口大小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-14T22:14:38.700

我创建了 HOME env var，它的值类似于 'e:\home' 并放入具有以下内容的 %HOME% dir .Xdefaults 文件中：

```
Rxvt *背景：白色
Rxvt*前景：黑色
Rxvt*几何：120x40
Rxvt*字体：7x14
Rxvt*滚动条：打开
Rxvt*saveLines: 5000

```

另请注意，此配置可在 Cygwin 和各种 Unix 机器上成功运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-14T23:56:51.403

如果你厌倦了在 msys git 中使用 cmd，我建议使用 minty 和/或 ConEmu： 要使用 mintty，请从[google code/mintty](https://code.google.com/p/mintty/)![薄荷味](https://i.stack.imgur.com/3Es5f.png) 下载最新版本并将其放入git msys 的文件夹中 + 制作以下快捷方式：`bin`

```
"C:\Program Files (x86)\Git\bin\mintty.exe" --title "Git Bash" -w full --exec "C:\Program Files (x86)\Git\bin\sh.exe" --login -i 
```

（将工作目录设置为您的主目录）

~~要使用`vim`，请务必阅读[此错误报告](https://code.google.com/p/mintty/issues/detail?id=230) 以了解颜色，确保将 gitconfig 设置为 color = always~~ 我将 sublime 设置为我的默认编辑器，因为 vim 不起作用，请参阅下面的注释

笔记：

*   与 msys 打包的 vim 需要 cmd 终端，并且不能与 mintty 一起使用
*   除非您在 ConEmu 中托管 mitty，否则使用基本 http 身份验证为 git 推送输入用户名/密码的交互将不起作用。（ssh 本身在 mitty 上工作正常）

参考：

*   [rpavlik/git-windows-mintty](https://github.com/rpavlik/git-windows-mintty) - 注意这并没有捆绑最新的 mintty 版本。
*   [/oumu/薄荷色配色方案](https://github.com/oumu/mintty-color-schemes)

# jboss - Windows Server 2008 下的 jboss 4.2.2 GA - 可能与防火墙有关？

> ID：447836
> 
> 赞同：0
> 
> 时间：2009-01-15T18:09:52.833
> 
> 标签：jboss, windows-server-2008, firewall

我已经在 XP 64 和 server 2003 下运行 JBoss 4.2.2 GA 多年了。最近我决定在我的 xp 64 安装上安装 server 2008 (x64) 并将它用作我的桌面，因为很多人都喜欢吹捧.. .

不幸的是，现在当我启动 JBoss 的“某事”时——我假设它是某种 Windows 防火墙——阻止了连接正常工作。

没有任何改变，jboss 在不同的分区上，它基于 java，所以不同的可能是 jvm（默认 java_home 是 x64 版本：c:\Program Files\Java\jdk1.6.0_11\bin）

我可以启动 JBoss 并转到[http://localhost:8080](http://localhost:8080) ...但我不能转到 "http://{hostname}:8080"

我已经一次又一次地禁用了防火墙 - 畅通无阻的 TCP 端口 8080 - 没有任何效果......

谢谢！

更新：使用基于 x86 的 java 进行了尝试-没有区别

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T18:28:13.060

我会说您将套接字绑定到本地主机。如果您将命令行选项“-b 0.0.0.0”添加到对 run.jar 的调用中，它应该可以解决您的问题。

可能有一种更合适的方法可以通过属性来完成同样的事情。快速的 Google 搜索建议使用 jboss.bind.address，尽管许多结果建议使用上述命令行选项。

# visual-studio - 从一个 Visual Studio 实例调试程序的多个副本

> ID：447840
> 
> 赞同：15
> 
> 时间：2009-01-15T18:12:36.557
> 
> 标签：visual-studio, debugging

我有一个 pre-alpha GUI 程序，我正在[测试](http://en.wikipedia.org/wiki/Eat_one%27s_own_dog_food)它并希望在调试器下运行（当出现问题时`;)`，但我不想为应用程序的每个实例启动 Visual Studio 的新副本。这可以做到吗？

我不希望一次实际调试多个实例，但我仍然希望调试器能够查找所有实例。另外，我每天要启动应用程序几十次，所以它必须很容易做到。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-15T18:46:06.880

您可以在 Visual Studio 的一个实例中多次启动相同或不同项目的实例。方法如下：右键单击解决方案资源管理器中的任何项目，转到*Debug*上下文菜单项，然后单击*Start new instance*。

*您可以从Processes*窗口（菜单*Debug* → *Windows* → *Processes* ）查看和操作所有正在运行的进程。菜单项（和“*进程*”窗口）仅在应用程序运行时（在 Visual Studio 下）可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T18:19:51.487

这是可以做到的。

如果您拥有*专业*版的 Visual Studio，则可以使用它附加到您打开的应用程序的每个实例。

首先，使用调试信息编译应用程序，以便可以实际调试它。

然后启动您的应用程序。根据需要打开尽可能多的实例。

在 Visual Studio 中，单击菜单*Debug* → *Attach to Process...*。选择要调试的进程。`Shift`您可以通过+ 单击或+ 单击从列表中选择多个`Ctrl`。

我刚刚对此进行了测试以确保。Visual Studio 的一个实例（至少是 Visual Studio 2008）可以调试同一应用程序的多个实例。

如果您没有*专业*版，我认为无法做到这一点。我绝对确定*Express*版本**不能**附加到进程。我不确定哪些“付费”版本可以附加到流程中，尽管可以这样做。

# asp.net-mvc - 单元测试 Controller.Initialize

> ID：447853
> 
> 赞同：3
> 
> 时间：2009-01-15T18:17:38.170
> 
> 标签：asp.net-mvc, unit-testing

我在我创建的基本控制器的初始化方法中将线程文化设置为通过 HttpRequest 上的 cookie 发送的文化。我现在想为此功能创建一个单元测试。

在测试中，我创建了一个模拟 HttpContext 并添加了 Cookie。使用这个和一个 routeData 助手，我创建了一个 RequestContext。然后我创建一个新的控制器并在它上调用 Execute 并传入 RequestContext。

我首先遇到了一个关于 TempData 和 SessionState 的问题，我通过设置 TempData 并在控制器上创建了 EmptyTempDataProvider 来解决这个问题。

然后我遇到了 VirtualPathProviderViewengine 的问题，我通过创建 VoidActionInvoker 解决了这个问题。

这是测试初始化​​方法的最佳方法吗？有没有做类似的事情并愿意分享一些代码？

谢谢，乔恩

```
namespace MyApp.UnitTests {
[TestClass]
public class ControllerTests {
    [TestInitialize]
    public void Setup() {
        RouteTable.Routes.Clear();
        MyApp.MvcApplication.RegisterRoutes(RouteTable.Routes);
    }

    [TestMethod]
    public void Thread_culture_should_be_set_to_cookie_culture() {
        // Arrange
        var context = HttpMockHelper.FakeHttpContext();
        context.Request.Cookies.Add(new HttpCookie(CultureService.CookieName, "nl-NL"));
        var reqContext = new RequestContext(context, "~/Home/Landing".Route());
        var controller = new HomeController {
            TempData = new TempDataDictionary(),
            TempDataProvider = new EmptyTempDataProvider(),
            ActionInvoker = new VoidActionInvoker()
        };

        // Act
        (controller as IController).Execute(reqContext);

        // Assert
        Assert.AreEqual("nl-NL", Thread.CurrentThread.CurrentCulture.Name);
    }
}

internal class VoidActionInvoker : ControllerActionInvoker {
    protected override ActionExecutedContext InvokeActionMethodWithFilters(System.Reflection.MethodInfo methodInfo, IDictionary<string, object> parameters, IList<IActionFilter> filters) {
        return new ActionExecutedContext(this.ControllerContext, false, null);
    }

    protected override void InvokeActionResult(ActionResult actionResult) {
    }
}

internal class EmptyTempDataProvider : ITempDataProvider {
    public void SaveTempData(ControllerContext controllerContext, IDictionary<string, object> values) {
    }

    public IDictionary<string, object> LoadTempData(ControllerContext controllerContext) {
        return new Dictionary<string, object>(StringComparer.OrdinalIgnoreCase);
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T22:43:14.920

对我来说听起来不错，初始化方法需要一个需要 HttpContext 的 requestcontext 参数，如果我的帖子正确，你正在模拟这些对象并添加你想要测试的值，然后确保你的方法正常工作. 听起来和我会做的完全一样。我不介意看到一些代码。

编辑：你的测试对我来说看起来不错。

# c++ - 删除或更新 HDF5 中的数据集？

> ID：447854
> 
> 赞同：4
> 
> 时间：2009-01-15T18:17:49.447
> 
> 标签：c++, c, api, hdf5

我想以编程方式更改与 HDF5 文件中的数据集关联的数据。我似乎找不到按名称删除数据集（允许我使用修改后的数据再次添加它）或按名称更新数据集的方法。我正在使用 HDF5 1.6.x 的 C API，但指向任何 HDF5 API 的指针都会很有用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T19:12:36.123

[根据用户指南](https://support.hdfgroup.org/HDF5/doc/UG/HDF5_Users_Guide-Responsive%20HTML5/index.html#t=HDF5_Users_Guide%2FDatasets%2FHDF5_Datasets.htm%3Frhtocid%3Dtoc5.0_2%23TOC_5_5_2_Deleting_a_Dataset)：

> HDF5 目前不提供从文件中删除数据集或回收已删除对象占用的存储空间的简单机制。

如此简单的删除似乎是不可能的。但该部分继续：

> 可以使用`H5Ldelete`函数和[*`h5repack`*](http://www.hdfgroup.org/HDF5/doc/RM/Tools.html#Tools-Repack)实用程序来删除数据集并回收它使用的空间。使用该`H5Ldelete`功能，可以从文件结构中删除指向数据集的链接。删除所有链接后，任何应用程序都无法访问该数据集，并有效地从文件中删除。恢复未链接数据集占用空间的方法是将文件的所有对象写入新文件。应用程序无法访问任何未链接的对象，并且不会包含在新文件中。*`h5repack`*可以使用自定义程序或实用程序将对象写入新文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-10T15:17:57.187

如果要在 C++ 中删除数据集，则需要以下命令：

```
H5File m_h5File (pathAndNameToHDF5File, H5F_ACC_RDWR); //The hdf5 c++ object.
std::string channelName = "/myGroup/myDataset";
int result = H5Ldelete(m_h5File.getId(), channelName.data(), H5P_DEFAULT); 
```

如果成功，结果将是一个非负值；否则返回负值。[https://support.hdfgroup.org/HDF5/doc/RM/RM_H5L.html#Link-Delete](https://support.hdfgroup.org/HDF5/doc/RM/RM_H5L.html#Link-Delete)

正如@MaxLybbert 所说，它没有恢复的硬盘空间。您必须使用重新打包工具。但是，使用 HDF5 v.1.10 可以恢复空间。但是用户指南还没有准备好： https: [//support.hdfgroup.org/HDF5/docNewFeatures/NewFeaturesFileSpaceMgmtDocs.html](https://support.hdfgroup.org/HDF5/docNewFeatures/NewFeaturesFileSpaceMgmtDocs.html)

# windows - 挂钩到 Windows 文件访问

> ID：447856
> 
> 赞同：1
> 
> 时间：2009-01-15T18:19:13.657
> 
> 标签：windows, hook

是否可以连接到 Windows 加载或保存文件（无论文件如何打开，如记事本 word 等）以即时修改文件？

例如动态编码/解码它？

代码是否需要管理权限才能启动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T18:08:24.610

是的，您需要编写一个可安装的文件系统驱动程序。Microsoft的可[安装文件系统工具包](http://www.microsoft.com/whdc/devtools/ifskit/default.mspx)包含几个示例驱动程序，包括 Filemon 使用的驱动程序。不幸的是，我不相信您可以在没有 IFS 工具包的情况下访问这些 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T19:53:05.263

您还可以使用[madCodeHook 之](http://madcodehook.com/)类的东西来拦截文件读/写并将您的 dll 安装到每个进程中。我已经使用这种技术来记录打印作业以进行计费。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T18:28:49.363

您可能必须编写驱动程序。看看你是否可以获得 Filemon 的源代码，那里有很多东西要学。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T07:21:11.987

避免 madCodeHook（非专业）使用标准 api 挂钩机制（主要是 Richter 和 Microsoft D）

# logging - VBScript 有对应的 log4j 吗？

> ID：447860
> 
> 赞同：4
> 
> 时间：2009-01-15T18:20:06.057
> 
> 标签：logging, vbscript, log4j, wsh

我需要使用调试语句检测一系列 .wsf 和 .vbs 文件；在我自己动手之前，WSF/VBScript 是否存在类似 log4j 的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T18:52:25.383

无法与 log4j 相比，但您可以使用以下内容开始：

[**VBScript 中的可重用日志记录 - LogToFile.vbs**](http://www.naterice.com/blog/template_permalink.asp?id=43)

> 任何您想在脚本中记录消息的地方，您只需添加 LogToFile "Your Message" 以记录相关信息。
> 
> 使用此脚本，您可以记录开始脚本的日期和时间、任何特定事件的日期和时间，并在您想安排脚本运行时间时生成唯一的文件名。在不编辑整个日志记录部分的情况下关闭日志记录也很简单。

如果要写入事件日志，可以使用**WshShell 对象**来完成。它提供了将事件记录到应用程序事件日志的 LogEvent 方法。

LogEvent 方法使您能够从脚本中写入事件日志。LogEvent 有两个必需的参数。LogEvent 方法的第一个参数是一个整数，它指定您希望脚本记录的事件类型。

```
Set objShell = WScript.CreateObject("Wscript.Shell")
objShell.LogEvent 0,"Test Success Event"
objShell.LogEvent 1,"Test Error Event"
objShell.LogEvent 2,"Test Warning Event"
objShell.LogEvent 4, "Test Information Event"
objShell.LogEvent 8, "Test Success Audit Event"
objShell.LogEvent 16, "Test Failure Audit Event" 
```

请参阅[Microsoft TechNet](http://www.microsoft.com/technet/scriptcenter/guide/sas_wsh_xnbt.mspx?mfr=true)站点上的此处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T15:25:10.260

由于我的主程序是[Windows 脚本文件](http://msdn.microsoft.com/en-us/library/15x4407c.aspx)(.wsf) 脚本，因此我可以包含和使用来自其他脚本语言的代码。

我找到了[Log4js: JavaScript logging framework](http://log4js.berlios.de/index.html)，它以 Log4j 为模型，对我来说非常好用。我必须添加自己的 Appender 来记录到`stderr`and `stdout`，但这比从头开始创建自己的日志框架要容易得多。

**更新：2009 年 2 月 13 日：**

[Log4js：我第一次尝试的 JavaScript 日志框架](http://log4js.berlios.de/index.html)，结果证明它有点消耗资源。[我在http://log4js.sourceforge.net/](http://log4js.sourceforge.net/)找到了另一个 JavaScript Log4js 实现，它更加稳定和高效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T21:17:40.457

我怀疑您可以通过 COM使用[Log4net 。](http://logging.apache.org/log4net/)这是 log4J 的 .net 版本，我强烈推荐它作为日志框架。[这里](http://www.nabble.com/COM-and-VisualBasic-6.0-and-log4net-to769573.html)有一些信息

# c++ - Visual Studio 2005：静态文本控件不会以透明背景显示

> ID：447862
> 
> 赞同：3
> 
> 时间：2009-01-15T18:20:58.350
> 
> 标签：c++, visual-studio-2005, visual-c++-2005

我正在使用 Visual Studio 2005 中的对话框编辑器来创建一个带有静态文本控件的对话框。我希望静态文本控件的背景是透明的，因为我在它下面使用了一个静态图像控件，而灰色文本背景看起来很可怕。在编辑器中，我将“透明”属性设置为 True，它使背景变得透明，就像我想要的那样。但是，一旦我运行我的应用程序并使用 SendMessage(hText, WM_SETTEXT, 0L, "newtext") 更改文本，背景就会失去透明度并再次变灰。有任何想法吗？顺便说一句，我正在用 C++ 做这个。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T00:22:14.033

As Anthony Johnson said, handle the `WM_CTLCOLORSTATIC` message in the dialog box (you don't have to handle `WM_NOTIFY` - I don't believe static controls use that message, anyway). But it doesn't seem to be enough to set the background mode to transparent. You also have to set the background brush to a null brush. Something like this should work (in your DialogProc):

```
case WM_CTLCOLORSTATIC:
    SetBkMode((HDC)wParam, TRANSPARENT);
    return (INT_PTR)(HBRUSH)GetStockObject(NULL_BRUSH); 
```

If you change the text on the static control, you may have to invalidate what's underneath it for it to draw correctly when you do this.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T19:22:15.917

尝试隐藏控件，然后设置文本，然后显示它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T19:57:56.907

我不知道如何在对话框编辑器中做到这一点，但是如果您在静态的父窗口中处理 WM_NOTIFY 消息，静态将在绘制静态之前发送 WM_CTLCOLORSTATIC 消息。在那里，如果您调用 SetBkMode((HDC)wParam, TRANSPARENT);，那应该使静态具有透明背景。

# c++ - 跨线程异常抛出

> ID：447871
> 
> 赞同：0
> 
> 时间：2009-01-15T18:26:55.013
> 
> 标签：c++, winapi

我有一个应用程序，它允许用户用我们自己制作的语言编写自己的代码，这有点像 C++。然而，我们遇到了一些问题，有时我们的用户会不小心将无限循环写入他们的脚本。一旦脚本进入无限循环，他们唯一能摆脱的方法就是关闭应用程序并重新启动，这可能会丢失他们的工作。我想添加一些方法，当用户意识到他的代码处于无限循环中时，他可以点击一个特殊的键，比如 F10 或其他什么，代码就会跳出循环。但我想在脚本运行时不实施大量检查的情况下做到这一点。最理想的情况是，我希望有一个单独的“调试器”线程，它主要是空闲的，但作为它的任务之一，它会监听那个 F10 键，当它得到 F10 键时，它将导致脚本运行时线程抛出异常，从而停止执行脚本。所以我的问题是，有没有办法让一个线程导致另一个线程抛出异常？我的应用程序是用 C++ 编写的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T18:39:33.583

如果脚本实际上是由您的应用程序解释的，那么您可以告诉解释器在发生某些用户事件时停止执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T22:40:02.023

这是可能的。例如，在单独的线程、隐藏窗口和 WM_HOTKEY 中检测击键。调用 SuspendThread() 以冻结解释器线程。现在使用 GetThreadContext() 来获取解释器线程的 CPU 寄存器。修改CONTEXT.Eip为函数地址，调用SetThreadContext()。让该函数调用 RaiseException() 或抛出 C++ 异常。ResumeThread() 和繁荣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T18:30:28.267

一个简短的回答——不。

如果您的应用程序在 Windows 上运行，也许您可​​以从这个“调试器”线程发送消息并在主线程中有一个消息循环？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T18:53:09.283

该解决方案的问题是，要执行消息发送实现，我必须设置一个“侦听器”作为脚本解释器的一部分。现在，解释器只是执行函数。消息循环在解释器之外实现。如果在函数中存在无限循环，那么要跳出该脚本，我必须在解释器中执行每条指令之间检查一条消息，即 while(更多指令){检查 F10，执行脚本指令}。这似乎有很多额外的不必要的检查会减慢脚本的执行速度。但如果这是唯一的解决方案，那么我想这就是它必须的。我仍然认为必须有更好的方法。也许脚本解释器需要在子线程上运行，而主线程继续其消息循环，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T19:27:04.003

终止线程是不安全的，因为它可能使用整个进程共享的资源。

终止整个过程不太安全，但这对您没有帮助。

一种更安全的处理方法是让解释器定期检查事件并将停止事件视为终止（或至少溢出到更高循环）的情况。

对于 Windows，您还可以将 APC 排队到调用`RaiseException(...)`或抛出异常的线程（尽管我会避免后者，因为它跨越 API 边界），但这也意味着线程会将自己置于警报状态。我真的不推荐它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T13:17:09.883

无论您是否明确编码，您都需要检查消息循环中的“中断”变量。如果你通过一个简单的 实现这个`volatile int`，你将有一个非常简单的测试和很少的开销。

# python - urlsafe_b64encode 总是以 '=' 结尾？：

> ID：447875
> 
> 赞同：10
> 
> 时间：2009-01-15T18:27:40.583
> 
> 标签：python, hash, base64

我认为这一定是一个愚蠢的问题，但是为什么 urlsafe_b64encode() 的结果对我来说总是以'='结尾？'=' 网址不安全吗？

```
from random import getrandbits
from base64 import urlsafe_b64encode
from hashlib import sha256
from time import sleep

def genKey():
   keyLenBits = 64
   a = str(getrandbits(keyLenBits))
   b = urlsafe_b64encode(sha256(a).digest())
   print b

while 1:
   genKey()
   sleep(1) 
```

输出 ：

```
DxFOVxWvvzGdOSh2ARkK-2XPXNavnpiCkD6RuKLffvA=
xvA99ZLBrLvtf9-k0-YUFcLsiKl8Q8KmkD7ahIqPZ5Y=
jYbNK7j62KCBA5gnoiSpM2AGOPxmyQTIJIl_wWdOwoY=
CPIKkXPfIX4bd8lQtUj1dYG3ZOBxmZTMkVpmR7Uvu4s=
HlTs0tBW805gaxfMrq3OPOa6Crg7MsLSLnqe-eX0JEA=
FKRu0ePZEppHsvACWYssL1b2uZhjy9UU5LI8sWIqHe8=
aY_kVaT8kjB4RRfp3S6xG2vJaL0vAwQPifsBcN1LYvo=
6Us3XsewqnEcovMb5EEPtf4Fp4ucWfjPVso-UkRuaRc=
_vAI943yOWs3t2F6suUGy47LJjQsgi_XLiMKhYZnm9M=
CcUSXVqPNT_eb8VXasFXhvNosPOWQQWjGlipQp_68aY= 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T18:38:06.410

[Base64](http://en.wikipedia.org/wiki/Base64)使用 '=' 进行填充。您的字符串位长不能被 24 整除，因此用 '=' 填充。顺便说一句，'=' 应该是 URL 安全的，因为它经常用于 URL 中的参数。

也请参阅[此讨论](http://mail.python.org/pipermail/python-bugs-list/2007-February/037195.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T18:58:48.227

'=' 用于填充。如果您想将输出作为 URL 参数的值传递，您需要先将其转义，以便以后读取该值时不会丢失填充。

```
import urllib
param_value = urllib.quote_plus(b64_data) 
```

Python 只是遵循 RFC3548，允许使用 '=' 进行填充，即使看起来应该用更合适的字符替换它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T19:01:08.517

我希望 URI 解析器会忽略参数值部分中的“=”。

URI 参数是：“&”、[name]、“=”、[value]、next，因此值部分中的等号是无害的。未转义的 & 符号更有可能破坏解析器。

# iis - 在不成为“管理员”的情况下管理 IIS 需要哪些权限？

> ID：447877
> 
> 赞同：4
> 
> 时间：2009-01-15T18:27:48.320
> 
> 标签：iis, administration

有没有办法设置一个有权管理 IIS 服务的用户组（使用 MMC 中的 IIS 插件）而不是盒子上的“管理员”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T18:50:08.947

不幸的是，如果它是 IIS6，那么您需要是本地管理员。如果是 IIS7，那么事情会更加精细。如果您打算迁移到 IIS7（或目前正在使用它），那么这里有一篇很好的[博客文章](https://docs.microsoft.com/en-us/archive/blogs/david.wang/thoughts-on-delegating-iis-configuration-and-administration)可以帮助您完成它。

# php - Drupal 有哪些不足之处？

> ID：447878
> 
> 赞同：34
> 
> 时间：2009-01-15T18:27:48.413
> 
> 标签：php, drupal, content-management-system, complexity-theory

Drupal 是一个非常“无所不能”的 CMS。有些模块允许您添加几乎任何功能，这很棒。但是，感觉很多功能（v5 和 v6）似乎分散在各处，对用户来说不直观。作为一名开发人员，我留下的感觉是使用泡泡糖和细绳将网站拼凑在一起。

例如，要将文本添加到默认搜索框（单击时消失），您必须添加一些 jQuery 代码或覆盖主题。我还发现菜单系统比应有的复杂。

只有我有这种观点吗？你会对 Drupal 的核心做出哪些改变（如果有的话）？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-15T22:01:31.617

对我来说，Drupal 最大的缺点是大部分实时 Drupal 站点都存储在数据库中。由于没有自动方式在系统之间迁移内容或配置，因此必须手动完成对实时站点的更改，或者通过过于复杂的代码来处理。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-01-18T03:43:47.380

Drupal 最大的缺点之一是它在面向非程序员站点构建者的交钥匙工具和面向开发人员构建复杂 web 应用程序的框架之间摇摆不定。它为两个群体提供了一些很酷的东西，但是对一个群体的让步总是倾向于绊倒另一个群体。

Drupal 社区的增长趋势是显式构建开发人员 API，然后在 API 之上分层管理 UI 和最终用户 UI。这是一件好事，但仍然有很多遗留架构。该项目本周已经 8 岁了，每个站点都需要混合以不同速度发展的模块。

如果有人还没有构建一个模块来做你想做的事，那么在不修改核心代码的情况下有效地利用系统需要了解许多不同的内部 API、许多独特的 drupal 数据结构，并研究一些偶尔的时髦工作流程。随着人们需要做棘手的事情并且没有专业知识（或时间）来研究“正确”的做事方式，许多非常糟糕且无法维护的网站正在四处流传。

（免责声明：我刚刚为一本关于 Drupal 的书合着了几章，而且我全职从事 Drupal 工作，所以我离“公正”还差得远。但我确实喜欢这样认为我保持观点。我也喜欢 Django。）

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-01-15T20:20:50.807

Drupal 将让您完成 80% 的开箱即用，但最后的 20% 将需要数月时间。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-01-15T18:35:53.560

缺乏真正的面向对象设计意味着您经常不得不依靠其他开发人员的远见来留下“挂钩”功能来让您改变某种行为。

使用 Drupal 5 我也遇到过这样的情况，完成相对简单的设计更改的唯一方法是修补 Drupal 本身（然后确保在每个新的正式 Drupal 版本中重新应用补丁）。但是，公平地说，您应该已经看到 Drupal 4 中的情况有多糟糕。

我也很恼火，当我花时间识别当前 Drupal 生产版本中的错误或怪癖时，我提交了一个补丁，但补丁从未提交，因为基本上只有安全错误在当前稳定版本中得到修复。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-15T18:45:34.417

Drupal 是一个令人印象深刻的系统。它的所有功能都非常小，而且它的模块系统非常强大。但正如 Eli 所说，您的许多任务将依赖于其他开发人员以特定方式做某事。

Drupal 社区内部对其设计存在争议。Drupal 在 PHP 的 OOP 功能强大之前就已经存在，但现在它们已经存在，经常讨论改变系统以使用面向对象的数据结构。根据您的口味，这可能对您作为开发人员不利。我自己对此有两种看法。

该系统对新手来说似乎也非常“神奇”，因为它以某种方式完成了所有这些疯狂的事情，几乎没有解释。“我只是定义了一个函数，Drupal 怎么知道怎么调用它？！”

但是，我必须说，总的来说，我是 Drupal 的忠实粉丝。这是一个很好的系统，每个主要版本都能更好地加载。我一个人都等不及7了。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-10T02:05:39.653

Drupal 很适合入门，但您花费更多时间“撤消”而不是实际完成工作。这一直在改变，尤其是随着 Drupal 6 的发布，公平地说，它在贡献的模块中更加明显。

正如 Sean 所说，管理迁移也是一个问题。我仍然不知道将更改从开发站点移动到实时站点的好方法。

我不确定在当前的核心中我会改变什么，并且大多数缺陷正在解决中。图像管理需要工作，默认的管理界面有点混乱，在不涉及视图/面板等的情况下制作更复杂的布局可能需要一些工作。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-08-20T08:37:36.830

我发现它非常复杂。作为一名 php 开发人员，我每天都因与 php 无关但与 drupal 本身有关的问题而烦恼。如何/为什么/什么时候做X？它是一只需要驯服的大野兽。文档仅限于一些非常好的指南，一大堆糟糕的指南，甚至更多似乎总是在谷歌中弹出的无用论坛主题。

后端的可用性是废话。自定义主题还会改变包的“管理”部分的布局，这可能会非常令人沮丧，并导致布局不够漂亮。

如果您正在使用 html 切片器，则不可能使用尚未专门为 drupal 创建的 html。它几乎迫使你使用 drupal-html，有很多 div，每个 div 有 5 个详细的类等。本质上，html/css 的人不能指望在这个级别上了解 drupal。

我不喜欢它依赖文件名（10 个字长，它们之间有非常细微的差异）来构建主题的方式。

话虽如此，它可以做的一些事情非常酷，可以为您节省几天和几天的自定义 php 开发

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-17T18:57:45.180

Drupal 为非程序员提供了强大的工具，他们可以用更少的时间轻松建立一个功能齐全的网站。但问题是 Drupal 的学习曲线太高了。

如果一个人是 drupal 的新手并且想要定制一些东西，那么如果他想以正确的方式来做这将需要很多时间。在drupal中有很多方法可以做一件事情，找出他最适合或最适合新人的方法是头疼的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-01-21T08:22:09.140

我认为它的高学习曲线是唯一的缺点，因为大多数公司都在努力寻找优秀的 Drupal 人才。[http://drupalize.me/](http://drupalize.me/)和[http://buildamodule.com/](http://buildamodule.com/)在减少这种高学习曲线方面做得很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-15T23:38:32.513

我发现与 modx 或 joomla/mambo 等其他 cms 相比，默认管理界面不是很直观

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-10T11:00:31.953

它是用 PHP4 编写的。这将从版本 7 开始更改。您当然可以在 php5 中编写自己的模块。作为一名经验丰富的 Drupal 开发人员，我发现我的简历由于我对 php5 的有限接触而受到影响。

它不是运行 SOAP 等服务的最佳选择。调用整个 Drupal 堆栈来提供 Web 服务对性能的影响太大了。服务模块仍在开发中。

没有数据库事务支持。当您将其扩展到极端负载时，这将成为一个问题。

从命令行运行测试会很好。这在 simpletest 1.x 中是可能的，但当前版本不能很好地支持它。Simpletest还不够成熟。干净的 Drupal 安装可能会导致测试失败。一些默认包含的测试会强制您使用您可能不需要的内容类型和模块，并且您无法在不破解 simpletest 模块的情况下禁用它们。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-16T10:23:53.820

它有一个看似糟糕的安全记录：[http ://secunia.com/advisories/search/?search=Drupal](http://secunia.com/advisories/search/?search=Drupal)

# javascript - Javascript 在关闭浏览器窗口时获得重定向警报

> ID：447885
> 
> 赞同：2
> 
> 时间：2009-01-15T18:29:10.690
> 
> 标签：javascript, javascript-events

我试图让这个 Javascript 正常工作。我的意图是，当用户试图关闭网站页面以获得“留在当前页面或关闭”的警报时，如果他们点击“确定”我希望它关闭，如果他们点击“取消”我希望它重定向到另一个页面。问题是，当他们尝试转到同一站点上的另一个页面时，它会给他们那个弹出窗口。我希望它只在关闭时显示，而不是在离开页面到另一个页面时显示。我不确定这是否可能，我非常感谢您的帮助和评论。

```
 window.onbeforeunload = fget;
function yPop(url) {
  var found = 1;
  window.onbeforeunload = '';
  window.location = url;
  return false;
}
function fget() {
  alert("Thank you for visiting our website, you are welcome any time! \n\n");
  window.location = "http://NewLink.com";
  return "\n________________________\n\n PRESS 'CANCEL' To Stay On The Current Page \n\n________________________\n";
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-15T18:45:59.377

> 问题是，当他们尝试转到同一站点上的另一个页面时，它会给他们那个弹出窗口。我希望它仅在关闭时显示

1.  不要这样做。

2.  您不能仅检测关闭，但您可以通过单击内部链接和其他类型的离开来区分离开，包括外部链接、后退按钮、关闭和选择/键入新 URL。在页面加载后的脚本中，设置 onbeforeunload 事件，然后扫描所有 document.links 并针对当前 location.host 测试它们的 .host。如果它们匹配，则为内部链接。在这种情况下，向它们添加一个 onclick 事件，在返回 true 之前删除 onbeforeunload 事件，从而允许链接正常运行而不会发出警告。

3.  *说真的，不要这样做。*这是令人难以置信的恼人，傲慢和无用的。使用离开-纠缠脚本的网站管理员被谴责到互联网地狱的第四圈，他们必须在剩下的时间里只使用*ed*、一个破旧的牙刷和一个 <layer>-tag 来使样式表在 Netscape 4 上工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T11:49:36.717

您可能需要考虑构建一个“您即将离开此站点”页面。这个想法是，您将不在您网站上的页面上的 URL 包装为指向该页面，让访问者知道他们即将离开，并让他们有机会返回或继续。

它比意外的模态对话框更温和，它可以让您更好地格式化您的消息，并最终为您的用户提供完全相同的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T18:35:39.193

您应该使用窗口 onbeforeunload 事件。

[http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx)

[https://developer.mozilla.org/en/DOM/window.onbeforeunload](https://developer.mozilla.org/en/DOM/window.onbeforeunload)

对于 jquery 用户：

```
$(window).unload( function () { alert("Bye now!"); } ); 
```

# sql-server-2005 - 更改多个外键以指向新表

> ID：447892
> 
> 赞同：0
> 
> 时间：2009-01-15T18:31:23.010
> 
> 标签：sql-server-2005, tsql, foreign-keys

在 MS SQL Server 2005 上，我有一个要替换的表。许多其他表都有对此表的外键引用。有没有我可以运行的脚本来简单地将所有这些引用从旧表滚动到新表？

还是我必须仔细检查并专门删除这些外键中的每一个，并为每个外键编写一个新键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T18:38:41.247

您可以更安全地为新表删除并重新创建它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T18:41:33.783

或者，您可以为要替换的旧表中的新表重复使用相同的主键吗？然后您根本不必更新 FK。

如果主键是自动递增的“Identity”列，您可以使用“Set Identity_Insert On”，以允许您使用显式值（旧表中的 pk）将新记录插入到新表的标识列中。完成后运行 Set Identity_Insert Off 并关闭并运行。

# java - 什么是对象序列化？

> ID：447898
> 
> 赞同：416
> 
> 时间：2009-01-15T18:32:54.580
> 
> 标签：java, serialization, object-serialization

“对象序列化”是什么意思？你能用一些例子解释一下吗？

* * *

## 回答 #1

> 赞同：426
> 
> 时间：2009-01-15T18:37:04.167

序列化是将对象转换为一系列字节，以便可以轻松地将对象保存到持久存储或通过通信链路流式传输。然后可以对字节流进行反序列化 - 转换为原始对象的副本。

* * *

## 回答 #2

> 赞同：408
> 
> 时间：2009-01-15T19:57:05.440

您可以将序列化视为将对象实例转换为字节序列（取决于实现可能是二进制或非二进制）的过程。

当您想通过网络传输一个对象数据时，它非常有用，例如从一个 JVM 到另一个。

在Java中，序列化机制是内置在平台中的，但是需要实现*Serializable*接口才能使对象可序列化。

您还可以通过将属性标记为*transient*来防止对象中的某些数据被序列化。

最后你可以覆盖默认机制，并提供你自己的；这可能适用于某些特殊情况。为此，您可以使用[java 中的隐藏功能之一](https://stackoverflow.com/questions/15496/hidden-features-of-java/142676#142676)。

重要的是要注意被序列化的是对象的“值”或内容，而不是类定义。因此方法没有被序列化。

这是一个非常基本的示例，带有注释以方便阅读：

```
import java.io.*;
import java.util.*;

// This class implements "Serializable" to let the system know
// it's ok to do it. You as programmer are aware of that.
public class SerializationSample implements Serializable {

    // These attributes conform the "value" of the object.

    // These two will be serialized;
    private String aString = "The value of that string";
    private int    someInteger = 0;

    // But this won't since it is marked as transient.
    private transient List<File> unInterestingLongLongList;

    // Main method to test.
    public static void main( String [] args ) throws IOException  { 

        // Create a sample object, that contains the default values.
        SerializationSample instance = new SerializationSample();

        // The "ObjectOutputStream" class has the default 
        // definition to serialize an object.
        ObjectOutputStream oos = new ObjectOutputStream( 
                               // By using "FileOutputStream" we will 
                               // Write it to a File in the file system
                               // It could have been a Socket to another 
                               // machine, a database, an in memory array, etc.
                               new FileOutputStream(new File("o.ser")));

        // do the magic  
        oos.writeObject( instance );
        // close the writing.
        oos.close();
    }
} 
```

当我们运行这个程序时，文件“o.ser”被创建了，我们可以看到后面发生了什么。

**如果我们将someInteger**的值更改为，例如**Integer.MAX_VALUE**，我们可以比较输出以查看差异是什么。

这是一个屏幕截图，准确地显示了这种差异：

![替代文字](https://i.stack.imgur.com/oIVA5.png)

*[你能发现差异吗？;)]*

Java 序列化中还有一个额外的相关字段：[serialversionUID](http://www.google.com/search?q=serialversionUID)，但我想这已经太长了，无法涵盖它。

* * *

## 回答 #3

> 赞同：110
> 
> 时间：2015-09-17T04:39:07.107

敢于回答6年前的问题，为刚接触Java的人增加了一个非常高层次的理解

> 什么是序列化？

将对象转换为字节

> 什么是反序列化？

将字节转换回对象（反序列化）。

> 什么时候使用序列化？

当我们想要持久化对象时。当我们希望对象在 JVM 的生命周期之外存在时。

> 现实世界的例子：

ATM：当账户持有人尝试通过ATM从服务器取款时，账户持有人的取款明细等信息将被序列化并发送到服务器，在服务器上对明细进行反序列化并用于执行操作。

> java中如何进行序列化。

1.  实现`java.io.Serializable`接口（标记接口，所以没有方法可以实现）。

2.  持久化对象：使用`java.io.ObjectOutputStream`类，一个过滤器流，它是低级字节流的包装器（将对象写入文件系统或通过网络线路传输扁平对象并在另一端重建）。

*   `writeObject(<<instance>>)`- 写一个对象
*   `readObject()` - 读取序列化对象

> 记住：

序列化对象时，只会保存对象的状态，不会保存对象的类文件或方法。

当您序列化一个 2 字节的对象时，您会看到 51 字节的序列化文件。

> 步骤如何序列化和反序列化对象。

回答：它是如何转换为 51 字节文件的？

*   首先写入序列化流魔术数据（STREAM_MAGIC= "AC ED" and STREAM_VERSION=JVM 的版本）。
*   然后它写出与实例关联的类的元数据（类的长度、类的名称、serialVersionUID）。
*   然后它递归地写出超类的元数据，直到找到`java.lang.Object`.
*   然后从与实例关联的实际数据开始。
*   最后将与实例关联的对象的数据从元数据开始写入实际内容。

**编辑**：参考[链接](http://www.oracle.com/technetwork/articles/java/javaserial-1536170.html)阅读。

这将回答几个常见问题：

1.  如何不序列化类中的任何字段。
    答：使用transient关键字

2.  当子类被序列化时，父类会被序列化吗？
    回答：不，如果父级没有扩展 Serializable 接口的父级字段，则不会被序列化。

3.  当父类被序列化时，子类会被序列化吗？
    Ans: 是的，默认情况下子类也被序列化。

4.  如何避免子类被序列化？
    答：一个。覆盖 writeObject 和 readObject 方法并抛出`NotSerializableException`。

    湾。您也可以在子类中标记所有字段瞬态。

5.  一些系统级的类，例如 Thread、OutputStream 及其子类和 Socket 是不可序列化的。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-01-15T18:36:05.993

序列化是在内存中获取“活动”对象并将其转换为可以存储在某处（例如，在内存中，磁盘上）的格式，然后“反序列化”回活动对象。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2011-06-12T15:39:44.003

我喜欢@OscarRyz 呈现的方式。虽然在这里我继续[讲述](https://stackoverflow.com/questions/2475448/need-of-serialization-in-java/6321929#6321929)最初由@amitgupta 编写的序列化故事。

即使知道机器人类结构并拥有序列化数据，地球科学家也无法反序列化可以使机器人工作的数据。

```
Exception in thread "main" java.io.InvalidClassException:
SerializeMe; local class incompatible: stream classdesc
: 
```

火星的科学家们正在等待全额付款。付款完成后，火星的科学家与地球的科学家分享了[serialversionUID 。](http://www.javablogging.com/what-is-serialversionuid/)地球科学家将其设置为机器人类，一切都变得很好。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-04-26T00:23:10.300

我自己博客中的两分钱：

[下面是序列化的详细解释](http://prinavtech.blogspot.com/2017/04/java-serialization-and-deserialization.html)：（我自己的博客）

**序列化：**

序列化是保持对象状态的过程。它以字节序列的形式表示和存储。这可以存储在文件中。从文件中读取对象状态并恢复它的过程称为反序列化。

**序列化需要什么？**

在现代架构中，总是需要存储对象状态然后检索它。例如在 Hibernate 中，要存储一个对象，我们应该使类 Serializable。它的作用是，一旦对象状态以字节的形式保存，它就可以传输到另一个系统，然后该系统可以从状态中读取并检索类。对象状态可以来自数据库或不同的 jvm 或来自单独的组件。在序列化的帮助下，我们可以检索对象状态。

**代码示例及说明：**

首先让我们看一下Item Class：

```
public class Item implements Serializable{

    /**
    *  This is the Serializable class
    */
    private static final long serialVersionUID = 475918891428093041L;
    private Long itemId;
    private String itemName;
    private transient Double itemCostPrice;
    public Item(Long itemId, String itemName, Double itemCostPrice) {
        super();
        this.itemId = itemId;
        this.itemName = itemName;
        this.itemCostPrice = itemCostPrice;
      }

      public Long getItemId() {
          return itemId;
      }

     @Override
      public String toString() {
          return "Item [itemId=" + itemId + ", itemName=" + itemName + ", itemCostPrice=" + itemCostPrice + "]";
       }

       public void setItemId(Long itemId) {
           this.itemId = itemId;
       }

       public String getItemName() {
           return itemName;
       }
       public void setItemName(String itemName) {
            this.itemName = itemName;
        }

       public Double getItemCostPrice() {
            return itemCostPrice;
        }

        public void setItemCostPrice(Double itemCostPrice) {
             this.itemCostPrice = itemCostPrice;
        }
} 
```

在上面的代码中可以看到*Item*类实现了*Serializable*。

这是使类可序列化的接口。

现在我们可以看到一个名为*serialVersionUID*的变量被初始化为 Long 变量。这个数字是编译器根据类的状态和类属性计算出来的。这是帮助 jvm 在从文件中读取对象状态时识别对象状态的数字。

为此，我们可以查看官方的 Oracle 文档：

> 序列化运行时将版本号与每个可序列化类相关联，称为 serialVersionUID，在反序列化期间使用该版本号来验证序列化对象的发送方和接收方是否已为该对象加载了与序列化兼容的类。如果接收者为对象加载了一个类，该对象的 serialVersionUID 与相应发送者的类不同，则反序列化将导致 InvalidClassException。可序列化的类可以通过声明一个名为“serialVersionUID”的字段来显式声明自己的serialVersionUID，该字段必须是静态的、最终的和long类型：ANY-ACCESS-MODIFIER static final long serialVersionUID = 42L; 如果一个可序列化的类没有显式声明一个 serialVersionUID，然后序列化运行时将根据类的各个方面计算该类的默认 serialVersionUID 值，如 Java(TM) 对象序列化规范中所述。但是，强烈建议所有可序列化的类都显式声明 serialVersionUID 值，因为默认的 serialVersionUID 计算对类细节高度敏感，这些细节可能因编译器实现而异，因此可能在反序列化期间导致意外的 InvalidClassExceptions。因此，为了保证在不同的 java 编译器实现中具有一致的 serialVersionUID 值，可序列化的类必须声明一个显式的 serialVersionUID 值。还强烈建议显式 serialVersionUID 声明尽可能使用 private 修饰符，

如果您注意到我们使用的另一个关键字是*transient*。

如果字段不可序列化，则必须将其标记为瞬态。在这里，我们将*itemCostPrice*标记为瞬态并且不希望将其写入文件

现在让我们看看如何在文件中写入对象的状态，然后从那里读取它。

```
public class SerializationExample {

    public static void main(String[] args){
        serialize();
       deserialize();
    } 

    public static void serialize(){

         Item item = new Item(1L,"Pen", 12.55);
         System.out.println("Before Serialization" + item);

         FileOutputStream fileOut;
         try {
             fileOut = new FileOutputStream("/tmp/item.ser");
             ObjectOutputStream out = new ObjectOutputStream(fileOut);
             out.writeObject(item);
             out.close();
             fileOut.close();
             System.out.println("Serialized data is saved in /tmp/item.ser");
           } catch (FileNotFoundException e) {

                  e.printStackTrace();
           } catch (IOException e) {

                  e.printStackTrace();
           }
      }

    public static void deserialize(){
        Item item;

        try {
                FileInputStream fileIn = new FileInputStream("/tmp/item.ser");
                ObjectInputStream in = new ObjectInputStream(fileIn);
                item = (Item) in.readObject();
                System.out.println("Serialized data is read from /tmp/item.ser");
                System.out.println("After Deserialization" + item);
        } catch (FileNotFoundException e) {
                e.printStackTrace();
        } catch (IOException e) {
               e.printStackTrace();
        } catch (ClassNotFoundException e) {
               e.printStackTrace();
        }
     }
} 
```

在上面我们可以看到一个对象的序列化和反序列化的例子。

为此，我们使用了两个类。为了序列化我们使用了 ObjectOutputStream 的对象。我们已经使用 writeObject 方法将对象写入文件。

对于反序列化，我们使用了从文件中读取对象的 ObjectInputStream。它使用 readObject 从文件中读取对象数据。

上述代码的输出如下：

```
Before SerializationItem [itemId=1, itemName=Pen, itemCostPrice=12.55]
Serialized data is saved in /tmp/item.ser
After DeserializationItem [itemId=1, itemName=Pen, itemCostPrice=null] 
```

请注意，反序列化对象中的*itemCostPrice*为*null*，因为它没有被写入。

我们已经在本文的第一部分讨论了 Java 序列化的基础知识。

现在让我们深入讨论它以及它是如何工作的。

首先让我们从*serialversionuid 开始。*

*serialVersionUID*用作 Serializable 类中的版本控制。

如果您没有显式声明 serialVersionUID，JVM 将根据 Serializable 类的各种属性自动为您完成。

**Java 的计算 serialversionuid 的算法**（在此处阅读更多详细信息）

> 1.  类名。
>     2.  写为 32 位整数的类修饰符。
>     3.  每个接口的名称按名称排序。
>     4.  对于按字段名称排序的类的每个字段（私有静态和私有瞬态字段除外：字段的名称。字段的修饰符写为 32 位整数。字段的描述符。
>     5.  如果存在类初始值设定项，请写出以下内容：方法的名称，.
>     6.  方法的修饰符 java.lang.reflect.Modifier.STATIC，写成 32 位整数。
>     7.  方法的描述符，()V。
>     8.  对于按方法名称和签名排序的每个非私有构造函数：方法的名称，. 方法的修饰符写为 32 位整数。方法的描述符。
>     9.  对于按方法名称和签名排序的每个非私有方法：方法的名称。方法的修饰符写为 32 位整数。方法的描述符。
>     10.  SHA-1 算法在 DataOutputStream 产生的字节流上执行，并产生五个 32 位值 sha[0..4]。哈希值由 SHA-1 消息摘要的第一个和第二个 32 位值组合而成。如果消息摘要的结果，即五个 32 位字 H0 H1 H2 H3 H4，位于名为 sha 的五个 int 值的数组中，则哈希值将按如下方式计算：

```
 long hash = ((sha[0] >>> 24) & 0xFF) |
>            ((sha[0] >>> 16) & 0xFF) << 8 |
>            ((sha[0] >>> 8) & 0xFF) << 16 |
>            ((sha[0] >>> 0) & 0xFF) << 24 |
>            ((sha[1] >>> 24) & 0xFF) << 32 |
>            ((sha[1] >>> 16) & 0xFF) << 40 |
>            ((sha[1] >>> 8) & 0xFF) << 48 |
>        ((sha[1] >>> 0) & 0xFF) << 56; 
```

**Java的序列化算法**

> 序列化对象的算法描述如下：
> 1\. 它写出与实例关联的类的元数据。
> 2\. 递归地写出超类的描述，直到找到*java.lang.object*。
> 3\. 一旦完成元数据信息的写入，它就会从与实例关联的实际数据开始。但这一次，它从最顶层的超类开始。
> 4\. 它递归地写入与实例关联的数据，从最小的超类开始到最派生的类。

**要记住的事情：**

1.  类中的静态字段不能被序列化。

    ```
    public class A implements Serializable{
         String s;
         static String staticString = "I won't be serializable";
    } 
    ```

2.  如果 read 类中的 serialversionuid 不同，则会抛出`InvalidClassException`异常。

3.  如果一个类实现了可序列化，那么它的所有子类也将是可序列化的。

    ```
    public class A implements Serializable {....};

    public class B extends A{...} //also Serializable 
    ```

4.  如果一个类有另一个类的引用，则所有引用都必须是可序列化的，否则将不会执行序列化过程。在这种情况下，*NotSerializableException*在运行时被抛出。

例如：

```
public class B{
     String s,
     A a; // class A needs to be serializable i.e. it must implement Serializable
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2011-06-05T11:52:04.737

序列化意味着在java中持久化对象。如果你想保存对象的状态并且想稍后重建状态（可能在另一个JVM中）可以使用序列化。

请注意，对象的属性只会被保存。如果你想再次复活对象，你应该有类文件，因为只存储成员变量而不是成员函数。

例如：

```
ObjectInputStream oos = new ObjectInputStream(                                 
                                 new FileInputStream(  new File("o.ser")) ) ;
SerializationSample SS = (SearializationSample) oos.readObject(); 
```

可序列化是一个标记接口，它标记你的类是可序列化的。标记接口意味着它只是一个空接口，使用该接口将通知 JVM 这个类可以被序列化。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-15T18:36:43.840

序列化是将对象的状态转换为位以便将其存储在硬盘上的过程。当您反序列化同一个对象时，它将在以后保留其状态。它使您无需手动保存对象的属性即可重新创建对象。

[http://en.wikipedia.org/wiki/Serialization](http://en.wikipedia.org/wiki/Serialization)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-07-27T11:30:52.087

**Java[对象序列化](https://docs.oracle.com/javase/8/docs/technotes/guides/serialization/index.html)**

[![在此处输入图像描述](https://i.stack.imgur.com/HkyNv.png)](https://i.stack.imgur.com/HkyNv.png)

**[`Serialization`](https://docs.oracle.com/javase/7/docs/platform/serialization/spec/serial-arch.html)**是一种将 Java 对象图转换为字节数组以用于存储（`to disk file`）或传输（`across a network`）的机制，然后通过使用**反序列**化，我们可以恢复对象图。使用参考共享机制正确恢复对象图。*但在存储之前，请检查 input-file/network 中的 serialVersionUID 和 .class 文件 serialVersionUID 是否相同。如果没有，抛出一个`java.io.InvalidClassException`.*

> 每个版本化的类必须标识它能够为其写入流并从中读取的原始类版本。例如，版本化类必须声明：
> 
> serialVersionUID 语法
> 
> ```
> // ANY-ACCESS-MODIFIER static final long serialVersionUID = (64-bit has)L;
> private static final long serialVersionUID = 3487495895819393L; 
> ```

* * *

[serialVersionUID](https://javapapers.com/core-java/serialversionuid-in-java-serialization/)对序列化过程至关重要。但开发人员可以选择将其添加到 java 源文件中。如果未包含 serialVersionUID，则序列化运行时将生成一个 serialVersionUID 并将其与类关联。序列化对象将包含此 serialVersionUID 以及其他数据。

**注意**- 强烈建议所有可序列化的类都显式声明一个 serialVersionUID，这样会在反序列化**`since the default serialVersionUID computation is highly sensitive to class details that may vary depending on compiler implementations`**期间导致意外的 serialVersionUID 冲突，从而导致反序列化失败。

[检查可序列化的类](https://docs.oracle.com/javase/6/docs/platform/serialization/spec/class.html#5023)

[![在此处输入图像描述](https://i.stack.imgur.com/BqBZw.png)](https://i.stack.imgur.com/BqBZw.png)

* * *

> Java 对象只能序列化。如果一个类或其任何超类实现了**java.io.Serializable**接口或其子接口**java.io.Externalizable**。

*   一个类必须实现**java.io.Serializable 接口**才能成功序列化其对象。Serializable 是一个标记接口，用于通知编译器实现它的类必须添加可序列化行为。**这里Java虚拟机（JVM）负责它的自动序列化。**

    > **瞬态关键字：** `java.io.Serializable interface`
    > 
    > 在序列化对象时，如果我们不希望对象的某些数据成员被序列化，我们可以使用瞬态修饰符。瞬态关键字将阻止该数据成员被序列化。
    > 
    > *   序列化过程会忽略声明为瞬态或静态的字段。
    > 
    > > [瞬态](https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.5-200-A.1)和[易变](https://stackoverflow.com/a/47695757/5081877)
    > 
    > ```
    > +--------------+--------+-------------------------------------+
    > |  Flag Name   |  Value | Interpretation                      |
    > +--------------+--------+-------------------------------------+
    > | ACC_VOLATILE | 0x0040 | Declared volatile; cannot be cached.|
    > +--------------+--------+-------------------------------------+
    > |ACC_TRANSIENT | 0x0080 | Declared transient; not written or  |
    > |              |        | read by a persistent object manager.|
    > +--------------+--------+-------------------------------------+ 
    > ```

    ```
    class Employee implements Serializable {
        private static final long serialVersionUID = 2L;
        static int id;

        int eno; 
        String name;
        transient String password; // Using transient keyword means its not going to be Serialized.
    } 
    ```

*   实现 Externalizable 接口允许对象完全控制对象的序列化形式的内容和格式。调用 Externalizable 接口的方法 writeExternal 和 readExternal 来保存和恢复对象状态。当由一个类实现时，它们可以使用 ObjectOutput 和 ObjectInput 的所有方法写入和读取自己的状态。对象负责处理发生的任何版本控制。

    ```
    class Emp implements Externalizable {
        int eno; 
        String name;
        transient String password; // No use of transient, we need to take care of write and read.

        @Override
        public void writeExternal(ObjectOutput out) throws IOException {
            out.writeInt(eno);
            out.writeUTF(name);
            //out.writeUTF(password);
        }
        @Override
        public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
            this.eno = in.readInt();
            this.name = in.readUTF();
            //this.password = in.readUTF(); // java.io.EOFException
        }
    } 
    ```

*   只有支持 java.io.Serializable 或 java.io.Externalizable 接口的对象才能成为`written to`**/**`read from`流。每个可序列化对象的类都被编码，包括类的类名和签名、对象的字段和数组的值，以及从初始对象引用的任何其他对象的闭包。

*文件的可序列化示例*

```
public class SerializationDemo {
    static String fileName = "D:/serializable_file.ser";

    public static void main(String[] args) throws IOException, ClassNotFoundException, InstantiationException, IllegalAccessException {
        Employee emp = new Employee( );
        Employee.id = 1; // Can not Serialize Class data.
        emp.eno = 77;
        emp.name = "Yash";
        emp.password = "confidential";
        objects_WriteRead(emp, fileName);

        Emp e = new Emp( );
        e.eno = 77;
        e.name = "Yash";
        e.password = "confidential";
        objects_WriteRead_External(e, fileName);

        /*String stubHost = "127.0.0.1";
        Integer anyFreePort = 7777;
        socketRead(anyFreePort); //Thread1
        socketWrite(emp, stubHost, anyFreePort); //Thread2*/

    }
    public static void objects_WriteRead( Employee obj, String serFilename ) throws IOException{
        FileOutputStream fos = new FileOutputStream( new File( serFilename ) );
        ObjectOutputStream objectOut = new ObjectOutputStream( fos );
        objectOut.writeObject( obj );
        objectOut.close();
        fos.close();

        System.out.println("Data Stored in to a file");

        try {
            FileInputStream fis = new FileInputStream( new File( serFilename ) );
            ObjectInputStream ois = new ObjectInputStream( fis );
            Object readObject;
            readObject = ois.readObject();
            String calssName = readObject.getClass().getName();
            System.out.println("Restoring Class Name : "+ calssName); // InvalidClassException

            Employee emp = (Employee) readObject;
            System.out.format("Obj[No:%s, Name:%s, Pass:%s]", emp.eno, emp.name, emp.password);

            ois.close();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
    public static void objects_WriteRead_External( Emp obj, String serFilename ) throws IOException {
        FileOutputStream fos = new FileOutputStream(new File( serFilename ));
        ObjectOutputStream objectOut = new ObjectOutputStream( fos );

        obj.writeExternal( objectOut );
        objectOut.flush();

        fos.close();

        System.out.println("Data Stored in to a file");

        try {
            // create a new instance and read the assign the contents from stream.
            Emp emp = new Emp();

            FileInputStream fis = new FileInputStream(new File( serFilename ));
            ObjectInputStream ois = new ObjectInputStream( fis );

            emp.readExternal(ois);

            System.out.format("Obj[No:%s, Name:%s, Pass:%s]", emp.eno, emp.name, emp.password);

            ois.close();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
} 
```

*网络上的可序列化示例*

[将object](https://en.wikipedia.org/wiki/Distributed_object)的状态分布在不同的地址空间中，无论是在同一台计算机上的不同进程中，还是在通过网络连接的多台计算机中，但它们通过共享数据和调用方法一起工作。

*   [数据编组](https://docs.oracle.com/cd/E13203_01/tuxedo/tux80/atmi/intatm23.htm)
*   [存根和骨架](https://docs.oracle.com/javase/7/docs/platform/rmi/spec/rmi-arch2.html)

```
/**
 * Creates a stream socket and connects it to the specified port number on the named host. 
 */
public static void socketWrite(Employee objectToSend, String stubHost, Integer anyFreePort) {
    try { // CLIENT - Stub[marshalling]
        Socket client = new Socket(stubHost, anyFreePort);
        ObjectOutputStream out = new ObjectOutputStream(client.getOutputStream());
        out.writeObject(objectToSend);
        out.flush();
        client.close();
    } catch (IOException e) {
        e.printStackTrace();
    }
}
// Creates a server socket, bound to the specified port. 
public static void socketRead(  Integer anyFreePort ) {
    try { // SERVER - Stub[unmarshalling ]
        ServerSocket serverSocket = new ServerSocket( anyFreePort );
        System.out.println("Server serves on port and waiting for a client to communicate");
            /*System.in.read();
            System.in.read();*/

        Socket socket = serverSocket.accept();
        System.out.println("Client request to communicate on port server accepts it.");

        ObjectInputStream in = new ObjectInputStream(socket.getInputStream());
        Employee objectReceived = (Employee) in.readObject();
        System.out.println("Server Obj : "+ objectReceived.name );

        socket.close();
        serverSocket.close();
    } catch (IOException | ClassNotFoundException e) {
        e.printStackTrace();
    }
} 
```

* * *

@看

*   [实现可序列化与可外部化](https://stackoverflow.com/a/48301301/5081877)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-09-12T09:03:50.617

序列化是将对象保存在存储介质（如文件或内存缓冲区）中或以二进制形式通过网络连接传输的过程。序列化的对象是独立于 JVM 的，并且可以被任何 JVM 重新序列化。在这种情况下，“内存中”的 java 对象状态被转换为字节流。用户无法理解这种类型的文件。它是一种特殊类型的对象，即被 JVM（Java 虚拟机）重用。这种序列化对象的过程也称为对对象进行压缩或编组。

要序列化的对象必须实现`java.io.Serializable`接口。对象的默认序列化机制写入对象的类、类签名以及所有非瞬态和非静态字段的值。

```
class ObjectOutputStream extends java.io.OutputStream implements ObjectOutput, 
```

`ObjectOutput`interface 扩展了`DataOutput`接口并添加了用于序列化对象和将字节写入文件的方法。`ObjectOutputStream`扩展`java.io.OutputStream`和实现`ObjectOutput` 接口。它将对象、数组和其他值序列化为流。因此 的构造函数 `ObjectOutputStream`写为：

```
ObjectOutput ObjOut = new ObjectOutputStream(new FileOutputStream(f)); 
```

上面的代码已用于使用构造函数创建`ObjectOutput`类的实例，该`ObjectOutputStream( )`构造函数将 的实例`FileOuputStream`作为参数。

通过`ObjectOutput`实现`ObjectOutputStream`类来使用接口。被`ObjectOutputStream`构造为序列化对象。

*在java中反序列化一个对象*

序列化的相反操作称为反序列化，即从一系列字节中提取数据称为反序列化，也称为膨胀或解组。

`ObjectInputStream`扩展`java.io.InputStream`和实现`ObjectInput` 接口。它反序列化来自输入流的对象、数组和其他值。因此 的构造函数 `ObjectInputStream`写为：

```
ObjectInputStream obj = new ObjectInputStream(new FileInputStream(f)); 
```

上面的程序代码创建了类的实例`ObjectInputStream`来反序列化已被`ObjectInputStream`类序列化的文件。上面的代码使用类的实例创建实例，该实例`FileInputStream`包含必须反序列化的指定文件对象，因为`ObjectInputStream()`构造函数需要输入流。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-15T18:37:14.947

序列化是将 Java 对象转换为字节数组，然后以保留状态再次转换回对象的过程。对于通过网络发送对象或将内容缓存到磁盘等各种事情很有用。

从这篇简短的文章中阅读更多内容，[该文章很好地解释了该过程的编程部分，](http://java.sun.com/developer/technicalArticles/Programming/serialization/)然后转到[Serializable javadoc](http://java.sun.com/j2se/1.5.0/docs/api/java/io/Serializable.html)。您可能也有兴趣阅读[此相关问题](https://stackoverflow.com/questions/352117/how-does-javas-serialization-work-and-when-it-should-be-used-instead-of-some-oth)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-12-17T09:49:19.317

将文件作为对象返回：[http ://www.tutorialspoint.com/java/java_serialization.htm](http://www.tutorialspoint.com/java/java_serialization.htm)

```
 import java.io.*;

        public class SerializeDemo
        {
           public static void main(String [] args)
           {
              Employee e = new Employee();
              e.name = "Reyan Ali";
              e.address = "Phokka Kuan, Ambehta Peer";
              e.SSN = 11122333;
              e.number = 101;

              try
              {
                 FileOutputStream fileOut =
                 new FileOutputStream("/tmp/employee.ser");
                 ObjectOutputStream out = new ObjectOutputStream(fileOut);
                 out.writeObject(e);
                 out.close();
                 fileOut.close();
                 System.out.printf("Serialized data is saved in /tmp/employee.ser");
              }catch(IOException i)
              {
                  i.printStackTrace();
              }
           }
        }

    import java.io.*;
    public class DeserializeDemo
    {
       public static void main(String [] args)
       {
          Employee e = null;
          try
          {
             FileInputStream fileIn = new FileInputStream("/tmp/employee.ser");
             ObjectInputStream in = new ObjectInputStream(fileIn);
             e = (Employee) in.readObject();
             in.close();
             fileIn.close();
          }catch(IOException i)
          {
             i.printStackTrace();
             return;
          }catch(ClassNotFoundException c)
          {
             System.out.println("Employee class not found");
             c.printStackTrace();
             return;
          }
          System.out.println("Deserialized Employee...");
          System.out.println("Name: " + e.name);
          System.out.println("Address: " + e.address);
          System.out.println("SSN: " + e.SSN);
          System.out.println("Number: " + e.number);
        }
    } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-06-03T15:07:37.523

|*| 序列化类：将对象转换为字节并将字节转换回对象（反序列化）。

```
class NamCls implements Serializable
{
    int NumVar;
    String NamVar;
} 
```

|=> 对象序列化是将对象的状态转换为字节流的过程。

*   |-> 当您希望对象在 JVM 的生命周期之外存在时实现。

*   |-> 序列化对象可以存储在数据库中。

*   |-> 可序列化对象无法被人类读取和理解，因此我们可以实现安全性。

|=> 对象反序列化是获取对象状态并将其存储到对象（java.lang.Object）中的过程。

*   |-> 在存储其状态之前，它会检查来自输入文件/网络的serialVersionUID 和.class 文件serialVersionUID 是否相同。
    如果不抛出 java.io.InvalidClassException。

|=> Java 对象只有在其类或其任何超类时才可序列化

*   实现 java.io.Serializable 接口或

*   它的子接口 java.io.Externalizable。

|=> 类中的静态字段不能被序列化。

```
class NamCls implements Serializable
{
    int NumVar;
    static String NamVar = "I won't be serializable";;
} 
```

|=> 如果您不想序列化类的变量，请使用瞬态关键字

```
class NamCls implements Serializable
{
    int NumVar;
    transient String NamVar;
} 
```

|=> 如果一个类实现了可序列化，那么它的所有子类也将是可序列化的。

|=> 如果一个类有另一个类的引用，所有的引用都必须是可序列化的，否则不会执行序列化过程。在这种情况下，
NotSerializableException 在运行时被抛出。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-11-19T20:43:40.283

我将提供一个类比，以潜在地帮助巩固**对象序列化/反序列化**的概念目的/实用性。

我想象***对象序列化/反序列化***是在试图通过雨水渠移动对象的上下文中。对象本质上被“分解”或*序列*化成更模块化的版本——在这种情况下，是*一系列字节*——以便有效地被授予通过介质的通道。在计算意义上，我们可以将字节通过雨水渠的路径视为类似于通过网络的字节。我们正在改变我们的对象，以符合更理想的运输方式或格式。序列化的对象通常存储在二进制文件中，以后可以读取、写入或两者兼而有之。

也许一旦我们的对象能够以分解的一系列字节的形式从排水管中溜走，我们可能希望将该对象的表示作为二进制数据存储在数据库或硬盘驱动器中。不过，主要的收获是，通过序列化/反序列化，我们可以选择让我们的对象在序列化后保持二进制形式，或者通过执行反序列化“检索”对象的原始形式。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-02-12T19:24:10.247

序列化是通过将对象转换为字节码来保存对象的特定状态的过程。此转换后的字节码用于在 2 个 JVM 之间传输对象状态，其中接收 JVM 反序列化字节码以检索共享对象的状态。序列化和反序列化是使用 serialVersionUID 作为所涉及的 JVMS 中的参考来完成的。

在 Java 中，使用序列化和外部化接口可以实现相同的目的

# c - 为什么我的 c 程序没有按应有的方式释放内存？

> ID：447899
> 
> 赞同：2
> 
> 时间：2009-01-15T18:33:09.480
> 
> 标签：c, macos, unix, memory

我已经用 c 编写了一个程序，想看看它使用了多少内存并注意到，在正常使用它时内存使用量会增加（在启动时它使用大约 250k，现在它是 1.5mb）。afaik，我释放了所有未使用的内存，几个小时后，该应用程序使用的内存更少。有没有可能，释放的内存只是从“活动”内存到“有线”或其他东西，所以在需要可用空间时释放它？顺便提一句。如果这很重要，我的机器在 mac os x 上运行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-15T18:36:01.890

你如何确定内存使用情况？您是否尝试过使用[`valgrind`](http://valgrind.org/)来定位潜在的内存泄漏？这真的很容易。只需使用 启动您的应用程序`valgrind`，运行它，然后查看结构良好的输出。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-15T18:39:33.833

如果您正在查看操作系统的内存使用情况，您可能会看到这种行为。释放的内存不会自动返回给操作系统，但通常会留在进程中，并且可以稍后进行 malloc。你看到的通常是内存使用的高水位线。

正如 Konrad Rudolph 建议的那样，使用从进程内部检查内存的东西来查找内存链接。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T18:40:13.303

C 库通常不会将“小”分配返回给操作系统。相反，它会在您下次使用时保留内存`malloc`。

但是，许多 C 库会释放大块，因此您可以尝试执行几兆字节的 malloc，然后释放它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T18:40:33.240

在 OSX 上，如果您从 OSX 安装了开发者工具，您应该能够使用 MallocDebug.app（因为您可能无法找到 OSX 的 valgrind 端口）。

/Developer/Applications/PerformanceTools/MallocDebug.app

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T19:15:45.260

我同意每个人已经说过的话，但我确实想添加一些针对 os x 的澄清说明：

首先，操作系统实际上分配内存，使用`vm_allocate`它一次分配整个页面。因为与此相关的成本，就像其他人所说的那样，当您通过`free(3)`. 具体来说，如果内存页内还有其他分配，则不会被释放。当前内存页面在 mac os x 中为 4096 字节。页中的字节数可以通过编程方式确定，`sysctl(2)`或者更容易使用`getpagesize(2)`. 您可以使用此信息来优化内存使用。

其次，用户空间应用程序不连接内存。通常，内核为关键数据结构连接内存。有线内存基本上是永远不会被换出并且永远不会产生页面错误的内存。如果由于某种原因，在连接的内存页面中产生了页面错误，内核将崩溃，您的计算机将崩溃。如果您的应用程序显着增加了计算机的有线内存，这是一个非常糟糕的信号。这通常意味着您的应用程序正在做一些显着增加内核数据结构的事情，例如分配而不是获取数百个子进程线程。（当然，这是一个一般性的陈述......在某些情况下，这种增长是预期的，例如在开发虚拟主机或类似的东西时）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T19:18:49.403

除了其他人已经写的：

malloc() 从操作系统分配更大的块，并在 malloc() 时将其分成更小的块。当 free()ing 时，该片段首先进入一个空闲列表，以便在大小合适的情况下由另一个 malloc 快速重用。此时它可能会与另一个空闲项合并，以形成更大的空闲块，以避免碎片（那里存在一大堆不同的算法，从 freeLists 到二进制大小的片段到散列等等）。当释放的片段到达以便可以连接多个片段时，free() 通常会这样做，但有时，片段会保留，这取决于 malloc() 和 free() 的大小和顺序。此外，只有在创建了这样一个大的空闲块时，它才会（有时）作为一个块返回给操作系统。但通常， malloc() 把东西放在口袋里，

请注意，没有一个 malloc/free 算法。有一大堆不同的实现（和文献）。高度依赖系统、操作系统和库。

# .net - System.Runtime.InteropServices.COMException (0x82DA0002)：来自 HRESULT 的异常：0x82DA0002

> ID：447922
> 
> 赞同：0
> 
> 时间：2009-01-15T18:37:43.043
> 
> 标签：.net, exception

有谁知道这意味着什么？

> System.Runtime.InteropServices.COMException (0x82DA0002)：来自 HRESULT 的异常：System.Windows.Forms.Control.MarshaledInvoke 的 0x82DA0002（控制调用者，委托方法，Object[] args，布尔同步）在 System.Windows.Forms.Control。 Invoke(Delegate method, Object[] args)
> at Midden.cMidden.OnFileChanged(Object sender, FileSystemEventArgs e) at System.IO.FileSystemWatcher.OnDeleted(FileSystemEventArgs e) at System.IO.FileSystemWatcher.NotifyFileSystemEventArgs(Int32 action, String name)在 System.IO.FileSystemWatcher.CompletionStatusChanged（UInt32 错误代码，UInt32 numBytes，NativeOverlapped* 重叠指针）在 System.Threading._IOCompletionCallback.PerformIOCompletionCallback（UInt32 错误代码，UInt32 numBytes，NativeOverlapped* pOVERLAP）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T19:08:03.217

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comexception.aspx)：（希望对您有所帮助）

从 COM 方法调用返回无法识别的 HRESULT 时引发的异常。

公共语言运行时将众所周知的 HRESULT 转换为 .NET 异常，使 COM 对象能够将有意义的错误信息返回给托管客户端。HRESULT 到异常的映射也可以通过将特定的 HRESULT 返回给非托管客户端来实现另一个方向。有关映射详细信息，请参阅如何：映射 HRESULT 和异常。

当运行时遇到不熟悉的 HRESULT（缺少特定的相应异常的 HRESULT）时，它会抛出 COMException 类的实例。此通用异常公开与任何异常相同的成员，并包括一个公共 ErrorCode 属性，该属性包含被调用者返回的 HRESULT。如果错误消息可用于运行时（从 IErrorInfo 接口或 Visual Basic 中的 Err 对象获得，或者在某些情况下从操作系统获得），则该消息将返回给调用者。但是，如果 COM 组件开发人员未能包含错误消息，则运行时将返回八位 HRESULT 来代替消息字符串。拥有 HRESULT 允许调用者确定一般异常的原因。

尽管您可以使用 COMException 类将特定的 HRESULT 返回给非托管客户端，但抛出特定的 .NET 异常比使用通用异常要好。考虑到托管客户端和非托管客户端都可以使用您的 .NET 对象，并且向托管调用者抛出 HRESULT 比抛出异常更难理解。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-29T11:18:00.243

对于我们在工作中表明服务器上的磁盘空间很少或没有磁盘空间

# visual-studio - F6 for compiling?

> ID：447941
> 
> 赞同：5
> 
> 时间：2009-01-15T18:41:47.340
> 
> 标签：visual-studio, visual-studio-2008

I have become accustomed to using `F6` to compile the current document. A third-party install appears to have turned this function off. (`F6` no longer does anything.)

Can anyone tell me how to get it back?

I'm using VS2008

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-15T18:45:24.557

```
Tools > Options > Keybord 
```

This dialog lets you bind keyboard shortcuts to your heart's content. BTW this is how you bind keyboard shortcuts to custom IDE macros as well.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T18:56:24.503

VMware's integrated debugging tool did this to me too. You can change this back to whatever you want, but every time you restart Visual Studio your keyboard shortcuts will be changed again.

The only way I could fix this was to remove the VMware debugging tools.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T20:23:03.953

Thanks. The dialog: Tools > Options > Keybord Allowed me to set the keyboard back to *Visual C# 2005*. So far, this seems to be what I wanted.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T18:51:25.153

Its become a habit for me to use Ctrl + Shift + B to build my solutions. I know this doesnt answer your question, but I thought I would point it out.

Another keyboard shortcut is use constantly is Alt + Shift + F10\. It opens the drop menu from the little red square under a change (the autocorrect type thing, I'm not sure what its called, also works for autocorrect in all the MS apps)

# objective-c - Objective-C 和 linux 上的游戏编程

> ID：447942
> 
> 赞同：12
> 
> 时间：2009-01-15T18:42:47.307
> 
> 标签：objective-c, linux

我想在游戏编程中尝试一下 Objective-C。问题是我需要一些工具和库。

我首先想到的是 GUI 和图形库。

我有什么选择？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-15T18:59:50.550

OpenStep/Cocoa 类型的 Objective C 平台有四种非 Mac 实现：

1.  OpenStep/NextStep：仅支持 Openstep/NeXT 机器 - 已停产。
2.  p..... 可以记住名字或在网上找到它 - 它就在某个地方！- Linux
3.  Cocotron - 仅限 Windows
4.  GNUStep Linux/Windows

GNUSTep 是适用于 Linux 的方法......我提到其他的，因为 2 和 3 在源代码中可用，它们可用于修补 GNUStep 没有的代码中的漏洞，它们可能会。

当涉及到图形库时，您可能会遇到问题，因为 Apple 放弃了旧的 OpenStep API，并且不断发展其 API 的速度远远快于 GNUStep 人们可以追赶的速度。不支持最新的图形库，例如 Core Animation。

由于 Objective C 对 C 和 C++ 友好，您可以按原样使用这些库中的任何一个，或者通过制作包装器使 Objective C 友好。

您可能希望也可能不希望与 Mac 兼容并为此制作版本，因此它可能并不重要。

如果你这样做了，你可能想为 OpenGL 之类的东西做一个 Linux Wrapper，如果它丢失了，我认为是这样，但你自己检查一下....

有 Linux 开发工具，包括用于 Linux 上的 GNUStep 的项目 IDE 和 GUI 构建器。

托尼

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-15T18:47:36.923

我相信您要的是[GNUStep](http://www.gnustep.org/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T18:57:20.913

[SDL](http://www.libsdl.org/)是一个 C 库，在游戏编程中很流行。

如果你正在寻找 Foundation/AppKit 的东西，你也可以看看[Cocotron](http://www.cocotron.org/)。我从来没有尝试过。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-15T19:00:54.617

[支持 SDL，这里](http://savannah.nongnu.org/projects/sdlobjc/)有 Objective-C 绑定。然而，由于 Objective-C 是 C 之上的一个薄 OO 层，您可以使用大多数现有的 C 库进行游戏开发、SDL、Clanlib 等......

# c# - 如何编写正则表达式来匹配包含 XYZ 但不包含 ABC 的文本？

> ID：447943
> 
> 赞同：2
> 
> 时间：2009-01-15T18:43:00.707
> 
> 标签：c#, regex

如果字符串包含 XYZ 但在它之前的某个位置不包含 ABC，我想编写一个匹配的正则表达式。所以“blah XYZ blah”应该匹配，但“blah ABC blah XYZ blah”不应该匹配。

有任何想法吗？特别是我正在用 c# 编写正则表达式，以防该语法有任何特定的内容。

我想我可以使用负面的lookbehind，但以前没有使用过......

谢谢！

更新：我需要一个正则表达式，因为我无法修改代码，只是一些配置。

更新：更改，因为我实际上只需要检查 ABC 是否出现*在*XYZ 之前，我不需要检查它是否出现在之后。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T19:55:44.680

```
^(?:(?<!ABC).)*XYZ 
```

对我的小测试集很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T18:44:53.777

有什么问题吗

```
 string.Contains("XYZ") && !string.contains("ABC") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T22:46:41.323

无需向后看：

```
^(?:(?!ABC).)*XYZ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T19:40:39.467

这应该够了吧：

```
^([^(ABC)]*)(XYZ)(.*)$ 
```

一些例子：

```
sadsafjaspodsa //False
sadABCdsaABCdsa //False
sadABCdsaABCdsaXYZ //False
sadABCdsaABCdsaXYZaa //False
sadABCddasABCsaXYZdsa //False
sadsaXYZdsa //True
sadsaXYZ //True 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T20:12:31.713

这应该有效：

```
^(?:(?!ABC).{3,})?XYZ 
```

如果它也不应该出现在`XYZ`：

```
^(?:(?!ABC).{3,})?XYZ(?:.{3,}(?<!ABC))?$ 
```

# sql - SQL Server 2005：确定变量的数据类型

> ID：447944
> 
> 赞同：16
> 
> 时间：2009-01-15T18:43:08.617
> 
> 标签：sql, sql-server-2005, tsql

是否可以在 TSQL 运行时确定局部变量的类型？

例如，假设我想按照以下方式做一些事情：

```
IF ( @value IS INTEGER ) 
```

或者

```
IF ( TYPEOF(@value) = <whatever> ) 
```

有谁知道有什么方法可以做到这一点？

编辑：这不是针对特定任务的，这更像是一个常识性问题。我确实很欣赏表明类型应该已知的答案，因为它是在同一批次中声明的，我很好奇是否可以在运行时确定类型。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-15T18:50:32.453

运行这个

```
declare @d int

select @d = 500

if cast(sql_variant_property(@d,'BaseType') as varchar(20))  = 'int'
print 'yes'
else
print 'no' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-15T18:48:40.913

我不这么认为——但它是一个局部变量，所以在同一个过程中声明它，这样你无论如何都会知道类型——或者我错过了什么？

# asp.net - Asp.Net，用VS2008本地web服务器上传图片

> ID：447946
> 
> 赞同：0
> 
> 时间：2009-01-15T18:43:33.500
> 
> 标签：asp.net, visual-studio, upload

我的网站的用户将能够上传图片。此图片将位于 /images/folder/picture.jpg 中。我的问题是：在VS2008下运行时，表单会在数据库列（sql server）中插入一整行，并将图片上传到文件夹中。结果页面将显示图像。但是稍后再次运行 Web 服务器时，数据库会正常，但图像将不再存在，因为我猜本地服务器每个计时器都是新启动的，文件夹中没有任何内容。我是上传新手，所以我想知道你如何测试这种东西。

此外，图像的文件夹必须在 /Content 下吗？我不确定将它放在哪里以及在 IIS 下运行时它将如何转换？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-09T03:04:37.253

The ASP.NET development server does not clear the directory each time it starts. Have you verified the files are actually being written where you think they are? Seems like you've probably got some path issues and the files are possibly being written to the ASP.NET Temporary Files folder which may change from instance to instance.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T18:46:55.457

我必须用我的本地服务器对此进行测试，以确切了解它对本地上传的图像的作用……但一种想法是，与其将图片存储在文件系统上，不如将其存储在数据库本身中.

# oop - 类型检查可以吗？

> ID：447947
> 
> 赞同：1
> 
> 时间：2009-01-15T18:43:40.643
> 
> 标签：oop, inheritance, interface

即使您正在检查接口，类型检查是否被认为是不好的做法？我知道您应该始终对接口而不是实现进行编程——这就是它的意思吗？

例如，在 PHP 中，以下是否可以？

```
if($class instanceof AnInterface) {
   // Do some code
} 
```

或者有没有更好的方法来改变基于类类型的代码行为？

**编辑**：为了清楚起见，我说的是检查一个类是否*实现*了一个接口，而不仅仅是它是某个类的实例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T19:01:54.617

只要你遵循[LSP](http://en.wikipedia.org/wiki/Liskov_substitution_principle)，我看不出有什么问题。您的代码必须与接口的*任何*实现一起使用。只要您可以正确使用接口的*任何*实现，某些实现会导致您遵循不同的代码路径，这不是问题。

如果您的代码不适用于接口的所有实现，那么您首先不应该使用该接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T18:59:25.027

如果你可以避免类型检查，你应该；但是，我发现它很方便的一个场景是，我们有一个 Web 服务，它接收一条消息，但消息的内容可能会改变。我们必须将消息持久化回数据库中，以便获得正确的组件将消息分解到适当的表中，我们在某种意义上使用了类型检查。

我发现比 if ($class instanceof SomeOtherType) 更常见和更灵活的是例如定义一个 IProcessing 策略，然后使用基于 $class 类型的工厂创建正确的类。

所以在c#中大致是这样的：

```
void Process(Message msg)
{
    IProcessor processor=ProcessignFactory.GetProcessor(msg.GetType()); 
    processor.Process(msg); 
} 
```

但是，如果您只处理一个不会更改的变体使用类型检查来实现它，并且当/如果您发现自己错了并且需要更多检查然后将其重构为更健壮的解决方案，则有时这样做可能会过大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T19:37:24.013

在我的实践中，任何类型检查（以及类型转换）总是表明代码或语言有问题。

所以我尽量避免它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T15:44:01.783

在接口提供了做某事所需的所有方法但没有提供足够的方法来做好某事的情况下，通常需要运行时类型检查。这种情况的一个主要示例是确定可枚举序列中的项目数。可以通过枚举序列来做出这样的确定，但是许多可枚举对象“知道”它们包含多少项。如果一个对象知道它包含多少项目，那么询问它可能比枚举集合并单独计算项目更有效。

可以说，`IEnumerable`应该提供一些方法来询问它对包含的项目数量的了解[认识到对象可能知道该数字是无限的，或者它最多为 4,591（但可能少得多）等的可能性.]，但事实并非如此。理想的情况是，如果`IEnumerable`可以生成一个新版本的接口，其中包括它添加的任何“新”方法的默认实现，并且这种接口可以被认为是由当前版本的任何实现实现的。不幸的是，因为不存在这样的功能，所以在不枚举的情况下获取可枚举集合的计数的唯一方法是检查它是否实现了任何已知的包含`Count`成员的集合接口。

# asp.net - 对于不太常见的场景，ASP.NET MVC 路由的最佳方式是什么？

> ID：447968
> 
> 赞同：2
> 
> 时间：2009-01-15T18:48:12.240
> 
> 标签：asp.net, asp.net-mvc, routing, url-routing

**更新 - 2009 年 1 月 21 日：**

我能够使其正常工作的唯一方法是创建具有附加路径信息的路由......换句话说，路由需要而不是**[http://company.com/myDepartment/myTeam/action/id](http://company.com/myDepartment/myTeam/action/id)**构建以处理**[http://company.com/department/myDepartment/team/myTeam](http://company.com/department/myDepartment/team/myTeam)**等路径。

**结束更新 - 2009 年 1 月 21 日：**

我有两个可能的 URL 约定，我需要能够路由到相同的控制器/视图

**[http://team.department.company.com/Action/id](http://team.department.company.com/Action/id)**

**[http://department.company.com/Action/id](http://department.company.com/Action/id)**

**[http://company.com/Action/id](http://company.com/Action/id)**

以上内容很容易处理，因为部门/团队别名位于 Uri 的主机名中。

但是，当我想实现以下内容时，我无法让它令人满意地工作：

**[http://company.com/department/team/Action/id](http://company.com/department/team/Action/id)**

**[http://company.com/department/Action/id](http://company.com/department/Action/id)**

**[http://company.com/Action/id](http://company.com/Action/id)**

以下是我定义的路线：

```
routes.MapRoute("departmentAndTeam1", "{departmentId}/{teamId}/{controller}/{action}/{id}", new { controller = "Home", action = "Index", id = "" });

routes.MapRoute("departmentAndTeam2", "{departmentId}/{teamId}/{controller}/{action}", new { controller = "Home", action = "Index" });

routes.MapRoute("departmentAndTeam3", "{departmentId}/{teamId}/{controller}", new { controller = "Home", action = "Index" });

routes.MapRoute("department", "{department}/{controller}/{action}/{id}", new {controller = "Home", action = "Index", id = ""});

routes.MapRoute("departmentAndTeam4", "{departmentId}/{teamId}/", new { controller = "Home", action = "Index"});

routes.MapRoute("Default", "{controller}/{action}/{id}", new { controller = "Home", action = "Index", id = "" }); 
```

我现在遇到的问题是我的控制器中的每个操作方法都需要一个 departmentId 和 teamId 参数。我真的更希望能够“预处理”我在 OnActionExecuting 事件处理程序中获得的基本控制器类中的部门/团队 ID 值。我在吠叫错误的树吗？我需要实现自己的 Mvc 路由处理程序吗？

注意：这是替换旧版应用程序，需要保留/维护 URL 格式。

**编辑：** 首先，感谢到目前为止的回复。根据我收到的回复，我认为我在某一点上还不够清楚。这是（松散地）我的控制器的样子：

```
public class ControllerBase : Controller
{
    DepartmentDTO department;
    TeamDTO team;
    protected override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        PopulateDept(filterContext.ActionParameters("departmentId");
        PopulateTeam(filterContext.ActionParameters("teamId");
    }
} 
```

但是，使用此方案，所有从此类继承的控制器（并使用上面列出的路由进行适当的路由）在其操作处理程序中都期望（我认为是冗余/不需要的）参数。我想避免让每个处理程序都需要这些“额外”参数并且正在寻找建议。

谢谢！-乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T00:54:44.857

首先，您不需要 departmentAndTeam2 或 departmentAndTeam3。departmentAndTeam1 可以处理它，因为它具有控制器、操作和 id 的默认值。

我注意到的另一件事是，您的示例 URL 都没有在其中指定控制器。在这种情况下，请将其排除在路由之外，并将其保留为默认值。例如

对于网址

[http://company.com/department/team/Action/id](http://company.com/department/team/Action/id)

使用路线

```
routes.MapRoute("departmentAndTeam1", "{departmentId}/{teamId}/{action}/{id}", new { controller = "Home", action = "Index", id = "" }); 
```

请注意“控制器”将始终是“主页”，因为它从未在 URL 中提及。

对于您不想指定部门和团队 ID 的操作和 URL，它们应该只是通过所有其他路由并仅使用默认路由。他们不是这一事实意味着他们被较早的路线之一抓住了。我认为，如果您解决了较早路线的问题，那么它应该可以解决需要额外 ID 的问题。

最后，如果您仍然遇到问题，请尝试使用来自 Phil Haacked [http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)的 MVC 路由调试器。我用它来解决我的一些路线的问题，看看它实际在做什么和运行时真的很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T01:11:43.747

这个怎么样（我没有测试过，因为我不确定除了这 3 个特定的 url 映射之外还有什么要求）？

```
routes.MapRoute("1", "{department}/{team}/{action}/{id}", new { controller = "Home" });
routes.MapRoute("2", "{department}/{action}/{id}", new { controller = "Home" });
routes.MapRoute("3", "{action}/{id}", new { controller = "Home" }); 
```

# mfc - 如何设置 FilterGraph 渲染器的所有者？

> ID：447973
> 
> 赞同：1
> 
> 时间：2009-01-15T18:48:50.883
> 
> 标签：mfc, directshow

我有一个 CView，我想托管一个 DirectShow 渲染器。

我没有写原始代码，我只是清理并将代码移动到VS2005。这需要升级某些第三方工具，所以我试图在不完全了解 DX/DirectShow 的情况下稍微更改代码。

问题是我的应用程序在我运行时挂起

```
hr = gcap.pFg->QueryInterface(IID_IVideoWindow, (void **)&gcap.pVW);
[trimmed some code]
gcap.pVW->put_Owner((OAHWND) m_pDockWnd->GetSafeHwnd());    // We own the window now 
```

m_pDockWnd 是 CView。我可以在预览模式下执行此操作，但不能在捕获模式下执行此操作。在捕获模式下，它会挂起应用程序。

如果我不拥有渲染窗口，则没有问题（尽管捕获窗口归桌面所有，这对我不起作用）。

此外，当捕获窗口归桌面所有时，它会显示一个忙碌的光标 - 可能它实际上也没有工作，但它至少没有挂起应用程序。挂起是指应用程序不响应用户输入，但后台线程继续运行。

**更新**：我们使用的是旧版本的 DirectX（06 年 8 月）。我编译/链接了与 Vista SDK 一起打包的 DirectShow 内容，并且....没有骰子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T16:40:20.637

我有一个解决方案。

视频流从没有消息泵的线程开始，这导致视频窗口变得无响应。（我想 XP 更能容忍这一点，也许 Vista 中的新显示驱动程序模型把它搞砸了。）无论如何，一旦我对主应用程序窗口执行了 SendMessage 并从那里开始视频捕获，一切似乎都正常！

# c# - 插入的 LINQ to SQL 主键要求失败

> ID：447982
> 
> 赞同：1
> 
> 时间：2009-01-15T18:53:28.487
> 
> 标签：c#, linq-to-sql, insert

在用于实际项目之前，我正在努力更好地理解 Linq-to-SQL，所以我在一个小项目中使用它。我有一个表，我试图通过 DataContext.SubmitChanges() 更新它，但由于主键约束而失败。

我无法控制表本身（我无法添加实际的 ID 列），因此我修改了 Linq 实体以使用 3 列作为复杂键。即使关键数据在更新集和表中的现有数据中都是唯一的，插入仍然失败，我很想知道为什么。我错过了什么迫使 Linq 将这些值视为非唯一的？

请注意，我并没有尝试解决更新问题本身 - 我已经确定在我的情况下 DataContext.ExecuteCommand() 也可以正常工作。我试图弄清楚我对 Linq（或我的数据）的理解是错误的。

表结构如下所示： OPRID (char(30)) DATE (DateTime) PROJECT_ID (char(15)) HOURS (decimal)

最后 3 列是复杂键。

这是一些示例数据，逗号分隔：cschlege, 2009-1-5, 10100, 0.8 cschlege, 2009-1-5, 10088, 1.1 cschlege, 2009-1-5, 10099, 0.8 cschlege, 2009-1-5, 10088, 1.2

SubmitChanges() 在这些行的最后一个始终失败，但给定 DATE、PROJECT_ID、HOURS 的键，这些行应该是唯一的。它不会在第 3 行失败，该行在 HOURS 列中有重复，但只有在它到达重复的 PROJECT_ID 时才会失败。但是，如果我从复杂键中删除 PROJECT_ID，则插入在第 3 行失败。

为什么 LINQ 不将这些行视为唯一键控？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T19:18:06.317

鉴于您的解释，我猜想 HOURS（十进制）是问题所在……它必须以不同的精度进行映射。

如果 1.2 舍入到 1，那么您有以下问题：

cschlege, 2009-1-5, 10088, **1** (2)

cschlege, 2009-1-5, 10088, **1** (4)

正如您所说，如果您删除项目 ID，您最终会在第 3 行失败：

cschlege, 2009-1-5, *10100* , **0** (1)

cschlege, 2009-1-5, *10099* , **0** (3)

您可以只插入数据库中的最后一行，然后确认是**1.2**吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T19:09:14.960

啊。答案是我没有足够关注后备商店的规则。有一个不同的索引实际上失败了。

# vb.net - System.Data.OracleClient 需要 Oracle 客户端软件版本 8.1.7

> ID：447983
> 
> 赞同：43
> 
> 时间：2009-01-15T18:54:50.077
> 
> 标签：vb.net, oracle

我有一个使用 Vb.net9 在 Vista 上开发的网站。它与 Oracle 建立连接。对于我使用 System.Data.OracleClient 的连接。它在我的机器和我们的测试服务器上运行良好，但在生产服务器上不起作用。我们在服务器上安装了 Oracle Client 11。错误是 System.Data.OracleClient 需要 Oracle 客户端软件版本 8.1.7

我们已经尝试过，制作一个打开连接的控制台应用程序，连接运行正常，打开，显示一条消息，一切都很好。

然后我们做一个简单的web表单，放到程序的目录下，就一个按钮，打开连接，try..catch，抓取错误，同样的错误。

控制台应用程序在管理员下运行，网站在 iwam 下运行。iwam有可能有不同的路径吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-05-11T23:42:07.550

我已经多次遇到这个错误：

**原因**

在使用 NTFS 的 Windows 上安装 Oracle 客户端时，未正确设置安全权限。这样做的结果是`ORACLE_HOME`目录的内容对机器上的 Authenticated Users 是不可见的；`System.Data.OracleClient`这会在使用 Authenticated User 权限从 ASP.NET 与 Oracle Connectivity 软件进行通信时导致错误。

**解决方案**

要解决此问题，您必须将 Authenticated Users 组权限授予 Oracle 主目录。

*   **以具有管理员**权限的用户身份登录到 Windows 。
*   启动 Windows 资源管理器并导航到该`ORACLE_HOME`文件夹​​。
*   选择`ORACLE_HOME`文件夹的属性。
*   单击“*属性*”窗口的“*安全*”选项卡。
**   单击*名称*列表中的*Authenticated Users*项。**   取消选中*允许列下**权限*列表中的*读取和执行*框。***   重新选中*Allow*列下的*Read and Execute*框。**   单击“*高级*”按钮并在“*权限条目*”中验证已列出的已*验证用户是否具有权限：**读取和执行*，并应用到： *此文件夹、子文件夹和文件*。如果不是，请编辑该行并确保将*Apply To*下拉框设置为*This folder, subfolders and files*。这应该已经正确设置，但验证它很重要。*   单击确定按钮，直到关闭所有安全属性窗口。光标可能会显示沙漏几秒钟，因为它将您刚刚更改的权限应用于所有子文件夹和文件。*   重新启动，以确保更改已生效。*****

 **再次尝试您的应用程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T17:24:10.420

这篇文章的作者（现已删除的文章）建议检查您的`C:\Windows\System32`文件夹以确保该文件夹`oci.dll`存在。从 Oracle 主目录复制文件为我解决了这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T19:32:32.417

**更新 1：**不同的用户可能有不同的路径。但这不是这里可能的问题。iwam用户没有oracle客户端目录权限的用户更有可能。

**更新 0：**它应该可以工作。检查环境变量（查找 oracle 客户端和 tnsnames.ora 所需的变量）。另外，也许您有 32/64 位问题。另外，考虑使用 Oracle Data Provider for .NET（搜索 odp.net）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T12:02:32.023

Oracle 客户端版本 11 无法连接到 8i 数据库。您最多需要一个版本 10 的客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T16:56:14.560

当我们第一次使用 Oracle 10g 迁移到 Vista 时，我们在 Vista 机器上安装 Oracle 客户端时遇到了这个问题，即使我们在安装期间以管理员权限运行也是如此。

Oracle 推出了与 Vista 兼容的 10g 客户端 (10.2.0.3) 的新版本。

我相信这是在 11g 发布之后，所以 11g 也有可能有一个“Vista 兼容”版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T23:23:39.683

为什么不使用这个：[dotConnect for Oracle](http://devart.com/dotconnect/oracle/)（以前称为 OraDirect .NET）？

它可以配置为根本不需要 Oracle 客户端。

我们一直在 Windows 服务和 ASP.NET Web 服务中使用它，它就像一个魅力。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-17T21:56:30.490

对我来说，问题是我的 Visual Studio 中的一些插件开始强制我的应用程序进入 x64 64 位模式，所以没有找到 Oracle 驱动程序，因为我安装了 Oracle 32 位。

因此，如果您遇到此问题，请尝试在安全模式 (devenv /safemode) 下运行 Visual Studio。通过使用 SysInternals/Microsoft 的 ProcMon 应用程序，我可以发现它正在 SYSWOW64 中查找 ic.dll 文件。

更新：对我来说，是 Telerik JustTrace 产品导致了这个问题，它可能会挂接并以某种方式影响运行时版本以进行跟踪。

Update2：不仅仅是 JustTrace 导致问题，JustMock 导致相同的处理器模式问题。不过，JustMock 更容易修复：单击 JustMock-> Disable Profiler，然后我的 Web 应用程序的 oracle 驱动程序在正确的 CPU 模式下运行。Telerik 将来可能会解决这个问题。

# delphi - 文件 MD5 校验和

> ID：447985
> 
> 赞同：4
> 
> 时间：2009-01-15T18:55:27.063
> 
> 标签：delphi, md5, delphi-7

在[这个问题](https://stackoverflow.com/questions/392657/md5-hashing-in-delphi-2009)中提到了 wcrypt2。

我需要的是简单地计算一个文件的 MD5。如果我可以计算它而不必保存它，那将是完美的，因为它是流格式的下载文件。

我想有最直接的方法来做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-10-20T11:28:03.990

这是 Indy 10 的工作代码：

```
function MD5File(const FileName: string): string;
var
  IdMD5: TIdHashMessageDigest5;
  FS: TFileStream;
begin
 IdMD5 := TIdHashMessageDigest5.Create;
 FS := TFileStream.Create(FileName, fmOpenRead or fmShareDenyWrite);
 try
   Result := IdMD5.HashStreamAsHex(FS)
 finally
   FS.Free;
   IdMD5.Free;
 end;
end; 
```

问候，奥斯卡R1

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T14:39:29.227

基于@dummzeuch answere，我编写了这个函数：

```
function getMD5checksum(s: TStream): string;
 var
  md5: TIdHashMessageDigest5;
  hash : T4x4LongWordRecord;
 begin
  md5 := TIdHashMessageDigest5.Create;
  s.Seek(0,0);
  hash := md5.HashValue(s);
  result := IntToHex(Integer(hash[0]), 4) +
            IntToHex(Integer(hash[1]), 4) +
            IntToHex(Integer(hash[2]), 4) +
            IntToHex(Integer(hash[3]), 4);
 end; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T19:42:48.433

Indy 带有计算多个哈希的函数，MD5 就是其中之一。至少从 Delphi 2006 开始，所有版本的 Delphi 都包含 Indy，并且可以免费下载旧版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-27T12:42:58.997

关于什么：

```
function GetFileMD5(const Stream: TStream): String; overload;
var MD5: TIdHashMessageDigest5;
begin
    MD5 := TIdHashMessageDigest5.Create;
    try
       Result := MD5.HashStreamAsHex(Stream);
    finally
       MD5.Free;
    end;
end;

function GetFileMD5(const Filename: String): String; overload;
var FileStream: TFileStream;
begin
    FileStream := TFileStream.Create(FileName, fmOpenRead or fmShareDenyWrite);
    try
      Result := GetFileMD5(FileStream);
    finally
      FileStream.Free;
    end;
end; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T19:43:18.307

正如您所提到的，[您链接到的帖子](https://stackoverflow.com/questions/392657/md5-hashing-in-delphi-2009)谈到了`wcrypt2`，这是一个加密例程库，包括 MD5。您链接到的帖子似乎也表明它适用于 Delphi 7，因为询问者包含标记为“Delphi 7”的输出。你已经标记了这个问题`delphi7`，所以我假设这也是你正在使用的版本。那么是什么阻止你使用`wcrypt2`？

该问题链接到*wcrypt2.pas*的副本，并且该文件中的版权日期似乎表明该单元在 Delphi 7 发布时可用。检查您的安装；你可能已经有了它。如果没有，那么该单位还说它是通过[绝地计划](http://www.delphi-jedi.org/)获得的，因此您也可以尝试在那里寻找该单位。

您引用的问题的答案包括示例 Delphi 代码和 Delphi 附带的用于执行 MD5 的单元名称。它们随 Delphi 2009 一起提供，因此您应该检查它们是否也可用于您的版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T19:48:15.223

看看[这个](http://irsoft.de/web/Delphi-MD5)在 Delphi 中的 MD5SUM 实现。它需要一个字符串作为输入，但我想你可以很容易地让它与流一起工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T21:14:00.497

[MessageDigest_5](https://stackoverflow.com/questions/392657/md5-hashing-in-delphi-2009#392745)也适用于此。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-26T12:12:22.060

我在带有 Indy 10.1.5 的 Delphi 7 中使用以下功能

```
uses IdHashMessageDigest, idHash, Classes;  

...

function cc_MD5File(const p_fileName : string) : string;
//returns MD5 has for a file
var
  v_idmd5 : TIdHashMessageDigest5;
  v_fs : TFileStream;
  v_hash : T4x4LongWordRecord;
begin
  v_idmd5 := TIdHashMessageDigest5.Create;
  v_fs := TFileStream.Create(p_fileName, fmOpenRead OR fmShareDenyWrite) ;
  try
    v_hash := v_idmd5.HashValue(v_fs);
    result := v_idmd5.AsHex(v_hash);
  finally
    v_fs.Free;
    v_idmd5.Free;
  end;
end; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-08-28T23:29:21.200

如果您使用 Overbyte [http://www.overbyte.eu/frame_index.html](http://www.overbyte.eu/frame_index.html)只需添加单元并使用文件名调用函数 FileMD5

```
uses OverbyteIcsMd5;
....
function GetMd5File:String; 
begin
 Result := FileMD5(FileName);
end; 
```

# vb.net - 模态窗口问题

> ID：447989
> 
> 赞同：0
> 
> 时间：2009-01-15T18:56:18.357
> 
> 标签：vb.net, asp.net-2.0, modal-dialog

我正在为我的 VB.NET 程序使用模态窗口，我试图从另一个窗口打开这个子模态窗口，在我关闭子模态窗口后，我试图刷新父级，但我正在重试/取消弹出窗口，我试过了有很多事情要避免，但我无法摆脱这个弹出窗口:-(有什么办法可以避免这个弹出窗口吗？非常感谢你的帮助

谢谢费萨尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T19:11:17.713

您是否尝试将 OnClickClient javascript 函数绑定到关闭模式弹出窗口以手动调用 PostBack 到服务器的按钮？

```
function fnClickOK(sender, e) { 
__doPostBack(sender,e); 
} 
```

这是您必须包含在代码中的功能，您可以像这样在后面的代码中绑定按钮

```
yourButton.OnClientClick = String.Format("fnClickOK('{0}','{1}')", yourButton.UniqueID, ""); 
```

像这样，应该会发生回发，并且由于页面重新加载，所有 Modal 都将被隐藏。

祝你好运！

# sql - SQL 复杂查询出现 ORA-22813 错误

> ID：447995
> 
> 赞同：0
> 
> 时间：2009-01-15T18:59:03.827
> 
> 标签：sql

我有一个很大的`SELECT`语句，其中包含许多嵌套选择。当我运行它时，它给了我一个`ORA-22813`错误：

> Ora-22813:- 来自内部子查询之一的集合值已超出系统限制，因此出现此错误。

我在下面给出了一些`select`返回大量数据的嵌套 s。

---第一个`select`返回的数据最多。

我可以`INNER SELECT`以任何替代方式处理和处理由 s 返回到表中的大量数据，以便不会出现内存更少、排序大小更小的错误。获取，任何其他方式，以便 QUERY 成功处理而不会出错。

```
/*****************************************BEGIN

LEFT OUTER JOIN
     (  SELECT *

        FROM STUDENT_COURSE stu_c 

        LEFT OUTER JOIN STUDENT_history ch on stu_c.course_id = ch.ch_course_id 

        LEFT OUTER JOIN STUDENT_master stu_mca on ch.course_history_id = stu_mca.item_id

      ) stu_c ON stu_c.HISTORY_ID = toa.ACTIVITY_ID               ----->This table is joined earlier

LEFT OUTER JOIN

    (SELECT c_e.EV_ID, c_e.EV_NAME, ma.item_id, ma.cata_id
FROM EVENTS c_e LEFT OUTER  
JOIN COURSE_master ma on c_e.event_Id = ma.item_id ) c_e ON c_e.EVENT_ID = toa.ACTIVITY_ID 
```

在这些选择之后——我们有`GROUP_BY`s 进一步排序。

---我已经检查过，如果我`where rownum <30,<20`在这些`SELECT`s 中添加额外的限制条件，它就可以正常工作。

* * *

完整查询

```
SELECT * FROM (SELECT 
mcat.CATALOG_ITEM_ID,
mcat.CATALOG_ITEM_NAME ,
mcat.DESCRIPTION,
mcat.CATALOG_ITEM_TYPE,
mcat.DELIVERY_METHOD,
XMLElement("TRAINING_PLAN",XMLAttributes( TP.TPLAN_ID as "id" ),
XMLELEMENT("COMPLETE_QUANTITY", TP.COMPLETE_QUANTITY),
XMLELEMENT("COMPLETE_UNIT", TP.COMPLETE_UNIT),
XMLElement("TOTAL_CREDITS", TP.numberOfCredits ),
XMLELEMENT("IS_CREDIT_BASED", TP.IS_CREDIT_BASED),
XMLELEMENT("IS_FOR_CERT", TP.IS_FOR_CERT),
XMLELEMENT("ACCREDIT_ORG_NAME", TP.ACCRED_ORG_NAME),
XMLELEMENT("ACCREDIT_ORG_ID", TP.accredit_org_id ),
XMLElement("OBJECTIVE_LIST", TP.OBJECTIVE_LIST )
).extract('/').getClobVal() AS PLAN_LIST

FROM 
student_master_catalog mcat 
INNER JOIN
(SELECT stu_tp.TPLAN_ID, 
stu_tp.COMPLETE_QUANTITY, 
stu_tp.COMPLETE_UNIT, 
stu_tp.TPLAN_XML_DATA.extract('//numberOfCredits/text()').getStringVal() as numberOfCredits,
stu_tp.IS_CREDIT_BASED, 
stu_tp.IS_FOR_CERT, 
stu_oa.ACCRED_ORG_NAME, 
stu_tp.TPLAN_XML_DATA.extract('//accreditingOrg/text()').getStringVal() as accredit_org_id,

objective_list.OBJECTIVE_LIST
FROM 
student_training_catalog stu_tp 
LEFT OUTER JOIN
stu_accrediting_org stu_oa on stu_tp.TPLAN_XML_DATA.extract('//accreditingOrg/text()').getStringVal() = stu_oa.ACCRED_ORG_ID
INNER JOIN 
(SELECT * 
FROM 
(SELECT 
stu_tpo.TPLAN_ID AS OBJECTIVE_TPLAN_ID, 
XMLAgg(
XMLElement("OBJECTIVE",
XMLElement("OBJECTIVE_ID",stu_tpo.T_OBJECTIVE_ID ),
XMLElement("OBJECTIVE_NAME",stu_to.T_OBJECTIVE_NAME ),
XMLElement("OBJECTIVE_REQUIRED_CREDITS_OR_ACTIVITIES",stu_tpo.REQUIRED_CREDITS ),
XMLElement("ITEM_ORDER", stu_tpo.ITEM_ORDER ),
XMLElement("ACTIVITY_LIST", activity_list.ACTIVITY_LIST )
)
) as OBJECTIVE_LIST 
FROM 
stu_TP_OBJECTIVE stu_tpo
INNER JOIN 
stu_TRAINING_OBJECTIVE stu_to ON stu_tpo.T_OBJECTIVE_ID = stu_to.T_OBJECTIVE_ID
INNER JOIN 
(SELECT * 
FROM 
(SELECT stu_toa.T_OBJECTIVE_ID AS ACTIVITY_TOBJ_ID, XMLAgg(
XMLElement("ACTIVITY",
XMLElement("ACTIVITY_ID",stu_toa.ACTIVITY_ID ),
XMLElement("CATALOG_ID",COALESCE(stu_c.CATALOG_ID, COALESCE( stu_e.CATALOG_ID, stu_t.CATALOG_ID ) ) ),
XMLElement("CATALOG_ITEM_ID",COALESCE(stu_c.CATALOG_ITEM_ID, COALESCE( stu_e.CATALOG_ITEM_ID, stu_t.CATALOG_ITEM_ID ) ) ),
XMLElement("DELIVERY_METHOD",COALESCE(stu_c.DELIVERY_METHOD, COALESCE( stu_e.DELIVERY_METHOD, stu_t.DELIVERY_METHOD ) ) ),
XMLElement("ACTIVITY_NAME",COALESCE(stu_c.COURSE_NAME, COALESCE( stu_e.EVENT_NAME, stu_t.TEST_NAME ) ) ),
XMLElement("ACTIVITY_TYPE",initcap( stu_toa.ACTIVITY_TYPE ) ),
XMLElement("IS_REQUIRED",stu_toa.IS_REQUIRED ),
XMLElement("IS_PREFERRED",stu_toa.IS_PREFERRED ),
XMLElement("NUMBER_OF_CREDITS",stu_lac.CREDIT_HOURS),
XMLElement("ITEM_ORDER", stu_toa.ITEM_ORDER )
)) as ACTIVITY_LIST 
FROM stu_TRAIN_OBJ_ACTIVITY stu_toa
LEFT OUTER JOIN
(
SELECT distinct lac.LEARNING_ACTIVITY_ID, lac.CREDIT_HOURS

FROM student_training_catalog tp
INNER JOIN stu_TP_OBJECTIVE tpo on tp.TPLAN_ID = tpo.TPLAN_ID
INNER JOIN stu_TRAIN_OBJ_ACTIVITY toa on tpo.T_OBJECTIVE_ID = toa.T_OBJECTIVE_ID
INNER JOIN stu_LEARNINGACTIVITY_CREDITS lac on lac.LEARNING_ACTIVITY_ID = toa.ACTIVITY_ID and tp.TPLAN_XML_DATA.extract ('//accreditingOrg/text()').getStringVal() = lac.ACC_ORG_ID
where tp.tplan_id ='*************'
) stu_lac ON stu_lac.LEARNING_ACTIVITY_ID = stu_toa.ACTIVITY_ID ------>This Select returns correct no. of rows 
```

我想将下面的嵌套`SELECT`s 与`stu_toa.ACTIVITY_ID`. 这将解决我的问题。

这下面`SELECT`里面`LEFT OUTER JOIN`是问题。它返回太多，因为 3 个表是直接连接的，没有任何值限定。

```
LEFT OUTER JOIN
( SELECT ch.COURSE_HISTORY_ID, stu_c.COURSE_NAME, mca.catalog_item_id, mca.catalog_id, mca.delivery_method 
FROM stu_COURSE stu_c 
LEFT OUTER JOIN stu_course_history ch on stu_c.course_id = ch.ch_course_id -
--If I can qualify here with ch.ch_course_id = stu_toa.ACTIVITY_ID (stu_toa.ACTIVITY_ID from the above select with correct no. of rows )
--Here, I get errors because I can't access outside values inside a left outer join

LEFT OUTER JOIN student_master_catalog mca on ch.course_history_id = mca.catalog_item_id
) stu_c ON stu_c.COURSE_HISTORY_ID = stu_toa.ACTIVITY_ID

LEFT OUTER JOIN
(SELECT stu_e.EVENT_ID, stu_e.EVENT_NAME, mca.catalog_item_id, mca.catalog_id, mca.delivery_method FROM stu_EVENTS stu_e LEFT OUTER JOIN student_master_catalog mca on stu_e.event_Id = mca.catalog_item_id ) stu_e ON stu_e.EVENT_ID = stu_toa.ACTIVITY_ID
LEFT OUTER JOIN
(SELECT stu_t.TEST_HISTORY_ID, stu_t.TEST_NAME, mca.catalog_item_id, mca.catalog_id, mca.delivery_method FROM stu_TEST_HISTORY stu_t LEFT OUTER JOIN student_master_catalog mca on stu_t.test_history_id = mca.catalog_item_id) stu_t ON stu_t.test_history_id = stu_toa.ACTIVITY_ID
GROUP BY stu_toa.T_OBJECTIVE_ID) ) activity_list ON activity_list.ACTIVITY_TOBJ_ID = stu_tpo.T_OBJECTIVE_ID 
GROUP BY stu_tpo.TPLAN_ID) ) objective_list ON objective_list.OBJECTIVE_TPLAN_ID = stu_tp.TPLAN_ID
)TP ON TP.TPLAN_ID = mcat.CATALOG_ITEM_ID
WHERE 
mcat.CATALOG_ITEM_ID = '*****************' and mcat.CATALOG_ORG_ID = '********') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T17:40:08.143

请发布 DDL、近似大小（相对于彼此）和完整的查询，而不仅仅是摘录。

一些可能会或可能不会解决您的问题的快速点击（为了更好的帮助，我需要更好的信息）-

*   你确定你的意思是OUTER join？将学生外部加入课程意味着不参加任何课程的学生仍然会在附近。这是期望的行为吗？

*   如果您`select *`只想要列的有限子集，请不要这样做。枚举您需要的确切列。其余的可能在逐行的基础上看起来并不多，但是当你乘以你拥有的总行数时，这种事情可能意味着内存排序和溢出到磁盘之间的差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T17:28:41.040

发布表的 DDL 和查询的确切计划。

同时，尝试增加`pga_aggregate_target`，`sort_area_size`并且`hash_area_size`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T19:21:22.207

您正在查看多少行数据？有时，具有编程聚合的单独查询可以更好地工作。对 Oracle 查询优化有更多了解的人可能会提供帮助，此外，调整设置也可以帮助...

我曾经遇到过调用 sproc 的实例，来自多个来源的聚合数据比应用程序中的两次调用花费的时间呈指数增长，并将其放在内存中。*************``********