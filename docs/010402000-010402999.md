# StackOverflow 问答 10402000-10402999

# asp.net - aspnet_compiler 发现错误版本的 System.Web.WebPages 1.0.0.0 而不是 2.0.0.0

> ID：10402005
> 
> 赞同：38
> 
> 时间：2012-05-01T17:58:47.307
> 
> 标签：asp.net, .net, asp.net-mvc-4

我有一个 ASP.NET MVC4 项目，它在 VS2010 中编译得很好。出于部署目的，我运行了一个 Nant 脚本，该脚本尝试使用 aspnet_compiler.exe 预编译网站，但我一直遇到 System.Web.WebPage 的程序集引用问题

> 错误 CS1705：程序集 'System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' 使用 'System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'比引用的程序集'System.Web.WebPages，Version=1.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35'更高的版本

我的 web.config 中还有以下程序集绑定：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
            <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
        </dependentAssembly>
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
            <bindingRedirect oldVersion="0.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
        </dependentAssembly>
        <dependentAssembly>
            <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
            <bindingRedirect oldVersion="0.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
        </dependentAssembly>
        <dependentAssembly>
            <assemblyIdentity name="System.Web.WebPages.Razor" publicKeyToken="31bf3856ad364e35" />
            <bindingRedirect oldVersion="0.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
        </dependentAssembly>
    </assemblyBinding>
</runtime> 
```

我的 csproj 有以下参考：

```
<Reference Include="System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
  <Private>True</Private>
 <HintPath>..\packages\AspNetWebPages.Core.2.0.20126.16343\lib\net40\System.Web.WebPages.dll</HintPath>
</Reference> 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-03T12:08:47.813

我通过显式引用 Web.config 中的 2.0 程序集解决了这个问题。我想由于某种原因，ASP.NET 编译器（在我的情况下运行时`MvcBuildViews`）首先使用旧的 1.0 程序集（如果找到的话）。

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <!-- … -->
  <system.web>
    <!-- … -->
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL" />
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL" />
      </assemblies>
    </compilation>
    <!-- … -->
  </system.web>
  <!-- … -->
</configuration> 
```

顺便说一句：在我添加第 3 方 ASP.NET MVC 3.0 组件后，这个问题似乎第一次出现。该组件通过程序集绑定工作正常，但这可能是 ASP.NET 编译器首先尝试加载 1.0 网页的原因。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-11T09:27:10.440

我们有类似的问题。

我们现在使用 Visual Studio 2012 进行开发，当我们将 2010 项目转换为 2012 并尝试部署它时，ASP.NET 需要 2.0.0.0 而不是 1.0.0.0。

经过一番调查，我发现该项目没有引用特定版本的 System.Web.WebPages，因此在升级到 VS 2012 后，它找到了 2.0.0.0 版本。

如果您从项目中删除引用，然后从 GAC 重新添加特定版本，则它可以正常工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-24T22:30:16.083

`_bin_deployableAssemblies`对我们来说，问题是文件夹中相关 DLL 的旧副本。删除它使我们正确配置了 2.0 版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-10T04:10:29.497

`MvcBuildViews`当设置为 true时，我也会出现此错误。

我注意到在使用“构建解决方案”构建整个解决方案时，我总是会收到此错误。此时，如果我立即自行构建 MVC 项目（右键单击项目然后构建），则 MVC 项目将构建成功。

似乎只要不触发对其依赖项目的构建（即它们是最新的），自行构建 MVC 项目就会成功。但是使用“构建解决方案”构建总是会因为这个错误而失败。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-07-25T11:06:30.347

我在将站点从 MVC 3 升级到 5.2.3.0 时遇到了这个问题。

我的问题是 TFS 没有从 nuget 安装中添加包和关联的 DLL。

我在解决方案的包文件夹中手动添加了以下文件夹。

Microsoft.AspNet.Razor.3.2.3
Microsoft.AspNet.WebPages.3.2.3

Microsoft.Web.Infrastructure.1.0.0.0

一旦提交，构建服务器就不再有问题了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-10T10:59:46.877

当我遇到这个问题时，我挠了挠头。最终，我注意到我的 web.config 的“运行时”部分中有以下部分。

```
<runtime>
 . . .
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
. . .
</runtime> 
```

如您所见，这指的是程序集的版本 2，它与您在 web.config 的 system.web/compilation/assemblies 部分中的以下代码不匹配。

```
<add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

该项目的参考资料中引用的实际程序集确实是 v1.0.0.0，因此我将上面的第一段代码更改为以下代码，从而立即解决了问题。我不确定这个错误最初是如何出现的。

```
<runtime>
 . . .
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-1.0.0.0" newVersion="1.0.0.0" />
      </dependentAssembly>
. . .
</runtime> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-14T14:03:19.693

对我来说，这是对`System.Web.WebPages.Administration v1.0.0.0`谁是罪魁祸首的参考。删除后，所有工作都无需任何 Web.config 调整。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-02T16:46:01.447

在这种情况下，值得对解决方案根文件夹中的所有文件执行*“在文件中查找” 。*

对于上面的示例，我会搜索：`System.Web.WebPages, Version=1.0.0.0`

通过这种方式，您可以摆脱对旧版本的所有引用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-12T06:43:17.547

对我来说，这个问题很可能是通过 Web 平台安装程序购买更新到最新版本的 .NET，但我没有安装最新版本的 ASP.NET MVC。通过 Web 平台安装程序更新此问题修复了问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-02-02T04:33:50.297

只需转到参考并搜索 System.Web.Mvc 4.0 或更高版本并添加它。我只是添加了 System.web.mvc 4.0.0.1 的引用，它可以工作。

不要忘记删除旧的 mvc 版本。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-08T08:00:45.867

删除和重新添加参考 System.Web.Mvc 为我完成了这项工作

# iphone - 在 viewWillDisappear 中释放对象

> ID：10402010
> 
> 赞同：1
> 
> 时间：2012-05-01T17:59:27.400
> 
> 标签：iphone, objective-c, cocoa-touch, memory-management, uiviewcontroller

释放 viewWillDisappear 中的对象是否安全？鉴于这些对象将再次在 viewWillAppear 上重新创建。

所以，这就是我写它的方式。这样做有什么坏处吗？

```
- (void)dealloc {
    [self releaseObjects];
    [super dealloc];
}

- (void)releaseObjects {
    self.request = nil;
    self.loadingOverlay = nil;
    self.textView = nil;
    self.label = nil;
    self.endPoint = nil;
}

- (void)viewWillDisappear:(BOOL)iAnimated {
    [super viewWillDisappear:iAnimated];
    [self releaseObjects];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:03:33.527

通常，您在创建变量的“伴随”函数中释放变量。因此，如果您在 viewWillAppear 中创建它们，那么您在 viewWillDisappear 中释放它们。viewWillLoad、viewWillUnload 中的释放等。

所以是的，这是正常的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:05:33.297

它不应该破坏任何东西，但它可能会浪费......说vc在一个选项卡上并且用户反复在选项卡之间切换。你会做很多额外的 free/alloc 工作。

除非有一些异常消耗资源的东西，否则我会把它留给操作系统让我知道我应该使用为此目的制作的钩子释放内存：didReceiveMemoryWarning、dealloc 等。

# javascript - 在函数之间传递变量

> ID：10402021
> 
> 赞同：1
> 
> 时间：2012-05-01T18:00:32.813
> 
> 标签：javascript, jquery, ajax, json

如果我有两个从 ajax 调用的函数，并且我想将第一个函数返回给另一个函数的变量传递给另一个函数，并且只使用一次

带有 returnResult() 函数 $.each() 的代码波纹管循环和一些 json 数据丢失，就像“labe”中没有文本一样：{}

```
 $.ajax({
          type: "POST",
          url: "WebService.asmx/MyEventData",
          data: "{}",
          dataType: "json",
          contentType: "application/json; charset=utf-8",
          success: function(data) {
          returnResult(data.d);  
         }

      });

       $.ajax({
          type: "POST",
          url: "WebService.asmx/Getlines",
          data: "{}",
          dataType: "json",
          contentType: "application/json; charset=utf-8",
          success: function(data) {
              lineReturn(data.d);
          }

      });

      });

      function lineReturn(result) {
      var jsonObj = [] ; 
      $.each(result, function(index, value) {
         jsonObj.push({ "value": value.dateTime, "color": '#D2691E', "width": 1,    "label": { "text": value.LineEvent} });
      });
      return JSON.stringify(jsonObj) ; << this is the return that should go to myline variable and be used on the highchart >>>> 

  }

      function returnResult(result) {
      console.log(result) ;
      var myLine = lineReturn(result) ;
      var datetemp = new Array ;
      var dateflow = new Array ;
      var datepressure = new Array;
      var datecond = new Array ; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:07:07.883

尝试将第二个 ajax 调用放在第一个回调中。

```
$.ajax({
      type: "POST",
      url: "WebService.asmx/Getlines",
      data: "{}",
      dataType: "json",
      contentType: "application/json; charset=utf-8",
      success: function(dataA) {
           $.ajax({
               type: "POST",
               url: "WebService.asmx/MyEventData",
               data: "{}",
               dataType: "json",
               contentType: "application/json; charset=utf-8",
               success: function(dataB) {
                   // From here you can access both dataA.d and dataB.d
                   var myLineA = lineReturn(dataA.d);
                   var myLineB = lineReturn(dataB.d);
              }
           });
      }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:08:47.230

您可以在第一个功能上启用第二个`.success`功能。

# ruby - 即使我使用捆绑器，我是否必须运行 ruby gem update

> ID：10402025
> 
> 赞同：0
> 
> 时间：2012-05-01T18:00:57.727
> 
> 标签：ruby, gem, bundler

即使我使用捆绑器，我是否必须运行 ruby​​ gem update

显然，确保您拥有最新的 gem 是一种很好的做法，但是如果我使用 bundler，除了通过 gem 更新使 bundler 本身保持最新之外，我还需要麻烦吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:25:25.870

Bundler 仅管理 Gemfile 中指定的应用程序依赖项。如果您只想更新这个宝石，`bundler install`或者`bundle update`对您来说已经足够了。如果您想更新*所有*已安装的 gem 或 bundler 本身 - 使用`gem update`

# jquery - 使用 JQuery 查找和计算复选框的数量

> ID：10402028
> 
> 赞同：3
> 
> 时间：2012-05-01T18:01:05.497
> 
> 标签：jquery, html

我在一个页面上有一个表格，在该表格中，表格中的每一行都会有一个复选框。我需要计算选中行的行数，但我什至无法从 jQuery 中选择它。

这是我的复选框代码的样子：

```
<input type="checkbox" id="onHomePage_56" name="onHomePage" 
    value="56" checked="checked"> 
```

未选中的框没有选中=“选中”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T18:03:02.643

```
var q = $('form#id-of-form').find('input:checked').length; 
```

[http://api.jquery.com/checked-selector/](http://api.jquery.com/checked-selector/)

如果表单中有您不想计算的复选框，则将一个类添加到您想要计算的*那些*中，然后选择它们：

```
var q = $('form#id-of-form').find('input.count-these:checked').length; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T18:02:54.733

jQuery 为此提供了特殊的选择器：

```
$('input:checked').length 
```

进一步来说：

```
var num = $('#myform input:checkbox:checked').length; 
```

我添加了 jQuery`:checkbox`选择器，因为`:checked`它也适用于单选按钮。从技术上讲，`:checkbox`它比`[type=checkbox]`现代浏览器慢，但它们做同样的事情：

```
var num = $('#myform input[type=checkbox]:checked').length; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T18:08:50.377

你可以试试这个：

```
$('#form input:checkbox:checked').length; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-01T18:10:55.303

```
$('#myForm table tr td input:checked')​.size();​ 
```

[**演示。**](http://jsfiddle.net/heera/TT8zh/1/)

**更新：**更好地过滤`type`，因为您也可以检查单选按钮

```
$('#myForm table tr td input[type="checkbox"]:checked').size(); 
```

[**带有选中单选按钮的演示**](http://jsfiddle.net/heera/TT8zh/2/)

# entity-framework - EF 对象与泛型类型的比较

> ID：10402029
> 
> 赞同：4
> 
> 时间：2012-05-01T18:01:31.697
> 
> 标签：entity-framework, generics, types, comparison

我有以下问题：我有一个使用为 Int 或 Guid 实体键设计的 DbContext 的通用 EF 存储库，所以我有一个基实体类：

```
public class EntityBase<TKey> where TKey : struct, IComparable
{
    public virtual TKey Id { get; set; }
} 
```

*   TKey 将在派生类中作为 Int 或 Guid 提供。

当我运行代码时

```
public virtual void LoadEntity()
{
    TEntity entity = Repository.Get<TEntity, TKey>(e => object.Equals(e.Id, EntityId));
} 
```

或者

```
public virtual void LoadEntity()
{
    TEntity entity = Repository.Get<TEntity, TKey>(e => e.Id.CompareTo(EntityId) == 0);
} 
```

其中 Entity 是 TKey 类型，并且在派生类中设置为 int，例如，我收到以下错误：

*无法将类型“System.Int32”转换为类型“System.Object”。LINQ to Entities 仅支持转换实体数据模型原语类型*。

Repository.Get 只需将谓词参数作为过滤器传递给 DbSet 存储库的 Where 调用；

我理解错误 - EF 尝试转换为 SQL 语句并且不知道如何处理对象比较。但我不知道如何重写基类和/或 LoadEntity() 函数以允许 EF 使用原始类型进行操作。有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-03T00:10:29.810

我认为有一个简单的方法可以解决它，但它是一个**hack**。让我再次强调一下——它确实是一个**hack**。你可以试试这个：

```
Repository.Get<TEntity, TKey>(e => (object)e.Id == (object)EntityId); 
```

上面的代码通常不应该工作。在 CLR 世界中，这些值将被装箱并通过引用进行比较。即使装箱的值相同，引用也会不同，因此结果将是错误的。但是 EF 查询不由 CLR 执行，而是转换为 SQL。结果，查询将被翻译为：`WHERE Id = {EntityId}`这是您需要的。同样，使用它需要了解这些东西的工作原理和原因，并且可能有点冒险。但是，由于存在 hack，因此应该有更清洁的解决方案。事实上，干净的（这里不是简单的解决方案）是手动构建上述表达式。这是一个示例（对不起，我没有完全使用您的实体）：

```
 private static TEntity GetEntity<TEntity, TKey>(Expression<Func<TEntity, TKey>> property, TKey keyValue)
        where TKey : struct
        where TEntity : BaseEntity<TKey>
    {
        using (var ctx = new Context2())
        {
            var query = Filter(ctx.Set<TEntity>(), property, keyValue);
            return query.First();
        }
    }

    private static IQueryable<TEntity> Filter<TEntity, TProperty>(IQueryable<TEntity> dbSet,
                                                                  Expression<Func<TEntity, TProperty>> property,
                                                                  TProperty value)
        where TProperty : struct
    {

        var memberExpression = property.Body as MemberExpression;
        if (memberExpression == null || !(memberExpression.Member is PropertyInfo))
        {
            throw new ArgumentException("Property expected", "property");
        }

        Expression left = property.Body;
        Expression right = Expression.Constant(value, typeof (TProperty));

        Expression searchExpression = Expression.Equal(left, right);
        var lambda = Expression.Lambda<Func<TEntity, bool>>(Expression.Equal(left, right),
                                                            new ParameterExpression[] {property.Parameters.Single()});

        return dbSet.Where(lambda);
    } 
```

请注意，在 Filter 方法中，我构建了一个可以编写的过滤器表达式。在这个例子中，有效的查询看起来像这样 DbSet().Where(e => e.Id == idValue).First() （看起来类似于上面的 hack）但是你可以在这个查询之上使用其他 linq 运算符（包括在Filter方法的结果上调用Filter方法来按多个条件过滤）

我将实体和上下文定义如下：

```
public class BaseEntity<TKey> where TKey : struct
{
    public TKey Id { get; set; }
}

public class EntityWithIntKey : BaseEntity<int>
{
    public string Name { get; set; }
}

public class EntityWithGuidKey : BaseEntity<Guid>
{
    public string Name { get; set; }
}

public class Context2 : DbContext
{
    public DbSet<EntityWithIntKey> EntitiesWithIntKey { get; set; }

    public DbSet<EntityWithGuidKey> EntitiesWithGuidKey { get; set; }
} 
```

您可以像这样调用 GetEntity 方法：`var e2 = GetEntity(e => e.Id, guidKey);`

# java - Swing 中 TableLayoutPanel 的模拟

> ID：10402030
> 
> 赞同：2
> 
> 时间：2012-05-01T18:01:37.493
> 
> 标签：java, swing, user-interface

在 .NET 中，如果我想创建侧面有两个面板的窗口，我可以在窗口上添加[TableLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)，并指定三列：固定大小、自动大小和再次固定大小。**在调整窗口大小的情况下，**两个面板都将保存它们的大小。

 **我怎样才能用 Swing 做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T18:10:53.290

看起来一个简单的`BorderLayout`就可以了。它最多允许指定 5 个面板（PAGE_START、PAGE_END、LINE_START、CENTER、LINE_END），但您只需要最后 3 个面板。所有额外的可用尺寸都位于中心区域，这意味着您的侧面板的尺寸保持不变。

仅供参考：如果您正在寻找具有某些属性的布局管理器，那么[布局管理器的视觉指南](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)始终是一个很好的起点`LayoutManager`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T18:04:57.460

有一个名为 Mig-Layout ( [http://www.miglayout.com/](http://www.miglayout.com/) ) 的库可以做到这一点。您可能也可以使用内部布局来做到这一点，但实际上我总是使用 Mig-Layout，即使库非常大。**

# php - mysql查询未插入数据库

> ID：10402034
> 
> 赞同：-1
> 
> 时间：2012-05-01T18:02:19.083
> 
> 标签：php, mysql

我正在构建一个简单的表单来让用户请求供应，但在提交时它一直给我一个通用错误。我看不出我的错误在哪里...

```
 CREATE TABLE `teacherrequests` (
  `name` varchar(64) NOT NULL,
  `binder` varchar(3) NOT NULL,
  `binderpage` varchar(2) NOT NULL,
  `binderdiv` varchar(2) NOT NULL,
  `calcr` varchar(2) NOT NULL,
  `chalkcolor` varchar(2) NOT NULL,
  `chalkwhite` varchar(2) NOT NULL,
  `chalkeraser` varchar(2) NOT NULL,
  `colpencil` varchar(2) NOT NULL,
  `dryerasecleaner` varchar(2) NOT NULL,
  `dryeraser` varchar(2) NOT NULL,
  `dryerasemarkers` varchar(2) NOT NULL,
  `filefolders` varchar(2) NOT NULL,
  `gluesticks` varchar(2) NOT NULL,
  `hangingfile` varchar(2) NOT NULL,
  `highlightermulti` varchar(2) NOT NULL,
  `highlighterone` varchar(2) NOT NULL,
  `holepunch3` varchar(2) NOT NULL,
  `holepunch1` varchar(2) NOT NULL,
  `index35` varchar(2) NOT NULL,
  `index57` varchar(2) NOT NULL,
  `markers` varchar(2) NOT NULL,
  `papergraph` varchar(2) NOT NULL,
  `paperlegal` varchar(2) NOT NULL,
  `papersteno` varchar(2) NOT NULL,
  `paperwhitelined` varchar(2) NOT NULL,
  `paperclipsbindlg` varchar(2) NOT NULL,
  `paperclipsbindmd` varchar(2) NOT NULL,
  `paperclipsbindsm` varchar(2) NOT NULL,
  `paperclipslg` varchar(2) NOT NULL,
  `paperclipsmd` varchar(2) NOT NULL,
  `paperclipssm` varchar(2) NOT NULL,
  `pencil` varchar(2) NOT NULL,
  `pencilsharp` varchar(2) NOT NULL,
  `pensblack` varchar(2) NOT NULL,
  `pensblue` varchar(2) NOT NULL,
  `pensgreen` varchar(2) NOT NULL,
  `pensred` varchar(2) NOT NULL,
  `permanentmarker` varchar(2) NOT NULL,
  `postit` varchar(2) NOT NULL,
  `postitsmall` varchar(2) NOT NULL,
  `stapler` varchar(2) NOT NULL,
  `staples` varchar(2) NOT NULL,
  `tapedbl` varchar(2) NOT NULL,
  `tapemasking` varchar(2) NOT NULL,
  `tapescotch` varchar(2) NOT NULL,
  `tapedispenser` varchar(2) NOT NULL,
  `tacks` varchar(2) NOT NULL,
  `clock` varchar(2) NOT NULL,
  `whiteout` varchar(2) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

这是代码...

我已经对照我的表格检查了这些，它们都匹配。

```
$name = $_POST['name'];
$binder = $_POST['binder'];
$binderpage = $_POST['binderpage'];
$binderdiv = $_POST['binderdiv'];
$calc = $_POST['calc'];
$chalkcolor = $_POST['chalkcolor'];
$chalkwhite = $_POST['chalkwhite'];
$chalkeraser = $_POST['chalkeraser'];
$colpencil = $_POST['colpencil'];
$dryerasecleaner = $_POST['dryerasecleaner'];
$dryeraser = $_POST['dryeraser'];
$dryerasemarkers = $_POST['dryerasemarkers'];
$filefolders = $_POST['filefolders'];
$gluesticks = $_POST['gluesticks'];
$hangingfile = $_POST['hangingfile'];
$highlightermulti = $_POST['highlightermulti'];
$highlighterone = $_POST['highlighterone'];
$holepunch3 = $_POST['holepunch3'];
$holepunch1 = $_POST['holepunch1'];
$index35 = $_POST['index35'];
$index57 = $_POST['index57'];
$markers = $_POST['markers'];
$papergraph = $_POST['papergraph'];
$paperlegal = $_POST['paperlegal'];
$papersteno = $_POST['papersteno'];
$paperwhitelined = $_POST['paperwhitelined'];
$paperclipsbindlg = $_POST['paperclipsbindlg'];
$paperclipsbindmd = $_POST['paperclipsbindmd'];
$paperclipsbindsm = $_POST['paperclipsbindsm'];
$pencil = $_POST['pencil'];
$pencilsharp = $_POST['pencilsharp'];
$pensblack = $_POST['pensblack'];
$pensblue = $_POST['pensblue'];
$pensgreen = $_POST['pensgreen'];
$pensred = $_POST['pensred'];
$permanentmarker = $_POST['permanentmarker'];
$postit = $_POST['postit'];
$postitsmall = $_POST['postitsmall'];
$stapleremover = $_POST['stapleremover'];
$stapler = $_POST['stapler'];
$staples = $_POST['staples'];
$tapedbl = $_POST['tapedbl'];
$tapemasking = $_POST['tapemasking'];
$tapescotch = $_POST['tapescotch'];
$tapedispenser = $_POST['tapedispenser'];
$tacks = $_POST['tacks'];
$clock = $_POST['clock'];
$whiteout = $_POST['whiteout']; 
```

我假设我的错误在这里，但我似乎找不到它。

```
// Insert data into mysql 

$sql="INSERT INTO teacherrequests(name, binder, binderpage, binderdiv, calcr, 
chalkcolor, chalkwhite, chalkeraser, colpencil, dryerasecleaner, dryeraser,     
dryerasemarkers, filefolders, gluesticks, hangingfile, highlightermulti, highlighterone,     
holepunch3, holepunch1, index35, index57, markers, papergraph, paperlegal, papersteno,     
paperwhitelined, paperclipsbindlg, paperclipsbindmd, paperclipsbindsm, pencil,     
pencilsharp, pensblack, pensblue, pensgreen, pensred, permanentmarker, postit,     
postitsmall, stapleremover, stapler, staples, tapedbl, tapemasking, tapescotch,     
tapedispenser, tacks, clock, whiteout)

VALUES('$name', '$binder', '$binderpage',     
'$binderdiv', '$calc', '$chalkcolor', '$chalkwhite', '$chalkeraser', '$colpencil',     
'$dryerasecleaner', '$dryeraser', '$dryerasemarkers', '$filefolders', '$gluesticks',     
'$hangingfile', '$highlightermulti', '$highlighterone', '$holepunch3', '$holepunch1',     
'$index35', '$index57', '$markers', '$papergraph', '$paperlegal', '$papersteno',     
'$paperwhitelined', '$paperclipsbindlg', '$paperclipsbindmd', '$paperclipsbindsm',     
'$pencil', '$pencilsharp', '$pensblack', '$pensblue', '$pensgreen', '$pensred',     
'$permanentmarker', '$postit', '$postitsmall', '$stapleremover', '$stapler', '$staples',     
'$tapedbl', '$tapemasking', '$tapescotch', '$tapedispenser', '$tacks', '$clock',    
'$whiteout')";

$result=mysql_query($sql); 
```

这是 var_dump：

```
ERRORstring(811) "INSERT INTO teacherrequests(name, binder, binderpage, binderdiv, calcr, chalkcolor, chalkwhite, chalkeraser, colpencil, dryerasecleaner, dryeraser, dryerasemarkers, filefolders, gluesticks, hangingfile, highlightermulti, highlighterone, holepunch3, holepunch1, index35, index57, markers, papergraph, paperlegal, papersteno, paperwhitelined, paperclipsbindlg, paperclipsbindmd, paperclipsbindsm, pencil, pencilsharp, pensblack, pensblue, pensgreen, pensred, permanentmarker, postit, postitsmall, stapleremover, stapler, staples, tapedbl, tapemasking, tapescotch, tapedispenser, tacks, clock, whiteout)VALUES('Joe Spano', '3', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '4', '', '', '', '', '', '2', '', '', '', '', '', '', '', '', '', '5', '', '', '', '', '', '', '', '')" 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T18:31:05.830

你应该做的第一件事就是把这个数据库设计扔进垃圾桶。然后用这个设计替换它：

```
CREATE TABLE teachingmaterials (
    id SMALLINT NOT NULL AUTO_INCREMENT,
    name VARCHAR(64) NOT NULL,
    PRIMARY KEY (id)
) ENGINE=INNODB CHARACTER SET utf8;

INSERT INTO
    teachingmaterials
    (name)
VALUES
    ('binder'),
    ('binder-page'),
    ('binder-div'),
    -- put the rest of them in here --
    ('whiteout');

CREATE TABLE teacherrequests (
    id INT NOT NULL AUTO_INCREMENT,
    name VARCHAR(64) NOT NULL,
    PRIMARY KEY (id)
) ENGINE=INNODB CHARACTER SET utf8;

CREATE TABLE teacherrequests_teachingmaterials (
    teacherrequests_id INT NOT NULL,
    teachingmaterials_id SMALLINT NOT NULL,
    amount SMALLINT,
    note VARCHAR(64),
    PRIMARY KEY (teacherrequests_id, teachingmaterials_id)
    FOREIGN KEY (teacherrequests_id) REFERENCES teacherrequests (id) ON DELETE CASCADE,
    FOREIGN KEY (teachingmaterials_id) REFERENCES teachingmaterials (id)
) ENGINE=INNODB CHARACTER SET utf8; 
```

您还需要停止使用旧`mysql_*`功能并改用 PDO。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-01T18:13:39.463

看一眼

```
 `calcr` varchar(2) NOT NULL, 
```

在您的创建表代码上与

```
$calc = $_POST['calc']; 
```

在你的 php 代码中。我猜这只是一个简单的错字，最后多了一个“r”。

我还发现这些代码行在另一个文件中没有附带的行：

```
 `paperclipslg` varchar(2) NOT NULL,
  `paperclipsmd` varchar(2) NOT NULL,
  `paperclipssm` varchar(2) NOT NULL,

  $stapleremover = $_POST['stapleremover']; 
```

希望有帮助！

**[编辑]**不过，我没有看到您的插入内容和您的值之间有任何差异。所以现在我看多了，我不认为我已经帮助解决了这个问题。我只找到了一些您可能丢失的数据。

# android - 这段代码中是否正确使用了同步？

> ID：10402041
> 
> 赞同：0
> 
> 时间：2012-05-01T18:02:59.993
> 
> 标签：android, android-asynctask, synchronized

我想知道我是否正确理解如何使用**同步**我会写下一些**伪代码**，它模仿我正在尝试做的事情。

```
public MyApp extends Application {

    public Object mLock = new Object();

    private final ArrayList<String> MyList = new ArrayList<String>();

    public ArrayList<String> getMyList(){
        return MyList;
    }
}

private class MyTask extends AsyncTask<String, Void, Void> {
    @Override
    protected Void doInBackground(String... url) {
        final ArrayList<String> BgList = MyApp.getMyList();
        synchronized (mLock) {
            while(somefinishcondition) {
                try {
                    // Get some stuff from the web
                    BgList.add(newstuff);
                    mLock.notifyAll();
                }
                catch (IOException e) {
                }
            }
        }
        return null;
    }
}

public class DisplayActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.viewer);

        final ArrayList<String> FgList = MyApp.getMyList();

        synchronized (mLock) {
            while(somecondition) {
                mLock.wait();
                if(FgList.size()>lastSize) {
                    n = FgList.size();
                    for(i=lastSize+1; i<=n ; i++){
                        Display(Fglist.get(i));
                    }
                    lastSize = n;
                }
            }
        }
} 
```

这是**我认为**我正在做的事情：我正在后台运行数据收集任务，将数据放入全局列表中。每次我有新数据时，我都会通知 DisplayActivity，它会显示自上次以来的所有新数据。AsyncTask 锁定数据，直到新数据到达。DisplayActivity 等待锁定，直到通知继续并显示。这是正确的吗？这是通常的方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:31:29.783

不，这样你可以阻塞 UI 线程`onCreate`，你会得到 Application Not Responding 错误。

相反，每当您有一些新数据时，请收集数据`doInBackground()`然后调用`updateProgress()`. `doInBackground()`这将导致`AsyncTask.onProgress()`来自 UI 线程的调用。用`onProgress()`新数据做任何你需要的事情。

# asp.net-mvc-3 - knockout.js在选择列表没有选项时不起作用

> ID：10402042
> 
> 赞同：1
> 
> 时间：2012-05-01T18:03:01.267
> 
> 标签：asp.net-mvc-3, drop-down-menu, knockout.js

我想我在与 asp.net mvc 下拉列表结合使用的 knockout.js 中发现了一个错误。当仅提供字符串列表时，MVC 不会在选择元素上呈现选项值。因此，Knockout.js 不会更新该值。如果我通过明确告诉它属性来使用下面的第二个 html 片段，它可以工作。如果选项值不可用，knockout.js 不应该读取内部 html 吗？

**不更新**

```
@Html.DropDownListFor(m => m.Grade, new SelectList((IEnumerable<string>)ViewData[Config.ViewData.Grades], Model.Grade), new { data_bind = "value: selectedGrade" }) 
```

**更新**

```
@Html.DropDownListFor(m => m.Grade, new SelectList(((IEnumerable<string>)ViewData[Config.ViewData.Grades]).Select(q => new { Text = q, Value = q }), "Value", "Text", Model.Grade), new { data_bind = "value: selectedGrade" }) 
```

**第一个下拉菜单呈现**

```
<select>
<option>K</option>
<option>2</option>
<option>3</option>
</option> 
```

**第二个下拉列表呈现**

```
<select>
<option value="K">K</option>
<option value="2">2</option>
<option value="3">3</option>
</option> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:20:20.107

我会称之为错误。请在 Github 上打开一个问题：[https ://github.com/SteveSanderson/knockout/issues](https://github.com/SteveSanderson/knockout/issues)

# php - 如何将提交的文本区域与数据库进行比较？

> ID：10402046
> 
> 赞同：0
> 
> 时间：2012-05-01T18:03:09.643
> 
> 标签：php, mysql, forms, submit, compare

基本上我有一个允许提交文章的知识库。我试图弄清楚如何将文章提交的文本区域与 MySQL 数据库中的现有数据进行比较。例如，如果有人提交了 300 行的提交，是否可以将该提交与之前的提交进行比较，以了解是否有类似的提交？

我正在使用 php 5.3.6 和 MySQL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:28:18.937

我会给你的答案是基于你在这个问题上付出的表面上的努力。

您需要有 $_POST 提交，然后从数据库中提取存储的提交。然后你需要弄清楚你真正需要发生什么。您可以比较这两个字符串，以某种方式，将它们转换为一个空格/逗号/句点分隔的单词列表，您可以相互比较，并在您确定它“相似”之前决定需要什么级别的匹配以做出进一步的选择它。

或者，您可以将所述 $_POST 提交放在一个文本文件中，其中包含对具有足够匹配项的各种提交的引用以保证手动检查。

# xcode - 如何构建应用程序以将可执行文件放在桌面上

> ID：10402047
> 
> 赞同：0
> 
> 时间：2012-05-01T18:03:25.197
> 
> 标签：xcode

我创建了一个应用程序，它在“我的 Mac 64 位”上运行。现在我想把可执行文件放在我的 Mac 桌面上。它在哪里，我该怎么做？哦，我可以将可执行文件放在闪存驱动器上并放在其他人的 Mac 上吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T18:08:29.757

我假设您正在 Xcode 中构建。

打开您的项目，从产品菜单中选择“存档”。然后打开管理器，转到存档，选择您的程序，然后单击“共享”。

就是这样！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T23:33:26.027

您可以上下文（右键或控制）单击导航视图中的构建产品，然后选择“在 Finder 中显示”菜单项以打开构建产品的文件夹（在 Finder 中）。请注意，调试版本通常只会在它们被构建的地方运行……但发布版本可以移动或复制到任何地方……</p>

# java - 是否有一个通用的 Java 库可以处理字符串集合的 URL 编码/解码？

> ID：10402048
> 
> 赞同：7
> 
> 时间：2012-05-01T18:03:29.633
> 
> 标签：java, urlencode, urldecode

我经常需要对大型字符串集合或数组进行 url 编码或解码。除了遍历它们并使用静态 URLDecoder.decode(string, "UTF-8") 之外，是否有任何库可以使这种类型的操作更高效？

一位同事坚持认为，使用静态方法就地解码字符串不是线程安全的。为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T18:13:28.953

JDK URLDecoder 没有有效地实现。最值得注意的是，它在内部依赖于 StringBuffer（这在 URLDecoder 的情况下不必要地引入了同步）。Apache commons 提供[URLCodec](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/net/URLCodec.html)，但据报道它在性能方面也存在类似问题，但我还没有证实在最新版本中仍然存在这种情况。

[Mark A. Ziesemer 不久前](https://stackoverflow.com/users/751158/ziesemer)写了一篇关于 URLDecoder 的问题和性能的文章。他记录了一些错误报告并最终编写了一个完整的替代品。因为是这样，所以我会在这里引用一些关键摘录，但你应该在这里阅读整个源文章：http: [//blogger.ziesemer.com/2009/05/improving-url-coder-performance-java.html](http://blogger.ziesemer.com/2009/05/improving-url-coder-performance-java.html)

精选报价：

> Java 在 java.net.URLEncoder 和 java.net.URLDecoder 中提供了此功能的默认实现。不幸的是，由于 API 的编写方式以及实现中的细节，它并不是性能最好的。sun.com 上已提交了许多与 URLEncoder 相关的性能相关错误。
> 
> 还有一个替代方案：来自 Apache Commons Codec 的 org.apache.commons.codec.net.URLCodec。（Commons Codec 还为 Base64 编码提供了一个有用的实现。）不幸的是，Commons 的 URLCodec 与 Java 的 URLEncoder/URLDecoder 存在一些相同的问题。

...

> 对 JDK 和 Commons 的建议：
> 
> 在构造任何“缓冲区”类时，例如 ByteArrayOutputStream、CharArrayWriter、StringBuilder 或 StringBuffer，估计并传入估计的容量。JDK 的 URLEncoder 当前为其 StringBuffer 执行此操作，但也应为其 CharArrayWriter 实例执行此操作。Common 的 URLCodec 应该为其 ByteArrayOutputStream 实例执行此操作。如果类的默认缓冲区大小太小，它们可能必须通过复制到新的、更大的缓冲区来调整大小——这并不是一个“便宜”的操作。如果类的默认缓冲区大小太大，可能会不必要地浪费内存。
> 
> 两种实现都依赖于字符集，但只接受它们作为它们的字符串名称。Charset 为名称查找提供了一个简单而小型的缓存 - 仅存储最后使用的 2 个字符集。不应依赖这一点，并且出于其他互操作性原因，两者都应该接受 Charset 实例。
> 
> 两种实现都只处理固定大小的输入和输出。JDK 的 URLEncoder 仅适用于 String 实例。Commons 的 URLCodec 也基于字符串，但也适用于 byte[] 数组。这是一个设计级别的约束，它本质上阻止了对较大或可变长度输入的有效处理。相反，应该支持“支持流”的接口，例如 CharSequence、Appendable 和 java.nio 的 ByteBuffer 和 CharBuffer 的 Buffer 实现。

...

> 请注意，com.ziesemer.utils.urlCodec 的速度是 JDK URLEncoder 的 3 倍以上，是 JDK URLDecoder 的 1.5 倍以上。（JDK 的 URLDecoder 比 URLEncoder 快，因此没有太大的改进空间。）

我认为您的同事建议 URLDecode 不是线程安全的是错误的。这里的其他答案详细解释。

**编辑 [2012-07-03] - 根据 OP 稍后发表的评论**

不确定您是否在寻找更多想法？您是正确的，如果您打算将列表作为原子集合进行操作，那么您将必须同步对列表的所有访问，包括您的方法之外的引用。但是，如果您对可能与原始列表不同的返回列表内容感到满意，那么对集合中可能被其他线程修改的“批量”字符串进行操作的蛮力方法可能如下所示：

```
/**
 * @param origList will be copied by this method so that origList can continue
 *                 to be read/write by other threads. 
 * @return list containing  decoded strings for each entry that was 
           in origList at time of copy.
 */
public List<String> decodeListOfStringSafely(List<String> origList)
        throws UnsupportedEncodingException {
    List<String> snapshotList = new ArrayList<String>(origList);
    List<String> newList  = new ArrayList<String>(); 

    for (String urlStr : snapshotList) {
      String decodedUrlStr  = URLDecoder.decode(urlStr, "UTF8");
          newList.add(decodedUrlStr);
    }

    return newList;
} 
```

如果这没有帮助，那么我仍然不确定你在追求什么，你会更好地创建一个新的、更简洁的问题。如果这是您要问的问题，那么请小心，因为出于多种原因，此示例脱离上下文并不是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:10:12.043

静态函数实际上从来没有真正需要线程安全（或者它是设计失败）。如果甚至不访问类中的静态变量，则尤其如此。

我建议使用您之前使用的函数，并遍历集合

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T18:06:02.170

Apache 有[URLCodec](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/net/URLCodec.html)可用于编码解码。

如果您的静态方法仅适用于局部变量或最终初始化变量，那么它是完全线程安全的。

由于参数存在于堆栈上并且它们是完全线程安全的，因此最终常量是不可变的，因此无法更改。

以下代码是完全线程安全的：

```
public static String encodeMyValue(String value){
  // do encoding here
} 
```

如果最终变量是可变的，则应小心，这意味着您无法重新分配它，但您可以更改其内部表示（属性）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T18:28:01.250

基本上没有应用于静态方法或实例方法或构造函数的神奇线程安全。除非应用同步，否则它们都可以同时在多个线程上调用。如果他们不获取或更改任何共享数据，他们通常是安全的 - 如果他们确实访问共享数据，您需要更加小心。

因此，在您的情况下，您可以在此 urldecoding 或 encoding 之上编写同步方法，您可以通过该方法在外部强制执行线程安全。

# twitter-bootstrap - 使用 Bootstrap 和 LESS 的垂直渐变

> ID：10402052
> 
> 赞同：3
> 
> 时间：2012-05-01T18:03:54.243
> 
> 标签：twitter-bootstrap, less

我对 CSS、Bootstrap 和 LESS 很陌生。我查看了 Bootstrap 网站，发现我应该能够使用 LESS mixin 创建垂直渐变：

```
#gradient > .vertical(); 
```

我想在我的 css.scss 文件的页脚 {} 部分执行此操作。我不知道如何编码。我的猜测是我需要在括号内添加上面的语句和开始和结束颜色。我见过的唯一例子就是 mixin。这是否需要包含在背景图像子句或类似的东西中？我不断收到语法错误。

我敢肯定这可能是一个简单的问题，但我缺乏 CSS 知识。但是，我正在通过反复试验一分钟一分钟地学习。任何帮助，将不胜感激。

2012 年 5 月 2 日上午 7:15 更新：

这是我想将垂直渐变添加到的页脚的 CSS 代码：

```
footer {
  margin-top: 45px;
  padding-top: 5px;
  border-top: 1px solid $grayMediumLight;
  color: #000000;
  font-size: 10px;
  font-family: Arial; 
  font-style: italic;
  #gradient > .vertical(@white, @grayDarker);
  } 
```

我在 Rails 3.2.3 应用程序中使用它。我想用于垂直渐变的颜色是 start `#ffffff`stop `#191919`。我决定尝试预定义变量而不是十六进制值。我也尝试更改`@`为`$`. 我不断收到以下错误。

```
Invalid CSS after "...ent > .vertical": expected "{", was "(@white, @grayD..."
  (in /Users/server1/Sites/iktusnetlive_RoR/app/assets/stylesheets/custom.css.scss). 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T22:31:50.690

您的问题不在于 Bootstrap 的梯度混合。您在 .scss 文件中编写 LESS 代码，该文件是一个 SASS 文件，Rails 将尝试使用 SASS 编译器对其进行编译。

LESS 和 SASS 是相似的，但有一些语法和功能差异。如果您想将 Bootstrap 和 LESS 与 rails 3.1 资产管道一起使用，您需要创建一个带有 .less 扩展名的新文件，并配置您的 rails 资产管道以使用更少的编译器编译更少的文件。

It should be as easy as adding a couple of gems to you gem file and bundle install to get those gems, but I recommend watching ["twitter-bootstrap-basics"](http://railscasts.com/episodes/328-twitter-bootstrap-basics) episode of Railscasts to get all the details.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T07:53:56.193

I was getting the same error. I wasn't importing the Bootstrap LESS file that defines #gradient. Solved the problem by adding `@import 'mixins.less'` to the top of my LESS file.

# ruby-on-rails - 为什么 Rails 验证未更改的属性？

> ID：10402057
> 
> 赞同：6
> 
> 时间：2012-05-01T18:04:24.290
> 
> 标签：ruby-on-rails, validation

即使 some_field 属性没有更改（如果其他字段已更改）， validates_uniqueness_of :some_field 似乎也会在“保存”时运行。这似乎很浪费，因为每个 validates_uniqueness_of 都需要一个数据库调用。我知道我可以将 Proc 传递给 validates_uniqueness_of 以检查 some_field 是否已更改，并且我正在考虑通过所有验证并尽可能地执行此操作。我想知道的是：

1) 这就是对性能感兴趣的人通常对他们的验证所做的事情吗？

2）为什么不是validates_uniqueness_of的默认行为先检查属性是否发生变化？

3) 是否有充分的理由对未更改的属性进行此类验证？

我正在使用 Rails 2.3（目前——我们正在努力升级）。我不知道这与 Rails 3 中的情况相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T21:01:49.477

如果有人直接更改数据库中的值怎么办？

如果其他一些（非 Rails 应用程序）应用程序也访问数据库怎么办？

在上述所有场景中，您仍然希望您的数据有效，以便您的 Rails 应用程序按预期运行。如果数据被篡改（被其他应用程序或直接在数据库中），您的 rails 应用程序会抛出错误，因为它不期望该数据。

话虽如此，这是默认行为。默认行为通常更具限制性，以保持数据有效性并最大限度地减少错误、遗漏和偶然失误的范围。如果您担心您的情况下的性能，也许您的对象更新非常频繁，并且您对一个不经常更新的字段进行了冗长的自定义验证，并且您不想每个都运行该验证时间，那么按照您在问题中描述的那样自定义默认行为是非常有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T23:19:18.133

我刚刚在 Rails 3.0 应用程序中遇到了同样的问题。我通过检查用户是否编辑了唯一属性来解决它。这是我的用户对象的相关代码摘录。

```
class User < ActiveRecord::Base

attr_accessible :email, :password, :ha1, :ha1b, :sip_username, :domain

validates :sip_username, :presence => true, :uniqueness => true,
                         :unless => :update_username?,
                         :exclusion => {:in => %w(9196),
                         :message => "9196 is reserved, please choose another"}
def update_username?
  # check to see if we are updating a sip_username for an existing user
  stored_user = User.find_by_sip_username self.sip_username
  # the id of the user is the same as me and sip_username hasn't been changed. skip validations.
  if (stored_user.present?)
    stored_user.id == self.id && stored_user.sip_username == self.sip_username
  end
end 
```

# c# - 使用 dapper 替换成熟的 OR/M

> ID：10402059
> 
> 赞同：6
> 
> 时间：2012-05-01T18:04:36.663
> 
> 标签：c#, orm, dapper

Dapper micro OR/M 给我留下了深刻的印象，我真的很想将它用作一些完全成熟的 OR/M 的并排伴侣，并最终取代它。无论如何，我没有弄清楚是否有一些策略可以从 db 反序列化层次结构：例如，记录集行的返回对象将取决于一个字段（例如，NH 中所谓的“鉴别器”）。此外，层次结构可以通过连接拆分更多表，因此表示行的类型将取决于另一个表中记录的存在。具有由上述两种策略的混合表示的层次结构将是 NH 例如不支持的东西，但存在于“关系生活”中。所以问题：

*   Dapper 能处理这种情况吗？
*   这种情况是否会削弱 Dapper 在性能方面的努力？

另一个主题是缓存。用于查询的 Dapper 缓存有点激进，拥有一些“类似会话的上下文”并为每个会话都有一个查询缓存会不会更好，或者这会再次冒犯 Dapper 的主要动机吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T06:13:59.283

目前 Dapper 不支持自定义构造逻辑，我猜你要求的是这样的：

```
class Post {}
class Question : Post { .. }
class Answer : Post { ... }

Func<IDbDataReader, Func<IDbDataReader, Post>> factoryLocator
        = ... my magic factory locater; 

cnn.Query<Post>(@"
select * from Posts p 
left join Questions q on q.Id = p.Id 
left join Answers a on a.Id = p.Id", factoryLocator: factoryLocator); 
```

我们决定不实施这样的逻辑，因为我们在现实生活中从来没有真正解决过这样的问题。它还引入了相当数量的内部复杂性和相当数量的外部复杂性（因为您需要打开`post is Question`）。

如果您可以为包含提供一个很好的论据并且补丁很简单，我不会断然反对包含这种功能。我也完全赞成在 Dapper 中添加钩子以允许您注入这种功能。

至于缓存策略，我们发现在一般使用中我们永远不会使缓存膨胀，只有当您误用 dapper 时才会发生膨胀，例如生成未参数化的 SQL。我完全支持添加一个允许您指定自己的缓存提供程序而不是`ConcurrentDictionary`现在使用的挂钩。

# c - Linux中最低的锁定原语是什么

> ID：10402060
> 
> 赞同：3
> 
> 时间：2012-05-01T18:04:38.447
> 
> 标签：c, linux, gcc, x86-64

linux中最低的锁定原语是什么。我知道`futex_wait`和`futex_wake`。但是 futex 可以用于除了锁定之外的信号。什么是最低锁定原语，我在 glibc 库中的哪里可以找到它？其次，条件变量也是基于 futex 的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:52:22.510

阅读有关[futex](http://en.wikipedia.org/wiki/Futex) -es 的各种文档，包括[futex(2)](http://linux.die.net/man/2/futex)和[futex(7)](http://www.kernel.org/doc/man-pages/online/pages/man4/futex.4.html)手册页。您将了解到 pthread 锁定原语是使用 futex 和汇编代码的混合实现的（在可移植 C99 中无法表达的事情）

^(（正如我在评论中所说）)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:28:17.133

没有“最低”之类的东西，但是针对不同场景和目的的锁，“信号”并不是区分不同类型锁的正确标准。

*   有一些锁定原语可以执行主动等待，即自旋锁，它们基于原子操作。有了 C11 的场地，这些甚至不再是操作系统功能，`atomic_flag`可以用于此目的。
*   另一类锁原语在等待期间挂起调用线程。在 linux 中，这些都是通过原子操作的组合实现的，并且`futex`作为等待部分的底层工作马。

自旋锁最适合用于您知道关键阶段只有少数汇编程序指令并且调度程序或信号不太可能中断关键阶段的情况。这种情况比许多人倾向于相信的要多得多。因此，`atomic_flag`它是 C 语言中一个重要的新特性。

其他锁最适合在主动等待会占用大部分系统资源的情况下使用。

# android - Android 到 PC 通知平台

> ID：10402062
> 
> 赞同：1
> 
> 时间：2012-05-01T18:04:49.430
> 
> 标签：android, notifications, xmpp, android-notifications

我想编写一个 Android 应用程序，它将通知从移动设备发送到安装在 PC 上的客户端应用程序。通知将包含将由客户端解析的数据。通知只是一种方式。

或者换句话说：“将数据通知从一台设备发送到另一台设备，共享同一个用户帐户”

**实现此类行为的最佳通知/消息传递平台是什么？**

一些要求：

1.  使用现有的 [免费] 服务器基础架构（gtalk？）
2.  Mobile-PC 连接必须通过普通服务器认证设置（无广播或通过 ip）
3.  通知时间必须接近实时
4.  易于实施
5.  [可选] 使用谷歌账户认证

任何关于我的要求的建设性反馈也将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:13:51.053

听起来 XMPP 符合您的要求。它肯定会允许某人使用他们的 Google Talk 帐户或任何其他 XMPP 帐户（例如[jabber.org](http://www.jabber.org/)），只要您的“通知”的大小和频率合理（毕竟这些是免费服务！）。

您应该能够使用现有的[库](http://xmpp.org/xmpp-software/libraries/)来完成这项工作。这篇文章将讨论基本 XMPP 级别的内容，但许多库将提供更高级别的 API 来执行此处描述的操作。

关于如何实现您想要的各种事情的一些注意事项：

与 XMPP 帐户的每个连接都分配有一个称为[“资源”](http://xmpp.org/rfcs/rfc6120.html#bind)的唯一标识符。在 XMPP 中，像这样的简单地址`user@gmail.com`称为[“裸 JID”](http://xmpp.org/rfcs/rfc6120.html#arch-addresses)。`user@gmail.com/your-app829abc`您还可以通过包含资源（“完整 JID”）发送到特定连接。由于资源来来去去，并且可能会有所不同（例如，Google 将它们半随机化），因此[存在](http://xmpp.org/rfcs/rfc6121.html#presence-fundamentals)用于广播资源的[可用性](http://xmpp.org/rfcs/rfc6121.html#presence-initial)和[不](http://xmpp.org/rfcs/rfc6121.html#presence-unavailable)可用性。

桌面客户端需要发送出席信息，以便移动客户端可以在线看到。它还应该在其存在中包含“-1”的[优先级](http://xmpp.org/rfcs/rfc6121.html#presence-syntax-children-priority)，以防止它从用户的联系人接收正常的聊天消息。它还应该包括[功能](http://xmpp.org/extensions/xep-0115.html)或类似的识别信息，以便移动客户端可以通过用户帐户在线识别它，而不是其他应用程序，例如 IM 客户端。

需要注意的一件事，可能是也可能不是您想要的，桌面客户端无法离线显示。它显然需要发送出席信息，以便移动客户端可以找到它，但用户的联系人也会在线看到它（即使用户没有登录到他们的 IM 客户端）。但是，负优先级将阻止它接收 IM 消息。

```
<!-- Desktop sends: -->
<presence>
    <priority>-1</priority>
    <your-app xmlns="http://example.com/your-app" type="desktop" />
</presence> 
```

所以现在从移动客户端的角度来看......它需要简单地连接到同一个帐户，并发送类似的存在。在发送自己的状态后，它将自动接收来自联系人的状态以及与同一帐户的其他连接，包括桌面客户端的连接。

```
<!-- Mobile sends: -->
<presence>
    <priority>-1</priority>
    <your-app xmlns="http://example.com/your-app" type="mobile" />
</presence>

<!-- Mobile receives (among other things): -->
<presence from="user@gmail.com/foo38Bc21e">
    <priority>-1</priority>
    <your-app xmlns="http://example.com/your-app" type="desktop" />    
</presence> 
```

现在您有了桌面客户端的完整 JID。

它可以将正常的[XMPP 消息](http://xmpp.org/rfcs/rfc6121.html#message)直接发送到桌面客户端的完整 JID，如存在数据包的“发件人”中所示。在 XMPP IM 消息中，使用消息中的[`<body>`元素](http://xmpp.org/rfcs/rfc6121.html#message-syntax-body)来传达文本，但是您可以省略`<body>`标签并插入[您自己的 XML 数据](http://xmpp.org/rfcs/rfc6120.html#stanzas-extended)：

```
<!-- Mobile sends: -->
<message to="user@gmail.com/foo38Bc21e">
    <your-notification xmlns="http://example.com/your-app">
        <any-xml-here/>
    </your-notification>
</message> 
```

您几乎可以立即在桌面上收到此消息（最大的延迟通常在您的移动网络中）。对于移动设备上的 XMPP，还可以查看[XEP-0286：移动设备上的 XMPP](http://xmpp.org/extensions/xep-0286.html)。

# javascript - 选项卡时选择文本区域文本

> ID：10402067
> 
> 赞同：1
> 
> 时间：2012-05-01T18:05:25.013
> 
> 标签：javascript, jquery, focus, textarea

我在 Stack Overflow 上找到[了这个问题](https://stackoverflow.com/questions/5797539/jquery-select-all-text-from-a-textarea)，并使用了最佳答案中给出的代码。

否则它的效果非常好，但是有一个问题。在我的页面上，我有多个文本区域。事实上，我使用的选择器只是`"textarea"`.

但是，当从一个文本区域“切换”到另一个文本区域时（使用 Tab 键跳转到下一个区域），显然不会触发焦点事件，并且不会选择文本。

如何修改该代码以通过单击和 Tab 来工作？

JSFiddle 这里；[http://jsfiddle.net/qQDbZ/](http://jsfiddle.net/qQDbZ/) 我在 Chrome 上，当点击 textarea 时会选择全部，tabbing 不会。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T18:37:16.703

我能够使用以下解决方法来解决这个问题：

```
$('textarea').focus(function() {
    var $this = $(this);
    $this.select().mouseup(function() {
        $this.off('mouseup');
        return false;
    });
}).keyup(function(e) {
    if(e.which === 9) {
        this.select();
    }
}); 
```

演示：http: [//jsfiddle.net/KfFPM/3/](http://jsfiddle.net/KfFPM/3/)

我在 Chrome 21、Safari 6、Firefox 14、Opera 12 和 IE 9 中测试了上述内容。稍后我会测试更多版本；我现在很高兴。向前跳动和向后移动+跳动时工作。

绑定到`keydown`没有工作。

我仍然认为这种解决方法应该是不必要的。我最好的猜测是 webkit 浏览器将选项卡检测为 textarea 内的按键，因此取消选择文本，就像任何浏览器在 textarea 中选择了一些文本然后开始输入时一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T18:15:40.940

```
$('input[type="textarea"]').keydown(function(event){
    var keypressed = event.keyCode || event.which,
    tab = 9,
    $this = $(this);

    if(keypressed === tab){
       $this.next('textarea').focus();
    }
}); 
```

不确定到底是什么问题，但是如果您需要强制解决方案，这应该可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-22T19:11:40.883

```
$('textarea').focus(function() {
    var $this = $(this);
    $this.select();
}).keyup(function(e) {
    if(e.which === 9) {
        this.select();
    }
}).off('mouseup',function(){
    return false;
}) 
```

# wpf - GridViewColumnHeaders 的键盘访问？

> ID：10402068
> 
> 赞同：2
> 
> 时间：2012-05-01T18:05:27.613
> 
> 标签：wpf, xaml, gridview, gridviewcolumn

我们的 ListView 要求是列标题可以通过键盘访问，而默认 ListView 不会发生这种情况。例如：

```
 <StackPanel x:Name="LayoutRoot">
    <ListView HorizontalAlignment="Left" KeyboardNavigation.TabNavigation="Local">
        <ListView.View>
            <GridView >
                <GridViewColumn Header="Header _1" KeyboardNavigation.TabIndex="0"/>
                <GridViewColumn Header="Header _2" KeyboardNavigation.TabIndex="1"/>
                <GridViewColumn Header="header _3" KeyboardNavigation.TabIndex="2"/>
            </GridView>
        </ListView.View>
        <ListViewItem Content="I'm the first item" />
        <ListViewItem Content="I'm the second item" />
    </ListView>
    <Button Content="I can also get focus" HorizontalAlignment="Left" Margin="0,27,0,0"/>
</StackPanel> 
```

访问键显示标题，但它们没有获得键盘焦点。我通过阅读此问题添加的 TabIndex 和 TabNavigation： [tabbing to TextBoxes in column headers](https://stackoverflow.com/questions/7465151/how-to-tab-through-textboxes-in-a-listview)

我需要做什么才能使 GridViewColumnHeaders 键盘可访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T19:30:12.883

有人内部有解决方案。在 GridViewColumnHeader ControlTemplate 中，将 ContentPresenter 设置为 Focusable=true，如下所示：

```
 <ContentPresenter x:Name="ContentPresenter"
                Style="{StaticResource ListViewContentPresenterStyle}" 
                ContentTemplate="{TemplateBinding ContentTemplate}" 
                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                RecognizesAccessKey="True"
                Focusable="True"
                Grid.Column="1"> 
```

此外，设置 ListView KeyboardNavigation.TabNavigation=Local。

# collectd - 默认的 collectd 插件目录在哪里？

> ID：10402070
> 
> 赞同：4
> 
> 时间：2012-05-01T18:05:57.333
> 
> 标签：collectd

Collectd 默认将其插件存储在哪里？我缺少一个 perl 插件，我想确保它不是因为安装被冲洗掉了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T07:54:46.727

`PluginDir`插件位置是使用`collectd.conf`. 可以使用内置帮助查询默认（编译）位置：

```
$ collectd -h
Usage: collectd [OPTIONS]
[...]
Builtin defaults:
[...]
Plugin directory  /usr/lib/collectd
[...] 
```

这适用于用 C 编写的插件。您指的是 perl 插件，因此这适用于`perl.so`perl 解释器插件本身。如果您询问 perl ( `*.pm`) 文件的位置，那么适用的是您的 perl 策略（即`@INC`）。如果您需要强制标准 perl 模块位置，您可以在块`IncludeDir`内使用指令`<Plugin perl>`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T11:02:55.447

在我的系统（Fedora 17）上，插件安装在 /usr/lib64/collectd 中，来自以下软件包：

```
$ rpm -qf /usr/lib64/collectd/* | sort -u
collectd-4.10.8-2.fc17.x86_64
collectd-rrdtool-4.10.8-2.fc17.x86_64
collectd-sensors-4.10.8-2.fc17.x86_64
collectd-snmp-4.10.8-2.fc17.x86_64
$ 
```

# java - 使用类添加最终值。爪哇。

> ID：10402073
> 
> 赞同：0
> 
> 时间：2012-05-01T18:06:19.330
> 
> 标签：java, oop, class

我正在编写一个照片程序，它接受用户的互联网速度以及照片的宽度和高度。然后程序会显示成本、存储大小和传输时间。我将程序分成两部分，一个设置值，一个包含所有方法的类。

我的程序遇到的主要问题是将输入的所有照片的所有值相加，并在最后显示价格、存储空间和时间。

到目前为止，我有一个 addTotal() 方法，可以将时间、价格和存储添加到我设置的值中。但是，不断发生的是最后一张输入的照片的值继续显示，而不是所有照片的总数。

例如：如果网速设置为 150,000，并且有两张尺寸为 4,5 和 4.5,4.5 的照片，假设最后显示的是：

总成本 = 4.83 美元

4.14 MB 存储空间

3分40秒转移

任何帮助表示赞赏。

这是主程序：

```
import javax.swing.JOptionPane;
{
public static void main(String args[])
{
double speed;
double height;
double width;
double compression = 3.5;
double resolution = 600;

System.out.println("Welcome to the Scans-R-Us Digital Photo Shop!");
String userInput = JOptionPane.showInputDialog("Do you have a photo you would like us to scan(Yes or No)?");

while((!userInput.equals("Yes") && (!userInput.equals("YES")) && (!userInput.equals("yes"))))   
    {
    System.out.println("test");
    System.exit(0);
    }
    do  
    {
    String internetString = JOptionPane.showInputDialog("What is your internet speed in bits/second?");
    speed = Double.parseDouble(internetString);
    }
    while(speed < 0);

while((userInput.compareTo("No") != 0) && (userInput.compareTo("NO") != 0) && (userInput.compareTo("no") != 0))
    {
    DigitalPhoto one = new DigitalPhoto();

    do
    {
    String heightString = JOptionPane.showInputDialog("What is the height of the photo?");
    height = Double.parseDouble(heightString);
    }
    while(height >=8);

    do
    {
    String widthString = JOptionPane.showInputDialog("What is the width of the photo?");
    width = Double.parseDouble(widthString);
    }
    while(width >= 8);

    one.setWidth(width);
    one.setHeight(height);
    one.setSpeed(speed);
    one.setCompression(compression);
    one.setResolution(resolution);
    one.setPrice();
    one.setStorage();
    one.setTime();
    one.showValues();
    one.addTotal(); 

    userInput = JOptionPane.showInputDialog("Do you have a photo you would like us to scan(Yes or No)?");

    while((!userInput.equals("Yes") && (!userInput.equals("YES")) && (!userInput.equals("yes"))))
    {
    one.endValues();
    System.out.println("\nThanks, have a nice day!");
    System.exit(0);
    }
 }  
}
} 
```

这是我用来运行程序的类：

```
import javax.swing.JOptionPane;
{   
double total;
double width;
double height;
double speed;
double compression;
double resolution; 
double price;
double time;
double totalPrice;
double totalStorage;
double totalTime;
double pricePerInch = .12;
int bytes = 8;
int megaSize = 1000000;

DigitalPhoto()
{
width = 0.0;
height = 0.0; 
speed = 0.0;
compression = 0.0;
resolution = 0.0;
total = 0.0;
price = 0.0;
time = 0.0;
}

public void setWidth(double thisWidth)
{
width = thisWidth;
}

public void setHeight(double thisHeight)
{
height = thisHeight;
}

public void setSpeed(double thisSpeed)
{
speed = thisSpeed;
}

public void setCompression(double thisCompression)
{
compression = thisCompression;
}

public void setResolution(double thisResolution)
{
resolution = thisResolution;
}

public double getWidth()
{
return width;
}

public double getHeight()
{
return height;
}

public double getSpeed()
{
return speed;
}

public double getCompression()
{
return compression;
}

public double getResolution()
{
return resolution;
}

public double setStorage()
{
width = width * resolution;
height = height * resolution;
total = width * height;
total = total / compression;
total = total / megaSize;
return total;
}

public double setPrice()
{
price = height * width;
price = price * pricePerInch;
return price;
}

public double setTime()
{
total = total * megaSize;
time = total * bytes;
time = time / speed;
total = total / megaSize;
return time;
}

public void showValues()
{
System.out.println("\nScanned photo details: ");
System.out.println("Resolution: " + resolution);
System.out.println("Compression ratio: " + compression);
System.out.println("The customer photos require " + total + " Mbytes of storage.");
System.out.println("The customer photos cost $" + price);
System.out.println("It will take " + (int)time / 60 + " minutes and " + (int)time % 60 + " seconds");
}

public void addTotal()
{
totalTime = totalTime + time;
totalPrice = totalPrice + price;
totalStorage = totalStorage + total;
}

public void endValues()
{
System.out.println("\nThe  photos require " + totalStorage + " Mbytes of storage.");
System.out.println("The  photos cost $" + totalPrice);
System.out.println("It will take " + (int)totalTime / 60 + " minutes and " + (int)totalTime % 60 + " seconds");
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:14:43.693

每次进入循环时都会创建一个新对象，因此您只保留最后一个。您需要在循环之前创建对象：

```
DigitalPhoto one = new DigitalPhoto();
while((userInput.compareTo("No") != 0) && (userInput.compareTo("NO") != 0) &&
   (userInput.compareTo("no") != 0)) {
  //...
  one.setPrice();
  //...
  one.addTotal();
} 
```

然后在循环结束后查询结果。

# ruby-on-rails - Rails 几个（聚合）列的唯一性？

> ID：10402075
> 
> 赞同：0
> 
> 时间：2012-05-01T18:06:33.423
> 
> 标签：ruby-on-rails, database, validation, uniqueidentifier

我有一个 Rails 应用程序（Postgres），我想添加基于多个参数的验证.. 例如

如果

```
 Object.column1 & Object.column2 are NOT unique => reject new entry. 
```

但如果

```
Object.column1 IS not unique BUT Object.column2 for duplicate entry is different => accept new entry 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:53:37.653

不太确定 :scope 是否会解决您的问题，或者您可以编写自己的验证，例如

```
validate :custom_validation

def custom_validation
  self.errors.add(:column, MESSAGE) if YOUR VALIDATION LOGIC fails
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:58:35.713

您可以将范围添加到唯一性约束。然后它将仅检查整个列集是否唯一。

```
validates_uniqueness_of :column1, :scope => :column2 
```

请参阅[文档](http://api.rubyonrails.org/classes/ActiveRecord/Validations/ClassMethods.html#method-i-validates_uniqueness_of)以获取更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T18:58:56.243

我想这是

```
class User
  validates :first_name, :uniqueness => true, :scope => [:last_name]
end 
```

您还可以创建唯一索引，您的数据库将强制执行唯一性。

```
add_index :users, [:last_name, :first_name], :unique => true 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T19:00:44.993

通过使用迁移向 [column1, column2] 和 [column2] 添加唯一索引，在数据库级别执行此检查可能更安全，如下所示：

```
add_index :model_name, [:column1, :column2], :unique=>true
add_index :model_name, :column2, :unique=>true 
```

# mysql - 处理来自控制器中的查找操作的内爆值

> ID：10402079
> 
> 赞同：0
> 
> 时间：2012-05-01T18:06:46.850
> 
> 标签：mysql, arrays, cakephp, cakephp-1.3

我相信这里有人可以帮助我。首先介绍一下我在做什么的背景。我基本上是在建立一个社交网站，为了便于理解，基本上称它为每个人最喜欢的 Facebook 的模拟。

目前一切正常，除了一件事。一件事是在“墙上”显示我所有朋友的帖子。我可以获取我的帖子，也可以从我请求的朋友和那些请求我的朋友那里获取 ID 最低的人的帖子。

例如，假设我是用户 A，有用户 B、用户 C、用户 D 和用户 E。我登录并请求用户 B 和用户 C，他们都批准了。让我们假设用户 D 和用户 E 请求我并且我批准了他们两个。所以现在我（用户 A）是用户 B、C、D 和 E 的朋友。我请求 B 和 C，D 和 E 请求我。为了这个例子，我们假设这些用户的 ID 是按顺序排列的；1是我（A），通过5是E。

当“墙”出现时，我会收到我的帖子，这是意料之中的，但我只收到来自用户 B（我请求）和用户 D（请求我）的帖子。用户 C 和 E 的帖子不显示，因为他们的 ID 在 B 和 D 之后...

现在到代码...涉及的模型是用户、友谊和 WallPost。我的 users_controller 在 profile() 函数中有以下查找操作。

```
 $friends_to = $this->Friendship->find('all', array(
          'conditions' => array('Friendship.pending' => 1, 'Friendship.approved' => 1, 'UserTo.id' => $id),
          'fields' => array('Friendship.user_from')
        )
    );  
    $friends_to_ids = implode(',', Set::extract($friends_to, '{n}.Friendship.user_from'));

    $friends_from = $this->Friendship->find('all', array(
          'conditions' => array('Friendship.pending' => 1, 'Friendship.approved' => 1, 'UserFrom.id' => $id),
          'fields' => array('Friendship.user_to')
        )
    );
    $friends_from_ids = implode(',', Set::extract($friends_from, '{n}.Friendship.user_to'));

    $post_conditions =  array(
        'OR' => array(
            array('WallPost.user_id' => $this->Auth->user('id')),
            array('WallPost.user_id' => $friends_to_ids),
            array('WallPost.user_id' => $friends_from_ids)
        ),
    );
    $posts = $this->WallPost->find('all', array(
          'conditions' => $post_conditions,
          'order' => array('WallPost.created' => 'desc')
        )
    );
    $this -> set ('posts', $posts); 
```

在我上面给出的示例的上下文中，这将返回以下 SQL 语句：

```
SELECT `WallPost`.`id`, `WallPost`.`user_id`, `WallPost`.`content`, `WallPost`.`created`, `WallPost`.`modified`, `User`.`id`, `User`.`first_name`, `User`.`last_name`, `User`.`username`, `User`.`password`, `User`.`email`, `User`.`group_id`, `User`.`confirmed`, `User`.`confirm_code`, `User`.`created`, `User`.`modified` FROM `wall_posts` AS `WallPost` LEFT JOIN `users` AS `User` ON (`WallPost`.`user_id` = `User`.`id`) WHERE ((`WallPost`.`user_id` = 1) OR (`WallPost`.`user_id` = '2,3') OR (`WallPost`.`user_id` = '4,5')) ORDER BY `WallPost`.`created` desc 
```

所以 ID 在那里，但只显示以下内容。( `WallPost`. `user_id`= 1)，ID 为 1 的用户。( `WallPost`. `user_id`= '2,3')，仅显示用户 ID 2。( `WallPost`. `user_id`= '4,5')，仅显示用户 ID 4。

我在这里做错了什么？为什么不显示所有这些用户的结果？任何朝着正确方向的推动将不胜感激。

快速更新：我重组了我的查询，所以它有点不同但返回相同的东西。

```
SELECT `WallPost`.`id`, `WallPost`.`user_id`, `WallPost`.`content`, `WallPost`.`created`, `WallPost`.`modified`, `User`.`id`, `User`.`first_name`, `User`.`last_name`, `User`.`username`, `User`.`password`, `User`.`email`, `User`.`group_id`, `User`.`confirmed`, `User`.`confirm_code`, `User`.`created`, `User`.`modified` FROM `wall_posts` AS `WallPost` LEFT JOIN `users` AS `User` ON (`WallPost`.`user_id` = `User`.`id`) WHERE `WallPost`.`user_id` IN (1, '2,3', '4,5') ORDER BY `WallPost`.`created` desc 
```

经过更多研究后，它似乎将“2,3”和“4,5”视为字符串，而应该将它们视为IN（1,2,3,4,5）的所有内容。我无法解决这个问题，再次感谢任何帮助。

**感谢您提供正确答案的帮助。现在这是我关于这个问题的下一个小问题。**

因此，从数据库中提取的内容正在针对 3 个事物进行查询，即我的用户 id，以及包含请求和批准的朋友 id 的 2 个数组，以及我请求和批准的朋友的 id。使用下面我现在的解决方案中给出的相同技术。

```
$friends_tos = $this->Friendship->find('all', array(
          'conditions' => array('Friendship.pending' => 1, 'Friendship.approved' => 1, 'UserTo.id' => $id),
          'fields' => array('Friendship.user_from'), //array of field names
        )
    );  
    $friends_to_ids = Set::extract($friends_tos, '{n}.Friendship.user_from');

    $friends_froms = $this->Friendship->find('all', array(
          'conditions' => array('Friendship.pending' => 1, 'Friendship.approved' => 1, 'UserFrom.id' => $id),
          'fields' => array('Friendship.user_to'), //array of field names
        )
    );
    $friends_from_ids = Set::extract($friends_froms, '{n}.Friendship.user_to'); 
```

这给了我 $friends_to_ids = (2,3) 和 $friends_from)ids = (4,5)，然后我使用以下`$aMerge = array_merge($friends_to_ids, $friends_from_ids);`将它们组合起来，得到 $aMerge = (2,3,4,5)，这很棒.

但是使用它作为我的查找条件：

```
$post_conditions =  array(
        'OR' => array(
            'WallPost.user_id' => $this->Auth->user('id'),
            'WallPost.user_id' => $aMerge
        ),
    ); 
```

仅返回 $aMerge 的值并完全跳过我的用户 ID 的值。我尝试了多种方法来重组这个查找条件，但无济于事。我确定我错过了一些小东西，因为它通常是这样的，但我正在画空白......

确保你回答我可以标记它的地方......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T13:42:01.833

好的，所以也许这不是最干净的方法，但我有一个想法，尝试过，它奏效了。如果有人有更简单和更清洁的解决方案，我将不胜感激知道它是什么。

所以这就是我所做的。遵循与我找到自己的朋友相同的流程，使用 find 'all' 并将返回值限制为 1。然后以数组的形式提取该 ID，即使它是单个值。

```
$me = $this->User->find('all', array(
          'conditions' => array('User.id' => $this->Auth->user('id')),
          'fields' => array('User.id'),
          'limit' => 1,
        )
    );
    $my_id = Set::extract($me, '{n}.User.id'); 
```

然后我将它添加到array_merge：

```
$aMerge = array_merge($my_id, $friends_to_ids, $friends_from_ids); 
```

然后，当使用 $aMerge 作为“墙”帖子的查找条件时，我得到了返回 (1,2,3,4,5)，这正是我所需要的。再次感谢所有的帮助并移动您的答案，以便我可以给予您的信任...

# html - 网站在 iPad 上左对齐

> ID：10402081
> 
> 赞同：4
> 
> 时间：2012-05-01T18:07:00.377
> 
> 标签：html, css, ipad, margin

我的 iPad 出现问题`margin: 0 auto`。对齐到左侧，而`div`不是像我的桌面上那样居中。

您可以在此处查看该网站：[www.amplify.io](http://www.amplify.io)

容器有一个宽度，我在网上尝试了一些解决方案，但无济于事......任何指针都非常感谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T18:41:14.630

可能是发生溢出的情况，因为您没有为移动设备设置视口。

尝试添加：

```
<meta name="viewport" content="width=device-width,
                           maximum-scale=1.0" /> 
```

到你的 HTML 头来确定。这应该将页面宽度设置为 iPad 的宽度，并确保没有发生缩放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:53:29.723

[验证者结果](http://validator.w3.org/check?uri=www.amplify.io&charset=%28detect%20automatically%29&doctype=Inline&group=0)

您的网站上有 26 个错误和 11 个警告。我敢打赌，您的网站未正确对齐的原因是由于其中之一。修复你的错误，看看是否能解决问题，否则，重新解决问题。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-05-01T18:14:05.117

如果您的意思是整个 div（整个页面）：

`margin-left: auto; margin-right: auto;`

# html - 使用 CSS 进行水平列表滚动

> ID：10402082
> 
> 赞同：2
> 
> 时间：2012-05-01T18:07:01.077
> 
> 标签：html, css

我想创建一个类似于 netflix 上的列表的水平滚动条。这是html的基本设置：

这是我将用来解释我的努力的图像： ![在此处输入图像描述](../Images/425384afd1b0010547327e0006e99fbc.png)

上面的设置是我想要的：scrolling_list 有一个固定的宽度（我把它设置为，比如说，300px）。然后，在这个 div 中，我有一个列表滚动器，它将承载多个名为 outer_list 的子级。上面的设置显示了 list_scroller 的宽度如何随着孩子的数量（1000、1300、1600 或其他取决于孩子的数量）而扩展。

不幸的是，我现在不知道如何使用 css.. 执行此操作，除非我指定 list_scroller 的宽度，否则它的宽度不会扩大（它将假定第一个孩子的宽度）。相反，list_scroller 假定这个更短的宽度，然后孩子们最终水平堆叠。

谁能帮我解决这个问题？这是当前的CSS：

```
.scrolling_list {
    overflow:auto;
    overflow-y:hidden;
    position:relative;
    width:360px;
}
.list_scroller {
    position:relative;
    display:block;
    overflow-x:auto;
    overflow-y:hidden;
    padding:10px;
    height:360px;
}
.list_scroller .outer_list {
    width:260px;
    display:inline-block;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:12:53.887

你在正确的轨道上！我认为您应该将整个溢出设置为隐藏，而不是设置`overflow: auto;`and ，并为 list_scroller 提供更大的宽度。`overflow-y: hidden;`像这样的东西可能会起作用：

[http://jsfiddle.net/mEg7g/1/](http://jsfiddle.net/mEg7g/1/)

祝你好运，我希望这会有所帮助。:D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:00:13.267

用于`white-space:nowrap`容器：http: [//jsfiddle.net/BQGa7/](http://jsfiddle.net/BQGa7/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:27:06.093

另外，不要忘记添加

```
-webkit-overflow-scrolling: touch; /* I guess iOS 5 only */ 
```

用于 iOS 设备兼容性。

# algorithm - 最小曼哈顿距离的算法

> ID：10402087
> 
> 赞同：19
> 
> 时间：2012-05-01T18:07:34.673
> 
> 标签：algorithm

我希望找到与一组点的曼哈顿距离/直线距离之和最小的点（即该点与集合中每个点之间的直线距离之和应该是最小的）。结果点可以是给定集合中的点之一（不一定）。如果存在多个具有相同最小距离的点，我希望检索所有这些点。

换句话说：

我有一个标有某些交叉点的​​网格。我想找到最接近所有标记的十字路口的十字路口。也就是说，我需要找到一个点，使得到所有点的距离之和最小。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-05-01T18:21:00.727

曼哈顿距离最酷的地方在于距离本身由两个独立的分量组成：x 和 y 坐标上的距离。因此，您可以解决两个更简单的任务并将它们的结果合并以获得所需的结果。

我所说的任务是：给定的是一条线上的点。在直线上找到使到所有点的绝对距离之和最小的点。如果有很多找到所有这些（顺便说一句，它们总是变成一个易于证明的单个片段）。该段由集合的（可能两个）点中位数确定。中位数是指在其左侧和右侧具有相同数量的点的点。如果点的数量是偶数，则没有这样的点，并且您选择在两个方向上差异为 1 的点来形成线段。

在这里，我添加了这个更简单任务的解决方案示例：

如果线上的点是这样的：

```
-4 | | | 0 | 2 3 4
             ^ 
```

解决方案只是一个点，它就是`2`。

如果线上的点是这样的：

```
-4 | | | 0 | 2 3
         ^---^ 
```

整个段 [0, 2] 就是问题的解。

您分别为`x`和`y`坐标解决此任务，然后合并结果以获得最小距离点的矩形。

* * *

### 例子

现在是初始任务的解决方案示例。

想象一下，您想找到与集合的曼哈顿距离最小的点`(0, 6), (1, 3), (3, 5), (3, 3), (4, 7), (2, 4)`

您形成了两个更简单的任务：

对于 x：

```
0 1 2 3 3 4
    ^-^ 
```

这里的解决方案是段`[2, 3]`（请注意，这里我们复制了 point `3`，我用可能不是最直观的方式表示）。

对于 y：

```
3 3 4 5 6 7
    ^-^ 
```

这里的解决方案是段`[4, 5]`。

最后我们得到初始任务的解决方案是带有公式的矩形：

```
 2 <= x <= 3; 4 <= y <= 5 
```

* * *

### 复杂

由于许多人对这篇文章表现出兴趣，我决定对其进行更多改进。

让我们谈谈复杂性。

任务的复杂性实际上与解决更简单任务的复杂性相同（因为正如已经讨论过的，解决方案实际上包括解决两个更简单的任务）。许多人会通过排序然后选择中位数来解决它。但是，这会导致`O(nlog n)`复杂性，其中`n`输入集中的点数是多少。

如果使用更好的算法来查找第 k 个元素，则可以改进这一点（C++ STL 中的实现[示例）。](http://www.cplusplus.com/reference/algorithm/nth_element/)该算法基本上遵循与 qsort 相同的方法。运行时间为`O(n)`。即使在两个中点的情况下，这仍然是线性的（需要两次运行相同的算法），因此算法的总复杂度变为`O(n)`. 很明显，只要输入本身具有上述复杂性，就无法更快地解决任务。

# objective-c - 在 Objective C 中使用点符号有什么要求？

> ID：10402090
> 
> 赞同：2
> 
> 时间：2012-05-01T18:08:00.420
> 
> 标签：objective-c, syntax, properties, categories

我想在一个类别中创建一个属性，以便可以对访问器使用点表示法。我想这样做的原因是我可以重构一些引用 NSMangedObject 属性的现有代码。然后我会将类别访问器方法放在外部调用者和它们相关的 NSManagedObject 属性之间。（我不想用消息替换当前的点符号用法，因为我在一个非常大的项目中使用点符号。）

我在类别界面中使用如下属性声明进行了一些实验：

```
@property NSString* details; 
```

这会导致编译器警告（它不喜欢默认的分配属性。）

由于没有直接与属性绑定的 ivar，因此添加保留或复制的属性没有任何意义。

接下来，我只是省略了@property 行，并在接口和实现文件中添加了访问器。

```
- (void) setDetails:(NSString*)details;
- (NSString*) details; 
```

我编译并运行了代码。我使用点符号测试了这些方法。我可以看到访问器可以成功使用而不会出现错误并且编译器不会抱怨。

我读到的关于点表示法的内容告诉我，如果我以某种方式设置属性，我可以使用点表示法。但我没有设置符合该要求的属性。但看来我仍然可以使用点表示法。

这种方法有什么问题吗？是否有定义如何以及何时可以使用点符号访问器的规范？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:16:10.077

点表示法旨在用于声明的属性访问，但实际上编译器对它的处理非常松散，如果您不分配结果，则可以使用任何无参数方法：

```
 aString.lowercaseString;
 aNumber.intValue;
 aDict.allKeys; 
```

同样，如果`set<uppercase name>:`对象上有可用形式的单参数方法，编译器将允许您像使用左值一样使用点语法表达式：

```
aString.string = @"Amazing";
aWindow.alphaValue = 0.45; 
```

即使该名称未使用`@property`语法声明。

废话，废话，我想你已经知道了。目前我能找到的唯一相关文档是[TOCPL](http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocObjectsClasses.html#//apple_ref/doc/uid/TP30001163-CH11-SW17)中的这句话：

> 然而，当与对象一起使用时，点语法充当“语法糖”——它被编译器转换为对访问器方法的调用。

# c# - 在 ASP.NET MVC 中上传图像

> ID：10402094
> 
> 赞同：41
> 
> 时间：2012-05-01T18:08:17.630
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, razor

我有一个上传表单，我想传递我的信息，例如图像和其他一些字段，但我不知道如何上传图像..

这是我的控制器代码：

```
[HttpPost]
        public ActionResult Create(tblPortfolio tblportfolio)
        {
            if (ModelState.IsValid)
            {
                db.tblPortfolios.AddObject(tblportfolio);
                db.SaveChanges();
                return RedirectToAction("Index");  
            }

            return View(tblportfolio);
        } 
```

这是我的视图代码：

```
@model MyApp.Models.tblPortfolio

<h2>Create</h2>

@using (Html.BeginForm(null, null, FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>tblPortfolio</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Title)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Title)
            @Html.ValidationMessageFor(model => model.Title)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.ImageFile)
        </div>
        <div class="editor-field">
            @Html.TextBoxFor(model => model.ImageFile, new { type = "file" })
            @Html.ValidationMessageFor(model => model.ImageFile)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Link)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Link)
            @Html.ValidationMessageFor(model => model.Link)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
} 
```

现在我不知道如何上传图像并将其保存在服务器上..如何设置图像名称`Guid.NewGuid();`？或者我该如何设置图像路径？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-05-01T18:29:20.863

首先，您需要更改视图以包含以下内容：

```
<input type="file" name="file" /> 
```

然后，您需要更改您的帖子`ActionMethod`以获取`HttpPostedFileBase`，如下所示：

```
[HttpPost]
public ActionResult Create(tblPortfolio tblportfolio, HttpPostedFileBase file)
{
    //you can put your existing save code here
    if (file != null && file.ContentLength > 0) 
    {
        //do whatever you want with the file
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-12T15:24:14.340

`Request`您可以使用Collection获取它`Request.Files`，如果上传单个文件，只需从第一个索引中读取，使用`Request.Files[0]`：

```
[HttpPost]
public ActionResult Create(tblPortfolio tblportfolio) 
{
 if(Request.Files.Count > 0)
 {
 HttpPostedFileBase file = Request.Files[0];
 if (file != null) 
 { 
  // business logic here  
 }
 } 
} 
```

如果上传多个文件，您必须对`Request.Files`集合进行迭代：

```
[HttpPost] 
public ActionResult Create(tblPortfolio tblportfolio)
{ 
 for(int i=0; i < Request.Files.Count; i++)
 {
   HttpPostedFileBase file = Request.Files[i];
   if (file != null)
   {
    // Do something here
   }
 }
} 
```

如果您想通过 ajax 上传文件而不刷新页面，那么您可以使用[这篇使用 jquery 插件的文章](http://powerdotnetcore.com/asp-net-mvc/asp-net-mvc-simple-ajax-file-upload-using-jquery)

# java - JSObject.equals() 说 JSObject.getWindow() 不等于 JSObject.getWindow()

> ID：10402101
> 
> 赞同：1
> 
> 时间：2012-05-01T18:08:55.110
> 
> 标签：java, applet, equals, jsobject

[JSObject.equals](https://developer.mozilla.org/en/LiveConnect/LiveConnect_Reference/JSObject#equals)的文档说：

> 确定两个 JSObject 对象是否引用同一个实例。

相反，以下表达式的计算结果为`false`：

```
JSObject.getWindow(applet).equals(JSObject.getWindow(applet)) 
```

我已经预料`true`到...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:13:31.103

似乎`getWindow`返回一个`JSObject`描述窗口的新的。所以每次调用`getWindow`都是一个新实例，但数据相同，所以 equals 返回 false。两个 JSObject 都描述了窗口，但不是同一个对象。

```
public class MyClass
{
  int a;
  public MyClass(int arg)
  {
    a = arg;
  }

  public MyClass getMyClass()
  {
    return new MyClass(a);
  }

  public static void main(String args[])
  {
    MyClass parent = new MyClass(1);
    MyClass obj1 = parent.getMyClass();
    MyClass obj2 = parent.getMyClass();
    System.out.println(obj1.equals(obj2));        
  }
} 
```

这打印错误，因为即使对象在其中具有相同的值，它们仍然是不同的对象。

编辑：更新以使用一种`get`方法使其更清晰。

# salesforce - DateTime and Date Comparison

> ID：10402102
> 
> 赞同：2
> 
> 时间：2012-05-01T18:09:15.540
> 
> 标签：salesforce

Why would this statement return true? I understand that I'm comparing a `Date` to a `DateTime` variable, but I'm looking for a more technical explanation.

```
DateTime dt = DateTime.newInstance(2012,04,30,0,0,0);
system.debug(dt > Date.valueOf('2012-04-30')); 
```

Also, would DateTime values (for the dt variable) before 2012-04-30 also return true?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:40:19.157

**[`Superfell`](https://stackoverflow.com/users/41455/superfell)** noted in the comments that this is probably due to a time-zone conversion as well as midnight (`00:00:00`) being appended to the Date for comparison. Short story: he was right about it being because of midnight being appended to the Date for the comparison. The detail is below.

I needed to see this in action to understand it completely; so, I wrote up a block of code.

```
for(Integer mo=4; mo<6; mo++) // test April (4) and May (5) only
    for(Integer d=(mo==4?29:0); d<=(mo==5?2:30); d++) // test between 2012-04-29 and 2012-05-30
        for(Integer h=0; h<12; h++)
            for(Integer m=0; m<60; m++)
            {
                // this simulates a CreatedDate field (note it is generated using the newInstanceGMT method and not simply newInstance)
                // DateTime fields in Salesforce are stored in GMT then converted to the current User's time-zone. 
                DateTime dt1 = DateTime.newInstanceGMT(2012,mo,d,h,m,0); 
                Date dt2 = Date.valueOf('2012-04-30');
                if(dt1 > dt2) { 
                    system.debug(LoggingLevel.INFO,'DateTime:'+dt1+' > Date:'+dt2); }
            } 
```

The resulting debug log displayed:

```
USER_DEBUG|[9]|INFO|DateTime:2012-04-30 00:01:00 > Date:2012-04-30 00:00:00
USER_DEBUG|[9]|INFO|DateTime:2012-04-30 00:02:00 > Date:2012-04-30 00:00:00
USER_DEBUG|[9]|INFO|DateTime:2012-04-30 00:03:00 > Date:2012-04-30 00:00:00
...
USER_DEBUG|[9]|INFO|DateTime:2012-05-02 11:57:00 > Date:2012-04-30 00:00:00
USER_DEBUG|[9]|INFO|DateTime:2012-05-02 11:58:00 > Date:2012-04-30 00:00:00
USER_DEBUG|[9]|INFO|DateTime:2012-05-02 11:59:00 > Date:2012-04-30 00:00:00 
```

The **simplist solution** would be to compare against `Date.valueOf('2012-05-01');`. However, it's possible to compare against CreatedDate fields using the `newInstanceGMT` method on the DateTime type. Using the DateTime method, midnight needs to be accounted for.

```
DateTime dt1 = DateTime.newInstanceGMT(2012,mo,d,h,m,0); // simulated CreatedDate field
Date dt2 = Date.valueOf('2012-05-01'); 
if(dt1 > dt2) { 
    system.debug(LoggingLevel.INFO,'DateTime:'+dt1+' > Date:'+dt2); } 
```

OR

```
DateTime dt1 = DateTime.newInstanceGMT(2012,mo,d,h,m,0); // simulated CreatedDate field
DateTime dt2 = DateTime.newInstanceGMT(2012,04,30,12,59,59); 
if(dt1 > dt2) { 
    system.debug(LoggingLevel.INFO,'DateTime:'+dt1+' > Date:'+dt2); } 
```

Both methods resulted in the desired results:

```
USER_DEBUG|[9]|INFO|DateTime:2012-05-01 00:00:00 > Date:2012-04-30 12:59:59
USER_DEBUG|[9]|INFO|DateTime:2012-05-01 00:01:00 > Date:2012-04-30 12:59:59
USER_DEBUG|[9]|INFO|DateTime:2012-05-01 00:02:00 > Date:2012-04-30 12:59:59
...
USER_DEBUG|[9]|INFO|DateTime:2012-05-02 11:57:00 > Date:2012-04-30 12:59:59
USER_DEBUG|[9]|INFO|DateTime:2012-05-02 11:58:00 > Date:2012-04-30 12:59:59
USER_DEBUG|[9]|INFO|DateTime:2012-05-02 11:59:00 > Date:2012-04-30 12:59:59 
```

# facebook - 朋友选择器不起作用？

> ID：10402106
> 
> 赞同：0
> 
> 时间：2012-05-01T18:09:25.047
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我创建了一个非常简单的应用程序来邀请朋友。

这是我的代码：

```
function sendRequestViaMultiFriendSelector() {
FB.ui({
  method: 'apprequests',
  message: 'You should learn more about this awesome game.'
});
} 
```

朋友选择器出现但它不起作用:(

**现场演示**和完整的源代码：

[http://bit.ly/K4uyeJ](http://bit.ly/K4uyeJ)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:30:11.100

该代码对我来说很好。

稍微向前跳跃，稍微猜测一下；当您说它不起作用时，您是指收件人看不到请求的情况吗？

如果是这样，则可能您尚未配置 Canvas 应用程序（即通过 apps.facebook.com/something 访问您的应用程序的方式） - 请求仅对移动或画布应用程序有效，否则将被隐藏。

有关更多信息，请参阅[https://developers.facebook.com/docs/requests/ ：](https://developers.facebook.com/docs/requests/)

> 用户对用户请求仅适用于 Canvas 应用程序，而不是网站，因为接受请求会将用户定向到发送请求的应用程序的 Canvas 页面 URL。

# php - PHP 中的 simpleXML 从 XML 文档中的嵌套命名空间读取元素

> ID：10402112
> 
> 赞同：0
> 
> 时间：2012-05-01T18:10:29.330
> 
> 标签：php, xml, namespaces, simplexml

我难住了。我在一个文件中有以下 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<grant:GrantApplication xmlns:grant="http://apply.grants.gov/system/MetaGrantApplication" xmlns:globLib="http://apply.grants.gov/system/GlobalLibrary-V1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://apply.grants.gov/system/MetaGrantApplication http://apply07.grants.gov/apply/opportunities/schemas/agency/oppEPA-R5-GL2011-1-cfda66.469.xsd">
    <grant:Forms>
        <EPA_KeyContacts:KeyContactPersons xmlns:EPA_KeyContacts="http://apply.grants.gov/forms/EPA_KeyContacts-V1.1" EPA_KeyContacts:FormVersion="1.1">
            <EPA_KeyContacts:AuthorizedRepresentative>
                <globLib:Name xmlns:globLib="http://apply.grants.gov/system/GlobalLibrary-V2.0">
                    <globLib:FirstName>Jane</globLib:FirstName>
                    <globLib:LastName>Doe</globLib:LastName>
                </globLib:Name>
            </EPA_KeyContacts:AuthorizedRepresentative>
        </EPA_KeyContacts:KeyContactPersons>
        <EPA4700_4_2_0:EPA4700_4_2_0 xmlns:EPA4700_4_2_0="http://apply.grants.gov/forms/EPA4700_4_2_0-V2.0" EPA4700_4_2_0:FormVersion="2.0">
            <EPA4700_4_2_0:ApplicantInfo>
                <EPA4700_4_2_0:ApplicantName>ABC 123</EPA4700_4_2_0:ApplicantName>
                <EPA4700_4_2_0:ApplicantAddress>
                    <EPA4700_4_2_0:Address>123 Street</EPA4700_4_2_0:Address>
                    <EPA4700_4_2_0:City>Buffalo</EPA4700_4_2_0:City>
                    <EPA4700_4_2_0:State>NY: New York</EPA4700_4_2_0:State>
                    <EPA4700_4_2_0:ZipCode>12345</EPA4700_4_2_0:ZipCode>
                </EPA4700_4_2_0:ApplicantAddress>
            <EPA4700_4_2_0:ApplicantInfo>
        <EPA4700_4_2_0:EPA4700_4_2_0 xmlns:EPA4700_4_2_0="http://apply.grants.gov/forms/EPA4700_4_2_0-V2.0" EPA4700_4_2_0:FormVersion="2.0">
        <SF424_2_1:SF424_2_1 xmlns:SF424_2_1="http://apply.grants.gov/forms/SF424_2_1-V2.1" SF424_2_1:FormVersion="2.1">
            <SF424_2_1:ContactPerson>
                <globLib:FirstName xmlns:globLib="http://apply.grants.gov/system/GlobalLibrary-V2.0">Jane</globLib:FirstName>
                <globLib:LastName xmlns:globLib="http://apply.grants.gov/system/GlobalLibrary-V2.0">Doe</globLib:LastName>
            <SF424_2_1:ContactPerson>
        <SF424_2_1:SF424_2_1>
    </grant:Forms>
</grant:GrantApplication> 
```

在 PHP 中使用 SimpleXML，我有以下代码：

```
$xml = simplexml_load_file($appdir);

$xml->registerXPathNamespace("grant","http://apply.grants.gov/system/MetaGrantApplication");
$xml->registerXPathNamespace("header","http://apply.grants.gov/system/Header-V1.0");
$xml->registerXPathNamespace("globLib","http://apply.grants.gov/system/GlobalLibrary-V2.0");
$xml->registerXPathNamespace("EPA_KeyContacts","http://apply.grants.gov/forms/EPA_KeyContacts-V1.1");
$xml->registerXPathNamespace("SF424A","http://apply.grants.gov/forms/SF424A-V1.0");
$xml->registerXPathNamespace("SF424_2_1","http://apply.grants.gov/forms/SF424_2_1-V2.1");
$xml->registerXPathNamespace("EPA4700_4_2_0","http://apply.grants.gov/forms/EPA4700_4_2_0-V2.0");

$rawContactFirstName = $xml->xpath("/grant:GrantApplication/grant:Forms/SF424_2_1:SF424_2_1/SF424_2_1:ContactPerson/globLib:FirstName");
$contactFirstName = $rawContactFirstName[0];

$rawContactLastName = $xml->xpath("/grant:GrantApplication/grant:Forms/EPA_KeyContacts:KeyContactPersons/EPA_KeyContacts:AuthorizedRepresentative/globLib:Name/globLib:LastName");
$contactLastName = $rawContactLastName[0];

$rawStreetAddress = $xml->xpath("/grant:GrantApplication/grant:Forms/EPA4700_4_2_0:EPA4700_4_2_0/EPA4700_4_2_0:ApplicantInfo/EPA4700_4_2_0:ApplicantAddress/EPA4700_4_2_0:Address");
$streetAddress = $rawStreetAddress[0];

$rawCity = $xml->xpath("/grant:GrantApplication/grant:Forms/EPA4700_4_2_0:EPA4700_4_2_0/EPA4700_4_2_0:ApplicantInfo/EPA4700_4_2_0:ApplicantAddress/EPA4700_4_2_0:City");
$city = $rawCity[0];

$rawState = $xml->xpath("/grant:GrantApplication/grant:Forms/EPA4700_4_2_0:EPA4700_4_2_0/EPA4700_4_2_0:ApplicantInfo/EPA4700_4_2_0:ApplicantAddress/EPA4700_4_2_0:State");
$state = $rawState[0];

$rawZip = $xml->xpath("/grant:GrantApplication/grant:Forms/EPA4700_4_2_0:EPA4700_4_2_0/EPA4700_4_2_0:ApplicantInfo/EPA4700_4_2_0:ApplicantAddress/EPA4700_4_2_0:ZipCode");
$zip = $rawZip[0];

echo $contactFirstName."<br>".
     $contactLastName."<br>".
     $streetAddress."<br>".
     $city."<br>".
     $state."<br>".
     $zip."<br>"; 
```

我得到以下输出：

**注意：未定义的偏移量：第 105 行的 file.php 中的 0 注意：未定义的偏移量：第 108 行的 file.php 中的 0**

**123街**

**水牛**

**纽约：纽约**

**12345**

第 105 行引用 $rawContactFirstName[0] 和第 108 行引用 $rawContactLastName[0]

名字和姓氏在文档中出现了两次，由于引用 globLib 命名空间的方式不同，我从第一次出现引用姓氏，从第二次出现引用名字。

我无法使用 globLib 命名空间从任何元素中获取任何信息，我不明白为什么。只要不使用 globLib 命名空间，我就可以从文档中获取任何其他信息。

$xml->xpath(); 应该返回一个数组。考虑以下：

```
print_r($rawContactFirstName); 
```

输出： **数组 ( )**

```
var_dump($rawContactFirstName);
var_dump($rawContactFirstName[0]); 
```

输出： **数组（0）{}**

我不明白所有其他命名空间如何可以毫无问题地返回数据，除了这个使用完全相同的技术。根据[http://validator.w3.org/，XML](http://validator.w3.org/)文档是有效的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:47:12.033

尝试更改此行：

```
$xml->registerXPathNamespace("globLib","http://apply.grants.gov/system/GlobalLibrary-V2.0"); 
```

至：

```
$xml->registerXPathNamespace("globLib2","http://apply.grants.gov/system/GlobalLibrary-V2.0"); 
```

（或您想使用的任何唯一前缀）。

然后在你的 xpath 中引用它：

```
$rawContactFirstName = $xml->xpath("/grant:GrantApplication/grant:Forms/SF424_2_1:SF424_2_1/SF424_2_1:ContactPerson/globLib2:FirstName"); 
```

我认为正在发生的事情是前缀“globLib”已经在文档元素中使用不同的 URI 注册，这有点令人困惑`registerXPathNamespace`。

作为旁注，您发布的 XML 似乎无效。它有一堆未封闭的标签和用开放标签“封闭”的标签——所以我还要确保你使用的任何 XML**都是**有效的。

# jquery - 尝试构建 jquery intersital div，但单击链接时没有任何操作

> ID：10402115
> 
> 赞同：1
> 
> 时间：2012-05-01T18:10:42.193
> 
> 标签：jquery

我正在尝试使用 jquery 构建以下操作：当用户单击链接时，mainContent div 被隐藏并显示 exitSite 消息。然后用户有两个选择：返回主要内容或继续并离开站点。

当前问题：单击将离开站点的链接时，没有任何反应。

这是我到目前为止的代码：

jQuery：

```
$(function(){

if($('div#exitSite'))
{
    var mydomain$ = location.hostname;
    var links = $('a').each(function()
    {
        if((this.href.indexOf("mySiteDomain")==-1) && (this.href.indexOf(mydomain$)==-1) && (this.href.indexOf("javascr")==-1))
            $(this).addClass('exit');
    });

    /*Off site links.*/     
    $('a.exit').live('click', function (e) {
        e.preventDefault(); //stop the click from going through.
        var page = $(this).attr("href") //get destination page
        var pagetitle = $(this).attr("title")

        $('#mainContent').hide(); //hide main content window
        $('#mainContent').show(); //show main content window

        $('#exitSiteClose').click(function() { 
            $('#exitSite').hide();
            $('#mainContent').show();
            return false
            }); // end click #exitSiteClose

        $('#exitSiteContinue').click(function() {
            window.location=page
            //if user selects the continue button, then pass in the destination page from link.
            }); // end click #exitSiteContinue      
    });// end click a.exit  
}
}); 
```

的HTML：

离开网站的链接： [点击到 stackoverflow.com](http://www.stackoverflow.com)

出口站点 div：

```
<div id="exitSite">
<h2>Hello!</h2>
<p><strong>You are leaving this website</strong></p>
    <div class="buttonContainer">
    <a href="#" id="exitSiteClose" class="btn-gray">Cancel</a>
    <a href="#" id="exitSiteContinue" class="btn-blue">Continue</a>
</div><!-- /.buttonContainer -->
</div><!-- /#exitSite --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:22:58.257

您的代码中有一个基本的错字。你根本没有显示你的`#exitSite`div ：

```
$('#mainContent').hide(); //hide main content window
$('#mainContent').show(); //show main content window 
```

需要是：

```
$('#mainContent').hide(); //hide main content window
$('#exitSite').show(); //show exit confirmation window 
```

演示：http: [//jsfiddle.net/jtbowden/fhFxU/1/](http://jsfiddle.net/jtbowden/fhFxU/1/)

为了调试，我`console.log("debug")`在点击处理程序内部使用并在 FireBug 中观察是否正在调用点击处理程序。然后我在脑海中逐步执行该函数，看看会发生什么。就在那时我注意到你从来没有显示你的退出确认。

作为旁注，您在处理程序中的变量定义之后还缺少几个分号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:17:01.400

您可以简单地使用 JavaScript [`confirm()`](https://developer.mozilla.org/en/DOM/window.confirm)。它并不时尚，但它是做你想做的最普遍的方式。

```
$('a[href^="http://"]').on('click', function(e) { // apply to all external URLs
    return window.confirm('Are you sure you want to leave this site?');
}); 
```

从广义上讲，任何`return false;`来自点击处理程序的 JavaScript 函数都将取消该点击，并`return true;`允许它继续。

一种侵入性较小且更常见的方法是添加`target="_blank"`到任何外部链接。这将在新选项卡/窗口中打开该链接，使您的网站在单独的选项卡/窗口中打开。

# android - 主要活动开始延迟

> ID：10402116
> 
> 赞同：3
> 
> 时间：2012-05-01T18:10:49.453
> 
> 标签：android, delay, android-activity, launch

当我开始我的活动时，我注意到一个短暂的延迟。我点击我的应用程序图标，主屏幕会在屏幕上停留大约 1-1.5 秒，然后才会显示我的活动。

我的活动的 onCreate 方法大约需要 800 毫秒才能完成。

我还注意到`android:screenOrientation="landscape"`，即使我使用带有空布局的测试活动，设置也会增加明显的延迟。

有没有办法摆脱这种延迟，或者至少在加载 UI 时显示黑屏？

已编辑：请参阅下面的测试活动代码。在我的实际活动中，还有许多其他加载，包括 GUI 元素和引擎逻辑、声音等。真正的问题是即使使用这个小型测试活动，延迟也是可见的。

* * *

测试活动代码：

```
public class TestActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Set full screen mode and disable
        // the keyguard (lockscreen)
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().addFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN  
                             | WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD 
                             | WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED
                             | WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);

        setContentView(R.layout.main);
    }
} 
```

布局 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:keepScreenOn="true"  >
</FrameLayout> 
```

显现：

```
<activity
    android:name=".TestActivity"
    android:configChanges="orientation|keyboardHidden"
    android:label="@string/app_name"
    android:screenOrientation="landscape"
    android:windowSoftInputMode="stateAlwaysHidden|adjustPan" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />

        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:52:36.017

您可以将默认活动设置为接近空白的活动，该活动仅显示背景并开始您的真实活动..就像启动屏幕一样

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-03T11:44:51.487

Ans Drake 给出的是完美的，但可以扩展它 - 让您想要让您的自定义初始屏幕图像始终可见，如果我们将颜色应用于窗口，那么将从颜色切换到实际斜线屏幕。这可能是一个糟糕的用户体验。我建议的 ans 不需要 setContentView，而只需要通过主题管理启动画面。

我们无法在 java 中设置主题，因为在我的情况下，控件很晚才出现在我的启动活动的 onCreate 中。直到那时黑屏仍然可见。

这让我想到必须从我们在清单中指定的主题管理窗口。

我有一个清单：

```
<activity
        android:name=".main.activities.SplashScreen"
        android:theme="@style/Splash"
        android:screenOrientation="portrait">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
</activity> 
```

现在我创建的主题如下：

```
<style name="Splash" parent="@style/Theme.AppCompat.Light">
    <item name="android:windowBackground">@drawable/splash</item>
    <item name="android:windowNoTitle">true</item>
    <item name="windowNoTitle">true</item>
    <item name="colorPrimaryDark">@color/green_09</item>
    <item name="colorPrimary">@color/green_09</item>
    <item name="windowActionBar">false</item>
</style> 
```

在包含位图资源的可绘制资源中飞溅，我必须进行一些调整以使其看起来完美而不是拉伸并位于中心：

```
<bitmap xmlns:android="http://schemas.android.com/apk/res/android"
    android:antialias="true"
    android:dither="true"
    android:gravity="fill"
    android:src="@drawable/splash_screen" /> 
```

# ruby-on-rails - 如何将两个或多个咖啡脚本文件与重复的函数名称合并在一起？

> ID：10402119
> 
> 赞同：0
> 
> 时间：2012-05-01T18:10:57.377
> 
> 标签：ruby-on-rails, file, merge, coffeescript

我正在尝试将我的所有咖啡脚本文件合并到我的 rails 3.1 资产管道网站上，以便开发页面可以更快地加载。我从 28 秒缩短到 6 秒。但是以前唯一的本地函数名称现在都在同一个文件中，并且会出现重复。我想保持相同的函数名称，但在某种命名空间内。

这是几个示例文件。

文件 a.js.coffee

```
root = exports ? this

$(document).ready -> 
  sayHi()

root.sayHi = ->
  greeting()

greeting = ->
  alert("Howdy") 
```

文件 b.js.coffee

```
root = exports ? this

$(document).ready -> 
  sayHello()

root.sayHello = ->
  greeting()

greeting = ->
  alert("Hi there") 
```

我怎样才能将这两个文件的内容连接在一起，并且仍然保留这两个独立的`greeting`功能？

新文件 ab.js.coffee

```
#------------------
# from a.js.coffee
#------------------

root = exports ? this

$(document).ready -> 
  sayHi()

root.sayHi = ->
  greeting()

greeting = ->
  alert("Howdy")

#------------------
# from b.js.coffee
#------------------

root = exports ? this

$(document).ready -> 
  sayHello()

root.sayHello = ->
  greeting()

greeting = ->
  alert("Hi there") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:59:31.043

命名函数的一种方法是仅使用对象。

```
#------------------
# from a.js.coffee
#------------------

a = 
  sayHi: ->
    @greeting

  greeting: ->
    console.log('a')
    alert("Howdy")

#------------------
# from b.js.coffee
#------------------

b = 
  sayHello: ->
    @greeting

  greeting: ->
    console.log('b')
    alert("Hi there")

#------------------
# initializer
#------------------

$(document).ready -> 
  a.sayHi()
  b.sayHello()
  return 
```

# linux - 如何获得进程的同步锁

> ID：10402124
> 
> 赞同：0
> 
> 时间：2012-05-01T18:12:06.220
> 
> 标签：linux, linux-kernel

我需要检查一个进程正在使用多少锁（互斥锁等）。有人知道Linux上的任何命令来检查它吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T08:37:20.150

你如何定义“使用”？你的意思是持有互斥锁？互斥锁可以在共享内存中分配，并由一个进程初始化，但由另一个进程使用（锁定/解锁）。在这种情况下，基本上没有命令可以判断。

# testing - 如何/在 BDD 中模拟什么

> ID：10402130
> 
> 赞同：22
> 
> 时间：2012-05-01T18:12:30.883
> 
> 标签：testing, bdd, acceptance-testing

我知道 Dan​​ North 设计 BDD 的意图之一是让词汇表远离测试领域的复杂性。但是，在实现由外向内的方法时，我们似乎仍然需要对模拟行为（或存根行为，如果您愿意的话）有所了解。North 在[此视频](http://www.infoq.com/presentations/bdd-dan-north)中建议，如果我从最外层的域对象开始，然后向内工作，我会在发现协作者时模拟它们，然后用适当的实现替换它们。所以最后，我得到了一组端到端的测试。

[Martin Fowler 在这篇博](http://martinfowler.com/articles/mocksArentStubs.html)文中定义了 TDD 的两个阵营时似乎对此有所不同：“经典 TDD”尽可能使用真实对象，必要时使用模拟，以及“模拟 TDD”，在大多数情况下更喜欢模拟。他认为 BDD 倾向于后者。即，在开发功能结束时，“mockist”方法会在实际测试中留下模拟（抱歉在 BDD 讨论中使用该词）。

公平地说，这两种材料都有多年的历史了，也许随着 BDD 在单元级别应用和接受级别之间的界限发展，事情变得更加清晰。

**但我对社区的问题基本上是：当我的故事完成后，我的场景实际上应该进行多少端到端测试？** North[解释](http://www.infoq.com/interviews/dan-north-bdd)说 BDD 需要抽象。例如，当我测试登录行为时，我的场景将详细说明登录过程的含义。但是，当我在做其他一些*需要但不是关于*登录的场景时，我不想一遍又一遍地执行这些步骤。我想要一个简单的抽象，简单地说“假设我已登录”，这样我就可以执行我的其他行为。

因此，我的抽象方法似乎是模拟某些合作者（或提供“测试替身”），并且某些场景可能比其他场景更多地使用它们。例如，我是否总是模拟外部资源，例如数据库或邮件服务器？

也许我问错了问题。BDD 就是关于沟通、缩短反馈周期和发现你不知道的东西。只要我们感兴趣的行为确实有效，也许什么和什么不嘲笑是一个无关紧要的问题。我很好奇其他人的方法是什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-05T21:24:25.353

对我来说，BDD 允许我验证我是否构建了正确的东西。这意味着如果我将我的应用程序插入一个真实的数据库并使用真实的 UI，它应该可以正常运行。这就是你所说的端到端。

现在，如果我将我的应用程序插入到内存存储中，并通过其 API 级别（就在 UI 下方）与应用程序对话。我希望它的行为方式完全相同。

事情就是这样，我们需要清楚我们所说的行为是什么意思，当我们做 BDD 时，我们感兴趣的行为是什么。

就我而言，如果我从用户故事开始并编写场景，我主要对通过我的应用程序 API、服务层、域实体、帮助程序等的行为感兴趣……主要是我不太感兴趣在 UI 或数据库中会发生什么。真正的肉是在服务器端编写的所有代码。这就是我感兴趣的行为。如果你这样认为，摆脱 UI 和 DB 是有意义的，因为我们不关心这些人。UI 的预期行为是显示我的应用程序提供的数据。用户界面是一个愚蠢的东西。数据库的预期行为是存储和检索我的应用程序提供或想要的实体。这也是一件非常愚蠢的事情。现在其他一切，这就是所有的聪明之处，我负责。

所以我很乐意在没有 UI 的情况下运行我的 BDD 场景，并使用我的存储库的内存版本。我从中获得的好处是非常快速、专注和可维护的测试。

关于 UI 和 DB，我会编写 javascript 单元测试来测试那里的行为，今天一些 UI 可以有很多显示逻辑来隐藏和显示东西，但这种行为与我的用户故事 bdd 中的行为不同场景（他们不应该谈论 UI）。

对于数据库，我编写集成测试只是为了检查我的真实存储库是否能够在数据库上读取和写入内容。

最后我只写了几个端到端的测试来检查连接在一起时一切是否正常。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-25T15:22:04.117

我认为关键是关注 BDD 的 B - 行为。

目前我倾向于忽略 UI 元素并模拟掉持久层——毕竟这些天在这些层中几乎没有业务逻辑（我们倾向于使用预先存在的和直接将对象模型绑定到 UI 或 DB）经过大量测试的框架）。

作为示例，在我正在构建的最近（简单）WPF 应用程序中：验收测试使用 ViewModel 作为应用程序的入口/外部点 - 并且从数据存储库中的所有内容都被模拟了。应用程序的所有规则和逻辑都存在于两者之间——实际上，这些是需要指定和测试的应用程序行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T17:15:15.527

模拟什么取决于架构。对于 MVVM，您可以模拟模型来测试视图模型。对于 MVP，您可以模拟视图和/或模型来测试演示者。如果您想编写端到端测试而不是单元测试，那么您可以通过视图模型/演示器测试到应用程序的另一端（服务/数据库层）。

# php - 对数据库中单词的实例进行排序和计数

> ID：10402131
> 
> 赞同：1
> 
> 时间：2012-05-01T18:12:33.320
> 
> 标签：php, string

我使用了以下问题[php: sort and count instances of words in a given string](https://stackoverflow.com/questions/2984786/php-sort-and-count-instances-of-words-in-a-given-string)

我的数据库中有一个带有文本字段的表，并且想对该字段中的单词进行一些分析，但我需要合并结果

```
ID | Text Field
1  | happy beautiful happy lines pear gin happy lines rock happy lines pear 
2  | happy lines pear gin happy lines rock happy lines pear 
```

我现在有一个看起来像这样的数组（但它的每行）

第 1 行

```
Array (
    [happy] => 4
    [beautiful] => 1
    [lines] => 3
    [pear] => 2
    [gin] => 1
    [rock] => 1 ) 
```

第 2 行

```
Array (
    [happy] => 4
    [lines] => 3
    [pear] => 2
    [gin] => 1
    [rock] => 1 ) 
```

如何对所有行执行此操作以组合结果 - 数据库中有 30000 行文本

预期成绩：

```
Array (
    [happy] => 8
    [beautiful] => 1
    [lines] => 6
    [pear] => 4
    [gin] => 2
    [rock] => 2 ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:16:21.447

当您从数据库中获取每一行时，请保持运行总计

```
$total = array();
foreach($row as $word=>val){
    if(!isset($totals[$word])) $totals[$word] = 0;
    $totals[$word] += $val;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T18:43:17.290

我手头没有你的数据库，所以我将通过一个数组来演示：

```
[ghoti@pc ~]$ cat doit.php
#!/usr/local/bin/php
<?php

$a=array(
  '1' => "happy beautiful happy lines pear gin happy lines rock happy lines pear",
  '2' => "happy lines pear gin happy lines rock happy lines pear",
  '3' => "happy rock pear happy happy happy",
);

$wordlist=array();

foreach ($a as $index => $line) {
  foreach (explode(" ", $line) as $word) {
    $wordlist[$word]++;
  }
}

print_r($wordlist);

[ghoti@pc ~]$ ./doit.php
Array
(
    [happy] => 11
    [beautiful] => 1
    [lines] => 6
    [pear] => 5
    [gin] => 2
    [rock] => 3
)
[ghoti@pc ~]$ 
```

要使这适用于您的用例，请用`foreach()`遍历您的表的 while 循环替换：

```
$sql = "SELECT id,wordlist FROM yadda";
$result = db_query($sql);
while ($row = db_fetch_row($result)) {
  ...
} 
```

我不知道您使用的是什么数据库服务器，所以我无法提供我知道适用于您的具体示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T18:17:16.813

我会这样做：创建一个名为 words 的新表，将每一行从数据库中拉出，循环遍历它并分解字符串并将每个单词插入数据中，可选择存储诸如主表 id 之类的数据，这样你就可以得到关于上下文或单词的大多数附加统计信息，如果您处理许多行和大型数据集，这可能不是最佳选择

然后你可以使用 sql 来建立你的计数等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T18:27:31.313

您可以使用 SQL 直接计算字数。看看这个之前的回答：

[使用 SQL 确定文本字段的字数统计](https://stackoverflow.com/questions/748276/using-sql-to-determine-word-count-stats-of-a-text-field)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T18:34:32.370

PHP 数组可以用作地图。因此，您所要做的就是获取每一行的数据，维护一个单词数组映射作为键，并将它们的计数作为值。每次看到密钥存在时，只需添加到计数中，否则添加具有相应计数的新键。

```
$grandtotal = array();
foreach($row as $key=>$val) {
 if(array_key_exists($key, $grandtotal)) {
  $grandtotal[$key] += $val;
 }
 else {
  $grandtotal[$key] = $val;
 }
} 
```

# drupal-7 - Drupal 7：视图 3：仅显示当前用户的个人资料信息

> ID：10402135
> 
> 赞同：1
> 
> 时间：2012-05-01T18:12:56.500
> 
> 标签：drupal-7

我正在使用 Drupal 7.12 和 Views 3.3，我想创建一个 Views 块放在页面上，以显示他们添加到一组自定义配置文件字段中的当前登录用户信息。我创建了字段。意见是问题。

我能够创建一个显示配置文件字段内容的视图块，但它列出了以下内容： 每个在这些字段中输入任何数据的用户的 1 个数据块，并将其显示给所有人。我只希望它显示当前登录的用户他们自己的数据。

我发现一些提到为“用户：当前”添加过滤器，但我没有这个块的这个选项。然后我在这里找到了这个项目：

[Drupal 7 Views 3 user：缺少当前过滤器？](https://stackoverflow.com/questions/7420031/drupal-7-vews-3-usercurrent-filter-is-missing)

说我需要先添加“内容：作者”的关系，然后我可以添加“用户：当前”过滤器。我也无法做到这一点。

所以，我决定创建一个新的 Views 块，看看我是否能弄清楚为什么这些选项对我不可用。创建新视图块时，您要做的第一件事就是选择要“显示”的内容，并且有一个“内容”选项，还有一个“配置文件”选项（以及其他几个），但没有办法在此处选择多个选项。在我选择“个人资料”以显示内容之前创建的第一个视图块中，这会删除与内容或其他任何内容相关的所有选项，这就是为什么我无法建立“内容：作者”的关系。我不是在处理内容节点。当我创建第二个视图块来测试它时，我选择了“显示：内容”，并且能够创建“内容：作者”关系，然后我能够添加“用户：当前”过滤器。但是在这个视图块中，我无法显示配置文件字段信息。

非常感谢这里的任何帮助！

2012 年 5 月 2 日：在基于“个人资料”的“视图”块中添加对我可用的过滤器和关系设置的信息。

**过滤器选项：**

*配置文件：更改日期 - 配置文件最近更新的日期。

*配置文件：创建日期 - 创建配置文件的日期。

*个人资料：标签 - 个人资料标签。

*个人资料：位置 (field_location_us) - 出现在：profile2:main。

*配置文件：主要问题 (field_issue_area_primary) - 出现在：profile2:main。

*个人资料：个人资料 ID - 个人资料的唯一 ID。

*配置文件：总运营预算 (field_total_op_budget) - 出现在：profile2:main。

*个人资料：组织员工总数 (field_total_staff) - 出现在：profile2:main。

*个人资料：技术人员总数 (field_staff_tech) - 出现在：profile2:main。

*配置文件：总技术/IT 预算：(field_budget_tech_total) - 出现在：profile2:main。

*配置文件：类型 - 配置文件类型。

*个人资料：用户 uid - 个人资料的所有者。

**添加关系选项：**

*配置文件：类型 - 配置文件类型。

*个人资料：用户 uid - 个人资料的所有者。

两个列表中的最后一项（个人资料：用户 uid）似乎是一个显而易见的选择，但是当我尝试时，无论从哪个列表中，我的视图块都没有显示任何信息，即使我确实填写了信息。实际上每个过滤器和/或到目前为止我尝试过的关系设置会导致一个空的 Views 块。我确定我缺少一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T23:03:49.567

我还在 Drupal 论坛上发布了这个，作为对 Views 模块的支持请求，我在那里得到的信息让我找到了正确的答案，我也想在这里分享它，以防它帮助其他人。我在 Drupal 论坛上的帖子：[https ://drupal.org/node/1558544](https://drupal.org/node/1558544)

这是我必须做的（从我的视图块的编辑屏幕开始）：

1）高级（展开右侧部分） 2）关系 [添加] 3）选择“配置文件：用户 uid”并应用 4）下一个屏幕是“配置关系：配置文件：用户 uid” - 标识符（管理标签）框是预填充“用户”（此处未进行任何更改）-选中“需要此关系”框-应用（保存）

5）转到“过滤条件”，然后单击“添加”按钮 6）选中“用户：当前”*，然后单击底部的“应用”按钮 7）下一个屏幕是“配置过滤条件：用户：当前” - “关系”（下拉框有一个选项）：[用户] - “是否登录用户：”（是/否按钮）：选择“是” - 应用（保存）

8) 在主视图屏幕上，一定要保存它以便在网站上实时工作。

9）它工作。我现在只能在此视图块中看到当前登录用户的信息！

*   以前，我从来没有完全正确地完成此配置，因为我从未见过“用户：当前”选项。

非常感谢您引导我回答！

~克里斯汀

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:43:22.613

我从您的问题中了解到的是您已经设置了字段，但结果适用于所有用户。因此，大部分事情已经完成，您只需要添加链接中提到的当前用户的关系。

它的作用是只显示登录的用户数据。在 drupal 内部，我们得到一个全局变量 $user，当您添加关系时，它将被添加到块视图中。

您可以在高级选项卡内的视图块设置的右侧找到该内容。如果是第一次使用，可能会折叠，需要展开。

# java - 在拆分时捕获所有以“[[”开头并以“]]”结尾的字符串作为正则表达式

> ID：10402138
> 
> 赞同：2
> 
> 时间：2012-05-01T18:13:20.917
> 
> 标签：java, regex, scala

目前我正在使用`str.toLowerCase.split("[\\s\\W]+")`摆脱空白和标点符号，但有一类特殊的字符串我想保留并排除在这种处理之外：

```
[[...multiple words...]] 
```

例子：

```
[[Genghis Khan]] 
```

应保持为

```
[[Genghis Khan]] 
```

我应该使用哪种正则表达式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T18:34:51.823

您的正则表达式并不遥远：

```
def tokenize(s: String) = """\w+|(\[\[[^\]]+\]\])""".r.findAllIn(s).toList 
```

接着：

```
scala> tokenize("[[Genghis Khan]] founded the [[Mongol Empire]].")
res1: List[String] = List([[Genghis Khan]], founded, the, [[Mongol Empire]]) 
```

不过，这是 Scala 的[解析器组合](http://www.scala-lang.org/api/current/scala/util/parsing/combinator/package.html)器的一个很好的用例：

```
import scala.util.parsing.combinator._

object Tokenizer extends RegexParsers {
  val punc = "[,;:\\.]*".r
  val word = "\\w+".r
  val multiWordToken = "[[" ~> "[^\\]]+".r <~ "]]"
  val token = (word | multiWordToken) <~ punc
  def apply(s: String) = parseAll(token+, s)
} 
```

这同样给了我们：

```
scala> Tokenizer("[[Genghis Khan]] founded the [[Mongol Empire]].").get
res2: List[String] = List(Genghis Khan, founded, the, Mongol Empire) 
```

我个人更喜欢解析器组合器版本——它实际上是自记录的，并且更容易扩展和维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T21:26:14.670

拆分不是处理这个问题的方法，因为它不处理上下文。你可能这样写：

```
str.toLowerCase.split("(?<!\\[\\[([^]]|\\][^]])*\\]?)[\\s\\W]+") 
```

它会在任何前面没有`[[`后面跟着除 之外的任何空间上拆分`]]`，但 Java 不喜欢可变大小的后视。

在我看来，处理这个问题的最好方法是为它编写一个解析器，除非你真的需要速度。使用像[Travis Brown](https://stackoverflow.com/users/334519/travis-brown)建议的正则表达式（他还在他的[回答](https://stackoverflow.com/a/10402396/53013)中展示了一个解析器）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T18:25:36.170

`[[`这是一个首先在或上拆分的函数`]]`。这样做可确保拆分项在未引用字符串和引用字符串之间交替（即，第二个、第四个等项被“引用”）。然后我们可以遍历这个列表并在空白处拆分任何未引用的项目，同时保留引用的项目不变。

```
def mySplit(s: String) = 
  """(\[\[)|(\]\])""".r.split(s).zipWithIndex.flatMap { 
    case (unquoted, i) if i%2==0 => unquoted.trim.split("\\s+")
    case (quoted, _) => List(quoted)
  }.toList.filter(_.nonEmpty)

mySplit("this [[is]] the first [[test string]].") // List(this, is, the, first, test string, .)
mySplit("[[this]] and [[that]]")          // List(this, and, that)
mySplit("[[this]][[that]][[the other]]")  // List(this, that, the other) 
```

如果你想`[[ ]]`在最终输出中，那么只需将上面的内容更改`List(quoted)`为`List("[[" + quoted + "]]")`

# java - JTable 绑定避免默认值

> ID：10402142
> 
> 赞同：0
> 
> 时间：2012-05-01T18:13:31.060
> 
> 标签：java, swing, data-binding, jtable

我正在使用 Java bean 绑定来绑定 Jtable，其中 api 为整数或浮点值提供默认值，例如 0 或 0.0，如下所示。我想避免使用相应的默认值并将单元格设置为空，除了最后一个单元格值.

```
1        WW     88.0        88.0      1021021       340.0       
4        TT     55.0        55.0      1021021       340.0       
5        PP     66.0        66.0      1021021       340.0

                0            0          0           1020

2        gg     66.0        66.0      1021022       320.0       
3        LL     658.0       652.0     1021022       320.0

               0            0          0             640 
```

桌子应该看起来像..

```
1        WW     88.0        88.0      1021021       340.0       
4        TT     55.0        55.0      1021021       340.0       
5        PP     66.0        66.0      1021021       340.0

                                                    1020

2        gg     66.0        66.0      1021022       320.0       
3        LL     658.0       652.0     1021022       320.0

                                                     640 
```

任何可以提出解决此问题的更好方法的人，都将非常完整，并在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:27:35.010

我建议这应该在 中完成`TableModel`，特别是使用该`getValueAt(int row, int column)`方法。就像是：

```
public Object getValueAt(int rowIndex, int columnIndex){
  Object cellValue = // get your values out of your Beans...
  if (cellValue==0 && columnIndex!=LAST_COLUMN_INDEX){
    return null;
  }
  return cellValue;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:42:02.450

我假设此问题陈述的第一列是空白的

您可以覆盖该`TableModel` `getValueAt(int row, int column)`方法。

```
@Override
public Object getValueAt(int row, int column){
  Object value = super.getValueAt(row, column);//Or get it from the Vector defined
  if(column == 2) {//Demo for the third column do same for other columns
    //Check the value in the first column if it is coming null
    if (null == getValueAt(row, 0) || getValueAt(row, 0) == ""){
      return null; // null means blank cell
    }
  }
  return value;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T11:29:46.410

我正在使用 Jtable beans 绑定并使用 beansbinding-1.2.1.jar api 进行自动绑定。我下载了 beansbinding-1.2.1.jar 源并在类中进行了相关更改

/org.jdesktop.swingbinding.JTableBinding.java

```
containing the class BindingTableModel.java which implements the TableModel and I overridden the method as per the suggestions of above two friends and thanks to all... 
```

@覆盖

```
public Object getValueAt(int row, int column) {
            Object value = valueAt(row, column);

            if (value != null
                    && (value.toString().equals("0") || value.toString()
                            .equals("0.0")|| value.toString().equals("default"))) {
                return null;
            }

            return value;
        } 
```

# api - Soundcloud API：是否可以获取我的收藏夹的“播放列表/设置”数据？

> ID：10402143
> 
> 赞同：2
> 
> 时间：2012-05-01T18:13:31.680
> 
> 标签：api, playlist, soundcloud, favorites

我正在构建一个应用程序，我已经成功地创建和显示上传到帐户的曲目的“集合”/播放列表，但是我希望能够获得其他用户的曲目列表的类似数据我已添加到我的收藏夹。

这可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T18:30:01.810

查看文档中的子资源部分：[http :](http://developers.soundcloud.com/docs/api/users) **//developers.soundcloud.com/docs/api/users**

如果您知道用户 ID，则可以使用以下方法获取他们的曲目/播放列表。

```
/users/{id}/tracks

/users/{id}/playlists

/users/{id}/favorites 
```

# php - html表单提交的JavaScript错误

> ID：10402147
> 
> 赞同：1
> 
> 时间：2012-05-01T18:13:45.003
> 
> 标签：php, javascript

```
function formv(frm){

    alert(frm.username.value);

    document.myform.submit();
}

<form action="http://localhost/CI/index.php/scontr/logs" method="post" name="myform">
        <fieldset>
        <table>
            <tr>
                <td>UserID:</td>
                <td><input type="text" name="username" maxlength="30" value="" /></td>
            </tr>
            <tr>
                <td>Password:</td>
                <td><input type="password" name="password" maxlength="30" value="" /></td>
            </tr>

                            <tr><td>
                            <select name="myselect">
                            <option value="one" >Teacher</option>
                            <option value="two" >Student</option>
                            </select></td>
                            </tr>

            <tr>

                <td colspan="2"><input type="button" name="submit" onclick="formv(this.form)" value="Login" /></td>
            </tr> 
```

谁能告诉我为什么上面的表格没有张贴在以下地址。显示警告框，但随后什么也没有发生。它仍然在同一页面中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:21:30.337

您需要将提交按钮重命名为其他名称，因为`document.myform.submit`现在引用的是按钮而不是提交操作。

改变

```
name="submit" 
```

到

```
name="btnSubmit" 
```

# css - 如何维护json文件中的字体样式？

> ID：10402151
> 
> 赞同：0
> 
> 时间：2012-05-01T18:14:02.627
> 
> 标签：css, json, spry

我正在尝试将 spry(dreamweaver) 表转换为 json 文件。json 文件工作正常，但我不知道如何读取一段文本（字符串）并保持段落的样式。我在每个段落数组中混合了粗体、斜体和下划线。{description}

有谁知道这是怎么做到的？

似乎文本样式必须是可能的，但我是 json 新手，感觉有点不知所措。我试图更改为 json 只是因为从 spry 表中读取数据非常慢。我正在开发一个移动应用程序。数据驻留在客户端。就目前而言，我加载了一个单独的 .html 页面以获取数据。这在初始负载上花费了太多时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T18:16:28.800

JSON 是一种纯文本格式。无法在 JSON 中保存样式文本。但是，您可以将标记的文本（例如，带有 HTML 标签、Markdown 等）保存在 JSON 字符串中，就像保存任何其他文本一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:19:16.843

JSON 文件是纯文本文件，因此不能使用样式字体，可以使用空格、断线。但是您可以使用相同格式的 JSON 来插入您想要的样式。

# linq - 两个子属性列表类型之间的 LINQ 比较？

> ID：10402161
> 
> 赞同：0
> 
> 时间：2012-05-01T18:14:57.800
> 
> 标签：linq, comparison, except

我已经看到了几个如何在 Linq 中使用 except 运算符和比较进行比较的示例，但它们似乎都显示了如何使用两种简单类型或一种简单类型和一种复杂类型来完成。我有两个不同类型的列表，我需要根据子属性选择一个结果，然后选择另一个属性匹配但 a`DateTime`较新的组。谁能帮我解决这个问题？

```
 public class Parent
        {
            public List<Child> ChildList;
        }

        public class Child
        {
            public string FoodChoice;
            public DateTime FoodPick;
        }

        public class Food
        {
            public string FoodName;
            public DateTime FoodPick;
        }

        public void FoodStuff
    {
       var parent = new Parent();
     var childList = new List<Child>();
childList.Add( new Child {FoodChoice="a",DateTime=..... 
childList.Add( new Child {FoodChoice="b",DateTime=..... 
childList.Add( new Child {FoodChoice="c",DateTime=..... 
parent.ChildList = childList;
        var foodList = new List<Food>();
        foodList.Add......
        var childrenWithNoMatchingFoodChoices = from ufu in Parent.ChildList where !Parent.ChildList.Contains ( foodList.FoodName )
        var childrenWithMatchingFoodChoicesButWithNewerFoodPick = from foo in Parent.ChildList where Parent.ChildList.FoodPick > foodList.FoodPick
    } 
```

我试图弄清楚如何获得`List<Child>`for `childrenWithNoMatchingFoodChoices`。我想弄清楚如何获得`List<Child>`一个`childrenWithMatchingFoodChoicesButWithNewerFoodPick`

帮助？使用 .NET Framework 4.0。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:23:24.420

要获取 FoodChoice 不在 foodList 中的儿童列表，我将使用以下查询：

```
var childrenNoMatch = parent.ChildList
                 .Where(ch => !foodList.Any(f => f.FoodName == ch.FoodChoice)); 
```

然后我会尝试这些方面的东西：

```
 var childrenMatch = parent.ChildList.Except(childrenNoMatch);

    //childrenWithMatchingFoodChoicesButWithNewerFoodPick
    var moreRecent = from ch in childrenMatch
             let food = foodList.First(f => f.FoodName == ch.FoodChoice)
             where DateTime.Compare(ch.FoodPick, food.FoodPick) == 1
             select ch 
```

虽然它没有经过测试。

# extjs - 在 Sencha Architect 中显示按钮事件视图

> ID：10402167
> 
> 赞同：0
> 
> 时间：2012-05-01T18:15:29.363
> 
> 标签：extjs, sencha-architect

我刚刚开始使用 Sencha Architect，即使是最简单的事情我也遇到了问题。当单击按钮时，我正在尝试转到下一个视图。到目前为止，我的代码在单击按钮时会发出警报。

```
Ext.define('MyApp.view.Login', {
    extend: 'Ext.Container',

    config: {
        layout: {
            align: 'center',
            type: 'vbox'
        },
        items: [
            {
                xtype: 'fieldset',
                width: 500,
                title: 'Login',
                items: [
                    {
                        xtype: 'selectfield',
                        label: 'Vælg bil',
                        store: 'cars'
                    },
                    {
                        xtype: 'passwordfield',
                        label: 'Adgangskode'
                    },
                    {
                        xtype: 'checkboxfield',
                        label: 'Husk mig'
                    },
                    {
                        xtype: 'button',
                        handler: function(button, event) {
                            alert("foo");
                        },
                        text: 'Log ind'
                    }
                ]
            }
        ]
    }

}); 
```

应该用什么来代替警报来添加新视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T06:14:10.517

您可以使用这个打开一个 id 为“sampleview”的视图：

```
if(Ext.getCmp('sampleview'))
{
    Ext.Viewport.setActiveItem(Ext.getCmp('sampleview'));
}
else 
{
    var sample = Ext.create('App.view.SampleView');
    Ext.Viewport.setActiveItem(sample);
} 
```

# mysql - Grails - 启动内存/内存使用/域对象

> ID：10402182
> 
> 赞同：4
> 
> 时间：2012-05-01T18:16:39.913
> 
> 标签：mysql, memory, grails, grails-orm

我部署了一个我构建的 Grails 应用程序（我创建的第一个应用程序），该应用程序启动时的内存使用量约为 2 GB。（雄猫 6）

该应用程序维护 4 种类型之间的大约 133,000 个域对象。对数据库的大多数事务是通过大约 115,000 个对象和正常的 CRUD 操作/文件导入和导出进行搜索。

经过多次使用，我看到我的内存标记为 3.3 GB。

首先 - 为什么启动时内存使用率如此之高？Grails 默认会在内存中缓存域对象的使用吗？

第二 - 我已经在应用程序的多个点处理了 GORM 清理，但内存使用率仍然很高（3.3GB）。ORM 层中是否存在导致事务缓存等的内容？

谢谢

* * *

---------------**编辑**--------

测试：我从数据库中删除了所有域对象

启动：514 MB

带对象：993 MB（我根据 DataSource 文件调整了一些性能）

* * *

** 数据源 **

```
dataSource {
pooled = true
driverClassName = "com.mysql.jdbc.Driver"
username = "xxx"
password = "xxx"
}
hibernate {
cache.use_second_level_cache = false
cache.use_query_cache = true
cache.region.factory_class = 'net.sf.ehcache.hibernate.EhCacheRegionFactory'
}
// environment specific settings
environments {
development {
    dataSource {
        dbCreate = "update"
        url = "jdbc:mysql://localhost/mydb"
    }
}
test {
    dataSource {
        dbCreate = "update"
        url = "jdbc:mysql://localhost/mydb"
    }
}
production {
    dataSource {
        dbCreate = "update"
        url = "jdbc:mysql://localhost/mydb"
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:37:26.297

Grails 是一个内存猪。

您使用的是 hsqldb 还是 mysql 后端数据库？

如果您使用的是默认的 hsqlbd，我的猜测是导致问题的 Hsqldb 默认设置。

我的建议是将其添加到您的 DataSource.groovy

```
url = "jdbc:hsqldb:file:" + location + "/prodDb_v02;hsqldb.default_table_type=cached;shutdown=true" 
```

第一部分 jdbc:hsqldb:file:..... 只是设置数据库的位置

重要的部分是 hsqldb.default_table_type=cached;

这会将默认类型从内存更改为缓存。

好好写到这里...

[http://www.jroller.com/alessiopace/entry/hsqldb_memory_and_cached_tables](http://www.jroller.com/alessiopace/entry/hsqldb_memory_and_cached_tables)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T11:28:51.600

您使用二级缓存**和**查询缓存，以便解释您的一些内存使用情况。

除此之外，很难盲目猜测为什么要使用这么多内存。这可能是很多事情，所以在你开始切换开关和跟踪测试之前，我建议使用[JavaMelody](http://grails.org/plugin/grails-melody)或[Ehcache monitor](http://ehcache.org/documentation/operations/monitor)之类的东西。这将帮助您了解幕后发生的事情以及您所做更改的影响。

Grails 确实比一些类似的框架消耗更多的*内存*，但是像这样的性能问题通常是由代码库**和**配置引起的。此外，您可能想在[这里](http://memo.feedlr.com/?p=31)查看一些可能有帮助的 JVM 选项。

祝你好运。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-09T18:06:58.773

JVM 选项： `-server -Xms512m -Xmx1048M -XX:MaxPermSize=1048m -XX:+UseParallelGC -XX:-UseGCOverheadLimit`

*JavaMelody*和*perf4j*：-帮助您查看内存使用情况/内容/方式

请参阅此[http://burtbeckwith.com/blog/?p=73](http://burtbeckwith.com/blog/?p=73) 和此[http://grails.1312388.n4.nabble.com/Memory-leak-td1358871.html](http://grails.1312388.n4.nabble.com/Memory-leak-td1358871.html) 和此[http://www.componentix.com /blog/8/run-long-batch-processing-jobs-in-grails-without-memory-leaks](http://www.componentix.com/blog/8/run-long-batch-processing-jobs-in-grails-without-memory-leaks)

# windows-phone-7 - windows 8上的windows手机开发

> ID：10402183
> 
> 赞同：4
> 
> 时间：2012-05-01T18:16:46.353
> 
> 标签：windows-phone-7, mobile, compatibility, windows-8

显然，在 WP7 开发方面不支持 XP（即使 Visual Studio 2010 仍然适用于 XP）。由于我现在大部分工作都是在 linux 上完成的，所以我认为只为 WP7 sdk 购买 windows 7 有点浪费。

我的问题：如果我将我的 xp 安装升级到 windows 8 消费者预览版（似乎是免费的），我可以安装和使用 windows phone SDK 吗？

我在网上读过各种各样的故事，有人说有，有的说没有。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T18:18:07.187

是的，Windows 8 CP 支持 Windows Phone 开发。不过，您必须下载[7.1.1 更新](http://www.microsoft.com/en-us/download/details.aspx?id=29233)并将其安装在 7.1 SDK 之上才能使模拟器正常工作。

# installation - 卸载 Chocolatey 包

> ID：10402187
> 
> 赞同：44
> 
> 时间：2012-05-01T18:17:08.903
> 
> 标签：installation, nuget, uninstallation, chocolatey

Chocolatey 包管理器支持通过以下命令进行静默安装。它似乎没有卸载命令。

```
cinst install packagename 
```

有没有办法通过 Chocolatey 卸载应用程序？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-07-02T10:24:15.807

[正如我在这里](https://stackoverflow.com/questions/10353793/how-do-i-remove-a-package-installed-via-chocolatey)回答的那样，您可以使用

```
cuninst packagename 
```

卸载软件包。

详细信息可以在[卸载命令](https://chocolatey.org/docs/commands-uninstall)中找到。

**编辑：**对于新版本，应该使用`choco uninstall packagename`.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-11T23:31:10.103

**更新**：Chocolatey 现在通过 'cuninst packagename' 提供对卸载的原始支持。尽管如此，包作者需要提供一个 ChocolateyUninstall.ps1 文件，该文件将撤消安装所做的所有事情。它是有限的，因为

*   Chocolatey PowerShell 模块中没有定义有助于卸载的函数
*   没有自动删除 MSI
*   卸载仅删除机器存储库中软件包的最新版本（而不是为您提供删除某个或全部的选项）

# iphone - ABPeoplePicker 选择许多并返回电子邮件数组

> ID：10402191
> 
> 赞同：5
> 
> 时间：2012-05-01T18:17:26.543
> 
> 标签：iphone, objective-c, ios, ipad

**我想做的事：**

1.  向用户展示其设备上在联系人中有电子邮件地址的所有联系人。
2.  允许用户在点击“完成”之前选择/取消选择任意数量的联系人。
3.  返回电子邮件地址数组...或字典数组，其中包含所选联系人的所有联系信息。

**我试过的：**

`ABPeoplePicker`但我无法让它与选择多个联系人一起工作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-02T01:45:17.407

我能够使用以下代码完成我认为您所描述的事情：

```
#import <UIKit/UIKit.h>
#import <AddressBook/AddressBook.h>

@interface ELEViewController : UIViewController <UITableViewDataSource, UITableViewDelegate>
@end

@interface ELEViewController()
@property (nonatomic, strong) NSArray *arrayOfPeople;
@property (nonatomic, assign) CFArrayRef people;
@property (nonatomic, strong) NSMutableSet *selectedPeople;
@end

@implementation ELEViewController 
@synthesize arrayOfPeople = _arrayOfPeople;
@synthesize people = _people;
@synthesize selectedPeople = _selectedPeople;

- (NSMutableSet *) selectedPeople {
  if (_selectedPeople == nil) {
    _selectedPeople = [[NSMutableSet alloc] init];
  }
  return _selectedPeople;
}

- (void)didReceiveMemoryWarning {
  [super didReceiveMemoryWarning];
}

- (void)viewDidLoad {
  [super viewDidLoad];

  UITableView *tableView = [[UITableView alloc] initWithFrame:CGRectMake(50, 50, 300, 300) 
                                                    style:UITableViewStylePlain];
  tableView.delegate = self;
  tableView.dataSource = self;
  [self.view addSubview:tableView];
  ABAddressBookRef addressBook = ABAddressBookCreate();
  self.people = ABAddressBookCopyArrayOfAllPeople(addressBook);  
  self.arrayOfPeople = (__bridge_transfer NSArray*)ABAddressBookCopyArrayOfAllPeople(addressBook);
  [tableView reloadData];
}
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
  static NSString *CellIdentifier = @"ContactCell";

  UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
  if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault 
                              reuseIdentifier:CellIdentifier];
  }

  int index = indexPath.row;
  ABRecordRef person = CFArrayGetValueAtIndex(self.people, index);
  NSString* firstName = (__bridge_transfer NSString*)ABRecordCopyValue(person,
                                                             kABPersonFirstNameProperty);
  NSString* lastName = (__bridge_transfer NSString*)ABRecordCopyValue(person,
                                                                  kABPersonLastNameProperty);
  NSString *name = [NSString stringWithFormat:@"%@ %@", firstName, lastName];

  cell.textLabel.text = name;
  return cell;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section     {
  return self.arrayOfPeople.count;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

  [tableView deselectRowAtIndexPath:[tableView indexPathForSelectedRow] animated:NO];
  UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
  id person = [self.arrayOfPeople objectAtIndex:indexPath.row];
  if (cell.accessoryType == UITableViewCellAccessoryNone) {
    cell.accessoryType = UITableViewCellAccessoryCheckmark;
    [self.selectedPeople addObject:person];
  } else if (cell.accessoryType == UITableViewCellAccessoryCheckmark) {
    cell.accessoryType = UITableViewCellAccessoryNone;
    [self.selectedPeople removeObject:person];
  }
  NSLog(@"%@", self.selectedPeople);  
}

@end 
```

这会在 tableView 中显示整个地址簿，然后选择联系人旁边的复选标记并将它们添加到 NSSet。取消选中会删除复选标记并从 NSSet 中删除条目。我将整个 ABPerson 添加到 NSSet 中，因此您以后仍然必须使用 C API 来处理它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T18:38:52.060

您可以`NO`为此委托方法返回：

```
- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker 
shouldContinueAfterSelectingPerson:(ABRecordRef)person
{
    NSString* name = (__bridge_transfer NSString*)ABRecordCopyValue(person,
                      kABPersonFirstNameProperty);
    NSLog(@"Name %@", name);
    // Do stuff with the person record
    return NO;
} 
```

这允许用户选择一些人。

# c++ - 使用 Qt 插件将函数移动到 VS2010 中的其他文件时出现链接器错误

> ID：10402196
> 
> 赞同：0
> 
> 时间：2012-05-01T18:17:50.137
> 
> 标签：c++, visual-studio-2010, qt

我有一个函数可以从一个图像表示 ( `MyImage`) 转换为 a `QImage`，我决定将命名空间专用于以这种方式接口的函数会更整洁。我以前直接在代表我的类中使用此函数 main `QMainWindow`。

因此，我创建了一个文件`MyFormatToQtInterfacing.h`，如下所示：

```
#include <QtGui/QMainWindow>
#include <qlabel.h>

namespace MyFormatToQtInterfacing
{
    // These functions below convert a cv::Mat to a QImage.
    // Adapted from http://stackoverflow.com/questions/5026965/how-to-convert-an-opencv-cvmat-to-qimage
    // The grayscale ones seem to be inverted.  Look into this later.

    QImage MyImage2QImage(const MyImage &src) { //snip };
}; 
```

然后我从这个新的命名空间调用函数，正如你所期望的那样，我得到以下链接器错误：

> 1>main.obj : 错误 LNK2005: "class QImage _ *cdecl MyFormatToQtInterfacing::Mat2QImage(class MyImage2QImage const &)" (?MyImage2QImage@MyFormatToQtInterfacing@@YA?AVQImage@@ABV?$Mat* @V?$Vec@E$02@ cv@@@cv@@@Z) 已经在 moc_Tracker.obj 中定义
> 
> 1>Tracker.obj : 错误 LNK2005: "class QImage _ *cdecl MyFormatToQtInterfacing::MyImage2QImage(class MyImage2QImage const &)" (?MyImage2QImage@MyFormatToQtInterfacing@@YA?AVQImage@@ABV?$Mat* @V?$Vec@E$02@ cv@@@cv@@@Z) 已经在 moc_Tracker.obj 中定义
> 
> 1>C:\Projects\Tracker\Tracker.exe : 致命错误 LNK1169: 找到一个或多个多重定义符号

我也一直在用 OpenCV 矩阵替换 MyImage 并遇到同样的问题。为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:22:12.503

如果你在头文件中定义函数，你也必须让它 `inline`避免这个问题。

```
 inline QImage MyImage2QImage(const MyImage &src) { /*snip*/ }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:23:04.343

您应该添加一个标头保护，并且如果您在标头中定义该函数，则另外使该函数内联。

```
#ifndef MYIMAGE2QIMAGE_H
#define MYIMAGE2QIMAGE_H

inline QImage MyImage2QImage(const MyImage &src) { //snip };

#endif // MYIMAGE2QIMAGE_H 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T18:23:40.810

您违反了单一定义规则。不允许在包含在多个编译单元中的头文件中定义非内联或非模板函数。将您的定义移动到 .cpp 文件或将函数标记为内联。

# sql-server - 如何为我们拥有 2000 年和 2005 年数据库的 SQL Server 2008 创建链接服务器

> ID：10402197
> 
> 赞同：10
> 
> 时间：2012-05-01T18:17:52.743
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, sql-server-2000

目前我正在研究 SQL Server 2000、2005 和 2008，我的要求是，SQL Server 2000 和 2005 中可用的数据库将在 2008 年使用链接服务器提供。

假设我在 SQL Server 2000 中有一个名为的数据库，`LIVE_2000`在 SQL Server 2005 中有一个名为 的数据库，`LIVE_2005`有人可以帮我为 SQL Server 2008 创建链接服务器吗？`LIVE_2000``LIVE_2005`

第一件事这甚至可能吗？

提前谢谢...`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-01T19:01:46.727

有[几种不同的方法](http://www.c-sharpcorner.com/uploadfile/suthish_nair/linked-servers-in-sql-server-2008/)可以在 SQL Server 中创建链接服务器，您可以使用 SQL Server Management Studio 中的 GUI 或通过脚本。

使用[MSDN 上的说明，](http://msdn.microsoft.com/en-us/library/aa560998%28v=bts.10%29.aspx)您可以执行以下操作：

> 1.  单击开始，单击所有程序，单击 Microsoft SQL Server 2005 或 Microsoft SQL Server 2008，然后单击 SQL Server Management Studio。
>     
>     
> 2.  在“连接到服务器”对话框中，指定相应 SQL Server 的名称，然后单击“连接”。
>     
>     
> 3.  在 SQL Server Management Studio 中，双击服务器对象，右键单击链接服务器，然后单击新建链接服务器。
>     
>     
> 4.  在“新建链接服务器”对话框的“常规”页面的“链接服务器”中，输入要链接到的 SQL Server 的完整网络名称。
>     
>     
> 5.  在服务器类型下，单击 SQL Server。
>     
>     
> 6.  在 New Linked Server 对话框的左窗格中，在 Select a page 下，选择 Security。
>     
>     
> 7.  您需要将本地服务器登录名映射到远程服务器登录名。在安全页面的右侧，单击添加按钮。
>     
>     
> 8.  在本地登录下，选择一个本地登录帐户以连接到远程服务器。如果远程服务器上也存在本地登录，请选中模拟。或者，如果本地登录将映射到远程 SQL Server 登录，则您必须为远程服务器登录提供远程用户名和远程密码。
>     
>     
> 9.  在“新建链接服务器”对话框的左窗格中，在“选择页面”下，选择“服务器选项”。将 Rpc 和 Rpc Out 参数设置为 True，然后单击“确定”。

另一种方法是使用 Transact SQL 编写查询以使用存储过程设置服务器[`sp_addlinkedserver`](http://technet.microsoft.com/en-us/library/ms190479%28v=sql.100%29.aspx)

```
EXEC sp_addlinkedserver   
   @server='yourServer', 
   @srvproduct='',
   @provider='SQLNCLI', 
   @datasrc='yourServer\instance1'; 
```

任一版本都将设置链接服务器，然后您可以在代码中引用该链接服务器。

# tridion - 无法打开出版物 - 标题为“Segments”的项目已存在

> ID：10402198
> 
> 赞同：4
> 
> 时间：2012-05-01T18:17:54.603
> 
> 标签：tridion, tridion-2011

我们遇到了一个奇怪的问题，我们无法打开出版物。我们确实在 GUI 中收到错误消息，提示“此位置已存在标题为“Segments”的项目。”。有谁之前经历过这个吗？最近没有应用配置/补丁。

环境：SDL Tridion 2011 GA + HR #1 IIS 7.5 .net 4 SQL Server 2008 R2

即使我们只是尝试查看发布属性或尝试从 GUI 扩展发布，也会发生错误。

下面是堆栈跟踪：

> 在 Tridion.AudienceManagement.DomainModel.Dal.FolderDal.Save（文件夹文件夹，布尔 useTransaction）
> 
> 在 Tridion.AudienceManagement.DomainModel.Dal.PublicationDal.CreateSegmentsRootFolder（出版物出版物）
> 
> 在 Tridion.AudienceManagement.DomainModel.Dal.PublicationDal.SolvePublicationWithoutSegmentRoot（出版物出版物）
> 
> 在 Tridion.AudienceManagement.DomainModel.Dal.PublicationDal.Read（出版物出版物）
> 
> 在 Tridion.AudienceManagement.DomainModel.Publication.Load()
> 
> 在 Tridion.AudienceManagement.DomainModel.Publication..ctor(UserContext userContext, TcmUri id)
> 
> 在 Tridion.AudienceManagement.UI.DataExtenders.TreeExtender.AddOeRootNode（XmlTextReader 阅读器，TcmUri 出版物Uri）
> 
> 在 Tridion.AudienceManagement.UI.DataExtenders.TreeExtender.PostProcessListPublication（XmlTextReader 阅读器，TcmUri publicationUri，PipelineContext 上下文）
> 
> 在 Tridion.AudienceManagement.UI.DataExtenders.TreeExtender.ProcessListResponse（XmlTextReader 阅读器，PipelineContext 上下文）
> 
> 在 Tridion.AudienceManagement.UI.DataExtenders.TreeExtender.ProcessResponse（XmlTextReader 阅读器，PipelineContext 上下文）
> 
> 在 Tridion.Web.UI.Core.Extensibility.Pipeline.<>c_DisplayClass4\. *<ProcessResponse>b* _3（DataExtender 扩展器）
> 
> 在 System.Collections.Generic.List `1.ForEach(Action`1 动作）
> 
> 在 Tridion.Web.UI.Core.Extensibility.Pipeline.ProcessResponse（XmlTextReader 阅读器，PipelineContext 上下文）
> 
> 在 Tridion.Web.UI.Core.Extensibility.Pipeline.ProcessResponse（XmlTextReader 输入，对象 [] 方法参数值）
> 
> 在 Tridion.Web.UI.Models.TCM54.Lists.GetList（字符串 id，过滤器过滤器，Int32 列）
> 
> 在 SyncInvokeGetList（对象，对象 []，对象 []）

任何指针/帮助将不胜感激？

**快速更新及解决方案：**

我们已经打开了 Tridion CS 票证，并且能够在 Tridion CS 的帮助下解决问题。在我们的例子中，当我们为发布应用安全权限时就会发生这种情况。我们仍然需要确保这个问题发生的根本原因。tridion_cm_email 的表“FOLDERS_OWNING_PUBLICATIONS”未正确填充发布 ID，当我们应用权限并使用发布 ID 更新表解决了该问题时。

注意：在尝试上述解决方案之前，请备份您的数据库并打开 Tridion CS 票证以获取解决方案。此外，为您提供 tridion_cm 和 tridion_cm_email db 给客户支持以进行分析。

**根据您的数据库应用修补程序 (OE_2011.1.1.82675) MSSQL 或 ORACLE：** [https ://www.sdltridionworld.com/downloads/hotfixes/Outbound_Email_2011_SP1/index.aspx](https://www.sdltridionworld.com/downloads/hotfixes/Outbound_Email_2011_SP1/index.aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T18:29:41.687

您可能需要联系 SDL Tridion 支持来解决此问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T08:08:52.077

查看堆栈跟踪，该问题发生在 GUI 的受众管理扩展中。您当然应该联系 SDL Tridion 支持来解决此问题，但您可以暂时关闭 Audience Management 扩展程序，以便在没有它的情况下继续工作。为此，您需要在文件中的`/Configuration/editors`和`/Configuration/models`节点中注释受众管理相关部分。`System.config`

# asp.net - 从 Github 在 IIS 上自动部署？

> ID：10402202
> 
> 赞同：3
> 
> 时间：2012-05-01T18:18:44.223
> 
> 标签：asp.net, .net, iis, github, deployment

我找到了一种使用 .php 页面自动部署的方法，使用 Post-Receive URL 快速而肮脏。因此，您将以下内容放入您网站的页面中：

```
<?php `git pull`; ?> 
```

将该页面的 URL 放入 GiHub，然后自动部署。效果很好。.ASP 是否有类似或等效的内容？我有一个在 IIS 6.0 上运行的站点，如果能做一个 ASP 等价物会很棒。

我通过在 IIS 服务器上安装 PHP，对于一个页面来说似乎是一种浪费，并且会让我面临 PHP 安全和修补问题。而只是使用一些 .ASP 代码。

可以通过 Google、GitHub:Gists 或 iis.net 找到我需要的东西。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T18:59:43.547

我对 PHP 了解不多，除了它是一种脚本语言。但是需要构建 ASP.NET 项目。无论如何，您可以使用诸如[AppHarbor](https://github.com/blog/961-deploy-to-appharbor-from-github)（或凯利提到的 Azure）之类的 Paas 平台来简化流程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T17:21:19.427

首先，你需要在你的服务器上安装 git。然后从您的 asp 页面运行 git 命令。如果您使用 asp classic，请尝试以下操作：

```
<%
    Dim oShell
    Set oShell = Server.CreateObject("Wscript.Shell")
    oShell.Run "git pull"
    Set oShell = Nothing
%> 
```

它将完成与 PHP 相同的工作。

如果您正在寻找 asp.net 版本。我在 github 上有一个简单的项目： [https ://github.com/tshwangq/IISDeploy](https://github.com/tshwangq/IISDeploy)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T12:25:14.653

在 PHP 中使用来自 GitHub 的 Webhook-URL 的服务挂钩（以前称为 Post-Receive-URL's）很容易。正如你所说。基本上，**git pull**命令集成在大多数 Apache 环境中。这不是 ASP.NET 的情况。

简单地说：使用 PHP，您只需要从 GitHub > Webserver 复制相应的文件。另一方面，ASP.NET（或大多数 .NET 环境）需要 **先编译项目**。因此，仅在 IIS 上安装 PHP 并不能完成工作。

因此，为了使这项工作适合您的 ASP.NET 项目，您需要：

1.  为下载最新文件的[Post-Receive 挂钩](https://help.github.com/articles/post-receive-hooks)创建消费者
2.  [编译](http://msdn.microsoft.com/en-us/library/f35ctcxw.aspx)网络服务器上的文件
3.  将构建结果复制到所需的文件夹

不幸的是，我还没有遇到一个可行的例子。

# design-patterns - 命令模式不仅仅是适配器吗？

> ID：10402203
> 
> 赞同：3
> 
> 时间：2012-05-01T18:18:45.343
> 
> 标签：design-patterns, adapter, command-pattern

根据 GoF 命令模式 UML，在我看来，*ConcreteCommand*只是使*Reciever*适应通用*命令*（可能是）接口。我可能被[金锤](http://en.wikipedia.org/wiki/Golden_hammer)击中了，所以请解释一下区别在哪里或者我做错了什么。

![命令模式](../Images/f1877316da2b3ce815c936dd72c378d1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:10:59.100

许多这些模式看起来非常相似，并且意图确实有助于理解模式定义。这是我对这些模式的（可能不完整）知识：

**命令**模式将调用者与操作分开。

一个命令可能有一个独立于特定请求、接收者或调用者的生命周期——它是一个单独的第一类实体。它允许在不同时间排队和执行命令，并允许记录/记住命令执行，可能用于日志记录。

它可用于组织 UI 命令实现、撤消或重做功能或事务管理作为示例。

**适配器**模式用于使一个对象适应另一个对象的使用。

我不会混淆对另一个对象进行操作的对象（ConcreteCommand 对 Receiver 执行某些操作）与“适配器”模式的实现相混淆，其中适配器的行为几乎就像一个代理，以允许 Adaptee 与其他协作者一起工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-27T05:09:46.047

两者本质上是不同的。让我解释一下原因：

如果不使用命令模式，您将无法乘飞机从一个地方旅行到另一个地方！

如果您经常旅行，作为客户，您所关心的只是从您所在的地方旅行到另一个地方。您不关心飞行员将如何驾驶飞机或哪家航空公司可用..您无法真正预测到这一点。你想要的只是去机场并告诉他们带你去你的目的地。但如果你这样做，你对机场当局的指挥会被嘲笑！他们需要你提供一个命令对象，这是你的票。尽管您不关心哪家航空公司或哪种飞机类型，但当您准备好飞行时，您需要提供票务命令对象。调用者，即机场官员需要检查您的命令（机票），以便他们可以验证它，如果它是假的则撤消它，如果他们犯了错误则重做它（您不必重新完成预订过程） . 简而言之 ，他们希望在决定是否调用或执行您的命令之前完全控制您的命令（票证），这让航空公司（接收者）执行（让您登上飞机并带您前往目的地）。请注意，您的命令（您的机票）已经拥有接收者（航空公司）的信息，没有这些信息，机场官员甚至不会首先开始处理您的机票。

机场当局甚至可能有一堆他们正在处理的机票。他们可能会选择延迟我的票并让在我之后的人通过（在我之前调用另一个人的票）

如果不使用适配器模式，您将无法像往常一样进行交易！

过去一段时间，主要的交易方式是通过面糊：如果你想要我的笔记本电脑，把你的台式机和电视给我。问题是你可能没有我想要的，所以我们不能交易。解决方案是适配器模式。我们无法交易，因为我们有不兼容的接口（想要）。所以发明了钱。因此，现在如果您想要我的笔记本电脑，请通过适配器，典当它并获得一些钱。是的！我肯定想要一些钱。几乎每个人都实现了称为 Money 的抽象类（或以 Dollars 为实例的 IMoney）。你？现在与命令模式相反，money 上没有关于接收者的信息。我希望金钱是我作为接收者的命令对象。那会很酷。但不是！虽然可以调用、撤消或重做票证等，但始终接受金钱。如果你给我一些，我会做一件事：接受它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-07T09:12:58.550

在命令模式中，命令对象知道能够完成给定请求的人。或者它也可能知道完成请求所需的所有人员。（例如：如果请求是“洗衣服”，Command对象得到衣服，找到洗衣机，放入洗涤剂，旋转机器并完成该过程。对于这些动作，它可以调用其他人（对象）。

在适配器模式中，适配器不认识能够完成工作的人。它也对请求或如何完成工作一无所知。它所做的只是调用另一个实现了不兼容接口的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T21:04:56.603

适配器是-a 或具有-a 适配器。具体的命令有一个接收器。所以箭头朝另一个方向移动。

# ajax - 放置常规控制器和 ApiController 的位置

> ID：10402210
> 
> 赞同：2
> 
> 时间：2012-05-01T18:19:36.907
> 
> 标签：ajax, asp.net-mvc-3, asp.net-mvc-4, asp.net-web-api

我最近一直在研究 MVC4 WebApi 示例。这些示例应用程序非常简单，仅包含几页。由于它们的目的只是展示如何使用 ApiController，因此应用程序的结构保持在最低限度。

在较大的 Web 应用程序中，会有很多常规控制器和 Api 控制器。我们应该如何以有组织的方式安排它们？将所有 api 控制器放入一个文件夹并`$.ajax()`从那里调用每个视图是否是一种好习惯？或者，将 api 控制器与呈现相关视图所在的视图的常规控制器一起放置是否更好`$.ajax()`？

建议的做法是什么？

*这里添加了一些想法：*

我会花更多的时间考虑一下。现在我的计划是标准控制器将只用于渲染视图。没有视图模型将通过标准控制器传递。也就是说，没有`return View(model)`。视图将使用 jQuery 模板等客户端编程从 API 控制器返回的 json 对象填充。【我是不是太极端了？没有`return View(model)`？真的？]

如果这没问题，那么常规控制器将不会调用任何工作服务。相反，应该从 API 控制器调用所有工作服务。那么，我应该如何放置这些 WorkerServices 和它们的接口呢？

更重要的是，如果我想拥有区域怎么办？我应该将 API 和 WorkerServices 放在区域之外吗？或者每个区域都有一个 API 文件夹和一个 WorkerServices 文件夹？

我肯定会在今天下午反复考虑，做出一个有计划的决定。请让我知道您的建议或经验。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T18:21:07.360

您可以分支您的`Controllers`文件夹以保持 Api 控制器和标准控制器之间的分离：

```
 |--- Api
Controllers - |
              |--- Standard 
```

或以下分离：

```
|-- Controllers
|-- Api 
```

这真的是个人品味的问题。我只是注意不要在同一个文件夹中混合标准和 Api 控制器，因为它们更难区分。

就`$.ajax`调用而言，控制器的位置以及它们在服务器上的组织方式并不重要。由路由引擎将传入的 url 分派给相应的控制器。

# javascript - 使用 javascript 进行图像标记

> ID：10402213
> 
> 赞同：0
> 
> 时间：2012-05-01T18:19:54.203
> 
> 标签：javascript, html

是否有一种工具可以让您单击并图像开始选择，然后如果您定义一个区域（由于缺乏更好的术语，我们将称之为画布），您可以根据需要标记任意数量的图像？

基本上，我们的用例是我们希望允许用户将图像标记到画布上，以表明他们通过 Web 应用程序理解了一个概念。我们可以假设用户启用了 Javascript，并且他们将拥有一个兼容 HTML 5 的浏览器。在我们深入捕获鼠标单击的坐标，然后将所选图像绝对定位在该坐标上之前，我想看看是否已经制作了类似的东西。

# android - 在android中更改片段内容视图

> ID：10402218
> 
> 赞同：1
> 
> 时间：2012-05-01T18:20:15.543
> 
> 标签：android

我有一个包含一个列表的片段，现在这个片段持有`listView`它的数据，`webserver`我想显示一个加载视图，直到数据到达适配器。如何更改片段的 contentView ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T14:27:18.480

我通过使用包含 ListView 和 ProgressBar 的 RelativeLayout 来完成此操作，其中 ProgressBar 设置为`View.INVISIBLE`. 在从 Web 服务器检索数据之前，我应该让 ProgressBar 可见。当数据到达时，只需填充 ListView 并使 ProgressBar 再次不可见。

布局：

```
 <ListView
        android:id="@+id/list"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        />

    <ProgressBar
        android:id="@+id/progress"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:visibility="invisible" />

</RelativeLayout> 
```

代码：

```
ProgressBar progressBar = (ProgressBar) findViewById(R.id.progress);
progressBar.setVisibility(View.VISIBLE);
// retrieve data ...
// populate ListView
progressBar.setVisibility(View.INVISIBLE); 
```

# crystal-reports - 如何在 Crystal Reports 中的字符串中添加变量

> ID：10402219
> 
> 赞同：1
> 
> 时间：2012-05-01T18:20:15.550
> 
> 标签：crystal-reports

我是水晶报表的新手。我需要在字符串中插入一个在运行时计算的变量。

例子：

“您的帐户中还有 $[VARIABLE] 美元”

我是否需要三个元素：字符串“You have $”的第一部分、变量和字符串“dollars left in your account”的最后部分？

或者我可以做类似 String.Format 的事情，我可以在报告生成期间插入值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:29:38.983

这是在参数中还是只是在表单上列出？有两种方法可以做到这一点。

第一种方式，您可以将标签拖到报表上。在标签内，您输入“You have”，然后将要移动的字段从字段浏览器拖到标签上，然后以“您的帐户中剩余的美元”结束。这是假设数据库字段不需要格式化。如果是这样，您可以创建一个公式来格式化它（然后以相同的方式拖动公式字段）。我喜欢这种方式，因为您可以在设计视图中看到它的外观，这对于大型报告很方便。

第二种方式，创建一个公式字段来获取文本，然后将其拖到表单上。您可以使用“Crystal”或“Basic”语法。我通常使用基本只是因为我擅长并且熟悉它。例子：

```
' Basic Syntax
If IsNull(zip_code) = false Then
    formula = "Your zip code is " & {zip_code.zip_code}
Else
    formula = "There is no zip code available."
End If 
```

![在此处输入图像描述](../Images/19599e651bd7a9fcc45720da333cff09.png)

# google-chrome - Chrome 是否应该以块的形式从服务器传输 HTML5 视频？

> ID：10402220
> 
> 赞同：1
> 
> 时间：2012-05-01T18:20:20.217
> 
> 标签：google-chrome, safari, html5-video, charles-proxy

在查看 Charles 3.6.3 中的网络流量时，我们注意到每次在 Chrome 中调用`VIDEO`元素的`play`方法时，浏览器都会访问服务器以检索不同数量的数据（从几字节到几兆字节不等），而当我们在 Safari 中做同样的事情时，没有网络流量进出服务器（它会预先加载整个视频）。

哪一个是 HTML5 视频的正确行为？

# java - java中使用套接字的聊天应用程序算法

> ID：10402221
> 
> 赞同：0
> 
> 时间：2012-05-01T18:20:20.477
> 
> 标签：java, sockets, jsp, jakarta-ee

我必须为聊天制作一个 web 应用程序，它可以作为 Skype 工作，比如一对一聊天以及群聊。

最近几天我正在研究谷歌，我开始了解以下事情。

为了提高速度，我必须使用套接字。数据库必须参与存储聊天历史。

过去 1 年，我正在研究 Java，但不幸的是从未研究过套接字连接。

有一些可用的在线代码，即使我也试图理解它，但它都超出了我的想象。

但我知道的几件事如下

1.  服务器类需要配置套接字。
2.  客户端类需要通过套接字发送消息。

我的问题是我怎么会知道特定的消息是发送给特定的组或个人的......？？

由于只有 1 个套接字连接到所有组，因此特定消息将发送给所有组。

我不需要一个例子，我只需要正确地制作一个算法，这样我就可以开始工作了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:25:51.493

气氛的[聊天样本](https://github.com/mmcbride/atmosphere/tree/master/samples)应该足以让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:25:56.280

[这个ppt](https://docs.google.com/viewer?url=http://www.cs.uah.edu/~weisskop/Notes690/A13_Elections.ppt)可以帮助你开始

我建议你看一本关于分布式系统或网络通信的书

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T18:26:22.497

您的服务器和客户端将具有组属性

所以客户端将发送一条消息，让我们将其称为 Message 对象

```
class MessageObject {

 String message;

 String group;
} 
```

您的服务器将记录所有客户端，并根据组将它们存储在地图中。

每当有新消息到达服务器时，它都会检查消息的组，并根据它从映射中获取客户端列表并将消息写入那里的流。

# c# - REST、json、.Net4 和复杂数据类型

> ID：10402222
> 
> 赞同：1
> 
> 时间：2012-05-01T18:20:25.633
> 
> 标签：c#, json, wcf, post

我一直在尝试创建一个基于 REST 的 WCF 服务来发送和接收 json 数据。我能够让大多数事情正常工作，但最后一块真的难倒我。

我正在向我的服务发送一个复杂的数据类型。我正在发送数据，但似乎我的类没有被实例化。

类声明（在单独的类文件中）：

```
public class WhereItsAt
{
    public float Latitude { get; set; }
    public float Longitude { get; set; }
    public string Category { get; set; }
    public string SearchTerms { get; set; }
    public float Distance { get; set; }
}

    [WebInvoke(Method = "POST", UriTemplate = "/New", RequestFormat = WebMessageFormat.Json)]
    public string Create(WhereItsAt newstuff)
    {
        return string.Format("Success: {0} <Should show search terms here>", newstuff.SearchTerms);
    } 
```

问题是newstuff.SearchTerms（好的，所有的newstuff）为空或0。

如果我修改我的课程：

```
public class WhereItsAt
{
    public float Latitude { get; set; }
    public float Longitude { get; set; }
    public string Category { get; set; }
    public string SearchTerms { get{return "hello"}; set; }
    public float Distance { get; set; }
} 
```

它返回数据。

我正在和 Fiddler 通话：

POST `http://127.0.0.1:8835/testing/New`HTTP/1.1 用户代理：提琴手主机：127.0.0.1:8835 内容长度：122 内容类型：应用程序/json；字符集=utf-8

[{"Latitude":43.34,"Longitude":45.234,"Category":"尚未设置","SearchTerms":"Downtown","Distance":12.234}]

在我看来，好像我的课程没有被实例化。我在集合中创建了一些虚拟代码

{set{int i = 1;};

但是如果我在集合中创建一个断点，它永远不会被调用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:05:35.647

您需要将 DataContract 和 DataMember 属性添加到您的数据模型...

请参阅[http://msdn.microsoft.com/en-us/library/ms733127.aspx](http://msdn.microsoft.com/en-us/library/ms733127.aspx)

```
[DataContract]
public class WhereItsAt
{
    [DataMember] public float Latitude { get; set; }
    [DataMember] public float Longitude { get; set; }
    [DataMember] public string Category { get; set; }
    [DataMember] public string SearchTerms { get{return "hello"}; set; }
    [DataMember] public float Distance { get; set; }
} 
```

# json - 使用复选框插件和 Json 数据重建具有选定节点的 jstree

> ID：10402223
> 
> 赞同：0
> 
> 时间：2012-05-01T18:20:33.100
> 
> 标签：json, asp.net-mvc-3, checkbox, jstree, rebuild

我是jstree的新手，所以请大家帮忙。

我已经使用 json 数据和复选框构建了一个 jstree。现在我想再次重现 jstree，但这次只在树中检查具有相同子父关系的节点。

我以此为例[http://mattfrear.com/2011/12/17/jstree-revisited/](http://mattfrear.com/2011/12/17/jstree-revisited/)

我还使用了以下内容：

```
$('#Tree').jstree("get_unchecked", null, true).each
(function () {    
     $('#Tree').jstree("remove", this);
}); 
```

从 jstree 中删除未选中的节点，之后我只得到了带有选中节点的树一段时间，然后树再次刷新到实际的 json 数据并显示 jstree 的所有节点，包括未选中的节点。

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-06T22:40:06.743

您可以使用[cookie 插件](http://www.jstree.com/documentation/cookies)来保留单击的复选框。

# sharepoint-2010 - 未检索 SharePoint 公共 url，但使用 sharepoiont OM 检索了负载平衡器 url

> ID：10402226
> 
> 赞同：0
> 
> 时间：2012-05-01T18:20:58.280
> 
> 标签：sharepoint-2010

我有一个由负载均衡器 url "http://xyz:90" 的访问映射点配置的网站，现在我们使用公共 url "http://compnyname" 在 Internet 上发布该网站，并且 ISA 配置为指向“http://xyz:90”，问题出在代码中我正在使用 SPContext.Current.Web.URL 为网站访问者构建 URL 并发送邮件，但它检索到“http://xyz:90”不是“http://公司名称”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T08:42:42.547

SharePoint 无法知道 ISA 会做什么，您需要查看管理中心中的备用访问映射 (AAM)。

# knockout.js - 将 knockoutjs 对象移动到弹出编辑表单中

> ID：10402238
> 
> 赞同：2
> 
> 时间：2012-05-01T18:22:00.397
> 
> 标签：knockout.js

我让我的 web 服务使用 knockoutjs 将 json 渲染到一组嵌套标签中。（效果很好）。

所以我现在想做的是有一个弹出编辑窗口（已经用 KendoUI\jquery 设置）来更改值。

但问题是我不知道我是否出去吃午饭，这甚至是可能的......你如何将绑定的对象传递给其他东西来处理编辑？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T01:15:53.283

我在我的代码中做了这样的事情：

在我的 viewModel 中，我创建了一个登录函数的实例：

```
 this.loginDialog = ko.observable(new LoginDialog(this)); 
```

其定义如下：

```
function LoginDialog(viewModel) {
    var self = this;
    this.viewModel = viewModel;

    this.userid = ko.observable();
    this.password = ko.observable();
    this.open = ko.observable(false);
    this.message = ko.observable();

    // more here
} 
```

然后我有一个名为的绑定`dialog`：

```
ko.bindingHandlers.dialog = {
    init: function(element, valueAccessor, allBindingsAccessor) {
        var options = ko.utils.unwrapObservable(valueAccessor());
        setTimeout(function() { 
            $(element).dialog(options || {});
        }, 0);

        //handle disposal (not strictly necessary in this scenario)
         ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
             $(element).dialog("destroy");
         });   
    },
    update: function(element, valueAccessor, allBindingsAccessor) {
         var shouldBeOpen = ko.utils.unwrapObservable(allBindingsAccessor().openWhen);
         var options = ko.utils.unwrapObservable(valueAccessor());
         var $elem = $(element);
         var dynamicOptions = ko.utils.unwrapObservable(allBindingsAccessor().dynamicOpts) || {};
         $elem
            .dialog(shouldBeOpen ? "open" : "close");
         if (dynamicOptions.title)
             $elem.dialog("option", "title", ko.utils.unwrapObservable(dynamicOptions.title));
    }
}; 
```

我这样称呼

```
<!--  ko with: loginDialog -->
<div id='logindlg' class="dialog"
    data-bind="dialog: {autoOpen: false, modal: true, closeOnEscape: false, title: 'Login', height: 300, width: 550, dialogClass: 'no-close', resizable: false}, openWhen: open">

 <!-- more stuff here -->
</div>
<!-- /ko --> 
```

# c++ - C++11 移动构造函数

> ID：10402241
> 
> 赞同：26
> 
> 时间：2012-05-01T18:22:14.430
> 
> 标签：c++, c++11, move-semantics

考虑到以下类，实现移动构造函数的正确方法是什么：

```
class C {
public:
    C();
    C(C&& c);
private:
    std::string string;
} 
```

当然，这个想法是避免复制`string`或释放它两次。
让我们假设基本示例只是为了清楚起见，我确实需要一个移动构造函数。

我试过：

```
C::C(C&& c) {
    //move ctor
    string = std::move(c.string);
} 
```

和

```
C::C(C&& c) : string(std::move(c.string)) {
    //move ctor
} 
```

两者都可以在 gcc 4.8 上编译并运行良好。似乎选项 A*是*正确的行为，`string`被复制而不是使用选项 B 移动。
这是移动构造函数的正确实现吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-01T18:27:59.810

由于`std::string`它本身有一个 move-ctor，隐式定义的 move-ctor for`C`将负责正确的移动操作。您可能无法自己定义。但是，如果您有任何其他数据成员，特别是：

> **12.8 复制和移动类对象**
> 
> **12**隐式声明的复制/移动构造函数是其类的内联公共成员。如果 X 具有以下属性，则类 X 的默认复制/移动构造函数被定义为已删除 (8.4.3)：
> 
> — 具有非平凡对应构造函数的变体成员，并且 X 是类联合类，
> 
> — 类类型 M（或其数组）的非静态数据成员，不能复制/移动，因为重载决议 (13.3) 应用于 M 的相应构造函数，导致歧义或函数从默认构造函数，或
> 
> — 无法复制/移动的直接或虚拟基类 B，因为应用于 B 的相应构造函数的重载决议 (13.3) 会导致歧义或从默认构造函数中删除或无法访问的函数，或
> 
> — 对于移动构造函数，非静态数据成员或直接或虚拟基类，其类型没有移动构造函数且不可轻易复制。
> 
> **13**类 X 的复制/移动构造函数是微不足道的，如果它既不是用户提供的也不是删除的，并且如果
> 
> — X 类没有虚函数 (10.3) 和虚基类 (10.1)，函数 (10.3) 和虚基类 (10.1)，以及
> 
> — 选择复制/移动每个直接基类子对象的构造函数是微不足道的，并且
> 
> — 对于 X 的每个类类型（或其数组）的非静态数据成员，选择复制/移动该成员的构造函数是微不足道的；否则复制/移动构造函数是不平凡的。

您可能想要实现自己的 move-ctor。

如果您需要 move-ctor，请首选初始化列表语法。总是！否则，您最终可能会得到初始化列表中未提及的每个对象的默认构造（对于仅具有非默认 ctor 的成员对象，您必须这样做）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-01T18:31:02.243

您的两个变体都会移动字符串。第二个变体应该是首选，因为它不会默认构造一个空字符串，只是为了在之后移动分配它。

检查您的测试用例，然后检查您的编译器的 bugzilla 列表。如果您想确保这两种情况都移动，则需要跟踪对`string::operator=(string&&)`（第一种情况）*和（第二种情况）的调用。* `string::string(string&&)`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T18:32:22.360

两个构造函数都应该工作。所以两者都是正确的移动构造函数。第二个可能更有效，因为第一个默认构造`string`仅分配给它，而第二个将简单地移动构造它，因此应该更有效。如果第二个效率较低，我会怀疑是编译器错误（请记住，对于当前的编译器，C++11 支持仍然不完整）或有缺陷的测试方法（你如何测试复制与移动，你确定移动构造函数不是在这两种情况下都调用了赋值操作？）。

当然，只要有可能，您就可以简单地让编译器通过`C(C&&) = default;`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-01T18:24:56.683

无需在此处实现移动构造函数，因为您不必手动管理内存。移动构造函数仅在您在类中手动使用动态数组时才有用。

您仍然可以显式地让编译器创建默认的移动构造函数，即使它应该已经完成​​，即使您没有请求它：

```
C(C&& c) = default; 
```

# java - 在段落中查找第一句话

> ID：10402242
> 
> 赞同：1
> 
> 时间：2012-05-01T18:22:39.530
> 
> 标签：java, .net, text-segmentation

我有一个基本上包含一个段落的字符串。可能会有换行符。现在我只想得到字符串中的第一句话。我以为我会尝试

```
indexOf(". ") 
```

那是一个带空格的点。

问题是这在诸如`firstName. LastName`.

我正在使用.Net。有没有一种好的方法可以实现这一目标？我还在标记 Java 以查看是否可以缩小搜索范围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:27:11.167

您需要的是自然语言解析 (NLP) 工具包。自己写一个很难，因为它需要大量的研究和数据收集，但幸运的是它已经为你完成了。

*   [自然语言处理工具包列表](http://en.wikipedia.org/wiki/List_of_natural_language_processing_toolkits)

**。网**

*   [.NET 的自然语言处理工具包](https://stackoverflow.com/questions/6136436/natural-language-processing-net-tools)
*   [SharpNLP](http://sharpnlp.codeplex.com/)

> SharpNLP 是一组用 C# 编写的自然语言处理工具。目前它提供以下 NLP 工具：
> 
> *   分句器
> *   ...

**爪哇**

*   [在 JAVA 中使用哪个 NLP 工具包？](https://stackoverflow.com/questions/895893/which-nlp-toolkit-to-use-in-java)
*   [如何使用斯坦福解析器将文本拆分为句子？](https://stackoverflow.com/questions/9492707/how-can-i-split-a-text-into-sentences-using-the-stanford-parser)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T18:27:23.383

您需要以某种方式标记句子的结尾。正如您已经注意到的“。” 没有这样做，因为它可以以不同的方式使用（“嗨，我的名字是 Pudelhund 先生。”）。如果可能的话，我建议使用一些不会使用的标志。

编辑：另[一种方法](https://stackoverflow.com/questions/10402242/)也不错，但方法更复杂。如果您无法编辑正在使用的字符串，那么该方法胜过我的；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-13T19:27:46.203

这可以使用非常简单的 String.substring() 实现

```
String example = "Hello world. This is example. " ;
System.out.print(example.substring(0, example.indexOf(".")+1)); // --> Hello world. 
```

# gcc - 链接到 libcuda.so 的问题

> ID：10402245
> 
> 赞同：2
> 
> 时间：2012-05-01T18:23:13.013
> 
> 标签：gcc, linker, cuda, g++, shared-libraries

我被一个似乎很容易诊断和修复的问题难住了。我有一个使用 CUDA 驱动程序 API 的 C++ 源文件。当我使用 编译它时`nvcc`，生成可执行文件并且可以正常工作。但是，当我尝试使用 编译它时`g++`，链接器抱怨未定义对位于中的符号的引用`/usr/lib/libcuda.so`：

```
undefined reference to `cuDeviceGet'
... undefined reference to`cuDeviceComputeCapability'
... undefined reference to `cuDeviceGetName'
... undefined reference to`cuDeviceTotalMem_v2'
... undefined reference to `cuDeviceGetAttribute'
... undefined reference to`cuDeviceGetAttribute'
... undefined reference to `cuDeviceGetAttribute'
... undefined reference to`cuDeviceGetAttribute' 
```

我试图确保它`/usr/lib`包含在库路径中（通过提供标志`-L/usr/lib`、`-lcuda`和添加`/usr/lib`到`$LIBRARY_PATH`）。但是，问题仍然存在。我确信其中`/usr/lib/libcuda.so`包含链接器抱怨的符号：

```
$ nm -D /usr/lib/libcuda.so | grep cuDeviceGet
00000000000be410 T cuDeviceGet
00000000000bf120 T cuDeviceGetAttribute
00000000000d2e10 T cuDeviceGetByPCIBusId
00000000000be200 T cuDeviceGetCount
00000000000bdfa0 T cuDeviceGetName
00000000000d2bb0 T cuDeviceGetPCIBusId
00000000000bf380 T cuDeviceGetProperties 
```

我觉得奇怪的是`nvcc`成功编译了文件，但`g++`没有。您对我如何解决此问题有任何想法吗？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:59:31.840

好的，我无法编译文件的原因是`-lcuda`标志必须**在**文件名之后。否则，它将无法正常工作......编译器会发出一个大而突出的警告，告诉我这些信息将不胜感激。嗯，浪费了两个小时。

# c# - 无法从应用程序级别获取资源

> ID：10402256
> 
> 赞同：4
> 
> 时间：2012-05-01T18:24:11.347
> 
> 标签：c#, wpf, xaml

我的 app.xaml：

```
<Application.Resources>
    <RadialGradientBrush x:Key="myBrush">
        <GradientStop Color="#FFC44EC4" Offset="0" />
        <GradientStop Color="#FF829CEB" Offset="1" />
        <GradientStop Color="#FF793879" Offset="0.669" />
    </RadialGradientBrush>
</Application.Resources> 
```

在这里，我正在尝试使用它：

```
private void btnOK_Click(object sender, RoutedEventArgs e)
    {
        RadialGradientBrush b = (RadialGradientBrush)Resources["myBrush"];
        //b.GradientStops[1] = new GradientStop(Colors.Red,0.0);
    } 
```

但我不能使用“b”，因为它在定义后为空。我怎样才能得到那个资源？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T18:45:29.313

您正在从控件的资源中“绘图”，请尝试其中一种...

```
res = this.FindResource("myBrush"); // this 'walks' the tree and will find it
res = Application.Current.Resources["myBrush"]; // or reference app resources directly
res = App.Current.TryFindResource("myBrush"); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:59:43.820

当您尝试从 btnOK_Click 事件访问资源时，我将假设该方法属于窗口对象。因此，您正在错误的位置寻找资源。您必须改为引用应用程序的资源字典。

所以，我的建议是：

```
private void btnOK_Click(object sender, RoutedEventArgs e) 
{ 
    RadialGradientBrush b = (RadialGradientBrush)Application.Current.Resources["myBrush"]; 
    b.GradientStops[1] = new GradientStop(Colors.Red,0.0); 
} 
```

# ms-access - 表达式生成器访问 2010

> ID：10402259
> 
> 赞同：2
> 
> 时间：2012-05-01T18:24:35.227
> 
> 标签：ms-access, type-conversion, string-concatenation

我正在尝试在 Access 2010 中构建一个表达式，该表达式从名为barcodeNumber 的字段中获取一个数字，并将该数字转换为一个字符串，然后获取该字符串并将* 连接到开头，将* 连接到结尾。这就是我所拥有的：

```
"*" & CStr([barcodeNumber]) & "*" 
```

但这又回来了：

```
*Error 0* 
```

这个错误是什么意思？我怎样才能完成我想要的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:54:38.607

错误 0 表示“没有错误”。看看这个（任何回复）：bytes.com/topic/access/answers/523300-error-0-20-a

如果您的错误是由于 NULL 值引起的：

```
"*" & CStr(IIf(IsNull([barcodeNumber]), 0, [barcodeNumber])) & "*" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T19:07:35.250

最终这样做了：

```
= "*" & [barcodeNumber] & "*" 
```

工作得很好！

# jquery - jQuery 热键...不是那么全球化

> ID：10402260
> 
> 赞同：10
> 
> 时间：2012-05-01T18:24:36.123
> 
> 标签：jquery, events, dom, hotkeys, codemirror

基本上，我使用Resig 先生的[jQuery Hotkeys 插件](https://github.com/jeresig/jquery.hotkeys)来捕获和处理诸如`ctrl+o`等之类的快捷方式......

好的，也许我不理解这个概念，但我的印象是文档内*任何地方*`ctrl+o`的触发都会被文档热键处理程序捕获。

 *例如，以下代码通常可以工作...

```
jQuery(document).bind('keydown', 'ctrl+o', fn); 
```

但是，如果用户在输入框内触发热键，它会惨遭失败。

只有当我执行以下操作时它才有效：

```
jQuery('body, input').bind('keydown', 'ctrl+o', fn); 
```

这对我的健康非常不利，因为它涉及每次将新输入框添加到 DOM 时绑定该死的处理程序。更糟糕的是，对于像 CodeMirror 这样的复杂小部件，我不知道要绑定什么。

不知道我的问题是否有意义，也许我使用了错误的方法？我也尝试绑定到以下对象，但没有成功：`window`, `document`, `body`,`div[contains the whole page]`

**注意：**你可以[在这里试试](http://jsfiddle.net/XKWjM/)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T18:40:11.823

这实际上是插件的预期功能：

```
// Don't fire in text-accepting inputs that we didn't directly bind to
if ( this !== event.target && (/textarea|select/i.test( event.target.nodeName ) ||
    event.target.type === "text") ) {
    return;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T13:59:25.140

是的，如果用户在输入框内触发热键，JqueryHotkeys 会惨遭失败。

或者，当我浏览时，我发现了[shortcut.js](http://www.openjs.com/scripts/events/keyboard_shortcuts/shortcut.js)，它提供了与 Jquery-Hotkeys 类似的功能。

**重要**的是，它还具有在输入框内启用或禁用“用户定义的快捷方式功能”的选项。*

# coldfusion - Coldfusion tinymce 拼写检查器不工作/显示

> ID：10402261
> 
> 赞同：1
> 
> 时间：2012-05-01T18:24:38.857
> 
> 标签：coldfusion, tinymce

我有一个现有的 tinymce 设置运行良好，使用 tinymce 版本 3.4.9 但由于某种原因拼写检查器没有显示，事实上，当我将拼写检查器添加到插件列表时，tinymce 一起消失。

下面是cffunction代码...

```
<cffunction name="adminEditTinyMCEJS" output="true">
<cfif listLen(tinyMCE_list) gt 0>
    <script language="javascript" type="text/javascript">
        tinyMCE.init({ 
          mode : "exact", 
          elements : "#tinyMCE_list#", 
          content_css : "css/tinyMCE.css",
          plugins : "style,table,searchreplace,paste,spellchecker", 
          visual : "true", 
          external_image_list_url : "js/tinyMCE_image_list.js",
          trim_span_elements : "false", 
          valid_elements : "+a[id|style|rel|rev|charset|hreflang|dir|lang|tabindex|accesskey|type|name|href|target|title|class|]" + 
            ",-strong/-b[class|style],-em/-i[class|style]," + 
            "-strike[class|style],-u[class|style],##p[id|style|dir|class|align],-ol[class|style],-ul[class|style],-li[class|style],br," + 
            "img[id|dir|lang|longdesc|usemap|style|class|src|onmouseover|onmouseout|border|alt=|title|hspace|vspace|width|height|align]," + 
            "-sub[style|class],-sup[style|class],-blockquote[dir|style],-table[border=0|cellspacing|cellpadding|width|height|class|align|summary|style|dir|id|lang|bgcolor|background|bordercolor]," + 
            "-tr[id|lang|dir|class|rowspan|width|height|align|valign|style|bgcolor|background|bordercolor],tbody[id|class]," + 
            "thead[id|class],tfoot[id|class],-td[id|lang|dir|class|colspan|rowspan|width|height|align|valign|style|bgcolor|background|bordercolor|scope]," + 
            "-th[id|lang|dir|class|colspan|rowspan|width|height|align|valign|style|scope],caption[id|lang|dir|class|style],-div[id|dir|class|align|style]," + 
            "-span[style|class|align],-pre[class|align|style],address[class|align|style],-h1[id|style|dir|class|align],-h2[id|style|dir|class|align]," + 
            "-h3[id|style|dir|class|align],-h4[id|style|dir|class|align],-h5[id|style|dir|class|align],-h6[id|style|dir|class|align],hr[class|style]," + 
            "-font[face|size|style|id|class|dir|color],dd[id|class|title|style|dir|lang],dl[id|class|title|style|dir|lang],dt[id|class|title|style|dir|lang]",
          theme : "advanced", 
          force_p_newlines : true,
          theme_advanced_toolbar_location : "top", 
          theme_advanced_toolbar_align : "left", 
          theme_advanced_resize_horizontal : false,
          theme_advanced_resizing : false,
          nonbreaking_force_tab : true,
          apply_source_formatting : true,
          theme_advanced_buttons1 : "bold,italic,underline,separator,spellchecker", 
          theme_advanced_buttons2 : "",
          theme_advanced_buttons3 : "",
          spellchecker_rpc_url : "tinymce/jscripts/tiny_mce/plugins/spellchecker/rpc.cfm"

        }); 
    </script>
</cfif> 
```

我已经实现了 Richard Davies 的插件拼写检查器（用于 ColdFusion） - 版本：2.0.4。但这没有任何效果。[在这里下载](http://sourceforge.net/tracker/index.php?func=detail&aid=1908279&group_id=103281&atid=738747spellchecker)

任何帮助都会非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:30:38.543

不确定我有没有给你一个“答案”。但它可能不会出现的原因是：

1.  区分大小写
2.  错误的路径（插件在错误的位置）。
3.  错误的标识符（例如粘贴、*拼写检查*...而不是“拼写检查”）。

打开 Firebug 或 Charles 并查看正在调用但失败的资源。我猜你会从中得到一个线索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T17:08:37.717

您的**valid_elements**选项有一个小错误。在该值的第一行，**+a**元素规则以**类**属性后的竖线字符结尾：

```
valid_elements : "+a[id|style|rel|rev|charset|hreflang|dir|lang|tabindex|accesskey|type|name|href|target|title|class|]" + 
```

尝试删除它，使其结束**class]**而不是**class|]**。这似乎足以阻止 SpellChecker 工作，尽管对我来说 TinyMce 实例仍然可以加载，所以我不确定这是否是你的问题。

否则，我发现您正在使用的 SpellChecker 插件与 Adob​​e ColdFusion 9.0.1 配合得很好——它是专门为 CF 编写的，但文档没有说明支持哪些版本。

# php - “按字段排序”MySQL 似乎无法正常工作

> ID：10402268
> 
> 赞同：0
> 
> 时间：2012-05-01T18:25:19.727
> 
> 标签：php, mysql, sql-order-by

长话短说，我的按字段排序似乎不适用于我的 MySQL 调用。我在存储中真的找不到模式...

$theorder 正确设置为

```
, 'People-Wedding Photo', 'People-Kids', 'People-Male/Female', 'Architecture-Exterior', 'Architecture-Interior', 'Animal-Birds', 'Backgrounds' 
```

这是我的代码。如您所见，我正在循环，进行格式转换....但我仍然收到错误的订单...随机订单...。

有什么我想念的吗？

```
$under_link_query = mysql_query("SELECT DISTINCT(type), type FROM ".$prefix."ProFolio_work WHERE type != 'Backgrounds' ORDER BY FIELD(type" . $theorder .")");

    while($u_row = mysql_fetch_assoc($under_link_query)){
        $type = html_entity_decode($u_row['type']);

        $typeForm = preg_replace('/[^a-z0-9]/i', '_', $type);
        ?>
           <a href="#" id="link_<? echo str_replace(' ', '_', $typeForm); ?>">
    <? echo ucfirst($type); ?></a>
            <? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:51:48.260

@Malovich 是答案，基本上你应该使用：

```
ORDER BY $theorder 
```

但请记住，默认顺序是升序，并且顺序发生。我注意到您的变量`$theorder`设置为以逗号开头的字符串，这几乎是您的问题。

确保`$theorder`不以逗号开头，然后尝试仅在一行上订购。如果可行，请继续添加更多。

=============== 编辑=================

抱歉，您正在尝试对字段进行子排序。错过了那部分，所以这是发生了什么：

您需要提供所有字段进行排序，否则 MySQL 会先对您未提供的每个字段进行排序，然后再对您提供的字段进行排序。如果需要，您可以提供要排序的字段子集，但您需要以相反的顺序提供它们，然后使用 DESC 表示法，例如：

```
ORDER BY FIELD (field,'lastsort',middlesort','firstsort') desc 
```

这将按以下顺序显示您的列表：

```
firstsort items
middlesort items
lastsort items
<all other options, in reverse alphabetical order> items 
```

关键部分是您需要添加所有字段值以进行排序。（或使用解决方法）。

# base64 - 与图像相比，大量的 dataURI

> ID：10402270
> 
> 赞同：0
> 
> 时间：2012-05-01T18:25:26.143
> 
> 标签：base64, data-uri, page-load-time, get-request

我正在尝试比较（为了性能）使用任何一个[dataURI](http://en.wikipedia.org/wiki/Data_URI_scheme)与大量图像。我所做的是设置两个测试：

1.  [常规图像](http://yhmags.com/profile-test/tague-all-profiles-reg.php)( [WPT](http://www.webpagetest.org/result/120501_XG_4662X/) )
2.  [Base64](http://yhmags.com/profile-test/tague-all-profiles-base64.php) ( [WPT](http://www.webpagetest.org/result/120501_WD_4650K/) )

两个页面完全相同，除了“如何”提供这些图像/资源。我已经针对每个（上面提到的 - WPT）运行了一个 WebPageTest，它看起来 base64 的平均加载时间要快得多——但常规视图的缓存视图更快。我已经实现了 HTML5 Boilerplate 的[.htaccess](https://github.com/h5bp/html5-boilerplate/blob/master/.htaccess)以确保资源被正确地压缩，但是正如你所看到的，我得到了base64 的*F*用于不缓存静态资源（我不确定这是否正确）。我最终要在这里弄清楚的是哪种方法更好（假设为了争论，一个页面上有那么多资源）。我知道的一些事情：

1.  base64的`GET`请求很大
2.  base64 有 1 个资源，而常规资源有 300 个（这是更大的问题……`GET`请求或资源数量）？关于常规的要记住的是，由于限制，只有这么多资源可以并行加载——对于 base64——你真的只是等到可以读取 HTML——所以在*技术上*没有什么比加载页面本身。

非常感谢任何帮助 - 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T15:41:00.787

为了比较，我认为您需要对跨多​​个主机名分片的图像进行测试。

另一种选择是将图像拆分为逻辑集。

如果您打算走 BASE64 路线，那么也许您需要找到一种方法将它们缓存在客户端上。

如果这些是您计划使用的图像，那么它们还有很大的优化空间，例如：http: [//yhmags.com/profile-test/img_scaled15/interior-flooring.jpg](http://yhmags.com/profile-test/img_scaled15/interior-flooring.jpg)

我将其转换为 PNG 并通过 ImageOptim 运行，结果为 802 字节（JPG 为 1.7KB）

我会优化图像，然后重新运行测试，包括一个具有多个主机名的测试。

# linux - 压缩 Bash 脚本以解析文件

> ID：10402274
> 
> 赞同：4
> 
> 时间：2012-05-01T18:25:42.583
> 
> 标签：linux, bash, parsing

我有这个 bash 脚本，它可以粘贴一个文本文件，我想让它变得更简单和更短以提高效率，有人对我如何做到这一点有任何想法吗？

```
$vi

function displayHelp
{
        echo "Use '-f' to set the file to be used "
        echo "Use '-s' to sort the data bya column"
        echo "Use '-m' to output the rows which match this expression"
}

function displayColumn
{
    columnnumber="$2"
    awk '{print $'$columnnumber'}' $1

}

function displayParameter
{   
    parameter="$3"
    columnnumber="$2"
    awk -v s=$3 -v c=$2 '$c ~ s { print $0 }' $1
}

while getopts f:s:m:h opt
do
  case "$opt" in
    h) displayHelp;;
    f) filepath="$OPTARG";;
    s) column="$OPTARG"  
    displayColumn $filepath $column
    ;;
    m) searchParam="$OPTARG"
    displayParameter $filepath $column $searchParam
    ;;

  esac
done 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:24:02.233

在`displayColumn()`中，您没有使用`-v`变量传递，但在`displayParameter()`您中。您应该始终使用`-v`而不是嵌入 shell 变量。

同样在`displayParameter()`你分配两个变量并且从不使用它们。

你应该总是在扩展 shell 变量时引用它们。当它们单独出现时，不必在作业的右侧引用它们。

`-f`如果这是您的意图，则不需要强制执行。如果不提供它（及其所需的参数），您的脚本将尝试从中读取`stdin`（这可能是您想要的）。

没有强制执行`-m`并且`-s`是必需的。如果两者都不存在，AWK 命令将输出错误消息。

通常，必需的参数应作为位置参数处理，选项标志应用于选项（及其参数）。

您的问题可能更适合[Code Review](https://codereview.stackexchange.com/)。

# c++ - c++限制进程子忽略SIGXCPU

> ID：10402277
> 
> 赞同：3
> 
> 时间：2012-05-01T18:26:00.260
> 
> 标签：c++

我有这个代码

```
static void sigXCPU(int pTmp){
  cout<<" .... ";
}

.....
pid_t vPid=fork(); 
  int vStat;   

  switch(vPid){
  case -1: perror("fork");
    exit(1);
  case 0:
    //limit on data
    struct rlimit vLimD;
    vLimD.rlim_cur = 100000; 
    vLimD.rlim_max =  1000000; 
    setrlimit(RLIMIT_DATA, &vLimD);
    //limit on cpu time
    struct rlimit vLimCPU;
    vLimCPU.rlim_cur = 1;
    vLimCPU.rlim_max = 1;

    execl("./p1","",NULL);    
    if(signal(SIGXCPU,sigXCPU)==SIG_ERR);
    break;
  default: 
    while(wait(&vStat)!=vPid);
    break;} 
```

p1 的代码是

```
int main(){
  sleep(10);
return 0;} 
```

为什么孩子忽略SIGXCPU？代码是在FreeBsd 8.0 amd64下用gcc编译的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T18:31:33.990

child after`execl`中的代码永远不会执行，因为当前进程映像被替换为`p1`.

即使您将信号处理程序放在 之前`execl`，它也会被覆盖，因为信号处理在 exec 之后被重置为其默认值。毕竟，您的处理程序函数将不再存在于新的进程映像中。

最后，要设置信号处理程序，请避免使用`signal`和使用[sigaction](http://linux.die.net/man/2/sigaction)。

# c# - 通过 Visual Studio 2008 运行测试时如何修改 Web.config 中的连接字符串？

> ID：10402279
> 
> 赞同：0
> 
> 时间：2012-05-01T18:26:04.313
> 
> 标签：c#, visual-studio, testing, msbuild, nunit

我目前有 2 个项目，一个是标准的 ASMX Web 服务，另一个是测试项目。Web 服务项目有一个`Web.config`文件，其中包含我的连接字符串。我知道如何将连接字符串更改为 qa 或生产。我的问题是我不确定如何更改我的测试项目的连接字符串。我想要的是使用 SQLite 进行测试。

这是我添加到测试 .csproj 文件中的目标文件的样子。

```
<Project ToolsVersion="3.5" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <ConnectionString>Data Source=:memory:</ConnectionString>   
    </PropertyGroup>

    <Target Name="BeforeBuild"
        DependsOnTargets="Clean" />

    <Target Name="AfterBuild"
        DependsOnTargets="UpdateConfigFileForEnvironment" />

    <Target Name="UpdateConfigFileForEnvironment">
        <PropertyGroup>
            <AppConfigFileName>$(OutDir)Web.config</AppConfigFileName>
        </PropertyGroup>

        <FileUpdate
            Files="$(AppConfigFileName)"
            Encoding="ASCII"
            Regex="ConnectionStringBuild"
            ReplacementText="$(ConnectionString)" />
    </Target>
</Project> 
```

这是`Web.config`Web 服务项目中的文件。我省略了大部分内容，因为它无关紧要。

```
 <appSettings>
    <add key="ConnectionString" value="ConnectionStringBuild" />
  </appSettings> 
```

当我在 VS2008 中通过 ReSharper 运行单元测试时，没有返回任何`AppSettings`条目的问题。`ConnectionString`此外，如果我`msbuild`在测试项目的命令行中运行，则连接字符串会成功更新。

运行测试时如何修改连接字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T18:32:01.620

您应该以将连接字符串作为依赖项传递给它的方式构建数据访问类（请参阅Paul Hiles[的配置设置是依赖项）。](http://www.devtrends.co.uk/blog/configuration-settings-are-a-dependency-that-should-be-injected)

这将允许您在测试代码中传递与配置中的连接字符串不同的连接字符串。

# git - 如何摆脱gerrit中的错误依赖

> ID：10402285
> 
> 赞同：11
> 
> 时间：2012-05-01T18:26:13.217
> 
> 标签：git, gerrit

似乎在使用 gerrit 时，默认情况下所有更改都依赖于前一个更改。我不会为新的更改分支，我只是在 master 分支上工作，然后将提交的更改推送到远程源/master。即使两个提交彼此无关，每次都会创建一个依赖项。

我遇到了一些问题，这让我觉得我没有正确使用 git 和 gerrit。

在我的 git/gerrit 工作流程中应该发生什么不同的情况，以使每个提交不依赖于先前的提交？我还尝试为更改创建一个新分支：

```
> git pull origin master
> git checkout -b new_branch
> #make a change
> git add -A
> git commit #with gerrit's commit hook in .git/hooks
> git push origin <sha1>:refs/for/master 
```

这可行，但 gerrit 仍然报告对先前提交的项目的依赖。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T21:36:11.220

这就是`Gerrit`依赖项的含义——在另一个提交之上的提交。如果两者都在审查中，则较新的取决于较旧的。

如果您不希望它们相互依赖，请不要在彼此之上创建提交。创建一个提交，然后基于 master 为您的下一次提交创建一个新分支

`(git checkout origin/master -b NEW_BRANCH_NAME)`.

当您推送第二个提交以供审核时，它的父级将已经发布并且它不依赖于任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T09:04:02.320

我被教导通过`git reset --hard HEAD~1`在每个`git push`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T14:25:57.747

作为`git reset --hard HEAD~1`我使用它的变体：

```
git reset --hard origin/master 
```

假设，我正在努力`master`快速改变。

否则，更喜欢在主题分支中工作。

有许多 Git 脚本可以帮助管理主题分支：

*   [`git-flow`](https://github.com/nvie/gitflow)
*   [`git extras`](https://github.com/visionmedia/git-extras)
*   `git create-branch`

我确定还有其他人。

# tomcat - 带有 url 模式“/ *”的 servlet 映射中的 StackOverflowError

> ID：10402288
> 
> 赞同：6
> 
> 时间：2012-05-01T18:26:22.463
> 
> 标签：tomcat, servlets, seo, servlet-filters

我有一组 JSP 页面，我想隐藏 .jsp 扩展名（经过一些研究，它似乎对 SEO 有好处）。

我遇到的一种解决方案如下：

```
<servlet>
    <servlet-name>mypage</servlet-name>
    <jsp-file>/some-page.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>mypage</servlet-name>
    <url-pattern>/some-page</url-pattern>
</servlet-mapping> 
```

虽然这可行，但我相信我必须为我网站上的每个 jsp 页面设置此映射。

我在这里发现了另一个解决方案（简单友好的 URL）：[JSP/Servlet 的隐藏特性](https://stackoverflow.com/questions/2523430/hidden-features-of-jsp-servlet/2525995#2525995)

...它使用一个简单的 servlet 来转发请求。在我的 web.xml 我有以下，它工作正常：

```
<servlet>
    <servlet-name>MyServletName</servlet-name>
    <servlet-class>myservlets.PrettyUrlServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>MyServletName</servlet-name>
    <url-pattern>/myservlet/*</url-pattern>
</servlet-mapping> 
```

现在的问题是我不想点击 URL：www.mydomain.com/myservlet/some-page

我想使用网址：www.mydomain.com/some-page

所以我将 url-pattern 更改为“/*”

```
<servlet>
    <servlet-name>MyServletName</servlet-name>
    <servlet-class>myservlets.PrettyUrlServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>MyServletName</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

但这会导致无限循环：

```
 Exception in thread "http-bio-8080-exec-1" java.lang.StackOverflowError
            at org.apache.catalina.core.ApplicationHttpRequest.getAttribute(ApplicationHttpRequest.java:219)
            at org.apache.catalina.core.ApplicationHttpRequest.getAttribute(ApplicationHttpRequest.java:228)
            .
            .
            at org.apache.catalina.core.ApplicationHttpRequest.getAttribute(ApplicationHttpRequest.java:228)
            at org.apache.catalina.core.ApplicationHttpRequest.getAttribute(ApplicationHttpRequest.java:228)
            at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:379)
            at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)
            at myservlets.PrettyUrlServlet.doGet(PrettyUrlServlet.java:22) 
```

我不知道如何解决。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T18:29:31.077

映射到的 servlet`/*`也将在`RequestDispatcher#forward()`调用时运行。因此，如果您在该 servlet 中执行转发，它每次都会在无限循环中调用自己。这解释了`StackOverflowError`.

毕竟，您根本不应该使用`/*`servlet。它只对 servlet 过滤器有意义。将 servlet 映射放回更具体的 URL 模式，并创建一个过滤器，`/*`必要时在该过滤器上转发到所需的 servlet。您当然不想让 servlet 来处理例如图像/CSS/JS 文件。假设它们都放在`/resources`文件夹中并且您的前端控制器已映射到`/myservlet/*`，然后在中执行以下工作`doFilter()`：

```
HttpServletRequest req = (HttpServletRequest) request;
String path = req.getRequestURI().substring(req.getContextPath().length());

if (path.startsWith("/resources/")) {
    // Just let container's default servlet do its job.
    chain.doFilter(request, response);
}
else {
    // Delegate to your front controller.
    request.getRequestDispatcher("/myservlet" + path).forward(request, response);
} 
```

### 也可以看看：

*   [Tomcat 中的 URL 映射到 FrontController servlet](https://stackoverflow.com/questions/8902987/url-mapping-in-tomcat-to-frontcontroller-servlet)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T17:33:36.907

你应该使用 [UrlRewriteFilter](https://code.google.com/p/urlrewritefilter/)

你可以在你的配置文件（urlrewrite.xml）上使用这样的一些：

```
<rule>
    <from>/products/([a-zA-Z0-9._%]+)</from>
    <to>/products.jsp?id=$1</to>
</rule> 
```

UrlRewriteFilter 在评论中，但我认为它应该是一个独立的答案。

# android - 为 android (API 15) 从 hdp 设备解析数据

> ID：10402291
> 
> 赞同：0
> 
> 时间：2012-05-01T18:26:41.597
> 
> 标签：android, parsing, android-4.0-ice-cream-sandwich, android-sensors, health-monitoring

我正在使用 HDP 样本并且我有一个血压传感器 (http://www.andonline.com/medical/products/details.php?catname=&product_num=UA-767PBT-C)。我从中获取数据，但我不知道如何将其解析为人类可读的内容。

这是我到目前为止尝试过的类似：

```
while(fis.read(data) > -1) {
    String value = null;
    BigInteger bi = new BigInteger(data);
//  for(byte b:data){
//  value+=b;
//  }

Log.d("read data binary", "the data "+bi.toString(2));

Log.d("read data decimal", "the data "+bi.toString());

Log.d("read data hexa", "the data "+bi.toString(16));

Log.d("read data pure", "the data "+data);

//  Log.d("read data in for", "the data "+value); 
```

我得到类似的东西：

> 05-01 20:17:56.208: D/**读取数据六进制**(4760):数据-00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005-01 20:17:56.208: D/丁/丁/丁/丁/**read data pure** (4760): data [B@40d67e70 05-01 20:18:04.626: D/ **read data binary**(4760):数据-00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005-01 20:18:06.828: D/丁/丁/丁/丁/**读取数据十进制**(4760):数据-0576160767677597715480386547121881849032192752633260581611407011853157254121988717573734877969134052424768517755583145720631774483604063081880432610973919518566690840732483917669693281934080872472643538204409333772095149193754543981303816862226602900932185731291218078343359909141826950522259981065979565825353771918309503909195400250270592097346140180255661323498680525840321588156171474185334819513148415443728234379507600359229093281074473243790684599034208199088683338454677621174483491191074351971358537028690315653099028602232230871902656137643830877283946170700882775921345249124458496887893344541537861170446155618915889154457316279931810886758741778466015814266662502325019252008275552963949417505527790579950678630694847351385927023263169674418774269260054062018597523133414318281716321106676019125971120320369677915824373299981376100493615932096583905733998938604880344209979507207389461881566668730566105933697505053128626488714804178563386957441767127359946655045064697358061551371027355282580217366653953689149217957268335824794738057555973823505958847701190906572003379211131572099550194123133402637104389561589064917255194334844269183378807442410026970212304915398750162342030862720562356574960395088223916289512342191699176716017309140213638536098383639091011729776310430620082118888497862622038695401701710387402100087840950940846152066514765108855402410952099725385450736354603210781118974198215554193785785859382435002755250153009251411946038850315108576684984106702193657963347897709677566091677495576556681656068507314031372074156531214767021895212919495909358260588291818568553609578646758938365326563499166628415041706131521582622947791012917744251071555344476280175567553030365868879087958701356749275597544555441192209535828193783528540378443653793007478915664994969246893177676787034473169357958664807853394146528881072611495728346161885141354339050534315795112871110590890270640490572109200167490678091854953195502952814139817930997734428369811037792170901222000605941722889749066363212792188473959033320542149557873698406208807103283915464017738102761293835485103233871320167686509199843523640244281618906825238870441363628235844748462133103276301174838663071551726880398794656562034968579187231564731597466312085292931401626425031219367372880105669524021703795487930074660269606852850348561943174481059683047939007210225601490478637988520094254176801854728550931572581072192577323801255123376568421142859931699183781795327546624931509936963718203679145081654772615676143950491156457709879833213770861474166550002893895004539378141404484514321501254425186584306317322820119080073521246583023928855680771674834459485547140458179583411000552946721557465941584607592684759973667328534420531200360125049393165249939125462273655943012452796198719607891446709638525939136041376672224464954765768003499209670257743095489459555485012164498854972198547405433983837840151414071849172134515511345320372998343869719318698995124097830586163312565522099108379088383907029795001179557033732925854106484925992046251994418246510444641426185467437327268959477603463411587255087111960727666751094267733565670470254329185066819049347190875320805571892878980923324446702125088753743095489459555485012164498854972198547405433983837840151414071849172134515511345320372998343869719318698995124097830586163312565522099108379088383907029795001179557033732925854106484925992046251994418246510444641426185467437327268959477603463411587255087111960727666751094267733565670470254329185066819049347190875320805571892878980923324446702125088753743095489459555485012164498854972198547405433983837840151414071849172134515511345320372998343869719318698995124097830586163312565522099108379088383907029795001179557033732925854106484925992046251994418246510444641426185467437327268959477603463411587255087111960727666751094267733565670470254329185066819049347190875320805571892878980923324446702125088753

任何人都知道如何解析它，好吗？

PS：很抱歉把所有东西都放在了logcat里，但也许有人发现了任何联系

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:17:27.297

我找到了解决方案。我需要传感器发送的确切字节数+传感器发送信息的方式。

我将把为我的血压计解析数据的部分放在课堂上。

```
 public String byte2hex(byte[] b)
    {
     // String Buffer can be used instead
       String hs = "";
       String stmp = "";

       for (int n = 0; n < b.length; n++)
       {
          stmp = (java.lang.Integer.toHexString(b[n] & 0XFF));

          if (stmp.length() == 1)
          {
             hs = hs + "0" + stmp;
          }
          else
          {
             hs = hs + stmp;
          }

          if (n < b.length - 1)
          {
             hs = hs + "";
          }
       }

       return hs;
    }

    public static int byteToUnsignedInt(byte b) {
        return 0x00 << 24 | b & 0xff;
      }

    // Thread to read incoming data received from the HDP device.  This sample application merely
    // reads the raw byte from the incoming file descriptor.  The data should be interpreted using
    // a health manager which implements the IEEE 11073-xxxxx specifications.
    private class ReadThread extends Thread {
        private ParcelFileDescriptor mFd;

        public ReadThread(ParcelFileDescriptor fd) {
            super();
            mFd = fd;
        }

        @Override
        public void run() {
            FileInputStream fis = new FileInputStream(mFd.getFileDescriptor());
            byte data[] = new byte[300];
            try {
                while(fis.read(data) > -1) {
                    // At this point, the application can pass the raw data to a parser that
                    // has implemented the IEEE 11073-xxxxx specifications.  Instead, this sample
                    // simply indicates that some data has been received.                   
                    if (data[0] != (byte) 0x00)
                    {
                        String test = byte2hex(data);
                        Log.i(TAG, test);
                        if(data[0] == (byte) 0xE2){
                            Log.i(TAG, "E2");
                            count = 1;
                            (new WriteThread(mFd)).start();
                            try {
                                sleep(100);
                            } catch (InterruptedException e) {
                                e.printStackTrace();
                            }
                            count = 2;
                            (new WriteThread(mFd)).start();
                        }
                        else if (data[0] == (byte)0xE7){
                            Log.i(TAG, "E7");

                            //work for legacy device...
                            if (data[18] == (byte) 0x0d && data[19] == (byte) 0x1d)  //fixed report
                            {
                                count = 3; 
                                //set invoke id so get correct response
                                invoke = new byte[] { data[6], data[7] };
                                //write back response
                                (new WriteThread(mFd)).start();     
                                //parse data!!
                                int length = data[21];
                                Log.i(TAG, "length is " + length);
                                // check data-req-id 
                                int report_no = data[22+3];
                                int number_of_data_packets = data[22+5];
                                //packet_start starts from handle 0 byte
                                int packet_start = 30;
                                final int SYS_DIA_MAP_DATA = 1;
                                final int PULSE_DATA = 2;
                                final int ERROR_CODE_DATA = 3;
                                for (int i = 0; i < number_of_data_packets; i++)
                                {
                                    int obj_handle = data[packet_start+1];
                                    switch (obj_handle)
                                    {
                                    case SYS_DIA_MAP_DATA:
                                        int sys = byteToUnsignedInt(data[packet_start+9]);
                                        int dia = byteToUnsignedInt(data[packet_start+11]);
                                        int map = byteToUnsignedInt(data[packet_start+13]);
                                        //create team string... 9+13~9+20   
                                        Log.i(TAG, "sys is "+ sys);
                                        sendMessage(RECEIVED_SYS, sys);
                                        Log.i(TAG, "dia is "+ dia);
                                        sendMessage(RECEIVED_DIA, dia);
                                        Log.i(TAG, "map is "+ map);
                                        //test
//                                      sendMessage(RECEIVED_MAP, map);
                                        break;
                                    case PULSE_DATA:
                                        //parse
                                        int pulse = byteToUnsignedInt(data[packet_start+5]);
                                        Log.i(TAG, "pulse is " + pulse);
                                        sendMessage(RECEIVED_PUL, pulse);
                                        break;
                                    case ERROR_CODE_DATA:
                                        //need more signal
                                        break;
                                    }
                                    packet_start += 4 + data[packet_start+3];   //4 = ignore beginning four bytes
                                }                               
                            }
                            else
                            {
                                count = 2;
                            }
                        }
                        else if (data[0] == (byte) 0xE4)
                        {
                            count = 4;
                            (new WriteThread(mFd)).start();
//                          sendMessage();
                        }
                        //zero out the data
                        for (int i = 0; i < data.length; i++){
                            data[i] = (byte) 0x00;
                        }
                    }
                    sendMessage(STATUS_READ_DATA, 0);
                }
            } catch(IOException ioe) {}
            if (mFd != null) {
                try {
                    mFd.close();
                } catch (IOException e) { /* Do nothing. */ }
            }   
            sendMessage(STATUS_READ_DATA_DONE, 0);
        }
    }

    private class WriteThread extends Thread {
        private ParcelFileDescriptor mFd;

        public WriteThread(ParcelFileDescriptor fd) {
            super();
            mFd = fd;
        }

        @Override
        public void run() {
            FileOutputStream fos = new FileOutputStream(mFd.getFileDescriptor());
//            FileInputStream fis = new FileInputStream(mFd.getFileDescriptor());
            final byte data_AR[] = new byte[] {         (byte) 0xE3, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x2C, 
                                                        (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x50, (byte) 0x79,
                                                        (byte) 0x00, (byte) 0x26,
                                                        (byte) 0x80, (byte) 0x00, (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x80, (byte) 0x00,
                                                        (byte) 0x80, (byte) 0x00, (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x80, (byte) 0x00, (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x08,  //bt add for phone, can be automate in the future
                                                        (byte) 0x3C, (byte) 0x5A, (byte) 0x37, (byte) 0xFF, 
                                                        (byte) 0xFE, (byte) 0x95, (byte) 0xEE, (byte) 0xE3,
                                                        (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x00, 
                                                        (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00};
            final byte data_DR[] = new byte[] {         (byte) 0xE7, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x12,
                                                        (byte) 0x00, (byte) 0x10,
                                                        (byte) invoke[0], (byte) invoke[1],
                                                        (byte) 0x02, (byte) 0x01,
                                                        (byte) 0x00, (byte) 0x0A,
                                                        (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x0D, (byte) 0x1D,
                                                        (byte) 0x00, (byte) 0x00 };

            final byte get_MDS[] = new byte[] {         (byte) 0xE7, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x0E,
                                                        (byte) 0x00, (byte) 0x0C,
                                                        (byte) 0x00, (byte) 0x24,
                                                        (byte) 0x01, (byte) 0x03,
                                                        (byte) 0x00, (byte) 0x06,
                                                        (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x00 };

            final byte data_RR[] = new byte[] {         (byte) 0xE5, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x02,
                                                        (byte) 0x00, (byte) 0x00 };

            final byte data_RRQ[] = new byte[] {        (byte) 0xE4, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x02,
                                                        (byte) 0x00, (byte) 0x00 };

            final byte data_ABORT[] = new byte[] {      (byte) 0xE6, (byte) 0x00,
                                                        (byte) 0x00, (byte) 0x02,
                                                        (byte) 0x00, (byte) 0x00 };
            try {
                Log.i(TAG, String.valueOf(count));
                if (count == 1)
                {
                    fos.write(data_AR);
                    Log.i(TAG, "Association Responsed!");
                }  
                else if (count == 2)
                {
                    fos.write(get_MDS);
                    Log.i(TAG, "Get MDS object attributes!");
//                  fos.write(data_ABORT);
                }
                else if (count == 3) 
                {
                    fos.write(data_DR);
                    Log.i(TAG, "Data Responsed!");
                }
                else if (count == 4)
                {
                    fos.write(data_RR);
                    Log.i(TAG, "Data Released!");
                }
            } catch(IOException ioe) {}
        }
    } 
```

为了理解此代码，您还必须阅读 IEEE 11073 规范。每种传感器都有自己的字节数。

这段代码不是我做的，有人给我的。如果他要求我删除它，我会:)

# iis - IIS 托管模块中的 Request.Filter

> ID：10402294
> 
> 赞同：2
> 
> 时间：2012-05-01T18:26:57.847
> 
> 标签：iis, filtering, httpmodule

我的目标是创建一个 IIS 托管模块，它查看请求并从 POST 中过滤掉内容（XSS 攻击、SQL 注入等）。
但是，我现在挂断了实际过滤请求的过程。这是我到目前为止所得到的：

在模块的 Init 中，我将 HttpApplication.BeginRequest 设置为本地事件处理程序。在该事件处理程序中，我设置了以下几行：

```
if (application.Context.Request.HttpMethod == "POST")
    {
        application.Context.Request.Filter = new HttpRequestFilter(application.Context.Request.Filter);
    } 
```

我还在 application.Context.Response.Filter 上设置了一个 HttpResponseFilter

HttpRequestFilter 和 HttpResponseFilter 是 Stream 的实现。

在响应过滤器中，我进行了以下设置（Stream.Write 的覆盖）：

```
public override void Write(byte[] buffer, int offset, int count)
    {
        var Content = UTF8Encoding.UTF8.GetString(buffer);
        Content = ResponseFilter.Filter(Content);
        _responseStream.Write(UTF8Encoding.UTF8.GetBytes(Content), offset, UTF8Encoding.UTF8.GetByteCount(Content));
    } 
```

ResponseFilter.Filter 是一个简单的 String.Replace，事实上，它确实可以正确地替换文本。

然而，在请求过滤器中，有两个问题。我目前在 RequestFilter 中的代码（Stream.Read 的覆盖）：

```
public override int Read(byte[] buffer, int offset, int count)
{
    var Content = UTF8Encoding.UTF8.GetString(buffer);
    Content = RequestFilter.Filter(Content);
    if (buffer[0]!= 0)
    {
        return _requestStream.Read(UTF8Encoding.UTF8.GetBytes(Content), offset, UTF8Encoding.UTF8.GetByteCount(Content));
    }
    return _requestStream.Read(buffer, offset, count);
} 
```

这有两个问题。首先，过滤器被调用两次，而不是一次，其中一个请求基本上是 /0 的流。（如果检查缓冲区 [0] 目前过滤了这个，但我认为我设置错了）

其次，即使我在读取中正确地使用 .GetString 抓取内容，然后在 RequestFilter.Filter（一个美化的 string.replace()）中更改它，当我在 if 语句中返回字节编码的内容时，输入是未修改。

这是我想要弄清楚的：

1）我可以在过滤器之前检查什么，以确保我检查的只是 POST 而不是其他时间被调用？我没有正确设置 Application.Context.Request.Filter 吗？

2）我真的很困惑为什么没有出现将内容重写到_requestStream（我发送给班级的HttpApplication.Context.Request.Filter）。任何关于我做错的事情的意见将不胜感激。

另外，HttpApplication.Request 和 HttpApplication.Context.Request 之间有什么区别吗？

编辑：有关更多信息，我正在一个简单的 .aspx 页面上进行测试，该页面有一个文本框、一个按钮和一个标签，并且在按钮单击时将文本框文本分配给标签的文本。理想情况下，如果我将内容放在应该过滤的文本框中，我的理解是通过拦截和重写帖子，我可以使内容按修改后的方式访问服务器。我已经在模块和代码中使用断点运行测试，并且模块在 .aspx 页面上的代码被命中之前完成。.aspx 页面获取从表单传递的值，并忽略我尝试执行的任何过滤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-23T17:55:24.970

这里发生了一些问题，但为了将来参考，解释接收未过滤帖子的页面以及被评估两次的过滤器是您可能在设置 Request.Filter 之前以某种方式访问​​请求对象. 这可能会导致它评估输入流，按原样运行当前设置的过滤器链，并返回该流。

例如，简单地访问 Request.Form["something"] 会导致它评估输入流，在那个时间点运行整个过滤器链。在此时间点之后对 Request.Filters 的任何修改都将无效，并且似乎该过滤器被忽略了。

您想做的事情是可能的，而且 ASP.NET 还提供了请求验证来解决其中一些问题 (XSS)。但是，通常通过从不通过字符串连接构造查询来避免 Sql 注入，而不是通过输入清理，尽管深度防御通常是一个好主意。

# html - HTML 电子邮件和 Lotus Notes - 内容重复

> ID：10402297
> 
> 赞同：0
> 
> 时间：2012-05-01T18:27:17.033
> 
> 标签：html, email, lotus-notes, email-client

我有一个使用 EmailOnAcid.com 测试过的 HTML 电子邮件活动。除了 Lotus Notes v6.5、v7、v8 之外，该电子邮件在几乎所有客户端中都能正常显示 :(

在 Lotus Notes 6.5 和 7 中，在电子邮件的末尾，Lotus 似乎再次从头开始重复电子邮件，因此看起来同一个电子邮件已被放入两次，但实际上并没有。Lotus 中的 HTML 电子邮件是否有最小高度？（我的电子邮件高度约为 474 像素）。我已经在所有图像元素和标签上指定了高度。

在 Lotus Notes 8 中，有一个小问题；页脚图像的下部会重复吗？

有没有人知道是什么导致了这些问题？

提前致谢。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Email</title>
</head>
<body>
<table cellpadding="0" cellspacing="0" border="0" width="650" align="center">
    <tr>
        <td width="650">
            <table cellpadding="0" cellspacing="0" border="0" width="650">
                <tr>
                    <td width="650">
                        <table cellpadding="0" cellspacing="0" border="0" width="650">
                            <tr>
                                <td width="650"><img src="http://www.website.com/images/hdr.jpg" width="650" height="36" border="0" alt="" style="display:block;margin:0;"></td>
                            </tr>
                        </table>
                    </td>
                </tr>            
                <tr>
                    <td width="650">
                        <table cellpadding="0" cellspacing="0" border="0" width="650">
                            <tr>
                                <td width="137" height="53"><a href="http://www.website.com" target="_blank"><img src="http://www.website.com/images/hdr_left.gif" width="137" height="53" border="0" alt="" style="display:block;margin:0;"></a></td>
                                <td width="513" height="53"><img src="http://www.website.com/images/hdr_right.jpg" width="513" height="53" border="0" alt="" style="display:block;margin:0;"></td>                                
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="650">
                        <table cellpadding="0" cellspacing="0" border="0" width="650">
                            <tr>
                                <td width="650"><img src="http://www.website.com/images/spacer_top.jpg" width="650" height="28" border="0" alt="" style="display:block;margin:0;"></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="650">
                        <table cellpadding="0" cellspacing="0" border="0" width="650">
                            <tr>
                                <td width="397" valign="top"><a href="http://www.website.com" target="_blank"><img src="http://www.website.com/images/gold_main.jpg" width="397" height="271" border="0" alt="" style="display:block;margin:0;"></a></td>                                
                                <td width="240" valign="top">
                                    <table cellpadding="0" cellspacing="0" border="0" width="240">                                  
                                        <tr>                                            
                                            <td><img src="http://www.website.com/images/title_text.gif" width="240" height="105" border="0" alt="" style="display:block;margin:0;"></td>
                                        </tr>
                                        <tr>                                            
                                            <td><img src="http://www.website.com/images/spacer_white.gif" width="240" height="12" border="0" alt="" style="display:block;margin:0;"></td>
                                        </tr>                                                                            
                                        <tr>                                            
                                            <td><font style="font-family:verdana; font-size:10px;" color="#808180"><b>TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE</b></font></td>
                                        </tr>
                                        <tr>                                            
                                            <td><img src="http://www.website.com/images/spacer_white.gif" width="240" height="12" border="0" alt="" style="display:block;margin:0;"></td>
                                        </tr>
                                        <tr>                                            
                                            <td><font style="font-family:verdana; font-size:10px;" color="#808180"><b>TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE TEXT GOES HERE</b></font></td>
                                        </tr>                                                                                
                                    </table>
                                </td>
                                <td width="13"><img src="http://www.website.com/images/spacer_white.gif" width="13" height="2" border="0" alt="" style="display:block;margin:0;"></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="650" height="12">&nbsp;</td>
                </tr>
                <tr>
                    <td width="650">
                        <table cellpadding="0" cellspacing="0" border="0" width="650" height="85">
                            <tr>
                                <td width="397" height="85"><a href="http://website.com" target="_blank"><img src="http://www.website.com/images/ftr_left_cmras.jpg" width="397" height="85" border="0" alt="" style="display:block;margin:0;"></a></td>
                                <td width="253" height="85"><a href="http://website.com" target="_blank"><img src="http://www.website.com/images/ftr_right_lnk.gif" width="253" height="85" border="0" alt="" style="display:block;margin:0;"></a></td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T08:16:17.553

看来这可能是 EmailsOnAcid 测试系统的问题。

# ios - 在 UIScrollView 上使用 UIView 处理滚动，ScrollView 不会滚动

> ID：10402301
> 
> 赞同：3
> 
> 时间：2012-05-01T18:27:28.527
> 
> 标签：ios, ios5, uiview, uiscrollview, touch

我想检测顶部有 UIView 的 UIScrollView 中的触摸。这个 UIView 上有按钮，所以我不能`userInteractionEnabled`在 UIView 上禁用。

为了更好地理解，这是层次结构：

```
UIView (MainView: (0,0) 320x460)
. .UIScrollView (ScrollView: (0,0) 320x460)
. .UIView (OverlayView: (0,0) 320x250)
. . . .UIButton (button1: 50x50)
. . . .UIButton (button2: 50x50)
. . . .UIButton (button3: 50x50) 
```

触摸 OverlayView 时我可以滚动。但不在 OverlayView 的空白处。

有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:58:50.003

尝试将覆盖视图添加为滚动视图的子视图，然后在滚动视图滚动时更新覆盖视图的框架。

在初始化时将原始覆盖框保存在成员变量中

```
CGRect baseOverlayRect = overlayView.frame; 
```

滚动视图委托方法。

```
- (void) scrollViewDidScroll:(UIScrollView *)scrollView {

    CGPoint overlayOrigin = CGPointMake(baseOverlayRect.origin.x, baseOverlayRect.origin.y + scrollView.contentOffset.y);
    CGRect newOverlayFrame = CGRectMake(overlayOrigin.x, overlayOrigin.y, baseOverlayRect.width, baseOverlayRect.height);
    overlayView.frame = newOverlayFrame;

} 
```

# python - Pynotify 搞砸了日期时间，为什么？

> ID：10402304
> 
> 赞同：6
> 
> 时间：2012-05-01T18:27:36.817
> 
> 标签：python, python-2.7, importerror, pynotify

### 问题

这段代码

```
#!/usr/bin/env python
import pynotify
import time
import datetime

c='5/1/12 1:15 PM'
print c
dt = time.strptime(c, "%d/%m/%y %H:%M %p") 
```

生产

```
5/1/12 1:15 PM
Traceback (most recent call last):
  File "tmp.py", line 9, in <module>
    dt = time.strptime(c, "%d/%m/%y %H:%M %p")
  File "/usr/lib/python2.7/_strptime.py", line 454, in _strptime_time
    return _strptime(data_string, format)[0]
  File "/usr/lib/python2.7/_strptime.py", line 328, in _strptime
    data_string[found.end():])
ValueError: unconverted data remains: PM 
```

删除`import pynotify`,

```
#!/usr/bin/env python
import time
import datetime

c='5/1/12 1:15 PM'
print c
dt = time.strptime(c, "%d/%m/%y %H:%M %p") 
```

删除错误。

```
5/1/12 1:15 PM 
```

为什么？！！？！

### 蟒蛇版本

Python 2.7.2+（默认，2011 年 10 月 4 日，20:06:09）[GCC 4.6.1] on linux2

### pynotify。**文件**

我添加了打印调用`pynotify.__file__`和`datetime.__file__`

```
/usr/lib/python2.7/lib-dynload/datetime.so
/usr/lib/python2.7/dist-packages/gtk-2.0/pynotify/__init__.pyc
5/1/12 1:15 PM
Traceback (most recent call last):
  File "a.py", line 11, in <module>
    dt = time.strptime(c, "%d/%m/%y %H:%M %p")
  File "/usr/lib/python2.7/_strptime.py", line 454, in _strptime_time
    return _strptime(data_string, format)[0]
  File "/usr/lib/python2.7/_strptime.py", line 328, in _strptime
    data_string[found.end():])
ValueError: unconverted data remains: PM 
```

# 数据库

```
5/1/12 1:15 PM
> /usr/lib/python2.7/_strptime.py(324)_strptime()
-> found = format_regex.match(data_string)
(Pdb) format
'%d/%m/%y %H:%M %p'
(Pdb) continue
> /usr/lib/python2.7/_strptime.py(329)_strptime()
-> if len(data_string) != found.end():
(Pdb) continue
> /usr/lib/python2.7/_strptime.py(331)_strptime()
-> raise ValueError("unconverted data remains: %s" %
(Pdb) len(data_string)
14
(Pdb) found.end()
12
(Pdb) found.group(0)
'5/1/12 1:15 ' 
```

似乎`'%d/%m/%y %H:%M %p'`没有捕获所有“5/1/12 1:15 PM”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T07:08:22.613

这是一个有趣的问题。我敢打赌，发生的事情是 pynotify 正在更改您的语言环境设置，这破坏`strptime`了您对时间戳字符串的解释。

这是您的代码，其中包含几个调试打印语句，可以说明该理论：

```
#!/usr/bin/env python

import time
import datetime
import locale

print locale.getlocale()
import pynotify
print locale.getlocale()
c='5/1/12 1:15 PM'
print c
dt = time.strptime(c, "%d/%m/%y %H:%M %p") 
```

在我的系统上，我得到以下信息：

```
(None, None)
('en_US', 'UTF8')
5/1/12 1:15 PM 
```

我没有收到您的错误，但是 pynotify 可能会将您的语言环境设置为完全愚蠢的东西，这会混淆 strptime。

也许看看那个并稍微调整一下你的语言环境设置，要么在调用 strptime 之前取消设置（并在不知道 pynotify 做出什么样的假设之后将其重新设置），或者如果你发现它被设置为某种东西，则将其设置为理智的东西愚蠢的。

# sql - ORDER BY 列包含文本和数字数据的混合

> ID：10402305
> 
> 赞同：-1
> 
> 时间：2012-05-01T18:27:43.327
> 
> 标签：sql, arrays, postgresql, replace, sql-order-by

我想对文本列进行排序，其中数字组件应按数字排序。排序后的结果应如下所示：

```
chr1
chr1,chr1
chr1,chr2
chr1,chr10
chr2
chr2,chr1
chr2,chr2
chr2,chr10
chr6
chr6,chr1
chr6_ux9
chr6_ux9,chr1
chr7
chr10
chr10,chr1
chr10,chr2
chr10,chr10
chr21
chr21,chr1
chr21,chr2
chr21,chr10
chrx
chrx,chr1
chrx,chr2
chrx,chr10
chry
chry,chr1
chry,chr2
chry,chr10
chrmt
chrmt,chr1
chrmt,chr2
chrmt,chr10
chr25
chr25,chr1
chr25,chr2
chr25,chr10 
```

以下规则适用：

1.  `chrx`被视为`chr22`
2.  `chry`被视为`chr23`
3.  `chrmt`被视为`chr24`
4.  `chr6_ux9`是一个应该出现的特殊情况`chr6`

我尝试了不同的方法，但无法找到完美的解决方案。如果有人有想法，请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:45:34.207

我*想*我现在明白了，你在找什么。您希望**数字组件按数字排序**，而不是字符串。这应该适合你：

```
SELECT col1
FROM   tbl
ORDER  BY string_to_array(
             replace(replace(replace(replace(replace(replace(
                col1
              , 'chrx',     'chr22')
              , 'chry',     'chr23')
              , 'chrmt',    'chr24')
              , 'chr6_ux9', 'chr6.6')
              , ' chr',     'chr')
              , 'chr',      '')
           , ',')::real[]; 
```

按照问题中的描述对列进行排序。文本组件（'chr'）原来是多余的噪音。应用所有替换后，我去除噪音并转换为可在`ORDER BY`子句中使用的数字数组。

在执行列出的替换时，特殊情况 for`chr6_ux9`强制使用`real[]`to 而不是更简单和更快的`int[]`，因为`integer`类型在`6`and之间没有空间`7`。您还有一列带有空格而不是逗号。我也添加了一个替代品。但这可能只是一个错字。删除不相关的字符串后`chr`，只剩下逗号分隔的数字，可以转换为`real[]`.

顺便说一句，[`replace()`](http://www.postgresql.org/docs/current/interactive/functions-string.html#FUNCTIONS-STRING-OTHER)速度非常快。`replace()`我有连续执行数十个操作的函数，它们仍然执行得很快。（`regexp_replace()`慢得多。）

* * *

### 对单个元素进行排序的替代答案

对于**所有**值作为**字符串**的排序输出：

```
SELECT regexp_split_to_table(replace(replace(replace(
          col1
        ,'chrx', 'chr22')
        ,'chry', 'chr23')
        ,'chrmt', 'chr24')
        , ',') AS col1
FROM   tbl
ORDER  BY 1 
```

`chr6_ux9``chr6`在这种情况下会自动出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:40:24.147

可以说不是一个完美的数据模型......您应该通过使用适当的规范化模型来解决这个问题，但您也可以使用[数组数据类型](http://www.postgresql.org/docs/current/static/arrays.html)。可以对数组进行排序、索引等。

# ruby-on-rails - 如何仅在 rails 控制台启动时运行一些代码，有点像 rc 文件？

> ID：10402312
> 
> 赞同：10
> 
> 时间：2012-05-01T18:28:14.497
> 
> 标签：ruby-on-rails, console

有没有办法执行一些仅在控制台启动时运行的代码？有点像 rc 文件（`.bashrc`,`.zshrc`等）？我发现自己总是经常做某些事情。

例如，我会把这个放在哪里

```
u = User.find_by_username('my_console_user') 
```

所以这`u`是可用的`rails console`？

我已经诉诸于此，使用`$`as 全局变量声明，以及使用`console do`. 我认为有一些更优雅的东西......

```
 class Application < Rails::Application
    #this is only executed in the console, also doens't seem to be documented anywhere but here: https://github.com/rails/rails/pull/3139
    console do
      $u1 = User.find_by_username('user1')
      $u2  = User.find_by_username('user2')
    end

  end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-07-20T17:29:21.713

如果您使用`irb`，只需在其中添加一个方法`~/.irbrc`（如果不存在则创建一个）：

```
def find_by_username(username)
  User.find_by_username('my_console_user')
end 
```

或添加到，`~/.pryrc`如果您使用`pry-rails`.

希望这可以帮助！

# java - 为什么 Wrapper Classes, String,... final ？

> ID：10402315
> 
> 赞同：3
> 
> 时间：2012-05-01T18:28:22.883
> 
> 标签：java, oop

Core Java API 中的许多类都是最终类（包装类、字符串、数学）。为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T18:34:18.110

出于安全原因，它们是最终的。可能还有其他原因，但安全是最重要的。

想象一下一种能力，可以继承`java.lang.String`并向安全敏感的 API 提供您自己的可变实现。API 将别无选择，只能使用您的字符串（记住替换原则），但您可以从它们下面更改字符串（在并发线程上或在 API 返回之后），即使他们已经检查它是有效的。

原语的包装器也是如此：您不希望看到它们在任何情况下都是可变的，因为这会违反有关使用这些类在 API 中编码的行为的重要假设。

通过不让`String`其他人提供他们自己的、潜在敌对的、像`String`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:33:47.950

您可能希望阻止其他程序员创建子类或覆盖某些方法。对于这些情况，您可以使用*final*关键字。

String 类是*不可变*的——字符串对象不能被它们的任何方法修改。由于 java 不强制执行此操作，因此类设计器执行了此操作。没有人可以创建 String 的子类。

希望这能回答你的问题。

# asp.net - 如何在 SelectedIndexChanged 上发送额外参数？

> ID：10402317
> 
> 赞同：0
> 
> 时间：2012-05-01T18:28:25.273
> 
> 标签：asp.net, parameter-passing, selectedindexchanged, extra

有没有办法向 SelectedIndexChanged 函数发送额外的参数？

```
 <asp:RadioButtonList 
                    ID="rblMeetingPlace" 
                    SelectedValue = '<%# Bind("intMtgLoc") %>'
            *OnSelectedIndexChanged = "Validate('txtMeetPlaceOther')"*
                    runat="server" 
                    RepeatDirection="Horizontal"
 >
<asp:ListItem Value="1">Workshop</asp:ListItem>
<asp:ListItem Value="2">Service provider agency</asp:ListItem>
<asp:ListItem Value="3">Advocacy organization</asp:ListItem>
<asp:ListItem Value="4">Public Space</asp:ListItem>
<asp:ListItem Value="5">Other (specify): </asp:ListItem>
<asp:ListItem Value="" Text="" style="display: none" />
</asp:RadioButtonList>
<asp:TextBox ID="txtMeetPlaceOther" Text='<%# Bind("strMtgLocOth") %>' 
runat="server" /> 
```

我有几个单选按钮列表，我想在选择“其他”时启用文本框。我正在考虑发送文本框的 id 来启用它。

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:57:57.993

您可以通过以下方式轻松做到这一点：

```
<asp:radiobuttonlist id="rbl1" runat="server" 
    RepeatDirection="Horizontal" 
    AutopostBack="true"
    SelectedValue='<%# Bind("intMtgLoc") %>' 
    OnselectedIndexChanged="rbl1_SelectedIndexChanged">
        <asp:ListItem Value="1">Workshop</asp:ListItem>
        <asp:ListItem Value="2">Service provider agency</asp:ListItem>
        <asp:ListItem Value="3">Advocacy organization</asp:ListItem>
        <asp:ListItem Value="4">Public Space</asp:ListItem>
        <asp:ListItem Value="5">Other (specify): </asp:ListItem>
        <asp:ListItem Value="" Text="" style="display:none" />
        </asp:radiobuttonlist>
<asp:textbox id="txtMeetPlaceOther" text='<%# Bind("strMtgLocOth") %>' runat="server" />
<asp:textbox id="TextBox1" enabled="false" runat="server"></asp:textbox>
<asp:textbox id="TextBox2" enabled="false" runat="server"></asp:textbox> 
```

在代码隐藏中：

```
protected void rbl1_SelectedIndexChanged(object sender, EventArgs e)
    {
        *yourValidatorName*.Validate();
        if (Convert.ToInt32(rbl1.SelectedValue) == 5)
        {
            TextBox1.Enabled = true;
            TextBox2.Enabled = true;
        }
        else
        {
            TextBox1.Enabled = false;
            TextBox2.Enabled = false;
        }
    } 
```

回复评论：首先你应该`OnSelectedIndexChanged`为所有的`RadioButtonLists`事件处理程序设置。这里—— `rbl_SelectedIndexChanged`。然后在后面的代码中：

```
protected void rbl_SelectedIndexChanged(object sender, EventArgs e)
        {

            TextBox[] textboxes = new TextBox[] { TextBox1, TextBox2 };//all your textboxes.

            RadioButtonList whoCallEvent = sender as RadioButtonList;

            string last = whoCallEvent.ID.ToString().Substring(whoCallEvent.ID.ToString().Length - 1, 1);//get the last symbol of object (TextBox) ID,  who call event. 
            int index = Convert.ToInt32(last);
            if (Convert.ToInt32(whoCallEvent.SelectedValue) == 5)
            {
                textboxes[index - 1].Enabled = true;
            }
            else
            {
                textboxes[index - 1].Enabled = false;
            }
        } 
```

但我认为这样做在概念上是错误的。最好的方法是为我页面上`rbl_SelectedIndexChanged`的所有内容创建。`radioButtonList`

# c# - 在 ASP.NET 网站中嵌入 NHibernate 程序集

> ID：10402321
> 
> 赞同：0
> 
> 时间：2012-05-01T18:28:47.383
> 
> 标签：c#, asp.net, nhibernate

我和一个朋友在一个 ASP.NET 网站上工作，那个朋友决定他想为 ORM 使用 NHibernate 框架。我对使用非标准框架的经验**为零，他虽然不是在 .NET 方面但在 Java 方面有更多经验。**

问题是他在本地完成所有工作后，将他对项目的更改提交到了一个颠覆存储库，但是当我更新时，VS 给出了 7 个错误和一个关于找不到 NHibernate 程序集引用的警告。他只是添加了对项目的引用。有一个`bin`文件夹`dll.refresh`（该文件会导致警告）指向我朋友计算机上的完整路径名（换句话说，坏事）。

他和我想知道，他做错了什么？我们如何在项目中嵌入 DLL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:32:09.770

他需要从他在项目中引用它们的任何地方提交原始程序集以进行颠覆。例如，他可以`lib`为项目创建一个子文件夹，在其中放置所有第三方程序集。然后从此 lib 文件夹中引用并将其提交给 subversion。然后，当您结帐时，您将获得此 lib 文件夹，并且应用程序将在本地编译，因为所有必要的依赖项都是源代码控制的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:32:28.537

*   您可以将所需的 dll 放入 ~\bin 并签入
*   您可以将 dll 放在上面的级别，例如在 External Assemblies 文件夹中，然后编辑 .redresh 文件以使用相对路径
*   但我推荐你，一是把你的项目从Web Site Project转换成Web Application Project，这会带来很多好处，包括在单个程序集中编译网站，二是使用[NuGet](http://nuget.org/)（VS包管理扩展）来引用、控制并通过它维护任何 3rd 方库和其他依赖项。

# cocoa - 识别 CGContextRef 何时是 PDF 上下文

> ID：10402324
> 
> 赞同：2
> 
> 时间：2012-05-01T18:29:09.080
> 
> 标签：cocoa, core-graphics

对于我的 Cocoa 应用程序，我需要知道给定的 CGContextRef 是否是 PDF 上下文（而不是位图或屏幕上下文），以便在我的 CALayer 的 drawInContext 实现中采用不同的渲染路径。使用 iOS SDK，我可以这样做：

```
BOOL isPDF = !CGRectIsEmpty(UIGraphicsGetPDFContextBounds()); 
```

但 UIGraphics* 函数在 OS X SDK 中不可用。我希望能够使用：

```
BOOL isPDf = CFGetTypeID(currentContext) != CGContextGetTypeID(); 
```

但它似乎并不成立，并且没有 CGPDFContextGetTypeID() 函数返回特定于 PDF 的类型 ID。

有什么方法可以识别给定 CGContextRef 的类型而不做任何讨厌的事情，比如设置静态变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T20:31:47.997

没有用于获取 a 类型的公共 API `CGContextRef`，因此您必须将此信息保留在上下文 ref 本身之外。

有一个未记录的[CGContextGetType()](http://code.google.com/p/cairogles/source/browse/src/cairo-quartz-surface.c)函数返回上下文的类型，请参阅[CGContextType](http://code.google.com/p/freequartz/source/browse/trunk/CoreGraphics/CGContextPriv.h)枚举以获取可能值的列表。但是你真的不应该使用它。

# visual-c++ - RegCloseKey(HKEY) 时指定了无效的 HANDLE

> ID：10402325
> 
> 赞同：1
> 
> 时间：2012-05-01T18:29:11.273
> 
> 标签：visual-c++, mfc, visual-studio-2003, registrykey

我使用 Visual Studio 2003。有问题的程序是一个 MFC 应用程序。

我的程序处理打开、读取和关闭注册表项。我假设我正在打开并读取密钥（因为没有无效值、消息框或我已实现的任何其他错误查找方法出现）。

但是，当我调试我的程序时，我得到“...指定了无效的句柄...”（包括内存地址）。我尝试过使用调试器单步执行代码，但我很有趣，无法跟上进度。

发生错误的代码部分是：

```
HKEY hKey;
char *subKey = "\\HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port ";
strcat(subKey, scsiPortNum);
LONG openResult = RegOpenKeyEx(HKEY_LOCAL_MACHINE, subKey, 0, KEY_ALL_ACCESS, &hKey);
if(openResult != ERROR_SUCCESS){
MessageBox(0, "There was an error closing the registry key", "Error", MB_OK);
}
//...do a few RegQueries...
LONG closeResult = RegCloseKey(hKey); //******Invalid HANDLE occurs here*******
if(closeResult != ERROR_SUCCESS){
MessageBox(0, "There was an error closing the registry key", "Error", MB_OK);
} 
```

（scsiPortNum 是 char[2]，只是端口号）

就像我说的，我没有收到任何打开的错误/消息框，但我正在关闭......如果有人能指出我哪里出错了，我将不胜感激！:)

**更新：** 根据下面 luskan 的回答，我更改了我的代码，从而更接近了这个问题。代码结构现在看起来像这样：

```
HKEY hKey;
try{
char subKey[MAX_PATH];
strcpy(subKey, "\\HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port ");
strcat(subKey, scsiPortNum);
auto openResult = RegOpenKeyEx(HKEY_LOCAL_MACHINE, subKey, 0, KEY_ALL_ACCESS, &hKey);
if(openResult == ERROR_SUCCESS){
//do query...
//close key
auto closeResult = RegCloseKey(hKey);
if(closeResult != ERROR_SUCCESS){
MessageBox(0, "Error closing the key", "Registry Error", MB_OK);
}
}else{
MessageBox(0, "Error opening the key", "Registry Error", MB_OK);
}
}catch(...){
MessageBox(0, "You caught an exception!", "Try/Catch", MB_OK);
} 
```

我现在收到关于打开密钥的消息......也许我误解了 RegOpenKeyEx 的论点？还是我没有正确初始化某些东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:27:59.173

嗯，答案是非常，非常，非常简单的人......

我正在使用`"\HARDWARE\DEVICEMAP\Scsi\Scsi Port "`. 最终正确的是`"HARDWARE\DEVICEMAP\Scsi\Scsi Port "`......我有一个额外的`\`.

我通过查找 RegOpenKeyEx 返回的错误代码来解决这个问题。（见下文）。

* * *

对于调试从 RegOpenEx、RegQueryValue 或任何其他 Reg 函数返回的任何人，您可以使用以下命令查看函数返回的错误（您也可以改进它！）：

```
char buffer[250]; //size of buffer is not that important
for(long a = 0; a < 1500; a++) {
if(result == a) {
_itoa((int)a, buffer, 10);
MessageBox(0, buffer, "Error from Reg Function", MB_ICONERROR | MB_OK);
}
} 
```

这个小片段的结果为您提供了一个十进制数字，供您检查 winerror.h。如果您搜索数字然后 L - 例如“161L”，您将找到错误的含义。

# cakephp - 在 CakePHP 中本地化 timeAgoInWords

> ID：10402330
> 
> 赞同：5
> 
> 时间：2012-05-01T18:29:36.893
> 
> 标签：cakephp, localization, internationalization, cakephp-2.0, timeago

在我的 CakePHP 应用程序中，通过使用 cake.bat 我创建了 POT 文件，并通过使用 PoEdit 我创建了 PO 文件。因此，通过编写**__('myword')**我可以成功地在我的应用程序中看到本地化的单词。

但现在我需要本地化“timeAgoInWords”。当我运行**cake i18n extract时，脚本在****CakeTime** [http://api20.cakephp.org/view_source/cake-time#line-522](http://api20.cakephp.org/view_source/cake-time#line-522)中没有得到**_dn()**字样

 **所以我创建了一个**dummy.ctp**文件并将内容从 cake-time 文件复制粘贴到虚拟文件。我再次运行蛋糕脚本和 POEdit。**它在app/Locale/tur/LC_MESSAGES/default.po**文件中创建了如下所示的实例

 **```
#: View\App\dummy.ctp:30;33
msgid "%d minute"
msgid_plural "%d minutes"
msgstr[0] "%d dakika"
msgstr[1] "%d dakika" 
```

在 core.php 中，我已经将默认语言设置为土耳其语：

```
Configure::write('Config.language', 'tur'); 
```

但是当我检查我的申请时，**timeAgoInWords**的结果是英文的。

我怎样才能解决这个问题

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T10:37:12.450

Cake 的消息被提取到不同的域中，在本例中为`cake`域。这意味着蛋糕消息不会被提取到您的`default.pot`文件中，而是会进入`cake.pot`文件中。

奇怪的是，cake.pot 似乎没有包含在下载中，i18n shell 也不允许您在提取过程中传递参数来包含蛋糕核心。但是，它仍然很容易完成（我的评论以 a 开头`#`）：

```
$:/var/www/path/app$ cake i18n extract

# if will ask you here if you want to extract from your app folder
# simply press enter to confirm
What is the path you would like to extract?
[Q]uit [D]one  
[/var/www/path/app/]

# now it will ask you again, in this case enter the cake path
What is the path you would like to extract?
[Q]uit [D]one  
[D] > /var/www/path/lib/Cake

# third time, just press enter
What is the path you would like to extract?
[Q]uit [D]one  
[D] > 

# press enter to accept the app/Locale
What is the path you would like to output?
[Q]uit  
[/var/www/path/app//Locale] > 

# press enter to keep translation domains deparate
Would you like to merge all domains strings into the default.pot file? (y/n) 
[n] > 
```

现在等待提取完成并享受翻译的痛苦；）****

# c++ - C++ 公共语言运行时支持 [.Net?]

> ID：10402334
> 
> 赞同：0
> 
> 时间：2012-05-01T18:29:55.003
> 
> 标签：c++, c++-cli, clr

**嗨，大家好！**
这不是一个大问题，但是，我想知道当您启用“公共语言运行时支持 (/clr)”选项时，它是否需要“.net 框架”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T18:31:21.010

在 C++ 项目中启用 CLR 支持确实会增加对 .Net 框架的依赖。

# java - 存储数据的变量，任何类都可以访问

> ID：10402338
> 
> 赞同：1
> 
> 时间：2012-05-01T18:30:09.233
> 
> 标签：java, class, public

我创建了一个名为的类`aptSchedule`，就像它的名字所暗示的那样，它以日程表的形式跟踪约会。我想创建一个方法来查找并找到第一个打开的约会。为了创建这种方法，我必须首先找到一种查找所有约会的方法。我想我需要创建一个公共变量，但我对 Java 不是很熟悉，我很好奇应该在哪里以及如何创建这样的变量？我对自己的解释够好了吗？

谢谢你，埃文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:35:06.503

您必须将所有约会存储在某种集合中，让我们使用一个简单的`List<Appointment>`方法（假设每个约会都存储在 a(n object of type) 中`Appointment`）。然后你可以像这样上课：

```
public class aptScheduler
{
  List<Appointment> appts = new LinkedList<Appointment>();

  public aptScheduler()
  {
    // constructor
  }

  public Appointment findAppointment()
  {
    // search for appointment in appts, and return the first suitable one
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:35:43.357

我猜你正在寻找一个`Singleton`.

```
public class MySingleton {
  private static MySingleton _instance
  private MySingleton();
  public static getInstance() {
    if(_instance == null) { _instance = new MySingleton(); }
    return _instance;
  }

  // Add your scheduling methods here I guess
} 
```

请记住，虽然单例可以完成这项工作，但它们可以为您的代码添加一些非常紧密的耦合。

**编辑**：我可能错误地误解了你的问题。这是如果您希望您的变量可以全局访问。

# python - 为什么填充我的表需要这么长时间？

> ID：10402340
> 
> 赞同：2
> 
> 时间：2012-05-01T18:30:12.227
> 
> 标签：python, mysql, cgi

我正在通过 Web 表单将 csv 文件加载到我的数据库中。

原始数据的顺序在每个 csv 文件中是一致的，但它会因文件而异，具体取决于源，所以我有一个预览表单，显示五行并允许您通过下拉列表分配一列表中的有效列名。

然后我使用 cgi 表单构建一个 INSERT 语句，并逐行解析 csv 文件以填充表。

但它的运行速度非常慢。我同时填充两个表，一个有 961402 行（7 列有值），另一个有 1835538​​ 行（1 列有值），每个已经运行了至少半小时。我只看到每秒 100 行新行。

你能看出这里有什么会减慢我的速度吗？

注意：我知道这里有一些丑陋的代码，这是我在弄清楚这种语言时编写的第一个 python cgi 脚本之一。

```
 for item in form:
          field = form.getvalue(item)
          field = cgi.escape(field)
          if field == 'null':
                  pass
          elif item == 'csvfile':
                  pass
          elif item == 'campaign':
                  pass
          elif item == 'numfields':
                  pass
          else:
                  colname = str(colname) + ", " + str(item)

                  colnum.append(field)
  assert(numfields > 0)
  placeholders = (numfields-1) * "%s, " + "%s"
  query = ("insert into %s (%s)" % (table, colname.lstrip(",")))
  with open(fname, 'rb') as f:
          reader = csv.reader(f)
          try:
                  record = 0
                  errors = 0
                  for row in reader:
                          try:
                                  record = record + 1
                                  data = ''
                                  for value in colnum:
                                          col = int(value)
                                          rawrow = row[col]
                                          saferow = rawrow.replace("'", "-")
                                          saferow = saferow.replace("-", "")
                                          data = str(data) + ", '" + saferow + "'"
                                  dataset = data.lstrip(',')
                                  insert = query + (" values (%s)" % dataset)
                                  cur.execute(insert)
                                  con.commit()
                                  print ".",
                          except IndexError, e:
                                  print "Row:%d file %s, %s<br>" % (reader.line_num, fname.lstrip("./files/"), e)
                                  errors = errors + 1
                          except csv.Error, e:
                                  print "Row:%s file %s, line %d: %s<br>" % (record, fname, reader.line_num, e)
                                  errors = errors + 1
                          except mdb.Error, e:
                                  print "Row:%s Error %d: %s<br>" % (record, e.args[0], e.args[1])
                                  errors = errors + 1
                          except:
                                  t,v,tb = sys.exc_info()
                                  print "Row:%s %s<br>" % (record, v)
                                  errors = errors + 1
          except csv.Error, e:
                  print "except executed<br>"
                  sys.exit('file %s, line %d: %s' % (fname, reader.line_num, e))
  print "Succesfully loaded %s into Campaign %s, <br>" % (fname.lstrip("./files/"), table)
  print record - errors, "new records.<br>"
  print errors, "errors.<br>" 
```

编辑/更新：使用`LOAD DATA LOCAL INFILE`工作就像一个魅力，我在不到一分钟的时间内加载了 60 万条记录。

新代码也更干净。

```
 else:
            colnum.append([field, item])
sortlist =  sorted(colnum, key=itemgetter(0))
cols = ''
for colname in sortlist:
    cols = cols + "%s, " % colname[1]
cur.execute("LOAD DATA LOCAL INFILE '%s' IGNORE INTO TABLE %s FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' (%s)" % (fname, table, cols.rstrip(', ')))
con.commit() 
```

唯一的问题是我必须做更多的工作来准备我的 csv 文件以确保数据完整性，否则，就像一个魅力。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T18:39:20.793

考虑到某些 SQL（如 mySQL）支持在单个插入命令或 LOAD DATA 语句（可以将 CSV 文件快速读取到服务器中）上包含一堆行，一次插入一行执行 INSERT INTO 非常慢。

另请参阅： [https ://dba.stackexchange.com/questions/16809/why-is-load-data-infile-faster-than-normal-insert-statements](https://dba.stackexchange.com/questions/16809/why-is-load-data-infile-faster-than-normal-insert-statements)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:46:46.207

一些快速的伪代码。做这个：

```
for row in data_to_be_inserted:
    stmt = compose_statement("lalala")
    cursor.execute()

connection.commit() 
```

不是

```
for row in data_to_be_inserted:
    stmt = compose_statement("lalala")
    cursor.execute()
    connection.commit() 
```

Your code commit()s once per line of input. That slows it down significantly.

# ruby-on-rails - 在 rails 3.2 中使用 i18n 框架的 sunspot

> ID：10402341
> 
> 赞同：0
> 
> 时间：2012-05-01T18:30:16.983
> 
> 标签：ruby-on-rails, ruby-on-rails-3, internationalization, sunspot

我正在使用[sunpost gem](https://github.com/sunspot/sunspot)在我的 rails 项目中进行搜索。

我的应用程序现在有两种语言：

```
I18n.default_locale = :en
LANGUAGES = [
['English',
'en'],
["Espa&ntilde;ol".html_safe, 'es']
] 
```

我的**post.rb**模型中有一个语言属性，其中包含西班牙语的值**“es”或英语的值****“en”**。

我在**索引操作中的****posts_controller**中有下一个方法：

 **```
def index
   @search = Post.solr_search do |s|
     s.fulltext params[:search]
     s.keywords params[:search]
     s.order_by :created_at, :desc
     s.paginate :page => params[:page], :per_page => 20
   end

   @posts = @search.results

    respond_to do |format|
    format.html # index.html.erb
    format.xml  { render :xml => @posts }
    format.js
  end 
 end 
```

`I18n.locale.to_s`我使用此代码**“es”**或**“en”**获得当前语言

 ****我的问题是：我怎样才能只显示我网站中用户当前使用的语言的结果？**

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T01:19:49.297

如果您可以在帖子模型中发布可搜索块，那将非常有帮助。但在那之前，我会试一试。

您的 Post 模型应如下所示：

```
class Post < ActiveRecord::Base
  searchable do
    ...
    string :language
    ...
  end
end 
```

您在哪里为帖子编写/存储的语言编制索引。

然后你的控制器使用语言字段作为过滤器。它应该看起来像：

```
def index
  @search = Post.search do |s|
    s.keywords params[:search]
    s.with(:language, I18n.locale.to_s) if I18n.locale.present?
    s.order_by :created_at, :desc
    s.paginate :page => params[:page], :per_page => 20
  end

  @posts = @search.results

  respond_to do |format|
    format.html # index.html.erb
    format.xml  { render :xml => @posts }
    format.js
  end 
end 
```

你有它！****

# visual-studio-2010 - 如何在 Visual Studio 2010 中禁用中断用户未处理的异常？

> ID：10402343
> 
> 赞同：2
> 
> 时间：2012-05-01T18:30:26.440
> 
> 标签：visual-studio-2010, silverlight, unit-testing, windows-phone-7, exception

我发现最常见的建议是通过`Debug > Exceptions`对话框禁用它们。我已经这样做了，但是 VS2010 仍然会在所有用户未处理的异常上中断。这在预期某些异常的单元测试期间尤其令人讨厌。这是一个错误，还是我做错了什么？请参阅下面的屏幕截图。

![在此处输入图像描述](../Images/1a801f6ab4c4900156e806901e0d9db0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:50:33.550

我假设您正在使用内置的测试运行器和`MSTest`. 首先，确保您没有在调试模式下运行测试。此外，可以通过使用（运行）键盘快捷键运行测试来规避此问题：

*   `CTRL`+ `R`，然后`T`

    在上下文中运行测试（即光标所在的位置、方法、类或命名空间中）

*   `CTRL`+ `R`，然后`A`

    运行程序集中的所有测试

> **注意：** ++`CTRL`和++`R`将调试测试。`T``CTRL``R``A`

# c++ - 得到错误 SIMD 操作

> ID：10402349
> 
> 赞同：0
> 
> 时间：2012-05-01T18:31:04.757
> 
> 标签：c++, simd

`k=0`我想计算`k=100`

```
A[j][k]=((A[j][k]-con*A[r][k])%2); 
```

为此，我将存储`(con*A[r][k])`在一些中`int temp[5]` ，然后`A[j][k]-temp[]`在 SIMD 中执行以下代码中的错误，为行提供分段错误 `__m128i m5=_mm_sub_epi32(*m3,*m4);`

```
while((k+4)<100)
{       
    __m128i *m3 = (__m128i*)A[j+k]; 

    temp[0]=con*A[r][k];
    temp[1]=con*A[r][k+1];
    temp[2]=con*A[r][k+2];
    temp[3]=con*A[r][k+3];

    __m128i *m4 = (__m128i*)temp;
    __m128i m5 =_mm_sub_epi32(*m3,*m4);
    (temp_ptr)=(int*)&m5;
    printf("%ld,%d,%ld\n",A[j][k],con,A[r][k]);

    A[j][k]  =temp_ptr[0]%2;
    A[j][k+1]=temp_ptr[1]%2;
    A[j][k+2]=temp_ptr[2]%2;
    A[j][k+3]=temp_ptr[3]%2;

    k=k+4;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:14:07.203

很可能，您没有注意对齐。SIMD 指令需要 16 字节对齐（请参阅[本文](http://www.songho.ca/misc/alignment/dataalign.html)）。否则，您的程序将崩溃。

要么对齐，要么你在某处有错误的索引，并访问了错误的内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:41:47.410

如果没有 j、k 和 r 的可能值，很难说出原因，但很可能您对数组之一进行了过度索引

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:32:53.703

如果你想实现：

```
for (k = 0; k < 100; k += 4)
{
    A[j][k] = (A[j][k] - con * A[r][k]) % 2;
} 
```

并且您想从 SIMD 中看到一些好处，那么您需要在 SIMD 中完成这一切，即不要混合 SIMD 和标量代码。

例如（未经测试）：

```
const __m128i vcon = _mm_set1_epi32(con);
const __m128i vk1 = _mm_set1_epi32(1);
for (k = 0; k < 100; k += 4)
{
    __m128i v1 = _mm_loadu_si128(&A[j][k]); // load v1 from A[j][k..k+3] (misaligned)
    __m128i v2 = _mm_loadu_si128(&A[r][k]); // load v2 from A[r][k..k+3] (misaligned)

    v2 = _mm_mullo_epi32(v2, vcon);         // v2 = con * A[r][k..k+3]
    v1 = _mm_sub_epi32(v1, v2);             // v1 = A[j][k..k+3] - con * A[r][k..k+3]
    v1 = _mm_and_si128(v1, vk1);            // v1 = (A[j][k..k+3] - con * A[r][k..k+3]) % 2

    _mm_storeu_si128(&A[j][k], v1);         // store v1 back to A[j][k..k+3] (misaligned)
} 
```

注意：如果您可以保证 A 的每一行都是 16 字节对齐的，那么您可以将未对齐的加载/存储 ( `_mm_loadu_si128`/ `_mm_storeu_si128`) 更改为对齐的加载/存储 ( `_mm_load_si128`/ `_mm_store_si128`) - 这将有助于提高性能，具体取决于您的目标 CPU。

# c++ - 通过访问器函数使用重载的 operator[]

> ID：10402354
> 
> 赞同：3
> 
> 时间：2012-05-01T18:31:16.590
> 
> 标签：c++, operator-overloading, accessor

我有一个访问器函数，它返回对类型 (std::map) 的 const 引用 ... ...

```
myMap_t const& getMap() const {return paramMap;} 
```

该类型有一个重载的`[]`运算符。然后以如下方式直接从 getter 函数中使用运算符的语法是什么`[]`，但这实际上是有效的。

```
parameter = contextObj.getMap()[key]; 
```

错误信息是：

```
context.cpp:35: error: passing   
  'const std::map<
     std::basic_string<char, std::char_traits<char>, std::allocator<char> >, 
     float, 
     std::less<std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, 
     std::allocator<std::pair<
       const std::basic_string<char, std::char_traits<char>, std::allocator<char> >,
       float> > >'
as 'this' argument of 
  '_Tp& std::map<_Key, _Tp, _Compare, _Alloc>::operator[](const _Key&)  
with 
  _Key = std::basic_string<char, std::char_traits<char>, std::allocator<char> >,
  _Tp = float, 
  _Compare = std::less<std::basic_string<char, std::char_traits<char>,  td::allocator<char> > >, 
  _Alloc = std::allocator<std::pair<
    const std::basic_string<char, std::char_traits<char>, std::allocator<char> >, 
    float> >]' 
discards qualifiers 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T18:37:29.027

问题是`operator[]`在地图中是一个变异操作，你不能在对地图的 const 引用上调用它。它发生变异的原因是它必须返回一个值的引用，为此，如果容器中不存在该键，它将插入一个由该键寻址的新默认构造值并返回对它的引用.

如果你有一个 const 引用，并且你想确定一个元素是否存在（或访问它），你必须使用`std::map<>::find`它将返回一个迭代器。如果元素不存在，则迭代器的值将是`m.end()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T18:38:46.893

您返回`std::map`by const 引用，但`std::map::operator[]`不是 const 函数，因为有时它需要更改映射。
要解决此问题，您应该执行以下操作之一：
(A) 使用`.find`而不是`[]`

```
auto iter = contextObj.getMap().find( key );
if (iter != contextObj.getMap().end())
    param = iter->second; 
```

(B) 将映射返回为非 const（不推荐）
(C) 制作一个包装类（大多数时候不值得）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T18:39:15.820

`const myMap_t&`你从你的方法返回一个`getMap()`。从您的错误消息`myMap_t`中可以看出 a 的 typedef `std::map`。Ther `operator[]`of`std::map`需要一个可修改的对象（不能在 const 上调用），因为它可以将项目插入到地图中（如果不存在具有指定键的项目，它将向地图中插入一个并返回对该项目的引用）。要解决该问题，您有两种选择：

*   使用`contextObj.getMap().find(key)`而不是`contextObj.getMap()[key]`获取元素的迭代器（或者`map.end()`如果它不存在）
*   返回`myMap_t&`（不带 const）以获取可在其`operator[]`上调用的可修改对象

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T19:17:17.167

```
context.cpp:35: error: passing   
  'const std::map<
     std::basic_string<char, std::char_traits<char>, std::allocator<char> >, 
     float, 
     std::less<std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, 
     std::allocator<std::pair<
       const std::basic_string<char, std::char_traits<char>, std::allocator<char> >,
       float> > >'
as 'this' argument of 
  '_Tp& std::map<_Key, _Tp, _Compare, _Alloc>::operator[](const _Key&)  
with 
  _Key = std::basic_string<char, std::char_traits<char>, std::allocator<char> >,
  _Tp = float, 
  _Compare = std::less<std::basic_string<char, std::char_traits<char>,  td::allocator<char> > >, 
  _Alloc = std::allocator<std::pair<
    const std::basic_string<char, std::char_traits<char>, std::allocator<char> >, 
    float> >' 
discards qualifiers 
```

`std::basic_string`是用来实现的模板`std::string`，确实`std::string`是简单的基于的实例​​化`char`。所以首先替换它：

```
context.cpp:35: error: passing   
  'const std::map<
     std::string, 
     float, 
     std::less<std::string>, 
     std::allocator<std::pair<const std::string, float> >
  >'
as 'this' argument of 
  '_Tp& std::map<_Key, _Tp, _Compare, _Alloc>::operator[](const _Key&)  
with 
  _Key = std::string,
  _Tp = float, 
  _Compare = std::less<std::string>, 
  _Alloc = std::allocator<std::pair<const std::string> >' 
discards qualifiers 
```

我们并不真正关心地图的`_Compare`(comparison function) 和`_Alloc`(allocator) 参数，因为我们只是使用默认值；所以让我们忽略这些，让我们也将`_Key`and`_Tp`值替换到模板描述中：

```
context.cpp:35: error: passing   
  'const std::map<std::string, float>'
as 'this' argument of 
  'float& std::map<std::string, float>::operator[](const std::string&)  
discards qualifiers 
```

就这样，简单多了。我们正在使用`operator[]`of our `std::map<std::string, float>`，并且我们正在尝试在 a 上使用它`const std::map<std::string, float>`（即，这就是我们用作`this`调用的参数的内容）。这“丢弃限定符”，特别是`const`限定符。

编译器告诉您`operator[]`地图的 不承诺保留地图`const`，即允许更改地图。这是一个编译器错误，因为代码是使用内置断言编写的，即映射不会更改。

为什么地图会变？好吧，看看文档：

> 如果 x 匹配容器中元素的键，则该函数返回对其映射值的引用。
> 
> 如果 x 不匹配容器中任何元素的键，则该函数*使用该键插入一个新元素*并返回对其映射值的引用。请注意，这总是将映射大小增加一，即使没有为元素分配映射值（该元素是使用其默认构造函数构造的）。

（强调我的）。

插入元素当然是一种修改。

为什么这样做？好吧，[我们已经有一个问题了](https://stackoverflow.com/questions/1639544/why-does-stdmap-operator-create-an-object-if-the-key-doesnt-exist)。

# java - 如何组合两个文本文件中的元素并将它们放在java中的第三个文件中

> ID：10402356
> 
> 赞同：-1
> 
> 时间：2012-05-01T18:31:26.423
> 
> 标签：java

我有两个文件 Persons.txt 和 Hobby.txt。在第三个文件中，我想放置所有人员的姓名并为每个姓名添加一些 hobbies。我从人员文件中读取了姓名，但我不知道如何添加每个人不同的爱好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T18:44:27.193

作为初学者，请以这种方式考虑。

阅读persons.txt，然后阅读hobby.txt——你知道怎么做

创建字符串列表 - 您希望第三个文件的外观。

```
List<String> stringToWriteList = new ArrayList<String>(); 
```

将字符串添加到列表中——您可能希望为每个人循环 person.txt 文件，然后您需要定义如何获得 hoppy——也许是随机的？

```
stringToWrite.add(person1 +", "+ hoppy1);  // Depends on the hobby logic 
```

然后只需将字符串列表写入文件

```
try {
  BufferedWriter out = new BufferedWriter(new FileWriter("test.txt"));

  for(String line : stringToWriteList ){
    out.write(line);
    out.newLine();
  }
  out.close();
} catch (IOException e) {
  System.out.println("Exception ");     
} 
```

有更多的技术方法可以做到这一点，但这个例子的想法是让新手学习一两个关于如何写入文件的新东西——更容易阅读\理解。

# c++ - 如何减少或消除通过从 16 位 PCM 更改样本的“音量”而产生的噪音

> ID：10402362
> 
> 赞同：2
> 
> 时间：2012-05-01T18:31:44.393
> 
> 标签：c++, wav, pcm, 16-bit

我目前正在做一个小项目，我正在加载采样率为 44100Hz 的 16 位波形文件。在正常播放中，音频看起来不错，但是一旦我开始播放诸如振幅大小之类的东西来改变音量，它就会开始发出一点点静态噪音。

我正在做的是在这个 16 位类型的情况下从缓冲区中获取一个样本短，将其转换为 -1 到 1 范围内的浮点数以开始进行混合和其他效果。在这我也改变了音量，当我只是将它乘以 1 给出相同的输出时，它很好，但是一旦我开始改变音量，我就会听到静态噪音。当超过 1.0 和低于 1.0 时会发生这种情况。规模越大或越小，情况就会变得更糟。

有人知道如何减少或消除噪音吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T02:11:03.107

“静态”，也称为“咔哒声”，是输出信号不连续的结果。这是一个不连续性的完美示例：

[http://en.wikipedia.org/wiki/File:Discontinuity_jump.eps.png](http://en.wikipedia.org/wiki/File:Discontinuity_jump.eps.png)

如果您将音频缓冲区发送到系统进行播放，然后为下一个缓冲区将每个样本乘以 1.1，则可以创建不连续性。例如，考虑一个包含正弦波的缓冲区，其值从 [-0.5, 0.5] 开始。你将这个波的一部分发送到输出设备，最后一个样本恰好是 0.5。

现在，在您的下一个缓冲区中，您尝试通过乘以 1.1 来调整音量。新缓冲区的第一个样本将接近 0.5（因为之前的样本是 0.5）。将其乘以 1.1，得到 0.55。

从一个样本更改为 0.05 的下一个样本可能听起来像是咔哒声或砰砰声。如果你创建了足够多的这些，它会听起来像静态的。

解决方案是在缓冲区上“增加”音量变化。例如，如果您想对 100 个样本的缓冲区应用 1.1 的增益，而之前的增益是 1.0，那么您将从增益 1 开始循环遍历所有 100 个样本并平滑地增加增益，直到到达最后一个样本，此时你的增益应该是 1.1。

如果您想要此代码的示例，请查看 juce::AudioSampleBuffer::applyGainRamp：

[http://www.rawmaterialsoftware.com/api/classAudioSampleBuffer.html](http://www.rawmaterialsoftware.com/api/classAudioSampleBuffer.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:55:42.247

I found the flaw, I was abstracting different bit data types by going to their data using char*, I did not cast the usage of it to the correct datatype pointer. This means bytes were cut off when giving it data. This created the noise and volume changing bugs amongst others.

A flaw of my implementation and me not thinking about this when working with the audio data. A tip for anyone doing the same kind of thing, keep a good eye when modifying data, check which type your data is when using abstractions.

Many thanks to the guys trying to help me, the links were really interesting and it did learn me more things about audio programming.

# javascript - 构建后对 ejs 视图文件的引用不会改变，尽管它在 production.js - Javascript MVC 中结合了它

> ID：10402371
> 
> 赞同：1
> 
> 时间：2012-05-01T18:32:33.443
> 
> 标签：javascript, jquery, model-view-controller, javascriptmvc, ejs

在代码中，我们使用这样的东西：

```
$('#wrapper').html('//app/views/content.ejs', {foo:"bar"}); 
```

当我们构建应用程序时，这仍然保持不变，尽管 content.ejs 文件已内置到 production.js 中。

所以我的问题是，**我们应该怎么做，以便在构建应用程序时，这些引用指向 production.js 中的 ejs 文件？**

我们正在使用 JMVC 3.2.2

我们也尝试过使用这种方式：

```
$('#wrapper').html( $.View('//app/views/content.ejs', {foo:"bar"}) ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:01:26.887

您的视图未添加到 production.js；你需要偷走它们中的每一个：

```
steal('//app/views/content.ejs'); 
```

JMVC 3.1：

```
steal.views('//app/views/content.ejs'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T17:32:37.060

在 JMVC 论坛中得到答案：[https ://forum.javascriptmvc.com/topic/#Topic/32525000000958049](https://forum.javascriptmvc.com/topic/#Topic/32525000000958049)

归功于：柯蒂斯卡明斯

回答：

> 视图的路径不需要更改。
> 
> 创建 production.js 文件后，您的视图将包含在内并在脚本运行时预加载。当您引用：“//app/views/content.ejs”时，视图首先检查您请求的视图文件是否已预加载，如果已预加载，将使用该文件而不是请求 .ejs 文件。

# windows - 从列表视图中获取文本

> ID：10402374
> 
> 赞同：1
> 
> 时间：2012-05-01T18:32:56.540
> 
> 标签：windows, windows-phone-7

我按照此链接 [http://www.coderzheaven.com/2012/03/23/how-to-create-a-custom-listbox-in-windows-phone-7/中的教程制作了一个自定义列表视图](http://www.coderzheaven.com/2012/03/23/how-to-create-a-custom-listbox-in-windows-phone-7/)

我的需要是我想在单击特定行时获取每一行的标题和副标题。有没有办法在不从提供文本的数组中获取文本的情况下获取文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:17:10.910

```
public class Account
{
   public string Title { get; set; }
   public string SubTitle { get; set; }
   public string ImageUrl { get; set; }
} 
```

主页.xaml

```
<ListBox Margin="12,75,12,0" Name="L1"  SelectionChanged="ListBox_SelectionChanged">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="0,0,0,17" Width="432" Height="78">
                                <TextBlock  TextWrapping="Wrap" Text="{Binding Title}" Style="{StaticResource PhoneTextExtraLargeStyle}"/>
                                <TextBlock  TextWrapping="Wrap" Text="{Binding SubTitle}" Margin="12,-6,12,0" Style="{StaticResource PhoneTextSubtleStyle}"/>
                            </StackPanel>
                        </DataTemplate>
</ListBox.ItemTemplate>
                </ListBox>

MainPage.xaml.cs 
```

公共 ObservableCollection MyAccounts { 获取；放; }

```
public MainPage()
{
  Loaded += MainPageLoaded;
}
// Load data for the ViewModel Items
        private void MainPageLoaded(object sender, RoutedEventArgs e)
        {
                MyAccounts = GenerateAccounts(); //populate your list
                L1.ItemsSource = MyAccounts;

        }

        private void ListBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
               var lb = (ListBox)sender;
               if (lb.SelectedIndex == -1)return;
               var account = (Account)sender.SelectedItem;
              //get properties from Account npw.
              lb.SelectedIndex = -1;
        }
} 
```

# iphone - 将导入的照片保存在 xcode 项目中

> ID：10402376
> 
> 赞同：0
> 
> 时间：2012-05-01T18:32:59.730
> 
> 标签：iphone, xcode, ios5, save

我对模型和保存数据仍然有些困惑，也许有人可以帮助我。我有一个页面，用户可以在其中从相机胶卷导入照片。当我移至下一页时，它又消失了。我可以将文本数据保存在文本框中的 NString 中，但我不确定如何使用图像执行此操作。图像显示在 UI webview 中。

代码 4.3

```
 UIImagePickerController * picker = [[UIImagePickerController alloc] init];
    picker.delegate = self;

    if((UIButton *) sender == choosePhotoBtn) {
        picker.sourceType = UIImagePickerControllerSourceTypeSavedPhotosAlbum;
    }

    [self presentModalViewController:picker animated:YES];

}

- (void)imagePickerController:(UIImagePickerController *)picker        didFinishPickingMediaWithInfo:(NSDictionary *)info {
    [picker dismissModalViewControllerAnimated:YES];
    imageView.image = [info objectForKey:@"UIImagePickerControllerOriginalImage"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:48:02.963

首先尝试发布一些你的问题的代码。它让我们更好地帮助你。

好吧，从我推测的问题是，当您推送到新视图时，您正在丢失图像。好吧，我遇到了这个问题，我使用 Singleton Class 解决了它。它有点创建全局元素，你可以存储你喜欢保存的值。包括图像，类对象（你命名它）

你可以保存尽可能多的值，你甚至不必将它存储在你的库中。

尝试在 Internet 上阅读 Singleton Classes 我相信我们的好朋友 Google 一定会帮助你

**已编辑 -------- 关于 SINGLETON**

好的，因为你已经阅读过关于 Singleton 的信息。你可能已经注意到为什么我们使用单例类，单例的主要目的是保存全局变量，但你知道你不知道。！！！所以关于你的问题，当你选择一个图像（从相机或照片库）时，它会返回给你一个 UIImage 的对象。

你必须有一个单例类

```
#import <Foundation/Foundation.h>

@interface Singleton : NSObject

{
        //Global  Variables

        //UImage Instance that will Store The Image From Picker
        UIImage *photoPicked;    
}

//Getter And Setter
@property (nonatomic,retain)  UIImage *photoPicked ;

//Shared SIngleton CLass
+(Singleton*)sharedSingletonController;
@end 
```

M 文件看起来像这样

```
#import "Singleton.h"

@implementation Singleton
@synthesize imagePicked;

//Class Function For SingleTon

+(Singleton*)sharedSingletonController{

    static Singleton *sharedSingleton;

    @synchronized(self) {
        if(!sharedSingleton){
            sharedSingleton = [[Singleton alloc]init];
        }
    }

    return sharedSingleton;
}

//I don't want a re-initialization for these variables
-(id)init{
    self = [super init];
    if (self != nil) {

        }
    return self;
}

@end 
```

现在你要做的就是在想要使用单例 Image 变量的类中调用 sharedSingletonController 函数，是的，不要忘记创建单例类的对象

类似的东西

```
Singleton *yourSingletonObj = [Singleton sharedSingletonController]; 
```

现在你可以将你的图像存储在单例中

```
yourSingletonObj.image = (YOUR IMAGE FROM PICKER); 
```

现在图像将保存在您的 Singleton 对象中。因此，当它不会丢失并且您可以在任何时候和任何您喜欢的课程中使用它时

干杯让我知道它是否有效 W

# python - 如果从 B 调用 Af，模块 A 中定义的 Af 如何获取 B 中定义的函数列表

> ID：10402377
> 
> 赞同：0
> 
> 时间：2012-05-01T18:33:18.857
> 
> 标签：python, introspection

假设我有`B.py`

```
import A

def F():
    pass

def G():
    pass

if __name__ == '__main__':
    A.f() 
```

当我运行它时，我想输出这样`A.f`定义的函数列表`B.py`

```
./B.py
['F', 'G'] 
```

问题是我应该写`A.py`什么？

```
def f():
    ??? 
```

这似乎是可能的，因为`doctest`做这样的事情。

**更新**感谢您的回复，但我忘了再提一个限制：我不想`import B`在`A.py`.

让我试着解释一下为什么：`A.py`是一个运行 MapReduce 作业的库。您只需在脚本的不同端导入`A`并运行一些。`A.f`然后`A.f`分析您定义的功能并在服务器上执行它们。所以`A.f`不能导入它被调用的每个模块。

或者可以吗？函数可以知道它是从哪里调用的吗？

**更新**

```
def f():
    module = sys.modules['__main__']
    functions = inspect.getmembers(module, inspect.isfunction)
    ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T18:38:05.823

```
def f():
    import B
    import inspect

    functions=inspect.getmembers(B,inspect.isfunction) 
```

[http://docs.python.org/library/inspect.html#inspect.getmembers](http://docs.python.org/library/inspect.html#inspect.getmembers)

**编辑**

我还没有尝试过，但似乎您可以将模块作为参数传递给 f 并使用它。

```
def f(mod):
    import inspect
    functions=inspect.getmembers(mod,inspect.isfunction)
    return functions 
```

然后，从 B，您可以执行以下操作：

```
import sys
import A
myfuncs=A.f(sys.modules[__name__]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T18:36:50.003

[使用该`dir()`函数](http://docs.python.org/tutorial/modules.html#the-dir-function)实际上很容易做到这一点：

```
import B

def f():
    print(dir(B)) 
```

这使：

```
['A', 'F', 'G', '__builtins__', '__cached__', '__doc__', '__file__', '__name__', '__package__'] 
```

如您所见，这确实包含了模块中通常看不到的隐藏值。如果您想更具体地了解您想要的东西，请[查看`inspect`模块](http://docs.python.org/library/inspect.html)。

# cocoa - 将子视图添加到 NSView 以获得类似国际象棋的网格

> ID：10402378
> 
> 赞同：1
> 
> 时间：2012-05-01T18:33:19.683
> 
> 标签：cocoa, nsview, subview, nsviewcontroller

我正在尝试创建一个由两组正方形（类似象棋的网格）组成的 Cocoa UI，它们在底层算法运行时将采用不同的颜色。当算法的执行结束时，UI 应该能够处理点击、平移和其他手势。

到目前为止，我的层次结构如下（请查看随附的代码了解详情）：

1) 主窗口，即窗口控制器的窗口

2) 具有两个自定义视图 mainView 和 sideView 的拆分视图（每个视图都包含一组正方形）

3）两个视图控制器（mainViewController和sideViewController）

我希望能够将正方形加载为 mainView 和 sideView 的子视图。

我想有另一个自定义视图，比如 SquareView 和另一个 nib 文件。我的问题是：

a) 我如何创建这个 SquareView 以便它可以用于创建将作为子视图添加到 mainView 和 sideView 以形成类似国际象棋的网格的正方形？

b) 如何将子视图添加到 mainView 和 sideView 以构建两个网格？为简单起见，我们假设前面提到的每个视图都有四个不重叠的正方形。

谢谢！

* * *

主视图.m

```
#import "MainView.h"

@implementation MainView

- (void)drawRect:(NSRect)TheRect 
{
    [[NSColor grayColor] set];
    [NSBezierPath fillRect:[self bounds]];
} 
```

侧视图.m

```
#import "SideView.h"

@implementation MainView

- (void)drawRect:(NSRect)TheRect 
{
    [[NSColor whiteColor] set];
    [NSBezierPath fillRect:[self bounds]];
} 
```

主窗口控制器.h

```
#import <Cocoa/Cocoa.h>

@class SideViewController;
@class MainViewController;

@interface MainWindowController : NSWindowController 
{
    IBOutlet NSSplitView* oMainSplitView;
    SideViewController* sideViewController;
    MainViewController* mainViewController;

}

@end 
```

主窗口控制器.m

```
#import "MainWindowController.h"
#import "SideViewController.h"
#import "MainViewController.h"

@implementation MainWindowController

- (void)windowDidLoad
{

   sideViewController = [[SideViewController alloc] initWithNibName:@"SideView" bundle:nil];
   NSView* splitViewLeftView = [[oMainSplitView subviews] objectAtIndex:0];
   NSView* sideView = [sideViewController view];
   [sideView setFrame:[splitViewLeftView bounds]];
   [sideView setAutoresizingMask:(NSViewWidthSizable | NSViewHeightSizable)];
   [splitViewLeftView addSubview:sideView];

   mainViewController = [[MainViewController alloc] initWithNibName:@"MainView" bundle:nil];
   NSView* splitViewRightView = [[oMainSplitView subviews] objectAtIndex:1];
   NSView* mainView = [mainViewController view];
   [mainView setFrame:[splitViewRightView bounds]];
   [mainView setAutoresizingMask:(NSViewWidthSizable | NSViewHeightSizable)];
   [splitViewRightView addSubview:mainView];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T23:25:00.557

You can make this as simple or as complicated as you desire: simple? do everything you want in MainView's drawRect method; complex: nest NSViews (or NSCell's, or NSBox's, etc.) and have each one draw itself.

Personally, I'd vote to keep it simple…</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:00:18.783

a）我认为最简单的方法是创建一个 NSBoxes 矩阵，您可以在代码或 IB 中执行此操作。将正方形放在矩阵中可以很容易地遍历它们或访问特定的正方形。

b) 我不确定你的问题是什么——你会像在发布的代码中那样使用 [mainView addSubview:squareMatrix];

编辑后：实际上，IB 似乎不允许您将 NSBoxes 嵌入矩阵中。过去，我制作了一个子类 NSButtonCells 矩阵（以允许没有边框的背景颜色），它有一个 64x64 单元格的网格，这些单元格是可点击的，并且会随着这些点击而改变颜色。我不知道您是否希望视图中的单元格数量固定，还是需要动态更改数量？我认为这样的东西可能对你有用——我实际上是在代码中创建的，因为 IB 在更新这么多单元时真的很慢。

这就是我所做的。在我的例子中，我需要没有边框但有背景颜色的单元格，所以我必须将 NSButtonCell 子类化，如下所示：

```
-(id)initWithRGBAlpha:(NSArray *)rgbAlpha {
    if (self == [super init]) {
    NSColor *color = [NSColor colorWithCalibratedRed:[[rgbAlpha objectAtIndex:0]doubleValue]
                                               green:[[rgbAlpha objectAtIndex:1]doubleValue] 
                                                blue:[[rgbAlpha objectAtIndex:2]doubleValue] 
                                               alpha:[[rgbAlpha objectAtIndex:3]doubleValue]];
    [self setBackgroundColor:color];
    [self setTitle:@""];
    [self setBordered:NO];
    [self setTag:0];
    [self setImageScaling:3];
    return self;
    }else{
        return nil;
    }
}

-(void) setState:(NSInteger)value {
    if (value == 1) {
        self.backgroundColor = self.selectedColor;
        [super setState:value];
    }else {
        self.backgroundColor = self.backgroundColor;
        [super setState:value];
    }
}

-(void) setBackgroundColor:(NSColor *)color {
    backgroundColor = color;
    selectedColor = [color colorWithAlphaComponent:.75];
}

- (void)encodeWithCoder:(NSCoder *)encoder {
    [super encodeWithCoder:encoder];
    [encoder encodeObject:self.backgroundColor forKey:@"bColor"]; 
}

- (id)initWithCoder:(NSCoder *)decoder {
    [super initWithCoder:decoder];
    self.backgroundColor = [decoder decodeObjectForKey:@"bColor"];
    return self;
} 
```

我在代码中创建了矩阵，如下所示：

```
@implementation RDMatrix

-(void) initWithParentView:(NSView *) cv {
    NSNumber *one = [NSNumber numberWithInt:1];
    NSArray *colors = [NSArray arrayWithObjects:one,one,one,one,nil];
    RDButtonCell *theCell = [[RDButtonCell alloc ]initWithRGBAlpha:colors];
    [self initWithFrame:NSMakeRect(200,100,1,1) mode:2 prototype:theCell numberOfRows:64 numberOfColumns:64]; 
    [self setSelectionByRect:TRUE];
    [self setCellSize:NSMakeSize(8,8)];
    [self sizeToCells];
    self.target = self;
    self.action = @selector(matrixClick:);
    self.backgroundColor = [NSColor lightGrayColor];
    self.drawsBackground = TRUE;
    self.autoresizingMask = 8;
    self.allowsEmptySelection = TRUE;
    [cv addSubview:self]; 
}

-(void) matrixClick: (id) sender {
    for  (RDButtonCell *aCell in self.selectedCells){
        if ([self.selectedCells count] < 64) {
             aCell.backgroundColor = [NSColor colorWithCalibratedRed:1 green:0 blue:0 alpha:1];
        }else{
        aCell.backgroundColor = [NSColor colorWithCalibratedRed:0 green:.5 blue:1 alpha:1];
        }
    }
    [self deselectAllCells];
}
@end 
```

# windows - Windows CMD 中是否有与 bash 或 tcsh 中等效的源命令？

> ID：10402379
> 
> 赞同：45
> 
> 时间：2012-05-01T18:33:19.580
> 
> 标签：windows, bash, unix, cmd, tcsh

我知道在 unix 世界中，如果您编辑`.profile`or`.cshrc`文件，您可以执行`source ~/.profile`or`source ~/.cshrc`以对当前会话产生影响。如果我在 Windows 上更改了系统变量中的某些内容，如何在不退出命令提示符会话并打开另一个命令提示符会话的情况下使其影响当前的命令提示符会话？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-05-08T14:17:12.440

在通常的 Windows 命令提示符（即 cmd.exe）中，只需使用`call mybat.bat`我想要的。我得到了它设置的所有环境变量。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-01T22:15:41.080

dos shell 将支持 .bat 文件，其中仅包含对变量的赋值，这些变量在执行时将在当前环境中创建变量。

```
 c:> type EnvSetTest.bat
  set TESTXYZ=XYZ

  c:> .\EnvSetTest.bat

  c:> set | find "TESTX"
  TESTXYZ=XYZ
  c:> 
```

IHTH。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-06-11T07:31:26.060

以下示例将帮助您解决问题。

`env.bat`该文件用于设置变量。它的内容受到打击。

```
set name="test3" 
```

`test.bat` 我们的主要批处理文件。

```
call env.bat
call print.bat
pause 
```

现在`print.bat`批处理文件打印变量。其内容如下

```
echo %name% 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-01T18:40:20.140

恐怕不会，但您可以开始使用支持点源的 Powershell。由于 powershell 窗口实际上是基于 cmd 的，因此您的所有 dos 命令将继续工作，并且您获得了新的权力，更多的权力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-25T17:13:45.287

我发现这个工作的唯一方法是从我自己的配置窗口启动一个新的 cmd 窗口。例如：

```
@echo off
echo Loading...
setlocal enabledelayedexpansion
call 1.cmd
call 2.bat
...
...
if "%LocalAppData%"=="" set LocalAppData=%UserProfile%\Local Settings\Application Data
SET BLAHNAME=FILE:%LocalAppData%\BLAH
call blah blah
cmd 
```

最后一个 cmd 将启动一个新的 cmd 提示符，并将所需的设置导出到命令窗口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-07T00:31:58.273

这是一些有限用例的*解决方法。*您可以读入命令文件并在线执行它们。例如调用命令文件如下所示：

```
echo   OFF
SETLOCAL  ENABLEDELAYEDEXPANSION
     :
echo.         ----------------
echo.           set-up java
echo.         ----------------
echo.
rem       call    %DEV_SCRIPTS%\setup-java
for /F "tokens=*" %%A in ( %DEV_SCRIPTS%\setup-java.bat ) do (
    %%A
)        
call    %DEV_SCRIPTS%\show-java
     : 
```

在`setup-java.bat`文件中你不能使用`%`扩展。你需要使用`!`; 例如：

```
 set  JRE_HOME=!JRE_08!
    rem        
    set  JRE_TARGET=!JRE_HOME! 
```

所以你是`source`从文本文件中乱写命令。您将需要测试*以*这种方式获取的命令。只是为了设置一些环境变量而进行了几次试验。

我不认为我们可以做逻辑或循环，因为命令处理器在开始时会扫描文件。我只是有一个简单的解决方法来重用环境定义等共享的东西。大多数其他事情都不需要实际的`source`命令（*我希望*）。祝你好运。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-01-12T06:56:21.833

例如设置 VC# vars

```
C:\Windows\System32\cmd.exe /k "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" 
```

* * *

## 回答 #8

> 赞同：-8
> 
> 时间：2018-06-11T07:26:22.707

在 Windows 上使用 git bash，它工作得很好！

# backbone.js - 骨干文件未在 QUnit 测试中导入

> ID：10402380
> 
> 赞同：1
> 
> 时间：2012-05-01T18:33:27.213
> 
> 标签：backbone.js, qunit

我们在我们开发的应用程序（由一位同事编写）中使用 Backbone，我的任务是添加单元测试框架来验证我们的应用程序的持续集成的正确性。在开始看其他东西之后，我正在尝试 qUnit，因为它看起来很简单。一开始，我想在 qUnit 中创建一个简单的 Backbone 模型，但遇到了麻烦。希望有人能启发我。开始：

为了代码的组织和清晰，我们约定以**App.Models**为前缀命名我们的 Backbone 模型。例如，我们有 App.Models.Target，它扩展了 App/Models/ 文件夹下 Target.js 中的 Backbone.Model。

在 qUnit 中，我有：

```
test( "Target is valid, Target edit should return true", function() {
    var model = new App.Models.Target();
    console.log(JSON.stringify(model));
    ok(true);
}); 
```

如果没有有用的消息，它会失败但显示很少。

因此，我尝试将 App.Models.Target 重命名为简单的 Target，并在我的 qUnit 测试中再次将 App.Models.Target 替换为 Target，一切正常。我非常确信错误是由前缀引起的，但是删除这些前缀对我来说似乎是倒退（如果您无论如何都可以运行代码，测试框架应该能够处理这些事情，对吧？）。

我认为，（我希望）有一种方法可以做到这一点，而无需重命名我们的 Backbone 实体以删除我们的前缀。我只是还没有从互联网上看到一个。所有的例子都显得如此微不足道。

有人可以提供提示/建议来解决我的问题吗？任何帮助将不胜感激！

# web-services - RESTful Web 服务中大型资源的页面大小？

> ID：10402383
> 
> 赞同：0
> 
> 时间：2012-05-01T18:33:57.957
> 
> 标签：web-services, http, rest

我正在开发一个 RESTful Web 服务，它将为大型数据集提供服务，将数据集分页成合理大小的 JSON 块。

除了我的应用程序的细节之外，在选择页面大小时是否有任何一般性建议需要考虑？

我知道 POST 大小通常有限制（例如 Tomcat 为 2 MB），但我主要关心的是 GET 请求。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T13:52:25.753

没有一般限制。不过，32 位机器可能无法处理超过 4 GB 的 GET 响应。我建议你做一些测试，看看你的客户可以轻松下载多少（他们是在智能手机上连接不稳定的地方，还是他们是互联网上的学者？）。您还可以允许用户可设置的分页（设置上限以阻止服务器死亡）。

# d3.js - 如何使用 d3 在散点图中绘制两个轴的正值和负值？

> ID：10402384
> 
> 赞同：5
> 
> 时间：2012-05-01T18:34:02.187
> 
> 标签：d3.js

我正在使用 d3 构建散点图，并且 x 和 y 轴的值集都有正值和负值。这是我第一次尝试使用 d3，我从介绍性教程中收集到，例如[在圣诞节的第十天，使用 d3.js 弄脏数据](http://www.12devsofxmas.co.uk/2012/01/data-visualisation/)，关键是正确设置 x 和 y 比例。

接下来，我找到了这个教程：[带负值的条形图](https://gist.github.com/2368837)，它几乎帮助我做对了（我认为）。我的数据集太大，无法放在这里，但这里是我的数据示例代码：

```
<div id="compareAll"></div>
<script>
window.onload = function() {

var dataSet = [ [4,4], [-4,4], [-4,-4], [4,-4], ];
var x0 = Math.max(-d3.min(dataSet[0]), d3.max(dataSet[0]));
var xScale = d3.scale.ordinal()
             .domain([-x0,x0])
             .range([0,10]);
var yScale = d3.scale.ordinal()
             .domain(d3.range(dataSet[1])
             .rangeRoundBands([0,10]);

var svg = d3.select("#compareAll")
.append("svg")
.attr("width", 10)
.attr("height",10)

svg.selectAll("circle")
.data(dataSet)
.enter()
.append("circle")
.attr("cx", function(d) {
      return xScale(d[0]); 
})
.attr("cy", function(d) {
      return yScale(d[1]); 
})
.attr("r",4); 

var xAxis = d3.svg.axis()
.scale(xScale)
.tickSize(1);

var yAxis = d3.svg.axis()
.scale(yScale)
.tickSize(1);

svg.append("svg:g")
.attr("class", "x axis")
.attr("transform", "translate(0,10)")
.call(xAxis);

svg.append("svg:g")
.attr("class", "y axis")
.attr("transform", "translate(10,0)")
.call(yAxis);

}

</script> 
```

坦率地说，我不了解条形图示例中序数刻度的使用，但是当我将其取出并使用与 xScale 相同的语法制作 yScale 时，我得到的结果似乎更糟。

任何关于处理两个轴的正值和负值的最佳方法的解释都将不胜感激。让我知道我是否遗漏了一些明显的东西。我将这个来自一个更大项目的示例一起完成，以使其尽可能具体且易于阅读。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T19:04:24.023

对轴使用负值并没有什么特别之处 - 您应该简单地为轴使用线性比例，并将域设置为`[min, max]`，其中`min`很可能是负数。

在此处查看您的代码的工作版本：http: [//jsfiddle.net/nrabinowitz/qN5Sa/](http://jsfiddle.net/nrabinowitz/qN5Sa/)

对此有几点说明：

*   除非您想要更多矩阵，否则您绝对应该对散点图使用线性比例尺。标准的 x 比例可能如下所示：

    ```
    var xScale = d3.scale.linear()
         .domain([-5, 5])
         .range([0,w]); 
    ```

*   该`d3.svg.axis()`组件包括一个`.orient()`设置 - 默认情况下，这是`"bottom"`，即水平轴，行下方有数字。要制作正确定向的 y 轴，请使用`.orient('left')`.

*   我没有包含根据您的数据确定每个轴的最小/最大域的代码，因为我认为这会使示例复杂化。但是，如果您不知道数据的范围，您可以很容易地做到这一点：

    ```
    // assuming data like [[x0,y0], [x1,y1]]
    var xmin = d3.min(data, function(d) { return d[0] }),
        xmax = d3.max(data, function(d) { return d[0] }),
        ymin = d3.min(data, function(d) { return d[1] }),
        ymax = d3.max(data, function(d) { return d[1] }); 
    ```

# function - 如何在 Sencha Architect 中创建函数？

> ID：10402386
> 
> 赞同：3
> 
> 时间：2012-05-01T18:34:11.260
> 
> 标签：function, extjs, sencha-architect

```
Ext.Ajax.request({
   url: 'foo.php',    // where you wanna post
   success: passFn,   // function called on success
   failure: failFn,
   params: { foo: 'bar' }  // your json data
}); 
```

我正在关注[如何使用 extJS 发布 json 数据](https://stackoverflow.com/q/2917581/144201)并收到有关函数的问题。我看到我们可以在 passFn 和 failFn 区域中嵌入函数。但是，如果我希望这些功能在别处怎么办？Sencha Architect 在哪里创建这些函数并对其进行编码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:59:40.593

您可以创建一个不受 Sencha Architect 控制的文件夹，并从您的 Architect 代码中调用它。

例如，我喜欢创建一个名为“util”的文件夹。因此，您的文件夹结构如下所示：

```
app
  -- controller
  -- model
  -- store
  -- view
  -- util    <--- I added this directory
      -- MiscFunctions.js  <-- your own class file 
```

在 MiscFunctions.js 中，您可以像这样创建类：

```
Ext.define('MyApp.util.MiscFunctions', {
   singleton: true,
   passFn: function() {
      ...
   },
   failFn: function() {
   }
}); 
```

然后您可以从 Architect 代码中引用这些函数：

```
Ext.Ajax.request({
   url: 'foo.php',    // where you wanna post
   success: MyApp.util.MiscFunctions.passFn,   // function called on success
   failure: MyApp.util.MiscFunctions.failFn,
   params: { foo: 'bar' }  // your json data
}); 
```

不要忘记添加

```
singleton: true 
```

部分，否则您将必须创建该类的实例才能使用其中的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T06:09:33.687

以下是如何在架构师中使用基本功能：

1.  创建一个控制器。

2.  添加一个控制器动作并设置它的属性如下：

    ```
    controlQuery: '#btn1', // (a button component with id "btn1")
    targetType  : Ext.Button, // (component type)
    fn          : onBtn1Tap, // (function name)
    name        : tap // (event) 
    ```

3.  添加一个基本函数并设置它的属性：

    ```
    fn: basicFunction  (function name) 
    ```

4.  现在您可以在 onBtn1Tap 中使用这个基本功能：`this.basicFunction()`

# wpf - 在没有透明颜色的 ComboBox 中列出颜色

> ID：10402390
> 
> 赞同：0
> 
> 时间：2012-05-01T18:34:28.310
> 
> 标签：wpf

我不想在我的应用程序 ComboBox 中使用颜色列表，但我不会在此列表中包含透明颜色。列表中的其他颜色必须来自 Colors 类。我在网上搜索并找到类似的东西：

```
<ObjectDataProvider MethodName="GetType" 
ObjectType="{x:Type System:Type}" x:Key="colorsTypeOdp">
        <ObjectDataProvider.MethodParameters>
            <System:String>System.Windows.Media.Colors, PresentationCore,
        Version=3.0.0.0, Culture=neutral, 
        PublicKeyToken=31bf3856ad364e35</System:String>
        </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>
    <ObjectDataProvider ObjectInstance="{StaticResource colorsTypeOdp}"  
MethodName="GetProperties" x:Key="colorPropertiesOdp">
    </ObjectDataProvider>

<ComboBox Width="80" ItemsSource="{Binding Source={StaticResource colorPropertiesOdp}}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Height="18" Margin="0,0,0,2">
                                    <Border BorderThickness="1" CornerRadius="2" 
              BorderBrush="Black" Width="50" VerticalAlignment="Stretch"
              Background="{Binding Name}"/>
                                    <TextBlock Text="{Binding Name}" Margin="8,0,0,0"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>

                    </ComboBox> 
```

有人知道怎么做吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:02:03.150

[我建议您从Colors](http://msdn.microsoft.com/en-us/library/system.windows.media.colors.aspx)类中创建自己的`Color`实例列表，并从该列表中排除颜色。然后您可以将此列表绑定到您的组合框的属性。`Colors.Transparent``ItemsSource`

`Color`要从类中获取实例列表`Colors`，可以使用以下代码片段：

```
PropertyInfo[] properties = typeof(Colors).GetProperties();

foreach (PropertyInfo property in properties)
   Color color = property.GetValue(null, null) as Color; 
```

# javascript - JavaScript protoypal 对象中 this 的值

> ID：10402393
> 
> 赞同：1
> 
> 时间：2012-05-01T18:34:36.180
> 
> 标签：javascript, constructor, this

我正在尝试这样的事情：

```
(function() {
  var Foo, foo;

  Foo = function(proto) {
    var obj, privateMethod, publicMethod;
    privateMethod = function() {
      return console.log("private", this);
    };
    publicMethod = function() {
      console.log("public", this);
      return privateMethod();
    };
    obj = Object.create(proto);
    obj.bar = publicMethod;
    return obj;
  };

  foo = new Foo({
    baz: "dooz"
  });

  foo.bar();

}).call(this); 
```

显然 this 是调用 publicMethod 时的对象本身，但在 privateMethod 中设置为全局对象。我知道它可以通过改变来解决：

```
 return privateMethod(); 
```

至：

```
 return privateMethod.call(this); 
```

我知道当一个函数嵌套在一个函数中时，这个 get 会丢失，但没想到这里会出现这种情况。我是否在这里遇到了这个 JavaScript 错误，或者有什么我根本不明白的地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:52:37.820

你在打电话`foo.bar()`。这意味着函数`bar()`被调用`foo`，意思`this`是`foo`在里面`bar()`。

在您的情况下`foo`是~~一个`Foo`对象~~ `obj`，并且`bar()`是`publicMethod`。

当`publicMethod()`调用`privateMethod()`时，没有上下文，所以`this`变成了全局`this`（`window`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T18:53:07.317

在 javascript 中，上下文 ( `this`) 由函数的调用方式设置，绝不是函数本身的属性。

```
obj.bar = function() { console.log(this) };
obj.bar()    // obj
obj['bar']() // obj

// But break the function off the object, and this changes
fn = obj.bar
fn() // window 
```

这个例子向我们展示的是那里设置的点语法`this`。想想`obj.bar()`是语法糖`obj.bar.call(obj)`。

所以你的公共方法是正确的`this`，因为它是如何在外部代码中调用的。

```
foo.bar(); 
```

但是您的私有方法是在根本没有接收者的情况下调用的。

```
return privateMethod(); 
```

所以没有分配上下文，它默认为全局对象。

* * *

因此，如果您在构造函数中创建这些函数，您就有了一定的灵活性。

您可以将构造函数中的正确值分配`this`给其他东西，并在您的私有函数中使用它。（可能是最好的选择）

```
var self = this;
privateMethod = function() {
  return console.log("private", self);
}; 
```

或者，如果您的 JS 目标引擎支持`Function.prototype.bind`（遗憾的是，并非全部支持），您可以这样做：

```
privateMethod = function() {
  return console.log("private", this);
}.bind(this); 
```

无论如何，它将返回一个具有分配上下文的函数。

或者您可以自己手动绑定它。

```
_privateMethod = function() {
  return console.log("private", this);
}

Foo = function(proto) {
  privateMethod = function() {
    _privateMethod.call(this);
  }
} 
```

# forms - CakePHP：允许通过单击按钮更新数据库

> ID：10402395
> 
> 赞同：0
> 
> 时间：2012-05-01T18:34:51.107
> 
> 标签：forms, cakephp

我有一个带有以下表格的产品搜索页面。搜索结果显示在同一页面上，搜索栏位于顶部。

```
echo $this->Form->create('Searches', array('action'=>'products', 'type' => 'get', 'name' => 'textbox1'));
echo $form->input($varName1, array('label' => false));
echo $form->end('Locate'); 
```

我在搜索结果旁边还有一个小框，它允许（它还不起作用）用户使用复选框标记产品，并通过单击按钮相应地更新其数据库（表`products`和使用模型）。`Product`请注意，我有一个`Searches`用于此搜索页面的控制器。

```
<form method="link" action="/myapp/product/test_update_db>
<label><input type="checkbox" name="flag1" <?php echo $preCheckBox1; ?>>Flag 1</input></label>
<label><input type="checkbox" name="flag2" <?php echo $preCheckBox2; ?>>Flag 2</input></label>                          
    <input type="submit" value="Update">                                
</form> 
```

我很难用这种方法弄清楚如何执行这个复选框和数据库更新例程。我正在访问我想访问的链接 ( `/myapp/product/test_update_db`)，但我不知道如何将变量`flag1`和`flag2`以及此结果的行 ID ( `$results['Product']['id'])`) 带到新页面。

有人可以指导我如何巧妙地执行此操作吗？这种一般方法是否正确？如果不是，我应该走什么路线？如果可能的话，我现在不想使用 javascript。

编辑：如果我使用 URL 传递数据，我想我可以完成这项工作。但我仍然想知道如何在“幕后”或在 MVC 中完成这项工作。我觉得我正在对 CakePHP 平台进行黑客攻击。

更新：所以，我最终使用 URL 参数来检索信息片段，如`flag1`和`flag2`。我仍在寻找另一种方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T09:44:57.840

To see where your is-checkbox-checked data is located, do the following in your controller:

```
// Cake 2.0+
debug($this->request->data);

// previous versions
debug($this->data); 
```

If you want to pass data to your search controller from the current page, you can always add the data to your form:

```
$this->input
    (
        'Product.id',
        array
        (
            'type' => 'hidden',
            'value' => $yourProductId
        )
    ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T15:35:22.190

我最终使用嵌入在 URL 中的信息来获取提交数据。像下面的东西..

在 Products 控制器中，当提交带有`flag1`和的表单时：`flag2`

```
public function test_update_db() {      
    // Get variables from URL, if any, and save accordingly     
    $result = $this->Product->updateProduct($this->params['url'], 'url');
    if ($result) {
        $this->Session->setFlash('Successfully updated!', 'default', array('class' => 'success'));
        $this->redirect($this->referer());
    }
    else {
        $this->Session->setFlash('Update was unsuccessful!', 'default', array('class' => 'error'));
        $this->redirect($this->referer());
    }       
} 
```

这适用于做我需要做的事情。我觉得有一种更合适的方法可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-06T12:28:53.833

```
if ($result) {
    $this->Session->setFlash('Successfully updated!', 'default', array('class' => 'success'));
    $this->redirect($this->referer());
} 
```

# xamarin.ios - Monotouch.Dialog RootElement 打开 UIViewController 并传入数据

> ID：10402401
> 
> 赞同：0
> 
> 时间：2012-05-01T18:35:16.277
> 
> 标签：xamarin.ios, monotouch.dialog

当用户单击 RootElement 时，是否有正确的方法来使用 Monotouch.Dialog (iOs) 并调用 UIViewController？我正在基于数组构建数据页面，单击时我想打开此自定义视图并传入数组元素.. 像这样的东西（不起作用）。任何帮助表示赞赏。

```
RootElement CreateMenuCategory(JToken menucat) {

  RootElement MenuCategory = new RootElement(menucat["menucategoryname"].Value<String>());

  RootElement root_element; 
  Section section = new Section(); 
  foreach(JToken menuitem in menucat["menuitems"]) { 
    root_element = new RootElement(menuitem["menuitemname"].Value<String>(), (RootElement e) => {
        return _menuitemView.LoadMenuItem(menuitem);  // menuitem on view is always the same
  }); 

  section.Add (root_element);

  }

MenuCategory.Add (section); 

return MenuCategory; 
} 
```

该代码不起作用，因为委托每次都传递相同的元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T01:26:29.257

这只是 lambda 函数如何捕获“menuitem”变量的副作用。

将您的 foreach 循环更改为如下所示：

```
foreach (JToken iteratorMenuitem in menucat ["menuitems"]){
    var menuitem = iteratorMenuitem;
    //.. the rest 
```

# mysql - MYSQL LIKE 子句什么都不返回？

> ID：10402410
> 
> 赞同：2
> 
> 时间：2012-05-01T18:35:48.333
> 
> 标签：mysql, sql-like

我有一个名为 item_name 的列的数据库。我正在尝试使用 LIKE 子句使用 item_name 列中的关键字从数据库中提取数据，但没有得到任何返回。我下面的代码有问题吗？我尝试了逗号和 AND 而不是 OR 但仍然没有结果。

```
$sql = mysql_query("SELECT category, item_name, link, price, pic, retailer FROM products WHERE item_name LIKE ('%gtx%') OR ('%video%') OR ('%sound%') ORDER BY id DESC");

$query = ($sql) or die (mysql_error());

while ($result = mysql_fetch_array($query)) { 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:39:03.353

您需要`LIKE`在每个之后指定`OR`

```
SELECT category, item_name, link, price, pic, retailer 
FROM products 
WHERE item_name LIKE ('%gtx%') 
    OR item_name LIKE ('%video%') 
    OR item_name LIKE ('%sound%') 
ORDER BY id DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:38:25.957

尝试使用：
WHERE(item_name '%gtx%' OR item_name LIKE '%video%' OR item_name LIKE '%sound%') 。我认为这会运行。您是否直接在mysql界面中测试了您的查询？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T18:40:02.447

您需要`LIKE`在 each 之后添加`OR`，因此 SQL setence 将是这样的：

```
SELECT category, item_name, link, price, pic, retailer FROM products 
WHERE item_name LIKE ('%gtx%') 
      OR item_name LIKE ('%video%') 
      OR item_name LIKE ('%sound%') 
ORDER BY id DESC 
```

因为在旧句子中，没有 LIKE 数据库不会像逻辑值那样理解 ('%video%') 术语。

# ruby-on-rails-3 - Rails 3 在乘客上运行，未知属性：session_id 错误

> ID：10402416
> 
> 赞同：1
> 
> 时间：2012-05-01T18:36:21.160
> 
> 标签：ruby-on-rails-3, passenger

我正在乘客身上运行 rails 3 应用程序。登录时，我会定期收到以下错误。这似乎是随机发生的。起初它并不常见，然后自行消失了。现在它变成了一个更大的问题。任何帮助，将不胜感激。谢谢

```
ActiveRecord::UnknownAttributeError in LoginController#index

unknown attribute: session_id

Rails.root: /var/www/apps/myapp/releases/20120501181816
Application Trace | Framework Trace | Full Trace

activerecord (3.2.2) lib/active_record/attribute_assignment.rb:88:in `block in assign_attributes'
activerecord (3.2.2) lib/active_record/attribute_assignment.rb:78:in `each'
activerecord (3.2.2) lib/active_record/attribute_assignment.rb:78:in `assign_attributes'
activerecord (3.2.2) lib/active_record/base.rb:495:in `initialize'
activerecord (3.2.2) lib/active_record/session_store.rb:130:in `initialize'
activerecord (3.2.2) lib/active_record/session_store.rb:310:in `new'
activerecord (3.2.2) lib/active_record/session_store.rb:310:in `block in get_session'
activesupport (3.2.2) lib/active_support/benchmarkable.rb:50:in `silence'
activerecord (3.2.2) lib/active_record/session_store.rb:305:in `get_session'
rack (1.4.1) lib/rack/session/abstract/id.rb:246:in `load_session'
actionpack (3.2.2) lib/action_dispatch/middleware/session/abstract_store.rb:47:in `block in load_session'
actionpack (3.2.2) lib/action_dispatch/middleware/session/abstract_store.rb:55:in `stale_session_check!'
actionpack (3.2.2) lib/action_dispatch/middleware/session/abstract_store.rb:47:in `load_session'
rack (1.4.1) lib/rack/session/abstract/id.rb:130:in `load!'
rack (1.4.1) lib/rack/session/abstract/id.rb:126:in `load_for_write!'
rack (1.4.1) lib/rack/session/abstract/id.rb:71:in `[]='
actionpack (3.2.2) lib/action_dispatch/middleware/flash.rb:249:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.2) lib/action_dispatch/middleware/cookies.rb:338:in `call'
activerecord (3.2.2) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.2) lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'
actionpack (3.2.2) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.2) lib/active_support/callbacks.rb:405:in `_run__1318401008379964085__call__2594406452281670030__callbacks'
activesupport (3.2.2) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.2) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.2) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.2) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.2) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.2) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.2) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.2) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.2) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.2) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.2) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
rack-cache (1.2) lib/rack/cache/context.rb:136:in `forward'
rack-cache (1.2) lib/rack/cache/context.rb:245:in `fetch'
rack-cache (1.2) lib/rack/cache/context.rb:185:in `lookup'
rack-cache (1.2) lib/rack/cache/context.rb:66:in `call!'
rack-cache (1.2) lib/rack/cache/context.rb:51:in `call'
railties (3.2.2) lib/rails/engine.rb:479:in `call'
railties (3.2.2) lib/rails/application.rb:220:in `call'
railties (3.2.2) lib/rails/railtie/configurable.rb:30:in `method_missing'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/rack/request_handler.rb:96:in `process_request'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_request_handler.rb:513:in `accept_and_process_next_request'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_request_handler.rb:274:in `main_loop'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/rack/application_spawner.rb:206:in `start_request_handler'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/rack/application_spawner.rb:171:in `block in handle_spawn_application'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/utils.rb:479:in `safe_fork'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/rack/application_spawner.rb:166:in `handle_spawn_application'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:180:in `start'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/rack/application_spawner.rb:129:in `start'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:253:in `block (2 levels) in spawn_rack_application'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server_collection.rb:132:in `lookup_or_add'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:246:in `block in spawn_rack_application'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server_collection.rb:82:in `block in synchronize'
<internal:prelude>:10:in `synchronize'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server_collection.rb:79:in `synchronize'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:244:in `spawn_rack_application'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:137:in `spawn_application'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:275:in `handle_spawn_application'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
/home/rails/.rvm/gems/ruby-1.9.2-p318/gems/passenger-3.0.11/helper-scripts/passenger-spawn-server:99:in `<main>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T00:04:21.340

你不是在配置`session_id`吗`config.log_tags`？如果是这样，删除它可能会有所帮助。

# python - 如何使用递归集合列表来构建目录结构？

> ID：10402418
> 
> 赞同：0
> 
> 时间：2012-05-01T18:36:32.540
> 
> 标签：python, gdata, google-drive-api

如何做一个简单的递归列表来构建目录结构？

我正在使用 gdata python 客户端库。查看 client.py 和 data.py，没有直接的方法来列出和构建目录结构。

我正在做的是：（假设 self.client 已通过身份验证）

1.  self.client.GetAllResources（包括 showfolders=true）
2.  对于每个资源检查 resource.in_collections()

有没有比上面更好的方法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:15:21.613

另一种方法是首先扫描层次结构中的文件夹，然后为每个文件夹列出所有资源。您可以将任何 URI 传递给 GetAllResources 方法，在这种情况下，它将是：

1.  仅适用于根目录中的文件夹：

    [https://docs.google.com/feeds/default/private/full/folder%3Aroot/contents/-/folder](https://docs.google.com/feeds/default/private/full/folder%3Aroot/contents/-/folder)

2.  对于 ID 为 123456 的文件夹的内容：

    [https://docs.google.com/feeds/default/private/full/folder%3A123456/contents/](https://docs.google.com/feeds/default/private/full/folder%3A123456/contents/)

默认情况下，文件夹本身不会在内容提要中列出，因此您可以将这两者结合起来以获取整个层次结构。

我想我更喜欢上面的方法来获取平面列表并生成文件夹层次结构，这只是提供了一种替代方法。

# prolog - PROLOG 代码中的错误

> ID：10402422
> 
> 赞同：0
> 
> 时间：2012-05-01T18:36:48.333
> 
> 标签：prolog

我是序言的新手。

我希望我在 PROLOG 中的代码产生下面给出的预期输出。有人可以告诉我哪里出错了。

该代码基本上是删除重复项并以所需格式生成 o/p。

```
remove_dups([],_L2,_L2).
remove_dups([A|B],L2,L3) :- 
    functor(A,Pr,Ar),(member(level(Pr,Ar,1) ,L2) -> remove_dups(B,L2,L2); append([level(Pr,Ar,1)],L2,L3),remove_dups(B,L3,L3)). 
```

预期输出：

```
 ?- remove_dups([a,b,a],[],L).

L = [level(a,0,1),level(b,0,1)]. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:47:27.700

对于初学者，我宁愿将这两个步骤分开：删除重复项和显示关卡。

```
 remove_dups([],[]).
    remove_dups([X|Xs],Ys) :- member(X,Xs), !, remove_dups(Xs,Ys).
    remove_dups([X|Xs],[X|Ys]) :- remove_dups(Xs,Ys).

    levels([],[]).
    levels([X|Xs],[level(N,A,1)|Ys]):- functor(X,N,A), levels(Xs,Ys).

    go(L,R):- remove_dups(L,RL), levels(RL,R). 
```

我不得不承认，`1`三倍关卡中的常数让我感到困惑。你确定它不应该更有意义吗？

我还假设列表元素的顺序并不重要：`remove_dups`删除所有出现的重复元素，除了最后一个。如果您想保留第一次出现，`remove_dups`则必须进行修改。

# android - Android：还有其他方法可以显示字符串数组中的数据吗？

> ID：10402428
> 
> 赞同：1
> 
> 时间：2012-05-01T18:37:11.733
> 
> 标签：android, textview, arrays

我正在尝试显示配方的步骤，配方存储在字符串数组中。

我试图将每个步骤插入到文本视图中，并具有以下代码：

```
public class MethodActivity extends ListActivity{

ListView recipes;
Intent myIntent;
String value;
TextView editvalue;
Intent intent;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);  

    setContentView(R.layout.recipemethod);

    editvalue = (TextView)findViewById(R.id.method);
    value = getIntent().getStringExtra("searchValue");
    editvalue.setText(value);

    final String[]  words = getResources().getStringArray(R.array.Lasagna);
    final TextView tw=(TextView)findViewById(R.id.method);
    for(int item = 0;item<words.length;item++){
        tw.setText(words [item]);
    }
  }
} 
```

我也想让它变得动态，所以有人知道我该怎么做吗？（例如，取决于用户单击该食谱的内容）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:37:43.247

`ListActivity`实际使用你的 's可能更容易`ListView`......你甚至可以在另一个中显示你的食谱`ListView`，因为它无疑对用户来说更直观......

执行此操作的简单代码将在以下几行中出现：

文件 1：RecipeListActivity.java（显示食谱列表）

```
package com.epichorns.testproject;

import java.util.ArrayList;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class RecipeListActivity extends ListActivity {

    final Recipe[] mRecipesArray = {    new Recipe("Lasagna", new String[]{"Some lasagna noodles", "Some tomato sauce"}),
                                        new Recipe("PortalCake", new String[]{"GlaDOS' wit","Is a lie"}),
                                        new Recipe("EarthDestruction", new String[]{"Asteroid", "Kinetic energy"})};

    public class Recipe{
        public String name;
        public String[] steps;

        Recipe(String name, String[] steps){
            this.name = name;
            this.steps = steps;
        }
    }

    public ArrayList<String> FetchRecipesRawArray(Recipe[] recipes){
        ArrayList<String> ret = new ArrayList<String>();
        for(int i=0;i<recipes.length;i++){
            ret.add(recipes[i].name);
        }
        return ret;
    }

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);    

        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, FetchRecipesRawArray(mRecipesArray));
        setListAdapter(adapter); 
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id){
        Intent intent = new Intent(this, RecipeActivity.class);
        intent.putExtra(RecipeActivity.EXTRA_RECIPEARRAY, mRecipesArray[position].steps);
        startActivity(intent);

    }
} 
```

文件 2：RecipeActivity.java（在列表中显示食谱）

```
package com.epichorns.testproject;

import android.app.ListActivity;
import android.os.Bundle;
import android.widget.ArrayAdapter;

public class RecipeActivity extends ListActivity {
    final static public String EXTRA_RECIPEARRAY = "recipeArray";

    @Override
    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);  

        String[] recipeArray = getIntent().getStringArrayExtra(EXTRA_RECIPEARRAY);
        if(recipeArray!=null){
            if(recipeArray.length>0){
                ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, recipeArray);
                setListAdapter(adapter);
            }
        }
    }
} 
```

* * *

或者，这是一个代码，它在食谱列表下方组合了一个 TextView，以便在不打开另一个 Activity 的情况下显示食谱内容：

文件：RecipeListActivity.java

```
package com.epichorns.testproject;

import java.util.ArrayList;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;

public class RecipeListActivity extends ListActivity {

    final Recipe[] mRecipesArray = {    new Recipe("Lasagna", new String[]{"Some lasagna noodles", "Some tomato sauce"}),
                                        new Recipe("PortalCake", new String[]{"GlaDOS' wit","Is a lie"}),
                                        new Recipe("EarthDestruction", new String[]{"Asteroid", "Kinetic energy"})};

    TextView mTextView_recipeTitle;
    TextView mTextView_recipe;

    public class Recipe{
        public String name;
        public String[] steps;

        Recipe(String name, String[] steps){
            this.name = name;
            this.steps = steps;
        }
    }

    public ArrayList<String> FetchRecipesRawArray(Recipe[] recipes){
        ArrayList<String> ret = new ArrayList<String>();
        for(int i=0;i<recipes.length;i++){
            ret.add(recipes[i].name);
        }
        return ret;
    }

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);    

        setContentView(R.layout.main);
        mTextView_recipe = (TextView)findViewById(R.id.recipeText);
        mTextView_recipeTitle = (TextView)findViewById(R.id.recipeTitle);

        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, FetchRecipesRawArray(mRecipesArray));
        setListAdapter(adapter); 
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id){

        mTextView_recipeTitle.setText(mRecipesArray[position].name);

        mTextView_recipe.setText("");

        String[] recipeSteps = mRecipesArray[position].steps;
        for(int i=0;i<recipeSteps.length;i++){
            mTextView_recipe.append(recipeSteps[i]+"\n");
        }

    }
} 
```

文件：main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="200dp"
        android:background="#400000FF"

        />

    <TextView
        android:id="@+id/recipeTitle"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="#4000FF00"
         />

    <TextView
        android:id="@+id/recipeText"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="#40FF0000"
         />

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:59:37.377

您将希望使用 tw.append() 而不是 setText，否则您将看到的只是数组中的最后一个字符串。

使其动态化，我将使用片段（如果在较旧的 android 版本上使用 Android 支持库）模型，加载每个数组，在启动之前将字符串数组作为包附加到片段。

Fragment tut： http: [//developer.android.com/guide/topics/fundamentals/fragments.html](http://developer.android.com/guide/topics/fundamentals/fragments.html)
支持库：http: [//developer.android.com/training/basics/fragments/support-lib.html](http://developer.android.com/training/basics/fragments/support-lib.html)

# ios - 抑制自定义UITabBarController中的moreNavigationController

> ID：10402432
> 
> 赞同：6
> 
> 时间：2012-05-01T18:37:18.930
> 
> 标签：ios

我已经为一个项目实现了一个自定义的 UITabBar 解决方案。本质上，如果项目超过 5 个，我会使用一个 scrollView，它允许用户滚动其他选项卡项目并抑制更多按钮。在 Weather Channel 应用程序中可以看到类似的外观和感觉。

每个选项卡栏项对应于一个 UINavigationController，它管理每个选项卡的视图堆栈。我遇到的问题是当我有超过 5 个选项卡项时，从选项卡 5 开始无法正确维护导航堆栈。似乎 moreNavigationController 每次返回该选项卡时都会杀死导航堆栈，并且您会再次被带到初始页面。

我已经重写了 setSelectedViewController 方法，如下所示：

```
- (void) setSelectedViewController:(UIViewController *)selectedViewController {
    [super setSelectedViewController:selectedViewController];
    if ([self.moreNavigationController.viewControllers count] > 1) {
        self.moreNavigationController.viewControllers = [[NSArray alloc] initWithObjects:self.moreNavigationController.visibleViewController, nil];
    }
} 
```

此代码将删除左侧导航按钮上的更多功能，但不能解决维护导航堆栈的问题。所有其他选项卡工作正常。我可以遍历几个视图，并且在我离开并返回该选项卡后维护堆栈。我知道这是一个复杂的问题，所以请让我知道是否有我可以提供说明的地方。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T15:56:17.837

这就是我最终解决这个问题的方式：

```
- (void) setSelectedViewController:(UIViewController *) selectedViewController {
    self.viewControllers = [NSArray arrayWithObject:selectedViewController];
    [super setSelectedViewController:selectedViewController];
} 
```

基本上，当您最初在 UITabBarController 上设置 viewControllers 时，从 5 开始的任何选项卡都会将其导航控制器替换为 moreNavigationController。因此，我动态地将 viewControllers 设置为仅包含我正在单击的选项卡。在这种情况下，永远不会超过 1，因此 moreNavigationController 不会发挥作用。

当我初始化我的自定义控制器时，我只提供第一个选项卡作为 viewControllers 以便应用程序可以加载。

```
- (id) init {
    self = [super init];
    if (self) {
        self.delegate = self;
        [self populateTabs];
    }
    return self;
}

- (void) populateTabs {
    NSArray *viewControllers = [self.manager createViewsForApplication];
    self.viewControllers = [NSArray arrayWithObject:[viewControllers objectAtIndex:0]];
    self.tabBar.hidden = YES;
    MyScrollingTabBar *tabBar = [[MyScrollingTabBar alloc] initWithViews:viewControllers];
    tabBar.delegate = self;
    [self.view addSubview:tabBar];
} 
```

为清楚起见，将 tabBar 委托设置为此类，以便它可以响应选项卡单击。委托方法如下：

```
- (void) tabBar:(id) bar clickedTab:(MyScrollingTabBarItem *) tab {
    if (self.selectedViewController == tab.associatedViewController) {
        [(UINavigationController *) tab.associatedViewController popToRootViewControllerAnimated:YES];
    } else {
        self.selectedViewController = tab.associatedViewController; 
    }
    // keep nav label consistent for tab
    self.navigationController.title = tab.label.text;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-21T09:35:06.583

您还可以覆盖 moreNavigationController var`UITabBarController`并返回您自己的自定义 NavigaitonContorller，如下所示：

`override var moreNavigationController: UINavigationController { return MyCustomNavController() }`

在我需要一个允许在滚动时隐藏 NavigationBar 的 NavigaitonController 的情况下工作。

至于隐藏 MoreNavigationController 的后退按钮，您可以将每个 NavigationItem 的 leftBarButtonItem 设置为任何内容（甚至是空的 UIBarButtonItem），并且更多 NavigaitonController 的后退按钮将消失。

# google-drive-api - Google Drive 协作编辑器

> ID：10402433
> 
> 赞同：1
> 
> 时间：2012-05-01T18:37:21.067
> 
> 标签：google-drive-api

随着 Google Drive 的推出，我一直在查看可用的 API 和信息。我没有找到它甚至可能的例子或信息。

我想创建一个两个用户可以同时协作的编辑器。我们都看到了谷歌自己的编辑器是如何做到这一点的。

这个想法是为了创建一个演示，两个程序员可以在同一个项目上工作，并在同一个文件上工作，用替代解决方案替换 subversion 或其他团队解决方案。

任何人都可以在 google api 或其他地方找到任何示例，或者更好地分享一些经验/代码。

我认为这是可能的，因为 WeVideo 发布了一个用于协作视频编辑的应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:20:48.637

目前，Drive SDK 不提供此功能，抱歉。那些实现这一目标的应用程序正在自己执行协作方面。

SDK 确实支持[ETag](http://en.wikipedia.org/wiki/HTTP_ETag)，因此您的应用可以检查文件内容自加载数据后是否未更改，这将有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-10T17:31:31.483

Google Drive 现在有了[Realtime API](https://developers.google.com/drive/realtime/)（我认为是 2013 年的）。

# c# - Nhibernate Many-to-Many bridge table 保持为空

> ID：10402438
> 
> 赞同：2
> 
> 时间：2012-05-01T18:37:41.267
> 
> 标签：c#, nhibernate, nhibernate-mapping

我有两个表与桥表具有多对多关系。

用户类映射：

```
<class name="MatrixCore.User" table="MatrixUser" lazy="false">
    <id name="ID" column="ID" unsaved-value="0">
      <generator class="native"/>
    </id>
    <property name="FirstName"/>
    <property name="LastName"/>
    <property name="UserName"/>
    <property name="Password"/>
    <many-to-one name="UserType" class="MatrixCore.UserType" />
    <set name="Projects" table="UserInProject" cascade="All">
      <key column="MatrixUser_ID"/>
      <many-to-many class="Project" column="Project_ID"/>
    </set>
  </class> 
```

项目类映射：

```
<class name="MatrixCore.Project" table="Project" lazy="false">
   <id name="ID" column="ID" unsaved-value="0">
     <generator class="native"/>
   </id>
   <property name="Name" />
   <property name="Acronym"/>
   <property name="StartDate"/>
   <property name="EndDate"/>
   <set name="Users" table="UserInProject" cascade="All">
     <key column="Project_ID"/>
     <many-to-many class="User" column="MatrixUser_ID" />
   </set>
</class> 
```

类的实现太简单了，每个类都有另一个类的集合。我正在尝试在桥表保持为空的表中插入记录。

```
 ICollection<Project> ps = new HashSet<Project>() { project};

            UserType tp = (UserType)session.Get("UserType", 1);
            User u = new User()
            {
                FirstName = "Hussein",
                LastName = "Hussein",
                UserName = "Hussein",
                Password = "welcome",
                UserType = tp,
                Projects = ps
            };

            session.Save(u); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T09:16:28.773

试试这个用户类的映射

```
<set name="Projects" table="UserInProject" inverse="true" cascade="save-update" lazy="false">
  <key column="MatrixUser_ID" />
  <many-to-many class="Project" column="Project_ID"/>
</set> 
```

和项目类

```
<set name="Users" table="UserInProject" cascade="save-update" lazy="false">
  <key column="Project_ID"  />
  <many-to-many class="User" column="MatrixUser_ID"/>
</set> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:04:42.097

您需要将用户添加到`Users`每个`Projects`.

`Save`在-之前添加以下循环

```
foreach (Project project in u.Projects)
{
   project.Users.Add(u);
} 
```

# .htaccess - htaccess mod_rewrite 排除图像/css

> ID：10402439
> 
> 赞同：1
> 
> 时间：2012-05-01T18:37:42.137
> 
> 标签：.htaccess, mod-rewrite, seo

我为我的网站创建了一个简单的 mod 重写：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} ^/(cgi-bin|css|images|js|gfx)/?.*$ [NC]
RewriteRule ^filter/model/([^/]*)/mins/([^/]*)/texts/([^/]*)/freegifts/([^/]*)/network/([^/]*)/merchant/([^/]*)$ /fiverrr.php?model=$1&mins=$2&texts=$3&freegifts=$4&network=$5&merchant=$6 [L] 
```

但它似乎不起作用（因为所有图像/js等都没有出现）

例如`http://mydomain.com/filter/model/Sony+Ericsson+Xperia+Arc+S+White/mins/+3000/texts/+-1/freegifts/FREE+Nintendo+3DS+Black/network/Orange/merchant/`

原网址：`http://mydomain.com/fiverrr.php?model=Sony+Ericsson+Xperia+Arc+S+White&mins=+3000&texts=+-1&freegifts=FREE+Nintendo+3DS+Black&network=Orange&merchant=Contract`

我哪里错了，这是最好的方法吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T18:20:28.017

尝试设置另一个条件 - 只有当请求的文件不存在时，htaccess 才会重写它：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^filter/model/([^/]*)/mins/([^/]*)/texts/([^/]*)/freegifts/([^/]*)/network/([^/]*)/merchant/([^/]*)$ /fiverrr.php?model=$1&mins=$2&texts=$3&freegifts=$4&network=$5&merchant=$6 [L] 
```

另外，我建议您检查完整路径。检查您是否在 HTML 代码中有图像，例如：`http://mydomain.com/images/img.jpg`- 类似的相对路径`./../images/img.jpg`不起作用！

# c# - 列出线程问题

> ID：10402446
> 
> 赞同：1
> 
> 时间：2012-05-01T18:38:09.980
> 
> 标签：c#, c#-4.0, concurrency

我正在尝试使我的应用程序线程安全。我举起双手承认我是线程新手，所以不知道该怎么做。

为了提供简化版本，我的应用程序包含一个列表。

*   大多数应用程序访问此列表并且不会更改它，但可能会通过它进行枚举。所有这些都发生在 UI 线程上。
*   线程一将定期查找要从列表中添加和删除的项目。
*   线程二将枚举列表并使用额外信息更新项目。这必须与线程一同时运行，因为可能需要几秒钟到几小时的时间。

第一个问题是是否有人对此有推荐的策略。

其次，我试图制作主应用程序将使用的列表的单独副本，在更新/添加或删除某些内容时定期获取新副本，但这似乎不起作用。

我有我的清单和一份副本......

```
public class MDGlobalObjects
{
    public List<T> mainList= new List<T>();
    public List<T> copyList
    {
        get
        {
            return new List<T>(mainList);
        }
    }
} 
```

如果我得到 copyList，修改它，保存 mainlist，重新启动我的应用程序，加载 mainlist 并再次查看 copylist，那么更改就存在了。我认为我做错了什么，因为 copylist 似乎仍然指的是 mainlist。

我不确定它是否有所作为，但所有内容都通过类的静态实例访问。

```
public static MDGlobalObjects CacheObjects = new MDGlobalObjects(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:45:13.057

actly copylist 只是 mainList 的浅拷贝。该列表是新的，但列表中包含的对象的引用仍然相同。为了实现你想要的，你必须制作一个像这样的列表的深层副本

```
public static IEnumerable<T> Clone<T>(this IEnumerable<T> collection) where T : ICloneable
{
    return collection.Select(item => (T)item.Clone());
} 
```

并像使用它一样

```
return mainList.Clone(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:51:04.210

再次查看您的问题..我想建议整体改变方法。你应该像使用`ConcurrentDictionary()`一样使用`.Net 4.0`. 因为您不必使用锁作为并发集合始终保持有效状态。
所以你的代码看起来像这样。

```
Thread 1s code --- <br>
var object = download_the_object();
dic.TryAdd("SomeUniqueKeyOfTheObject",object);
//try add will return false so implement some sort of retry mechanism

Thread 2s code
foreach(var item in Dictionary)
{
 var object item.Value;
var extraInfo = downloadExtraInfoforObject(object);
//update object by using Update
dictionary.TryUpdate(object.uniqueKey,"somenewobjectWithExtraInfoAdded",object);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:58:00.077

这是使用[ConcurrentDictionary](http://msdn.microsoft.com/en-us/library/dd287191.aspx)的要点：

* * *

```
public class Element
{
    public string Key { get; set; }
    public string Property { get; set; }

    public Element CreateCopy()
    {
        return new Element
        {
            Key = this.Key,
            Property = this.Property,
        };
    }
} 
```

* * *

```
var d = new ConcurrentDictionary<string, Element>();

// thread 1
// prune
foreach ( var kv in d )
{
    if ( kv.Value.Property == "ToBeRemoved" )
    {
        Element dummy = null;
        d.TryRemove( kv.Key, out dummy );
    }
}

// thread 1
// add
Element toBeAdded = new Element();
// set basic properties here
d.TryAdd( toBeAdded.Key, toBeAdded );

// thread 2
// populate element
Element unPopulated = null;
if ( d.TryGetValue( "ToBePopulated", out unPopulated ) )
{
    Element nowPopulated = unPopulated.CreateCopy();

    nowPopulated.Property = "Populated";

    // either
    d.TryUpdate( unPopulated.Key, nowPopulated, unPopulated );

    // or
    d.AddOrUpdate( unPopulated.Key, nowPopulated, ( key, value ) => nowPopulated );
}

// read threads
// enumerate
foreach ( Element element in d.Values )
{
    // do something with each element
}

// read threads
// try to get specific element
Element specific = null;
if ( d.TryGetValue( "SpecificKey", out specific ) )
{
    // do something with specific element
} 
```

* * *

在线程 2 中，如果您可以设置属性以使整个对象在每次原子写入后保持一致，那么您可以跳过制作副本，只需使用集合中的对象填充属性即可。

此代码中有一些竞争条件，但它们应该是良性的，因为读者始终对集合有一致的看法。

# wpf - WPF 数据网格 rowHeader 对象

> ID：10402447
> 
> 赞同：1
> 
> 时间：2012-05-01T18:38:13.200
> 
> 标签：wpf, datagrid

我正在研究 Datagrid RowHeader 鼠标悬停的东西。

我如何从 rowIndex 获取 DataGridRowHeader。

谢谢迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:52:07.897

```
<Style TargetType="DataGridRowHeader">
<EventSetter Event="MouseEnter" Handler="OnMouseEnter"/>
</Style>

private void OnMouseEnter(object sender, MouseEventArgs e)
{
   //your logic here
} 
```

如果这有助于您的逻辑，您可以将 MouseLeave 添加到样式中

# windows-phone-7 - WP7 获取设备坐标

> ID：10402448
> 
> 赞同：1
> 
> 时间：2012-05-01T18:38:23.523
> 
> 标签：windows-phone-7

我尝试通过 http 请求使用 google maps api 获取我的设备坐标，我需要一个 api 密钥但我无法获取 api 密钥。windows phone 应用程序没有可用的 api 密钥吗？我怎样才能获取我的设备坐标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:41:36.790

使用[`GeoCoordinateWatcher`](http://msdn.microsoft.com/en-us/library/ee808838.aspx) 可用的类`WP7`通过 GPS 或 WiFi/蜂窝塔获取设备坐标。此外，您可以选择所需的精度/电池消耗来满足您的需求。

# python - BeautifulSoup - 输出中的空白行'导致一个奇怪的无用

> ID：10402454
> 
> 赞同：2
> 
> 时间：2012-05-01T18:39:01.230
> 
> 标签：python, csv, beautifulsoup

你的小问题:-)

我正在使用 BeautifulSoup 来解析 HTML 页面中表格的内容。问题是在我的输出文件的每一行（CSV/EXCEL）之间，它会拉出一个空行......这是 HTML 表的一个例子（非常大）

```
<tr><td class="normaltext" valign="TOP">Tesco - United Kingdom&nbsp;&nbsp;</td>
<td class="normaltext"  valign="TOP">CO</td>
<td class="normaltext"  valign="TOP">Unknown&nbsp;&nbsp;</td>
<td class="normaltext"  align="center" valign="top">lol</td></tr>
<tr><td colspan="5"><hr></td></tr>
<tr><td class="normaltext" valign="TOP">Tesco - United Kingdom&nbsp;&nbsp;</td>
<td class="normaltext"  valign="TOP">CO</td>
<td class="normaltext"  valign="TOP">Unknown&nbsp;&nbsp;</td>
<td class="normaltext"  align="center" valign="top">lol</td></tr>
<tr><td colspan="5"><hr></td></tr> 
```

每一个 <tr> 你都有这个：**<tr><td colspan="5"><hr></td></tr>**所以它在我的 CSV/Excel 表中放了一个空行。我想在 Excel 工作表中提取所有信息，但每行之间没有空行...

这是我使用的脚本：

```
rows = tableau[3].findAll('tr')
for tr in rows:
    cols = tr.findAll('td', attrs={'class' : 'normaltext'})
    y = 0
    x = x + 1
    for td in cols:
        texte_bu = td.text
        texte_bu = texte_bu.encode('utf-8')
        texte_bu = texte_bu.strip()
        ws.write(x,y,td.text)
        y = y + 1 
```

非常感谢那个能给我提示的人，以便在我的输出文件的每一行之间获取这个**空白无用行的 rib :)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:57:50.477

解决方案：当你找到一个空行时，然后跳过循环并读取下一行。这样可以避免您在工作簿中写入空行。:)

这是一个工作模拟。我添加了一个外观调整，以避免顶部的空行被发送出去。希望这能让你摆脱空行的烦恼:)

```
from BeautifulSoup import BeautifulSoup
import xlwt

text = '''<table><tr><td class="normaltext" valign="TOP">Tesco - United Kingdom&nbsp;&nbsp;</td>
<td class="normaltext"  valign="TOP">CO</td>
<td class="normaltext"  valign="TOP">Unknown&nbsp;&nbsp;</td>
<td class="normaltext"  align="center" valign="top">BULATS</td></tr>
<tr><td colspan="5"><hr></td></tr>
<tr><td class="normaltext" valign="TOP">Tesco - United Kingdom&nbsp;&nbsp;</td>
<td class="normaltext"  valign="TOP">CO</td>
<td class="normaltext"  valign="TOP">Unknown&nbsp;&nbsp;</td>
<td class="normaltext"  align="center" valign="top">BULATS</td></tr>
<tr><td colspan="5"><hr></td></tr><table>'''

wb = xlwt.Workbook()
ws = wb.add_sheet('a test sheet')

soup = BeautifulSoup(text)
table = soup.find('table')
rows = table.findAll('tr')
x = 0
for tr in rows:
    cols = tr.findAll('td', attrs={'class' : 'normaltext'})
    if not cols: 
        # when we hit an empty row, we should not print anything to the workbook
        continue
    y = 0
    for td in cols:
        texte_bu = td.text
        texte_bu = texte_bu.encode('utf-8')
        texte_bu = texte_bu.strip()
        ws.write(x, y, td.text)
        print(x, y, td.text)
        y = y + 1
    # update the row pointer AFTER a row has been printed
    # this avoids the blank row at the top of your table
    x = x + 1

wb.save('example.xls') 
```

# playframework - Logback 真的在游戏中吗？

> ID：10402456
> 
> 赞同：3
> 
> 时间：2012-05-01T18:39:05.027
> 
> 标签：playframework, akka, logback, play2-mini

使用通过 Play-mini 部署的 Akka 2 开发应用程序。我将 logback 拉到项目中并且它可以工作，但是它的配置被踩了，所以有必要做一个 Joran 配置方法并在启动时调用它。然后我读到 play 已经转移到 logback，所以我四处寻找如何使用 Play 内置的记录器并弄清楚了，但只要我输入：

```
Logger.debug( 
```

它只支持：

```
debug(String message, Throwable error)
debug(String message) 
```

logback 的重点是变量参数的东西，所以你不必弄脏你的代码：

```
if (Logger.isDebugEnabled()){
     Logger.debug("my expensive message: " + largeObject.toString());
} 
```

所以我一定错过了什么。文档在这方面也不是很好。

顺便说一句，这是一个关于配置变得混乱[的线程。](https://github.com/typesafehub/play2-mini/issues/7)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T19:55:15.443

是的，Play 被硬编码为使用 LogBack，除非您指定，否则它将接管您的日志设置。很烦人。

从屠宰 logback 设置中停止播放：[https ://github.com/typesafehub/play2-mini/issues/7](https://github.com/typesafehub/play2-mini/issues/7)

# python - 解包浮动时“解包需要长度为 4 的字符串参数”？

> ID：10402457
> 
> 赞同：3
> 
> 时间：2012-05-01T18:39:05.627
> 
> 标签：python, hex, css-float

我正在尝试使用（Python 2.7）以下方法将十六进制值转换为浮点数：

```
def hex2float(x):
    y = 0
    z = x.decode('hex') 
    try:
        y = struct.unpack('!f', z)[0]
    except:
        print sys.exc_info()[1]    
    print 'z = ' + z 
    print 'y = %s' % (y) 
    print 'x = ' + x
    return

def foo28():
    x = '615885'   #8.9398e-039
    hex2float(x) 
```

输出如下：

```
unpack requires a string argument of length 4
z = aXà
y = 0
x = 615885 
```

我注意到我收到了非常小的值的异常消息。对于这种情况，是否有适当的方法将十六进制值转换为浮点值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T18:43:53.303

您需要四个字节来解包，因此如有必要，请在前面添加空字节：

```
z = x.decode('hex') 
z = '\0' * (4 - len(z)) + z 
```

通常`str.decode`只输出表示值所需的字节数，这就是为什么你只看到它发生在小值上的原因。

这完美地工作：

```
>>> z = '615885'.decode("hex")
>>> z = '\0' * (4 - len(z)) + z
>>> struct.unpack('!f', z)
(8.939797951825212e-39,) 
```

如果你也要做双打，这个解决方案仍然有效，只需更改`4`为`8`.

# sql-server - SQL Server 2008 R2 中不允许使用日期类型字段的数据库表？

> ID：10402463
> 
> 赞同：0
> 
> 时间：2012-05-01T18:39:21.747
> 
> 标签：sql-server, compatibility

我正在尝试使用`DATE`SQL Server 2008 R2 中的数据库字段类型创建一个表，但每次尝试时，我都会收到以下消息：

> 列、参数或变量 #10：找不到数据类型日期。

现在我知道 2008 r2 允许使用这种数据类型，那么发生了什么？

我正在尝试在 Microsoft SQL Server Management Studio 中创建此表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:00:46.977

您确定您正在针对 SQL Server 2008 R2 实例运行吗？您是否有可能使用 SQL Server 2008 R2 版本的 Management Studio，但连接到 SQL Server 2005？产生什么`SELECT @@VERSION;`？

# c# - 为什么会抛出 ApplicationException？

> ID：10402464
> 
> 赞同：1
> 
> 时间：2012-05-01T18:39:31.610
> 
> 标签：c#, .net, multithreading, mutex

我只是在 Mutex 上进行试验并编写了以下代码。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace Mutex_WaitOnewithTimeouts
{
    class Program
    {
        private static Mutex mut = new Mutex();
        private static int numOfThreads = 5;
        private static int numOfIterations = 3;
        private static Random rand = new Random();

        static void Main(string[] args)
        {
            Thread[] threads = new Thread[5];
            for (int num = 0; num < numOfThreads; num++)
            {
                threads[num] = new Thread(new ThreadStart(MyThreadProc));
                threads[num].Name = String.Format("Thread{0}", num);
                threads[num].Start();
            }
            Console.Read();
        }

        private static void MyThreadProc()
        {
            for (int iteration = 0; iteration < numOfIterations; iteration++)
            {
                UseResource();
            }
        }

        private static void UseResource()
        {
            Console.WriteLine("{0} accessing ", Thread.CurrentThread.Name);
            int time = (int)(rand.NextDouble() * 100);
            try
            {
                if (mut.WaitOne(time))
                {
                    Console.WriteLine("Yippie got mutex for {0}", Thread.CurrentThread.Name);
                    Thread.Sleep((int)rand.NextDouble() * 5000);
                }
                else
                {
                    Console.WriteLine("Nopee.... Timeout occured for {0}", Thread.CurrentThread.Name);
                }
            }
            catch (AbandonedMutexException ex)
            {
                Console.WriteLine(" Exception is caught");
            }
            finally 
            {
                Console.WriteLine("Releasing mutex for {0}", Thread.CurrentThread.Name);
               mut.ReleaseMutex();

            }

        }
    }
} 
```

但是我有时会收到 ApplicationException 。如果我的代码有任何问题，有人可以帮助我，还请解释何时会触发此异常。

对象同步方法是从未同步的代码块中调用的。尝试释放互斥锁时，我在 finally 块中得到了这个。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T18:46:35.647

即使您的 WaitOne 失败，您也正在释放互斥锁。将 ReleaseMutex 调用移到您知道已获得互斥锁的 if 语句中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:25:33.683

@John 的答案是正确的，但对于后代来说，我认为更好的模式是在 the 中设置一个布尔值为真，`if`然后仍然`release`在`finally`块中执行，但这次只有在布尔值为真时才这样做。问题是如果任何`if`子句抛出，则互斥锁将不会被释放。我假设您将在该`if`子句中添加更多内容，而不仅仅是写入和睡眠。

如果可以的话，你总是想使用一个`try { ... } finally`模式，但只是防止`waitOne()`调用返回 false。类似于以下内容：

```
bool release = false;
try {
    if (mut.waitOne(time)) {
        release = true;
        ...
    } else {
        ...
    }
} catch (AbandonedMutexException ex) {
    ...
} finally {
    ...
    if (release) {
        mut.ReleaseMutex();
    }
} 
```

# c# - 使用多个进程/线程/任务从多个来源收集数据

> ID：10402469
> 
> 赞同：2
> 
> 时间：2012-05-01T18:39:47.750
> 
> 标签：c#, .net, windows

让我们想象一组数据源，即一对热传感器或摄像机。我想从奴隶中的这些来源收集数据并传递给主人。

效率是运营的关键方面。

我应该使用多个进程还是线程/任务？

**编辑：**我忘了提......所有数据源都应该同步服务，同样具有相同的优先级，同时，无论 CPU 和内存使用情况以及可用内核数量如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:42:01.760

如果您要从多个从属设备传递给一个主设备，请使用线程。这将帮助您共享地址空间，并可能使任务更易于实施。如果您有很多从属服务器并希望获得最高效率，请使用线程池来服务从属服务器源。

使用多个进程只会增加进程上下文切换开销，这通常比线程上下文切换略多。您还必须管理进程间通信，这通常比线程间通信更复杂且效率更低。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:56:48.267

这样做的典型方法是使用读写器锁（ .NET 中的[ReaderWriterLockSlim](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)）。您的编写者将排队等待对您的共享状态映射的一次一次写入访问，而您的读者（例如您的客户端应用程序）可以同时读取，但显然不是在生产者写入状态时.

编辑：这显然是在使用线程。进程间通信会扼杀您可能拥有的任何体面性能的希望。

# php - 学习数据库性能：php和mysql

> ID：10402475
> 
> 赞同：1
> 
> 时间：2012-05-01T18:40:18.093
> 
> 标签：php, mysql, database, normalization

我正在开发一种投标网站，并将项目（及其详细信息）放在一个表中进行投标，并将投标保存在另一个表中。

原则上，为了表示中标（用于检索历史等），最好：

1.  在名为 bidWon 的项目表中存储一列，并将投标 ID 存储在那里，然后以这种方式检索它？
2.  在投标表中存储一列“状态”或其他内容，并在投标成功时附加项目 ID；否则将该列留空，然后使用 NOT IN“获胜”或其他内容查询数据库。
3.  两者都用于通过项目或投标表快速拉取（并使用 JOIN 或其他东西来获取所有适当的数据）。
4.  ？？？有什么我没有想到的？

当我进入下一个级别的数据库编程并希望从一开始就防止性能问题时，我广泛地问了这个问题。

谢谢！

# algorithm - 使用 Scala 翻转硬币

> ID：10402479
> 
> 赞同：1
> 
> 时间：2012-05-01T18:40:24.290
> 
> 标签：algorithm, scala, optimization, data-structures, iteration

我正在尝试解决 scala 中 codechef 的翻转硬币问题。问题陈述如下：

> 桌上有 N 个硬币，编号从 0 到 N - 1。最初，每个硬币都是反面朝上的。您必须执行两种类型的操作： 1) 翻转编号在 A 和 B 之间的所有硬币。这由命令“0 A B”表示 2) 回答编号在 A 和 B 之间的硬币有多少是正面朝上的。这由命令“1 A B”表示。输入：第一行包含两个整数，N 和 Q。接下来的 Q 行中的每一行都是上面提到的“0 A B”或“1 A B”的形式。
> 
> 输出：为“1 A B”形式的每个查询输出 1 行，其中包含相应查询所需的答案。

样本输入：

```
 4 7
1 0 3
0 1 2
1 0 1
1 0 0
0 0 3
1 0 3 
1 3 3 
```

> 样本输出：

```
0
1
0
2
1 
```

> 约束：1 <= N <= 100000 1 <= Q <= 100000 0 <= A <= B <= N - 1

以最简单的方式，我正在考虑在 scala 中初始化一个 Ints 数组，如下所示：

```
 var coins = new Array[Int](1000) 
```

如果我遇到命令 0 AB，我将简单地将 A 的索引设置为直到 B+1 为 1，如下所示：

```
 for(i <- 5 until 8){
      coins(i) = 1
    } 
```

如果我遇到命令 1 AB，我将从 A 到 B+1 取出数组的一个切片，并计算给定切片中 1 的数量，我将按如下方式执行：

```
val headCount = coins.slice(5,8).count(x => x == 1) 
```

看起来这个操作在最坏的情况下需要 O(n) ，显然这可以优化为在对数时间内解决。

有人可以指出我在这里可能做错了什么以及如何以最佳方式解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:50:26.273

这些天我对 scala 了解不多，但我可以为关于 O(log(n)) 的更一般的问题提出一个答案。通常这样的算法使用树，我认为你可以在这里这样做。

如果您构建一个平衡树，硬币作为叶子，那么您可以在每个节点中存储硬币的总数和该节点下方叶子中的正面数量。您可以想象翻转硬币的代码从节点信息中计算出要访问的叶子，并在 O(n) 时间内工作（您仍然需要翻转硬币）。但是如果翻转代码也更新了节点数据，那么头的数量将是 O(log(n)) 因为您可以使用节点信息 - 您不需要去叶子。

这样一个命令给你 O(n)，另一个命令给你 O(log(n))。

但你可以做得更好。我认为你也可以进行翻转操作 O(log(n))。为此，您将向每个节点添加一个“翻转”标志。如果设置，则该点以下的所有节点都被翻转。有一些记账细节，但总体思路是有的。

如果您将此得出合乎逻辑的结论，那么您实际上不需要存储叶子，至少在开始时是这样。您只需在处理命令时添加具有所需详细程度的节点。此时，您基本上有了评论中提到的区间树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:24:54.797

一种简洁的建模方法是作为[`BitSet`](http://www.scala-lang.org/api/current/scala/collection/immutable/BitSet.html)，其中集合中的整数值表示棋盘上正面的索引。然后你可以在这样的范围内翻转硬币：

```
def flip(coins: BitSet, a: Int, b: Int) = coins ^ BitSet(a to b: _*) 
```

您可以类似地计算范围内的正面数：

```
def heads(coins: BitSet, a: Int, b: Int) = (coins & BitSet(a to b: _*)).size 
```

或者（可能更快）可变`java.util.BitSet`版本：

```
import java.util.BitSet

def flip(coins: BitSet, a: Int, b: Int) { coins.flip(a, b + 1) }
def heads(coins: BitSet, a: Int, b: Int) = coins.get(a, b + 1).cardinality 
```

这不一定是最佳的，但它是一种相当有效的方法，因为您只是在翻转位。

# asp.net - 如何编写桥接两个表的查询？

> ID：10402480
> 
> 赞同：0
> 
> 时间：2012-05-01T18:40:36.070
> 
> 标签：asp.net, mysql

我有两个表，这些表中两个不同名称的列匹配。

```
Table A:
a
b
c
d
e

Table B:
f
g
h 
```

我需要显示 e、g 和 h 的网格视图，根据 f 和 b 匹配将表连接在一起。我知道如何根据查询填充网格视图，它只是我所追求的查询本身。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T18:42:51.667

由于您的所有列都是唯一命名的，并且您要连接两个不同的表，因此不需要别名，并且您不需要完全限定列名。

您要查找的 SQL 术语是 JOIN。在这种情况下，听起来你想要一个内部连接（有很多方法可以编写它们）。

```
SELECT 
    e,g,h
FROM 
    TableA 
    INNER JOIN TableB 
        ON b = f 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T18:43:12.413

您在问题中使用了这些词：“*根据 f 和 b 匹配将表格连接在一起*”。

```
SELECT e,g,h FROM `Table A` JOIN `Table B` ON f=b 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T18:44:24.523

我认为可能是：

```
SELECT e,g,h FROM Table A, Table B WHERE Table A.b == Table B.f 
```

这就是我要使用的 JOIN。它可能需要根据您的变量进行调整。

抱歉，这适用于 SQL 而不是 MYSQL。

# spring - 春季ROO排序

> ID：10402482
> 
> 赞同：2
> 
> 时间：2012-05-01T18:40:46.067
> 
> 标签：spring, sorting

我有一组使用 Spring ROO 生成的实体。在几个命令之后，基本上使用 web mvc，我有一组链接可以从数据库中获取内容。我需要根据标题对内容进行排序，而不是按照表格中的顺序。我该怎么做？是否有任何 Spring ROO 突击队或注释来订购物品。

更多信息，我使用的是 Spring Roo 1.2.1，我得到的 finder 如下。

```
 public static List<Deporte> Deporte.findAllDeportes() {
    return entityManager().createQuery("SELECT o FROM Deporte o", Deporte.class).getResultList();
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:46:35.117

Spring Roo 使用 JPA 进行持久化。搜索 JPA 教程和文档以找到您要查找的内容。

JPQL 使用该`order by`子句对查询返回的结果进行排序。这与 SQL子句`order by`非常相似：`order by`

```
SELECT o FROM Deporte o order by o.title 
```

# rubymine - JetBrains RubyMine 代码 MS Word 导出

> ID：10402486
> 
> 赞同：0
> 
> 时间：2012-05-01T18:41:36.600
> 
> 标签：rubymine

RubyMine IDE 中是否有将代码导出到 Microsoft Word 文档中的功能，同时保留 RubyMine 的格式（字体系列、字体大小、颜色等）？

谢谢你的帮助！

亲切的问候，嘘

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:55:12.853

检查[这个答案](https://stackoverflow.com/a/4883770/104891)。

然后，您可以将格式丰富的文本粘贴到 Microsoft Word 中。

# java - 征求意见：实例级安全性的架构蓝图

> ID：10402487
> 
> 赞同：2
> 
> 时间：2012-05-01T18:41:45.313
> 
> 标签：java, spring, security, architecture

语境

1.  卖家列出物品的商业市场
2.  有一个操作 Item::setPrice
3.  商品的卖家或客户服务代表可以更改商品的价格。
4.  #3 的安全检查在项目的数据访问层附近实施，以最大限度地提高安全检查的覆盖范围。

很多人喜欢将安全性作为一个*正交问题*来讨论，但我（目前？）不同意这一点，尤其是在考虑实例级安全性时，因为这与域模型密不可分。底线是，我实际上*更喜欢*在代码中明确说明#3 中的安全不变量（通过代码或 Spring Security EL 注释）。我认为这样的安全不变量是业务逻辑的一部分。我还希望开发人员的安全。这与 IMO 的职责不相关。

我可能会写这样的东西：

```
@PreAuthorize("hasRole('CSR_ITEM_WRITER') or #item.seller.id == principal.id')
public void setPrice(Item item, Money price) { ... } 
```

我意识到这在发展安全模型时会产生一定程度的不灵活性（但考虑到错误的影响，这是一件坏事吗？）

我们还讨论了 CS 代表必须“成为”卖方的方法。有一定的清洁度（因为它确实将安全模型集中在域而不是用例上）。*（注意将进行充分的审计以检测某人何时代表他人行事）*

意见？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:17:55.727

我认为您正在做的是一个好主意（我目前正在做类似的事情）。

我建议您看一下 Spring Security 中的 PermissionEvaluator 组件（请参阅[此处](http://blog.solidcraft.eu/2011/03/spring-security-by-example-securing.html "Solid Craft 教程")），因为它比普通注释具有一些优势

1.  您的安全机制可以更容易地更改，因为它更加全球化
2.  安全评估可以通过审计日志/监控/...轻松扩展
3.  Evaluator 实现可以进行单元测试（注释需要运行 spring 上下文才能工作，因此只能在集成测试中进行测试）

到目前为止，我没有发现这个想法的直接缺点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:49:18.797

我认为你做得完全正确。当你说安全是一个正交的问题时，正交于什么？当你说这应该是业务逻辑的一部分时，你是 110% 正确的。

我会保持 REP 和 SELLER 之间的分离。两者都是独特的角色；对于这种特殊情况，它们碰巧有重叠。

考虑到在这种情况下安全性的重要性，我希望你会编写一个单元测试的垃圾风暴，在给定附加到选项的角色的情况下展示适当的结果。

# android - Activity中的刷新地图没有反应

> ID：10402492
> 
> 赞同：0
> 
> 时间：2012-05-01T18:42:15.540
> 
> 标签：android, android-mapview

我有一个扩展 MapActivity 的活动，它有两个主要元素，左侧的列表视图和右侧的地图。我在地图上放了一个刷新按钮并尝试：

```
map.setTraffic(true);
map.invalidate(); 
```

但没有任何改变。地图没有刷新。我确实在谷歌上搜索了一下，并明白 invalidate() 应该可以解决问题。我想避免重新创建整个活动。请帮忙？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:37:35.877

你甚至不应该需要`invalidate()`. [此示例应用程序](https://github.com/commonsguy/cw-android/blob/master/Maps/NooYawk)`setSatellite()`只需在您按下`<S>`模拟器中的键时调用即可在常规磁贴和卫星磁贴之间切换。

暂时切换到`setSatellite()`而不是`setTraffic()`。如果可行，则问题与我从未尝试过的交通图块集有关。

# arm - 统一 ARM Cortex M3 文档

> ID：10402495
> 
> 赞同：1
> 
> 时间：2012-05-01T18:42:31.483
> 
> 标签：arm

我发现 ARM 内核（来自 ARM）和供应商特定文档之间存在一定程度的重叠文档，这些文档重复了 ARM 本身已经给出的 ARM 内核信息。以 STM32F10xxx/20xxx/21xxx/L1xxxx 作为器件系列示例，有相当多的冗余内核特定信息分布在 6 个数据表和手册中，来自 ARM 和 STM。

我的问题是，是否有任何努力减少 ARM 核心实施公司的这些信息的冗余？感谢您的任何回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:24:31.927

通常使用 arm，我假设其他 IP 供应商内核（mips 等）您希望专门从 ip 供应商 (arm) 获取内核文档。在这种情况下[http://infocenter.arm.com](http://infocenter.arm.com)获取 ARMv7-M 的 ARM 架构参考手册 (ARM ARM)，然后在 Cortex-M 下获取 Cortex-m3 或 m4 或 m0 技术参考手册 (TRM)，如果芯片供应商提供了该信息（即使它不是最新的手册），理想情况下获得特定于设备内核版本的手册。

从芯片供应商的角度来看，当您在零件内部购买了 ip 后，无论何时创建程序员参考手册，您仍然希望为用户提供完整的手册。我认为 ARM 限制了您可以/应该发布的数量，并且更愿意提供核心文档。诸如 Cortex-M3 内部的定时器之类的外围设备具有由 ARM 驱动的偏移量，但由芯片供应商驱动的基地址，您经常会在芯片和 ip 供应商手册中看到描述。与 ARM 不同，一些 IP 供应商不希望用户看到他们的手册，他们希望芯片供应商处理提供和支持编程支持的问题。因此，在 IP 供应商和芯片供应商的基础上，您将看到文档问题的大量解决方案。

在单一芯片供应商公司中，您会看到相同的习惯，可能是因为只有一个人或团队为一个芯片系列或通过公司政策/实践编写所有手册，或者因为下一个芯片手册窃取了相当数量的先前芯片和芯片手册中的逻辑和内容（根据需要剪切和粘贴并更改一些内容）。

您不会看到两个相互竞争的芯片供应商正在标准化。看看你是否可以让 Intel 和 AMD 共同创建一份 x86 手册，或者在芯片引脚排列、尺寸、功率等方面遵循相同的标准。一个可能会复制另一个以减少替换或源代码兼容部件，但你不会通常看到芯片供应商相处得很好。这样做通常不符合他们的最佳利益。他们可能不得不互相购买 ip 块或让律师编写专利使用费支付协议之类的东西，但除非出于某种原因被迫，否则您不会看到他们并排坐在一起做某事。

完美的例子是 cortex-m3 内部的系统计时器或有关内部内核中断信息的信息或类似的信息，尤其是如果供应商在 arm 内核之外添加了自己的中断逻辑和寄存器。很少，除非获得成功许可的克隆 (xscale)，否则您会看到完整的指令集。

如果供应商自己发布这些信息，那将更加混乱，标准化程度更低。由于您不想或不会在您的文档中发布而迫使程序员到处寻找已经移动或不存在的文档，这对程序员来说有点不妥，同时尽管体验是一致的，arm程序员使用 ARM 文档，它的 arm 核心方面是跨芯片供应商的一致体验。

# c++ - mkdir c++ 函数

> ID：10402499
> 
> 赞同：16
> 
> 时间：2012-05-01T18:42:54.430
> 
> 标签：c++, visual-studio-2008

我需要在 VS 2008 中使用 mkdir c++ 函数，该函数需要两个参数，并且已从 VS 2005 中弃用。

但是这个函数在我们的代码中使用，我需要编写一个独立的产品（只包含 mkdir 函数）来调试一些东西。

我需要导入哪些头文件？我使用了 direct.h，但是编译器抱怨该参数不接受 2 个参数（原因是该函数在 VS 2005 中已弃用）。

```
mkdir("C:\hello",0); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-01T18:45:34.503

如果要编写跨平台代码，可以使用`boost::filesystem`例程

```
#include <boost/filesystem.hpp>
boost::filesystem::create_directory("dirname"); 
```

这确实添加了一个库依赖项，但您也可能会使用其他文件系统例程，并且`boost::filesystem`为此提供了一些很棒的接口。

如果您只需要创建一个新目录并且您只打算使用 VS 2008，则可以`_mkdir()`按照其他人的说明使用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-01T18:45:10.617

它已被弃用，但符合 ISO C++ 标准`_mkdir()`取代了它，因此请使用该版本。您只需要调用它的目录名称，它的唯一参数：

```
#include <direct.h>

void foo()
{
  _mkdir("C:\\hello"); // Notice the double backslash, since backslashes 
                       // need to be escaped
} 
```

[这是来自MSDN](http://msdn.microsoft.com/en-us/library/2fkk4dzw(v=vs.80).aspx)的原型：

> int _mkdir( const char *dirname );

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-10T18:10:46.573

我的跨平台解决方案（递归）：

```
#include <sstream>
#include <sys/stat.h>

// for windows mkdir
#ifdef _WIN32
#include <direct.h>
#endif

namespace utils
{
    /**
     * Checks if a folder exists
     * @param foldername path to the folder to check.
     * @return true if the folder exists, false otherwise.
     */
    bool folder_exists(std::string foldername)
    {
        struct stat st;
        stat(foldername.c_str(), &st);
        return st.st_mode & S_IFDIR;
    }

    /**
     * Portable wrapper for mkdir. Internally used by mkdir()
     * @param[in] path the full path of the directory to create.
     * @return zero on success, otherwise -1.
     */
    int _mkdir(const char *path)
    {
    #ifdef _WIN32
        return ::_mkdir(path);
    #else
    #if _POSIX_C_SOURCE
        return ::mkdir(path);
    #else
        return ::mkdir(path, 0755); // not sure if this works on mac
    #endif
    #endif
    }

    /**
     * Recursive, portable wrapper for mkdir.
     * @param[in] path the full path of the directory to create.
     * @return zero on success, otherwise -1.
     */
    int mkdir(const char *path)
    {
        std::string current_level = "";
        std::string level;
        std::stringstream ss(path);

        // split path using slash as a separator
        while (std::getline(ss, level, '/'))
        {
            current_level += level; // append folder to the current level

            // create current level
            if (!folder_exists(current_level) && _mkdir(current_level.c_str()) != 0)
                return -1;

            current_level += "/"; // don't forget to append a slash
        }

        return 0;
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-05-01T18:45:16.980

现在有这个[`_mkdir()`](https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/mkdir-wmkdir?view=vs-2019)功能。

# linux - linux - 将输出从 apachetop 导出到文件

> ID：10402507
> 
> 赞同：0
> 
> 时间：2012-05-01T18:43:40.173
> 
> 标签：linux, shell

是否可以将输出从 apachetop 导出到文件？像这样：“apachetop > file”，但是因为 apachetop 正在“永远”运行，所以这个命令也永远在运行。我只需要从这个程序中获取实际输出并在我的 GTK# 应用程序中处理它。每一个答案都将不胜感激。马特杰。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:05:18.630

这可能有效：

{ apachetop > 文件 2>&1 & 睡眠 1; 杀死$！; }

但不能保证:)

使用 linux 的另一种方法是找出运行程序并直接从该文件读取时正在使用的 /dev/vcsN 设备。它包含给定 VT 的屏幕数据副本；我不确定是否有适用于 pty 的设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:54:25.600

间接地，apachetop 正在使用 access.log 文件来获取它的数据。

看着

> /var/log/apache2/access.log

您只需解析文件即可获得您正在寻找的信息！/var/log/apache2/access.log

# iis-7 - Windows IIS7 数据中心版中的图像大小调整

> ID：10402512
> 
> 赞同：0
> 
> 时间：2012-05-01T18:44:00.840
> 
> 标签：iis-7, asp-classic, vbscript

我尝试在我的新服务器中从服务器对象安装我的旧 ASPImage，但是即使注册了 dll 并且在 IIS7 中启用了 ASP，也没有创建对象。有没有人对这个问题有任何想法，或者使用了可以从 VBS 和 ASP 经典中调用的不同组件？

我尝试在对象上运行测试，它返回内部服务器错误。在 VBS 中运行时，没有错误，但它会忽略该对象。

谢谢詹姆斯 F。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T13:10:36.387

假设您有一个 64 位 Web 服务器，您必须使用 32 位组件在应用程序池中启用“启用 32 位应用程序”设置。

有关详细信息，请参见此处：http: [//help.webcontrolcenter.com/KB/a1114/how-to-enable-32-bit-application-pool-iis-7-dedicatedvps.aspx](http://help.webcontrolcenter.com/KB/a1114/how-to-enable-32-bit-application-pool-iis-7-dedicatedvps.aspx)

# sql-server - SQL where 子句中的字符串函数

> ID：10402514
> 
> 赞同：0
> 
> 时间：2012-05-01T18:44:19.740
> 
> 标签：sql-server

可以说我有一个领域。让我们称之为 Barcode1。现在所有的 Barcodes1 都是 22 个字符，每个字符都是一个整数。假设有第二个字段 Barcode2。这两个都是`varchar(22)`

我的条件用简单的英文术语是：Bar​​code1 与barcode2 相同，但数字7,8 除外，对于barcode2，数字7 和8 与barcode1**加20相同**

所以

```
001214**54**54545654521523
549462**74**48634842135782 
```

我也想要 where 子句的否定，其中返回不匹配条件的行。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:54:47.940

我认为这就是你想要的：

**示例数据：**

```
DECLARE @table TABLE ( barcode VARCHAR(22) )
INSERT  INTO @table
        (
          barcode
        )
        SELECT  '0012145454545654521523'
        UNION ALL
        SELECT  '0012142454545654521523'
        UNION ALL
        SELECT  '5494627448634842135782'
        UNION ALL
        SELECT  '5494625448634842135782' 
```

**第一个条件 - 满足 7,8 + 20**

```
SELECT  a.barcode,
        b.barcode,
        SUBSTRING(a.barcode, 7, 2) a,
        SUBSTRING(b.barcode, 7, 2) b
FROM    @table a
        INNER JOIN @table b
            ON SUBSTRING(a.barcode, 7, 2) + 20 = SUBSTRING(b.barcode, 7, 2)
               AND a.barcode != b.barcode 
```

返回：

```
barcode                 barcode                  a  b
0012145454545654521523  5494627448634842135782  54  74
5494625448634842135782  5494627448634842135782  54  74 
```

**不存在 7,8 + 20 的否定**

```
SELECT  *
FROM    @table a
WHERE   NOT EXISTS ( SELECT TOP 1 1
                     FROM   @table b
                     WHERE  SUBSTRING(a.barcode, 7, 2) + 20 = SUBSTRING(b.barcode, 7, 2) ) 
```

返回：

```
0012142454545654521523
5494627448634842135782 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:48:30.350

您必须使用字符串操作来分解该条形码，例如：

```
WHERE
    substring(barcode1, 0, 6) = substring(barcode2, 0, 6) AND
    substring(barcode1, 9, 2) = substring(barcode2, 0, 9) AND
    etc... 
```

而且由于您将对函数结果进行这些比较，因此不会使用索引。如果这是一个频繁的操作，您最好将条形码字符串拆分为单独的字段，这样您就可以将各个块作为完全独立的可索引字段进行比较。

# java - 使用 xpointer() 方案支持 XPointer 的 Java 库？

> ID：10402515
> 
> 赞同：6
> 
> 时间：2012-05-01T18:44:23.120
> 
> 标签：java, xpointer

是否有任何支持带有 xpointer() 方案的 XPointer 的 java 库？

Xerces 支持 XPointer 框架和 XPointer element() 方案的 XInclude，但不支持 xpointer() 方案。

关于 xpointer() 模式的最新 W3C 文档来自 2002 年，但仍只是草稿：[http ://www.w3.org/TR/xptr-xpointer/](http://www.w3.org/TR/xptr-xpointer/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T15:05:25.950

对于 xerces，我在一个 GSoc 项目下实现了 XPointer xpointer() 方案。但是这种支持需要进一步改进才能可用。我认为也没有其他支持。Xerces 将来可能会支持这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-27T15:14:23.173

可能这可以帮助你： [http ://etourdot.github.io/xincproc/](http://etourdot.github.io/xincproc/)

不支持 xpointer 函数，但 xpointer 方案中的 xpath 已完全实现。此处的示例：http: [//etourdot.github.io/xincproc/xpointer/specs/org/etourdot/xincproc/xpointer/xpointer/XPointer.html](http://etourdot.github.io/xincproc/xpointer/specs/org/etourdot/xincproc/xpointer/xpointer/XPointer.html)

# sql - SQL 查询以逗号分隔的字符串返回结果（优化）

> ID：10402523
> 
> 赞同：1
> 
> 时间：2012-05-01T18:44:46.730
> 
> 标签：sql, string, stored-procedures, coalesce, sql-function

我想运行一个存储过程，它返回一大堆东西，其中一个是逗号分隔的结果字符串。

我已经阅读了 COALESCE 并创建了一个这样的函数：

```
DECLARE @ListOfStuff NVARCHAR(4000)

SELECT  @ListOfStuff = COALESCE(@ListOfStuff + ', ', '') + Z.SingleStuff
FROM    X 
INNER JOIN Y ON X.SomeId = Y.Id
INNER JOIN Z ON Y.SomeId = Z.id
WHERE --Some condition

RETURN ISNULL(@ListOfStuff, '') 
```

然后在我的主 SELECT 中调用这个函数，它按预期工作。但是，该过程现在需要很长时间才能运行并且经常超时。我想知道的是，是否有人知道如何优化它。我相信摆脱该功能并将此逻辑合并到过程中将使它运行得更快，但我无法找到一种方法来拥有以这种方式使用 COALESCE 的子选择。

任何想法如何优化这个逻辑？提前谢谢了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:19:53.547

您可以通过将 @ListOfStuff 声明为 '' 来完全取消 COALESCE，然后稍微不同地处理字符串连接和最终返回值。就目前而言，您正在对每一行进行评估。

```
DECLARE @ListOfStuff NVARCHAR(4000) = ''

SELECT  @ListOfStuff = @ListOfStuff + Z.SingleStuff + ','
FROM    X 
INNER JOIN Y ON X.SomeId = Y.Id
INNER JOIN Z ON Y.SomeId = Z.id
WHERE --Some condition

IF LEN(@ListOfStuff) > 0
BEGIN
    SELECT @ListOfStuff = LEFT(@ListOfStuff, LEN(@ListOfStuff) - 1)
END
RETURN @ListOfStuff 
```

可能的优化是确保连接中使用的所有列都有索引，如果您可以使用 varchar 而不是 nvarchar（当然取决于 z.SingleStuff 的内容和数据类型），这可能会有所帮助。但是我不确定如果不对调用它的存储过程进行可能的重大修改，您还能做什么。

如果要为 SELECT 的每一行调用此函数，那么您可能对表值函数或 CROSS APPLY 有一些运气（取决于您如何使用它，以及您的 RDBMS）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:00:55.033

COALESCE 并没有真正在这里做工作（它只是整理空值 - 请参阅[http://msdn.microsoft.com/en-us/library/ms190349.aspx](http://msdn.microsoft.com/en-us/library/ms190349.aspx)）

使用逗号连接值是使用@ListOfStuff 变量完成的，并且确实似乎是一种很好的（唯一的？）方法，即如果你摆脱了这个函数，你仍然需要这样做在您的存储过程中。拥有一个函数本身不应导致您看到的性能下降。

所以，除了确保您的连接列（id，SomeId）被索引之外，我不确定您是否可以优化它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T09:56:34.960

在没有看到您的 SP 的情况下，我无法提出实际可行的解决方案，但是如果您使用 SQL-Server，您可以使用该`FOR XML PATH`方法，该方法在 SO 的许多问题中都有体现。我最近回答了一个问题，打破了这种方法背后的[逻辑](https://stackoverflow.com/questions/10381512/what-this-query-does-to-create-comma-delimited-list-sql-server/10381975#10381975)。我更喜欢这种方法而不是函数方法，因为函数偏离了首选的基于集合的 SQL 方法。

[KM](https://stackoverflow.com/users/65223/km)指出了我的方法的一个缺陷，并[在此处](https://stackoverflow.com/questions/5031204/does-t-sql-have-an-aggregate-function-to-concatenate-strings/5031297#5031297)提供了一个更好的解决方案的链接，同样的逻辑仍然适用，但是 KM 避免了文本中出现保留字符以进行连接的问题。

我对您正在寻找的解决方案的最佳猜测如下：

```
SELECT  X.SomeColumn,
        Y.SomeColumn,
        STUFF(( SELECT  ', ' + Z.SingleStuff
                FROM    Z
                WHERE   Z.ID = Y.SomeID
                FOR XML PATH(''), TYPE
            ).Value('.', 'VARCHAR(MAX)'), 1, 2, '') [ListOfStuff]
FROM    X 
        INNER JOIN Y 
            ON X.SomeId = Y.Id
WHERE --Some condition 
```

# django - 模板中的django简单关系

> ID：10402524
> 
> 赞同：0
> 
> 时间：2012-05-01T18:45:00.990
> 
> 标签：django

我有更多的逻辑问题，然后是编程问题。我有一种社交网站，用户在其中互相关注（类似于 Twitter）。如果用户关注/不关注另一个用户，那么签入模板的最佳方法是什么，以便我可以相应地显示“关注”链接？我在想一些自定义函数，比如管理器，它检查 request.user，然后如果已经存在链接关系，则返回 true 或 false。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:48:47.717

这完全取决于您如何实现以下操作。必须有某种方式来连接用户和他们的追随者。您可以只查询持有追随者的模型，如果`count()`大于 0 则显示链接。

# vba - 如何将宏复制到工作簿的生产版本？

> ID：10402529
> 
> 赞同：0
> 
> 时间：2012-05-01T18:45:16.030
> 
> 标签：vba, excel-2010

我的开发环境中有一个 Excel 2010 工作簿，其中包含我现在想要放入此工作簿的生产版本的宏和表单。如何将我的代码和表单实现到工作簿的生产版本中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:21:22.630

右键单击 VBE 资源管理器中的代码/表单，然后选择导出。将导出的文件导入您的生产工作簿。

# c - 展开array linux内核模块

> ID：10402531
> 
> 赞同：4
> 
> 时间：2012-05-01T18:45:28.540
> 
> 标签：c, linux-kernel

我有一个数组

```
char* temp;
temp=kmalloc(3,GFP_KERNEL); 
```

我每次调用这个函数都需要扩展这个数组注意：Realloc不能在linux内核中使用我不知道它是否存在

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T18:52:50.600

滚动你自己的 realloc 但请注意 realloc 是一个设计不佳的函数接口。只需使用 kmalloc 分配一个新缓冲区并将旧数据 memcpy 到新缓冲区中；如果它不能扩展缓冲区，这基本上就是 realloc 所做的一切。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T22:40:51.123

`<linux/slab.h>`确实必须`krealloc()`去`kmalloc()`。这是在 2007 / 内核 2.6.22 中添加的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:02:18.453

我建议您应该使用基于映射内存（或类似的东西）的固定大小的环形缓冲区，而不是每次都扩大分配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T08:34:06.200

您可能想要使用类似 Linux 的灵活数组实现之类的东西。请参阅 [http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=Documentation/flexible-arrays.txt;h=df904aec99044f8056ac530b9e9dc6de8f26f73e;hb=HEAD](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=Documentation/flexible-arrays.txt;h=df904aec99044f8056ac530b9e9dc6de8f26f73e;hb=HEAD)

# iphone - 捆绑标识符混淆

> ID：10402535
> 
> 赞同：0
> 
> 时间：2012-05-01T18:45:38.017
> 
> 标签：iphone

info plist 中的 Bundle Identifier 有我的名字作为公司名称，然后是产品名称，它基本上是应用程序名称。

所以我的问题是，当我在配置文件 myname.appname 中输入 Bundle Identifier 时，它会以红色显示，请仅使用字母字符或数字。这是为什么。我没有公司域名，而是我的名字。所以我在 Bundle Identifier 中使用 myname.appname 它以红色显示消息。

我在这里做错什么了吗。

请建议。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:22:44.257

解决了。在我的名字中使用了空格，这就是问题所在。如果使用名称而不是公司名称，则应该没有空格。所以基本上 myname.appname 之间没有空格

# bash - 如何获得 getopts 源？

> ID：10402536
> 
> 赞同：0
> 
> 时间：2012-05-01T18:45:43.130
> 
> 标签：bash, getopts

我的嵌入式设备使用busybox，它只有getopt。我想将 getopts 移植到我的嵌入式设备上，并正在寻找 getopts 源来做到这一点。我在哪里可以找到 getopts 源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:58:50.817

您应该在 bash 源代码中找到它。你可以`bash`从[这里下载](http://ftp.gnu.org/gnu/bash/)

你会发现`getopts.def`里面的`builtins/`目录。 `mkbuiltins -D . getopts.def`将创建 getopts.c。你将不得不做`configure`，`make`这将创建`mkbuiltins` 内部`builtins/`目录。

# bash - 更改 bash 中的变量

> ID：10402537
> 
> 赞同：26
> 
> 时间：2012-05-01T18:45:43.853
> 
> 标签：bash

如何更改此 var ？

```
max=0;
min=20000000;
cat |while read
do
    read a
    if [[ $a -gt $max ]]
    then
        max=a`
    fi
    `if [[ $a -lt $min ]]
    then
        min=a
    fi
done
echo $max 
echo $min 
```

我的最小值和最大值仍然相同，0 和 2000000。有人可以帮我解决这个问题吗？我不知道。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-01T18:56:42.857

您的脚本的（主要）问题是设置`min`并`max`发生在子外壳中，而不是您的主外壳中。因此，管道完成后更改不可见。

另一个是你调用 read 两次 - 如果你想跳过每隔一行，这可能是有意的，但这有点不寻常。

最后一个是`min=a`设置`min`为`a`，字面意思。您想将其设置为`$a`.

使用[进程替换](http://tldp.org/LDP/abs/html/process-sub.html)来解决第一个问题，删除（可能）不必要的第二次读取，并修复分配，您的代码应如下所示：

```
max=0
min=20000000
while read a
do
    if [[ $a -gt $max ]]
    then
        max=$a
    fi
    if [[ $a -lt $min ]]
    then
        min=$a
    fi
done < <(cat)    # careful with the syntax
echo $max 
echo $min 
```

* * *

# python - 如何用 BeautifulSoup 和 Regex 解析这个 HTML 表？

> ID：10402541
> 
> 赞同：0
> 
> 时间：2012-05-01T18:45:59.890
> 
> 标签：python, regex, beautifulsoup, html-table

我的 HTML：

```
 <table cellspacing="0" cellpadding="2" rules="all" border="1" id="branchTable" width="100%">
            <tr class="TitleTable">
                <th scope="col" width="250"><b>Branch Name</b></th><th scope="col" width="35%"><b>Branch Date</b></th><th scope="col" width="35%"><b>Branch Origin</b></th>
            </tr><tr class="RowSet">
                <td><a class="blue" href="javascript: OpenWindow(&#39;/home/data/files/fetchRecord.php?fileID=342&#39;)">SFO Branch</a></td><td class="red">03/16/2012</td><td class="red">&nbsp;</td>
            </tr><tr class="RowSet">
                <td><a class="blue" href="javascript: OpenWindow(&#39;/home/data/files/fetchRecord.php?fileID=884&#39;)">LAX Branch</a></td><td class="red">03/16/2012</td><td class="red">06/16/1985</td>
            </tr><tr class="RowSet">
                <td><a class="blue" href="javascript: OpenWindow(&#39;/home/data/files/fetchRecord.php?fileID=83&#39;)">DC Branch</a></td><td class="red">03/16/2012</td><td class="red">&nbsp;</td>
            </tr>
            </table> 
```

到目前为止我的代码：

```
from BeautifulSoup import BeautifulSoup

soup = BeautifulSoup(pageSource)
table = soup.find("table", id = "branchTable")
rows = table.findAll("tr", {"class":"RowSet"})

data = [[td.findChildren(text=True) for td in tr.findAll("td")] for tr in rows]
print data 
```

输出 ：

```
SFO Branch  03/16/2012  &nbsp;
LAX Branch  03/16/2012  06/16/1985
DC Branch   03/16/2012  &nbsp; 
```

期望：

我想获取标签中包含的数据以及 ID (fetchRecord.php?fileID= **342** )。不确定如何获取该值。BeautifulSoup 或正则表达式，请帮忙。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:55:32.663

您可以使用正则表达式来解析，`href`但我懒得写。请参阅`href_parse`下面的检索 URI 后解析查询字符串的正确方法：

```
from urlparse import urlparse
from urlparse import parse_qs

def href_parse(value):
    if (value.startswith('javascript: OpenWindow(&#39;') and 
        value.endswith('&#39;)'):
        begin_length = len('javascript: OpenWindow(&#39;')
        end_length = len('&#39;)')
        file_location = value[begin_length:-end_length]

        query_string = urlparse(file_location).query
        query_dict = parse_qs(query_string)
        return query_dict.get('fileId', None)

href_data = [[href_parse(td.find('a', attrs={'class': 'blue'})['href']) 
              for td in tr.findAll("td")] 
              for tr in rows]
print href_data 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:04:23.090

这个怎么样

```
import re
urlRE = re.compile('javascript: OpenWindow\(\&#39;(.*)#39;\)')
...
urlMat = urlRE.match(value)
if urlMat:
   url = urlMat.groups()[0] 
```

# java - 在Java中将常量字符串附加到变量字符串的最有效方法？

> ID：10402542
> 
> 赞同：0
> 
> 时间：2012-05-01T18:46:24.647
> 
> 标签：java, string, loops, concatenation

目前在我的代码中，我在 for 循环中有一些类似于：

```
bstr = bstr + x.charAt(i) + x.charAt(i>>4) + x.charAt(i>>8); 
```

其中 i 是一个整数和循环变量，x 是一个静态的最终常量字符串。bstr 可以是 KB 的顺序。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T18:49:45.807

执行此操作的一种有效方法是使用 StringBuilder 连接您的字符串：

```
StringBuilder builder = new StringBuilder();
for(int i = 0; i < count; i++){
    builder.append(x.charAt(i));
    builder.append(x.charAt(i>>4));
    builder.append(x.charAt(i>>8));
}

return builder.toString(); 
```

这种技术避免了在 for 循环的连接之间存储所有字符串副本的问题。

**编辑：**

或者这对你有用吗（一次不添加一个字符）：

```
StringBuilder builder = new StringBuilder();
for(int i = 0; i < count; i++){
    builder.append(x);
}

return builder.toString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:49:56.457

在循环之前创建一个`StringBuilder`并重用它：

```
StringBuilder sb = new StringBuilder();

while (someCondition) {
    ...
    sb.append(x.charAt(i))
      .append(x.charAt(i >> 4))
      .append(x.charAt(i >> 8));
    ...
}

bstr = sb.toString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T18:52:13.333

使用 StringBuilder 并在循环时追加。

```
StringBuilder sb = new StringBuilder();
sb.append(bstr);
for(int i=0; i < somecondition; i++){
  sb.append(x.charAt(i)).append(x.charAt(i>>4)).append(x.charAt(i>>8));  
}
System.out.println(sb.toString()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T18:52:58.537

一种选择是使用`StringBuilder`类。它有一个内部 char 数组，它会将您的内容附加到该数组中，直到您调用该`toString`方法，此时它会创建一个新`String`对象。当然，由于它使用一个数组来存储你的字符，它可能会用完空间，此时它会将内容复制到一个新的更大的数组中。您可以通过最初为其提供足够大以容纳最终字符串的容量来避免这种情况。

```
// Create a new StringBuilder with an initial capacity that is a little larger than the final String
StringBuilder builder = new StringBuilder(estimatedSizeOfFinalString);
int i = 0;
while (loopConditionIsTrue) {
    builder.append(x.charAt(i)).append(x.charAt(i >> 4)).append(x.charAt(i >> 8);
}
String bstr = builder.toString(); 
```

# asp.net - 如何克服这个 NeatUpload 对象引用错误？

> ID：10402552
> 
> 赞同：0
> 
> 时间：2012-05-01T18:46:50.010
> 
> 标签：asp.net, file-upload, neatupload

安装 NeatUpload ( [http://neatupload.codeplex.com/](http://neatupload.codeplex.com/) )，并将演示放到我的服务器（Windows Server 2008 和 IIS7）上，当我在组合框中为“进度条位置”选择一个对象并更改它时到“内联”，我得到一个未处理的异常，`Object reference not set to an instance of an object.`. 我可以毫无问题地将其更改为“无”和“弹出”。

这是我的安装指南：[如何安装 NeatUpload？](https://stackoverflow.com/questions/10391657/how-to-install-neatupload/10400485#10400485)

这是堆栈跟踪：

```
[NullReferenceException: Object reference not set to an instance of an object.]
   Brettle.Web.NeatUpload.UploadModule.get_PostBackID() +18
   Brettle.Web.NeatUpload.ProgressBar.get_LastPostBackIDQueryStringPortion() +9
   Brettle.Web.NeatUpload.ProgressBar.OnPreRender(EventArgs e) +687
   System.Web.UI.Control.PreRenderRecursiveInternal() +107
   System.Web.UI.Control.PreRenderRecursiveInternal() +223
   System.Web.UI.Control.PreRenderRecursiveInternal() +223
   System.Web.UI.Control.PreRenderRecursiveInternal() +223
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3393 
```

什么不见​​了？我可以查看“NeatUpload Console”，可以选择要上传的文件，可以毫无问题地更改“提交按钮类型”。另外，我从来没有得到任何进度条。我唯一能想到的是我的 Web 应用程序在 .net 2 中运行，而不是在 .net 4 中运行 - 如果这是问题所在，我如何在不为 Web 应用程序更改它的情况下为控件修复它（sharepoint 2010） ? 我可以有一些文件不合适吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T19:34:15.367

我得到了与问题海报相同的错误，但我的解决方法是将 AppPool 从集成管道切换到经典管道。我正在使用 IIS7。

我还认为您可以添加：

```
<add name="UploadHttpModule" type="Brettle.Web.NeatUpload.UploadHttpModule, Brettle.Web.NeatUpload" preCondition="managedHandler"/> 
```

到`configuration/system.webServer/modules`您的 Web.config 的一部分，以允许它在集成管道模式下工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T03:52:14.913

嗬！新手问题。需要在 web.config 中进行的任何添加都需要添加到 web 应用程序根目录下的 web.config - 将任何 web.config 文件放在子文件夹中是不行的。web.config 文件只能放在 web 应用程序的根目录中。如果我们在 iis 中添加一个 web-application 在另一个 web-application 的树中，那么我们可以添加另一个 web.config。但是将 web.config 放在子文件夹中并不会使该目录成为 Web 应用程序。......学习艰难的方式......

# sharepoint - 确定每个站点正在使用多少空间 - Windows Sharepoint 服务

> ID：10402553
> 
> 赞同：0
> 
> 时间：2012-05-01T18:46:57.957
> 
> 标签：sharepoint, sharepoint-2007, wss

我们的 WSS 内容数据库正在失控。我希望能够进行一些报告，以显示哪些网站使用的空间最多，以及哪些文档或文档库使用的存储空间最多。这些类型的功能似乎没有内置到 Windows Sharepoint Services 中，因此我需要一个工具或某种方法来查询此信息。

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T04:32:17.473

有多种获取信息的方法，最简单的一种可能是通过此工具： **SharePoint Space Monitor**

（我的链接现在已经死了，但你仍然可以在网上找到该软件）

# redis - 在 Redis 中，所有哈希键都存储在同一个“表”中吗？如果是这样，它如何影响性能？

> ID：10402554
> 
> 赞同：7
> 
> 时间：2012-05-01T18:47:01.993
> 
> 标签：redis

查看此示例[http://redis.io/topics/twitter-clone](http://redis.io/topics/twitter-clone)，其中用户记录使用哈希键（“uid:1000”）存储，“推文”通过哈希键（“post:60”）存储，这是否意味着所有这些记录都存储在相同的数据结构中，并且添加推文会影响检索用户记录的时间？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-01T20:27:08.303

是的，用户和推文存储在相同的数据结构中。该数据结构是一个[哈希表](http://en.wikipedia.org/wiki/Hash_table)。

在内部，Redis 没有记录类型的概念。就 Redis 而言，`User:1000`它`Post:60`只是一个字节序列。所以是的，Redis 确实将所有记录存储在相同的数据结构中。

因为 Redis 不区分推文和用户，所以这两种记录的响应时间将是相似的。

所以，一切都归结为一个问题——“Redis 的性能是否与记录数量成正比？”

答案是肯定的，确实如此。只要你有足够的内存来保存所有数据，Redis 的性能不应该取决于记录的数量。

# jakarta-ee - 保留会话

> ID：10402556
> 
> 赞同：1
> 
> 时间：2012-05-01T18:47:11.617
> 
> 标签：jakarta-ee, stateful-session-bean

我必须使用 Java EE 开发一个应用程序，该应用程序将包含用户和一些特定于该用户的数据，这些数据保留在数据库中。我现在正在学习使用 Java 进行 Web 开发，所以我想问一下将登录的用户 id 保存在有状态会话 bean 中是否正确，然后将这个有状态的 bin 注入一个无状态的 bin 中，其中将包含更新和检索这些数据的方法基于从有状态bean中获取的id？

# java - 从android中的第一个视图获取持续时间

> ID：10402557
> 
> 赞同：1
> 
> 时间：2012-05-01T18:47:21.403
> 
> 标签：java, android, timer, sharedpreferences

我一直在尝试设置一个功能，该功能正在获取自窗口出现给查看器以来的时间。

我一直在使用处理程序、计时器、currenttimemillis。

我已经成功地做到了。窗口显示自窗口显示给用户以来的持续时间 - 更新频率为 40fps，我喜欢它的外观和工作方式..

但！

当向后和向前进入窗口时，时间重新开始。我希望窗口显示自用户初始视图以来的（运行）时间，即使程序停止，我也不希望时间“中断”。

我正在使用 sharedpreferences 来保存字符串，并且我试图保存初始 System.currentTimeMillis(); 作为共享首选项（作为长）并使用此 if 语句在 oncreate 上再次加载它

* * *

```
SharedPreferences sData14;
private final int REFRESH_RATE = 25;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.orderwaiting); 
    setupVariables(); 
    sData14 = getSharedPreferences(filename, 0);

}

private void setupVariables() { 
    mHandler.removeCallbacks(startTimer);
    mHandler.postDelayed(startTimer, 0);

       if (sData14 == null) {
              starttime = System.currentTimeMillis();

             sData14 = getSharedPreferences(filename, 0); 
             SharedPreferences.Editor editor = sData14.edit();      
             editor.putLong("sharedString14", starttime);                       
             editor.commit();
           };

          if (sData14 != null) {
              Long value_long = sData14.getLong("sharedString14", 1000000);
              starttime = value_long;       
              }; 
```

* * *

编辑添加

我不使用 onresume 和 onpause。我必须这样做吗？

我希望 if 语句处理“案例”.. 我需要一个函数来处理程序已“关闭”的情况，但仍然需要该函数来跟踪我们及时达到的程度。

doinbackground 是否更好，并且也可以从另一个地方调用它？

* * *

它只是不加载共享数据...

换句话说，我需要从用户第一次查看此窗口时开始使用的动态数字。也许我还有其他方法可以做到这一点？？

我想它应该“以这种方式”工作..但我似乎无法让它工作..

我希望我以一种简单的方式解决了我的问题。

* * *

解决方案

```
long startTime;
private final int REFRESH_RATE = 25;

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.orderwaiting); 
setupVariables();     

}

private void setupVariables() { 

   SharedPreferences sData14 = getSharedPreferences(filename, 0);
   startTime = sData14.getLong("sharedString14", -1);
   **starttime = startTime;**

   if(startTime == -1){
       //startTime not previously saved
       starttime = System.currentTimeMillis();           

       SharedPreferences.Editor editor = sData14.edit();      
       editor.putLong("sharedString14", starttime);                       
       editor.commit();
   }

    mHandler.removeCallbacks(startTimer);
    mHandler.postDelayed(startTimer, 0); 
```

* * *

我添加了开始时间 = 开始时间，因为它不会在第二个视图上加载任何开始时间。感谢大卫。你拯救了我的一天:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T07:07:03.913

啊好吧，我误解了你最初的问题。您检查偏好的方式不太正确，您也可以稍微简化一下。下面的代码应该可以解决您的问题：

```
long startTime;
private final int REFRESH_RATE = 25;

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.orderwaiting); 
setupVariables();     

}

private void setupVariables() { 

   SharedPreferences sData14 = getSharedPreferences(filename, 0);
   startTime = sData14.getLong("sharedString14", -1);

   if(startTime == -1){
       //startTime not previously saved
       starttime = System.currentTimeMillis();           

       SharedPreferences.Editor editor = sData14.edit();      
       editor.putLong("sharedString14", starttime);                       
       editor.commit();
   }

    mHandler.removeCallbacks(startTimer);
    mHandler.postDelayed(startTimer, 0);
} 
```

# knockout.js - 如何组合来自不同 HTML 文件的模板

> ID：10402558
> 
> 赞同：8
> 
> 时间：2012-05-01T18:47:22.900
> 
> 标签：knockout.js

由于 Knockout 的各个模板都保存在脚本标签中，我认为我可以设置`src`标签的属性并从单独的文件中加载 HTML。天真地这样做根本行不通，所以要么

1.  有一些技巧可以让模板的绑定与`src`我需要使用的标签一起使用
2.  从不同的文件加载模板有不同的方法

（另外两种可能——3，这个项目的所有程序员都应该修改同一个巨大的文件，该文件将在启动时由浏览器加载，4，不要将 Knockoutjs 用于比玩具更大的东西项目——我认为是等价的。）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T19:14:12.247

浏览器不会响应`src`任何类型不是各种“javascript”类型之一的类型，并且它会尝试将结果作为脚本执行。

虽然有几个选择：

*   使用可以远程拉取模板的模板引擎（最好的在这里：[https](https://github.com/ifandelse/Knockout.js-External-Template-Engine) ://github.com/ifandelse/Knockout.js-External-Template-Engine ）。
*   在包含模板的脚本标签上循环并加载它们。像这样的东西会使用`src`作为位置的内容。如果您的模板尚未准备好，您在调用 applyBindings 时需要小心。

    ```
    $("script[type='text/html']").each(function(index, el) { $.get($(el).attr("src"),
        function(response) {
            $(el).text(response); });
    }); 
    ```

*   以下是我不久前考虑过的一些其他选项：[http ://www.knockmeout.net/2011/03/using-external-jquery-template-files.html](http://www.knockmeout.net/2011/03/using-external-jquery-template-files.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-15T22:05:30.557

我项目中的每个模板都是它自己的 html 文件。我使用命名约定 (*.ko.html) 来识别它们。我的构建链是这样的：

**第 1 步：Lint 和缩小 *.ko.html 文件** 这只是为了删除注释（除了注释`<!-- ko -->`）并去除额外的空白以获得更紧凑的有效负载。

**第 2 步：将压缩后的 html 字符串化并连接到 js 文件中。** js看起来像

```
var templates={
  'name1':'some stringified html',
  'name2':'some more'
}; 
```

我确实考虑过用分隔符连接成一个 html 文件，`<script type="text/plain">`但选择了 js，因为这样可以使用简单的`<script>`标签而不是 ajax get + injection 来加载它。

**第 3 步：修复原生模板引擎以从我的 js 对象中检索模板。**

```
var engine = new ko.nativeTemplateEngine();
engine._makeTemplateSource = engine.makeTemplateSource;

engine.makeTemplateSource = function (template, doc) {        
    if (typeof (template) === 'string' && templates[template]) {
        return { text: function () { return templates[template]; } };
    }
    return engine._makeTemplateSource(template, doc);
};
ko.setTemplateEngine(engine); 
```

我的实现使用 gruntjs 来执行这些构建步骤。(grunt-contrib-htmlmin, grunt-contrib-concat)

htmlmin 的选项：

```
{
removeComments: true, 
collapseWhitespace: true, 
ignoreCustomComments: [/^\s*ko /, /^\s*\/ko /] 
} 
```

连接选项

```
{
  stripBanners: true,
  banner: "(function(t){",
  footer: "})(window.templates || (window.templates={}));",
  process: function (src, file) {
      return 't[\'' + file.replace(/^.*\//, '').replace('.ko.html', '') + '\']=' + JSON.stringify(src) + ';';
  }
} 
```

对于任何想知道为什么有人想要这样做的人：模板源文件是标准的单个 html 文件，可以在任何 html 编辑器中进行编辑，并且可以对其进行源代码控制。在标签内编辑 html`<script>`并不好玩。作为奖励，源文件可以包含将被删除的注释。通过包含脚本标签，模板可以在任何页面上重复使用：它们不需要内联到每个页面中。生成的包是浏览器可以轻松缓存的静态文件，而嵌入到动态生成的页面中的模板则不能。捆绑javascript文件的原因几乎相同。

# ruby-on-rails - 开发中的rails应用程序没有出现在heroku上

> ID：10402559
> 
> 赞同：1
> 
> 时间：2012-05-01T18:47:23.267
> 
> 标签：ruby-on-rails, git, heroku

我正在开发一个 Rails 应用程序。在此处遵循本教程：

[教程](http://ruby.railstutorial.org/chapters/filling-in-the-layout#code:footer_css)

我完成了一个部分，想将所有更改推送到 heroku 并在那里查看它们。我可以在本地计算机上查看该站点。在heroku上，我看到的是：

![在此处输入图像描述](../Images/db05fa05b113c80787220ada67fed210.png)

进行更改后，我输入了以下命令，看到该站点在我的本地计算机上运行。

```
$ git add .
$ git commit -m "Finish layout and routes"
$ git checkout master
$ git push
$ git push heroku
$ heroku open 
```

我什至查看了 heroku 日志，但无法理解出了什么问题！我的数据库中没有内容，它是空的。我只有视图设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:18:54.837

如果你删除了 public/index.html 文件，你也必须这样做`git rm public/index.html`，然后提交并推送到 Heroku。如果您在本地删除文件，git 不会在不执行 的情况下处理该文件`git rm`，并且 Heroku 对您的应用程序的了解是 100% 通过 Git。

当我有一个在 Heroku 上存储上传文件的应用程序时，我遇到了一个类似奇怪（但不相关）的问题。每次我推一下，它们都会消失。这让我非常困惑，直到我意识到 Heroku 基本上每次你进行推送时都会擦除，并且任何不在 git 中的东西都不会被保留。使用 S3 或类似软件进行上传文件存储的一个很好的理由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:50:27.497

为什么要结帐给大师？你在另一个分支工作吗？

如果是这种情况，您需要在推送代码之前将您的更改合并到 master （假设您在 master 上，这在结帐后已经是这种情况）：

```
git merge other-branch 
```

也不要忘记在 heroku 上迁移你的数据库。

```
heroku rake db:migrate 
```

**编辑**

要找出您当前的分支，请键入：

```
git branch 
```

它将用“*”标记当前分支。

# android - 播放视频的意图总是播放相同的视频

> ID：10402560
> 
> 赞同：0
> 
> 时间：2012-05-01T18:47:34.773
> 
> 标签：android

我正在创建一个播放存储在 sdcard 中的视频的意图。碰巧我玩了第一个，一切正常。但是当我玩另一个时，它只会在我玩的第一个时播放。这是我的代码：

```
 package com.remote;

import java.io.File;
import java.io.IOException;

import com.remote.R.drawable;

import android.app.Activity;
import android.content.Intent;
import android.graphics.PixelFormat;
import android.media.MediaPlayer;
import android.net.Uri;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.LinearLayout;
import android.widget.MediaController;
import android.widget.VideoView;

    public class MyVideos extends Activity{

private String path="/sdcard/Movies/Telmex";

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.myvideos);

    createLinks(new File(path));

}

public void createLinks(File path) 
{ 
    LinearLayout layout = (LinearLayout) findViewById(R.id.myvideoslayout);
    if( path.exists() ) {
        File[] files = path.listFiles();
        for(int i=0; i<files.length; i++) 
        {
          if(files[i].getName().toString().charAt(0)!='.')
          {
           String videoName;
           Button video=new Button(this);
           video.setBackgroundColor(2);
           video.setTextSize(23);
           video.setCompoundDrawablesWithIntrinsicBounds(0,0,drawable.videoicon,0);
           videoName=new String(files[i].getName());
           video.setText(videoName);
           createListener(video,videoName);
           LinearLayout.LayoutParams p = new LinearLayout.LayoutParams(
                   LinearLayout.LayoutParams.MATCH_PARENT,
                   LinearLayout.LayoutParams.WRAP_CONTENT
           );   
           layout.addView(video,p); 
          }

        }
    }
}

public void createListener(Button video, final String name)
{
    video.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            videoPlayer(path,name,true);
        }
    }); 
}

public void videoPlayer(String path, String fileName, boolean autoplay)
{
    Intent intent = new Intent(android.content.Intent.ACTION_VIEW);
    Uri data = Uri.parse(path+"/"+fileName);
    intent.setDataAndType(data, "video/mp4");
    startActivity(intent);

 }

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:12:03.883

**改写**

我做了一些挖掘并编写了下面的代码，如果这有同样的问题，那么它是你的外部视频播放器而不是你的应用程序。

```
public class ExampleActivity extends Activity {
    // Change this path
    private final String path = Environment.getExternalStorageDirectory() + "/android/data/com.example/files/";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        File dir = new File(path);
        List<String> files = new ArrayList<String>();
        Collections.addAll(files, dir.list());
        Collections.sort(files);

        while(files.get(0).startsWith("."))
            files.remove(0);

        ListView listView = (ListView) findViewById(R.id.list);
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, files);
        listView.setAdapter(adapter);

        listView.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                String uri = path + ((TextView) view).getText().toString();
                Intent intent = new Intent(Intent.ACTION_VIEW);
                intent.setDataAndType(Uri.parse(uri), "video/*");
                startActivity(intent);
            }
        });
    }
} 
```

**添加**

我很高兴内部视频播放器可以正常工作。它重置的原因是每次您更改方向时，操作系统都会从头开始破坏并重建您的应用程序......这就像您通过按下后退按钮退出应用程序并再次运行它一样。如果您使用下面的教程，您需要将视频的位置保存`onDestroy()`到一个类变量中，并`onCreate()`检查该变量是否具有有效的位置，或者只是从视频的开头开始。

# c# - 启动另一个应用程序但不是新进程

> ID：10402562
> 
> 赞同：-2
> 
> 时间：2012-05-01T18:47:46.330
> 
> 标签：c#, .net, wpf

所以我发现

```
System.Diagnostics.Process.Start() 
```

但是，然后我想关闭启动它的应用程序（我需要启动器连接到服务器，启动游戏并自行关闭）所以它不起作用。我的应用程序：

```
public partial class MainWindow : Window
{
    Process.Start("xnagame.exe", "12345678");
    this.Close();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:28:31.373

命名进程，以便您有一个句柄来关闭它。并非所有进程都能正常关闭。

```
 try
     {
        Process myProcess;
        myProcess = Process.Start("Notepad.exe");
        // Display physical memory usage 5 times at intervals of 2 seconds.
        for (int i = 0;i < 5; i++)
        {
           if (!myProcess.HasExited)
           {
               // Discard cached information about the process.
               myProcess.Refresh();
               // Print working set to console.
               Console.WriteLine("Physical Memory Usage: " 
                                    + myProcess.WorkingSet.ToString());
               // Wait 2 seconds.
               Thread.Sleep(2000);
           }
           else {
               break;
           } 
        }

        // Close process by sending a close message to its main window.
        myProcess.CloseMainWindow();
        // Free resources associated with process.
        myProcess.Close();

     }
     catch(Exception e)
     {
        Console.WriteLine("The following exception was raised: ");
        Console.WriteLine(e.Message);
     } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:24:54.633

使用`Process.Start(ProcessStartInfo)`重载，并将`UseShellExecute`属性设置为`true`。

# sql - 通过软删除保持逻辑一致性，同时保留原始信息

> ID：10402565
> 
> 赞同：3
> 
> 时间：2012-05-01T18:47:57.190
> 
> 标签：sql, database-design, soft-delete

我有一个非常简单的表`students`，结构如下，主键在哪里`id`。该表是大约 20 个数百万行的表的替身，这些表经常连接在一起。

```
+----+----------+------------+
| 编号 | 姓名 | 出生日期 |
+----+----------+------------+
| 1 | 爱丽丝 | 1989 年 1 月 12 日 |
| 2 | 鲍勃 | 1990 年 4 月 6 日 |
| 3 | 卡斯伯特 | 1988 年 1 月 23 日 |
+----+----------+------------+

```

如果 Bob 想更改他的出生日期，那么我有几个选择：

1.  更新`students`新的出生日期。

    *积极因素：* 1 DML 操作；该表始终可以通过单个主键查找来访问。

    *负面因素：*我失去了 Bob 曾认为他出生于 1990 年 4 月 6 日这一事实

2.  在表中添加一列 ,`created date default sysdate`并将主键更改为`id, created`。每一个都`update`变成：

    ```
    insert into students(id, name, dob) values (:id, :name, :new_dob) 
    ```

    然后，每当我想要最新信息时，请执行以下操作（Oracle 但问题代表每个 RDBMS）：

    ```
    select id, name, dob
      from ( select a.*, rank() over ( partition by id 
                                           order by created desc ) as "rank"
               from students a )
     where "rank" = 1 
    ```

    *优点：*我从不丢失任何信息。

    *负面因素：*对整个数据库的所有查询都需要更长的时间。如果表格是指示的大小，这无关紧要，但是一旦您在第 5 次`left outer join`使用范围扫描而不是唯一扫描，就会开始产生影响。

3.  添加一个不同的专栏，`deleted date default to_date('2100/01/01','yyyy/mm/dd')`或任何我喜欢的过早或未来主义的日期。将主键更改为`id, deleted`然后每个`update`变为：

    ```
    update students x
       set deleted = sysdate 
     where id = :id
       and deleted = ( select max(deleted) from students where id = x.id );
    insert into students(id, name, dob) values ( :id, :name, :new_dob ); 
    ```

    获取当前信息的查询变为：

    ```
    select id, name, dob
      from ( select a.*, rank() over ( partition by id 
                                           order by deleted desc ) as "rank"
               from students a )
     where "rank" = 1 
    ```

    *优点：*我从不丢失任何信息。

    *否定：*两个 DML 操作；我仍然必须使用额外成本的排名查询或范围扫描，而不是每个查询中的唯一索引扫描。

4.  创建第二个表，说`student_archive`并将每个更新更改为：

    ```
    insert into student_archive select * from students where id = :id;
    update students set dob = :newdob where id = :id; 
    ```

    *优点：*永远不要丢失任何信息。

    *否定：* 2个DML操作；如果您想获得您必须使用的所有信息`union`或额外的`left outer join`.

5.  为了完整起见，有一个可怕的去规范化的数据结构：`id, name1, dob, name2, dob2...`等等。

如果我不想丢失任何信息并总是进行软删除，那么第 1 号不是一个选项。5 号可以安全地丢弃，因为它造成的麻烦多于它的价值。

我只剩下选项 2、3 和 4 以及随之而来的负面影响。我通常最终使用选项 2 和可怕的 150 行（间隔很好）多个子选择连接。

* * *

**tl;博士**我意识到我在这里的“非建设性”投票中滑到了接近线的位置，但是：

*在不*删除任何数据的同时保持逻辑一致性的*最佳（单一！）方法是什么？*

 *有没有比我记录的更有效的方法？在这种情况下，我将高效定义为“更少的 DML 操作”和/或“能够删除子查询”。如果您在（如果）回答时能想到更好的定义，请随意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:10:59.860

我会坚持 #4 并进行一些修改。无需从原始表中删除数据；在更新（或删除）原始记录之前将旧值复制到存档表就足够了。这可以通过行级触发器轻松完成。在我看来，检索所有信息并不是一项频繁的操作，而且我认为额外的 join/union 没有任何问题。此外，您可以定义一个视图，因此从最终用户的角度来看，所有查询都将是直接的。*

# javascript - jQuery $(' ') 与 $(' ')

> ID：10402567
> 
> 赞同：18
> 
> 时间：2012-05-01T18:48:03.790
> 
> 标签：javascript, jquery

> **可能重复：**
> [jQuery 中的 $('<element>') 与 $('<element />')](https://stackoverflow.com/questions/9675487/element-vs-element-in-jquery)

这两种方法中的哪一种是正确的方法：

```
$('<div>') 
```

或者

```
$('<div />') 
```

它们似乎都有效。一种方式比另一种方式更正确，还是它们都总是有效？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-01T18:49:24.183

它们在 jQuery 中产生相同的结果。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-01T18:54:31.213

**从[文档](http://api.jquery.com/jQuery/)：**

> 如果一个字符串作为参数传递给 $()，jQuery 会检查该字符串以查看它是否看起来像 HTML（即，它`<tag ... >`在字符串中的某个位置）。如果不是，则字符串被解释为选择器表达式，如上所述。但是如果字符串看起来是一个 HTML 片段，jQuery 会尝试按照 HTML 的描述创建新的 DOM 元素。然后创建并返回一个引用这些元素的 jQuery 对象。你可以在这个对象上执行任何常用的 jQuery 方法：

```
$('<p id="test">My <em>new</em> text</p>').appendTo('body'); 
```

> 如果 HTML 比没有属性的单个标记更复杂，如上例所示，则元素的实际创建由浏览器的 innerHTML 机制处理。在大多数情况下，jQuery 会创建一个新元素并将该元素的 innerHTML 属性设置为传入的 HTML 片段。当参数具有单个标记时，例如`$('<img />') or $('<a></a>')`，jQuery 使用原生 JavaScript createElement() 函数创建元素。

**为确保跨平台兼容性，代码段必须格式正确。可以包含其他元素的标签应与结束标签配对**：

```
$('<a href="http://jquery.com"></a>'); 
```

或者，jQuery 允许类似 XML 的标记语法（斜杠前有或没有空格）：

```
$('<a/>'); 
```

不能包含元素的标签可能会被快速关闭：

```
$('<img />');
$('<input>'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:22:33.177

尽管它们似乎产生相同的结果，但根据用途，它们可能不会产生相同的结果。例如：

在 jQuery parse`$('<div> <p>')`时，`<p>`标签将是标签的子**标签**`<div>`，因此结果将是：`<div> <p></p> </div>`

而当 jQuery parse`$('<div/> <p/>')`时，`<p/>`标签将是标签的兄弟**，**`<div/>`所以结果将是：`<div></div> <p></p>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T18:56:18.743

两种变体都给你相同的结果，但这

```
$('<div />', {id:"myID",class:"mycssClass class2 clazzz",some-attribute: "value"}); 
```

更好，更具可读性

```
$('<div id="myId" class="mycssClass class2 clazzz" some-attribute="value"></div>'); 
```

# c# - ASP.net MVC 4 WebApi - 测试 MIME 多部分内容

> ID：10402568
> 
> 赞同：4
> 
> 时间：2012-05-01T18:48:05.427
> 
> 标签：c#, asp.net-mvc, asp.net-web-api

我有一个看起来像这样的 ASP.net MVC 4 (beta) WebApi：

```
 public void Post()
    {
        if (!Request.Content.IsMimeMultipartContent("form-data"))
        {
            throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
        }

        IEnumerable<HttpContent> parts = Request.Content.ReadAsMultipartAsync().Result;

        // Rest of code here.
    } 
```

我正在尝试对这段代码进行单元测试，但不知道该怎么做。我在正确的轨道上吗？

```
 [TestMethod]
    public void Post_Test()
    {
        MultipartFormDataContent content = new MultipartFormDataContent();
        content.Add(new StringContent("bar"), "foo");

        this.controller.Request = new HttpRequestMessage();
        this.controller.Request.Content = content;
        this.controller.Post();
    } 
```

此代码引发以下异常：

> System.AggregateException：发生一个或多个错误。---> System.IO.IOException：MIME 多部分流意外结束。MIME 多部分消息不完整。在 System.Net.Http.MimeMultipartBodyPartParser.d__0.MoveNext() 在 System.Net.Http.HttpContentMultipartExtensions.MoveNextPart(MultipartAsyncContext 上下文) 在 System.Net.Http.HttpContentMultipartExtensions.MultipartReadAsyncComplete(IAsyncResult 结果) 在 System.Net.Http.HttpContentMultipartExtensions .OnMultipartReadAsyncComplete(IAsyncResult 结果)

知道最好的方法是什么吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-01-15T10:07:57.567

尽管这个问题是不久前发布的，但我只需要处理同样的问题。

这是我的解决方案：

创建 HttpControllerContext 类的假实现，在其中将 MultipartFormDataContent 添加到 HttpRequestMessage。

```
public class FakeControllerContextWithMultiPartContentFactory
{
    public static HttpControllerContext Create()
    {
        var request = new HttpRequestMessage(HttpMethod.Post, "");
        var content = new MultipartFormDataContent();

        var fileContent = new ByteArrayContent(new Byte[100]);
        fileContent.Headers.ContentDisposition = new ContentDispositionHeaderValue("attachment")
        {
            FileName = "Foo.txt"
        };
        content.Add(fileContent);
        request.Content = content;

        return new HttpControllerContext(new HttpConfiguration(), new HttpRouteData(new HttpRoute("")), request);
    }

} 
```

然后在你的测试中：

```
 [TestMethod]
    public void Should_return_OK_when_valid_file_posted()
    {
        //Arrange
        var sut = new yourController();

        sut.ControllerContext = FakeControllerContextWithMultiPartContentFactory.Create();

        //Act
        var result = sut.Post();

        //Arrange
        Assert.IsType<OkResult>(result.Result);
    } 
```

# objective-c - 实现 copyWithZone 的 GKSession 对象的副本

> ID：10402572
> 
> 赞同：0
> 
> 时间：2012-05-01T18:48:31.880
> 
> 标签：objective-c, memory-management, copywithzone

我想制作一个 GKSession 对象的副本，并按如下方式实现 copyWithZone：

```
-(id)copyWithZone:(NSZone *)zone {

GKSession *kati = [[GKSession allocWithZone: zone] init];
kati=_currentSession;    
return kati;} 
```

尽管如此，我并没有获取初始对象的副本，而是对其进行引用。

我错过了什么……；

copyWithZone 的实现是复制 GKSession 对象的方法，或者不是？

提前致谢...！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:16:00.740

让我们看看你的代码在做什么：

```
GKSession *kati = [[GKSession allocWithZone: zone] init]; 
```

您分配一个新`GKSession`对象，并更新`kati`变量以指向该对象。

```
kati=_currentSession; 
```

您将`kati`变量更改为指向另一个对象。这意味着你刚刚分配的对象被泄露了；您不再有指向它的指针，但它从未被释放。

```
return kati; 
```

您返回`kati`变量的值，它是指向`_currentSession`对象的指针。

这显然不是你想要的。您想创建一个`GKSession`与 具有相同基础信息的新对象`_currentSession`，对吗？在这种情况下，我将从：

```
- (id)copyWithZone:(NSZone *)zone {
  NSString *sessionID = [_currentSession sessionID];
  NSString *name = [_currentSession displayName];
  GKSessionMode sessionMode = [_currentSession sessionMode];
  GKSession *kati = [[GKSession alloc] initWithSessionID:sessionID displayName:name sessionMode:mode]; 
  return kati;
} 
```

# ruby-on-rails-3 - 在 Heroku 上使用带有“s3”的回形针接收 S3::Error::SignatureDoesNotMatch

> ID：10402573
> 
> 赞同：0
> 
> 时间：2012-05-01T18:48:31.840
> 
> 标签：ruby-on-rails-3, heroku, paperclip

我正在使用 Paperclip 和 AWS，并且可以成功地让上传在我的本地主机上工作。我遇到的问题是当我将应用程序上传到 Heroku 时，我得到：

```
AWS::S3::Errors::SignatureDoesNotMatch (The request signature we calculated does not match the signature you provided. Ch 
```

检查您的密钥和签名方法。）

地点.rb

```
has_attached_file :photo,
                :styles => { :thumb => "150x150#", :medium => "200x200#", :small => "50x50"},
                :path => ":attachment/:id/:style.:extension",
                :s3_domain_url => "adsimgstore.s3.amazonaws.com",
                :storage => :s3,
                :s3_credentials => S3_CREDENTIALS,
                :bucket => 'adsimgstore',
                :s3_permissions => :public_read,
                :convert_options => { :all => "-auto-orient" } 
```

s3 初始化

```
# initializers/s3.rb
if Rails.env == "production"
 # set credentials from ENV hash
 S3_CREDENTIALS = { :access_key_id => ENV['S3_KEY'], :secret_access_key => ENV['S3_SECRET'],   :bucket => "adsimgstore"}
else
  # get credentials from YML file
  S3_CREDENTIALS = Rails.root.join("config/s3.yml")
end 
```

我遵循 Heroku 教程[https://devcenter.heroku.com/articles/s3](https://devcenter.heroku.com/articles/s3)并添加了所有键

有什么建议么？

```
 AWS::S3::Errors::SignatureDoesNotMatch (The request signature we calculated does not match the     signature you provided. Ch
eck your key and signing method.):
2012-05-01T18:01:02+00:00 app[web.1]: 
2012-05-01T18:01:02+00:00 app[web.1]:   app/controllers/locations_controller.rb:76:in `block in     update'
2012-05-01T18:01:02+00:00 app[web.1]:   app/controllers/locations_controller.rb:75:in `update'
2012-05-01T18:01:02+00:00 app[web.1]: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T17:58:14.407

*   检查您的环境变量是否匹配

如果您遵循 heroku 教程，您的环境变量将是`AWS_ACCESS_KEY_ID`and `AWS_SECRET_ACCESS_KEY`。

运行`heroku config`以检查您的环境变量。

*   `:bucket`凭证中没有

您将`:bucket`选项放在文件的`S3_CREDENTIALS`-hash 中`initializers/s3.rb`。bucket-option 不属于这里 - 您已经在`has_attached_file`方法中设置了它。

# oracle - 如何直接链接到 Apex 报告“导出为 CSV”选项？

> ID：10402575
> 
> 赞同：1
> 
> 时间：2012-05-01T18:48:40.440
> 
> 标签：oracle, oracle11g, oracle-apex

我有一份 Apex 报告。我打开了将其导出为 CSV 的选项。当我运行报告时，页面底部有一个链接可以将报告导出为 CSV。我想把这个链接放在另一个网页上。当我将鼠标悬停在链接上以获取 url 时，它最终是这样的：

```
http://server_name/userconsole/f?p=200:5:3692634689183338:FLOW_EXCEL_OUTPUT_R1366308279703792_en-us' 
```

当我将其用作导出选项的链接时，导出的报告为空。每次我通过 Apex 运行报告时，“导出为 CSV”链接的 URL 都会更改。具体来说，就是这部分发生了变化：

> :3692634689183338:

我如何直接链接到导出为 CSV 选项？我正在使用 Apex 4.0.2.00.07。

编辑：

我现在在替换时收到此错误`&SESSION.`：

```
Bad Request 

Your browser sent a request that this server could not understand.

mod_plsql: /userconsole/f HTTP-400 Missing '=' in query string or post form 
```

在网址栏中，session id 没有被替换`&SESSION.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:00:05.733

该段是您的会话 ID。在您的其他页面中替换`&SESSION.`该段：

```
f?p=200:5:&SESSION.:FLOW_EXCEL_OUTPUT_R1366308279703792_en-us' 
```

这在用户指南中有详细记录：http: [//docs.oracle.com/cd/E23903_01/doc/doc.41/e21674/concept_url.htm#HTMDB03017](http://docs.oracle.com/cd/E23903_01/doc/doc.41/e21674/concept_url.htm#HTMDB03017)

# java - 在 JAVA 中读取 JSON 数组

> ID：10402577
> 
> 赞同：2
> 
> 时间：2012-05-01T18:48:43.940
> 
> 标签：java, json, arrays

我有这样的回应：

```
[ { "key": { "kind": "UserRecord", "id": 0, "name": "1" }, "firstName": "1", "lastName": "1", "homeLat": 0.0, "homeLon": 0.0, "workLat": 0.0, "workLon": 0.0, "currentLat": 10.0, "currentLon": 10.82, "timestamp": 1335735046606, "score": 0, "isStarred": false, "distance": 0.0 }, { "key": { "kind": "UserRecord", "id": 0, "name": "32423542324234324" }, "firstName": "Simone", "lastName": "Boscolo Berto", "homeLat": 0.0, "homeLon": 0.0, "workLat": 0.0, "workLon": 0.0, "currentLat": 55.786444, "currentLon": 12.515867, "timestamp": 1335884083696, "score": 0, "isStarred": false, "distance": 0.0 } ] 
```

以及从每个 JSONObject 中获取我的对象的方法

```
private User getUserFromJson(JSONObject jsonUser) 
```

如何在 JSONObjects 列表中进行迭代？我应该使用 JSONArrayobject 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:17:28.793

使用 Gson 或 jackson 可能会很容易

Gson 示例

```
Gson gson = new Gson();
User[] users = gson.fromJson(<json string>, User[].class); 
```

杰克逊的例子

```
ObjectMapper mapper = new ObjectMapper();  
Collection<User> users =  
    mapper.readValue(<json string>, `new TypeReference<Collection<User>>() {}); 
```

**样品**-

```
package com.test;

import com.google.gson.Gson;

public class GSonExample {
    public static void main(String[] args) {
        String json = "{\"name\":\"Duke\",\"address\":\"Menlo Park\",\"dateOfBirth\":\"Feb 1, 2000 12:00:00 AM\"}";

        Gson gson = new Gson();
        User student = gson.fromJson(json, User.class);

        System.out.println("student.getName()        = " + student.getName());
        System.out.println("student.getAddress()     = " + student.getAddress());
        System.out.println("student.getDateOfBirth() = " + student.getDateOfBirth());
    }
}

public class User {
    private String name;
    private String address;
    private String dateOfBirth;
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getAddress() {
        return address;
    }
    public void setAddress(String address) {
        this.address = address;
    }
    public String getDateOfBirth() {
        return dateOfBirth;
    }
    public void setDateOfBirth(String dateOfBirth) {
        this.dateOfBirth = dateOfBirth;
    }
} 
```

**类路径**

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" path="src"/>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-1.6"/>
    <classpathentry kind="lib" path="lib/gson-2.1.jar"/>
    <classpathentry kind="output" path="bin"/>
</classpath> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:59:49.190

像这样的东西：

```
final String incomingJSON ;
final JSONArray objArray = new JSONArray(incomingJSON);
for(int i = 0; i < objArray.length(); i++) {
    final JSONObject obj = objArray.getJSONObject(i);
    final User user = getUserFromJson(obj);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:03:35.410

你在使用 Gson api 吗？这样，您可以从 JsonArray 对象中获取迭代器。

```
Iterator<JsonElement>   iterator()
          Returns an iterator to navigate the elemetns of the array. 
```

# nested-attributes - best_in_place 和模型属性访问（菜鸟？）

> ID：10402579
> 
> 赞同：1
> 
> 时间：2012-05-01T18:48:53.883
> 
> 标签：nested-attributes, ruby-on-rails-3.2, best-in-place

我只学习 Rails 一个月，所以我不确定这里的答案是真的简单还是更复杂。

我有两个模型，我们称它们为“SpecialUser”和“User”。

我的用户模型看起来像这样：

```
class User < ActiveRecord::Base
has_one :special_user
attr_accessible :name, :email, :password, :password_confirmation, :remember_me, :roles, :user_type, :address_1, :address_2, :city, :state, :zip 
```

（＆C。）

我的 SpecialUser 模型看起来像这样：

```
class SpecialUser < ActiveRecord::Base
belongs_to :user 
```

（＆C。）

我们正在使用[https://github.com/bernat/best_in_place](https://github.com/bernat/best_in_place)创建一个表单来编辑 SpecialUser 的信息。以前，我们为 SpecialUser 提供了一个单独的“地址”属性，但最近取消了它以支持指定完整地址（地址_1、地址_2、城市、州、邮编...）并将其放入用户中，以便普通用户可以也有地址。:)

但是，当我尝试这样做时：

```
<% # best_in_place_if can?(:edit, @super_user), @super_user.user, :address_1 %> 
```

我收到此错误：

```
NoMethodError in Project_professionals#show

undefined method `user_path' for #<#<Class:0x0000013457fb90>:0x00000132e1fdd8> 
```

我也尝试用 and 替换`@super_user.user`，`User.find(@super_user.user)`但`User.find(@super_user.user_id)`我得到了完全相同的错误。

当我做

```
<%= @super_user.user.address_1 %> 
```

有用！

在阅读了 best_in_place 的东西后，我仍然无法找到我的答案。:( 不确定这是我们使用的宝石的限制还是我遗漏了一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:53:12.907

best_in_place 应该处理它——没有限制

看看这个能不能解决

> :path: 更新操作将被发送到的 URL。如果未定义，则默认为 :object 路径。

```
<%= best_in_place_if can?(:edit, @super_user), @super_user.user, :address_1, :path => super_user_user_path %> 
```

# jquery - 显示高级表单时隐藏输入字段

> ID：10402584
> 
> 赞同：0
> 
> 时间：2012-05-01T18:49:28.637
> 
> 标签：jquery, forms, input

我有一个包含基本和高级搜索字段的表单。表单使用以下代码在基本和高级之间切换：

```
// toggle
$(function() {
    $(".toggler").click(function(e) {
        e.preventDefault();
        $(this).find("span").toggle();
        $(".togglee").slideToggle();
    });

    //show adv div based on input value data 
    if ($("#Adv input[value!='']").length) {
        $('.toggler').click();
    }
});​ 
```

**我希望在打开高级表单时隐藏一个特定的输入字段（让我们将其命名为位置）。**

我需要在上面的 jQuery 代码中添加什么而不破坏其他文件共享的任何内容。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:52:19.133

在切换器单击事件中，您不能这样做：

```
$("#place").toggle(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:54:43.400

尝试这样的事情：

```
$(".toggler").click(function(e) {
    e.preventDefault();
    $(this).find("span").toggle();
    $(".togglee").slideToggle();
    //hide another item?
    $('#myOtherItem').toggle();

}); 
```

或者可能是这样的：

```
$(".toggler").click(function(e) {
    e.preventDefault();
    $(this).find("span").toggle();
    $(".togglee").slideToggle();
    //hide another item?
    if($(".togglee").is(":visible")){
    //code for when the togglee is shown
    }

}); 
```

# drupal - Drupal：如何显示拒绝访问的菜单项并将其重定向到登录页面

> ID：10402587
> 
> 赞同：1
> 
> 时间：2012-05-01T18:49:49.887
> 
> 标签：drupal, drupal-7, drupal-modules

我正在使用 drupal 7 和 entity_registration 模块（registration-7.x-1.0-alpha5）进行事件注册。

此处仅针对特定角色显示注册链接，即，如果为经过身份验证的用户设置了权限，则注册链接将显示给经过身份验证的用户。

如果我们尝试手动访问例如 node/9/register 的页面，它会显示访问被拒绝。

现在，我使用 LoginToboggan 将拒绝访问页面重定向到用户登录页面。但是，当我手动创建一个名为 Register 且具有路径 node/9/register 的菜单项时，菜单项本身并没有显示。

我想要一种方法来告诉用户登录注册或类似的东西..

我希望你明白我的意思。

这是模块文件代码..我认为格式有问题所以我只粘贴了 hook_menu 和 hook_permission 函数..请访问查看完整代码的链接 www.karyashala.in/code.html

```
 /**

     * Implements hook_menu().

     */

    function registration_menu() {

      $items['registration/%registration'] = array(

        'title callback' => 'registration_page_title',

        'title arguments' => array(1),

        'page callback' => 'registration_view',

        'page arguments' => array(1),

        'access callback' => 'entity_access',

        'access arguments' => array('view', 'registration', 1),

      );

      $items['registration/%registration/view'] = array(

        'title' => 'View',

        'page callback' => 'registration_view',

        'page arguments' => array(1),

        'access callback' => 'entity_access',

        'access arguments' => array('view', 'registration', 1),

        'type' => MENU_DEFAULT_LOCAL_TASK,

      );

      $items['registration/%registration/edit'] = array(

        'title' => 'Edit',

        'page callback' => 'drupal_get_form',

        'page arguments' => array('registration_form', 1),

        'access callback' => 'entity_access',

        'access arguments' => array('update', 'registration', 1),

        'weight' => 10,

        'type' => MENU_LOCAL_TASK,

      );

      $items['registration/%registration/delete'] = array(

        'title' => 'Delete',

        'page callback' => 'drupal_get_form',

        'page arguments' => array('registration_delete_confirm', 1),

        'access callback' => 'entity_access',

        'access arguments' => array('delete', 'registration', 1),

        'type' => MENU_CALLBACK,

      );

      // entity local tasks

      foreach (registration_get_registration_instances() as $instance) {

        $type = $instance['entity_type'];

        if (!in_array($type, array('registration', 'registration_type'))) {

          $items[$type . '/%entity_object/register'] = array(

            'load arguments' => array($type),

            'title' => 'Register',

            'page callback' => 'registration_register_page',

            'page arguments' => array(0, 1),

            'access callback' => 'registration_register_page_access',

            'access arguments' => array(0, 1),

            'type' => MENU_LOCAL_TASK,

          );

          $items[$type . '/%entity_object/registrations'] = array(

            'load arguments' => array($type),

            'title' => 'Manage Registrations',

            'page callback' => 'registration_registrations_page',

            'page arguments' => array(0, 1),

                            'access callback' => 

            'registration_administer_registrations_access',

            'access arguments' => array(0, 1),

            'type' => MENU_LOCAL_TASK,

          );

          $items[$type . '/%entity_object/registrations/list'] = array(

            'load arguments' => array($type),

            'title' => 'Registrations',

            'page callback' => 'registration_registrations_page',

                    'page arguments' => array(0, 1),

            'access callback' => 'registration_administer_registrations_access',

                    'access arguments' => array(0, 1),

                                    'type' => MENU_DEFAULT_LOCAL_TASK,

                  );

          $items[$type . '/%entity_object/registrations/settings'] = array(

            'load arguments' => array($type),

            'title' => 'Settings',

            'page callback' => 'drupal_get_form',

            'page arguments' => array('registration_registrations_settings_form', 0, 
    1),

            'access callback' => 'registration_administer_registrations_access',

            'access arguments' => array(0, 1),

            'weight' => 9,

            'type' => MENU_LOCAL_TASK,

          );

          $items[$type . '/%entity_object/registrations/broadcast'] = array(

            'load arguments' => array($type),

            'title' => 'Email Registrants',

            'page callback' => 'drupal_get_form',

            'page arguments' => array('registration_registrations_broadcast_form', 0, 
    1),

            'access callback' => 'registration_administer_registrations_access',

            'access arguments' => array(0, 1),

            'weight' => 10,

            'type' => MENU_LOCAL_TASK,

          );

        }

      }

      if (module_exists('devel')) {

        $items['registration/%registration/devel'] = array(

          'title' => 'Devel',

          'page callback' => 'devel_load_object',

          'page arguments' => array('node', 1),

          'access arguments' => array('access devel information'),

          'type' => MENU_LOCAL_TASK,

          'file path' => drupal_get_path('module', 'devel'),

          'file' => 'devel.pages.inc',

          'weight' => 100,

        );

        $items['registration/%registration/devel/load'] = array(

          'title' => 'Load',

          'type' => MENU_DEFAULT_LOCAL_TASK,

        );

      }

      return $items;

    }

    /**

     * Implements hook_permission().

    */

    function registration_permission() {

      $permissions = array(

        'administer registration types' => array(

          'title' => t('Administer registration types'),

          'description' => t('Manage registration types, fields, and display 
    settings.'),

          'restrict access' => TRUE,

                ),

        'administer registration' => array(

          'title' => t('Administer registration'),

          'description' => t('View, edit, delete, and manage all registrations, 
    regardless of type.'),

          'restrict access' => TRUE,

                ),

      );

      foreach(registration_get_types() as $type_info) {

        $permissions += registration_permission_list($type_info);

      }

      return $permissions;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T04:51:40.783

```
Add the line after + sign and clear cache after that check it again.
function registration_menu() {
  $items['registration/%registration'] = array(
    'title callback' => 'registration_page_title',
    'title arguments' => array(1),
    'page callback' => 'registration_view',
    'page arguments' => array(1),
    'access callback' => 'entity_access',
    'access arguments' => array('view', 'registration', 1),
+   'type' => MENU_NORMAL_ITEM,
  ); 
```

# validation - HTML 验证器错误和警告

> ID：10402589
> 
> 赞同：1
> 
> 时间：2012-05-01T18:50:04.813
> 
> 标签：validation, error-handling, warnings

[根据http://validator.w3.org/check?verbose=1&uri=http://www.poker006.com/](http://validator.w3.org/check?verbose=1&uri=http://www.poker006.com/)，我的网站上似乎有很多错误，397 个错误，317 个警告。我只是想知道是否知道解决这些错误的东方方法，哪些是必须修复的？

谢谢，

戴夫

# android - Android onClick() 辅助方法调用

> ID：10402593
> 
> 赞同：0
> 
> 时间：2012-05-01T18:50:25.260
> 
> 标签：android

我有一个方法，当用户点击我的创建按钮时调用它，它调用一个方法名称 createEntry();

在此方法中，它会经过多次检查并根据结果返回 toasts 或错误，当它运行正确的结果时，它总是带我回到我的家庭活动，但如果出现错误，我希望它留在当前屏幕上，如何我可以这样做吗？

任何人都可以给我一些帮助吗？

```
public void onClick(View v) {
    switch (v.getId()) {
    case R.id.create_button:
        Intent i = new Intent(this, Home.class);
                    createEntry();// this is where my error checking is done so what I would like to know is how can i stay on the current screen for certain errors
        startActivity(i);
        break;
}
}

    } 
```

如果出现错误，我不想加载主类，我希望它保留在当前屏幕上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:08:42.803

如果发生错误，您`createEntry()`应该返回一个布尔值。有了它，您可以指示是否应该开始新活动。

```
public void onClick(View v) {
    switch (v.getId()) {
        case R.id.create_button:
            if (createEntry()) { // return true for no errors
                Intent i = new Intent(this, Home.class);
                startActivity(i);
            }
            break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:08:19.563

我猜你应该返回一个关于你是否有错误要修复的布尔值：

```
if(createEntry() == true) {
    Intent i = new Intent(this, Home.class);
    startActivity(i);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:37:35.087

检查错误，如果发现任何错误，然后从该方法返回：

```
if (!createEntry()) return; 
```

# php - 不工作：给一个空字段一个值 - php

> ID：10402596
> 
> 赞同：0
> 
> 时间：2012-05-01T18:50:37.693
> 
> 标签：php, sql, if-statement

[http://pastebin.com/RE31BRSQ](http://pastebin.com/RE31BRSQ)

当我做一个

```
if ( empty($_POST['name']) ) {
    $name = 'anon'; 
} else {
    $name = $_POST['name']; 
} 
```

即使有人在字段中输入字符，该名称也始终是匿名的。

还，

```
if ( empty($_POST['title']) ) {

} else {
    $title = sha1( $_POST['title'] );
} 
```

我怎样才能使它有一个`!`插入的前面`['title']`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:56:23.240

不要依赖`empty()`。它可以转身咬你。请注意，即使任何理智的人都不会这样做，但诸如此类的东西`0`都被[认为是“空的”。](http://php.net/empty)

我看不出您的第一个示例有任何问题，因此请确保您的表单的“名称”字段实际上称为“名称”。这些键区分大小写，因此`$_POST['Name']`与`$_POST['nAmE']`.

至于你的第二个例子，如果你的意思`!`是“非”运算符，你会这样做

```
if (!empty($_POST['title'])) {
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:56:14.700

1.) 你真的确定你的输入字段被命名了`name`吗？我还建议使用`isset()`：

```
if ( isset($_POST['name']) && !empty($_POST['name']) )
{
  $name = $_POST['name'];
}
else
{
  $name = 'anon';
} 
```

2.) 使用连接运算符（如果你想在所有标题前面加上一个`!`散列）：

```
$title = sha1( '!'.$_POST['title'] ); 
```

# android - 在 Android 4.0 中，AlertDialog 关闭而不单击确定并取消

> ID：10402598
> 
> 赞同：0
> 
> 时间：2012-05-01T18:50:41.513
> 
> 标签：android, android-alertdialog

我编写了以下代码来显示 AlertDialogBox 如下

private void dispAlertBox(final String title,final String message,final String ok,final String cancel){

```
 final AlertDialog.Builder alertbox = new AlertDialog.Builder(this);

         try{
          alertbox.setMessage(message);
          alertbox.setTitle(title);
          alertbox.setPositiveButton(ok,new DialogInterface.OnClickListener(){
             public void onClick(DialogInterface arg0, int arg1){

          }
          });
          alertbox.setNegativeButton(cancel,new DialogInterface.OnClickListener(){
          public void onClick(DialogInterface arg0, int arg1){
          }
          });
          alertbox.show();
       }catch(Exception e){
         //Handle BadTokenException.
       }
} 
```

在上面我想关闭 AlertDialog 每当我点击确定并取消时。所以如果我们点击除 AlertDialog 以外的任何其他区域（确定并取消）它不应该关闭。它在 2.x 中工作正常Android 的版本。但在 Android 4.0 中，即使我们单击除确定和取消按钮以外的空白区域，对话框也会关闭。我该如何克服这个问题。

感谢和问候，

文卡特。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:58:57.290

我认为您需要使用`alertbox.setCanceledOnTouchOutside(false);`它来防止对话框在用户触摸屏幕上的其他位置时关闭。此外，`alertbox.setCancelable(false);`如果用户按下后退按钮，添加将阻止对话框关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:59:54.277

尝试添加

```
alertbox.setCancelable(false); 
```

在展示它之前。

# iphone - NSArray 3 次后自行清零

> ID：10402599
> 
> 赞同：-1
> 
> 时间：2012-05-01T18:50:44.197
> 
> 标签：iphone, objective-c, uitableview, nsarray, objectdatasource

我有一个包含几个项目的 NSArray。NSArray 从另一个类加载到 uitableview 中。当我退出详细视图并重新输入（第三次）时，NSArray 为空，tableview 也为空。怎么了？（我正在使用垃圾收集器，所以我认为这不是泄漏）

```
myMatch = [[Match alloc] initWithId:1 OpponentId:13]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:29:42.987

我以前在以下上下文中看到过这一点。

您很有可能将 NSArray 定义为：

@property（弱，非原子）NSArray *myMatch;

将其更改为：

@property ( **strong** , nonatomic) NSArray *myMatch;

**假设：**

1）iOS中没有垃圾收集器，所以我猜你的意思是你正在使用自动引用计数。

2）您没有从一个视图更改为另一个视图（即您没有离开带有 UITableView 的 xib 或场景）

3) 数组已被定义为@property

**什么时候应该使用弱引用或强引用？**

对于初学者来说，一个好的“经验法则”是一个属性只有在引用视图上的控件时才应该是弱的，例如 @property (weak, nonatomic) IBOutlet UILabel *myLabel; 在大多数其他情况下，该属性应该是强大的。

强指针意味着“在内存中保持对该数据的强引用”。弱指针意味着“如果没有其他人对此数据感兴趣，我也不对此感兴趣。” 视图上的控件通常只需要弱指针，因为它们属于当前加载的视图，该视图具有指向它的强指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:01:06.273

我能想到的最佳答案是正确保留 NSArray。根据我的经验（我之前遇到过类似的问题）我没有正确设置 NSArray。您是否在头文件中使用过@property？@property（非原子，保留）NSArray *myArray; 在实现部分，您可以将@synthesize 用于数组。不经过这些步骤，数组可能会在你用来初始化它的方法退出后被释放。因此，您必须保留它！

# ffmpeg - 使用 Xuggle 对 HTTP 实时流进行编码

> ID：10402600
> 
> 赞同：1
> 
> 时间：2012-05-01T18:50:47.950
> 
> 标签：ffmpeg, video-encoding, http-live-streaming, xuggle, xuggler

我创建了一个基于 Xuggle 的服务器系统，将传入的文件编码为 H264 并对其进行分段。但是，在 Quicktime 中播放视频时，它几乎可以正常工作（有时音频会出现小问题），但是当从一个质量流更改为另一个质量流时，图像会丢失。

所以我运行了'mediastreamvalidator'并得到了以下错误：

> 错误：（-1）未知的视频编解码器：1836069494（程序 0，轨道 0）错误：（-1）未能将段解析为 MPEG-2 TS 或 ES

所以我使用 FFMPEG 来获取有关 codex 的一些信息：我的 Xuggler 编码的结果：

```
Input #0, mpegts, from 'segment_0.ts':
  Duration: 00:00:09.40, start: 0.000000, bitrate: 3618 kb/s
  Program 1 
    Metadata:
      service_name    : Service01
      service_provider: FFmpeg
    Stream #0.0[0x100]: Video: mpeg2video (Main), yuv420p, 960x540 [PAR 1:1 DAR 16:9], 104857 kb/s, 25 fps, 25 tbr, 90k tbn, 50 tbc
    Stream #0.1[0x101]: Audio: mp2, 48000 Hz, stereo, s16, 128 kb/s 
```

Compressor 创建的文件的结果：

```
Seems stream 0 codec frame rate differs from container frame rate: 180000.00 (180000/1) -> 25.00 (25/1)
Input #0, mpegts, from 'fileSequence1.ts':
  Duration: 00:00:09.97, start: 19.984578, bitrate: 5308 kb/s
  Program 1 
    Stream #0.0[0x101]: Video: h264 (Main), yuv420p, 960x540, 25 tbr, 90k tbn, 180k tbc
    Stream #0.1[0x102]: Audio: aac, 22050 Hz, stereo, s16, 32 kb/s 
```

在我看来，主要区别在于 Xuggler 编码文件显示的是 Video: mpeg2video 而不是 h264。但是，在编码时，我确实将 Coder 设置为 ICodec.ID.CODEC_ID_H264。

我怎样才能强制它使用h264。音频也是一样。我指定了 AAC 并获得了 MP2。

我随后直接使用了 FFMPEG，结果是：

```
Input #0, mpegts, from 'encoded.ts':
  Duration: 00:00:24.16, start: 1.400000, bitrate: 360 kb/s
  Program 1 
    Metadata:
      service_name    : Service01
      service_provider: FFmpeg
    Stream #0.0[0x100]: Video: h264 (Main), yuv420p, 1920x1080 [PAR 1:1 DAR 16:9], 25 fps, 25 tbr, 90k tbn, 50 tbc
    Stream #0.1[0x101](eng): Audio: aac, 48000 Hz, stereo, s16, 57 kb/s 
```

这样看起来更好。我可以直接使用 FFMPEG，但是通过使用 Xuggler，我可以分割文件，同时更容易跟踪过程的进度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T13:47:26.577

我暂时离开 Xuggle 并使用 FFMPEG 进行编码和分段，仅使用它来获取编码信息等。目前需要两个过程（首先编码，然后使用 FFMPEG 分段），但希望很快 FFMPEG 将允许分段编码时的苍蝇

# asp.net - 我遇到了 "authentication mode= windows" 错误。

> ID：10402601
> 
> 赞同：1
> 
> 时间：2012-05-01T18:50:48.073
> 
> 标签：asp.net

错误 ：

> 在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。

我的错误在上面。如何解决这个问题呢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:51:52.943

您需要在 IIS 中配置应用程序。

IIS7 和 IIS6 说明：[http ://www.affiliatewiz.com/support/appstartpoint.asp](http://www.affiliatewiz.com/support/appstartpoint.asp)

更完整的 IIS7 说明：http: [//msdn.microsoft.com/en-us/library/bb763173.aspx](http://msdn.microsoft.com/en-us/library/bb763173.aspx)

以及更完整的 IIS5/IIS6 说明：http: [//msdn.microsoft.com/en-us/library/zwk103ab.aspx](http://msdn.microsoft.com/en-us/library/zwk103ab.aspx)

从技术上讲，这跨越了程序员和服务器管理员职责之间的界限，但作为 .NET Web 开发人员，您确实需要知道您在 Visual Studio 中创建的任何网站或 Web 应用程序都需要在 Web 上设置为自己的 IIS 应用程序它部署到的服务器。

这里有很多值得了解的信息，特别是如果您自己做这一切，或者服务器管理员不熟悉 IIS 应用程序和 .NET Web 应用程序之间的关系。 [http://msdn.microsoft.com/en-us/library/6hy1xzbw.aspx](http://msdn.microsoft.com/en-us/library/6hy1xzbw.aspx)

（管理员不知道我们需要什么并不少见）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:52:05.453

要么注册到适当的地方，要么正确地将您的虚拟目录配置为 IIS 中的应用程序。

# javascript - 使用 Jquery UI 提交表单

> ID：10402612
> 
> 赞同：0
> 
> 时间：2012-05-01T18:51:34.587
> 
> 标签：javascript, jquery, forms, jquery-ui

我想要立即下载按钮来提交表单。我试过了

```
getElementById("forms").submit();
$("form").submit();
$("#forms").submit(); 
```

仍然没有任何效果。

UI 会弹出并执行其他所有操作，但不提交表单

Java 脚本

```
 $(document).ready(function(){
    $("#dialog-download ").dialog({
        autoOpen: false,
        resizable: false,
        height: 140,
        width: 325,
        modal: true
    });
    $(".opener").click(function(){
        var that = this;
        var checkbox = $(that).next(":checkbox");

        $("#dialog-download").dialog("option", {
            buttons: {
                "Download Now": function(){
                    $(checkbox).prop("checked", !$(checkbox).attr("checked"));
                    $("#dialog-download").dialog("close");
            $("#forms").submit();
                },
                "Download Later ": function(){
                    $(checkbox).prop("checked", !$(checkbox).attr("checked"));
                    $("#dialog-download").dialog("close");
                },
                "Cancel": function(){
                    $("#dialog-download").dialog("close");
                }
            }
        });
        $("#dialog-download").dialog("open");
    });
}); 
```

HTML

```
<div id="dialog-download" title="Download Now?">
    <p><span style="float:left; margin:0 7px 20px 0;"></span>Download the file now or later?</p>
</div>

<form id = "forms" method="post" action="<?php echo $PHP_SELF;?>">
<a class="opener" href="#">db1.csv:</a>
<input id="c1" type="checkbox" name="download[]" value="db1.csv" /><br />
<...>
<input id="submit" type="submit" name="submit" value="submit" >
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T13:26:42.870

请参阅 jQuery 文档[`submit()`](http://api.jquery.com/submit/)。

> 表单及其子元素不应使用与表单属性（例如提交、长度或方法）冲突的输入名称或 ID。名称冲突可能会导致令人困惑的失败。有关规则的完整列表并检查这些问题的标记，请参阅[DOMLint](http://kangax.github.com/domlint/)。

[http://jsfiddle.net/Fj2cC/4/](http://jsfiddle.net/Fj2cC/4/)

# xpath - 如何组合这些 xpath 表达式？

> ID：10402613
> 
> 赞同：6
> 
> 时间：2012-05-01T18:51:38.460
> 
> 标签：xpath

我有两个 Xpath 表达式...

```
//*[@id='gutter']/p[strong[text()='Date:']]/text()
//*[@id='gutter']/p[strong[text()='Time:']]/text() 
```

如何编写一个组合上述两个表达式并返回与单独运行上述每个表达式的结果相同的节点集的单个 xpath 表达式？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-02T02:00:28.043

一般来说，这个 Xpath 表达式：

```
expr1 | expr2 
```

选择*expr1*选择的所有节点和*expr2*选择的所有节点的并*集*。

 **该`|`字符表示 XPath*联合*运算符。

当您希望返回由多个 XPath 表达式选择的节点的联合时，您可以在任何情况下使用联合运算符。

**在这个具体案例中**：

```
 //*[@id='gutter']/p[strong[text()='Date:']]/text()
|
 //*[@id='gutter']/p[strong[text()='Time:']]/text() 
```

虽然可以优化此表达式，但它的优点是联合运算符在所有此类情况下都“有效”，几乎可以机械地表达，节省时间并消除了通过更复杂的重构引入错误的可能性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T18:55:37.167

怎么样：

```
//*[@id='gutter']/p[strong[text()='Date:' or text()='Time:']]/text() 
```

这或多或少是不言自明的。**

# php - 使用 PHP 对 UTF-16 进行 XML 编码（我不断收到 UTF-8）

> ID：10402614
> 
> 赞同：1
> 
> 时间：2012-05-01T18:51:38.953
> 
> 标签：php, mysql, xml

我有一个从 MYSQL 中提取 XML 文件的 PHP 脚本。我有以下行：

```
$xml='<?xml version="1.0" encoding="UTF-16"?>; 
```

但是提取的文件被识别为 UTF-8 UNIX (LF)： ![在此处输入图像描述](../Images/2cf96ce57dd81fd324835663e39a894c.png)

我需要将编码设为 UTF-16 和 Windows CLRF。什么是正确的语法？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:03:10.483

添加 HTTP 标头：

```
header('Content-type: text/xml; charset=utf-16') 
```

我不确定 text/xml 是否最适合您，您应该决定：[http ://www.petefreitag.com/item/381.cfm](http://www.petefreitag.com/item/381.cfm)

此外，屏幕截图中的编辑器设置为 UTF-8

# android - ANDROID 向 C# TCPListener 发送的图像无效

> ID：10402617
> 
> 赞同：1
> 
> 时间：2012-05-01T18:51:47.890
> 
> 标签：android, image, sockets, tcplistener

我在 C# 中将图像从 android 发送到 TCPClient，但是当接收图像时，这是无效图像。

我创建了一个方法来验证流但没有图像头。

任何人都可以帮助我吗？

**这是我的ANDROID代码：** 尝试{

```
 Socket sockTcp = new Socket(EnderecoSoftclinic, PORTATCP);

        while(sockTcp.isClosed()){

            Toast.makeText(contexto, "Tentando conectar ao SoftClinic", Toast.LENGTH_SHORT).show();

            sockTcp.connect(sockTcp.getRemoteSocketAddress(), PORTATCP);

        }

        OutputStream outputStream = sockTcp.getOutputStream();

        outputStream.write(imagem,0,imagem.length);

        outputStream.flush();

        sockTcp.close();

    } catch (IOException e) {
        e.printStackTrace();
    } 
```

**我收到 C# 代码：**

```
 TcpListener tcpReceiver = new TcpListener(IPAddress.Any, 2553);

        tcpReceiver.Start(1);

        while (!finalizado)
        {
            TcpClient android = tcpReceiver.AcceptTcpClient();
            NetworkStream stream = android.GetStream();
            byte[] buffer = null;

            buffer = new byte[Convert.ToInt32(tamanho)];

            if (stream.CanRead)
            {
               while (stream.Read(buffer, 0, buffer.Length) > 0) {}
            }

            if (buffer == null || buffer.Length == 0)
            { return; }

            MemoryStream streamImg = new MemoryStream();
            streamImg.Write(buffer, 0, buffer.Length);

            if (!IsValidImage(streamImg))
            {
                finalizado = true;
                return;
            }

            if (File.Exists("C:/teste.bmp"))
            {
                File.Delete("C:/teste.bmp");
            }

            FileStream streamWriter = new FileStream("C:/teste.bmp", FileMode.CreateNew, FileAccess.Write);
            streamWriter.Write(buffer, 0, buffer.Length);
            streamWriter.Flush();
            streamWriter.Close();
            try
            {
                Image imagemGerada = Image.FromStream(streamImg);
                if (AoRetornarDadosEquipamento != null)
                {
                    AoRetornarDadosEquipamento(imagemGerada);

                }
            }
            catch (Exception ex)
            {
                Debug.Print(ex.Message);
            }

            stream.Close();
            android.Close();
            finalizado = true;
        }

        tcpReceiver.Stop(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T12:33:11.253

我做到了.. 以更简单的方式，我只需在我的 c# 程序中获取 NetworkStream 并 CopyTo 新 Stream。

并做了。

谢谢...........

只需要这个

```
 NetworkStream stream = android.GetStream();
        MemoryStream streamImg = new MemoryStream();
        stream.copyto(streamimg); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T06:48:21.980

我看到一个问题。

在将 MemoryStream (streamImg) 保存到文件时，它会被读取一次。

然后你*不要*倒带它并尝试加载图像（因此读取文件末尾！）。利用

```
 streamImg.Seek(0, SeekOrigin.Begin) 
```

行后

```
 streamWriter.Close(); 
```

这可以完成这项工作。

另一种方法是重新创建 streamImg（这实际上是相同的）。

# java - 创建 EntityManager 时出错

> ID：10402621
> 
> 赞同：0
> 
> 时间：2012-05-01T18:52:18.290
> 
> 标签：java, jakarta-ee, jpa, jpa-2.0, entitymanager

我正在尝试创建一个实体管理器来持久化一个对象。这是我的做法：

```
 EntityManagerFactory emf = Persistence.createEntityManagerFactory("com.dv_model_jar_1.0-SNAPSHOTPU");
    EntityManager em = emf.createEntityManager();
    EntityTransaction tx = em.getTransaction();

    Users user = new Users();
    user.setPassword("test2");
    user.setUserName("test2");

    tx.begin();
    em.persist(user);
    tx.commit();

    em.close();
    emf.close(); 
```

当我尝试在 Netbeans 中运行此代码时，我可以执行第一行并获得一个工厂，但是，在执行第二行之后，程序停止了。没有输出。任何想法为什么？

这是我的 persistence.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence"     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence  http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
  <persistence-unit name="com.dv_model_jar_1.0-SNAPSHOTPU" transaction-type="RESOURCE_LOCAL">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
<class>com.dv.model.Users</class>
<properties>
  <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:8889/esa"/>
  <property name="javax.persistence.jdbc.password" value="root"/>
  <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver"/>
  <property name="javax.persistence.jdbc.user" value="root"/>
  <property name="eclipselink.ddl-generation" value="create-tables"/>
</properties> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T13:23:34.207

您很可能会遇到错误，例如您的登录失败。添加一个 try catch 并打印异常。或者调试代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T15:30:38.840

我想到了。我在类路径中没有 jdbc。它找不到数据库。

# performance - hadoop伪分布式操作和独立操作的性能比较

> ID：10402625
> 
> 赞同：0
> 
> 时间：2012-05-01T18:52:22.987
> 
> 标签：performance, hadoop, distributed

我是hadoop的初学者。但我有一个有趣的观察。

使用hadoop 文档中[的示例](http://hadoop.apache.org/common/docs/r1.0.2/single_node_setup.html)，

通过在独立操作和伪分布式操作中运行相同的示例，独立操作用时不到 1 分钟，但伪分布式操作用时超过 3 分钟。这是很大的区别。我可以理解分布式模式下有额外的网络和调度开销。但似乎差别太大了。这可能不是真正的比较，因为示例非常简单。

我的问题是，在现实世界的工作中，独立模式和分布式模式之间有多大区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:35:13.053

这些是相当不同的场景。在独立模式下，它永远不会启动正确的单节点 Hadoop 集群。一切都发生在本地，内联，在 JVM 中。数据甚至不必写入磁盘，可能。伪分布式操作是一个本地节点的最小“真实”Hadoop 安装。您必须将数据读/写到本地 HDFS 实例，生成另一个 JVM，等等。所有这些都会增加很多开销。也许开销确实是几分钟。这对我来说似乎完全明智。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-20T11:29:26.080

Hadoop 框架用于处理大数据。

**所以数据的大小很重要**，因为在传统文件系统中处理较小的文件会比在 hadoop 中更快，因为 hadoop mapreduce 框架有内部工作要做（制作数据文件块并将其发送到数据节点并在处理从数据节点再次访问时）。因此对于较小的文件，hadoop框架不适合。

来到独立和伪分布式模式，你应该考虑的一个方面是文件的大小，第二个方面是独立和伪分布式模式的实际差异。

在独立模式下，没有 HDFS 的概念，数据不会复制到 hadoop 分布式文件系统（显然节省了时间）。而在伪分布式模式下，涉及的 hdfs 需要与需要处理的数据一起复制。

**小尺寸的数据文件更适合使用传统的文件处理，如果文件大小变得越来越大，hadoop 框架会提供更好的处理时间！** 希望这可以帮助！

# javascript - jQuery发布数据返回比较不起作用

> ID：10402626
> 
> 赞同：0
> 
> 时间：2012-05-01T18:52:24.753
> 
> 标签：javascript, jquery

我有这段代码：

```
function addEmail() {
            email = $("#email").val();
            atime = $("select#time").val();
            tid = <?= $tid; ?>;
            $.post("remindme.php", { email: email, time: atime, tid: tid },
                function(data) {
                    if (data == "x") {
                        alert(data);
                        $('#remindme').modal('hide');
                        $('#quota').show();
                    }
                    else {
                        alert(data);
                        $('#remindme').modal('hide');
                        $('#remindersuccess').show();
                    }
                });
            } 
```

`remindme.php`如果有问题，回显“x”。

我正在尝试比较remindme.php 的输出，但即使它回显是x，条件`data == "x"`也不起作用。

我添加了`alert(data)`，我可以看到它`x`在需要时正确显示..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:03:10.620

如果服务器回显该`x`字符串，则`if (data == 'x')`成功回调中的测试应该可以工作。你的问题在别的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T18:29:03.910

也许是晚了。我遇到了同样的问题，我通过非常愚蠢的解决方法解决了（适用于您的代码）：

```
function(data) {
    var server_info = data;
    if (server_info == "x") {                       
         $('#remindme').modal('hide');
          $('#quota').show();
    } else {
         $('#remindme').modal('hide');
         $('#remindersuccess').show();
    }
} 
```

我不知道为什么 ：/

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-19T13:21:40.227

我可能有同样的问题，我这样修复它：

```
 var verify = function (user,fName,fPass) {
        var result = "";
        $.ajaxSetup({async:false});
        $.post("php_scripts/verify"+user+".php",{login:fName, pass:fPass},function (data) {
            result = $.trim(data);   // use $.trim when are you using "data"
        });
        return result;
    } 
```

# c++ - 静态数组缓冲区分配

> ID：10402627
> 
> 赞同：2
> 
> 时间：2012-05-01T18:52:28.850
> 
> 标签：c++, arrays, buffer

假设我定义了一个数组`float floatBuffer[4]`并且我有一个结构：`struct vec3{float x,y,z;} myVec;`

在分配 vec3 之前，我分配：`floatBuffer[3] = 0.0f;`

（如果可能的话，）我可以通过什么方式分配`myVec`（`floatBuffer[0]`二进制副本），以便

*   floatBuffer[0] == myVec.x

*   floatBuffer[1] == myVec.y

*   floatBuffer[2] == myVec.z

*   浮动缓冲区[3] == 0.0f

    ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:12:38.563

该标准确实说即使在*standard-layout-struct*内部（但不是在开头）也可能存在填充，因此二进制副本可能不可移植。但是，给定特定的系统和打包说明（查找`#pragma pack`），您可能只能使用`memcpy`.

您可以尝试以下方法：

```
#include <cstring>
#include <algorithm>
#include <iterator>
#include <iostream>

// look up your compiler's documentation
//#pragma pack(4) 

struct fs {
 float x, y, z;
};

int main() {
 fs b = {1.0, 2.0, 3.0};
 float p[ 4 ] = {0};
 static_assert( sizeof b == sizeof p - 1, "warning: padding detected!" );
 std::memcpy(&p[ 0 ], &b, sizeof p - 1);
 std::copy(&p[ 0 ], &p[ 0 ] + 3, std::ostream_iterator<float>(std::cout, "\n"));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:55:46.843

显而易见的答案是：

```
floatBuffer[0] = myVec.x;
floatBuffer[1] = myVec.y;
floatBuffer[2] = myVec.z; 
```

如果您愿意对结构布局做出假设，并且*您的编译器为直接分配生成蹩脚的代码*，请记录您的假设并执行以下操作`memcpy`：

```
static_assert(sizeof(myVec) == sizeof(float[3]), "myVec should not have padding");

memcpy(&floatBuffer[0], &myVec, sizeof(myVec)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:22:09.550

可以使用 memcpy，但如前所述，memcpy 可能很脆弱，具体取决于包装。

我认为这里最好的解决方案是使用多个语句而不是棘手。

```
floatBuffer[0] = myVec.x; 
floatBuffer[1] = myVec.y; 
floatBuffer[2] = myVec.z; 
```

通过以明显的方式进行...代码清楚地表明正在发生的事情，您可以让编译器为您优化代码。

确实想到的一个问题是，为什么要使用浮点数组而不是 vec3 或 vec3 数组（这将允许单个分配）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T19:34:21.143

你可以为此编写一个函数。

```
struct vec3{float x,y,z;} myVec;

float* operator<< (float t[4], vec3 v) {
  t[0] = v.x; t[1] = v.y; t[2] = v.z; t[3] = 0;
  return t;
}

int main() {
  float test[4];
  test << myVec; // now do the assignment 'in one go'
  return 0;
} 
```

# netbeans - 为 PHP 配置 XDebug

> ID：10402629
> 
> 赞同：3
> 
> 时间：2012-05-01T18:52:30.900
> 
> 标签：netbeans, xdebug, php

我想从 NetBeans 7.1 调试 PHP。我的网络服务器是 IIS。我首先发现 NetBeans 尝试使用 XDebug，下载它，将 DLL 复制到适当的文件夹。现在我想知道如何正确配置它。

[在线 php 配置分析器](http://www.xdebug.org/wizard.php)给了我以下建议：

> 1.  下载php_xdebug-2.1.4-5.3-vc9-nts.dll
> 2.  将下载的文件移动到 C:\Program Files\PHP\v5.3\ext
> 3.  编辑 C:\Program Files\PHP\v5.3\php.ini 并添加该行
> 4.  zend_extension = C:\Program Files\PHP\v5.3\ext\php_xdebug-2.1.4-5.3-vc9-nts.dll
> 
> 重启网络服务器

好的，一切都清楚了，除了**在 php.ini 的哪个部分放置该行**。我很怀疑。

另一方面，Netbeans 抱怨：

> 在 224 秒内未检测到来自 xdebug 的连接。原因可能是未安装或未正确配置 xdebug。确保您的 php.ini 文件包含以下条目：
> 
> xdebug.remote_enable=on
> 
> xdebug.remote_handler=dbgp
> 
> xdebug.remote_host=localhost（或主机名）
> 
> xdebug.remote_port=9000

再一次，**将这些行放在 php.ini 的哪个部分**？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:23:20.403

您可以在 php ini 文件的任何位置添加 xdebug 行，最有可能在最后。要检查 xdebug 是否正确安装，请检查 phpinfo 函数和调试客户端。[您可以在 xdebug 主页上获取调试客户端： http](http://xdebug.org/docs/install) ://xdebug.org/docs/install 。当您使用开关 -i 9000 -r 9000 启动它时，它应该连接到 xdebug，然后您可以使用 netstat -an | 验证它。grep 9000。然后您可以加载示例网页并查看调试客户端的输出。以防万一检查您的 xdebug 日志。当它与 debugclient 一起使用时，您有一个很好的证明，您可以使其与您的 IDE 一起使用。这对我有很大帮助：[http](http://forums.netbeans.org/topic1513-30.html) ://forums.netbeans.org/topic1513-30.html 。如果 xdebug 正在侦听端口 9000，您还可以检查此脚本：

```
<?php 
     $address = '127.0.0.1'; 
     $port = 9000; 
     $sock = socket_create(AF_INET, SOCK_STREAM, 0); 
     socket_bind($sock, $address, $port) or die('Unable to bind'); 
     socket_listen($sock); 
     $client = socket_accept($sock); 
     echo "connection established: $client"; 
     socket_close($client); 
     socket_close($sock); 
?> 
```

它对我不起作用，但试试看？我在我的虚拟机上安装了 lighttpd 和 xdebug，并在远程服务器上使用了反向 shell。我使用科莫多 IDE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:28:56.210

您可以将其添加到文件中的任何位置。如果您搜索“extension”或“.so”或“.dll”，我相信您会在 php.ini 文件中找到一个示例。我对 Windows 不太熟悉，但是在 linux 上，在终端中输入“php -m”会列出所有当前加载的模块。Xdebug 应该列出两次，一次在 PHP 下，一次在 Zend 下。

例子

```
; php -m 
```

输出...

```
[PHP Modules]
mysql
mysqli
curl
xdebug

[Zend Modules]
xdebug 
```

您可以检查几件事来帮助解决这个问题，即在网页上输出 phpinfo() 并检查您正在编辑的 php.ini 是否是正在加载的。它列在“默认配置文件”下

同样在您重新启动服务器后。检查服务器日志以确保配置文件中没有任何错误。

我在 Netbeans 中运行了 xDebug，但我没有使用它们在错误消息中提供的配置。我只在我的 .ini 文件中添加了一行：

```
zend_extension=<path_to_extension>/xdebug.so 
```

Zend 扩展（至少在我的设置中）需要一个完整的路径，所以检查路径是否完整（看起来像你的）并且它是正确的。

您也可以尝试将扩展名放在“extension_dir”下的 phpinfo 中列出的默认扩展文件夹中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-09T12:39:41.100

我有一个类似的问题，并遇到了一个帖子来解决这个问题。我的 html 表单 (testform.html) 正在调用 php 脚本 (runQuery.php)，而 Netbeans 无法在设置的断点处中断。

通过在类似这样的论坛上搜索检查 php.ini 和 Netbeans 中的所有配置设置后，我发现如果项目的索引文件是 PHP 文件，netbeans 只会在断点处中断。这非常重要，否则您将花费​​数小时试图找出断点不起作用的原因。

在 Netbeans 中，进入文件/项目属性/运行配置并检查索引文件是否为 PHP 文件。就我而言，我将索引文件从 testform.html 更改为 testform.php 并且它起作用了，我能够在断点处中断。

亚萨尔。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T15:18:14.280

如果你在 php.ini 中尝试过 xdebug 的东西，但它不起作用，我也遇到了同样的问题。我阅读了在线帮助无济于事。后来我注意到我的 url 显示了错误的地址：

```
localhost/todolist/web/web/index.php?XDEBUG_SESSION_START=netbeans-xdebug 
```

当它应该是

```
localhost/todolist/web/index.php?XDEBUG_SESSION_START=netbeans-xdebug 
```

我纠正了它并让它工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-09T14:36:25.037

我遇到了类似的问题，感谢 J.Money 关于运行**PHP -M**的建议，我发现问题是我的路径中有一个空格，因此需要双引号：

解决方法就是改变：

> zend_extension = C:\Program Files\PHP\v5.3\ext\php_xdebug-2.1.4-5.3-vc9-nts.dll

至：

> zend_extension = "C:\Program Files\PHP\v5.3\ext\php_xdebug-2.1.4-5.3-vc9-nts.dll"

我也将此记录为错误：[http ://bugs.xdebug.org/view.php?id=922](http://bugs.xdebug.org/view.php?id=922)

# javascript - Safari 中的 JavaScript 文档文本区域问题

> ID：10402633
> 
> 赞同：0
> 
> 时间：2012-05-01T18:52:37.180
> 
> 标签：javascript, parsing, safari, document

我是 JavaScript 新手，一直在从[JavaScriptKit](http://www.javascriptkit.com/script/popquiz.htm)修改一个不安全的 JavaScript 测验，主要是在 JSLint 和 Firebug 中整理它，并试图让它在 Safari（特别是 iPad）上运行。该测验在 IE9、Chrome 和 Firefox 中运行良好。

三天后，在论坛的帮助下，问题已经缩小到一个 JavaScript 方法`parse`被用作变量！Safari JavaScript 调试返回

> ReferenceError：找不到变量解析

这是有道理的（尽管为什么其他浏览器似乎并不关心这很奇怪）。[此处](http://subquark.com/html5/quiz/popquiz.htm)提供了带有一些警报的当前版本，错误发生在`results.htm`页面上。

该功能如下，我不知道如何修复它。我更改`parse`为`parced`其他名称，认为它只需要是一个变量，但这使得它在所有浏览器中都失败了！我实际上并不了解文档如何将信息写入文本区域，只是它可以在三个浏览器中工作，就像魔术一样！任何帮助，将不胜感激。

```
var wrong = 0;
var e, n, results, temp, totalquestions;
for (e = 0; e &lt;= 2; e++) {
    document.result[e].value = "";
}

var results = document.cookie.split(";");
alert("var results = " + results);
for (n = 0; n &lt;= results.length - 1; n++) {
    alert("results length = " + results.length); &lt;!--last alert in Safari --&gt;
    if (results[n].charAt(1) === 'q') {
        parse = n;
        alert("parse = " + parse);
    }
}

var incorrect = results[parse].split("=");
alert("var incorrect = " + incorrect);
incorrect = incorrect[1].split("/");
alert("var incorrect after split = " + incorrect);
if (incorrect[incorrect.length - 1] === 'b') {
    incorrect = "";
}

document.result[0].value = totalquestions - incorrect.length + " out of " + totalquestions;
document.result[2].value = ((totalquestions - incorrect.length) / totalquestions * 100).toFixed() + "%";
for (temp = 0; temp &lt; incorrect.length; temp++) {
    document.result[1].value += incorrect[temp] + ", ";
    alert("the value of temp is " + temp);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T19:52:20.453

问题在于...

```
results[n].charAt(1) 
```

位置 1 实际上是 "=" 而不是 "q"

正确的代码应该是...

```
if (results[n].charAt(0)=='q'){ 
```

我知道这是一篇旧帖子，但我今天实际上遇到了同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:11:26.460

您尚未`parse`在任何地方声明，这可能会导致某些浏览器出现随机问题。我会改变：

```
var e, n, results, temp, totalquestions; 
```

至

```
var e, n, results, temp, totalquestions, parse; 
```

# java - 与java交互时如何在clojure中显式转换

> ID：10402636
> 
> 赞同：6
> 
> 时间：2012-05-01T18:52:43.573
> 
> 标签：java, clojure, interop, variadic-functions

在尝试使用 clojure 中的 weka 时，我正在尝试使用 clojure 的 java 互操作功能将[this howto guide](http://weka.wikispaces.com/Programmatic+Use)从 weka wiki 转换为 clojure。

到目前为止，这一直运作良好，除了在一种情况下，clojure 反射机制似乎无法找到正确的调用方法 - 我有：

```
(def c-model (doto (NaiveBayes.) (.buildClassifier is-training-set))) 
```

稍后这将由类的`.evaluateModel`方法调用`Evaluation`：

```
(.evaluateModel e-test c-model is-testing-set) 
```

where`e-test`是类型`weka.classifiers.Evaluation`，根据[他们的 api 文档](http://weka.sourceforge.net/doc.dev/weka/classifiers/Evaluation.html#evaluateModel%28weka.classifiers.Classifier,%20weka.core.Instances,%20java.lang.Object...%29)，该方法采用两个类型参数`Classifier`和`Instances`

不过，我从 clojure 得到的是`IllegalArgumentException No matching method found: evaluateModel for class weka.classifiers.Evaluation clojure.lang.Reflector.invokeMatchingMethod (Reflector.java:53)`- 我猜这是因为`c-model`它实际上是 type `NaiveBayes`，尽管它也应该是`Classifier`- 根据`instance?`.

我尝试强制转换`cast`无济于事，据我了解，这更像是一种类型断言（当然，通过没有问题），而不是在 clojure 中进行真正的强制转换。是否有另一种方法可以明确告诉 clojure 在 java 互操作方法调用中要转换为哪些类型？（请注意，我上面链接的原始指南也使用了从`NaiveBayes`to的显式转换`Classifier`）

完整代码在这里：/http://paste.lisp.org/display/129250

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T07:46:15.080

链接的 javadoc 与您声称有一个采用 Classifier 和一个 Instances 的方法相矛盾 - 有一个采用 Classifier、一个 Instances*和可变数量的 Objects 的*方法。正如在许多 SO 问题中所讨论的（目前我能找到的唯一一个是[为什么字符串格式化会导致强制转换异常？](https://stackoverflow.com/questions/7643151/why-is-string-formatting-causing-a-casting-exception)），Clojure 不提供对可变参数的隐式支持，可变参数基本上是`javac`编译器创建的虚构。在 JVM 级别，它只是 Object[] 类型的附加必需参数。如果您将第三个参数（一个空的对象数组）传递给您的方法，它将正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:08:34.293

`IllegalArgumentException No matching method found`任何时候参数与类不匹配时都会发生。它们可能无法匹配，因为不存在具有该名称和参数数量的方法，或者因为在被调用的类中不存在具有该名称的方法。所以还要检查参数的数量和类型。

在这些情况下，我基本上总是求助于 repl-utils/show

# .htaccess - 为什么 .htaccess 重定向在包含 www 但不是没有的 url 上起作用？

> ID：10402641
> 
> 赞同：1
> 
> 时间：2012-05-01T18:53:03.653
> 
> 标签：.htaccess, redirect

我有两个需要使用重定向的 URL：

example.com/john_doe 和 www.example.com/john_doe

这些都需要成为>>

www.example.com/?name=john_doe 或 example.com/?name=john_doe

这是我的 .htaccess 文件：

```
Options +FollowSymlinks
Options -MultiViews
RewriteEngine On

RewriteCond %{REQUEST_URI} !^/code(.*)$ [NC]
RewriteRule ^(.*)/$ http://example.com/index.php?name=$1 [R=301,L] 
```

几个小时以来，我一直在努力解决这个问题！

# objective-c - 背景音乐

> ID：10402645
> 
> 赞同：0
> 
> 时间：2012-05-01T18:53:28.833
> 
> 标签：objective-c, ios, avfoundation, avplayer

（使用 AVFoundation.framework）

```
#import "AVFoundation/AVFoundation.h" 
```

所以我遇到了一个问题，我首先在我的类的 init 方法中尝试了这段代码（即首先加载的那个）

```
NSString* soundFilePath = [[NSBundle mainBundle] pathForResource:@"music" ofType:@"mp3"];
NSURL* soundFileURL = [NSURL fileURLWithPath:soundFilePath];
AVAudioPlayer* player = [[AVAudioPlayer alloc] initWithContentsOfURL:soundFileURL error:nil];
player.numberOfLoops=-1;
[player play]; 
```

但它没有用，我决定在 thread: init 方法中做：

```
[NSThread detachNewThreadSelector:@selector(playMusic) toTarget:self withObject:nil]; 
```

和方法本身：

```
-(void) playMusic {
    NSString* soundFilePath = [[NSBundle mainBundle] pathForResource:@"music" ofType:@"mp3"];
    NSURL* soundFileURL = [NSURL fileURLWithPath:soundFilePath];
    AVAudioPlayer* player = [[AVAudioPlayer alloc] initWithContentsOfURL:soundFileURL error:nil];
    player.numberOfLoops=-1;
    [player play];
} 
```

它当然是在 *.h 文件中声明的。它也没有工作。

我尝试调试，在线

```
} 
```

playMusic 方法文件播放 2 或 3 秒然后停止。没有调试就无法播放。问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:03:55.893

AVAudioPlayer 将立即被释放。你需要留住玩家。因此，使 AVAudioPlayer 成为该类的实例变量。

# ruby - 在 Cucumber 测试中模拟没有 Internet 连接的最佳方法是什么？

> ID：10402648
> 
> 赞同：5
> 
> 时间：2012-05-01T18:53:49.110
> 
> 标签：ruby, command-line, cucumber, integration-testing

我的命令行 Ruby 程序的一部分涉及在处理任何命令之前检查是否有 Internet 连接。程序中的实际检查是微不足道的（使用 Socket::TCPSocket），但我试图在 Cucumber 中测试这种行为以进行集成测试。

**编码：**

```
def self.has_internet?(force = nil)
  if !force.nil? then return force
  begin
    TCPSocket.new('www.yelp.co.uk', 80)
    return true
  rescue SocketError
    return false
  end
end

if has_internet? == false
  puts("Could not connect to the Internet!")
  exit 2
end 
```

**特点：**

```
Scenario: Failing to log in due to no Internet connection
  Given the Internet is down
  When I run `login <email_address> <password>`
  Then the exit status should be 2
  And the output should contain "Could not connect to the Internet!" 
```

我显然不想更改实现以适应测试，并且我要求所有场景都通过。显然，如果实际上没有连接，则测试按原样通过，但我的其他测试失败，因为它们需要连接。

**我的问题：我怎样才能以有效的方式对此进行测试并让我的所有测试都通过？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:01:06.070

您可以存根您的`has_internet?`方法并在步骤的实现中返回 false `Given the Internet is down`。

```
YourClass.stub!(:has_internet?).and_return(false) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:04:34.320

我能想到三种替代解决方案：

1.  让测试暂时进行monkeypatch `TCPSocket.initialize`（或者*，* `Socket#connect`如果它结束了）以假装互联网已关闭。
2.  编写（suid）一个脚本，添加/删除`iptables`防火墙规则以禁用互​​联网，并让您的测试调用该脚本
3.  在覆盖C 调用`LD_PRELOAD`的特殊编写的 .so 共享库上使用。`connect`这更难。

我自己，我可能会尝试选项 1，大约 5 分钟后放弃并选择选项 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-20T10:49:15.590

对你来说可能有点晚了:)，但看看

[https://github.com/mmolhoek/vcr-uri-catcher](https://github.com/mmolhoek/vcr-uri-catcher)

我这样做是为了测试网络故障，所以这应该对你有用。

# c# - 如何通过 DragDrop 事件传递数据？

> ID：10402651
> 
> 赞同：1
> 
> 时间：2012-05-01T18:54:19.070
> 
> 标签：c#, .net, winforms, events

我很少有自己制作活动的经验。我目前正在使用表单和控件来处理事件，所以我试图坚持使用 WinForm 处理事件的方式。

WinForm 控件已经有自己的事件。由于事件是使用某种委托类型进行的，因此我必须在用于处理事件期间发生的事情的方法中匹配委托签名。据我所知，这意味着我必须在我的事件处理程序中接收两个参数：一个 source`Object`和一个`EventArgs`.

我试图弄清楚如何通过`DragDrop`相关事件在控件之间传递各种信息。我已经能够在网上找到针对不同情况的各种代码片段，但我想更好地了解这些信息是如何实际传递的。

特别是当涉及到`DragDrop`事件时，我的信息似乎将通过`DataObject`. 反过来，它作为参数传递给`DragDrop.DoDragDrop`方法。

这是我的理解开始减少的地方。在我见过的大多数示例中，似乎指定了某种数据格式。数据格式本身是字符串类型。通常数据格式与数据一起传递到`DataObject`.

这种数据格式是做什么的？它只是显示所涉及数据的类型吗？我已经看到了测试数据格式的示例，并且根据数据格式的不同进行了各种操作。你不能只做一个 typeof(YourData) 来检查类型吗？我不明白数据格式有什么用。

[http://msdn.microsoft.com/en-us/library/ms741842.aspx](http://msdn.microsoft.com/en-us/library/ms741842.aspx)

在上面的链接中，第一个示例显示`DataObject`正在创建一个没有指定数据格式的。它解释了数据格式是自动选择的，并且您的对象是默认转换的。

您可以将任何对象传递给`DataObject`? 那么当`DragDrop`目标控件上发生事件时，该控件是否可以访问传递的对象的方法和字段？或者对象会被转换成其他形式`DataObject`吗？各种结构怎么样？

我还做了一些从 Windows 资源管理器图标拖放到我的表单的操作。我能够使用我找到的一些示例代码获取图标的文件路径。它还使用了一种数据格式。

```
if (e.Data.GetDataPresent(DataFormats.FileDrop))
{
    e.Effect = DragDropEffects.Copy;
} 
```

**摘要：** 我试图了解数据是如何通过 WinForm 事件传递的。我不明白我在各种`DragDrop`示例中看到的一些内容。我知道数据以某种方式以各种格式存储，并且有一种方法可以提取这些数据。我不明白数据格式的用途。我不明白究竟可以通过`DataObject`. 总的来说，我的理解`EventArgs`相当缺乏。

随意评论我在这里提到的任何内容。如果我说错了什么，请指出。感谢任何能帮助我更好地理解这个主题的东西。

**编辑：** 我决定解释我打算去哪里。也许有人可以使用我正在尝试做的事情来解释我所问的一些问题。

我有一个包含某种类型控件的表单。我正在尝试使控件的放置高度可定制和动态。每当用户将另一个控件添加到表单中时，每个控件都会自动重新定位以保持有序。

我目前正在尝试允许用户在表单周围拖动一个控件以重新定位它。无论用户决定在何处放下控件，所有其他控件都将移开，为移动控件腾出空间。

如果我能够正确地移动被拖动的控件和窗体上的所有其他控件，我需要能够从被拖动的控件中获取某些信息。需要通过事件传递的主要数据将采用使用`System.Drawing.Point`结构的 Location 属性的形式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:22:36.087

这里有一些东西可以让您了解它是如何完成的。

首先将两个面板放在一个窗体上，并将它们的颜色设置为两种不同的颜色。

```
public Form1()
{
    InitializeComponent();

    panel1.MouseDown += new MouseEventHandler(panel1_MouseDown);
    panel2.AllowDrop = true;
    panel2.DragEnter += new DragEventHandler(panel2_DragEnter);
    panel2.DragDrop += new DragEventHandler(panel2_DragDrop);
}

void panel1_MouseDown(object sender, MouseEventArgs e)
{
    panel1.DoDragDrop(panel1, DragDropEffects.Move);
}

void panel2_DragEnter(object sender, DragEventArgs e)
{
    if (e.Data.GetData(typeof(Panel)) != null) e.Effect = DragDropEffects.Move;
}

void panel2_DragDrop(object sender, DragEventArgs e)
{
    Panel p = sender as Panel;//Not needed in this case. Could just write panel2.
    Panel dropped = (Panel)e.Data.GetData(typeof(Panel));
    dropped.Location = p.PointToClient(new Point(e.X, e.Y));
    p.Controls.Add(dropped);
} 
```

然后将 panel1 拖到 panel2 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:19:58.417

我认为这个问题不应该使用拖放来解决。拖放是*多个应用程序*交换数据的一种方式。如果您拖动的数据仅对当前流程有意义，请不要使用拖放操作。

您可以只使用一个字段（例如，包含表单的实例上的一个字段）来存储您需要的所有数据。

简单地说：拖放不是一种拖动控件的方法。无论如何，您需要很多自定义逻辑。这不像 dnd 的内置功能在这里可以帮助您。

# c# - C# 类继承问题

> ID：10402662
> 
> 赞同：0
> 
> 时间：2012-05-01T18:54:48.227
> 
> 标签：c#, asp.net, class, inheritance, methods

所以我没有使用母版页，因为项目的规模很小，而且总体上是为了保持精简。因此，我想在一个简单的 cs 文件中包含一个类并在同一页面上使用它。

```
// <copyright file="anon.cs" company="Anonymous">
//     ;
// </copyright>

namespace cheese.pies.org
{
using System;
using System.IO;
using System.Net;
using System.Web;
using System.Xml;

/// <summary>
///   Class to process CAS authentication.
///   Based on solutions from CASE and Yale.
/// </summary>
public class CasLogin
{
    /// <summary>
    ///   Address of university cas host
    /// </summary>
    private const string CasHost = "notimportant";

    /// <summary>
    ///   Get the logged-in user's id or redirect them to login.
    /// </summary>
    /// <returns>
    /// DirectoryID of logged in user
    /// </returns>
    public static string GetId()
    {
        ...
    }
    ...
} 
```

其余的相当不重要。我相信这是一个基本的语法错误。

这是文件test.aspx，它使用了一个页面包含。

```
<% @Page Language="C#" Inherits="CasLogin" CodeFile="anon.cs" %>
<script language="C#" runat="server">
protected void Page_Load(object sender, EventArgs e) {
    String directoryId = CasLogin.GetId();
    FormsAuthentication.RedirectFromLoginPage(directoryId, false);
}
</script> 
```

我得到的错误是：

```
Compiler Error Message: ASPNET: Make sure that the class defined in this code file matches the 'inherits' attribute, and that it extends the correct base class (e.g. Page or UserControl). 
```

我对这种事情还很陌生，我想知道出了什么问题以及正确的语法是什么。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T18:56:40.883

只需更新类以从页面派生：

```
public class CasLogin : Page
{ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:57:42.360

您的错误消息告诉您问题所在。将类更改为：

```
public class CasLogin : Page 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T18:57:48.807

它准确地告诉你出了什么问题：

编译器错误消息：ASPNET：确保此代码文件中定义的类与“继承”属性匹配，**并且它扩展了正确的基类（例如 Page 或 UserControl）。**

是否`public class CasLogin {}`扩展`Page`或`UserControl`？

# java - 使用终端在 OSx 上获取主 HDD 串行

> ID：10402663
> 
> 赞同：2
> 
> 时间：2012-05-01T18:54:48.943
> 
> 标签：java, macos, hardware, hard-drive, serial-number

好的，所以我认为这个问题的标题几乎概括了它。

我想知道一种在没有管理员权限的情况下在 OSx 中获取安装操作系统的 HDD 序列号的方法。最好是使用终端来执行此操作，因为我需要在我的 Java 应用程序中使用序列号，并且我怀疑 Java 是否具有获取信息本身的能力。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:20:42.463

```
/usr/sbin/diskutil info / | /usr/bin/awk '$0 ~ /UUID/ { print $3 }' 
```

那应该为您提供安装在根目录下的驱动器的序列号。

# php - 通过ajax执行php脚本后如何停止setInterval

> ID：10402665
> 
> 赞同：2
> 
> 时间：2012-05-01T18:54:59.257
> 
> 标签：php, javascript, ajax

我一直在寻找这个问题的答案，而我没有找到它的原因可能只是我从一开始就完全搞砸了我的脚本，所以请任何能帮助我的人都非常感激。

我有一个 javascript 函数，它触发表单提交的 onClick 并运行对 script1.php 的 ajax 调用，然后使用 setInterval 启动一个计时器。setInterval 正在调用另一个 javascript 函数来轮询 script1.php 的输出文件，以便我们可以将新数据添加到屏幕上。这部分工作正常。

但是，我想在 script1.php 完成处理后停止计时器。我该怎么做呢？我尝试在 script1.php 中放入 clearInterval(myTimer) 作为它运行的最后一条语句，它似乎出现在浏览器中，但它并没有停止计时器。

```
<script type="text/javascript">

var myTimer;
var file1 = "script1.php";
var file2 = "script2.php";

function startTimer(myTimer) {
  myTimer = window.setInterval(loadData, 2000);
}

function stopTimer() {
  clearInterval(myTimer);
}

function startData()
{
ajaxRequest(file1,data);
startTimer(myTimer);

}

function loadData()
{
ajaxRequest(file2)
}

</script>

<form action="index.php" method="post">
<div style="text-align:left;width:300px;">
<textarea style="width:300px;height:200px;"> </textarea><BR>
<button type="button" onclick="startData()">get data</button>
</div>
</form>

<div id="myDiv" style="text-align:left;width:500px;border:solid 1px #ccc;padding:50px;">
please enter data above
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:58:13.903

您将`myTimer`作为参数传递给`startTimer`. 这使`myTimer`局部变量成为`startTimer`. 因此它不会更新全局`myTimer`.

它应该是：

```
function startTimer() {
  myTimer = setInterval(loadData, 2000);
}

function stopTimer() {
  clearInterval(myTimer);
} 
```

然后你只需要调用`startTimer()`and `stopTimer()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:58:32.390

是的，你搞砸了。您应该让 PHP 直接将数据返回给执行 AJAX 调用的脚本。

在 AJAX 成功时，PHP 脚本输出的任何文本都将可用于成功回调。

如果您使用的是 JQuery，它会很简单：

```
$.ajax({
   url: 'someurl',
   success: function(response) {
      // do whatever with response
   }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T06:17:28.427

当您开始间隔时，将其分配给任何可公开访问的变量，例如“INTERVAL_ITEM”

当您的响应达到 clearInterval(INTERVAL_ITEM);

# php - 跨页面发送信息 PHP

> ID：10402669
> 
> 赞同：1
> 
> 时间：2012-05-01T18:55:33.110
> 
> 标签：php, mysql, post

我的网站有一个 ajax / php 功能，它每 20 秒从一个表中提取信息。该信息是关于爱好的

它在页面上显示此人的姓名和他们的爱好。我有第二页作为该爱好的信息来源。目前访问第二页的唯一方法是在第一页的表格中输入您的爱好。我将如何获得它，以便我可以单击主页上显示的爱好并访问有关该爱好的信息页面。

要访问它当前从 POST 命令获取爱好的信息。

表格结果正在通过主页显示

```
echo $row['name']." is interested in ".$row['hobby']; 
```

我可以将爱好名称传递到另一个页面吗？我只知道如何通过表单提交来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:01:14.340

您可以创建一个锚标记，该标记是从提供的数据中生成的，该数据带有一个尾随它的查询以承载数据，从而有效地创建一个指向下一步的链接以及其他信息。当然，唯一的问题是它暴露给用户，可以被劫持。

如果您只使用表单提交，您还可以*创建*一个`<input type="hidden">`带有值/名称的东西，您可以使用它来导航到下一页，如果您愿意的话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:02:36.663

我认为没有必要为此进行会话。

查看您的表单发送的信息。如果您正在发出 GET 请求，则可以将该 url 添加到链接中。

因此，在您的主页上，您可以使用下面的链接而不是表单。

`<a href="/hobbies/?name=remote+controlled+cars>Remote Controlled Cars</a>`

所以有了这个链接，它就不再使用了`$_POST`，而是`$_GET`取而代之。

您的主页链接的伪代码如下。 `<a href="/hobbies/?name=<?php echo slugify($row['hobby']); ?>><?php echo $row['hobby']; ?></a>`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T18:57:04.153

研究使用 PHP 的[会话](http://php.net/manual/en/features.sessions.php)。

# ruby-on-rails - 通过初始化程序向 ActiveRecord::Base 添加范围？

> ID：10402672
> 
> 赞同：3
> 
> 时间：2012-05-01T18:55:56.777
> 
> 标签：ruby-on-rails, activerecord, initializer, scoping

我试图通过初始化程序添加这样的范围

```
class ActiveRecord::Base        
  scope :this_month,  lambda { where(:created_at => Time.now.beginning_of_month..Time.now.end_of_month) }
end 
```

但我收到错误“NoMethodError：未定义的方法‘abstract_class？’ 对象：类”。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-23T21:32:32.847

这是一个可以包含在初始化程序中的工作版本，例如`app/initializer/active_record_scopes_extension.rb`.

只需调用`MyModel.created(DateTime.now)`or `MyModel.updated(3.days.ago)`。

```
module Scopes
  def self.included(base)
    base.class_eval do
      def self.created(date_start, date_end = nil)
          if date_start && date_end
            scoped(:conditions => ["#{table_name}.created_at >= ? AND #{table_name}.created_at <= ?", date_start, date_end])
          elsif date_start
            scoped(:conditions => ["#{table_name}.created_at >= ?", date_start])
          end
      end
      def self.updated(date_start, date_end = nil)
          if date_start && date_end
            scoped(:conditions => ["#{table_name}.updated_at >= ? AND #{table_name}.updated_at <= ?", date_start, date_end])
          elsif date_start
            scoped(:conditions => ["#{table_name}.updated_at >= ?", date_start])
          end
      end
    end
  end
end

ActiveRecord::Base.send(:include, Scopes) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:07:49.733

您正在覆盖一个类，而您应该通过模块来完成它。我也会对这种方法有点小心，因为您依赖于每个具有 created_at 的模型

```
module ActiveRecord
  class Base
    scope :this_month,  lambda { where(:created_at => Time.now.beginning_of_month..Time.now.end_of_month) }
  end
end 
```

# android - Android 使用 Soap 库或 Rest WebServices

> ID：10402673
> 
> 赞同：4
> 
> 时间：2012-05-01T18:56:01.383
> 
> 标签：android

我对肥皂和休息网络服务有点困惑！

1.  哪个更好吃
2.  各有优缺点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:26:38.577

**肥皂**

*好处：*

1.  语言、平台和传输无关
2.  专为处理分布式计算环境而设计
3.  是 Web 服务的主流标准，因此可以更好地支持其他标准 WSDL 和供应商提供的工具
4.  内置错误处理（故障）
5.  可扩展性

*缺点：*

1.  在概念上比 REST 更困难、更“重量级”
2.  更详细
3.  更难开发，需要工具

**休息**

*优点：*

1.  语言和平台无关
2.  开发比 SOAP 简单得多
3.  学习曲线小，对工具的依赖少
4.  简洁，不需要额外的消息层
5.  在设计和理念上更接近 Web

*缺点：*

1.  假设一个点对点通信模型——不适用于分布式计算
2.  消息可能通过一个或多个中介的环境
3.  缺乏对安全、策略、可靠消息传递等的标准支持，因此具有更复杂要求的服务更难开发（“自行开发”）
4.  绑定到 HTTP 传输模型

简而言之，如果您针对高级应用程序安全性，我会说您使用 REST 和使用 soap 会更高效。

SOAP 对于移动通信来说实在是太重了，但它具有非常广泛的工具支持。例如，顾问喜欢它，因为他们可以使用工具来定义接口并生成 wsdl 文件，而开发人员喜欢它，因为他们可以使用另一组工具从该 wsdl 文件生成所有网络代码。此外，作为表示的 XML 具有模式和验证器，这在某些情况下可能是一个关键问题。（JSON 和 REST 确实有类似的东西，但工具支持远远落后）。

这个[链接](https://docs.google.com/viewer?a=v&q=cache%3aQzfntTaHnBcJ%3awww.iajet.org/iajet_files/vol.1/no.3/Performance%2520Evaluation%2520of%2520RESTful%2520Web%2520Services%2520for%2520Mobile%2520Devices.pdf%20&hl=fr&gl=tn&pid=bl&srcid=ADGEEShi3N-WW86NU8r5mfbUv0Gmct0wZ48p6n9yEKjgyJa_Qk55OyjW1FUIvGqp9XVS1VhPZ-sic-mAvZdchXwWafRAlHe2hnoCj5xaJBqaxtgRmMhfbwWr_XihJtx5zu-5b4ABYgjM&sig=AHIEtbTPlQK7H5h9TQL5U_V0LYcbreQFCw&pli=1)突出了 Rest 和 Soap webServices 之间的区别，它对我有很大帮助。

# wpf - 使用在 DataTemplate 中应用的样式绑定到 DataGridTemplateColumn？

> ID：10402674
> 
> 赞同：3
> 
> 时间：2012-05-01T18:56:06.177
> 
> 标签：wpf, xaml, data-binding, styles, datatemplate

我有一个`ComboBox`组成 a 的 a `DataTemplate`，我无法将其`IsEnabled`属性绑定到`IsReadOnly`templated 上的属性`DataGridTemplateColumn`。

我在 VS 输出窗口中收到以下错误：

> *在“对象”“ContentPresenter”上找不到“IsReadOnly”属性*

**组合框样式：**

```
<Style TargetType="{x:Type ComboBox}" x:Key="ProficiencyColumnComboBoxStyle">
    <Setter Property="IsEnabled" 
        Value="{Binding RelativeSource={RelativeSource Mode=TemplatedParent},
        Path=IsReadOnly, Converter={StaticResource BooleanOppositeConverter}}" />
</Style> 
```

我认为问题在于我如何指定`RelativeSource`要识别我的`DataGridColumn`. 我试过了：

*   `RelativeSource={RelativeSource TemplatedParent}`

*   `RelativeSource AncestorType={x:Type DataGridColumn}`

*   `RelativeSource AncestorType={x:Type DataGridTemplateColumn}`

我尝试将其他设置器添加到此样式中，并且它们确实生效，因此我知道样式并`DataTemplate`正在应用于控件。

**附言**

我已经使用相同的技术将 a 中的另一个绑定`ComboBox`到其模板列`DataTemplate`的父级上的属性。**不同之处在于，我在这里使用了转换器，并尝试绑定到列**（而不是网格）上的属性。但是，即使我从上述样式中删除了转换器，也不会发生绑定。`DataGrid`

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:51:53.160

试试这个：

```
<Style TargetType="{x:Type ComboBox}" x:Key="ProficiencyColumnComboBoxStyle">
    <Setter Property="IsEnabled" 
            Value="{Binding IsReadOnly, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGridCell}}, Converter={StaticResource BooleanOppositeConverter}}"/>
</Style> 
```

DataGridCell.IsReadOnly 应该从其 DataGridColumn.IsReadOnly 中获取值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:16:38.420

将列创建为资源可能会奏效，这样您就可以使用`StaticResource`它来定位它。例如

```
<DataGrid.Resources>
    <DataGridTemplateColumn x:Key="Column" .../>
</DataGrid.Resources>
<DataGrid.Columns>
    <StaticResource ResourceKey="Column"/>
</DataGrid.Columns> 
```

```
{Binding IsReadOnly, Source={StaticResource Column}} 
```

* * *

正如评论中提到的`Binding.Source`，[`x:Reference`](http://msdn.microsoft.com/en-us/library/ee795380.aspx)通过列的名称也可能会起作用，具体取决于结构。如果您可以将带有引用的部分移动到被引用元素的资源中，您通常可以摆脱循环依赖错误。您只需要在需要`StaticResource`该部分的地方使用扩展程序，并不太方便。**

# mysql - MySql - 使用来自同一个表的选择语句更新表

> ID：10402678
> 
> 赞同：42
> 
> 时间：2012-05-01T18:56:20.763
> 
> 标签：mysql

我正在尝试使用同一表中不同行（和不同列）中的值更新表中的行。与此类似，尽管我的语法没有产生任何结果：这是代码（更新）：

```
UPDATE table1 AS t1 INNER JOIN
(SELECT field_id_46,field_id_47 FROM table1 WHERE entry_id = 36) AS t2
SET t1.field_id_60 = t2.field_id_46, t1.field_id_61 = t2.field_id_47
WHERE t1.entry_id = 45; 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-05-01T19:25:18.733

```
update table as t1
inner join (
select field_id_46,field_id_47 from table where entry_id = 36) as t2
set t1.field_id_60 = t2.field_id_46,
    t1.field_id_61 = t2.field_id_47
where t1.entry_id = 45 
```

或者，简单地说

```
update table as t1,
(
select field_id_46,field_id_47 from table where entry_id = 36) as t2
set t1.field_id_60 = t2.field_id_46,
    t1.field_id_61 = t2.field_id_47
where t1.entry_id = 45 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-01-27T12:32:12.043

添加..

相同的表，具有多个寄存器

```
UPDATE table t1
INNER JOIN table t2 ON t2.entry_id = t1.entry_id
SET t1.field_id_60 = t2.field_id_60,
    t1.field_id_61 = t2.field_id_61 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-02-07T07:55:46.763

您可以使用内部联接进行更新，如下所示：

```
UPDATE table1 AS t1 
    INNER JOIN table1 AS t2 
    SET t1.field_id_60 = t2.field_id_46, 
        t1.field_id_61 = t2.field_id_47 
WHERE t1.entry_id = 54; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-22T11:39:21.547

我发现这个问题非常有用，因为我试图在特定数据库使用 hibernate_sequence 表时手动插入表。我使用这个问题的解决方案来修改我的导入脚本。我有一个脚本，其中一个接一个地包含许多“插入”语句，我必须手动设置 id。例如：

```
insert into T01_REGIONS (ID, NAME) VALUES ({the next id from hibernate_sequence}, 'name1');
insert into T01_REGIONS (ID, NAME) VALUES ({the next id from hibernate_sequence}, 'name2');
..
. 
```

所以我做的是以下解决我的问题：

```
insert into T01_REGIONS (ID, NAME) VALUES ((select next_val from hibernate_sequence limit 1), 'name1');update hibernate_sequence as t1, (select next_val+1 as next from hibernate_sequence limit 1) as t2 set t1.next_val = t2.next;
insert into T01_REGIONS (ID, NAME) VALUES ((select next_val from hibernate_sequence limit 1), 'name2');update hibernate_sequence as t1, (select next_val+1 as next from hibernate_sequence limit 1) as t2 set t1.next_val = t2.next;
..
. 
```

在我的 sql 脚本的每一行末尾添加额外的查询很容易使用 notepad++。我知道这可能非常难看，但它确实对我有用，以便在我的数据来自 oracle hibernate 操作的数据库时将数据导入到测试 hibernate 操作的 mysql 数据库。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-01T19:01:34.757

你不需要这个查询

```
SELECT field_id_46,field_id_47 FROM table WHERE entry_id = '36' 
```

你应该这样做：

```
UPDATE table SET (field_id_60,field_id_61) ('coming_value','other_value') WHERE entry_id = '45'; 
```

您也可以使用 2 个不同的列来执行此操作。我认为您可以这样做。但我可能不知道。您应该使用哪种语言拆分此查询。在第一种方法中，您应该使用此查询。

```
SELECT field_id_46,field_id_47 FROM table WHERE entry_id = '36' 
```

您还可以返回来自此数据的字符串。然后您可以在更新函数中使用此返回值。

# vim - 围绕文本创建表格

> ID：10402680
> 
> 赞同：4
> 
> 时间：2012-05-01T18:56:24.083
> 
> 标签：vim, plugins, tabular

我有一个单词列表，每个单词都在自己的行中。这是表格的第一列。我想手动创建第二列。

我现在想使用一些插件，它将在文本周围创建一个 ASCII 表，所以我有很好的格式（每列中的起始字母应该在一个“垂直线”中，或者我应该能够快速移动到一个快捷方式的正确位置）。

是否有这样的 vim 插件可以简化编辑此类表格并控制格式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T19:35:23.093

如果您只想将文本对齐到表格格式，我使用它并且效果很好：

[http://www.vim.org/scripts/script.php?script_id=294](http://www.vim.org/scripts/script.php?script_id=294)

几年前我写了一个[命令行工具，它更接近你想要的：](http://pastebin.com/BarvM7DQ)

它允许您以 CSV 格式编辑表格：

```
1,my table,another field
2,my table,yet another field 
```

然后在 vim 中选择块，并使用以下方法对其进行过滤：

```
'<,'>!~/scripts/tab 
```

这会给你：

```
------------------------------------
| 1 | my table | another field     |
| 2 | my table | yet another field |
------------------------------------ 
```

如果您想再次编辑表格，您可以选择整个表格并重复`untab`（这只是一个符号链接 - > 选项卡），这会将表格再次转换回 CSV，以便您可以编辑。

还有其他各种选择：

```
-------------------------------------------------------------------------
| Command/Option | Purpose                                              |
|----------------|------------------------------------------------------|
| tab            | Reads from stdin and tabulates comma seperated input |
| tab <-t>       | Tabulates input and assumes first row are titles     |
| tab <-h>       | Prints this help                                     |
| tab <-nb>      | Tabulates without a border                           |
| tab <-fw X>    | Wrap fields greater than X big don't break words     |
| tab <-fs X>    | Wrap fields greater than X big and break words       |
| tab <-vp X>    | Vertically pad table by X lines                      |
| tab <-hp X>    | Horizontally pad fields by X chars                   |
| tab <-b X>     | Tabulates with a border made from char X             |
|----------------|------------------------------------------------------|
| untab          | Reads from stdin and untabulates table input         |
| untab <-b X>   | Untabulate a table with border char X                |
| untab <-nb>    | Untabulate a borderless table                        |
------------------------------------------------------------------------- 
```

# android - 如何有 LED 灯通知？

> ID：10402686
> 
> 赞同：23
> 
> 时间：2012-05-01T18:56:49.757
> 
> 标签：android

更新：我正在修改原始帖子以实现 Android 3.0 之前的兼容性。

我正在尝试创建一个简单的通知，除了灯光之外的一切都很好。当通知触发时，我确实关闭了屏幕。在 Android 4.0 (Galaxy Nexus) 和 Android 2.3 (HTC EVO) 上使用此已弃用的代码声音和振动。

*   在 2.3 HTC EVO 上，灯也可以工作。
*   在 4.0 Galaxy Nexus 上，灯不工作。

    ```
    Notification notification = 
            new Notification(R.drawable.ic_launcher, "My Ticker!",System.currentTimeMillis());
    notification.setLatestEventInfo(context, "My Title", "My Message", pendingIntent);
    notification.defaults |= Notification.DEFAULT_SOUND;
    notification.defaults |= Notification.DEFAULT_VIBRATE;

    //notification.defaults |= Notification.DEFAULT_LIGHTS;

    notification.ledARGB = 0xff00ff00;
    notification.ledOnMS = 300;
    notification.ledOffMS = 1000;
    notification.flags |= Notification.FLAG_SHOW_LIGHTS;

    notification.flags |= Notification.FLAG_AUTO_CANCEL; 
    ```

我还尝试了不属于 v4 兼容性库的更新 API，所以我只能在 Galaxy Nexus 上进行测试。振动和声音再次起作用，但灯光不起作用。

```
Notification.Builder builder = new Notification.Builder(context);
        builder.setContentIntent(pendingIntent)
            .setSmallIcon(R.drawable.ic_launcher)
            .setTicker("My Ticker")
            .setWhen(System.currentTimeMillis())
            .setAutoCancel(true)
            .setDefaults(Notification.DEFAULT_VIBRATE | Notification.DEFAULT_SOUND | Notification.FLAG_SHOW_LIGHTS)
            .setLights(0xff00ff00, 300, 100)
            .setContentTitle("My Title 1")
            .setContentText("My Text 1");
        Notification notification = builder.getNotification(); 
```

我现在已经在两部 Galaxy Nexus 手机上进行了测试，但两者都没有。当我运行测试时屏幕关闭，手机上的所有其他应用程序都可以毫无问题地触发灯光。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T19:07:08.640

如果您使用 setDefaults(DEFAULT_LIGHTS) 或 setDefaults(DEFAULT_ALL)，它将忽略 FLAG_SHOW_LIGHTS 和任何对 setLights() 的调用。我发现在我的手机上，默认设置不会点亮任何东西。因此，请勿使用 DEFAULT_ALL 或 DEFAULT_LIGHTS，如有必要，请使用 RGB 颜色……尽管 0xff00ff00 几乎适用于所有情况。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-29T23:07:33.820

LED 在设备关闭时工作（未关闭电源：P）。要测试编写一个简单的应用程序来创建延迟通知，并在延迟期间关闭手机并等待 LED 闪烁。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-10-23T10:42:27.040

今天遇到这个..如果它仍然有用...只有某些具有优先级的通知 - HIGH,MAX 将能够使 LED 发光，而那些具有较低优先级 LOW,MIN 的通知则不应该。添加这个应该使LED发光......

builder.setPriority(Notification.PRIORITY_MAX)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-06-02T20:20:06.983

4 懒惰的人：

```
private void testNotification() {
    Notification.Builder builder = new Notification.Builder(this);
    builder.setSmallIcon(R.drawable.ic_launcher)
        .setPriority(Notification.PRIORITY_HIGH)
        .setOngoing(true);
    builder.setLights(0xff00ff00, 300, 100);
    NotificationManager manager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
    manager.notify(1, builder.build());
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-05T08:15:58.727

如果您想在收到通知时打开屏幕灯，我建议使用`PowerManager`and `WakeLock`。以下是使用上述类打开屏幕的代码：

```
PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE); 
WakeLock wakeLock = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK
                                 | PowerManager.ACQUIRE_CAUSES_WAKEUP
                                 | PowerManager.ON_AFTER_RELEASE, "MyWakeLock");
wakeLock.acquire(); 
```

注意：不要忘记使用 释放wakeLock `wakeLock.release();`，否则屏幕将保持打开状态。

PS用户也可以使用锁定按钮关闭屏幕。我在我的应用程序中做了同样的事情。我没有使用`wakeLock.release();`并将其留给用户关闭屏幕。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-01-09T01:35:21.090

我在下面尝试了我的代码，它对我来说很好。我的手机是 Nexus 6P：

```
mBuilder.setContentTitle("APP_NAME")
                .setContentText(msg)
                .setContentIntent(PendingIntent.getActivity(mCtxt, UUID.randomUUID().hashCode(), new Intent(mCtxt, ReceivePushActivity.class), Notification.FLAG_AUTO_CANCEL))
                .setWhen(System.currentTimeMillis())
                .setPriority(Notification.PRIORITY_DEFAULT)
                .setAutoCancel(true)
                //.setDefaults(Notification.DEFAULT_ALL)
                .setVibrate(new long[] {0, 1000, 200,1000 })
                .setLights(Color.MAGENTA, 500, 500)
                .setSound(RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION))
                .setSmallIcon(R.mipmap.notify_logo);

        Notification ntf = mBuilder.build();
//        ntf.flags = Notification.DEFAULT_ALL;
//        ntf.flags |= Notification.FLAG_ONLY_ALERT_ONCE;
//        ntf.flags |= Notification.FLAG_AUTO_CANCEL;

        mNotificationManager.notify(notifyId, ntf); 
```

只需删除所有“DEFAULT_ALL”设置。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-03-24T11:16:05.027

我也为此奋斗了好多年！Leds 在三星设备上运行良好，但在其他设备上则完全没有运气。不过，我终于找到了解决方案；设置监听器来屏蔽开启和关闭事件：

```
registerReceiver(this.screenOnListener, new IntentFilter("android.intent.action.SCREEN_ON"));
registerReceiver(this.screenOffListener, new IntentFilter("android.intent.action.SCREEN_OFF")); 
```

然后在这些侦听器上添加通知的设置和取消：

```
public class ScreenOffListener extends BroadcastReceiver
{
    public ScreenOffListener() {}

    public void onReceive(Context paramContext, Intent paramIntent)
    {
        Notification notif = new Notification();
        notif.ledARGB = "0xFFFF0000"; // Red
        notif.flags = Notification.FLAG_SHOW_LIGHTS;
        notif.ledOnMS = 200; 
        notif.ledOffMS = 200; 
        nm.notify(NOTIFICATION_ID, notif);
    }
}

public class ScreenOnListener extends BroadcastReceiver
{
    public ScreenOnListener() {}

    public void onReceive(Context paramContext, Intent paramIntent)
    {
        NotificationTest.nm.cancel(NOTIFICATION_ID);
    }
} 
```

现在为我工作。由于某种奇怪的原因，此时需要设置通知，否则 LED 不起作用。通知中的其他所有内容在随时设置时都有效...

注意：至少对于闪烁的 LED，颜色和开/关时间并不真正起作用。它们由 HW 和 LPG（LED 图案生成器）定义，因此当 CPU 或多或少关闭时它们也可以在深度睡眠中工作，因此支持的图案和颜色取决于您拥有的硬件。大多数系统只有一种闪烁模式，并且颜色可能会减少到完全关闭 R、G 和 B（以及组合）。对于完全点亮的 LED，所有颜色似乎都可用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-13T15:25:23.210

```
.SetLights (Color.Red.ToAndroid (), 300, 300) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-02T16:17:46.423

添加默认 Notification.DEFAULT_LIGHTS。

例子：

```
Notification notification = new NotificationCompat.Builder(baseCtx)
            .setSmallIcon(R.mipmap.ic_launcher)
            .setContentTitle(title)
            .setContentText(body)
            .setDefaults(
                      Notification.DEFAULT_SOUND
                    | Notification.DEFAULT_VIBRATE
                    | Notification.DEFAULT_LIGHTS
            )
            .build(); 
```

# facebook - 我如何提取发布到我们页面墙的用户的名称？

> ID：10402687
> 
> 赞同：0
> 
> 时间：2012-05-01T18:57:01.603
> 
> 标签：facebook, facebook-graph-api, rss, facebook-fql

我翻遍了，在这里找不到答案...

我们正在做一个促销赠品，并且有大量的人试图获得免费的东西。我们想做的是让在我们的 facebook 墙上发帖最多的人有更好的获胜机会。

因此，我正在尝试设置一些东西（我猜是使用 Graphs API/FQL），它会提取发布到我们墙上或评论我们其中一篇帖子的人的姓名。如果我能得到这样的列表，我就有足够的 php/mysql 经验，我可以创建代码来将名称与数据库进行比较并加权它们的条目。

有没有人对代码有一个简单的解释来只提取每次发布的人的名字？

非常感谢你的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:19:07.717

使用 FQL，您可以获得在您的页面墙上发布的人的 id：

```
SELECT post_id, actor_id
FROM stream
WHERE source_id = "PAGE_ID" 
```

以及对帖子发表评论的人：

```
SELECT post_id, fromid
FROM comment
WHERE post_id = "POST_ID" 
```

您还应该能够将它们组合起来：

```
SELECT post_id, fromid
FROM comment
WHERE post_id IN (SELECT post_id
                  FROM stream
                  WHERE source_id = "PAGE_ID") 
```

获得 ID 后，您可以简单地查询：[https](https://graph.facebook.com/USER_ID) ://graph.facebook.com/USER_ID并获取用户名。如果您有太多并且不想为每个请求发出请求，您可能需要考虑使用“[批量请求](http://developers.facebook.com/docs/reference/api/batch/)”选项。

# android - Android：如何从资产文件创建 File 对象？

> ID：10402690
> 
> 赞同：23
> 
> 时间：2012-05-01T18:57:06.900
> 
> 标签：android, file, assets

我在资产文件夹中有一个文本文件，我需要将其转换为 File 对象（而不是 InputStream）。当我尝试这个时，我得到“没有这样的文件”异常：

```
String path = "file:///android_asset/datafile.txt";
URL url = new URL(path);
File file = new File(url.toURI());  // Get exception here 
```

我可以修改它以使其正常工作吗？

顺便说一句，我有点尝试“通过示例编写代码”，查看我项目中其他地方的以下代码，它引用了 assets 文件夹中的 HTML 文件

```
public static Dialog doDialog(final Context context) {
WebView wv = new WebView(context);      
wv.loadUrl("file:///android_asset/help/index.html"); 
```

我承认我并不完全理解上述机制，所以我试图做的事情可能行不通。

谢谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-01T19:00:49.827

您不能`File`直接从资产中获取对象，因为资产未存储为文件。您需要将资产复制到文件中，然后`File`在副本中获取对象。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-02-12T14:05:22.733

您不能直接从资产中获取 File 对象。

首先，使用例如[AssetManager#open从您的资产中获取一个 inputStream](http://developer.android.com/reference/android/content/res/AssetManager.html)

然后复制 inputStream ：

```
 public static void writeBytesToFile(InputStream is, File file) throws IOException{
    FileOutputStream fos = null;
    try {   
        byte[] data = new byte[2048];
        int nbread = 0;
        fos = new FileOutputStream(file);
        while((nbread=is.read(data))>-1){
            fos.write(data,0,nbread);               
        }
    }
    catch (Exception ex) {
        logger.error("Exception",ex);
    }
    finally{
        if (fos!=null){
            fos.close();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-11-06T17:00:24.150

代码中缺少此功能。@wadali

```
private void copyFile(InputStream in, OutputStream out) throws IOException {
    byte[] buffer = new byte[1024];
    int read;
    while((read = in.read(buffer)) != -1){
      out.write(buffer, 0, read);
    }
} 
```

来源：[https ://stackoverflow.com/a/4530294/4933464](https://stackoverflow.com/a/4530294/4933464)

# ruby-on-rails-3 - BDD 是规划中型项目的解决方案吗？

> ID：10402692
> 
> 赞同：0
> 
> 时间：2012-05-01T18:57:09.513
> 
> 标签：ruby-on-rails-3, project-management, bdd, project-organization

我正在开始项目编号 8,192。像我的大多数项目一样，它们要么是一次性的项目，要么是因为无聊、时间或缺乏用处而被取消的项目。

但是有一个项目已经搁置了很长时间，我真的很想完成。在我的完美世界里，第一次发布应该需要 3 个月的时间。

无论如何，我最大的问题之一就是将一个大型项目（甚至是中小型项目）分解为可管理的部分。我的错误是总是直接跳到终端上，打开 Textmate 并开始编码。这几乎总是失败。我迷失了`feature creep`，学习新的方法，框架之战等。然后，两个月过去了，没有什么可显示的。

所以我在想BDD（例如`Cucumber`）是否可以解决这个问题？是否可以使用它来确定较大的部分，然后是较小的部分，直到我有一个项目的大部分功能列表。那时，我只是开始编写代码，对吗？

我相信其他开发人员会分享您对解决此问题的建议。

顺便说一句，我正在使用`Rails 3`（有时是帕德里诺）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:58:24.413

在*哪个*轨道上？BDD 不定义轨道——它传达轨道。

BDD*可能*是您拥有（或需要）的唯一要求，但这并不能解决喂养 creaturisms 的问题，除非您有纪律不实施任何不存在规范的东西。

未捕获的功能不会得到实施，期间。如果添加了一个功能，它会获得一个范围，并与其余功能一起优先考虑。它可能会篡夺一些不那么受欢迎的东西，也可能不会。

产品所有者（在这种情况下是您）必须决定在分配的时间内可以实现多少，以及应该实现哪些功能。仍然归结为纪律，但是，您只有一个工具（帮助）确保您实现的内容是您真正想要的。

但是，它不能确保您得到的*只是*您最初想要的——它不能确保在您费心实施的规范之上没有实施其他任何*东西。*

# c# - 如何在 WPF 中 HitTest XAML 3D 对象

> ID：10402695
> 
> 赞同：0
> 
> 时间：2012-05-01T18:57:17.753
> 
> 标签：c#, wpf, 3d, viewport, hittest

我想做的是知道用户是否点击了我的操纵杆的红色按钮。（为此，我绘制了真实的操纵杆图形以保持我们的绘图私密） ![我们的 XAML 3D 操纵杆](../Images/538166536f678389c9ef83423782f90c.png)

这个操纵杆是 XAML 3D。

红色按钮是一个 GeometryModel3D 对象，其 x:Name 为“Geo_Btn_CSS_TAKE”。当我点击操纵杆时，我可以做一个 HitTest，他给了我所有的 GeometryModel3D 对象，但我无法访问 x:Name，所以我不知道女巫是好人...

![我的对象的可视化树](../Images/0073d6e5bdac6ac8dc4262e216d50081.png)

这就是我进行 HitTest 的方式：

```
private void OnTouchMouseDown(EventArgs e)
{
    Viewport3D viewport3D = WtoHitTest((Grid)Parent, e) as Viewport3D; // My own HitTest works well, I get my viewport3D

    Point mouseposition = WtoHelper.GetPositionFromEvent(e, viewport3D); // Get the point if it's a mouse event or touch event
    Point3D testpoint3D = new Point3D(mouseposition.X, mouseposition.Y, 0);
    Vector3D testdirection = new Vector3D(mouseposition.X, mouseposition.Y, 10);
    PointHitTestParameters pointparams = new PointHitTestParameters(mouseposition);
    RayHitTestParameters rayparams = new RayHitTestParameters(testpoint3D, testdirection);

    VisualTreeHelper.HitTest(viewport3D, null, HTResult, pointparams);
}

public HitTestResultBehavior HTResult(System.Windows.Media.HitTestResult rawresult)
{
    RayHitTestResult rayResult = rawresult as RayHitTestResult;

    if (rayResult != null)
    {
        RayMeshGeometry3DHitTestResult rayMeshResult = rayResult as RayMeshGeometry3DHitTestResult;

        if (rayMeshResult != null)
        {
            GeometryModel3D hitgeo = rayMeshResult.ModelHit as GeometryModel3D;

            **// HERE I NEED TO KNOW WHAT IS MY GEOMETRYMODEL3D'S X:NAME**
            // ANY IDEA???
        }
    }
    return HitTestResultBehavior.Continue;
} 
```

我还知道什么：

*   我的 3D 对象没有可以绑定的位置 (x,y)
*   我无法在 Viewport3D 中插入非 3D 元素
*   我无法访问 3D 对象的 x:Name
*   3D 对象与否 FrameworkElement 或 Visual。他们是 Media3D

我这样做的方式，我只需要知道 x:name 即可完成我的实现......如果有人有提示或其他方式，请告诉我。

谢谢

编辑：这是我的 3D 对象的属性： ![在此处输入图像描述](../Images/bf9fe194aab0d334fa9343361ece72d0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:16:22.840

我能想到的一件事会起作用并且对 XAML 友好，那就是在 GeometryModel3D 上定义您自己的附加属性。[在此处](http://msdn.microsoft.com/en-us/library/ms749011.aspx#custom)查看如何创建自定义附加属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-23T21:01:03.463

我知道这是一篇旧帖子，但它的搜索排名很高，我偶然发现了它，因为我正在学习 WPF 3D。解决问题的第二种方法是使用 Helix Toolkit。他们使用 SetName() 和 GetName() 方法扩展 GeometryModel3D。所以你可以给它起个名字，然后在做射线测试的时候你就可以得到这个名字：

```
RayMeshGeometry3DHitTestResult rayHit = hr as RayMeshGeometry3DHitTestResult; //hr is of type HitTestResult
MessageBox.Show("Model found: " + rayHit.ModelHit.GetName()); 
```

当然，这意味着将 Helix Toolkit 添加到组合中，但到目前为止，它在多个方面都是值得的。

# java - 关于如何在 Java 程序中创建用户定义变量的想法？

> ID：10402698
> 
> 赞同：1
> 
> 时间：2012-05-01T18:57:26.103
> 
> 标签：java, variables, user-defined

我是 Stack Exchange 的新手，我已经四处寻找了很长一段时间，没有答案。在我的空闲时间我正在用 Java 创建一个 matlab/like 程序，我注意到我需要创建一种允许用户从程序中创建自己的变量的方法。一个例子是 a = 5 和 b = 3，所以当 a + b = 8 时。我的第一个想法是创建一个文件夹，其中文件可以保存为变量，然后在用户调用特定变量时进行搜索。任何形式的反馈将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T18:59:40.300

只需使用 Map 即可

```
Map<String, Integer> nameToValueMap 
```

*   询问用户名称并将其值放入地图
*   要求用户添加两个变量（比如说 A、B），从地图中获取相关值并对其进行操作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T18:59:47.480

您可以创建[地图](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)

```
 Map<String, Integer> variables = new HashMap<String, Integer>();
    //add a variable
    variables.put("a", 5);
    variables.put("b", 3)'
    //get value of variable
    int a = variables.get("a");
    int b = variables.get("b");
    int output = a + b; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:00:15.113

我建议使用属性文件。[您可以在此处](http://www.exampledepot.com/egs/java.util/props.html)找到更多信息和一些示例。 它们非常易于读写，并允许您自定义变量更改文件的值。它们的优点是您可以将所有变量保存在一个文件中，从而简化您的部署环境。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T19:00:28.613

你最好使用`Map<String,Variable>`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T19:00:30.953

在我看来，您正在尝试用 Java 实现脚本语言。您可以使用其中一种已经可用的语言（例如：[JRuby](http://jruby.org/)或[Javascript ），或者在](http://www.mozilla.org/rhino/)[Groovy](http://groovy.codehaus.org/)中创建您的应用程序。

也可以看看：

[Java 平台](http://jcp.org/en/jsr/detail?id=223)
[脚本 Java 脚本程序员指南](http://docs.oracle.com/javase/6/docs/technotes/guides/scripting/programmer_guide/index.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T19:00:32.733

使用 a`java.util.Map<String, Object>`来存储它们

# .net - .NET WebChannelFactory 服务代理使连接保持打开状态，即使它已被释放

> ID：10402703
> 
> 赞同：2
> 
> 时间：2012-05-01T18:57:55.790
> 
> 标签：.net, wcf, dispose

我有以下代码：

```
using (var fact = new WebChannelFactory<IService<Message>>(binding,
              commsSettings.MessageEndPoint()))
{
    using (IDisposable channel = (IDisposable)fact.CreateChannel())
    {
         service = (IService<Message>)channel;
         service.Create(AlertMessage);
         ((IClientChannel)channel).Close();
    }
    fact.Close();
} 
```

即使我正在处理 WebChannelFactory 和 Channel 本身，它们也会打开连接。我知道这一点，因为在性能测试中，调用在第 10 次调用时开始超时，如果我在命令行中执行 netstat -a，我可以看到在我的本地机器和它自身之间的端口 80 上打开了一大堆套接字。

如何让代理关闭其套接字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T21:34:13.660

问题出在服务器端。每个服务实例都有一个 signal-R 客户端泄漏，它用完了可用的套接字。

发生这种情况时，客户端无法再连接。

提示其他人调试类似的东西：查看您的服务器，看看它是否没有构建某种 WCF 客户端并且没有清理它们。泄露它的症状是在客户端进程终止后，使用 netstat -a 看到的套接字仍保持在 ESTABLISHED 状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:21:55.823

不幸的是，Microsoft 在 WCF 中实现服务代理（`IClientChannel`及其继承者）的方式允许在 Close/Dispose 方法中发生异常。发生这种情况时，您必须调用 Abort 方法来释放非托管资源（在您的情况下为 TCP 套接字）。查看有关此问题的[简短博客文章](http://omaralzabir.com/do-not-use-using-in-wcf-client/)并实现它描述的处置模式而不是`using`语句。

# python - 使用正则表达式从单词列表中查找单词对

> ID：10402708
> 
> 赞同：4
> 
> 时间：2012-05-01T18:58:12.593
> 
> 标签：python, regex

我有一个单词列表，例如：

```
l = """abc
dfg
hij
jih
gfd
cba
cbd
jip
gfe
jiw
cbw""" 
```

我想从这个列表中找到成对的单词，所以第一个单词是：

```
.(.)(.) 
```

第二个词是：

```
\2\1. 
```

所以 \1 和 \2 指的是第一个单词中的字符。

我能想到的最好的正则表达式是：

```
re.findall('(^.(?P<A>.)(?P<B>.)$)(?=.*(^(?P=B)(?P=A).$))', l, re.DOTALL | re.MULTILINE) 
```

但是这个搜索只返回一些对（因为 findall 只返回不重叠的结果......）。然后我想到了使用肯定的lookbehind断言，但它们只能与固定长度的字符串一起使用......

有没有办法用正则表达式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:09:42.340

我怀疑正则表达式是做到这一点的好方法（特别是在 Python 中，你不能像 Perl 那样简单地获得匹配字符串的所有可能方法，所以你必须调用`findall`字符串的所有前缀）。一个直接的替代方案是：

```
words = l.split()
pairs = set(frozenset((w1, w2)) for w1 in words for w2 in words 
                      if w1[1:] == w2[1::-1]) 
```

结果是：

```
>>> map(tuple, pairs)
[('hij', 'jip'), 
 ('abc', 'cbd'), 
 ('dfg', 'gfd'), 
 ('dfg', 'gfe'), 
 ('jiw', 'hij'), 
 ('hij', 'jih'), 
 ('abc', 'cbw'), 
 ('abc', 'cba')] 
```

您还可以通过在第一遍中将单词的前缀保存在字典中，然后在第二遍中建立关联来快速解决这个问题：

```
from collections import defaultdict

prefixes = defaultdict(list)
for w in words:
    prefixes[w[1::-1]].append(w) 
pairs = set(frozenset((w1, w2)) for w1 in words for w2 in prefixes[w1[1:]]) 
```

正则表达式引擎很难超越它的性能。

# php - 将关键字存储在数据库中的好方法是什么？

> ID：10402709
> 
> 赞同：1
> 
> 时间：2012-05-01T18:58:13.477
> 
> 标签：php, mysql, search, autocomplete, keyword

> **可能重复：**
> [使用部分单词的 MySQL 全文搜索](https://stackoverflow.com/questions/2716748/mysql-full-text-search-with-partial-words)

我正在使用 MySQL 的全文搜索的网站（基本上是带有商业列表的目录网站）上有一个搜索功能。没什么花哨的，而且效果很好。

我想要做的是在网站上创建一个自动完成搜索输入，它会在您键入时自动显示关键字。所以如果我输入“plu”，plumbers，plumbing，pluto 等。

为了实现这一点，我是否需要为每个商家信息存储关键字？我见过可以从输入中提取关键字的脚本。或者我可以从数据库中的所有列表中生成关键字吗？不太确定最好的做法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:09:46.313

以下答案向您展示了如何对子字符串进行搜索

[MySQL全文搜索部分单词](https://stackoverflow.com/questions/2716748/mysql-full-text-search-with-partial-words)

```
(MATCH (a.article_name) AGAINST ('MySQL*' IN BOOLEAN MODE)) 
```

根据那个答案，它只支持匹配关键字开头的子查询

# php - 如何修复这个 wamp 服务器，phpmyadmin 页面错误？

> ID：10402713
> 
> 赞同：-1
> 
> 时间：2012-05-01T18:58:33.267
> 
> 标签：php, wampserver

错误 ：

```
The mysqli extension is missing. Please check your PHP configuration. <a href="Documentation.html#faqmysql" target="documentation"><img class="icon" src="./themes/pmahomme/img/b_help.png" width="11" height="11" alt="Documentation" title="Documentation" /></a> 
```

我的错误是。我该如何解决。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:00:05.087

也许您可以尝试[安装](http://www.php.net/manual/en/mysqli.installation.php)mysqli？

# wpf - WPF 和 Win32 消息传递

> ID：10402722
> 
> 赞同：3
> 
> 时间：2012-05-01T18:58:58.400
> 
> 标签：wpf, winapi, messaging

我们在 Win32 中有一个遗留应用程序，我们正在使用 WPF 构建新模块。我们有一种情况，我们需要将在 win32 窗口上调用的特定快捷键消息通知 WPF 窗口。我的问题是，有没有办法处理在 win32 窗口上调用的 WPF 窗口上的键盘消息？如果是这样，我需要做什么才能实现它？

谢谢， 乌布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:14:51.500

你需要的是一个键盘挂钩。钩子可以是全局的或应用程序范围的。在您的具体情况下，我认为应用程序范围就足够了。

所以，你需要的是获取Win32进程的Handle并hook消息来过滤WM_KEYDOWN消息。这是一个例子：

[http://blogs.msdn.com/b/toub/archive/2006/05/03/589423.aspx](http://blogs.msdn.com/b/toub/archive/2006/05/03/589423.aspx)

# ruby-on-rails-3.2 - Rails 3.2：失败的断言唯一性：true

> ID：10402723
> 
> 赞同：1
> 
> 时间：2012-05-01T18:59:07.820
> 
> 标签：ruby-on-rails-3.2

全部，

我在测试模型时遇到问题，我有一个简单的客户表，它使用以下字段：名称：字符串、位置：字符串、全名：字符串、活动：布尔值。我将 full_name 字段用作包含以下“#{name} #{location}”的隐藏字段，并在 full_name 字段上测试记录的唯一性。

测试“如果没有唯一的全名，客户无效”是我遇到问题的测试，我正在尝试测试重复记录的插入。如果我删除 assert !customer.save 前面的 bang(!) 测试将通过。这就像在运行测试之前没有将固定装置加载到表中一样，我正在运行 rake test:units。我尝试在开发模式下运行服务器并使用脚手架插入两条记录，第二次插入失败并报告错误“全名已被采用”，这是预期的行为。

谁能给我一些关于我在哪里搞砸测试的指导！

提前致谢

回退

* * *

模型：

```
class Customer < ActiveRecord::Base
  attr_accessible :active, :full_name, :location, :name

  validates :active, :location, :name, presence: true
  validates :full_name, uniqueness: true              # case I am trying to test

  before_validation :build_full_name

  def build_full_name
    self.full_name = "#{name} #{location}"
  end

end 
```

* * *

测试夹具customers.yml

```
one:
  name: MyString
  location: MyString
  full_name: MyString
  active: false

two:
  name: MyString
  location: MyString
  full_name: MyString
  active: false

general:
  name: 'Whoever'
  location: 'Any Where'
  full_name: ''
  active: true 
```

* * *

测试单元助手 customer_test.rb

```
require 'test_helper'

class CustomerTest < ActiveSupport::TestCase
  # test "the truth" do
  #   assert true 
  # end

  fixtures :customers

  # Test fields have to be present
  test "customer fields must not be empty" do
    customer = Customer.new
    assert customer.invalid?
    assert customer.errors[:name].any?
    assert customer.errors[:location].any?
    assert_equal " ", customer.full_name     # This is processed by a helper function in the model
    assert customer.errors[:active].any?
  end

  # Test full_name field is unique
  test "customer is not valid without a unique full_name" do
    customer = Customer.new(
    name: customers(:general).name,
    location: customers(:general).location,
    full_name: customers(:general).full_name,
    active: customers(:general).active
    )

    assert !customer.save   # this is the line that fails
    assert_equal "has already been taken", customer.errors[:full_name].join(', ')
  end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T15:46:20.017

我在夹具customers.yml中发现了问题：

我假设夹具将通过模型进行处理，并且在将数据插入测试数据库之前会调用 build_full_name 帮助程序。情况似乎并非如此。

我改变了夹具如下，它纠正了问题：

```
one:
 name: MyString
 location: MyString
 full_name: MyString
 active: false

two:
 name: MyString2         # changed for consistency, was not the problem
 location: MyString2
 full_name: MyString2
 active: false

general:
 name: 'Whoever'
 location: 'Any Where'
 full_name: 'Whoever Any Where'  #Here was the problem
 active: true 
```

# internet-explorer - jQuery Cycle Plugin Pager 和 IE7 和 8 有一个奇怪的问题

> ID：10402729
> 
> 赞同：1
> 
> 时间：2012-05-01T18:59:35.827
> 
> 标签：internet-explorer, jquery-plugins, jquery-cycle

我正在使用 Cycle 插件构建一个站点，并使用缩略图作为寻呼机。它在 Firefox、Chrome 和 IE9 中运行良好。在 IE8 和 7 中，虽然我有一个非常奇怪的问题。

寻呼机和幻灯片的第一张图片加载正常。当我单击第二个缩略图以加载第二个图像时，幻灯片变为白色（看起来好像它没有加载图像或尝试加载无法完全确定的图像），当我单击第三个缩略图时加载幻灯片中的第二张图像。这种不加载图像然后加载错误图像的模式在整个幻灯片中继续存在。

这是实际的 jQuery：

```
$(document).ready(function() {
    $('#gallery').cycle({
        fx: 'scrollHorz',
        speed: 500,
        timeout: 0,
        pager: '#slide_navigation',
        pagerAnchorBuilder: function(idx, slide) {
            return '#slide_navigation li:eq(' + idx + ') a';
        }
    });
    $("#left").click(function() {
        $("#slide_navigation").animate({"marginLeft": "+=960px"}, "slow");
        $("#left").hide();
        $("#right").show();
    });
    $("#right").click(function() {
        $("#slide_navigation").animate({"marginLeft": "-=960px"}, "slow");
        $("#right").hide();
        $("#left").show();
    }); 
```

这是页面的CSS：

```
#slide_navigation {
    width: 2000px;
    padding: 10px 0;
    border:  1px #909090;
    border-style: solid none;
}
#slide_navigation li {
    list-style: none;
    display: inline;
    margin: 5px;
    padding: 52px 3px 0px 3px;
}
#slide_navigation li:first-child {
    margin-left: 25px;
}
#slide_navigation li.activeSlide {
    background: #F68009;
}
#left {
    width: 20px;
    height: 75px;
    float: left;
    background: #FFFFFF url(prev1.png) no-repeat center;
    position: relative;
    top: -85px;
    left: -3px;
    margin-bottom: -85px;
    display: none;
}
#right {
    width: 20px;
    height: 75px;
    float: right;
    background: #FFFFFF url(next1.png) no-repeat center;
    position: relative;
    top: -85px;
    right: -3px;
    margin-bottom: -85px;
} 
```

以防万一 - 他是寻呼机的 HTML：

```
<div id="slide_navigation">
    <li><a href="#"><img src=support-1.jpg></a></li>
    <li><a href="#"><img src=support-2.jpg></a></li>
    <li><a href="#"><img src=support-3.jpg></a></li>
    <li><a href="#"><img src=support-4.jpg></a></li>
    <li><a href="#"><img src=support-5.jpg></a></li>
    <li><a href="#"><img src=support-6.jpg></a></li>
    <li><a href="#"><img src=support-7.jpg></a></li>
    <li><a href="#"><img src=support-8.jpg></a></li>
    <li><a href="#"><img src=support-9.jpg></a></li>
    <li><a href="#"><img src=support-10.jpg></a></li>
    <li><a href="#"><img src=support-11.jpg></a></li>
    <li><a href="#"><img src=support-12.jpg></a></li>
    <li><a href="#"><img src=support-13.jpg></a></li>
    <li><a href="#"><img src=support-14.jpg></a></li>
    <li><a href="#"><img src=support-15.jpg></a></li>
    <li><a href="#"><img src=support-16.jpg></a></li>
</div>
<div id="left" class="cursorPointer"></div>
<div id="right" class="cursorPointer"></div> 
```

左右 id 用于帮助导航滑块。不要认为它是相关的，但会提供尽可能多的信息。任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:31:47.807

你有一些不匹配的标签结尾。请注意，关闭`</a>`没有相应的`<a>`开始标签。提供开始标签，它似乎工作得很好。

```
<div id="gallery">
    <img src=http://www.howie23.org/rp-help/1.jpg></a>
    <img src=http://www.howie23.org/rp-help/2.jpg></a>
    <img src=http://www.howie23.org/rp-help/3.jpg></a>
    <img src=http://www.howie23.org/rp-help/4.jpg></a>
    <img src=http://www.howie23.org/rp-help/5.jpg></a>
    <img src=http://www.howie23.org/rp-help/6.jpg></a>
    <img src=http://www.howie23.org/rp-help/7.jpg></a>
    <img src=http://www.howie23.org/rp-help/8.jpg></a>
</div> 
```

补丁演示：http: [//jsbin.com/ukizac/3/edit#preview](http://jsbin.com/ukizac/3/edit#preview)

# php - 在php中将对象推送到数组时，所有对象都是相同的

> ID：10402731
> 
> 赞同：4
> 
> 时间：2012-05-01T18:59:38.310
> 
> 标签：php, arrays, json, object

我想将许多对象推入一个数组

每个对象都有不同的价值

但是当我将它们推入数组时

它们的所有值都相同

如何解决这个问题呢？

```
$sql="select password, mail from account";
$result=mysql_query($sql);
$arr=array();
while($row=mysql_fetch_assoc($result))
{
    $o->pw=$row['password'];
    $o->mail=$row['mail'];
    array_push($arr, $o);
}
echo json_encode($arr); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T19:04:00.357

那是因为您每次都将同一个对象推入数组。

您应该在每次迭代中推送一个新对象。例如，如果`$o`是一个`stdClass`对象，`$o = new stdClass`在循环内使用：

```
while($row=mysql_fetch_assoc($result))
{
    $o = new stdClass;
    $o->pw=$row['password'];
    $o->mail=$row['mail'];
    array_push($arr, $o);
} 
```

您也可以使用[`mysql_fetch_object`](http://php.net/manual/en/function.mysql-fetch-object.php)，这可能更合适：

```
while($o=mysql_fetch_object($result))
{
    array_push($arr, $o);
} 
```

上述对象的属性将根据您的 SQL 查询列命名，因此要达到相同的效果，您还需要将查询更改为`select password AS pw, mail from account`.

最后，另一种选择是每次都[克隆对象——尽管其他选择几乎总是更可取的：](http://php.net/manual/en/language.oop5.cloning.php)

```
while($row=mysql_fetch_assoc($result))
{
    $o = clone $o;
    $o->pw=$row['password'];
    $o->mail=$row['mail'];
    array_push($arr, $o);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T19:02:37.440

尝试先声明 $o（在 while 循环内）：

```
$o = new stdClass; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T19:06:15.973

这是因为对象被添加到数组中作为参考。数组中的每个元素都是对一个对象的引用，同一个对象。

您没有声明`$o`，所以当您第一次声明时`$o->pw`，PHP 会为您创建一个对象。当它这样做时，它会在循环范围之外创建它，因此循环的每次迭代都引用相同的`$o`.

您需要声明`$o`每个循环迭代。

```
while($row=mysql_fetch_assoc($result))
{
    $o = new stdClass;
    $o->pw = $row['password'];
    $o->mail = $row['mail'];
    array_push($arr, $o);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T19:05:24.287

你真的不需要在php中使用太多push，你可以使用空括号来附加它。不确定它是否有所作为，但我发现括号更容易。此外，此代码中似乎没有定义 O，也没有在循环中重置。这可能就是问题所在，尽管我对你的问题总体上不是很清楚。祝你好运

```
$sql="select password, mail from account";
$result=mysql_query($sql);
$arr=array();
while($row=mysql_fetch_assoc($result))
{
    //define/reset o here
    $o->pw=$row['password'];
    $o->mail=$row['mail'];
    $arr[] = $o;
}
echo json_encode($arr); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T19:08:50.203

我认为您需要为循环的每次迭代实例化一个新对象。现在，对于循环的每次迭代，只有一个 $o 被写入，这就是为什么它们看起来都具有相同的值：它们是相同的。

试试这个：

```
while($row=mysql_fetch_assoc($result))
{
    $o = new stdClass();
    $o->pw=$row['password'];
    $o->mail=$row['mail'];
    array_push($arr, $o);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-26T05:09:31.620

```
$sql="select password, mail from account"; 
$result=mysql_query($sql);
$data = [];
while($row=mysql_fetch_assoc($result)){
array_push($data, ['password' => $row['password'],
           'mail' => $row['mail'],]);
}
header('Content-Type: application/json');
$encode_data = json_encode($data);
echo $encode_data; 
```

# animation - Raphael 对象上的同步动画 - 最后一个动画覆盖对象的先前动画

> ID：10402732
> 
> 赞同：4
> 
> 时间：2012-05-01T18:59:38.790
> 
> 标签：animation, raphael

我正在尝试同时旋转和旋转 Raphael 形状。这是我尝试过的（100,100 是画布的中心）：

```
var revolve = Raphael.animation({transform: 'r360,100,100'},1000,"easein")
var rotate = Raphael.animation({transform: 'r360'},1000,"linear")
var ec = paper.ellipse(100,50,10,5).attr({
    fill: 'none',
    stroke: 'blue'
}) 
```

以及我尝试调用动画的各种方式，每种方式都会产生所描述的结果：

1.  第二个动画覆盖第一个：

    ```
    ec.animate(revolve).animate(rotate) 
    ```

2.  工作正常，但有一些问题（下面提到）：

    ```
    ec.animate({
        transform: 'r360,100,100r360'
    }, 1000, "easein") 
    ```

3.  第二个动画再次覆盖第一个动画：

    ```
    ec.animate({
        transform: 'r360,100,100'
    }, 1000, "easein")
    .animate({
        transform: 'r360'
    }, 1000, "easein") 
    ```

***第二种变体的问题是我不能分别改变旋转和旋转的缓动功能。此外，`transform:'...r360'`它不起作用（覆盖第一个动画）。

这是一个[关于 jsFiddle 的工作演示，](http://jsfiddle.net/YFhZD/)供您使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T21:23:07.127

显然，没有办法实现这一点。为了证明这一点，您可以在第二个使用延迟的同时链接两个动画，并以 1000 左右（上下）的各种值传递它。你会看到动画渲染器是串行的：

```
ec.animate(revolve)
ec.animate(rotate.delay(/*200*/1000)); 
```

为了让它们同时工作，您必须将两个转换放入一个转换字符串并将其传递给单个动画对象，就像您在尝试的第二个变体中所做的那样（似乎没有真正的问题除了为每个动画定义不同缓动的限制）：

```
var revolveAndRotate = Raphael.animation({
    transform: 'r360,100,100r360'
}, 1000, "easein")

ec.animate(revolveAndRotate);​ 
```

​​​​这里是[更新的jsFiddle](http://jsfiddle.net/eliranmal/YFhZD/3/)来演示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T10:36:07.330

这是[你](http://jsfiddle.net/amadanNM/tvC2E/)要找的吗？我在旋转动画中添加了第二个旋转，向相反方向旋转 360 度。第二个动画，旋转，已过时。

```
var revolve = Raphael.animation({transform:'r360,100,100 r-360'},1000,"easein") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T12:57:46.680

有一种很好的方法可以做到这一点，甚至远远落后于它。

请记住，拉斐尔是关于路径和层次结构的。至于 3D 软件，它的全部目的是保持最高层次的层次结构，并遵循路径，以便尽可能地拥有最复杂的动画，并为每个层次结构层次保留一个“变换”功能。

为了实现这种链式动画，并保持第一个层级动画（变换）作为第一个动画层级，3D 世界中使用的一个好技巧是使用路径“假人”。

**在您的情况下，实现旋转的虚拟对象是半径为零的圆形路径。**

*   级别 1：椭圆有自己的变换动画。
*   2级：椭圆围绕半径为零的圆形路径旋转360度（使其围绕自己旋转）+假人可以有自己的变换。
*   3级：假人使用revolve函数或路径跟随另一个半径为100的圆形假人路径（和他自己的变换）

除了使用过渡字符串作为中间层级之外，“假人”作为路径，将允许您随意链接任何类型的动画，为每个层级保留 1 个原始转换函数。

半径为零的圆形路径是 3D 世界中最常用的虚拟对象。

将假人动画链接起来后，使用每个假人的计时功能触发每个动画。在关键帧软件中以完全相同的方式完成。

# oauth - oAuth 实施：当前域重要吗？

> ID：10402739
> 
> 赞同：3
> 
> 时间：2012-05-01T18:59:52.073
> 
> 标签：oauth

我是一名前端开发人员，帮助 UX 团队开发浏览器插件的界面。

该插件基于 HTML/CSS/JS，需要身份验证。目前我们在线路中有标准的 u/p 字段，但客户想知道是否可以进行社交登录。

由于插件的接口被注入到用户访问的每个页面中，这意味着身份验证请求可以来自网络上的任何地方。

我已经阅读了 oAuth 规范的基础知识，但我找不到答案——oAuth 不需要来自一致位置的请求似乎很奇怪，但我真的不知道我在说什么关于。

从任何随机域发出 oAuth 请求是否可行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T09:16:00.583

> 请求来自一致的位置

可以提出与 X 的消费者密钥一致的令牌的人被假定为 X。有[一个地方](http://oauth.net/core/1.0a/#auth_step1)可以要求消费者（您的服务）的 URL：

> **oauth_callback：** 当获取用户授权步骤完成时，服务提供者将用户重定向回的绝对 URL。如果 Consumer 无法接收回调或通过其他方式建立了回调 URL，则参数值必须设置为 oob（区分大小写），以指示带外配置。

但是重定向发生在客户端。可以为**每个**请求设置此 URL。您甚至不需要浏览器请求：查看**“带外”(OOB)**内容。

该工作流称为两足 OAuth。

[Twitter oAuth callbackUrl - 本地主机开发](https://stackoverflow.com/questions/800827/twitter-oauth-callbackurl-localhost-development)

* * *

而那个麻烦只是为了认证。一旦您获得了用户的访问令牌，您就可以在任何设备上代表他行事：智能手机、集群中的节点、开发工作站等。 x

# php - 使用 ajax 将 textarea 信息存储到数据库中。除非我以任何方式编辑 textarea，否则工作正常。信息仍然被存储，但 XMLHTTP 永远不会关闭

> ID：10402746
> 
> 赞同：1
> 
> 时间：2012-05-01T19:00:23.280
> 
> 标签：php, javascript, ajax, xmlhttprequest, textarea

基本上，当用户单击保存时，我会调用一个函数，该函数从 textarea 获取内容并将其传递给一个 php 文件，该文件将其添加到数据库中。我使用了一些 js 函数，一个用于在内容之间切换，另一个用于保存它。无论如何，如果我只是单击保存而不在 textarea 中编辑任何内容，那么一切正常。但是，如果我以任何方式编辑文本（即使删除一个字母并再次添加它），部分功能将停止工作。负责修改内容的部分。我已经标记了停止工作的部分。

我已经测试过它是否是我传递的内容.. 不是。现在似乎 textarea 本身搞砸了，不会显示新信息。我通过放置 2 个文本区域对其进行了测试，一个包含要存储和编辑的内容，另一个仅用于显示更改（停止在主文本区域上工作的更改）。

```
function saveContent() {
    document.getElementById("editing").style.display = 'none';
    document.getElementById("observing").style.display = '';
    document.getElementById("contentArea").readOnly = true;

    if (window.XMLHttpRequest) // code for IE7+, Firefox, Chrome, Opera, Safari
    {
        xmlhttp = new XMLHttpRequest();
        alert("first if");
    }
    else // code for IE6, IE5
    {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        //alert("second if");
    }
    xmlhttp.onreadystatechange = function() {
        //alert(xmlhttp.readyState+" : "+xmlhttp.status);
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            alert("finished");
            document.getElementById("contentArea").innerHTML = "working"; < ---- * * THIS PART STOPS WORKING IF I MODIFY THE TEXTAREA IN ANY WAY * *
        }
    }
    //var Content = document.getElementById("contentArea");
    var content = "contenttt";
    //alert(content);
    xmlhttp.open("get", "saveContent.php?q=" + content_id + "&content=" + content, true);
    xmlhttp.send(null);
}​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:20:10.703

如果给出的评论不能解决您的问题，请提出一些建议。

首先，问题可能是您使用大写 C 的内容变量，或者就在这里。但我知道 chrome 往往会用未定义的变量搞乱 ajax 调用。

```
//var Content = document.getElementById("contentArea");
var content = "contenttt"; 
```

其次，在 POST 中发送文本变量。

```
xmlhttp.Open("POST","saveContent.php?q=" + content_id, false);
xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
xmlhttp.send("content=" + content); 
```

最后，考虑使用**JQuery**。它如此受欢迎是有原因的。它易于使用，很少发生此类问题，并且适用于所有已知的浏览器。

```
$.post('saveContent.php', {"q": content_id, "content": $('#contentArea').val()}, function(data){
    alert(data);
}); 
```

# continuous-integration - 詹金斯大师可以在远程詹金斯上运行作业吗？

> ID：10402753
> 
> 赞同：13
> 
> 时间：2012-05-01T19:00:37.730
> 
> 标签：continuous-integration, jenkins, cruisecontrol.net

我们从 CruiseControl.NET 迁移到 Jenkins 只是为了与合作伙伴同步，因此我们没有两个不同的 CI 脚本。我们正在尝试设置 Jenkins 来执行类似于 CruiseControl 所做的事情，即在远程构建机器上使用集中式服务器调用项目（jenkins 中的作业）。

我们有多个构建机器与单个项目相关联，因此当我们从集中式 CI 服务器构建项目时，它将调用远程 CI 服务器上的项目。远程 CI 服务器将从集中式 CI 服务器项目中提取版本。

在 CruiseCruise 控件中，我们设置了一个可以`forceBuild`在远程项目上执行的项目。构建机器上的项目使用 a`remoteProjectLabeller`来检索版本号，因此它们始终保持同步。

要检索主版本号：

```
<labeller type="remoteProjectLabeller">
  <project>MainProject</project>
  <serverUri>tcp://central-server:21234/CruiseManager.rem</serverUri>
</labeller> 
```

调用远程项目：

```
<forcebuild>
    <project>RemoteBuildMachineA</project>
    <serverUri>tcp://remote-server:21234/CruiseManager.rem</serverUri>
    <integrationStatus>Success</integrationStatus>
</forcebuild> 
```

到目前为止，在 jenkins 中，我已经使用 java web start 将辅助服务器设置为从属服务器，但我不知道如何让 jenkins 主服务器调用从属服务器上的项目设置。

我可以设置 Jenkins 在从站上调用项目（作业）吗？

我可以让奴隶从主人那里拉取版本号吗？

**编辑 -**

让我添加更多信息。

*   主机和远程构建机器从机都在运行 Windows。
*   我们让中央主控 CruiseControl 同时启动远程项目，因此它们同时运行，并且如果可能的话，希望与 jenkins 有同样的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T19:11:18.870

Jenkins 有[构建代理](https://wiki.jenkins-ci.org/display/JENKINS/Distributed+builds)的概念，它可能更适合您的场景 - 有一个触发构建的主服务器和执行它的从服务器。然后可以将构建仅限于某些类别的从属（例如，如果它依赖于特定软件，而不存在于所有代理上）。所有数据都由主人集中管理，我相信这就是你想要实现的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T21:53:47.187

在 Jenkins 中，不可能在从属设备上触发构建，即构建运行的位置不受触发它的控制。它由作业本身的设置控制。每个作业都有一个名为“限制此作业可以运行的位置”的设置。

在您的情况下，您可能有两个工作：A 和 B。A 将被限制在“master”上运行，而 B 将被配置为在“slavename”上运行。那么剩下要做的就是让A触发B。

但是您还有更多限制：您希望 A 和 B 从版本控制中签出相同的版本，并且您希望 A 和 B 并行运行。有很多方法可以做到这一点，但最简单的可能是定义一个多配置作业。

没有办法将现有的自由式工作转变为多配置工作，因此您将不得不做一份新工作。

*   选择新工作
*   选择构建新的多配置项目。添加名称。
*   在配置矩阵下，打开“添加轴”下拉菜单。
*   选择奴隶
*   检查主从
*   添加 SCM 信息和构建步骤

当作业运行时，它同时在主服务器和从服务器上运行。Jenkins 确保它们从相同的源版本构建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:25:21.813

从 /jenkins/computer url，您可以添加、删除和重新配置作为本地或远程“构建代理”的“节点”。

然后可以限制作业在特定构建代理上运行，或遵循各种规则从可用代理中选择适当的构建代理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-06T21:38:15.630

我在想 Jenkins 太像 CruiseControl，它的工作是在远程机器上定义的。所以在 Jenkins 中，远程项目是在主服务器上定义的，并通过代理委托给远程机器。

我使用作为 Windows 服务安装在远程机器上的 Java Web Start 代理。为了让特定的作业在特定的远程机器上运行，我在其从属配置中定义了具有唯一标签的每个远程节点。为了将特定的作业绑定到特定的从站，我在每个作业配置中使用了从站的标签（“限制该项目可以在哪里运行”）。

为了使用单个主作业触发作业，我创建了一个自由样式作业，该作业仅设置为“构建其他项目”，并提供了一个逗号分隔的列表或项目名称。该作业并行构建下游作业。

我仍在寻找一种将主版本号发送到下游作业以使它们始终保持同步的方法。（这用于版本 DLL 等。）

# wcf - 我可以从同一个类中引用 DataContract 及其代理版本吗

> ID：10402766
> 
> 赞同：0
> 
> 时间：2012-05-01T19:01:54.303
> 
> 标签：wcf, c#-4.0

我正在涉足 WCF 并尝试制作一个简单的测试项目，该项目既可以将服务作为服务使用，也可以直接实例化它的类并使用它们。

我有一个较早的工作版本，其中传递的数据只是原始类型。但是，当我尝试转换为使用数据合约时，无论是引用代理声明的合约版本还是项目本身的版本，我都会遇到冲突。

**问题：** 是否可以这样做，如果可以，我将如何解决数据合同引用？

```
 private void Test()
    {

        MyService fssDirect = new MyService();    // direct instantiation
        MyServiceClient fssService = new MyServiceClient();    // Service proxy

        ClientCredentialsContract Client = new ClientCredentialsContract();
        ResponseDataContract Result = new ResponseDataContract();

        if (CallAsService)
        {
            Result = fssService.Create(Client, Request);
        }
        else
        {
            Result = fssDirect.Create(Client, Request);
        }
    } 
```

在上面，对 RequestDataContract 和 ClientCredentialsContract 类型的任何引用都表明

> 警告：“C:...\Test\MyServiceProxy.cs”中的“MyContracts.RequestDataContract”类型与“C:...\MyService\bin\Debug\Contracts.dll”中导入的类型“MyContracts.RequestDataContract”冲突'。使用“C:...\Test\MyServiceProxy.cs”中定义的类型。

（更改名称并缩短路径以保护无辜者）

谢谢，

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:10:50.207

当您为您的服务创建代理时，请尝试引用包含数据协定的程序集（如果使用“添加服务引用”，请转到高级选项，选择“在引用的程序集中重用类型”；如果使用 svcutil，请使用`/r`参数） . 这样，该工具将不会生成数据合同，您也不会遇到冲突。

# events - _trackEvent 使用哪个值来监控留存/群组？

> ID：10402769
> 
> 赞同：0
> 
> 时间：2012-05-01T19:02:08.623
> 
> 标签：events, google-analytics, tracking

我想监控移动应用程序，基本上是一页应用程序。为此，我将使用 Google Analytics 并为用户交互添加事件。

使用 Google Analytics，您可以将 5 个值发送到 Google Analytics (http://goo.gl/6Gs4b)

*   类别
*   行动
*   标签
*   价值
*   非交互

对于我想要的每个事件，还发送组标识。基本上是第 1 周、第 2 周、第 3 周。

我不确定哪个`_trackEvent`值最适合监控组。不仅可以增加价值，还可以按组进行跟踪并按组查看差异。

所以如果我有：

```
_trackEvent('login', 'success', 'week 1');
_trackEvent('login', 'error', 'week 1'); 
```

我可以监控第 1 周、第 2 周、第 3 周等的登录成功率吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:15:43.830

如果您的应用程序的行为类似于一页，那么将点击配置为虚拟浏览量而不是事件可能是值得的。然后，您不受参数数量的限制。

例子：

`_trackPageview('/login/success/week-1');`

不过，我不确定您所说的“组”是什么意思-也许您会从访问者级别的自定义变量中受益？这将为每个“周”组设置一个 cookie，以便您可以按组细分任何报告。

# c# - 可观察的网络 IO 解析

> ID：10402770
> 
> 赞同：7
> 
> 时间：2012-05-01T19:02:08.910
> 
> 标签：c#, system.reactive

我正在尝试使用 Rx 从 TCPClient 接收流中读取数据并将数据解析为字符串的 IObservable，由换行符“\r\n”分隔以下是我从套接字流接收的方式...

```
var messages = new Subject<string>();

var functionReceiveSocketData =
            Observable.FromAsyncPattern<byte[], int, int, SocketFlags, int>
            (client.Client.BeginReceive, client.Client.EndReceive);

Func<byte[], int, byte[]> copy = (bs, n) =>
        {
            var rs = new byte[buffer.Length];
            bs.CopyTo(rs, 0);
            return rs;
        };

Observable
    .Defer(() =>
            {
                var buffer = new byte[50];
                return
                    from n in functionReceiveSocketData(buffer, 0, buffer.Length, SocketFlags.None)
                select copy(buffer, n);
            }).Repeat().Subscribe(x => messages.OnNext(System.Text.Encoding.UTF8.GetString(x))); 
```

这是我想出的解析字符串的方法。这目前不起作用...

```
obsStrings = messages.Buffer<string,string>(() =>  
                messages.Scan((a, c) => a + c).SkipWhile(a => !a.Contains("\r\n"))
            ); 
```

消息主题以块的形式接收消息，因此我尝试连接它们并测试连接的字符串是否包含换行符，从而指示缓冲区关闭并输出缓冲的块。不知道为什么它不起作用。似乎我只从 obsStrings 中得到第一块。

所以我正在寻找两件事。我想简化 io 流的阅读并消除消息主题的使用。其次，我想让我的字符串解析工作。我已经对此进行了一段时间的破解，但无法提出可行的解决方案。我是 Rx 的初学者。

**编辑：这是问题解决后的成品....**

```
var receivedStrings = socket.ReceiveUntilCompleted(SocketFlags.None)
            .SelectMany(x => System.Text.Encoding.UTF8.GetString(x).ToCharArray())
            .Scan(String.Empty, (a, b) => (a.EndsWith("\r\n") ? "" : a) + b)
            .Where(x => x.EndsWith("\r\n"))
            .Select(buffered => String.Join("", buffered))
            .Select(a => a.Replace("\n", "")); 
```

“ReceiveUntilCompleted”是 RXX 项目的扩展。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T21:22:08.713

```
messages
    .Scan(String.Empty, (a, b) => (a.EndsWith("\r\n") ? "" : a) + b)
    .Where(x => x.EndsWith("\r\n")) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:30:35.520

代替`Subscribe`并使用`Subject`，您可以尝试`Select`：

`.Repeat().Select(x => System.Text.Encoding.UTF8.GetString(x));`

现在假设这一切都进入了一个新的 observable `messages`，你的下一个问题是在这一行

```
var obsStrings = messages.Buffer<string,string>(() =>  
                messages.Scan((a, c) => a + c).SkipWhile(a => !a.Contains("\r\n"))
            ); 
```

您同时使用`Buffer`and `Scan`，并且试图在两者中做同样的事情！请注意，`Buffer`需要一个关闭选择器。

你真正想要的是：

```
var obsStrings = messages.Buffer(() => messages.Where(x => x.Contains("\r\n")))
                         .Select(buffered => String.Join(buffered)); 
```

这为 Buffered 提供了一个关于何时关闭窗口（当它包含 \r\n 时）的可观察值，并为 Select 提供了要连接的缓冲量。这会产生一个新的可观察到的拆分字符串。

一个问题是您仍然可以将新行放在块的中间，这会导致问题。一个简单的想法是观察字符而不是完整的字符串块，例如：

`obsStrings.Repeat().SelectMany(x => System.Text.Encoding.UTF8.GetString(x).ToCharArray().ToObservable());`

然后您可以`messages.Where(c => c != '\r')`跳过`\r`并将缓冲区更改为：

```
var obsStrings = messages.Buffer(() => messages.Where(x => x == '\n')))
                         .Select(buffered => String.Join("", buffered)); 
```

# c#-4.0 - 将 listBox.SelectedItem 转换为 PointF

> ID：10402772
> 
> 赞同：0
> 
> 时间：2012-05-01T19:02:19.537
> 
> 标签：c#-4.0, types, casting, lambda, type-conversion

我的列表框中有一个项目；我想把它转换成 PointF，这样我就可以将它与 pointF 列表进行比较。

示例) var selection = listBox3.SelectedItem ; // 像“{X=18,Y=48.10001}”

PointF p1 = (PointF) 选择；

//现在，当该项目已被选择并转换为浮点数时，我想在名为 optFlowPoints 的列表中搜索并找到它，以查看该点是否存在

PointF drawPointEst=optFlowPonits.Find(p=>p.Equals(selection));

所以有两个问题：

1.  如何将 selectedItem 转换为 PointF
2.  如何编写我的 lambda 表达式来查找匹配项

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T22:07:33.003

如何将 selectedItem 转换为 PointF：

我认为您可以更改填写列表的方式。你试过`listBox3.Items.AddRange(temp.Cast<object>().ToArray());`吗？我认为这应该可行，因为 ListBox 会为您调用 ToString。（请参阅[http://msdn.microsoft.com/en-us/library/z018s5az.aspx](http://msdn.microsoft.com/en-us/library/z018s5az.aspx)）然后，您的 InvalidCastException 应该消失，因为您的 ListBox 现在包含 PointF 对象而不是字符串。

如何编写 lambda 表达式来查找匹配项：

```
PointF drawPointEst = optFlowPoints.Find(p => p == selection); 
```

[http://msdn.microsoft.com/en-us/library/system.drawing.pointf.op_equality.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.pointf.op_equality.aspx)

# c# - 无法使用 REST API 从 skydrive 下载完整的图像文件

> ID：10402773
> 
> 赞同：1
> 
> 时间：2012-05-01T19:02:26.960
> 
> 标签：c#, webresponse, onedrive

我正在为 C# 中的 skydrive API 开发一个快速包装器，但在下载文件时遇到了问题。对于文件的第一部分，一切正常，但随后文件开始出现差异，此后不久一切都变为空。我很确定只是我没有正确读取流。

这是我用来下载文件的代码：

```
public const string ApiVersion = "v5.0";
public const string BaseUrl = "https://apis.live.net/" + ApiVersion + "/";

public SkyDriveFile DownloadFile(SkyDriveFile file)
{
    string uri = BaseUrl + file.ID + "/content";
    byte[] contents = GetResponse(uri);
    file.Contents = contents;
    return file;
}

public byte[] GetResponse(string url)
{
    checkToken();
    Uri requestUri = new Uri(url + "?access_token=" + HttpUtility.UrlEncode(token.AccessToken));
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(requestUri);
    request.Method = WebRequestMethods.Http.Get;
    WebResponse response = request.GetResponse();
    Stream responseStream = response.GetResponseStream();
    byte[] contents = new byte[response.ContentLength];
    responseStream.Read(contents, 0, (int)response.ContentLength);
    return contents;
} 
```

这是我要下载的图像文件

![正确的形象](../Images/dd4f99aa19a54a0799b49ca457e92543.png)

这是我得到的图像

![破碎的图像](../Images/6880da1a865eee42916d158e090f5c5a.png)

这两张图片让我相信我不会等待响应完成，因为内容长度与我期望的图片大小相同，但我不确定如何制作我的代码等待整个响应通过，甚至如果这是我需要采取的方法。

这是我的测试代码，以防万一

```
[TestMethod]
public void CanUploadAndDownloadFile()
{
    var api = GetApi();
    SkyDriveFolder folder = api.CreateFolder(null, "TestFolder", "Test Folder");
    SkyDriveFile file = api.UploadFile(folder, TestImageFile, "TestImage.png");
    file = api.DownloadFile(file);
    api.DeleteFolder(folder);
    byte[] contents = new byte[new FileInfo(TestImageFile).Length];
    using (FileStream fstream = new FileStream(TestImageFile, FileMode.Open))
    {
        fstream.Read(contents, 0, contents.Length);
    }
    using (FileStream fstream = new FileStream(TestImageFile + "2", FileMode.CreateNew))
    {
        fstream.Write(file.Contents, 0, file.Contents.Length);
    }
    Assert.AreEqual(contents.Length, file.Contents.Length);
    bool sameData = true;
    for (int i = 0; i < contents.Length && sameData; i++)
    {
        sameData = contents[i] == file.Contents[i];
    }
    Assert.IsTrue(sameData);
} 
```

它失败了`Assert.IsTrue(sameData);`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:09:12.163

这是因为您没有检查`responseStream.Read(contents, 0, (int)response.ContentLength);`. `Read`不确保它会读取`response.ContentLength`字节。相反，它返回读取的字节数。您可以使用循环或`stream.CopyTo`那里。

像这样的东西：

```
WebResponse response = request.GetResponse();
MemoryStream m = new MemoryStream();
response.GetResponseStream().CopyTo(m);
byte[] contents = m.ToArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:50:51.010

正如 LB 已经说过的，你需要继续调用 Read() 直到你读完整个流。

尽管 Stream.CopyTo 将复制整个流，但它不能确保读取预期的字节数。如果没有读取指定的长度，以下方法将解决此问题并引发 IOException...

```
 public static void Copy(Stream input, Stream output, long length)
    {
        byte[] bytes = new byte[65536];
        long bytesRead = 0;
        int len = 0;
        while (0 != (len = input.Read(bytes, 0, Math.Min(bytes.Length, (int)Math.Min(int.MaxValue, length - bytesRead)))))
        {
            output.Write(bytes, 0, len);
            bytesRead = bytesRead + len;
        }
        output.Flush();
        if (bytesRead != length)
            throw new IOException();
    } 
```

# ruby-on-rails - 在 Rails 的子域之间共享会话（cookie）？

> ID：10402777
> 
> 赞同：96
> 
> 时间：2012-05-01T19:02:40.170
> 
> 标签：ruby-on-rails, session, devise

我有一个应用程序设置，其中每个用户都属于一家公司，并且该公司有一个子域（我使用的是 basecamp 风格的子域）。我面临的问题是 Rails 正在创建多个 cookie（一个用于 lvh.me，另一个用于 subdomain.lvh.me），这导致我的应用程序出现了很多中断（例如，尽管所有请求都存在一次，但闪存消息仍然存在）登录）。

我的 /cofig/initilizers/session_store.rb 文件中有这个：

```
AppName::Application.config.session_store :cookie_store, key: '_application_devise_session', domain: :all 
```

domain: :all 似乎是我在 Google 上找到的标准答案，但这似乎对我不起作用。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-05-01T19:46:41.350

事实证明，'domain: all' 为该会话期间访问的所有不同子域创建一个 cookie（并确保它们在请求之间传递）。如果没有传递域参数，则意味着为在同一会话中访问的每个不同域创建一个新的 cookie，而旧的 cookie 将被丢弃。我需要的是一个在整个会话期间保持不变的 cookie，即使在域发生变化时也是如此。因此，通过`domain: "lvh.me"`解决了开发中的问题。这会创建一个在不同子域之间保留的 cookie。

对于任何需要进一步解释的人，这是一个很好的链接： [http ://excid3.com/blog/sharing-a-devise-user-session-across-subdomains-with-rails-3/](http://excid3.com/blog/sharing-a-devise-user-session-across-subdomains-with-rails-3/)

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2013-02-21T18:39:46.517

[http://excid3.com/blog/sharing-a-devise-user-session-across-subdomains-with-rails-3/](http://excid3.com/blog/sharing-a-devise-user-session-across-subdomains-with-rails-3/)

> “这里你要注意的部分是，如果你设置 :domain => :all like 在某些地方是推荐的，除非你使用 localhost，否则它根本不起作用。:all 默认为 TLD 长度 1 ，这意味着如果您使用 Pow (myapp.dev) 进行测试，它也不会工作，因为这是一个长度为 2 的 TLD。”

换句话说，您需要：

```
 App.config.session_store ... , :domain => :all, :tld_length => 2 
```

清除 cookie 也是一个好主意

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-11-12T11:39:04.373

我一直在寻找一种无需明确说明域名即可解决此问题的方法，因此我可以在 localhost、lvh.me 以及我将在生产中使用的任何域之间跳转，而无需继续编辑 session_store.rb 文件。但是，设置“domain: :all”似乎对我不起作用。

最终我发现我需要在该表达式中声明 tld_length（顶级域长度）。例如，默认 tld_length 为 1，而 example.lvh.me 的 tld_length 为 2，127.0.0.1.xip.io 的 tld_length 为 5。所以我在 lvh.me 上的 session_store.rb 文件中的子域在开发中以及在生产中的任何其他内容如下。

```
MyApp::Application.config.session_store :cookie_store, key: '_MyApp_session', domain: :all, tld_length: 2 
```

希望这对某人有所帮助，因为我花了很长时间才找到这个答案！

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-02-06T21:59:14.823

由于某种原因`:all`，用域替换对我来说不起作用（rails 3.2.11）。它需要一个自定义中间件来修复它。该解决方案的摘要如下。

**tl;dr：**您需要编写一个自定义机架中间件。您需要将其添加到您的`conifg/environments/[production|development].rb`. 这是在 Rails 3.2.11 上

Cookie 会话通常只为您的顶级域存储。

如果您查看，您会看到and和 and`Chrome -> Settings -> Show advanced settings… -> Privacy/Content settings… -> All cookies and site data… -> Search {yourdomain.com}`会有单独的条目`sub1.yourdomain.com``othersub.yourdomain.com``yourdomain.com`

挑战是在所有子域中使用相同的会话存储文件。

## 第 1 步：添加自定义中间件类

这就是[Rack Middleware](http://guides.rubyonrails.org/rails_on_rack.html)的用武之地。一些相关的 rack & rails 资源：

*   [关于 Rack 的 Railscasts](http://railscasts.com/episodes/151-rack-middleware?view=asciicast)
*   [机架导轨](http://guides.rubyonrails.org/rails_on_rack.html)
*   [抽象](http://rack.rubyforge.org/doc/Rack/Session/Abstract/ID.html)会话和[cookie 会话](http://rack.rubyforge.org/doc/Rack/Session/Cookie.html)的机架文档

这是一个自定义类，您应该添加到`lib` **这是由[@Nader](https://stackoverflow.com/users/166918/nader)编写的，你们都应该感谢他**

```
# Custom Domain Cookie
#
# Set the cookie domain to the custom domain if it's present
class CustomDomainCookie
  def initialize(app, default_domain)
    @app = app
    @default_domain = default_domain
  end

  def call(env)
    host = env["HTTP_HOST"].split(':').first
    env["rack.session.options"][:domain] = custom_domain?(host) ? ".#{host}" : "#{@default_domain}"
    @app.call(env)
  end

  def custom_domain?(host)
    host !~ /#{@default_domain.sub(/^\./, '')}/i
  end
end 
```

基本上，它的作用是将所有 cookie 会话数据映射回与根域完全相同的 cookie 文件。

## 第 2 步：添加到 Rails 配置

现在您在 lib 中有一个自定义类，请确保正在自动加载它。如果这对您没有任何意义，请看这里：[Rails 3 autoload](https://stackoverflow.com/questions/4073856/rails-3-autoload)

第一件事是确保您在系统范围内使用 cookie 存储。我们**`config/application.rb`**告诉 Rails 使用 cookie 存储。

```
# We use a cookie_store for session data
config.session_store :cookie_store,
                     :key => '_yourappsession',
                     :domain => :all 
```

这里之所以提到这里是因为这`:domain => :all`条线。还有其他人建议指定`:domain => ".yourdomain.com"`而不是`:domain => :all`. 由于某种原因，这对我不起作用，我需要如上所述的自定义中间件类。

然后在你的**`config/environments/production.rb`**添加：

```
config.middleware.use "CustomDomainCookie", ".yourdomain.com" 
```

请注意，前面的点是必需的。请参阅“[子域 cookie，在父域请求中发送？](https://stackoverflow.com/questions/3865345/sub-domain-cookies-sent-in-a-parent-domain-request) ”了解原因。

然后在你的**`config/environments/development.rb`**添加：

```
config.middleware.use "CustomDomainCookie", ".lvh.me" 
```

lvh.me 技巧映射到 localhost。这很棒。有关更多信息，请参阅[此 Railscast 关于子域](http://railscasts.com/episodes/221-subdomains-in-rails-3)和[此说明](http://pastebin.com/GUrn7vvE)。

希望应该这样做。老实说，我不完全确定为什么这个过程如此复杂，因为我觉得跨子域站点很常见。如果有人对这些步骤背后的原因有任何进一步的见解，请在评论中启发我们。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2013-07-16T01:43:16.247

我在寻找将 cookie 设置为根域的最简单方法时遇到了这个问题。`:all`当作为域选项传递时，似乎有一些关于该选项的错误信息。对于大多数域，它实际上会按预期工作，将 cookie 设置为根域（例如`.example.com`for `test.example.com`）。`lvh.me`我认为大多数人在使用域进行测试时都遇到了问题。rails 用于查找顶级域的正则表达式定义为`DOMAIN_REGEXP = /[^.]*\.([^.]*|..\...|...\...)$/`. 如果您注意最后一部分，您可以看到 rails 解释`lvh.me`为类似于`com.au`. 如果您的用例需要`lvh.me`工作，那么该`:all`选项将无法正常工作，但是，对于大多数域来说，它似乎是最简单和最好的选项。

TL；DR，这里的正确答案，假设您不是在 3 个字母的域（或任何混淆上述正则表达式的域）上开发，则使用`:all`.

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-03-26T01:12:02.727

**Rails 4.x**（也应该适用于 Rails 5/6 版本）

[如何在 localhost (Rails) 中获取 lvh.me:3000 和子域](https://stackoverflow.com/questions/36521114/unable-to-determine-ip-address-from-host-name/36522401#36522401)

开发：我已共享 cookie 以添加`.lvh.me`到`session_store.rb`,

它将在 localhost 上的子域之间共享`admin.lvh.me:3000`，`lvh.me:3000`依此类推...

```
#config/initializers/session_store.rb

domain = Rails.env.production? ? ".domain_name.com" : ".lvh.me"

Rails.application.config.session_store :cookie_store, 
                      key: '_app_name_session', domain: domain 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-05-01T19:51:47.517

你试过了吗

```
AppName::Application.config.session_store :cookie_store, key: '_application_devise_session', domain: 'lvh.me' 
```

)

基本上我们说的是基域有单个 cookie，只是忽略子域..虽然这种方法仍然有一些缺陷......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-10-18T03:18:21.240

支撑导轨5

如果您希望它适用于任何域：

```
Rails.application.config.session_store :cookie_store, key: '_my_app_session', domain: :all, tld_length: 2 
```

要配置每个环境，您可以使用以下内容：

```
Rails.application.config.session_store :cookie_store, key: '_my_app_session', domain: {
  production: '.example.com',
  development: '.example.dev'
}.fetch(Rails.env.to_sym, :all) 
```

参考：[https ://github.com/plataformatec/devise/wiki/How-To:-Use-subdomains](https://github.com/plataformatec/devise/wiki/How-To:-Use-subdomains)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-25T04:39:32.510

如果您将 Redis 用于会话存储。

```
if Rails.env.development?
    Rails.application.config.session_store :redis_store, {
       servers: [
        { host: 'localhost', port: 6379},
      ],
      key: '_app_session',
      expire_after: 1.day,
      domain: :all
    }

else
    Rails.application.config.session_store :redis_store, {
       servers: [
        { host: HOST_URL, port: PORT},
      ],
      key: '_app_session',
      expire_after: 1.day,
      domain: '.domain.com',
      tld_length: 2
    }

end 
```

# linux - 获取“源”编辑脚本的位置

> ID：10402778
> 
> 赞同：1
> 
> 时间：2012-05-01T19:02:47.193
> 
> 标签：linux, bash, shell

我想执行诸如（shell 是 bash）之类的语句

```
/# source /workspace/scripts/script.sh
/workspace/scripts# source script.sh 
```

在 script.sh 里面我想得到它自己的位置。（script.sh 不会在 PATH 变量中）

我可以`readlink -f $0`在运行脚本时使用它来执行此操作，但是当我执行此操作时同样不起作用`source`。

我**不**希望解决方案依赖于我从哪里运行`source`命令。（否则`pwd`就足够了）

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:06:20.793

不可能在所有情况下 100% 可靠地找到位置。
如果您使用**bash**，则最好的选择是`$BASH_SOURCE`可变的。
[这个链接](http://mywiki.wooledge.org/BashFAQ/028)对这个主题非常有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:07:33.977

由于`script.sh`在您的路径中，您应该能够使用`which`. 因此，在脚本中，如果`$0`不是完整路径，您可以执行`which $0`.

```
carabiner$ cat ~/bin/test.sh
#!/bin/sh

echo test - $0 $1
which $0

carabiner$ source test.sh
test - test.sh
test.sh is /home/zigdon/bin/test.sh 
```

# php - PHP - FTP文件上传错误

> ID：10402785
> 
> 赞同：0
> 
> 时间：2012-05-01T19:03:17.257
> 
> 标签：php, ftp

我正在向我的站点添加 FTP 上传，并在实时测试时不断收到此错误。该脚本在我的本地主机上完全运行。

什么可能阻止它在我的虚拟主机的服务器上？

> 警告：ftp_login() 期望参数 1 是资源，布尔值在第 134 行的 /home/content/20/8630520/html/filedrop.php 中给出

```
 <div id="form">
    <?

    if(!isset($_POST["submit"])){?>

    <form action="filedrop.php" method="POST" enctype="multipart/form-data">
    <fieldset>
        <label><span class="error">*</span> Server:</label> 
        <input size="50" type="text" name="server" value=""/>

        <label><span class="error">*</span> Username:</label> 
        <input size="50" type="text" name="user"  value=""/>

        <label><span class="error">*</span> Password:</label> 
        <input size="50" type="password" name="password" value=""/>

        <label><span class="error">*</span> Select File:</label> 
        <input name="userfile" type="file" size="50" style="height:23px;"/>

        <input type="submit" name="submit" value="Upload" />
    </fieldset>
    </form>
    <?}
    else 
    {

    set_time_limit(300);//for uploading big files

    $paths=$_POST['pathserver'];

    $filep=$_FILES['userfile']['tmp_name'];

    $ftp_server=$_POST['server'];

    $ftp_user_name=$_POST['user'];

    $ftp_user_pass=$_POST['password'];

    $name=$_FILES['userfile']['name'];

    // set up a connection to ftp server
    $conn_id = ftp_connect($ftp_server);

    // login with username and password
    $login_result = ftp_login($conn_id, $ftp_user_name, $ftp_user_pass);

    // check connection and login result
    if ((!$conn_id) || (!$login_result)) {
    echo "1.) FTP connection has encountered an error!</br>";
    echo "2.) Attempted to connect to $ftp_server for user $ftp_user_name....</br>";
    echo "Go <a href=\"filedrop.php\">back</a> and try again.";
    exit;
    } else {
    echo "1.) Connected to $ftp_server, for user $ftp_user_name".".....</br>";
    }

    // upload the file to the path specified
    $upload = ftp_put($conn_id, $paths.'/'.$name, $filep, FTP_BINARY);

    // check the upload status
    if (!$upload) {
    echo "2.) FTP upload has encountered an error!</br>";
    echo "Go <a href=\"filedrop.php\">back</a> and try again.";
    } else {
    echo "2.) Uploaded file with name $name to $ftp_server ";
    echo "Go <a href=\"filedrop.php\">back</a> to upload more.";

    }

    // close the FTP connection
    ftp_close($conn_id);    

    }
    ?>
</div> 
```

我需要修改这个吗？或者添加另一个文件？我不完全是 PHP 高级。

谢谢，

赛斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:05:40.907

这意味着您的调用`ftp_connect()`失败并且您没有传递有效的资源 ID `ftp_login()`（实际上您传递`false`的是一个布尔值）。你需要弄清楚你`ftp_connect()`失败的原因。

# javascript - JQuery拖放与验证问题

> ID：10402787
> 
> 赞同：1
> 
> 时间：2012-05-01T19:03:23.500
> 
> 标签：javascript, jquery, validation, drag-and-drop

我创建了一个简单的选项卡式 JQuery 拖放系统，其中填充了我数据库中的相关数据。

[http://ignitethatdesign.com/phoneShop/test1.php](http://ignitethatdesign.com/phoneShop/test1.php)

我的主要目标是最终创建一个简单的电话包系统，方法是将选择电话合同时所需的各种元素拖放到“最终包”选项卡中，例如电话价格、网络成本和其他变量。用户提交时的总费用。

我只想从每个选项卡中选择一个选项以进入“最终包”选项卡，例如

品牌：诺基亚 Lumia 800。分钟：100。等等。

我的问题是，当我只想从每个选项卡中提取一个并将它们放入“最终包”时，我可以将每个选项卡中的尽可能多的选项拖到任何选项卡中。

```
<style>
    #sortable1 li, #sortable2 li, #sortable3 li, #sortable4 li { margin: 0 5px 5px     5px; padding: 5px; font-size: 1.2em; width: 120px; }
</style>

<script>
$(function() {
    $( "#sortable1, #sortable2, #sortable3, #sortable4, #sortable5" ).sortable().disableSelection();

    var $tabs = $( "#tabs" ).tabs();

    var $tab_items = $( "ul:first li", $tabs ).droppable({
        accept: ".connectedSortable li",
        hoverClass: "ui-state-hover",
        drop: function( event, ui ) {
            var $item = $( this );
            var $list = $( $item.find( "a" ).attr( "href" ) )
                .find( ".connectedSortable" );

            ui.draggable.hide( "slow", function() {
                $tabs.tabs( "select", $tab_items.index( $item ) );
                $( this ).appendTo( $list ).show( "slow" );
            });
        }
    });
});
</script>
</head>

<body>
<div class="dragDrop">
 <?php

 mysql_connect("localhost", "user", "password") or die ('Unable to Connect MySQL');
 mysql_select_db("database") or die ('Unable to select Database'); 
 ?>

<div id="tabs">
<ul>
    <li><a href="#Models">Make</a></li>
    <li><a href="#Minutes">Minutes</a></li>
    <li><a href="#Texts">Texts</a></li>
    <li><a href="#Data">Data</a></li>
    <li><a href="#tabs-2">Final Package</a></li>
</ul>
<div id="Models">
    <ul id="sortable1" class="connectedSortable ui-helper-reset">
    <?php
    $result = mysql_query("SELECT * FROM phone_tbl where category = 'Model'") or     die(mysql_error());
 while($row = mysql_fetch_array($result)) { 
 echo "<li id=\"item_=".$row['id']."\"><div>".$row['label']."</div></li>";
 }
?>
    </ul>
</div>

<div id="Minutes">
    <ul id="sortable2" class="connectedSortable ui-helper-reset">
    <?php
    $result = mysql_query("SELECT * FROM phone_tbl where category = 'Minutes'") or     die(mysql_error());
 while($row = mysql_fetch_array($result)) { 
 echo "<li id=\"item_=".$row['id']."\"><div>".$row['label']."</div></li>";
 }
?>
    </ul>
</div>

<div id="Texts">
    <ul id="sortable3" class="connectedSortable ui-helper-reset">
    <?php
    $result = mysql_query("SELECT * FROM phone_tbl where category = 'Texts'") or     die(mysql_error());
 while($row = mysql_fetch_array($result)) { 
 echo "<li id=\"item_=".$row['id']."\"><div>".$row['label']."</div></li>";
 }
?>
    </ul>
</div>

<div id="Data">
    <ul id="sortable4" class="connectedSortable ui-helper-reset">
    <?php
    $result = mysql_query("SELECT * FROM phone_tbl where category = 'Data'") or die(mysql_error());
 while($row = mysql_fetch_array($result)) { 
 echo "<li id=\"item_=".$row['id']."\"><div>".$row['label']."</div></li>";
 }
?>
    </ul>
</div>
<div id="tabs-2">
    <ul id="sortable5" class="connectedSortable ui-helper-reset">
    </ul>
</div>
</div>

</div> 
```

我可以通过什么方式验证添加到最终表格中的每个选项，以便在将每个选项卡中的一个选项添加到“最终包”选项卡后，不能再添加更多选项。

谢谢。

JB。

# iphone - 键入 Cast UIView 警告

> ID：10402789
> 
> 赞同：0
> 
> 时间：2012-05-01T19:03:32.233
> 
> 标签：iphone, objective-c, ios, casting

我不断收到 UIView 可能无法响应 selectedSegmentIndex 的警告。我尝试了类型转换，但我无法摆脱警告。我假设我的演员阵容不正确。

为了避免警告，输入强制转换的正确方法是什么？

```
- (IBAction)segmentedControlIndexChanged:(id)sender
{    
    switch ([[[[self.view viewWithTag:100] viewWithTag:202] viewWithTag:203] selectedSegmentIndex]) {

        case 0:
            // code here
            break;
        case 1:
            // code here
            break;
        default:
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:07:38.330

试试这个：

```
switch ([ (UISegmentedControl*)[[[self.view viewWithTag:100] viewWithTag:202] viewWithTag:203] selectedSegmentIndex]) {
... 
```

# ruby-on-rails - Heroku 上的排序问题

> ID：10402792
> 
> 赞同：1
> 
> 时间：2012-05-01T19:03:37.163
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

我有以下在我的本地机器上运行良好（运行 MySQL DB）但在 Heroku 上排序顺序是错误的，而不是 1,2,3,4,5...11,12,13 等我得到1,11,12,13,2,3,4,5……！

```
<% @release.releases_tracks.sort { |a,b| a.position <=> b.position }.each do |releases_track| %>
      <tr>
        <td><%= releases_track.position %></td>
        <td><%= releases_track.track.name %></td>
        <td><%= releases_track.track.artists.map { |a| a.name}.join (", ") %></td>
        <td><%= releases_track.track.isrc %></td>
      </tr>
<% end %> 
```

我认为是因为我的位置列是一个 varchar，但我已更改为整数，迁移了 Heroku 上的数据库，它仍在执行此操作！这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:17:33.070

看起来该列仍然是 varchar 或字符串。您可以在 Heroku 的控制台上从表中加载一个对象并检查该字段以确保它确实已更改为整数吗？

起初，我认为这可能是 Heroku 使用的 mySql 和 Postgres 之间的差异造成的，但我认为这里不是这种情况。

此外，您可以使用 ActiveRecord 来处理排序...

```
results = YourModel.where('blah...blah..').order('id desc') 
```

# jquery - Jquery 逻辑工作 3/4 的方式（复选框列表） - 我如何让它工作 100%

> ID：10402793
> 
> 赞同：0
> 
> 时间：2012-05-01T19:03:46.383
> 
> 标签：jquery, asp.net-mvc-3

我有一个复选框列表，每个复选框都有自己的唯一 ID 附加到复选框的名称。我所追求的行为是，如果选中一个复选框（此处：“SelfEmployed”），则`<div>`显示隐藏。如果未选中，`<div>`则隐藏。默认是`<div>`隐藏的。里面`<div>`是其他输入，在这种情况下是 a `textbox`。

我使用的代码 4 次中有 3 次有效，我将在下面解释。

这是我的 MVC 视图顶部的 jquery 代码：

```
$(document).ready(function () {
    $("input[name$='MyModel.IncomeTypeCheckBox']").
            click(function () {
        var check_value = $(this).val();
        if (check_value == 'SelfEmployed') {
            $("#IncomeTypeCheckBox_SelfEmployed, 
                #IncomeTypeCheckBox_SelfEmployed input").
                toggle(this.checked);
            $("#IncomeTypeCheckBox_SelfEmployed, 
                #IncomeTypeCheckBox_SelfEmployed input").
                    removeAttr("disabled");
        }
        else if (check_value != 'SelfEmployed') {
            $("#IncomeTypeCheckBox_SelfEmployed, 
                #IncomeTypeCheckBox_SelfEmployed input").
                hide().attr("disabled", "disabled");
        }
 });
    $("#IncomeTypeCheckBox_SelfEmployed, 
        #IncomeTypeCheckBox_SelfEmployed input").
        hide().attr("disabled", "disabled");
}); 
```

（注意：我硬退回该行 - 不喜欢 SO 不会自动换行代码然后导致滚动条的方式）

该**`"disabled"`**部分很重要，并作为任何输入的属性添加/删除。我正在使用一个验证绑定器，它基本上不允许隐藏内的任何输入`<div>`引发验证错误（显然，当`<div>`显示输入时，该属性将被删除并且任何验证错误都将起作用）。

在一个页面上，我有复选框列表和一个文本框输入。两者都是必需的（复选框使用自定义`[Mandatory]`数据注释属性）。还有`<div>`另一个文本框输入的隐藏。这些是场景（其中 4 个中有 3 个有效）：

1.  页面加载。未选中“SelfEmployed”。如果复选框中未选择任何内容和/或第一个文本框为空，则点击“提交”将触发验证。hidden`<div>`不会触发验证，因为 inside`<input>`的属性设置为`disabled="disabled"`. 预期行为 - 通过。
2.  页面加载。在复选框中选择“SelfEmployed”以外的任何内容并在文本框中输入内容将允许页面提交。hidden`<div>`不会触发验证，因为 inside`<input>`的属性设置为`disabled="disabled"`. 预期行为 - 通过。
3.  页面加载。在复选框中选择“SelfEmployed”会显示先前隐藏`<div>`的第二个文本框。由于复选框已选中某些内容，并且如果在`<div>`现在显示的第一个文本框和第二个文本框中都输入了某些内容（即，`disabled="disabled"`从第二个中删除了该属性`<input>`），则页面将提交。预期行为 - 通过。
4.  页面加载。与 # 3 相同，除了这次，如果您没有在第二个文本框中填写`<div>`并尝试提交验证错误，则会在第二个文本框上引发验证错误（预期）。如果您填写第二个文本框并提交它工作的页面（预期）。但是，如果仍然出现验证错误并且您取消选中“SelfEmployed”复选框（导致`<div>`再次隐藏 - 这是预期的），然后尝试提交页面（验证通过复选框和第一个文本框），它将不会提交. 失败。

对 HTML 源代码的检查表明，`disabled="disabled"`当在上面的场景 #4 中取消选中“SelfEmployed”复选框时（隐藏了`<div>`），该属性没有被重新插入。仅当显示`<div>`容器时在第二个文本框上引发验证错误然后您再次隐藏它并尝试提交时，才会发生这种情况。请注意，如果我只是选中/取消选中“SelfEmployed”复选框而不尝试提交（并触发任何验证），您会在 Chrome 的开发工具中看到`disabled="disabled"`分别添加和删除`<input>`标签。

我该如何解决最后一个问题？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T04:02:54.590

这对我有用：

```
$(document).ready(function () 
    {
        $("input[name$='StepIncomeInformation.IndividualIncomeTypeCheckBox']").click(function () {
            if ($('#StepIncomeInformation_IndividualIncomeTypeCheckBox_SelfEmployed').is(':checked')) {
                $('#IndividualIncomeTypeCheckBox_SelfEmployed, #IndividualIncomeTypeCheckBox_SelfEmployed input').show().removeAttr("disabled");
            }
            else {
                $('#IndividualIncomeTypeCheckBox_SelfEmployed, #IndividualIncomeTypeCheckBox_SelfEmployed input').hide().attr("disabled", "disabled");
            }
        });
        $("#IndividualIncomeTypeCheckBox_SelfEmployed, #IndividualIncomeTypeCheckBox_SelfEmployed input").hide().attr("disabled", "disabled");
    }); 
```

# javascript - 我可以将主干更改事件嵌套多深？

> ID：10402796
> 
> 赞同：6
> 
> 时间：2012-05-01T19:04:01.623
> 
> 标签：javascript, backbone.js

假设我有一个（相当荒谬的）书籍模型，其属性看起来像：

```
page:{
    paragraph:{
        wordcount: {
            the: 8,
            at: 10
        }
    }
} 
```

我可以像这样绑定到非常嵌套的值的更改吗？

```
book.on("change:page:paragraph:wordcount:the", ...); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T20:09:52.483

Backbone 仅触发`change`顶级属性名称的事件。根据[活动目录](http://documentcloud.github.com/backbone/#FAQ-events)：

> *   **"change"** (model, options) — 当模型的属性发生变化时。
> *   **"change:[attribute]"** (model, value, options) — 当特定属性被更新时。

没有提到那里有任何嵌套。实际上，如果您确实更改了属性的嵌套属性，我很确定它甚至不会触发事件（因为属性本​​身没有更改）。此外，如果您查看带注释的源（尽管影响此行为的因素有点分散），您可以将其跟踪到[触发事件的](http://documentcloud.github.com/backbone/docs/backbone.html#section-64)[位置`change:attribute`](http://documentcloud.github.com/backbone/docs/backbone.html#section-64)。

但是，看起来确实[有一个插件](http://documentup.com/afeld/backbone-nested/)可以帮助您完成您所追求的。

# macos - Cocoa：如何发送正确的鼠标增量事件？

> ID：10402797
> 
> 赞同：2
> 
> 时间：2012-05-01T19:04:03.153
> 
> 标签：macos, cocoa, events, mouse

**我正在制作一个应用程序来使用 Mac OS X (10.7.3) 的游戏手柄上的模拟摇杆来控制鼠标。目前它工作得很好，我可以控制桌面和大多数游戏中的光标。**但是在军团要塞2中，我无法控制瞄准，但可以控制菜单中的光标。鼠标滚轮和点击无处不在。另一个奇怪的是，当我移动真实鼠标时，瞄准器在正常瞄准之前“跳跃”了我的“虚拟鼠标”的行进距离，所以它有点接收事件。

游戏选项“原始鼠标输入”被禁用（我认为 osx 甚至不支持它）。类似的应用程序可以成功控制目标。

我怀疑游戏正在寻找“增量运动”或“相对运动”事件或任何类似事件，但我的代码使用绝对位置设置光标的位置。不知道如何改变这一点。

以下是用于发送 mouseMoved 事件的代码片段：

编辑：删除了糟糕的代码！

. 编辑：

另外，因为我是这样做的，所以我需要手动检查屏幕边界以防止光标变得疯狂。因此，在多屏幕设置中，当用户更改分辨率时，情况会变得最差。**如果我可以发送移动量并让操作系统负责约束光标，那就更好了。**

.

问题是： **我以错误的方式执行鼠标移动事件？**

**我怎样才能解决这个问题？**

EDIT2：所以，这只是一个愚蠢的错误，抱歉=P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T05:41:26.653

我只是忘了用增量值调用 CGSetIntegerValueField(kCGEventMouseDeltaX, ...) （和 Y）... =P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-12T17:12:58.507

经过短短几个小时的谷歌搜索和实验，终于得到了这个工作:)看起来罗德里戈试图说你必须在构建它之后调用`CGEventSetIntegerValueField`鼠标`kCGMouseEventDeltaX`事件`kCGMouseEventDeltaY`。

我的代码，使用 PyObjC：

```
from Quartz.CoreGraphics import (
    CGEventCreate,
    CGEventCreateMouseEvent,
    CGEventGetLocation,
    CGEventPost,
    CGEventSetIntegerValueField,
    kCGEventMouseMoved,
    kCGHIDEventTap,
    kCGMouseEventDeltaX,
    kCGMouseEventDeltaY,
    )

def mouse_delta(delta_x, delta_y):
    """
    Send a MouseMoved event with the given deltaX and deltaY attributes,
    but without changing the cursor location.
    """
    # Might be a better way to get the current mouse location
    x, y = CGEventGetLocation(CGEventCreate(None))
    # The `mouseButton` parameter to CGEventCreateMouseEvent is ignored
    # unless `mouseType` is kCGEventOtherMouse{Down,Dragged,Up},
    # so let's just pass the value 0
    event = CGEventCreateMouseEvent(None, kCGEventMouseMoved, (x, y), 0)
    CGEventSetIntegerValueField(event, kCGMouseEventDeltaX, delta_x)
    CGEventSetIntegerValueField(event, kCGMouseEventDeltaY, delta_y)
    return CGEventPost(kCGHIDEventTap, event) 
```

# c# - 自定义索引器“无法分配给”？

> ID：10402799
> 
> 赞同：1
> 
> 时间：2012-05-01T19:04:15.830
> 
> 标签：c#, indexer

在 CharList 类中，我有一个私有列表 (List<List<NewChar>>) 和几个索引器：

```
private List<List<NewChar>> _charList;

// ...

public NewChar this[Int32 inner, Int32 outer]
{
    get
    {
       if (inner < 0 || inner >= _charList.Count ||
            outer < 0 || outer >= _charList[inner].Count)
            throw new ArgumentException("NewCharList indexer[,]: Invalid index!");

       return _charList[inner][outer];
    }
}

public List<NewChar> this[Int32 index]
{
    get
    {
        if (index < 0 || index > MaxCharListIndex)
            throw new ArgumentException("NewCharList indexer[]: Invalid index");
         List<NewChar> ret = new List<NewChar>(_charList[index].Count);

        for (int i = 0; i < _charList[index].Count; i++)
            ret.Add(_charList[index][i]);

        return ret;
    }
} 
```

在测试代​​码（另一个类）中，如果我调用

```
charList[0] = null; 
```

我收到编译器错误“无法将属性或索引器 xxx 分配给 - 它是只读的”，但如果我调用

```
charList[0][0] = new NewChar(22,22); 
```

编译器将允许它，尽管值不会改变。为什么它会让我分配到第二个？我一辈子都想不通，这让我发疯！（即使它不会改变值）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:06:40.837

当你写这个：

```
charList[0][0] = new NewChar(22,22); 
```

您实际上并没有使用您的第一个索引器，而是您的第二个。这更像是：

```
List<NewChar> temp = charList[0];
temp[0] = new NewChar(22,22); 
```

使用您的第一个索引器的语法是：

```
charList[0, 0] = new NewChar(22,22); 
```

但是，这将提供您现在收到的相同编译器错误，因为您在该索引属性上没有设置器。

`List<T>.AddRange`附带说明一下，您可以通过使用甚至`List<T>`接受 的构造函数来简化您的第二个索引属性实现`IEnumerable<T>`，即：

```
get
{
    if (index < 0 || index > MaxCharListIndex)
        throw new ArgumentException("NewCharList indexer[]: Invalid index");
    return new List<NewChar>(_charList[index]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:09:31.533

我认为您没有索引`set`器`this[int]`：

```
public List<NewChar> this[Int32 index]
{
    get
    {
        //......
        return ret;
    }
   //set { /*YOU DON'T HAVE THIS METHOD*/}
} 
```

# jquery - 弹出窗口的Jquery问题

> ID：10402806
> 
> 赞同：0
> 
> 时间：2012-05-01T19:05:03.280
> 
> 标签：jquery

我在弹出窗口显示用户单击的最后一个元素而不是当前元素时遇到问题。我有几个不同的优惠券，用户可以点击打印。例如，如果用户单击 id 为“test”的优惠券，则不会发生任何事情，但当用户再次单击时，优惠券会出现。在这种情况下，无论点击哪个优惠券，“测试优惠券”都会继续出现。如果页面是手动刷新的，那么用户可以点击一个新的优惠券。我究竟做错了什么？

```
$(".coupon").click(function() {
    var id = $(this).attr("id");
    $('.pop').popupWindow({
        windowURL:'coupons/' + id + '.html'
    });
}); 
```

* * *

```
.coupon {
margin:10px;
height:152px;
width:193px;
position:relative;
cursor:pointer;
float:left;
}

.coupon .price {
margin-top:7px;
font-size:29px;
font-weight:bold;
color:white;
text-align:center;
}

.coupon .title {
margin-top:5px;
font-size:18px;
font-weight:bold;
color:black;
text-align:center;
font-family:'Times New Roman',Georgia,Serif;
}

<div class="coupon pop" id="test1">
  <div class="price">
    $5.00 OFF
  </div>
  <div class="title">
    Test
  </div>
</div>

<div class="coupon pop" id="test2">
  <div class="price">
    $5.00 OFF
  </div>
  <div class="title">
    Another test
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:26:24.690

我尝试这段代码并且有效

javascript:

```
<script type="text/javascript">
$(function() {
$('.coupon').each(function(){
    $(this).popupWindow({ 
        windowURL:$(this).attr("href")
    });
});
});
</script> 
```

html代码：

```
<a class="coupon" href="http://google.com" onclick="return false;" id="google">Google</a>
<a class="coupon" href="http://yahoo.com" onclick="return false;" id="yahoo">Yahoo</a> 
```

希望属性的更改不会破坏您的项目

雪儿

更新：我将您的 div 标签转换为

```
<a class="coupon" id="test1" href="_your_link_">
  <span class="price">$5.00 OFF</span>
  <span class="title">Test  </span>
</a> 
```

# asp-classic - 使用经典 ASP 的 SQL 故障转移

> ID：10402809
> 
> 赞同：0
> 
> 时间：2012-05-01T19:05:18.347
> 
> 标签：asp-classic, connection-string

我知道在 ASP.NET 中，SQL 的连接字符串中有一个选项可以自动将故障转移到另一台服务器。在经典 ASP 中做到这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:48:01.283

我们也在努力解决这个问题，它似乎可以与 SQL Server Native Client 10 和以下[连接字符串](http://www.connectionstrings.com/sql-server-2008#p2)一起使用。

```
Provider=SQLNCLI10;Data Source=myServerAddress;Failover Partner=myMirrorServerAddress;Initial Catalog=myDataBase;Integrated Security=True; 
```

我猜它也适用于 ODBC 版本。

# .net - WPF WebBrowser 浏览器版本

> ID：10402813
> 
> 赞同：7
> 
> 时间：2012-05-01T19:05:29.157
> 
> 标签：.net, wpf, browser, webbrowser-control

WPF WebBrowser 控件是否取决于安装在用户机器上的 IE 版本，还是使用跨机器一致的单独库？我读过它只在 IE7 模式下呈现，但我想确保没有安装 IE 或由于某种原因仍在使用 IE6 的用户不会有任何问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T19:28:01.177

WebBrowser的[MSDN 注释](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.aspx)表明它重新托管了 IE ActiveX 控件：

> WebBrowser 控件在内部实例化本机 WebBrowser ActiveX 控件。

WebBrowser ActiveX 控件更广为人知的是`Shdocvw.dll`. 这反过来包装了`Mshtml.dll`，可能还有其他 DLL 给您的环境。[重新托管此控件的一个警告是它的 Browser Emulation 设置](http://msdn.microsoft.com/en-us/library/ee330730%28v=vs.85%29.aspx#browser_emulation)：

> 对于托管 WebBrowser 控件的应用程序，默认值为`7000`. 要使用注册表控制此功能的值，请将可执行文件的名称添加到以下设置中，并将值设置为与所需设置相匹配。

`0x7000`表示IE7兼容模式。因此，如果您希望 WPF 应用程序使用其他模式呈现，则需要更新注册表，如[改编自此示例](http://blogs.msdn.com/b/ie/archive/2009/03/10/more-ie8-extensibility-improvements.aspx)：

```
[HKEY_LOCAL_MACHINE\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION] 
"MyApplication.exe" = dword:2328 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-08T15:41:46.460

我在带有 IE11 的机器上创建了一个带有 WebBrowser 控件的 WPF 应用程序，并得到了这个用户代理字符串：

```
user agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.3; .NET CLR 1.1.4322) 
```

我在带有 IE10 的机器上创建了一个带有 WebBrowser 控件的 WPF 应用程序，并得到了这个用户代理字符串：

```
user agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/6.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E) 
```

Trident/7.0 表示 IE11，Trident/6.0 表示 IE10。[有关用户代理字符串的更多信息](https://msdn.microsoft.com/en-us/library/ms537503(v=vs.85).aspx#TriToken)。

带有 IE10 的系统的页面呈现方式也与带有 IE11 的系统不同。我还使用每个系统上的独立 IE 浏览器验证了这一点。

我还没有在没有 IE 的系统或运行 IE6 的系统上尝试过，但似乎 WebBrowser 控件与系统上当前安装的 IE 版本有关。

# ipad - 如何让 iOS 相信有互联网连接

> ID：10402818
> 
> 赞同：0
> 
> 时间：2012-05-01T19:06:04.527
> 
> 标签：ipad

我正在开发一个适用于 iOS 的 Web 应用程序，该应用程序将从根本没有 Internet 连接的网络中的本地 Web 服务器访问。

我的问题是，每次 iOS 设备被锁定时，它都会断开与 WiFi 网络的连接，所以当设备再次解锁时，它必须重新连接。重新连接过程的一部分是确定是否有 Internet 连接（没有）。在该过程未完成之前，iOS 不允许任何 DNS 解析（所以如果我写[http://10.0.0.1](http://10.0.0.1)它会去那里，但如果我请求[http://something.local.com](http://something.local.com)则不会）。

由于我们控制了该网络，我们想知道 iOS 如何验证 Internet 连接，以便我们可以伪造它所期望的响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:56:34.180

我不知道是否可以在没有互联网连接的情况下在 iOS 上解析 DNS，但如果是这种情况，那将是一个更好的解决方案，因为您不需要弄乱路由器设置。仅当仅使用代码确实不可能时才使用我的解决方案。
我建议您遵循本指南：[http](http://blog.jerodsanto.net/2009/06/sniff-your-iphones-network-traffic) ://blog.jerodsanto.net/2009/06/sniff-your-iphones-network-traffic检查您的 iPhone 执行哪些操作来检测互联网连接。
使用此信息，您可以将路由器上的 is-there-internet-requests 转发到伪造 there-is-internet-responses 的本地服务器。
这假设 Apple 确实使用外部服务器来检测这一点，我不确定。但试一试不会有什么坏处！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:50:43.150

你看过[可达性类](http://developer.apple.com/library/ios/#samplecode/Reachability/Listings/Classes_Reachability_h.html#//apple_ref/doc/uid/DTS40007324-Classes_Reachability_h-DontLinkElementID_5)吗？您不必使用该`reachabilityForInternetConnection`方法，它会检查默认路由是否可用。您可以使用该`reachabilityWithAddress:`方法并检查您的服务器是否可以访问。

# nsmutablearray - NSMutableArray 添加/删除对象（继承文件）

> ID：10402819
> 
> 赞同：1
> 
> 时间：2012-05-01T19:06:05.020
> 
> 标签：nsmutablearray, nslog, inheritance

好的，所以我对 xcode 还是很陌生，但我在任何地方都找不到特定于这个问题的东西。所以我声明了数组并在以下文件中实例化它：

```
 //xmlToUrl.h

#import <Foundation/Foundation.h>

@interface xmlToUrl : NSObject {
    NSMutableArray *field;
    NSMutableArray *name;
}
@property(nonatomic, retain)NSMutableArray *field;
@property(nonatomic, retain)NSMutableArray *name;

@end 
```

和

```
 //xmlToUrl.m

#import "xmlToUrl.h"

@implementation xmlToUrl
@synthesize field;
@synthesize name;

-(void)dealloc
{
    [field release];
    [name release];
    [super dealloc];    
}

@end 
```

所以这就是我感到困惑的地方。我不知道如何正确地“分配”或“初始化”可变数组，也不知道如何处理来自另一个继承 xmlToUrl.h 的文件的添加/删除操作。

我现在拥有的代码（在另一个文件中）只是打印空。它在下面列出。我究竟做错了什么？！？

```
//nodeContent is just a NSMutableString

[xmlToUrlObject.name addObject:nodeContent];
        NSLog(@"xml Name = %@", xmlToUrlObject.name);

       //I omitted all the operational code here but if I NSLog nodeContent it prints the correct values

[xmlToUrlObject.field addObject:nodeContent];
        NSLog(@"xml Field = %@", xmlToUrlObject.field); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:10:47.533

您的实现文件中需要一个 init 函数，它看起来类似于以下内容

```
-(id) init
{
  self = [super init];
  if (self) {
    field = [[NSMutableArray alloc] init];
    name = [[NSMutableArray alloc] init];
  }
  return self;
} 
```

然后，每当您通过 [[xmlToUrl alloc] init] 创建 xmlToUrl 类的实例时，您将拥有一个已经初始化您的两个 NSMutableArrays 的类的实例

# ms-access - 以 PTRSAFE 和 UNICODE 安全方式从 VBA 将 LPCTSTR 参数传递给 API 调用

> ID：10402822
> 
> 赞同：4
> 
> 时间：2012-05-01T19:06:09.953
> 
> 标签：lpctstr, ms-access, vba, pointers, dll

我已经为此奋斗了一周。将字符串指针传递给 DLL 函数时遇到困难。

### 背景

我们刚刚开始从 Office 2003 迁移到 Office 2010。在接下来的几年中，有些人将继续只使用 Office 2003。有些人将使用 Office 2010 64 位（为什么我不知道 - 但这是一个不同的主题）。

对我来说 - 我需要编写一些适用于所有版本的代码。几年前我在互联网上发现了这个功能并正在使用它。当我对我的库进行重写时，我注意到 Unicode 与 ANSI 调用完全混合在一起......并且该函数完全无法在 Access 2010 上运行。所以我去重写它。我想我很接近 - 但我注意到 dll 调用没有返回正确的值。

### 我为解决问题所做的一切

*   我确保我阅读了 ByRef 和 ByVal 参数传递。
*   我已经阅读了 varptr() 和 strptr() 之间的区别。我相信我正确地使用它们。
*   我尝试将[lpctstr](/questions/tagged/lpctstr "显示标记为“lpctstr”的问题")声明为字符串，但对这种方法感到不舒服，因为我不确定它将如何在 64 位系统或 Unicode 系统上发挥作用。

    *   使用指针时 - 此类疏忽会崩溃并可能损坏数据库
    *   使用指针意味着我不必在 Unicode 之间进行转换——它要么是 Unicode，要么不是——并且条件编译语句确保引用了正确的函数。

### 简短摘要示例

```
Public Sub foo()
   Dim strA As String
   Dim strCB As String
#If VB7 Then
   Dim lptstrA As LongPtr
   Dim lResult As LongPtr
#Else
   Dim lptstrA As Long
   Dim lResult As Long
#End If  

   strA = "T:\TEST\"
   lptstrA = StrPtr(strA)
   strCB = String$(255, vbNullChar)

   lResult = PathIsNetworkPath(lptstrA)
#If UNICODE Then
   CopyMemory StrPtr(strCB), lptstrA, (Len(strA))
#Else
   CopyMemory StrPtr(strCB), lptstrA, (Len(strA) * 2)
#End If
   Debug.Print "Returned: " & lResult
   Debug.Print "Buffer: " & strCB
   Debug.Print "Result: " & strA
End Sub 
```

在我看来，这应该有效。我将指针传递给字符串。但...

*结果*

> > foo
> > 返回：0
> > 缓冲区：T:\TEST\
> > 结果：T:\TEST\

所以函数返回零......它应该返回1。但是如果我们检查指针处的内存内容 - 它显然有数据。

# 完整代码

### （不工作）

```
Option Explicit
'
' WNetGetConnection Return Result Constants
Private Const ERROR_SUCCESS As Long = 0&
Private Const ERROR_BAD_DEVICE As Long = 1200&
Private Const ERROR_NOT_CONNECTED = 2250&
Private Const ERROR_MORE_DATA = 234&
Private Const ERROR_CONNECTION_UNAVAIL = 1201&
Private Const ERROR_NO_NETWORK = 1222&
Private Const ERROR_EXTENDED_ERROR = 1208&
Private Const ERROR_NO_NET_OR_BAD_PATH = 1203&
'
' WNetGetConnection function retrieves the name of the network resource
' associated with a local device.
'   > msdn.microsoft.com/en-us/library/windows/desktop/aa385453(v=vs.85).aspx
'   - If the function succeeds, the return value is NO_ERROR.
'   - If the function fails, the return value is a system error code, such as
'     one of the following values.
'
' PathIsUNC function determines if the string is a valid Universal Naming
' Convention (UNC) for a server and share path.
'   > msdn.microsoft.com/en-us/library/windows/desktop/bb773712(v=vs.85).aspx
'   - Returns TRUE if the string is a valid UNC path, or FALSE otherwise.
'
' PathIsNetworkPath function determines whether a path string represents a
' network resource.
'   > msdn.microsoft.com/en-us/library/windows/desktop/bb773640(v=vs.85).aspx
'   - Returns TRUE if the string represents a network resource, or FALSE
'     otherwise.
'
' PathStripToRoot function removes all parts of the path except for the root
' information.
'   > msdn.microsoft.com/en-us/library/windows/desktop/bb773757(v=vs.85).aspx
'   - Returns TRUE if a valid drive letter was found in the path, or FALSE
'     otherwise.
'
' PathSkipRoot function parses a path, ignoring the drive letter or Universal
' Naming Convention (UNC) server/share path elements.
'   > msdn.microsoft.com/en-us/library/windows/desktop/bb773754(v=vs.85).aspx
'   - Returns the address of the beginning of the subpath that follows the root
'     (drive letter or UNC server/share).
'
' PathRemoveBackslash function removes the trailing backslash from a given
' path.
'   > msdn.microsoft.com/en-us/library/windows/desktop/bb773743(v=vs.85).aspx
'   - Returns the address of the NULL that replaced the backslash, or the
'     address of the last character if it's not a backslash.

' For Access 2010 64-Bit Support, as well as backward compatibility
#If VBA7 Then

  #If UNICODE Then

    Public Declare PtrSafe Function WNetGetConnection _
                   Lib "mpr.dll" Alias "WNetGetConnectionW" ( _
                                  ByVal lpLocalName As LongPtr, _
                                  ByVal lpRemoteName As LongPtr, _
                                  lpnLength As Long _
                                 ) As Long

    Public Declare PtrSafe Function PathIsUNC _
                   Lib "shlwapi.dll" Alias "PathIsUNCW" ( _
                                  ByVal pszPath As LongPtr _
                                 ) As Long

    Public Declare PtrSafe Function PathIsNetworkPath _
                   Lib "shlwapi.dll" Alias "PathIsNetworkPathW" ( _
                                  ByVal pszPath As LongPtr _
                                 ) As Long

    Public Declare PtrSafe Function PathStripToRoot _
                   Lib "shlwapi.dll" Alias "PathStripToRootW" ( _
                                  ByVal pPath As LongPtr _
                                 ) As Long

    Public Declare PtrSafe Function PathSkipRoot _
                   Lib "shlwapi.dll" Alias "PathSkipRootW" ( _
                                  ByVal pPath As LongPtr _
                                 ) As Long

    Public Declare PtrSafe Function PathRemoveBackslash _
                   Lib "shlwapi.dll" Alias "PathRemoveBackslashW" ( _
                                  ByVal strPath As LongPtr _
                                 ) As LongPtr

    Public Declare PtrSafe Function lStrLen _
                   Lib "kernel32" Alias "lstrlenW" ( _
                                  ByVal lpString as longptr _
                                 ) As Integer
  #Else

    Public Declare PtrSafe Function WNetGetConnection _
                   Lib "mpr.dll" Alias "WNetGetConnectionA" ( _
                                  ByVal lpLocalName As LongPtr, _
                                  ByVal lpRemoteName As LongPtr, _
                                  ByVal lpnLength As Long _
                                 ) As Long

    Public Declare PtrSafe Function PathIsUNC _
                   Lib "shlwapi.dll" Alias "PathIsUNCA" ( _
                                  ByVal pszPath As LongPtr _
                                 ) As Long

    Public Declare PtrSafe Function PathIsNetworkPath _
                   Lib "shlwapi.dll" Alias "PathIsNetworkPathA" ( _
                                  ByVal pszPath As LongPtr _
                                 ) As Long

    Public Declare PtrSafe Function PathStripToRoot _
                   Lib "shlwapi.dll" Alias "PathStripToRootA" ( _
                                  ByVal pPath As LongPtr _
                                 ) As Long

    Public Declare PtrSafe Function PathSkipRoot _
                   Lib "shlwapi.dll" Alias "PathSkipRootA" ( _
                                  ByVal pPath As LongPtr _
                                 ) As Long

    Public Declare PtrSafe Function PathRemoveBackslash _
                   Lib "shlwapi.dll" Alias "PathRemoveBackslashA" ( _
                                  ByVal strPath As LongPtr _
                                 ) As LongPtr

    Public Declare PtrSafe Function lStrLen _
                   Lib "kernel32" Alias "lstrlenA" ( _
                                  ByVal lpString As LongPtr _
                                 ) As Integer

  #End If

  Public Declare Sub CopyMemory _
                 Lib "kernel32" Alias "RtlMoveMemory" ( _
                                ByVal Destination As LongPtr, _
                                ByVal Source As LongPtr, _
                                ByVal Length As Long _
                               )

#Else

  #If UNICODE Then

    Public Declare Function WNetGetConnection _
                   Lib "mpr.dll" Alias "WNetGetConnectionW" ( _
                                  ByVal lpLocalName As Long, _
                                  ByVal lpRemoteName As Long, _
                                  lpnLength As Long _
                                 ) As Long

    Public Declare Function PathIsUNC _
                   Lib "shlwapi.dll" Alias "PathIsUNCW" ( _
                                  ByVal pszPath As Long _
                                 ) As Long

    Public Declare Function PathIsNetworkPath _
                   Lib "shlwapi.dll" Alias "PathIsNetworkPathW" ( _
                                  ByVal pszPath As Long _
                                 ) As Long

    Public Declare Function PathStripToRoot _
                   Lib "shlwapi.dll" Alias "PathStripToRootW" ( _
                                  ByVal pPath As Long _
                                 ) As Long

    Public Declare Function PathSkipRoot _
                   Lib "shlwapi.dll" Alias "PathSkipRootW" ( _
                                  ByVal pPath As Long _
                                 ) As Long

    Public Declare Function PathRemoveBackslash _
                   Lib "shlwapi.dll" Alias "PathRemoveBackslashW" ( _
                                  ByVal strPath As Long _
                                 ) As Long

    Public Declare Function lStrLen _
                   Lib "kernel32" Alias "lstrlenW" ( _
                                  ByVal lpString As Long _
                                 ) As Integer
 #Else

    Public Declare Function WNetGetConnection _
                   Lib "mpr.dll" Alias "WNetGetConnectionA" ( _
                                  ByVal lpLocalName As Long, _
                                  ByVal lpRemoteName As Long, _
                                  ByVal lpnLength As Long _
                                 ) As Long

    Public Declare Function PathIsUNC _
                   Lib "shlwapi.dll" Alias "PathIsUNCA" ( _
                                  ByVal pszPath As Long _
                                 ) As Long

    Public Declare Function PathIsNetworkPath _
                   Lib "shlwapi.dll" Alias "PathIsNetworkPathA" ( _
                                  ByVal pszPath As Long _
                                 ) As Long

    Public Declare Function PathStripToRoot _
                   Lib "shlwapi.dll" Alias "PathStripToRootA" ( _
                                  ByVal pPath As Long _
                                 ) As Long

    Public Declare Function PathSkipRoot _
                   Lib "shlwapi.dll" Alias "PathSkipRootA" ( _
                                  ByVal pPath As Long _
                                 ) As Long

    Public Declare Function PathRemoveBackslash _
                   Lib "shlwapi.dll" Alias "PathRemoveBackslashA" ( _
                                  ByVal strPath As Long _
                                 ) As Long

    Public Declare Function lStrLen _
                   Lib "kernel32" Alias "lstrlenA" ( _
                                  ByVal lpString As Long _
                                 ) As Integer

  #End If

  Public Declare Sub CopyMemory _
                   Lib "kernel32" Alias "RtlMoveMemory" ( _
                                  ByVal Destination As Long, _
                                  ByVal Source As Long, _
                                  ByVal Length As Long _
                                 )

#End If

Public Function GetUncPath(tsLocal As String) As String  
   Dim tsRoot As String  
   Dim tsPath As String  
   Dim tsRemoteRoot As String  
   Dim tsRemote As String  
   Dim tcbTemp As String  
   #If VBA7 Then  
     Dim lptsLocal As LongPtr  
     Dim lptsRoot As LongPtr  
     Dim lptsPath As LongPtr  
     Dim lptsRemote As LongPtr  
     Dim lptcbTemp As LongPtr  
     Dim lpResult As LongPtr  
   #Else  
     Dim lptsLocal As Long  
     Dim lptsRoot As Long  
     Dim lptsPath As Long  
     Dim lptsRemote As Long  
     Dim lptcbTemp As Long  
     Dim lpResult As Long  
   #End If  
   Dim lResult As Long  

   ' Initialize strings.   Since Strings are essentially a pointer to  
   ' a pointer, we use StrPtr() instead of VarPtr()  
   '  
   tsLocal = tsLocal & vbNullChar       ' Just in case  
   tsRoot = String(255, vbNullChar)     ' Path Root / Drive Letter  
   tsPath = String(255, vbNullChar)     ' Path Without Root  
   tsRemote = String(255, vbNullChar)   ' Remote Path + Root, Resolved  
   tcbTemp = String(255, vbNullChar)    ' Temporary Copy Buffer  
   lptsLocal = StrPtr(tsLocal)          ' Pointer to Local Path  
   lptsRoot = StrPtr(tsRoot)            ' Pointer to Root  
   lptsPath = StrPtr(tsPath)            ' Pointer to Path  
   lptsRemote = StrPtr(tsRemote)        ' Pointer to Remote  

   ' Check is already in UNC Format  
   lResult = PathIsUNC(lptsLocal)  
   If (lResult <> 0) Then  
     GetUncPath = tsLocal
     Exit Function
   End If

   ' Check if its a local path or network.  If Local - use that path.
   lResult = PathIsNetworkPath(lptsLocal)  
>! PathIsNetworkPath(lptsLocal) always returns 0
   If lResult = 0 Then
     GetUncPath = tsLocal
     Exit Function
   End If

   ' Extract our root from path (ie. Drive letter)
   ' ### lStrLen(lptsLocal returns 1 ??  ###
   CopyMemory lptsRoot, lptsLocal, lStrLen(lptsLocal) 
>! lStrLen(lptsLocal) always returns 1 -- unsure why
   lResult = PathStripToRoot(lptsRoot)
   If (lResult = 0) Then
     ' An error has occurred
     GetUncPath = ""
     Exit Function
    End If

   ' Strip Backslash
   lpResult = PathRemoveBackslash(lptsRoot)

   ' Find our Path portion
   CopyMemory lptsPath, lptsLocal, lStrLen(lptsLocal)
   lptsPath = PathSkipRoot(lptsPath)

   ' Strip Backslash
   lpResult = PathRemoveBackslash(lptsPath)

   ' Convert our Root to a UNC Network format
   lResult = WNetGetConnection(lptsRemote, lptsRoot, lStrLen(lptsRoot))
   If lResult = ERROR_SUCCESS Then
     tsRemote = tsRemote & tsPath     ' Add Remote + Path to build UNC path
     GetUncPath = tsRemote            ' Return resolved path
   Else
     ' Errors have occurred
     GetUncPath = ""
   End If
End Function 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:41:11.823

这是我想出的最终产品 - 随时提出批评意见。

正如 Gserg 所指出的，我不需要担心字符串是否在内存中存储为单字节字符，因为现在每台现代计算机都将使用 Unicode。因此，我能够消除使用 CopyMemory 函数并改用指针算法。

我选择不使用对象工厂包装器，而是自己控制类初始化。

这已经在 Access 2003 和 Access 2010 上进行了测试。它兼容 32 位和 64 位。

**模块：GetUNC**

```
Option Compare Database
Option Explicit

#If VBA7 Then
  Private Declare PtrSafe Function WNetGetConnection Lib "mpr.dll" Alias "WNetGetConnectionW" (ByVal lpLocalName As LongPtr, ByVal lpRemoteName As Long, lpnLength As Long) As Long
  Private Declare PtrSafe Function PathIsUNC Lib "shlwapi.dll" Alias "PathIsUNCW" (ByVal pszPath As LongPtr) As Long
  Private Declare PtrSafe Function PathIsNetworkPath Lib "shlwapi.dll" Alias "PathIsNetworkPathW" (ByVal pszPath As LongPtr) As Long
  Private Declare PtrSafe Function PathStripToRoot Lib "shlwapi.dll" Alias "PathStripToRootW" (ByVal pPath As LongPtr) As LongPtr
  Private Declare PtrSafe Function PathSkipRoot Lib "shlwapi.dll" Alias "PathSkipRootW" (ByVal pPath As LongPtr) As Long
  Private Declare PtrSafe Function PathRemoveBackslash Lib "shlwapi.dll" Alias "PathRemoveBackslashW" (ByVal strPath As LongPtr) As LongPtr
#Else
  Private Declare Function WNetGetConnection Lib "mpr.dll" Alias "WNetGetConnectionW" (ByVal lpLocalName As Long, ByVal lpRemoteName As Long, lpnLength As Long) As Long
  Private Declare Function PathIsUNC Lib "shlwapi.dll" Alias "PathIsUNCW" (ByVal pszPath As Long) As Long
  Private Declare Function PathIsNetworkPath Lib "shlwapi.dll" Alias "PathIsNetworkPathW" (ByVal pszPath As Long) As Long
  Private Declare Function PathStripToRoot Lib "shlwapi.dll" Alias "PathStripToRootW" (ByVal pPath As Long) As Long
  Private Declare Function PathSkipRoot Lib "shlwapi.dll" Alias "PathSkipRootW" (ByVal pPath As Long) As Long
  Private Declare Function PathRemoveBackslash Lib "shlwapi.dll" Alias "PathRemoveBackslashW" (ByVal strPath As Long) As Long
#End If

Public Function GetUNCPath(sLocalPath As String) As String
  Dim lResult As Long
#If VBA7 Then
  Dim lpResult As LongPtr
#Else
  Dim lpResult As Long
#End If
  Dim ASLocal As APIString
  Dim ASPath As APIString
  Dim ASRoot As APIString
  Dim ASRemoteRoot As APIString
  Dim ASTemp As APIString

  Set ASLocal = New APIString
  ASLocal.Value = sLocalPath

  If ASLocal.Pointer > 0 Then
    lResult = PathIsUNC(ASLocal.Pointer)
  End If
  If lResult <> 0 Then
    GetUNCPath = ASLocal.Value
    Exit Function
  End If

  If ASLocal.Pointer > 0 Then
    lResult = PathIsNetworkPath(ASLocal.Pointer)
  End If
  If lResult = 0 Then
    GetUNCPath = ASLocal.Value
    Exit Function
  End If

  ' Extract Root
  Set ASRoot = New APIString
  ASRoot.Value = sLocalPath
  If ASRoot.Length = 2 And Mid(ASRoot.Value, 2, 1) = ":" Then
    ' We have a Root with no Path
    Set ASPath = New APIString
    ASPath.Value = ""
  Else
    If ASRoot.Pointer > 0 Then
      lpResult = PathStripToRoot(ASRoot.Pointer)
    End If
    ASRoot.TruncToNull
    If ASRoot.Pointer > 0 And Mid(ASRoot.Value, ASRoot.Length) = "\" Then
      lpResult = PathRemoveBackslash(ASRoot.Pointer)
      ASRoot.TruncToPointer lpResult
    End If

    ' Extract Path
    Set ASPath = New APIString
    ASPath.Value = sLocalPath
    lpResult = PathSkipRoot(ASPath.Pointer)
    ASPath.TruncFromPointer lpResult
    If ASPath.Length > 0 Then
      If ASPath.Pointer > 0 And Mid(ASPath.Value, ASPath.Length) = "\" Then
        lpResult = PathRemoveBackslash(ASPath.Pointer)
        ASPath.TruncToPointer lpResult
      End If
    End If
  End If

  ' Resolve Local Root into Remote Root
  Set ASRemoteRoot = New APIString
  ASRemoteRoot.Init 255
  If ASRoot.Pointer > 0 And ASRemoteRoot.Pointer > 0 Then
    lResult = WNetGetConnection(ASRoot.Pointer, ASRemoteRoot.Pointer, LenB(ASRemoteRoot.Value))
  End If
  ASRemoteRoot.TruncToNull

  GetUNCPath = ASRemoteRoot.Value & ASPath.Value
End Function 
```

**类模块：APIString**

```
Option Compare Database
Option Explicit

 Private sBuffer As String

 Private Sub Class_Initialize()
   sBuffer = vbNullChar
 End Sub

 Private Sub Class_Terminate()
   sBuffer = ""
 End Sub

 Public Property Get Value() As String
   Value = sBuffer
 End Property

 Public Property Let Value(ByVal sNewStr As String)
   sBuffer = sNewStr
 End Property

 ' Truncates Length
#If VBA7 Then
  Public Sub TruncToPointer(ByVal lpNewUBound As LongPtr)
#Else
  Public Sub TruncToPointer(ByVal lpNewUBound As Long)
#End If
   Dim lpDiff As Long
   If lpNewUBound <= StrPtr(sBuffer) Then Exit Sub
   lpDiff = (lpNewUBound - StrPtr(sBuffer)) \ 2
   sBuffer = Mid(sBuffer, 1, lpDiff)
 End Sub

 ' Shifts Starting Point forward
#If VBA7 Then
 Public Sub TruncFromPointer(ByVal lpNewLBound As LongPtr)
#Else
 Public Sub TruncFromPointer(ByVal lpNewLBound As Long)
#End If
   Dim lDiff As Long
   If lpNewLBound <= StrPtr(sBuffer) Then Exit Sub
   If lpNewLBound >= (StrPtr(sBuffer) + LenB(sBuffer)) Then
     sBuffer = ""
     Exit Sub
   End If
   lDiff = (lpNewLBound - StrPtr(sBuffer)) \ 2
   sBuffer = Mid(sBuffer, lDiff)
 End Sub

 Public Sub Init(Size As Long)
   sBuffer = String(Size, vbNullChar)
 End Sub

Public Sub TruncToNull()
  Dim lPos As Long
  lPos = InStr(sBuffer, vbNullChar)
  If lPos = 0 Then Exit Sub
  sBuffer = Mid(sBuffer, 1, lPos - 1)
End Sub

Public Property Get Length() As Long
  Length = Len(sBuffer)
End Property

#If VBA7 Then
 Public Property Get Pointer() As LongPtr
#Else
 Public Property Get Pointer() As Long
#End If
   Pointer = StrPtr(sBuffer)
 End Property 
```

感谢您的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:48:31.353

所以你所做的就是假装字符串总是指针的一点抽象（嗯......实际上，这是一个反向抽象来删除指针是字符串的内置抽象）。

您现在需要一种简单的方法来使用该抽象。

上课，`WrappedString`（*未测试，没有 Office 2010*）：

```
Option Explicit

Private Declare Sub CopyMemory Lib "kernel32.dll" Alias "RtlMoveMemory" (ByRef Destination As Any, ByRef Source As Any, ByVal Length As Long)

Private buf() As Byte

Friend Sub Init(s As String)
  Dim len_of_s_in_bytes As Long
  len_of_s_in_bytes = LenB(s)

  If len_of_s_in_bytes = 0 Then Exit Sub

  #If UNICODE Then
    ReDim b(1 To len_of_s_in_bytes + 2) 'Adding the null terminator
    CopyMemory b(LBound(b)), ByVal StrPtr(s), len_of_s_in_bytes
  #Else
    b = StrConv(s & vbNullChar, vbFromUnicode)
  #End If

End Sub

#If VB7 Then
Public Property Get Pointer() As LongPtr
  Pointer = VarPtr(b(LBound(b)))
End Property
#Else
Public Property Get Pointer() As Long
  Pointer = VarPtr(b(LBound(b)))
End Property
#End If 
```

*为什么你需要一个类而不仅仅是一个转换函数：避免内存泄漏。需要释放分配的指针，类析构函数会处理这个问题。*

然后在一个模块中有一个构造函数：

```
Public Function ToWrappedString(s As String) As WrappedString
  Set ToWrappedString = New WrappedString
  ToWrappedString.Init s
End Function 
```

然后你可以调用你的函数：

```
lResult = PathIsNetworkPath(ToWrappedString("T:\TEST\").Pointer) 
```

* * *

显然，您可以将这个抽象更进一步：

有一个模块，把你所有的`declare`s 放在那里并将它们设为私有。
然后在该模块中具有公共函数，每个`declare`d 函数（即`Public Function PathSkipRoot (...) As String`等）一个公共函数`Public Function PathRemoveBackslash (...) As String`，并使每个公共包装器`declare`使用 d 调用 d 函数`WrappedString`。
然后其余代码将只看到`String`函数的普通版本。

# jquery - 执行ajax加载的javascript代码

> ID：10402823
> 
> 赞同：2
> 
> 时间：2012-05-01T19:06:12.803
> 
> 标签：jquery, ajax, dom

我正在加载包含一些 javascript 代码的页面，并且`$.getScript()`方法在这里不起作用，因为一些 javascript 代码是通过 php 动态构建的。

```
<div id="fetch-me">
...
<script...>
var posts = <?php .... ?> 
...
</script>
</div> 
```

你可能对这类问题很熟悉，一旦我加载了这个 div：

```
$("#load-me").load("... #fetch-me"); 
```

Javascript 不可用。我显然需要执行。而且我尝试了几件事，但没有成功。作为一个例子：

```
$("#load-me").load("... #fetch-me", function(){
 eval($("#load-me").find("script").text());
}); 
```

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:09:08.137

`load`将返回它在回调中加载的数据。尝试获取脚本并将它们附加到`<script>`标签。

```
$("#load-me").load("... #fetch-me", function(data){
    $('<script>').html($(data).filter('script').html()).appendTo('head');
}); 
```

如果加载的页面中有多个脚本标签，那可能不起作用。如果是这种情况，试试这个：

```
$("#load-me").load("... #fetch-me", function(data){
    $(data).filter('script').each(function(){
        $('<script>').html($(this).html()).appendTo('head');
    });
}); 
```

PS 如果这不起作用，请尝试更改`.filter`为`.find`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:08:55.097

您是否在 javascript 中为字符串变量添加了引号？

```
var posts = "<?php .... ?>" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:13:47.863

你可以这样做：

```
$.get("page.php", function(data){
    //data is the information that page.php returns
    //Now instead of use this --> var posts = <?php .... ?>
    //do this:
    var post = data;
}); 
```

# .htaccess - 如何使用 .htaccess 简化我的网址？

> ID：10402827
> 
> 赞同：0
> 
> 时间：2012-05-01T19:06:25.667
> 
> 标签：.htaccess, url-rewriting

我想要这个：

```
http://www.website.com/test/view 
```

实际调用这个：

```
http://www.website.com/index.php/test/view 
```

我尝试了一个看起来像这样的 .htaccess 文件，但它似乎不起作用：

```
RewriteEngine on
RewriteCond $1 !^index\.php
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:15:26.740

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^ index.php%{REQUEST_URI} [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:13:51.170

您是否在第一行设置了“RewriteEngine On”？

我用过一次，对我来说效果很好：

```
RewriteEngine On
RewriteRule ^([a-z\-]+)$ /index.php?page=$1 [L] 
```

# ruby-on-rails - mongoid - 从引用 1..N 关系中的父级删除子对象

> ID：10402832
> 
> 赞同：4
> 
> 时间：2012-05-01T19:06:37.697
> 
> 标签：ruby-on-rails, mongoid

当我这样做时，我注意到：

```
parent.children.delete_all(condition: {obj_id: obj.id}) 
```

然后我做：

```
parent.children 
```

我仍然看到对我试图删除的对象的引用。

如果我改为：

```
parent = Parent.where(id) #get the parent again from db
parent.children 
```

我注意到孩子不见了。

如何确保当我删除一个孩子时，它会从数据库中删除它，并在一个操作中从数组中删除引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T12:46:26.153

尝试使用`destroy_all`而不是`delete_all`.

# iphone - NSData 到字节数组（或整数数组）

> ID：10402834
> 
> 赞同：2
> 
> 时间：2012-05-01T19:06:46.080
> 
> 标签：iphone, uiimage, bytearray, nsdata

我正在使用一个网络服务，它给我一个整数数组的图像。我已经设法将此数组转换为一个`NSData`对象，然后`UIImage`使用下面的代码转换为一个对象。现在我怀疑如何将图像转换为类似的数组。

数组如下所示：

```
[255,216,255,224,0,16,74,70,73,70,0,1,1,1,0,96,0,96,0,0,255,219,0,67,0,8,6,6,7,6,5,8,7,7,7,9,9,8,10,12,...] 
```

这是我用来将上述数组转换为`UIImage`.

```
+ (UIImage *)imageFromBytes:(NSArray *)bytes
{
    unsigned char *buffer = (unsigned char *) malloc(bytes.count);
    int i = 0;
    for (NSDecimalNumber *num in bytes)
        buffer[i++] = num.intValue;
    NSData *data = [NSData dataWithBytes:buffer length:bytes.count];
    free(buffer);

    return [UIImage imageWithData:data];
} 
```

因此，我需要将 a`UIImage`转换为整数数组（字节数组）。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:25:20.897

您可以通过以下方式获取图像的数据：

```
UIImage *image = [UIImage imageNamed:@"image.png"];
NSData *data = UIImagePNGRepresentation(image); 
```

如果您使用 JPG，则可以使用 UIImageJPEGRepresentation。

然后，提取字节数组：

```
NSUInteger len = [data length];
Byte *byteData = (Byte*)malloc(len);
memcpy(byteData, [data bytes], len);
free(byteData) 
```

您也可以使用`(void)getBytes:(void *)buffer length:(NSUInteger)length`NSData 中的方法：

```
[data getBytes:&byteData length:len]; 
```

# .htaccess - 我的drupal网站网址的重写规则不起作用

> ID：10402836
> 
> 赞同：0
> 
> 时间：2012-05-01T19:07:01.337
> 
> 标签：.htaccess, mod-rewrite, redirect, url-rewriting, drupal-6

我正在尝试在其 .htaccess 文件中为我的 drupal 站点编写一些重写规则，但它似乎根本不起作用。我在正则表达式和 mod_rewrite 方面缺乏先验知识和经验似乎也无济于事。

我试图重写的 URL 如下

*来源：*

`http://www.mydrupalsite.com/somealphanumericwithspecialchars/somealphanumericwithspecialchars/somealphanumericwithspecialchars/somealphanumericwithspecialchars/Keyword1/Keyword2/UNIQUEID?queryparam1=somenumber`

*目的地：*

`http://www.mydrupalsite.com/legacystuff/UNIQUEID`

我的 .htaccess mod_rewrite 代码是

```
 RewriteEngine on
  # Rewrite URLs of the form 'x' to the form 'index.php?q=x'.
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_URI} !=/favicon.ico
  #This is the only rule written by me others are drupals
  RewriteRule ^(.*)/(.*)/(.*)/(.*)/Keyword1/Keyword2/([0-9]*)?$ legacystuff/content/$5 [R=302]
  RewriteRule ^(.*)$ index.php?q=$1 [L,QSA] 
```

基于对教程的一些快速浏览，我的理解和实现是前四个`(.*)`将与 URL 中的四个字母数字特殊字符匹配，关键字 1 和关键字 2 将保持不变，因此我可以匹配它们，我的目的地实际需要的唯一数字 id URL（目标中的参数 $5）将被`([0-9*])?`. 我在本地环境的*httpd.conf中使用以下虚拟主机*

```
<VirtualHost *:80>
DocumentRoot "C:/wamp/www/mydrupalsite"
ServerName mydrupalsite.com
</VirtualHost> 
```

我的问题是重新启动本地服务器并清除缓存后，不会发生从源 URL 到目标 URL 的重定向。任何关于我哪里出错以及如何改正的帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T15:15:37.697

终于让它工作了，为我的虚拟主机设置添加了 RewriteBase 并将我的 RewriteRule 放在它下面，尾随 ? 在我的目的地忽略查询字符串和 L 标志。在我的 httpd.conf 中设置 RewriteLog 有助于从更好的角度理解事物。希望这可以帮助其他刚接触 .htaccess 在 drupal 中的人。

```
RewriteBase /
RewriteRule ^(.*)/(.*)/(.*)/(.*)/Keyword1/Keyword2/([0-9]*)?$ legacystuff/content/$5? [R=301,L] 
```

# unity-container - UnityContainer() 未找到加载配置

> ID：10402840
> 
> 赞同：13
> 
> 时间：2012-05-01T19:07:32.603
> 
> 标签：unity-container

我有这个代码：

```
1: IUnityContainer container = new UnityContainer();
2: container.LoadConfiguration(); 
```

第 1 行有效，但第 2 行无效。未找到 LoadConfiguration 作为成员。我想，我已经注册了所有的统一 dll。为什么找不到 LoadConfiguration()？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-01T19:10:28.417

`LoadConfiguration()`不是[IUnityContainer 的成员](http://msdn.microsoft.com/en-us/library/microsoft.practices.unity.iunitycontainer_members.aspx)。您一定在考虑其他一些类或接口。也许[这个？](http://msdn.microsoft.com/en-us/library/microsoft.practices.unity.configuration.unitycontainerextensions_members%28v=pandp.20%29.aspx)

`IUnityContainer`位于`Microsoft.Practices.Unity`命名空间中，但`LoadConfiguration()`扩展方法位于[Microsoft.Practices.Unity.Configuration](http://msdn.microsoft.com/en-us/library/microsoft.practices.unity.configuration%28v=pandp.20%29.aspx)命名空间中。您是否已将该名称空间添加到您的代码中？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-01-30T05:45:08.117

我相信在最新版本的 Unity 5.9.3 中，Microsoft.Practices.Unity dll 不是 nuget 的一部分。您必须从 nuget ' [Unity.Configuration](https://www.nuget.org/packages/Unity.Configuration/5.9.0/) '安装另一个包。它是 Unity 提供的开源软件包。截至今天，Unity Configuration 最新版本为 5.9.0。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-06-04T08:20:24.030

不仅

**应该安装**Unity.Configuration包****

 **但是也

```
using Microsoft.Practices.Unity.Configuration; 
```

应该在cs文件的顶部声明。**

# ruby - Ruby 无法以只读方式打开 644 文件

> ID：10402843
> 
> 赞同：0
> 
> 时间：2012-05-01T19:07:43.977
> 
> 标签：ruby, linux, permissions, munin

```
$ ruby -v
ruby 1.8.7 (2010-01-10 patchlevel 249) [x86_64-linux] 
```

这是脚本上的重要行（/etc/munin/plugins/nginx_status_codes.rb:31）：

```
File.open("/var/log/nginx/access.log", File::RDONLY).readlines.each do |line| 
```

我的访问日志具有全局读取权限：

```
$ ls -lha /var/log/nginx/access.log
-rw-r--r-- 1 www-data adm 49M May  1 15:56 /var/log/nginx/access.log 
```

如果我以普通用户身份从终端运行，则该脚本有效...

```
$ /etc/munin/plugins/nginx_status_codes > /dev/null && echo $?
0 
```

...但如果由 Munin 运行（以**root**身份运行），则会失败：

```
2012/05/01-15:54:05 [3988]  /etc/munin/plugins/nginx_status_codes:31:in `initialize': Permission denied - /var/log/nginx/access.log (Errno::EACCES)
2012/05/01-15:54:05 [3988]      from /etc/munin/plugins/nginx_status_codes:31:in `open'
2012/05/01-15:54:05 [3988]      from /etc/munin/plugins/nginx_status_codes:31 
```

如果我将文件权限设置为 777 或其他，它也会失败。我认为 Ruby 只是愚蠢并报告错误的异常（Errno：EACCES）并伪装真正的问题。但那会是什么？

更新：试图通过让脚本由 root:root 拥有，**甚至**设置 sid/gid 位来“修复”它，但它会因权限被拒绝而失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:11:36.553

没关系。问题是 logrotation 已经到位，它不时更改日志文件权限：

```
$ cat /etc/logrotate.d/nginx 
/var/log/nginx/*.log {
    daily
    missingok
    rotate 52
    compress
    delaycompress
    notifempty
    create 0640 www-data adm
    sharedscripts
    prerotate
        if [ -d /etc/logrotate.d/httpd-prerotate ]; then \
            run-parts /etc/logrotate.d/httpd-prerotate; \
        fi; \
    endscript
    postrotate
        [ ! -f /var/run/nginx.pid ] || kill -USR1 `cat /var/run/nginx.pid`
    endscript
} 
```

# memory-management - 我应该使用哪些 Instruments 工具来了解我的 Monotouch 应用程序的内存使用情况？

> ID：10402845
> 
> 赞同：4
> 
> 时间：2012-05-01T19:07:51.550
> 
> 标签：memory-management, xamarin.ios, instruments

我一直在阅读很多关于在 Instrument's 中跟踪内存使用情况的文章，但发现很少与 Monotouch 结合使用。

这里似乎有三个反对的主张：

1.  使用*Instruments的**Allocation*实用程序。“活动字节”的数量是应用程序使用的物理内存量。
**   使用*内存监视器*插件。从进程列表中，选择您的应用并检查“真实内存”列。这是当前使用的 RAM 量。*   使用*VM Tracker*并制作自动快照。如果您想要的是“脏大小”。*

 *据我观察：

*   一旦触发 GC，“Real Memory”就会下降
*   即使我的“Live Bytes”保持在 30MB 左右，我最终也会收到内存警告
*   通过恒定的“Live Bytes”，“Real Memory”可以显着增加并轻松增长到 200MB 或更多。
*   在使用 QLPreviewController 并查看一个非常大的 Word 文档（1000 页）时，滚动浏览该文档会疯狂地增加真实内存。如果收到内存警告，则实际内存和活动字节都不会下降。最终，应用程序会崩溃；Monotouch问题还是Apple的问题？
*   有时，真实的记忆似乎在增长，没有什么可以阻止它。再说一次，GC 似乎清除了大部分。这没有真正的模式。

那么正确答案是什么？有没有一个？

**编辑**：我附上了两张图片。一个显示在我的应用程序生命周期中的一个阶段的内存使用情况，以及稍后的几秒钟。两个图像都反映了 UI 中同一点的内存使用情况，屏幕上只有两个控制器。也许有人仍然可以评论从这些数字中可以读出什么，尤其是神奇的“记忆标签 70”。

![在此处输入图像描述](../Images/fef947f582b1f81c598f5a2ddd21ed4d.png) ![在此处输入图像描述](../Images/3605f395b7422ce0f30381fb75b15d29.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T10:44:12.917

Instruments 有点像一个黑匣子，但我认为它是这样的：

> 这里似乎存在三个相反的主张：
> 1\. 使用 Instruments 的 *Allocation*s 实用程序。“活动字节”的数量是应用程序使用的物理内存量。

我不确切知道“Live Bytes”是什么，但这不是应用程序使用的物理内存量。我*认为*这是所有 ObjectiveC 对象使用的物理内存量（如果这个理论是正确的，“Live Bytes”不包含托管代码使用的任何内存，也不包含 ObjectiveC 对象（例如图像数据）间接使用的任何内存，其中似乎是真的）。如果您想追踪泄漏的对象，“Live Bytes”绝对有用，但它不是（必然）一个很好的指标，可以指示实际使用了多少内存。

> 2\. 使用内存监视器插件。从进程列表中，选择您的应用并检查“真实内存”列。这是当前使用的 RAM 量。

这有点接近：“Real Mem”是应用程序正在使用的不与其他应用程序共享的物理内存量。应用程序使用的物理内存总量是“Virtual Mem”，但应用程序之间共享了大块“Virtual Mem”（即共享库在加载到内存时当然会使用内存，但由于它是不可变的，它会只为所有进程加载一次。但是它将被添加到每个进程的“虚拟内存”中，因此如果您添加所有进程使用的“虚拟内存”，您将远远超出设备的实际物理内存）。

> 3\. 使用 VM Tracker 并制作自动快照。如果您想要的是“脏大小”。

正确的。“Dirty Size”是您所追求的 - 然而，这与“Real Mem”密切相关，它只是将“Real Mem”分成类别，因此您可以轻松查看正在使用内存的内容。

对于由于泄漏图像而使用大量内存的典型情况，过程如下：
1\. 使用内存监视器验证您的应用程序确实存在内存问题。
2\. 在 VM Tracker / "Dirty Size" 中看到图像数据使用了大量内存（这就是神奇的 "Memory Tag 70"）。
3\. 使用 Allocations 找出 CGImage 的创建位置，查看相应的堆栈跟踪并追踪这些图像未释放的原因。

但是，每个应用程序都不同，因此不可能提出适用于所有情况的简短配方。

> *   一旦触发 GC，“Real Memory”就会下降
> *   即使我的“Live Bytes”保持在 30MB 左右，我最终也会收到内存警告
> *   通过恒定的“Live Bytes”，“Real Memory”可以显着增加并轻松增长到 200MB 或更多。

所有这些都在上面解释过。

> *   在使用 QLPreviewController 并查看一个非常大的 Word 文档（1000 页）时，滚动浏览该文档会疯狂地增加真实内存。如果收到内存警告，则实际内存和活动字节都不会下降。最终，应用程序会崩溃；Monotouch问题还是Apple的问题？

这也可能是您的问题:) 如果不知道内存的去向，就无法判断。

> *   有时，真实的记忆似乎在增长，没有什么可以阻止它。再说一次，GC 似乎清除了大部分。这没有真正的模式。

你的意思是当你的应用程序完全没有做任何事情时，你正在观察真实内存的增长？如果你真的在你的应用程序中做某事，这是完全正常的。*

# string - 需要一个例程来检测相似但不相同的字符串

> ID：10402858
> 
> 赞同：11
> 
> 时间：2012-05-01T19:09:08.823
> 
> 标签：string, delphi

我有一个字符串列表，其中一些自我之前的版本以来已被修改。一些变化是微不足道的（间距，一个字等）。我想检测只有“微小”差异的字符串，以便尽可能尝试使用较旧的翻译。

我所说的“细微差别”是什么意思？在我开始使用数据库之前我不会知道。

您是否知道任何可以指示两个字符串何时相似但不相同的可调例程？任何将返回一个数字的例程，指示两个字符串的不同之处？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T19:21:00.360

有很多这样的算法。关键字是**模糊字符串匹配**。

一个众所周知的是[Levenshtein distance](http://en.wikipedia.org/wiki/Levenshtein_distance)。通过它，您可以计算将一个字符串转换为另一个字符串所需的“更改”次数，以便您估计字符串的相似程度。

另请参阅此问题：[如何](https://stackoverflow.com/questions/886835/how-to-search-for-similar-words)在 Delphi 中搜索解决方案的相似词。

# ios - iOS 日历集成到应用程序

> ID：10402860
> 
> 赞同：4
> 
> 时间：2012-05-01T19:09:14.550
> 
> 标签：ios, calendar

我有一个应用程序，所以我只是在我的应用程序中添加了一些特定日期和时间的事件或剩余部分（足球比赛、电影）。这个添加事件我也想在 iphone 日历中显示。

谢谢并恭祝安康。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:14:03.570

你检查[过 EventKit](http://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/EventKitProgGuide/Introduction/Introduction.html)吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-20T06:04:24.387

您可以为此使用简单的 JTCalender

首先 oyu 必须在项目中包含 JT Calender 框架

您必须在 UIViewController 中创建两个视图：

第一个视图是 JTCalendarMenuView，它表示带有月份名称的部分。此视图是可选的。第二个视图是 JTHorizo​​ntalCalendarView 或 JTVerticalCalendarView，它代表日历本身。你的 UIViewController 必须实现 JTCalendarDelegate，所有方法都是可选的。

## 在 .h 文件中

```
#import <UIKit/UIKit.h>
#import "CustomTableViewCell.h"

#import "JTCalendar/JTCalendar.h"

@interface CalendarViewController : UIViewController<UITableViewDataSource,UITableViewDelegate,JTCalendarDelegate>

@property (strong, nonatomic)  JTCalendarMenuView *calendarMenuView;
@property (strong, nonatomic) JTHorizontalCalendarView *calendarContentView;

@property (strong, nonatomic) JTCalendarManager *calendarManager;

@property (weak, nonatomic) IBOutlet NSLayoutConstraint *calendarContentViewHeight;

@end

.m file
------------

#import "CalendarViewController.h"

#import "ApptWindowView.h"
#import "SVProgressHUD.h"

@interface CalendarViewController () < UITextFieldDelegate>{
    NSMutableDictionary *dayDateDict;
    NSMutableArray*jsonDate,*dateAr1,*dateAr2;
    UITableView *appointTableView;
    CGSize screenRect;
    NSString *dateAfterString;

    int fontSize,headerBtnfont,height;
    NSDateFormatter *dateFormat1 ;
    NSString*cmpDay;
    int count;
    NSString * clickedDate;
    NSString *day ;

     NSMutableDictionary *_eventsByDate;

        NSDate *_todayDate;
        NSDate *_minDate;
        NSDate *_maxDate;

        NSDate *_dateSelected;

  UIActivityIndicatorView *activityIndicator;
    int i;
}

@end

@implementation CalendarViewController
- (void)viewDidLoad
{
    [super viewDidLoad];

        i=0;
    dayDateDict=[[NSMutableDictionary alloc]init];
    dateAr1=[[NSMutableArray alloc]init];
    dateAr2=[[NSMutableArray alloc]init];
    screenRect=[[UIScreen mainScreen]bounds].size;

    //Create header here
    self.view.backgroundColor=[UIColor colorWithRed:(CGFloat)233/255 green:(CGFloat)239/255 blue:(CGFloat)239/255 alpha:1];
    UIView * headerView =[[UIView alloc]initWithFrame:CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width, 55)];
    headerView.backgroundColor =[UIColor whiteColor];
    [self.view addSubview:headerView];

    UILabel * titleLable =[[UILabel alloc]initWithFrame:CGRectMake(60, 25, [UIScreen mainScreen].bounds.size.width-120, 25)];
    titleLable.text =@"CHOOSE APPOINTMENT";
    titleLable.textAlignment = NSTextAlignmentCenter;
    titleLable.font =[UIFont systemFontOfSize:12];
    [headerView addSubview:titleLable];

    UIButton *backButton =  [UIButton buttonWithType:UIButtonTypeCustom];
    [backButton setImage:[UIImage imageNamed:@"back_btn.png"] forState:UIControlStateNormal];
    [backButton setFrame:CGRectMake(15, 30, 45, 15)];
    [backButton addTarget:self action:@selector(backAction) forControlEvents:UIControlEventTouchUpInside];
    [headerView addSubview:backButton];

    UIButton *nextButton =  [UIButton buttonWithType:UIButtonTypeCustom];
    [nextButton setImage:[UIImage imageNamed:@"next_btn.png"] forState:UIControlStateNormal];
    [nextButton setFrame:CGRectMake([UIScreen mainScreen].bounds.size.width-60, 30, 45, 15)];
    [nextButton addTarget:self action:@selector(continueAction) forControlEvents:UIControlEventTouchUpInside];
    [headerView addSubview:nextButton];

    [self activityAction];
    dispatch_async(dispatch_get_global_queue(0, 0),^{

        dispatch_async(dispatch_get_main_queue(),^{
            // [self createUI];
            [self fetchSchedule];

            _calendarManager = [JTCalendarManager new];
            _calendarManager.delegate = self;
            [self createMinAndMaxDate];
     _calendarContentView=[JTHorizontalCalendarView new];         
            _calendarContentView.frame = CGRectMake(20, 100,[UIScreen mainScreen].bounds.size.width-40 , [UIScreen mainScreen].bounds.size.width-40);
            _calendarContentView.backgroundColor=[UIColor whiteColor];

            [_calendarManager setContentView:_calendarContentView];
            [self.view addSubview:_calendarContentView];

            _calendarMenuView=[JTCalendarMenuView new];
            _calendarMenuView.frame=CGRectMake(20, 55,[UIScreen mainScreen].bounds.size.width-40 ,50);
            _calendarMenuView.backgroundColor=[UIColor clearColor];
            [self.view addSubview:_calendarMenuView];
            [_calendarManager setMenuView:_calendarMenuView];
            [_calendarManager setDate:[NSDate date]];

            [activityIndicator stopAnimating];
        });

    });

    [self createUI];

}
-(void)continueAction{
    ApptWindowView *apptWindow=[[ApptWindowView alloc]init];
    [self.navigationController pushViewController:apptWindow animated:YES];
}
- (UIView<JTCalendarDay> *)calendarBuildDayView:(JTCalendarManager *)calendar
{
    JTCalendarDayView *view = [JTCalendarDayView new];
    view.textLabel.font = [UIFont fontWithName:@"Avenir-Light" size:13];
    view.textLabel.textColor = [UIColor blackColor];

    return view;
}

    NSError *error;   NSURLResponse * urlResponse;

    NSURL * url =[NSURL URLWithString:fetchScheduleService];

    NSMutableURLRequest  * request =[[NSMutableURLRequest alloc]initWithURL:url cachePolicy:NSURLRequestReloadIgnoringCacheData timeoutInterval:50];

    NSString * body =[NSString stringWithFormat:@"departmentId=%d",[SingletonClass sharedSingleton].deptId ];

    [request setHTTPMethod:@"POST"];
    [request setHTTPBody:[body dataUsingEncoding:NSUTF8StringEncoding]];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    NSData * data =[NSURLConnection sendSynchronousRequest:request returningResponse:&urlResponse error:&error];
    if (!data) {
          [SVProgressHUD dismiss];
        return;
    }
    id jsonResponse =[NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingAllowFragments error:&error];

    NSLog(@"schedule jason---->%@",jsonResponse);

    if ([[jsonResponse objectForKey:@"code"] isEqualToNumber:[NSNumber numberWithInt:200]]) {

        jsonDate=[jsonResponse objectForKey:@"data"];

        [self convertTimeStamp];

    }
        //dispatch_async(dispatch_get_main_queue(),^{
            // [SVProgressHUD dismiss];
            //[self createUI];
      //  });

//    });

}

#pragma mark-Create UI/Table View
-(void)createUI{
    appointTableView = [[UITableView alloc]init];
    appointTableView.frame =  CGRectMake(10, 100+screenRect.width-40+10, screenRect.width-20, screenRect.height-( 100+screenRect.width-40+10));
    appointTableView.delegate = self;
    appointTableView.dataSource = self;
    appointTableView.backgroundColor =[UIColor clearColor];
    appointTableView.showsVerticalScrollIndicator = NO;
    appointTableView.separatorStyle = UITableViewCellSeparatorStyleNone;
    [self.view addSubview:appointTableView];
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return [[dayDateDict objectForKey:clickedDate] count];
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

    CustomTableViewCell * cell =(CustomTableViewCell*) [tableView cellForRowAtIndexPath:indexPath];
    if (!cell) {
        cell = [[CustomTableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"calender"];
        cell.backgroundColor = [UIColor clearColor];
    }
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    cell.selectionStyle = UITableViewCellSelectionStyleNone;

    [dateFormat1 setDateFormat:@"HH:mm"];

    NSDate * aptTime =[dateFormat1 dateFromString:[[dayDateDict objectForKey:clickedDate]objectAtIndex:indexPath.row] ];
    NSDate *dateAfter=[aptTime dateByAddingTimeInterval:(1800) ];
   dateAfterString =[dateFormat1 stringFromDate:dateAfter];
    NSString *dis=[NSString stringWithFormat:@"%@-%@",[[dayDateDict objectForKey:clickedDate]objectAtIndex:indexPath.row],dateAfterString];

    cell.appointmentTime.text =dis;

    return  cell;
}

-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
        return  100;
    }
    return 60;
}
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{

    ApptWindowView *apptWindow=[[ApptWindowView alloc]init];
    [self.navigationController pushViewController:apptWindow animated:YES];

    NSLog(@"clicked date-->%@",[[dayDateDict objectForKey:clickedDate]objectAtIndex:indexPath.row]);

    NSDate * aptTime =[dateFormat1 dateFromString:[[dayDateDict objectForKey:clickedDate]objectAtIndex:indexPath.row] ];
    NSDate *dateAfter=[aptTime dateByAddingTimeInterval:(1800) ];
    dateAfterString =[dateFormat1 stringFromDate:dateAfter];

    NSString *dis=[NSString stringWithFormat:@"%@ to %@ on %@",[[dayDateDict objectForKey:clickedDate]objectAtIndex:indexPath.row],dateAfterString,day];

    [[NSUserDefaults standardUserDefaults]setObject:dis forKey:@"appointmentTime"];
    [[NSUserDefaults standardUserDefaults]synchronize];

}
#pragma mark-convert timeStamp to date
-(void)convertTimeStamp{

    for( NSString*valueForDate in jsonDate){

 NSTimeInterval timeSec=[valueForDate doubleValue];
 NSDate *date = [NSDate dateWithTimeIntervalSince1970:timeSec];

 NSLog(@"\ndate are-->%@",date);

 [self separateDate:date];
    }

 }

 #pragma mark-separate date and Time
 -(void)separateDate:(NSDate*)date1{

dateFormat1 = [[NSDateFormatter alloc] init];

 [dateFormat1 setDateFormat:@"HH:mm"];

 NSString * resultTime =[dateFormat1 stringFromDate:date1];
 NSLog(@"date is-->%@",resultTime);

 [dateFormat1 setDateFormat:@"dd-MM-YYYY"];
 NSString *resultDay=[dateFormat1 stringFromDate:date1];
 NSLog(@"day is-->%@",resultDay);

          if([cmpDay isEqual:resultDay] || cmpDay==nil){

              if(count!=1){
               [dateAr1 addObject:resultTime];
              }
              if(count==1){

                  [dateAr2 addObject:resultTime];
              }

     }
          else{

              count=1;

               dateAr2=[[NSMutableArray alloc]init];
               [dateAr2 addObject:resultTime];
          }

     cmpDay=resultDay;

     if(count!=1){
     [dayDateDict setObject:dateAr1 forKey:resultDay];
     }
     else{
     [dayDateDict setObject:dateAr2 forKey:resultDay];
     }

     NSLog(@"dictionary--->%@",dayDateDict);

 }
#pragma mark - Buttons callback

- (IBAction)didGoTodayTouch
{
    [_calendarManager setDate:_todayDate];
}

- (IBAction)didChangeModeTouch
{
    _calendarManager.settings.weekModeEnabled = !_calendarManager.settings.weekModeEnabled;
    [_calendarManager reload];

    CGFloat newHeight = 300;
    if(_calendarManager.settings.weekModeEnabled){
        newHeight = 85.;
    }

    self.calendarContentViewHeight.constant = newHeight;
    [self.view layoutIfNeeded];
}

#pragma mark - CalendarManager delegate

// Exemple of implementation of prepareDayView method
// Used to customize the appearance of dayView
- (void)calendar:(JTCalendarManager *)calendar prepareDayView:(JTCalendarDayView *)dayView
{
    // Today
    if([_calendarManager.dateHelper date:[NSDate date] isTheSameDayThan:dayView.date]){
        dayView.circleView.hidden = NO;
        dayView.circleView.backgroundColor = [UIColor blueColor];
        dayView.dotView.backgroundColor = [UIColor whiteColor];
        dayView.textLabel.textColor = [UIColor whiteColor];
    }
    // Selected date
    else if(_dateSelected && [_calendarManager.dateHelper date:_dateSelected isTheSameDayThan:dayView.date]){
        dayView.circleView.hidden = NO;
        dayView.circleView.backgroundColor = [UIColor redColor];
        dayView.dotView.backgroundColor = [UIColor whiteColor];
        dayView.textLabel.textColor = [UIColor whiteColor];
    }
    // Other month
    else if(![_calendarManager.dateHelper date:_calendarContentView.date isTheSameMonthThan:dayView.date]){
        dayView.circleView.hidden = YES;
        dayView.dotView.backgroundColor = [UIColor redColor];
        dayView.textLabel.textColor = [UIColor lightGrayColor];
    }
    // Another day of the current month
    else{
        dayView.circleView.hidden = YES;
        dayView.dotView.backgroundColor = [UIColor redColor];
        dayView.textLabel.textColor = [UIColor blackColor];
    }

    if([self haveEventForDay:dayView.date]){
        dayView.dotView.hidden = NO;
    }
    else{
        dayView.dotView.hidden = YES;
    }
}

- (void)calendar:(JTCalendarManager *)calendar didTouchDayView:(JTCalendarDayView *)dayView
{
    _dateSelected = dayView.date  ;

    NSLog(@"orginal Clicked day-->%@",dayView.date);

    NSDateFormatter *dateFormat2 = [[NSDateFormatter alloc] init];

            [dateFormat2 setDateFormat:@"dd-MM-YYYY"];

            clickedDate =[dateFormat2 stringFromDate:_dateSelected];

            NSLog(@"Selected date===>%@",clickedDate);

            NSString* s= [dayDateDict objectForKey:clickedDate];
            NSLog(@"time is===>%@",s);

            [dateFormat2 setDateFormat:@"EEE, MMM dd "];

           day =[dateFormat2 stringFromDate:_dateSelected];

            NSLog(@"Selected day===>%@",day);

    // Animation for the circleView
    dayView.circleView.transform = CGAffineTransformScale(CGAffineTransformIdentity, 0.1, 0.1);
    [UIView transitionWithView:dayView
                      duration:.3
                       options:0
                    animations:^{
                        dayView.circleView.transform = CGAffineTransformIdentity;
                        [_calendarManager reload];
                    } completion:nil];

    // Load the previous or next page if touch a day from another month

    if(![_calendarManager.dateHelper date:_calendarContentView.date isTheSameMonthThan:dayView.date]){
        if([_calendarContentView.date compare:dayView.date] == NSOrderedAscending){
            [_calendarContentView loadNextPageWithAnimation];
        }
        else{
            [_calendarContentView loadPreviousPageWithAnimation];
        }
    }

    [appointTableView reloadData];
}

#pragma mark - CalendarManager delegate - Page mangement

// Used to limit the date for the calendar, optional
- (BOOL)calendar:(JTCalendarManager *)calendar canDisplayPageWithDate:(NSDate *)date
{
    return [_calendarManager.dateHelper date:date isEqualOrAfter:_minDate andEqualOrBefore:_maxDate];
}

- (void)calendarDidLoadNextPage:(JTCalendarManager *)calendar
{
    //    NSLog(@"Next page loaded");
}

- (void)calendarDidLoadPreviousPage:(JTCalendarManager *)calendar
{
    //    NSLog(@"Previous page loaded");
}

#pragma mark - Fake data

- (void)createMinAndMaxDate
{
    _todayDate = [NSDate date];

    // Min date will be 2 month before today
    _minDate = [_calendarManager.dateHelper addToDate:_todayDate months:-3];

    // Max date will be 2 month after today
    _maxDate = [_calendarManager.dateHelper addToDate:_todayDate months:3];
}

- (BOOL)haveEventForDay:(NSDate *)date
{
    if(i>=[dayDateDict allKeys].count){
        i=0;
    }
    NSDateFormatter *dateFormatter;

    dateFormatter = [[NSDateFormatter alloc]init];
     [dateFormatter setDateFormat:@"dd-MM-YYYY"];

    NSString *key = [dateFormatter stringFromDate:date];

    while(i<[dayDateDict allKeys].count){
    if([key isEqual:[[dayDateDict allKeys]objectAtIndex:i]]){
            i++;
            return YES;
    }

        else
            return NO;

    }

        return NO;

}

#pragma mark-Activity Indicator
-(void)activityAction{
    CGSize windowSize =[UIScreen  mainScreen].bounds.size;
    activityIndicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
    activityIndicator.frame = CGRectMake(windowSize.width/2-20, windowSize.height/2-55,40 ,40);
    activityIndicator.color = [UIColor blackColor];
    activityIndicator.alpha = 1;
    [self.view addSubview:activityIndicator];
    //[self placeSearchbaseId];

    [activityIndicator startAnimating];

}

@end 
```

我正在以时间戳格式获取 json 数据获取时间表单 json 并转换为本地时间

然后我在日历中为它创建一个事件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-15T04:57:34.760

您拥有支持日历集成的第三方应用程序，例如 Kal。检查此链接： [Kal日历](https://github.com/klazuka/Kal)

希望能帮助到你

# c# - 使用 CompileAssemblyFromSource 加载自定义程序集

> ID：10402863
> 
> 赞同：6
> 
> 时间：2012-05-01T19:09:28.500
> 
> 标签：c#

我不太确定该去哪里。总体目标是能够获取用户脚本，并在 .NET 环境中执行它。如果我不尝试加载自己的程序集，我已经编写了大部分代码并且一切正常。但是，为了让用户安全地访问系统的内部部分，我们创建了一个代理 DLL。这似乎是问题所在。

现在这个代理 DLL 里面有一个东西，一个接口。

```
CompilerParameters options = new CompilerParameters();
options.GenerateExecutable = false;
options.GenerateInMemory = true;
options.ReferencedAssemblies.Add("System.dll");
options.ReferencedAssemblies.Add("ScriptProxy.dll");

Microsoft.CSharp.CSharpCodeProvider provider = new Microsoft.CSharp.CSharpCodeProvider();
CompilerResults result = provider.CompileAssemblyFromSource(options, script);

// This line here throws the error:
return result.CompiledAssembly; 
```

运行上面的代码，它会抛出以下错误：

> System.IO.FileNotFoundException：无法加载文件或程序集 'file:///C:\Users...\AppData\Local\Temp\scts5w5o.dll' 或其依赖项之一。该系统找不到指定的文件。

当然，我的第一个想法是，“……什么是 scts5w5o.dll？”

这是`ScriptProxy.dll`没有正确加载，还是 ScriptProxy.dll 本身试图加载依赖项，这些依赖项位于某个临时文件中？还是完全不同的东西？

我应该提一下，我正在从 NUnit 测试运行程序执行此代码。我不确定这是否会有所不同。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T19:24:33.530

这是因为编译步骤失败并且您没有检查它是否有错误...

```
 static Assembly Compile(string script)
    {
        CompilerParameters options = new CompilerParameters();
        options.GenerateExecutable = false;
        options.GenerateInMemory = true;
        options.ReferencedAssemblies.Add("System.dll");
        options.ReferencedAssemblies.Add("ScriptProxy.dll");

        Microsoft.CSharp.CSharpCodeProvider provider = new Microsoft.CSharp.CSharpCodeProvider();
        CompilerResults result = provider.CompileAssemblyFromSource(options, script);

        // Check the compiler results for errors
        StringWriter sw = new StringWriter();
        foreach (CompilerError ce in result.Errors)
        {
            if (ce.IsWarning) continue;
            sw.WriteLine("{0}({1},{2}: error {3}: {4}", ce.FileName, ce.Line, ce.Column, ce.ErrorNumber, ce.ErrorText);
        }
        // If there were errors, raise an exception...
        string errorText = sw.ToString();
        if (errorText.Length > 0)
            throw new ApplicationException(errorText);

        return result.CompiledAssembly;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-29T08:42:27.897

我不认为标记为的帖子`answer`真的是一个**答案**！[...但是我在这里](https://stackoverflow.com/questions/18213894/metadata-file-domain-dll-could-not-be-found-when-using-csharpcodeprovider-refe)找到了答案

```
parameters.ReferencedAssemblies.Add(typeof(<TYPE FROM DOMAIN.DLL>).Assembly.Location); 
```

这意味着如果您尝试添加`dll`第三方引用（有时 .net dll 也会给出例外），那么只需将其复制到`executable folder`.. 它会正常工作.. 否则您也可以在那里定义完整路径..

# php - 删除字符串的最后一个字符（如果存在）

> ID：10402865
> 
> 赞同：2
> 
> 时间：2012-05-01T19:09:30.900
> 
> 标签：php

我有一个包含一些文本的字符串，最后一个字符可能（可能）是斜杠，我不想要。如果它存在，我该如何删除它？

这是“正确”的方式吗？

```
if(substr($str, -1) == "/") $str = rtrim($str, '/'); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T19:10:38.417

`rtrim`无条件使用，它更短，也可能更快。添加`if`的是噪音，不提供任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:26:54.233

如果你有一个字符串 $string 尝试使用

```
substr_replace($string ,"",-1); 
```

或者

```
substr($string, 0, -1); 
```

或者

```
mb_substr($string, 0, -1); 
```

它将从 $string 中删除最后一个字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-18T08:55:29.810

如果它是“/”，这将替换 url 的最后一个字符

```
concat(LEFT(url, LENGTH(url)-1),replace(right(url, 1),'/','')) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-27T22:53:15.093

在我的情况下，我需要删除几个符号，如“1”。或“2.”等。这是代码：

```
/**
 * @param string $string
 *
 * @return string
 */
private function cutNumbers($string)
{
    for ($i = 1; $i < 20; $i++) {
        $position = strpos($string, $i . '.');

        if ($position === 0) {
            $string = substr($string, 2);
        }
    }

    return $string;
} 
```

PS：我知道有更好的解决方案，但无论如何 - 修补程序会帮助某人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-10T19:46:28.143

与两个参数一起使用`rtrim`（要修剪的字符串，要删除的字符）

对于您的情况：

```
rtrim($str, '/'); 
```

# aix - 什么可能导致以下程序集执行结果

> ID：10402867
> 
> 赞同：1
> 
> 时间：2012-05-01T19:09:34.087
> 
> 标签：aix, dbx, assembly

我在 IBM AIX 下使用 dbx 进行调试。我看到以下内容：

```
(dbx) print $r4
0x00000001614aa050 
(dbx) print *((int64*)0x00000001614aa050)
-1 
(dbx) print $r3
0x0000000165e08468 
Then I "stepi" my 64bit program which executed the following instruction:
std   r3,0x0(r4) 
```

然后我立即检查了该内存的内容：

```
(dbx) print *((int64*)0x00000001614aa050)
-1 
```

还是-1？我期待 $r3 中的内容应该保存到该内存中。然后我使用我的变量手动将值分配给该地址：

```
(dbx) print &bmc._pLong
0x00000001614aa050 
(dbx) assign bmc._pLong=(int64 *)0x0000000165e08468
(dbx) print *((int64*)0x00000001614aa050)
6004180072 (which is 0x0000000165e08468) 
```

怎么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T21:07:22.557

我认为，不知何故，这是“试点”错误。例如你做了stepi，然后显示std指令？这意味着这是它即将执行的指令——而不是它执行的指令——至少我认为这是正确的。

我会在之前和之后做一些 stepi，并确保我理解 stepi 在做什么。当然，打印出 iar 和 iar 上的指令，以验证 dbx 没有欺骗您。

# jquery - JQuery 手风琴选项卡 + 数据表

> ID：10402868
> 
> 赞同：-1
> 
> 时间：2012-05-01T19:09:37.550
> 
> 标签：jquery, datatables, jquery-ui-accordion

如果您在 JQuery Accordion 选项卡中有一个 Datatable（带有可排序的表头），那么在用户打开 Accordion 选项卡以查看您的表时模拟单击特定表头的最佳方法是什么？

由于 Datatable 的宽度和其他相关信息在查看手风琴之前实际上并没有计算出来（从而在那时第一次显示 Datatable），我觉得需要使用 fnAdjustColumnSizing() ，但仅此一项并不能模拟单击表标题中的特定列。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:22:50.897

你的问题令人困惑。写下你想要完成的事情并展示一些代码。要模拟单击标题，请在标题选择器上使用它

```
jQuery(document).ready(function(){
    $('.accordion .head').click(function() {

  ("#selector").simulate("click");

}); 
```

编辑：

```
$('selector').trigger('click') 
```

# binding - 将子 ember 对象绑定到车把类

> ID：10402870
> 
> 赞同：0
> 
> 时间：2012-05-01T19:09:40.993
> 
> 标签：binding, ember.js, handlebars.js

ember.view 对象的子对象存在绑定问题。代码如下：

--从 Ember.TextField 扩展的文本框类

```
App.TextBox = Ember.TextField.extend({
attributeBindings:['placeholder', 'autocorrect','autocapitalize'],
value:null,
isInvalid:true,
validate:function(){
    this.set('isInvalid', false);
    return false;
},
focusOut:function(event){
    this.validate();
}}); 
```

---使用 App.Textbox 的视图

```
App.ViewTextBox = Ember.View.extend({
name:"viewName",
label:"View Label",
input: App.TextBox.extend({
    placeholder:function(){
        return this.get('parentView').get('label');
    }.property('label').cacheable()
})}); 
```

--带绑定的车把

```
{{#view App.ViewTextBox}}
{{label}}<br/>
{{#view input valueBinding="parentView.value"}}
   <div {{bindAttr class="isInvalid"}}></div> 
{{/view}}{{/view}} 
```

问题是这样的： 1）在视图的初始渲染之后，类被正确设置，但是通过 onFocusOut 调用对 isInvalid 值的后续更改，不要更改 DOM 中的类。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:32:21.090

您不能`view`在 Ember.TextField 中使用块助手。

# php - 带有 php 和/或 CSS 的字体大小

> ID：10402872
> 
> 赞同：0
> 
> 时间：2012-05-01T19:09:45.297
> 
> 标签：php, css, font-size

我正在尝试产生一种效果，即我在大写字母的页面上都有标题。但是，我希望看到每个单词的第一个字符具有稍大的字体大小。

例如：

我的头衔

M 和 T 的字体大小为 16，单词的其余部分大小为 12。我从数据库 (MySQL) 中提取标题，因此“我的标题”只是一个示例。可以是任何措辞。

我意识到有一种方法可以使用 substr （在 php 中）并搜索每个单词末尾的空格位置。但在我看来，这似乎会让编码变得有点混乱。

有人有更好的建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:23:36.070

我认为这样的东西是你正在寻找的。

**PHP**

```
<?php
$text = "My Title";
$newText = preg_replace('/(\w)(\w+\b)/', '<span class="firstLetter">$1</span>$2', $text);

echo $newText;  // <span class="firstLetter">M</span>y <span class="firstLetter">T</span>itle 
```

**CSS**

```
.firstLetter{font-size: 125%;} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T19:11:35.943

通过将每个首字母包装在标签中来使用[CSS 首字母伪元素：](http://reference.sitepoint.com/css/pseudoelement-firstletter)`<span>`

```
p span:first-letter
{ 
    font-size: 16pt;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:16:29.980

纯PHP解决方案：

```
<?php
$str = '<h2><big>S</big>ome <big>t</big>ext</h2>';
echo strtoupper($str);
?> 
```

CSS 解决方案：

```
<h2><span class="larger">S</span>ome <span class="larger">T</span>ext</h2>
<style type="text/css">
h2{text-transform:uppercase;}
.larger{font-size:larger;}
</style> 
```

**附加方法：**如果您希望能够输出具有可变字数的特定格式，您可以执行以下操作：

```
<?php
$string = 'VariaBle Number oF WORds!';
$words = explode(' ', $string);
$modified = array();
foreach($words as $word)
{
    $modified[] = '<big>'.substr($word, 0, 1).'</big>'.substr($word, 1, strlen($word));
}
echo strtoupper(implode(' ', $modified));
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T20:21:26.877

简单的 CSS 属性，

```
font-variant:small-caps; 
```

# silverlight - 在 Silverlight 中使用 ChildWindows 循环？

> ID：10402874
> 
> 赞同：0
> 
> 时间：2012-05-01T19:10:01.007
> 
> 标签：silverlight, silverlight-4.0, childwindow

我有一个带有文本框的控件。在用户输入几行文本并通过按钮提交之后，对于每一行文本，我需要显示一个带有网格的子窗口，用户必须在其中选择一些值。

假设用户输入了 5 行带有客户名称的文本（一行一个客户名称）。

对于他们每个人在单击提交后，他必须从 ChildWindow 中选择 Salesperson。

当然现在我的循环效果是同时打开 5 个 ChildWindows。

仅在从 Childwindow 网格中选择一个元素后，如何让用户获取下一个 ChildWindow ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:54:53.440

也许您的控件可以使用一个看起来像这样的类。

```
public class SalesPersonSelector
{
    private Queue<string> _clientNamesToProcess;
    private Dictionary<string, SalesPerson> _selectedSalesPersons;
    private Action<IDictionary<string, SalesPerson>> _onComplete;
    private string _currentClientName;

    public void ProcessNames(IEnumerable<string> clientNames, Action<IDictionary<string, SalesPerson>> onComplete)
    {
        this._clientNamesToProcess = new Queue<string>(clientNames);
        this._selectedSalesPersons = new Dictionary<string, SalesPerson>();
        this._onComplete = onComplete;
        this.SelectSalespersonForNextClient();
    }

    private void SelectSalespersonForNextClient()
    {
        if (this._clientNamesToProcess.Any())
        {
            this._currentClientName = this._clientNamesToProcess.Dequeue();
            ChildWindow childWindow = this.CreateChildWindow(this._currentClientName);
            childWindow.Closed += new EventHandler(childWindow_Closed);
            childWindow.Show();
        }
        else
        {
            this._onComplete(this._selectedSalesPersons);
        }
    }

    private ChildWindow CreateChildWindow(string nextClientName)
    {
        // TODO: Create child window and give it access to the client name somehow.
        throw new NotImplementedException();
    }

    private void childWindow_Closed(object sender, EventArgs e)
    {
        var salesPerson = this.GetSelectedSalesPersonFrom(sender as ChildWindow);
        this._selectedSalesPersons.Add(this._currentClientName, salesPerson);
        this.SelectSalespersonForNextClient();
    }

    private SalesPerson GetSelectedSalesPersonFrom(ChildWindow childWindow)
    {
        // TODO: Get the selected salesperson somehow.
        throw new NotImplementedException();
    }
} 
```

假设您的控件已经将 TextBox 中的名称拆分为一个名为“名称”的列表，那么您可以这样做：

```
var salesPersonSelector = new SalesPersonSelector();
salesPersonSelector.ProcessNames(names, selections =>
    {
        foreach (var selection in selections)
        {
            var clientName = selection.Key;
            var salesPerson = selection.Value;
            // TODO: Do something with this information.
        }
    }); 
```

我没有对此进行测试，但 Visual Studio 没有给我任何红色波浪线。

# url - Magento 类别网址

> ID：10402875
> 
> 赞同：0
> 
> 时间：2012-05-01T19:10:07.997
> 
> 标签：url, categories, magento-1.6

似乎无法在 Google 上找到与此相关的任何内容。虽然也许我没有搜索正确的关键字。

在 Magento 1.6 上，我创建了一个类别。例如，“测试”。的 seo 网址应该是：

mysite.com/test/

然后我删除了这个类别（愚蠢地），后来又重新创建了它。现在该类别被称为：

mysite.com/test-1/

有什么方法可以重置内部索引或其他东西，以便我可以再次获得网址：

mysite.com/test/

希望这是有道理的，有人可以提供帮助。

非常感谢您的阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:23:41.083

你试过在“URL Key”字段中写“test”吗？此行为与“重定向 301”标志有关。

再见朱塞佩

# asp.net - 数据库连接背后的代码

> ID：10402877
> 
> 赞同：1
> 
> 时间：2012-05-01T19:10:11.637
> 
> 标签：asp.net, multidimensional-array, database-connection, code-behind, dbconnection

我想在后面的代码中创建一个数据库连接。然后后面的代码将获取这两个字段的所有值并将它们放入一个多维度数组中。请让我知道是否有标准或经过验证的方法来解决这个问题。

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
             ConnectionString="<%$ ConnectionStrings:englishBritishConnectionString %>" 
             SelectCommand="SELECT [input], [ouput] FROM [converstion]">
</asp:SqlDataSource> 
```

这是与 asp.net 的标准数据库连接，以获得更准确的英特尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:55:59.230

这就是我一直这样做的方式。进口/使用上升到顶部，其余的进入一个函数。这是VB版本：

```
Imports System.Data.SqlClient

    Dim conn As New SqlConnection(ConfigurationManager.ConnectionStrings("englishBritishConnectionString").ConnectionString.ToString)
    Dim cmd As New SqlCommand("SELECT [input], [ouput] FROM [converstion]", conn)
    Dim dr As SqlDataReader = Nothing

    Try
        conn.Open()
        dr = cmd.ExecuteReader()
        While dr.Read()
            *do whatever with variables*
        End While
    Catch ex As Exception
        lblStatus.Text = "Error: " + ex.Message + vbCrLf + _
                         "Call stack:" + vbCrLf + ex.StackTrace
    Finally
        dr.Close()
        conn.Close()
    End Try 
```

我会看看我能对 C# 版本做些什么，因为我使用 C# 已经有一段时间了。

```
using System.Data.SqlClient

    SqlConnection conn = New SqlConnection(ConfigurationManager.ConnectionStrings("englishBritishConnectionString").ConnectionString.ToString);
    SqlCommand cmd = New SqlCommand("SELECT [input], [ouput] FROM [converstion]", conn);
    SqlDataReader dr;

    Try
    {
        conn.Open();
        dr = cmd.ExecuteReader();
        While dr.Read();
        {
            *do whatever with variables*
        }
    }
    Catch Exception ex
    {
        lblStatus.Text = "Error: " + ex.Message + " Call stack:" + ex.StackTrace;
    }
    Finally
    {
        dr.Close();
        conn.Close();
    } 
```

# c# - 为搜索结果重新绑定时，asp.net gridview 分页问题

> ID：10402879
> 
> 赞同：1
> 
> 时间：2012-05-01T19:10:28.563
> 
> 标签：c#, asp.net

我有一个网格视图，我在第一页加载时将其绑定，我在同一页面上有一些搜索选项，当单击搜索按钮时，我查询搜索，并使用来自搜索结果的新数据源重新绑定网格视图，问题是在重新绑定 gridview 之后，我有分页问题，​​我在第一个页面加载数据绑定中没有这些问题！谁能告诉我这是为什么？！

这是我的 Page_Load coe ：

```
protected void Page_Load(object sender, EventArgs e)
{
    DisableChaching();
    string val = Convert.ToString(Session["AccessLevel"]);
    if (Request.Cookies["UserName"] == null)
    {
        if (Session["UserName"] == null)
        {
            Response.Redirect("~/Default.aspx");
        }
        else if (val   == "2")
        {
            Response.Redirect("~/Default.aspx");
        }
    }
    else if (val == "2")
    {
        Response.Redirect("~/Default.aspx");
    }
    if (!IsPostBack)
    {
        LoadControls();
        BindGrid();
    }
} 
```

我的 GV_PageIndexChanging ：

```
protected void GV_PageIndexChanging(object sender, GridViewPageEventArgs e)
{

    GV.PageIndex = e.NewPageIndex;
    BindGrid();
    PageStatus(Status.None);
} 
```

我的 btnSearch_Click ：

```
 protected void btnSearch_Click(object sender, ImageClickEventArgs e)
 {
query = new CommonQueries();
       GV.DataSource = query.getBooksByGroupIDSubGroupID(DrpGroup.SelectedItem.Value,DrpSubGroup.SelectedItem.Value);
     GV.DataBind();
 } 
```

在 CommonQueries 类中，我使用了这个查询：

```
 public List<Book> getBooksByGroupIDSubGroupID(string GroupID, string SubGroupID)
{
    db = new BookMarketDataContext();
    List<Book> list = new List<Book>();
    list = (from b in db.Books where b.GroupID.ToString() == GroupID && b.SubGroupID.ToString() == SubGroupID  orderby b.Name select b).ToList();
    return list;
} 
```

更具体一点：在我的页面加载中，如果搜索结果足以导致 gridview 具有页码，并且当我单击搜索按钮“btnSearch”并重新绑定 gridview 后，gridview 页面更改但没有任何问题单击其中一个页码我从上一个 page_Load 得到错误的结果！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T15:28:43.480

您的分页回发似乎不包含有关应该分页的视图状态的信息。您应该将该信息向下推送到页面，以便它可以包含在回发中，或者将其存储在用户会话中（更少的往返，更多的服务器权重，但如果您还存储查询结果，则响应速度更快）。 ..

# jquery - 使用 jQuery 计算元素的高度

> ID：10402882
> 
> 赞同：0
> 
> 时间：2012-05-01T19:10:41.927
> 
> 标签：jquery

我需要根据屏幕的高度为元素分配一个高度。我的内容超过了屏幕折叠，所以我不能使用

```
$(window).height(); 
```

有没有办法计算打开窗口可见部分的高度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:18:13.170

另一种方法是这样的：

```
var height = window.innerHeight || document.documentElement.clientHeight || getElementsByTagName('body')[0].clientHeight; 
```

这将基于浏览器支持回退

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:15:02.670

要获得元素的可见高度，您将从窗口`offetTop`的 中减去元素的。`height`

```
var elTop = $("#element").offset().top;
var winHeight = $(window).height();
var elVisibleHeight = winHeight - elTop; 
```

如果`elVisibleHeight < 0`那么该元素位于屏幕折叠下方并且不可见。如果您需要跟踪元素的位置，则需要在 window 上更新它`scroll`。

**更新**

我用该理论的一个工作示例创建了一个小提琴。显然你可以缩短它，我把它写得很冗长，所以更清楚地知道发生了什么。

[**示例小提琴**](http://jsfiddle.net/PVUdB/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T19:25:12.193

这将向您显示文档或窗口高度的差异。

[http://jsfiddle.net/9YFwx/](http://jsfiddle.net/9YFwx/)

# algorithm - 在 Flex 中验证我们邮政编码的最有效方法

> ID：10402887
> 
> 赞同：1
> 
> 时间：2012-05-01T19:11:18.923
> 
> 标签：algorithm, actionscript-3, apache-flex, zipcode

我有一个 Flex 应用程序，它需要能够相当快地验证数百个邮政编码。我还想尽可能地减少应用程序使用的内存空间。

以下是我的团队提出的一些解决方案。对他们有什么想法吗？还有其他想法吗？

通过...检查每个邮政编码

1.  有效邮政编码数组
2.  无效邮政编码数组
3.  对验证邮政编码的 Web 服务的肥皂调用
4.  查询数据库表
5.  一棵树 - 5 个节点高，底部的节点将具有 zip 是否有效的布尔值。12345 的邮政编码将从根到它的第一个孩子，到它的第二个......你明白了
6.  通过有效的 USPS SCF 数组验证前 3 个数字，然后通过特定于该 SCF 的数组验证后两位数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:20:44.510

取决于你在寻找什么。您是要验证邮政编码的格式（即它是 5 位数长）还是要确保邮政编码是有效的美国邮政编码。我冒昧地猜测它是后者。查看 USPS 地址 API (https://www.usps.com/business/webtools-address-information.htm?)。我愿意打赌这将是完美的，并且比管理数据库或更新数组和管理所有 xxxxx+4 邮政编码的开销更少。

# asp.net-mvc - 适用于移动和非移动站点的 ASP.NET MVC 站点？

> ID：10402888
> 
> 赞同：0
> 
> 时间：2012-05-01T19:11:19.703
> 
> 标签：asp.net-mvc, asp.net-mvc-3, mobile, mobile-website

我正在一个网站上工作，使用带有 .aspx 页面的 ASP.NET MVC3。网站支持桌面浏览器和手机同站。该站点有一个母版页。我想避免重定向到移动网站，因为这会重复很多 html。我仍然打算使用用户代理来确定移动设备何时访问该站点，但我没有重定向浏览器，而是设置了我在母版页中使用的标志来控制生成的 HTML。

我在确定让母版页生成我想要的 HTML 的最佳方法时遇到了麻烦。我有两种解决这个问题的策略，但我不知道这是否是最好的方法。

第一个策略是，使用 mobile 标志来添加、替换或删除特定于移动设备的 HTML 内容。优点：最大限度地减少 HTML 的重复 缺点：多个 if 语句。需要下载第二个特定于移动设备的 .css。（由于 html 有多个 if 语句，我们确实需要 2 个 css 文件，一个用于移动设备，一个用于非移动设备。我们不能轻易使用特定性规则在一个 css 文件中处理）。

以下是使用此策略的母版页的摘录：

```
 <% if (isMobile)
    {  
        Html.RenderPartial("MobileSearchControls");
    }
    else                       
    { %>
            <div id="viewTabs" class="span3">
            ...
            </div>      
   <%  }
   %>            
        <%--body --%>
        <div id="bd" class="row-fluid">
            <% if (!isMobile)
               { %>
            <div id="left-column" class="span3">
                <div id='controls-and-preferences'>
                    <asp:ContentPlaceHolder ID="LeftColumnContent" runat="server" />
                </div> 
            </div><!--left-column -->
            <% }
            %>
            <div id="main" class="span9">
                <div id="search-results">
                    <asp:ContentPlaceHolder ID="MainContent" runat="server" />
                </div>
            </div>
            <% if (!isMobile)
               { %>    
            <div class="span2" id='right-column'>
           </div>
           <%  }
           %> 
```

第二种策略是将母版页中的大部分正文分为两部分，一部分用于移动设备，另一部分用于桌面。优点：避免下载额外的 .css 文件。（因为移动代码可以在 div 中，id 为 mobile 并在 css 中使用特定规则）。缺点：更多的代码重复。标签必须具有唯一的 ID，即使它们位于互斥的代码块中。
移动页面的 CSS 更复杂，因为所有标签都在移动标签下。

使用此策略的母版页的类似摘录：

```
<% if (isMobile)
   {
    %>
            <div id="mobile-search-controls">
                <asp:ContentPlaceHolder ID="MobileSearchContent" runat="server" />
            </div>                   

            <%--body --%>
            <div id="bd" class="row-fluid">       
                <div id="main" class="span9">
                    <div id="search-results">
                         <asp:ContentPlaceHolder ID="MobileMainContent" runat="server" />
                    </div>
                </div>
            </div>
            <%--body end--%>        
    </div>
<%
   }
   else
   { %>
    <div id="bd" class="row-fluid">            
     <div id="left-column" class="span3">
                    <div id='controls-and-preferences'>
                        <asp:ContentPlaceHolder ID="LeftColumnContent" runat="server" />
                    </div>                                                                           
                </div><!--left-column --> 

                <div id="main" class="span9">
                    <div id="search-results">
                        <asp:ContentPlaceHolder ID="MainContent" runat="server" />
                    </div>
                </div>
                <div class="span2" id='right-column'>                   
               </div>
        </div>
   <%--body end--%>
<% }
    %> 
```

我应该走哪条路？还有第三种更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:21:06.547

您可能需要考虑使用 Twitter Bootstrap (http://twitter.github.com/bootstrap/) 等框架。

他们有一些适用于任何分辨率设备的示例：

[http://twitter.github.com/bootstrap/examples/fluid.html](http://twitter.github.com/bootstrap/examples/fluid.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:18:07.037

你应该对这样的事情使用 css 3 媒体查询..看看这个链接它有一个演示
[http://webdesignerwall.com/demo/adaptive-design/final.html](http://webdesignerwall.com/demo/adaptive-design/final.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:35:14.023

用户277498，

我已将 Mobile Ready HTML5 MVC.NET 模板用于 vs：

[http://visualstudiogallery.msdn.microsoft.com/9df9c61c-4d90-43e5-9aa1-a58786b7a1e4](http://visualstudiogallery.msdn.microsoft.com/9df9c61c-4d90-43e5-9aa1-a58786b7a1e4)

效果很好。这基本上有一个视图引擎，允许将视图定向到 twds 移动和/或普通 mvc。它的工作方式实际上非常“神奇”。试一试，我现在已经在 3 个项目中使用过，没有任何问题。

# c# - 如何使用 moq 为单元测试设置服务器变量

> ID：10402889
> 
> 赞同：4
> 
> 时间：2012-05-01T19:11:23.947
> 
> 标签：c#, asp.net, unit-testing, moq

我正在使用[hanselman 教程](http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx)来使用 Moq 为我的 asp.net 页面创建单元测试。

我编写了以下代码来测试 contextbase 请求类中的 ServerVariables

```
HttpContextBase contextbase = MoqHelper.FakeHttpContext();
contextbase.Request.ServerVariables.Add("AUTH_TYPE","Forms"); <-- error here
contextbase.Request.ServerVariables.Add("LOGON_USER", "Tom");
contextbase.Request.ServerVariables.Add("REQUEST_METHOD", "GET"); 
```

但我得到以下异常。请帮忙。

**System.NullReferenceException 未由用户代码处理 Message=Object 引用未设置为对象的实例。**

如何创建单元测试来测试服务器变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T20:45:15.657

Scott Hanselman 的页面上有一些印刷错误（小写的类名）。所以这就是代码的样子（我还`Expect`用新语法改变了旧`Setup`语法）：

```
public static class MvcMockHelpers
{
    public static HttpContextBase FakeHttpContext()
    {
        var context = new Mock<HttpContextBase>();
        var request = new Mock<HttpRequestBase>();
        var response = new Mock<HttpResponseBase>();
        var session = new Mock<HttpSessionStateBase>();
        var server = new Mock<HttpServerUtilityBase>();

        context.Setup(ctx => ctx.Request).Returns(request.Object);
        context.Setup(ctx => ctx.Response).Returns(response.Object);
        context.Setup(ctx => ctx.Session).Returns(session.Object);
        context.Setup(ctx => ctx.Server).Returns(server.Object);

        return context.Object;
    }
} 
```

回到你的情况。您会看到此异常，因为在创建假 HttpContext 时，仅设置了其直接属性 Request、Response、Session 和 Server。但是您正在尝试访问`ServerVariables`请求模拟的属性。因此，您需要为此属性设置一些返回结果。请参阅 Scott 如何为请求模拟设置请求 url 的示例：

```
public static void SetupRequestUrl(this HttpRequestBase request, string url)
{
    if (url == null)
        throw new ArgumentNullException("url");

    var mock = Mock.Get(request);

    mock.Setup(req => req.QueryString)
        .Returns(GetQueryStringParameters(url));
    mock.Setup(req => req.AppRelativeCurrentExecutionFilePath)
        .Returns(GetUrlFileName(url));
    mock.Setup(req => req.PathInfo)
        .Returns(string.Empty);
} 
```

这里的主要思想 - 你不能直接使用`contextBase.Request.QueryString`你应该在之前设置请求模拟：

```
 mock.Setup(req => req.QueryString)
            .Returns(GetQueryStringParameters(url)); 
```

# javascript - 在javascript中删除除特定部分之外的所有字符串

> ID：10402891
> 
> 赞同：3
> 
> 时间：2012-05-01T19:11:27.923
> 
> 标签：javascript, regex

我正在为 Sharepoint 编写一个小应用程序。我正在尝试从返回的字段中间提取一些文本：

```
var ows_MetaInfo="1;#Subject:SW|NameOfADocument
vti_parservers:SR|23.0.0.6421
ContentTypeID:SW|0x0101001DB26Cf25E4F31488B7333256A77D2CA
vti_cachedtitle:SR|NameOfADocument
vti_title:SR|ATitleOfADocument
_Author:SW:|TheNameOfOurCompany
_Category:SW|
ContentType:SW|Document
vti_author::SR|mrwienerdog
_Comments:SW|This is very much the string I need extracted
vti_categories:VW|
vtiapprovallevel:SR|
vti_modifiedby:SR|mrwienerdog
vti_assignedto:SR|
Keywords:SW|Project Name
ContentType _Comments" 
```

所以......我想要返回的只是“这就是我需要提取的字符串”

我需要正则表达式和字符串替换吗？您将如何编写正则表达式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:28:21.970

是的，您可以为此使用正则表达式（这是他们擅长的事情）。假设您总是想要在以“_Comments:SW|”开头的行中的管道 (|) 之后的字符串，以下是提取它的方法：

```
var matchresult = ows_MetaInfo.match(/^_Comments:SW\|(.*)$/m);
var comment = (matchresult==null) ? "" : matchresult[1]; 
```

请注意，String 对象的 .match() 方法返回一个数组。第一个（索引 0）元素将是整个匹配项（这里，整个匹配项是整行，因为我们用 ^ 和 $ 锚定它；请注意，在正则表达式之后添加“m”使其成为多行正则表达式，允许我们匹配多行输入中任何行的开始和结束），数组的其余部分是我们使用括号捕获的子匹配。上面我们已经捕获了您想要的行的一部分，因此它将出现在数组中的第二项（索引 1）中。

如果没有匹配（“_Comments:SW|”没有出现在 ows_MetaInfo 中），那么 .match() 将返回 null，这就是我们在提取评论之前对其进行测试的原因。

如果您需要针对其他场景调整正则表达式，请查看 Mozilla 开发网络上的正则表达式文档： [https ://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:26:09.067

您可以使用以下代码：

```
var match = ows_MetaInfo.match(/_Comments:SW\|([^\n]+)/);
if (match)
   document.writeln(match[1]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:27:11.207

我远不能胜任 RegEx，所以这是我的无 RegEx 解决方案。有关更多详细信息，请参阅评论。

```
var extractedText = ExtractText(ows_MetaInfo);

function ExtractText(arg) {
    // Use the pipe delimiter to turn the string into an array
    var aryValues = ows_MetaInfo.split("|");

    // Find the portion of the array that contains "vti_categories:VW"
    for (var i = 0; i < aryValues.length; i++) {
        if (aryValues[i].search("vti_categories:VW") != -1)
            return aryValues[i].replace("vti_categories:VW", "");
    }

    return null;
}​ 
```

这是[一个要演示的工作小提琴](http://jsfiddle.net/JamesHill/hFttA/)。

# php - 将会话变量插入 MySQL 数据库

> ID：10402894
> 
> 赞同：0
> 
> 时间：2012-05-01T19:11:46.747
> 
> 标签：php, mysql

嘿，我是 PHP 新手，我正在尝试将详细信息输入到我的数据库中。我正在尝试输入用户输入的事件名称（POST）和登录用户的用户名。

我创建了会话来存储用户用户名，我拥有的代码是

```
$eventname=$_POST['eventname'];
$myusername = $_SESSION['myusername']

$sql = mysql_query("INSERT INTO $tbl_nameVALUES('','$eventname','$_SESSION['myusername'])");

echo "You have been added to the event"; 
```

它是给出错误的 $sql 语句？任何帮助将非常感激。

谢谢大家！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T19:14:04.183

这里有几个潜在的问题。

首先，您没有逃脱`eventname`SQL 注入的攻击。我们假设这`myusername`已经是安全的了。如果它之前没有被过滤，也使用`mysql_real_escape_string()`on `$_SESSION['myusername']`。

```
$eventname = mysql_real_escape_string($_POST['eventname']);

// Then you need space before VALUES and are missing a closing quote on $_SESSION['myusername'], which should be in {}
$sql = mysql_query("INSERT INTO $tbl_name VALUES('','$eventname','{$_SESSION['myusername']}')"); 
```

最后，为了使语句起作用，它假设您在`$tbl_name`. 您应该明确使用的列。用正确的列名替换`colname1, event_name, username`.

```
$sql = mysql_query("INSERT INTO $tbl_name (colname1, event_name, username) VALUES('','$eventname','{$_SESSION['myusername']}')"); 
```

SQL 语法错误的确切位置将通过`mysql_error()`.

```
$sql = mysql_query(<your insert statement>);
if (!$sql) {
  echo mysql_error();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:13:51.093

您`'`的插入语句中缺少一个。尝试这个

```
INSERT INTO $tbl_name VALUES('','$eventname','$_SESSION['myusername']') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-04T10:26:14.467

希望对你有帮助...

```
$eventname=$_POST['eventname'];
$myusername = $_SESSION['myusername'];

$sql = mysql_query("INSERT INTO tbl_name VALUES('','$eventname','".$_SESSION['myusername'])."'");

echo "You have been added to the event"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T19:15:21.190

`$_SESSION`删除数组中键周围的单引号：

```
$sql = mysql_query("INSERT INTO $tbl_name VALUES('', '$eventname', '$_SESSION[myusername])"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T19:13:21.637

`$tbl_name`在and之间需要一个空格`VALUES`，实际上是`'`after `$_SESSION['myusername']`。

并查找 SQL 注入。

# session - WebLogic 服务器启动期间的警告

> ID：10402895
> 
> 赞同：0
> 
> 时间：2012-05-01T19:11:51.600
> 
> 标签：session, weblogic, listener, weblogic-10.x

每当我启动 WebLogic 服务器时，我都会在控制台中看到以下警告。

```
<Warning> <HTTP> <BEA-101164> <User defined class com.org.listener.SessionTracking is not a Listener, as it does not implement the correct interface(s).> 
```

会话跟踪.java

```
@ManagedBean
@SessionScoped
public class SessionTracking implements Serializable, javax.servlet.http.HttpSessionBindingListener{
//code
} 
```

web.xml

```
<listener>
    <listener-class>com.org.listener.SessionTracking</listener-class>
</listener> 
```

如何解决这个问题？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:04:50.280

您无需在 web.xml 中指定类。

> Servlet 2.5 规范还包含 javax.servlet.http.HttpSessionBindingListener 和 javax.servlet.http.HttpSessionActivationListener 接口。这些接口由存储为会话属性的对象实现，并且不需要在 web.xml 中注册事件侦听器。

[应用程序事件](http://docs.oracle.com/cd/E21764_01/web.1111/e13712/app_events.htm)

# asp.net-mvc-3 - Excel 导入和导出到 SQL

> ID：10402896
> 
> 赞同：0
> 
> 时间：2012-05-01T19:11:56.190
> 
> 标签：asp.net-mvc-3, sql-server-2008, entity-framework, excel

我有一个要求，我需要将 xsl（excel 2003）上传到 SQL 2008R2 数据库中。我正在使用 ORCHAD 的东西来安排时间。

我正在使用 HTTPPOSTEDFILEBASE 文件流转换为字节数组并存储在数据库中。

存储后后台调度程序拿起任务并处理存储的数据。我需要从 excel 中的数据创建对象并发送进行处理。我对解码字节数组感到震惊:(

处理这种要求的最佳方法是什么？我使用的任何库。

我的 Web 应用程序是使用 MVC3、EF4.1、存储库模式、Autofaq 构建的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:30:14.993

我没有使用 HTTPPOSTEDFILEBASE 类，但你可以：

1.  将文件转换为字节流
2.  将其保存为数据库中的适当字节/blob 类型（将扩展名存储在单独的字段中）
3.  检索字节并将适当的扩展名添加到文件流
4.  视为普通文件...

但我实际上想知道您的要求是否甚至要求这样做。你为什么首先存储文件？如果您只使用文件数据来塑造您的业务对象（我猜是保存在某处），您可以在将文件存储为原始字节之前执行数据提取、塑造和持久化，这样您就不必重新构建为此目的归档。

# django - Django Model Distinct 子句

> ID：10402898
> 
> 赞同：1
> 
> 时间：2012-05-01T19:12:02.223
> 
> 标签：django

我有一个 django 模型查询，需要从特定表中获取不同的行，但由于某种原因它没有获取它。

让我知道你的输入

询问

```
Volunteercontacts.objects.order_by('name')- gives me the expected answer ie;ordering by name
Volunteercontacts.objects.order_by('name').distinct('name')- does not eliminate the duplicate 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:19:03.990

您应该区分不同的`Volunteercontacts`模型和不同的`name`列值。

对于不同的`Volunteercontacts`模型，您可以使用 distinct()，但在这种情况下没有效果：

```
Volunteercontacts.objects.order_by('name').distinct() 
```

对于不同的列值，您可以使用字典或[值列表](https://docs.djangoproject.com/en/dev/ref/models/querysets/#values-list)数组：

```
Volunteercontacts.objects.values_list('name', 
                                      flat=True).order_by('name').distinct() 
```

另外，请记住，在 distinct 方法中指定字段名称的能力仅在 PostgreSQL 中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:42:53.070

Django 1.4 在原始问题中提供了预期的行为（假设您使用的是 Posgtres）：

[https://docs.djangoproject.com/en/1.4/ref/models/querysets/#distinct](https://docs.djangoproject.com/en/1.4/ref/models/querysets/#distinct)

# java - 在字符串中编写html

> ID：10402900
> 
> 赞同：7
> 
> 时间：2012-05-01T19:12:19.027
> 
> 标签：java, html, escaping, stringbuilder

我正在尝试在我的 java 类中编写几行 html，以从另一个 API 获取一些数据。我以 JSON 字符串形式获取数据，然后想在网页上显示其中的一些数据。

要创建 HTML，我尝试：

```
 StringBuilder sb = new StringBuilder();
    for(int i=0;i<leads.size();i++){
        sb.append("<p>Name: "+leads.get(i).getFirstName()+" "+leads.get(i).getLastName()+"</p>");
        sb.append("<p>Email: "+leads.get(i).getEmail()+"</p>");
        sb.append("<br />");
    }
    fullLeadData = sb.toString(); 
```

但最终显示的是对 html 标签的字面解释。有没有办法可以创建此字符串，以便标签将保留为标签而不是转义字符？

java类是一个托管bean，所以在html中我有：

```
 <body>
    <div id="display">
        #{PortalView.fullLeadData}
    </div>
</body> 
```

其中 fullLeadData 是带有 html 的字符串。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T19:22:34.090

好像您正在使用JSF。试试这个：

```
<div id="display">
    <h:outputText value="#{PortalView.fullLeadData}" escape="false"/>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:21:31.943

您可能需要替换转义序列。常见的是

```
‘&amp;’ (ampersand)  ‘&amp;amp;‘
‘"’ (double quote)  ‘&amp;quot;‘
”’ (single quote)  ‘&amp;#039;‘
‘&lt;’ (less than)  ‘&amp;lt;‘
‘&gt;’ (greater than)  ‘&amp;gt;‘ 
```

# android - 被阻止的安卓相机

> ID：10402907
> 
> 赞同：2
> 
> 时间：2012-05-01T19:12:49.553
> 
> 标签：android, camera

我正在开发使用相机的应用程序。有时，在应用程序调试时无法正确释放相机（通过 camera.release()）。有人知道如何解锁相机以备将来使用吗？我知道，我可以重启手机，但是需要很长时间:(

# sql-server - 基于另一个更新的列更新列

> ID：10402913
> 
> 赞同：3
> 
> 时间：2012-05-01T19:13:22.910
> 
> 标签：sql-server, sql-server-2008, tsql

我的问题与单个更新语句中的更新顺序有关。我观察到，当我使用`SELECT`语句设置变量时，变量是按顺序设置的。例如：

```
SELECT
    @Test1 = 2,
    @Test2 = @Test1 + 1 
```

此时`@Test1`将是`2`并且`@Test2`将是`3`因为集合操作是按顺序完成的。但是会发生什么`UPDATE`？

```
UPDATE TestTable SET
    Test1 = 2,
    Test2 = Test1 + 1 
```

`Test2`是在计算中使用初始值`Test1`还是使用我们刚刚设置的值？如果它是 a`UPDATE`内的语句，它有什么区别`MERGE`吗？

```
MERGE INTO TestTable AS T
    USING (
        SELECT
                Test1,
                Test2
            FROM SomeOtherTable
        ) AS S
        ON S.Test1 = T.Test1
    WHEN MATCHED THEN
        UPDATE SET
            T.Test1 = 2,
            T.Test2 = T.Test1 + 1
    ; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T19:15:03.497

赋值右侧的名称指的是列的旧值，无论它们的顺序如何。

这（例如）允许您在不使用临时变量的情况下交换两个值。

```
UPDATE foo
SET a = b,
    b = a 
```

[http://sqlfiddle.com/#!3/f6984/1](http://sqlfiddle.com/#!3/f6984/1)

* * *

SQL-92 规范（第 13.10 节，一般规则，第 6 项，第 395 页）指出：

> *   在更新 T的`<value expression>`任何行之前，对 T 的每一行有效地评估 s。

# plone - 无法激活关于 Plone Dexterity 类型的讨论（文件夹）

> ID：10402918
> 
> 赞同：6
> 
> 时间：2012-05-01T19:13:47.287
> 
> 标签：plone, dexterity

我一直在研究基于灵巧的克隆应用程序。我创建了几个新类型。这是我为激活对名为“activity_report”的特定敏捷内容类型的评论所做的：

**在克隆控制面板中**

在*讨论*部分，我启用了以下功能：

*   全局启用评论
*   启用匿名评论

在*类型*部分中，我从下拉列表中选择了“活动报告”类型并启用了“允许评论”选项。

**在文件系统上**

在 FTI 文件 activityreport.xml 中：

```
<property name="allow_discussion">True</property> 
```

我已经重启了实例，甚至重新安装了产品，但是我无法激活敏捷类型中的评论部分。

值得一提的是，标准类型（例如 Page）可以激活讨论模块。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:19:33.580

plone.app.discussion 当前禁用对所有容器的评论（参见[https://dev.plone.org/ticket/11245](https://dev.plone.org/ticket/11245)进行讨论）。

我在一个项目中使用了类似以下的猴子补丁来缩短正常检查并确保为我的文件夹内容类型启用了评论：

```
from Acquisition import aq_inner
from Products.highcountrynews.content.interfaces import IHCNNewsArticle
from plone.app.discussion.conversation import Conversation
old_enabled = Conversation.enabled
def enabled(self):
    parent = aq_inner(self.__parent__)
    if parent.portal_type == 'my_portal_type':
        return True
    return old_enabled(self)
Conversation.enabled = enabled 
```

其中 'my_portal_type' 当然是您希望启用评论的 portal_type。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T10:44:55.850

大卫的反应是不准确的。要猴子补丁的类是*plone.app.discussion.browser.conversation.ConversationView*：

```
from Acquisition import aq_inner
from plone.app.discussion.browser.conversation import ConversationView
old_enabled = ConversationView.enabled

def enabled(self):
    parent = aq_inner(self.__parent__)
    if parent.portal_type == 'My_type':
        return True
    return old_enabled(self) 
```

它至少适用于 Plone 4.2。但是，感谢大卫的提示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T10:44:15.757

正如 David 和 Victor 已经指出的那样，您可以重写会话类的 enable 方法。我建议使用以下方法，它比猴子修补对话类更干净：

[https://github.com/plone/plone.app.discussion/blob/master/docs/source/howtos/howto_override_enable_conversation.txt](https://github.com/plone/plone.app.discussion/blob/master/docs/source/howtos/howto_override_enable_conversation.txt)

我最近还在 plone.app.discussion 中添加了对敏捷类型的支持，因此一旦有新版本，您就不再需要自定义对话类：

[https://github.com/plone/plone.app.discussion/commit/0e587a7d8536125acdd3bd385e880b60d6aec28e](https://github.com/plone/plone.app.discussion/commit/0e587a7d8536125acdd3bd385e880b60d6aec28e)

请注意，此方法支持对文件夹对象进行注释。尚不支持启用/禁用对文件夹对象内部的对象的评论。

如果您希望能够使用行为字段/小部件打开/关闭评论：

[https://github.com/plone/plone.app.dexterity/commit/0573df4f265a39da9efae44e605e3815729457d7](https://github.com/plone/plone.app.dexterity/commit/0573df4f265a39da9efae44e605e3815729457d7)

这也有望成为下一个 plone.app.dexterity 版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-24T08:32:26.143

我在configure.zcml中解决了：

```
<interface interface="Products.CMFPlone.interfaces.INonStructuralFolder" />

<class class="Products.PloneHelpCenter.types.Definition.HelpCenterDefinition">
  <implements interface="Products.CMFPlone.interfaces.INonStructuralFolder" />
</class> 
```

更新：这不是一个好主意。对于具有此修复的每种内容类型，我都缺少添加菜单的问题。

# c++ - 如何在 Visual Studio 2010 (tr1::function) 中使用 tr1？

> ID：10402924
> 
> 赞同：8
> 
> 时间：2012-05-01T19:14:03.510
> 
> 标签：c++, visual-studio-2010, c++11, std, tr1

如何开始使用 Visual Studio 2010 的 tr1 功能？对于更具体的情况，我需要 std::tr1::function。我尝试将`#include <tr1/functional>`哪些报告包含为缺失，而`#include <functional>`包含很好，但是当我设置它时：

```
std::tr1::function<void(void)> callback; 
```

我得到：

```
1>d:\marmalade\projects\core\src\button.h(21): error C3083: 'tr1': the symbol to the left of a '::' must be a type
1>d:\marmalade\projects\core\src\button.h(21): error C2039: 'function' : is not a member of '_STL'
1>d:\marmalade\projects\core\src\button.h(21): error C2143: syntax error : missing ';' before '<'
1>d:\marmalade\projects\core\src\button.h(21): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>d:\marmalade\projects\core\src\button.h(21): error C2238: unexpected token(s) preceding ';' 
```

如果我使用 boost，它可以正常工作，但是对于这个项目，由于使用了特定的框架，我需要 Visual Studio tr1 版本。

正如建议的那样，跳过 tr1，仍然返回相同的结果：

```
std::function<void(void)> callback;

1>d:\marmalade\projects\core\src\button.h(20): error C2039: 'function' : is not a member of '_STL'
1>d:\marmalade\projects\core\src\button.h(20): error C2143: syntax error : missing ';' before '<'
1>d:\marmalade\projects\core\src\button.h(20): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>d:\marmalade\projects\core\src\button.h(20): error C2238: unexpected token(s) preceding ';' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T19:57:06.560

根据您的评论，在[这个页面上](http://www.madewithmarmalade.com/marmalade/features/open-and-standards-compliant)，我认为 Marmalade 带有它自己的 STL 实现，这似乎已经过时了。 [此页面](http://www.madewithmarmalade.com/devnet/code-community)验证他们使用的[STLPort](http://www.stlport.org/)版本不支持 2005 年推出的 TR1，更不用说任何更新的版本了。您的选择是：

1）自己复制/写那些
2）不要
3）[下载更新版本的 STLPort](http://sourceforge.net/projects/stlport/)。它似乎在过去两年没有更新，所以没有 C++11，但他们确实提到了有`functional`，但不清楚它是否在`std`or`std::tr1`命名空间中。但是，这可能不适用于果酱，因此请做好备份并小心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:18:48.593

Visual Studio 2010 附带默认启用的 C++11（或至少是已实现的）。你需要使用`std::function<void(void)>`.

如需完整的表格[，请参见此处](http://msdn.microsoft.com/en-us/magazine/ee336130.aspx)。

顺便说一句：现在你不应该使用 TR1 中的任何东西。它已被集成到新标准中。

# x86-16 - LOOPNE 的用处

> ID：10402930
> 
> 赞同：1
> 
> 时间：2012-05-01T19:14:19.150
> 
> 标签：x86-16, assembly

我无法理解 LOOPNE 的用处。即使 LOOPNE 不存在而只有 LOOP 存在，它也会在这里做同样的事情。请帮帮我。

```
MOV CX, 80
MOV AH,1
INT 21H
CMP AL, ' '
LOOPNE BACK 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:20:56.703

`CMP`或多或少是一条`SUB`不改变值的指令，这意味着它设置了诸如 ZF（零标志）之类的标志。

`LOOPNE`有 2 个循环条件：`cx > 0`和`ZF = 0`

`LOOP`有 1 个条件循环：`cx > 0`

因此，法线`LOOP`将遍历所有字符，而`LOOPNE`将遍历所有字符，或者直到遇到空格。以先到者为准

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:42:43.430

LOOPNE 在比较失败时循环，并且当存在剩余的非零迭代计数（递减后）时。可以说，这对于在已知长度的线性列表中查找元素非常方便。

在现代 x86 CPU 中几乎没有使用它。

LOOPNE 指令很可能在 CPU 内部通过微指令实现，因此有效地等效于 JNE/DEC CX/JNE。由于 CPU 设计人员投入了大量精力来优化比较/分支/寄存器算法，因此在高度流水线化的 CPU 上，等效指令序列几乎可以以同样快的速度执行。它实际上可能执行得更慢；你只有通过计时才能知道。而且您对它的作用感到困惑这一事实使其成为编码错误的根源。

我目前对等效的指令序列进行了编码，因为我曾经误会过一次。我对 CMP 和 JNE 并不感到困惑。

# iphone - 如何查看 iPhone 应用程序启动所需的时间？

> ID：10402932
> 
> 赞同：2
> 
> 时间：2012-05-01T19:14:27.103
> 
> 标签：iphone, ipad, ios5

我目前正在开发一个 iOS 应用程序。我需要比较在 iPhone 和/或 iPad 上启动所需的时间。有人可以建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:22:39.560

记下`main()`和 中的当前时间`-application:didFinishLaunchingWithOptions:`，然后计算差值。例子：

主.m：

```
// main.m

NSDate *startupDate;

int main(int argc, char **argv)
{
    NSAutoreleasePool *pool = [NSAutoreleasePool new];
    startupDate = [[NSDate alloc] init];
    int exitCode = UIApplicationMain(argc, argv, NULL, @"AppDelegate");
    [startupDate release];
    [pool drain];
    return exitCode;
}

// etc. 
```

AppDelegate.m:

```
// AppDelegate.m

extern NSDate *startupDate;

- (BOOL)application:(UIApplication *)app didFinishLaunchingWithOptions:(NSDictionary *)opts
{
    NSDate *launchFinishedDate = [[NSDate alloc] init];
    NSTimeInterval launchTimeInSeconds = [launchFinishedDate timeIntervalSinceDate:startupDate];
    [launchFinishedDate release];

    // launchTimeInSeconds will contain the launch time in seconds (floating point).
    // create UI setup etc. as usual
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:42:51.673

您可以将 Instruments（包含在 Xcode 中）与 Time Profiler 一起使用来监控您的应用程序的启动。

# .net - 释放互斥锁。

> ID：10402934
> 
> 赞同：1
> 
> 时间：2012-05-01T19:14:43.920
> 
> 标签：.net, multithreading, mutex

“Mutex 类强制执行线程标识，因此只能由获取它的线程释放互斥锁。相比之下，Semaphore 类不强制执行线程标识。”

这就是[MSDN](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)描述所说的.. 但是根据我的问题[Application exception is throw](https://stackoverflow.com/questions/10402464/why-applicationexception-is-thrown)，即使我没有获得它，我也试图释放互斥锁。执行下一个线程时，它向我显示了一个异常。这是否意味着无权访问互斥锁的线程释放了它？？？有人可以帮助我理解这个概念，如果我做错了什么，请指导我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:43:27.860

就像文档说的那样，ApplicationException 被抛出是因为一个不拥有互斥锁的线程试图释放它。这并不意味着互斥锁已被释放，只是试图释放它的线程并不拥有它。

```
var mutex = new Mutex();
mutex.WaitOne();
var thread = new Thread(() =>
    {
       try
       {
          mutex.ReleaseMutex(); //This will throw ApplicationException
       }
       catch (ApplicationException ex)
       {
           Console.WriteLine("Failed to release mutex");
       }
    });

thread.Start();
thread.Join();

mutex.ReleaseMutex(); //No exception will be thrown here 
```

在此示例中，初始线程创建互斥体并获取它。第二个线程将被启动，尝试释放它并失败。失败后，所属线程将释放它。

**更新**

在您之前的问题中，重要的是要注意您正在使用多个线程运行该代码，并且每个线程中都存在相同的竞争条件。多个线程可能在一个线程持有互斥锁时未能获得互斥锁，因此多个线程同样无法释放它。以下面的执行路径为例。

*   线程 1 获取互斥体。
*   线程 2 无法获取互斥锁，因为线程 1 拥有它。
*   线程 3 无法获取互斥锁，因为线程 1 拥有它。
*   线程 3 尝试释放互斥体，抛出 ApplicationException 因为它不拥有它。
*   线程 1 释放互斥体。
*   线程 2 尝试释放互斥体，抛出 ApplicationException 因为它不拥有它。

线程 3 在未能释放互斥锁时崩溃的事实与线程 2*也因做同样的事情而崩溃的事实无关。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:58:58.607

关于互斥锁的概念，您可以将其想象为一个抽屉，而拥有互斥锁的线程是持有该抽屉钥匙的人。只有持有抽屉钥匙的人才能解锁它，因此只有获得互斥锁的线程才能释放它。

当您尝试从不拥有互斥锁的线程中释放互斥锁时，就像有人试图用假钥匙打开别人的抽屉一样，因此会抛出异常以抓住窃贼！

这就是互斥锁所做的一切，它可以防止多个线程执行“受保护的代码”（在抽屉内）。它的名字来源于“互斥”，意思是一次一个线程。

# java - Spring MVC 控制器不解析 URI

> ID：10402936
> 
> 赞同：0
> 
> 时间：2012-05-01T19:14:57.523
> 
> 标签：java, spring, rest, spring-mvc

这与之前提出的问题类似，但仍然不同，我根本无法弄清楚。

我有一个用 MVC 实现的 REST Web 服务的控制器，它应该处理对路径“/users/contacts”的请求，问题是在我的客户端测试应用程序中，当我尝试点击该路径时，我得到：

```
No mapping found for HTTP request with URI /users/users/contacts in DispatcherServlet with name 'webservice' 
```

同样，在我的客户端测试应用程序中，当我将请求路径更改为“/WHATEVERusers/contacts”之类的内容时，我会收到无法解析“/WHATEVERusers/contacts”的错误

我不知道为什么当我尝试访问由控制器处理的路径时，它会被破坏，但是当我请求一些垃圾路径时，它不会。

我面前没有代码，但我回家后能够回答问题。

这是我的测试客户端的代码：

```
private static void TestGetContacts()
{
    UserCreateRequest request = new UserCreateRequest();

    Gson gson = new Gson();

    try

    {
        HttpClient client = new DefaultHttpClient();

        StringEntity string  = new StringEntity(gson.toJson(request), HTTP.UTF_8);
        string.setContentType("application/json");

        URI uri = URIUtils.createURI("http", "localhost", 8888, "/users/contacts", null, null);

        HttpPost post = new HttpPost(uri);
        post.setEntity(string);

        client.execute(post);
    }
    catch(Exception ex)
    {
        System.out.println(ex.getMessage());
    }
} 
```

这是我的控制器类：

```
@Controller
@RequestMapping("/users/contacts")
public class UserContactService
{
private @Autowired ApplicationContext appContext;

@RequestMapping(method=RequestMethod.POST, consumes="application/json", produces="application/json")
public GetContactsResponse GetContacts(@RequestBody UserCreateRequest request)
{
    GetContactsResponse response = new GetContactsResponse();

    return response;
}
} 
```

这是我的 servlet 配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context"
    xmlns:oxm="http://www.springframework.org/schema/oxm"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
            http://www.springframework.org/schema/oxm http://www.springframework.org/schema/oxm/spring-oxm-3.0.xsd">

<!--
    - The controllers are autodetected POJOs labeled with the @Controller annotation.
-->
<context:component-scan base-package="com.impersonal.server.restservice.users"/>                

<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
    <property name="messageConverters">
        <list>
            <ref bean="jsonConverter" />
            <!-- 
            <ref bean="marshallingConverter" />
            <ref bean="atomConverter" />
            -->
        </list>
    </property>
</bean>

<bean id="jsonConverter" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
    <property name="supportedMediaTypes" value="application/json" />
</bean> 
```

这是我的网络配置：

```
<?xml version="1.0" encoding="utf-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
version="2.5">

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath:/**/applicationContext.xml</param-value>
</context-param>

<servlet>
    <servlet-name>webservice</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>webservice</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping>

<welcome-file-list>
    <welcome-file>index.html</welcome-file>
</welcome-file-list> 
```

**更新：** 我的请求在我的控制器中处理，但在处理请求后，服务器打印出它无法解析 /users/users/contacts。出于某种原因，另一个请求正在发送到 DispsatcherServlet，我不知道为什么..

谢谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T15:54:05.697

添加`@ResponseBody`到我的方法签名解决了我的问题。没有意识到我真的需要它，并且没有它会导致非常奇怪的副作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T06:46:13.013

您是否尝试将 url 放在方法上方的 @RequestMapping 中，而不是放在 Class 上方？我注意到它可能会不时解决 URI 映射问题。

您可以在同一个类中使用不同的方法处理更多的 url。您甚至可以在 Class 上方添加 @RequestMapping("/users") 并添加不同的方法

*   @RequestMapping("/contacts") 映射到 /users/contacts
*   @RequestMapping("/customers") 映射到 /users/customers

# php - Facebook PHP SDK 抛出无法捕获的 OAuthException

> ID：10402939
> 
> 赞同：6
> 
> 时间：2012-05-01T19:15:06.533
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk

我正在尝试向 Facebook Graph API 发布开放图形操作，但收到 OAuth Exception `(#3501) User is already associated to the <object>`。这一切都很好，我希望 Facebook 会抛出这个异常。我在验证用户时遇到了一些其他例外情况（可能是旧的/陈旧的会话，无论如何）。

我的问题是，有没有其他人经历过这个异常在 php 中是无法捕获的？在这个特定示例（发布图形操作）中，我绝对将对 api 的调用包装在 try/catch 语句中；但我仍然收到致命错误。

```
<?php
try {
    //publishing to open graph
    $this->fb->api('/me/app:action', 'POST', array(
        'object' => 'http://www.domain.com/path/to/graph/object',
    ));
}
catch (Exception $e)
{
    /*
        We may get here if the user has already posted this action before...
        or if our session somehow went sour
        or bc facebook is down...
        or one of any other 1000 reasons the graph api is currently 
        sucking...

        in any case it doesn't much matter, this is not a mission critical 
        thing to worry about; if we don't post the graph action - we don't
        post the graph action..nbd.
    */
} 
```

上面的代码是发布图形操作的片段（概括，因为它的内容对这个例子并不重要）。

我意识到 Facebook PHP SDK 抛出的异常是一个`FacebookApiException`但该类扩展了异常。我一生都无法弄清楚为什么以所有合乎逻辑的事物的名义，我无法像这样抓住我的例外。

有没有人遇到过这个问题？这是 FB PHP SDK 中的错误吗？我在这里错过了其他东西吗？谢谢你的帮助！

另外，作为参考，FB PHP SDK的相关部分在这里：

[FacebookAPIException 定义（base_facebook.php 第 30 行）](https://github.com/facebook/php-sdk/blob/master/src/base_facebook.php#L30)

[抛出 OAuthException（base_facebook.php 第 1105 行](https://github.com/facebook/php-sdk/blob/master/src/base_facebook.php#L1105)

## 2012 年 5 月 1 日编辑

经过一番调查，事实证明这个“异常”并没有真正被视为一个异常。典型异常打印出返回到导致抛出异常的方法调用的堆栈跟踪。这些“OAuthExceptions”没有。此外，典型的异常会以不同的方式输出它们的错误字符串，例如：

```
PHP Fatal error:  Uncaught exception 'Exception' with message 'foo' /path/to/file.php:10 
```

或者

```
PHP Fatal error:  Uncaught exception 'MyException' with message 'stupid php' /path/to/file:10
#0 /path/to/file.php(17): doTest()
#1 {main}
    thrown in /path/to/file.php on line 10 
```

在这种特殊情况下，我们没有得到任何这些，它看起来更像是一个典型的致命错误：

```
PHP Fatal error:  Uncaught OAuthException: (#3501) User is already associated \
to the <object> object on a unique action type <action>. Original Action ID: \
123123123
    thrown in /path/to/app/libs/fb/base_facebook.php on line 1107, \
    referer: http://www.domain.com/path/to/page 
```

我无法理解为什么这个被遗弃的“异常”如此奇怪/无法捕捉。

## 解决方案：

我想出了自己问题的答案；我在下面添加了它 - 这是开发人员错误，而不是错误。答案如下。

此外，这很可能是错误的*一部分*，如果您想说能够将类定义引用为`catch`不存在（或在当前命名空间中不可用）的定义的类型提示是一个错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T20:03:03.407

所以，上面没有提到的是我正在使用 PHP 命名空间。这是一个很大的问题，因为命名空间对 php 来说相对较新，我觉得它很容易被忽视。无论如何，这是一个非常愚蠢的疏忽/错误。

如果您位于已定义的命名空间（即，不是根 (\) 命名空间）中，则您无法直接访问`Exception`该类。而不是 php 抛出关于不知道该类是什么的警告，它只是忽略了它不知道它是什么的事实 - 并且没有捕获异常。

**解决方案1：**

导入异常类：

```
<?php
use \Exception;

// ...codes

try {
    //...codes
}
catch (Exception $e)
{
    //...codes
} 
```

**解决方案2：**

提供异常类的完整路径：

```
<?php
try {
    //.....
}
catch (\Exception $e)
{
    // voila.
} 
```

# java - Android - java - 数词

> ID：10402948
> 
> 赞同：10
> 
> 时间：2012-05-01T19:15:56.273
> 
> 标签：java, android, string

我有一个编辑文本，我想计算其中的单词。编辑文本中有新行时出现问题。

我试过这个：

```
String[] WC = et_note.getText().toString().split(" ");
Log.i("wordcount", "wc: " + WC.length); 
```

这是一个文本-> wc: 4

这是

一种

文本-​​>厕所：4

这是

一个简单的

文本-​​>厕所：4

有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T19:20:19.660

您想分割任意的空白字符串，而不仅仅是空格字符。因此，使用`.split("\\s+")`而不是`.split(" ")`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-11-07T09:08:02.643

我建议使用[BreakIterator](https://docs.oracle.com/javase/7/docs/api/java/text/BreakIterator.html)。根据我的经验，这是覆盖非标准语言（如日语）的最佳方式，其中没有分隔单词的空格。

[这里](http://tutorials.jenkov.com/java-internationalization/breakiterator.html)是字数统计的例子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-19T03:43:56.723

即使有多个空格和前导和/或尾随空格和空行，这也可以工作：

```
String words = str.trim();
if (words.isEmpty())
return 0;
return words.split("\\s+").length; // separate string around spaces 
```

你也可以在这里使用 \\W 而不是 \\s，如果你可以使用空格分隔词以外的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-28T18:36:49.393

迟到的答案，但我这样做

字符串 a = text.replaceAll("\s+","+");

字符串 b = a.replaceAll("[^+]", "");

textview1.setText(String.valueOf((long)(b.length() + 1)));

# java - 使用 JUnit 和 EasyMock Java 测试 Servlet

> ID：10402951
> 
> 赞同：2
> 
> 时间：2012-05-01T19:16:03.087
> 
> 标签：java, testing, servlets, junit, easymock

我有一个 servlet，我想使用 EasyMock 对其进行测试。

我的 servlet 是这样的：

```
public void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
    Population population = new Population();
    Elections elections = new Elections();
    ArrayList<Elector> electorsArl = new ArrayList<Elector>();
    ArrayList<Candidate> candidatesArl =  new ArrayList<Candidate>();

    String[] name = new String[4];
    String[] party = new String[4];
    String[] municipality = {"X", "Y", "Z", "A"};

    name[0] = request.getParameter("cand1");
    party[0] = request.getParameter("party1");
    name[1] = request.getParameter("cand2");
    party[1]= request.getParameter("party2");
    name[2] = request.getParameter("cand3");
    party[2]= request.getParameter("party3");
    name[3] = request.getParameter("cand4");
    party[3]= request.getParameter("party4");

    population.reducePopulation(candidatesArl);

    String[] politicalParty = {candidatesArl.get(0).getPoliticalParty(), candidatesArl.get(1).getPoliticalParty(), candidatesArl.get(2).getPoliticalParty(), candidatesArl.get(3).getPoliticalParty()};

    population.genPopulation(population.getMtyPopulation(), "X", electorsArl);
    population.genPopulation(population.getGpePopulation(), "Y", electorsArl);
    population.genPopulation(population.getSpPopulation(), "Z", electorsArl);
    population.genPopulation(population.getSnPopulation(), "A", electorsArl);

    elections.vote(electorsArl, candidatesArl, politicalParty);
    request.setAttribute("candidate", candidatesArl);

    int totalPopulation = electorsArl.size() + 4;
    int populationVoted = 0;
    for (int i = 0; i < candidatesArl.size(); i++){
        populationVoted = populationVoted + candidatesArl.get(i).getAllVotes();
    }
    Integer totalPercentage = (Integer) (populationVoted * 100) / totalPopulation;

    Integer mtyPercentage = (Integer) ((candidatesArl.get(0).getMtyVotes() + candidatesArl.get(1).getMtyVotes() + candidatesArl.get(2).getMtyVotes() + candidatesArl.get(3).getMtyVotes()) * 100) / 90;
    request.setAttribute("mtyPercentage", mtyPercentage);
    Integer spPercentage = (Integer) ((candidatesArl.get(0).getSpVotes() + candidatesArl.get(1).getSpVotes() + candidatesArl.get(2).getSpVotes() + candidatesArl.get(3).getSpVotes()) * 100) / 90;
    request.setAttribute("spPercentage", spPercentage);
    Integer snPercentage = (Integer) ((candidatesArl.get(0).getSnVotes() + candidatesArl.get(1).getSnVotes() + candidatesArl.get(2).getSnVotes() + candidatesArl.get(3).getSnVotes()) * 100) / 90;
    request.setAttribute("snPercentage", snPercentage);
    Integer gpePercentage = (Integer) ((candidatesArl.get(0).getGpeVotes() + candidatesArl.get(1).getGpeVotes() + candidatesArl.get(2).getGpeVotes() + candidatesArl.get(3).getGpeVotes()) * 100) / 90;
    request.setAttribute("gpePercentage", gpePercentage);
    request.setAttribute("totalPercentage", totalPercentage);

    request.setAttribute("winner", elections.getWinnerCandidate(candidatesArl.get(0), candidatesArl.get(1), candidatesArl.get(2), candidatesArl.get(3)));
    try {
        ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
        ElectionsDao electionsDao = (ElectionsDao) context.getBean("electionsDao");
        electionsDao.insertResults(candidatesArl, mtyPercentage, spPercentage, snPercentage, gpePercentage, totalPercentage);
        RequestDispatcher view = request.getRequestDispatcher(FORWARD_PAGE);
        view.forward(request, response); 
    } catch (RuntimeException re){
        logger.error("Runtime exception ocurred in ElectionsServlet.doPost", re);
        response.sendRedirect("error.html");
    }
} 
```

我对此的想法是，我只需要测试必须处理请求和响应的所有内容，因为所有其他方法都在其他类中进行了测试。我想知道是否有人可以帮助我。

到目前为止我有这个：

```
public class ElectionsServletTest extends TestCase {

private IMocksControl mocks;
private ElectionsServlet servlet;

@BeforeClass
public void setUpBeforeClass() {
    mocks = (IMocksControl) createStrictControl();
    servlet = new ElectionsServlet();
}

@After
public void tearDown() {
    mocks.reset();
}

@Test
public void testDoPostHttpServletRequestHttpServletResponse() throws IOException, ServletException{
    HttpServletRequest request = mocks.createMock(HttpServletRequest.class);
    HttpServletResponse response = mocks.createMock(HttpServletResponse.class);

    ArrayList<Candidate> candidatesArl =  new ArrayList<Candidate>();

    expect(request.getParameter("cand1")).andReturn("abc");
    expect(request.getParameter("party1")).andReturn("abc");
    expect(request.getParameter("cand2")).andReturn("bcd");
    expect(request.getParameter("party2")).andReturn("bcd");
    expect(request.getParameter("cand3")).andReturn("cde");
    expect(request.getParameter("party3")).andReturn("cde");
    expect(request.getParameter("cand4")).andReturn("def");
    expect(request.getParameter("party4")).andReturn("def");

    candidatesArl.add(new Candidate("abc", 35, "Monterrey", "abc"));
    candidatesArl.add(new Candidate("bcd", 35, "Monterrey", "bcd"));
    candidatesArl.add(new Candidate("cde", 35, "Monterrey", "cde"));
    candidatesArl.add(new Candidate("def", 35, "Monterrey", "def"));

    request.setAttribute("candidate", eq(isA(ArrayList.class)));

    request.setAttribute("mtyPercentage", eq(isA(Integer.class)));
    request.setAttribute("spPercentage", eq(isA(Integer.class)));
    request.setAttribute("snPercentage", eq(isA(Integer.class)));
    request.setAttribute("gpePercentage", eq(isA(Integer.class)));
    request.setAttribute("totalPercentage", eq(isA(Integer.class)));

    request.setAttribute("winner", "abc");

    ElectionsDao electionsDao = mocks.createMock(ElectionsDao.class);
    electionsDao.insertResults(candidatesArl, 45, 45, 45, 45, 45);

    expect(request.getRequestDispatcher("result.jsp")).andReturn(createMock(RequestDispatcher.class));
    mocks.replay();
    servlet.doPost(request, response);
    mocks.verify(); 
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T10:37:51.443

据我所知，你用这种方法做了很多事情。因此，很难对其进行测试。您应该在单独的方法和/或类中提取一些逻辑。

# c# - App_Code 中异常类的输出

> ID：10402956
> 
> 赞同：1
> 
> 时间：2012-05-01T19:16:24.920
> 
> 标签：c#, asp.net, .net, debugging, exception

我正在尝试查看我的开发客户端 devserver 上发生了什么异常（我们的服务器很好），并且我有一个 TestException.cs 类来处理我的 sql 语句类中的大部分异常。

我有这样的方法：

```
StringBuilder errorMessages = new StringBuilder();

for (int i = 0; i < innerException.Errors.Count; i++)
{
  errorMessages.Append("Index #" + i + "\n" +
    "Message: " + innerException.Errors[i].Message + "\n" +
    "LineNumber: " + innerException.Errors[i].LineNumber + "\n" +
    "Source: " + innerException.Errors[i].Source + "\n" +
    "Procedure: " + innerException.Errors[i].Procedure + "\n");
}

//Console.WriteLine(errorMessages.ToString());
Response.Clear();
Response.Write("FAILURE");
Response.End(); 
```

但是 Response.XX 不会编译，如果我在客户端服务器上使用 console.writeline 时，浏览器会出现连接丢失网页。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:52:20.077

您可以尝试使用[**`Trace`**](http://msdn.microsoft.com/en-us/library/system.diagnostics.trace.aspx)该类。如果您在 web.config 中链接到[*指向文本文件*](http://msdn.microsoft.com/en-us/library/system.diagnostics.textwritertracelistener.aspx)的跟踪器，您可以使用`Trace.WriteLine`. 然后，您只需要将文件上传到您的网络进行审查。

# .net - .NET 中是否有等效的 ListBox loadfromfile 方法？

> ID：10402961
> 
> 赞同：1
> 
> 时间：2012-05-01T19:16:55.470
> 
> 标签：.net, listbox, delphi-prism, listboxitems

我想在 .NET 中使用 ListBox1.loadfromfile 方法，但它似乎不存在或具有与该方法等效的任何东西。我在 MSDN 图书馆网站上搜索过，但我空手而归。.NET 中是否有等效方法？

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:44:20.413

这可以让你接近：

```
listBox1.Items.AddRange(File.ReadAllLines(@"c:\test.txt")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:29:55.190

我不知道 .NET 中有什么可以模仿特定的 Delphi 构造。您可能必须手动将文本行加载到列表框中。这很简单：

```
// Read the file line by line
System.IO.StreamReader file = new System.IO.StreamReader(@"c:\somefile.txt");
while((line = file.ReadLine()) != null)
{
    //Add the line to the list box
    listBox1.Items.Add(line);
}

file.Close(); 
```

# fft - 带fftw的理想低通滤波器

> ID：10402965
> 
> 赞同：0
> 
> 时间：2012-05-01T19:17:06.087
> 
> 标签：fft, fftw, lowpass-filter

再次，我仍然试图让我的低通滤波器运行，但我现在不知道为什么它仍然没有运行。我根据[FFT Filters](http://www.originlab.com/www/helponline/origin/en/UserGuide/Algorithm_%282D_FFT_Filters%29.html)和我之前的问题[FFT Question](https://stackoverflow.com/questions/10390490/fftw-c2c-missing-symmetry-in-transformed-real-data)来定位我的代码，以便对图像应用理想的低通滤波器。下面的代码只是使图像变暗并在结果图像中放置一些白色像素。

```
// forward fft the result is in freqBuffer
fftw_execute(forward);

for (int y = 0; y < h; y++)
{
    for (int x = 0; x < w; x++)
    {
        uint gid = y * w + x;

        // shifting coordinates normalized to [-0.5 ... 0.5]
        double xN = (x - (w / 2)) / (double)w;
        double yN = (y - (h / 2)) / (double)h;

        // max radius
        double maxR = sqrt(0.5f * 0.5f + 0.5f * 0.5f);

        // current radius normalized to [0 .. 1]
        double r = sqrt(xN * xN + yN * yN) / maxR ;

        // filter response
        double filter = r > 0.7f ? 0.0f : 1.0f;

        // applying filter response
        freqBuffer[gid][0] *= filter;
        freqBuffer[gid][1] *= filter;
    }
}

// normlization (see fftw scaling)
for (uint i = 0; i < size; i++)
{
    freqBuffer[i][0] /= (float)size;
    freqBuffer[i][1] /= (float)size;
}

// backward fft
fftw_execute(backward); 
```

一些帮助将不胜感激。

狼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:46:07.800

如果您有一个在频域中具有阶跃响应的滤波器，那么您将在空间域中看到明显的`sin(x)/x` *振铃*。这被称为[吉布斯现象](http://en.wikipedia.org/wiki/Gibbs_phenomenon)。您需要将[窗函数](http://en.wikipedia.org/wiki/Window_function)应用于所需的频率响应以减轻这种情况。

# html - 如何发布到 HTTPs？

> ID：10402966
> 
> 赞同：11
> 
> 时间：2012-05-01T19:17:06.240
> 
> 标签：html, google-chrome, internet-explorer-9

假设我有一个表格，现在正在发帖：

```
<form id="post-form" class="post-form" 
      action="/questions/ask/submit" method="post"> 
```

您会注意到 中没有*站点*，`action`浏览器跟随它从哪里获取页面。

浏览器在发布时遵循当前的域规则

```
If the current page is...                then the browser will POST to
=======================================  =============
http://stackoverflow.com/questions/ask   http://stackoverflow.com/questions/ask/submit
https://stackoverflow.com/questions/ask  https://stackoverflow.com/questions/ask/submit 
```

但我想确保浏览器始终会转到*安全*页面：

```
http://stackoverflow.com/questions/ask   https://stackoverflow.com/questions/ask/submit 
```

通常你会尝试这样的事情：

```
<form id="post-form" class="post-form" 
      action="https://stackoverflow.com/questions/ask/submit" method="post"> 
```

除非需要知道托管站点的域和虚拟路径名（例如`stackoverflow.com`）。如果网站发生了变化：

*   `stackoverflow.net`
*   `stackoverflow.com/mobile`
*   `de.stackoverflow.com`
*   `stackoverflow.co.uk/fr`
*   `beta.stackoverflow.com`

那么表格`action`也必须更新：

```
<form id="post-form" class="post-form" action="https://stackoverflow.net/questions/ask/submit" method="post">

<form id="post-form" class="post-form" action="https://stackoverflow.com/mobile/questions/ask/submit" method="post">

<form id="post-form" class="post-form" action="https://de.stackoverflow.com/questions/ask/submit" method="post">

<form id="post-form" class="post-form" action="https://stackoverflow.co.uk/fr/questions/ask/submit" method="post">

<form id="post-form" class="post-form" action="https://beta.stackoverflow.com/questions/ask/submit" method="post"> 
```

如何指示浏览器转到**页面**`https`的版本？

 *** * *

假设语法：

```
<form id="post-form" class="post-form" action="https://./questions/ask/submit" method="post"> 
```

# 302、303、307

最初`302 Found`是告诉用户代理去其他地方的代码。目的是浏览器会在新位置再次尝试：

```
POST /questions/ask/submit

302 Found
Location: /submitquestion

POST /submitquestion 
```

不幸的是，所有浏览器都弄错了，并且总是错误地`GET`在新位置上使用：

```
POST /questions/ask/submit

302 Found
Location: /submitquestion

GET /submitquestion 
```

因为浏览器弄错了，所以创建了两个新代码：

*   **`302 Found`**：（*不推荐使用旧版）*在新位置再次尝试完全相同的操作；但旧版浏览器正在切换到`GET`
*   **`303 See Other`**：忘记用户在做什么，然后`GET`在这个**位置上做一个**
*   **`307 Temporary Redirect`：在新****位置**再次尝试完全相同的事情（不，说真的，同样的事情 - 我没有说你可以切换到`GET`。如果你正在做，`DELETE`那就去`DELETE`这里。）

例如，如果用户代理在中间`POST`：

```
| Response               | What agent should do  | What many agents actually do |
|------------------------|-----------------------|------------------------------|
| 302 Found              | POST to new Location  | GET from new Location        |
| 303 See Other          | GET from new Location | GET from new Location        |
| 307 Temporary Redirect | POST to new Location  | POST to new Location         | 
```

理想情况下，有一种方法可以用来告诉用户代理在安全 URL 上再次`307 Temporary Redirect`尝试：`POST`

```
POST /questions/ask/submit

307 Temporary Redirect
Location: https://beta.stackoverflow.com/questions/ask/submit

POST /questions/ask/submit 
```

我可以在 ASP.net 中使用足够好的服务器端：

```
if (!Request.IsSecureConnection)
{
   string redirectUrl = Request.Url.ToString().Replace("http:", "https:");
   Response.Redirect(redirectUrl);

   //We don't want to send the client the deprecated 302 code, we want to use 307 telling them that we really want them to continue the POST, PUT, DELETE, etc
   Response.StatusCode = (int)System.Net.HttpStatusCode.TemporaryRedirect;     
   Response.End();
} 
```

但我不知道您是否可以在`Location`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T19:55:25.473

您可以使用 javascript 更改表单的操作：

```
var form = document.getElementById("post-form");
form.action = location.href.replace(/^http:/, 'https:'); 
```

但是有一些[安全考虑](http://www.stealmylogin.com/)，我建议您将表单的 url 重定向到 https。虽然你可以从 javascript 来做，但你永远不应该信任 javascript，因为它涉及到安全性，所以从服务器上做（它也更快，页面不需要加载，只有 http 标头）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-03T19:15:42.833

您最好确保如果用户已经登陆您的 http 页面，您将他重定向到 https 等价物。在你的 ：

```
<script>
if ((window.location.href.substring(0, 8) != "https://") {
  window.location = location.href.replace(/^http:/, 'https:');
}
</script> 
```**

# node.js - 比较 ObjectId 使用 redis 和 mongodb

> ID：10402970
> 
> 赞同：0
> 
> 时间：2012-05-01T19:17:16.917
> 
> 标签：node.js, mongodb, redis, mongoose

我在使用 mongoDB 和 redis 比较 ObjectIds 时遇到了一些问题。

我将 MongoDB 文档作为 JSON 字符串存储在 redis 中，并在从 redis 检索时使用 JSON.parse，但这会将 ObjectIds 转换为字符串，我很难将它们转换回来。

我正在将 NodeJS 与猫鼬一起使用，并尝试了以下方法：

```
mongoose.Types.ObjectId(string_of_objectid) 
```

但我得到了错误

```
Argument passed in must be a single String of 12 bytes or a string of 24 hex characters in hex format 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:11:29.687

确保`trim`您的`string_of_objectid`.

# java - Java整体数组限制？

> ID：10402972
> 
> 赞同：0
> 
> 时间：2012-05-01T19:17:25.223
> 
> 标签：java, arrays, storing-information

我正在实现一个程序，它有大约 2,000,000（200 万）个数组，每个数组大小为 16,512（128 x 129）的整数。我一次只需要调用 200 个数组（即 3.3 MB），但我想知道我是否可以将程序扩展为超过 200 万个（比如 2 亿个），但我仍然只需要一次调用 200 个数组。那么在我一次不使用超过 200 个数组的情况下，制作越来越多的数组的限制是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:20:14.007

我非常怀疑这一点，除非您在具有大量 RAM 和非常大的堆的 64 位机器上运行。

让我们计算一下数据所需的内存：

```
2,000,000*128*129*8/1024/1024/1024 = 30.8GB. 
```

JVM、程序的其余部分和操作系统需要额外的 RAM。

对我来说，这听起来像是一个构思不佳的解决方案。

如果您的意思是“我一次只有 200 个数组在内存中”，您当然可以这样做，但是您必须将其余的移到辅助存储或关系数据库中。查询它们，使用它们，GC 它们。这可能不是最好的解决方案，但根据您发布的内容很难判断。

更新：

“触发器”是否意味着“数据库触发器”？

是的，您可以将它们存储在磁盘上。我不能保证它会执行。你的硬盘当然可以处理 30GB 的数据；如果足够大，它可以容纳 300GB。

请记住，您必须考虑如何管理 RAM。GC 抖动可能是一个问题。一个好的缓存解决方案可能是你的朋友。自己不要写。

如果该硬盘驱动器发生故障并且您丢失了所有数据会怎样？你备份吗？如果磁盘出现故障，您的应用程序能否承受停机？想想那些场景，也是。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:20:17.460

只要您不保留对不再需要的数组的引用，就没有硬性限制。旧数组会自动被垃圾回收，所以你可以无限地分配和放弃数组。

当然，在任何给定时间可以保留的数组数量是有限制的。这受 JVM 可用内存量的限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:20:30.570

只要您增加最大堆大小以确保您的应用程序不会耗尽内存，就可以了。

# node.js - 如何在猫鼬的嵌入式文档中更新嵌入式文档？

> ID：10402973
> 
> 赞同：5
> 
> 时间：2012-05-01T19:17:28.160
> 
> 标签：node.js, mongodb, mongoose, mongodb-query

我正在使用 mongodb 和 mongoose 在 node.js 中构建一个 API。目前，我在嵌入文档（架构中的架构）中有一个嵌入文档，它根本没有保存到数据库中，我已经尽我所能但没有运气。

我在 mongoose 中将 Schema 定义为：

```
var BlogPostSchema = new Schema({
  creationTime: { type: Date, default: Date.now },
  author: { type: ObjectId, ref: "User" },
  title: { type: String },
  body: { type: String },
  comments: [CommentSchema]
});

var CommentSchema = new Schema({
  creationTime: { type: Date, default: Date.now },
  user: { type: ObjectId, ref: "User" },
  body: { type: String, default: "" },
  subComments: [SubCommentSchema]
});

var SubCommentSchema = new Schema({
  creationTime: { type: Date, default: Date.now },
  user: { type: ObjectId, ref: "User" },
  body: { type: String, default: "" }
}); 
```

我执行的代码如下：

```
// Create a comment
app.post("/posts/:id/comments", function(req, res, next) {
  Posts.find({ _id : req.params.id }, function(err, item){
    if(err) return next("Error finding blog post.");                
    item[0].comments.push(new Comment(JSON.parse(req.body)));
    item[0].save(); // <= This actually saves and works fine
    respond(req, res, item[0].comments, next);
  });
});

// Create a subcomment
app.post("/posts/:id/comments/:commentid/subcomments", function(req, res, next) {
  Posts.find({ _id : req.params.id }, function(err, item){
    if(err) return next("Error finding blog post.");
    item[0].comments[req.params.commentid - 1].subcomments.push(new SubComment(JSON.parse(req.body)));
    item[0].save(); // <= This completes (without error btw) but does not persist to the database
    respond(req, res, item[0].comments[req.params.commentid - 1].subcomments, next);
  });
}); 
```

我可以毫无问题地创建带有评论的博客文章，但由于某种原因，我无法在评论上创建子评论。博客文章文档实际上在执行期间打印到控制台时附加了评论和子评论 - 只是它不保存到数据库（它保存博客文章有评论，但没有子评论）。

我试图在评论数组上“markModified”，但没有改变：

```
Posts.markModified("comments"); // <= no error, but also no change
...
Posts.comments.markModified("subcomments"); // <= produces an error: "TypeError: Object [object Object] has no method 'markModified'" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T20:46:25.390

问题自解决。Aaron Heckmann 在[mongoose Google Group](https://groups.google.com/forum/#!topic/mongoose-orm/0p-rhtcJdng)上给了我答案：

> 始终在将子模式传递给父模式之前声明它们，否则您将传递未定义的。
> 
> SubCommentSchema 应该是第一个，然后是 Comment，然后是 BlogPost。

反转模式后，它起作用了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T05:39:49.147

我认为更新文档不是一个重要问题，因为嵌入式文档也完全能够提供任何服务。

# google-analytics - 自定义 Google 广告系列跟踪

> ID：10402976
> 
> 赞同：1
> 
> 时间：2012-05-01T19:17:38.590
> 
> 标签：google-analytics

我正在构建一个具有预定义会员 ID 的网站，这些 ID 正在为我们的网站带来流量。我们目前使用此参数在内部跟踪我们的 seo 工作。现在，我们希望通过 Google 的“会话级别的广告系列跟踪”来做同样的事情。问题是我们不想更改我们的网址，是否可以手动构建 Google 广告系列跟踪像素网址？我想使用我们的会员 ID 并将它们转换为 Google 的跟踪广告系列像素。

似乎谷歌建立了这个，所以所有的跟踪数据都必须在 url 中，有没有办法在没有 url 中的谷歌数据的情况下进行相同的跟踪？

**而不是：**
[http ://www.mypage.com/?utm_source=google&utm_medium=cost-per-click](http://www.mypage.com/?utm_source=google&utm_medium=cost-per-click)

**我想使用（javascript 会做剩下的）：**
[http ://www.mypage.com/?affid=123456](http://www.mypage.com/?affid=123456)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:26:36.787

您可以根据会员 ID 以编程方式设置虚拟综合浏览量。

在 if 语句中，确定您是否有会员 ID。如果这样做，请编写一些逻辑来构建正确的广告系列、媒体和来源，然后将其连接到您的 URL。通过 trackPageview 方法将其传递给 GA，而不是让它自己做。

请记住，传递虚拟 URL 确实会替换它的默认行为，因此您不会在内容报告中包含 affid 参数，除非您将其构建到虚拟网页浏览中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:13:07.957

原来这里正是我想要的： [https ://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiCampaignTracking](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiCampaignTracking)

这实际上是在做 Google 广告系列跟踪所做的所有事情，但您可以完全控制在跟踪像素中传递的参数。我不必更改或弄乱 url，我们的内部跟踪将正常工作，现在 google 跟踪像素将按照我指定的方式构建。

# javascript - 如何通过javascript的getElementByID获取Formview控件？

> ID：10402977
> 
> 赞同：1
> 
> 时间：2012-05-01T19:17:56.163
> 
> 标签：javascript, asp.net, formview

```
function ValidateYesNoOption(strIdToCheck, strIdToEnable) {
    var elementID = document.getElementById('<%=frmvwRiccAssess.FindControl("rblMeetingPlace").ClientID %>');
} 
```

如何编写 frmView.FindControl(strIdToCheck).clientID 而不是我现在所拥有的？

# objective-c - NSOutlineView - 如何移除展开/折叠切换

> ID：10402978
> 
> 赞同：0
> 
> 时间：2012-05-01T19:17:58.033
> 
> 标签：objective-c, nsoutlineview

我有一个 NSOutlive 视图，我想从某些行中删除切换。Zones 和 Assets 行是组项目（标题行），不应折叠。问题是我回答`NO`这些`- (BOOL)outlineView:(NSOutlineView *)outlineView isItemExpandable:(id)item`项目时，切换确实消失了，但是我也无法以编程方式扩展。

有没有办法从特定行中删除切换？

![例子](../Images/0c719181a1c6c9aab74942e7cd256282.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:55:13.177

这显然是设计和预期的行为（不要问为什么，我不知道）。另请参阅开发者论坛中的此线程：[https ://devforums.apple.com/message/643148#643148](https://devforums.apple.com/message/643148#643148)

当您通过返回`NO`in来转动大纲单元格时，似乎会出现问题`outlineView:shouldShowOutlineCellForItem:`。

# java - 反射getMethod而不引起异常

> ID：10402979
> 
> 赞同：2
> 
> 时间：2012-05-01T19:17:58.063
> 
> 标签：java, reflection

Java 反射中是否有一种方法可以调用 getMethod 或其他在找不到方法时不会引发异常的方法？也许只是返回一个空值？

我正在通过一个应用程序来减少预期的异常，这似乎是一个可能的候选者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:33:35.327

`null`如果找不到匹配项，您可以遍历 getMethods() 并返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:37:42.363

根据您的应用程序需求，可能适合使用[getMethods()](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Class.html#getMethods%28%29)。它返回类中所有已定义方法的数组。您可以按名称映射返回的方法，或随意使用它们。但是请注意，这可能比仅在您需要的方法上调用 getMethod() 并最终捕获异常要慢。在这种情况下，一些缓存可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:30:14.687

如果您还没有阅读这篇[**文章**](http://developer.android.com/resources/articles/backward-compatibility.html)，请查看。

Android开发者的网站似乎没有使用`try-catch`块来实现这种效果的问题......我认为你应该没问题。

如果跨多个 SDK 的兼容性是您主要关心的问题，您可以通过将代码包装在`if-else`块中来避免反射，如下所示：

```
if (currentAPIVersion >= android.os.Build.VERSION_CODES.FROYO){
    // Do something for froyo and above versions
} else{
    // do something for phones running an SDK before froyo
} 
```

# sql - 选择0行时需要oracle sql返回1行

> ID：10402981
> 
> 赞同：2
> 
> 时间：2012-05-01T19:18:07.040
> 
> 标签：sql, oracle10g, oracle11g

我对编写 oracle sql 感到头疼。当我的 sql 返回 0 行时，我需要它返回“空”而不是返回 0 行。例如，

```
select name from employee where id=1; 
```

结果：

```
0 rows selected 
```

我需要它像这样返回：

```
Empty 
```

已选择 1 行

由于db中没有这样的记录，有没有办法做到这一点？我确实需要它返回一个值。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T19:26:28.467

```
select name 
from employee 
where id=1
union all
select 'Empty'
from dual
where not exists (select 1 from employee where id=1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:27:50.317

**更新**

```
 SELECT NVL((select name from employee where id=1), 'Empty') name from dual 
```

感谢@Samual 的想法！！

# c# - 为什么连接到 VPN 后 HttpWebRequest.GetResponse() 失败？

> ID：10402985
> 
> 赞同：2
> 
> 时间：2012-05-01T19:18:39.793
> 
> 标签：c#, httpwebrequest, httpwebresponse

我试图通过本地局域网而不是互联网来控制另一个房间的计算机，这在这种情况下是一个重要的区别。这是通过发送`HttpWebRequests`命令远程计算机执行某些操作的查询字符串来完成的。命令之一是告诉远程计算机使用 Cisco 的 AnyConnect 客户端连接到 VPN。当它连接时，它应该向它成功连接的控制计算机发送回一个回复。

由于某种原因，回复`HttpWebRequest`将超时。奇怪的是我可以`HttpWebRequests`毫无问题地通过互联网发送，所以这似乎只是本地局域网的问题。为了解决这个问题，我创建了一个单独的控制台应用程序，调用它只是为了发送回复。我不确定它有什么不同，但它有效。

这是来自控制台应用程序的代码，它们是主程序中使用的两条相同的行，但无法正常工作。

```
 static void Main(string[] args)
    {
        // args[0] contains query string ie ?reply=VPNSuccess
        HttpWebRequest httpWebReq = (HttpWebRequest)WebRequest.Create(new  Uri("http://192.168.1.11:1000" + args[0]));
        HttpWebResponse httpWebResp = (HttpWebResponse)httpWebReq.GetResponse();

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:54:07.280

连接 vpn 后，远程计算机可能在不同的子网上有一个新的 IP 地址，无法路由回您。

如果我从家里将 vpn 连接到公司总部，则在 vpn 连接后，默认情况下我将无法再 ping 本地网络上的机器。这可以通过各种设置进行更改。

# svn - VisualSVN 服务器存储库备份/恢复

> ID：10402991
> 
> 赞同：9
> 
> 时间：2012-05-01T19:19:16.383
> 
> 标签：svn, version-control, tortoisesvn, visualsvn-server

我有一个带有 VisualSVN 服务器的 Windows Server 2008 托管存储库。在客户端计算机上，我有 TortoiseSVN 客户端。

**如何创建托管在服务器上的存储库的备份，然后将其还原？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T21:03:15.923

来自[http://www.visualsvn.com/support/topic/00012/](http://www.visualsvn.com/support/topic/00012/)：

* * *

*`svnadmin hotcopy`您可以使用Subversion 命令备份您的存储库。有关详细信息，请参阅[Subversion 文档](http://www.visualsvn.com/support/svnbook/reposadmin/maint/#svn.reposadmin.maint.backup)。*

*请注意，所有其他 VisualSVN Server 相关数据（例如用户权限设置）都存储在您的存储库最顶层文件夹中（默认情况下为 C:\Repositories）。您应该单独备份它们。*

* * *

要仅保存数据（没有挂钩、配置等），请使用[`svnadmin dump`](http://svnbook.red-bean.com/en/1.7/svn.ref.svnadmin.c.dump.html). 您甚至可以逐步使用它。

从 Subversion 1.7 开始，您可以通过远程运行 svn dump [`svnrdump`](http://svnbook.red-bean.com/en/1.7/svn.ref.svnrdump.html)。

根据您的备份容量，您可以选择始终进行*hotcopy*，或者*偶尔进行*一次 hotcopy，更频繁地完成*svn dump* ，每晚增加*svn dump ，等等。*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-16T06:47:39.500

从 VisualSVN Server 3.6 版本开始，该服务器包括一个[**内置的计划存储库备份和恢复**](https://www.visualsvn.com/server/features/backup/)功能。此外，3.6 版本增加了 SVN 存储库的**预定验证**。

为您的 Subversion 存储库设置计划的存储库备份和验证只需几分钟。有关分步说明，请参阅文章[KB106：备份和还原入门](https://www.visualsvn.com/support/topic/00106/)。

> 如果您要查找一次性备份，可以使用 [**Backup-SvnRepository**](https://www.visualsvn.com/support/topic/00088/#Backup-SvnRepository) PowerShell cmdlet。要恢复存储库，请使用[**Restore-SvnRepository**](https://www.visualsvn.com/support/topic/00088/#Restore-SvnRepository)。

[从主下载页面](https://www.visualsvn.com/server/download/)下载最新版本的 VisualSVN 服务器。

[![在此处输入图像描述](../Images/33bcaf77ab5e52cb9eb91b6acab0b45c.png)](https://i.stack.imgur.com/BuMGL.png)

* * *

*还有其他几种方法可以备份 VisualSVN Server 存储库。检查下面的简短描述。*

**1.`svnadmin hotcopy`工具**

`svnadmin hotcopy`允许您制作存储库的安全副本，而不管其他进程是否正在使用存储库。您可以编写一个自定义脚本，该脚本将定期为您的存储库进行备份。

您可以参考 SVNBook 中的以下文章，了解有关 Subversion 存储库备份的更多信息：http: [//www.visualsvn.com/support/svnbook/reposadmin/maint/#svn.reposadmin.maint.backup](http://www.visualsvn.com/support/svnbook/reposadmin/maint/#svn.reposadmin.maint.backup)

**2.`svnsync`工具**

这是增量备份方法。增量备份方法仅备份自上次备份以来已更改的存储库数据部分。您可以将此工具设置为“主”和“从”，并自动将任何提交复制到其存储库。

有关详细信息，请参阅“svnsync”文章：http: [//www.visualsvn.com/support/svnbook/ref/svnsync/](http://www.visualsvn.com/support/svnbook/ref/svnsync/)

**3.卷影复制备份**

VisualSVN 服务器及其相关的所有配置都可以使用卷影副本进行备份。

虽然如果在有人提交到 Subversion 存储库时进行**卷影复制**可能会出现问题，但存储库的最后一个修订版可能已损坏。但是可以使用`svnadmin recover`命令轻松恢复。

**除存储库外，您应备份以下信息：**

1.  存储在存储库根目录中的身份验证和授权文件（默认为*'C:\Repositories'*）。根据您的设置，应该有以下文件：*'authz'*、*'authz-windows'*和*'htpasswd'*。

2.  `%VISUALSVN_SERVER%\certs\`存储 SSL 证书信息的文件夹。

3.  `%VISUALSVN_SERVER%\conf\`存储 VisualSVN 服务器配置文件的文件夹。

4.  `HKEY_LOCAL_MACHINE\SOFTWARE\VisualSVN\VisualSVN Server\`存储服务器配置的其他部分的注册表项。

# php - 我的 MySQL 语句中的那一列有什么问题？

> ID：10402993
> 
> 赞同：0
> 
> 时间：2012-05-01T19:19:21.540
> 
> 标签：php, mysql

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

我有这个：

```
$query=mysql_query("SELECT DISTINCT username FROM messages 
WHERE to='admin' AND read='0'"); 
```

如果我使用`mysql_fetch_assoc($query)`我得到错误：

`PHP Warning: mysql_fetch_assoc() expects parameter 1 to be resource, boolean given`

但是，当我从 SQL 语句中删除以下内容时：`AND read='0'`，没有错误，一切正常。

关于“阅读”专栏有一些东西。它的类型是“int(1)”，默认值为 0

有谁知道它为什么这样做？多谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:20:41.030

`Read`是 MySQL 中的[保留关键字](http://dev.mysql.com/doc/refman/5.6/en/reserved-words.html)。

您需要用反引号将列名括起来：

```
AND `read`='0' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:21:51.840

在列名周围添加反引号 (`)，因为 read 是 MySQL 中的保留字。

# c# - C# 继承问题

> ID：10402995
> 
> 赞同：2
> 
> 时间：2012-05-01T19:19:49.003
> 
> 标签：c#, asp.net, .net, inheritance

同样，我对这种事情还很陌生，也许错误消息告诉我它是什么，我只是不明白，但是...... anon.cs 中的这段代码

```
namespace cheese.pies.org
{
    using System;
    using System.IO;
    using System.Net;
    using System.Web;
    using System.Xml;

    public class CasLogin : System.Web.UI.Page
    {
        private const string CasHost = "notimportant";

        public static string GetId()
        {
        }
} 
```

在这里引用时最终给我一个错误：

```
<% @Page Language="C#" Inherits="CasLogin" CodeFile="CasLogin.cs" %>
<script language="C#" runat="server">
protected void Page_Load(object sender, EventArgs e) {
    String directoryId = CasLogin.GetId();
    FormsAuthentication.RedirectFromLoginPage(directoryId, false);
}
</script> 
```

错误在第一行，是：

> 编译器错误消息：ASPNET：确保此代码文件中定义的类与“继承”属性匹配，并且它扩展了正确的基类（例如 Page 或 UserControl）。

如果我改变它

```
public class CasLogin : System.Web.UI.Page 
```

到

```
public class CasLogin : Page 
```

我收到此错误：

> 编译器错误消息：CS0246：找不到类型或命名空间名称“页面”（您是否缺少 using 指令或程序集引用？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:23:08.590

> 如果我将它从 更改`public class CasLogin : System.Web.UI.Page`为 `public class CasLogin : Page`我收到此错误

您缺少类 ( ) 的正确`using`语句，因此当您删除完整限定时，编译器将无法再找到该类。`Page``System.Web.UI``Page`

您还应该完全限定 Page 指令中的类名，即`Inherits="cheese.pies.org.CasLogin"`

**好的**

```
<% @Page Language="C#" Inherits="cheese.pies.org.CasLogin" CodeFile="CasLogin.cs" %> 
```

**坏的**

```
<% @Page Language="C#" Inherits="CasLogin" CodeFile="CasLogin.cs" %> 
```

根据您对缺少`partial`修饰符的评论：

```
public class CasLogin : System.Web.UI.Page 
```

应该：

```
public partial class CasLogin : System.Web.UI.Page 
```

这告诉编译器`CasLogin`该类是在多个文件中定义的（Web 表单就是这种情况；设计器文件与代码隐藏文件是分开的）。

如果它仍然不起作用，我建议重新创建页面并将任何相关代码复制到其中。**通常 Visual Studio 会自动处理所有这些，这不是问题。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:26:49.403

我很确定应该是

```
<% @Page Language="C#" Inherits="cheese.pies.org.CasLogin" CodeFile="CasLogin.cs" %> 
```

对于其他错误，您可以使用

```
using System.Web.UI;

public class CasLogin : Page 
```

如果没有完全限定类名，它不知道您在谈论哪个 Page，因此您可以在声明类时明确说明，也可以使用 using 语句。第一个错误是同样的问题，它看不到 chees.pies.org 命名空间内的 CasLogin 类

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:27:00.817

继承需要：

```
Inherits="cheese.pies.org.CasLogin" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T19:42:23.960

查看我自己的小测试项目/代码，我看到一些明显不同的东西：“usings”出现在命名空间声明之前，以及后面代码的**部分类的使用。**另外，请注意 Inherits 具有完全限定的类（包括命名空间）。

在 Default.aspx 中

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebApplication2._Default" %> 
```

在 Default.aspx.cs

```
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Diagnostics;
using System.Data;

namespace WebApplication2
{
    public partial class _Default : System.Web.UI.Page
    { 
```

# python - 如何使用 Python 2.5 在 Google App Engine 中使用 webapp2？

> ID：10402996
> 
> 赞同：1
> 
> 时间：2012-05-01T19:19:48.953
> 
> 标签：python, google-app-engine, webapp2

我想在 Python 2.5 下使用[webapp2](http://code.google.com/p/webapp-improved/)，这是 Python 2.7 的默认设置。这可能吗？如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T19:24:08.483

Webapp2 是 Python 2.7 运行时的一部分，但它也是一个与 Python 2.5 兼容的库，您可以像许多其他库一样[下载](http://code.google.com/p/webapp-improved/downloads/list)并在项目中使用它。
实际上，如文档中所述，Webapp2 可以在 GAE 之外独立于 App Engine SDK 使用。

要在您的 GAE Python 2.5 项目中使用它，您不需要任何额外的下载，因为 Webapp2 与 GAE SDK 一起提供，并且可以独立于采用的运行时^*导入。

这是一个关于如何在旧的 Python 2.5 运行时中使用 Webapp2 的简单示例：

**应用程序.yaml**

```
application: testwebapp2
version: 1
runtime: python
api_version: 1

handlers:
- url: .*
  script: main.py 
```

**主文件**

```
import webapp2
class HelloWebapp2(webapp2.RequestHandler):
    def get(self):
        self.response.write('Hello, webapp2!')

app = webapp2.WSGIApplication([
    ('/', HelloWebapp2),
], debug=True)

def main():
    app.run()

if __name__ == '__main__':
    main() 
```

^(* 请务必使用可用的最新 SDK)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:51:56.273

是的，webapp2 是 Python 2.7 的一部分。

[在这个 App engine Boilerplate https://github.com/coto/gae-boilerplate](https://github.com/coto/gae-boilerplate)中使用带有 python 2.7 的库的一个很好的方法

# python - 使用正则表达式查找字符相同或不同的单词

> ID：10402998
> 
> 赞同：2
> 
> 时间：2012-05-01T19:20:02.913
> 
> 标签：python, regex

我有一个单词列表，例如：

```
l = """abca
bcab
aaba
cccc
cbac
babb
""" 
```

我想找到第一个和最后一个字符相同的单词，并且两个中间字符与第一个/最后一个字符不同。

期望的最终结果：

```
['abca', 'bcab', 'cbac'] 
```

我试过这个：

```
re.findall('^(.)..\\1$', l, re.MULTILINE) 
```

但它也会返回所有不需要的单词。我想以某种方式使用 [^...] ，但我想不通。有一种方法可以使用集合（从上面的搜索中过滤结果），但我正在寻找一个正则表达式。

是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:30:04.140

有很多方法可以做到这一点。这里可能是最简单的：

```
re.findall(r'''
           \b          #The beginning of a word (a word boundary)
           ([a-z])     #One letter
           (?!\w*\1\B) #The rest of this word may not contain the starting letter except at the end of the word
           [a-z]*      #Any number of other letters
           \1          #The starting letter we captured in step 2
           \b          #The end of the word (another word boundary)
           ''', l, re.IGNORECASE | re.VERBOSE) 
```

如果需要，您可以通过替换`[a-z]`为`\w`. 这将允许数字和下划线以及字母。您还可以通过将`*`模式中的最后一个更改为 来将其限制为 4 个字符的单词`{2}`。

另请注意，我对 Python 不是很熟悉，所以我假设您的使用`findall`是正确的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T19:45:04.383

**编辑：**修复使用否定的*前瞻*断言而不是否定的*后瞻*断言。阅读@AlanMoore 和@bukzor 解释的评论。

```
>>> [s for s in l.splitlines() if re.search(r'^(.)(?!\1).(?!\1).\1$', s)]
['abca', 'bcab', 'cbac'] 
```

该解决方案使用*否定前瞻断言*，这意味着“仅当当前位置后面没有匹配其他内容时才匹配当前位置。” 现在，看一下前瞻断言 - `(?!\1)`. 这意味着“仅当当前字符后面没有第一个字符时才匹配当前字符。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:13:09.900

见鬼的正则表达式。

```
[
    word
    for word in words.split('\n')
    if word[0] == word[-1]
    and word[0] not in word[1:-1]
] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T21:10:34.740

你需要使用正则表达式吗？这是一种更 Pythonic 的方式来做同样的事情：

```
l = """abca
bcab
aaba
cccc
cbac
babb
"""

for word in l.split():
  if word[-1] == word[0] and word[0] not in word[1:-1]:
     print word 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T21:33:25.597

这是我的做法：

```
result = re.findall(r"\b([a-z])(?:(?!\1)[a-z]){2}\1\b", subject) 
```

这类似于贾斯汀的答案，除了那个做一次前瞻的地方，这个人会在每个字母被消耗时检查它。

```
\b
([a-z])  # Capture the first letter.
(?:
  (?!\1)   # Unless it's the same as the first letter...
  [a-z]    # ...consume another letter.
){2}
\1
\b 
```

我不知道你的真实数据是什么样的，所以`[a-z]`随意选择，因为它适用于你的样本数据。出于同样的原因，我将长度限制为四个字符。与贾斯汀的回答一样，您可能想要更改`{2}`to或其他一些量词。`*``+`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T19:22:08.787

您可以使用否定的前瞻或后瞻断言来做到这一点；有关详细信息，请参阅[http://docs.python.org/library/re.html](http://docs.python.org/library/re.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-01T21:52:28.440

不是 Python 大师，但也许这个

```
re.findall('^(.)(?:(?!\1).)*\1$', l, re.MULTILINE) 
```

扩展（使用多行修饰符）：

```
^                # begin of line
  (.)            # capture grp 1, any char except newline
  (?:            # grouping
     (?!\1)         # Lookahead assertion, not what was in capture group 1 (backref to 1)
     .              # this is ok, grab any char except newline
  )*             # end grouping, do 0 or more times (could force length with {2} instead of *)
  \1             # backref to group 1, this character must be the same
$                # end of line 
```