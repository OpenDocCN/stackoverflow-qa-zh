# StackOverflow 问答 000580000-000580999

# cocoa - 如何在 Mac OS X 中获取存储设备的图标？

> ID：580002
> 
> 赞同：3
> 
> 时间：2009-02-24T00:29:43.930
> 
> 标签：cocoa, iokit

我发现我的设备正在使用`IOServiceGetMatchingServices`并得到这样的属性字典：

```
kernResult = IORegistryEntryCreateCFProperties(nextMedia,
                    (CFMutableDictionaryRef *)&props,
                                              kCFAllocatorDefault, 0); 
```

从该字典中，我可以提取图标的信息：

```
NSString *bId = [props valueForKeyPath:@"IOMediaIcon.CFBundleIdentifier"];
NSString *rFile = [props valueForKeyPath:@"IOMediaIcon.IOBundleResourceFile"]; 
```

那两个给了我这个（例如）：

```
com.apple.iokit.IOStorageFamily（捆绑标识符）
Internal.icns（资源文件）

```

我尝试使用此方法提取图标：

```
NSBundle *bundleWithIcon = [NSBundle bundleWithIdentifier:bId];
NSString *iconPath = [bundleWithIcon pathForResource:rFile ofType:nil]; 
```

但是`bundleWithIcon`是`nil`。

*这甚至是获取图标的正确方法吗？*

我想我必须以某种方式加载捆绑包才能加载它`bundleWithIdentifier`，我该怎么做？

PS：[还有另一个问题](https://stackoverflow.com/questions/197383/locating-bundles-by-identifier)（我认为）试图问同样的事情，但只要求捆绑，而不是如果这是正确的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T09:08:45.483

你可以使用 NSWorkspace。
初始图像为 32x32，但它具有其他尺寸的表示，并将相应地缩放

```
NSWorkspace * ws = [NSWorkspace sharedWorkspace];
NSImage * icon = [ws iconForFile:@"/Volumes/Whatever"];
NSLog(@"%@", [icon representations]); // see what sizes the icon has
icon.size = NSMakeSize(512, 512); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T12:29:05.637

就在最近，Andrew Myrick在 darwin-dev 邮件列表上[回答了一个类似的问题：](http://lists.apple.com/archives/darwin-dev/2009/Oct/msg00088.html)

> `KextManagerCreateURLForBundleIdentifier()` in`<IOKit/kext/KextManager.h>`可能有用，但我相信它只适用于 1) 已加载或 2) 在 /S/L/E/ 中的 kext。这是雪豹头文件：
> 
> ```
> /*!
>  * @function KextManagerCreateURLForBundleIdentifier
>  * @abstract Create a URL locating a kext with a given bundle identifier.
>  *
>  * @param    allocator
>  *           The allocator to use to allocate memory for the new object.
>  *           Pass <code>NULL</code> or <code>kCFAllocatorDefault</code>
>  *           to use the current default allocator.
>  * @param    kextIdentifier
>  *           The bundle identifier to look up.
>  *
>  * @result
>  * A CFURLRef locating a kext with the requested bundle identifier.
>  * Returns <code>NULL</code> if the kext cannot be found, or on error.
>  *
>  * @discussion
>  * Kexts are looked up first by whether they are loaded, second by version.
>  * Specifically, if <code>kextIdentifier</code> identifies a kext
>  * that is currently loaded,
>  * the returned URL will locate that kext if it's still present on disk.
>  * If the requested kext is not loaded,
>  * or if its bundle is not at the location it was originally loaded from,
>  * the returned URL will locate the latest version of the desired kext,
>  * if one can be found within the system extensions folder.
>  * If no version of the kext can be found, <code>NULL</code> is returned.
>  */
> CFURLRef KextManagerCreateURLForBundleIdentifier(
>     CFAllocatorRef allocator,
>     CFStringRef    kextIdentifier); 
> ```
> 
> 请注意，在 Snow Leopard 之前，它可能仅适用于 /S/L/E 中的 kext；API 存在，但没有描述其行为的 headerdoc。

对我来说，这在 Mac OS X 10.5 上运行得非常好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T15:44:45.137

这可能会对您有所帮助。（或者可能不是）...

在玩'ioreg'命令时，我遇到了一些让我想起你的问题的东西，所以我会发布它：

尝试发出以下命令：

```
ioreg -c IOMedia -x 
```

这将产生一大堆输出，看起来像这样：

```
 |     +-o IOBlockStorageDriver  <class IOBlockStorageDriver, registered, matched, active, busy 0, retain 7>
  |       +-o Apple read/write Media  <class IOMedia, registered, matched, active, busy 0, retain 9>
  |         | {
  |         |   "Removable" = Yes
  |         |   "BSD Unit" = 0x4
  |         |   "IOBusyInterest" = "IOCommand is not serializable"
  |         |   "BSD Minor" = 0xc
  |         |   "Ejectable" = Yes
  |   |         |   "BSD Name" = "disk4"
  |         |   "Leaf" = No
  |         |   "IOMediaIcon" = {"CFBundleIdentifier"="com.apple.iokit.IOStorageFamily","IOBundleResourceFile"="Removable.icns"}
  |         |   "Preferred Block Size" = 0x200
  |         |   "Whole" = Yes
  |         |   "Open" = Yes
  |         |   "Size" = 0x100000
  |         |   "Writable" = Yes
  |         |   "Content" = "Apple_partition_scheme"
  |         |   "IOGeneralInterest" = "IOCommand is not serializable"
  |         |   "Content Hint" = ""
  |         | }         |   "BSD Major" = 0xe 
```

这一切都让我相信（因此在这里盲目地建议您进行调查）如果您遍历与“IOMedia”匹配的 io 注册表树，您可以获得包含键入“IOMediaIcon”的条目的属性字典，它本身似乎是一个集合通知您捆绑标识符和资源文件名。

并不是说这很容易……但是请查看*FireWire SDK*以获取您可能需要的所有示例代码……无论如何，它可能比硬编码预填充路径“更好”（这可能会在未来的操作系统中消失发布）。

|K<

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T01:58:12.923

> 那两个给了我这个（例如）：
> 
> com.apple.iokit.IOStorageFamily（捆绑标识符） Internal.icns（资源文件）
> 
> 我尝试使用此方法提取图标：
> 
> NSBundle *bundleWithIcon = [NSBundle bundleWithIdentifier:bId]; NSString *iconPath = [bundleWithIcon pathForResource:rFile ofType:nil];
> 
> 但是`bundleWithIcon`是`nil`。

`bundleWithIdentifier:`要求您已经为具有该标识符的捆绑包创建了一个 NSBundle 实例；它只查找以前创建的实例。因此，您需要在文件系统中找到捆绑包并通过路径名对其进行实例化。幸运的是，您似乎已经获得了有关该问题的链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-14T13:27:45.410

没有自定义图标的卷将与您在此处硬编码路径的操作系统通用图标之一一起显示。带有自定义图标的卷将该图标存储在其文件系统中，如果未安装，则查找它完全是您的工作。

# .net - “好”的数据库记录比较工具？

> ID：580010
> 
> 赞同：1
> 
> 时间：2009-02-24T00:32:54.267
> 
> 标签：.net, sql, database

我是一家支持 CRM CMS (Salesforce) 的公司的系统管理员。

我不喜欢内置功能，所以我通常通过 CSV/XLS 文件管理数据以进行上传和下载，因为我可以编写更好的查询等。我的任务之一是上传联系人和帐户。由于缺少唯一标识符和拼写错误，我在上传的记录中遇到重复项。

*   上传联系人时，我尝试通过电子邮件、电话号码和/或姓/名进行匹配
*   对于公司，我通常仅限于帐户名称，有许多可能的缩写和拼写错误

我正在寻找一种更好的方法来检查具有以下约束的重复项：

> 给定一个姓名、电子邮件或电话号码列表（都存储为文本字段），在两个表之间进行比较检查，从第二个表中寻找最佳匹配。最好在多个领域之间，但即使它只是一个，它也会极大地帮助我的努力。

数据集的大小约为最长表上的 17,000 条记录。通常一次输入大约 50 个值。我的限制是我拥有的硬件，没有预算自由裁量权。我的编程能力很基础，但我可以学习并在系统上安装 Eclipse 和 Visual Studio。

有没有人建议我如何以编程方式或使用第三方工具解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T00:40:57.773

我使用的两个数据库比较工具是 xSQL 和 Redgate SQL Compare。

我更喜欢redgate，因为它易于使用，但它非常昂贵。

xSQL 一开始有点复杂，但它非常强大，它在脚本模式和数据方面也比 SQL Server 做得更好。它也便宜很多。

实际上，仔细研究您的问题，您似乎需要在比较中获得一些情报，在这种情况下，由于您已经安装了 Visual Studio，我会说您已经拥有可以进行一些非常深入的比较的工具，只需要做一些编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T00:45:24.017

您本质上是在谈论[自然语言解析](http://en.wikipedia.org/wiki/Natural_language_processing)，以及更通用的模式匹配（缩写等）。你不会找到一个简单的解决方案。但你可以提高你的机会。

我可能会从最简单的一点开始：拼写错误。“<a href="http://en.wikipedia.org/wiki/Soundex" rel="nofollow noreferrer">soundex” 算法（正确的，[Soundex 索引系统](http://www.archives.gov/publications/general-info-leaflets/55.html)）根据单词发音时的发音（大概是由美国演讲者），并呈现它们，以使听起来相似的单词比较相似。这在尝试根据同音字查找错误拼写时非常有用：根据相似的 soundex 值向用户显示匹配项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T14:42:52.490

As @MrTelly mentioned, name and address (and company) matching is very complicated.

One third party tool - there's a stand-alone GUI as well as a programmer's API - MatchUp by Melissa DATA.

GUI: [http://www.melissadata.com/products/matchup.htm](http://www.melissadata.com/products/matchup.htm)

API: [http://www.melissadata.com/dqt/matchup-api.htm](http://www.melissadata.com/dqt/matchup-api.htm)

*Disclaimer: I work for Melissa DATA and was the primary developer for these products. But I wholeheartedly stand behind my work!*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T01:16:10.213

名称和地址匹配可能非常困难，我曾使用商业工具来做到这一点，而且它们的价格很高，尤其是当它们使用完整的地址列表时，有时还有名称。

另一种可行但耗时的方法是建立自己的迷你脚本库。有两种方法，您可以尝试 perl、awk、shell 脚本和您喜欢的任何其他语言，并使用基于文件和文本的数据。或者你可以建立一套 Sql、查询和 coe 片段，也许在 Access 中？无论哪种方式，如果您的预算为零，您可能会花费大量时间来构建自己的库，但拥有它是一项有用的技能。

# mono - 嵌入单声道时如何设置运行时选项？

> ID：580011
> 
> 赞同：3
> 
> 时间：2009-02-24T00:33:06.090
> 
> 标签：mono

喜欢这些选项：

```
用法是：mono [options] 程序 [program-options]

发展：
    --aot 将程序集编译为本机代码
    --debug[=] 启用调试支持，使用 --help-debug 获取详细信息
    --profile[=profiler] 使用指定的分析器模块在分析模式下运行
    --trace[=EXPR] 启用跟踪，使用 --help-trace 获取详细信息
    --help-devel 显示更多可供开发人员使用的选项

运行：
    --config FILE 加载 FILE 作为 Mono 配置
    --verbose, -v 增加详细程度
    --help, -h 显示使用信息
    --version, -V 显示版本信息
    --runtime=VERSION 使用 VERSION 运行时，而不是自动检测
    --optimize=OPT 打开或关闭特定优化
                           使用 --list-opt 获取优化列表
    --security[=mode] 打开不支持的安全管理器（默认关闭）
                           mode 是 cas、core-clr、verifiable 或 validil 之一

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T13:40:03.390

--config -> mono_config_parse ()

--trace -> mono_jit_set_trace_options ()

--runtime -> mono_jit_init_version ()

--verbose 和 --optimize -> mono_set_defaults () 和 mono_parse_default_optimizations ()

--profiler -> mono_profiler_load ()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-04T06:49:31.470

你可以在单声道 4.x 中做到这一点

```
mono --optimize=float32 program.exe 
```

或者

```
const char* jit_options[] = {"--optimize=float32"};
mono_jit_parse_options(1, (char**)jit_options); 
```

# c - 如何在命名管道 (mkfifo) 上执行非阻塞 fopen？

> ID：580013
> 
> 赞同：21
> 
> 时间：2009-02-24T00:34:21.517
> 
> 标签：c, linux, named-pipes, blocking, fifo

如果我有一个程序使用 mkfifo 创建并尝试打开命名管道，我如何打开管道进行读取或写入而不阻塞？

具体来说，我正在编写一个可以在有或没有 gui（用 Java 编写）的情况下运行的 C 程序。

在 C 程序中，我使用 mkfifo 成功创建了命名管道，但是当我这样做时

```
FILE* in = fopen(PIPE_IN, "r"); /* Where PIPE_IN is the filename*/ 
```

在 GUI 打开该管道进行写入之前， fopen 不会返回。我想要做的是让该管道准备好读取一次（如果）GUI决定写入它 - 我将把文件描述符放在 select() 调用中。可以合理地预期 java GUI 可能永远不会真正启动，因此我不能依赖它在任何特定点甚至根本无法打开管道的另一端。

我还将打开第二个管道进行写作，我想我也会遇到同样的问题。此外，我无法在没有阅读器的输出管道上设置 O_NONBLOCK。

有什么建议么？

（这是在linux系统上运行的）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-24T00:51:37.420

您可以使用`open()`pipe `O_RDONLY | O_NONBLOCK`，如果您想要 C 流，可以使用`fdopen()`. 但是，-AFAIK 可能存在问题`select()`，一个为读取而打开的管道 fd 始终准备好读取，并`read()`返回 0，因此`select()`会无限期地触发。

克服这个问题的一个笨拙的方法是打开管道`O_RDWR`；也就是说，至少有一个作家（你的 C++ 程序）。无论如何，这将解决您的问题。

# php - 从 php 值中剥离 $

> ID：580019
> 
> 赞同：0
> 
> 时间：2009-02-24T00:36:44.710
> 
> 标签：php

我有一个表格，用户可以在其中输入他们在电话账单上花费的金额，然后我告诉他们如果切换到 vonage、Skype 等可以节省多少。

我在 url 中传递值“$monthlybill”，然后对其进行一些数学运算。问题是如果用户在表单中写“$5”而不是“5”，它会中断并且不会被识别为数字。如何从值中去掉美元符号？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T00:41:01.640

```
$monthlybill = str_replace("$", "", $monthlybill); 
```

您可能还想查看[money_format 函数。](http://is2.php.net/manual/en/function.money-format.php)如果您使用现金金额。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T00:45:32.863

[Ólafur 的](https://stackoverflow.com/questions/580019/stripping-from-php-values/580029#580029)解决方案有效，可能是我会使用的，但你也可以这样做：

```
$monthlybill = ltrim($monthlybill, '$'); 
```

这将删除字符串开头的 $ 。

然后，您可以根据您的需要进一步验证它是一个货币金额。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T00:51:48.027

```
function extract_decimal($str)
{
    $match = preg_match('/-?\d(\.\d+)?/', $str, $matches);
    return $match ? $matches[0] : null;
} 
```

此函数将删除不属于数字的任何内容（包括美元符号），并且还支持负数和十进制值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T00:54:19.317

考虑到这是用户输入，您可能希望从变量中删除所有非数字字符。

```
$BillAmount = preg_replace('/[^\d.]/', '', $BillAmount); 
```

# ruby-on-rails - 使用 Rails 2.3 模型嵌套为新的关联对象创建表单

> ID：580021
> 
> 赞同：2
> 
> 时间：2009-02-24T00:37:03.787
> 
> 标签：ruby-on-rails, ruby, forms, associations, nested-forms

尝试在新的 Rails 候选版本中使用嵌套模型表单。我有这个，但它只为每个现有的关联照片对象呈现表单字段。

`f`（给定一个为我的父模型对象创建的表单构建器）

```
%h3 Photos

- f.fields_for :photos do |photo_form|
  %p
    = photo_form.label :caption
    = photo_form.text_field :caption

  %p
    = photo_form.label :image_file
    = photo_form.file_field :image_file 
```

如何使用此嵌套表单功能为新照片对象创建表单部分以及编辑现有照片？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T13:39:22.240

关联的对象只需要存在内存中就可以呈现在表单中，不需要保存。因此，您可以在渲染表单之前构建它们！

例如，在您的控制器中，您可以执行以下操作：

```
def new
  @object = MyObject.new
  3.times { @object.build_associated_object }
end 
```

现在，当您的表单呈现时，它有 3 个对象可以显示表单！这是最简单的方法。当然，您也可以使用 Javascript 动态添加项目。

# vb6 - VB6 ssTab 怪异

> ID：580031
> 
> 赞同：1
> 
> 时间：2009-02-24T00:41:19.783
> 
> 标签：vb6

我在 VB6 程序中使用 ssTab 控件（这可能是我的全部问题），并且我将数据绘制到位于 Tab 0 上的 Picturebox 中。当我重绘图形时（例如，在调整窗口大小之后），第一个我要做的是清除盒子：

```
Picture2.Line (0, 0)-(Picture2.Width, Picture2.Height), RGB(255, 255, 255), BF 
```

这在 Tab 0 可见时工作正常，但如果在另一个选项卡可见时调用此代码，则整个可见选项卡（以及选项卡 0）的背景将被涂成白色。不仅仅是 Picture2 的区域，而是两个选项卡的整个可见区域。0 以外的选项卡和当前选中的选项卡不受影响。

我第一次尝试粗略地解决这个问题是在上面的 Line 命令之前添加将选项卡更改回选项卡 0：

```
SSTab1.Tab = 0 ' Select tab containing PictureBox2
DoEvents 
```

但这得到了相同的结果 - 原始标签和 0 选项卡现在都是白色的（尽管它确实将可见选项卡更改回选项卡 0）。

我注意到当墙绘发生时， Picture2.Width 的值比它应该的大得多。如果 Tab 0 可见，Picture2.Width 在我调整窗口大小时在 7180 和 21225 Twips 之间变化。当我选择 Tab 1 并调整大小时， Picture2.Width 大约为 82180（高度保持在应有的位置）。

我知道 SStab 有点问题，但有人知道任何解决方法吗？我可能可以拼凑一个修复程序（在重绘后将两个选项卡上的背景重绘为灰色），但我想了解为什么 Picture2.Width 会失去理智......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T00:54:57.770

SStab 使一个选项卡上的控件可见同时隐藏其他控件的方式是使 Left 属性为负数（基本上是“离屏”）

这不应该影响宽度属性 - 你有自定义调整大小的代码吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T00:53:46.180

有一个关于 sstab 和宽度的小铃铛响起……但如果我能记得是什么，该死的。不知何故，我认为它对不可见的选项卡上的控件做了奇怪的事情？

是的...它将它们“移出屏幕”（将“左”设置为非常大的负位置）。或者至少这是我快速而肮脏的测试所显示的。

我认为（不“知道”）PictureBox 控件通常直接直接处理表单的设备上下文......所以它不喜欢 sstab 对它所做的事情并不让我感到惊讶。

我建议您仅在切换到该选项卡时重新绘制...如果您知道我的意思。或者可能检测到图片框不在屏幕上并跳过刷新（当图片框移动时仍需要进行刷新）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T23:29:00.963

一旦我理解了奇怪行为的原因（感谢 DJ：'SStab 使一个选项卡上的控件可见而隐藏其他控件的方式是通过使 .Left 属性为负数（基本上是“屏幕外”）'），我意识到我的问题出在哪里。

正如 DJ 所说，当您选择不包含 PictureBox 的选项卡之一时，PictureBox.Left 属性变得非常负面（如 -74000）。在我的 Form_Resize() 代码中，我有以下行：

```
Picture2.Width = MainForm.Width - (Picture2.Left + PictureBoxMargin) 
```

这使得 Picture2.Width 成为一个更大的正数（我的大错误）。

最终解决方案是创建一个公共变量 Picture2LeftEdge，在 Form_Initialize() 例程中将其设置为 Picture2.Left，并将上述调整大小的行更改为：

```
Picture2.Width = MainForm.Width - (Picture2LeftEdge + PictureBoxMargin) 
```

感谢 DJ 和 rbobby 的超快速响应！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-10T15:42:13.577

这个问题的解决方案是在每个选项卡的基础上编写调整大小的代码。这允许 SSTab 将其他选项卡的内容移出屏幕，并让您为当前选项卡移动内容。

这是一些执行这种调整大小的代码。

```
Private Sub Form_Resize()

Select Case SSTab.Tab
Case TAB0_INDEX
    With fraTab0
        .Left = 150
        .Top = 320
        .Height = SSTab.Height - 400
        .Width = SSTab.Width - 200
    End With

Case TAB1_INDEX

    With txtMaxPixelData
        .Height = SSTab.Height - 850
    End With
    With txtPixelData
        .Height = txtMaxPixelData.Height
    End With
End Select
End Sub 
```

# apache - Apache2 - 使用 BasicAuth 授权用户访问位置，但仅适用于本地子网之外的用户

> ID：580032
> 
> 赞同：1
> 
> 时间：2009-02-24T00:41:27.413
> 
> 标签：apache, apache2, basic-authentication, apache-config

在我的 Apache 2 配置中，我有一个`VirtualHost`看起来像这样的：

```
<VirtualHost *:80>
  ServerName sub.domain.com

  # username:password sent on to endpoint
  RequestHeader set Authorization "Basic dXNlcm5hbWU6cGFzc3dvcmQ=="

  ProxyPass        /xyz http://192.168.1.253:8080/endpoint
  ProxyPassReverse /xyz http://192.168.1.253:8080/endpoint

  <Location /xyz>
    # This needs to let users through under the following circumstances
    #   * They are in 192.168.1.0/24
    #   * They have a valid user in a htpasswd file

    # So what goes here?
  </Location>
</VirtualHost> 
```

我使用虚拟主机作为网络上另一台服务器（我将称之为端点）的反向代理。

我正在尝试找出一种配置，该配置将允许网络浏览中的用户`sub.domain.com`自动获得端点服务。但是，应提示网络外的用户输入凭据

端点需要我使用 RequestHeader （我想要的）隐藏的密码。应提示外部用户的密码是不同的，并且需要是 BasicAuth，从`htpasswd`文件中获取它的用户列表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T00:54:21.250

```
<Location /xyz>
  # This needs to let users through under the following circumstances
  #   * They are in 192.168.1.0/24
  #   * They have a valid user in a htpasswd file 
```

从[http://httpd.apache.org/docs/2.2/mod/core.html#satisfy](http://httpd.apache.org/docs/2.2/mod/core.html#satisfy)出来：

```
 Require valid-user
  Order allow,deny
  Allow from 192.168.1
  Satisfy any 
```

当然，您还需要包含您的 AuthUserFile 或任何指令

```
 AuthType basic
  AuthName "yadayadayada"
  AuthUserFile /foo/bar/blah/.htpasswd
</Location> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T00:55:57.737

您可以创建两个虚拟主机，一个在外部接口上侦听，一个在本地。身份验证设置将在前者中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T01:48:02.540

我认为 David 已经很好地介绍了 Apache2 配置，但使用拆分 DNS 为您的内部和外部用户提供不同的服务也很常见。您的内部用户确实没有理由从您的代理发出请求，因为他们（表面上）可以直接访问“端点”。

在某些情况下，如果您的内部用户连接到您的公共 IP 地址之一，您实际上可能会导致路由延迟和拥塞。最初，我喜欢为两个 DNS 服务器使用单独的硬件，但最近转而使用绑定“视图”为我的两个用户类提供不同的区域。

# optimization - 如何优化我的基本物理模拟器？

> ID：580035
> 
> 赞同：35
> 
> 时间：2009-02-24T00:41:38.940
> 
> 标签：optimization, physics, collision-detection

我编写了一个简单的物理建模器，可以让我在屏幕上弹跳球。您可以单击并拖动来发射一个球，或者您可以一次生成数百个球并观察它们之间的相互作用。

[![替代文字](https://i.stack.imgur.com/xRoTW.png)](https://i.stack.imgur.com/xRoTW.png)
[[链接到更大的版本]](http://i43.tinypic.com/j0k67o.png)

这是一个有趣的小程序，如果可以的话，我想更进一步。我知道他们说过早的优化是万恶之源，但我开始遇到实际的性能障碍，我想知道是否有经验丰富的游戏/模拟器开发人员可以帮助我。

**问题：**

现在，如果你添加太多球，我的程序就会窒息（在我的机器上它似乎无法处理超过 800 个）。如果这样做，模拟将不再真实，并且所有球在底部相互重叠。

问题在于碰撞检测。在最简单的情况下，碰撞检测是一个 O(N^2) 问题。每个球检查每个其他球。这很快就会变得很糟糕（即使在 100 个球之后，每个循环周期你也要进行 10k 次碰撞检查）。

如果你看这里，你可以看到我添加了数百个球的屏幕截图。模拟器跟不上，它们开始相互重叠。

[![替代文字](https://i.stack.imgur.com/L8zoE.png)](https://i.stack.imgur.com/L8zoE.png)
[[链接到更大的版本]](http://i39.tinypic.com/2jes2fb.png)

目前，我通过寻找重叠的球来检测碰撞。如果我找到两个重叠的球，我会用它们的最小平移距离 (MTD) 将它们分开，或者将它们推开。然后我使用一个简单的物理方程来调整它们的冲量矢量，然后它们在碰撞后会朝不同的方向移动。

它工作得很好，除非球太多，最小平移距离变得明显。它们开始大量重叠，并在底部不断地相互推挤。我增加“重力”越多，情况就越糟。对它们施加的压力增加并且它们彼此压缩/重叠的量增加。

同样，在我击中相当数量的 N 个球之前，我没有任何问题。

**当前优化方法**：

碰撞检测 -
*[扫描和修剪](https://en.wikipedia.org/wiki/Sweep_and_prune)*- （又名排序和扫描）

我在我的球上使用插入排序，每个循环沿着它们的 x 轴循环。由于插入排序的性质，我可以利用模拟器的[时间连贯性。](https://en.wikipedia.org/wiki/Collision_detection)逐帧，球的位置变化很小，所以排序没有太多工作要做。这将线性排序摊销运行时间带到 O(N) 或线性，而不是 O(N^2) 的平均运行时间。

由于球已排序，因此在检查碰撞之前，我在第二个循环中进行了几次预检查。现在我只需要检查彼此靠近的球（因为它们是沿 x 轴排序的），并且每当我检查一个球与另一个 xmin 大于当前球的 xmax 的球时，我都会跳出第二个循环. 所以它跳过了成千上万的检查。

当我实现这个时，它带来了巨大的速度提升。但是，我仍然希望能够处理超过 600-800 个球。我读过物理引擎可以轻松同时处理 10k 个对象之间的碰撞检测，所以我想我可以通过一些工作达到 1-2k。

运行*分析器*后，碰撞检测占用了我大约 55% 的时间，而渲染占用了大约 45% 的时间。所以，这是我最昂贵的两项费用。

* * *

*问题：*

**你能想到任何更好的算法或技术让我的模拟器能够处理更多的球吗？**

* * *

相关代码：

**整个项目：**

> svn 结帐[http://simucal-projects.googlecode.com/svn/ballbounce/trunk/](http://simucal-projects.googlecode.com/svn/ballbounce/trunk/)

或者，单击[此处](https://web.archive.org/web/20140916104935/http://simucal-projects.googlecode.com/svn/ballbounce/trunk/)在浏览器中手动浏览文件。

**感兴趣的部分：**

*   [Pastebin：checkCollisions()](https://pastebin.com/f1163dfa6) - 带扫描和修剪
*   [Pastebin：resolveCollision()](https://pastebin.com/f76b6f565) - 如果仍然没有被 Sweep 和 Prune 删除，那么昂贵的真实碰撞检查和解决方案。
*   [Pastebin: render()](https://pastebin.com/f2598b49) - 单独渲染占用了我大约 45% 的时间。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T02:01:11.167

简单的方法是不要测试对象与对象的碰撞，用每个球的中心点填充一个数组。然后，从每个中心扫描一个以该点为中心的大小为 4*radius 的正方形（您可以通过不使用正方形对其进行一些优化，但代价是使代码更复杂）。如果这个正方形中还有另一个中心，那么您才检查它们是否在彼此的 2* 半径范围内（因此会发生碰撞）。您可以通过降低分辨率和四舍五入球的位置来进一步优化这一点，从而减少您需要执行的检查次数。

另一种方法是将您的空间划分为网格，并将对象存储在网格区域中。您只需要检查相邻网格中对象之间的碰撞。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-24T00:53:43.263

跟踪附近的球 -

就像插入排序由于每帧的最小变化是最佳的一样，您可以使用相同的属性来保持跟踪球“邻居”

每个球最多只能与可能的 6 个其他球互动。您可能每 10 帧左右运行一次算法，以确定每个球有哪些邻居，然后在接下来的 10 帧中使用该信息来计算实际碰撞。

您还可以跟踪每个球的矢量，绘制虚拟线，并查看在接下来的 3-5 帧中哪些线交叉，并仅计算可能发生的碰撞（尽管由于时间的原因很少发生）。

正如您按 x 轴排序一样，您可以在主窗口内的细分中“分组”球。当一个球在至少一个球直径的细分内时，它只需要查看同一细分中的球。如果它更接近一两个边界，则需要查看一两个其他细分，但计算量应该更少。

此外，这些细分可以动态定位，因此平均细分只有 100 个球 - 不需要具有不同数量的球的相同大小的细分。

根据细分的拥挤程度（每平方单位的球数），您可以尝试不同的算法 - 稀疏填充的框只需要矢量计算来预测碰撞，而密集的细分可能只需要某种优化的六边形计算。稀疏框可能不需要对许多帧进行碰撞检测（因为不会像在密集框中那样注意到重叠）。

可以确定给定盒子的能量密度——一个非常稀疏的低能量球盒子比一个高能量的稀疏盒子需要更少的碰撞计算。

-亚当

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T02:58:44.960

Once a ball is completely surrounded by other balls stop considering it for collision detection. Just from looking at your screenshot it seems that only the "surface" balls should be considered. Why check the ball 6 balls deep that nothing can possibly collide with? This would greatly reduce the number of potential collisions.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-21T04:39:21.577

你的主要问题是你的碰撞解决算法——你可以加快绘图和碰撞检测，但这不会阻止你的球相互碰撞。你遇到的问题比看起来更难解决；不过，有可能做对。

在您的情况下，在失败的配置（大 bin-o'-balls）中，您的对象应该真的相互滑动，而不是弹跳。滑动是一个连续的约束，它不同于你的实现处理的基于脉冲的约束。

防止崩溃的最简单方法是重新检查所有碰撞对象，以确保它们在进行碰撞处理*后*不会相互穿透——可能会根据需要进行多次迭代，直到它们*都没有*违反约束。这当然会花费更长的时间 - 可能更长（甚至会增加无限循环的可能性，尽管可能不是在那种特定情况下......）。

有一些很好的算法可以让你的模拟运行起来，但它们比你的基于脉冲的系统更复杂。通常，它们涉及将相互作用的物体（如垃圾箱中的球）视为一个整体，并调整它们的集体配置以满足它们的相互约束。

*您应该寻找有关多体模拟*的作品（书籍、论文、网站）。我不能说哪个可能对您的目的最有用；如果我是你，我会先去一个好的大学图书馆，然后翻阅他们关于这个主题的所有书籍。你应该为一些严肃的数学做好准备；如果诸如“拉格朗日乘数”之类的术语让您陷入荨麻疹，请注意 8^)。基本上，如果你走这条路，你很可能会学到很多数学知识，而且会学到不少物理知识。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-24T01:05:44.937

硬核物理引擎使用浮点矢量化，如果幸运的话，它可以在当前硬件上提供 x16 的提升，而在专用硬件上则更多。例如，Larrabee 可以同时处理 1024 次计算，以实现数学处理中的 totcal x1024 提升（但它需要这个，因为它也是 GPU）

尚未查看代码，但您是否在使用数学优化，如快速平方根和二进制绝对值，或按位符号翻转？这些东西本身并没有帮助，但是当你搅动大量数据时，这些技术将一些数学重新路由到主 CPU，释放 FPU，基本上给你更大的吞吐量。

GCC 的 SIMD 代码生成也很糟糕，我看到使用 VC 或 IntelCompiler 增加了 16 倍，这意味着，如果你注意的话，GCC 根本没有使用任何 SIMD 指令！

此外，那些所谓的 10k 碰撞并不像您模拟的那样近距离，因此无法直接比较。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-20T20:54:21.867

I've been following the development of [Chipmunk](http://wiki.slembcke.net/main/published/Chipmunk) since it began and from my understanding the answer to optimizing is in the data structures. (isn't it always?)...

The data structure Chipmunk uses to achieve [this](http://files.slembcke.net/temp/logo_bullet.swf) is a [Spacial Hash](https://stackoverflow.com/questions/580035/how-can-i-optimize-my-basic-physics-simulator).

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-24T01:58:22.563

在这一点上，它开始听起来几乎像引力场中的一种轻微可压缩的流体。使用欧拉观点的计算流体动力学思想可能会有所帮助。如果您创建一个网格，使得一次只有一个球可以占据每个单元格，您可以为每个单元格编写质量守恒、动量和能量平衡，并以这种方式跟踪球的运动。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-12-30T22:09:26.623

同时。我意识到我回答晚了大约一年半，但我仍然想把我的想法写下来。

我最近写了一个关于与[你的球重叠问题相同](https://stackoverflow.com/questions/4481189/mass-ball-to-ball-collision-handling-as-in-lots-of-balls)的问题，它实际上使用了你使用的相同算法。我提交的时候没有看到你的问题，所以我不好。

首先，

**优化**：我使用了一个简单的网格划分系统，整个屏幕被划分为单元格，这些单元格是最大球直径的宽度和高度。网格跟踪每个球所在的单元格，因此当需要进行碰撞检查时，我使用 nearBy() 函数填充与我正在检查的单元格相邻的单元格中的每个球的 ID 列表.

网格方法效果很好，在滞后之前我最多可以有 2000 个球。虽然在网格中删除和添加球有点痛苦，但这正是我实现它的方式（网格主要基于球列表和每个球的索引位置）。

将来，我想研究其他分区和优化碰撞检查的方法。

**重叠**：这里和其他地方的很多答案都建议您递归地纠正每一帧的碰撞。这实际上在一定程度上对我有用。通过足够好的优化，您可以每帧进行 2 或 3 次检查，这似乎可以防止一些重叠的混乱。虽然它并不完美。我怀疑提高准确性（使用插值和更好的集成等花哨的词）可以帮助解决抖动和重叠问题。

我考虑过根据优先级排序碰撞检查（最高的是接触墙壁的碰撞检查，然后是接触墙壁的碰撞检查是优先级列表中的一步，等等），并将其考虑到最小平移距离中。[MyPhysicsLab](http://www.myphysicslab.com/contact.html)谈到处理多个同时发生的碰撞，但我还没有研究过。

如果你发现了什么，请更新！我正在研究完全相同的问题，并且球模拟器似乎很受欢迎。如果我们要继续研究刚体物理，这种体验会派上用场。

谢谢。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-21T03:14:08.677

尝试这个：

**将你的矩形分成 N*M 个正方形，使正方形比球的半径**稍宽。让正方形与矩形的边缘重叠可能是个好主意，而不是整齐地放在其中。

制作一个 BitSet 数组。不要使用 Bitset[M][N]，只需使用 new Bitset[M*N] - 一点乘法不会对您造成伤害。

用数字识别每个球。当您将球定位在某个位置时，为该正方形及其周围的 8 个正方形设置 bitset 中的位（为了使这更容易，扩展您的正方形数组，使它们延伸到矩形边缘之外 - 这样您不必剪辑。）

穿过广场。对于每个方形标记中的每对球，这对球都是潜在的碰撞。为此，请创建一个位组 - 假设您有 H 个球并且球 A 和 B 占据同一个方格 - 设置位 A+B *H 和 A* H+B。

现在很容易找出潜在的冲突，因为 BitSet 包含一个方法，该方法说“在设置的那个之后找到我的下一个位”。请记住，每个位都是双重计数的，因此当检测到位 Q 被设置时，请务必取消设置位`(Q%H)*H + (Q/H)`- 这是该对的另一位。

或者：您可以很容易地折叠该冲突数组。A 和 B 之间的冲突 -**假设 A > B**可以通过设置 bit 来标记`A * (A-1) / 2 + B`。这样做的好处是您不需要关心球的总数。

其实：算了。只需使用我写的这个类作为练习：

```
import java.util.BitSet;
import java.util.Iterator;
import java.util.NoSuchElementException;

public class PairSet extends BitSet implements
    Iterable<PairSet.Pair> {
  public static class Pair implements Comparable<Pair> {
    public final int a;
    public final int b;

    private Pair(int a, int b) {
      if (a < 0 || b < 0 || a == b) { throw new IllegalArgumentException(
          "Pair(" + a + "," + b + ")"); }
      if (a > b) {
        this.a = a;
        this.b = b;
      } else {
        this.a = b;
        this.b = a;
      }
    }

    public String toString() {
      return "Pair(" + a + "," + b + ")";
    }

    public int hashCode() {
      return a * (a - 1) / 2 + b;
    }

    public boolean equals(Object o) {
      return o instanceof Pair
          && hashCode() == ((Pair) o).hashCode();
    }

    public int compareTo(Pair o) {
      return hashCode() - o.hashCode();
    }

  }

  PairSet() {}

  PairSet(BitSet z) {
    or(z);
  }

  PairSet(Iterable<Pair> z) {
    for (Pair p : z)
      set(p);
  }

  public void set(Pair p) {
    set(p.a, p.b);
  }

  public void clear(Pair p) {
    clear(p.a, p.b);
  }

  public void set(int a, int b) {
    if (a < 0 || b < 0 || a == b) { throw new IllegalArgumentException(
        "add(" + a + "," + b + ")"); }
    if (a > b) {
      set(a * (a - 1) / 2 + b);
    } else {
      set(b * (b - 1) / 2 + a);
    }
  }

  public void clear(int a, int b) {
    if (a < 0 || b < 0 || a == b) { throw new IllegalArgumentException(
        "add(" + a + "," + b + ")"); }
    if (a > b) {
      clear(a * (a - 1) / 2 + b);
    } else {
      clear(b * (b - 1) / 2 + a);
    }
  }

  public Iterator<Pair> iterator() {
    return new Iterator<Pair>() {
      int at       = -1;
      int triangle = 0;
      int a        = 0;

      public boolean hasNext() {
        return nextSetBit(at + 1) != -1;
      }

      public Pair next() {
        int nextat = nextSetBit(at + 1);
        if (nextat == -1) { throw new NoSuchElementException(); }
        at = nextat;
        while (triangle <= at) {
          triangle += a++;
        }
        return new Pair(a - 1, at - (triangle - a) - 1);

      }

      public void remove() {
        throw new UnsupportedOperationException();
      }
    };
  }
} 
```

这将很好地跟踪您的潜在碰撞。然后伪代码是

```
SW = width of rectangle
SH = height of rectangle
R = radius of balls + 1 // +1 is a fudge factor.

XS = number of squares across = SW/R + 4; // the +4 adds some slop
YS = number of squares hight = SH/R + 4; // the +4 adds some slop

int sx(Point2D.Float p) // the square into which you put a ball at x
   // never returns a number < 1
 := (int)((p.x-R/2)/R) + 2;

int sy(Point2D.Float p) // the square into which you put a ball at y
   // never returns a number < 1
 := (int)((p.y-R/2)/R) + 2;

Bitset[] buckets = new BitSet[XS*YS];
{for(int i: 0; i<buckets.length; i++) bukets[i] = new BitSet();}

BitSet bucket(int x, int y) {return bucket[y*XS + x]}
BitSet bucket(Point2D.Float p) {return bucket(sy(p),sx(p));}

void move(int ball, Point2D.Float from, Point2D.Float to) {
  if bucket(from) == bucket(to) return;
  int x,y;
  x = sx(from); y=sy(from);
  for(int xx==-1;xx<=1; xx++)
  for(int yy==-1;yy<=1; yy++)
  bucket(sx+xx, sy+yy).clear(ball);
  x = sx(to); y=sy(to);
  for(int xx==-1;xx<=1; xx++)
  for(int yy==-1;yy<=1; yy++)
  bucket(sx+xx, sy+yy).set(ball);
} 

PointSet findCollisions() {
    PointSet pp = new PointSet();
    for(BitSet bb: buckets) {
    int a;
    int prev_a;
    for(prev_a = -1; (a = bb.nextSetBit(prev_a+1))!=-1; prev_a=a) {
      int b;
      int prev_b;
      for(prev_b = a; (b = bb.nextSetBit(prev_b+1))!=-1; prev_b=b) {
        pp.add(a,b);
      }
    }
    return pp;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-24T01:10:59.837

也许问题在于，当球“堆积”起来时，相互作用太多了？如果我这样做，我会尝试以下方法：

*   将重力设置为 0，这样就不会同时发生许多碰撞
*   分析您的碰撞检测算法 - 如果您使用排序的球阵列并且只分析最近的 6 或 7 个，那么您应该没有任何问题......假设 800 个球，每个周期只有 8000 次左右的碰撞检查，这不是很多

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-24T00:58:55.733

我认为是时候测量性能来验证瓶颈到底在哪里了。您不需要提前进行测量，因为存在明显的算法问题。现在还有改进算法的空间，但你确定这是最大的问题吗？衡量你现在每个球做了多少比较。是小东西吗？如果是这样，那么算法更改可能不是最好的下一步。

比较确定每个球的位置所需的时间与实际绘制它们所需的时间。可能是后者现在是瓶颈，您应该将精力集中在渲染代码而不是物理引擎上。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-20T21:04:34.353

I've done something very much like this on the iPhone, and it uses the accelerometer to allow you to tilt the balls around, and the touch screen to add and delete balls. It can handle at least 30 balls before it starts to bog down noticeably.

One optimization I did early on is to inline the math. Originally I had a separate "vector" class, and it could only handle 10-12 balls before it turned into a slide show. Profiling showed it was spending a lot of time allocating and deallocating vectors.

Also, I don't separate the balls once they hit, I just bounce the vectors. They don't seem to ever overlap, and when they do it's pretty obvious that it's because they all got jammed together on the bottom.

I'm not quite ready to release the code yet, I've got some polishing to do, then I'll put it on the store.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-11T13:26:38.090

除非我错过了什么，否则重叠的球是错误的结果，而不是低效的代码。低效的代码只会导致动画运行缓慢。

我认为问题是由于球对球碰撞检测的迭代方法。目前，您似乎只考虑球与球碰撞的结果。当多个球接触一个球时，结果似乎是不确定的，并且发生这种情况的机会随着更大的重力或球的数量而增加。

# c# - C# Web 服务客户端：具有相同（复杂）返回类型的多个 Web 服务方法？

> ID：580042
> 
> 赞同：8
> 
> 时间：2009-02-24T00:44:19.933
> 
> 标签：c#, xsd, wsdl, wsdl.exe

目前，我正在为 Java B2B Web 服务构建客户端，我想我已经确定了我们已经有很长一段时间的问题的原因。不幸的是，我无法发布 WSDL。

显然，我的自动生成的代理代码（通过 wsdl.exe：由于 WCF 不支持密码摘要而必须使用 WSE 3.0）无法处理具有多个具有相同复杂返回类型的 Web 方法的 Web 服务的 WSDL。

举个例子 - 一个定义以下方法的网络服务：

```
Public ComplexTypeX Blah();
Public ComplexTypeX Blue();
Public ComplexTypeX Foo();
Public ComplexTypeY Bar(); 
```

在我的 Reference.cs 文件中，如果我注释掉所有调用 Blah()、Blue() 或 Foo() 中任意两个的代码，那么剩下的未注释的方法可以调用没有问题。但是，如果我有多个未注释掉的这三种方法中的一种（例如 Blah() 和 Foo()），那么在*实例化*Web 服务客户端代码时会收到以下错误消息：

> “方法Blah不能反映。” [“命名空间‘ http://some.url](http://some.url) ’中的 XML 元素‘ComplexTypeX’引用了一个方法和一个类型。使用 WebMethodAttribute 更改方法的消息名称或使用 XmlRootAttribute 更改类型的根元素。”

现在，绝对没有将`ComplexTypeX`方法定义为 Web 服务的一部分，所以我只能假设 .NET（或至少 wsdl.exe）不允许您使用返回复杂（用户定义）的 Web 服务跨多个方法的相同类型的类型......对吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-07-02T20:33:41.847

我遇到了类似的问题，这是我发现的：

我已经定义了一个复杂类型作为响应返回：

```
public class FooResponse {...}

[WebMethod]
public FooResponse Foo() {...} 
```

请注意，此处 Foo/Foo+Response 的确切名称配对很重要。当我如下更改方法名称时，问题就消失了：

```
public class FooResponse {...}

[WebMethod]
public FooResponse Fooxxx() {...} 
```

我认为正在发生的事情是 .NET 正在尝试使用名为 FooResponse 的元素自动包装来自 Foo 方法的响应。使用与要返回的对象相同的名称会产生歧义。尝试更改响应对象的名称或方法的名称以避免这种冲突。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-22T12:21:58.380

我刚刚搜索了“引用方法和类型”，发现了一个 Connect 错误报告“ [System.InvalidOperationException: The XML element * from namespace * references a references a method and a type](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=470482) ”。在这种情况下，存在具有完全相同名称（本地名称和命名空间）的操作和元素。

* * *

值得注意的是微软的部分回应：

> 我们不再对 ASMX 进行增强；我们继续支持其现有功能，但在可能的情况下，我们建议改用 WCF。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T19:22:38.283

我发现了另一个引发错误的案例！这是我的代码：

```
[WebMethod]
public CheckUpdateResponse CheckUpdate()
{
...
} 
```

好的，我解释一下：返回类型`CheckUpdateResponse`是结构，`CheckUpdate()`是方法。因此，在 WSDL .NET 中，**自动在其中一个 XML 元素中`Response`的方法名称中添加“”后缀来`CheckUpdate`**描述方法的返回值。

等等：它发现了一个重复的元素并给出错误*“使用 WebMethodAttribute 更改方法的消息名称......”*

**解决方案**？我将返回类型重命名为“CheckUpdateResult”，现在一切正常！

我希望这会对某人有所帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T01:02:47.267

> 所以我只能假设.NET（或至少 wsdl.exe）不允许您使用通过多种方法返回相同类型的复杂（用户定义）类型的 Web 服务......对吗？

这是不正确的。想象一下，如果它是真的，那将是多么痛苦——你只能有一个返回 String 的方法，一个返回 Double 的方法，一个返回 SomeObject 的方法，等等……这将是一场噩梦。

我对 .NET 中的 Web 服务不是很熟悉，但是从您收到的错误来看，您似乎遇到了 XML 命名空间的问题——可能存在名称冲突。我会尝试按照错误消息中的建议来修改`WebMethodAttribute`.

此外，如果您由于某些公司隐私/敏感性问题而无法发布与您遇到的问题相关的代码/文档，您应该发布仍能证明您的测试用例的净化版本。几乎任何“敏感”的东西都应该能够归结为更简单的代码片段，它仍然可以理解你的观点，而不会背叛任何敏感性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T05:53:10.487

很奇怪。通常，WSDL 会提供一个通用类型，当通过 wsdl.exe 或 svcutil.exe 编译时，您将获得一个共享的通用类型，以便在同一接口中的任意数量的方法中使用。

在同一个应用程序中引用多个*独立*的 WSDL 时会出现问题，这些 WSDL 共享一个表面上相同的类型，这会导致生成两个不同的 CLR 类型。有很多方法可以解决这个问题——这是众所周知的。然后是一些相关的问题，即将现有业务对象映射到从 WSDL 生成的类型。另一个以前探索过的景观。

但是你说的是不同的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-22T13:18:59.743

**使用 WSDL.exe 有一个开关 /sharetypes**。这应该解决这个问题。

此外，我不同意这是微软的事情，因为相同的类被暴露为位于多个 wsdl 中的不同复杂类型。那不是一个好的抽象设计。

*共享类型的现成参考 Microsoft 文档* 打开类型共享功能。此功能为不同服务之间共享的相同类型创建一个具有单一类型定义的代码文件（命名空间、名称和线路签名必须相同）。使用 http:// URL 作为命令行参数引用服务或为本地文件创建一个 discomap 文档。

# regex - 我必须如何为 Perl 的拆分声明正则表达式？

> ID：580050
> 
> 赞同：3
> 
> 时间：2009-02-24T00:48:39.390
> 
> 标签：regex, perl, split

我今天遇到了这个 Perl 结构：

```
@foo = split("\n", $bar); 
```

这适用于将大字符串拆分为 UNIX 类型行结尾的行数组，但在 Windows 中留下尾随 \r。所以我把它改成：

```
@foo = split("\r?\n", $bar); 
```

它按行拆分字符串并且不留下尾随的 \r （在 ActivePerl 5.8 下测试）。然后有人向我指出，这可能应该是：

```
@foo = split(/\r?\n/, $bar); 
```

那么为什么第二个变体完全有效呢？双引号表示对内容进行评估，这就是为什么 \r 和 \n 实际上被视为 CR 和 LF，但 ? 被视为正则表达式元字符而不是文字问号。

正则表达式周围的斜线对于 split() 是可选的吗？是否只是假设函数的第一个参数是正则表达式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T00:59:56.307

斜线只是正则表达式的标准分隔符（您可以使用其他分隔符），它们像双引号一样评估特殊字符和转义序列。

*编辑*：我拍得太快了，正如 Manni 在评论中解释的那样。我会尝试更长的解释：

通常，在 Perl 中匹配的正则表达式以 m 开头，然后将正则表达式主体包含在某个分隔符中。`m`匹配正则表达式的标准分隔符是斜杠，如果使用斜杠作为分隔符，则可以省略前导：

```
m/\r?\n/
m"\r?\n"
m$\r?\n$
/\r?\n/ 
```

这些都做同样的事情，它们被称为“正则表达式文字”。如果您使用单引号，则不会评估转义序列。

在这一点上，您第一次尝试使用双引号但没有前导的正则表达式似乎很奇怪`m`，但是，正如[Arnshea](https://stackoverflow.com/questions/580050/how-must-i-declare-regex-for-perls-split/580323#580323)解释的那样，`split`这是一种特殊情况，因为它不仅接受正则表达式作为文字，而且也作为字符串。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T03:09:47.930

您可以将正则表达式拆分为字符串或正则表达式文字。所以将它作为双引号字符串传递就可以了。

您还可以使用标准 /regex/ 以外的字符分隔正则表达式文字

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T05:14:26.647

是的， split 总是采用正则表达式（包含单个空格特殊情况的字符串除外）。如果你给它一个字符串，它将被用作一个正则表达式。=~ 也会发生同样的事情（例如 $foo =~ "pattern"）。并且无论使用//，正则表达式元字符都将被视为这样。

这就是为什么总是使用 // 是个好主意，以强调它有时不是文字字符串或有时不是正则表达式，因此您不会意外尝试 split("|", "a|b|c")有一天。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T18:29:39.530

## 让我们看看几个备选方案的基准。

```
use Modern::Perl;
use Benchmark qw'cmpthese';

# set up some test data
my $bar = join "\n", 'a'..'z';

my $qr  = qr/\r?\n/;
my $str =   "\r?\n";
my $qq  = qq/\r?\n/;

my %test = (
  '   //' =>   sub{ split(   /\r?\n/, $bar ); },
  '  m//' =>   sub{ split(  m/\r?\n/, $bar ); },
  '  m""' =>   sub{ split(  m"\r?\n", $bar ); },
  ' qr//' =>   sub{ split( qr/\r?\n/, $bar ); },
  ' qq//' =>   sub{ split( qq/\r?\n/, $bar ); },
  '   ""' =>   sub{ split(   "\r?\n", $bar ); },
  '$qr  ' =>   sub{ split( $qr,  $bar ); },
  '$str ' =>   sub{ split( $str, $bar ); },
  '$qq  ' =>   sub{ split( $qq,  $bar ); }
);

cmpthese( -5, \%test, 'auto'); 
```

```
基准：运行    
    "", //, m"", m//, qq//, qr//, $qq , $qr , $str  
    至少 5 个 CPU 秒...

      "": 6 挂钟秒 (5.21 usr + 0.02 sys = 5.23 CPU) @ 42325.81/s (n=221364)
      //: 6 挂钟秒 (5.26 usr + 0.00 sys = 5.26 CPU) @ 42626.24/s (n=224214)
     m"": 6 挂钟秒 (5.30 usr + 0.01 sys = 5.31 CPU) @ 42519.96/s (n=225781)
     m//: 6 挂钟秒 (5.20 usr + 0.00 sys = 5.20 CPU) @ 42568.08/s (n=221354)
    qq//: 6 挂钟秒 (5.24 usr + 0.01 sys = 5.25 CPU) @ 42707.43/s (n=224214)
    qr //: 6 挂钟秒 (5.11 usr + 0.03 sys = 5.14 CPU) @ 33277.04/s (n=171044)
   $qq : 5 挂钟秒 (5.15 usr + 0.00 sys = 5.15 CPU) @ 42154.76/s (n=217097)
   $qr : 4 挂钟秒 (5.28 usr + 0.00 sys = 5.28 CPU) @ 39593.94/s (n=209056)
   $str : 6 挂钟秒 (5.29 usr + 0.00 sys = 5.29 CPU) @ 41843.86/s (n=221354)

         评分 qr// $qr $str $qq "" m"" m// // qq//
 qr// 33277/s -- -16% -20% -21% -21% -22% -22% -22% -22%
$qr 39594/s 19% -- -5% -6% -6% -7% -7% -7% -7%
$str 41844/s 26% 6% -- -1% -1% -2% -2% -2% -2%
$qq 42155/s 27% 6% 1% -- -0% -1% -1% -1% -1%
   "" 42326/s 27% 7% 1% 0% -- -0% -1% -1% -1%
  m"" 42520/s 28% 7% 2% 1% 0% -- -0% -0% -0%
  m// 42568/s 28% 8% 2% 1% 1% 0% -- -0% -0%
   // 42626/s 28% 8% 2% 1% 1% 0% 0% -- -0%
 qq// 42707/s 28% 8% 2% 1% 1% 0% 0% 0% --

```

值得注意的是，这些速度基本相同，但`qr//`显示速度稍慢。在多次运行此测试后，`qr//`始终`$qr`是最慢的，也是第二慢的。与其他人定期交换位置。

### 所以基本上你如何设置正则表达式并不重要  [`split()`](http://perldoc.perl.org/functions/split.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-15T19:02:44.330

`split("\r?\n", $bar)`完全是错误的：`split`内置函数需要一个指定为模式的正则表达式。只需阅读[perl 手册以](http://perldoc.perl.org/functions/split.html)使用`perldoc -f split`.

所以只使用`split(/\r?\n/, $bar)`.

# c# - 在 WebBrowser 控件中设置 TextArea 的值 (C# / .NET)

> ID：580052
> 
> 赞同：2
> 
> 时间：2009-02-24T00:49:03.243
> 
> 标签：c#, .net, html, webbrowser-control

我正在寻找使用 .NET WebBrowser 控件设置 TextArea 的值。

我已经能够使用以下代码设置文本框的值（将“用户名”替换为 texbox 的名称）：

```
webBrowser1.Document.All.GetElementsByName("username")[0].SetAttribute("Value", "SomeUser"); 
```

我尝试在 TextArea 上使用类似的代码（使用 GetElementById），但忘记了 TextArea 输入类型不包含“Value”属性。我也尝试设置 TextArea 的 InnerHtml 和 InnerText，但编译器在尝试设置 TextArea 输入的值时继续抛出空引用异常错误或索引越界错误。

有谁知道如何使用 WebBrowser 控件在 TextArea 中设置文本？任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T01:18:59.023

假设您有以下 HTML：

```
<html>
<body>
   <textarea id='foo'>Testing</textarea>
</body>
</html> 
```

您可以像这样设置文本`textarea`：

```
HtmlElement textArea = webBrowser1.Document.All["foo"];
if (textArea != null)
{
    textArea.InnerText = "This is a test";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T14:48:33.653

有几点以防万一您还没有意识到这些：

*   **GetElementById**只会返回单个项目或 null，它不是一个集合。
*   **如果您尝试将 WebBrowser 控件的一个实例中的元素插入到 WebBrowser 控件的另一个实例的元素中，则会引发 **index out of bounds 错误。****
***   **GetElementBy..**可以直接从**WebBrowser.Document**属性运行，因此无需访问**All[]**集合。**

 **# c++ - 什么时候应该使用对象向量而不是指针向量？

> ID：580053
> 
> 赞同：13
> 
> 时间：2009-02-24T00:49:42.510
> 
> 标签：c++

我有一组多态对象，它们都派生自我的 Animal 类：Cat、Dog 和 MonkeyFish。

我通常的操作模式是将这些对象存储在 Animal 指针向量中，如下所示：

std::vector< 动物 * > my_vector;

```
my_vector.push_back(new Animal_Cat());
my_vector.push_back(new Animal_Dog());
my_vector.push_back(new Animal_MonkeyFish());

```

生活很美好……或者是吗？

最近有人告诉我，我真的应该尽量避免以这种方式分配内存，因为它使内存管理成为一件苦差事。当我需要销毁 my_vector 时，我必须遍历所有元素并**删除**所有内容。

我不认为我可以存储引用向量（我可能对此错了），所以似乎存储 Animal 对象的向量是我唯一的选择。

我什么时候应该选择使用指针向量而不是对象向量？一般来说，哪种方法更可取？（我想尽可能减少对象复制。）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-24T01:01:32.903

您应该尽可能使用对象向量；[但在你的情况下这是不可能的](https://stackoverflow.com/questions/274626/what-is-the-slicing-problem-in-c)。

指针容器可以让您避免切片问题。但是你必须在每个元素上调用 delete ，就像你正在做的那样。这很烦人，但有可能。不幸的是，在某些情况下（抛出异常时），您无法确定正确调用了 delete，最终导致内存泄漏。

主要的解决方案是使用智能指针。Pre-C++11 自带`auto_ptr`，[但不能在标准容器中使用](http://www.gotw.ca/publications/using_auto_ptr_effectively.htm)。C++11 具有`std::unique_ptr`并且`std::shared_ptr`被设计为可在容器中使用（`std::unique_ptr`除非我真的需要引用计数，否则我更喜欢）。如果不能使用 C++11，最好的解决方案是[Boost smart pointers](http://www.boost.org/libs/smart_ptr)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-24T00:55:22.620

在这种情况下，存储向量`Animal`对您不起作用，因为您的动物具有不同的大小，并且您将无法将派生对象存储在用于保存基类的空间中。（即使它们的大小相同，您也不会获得预期的多态效果，因为将执行基类方法 - 除非您通过指针或引用访问方法，否则方法的虚拟性不会发挥作用。 )

如果您想避免自己管理内存的烦恼，您可以考虑存储一个智能指针，例如[shared_ptr](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/shared_ptr.htm)（请注意，根据 Max Lybbert 的说法， [auto_ptr](http://en.wikipedia.org/wiki/Auto_ptr)不适用于 STL 容器）或其一些变体。这样你仍然可以使用你的多态类，但是对你来说工作量少了一点。

关于何时使用对象和指针并没有真正的硬性规定，尽管值得注意的是，在某些情况下，比如您的情况，对象对您不起作用。我倾向于在没有任何限制的情况下使用对象，尽管您确实必须注意昂贵的复制操作（尽管有时可以通过引用传递容器来改善它们）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-24T04:34:10.863

与其将 shared_ptr 与标准 STL 容器一起使用，不如查看[Boost Pointer Container Library](http://www.boost.org/doc/libs/1_38_0/libs/ptr_container/doc/ptr_container.html)。它旨在解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T08:59:38.400

如果您曾经听到过这个论点，但是当您想使用完整对象而不是向量中的指针时，*一直复制它们的结构会非常昂贵，那么您的两个主要论点是：*

1.  我们不需要担心指针的生命周期问题，这意味着**该**特定代码不会泄漏（当然，除非结构本身具有指针数据，但这是另一回事）。
2.  内存中相邻结构的数据局部性将提高典型使用场景中的性能，而不是像指针间接（相对而言）那样减慢速度。

复制的额外成本通常是在向容器中添加内容时产生的，而不是在使用数据时产生的——想想看：你最常做什么？添加项目或使用它们？

但是，当添加多态对象时，指针对于避免切片是必要的。

# .net - 销售点机器软件开发

> ID：580068
> 
> 赞同：4
> 
> 时间：2009-02-24T00:54:48.427
> 
> 标签：.net, point-of-sale

我想为它创建一个销售点 (POS) 机器和软件。是否有任何操作指南？

### 硬件

我知道在哪里可以找到硬件，但我只是想知道是否有任何硬件品牌特别允许定制，例如为机器使用 .NET 的 API（收银台、打印机等）。

### 软件

我对软件的问题是：如何操作打印机？我怎样才能操纵现金到账？我知道这些问题非常模糊，但我正在寻找任何资源的链接。

### 编辑

需要明确的是：我正在寻找一个 .NET API 来帮助我解决这个问题。如果一个不可用，有人可以指出我可以在.NET 中使用哪些现金抽屉和收据打印机。类似于`JavaPOS`.NET 的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T01:48:31.167

查看[JavaPOS](http://www.javapos.com/docs.html)标准。不久前我研究过这些东西（对于一家相当大的公司，名字押韵与寓言:)）并使用 Hypercom 信用卡/借记卡刷卡器（也用于向用户显示收据、捕获签名并充当密码键盘)、IBM 现金抽屉、面向零售市场的小型供应商提供的通用 IBM 兼容 PC（但任何人都可以）、IBM 热敏打印机和[键盘垫片条码扫描仪](http://www.motorola.com/business/v/index.jsp?vgnextoid=e37575489c075110VgnVCM1000008406b00aRCRD)。

所有这些东西都是通过符合 JavaPOS 的驱动程序连接的，对我来说处理起来没什么大不了的，当时我几乎没有控制硬件的经验。

[打印机](http://www.visionpos.com/feat-pos-products-32-IBM4610.html)的接口非常容易，并且可以输入字符串，或者您可以将位图加载到它的内存中以使其打印出来（用于商店徽标）。

[Hypercom pin pad/签名捕获](http://www.hypercom.com/products/l4150.asp)可能是最难管理的问题，固件有缺陷，需要许多解决方法。

钱箱[只有](http://www-03.ibm.com/products/retail/products/peripherals/cashdrawers/)两个命令：一个是弹出它，另一个是查看它是否打开。

更棘手的部分不是与硬件接口，而是确保[PCI 合规性](https://www.pcisecuritystandards.org/)和处理 cc 处理器后端。此外，通常您需要与某种第三方[库存](http://www.sap.com/usa/index.epx)/[销售管理](http://quickbooks.intuit.com/)包集成。

编辑：

对于 .NET，标准看起来是[.NET 的 POS](http://msdn.microsoft.com/en-us/library/ms828083.aspx)。我无法评论对此的设备支持。还有 OPOS，它们是一些 ActiveX 控件（可从 .NET 轻松访问），声称实现与 JavaPOS 相同的底层标准。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T01:04:26.500

爱普生生产很多[热敏收据打印机](http://pos.epson.com/developers/index.htm)，大多数品牌都有爱普生兼容设置。您应该从那里开始，并对其进行封装，以便您可以轻松添加其他打印机控制代码。

通常，您希望在 Windows 中使用通用文本打印机 - 如果您使用 Windows 驱动程序，您可能最终会一直打印图形 - 即使是简单的文本 - 这对于零售结账来说速度慢得让人无法接受。您将直接将打印机代码发送到打印机，这并不难，但您会花一些时间来使用它。

收银台通常由打印机（通过电缆和特殊命令）或串行端口上的特殊命令控制。您需要封装它，因为有很多直到类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T01:50:27.243

查看 .NET 的 POS。它符合 UPOS 标准并支持本机 .NET 服务对象（驱动程序）和旧版 OPOS 服务对象。

.NET 的 POS 可免费下载。确保您获得最新版本 (1.12)。您需要从给定设备的设备供应商处下载服务对象。使用它的一个优点是，无论您使用哪个设备供应商（Epson、Star、MagTek、HHP、Symbol 等），您的程序与设备的接口都是相同的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T01:20:38.627

我相信有一个现有的用 Java 编写的开源 POS 系统，叫做 openbravo，它可以节省你自己编写软件的工作。

# lisp - ECL 如何在可执行文件中包含 ASDF 依赖项？

> ID：580083
> 
> 赞同：4
> 
> 时间：2009-02-24T01:02:45.207
> 
> 标签：lisp, common-lisp, asdf, ecl

我有这个 ecl-make.lisp：

```
(asdf:oos 'asdf:compile-op :stumpwm)

（defun系统对象（系统）
  （循环中的组件（asdf：module-components（asdf：find-system system））
    for pathname = (asdf:component-pathname 组件)
    for directory = (路径名-目录路径名)
    for name = (pathname-name pathname)
    when (equal "lisp" (pathname-type pathname))
    收集（make-pathname :directory directory :type "o" :name name)))

（c：构建程序“stumpwm”：lisp文件
  （连接'列表
    （系统对象：cl-ppcre）
    （系统对象：clx）
    (mapcar (lambda (组件))
              （连接'字符串组件“.o”））
      stumpwm-system::*组件*))
  :epilogue-code '(unwind-protect (stumpwm:stumpwm) (ext:quit)))

```

（`stumpwm-system::*components*`是我对 的补充`stumpwm.asd`，用于在该文件中生成 ASDF 组件以及上面正确排序的文件列表。）

它只是失败了：

```
...您在 (system-objects ...) 时收到的相同消息
...从 c:build-program 中排除 [它在
...这种情况，但当然 CL-PPCRE 和 CLX 不可用。]
初始化时出错：
找不到二进制文件的入口点。

```

我已经到了只解决以前尝试引入的错误的地步。如果您使用 ECL 构建了一个包含依赖项的程序，请告诉我您是如何做到的。我看到了如何在启动时`stumpwm`启动和加载依赖项（即使没有加载 my `~/.eclrc`，它会告诉 ASDF 在哪里找到这些依赖项）。但这*应该*是可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T02:19:52.060

哦，哇。 [这是答案](http://article.gmane.org/gmane.lisp.ecl.general/1558)：

1.  删除`ecl-make.lisp`，还原更改为`stumpwm.asd`

2.  `ecl -eval '(asdf:make-build :stumpwm :type :program)'`

就是这样。[但是，ASDF 没有看到`asdf:build-op`。]

编辑：嗯，它还需要一个序幕。[ecl-examples](http://github.com/ayrnieu/ecl-examples/tree/master)现在展示`asdf:make-build`

# java - 是否可以在运行时从 Java 设置环境变量？

> ID：580085
> 
> 赞同：51
> 
> 时间：2009-02-24T01:02:49.297
> 
> 标签：java, environment-variables

是否可以在运行时从 Java 应用程序设置环境变量？在 Java 1.5 java.lang.System 类中有 getenv() 方法，我只需要一个 setenv() 方法...

是否可以修改java进程本身的环境变量；不在子进程中。

是否可以通过JNI来实现？那将如何运作？

谢谢。

编辑：好的，让我这样说 - 我们可以用 Java 做以下事情吗？请回答。

1.  我们可以修改当前进程的环境吗？
2.  我们可以修改父进程的环境吗？
3.  我们可以修改子进程的环境吗？

Hemal Pandya 回答说：“您可以修改当前和子进程的环境，但不能修改生成该进程的父进程的环境。” 你同意吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-24T01:10:49.183

**如果我的直觉是正确**的，并且您实际上想要修改环境以使生成的（分叉的）子进程 ( `Runtime.getRuntime().exec()`) 受益，那么请使用[ProcessBuilder](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html)而不是`exec()`. 您可以通过`ProcessBuilder`实例的[environment()](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html#environment())方法构建自定义环境。

如果这*不是*您要达到的目标，请忽略此答案。

* * *

**更新**

您的三个更新的具体问题的答案如下：

1.  我们可以修改当前进程的环境吗？
    *   **不容易**。取决于您是要更改进程的环境，还是要更改`System.getenv()`同一 JVM 中返回的值，还是两者兼而有之。
    *   正如 Greg Hewgill 指出的那样，要更改当前进程的环境，您可以`setenv`通过 JNI 调用或其特定于平台的等效项。您也可以使用下面*第 2 点*中极其复杂的方法，该方法适用于任何进程（前提是您具有权限。）但是，请注意，在大多数 JVM 中，这种更改可能永远不会反映在返回的值中`System.getenv()`，因为环境是通常在虚拟机启动时缓存在一个`java.util.Map`（或等效的）中。
    *   要更改环境的 JVM 缓存副本，当使用缓存时（请参阅`System.java`您将用于部署的任何 JVM 发行版中的源代码），您可以尝试破解实现（通过类加载顺序、[反射](http://java.sun.com/developer/technicalArticles/ALT/Reflection/index.html)或[检测](http://java.sun.com/javase/6/docs/api/java/lang/instrument/Instrumentation.html)。 ) 以 SUN 的 v1.6 JVM 为例，环境缓存由未记录的`ProcessEnvironment`类管理（您可以对其进行修补。）
2.  我们可以修改父进程的环境吗？
    *   **非常困难，而且非常不便携**。如果您绝对必须这样做，您可以使用一些非常具体的技巧：
        *   Windows：[动态添加/编辑远程进程的环境变量](http://www.codeproject.com/KB/threads/DynEnvVar.aspx)
        *   *nix:[有没有办法改变另一个进程的环境变量？](https://stackoverflow.com/questions/205064/is-there-a-way-to-change-another-processs-environment-variables)- 这是一个性能杀手，因为任何被检测的进程`gdb`都将暂停非零时间。
3.  我们可以修改子进程的环境吗？
    *   **是**的，通过`ProcessBuilder`时产生进程。
    *   如果在需要更改环境时进程已经生成，则需要上面的*方法 2*（或一些同样复杂的方法，例如生成时的代码注入，由父进程通过例​​如套接字进行隐蔽控制。）

请注意，上述所有方法，除了涉及 的方法外`ProcessBuilder`，都很脆弱，容易出错，在不同程度上不可移植，并且在多线程环境中容易出现竞争条件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-09-26T22:43:50.010

您可以掌握`java.lang.ProcessEnvironment`所保留的底层地图的句柄，然后添加新内容并删除您想要的所有内容。

这适用于 java 1.8.0_144。不能保证它适用于任何其他版本的 java，但如果您确实需要在运行时更改环境，它可能是相似的。

```
private static Map<String,String> getModifiableEnvironment() throws Exception{
    Class pe = Class.forName("java.lang.ProcessEnvironment");
    Method getenv = pe.getDeclaredMethod("getenv");
    getenv.setAccessible(true);
    Object unmodifiableEnvironment = getenv.invoke(null);
    Class map = Class.forName("java.util.Collections$UnmodifiableMap");
    Field m = map.getDeclaredField("m");
    m.setAccessible(true);
    return (Map) m.get(unmodifiableEnvironment);
} 
```

在您获得对地图的引用后，只需添加您想要的任何内容，您现在就可以使用常规的旧`System.getenv("")`调用来检索它。

我试过了，它在 MAC 中的工作在两个操作系统 java 版本 1.8_161 中都不能在 Windows 中工作

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-24T20:50:35.277

针对您更新的问题：

1.  我们可以修改当前进程的环境吗？
    **是**的，如果你使用 JNI 来调用`setenv()`什么的。不过，您可能不需要这样做，而且它可能不适用于所有情况。
2.  我们可以修改父进程的环境吗？
    **没有**。
3.  我们可以修改子进程的环境吗？
    **是**的，使用`ProcessBuilder`.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-07-08T19:10:18.180

@Snowbuilder 的回答让我走上了正轨，但它神秘地不适用于 Oracle JDK 1.8.0_231（他使用次要版本 _144 进行了测试）。即使我能够更新底层 Map（通过`System.getenv()`在向 Map 添加新属性之前和之后打印出来进行验证），当使用`System.getenv("property")`.

经过一番调查，我发现这是因为`System.getenv()`最终`System.getenv("property")`使用了不同的静态属性`java.lang.ProcessEnvironment`，这些属性在类`static`块中初始化。因此，是否将新属性添加到使用`System.getenv()`;检索的 Map 并不重要。这些属性在 使用的其他地图中将不可用`System.getenv("property")`。

所以我改变了其他答案的代码来处理这种情况，并来到下面的代码。请注意，这仅在您使用`System.getenv("property")`;检索属性时才有效。如果您使用`System.getenv().get("property")`，那么他的答案就是您所需要的。用法如下：

```
@SuppressWarnings("unchecked")
private static Map<String, String> getModifiableEnvironment() throws Exception
{
    Class<?> pe = Class.forName("java.lang.ProcessEnvironment");
    Method getenv = pe.getDeclaredMethod("getenv", String.class);
    getenv.setAccessible(true);
    Field props = pe.getDeclaredField("theCaseInsensitiveEnvironment");
    props.setAccessible(true);
    return (Map<String, String>) props.get(null);
} 
```

此方法应按如下方式使用：

```
getModifiableEnvironment().put("propName", "propValue");
System.getenv("propName"); // this will return "propValue" 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-24T01:05:31.973

我不这么认为，至少不是纯粹在 Java 中，但你为什么需要这样做呢？在 Java 中，最好通过 使用属性`System.getProperties()`，您可以对其进行修改。

如果你真的必须这样做，我相信你可以将 C`setenv`函数包装在 JNI 调用中——事实上，如果有人已经这样做了，我不会感到惊讶。不过，我不知道代码的详细信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T01:47:50.437

您可以修改当前和子进程的环境，但不能修改生成此进程的父进程的环境。

# php - 如何知道 jquery $.get ajax 调用何时完成？

> ID：580099
> 
> 赞同：0
> 
> 时间：2009-02-24T01:11:46.573
> 
> 标签：php, jquery, mysql, ajax, get

我有一个 php / mysql / jquery Web 应用程序，它对各种 API 进行 13 个 ajax 查询并将结果存储在数据库表中。我为每个结果分配一个分数，当所有结果完成后，我想显示一个“总分”。

我的问题是知道所有 ajax 查询何时完成并且所有结果都已准备好进行统计。

这是现有的工作流程：

1.  用户在查询框中输入数据并点击提交。
2.  页面重新加载并将“扫描 ID”插入到“扫描索引”表中。
3.  然后页面为 13 个查询中的每一个执行一个 jquery $.get 函数（所有查询都使用相同的 javascript 函数来执行它们的工作）。
4.  在返回每个结果时，使用先前插入的“扫描 ID”将结果插入到“扫描”表中，以允许与正确的扫描相关联。结果也会连同该结果的分数一起显示给用户。

在这一点上，我要做的是使用 scan_id 值检索扫描表中的所有结果，并将分数加起来并显示给用户。

但我的问题是知道何时开始查询以检索所有总数。任何给定的查询在完成（或失败）之前最多可能需要 10 秒（我的预定义超时值），但它们通常最多只需要大约 3 秒即可完成。

那么，在不知道查询何时完成的情况下，我如何知道所有查询何时完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T02:03:34.470

听起来您缺少的关键信息是 $.get 的回调功能。您可以指定一个函数作为请求完成时将触发的第二个或第三个参数

```
$.get('http://example.com/data', {'foo':'bar'}, function(resonseData){
    //code here will be called when the ajax call has completed
}) 
```

因此，您需要在某处设置一个计数器变量，每次发出的请求都会将其加一，然后在回调中将此值减一。

然后，在您发出最终的 get 请求后，使用 setInterval 设置一个观察程序，该观察程序将定期（例如每秒一次）检查计数器是否为零。如果是，则您已完成所有请求。您可能可以将此检查添加到 $.get 回调本身，但这似乎很容易受到时间问题的影响。

这是基本的解决方案，但这可以很容易地抽象成一个更健壮/优雅的排队解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T02:04:04.547

这是另一种选择。代码可能需要调整，我实际上并没有测试它，但这是一个开始。

```
var complete = 0;

function submitRequests () {
    $.get("http://server/query1", {"data": "for Query"}, processResult(1));
    $.get("http://server/query2", {"data": "for Query"}, processResult(2));
    //...
    $.get("http://server/query13", {"data": "for Query"}, processResult(13));
}

function processResults (query) {
    complete += Math.pow(2,(query-1));
    if (complete == 8191) {
        $.get("http://server/results", scanid, function() {
            //Show results
        })
    } 
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-04T18:47:33.630

使用 jquery ajaxStop() 方法

```
 $(document).ajaxStart(function () {
            //first ajax call started
        });

        $(document).ajaxStop(function () {
            //last ajax call stopped
        }); 
```

# algorithm - 简单游戏算法的链接

> ID：580103
> 
> 赞同：6
> 
> 时间：2009-02-24T01:14:48.550
> 
> 标签：algorithm, open-source

我正在阅读[那个问题](https://stackoverflow.com/questions/505435/what-fun-games-have-simple-source-code-available)，我记得[Wikipedia 的算法列表](http://en.wikipedia.org/wiki/List_of_algorithms)。我知道维基百科也有一个开源游戏列表，但我想要的是一个简单游戏算法的链接，即使是用伪代码编写的。

作为“简单”游戏，我的意思是数独、宝石迷阵、纸牌、扫雷、迷宫、蛇、大猩猩、国际象棋、俄罗斯方块等游戏。

C# 源代码的奖励 :)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T01:50:41.270

大多数游戏算法都是简单的搜索算法。事实上，你可以说人工智能*就是*搜索。

对于数独来说，[跳舞链接](http://en.wikipedia.org/wiki/Dancing_Links)是一个很好的算法。或者，它[在 Prolog 中非常简洁地](http://chneukirchen.org/blog/archive/2005/11/a-sudoku-solver-in-prolog.html)解决了。

对于国际象棋，从[Minimax](http://en.wikipedia.org/wiki/Minimax#Minimax_algorithm_with_alternate_moves)开始，然后尝试[使用 alpha-beta pruning 的](http://en.wikipedia.org/wiki/Alpha-beta_pruning)Minimax 。

[Minesweeper 是 NP 完全的](http://for.mat.bham.ac.uk/R.W.Kaye/minesw/ordmsw.htm)。没有任何已知的可靠*和*快速的算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T10:28:07.480

正如其他人所暗示的那样，游戏“算法”的想法并不真正适合，除了一些微不足道的东西，而不是特别像游戏的东西，比如生活。算法是一种以已知方式处理一组数据以产生该数据的特定输出的方法，通常在某种时间/复杂度范围内。游戏不符合那个简单的标准——它们更像是模拟，根据输入反复改变对象的状态，直到达到特定于游戏的条件。因此，它们几乎都遵循 input->update->display 循环，在更新阶段使用定制的游戏逻辑。毫无疑问，游戏的各个部分将根据简单而知名的算法来实现，但游戏程序本身实际上只是模拟循环和其中的逻辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T01:30:09.447

没有[比康威的生命游戏](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)更简单的了。只有四个规则：

1.  任何少于两个活邻居的活细胞都会死亡，就好像人口不足引起的需求一样。
2.  任何有超过三个活邻居的活细胞都会死亡，就好像过度拥挤一样。
3.  任何有两个或三个活邻居的活细胞都不会改变，直到下一代。
4.  任何只有三个活邻居的死细胞都会成为活细胞。

它可以用任何语言轻松实现，需要[零玩家](http://en.wikipedia.org/wiki/Zero-player_game)，并产生一些有趣的模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-06T04:18:48.857

算法呢，不是为了玩游戏，而是为了其中相对复杂的任务。例如，在 Bejeweled 中，您有一个 8x8 的网格，其中填充了 7 种颜色之一的珠宝。在任何时候，每种颜色大约有 8 颗宝石。用户移动宝石进行匹配后，至少有三颗宝石​​（颜色相同）会从屏幕上消失，另外三颗新宝石会落到屏幕上。您如何确保屏幕上始终至少有一个匹配项可用？您如何确保匹配项可能出现在屏幕周围，而不仅仅是在顶部？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T01:21:53.710

Event认为你上面提到的游戏很简单，我不认为那些游戏的算法不是。（真的没有冒犯:)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T01:33:52.747

这是大多数游戏的算法：

游戏初始化后...

1.  接受用户输入
2.  根据用户输入更新游戏状态
3.  提供视觉反馈（更新屏幕）
4.  检查分数变化并根据需要进行更新
5.  检查“游戏结束”，如果游戏尚未结束，则跳转到第 1 步
6.  嗯……就是这样。

希望这可以帮助。

# django - Django admin GUI 可以过滤文本字段是否为空白吗？

> ID：580105
> 
> 赞同：4
> 
> 时间：2009-02-24T01:16:07.937
> 
> 标签：django

我有一个包含文本字段的 Django 模型。在管理 GUI 中，我希望能够仅过滤那些在此字段中包含文本的记录。是否可以？

类似这样的代码将过滤文本字段的内容，但在“全部”和过滤器中的每个不同条目上显示过滤器。我想过滤“全部”或“包含某些内容”。

```
class MyModel(models.Model):
    # ...
    textfield = models.CharField(max_length=100)
    # ...

class MyModelAdmin(admin.ModelAdmin):
    list_display = ('...', 'textfield', '...')
    list_filter = ('...', 'textfield', '...') 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T12:25:22.883

是的，但没有记录。查看`django\contrib\admin\filterspecs.py`默认过滤器规范是如何创建的，以及如何创建自己的。此功能计划在 1.1 版本中使用，如果您想在最新的 HEAD 修订版上试用该功能，已经有一个补丁：http: [//code.djangoproject.com/ticket/5833](http://code.djangoproject.com/ticket/5833)

同样没有记录的是您可以在 change_list 页面的 URL 上放置任意 GET 参数以过滤结果。例如，`/admin/app/model/?field1__lte=5&field2__gte=10`不幸的是`?field__isnull=True`不起作用，但您可以轻松地进行实验，看看是否可以找到适合您的情况的过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T07:48:12.110

是的，您可以从 django 1.4 扩展 SimpleListFilter 并轻松地做到这一点。看：

请参阅：[https ://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-02-24T01:26:26.897

没有。见[http://docs.djangoproject.com/en/dev/ref/contrib/admin/#list-filter](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#list-filter)

> 设置 list_filter 以激活管理员更改列表页面右侧栏中的过滤器。这应该是一个字段名称列表，每个指定的字段应该是 BooleanField、CharField、DateField、DateTimeField、IntegerField 或 ForeignKey。

但...

两件事情。

1.  请务必为您的文本字段留空。

    类 MyModel(models.Model): # ... textfield = models.CharField(max_length=100,blank=True) # ...

2.  添加一个 is_blank 方法来帮助处理。它没有过滤，但它很有帮助。

    def is_blank(self): return len(self.textfield) == 0

# delphi - Delphi 泛型约束问题

> ID：580108
> 
> 赞同：2
> 
> 时间：2009-02-24T01:17:13.520
> 
> 标签：delphi, generics, delphi-2009

我正在尝试创建一个通用列表类以用于 tiOPF（delphi @ www.tiopf.com 的对象持久性框架）。具体来说，我正在尝试采用现有的通用类（TtiObjectList）并制作一个使用 TtiObject 后代的通用版本。

我更改基类的范围有限，因为它们需要在 D7 - D2009 和 Free Pascal 下编译。我需要从 TtiObjectList 降级以保持现有的持久性机制正常工作。

```
// base class  
type  
  TtiObjectList = class(TtiObject)
...  
protected  
  function GetItems(i: integer): TtiObject; virtual;  
  procedure SetItems(i: integer; const AValue: TtiObject); virtual;  
...  
public  
  function Add(const AObject : TtiObject): integer; overload; virtual;  
...  
end; 
```

我的班级定义如下：

```
TtiGenericObjectList<T: TtiObject> = class(TtiObjectList)  
protected  
  function GetItems(i:integer): T; reintroduce;  
  procedure SetItems(i:integer; const Value: T); reintroduce;  
public  
  function Add(const AObject: T): integer; reintroduce;  
  property Items[i:integer]: T read GetItems write SetItems; default;  
end;

implementation

{ TtiGenericObjectList<T> }

function TtiGenericObjectList<T>.Add(const AObject: T): integer;  
var obj: TtiObject;  
begin  
  obj:= TtiObject(AObject); /// Invalid typecast
  result:= inherited Add(obj);  
end;  

// alternate add, also fails  
function TtiGenericObjectList<T>.Add(const AObject: T): integer;  
begin  
  result:= inherited Add(AObject); /// **There is no overloaded version**
 /// **of 'Add' that can be called with these arguments**  
end;  

function TtiGenericObjectList<T>.GetItems(i: integer): T;  
begin  
  result:= T(inherited GetItems(i)); /// **Invalid typecast  **
end;  

procedure TtiGenericObjectList<T>.SetItems(i: integer; const Value: T);  
begin  
  inherited SetItems(i, Value);  
end; 
```

我遇到的问题是 delphi 没有将 T 视为 TtiObject 后代。当我执行以下操作时，我收到了无效的类型转换错误：

```
function TtiGenericObjectList<T>.Add(const AObject: T): integer;  
var obj: TtiObject;  
begin  
  obj:= TtiObject(AObject); /// **Invalid typecast***
  result:= inherited Add(obj);  
end; 
```

如果我不进行类型转换，则会出现重载错误，如上面的清单所示。

有什么想法我哪里出错了吗？

肖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T16:58:44.537

Delphi 2009 编译器在其泛型实现中存在一些非常严重的缺陷。它几乎没有像它应该理解的那样理解约束的含义，（Barry Kelly 在 SO 的其他地方承认了这一点；我不记得确切的位置，）并且跨单元泛型会导致非常奇怪的问题。最好的办法是根据具体情况处理这个问题：如果您的代码可以编译，请使用它。如果没有，请返回到非通用实现，直到他们修复它。希望我们能在不久的将来看到修复泛型（和 Generics.Collections 单元）的更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T19:45:03.780

看起来问题不是我，而是编译器:)。

最后，我使用以下方法破解了它

```
class function TtiGenericObjectList<T>.GenericAsObject(const Value): TObject;
begin
  Result := TObject(Value);
end;

class function TtiGenericObjectList<T>.ObjectAsGeneric(const Value): T;
begin
  Result := T(Value);
end; 
```

使用如下

```
function TtiGenericObjectList<T>.Add(const AObject: T): integer;
var obj: TtiObject;
begin
  obj:= TtiObject(GenericAsObject(AObject));
  result:= inherited Add(obj);
  // replaces the following which gets overload errors
//   result:= inherited Add(TtiObject(AObject));
end; 
```

和

```
function TtiGenericObjectList<T>.GetItems(i: integer): T;
var obj: TtiObject;
begin
  obj:= inherited GetItems(i);
  result:= ObjectAsGeneric(obj);
  // replaces the following which gets "Invalid typecast" errors
  // result:= inherited Add(AObject);
end; 
```

我会清理一下这些并使用它们，直到编译器得到修复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-27T07:12:40.590

我最近使用 D2010 解决了一个类似的问题，这是我想出的代码。

```
type
  TGenericList<T: TtiObject> = class(TtiObjectList)
  protected
    function GetItems(AIndex: integer): T; reintroduce;
    procedure SetItems(AIndex: integer; const AValue: T); reintroduce;
  public
    property Items[i:integer]: T read GetItems write SetItems; default;
    function Add(const AObject: T): integer; reintroduce;
  end;

implementation

{ TGenericList<T> }

function TGenericList<T>.Add(const AObject: T): integer;
begin
  Result := inherited Add(TtiObject(AObject));
end;

function TGenericList<T>.GetItems(AIndex: integer): T;
begin
  Result := T(inherited GetItems(AIndex));
end;

procedure TGenericList<T>.SetItems(AIndex: integer; const AValue: T);
begin
  inherited SetItems(AIndex, AValue);
end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T07:45:55.833

我发现了泛型的一些小问题，对于这样一个新功能来说这并不奇怪。而且您正试图使编译器真正感到困惑；-)。

不幸的是，我手头没有 2009，所以我无法测试，但我有一些建议：

您是否寻找过更新（并安装了它们）？

您是否尝试过使用 as 和 is 运算符：

```
obj:= AObject as TtiObject; 
```

您是否尝试过使用中间类：

```
TtiGenericList<T: TObject> = class(TtiObjectList)  
protected  
  function GetItems(i:integer): T; reintroduce;  
  procedure SetItems(i:integer; const Value: T); reintroduce;  
public  
  function Add(const AObject: T): integer; reintroduce;  
  property Items[i:integer]: T read GetItems write SetItems; default;  
end; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T11:34:56.643

（由于类似的问题，我来到这里，但是在确定它的同时，我得到了一个不同的解决方案，尽管使用了更新的（XE）Delphi）：

或者干脆尝试制作T 类型的局部变量**Obj 。**

# php - 从 zip 文件中提取数据 (PHP)

> ID：580122
> 
> 赞同：0
> 
> 时间：2009-02-24T01:32:00.347
> 
> 标签：php, zip, zlib

我有一个来自[Net Tuts](http://net.tutsplus.com/videos/screencasts/how-to-open-zip-files-with-php/)网站的教程，该教程用于上传 zip 文件并将文件中的数据提取到服务器中。

直接从网页复制和粘贴代码不起作用，在处理脚本的中途出现错误。

```
Fatal error: Cannot instantiate non-existent class: ziparchive in /www/website_here.co.uk/httpdocs/test/functions.php on line 6 
```

这可能与我使用的 PHP 版本有关吗？这是它卡住的代码：

```
<?php

function openZip($file_to_open) {
    global $target;
    global $unique_folder;
    $zip = new ZipArchive();
        $x = $zip->open($file_to_open);
        if ($x === true) {
            $zip->extractTo($target . $unique_folder);
            $zip->close();

            unlink($file_to_open); #deletes the zip file. We no longer need it.
        } else {
            die("There was a problem. Please try again!");
        }
    }

?> 
```

第 6 行：$zip = new ZipArchive();

我正在使用 PHP 版本 4.3.9。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T03:41:23.237

您也可以使用 PclZip：

```
include('pclzip.lib.php');
$zip = new PclZip($file_to_open);
if ($zip->extract(PCLZIP_OPT_PATH, $target . $unique_folder) == 0) {
    die("There was a problem. Please try again!");
} else {
    unlink($file_to_open);
} 
```

[http://www.phpconcept.net/pclzip](http://www.phpconcept.net/pclzip)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T01:35:33.693

在 PHP 4 上，您绝对需要安装[PECL zip 1.1.0](http://pecl.php.net/package/zip)（或更新版本）才能访问`ZipArchive`该类。遵循[这些说明](http://us.php.net/manual/en/install.pecl.php)。

如果这不可能，您将不得不使用非 OO`zip_open`等`zip_read`API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-30T05:33:35.650

```
include('pclzip.lib.php');
$zip = new PclZip($file_to_open);
if ($zip->extract(PCLZIP_OPT_PATH, $target . $un_f) == 0) {
    close("close");
} else {
    unlink($file_op);
} 
```

我同意使用 PclZip，如果您没有时间编写代码，请使用[提取数据](http://www.extractingdata.com/)，您还需要使用参考库

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T01:35:43.537

您需要对包含`ZipArchive`该类的库的引用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-18T13:04:28.493

```
$zipn=$_REQUEST['zip'];
echo $zipn;

$zip = new ZipArchive;
echo $_SERVER['DOCUMENT_ROOT']."/";
if ($zip->open($zipn) === TRUE) {
  $zip->extractTo($_SERVER['DOCUMENT_ROOT']."/");
  $zip->close();
  echo 'ok';
} else {
  echo 'failed';
} 
```

----------susheel susheel1104@gmail.com

# powershell - Powershell WMI ROOT\MicrosoftExchangev2 和 WQL where 使用

> ID：580133
> 
> 赞同：0
> 
> 时间：2009-02-24T01:40:01.607
> 
> 标签：powershell, wmi, exchange-server, wql

（PS 版本 1）

```
PS C:\> $query = 'Select * From Exchange_PublicFolder WHERE Path LIKE "/Foo%"'
PS C:\> $query
Select * From Exchange_PublicFolder WHERE Path LIKE "/Foo%"
PS C:\> gwmi -namespace ROOT\MicrosoftExchangev2 -query $query
Get-WmiObject : Provider is not capable of the attempted operation
At line:1 char:5
+ gwmi  <<<< -namespace ROOT\MicrosoftExchangev2 -query $query 
```

如果我尝试先将查询分配给变量，这没有区别。WQL 关键字 WHERE 可能有问题吗？我可以在没有它的情况下运行查询：

```
PS C:\> (gwmi -namespace ROOT\MicrosoftExchangev2 -query  "Select * From Exchange_PublicFolder").count
711 
```

稍后在管道中过滤并不是什么大不了的事，但我试图找出我在这里做错了什么:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T12:48:16.730

我不认为您做错了什么，只是提供者无法处理您的查询（如错误所述）。似乎不支持对任何属性使用 LIKE ，您可以使用 "=" 但这不是您要寻找的:(。IMO，在这种情况下使用 Where-Object 是要走的路。

# html - 我的 HTML 专栏在哪里？

> ID：580137
> 
> 赞同：5
> 
> 时间：2009-02-24T01:42:11.837
> 
> 标签：html, css, internet-explorer-6

我最近得到了……*机会*……完全重新设计我支持的网站的布局。为了保持我的 CSS 简单和我的 HTML 语义，我决定使用[“圣杯”布局](http://www.alistapart.com/articles/holygrail/)的修改版本（主要区别是将右列移动到中心列中，这进一步简化了事情，并使中心列固定宽度）。

经过微不足道的摆弄之后，我的新布局在 FF3、Chrome 和 Opera 中运行，这意味着是时候启动 IE6 了。可以预见的是，布局中断（左列完全丢失）。然而，我没想到它会如此惊人地崩溃——我似乎在 IE6 中触发了某种渲染错误，我既无法隔离也无法消除。

在调整圣杯布局时，我最初省略了它使用的特定于 IE6 的 hack，因为我对右列所做的修改不需要（不应该？），因为它占了该列的宽度，在我的布局中没有出现在同一级别。尽管如此，将它重新添加是我的第一个猜测，但结果证明它需要一个非常奇怪的数字（246px，不会出现在样式表的其他任何地方），所以我尝试调整窗口大小以确保它不相关到页面大小。令我惊讶的是，*该列向右跳了约 1000 像素*，远远超出了页面的边缘。

返回并删除 IE6 hack，在调整大小时会发生相同的行为，只是不是从布局的左侧跳出页面，而是突然出现在布局的*右侧*。我已经对布局的每个部分进行了修改，这些部分看起来甚至是远程相关的，并在 Google 上搜索了我知道的所有 IE6 渲染错误，但似乎无法消除页面调整大小的跳转行为。

有没有人见过这个错误，如果是错误？完整代码如下：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
    <head>
        <title>Modified grail layout</title>

        <style type="text/css">
            * {
                border: 0;
                margin: 0;
                padding: 0;
            }

            #main {
                background: white;
                overflow: auto;
                padding-left: 180px;
            }

            #content {
                background: #dfd;
                float: left;
                padding: 10px 10px 0;
                width: 800px;
            }

            #left {
                background: #ccc;
                float: left;
                margin-left: -100%;
                position: relative;
                padding: 10px 10px 0;
                right: 180px;
                width: 160px;
            }

            #right {
                background: #fdd;
                float: right;
                margin-bottom: 10px;
                padding: 10px 10px 0;
                width: 160px;
            }

            #top {
                margin: 0 auto;
                width: 1000px;
            }

            body {
                background: #ddf;
            }

            /* fake content */

            #cc1 {
                height: 320px;
                width: 800px;
            }

            #cc2 {
                height: 320px;
                margin-right: 190px;
            }

            #cc3 {
                height: 160px;
                margin-right: 190px;
            }

            #lc1 {
                height: 120px;
                margin-left: auto;
                margin-right: auto;
                width: 144px;
            }

            #lc2 {
                height: 300px;
                width: 160px;
            }

            #lc3 {
                height: 400px;
                width: 160px;
            }

            #rc1 {
                height: 400px;
                width: 160px;
            }

            #rc2 {
                height: 300px;
                width: 160px;
            }

            div.fake-content {
                background: #666;
                color: white;
                margin-bottom: 10px;
            }

            /* Internet Explorer (all) */

            #ie body {
                text-align: center;
            }

            #ie #left {
                text-align: center;
            }

            #ie #left * {
                text-align: left;
            }

            #ie #right {
                margin-bottom: 0;
            }

            #ie #top {
                text-align: left;
            }

            /* Internet Explorer 6 */

            #ie6 #left {
                left: 246px; /* WTF!? */
            }
        </style>
    </head>

    <body>
        <!--[if IE 6]><div id="ie"><div id="ie6"><![endif]-->
        <!--[if IE 7]><div id="ie"><div id="ie7"><![endif]-->
        <!--[if IE 8]><div id="ie"><div id="ie8"><![endif]-->

        <div id="top">
            <div id="main">
                <div id="content">
                    <div id="cc1" class="fake-content">cc1</div>

                    <div id="right">
                        <div id="rc1" class="fake-content">rc1</div>
                        <div id="rc2" class="fake-content">rc2</div>
                    </div>

                    <div id="cc2" class="fake-content">cc2</div>
                    <div id="cc3" class="fake-content">cc3</div>
                </div>

                <div id="left">
                    <div id="lc1" class="fake-content">lc1</div>
                    <div id="lc2" class="fake-content">lc2</div>
                    <div id="lc3" class="fake-content">lc3</div>
                </div>
            </div>

            <p id="footer">&copy;2009 Blah blah blah</p>
        </div>

        <!--[if IE]></div></div><![endif]-->
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T02:05:09.007

指定在 IE6`position: relative`中`#top`修复它，信不信由你。

看[这个](http://www.satzansatz.de/cssd/onhavinglayout.html#rp)，[这些](http://www.google.com/search?q=ie+bug+position+relative)，等等。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-26T01:56:43.050

That's why [I say](https://stackoverflow.com/questions/426253/426282#426282) tables are not evil! As long as you don't use them in hackish ways (like people used to do back in 2000), they're perfect for layout.

What is the less hackish alternative proposed?
A structure that requires weird hacks that *don't even make sense!!*

The accepted answer's comment "believe it or not" says it all!

* I'm making this a wiki, in fear of prosecution by css zealots

Check out this answer too:

[Vertical centering with css](https://stackoverflow.com/questions/527811/css-vertical-centering/527826#527826) (I like his comments :))

and ..

[Give up and use tables!](http://giveupandusetables.com/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2010-01-26T13:04:51.090

Use tables, here is a sample for you:

```
<html>
<head>
<title>3 column table</title>
</head>
<body>

<table style="width:100%;">
<tr>
<td style="width:20px;border: solid 1px black;">Left column</td>
<td style="border: solid 1px black;">Center Column</td>
<td style="width:20px;border: solid 1px black;">Right column</td>
</tr>
</table>

</body>
</html> 
```

This works, I tested it.

# rake - 如何在 TeamCity 项目的构建配置之间链接版本号？

> ID：580138
> 
> 赞同：16
> 
> 时间：2009-02-24T01:42:22.350
> 
> 标签：rake, teamcity

我想在 TeamCity 项目（开发、质量保证、生产）中有 3 个不同的构建。链接依赖项（如果没有成功的 QA 就无法构建生产，没有成功的开发就无法构建 QA），我想通过构建传播版本号。

开发构建 => v 1.0.1.0 QA 构建 => 成功构建集版本为 v1.0.1.0

有没有办法将构建配置版本设置为不同的构建版本？

我正在使用 TeamCity 4.0.2，跑步者是 Rake，构建 VS2008 解决方案。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-24T12:54:26.573

如果您有 Dev->QA->Production 构建的快照依赖项，您可以在 QA 和 Production 构建中引用 Dev build 中的构建号。

请阅读[http://www.jetbrains.net/devnet/message/5231290](http://www.jetbrains.net/devnet/message/5231290)了解详细信息。

**更新：**[此 TeamCity How-To 问题](https://confluence.jetbrains.com/display/TCD9/How+To...#HowTo...-SharetheBuildnumberforBuildsinaChainBuild) 中提供了有关如何实现此目标的最新信息。

# grammar - BNF 语法匹配

> ID：580142
> 
> 赞同：1
> 
> 时间：2009-02-24T01:44:07.543
> 
> 标签：grammar, bnf

我的老师给了我两个 bnf 语法：

```
A ::= 'd' | A 'e' A | A 'f' A
B ::= 'd' | B B 'e' | B B 'f' 
```

和四个与之匹配的字符串：

*   dffd
*   dddefddfe
*   德夫
*   专用的

我想出了其中两个，但其他两个让我难过。我不希望任何人告诉我答案，但如果有人能给我一些关于我哪里出错的提示，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T01:59:21.093

这是一种无上下文语法，因此您应该寻找绘制解析树。然后，您可以查看哪个非终结符导致哪个产生的字符串。这些语法相当简单，因此绘制解析树应该很容易手工完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T01:59:14.900

嗯……

通过归纳，所有匹配必须有奇数个字符。所以这4个字符串中的任何一个都不会被击中......

* * *

等一下。我刚刚注意到第一条规则中的“Y”。我们知道那是什么吗？它可能会立即打破我的论点......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T01:50:16.047

我的建议是在编写任何代码之前为自己绘制一个有限自动机或状态图。先用铅笔和纸手工完成。

# php - 将字符串中的所有 url 转换为锚点

> ID：580146
> 
> 赞同：1
> 
> 时间：2009-02-24T01:47:53.227
> 
> 标签：php, regex, string, parsing, hyperlink

我有一个字符串（`$string`对于这个例子），我想做以下事情：

解析字符串并将其中的所有 url 转换为“实际链接”（添加打开/关闭锚标记）。

做这个的最好方式是什么？我尝试使用`preg_split()`创建字符串中包含的链接的数组，并`str_replace()`打算在事后使用来进行更改。但是，这种方法不起作用，因为我很难将文本字符串中的链接与`preg_split()`.

`$string`可以在其中包含多个链接，这就是我采用这种方法的原因。如果我提前准确地知道链接是什么，或者如果`str_replace()`使用模式匹配，我就会被设置。

简而言之，我认为上述方法不是最好的方法。什么是更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T01:57:53.233

这正是这种事情`preg_replace`的目的......

```
preg_replace('/your URL regex/', '<a href="$0">$0</a>', $string); 
```

*编辑*：whaddya 知道，“URL regex PHP”的热门 Google 命中：http: [//snipplr.com/view/2371/regex-regular-expression-to-match-a-url/](http://snipplr.com/view/2371/regex-regular-expression-to-match-a-url/)

```
# PHP Example: Automatically link URL's inside text.

$text = preg_replace('@(https?://([-\w\.]+)+(:\d+)?(/([\w/_\.]*(\?\S+)?)?)?)@', '<a href="$1">$1</a>', $text); 
```

请注意，如果您想完全匹配 URL，您将需要一个极其复杂的正则表达式，但要匹配大多数常见的 HTTP/HTTPS URL，上述正则表达式应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T01:52:10.423

我认为您误解了`preg_split()`. 它用于根据正则表达式拆分字符串。例如，如果您有一个数据字符串“one1two2three3four”，您可以使用`preg_split`正则表达式“\d”，并且您将返回一个 4 元素数组，包括“one”、“two”、“three”、“four ”。

因此，除非链接始终由特定字符分隔，否则`preg_split()`不是适合该工作的工具。您可能希望使用`preg_match()`然后循环返回的不同匹配项。

编辑：或者正如大卫所说，`preg_replace()`甚至比`preg_match()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T02:06:39.157

正则表达式取决于链接的显示方式或它们可以出现的位置（在引号内、在自定义 HTML 标记内等）。

它还取决于输入的来源。如果它来自用户，使用类似 markdown 的语法可能是一个更好的主意。

无论如何，请查看：[http](http://regexlib.com/Search.aspx?k=links) ://regexlib.com/Search.aspx?k= links 以获得一些声称匹配 URI 等的正则表达式。然后，您将使用（最初由 David 发布）：

```
preg_replace('/your URL regex/', '<a href="$0">$0</a>', $string); 
```

# c# - 字符串泛型约束的值类型部分

> ID：580148
> 
> 赞同：1
> 
> 时间：2009-02-24T01:48:23.117
> 
> 标签：c#

如果 string 是一个值类型，我假设它是，为什么下面的声明是合法的：

```
struct Refsample<T> where T : class

RefSameple<string>; //why is it legal? 
```

取自 C# 深度，第 75 页

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T01:50:33.503

System.String 是一种引用类型，尽管它具有值类型的一些特征。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T01:55:57.577

string 是不可变的引用类型。

你是想说吗？

```
struct Refsample<T> where T : class 
```

struct 本身是值类型，但它可以包含引用类型。

值类型变量存储在内存堆栈中，而引用类型变量有一个指向堆的内存地址。

例如

```
struct Refsample<T> where T : class
{
   // stored in the stack as well.
   public int Age; 

   // memory address pointing to the heap stored in the stack, 
   // but the actual object is stored in the heap.
   public string Name；
   // same as string above if T was reference type;
   // otherwise, if value type, same as Age above.
   public T SomeThing; 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T01:56:43.330

String 实际上是一种引用类型，其*作用*类似于值类型。这就是为什么您可以针对字符串测试 null 而您不能针对 int、bool 等进行测试。嗯，您可以，但您只会得到默认值 0、false 等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T02:03:30.210

System.String 是引用类型而不是值类型。

# java - 如何将集合转换为列表？

> ID：580160
> 
> 赞同：328
> 
> 时间：2009-02-24T01:56:11.413
> 
> 标签：java, list, sorting, collections, apache-commons-collection

我正在使用`TreeBidiMap`Apache [Collections](https://commons.apache.org/proper/commons-collections/)库。我想对它的值进行排序`doubles`。

我的方法是使用以下方法检索一个`Collection`值：

```
Collection coll = themap.values(); 
```

这自然可以正常工作。

**主要问题：**我现在想知道如何将（不确定哪个是正确的）转换/转换`coll`为 a`List`以便对其进行排序？

然后我打算迭代排序的`List`对象，它应该是有序的，并使用迭代器在列表中的位置从`TreeBidiMap`( `themap`) 中获取适当的键。`themap.getKey(iterator.next())``doubles`

* * *

## 回答 #1

> 赞同：503
> 
> 时间：2009-02-24T02:02:14.457

```
List list = new ArrayList(coll);
Collections.sort(list); 
```

正如 Erel Segal Halevi 下面所说，如果 coll 已经是一个列表，您可以跳过第一步。但这将取决于 TreeBidiMap 的内部结构。

```
List list;
if (coll instanceof List)
  list = (List)coll;
else
  list = new ArrayList(coll); 
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2009-02-24T02:03:09.960

像这样的东西应该可以工作，调用带有 Collection的[ArrayList 构造函数：](http://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html#ArrayList-java.util.Collection-)

```
List theList = new ArrayList(coll); 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2011-07-24T10:25:41.633

如果 coll 已经是一个列表，我认为 Paul Tomblin 的答案可能是浪费的，因为它将创建一个新列表并复制所有元素。如果 coll 包含许多元素，这可能需要很长时间。

我的建议是：

```
List list;
if (coll instanceof List)
  list = (List)coll;
else
  list = new ArrayList(coll);
Collections.sort(list); 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2017-08-24T14:20:02.760

我相信你可以这样写：

```
coll.stream().collect(Collectors.toList()) 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2020-06-21T14:08:02.100

Java 10 引入了在保留顺序的同时`List#copyOf`返回*不可修改的列表：*

```
List<Integer> list = List.copyOf(coll); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-02-24T02:06:40.327

```
Collections.sort( new ArrayList( coll ) ); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-01-08T21:39:10.523

@Kunigami：我认为您可能对 Guava 的`newArrayList`方法有误。它不检查 Iterable 是否为 List 类型，而只是按原样返回给定的 List。它*总是*创建一个新列表：

```
@GwtCompatible(serializable = true)
public static <E> ArrayList<E> newArrayList(Iterable<? extends E> elements) {
  checkNotNull(elements); // for GWT
  // Let ArrayList's sizing logic work, if possible
  return (elements instanceof Collection)
      ? new ArrayList<E>(Collections2.cast(elements))
      : newArrayList(elements.iterator());
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-05-28T15:43:24.147

您要求的操作成本很高，请确保您不需要经常进行（例如在一个周期中）。

如果您需要它保持排序并且经常更新它，您可以创建一个自定义集合。例如，我想出了一个有你的`TreeBidiMap`和`TreeMultiset`引擎盖下的。仅实施您需要的并关心数据完整性。

```
class MyCustomCollection implements Map<K, V> {
    TreeBidiMap<K, V> map;
    TreeMultiset<V> multiset;
    public V put(K key, V value) {
        removeValue(map.put(key, value));
        multiset.add(value);
    }
    public boolean remove(K key) {
        removeValue(map.remove(key));
    }
    /** removes value that was removed/replaced in map */
    private removeValue(V value) {
        if (value != null) {
            multiset.remove(value);
        }
    }
    public Set<K> keySet() {
        return Collections.unmodifiableSet(map.keySet());
    }
    public Collection<V> values() {
        return Collections.unmodifiableCollection(multiset);
    }
    // many more methods to be implemented, e.g. count, isEmpty etc.
    // but these are fairly simple
} 
```

这样，您就有**一个** `Multiset`从`values()`. 但是，如果您需要它是一个列表（例如，您需要类似数组的`get(index)`方法），您就需要一些更复杂的东西。

为简洁起见，我只返回不可修改的集合。@Lino 提到的是正确的，并且按原样修改`keySet`or`values`集合会使其不一致。我不知道任何一致的方法来使`values`可变，但如果它使用上面类中的方法，则`keySet`可以支持。`remove``remove``MyCustomCollection`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-16T21:23:47.440

使用流：

```
someCollection.stream().collect(Collectors.toList()) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-05-07T20:19:15.973

*Java 8 以后...*

***您可以使用Streams**和**Collectors.toCollection()**将 Collection 转换为任何集合（即 List、Set 和 Queue ） 。*

考虑以下示例地图

```
Map<Integer, Double> map = Map.of(
    1, 1015.45,
    2, 8956.31,
    3, 1234.86,
    4, 2348.26,
    5, 7351.03
); 
```

**到数组列表**

```
List<Double> arrayList = map.values()
                            .stream()
                            .collect(
                                Collectors.toCollection(ArrayList::new)
                            ); 
```

> 输出：[7351.03、2348.26、1234.86、8956.31、1015.45]

**到 Sorted ArrayList（升序）**

```
List<Double> arrayListSortedAsc = map.values()
                                        .stream()
                                        .sorted()
                                        .collect(
                                            Collectors.toCollection(ArrayList::new)
                                        ); 
```

> 输出：[1015.45、1234.86、2348.26、7351.03、8956.31]

**到 Sorted ArrayList（降序）**

```
List<Double> arrayListSortedDesc = map.values()
                                        .stream()
                                        .sorted(
                                            (a, b) -> b.compareTo(a)
                                        )
                                        .collect(
                                            Collectors.toCollection(ArrayList::new)
                                        ); 
```

> 输出：[8956.31、7351.03、2348.26、1234.86、1015.45]

**到链表**

```
List<Double> linkedList = map.values()
                                .stream()
                                .collect(
                                    Collectors.toCollection(LinkedList::new)
                                ); 
```

> 输出：[7351.03、2348.26、1234.86、8956.31、1015.45]

**到哈希集**

```
Set<Double> hashSet = map.values()
                            .stream()
                            .collect(
                                Collectors.toCollection(HashSet::new)
                            ); 
```

> 输出：[2348.26、8956.31、1015.45、1234.86、7351.03]

**到优先队列**

```
PriorityQueue<Double> priorityQueue = map.values()
                                            .stream()
                                            .collect(
                                                Collectors.toCollection(PriorityQueue::new)
                                            ); 
```

> 输出：[1015.45、1234.86、2348.26、8956.31、7351.03]

*参考*

[Java - 包 java.util.stream](https://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html)

[Java - 包 java.util](https://docs.oracle.com/javase/8/docs/api/java/util/package-summary.html)

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2014-07-29T14:57:14.400

这是作为单线的次优解决方案：

```
Collections.list(Collections.enumeration(coll)); 
```

# c# - Visual Studio 代码分析与 StyleCop + FxCop

> ID：580168
> 
> 赞同：72
> 
> 时间：2009-02-24T01:58:50.503
> 
> 标签：c#, visual-studio-2008, code-analysis, fxcop, stylecop

我以前在 Visual Studio 的项目中使用过 StyleCop + FxCop。但是现在我在测试Visual Studio代码分析工具，它更容易集成到MSBuild中，我发现这个工具分析了FxCop和StyleCop的一些规则。

这个工具是完全替代 FxCop 和 StyleCop 还是只是实现了它们的一些规则？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-02T17:59:38.973

Visual Studio 包括 FxCop + 更多。

来自[FxCop 的开发者博客](http://davesbox.com/archive/2008/08/17/fxcop-1-36-released.aspx)：

> 抱歉我的无知，但我认为 FxCop 与 VSTS 中的代码分析完全分开？更具体地说，我假设如果我安装新版本的 FxCop，VSTS 不会利用（没有共享代码？）？如果是这种情况，是否知道这些更改何时会进入 VSTS 代码分析？谢谢！
> 
> 没错，它们是不同的产品，但它们确实有一个共同的引擎。Visual Studio 2008 SP1 已经提供了相同的修复和分析（加上更多），因此无需使用最新的 FxCop 来“更新”Visual Studio。

[开发者博客](http://blogs.msdn.com/fxcop/archive/2008/01/07/faq-which-rules-shipped-in-which-version.aspx)还给出了每个规则中的确切规则。

至于 StyleCop，它独立于 VS 代码分析，如本文所述，[该博客文章](http://blogs.msdn.com/sourceanalysis/archive/2008/07/20/clearing-up-confusion.aspx)链接到[Jader Dias 的文章](https://stackoverflow.com/questions/580168/visual-studio-code-analysis-vs-stylecop-fxcop/580182#580182)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-25T00:39:16.600

我的理解是，Visual Studio Code Analysis 基本上是 FxCop 的略微修改版本。根据我的经验，它们几乎是一回事（事实上，我相信代码分析在幕后使用 FxCop 可执行文件）。

虽然 FxCop/CodeAnalysis 和 StyleCop 有重叠；FxCop 倾向于更多地关注设计规则，而 StyleCop 更关注编码风格（大小写、空白、缩进等）。

FxCop 分析 IL 而 StyleCop 直接分析源代码。这对它们各自可以执行的规则施加了一组不同的限制。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-24T02:02:35.097

到目前为止，我的谷歌搜索得到了以下答案：

[http://blogs.msdn.com/bharry/archive/2008/07/19/clearing-up-confusion.aspx](http://blogs.msdn.com/bharry/archive/2008/07/19/clearing-up-confusion.aspx)

状态：

“我们发现 StyleCop 实际上是一个非常有用的工具，它完成了 FxCop 和 TeamDev 不做的事情（而且它不做他们所做的事情）。它是一个很好的补充工具。StyleCop 是一个工具进行编码样式检查以验证源代码是否按照您想要的方式格式化并遵循约定的样式指南。虽然与 FxCop 有一些重叠（如检查标识符大小写），但重叠是微不足道的，因为 StyleCop 没有进行深入分析其他静态分析工具可以启用代码正确性检查、安全检查等。”

但我不确定“TeamDev”是否与“Visual Studio 的代码分析”相同

# php - 我的“if”语句有什么问题？

> ID：580173
> 
> 赞同：0
> 
> 时间：2009-02-24T01:59:59.703
> 
> 标签：php, syntax, if-statement

我正在使用 if 语句来声明用户是否是管理员、mod 或两者都不是，使用下面的代码，但它总是让 $status = "admin" 搞砸了，即使那个人都不是，这真的让我感到困惑。

```
if($info['rights'] == "m") {
    $status = '<font color="#FFFFFF">(mod)</font>';
}elseif ($info['rights'] == "a"); {
    $status = '<font color="#FFFFFF">(admin)</font>';
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-24T02:01:49.683

您似乎不小心在 elseif 之后添加了一个分号 (;)，因此第二个代码块总是被执行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T02:02:49.977

“a”之后应该有一个分号）吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T02:05:59.673

您的代码中有语法错误。

你可以试试这个：

```
if($info['rights'] == "m") {
  $status = '<font color="#FFFFFF">(mod)</font>';
} else if ($info['rights'] == "a") {
  $status = '<font color="#FFFFFF">(admin)</font>';
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T02:03:17.403

是否声明了 $info？$info 在哪里定义和分配？

# ruby - 如何在 Solaris 上编译 RDiscount？

> ID：580176
> 
> 赞同：0
> 
> 时间：2009-02-24T02:01:14.193
> 
> 标签：ruby, unix, rubygems, solaris, markdown

我有几个 Solaris 10 盒子，我想在那里运行 RDiscount。（它们是 Joyent 加速器，有一些定制的 BSD 风格的用户空间，以防万一。）

我知道 Maruku、rpeg-markdown 和 BlueCloth 的其他红宝石替代品，但最初我想使用 RDiscount。

这是我尝试安装它时得到的：

```
    $ sudo gem install rdiscount
    密码：
    构建原生扩展。这可能需要一段时间...
    错误：安装 rdiscount 时出错：
            错误：无法构建 gem 原生扩展。

    /opt/local/bin/ruby18 extconf.rb 安装 rdiscount
    检查随机（）...是的
    检查 srandom()... 是的
    检查 funopen()... 否
    检查 fopencookie()... 否
    *** extconf.rb 失败 ***
    [剪辑]

    extconf.rb:11：没有可用的 funopen 或 fopencookie 支持。（运行时错误）

```

显然安装失败，因为它既找不到`funopen`也找不到`fopencookie`。

说实话，我不知道这些是什么。那么，关于我需要做什么来编译它的任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T23:22:25.160

不幸`fopencookie`的是，它是 glibc 的一部分，并`glibc`没有被移植到 Solaris。

使用不同的宝石。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T21:20:00.470

### 更新2：

rdiscount 1.3.4 在 Solaris 上安装良好，这要感谢 David Parsons、Ryan Tomayko 以及[Joyent 团队和社区在他们的论坛上](http://discuss.joyent.com/viewtopic.php?id=25008)的帮助和辛勤工作。

# c - 将 int 成员添加到 C 结构会导致段错误

> ID：580177
> 
> 赞同：3
> 
> 时间：2009-02-24T02:01:27.297
> 
> 标签：c, struct, malloc, segmentation-fault

我还在学习 C，并且已经开始使用它来生成图像。我不知道为什么我的一个程序会出现段错误。这是源代码，减少到 40 行：

```
#include <stdio.h>
#include <stdlib.h>
struct color {
        unsigned char r, g, b;
};
struct image {
        int w, h/*, o*/;
        struct color **data;
};
int main() {
        // Declarations
        int x, y;
        struct color *black;
        struct image *img;
        // Set up color black
        black = (struct color *) malloc(sizeof(struct color *));
        black->r = 0;
        black->g = 0;
        black->b = 0;
        // Set up image img
        img = (struct image *) malloc(sizeof(struct image *));
        img->w = 1;
        img->h = 1;
        /*img->o = 0;*/
        img->data = (struct color **) malloc(img->h * sizeof(struct color *));
        for (y = 0; y < img->h; y++) {
                img->data[y] = (struct color *) malloc(img->w * sizeof(struct color));
        }
        // Fill in img with black
        for (x = 0; x < img->w; x++) {
                for (y = 0; y < img->h; y++) {
                        img->data[y][x].r = black->r;
                        img->data[y][x].g = black->g;
                        img->data[y][x].b = black->b;
                }
        }
        // Free black
        free(black);
        // Free img
        for (y = 0; y < img->h; y++)
                free(img->data[y]);
        free(img->data); // Segfaults
        free(img); // Also segfaults
        return 0;
} 
```

它编译并运行良好（在 Ubuntu 上使用 gcc，在带有 Cygwin 的 Vista 上使用），但取消注释处理 img->o 的两行会破坏它。我感觉它与上[一个问题有关](https://stackoverflow.com/questions/433700/segfault-from-adding-a-variable)，但我正在 malloc'ing 所有需要 malloc'ed 的东西（我认为）。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-24T02:04:50.723

您的 malloc 语句中有一个错误。您正在分配指针而不是结构。这只会为您提供 4 个字节的内存，而不是您的结构所需的实际大小。

```
black = malloc(sizeof(*black)); 
```

为指针分配内存时，您需要为所指向的事物分配内存，而**不是**指针的类型。如果你简单地写成`sizeof(*black)`如图所示，你总是会得到正确的类型，即使类型发生了`black`变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T02:07:26.143

乍一看，您似乎正在使用额外级别的指针间接，这导致了段错误。当您 malloc 内存时，它是指向对象的指针，而不是指向对象指针的指针。所以你会有：

```
img = (struct image *)malloc(sizeof(struct image))
img->o = 0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T02:08:10.933

JaredPar 有正确的答案，但如果你得到一个段错误，首先要做的是在 valgrind 下运行程序。这对处理此类问题有很大帮助。

顺便说一句，我在那个确切的错误上浪费了几天时间。很高兴您在 C 编程生涯的早期就遇到了它，并且将来会一直提防它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T02:07:32.277

哎呀，代码被切断了；我忘了逃避一个小于号。这里是：

```
#include <stdio.h>
#include <stdlib.h>
struct color {
    unsigned char r, g, b;
};
struct image {
    int w, h/*, o*/;
    struct color **data;
};
int main() {
    // Declarations
    int x, y;
    struct color *black;
    struct image *img;
    // Set up color black
    black = (struct color *) malloc(sizeof(struct color *));
    black->r = 0;
    black->g = 0;
    black->b = 0;
    // Set up image img
    img = (struct image *) malloc(sizeof(struct image *));
    img->w = 1;
    img->h = 1;
    /*img->o = 0;*/
    img->data = (struct color **) malloc(img->h * sizeof(struct color *));
    for (y = 0; y < img->h; y++) {
        img->data[y] = (struct color *) malloc(img->w * sizeof(struct color));
    }
    // Fill in img with black
    for (x = 0; x < img->w; x++) {
        for (y = 0; y < img->h; y++) {
            img->data[y][x].r = black->r;
            img->data[y][x].g = black->g;
            img->data[y][x].b = black->b;
        }
    }
    // Free black
    free(black);
    // Free img
    for (y = 0; y < img->h; y++)
        free(img->data[y]);
    free(img->data);
    free(img);
    // Return
    return 0;
}
```

# asp.net - 在 ASP 中嵌入资源 SWF Flash 视频播放器？

> ID：580192
> 
> 赞同：0
> 
> 时间：2009-02-24T02:04:27.853
> 
> 标签：asp.net, custom-controls, flv, flvplayback

我正在尝试为嵌入了 swf 对象的[Flow Player](http://flowplayer.org/) flv 播放器做一个 ASP.net 自定义控件。通过[Steve Orr Controls](http://steveorr.net/)，我了解到您可以嵌入 javascript 文件并注册它们，因此您不必总是手动添加 javascript 文件。我想知道这是否适用于 SWF 文件。

我一直在网上阅读，我想弄清楚我是否疯狂地寻找无法完成的事情？或者我假设我可以使这个 XXYYWW122313 URL 有用？

我正在获取 url，但是当我尝试按照 flowman 站点的说明在渲染的 < A > 标签中显示视频时。此外，我一直在研究其他可用的 flv 播放器，但问题仍然在于如何嵌入 swf flash 视频播放器和使用 webresource url。

简而言之，我正在做的是以下内容：

```
 Imports System.Web
    Imports System.Web.UI
    Imports System.Web.UI.WebControls
    Imports System.ComponentModel
<DefaultProperty("FlowPlayer"), ToolboxData("<{0}:FlowManHlp runat=server></{0}:FlowManHlp>")> _
Public Class FlowManHlp
    Inherits Control

    Private flowPlayerPath As String
    Private flowPlayerJSPath As String

    Protected Overrides Sub OnPreRender(ByVal e As System.EventArgs)
        MyBase.OnPreRender(e)

        If Me.DesignMode Then Exit Sub

        Dim rstype As Type = Me.GetType
        Dim rsname As String = "FlowMan_Helper.Resources.flowplayer-3.0.5.min.js"

        ' Register the client resource with the page.
        Dim cs As ClientScriptManager = Page.ClientScript
        cs.RegisterClientScriptResource(rstype, rsname)
        'cs.RegisterClientScriptResource(rstype, "FlowMan_Helper.Resources.flowplayer-3.0.5.swf")

    End Sub

    Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)
        Dim htmlwrite As New System.Text.StringBuilder()
        htmlwrite.Append("<a href=""http://blip.tv/file/get/KimAronson-TwentySeconds73213.flv""")
        htmlwrite.Append(" Style = ""display:block;width:400px;height:300px""")
        htmlwrite.Append(" id=""player""></a>")

        htmlwrite.Append(vbCrLf & "<script>")
        htmlwrite.Append(vbCrLf & "flowplayer(""player"", """ & flowPlayerPath & """ );")
        htmlwrite.Append(vbCrLf & "</script>")
        htmlwrite.Append(vbCrLf & "<script>")
        htmlwrite.Append(vbCrLf & "HelloWorld();")
        htmlwrite.Append(vbCrLf & "</script>")

        '      <script>
        '   flowplayer("player", "../flowplayer-3.0.5.swf");
        '</script>
        writer.Write(htmlwrite.ToString())
    End Sub

    Private Sub FlowManHlp_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init
        flowPlayerPath = Page.ClientScript.GetWebResourceUrl(Me.GetType(), "FlowMan_Helper.Resources.flowplayer-3.0.5.swf")
        flowPlayerJSPath = Page.ClientScript.GetWebResourceUrl(Me.GetType(), "FlowMan_Helper.Resources.flowplayer-3.0.5.min.js")

        flowPlayerPath = ResolveClientUrl(flowPlayerPath)

    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T14:11:41.100

您是否确保将嵌入式资源标记为解决方案的“嵌入式资源”，以便将其与编译代码捆绑在一起？

此外，切换到 WebResource 而不是 ScriptResource。

Google searches have a lot of tutorials too. Try [Understanding ScriptResource and WebResource in ASP.NET](http://bchavez.bitarmory.com/archive/2008/07/28/understanding-scriptresource-and-webresource-in-asp.net.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T19:07:35.707

我发现这是可以做到的，因为[http://www.aspnetflash.com/](http://www.aspnetflash.com/)上的人在拖放到网站区域时不会添加单独的 swf 文件。我决定改用他们的工具。我尝试了 JW Player 和 FlowPlayer，还有另一个独立的 SWF。当我在 ASP 网页中使用它们时，它总是出现空白，每个路径都设置正确。我还将 mime 类型添加到 IIS 服务器和默认网站。我尝试了一些网站上提到的 HTTP 处理程序 FlashSomething，但没有运气。

# html - CSS Layout 2-Column 固定流体

> ID：580195
> 
> 赞同：38
> 
> 时间：2009-02-24T02:05:32.950
> 
> 标签：html, css, layout

我想知道这里是否有人对以下 2 列 css 布局有一个相当简单的教程。左侧固定列和流动内容列，具有页眉和页脚以及相等的列高。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-12-11T23:12:21.213

实际上，我不久前发现了一个更简单的解决方案。可以很好地回到 IE7。#fluid div 将在固定修复旁边向上滑动并占用剩余空间，同时为所有响应式站点保持良好的流动性。

[http://jsfiddle.net/uEj55/1/](http://jsfiddle.net/uEj55/1/)

```
#fixed{
  width:150px;
  float:left;
}
#fluid{
  overflow:hidden;
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-24T03:01:13.677

试试[这个动态驱动布局](http://www.dynamicdrive.com/style/layouts/item/css-liquid-layout-21-fixed-fluid/)和它的亲戚（我是通过我的一个类似问题指出的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T02:15:50.087

我使用的是仿列布局hack，它不包括脚本。

这是一个似乎是对该概念的简单解释的教程： [dustinbrewer.com](http://dustinbrewer.com/using-faux-columns-for-same-column-height/)

这是我从 alistpart.com 中学到的原始 alistapart.com 文章：[alistapart.com](http://www.alistapart.com/articles/fauxcolumns/)

祝你好运！

# c# - 如何覆盖列表 在 C# 中的 Add 方法？

> ID：580202
> 
> 赞同：39
> 
> 时间：2009-02-24T02:07:58.890
> 
> 标签：c#, generics, inheritance, collections

我目前正在寻找自己的收藏，这就像一个普通的列表，只是它只能容纳 10 件物品。如果在列表中已有 10 个项目时添加了一个项目，则在添加新项目之前将删除第一个项目。

我想要做的是创建一个扩展类，`System.Collections.Generic.List<T>`然后修改该`Add(T item)`方法以包含必要时删除第一项的功能。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-02-24T02:15:15.783

您还可以通过实现 add 方法

```
public new void Add(...) 
```

在您的派生类中隐藏现有的添加并介绍您的功能。

编辑：粗略的轮廓...

```
class MyHappyList<T> : List<T>
{
    public new void Add(T item)
    {
        if (Count > 9)
        {
            Remove(this[0]);
        }

        base.Add(item);
    }
} 
```

只是一个注释，认为它是隐含的，但您必须始终通过实际类型引用您的自定义列表，而不是通过基本类型/接口引用，因为隐藏方法仅适用于您的类型和进一步的派生类型。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-02-24T02:24:52.577

首先，您不能覆盖 Add 并且仍然具有针对[List](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)的多态性，这意味着如果您使用 new 关键字并且您的类被强制转换为 List，则不会调用您的新 Add 方法。

其次，我建议您查看[Queue](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx)类，因为您尝试做的更多是队列而不是列表。该类针对您想要做的事情进行了优化，但没有任何类型的大小限制器。

如果您确实希望某些东西像 List 一样工作，但像具有最大大小的 Queue 一样工作，我建议您实现[IList](http://msdn.microsoft.com/en-us/library/5y536ey6.aspx)并保留一个 Queue 实例来存储您的元素。

例如：

```
public class LimitedQueue<T> : IList<T>
{
  public int MaxSize {get; set;}
  private Queue<T> Items = new Queue<T>();
  public void Add(T item)
  {
    Items.Enqueue(item);
    if(Items.Count == MaxSize)
    {
       Items.Dequeue();
    }
  }
  // I'll let you do the rest
} 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-02-24T02:12:42.233

您不能覆盖 Add()，它不是虚拟方法。而是从 IList 派生并使用私有 Queue 成员来实现。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-02-24T13:46:01.833

您可以扩展[System.Collections.ObjectModel.Collection](http://msdn.microsoft.com/en-us/library/ms132397.aspx)并覆盖 InsertItem 方法以获得您想要的行为，它还实现 IList

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-24T02:13:59.327

您可以只编写一个实现`IList<T>`包含内部的类`List<T>`并编写自己的方法。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-24T02:22:06.967

似乎我能做的最好的就是：

```
class MostRecentList<T> : System.Collections.Generic.List<T> 
{
    private int capacity;

    public MostRecentList(int capacity) : base() 
    {
        this.capacity = capacity;
    }

    public new void Add(T item) 
    {
        if (base.Count == capacity)
        {
            base.RemoveAt(0);
        }
        base.Add(item);
    }
} 
```

由于该`add()`方法未标记为`virtual`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-04-09T16:27:27.350

您对需求的描述听起来像是[Circular Buffer](http://en.wikipedia.org/wiki/Circular_buffer)。

我实现了我自己的 - 类似于[CodePlex 上的这个实现，](http://circularbuffer.codeplex.com/releases/view/27751#DownloadId=69221)除了我的实现`IList<T>`。

其他一些答案建议使用`Queue<T>`- 但这并不完全相同，因为它只允许 FIFO 访问。

一般来说，不建议派生自`List<T>`- 而是派生自`Collection<T>`，并实现您需要的任何其他内容。`Collection<T>`但是对于循环缓冲区，使用私有数组可能更合适，而不是像 CodePlex 实现那样派生。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T02:39:43.853

您可以查看 C5 集合库。他们有一个实现 IList<T> 的 ArrayList<T> 并有一个虚拟的 Add 方法。C5 集合库是一个很棒的列表、队列、堆栈等集合......你可以在这里找到 C5 库：

[http://www.itu.dk/research/c5/](http://www.itu.dk/research/c5/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T08:06:37.093

阅读[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)，您的集合是扩展 List 的非常差的候选者`<T>`，它甚至不是实现 IList 的好候选者`<T>`。

此数据需要哪些读取模式？如果您只需要查看所有当前条目，那么实现 IEnumerable`<T>`和 Add(T) 方法就足够了。

然后这可以通过一个私有队列来实现（或者 Deque 会更好，但是这样的集合需要一些其他集合 API，我不建议你尝试自己实现一个），在 Add 期间你 Enqueue() （使用 Dequeue 的 if需要保持大小）。

请注意，实现 IEnumerable 并提供 Add 方法意味着您仍然可以在需要时使用 Collection 初始化程序语法。

如果您需要随机访问这些值，那么实现索引器可能是一个好主意，但如果没有更多关于该问题的上下文，我看不出这会给您带来什么好处。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-08-01T13:33:04.120

如果使用显式接口实现，它实际上可以完成。

```
public class SampleClass<T> : IList<T>
{
    ...
    void IList<T>.Add(T item) { ... }
    public int Add(T item) { ... }
    ...
} 
```

然后调用，比如

```
IList<T> sample = new SampleClass();
int index = sample.Add(someStuffGoesHere); // new Add method is called 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-19T18:38:40.230

您可以尝试扩展`System.Collections.ObjectModel.Collection<T>`，这更加灵活。然后，您可以覆盖受保护的成员`InsertItem`和`SetItem`, 来自定义集合的行为。

# javascript - 用 javascript 改变 CSS 类属性？

> ID：580216
> 
> 赞同：6
> 
> 时间：2009-02-24T02:16:32.083
> 
> 标签：javascript, css

我定义了一个 CSS 类，称之为：

```
<style type="text/css">
.Foo { position: fixed; left: 50px; top: 50px; }
</style> 
```

我在屏幕上绝对定位一个元素。在我的网页执行过程中，我创建和删除了许多元素并赋予它们 class `Foo`。当我调整浏览器的大小时，我想更改类上的`left`and`top`值，以便*所有*元素`Foo`的位置都因计算而改变。 *`Foo`*

 *我不想简单地更改样式表，我想计算一个值并使所有当前和未来的`Foo`元素都具有新的计算值`left`和`top`值。

这个网站有一个例子，但代码相当复杂。 [http://www.shawnolson.net/a/503/altering-css-class-attributes-with-javascript.html](http://www.shawnolson.net/a/503/altering-css-class-attributes-with-javascript.html)

有没有一种好的、干净的方法来基本上以编程方式改变`Foo`定义的内容？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T02:20:23.663

我认为这就是你想要的：

```
<script>
var style;
function changeFoo(left, top) {
    if(typeof style == 'undefined') {
        var append = true;
        style = document.createElement('style');
    } else {
        while (style.hasChildNodes()) {
            style.removeChild(style.firstChild);
        }
    }
    var head = document.getElementsByTagName('head')[0];
    var rules = document.createTextNode(
        '.Foo { left: ' + left + 'px; top: ' + top + 'px; }'
    );

    style.type = 'text/css';
    if(style.styleSheet) {
        style.styleSheet.cssText = rules.nodeValue;
    } else {
        style.appendChild(rules);
    }
    if(append === true) head.appendChild(style);
}
</script> 
```

此代码是根据[此问题](https://stackoverflow.com/questions/524696/how-to-create-a-style-tag-with-javascript/524717)中提供的答案修改的，该答案与您提出的问题非常相似。每当您需要更改所有 .Foo 元素的位置时，您只需调用 changeFoo(newLeftValue, newTopValue); - 第一次将创建`<style>`元素并将其添加到`<head`文档的 >。后续调用只会清空`<style>`已添加的元素并添加新规则。

# java - 从嵌套的 Java ActionListener 内部调用它

> ID：580228
> 
> 赞同：5
> 
> 时间：2009-02-24T02:28:19.543
> 
> 标签：java, user-interface, swing, actionlistener

假设我有这个：

```
class external {
    JFrame myFrame;
    ...

    class internal implements ActionListener {
        public void actionPerformed(ActionEvent e) {
             ...
             myFrame.setContentPane(this.createContentPane());
        }
    }
    ...
} 
```

`createContentPane`返回一个容器。现在，如果我在外部执行此代码，`ActionListener`它将起作用，因为我可以访问它。但是，在里面，我没有。我可以访问`myFrame`，这将使用方法的内容进行更新，但这还不足以做我想做的事情，除非我能从中得到这个。

我还需要来自其他实例变量的信息才能使用`createContentPane()`，所以我不确定我是否能做到`static`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T02:33:48.890

您可以：

```
myFrame.setContentPane(createContentPane()); 
```

或者

```
myFrame.setContentPane(external.this.createContentPane()); 
```

顺便说一句，在 Java 类中，第一个字母通常是大写的。如果您不这样命名，您的代码仍然可以编译和运行，但是通过遵循编码约定，您将能够阅读其他代码，更重要的是其他人将能够阅读您的代码。

所以这将是一个更好的风格：

```
class External {
    JFrame myFrame;
    ...

        class Internal implements ActionListener {
            public void actionPerformed(ActionEvent e) {
                ...
                myFrame.setContentPane(createContentPane());
               //Or myFrame.setContentPane(External.this.createContentPane());
            }
        }
    ...
 } 
```

[Java 代码约定](http://java.sun.com/docs/codeconv/html/CodeConvTOC.doc.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T02:32:13.153

`external.this`将让您访问封闭类的实例，如果这是您想要的...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T02:32:04.777

不确定您到底在做什么，但是内部类可以访问其封闭类的所有成员。要访问封闭类的“this”指针（例如，传递给其他方法），请使用：

```
someMethod(External.this); 
```

在您的示例中，您实际上是通过使用“this”使其复杂化。以下是两个可行的选项：

```
myFrame.setContentPane(createContentPane()); 
```

或者：

```
myFrame.setContentPane(External.this.createContentPane()); 
```

请注意，您已经在以相同的方式访问 myFrame。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T11:39:03.000

首先，您必须像这样在外部类中扩展 JFrame

```
class External extends JFrame {
.....
.....
} 
```

# c++ - 64位环境中的成员变量指针

> ID：580229
> 
> 赞同：1
> 
> 时间：2009-02-24T02:29:06.887
> 
> 标签：c++, visual-studio-2005, 64-bit

我在尝试使用 luaBind 样式的类绑定系统时发现，在编译为 64 位应用程序时，传递指向成员变量的指针似乎无法正常工作。具体来说：

```
class Foo {
    int a;
    int b;
}; 
```

上面的类在 32 位中获取 &Foo::b 将返回（如预期的那样）0x00000004。同样的64位调用返回0xCCCCCCCC00000004，即正确的32位和WTF的32位。

我的第一个想法是这是编译器中的一个错误（我在 Vista 64 Business 上使用 Visual Studio 2005 SP1），但这对于自豪地声称具有 64 位兼容性的 IDE 来说似乎是一个相当大的错误。谷歌搜索没有任何结果（但我可能使用了错误的术语。成员变量指针？有人愿意纠正我吗？），所以我很好奇这只是我还是一个更普遍的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T03:01:26.700

尝试打印`sizeof(&Foo::b)`。

IIRC，在 64 位 VS2005 中，指向成员的指针可能占用 4 或 12 个字节（取决于虚拟/多重继承），但 IDE 始终显示 8 个字节（这（恕我直言）是 IDE 中的一个错误）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T02:45:52.823

指向成员的指针不一定像您想象的那么简单。考虑：

```
#include <iostream>

struct Foo {
    int a;
};

struct Bar {
    int b;
};

struct Baz : public Bar, public Foo {
    int c;
};

struct Quux : public Bar {
  int d;
};

int main() {
  Baz x;
  x.a = 10;
  int (Foo::*ptr) = &Foo::a;
  using namespace std;

  cout << x.*ptr << endl;
  return 0;
} 
```

您真的不应该在指向成员的指针中“期望”任何特定的位模式。他们可能指向一个重击，他们可能是一个偏移量，谁知道呢。同样在 64 位的情况下，您确定在打印时指向成员的指针是 64 位吗？指向成员的指针不必与其他指针的大小相同（而且通常不是）。

这篇[文章](http://blogs.msdn.com/oldnewthing/archive/2004/02/09/70002.aspx)也可能很有启发性，尽管它主要处理指向成员函数的指针。

# stored-procedures - 在存储过程中删除

> ID：580231
> 
> 赞同：0
> 
> 时间：2009-02-24T02:30:00.083
> 
> 标签：stored-procedures

我的删除查询不能有条件地工作，它会从 tne 表中删除所有记录

```
PROCEDURE          "SP_NEW"    (
logon_id        IN  VARCHAR2,
id      IN  VARCHAR2,
key     IN  VARCHAR2,
error_code      OUT NUMBER,
error_message       OUT VARCHAR2)

...
PROCEDURE delete_counts(str_logon_id IN VARCHAR2)
IS
BEGIN
    DELETE FROM TMS_ENTITY_COUNT WHERE logon_id = str_logon_id;
END;

BEGIN;

delete_counts(logon_id);

END; 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T02:41:57.763

没有足够的信息继续下去，但我可以做出几个猜测。

*   是否`TMS_ENTITY_COUNT`有两个名为`logon_id`and的列`str_logon_id`？他们总是平等的吗？
*   根据您的 SQL 风格，您是否需要在变量名之前使用 @ 或 : 符号，如?`...WHERE logon_id =`**`@`**`str_logon_id`

# database - 设计数据库时最重要的考虑因素是什么？

> ID：580233
> 
> 赞同：25
> 
> 时间：2009-02-24T02:31:41.033
> 
> 标签：database, database-design

我想从经验丰富的程序员那里了解他们在设计新数据库时认为最重要的考虑因素。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-24T02:40:16.893

首先也是最重要的学习和理解业务领域。

1) 您是在寻找像繁忙的网站那样的高交易率，还是像小公司 HR 系统那样的低使用率

2) 安全性是一个大问题吗？您是在处理个人详细信息还是财务数据。或者它只是一个产品目录

3）你的用户会做很多更新/插入还是主要是只读的

4）有多少用户，使用模式是什么（峰值负载或均匀分布）

5) 您是否需要 24x7、16x5 或其他正常运行时间，24x7 更难做到，因为您没有停机时间进行维护

6) 数据库有多大？如果它真的很大，你将不得不设计你的表来考虑那个和/或分区

7）您需要查看具有热故障转移的企业集群，还是只是普通托管

8）如何管理数据库，在大多数数据库项目中，95% 的精力都花在为用户及其应用程序开发上，忘记了数据库管理员

9) DB Admin，从以前包括备份、对其他系统的更改、与其他系统的集成、数据加载

10）实际上数据加载和使用现有数据本身就是另一个大问题。

这是一个开始

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-24T02:43:21.753

**数据库对于您的业务流程设计是次要的，并且应该以直接和简单的方式干净地支持您的业务流程。**您将从结构良好、干净的实体模型中获得的好处远多于从各处索引中获得的好处。因此，一旦定义了您的流程，您就可以将其分解为尽可能干净的“实体”，并具有有意义的关系。一旦你知道你的实体，它们就会转换成数据库表。

要做的最重要的事情之一是不要过度架构。

为了给你一些答案，我们以一个“车辆”实体为例。一辆车有多个轮子。您需要做出一个关键决定，即知道车辆上将连接多个轮子。您有 2 个选择 - 您可以将“车轮”设为单独的实体，或者您可以将“车轮数”设为“车辆”实体中的整数字段。

如果您*绝对知道*您将需要存储有关每个轮子的大量变化信息，则创建一个“轮子”实体。您现在在实体（汽车和车轮）之间建立了关系。

如果没有，一个简单的字段就可以了。

在设计数据库时，对我而言，考虑这些关键决策并使事情尽可能简单是迄今为止最重要的事情。当您构建应用程序的下一层时，它可以使事情变得非常容易和非常困难。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-24T13:42:56.443

1 - 一致性

随着时间的推移，您的数据库将发生变化，其他人将需要使用它。帮自己和他们一个忙，并确保结构的命名方式使得任何具有基本领域知识的理性人都能够预测表格的内容。花点时间写下（可以是简单的记事本）你使用的一些基本结构。

例子：

*   主键都以 IdTableName 开头
*   表名的大小写是 Pascal
*   外键都是TableNameId
*   分机...

只要您在使用或不使用它们的方式上保持一致，您是否选择使用下划线（用任何其他转换替换下划线）在一天结束时并不重要。

您的数据库是数据完整性的最后一道防线。通过存储过程进行所有数据访问，并通过使用检查约束、外键等强制数据的完整性。正确键入数据，当 CHAR(5) 更具体和准确时，不要使用 VARCHAR(50)。

其他人提到了一些关于保持简单的事情。最后但并非最不重要的一点是，不要因为你“认为”下个月需要它而构建一些东西。事情变化很快，你最终会对你“认为”你将要使用的东西进行更多的维护，而不是你正在使用的东西，如果你填满你的数据库，这些东西将毫无用处。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-24T02:34:10.963

与数据库应该建模的真实世界实体的保真度。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-24T02:38:20.767

我个人建议拿起或借用一本“为凡人设计的数据库”。您在设计数据库时需要考虑的所有内容都将在该书中列出，并且您可以按照非常有条理和合乎逻辑的顺序构建数据库。Table 和 Column 的定义很乏味，但最终值得每一分钟使用。

如果这本书通过 Google 图书或通过 Amazon.com 上的页面预览，我相信您可能能够阅读第一章。

您可以随着时间的推移或从该站点学习一些花絮作为“最佳实践”，但没有什么比在第一次尝试时以正确的方式从头开始设计它更好的了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-24T02:52:43.167

一组基本点：

*   确定系统的用途。
*   确定您的系统需要的实体。
*   确定每个实体应提供哪些信息。
*   确定实体之间的现有关系
*   用户想知道什么以及如何处理您的数据。
*   概念和逻辑数据库设计
*   归一化和 ERD
*   识别具有唯一值的字段。
*   为您的字段选择适当的数据类型。
*   数据库重构。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-24T03:55:07.290

了解您的数据。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T03:33:27.593

您还必须了解数据库的用途。如果是针对事务（OLTP），应该尽可能规范化，目标是让事务尽快完成。如果它用于分析和/或报告 (OLAP)，则应在您将执行聚合的许多地方对其进行非规范化。OLTP 数据库的设计注意事项不适用于 OLAP 数据库，反之亦然。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T04:35:07.427

谁将构建和维护它，在哪里，如何以及使用什么。你有方法、程序和流程来做这件事还是只是临时做。当然，业务需求驱动所需的数据，这些数据应在独立于实施的 ERD 中捕获。但是，您还必须考虑随着时间的推移谁将维护数据。以及谁“拥有”数据。谁拥有实体和属性定义。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-24T13:31:30.977

信息需求是最重要的部分。

这是 CMS 提供的回复中“确定系统用途”的另一种说法。

概念数据建模只是收集和呈现信息需求的一种有组织的方式。数据库存储和提供的每个值都连接到一个属性，每个属性都连接到一个域。反过来，属性描述实体或实体之间的关系。主题实体和关系构成了数据描述的“现实世界”的概念结构。从概念模型构建 ERD 很容易，尽管很乏味。

之后，您可以选择一个 DBMS，设计逻辑数据库，设计物理数据库，然后构建。由于数据独立性，在每一步中，您做出的决定都更加可逆。数据独立性将设计决策封装在数据库内部，性能后果除外。当然，您必须了解您的工具。

拥有用于管理模型并将其转换为图表和脚本的工具对于加快此过程并减少错误非常有帮助。

但是，如果您的信息需求中有严重的错误或遗漏，再多的巧妙设计或实施也无法弥补这一点。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-25T20:41:20.203

一个好的数据库可以判断如下：

*如果数据库设计得当，您应该能够通过查看架构来了解业务的运作方式。*

换句话说，数据库*就是*业务。如果数据库不能反映业务的运行方式，则要么是数据库错误，要么是业务错误。

数据库也是您真正需要预先确定的少数几件事之一。您总是可以修复错误的代码，但很少能从错误的架构更改中退出。确保做对了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-25T22:11:08.870

*   命名约定：遵守一套规则
*   规范化：（规范化程度） - 这将取决于数据实体的读取次数与更新次数的比较。
*   关系完整性和其他限制：有些人提倡使用外键，而有些人不提倡，但你必须根据你的要求和个人喜好来选择，因为这是一个很大的争论，但我总是会选择使用外键
*   如果可能，创建数据库图表，与团队进行分析和讨论。

# asp.net - 更改客户端问题中的隐藏字段

> ID：580236
> 
> 赞同：0
> 
> 时间：2009-02-24T02:32:16.693
> 
> 标签：asp.net, javascript, html, dom

我有一个隐藏字段，我在使用 Javascript 提交表单之前更改了值。但在服务器端它为空或空。Request.Form["hidAction"] 为空。

```
<script type="text/javascript" language="javascript">

    function DoChange() 
    {
        document.getElementsByName('hidAction').value = "filter";
        alert(document.getElementsByName('hidAction').value);
        document.forms[0].submit();
    }
 </script>
<body>
    <form id="form1" runat="server">
       <div>
            <select name="lst" onchange="DoChange();">
                <option value="1">1</option>
                <option value="2">2</option>
            </select>
       </div>
       <input type="hidden" id="hidActionID" name="hidAction" value="tt" />
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T02:36:43.390

`document.GetElementsByName`返回一个元素数组，即使只有一个。为什么不使用`document.GetElementById`并为隐藏的输入分配一个 ID？那应该工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T04:26:08.927

我会以不同的方式做你正在做的事情，但是假设页面上只有一个元素的名称属性为“hidAction”，那么你可以这样做：

```
function DoChange() 
{
    document.getElementsByName('hidAction')[0].value = "filter";
    alert(document.getElementsByName('hidAction')[0].value);
    document.forms[0].submit();
} 
```

你也可以这样做，假设页面上只有一个表单：

```
function DoChange() 
{
    document.forms[0]['hidAction'].value = "filter";
    alert(document.forms[0]['hidAction'].value);
    document.forms[0].submit();
} 
```

当您回发时， Request.Form["hidAction"] 现在不应为空。

# c# - 如何处理 ColorMatrix 溢出？

> ID：580244
> 
> 赞同：2
> 
> 时间：2009-02-24T02:35:20.697
> 
> 标签：c#, gdi+, colormatrix

在开始之前，我使用的是 C#。我想使用 ColorMatrix 类做一些变换。问题是有时 r、g 或 b 会发生溢出。矩阵没有将值限制在 255，而是循环并再次从 0 开始。这意味着，对于应该显示为全白的图像，它们又开始变黑。我正在使用它来模拟线扫描相机在不同线速率下的强度。有谁知道解决这个问题的方法？

顺便说一句，我确实有其他方法，我可以自己做矩阵变换，但我对这个特定问题的解决方案更感兴趣（如果有的话）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T10:00:40.750

我也遇到过这个问题，如果有人知道解决方法会很好。我采取了丑陋的变通方法，例如：

```
 float[][] matrixContrastFix =
        {
            new float[] {    1,     0,     0, 0, 0},
            new float[] {    0,     1,     0, 0, 0},
            new float[] {    0,     0,     1, 0, 0},
            new float[] {    0,     0,     0, 1, 0}, 
            new float[] {-.05f, -.05f, -.05f, 0, 1}
        }; 
```

（我将很多 ColorMatrix 相乘，最终得到这些东西。）

但正如我猜你所说的*其他方法*，使用 .LockBits 并自己做可能会更好。

希望你得到比我更好的答案！

# c - 单元测试过程代码时删除依赖项

> ID：580247
> 
> 赞同：0
> 
> 时间：2009-02-24T02:36:24.797
> 
> 标签：c, unit-testing

在具有继承和虚函数的面向对象语言中，从单元测试代码中删除依赖项（例如数据库、API 调用等）可以简单到将这些依赖项封装在它们自己的方法中，然后在继承的测试类中覆盖这些方法从要测试的类。

但是，在尝试对过程代码（特别是 C）做类似的事情时，我遇到了一个问题。如果没有继承，我将无法覆盖这些调用，那么在对过程代码进行单元测试时，如何提供类似的依赖删除？

一种选择是提供对这些依赖项的调用的替代方法并用`#ifdef`s 将它们括起来，但理想的方法是让单元测试应用于与最终构建相同的代码。这可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T02:47:47.920

[开始有效地使用遗留代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)并阅读标题为“我的应用程序是所有 API 调用”的章节。

基本上，Feathers 描述了两个选项：

“链接器接缝”：您可以为您尝试存根的 API 调用编译一组不同的实现，而无需更改代码 - 基本上更改 makefile/.sln 以在函数的不同实现中编译。

如果这不起作用，他谈到“皮肤和包装”，您基本上将所有 API 函数移动到一个抽象基类中，创建两个派生类 - 一个生产和一个单元测试实现，并将调用转发到适当的方法- 然后使用依赖注入来传递适当的函数集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T02:40:24.943

条件编译会起作用，我以前自己做过。不过需要纪律，因为它可能会变得很诱人，说“那一点太难测试了”然后就不去测试了。

如我所见，另一种选择是构建这些库的特殊测试版本，其中包含您的 DB/API 调用（它们在库中，不是吗？）。测试版本可以维护相同的接口（显然是一个手动过程，因为您没有要继承的对象/接口），但会调用您的单元测试框架并可以通过您的单元测试框架进行查询。我为创建 FitNesse 版本的库做了类似的事情，我认为它没有理由不能用于单元测试。

缺点是每个被测对象都需要单独的可执行文件和编译，但取决于您的测试框架，无论如何可能都是这种情况。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T03:08:18.807

我经常遇到这个问题，这是我在编写/维护测试套件方面落后的最大原因之一。在某些情况下，条件编译会有所帮助，但并非总是如此。

例如，如果套件应该围绕较低级别的接口测试包装器以与管理程序对话，您需要在管理程序下测试套件..或者编写一堆聪明的宏/内联函数来“伪造”管理程序实际上根本没有测试任何东西。

在使用遗留 dbms API 或典型的 acme 小部件 API 时，这样做会更容易一些。

对于遗留测试，我**强烈建议从**[ccan](http://ccan.ozlabs.org/list.html)下载 tap（测试任何协议）并保持这些测试隔离。

通常，我 80% 的测试都必须像这样包装，维护起来**非常乏味和令人沮丧。**希望你只有几个怪人要对付。

直到有人写了一些魔杖从理智的评论中提取测试条件和参数，你才会被困在同一张纸上。

祝你好运，我真的很同情。

# java - Java泄漏抽象检查器

> ID：580249
> 
> 赞同：4
> 
> 时间：2009-02-24T02:37:49.097
> 
> 标签：java, devtools, lint

我正在考虑编写一个程序来检查 Java 中的“泄漏抽象”的想法。立即想到的一个领域是例外：

```
public class X
{
    // this one is fine, Readers throw IOExceptions so it is 
    // reasonable for the caller to handle it
    public void parse(final Reader r)
        throws IOException
    {
    }

    // This one is bad.  Nothing in the API indicate that JDBC 
    // is being used at all.
    public void process()
        throws SQLException
    {       
    }
} 
```

请注意，我不希望对已检查/未检查异常的相对优点进行争论。我正在寻找的是人们拥有的其他示例（不一定是异常处理），这些示例也可以通过检查源代码或类文件来合理地捕获。

我知道 checkstyle、findbugs 和 PMD，而 AFAIK 都没有处理这个问题（我不反对将检查放入其中一个工具中，而不是自己编写）。

您是否想到了其他可以静态检查的泄漏抽象示例？

编辑：

第二个不好的原因是该方法抛出了一个异常，客户端无法知道正在使用 JDBC（例如，它可能是任何东西）。因此，“泄漏抽象”是正在使用 JDBC。如果底层机制更改为其他东西（例如 JPA，它是一个不同的数据库抽象库），那么异常也都需要更改。所以底层数据库库被泄露了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T03:32:44.973

由于我没有在原始帖子中发现问题，因此我会漫无目的。

任何此类工具都必须让用户告诉它哪些异常符合给定类的非泄漏，并且任何不在此类列表中的东西都将是泄漏。

那只是例外。据我了解，泄漏抽象适用于更多。考虑一下：

```
class Client
{
    private Integer ID;

    public Integer ID() { return this.ID; }
} 
```

这是否符合泄漏的条件？如果以后我需要将 ID 表示为 Long，那就可以了。您可能会修复这样的场景：

```
class Client
{
    private ClientID ID;

    public ClientID ID() { return this.ID; }
}

class ClientID
{
    private Integer value;

    public ClientID(String id) { this.value = Integer.parseInt(id); }

    public String asString() { return value.toString(); }

    ... other methods that don't reveal value's type here ...
} 
```

这将解决客户端的泄漏，但现在您将在 ClientID 上运行您的工具。是否漏水？

如果您必须检查不是简单 getter 的方法，这可能会变得更加复杂。如果 ClientID 有一个方法可以对其 ID 进行一些数学运算（请原谅我）并返回一个 Integer。那是泄漏吗？这是否有资格泄漏该值是一个整数？

所以我不确定这是否是机器可以轻易捕捉到的代码气味。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T04:11:26.657

所以。

如何检测 API 是否泄漏了实现细节或没有保持相同的抽象级别。

你可能会看[这个谈话](http://www.youtube.com/watch?v=aAb7hSCtvGw)。它解释了好的 API 的外观和设计（您可以从好的实践中推断出哪些是不好的实践）

例如

> *功能应该很容易解释。如果它是一个硬名称，它通常是一个糟糕的设计。*

从中您可以发现，如果方法或返回参数提供详细说明，它们与抽象级别不符。

例如高级方法

```
 -initProcess(): SGN_MTL 
```

可能会泄露返回值的实现细节。

这里的难点是检测抽象级别何时发生变化。

例如，在您的方法中，如果它自己的代码是 JDCB 层的实现，则可以到处抛出 SQLExceptions。

您可以看到更多这些主题的其他来源是此列表。 [http://www.jetbrains.com/idea/documentation/inspections.jsp](http://www.jetbrains.com/idea/documentation/inspections.jsp)

请参阅“抽象”下的项目，即。

*   具体类的实例变量：当实例变量的类型声明为具体类而不是接口时报告。

经典的例子是：

```
 private ArrayList list; 
```

什么时候会好

```
 private List list; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T02:48:58.480

您可以考虑扩展您的示例以检查是否违反了[Liskov Substitution Principle](http://en.wikipedia.org/wiki/Liskov_substitution_principle)。有些人会说实现接口的类应该只抛出与接口定义的相同的异常。

如果您可以分析对象的用法，建议可以使用更通用的类型（例如，该方法需要 SQLConnection，而 IDBConnection 可以）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T20:05:58.020

又想到了一个。拥有一个处理非公共类型的公共成员。

```
class Foo { ... } // 本地包

公共课吧
{
    类汽车（）{...}

    公共酒吧（Foo f）{ ... }

    公共汽车之星（）{ ... }
}

```

酒吧和明星会漏水。您可以看到 Bar 构造函数 b 但只能从与 Bar 类相同的包中调用它。可以调用星号方法，但只能将返回值作为对象使用。

对于这两种情况，您会看到您需要考虑将成员设为私有或包访问或将类型设为公共。

# orm - 企业解决方案中的 ORM 采用？

> ID：580255
> 
> 赞同：3
> 
> 时间：2009-02-24T02:40:20.760
> 
> 标签：orm

我觉得 ORM 在普通网站领域比在银行或 B2B 商务网站等企业环境中更成熟，也更容易被接受。我的印象正确吗？如果是，有什么理由会这样吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T02:53:42.943

在大多数企业情况下，数据是公司的生计。如果这些数据变坏，人们就会失去工作。因此，在大多数企业情况下，都有一个团队致力于确保数据模型是可靠的，以有限的方式访问数据，以及其他与数据相关的一切顺利运行。这些人通常只会说 SQL。因此，他们更愿意提供一套存储过程供您使用，而不是允许您对数据库进行临时查询。

这种情况的变化发生得非常缓慢，而且 ORM 工具仍然是一种相对较新且（在许多数据专家眼中）未经证实的技术。因此，在许多企业情况下，您的数据层确实可能不涉及 ORM。

然而，这并不是说这是一个普遍的真理。我在企业商店中看到了一些涂油非常好的 ORM。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T02:44:04.433

我知道很多使用 ORM 的“企业”网站。Hibernate 实际上是“企业”的定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T03:01:17.717

I once interviewed at a firm in NYC that almost exclusively used NHibernate, and their clients were some of the biggest Investment Banks on Wall street. (It's hard not to make jokes no, but you get the point).

So I would say that there are a lot of pretty hardcore places that use NHibernate.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T02:45:19.440

我认为这真的取决于特定的业务。我会说对于主要应用程序，这可能在一个新的大开发周期之前通常是正确的，但这仅仅是因为应用程序或基础设施已经以某种方式开发，并且将其更改为任意点并不是一件容易的事。然而，根据我的经验，大多数银行机构都落后于主流，因为他们更愿意采用经过验证的技术，而不是跟风。

# c# - 结构如何从类型参数约束中的类继承？

> ID：580257
> 
> 赞同：4
> 
> 时间：2009-02-24T02:41:09.293
> 
> 标签：c#, .net, memory-management, type-parameter

我看到以下代码行：

```
class Sample<T,U> where T:class where U: struct, T 
```

在上面的例子中，参数`U`是*值类型*，它派生自*引用类型* `T`。

那条线怎么可能合法？
此外，如果值类型继承自引用类型，内存分配在哪里：堆还是堆栈？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T07:29:28.867

与另一个答案相反，除了 T=System.Object 之外还有其他类型可以编译：

```
class Samplewhere T:class where U:struct, T 
```

“T : class”约束实际上并不意味着 T 必须是一个类。这意味着 T 必须是引用类型。这包括接口，结构可以实现接口。因此，例如，T=IConvertible, U=System.Int32 效果很好。

我无法想象这是一个特别常见或有用的约束，但它并不*像*乍一看那样违反直觉。

至于更普遍的观点：正如 Obiwan Kenobi 所说，这完全取决于您的观点。CLI 规范对此有相当复杂的解释，其中“派生自”和“继承自”并不意味着完全相同的东西，IIRC。但是不，您不能指定值类型的基本类型 - 它始终是`System.ValueType`or `System.Enum`（派生自`System.ValueType`），并且根据您是声明 a`struct`还是 a来选择`enum`。这两者本身就是引用类型，这有点令人困惑......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T02:56:54.950

所有结构都隐式地派生自 ValueType 类型。您不能指定显式基类型。
请[参阅](http://msdn.microsoft.com/en-us/library/aa288471(VS.71).aspx)由`codemelt`.

*   当您将结构实例化为局部变量时，它们会在堆栈上分配（更好的性能）
*   类可能包含结构作为成员——在这种情况下，它们被分配在堆上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T02:48:58.337

MSDN 说，

> 结构没有继承，就像类一样。一个结构不能从另一个结构或类继承，也不能是一个类的基础。然而，结构从基类对象继承。结构体可以实现接口，它的实现方式与类完全一样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T03:26:02.930

> **萨沙写道：**
> 
> 如果不允许继承，那么为什么以下合法：
> 
> 类 Samplewhere T:class where U:struct, T
> 
> 在上面的例子中，参数 U 是值类型，它派生自 T -- 引用类型

尽管从通用合同的角度来看这是合法的，但您永远不会获得使用该类进行编译的任何有用代码，因为您永远不会拥有满足 U 约束的 T=System.Object 以外的类型。您可能会认为这是在 C# 中实现泛型的一个非常小的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T02:54:20.557

结构不能从 System.ValueType 或 System.Enum 以外的任何东西继承。结构无法从普通引用类型继承。所以不幸的是，这个问题无法回答。

# c++ - Windows API 和 GetClassName()？另一个名字？

> ID：580263
> 
> 赞同：4
> 
> 时间：2009-02-24T02:44:34.760
> 
> 标签：c++, windows, api-design

我有一些代码在 C++ 中有一个动态类系统，它有一个名为 GetClassName() 的成员，这是一个可以想象的相当无害的名称。然而，当包含在一个带有 Windows 标头的大型项目中时，一切都乱了套。显然，Windows 使用了 #define GetClassName（GetClassNameA 或 GetClassNameW），它搞砸了一切，我的虚拟调用树变得一团糟，让我在黑暗中愚蠢的编译器调试中浪费了一天，试图找出问题所在。

因此，除了我在诅咒微软为#define 使用如此可怕的容易冲突的名称（我的意思是应该诚实地为此开枪！）之外，我要求 3 个目的。

1.  GetClassName() 的另一个好名字是什么？
2.  有没有办法解决这个问题，所以将来我的代码库的其他开发人员不会遭受类似的命运
3.  当其他人遇到这种类似莫名其妙的错误时，为了后代

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T02:50:24.967

1.  `ClassGetName()`
2.  `#undef GetClassName`
3.  WinAPI 是一个 C API。没有命名空间。其他一些平台试图通过为所有符号名称添加前缀来缓解这种情况，但最终也分崩离析。最好的选择：如果您编写的代码不依赖于 Windows 平台 SDK 标头，*那么不要`#include`使用*.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T05:20:10.517

我会重命名该方法。

当然可以说

```
#include <windows.h>
#undef GetClassName 
```

但它并不干净，代码的用户在调用win32函数时记得写::GetClassNameW。

可以在他的类中提供 GetClassNameA 和 GetClassNameW 方法，但这很丑陋。

我看到两种方法：延长或缩短名称:)

1）为子系统中的所有功能添加前缀，fe TI_（用于类型信息）：

```
TI_GetClassName() 
TI_GetBaseClass() 
TI_IsDerivedFromClass()
etc 
```

2）或将它们放入一些 IClass 接口中

```
interface IClass {
GetName();
GetBase(); 
IsDerivedFrom();
etc 
```

并从单个方法返回该接口，
以便 GetClassName() 变为

```
GetClass()->GetName() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T02:51:58.660

GetWindowClassName 也许？实际上，GetClassName 对这个 API 来说并不是一个坏名字，因为它与窗口类有关。真正的问题是它是一个 C API 声明，而 C 声明无法引入一个不会污染全局命名空间的可重用声明。

这更像是 C 语言的失败，而不是微软。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T03:03:40.737

Windows API 充满了具有干净名称的宏，这些宏扩展为带有表示 ASCII/UTF-16 后缀的函数名称，具体取决于构建选项。如果他们在所有内容前加上“W32”或类似的前缀（在 OS X 上是“NS”），那就太好了，但他们选择不这样做可能是为了保持 API“干净”。

由于更改代码比更改 API 容易得多，因此这里有一些建议：

1）学习Windows API（其实没那么大！），或者至少熟悉[MSDN](http://msdn.microsoft.com)，这样在遇到莫名其妙的程序流程时，可以查找名称冲突。

2) 在代码中尽可能使用显式范围解析（MyClass::GetClassName()）。不幸的是，这会破坏虚函数调度，所以要小心。

3) 在您的代码中使用不同的命名约定。MS 始终使用 CamelCase，因此如果您选择其他约定（get_class_name()、getClassName() 等），您不会发生冲突。

4) 就个人而言，我讨厌将我的 getter 和 setter 命名为“GetX()”和“SetX()”，但更喜欢依赖重载机制并使用“xtype X() const”作为 getter 和“void X(xtype newval)” “对于二传手。您的里程可能会有所不同，但我发现它更清晰，并且 get/set 从参数中显而易见。显然，如果您使用默认参数，则必须小心。

祝你好运！

# java - 通过 ArrayList 的反向迭代给出 IndexOutOfBoundsException

> ID：580269
> 
> 赞同：33
> 
> 时间：2009-02-24T02:46:05.070
> 
> 标签：java, arraylist, iteration, reverse

当我对 ArrayList 进行反向迭代时，我得到了 IndexOutOfBoundsException。我尝试进行前向迭代，没有问题。我期望并且知道列表中有五个元素。代码如下：

```
Collection rtns = absRtnMap.values();
List list = new ArrayList(rtns);
Collections.sort(list);

for(int j=list.size();j>0;j=j-1){
  System.out.println(list.get(j));
} 
```

* * *

前向迭代 - 工作正常，但对我没有用：

```
for(int j=0;j<list.size();j++){
    System.out.println(list.isEmpty());
    System.out.println(list.get(j));
} // this worked fine 
```

* * *

错误：

```
Exception in thread "Timer-0" java.lang.IndexOutOfBoundsException: Index: 3, Size: 3
    at java.util.ArrayList.RangeCheck(Unknown Source)
    at java.util.ArrayList.get(Unknown Source)
    at model.Return.getReturnMap(Return.java:61)
    at controller.Poller$1.run(Poller.java:29)
    at java.util.TimerThread.mainLoop(Unknown Source)
    at java.util.TimerThread.run(Unknown Source) 
```

此外，如果有人知道反向迭代的更好习语，我很乐意尝试一下。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-06-30T13:08:26.430

完全避免索引？怎么样：

```
for (ListIterator iterator = list.listIterator(list.size()); iterator.hasPrevious();) {
  final Object listElement = iterator.previous();
} 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-02-24T02:47:53.333

开始迭代，`list.size() - 1`因为数组（或`ArrayList`）元素的编号从 0 到 1 小于列表的大小。这是一个相当标准的成语：

```
for (int j = list.size() - 1; j >= 0; j--) {
    // whatever
} 
```

请注意，您的前向迭代有效，因为它在到达*之前*`list.size()`停止。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2011-07-04T18:52:08.740

我知道这是一个老问题，但 Java 包含一个`Collections.reverse( List<T> )`方法。为什么不直接反转它并进行前向迭代？

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-08-29T18:33:35.930

最优雅的方法是反转数组，然后使用直接（甚至隐式）迭代器：

```
Collections.reverse(arrayList);
for (Object item : arrayList) {
    ...
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-24T02:48:19.230

list.size() 超过了最后一个允许的索引。

```
for(int j = list.size() - 1; j >= 0; j--) {
  System.out.println(list.get(j));
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-24T02:48:19.197

Java 数组是零索引的。您必须设置 j = list.size() - 1 并继续直到 j = 0。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-05-27T08:44:16.340

如果列表相当小以至于性能不是一个真正的问题，可以使用-class in的`reverse`-metod 。产生漂亮的代码，并且原始列表保持不变。此外，反向列表由原始列表支持，因此对原始列表的任何更改都将反映在反向列表中。`Lists``Google Guava``for-each`

```
import com.google.common.collect.Lists;

[...]

final List<String> myList = Lists.newArrayList("one", "two", "three");
final List<String> myReverseList = Lists.reverse(myList);

System.out.println(myList);
System.out.println(myReverseList);

myList.add("four");

System.out.println(myList);
System.out.println(myReverseList); 
```

产生以下结果：

```
[one, two, three]
[three, two, one]
[one, two, three, four]
[four, three, two, one] 
```

这意味着 myList 的反向迭代可以写成：

```
for (final String someString : Lists.reverse(myList) {
    //do something
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-29T18:12:25.813

您可以反转一行，即

**Collections.reverse(list);**

```
ArrayList arrayList = new ArrayList();

arrayList.add("A");
arrayList.add("B");

System.out.println("Before Reverse Order : " + arrayList);

Collections.reverse(arrayList);

System.out.println("After Reverse : " + arrayList); 
```

**输出**

```
Before Reverse Order : [A, B]
After Reverse : [B, A] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-06-09T17:21:43.587

如果您对 foreach 循环感到满意，则可以这样做。

```
List<String> list = new ArrayList<String>();
list.add("ABC");
list.add("DEF");
list.add("GHI");

ListIterator<String> listIterator = list.listIterator(list.size());

while(listIterator.hasPrevious()){
  System.out.println(listIterator.previous());
} 
```

# c++ - 避免 dynamic_cast/RTTI

> ID：580270
> 
> 赞同：8
> 
> 时间：2009-02-24T02:47:08.560
> 
> 标签：c++, casting

我最近正在为一个附带项目（[`cpp-markdown`库](https://sourceforge.net/projects/cpp-markdown/)，对于好奇的人）编写一段 C++ 代码，并遇到了一个我想提出一些意见的编码问题。

`cpp-markdown`有一个名为 的基类`Token`，它有许多子类。两个主要的子类是`Container`（包含其他`Token`s 的集合）和`TextHolder`（当然，用作`Token`包含文本的 s 的基类）。

大多数处理是通过虚函数处理的，但其中一些最好在单个函数中处理。为此，我最终使用`dynamic_cast`将指针从 a 向下`Token*`转换为其子类之一，因此我可以调用特定于子类及其子类的函数。强制转换不可能失败，因为代码能够通过虚函数（例如`isUnmatchedOpenMarker`）判断何时需要这样的东西。

我可以看到其他两种方法来处理这个问题：

1.  创建我想要调用的*所有*`Token`函数作为 的虚函数，并为每个子类留下一个空主体，除了需要处理它们的子类，或者......

2.  创建一个虚函数，当在某些子类型上调用它时`Token`，它将返回正确类型的指针，如果在其他任何子类型上调用，则返回一个空指针。`this`基本上是我已经在那里使用的虚拟功能系统的扩展。

对我来说，第二种方法似乎比现有的方法和第一种方法都好。但我想知道其他有经验的 C++ 开发人员对此的看法。或者我是否过于担心琐事。:-)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-24T03:00:10.527

#1 污染了不需要它的对象的类命名空间和 vtable。好的，当你有一些通常会被实现的方法时，但是当只需要一个派生类时就很丑了。

#2 只是`dynamic_cast<>`穿着波点连衣裙和口红。不会使客户端代码变得更简单，并且会混淆整个层次结构，要求基类和每个派生类对*每个其他*派生类都半感知。

只需使用`dynamic_cast<>`. 这就是它的用途。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T03:37:52.013

如果你想变得聪明，你还可以构建一个[双分派模式，这是](http://en.wikipedia.org/wiki/Double_dispatch)[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)的三分之二。

*   创建一个`TokenVisitor`包含空虚`visit(SpecificToken*)`方法的基类。
*   向 Token添加一个虚拟`accept(TokenVisitor*)`方法，该方法在传递的 TokenVisitor 上调用正确类型的方法。
*   从 TokenVisitor 派生出您需要以不同方式对所有令牌执行的各种操作。

对于对树结构有用的完整访问者模式，让默认`accept`方法迭代调用`token->accept(this);`每个的子级。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T03:49:27.787

如果您知道转换不会无效，那么只需使用 static_cast。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T04:42:09.830

为什么要避免使用`dynamic_cast`？它是否会导致您的应用程序出现不可接受的瓶颈？如果不是，那么现在可能不值得对代码做任何事情。

如果您可以在特定情况下以一定的安全性换取一点速度，那么您应该可以做`static_cast`; 但是，这巩固了您的假设，即您知道对象的类型，并且演员阵容没有机会变坏。如果以后您的假设变得错误，您的代码中可能会出现一些神秘的崩溃错误。回到我最初的问题，你真的确定这里的权衡值得吗？

至于您列出的选项：第一个听起来不像是一个解决方案，而是我希望在凌晨 3 点编写代码时看到的最后一分钟的黑客攻击。向类层次结构的基础逐渐渗透的功能是 OOP 新手遇到的最常见的反模式之一。不要这样做。

对于第二个选项，您列出了任何类似的选项实际上只是重新实现`dynamic_cast`- 如果您在一个只有废话编译器可用的平台上（我听说过有关 Gamecube 的编译器占用系统可用 RAM 的四分之一的故事，并带有 RTTI 信息）这个可能值得，但很可能您只是在浪费时间。你真的确定这是值得你关心的事情吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T14:45:54.747

防止 dynamic_cast 的真正干净方法是将正确类型的指针放在正确的位置。抽象应该处理其余的事情。

恕我直言，dynamic_cast 有此声誉的原因是，每次您在类层次结构中向下添加另一个子类型时，它的性能都会下降一点。如果层次结构中有 4-5 个类，则无需担心。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T14:59:47.973

好玩的东西。分词器`dynamic_cast`中的 表示您希望将 Token 实际拆分为基于文本流中的当前位置和 Token 中的逻辑创建 Token 的东西。每个令牌要么是独立的，要么必须像上面一样创建一个令牌才能正确处理文本。

这样你就可以提取通用的东西，仍然可以根据令牌的层次结构进行解析。您甚至可以在不使用`dynamic_cast`.

# c# - C#程序win-startup到系统托盘

> ID：580277
> 
> 赞同：0
> 
> 时间：2009-02-24T02:49:00.053
> 
> 标签：c#, startup, system-tray

我将我的 c# 程序设置为在 Windows 启动时运行，方法是将其添加到 Windows 注册表中。它工作正常，但这是我的问题......

我希望程序在系统托盘中启动，但前提是它由 Windows 自动启动。如果用户从桌面双击程序，那么我不希望程序在系统托盘中启动。现在，我可以让它始终以正常窗口模式打开，也可以始终在系统托盘中打开。

无论如何可以确定我的程序是否由 Windows 启动启动？或者有没有替代这个问题的方法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T02:51:18.177

由注册表启动时添加参数。您绝对可以使用批处理脚本执行此操作，或者直接在注册表中执行此操作。

您将在静态主函数的参数中看到参数，并可以采取相应的行动。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T02:53:11.853

我建议使用命令行参数。如果用户双击一个图标，那么程序应该以这样的方式启动：myProgram.exe /i，如果它以 Windows 启动，那么它应该以类似 myProgram.exe /w 的方式启动。

您可以在程序的主体中解析命令行参数。看这里：

[http://www.c-sharpcorner.com/UploadFile/mahesh/CmdLineArgs03212006232449PM/CmdLineArgs.aspx](http://www.c-sharpcorner.com/UploadFile/mahesh/CmdLineArgs03212006232449PM/CmdLineArgs.aspx)

# c# - 外部项目的单元测试

> ID：580279
> 
> 赞同：1
> 
> 时间：2009-02-24T02:50:13.703
> 
> 标签：c#, unit-testing, nunit

我试图了解人们在单元测试和子（或外部）项目方面所做的事情。

希望我会举个例子来澄清一下。我有一个项目 P1，它依赖于另一个项目 P2。P2 有自己的单元测试和发布周期。P1 也有自己的单元测试。问题是应该将 P2 的单元测试作为 P1 单元测试的一部分包含/运行，还是应该仅在 P2 发布时运行 P2 单元测试？

清如泥。基思。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T03:09:50.520

运行 P1 时，无需运行 P2 的测试。如果 P2 的代码没有更改，则在此期间再次运行测试不会带来任何好处。

如果 P2 因 P1 的测试而中断，则需要对 P2 进行更多单元测试以确保您有足够的覆盖率（或者您可能遇到接口问题，这完全是一个不同的问题）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T06:20:19.767

从理论上讲，如果 P2 的单元测试很好，那么您不需要运行它们。

但是，如果您确实运行它们，那么由于环境的不同，您有可能（可能很小）使它们失败。如果运行它们的成本很低，为什么不呢？但是，如果测试的设置很复杂，您需要一个额外的数据库或其他东西，那么它可能不值得痛苦。

您可能需要对使用 P2 的代码进行集成测试，以测试您使用的特定功能的行为。如果您正在使用 P2，并且 P2 以某种微妙的方式发生变化，那么您怎么知道。如果 P2 有不同的发布周期，那么这一点尤其重要：你不知道他们破坏了什么:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T02:54:35.063

在获取时运行它们。如果代码是从源代码控制中实时检索的，那么也要运行它们。另请注意，您可能希望在 P1 上进行一些关于 P2 使用的集成测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T02:58:31.717

我在客户端和服务器的情况下也有类似的经历。即客户端与Web 服务。两个组件都进行了单元测试。

P2 测试基于 P1 是可靠的假设。针对 P1 版本运行是个好主意。但是运行 P2 和 P1 以发现更多潜在问题并没有什么坏处。

# javascript - 从选择下拉列表中选择项目时自动重定向

> ID：580281
> 
> 赞同：14
> 
> 时间：2009-02-24T02:50:51.097
> 
> 标签：javascript, jquery, html

此页面按照我想要的方式进行：[http ://www.web-source.net/javascript_redirect_box.htm](http://www.web-source.net/javascript_redirect_box.htm)

但是我想找到一种使用 jQuery 的更好方法，任何人都可以指出一个使用 jQuery 来完成此任务的好脚本吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-24T02:56:47.087

您不需要为此预先打包的脚本，只需几行代码。

```
// get your select element and listen for a change event on it
$('#selectEl').change(function() {
  // set the window's location property to the value of the option the user has selected
  window.location = $(this).val();
}); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-24T03:06:16.033

其他人已经就如何做到这一点给出了很好的答案，但是......

只是一个警告，当有人通过键盘导航时，IE 处理选择列表 onChange 的方式与其他浏览器非常不同。它将每个向上/向下按键都计为一个 onChange 事件，这意味着您无法通过键盘导航重定向选择列表，从而扼杀了无法使用鼠标的用户的可访问性。（其他浏览器在触发 onChange 之前等待“输入”事件或选择列表中的选项卡。）我花了很长时间试图解决这个问题，但从未完全解决问题。

我不知道 jQuery 是否考虑了这一点；希望它确实如此，为了您的网站的可访问性。

可能值得让选择列表选择去哪里，然后在它旁边有一个按钮实际激活重定向。（除非您不关心 IE 用户的可访问性。）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-24T02:55:13.377

我没有对此进行测试，但我认为它等同于您引用的页面上的示例。

```
$(document).ready( function() {
   $('#select').change( function() {
      location.href = $(this).val();
   });
});

<select id="select">
    <option value="#">Select a location</option>
    <option value="location.htm">Location</option>
    <option value="other.htm">Other</option>
</select> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-12-15T02:15:34.770

使用 jQuery：

```
$('#selectEl').bind("change keyup",function()
{
  // set the window's location property to the 
  // value of the option the user has selected
  window.location = $(this).val();
}); 
```

适用于通常更改选项和箭头键。

你*也许*可以使用这个扩展： [http](http://plugins.jquery.com/project/mousewheel) ://plugins.jquery.com/project/mousewheel 还没试过。:)

您还可以将鼠标选项添加到 bind() 那里。转到：api.jquery.com/category/events/mouse-events/ 在该页面上有 name() 的任何函数，您可以在上面的 bind() 中使用它的“name”。就像我对 change()=>'change' 和 mouseup()=>'mouseup' 所做的那样 - 很容易:)

*   和平！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T12:49:17.367

正如丹尼尔建议的那样，简单的答案是 - 你不应该这样做，这对可用性和可访问性不利。

选择列表行为取决于用户的操作系统、浏览器和用户设置（两者）的组合。除此之外，onchange 事件并未以标准方式跨浏览器实现。

用户应该能够从选择列表中获得预期的行为，无论他们是否使用鼠标、键盘或鼠标滚轮或（语音、屏幕阅读器等）。如果您确实将一个事件绑定到 onchange 它不应该是一个将用户的焦点从选择列表中移开的事件，例如。页面重定向。

*（我个人经常使用键盘浏览网站表单，如果发生这种情况我会尖叫）*

# windows - Windows、Mac OS X 和 Linux 是用什么语言编写的？

> ID：580292
> 
> 赞同：317
> 
> 时间：2009-02-24T02:54:45.423
> 
> 标签：windows, linux, macos, programming-languages, operating-system

我只是想知道谁知道 Windows、Mac OS X 和 Linux 是由什么编程语言组成的，以及操作系统的每个部分使用什么语言（即：内核、插件架构、GUI 组件等）。

我假设每种语言都有多种语言，显然我知道 Linux 内核是用 C 编写的。

我在这里完全猜测 Mac OS X 包含很多 Objective-C 代码，因为它是 Apple 的源自 NeXT 的语言。

Windows，我听说包含 C、C++ 和 Intel 程序集。Linux 或 Mac OS 是否包含任何汇编代码？

此外，操作系统开发人员是否使用 Ruby、Python 等脚本语言来编写操作系统的部分脚本？操作系统的哪些部分将用每种语言编写？

* * *

## 回答 #1

> 赞同：317
> 
> 时间：2009-02-24T02:58:07.333

*   Windows：C++，内核在 C 中
*   Mac：Objective C，内核在 C 中（IO PnP 子系统是 Embedded C++）
*   Linux：大多数东西都是用 C 语言编写的，许多用户级应用程序是用 Python 编写的，KDE 都是 C++

所有内核也将使用一些汇编代码。

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2011-09-25T21:11:52.223

Linux：C. 组装中的一些部件。

> [...] 它主要是用 C 语言编写的，但大多数人不会将我编写的内容称为 C。它使用了我能找到的 386 的所有可以想象的功能，因为它也是一个教我有关 386 的项目。如前所述，它使用 MMU 进行分页（尚未到磁盘）和分段。正是分段使其真正依赖于 386（每个任务都有一个 64Mb 的代码和数据段 - 4Gb 中最多 64 个任务。任何需要超过 64Mb/任务的人 - 艰难的 cookie）。[...]我的一些“C”文件（特别是 mm.c）几乎与 C 一样多的汇编程序。[...] 与 minix 不同，我也碰巧喜欢中断，因此处理中断时不会试图隐藏他们背后的原因。[（来源）](http://en.wikipedia.org/wiki/Linux_kernel#History)

Mac OS X：Cocoa 主要在 Objective-C 中。用 C 语言编写的内核，组装中的某些部分。

> Mac OS X，在内核层，主要是一个旧的、免费的操作系统，称为 BSD（具体来说，它是 Darwin，一种 BSD、Mach 和其他一些东西的混合体）......几乎完全是 C，有点汇编程序的投入。[（来源）](http://askville.amazon.com/programming-language-Windows-Mac-OS-coded/AnswerViewer.do?requestId=8574761)
> 
> Cocoa 的大部分内容是在 Objective-C 中实现的，这是一种面向对象的语言，经过编译后可以以惊人的速度运行，但采用真正动态的运行时，使其具有独特的灵活性。因为 Objective-C 是 C 的超集，所以很容易将 C 甚至 C++ 混合到您的 Cocoa 应用程序中。 [（来源）](http://developer.apple.com/technologies/mac/cocoa.html)

Windows：C、C++、C#。汇编器中的一些部件。

> 对于 Windows，我们几乎完全使用 C、C++ 和 C#。某些代码区域是手动调整/手写的汇编。[（来源）](http://social.microsoft.com/Forums/is/windowshpcacademic/thread/65a1fe05-9c1d-48bf-bd40-148e6b3da9f1)

Unix: C. 组装中的一些零件。[（来源）](http://digital-domain.net/lug/unix-linux-history.html)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-27T06:07:54.590

Mac OS X 在一些库中使用了大量的 C++，但由于害怕 ABI 破坏而没有公开。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-12-29T03:21:17.510

我知道这是一篇旧文章，但 Windows 绝对不是用 C++ 编写的。其中有很多 C++，但我们技术上定义为操作系统的东西不在 C++ 中。Windows API、Windows 内核（这两者本质上都是操作系统）是用 C 语言编写的。几年前，我收到了一些 Windows 2000 和 Windows XP 的泄露代码。代码还不够完整，无法编译内核或 API，但我们能够编译单个程序和服务。例如，我们能够成功编译 Notepad.exe、mspaint.exe 和 spoolsv.exe 服务（打印后台处理程序）。全部用 C 编写。我没有再看，但我确信泄露的代码仍然存在，因为那里可能仍然可用的 torrent 文件。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2018-08-16T09:05:48.423

哇！！！9 年的问题，但我刚刚遇到了一系列关于 Windows 命令行历史的内部[文章](https://blogs.msdn.microsoft.com/commandline/2018/07/20/windows-command-line-inside-the-windows-console/)，我认为其中的某些部分可能与问题的 Windows 相关：

> 对于那些关心这些事情的人：许多人询问 Windows 是用 C 还是 C++ 编写的。答案是——尽管 NT 采用基于对象的设计——就像大多数操作系统一样，Windows 几乎完全是用“C”编写的。为什么？C++ 在内存占用和代码执行开销方面引入了成本。即使在今天，用 C++ 编写代码的隐性成本也令人惊讶，但在 1990 年代后期，内存成本约为 60 美元/MB（是的……每**兆字节 60 美元！**)，vtables 等的隐藏内存成本是显着的。此外，虚拟方法调用间接和对象取消引用的成本可能会在当时对 C++ 代码造成非常显着的性能和规模损失。虽然仍然需要小心，但现代计算机上的现代 C++ 的性能开销已经不是什么大问题了，考虑到它的安全性、可读性和可维护性的好处，这通常是一个可以接受的权衡……这就是为什么我们将控制台的代码稳步升级到现代 C++。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-24T02:57:40.767

Windows：主要是 C 和 C++，一些 C#

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-01-11T06:42:20.730

*   窗户：C++
*   linux：C
*   mac：目标C
*   安卓：JAVA、C、C++
*   索拉里斯：C、C++
*   iOS 7：Objective-C、Swift、C、C++

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-24T02:57:52.343

没错，MacOSX 的核心是 Objective-C。

视窗 C++

Linux C

关于脚本语言，不，它们非常高级。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-24T03:00:44.877

Linux 内核主要是用 C 语言编写的（我想还有一点汇编语言），但一些重要的用户空间实用程序（程序）是用 Bash 脚本语言编写的 shell 脚本。除此之外，很难定义“Linux”，因为您基本上是通过挑选所需的零碎并将它们组合在一起来构建 Linux 系统，并且根据单个 Linux 用户的需求，您几乎可以使用任何语言。（正如 Paul 所说，Python 和 C++ 发挥着重要作用）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-25T03:56:44.580

我读过或听说过 Mac OS X 主要是用 Objective-C 编写的，其中一些较低级别的部分，例如内核，以及用 C 编写的硬件设备驱动程序。我相信苹果“吃自己的狗粮” "，这意味着他们使用自己的[Xcode Developer Tools](http://developer.apple.com/TOOLS/xcode/)编写 Mac OS X。[GCC（GNU Compiler Collection）](http://gcc.gnu.org/)编译器链接器是 xCode 用于其大部分编译和/或链接可执行文件的 unix 命令行工具。在其他可能的语言中，我知道 GCC 编译来自 C、Objective-C、C++ 和 Objective-C++ 语言的源代码。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-01-21T18:22:30.217

作为 Mac OS X 核心的补充，在 Snow Leopard 之前，Finder 并没有用 Objective-C 编写。在 Snow Leopard 中，它是用 Cocoa、Objective-C 编写的

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-05-04T01:45:35.733

[请参阅在多个平台上运行的一个操作系统](http://technet.microsoft.com/library/cc767881.aspx)标题下，其中指出：

```
Most of the source code for Windows NT is written in C or C++. 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-25T15:21:44.683

Windows 显然不是用 C# 编写的（！）

只需查看 Windows 的源代码，您就会看到...

# c++ - What kind of C++ would I have to learn to make my own OS kernel?

> ID：580308
> 
> 赞同：9
> 
> 时间：2009-02-24T03:02:10.087
> 
> 标签：c++, assembly, operating-system

What kind of C++(Restate to programming) would I have to learn to make my own OS kernel? (I know I would also have to learn assembly.) EDIT***Like interrupts , keyboard driver, getting input.***

Ok everyone I made a really * 3 basic OS and would like to share it.

Here you go. [http://bcsy.hostzi.com/BytOS.zip](http://bcsy.hostzi.com/BytOS.zip)

Compile on linux

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T03:17:30.593

[http://www.brokenthorn.com/Resources/OSDevIndex.html](http://www.brokenthorn.com/Resources/OSDevIndex.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T03:30:34.947

I have a friend who wrote an OS kernel in C++:

[http://sourceforge.net/projects/ekp/](http://sourceforge.net/projects/ekp/)

So it is definitely possible. (Some of the comments above say it is impossible. Wrong.)

You may even want to steal his bootstrapping and build code, so that you can just dive right in and start implementing the "fun stuff".

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T03:05:20.577

Given your choices today there's absolutely no reason to "make" an OS. Learn a language really well and get really comfortable with Windows or a variation of Linux. C or C++ is great to learn.

**Edit for clarification** - my point is that it's both unrealistic and borderline insanity to attempt to learn a language for the first time by making an Operating System. At minimum a really good background in C is a requirement, otherwise start making applications and leverage the power of existing OS's before attempting to roll your own.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-08T03:15:02.717

我建议您查看[OSDev wiki](http://wiki.osdev.org/Main_Page)。它是有关使用多种语言（包括 c++）编程 OS 的绝佳信息来源。

具体来说，[请参阅本](http://wiki.osdev.org/C_PlusPlus)节，它告诉您使用 gcc 使用 c++ 内核所需的一切。

最后，查看[OSDev 论坛](http://forum.osdev.org/)，那里有很多用户，从新手到经验丰富的不等。他们通常非常乐意帮助人们（只要他们在询问之前表明他们**尝试**过:-P）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-24T03:13:45.050

There's only one kind, that should help narrow it down. Start by studying the CPU architecture manuals, Intel's are available [for free](http://www.intel.com/products/processor/manuals/index.htm). Getting documentation for the BIOS is going to be the hard part.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-24T03:31:23.213

check out [nanoos](http://code.google.com/p/nanoos/), its an OS project in C++!

In answer to your question:

> An operating system (commonly abbreviated to either OS or O/S) is an interface between hardware and applications; it is responsible for the management and coordination of activities and the sharing of the limited resources of the computer. The operating system acts as a host for applications that are run on the machine. So you need to learn the bits in C++ that enable your program (OS) to interact with the hardware it will be running on.

Then it needs to go beyond interacting with the hardware and providing use to the user.

For that, go back once again and see what is being attempted in the nanoos as a starting point (for C++ learning needs of what building an OS in C++ would entail)

> Features found in nanoos:
> 
> *   C++ run time
>     
>     
> *   32-bit protected mode Memory manager
>     
>     
> *   CPU detection, Memory detection and IDE hard disk detection
>     
>     
> *   IDE hard disk read

Basically, to write an [Operating System](http://en.wikipedia.org/wiki/Operating_system), just check out what an OS needs to do (or what it is)

If I was to write an OS, before even considering the language, I would try to understand what an OS is, [this is a great book](https://rads.stackoverflow.com/amzn/click/com/0131429388): Operating Systems Design and Implementation.

[![alt text](https://i.stack.imgur.com/LBw0A.jpg)](https://i.stack.imgur.com/LBw0A.jpg)

Have a read. Good luck

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-24T03:54:58.227

我会推荐直接 C 用于内核开发。通过操作系统开发，您真的想知道“幕后”发生了什么。我觉得 C++ 对低级开发隐藏了太多。

好资源：

*   [http://osdever.net/bkerndev/Docs/intro.htm](http://osdever.net/bkerndev/Docs/intro.htm)
*   [http://www.osdever.net/](http://osdever.net/bkerndev/Docs/intro.htm)
*   [http://www.osdever.net/tutorials/hello_btldr.php?the_id=85](http://osdever.net/bkerndev/Docs/intro.htm)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-08T10:21:41.210

[Newos](http://www.newos.org/)是一个很好的 C++ 内核。[eCos](http://ecos.sourceware.org/)和[L4](http://l4ka.org/)也是如此。Newos 是由前 BeOS 开发人员开发的微内核。L4 也是一个微内核，以其令人难以置信的快速消息传递而闻名。eCos 是一个单片内核。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-08T02:51:35.457

由于许多技术原因，Linux 没有使用除 C 之外的任何语言进行编程。由于各种政治原因，很少有其他操作系统使用 C++ 编程。

如果您想了解*编程*内核，Minix 操作系统/微内核是专门为学习操作系统设计而设计的。它很小而且很小。它也是用 C 语言编写的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-08T03:12:51.740

我建议看一下[nachos](http://www.cs.washington.edu/homes/tom/nachos/)（不是另一个完全启发式操作系统）。这是我们在大学时用于操作系统课程的教学操作系统。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-24T03:04:46.427

All. This is not a trivial task, you need to learn most facets of the language, I would recommend looking up kernel programming. From the looks of it I would look up logical theories and paradigms for programming languages before embedding yourself in syntax. There are hardware layers and just so so much you will need to learn well more so than from an answer you are going to get on this site or by doing a google search.

Good Luck!

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-24T03:17:08.317

I would not recommend using C++ when making a monolithic kernel, period. However, if you are contemplating a microkernel design, you could write the servers (networking, console, fs, vfs, etc) in C++, while keeping the kernel itself tight with C / inline asm.

Then again, if your just going for x86, it doesn't matter as much.

What are the design goals of your OS?

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-24T19:59:45.193

查看 linux 内核邮件列表[常见问题解答](http://www.kernel.org/pub/linux/docs/lkml/)以了解常见问题（适用于任何内核开发），不要因此而[气馁](http://www.kernel.org/pub/linux/docs/lkml/#s15-3)。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-02-05T18:13:31.850

看看 L4Ka::Pistachio、Haiku 内核或 Symbian 的 EKA2 可能是个好主意，如果您对“真正的”基于 C++ 的内核的示例感兴趣，这些内核已被用作复杂、功能丰富的操作系统的基础.

我发现后者结构良好，包含非常简洁易读的代码，但其他人可能不同意。然而，目前很难获得和构建（因为 Symbian 基金会网站目前处于离线状态），尽管在 Google 代码上有一个[副本](http://code.google.com/p/symbian-incubation-projects/downloads/detail?name=OSS-FCL-SF-OS-kernelhwsrv.rar&can=2&q=)。

除此之外，我发现 L4Ka::Pistachio 是迄今为止最容易构建的内核之一，但是高级组件的定制和实现是另一种方式 - 尽管[Genode](http://genode.org/)似乎是快速构建更高级别的有希望的途径很久以前我测试它时的组件。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-08T03:09:25.867

我所知道的唯一一个用 C++ 编程到“裸机”的任何显着规模的操作系统是 AS/400 操作系统 OS/400（在 v3r6 之后）。

没有什么可以阻止您使用 C++ 开发任何操作系统——尤其是当您回忆起 vanilla C 无论如何“几乎”是有效的 C++ 时。变得有趣的是在最低级别做`new`/ `delete`，因为您需要保证没有泄漏等。这导致需要重新实现这些`new`功能。

我帮助做了 v3r6，但已经有 13 年了，我不记得毛茸茸的细节。我不知道有关它的任何出版物，但如果您真的感兴趣，请尝试在[http://www.parashift.com](http://www.parashift.com)上写 Marshall Cline 。

（啊。“删除”副“免费”。）

# ruby-on-rails - 从 Rails 中的 gem 覆盖模块方法

> ID：580314
> 
> 赞同：55
> 
> 时间：2009-02-24T03:04:55.023
> 
> 标签：ruby-on-rails, ruby, gem, will-paginate

will_paginate gem 在我的 Oracle 版本上已损坏。WillPaginate 模块中的默认`paginate_by_sql`方法是在查询中插入额外的“AS”并导致查询失败。

代码本身很容易修复，但我不确定让 Rails 接受我的更改的最佳方法。

我不想更改 gem 本身的代码，因为这会使我的代码在其他机器上损坏。

我尝试创建一个 lib/test.rb 文件，其中包含：

```
module WillPaginate
  def paginate_by_sql
    (my code goes here)
  end
end 
```

并从 environment.rb 中要求它，但它没有接受我的更改。我也尝试从 controllers/application.rb 中要求它，但同样，没有接受我的更改。

暂时，我通过覆盖特定模型本身的方法来让它工作，但这有点小技巧，意味着我不能在这个项目中的任何其他模型上使用它。

我确信有一个简单的方法可以做到这一点，但我没有任何运气使用谷歌追踪它。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-12-05T15:14:36.830

更简洁的解决方案：

```
WillPaginate::Finder::ClassMethods.module_eval do
 def paginate_by_sql sql, options
   # Your code here
 end
end 
```

将代码放入 config/initializers 中的初始化文件中。这是放置加载环境时需要运行的代码的正确位置。它还可以更好地组织您的代码，使每个文件的意图更清晰，从而更容易追踪错误。不要弄乱 environment.rb！

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2014-01-30T01:10:41.250

**好的，我只是想让像我这样的人在阅读其他答案后仍然有些挣扎。**

**首先通过在 gem 中搜索要更改的代码行（您可以使用**[**pry**](https://github.com/pry/pry)轻松找到）在 github repo 上找到要更改的代码，然后`Code`在左侧选择而不是`Issues`

![在此处输入图像描述](https://i.stack.imgur.com/LUskJ.png)

![在此处输入图像描述](https://i.stack.imgur.com/n6Qhj.png)

**接下来**复制您要更改的模块的内容并将其放入`.rb`config/initializers 文件夹内的一个恰当命名的文件中。这是一个例子：

```
module Forem
  module TopicsHelper
    def link_to_latest_post(post)
      text = "#{time_ago_in_words(post.created_at)} #{t("ago_by")} #{post.user}"
      link_to text, forum_topic_path(post.topic.forum, post.topic, :anchor => "post-#{post.id}")
    end
  end
end 
```

现在，将其更改为：

```
Forem::TopicsHelper.module_eval do
  def link_to_latest_post(post)
    text = "#{time_ago_in_words(post.created_at)} #{t("ago_by")} #{post.user}"
    link_to text, forum_topic_path(post.topic.forum, post.topic, :anchor => "post-#{post.id}")
  end
end 
```

现在，对代码进行任何其他更改并重新启动服务器。

**你走开！**

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-02-24T04:44:56.407

你正在做的将工作，但你的代码需要看起来像这样：

```
module WillPaginate
  module Finder
    module ClassMethods
      def paginate_by_sql(sql, options)
        # your code here
      end
    end
  end
end 
```

换句话说，进入 finder.rb，删除除模块头和要覆盖的方法之外的所有内容，然后保存到 lib 中的文件并包含在 environment.rb 中。瞧，即时猴子补丁！

# php - 我可以在我的服务器上安装和运行不同版本的 php 吗？

> ID：580318
> 
> 赞同：1
> 
> 时间：2009-02-24T03:07:26.500
> 
> 标签：php, linux

我的朋友允许我访问他的服务器，他编写 PHP 的时间比我长很多，并且仍然使用 php 版本 4.3.9，并且不想升级当前版本。无论如何，我是否可以安装 php 5.2 版并在他仍然运行 4.3.9 时使用它？我需要一些仅在 5.2 中可用的功能。服务器在 redhat 上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T03:12:22.090

是的，您可以使用并发 dso 进行编译以支持这一点。我真的不建议混合 4 和 5，期望这些结果是未定义的。您担心的不仅仅是 PHP，还有 Apache2 和 php4。

但是，就加载程序而言，并发 dso 将允许两个版本和平共存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T10:16:59.260

您可以将 PHP5 安装为 FastCGI。无论如何，你的朋友有问题。PHP4 已过时，不再受支持。见：[http ://www.php.net/downloads.php#v4](http://www.php.net/downloads.php#v4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T18:33:06.300

是的，你可以，一个 php 作为 CGI 运行，另一个作为 MODULE 运行。

或者

你可以运行 2 个 apache。我在端口 82 上有带有 php4 的 apache 1.3.x，在端口 80 上有带有 php5 的 apache 2.2.x。在这两种情况下，php 都作为模块运行。

在这两种情况下，我都不建议将其用于生产服务器，仅用于开发。

# .net - 在数据库之外实现事务的模式

> ID：580321
> 
> 赞同：9
> 
> 时间：2009-02-24T03:09:11.533
> 
> 标签：.net, transactions, acid

我必须发送电子邮件、写入文件并调用 Web 服务。为了保持一致性，所有步骤都必须发生。如果任何步骤抛出异常或错误，则必须回滚所有步骤。

在我开始使用自己的对象 ACID 引擎之前，是否有任何普遍接受的模式用于在对象级别实现 ACID 语义？

更好的是，是否有任何现有的库可以用于 .NET 平台？

**编辑：**我知道发送电子邮件无法撤消，但无法连接到 SMTP 服务器是导致整个事务终止的原因。另外，我希望它可以扩展以用于未来的操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T03:35:50.300

我上一次看到这样的东西是几年前的事了。我记得的一点是它使用命令模式并将每个命令对象存储在队列中。我认为这是一个 LIFO 堆栈。

因此，如果“事务”失败，引擎会弹出一个命令对象，撤消命令，然后销毁命令对象。重复直到堆栈为空。如果“事务”成功，堆栈就会被清除。

不幸的是，我不记得更多了。

[CSLA.NET](http://www.lhotka.net/cslanet/ "CSLA.NET")实现了类似的撤消堆栈。这是我能想到的唯一代码示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T03:18:56.533

当 ACID 语义可能不合适时，Windows Workflow Foundation 有一个[补偿概念（使用复合活动）。当然，它也支持 ACID 事务。](http://msdn.microsoft.com/en-us/magazine/cc163411.aspx)

> 一个很好的问题是为什么要为补偿而烦恼？一个具有自动回滚功能的大 ACID 事务不也一样好吗？当操作发生在同一数据库或同一信息系统内时，ACID 事务是最合适的。当操作快速结束时，它也是最合适的。当涉及不同的公司和服务时，根据 ACID 语义定义流程通常具有挑战性。为了使其隔离和持久，您必须在任务期间锁定不同公司的所有资源。这通常是不合理的，尤其是在任务很长的情况下。为了使其保持一致和原子，您需要临时补偿代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T03:49:11.547

不严重依赖外部库的最简单的技术是[流行](http://en.wikipedia.org/wiki/Object_prevalence)。通过使用序列化定期*检查点*以获取您的状态快照，然后通过序列化针对您的数据的每个副作用操作的足够信息来维护*日志，以便稍后重复。*如果出现问题，请重新加载最近的检查点，然后重新应用在该点之后写入的所有日志记录。

对于更复杂的东西，试试[软件事务内存](http://en.wikipedia.org/wiki/Software_transactional_memory)。在当前语言中实现可能有些笨拙，但功能非常强大，并且还可以为您提供一些额外的并发技术。

对于访问 Web 服务或发送电子邮件等不可逆转的操作，您将需要使用[补偿事务](http://en.wikipedia.org/wiki/Compensating_transaction)：进行另一个 Web 服务调用以取消或更新前一个的结果，或者可能发送另一封电子邮件通知收件人事情没有t 按预期工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T03:48:26.497

由于您无法取消发送电子邮件，并且编写文件相对便宜，因此我只需按正确的顺序执行这些操作：

1.  尝试写文件/写文件。如果不成功，停止，否则继续：
2.  调用网络服务。如果不成功，删除文件并停止，否则继续：
3.  发送电子邮件——电子邮件无论如何都是异步的，所以你永远不会真正知道它是否被发送，因为大多数电子邮件服务器都设置为在发生错误时重试几天并且你永远不会收到确认即使成功，电子邮件也会*通过*。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-18T14:54:03.813

一种想法是使用 JMS 作为“引擎”，您可以利用 JMS 事务（可以加入现有事务，例如 DB 事务）。这开始导致异步事件驱动架构，这可能是一件好事，除非我们谈论的是简单的应用程序——在这种情况下，您可能不需要问这个问题。

这方面的一个例子是简单的帐户创建。为此，您希望将帐户信息保存到数据库，并向用户发送一封电子邮件以进行激活——但出于显而易见的原因，您希望他们在同一个事务中。

您不应该将电子邮件发送代码放在事务中，因为即使您可以发送电子邮件 - db 事务提交也可能由于某种原因而失败。您也不应该将电子邮件发送放在事务之外（在提交之后），因为电子邮件发送可能会失败，从而导致一个孤立帐户。

因此，要在这种情况下使用 JMS - 将 JMS 发送代码放在 DB 事务中并让它加入该事务。保证您的消息传递。在另一端有一些东西消耗队列发送电子邮件。如果电子邮件发送失败，最好的选择是记录/发出警报 - JMS 将回滚并将消息放回队列以供以后使用。即，一旦您希望解决任何问题，就尝试重新发送电子邮件。

关键是 - 数据库记录是一致的，并且最终会发送电子邮件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T04:07:21.083

两个想法：

*   正如[Jeffrey Hantin 所说](https://stackoverflow.com/questions/580321/patterns-for-implementing-transactions-outside-of-a-database/580410#580410)，[软件事务内存](http://en.wikipedia.org/wiki/Software_transactional_memory)(STM) 非常好用。看看它是如何在[Clojure](http://clojure.org/)中实现/使用的；Rich Hickey 的[视频](http://clojure.blip.tv/posts?view=archive&nsfw=dc)令人印象深刻。
*   GoF 成名的[命令模式](http://en.wikipedia.org/wiki/Command_pattern)的一个重要方面是“可撤销性”。实现这一点可能归结为[Robert C. Barth](https://stackoverflow.com/questions/580321/patterns-for-implementing-transactions-outside-of-a-database/580407#580407)*提出的简单（但仍然有用）的建议*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-18T14:58:33.820

此外，最近发布了一个实验项目[STM .NET 。](http://msdn.microsoft.com/en-us/devlabs/ee334183.aspx)该项目将事务内存添加到 C#。它实际上修改了 CLR 以支持这一点。

# mysql - 确定正在使用哪个 MySQL 配置文件

> ID：580331
> 
> 赞同：158
> 
> 时间：2009-02-24T03:12:35.457
> 
> 标签：mysql, configuration

是否有命令可以确定 MySQL 5.0 当前使用的是哪个配置文件？

* * *

## 回答 #1

> 赞同：305
> 
> 时间：2010-05-24T11:49:58.540

摘自 O'Reilly 出色的“高性能 MySQL”一书：

```
$ which mysqld
/usr/sbin/mysqld

$ /usr/sbin/mysqld --verbose --help | grep -A 1 "Default options"
Default options are read from the following files in the given order:
/etc/mysql/my.cnf ~/.my.cnf /usr/etc/my.cnf 
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2009-02-24T05:57:08.637

如果你运行`mysql --verbose --help | less`它，它会告诉你第 11 行`.cnf`它将查找哪些文件。

您还可以`mysql --print-defaults`向您展示它将如何使用配置值。这对于识别它正在加载的配置文件也很有用。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2009-02-24T03:20:38.607

如果您在 Linux 上，则使用 'mysqld' 启动`strace`，例如 `strace ./mysqld`.

在所有其他系统调用中，您会发现如下内容：

```
stat64("/etc/my.cnf", 0xbfa3d7fc)       = -1 ENOENT (No such file or directory)
stat64("/etc/mysql/my.cnf", {st_mode=S_IFREG|0644, st_size=4227, ...}) = 0
open("/etc/mysql/my.cnf", O_RDONLY|O_LARGEFILE) = 3 
```

因此，如您所见..它列出了它尝试使用并最终使用的 .cnf 文件。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2013-07-09T17:06:24.850

我在 Windows 上，我安装了最新版本的 MySQL community 5.6

我查看配置文件使用的方法是转到管理工具 > 服务 > MySQL56 > 右键单击​​ > 属性并检查可执行文件的路径：

"C:/Program Files/MySQL/MySQL Server 5.6/bin\mysqld" --defaults-file="C:\ProgramData\MySQL\MySQL Server 5.6\my.ini" MySQL56

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2012-06-09T12:29:18.753

另一种方法是使用

```
mysqladmin variables 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-04-16T00:39:36.550

mysqld --help --verbose 很危险。您可以轻松覆盖 pidfile 以运行实例！与 --pid-file=XYZ 一起使用

哦，如果你有超过 1 个实例正在运行，你就不能真正使用它。它只会显示默认值。

关于它的真正好文章：

[如何找到 MySQL 配置文件？](http://web.archive.org/web/20161017030124/https://www.psce.com/blog/2012/04/01/how-to-find-mysql-configuration-file/)

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2011-01-12T13:44:49.573

刚刚在ubuntu上做了一个快速测试：

*   安装了mysql-server，它创建了/etc/mysql/my.cnf

*   mysqld --verbose --help | grep -A 1 "默认选项"

110112 13:35:26 [注意] 插件 'FEDERATED' 已禁用。
默认选项按给定顺序从以下文件中读取： /etc/my.cnf /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf

*   创建了 /etc/my.cnf 和 /usr/etc/my.cnf，每个都有不同的端口号

*   重新启动 mysql - 它使用 /usr/etc/my.cnf 中设置的端口号

同时还找到了 mysqld 的 --defaults-file 选项。如果您在此处指定配置文件，则只会使用该配置文件，无论 /usr/sbin/mysqld 返回什么 --verbose --help | grep -A 1 "默认选项"

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-10-04T12:56:45.097

使用 MySQL Workbench，它将显示在“服务器状态”下： [![在此处输入图像描述](https://i.stack.imgur.com/4cyk3.jpg)](https://i.stack.imgur.com/4cyk3.jpg)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-09-20T20:52:59.710

我发现这非常有用：

1.  在 Services 下找到 MySQL 进程`Control Panel -> Administration Tools`
2.  鼠标右键单击并选择`Properties`
3.  单击并选择`Path to executable`并查看它是否包含指向`my.ini/my.cfg`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-01-14T20:46:45.187

一些服务器安装和配置了多个 MySQL 版本。确保您正在处理使用以下 Unix 命令运行的正确版本：

```
ps -ax | grep mysql 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-07-26T12:28:04.950

对于使用 mysql 作为服务运行 windows 服务器的人，找出您正在运行的配置文件的一种简单方法是打开服务控制面板，找到您的 mysql 服务（在我的情况下为“MYSQL56”），右键单击并单击属性. 然后从这里您可以检查“可执行文件的路径”，它应该有一个`defaults-file`指向您的配置文件所在位置的开关。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-06-22T09:33:49.437

万一您正在运行**mac**，也可以通过以下方式实现：

```
sudo dtruss mysqld 2>&1 | grep cnf 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-08-28T08:00:31.183

如果您使用的是 Windows，则可以使用 Sysinternals [procmon](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon)。打开它并像这样配置过滤器设置，然后单击“添加”。现在 procmon 将监视 mysqld。

[![在此处输入图像描述](https://i.stack.imgur.com/RG9zo.png)](https://i.stack.imgur.com/RG9zo.png)

现在正常启动你的mysql服务器。Procmon 将捕获 mysql 的后台操作。搜索“我的”。在 procmon 结果窗格中，您会发现类似以下内容：

[![在此处输入图像描述](https://i.stack.imgur.com/fSUpC.png)](https://i.stack.imgur.com/fSUpC.png)

很明显，mysql会依次搜索配置文件列表。就我而言，它`C:\mysql-5.7.19-winx64\my.cnf`成功找到了，所以它正在使用这个。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-07-02T13:23:00.837

我安装了mysql使用`brew install mysql`

```
mysqld --verbose --help | less 
```

它显示：

[![在此处输入图像描述](https://i.stack.imgur.com/OjKkk.png)](https://i.stack.imgur.com/OjKkk.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-08-13T14:03:45.777

在 CentOS 和 MariaDB 上，您将在以下位置找到 MariaDB 服务器配置设置：/etc/my.cnf.d/server.cnf

# audio - Most simple sound format?

> ID：580339
> 
> 赞同：11
> 
> 时间：2009-02-24T03:19:05.787
> 
> 标签：audio

I was reading about bitmap images. They are one of the more simple image formats (especially 1 bit bitmaps). I am interested to see what a sound file looks like. May someone refer me to the most simple sound file format?

thanks

Actually, I found this [wav file link](https://web.archive.org/web/20120113025807/http://technology.niagarac.on.ca:80/courses/ctec1631/WavFileFormat.html). If someone else has any other links/words of wisdom they'd like to post I'd appreciate it.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T03:22:03.203

8-bit mono uncompressed WAV, in my opinion...

[wikipedia entry](http://en.wikipedia.org/wiki/WAV)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T03:22:57.117

Wave files are the simplest sound format. They have a header (which can sometimes be complicated but usually isn't), and then the actual sound data is raw, uncompressed PCM. Because they're uncompressed, though, they get very big very fast for even moderately long sounds.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T03:38:50.170

Look into libsndfile [http://www.mega-nerd.com/libsndfile/](http://www.mega-nerd.com/libsndfile/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-03T19:21:49.460

与抑制一位图像类似，您可以用一位表示音频，唯一的问题是您将无法从中听到任何声音。由于要听到压力变化的声波需要从设备（耳机/扬声器）产生，因此不能很好地对应。这基本上是由于音频是连续媒体，而图形是静止媒体。

您可以表示每个样本少于 8 位且每秒样本更少的音频。您将分别以较低的分辨率和较高的频率来表示它。例如，如果您使用 8 位来表示每个样本，则限制为 50 dB 的 SNR（信噪比）。通过每秒放置 8000 个样本，它可以代表高达 4 kHz 的带宽（旧时电话音频质量）。

另一方面，如果您用 16 位和每秒 44,100 个样本来表示每个样本，我们将获得 CD 质量的音频。
在原始形式中，降低位数和样本取决于用户的期望，类似于用户可以接受的图像的低分辨率

音频压缩用于减少样本中使用的比特以及样本量。它们基于压缩技术，如 ZIP 文件以及 CELP（代码激发线性预测）[http://en.wikipedia.org/wiki/Code-excited_linear_prediction](http://en.wikipedia.org/wiki/Code-excited_linear_prediction) mp3，AMR-nb 是使用这些技术的算法

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-26T09:00:25.317

如前所述，WAV 文件不是最简单的文件，它包含一个标题。

相对于 1 位编码位图图像而言，1 位 PWM（脉冲宽度调制）音频可以被认为是最简单的。

原则是相同的，尽管位图的二维与音频的单一维度相反。

[维基百科中有关脉冲宽度调制的更多信息](http://en.wikipedia.org/wiki/Pulse-width_modulation)

带有声音的礼品卡和任何可以播放声音的廉价玩具都使用 PWM 音频编码技术，通常使用压电作为传感器（扬声器）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T03:24:29.890

WAV is the way to go, although be wary - the WAV file format may actually store compressed data - though it usually doesn't.

I'm using [Audacity](http://audacity.sourceforge.net/) recently to import raw sound data from a microcontroller system. It can also export raw audio.

That way you can start with sound in nearly any format, and export it as a binary file according to your desire. I'm using 16 bit signed, little endian, mono sound, for instance. Very handy and very easy to manipulate in simple test programs. Can probably even deserialize it in some programming languages into an array or vector.

-Adam

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-30T06:49:19.260

基线 WAVE 格式还有另一个很好的解释：
[https](https://ccrma.stanford.edu/courses/422/projects/WaveFormat/)
://ccrma.stanford.edu/courses/422/projects/WaveFormat/ 我用它从头开始在 C# 中实现 WAV 读/写，没有任何问题。
PS`AudioFormat`对于整数值是 1，对于浮点数是 3。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-16T14:47:38.513

在压缩的情况下，ogg 是最压缩的格式

在简单的情况下，我认为 wav 文件是最简单的

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-27T17:31:14.987

检查 RAW 音频格式。

如果它是 8 位，那么它是最容易处理的。

[https://en.wikipedia.org/wiki/Raw_audio_format](https://en.wikipedia.org/wiki/Raw_audio_format)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-02T02:48:05.277

WAV 文件相当简单。它们只是由多个 8、16 或 32 位整数组成，这些整数表示给定时间波浪的“高度”（Y 坐标）。例如，方波在 8 位 WAV 中可能如下所示：

```
00 FF 00 FF 00 
```

当然，这大大简化了。

# c++ - Setting up a mock interface in C++

> ID：580342
> 
> 赞同：1
> 
> 时间：2009-02-24T03:21:55.827
> 
> 标签：c++, windows, oop, testing

I'm currently trying to use a certain SDK that has me loading functions off a DLL that a vendor provides.. I have to pass arguments to these functions and the DLL does all the work..

Now, the DLL is supposed to be communicating with another device, while I just wait for the results. However, I don't have this device, so how do I set up a mock interface to emulate the device?

To be clear, here's an example:

```
myfuncpointer.Open(someparam,anotherparam,...); 
```

Now, because I don't have the device, the DLL can't actually perform the above function; it fails. How do I set up testing so that the DLL talks to a class that I designed rather than the device? Is there any way to redirect the DLL's call?

How do I make a DummyDevice class to do this?

Thanks..

P.S. If anything is not clear, please don't be too quick to downvote.. Comment as to what I need to explain and I'll try to clear it up.. Thanks.

* * *

EDIT: What I DO have, however, is a spec sheet with all of the data structures used and the expected/legal values that it has to contain. So for example, if I call a function:

```
myfuncpointer.getinfo(param,otherparam); 
```

where one of the params is a data structure that the DLL fills up with info (say, if an option is enabled) after querying the device.. I can do this

```
param.option = true; 
```

after it has finished the getinfo call.

Is this a good way to test the code? It seems very very dangerous to trick this DLL into thinking all the wrong things and seems to be really really hard to scale even just a bit..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T05:41:32.137

Is emulated device access a stopgap solution for until you get hardware? If so, I recommend finding some other way to be productive: work on something else, write unit tests, etc.

Is emulated device access a permanent requirement? If so, here are a few approaches you could take:

1.  **If the other vendor's SDK has a "simulation" or "emulation" mode, use it.** You might be surprised. You're probably not the only client that needs to be able to test/run their application without the other vendor's hardware installed.

2.  **Take the other vendor's code out of the picture.** Emulate only the functionality that your application needs, and base it on your program's requirements. Everything is under your control.

    a. **Add an indirection layer.** Use polymorphism to switch between two implementations: one that calls into the other vendor's DLL, and one that emulates its behavior. Having your code call into an abstract base class instead of directly calling into the other vendor's DLL also will make it easier to write unit tests for your code.

    b. **Write a mock DLL (as Adam Rosenfield suggested).** You need to match the function names and calling conventions exactly. As you upgrade to new versions of the other vendor's DLL, you will need to extend the mock DLL to support any new entrypoints that your application uses.

    If you need to choose which DLL to use at runtime, this may require converting your code to load the DLL dynamically (but it sounds like you might already be doing this, given that you said something about function pointers). You may be able to decide at install time whether to install the other vendor's DLL or the mock DLL. And if this is purely for testing purposes, you may be able to choose which DLL to use at compile time, and just build two versions of your application.

3.  **Write a mock device driver (as others have suggested).**

    If you have the spec for the interface between the other vendor's user mode DLL and their device driver, this may be doable. It will probably take longer than any of the other approaches, even if you're an experienced device driver developer, and especially if you don't have the source to the other vendor's DLL. UMDF (User Mode Driver Framework) might make this slightly easier or less time consuming.

    If the spec you mentioned does not describe the user/kernel interface, you will need to reverse engineer that interface. This is probably not going to be an effective use of your time compared with the other options, particularly if the driver interface is complex (e.g. it passes a lot of complex data structures to `DeviceIoControl()`).

    In both cases, you will need to revisit this every time you upgrade to a new version of the other vendor's SDK. The same exported DLL functions may require using new `DeviceIoControl()` codes and structures.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T03:26:38.763

It depends on how the DLL accesses the device. If it does so by calling functions in another DLL, you can supply a mock DLL where you've replaced the appropriate functions. However, if the DLL is doing something low-level, such as calling directly into the kernel, you're going to have a much tougher time. In that case, you'll probably have to write a new device driver or kernel extension or something.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T06:56:49.293

There are a number of places were you can insert a mock object:

1.  **Mock calls to the DLL**: Within your application, write a [Facade/wrapper class](http://en.wikipedia.org/wiki/Facade_pattern) that encapsulates the function pointer calls into the vendor's DLL. This is a good idea in general because you can put a cleaner class API over the DLL function calls.

2.  **Mock the DLL**: write your own DLL that emulates

3.  **Mock the device**: write a device driver that emulates the device. I would not recommend this because it will be a lot of work and emulating the device's behavior (including bugs and quirks) will be difficult.

I would recommend **#1** because it is the least amount of work and it is not throw-away code.

The Facade class interface you design to hide the calls into the vendor's DLL will improve the design of your other code. It will reduce your code's coupling with the low-level implementation details of vendor's DLL and APIs. If the vendor delivers new DLL APIs, you will be able to integrate it with your code more easily. You might even be able to replace that vendor's DLL with a different vendor or device. :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T03:25:34.817

You'd probably have to write a device driver for that. Depending on your platform, you there might be devices available that might work for you (i.e., things like the 'lo' interface in Linux).

You're not the first person to have this problem, so be sure and scour the web before rolling your own :-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T03:26:17.390

If the DLL is communicating with an external hardware device, you would need to implement a driver that is compatible with the actual driver but with emulated responses.

Most likely if you don't have the device then the SDK will be useless anyway. If there is some functionality provided that does not relate to this external device it will almost certainly be easier to source an equivalent library without the hardware dependency.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-27T06:25:11.663

I've used a relatively hacky, non-portable method for mocking functions, in WIN32 environment (I think it's 32 bit only, but not sure). here it is:

```
#define INJECTED_BYTES  5

static void replace_target(void *Target, void *Server)
{
    DWORD dwOld;

    VirtualProtect(Target, INJECTED_BYTES, PAGE_WRITECOPY, &dwOld);
    *((unsigned char *)Target)++ = 0xe9 ;   // jump relative
    *(unsigned int *)Target = (unsigned int)((unsigned char *)Server - (unsigned char *)Target)-4;
    VirtualProtect(((unsigned char *)Target)-1, INJECTED_BYTES, PAGE_EXECUTE, &dwOld);
    FlushInstructionCache(GetCurrentProcess(), 0, 0);
} 
```

What this does is, it replaces the first few bytes of the target function with a jump to your mocked function. So when you call the target, it jumps directly to your stub. Just remember to keep a copy of the replaced bytes (INJECTED_BYTES) so you can later on undo your mock.

Come to think of it, what's stopping you from writing your own DLL that only stubs out what the real DLL does?

# php - 你如何在共享主机上设置 cakephp？

> ID：580346
> 
> 赞同：5
> 
> 时间：2009-02-24T03:23:22.047
> 
> 标签：php, cakephp

这是我无法用 Cake 做的一件事。我已经尝试了几次，但无法弄清楚。我在 hostgator 上，如果有人能指出他们是如何设置它的（高级安装），它会有所帮助。

**编辑**

我已阅读文档，但出现错误。我想我没有好好读过它。

**编辑** 我刚找到这篇文章。 [http://www.ad7six.com/MiBlog/ProductionSetup](http://www.ad7six.com/MiBlog/ProductionSetup)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-28T02:47:38.277

我对你的问题最好的看法是：

您可能会有一个用户目录（可能`/home/user`），其中包含一个`/public_html`目录，`/htdocs`甚至是`/html`您应该放置文件的位置。

`/public_html`根据我的个人经验，您应该在此目录（从现在开始）上解压缩您的蛋糕/项目文件，例如：

```
/public_html
/public_html/app
/public_html/cake
/public_html/libs 
```

您将在此结构中以您的网站根目录结束，位于：

```
/public_html/app/webroot 
```

大多数托管站点允许您将`.htaccess`文件放在根目录上：

```
/.htaccess 
```

您将需要`.htaccess`使用以下内容创建此文件：

```
DocumentRoot /home/user/public_html/app/webroot 
```

请记住，`/home/user/public_html`可以是任何东西，但您可能很容易通过 shell 或调用主机支持来计算它。

祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-01T15:31:25.267

这正是我在 dreamhost.com 上所做的

我像往常一样创建了一个域，我们称之为 cake.example.com

在根目录中，我有一个蛋糕目录，我将其链接为“蛋糕”，所以它是 /home/myusername/cake ，其中包含解压缩的蛋糕。

在我的主目录中，我编辑了文件 .bash_profile 并在文件底部添加了这一行。

导出 PATH=$PATH:/home/myusername/cake/cake/console

然后您需要注销并重新登录或获取 .bash_profile

现在你可以烤了。

在 cake.example.com 中烘焙应用程序后，您必须编辑文件 /home/myusername/cake.example.com/webroot/index.php

```
if (!defined('CAKE_CORE_INCLUDE_PATH')) {
         //define ('CAKE_CORE_INCLUDE_PATH', 'FULL PATH TO DIRECTORY WHERE CAKE CORE IS INSTALLED. DO NOT ADD A TRAILING DIRECTORY SEPARATOR');
         //You should also use the DS define to separate your directories
        define('CAKE_CORE_INCLUDE_PATH', '/home/myusername/cake');
} 
```

您在最后一行看到，您将其指向 cake 源目录。这样，您实际上可以拥有许多蛋糕应用程序，它们都使用同一个蛋糕应用程序目录。

有点甜吧？

但这还不是全部。在 /home/myusername/cake.example.com 里面

您需要创建一个 .htaccess 文件并将其放入其中。

```
<IfModule mod_rewrite.c>
    RewriteEngine on
        rewriteRule ^(.*) http://cake.example.com/$1 [L]
 RewriteRule ^.* http://cake.example.com%1 [R=permanent,L]
 </IfModule> 
```

现在你正在走向幸福的道路。

# cygwin - 在 g++ 中使用 -mno-cygwin 标志是否有副作用？

> ID：580355
> 
> 赞同：2
> 
> 时间：2009-02-24T03:28:35.933
> 
> 标签：cygwin, g++

我最近发现，只要我使用 -mno-cygwin 标志，我就可以使用 g++ 制作没有外部依赖项的 Windows 可执行文件。我的印象是编译器使用 MinGW 库而不是 cygwin。

*   这是使用 cygwin 构建没有 gpl 许可问题的二进制文件的有效方法吗？

*   除了更大的可执行文件之外，还有任何技术上的副作用吗？（即，失去 cygwin 特定的功能，受限的功能）

*   此功能是否记录在任何地方？我只能找到几年前描述它的新闻组帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T00:08:21.440

该`-mno-cygwin`标志删除了对 Cygwin 的所有依赖项，因此您的程序将不依赖 cygwin1.dll，也不依赖于 Unix 环境的存在。生成的可执行文件就像是使用 MinGW 工具链而不是 Cygwin 编译的一样。标准函数无法识别或理解 Unix 风格的路径或符号链接，因为它们是在 Cygwin 中实现的。

我不记得它在哪里，但是 Cygwin 中有一个帮助文档解释了它。

# computer-science - 抽象代数和编程

> ID：580356
> 
> 赞同：27
> 
> 时间：2009-02-24T03:28:43.780
> 
> 标签：computer-science, wolfram-mathematica, algebra

我要开始学习抽象代数——群、环等。我有兴趣了解任何编程语言，如果有的话可以帮助我学习/尝试我在理论上学到的概念。

编辑：我并没有真正考虑**实施**我学到的东西。我很想知道任何已经支持它们的语言。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-24T04:12:07.203

也许对您的问题略有不同，但仍然......功能语言 Haskell 使用代数（尤其是范畴论）的概念，例如单子、幺半群、箭头等等。

使用 Haskell 的类型类，您还可以将任何对象组成一个组或一个环，例如，只需在它们上定义操作（运算符）。但是，确保您定义的操作实际上符合群/环公理将是您的责任。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-24T03:42:43.403

您在此处需要的文本是Chuck Sims 的*Abstract Algebra, A Computational Approach*。作者会推荐你使用[APL](http://en.wikipedia.org/wiki/APL_(programming_language))编程语言。这本书已经绝版，但您可能会在您的图书馆找到它。

还有用于群论的[GAP 计算机代数系统很有趣。](http://en.wikipedia.org/wiki/GAP_computer_algebra_system)

进阶资源：

[Magma](http://en.wikipedia.org/wiki/Magma_computer_algebra_system)：相当复杂的[CAS](http://en.wikipedia.org/wiki/Computer_algebra_system)，可以处理抽象代数中的各种概念。
[Macaulay 2](http://en.wikipedia.org/wiki/Macaulay_computer_algebra_system)：用于研究多项式环，尤其是[Gröbner 基](http://en.wikipedia.org/wiki/Gr%F6bner_basis)。
[SINGULAR](http://en.wikipedia.org/wiki/SINGULAR)：用于研究多项式环。

研究群论的一个关键事实是，每个群都通过正则作用同构于一个[置换群](http://en.wikipedia.org/wiki/Permutation_group)。因此，理解群论的关键是理解置换群。

最后，任何支持定义自己的对象并在对象的两个实例上定义二元运算符的语言都将支持通过编程学习理论。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-19T21:47:03.383

如果您正在玩组，您可能希望使用[Group explorer](http://groupexplorer.sourceforge.net/)将它们可视化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T04:23:01.747

[Mathematica](http://www.wolfram.com/products/mathematica/index.html)有很多有用的函数来处理抽象代数中的概念。不幸的是，它是专有软件并且非常昂贵。 [Sage](http://www.sagemath.org/)是一个免费的替代品，它也有相当不错的抽象代数函数库，虽然我没有广泛使用它，所以我不能对它发表更多评论。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-24T03:34:40.990

任何具有固定大小无符号整数的语言（例如`unsigned int`C 中的类型）都是这种实现的示例。无符号值的加法本质上与 Z [2 ^(32)]上的加法（即整数模 2 ^(32)）相同，您可能正在抽象代数课上学习。

不过，对这样一个组进行模块化添加并不是很有趣。更有趣的可能是对一组大小为 N 的模加法，其中 N 具有除 2 以外的质因子，或者大小为 P，其中 P 是质数。要试验这样的组，您可能必须自己实现这样的算术运算（这并不难）。具有运算符重载的语言可以使实现更方便使用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-12T13:03:02.160

使用对您最有意义的语言。抽象代数包含大量的符号操作（符号推送）和重写、适量的归纳和大量的繁琐。对我来说，这听起来像是逻辑或函数式编程；Epigram 和 Agda 做了一点，Haskell 在某种程度上做了（尽管我不同意 monoid 是正确的，mzero 和 mappend 还可以，mconcat：不好）。对于抽象代数，最好的编程语言是定义笔记本和吨纸。尽管这些天来这个变得非常深奥。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-14T05:34:25.113

嗯……很抱歉，但我认为学习一些花哨的新编程语言来帮助您学习抽象代数并不有效。

是的，Haskellers 喜欢谈论范畴论，但这并不是一个好的起点。

GAP 公司 被用来帮助成年的群论者寻找新的“怪物”——它们是学习群论的坏工具。

也许你可以看看这个： http: [//freecomputerbooks.com/mathAlgebraBooks.html](http://freecomputerbooks.com/mathAlgebraBooks.html) - 有很多关于这个主题的免费书籍。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-11-08T21:30:29.147

令人惊讶的是，到目前为止还没有人提到**CoCoA**（Computations in Commutative Algebra 的首字母缩写词），一个指向主站点的链接： [http](http://cocoa.dima.unige.it/) : //cocoa.dima.unige.it/ 可以下载最新的 CoCoA 5.0对于主要平台（Linux、MacOS X、Windows），（也可以在此处找到一份有用的 CoCoA 4.7 手册，因为 5.0 将被更新）。
一个免费提供的计算机代数系统（用 C 编写）已经开发了 20 多年。它的目标是专业的科学应用，其中包括 Gröbner 基计算、多项式分解、精确线性代数、希尔伯特函数、复曲面理想等。

有很好的专着，如 Kreutzer 和 Robbiano 处理 CoCoA 的 Computational Commutative Algebra (2 vol.)：http: [//cocoa.dima.unige.it/kr/](http://cocoa.dima.unige.it/kr/)

在交换代数领域，它比 Mathematica 具有更高级和更专业的功能，尽管在 M 中有出色的功能（CoCoA 中没有）用于量词消除（有助于处理多项式方程和不等式系统）： [http://www. wolfram.com/learningcenter/tutorialcollection/AdvancedAlgebra/](http://www.wolfram.com/learningcenter/tutorialcollection/AdvancedAlgebra/)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-05-21T03:11:53.027

我读过的唯一一本试图认真处理抽象代数概念的计算机语言书籍是《 [*科学与工程 C++：高级技术和示例介绍》，作者*](https://rads.stackoverflow.com/amzn/click/com/0201533936)是 John J. Barton、Lee R. Nackman。

这是一本关于 C++ 的好书，虽然很旧。

我不知道这种方法在数学上是否 100% 正确。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T03:38:06.537

与 Greg 的回答类似，组以矩阵乘法的形式具有很好的表示形式，因此您经常看到使用 matlab 或类似工具完成的示例...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-13T18:49:38.027

[EAAM](https://sites.google.com/site/eaamhl/home) 它是一个特定于数学的软件包，也可以安装。

# c# - 在运行时生成图像

> ID：580359
> 
> 赞同：3
> 
> 时间：2009-02-24T03:29:41.110
> 
> 标签：c#, wpf

我正在尝试在运行时呈现一些 XAML。我的 XAML 是在 StringBuilder 中动态构造的。例如，这里是一个示例：

```
StringBuilder xaml = new StringBuilder(); 
xaml.Append("<Canvas xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" "); 
xaml.Append("xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" Height=\"135\" "); 
xaml.Append("Width=\"210\" Background=\"White\" x:Name=\"Page\">"); 

string url = "http://www.mydomain.com/images/background.png"; 
xaml.Append("<Image Width=\"300\" Height=\"200\" Canvas.Left=\"0\" Canvas.Top=\"0\" "); 
xaml.Append("x:Name=\"bgImage\" Source=\""); 
xaml.Append(url); 
xaml.Append("\" />"); 

xaml.Append("</Canvas>"); 
```

请注意此示例中的 Image 元素。如果我将此 XAML 放在 .xaml 文件中，它运行良好。如果我将它粘贴到 Blend 中，它可以正常工作。但是，我需要等待下载此图像，然后将呈现的 XAML 转换为 .png。为此，我使用以下代码：

```
StringReader stringReader = new StringReader(xaml.ToString()); 
XmlTextReader xmlReader = new XmlTextReader(stringReader); 
FrameworkElement frameworkElement = (FrameworkElement)(XamlReader.Load(xmlReader)); 
Size availableSize = new Size(300, 200); 
frameworkElement.Measure(availableSize); 
frameworkElement.Arrange(new Rect(availableSize)); 

BitmapSource bitmap = RenderToBitmap(frameworkElement); 
PngBitmapEncoder encoder = new PngBitmapEncoder(); 
encoder.Frames.Add(BitmapFrame.Create(bitmap)); 

FileStream fileStream = new FileStream(filename, FileMode.Create); 
encoder.Save(fileStream); 
fileStream.Close(); 
```

问题是，生成的 .png 总是忽略 Image 元素。我猜是因为没有下载图像源。如何在运行时从某些 XAML 生成包含图像的图像？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T04:06:08.090

为什么不直接在 C# 中生成对象，而不是创建 XAML 然后让运行时解析它？这样做有以下好处：

1.  **编译时检查您的对象。** 你现在这样做的方式可能会因为胖手指等而引入运行时错误。
2.  **更快的对象创建。** 直接在 C# 中实例化对象将比解析器更快。
3.  **更易于维护。** 下一位使用此代码的程序员将更轻松地使用格式良好的 C# 与嵌入式 XAML。
4.  **可重构。** 您可以重构 C# 代码以消除重复代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T07:36:29.537

可能更容易自己加载图像，然后直接将其分配给生成的 Image 对象。从 XAML 创建的 FrameworkElement 具有用于 Image 实例的 ax:Name，因此您可以轻松找到它，然后直接分配给它。这样，您可以同步加载图像，而不是在您无法真正控制的后台加载图像时对其进行回复。

# c++ - c++中的Posix线程

> ID：580363
> 
> 赞同：2
> 
> 时间：2009-02-24T03:32:03.990
> 
> 标签：c++, multithreading, posix

如何在linux c++中实现posix线程。保存为“.c并使用c编译器运行的smme程序是可以的。但是在c++中它给出了错误..

我认为我在编译时犯了错误，是否包含任何标签，例如 c++ 的“-lpthread”

有人可以发送一个有效的代码...？

其实这是我的代码

```
int cooperbussman :: startlistenthread()
{
        if(pthread_create(&m_thread,0,&packetreadertask,0)<0)
        {
                cout<<"Unable to create the thread Startlistenthread\n";
                return -1;
        }
        return 1; 
```

我得到的错误是

```
cooperbussman.cpp：在成员函数âint cooperbussman::startlistenthread()â中：
cooperbussman.cpp:76: 错误：从 'void* (*)()' 到 'void* (*)(void*)' 的无效转换
cooperbussman.cpp:76: 错误: 初始化参数 3 âint pthread_create(pthread_t*, const pthread_attr_t*, void* (*)(void*), void*)â

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T03:50:07.693

您的`packetreadertask`函数必须是一个将单个`void *`作为参数的函数。这是重要的错误消息：

```
cooperbussman.cpp:76: 错误：从 'void* (*)()' 到 'void* (*)(void*)' 的无效转换

```

您的函数声明如下：

```
void *packetreadertask(); 
```

它必须在哪里：

```
void *packetreadertask(void *); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T03:34:36.683

您可能会考虑使用 Boost.Threads。它在支持它的平台上通过 pthread 为您提供了 C++ 中的一些简单语义。

但是....没有理由不能在 C++ 程序中使用 pthread。您的错误可能是由于符号修改造成的，但如果不查看您的代码或至少您的编译器输出，我们无法更准确地帮助您。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T03:37:34.320

在使用 g++ 时使用 -lpthreads，就像使用 gcc 一样。只要您不尝试将非静态成员函数指针用作线程，那么 pthreads 应该可以在 C++ 中正常工作。

# sql - SQL Server 检查 IsNull 和零

> ID：580364
> 
> 赞同：14
> 
> 时间：2009-02-24T03:32:14.147
> 
> 标签：sql, sql-server, isnull, divide-by-zero

我有以下内容：

```
set @SomeVariable = @AnotherVariable/isnull(@VariableEqualToZero,1) - 1 
```

如果@VariableEqualToZero 为null，它会替换1。如果@VariableEqualToZero = 0，我也需要它替换1。我该怎么做呢？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2011-10-11T06:22:18.357

如果您使用的是 SQL Server，您可能可以使用`NULLIF`语句？
即，将值设置为`NULL`if 它`0`然后将其设置为`1`if 它`NULL`- 应该同时捕获 0 和 NULL：

```
SET @SomeVariable = @AnotherVariable/ISNULL(NULLIF(@VariableEqualToZero,0),1) - 1 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-24T03:37:06.100

```
SET @SomeVariable = @AnotherVariable / COALESCE(
        CASE 
             WHEN @VariableEqualToZero = 0 THEN 1
             ELSE @VariableEqualToZero
        END, 1) - 1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T03:37:18.923

```
set @SomeVariable = @AnotherVariable /
(case when isnull(@VariableEqualToZero, 0) = 0 then 1 else
@VariableEqualToZero end) - 1 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T03:43:55.523

你用 CASE

代替

```
ISNULL(@VariableEqualToZero,1) 
```

采用

```
CASE WHEN @VariableEqualToZero IS NULL OR @VariableEqualToZero = 0 THEN 1 ELSE @VariableEqualToZero END 
```

COALESCE 和 ISNULL 本质上只是 CASE 语句的快捷方式。您可以查阅 CASE 语法的帮助。

# asp.net - Count number of results for a particular word on Twitter

> ID：580369
> 
> 赞同：5
> 
> 时间：2009-02-24T03:34:28.463
> 
> 标签：asp.net, api, twitter, screen-scraping, search

To further a personal project of mine, I have been pondering how to count the number of results for a user specified word on [Twitter](http://www.twitter.com). I have used their API extensively, but have not been able to come up with an efficient or even halfway practical way to count the occurrences of a particular word. The actual results are not critical, just the overall count. I'll keep scratching my head. Any ideas or direction pointing would be most appreciated.

e.g. [http://search.twitter.com/search?q=tomatoes](http://search.twitter.com/search?q=tomatoes)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-17T15:40:38.593

我可以回去大约一个星期。我使用 Adam 发布的参数开始搜索，然后关闭搜索结果集中最小的 id，例如 [http://search.twitter.com/search.atom?lang=en&q=iphone&rpp=100&max_id=](http://search.twitter.com/search.atom?lang=en&q=iphone&rpp=100&max_id=) 其中 max_id = 我刚刚提取的 100 个结果的最小值（id）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-23T09:06:04.277

net 但我已经做了递归函数来一次又一次地调用搜索查询，直到我在结果中找不到单词“page =”。

# iphone - 哪些图像库已移植到 iPhone？

> ID：580372
> 
> 赞同：1
> 
> 时间：2009-02-24T03:34:55.590
> 
> 标签：iphone, image

我正在研究 iPhone 图片库。我正在寻找可以在 iPhone 上编译的轻量级图像库。是否移植了 ImageMagick 等库？哪些图像库最适合 iPhone？

图片库应该适合做黑白、棕褐色调、饱和度滤镜，以及油画等更复杂的效果。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T03:47:15.203

iPhone SDK 带有一个非常好的图像库，Core Graphics。从 SDK 文档：

> Core Graphics 框架是一个基于 C 语言的 API，它提供了低级、轻量级的 2D 渲染和出色的输出保真度。使用这个基于 Quartz 绘图引擎的框架，用于基于路径的绘图、抗锯齿渲染、渐变、图像、颜色管理、坐标空间转换和 PDF 文档处理。

签出：http: [//developer.apple.com/iphone/library/navigation/Topics/GraphicsAnimation/index.html](http://developer.apple.com/iphone/library/navigation/Topics/GraphicsAnimation/index.html)

并且：http: [//developer.apple.com/iphone/library/navigation/Frameworks/Media/CoreGraphics/index.html](http://developer.apple.com/iphone/library/navigation/Frameworks/Media/CoreGraphics/index.html)

（两者都需要登录）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T09:11:57.633

但是 Core Graphic 不会做上面提到的任何图像过滤。这是 Core Image 的一部分，iPhone SDK 显然缺少它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-09T15:24:45.753

我相信将 ImageMagick 移植到 iOS 上已经取得了一些成功：

[http://www.imagemagick.org/discourse-server/viewtopic.php?f=4&t=14089](http://www.imagemagick.org/discourse-server/viewtopic.php?f=4&t=14089)

# c++ - 对象切片时如何生成编译器警告/错误

> ID：580375
> 
> 赞同：18
> 
> 时间：2009-02-24T03:37:10.437
> 
> 标签：c++, compiler-construction, truncate, slice

我想知道是否可以让编译器对代码发出警告/错误，如下所示：

**笔记：**

*1\. 是的，这是不好的编程风格，我们应该避免这种情况——但我们正在处理遗留代码，希望编译器可以帮助我们识别这种情况。）*

*2\. 如果有的话，我更喜欢编译器选项 (VC++) 来禁用或启用对象切片。*

```
class Base{};
class Derived: public Base{};

void Func(Base)
{

}

//void Func(Derived)
//{
//
//}

//main
Func(Derived()); 
```

在这里，如果我注释掉第二个函数，则将调用第一个函数——编译器（VC++ 和 Gcc）对此感到满意。

它是 C++ 标准吗？当遇到这样的代码时，我可以要求编译器（VC++）给我一个警告吗？

非常感谢！！！

**编辑：**

非常感谢您的帮助！

我找不到给出错误/警告的编译器选项 - 我什至在 MSDN 论坛上为 VC++ 编译器顾问发布了这个，但没有任何答案。所以恐怕gcc和vc++都没有实现这个功能。

因此，添加以派生类为参数的构造函数将是目前最好的解决方案。

**编辑**

我已向 MS 提交反馈，希望他们能尽快修复：

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=421579](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=421579)

-白燕

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-24T05:09:03.167

如果您可以修改基类，则可以执行以下操作：

```
class Base
{
public:
// not implemented will cause a link error
    Base(const Derived &d);
    const Base &operator=(const Derived &rhs);
}; 
```

取决于您的编译器应该为您提供翻译单元，以及可能发生切片的函数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-24T11:20:18.190

作为[Andrew Khosravian 答案](https://stackoverflow.com/questions/580375/how-to-generate-a-compiler-warning-error-when-object-sliced/580533#580533)的变体，我建议使用模板化的复制构造函数和赋值运算符。这样你就不需要知道给定基类的所有派生类来保护该基类不被切片：

```
class Base
{
private:   // To force a compile error for non-friends (thanks bk1e)
// Not implemented, so will cause a link error for friends
    template<typename T> Base(T const& d);
    template<typename T> Base const& operator=(T const& rhs);

public:
// You now need to provide a copy ctor and assignment operator for Base
    Base(Base const& d) { /* Initialise *this from d */ }
    Base const& operator=(Base const& rhs) { /* Copy d to *this */ }
}; 
```

尽管这减少了所需的工作量，但使用这种方法，您仍然需要弄乱每个基类以保护它。此外，如果从`Base`到`SomeOtherClass`雇用`operator Base()`. `SomeOtherClass`（在这种情况下，可以使用更复杂的解决方案`boost::disable_if<is_same<T, SomeOtherClass> >`。）在任何情况下，一旦确定了对象切片的所有实例，就应该删除此代码。

**致全世界的编译器实现者：**测试对象切片绝对是值得创建（可选）警告的事情！我想不出一个例子，它会是理想的行为，它在新手 C++ 代码中很常见。

**[编辑 27/3/2015:]**正如 Matt McNab 所指出的，您实际上不需要像我在上面所做的那样显式声明复制构造函数和赋值运算符，因为它们仍将由编译器隐式声明。在 2003 C++ 标准中，这在 12.8/2 下的脚注 106 中明确提到：

> 因为模板构造函数永远不是复制构造函数，所以这样的模板的存在不会抑制复制构造函数的隐式声明。模板构造函数与其他构造函数（包括复制构造函数）一起参与重载决议，如果模板构造函数提供比其他构造函数更好的匹配，则可以使用模板构造函数来复制对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T04:52:13.580

我建议向您的基类添加一个构造函数，该构造函数显式地对派生类进行 const 引用（使用前向声明）。在我的简单测试应用程序中，这个构造函数在切片情况下被调用。然后，您至少可以获得一个运行时断言，并且您可能会通过巧妙地使用模板获得一个编译时断言（例如：以在该构造函数中生成编译时断言的方式实例化模板）。当您调用显式函数时，也可能有特定于编译器的方法来获取编译时警告或错误；例如，您可以在 Visual Studio 中对“切片构造函数”使用“__declspec(deprecated)”来获得编译时警告，至少在函数调用情况下是这样。

因此，在您的示例中，代码将如下所示（对于 Visual Studio）：

```
class Base { ...
    __declspec(deprecated) Base( const Derived& oOther )
    {
        // Static assert here if possible...
    }
... 
```

这适用于我的测试（编译时警告）。请注意，它不能解决复制情况，但类似构造的赋值运算符应该在那里解决问题。

希望这可以帮助。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T09:35:56.300

解决这个问题的最好方法通常是遵循 Scott Meyer 的建议（参见*Effective C++*），即在继承树的叶节点处仅具有具体类，并通过至少具有一个纯虚函数来确保非叶类是抽象的（析构函数，如果没有别的）。

令人惊讶的是，这种方法也经常以其他方式帮助阐明设计。在任何情况下，隔离通用抽象接口的工作通常都是值得的设计工作。

## 编辑

虽然我最初并没有说清楚，但我的回答来自这样一个事实，即在编译时无法准确警告对象切片，因此如果您有编译时断言，它可能会导致错误的安全感，或启用编译器警告。如果您需要了解对象切片的实例并需要更正它们，那么这意味着您有更改遗留代码的愿望和能力。如果是这种情况，那么我认为您应该认真考虑重构类层次结构，以使代码更加健壮。

我的理由是这样的。

考虑一些定义类 Concrete1 并在该函数的接口中使用它的库代码。

```
void do_something( const Concrete1& c ); 
```

传递类型是参考是为了提高效率，通常是一个好主意。如果库认为 Concrete1 是一种值类型，则实现可能会决定制作输入参数的副本。

```
void do_something( const Concrete1& c )
{
    // ...
    some_storage.push_back( c );
    // ...
} 
```

如果传递的引用的对象类型确实是，`Concrete1`而不是其他派生类型，那么这段代码很好，不执行切片。关于此`push_back`函数调用的一般警告可能只会产生误报，并且很可能没有帮助。

考虑一些派生`Concrete2`自`Concrete1`另一个函数并将其传递给另一个函数的客户端代码。

```
void do_something_else( const Concrete1& c ); 
```

因为该参数是通过引用获取的，所以在要检查的参数上没有发生切片，所以在这里警告切片是不正确的，因为可能没有发生切片。将派生类型传递给接受引用或指针的函数是利用多态类型的一种常见且有用的方法，因此警告或禁止这样做似乎会适得其反。

那么哪里有错误呢？好吧，“错误”是传递对从类派生的东西的引用，然后将其视为被调用函数的值类型。

一般来说，没有办法针对对象切片生成始终有用的编译时警告，这就是为什么最好的防御方法是尽可能通过设计消除问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T03:44:16.847

这通常被称为[对象切片](http://en.wikipedia.org/wiki/Object_slicing)，并且是一个众所周知的问题，有自己的 Wikipedia 文章（尽管它只是对该问题的简短描述）。

我相信我使用了一个编译器，它有一个警告，你可以启用它来检测和警告这一点。但是，我不记得那是哪一个了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T03:54:09.883

不是真正解决您当前问题的方法，但是....

大多数将类/结构对象作为参数的函数应该将参数声明为“const X&”或“X&”类型，除非它们有很好的理由不这样做。

如果你总是这样做，对象切片永远不会成为问题（引用不会被切片！）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T04:01:38.290

```
class Derived: public Base{}; 
```

你说 Derived 是一个基础，所以它应该在任何需要基础的函数中工作。如果这是一个真正的问题，那么继承可能不是您真正想要使用的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T19:46:41.857

我稍微修改了你的代码：

```
class Base{
  public:
    Base() {}
    explicit Base(const Base &) {}
};

class Derived: public Base {};

void Func(Base)
{

}

//void Func(Derived)
//{
//
//}

//main
int main() {
  Func(Derived());
} 
```

显式关键字将确保构造函数不会被用作隐式转换运算符——当你想使用它时，你必须显式调用它。

# orm - DAL 和 ORM 之间的界限在哪里？

> ID：580383
> 
> 赞同：37
> 
> 时间：2009-02-24T03:39:48.917
> 
> 标签：orm, terminology, data-access-layer, database-design

这些术语通常可以互换使用，并且显然存在相当大的重叠，但似乎暗示人们经常看到通过说系统是 ORM 而不是因为它是 DAL 而暗示的东西。那是什么？如果有的话，区分这些类型系统的关键点是什么？

例如，假设我有一些代码实现了 Database、Table、Column 和 Row 类，通过对现有数据库的自动分析来填充它们，允许简化交互等等。它理解、执行和利用数据库实体之间的结构关系，例如外键。所有实体模型都可以进行子类化，以将特定于表的功能加载到它们上。

这在多大程度上是 DAL？它在多大程度上是一个 ORM？为什么？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-02-24T03:43:57.363

# ORM = 对象关系映射

在 ORM 中，应用程序中的类/对象被映射到数据库表和操作以实现持久性，有时是自动的。

# DAL = 数据访问层

在 DAL 中，数据库操作隐藏在代码外观之后。

# ORM 是一种 DAL，但并非所有 DAL 都是 ORM。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T03:42:28.913

我认为 ORM 能够将任何对象集映射到关系数据库；而 DAL 是特定于您的应用程序的，并且可能无法自然地扩展以支持其他对象。

不仅如此，ORM 还特别关注与数据库实体之间的*映射*类，而 DAL 可能只是您访问数据库中数据的一种方式，无需任何映射。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-25T23:08:25.327

任何连接到任何不保存对象的存储系统的面向对象的 DAL 都实现了 ORM。ORM 通常被理解为 Hibernate 之类的东西，但重要的是处理阻抗不匹配。

[展开]

在数据级别，当您将一种类型（关系）的数据映射到另一种 (OO) 的数据时，会发生阻抗不匹配。

例如，您在 DAL 中看到过多少次如下所示的行？

```
db.AddInParameter(dbCommand, "Name", DbType.String, name); 
```

或者另一边

```
customerId = Convert.ToInt64(dr["CustomerID"].ToString()); 
```

映射原始数据类型时会出现许多问题。

在对象级别，您的 DAL 应该返回您打算使用的结构。无论是某种业务对象还是只是一堆原始数据。您自己的 DAL 和 ORM 都需要处理这个问题。

在设计级别，您构建的对象反映了您存储的数据。因此可能会出现结构差异。这些也在 ORM 解决方案中为您处理，但您将被迫在 DAL 中执行相同操作。例如，在您的 OO 代码中，实现适当的继承会很好，但这并不容易转换为关系。

我只是想指出，ORM 是一个术语，用于推动产品，这些产品可以自动化您在 DAL 中已经要做的很多事情。ORM 解决方案将使生活更轻松，并提供大量质量/性能优势。但这并不能改变 DAL 的主要组件之一是创建自己的 ORM 的事实。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T03:47:56.777

当我开始编程时，ORM 并不存在。当第一个 ORM 出现时，它们是用于创建 DAL 的外部工具。现在，DAL 和 ORM 已经混合在一起了。这就是为什么许多开发人员可以互换使用这些术语的原因。

用作 DAL 的 ORM 最著名的示例是 NHibernate。其他示例是 Subsonic 和 CSLA.NET。这些都是 .NET 工具。IIRC，ORM 工具起源于 Java 世界。其他技术栈随后复制了 Java 所做的事情。

# crash - 如何向其他非 IS 部门的高层传达坏消息？

> ID：580385
> 
> 赞同：6
> 
> 时间：2009-02-24T03:40:33.940
> 
> 标签：crash, communication

最近我们添加了几台网络服务机器，它们无法成功发送电子邮件。我们（IS）没有注意到这一点，异常被吞并并记录下来，但大约一个月没有人注意到。

不用说，在过去的一个月里，许多采购订单和采购订单的撤回都没有发出。

虽然这真的不是任何人的错，但有没有什么好的方法可以将这个问题告诉公司中比你更高的非技术人员？

提前感谢您的任何建议，我有点吓坏了。:)

* * *

编辑：读完这篇文章，我更多的是寻求有关如何打破新闻的提示。我知道没有好的方法，只是过去可能对您有用的成功技巧。

* * *

解决方案以防万一有人想知道...新的 Web 服务机器 IP 未添加到我们的受信任 IP 的邮件服务器列表中。:)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-24T03:47:38.837

强调问题是由您的团队迅速发现并解决的。准备好有关故障数量、受影响客户等的详细指标。准备好一个应急计划来描述，以防止将来发生类似的问题。与上级产生一种同志情谊，因为你们都在同一个团队中，这是一个团队问题。如果你传达一种紧迫感，并给人一种你和他们一样重视对底线的影响的印象，他们会做出更好的反应。

低级的技术人员经常犯这样的错误，即把尾巴夹在两腿之间，就像一个孩子羞愧地向父母展示他打破的灯并等待打屁股一样。您是成年人和专业人士 - 立即采取行动并协调合适的人员到位，以做出正确的决定来解决问题。在这种情况下，这不可避免地意味着引入高层管理人员，但这样做的目的是寻求解决方案，而不是恐惧。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-30T17:19:27.760

你给你的部门带来耻辱。你知道你必须做什么。

[http://en.wikipedia.org/wiki/Seppuku](http://en.wikipedia.org/wiki/Seppuku)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T03:44:28.547

哎呀，对你来说是个坏消息——但这是某人的错。

构建服务器并安装应用程序并签署将它们投入生产使用而无需测试它们的人。:-)

向管理层打破这种情况的唯一方法几乎是承认 MAJOR FUBAR 并向他们展示确保这种情况不会再次发生的计划。

祝你好运。:-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T03:49:05.697

尽快提出问题。

附上如何缓解问题的清晰计划/步骤列表：

*   如何解决问题，以便进一步处理工作正常
*   是否可以确定哪些交易受到影响
*   有什么必要确保这种情况不会再次发生 - 部署自动化测试、新服务器的预生产阶段，还有其他什么？

主动解决问题。只要这不是您的直接过错，您甚至可能会从整个混乱中受益。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T03:45:13.320

诚实和直接是最好的，而不是试图掩盖所发生事情的某些方面。

不要责怪任何人，只需接受问题的发生，提出解决方案并执行该解决方案即可。将此计划传达给您的上级，并清楚说明您为什么要采取措施来解决问题。

寻找责任方和责任的时候到了，首先解决与*向客户收钱*有关的问题。

一旦解决了眼前的问题，然后找到一种方法来确保不会再次发生导致此问题的任何事情。有一个计划。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-24T04:56:53.460

指出

*   发生了什么
*   为什么会发生
*   您认为后果是什么（即错过的采购订单撤回）
*   你已经做了什么来修复它
*   您需要做什么（如果需要更多修复）
*   管理层需要做什么，比如支出（如果需要）
*   可以做些什么来防止将来发生类似事件

积极主动地报告它并将负面变为正面（“我们已经吸取了以下宝贵的经验教训”）。

除非被问到，否则尽可能避免指指点点，并尝试以积极的方式旋转它。技术犯错误；毕竟他们是人类。如果他们能从所犯的错误中吸取教训，他们可能值得留下来。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T17:23:48.217

无论你做什么，至少要确保你事先已经与你的直接上级达成了一致。即使你是 iS 导演。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-05T14:13:08.327

撒谎或掩盖 :-)，如果你能把责任推给一个新的实习生，就奖励你 10 只小猫！

# java - 我需要什么事件才能知道鼠标移到了 JMenuItem 上？

> ID：580391
> 
> 赞同：0
> 
> 时间：2009-02-24T03:42:57.397
> 
> 标签：java, user-interface, swing

我想处理鼠标经过任何 JMenuItems 的情况。我不需要用户单击其中一个 JMenuItem；只需将鼠标移到其中任何一个上即可。基本上，他必须单击 JMenuBar 来显示菜单，但他不必单击任何菜单项。

我想在 JMenuBar 上使用 actionPerformed 侦听器——因为菜单项和子菜单仅在用户单击 JMenuBar 时出现——但这似乎是不可能的，除非我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T03:48:45.137

实现一个[MouseListener](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/event/MouseListener.html)并将其添加到 JMenuItems。然后您可以捕捉鼠标何时进入和离开每个 JMenuItem。

# 3gp - 创建移动流媒体服务器 (3gp)

> ID：580392
> 
> 赞同：1
> 
> 时间：2009-02-24T03:43:37.083
> 
> 标签：3gp, dss, helix, helix-dna-server

我需要一个开源解决方案和教程来创建可以以 3gp (3gpp) 格式流式传输视频的移动流媒体服务器，我曾尝试使用 Helix DNA Server，但它的免费版本只允许真实媒体而不是 3gp。

我听说过 DSS（达尔文流媒体服务器），但我找不到任何 Windows 二进制文件（已编译的 exe），Catra 流媒体服务器包只会让我更加困惑，因为我找不到 Catra 所需的任何文件（设置等）他们的包裹上没有）。

PS：实际上我需要一些在 Windows 上设置 DSS 或 Catra 的指南（尤其是 Server 2003）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T03:52:44.923

您可能想尝试[VLC](http://www.videolan.org/vlc/) [http://www.videolan.org/vlc/](http://www.videolan.org/vlc/)

我不能保证流媒体服务器，但播放器运行良好，并且支持 3gp。

但这不是编程问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-07T18:46:27.587

DSS Windows 二进制文件在这里： [http ://dss.macosforge.org/post/previous-releases/](http://dss.macosforge.org/post/previous-releases/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-06T18:51:47.243

如果您的目标移动设备支持 Flash，您可以从 Red5 流式传输 3gp。如果它们不支持 Flash，但它们允许 HTML5，您仍然可以使用 Red5 或几乎任何 Java EE 容器服务器。

# python - 需要帮助调试python html生成器

> ID：580397
> 
> 赞同：1
> 
> 时间：2009-02-24T03:45:09.810
> 
> 标签：python, pywin32

该程序应该接受用户输入，将其转换为 html 并将其传递到剪贴板。

使用 welcome_msg() 启动程序

如果您在主菜单中输入 1，它将带您完成构建锚标记。您将添加链接文本、url，然后是标题。输入标题后，我收到以下错误：

```
File "<pyshell#23>", line 1, in <module>
  welcome_msg()
File "C:\Python26\html_hax.py", line 24, in welcome_msg
  anchor()
File "C:\Python26\html_hax.py", line 71, in anchor
  copy_to_clipboard(anchor_output)
File "C:\Python26\html_hax.py", line 45, in copy_to_clipboard
  wc.SetClipboardData(win32con.CF_TEXT, msg)
error: (0, 'SetClipboardData', 'No error message is available') 
```

这是代码： http: [//pastie.org/398163](http://pastie.org/398163)

是什么导致了上述错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T04:21:41.983

在您的`make_link`函数中构造 a `link_output`，但实际上并没有将其作为函数结果返回。用于`return`执行此操作：

```
def make_link(in_link):
  ...
  if title == '':
    link_output = ...
  else:
    link_output = ...
  return link_output 
```

这样您就可以在`anchor_output`此处获取传递给变量的值：

```
anchor_output = make_link(anchor_text) 
```

这是`None`因为该函数没有返回任何值，并将剪贴板设置为`None`失败。随着函数返回一个真实的字符串，它应该可以按预期工作。

# perl - 在 Perl 中让两个模块相互使用函数的最佳方法是什么？

> ID：580418
> 
> 赞同：1
> 
> 时间：2009-02-24T03:54:12.270
> 
> 标签：perl, exporter, module-management

不幸的是，在 Perl 中创建包、导出等方面，我完全是个菜鸟。我尝试阅读一些模块，并且经常发现自己从冗长的章节中打瞌睡。如果我可以在一个简单的网页中找到我需要理解的内容而无需向下滚动，那将会很有帮助。:P

基本上我有两个模块，A 和 B，A 将使用 B 中的一些函数，B 将使用 A 中的一些函数。当我尝试通过`perl -c`.

有没有办法正确地做到这一点？还是我的设计迟缓了？如果是这样，什么是更好的方法？因为我这样做的原因是避免复制 n 将其他模块功能再次粘贴到该模块中并重命名它们。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-24T04:07:06.043

具有循环依赖关系并不是一个很好的做法。我建议将某些东西或其他东西分解到第三个模块，这样你就可以让 A 依赖于 B，A 依赖于 C，B 依赖于 C。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T04:38:31.553

所以......将公共代码分解到另一个模块中的建议是一个很好的建议。但是，您不应该将模块命名为 *.pl，也不应该通过`require`-ing 某个路径名来加载它们（如在 中`require "../lib/foo.pl";`）。（一方面，说 '..' 使您的脚本每次都依赖于从同一个工作目录执行。因此，当您将脚本运行为 时，您的脚本可能会工作，但当您将其运行为时`perl foo.pl`，它将无法工作`perl YourApp/foo.pl`。那就是一般不好。）

假设您的应用名为 YourApp。您应该将应用程序构建为一组位于`lib/`目录中的模块。例如，这是一个“Foo”模块；它的文件名是`lib/YourApp/Foo.pm`.

```
package YourApp::Foo;
use strict;

sub do_something {
    # code goes here
} 
```

现在，假设您有一个名为“Bar”的模块，它依赖于“Foo”。您只需制作`lib/YourApp/Bar.pm`并说：

```
package YourApp::Bar;
use strict;
use YourApp::Foo;

sub do_something_else {
    return YourApp::Foo::do_something() + 1;
} 
```

（作为一个高级练习，您可以在使用包的命名空间中使用`Sub::Exporter`或`Exporter`制作`use YourApp::Foo`install 子例程，这样您就不必`YourApp::Foo::`在一切之前编写。）

无论如何，你像这样构建你的整个应用程序。功能的逻辑部分应该组合在模块（甚至更好的类）中。

为了让这一切运行起来，你编写了一个看起来像这样的小脚本（我把它们放进去`bin/`，所以我们称之为`bin/yourapp.pl`）：

```
 #!/usr/bin/env perl

 use strict;
 use warnings;
 use feature ':5.10';

 use FindBin qw($Bin);
 use lib "$Bin/../lib";

 use YourApp;
 YourApp::run(@ARGV); 
```

这里的关键是你的代码都不是在模块之外，除了一点点样板来启动你的应用程序运行。这很容易维护，更重要的是，它使编写自动化测试变得容易。无需从命令行运行某些东西，您只需调用具有某些值的函数即可。

无论如何，现在这可能是题外话了。但我认为了解这一点很重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T04:58:34.190

简单的答案是不要使用 perl -c 测试编译模块...改用 perl -e'use Module' 或 perl -e0 -MModule。perl -c 旨在对脚本进行测试编译，而不是模块。当您在其中一个上运行它时

递归使用模块时，关键是要确保尽早设置外部引用的任何内容。通常这意味着至少在编译时构造中设置使用 @ISA（在 BEGIN{} 中或通过“使用父级”或已弃用的“使用基础”）并在 BEGIN{} 中设置@EXPORT 和朋友。

基本问题是，如果模块 Foo 使用模块 Bar（它使用 Foo），则 Foo 的编译会在该点停止，直到 Bar 完全编译并且它的主线代码已经执行。确保 Foo Bar 的编译和运行主线代码需要的任何部分都有答案。

（在许多情况下，您可以明智地将功能分离到更多模块中并中断递归。这是最好的。）

# java - 如何阻止 Java while 循环占用超过 50% 的 CPU？

> ID：580419
> 
> 赞同：20
> 
> 时间：2009-02-24T03:54:41.317
> 
> 标签：java, loops, cpu-usage

好的，我在一个空程序上对此进行了测试，仅仅运行了一段时间(true){}，我的 CPU 就超过了 50%。我有一个我正在开发的游戏，它使用一个 while 循环作为它的主循环，它的 CPU 一直是 100。

我怎样才能让 Java 一遍又一遍地重复某些事情，而不会仅仅为了重复而占用我 50% 以上的 CPU？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-02-24T03:57:21.887

添加睡眠以使线程空闲一段时间：

[`Thread.sleep`](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#sleep(long))

在没有睡眠的情况下，while 循环将消耗所有可用的计算资源。（比如理论上单核系统100%，双核50%，以此类推。）

例如，以下将`while`大约每 50 毫秒循环一次：

```
while (true)
{
    try
    {
        Thread.sleep(50);
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
} 
```

这应该会大大降低 CPU 利用率。

通过在循环中休眠，操作系统也会为其他线程和进程提供足够的系统时间来完成它们的工作，因此系统也会做出响应。回到单核系统和调度程序不太好的操作系统的时代，像这样的循环可能会使系统非常无响应。

* * *

由于出现`while`了游戏循环使用的话题，如果游戏要涉及 GUI，游戏循环必须在单独的线程中，否则 GUI 本身将变得无响应。

如果程序将是基于控制台的游戏，那么线程不会成为问题，但对于事件驱动的图形用户界面，代码中的长期循环将使 GUI 无响应。

线程等是非常棘手的编程领域，尤其是在开始时，所以我建议在必要时提出另一个问题。

下面是一个基于 a 的 Swing 应用程序示例，`JFrame`它更新`JLabel`将包含来自 的返回值的a `System.currentTimeMillis`。更新过程发生在一个单独的线程中，“停止”按钮将停止更新线程。

该示例将说明的几个概念：

*   一个基于 Swing 的 GUI 应用程序，具有一个单独的线程来更新时间——这将防止 GUI 线程锁定。（在 Swing 中称为 EDT 或事件调度线程。）
*   使`while`循环的循环条件不是`true`，而是用一个`boolean`which 代替，这将确定是否保持循环处于活动状态。
*   如何`Thread.sleep`影响实际应用。

请原谅我的长例子：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class TimeUpdate
{
    public void makeGUI()
    {
        final JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        final JLabel l = new JLabel();

        class UpdateThread implements Runnable
        {
            // Boolean used to keep the update loop alive.
            boolean running = true;

            public void run()
            {
                // Typically want to have a way to get out of
                // a loop. Setting running to false will 
                // stop the loop.
                while (running)
                {
                    try
                    {
                        l.setText("Time: " +
                                System.currentTimeMillis());

                        Thread.sleep(50);
                    }
                    catch (InterruptedException e)
                    {
                        e.printStackTrace();
                    }
                }

                // Once the run method exits, this thread
                // will terminate.
            }
        }

        // Start a new time update thread.
        final UpdateThread t = new UpdateThread();
        new Thread(t).start();

        final JButton b = new JButton("Stop");
        b.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e)
            {
                t.running = false;
            }
        });

        // Prepare the frame.
        f.getContentPane().setLayout(new BorderLayout());
        f.getContentPane().add(l, BorderLayout.CENTER);
        f.getContentPane().add(b, BorderLayout.SOUTH);
        f.setLocation(100, 100);
        f.pack();
        f.setVisible(true);
    }

    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new TimeUpdate().makeGUI();
            }
        });
    }
} 
```

关于线程和使用 Swing 的一些资源：

*   [线程和摆动](http://java.sun.com/products/jfc/tsc/articles/threads/threads1.html)
*   [课程：并发](http://java.sun.com/docs/books/tutorial/essential/concurrency/)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-24T05:21:33.433

Thread.Sleep 可能不是全部答案。对于大多数游戏来说，CPU 太多了，无法满足所需的工作量。简单地睡一段时间并没有那么高效，因为您可能仍然会消耗太多资源，或者不够。您通常希望以某种方式为您的工作计时。

如果你仔细想想，屏幕只会以一定的速度更新，通常每秒不到 100 次。我不熟悉这类事情的 Java api，但你想要的是找出监视器的刷新速度，然后在每次刷新之间只更新一次。

此外，您的主循环不需要像这样的循环，您可以使用计时器定期调用更新代码。这甚至更有效。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-24T07:58:20.310

您确实在忙于等待，这意味着您不断地检查 CPU 以检查一个或多个条件，直到它们为真。

`Thread.sleep()` **不是**解决方案。使用`wait()`和`notify()`方法可以让你做你正在尝试的事情，但效率更高。基本上，这种机制允许线程在对象上休眠，直到对象确定发生了某些事情并想要唤醒所有休眠在其上的线程。

可以在[此处](http://www.builderau.com.au/program/java/soa/Simplify-request-processing-with-a-wait-notify-technique/0,339024620,320276813,00.htm)和[此处找到代码示例。](http://scv.bu.edu/Doc/Java/tutorial/java/threads/waitAndNotify.html)

**这**应该是您的解决方案，而不是用计时器隐藏您的忙碌等待。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-24T20:50:59.300

是的，你可以做一个

```
Thread.sleep(50) 
```

就像接受的答案建议的那样，您也可以致电

```
Thread.sleep(0) 
```

这将告诉处理器进行上下文切换。其他等待执行的线程（如 GUI 绘图线程）将被执行，机器将停止感觉缓慢。

sleep(0) 方式还将最大化操作系统为您的应用程序提供的时间，因为线程将立即返回处理器的队列（而不是在这样做之前等待 50 毫秒），因此如果没有其他线程在等待，您的线程将继续被执行。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-24T03:58:38.467

通常在游戏循环中你会暂停一下......例如：http: [//developers.sun.com/mobility/midp/articles/game/](http://developers.sun.com/mobility/midp/articles/game/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T03:59:07.903

看来您的线程正在忙着等待。也就是说，它被困在一个什么都不做的循环中。在这种情况下，它会消耗大量的 cpu 周期而没有效果。

正如其他人所提到的， Thread.sleep 就是答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T07:50:33.450

[这是与 swing 相关的](https://stackoverflow.com/questions/334038/the-correct-way-of-waiting-for-strings-to-become-equal)，但想法保持不变：尝试使用观察者模式而不是`wile(true)`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T11:11:25.293

一个基于 Quartz-Spring 的调度程序如何以重复的时间间隔一遍又一遍地完成工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-28T19:44:43.200

如果有中断，可能是有原因的。处理此问题的更好方法是

```
try {
    while (true) {
        Thread.sleep(50);
    }
} catch (InterruptException e) {
    Thread.currentThread().interrupt();
} 
```

但是这个循环没有做任何事情，所以我建议你删除它。您想忙于等待条件（在这种情况下，Condition 类是更好的选择）是相当罕见的，通常您可以转换相同的行为，根本不需要循环。

# html - 所见即所得的html表单打印

> ID：580424
> 
> 赞同：0
> 
> 时间：2009-02-24T03:56:43.073
> 
> 标签：html, css, forms, printing, wysiwyg

我正在启动这个网络应用程序项目（asp.net mvc）

这是一个基于文档的系统，因此几乎每个网页都是官方打印表单的模型（用户有时应该能够打印）。

我想知道如果表单可以是一个所见即所得的页面，可以为电子和纸质受众提供服务，它将节省多少成本和时间。

我知道 Adob​​e Acrobat 表单有类似的东西。本来对我的目的来说是完美的，但它不可插入——这意味着我对后端系统没有选择权。

有谁知道那里有任何东西可以将 pdf/like pdf 呈现给打印机但具有 html 表单提交功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T04:21:47.897

为什么不是 css 印刷媒体？例如，

```
<link rel="stylesheet" href="css/printstylesheet.css" media="print" /> 
```

您可以在同一页面中定义这两个东西。像这样的东西，

```
<link rel="stylesheet" href="css/mainstylesheet.css" media="screen" /> 
<link rel="stylesheet" href="css/printstylesheet.css" media="print" /> 
```

我希望这是您正在寻找的，但不确定。

摘自[Pro CSS Technique](http://www.digital-web.com/articles/css_styling_for_print_and_other_media/)一书。

**编辑：**

[CSS 打印媒体浏览器一致性](http://www.codestyle.org/css/media/print-BrowserSummary.shtml)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T14:19:44.437

查看 wkhtmltopdf... FOSS 并使用 webkit 渲染引擎（safari、google chrome）将 html 转换为 pdf... 我尝试在 windows 上编译它并让它工作。比我能找到的任何东西都要好得多。支持我可以扔给它的所有CSS。

# vb.net - 检查整数的最安全方法

> ID：580429
> 
> 赞同：4
> 
> 时间：2009-02-24T03:58:29.030
> 
> 标签：vb.net

这可能更像是一个优雅的问题而不是功能。我正在寻找从字符串和对象中检查整数的绝对安全的方法，

在 .net 中为此使用大多数内置函数似乎会产生第一次机会异常，显示在“立即”窗口中，并且随着时间的推移它们会逐渐增加。这些异常的含义是什么，因为它们似乎不会影响系统的运行。

这是我的两次尝试，都觉得笨拙，我知道必须有比使用 VB.IsDBNull 和 Integer.TryParse 更好的方法......或者我只是在肛门。

（从对象到整数）

```
 Dim nInteger As Integer = 0
    If oData Is Nothing OrElse VB.IsDBNull(oData) Then
    Else
        If bThrowErrorIfInvalid Then
        Else
            On Error Resume Next
        End If
        nInteger = CType(oData, Integer)
    End If
    Return nInteger 
```

（从字符串到整数）

```
 Dim nInteger As Integer = 0
    If sText Is Nothing Then
    Else
        If bThrowErrorIfInvalid Then
        Else
            On Error Resume Next
        End If
        Integer.TryParse(sText, nInteger) 
    End If
    Return nInteger 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-24T04:10:30.967

使用 Integer.TryParse 有什么问题？这就是它的目的...

```
int i = 0;
string toTest = "not number";
if(int.TryParse(toTest, out i))
{
   // it worked

} 
```

怎么这么笨重？（我知道 C# 不是 VB，但有相同的差异）

编辑：如果您还想从一个对象中进行检查（因为 TryParse 依赖于一个字符串）并且我不太确定您实际打算如何使用它，则添加。这是否涵盖了您的担忧，因为这种方法将检查您的两种情况？

```
 static bool TryParseInt(object o, out int i)
    {
        i = 0;

        if (o.GetType() == typeof(int))
        {
            i = (int)o;
            return true;
        }
        else if (o.GetType() == typeof(string))
        {
            return int.TryParse(o as string, out i);
        }

        return false;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T04:02:57.100

你可以试试这个：

```
Dim i as Integer
Try
    i = Convert.ToInt32(obj)
Catch
    ' This ain't an int
End Try 
```

`Convert`位于`System`命名空间中。

编辑：注意：如果您要将任何其他代码放入`Try`块中，请确保指定`Catch`应该捕获的唯一异常是`Convert.ToInt32`if/when 它失败时抛出的异常 - 否则如果出现某些问题，您可能会遇到令人讨厌的问题else 在那个 try/catch 应该失败。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T04:17:47.470

`Integer.TryParse`被设计成安全的方式来做到这一点：这就是为什么它首先被放入框架中。对于一个对象，你总是可以`ToString()`在使用之前调用`TryParse`。

`On Error Resume Next`如果您出于某种原因需要吞下错误，我也会避免使用`Try-Catch`块，因为它不太可能导致不必要的副作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T04:22:03.293

由于它是 VB，因此您还可以使用 IsNumeric 函数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T04:23:34.633

在您的第二个示例中，您似乎对 bThrowErrorIfInvalid 进行了不必要的检查，因为 Integer.TryParse 从不抛出错误。就像是

```
If bThrowErrorIfInvalid And Not Integer.TryParse(sText, nInteger) Then
   Throw New ArgumentException()
EndIf 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-23T07:29:31.807

```
Dim d As Double = 2.0
Dim i As Integer = CInt(d)
If d - i = 0 Then
     Debug.WriteLine("is integer")
Else
     Debug.WriteLine("not a integer")
End If 
```

# .net - 在 ASP.NET 中开发自定义登录/身份验证系统的最佳方法是什么

> ID：580439
> 
> 赞同：5
> 
> 时间：2009-02-24T04:05:58.340
> 
> 标签：.net, authentication, forms, login

我正在开发的网站将允许用户在 3 个级别登录。

级别 1 - 未登录

2 级 - 他们注册他们的电子邮件地址并收到确认电子邮件，然后以这种方式登录。

级别 2 - 他们使用用户名/密码登录，然后将其发送到 Web 服务。如果 Web 服务返回“成功登录”结果，则他们已登录到网站。

根据登录级别，某些网页将可用，而其他网页将受到限制。

我的问题是，我应该如何开发这个？

我正在用 ASP.NET MVC 做这个项目。

我应该只编写自己的 AccountController 代码吗？我应该使用 .NET Forms 身份验证吗？与仅使用 .NET 代码手动进行身份验证相比，Forms 身份验证有什么好处？

如果我自己这样做，在成功登录时，我只需将登录用户存储在会话变量中。这样做有什么害处吗，或者对于我正在做的事情，可以吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T04:35:57.317

在 SO 中检查这个先前的问题：

[我应该如何在我的 ASP.NET MVC 站点中实现用户成员资格？](https://stackoverflow.com/questions/510315/how-should-i-implement-user-membership-in-my-asp-net-mvc-site)

查看有关 ASP.Net MVC Membership Basics[的](http://www.squaredroot.com/post/2007/12/10/ASPNet-MVC-Membership-Basics.aspx)博客。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T09:35:08.753

我建议编写您自己的*自定义*会员/身份验证系统的最佳方式是实际使用 .NET 中的内置 MembershipProvider 类，并从中派生您自己的自定义类。[您始终可以通过从 .NET 框架内的System.Web.Security.MembershipProvider](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.aspx)（以及[Role](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.aspx)和[Profile](http://msdn.microsoft.com/en-us/library/system.web.profile.profileprovider.aspx)类！）类继承来创建自己的 Membership Provider ，并提供您自己的特定实现。这样，您将受益于使用可靠的“基础框架”来构建您的身份验证和授权系统。

通过从框架自己的基类派生您的自定义成员资格提供程序，您可以利用 ASP.NET 成员资格系统的许多内置功能，例如 web.config 文件中的声明式授权和内置的 ASP .NET 身份验证票证。[我在这里](https://stackoverflow.com/questions/565368/authorization-check-using-global-asax/565460#565460)回答了一个非常相似的问题，详细说明了其中一些好处。

我必须承认，由于在 ASP.NET 中的“标准”内置成员资格提供程序中遗​​漏了它，我确实发现一件不寻常的事情是缺乏一种简单的方法来允许用户在网站上注册但不能“验证”他们的帐户立即，而是向用户发送一封包含“验证链接”的电子邮件，他们必须点击该链接才能访问该网站。虽然这不是 ASP.NET MembershipProvider 类中的标准功能，但它相对容易实现。

Scott Mitchell 撰写了一系列关于 ASP.NET 的成员资格、角色和个人资料提供者的文章（包括一篇关于在允许登录之前通过电子邮件验证帐户的文章），可在此处找到：

[检查 ASP.NET 2.0 的成员资格、角色和配置文件](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)

如果您从 ASP.NET 提供程序派生自己的自定义提供程序，这应该会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T04:28:18.803

我强烈建议不要滚动您自己的身份验证系统。.net Forms auth 也很容易使用；你为什么要浪费时间自己建造它？身份验证系统有很多陷阱，除非你是 MS，否则你真的没有资源来构建和测试一个。

确定用户可以看到哪些页面是授权，您当然可以按照自己的方式编写代码。我建议查看 .net 中可用的身份/主体接口并覆盖“IsInRole”方法以满足您的需求。

会话对安全性并不是很好。它们在网络农场场景中效果不佳，当应用程序池决定回收时......所有用户都已注销。.net forms auth 默认使用 cookie。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T04:30:34.960

在您的情况下，我建议使用简单的表单身份验证。（请参阅[如何：实现简单表单身份验证](http://msdn.microsoft.com/en-us/library/xdt4thhy.aspx)）。一个简单的 LoginController 可以处理这个问题。

在 Session 中存储用户配置文件数据并没有什么“错误”，但是如果您需要对网站进行负载平衡，这可能会导致可伸缩性问题。推荐的方法是实现自定义 RoleProvider。（请参阅[实现角色提供者](http://msdn.microsoft.com/en-us/library/8fw7xh74.aspx)。）

至于访问控制，也许你可以有一个 BaseController 类来检查用户的当前角色，看看他们有什么样的访问权限。

# svn - SVN：一个工作副本，两个存储库？

> ID：580443
> 
> 赞同：19
> 
> 时间：2009-02-24T04:10:00.577
> 
> 标签：svn, repository, working-copy

我想知道如何为我的一个工作副本设置两个存储库。我的服务器需要一个存储库，以便我可以在两台电脑之间签入/签出；我需要在我的本地 pc 中使用另一个存储库，以便我可以快速查看 diff 的结果（我的 svn 服务器位于慢速共享主机上）

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T04:14:02.860

看看[存储库复制](http://svnbook.red-bean.com/en/1.4/svn.reposadmin.maint.html#svn.reposadmin.maint.replication)。

您可以设置 cron 作业以定期从一个存储库同步到另一个存储库。但是你必须确保提交只发生在两者之一。

如果两个存储库都发生提交，那么分布式版本控制系统（例如[git](http://git-scm.com/)、[Bazaar](http://bazaar-vcs.org/)或[Mercurial](http://www.selenic.com/mercurial/)）可能更适合您？例如，Git 甚至可以让您直接从 Subversion 存储库中提取和推送。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T04:20:36.480

Subversion 的差异操作不使用网络访问。这是 Subversion 优于 CVS 的一大优势。因此，我不确定您为什么会遇到该特定问题。

另一种方法是使用 Git，特别是`git-svn`在您的本地 PC 上。您可以在本地计算机上获得整个存储库历史记录的完整副本，并能够在本地区分和查看历史记录（以及 Git 为您提供的许多其他功能）。只要有可能，我现在就使用它`git-svn`来访问 Subversion 存储库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T04:21:33.093

如果您不必使用 SVN，您可能会更好地使用分布式版本控制系统，例如 Mercurial 或 Git。每台 PC 都有自己的存储库副本，更改可以直接在 PC 之间同步，也可以通过中央服务器上的另一个副本同步。由于每台 PC 都在本地存储了完整的存储库，因此您可以在没有网络访问的情况下进行 diff 或任何其他操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T04:14:28.943

如果您的本地机器是 linux，您可以创建一个 crontab 条目以每 X 分钟更新一次 svn 以使其与后台服务器保持同步。从那里您将在本地 svn 服务器上获得最新的副本以进行比较。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T04:41:36.647

您可以尝试使用[svk](http://svk.bestpractical.com/view/HomePage)作为本地客户端，而不是 svn。Svk 是一个使用 svn 存储库的伪分布式版本控制系统。

您将使用 svk 设置存储库的镜像，对其进行同步，然后您可以根据自己的喜好进行比较，尽可能多的修订，并且都是本地的。

您还可以创建镜像存储库的分支并将其用作结帐，然后您的提交也是仅限本地操作，当您准备好一批提交时，您将它们推送到远程 svn 存储库（并拉其他用户改回来，类似于 svn update 命令）。

两个警告：

1.  准备好使用命令行。据我所知，没有 TortoiseSVK 或其他 GUI。
2.  我只在linux上使用过svk。如果您使用的是 Windows，我不确定客户端有多好。

除此之外，我第二次使用 bazaar、mercurial 或 git，正如其他人建议的那样。Bazaar 可能是最容易使用的，并且有一个 TortoiseBzr GUI，我的一位同事说它非常可靠。

Git 是最难使用的。它就像一把瑞士军刀，几乎宽而不是长，所有的小玩意儿和老爸老妈都在里面，挂在上面，弹簧很紧，以至于你偶尔会切开手指试图撬开刀片出去。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-28T21:27:13.247

SVN 本身并不适合此类用例。你必须在这里和那里调整一些东西（比如编写 crons）。如果你想要开箱即用的东西来适应这些用例，试试 GIT。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T08:35:22.267

我不相信标准存储库复制会给你你想要的。使用该设置，一个代理始终是只读的，我认为在您的情况下并非如此。

您必须在签入之前执行 svn switch --relocate 来切换您正在查看的存储库。有点容易出错。

您所追求的是[通过代理写入](http://subversion.tigris.org/svn_1.5_releasenotes.html#webdav-proxy)。

如果您在本地计算机上使用 apache 和 mod_svn_dav 进行设置，您将拥有一个接收所有更新的本地存储库，您可以轻松地对其进行比较和签出，但所有写入都会返回到其他人的实际存储库正在使用并从中获取更新。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T10:10:03.100

svn diff 的结果不取决于您连接到服务器的速度；这是一个完全本地化的操作。

# c++ - C++ Express 版缺少哪些 Visual Studio 2008 生产力功能？

> ID：580448
> 
> 赞同：0
> 
> 时间：2009-02-24T04:13:10.787
> 
> 标签：c++, visual-studio, visual-studio-2008

我正在使用 Visual Studio C++ 2008 Express 来学习新项目的原生 API。我想知道的是：Visual Studio Express 缺少完整版中存在的哪些生产力功能，而您认为这些功能是理所当然的？[我不是指诸如 MFC 支持之类的大型“付费”功能 - 我正在考虑诸如“将文件复制到输出目录”](http://jelle.druyts.net/2005/10/20/CopyToOutputDirectory.aspx)之类的小功能（有时由插件提供）

此外，它不必特定于 C++ 版本——这只是我碰巧使用的确切版本。

注意：我是一位经验丰富的 Java 程序员，我最常使用 IntelliJ IDEA（免责声明：这仅供参考 - 我不想比较 VS 与 IDEA）。

编辑：修改为包括增强体验的插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T08:52:06.140

非常缺少使用插件的能力，例如 Visual Assist，它是**生产力的**助推器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T04:45:16.513

我都喜欢“哦，让我为你搜索一下”，但微软确实让生活变得艰难。似乎维基百科是我们目前最好的来源： [http://en.wikipedia.org/wiki/Microsoft_Visual_Studio_Express#Visual_C.2B.2B_Express](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio_Express#Visual_C.2B.2B_Express)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T04:53:26.480

如果您计划开发 C/C++ *WIN32 GUI*应用程序，那么缺少的主要组件是*资源编辑器*（即 GUI 构建器工具）。

Express 版本仍会编译资源文件，但您必须手动创建资源文件或使用第三方资源编辑器。

# java - 如何在 Java 应用程序中嵌入迷你控制台？

> ID：580449
> 
> 赞同：3
> 
> 时间：2009-02-24T04:13:48.417
> 
> 标签：java

我正在用 Java 制作一个小游戏，并想在游戏中添加一个 Quake 3 风格的控制台，它应该在切换时出现。你们知道有任何实现或任何类似的嵌入式控制台吗？

否则，有什么好办法呢？现在，我只是在 TextField 之上有一个 TextArea。澄清一下，我不是在寻找一个成熟的终端，我需要的是一个可以与游戏配合使用的小型控制台。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T05:46:12.453

查看[我](https://stackoverflow.com/questions/342990/create-java-console-inside-the-panel/343007#343007)对[其他类似问题](https://stackoverflow.com/questions/342990/create-java-console-inside-the-panel)的回答。我相信它回答了你的问题。

# c++ - 客户端中的套接字编程

> ID：580457
> 
> 赞同：-1
> 
> 时间：2009-02-24T04:16:00.593
> 
> 标签：c++, linux, sockets

我在 C++ 和 Linux 平台上编写了这个程序。

我写了一个客户端和服务器套接字程序。

在那个客户端程序中，我编写了套接字函数，然后立即执行了一些完全不依赖于套接字的其他操作（我为其他一些逻辑编写了 2 个 for 循环）。

之后，我准备了套接字所需的结构并编写了连接函数......因为连接返回-1，所以我收到了无法连接的错误。

但是对于同一个程序，如果我将 for 循环的逻辑写在 socket 函数之上，紧接着该结构和 connect 函数之后，那么它工作正常。

我无法获得的原因可能是什么？请在这方面帮助我。这是我的代码

* * *

这里 index1 和 index 2 是简单的整数变量。配置字符串是一个 char 数组，包含 127.0.0.1:7005（地址和端口号）...地址和端口是存储地址和端口号的 char 数组变量。

```
struct sockaddr_in s1;

for(index1=0;configstring[index1]!=':';index1++)
{
    address[index1] = configstring[index1];
}
address[index1++]='\0';

for(index2=0;configstring[index1]!='\0';index1++,index2++)
{
    port[index2] = configstring[index1];
}
port[index2++]='\0';

int port_num = changeto_int(port);

if((sock_fd = socket(AF_INET,SOCK_STREAM,0)) == -1)
{
    printf("unable to create a socket\n");
    return 0;
}

s1.sin_family=AF_INET;
s1.sin_port=htons(port_num);
s1.sin_addr.s_addr=inet_addr(address);
memset(s1.sin_zero, '\0', sizeof s1.sin_zero);
int errno;

if(connect(sock_fd,(struct sockaddr *)&s1,sizeof(s1)) == -1)
{
    printf("error:unable to connect\n");
    printf("Error in connect(): %s\n", strerror( errno));
    return -1;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T05:20:02.780

首先，永远不要做这样的事情：

```
int errno; 
```

errno 已经为您定义好了。

不仅如此，我建议您使用 perror() 而不是

```
printf("Error in connect(): %s\n", strerror( errno)); 
```

第三，您**不能**调用 printf 而不是 strerror(errno) 因为 printf 会将 errno 的值更改为成功。

第三，我建议看一下互联网上的例子并从它们开始。

我建议阅读`man select_tut`有很多关于如何做和做什么的好的书面代码示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T10:34:07.163

结构 sockaddr_in s1;

您能否在程序开始时尝试 s1 的 memset。我经历过一些类似的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T04:22:23.527

您是否尝试过在 errno 上调用 strerror？connect() 返回 -1 意味着 errno 已设置，并且应该有更多关于您的错误的信息。

```
printf("Error in connect(): %s\n", strerror(errno)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T04:42:20.983

您是否简单地考虑过您的接收器没有正确监听连接？

正如其他人所说，使用 perror 检查 errno 并将一些可用的调试打印到控制台。

没有您的示例代码，就无法帮助您。可能有一百万个原因。也许您的机器上有防火墙阻止连接？也许服务器没有在监听，或者端口不正确（您确实转换为网络字节顺序，不是吗？）。可能客户端连接到错误的地址或端口。也许你没有正确设置你的结构。

我推荐阅读[Beej 的 Socket Programming Doo-Daa](http://beej.us/guide/bgnet/)以获得对 Unix 上的套接字的一个很好的介绍（它紧跟在 Windows 上）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T09:42:47.753

你能打印关于地址和端口字符串的调试信息吗？

删除 errno 的东西，包含并使用 perror。

使用 -Wall 编译

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T04:46:34.503

从您`perror()`返回“非套接字上的套接字操作”的评论来看...您的`address`和`port`变量是如何声明的？是否有可能以`port[index2++]='\0'`某种方式覆盖`sock_fd`或类似？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-22T09:54:24.377

尝试添加：

```
inet_pton(AF_INET, your IP address, (void *)&server_address); 
```

在连接到服务器之前。另外，我有一种预感，幕后的问题可能出在服务器端。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-07T04:21:10.727

低级套接字编程既繁琐又容易出错。建议您开始使用像[Boost](http://www.boost.com)或[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)这样的框架来保护您免受这些低级细节的影响，并允许您独立于平台进行编程。

# asp.net - ASP：ItemTemplate 中的DropDownList：为什么允许 SelectedValue 属性？

> ID：580487
> 
> 赞同：11
> 
> 时间：2009-02-24T04:33:41.940
> 
> 标签：asp.net, data-binding, drop-down-menu, selectedvalue, templatefield

这段代码

```
<asp:DropDownList runat="server" ID="testdropdown" SelectedValue="2">
    <asp:ListItem Text="1" Value="1"></asp:ListItem>
    <asp:ListItem Text="2" Value="2"></asp:ListItem>
    <asp:ListItem Text="3" Value="3"></asp:ListItem>
</asp:DropDownList> 
```

产生此错误：

> 不能以声明方式设置“SelectedValue”属性。

然而，对于数据绑定的 GridView，这是一个合法且常用的编辑模板。该`SelectedValue`属性当然似乎是在此处以声明方式设置的。

```
<EditItemTemplate>
    <asp:DropDownList runat="server" 
        ID="GenreDropDownList"
        DataSourceID="GenreDataSource" 
        DataValueField="GenreId"
        DataTextField="Name"
        SelectedValue='<%# Bind("Genre.GenreId") %>'>
    </asp:DropDownList>
</EditItemTemplate> 
```

问题是：允许以声明方式设置它的情况与不允许设置的情况有什么区别？错误消息暗示它永远不允许。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-03-13T07:49:09.310

在标记中使用 SelectedValue='<%# "32" %>' 语法。（注意以下示例中单引号和双引号的顺序）：

```
 <asp:DropDownList  ID="ddlField" SelectedValue='<%# "32" %>' 
   runat="server"   DataTextField="Name" DataValueField="ID"  >
  </asp:DropDownList> 
```

或在 DataBinding 之后的代码隐藏中。（示例）：

```
 ddlField.DataSource = Fields.SelectAll();
  ddlField.DataBind();           
  ddlField.SelectedValue = "32"; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T04:39:44.967

这意味着您无法通过设计器进行设置。

正确的方法是：

```
<asp:DropDownList runat="server" ID="testdropdown">
    <asp:ListItem Text="1" Value="1"></asp:ListItem>
    <asp:ListItem Text="2" Value="2" Selected></asp:ListItem>
    <asp:ListItem Text="3" Value="3"></asp:ListItem>
</asp:DropDownList> 
```

绑定方法起作用的原因是该值不是在设计模式中选择的，而是在控件绑定到数据源后的运行时选择的

DropDownList.SelectedValue 方法旨在在运行时应用，因此无法将其设置为“装饰性”的错误

# wpf - WPF依赖属性数据绑定问题

> ID：580496
> 
> 赞同：1
> 
> 时间：2009-02-24T04:39:35.263
> 
> 标签：wpf, data-binding, xaml

我在 WPF 中创建了一个用户控件。此用户控件有几个文本框，这些文本框绑定到数据库对象上的属性，该数据库对象由 UserControl 上的属性引用。xml 看起来像：

```
<TextBox Name="_txtFirstName" Text="{Binding Path=Contact.FirstName, UpdateSourceTrigger=PropertyChanged}"/> 
```

在我将 Contact 属性设置为依赖属性以便我可以将其绑定到 ListBox 中的选定项之前，这一直正常工作。一旦我这样做了，TextBoxes 的绑定就会停止工作。为什么是这样？

DependencyProperty 代码是：

```
public static readonly DependencyProperty ContactProperty = DependencyProperty.Register(
"Contact", typeof(Contacts), typeof(ContactView)); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T01:44:37.213

我解决了这个问题。我忘了更改此代码：

```
 public Contacts Contact
    {
        get { return _contact; }
        set { _contact = value; }
    } 
```

对此：

```
 public Contacts Contact
    {
        get { return (Contacts)GetValue(ContactProperty); }
        set { SetValue(ContactProperty, value); }
    } 
```

现在它可以正常工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T11:41:22.473

我用谷歌搜索并发现[了这个有趣的页面](http://geekswithblogs.net/thibbard/archive/2008/04/22/wpf-custom-control-dependency-property-gotcha.aspx)。你有为你的依赖属性定义的 CallBackHandler 吗？

# java - .NET、Java 到 JavaScript 编译器

> ID：580509
> 
> 赞同：10
> 
> 时间：2009-02-24T04:49:13.680
> 
> 标签：java, .net, javascript

我有兴趣创建一个仅使用 JavaScript、HTML 和 CSS 的拖放式布局设计器。设计器将允许用户将页面元素从一个地方拖到另一个地方（类似于[Blogger](http://en.wikipedia.org/wiki/Blogger_%28service%29)的布局设计器）以创建站点布局。但我不想用 JavaScript 编写所有代码，我更愿意用 .NET（最好）或 Java 编写我的应用程序，并依靠编译器将其编译为 JavaScript 和 HTML。

您**使用过并且可以推荐**的 .NET 或 Java 到 JavaScript 编译器是什么？对于 Java 到 JavaScript，我知道[GWT](http://code.google.com/webtoolkit/)是可用的。.NET 到 JavaScript 怎么样？微软确实推出了[Volta](http://livelabs.com/volta)，但该项目似乎不再可用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T04:51:20.167

别再看了，你已经提到了 GWT 选择那个！

它有一个非常好的 API，许多优秀的应用程序都使用了它们。

[甚至像http://extjs.com/](http://extjs.com/)这样的JavaScript 框架也支持 GWT。

我最近将它用于小型 JavaScript 日历。

老实说，我不太喜欢 JavaScript。大多数时候错误很难跟踪（特别是对于像我这样的非 JavaScript 人），解决方法包括一些用于浏览器的插件，只是为了准确地了解编译器应该做什么。尽早发现愚蠢的错误。

另一方面，我非常熟悉 Java 编程语言，并且许多库（如果不是最重要的）如 java.lang 和 java.util 已被移植到 GWT。

另外，编写 java.util 相关部分的人与 GWT 背后的人相同（谷歌 Joshua Bloch。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T05:06:24.310

查看 Nikhil Khotari 的[Script#](http://projects.nikhilk.net/ScriptSharp/)项目。它允许您编写 C# 代码并将其编译为 JavaScript。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T10:09:49.593

*   [Script#](http://projects.nikhilk.net/ScriptSharp/)已经被提及。它自 2008 年 8 月以来一直没有更新。
*   [Milescript](http://www.milescript.org/)是另一个，但 6 个月以来也很少见。
*   [Ext 库的Extsharp](http://code.google.com/p/extsharp/)。添加对脚本的 Ext 支持#
*   [Javascript 编译器到 Java](http://www.mozilla.org/rhino/jsc.html)（对你来说是错误的方式）
*   [Java 脚本](http://j2s.sourceforge.net/)Eclipse 插件

我对 Script#（一个已知问题）的问题是它还不支持 jQuery。然而，在 Nikhil 的 sscorlib.js 文件和 ssfx.core.js 文件中，它带有一个非常轻量级的库来与 .NET 框架结合。并且还支持许多其他 Javascript API（主要是 Microsoft，因为他在 ASP.NET 团队中）。

我很想看到 jQuery 的 Script# 扩展（如果足够简单，我正在考虑编写它）。就目前而言，大多数还没有提供完整的编译，但他们肯定会到达那里。

**更新**：几个月前我写了一个小扩展来启用 JQuery 支持脚本#。该项目可以在[这里](http://code.google.com/p/jquerysharp/)找到。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-05T16:26:40.467

我将支持[GWT](http://code.google.com/webtoolkit/)的使用。我已经将它用于多个项目，并且当与[Eclipse](http://www.eclipse.org/)或[IDEA](http://www.jetbrains.com/idea/)等现代编辑器结合使用时，它确实使[混乱](https://stackoverflow.com/questions/247209/javascript-how-do-you-organize-this-mess)变得易于管理。

重要的是要注意，它不仅允许您用 Java 编写并将其转换为优化和[混淆](http://code.google.com/support/bin/answer.py?answer=55203&topic=10212)的 Javascript，它还带有核心 Java API 的一个[重要子集。](http://code.google.com/docreader/#p=google-web-toolkit-doc-1-5&s=google-web-toolkit-doc-1-5&t=RefJreEmulation)除此之外，它们还提供了许多额外的类，用于解析和使用[JSON](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/json/client/package-summary.html)和[XML](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/xml/client/package-summary.html)以及通过[异步 HTTP](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/http/client/package-summary.html)与服务器通信。您可以查看[文档](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/index.html?overview-summary.html)以了解他们提供的其他内容。

您可能对实现拖放功能特别感兴趣的另一个特性是它与[Ext](http://extjs.com/) 和[scriptaculous](http://script.aculo.us/)等 JavaScript 库的集成。通过预先构建的[接口](http://extjs.com/products/gxt/)或通过[JSNI](http://googlewebtoolkit.blogspot.com/2008/07/getting-to-really-know-gwt-part-1-jsni.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-04T11:39:07.763

Java 也有[J2S](http://j2s.sourceforge.net/)。

> Java2Script (J2S) Pacemaker 提供了一个 Eclipse Java to JavaScript 编译器插件和一个 JavaScript 版本的 Eclipse Standard Widget Toolkit (SWT) 与其他常用实用程序，例如 java.lang.* 和 java.util.*。您可以通过 Java2Script Pacemaker 将基于 SWT 的富客户端平台 (RCP) 转换为富 Internet 应用程序 (RIA)。

这意味着如果您使用 SWT IDE（拖放），您可以将生成的代码转换为 JS + HTML。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T11:48:39.240

我不会为 UI 手写任何 Javascript。这可能导致维护灾难。jQuery 是我正在使用的，但我仍然不会使用它来编写完整的 UI Javascript 代码。[如果您打算用 Javascript 编写， ExtJS](http://extjs.com/) 也是另一个不错的选择。一般来说，我在这里要说的是，Java/C# 比 Javascript 容易得多。查看[卡布奇诺框架](http://cappuccino.org/)和[Atlas](http://280atlas.com/)。从未使用过GWT。[Script#](http://projects.nikhilk.net/ScriptSharp/)类似于 GWT，但用于 ASP.NET 框架。还取决于要求，如果您的网站是面向公众的，那么 RIA 不是一个好的选择。这完全取决于您追求的极端（手写和 Web 标准，或 RAD 或像 jQuery/ExtJS 这样的库作为中间选项）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T15:07:56.007

查看[Axial](http://www.codeplex.com/axial)，这是一个在 ASP.NET 中运行良好的 .NET 到 JavaScript 转换器。它支持 WebForms、jQuery 和画布。它不是很成熟，但值得一看。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-06T11:35:01.460

[http://jsc.sourceforge.net/](http://jsc.sourceforge.net/)是一个 C# 到 JavaScript、Java、Flash 和 PHP 的编译器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-07T08:13:54.477

JscriptSuite 为 Javascript 编译器提供了另一个免费的 .NET。Saltarelle（jsc、SharpKit#等）有很大的不同。开发人员只编写和调试 C# 代码（或任何其他 .NET 语言），就像在 GWT 中一样。Javascript 将仅在部署时生成。

# asp.net - 解决 .net Web 应用程序中的可伸缩性和性能问题

> ID：580514
> 
> 赞同：4
> 
> 时间：2009-02-24T04:53:50.533
> 
> 标签：asp.net, performance, architecture, scalability

我正在开发一个有很多并发用户的.net 门户。因此可扩展性、性能需要在设计和架构中加以解决。我们计划在应用程序中使用负载平衡。

记住这一点，在 IIS Web 服务器（托管 aspx、aspx.cs 文件）和应用程序服务器（托管 .net 程序集，如业务逻辑和数据访问层）之间进行通信的最佳方式是什么？它应该是 .net 远程处理还是肥皂网络服务？还是有其他方法？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T05:13:50.080

***还有另一种方法吗？*** 是的 - 不要分发你的对象。最具可扩展性的方法是不要将您的对象彼此分开。问问自己，为什么要将一种风格的代码部署到“应用服务器”而另一种风格的代码部署到“Web 服务器”？这两个层之间进行的通信，如果它们是分布式的，将比本地调用昂贵得多（等等）。

对于当今的 64 位服务器、所有内存和热 CPU，以及 ASP.NET 卓越的内存管理，为什么不将业务逻辑和 DAL 与 ASPX 文件放在同一台物理机器上呢？为什么不？

如果您需要扩展，请添加更多服务器。简单的。

当然，分发是有充分理由的。最常见的充分理由与所有权领域有关 - 沿着几个轴：安全管理，甚至预算和控制。换句话说，对于后一种情况，如果团队负责运行业务逻辑，而一个单独的团队负责构建和运行 Web 层——那么分配这两个东西以允许管理的独立性可能是有意义的。大多数分发计算机代码的充分理由都源于使用或开发代码的人类组织的结构。

一个网页不应该在同一个 CPU 上运行，共享同一个 CLR 虚拟机和内存堆，作为数据库访问层，没有什么好的*技术*理由。

无论您如何处理分发，使用定义层之间连接的不太正式的接口来构建您的系统都是不明智的。如果您保留正式的接口，那么衡量分布式方法与协同定位方法的性能和效率应该没有问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T05:13:12.297

你真的需要一个应用服务器吗？你到底在说多大？例如 Stackoverflow.com 每天有大约 50k 的唯一身份，并且没有应用服务器，所以我假设您说的比这大得多？大多数性能瓶颈都归结为数据库问题，因此我将专注于这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T06:01:58.763

我建议您查看 Patterns and Practices groups 性能指南，更具体地说是[第 6 章 - 提高 ASP.NET 性能](http://msdn.microsoft.com/en-us/library/ms998549.aspx "第 6 章 - 提高 ASP.NET 性能")指南。我同意 Cheeso 的观点，如果可以的话，您应该认真考虑不要在物理上拆分您的应用程序层和 UI 层。P&P 指南有以下注释：

> **避免不必要的进程跳跃**
> 
> 尽管进程跃点不像机器跃点那么昂贵，但您应该尽可能避免使用进程跃点。进程跃点会导致额外的开销，因为它们需要进程间通信 (IPC) 和封送处理。例如，如果您的解决方案使用企业服务，请尽可能使用库应用程序，除非您需要将企业服务应用程序放在远程中间层。
> 
> **了解远程中间层的性能影响**
> 
> 如果可能，请避免进程间和计算机间通信的开销。除非您的业务需求要求使用远程中间层，否则请将您的演示、业务和数据访问逻辑保留在 Web 服务器上。将您的业务和数据访问程序集部署到应用程序的 Bin 目录。但是，出于以下任何原因，您可能需要远程中间层：
> 
> *   您希望在面向 Internet 的 Web 应用程序和其他内部企业应用程序之间共享您的业务逻辑。
> *   您的横向扩展和容错要求决定了使用中间层集群或负载平衡服务器。
> *   您的公司安全策略要求您不能将业务逻辑放在您的 Web 服务器上。

如果您无论如何都必须拆分应用程序逻辑，则可以使用 WCF 作为传输机制。我不确定它在性能方面如何与远程处理相提并论。但是，我似乎记得这是微软正在推动的指导方针。

Clemens Vasters（Microsoft .NET 服务总线的技术主管）在 MSDN 论坛上的[这个答案](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/5219ca92-df97-451d-a44c-cfa4a88c10ae/ "在远程处理和 WCF 之间进行选择")中谈到了 WCF 与远程处理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T07:55:46.293

学习异步编写。
例如，探索 CCR 运行时。

**每个**因等待 IO 响应而被阻塞的线程对您的系统来说都是可用的**。**

关闭“理想化日志记录”保留通过管理控制台重新打开它的能力。但伐木往往是一个隐藏的瓶颈。

缓存缓存缓存！

如果第一次获取数据的成本很高，那么第二次就不要为它买单了！

避免 ASP.net 的会话状态 - 这可能会严重膨胀并导致页面响应速度大大减慢。

修改 http 标头以指定短浏览器缓存（5 秒 - 20 秒）（取决于内容的性质）

在您使用 GZIP 时使用它！

并使用大量 RAM

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T06:39:14.260

[Omar Al Zabir](http://msmvps.com/blogs/omar/)的这些文章中有一些良好的性能和可扩展性要点。
[10 个 ASP.NET 性能和可扩展性秘密](http://www.codeproject.com/KB/aspnet/10ASPNetPerformance.aspx)
以及
[99.99% 可用的 ASP.NET 和 SQL Server SaaS 生产架构](http://www.codeproject.com/KB/aspnet/ProdArch.aspx)
（另请参阅他的书[Building a Web 2.0 Portal with ASP.NET 3.5](http://oreilly.com/catalog/9780596510503/)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T07:03:00.380

这是我的提示

1) 将所有静态文件 - images、css、js 移动到 nginx 等负载均衡器。这将大大减少 IIS 服务器上的负载，并且它将有足够的空闲资源来服务主要请求。

2）考虑缓存和完全避免数据库访问。

3）尽量实现REST原则。

4）将会话状态保持在最低限度 - 如果可能的话完全避免它。

# c - C中的二叉树

> ID：580520
> 
> 赞同：1
> 
> 时间：2009-02-24T05:00:17.477
> 
> 标签：c, binary-tree

我正在尝试按顺序将节点插入树中。我的功能工作正常......当只有三个节点时。

我有这个代码：

```
typedef struct _Tnode Tnode;
struct _Tnode {
    char* data;
    Tnode* left;
    Tnode* right;
}; 
```

除此之外：

```
Tnode* add_tnode(Tnode* current_node, char* value) {
Tnode* ret_value; 

if(current_node == NULL) {
    current_node = (Tnode*) malloc(sizeof(Tnode));

    if(current_node != NULL) {
      (current_node)->data = value;
      (current_node)->left = NULL;
      (current_node)->right = NULL;
      ret_value = current_node; }
    else 
        printf("no memory");    
}
else {
    if(strcmp(current_node->data,value)) {  //left for less than 

        ret_value = add_tnode((current_node->left), value);
        current_node -> left = (Tnode*) malloc(sizeof(Tnode));
        (current_node -> left) -> data = value;
    }

    else if(strcmp(current_node->data,value) > 0) {

        ret_value = add_tnode((current_node -> right), value);
        current_node -> right = (Tnode*) malloc(sizeof(Tnode));
        (current_node -> right) -> data = value;
    }

    else {
        printf("duplicate\n");
        ret_value = current_node;
    }
}

return ret_value; 
```

}

我知道这里出了什么问题，我只是不知道如何解决它。这只是覆盖连接到根节点的两个节点。IE

```
 |root_node|
        /           \
|node_2|             |node_3| 
```

我无法添加节点 4。它只是根据输入覆盖节点 2 或 3。经过调试和一些研究，我不太确定从这里去哪里......

如果有人可以提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T05:12:13.987

这似乎只是一个学校项目。

从哪里开始。

1）你一直在树下左右摇摆。我不确定您为什么希望它们被保留，因为：a）您总是写入这些节点。b）您返回现有节点的唯一时间是在 strcmp 匹配上。

2）您确实需要在第一次比较时检查 strcmp < 0 。

3）对于非平衡树，没有理由使用递归 - 您可以使用循环直到到达叶子然后钩住叶子。如果你真的想要递归......

4）递归...在所有情况下都返回NULL，除非您创建一个节点（即：您拥有当前== NULL的第一部分）。

5）在左/右，将返回值存储在临时本地节点*中。仅当返回值不为 NULL 时才应分配左/右。

即使这对我来说也不合适，但如果我从头开始，它看起来根本不会像这样。:) 我们甚至不会陷入内存泄漏/崩溃中，你可能会通过随意推动'char *'值来结束所有的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T05:13:54.043

您应该只在插入到达叶节点（即NULL）的情况下进行分配。在其他情况下，您应该做的就是根据您的比较遍历到下一个级别。在您的情况下，您将遍历到下一个级别，然后使用新的 malloc 将其杀死。正因为如此，你永远不会超过第一级。

例如。

```
if (current_node == NULL) // Do initialization stuff and return current_node

if (strcmp(current_node->data, value) < 0) {
    current_node->left = add_tnode((current_node->left), value);
} else if (strcmp(current_node->data, value) > 0) {
    current_node->right = add_tnode((current_node->right), value);
}

return current_node; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T05:34:16.240

```
struct _Tnode {
        char* data;
        struct _Tnode * left, * right;
    };
    typedef struct _Tnode Tnode;

void addNode(Tnode ** tree, Tnode * node){

    if(!(*tree)){
        *tree = node;
        return;
    }

    if(node->data < (*tree)->val){
       insert(&(*tree)->left, node);
    }else if(node->data>(*tree)->data){
       insert(&(*tree)->right, node);
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T05:12:28.290

对于初学者 - 第一个 strcmp

if(strcmp(current_node->data,value))

可能是不正确的 - 这对于小于和大于都是正确的，然后第二个 if 没有意义

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T05:08:34.977

我想您需要将指向父节点的指针添加到`_Tnode`结构中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T05:13:12.500

问题是，在对左侧分支的 add_tnode 进行递归函数调用之后，例如，您正在用 malloc 删除同一个分支。malloc 应该只在您递归到要添加节点的点时发生，而不是在您进行递归调用时发生。

本质上，在特定的函数调用中，您应该进行递归调用或 malloc 一个新节点，而不是两者。

这也可能会产生内存泄漏。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T05:15:31.170

一旦发现 current_node->data 不为 null 并将其与 value 进行比较，您首先必须检查相应的指针 current_node->left（或 ->right）是否已在使用中（！= NULL）。

如果它为空，则照常进行。这就是现在工作正常的情况。

如果没有，您必须针对相应节点重新测试整个事情，在相应节点上再次调用您的函数。这里有一些伪代码：

用以下代码包装代码：

```
void Add_node(Tnode* current_node) {
...
else {
        if(strcmp(current_node->data,value) < 0) {  //left for less than 
           if(current_node->left != NULL) {
                Add_node(current_node->left);
           } else {
                ret_value = add_tnode((current_node->left), value);
                current_node -> left = (Tnode*) malloc(sizeof(Tnode));
                (current_node -> left) -> data = value;
        } else if(strcmp(current_node->data,value) > 0) {
                Add_node(current_node->right);
           } else {
           ...
} 
```

这称为递归（一个函数调用本身）并遍历树。要读取某个节点，您必须再次执行递归函数。小心它们终止（这里在某些时候左或右指针将为空，从而终止递归调用）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T05:18:07.310

如果您不是为了自己的启迪而实施它，我只会使用[libavl](http://www.stanford.edu/~blp/avl/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T05:22:31.980

您不需要知道节点的父节点。只是当前节点的值。

伪代码：

```
add_treenode(root, value) 
```

{

```
 //check if we are at a leaf  
 if root == null
     allocate space for new node.
     set children to null
     save root->value = value
     return root // if you need to return something, return the node you inserted.
 //if not, this node has a value
 if root->value < value  //use strcmp since value is a string
       add_tnode(root->left, value)
 else
       add_tnode(root->right, value)
 return NULL 
```

}

在插入新树节点时，这与它一样干净。传递要插入的节点的根和值，剩下的就交给它了。

# java - NoElementException 但我打印了元素并得到了预期的结果

> ID：580521
> 
> 赞同：0
> 
> 时间：2009-02-24T05:00:48.413
> 
> 标签：java, exception, vector, logic

我想要做的是将一个移动对象保存到一个名为 topMoves 的向量中。会有很多 Move 对象，这就是我在循环中创建对象的原因。

pastPriceMap 存储过去某个时间（在本例中为一分钟前）的股票价格。currPriceMap 存储最后一秒内某个时间的股票价格。

我得到以下异常：

线程“Timer-0”中的异常 java.util.NoSuchElementException

这是导致问题的行： amove.setInitPrice(pastPriceMap.get(iter.next()));

代码片段如下。当我执行 System.out.println 语句时，我得到了预期的输出：

```
Iterator<String> iter = sortedTopCodes.iterator();

while(iter.hasNext()){

    System.out.println(currPriceMap.get(iter.next()));
    System.out.println(pastPriceMap.get(iter.next()));

        Move amove = new Move();
    amove.setSecCode(iter.next());
    amove.setPrice(currPriceMap.get(iter.next()));
    amove.setInitPrice(pastPriceMap.get(iter.next()));
    topMoves.add(amove);
}

    return topMoves; 
```

* * *

Move 类如下所示：

```
private String secCode;
private double price;
private double initPrice;

public String getSecCode() {
    return secCode;
}
public void setSecCode(String secCode) {
    this.secCode = secCode;
}
public double getPrice() {
    return price;
}
public void setPrice(double price) {
    this.price = price;
}

public double getInitPrice() {
    return initPrice;
}
public void setInitPrice(double lastPrice) {
    this.initPrice = lastPrice;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T05:11:12.053

简短的回答：

每次调用**hasNext()**都应该只调用**一次 next()**

在您的代码中，您有 5 个**next()**只有一个**hasNext()**

在这里，阅读：http: [//java.sun.com/javase/6/docs/api/java/util/Iterator.html](http://java.sun.com/javase/6/docs/api/java/util/Iterator.html)

**编辑**

更长的答案：

基本上，迭代器用于......很好地迭代“某物”的元素，通常是一个集合，但它可以是任何东西（假设任何东西都返回一个 Iterator ）。

由于您可能不知道“任何东西”有**多少元素**，所以必须有一种方法来停止迭代对吧？（如果它是一个数组，你可以通过长度属性来判断，但迭代器用于“封装”实现中使用的数据结构）无论如何。

迭代器 API 定义了这两个方法

```
-hasNext(): boolean 
-next(): Object ( or <E> since Java 1.5 ) 
```

所以典型的成语是这样的：

```
 while( iterator.hasNext() ) { // reads: while the iterator has next element
      Object o = iterator.next(); //  give me that element
 } 
```

如果迭代器只有两个项目会发生什么？

```
 while( iterator.hasNext() ) { // the first time will return true, so the next line will be executed.

      Object o = iterator.next(); // give me that item. ( 1st element ) 

      Object b = iterator.next(); // oops dangerous by may work ... ( 2nd element ) 

      Object c = iterator.next(); // eeeerhhh... disaster: NoSuchElementException is thrown.

} 
```

这就是发生在你身上的事情。您没有验证迭代器是否有另一个元素，您只需检索它。如果迭代器碰巧有一些元素，它可能会工作一段时间，但有一段时间（如您刚刚看到的）它会失败。

顺便说一句，**不要**想着捕捉 NoSuchElementException。这是一个运行时异常，它表明您的代码逻辑中的某些内容应该被修复。

请参阅[此答案](https://stackoverflow.com/questions/462501/exception-other-than-runtimeexception/462745#462745)以了解有关异常的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T05:25:23.970

这是使用新 for 循环的版本：

```
for ( String secCode : secCodeList ) {

        System.out.println(currPriceMap.get(secCode));
        System.out.println(pastPriceMap.get(secCode));

        Move amove = new Move();
        amove.setSecCode(secCode);
        amove.setPrice(currPriceMap.get(secCode));
        amove.setInitPrice(pastPriceMap.get(secCode));
        topMoves.add(amove);
} 
```

以旧的方式：

```
String secCode = null;    
for ( Iterator<String> it = secCodeList.iterator(); it.hasNext() ) {
    secCode = it.next();
    System.out.println(currPriceMap.get(secCode));
    System.out.println(pastPriceMap.get(secCode));

    Move amove = new Move();
    amove.setSecCode(secCode);
    amove.setPrice(currPriceMap.get(secCode));
    amove.setInitPrice(pastPriceMap.get(secCode));
    topMoves.add(amove);
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T05:07:51.220

```
// 当有更多行时
而（扫描仪.hasNextLine（））
{
    最后的字符串行；
    最后的 String[] 个单词；

    // 获取下一行
    线 = 扫描仪.nextLine();

    // 将行拆分为单词（\\s+ 应该通过空格将其拆分）
    words = line.split("\\s");

    if(words.length != 5)
    {
        throw new WhatExceptionMakesSense(line + " 必须包含 5 个单词");
    }

    System.out.println(currPriceMap.get(words[0]));
    System.out.println(pastPriceMap.get(words[1]));

    移动 amove = new Move();
    amove.setSecCode(words[2]);
    amove.setPrice(currPriceMap.get(words[3]));
    amove.setInitPrice(pastPriceMap.get(words[4]));
    topMoves.add(amove);
}

```

# actionscript-3 - AS3 AutoSize 文本字段

> ID：580528
> 
> 赞同：1
> 
> 时间：2009-02-24T05:07:25.680
> 
> 标签：actionscript-3, flash-cs4

在 AS3 中，我正在制作这个动态文本字段，它根据用户单击的位置从 XML 文件中填充。

动态文本字段有一个自定义滚动条。我的问题是，如果插入到文本字段中的文本少于先前显示的文本，您仍然可以将动态文本字段滚动到前一个。

有没有办法重置文本字段 autoSize？

非常感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T05:40:45.010

如果您在谈论 Flash（我在 Flex 方面的经验很少），那么 [textField.autosize](http://www.adobe.com/support/flash/action_scripts/actionscript_dictionary/actionscript_dictionary729.html)属性可能会让您朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T05:20:18.957

我认为这个[链接](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000885.html)会告诉你到底该怎么做。

~~您是否使用任何标准的 flex 控件？或者，这是闪光灯？~~

您可以将字段的宽度设置为字符串长度 + 一些空间（通过将宽度绑定到字符串的长度/事件处理等）。[这](http://livedocs.adobe.com/flex/3/html/help.html?content=Working_with_Text_08.html)可能很有趣。当然，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T01:15:59.120

试试这个，将 xml 元素文本包装在

```
<text><![CDATA[<span class="someClass">Some Text Here</span>]]></text> 
```

如果先前没有包含在 中`CDATA`，flash 会采用`<span class="someClass">`并尝试将其放下一行并缩进它，就像使用 XML 层次结构一样；`CDATA`告诉 flash 忽略这些字符并将它们视为字符串。不使用此过程的结果是您的文本字段中有许多奇怪的间距。

还要确保您`TextField`的设置为多行和自动换行，以及`autoSize`诸如`TextFieldAutoSize.LEFT`;

# security - 限制（和记录）登录尝试的最佳方式

> ID：580534
> 
> 赞同：24
> 
> 时间：2009-02-24T05:09:45.177
> 
> 标签：security, login, captcha

显然，某种限制登录尝试的机制是安全要求。虽然我喜欢尝试之间的时间呈指数增长的概念，但我不确定存储信息的内容。我也对替代解决方案感兴趣，最好不包括验证码。

我猜由于阻止 cookie 或自动清除它们，cookie 将无法工作，但会话会起作用吗？还是必须将其存储在数据库中？不知道可以/正在使用哪些方法，所以我根本不知道什么是实用的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-24T05:18:36.870

使用用户表“failed_login_attempts”和“failed_login_time”中的一些列。第一个在每次登录失败时递增，并在成功登录时重置。第二个允许您将当前时间与上次失败时间进行比较。

您的代码可以使用数据库中的这些数据来确定等待锁定用户的时间、允许登录之间的时间等

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T05:16:46.533

假设谷歌已经完成了必要的可用性测试（不是一个不公平的假设）并决定使用 captchas ，我建议与他们一起去。

当我是一个真正的用户并且忘记了我的密码时，增加超时令人沮丧（有很多网站及其相关密码发生了很多，尤其是对我而言）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T05:17:02.600

在数据库中存储尝试是最好的解决方案恕我直言，因为它为您提供了安全漏洞尝试的审计记录。根据您的应用程序，这可能是也可能不是法律要求。

通过记录所有错误的尝试，您还可以收集更高级别的信息，例如请求是否来自一个 IP 地址（即某人/事物正在尝试暴力攻击），因此您可以阻止该 IP 地址。这可能是非常有用的信息。

一旦您确定了一个阈值，为什么不强迫他们要求将电子邮件发送到他们的电子邮件地址（即类似于“我忘记了我的密码”），或者您可以采用 CAPCHA 方法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-06-28T15:37:08.277

这篇文章中的答案优先考虑以数据库为中心的解决方案，因为它们提供了一种使审计和锁定逻辑方便的记录结构。

虽然这里的答案解决了对个人用户的猜测攻击，但这种方法的一个主要问题是它会使系统容易受到[拒绝服务](https://en.wikipedia.org/wiki/Denial-of-service_attack)攻击。来自世界的任何请求都不应**触发**数据库工作。

应在 req/res 周期的早期实施替代（或附加）安全层，以保护应用程序和数据库免于执行昂贵且不必要的锁定操作。

[Express-Brute](https://www.npmjs.com/package/express-brute)是一个很好的例子，它利用 Redis 缓存过滤掉恶意请求，同时允许诚实请求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T05:17:03.223

您知道哪个用户 ID 被击中，保留一个标志，当它达到阈值时，只需停止接受该用户的任何内容。但这意味着您为每个用户存储一个额外的数据值。

> 我喜欢尝试之间的时间呈指数增长的概念，[...]

您实际上可以在连续尝试之间随机延迟，而不是使用指数增加的时间。

也许如果您解释您正在使用的技术，这里的人们将能够提供更具体的示例。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T13:40:56.117

锁定政策一切都很好，但有一个平衡点。

一个考虑因素是考虑用户名的构造 - 可以猜测吗？可以列举出来吗？

我正在对一个带有员工门户的 dotcom 进行外部应用程序笔测试，该门户网站为 Outlook Web Access /Intranet 服务、某些应用程序提供服务。枚举用户很容易（网站本身的执行/管理团队，以及通过谷歌、Facebook、LinkedIn 等）。一旦您获得了用户名登录的格式（名字然后姓氏作为单个字符串输入），我就有能力将 100 名用户拒之门外，因为他们的 3 次罢工和淘汰政策。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T05:17:12.240

存储信息服务器端。这将使您还可以防御分布式攻击（来自多台机器）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T05:25:18.523

您可能想说阻止登录一段时间，例如 3 次失败尝试后的 10 分钟。成倍增加的时间对我来说听起来不错。是的，将信息存储在服务器端会话或数据库中。数据库更好。没有cookies业务，因为它很容易被用户操纵。

您可能还希望将此类尝试映射到客户端 IP 地址，因为当其他人试图通过失败尝试猜测有效用户的密码时，有效用户很可能会收到一条被阻止的消息。

# iphone - UINavigationItem 回退问题

> ID：580535
> 
> 赞同：0
> 
> 时间：2009-02-24T05:10:04.177
> 
> 标签：iphone

我的视图控制器中有一个 UINavigationController，从当前视图控制器推送另一个视图控制器后，当我按下导航栏上的后退按钮时，它返回到前一个视图，但是第一个视图中的前一个数据仍然存在，我该如何重置第一个视图当我按下后退按钮时，像再次调用 viewDidLoad 函数一样查看数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T05:16:50.917

而不是使用 viewDidLoad 使用 -(void) viewWillAppear:(BOOL)animated

请记住，您将返回视图，以便清除/更新任何不适用的内容。

例如;

```
-(void) viewWillAppear:(BOOL)animated
{
  [super viewWillAppear:animated];  

  // reload the table   
  [self.tableView reloadData];
} 
```

# java - 如何“登录”到 Web 应用程序并使用 Java 访问后续页面？

> ID：580568
> 
> 赞同：2
> 
> 时间：2009-02-24T05:21:57.330
> 
> 标签：java, http, cookies

我想编写一个 Java 程序来访问一些需要登录的网页。我将如何保留登录产生的会话 cookie 以便我可以访问这些页面？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T05:27:35.087

[Commons HTTPClient](http://hc.apache.org/httpclient-3.x/)具有执行您想要的所有功能。您可以进行所需的任何类型的身份验证和 cookie 处理。这是[CookieDemoApp](http://svn.apache.org/viewvc/httpcomponents/oac.hc3x/trunk/src/examples/CookieDemoApp.java?view=log)的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T05:28:24.960

您可能想要使用[CookieManager](http://java.sun.com/javase/6/docs/api/java/net/CookieManager.html)（您也可以查看它的超类[CookieHandler](http://java.sun.com/javase/6/docs/api/java/net/CookieHandler.html)）。不过，我不知道标准`URLConnection`类是否会自动为您存储 cookie。

# iphone - iPhone - UILabel 中的 UITextAlignmentRight 剪切了部分文本

> ID：580573
> 
> 赞同：0
> 
> 时间：2009-02-24T05:24:45.670
> 
> 标签：iphone

我试图在 UITableViewCell 上显示两个标签，一个带有左对齐文本，另一个带有右对齐文本。文本右对齐的单元格在右侧被切割 1-2 个像素。我尝试增加 UILabel 的宽度，但没有任何区别。

文本在模拟器中看起来很好，但在设备上它被向右切割。

[这是供参考的图片网址](http://img516.imageshack.us/my.php?image=img1.jpg)（**长文本 3**被剪切）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T22:40:31.827

我发现 UITableViewCell 中标签的正确对齐剪切问题与使用的字体有关。

如果您只使用数字，则系统、Helvetica 和 Courier 等简单字体不会被剪裁。然而，他们在 Oblique 或 BoldOblique 时会这样做。

像 Palatino 这样的“更高级”字体会被剪裁在像零和八这样的宽数字上。

对于字母，我发现像“W”这样的宽字体总是在非视网膜显示器上丢失至少最左边的像素，其中包括系统和黑体等比例字体，但不使用 Courier。

因此，如果使用数字，请使用基本字体，如 system、Helvetica 或 Courier，并避免使用 Obliques。对于任何字体中的任何字符，一种解决方法是在将字符串分配给 label.text 之前将一个空格附加到字符串的末尾。

label.autoresizingMask 在某些情况下可能会有所帮助，但我发现它对 UITableViewCell 中的标签的这个问题没有任何影响。

在 IOS 5.1 中测试

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-24T08:11:43.070

这可以通过使用右对齐的 UILabel 的 autoResizingMask 属性来克服。

```
label.autoresizingMask = UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleHeight; 
```

希望对某人有所帮助。

# c# - 如何在 .NET 中创建包含“系统”的命名空间而不会发生冲突？

> ID：580577
> 
> 赞同：4
> 
> 时间：2009-02-24T05:25:46.153
> 
> 标签：c#, .net

有时我在 C# 中创建了一个名称空间（我不知道问题在 VB.NET 中是否相同），其中包含“系统”，当我从不同的 DLL 中包含它时，它会变得疯狂并与包含“系统”的所有内容发生冲突. 这会导致以下疯狂错误：

> 命名空间“RR.System”中不存在类型或命名空间名称“ServiceModel”
> 
> 命名空间“RR.System”中不存在类型或命名空间名称“Runtime”
> 
> 命名空间“RR.System”中不存在类型或命名空间名称“SerializableAttribute”

如果你不知道我在说什么，那对你有好处:) 我相信很多人都看到了这个问题。

我不完全确定它为什么这样做。它甚至会出现在文件中，例如生成的 Web 服务代码不包含对`RR.System`.

这一切都是因为我`RR.System`将 DLL 包含在不同的项目中。

我怎样才能避免这种情况发生？或者修复它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T05:28:23.573

奇怪的。

现在，您为什么将您的项目称为“系统”？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T05:42:21.650

为避免混淆，您可以完全限定您的命名空间引用：

```
global::System.ServiceModel 
```

等等

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-24T14:26:01.887

我仍然不明白为什么*子*命名空间与*根*命名空间冲突？一个命名空间下的所有类型都可以是完全限定的，并且完全限定的名称指的是不同的类型。例如

```
System.Abc.Xyz.Type 
```

没有任何关系

```
Abc.Xyz.System.Type 
```

在`System`第一种情况下，指的是完全不同的概念（指南下的公司名称），而`System`在第二种情况下，可以指产品或子系统名称。

如果根命名空间会导致这种干扰，那么这肯定是一个大问题，因为我可能会选择调用我的新雨林监控产品`Amazon`并将我的所有类型都放在`MyCompany.Amazon`. 然后稍后我可能会选择使用 S3 存储来存储我的数据，但突然命名空间 Amazon 会导致冲突。

我们刚刚遇到了同样的问题，因为我们的项目分为 3 个主要子系统 - 数据库、用户和系统。这些看起来像是我们的 MyCompany 根命名空间下的明显子命名空间。

请记住，这与 Simon 所说的 Using 语句无关“它甚至会出现在文件中，例如为不包含对 RR.System 的任何引用的 Web 服务生成的代码”

**更新：**以下 Stack Overflow 问题与此相同。然而，它指向的 MSDN 文章讨论了一个名为 System 的类名，它隐藏了一个命名空间（很公平），并且还使用 System 作为顶级命名空间（很公平）。但是，它没有讨论为什么子命名空间与根命名空间冲突。

Stack Overflow 问：[C# 中的 global:: 是否有不好的代码味道？](https://stackoverflow.com/questions/1548242/is-global-a-bad-code-smell-in-c)
MSDN 文章：[如何：使用命名空间别名限定符](http://msdn.microsoft.com/en-us/library/c3ay4x3d%28VS.80%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T05:55:20.527

没有办法使用速记方法来引用这两个命名空间。您要么必须重命名您的类以防止冲突，要么像这样为您的类设置别名（这将要求您更改代码中的引用以使用别名）...

```
Using System; // The namespace seen and used in all .cs files
Using Sys = RR.System; // Just replace -your- 'System' references with 'Sys' 
```

虽然此方法在 C# 中是合法的，但它很混乱，建议重命名您引用的类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T06:11:14.453

这让我想起了一个老笑话 -[编译器，当我这样做的时候很痛](http://www.codinghorror.com/blog/archives/000645.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T05:44:41.303

如果您可以选择考虑将命名空间重命名为 SystemUtilities 之类的名称，或者您可以完全限定所有其他可能会很痛苦的引用。BCL 的歧义会导致一些看起来很讨厌的代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T05:54:49.203

如果您的项目包含对 System 和您的自定义库 (RR.System) 的引用，编译器将有一个模棱两可的引用来整理。不确定你想要哪一个。

您始终可以使用[别名](https://stackoverflow.com/questions/61262/how-do-you-resolve-net-namespace-conflicts-with-the-using-keyword)来确保您的代码明确引用了项目中的正确代码。

[顺便说一句，Brad Abrams 在框架设计指南](https://rads.stackoverflow.com/amzn/click/com/0321246756)中提供了大量的最佳实践信息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T05:54:53.557

我公司主要项目的命名空间分为几个级别：

Company.au.ProductName.GUI.*
Company.au.ProductName.Data.*
...

其中 * 将根据功能进一步细分

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T06:13:24.180

我的公司使用 Company.Group.Platform.Application.Layer.Component.* 这非常烦人且令人困惑。不用说，我使用别名

# linux - 为Linux目录下新创建的文件和子目录设置默认权限？

> ID：580584
> 
> 赞同：103
> 
> 时间：2009-02-24T05:33:59.347
> 
> 标签：linux, permissions, acl, umask

我有一堆长时间运行的脚本和应用程序，它们将输出结果存储在几个用户共享的目录中。我想要一种方法来确保在此共享目录下创建的每个文件和目录都自动具有`u=rwxg=rwxo=r`权限。

我知道我可以先使用`umask 006`各种脚本，但我不喜欢这种方法，因为许多用户编写自己的脚本并且可能忘记自己设置 umask。

我真的只是希望文件系统在某个文件夹中设置具有特定权限的新创建的文件和目录。这是可能吗？

**更新**：我*认为*它可以通过[POSIX ACLs](http://www.vanemery.com/Linux/ACL/POSIX_ACL_on_Linux.html)来完成，使用 Default ACL 功能，但目前这一切都让我有点过头了。如果有人可以解释如何使用默认 ACL，它可能会很好地回答这个问题。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-02-24T05:37:26.857

要获得正确的所有权，您可以在目录上设置组 setuid 位

```
chmod g+rwxs dirname 
```

这将确保在目录中创建的文件归该组所有。然后，您应该确保每个人都使用 umask 002 或 007 或类似的东西运行——这就是为什么 Debian 和许多其他 linux 系统默认配置为每个用户组的原因。

如果用户的 umask 太强，我不知道有一种方法可以强制您获得所需的权限。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2011-07-01T15:36:19.987

以下是使用默认 ACL 的方法，至少在 Linux 下是这样。

首先，您*可能*需要在文件系统上启用 ACL 支持。如果您使用的是 ext4，那么它已经启用。其他文件系统（例如，ext3）需要使用该`acl`选项挂载。在这种情况下，将选项添加到您的`/etc/fstab`. 例如，如果该目录位于您的根文件系统上：

```
/dev/mapper/qz-root   /    ext3    errors=remount-ro,acl   0  1 
```

然后重新挂载它：

```
mount -oremount / 
```

现在，使用以下命令设置默认 ACL：

```
setfacl -dm u::rwx,g::rwx,o::r /shared/directory 
```

现在，所有新文件都`/shared/directory`应该获得所需的权限。当然，这也取决于创建文件的应用程序。例如，大多数文件从一开始就不能被任何人执行（取决于 open(2) 或 creat(2) 调用的模式参数），就像使用 umask 时一样。一些实用程序，如`cp`、`tar`和 ，`rsync`将尝试保留源文件的权限，如果源文件不是组可写的，这将屏蔽您的默认 ACL。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T10:01:39.733

这很难看，但您可以使用 setfacl 命令来实现您想要的。

在 Solaris 机器上，我有一个包含用户和组的 acl 的文件。不幸的是，您必须列出所有用户（至少我找不到其他方法来完成这项工作）：

```
user::rwx
user:user_a:rwx
user:user_b:rwx
...
group::rwx
mask:rwx
other:r-x
default:user:user_a:rwx
default:user:user_b:rwx
....
default:group::rwx
default:user::rwx
default:mask:rwx
default:other:r-x 
```

将文件命名为 acl.lst 并填写您的真实用户名而不是 user_X。

您现在可以通过发出以下命令在您的目录上设置这些 acl：

```
setfacl -f acl.lst /your/dir/here 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-09-22T16:36:18.877

在您的 shell 脚本（或`.bashrc`）中，您可以使用以下内容：

`umask 022`

`umask`是一个命令，它确定掩码的设置，该掩码控制如何为新创建的文件设置文件权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-12T03:18:09.730

我认为这不会完全满足您的要求，但我只是想把它扔在那里，因为我没有在其他答案中看到它。

`-m`我知道您可以使用以下选项在单行中创建具有权限的目录：

```
mkdir -m755 mydir 
```

您还可以使用以下`install`命令：

```
sudo install -C -m 755 -o owner -g group /src_dir/src_file /dst_file 
```

# windows - PowerShell脚本打包和WinNT执行？

> ID：580589
> 
> 赞同：0
> 
> 时间：2009-02-24T05:37:29.853
> 
> 标签：windows, powershell

是否有任何免费软件可以将 powershell 脚本打包成独立的 WIN32 可执行文件？

似乎可以在 win2000 和 winNT 上运行 powershell 测试版，是否有任何已知的方法可以让最终的 powershell 在其上运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T13:15:52.887

我认为没有任何软件可以将 PowerShell 脚本打包成独立的可执行文件。这需要将 PowerShell 本身与脚本捆绑在一起（不小壮举）。

受支持的最早的操作系统是 Windows XP SP2，因此没有一种受支持的方法可以让 PowerShell 在 NT 或 2000 上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T13:44:37.827

一个简单的步骤是创建一个嵌入脚本的 .NET exe。

当然，这需要在执行时安装 PSH（和任何非标准管理单元）。

要删除这些依赖项，您需要能够处理使用的任何 cmdlet，如 @aphoria 所述，这将重新发明 PSH 和所有管理单元。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T04:46:32.760

严格来说不是您正在寻找的答案（免费软件），但它可能对其他人有用。以下是将脚本打包成单个可执行文件的一些商业选项：

[管理脚本编辑器](http://www.adminscripteditor.com/editor/scriptpackager/)

[PrimalScript](http://www.primaltools.com/index.asp?p=PrimalScript) OR [PrimalPackager](http://www.primaltools.com/index.asp?p=PrimalPackager)（只是 PrimalScript 的打包部分）

# c# - 从向后读取文件后如何关闭文件？

> ID：580590
> 
> 赞同：0
> 
> 时间：2009-02-24T05:38:02.677
> 
> 标签：c#

前段时间我问了一个关于“如何在 C# 中使用迭代器反向读取文本文件”的问题。[请看链接](https://stackoverflow.com/questions/452902/how-to-read-a-text-file-reversely-with-iterator-in-c)

Jon Skeet 非常友善地为我提供了解决方案。但是我还有一个问题，如何在读取数据文件时关闭它？看起来 Jon 使用了一个委托来处理迭代器，这很有趣。但是当文件被处理时，我怎么能调用类似“file.Close（）”来释放它呢？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T06:46:29.080

这只是一个非常令人遗憾的疏忽。

答案是 - 像往常一样 - 使用`try`/`finally`或`using`声明。这样，即使抛出异常，即使调用者没有一直迭代回到文件的开头，文件也会被关闭。

但是，它*确实*依赖于调用者`Dispose`调用`IEnumerator<T>`. 幸运的是，这是由`foreach`C# 中的循环自动处理的，但如果您曾经显式使用`GetEnumerator()`/ `MoveNext()`/ `Current`，您应该小心并编写如下代码：

```
using (IEnumerator<string> iterator = foo.GetEnumerator())
{
    while (iterator.MoveNext())
    {
        string bar = iterator.Current;
        // etc
    }
} 
```

幸运的是，您需要这样做的时候并不多：）

[在我的迭代器实现文章](http://csharpindepth.com/Articles/Chapter6/IteratorBlockImplementation.aspx)中，我有更多关于所有这些工作原理的详细信息，您可能会发现这些文章很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T06:14:31.213

当无法进一步读取文件时，Jon 的代码会调用 Dispose 方法。
这是你想要的？

Dispose 将调用 Close 并释放文件句柄。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T06:20:59.310

当它是一个坏流时，他调用了 Dispose。

```
public IEnumerator<string> GetEnumerator()
    {
        Stream stream = streamSource();
        if (!stream.CanSeek)
        {
            stream.Dispose();
            throw new NotSupportedException("Unable to seek within stream");
        }
        if (!stream.CanRead)
        {
            stream.Dispose();
            throw new NotSupportedException("Unable to read within stream");
        }
        return GetEnumeratorImpl(stream);
    } 
```

但是当我进行迭代时，它似乎并没有关闭文件。阅读文件后我想做的是删除该文件。但是我得到了一个例外，说它被另一个进程使用了​​。

# mysql - 从 MS Access 移植

> ID：580593
> 
> 赞同：2
> 
> 时间：2009-02-24T05:40:10.657
> 
> 标签：mysql, linux, ms-access, postgresql

我最近收到了一个 MS Access .mdb 数据库文件，并要求我让它在 Linux 系统中可用。我正在寻找一种将 Access 数据库转换为 MySQL 或 PostGres 等开源数据库的方法。

我没有 MS Office，它是一个志愿者组织的一次性项目，所以如果可以避免的话，我不想花钱。我正在运行 Vista x64，并且有一个 Linux 虚拟机，所以可以在任何一个中使用的东西都会很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T05:48:20.920

幸运的是，您不需要 MS Access 从 Access 数据库中获取数据。虽然有像 MDBTools 这样的工具可以在 Linux 上读取 .mdb 文件，但我发现它们对于更大、更复杂的数据库来说是不稳定的。最好的方法是在 Windows 上使用 ADO 或 ODBC 将 .mdb 数据库中的数据导出为可以在其他地方导入的格式（如 csv）。

[在Ruby 中使用 DBI或](http://ruby-dbi.rubyforge.org/)[在 Ruby 脚本中](http://rubyonwindows.blogspot.com/2007/06/using-ruby-ado-to-work-with-ms-access.html)使用ADO 时，我很幸运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T05:53:57.833

以下链接可能对您有用。

MySQL：

[访问迁移](http://www.kitebird.com/articles/access-migrate.html)

[读取.php?65,27115,27115](http://forums.mysql.com/read.php?65,27115,27115)

PostgreSQL：

[Microsoft Access 到 PostgreSQL 的转换](http://wiki.postgresql.org/wiki/Microsoft_Access_to_PostgreSQL_Conversion)

[从其他数据库转换到 PostgreSQL](http://wiki.postgresql.org/wiki/Converting_from_other_Databases_to_PostgreSQL)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T06:26:20.640

MySQL 或 Postgres 都可以作为访问数据的替代数据存储正常工作。如果您的 Access 数据库包含 Forms 或 Reports，那么在 Open Source 中确实没有直接替代品，您要么需要保留 Access 前端并使用 ODBC 驱动程序访问数据，要么编写一系列新的 Forms 或 Reports PHP 或您最喜欢的 Web 脚本语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T09:47:56.320

我使用了[MySQL Migration Toolkit](http://dev.mysql.com/doc/migration-toolkit/en/index.html)，它非常适用于表，甚至创建了一个可重用的脚本。它是免费且易于使用的。

该工具包现在已停产，[MySQL Workbench 5.2](http://www.mysql.com/products/workbench/migrate/)取代了它。

不幸的是，当我在我的系统上使用 MS Access 尝试它时，它因“一个问题导致程序停止正常工作”而失败。当然，在最后一步。（2013 年 1 月 16 日）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-15T14:17:35.927

我现在遇到了同样的问题，发现这个免费软件正是我需要的：[http ://www.bullzip.com/products/a2m/info.php](http://www.bullzip.com/products/a2m/info.php)

它从 MDB 文件中提取所有内容，生成一个我直接导入 MySQL 服务器的 SQL 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T05:53:50.610

该过程有两个部分

1) 从 Access 数据库转换为脚本，虽然您可能需要 Access 和可能的 Sql Server 来执行此操作，但仍有一些[不错的选择](https://stackoverflow.com/questions/374659/tool-to-convert-ms-access-database-to-sql-script)

2) 选择你的目标数据库——MySql 看起来很合适，在 Linux 或 Windows 上运行它并从脚本中运行 ddl 和数据。

不知道如何在没有 Access 的情况下做到这一点，您知道架构是什么样的吗？如果您确实遇到问题，我可以帮助您完成第 1 步，但目前我没有安装 Linux。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-26T21:35:47.870

我不敢苟同：不需要使用外部工具或昂贵的中间件。最简单、最干净、最便宜、最快、最安全（我说是最好的吗？）解决方案是使用 ODBC 并完全集成。

# visual-studio - 如何使用 Visual Studio 2008 创建 COM dll

> ID：580598
> 
> 赞同：0
> 
> 时间：2009-02-24T05:42:00.950
> 
> 标签：visual-studio, dll

如何使用 Visual Studio 2008 创建 COM dll？创建 dll 需要哪些自定义设置？该 dll 应在 Microsoft Navision(ERP PACKAGE) 中使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T13:06:15.970

只需创建一个类库。在项目属性中，打开可以更改程序集信息的对话框并标记“使程序集 COM 可见”复选框（抱歉，不知道选项的确切名称，使用 German VS 2008）。

然后，将以下属性添加到应该从 Navision 使用的任何类：

```
[ClassInterface(ClassInterfaceType.AutoDual)]
[ProgId("YOUR-ID-GOES-HERE")]
[ComVisible(true)]
[Guid("xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx")]
public class ComVisbleClass
{
    ....
} 
```

我建议您还使用该属性手动将 Disp-ID 分配给公共方法和`DispId`属性。否则，插入新的公共方法或属性可能会破坏 Navision 功能，因为 Disp-ID 可能会在编译时更改。

然后，Navision 将引用旧的 Disp-ID，它们现在可能“指向”不同的方法。这是一个要调试和解决的 PITA，所以`DispId`从一开始就使用该属性。

# ruby-on-rails - `const_missing'：未初始化的常量（NameError）

> ID：580599
> 
> 赞同：5
> 
> 时间：2009-02-24T05:42:07.267
> 
> 标签：ruby-on-rails, ruby

每次我尝试使用“script/runner -e production ClassName.run”从我的 rails 2.2 应用程序的 lib 目录中运行任何类时，都会收到以下错误：

```
/usr/lib/ruby/gems/1.8/gems/rails-2.2.2/lib/commands/runner.rb:47:  
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:89:in `const_missing': uninitialized constant ClassName (NameError)" 
```

`test`出于某种原因，当我将它作为而不是运行时，我没有收到此错误`production`，并且一切正常。

哦，是`run`的，是一个类方法，即`def self.run .... end`

有什么建议么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T05:55:40.527

当 ruby​​ 找不到类或模块时会发生该错误。我会开始：

1.  检查 gem 依赖项（所有环境都相同吗？）
2.  在您的代码中搜索任何定义 ClassName 的内容，尤其是模块、类和插件。
3.  禁用开发中的每个插件，是否有任何插件突然导致该错误？
4.  如果代码在 lib 中，请将 lib require 语句添加到您的 production.rb 以强制在生产中加载 lib。

希望有帮助。

**更新**只是为了总结意见，它是选项 4。

除非您只想在生产中加载 lib，否则您应该考虑通过执行以下操作之一来确保所有环境都加载 lib：

1.  创建一个带有 require 的 rails 初始化程序（config/initializers 下的 .rb 文件）
2.  通过启用和修改 config.load_paths 变量，将路径添加到 config/environment.rb 中的 lib。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-28T13:35:50.183

我在同一个文件中有多个类定义（所有 STI 类）。当我将定义分成各自的文件时，它可以工作

# javascript - 水平滚动？javascript

> ID：580605
> 
> 赞同：0
> 
> 时间：2009-02-24T05:45:44.933
> 
> 标签：javascript, scroll

我正在寻找一种基于锚点水平制作 DIV 动画的简单方法。如果可能的话，我宁愿不为此下载整个库......

任何人都可以为我建议任何资源来了解其内部工作原理吗？

谢谢大家:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T16:20:20.743

```
<div style="width: 200px; height: 100px; overflow: scroll; white-space: nowrap">
    FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO
    FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO
    <span id="a1">BAR!</span>
    FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO FOO
</div>
<a href="#a1">scroll to bar (HTML anchor)</a>
<input type="button" value="scroll to bar (JS scrollIntoView)" />
<input type="button" value="scroll to bar (JS scrollLeft)" />

<script type="text/javascript">
    var a1= document.getElementById('a1');
    var buttons= document.getElementsByTagName('input');

    buttons[0].onclick= function() {
        a1.scrollIntoView();
    };
    buttons[1].onclick= function() {
        a1.parentNode.scrollLeft= a1.offsetLeft;
    };
</script> 
```

# c++ - 动态数组...复制构造函数、析构函数、重载赋值运算符

> ID：580622
> 
> 赞同：5
> 
> 时间：2009-02-24T06:00:00.610
> 
> 标签：c++, constructor

我正在准备期中考试。将会有一个关于动态设置数组的问题，并且可能会执行复制构造函数、析构函数和重载赋值运算符。你能否验证我是否正确。另外我不明白重载赋值运算符是什么意思。你能帮我解决这个问题吗？

```
class A
{
int* myArray;   //basically I created a pointer called myArray, 
A()             //are my copy constructors correct? A(), and A(int size)?
{
    myArray = 0;
}
A(int size)
{
    myArray = new int[size];
}
~A()             // I think my destructor is correct
{
    delete [] myArray;
} 
```

你能检查我的代码吗？另外我如何重载赋值运算符？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T06:06:28.160

复制构造函数用于基于另一个相同类型的实例创建对象。你没有这样的。您可以使用如下代码定义它：

```
A(const A &other)
{
   myArray = new int[other._size];
   _size = other._size;
   memcpy(myArray, other.myArray, sizeof(int) * _size);
} 
```

您应该更改您的类，因此它将存储数组的_size，您还需要将构造函数和析构函数的可见性更改为公共。

重载的赋值运算符应如下所示：

```
const A &operator=(const A &other)
{
   if(this == &other) return *this; // handling of self assignment, thanks for your advice, arul.
   delete[] myArray; // freeing previously used memory
   myArray = new int[other._size];
   _size = other._size;
   memcpy(myArray, other.myArray, sizeof(int) * _size);
   return *this;
} 
```

您还可以在此赋值运算符中添加对数组大小相等性的检查，这样您就可以重用动态数组，而无需重新分配内存。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T06:15:56.860

您已经正确定义了 2 个重载的构造函数和一个析构函数。

但是，您尚未正确定义**显式复制构造函数**。

通常编译器会为你生成一个，这称为**隐式复制构造函数**。

在您的特定情况下，自动生成的隐式复制构造函数的问题在于它只会执行*myArray*的浅拷贝，其中它共享相同的指针值但没有为 myArray 分配自己的内存部分。

这意味着如果您删除原始对象中的 myArray，它将影响很可能不是您想要的副本。

像这样定义一个显式的复制构造函数会有所帮助：

```
A(const A& copy)
  : _size(copy.size), myArray(new int[copy.size]) 
{
    // #include <algorithm> for std::copy
    std::copy(copy.data, copy.data + copy.size, data);
} 
```

（来源：复制自[维基百科](http://en.wikipedia.org/wiki/Copy_constructor)）

如果像这样定义复制构造函数，则不需要重载赋值运算符。如果您创建一个新对象，并将其分配给您创建的第一个对象，您将成功创建第一个对象的独立副本。

**编辑：**从[这篇文章](http://en.wikipedia.org/wiki/Assignment_operator_in_C%2B%2B)：

> 复制赋值运算符与复制构造函数的不同之处在于它必须清理赋值目标的数据成员（并正确处理自赋值），而复制构造函数将值分配给未初始化的数据成员。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T08:23:07.367

在处理对象复制和动态内存分配时，最好使用交换辅助函数

```
A(const A& other)
    : myArray(0)
    , _size(0)
{
   if(this != &other) {
      A my_tmp_a(other._size);
      std::copy(&other[0], &other[other._size], &my_tmp_a[0]);
      swap(my_tmp_a);
   }
}

const A& operator=(const A& other)
{
   if(this == &other) return *this;
   A my_tmp_a(other._size);
   std::copy(&other[0], &other[other._size], &my_tmp_a[0]); 
   swap(my_tmp_a);       
   return *this;
}

void swap(const A& other) {
   int* my_tmp_array = this.myArray;
   this.myArray = other.myArray;
   other.myArray = my_tmp_array;
   int my_tmp_size = this._size;
   this._size = other._size;
   other._size = my_tmp_size;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T09:25:45.837

当您想定义其中一个时，请确保定义三个函数。其称为all or none 规则它们是： 1) 复制构造函数。2) 赋值运算符。3) 析构函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T06:07:25.973

部分答案：重载函数涉及创建该函数的不同版本，这些版本接受不同数量或种类的参数。因此，重载赋值运算符将涉及为赋值运算符创建几个函数，这些函数允许您将各种类型的对象分配给 type 的变量`A`。

# vb6 - 如何在VB6中克隆一个对象

> ID：580623
> 
> 赞同：5
> 
> 时间：2009-02-24T06:01:17.410
> 
> 标签：vb6, clone, propertybag

我试图自动克隆一个对象，而不必实例化一个新对象并手动复制每个变量。

我记得那天（当我每天都在做 VB6 时）我想出了一种使用 PropertyBag 克隆对象的方法，这非常酷。但是我丢失了代码，不记得该怎么做了。

有没有人记得或有其他方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T06:49:00.930

我过去使用的方法是将所有实例变量放在 UDT 上。只要您使 UDT 保持最新，您就可以使用单个方法/语句复制类的数据。

给定一个“Person”类，这是一个简单的例子：

 `````
Private Type tPerson
    ID As Long
    FirstName As String
    LastName As String
End Type  

Private m_Person As tPerson  

Public Sub InitPerson(ID As Long, FirstName As String, LastName As String)
    m_Person.ID = ID
    m_Person.FirstName = FirstName
    m_Person.LastName = LastName
End Sub  

Friend Sub SetData(PersonData As tPerson)
    m_Person = PersonData

End Sub  

Public Function GetClone() As Person
    Dim p As New Person
    p.SetData m_Person

    Set GetClone = p

End Function  

Public Property Get FirstName() As String
    FirstName = m_Person.FirstName

End Property 
````  `要尝试代码：

 `````
Dim p As New Person
p.InitPerson 1, "MyName", "MyLastName"

Dim p2 As Person
Set p2 = p.GetClone

MsgBox p2.FirstName 
````  `如果您在 UDT 中维护所有实例变量，而不是单独声明它们，那么您可以拥有需要很少维护的简单 Clone 方法。

另一个优点是您可以将 UDT 放入文件句柄，以便快速序列化到磁盘。

 `````
Public Sub Save(filePathName As String)
    Dim f As Integer
    f = FreeFile()

    Open filePathName For Binary Access Write Lock Read Write As #f
        Put #f, , m_Person
    Close #f

End Sub 
````  `一个可怜的男人的序列化解决方案真的:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T13:41:34.510

这是[你](http://www.devx.com/tips/Tip/17894)要找的吗？文章复制如下，以供后人参考。

## 使用 PropertyBag 序列化数据

您可以通过将数据放入 PropertyBag 对象，然后读取 PropertyBags Contents 属性来快速序列化您的数据。此属性实际上是一个字节数组，它是您的 PropertyBag 对象中数据的串行表示。您可以将此字节数组用于多种用途，包括通过 DCOM 进行数据传输的有效方法：

```
Private Function PackData() As String
    Dim pbTemp  As PropertyBag

    'Create a new PropertyBag object
    Set pbTemp = New PropertyBag
    With pbTemp
        'Add your data to the PB giving each item a 
        'unique string key
        Call .WriteProperty("FirstName", "John")
        Call .WriteProperty("MiddleInitial", "J")
        Call .WriteProperty("LastName", "Doe")

        'Place the serialized data into a string 
        'variable.
        Let PackData = .Contents
    End With

    Set pbTemp = Nothing
End Function 
```

要检索序列化数据，只需创建一个新的 PropertyBag 对象并将序列化字符串设置为其 Contents 属性。在将字符串分配给 Contents 属性之前将其转换为字节数组：

```
Private Sub UnPackData(sData As String)
    Dim pbTemp  As PropertyBag
    Dim arData()    As Byte

    'Convert the string representation of the data to 
    'a Byte array
    Let arData() = sData

    'Create a new PropertyBag object
    Set pbTemp = New PropertyBag
    With pbTemp
        'Load the PropertyBag with data
        Let .Contents = arData()

        'Retrieve your data using the unique key
        Let m_sFirstName = .ReadProperty("FirstName")
        Let m_sMiddleInitial = _
            .ReadProperty("MiddleInitial")
        Let m_sLastName = .ReadProperty("LastName")
    End With

    Set pbTemp = Nothing
      End Sub 
```

迈克·库尔茨 (Mike Kurtz)，宾夕法尼亚州麦基斯洛克斯 (McKees Rocks)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T06:01:53.313

另请阅读：[持久化组件的数据](http://msdn.microsoft.com/en-us/library/aa263542(VS.60).aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T13:27:47.657

我的应用程序框架中的每个对象都有一个读取和存储方法。我所做的是向他们传递一个写入字节数组并存储字节数组的流。虽然这并不能消除必须处理每个属性的问题，但您只需处理一次读取和写入一次。

另一种方法是使用 Darrel Miller 所说的财产包，但您仍然必须分别处理每个财产。如果您已经阅读并存储，那么我的建议应该可以节省一些时间。

# architecture - 两个项目指一个项目

> ID：580638
> 
> 赞同：0
> 
> 时间：2009-02-24T06:13:35.133
> 
> 标签：architecture

我有一个引用项目 Utilities#1 的项目 Foo#1

我想添加一个继承自 Foo#1 的新项目 Foo#2。我需要 Utilities#1 的功能，还需要 Foo#2 特有的新功能。

对于上述解决方案，我应该采用什么样的项目布局/架构？

我可以使 Foo#1 和 Foo#2 的 Utilities#1 保持通用，但如果我将 Foo#2 的特定功能添加到 Utilities#1，这不会是一个问题。

我还可以创建一个可以从 Utilities#1 继承的项目 Utilities#2，但这是一个好方法吗？假设我添加 Foo#3 和 Foo#4，我将有 Utilities#3 和 Utilities#4。

最好的方法是什么？

我正在使用.net 1.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T07:15:14.517

我认为您应该考虑将软件拆分为多个程序集（项目？）的最初原因是什么。普通的“公用事业”组件往往会成为吸引各种垃圾的水槽。如果您想不出任何这样的原因，您绝对可以将它们全部放在一个程序集中，然后在开发过程中将其拆分，以便您有更好的机会了解全貌。

如果您希望某个功能 Z 可重用，则为它创建一个单独的项目。

# sql - 如何在 SQL 中随机选择行？

> ID：580639
> 
> 赞同：266
> 
> 时间：2009-02-24T06:14:12.587
> 
> 标签：sql, database, random

我使用的是 MSSQL Server 2005。在我的数据库中，我有一个表“customerNames”，它有两列“Id”和“Name”，大约 1,000 个结果。

我正在创建一个功能，每次我必须随机选择 5 个客户。谁能告诉我如何创建一个查询，每次执行查询时都会随机获得 5 行（ID 和名称）？

* * *

## 回答 #1

> 赞同：745
> 
> 时间：2009-07-30T23:28:44.817

```
SELECT TOP 5 Id, Name FROM customerNames
ORDER BY NEWID() 
```

就是说，似乎每个人都来到此页面以获得对您问题的更一般的答案：

## [在 SQL 中选择随机行](http://www.petefreitag.com/item/466.cfm)

### 使用 MySQL 选择一个随机行：

```
SELECT column FROM table
ORDER BY RAND()
LIMIT 1 
```

### 使用 PostgreSQL 选择一个随机行：

```
SELECT column FROM table
ORDER BY RANDOM()
LIMIT 1 
```

### 使用 Microsoft SQL Server 选择随机行：

```
SELECT TOP 1 column FROM table
ORDER BY NEWID() 
```

### 使用 IBM DB2 随机选择一行

```
SELECT column, RAND() as IDX 
FROM table 
ORDER BY IDX FETCH FIRST 1 ROWS ONLY 
```

### 使用 Oracle 选择一条随机记录：

```
SELECT column FROM
( SELECT column FROM table
ORDER BY dbms_random.value )
WHERE rownum = 1 
```

### 使用 sqlite 选择随机行：

```
SELECT column FROM table 
ORDER BY RANDOM() LIMIT 1 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-02-24T06:21:37.750

```
SELECT TOP 5 Id, Name FROM customerNames ORDER BY NEWID() 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-24T06:45:56.023

如果有人想要 PostgreSQL 解决方案：

```
select id, name
from customer
order by random()
limit 5; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-24T06:21:20.417

也许[这个网站](http://www.petefreitag.com/item/466.cfm)会有所帮助。

对于那些不想点击的人：

```
SELECT TOP 1 column FROM table
ORDER BY NEWID() 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-09-23T12:17:51.757

这里有一个很好的 Microsoft SQL Server 2005 特定解决方案。处理您使用大型结果集的问题（不是我知道的问题）。

从大表中随机选择行 [http://msdn.microsoft.com/en-us/library/cc441928.aspx](http://msdn.microsoft.com/en-us/library/cc441928.aspx)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-08-15T23:08:59.677

我发现这最适合大数据。

```
SELECT TOP 1 Column_Name FROM dbo.Table TABLESAMPLE(1 PERCENT); 
```

`TABLESAMPLE(n ROWS) or TABLESAMPLE(n PERCENT)`是随机的，但需要添加`TOP n`才能获得正确的样本量。

在大桌子上使用`NEWID()`非常慢。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-02-25T07:49:41.777

```
SELECT * FROM TABLENAME ORDER BY random() LIMIT 5; 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-03-03T22:14:37.567

如果您有一个包含数百万行的表并且关心性能，那么这可能是一个更好的答案：

```
SELECT * FROM Table1
WHERE (ABS(CAST(
  (BINARY_CHECKSUM
  (keycol1, NEWID())) as int))
  % 100) < 10 
```

[https://msdn.microsoft.com/en-us/library/cc441928.aspx](https://msdn.microsoft.com/en-us/library/cc441928.aspx)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-07-17T18:15:50.463

这是一个老问题，但尝试将新字段（NEWID() 或 ORDER BY rand()）应用于具有大量行的表将非常昂贵。如果您有增量的唯一 ID（并且没有任何漏洞），那么计算要选择的 X # 个 ID 而不是对每一行应用 GUID 或类似然后取前 X # 个 ID 会更有效。

```
DECLARE @minValue int;
DECLARE @maxValue int;
SELECT @minValue = min(id), @maxValue = max(id) from [TABLE];

DECLARE @randomId1 int, @randomId2 int, @randomId3 int, @randomId4 int, @randomId5 int
SET @randomId1 = ((@maxValue + 1) - @minValue) * Rand() + @minValue
SET @randomId2 = ((@maxValue + 1) - @minValue) * Rand() + @minValue
SET @randomId3 = ((@maxValue + 1) - @minValue) * Rand() + @minValue
SET @randomId4 = ((@maxValue + 1) - @minValue) * Rand() + @minValue
SET @randomId5 = ((@maxValue + 1) - @minValue) * Rand() + @minValue

--select @maxValue as MaxValue, @minValue as MinValue
--  , @randomId1 as SelectedId1
--  , @randomId2 as SelectedId2
--  , @randomId3 as SelectedId3
--  , @randomId4 as SelectedId4
--  , @randomId5 as SelectedId5

select * from [TABLE] el
where el.id in (@randomId1, @randomId2, @randomId3, @randomId4, @randomId5) 
```

如果您想选择更多行，我会考虑使用 ID 和一堆 rand() 值填充 #tempTable，然后使用每个 rand() 值缩放到最小-最大值。这样您就不必定义所有 @randomId1...n 参数。我在下面包含了一个使用 CTE 填充初始表的示例。

```
DECLARE @NumItems int = 100;

DECLARE @minValue int;
DECLARE @maxValue int;
SELECT @minValue = min(id), @maxValue = max(id) from [TABLE];
DECLARE @range int = @maxValue+1 - @minValue;

with cte (n) as (
   select 1 union all
   select n+1 from cte
   where n < @NumItems
)
select cast( @range * rand(cast(newid() as varbinary(100))) + @minValue as int) tp
into #Nt
from cte;

select * from #Nt ntt
inner join [TABLE] i on i.id = ntt.tp;

drop table #Nt; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-07-23T11:51:11.323

为了打乱 SQL 结果集，您需要使用特定于数据库的函数调用。

> 请注意，使用 RANDOM 函数对大型结果集进行排序可能会非常慢，因此请确保对小型结果集进行排序。
> 
> 如果您必须对大型结果集进行洗牌并在之后对其进行限制，那么最好使用[Oracle`SAMPLE(N)`](https://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_10002.htm#SQLRF55274)或[SQL Server](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/ms189108(v=sql.105))或[PostgreSQL](https://www.postgresql.org/docs/10/tablesample-method.html)`TABLESAMPLE`之类的东西，而不是 ORDER BY 子句中的随机函数。

因此，假设我们有以下数据库表：

[![歌曲数据库表](https://i.stack.imgur.com/fxTly.png)](https://vladmihalcea.com/sql-order-by-random/)

以及表中的以下行`song`：

```
| id | artist                          | title                              |
|----|---------------------------------|------------------------------------|
| 1  | Miyagi & Эндшпиль ft. Рем Дигга | I Got Love                         |
| 2  | HAIM                            | Don't Save Me (Cyril Hahn Remix)   |
| 3  | 2Pac ft. DMX                    | Rise Of A Champion (GalilHD Remix) |
| 4  | Ed Sheeran & Passenger          | No Diggity (Kygo Remix)            |
| 5  | JP Cooper ft. Mali-Koa          | All This Love                      | 
```

## 甲骨文

在 Oracle 上，您需要使用该`DBMS_RANDOM.VALUE`函数，如下例所示：

```
SELECT
    artist||' - '||title AS song
FROM song
ORDER BY DBMS_RANDOM.VALUE 
```

在 Oracle 上运行上述 SQL 查询时，我们将得到以下结果集：

```
| song                                              |
|---------------------------------------------------|
| JP Cooper ft. Mali-Koa - All This Love            |
| 2Pac ft. DMX - Rise Of A Champion (GalilHD Remix) |
| HAIM - Don't Save Me (Cyril Hahn Remix)           |
| Ed Sheeran & Passenger - No Diggity (Kygo Remix)  |
| Miyagi & Эндшпиль ft. Рем Дигга - I Got Love      | 
```

> `DBMS_RANDOM.VALUE`请注意，由于ORDER BY 子句使用的函数调用，歌曲是按随机顺序列出的。

## SQL 服务器

在 SQL Server 上，您需要使用该`NEWID`函数，如下例所示：

```
SELECT
    CONCAT(CONCAT(artist, ' - '), title) AS song
FROM song
ORDER BY NEWID() 
```

在 SQL Server 上运行上述 SQL 查询时，我们将得到以下结果集：

```
| song                                              |
|---------------------------------------------------|
| Miyagi & Эндшпиль ft. Рем Дигга - I Got Love      |
| JP Cooper ft. Mali-Koa - All This Love            |
| HAIM - Don't Save Me (Cyril Hahn Remix)           |
| Ed Sheeran & Passenger - No Diggity (Kygo Remix)  |
| 2Pac ft. DMX - Rise Of A Champion (GalilHD Remix) | 
```

> `NEWID`请注意，由于ORDER BY 子句使用的函数调用，歌曲是按随机顺序列出的。

## PostgreSQL

在 PostgreSQL 上，您需要使用该`random`函数，如下例所示：

```
SELECT
    artist||' - '||title AS song
FROM song
ORDER BY random() 
```

在 PostgreSQL 上运行上述 SQL 查询时，我们将得到以下结果集：

```
| song                                              |
|---------------------------------------------------|
| 2Pac ft. DMX - Rise Of A Champion (GalilHD Remix) |
| JP Cooper ft. Mali-Koa - All This Love            |
| Ed Sheeran & Passenger - No Diggity (Kygo Remix)  |
| HAIM - Don't Save Me (Cyril Hahn Remix)           |
| Miyagi & Эндшпиль ft. Рем Дигга - I Got Love      | 
```

> `random`请注意，由于ORDER BY 子句使用的函数调用，歌曲是按随机顺序列出的。

## MySQL

在 MySQL 上，您需要使用该`RAND`函数，如下例所示：

```
SELECT
  CONCAT(CONCAT(artist, ' - '), title) AS song
FROM song
ORDER BY RAND() 
```

在 MySQL 上运行上述 SQL 查询时，我们将得到以下结果集：

```
| song                                              |
|---------------------------------------------------|
| HAIM - Don't Save Me (Cyril Hahn Remix)           |
| Ed Sheeran & Passenger - No Diggity (Kygo Remix)  |
| Miyagi & Эндшпиль ft. Рем Дигга - I Got Love      |
| 2Pac ft. DMX - Rise Of A Champion (GalilHD Remix) |
| JP Cooper ft. Mali-Koa - All This Love            | 
```

> `RAND`请注意，由于ORDER BY 子句使用的函数调用，歌曲是按随机顺序列出的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-02-12T07:37:16.420

如果您正在使用大表并希望访问 10% 的数据，请运行以下命令：`SELECT TOP 10 PERCENT * FROM Table1 ORDER BY NEWID();`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-03-01T06:50:25.023

如果您使用 Yandex 数据库，那么您应该使用

```
select column from table order by random (TableRow()) limit 1; 
```

# c# - 画布上的 MouseLeftButtonDown 需要太高的精度

> ID：580641
> 
> 赞同：3
> 
> 时间：2009-02-24T06:14:43.273
> 
> 标签：c#, wpf, canvas, mouse, precision

我正在响应添加到 WPF 画布的元素上的 MouseLeftButtonDown 事件。单击时一切正常（即事件处理程序正确触发），但它需要鼠标指针的过多精度。你必须完美地站在圈子的顶端才能让它发挥作用。我需要它更宽容一点；也许至少 1 或 2 个像素可以原谅。画布上的元素都是漂亮的大圆圈（大约屏幕上四分之一的大小），所以圆圈本身并不算小，但每个的StrokeWidth都是1，所以是一条细线。

你可以在这里看到截图：http: [//twitpic.com/1f2ci/full](http://twitpic.com/1f2ci/full)

大多数图形应用程序对鼠标的选择并不那么挑剔，所以我想给用户一种熟悉的体验。

我怎样才能让它更宽容一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T07:11:08.270

您可以改为连接到根布局对象的 MouseLeftButtonDown 事件，并通过执行以下操作检查哪些元素在单击范围内：

```
List<UIElement> hits = System.Windows.Media.VisualTreeHelper.FindElementsInHostCoordinates(Point, yourLayoutRootElement) as List<UIElement>; 
```

[http://msdn.microsoft.com/en-us/library/cc838402(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc838402(VS.95).aspx)

对于 Point 参数，您可以使用 MouseEventArgs 参数 e，并像这样调用它的 GetPosition 方法：

```
Point p = e.GetPosition(null) 
```

我不记得是否使用 HitTest 而不是 FindElementsInHostCoordinates。尝试两者。
[http://msdn.microsoft.com/en-us/library/ms608752.aspx](http://msdn.microsoft.com/en-us/library/ms608752.aspx)

您可以从鼠标位置创建 4 个 Point 对象以创建假公差效果，并为所有 4 个点调用 FindElementsInHostCoordinates 或 HitTest。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T15:12:46.273

您可能想尝试用透明颜色填充圆圈以使整个圆圈可点击...

如果失败，您还可以在与其他圆圈相同的位置绘制辅助圆圈。使圆形前景色透明，并使画笔的粗细更宽几个像素，以获得更可接受的圆形周围可点击区域。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T16:38:38.563

我想我已经做到了（在你的帮助下让我开始）......

首先，我将移动事件处理移至 Canvas 而不是每个 Ellipse。从 OOP 的角度来看，这有好有坏。至少当鼠标事件处理是 HolePattern 的责任在每个 Hole 上设置它时（椭圆是 Hole 的视觉对象），它被抽象出来，以便我的 HolePattern 的任何消费者都将自动获得此功能。但是，通过将其移至主 UI 代码，我现在正在更高级别处理我的画布鼠标事件。但这也不全是坏事。我们可以讨论这部分几天。

关键是，我设计了一种方法，可以在用鼠标在画布上选择东西时创建“误差范围”，然后读取所选 Ellipse 所属的 Hole，然后我可以读取 Hole 所属的 HolePattern to，以及我的整个 UI（ListView、文本框、gridview fo 坐标）都由现有的 XAML 绑定更新，并且通过一次调用现有方法来更新 Canvas 以重新生成画布。

老实说，我不敢相信我已经弄清楚了这一切（当然，在你和其他人的帮助下）。有这样的愿景并看到它成为这样的感觉真是太酷了。

在此处查看主要代码：

```
void canvas1_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    int ClickMargin = 2;
    Point ClickedPoint = e.GetPosition(canvas1);
    Point p1 = new Point(ClickedPoint.X - ClickMargin, ClickedPoint.Y - ClickMargin);
    Point p2 = new Point(ClickedPoint.X - ClickMargin, ClickedPoint.Y + ClickMargin);
    Point p3 = new Point(ClickedPoint.X + ClickMargin, ClickedPoint.Y + ClickMargin);
    Point p4 = new Point(ClickedPoint.X + ClickMargin, ClickedPoint.Y - ClickMargin);
    var PointPickList = new Collection<Point>();
    PointPickList.Add(ClickedPoint);
    PointPickList.Add(p1);
    PointPickList.Add(p2);
    PointPickList.Add(p3);
    PointPickList.Add(p4);

    foreach (Point p in PointPickList)
    {
        HitTestResult SelectedCanvasItem = System.Windows.Media.VisualTreeHelper.HitTest(canvas1, p);
        if (SelectedCanvasItem.VisualHit.GetType() == typeof(Ellipse))
        {
            var SelectedEllipseTag = SelectedCanvasItem.VisualHit.GetValue(Ellipse.TagProperty);
            if (SelectedEllipseTag!=null &&  SelectedEllipseTag.GetType().BaseType == typeof(Hole))
            {
                Hole SelectedHole = (Hole)SelectedEllipseTag;
                SetActivePattern(SelectedHole.ParentPattern);
                SelectedHole.ParentPattern.CurrentHole = SelectedHole;

            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-12T11:20:30.387

只需增加椭圆的笔画厚度，使其可调节

因此 MouseLeftButtonDown 事件有效示例：在 Ellipse 标记中：

**Ellipse** Canvas.Left="10" Canvas.Top="133" Height="24" Name="ellipse1" Width="23" Stroke="Red" MouseLeftButtonDown="ellipse1_MouseLeftButtonDown" ToolTip="Temp Close" StrokeEndLineCap="Flat "**行程厚度="12"**

private void ellipse1_MouseLeftButtonDown(object sender, MouseButtonEventArgs e) { Application curApp = Application.Current; curApp.Shutdown(); }

# iphone - c中的函数名称范围

> ID：580645
> 
> 赞同：3
> 
> 时间：2009-02-24T06:16:15.487
> 
> 标签：iphone, c, xcode, makefile

函数名称范围如何跨多个 C 文件工作？

我正在将一个标准的 gnu 工具链项目移植到 iPhone OS，并使用 Xcode 来完成。

代码是通过 make 构建的，而不是通过 xcode 构建的。通过 xcode 构建时，链接器抱怨在两个对象中定义了相同的符号（函数）。该代码有两个不同的源文件，`#include`它们之间有一个公共文件。虽然......奇怪（至少对我来说），但它似乎适用于标准工具链。如果这是通过标准makefile以某种方式处理的东西，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T06:24:11.050

所有未标记为静态的函数都具有全局范围（它们被转储在单个命名空间中）。标记为静态的函数仅限于定义它们的翻译单元。

您违反了单一定义规则。

您的一个标题可能有一个变量的定义。例如：在`common.h`你有

```
int foo = 42; 
```

将其更改为：

```
extern int foo; // a declaration 
```

然后创建一个`common.c`放置定义的文件：

```
int foo = 42; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T06:23:35.513

在 C 中，如果我没记错的话，`static`函数名对于定义它们的源文件是本地的，但所有其他函数名都存在于全局命名空间中。所以如果你`file1.c`有

```
void fn1() {}
static void fn2() {} 
```

并`file2.c`与

```
void fn1() {}
static void fn2() {} 
```

你试图用类似的东西编译它们

```
cc file1.c file2.c 
```

那么您会在`fn1`in`file1.c`和`fn1`in之间出现名称冲突`file2.c`，但不会在两个`fn2`函数之间出现名称冲突（因为它们是静态的）。（当然，你也会得到一堆其他错误，因为这个程序没有*做*任何事情，但这些与范围无关。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T06:30:23.860

我的猜测是公共标头定义了一个内联函数，该函数导致重复符号。如果是这种情况，请为这些函数添加前缀 a `static inline`，或将它们定义为在另一个 .c 文件中`inline`使用声明。`extern`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T16:50:48.317

如果它从 Makefile 编译没有错误，但不是从 XCode 项目编译，很可能是因为编译器的选项在两个环境中设置不同。检查 Makefile 以查看传递给“gcc”的选项。特别是，重复的定义可能会使用#ifdef 进行条件编译，并且您可能需要将一些预处理器定义添加到 XCode 项目的设置中。

# jakarta-ee - Java EE 中的单点登录

> ID：580646
> 
> 赞同：1
> 
> 时间：2009-02-24T06:16:32.707
> 
> 标签：jakarta-ee

我正在尝试在 2 个 Java EE 应用程序之间实现单点登录。这两个应用程序共享同一个注册表 - LDAP。我想从一个应用程序导航到另一个只有一个身份验证。

我使用 WAS 6/RAD 7，并且我已将服务器配置为启用 SSO。我必须对我的应用程序进行哪些更改？我如何测试它的工作原理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T06:01:29.303

[CAS](http://www.jasig.org/cas)的实现将为您工作，它有据可查，并且“CASify”您的应用程序[所需的更改](http://www.jasig.org/cas/client-integration/cas-ifying-apps)非常容易

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T20:00:20.310

您的应用程序如何使用 LDAP？您是否实施了特定于应用程序的身份验证机制？

如果您使用 Java EE 应用服务器 (WAS) 的身份验证机制，则无需在 WAS 上启用 SSO，您的用户就可以同时登录到这两个应用程序。

在您的 WAR/EAR 描述符中，定义 Java EE 角色和身份验证方法，将您的应用程序的访问权限限制为这些角色的成员，配置您的 WAS 以针对您的 LDAP 进行身份验证，并在您的应用程序部署期间将您的应用程序中定义的角色绑定到 LDAP 用户/ 组（例如，针对 LDAP 进行身份验证的所有用户，或更具体的组）。

WAR/EAR 描述符和部署选项的更改都可以在 RAD 7 中使用 WAR/EAR 编辑器指定，LDAP 的设置必须使用 WAS 管理控制台完成。

编辑：

好的，好久不见（WAS 中的这样的配置）。不得不自己尝试一下，似乎必须打开 SSO。

这是我的设置：我有两个简单的应用程序，一个具有基于表单的身份验证，另一个具有 http 身份验证，每个应用程序都为其 Web 资源定义了一个安全角色和一个安全约束。这两个角色都在 EAR application.xml 编辑器中绑定到“所有经过身份验证的用户”（WAS 特定的部署信息，存储在 ibm-application-bnd.xmi 中）。关闭 SSO 后，我观察到与您相同的行为。

但是，打开SSO后，它很好，开始工作......

我如何打开 SSO：肯定有多个选项，这是如何使用基本设置（WAS 6）启用基于 LTPA 的 SSO：转到管理控制台 -> 安全 -> 全局安全 -> 选择 LTPA 作为身份验证机制 - > 应用，然后安全 -> 全局安全 -> 认证机制 -> LTPA -> 单点登录 -> 启用 -> 应用，然后全部保存并重新启动）。

进一步的设置...可能需要重新生成 LTPA 密钥以进行产品部署。要让其他 WAS 服务器加入 SSO，请同步 LTPA 密钥。

很抱歉我最初的回复很混乱。

# c++ - 在自定义内存管理器中对抗碎片

> ID：580652
> 
> 赞同：0
> 
> 时间：2009-02-24T06:18:23.280
> 
> 标签：c++, memory-management, heap-fragmentation

我已经为堆分配编写了 ac/c++ 内存管理器（重载的 new/delete 和 malloc/realloc/free，基于 Doug Lea 的 malloc，但设计为免等待），并且似乎在碎片化方面遇到了一些问题。是否有任何好的资源可以详细说明通过管理器避免碎片化的好策略？

请注意，我无法重新排列已分配的内存（不使用带有 GUID 的智能指针）并且重写系统以使用池而不是堆分配是不可行的。

谢谢，
格兰特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T06:28:00.933

您可能想从 jemalloc ( [http://people.freebsd.org/~jasone/jemalloc/bsdcan2006/jemalloc.pdf](http://people.freebsd.org/~jasone/jemalloc/bsdcan2006/jemalloc.pdf) ) 中获得一些灵感——这个分配器在新的 Firefox 中被明确使用，因为它具有抗碎片化功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T06:58:12.467

看看像 glibc 这样更成熟的项目是如何做到的。

一个快速的谷歌找到了[这个](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.45.3382)，有一堆参考资料。

# perl - 如何使用 Perl 的 Archive::Tar 保存 tar 档案中的 setuid 位？

> ID：580653
> 
> 赞同：2
> 
> 时间：2009-02-24T06:18:40.940
> 
> 标签：perl, tar, setuid

我正在使用 Perl 的[Archive::Tar](http://search.cpan.org/dist/Archive-Tar)模块。它保留了文件权限，但不保留粘性位。在我提取档案的另一端，所有的粘性位都消失了。我认为 UNIX/LINUX 操作系统将这些粘性位存储在其他地方。我怎样才能让我的档案也保留粘性位？

使用 -p 开关 tar 保留它，但我如何使用[Archive::Tar](http://search.cpan.org/dist/Archive-Tar)来做到这一点？我在两边都使用 Perl 的模块。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T08:40:35.357

根据 Fine Source，Archive::Tar::File 会从模式中去除高位。您可以在脚本的开头尝试以下魔法咒语（在任何可能引用 Archive::Tar 之前），看看是否会破坏它：

```
use Archive::Tar::Constant ();
BEGIN {
    local $SIG{__WARN__} = sub{};
    *Archive::Tar::Constant::STRIP_MODE = sub(){ sub {shift} };
}
...
use Archive::Tar;
... 
```

简要说明：STRIP_MODE 是一个常量，包含一个可以传递原始模式并返回应该存储的模式的子程序。它通常设置为

```
sub { shift() & 0777 } 
```

因为它是一个常量，从 Archive::Tar::Constant 导入到 Archive::Tar::File 并在那里使用，所以无论它设置什么都将在编译时内联到 Archive::Tar::File 中。所以要改变它，常量必须在它被内联之前改变，也就是说，在 Archive::Tar::File 被加载之前。

NB 因为更改可内联常量容易出错（在太晚而没有任何效果之后更改它），它通常会生成一个无法通过常规方式禁用的严重警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T06:25:55.697

不确定，但是在官方的 tar 命令上，您需要通过*-p*来实现这一点

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-24T07:06:01.123

您可能想查看[Archive::Tar 文档](http://search.cpan.org/perldoc?Archive::Tar)以了解详细信息。乍一看，似乎

```
$Archive::Tar::CHMOD = 1; 
```

应该做你想做的事，尽管文档声称上述设置是默认设置。可能是 Archive::Tar 像粘性位一样剥离了高阶模式位。

归档文件是使用 Archive::Tar 创建和提取的，还是您在一端或另一端使用标准 tar 程序？

# c# - 请帮忙！如何读取拇指驱动器的“idVendor”和“idProduct”信息？

> ID：580655
> 
> 赞同：1
> 
> 时间：2009-02-24T06:19:40.530
> 
> 标签：c#

目前我正在使用 WMI 来检索大多数拇指驱动器信息...例如“制造商”、“序列号”等。但是我必须读取且无法读取的最重要信息是“idVendor”和“idProduct” .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T06:55:46.857

你不会像那样被割裂和干裂。您最接近的是尝试以下查询并查看“标题”、“名称”或“描述”列...

```
Select * from Win32_USBDevice 
```

您可以尝试按空格分解字符串并使用数组中的第一个元素作为制造商，但这是一个命中注定的失败。并非所有设备都将其信息存储在同一列中，因此您可能必须在 WMI 结果中添加一些逻辑才能获得您正在寻找的格式。

免责声明：我使用的是 Vista，所以我不知道我刚刚提供的 WMI 提供程序是否在早期版本的 Windows 中可用。

我会尝试使用 Scriptomatic 来查询各种 WMI 提供程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T06:43:52.470

您应该能够从 WMI 中提取此信息。搜索 WMI Code Creator，它提供了一种相当简单的方式来浏览 WMI 空间，甚至会生成代码供您启动。

# javascript - 如何获取事件的原始文本节点？

> ID：580656
> 
> 赞同：1
> 
> 时间：2009-02-24T06:20:12.747
> 
> 标签：javascript

例如，我有以下 html

```
<HTML>
<HEAD>
<script type="text/javascript">
function trackElement(event){
    event=event||window.event;
    var target = event.explicitOriginalTarget||event.srcElement||document.activeElement;
    var targetText = target.nodeValue||target.innerHTML;
    alert(targetText);
}
</script>
</HEAD>
<BODY onclick="trackElement(event)">
<div>bbbbbb<div>cccccc</div>dddddddddd<div>eeeeeeeee</div></div>
</BODY>
</HTML> 
```

当我点击“bbbbbb”时，

*   在 Firefox 上，我得到了“ `bbbbbb`”警报，这正是我所期望的。

*   但在 IE 上，我得到了“ `bbbbbb<div>cccccc</div>dddddddddd<div>eeeeeeeee</div>`”

当我点击“dddddddddd”时，

*   在 Firefox 上，我得到了“ `dddddddddd`”警报，这正是我所期望的。

*   但在 IE 上，我得到了“ `bbbbbb<div>cccccc</div>dddddddddd<div>eeeeeeeee</div>`”

如何在 IE 上使用 firefox 获得相同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T07:08:23.380

那是因为属性“nodeValue”为元素节点返回null，所以你返回innerHtml，它将包含元素内的整个html代码。在 Internet Explorer 中，您的目标由 event.srcElement 分配，因此是一个元素节点，而在 FF 中它是一个文本节点。解决问题的一种方法是以下代码：

```
function trackElement(event){
    event=event||window.event;
    var targetText;
    var target = event.explicitOriginalTarget||event.srcElement||document.activeElement;        
    if(target.nodeType==3){
        targetText = target.nodeValue       
    }else{      
        targetText = target.firstChild.nodeValue;
    }   
    alert(targetText);
} 
```

这样，如果您的分配分配了一个文本节点，您将返回该值，以及一个元素节点的第一个子节点的文本（这是您所追求的）。

编辑：原来我错了。问题是 event.srcElement 返回被点击的整个元素（event.explicitOriginalTarget 是特定于 mozilla 的）。从那里，您需要检索文本。如果元素中有多个文本，我认为没有简单的方法可以做到这一点。如果只有一个，那就是遍历子节点并显示文本节点的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T07:00:12.510

请参阅[crossbrowser-equivalent-of-explicitoriginaltarget-event-parameter](https://stackoverflow.com/questions/179826/crossbrowser-equivalent-of-explicitoriginaltarget-event-parameter)中关于 explicitoriginaltarget 的评论。

在 IE 中，你得到了 Div 元素，第二个元素在其中，这种分离 div 的解决方案对你有用吗？- 脚本是一样的...（这在 IE 和 FF 中都有效）

```
<BODY onclick="trackElement(event)">
  <div>bbbbbb</div>
  <div>cccccc</div>
</BODY> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T12:00:23.920

最后，我使用偏移量来检查点击了哪个文本节点，如下所示：

```
if ($.browser.mozilla) {
    el = event.originalEvent.explicitOriginalTarget;
}else{
    var parent =event.srcElement;
    var left = event.pageX;
    var top = event.pageY;
    var offset=$(parent).offset();
    for(var i=0;i<parent.childNodes.length;i++){
        var n = parent.childNodes[i];
        if ( n.nodeType == 1 ){
            if($(n).offset().top>offset.top){
                if($(n).offset().top>top){
                    el=parent.childNodes[i-1];
                    break;
                }
            }else if($(n).offset().top+$(n).height()>offset.top){
                if($(n).offset().left>left){
                    el=parent.childNodes[i-1];
                    break;
                }
            }
        }
        el=n;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T13:23:52.243

只是子串呢？

```
<script type="text/javascript">
function trackElement(event){
    event=event||window.event;
    var target = event.explicitOriginalTarget||event.srcElement||document.activeElement;
    var targetText = target.nodeValue||target.innerHTML.substr(0, target.innerHTML.indexOf("<"));
    alert(targetText);
}
</script>
</HEAD>
<BODY onclick="trackElement(event)">
<div>bbbbbb<div>cccccc<p>Hellooo</p></div></div> 
```

这似乎可行，单击 ccccc 返回“cccccc”，依此类推。还是我完全错过了重点？

编辑：您还需要在子串之前检查元素是否有任何子元素......

# c# - 为什么我的图像似乎是 Bgra 而不是 Argb 格式？

> ID：580666
> 
> 赞同：4
> 
> 时间：2009-02-24T06:23:42.783
> 
> 标签：c#, image-processing, lockbits

因此，我对刚刚运行的快速测试感到非常困惑。我正在用 C# 进行一些图像处理。Get/SetPixel() 被证明太慢了，所以我使用 LockBits 来获取原始数据。

但是，我似乎遇到了我无法弄清楚的情况。在扫描图像时，似乎每个像素都按 Bgra 排列，即按蓝色字节、绿色字节、红色字节和 alpha 的顺序排列。我的印象是它们将以 Argb 顺序排列。这是我正在使用的代码示例。

```
BitmapData baseData =
    m_baseImage.LockBits(new Rectangle(new Point(0, 0), m_baseImage.Size), 
        ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb);
Bitmap test = new Bitmap(m_baseImage.Width, m_baseImage.Height);           

byte* ptr = (byte*)baseData.Scan0;
for (int y = 0; y < m_baseImage.Height; ++y)
{                              
    for (int x = 0; x < m_baseImage.Width; ++x)
    {
        // this works, image is copied correctly
        Color c1 = Color.FromArgb(*(ptr + 3), *(ptr + 2), *(ptr + 1), *ptr);
        // below does not work!  Bytes are reversed.
        //Color c1 = Color.FromArgb(*ptr, *(ptr + 1), *(ptr + 2), *(ptr + 3));

        test.SetPixel(x, y, c1);
        ptr += 4;
    }             
}

m_baseImage.UnlockBits(baseData);
pictureBox1.Image = m_baseImage;
pictureBox2.Image = test; 
```

获取基本图像颜色的第一行有效，第二行无效。我很确定我在这里遗漏了一些非常明显的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T06:40:55.927

ARGB 是指作为字提取的字中的字节顺序。如果您一次获取一个字节，您将收到 em low to hi 因为 IBM PC 是[little-endian](http://www.cs.umass.edu/~Verts/cs32/endian.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T07:23:50.003

不仅颜色反转 BGRA，而且行也反转 - 图像的底部是内存中的第一个。这就是 Windows 一直以来的工作方式。

little-endian 的解释似乎很明显，但我认为这不是事实。如果您查看[Windows API 中 COLORREF](http://msdn.microsoft.com/en-us/library/dd183449(VS.85).aspx)的定义，您会注意到 Red 是低位字节，Blue 是高位字节；如果将其存储为单个整数值，则它将是 RGB0。

# sqlite - 如何在 SQLite 的 where 子句中使用布尔字段？

> ID：580668
> 
> 赞同：28
> 
> 时间：2009-02-24T06:24:26.497
> 
> 标签：sqlite, dblinq

这似乎是一个愚蠢的问题，然而。可能是我的 IDE 搞砸了我。这是代码（这是从 DbLinq 生成的）：

```
SELECT  pics$.Caption, pics$.Id, pics$.Path, pics$.Public, pics$.Active, portpics$.PortfolioID
FROM main.Pictures pics$
inner join main.PortfolioPictures portpics$    on  pics$.Id = portpics$.PictureId

WHERE   portpics$.PortfolioId = 1 AND pics$.Id > 0
--AND pics$.Active = 1 AND pics$.Public = 1
ORDER BY pics$.Id 
```

如果我运行此查询，我会返回三行，其中包含两个布尔字段，称为 Active 和 Public。添加注释掉的行不返回任何行。将行更改为以下任何一项：

```
pics$.Active = 'TRUE'
pics$.Active = 't' 
pics$.Active =  boolean(1) 
```

它不起作用。错误或没有结果。我已经对此进行了谷歌搜索，发现那里缺乏实际的 SQL 查询。我们在这里。

那么：如何在 SQLite 的 where 子句中使用布尔字段？

IDE 是 SQLite 管理员。

**更新**：嗯，我找到了答案。SQLite Administrator 显然会让你组成自己的类型；生成的创建 SQL 如下所示：

```
CREATE TABLE [Pictures] ([Id] INTEGER  PRIMARY KEY AUTOINCREMENT NOT NULL,
[Path] VARCHAR(50)  UNIQUE NOT NULL,[Caption] varchAR(50)  NULL,
[Public] BOOLEAN DEFAULT '0' NOT NULL,[Active] BOOLEAN DEFAULT '1' NOT NULL) 
```

查询的修复是

```
AND pics$.Active = 'Y' AND pics$.Public = 'Y' 
```

正如第一个回答者指出的那样，这里真正的问题是，SQLite 中没有布尔类型。不是问题，而是需要注意的事情。我正在使用**DbLinq**生成我的数据层；也许它不应该允许映射 SQLite 不支持的类型。或者它应该将所有不是 SQLite 原生的类型映射到字符串类型。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-26T19:26:46.557

您不需要使用任何比较运算符来比较 where 子句中的布尔值。

如果您的“布尔”列被命名为 is_selectable，那么您的 where 子句将是： `WHERE is_selectable`

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-24T06:43:03.597

SQLite 没有布尔类型：[SQLite 支持哪些数据类型？](http://www.sqlite.org/faq.html#q2)

注释掉的行应该可以工作，只需在数据中使用整数值 1 和 0 来表示布尔值。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T06:43:29.367

SQLite 没有内置的布尔类型——你必须使用整数来代替。此外，当您将值与 'TRUE' 和 't' 进行比较时，您会将其与这些值作为字符串进行比较，而不是作为布尔值或整数进行比较，因此比较总是会失败。

来源：[http ://www.sqlite.org/datatype3.html](http://www.sqlite.org/datatype3.html)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2017-08-09T05:36:17.570

--> 这将为您提供 is_online 字段的 False 值的结果

**select * from device_master where is_online!=1**

--> 这将为您提供具有 is_online 字段的 True 值的结果

**select * from device_master where is_online=1**

# javascript - 从 iframe 操作重定向父窗口

> ID：580669
> 
> 赞同：360
> 
> 时间：2009-02-24T06:24:34.107
> 
> 标签：javascript, iframe, dhtml

我需要使用什么 JavaScript 从 iframe 重定向父窗口？

我希望他们单击​​一个超链接，使用 JavaScript 或任何其他方法将父窗口重定向到一个新的 URL。

* * *

## 回答 #1

> 赞同：593
> 
> 时间：2010-07-07T08:41:58.050

```
window.top.location.href = "http://www.example.com"; 
```

将重定向最顶层的父 iframe。

```
window.parent.location.href = "http://www.example.com"; 
```

将重定向父 iframe。

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2009-02-24T11:31:02.610

我发现这`<a href="..." target="_top">link</a>`也有效

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2009-02-24T06:26:55.600

```
window.top.location.href = "http://example.com"; 
```

`window.top`指的是位于框架层次结构顶部的页面的窗口对象。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2014-11-25T12:51:13.957

`target="_parent"`对我来说很好。轻松无忧！

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-02-24T10:19:06.417

或以下替代方法（使用文档对象）

```
parent.document.location.href = "http://example.com"; 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-10-23T21:39:40.510

@MIP 是对的，但是对于较新版本的 Safari，您需要添加沙盒属性（HTML5）以提供对 iFrame 的重定向访问。有一些特定的值可以在它们之间添加一个空格。

参考（您需要滚动）： [https ://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe)

前任：

```
<iframe sandbox="allow-top-navigation" src="http://google.com/"></iframe> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-07-06T10:50:25.340

这将解决苦难。

```
<script>parent.location='http://google.com';</script> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-03-26T05:23:33.960

如果您想在用户无需执行任何操作的情况下重定向到另一个域，您可以使用该属性的链接：

```
target="_parent" 
```

如前所述，然后使用：

```
document.getElementById('link').click(); 
```

让它自动重定向。

例子：

```
<!DOCTYPE HTML>

<html>

<head>

</head>

<body>

<a id="link" target="_parent" href="outsideDomain.html"></a>

<script type="text/javascript">
    document.getElementById('link').click();
</script>

</body>

</html> 
```

注意：javascript click() 命令必须在您声明链接之后出现。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-08T13:17:32.100

可以从 iframe 重定向，但不能从父级获取信息。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-11-02T14:21:53.457

对于当前页面 - window.location.href = "Your url here";

对于父页面 - window.top.location.href = "Your url here";

从 HTML

```
<a href="http://someurl" target="_top">link</a> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-31T06:08:07.117

尝试使用

```
window.parent.window.location.href = 'http://google.com' 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-08T04:58:51.710

```
window.top.location.href = 'index.html'; 
```

这会将主窗口重定向到索引页面。谢谢

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2019-05-16T11:39:51.353

我们必须使用 window.top.location.href 从 iframe 操作重定向父窗口。

[演示网址](http://www.webdesignersdairy.com/2019/05/redirect-parent-window-from-iframe.html)：

* * *

## 回答 #14

> 赞同：-8
> 
> 时间：2013-08-27T19:56:08.820

通过同一父级中的 iframe 重定向父窗口中的 iframe：

```
window.parent.document.getElementById("content").src = "content.aspx?id=12"; 
```

# sql - Oracle 查询以获取书名？

> ID：580670
> 
> 赞同：0
> 
> 时间：2009-02-24T06:25:16.227
> 
> 标签：sql, oracle

```
table name:id
col1:owner-name
col2:book-id1
col3:book-id2

table name:book-name
col1:id
col2:name 
```

任何人都可以让我查询以使用上面的 2 个表获取以下结果所有者名称、书 1 名称、书 2 名称

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T06:30:40.647

```
SELECT id.owner-name, b1.name "book1-name", b2.name "book2-name"
FROM id
LEFT JOIN book-name "b1" ON b1.id = id.book-id1
LEFT JOIN book-name "b2" ON b2.id = id.book-id2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T07:11:34.557

```
SELECT a.OWNER-NAME,b1.name book1,b2.name book2
FROM ID a,BOOK-NAME b1,BOOK-NAME b2
where a.book-id1= b1.id
and a.book-id2= b2.id 
```

或者

```
SELECT a.OWNER-NAME,
(SELECT b1.name from BOOK-NAME b1 where b1.id=a.book-id1) BOOK_NAME1,
(SELECT b2.name from BOOK-NAME b2 where b2.id=a.book-id2) BOOK_NAME2
FROM ID a 
```

# php - 配置 _Session 以处理部署在多个服务器、不同子域上的应用程序

> ID：580671
> 
> 赞同：0
> 
> 时间：2009-02-24T06:25:26.743
> 
> 标签：php, session

我有一个包含 2 个应用程序的网站：

1.  前端应用
2.  后端应用

前端有 www 域，而后端有作业子域。例如，我的前端应用程序有 domain `www.example.com/*`，而我的后端是`job.example.com/*`. **我的前端应用程序可以位于一台服务器上，而后端可以位于另一台服务器上**。或者它们都存储在同一台服务器上。

现在的问题是我存储在超级全局_Session（PHP）中的会话变量是否可以跨不同的子域工作。如果我设置`_Sesssion["SessionID"]` ，`www.example.com/*`我可以从中检索相同的 _Sesssion["SessionID"]`job.example.com/*`吗？我需要做特殊配置才能工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T11:03:31.037

要在多个域/服务器上使用相同的会话，您必须注意两个方面：

*   会话数据的存储位置，以便两个域/服务器都可以访问它，以及
*   会话标识符如何在两个域/服务器上携带，以便。

**存储**
对于不同的服务器，您可以编写自己的两个服务器都可以使用的[会话保存处理程序。](http://docs.php.net/session_set_save_handler)例如，这可能是一个双方都可以访问的数据库。

**会话 ID 共享**
如果您想为多个域（可能在同一台服务器上或不同的服务器上）共享一个会话 ID，并希望使用 cookie 来传输会话 ID，则必须[修改会话 ID cookie 设置](http://docs.php.net/session_set_cookie_params)以使 cookie 有效对于这两个域。但这只有在两个域共享相同的更高级别域时才有可能。对于`www.example.com`和`jobs.example.com`那个共享`example.com`，`$domain`参数 for`session_set_cookie_params()`必须设置为`.example.com`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T06:43:46.963

会话数据保存在[`session_save_path`](http://www.php.net/manual/en/function.session-save-path.php)函数给定的路径中，因此您需要使两个应用程序都可以访问该目录。如果它们在同一台服务器上，您可能不需要做任何事情，但如果它们在不同的服务器上，则必须使用某种网络文件系统（如 NFS）并挂载它，以便会话保存路径位于两台服务器的网络文件系统上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T09:42:40.357

您可以编写自己的会话处理程序，将会话数据保存到数据库中，然后您可以从任何有权访问该数据库的服务器访问该数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T10:10:51.710

编写您自己的会话处理程序： http: [//de.php.net/manual/en/function.session-set-save-handler.php](http://de.php.net/manual/en/function.session-set-save-handler.php)

使用中央数据库或内存缓存服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T10:20:14.947

子域只会影响您的 cookie，必须正确设置（在域范围内）以通过从 www.* 导航到 jobs.* 来保留您的会话 ID。

对于会话持久性，您可以使用 memcache 服务器并使用[php_memcache 会话处理程序](http://de3.php.net/manual/en/memcache.ini.php)。您不需要编写自己的会话处理程序。

# java - 为在 Tomcat 中存储图像指定外部目录的最佳实践？

> ID：580682
> 
> 赞同：0
> 
> 时间：2009-02-24T06:30:36.607
> 
> 标签：java, tomcat, jakarta-ee

为在 Tomcat 中存储图像指定外部目录的最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-15T09:05:51.843

我们使用的方法，

[使用System.getProperty](http://java.sun.com/javase/6/docs/api/java/lang/System.html#getProperty%28java.lang.String%29) (-D IMAGES_BASE_DIR="Your Base_Image_DIR")获取基本目录路径

接下来我们可以根据需要附加/嵌套更多目录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T06:56:52.783

最好的独立于容器的答案是将位置放在 JNDI 中。

对于 Tomcat，您可以在 Tomcat 类路径中放置一个包含特定信息的类。这对 Web 应用程序是可见的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T12:36:56.483

我假设您的图像文件不需要在类路径上。执行此操作的一个好方法是在 Web 应用程序根目录之外指定一个目录。然后，您的应用程序应允许`baseUrl`使用绝对路径值配置此属性（由 File 类指定，即 like `"C:/Dev/mypicsdir"`.

将此目录保留在您的根目录和项目之外，您可以重新部署并更新到应用程序的新版本，而无需对存储的文件执行任何操作。如果应该可以从浏览器访问这些图像，请在 Tomcat 中创建一个单独的 Web 应用程序。

如果可能，将其限制为单个目录，但您需要解决保存的文件是唯一的。一种方法是自己控制文件名，或者让用户控制文件名。在最后一种情况下，您还必须检查具有所选名称的文件是否已经存在。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-07-20T13:36:21.297

如果是 linux，您可以轻松地将符号链接映射为 /imagesext 目录

# java - Java中的验证框架

> ID：580686
> 
> 赞同：4
> 
> 时间：2009-02-24T06:40:42.727
> 
> 标签：java, validation, frameworks

我们目前正在重构我们的插件 API**（兼容 JDK 1.4）**，它以 jar 文件的形式发送给我们的客户（即，无需生成 javascript 等等）。这是一个非常轻量级的插件，因此我们像 Spring 一样保留了尽可能多的依赖 jar。在此过程中，我们开始了解需要有一个适当的验证方法，该方法由一些验证框架提供支持。**奇怪的是，除了Commons Validator、Drools 和 Spring support**等少数几个选项外，我在这些行（如其他开源项目）中找不到太多选项。

Drools 似乎对我的需求如此复杂。然而，Commons 验证器的验证方式看起来像是史前的。

**我不能使用基于注释的验证**，因为它必须是 JDK 1.4，并且更喜欢可以外部化的东西，因此在发生更改时不需要再次编译类。

有更好的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T07:04:15.777

XWork 验证系统在当时相当不错，但我已经快 3 年没有使用它了。我很确定它被设计为完全独立的，但也与 WebWork 的其余部分一起被整合到 Struts 2 中。信息在这里：

[http://www.opensymphony.com/xwork/wikidocs/Validation%20Framework.html](http://www.opensymphony.com/xwork/wikidocs/Validation%20Framework.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T00:29:11.473

试试休眠验证器。它主要针对使用注释，但没有注释也完全可用。我用了几次，很喜欢它的模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T07:22:27.933

我们使用的是来自 sapia 的[VLAD 框架](http://www.sapia-oss.org/projects/vlad/)，可以通过 XML 和 BeanShell 进行配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-11T04:55:00.020

If you prefer your validation rules in declarative style, you can try [http://jvalidations.codehaus.org/](http://jvalidations.codehaus.org/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-23T17:52:43.533

我最近发现了[JValidations](http://jvalidations.codehaus.org/)框架。它是纯 Java，没有 XML。使用 Hamcrest 匹配器。验证代码放置在经过验证的对象本身中。整洁的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T06:07:41.953

ValangValidator 是一个与 Spring 兼容的验证器，它使用“valang”语法，因此如果你只需要简单的验证，你可以为你的 spring 验证器 bean 插入一个 valang 验证器。ValangValidator 还使您能够插入自己的自定义函数实现。它是“springmodules”的一部分。

有关更多信息，请参阅此[链接](https://springmodules.dev.java.net/docs/reference/0.6/html/validation.html)。

# html - Eclipse Ganymede for OS X 不包含 HTML 格式化程序。备择方案？

> ID：580695
> 
> 赞同：1
> 
> 时间：2009-02-24T06:44:31.580
> 
> 标签：html, eclipse, code-formatting, ganymede

在 Eclipse 3.4 for Windows 中，用于格式化 Java 代码的 Source -> Format 选项被扩展为格式化 HTML 代码。但是，对于 OS X，此选项被禁用。此外，首选项中没有格式选项。我已经下载了所有 Eclipse 的 Web 工具，但该选项仍然不可用。

哪个插件/功能允许在 Eclipse OS X 上进行 HTML 格式设置（如果有的话）？否则，有什么好的基于 Web 的替代方案？

谢谢，亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-11T04:17:55.217

我无法解决问题。所以我创造了一个转机。我为 html Tidy 验证器创建了一个外部工具配置：

1) 工具栏 > 外部工具配置 2) 例如命名为 'Tidy Format' 3) 给 tidy 的位置（当然你必须安装它） 4) 使用这些参数：--indent yes -m ${workspace_loc}/$ {selected_resource_path} 5）在刷新选项卡中我有：刷新所选资源 6）构建选项卡：无 7）环境选项卡：无 8）通用选项卡：本地文件，显示外部工具，分配控制台，未选中在后台启动

现在该工具在您正在编辑的文件的外部工具菜单中可用。这对我来说很有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T08:06:06.673

在即将发布的 Galileo 版本中，我没有看到任何“与 Mac OSX 相关的”格式改进（如他们的[新闻和值得注意](http://download.eclipse.org/eclipse/downloads/drops/S-3.5M5-200902021535/eclipse-news-M5.html)的页面中所述）

可能是像这个[Flex 格式化程序](http://mac.softpedia.com/get/Developer-Tools/Flex-Formatter.shtml)这样的外部插件（也[有作为 Sourceforge 项目](http://sourceforge.net/projects/flexformatter)）会带来更好的 HTML 格式化*的副作用？*

（免责声明：我没有测试过）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T14:31:30.763

对我来说，这在 OS X 上的 Ganymede 中运行良好。两个想法：

*   也许您的 Web 开发人员工具 ( `Update Manager -> Ganymede -> Web and Java EE Development -> Web Developer Tools`) 安装不完整或丢失？
*   可能是您没有使用 HTML 编辑器 ( `Open With -> HTML Editor`) 打开文件吗？

# eclipse - 我无法在 Eclipse 中创建动态 Web 应用程序

> ID：580698
> 
> 赞同：4
> 
> 时间：2009-02-24T06:45:30.487
> 
> 标签：eclipse, eclipse-plugin

我无法在 Eclipse 中创建新的动态 Web 应用程序。如果我从文件菜单中单击新项目，它不会显示“动态 Web 应用程序”选项。它没有显示“Web”选项。我正在运行 Eclipse 3.4.0。

任何人都可以提供帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T06:59:31.263

要查看这种“新项目”功能：

[![替代文字](https://i.stack.imgur.com/wC1fr.png)](https://i.stack.imgur.com/wC1fr.png)
[（来源：[viralpatel.net](https://viralpatel.net/blogs/wp-content/uploads/2008/12/eclipse-new-project-struts-example.png)）]

，你能检查一下：

*   如果您在 Eclipse 配置中[安装了 WTP ？](https://www.eclipse.org/webtools/jsf/dev_resource/JSFTutorial-RC3/JSFTools_tutorial.html)
*   你目前的观点是什么？（尝试使用“Java”或更好的“J2EE”，如IBM 文章[“使用 Eclipse、WTP 和 Derby 构建 Web 应用程序”中所述）](https://www.ibm.com/developerworks/data/library/techarticle/dm-0509cline/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-25T22:59:21.207

您需要**Java EE 开发人员工具**来创建**动态 Web 项目**

*   转到帮助-> 安装新软件。
*   在下拉列表中，选择“Juno - [http://download.eclipse.org/releases/juno](http://download.eclipse.org/releases/juno) ”
*   展开“Web、XML、Java EE 和 OSGI 企业开发”
*   选中“Eclipse Java EE 开发人员工具”复选框

安装后，您可以创建一个新建 -> 其他 -> 动态 Web 项目

# javascript - 这个网址到底是什么意思？

> ID：580700
> 
> 赞同：1
> 
> 时间：2009-02-24T06:46:10.170
> 
> 标签：javascript, seo, query-string

我在我们的一个 Web 应用程序中使用不同的分析标签。他们中的大多数人调用 javascript 代码进行跟踪。

一些标签有带有查询字符串的 gif 图像的 url。

示例：[http ://www.google-analytics.com/__utm.gif?utmwv=45.542](http://www.google-analytics.com/__utm.gif?utmwv=45.542)

这个网址到底是做什么的？他们如何从查询字符串中获取值？

更新：（阅读一些答案后）我知道每个浏览器都会加载 1x1 像素的 gif。但是他们如何从查询字符串中获取值？在上述情况下，他们如何检索 utmwv 的值？任何代码示例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T07:38:24.197

基本上，您使用首选语言编写脚本，并将该脚本映射到*yourtrackingscript.gif*。..jpg、png 甚至。

使用 http 处理程序在 asp.net 中完成了此操作。

该脚本像任何其他动态页面（aspnet、asp、php 等等）一样读取查询字符串，然后将其写入数据库或日志文件，或者执行任何您想要对其执行的操作。

然后适当地设置内容类型标题，例如“image/gif”，然后发回一个 1 像素的图像，或者你喜欢的任何其他大小的图像。

对于仅 1 像素的图像，我在十六进制编辑器中打开了 1 像素的 spacer.gif 类型图像，并将其硬编码为字节数组以作为响应发送出去，如果它被击中将节省一点 IO 开销很多，或者，您可以从磁盘或数据库中读取文件并将其发回。

这是电子邮件通讯中常用的技巧来跟踪打开率等。
通常最难的一点是当您没有足够的权限将 url 映射到共享机器上的脚本时，但您可以将其开发为正常的脚本/程序，然后在它工作后整理映射。

如果大多数现代浏览器发送正确的标头，则大多数现代浏览器会将 aspx 或 php (.etc...) url 作为图像响应，旧浏览器、浏览器保姆插件和电子邮件客户端是最棘手的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T06:50:18.757

就像您可以将查询字符串传递给 ASP.NET 页面一样，您实际上可以将查询字符串传递给任何 URL；如果您使用基于 MVC 的框架，如 ASP.NET MVC 或 Rails，则从这样的 URL 捕获参数很容易。然后，您所要做的就是返回一个 GIF 图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T06:54:39.060

任何浏览器都会在他的 url 上加载图像，即使没有 javascript。当它这样做时，可以捕获来自客户端的查询字符串参数和请求标头以进行分析。因此，它允许在完全没有 javascript 的情况下捕获分析。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T08:21:55.950

那不是 GIF，那是空间站^(（测试版）)！

换句话说，虽然 URL 似乎指向一个图像，但 www.google-analytics.com 上的网络服务器将此请求交给一些处理脚本，然后提取数据并将 1x1 GIF 图像内容发送回浏览器。

这是一个使用 Apache 网络服务器和 mod_rewrite 的示例：

```
# in .htaccess
RewriteEngine On
RewriteRule ^__utm\.gif /someprocessingscript.php [QSA]

<?php // in someprocessingscript.php
do_some_tracking($_GET); // this would probably analyze and log data
header('Content-Type: image/gif');
readfile('1x1.gif');
exit;
?> 
```

另一种选择：提供真正的 GIF（可能带有`Cache-Control: no-cache`），记录所有访问，然后分析日志。这可能会更快，因为这不需要内部重写，也不需要在每次访问时编写脚本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T06:49:54.030

当您请求图像时，查询字符串仍会发送到服务器。

当然，我不知道他们如何处理服务器上的数据的确切细节，但 .gif 是一种相当常见的将数据发回用于分析目的的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T06:52:45.600

好吧.. __utm.gif 是一个 1x1 像素的图像，谷歌必须记录访问 - 这意味着他们也在他们的日志中收集查询字符串值。真的没有什么棘手的。我认为 utmwv 是一个版本号，但不清楚该数字的含义

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T08:36:31.950

> 但是他们如何从查询字符串中获取值？在上述情况下，他们如何检索 utmwv 的值？任何代码示例？

如果他们想要调用页面，他们有引用者，如果他们想要他们的参数，他们有请求 URI。

```
print($_SERVER['HTTP_REFERER']);
print($_SERVER['REQUEST_URI']); 
```

# sql-server - 如何在 VS2008 中调试 CLR proc？

> ID：580701
> 
> 赞同：0
> 
> 时间：2009-02-24T06:46:21.310
> 
> 标签：sql-server, visual-studio-2008

我在 VS2008 中编写了一个 CLR proc 并部署到 SQL 2005 DB。

我已将模式设置为调试并确保我的 .sql 脚本设置为运行我的 proc。

已将权限级别部署为 External 并将 db 设置为可信任。

但是当我运行断点时，没有命中，似乎什么也没有发生。

请问我错过了什么？？？

马尔科姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T07:16:52.767

这个[MSDN 论坛主题](http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/89cf57bb-5cf4-4405-a0c4-b4c51ad54d0c/)建议尝试在 SQL 机器上重新启动[远程调试器](http://msdn.microsoft.com/en-us/library/bt727f1t.aspx)(msvsmon.exe)。

[编辑：您是否按照本文](http://msdn.microsoft.com/en-us/library/ms165051.aspx)设置了 SQL CLR 存储过程的远程调试？

# c# - 无法加载视图状态。只是偶尔发生。难以重现

> ID：580704
> 
> 赞同：15
> 
> 时间：2009-02-24T06:47:48.937
> 
> 标签：c#, asp.net, ajax, viewstate

错误的详细信息如下。此错误仅偶尔/很少/有时发生，并且没有任何步骤可以重现它。

我怎么知道哪个控件抛出了这个 Viewstate 错误？

错误消息：无法加载视图状态。正在加载视图状态的控制树必须与在先前请求期间用于保存视图状态的控制树匹配。例如，当动态添加控件时，回发期间添加的控件必须与初始请求期间添加的控件的类型和位置相匹配。

时间：很少/偶尔

重建步骤：不能

堆栈跟踪：

```
System.Web.HttpUnhandledException: Exception of type 'System.Web.HttpUnhandledException' was thrown. ---> System.Web.HttpException: Failed to load viewstate.  The control tree into which viewstate is being loaded must match the control tree that was used to save viewstate during the previous request.  For example, when adding controls dynamically, the controls added during a post-back must match the type and position of the controls added during the initial request.
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Control.LoadChildViewStateByIndex(ArrayList childState)
   at System.Web.UI.Control.LoadViewStateRecursive(Object savedState)
   at System.Web.UI.Page.LoadAllState()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   --- End of inner exception stack trace ---
   at System.Web.UI.Page.HandleError(Exception e)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest()
   at System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context)
   at System.Web.UI.Page.ProcessRequest(HttpContext context)
   at ASP.sessions_aspx.ProcessRequest(HttpContext context) in c:\windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\73694782\85423fe4\App_Web_mnrmfsfa.8.cs:line 0
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-24T07:55:58.133

> 不幸的是，没有办法查看究竟是哪个有罪控制没有正确添加到控制层次结构中。

有！

在调试设置中禁用“只是我的代码”。并捕获所有抛出的异常（在 Ctrl-Alt-E 打开的对话框中检查公共语言运行时的“抛出”）。

发生异常后，转到 Control 对象可用的最近的堆栈帧并检查其 ClientID 和父级。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-24T07:43:50.377

**更一般地，当页面的控制层次结构以**阻止框架加载视图状态的方式发生更改时，会发生此错误。视图状态机制假定控件层次结构在加载时与保存时相同。

这**可能**看起来像一个随机错误，因为在某些情况下更改页面中的控件不会阻止加载视图状态。查看您的页面并查找动态创建/删除的控件。确保在加载视图状态**之前**（即在页面加载事件之前）将任何控件添加到页面。

不幸的是，没有办法查看究竟是哪个有罪控制没有正确添加到控制层次结构中。查看此错误的常见方法是在事件上添加一些动态控件（例如，在更改的下拉选定索引上） - 这样它们的状态将保存到视图状态 - 但不会在回发时再次添加它们 - 这样视图state 无效，因为加载视图状态时控件不再存在。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-02-10T09:38:58.823

此错误有一个解决方法：

将所有动态加载控件的 EnableViewstate 属性设置为 false。这不是一个完整的解决方案；我们在此处禁用控件的 ViewState 以绕过此错误。

此解决方案可能会引起其他错误，因此在应用此修复程序时要小心。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T06:50:19.553

我遇到过这个错误，它发生在跨页面回发时。

**例如**：您加载视图 A。视图 A 加载正常，无论出于何种原因，加载视图 A 的条件不再存在。后备页面是视图 B。因此用户在视图 A 上完成表单并回发。由于不再满足视图 A 的条件，视图 A 的表单值将发布到视图 B。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-23T20:41:38.407

当我的自定义控件在 Page_Load() 中意外创建时，我遇到了这个错误。控件应该在 OnInit() 中动态创建。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-03-27T14:11:24.147

这可能应该为你做。

[http://yakshaver.blogspot.com/2011/03/greatest-viewstate-attribute-to-ever.html](http://yakshaver.blogspot.com/2011/03/greatest-viewstate-attribute-to-ever.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-07T10:57:54.857

我遇到了完全相同的问题。我在母版页中有 2 个列表视图，与 2 个更新面板相关联。

禁用 Listviews 上的 EnableViewState 为我解决了这个问题！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T19:25:17.507

我在使用 gridview 时看到了这个错误。当页面完全渲染完成之前用户交互导致回发时，就会发生这种情况。

不过，我相信它已在 VS2005 SP1 中修复。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-13T04:32:46.970

您可以通过在页面完全加载之前**停止页面***然后*提交回发来重现此情况。如果服务器无法从服务器获取完整的视图状态，那么它将无法在回发时重新创建它，从而导致崩溃。

# jquery - 为什么我的 jquery $.get() 不显示任何响应

> ID：580708
> 
> 赞同：0
> 
> 时间：2009-02-24T06:50:10.707
> 
> 标签：jquery

这是我的 shop.html 片段：

```
<li><a id="linkShop" href="shop.html">shop</a></li>
<div id="paneMiddle"></div> 
```

这是我的 main.js 片段：

```
$("a[id=linkShop]").click(function(){
    $.get("data1.html", function(response){
        $("div[id=paneMiddle]").html(response);
        alert("hi"+ response);
    }); 

}); 
```

data1.html 有这个内容：

```
<p>data 1 - test</p> 
```

我真的不知道为什么现在会发生这种情况，我以前在 php 中尝试过 $.get，但是现在，我正在尝试使用 jquery w/jsp，在 tomcat 服务器中运行。idk 为什么我的 $.get() 函数什么也没发生。

帮帮我..请... TT

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T06:59:33.790

您不会取消单击事件对单击链接的默认操作，因此当您单击链接时，您只需在 $.get 得到任何响应之前重新加载页面。

尝试

```
$("a[id=linkShop]").click(function(){
        $.get("data1.html", function(response){
                $("div[id=paneMiddle]").html(response);
                alert("hi"+ response);
        });     
        return false;
}); 
```

或者

```
$("a[id=linkShop]").click(function(evt){
        $.get("data1.html", function(response){
                $("div[id=paneMiddle]").html(response);
                alert("hi"+ response);
        });     
        evt.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T06:59:51.700

不使用 <A> 标签作为您的点击目标怎么样 .. 也许只使用 span 代替？

```
<li><span id='linkShop' style='cursor:pointer'>shop</span></li>
<div id="paneMiddle"></div> 
```

然后简单地

```
$("#linkShop").click(function() {
    $("#paneMiddle").load("data.html");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T07:05:49.703

尝试使用 event.preventDefault 取消链接的默认操作：

```
$("a[id=linkShop]").click(function(event){ 
        event.preventDefault(); 
        $.get("data1.html", function(response){ 

                $("div[id=paneMiddle]").html(response); 
                alert("hi"+ response); 
        });      
}); 
```

[你可以在这里](http://jsbin.com/ojeyu/edit)测试你的脚本，你可以在[这里](http://jsbin.com/ubera/edit)修改你的 ajax 加载的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T07:07:03.820

试试这个

```
$("a#linkShop").click(function(){
    $.get("data1.html", function(response){
            $("div#paneMiddle").html(response);
            alert("hi"+ response);
    }); 
```

});

# javascript - 你用什么来监控 Internet Explorer 中的 jscript 内存使用情况

> ID：580712
> 
> 赞同：6
> 
> 时间：2009-02-24T06:50:51.393
> 
> 标签：javascript, internet-explorer, gwt, memory-management

我们正在调试一个 GWT 应用程序。在 Firefox 中运行正常，在 IE6.0 中开始运行正常，但一段时间后，它会跪下并开始爬行。在做了一些测试之后，我们怀疑存在一些内存问题（使用的内存过多、内存泄漏等），除了使用 taskmanager 和 processxp 来观察内存使用量的增长：）....¿您是否推荐任何其他内存监控工具？

像 jprobe for jscript 一样吗？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-08T07:22:42.050

我之前已经回答了关于 IE [Here中的 JS 内存泄漏检测的类似问题](https://stackoverflow.com/questions/1469841/how-to-check-if-memory-leak-occurs-when-removing-an-element-out-of-dom/1470092#1470092)

这些是我正在使用的工具

*   [筛](http://home.orange.nl/jsrosman/)
*   [IEJSLeaksDetector2.0.1.1](http://blogs.msdn.com/gpde/pages/javascript-memory-leak-detector-v2.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-04T15:09:00.517

[http://sourceforge.net/projects/ieleak/](http://sourceforge.net/projects/ieleak/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-12T18:09:50.810

我用过[Drip](http://outofhanwell.com/ieleak/index.php?title=Main_Page)，效果很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T02:01:43.973

现在我正在使用“sIEve”：[http ://home.wanadoo.nl/jsrosman/](http://home.wanadoo.nl/jsrosman/)

目前我正在使用它来查看 IE 分配（和取消分配）多少字节以响应用户活动（用户打开菜单，GWT 执行一些 javascript，IE 分配内存）。

我也尝试了这些其他工具，但我还没有任何结论 [http://blogs.msdn.com/gpde/pages/javascript-memory-leak-detector.aspx](http://blogs.msdn.com/gpde/pages/javascript-memory-leak-detector.aspx) [http://www.microsoft.com/downloadS/ details.aspx?FamilyID=28bd5941-c458-46f1-b24d-f60151d875a3&displaylang=en](http://www.microsoft.com/downloadS/details.aspx?FamilyID=28bd5941-c458-46f1-b24d-f60151d875a3&displaylang=en)

# asp.net - 在 ASP.Net AJAX 应用程序中强制会话超时

> ID：580723
> 
> 赞同：0
> 
> 时间：2009-02-24T06:56:56.353
> 
> 标签：asp.net, ajax, asmx

我有一个大的 1 页 ASP.Net 应用程序。该应用程序的大部分内容已使用 .Net 3.5 从使用 .Net 2.0 的先前版本完全重写。结果，此版本的设计者决定将整个页面放在更新面板中（*叹气*）。似乎这个更新面板的唯一好处是它允许在会话超时（约 30 分钟）时重定向到超时页面。

我的团队在此页面上的一个选项卡中实现了一个新部分，该部分使用 ASP.Net AJAX 访问 asmx Web 服务（这将很快转移到 WCF ScriptService）。这里的所有调用都是通过调用 ASP.Net AJAX JavaScript 代理的自定义 JavaScript 完成的。

我的问题是，如果发生部分回发，在页面的其余部分超时之后，这些 Web 服务调用仍在进行。

我正在寻找的是某种方式让我的新功能与应用程序的其余部分同时超时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T08:50:59.077

如果 Web 应用程序应该控制会话，它必须提供一种查询它的方法。这可以通过诸如 IsTheSessionStillUp 之类的 ping 机制之王来实现，它会响应是或否。一个简单的 aspx 页面就可以做到这一点。然后所有外部服务都需要查询状态，如果主 Web 应用程序会话超时，也会强制服务超时。这可以在进行服务调用之前在服务代理中作为 ping 调用来实现。

# web-services - ASP.net 中时间显示的 Web 服务

> ID：580727
> 
> 赞同：0
> 
> 时间：2009-02-24T06:59:03.947
> 
> 标签：web-services, datetime

我需要在我的 ASP.net Web 应用程序中显示时间信息（IST、GMT、EST）时间。是否有任何网络服务提供这些数据。它应该是免费的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T07:14:26.877

.NET BCL 几乎拥有您需要的一切。`DateTime`和`TimeZone`班级是你的朋友。

# redirect - 在中等信任中从 Global.asax 重定向

> ID：580728
> 
> 赞同：0
> 
> 时间：2009-02-24T06:59:29.220
> 
> 标签：redirect, httpmodule, global-asax, medium-trust

我试图在 Global.asax 的 Application_Error 处理程序中进行重定向。一点都不花哨。

```
private void Application_Error(object sender, EventArgs e)
{
   // ...snip...

   Server.Transfer(somePath, false);

   // ...snip...
} 
```

这在完全信任下工作得很好，但我需要让它在中等信任下工作。我在这里工作的代码需要在共享托管环境中正常运行（不幸的是，我无法控制这个要求）。

但是，当我在我们的开发环境（XP Pro / IIS 5.1）中配置站点以进行测试时：

```
<system.web>
  <trust level="Medium"/>
</system.web> 
```

它失败并出现以下错误：

```
请求“System.Security.Permissions.SecurityPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089”类型的权限失败。**
   在 System.Security.CodeAccessSecurityEngine.Check（对象需求，StackCrawlMark& stackMark，布尔 isPermSet）
   在 System.Security.CodeAccessPermission.Demand()
   在 System.Web.HttpWorkerRequest.SendResponseFromMemory（IntPtr 数据，Int32 长度）
   在 System.Web.HttpWorkerRequest.SendResponseFromMemory（IntPtr 数据，Int32 长度，布尔 isBufferFromUnmanagedPool）
   在 System.Web.HttpResponseUnmanagedBufferElement。
      System.Web.IHttpResponseElement.Send（HttpWorkerRequest WR）
   在 System.Web.HttpWriter.Send（HttpWorkerRequest WR）
   在 System.Web.HttpResponse.Flush（布尔 finalFlush）
   在 System.Web.HttpResponse.Flush()
   在 System.Web.HttpResponse.End()
   在 System.Web.HttpServerUtility.Transfer（字符串路径，布尔值 preserveForm）

```

其他一些值得注意的事情：

*   无论是从 Global.asax 还是从 HttpModule 都会发生这种情况。
*   Response.Redirect(somePath) 也会发生这种情况。

感谢您提供的任何见解。我已经在谷歌上搜索了我的 $$ 折扣，但并不高兴。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:36:37.357

我和你有同样的问题。

我用了：

```
Response.Redirect("~/ErrorRedirectPage.aspx",false); 
```

它工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T19:58:42.407

我今天遇到了同样的问题，但我想我找到了一个可以接受的解决方法。事实证明，指定 Response.Status 代码可以解决此问题。

```
private void Application_Error(object sender, EventArgs e)
{
   // ...snip...

   Response.StatusCode = 500;
   Server.Transfer(somePath, false);

   // ...snip...
} 
```

不幸的是，如果您调试页面，似乎仍然会出现 SecurityPermissions 错误。我不确定这到底有多少问题，因为 Server.Transfer 将继续没有错误，并且对用户没有明显影响。

我很想知道是否有人对此事有想法或意见。

# sql-server - 从 SQL Server 强制执行 SQL Server 连接字符串

> ID：580731
> 
> 赞同：0
> 
> 时间：2009-02-24T06:59:47.457
> 
> 标签：sql-server

我有一个客户要求，在连接到 SQL Server 时，应用程序连接字符串中只能使用 DNS 别名。有没有办法从服务器端强制执行此操作？这样做的目的是防止在应用程序中对 IP 地址进行硬编码，这可能会随着时间而改变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T07:40:45.737

与其强制执行此操作（看起来您可能无法轻松执行），不如对其进行审核。

您应该能够构建一个小应用程序来监控成功登录的跟踪。然后，当发生使用 DNS 别名以外的登录时，应用程序可以提醒系统管理员/开发人员等。

这些资源可能有助于跟踪：

[http://blogs.msdn.com/sqlprogrammability/archive/2006/08/16/703079.aspx](http://blogs.msdn.com/sqlprogrammability/archive/2006/08/16/703079.aspx)

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T07:19:43.867

无法从服务器端强制执行此操作。

IP 地址（或服务器名称）不应硬编码到应用程序中。它们应该驻留在配置文件中（必要时加密）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T07:42:57.557

当您说“别名”时，您的意思是“不是 IP 地址”还是“CNAME 记录而不是 A 记录”？如果您的意思是后者，您可以进行正向 DNS 查找，然后对返回的 IP 地址进行反向查找。如果返回的名称与原始查找中的名称相同，则很可能不是别名。那应该可以解决这个要求，但它并没有真正解决它是一个奇怪的要求的事实:)

# sql - DB2 表中的列描述

> ID：580735
> 
> 赞同：27
> 
> 时间：2009-02-24T07:01:13.507
> 
> 标签：sql, db2

我们如何通过SQL知道表（DB2）中每一列的描述？

我的数据库是 DB2。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-24T07:57:18.677

```
select 
  tabname,
  colname,
  typename,
  length,
  scale,
  default,
  nulls,
  identity,
  generated,
  remarks,
  keyseq 
from 
  syscat.columns 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-09-12T22:30:46.090

```
SELECT 
TABLE_CAT, 
TABLE_SCHEM, 
TABLE_NAME, 
COLUMN_NAME, 
DATA_TYPE, 
TYPE_NAME, 
COLUMN_SIZE, 
COLUMN_TEXT
FROM "SYSIBM"."SQLCOLUMNS"
WHERE TABLE_SCHEM = 'SCHEMA' 
 AND TABLE_NAME = 'TABLE' 
```

这是在 DB2 V5R4 上，不是系统表而是`SYSTEM VIEW`. 以防你在表格列表中寻找它而发疯。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-04-30T16:10:26.410

-- 注意：where 子句区分大小写，需要大写

```
select
t.table_schema as Library
,t.table_name
,t.table_type
,c.column_name
,c.ordinal_position
,c.data_type
,c.character_maximum_length as Length
,c.numeric_precision as Precision
,c.numeric_scale as Scale
,c.column_default
,t.is_insertable_into
from sysibm.tables t
join sysibm.columns c
on t.table_schema = c.table_schema
and t.table_name = c.table_name
where t.table_schema = 'MYLIB'
and t.table_name = 'MYTABLE'
order by t.table_name, c.ordinal_position 
```

-- 获取所有元表的列表：

```
select * from sysibm.tables
where table_schema = 'SYSIBM' 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-10-03T15:09:54.600

`SELECT COLNAME, REMARKS FROM SYSCAT.COLUMNS WHERE TABSCHEMA = 'MYSCHEMA' AND TABNAME = 'MYTABLENAME'`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T20:57:25.900

```
describe table schema.table_name ; 
```

[**DB2 描述命令**](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/core/r0002019.htm)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-27T14:31:43.727

我在 iSeries DB2 box (v5r4) 上工作，它是一种特殊的 DB2。

如果您正在使用或连接到 iSeries (AS/400)，Anton 提到的链接非常好（抱歉，还不能投票！）

Describe 不适用于 iSeries，但可以在其他平台上与 DB2 一起使用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-03-27T06:38:41.947

```
select T1.name,T1.creator from sysibm.systables T1,sysibm.syscolumns 
T2 where T1.name=T2.tbname and T1.creator=T2.tbccreator and 
T1.creator='CREATOR NAME' and T2.name='COLUMN NAME' 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-19T10:55:23.877

为我工作：

```
select * from sysibm.columns
where table_schema = 'MY_SCHEMA' 
```

# javascript - HTML 会被任何新技术取代吗？

> ID：580740
> 
> 赞同：12
> 
> 时间：2009-02-24T07:05:06.740
> 
> 标签：javascript, html, css, flash, silverlight

我看到各种框架正在推出，它们承诺丰富的 UI 和他们所说的更好的用户体验。Silverlight、Flash、雅虎新框架等。

这是否意味着在一段时间内这些框架将取代现有的基于 HTML、JAVASCRIPT CSS 的 Web 应用程序？

这和在浏览器窗口中打开应用程序不一样吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T07:29:07.213

HTML 不会很快被替换为标准。它的技术传播范围太广，使用 web 应用程序和网站的人完全转换技术所需的再教育量将是巨大的并且非常昂贵。

然而，HTML 将像任何其他技术一样发展。与 10 年前相比，今天的 HTML 是相同的语言，但我们使用它的方式和附加技术已经改变了很多。即使是 10 年前制作的高科技优质网站，按照今天的标准来看也会显得微弱。

因此，虽然 HTML 会保持“不变”（即遵循标准的自然演变），但网站背后的技术（php、.NET、JAVA 等）可能更可能发生变化。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-10-18T10:09:40.003

我来自未来，不，它还在这里。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T07:11:07.897

我不认为他们会*取代*.HTML 就像我认为没有任何东西取代了 .TXT。我相当肯定，随着时间的推移，这些新技术将得到更广泛的采用和使用。也许有人会想出一个重大突破，我们都会蜂拥使用这种新的酷炫的应用程序构建客户端交付技术。

但我敢打赌，不管是什么新东西，它仍然是嵌入在 html 页面中的浏览器

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T07:14:43.473

不，他们不会。

所有新技术都有望成为解决您生活中所有问题*并*为您冲泡咖啡的下一个技术，但很少有人这样做（我还没有找到任何可以同时做到这两者的技术：/）。

Silverlight 和 Flash 遭受魔窗综合症的困扰——它们只是浏览器中的一个多媒体盒子，与其他所有内容分开。当然，他们可以向外界调用 JavaScript，但那是他们对 JavaScript 和 (X)HTML 上瘾的时候。“雅虎的新框架”使用 JavaScript、CSS 和 HTML，所以这已经不在了。

我们将看到（并且已经看到）是各种框架和工具包以及可以帮助您完成各种繁琐任务的东西。但是，如果它们在浏览器中工作，它们都将在其堆栈的某个位置使用 (X)HTML、CSS 和 JavaScript。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T07:52:59.607

HTML5。我估计收养需要 5 年。

编辑：我的回答相当简短，但说真的，HTML 只是一种标记语言（不是编程！）。我们有很多经验。它为文档提供了一个简单的框架。

Edit2：哦，也许还有 XUL……如果 Mozilla 的市场份额上升的话。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T07:11:23.637

不会很快。正如您在标签中提到的那样，有许多补充技术。

如果有任何东西，HTML 将会有进化性的变化，而不是革命性的变化。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T07:58:32.370

此处插入当前技术会被任何新技术取代吗？

是的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T08:00:33.630

也许通过一些简洁的抽象，如[#haml](http://haml.hamptoncatlin.com/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T08:43:05.943

这里的问题是 HTML 非常适合描述文档，这是它的设计目的，而不是特别适合帮助布置复杂的界面/Web 应用程序，这似乎是很多人想要做的。这导致首字母缩略词和流行语相互重叠，所有这些都导致了一些不稳定的伪小部件系统；从根本上说，人们不断地在浏览器中重新发明窗口系统。

在某些时候，我认为，它必须给予——如果人们想要真正丰富的互联网应用程序，那么我们将不得不想出别的东西。像 Applet 一样的嵌入式插件，比如现在无处不在的 Flash，以及像 Silverlight 这样的新产品，在某种程度上试图提供这些插件，但它们也远非完美，所以我们开始抱怨并返回在 HTML 页面上破解邪恶的可憎之物。

HTML 可能是旧的，但它完全适合 Web 的原始目的。最终，如果人们希望网络变得与众不同，那么整个堆栈都必须反映这种变化。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-24T20:33:43.180

我认为 HTML/JS/CSS 是网络的未来。随着 HTML5 的出现以及它为规范带来的新功能，例如 >canvas<、>audio<、>video<，浏览器中确实不再需要单独的插件，如 flash 和 silverlight。当然，这种范式的巨大转变需要很多年才能发生……但我们只能希望。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-24T20:35:02.397

大约在没有计算机在任何地方运行 COBOL 代码的时候，HTML 将被完全替换。:-)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-24T20:40:49.120

最终，HTML 将被视为网络的集合。我们都知道 Ruby 或 Python 只是翻转 1 和 0，但我们不必那样想。但是，计算机仍在翻转 1 和 0。

我们可能会达到不再需要考虑 div 和文本的地步，但它可能会存在很长时间。:)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-24T07:19:30.107

HTML 越来越像 XML，而不是其他任何东西。我可能希望看到命名空间可能会被引入到 HTML 的未来修订/草案以及更接近/更复杂的 CSS 和 JavaScript 使用中。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-24T08:05:30.123

不幸的是，不会在不久的将来。充其量它们只会真正遵循 Flash/Java Applets/Siverlight 的路线，并且只是（大部分）嵌入在 html 中的黑盒子。

并不是说我对 html 本身有任何反对，我的大部分生活都在做网站和相关编程，因为 netscape 很大，所以我一直在与 html (+css + js +asp/php/cgi/aspnet/jsp...) 争吵，以及相关的浏览器兼容性问题。

多年来，Web 开发人员一直在与 html 的局限性作斗争，而客户对更像桌面的体验的期望越来越高，但这并没有让这变得更容易。

当然，我们有一些更高级的技术，比如 ajax 可以使用，并且浏览器的 js 引擎正在变得更好，但是 html 仍然显示出它作为相对静态发布媒体的根源的局限性。但它是主要的媒介，并且不会很快消失。

HTML 5 承诺会做出一些改进，但在我们看到任何重大变化之前至少几年，它一直处于书呆子战争的中心太久了。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-24T08:21:22.813

是的。在很长一段时间内。Html 便于演示，但也有其缺点，而且它只适用于它所使用的媒体（计算机屏幕）。未来将拥有完全不同的交互方式，Html 将无处不在。

你可以在 40 年前问，汽车会不会没有 4 个轮子、一个方向盘和一个内燃机？人们可能会笑，但现在我们在拐角处有非常不同的汽车。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-24T20:42:07.917

没有什么可以取代 HTML 的概念，尽管它的各种形式最终可能会过期。原因很简单：投资。有多少程序员在 HTML 的解析和渲染上投入了数千小时？我不知道！HTML 已经存在很长时间了，作为一种网络标准/技术，几乎没有被取代的希望。唯一可能的替换是二进制替换，因为这种格式会减小大小。但这可能是专有的或其他东西，如果是这样，它也无法取代 HTML。

HTML 将比 COBOL 和 Ada 至少活一百年。

# java - Java int...数组表示法

> ID：580743
> 
> 赞同：12
> 
> 时间：2009-02-24T07:05:24.557
> 
> 标签：java, arrays

我以前在方法参数中看到过这一点，它似乎允许在运行时创建的数组中填充任意数量的参数。此语言功能的正式名称是什么？谢谢！

```
 public static void trace(View view, RecyclerTraceType type, int... parameters) {

    RecyclerTrace trace = new RecyclerTrace();
    trace.position = parameters[0];
    trace.indexOnScreen = parameters[1];
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-24T07:06:59.390

您将看到 Java 1.5[可变参数](http://java.sun.com/j2se/1.5.0/docs/guide/language/varargs.html)功能。在引擎盖下，它只是一个带有语法糖的数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T07:07:46.673

[可变函数](http://en.wikipedia.org/wiki/Variadic_function#Variadic_functions_in_C.23.2C_VB.net.2C_and_Java)

# javascript - 多级 UL 的水平手风琴

> ID：580773
> 
> 赞同：0
> 
> 时间：2009-02-24T07:18:12.047
> 
> 标签：javascript, jquery

我一直在 google 上查看过多的水平手风琴脚本。

例如： [http ://www.leigeber.com/2008/05/horizo​​ntal-javascript-accordion-menu/](http://www.leigeber.com/2008/05/horizontal-javascript-accordion-menu/) [http://www.nyokiglitter.com/tutorials/horizo](http://www.nyokiglitter.com/tutorials/horizontal.html) [​​ntal.html http://designreviver.com/tutorials/ jquery-examples-horizo​​ntal-accordion/](http://designreviver.com/tutorials/jquery-examples-horizontal-accordion/)

所有脚本似乎都是为了在静态宽度的 div/元素中显示内容。

我正在尝试制作一个相当直接的导航菜单。当顶层 UL 中的元素被点击时，底层 UL 会“滑出”，如果关闭后再次点击。我想我必须“动态地”计算宽度......不知道如何进行。

一个例子是这样的：

```
 <style type="text/css">
<!--
ul.menu, ul.menu ul{ 
    list-style: none;
    display: inline;
    }
ul.menu li, ul.menu ul li {
    display: inline;
}

a, a:link, a:hover, a:visited, a:active {
    color: black;
    text-decoration: none;
}
-->
</style>

<ul class="menu">
    <li>
        <a href="#">Top-level 1</a>
    </li>
    <li>
        <a href="#">Top-level 2</a>
        <ul>
            <li><a href="#">Bottom Level A1</a></li>
            <li><a href="#">Bottom Level A2</a></li>
            <li><a href="#">Bottom Level A3</a></li>
            <li><a href="#">Bottom Level A4</a></li>
        </ul>
    </li>
    <li>
        <a href="#">Top-level 3</a>
        <ul>
            <li><a href="#">Bottom Level B1</a></li>
            <li><a href="#">Bottom Level B2</a></li>
        </ul>
    </li>
    <li>
        <a href="#">Top-level 4</a>
    </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T18:41:48.143

我会这样做：

```
var $current = null;

$(document).ready(function(){
   $("ul li ul").hide(); // hide submenus by default on load

   $("ul li a").click(function(){
      var $sub = $(this).find("ul"); // could also use $(this).next();

      if ($sub.css("display") == "none")
      {
         if ($current != null)
            $current.slideUp(); // if you want to only show one sub at a time
         $sub.slideDown();
         $current = $sub;
      }
      else
      {
         $sub.slideUp();
         $current = null;
      }
   });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-10T14:30:42.140

我`$(this).outerWidth()`用来计算应该移动多远`$sub`，但它似乎不适用于这个例子。不太有帮助，但它可能会为您指明正确的方向。（另外，你现在希望已经解决了这个问题）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:52:27.600

例如：

```
 var $current = null;
$(document).ready(function(){
   $("ul li ul").hide(); // hide submenus by default on load

   $("ul li a").click(function(){
      var $sub = $(this).next(); 
      if ($sub.css("display") == "none")
      {
         if ($current != null)
            $current.animate({ width: 'hide' }); // if you want to only show one sub at a time
         $sub.animate({ width: 'show' }); 
         $current = $sub;
      }
      else
      {
         $sub.animate({ width: 'hide' });
         $current = null;
      }
   });
}); 
```

我认为这会起作用，但它似乎只是向上滑动的一种变体，它并不能真正用作“slideRight”“slideLeft”功能。也许它的CSS？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T19:35:00.060

“而不是 slideUp/slideDown 你会想要使用 animate()”

我想这就是我被挂断的地方......我不确定如何即时计算底层 UL 的宽度（如果这甚至是必要的）

# math - 从字节中获取布尔值，反之亦然

> ID：580775
> 
> 赞同：0
> 
> 时间：2009-02-24T07:18:57.287
> 
> 标签：math, casting, binary, types

简单的问题：

我如何判断字节中的哪些位设置为 0，哪些设置为 1

例如：

```
//That code would obviously wont work, but how do i make something similar that would work?
byte myByte = 0X32;

foreach(bool bit in myByte)
{
  Console.WriteLine(bit);
}

//Part 2 revert
bool[] bits = new bool[8];
bits[0] = 0
bits[1] = 0
bits[2] = 0
bits[3] = 0
bits[4] = 0
bits[5] = 1
bits[6] = 0
bits[7] = 0

byte newByte = (byte)bits; 
```

整个互联网充满了例子，但我就是想不通

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T07:24:01.143

你想使用位操作

```
k = bits = 0;
for (i = 1; i < 256; i <<= 1)
  bool[k++] = (bits & i) != 0;

k = bits = 0;
for (i = 1; i < 256; i <<= 1)
  if (bool[k++]) bits |= i; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T07:23:25.107

`BitArray`class 将是可能的最简单（尽管不一定是最快）的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T07:22:10.553

你可以和他们。如果在两个数字中都设置了 1 位，它将保持设置状态。我不确定那个样本到底是什么，但是用 1 加一点会给你一个真（1）或假（0）。

0010 & 1010 = 0010

# outlook - 从 Outlook2007 使用 Redemption.dll 获取 Exchange 文件夹大小失败

> ID：580780
> 
> 赞同：2
> 
> 时间：2009-02-24T07:20:35.643
> 
> 标签：outlook, outlook-2007, outlook-addin, outlook-2003, outlook-redemption

我在需要检索交换邮箱大小的 Outook (2003/2007) 加载项中使用 Redemption.dll（版本 4.7.0.1026-最新）。要获取文件夹大小，我使用函数 get_Fields()：

```
foreach (RDOStore store in rdoSession.Stores)
{
  int size = 0;
  if (store.StoreKind == TxStoreKind.skPrimaryExchangeMailbox)
  {
    // ****
    size = (int)store.get_Fields("http://schemas.microsoft.com/mapi/proptag/0x0E080003");
    mailBoxSize += size;
  }
} 
```

此函数在从 Outlook 2003 加载项调用时返回文件夹大小，但如果我从 Outlook 2007 加载项调用相同的函数，则返回空对象。Redemption.dll 是否完全不支持 Outlook 2007 或者它是不同的 API 调用？如果有人有相关信息，请告诉我。

# php - 如何从当前页面打印另一页？

> ID：580781
> 
> 赞同：4
> 
> 时间：2009-02-24T07:20:52.117
> 
> 标签：php, css, ajax

我需要打印与当前页面不同的页面，即更准确地描述我的问题..我需要将打印按钮放在一页但需要打印不同的页面，还需要向第二页发送一个值这是要打印的。如果有人可以帮助我将非常感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T07:23:09.927

让链接转到您需要打印的页面，其中包含查询字符串中的一些信息。然后将 javascript 放在[指示页面打印](http://www.htmlgoodies.com/beyond/javascript/article.php/3471121)的正文的 onLoad 事件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T07:32:06.567

只需将要打印的页面放入一个不可见的 iframe 中：

```
<iframe src="to_print.html" name="frame1"></iframe>
<input type="button" onclick="frames['frame1'].print()" value="print!"> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T07:31:55.087

您可以将要打印的页面加载到（可能是隐藏的）iframe 中，然后在该框架上调用 window.print 函数。使用 jquery 会是这样的（未测试）：

```
$('#printButton').click(function(evt) {
    evt.preventDefault();
    $('body').append('<iframe src="document_to_be_printed.php?param=value" id="printIFrame" name="printIFrame"></iframe>');
    $('#printIFrame').bind('load', 
        function() { 
            window.frames['printIFrame'].focus(); 
            window.frames['printIFrame'].print(); 
        }
    );
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T07:25:44.803

在我的脑海中，我可以执行以下操作：

1.  获取打印按钮以将带有详细信息的 POST/GET 发送到您要打印的页面。
2.  将这些详细信息加载到页面上。
3.  加载要打印的页面后，让 JavaScript 触发打印事件。
4.  将用户送回原始页面。

# c - pthread退出时如何防止进程退出？

> ID：580790
> 
> 赞同：2
> 
> 时间：2009-02-24T07:24:12.140
> 
> 标签：c, linux, multithreading, sockets, pthreads

我正在用 C 编写一个服务器程序，其中每次客户端连接时，我都会创建一个新的 pthread 来处理客户端的请求。

但是，当所有线程都退出时，我的程序就会退出，就好像调用了 exit() 一样。这是一个问题——我该如何克服它？

假设服务器正在运行，并且有 2 个客户端连接。一旦这些客户端断开连接——因此两个线程都退出了——那么我的服务器进程就会退出。我想要的是让我的服务器保持接受（）套接字请求。通常这在我使用 fork() 和 accept() 时有效。我做错了什么导致父进程终止而不是无限循环？

代码看起来基本上是这样的：

```
void *talker( void *d ) {
   int fd;
   char buf[] = "Hello client";

   fd = (int)d;

   while( 1 ) {
      write( fd, buf, strlen( buf )+1 );
      sleep(4);
   }
}

int main( int argc, char *argv[] ) { 

   pthread_t thread[50];

   int sockfd;
   struct sockaddr_in client_addr;
   int i = 0;
   int s1;

   /* ... other declarations */

  if (initialize_server_socket(portno, &sockfd) < 0) {
     fprintf(stderr, "Could not initialize socket\n");
     exit(-1);
  }   

  while( 1 ) { 
     s1 = accept( sockfd, (struct sockaddr *)&client_addr, &n );
     pthread_create( &(thread[i++]), NULL, talker, (void *)s1 );
  }   

  return(0);
} 
```

另外：这是我已经问过的问题的同一个项目（链接如下）......虽然在花费太多时间尝试使用 select() 和 IPC 失败后，我想我会给线程一个旋转，因为它的简单性共享地址空间。

[在 C 中使用管道进行父子 IPC 会导致程序阻塞](https://stackoverflow.com/questions/575602/using-pipes-in-c-for-parent-child-ipc-makes-program-block)

此外，大部分代码取自这里：[http ://www.s5h.net/2006/06/27/pthread-socket-server-in-c/](http://www.s5h.net/2006/06/27/pthread-socket-server-in-c/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T07:41:44.203

如果你在 gdb 中调试它，你会看到你得到了一个 SIGPIPE，你的程序没有处理它。您可以安装 SIGPIPE 处理程序或忽略 SIGPIPE。

原因是您的线程正在写入已（由客户端）关闭的套接字（管道），这会引发 SIGPIPE。`write()`您应该检查忽略 SIGPIPE 后的返回值：

```
signal(SIGPIPE, SIG_IGN); 
```

或处理 SIGPIPE。它与 2 个客户端连接无关，如果您在客户端断开连接后等待 4 秒，您将获得一个 SIGPIPE（在您的情况下）。

# iphone - 使用 Cocos2d 在我的 iPhone 应用程序中使用多个声音

> ID：580796
> 
> 赞同：0
> 
> 时间：2009-02-24T07:30:49.037
> 
> 标签：iphone, cocos2d-iphone

```
avc = [[MPAVController sharedInstance] avController];
//avc is AVController
NSString *path = [[NSBundle mainBundle] pathForResource:@"Sound" ofType:@"wav"];
id feeder = [[MPArrayQueueFeeder alloc] initWithPaths:[NSArray arrayWithObject:path]];
        [avc setQueueFeeder:feeder];
        [avc play:nil];

        [feeder release];
NSTimer *sound = [NSTimer scheduledTimerWithTimeInterval:(9.0) target:self selector:@selector(Gamesoundplay) userInfo:nil repeats:YES]; 
```

听说我使用拖曳框架来播放声音。1.MediaPlayer.framework 2.AudioToolbox.framework

加载游戏后，我成功地重复播放背景声音。我还想在单击某些按钮操作后播放声音而不停止以前的背景声音。但是当我单击另一个按钮时，时间背景声音停止并在我提到重复声音时间线的时间间隔（9.0 秒）后重新开始。

如果有人做这项工作，那么请帮助我完成我的申请。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-01T12:15:40.023

开源游戏引擎 Cocos2d iPhone 有一个名为“Cocos Denshion”的库，它封装了在 iPhone 上播放背景声音和效果声音。

在此处获取 cocos（其中包含 Denishon）：

[http://www.cocos2d-iphone.org/download](http://www.cocos2d-iphone.org/download)

并在此处查看如何使用 Cocos Denishon：

[http://www.cocos2d-iphone.org/wiki/doku.php/cocosdenshion:cookbook](http://www.cocos2d-iphone.org/wiki/doku.php/cocosdenshion:cookbook)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T02:11:03.007

我强烈建议您查看 Crash Landing 示例中的 SoundEngine.cpp。它是一个完整的声音引擎，支持背景声音，以及全部使用 OpenAL 的多种音效。它有一些内存泄漏，如果不进行一些调整，它不会为 GCC 4.2 编译，但您应该能够在几个小时内修复它们。

# asp.net - ASP.Net 动态数据站点中的 XML 数据

> ID：580798
> 
> 赞同：0
> 
> 时间：2009-02-24T07:31:05.087
> 
> 标签：asp.net, xml, dynamic-data

我有这个问题，我无法让我的动态数据 Web 应用程序将 xml 数据保存到文本字段中。也许这是一个常见问题，但搜索网络并没有给我任何答案......

因此，这是重新创建我的问题的步骤：

*   我有一个带有“ntext”类型列的表的数据库（Sql Server 2005）。
*   我创建了一个新的动态数据实体 Web 应用程序，在此我创建了一个 ADO 实体数据模型并添加了带有 ntext 列的表。
*   我设置了 global.ascx 文件并启动了 Web 应用程序。
*   当网络应用程序打开时，我导航到表格并插入一个新项目
*   在生成并代表 ntext 列的文本框中，我插入一些 xml（从记事本进行简单剪切和粘贴）并点击插入/保存按钮。
*   插入失败并出现错误：

    Microsoft JScript 运行时错误：Sys.WebForms.PageRequestManagerServerErrorException：处理服务器上的请求时发生未知错误。服务器返回的状态码是：500

尝试的 xml 示例

```
<?xml version="1.0" encoding="utf-8"?>
<root>
<item></item>
</root> 
```

输入一串字符，例如“hello world”就可以了！

谁能帮忙告诉我哪里出错了？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T10:19:05.543

就像旁注一样。

IMO，应尽可能避免为所有页面设置 validateRequest="false"。每当您遇到必须禁用它的情况时，请将其设置在页面级别（ <%@ Page ValidateRequest="false" ..%>.

此外，在您执行此操作的页面上，请**确保您正在验证 input**，因此不会传递任何有害内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T07:37:14.700

这可能是因为它看到了您在潜在危险请求中添加的内容。我假设您在页面指令中有 ValidateRequest="true" 。它是否正确？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T09:45:50.177

我可以说 REA_ANDREW 你是个天才！我在 web.config 更新了它，它现在可以工作了：

```
<pages validateRequest="false"> 
```

# c# - 如何在 linq to sql 的表达式树中包含仅评估一次的 InvocationExpression？

> ID：580799
> 
> 赞同：2
> 
> 时间：2009-02-24T07:31:44.853
> 
> 标签：c#, linq-to-sql, lambda, expression-trees

我正在尝试手动组合表达式树以实现某种程度的模块化，这似乎暗示我使用标准的 linq 运算符。该代码本质上创建了一个表达式树，它使用一个表达式来决定调用另外两个表达式中的哪一个。其他表达式之一需要一个额外的参数，该参数本身是使用另一个表达式获得的。此参数用于获取多个值，但对于每次访问，检索参数的表达式都会重复。我已经包含了代码和输出以更好地解释：

```
public void Test() {
    var parameters = ProjectionOne.Parameters;
    Expression<Func<Foo, bool>> isType = f => f.TypeId == 1;
    Expression<Func<Foo, Satellite>> satSelector = f => f.Satellites.Single();
    var satelliteSelector = Expression.Invoke(satSelector, parameters[0]);
    var test = Expression.Lambda<Func<Foo, Bar>>(
        Expression.Condition(
            Expression.Invoke(isType, parameters[0]),
            Expression.Invoke(ProjectionOne, parameters[0]),
            Expression.Invoke(ProjectionTwo, parameters[0], satelliteSelector)), parameters);
}

public Expression<Func<Foo, Bar>> ProjectionOne {
    get {
        return foo => new Bar() {
            Id = foo.Id
        };
    }
}

public Expression<Func<Foo, Satellite, Bar>> ProjectionTwo {
    get {
        return (foo, sat) => new Bar() {
            Id = foo.Id,
            Start = sat.Start,
            End = sat.End
        };
    }
} 
```

当我在数据库上运行此查询时，生成的 SQL 如下：

```
SELECT [t0].[value], [t0].[value2] AS [Start], [t0].[value3] AS [End], [t0].[Id] AS [Id]
FROM (
    SELECT 
        (CASE 
            WHEN [t0].[TypeId] = @p0 THEN 1
            WHEN NOT ([t0].[TypeId] = @p0) THEN 0
            ELSE NULL
         END) AS [value], (
        SELECT [t2].[Start]
        FROM [dbo].[Satellite] AS [t2]
        WHERE [t2].[Id] = [t0].[Id]
        ) AS [value2], (
        SELECT [t2].[End]
        FROM [dbo].[Satellite] AS [t2]
        WHERE [t2].[Id] = [t0].[Id]
        ) AS [value3], [t0].[Id]
    FROM [dbo].[Foo] ) AS [t0] 
```

问题是重复的子选择。一个检索“开始”值，而另一个检索“结束”值。如果它们都从单个子选择中检索出来会更好。如何更改表达式树的构造以强制执行此操作？此外，我确实了解执行此查询有更简单的方法，但是它是此处未显示的更大框架的一部分，只能通过能够从大量可重用表达式中手动组装表达式树来实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T08:42:04.590

我怀疑您已经做了所有可以做的事情（因为您已经在使用投影，引擎*选择*将其表示为单独的子选择）。

我能想到的唯一其他事情是（例如）使用表值 UDF（通过数据上下文）来获取开始/结束 - 看看它是否将其展平到查询中。

您是否对查询进行了概要分析并与您的首选布局进行了比较？配置文件很*可能*是相同的（即 TSQL 优化器已经处理了它）。在这种情况下，不必过分担心。

# flash - 如何在 Flash 播放器或非可编辑格式中显示 doc、rtf 或 pdf

> ID：580807
> 
> 赞同：2
> 
> 时间：2009-02-24T07:38:04.353
> 
> 标签：flash, pdf, rtf

我需要在我的 web 应用程序文档中显示 pdf 或 rtf 格式的某种不可更改且无法下载的不可食用格式，完美的候选者是 flash 播放器，但我知道转换 pdf 或rdf to swf 不是免费的。我正在寻找免费的解决方案，不一定是 Flash。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T08:49:18.910

使用[pdf2swf](http://www.swftools.org/)和一般的 SWF 工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T07:51:35.663

只需使用[Flashpaper](http://www.adobe.com/products/flashpaper/)，它可以将各种格式转换为不可编辑的 Flash。它安装了打印机，因此要转换 Word 文档，您只需转到 Word 并使用 Flash Paper 打印机打印文档。它打印一个不可编辑的 swf 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T10:14:27.477

您可以简单地使用[翻页软件](http://www.pageturnpro.com/)在不可编辑的[数字出版物](http://www.pageturnpro.com/)中打印您的出版物。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-14T04:57:02.813

您还可以将 flexpaper 与 pdf2swf 一起使用，它是一个开源查看器[http://www.devaldi.com/?p=350](http://www.devaldi.com/?p=350)

# c# - 发布时混淆源代码 (C#)

> ID：580817
> 
> 赞同：4
> 
> 时间：2009-02-24T07:43:56.290
> 
> 标签：c#, obfuscation, publish, ddl

我们正在开发许多正在向我们的客户发布的产品。但是，如果您发布 C# 应用程序，则所有 dll 都可以使用反射器或某种方式进行反编译。

我想知道是否有一种简单的方法可以在发布时加密我们的 dll。这样我们就可以发布我们的dll，而不必担心我们的客户反编译我们的代码。

ps：如果可以将它集成到视觉工作室中，那就太棒了。

编辑：对双重帖子感到抱歉，我不知道它被称为“混淆”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T07:53:04.893

[Dotfuscator Community Edition](http://www.preemptive.com/dotfuscator-product-family.html)与 Visual Studio Professional 或更高版本一起安装。然而，社区版是一个爱好者或介绍性版本，它只允许您通过简单地重命名所有成员来在一定程度上混淆代码，它没有集成在 VS 中，并且不允许诸如字符串加密之类的强大功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T07:45:28.330

有很多混淆器。[我对smartassembly](http://www.smartassembly.com/)非常有信心

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T07:50:17.787

加密 .NET 程序集的过程称为[混淆](http://en.wikipedia.org/wiki/Obfuscated_code)，执行此操作的工具自然就称为混淆器。Visual Studio (Dotfuscator Community Edition) 自带一个，但据说是有限制的。

不要选择[XHEO](http://ayende.com/Blog/archive/2009/02/02/open-letter-to-xheo-that-is-not-a-good-way.aspx)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-08T17:41:45.553

另一个是[smartassembly](http://www.smartassembly.com/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T07:50:33.247

[http://en.wikipedia.org/wiki/Dotfuscator](http://en.wikipedia.org/wiki/Dotfuscator)

您已经在工具菜单下的 VisualStudio 中拥有社区版

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-11T06:23:52.830

这适用于通过搜索和寻找替代品登陆这里的用户。

如果您正在寻找具有更好支持的开源，请尝试：[ConfuserEx](http://yck1509.github.io/ConfuserEx/)。它是 Confuser 项目的继承者。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-28T22:53:25.550

使用[ConfuserEx 混淆器](https://yck1509.github.io/ConfuserEx/)

de4dot可以对混淆的dll进行反混淆，一些黑客可以反编译你的代码并且可以看得很清楚......

它可以对被这些应用程序混淆的 app/dll 进行反混淆：

*   Agile.NET（又名 CliSecure）
*   通天网
*   代码堡
*   密码面纱
*   代码墙
*   加密混淆器
*   DeepSea 混淆器
*   **点熔器**
*   .NET 反应堆
*   Eazfuscator.NET
*   歌利亚网
*   IL保护器
*   迈拓码
*   压力机
*   临检
*   滑板网
*   智能装配
*   香料网
*   异码

所以我重新推荐你使用[ConfuserEx Obfuscator](https://yck1509.github.io/ConfuserEx/)。它具有良好的功能，并且是 .NET 应用程序的开源保护器。

# windows - Vista 如何为与我的应用程序关联的文档生成图标？

> ID：580827
> 
> 赞同：5
> 
> 时间：2009-02-24T07:48:40.537
> 
> 标签：windows, winforms, windows-vista, icons, embedded-resource

我可以影响进程吗？
我有一个内置于 .NET 3.5 / VS2008 的应用程序。我使用 win32 .res 文件将多个图标嵌入到应用程序中。这是在 VS2008 中项目的“属性”框中完成的——不是指定 .ico 文件，而是勾选该框以指定 .res 文件。在 .res 文件中，您可以有多个图标。请参阅[此处](http://www.codeproject.com/KB/dotnet/embedmultipleiconsdotnet.aspx)了解我的意思。

每个图标包括一个 256x256xRGB（PNG Cmopressed）“Vista 级”图像、一个 256x256x32 位图像，以及各种颜色组合的 48x48、32x32 和 16x16 图像的通常级联。如果我在资源管理器中查看生成的 exe，我会看到漂亮的 256x256 Vista 大图像。

然后我可以将文件扩展名关联到我的应用程序，使用右键单击 >“打开方式...”> 在 Vista 的资源管理器中设置默认程序点击流。但是显示在文档旁边的图标是应用程序图标的一个小版本，覆盖在一张看起来像折叠角的白纸之上。

结果是，当原始图像以“小图标”版本显示时，原始图像很小，无法看到。看起来很可怕。

我知道可以完全省略折叠的纸，或者至少在上面覆盖更大的图像。例如，C# 文件的图标有一张折叠的纸，但 C# 标志很大且可见。我怎样才能得到这个？安装 WinZip 12 时 .zip 文件的图标大且可见，并且没有折叠的纸张。

文档图标与应用程序图标不同吗？在我的应用程序中，我必须做些什么来注册一个图标，Vista 将用于与我的应用程序关联的文档吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-24T08:20:24.470

文件扩展名的图标和文件关联在注册表中列出。更具体地说，`HKEY_CLASSES_ROOT\.ext`条目包含内容类型、感知类型，并且在`(Default)`值中是实际关联。例如，.cs 文件的默认值为`VisualStudio.cs.9.0`（我有 VS 2008）。您可以检查`HKEY_CLASSES_ROOT\VisualStudio.cs.9.0`以查看与此文件类型相关的实际图标、程序和命令。特别`HKEY_CLASSES_ROOT\VisualStudio.cs.9.0\DefaultIcon`是，告诉资源管理器为这种类型的文件显示哪个图标的条目。它指向一个二进制文件和该二进制文件中的资源 ID。

当您通过右键单击 -> 打开方式将文件类型与程序相关联时，您没有指定默认图标，因此资源管理器获取您的应用程序图标并将其覆盖在通用文档图标上。

正确的方法是在您的设置中包含适当的注册表项，以将文件类型与您的应用程序和图标相关联。您需要包含的确切注册表值取决于您要添加到该文件类型的上下文菜单中的命令，但至少您需要打开命令。对于 .cs 文件，您可以看到有一个条目`HKEY_CLASSES_ROOT\VisualStudio.cs.9.0\Shell\Commands\Open`，其`(Default)`值包含调用 Open 命令时要启动的应用程序。（您现在可以忽略该`ddeexec`部分）

请记住，`HKEY_CLASSES_ROOT`是两个注册表分支的映射视图：`HKEY_CURRENT_USER\Software\Classes`和`HKEY_LOCAL_MACHINE\Software\Classes`. 如果您希望文件关联适用于所有用户，则需要写入`HKEY_LOCAL_MACHINE`. 您的设置需要以管理员身份运行才能执行此操作。否则，尝试写入将失败并拒绝访问，或者只为当前用户`HKEY_CLASSES_ROOT`写入并进行关联。`HKEY_CURRENT_USER`（这两个究竟会发生哪一个取决于几件事，比如操作系统是什么，用户是否是管理员但没有提升等等）

您可以在 MSDN 上的[自定义文件类型（文件关联）](http://msdn.microsoft.com/en-us/library/dd378475(VS.85).aspx)部分阅读所有这些内容。特别是，[文件类型](http://msdn.microsoft.com/en-us/library/cc144148(VS.85).aspx)和[向客户端程序注册程序](http://msdn.microsoft.com/en-us/library/cc144109(VS.85).aspx)将为您提供有关如何准确执行此操作的基础知识。

# unit-testing - 在调试或添加新功能时，管理旧单元测试的最佳实践是什么？

> ID：580833
> 
> 赞同：1
> 
> 时间：2009-02-24T07:50:40.610
> 
> 标签：unit-testing, tdd, legacy

我试图了解管理由于代码中的错误或逻辑更改等原因而不再匹配或不再有效的旧单元测试的最佳方法是什么？我们是否只是跳过它们并修改它们以适应当前逻辑？

例如，如果这些测试不是由您编写的，而现在您负责修改代码。在继续之前，您是否仍然花时间更新这些测试以使其通过？

或者只是跳过它们？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T07:54:23.097

过时的单元测试毫无用处。如果您希望它们有用，请更新它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T08:01:52.457

当然，您应该花时间让它们通过。为什么要扔掉这项工作？

TDD 的整个想法是让所有测试始终通过。从你开始说“嘿，这个单元测试失败没关系”的那一刻起，TDD 就毫无用处。它需要一些纪律，是的，但最终还是值得的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T15:35:14.830

当测试失败时，有三个选项：

1.  生产代码已损坏，需要修复。
2.  测试已损坏（或未与生产代码的最新更改保持同步），需要修复测试。
3.  不再需要测试指定的行为，并且可以删除测试。

在编写任何新代码之前，必须通过所有测试。当测试失败时，您必须立即修复它们，或者恢复您的更改。否则你无法确定测试失败是因为你一分钟前所做的更改，还是只是虚惊一场。

忽略失败的测试是通往黑暗面的道路。如果你忽略它们的时间足够长，测试服将会随着更多的测试失败而腐烂，它会失去它的价值，你需要把测试扔掉。然后当你不能再依赖测试套件时，你会犹豫改进生产代码的设计，生产代码也会开始腐烂。最后，不再可能维护生产代码，您还需要将其丢弃并重写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T08:02:53.530

> 例如，如果这些测试不是由您编写的，而现在您负责修改代码。在继续之前，您是否仍然花时间更新这些测试以使其通过？

我会更新测试。

但首先我会追捕破坏它们的开发人员，然后......[这里有一些灵感](http://www.youtube.com/watch?v=JIASiZQR3nI)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T08:11:27.190

每次我遇到类似的情况时，都会如此着急，以至于我认为过时的测试不存在。因此，我将代码视为[遗留代码](http://en.wikipedia.org/wiki/Legacy_code#Modern_interpretations)，我只为我正在处理的功能编写新测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T08:58:24.613

那里有两种可能的情况：

1.  少量测试失败 - 修复测试
2.  大多数测试都失败了，你需要更多的时间来修复所有测试然后实施更改——放弃整个测试项目并编写新的测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T15:15:59.167

考试不及格是绝对不能接受的。你的系统应该拒绝任何没有通过每个测试的机会，或者至少一个失败的测试应该触发开发人员的优先工作任务，导致测试失败。

随着时间的推移，测试确实会变得过时，特别是对于成熟的产品。它们充其量只是为了简单地练习代码。有时它们会失败，但通常与最初编写它们的原因无关。您必须自行判断是否丢弃过时的测试。如果我们不偶尔砍掉那些测试需要很长时间才能完成的枯木，我们就有 10,000 次测试。

测试覆盖率工具可以帮助您确定任何特定测试是否值得保留。

# c++ - C ++中类的构造函数中的不同参数

> ID：580842
> 
> 赞同：1
> 
> 时间：2009-02-24T07:54:19.383
> 
> 标签：c++, constructor

如果参数的类型不同，我可以让构造函数以不同的方式工作吗？即整数或浮点数。

假设我这样做了，new Object(3) 构造函数在每个索引处用 3 填充数组

假设如果我这样做了，new Object(3.5) 构造函数会为每个索引填充一个 index+3.5 的数组

假设如果我这样做了，new Object() 构造函数会在每个索引处用 0.0 填充一个数组

有没有办法只用一个构造函数来实现这一点？还是我需要三个不同的构造函数？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T07:59:31.213

当然你可以有很多构造函数！构造函数的重载与任何函数/成员的重载相同。

请记住，有时编译器可以通过自动转换参数来隐式调用您不希望被调用的构造函数。

您可以在构造函数声明中添加关键字[显式](http://www.glenmccl.com/tip_023.htm)以禁止任何自动转换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T07:58:55.660

你可以用一个构造函数来做，但它会很丑陋。提供了 3 个构造函数方法，因为它分离了用法并简化了代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T08:50:39.937

听起来您正在经历一场维护噩梦。我建议你改用命名构造函数：

```
class Object
{
public:
    // Sets all elements to 0.
    Object();

    // Sets all elements to value.
    static Object Fill(double value);

    // Sets all elements to the previous + delta, beginning at start.
    static Object Accumulate(double start, double delta);
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T07:58:50.903

如果您只关心内置类型，则可以利用类型提升和默认值：

```
struct Object
{
    Object(double value = 0.0)
    {
        // do that thing you do
    }
}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T08:00:46.890

只要传递的参数始终属于同一类型，您就可以使用一个构造函数，否则您需要多个。

似乎最明显的解决方案是在对象构造函数中插入 switch 语句。

例子：

```
public Object(int num)
{
switch (num)
{
case 1: array[i]  = num;
break
case 2: array[i] = num * 2;
}

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T08:28:04.810

完全基于参数类型的构造函数具有如此不同的行为通常是一个坏主意，尤其是对于易于在彼此之间隐式转换的内置类型。

话虽如此，纯粹作为一种编程练习，可以使用一个构造函数来执行此操作，但是您必须使用代理类来隐式转换要区分的类型才能实现您想要的。作为预装解决方案， boost::variant 将满足要求。您可能认为这不能满足单个构造函数的要求，因为它依赖于第二个类的多个构造函数（或构造函数模板）。

```
class Object
{
public:
        Object( const boost::variant< int, double >& val = 0 )
        {
                switch( val.which() )
                {
                case 0:
                        // TODO: Fill array with val
                        break;
                case 1:
                        // TODO: fill array with val + index
                        break;
                }
        }

// TODO: Add array member
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T07:57:26.477

您需要 3 个不同的构造函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T07:58:00.390

需要多个构造函数，每个不同的参数类型一个。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T07:58:50.887

您将需要三个不同的构造函数（重载它们）或一个具有一些具有默认值的属性。

这是可以实现的，但是我建议使用 3 个不同的构造函数以使代码清晰等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T07:59:32.663

不仅你需要三个不同的构造函数，你还需要三个不同的构造函数。它将使代码更简洁，更易于理解、维护和单元测试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-24T08:01:38.150

您可以考虑行为`Object()`，`Object(3)`因为它们做同样的事情。只需像这样编写您的构造函数：

```
class Object {
    // fills an array with n at every index
    Object(int n = 0) { ... }
}; 
```

问题是必须将带有浮点数的构造函数（示例**中**为 3.5）分开，如下所示：

```
class Object {
    // fills an array with n at every index
    Object(int n = 0) { ... } // handles Object() AND Object(3)

    // fills an array with index + n at every index
    Object(float n)   { ... } // handles Object(3.5)
}; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-24T08:39:35.360

使用 3 个不同的构造函数，因为逻辑根据参数的类型而有所不同。另外，请注意编译器所做的类型提升。否则在执行代码时您可能会遇到意外。

# exchange-server - Microsoft CRM Exchange Router

> ID：580846
> 
> 赞同：1
> 
> 时间：2009-02-24T07:56:16.917
> 
> 标签：exchange-server, dynamics-crm

Can someone help me out by explaining to me at a high level the use for the MS CRM Exchange Router over/with the Outlook Client?

I'm reading all this reference-style docs, but I just can't grok it.

Anyone?

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T09:55:50.903

You can use both but don't HAVE to use either.

The Router basically, at the highest level, routes email to the CRM server.

This means that the CRM server can display email in a user workspace, track campaign activity and report on it, and also it means that you can use incoming emails as triggers for Workflow.

The outlook client replicates the web interface inside outlook. Which some people prefer. It installs a local copy of SQL server and uses this to synchronise the CRM database (or portions) so that the user can use the Outlook client off-line.

You are also able to do some useful things from Outlook such as promoting any Outlook into the CRM, attaching it to an account or other entity in the process.

# msmq - TIBCO Rendezvous 和 MSMQ

> ID：580858
> 
> 赞同：8
> 
> 时间：2009-02-24T07:59:38.483
> 
> 标签：msmq, tibco, tibco-rv

我想知道 TIBCO Rendezvous 和 MSMQ 之间的区别。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T08:35:48.677

这不是非常结构化，但这里有一些差异，还有更多。我的 Tibco 知识比 MSMQ 多得多，因此请以更大的怀疑态度对待我对 MSMQ 的陈述。

您为 Tibco 支付的费用要高得多，具体金额会因站点许可和协商而有所不同，但对于具有 DR 备份的沼泽标准 rv 守护程序，您可能需要 10-20,000 美元）

Tibco RV 具有不同语言（C、C++、.Net、Java）的多个客户端实现，并支持多个平台（windows、各种 unix 风格）。客户端 api 完全与平台无关（除非需要此类知识以实现最大效率，大多数用户不需要处理此问题）。

RV 具有云、多播共享网络的概念，通过该网络，发送到云上的守护程序的消息将透明地提供给在云上其他任何地方注册到守护程序的任何客户端。

MSMQ 为基础产品中的后续交付提供消息持久性，TibRV 不提供（需要经过认证的消息传递 API，但随后提供了对用于此的日志的完全控制）

RV 可以使用路由守护程序通过 WAN 链接链接云（这些比普通守护程序昂贵得多）

RV 使用底层面向消息的平台以对客户端基本透明的方式在其自身之上分层附加服务。容错组、认证消息传递和路由守护程序使用通过保留主题传递的底层消息来执行此操作。

MSMQ 可以参与分布式事务，RV 不能。

Tibco 提供了一个 MSMQ 适配器（虽然我没有这方面的经验）

Tibco 消息可以具有复杂的内部结构（其中包含消息嵌套），MSMQ 消息要简单得多，结构通常由用户定义。

Tibco api 公开了底层套接字等待方面，允许您以有效的方式将调度循环与其他基于套接字的 api 集成。

Tibco 在金融领域拥有巨大的市场渗透力，从与他们的讨论来看，他们的许多客户似乎都是拥有站点许可证和专门的管理员团队的大型公司。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T10:48:16.813

MSMQ 还允许支持通过 PGM 协议发送消息（这是一种可靠的多播协议，部分由 Microsoft 和 Tibco 的代表设计）。原则上，这与将其发送到 ShuggyCoUk 所暗示的“云”中几乎相同，因为多个侦听 PGM 队列的客户端都应该收到从另一个客户端发送的消息，服务器的多播效率只需发送一次。

Tibco Rendezvous（如果仍然这样称呼的话）是：

*   昂贵的
*   坚如磐石
*   高效的
*   跨平台
*   跨语言

我从来没有使用过 MSMQ，而且我不知道那些这样做的子集是通过 PGM 这样做的。我的猜测可能并不多。它倾向于吸引可靠性胜过延迟人群（对于 Rendezvous 通常情况相反）和点对点而不是多播。

# java - 在linux中添加类路径

> ID：580860
> 
> 赞同：13
> 
> 时间：2009-02-24T08:00:10.883
> 
> 标签：java, linux, classpath

```
export CLASSPATH=.;../somejar.jar;../mysql-connector-java-5.1.6-bin.jar
java -Xmx500m folder.subfolder../dit1/some.xml
cd .. 
```

上面将类路径设置为linux中已经存在的类路径的语句是否正确

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-24T08:20:11.880

我不喜欢设置 CLASSPATH。CLASSPATH 是一个全局变量，因此它是邪恶的：

*   如果你在一个脚本中修改它，突然一些java程序会停止工作。
*   如果你把你运行的所有东西的库放在那里，它就会变得杂乱无章。
*   如果两个不同的应用程序使用同一库的不同版本，则会发生冲突。
*   由于 CLASSPATH 中的库不是共享的，因此没有性能提升 - 只是它们的名称是共享的。
*   如果您将点 (.) 或任何其他相对路径放在 CLASSPATH 中，这在每个地方都意味着不同的东西 - 这肯定会引起混乱。

因此，首选方法是为每次运行 jvm 设置类路径，例如：

```
java -Xmx500m -cp ".:../somejar.jar:../mysql-connector-java-5.1.6-bin.jar"    "folder.subfolder../dit1/some.xml 
```

如果它变得很长，标准过程是将其包装在 bash 或批处理脚本中以节省输入。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-24T08:09:25.963

除非您有充分的理由，否则始终建议不要破坏性地破坏现有的类路径。

以下行保留现有的类路径并添加到它上面。

```
export CLASSPATH="$CLASSPATH:foo.jar:../bar.jar" 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-12-01T09:19:40.420

在 Windows 和 Linux 中设置 Classpath 的重要区别是路径分隔符“;” Windows 中的（分号）和 Linux 中的“:”（冒号）。也`%PATH%`用于表示 Windows 中现有路径变量的值，而`${PATH}`在 Linux 中用于相同目的（在 bash shell 中）。这是在 Linux 中设置类路径的方法：

```
export CLASSPATH=${CLASSPATH}:/new/path 
```

但因此 Classpath 非常棘手，您可能想知道为什么即使设置了正确的 Classpath，您的程序也无法运行。注意事项：

1.  `-cp`选项覆盖`CLASSPATH`环境变量。
2.  Manifest 文件中定义的类路径会覆盖两者`-cp`和`CLASSPATH`环境变量。

参考：[Classpath 如何在 Java](http://javarevisited.blogspot.com/2011/01/how-classpath-work-in-java.html)中工作。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-24T08:11:39.327

linux 下的路径由冒号 ( `:`) 分隔，而不是分号 ( `;`)，因为 theatrus 在他的示例中正确使用了它。我相信 Java 尊重这个约定。

### 编辑

[作为andy 建议](https://stackoverflow.com/questions/580860/adding-classpath-in-linux/580901#580901)的替代方案，您可以使用以下形式（在命令期间设置 CLASSPATH）：

```
CLASSPATH=".:../somejar.jar:../mysql-connector-java-5.1.6-bin.jar" java -Xmx500m ... 
```

哪个对你更方便。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-20T17:46:23.713

对于 linux 用户，总结和补充其他人在这里所说的内容，您应该知道以下内容：

1.  全局变量并不邪恶。$CLASSPATH 特别是 Java 用来查看多个目录以查找脚本所需的所有不同类（除非您使用 -cp 覆盖明确告诉它）。

2.  冒号 (":") 字符分隔不同的目录。只有一个 $CLASSPATH 并且其中包含所有目录。因此，当您运行“export CLASSPATH=....”时，您希望包含当前值“$CLASSPATH”以附加到它。例如：

    ```
    export CLASSPATH=.
    export CLASSPATH=$CLASSPATH:/usr/share/java/mysql-connector-java-5.1.12.jar 
    ```

    在上面的第一行中，您只使用一个简单的“点”来启动 CLASSPATH，它是您当前工作目录的路径。这样，每当您运行 java 时，它都会在当前工作目录（您所在的目录）中查找类。在上面的第二行中，$CLASSPATH 获取您之前输入的值 (.) 并将路径附加到 mysql 驱动程序。现在，java 将为您的类查找驱动程序和。

3.  ```
    echo $CLASSPATH 
    ```

    非常方便，它返回的内容应该像冒号分隔的列表一样，您希望 java 查找运行脚本所需的所有目录。

4.  Tomcat 不使用 CLASSPATH。在此处阅读如何处理：[https ://tomcat.apache.org/tomcat-8.0-doc/class-loader-howto.html](https://tomcat.apache.org/tomcat-8.0-doc/class-loader-howto.html)

# c# - 捕捉到对象/控制功能

> ID：580863
> 
> 赞同：1
> 
> 时间：2009-02-24T08:01:09.087
> 
> 标签：c#, wpf

我在 wpf 中做一个编辑器类型的项目应用程序，我允许用户将他们的控件（我已经定义了我自己的控件，允许用户自定义他们的屏幕）拖到 Canvas 窗口，即我有工具栏和画布区域。我有放置在工具栏中的控件，这些控件可以拖放到画布上。

我完成了拖放内容，目前正在寻找允许我在将控件放置到 Canvas 时从另一个控件的边界捕捉一个控件的功能。

即，当我将第二个控件放置在第一个控件的下方/之后，并且在这种情况下，如果第二个控件进入同一垂直/水平线，则系统应显示浮动可见线以将控件正确放置在一行中。

我在 Visual Studio 表单设计中看到的功能，例如，

![替代文字](https://lh6.ggpht.com/_dhQa0bESjYQ/SaOofLCWn_I/AAAAAAAAAF8/itjEAX-EWog/s400/snapObject.JPG)

请告诉我如何做这件事。

在此先感谢，曼达尔…………

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T10:19:19.973

没有完整的答案，但我知道 VS 中的对齐线和把手使用了[Adorner](http://msdn.microsoft.com/en-us/library/ms753340.aspx)

# asp.net - Sys.WebForms 命名空间在哪里？

> ID：580865
> 
> 赞同：2
> 
> 时间：2009-02-24T08:01:10.943
> 
> 标签：asp.net, ajax, asp.net-ajax

我在我正在寻找的解决方案中看到它，但如果我尝试使用它，我会得到：

**CS0103：当前上下文中不存在名称“Sys”**

我安装了 VS 2008 SP1，我可能遗漏了一些非常明显的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T08:06:05.863

`Sys`命名空间在 JavaScript 中。它是 ASP.NET AJAX 提供的客户端命名空间。您不能从服务器端代码中使用它。

# c# - 使用 Type 对象将 Object 类型的对象转换为另一种类型

> ID：580887
> 
> 赞同：3
> 
> 时间：2009-02-24T08:10:06.710
> 
> 标签：c#, .net, casting

有这样的对象：

```
object integerObject=1; 
```

像这样的对象：

```
Type integerType=typeof(Int32); 
```

*integerType*对象如何用于将*integerObject*转换为*Int32的类型*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T08:17:11.873

`integerObject`引用的对象的类型已经是`Int32`，尽管是盒装版本。

我怀疑您有第三行代码，您没有向我们展示，这是您想要实际使用您希望我们帮助您的操作结果的地方。不幸的是，如果没有第三条线，就很难知道如何提供帮助。

答案*可能*涉及泛型。这*可能*就像打电话一样简单[`Convert.ChangeType`](http://msdn.microsoft.com/en-us/library/dtb69x08.aspx)——但在不了解大局的情况下，我们无法真正说出我的恐惧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T08:34:56.980

```
int result = (int)Convert.ChangeType(integerObject, integerType); 
```

当然，在这种情况下，它在很大程度上是无用的练习，但如果你的“integerObject”的定义不同（也许是一个字符串），那么我猜这是一种有效的做事方式。

您可能也对这个问题感兴趣：[Cast with GetType()](https://stackoverflow.com/questions/555462/cast-with-gettype)

# mysql - 我应该在 php 和 mysql 中以“字符串”或“整数”的形式存储为朋友吗？

> ID：580896
> 
> 赞同：1
> 
> 时间：2009-02-24T08:15:57.163
> 
> 标签：mysql, many-to-many

我进退两难，不知道哪个更好。（我正在使用 php 和 mysql 顺便说一句）

可以说我正在开发一个社交社区网站。用户可以根据需要添加任意数量的朋友。在我的数据库中，我有一个用户表，其中存储用户的详细信息，包括用户的朋友。我应该将用户的朋友存储在：

字符串 => john;bryan;sam;paul;...;

或者

整数 => 1;21;50;1779;30;...;

字符串意味着存储他们的用户名。整数表示存储他们的用户 ID。

哪一个更好？

如果是字符串，那将是一个非常非常大的字符串（假设用户有 400 个朋友，有些用户名非常长）

如果是 id，如何在用户个人资料页面上列出朋友？获取一个长字符串（以分号分隔）中的 ID 列表，使用explode 函数将其制成数组。然后用循环显示？？不麻烦吗？还有其他方法吗？如果是，请显示一些示例代码..

或者通常，你们如何将“朋友”列表存储在用户表中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T08:22:05.200

不要将它们存储为以分号分隔的*任何内容*。将它们作为用户 ID 存储在查找表中。假设用户是#2。你可能有：

```
SourceUserID | FriendUserID
2              1
2              21
2              50
2              1779
2              30
1              // One of John's friends 
```

然后要显示朋友列表，您可以通过 SourceUserID = 2 查询此表，并加入用户表以获取名称。例如：

```
SELECT Name FROM SITE_USERS
INNER JOIN USER_FRIENDS ON SITE_USERS.ID = USER_FRIENDS.FriendUserID
WHERE SourceUser = ? 
```

（或者无论您的参数化查询格式是什么；使用您正在显示其页面的用户的 ID 填充参数。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T08:20:42.567

通常，您会创建第三个表“users_friends”，其中包含两列 userId 和friendId，它们都构成主键。一个快速的谷歌想出了这个：[http](http://www.tekstenuitleg.net/en/articles/database_design_tutorial/8) ://www.tekstenuitleg.net/en/articles/database_design_tutorial/8 ，但你可能想查找其他关于“多对多关系”的文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T08:27:34.233

这需要所谓的多对多关系（即一个朋友可以属于多个用户，用户可以有很多朋友）所以您需要创建第三个表来存储链接，该表将有一个 uniqueId、一个朋友 ID 和一个用户身份，

要获得用户朋友，您需要编写一个连接的 SQL 语句，即

```
SELECT Friends.FriendName FROM UserFriends 
   INNER JOIN Friends ON Friends.FriendId = UserFriends.FriendId 
   WHERE UserID = @intUserId 
```

（您要为其列出朋友的用户的@intUserId）

# floating-point - 有没有办法用 epsilon 获得浮点数的哈希码？

> ID：580905
> 
> 赞同：12
> 
> 时间：2009-02-24T08:20:52.020
> 
> 标签：floating-point, hashcode

众所周知，比较浮点数`==`通常是一个错误。在我写的一个 3D 向量类（带有浮点分量 X、Y、Z）中，如果两个向量的距离被认为为零，则它们被认为是相等的。

```
public override bool Equals(object obj)
{
    if (obj == null) {
        return false;
    }

    if (GetType () != obj.GetType ()) {
        return false;
    }

    float d = DistSq ((Vec) obj);

    return IsConsideredZero (d);
}

public float DistSq(Vec p)
{
    Vec d = this - p;
    return d.LengthSq ();
}

public float LengthSq()
{
    return X * X + Y * Y + Z * Z;
}

private const float VEC_COMPARE_EPSILON_ABS = 1E-05f;
public static bool IsConsideredZero(float f)
{
    return Math.Abs (f) < VEC_COMPARE_EPSILON_ABS;
} 
```

到目前为止，一切正常。但是，现在我想获得向量的哈希码。我可以看到类似`hash = (int)X^(int)Y^(int)Z`的东西一定会失败。

我能想到的最好的办法是：

```
public override int GetHashCode()
{
    return 0;
} 
```

当然，这有点糟糕。有什么方法可以获得合理的哈希码？NaN 和其他特殊值是可能的，但不太可能，如果这很重要的话。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-24T08:27:55.793

假设您想要拥有正常的哈希码/相等属性是不可能的：

*   如果 X = Y 且 Y = Z 则 X = Z（传递性）
*   如果 X = Y 则 Y = X（交换性）
*   X = X 对于所有 X（自反性）

第一条规则是问题 - 因为如果每个值都被视为“等于”下一个更大的可表示数字，那么最终*所有*数字都相等。例如，假设一个数字被认为等于另一个它们在 0.1 以内：

0 等于 0.08 0.08 等于 0.16 0.16 等于 0.24

=> 0 等于 0.16 通过传递性规则 => 0 等于 0.24 通过传递性规则

（ETC）

如果您忽略传递性规则，那么您仍然（可能）希望“相等”值具有相等的哈希码。这有效地执行了传递性规则——在上面的例子中，0 和 0.08 必须具有相等的哈希码，0 和 0.16 也是如此。因此 0 和 0.16 必须具有相同的哈希码，依此类推。因此你不能有*有用*的哈希码——它必须是一个常数。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-24T08:28:24.047

我不认为你可以有一个与你的比较方法一致的哈希码，因为后者是不传递的：对于任何三个向量 A、B、C，如果`A.Equals(B)`和`B.Equals(C)`为真，它仍然可能`A.Equals(C)`是假的。（想象一下，如果 A 和 B 之间的距离是 6e-6，B 和 C 之间是 6e-6，A 和 C 之间是 1.2e-5）但是哈希码的相等性总是传递的，因为它们只是数字。

在这种情况下，我将创建一个 hashcode 方法，该方法根据浮点坐标的确切值计算哈希，并在文档中提到它与 equals 不一致。我知道这不是一个真正的解决方案，但鉴于我认为不存在真正的解决方案，拥有一个非平凡的哈希码比只有 0 更好。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-24T08:27:56.107

恐怕不是一般情况。一个证明的草图是这样的：

取任意两个数 a 和 b。让它们之间的差异为d。然后，如果您创建 d/epsilon 数字，其间有一个 epsilon 步骤，则每个步骤必须与之前的步骤“相等”，根据哈希码语义，它具有相同的哈希码。所以所有数字必须具有相同的哈希码。

只有添加其他约束才能解决此问题。

顺便说一句，您对 Equals 的定义也是错误的，因为 a.Equals(b) 和 b.Equals(c) 可能是真的，而不是 a.Equals(c)，这对于 equals 是错误的。这被称为破坏**传递**性属性。

## 那我能做什么？

解决方案取决于您使用哈希的目的。一种解决方案是引入概念网格。更改等号和哈希码，如果在同一个网格立方体中，两个数字相等，方法是四舍五入到固定的小数位数，然后对四舍五入的数字取等于和哈希码。如果接近零是一个重要的情况，请在舍入前添加 epsilon/2 的偏移量，因此零是立方体的中心。这是正确的，但是您可以让两个数字任意靠近（在浮点数的限制下）而不相等。因此，对于某些应用程序来说会没问题，而其他应用程序则不会。这类似于[mghie](https://stackoverflow.com/users/30568/mghie)的一个想法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T08:48:42.170

每个人都是正确的...

然而，经常做的一件事是稍微扩展散列的概念。考虑一个带有边 >> epsilon 的盒子的 3d 空间分区。

一个点的哈希是它所属的盒子。当您想查找一个点时，您不会使用相应的框检查该点（就像您对常规散列所做的那样），而是检查相邻的框。在 3d 中，您最多可以使用 8 个盒子。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T09:18:52.567

无论你使用什么技术都会有问题，因为你提出了一些无法解决的问题。

你想要的是 1) 均匀分布的散列，这样对于大多数数字 a 和 b 其中 a != b 然后 a.GetHashCode() != b.GetHashCode() 但是 2) 其中 a == b 然后 a.GetHashCode() = = b.GetHashCode() 必须为真。

返回一个常数满足 (2) 但不满足 (1)。

您可以证明在 1E-5 边界处舍入并将其用作散列违反了 (1) 但违反了 (2)。以 1E-5 和 2E-5 为例。四舍五入会产生两个不同的哈希值，但它们比较相等。这违反了上面的约束 (2)。你可以很容易地概括这一点，以证明任何数字的四舍五入都会遇到类似的问题。

我建议您选择不同的方法。我认为潜在的问题是确定某个点是否接近您已经拥有的点。我建议将坐标空间一分为二（沿边界的点（即距离边界 <=1E-5）在两半中）。如果您逐步划分空间（想想二叉树），您可以构建一个数据结构，该结构将快速返回您想要的结果并且相当容易构建。

如果我错过了我的猜测并且您必须使用散列，那么可以使用两个散列值执行您想要的操作，每个散列值四舍五入到 1E-5 但偏移 5E-6。所有相等的点将在两个哈希值之一上比较相等。这将要求您在哈希表中输入点两次，每个哈希例程一次。

# c# - 为什么这个单元测试在 Visual Studio 2005 中通过但在 VS2008 中失败？

> ID：580919
> 
> 赞同：1
> 
> 时间：2009-02-24T08:24:45.740
> 
> 标签：c#, visual-studio, visual-studio-2008, unit-testing

```
[TestMethod]
[ExpectedException(typeof(FormatException))]
public void PassGodammit()
{
    throw new FormatException();
} 
```

?? 快把我逼疯了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T08:27:55.280

从 2005 升级到 2008 后，请务必检查您的项目引用：由于某些奇怪的原因，升级向导不会升级对`Microsoft.VisualStudio.QualityTools.UnitTestFramework`这个程序集 8.0 版的引用，而是保留对 8.0 版的引用。只需手动添加对此程序集的 v 9.0 的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T08:44:02.387

我刚刚将您的代码复制到我的 VS2008 中。结果是“通过”。你还有其他信息吗？这对我来说很有用。

# c++ - 识别模板中的原始类型

> ID：580922
> 
> 赞同：29
> 
> 时间：2009-02-24T08:25:53.757
> 
> 标签：c++, templates

我正在寻找一种方法来识别模板类定义中的基元类型。

我的意思是，有这个类：

```
template<class T>
class A{
void doWork(){
   if(T isPrimitiveType())
     doSomething();
   else
     doSomethingElse(); 
}
private:
T *t; 
}; 
```

有什么方法可以“实现”isPrimitiveType()。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-24T08:34:00.740

**更新**：从 C++11 开始，使用[`is_fundamental`](http://en.cppreference.com/w/cpp/types/is_fundamental)标准库中的模板：

```
#include <type_traits>

template<class T>
void test() {
    if (std::is_fundamental<T>::value) {
        // ...
    } else {
        // ...
    }
} 
```

* * *

```
// Generic: Not primitive
template<class T>
bool isPrimitiveType() {
    return false;
}

// Now, you have to create specializations for **all** primitive types

template<>
bool isPrimitiveType<int>() {
    return true;
}

// TODO: bool, double, char, ....

// Usage:
template<class T>
void test() {
    if (isPrimitiveType<T>()) {
        std::cout << "Primitive" << std::endl;
    } else {
        std::cout << "Not primitive" << std::endl;
    }
 } 
```

为了节省函数调用开销，请使用结构：

```
template<class T>
struct IsPrimitiveType {
    enum { VALUE = 0 };
};

template<>
struct IsPrimitiveType<int> {
    enum { VALUE = 1 };
};

// ...

template<class T>
void test() {
    if (IsPrimitiveType<T>::VALUE) {
        // ...
    } else {
        // ...
    }
} 
```

正如其他人指出的那样，您可以节省您自己实现的时间，并使用 Boost Type Traits Library 中的 is_fundamental ，这似乎完全一样。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T08:35:34.917

[Boost TypeTraits](http://www.boost.org/doc/libs/1_38_0/libs/type_traits/doc/html/index.html)有很多东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-08T00:24:31.280

我想这可以很好地完成这项工作，无需多个专业：

```
# include <iostream>
# include <type_traits>

template <class T>
inline bool isPrimitiveType(const T& data) {
    return std::is_fundamental<T>::value;
}

struct Foo {
    int x;
    char y;
    unsigned long long z;
};

int main() {

    Foo data;

    std::cout << "isPrimitiveType(Foo): " << std::boolalpha
        << isPrimitiveType(data) << std::endl;
    std::cout << "isPrimitiveType(int): " << std::boolalpha
        << isPrimitiveType(data.x) << std::endl;
    std::cout << "isPrimitiveType(char): " << std::boolalpha
        << isPrimitiveType(data.y) << std::endl;
    std::cout << "isPrimitiveType(unsigned long long): " << std::boolalpha
        << isPrimitiveType(data.z) << std::endl;

} 
```

输出是：

```
isPrimitiveType(Foo): false  
isPrimitiveType(int): true  
isPrimitiveType(char): true  
isPrimitiveType(unsigned long long): true 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T08:39:58.120

以下示例（首次发布在 comp.lang.c++.moderated 中）说明了使用部分特化来打印不同的东西，具体取决于它们是否是内置类型。

```
// some template stuff
//--------------------
#include <iostream>
#include <vector>
#include <list>

using namespace std;

// test for numeric types
//-------------------------
template <typename T> struct IsNum {
    enum { Yes = 0, No = 1 };
};

template <> struct IsNum <int> { 
    enum { Yes = 1, No = 0 };
};

template <> struct IsNum <double> {
    enum { Yes = 1, No = 0 };
};

// add more IsNum types as required

// template with specialisation for collections and numeric types
//---------------------------------------------------------------
template <typename T, bool num = false> struct Printer {
    void Print( const T & t ) {
        typename T::const_iterator it = t.begin();
        while( it != t.end() ) {
            cout << *it << " ";
            ++it;
        }
        cout << endl;
    }
};

template <typename T> struct Printer <T, true> {
    void Print( const T & t ) {
        cout << t << endl;
    }
};

// print function instantiates printer depoending on whether or
// not we are trying to print numeric type
//-------------------------------------------------------------
template <class T> void MyPrint( const T & t ) {
    Printer <T, IsNum<T>::Yes> p;
    p.Print( t );
}

// some test types
//----------------
typedef std::vector <int> Vec;
typedef std::list <int> List;

// test it all
//------------
int main() {

    Vec x;
    x.push_back( 1 );
    x.push_back( 2 );
    MyPrint( x );        // prints 1 2

    List y;
    y.push_back( 3 );
    y.push_back( 4 );
    MyPrint( y );        // prints 3 4

    int z = 42;
    MyPrint( z );        // prints 42

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-02-24T18:16:16.503

有一种更好的方法——使用 SFINAE。使用 SFINAE，您不必列出所有原始类型。SFINAE 是一种技术，它依赖于这样一种思想，即当模板专业化失败时，它会退回到更通用的模板。（它代表“专业化失败不是错误”）。

此外，您并没有真正定义您是否将指针视为原始类型，因此我将为您制作所有组合的模板。

```
// takes a pointer type and returns the base type for the pointer.
// Non-pointer types evaluate to void.
template < typename T > struct DePtr                       { typedef void R; }; 
template < typename T > struct DePtr< T * >                { typedef T R; };
template < typename T > struct DePtr< T * const >          { typedef T R; };
template < typename T > struct DePtr< T * volatile >       { typedef T R; };
template < typename T > struct DePtr< T * const volatile > { typedef T R; };

// ::value == true if T is a pointer type
template < class T > struct IsPointer                        { enum { value = false }; };
template < class T > struct IsPointer < T *                > { enum { value = true };  };
template < class T > struct IsPointer < T * const          > { enum { value = true };  };
template < class T > struct IsPointer < T * volatile       > { enum { value = true };  };
template < class T > struct IsPointer < T * const volatile > { enum { value = true };  };

// ::value == true if T is a class type. ( class pointer == false )
template < class T > struct IsClass 
{
   typedef u8 yes; typedef u16 no; 
   template < class C >    static yes isClass( int C::* );
   template < typename C > static no  isClass( ... );
   enum { value = sizeof( isClass<T>( 0 )) == sizeof( yes ) };
};

// ::value == true if T* is a class type. ( class == false )
template < class T > struct IsClassPtr 
{
   typedef u8 yes; typedef u16 no; 
   template < class C >    static yes isClass( int C::* );
   template < typename C > static no  isClass( ... );
   enum { value = sizeof( isClass< typename DePtr< T >::R >( 0 )) == sizeof( yes ) };
};

// ::value == true if T is a class or any pointer type - including class and non-class pointers.
template < class T > struct IsClassOrPtr : public IsClass<T> { };
template < class T > struct IsClassOrPtr < T *                > { enum { value = true };  };
template < class T > struct IsClassOrPtr < T * const          > { enum { value = true };  };
template < class T > struct IsClassOrPtr < T * volatile       > { enum { value = true };  };
template < class T > struct IsClassOrPtr < T * const volatile > { enum { value = true };  };

template < class T > struct IsClassOrClassPtr : public IsClass<T> { };
template < class T > struct IsClassOrClassPtr < T *                > : public IsClassPtr< T*                > { };
template < class T > struct IsClassOrClassPtr < T * const          > : public IsClassPtr< T* const          > { };
template < class T > struct IsClassOrClassPtr < T * volatile       > : public IsClassPtr< T* volatile       > { };
template < class T > struct IsClassOrClassPtr < T * const volatile > : public IsClassPtr< T* const volatile > { }; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-24T08:46:44.907

它不能完全按照你要求的方式完成。这是如何完成的：

```
template<class T>
class A{
void doWork(){
   bool isPrimitive = boost::is_fundamental<T>::value;
   if(isPrimitive)
     doSomething();
   else
     doSomethingElse(); 
}
private:
T *t; 
}; 
```

如果将 isPrimitive 的值直接放在*if*语句中，可能会收到警告。这就是我引入临时变量的原因。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-24T08:59:20.617

还有一个类似的例子：

```
#include  <boost/type_traits/is_fundamental.hpp>
#include <iostream>

template<typename T, bool=true>
struct foo_impl
{
    void do_work()
    {
        std::cout << "0" << std::endl;
    }
};
template<typename T>
struct foo_impl<T,false>
{
    void do_work()
    {
        std::cout << "1" << std::endl;
    }
};

template<class T>
struct foo
{
    void do_work()
    {
        foo_impl<T, boost::is_fundamental<T>::value>().do_work();
    }
};

int main()
{
    foo<int> a; a.do_work();
    foo<std::string> b; b.do_work();
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T08:37:25.910

假设“原始类型”是指内置类型，您可以执行一系列模板特化。您的代码将变为：

```
template<class T>
struct A{
    void doWork();
private:
    T *t; 
};

template<> void A<float>::doWork()
{
    doSomething();
}

template<> void A<int>::doWork()
{
    doSomething();
}

// etc. for whatever types you like

template<class T> void A<T>::doWork()
{
    doSomethingElse();
} 
```

# python - 如何在 Windows 上访问文件的属性？

> ID：580924
> 
> 赞同：33
> 
> 时间：2009-02-24T08:26:26.187
> 
> 标签：python, windows, file-attributes, file-properties

上次我问了一个类似的问题，但那是关于 svn 相关的版本信息。现在我想知道如何查询窗口“文件版本”属性，例如。一个dll。我也关注 wmi 和 win32file 模块，但没有成功。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2011-11-03T10:08:02.510

这是一个将所有文件属性作为字典读取的函数：

```
import win32api

#==============================================================================
def getFileProperties(fname):
#==============================================================================
    """
    Read all properties of the given file return them as a dictionary.
    """
    propNames = ('Comments', 'InternalName', 'ProductName',
        'CompanyName', 'LegalCopyright', 'ProductVersion',
        'FileDescription', 'LegalTrademarks', 'PrivateBuild',
        'FileVersion', 'OriginalFilename', 'SpecialBuild')

    props = {'FixedFileInfo': None, 'StringFileInfo': None, 'FileVersion': None}

    try:
        # backslash as parm returns dictionary of numeric info corresponding to VS_FIXEDFILEINFO struc
        fixedInfo = win32api.GetFileVersionInfo(fname, '\\')
        props['FixedFileInfo'] = fixedInfo
        props['FileVersion'] = "%d.%d.%d.%d" % (fixedInfo['FileVersionMS'] / 65536,
                fixedInfo['FileVersionMS'] % 65536, fixedInfo['FileVersionLS'] / 65536,
                fixedInfo['FileVersionLS'] % 65536)

        # \VarFileInfo\Translation returns list of available (language, codepage)
        # pairs that can be used to retreive string info. We are using only the first pair.
        lang, codepage = win32api.GetFileVersionInfo(fname, '\\VarFileInfo\\Translation')[0]

        # any other must be of the form \StringfileInfo\%04X%04X\parm_name, middle
        # two are language/codepage pair returned from above

        strInfo = {}
        for propName in propNames:
            strInfoPath = u'\\StringFileInfo\\%04X%04X\\%s' % (lang, codepage, propName)
            ## print str_info
            strInfo[propName] = win32api.GetFileVersionInfo(fname, strInfoPath)

        props['StringFileInfo'] = strInfo
    except:
        pass

    return props 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-08-06T08:34:19.903

最好添加一个 try/except 以防文件没有版本号属性。

文件版本.py

```
 from win32api import GetFileVersionInfo, LOWORD, HIWORD

def get_version_number (filename):
    try:
        info = GetFileVersionInfo (filename, "\\")
        ms = info['FileVersionMS']
        ls = info['FileVersionLS']
        return HIWORD (ms), LOWORD (ms), HIWORD (ls), LOWORD (ls)
    except:
        return 0,0,0,0

if __name__ == '__main__':
  import os
  filename = os.environ["COMSPEC"]
  print ".".join ([str (i) for i in get_version_number (filename)]) 
```

你的脚本.py：

```
 import os,filever

myPath="C:\\path\\to\\check"

for root, dirs, files in os.walk(myPath):
    for file in files:
        file = file.lower() # Convert .EXE to .exe so next line works
        if (file.count('.exe') or file.count('.dll')): # Check only exe or dll files
            fullPathToFile=os.path.join(root,file)
            major,minor,subminor,revision=filever.get_version_number(fullPathToFile)
            print "Filename: %s \t Version: %s.%s.%s.%s" % (file,major,minor,subminor,revision) 
```

干杯!

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-04-18T07:11:09.167

[这是一个使用pefile](https://github.com/erocarrera/pefile)模块也适用于非 Windows 环境的版本：

```
import pefile

def LOWORD(dword):
    return dword & 0x0000ffff
def HIWORD(dword): 
    return dword >> 16
def get_product_version(path):

    pe = pefile.PE(path)
    #print PE.dump_info()

    ms = pe.VS_FIXEDFILEINFO.ProductVersionMS
    ls = pe.VS_FIXEDFILEINFO.ProductVersionLS
    return (HIWORD (ms), LOWORD (ms), HIWORD (ls), LOWORD (ls))

if __name__ == "__main__":
    import sys
    try:
        print "%d.%d.%d.%d" % get_product_version(sys.argv[1])
    except:
        print "Version info not available. Maybe the file is not a Windows executable" 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-02-22T10:06:42.857

您可以使用`pyWin32`来自[https://github.com/mhammond/pywin32](https://github.com/mhammond/pywin32)的模块：

```
from win32com.client import Dispatch

ver_parser = Dispatch('Scripting.FileSystemObject')
info = ver_parser.GetFileVersion(path)

if info == 'No Version Information Available':
    info = None 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-27T13:40:42.960

我在“timgolden”网站上找到了这个解决方案。工作正常。

```
from win32api import GetFileVersionInfo, LOWORD, HIWORD

def get_version_number (filename):
  info = GetFileVersionInfo (filename, "\\")
  ms = info['FileVersionMS']
  ls = info['FileVersionLS']
  return HIWORD (ms), LOWORD (ms), HIWORD (ls), LOWORD (ls)

if __name__ == '__main__':
  import os
  filename = os.environ["COMSPEC"]
  print ".".join ([str (i) for i in get_version_number (filename)]) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-10-04T18:06:00.023

我发现唯一的跨平台答案（使用`pefile`）找不到我正在寻找的版本字符串，这是在 Windows 上的 .DLL 文件的“查看属性”的“详细信息”选项卡中显示的那个。但是，此代码基于 中的`dump_info()`函数`pefile`，能够找到这些属性，包括原始文件名、版权、公司名称以及文件和产品版本。

`encoding`如果它们不是使用 UTF-8 编码的，您可能需要用不同的编码替换。

```
import pefile

PATH_TO_FILE = 'C:\...'
pe = pefile.PE(PATH_TO_FILE)

if hasattr(pe, 'VS_VERSIONINFO'):
    for idx in range(len(pe.VS_VERSIONINFO)):
        if hasattr(pe, 'FileInfo') and len(pe.FileInfo) > idx:
            for entry in pe.FileInfo[idx]:
                if hasattr(entry, 'StringTable'):
                    for st_entry in entry.StringTable:
                        for str_entry in sorted(list(st_entry.entries.items())):
                            print('{0}: {1}'.format(
                                str_entry[0].decode('utf-8', 'backslashreplace'),
                                str_entry[1].decode('utf-8', 'backslashreplace'))) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-05-22T23:13:49.173

这是沼泽答案的工作版本，仅使用标准库。像使用它`get_version_string(file, "FileVersion")`。

```
from ctypes import *

# returns the requested version information from the given file
#
# `language` should be an 8-character string combining both the language and
# codepage (such as "040904b0"); if None, the first language in the translation
# table is used instead
#
def get_version_string(filename, what, language=None):
    # VerQueryValue() returns an array of that for VarFileInfo\Translation
    #
    class LANGANDCODEPAGE(Structure):
        _fields_ = [
            ("wLanguage", c_uint16),
            ("wCodePage", c_uint16)]

    wstr_file = wstring_at(filename)

    # getting the size in bytes of the file version info buffer
    size = windll.version.GetFileVersionInfoSizeW(wstr_file, None)
    if size == 0:
        raise WinError()

    buffer = create_string_buffer(size)

    # getting the file version info data
    if windll.version.GetFileVersionInfoW(wstr_file, None, size, buffer) == 0:
        raise WinError()

    # VerQueryValue() wants a pointer to a void* and DWORD; used both for
    # getting the default language (if necessary) and getting the actual data
    # below
    value = c_void_p(0)
    value_size = c_uint(0)

    if language is None:
        # file version information can contain much more than the version
        # number (copyright, application name, etc.) and these are all
        # translatable
        #
        # the following arbitrarily gets the first language and codepage from
        # the list
        ret = windll.version.VerQueryValueW(
            buffer, wstring_at(r"\VarFileInfo\Translation"),
            byref(value), byref(value_size))

        if ret == 0:
            raise WinError()

        # value points to a byte inside buffer, value_size is the size in bytes
        # of that particular section

        # casting the void* to a LANGANDCODEPAGE*
        lcp = cast(value, POINTER(LANGANDCODEPAGE))

        # formatting language and codepage to something like "040904b0"
        language = "{0:04x}{1:04x}".format(
            lcp.contents.wLanguage, lcp.contents.wCodePage)

    # getting the actual data
    res = windll.version.VerQueryValueW(
        buffer, wstring_at("\\StringFileInfo\\" + language + "\\" + what),
        byref(value), byref(value_size))

    if res == 0:
        raise WinError()

    # value points to a string of value_size characters, minus one for the
    # terminating null
    return wstring_at(value.value, value_size.value - 1) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-12T18:58:24.663

这是一个不需要任何额外库的版本。我不能像大家建议的那样使用 win32api：

来自：[https ://mail.python.org/pipermail//python-list/2006-November/402797.html](https://mail.python.org/pipermail//python-list/2006-November/402797.html)

仅在此处复制以防原件丢失。

```
import array
from ctypes import *

def get_file_info(filename, info):
    """
    Extract information from a file.
    """
    # Get size needed for buffer (0 if no info)
    size = windll.version.GetFileVersionInfoSizeA(filename, None)
    # If no info in file -> empty string
    if not size:
        return ''
    # Create buffer
    res = create_string_buffer(size)
    # Load file informations into buffer res
    windll.version.GetFileVersionInfoA(filename, None, size, res)
    r = c_uint()
    l = c_uint()
    # Look for codepages
    windll.version.VerQueryValueA(res, '\\VarFileInfo\\Translation',
                                  byref(r), byref(l))
    # If no codepage -> empty string
    if not l.value:
        return ''
    # Take the first codepage (what else ?)
    codepages = array.array('H', string_at(r.value, l.value))
    codepage = tuple(codepages[:2].tolist())
    # Extract information
    windll.version.VerQueryValueA(res, ('\\StringFileInfo\\%04x%04x\\'
+ info) % codepage,
                                        byref(r), byref(l))
    return string_at(r.value, l.value) 
```

像这样使用：

```
 print get_file_info(r'C:\WINDOWS\system32\calc.exe', 'FileVersion') 
```

# php - 如何打印隐藏 iframe 的内容？

> ID：580941
> 
> 赞同：2
> 
> 时间：2009-02-24T08:35:35.230
> 
> 标签：php, html, css, ajax, iframe

我想打印一个放入 iframe 但不希望内容显示在网页中的页面，但是当我将 iframe 放入 display='none' 时，打印按钮不起作用

我做了什么：-我设置了 iframe 样式='none'

"名称="frame1" >

```
<input type="button" onclick="frames['frame1'].print()" value="print!"> 
```

我怎样才能打印 iframe 的内容而不显示在网页上，或者说隐藏 iframe

非常感谢任何帮助......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T08:38:20.900

您制作了一个打印 css 文件，并且在该文件中您没有 display: none 样式。

```
<link rel="stylesheet" type="text/css" href="/css/print.css" media="print" /> 
```

[这是一个媒体类型的链接](http://www.w3.org/TR/CSS2/media.html)，感谢 Dror。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T08:39:21.290

代替 display: none，您可以尝试 visibility: hidden 并将宽度和高度分别设置为 1px。

# actionscript-3 - 从 As3 打开网页以替换当前的 iFrame

> ID：580946
> 
> 赞同：1
> 
> 时间：2009-02-24T08:36:28.190
> 
> 标签：actionscript-3, flex3

如何从 As3 打开网页以替换当前的 iFrame（和 Flash 对象）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T08:46:41.147

您想将网页打开到 iframe 中还是要替换包含 iframe 的整个页面？

前者：

```
import flash.net.*;    
navigateToURL( new URLRequest("url-of-the-page-to-be-opened"), "_self" ); 
```

后者：

```
import flash.net.*;    
navigateToURL( new URLRequest("url-of-the-page-to-be-opened"), "_top" ); 
```

# c# - 什么是好的 Telnet 客户端实现 C#？

> ID：580948
> 
> 赞同：3
> 
> 时间：2009-02-24T08:37:23.417
> 
> 标签：c#, .net, telnet

什么是 C# 中好的开源 Telnet 客户端实现，可以在封闭代码中使用（即，不在 GPL 下）？

波阿斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-08T15:02:34.957

我发现的最佳 C# Telnet Lib 称为 Minimalistic Telnet。非常容易理解、使用和修改。它适用于我需要配置的 Cisco 路由器。

[http://www.codeproject.com/KB/IP/MinimalisticTelnet.aspx](http://www.codeproject.com/KB/IP/MinimalisticTelnet.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T08:47:57.337

波阿斯你应该能够很容易地想出你自己的。您需要做的就是创建一个控制台应用程序，了解参数如何工作，寻找有关如何使用 TcpClient 类的教程，您就可以了。

**编辑：**

我现在知道了。我在考虑最基本的 telnet 客户端类型。我认为您无法找到支持 vt100、vt52 和 vtnt 的 telnet 客户端的免费源代码。

# .net - 单元测试新手

> ID：580960
> 
> 赞同：11
> 
> 时间：2009-02-24T08:44:02.807
> 
> 标签：.net, asp.net, unit-testing

我想知道如何使用 Visual Studio 2008（.net 2.0）在现有（相当大的）应用程序中实现单元测试。

我知道为现有/遗留代码开发单元测试是不现实的，但我希望对代码进行测试。

我找到了很多关于如何为代码编写测试的示例，但没有关于如何在现有项目上从头开始设置以及如何将其集成到开发周期中的示例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T08:55:34.527

简单的方法：

*   选择一种单元测试框架（Nunit、MbUnit、Xunit、VS 单元测试框架……）
*   在您的解决方案中添加单元测试项目（例如 UnitTests）。
*   开始编写测试。

为了便于组织，请为解决方案中的每个项目至少创建一个命名空间，例如 UnitTest.Project1、UnitTests.Project2、... 根据项目的大小，向命名空间添加更多级别。

这种方式测试项目是解决方案的一部分。如果您使用一些持续集成工具，则可以在每次提交到源代码存储库时自动执行测试。

**编辑：**
关于创建单元测试的 MS 单元测试框架问题的评论，有一个已知问题：[“创建单元测试”向导不起作用](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=357452)。看起来有不受支持的项目类型会阻止单元测试向导正常工作。我刚刚尝试了一种具有一个 F# 和多个 C# 项目的解决方案。我添加了单元测试项目并尝试添加测试。在我卸载 F# 项目之前，测试向导一直存在问题。然后一切正常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T09:09:58.797

使用现有代码进行测试的一种简单方法是制定在发现错误时编写测试的策略。

IE

*   查找错误
*   编写重现错误的测试
*   使固定

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T08:55:28.067

如果你想对现有代码进行单元测试，我强烈推荐阅读这本书：[有效地使用遗留代码。](https://rads.stackoverflow.com/amzn/click/com/0131177052)这也是一本关于单元测试最佳实践的好书。

可以对现有项目进行单元测试，但是您必须在这里和那里进行一些调整以使代码可测试。过多的依赖通常是问题所在。

编辑（在您发表评论之后）如果您真的想将单元测试嵌入到您的开发周期中，那么您应该选择 TDD（[测试驱动开发](http://en.wikipedia.org/wiki/Test-driven_development)）。这里的目的是首先编写单元测试，这样你就可以很好地理解你的类会做什么。当然，这些测试会失败，但目标是让它们一个一个地工作。在 TDD 上做一个谷歌，那里有很多信息。

# java - 将数据从文本导入mysql时出现问题

> ID：580962
> 
> 赞同：2
> 
> 时间：2009-02-24T08:44:32.307
> 
> 标签：java, mysql, text, import, load-data-infile

我使用了一个应用程序将一些数据从文本文件导入到 mysql。我使用了以下代码。

```
try
{
   stmt = conn.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,
                               ResultSet.CONCUR_UPDATABLE);
   stmt1= (Statement) conn.createStatement();
   int deleteRows = stmt1.executeUpdate("delete  from powerdata where dateformat < dateformat_sub(now(), interval 8 month)");
   query = "LOAD DATA LOCAL INFILE \"E:\\powerdata.txt\" INTO TABLE powerdata  set dateformat=str_to_date(date, '%m/%d/%Y' '%H:%i:%s');";
   int Update= stmt.executeUpdate(query);
} 
```

但是将数据从文本加载到 mysql 的查询为空。谁能告诉我我在哪里犯了错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T22:32:03.023

难不成是问题出在了`\"E:\\powerdata.txt\"`位子上？您正在转义引号，但您没有转义反斜杠。这意味着您的查询实际上如下所示： LOAD DATA LOCAL INFILE "E:\powerdata.txt" INTO TABLE powerdata set dateformat=str_to_date(date, '%m/%d/%Y' '%H:%i:%s ');

要修复文件名，请使用`\"E:\\\\powerdata.txt\"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T09:29:44.647

您可能没有授予您正在使用[FILE](http://dev.mysql.com/doc/refman/5.1/en/privileges-provided.html#priv_file)权限的用户。如果您查看[文档](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)，他们会讨论远程用户使用 LOAD DATA LOCAL INFILE 加载数据所需的权限。关闭此功能是有充分理由的，因此启用它时要小心。

# c# - 我们可以在 Mac OS X 上运行 C#/WPF 应用程序吗？

> ID：580970
> 
> 赞同：45
> 
> 时间：2009-02-24T08:47:55.247
> 
> 标签：c#, wpf, macos, porting

我卖了一个 C#/WPF 应用程序（目前针对 .net 3.0），人们一直问我要 Mac 版本。

该应用程序是具有良好 GUI 的时间跟踪应用程序，时间跟踪应用程序中没有那么多业务逻辑，因此大多数应用程序都是 GUI - 仅重写 GUI 相当于重写整个应用程序

我没有资源来重写应用程序或维护两个不同的代码库，所以我需要一种在 Mac 上运行相同代码的方法（我知道我必须调试和修改代码，我的意思是我只能支持一个代码库，我无法将项目拆分为不同的 Mac 和 Windows 项目——我只是没有时间处理两个项目）。

将应用程序移植到跨平台 UI 库、不同的编程语言或 Silverlight 都无关紧要 - 这将花费太多时间，我想通过这次投资新功能来获得更多销售。

有谁知道可以运行或将 C#/WPF 移植到 Mac 的工具？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-24T08:54:09.413

您绝对无法在 Mac 上运行成熟的 WPF 应用程序。我什至不确定这在 Parallels 中是否可行。您可以做的最好的事情是使用 Silverlight，它以前被命名为“WPF/E”并且可以在 Macintosh 上运行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-24T09:45:20.117

我们也有类似的情况。我们有一个工作的 Windows 项目，想要一个 Mac 版本。

我们的产品分为两部分，一个是 .Net 应用程序，另一个是 Director 投影仪应用程序。

Director 应用程序应该很简单吧，跨平台等等？好吧，不，它很少那么容易，我们最终得到了两个版本的 Director 源文件。

运行 .Net 应用程序需要使用 Mono 作为底层引擎，这对我们来说效果很好，因为我们实际上只是在处理数字字节数组。另一方面，我们不得不用 Cocoa 重写 UI。它的成本几乎与制作 Windows 版本的成本一样高，因为我们还必须在学习过程中学习所有 Mac 的东西。

从那时起，我们只更新了 Windows 版本。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-08-12T22:04:42.607

我们有一个类似的问题。我们在 Silverlight 3 中编写了一个 Mac 版本（它支持很多 WPF .NET 东西）。它是沙盒的，但如果这不是问题，你可以做一些不错的事情。我们的代码库现在位于 WPF 和 Silverlight 3 上，并且是相同的，当我们编译它时会生成 SL3 和桌面应用程序。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-29T17:30:28.877

您可以使用 Parallels。我有我们用 C# 和 WPF 编写的办公软件，人们一直在 Parallels 下的 Mac 上使用它。

进一步说明，Parallels 允许您同时运行 Windows 应用程序和 Mac OSX 应用程序，这些应用程序在 Mac 桌面上它们自己的窗口中可见。它还允许在 Mac 和 Windows 应用程序之间复制和粘贴以及拖放。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-24T09:05:24.800

你想要一个新功能（支持一个完全不同的平台）并且你不希望在它上面付出任何努力。对不起，大多数时候这行不通。

除了最基本的（本机）.NET 单声道外，我认为您不能在 MacOSX 上本机运行 WPF 应用程序。

如果你认为你可以通过获得 Mac 用户来赚更多的钱。您可以考虑使用其他演示方法。由于您当前的“投资”，我会说尝试 Silverlight（是的，我读过您关于不这样做的咆哮）。另一种选择可能是 Adob​​e AIR / Flex。

如果您以这种方式移植您的应用程序。您可以维护一个代码库.. 一个在两个平台上运行的代码库。

如果您希望在当前代码库中花更多时间在新功能上：忽略 Mac 用户。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-06-02T12:31:01.260

你可以试试 Nevron Open Vision。它集成在 WPF、WinForms、Silverlight 和 MonoMac、Xamarin.Mac 项目中。这不像在 Mac 上运行 WPF 应用程序，而是需要您在 NOV 平台上重新编码您的应用程序。但是，一旦您这样做了，您的应用程序（或模块）将通过一个代码库在所有这些平台上运行。这种方法工作的一个很好的例子是 Nevron Writer（Nevron Office 的一部分）。它通过 100% 单一代码库在 Windows、Silverlight 和 Mac 上运行。

[披露：我为 Nevron 工作]

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T09:04:02.120

这是不可能的。但是由于您的 UI 在 WPF 中，您可以做的是将 XAML 转换为其他东西 - 例如[GTK#](http://en.wikipedia.org/wiki/Gtk_Sharp)。当然，如果您像我一样使用大量 .NET 3.5 功能，那对您帮助不大。

让您的 UI 一开始就使用简单、简单的 XML 的另一个理由。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-02T16:31:40.290

实际上，有一个 CrossOver 适合您。其他从程序员的角度回答观点的人。如果我是你，我会安装 CrossOver，然后在 CrossOver 中安装 .NET 3.5，然后愉快地运行 WPF 软件。

[http://www.codeweavers.com/products/cxmac/](http://www.codeweavers.com/products/cxmac/)

或者，如果您更喜欢免费（但更难）的解决方案，请尝试 wine。

[http://davidbaumgold.com/tutorials/wine-mac/](http://davidbaumgold.com/tutorials/wine-mac/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-07-20T07:06:13.550

另一个商业解决方案是 NoesisGUI（年总收入低于 10 万的免费）。它是一个基于 WPF/XAML 的跨平台 UI 框架。有一个[从 WPF 迁移的指南](https://www.noesisengine.com/docs/2.2/Gui.Core.WPFComparison.html)。

# wpf - 如何在 WPF 中使用动态 URL 绑定到图像？

> ID：580975
> 
> 赞同：5
> 
> 时间：2009-02-24T08:49:48.130
> 
> 标签：wpf, image, data-binding

我是 WPF 的新手，所以希望我正确地表达了这个问题。我想做的是将我的绑定`<Image>`到在线图像。但是，我想绑定到的图像会根据应用程序的状态而变化。例如，如果我想绑定到从列表中选择的员工，我会从我的 App.config 中检索一个基本 URL，并使用员工的 ID 附加图像名称，如下所示：

```
var baseUrl = ConfigurationSettings.AppSettings["BaseImageUrl"];
var imageUrl = String.Format("{0}/{1}.jpg", baseUrl, employeeID); 
```

问题是，我不确定如何在 WPF 中以声明方式执行此操作。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T02:08:09.067

您的代码中有员工对象吗？如果是这样，您可以公开一个基于对象的员工 ID 构建的 URI 属性。

否则，您能否在您的网站上有一个提供图像的 asp.net 页面（我不知道这是否可行，但这是一个想法）

所以在你的 xaml 中有这样的东西

```
<Image Source="{Binding Path=EmployeeId, StringFormat='http://my.url.com/Image.aspx?employeeId={0}'}" /> 
```

Image.aspx 会根据employeeId 获取变量流式传输图像吗？

正如我所说，这可能有点错误，但它可以工作，但我认为员工类上的 URI 属性将是最干净的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T09:12:19.090

我认为这样的事情会有所帮助：

```
<Window.Resources>
   <ImageSource x:Key="MyImage" Source="C:\Images\Default.jpg" />
</..>

<Image Source="{DynamicResource MyImage}" /> 
```

然后在您的代码隐藏中：

```
((ImageSource)this.Resources["MyImage"]).Source = "C:\Path\From\Config.jpg"; 
```

# silverlight - 测试 MouseLeave() 离开的位置

> ID：580978
> 
> 赞同：0
> 
> 时间：2009-02-24T08:50:40.263
> 
> 标签：silverlight, event-handling, mouseevent

我有一个名为 myListItem 的 UserControl 进入 ListBox'es。在鼠标悬停时，它会显示一个弹出窗口，并且在该弹出窗口中有一个滚动视图，用户可能希望使用它来滚动视图中的文本。我制作了一个事件处理程序，当鼠标进入时显示弹出窗口，但是当鼠标离开时我有点挣扎。如果鼠标离开弹出窗口，则弹出窗口应保持不变，但当鼠标以任何其他方式离开时，应禁用弹出窗口。你对如何解决这个问题有什么建议吗？我认为会有一种看起来像这样的方法：

```
void MouseLeave(object sender, MouseEventArgs e) {
  if(!e.Position.Intersects(itemPopUp.BoundingBox))
    itemPopUp.IsOpen = false;
} 
```

干杯

尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T10:50:14.780

假设您有这个 Popup XAML 代码：

```
<Popup x:Name="MyPopup">
    <Border Width="200" Height="200" BorderThickness="1" BorderBrush="Black" Background="Pink"
            MouseLeave="Border_MouseLeave" MouseMove="Border_MouseMove" >

    </Border>
</Popup>
<TextBlock x:Name="MouseLeaveLoc" Text="N/A" /> 
```

这在后面的代码中（C#）：

```
private void Border_MouseLeave(object sender, MouseEventArgs e)
{
    MouseLeaveLoc.Text = mouseLoc.ToString();
}

private Point mouseLoc;
private void Border_MouseMove(object sender, MouseEventArgs e)
{
    mouseLoc = e.GetPosition(MyPopup);
    mouseLoc.X -= MyPopup.HorizontalOffset;
    mouseLoc.Y -= MyPopup.VerticalOffset;
} 
```

mouseLoc 包含相对于您的弹出内容（此处为边框控件）的 X、Y 值。

# delphi - Delphi-IDE：如何改变类完成的工作方式？

> ID：580983
> 
> 赞同：8
> 
> 时间：2009-02-24T08:52:46.547
> 
> 标签：delphi, ide, code-generation, opentools, class-completion

Delphi 中的类完成可以大大节省时间，但我还没有找到自定义它的方法。

1.  我想要一个属性的getter和setter被组合在一起，而不是被扔到我的整个单元中；接口部分是正确生成的，但是如果你把事情留给 IDE，实现部分就会变得一团糟。我希望默认情况下像这样订购方法：

    > 函数 TAaa.getAaa();
    > 
    > 程序 TAaa.setAaa();
    > 
    > 程序 TAaa.Baa();
    > 
    > 函数 TAaa.getCow();
    > 
    > 程序 TAaa.setCow();
    > 
    > 程序 TBbb.getAaa()

2.  我希望实现部分与接口的顺序相同；

3.  我希望生成的方法的主体看起来像这样：

.

```
 procedure TMyClass.MyProc;
 begin
   { TODO -oWouter -cimplement autogenerated stuff : implement Procedure MyProc() }
   raise Exception.create('procedure TMyClass.MyProc() is not yet implemented');
 end; 
```

是否有工具可以做到这一点，或者是否需要深入到 opentools API 来完成类似的事情？

* * *

相关问题： [Class Completion 将其结果按什么顺序排列？](https://stackoverflow.com/questions/527938/in-what-order-does-class-completion-put-its-results)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-24T11:14:27.720

> 问题 1：我想要一个属性的 getter 和 setter 组合在一起。

Modelmaker Code Explorer (MMX) 有一个排序工具。该工具对接口和实现中的类成员进行排序。我正在使用的 4.05 版本**不**支持您的排序。但是，Modelmaker 网站包含一个[显示最新排序功能的页面，](http://www.modelmakertools.com/articles/sort-rearrange-code.html)并且似乎他们通过许多新选项扩展了排序功能。也许您可以使用他们最新的 MMX 工具对您的 getter/setter 方法进行分组。方便的功能：

*   MMX 类资源管理器中的拖放排序：您将方法拖到新位置，模型制作者移动代码
*   排序提示：如果某个方法没有按照您的默认排序模板排序，MMX 会通知您

> 问题2：我希望实现部分与接口的顺序相同。

MMX 排序功能可以做到这一点。执行排序后，接口和实现的顺序相同。

> 问题 3：我希望生成的方法的主体看起来像这样......

MMX [添加新方法] 将自动将可自定义的代码存根添加到您的方法主体。代码存根中支持参数，但我没有看到支持的参数列表。这是一个示例

程序 TForm1.NewMethod;

开始

// TODO TForm1.NewMethod 默认主体插入

结尾;

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T10:44:36.340

[ModelMaker Code Explorer](http://www.modelmakertools.com/code-explorer/index.html)可以做到。请参阅[http://www.modelmakertools.com/articles/sort-rearrange-code.html#sorting-scheme](http://www.modelmakertools.com/articles/sort-rearrange-code.html#sorting-scheme)

# java - 当 toString() 和 hashCode() 被覆盖时，如何在 java 中获取对象的“对象引用”？

> ID：580984
> 
> 赞同：118
> 
> 时间：2009-02-24T08:52:49.447
> 
> 标签：java, object, hashcode

我想在 Java 中打印对象的“对象引用”以进行调试。即根据情况确保对象相同（或不同）。

问题是有问题的类继承自另一个类，该类已经覆盖了 toString() 和 hashCode() 这通常会给我 id。

示例情况：运行多线程应用程序，我（在开发期间）想检查所有线程是否使用资源对象的相同实例。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-02-24T09:07:08.273

你到底打算用它做什么（你想做的事情与你需要打电话的事情不同）。

[`hashCode`](https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode--)，如 JavaDocs 中所定义，说：

> 在合理可行的情况下，由 Object 类定义的 hashCode 方法确实为不同的对象返回不同的整数。（这通常通过将对象的内部地址转换为整数来实现，但 Java™ 编程语言不需要这种实现技术。）

因此，如果您`hashCode()`要确定它是否是内存中的唯一对象，那么这不是一个好方法。

[`System.identityHashCode`](https://docs.oracle.com/javase/8/docs/api/java/lang/System.html#identityHashCode-java.lang.Object-)执行以下操作：

> 为给定对象返回与默认方法 hashCode() 返回的相同的哈希码，无论给定对象的类是否覆盖 hashCode()。空引用的哈希码为零。

对于您正在做的事情，这听起来像是您想要的……但是您想要做的事情可能并不安全，具体取决于库的实现方式。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-02-24T08:54:07.820

这就是我解决它的方法：

```
Integer.toHexString(System.identityHashCode(object)); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-25T04:01:48.343

无论对象的 hashCode 或 equals 实现如何，双等号`==`始终会根据对象身份进行检查。当然 - 确保您正在比较的对象引用是`volatile`（在 1.5+ JVM 中）。

如果您真的必须拥有原始的 Object toString 结果（尽管它不是您的示例用例的最佳解决方案），Commons Lang 库有一个方法[ObjectUtils.identityToString(Object) 可以满足](http://commons.apache.org/lang/apidocs/org/apache/commons/lang/ObjectUtils.html#identityToString(java.lang.Object))您的需求。来自 JavaDoc：

```
public static java.lang.String identityToString(java.lang.Object object) 
```

> 如果类没有覆盖 toString 本身，则获取将由 Object 生成的 toString。null 将返回 null。

```
 ObjectUtils.identityToString(null)         = null
 ObjectUtils.identityToString("")           = "java.lang.String@1e23"
 ObjectUtils.identityToString(Boolean.TRUE) = "java.lang.Boolean@7fa" 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-24T14:58:07.277

你不能安全地做你想做的事，因为默认的 hashCode() 可能不会返回地址，并且已经提到，具有相同 hashCode 的多个对象是可能的。完成您想要的唯一方法是实际覆盖所讨论对象的 hashCode() 方法并保证它们都提供唯一值。这在您的情况下是否可行是另一个问题。

作为记录，我在 WAS 服务器中运行的 IBM VM 中经历了多个具有相同默认哈希码的对象。我们有一个缺陷，即被放入远程缓存的对象会因此而被覆盖。这让我大开眼界，因为我假设默认的哈希码也是对象的内存地址。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-24T18:31:46.153

为所有实例添加唯一 ID，即

```
public interface Idable {
  int id();
}

public class IdGenerator {
  private static int id = 0;
  public static synchronized int generate() { return id++; }
}

public abstract class AbstractSomething implements Idable {
  private int id;
  public AbstractSomething () {
    this.id = IdGenerator.generate();
  }
  public int id() { return id; }
} 
```

从 AbstractSomething 扩展并查询此属性。在单个虚拟机内将是安全的（假设没有使用类加载器玩游戏来绕过静态）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-05-21T11:59:54.260

我们可以简单地从对象类的tostring中复制代码来获取string的引用

```
class Test
{
  public static void main(String args[])
  {
    String a="nikhil";     // it stores in String constant pool
    String s=new String("nikhil");    //with new stores in heap
    System.out.println(Integer.toHexString(System.identityHashCode(a)));
    System.out.println(Integer.toHexString(System.identityHashCode(s)));
  }
} 
```

# c++ - VS2005 C++ 损坏的 vtables

> ID：580985
> 
> 赞同：3
> 
> 时间：2009-02-24T08:53:54.750
> 
> 标签：c++, visual-studio-2005, vtable

我目前正在开发一个相当大（而且很旧，叹气）的代码库，最近升级到 VS2005 (SP1)。我和我的团队正在更改/更新/替换此代码中的模块，但我们偶尔会遇到 vtables 似乎损坏的问题。我不是 vtables 方面的专家，但这些肯定似乎被打破了。错误表现为以下错误：

> 运行时检查失败 #0 - ESP 的值未在函数调用中正确保存。这通常是调用使用一种调用约定声明的函数和使用另一种调用约定声明的函数指针的结果。

当然，这个错误可能还有很多其他原因，但是在调试（调试构建）时，我实际上可以验证我想要操作的对象的 vtables 看起来很奇怪：

引用每个 vtable 的堆栈和堆看起来都很好，并且指向 vtable 的指针与映射文件完美匹配。这向我表明这不是内存覆盖错误或类似错误，因为它会影响堆栈和堆而不是存储 vtable 的位置。（它们存储在只读区域对吗？）无论如何，到目前为止一切似乎都很好。但是当查看 vtable 的内存时，我发现所有值，如果我将它们解释为指针，尽管它们在同一范围内（例如 0x00f203db 0x00f0f9be 0x00ecdda7 0x00f171e1）不匹配映射文件中的任何条目，其中许多条目甚至没有对齐到 4 个字节。我不知道 VS2005 如何构建 vtables 的所有细节，但这在我看来是错误的。如果这是正确的行为，也许有人可以向我解释一下？

我想我的问题归结为什么会导致这种行为？例如，当类层次结构过于复杂时，链接器中是否存在已知错误？有没有人见过类似的东西？目前，我们能够通过将函数从受影响的类移动到内联（可怕的东西！）来解决我们的崩溃问题，但显然这不是一个可行的长期解决方案。

感谢您的任何见解！

更新：有人问我有关该项目的更多详细信息，我当然会提供。然而，首先，问题与 ESP 值未保存错误并不完全相关。我最感兴趣的是为什么我会在 vtable 中看到奇怪的值。也就是说，这里有一些附加信息：该解决方案依赖于几个外部和内部项目，但这些项目很长时间没有改变，都使用相同的调用约定。它似乎中断的代码都在解决方案的一个非常标准的 C++“主”项目中。所有代码都使用相同的编译器构建。该解决方案也不使用任何 dll，而是使用大量静态库链接：

SHFolder.lib、python25.lib、dxguid.lib、d3d9.lib、d3dx9.lib、dinput8.lib、ddraw.lib、dxerr9.lib、ws2_32.lib、mss32.lib、Winmm.lib、vtuneapi.lib、vttriggers。 lib，DbgHelp.lib，kernel32.lib，user32.lib，gdi32.lib，winspool.lib，comdlg32.lib，advapi32.lib，shell32.lib，ole32.lib，oleaut32.lib，uuid.lib，odbc32.lib， odbccp32.lib

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T06:04:42.080

我发现了问题。真的很傻，但是导致问题的类层次结构有一个名为 GetObject 的虚函数，它与同名的 Windows #define 冲突。头文件以不同的顺序包含这些 windows 头文件，这使链接器感到困惑。所以，实际上问题是 vtables 损坏了，但我没想到这是原因！好吧，你每天都学到一些东西......

但是，非常感谢所有回复！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T09:01:57.490

我认为这里的重要提示在于“*这通常是调用使用一种调用约定声明的函数和使用不同调用约定声明的函数指针的结果*”该错误的一部分。在我看来，调用者的 API 和处理调用的库之间存在不匹配。

此外，您可能正在混合使用不同编译器构建的代码。关于这个项目的性质，你还能告诉我们什么？您正在调用的函数是否位于外部库中？或者你可以调试整个调用堆栈吗？

**编辑**：您说该项目不使用任何 DLL。静态库呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T20:32:55.123

注意增量链接和 Edit+Continue 对函数地址的影响，包括 v-table 条目。它的工作原理是通过跳转表间接调用方法。这允许链接器在需要重新定位方法时修补跳转表，而无需重新链接整个图像。该跳转表中的地址相隔 5 个字节。它们不会出现在 .map 文件中。当您切换到程序集视图并跟踪调用的执行时，很容易看到。

这也是您应该用来诊断 RTC 故障的技术。找出实际调用的方法。最可能的原因是您已将虚拟方法添加到类中，但该类的客户端未重新编译。在 v-table 中使用了错误的插槽。更改接口而不是 IID 时通常也会出现 COM 问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T09:22:05.023

每当我收到这样的消息时，答案总是涉及重新编译部分或全部代码。作为第一步，我会尝试完全重建。Sqook 关于外部库的建议听起来也很合理，如果可能的话，您再次使用与主代码相同的调用约定重新编译该库。

我有时发现 Build 命令可能会丢失需要重新编译的文件，这可能会导致您的消息。再次，全面重建将使事情理顺。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T14:17:17.593

当我遇到这个错误之前，它总是在涉及 COM 的时候。它几乎总是与重入特别相关——你在使用 COM 吗？您使用的是 STA，消息过滤器吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-24T09:00:14.687

我遇到了完全相同的问题 - 在对象上调用重载的虚函数导致“ESP 未正确保存”错误，但调试显示编译器为此调用在 vtable 中生成了错误的偏移量，因此另一个函数具有更多参数被调用。被调用的函数更新了 ESP，就好像调用者在堆栈上推送了更多参数，这反过来导致返回时无效的 ESP 值。

在我将包含错误类的头文件放在源文件的顶部后，问题就消失了。我还没有进一步调查究竟是什么原因造成的，但我想这是在同样的情况下——有些人定义了虚拟成员的声明。

希望能帮助其他遇到同样问题的人。

# linux - 关于 Linux 和开源的视频

> ID：580986
> 
> 赞同：2
> 
> 时间：2009-02-24T08:54:00.677
> 
> 标签：linux, unix, open-source, video, history

我正在寻找一些有关 Unix/Linux 和开源软件历史的视频。我知道（并且拥有）[Revolution OS](https://rads.stackoverflow.com/amzn/click/com/B0000A9GLO)。

还有其他人吗？

编辑：我是一名教师，需要资源向学生展示。

[编辑：我在Google Video](http://video.google.com/videoplay?docid=7707585592627775409)上找到了 Revolution OS 。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T09:20:13.517

[Stephen Fry在这里](http://www.gnu.org/fry/)祝 GNU 生日快乐，它是一款整洁的手表。我认为您的问题不需要更多视频来解释 FLOSS 社区中经常发生的纠缠。

另请理解，“开源”和“自由软件”可能有不同的含义，具体取决于您与谁交谈。

最有趣的讨论发生在邮件列表上，而不是 Youtube 或类似网站上。

您可能还会喜欢这些[有关 GPL3](http://gplv3.fsf.org/av)的视频。

大多数通过代码而不是说话来完成更多工作的人不喜欢制作视频。这不是对 RMS 的猛烈抨击，极客喜欢被存放在凉爽、黑暗、干燥的地方，除非激进主义能让他们开心。

结合“软件许可证”对这些名称中的任何一个进行简单搜索应该会出现更多：

*   理查德·斯托曼
*   莱纳斯·托瓦兹
*   西奥·德·拉特

维基百科对上述所有内容都有很好的信息。

同样，不是对 RMS 的猛烈抨击，但任何制作视频讨论理想主义主题的人都有一些理想可以推销给你。视频本身并不是了解 FLOSS 社区分裂政治的最佳方式，几乎与软件专利一样多。做一些真正的阅读和研究。

只是，无论您做什么，都不要编写自己的许可证，请参阅[许可证扩散](http://en.wikipedia.org/wiki/License_proliferation)以了解更多信息。

# javascript - 检查滚动条

> ID：580990
> 
> 赞同：0
> 
> 时间：2009-02-24T08:54:11.877
> 
> 标签：javascript, iframe, scroll

有没有办法检查滚动条？我需要的是一种方法来查看用户是否在 iframe 中写了太多文本（使用 punyMCE）。如果用户超出了允许的行数（这将导致出现滚动条），我想告诉用户已经输入了最大行数。

现在还有第二个问题。我似乎无法从 punyMCE 框架内触发关键事件。这意味着我无法进行检查...有什么建议吗？我试过这个：

```
frame = frames['eventTxt_f'].document.getElementsByTagName('body')[0];
frame.onkeydown = function() {
    alert("keydown");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T09:14:44.637

一种更简单的方法可能是将 iframe 内容的 clientHeight 与 iframe 的外部高度进行比较。像这样的东西：

```
if (window.frames[0].innerHeight < window.frames[0].document.documentElement.clientHeight)
    alert('too much!'); 
```

（使用 FF3的[PunyMCE 简单示例快速测试）](http://www.moxieforge.net/examples/punymce/examples/simple.html)

# java - 如何在 Tapestry 5 中使用带有网格或循环组件的基类或接口？

> ID：580991
> 
> 赞同：2
> 
> 时间：2009-02-24T08:54:49.350
> 
> 标签：java, tapestry

我有一个扩展 BaseA 并实现 InterfaceA 的具体类 A。我想使用基类或接口作为循环变量来循环 A 列表。尝试这样的事情：

```
<t:loop source="listOfA" value="propertyOfTypeBaseA">
    ${propertyOfTypeBaseA.someField}
</t:loop> 
```

给我一个错误“找不到从类型 A 到 BaseA 的强制”。当我将值设置为 InterfaceA 类型的属性时，也会发生同样的事情。如果我使用 Object 作为循环变量类型，我可以让循环工作，但是我无法访问具体类或接口上的任何字段。

似乎 Tapestry 应该知道如何从一个对象强制转换为它实现的接口，但我也尝试将强制从 A 贡献到 BaseA/InterfaceA 并且它仍然给了我这个错误，即使它实际上在列表中显示了强制。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T09:24:25.830

如果不在 Tapestry 管理的包中，该界面将工作。而且我现在知道“基本”包是 Tapestry 除了页面和组件之外还管理的包。我已经将我的基类和接口放在那个包中，认为它们不会受到 Tapestry 的类加载器 voodoo 的影响。将它们移出后，我仍然需要为基类提供强制转换，但不需要为接口提供强制转换。

# python - 正则表达式'|' 运算符与每个子表达式的单独运行

> ID：580993
> 
> 赞同：5
> 
> 时间：2009-02-24T08:55:29.863
> 
> 标签：python, regex, performance

我有一个相当大的字符串（~700k），我需要对其运行 10 个正则表达式并计算任何正则表达式的所有匹配项。我快速而肮脏的 impl 是做类似 re.search('(expr1)|(expr2)|...') 的事情，但我想知道我们是否会看到通过在循环中匹配来获得任何性能提升：

换句话说，我想比较以下性能：

```
def CountMatchesInBigstring(bigstring, my_regexes):
  """Counts how many of the expressions in my_regexes match bigstring."""
  count = 0
  combined_expr = '|'.join(['(%s)' % r for r in my_regexes])
  matches = re.search(combined_expr, bigstring)
  if matches:
    count += NumMatches(matches)
  return count 
```

对比

```
def CountMatchesInBigstring(bigstring, my_regexes):
  """Counts how many of the expressions in my_regexes match bigstring."""
  count = 0
  for reg in my_regexes:
    matches = re.search(reg, bigstring)
    if matches:
      count += NumMatches(matches)
  return count 
```

我将不再懒惰并明天进行一些测试（并发布结果），但我想知道答案是否会跳出给真正了解正则表达式如何工作的人:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T09:03:55.693

这两件事会给出稍微不同的结果，除非保证匹配将匹配一个且仅匹配一个正则表达式。否则，如果某项匹配 2，它将被计算两次。

从理论上讲，您的解决方案应该更快（如果表达式是互斥的），因为正则表达式编译器应该能够制作更有效的搜索状态机，因此只需要一次通过。我希望差异很小，除非表达式非常相似。

此外，如果它是一个巨大的字符串（大于 700k），则执行一次可能会有所收获，因此将需要 n 次更少的内存交换（到磁盘或 cpu 缓存）。

我敢打赌，在您的测试中，它并不是很明显。我对实际结果感兴趣 - 请务必发布结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T15:40:35.880

要了解 re 模块的工作原理 - 在调试模式下编译 _sre.c（将 #define VERBOSE 放在 _sre.c 的 103 行并重新编译 python）。在这之后你会看到这样的东西：

```
 >>> import re
>>> p = re.compile('(a)|(b)|(c)')
>>> p.search('a'); print '\n\n'; p.search('b')
|0xb7f9ab10|(nil)|SEARCH
prefix = (nil) 0 0
charset = (nil)
|0xb7f9ab1a|0xb7fb75f4|SEARCH
|0xb7f9ab1a|0xb7fb75f4|ENTER
allocating sre_match_context in 0 (32)
allocate/grow stack 1064
|0xb7f9ab1c|0xb7fb75f4|BRANCH
allocating sre_match_context in 32 (32)
|0xb7f9ab20|0xb7fb75f4|MARK 0
|0xb7f9ab24|0xb7fb75f4|LITERAL 97
|0xb7f9ab28|0xb7fb75f5|MARK 1
|0xb7f9ab2c|0xb7fb75f5|JUMP 20
|0xb7f9ab56|0xb7fb75f5|SUCCESS
discard data from 32 (32)
looking up sre_match_context at 0
|0xb7f9ab1c|0xb7fb75f4|JUMP_BRANCH
discard data from 0 (32)
|0xb7f9ab10|0xb7fb75f5|END

|0xb7f9ab10|(nil)|SEARCH
prefix = (nil) 0 0
charset = (nil)
|0xb7f9ab1a|0xb7fb7614|SEARCH
|0xb7f9ab1a|0xb7fb7614|ENTER
allocating sre_match_context in 0 (32)
allocate/grow stack 1064
|0xb7f9ab1c|0xb7fb7614|BRANCH
allocating sre_match_context in 32 (32)
|0xb7f9ab20|0xb7fb7614|MARK 0
|0xb7f9ab24|0xb7fb7614|LITERAL 97
discard data from 32 (32)
looking up sre_match_context at 0
|0xb7f9ab1c|0xb7fb7614|JUMP_BRANCH
allocating sre_match_context in 32 (32)
|0xb7f9ab32|0xb7fb7614|MARK 2
|0xb7f9ab36|0xb7fb7614|LITERAL 98
|0xb7f9ab3a|0xb7fb7615|MARK 3
|0xb7f9ab3e|0xb7fb7615|JUMP 11
|0xb7f9ab56|0xb7fb7615|SUCCESS
discard data from 32 (32)
looking up sre_match_context at 0
|0xb7f9ab2e|0xb7fb7614|JUMP_BRANCH
discard data from 0 (32)
|0xb7f9ab10|0xb7fb7615|END

>>> 

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T09:10:06.957

我相信您的第一次实施会更快：

*   Python 性能的关键原则之一是“将逻辑移动到 C 级别”——这意味着内置函数（用 C 编写）比纯 Python 实现更快。因此，当循环由内置的 Regex 模块执行时，它应该更快
*   一个正则表达式可以一次搜索多个模式，这意味着它只需运行一次文件内容，而多个正则表达式必须多次读取整个文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T09:00:54.640

我怀疑正则表达式也会做你想做的事情......只会更好:)

所以“|” 会赢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T19:59:17.770

越少越好：它只会使用更多内存，这通常不是问题。

如果任何事情都可以留给解释器来处理，它总能找到比典型的人类对应物更快的解决方案（无论是在实施时间上还是在执行时间上）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T09:05:16.500

我同意 amartynov 但我想补充一点，您也可以考虑先编译正则表达式（re.compile()），尤其是。在第二个变体中，您可能会在循环中节省一些设置时间。也许你也可以在上面测量它。

我认为 one shot 表现更好的原因是我假设它完全在 C 空间中完成，不需要解释太多 python 代码。

但期待数字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T09:06:22.113

一次编译和搜索应该会产生更快的结果，在较低的表达式规模上，增益可能可以忽略不计，但运行得越多，增益就越大。可以将其视为编译一次并匹配与编译 10 次并匹配。

# java - 为什么小程序的采用率如此之低？

> ID：580995
> 
> 赞同：20
> 
> 时间：2009-02-24T08:56:52.480
> 
> 标签：java, flash, applet

[与Flash](http://en.wikipedia.org/wiki/Adobe_Flash)相比，为什么小程序的采用率如此之低？是因为它们是技术上的劣势，还是只是受欢迎程度的问题？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-24T09:24:37.967

每个人似乎都忘记了一点：最初 Flash 有一个非常面向设计师的工作流程，所以许多图形设计师加入进来，制作了看起来很酷的东西，互联网用户觉得这很有趣，所以他们会下载 Flash，社区就发展了。

另一方面，Java Applet 是针对程序员和企业的，这很好，但对普通用户来说很无聊。最重要的是，当时的脚本小子（包括我自己）制作了泄露资源和/或冻结浏览器的小程序，甚至其他更熟练的小子也利用小程序的力量来制造陷阱和有害网站，所以大多数互联网用户不会启用小程序。

所以最终可能是每个平台的目标开发人员（图形设计师与程序员）导致了问题。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-28T18:21:00.950

过去和现在的 Java 与 Flash：

然后：

1.  Flash 有一个单击安装程序，下载和运行需要 2 分钟。Java 有一个安装程序，下载和运行需要 10 分钟。
2.  Flash 应用程序在不到一秒的时间内加载完毕。Java 小程序耗时 10 秒。
3.  Flash 应用程序往往是独立的，并且会“正常工作”。Java 小程序倾向于引用外部资源。断开的链接频繁出现，小程序引擎受到稳定性问题的困扰，有时可能会导致整个浏览器瘫痪。
4.  Flash 的采用率空前高涨，因为它随 Windows 一起提供。Java没有。

现在：

1.  Sun 推出了名为[Java Kernel](http://java.sun.com/javase/6/6u10faq.jsp#JKernel)的单击安装程序，下载和运行只需 2 分钟。
2.  Java6 更新 12 可在一秒钟内加载小程序。
3.  Java 小程序现在在与浏览器不同的进程中运行，并且引擎已从头开始重写。稳定性问题已成为过去。不幸的是，网络上仍然充斥着包含损坏链接的旧小程序。
4.  Java 是大多数新计算机的标准配置。Java 采用率从 70% 到 90% 不等，具体取决于您与谁交谈。随意[衡量](http://cowwoc.blogspot.com/2008/12/tracking-java-versions-using-google.html)您自己的网站。

剩下的一大区别是，Flash 拥有比 Java 更好的面向艺术家的工具。话虽如此，有大量的软件可以让你用 Java 比用 Flash 更容易、更高效地编写它们。Java 是一个更加成熟和可扩展的平台。您会看到很多人将 Flash 用于广告横幅，但更多人将 Java 用于成熟的应用程序或游戏。例如，比较 Java 和 Flash 中的 3D 渲染支持。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-24T09:03:30.187

早在 1990 年代，当 Sun 向世界推出 applet 时，JVM 很慢，applet 也更慢。想想“等待十五分钟让它完成加载”慢。

慢速技术是死技术。速度并不是 Flash 及其同类产品相对于 Java applet 的唯一优势，但它是导致它们衰落的主要原因。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-24T09:01:06.963

我假设您在谈论 Java 小程序。

我认为采用 Flash 的最大优势之一是一个具有吸引力且易于使用的工具的单一开发环境。丰富的培训材料补充了这一点。它也基本上是单一目的，而 Java 有各种各样的用途和目标受众。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-24T09:07:44.980

直到最近，Java 小程序还相当繁重。任何 Java Applet 都需要 JVM 来启动和加载 applet，这在现代机器上可能需要一些时间，而在引入 Java 时的机器上甚至更慢。此外，与 Flash 相比，Java Applet 更像是一种复杂的野兽，因此会出现许多问题（是否需要对您的 Applet 进行签名？这对开发人员来说可能是一个巨大的痛苦）。此外，Flash 迅速开发了一个产品生态系统，可以快速轻松地满足人们的需求（有趣的图形！），而在 Java 中，除了按钮和复选框（基本浏览器级别已经提供的东西）之外的任何东西都需要更多的工作，而且不需要几乎拥有flash所做的支持。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-24T09:02:10.050

Java 环境笨重且笨重。
它需要几秒钟才能启动并开始运行，这通常是 CPU 和内存的负担。另一方面，Flash 的重量要轻得多。
另一个因素是 Java 小程序通常在视觉上不如 Flash 有吸引力。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-27T02:16:13.603

Java 处于极大的劣势，仅仅是因为普通用户下载和安装起来很复杂。

将向潜在用户提供 Java 包的多个版本，包括 SDK 等。这会吓跑大多数只想快速查看简单小程序的用户。

Java 已经修复了这个问题，现在 java.com 可以一键下载插件。Flash 从一开始就拥有这一点，我不会感到惊讶它为它的成功做出了部分贡献。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-24T11:48:30.383

在您的 PC 上安装和管理所需的多个 Java 运行时版本是大多数用户也不想经历的麻烦。如果它不能开箱即用，请忘记它！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T09:24:50.913

通常它们很重，很慢。它们中的很多都非常丑陋（早期的 Swing 看起来像 Xaw 或 Motif）。不同的是，Sun 是处理重铁和企业业务的公司，而 Macromedia 和 Adob​​e 是一直与图形设计师打交道的公司。所以 Flash 有*“令人惊叹的因素”*，而 applet 没有。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T09:05:32.850

如前所述，小程序有些笨重和过时。Sun 现在正试图推动 JavaFX，这很可能是“下一个 Flash”。

# asp.net - 多次点击的jQuery tablesorter扩展问题？

> ID：580996
> 
> 赞同：0
> 
> 时间：2009-02-24T08:57:00.780
> 
> 标签：asp.net, jquery, asp.net-ajax, jquery-plugins, tablesorter

好的，我有一个表格，由 GridView 制作，并附加了一个表格排序器，它工作得很好。

然后我将它放在更新面板中，并添加代码以在回发时重新绑定它，这是我的脚本：

```
function loadEvents() { $("table[id$='gv']").tablesorter(); }
$(document).ready(function() { loadEvents(); });
function reBind() {
    if (Sys.WebForms.PageRequestManager) {
        var prm = Sys.WebForms.PageRequestManager.getInstance();
        prm.add_endRequest(function() { loadEvents(); });
    }
} 
```

效果很好，我加载了gridview，排序工作。

*   我点击一个发回的按钮，它工作正常。
*   我*再次*单击，第一次单击可以排序，排序，但它卡住了 - 在那里 - 我可以更改列，但它永远不会排序？但是之后...
*   我再次点击，它工作正常

这继续，工作每隔一次点击......有什么想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-02-24T11:53:31.183

您的问题听起来像是服务器端问题 - 排序仅在表被绑定到同一个请求后才有效。否则，排序的事件连接找不到任何东西。

当然——如果你已经绑定了表格，它已经被排序了——所以现在你必须再次获取数据。

这类问题是可怕的 .Net 页面事件模型的常见问题。

最简单的解决方法是确保在加载视图状态后但在事件触发之前，您的表在 ajax 回发上被反弹，然后在事件触发后再次获取数据。问题是你已经获得了两次数据。

更好的解决方法是避免在任何动态页面元素中使用 .Net 的事件连接。

.Net 页面事件模型的这些类型的问题是人们对 MVC 如此感兴趣的部分原因。``````***