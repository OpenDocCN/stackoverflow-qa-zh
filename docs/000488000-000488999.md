# StackOverflow 问答 000488000-000488999

# dynamics-crm - 通过自定义工作流更新 MS CRM 4.0 中的自定义实体

> ID：488001
> 
> 赞同：2
> 
> 时间：2009-01-28T15:19:05.367
> 
> 标签：dynamics-crm, dynamics-crm-4

我在 MS CRM 4.0 中创建了一个自定义实体，并尝试通过 .Net 中的自定义工作流更新几个属性。我已经阅读了几个论坛和博客文章，但仍然对如何访问自定义实体和更新它们的一些属性感到困惑。

我创建了一个自定义实体来替代 CRM 进行分配的方式，因为我们公司有一些 CRM 没有执行的特定业务规则。当事件的任务完成时，我想用任务持续时间更新自定义实体中的属性。任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T22:21:16.870

在自定义工作流中使用 CRM Web 服务时，您需要使用 DynamicEntity 对象。工作流上下文 Web 服务只是一个 ICrmService，因此它不知道您的特定自定义。这里有一个漂亮的示例：http: [//www.stunnware.com/crm2/topic.aspx?id=CustomWorkflowActivity](http://www.stunnware.com/crm2/topic.aspx?id=CustomWorkflowActivity)

我想您还可以将 CRM Web 服务添加为您的工作流项目的 Web 参考。然后，您将拥有自定义实体的强类型对象。我从来没有为我的自定义工作流程这样做过，但它适用于访问 CRM 的其他自定义应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-04T17:46:20.043

选择动态实体而不是 WSDL 总是更好的选择。当您开发一段代码时，您的类会更加灵活。您可以在不同的环境中为不同的系统使用您的软件。这就是发明动态实体的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T15:14:18.877

这非常简单，您不必使用 DynamicEntity。您必须转到设置 -> 自定义 -> 下载 WSDL。获取 wsdl 并在您的项目中使用它。现在您拥有所有自定义实体的强类型。你所要做的就是写这样的东西：

```
Guid entityId = getEntityId();
new_yourCustomEntity entity = new new_yourCustomEntity();
entity.new_yourCustomEntityid = entityId;
entity.new_customProperty = "value";
CrmService crmService = new CrmService();
crmService.Update(entity); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T15:39:45.583

也许您真正的意思是 Custom Workflow *Activity*？*这涉及编写您自己的 .NET 类，以新步骤*类型的形式向标准 CRM WF 添加功能。如果您想要做的只是更新您并不真正需要的属性，即使它位于自定义实体上。*更新记录*步骤就是这样做的，它允许指定动态值（来自其他实体）。

希望能帮助到你

丹尼尔

# asp.net - 用 asp.net 创建复杂的 html 电子邮件的最佳方法，如何？

> ID：488014
> 
> 赞同：2
> 
> 时间：2009-01-28T15:23:40.927
> 
> 标签：asp.net, email

用户下订单后，我必须发送详细的电子邮件消息，其中包含订单详细信息、付款说明、一些附加文本等。

我想创建格式良好的 HTML 电子邮件。

到目前为止，我找到了两个选择：

*   手动逐条逐条创建，太麻烦了，
*   创建实际的 aspx 页面和绑定数据，然后将该页面呈现为 html 并作为电子邮件正文发送。

第二个选项更直观，更容易实现，除了：

*   我不知道如何实际加载和渲染页面，我知道如何使用 ascx
*   实例化页面并渲染它似乎有很多开销

如何加载页面并渲染它？对于这项任务，您还有其他想法或建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T15:34:41.713

好吧，IMO，您的基本问题相当于**“如何将 ASPX 资源转换为 HTML 字符串以传递给 MailMessage Body 属性？”**

您可以简单地通过对有问题的 ASPX URL 使用 WebRequest 并将该响应读入 Stream 来做到这一点。然后只需将流读入字符串即可解决您的主要问题。

编辑：这是[一篇](http://authors.aspalliance.com/stevesmith/articles/dotnetemailwebsite.asp)说明这个概念的文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T15:32:45.790

就个人而言，我想在数据库中或作为加载的文件使用模板。该模板将包含 HTML 格式的电子邮件的大部分内容，以及可以用内容替换的标记。

前任。

```
<b>Receipt for order # [[ordernum]]</b> 
```

这样，我可以使用简单的字符串替换将动态内容放入电子邮件中，而不必在每次需要发送时都构建整个电子邮件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T15:38:14.813

在类似的情况下，我将模板电子邮件信息存储在我的数据库中，以便使用我们软件的人可以修改该信息。它是（由用户）使用 Telerik 的在线 HTML 编辑器控件创建的。在此消息中，我支持几个“邮件合并”类型的字段，它们都具有 {FirstName}、{LastName} 等模式。

当需要发送消息时，我从数据库中提取格式化文本，使用字符串替换填充模板中的任何插槽，然后发送它。我想关键是我知道消息是 HTML 格式的，因为 Telerik 控件有助于确保它是 HTML 格式。但是，您没有理由不能创建 HTML，然后将其保存以备后用。

.aspx 页面路由？我*只是不会这样做。* 这太过分了，并没有为您提供任何优势。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T15:37:13.753

尝试使用存储在 .NET 字符串资源文件中的模板。这也将使本地化变得容易得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T16:18:34.233

我将使用 Jay 提到的模板。

以下资源可能对您有用。

[http://dotnettricks.com/blogs/roberhinojosablog/archive/2006/05/12/57.aspx](http://dotnettricks.com/blogs/roberhinojosablog/archive/2006/05/12/57.aspx)

# xml - 任何允许指定约束（如无循环引用）的 XML 模式语言？

> ID：488019
> 
> 赞同：2
> 
> 时间：2009-01-28T15:25:05.650
> 
> 标签：xml, xsd, dtd, relaxng

是否有任何 XML 模式语言允许指定元素之间不能存在循环引用的约束。

作为一个玩具示例：

```
<animal name="A" eats="B">
<animal name="B" eats="C">
<animal name="C" eats="D"> 
```

会验证，但是

```
<animal name="A" eats="B">
<animal name="B" eats="C">
<animal name="C" eats="D">
<animal name="D" eats="A"> 
```

不会验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T20:20:03.747

据我所知，没有设计用于强制执行这种约束的模式语言。如果在模式语言中是可能的，它可能是 Schematron。架构不会很漂亮。

对我来说，这意味着你不应该尝试使用模式语言来做到这一点。使用您熟悉的任何编程语言，并以易于阅读的代码编写约束。它将比任何基于模式的版本更短且更易于理解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T16:03:19.363

您可以使用 schematron，然后发布与 xslt/xpath 问题相同的问题。

# css - 将大小与 CSS 中的字体系列故障安全匹配

> ID：488025
> 
> 赞同：1
> 
> 时间：2009-01-28T15:26:43.667
> 
> 标签：css

我有一个使用非标准字体和 arial 作为故障保险的页面。有谁知道是否有办法将字体大小有条件地设置为字体？

```
<style type="text/css">
  body {
    font-family: Calibri, arial, sans-serif;
    font-size: 1em, .9em, .9em;
    /* Where 1em would be for Calibri and .9 would be for arial and sans-serif */
  }
</style> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T15:47:00.113

好问题，但目前你不能这样做，直到'font-size-adjust'属性得到更广泛的支持。它规范化具有非常不同的原始大小的字体。这是我能找到的最简单的定义和示例：

[http://www.w3schools.com/CSS/pr_font_font-size-adjust.asp](http://www.w3schools.com/CSS/pr_font_font-size-adjust.asp)

我想说即使现在使用它也没有什么坏处，然后当浏览器支持改进时它就会准备好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T15:45:22.630

解决方案是使用[font-size-adjust](http://www.w3schools.com/CSS/pr_font_font-size-adjust.asp)。问题是它的支持很差（恕我直言）。

# wmi - WMI 远程连接

> ID：488033
> 
> 赞同：1
> 
> 时间：2009-01-28T15:29:25.440
> 
> 标签：wmi

我有一个关于通过 asp.net 从计算机 A（Windows 2003 服务器）到计算机 B（Windows XP）的 WMI 连接的问题。

错误如下：

> RPC 服务器不可用..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T19:40:34.833

为了成功利用 WMI 连接，您必须执行几个步骤。基础是您当然必须允许对目标框进行远程管理。如果你不能 RDP 进入它，很可能你不能远程管理其他任何东西。这也可能包括 Windows 防火墙问题。确保您的请求甚至可以进入。

接下来，从简单开始。你甚至可以轮询那个盒子上正在运行的进程吗？尝试使用 System.Diagnostics.Process currentProcess = System.Diagnostics.Process.GetProcesses("machine-name") 输出目标框上所有正在运行的进程。如果您至少可以获得有关该框的一些信息，那么您收到的 RPC 消息可能与传入的参数不正确有关，也许？

无论如何，我最近编写了一个 Web 应用程序，它允许用户在 LAN 上查找服务器并杀死那里的目标进程或启动一个新进程。我是在 C# 中完成的，所以下面的代码片段正是我使用的。它不是最好的，但它现在正在生产中：

```
public static class RemoteProcessAccess
{

    public static void KillProcessByProcessID(string NameOfServer, string DomainName, string LogIn, string Password, int processID)
    {
        //#1 The vars for this static method
        #region /// <variables> ...
            string userName;
            string password;
            string machineName;
            string myDomain;
            Hashtable hs = new Hashtable();
            ManagementScope mScope;
            ConnectionOptions cnOptions;
            ManagementObjectSearcher objSearcher;
            ManagementOperationObserver opsObserver;
            ManagementClass manageClass;
            DirectoryEntry entry;
            DirectorySearcher searcher;
            DirectorySearcher userSearcher;
        #endregion

        //#2 Set the basics sent into the method
            machineName = NameOfServer;
            myDomain = DomainName;
            userName = LogIn;
            password = Password;

            cnOptions = new ConnectionOptions();
            cnOptions.Impersonation = ImpersonationLevel.Impersonate;
            cnOptions.EnablePrivileges = true;
            cnOptions.Username = myDomain + "\\" + userName;
            cnOptions.Password = password;

            mScope = new ManagementScope(@"\\" + machineName + @"\ROOT\CIMV2", cnOptions);

        //#3 Begin Connection to Remote Box
            mScope.Connect();
            objSearcher = new ManagementObjectSearcher(String.Format("Select * from Win32_Process Where ProcessID = {0}", processID)); 
            opsObserver = new ManagementOperationObserver();
            objSearcher.Scope = mScope;
            string[] sep = { "\n", "\t" };

        //#4 Loop through 
        foreach (ManagementObject obj in objSearcher.Get())
        {
            string caption = obj.GetText(TextFormat.Mof);
            string[] split = caption.Split(sep, StringSplitOptions.RemoveEmptyEntries);

            // Iterate through the splitter
            for (int i = 0; i < split.Length; i++)
            {
                if (split[i].Split('=').Length > 1)
                {
                    string[] procDetails = split[i].Split('=');
                    procDetails[1] = procDetails[1].Replace(@"""", "");
                    procDetails[1] = procDetails[1].Replace(';', ' ');
                    switch (procDetails[0].Trim().ToLower())
                    {
                        //You could look for any of the properties here and do something else,
                        case "processid":
                            int tmpProc = Convert.ToInt32(procDetails[1].ToString());
                            //if the process id equals the one passed in....
                            //(this is redundant since we should have limited the return 
                            //by the query where above, but we're paranoid here

                            if (tmpProc.Equals(processID))
                            {
                                obj.InvokeMethod(opsObserver, "Terminate", null);                                    
                            }
                            break;

                    }//end process ID switch...

                }//end our if statement...

            }//end our for loop...

        }//end our for each loop...

    }//end static method 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T15:33:24.870

查看[KB875605](http://support.microsoft.com/kb/875605)（“如何解决 Windows XP SP2 中与 WMI 相关的问题”）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-23T09:05:20.967

您可以通过在目标的命令提示符下运行它来在任何目标机器上启用 RPC 服务器：

[/code] netsh 防火墙设置服务 RemoteAdmin [/code]

至少为我工作。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-18T09:27:01.427

尝试使用 wmic 命令行从远程计算机获取信息，也可以安装[Services+](https://servicesplus.codeplex.com/)的代码并尝试连接和调试与服务器的连接，很可能是防火墙问题或 RPC 服务关闭或禁用。

# javascript - Flex 3 和 Javascript 分层问题

> ID：488035
> 
> 赞同：0
> 
> 时间：2009-01-28T15:29:47.513
> 
> 标签：javascript, apache-flex

我在速度页面中嵌​​入了一个 flex 对象。在 flex 对象上方我有我的导航栏，其中有许多用 Javascript 构建的下拉组件。

当我单击下拉列表时，它们似乎落后于 Flex 对象。就好像 Flex 对象位于 Javascript 所在的层之上。

有没有人遇到过这个问题并找到了解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T17:38:30.857

您不必将 SWF 发布为透明的（在 Flex 中，您可以通过将节点`backgroundAlpha`上的 CSS 属性设置`Application`为 0），除非您希望通过 SWF 的某些部分查看您的内容HTML 页面。但是，是的，您需要确保两件事：

1.  确保 SWF 的 z-index 属性（与[CSS 定位](http://www.w3schools.com/Css/css_positioning.asp)一样）低于 JavaScript/DHTML 下拉菜单的 z-index 属性，并且

2.  将`wmode="transparent"` 属性添加到 SWF 对象的`object`和`embed` 标签。（[更多来自 Flex 文档的信息](http://livedocs.adobe.com/flex/3/html/help.html?content=wrapper_13.html)。）

那应该这样做。希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T16:44:41.277

好吧，flex 应用程序只是一个 SWF，所以我想解决方案与您在那个世界中所做的相同，我认为将其发布为透明并将标签的**wmode**属性设置`<object>`为“透明”以及.

# python - Django：ModelMultipleChoiceField 不选择初始选择

> ID：488036
> 
> 赞同：26
> 
> 时间：2009-01-28T15:30:02.677
> 
> 标签：python, django, django-models, django-forms

ModelMultipleChoiceField 不选择初始选择，我无法在我的示例中进行以下修复（下面的链接）：

[http://code.djangoproject.com/ticket/5247#comment:6](http://code.djangoproject.com/ticket/5247#comment:6)

我的模型和形式：

```
class Company(models.Model):
    company_name = models.CharField(max_length=200)

class Contact(models.Model):
    company = models.ForeignKey(Company)
    first_name = models.CharField(max_length=100)
    last_name = models.CharField(max_length=100)

class Action(models.Model):
    company = models.ForeignKey(Company, blank=True, null=True)
    from_company = models.ManyToManyField(Contact, verbose_name='Participant(s) from "Company"', blank=True, null=True)

class Action_Form(ModelForm):
    from_company = forms.ModelMultipleChoiceField(queryset=Contact.objects.none(), widget=forms.CheckboxSelectMultiple())
    class Meta:
        model = Action 
```

我做什么和结果：

```
>>> contacts_from_company = Contact.objects.filter(company__exact=1) # "1" 用于测试，否则为变量
>>> form = Action_Form(initial={'from_company': [o.pk for o in contacts_from_company]}) # 按照修复建议
>>> 打印表格['from_company']
<ul>
</ul>
>>> 打印contacts_from_company
[<联系人：测试人员>，<联系人：其他人>]

>>> form2 = Action_Form(initial={'from_company': contacts_from_company})
>>> 打印 form2['from_company']
<ul>
</ul>

>>> form3 = Action_Form(initial={'from_company': Contact.objects.all()})
>>> 打印 form3['from_company']
<ul>
</ul>

```

我希望它能够工作的方式：
1\. 我的视图从 request.GET 获取“公司”
2\. 然后过滤该“公司”的所有“联系人”
3\. 最后，它创建一个表单并将这些“联系人”传递为“初始={...}”

**两个问题：**
**1\. [尚未回答]**如何让 ModelMultipleChoiceField 采用那些“初始”值？
**2\. [已回答]**作为替代方案，我可以将变量传递给 Action_Form(ModelForm) 以便在我的 ModelForm 中我可以：

```
from_company = forms.ModelMultipleChoiceField(queryset=Contact.objects.filter(company__exact=some_id) # 其中 some_id 来自视图

```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-10-07T10:01:37.887

我正在回复 1)

> 1\. 如何让 ModelMultipleChoiceField 采用那些“初始”值？

这可以`Action_Form` `__init__`使用 ModelMultipleChoiceField`initial`属性在您的方法中完成。

正如它在 Django 源代码 ( *db/models/fields/related.py* ) 中所说`def formfield(self, **kwargs)`：

```
 # If initial is passed in, it's a list of related objects, but the
        # MultipleChoiceField takes a list of IDs. 
```

所以你需要给它一个ID列表：

```
class Action_Form(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(Action_Form, self).__init__(*args, **kwargs)
        self.fields['from_company'].initial = [c.pk for c in Contact.object.filter()] 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-28T15:45:06.063

您需要添加一个`__init__`方法来设置初始值，记住通过**super**`Action_Form`调用`__init__`基`ModelForm`类。

 **```
class Action_Form(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(Action_Form, self).__init__(*args, **kwargs)
        self.fields['from_company'].queryset = Contact.object.filter(... 
```

如果您打算将过滤器参数作为关键字参数传递给`Action_Form`，则需要在调用 super 之前删除它们：

```
myfilter = kwargs['myfilter']
del kwargs['myfilter'] 
```

或者，可能更好：

```
myfilter = kwargs.pop('myfilter') 
```

有关更多信息，这里是另一个链接，指的[是 Django 中的 Dynamic ModelForms](http://www.rossp.org/blog/2008/dec/15/modelforms/)。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-10-12T13:13:25.147

如果之前的答案不够直截了当，我尝试再次回答 1)：

> 1.  如何让 ModelMultipleChoiceField 采用那些“初始”值？

您可以保留`Action_Form`原来的问题，并使用它来准确呈现您想要的内容：

```
>>> form4 = Action_Form(initial={'from_company': Contact.objects.all().values_list('id',flat=True)})
>>> print form4['from_company'] 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-12-18T15:14:45.887

回答（1）问题！

这将不起作用：

```
self.fields['from_company'].initial = [c.pk for c in Contact.object.filter()] 
```

但这**确实有效**：

```
self.initial['from_company'] = [c.pk for c in Contact.object.filter()] 
```

# asp.net - 从 ASP.Net 中的 Web 用户控件调用 NHibernate 时崩溃

> ID：488037
> 
> 赞同：1
> 
> 时间：2009-01-28T15:30:15.327
> 
> 标签：asp.net, nhibernate, controls

我有一个非常奇怪的问题：从 Web 用户控件调用 NHibernate 时崩溃。

我正在开发一个使用 NHibernate 访问数据库的 ASP.Net (2.0) 网页。

我有一个简单的工厂类来访问表 ProjectInfo 中的 CurrentStepNumber 列：

```
public class ProjectEntity
{
    private int? _currentStepNumber;
    public virtual int? CurrentStepNumber
    {
        get { return _currentStepNumber; }
        set { _currentStepNumber = value; }
    }

    public static ProjectWizardEntity GetById(int id, bool shouldLock) 
    {
        return RepositoryFactory.ProjectWizardRepository.GetById(id, shouldLock);
    }

    public static ProjectWizardEntity GetById(int id) 
    {
        return GetById(id, false);
    }

    public virtual void Save() 
    {
        RepositoryFactory.ProjectWizardRepository.Save(this);
    }

    public virtual void SaveOrUpdate() 
    {   
        RepositoryFactory.ProjectWizardRepository.SaveOrUpdate(this);
    }
} 
```

此类通过代理类访问，因此每次分配新值时都会将其刷新到数据库：

```
public class DBHelper
{
ProjectEntity _projectEntity;
ProjectEntity GetProjectEntity()
{
    if (_projectEntity == null)
        _projectEntity = //get or create a new one;

    return _projectEntity ;
}

public int? CurrentStepNumber
{
    get
    {
        return (CurrentProjectId > 0) ? CurrentProjectWizardEntity.CurrentStepNumber : 0;
    }
    set
    {
        if (CurrentProjectId > 0)
        {

            CurrentProjectWizardEntity.CurrentStepNumber = value;
            CurrentProjectWizardEntity.SaveOrUpdate();
        }
    }
}
} 
```

现在的问题：

1.  当我从 test.aspx 页面访问**CurrentStepNumber时，一切正常**
2.  当我从 test.aspx 页面上使用的 Web 用户控件 (test.ascx) 中读取此字段时，它仍然可以
3.  **但是**，当我尝试在控件后面的代码（test.ascx）中为**CurrentStepNumber**分配一个值时，我总是会遇到异常：

> NHibernate.NonUniqueObjectException：具有相同标识符值的不同对象已与会话关联

实际上NHibernate Repository 的**SaveOrUpdate**方法会引发异常。

我无法弄清楚这里可能是什么问题，因此将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-08-31T20:11:15.140

我认为您在这里遇到了会话管理问题。RepositoryFactory.ProjectWizardRepository.GetById 如何创建和处理 NHibernate 会话？它是否创建然后关闭会话？

似乎 DBHelper.GetProjectEntity() 正在创建或加载 ProjectEntity。后来，当我调用 CurrentStepNumber 的设置器时，您将对象插入或更新到数据库。

问题是当 DBHelper.GetProjectEntity() 正在加载现有对象并在加载后关闭会话但保留对象时，我们正在进入深水区。当对象稍后更新时，您为 CurrentStepNumber 设置一个新值并将对象发送到 NHibernate 进行保存。这里的问题是该对象与保存期间创建和关闭的新会话没有关联。Nhibernate 然后会感到困惑，因为发现了一个新对象，该对象不是从当前会话加载的，但它具有现有对象的 id。

对于解决方案，Google 搜索“NHibernate asp.net 会话管理”，您将获得许多关于如何使用 ASP.NET 请求周期作为工作单元的好消息。

# asp.net - Telerik radGrid - 当数据源 = 数据集时可以使用 AllowAutomaticUpdates 吗？

> ID：488039
> 
> 赞同：3
> 
> 时间：2009-01-28T15:31:06.997
> 
> 标签：asp.net, asp.net-ajax, telerik, radgrid

我将我的 radGrid 的数据源设置为一个数据集（我存储在会话中）。我启用了 AllowAutomaticUpdates 和 EnableViewState，实现了 NeedDataSource，设置了 DatakeyNames 等（参见下面的代码）

但是，当我按下编辑按钮并进行更改并按下更新链接时，记录不会更新并离开编辑模式......它只是停留在编辑模式，不会发生任何错误。

所以，问题是......有谁知道带有 EnableViewstate 的 radGrid 是否甚至支持 AutomaticUpdates，所以网格中的更改将自动推送到它所绑定的数据集中？

有人会认为您可以阅读文档，但我一直无法找到明确的答案。

谢谢

* * *

```
<telerik:Radgrid id="grid" runat="server" AllowPaging="True" AllowSorting="True" AllowAutomaticUpdates="true" 
            AutoGenerateEditColumn="True" GridLines="None" >

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            Dim data As New DataGateway
            Dim ds As DataSet = data.GetEmployeesByProgram(Year:=2009, ProgramName:="Long Term Incentive Stock Program")
            Dim dt As DataTable = ds.Tables(0)
            ds.Tables(0).PrimaryKey = New DataColumn() {dt.Columns("EmployeeNum"), dt.Columns("ProgramName"), dt.Columns("Year")}
            Session("datasource") = ds
            With Me.grid
                .AllowAutomaticUpdates = True
                .AutoGenerateColumns = True
                .AllowSorting = True
                .AutoGenerateEditColumn = True
                .EnableViewState = True     'IS REQUIRED!!!
                Me.grid.MasterTableView.AllowAutomaticUpdates = True
                Me.grid.MasterTableView.EditMode = GridEditMode.InPlace
            End With
        End If
    End Sub

Private Sub grid_NeedDataSource(ByVal source As Object, ByVal e As Telerik.Web.UI.GridNeedDataSourceEventArgs) Handles grid.NeedDataSource
        Debug.WriteLine("NeedDataSource: " & e.RebindReason.ToString)
        Dim ds As DataSet = CType(Session("datasource"), DataSet)
        Me.grid.MasterTableView.DataKeyNames = New String() {"EmployeeNum", "ProgramName", "Year"}
        Me.grid.DataSource = ds

    End Sub 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T05:51:16.887

简而言之，这里有一个关键问题：

仅当您使用数据源控件绑定网格时，才支持“自动”操作。这*包括*ObjectDataSource，因此您可以将 DAL 与 ODS 一起使用，然后支持自动 upserts/updates/deletes。

直接绑定到数据表时，您必须手动处理更新。这是因为为 CRUD 操作提供“自动”逻辑的是数据源控件，而不是 RadGrid。幸运的是，如果这是您喜欢的路径，手动处理更新并不难。查看 Telerik.com 上的一些演示以获取示例：

[http://demos.telerik.com/aspnet-ajax/grid/examples/dataediting/editmodes/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/grid/examples/dataediting/editmodes/defaultcs.aspx)

如果需要，您也可以使用禁用 ViewState 的 RadGrid。最好的方法是使用 Grid 对客户端数据绑定的支持（尽管这确实需要您通过服务层公开 DAL）。在此处查看该方法的演示：

[http://demos.telerik.com/aspnet-ajax/grid/examples/client/insertupdatedelete/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/grid/examples/client/insertupdatedelete/defaultcs.aspx)

希望有帮助！-托德

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T15:34:10.847

Telerik 论坛已经回答了您的问题：

[http://www.telerik.com/community/forums/aspnet/grid/is-it-possible-to-do-automaticupdates-to-a-dataset.aspx](http://www.telerik.com/community/forums/aspnet/grid/is-it-possible-to-do-automaticupdates-to-a-dataset.aspx)

# c# - 优化 Visual Studio 解决方案构建 - 将 DLL 文件放在哪里？

> ID：488043
> 
> 赞同：5
> 
> 时间：2009-01-28T15:32:20.783
> 
> 标签：c#, visual-studio-2008, msbuild, build

我发现如果您没有在任何地方启用“本地复制”，那么包含许多项目的 C# 解决方案的构建时间会变得更快。我做了一些测试，似乎（至少对于我们的解决方案）我们可以通过删除“复制本地”将构建时间增加 2-3 倍。这可能意味着我们必须将库存储在某个公共目录中。

任何建议/最佳实践如何实现这一目标？请注意，我想保留对项目的引用，而不是对 DLL 的引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T16:22:34.787

我们将项目的输出目录重新定位为../../Debug（或../../Release）我们的库也放置在这些目录中。

我们将每个项目中的引用路径设置为相应的 Debug 或 Release 目录（此设置保留在用户文件中，因为它是绝对引用而不是相对引用）

我们将项目引用保留为项目引用，所有 dll 引用都具有复制本地错误和特定版本错误，除非它们是我们知道将在所有已部署机器上的 GAC 中的系统级 dll。

这可以在 IDE 中进行处理和手动构建，从命令行模拟脚本构建（使用 MSBuild）

不用于部署的测试项目不会将它们的输出定向到集中的 Debug|Release 目录，它们只是使用标准的默认位置（并且使用复制本地以避免锁定问题）

库版本可以通过自动构建过程替换 Debug 和 Release 目录中的 dll 来更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T16:32:44.040

如果您的应用程序分布在解决方案中，我建议构建到 ..\..\Build。（如果您只有一种解决方案，您可以考虑使用 ..\Build。）默认情况下，Visual Studio 会在其输出文件夹中获取参考文件。但是，在不使用 VS 的情况下使用 MSBuild 构建时，您必须将构建文件夹添加为参考路径，如下例所示：

```
 <Target Name="BuildApp">
    <MSBuild
        Projects="@(ProjectReference)"
        Targets="Rebuild"
        Properties="ReferencePath=..\..\Build;$(LibraryFolder)" >
    </MSBuild>
    <OnError ExecuteTargets="BuildFailed" />
  </Target> 
```

这个例子也把我带到了我的第二个论点。我认为您**不**应该将构建文件夹用作库文件夹，因为这可能会导致个别项目错误地覆盖库程序集，例如使用 Copy Local。你应该严格控制你的库版本，所以我建议你把它分开。（开发人员需要将此路径添加到 VS 中作为参考路径。）

您也可以按照[ShuggyCoUk 的建议](https://stackoverflow.com/questions/488043/optimizing-visual-studio-solution-build-where-to-put-dll-files/488272#488272)选择将 ..\..\Build 分成 ..\..\Release 和 ..\..\Debug 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T15:36:53.160

我喜欢在基于 Unix 的系统中常见的顶级 Bin Lib 文件夹设置，顺便说一句，迁移到这种类型的系统也将使您的发布工程师的生活更加轻松。只需将所有内容从一个文件夹中提取出来，安装程序的创建就大大简化了。然后DLL会进入bin..

# python - ZipFile 抱怨，有没有办法使用 zipfile 模块？

> ID：488054
> 
> 赞同：1
> 
> 时间：2009-01-28T15:34:11.777
> 
> 标签：python, zip, popen, zipfile

我正在尝试解压缩一些压缩后发送给我的彩信。问题是有时它有效，而另一些则无效。当它不起作用时，python zipfile 模块会抱怨并说它是一个错误的 zip 文件。但是使用 unix unzip 命令可以很好地解压缩 zipfile。

这就是我得到的

```
zippedfile = open('%stemp/tempfile.zip' % settings.MEDIA_ROOT, 'w+')
zippedfile.write(string)
z = zipfile.ZipFile(zippedfile) 
```

我正在使用 'w+' 并向其写入一个字符串，该字符串包含一个 zip 文件的 base64 解码字符串表示。

然后我喜欢这样：

```
filelist = z.infolist()  
images = []  

for f in filelist:  
    raw_mimetype = mimetypes.guess_type(f.filename)[0]  
    if raw_mimetype:  
        mimetype = raw_mimetype.split('/')[0]  
    else:  
        mimetype = 'unknown'  
    if mimetype == 'image':  
        images.append(f.filename) 
```

这样我就得到了 zip 文件中所有图像的列表。但这并不总是有效，因为 zipfile 模块抱怨某些文件。

有没有办法做到这一点，而不使用 zipfile 模块？

我可以以某种方式使用 unzip 命令解压缩而不是 zipfile，然后使用同一件事从存档中检索所有图像吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T15:37:03.240

在将压缩数据写入文件时，您很可能应该以二进制模式打开文件。也就是说，你应该使用

```
zippedfile = open('%stemp/tempfile.zip' % settings.MEDIA_ROOT, 'wb+') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T16:21:03.977

您可能必须关闭并重新打开文件，或者在写入文件后寻找文件的开头。

```
filename = '%stemp/tempfile.zip' % settings.MEDIA_ROOT
zippedfile = open(filename , 'wb+')
zippedfile.write(string)
zippedfile.close()
z = zipfile.ZipFile(filename,"r") 
```

你说字符串是base64解码的，但你没有显示任何解码它的代码——你确定它还没有编码吗？

```
data = string.decode('base64') 
```

# php - phpMyAdmin - 配置文件是否更改？

> ID：488060
> 
> 赞同：2
> 
> 时间：2009-01-28T15:34:50.280
> 
> 标签：php, mysql, linux, phpmyadmin, fedora

我刚刚在我的新 Fedora Core 10 专用服务器上安装了 phpMyAdmin。

我下载了 phpMyAdmin-3.1.2-english.tar.gz。我将其解压缩并将其放在此文件夹 /opt/phpMyAdmin-3.1.2-english 中，并在 /var/www/html 目录中创建了一个符号链接，以便我可以像这样访问它：[http://www.mydomainname .com/webdb](http://www.mydomainname.com/webdb)。

当我将浏览器指向该 URL 时，它要求我登录，我只能使用 localhost 作为用户名和空白密码登录。所以我想我会改变它并遵循一些建议改变这些行的网络教程：

```
$cfg['Servers'][$i]['auth_type'] = ‘http’; 
$cfg['Servers'][$i]['user'] = ‘USERNAME’;
$cfg['Servers'][$i]['password'] = ‘PASSWORD’; 
```

但是，这些行甚至在我的 config.inc.php 中都不存在！！！我之前已经完成了这个安装，我记得这些文件在那里但不是这个 isntall。

我尝试添加这些行，但这并没有什么不同。

phpMyAdmin 是否更改了他们的配置文件或我安装不正确？

感谢您的任何帮助！

## 编辑

我设法删除了那个并使用“yum install phpMyAdmin”，这里的配置文件工作正常！:)

但是，我仍然无法使用我在 config.inc.php 中建议的密码和用户名访问 phpMyAdmin。这是否意味着我建议的用户名和密码是 config.inc.php 与 MySQL 服务器的用户名和密码不符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T16:12:27.333

会设置

```
$cfg['Servers'][$i]['auth_type'] = 'config'; 
```

代替

```
$cfg['Servers'][$i]['auth_type'] = ‘http’; 
```

帮助？

有关详细信息，请参阅[http://www.un4given.nl/phpMyAdmin/Documentation.html#config](http://www.un4given.nl/phpMyAdmin/Documentation.html#config)。

# c# - 在 ASP.NET MVC 中向控制器传递多个参数；此外，在 LINQ-to-SQL 中生成动态查询

> ID：488061
> 
> 赞同：27
> 
> 时间：2009-01-28T15:34:50.840
> 
> 标签：c#, sql, asp.net-mvc, linq, controller

我正在开发一个基本的问题管理系统以学习 ASP.NET MVC。我已经把它启动并运行到一个相当不错的水平，但我遇到了一个问题。

我有一个名为 Issue 的控制器，带有一个名为 Open 的视图。/Issue/Open 列出了当前记录在系统上的所有未解决的问题。我已经定义了这样的路线：

```
 routes.MapRoute( 
        "OpenSort",                                                         // Route name
        "Issue/Open/{sort}",                                                // URL with parameters
        new { controller = "Issue", action = "Open", sort = "TimeLogged" }  // Parameter defaults
    ); 
```

到目前为止，这工作正常，在 IssueController.cs 中使用以下代码：

```
public ActionResult Open(string sort)
{            
    var Issues = from i in db.Issues where i.Status == "Open" orderby i.TimeLogged ascending select i;

    switch (sort)
    {
        case "ID":
            Issues = from i in db.Issues where i.Status == "Open" orderby i.ID ascending select i;
            break;

        case "TimeLogged":
            goto default;

        case "Technician":
            Issues = from i in db.Issues where i.Status == "Open" orderby i.Technician ascending select i;
            break;

        case "Customer":
            Issues = from i in db.Issues where i.Status == "Open" orderby i.Customer ascending select i;
            break;

        case "Category":
            Issues = from i in db.Issues where i.Status == "Open" orderby i.Category ascending select i;
            break;

        case "Priority":
            Issues = from i in db.Issues where i.Status == "Open" orderby i.Priority ascending select i;
            break;

        case "Status":
            Issues = from i in db.Issues where i.Status == "Open" orderby i.Status ascending select i;
            break;

        default:
            break;
    }            

    ViewData["Title"] = "Open Issues";
    ViewData["SortID"] = sort.ToString();

    return View(Issues.ToList());
} 
```

这工作正常（虽然，我想知道是否有比开关更好的方法来处理我的查询定义？）但现在我希望能够在 Open Issues 视图上做两件事：

1.  按任何标题排序 - 好的
2.  过滤某些标题（技术人员、客户、类别、优先级、状态） - ??

我不知道如何将两个参数传递给控制器​​，以便我可以组织我的查询。我也刚刚意识到，除非我弄清楚如何动态生成我的查询，否则我将需要（排序选项的数量）*（过滤器选项的数量）在我的开关中。

啊，谁能指出我正确的方向？干杯!

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-28T15:47:09.023

1.  从路线中删除排序。只需使用不带参数的路由。
2.  将查询字符串参数添加到用于排序、过滤等的查询中。因此您的查询将如下所示：

[http://example.com/Issue/Open?sort=ID&filter=foo](http://example.com/Issue/Open?sort=ID&filter=foo)

```
public ActionResult Open(string sort, string filter) 
```

MVC 框架将从查询字符串参数中填充参数。确保对这些可能未填写的任何查询字符串参数参数使用可空类型（如字符串）。

我实际上认为这是编写 URL 的“更正确”的方式。URL 本身标识资源（未解决的问题）；查询字符串参数自定义如何显示资源。

就查询数量而言，请记住您不必一次构建整个查询。您可以使用 .OrderBy 扩展方法重新排序现有的 IQueryable<T>，与 .Where 类似。

```
var Issues = from i in db.Issues where i.Status == "Open" select i;

switch (sort)
{
    case "ID":
        Issues = Issues.OrderBy(i => i.ID);
        break;

    // [...]

    default:
        Issues = Issues.OrderBy(i => i.TimeLogged);
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-29T03:17:48.050

如果您期望任意数量的参数，您可以这样做。

```
 public ActionResult Open(){            
   string[] keys = Request.QueryString.AllKeys;
   Dictionary queryParams = new Dictionary();
   foreach (string key in keys)
   {
     queryParams[key] = Request.QueryString[key];
   }
   string sort = queryParams["sort"];
   ... 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-18T16:55:03.417

这应该是对kimsks回答的评论，但由于某种原因，评论需要我经过审查，所以我必须将其发布在错误的地方。

处理任意数量的查询字符串参数的更好方法是使用`ActionFilter`这样的：

```
public class QueryStringFilterAttribute : ActionFilterAttribute
{
    public string ParameterName { get; private set; }

    public QueryStringFilterAttribute(string parameterName)
    {
        if(string.IsNullOrEmpty(parameterName))
            throw new ArgumentException("ParameterName is required.");
        ParameterName = parameterName;
    }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var qs = new FormCollection(filterContext.HttpContext.Request.QueryString);

        filterContext.ActionParameters[ParameterName] = qs;

        base.OnActionExecuting(filterContext);
    }
} 
```

现在您可以像这样将 an 属性添加到您的操作`[QueryStringFilter("attributes")]`中，它会将查询字符串值作为`FormCollection`. 这样你的动作就更容易测试了，因为它不再依赖于`Request`单例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-28T11:46:56.947

您可以使用 Dynamic Linq 而不是开关，它可以让您说：

```
Issues = Issues.OrderBy("Status"); 
```

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-09T10:36:49.767

请查看下面描述所有过程的帖子 [http://www.c-sharpcorner.com/UploadFile/4b0136/editing-multiple-records-using-model-binding-in-mvc/](http://www.c-sharpcorner.com/UploadFile/4b0136/editing-multiple-records-using-model-binding-in-mvc/)

# sql - 在 T-SQL 语句中合并结果

> ID：488062
> 
> 赞同：0
> 
> 时间：2009-01-28T15:34:53.367
> 
> 标签：sql, sql-server, tsql

我必须查询：

```
select id, name, num from pending  

id, name, num
1, first, 1  
3, third, 12 
```

```
select id, name, num from completed

id, name, num
1, first, 100
2, second, 20 
```

我希望输出使用 T-SQL 将这些组合起来，可能就像一个数据透视表。

```
 id, name, pending, completed, total
1, first, 1, 100, 101
2, second, null, 20, 20
3, third, 12, null, 12 
```

这个怎么写？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T15:40:37.570

不需要一个支点。

```
SELECT
    COALESCE(p.id, c.id),
    COALESCE(p.name, c.name),
    p.num AS pending,
    c.num AS completed,
    COALESCE (p.num, 0) + COALESCE (c.num, 0) AS total
FROM
    pending p
    FULL OUTER JOIN
    completed c ON p.id = c.id 
```

COALESCE 是 ANSI SQL，但你也可以使用 ISNULL

# sql-server - SQL Server - 将表数据复制到另一台服务器的最快方法是什么？

> ID：488066
> 
> 赞同：1
> 
> 时间：2009-01-28T15:35:29.093
> 
> 标签：sql-server, sql-server-2005

我在 WAN 上的不同位置有两台 MS SQL 服务器。目前我使用 LINKED 服务器将表数据从一个复制到另一个，但性能很差。复制一张 40 字段、800 行的表大约需要 10 分钟。

在不同的 SQL 服务器上复制/替换表数据的最佳“简单”方法是什么。该解决方案必须是可编写脚本的，因为它需要每小时发生一次。主服务器是 SQL 2000，链接服务器是 SQL 2005。

我感谢提供的任何帮助。

安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T15:44:59.917

在一台服务器（主服务器）上写入，例如导出到文件，然后使用 bulkinsert 命令行导入文件。这两种解决方案都可以通过命令行和脚本轻松使用！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T15:59:25.567

听起来您最好的方法是让网络人员查看您的 WAN 链接。

除非您有一些二进制字段，否则 40 个字段 * 800 行并不等同于大量数据。

您需要问自己的三个问题是：数据有多大？你的管道有多大？您实际上可以使用多少管道？

例如，如果您有一个 OC3 管道，但它的容量为 99%，那么您使用什么机制来传输数据并不重要。它会很慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T16:55:07.823

我会在 2005 盒子上使用 SSIS 从 2000 盒子中提取数据。然后安排 SSIS 包每小时运行一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T15:42:23.227

我不知道您到底想要实现什么，但是复制不是一种选择吗？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-28T15:47:55.230

使用导入/导出向导将表从一台服务器复制到另一台服务器。这是最快的方法。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-28T15:58:52.727

将要复制的表放在单独的文件组中，然后将数据库与原始服务器分离，复制文件并重新附加到两台服务器上。您可以使用 Windows 中的卷影复制功能从原始服务器获取快照。

# sharepoint - SharePoint SPListItemCollection ReorderItems

> ID：488068
> 
> 赞同：3
> 
> 时间：2009-01-28T15:35:56.783
> 
> 标签：sharepoint, sharepoint-2007

有谁知道如何使用 SPListItemCollection ReorderItems 方法？我似乎找不到有关此方法的足够文档。我想要做的是按日期降序排列列表。我不确定所需的值是什么， http: [//msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitemcollection.reorderitems.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitemcollection.reorderitems.aspx)，感谢所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T15:46:49.570

您所说的链接为您提供了所需的所有信息。您可以从重构中获得更多信息：

ReorderPage 类的 BtnSave_Click 事件中的 Microsoft.SharePoint.ApplicationPages.dll。

可能，您遇到的问题与相关列表需要将允许排序设置为 true 的事实有关。谷歌这个，或者如果仍然有效，请检查[这个 url 。](http://webborg.blogspot.com/2008/03/reordering-items-in-data-view.html)

# c# - 具有相同参数签名的 C# 构造函数

> ID：488071
> 
> 赞同：31
> 
> 时间：2009-01-28T15:36:31.400
> 
> 标签：c#, .net

我相信这一定是一个普遍的问题。我有一个在理想世界中会有以下构造函数的类

```
public Thing(string connectionString)

public Thing(string fileName) 
```

显然这是不允许的，因为签名是相同的。有人知道这个问题的优雅解决方案吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-01-28T15:39:33.967

您可以使用命名的构造函数习语：

```
public class Thing
{
    private string connectionString;

    private string filename;

    private Thing()
    {
        /* Make this private to clear things up */
    }

    public static Thing WithConnection(string connectionString)
    {
        var thing = new Thing();
        thing.connectionString = connectionString;
        return thing;
    }

    public static Thing WithFilename(string filename)
    {
        var thing = new Thing();
        thing.filename = filename;
        return thing;
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-28T15:45:32.613

好吧，有几个潜力 - 什么被认为是优雅的取决于使用场景。

*   静态工厂方法，调用私有构造函数。

    ```
    static Thing thingWithFileName(string fileName) 
    ```

*   为其中一个参数创建不同的类型，或使用内置函数。您可以使用 System.IO.FileStream，而不是字符串文件名。这也更安全，因为我不会意外地将错误的数据传递到错误的静态方法或字段中。

*   将第二个参数传递给构造函数，可以是枚举或布尔值，指示第一个参数的意图

    ```
    enum ThingType { FileName, ConnectionString }
    Thing(string str, ThingType type) ... 
    ```

*   子类事物，所以你有一个 ConnectionTypeThing 和一个 FileBackedThing

*   完全消除事物的连接，并提供预先连接的数据源。所以你最终得到

    ```
    Thing(InputStream dataSource) 
    ```

    或类似的东西。

我的“优雅”资金用于第一个或第二个建议，但我需要更多背景才能对任何选择感到满意。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-28T15:39:44.997

您可以将所有构造函数设为私有并创建工厂方法（类上的静态方法，如 CreateFromConnectionString()）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-28T15:42:05.320

这些实际上对我来说似乎是不同的“事物”，要么是与文件关联的类，要么是与数据库关联的类。我会定义一个接口，然后为每个接口分别实现。使用工厂生成正确的实现。

您可能需要更改设计的提示是，您的方法是否必须在执行所需操作之前决定它们是使用文件还是数据库。如果是这种情况，那么分成不同的班级将是我要走的路。

```
public interface IThing
{
   ... methods to do the things that Things do
}

public class FileThing : IThing
{
  ... file-based methods
}

public class DatabaseThing : IThing
{
  ... database-based methods
}

public static class ThingFactory
{
     public IThing GetFileThing( string name )
     {
         return new FileThing( name );
     }

     public IThing GetDatabaseThing( string connectionString )
     {
         return new DatabaseThing( connectionString );
     }
} 
```

如果您有共同的行为，您也可以定义一个包含默认/共同行为的抽象类，并从它派生而不是/除了接口之外。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T15:39:16.463

创建两个公共属性 ConnectionString 和 FileName，然后使用它们来填充您的对象。

在 C# 中，您可以使用对象初始化器。像这样：

```
Thing thing = new Thing{FileName = "abc", ConnectionString = "123"}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T15:41:22.077

这里有一些解决方法。

有一个接受连接字符串的构造函数，然后在接受文件名的类上有一个工厂方法。像这样的东西：

```
public static Thing CreateThing(string fileName) 
```

这个方法可以调用一个私有参数少的构造函数，你可以从那里得到它。

另一种选择是拥有一个包含两种类型的枚举。文件名和连接字符串。然后只有一个带有字符串的构造函数和枚举。然后根据枚举，您可以确定要走的路。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T15:43:08.080

我喜欢静态构造函数：

```
class Thing
{
   public static Thing NewConnection(string connectionString)
   {
       return new Thing(connectionString, true);
   }

   public static Thing NewFile(string fileName);
   {
        return new Thing(fileName, false);
   }
}
.
.
.
{
    var myObj = Thing.NewConnection("connect=foo");
    var Obj2 = Thing.NewFile("myFile.txt");
} 
```

（未显示，但直截了当，Thing-Constructor 的实现带有一个额外的布尔参数）。

# perl - 如何在 Perl 中将小文本文件的内容读入标量？

> ID：488081
> 
> 赞同：10
> 
> 时间：2009-01-28T15:38:22.720
> 
> 标签：perl, file-io

我有一个小文本文件，我想将它读入一个标量变量，就像它在文件中一样（保留行分隔符和其他空格）。

Python中的等价物类似于

```
buffer = ""

try:
    file = open("fileName", 'rU')
    try:
        buffer += file.read()
    finally:
        file.close()
except IOError:
    buffer += "The file could not be opened." 
```

这是为了简单地在网页上重新显示文件的内容，这就是我的错误消息进入我的文件缓冲区的原因。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-28T15:50:23.057

来自[Perl 食谱](http://oreilly.com/catalog/cookbook/chapter/ch08.html)：

```
my $filename = 'file.txt';
open( FILE, '<', $filename ) or die 'Could not open file:  ' . $!;

undef $/;
my $whole_file = <FILE>; 
```

我会本地化更改：

```
my $whole_file = '';
{
    local $/;
    $whole_file = <FILE>;
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-28T15:46:04.750

作为 Alex 所说的替代方案，您可以安装[File](http://www.cpan.org/modules/INSTALL.html) [::Slurp](http://search.cpan.org/dist/File-Slurp/lib/File/Slurp.pm)模块（`cpan -i File::Slurp`从命令行）并使用它：

```
use File::Slurp;
# Read data into a variable
my $buffer = read_file("fileName");
# or read data into an array
my @buffer = read_file("fileName"); 
```

请注意， this `die`s（嗯... [`croak`](http://perldoc.perl.org/Carp.html)s，但这只是从模块中调用 die 的正确方法）出现错误，因此您可能需要在 eval 块中运行它以捕获任何错误。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-28T21:02:43.643

如果我附近没有[Slurp](http://search.cpan.org/dist/Slurp/)或[Perl6::Slurp](http://search.cpan.org/dist/Perl6-Slurp/)，那么我通常会选择....

```
open my $fh, '<', 'file.txt' or die $!;

my $whole_file = do { local $/; <$fh> }; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T15:42:07.440

您可以执行以下操作：

```
$data_file="somefile.txt";
open(DAT, $data_file);
@file_data = <DAT>;
close(DAT); 
```

这将为您提供数组中的文件内容，您可以将其用于您想要的任何内容，例如，如果您想要每一行，您可以执行以下操作：

```
foreach $LINE (@file_data)
{
    dosomethingwithline($LINE);
} 
```

对于完整的使用示例：

```
my $result;
$data_file = "somefile.txt";
my $opened = open(DAT, $data_file);
if (!$opened)
{
    $result = "Error.";
}
else
{
    @lines = <DAT>;
    foreach $LINE (@lines)
    {
        $result .= $LINE;
    }
    close(DAT);
} 
```

然后，您可以根据`$result`需要使用。注意：此代码未经测试，但它应该给你一个想法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T16:04:52.357

这里讨论了读取文件的各种[方法](http://search.cpan.org/~drolsky/File-Slurp/extras/slurp_article.pod)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T13:38:35.263

我没有足够的声誉发表评论，所以我很抱歉再次发帖。

@Harold Bamford：对于 Perl 程序员来说，$/**不**应该是一个晦涩的变量。初学者可能不知道它，但他或她应该学习它。由于上面 hackingwords 链接的文章中所述的原因，join 方法是一个糟糕的选择。以下是文章的相关引述：

> 这不必要地将输入文件分成几行（join 为 提供了一个列表上下文），然后再次连接这些行。这个习语的原始编码器显然从未读过 perlvar 并学会了如何使用 $/ 来允许标量 slurping。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-27T20:45:44.917

我会像这样调整 draegtun 的答案，以使其完全按照要求进行操作：

```
my $buffer;
if ( open my $fh, '<', 'fileName' ) {
    $buffer = do { local $/; <$fh> };
    close $fh;
} else {
    $buffer = 'The file could not be opened.';
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T16:05:13.743

只需将所有行连接成一个字符串：

```
open(F, $file) or die $!;
my $content = join("", <F>); 
close F; 
```

（以前建议使用 join "\n" 但这会添加额外的换行符。每行在读取时已经在其末尾有一个换行符。）

# mysql - 可以在 MySQL 中获取驱动视图的代码吗？

> ID：488084
> 
> 赞同：2
> 
> 时间：2009-01-28T15:38:30.473
> 
> 标签：mysql

好吧，我有点白痴，我写了一个视图然后不小心关闭了窗口，所以现在我没有为它提供动力的查询副本。语法是：

```
 CREATE VIEW view_name AS SELECT something FROM somewhere 
```

有没有办法让“从某处选择某些东西”或者我必须从内存中重写它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T15:48:01.813

试试这个：

```
SHOW CREATE VIEW view_name; 
```

# iphone - SQLite 3：海量数据加载问题：错误 14 未找到数据库

> ID：488085
> 
> 赞同：1
> 
> 时间：2009-01-28T15:39:03.657
> 
> 标签：iphone, sql, sqlite

我有一个 iPhone 应用程序，它是一个数据加载工具，用于使用将在单独的应用程序中提供的数据预填充数据库。当我启动程序时，我正在从 XML 文件中读取数据并将记录插入到数据库中。

每次我点击列表中的第 247 条记录时，数据库都会返回错误 14 database not found。如果我停止程序，从刚刚插入的 XML 文件中删除 247 个条目，然后我再次重新启动程序......同样的事情会发生。接下来的 247 条记录将被插入，然后出现错误 14。

我有超过 30,000 条记录要加载。一次加载这 247 条记录并不是一个好的选择。

关于什么是错的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T13:15:09.127

DB2 在其 IMPORT 和 LOAD 命令中具有允许提交级别的功能。这可能不是最好的答案，但请查看文档以查看您是否有办法每 200 行左右提交一次。这种方式是免提的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T16:00:40.010

我不知道那里出了什么问题，但也许您可以每 200 条记录自动关闭并重新打开数据库连接以解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T16:27:06.587

您如何管理交易？您可能不想在单个块中插入所有内容，但您也不想将每条记录添加到单独的块中。

# iphone - iPhone GPS 开发 - 提示 + 技巧

> ID：488088
> 
> 赞同：18
> 
> 时间：2009-01-28T15:39:28.243
> 
> 标签：iphone, objective-c, cocoa-touch, gps

我正在寻找一些反馈、博客链接等，为 iPhone GPS 开发提供一些提示和技巧。我已经阅读并理解了 API，我已经启动并运行了我的演示应用程序等，但我在 iphone 上遇到了一些 gps 的“怪癖”。例如，当您的 iPhone 进入“省电”模式时，您收到的位置更新似乎要少得多。我读过你可以通过在应用程序中播放音乐来解决这个问题[不确定这是否属实]。

看来，要制作一个合理的计步器，您应该过滤掉水平精度小于 20 米的任何读数。这听起来对吗？

网络上有没有针对 iphone gps gotchas 的清单？

提前致谢。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-28T17:21:23.543

我不知道任何具体的列表，但您应该记住以下几点：

*   您没有进行 GPS 查找。您正在执行核心位置查找。核心位置可能会或可能不会从 GPS 获取信息。很多人仍然使用没有 GPS 的 3g 之前的 iPhone，即使在 3g 手机上，GPS 在许多情况下也可能无法使用（例如，如果该人在室内）。在这些情况下，手机将尝试根据手机信号塔进行三角测量，Core Location 将返回结果。它会比 GPS 精确得多。
*   核心位置将缓存数据。它为您的应用程序提供的第一个读数可能是旧读数，这可能准确也可能不准确，具体取决于手机是否移动。确保检查任何位置的时间戳，看看它是否来自您的应用程序启动之前。
*   我不知道您所说的“省电”模式是什么意思，但是如果您正在考虑屏幕何时锁定/关闭，那么如果您的应用程序仍在运行，这不会阻止 Core Location 运行。相反，如果您在使用 Core Location 的应用程序运行时锁定手机，则很容易以比预期更快的速度耗尽手机的电池电量，因为手机将在新的位置数据可用时继续更新应用程序。您可以通过侦听 UIApplicationWillResignActiveNotification 来检测屏幕锁定和 UIApplicationDidBecomeActiveNotification 来检测解锁，从而在您的应用程序中避免这种情况。
*   获得更高精确度的结果需要更多时间，因为等待的时间越长，结果就越好，直至达到极限。如果您决定需要在 N 米内，请考虑用户可能需要站在那里等待手机返回其位置的时间。

20 米是否足够准确，只有您可以回答，具体取决于您期望应用程序的使用方式。测试应用程序，看看它是否按照您希望的方式工作。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-30T07:13:01.567

汤姆有一个很好的答案（我想特别指出第一个值的通常返回可能是一个较旧的缓存位置）但我还有一些东西要添加：

*   如果您想强制位置管理器至少再向您发布一次位置更新，您可以告诉位置管理器停止并重新开始。
*   如果您不知道，CLLocation 中有一些方便的方法可以为您提供两个位置之间的距离。
*   正如文档所述，您应该实现 locationManager:didFailWithError: 即使您不必这样做（如果只是暂时停止位置管理器更新）。
*   彻底测试用户不允许为您的应用程序更新位置的场景！
*   非常非常罕见地，您可能会得到无序的更新（即，您会获得更准确的位置，然后是较早日期的稍微不太准确的位置）
*   模拟器将为您提供位置更新，但始终会将您的位置报告为 Apple 总部。

# c# - 同一属性/类/上的多个 XmlElement 属性

> ID：488102
> 
> 赞同：1
> 
> 时间：2009-01-28T15:42:16.303
> 
> 标签：c#, .net, web-services, attributes, asmx

我将几个旧的 Web 服务和当前的 Web 服务放入同一个后端。

但我必须保持旧的 Web 服务与旧界面兼容。

所以我的问题：

有没有办法可以设置多个属性，例如，一个属性？

像这样：

```
[XmlElement("AvailableFrom",... what I need...)]
[XmlElement("Available",... what I need...)]
public DateTime AvailableFrom{get; set;} 
```

一种解决方案是创建额外的属性，但我真的不喜欢代码膨胀。

```
 private DateTime _availableFrom;

    [XmlElement("AvailableFrom")] 
    public DateTime AvailableFrom
    {
        get
        {
            return _availableFrom;
        }
        set
        {
            _availableFrom = value;
        }
    }

    [XmlElement("Available")] 
    public DateTime Available
    {
        get
        {
            return _availableFrom;   
        }
        set
        {
            _availableFrom = value;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T14:30:50.917

我认为你没有简单的方法。

序列化将失败，因为一个属性可能有两个不同的值。哪一个比正确的？

也许我的一些想法可以帮助你...

1) 创建一个 XSLT 将当前 xml 转换为旧格式并返回。在 XSLT 中，您能够以最佳方式处理不同的值。

或者

2) 不要使用序列化属性。为它编写你自己的方法并在那里处理不同的值。

或者

3）使用您的类作为基础并创建两个子类。用覆盖和序列化属性填充两个子类。

# sql - 使用 Oracle 和 sql server 进行分页以及通用分页方法

> ID：488108
> 
> 赞同：7
> 
> 时间：2009-01-28T15:44:37.793
> 
> 标签：sql, sql-server, oracle

我想在 gridview 或 html 表中实现分页，我将使用 ajax 填充。我应该如何编写查询来支持分页？例如，如果 pagesize 为 20，并且当用户单击第 3 页时，表格上必须显示 41 到 60 之间的行。起初我可以获取所有记录并将它们放入缓存中，但我认为这是错误的方式。因为数据可能非常庞大，并且数据可能会从其他会话中更改。那么我该如何实现呢？有没有通用的方法（适用于所有数据库）？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-06T01:27:12.257

正如其他人所建议的，您可以在 Oracle 中使用 rownum 。不过这有点棘手，您必须将查询嵌套两次。

例如，对查询进行分页

```
select first_name from some_table order by first_name 
```

你需要像这样嵌套它

```
select first_name from
  (select rownum as rn, first_name from
    (select first_name from some_table order by first_name)
  ) where rn > 100  and rn <= 200 
```

原因是rownum 是*在*where 子句之后和order by 子句*之前确定的。*要了解我的意思，您可以查询

```
select rownum,first_name from some_table order by first_name 
```

你可能会得到

```
4   Diane
2   Norm
3   Sam
1   Woody 
```

这是因为 oracle 评估 where 子句（在这种情况下没有），然后分配 rownums，然后按 first_name 对结果进行排序。您必须嵌套查询，以便它使用在对行进行排序*后分配的 rownum。*

第二个嵌套与 rownum 在 where 条件下的处理方式有关。基本上，如果您查询“where rownum > 100”，那么您不会得到任何结果。这是一个鸡和蛋的事情，它在找到 rownum > 100 之前无法返回任何行，但由于它不返回任何行，它永远不会增加 rownum，所以它永远不会计数到 100。呃。第二级嵌套解决了这个问题。请注意，此时它必须为 rownum 列设置别名。

最后，您的 order by 子句必须使查询具有确定性。例如，如果您有 John Doe 和 John Smith，并且您仅按名字排序，那么两者可以将位置从一次查询执行切换到下一次执行。

这里有文章[http://www.oracle.com/technology/oramag/oracle/06-sep/o56asktom.html](http://www.oracle.com/technology/oramag/oracle/06-sep/o56asktom.html) 和这里[http://www.oracle.com/technology/oramag/oracle/07-jan/o17asktom .html](http://www.oracle.com/technology/oramag/oracle/07-jan/o17asktom.html)。现在我看到我的帖子有多长，我可能应该发布这些链接......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T16:25:49.957

不幸的是，限制查询返回的行范围的方法因一个 DBMS 而异：Oracle 使用 ROWNUM（请参阅 ocdecio 的答案），但 ROWNUM 在 SQL Server 中不起作用。

也许您可以使用一个函数来封装这些差异，该函数采用给定的 SQL 语句和第一行和最后一行编号，并为目标 DBMS 生成适当的 paginatd SQL - 即类似于：

```
sql = paginated ('select empno, ename from emp where job = ?', 101, 150) 
```

这将返回

```
'select * from (select v.*, ROWNUM rn from ('
 + theSql
 + ') v where rownum < 150) where rn >= 101' 
```

用于 Oracle 和其他用于 SQL Server 的东西。

但是，请注意，Oracle 解决方案正在将新列 RN 添加到您需要处理的结果中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-23T16:57:19.743

```
select * 
  from ( select /*+ FIRST_ROWS(n) */   a.*,
      ROWNUM rnum 
      from ( your_query_goes_here, 
      with order by ) a 
      where ROWNUM <= 
      :MAX_ROW_TO_FETCH ) 
where rnum  >= :MIN_ROW_TO_FETCH; 
```

第 1 步：您的查询与 order by

第2步：`select a.*, ROWNUM rnum from ()a where ROWNUM <=:MAX_ROW_TO_FETCH`

第 3 步：`select * from ( ) where rnum >= :MIN_ROW_TO_FETCH;` 将 1 放入 2 和 2 放入 3

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T17:47:06.830

我相信两者都有一个 ROWNUM 分析函数。使用它，你将是相同的。

在甲骨文它在[这里](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions137.htm#i86310)

ROW_NUMBER

是的，刚刚验证了 ROW_NUMBER 在两者中是相同的函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T23:50:18.673

“因为……数据可以从其他会话中更改。” 你想为此发生什么？

例如，用户在 10:30 获取“最新”十行。

在 10:31，添加了 3 行新行（因此用户查看的这 10 行不再是最新的）。

在 10:32，用户请求然后“下一个”十个条目。

您是否希望新系列包括从 8/9/10 下降到 11/12/13 的那三个？如果没有，在 Oracle 中，您可以选择 10:30 时的数据

```
SELECT * FROM table_1 as of timestamp (timestamp '2009-01-29 10:30:00'); 
```

您仍然需要 row_number 逻辑，例如

```
 select * from
    (SELECT a.*, row_number() over (order by hire_date) rn
    FROM hr.employees as of timestamp (timestamp '2009-01-29 10:30:00') a)
 where rn between 10 and 19 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-01T07:11:25.780

没有统一的方法来确保跨各种 RDBMS 产品进行分页。Oracle 为您提供了 rownum，您可以在 where 子句中使用它，例如：

```
where rownum < 1000 
```

SQL Server 为您提供 row_id( ) 函数，该函数的使用类似于 Oracle 的 rownum。但是，在 SQL Server 2005 之前，row_id( ) 不可用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T21:02:37.777

如果预期的数据集很大，我建议创建一个临时表、视图或快照（物化视图）来存储查询结果 + 使用 ROWNUM 或 ROW_NUMBER 分析函数检索的行号。之后，您可以使用行号范围简单地查询此临时存储。基本上，您需要将实际数据获取与分页分开。

# flash - ActionScript 3.0 预加载器问题

> ID：488110
> 
> 赞同：0
> 
> 时间：2009-01-28T15:44:52.770
> 
> 标签：flash, actionscript-3, preloader

首先，我非常感谢任何帮助，一如既往....

我从[Jarrod 的 Advanced AS3 Preloader Tutorail](http://www.portentinteractive.com/blog/advanced-actionscript-3-preloa.htm)创建了一个预加载器。我在别处搜索，这似乎是我最好的选择，因为它是我理解的唯一一个不需要 2 个 SWF 文件的文件。

我的代码实际上属于 2 个类，我的**预加载**器类和我的**程序**类。我的问题是预加载器只加载我闪存中的图形，而不是实际启动程序类。我的问题是*如何让我的预加载启动程序类？*这两个文件的完整代码如下。

**预加载器.as**

```
package {
    import flash.display.*;
    import flash.text.*;
    import flash.events.*;
    import fl.containers.ScrollPane;
    import flash.filters.*;

    public class Preloader extends MovieClip {
        public static  const ENTRY_FRAME:Number=3;
        public static  const DOCUMENT_CLASS:String='Program';
        public var myText:TextField;
        public var myFormat:TextFormat;
        private var progressBar:Sprite;
        private var progressText:TextField;
        public function Preloader() {

            stop();
            progressBar = getChildByName("loadbar_mc") as Sprite;
            progressText = getChildByName("loading_txt") as TextField;

            progressBar.scaleX = 0;

            myFormat = new TextFormat();
            myFormat.font="Helvetica";
            myFormat.color = 0x000000;
            myFormat.size = 24;

            loaderInfo.addEventListener(Event.INIT, initHandler);
            loaderInfo.addEventListener(ProgressEvent.PROGRESS, progressHandler);
            loaderInfo.addEventListener(Event.COMPLETE, completeHandler);
            loaderInfo.addEventListener(IOErrorEvent.IO_ERROR, errorHandler);
        }
        private function initHandler(event:Event):void {
            progressBar.scaleX = 0;
            progressText.text = "Loading 0%";

        }
        private function progressHandler(event:ProgressEvent):void {
            var loaded:uint = event.bytesLoaded;
            var total:uint = event.bytesTotal;

            var percentLoaded:Number = Math.round((loaded/total) * 50);
            progressBar.scaleX = loaded/total;
            progressText.text = "Loading " + percentLoaded + "%";

        }
        private function completeHandler(event:Event):void {
            play();
            addEventListener(Event.ENTER_FRAME, enterFrameHandler);

        }
        private function enterFrameHandler(event:Event):void {
            if (currentFrame >= Preloader.ENTRY_FRAME) {
                removeEventListener(Event.ENTER_FRAME, enterFrameHandler);
                stop();
                main();

            }

        }
        private function errorHandler(event:IOErrorEvent):void {
            myText.text = ("Sorry, there was an error. " + event);
            myText.setTextFormat(myFormat);

        }
        private function main():void {

            var programClass:Class = loaderInfo.applicationDomain.getDefinition(Preloader.DOCUMENT_CLASS) as Class;
            var program:Sprite = new programClass() as Sprite;

            addChild(program);

        }

    }
} 
```

**程序.as**

```
package {
    import flash.display.*;
    import flash.events.*;
    import flash.filters.*;
    import flash.text.*;
    import fl.controls.TextInput;
    import fl.transitions.Tween;
    import fl.transitions.easing.*;
    import fl.containers.ScrollPane;
    import flash.geom.Rectangle;
    import fl.controls.Label;

    public class Program extends Sprite {
        public function Program() {
            //define variable
            var startX:Number;
            var startY:Number;
            var counter:Number = 0;
            var intMessages:Number = 550;
            var limit:Number = 10;
            var intBoardSize:Number = 476*(Math.round(intMessages/15)+1);
            var intMessageMinX:Number = 35;
            var intMessageMaxX:Number = intBoardSize-99;
            var intMessageMinY:Number = 50;
            var intMessageMaxY:Number = 310;
            var activeGloveName:String = ""
            var intDegreeHigh:Number = 45;
            var intDegreeLow:Number = -45;
            var newGlove:mcGlove;

            //create objects
            var myGlove:mcGlove = new mcGlove();
            var showGlove:mcGlove = new mcGlove
            var mcglovetarget:mcGloveTarget = new mcGloveTarget();
            var myDropShadowFilterSmall = new DropShadowFilter (2,45,0x000000,0.65,3,3,2,3,false,false,false);
            var myDropShadowFilterDown = new DropShadowFilter (3,45,0x000000,0.65,5,5,2,3,false,false,false);
            var myDropShadowFilterUp = new DropShadowFilter (5,45,0x000000,0.65,7,7,2,3,false,false,false);
            var topShadow = new DropShadowFilter (3,90,0x000000,0.35,8,8,2,3,false,false,false);
            var pinkline:Sprite = new Sprite();
            var searchBox:Sprite = new Sprite();
            var txtSearchBox:TextInput = new TextInput();
            var sSearchBox_Label:String = "Go to glove #";
            var messageFormat:TextFormat = new TextFormat();
            var messageTextField:Label = new Label();
            var searchBoxLFormat:TextFormat = new TextFormat();
            var txtSearchBox_Label:TextField = new TextField();
            var SearchBoxBg:Sprite = new Sprite();
            var topShadowBox:Sprite = new Sprite();
            var searchButton:searchBtn = new searchBtn();
            var alertRect:Rectangle = new Rectangle(0,0,848,393);
            var errorMessage:AlertBox = new AlertBox(alertRect);
            var holder:MovieClip = new MovieClip();
            var aMessages:Array = new Array();

            //Create a glove for each message
            for (var gloveCount = 0; gloveCount < intMessages; gloveCount++){
                aMessages[gloveCount] = new mcGlove();
                aMessages[gloveCount] = createMessage(aMessages[gloveCount], gloveCount, gloveCount);
            }

            var scrollPane:ScrollPane = new ScrollPane();
            scrollPane.verticalScrollPolicy = "false";
            scrollPane.move(374, 0);
            scrollPane.setSize(476, 370);
            scrollPane.horizontalLineScrollSize = 120;

            topShadowBox.graphics.beginFill(0x333333);
            topShadowBox.graphics.drawRect(0,0,870,5);
            topShadowBox.x = -10;
            topShadowBox.y = -5;
            topShadowBox.filters = [topShadow];

            pinkline.graphics.beginFill(0xDB9195);
            pinkline.graphics.drawRect(0,0,476,2);
            pinkline.x = 374;
            pinkline.y = 353;

            searchBox.graphics.beginFill(0xDB9195);
            searchBox.graphics.drawRect(0,0,476,25);
            searchBox.x = 374;
            searchBox.y = 370;

            SearchBoxBg.graphics.beginFill(0xffffff);
            SearchBoxBg.graphics.drawRect(0,0,35,17);
            SearchBoxBg.x = 475;
            SearchBoxBg.y = 374;

            txtSearchBox.width = 35;
            txtSearchBox.height = 15;
            txtSearchBox.move(475,375);
            txtSearchBox.restrict = "0-9";
            txtSearchBox.maxChars = 4;
            //txtSearchBox.background = "0xffffff";
            //txtSearchBox.border = "0x0xDB9195";

            searchBoxLFormat.font="Helvetica";
            searchBoxLFormat.color = 0xffffff;
            searchBoxLFormat.bold = true;
            searchBoxLFormat.size = 10;

            txtSearchBox_Label.x = 400;
            txtSearchBox_Label.y = 374;
            txtSearchBox_Label.width = 70;
            txtSearchBox_Label.height = 17;
            txtSearchBox_Label.text = sSearchBox_Label;
            txtSearchBox_Label.setTextFormat(searchBoxLFormat);

            searchButton.x = 534;
            searchButton.y = 382;

            //add to frame
            sortObjects();

            scrollPane.source = holder;         

            //create instance names for referancing/compairing objects
            myGlove.name = "mcglove";
            myGlove.setGloveMessage("My Sister Suzy, I pray that she will be ok. I love here so much, she is the best sister ever.  I miss you RIP");
            mcglovetarget.name = "mcglovetarget";

            messageFormat.font="Helvetica";
            messageFormat.color = 0xffffff;
            messageFormat.bold = true;
            messageFormat.size = 17;
            messageFormat.align = "center";

            messageTextField.x = -85;
            messageTextField.y = -40;
            messageTextField.width = 135;
            messageTextField.height = 140;
            messageTextField.text = myGlove.getGloveMessage();
            messageTextField.wordWrap = true;
            messageTextField.mouseEnabled = false;
            messageTextField.buttonMode = true;
            messageTextField.setStyle("textFormat", messageFormat);
            //messageTextField.hitArea = 0;
            myGlove.addChild(messageTextField);         

            //position the glove and modify apperiance
            myGlove.x = 163;
            myGlove.y = 211;
            myGlove.filters = [myDropShadowFilterDown];
            //myGlove.addChild(messageTextField);
            showGlove.x = 163;
            showGlove.y = 211;
            showGlove.filters = [myDropShadowFilterDown];
            mcglovetarget.x = 615;
            mcglovetarget.y = 211;
            mcglovetarget.alpha = 0

            //action listeners
            myGlove.addEventListener(MouseEvent.MOUSE_DOWN, selectGlove);
            myGlove.addEventListener(MouseEvent.MOUSE_UP, releaseGlove);
            searchButton.addEventListener(MouseEvent.CLICK, searchMessages);
            txtSearchBox.addEventListener(KeyboardEvent.KEY_UP, checkForEnter);

            function selectGlove(event:MouseEvent):void {
                event.currentTarget.startDrag(true);
                var myTargetName:String = event.currentTarget.name + "target";
                var myTarget:DisplayObject = getChildByName(myTargetName);
                myGlove.filters = [myDropShadowFilterUp];
                addChild(myTarget);
                event.currentTarget.parent.addChild(event.currentTarget);
                addChild(topShadowBox);
                myTarget.alpha = .5;
                startX = event.currentTarget.x;
                startY = event.currentTarget.y;
            }

            function releaseGlove(event:MouseEvent):void {
                event.currentTarget.stopDrag();
                var myTargetName:String = event.currentTarget.name + "target";
                var myTarget:DisplayObject = getChildByName(myTargetName);
                event.currentTarget.filters = [myDropShadowFilterDown];
                myTarget.alpha = 0;

                if (event.currentTarget.dropTarget != null && event.currentTarget.dropTarget.parent == myTarget){
                    event.currentTarget.removeEventListener(MouseEvent.MOUSE_DOWN, selectGlove);
                    event.currentTarget.removeEventListener(MouseEvent.MOUSE_UP, releaseGlove);
                    event.currentTarget.x = myTarget.x;
                    event.currentTarget.y = myTarget.y;
                    var myTween:Tween = new Tween(getChildByName(event.currentTarget.name), "scaleX",Strong.easeOut,getChildByName(event.currentTarget.name).scaleX,.28,2,true);
                    var myTween2:Tween = new Tween(getChildByName(event.currentTarget.name), "scaleY",Strong.easeOut,getChildByName(event.currentTarget.name).scaleY,.28,2,true);
                    holder.addChild(getChildByName(event.currentTarget.name));
                    event.currentTarget.removeChild(messageTextField);
                    scrollPane.source = holder;
                    holder.getChildByName(event.currentTarget.name).x=Math.round(Math.random() * (470+Math.round(scrollPane.horizontalScrollPosition) - Math.round(scrollPane.horizontalScrollPosition))) + Math.round(scrollPane.horizontalScrollPosition);
                    holder.getChildByName(event.currentTarget.name).y=Math.round(Math.random() * (intMessageMaxY - intMessageMinY)) + intMessageMinY;
                    holder.getChildByName(event.currentTarget.name).addEventListener(MouseEvent.MOUSE_DOWN, clickMessage);
                    holder.getChildByName(event.currentTarget.name).addEventListener(MouseEvent.MOUSE_UP, releaseMessage);
                    event.currentTarget.name = "" + intMessages;
                    addChild(showGlove);
                    messageTextField.text = "Select a glove to view its message here.";
                    showGlove.addChild(messageTextField);
                } else {
                    event.currentTarget.x = startX;
                    event.currentTarget.y = startY;
                }

                //sortObjects();
                addChild(mcglovetarget);
                addChild(scrollPane);
                addChild(pinkline);
                addChild(searchBox);
                addChild(SearchBoxBg);
                addChild(txtSearchBox);
                addChild(txtSearchBox_Label);
                addChild(searchButton);
                addChild(topShadowBox);
            }

            function position(target) {
                target.x = Math.round(Math.random() * (intMessageMaxX - intMessageMinX)) + intMessageMinX;
                target.y = Math.round(Math.random() * (intMessageMaxY - intMessageMinY)) + intMessageMinY;
                for (var i:uint=0; i<aMessages.length -1 ; i++) {
                    if(target.hitTestObject(aMessages[i]) && counter < limit){
                        counter++;
                        position(target);
                        //return false;
                    };
                }
            } 

            function createMessage(newGlove:mcGlove, sName:String, sMessage:String){
                newGlove.scaleX = .28;
                newGlove.scaleY = .28;
                counter = 0;
                position(newGlove);
                newGlove.rotation = (0, 0, 0, Math.round(Math.random() * (intDegreeHigh - intDegreeLow)) + intDegreeLow);
                newGlove.filters = [myDropShadowFilterSmall];
                newGlove.name = sName;
                holder.addChild(newGlove);
                newGlove.setGloveMessage(sMessage);
                newGlove.addEventListener(MouseEvent.MOUSE_DOWN, clickMessage);
                newGlove.addEventListener(MouseEvent.MOUSE_UP, releaseMessage);
                newGlove.buttonMode = true;
                return newGlove;
            }

            function clickMessage(event:MouseEvent):void{
                selectMessage(event.target);
            }

            function checkForEnter(event:KeyboardEvent):void
            {
                if (event.keyCode == 13) // If Keypress is Enter
                {
                    searchMessages();
                }
            }

            function searchMessages():void{
                if (showGlove.parent == mcglovetarget.parent){
                    if ( txtSearchBox.text != "" ){
                        var searchTarget:DisplayObject = holder.getChildByName(txtSearchBox.text);
                        if (searchTarget){
                            selectMessage(searchTarget);
                            scrollPane.horizontalScrollPosition = searchTarget.x - 220;
                        }else if(1==1){ //if in file
                            gloveCount = aMessages.length;
                            aMessages[gloveCount] = new mcGlove();
                            aMessages[gloveCount] = createMessage(aMessages[gloveCount], txtSearchBox.text, txtSearchBox.text);
                            selectMessage(aMessages[gloveCount]);
                            scrollPane.horizontalScrollPosition = aMessages[gloveCount].x - 220;
                        }else{
                            errorMessage.setAlertText("Sorry, the glove you are searching for does not exist.");
                            addChild(errorMessage);
                        }
                    }
                }else{
                    errorMessage.setAlertText("You must post your message first, otherwise your message will be lost.");
                    addChild(errorMessage);
                }
            }

            function selectMessage(object:mcGlove):void{
                if (showGlove.parent == mcglovetarget.parent){
                    if (activeGloveName != ""){
                        var activeGlove:DisplayObject = holder.getChildByName(activeGloveName);
                        activeGlove.filters = [myDropShadowFilterSmall];
                        activeGlove.scaleX = .28;
                        activeGlove.scaleY = .28;
                        holder.addChild(activeGlove);
                    }
                    activeGloveName = object.name;
                    //event.target.dragIt();
                    holder.addChild(object);
                    object.filters = [new GlowFilter(0xABEEFC, .65, 15, 15, 1, 1, false, false)];
                    object.scaleX = .35;
                    object.scaleY = .35;
                    messageTextField.text = object.getGloveMessage();
                }else{
                    errorMessage.setAlertText("You must post your message first, otherwise your message will be lost.");
                    addChild(errorMessage);
                }
            }

            function releaseMessage(event:MouseEvent):void{
                event.target.dropIt();
            }

            function sortObjects():void{
                addChild(mcglovetarget);
                addChild(scrollPane);
                addChild(pinkline);
                addChild(searchBox);
                addChild(SearchBoxBg);
                addChild(txtSearchBox);
                addChild(txtSearchBox_Label);
                addChild(searchButton);
                addChild(myGlove);
                addChild(topShadowBox);
            }

            myGlove.buttonMode = true;
            searchButton.buttonMode = true;

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T16:07:27.797

在预加载器主程序中，您可以像这样实例化程序

```
var program:Sprite = new programClass() as Sprite; 
```

我认为你应该这样做：

```
var program:Sprite = new Program(); 
```

请注意，您不需要将 Program 转换为 Sprite，因为它已经是 Sprite。ps：你真的是在Program构造函数中写嵌套函数吗？我的天啊 ：-/

# c# - 通过 asp.net 提供图像的最快方法

> ID：488116
> 
> 赞同：2
> 
> 时间：2009-01-28T15:45:17.967
> 
> 标签：c#, asp.net, file, filesystems

我想知道哪种方式通过 ASP.net 传递图像最快：

```
//get file path
string filepath = GetFilePath();
Response.TransmitFile(f); 
```

或者：

```
string filepath = GetFilePath();
context.Response.WriteFile(f); 
```

或者

```
Bitmap bmp = GetBitmap()
bmp.Save(Response.OutputStream); 
```

或您能想到的任何其他方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T17:03:57.963

[TransmitFile 可以更好地扩展，因为它不会将文件加载到应用程序内存中](http://forums.asp.net/t/1275581.aspx)。

您需要使用大图像文件进行测试才能看到明显的差异，但 TransmitFile 将输出执行 WriteFile。

无论哪种情况，您都应该使用 ashx 处理程序而不是 aspx 页面来提供图像。aspx 有额外的开销，这是不需要的。

还有一件事——在发送文件时设置 ContentType，否则浏览器可能会将其呈现为二进制乱码。在 BMP 的情况下：

context.Response.ContentType="图像/bmp";

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T16:00:23.113

这并不能真正回答您的问题，但 asp 不是文件服务器，如果您想提供文件，请使用 IIS 并让 Asp 链接到这些文件，或者如果您必须使用 ASP，请使用它来重定向到适当的位置。

我并不是说它不能做到，但如果你担心性能，你可以考虑走另一条路。

在您拥有的方法中，我认为位图方法最慢，因为它创建了一个更复杂的对象。

如果您必须通过 asp 进行，[MS似乎有一个不错的解决方案。](http://support.microsoft.com/kb/306654)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T17:13:25.527

我想你想这样做是出于安全考虑，或者记录某种类型的指标（例如，记录对数据库的每次点击以找出最受欢迎的图像，或者谁正在查看图像等），或者URL 重写目的。如果没有特别的理由使用 ASP.NET 来提供图像，那么您应该让 IIS 像其他人所说的那样处理它。

另外 - 这并不能回答您关于从磁盘读取图像文件时哪种方法最有效的问题，但我认为我应该指出这一点：

如果您已经有一个包含图像的 Stream 或 Bitmap，请使用它直接写入`Response.OutputStream`. 如果您已经拥有 Stream，您肯定希望避免将其写入磁盘然后从磁盘读取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T15:57:08.783

它很容易测试，我建议您设置三个不同的 URL 来测试不同的机制，然后让客户端（HttpWebRequest/HttpWebResponse 或 WebClient 实例）从所有这些 URL 中下载内容。使用 Stopwatch 实例来计时下载。

我想这并不重要，网络延迟将胜过 IO 延迟（除非你一直在颠簸硬盘驱动器）大部分时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T16:16:03.487

有一件事是肯定的——这不会像让 IIS 服务文件那样快。如果通过 asp.net 路由请求而不是让 IIS 为其提供服务，那么您将引入一堆您不需要的开销。

我可以想象通过 asp.net 进行路由的唯一原因是出于安全目的；是这样吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T16:23:42.567

根据我的经验，使用 TransmitFile()，只要这是您打算发送的唯一内容，而且听起来确实如此。

请注意，这与启用 AJAX 的 ASPX 文件不兼容。

# c# - 扩展 xUnit.NET 以在处理类和定位测试方法时使用自定义代码

> ID：488121
> 
> 赞同：6
> 
> 时间：2009-01-28T15:46:41.440
> 
> 标签：c#, xunit.net, extending

我是 xUnit.NET 框架的忠实粉丝。我发现它轻巧、简单、干净且可扩展。

现在假设我有这样的课程：

```
public class AdditionSpecification
{
  static int result;

  public void Because()
  {
    result = 2 + 2;
  }

  public void Result_is_non_zero()
  {
    Assert.True(result <> 0);
  }

  public void Result_is_correct()
  {
    Assert.Equal(4, result);
  }
} 
```

对于上面的测试类，我希望 xUnit.NET 查看 2 个测试用例并在每个测试用例之前运行因为（）方法。

撇开您可能对我的类或方法名称、此测试/规范的结构、xUnit.NET 框架或 BDD 有任何问题，这是我的问题：

**如何告诉 xUnit.NET 我想自定义它如何识别和执行此类之外的测试方法，*而不*在每个目标测试方法上使用自定义 [Fact] 类属性？**

我知道我可以从 BeforeAfterAttribute 派生来用自定义的执行前后装饰每个测试方法。我怎样才能在课堂上做到这一点？我必须编写自定义跑步者吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T21:27:15.367

xUnit.net 的 IUseFixture 允许您进行每个夹具设置。因此，您可以定义自己的夹具类：

```
public class AdditionFixture : IDisposable
{
  public int Because() 
  {
    return 2 + 2;
  }

  public void Dispose()
  {
   //test tear down code
  }      
} 
```

然后您的测试类可以实现它（使用 setFixture 需要实现）：

```
public class AdditionSpecification : IUseFixture<AdditionFixture>
{
  int result;

  public void SetFixture(AdditionFixture Fixture)
  {
   result = Fixture.Because();
  }

  [Fact]
  public void Result_is_non_zero()
  {
   Assert.True(result <> 0);
  }

  [Fact]
  public void Result_is_correct()
  {
   Assert.Equal(4, result);
  }
} 
```

xUnit 运行器将创建一个夹具实例，并在运行每个测试之前将其传递给 SetFixture。运行所有测试后，如果它实现了 IDisposable，则运行器将处理该夹具。我希望这会有所帮助！

codeplex 上的 xUnit wiki 提供了更多信息，包括一个很好的示例，说明如何实现 IUseFixture 来为您的测试装置管理数据库连接。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-08T20:13:17.860

所以事实证明我正在寻找 ITestClassCommand.EnumerateTestMethods() 方法。

1.  默认的 xUnit.NET 测试运行程序将遍历测试程序集中的所有类。
2.  对于每一个，它将检查一个 RunWithAttribute；这是您覆盖用于识别包含测试的方法的 ITestClassCommand 实现的机会。（RunWithNUnit 就是一个很好的例子）
3.  调用 ITestClassCommand.EnumerateTestMethods() 来处理测试类并返回测试方法的 IEnumerable。
4.  然后将每个测试 IMethodInfo 传递给 ITestClassCommand.EnumerateTestCommands(IMethodInfo testMethod) 以获取 ITestCommands 的 IEnumerable
5.  然后执行每个 ITestCommand 并有机会返回结果。

在我上面的例子中，我需要类似的东西：

```
[AttributeUsage(AttributeTargets.Class, AllowMultiple = false)]
public class RunWithMyTestClassCommandAttribute : RunWithAttribute
{
   public RunWithMyTestClassCommandAttribute()
               : base(typeof(MyTestClassCommand)) {}
} 
```

然后我可以装饰我上面的例子：

```
[RunWithMyTestClassCommand]
public class AdditionSpecification
{
  static int result;

  public void Because()
  {
    result = 2 + 2;
  }

  public void Result_is_non_zero()
  {
    Assert.True(result <> 0);
  }

  public void Result_is_correct()
  {
    Assert.Equal(4, result);
  }
} 
```

最后，在 MyTestClassCommand 中，我有机会在 EnumerateTestMethods() 和 EnumerateTestCommands(IMethodInfo testMethod) 之间使用我想要定位的任何逻辑并构造 ITestCommand 实例，这些实例作为单独的测试执行。

顺便说一句，在研究这个问题的过程中，我在 xUnit.NET 框架中遇到了一个小错误，其中由 EnumerateTestMethods() 生成的自定义 IMethodInfo 从未出现在 EnumerateTestCommands(..) 中，因为它正在被测试解包和重新包装亚军或它的工厂之一。

我[将此问题](http://xunit.codeplex.com/WorkItem/View.aspx?WorkItemId=7788)提交给 codeplex 上的 xUnit 项目，并于2009[年 5 月 30 日更正](http://xunit.codeplex.com/Thread/View.aspx?ThreadId=57985)了 xUnit.NET 1.5 CTP 2

# c# - C# asp.net 自定义 MembershipUser.createUser() 方法，从 createuserwizard 控件调用

> ID：488143
> 
> 赞同：1
> 
> 时间：2009-01-28T15:50:28.220
> 
> 标签：c#, createuserwizard, membershipuser

我创建了自定义 MembershipUser、MembershipProvider 和 RolePrivoder 类。除了一件事之外，这些都有效，我对此感到非常满意。我在“用户”表中有一个额外的字段。我有一个 CreateUser() 的重写方法，它接受额外的变量并将其放入数据库中。

我的问题是我希望能够从创建用户向导控件中调用它。我已经自定义了控件，以便有一个下拉列表来填充我的额外字段。我已经使用以下代码来存储该信息，但我不知道如何使用配置文件或调用我的自定义 CreateUser 方法：

```
 // Create an empty Profile for the newly created user     
 ProfileCommon p = (ProfileCommon)ProfileCommon.Create(CreateUserWizard1.UserName, true);

 // Populate some Profile properties off of the create user wizard
 p.CurrentLevel = Int32.Parse(((DropDownList)CreateUserWizard1.CreateUserStep.ContentTemplateContainer.FindControl("clevel")).SelectedValue);

 // Save profile - must be done since we explicitly created it
 p.Save(); 
```

感谢您的任何帮助

乔恩·霍金斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T16:50:30.360

我认为您的解决方案是您将获得的“最简单”的解决方案。您可以创建自己的向导并调用正确的方法，但这需要更多的工作。

我唯一可以推荐的是使用[OnCreatedUser](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.oncreateduser.aspx)事件。

参考：[4guysfromrolla](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T16:28:18.517

这不是答案，但我找到了解决方法，仍然想知道是否有人可以直接回答这个问题......

```
public void UpdateCurrentLvl_OnDeactivate(object sender, EventArgs e)
{
    int level = Int32.Parse(((DropDownList)CreateUserWizard1.CreateUserStep.ContentTemplateContainer.FindControl("clevel")).SelectedValue);
    MyMembershipUser myUser = (MyMembershipUser)Membership.GetUser(CreateUserWizard1.UserName);
    myUser.CurrentLVL = level;
    Membership.UpdateUser(myUser);
} 
```

在我的第一个 CreateUserWizardStep 中，如果将上面的方法放在停用时触发。由于此时它已将用户插入数据库，我可以将用户取出，转换为我的 MembershipUser 类，设置变量和所有更新方法。

正如我所说，这是一种解决方法，我希望解决它，但它确实有效。

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T17:01:00.637

这也令人难以置信，但在过去，当我不得不做类似的事情时，我只是将额外的值塞进一个未使用的参数中，比如密码重置问题或答案。不过，我不完全确定您将如何使用向导来管理它。

它很难看，但只要它被明确记录（为了安全起见，我会对方法本身以及您引用它的任何地方发表评论）它就可以正常工作。

这也比创建自己的向导少得多。

# asp.net - 为遗留系统编写替换 asp/html 表单

> ID：488153
> 
> 赞同：1
> 
> 时间：2009-01-28T15:53:55.967
> 
> 标签：asp.net, html, legacy-code

快速提问。

有一个旧网站（不受我控制且无法修改），它为用户提供填写数据的表格，然后用户“提交”表格进行处理。这个表单几乎没有错误检查，对用户的帮助也很少（即它在大约 12 年前设计得非常糟糕，此后一直没有更新）。

尽管如此，该应用程序的后端执行一项关键功能。

我的问题是，是否有可能（没有任何修改旧网站的能力）在位于不同服务器和域上的 asp.net 中编写我自己的新前端（具有适当的预提交验证），然后模拟只要我复制正在发送的表单/数据，“提交”到另一个网络服务器？

我猜这里的关键问题是，是否可以在一个网站上向另一个网站提交表单，这可以通过对旧网站的任何更改来完成吗？

评论赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T15:57:06.757

> 我猜这里的关键问题是，是否可以在一个网站上向另一个网站提交表单，这可以通过对旧网站的任何更改来完成吗？

是的，我之前已经这样做过——前提是目标站点不进行任何引用者检查。POST 请求是 POST 请求，无论它来自何处。

您只需要确保请求中的所有字段与来自原始页面的字段完全相同，即 - 相同的字段名称、相同的编码等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T15:59:11.697

请注意，如果现有网站正在对用户进行身份验证，您将需要找到一种方法来收集和传递该信息。但是，否则，菲尔的观点是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T16:01:50.520

简短的回答是“是”，长的回答是“视情况而定”。HTML 和 HTTP 的基础知识允许这样做，但如果不了解遗留站点的实现，您无法确定它是否会工作。

理论上，您只需要确保字段的名称相同，并将表单的目标设置为旧站点的页面 URL。

在实践中，遗留站点可能会做各种难以或不可能实现的事情（例如，它可能需要正确设置 cookie 或保持内部状态）。

最好的办法就是尝试一下。只需模拟基本字段并发布表单以查看其是否有效，应该不会花很长时间。一旦你知道它有效，那么你就可以担心添加额外的验证等

# php - Wampserver 错误：未定义的变量 mywampfp

> ID：488154
> 
> 赞同：1
> 
> 时间：2009-01-28T15:54:03.937
> 
> 标签：php, wamp, wampserver

无法让 Wampserver 运行。**刚刚安装它，但在php_error.log**中得到以下内容：

> [2009 年 1 月 28 日 10:13:17] PHP 通知：未定义变量：第 252 行 C:\wamp\scripts\refresh.php 中的 mywampfp [2009 年 1 月 28 日 10:13:17] PHP 通知：未定义变量: 我在 C:\wamp\scripts\refresh.php 的第 252 行

有谁知道怎么了？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T18:40:55.557

`isset`如果您不能确定该变量是否存在，请使用该函数在访问之前检查该变量是否存在：

```
if (isset($mywampfp)) {
    // …
} 
```

同样适用于数组元素，例如：

```
if (isset($_GET['mywampfp'])) {
    // …
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T21:25:17.217

你应该试试 xampp。就个人而言，我更喜欢它，并且没有任何问题。

# c# - 查找所有程序集依赖项，反射器样式

> ID：488166
> 
> 赞同：4
> 
> 时间：2009-01-28T15:56:29.597
> 
> 标签：c#, reflection, reflection.emit

我正在使用 Reflection.Emit 即时生成一个程序集，然后保存它。它包含一个 Type 和一个静态 Main() 方法。

.NET 可以自动引用所需的程序集。但是，在 Main() 中，调用了来自另一个程序集的方法，并且没有以标准方式引用它。

执行程序集时，运行时查找此程序集但找不到它，这是一个问题。

Reflector 可以检测到这一点，并在“依赖”列表下显示这个额外的程序集。如何使用反射 API 检索这些隐式依赖项？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-28T16:29:03.633

谢谢大家的回复，我已经解决了这个问题。

这是发生的事情：

AssemblyBuilder builder = ... // 生成程序集

builder.GetReferencedAssemblies(); => 即使我已经调用了 Save()，它也不会返回对方法体中使用的程序集的引用——它似乎只返回已经加载到内存中的程序集。

Assembly.ReflectionOnlyLoadFrom(filename).GetReferencedAssemblies() => 工作正常

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-28T16:07:56.967

您是否尝试过 Assembly.GetReferencedAssemblies？它返回被引用程序集的 AssemblyName。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T16:22:14.380

嗯... `Assembly`System.Type 的属性显然返回定义类型的程序集。

如果您对该 Main() 方法中的 IL 完全没有控制/知识，则必须解析刚刚生成的 IL 并检查是否存在所有提到的类型。

更现实的是，手动确保调用和 callvirt 发射所涉及的所有类型都被引用。

# iphone - 如何在 iPhone 上手动制作动画？

> ID：488171
> 
> 赞同：1
> 
> 时间：2009-01-28T15:57:31.543
> 
> 标签：iphone, cocoa-touch, animation, calayer

我在 iPhone 上设置了一个非常简单的“游戏”。物体四处移动，旋转，您可以与它们进行交互等。在模拟器中，它运行良好，但在设备上它达到 0.25 FPS 左右，而且速度非常慢，显然没有时间识别触摸。

这最初只是使用带有`Item`s 数组的 UIView，每个数组都有一个 Tick 和一个 Draw 函数。在应用程序开始时，我启动了一个以 60 FPS 拍摄的 Timer，它调用 Tick，在 Tick 结束时，它调用`[self setNeedsDisplay];`

它工作得非常慢，所以我把这个`Item`类变成了这个类的一个子`CALayer`类，移动图层而不是重绘项目。但是，我是`CALayer`逐帧手动移动的，这显然不好。还是太慢了。所以我告诉它移动到它的最终目的地，并给它一个与到达那里所需的滴答数相等的长度。

这没问题，但是在某些情况下，如果您与某物交互，它应该停止以这种方式移动并转而做其他事情。所以我回到移动每个刻度，而不是仅仅设置新位置，我还将它包装在一个 CATransaction 中，并赋予交易与刻度相同的长度。

工作正常，但出现了新问题：如果我想为某些东西制作动画，我仍然必须在每个滴答声中使用 [self setNeedsDisplay] ，它调用`drawInContext:`，这似乎是一个*主要*的减速问题。

难道没有一种方法可以像我以前那样手动绘制所有内容吗？我只是在进行 CGContext* 调用，它在模拟器中运行良好！如果我在 J2ME 或嵌入式 C++ 中实现类似的东西，它会工作得很好。我错过了什么？我真的需要学习 OpenGL 来制作任何有趣的手动动画吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T16:07:52.710

不确定 CG 动画层，但 OpenGLES 是 iPhone 对高性能图形的回答。在一天结束时，您将获得更好的性能。使用 openGLES 可能会很痛苦，但如果您从工作代码开始（请参阅崩溃应用程序的纹理和视图类），您应该能够从中/围绕它抽象出足够多的东西。

老实说，我不太高兴不得不使用 openGLES 来绘制一些 2D 精灵，但我得到了大约 50fps 的完整物理引擎和脚本层，所以我想这是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T18:53:17.330

如果您需要做的只是为从 A 点移动到 B 点的东西设置动画，那么 UIView 和 CALayer 完全可以处理这个问题。你真的真的不想在 iPhone 上使用 Core Graphics、UIViews 或 Core Animation 以 60 FPS 手动更改精灵的位置。

对于使用 CALayer 的简单移动，您应该能够执行以下操作：

```
[CATransaction begin];
[CATransaction setValue:[NSNumber numberWithFloat:0.5f] forKey:kCATransactionAnimationDuration];

CGSize spriteSize = currentSprite.frame.size;
currentSprite.frame = CGRectMake(newPosition.x, newPosition.y, spriteSize.width, spriteSize.height);

[CATransaction commit]; 
```

currentSprite 是您的 CALayer，newPosition 是整个线性移动的终点。这将使用恒定速度从当前位置平滑地动画到新位置。

使用 Core Animation，您只需指定图层的最终位置并让它完成插入中间帧的工作。如果你通过给它另一个动画在同一层上执行来中断这个动画，它甚至会从移动到一个位置平滑过渡到移动到另一个位置。可以使用 CAKeyframeAnimations 设计更复杂的动画。同样，只需给 Core Animation 开始和结束状态，让它优化其余部分。

UIViews 是 CALayers 的轻量级包装器，我在设备上获得至少 30 FPS 的速度，同时有几十个半透明层同时移动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T17:54:16.520

不幸的是，这听起来有点重写，但是你看过 Cocos2d 引擎吗？如果您要做的只是为屏幕周围的一系列 sprite 设置动画，那么它们会让您在所有 OpenGL 调用周围使用漂亮的 Objective-C 包装器。

[http://code.google.com/p/cocos2d-iphone/](http://code.google.com/p/cocos2d-iphone/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T17:32:51.237

我发现真正的问题是打电话的必要性`[self setNeedsDisplay]`。逐帧重绘是不好的魔力。因此，我大部分时间都使用图像，并且我仍然可以通过将 CALayer 上的操作设置为 null 来逐帧设置位置。具体来说：

```
NSMutableDictionary *customActions=[NSMutableDictionary dictionaryWithDictionary:[self actions]];
[customActions setObject:[NSNull null] forKey:@"position"];
[customActions setObject:[NSNull null] forKey:@"transform"];
[customActions setObject:[NSNull null] forKey:@"opacity"];
self.actions=customActions; 
```

在那次调用之后，逐帧计算时一切都会快得多。

# sql-server - SQL Server 2005 上的 SSIS 2008？

> ID：488172
> 
> 赞同：4
> 
> 时间：2009-01-28T15:57:51.247
> 
> 标签：sql-server, ssis, compatibility

有什么方法可以在使用 SQL Server 2005 数据库的同时获得 SSIS 2008 的好处（包括性能改进）？似乎它仍然从 OLE 中提取数据，所以我不明白这会是什么问题。我正在从 dtproj 文件运行包，而不是加载到服务器上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T16:01:31.287

使用 2005 或 2000 甚至版本 7 DB 都没有问题 但是我认为您不能在装有 SQL Server 2005 的机器上安装 SSIS 2008，因为您很可能需要支付单独的许可证费用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T20:30:14.250

我已经询问过微软许可并在 2005 实例上安装 2008 组件可以免费完成。我们计划这样做是为了报告，但仍想在服务器上安装 2005 以进行一些热备份镜像。

编辑：我假设您需要软件保证（有些明显，但否则您无论如何都必须为 2008 年的升级付费。）

# windows - 如何在 Windows 上发送邮件（MAPI 除外）

> ID：488173
> 
> 赞同：6
> 
> 时间：2009-01-28T15:58:26.330
> 
> 标签：windows, winapi, email, mapi

查看 MSDN MAPI 文档页面时，它说 API 现在已弃用。如果是这样的话，这些天发送邮件的建议 API 是什么？

[http://msdn.microsoft.com/en-us/library/dd296734.aspx](http://msdn.microsoft.com/en-us/library/dd296734.aspx)

**编辑：**感谢所有建议，托管路由不适合我，因为我们使用的是 MFC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T18:34:28.763

如果要在用户默认的 MUA 中打开消息，SMAPI 是您的最佳选择。如果您想在没有用户输入的情况下发送消息，那么上述建议是最好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T15:01:08.233

如果您想使用 SMTP 发送消息，那么您应该查看 Ultimate TCP/IP：

[http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx](http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx)

它使发送消息变得非常容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T16:02:31.467

只需使用 Win32 WS api。发送电子邮件的 10 行代码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T16:34:39.333

在大多数情况下，您最好的选择是直接使用 SMTP，在 .Net 2.0+ System.Net.Mail 中非常通用。还有大量其他资源。只有当您可以依赖 Oulook/OE/WinMail 进行设置和使用时，MAPI 才真正起作用。你没有指定你对 MAPI 的使用，所以你假设 .Net。以您喜欢的平台/语言搜索 SMTP 客户端是您的最佳选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T16:04:12.857

据我所知，如果您不打算使用 Windows MAPI 或 SimpleMAPI，您将不得不推出自己的 SMTP 客户端。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T16:09:55.530

.NET 2.0 框架使用 System.Net.Mail 命名空间中的邮件客户端。

这里有一个专门使用它的网站： [http ://www.systemnetmail.com/](http://www.systemnetmail.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-12T13:49:18.683

如果要使用系统上安装的邮件客户端，MAPI 仍然是可行的方法。如果没有，您可能想看看 ChilKat，它是一个 COM 组件。

# javascript - 如何在 TinyMCE 文本区域中设置初始文本？

> ID：488189
> 
> 赞同：11
> 
> 时间：2009-01-28T16:02:07.883
> 
> 标签：javascript, tinymce, textarea

我处于一种奇怪的情况，我以前没有问题实现我正在寻找的东西。以下代码是托管 TinyMCE 富文本框的 HTML 页面的一部分：

```
...
<textarea id="editing_field">This text is supposed to appear in the rich textbox</textarea>
... 
```

起初，这按预期工作，创建了一个包含文本的富文本框。不过，在某些时候，TinyMCE 代码决定将 textarea HTML 转换为以下内容：

```
<textarea id="editing_field" style="display: none;"/>
This text is supposed to appear in the rich textbox 
```

这会呈现文本框下方的文本，这并不完全理想。我不知道是什么导致了这种行为变化，尽管我也在使用 jQuery 以及它是否会产生任何影响。

我可以通过在页面加载后使用 javascript 将内容加载到文本框中来解决此问题，方法是使用 ajax 或将文本隐藏在 HTML 中并仅移动它。但是，如果可能的话，我想直接从 PHP 将文本发送到文本框中。任何人都知道这里发生了什么以及如何解决它？

**更新 2：**我已经成功地重现了导致行为改变的情况：起初我只是在 textarea 中有纯文本，就像在第一个代码片段中一样。但是，保存内容后，文本将如下所示：

```
<p>This text is supposed to appear in the rich textbox</p> 
```

标签的存在`p`会导致 TinyMCE 触发封闭文本区域到只是单个标签的文本区域之间的转换（如上图所示）。

**更新 1：**添加 TinyMCE 配置文件：

```
tinyMCE.init({
        // General options
        mode : "exact",
        elements : "editing_field",
        theme : "advanced",
        skin : "o2k7",
        skin_variant : "black",
        plugins : "safari,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",
        save_onsavecallback : "saveContent",

        // Theme options
        theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull", 
        theme_advanced_buttons2 : "search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,forecolor,backcolor", 
        theme_advanced_buttons3 : "hr,removeformat,|,sub,sup,|,charmap,emotions,|,print,|,fullscreen,code", 
        theme_advanced_buttons4 : "styleselect,formatselect,fontselect,fontsizeselect",
        theme_advanced_toolbar_location : "top", 
        theme_advanced_toolbar_align : "left", 
        theme_advanced_statusbar_location : "bottom", 
        theme_advanced_resizing : false,

        // Drop lists for link/image/media/template dialogs
        template_external_list_url : "lists/template_list.js",
        external_link_list_url : "lists/link_list.js",
        external_image_list_url : "lists/image_list.js",
        media_external_list_url : "lists/media_list.js",

        // Replace values for the template plugin
        template_replace_values : {
            username : "Some User",
            staffid : "991234"
        },

        width : "450",
        height : "500"
    }); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-28T17:14:07.130

如果不调用 tinyMCE 的 JavaScript 函数，可能需要处理浏览器兼容性问题。

如果页面上只有一个 tinymce 框，则可以这样做：

```
tinyMCE.activeEditor.setContent('<span>some</span>'); 
```

您还可以设置格式，例如 BBCode。查看[setContent](http://www.tinymce.com/wiki.php/API3:method.tinymce.Editor.setContent)文档。

我会让您的 PHP 代码将 HTML 回显到 JavaScript 函数中，并使用以下命令调用它`onload`：

```
function loadTinyMCE($html) {
    echo "
        <script type="text/javascript">function loadDefaultTinyMCEContent(){
             tinyMCE.activeEditor.setContent('$html');
        }</script>
    ";
} 
```

然后

```
<body onload="loadDefaultTinyMCEContent()"> 
```

如果您不想使用页面`onload`事件，tinymce 有一个名为[oninit](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/oninit)的 init 选项，其功能类似。

或者，[setupcontent_callback](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/setupcontent_callback)使您可以直接访问 iframe。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-29T22:08:43.073

鉴于`<p>`标签的存在会导致转换，我怀疑您的 HTML 最终看起来像：

```
...
<textarea id="editing_field"><p>This text is supposed to appear in the rich textbox</p></textarea>
... 
```

不幸的是，HTML 元素在技术上不允许在`<textarea>`标签内，因此可能会将`<p>`标签视为新块元素的开始，从而隐式关闭您的 textarea。要解决此问题，您可以对尖括号进行编码：

```
...
<textarea id="editing_field">&lt;p&gt;This text is supposed to appear in the rich textbox&lt;/p&gt;</textarea>
... 
```

使用 PHP，这可以通过`htmlspecialchars()`在将其回显到页面之前发送您的值来完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T16:12:57.037

第二个示例 <textarea ... /> 是空标记符号。如果您希望文本位于标签内，您需要像第一种方式 <teatarea ....>foo</textarea>

什么是输出 textarea 标签？您可以调试它以查看它是否正在执行空标记表示法？

埃里克

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-22T12:20:16.243

tinyMCE.activeEditor.setContent('some') 为我工作。干杯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T13:51:32.760

看来我已经解决了这个问题，除非有任何破坏解决方案的边缘情况。在将页面内容保存到数据库之前，我在页面内容上使用了以下 PHP 代码：

```
$content = str_replace(chr(10), "", $content);
$content = str_replace(chr(13), "", $content);
$content = str_ireplace('<','&#x200B;<',$content); 
```

它的作用是删除任何换行符，然后在任何开始标记之前添加一个零宽度的不可见字符。然后，在 TinyMCE 发挥作用之前，此文本将插入到 textarea 标记之间。我不知道为什么，但这不会触发问题，并且附加的字符没有显示在最终的 html 或 TinyMCE 的 html 视图中，所以我可以看到这个解决方案的唯一问题是性能下降。一个细节是，似乎只有开始标签需要以这种方式添加，但为了简单起见，我在这里没有考虑到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-16T15:26:32.047

我在使用 React 时遇到了同样的问题，也许与此有关。传递给组件的初始值是原始值。收到后，组件将接管并处理内容，无论是否向其传递新值。因此，如果您要传递一个字符串，那么它就是一个常量，并且它存在于您的组件的初始渲染中。但是，如果您要传递一个变量，则该变量的初始值可能与您要显示的值不同（例如，在您收到要显示的值之前，它可能为 null 或未定义）。在我的情况下，我收到一个带有页面内容的对象，其中之一是要显示为初始内容的 html。但是 render 方法首先被一个空对象触发，然后是带有数据的实际对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-05T06:53:53.040

在 tinyMCE.init 中设置 -

```
init_instance_callback: function (editor) {
                AFunction();
            }

function AFunction(){
//your code here
tinyMCE.get('youtinytextareaname').setContent("your text here");
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-11-07T16:50:14.607

要更改特定的 tinymce 字段，您可以执行以下操作：

```
tinyMCE.get('editing_field').setContent('your default text'); 
```

# eclipse - 如何区分用户事件和合成事件？

> ID：488190
> 
> 赞同：1
> 
> 时间：2009-01-28T16:02:16.247
> 
> 标签：eclipse, eclipse-rcp, jface, eclipse-pde

我有一个 JFace 编辑器，它主要由`TreeViewer`. 这与 a`ContentOutlinePage`相关联以使大纲视图栩栩如生。

当任何一个收到 a`SelectionChangedEvent`时，他们都会调用 other`setSelection()`方法……这就是问题所在。`setSelection()`生成另一个`SelectionChangedEvent`......因此加入了无限循环。

有没有办法判断`SelectionChangedEvent`是由实际用户交互而不是由另一个对象调用创建的`setSelection()`？

还有更好的方法来阻止这种致命的拥抱吗？

欢迎提供线索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T16:07:27.467

通常，您会在例程开始时检查一个标志，以检查您是否处于事件处理程序的中间。如果设置了标志，那么您将退出而不进行处理。

如果未设置标志，则设置标志，处理，然后设置标志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T08:08:13.213

另一种有效的模式是删除事件侦听器，进行选择，然后再次添加事件侦听器。这确保了代码中只有一个地方您必须担心这一点 - 使用标志您必须同时维护两个地方。

此外，SelectionChangedChanged 可能（虽然不确定）放在事件堆栈的顶部（即异步执行）。在这种情况下，您还可以最小化查看器不传播通知的时间段。

总的来说，无论是否单击鼠标，生成的 SelectionChangedEvent 都是相同的，这让我感到失望。我想这并不像人们希望的那样容易。我曾经不得不修改一个文本编辑器类的行为，以便它新增两种插入事件（用户生成和网络生成），以使该文本编辑器类共享。我很想看到更多关于这个的讨论。

# jquery - 使用 SharePoint 功能或物理文件部署 jQuery？

> ID：488194
> 
> 赞同：15
> 
> 时间：2009-01-28T16:03:42.577
> 
> 标签：jquery, sharepoint

我们即将对 SharePoint 进行相当大的自定义，我想在双脚投入之前获得一些反馈。我们正在努力解决的问题之一是我们是直接将 jQuery javascript 库部署到 12 个配置单元（使其在每个站点的 _layouts 中可用等）还是我们将其包装在一个功能中并为每个配置激活该功能地点？我还在 CodePlex 上看到了两个项目，它们将其包装在功能中，我猜这可能是第三种选择。

想法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-28T16:17:18.557

[www.sharepointblogs.com](http://www.sharepointblogs.com/rohan/archive/2008/11/20/sharepoint-and-jquery.aspx)上的选项和评论

按照上面的链接或谷歌它。

总结就是直接修改12 hive很简单但是不支持（即微软保留随意破坏你的环境的权利）

上面链接上的推荐选项是：

> 使用 AdditionalPageHead 委托控件（我最喜欢的！）
> 
> 通过为所有现成母版页使用的 AdditionalPageHead 委托控件提供内容，您可以确保所有 SharePoint 页面都加载了 jQuery 库。AdditionalPageHead 委托控件允许多个控件提供内容，因此它是一个很好的扩展性场景。为此，您需要构建一个 Web 用户控件（ASCX 文件），其中包含用于加载 jQuery 库的脚本标记：

```
<%@ Control Language="VB" ClassName="jQueryControl" %> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-28T17:09:59.247

您还可以使用 Google AJAX 库 API。通过将一些脚本添加到您的 SharePoint 母版页（例如），您可以从 Google 下载您喜欢的任何版本的 jQuery，而无需部署 .js 文件。

还有许多潜在的速度改进：

*   Google 的 jQuery .js 文件可能已经缓存在用户浏览器中（感谢使用此工具的其他网站）
*   浏览器通常只允许与同一服务器建立一定数量的连接，因此这允许并行打开另一个连接
*   该文件是从用户最近的地理位置下载的（我认为）

这是一个越来越流行的解决方案，我只听说过一些好消息。请访问：[http](http://code.google.com/apis/ajaxlibs/) ://code.google.com/apis/ajaxlibs/ 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-06T05:35:12.170

我会说这取决于你的情况。如果您想让 jQuery 库仅可用于单个站点，则使用 Features 是可行的方法。但是，如果您想让它在全球范围内可用，则将其部署到 12 是可行的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-31T10:05:01.730

我们将它部署到 12 hive 作为我们免费的 SharePoint Infuser 工具的一部分，您可能需要考虑一次性将 JavaScript（inc JQuery）部署到多个页面，而不会对 masterpages、core.js 等进行任何混乱的更改。

在内部它使用上面 Ric 提出的委托控制方法，它只是一个更通用的解决方案，可以用于各种目的。

有关详细信息，请参阅[http://www.muhimbi.com/blog/2009/07/massage-sharepoint-into-submission.html](http://www.muhimbi.com/blog/2009/07/massage-sharepoint-into-submission.html)。有关这使之成为可能的非常强大的示例，请参阅[http://www.muhimbi.com/blog/2009/07/automatically-add-search-as-you-type-to.html](http://www.muhimbi.com/blog/2009/07/automatically-add-search-as-you-type-to.html)

# web-services - 为什么我的 Web 服务调用只有在您“监视”连接时才有效？

> ID：488196
> 
> 赞同：1
> 
> 时间：2009-01-28T16:04:15.913
> 
> 标签：web-services, networking

好吧，这真是一个令人头疼的问题。

我有一个调用 Web 服务的应用程序。它是一个有效的 Web 服务，它从 SQL 服务器数据库中提取一些数据，将其转换为 XML 文档并将其返回给 Winforms 应用程序进行处理。

这在调试中工作正常。

当您正常运行它时它会失败，但它会返回特定的数据，这些数据应该表明没有从具有特定 ID 的数据库返回的有效记录。

如果在发布版本中一次失败后打开 Wireshark 数据包捕获，它会再次正常工作。

如果您在到达请求服务的页面之前开始数据包捕获，那么它会以与正常运行时相同的方式出错。

产生正确结果的数据包捕获显示应用程序发出请求，然后接收它所期望的数据。

错误的数据包捕获显示应用程序发出请求，然后明确收到“没有返回记录”错误。

我们注意到的一件事是，它工作时大约需要 0.25/0.5 秒才能工作，但当它不工作时，它的响应速度要快得多。

编辑：好的，我知道我忘记了一些东西。最初，我确信这是服务本身。或 SQL。所以我测试了SQL，没有问题。我在本地调试了服务。没有任何问题。我构建了一个测试工具，将数据从浏览器输入到服务中，并将结果捕获到标签中。我给它提供了一些数据。很好。这不是服务。服务还可以。除了，显然，当通过我的 Winforms 应用程序调用时，数据包捕获确认它正在发送正确的数据。然后它只在某些条件下失败。*叹*

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T16:12:08.333

这可能是您的网络方法本身的问题。查看它如何连接/断开与数据库的连接。看看您是否可以在不调用数据库的情况下模拟结果 - 手动构建结果并调用 Web 服务。还要创建一个直接调用您的 Web 方法的单元测试，而不使用 Web 服务调用并检查其行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T17:07:30.053

在一个误导的主线中，这个问题的答案由于这里提到的那些以外的东西而得到解决。尽管如此，还是很棒的建议。

在这种情况下，我们遇到的问题是我们的系统如何定义信用卡收费的完成。系统应该等待收费的成功授权，并且它的“授权后”过程将收费视为“成功”。

造成这种情况的确切原因是由于我们产品的不寻常性质和给定银行交易的阶段。对于英国的在线支付，在商品“发货”之前，无法“授权后”收取费用。

如果我们出售书籍（或杯子，或新奇的花园侏儒），那么 Pre Auth 成功的通知就足以认为交易完成，因为运输将在稍后进行。我们出售音乐会门票，更准确地说，我们出售演出门票，其实体代表就是门票。我们一拿到客户的钱，他们就有效地保证了他们在所有正常情况下都能参加演出。

在真正意义上，我们的产品在交易完成的第二秒发货，因此需要完成预认证和后认证过程才能将交易视为“成功”。

但是，当预授权成功完成时，客户确信它也会发布身份验证，因此我们此时向他们显示“完成”屏幕以使应用程序运行得更快。在要求打印票的票房上也是如此。然而，没有人知道的是，post auth 可能需要一分钟到三分钟才能发布 auth，因此是一个完整的“成功”。如果收费不成功，它将不会从打印服务返回，因为底层数据库查询返回其“无订单匹配”结果，所以我最后要做的就是等到它完成发布验证和它工作得很好。

所以总而言之，茶杯里有点风暴。现在我们只需要底层 SQL 在返回成功页面的同时返回订单，但不包括失败的费用（例如可能由错误键入的欺诈检测字段如持卡人邮政编码导致）以及我们想要打印详细信息的成功费用.

感谢大家的帮助。抱歉，这是一个相对平凡的修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T16:47:49.383

仔细检查您的 winforms 应用程序是否被 FW 阻止。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T17:32:28.990

更新：我开始通过 OWasp 的 WebScarab 进行监控，在“失败”请求之后，我使用应用程序手动请求插件复制原始请求并通过 Scarab 直接发送。

然后这个“失败”的工作完美地工作了几次。

因此，winforms 应用程序发送的内容是有效的。Web 服务请求中是否有一些我缺少的通信设置？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T17:56:55.993

我过去也遇到过类似的问题。我最终不得不包装 GetWebRequest 方法并调整参数。

```
namespace [NameSpaceHere]
{
    public partial class [the name of the proxy class created by Visual Studio]
    {
        protected override System.Net.WebRequest GetWebRequest(Uri uri)
        {
            System.Net.HttpWebRequest webRequest = (System.Net.HttpWebRequest)base.GetWebRequest(uri);

            // turning this off can cause authentication errors
            //            webRequest.KeepAlive = false;

            webRequest.ProtocolVersion = HttpVersion.Version10;
            webRequest.ServicePoint.Expect100Continue = false;
            return webRequest;
        }
    }
} 
```

# ajax - ASP.Net MVC RC 单元测试 Ajax 请求

> ID：488214
> 
> 赞同：3
> 
> 时间：2009-01-28T16:09:13.690
> 
> 标签：ajax, asp.net-mvc, testing, xmlhttprequest

我们刚刚开始使用 ASP.Net MVC Release Candidate，我们之前的测试项目是使用 MVC beta 测试 Ajax 请求。

旧代码看起来像这样：

```
Mock<HttpRequestBase> request = new Mock<HttpRequestBase>();
Mock<HttpResponseBase> response = new Mock<HttpResponseBase>();
Mock<HttpContextBase> context = new Mock<HttpContextBase>();

context.Expect(c => c.Request).Returns(request.Object);
context.Expect(c => c.Response).Returns(response.Object);

request.Expect(req => req["__MVCASYNCPOST"]).Returns("true");

MyController controller = new MyController();
controller.ControllerContext = new ControllerContext(context.Object, new RouteData(), controller);
ViewResult result = controller.UpdateStatus() as ViewResult; 
```

然后，对 UpdateStatus 的调用将使用请求对象上的 IsMvcAjaxRequest() 方法来确定要返回给浏览器的内容。

ASP.Net MVC Release Candidate 将 Request.IsMvcAjaxRequest() 更改为 Request.IsAjaxRequest() 的扩展方法意味着我们模拟请求标头的方式更改为：

```
request.Expect(req => req["X-Requested-With"]).Returns("XMLHttpRequest"); 
```

我希望其他人觉得这很有用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T17:42:05.687

我知道 Scott Gu 的博客提到了更改，但它没有提供任何代码示例来说明对测试代码的影响或模拟 Ajax 请求需要返回的值。认为这可能会为候选版本中的这种更改提供快速而简单的修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T16:16:31.397

[Scott Guthrie](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)在 RC1 上的博客中介绍了这个问题和许多其他问题。查找有关 AJAX 改进的部分。我注意到的另一件事是 UpdateModel 不再需要 FormCollection。我不得不重新编写单元测试来模拟 Request.Form NameValueCollection。不过，生成的代码可能会更好，所以痛苦是值得的。

**编辑**：另一个问题。如果您有一个使用 ASP.NET MVC Ajax 的现有 MVC 应用程序，您将需要手动更新您的 Javascript 文件，否则它不会将请求识别为 AJAX 请求。旧的 javascript 文件添加了`__MVCASYNCPOST`表单字段机制，而不是设置`X-Requested-With`HTTP 标头。`C:\Program Files\Microsoft ASP.NET\ASP.NET MVC RC\Temp\MvcWebApplicationProjectTemplateRC.cs.zip`我在-- 在 Scripts 目录中找到了新版本。

# svn - CruiseControl.NET SVN 重定位问题

> ID：488239
> 
> 赞同：1
> 
> 时间：2009-01-28T16:15:22.740
> 
> 标签：svn, cruisecontrol.net, visualsvn

我目前使用 SVN 设置 CruiseControl.NET 以自动从存储库中获取代码源。在我们的 SVN 服务器出现问题后 - 我为它重新创建了一个不同的 SVN 位置，并在 ccnet.config 文件中更改了它的位置。这导致 CruiseControl.NET 仍然试图从旧的 SVN 存储库中获取它的问题。

我尝试重新启动 CruiseControl.NET 服务，删除与项目相关的工件和任何其他文件并更改项目名称，但它仍然试图从错误的 SVN 位置获取代码。

我得到的错误是：

```
 ThoughtWorks.CruiseControl.Core.CruiseControlException: Source control operation
     failed: 
     svn: OPTIONS of 'http://local.oldsvnserver/svn/OldRepository': authorization      
     failed (local.oldsvnserver). 

     Process command: C:/Program Files (x86)/Subversion/svn.exe update --username username--password password --non-interactive --no-auth-cache at 
     ThoughtWorks.CruiseControl.Core.Sourcecontrol.ProcessSourceControl.Execute(ProcessInfo processInfo) at 
     ThoughtWorks.CruiseControl.Core.Sourcecontrol.Svn.GetSource(IIntegrationResult result) at 
     ThoughtWorks.CruiseControl.Core.IntegrationRunner.Build(IIntegrationResult result) 
```

新的源代码控制块是：

```
<sourcecontrol type="svn">
  <executable>C:/Program Files (x86)/Subversion/svn.exe</executable>
  <trunkUrl>http://local.newsvnswever/svn/SiteRepository/</trunkUrl>
  <username>username</username>
  <password>password</password>
  <autoGetSource>true</autoGetSource>
  <workingDirectory></workingDirectory>
</sourcecontrol> 
```

任何帮助都是极好的，

克里斯NTR

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T16:20:34.023

尝试以下操作：

1.  停止CCNet
2.  确认 ccnet.config 中没有对旧存储库位置的引用
3.  清除项目的状态文件。这些文件称为 PROJECTNAME.state。
4.  清除项目的工作目录。
5.  重新启动机器（我假设它将重新启动 CCNet 服务）。

这应该清除几乎所有内容，并且应该消除 CCNet 中作为问题根源的旧内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T16:25:15.933

“授权失败”表示**身份验证**成功（即用户已知）但用户无权访问（即用户未**授权**）该存储库文件夹（或整个存储库）。

检查您的 svn 服务器配置。

# javascript - 使用 Javascript 更改复选框

> ID：488240
> 
> 赞同：3
> 
> 时间：2009-01-28T16:15:47.013
> 
> 标签：javascript

我在 HTML 页面上有一系列复选框，我想根据相应的 HTML 查询字符串参数检查复选框。

例如

```
...path/page.html?i=1&j=1&x=0 
```

将导致带有三个复选框的页面在加载时检查 1 和 2。

有人可以告诉我如何做到这一点或指出合适的教程的方向吗？

非常感谢，

编辑：澄清一下，i、j 和 x 只是从我的头顶上摘下来的，但它们是布尔变量（1 = true，0 = false），每个对应一个复选框，所以：

```
i = one checkbox, the value in the example is 1, so the checkbox should be checked.
j = as above
x = one checkbox, the value in the example is 0, so the checkbox should not be checked. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T16:24:28.400

部分来自[W3Schools](http://www.w3schools.com/JS/tryit.asp?filename=try_dom_input_checked)。该文件将创建一个复选框并根据[http://example.com/index.html?j=来检查它](http://example.com/index.html?j=)**？**网址

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<script type="text/javascript">
function getUrlVars()
{
  var vars = [], hash;
  var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');

  for(var i = 0; i < hashes.length; i++)
  {
    hash = hashes[i].split('=');
    vars.push(hash[0]);
    vars[hash[0]] = hash[1];
  }
  return vars;
}

function doStuff()
{
  var GETVars = getUrlVars();
  if (GETVars['j']==1)
  {
    document.getElementById("myCheck").checked=true;
  }
}
</script>

<body onload="doStuff();">
  <form>
    <input id='myCheck' type="checkbox" />
  </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T16:47:43.657

```
function decode(s) {
    return decodeURIComponent(s).replace(/\+/g, " ");
}

function getQueryParams() {
    var query = {};

    document.location.search.replace(
        /\??(?:([^=]+)=([^&]*)&?)/g,
        function () {
            query[decode(arguments[1])] = decode(arguments[2]);
        });

    return query;
}

window.onload = function () {
    var query = getQueryParams();

    // check the checkboxes, assuming their ids are query param names
    var inputs = document.getElementsByTagName("input");

    for (var i = 0; i < inputs.length; i++) {
        var el = inputs[i];
        if (el.getAttribute("type") == "checkbox"
            && el.id in query) {
            el.checked = query[el.id] == "1";
        }
    }
}; 
```

如果您使用的是 jQuery，它会更加简洁：

```
$(document).ready(function () {
    $("input[type=checkbox]").each(function () {
        this.checked = new RegExp("(\\?|&)" + this.id + "=1")
            .test(document.location.search);
    });
}); 
```

如果您想通过名称而不是 id 来引用复选框，请替换为`this.id`。`this.name`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T16:42:05.790

试试这个，记住这段代码不处理格式错误的查询字符串。

```
function GetQueryStringParams() 
{
  var queryString = window.location.search.substring(1);
  var params = queryString .split('&');
  for (var i=0; i < params.length; i++) 
  {
    var pos = params [i].indexOf('=');
    if (pos > 0) 
    {
      var key = params [i].substring(0,pos);
      var val = params [i].substring(pos+1);

      switch(val) 
      {     
        case "1":
          document.getElementById(key).checked=true;
          break;
        case "0":
          document.getElementById(key).checked=false;
          break;
       }
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T16:39:22.333

首先，您需要从 URL 中提取参数。这是[一个很好的方法](http://www.netlobo.com/url_query_string_javascript.html)。

然后，使用 'checked' 属性设置复选框：

```
domelement.checked = true; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T16:40:54.420

首先，从查询字符串中获取参数：

```
var params = new Object;
var query = window.location.search.substring(1);
if (query) {
  var vars = query.split('&');
  for (var i=0; i < vars.length; i++) {
    var pair = vars[i].split('=');
    params[unescape(pair[0])] = unescape(pair[1]);
  }
} 
```

然后相应地设置您的复选框：

```
if (params["i"] == 1) {
  document.getElementById("checkbox_i").checked=true;
}
if (params["j"] == 1) {
  document.getElementById("checkbox_j").checked=true;
}
// and so on 
```

# c# - 如何向 Linq 表达式添加排序规则？

> ID：488249
> 
> 赞同：3
> 
> 时间：2009-01-28T16:19:39.113
> 
> 标签：c#, asp.net, linq, oop

如何实现 IQuariable 的方法，如下所示：

```
var trash = (from a in ContextBase.db.Users
                orderby a.FirstName
                select a).ToCollatedList(); 
```

结果我想看到

```
SELECT * from [User] 
ORDER BY FirstName
COLLATE SQL_SwedishStd_Pref_Cp1_CI_AS ASC 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T16:27:23.730

您不能扩展 Linq-to-Sql 实现以在服务器上执行新功能。

您能做的最好的事情是排序规则的客户端实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T21:42:59.990

我将为不同的排序规则公开一个视图，并允许开发人员针对这些视图运行 LINQ to SQL 查询。

# c# - c# 比较两个泛型值

> ID：488250
> 
> 赞同：81
> 
> 时间：2009-01-28T16:19:58.533
> 
> 标签：c#, generics

> **可能重复：**
> [不能将运算符 == 应用于 C# 中的泛型类型吗？](https://stackoverflow.com/questions/390900/cant-operator-be-applied-to-generic-types-in-c)

我编写了这样的代码：

```
public bool IsDataChanged()
{           
    T value1 = GetValue2;
    T value2 = GetValue1();

    return (valueInDB != valueFromView);
} 
```

现在该函数无法编译并出现错误“*运算符'！='不能应用于'T'和'T'类型的操作数*”。我必须做什么才能使此功能正常工作？

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2009-01-28T16:26:47.600

除非您添加 where T : class 以指示它是引用类型（然后 foo == bar 是合法的），否则您不能在泛型类型上使用运算符（除了特殊情况的 foo == null ）

使用`EqualityComparer<T>`.Default 为您执行此操作。这**不适**用于仅为 == 提供运算符重载而没有以下任何一项的类型：

*   实施`IEquatable<T>`
*   覆盖 object.Equals()

一般来说，实现 == 运算符并且不至少执行其中一个操作将是一个非常糟糕的主意，因此这不太可能成为问题。

```
public bool IsDataChanged<T>()
{           
    T value1 = GetValue2;
    T value2 = GetValue1();

    return !EqualityComparer<T>.Default.Equals(value1 , value2);
} 
```

如果您不限制，`IEquatable<T>`则 EqualityComparer 默认回退可能会在与未实现的值类型一起使用时导致装箱`IEquatable<T>`（如果您控制正在使用的类型，这可能无关紧要）。我假设您使用的是=！为了性能，尽管如此限制为 Generic 类型将避免通过 Object.Equals(object) 路由**意外装箱。**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-28T16:25:23.640

那应该对你有用。

```
public bool test<T>(T test, T test2) where T : class
{
    return (test != test2);
} 
```

这只是从对您的问题发表评论的示例中粘贴的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-28T16:25:59.927

您的类型需要实现[IComparable](http://msdn.microsoft.com/en-us/library/yhte7xk6.aspx)或[IEquatable](http://msdn.microsoft.com/en-us/library/ms131188.aspx)接口。

然后您可能需要将 a!=b 重写为 !(a==b)，或者显式调用 CompareTo() 或 Equals() 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T16:25:26.650

您可以在对象上重载 .Equals() 方法并将评估更改为：

```
return (!valueInDB.Equals(valueFromView)); 
```

假设 valueInDB 和 valueFromView 是对象。您的示例变量的名称与比较中使用的变量不同，所以我不得不假设。

编辑：被击败了 3 秒！关于重载的注意事项，如果您需要比较类型中的值，则 Object 类中的基本 .Equals() 是不够的，因为它只会对复杂类型进行内存比较。您需要重载并提供您希望如何比较对象的实现。

# sql-server - 为此查询在我的表上添加索引

> ID：488258
> 
> 赞同：2
> 
> 时间：2009-01-28T16:20:56.787
> 
> 标签：sql-server, performance, sql-server-2008, indexing

我有一个 500 万行的表，它最受特定查询的影响。所以我想添加一个索引来加快速度。

**询问：**

```
SELECT someID 
FROM   someTable 
WHERE 
       myVarChar = @myVarChar AND
       MyBit = 0 AND 
       MyBit2 = 1 AND 
       MyBit3 = 0 
```

请注意，该`myVarChar`列是唯一的。

这种查询的最佳索引是什么？我目前有一个索引，涵盖了上述查询中的所有 4 列。另外，我必须经常重新索引还是自动重新索引？

我正在使用 sql server 2008 标准。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T16:33:36.213

someID 是该表的主键吗？如果没有，您应该将其添加到您的索引中以防止书签查找。

此外，查看该查询的执行计划，如果您的索引构造正确，您应该在执行计划视图中看到两个图标：SELECT 和 Index Seek。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T16:23:17.593

如果您有一个包含四列的覆盖索引，那可能是最好的。不过，您应该定期重新索引和更新统计信息 - 至少每周一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T18:34:53.787

这可能是您查询的最佳索引，但在创建它之后，请检查执行计划以确保它正在被使用。如果您在查询分析器中运行原始 SQL 时获得两个不同的执行计划，并且当您将其作为存储过程运行时，请阅读[参数嗅探](http://sqlinthewild.co.za/index.php/2007/11/27/parameter-sniffing/)。

```
create unique index IX_MyIndex on SomeTable (myVarChar, MyBit, MyBit2, MyBit3) include (SomeID) 
```

检查您的执行计划以确保您获得没有键查找的索引查找。如果您确实看到键查找，您可能需要更改或添加列到您的索引或 include () 部分。此外，如果您要进行任何排序 - 特别是`desc`，请确保将其添加到您的索引中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T11:39:43.903

首先，您需要使用这种查询来获取列的部分，观察您获得的值并通过区分对列进行排序。

```
SELECT myVarChar ,count(*)
FROM someTable 
GROUP BY myVarChar 
ORDER BY 2 desc 
```

其次，您可以在此对话框中使用创建索引：

```
CREATE UNIQUE INDEX IX_MyIndex 
ON SomeTable (myVarChar, MyBit, MyBit2, MyBit3) 
INCLUDE (SomeID) 
```

codemonkey 说的对，一定要避免为布尔类型值建立非聚集索引。但您可以尝试使用（其他类型值 + 布尔值）构建索引

# c# - 如果文件结构不存在，db4o .OpenFile 方法不应该创建它吗？

> ID：488266
> 
> 赞同：0
> 
> 时间：2009-01-28T16:21:54.100
> 
> 标签：c#, visual-studio-2008, db4o

当使用 Db4oFactiory.OpenFile("somename"); 它试图将文件夹“somename”放入visual studio目录并获得拒绝许可。我通过给它一个绝对路径来解决这个问题：

```
 db = Db4oFactory.OpenFile("E:/test-projects/db4o/db"); 
```

现在我正在捕获 FileNotFoundException 但 db4o 文档明确表示，如果没有一个 db 已经在播放，那么 OpenFile 将生成它们。我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T03:36:04.363

显然，您必须为文件扩展名添加后缀。我在想它需要多个文件，因此需要一个目录。

# css - 哪些浏览器支持字体嵌入

> ID：488275
> 
> 赞同：9
> 
> 时间：2009-01-28T16:22:49.527
> 
> 标签：css, fonts, web-standards

我一直在阅读有关@font-face 规则的内容，并试图确定是否值得在项目中使用它来为标题呈现“富兰克林哥特式媒体”而不是像 sIfr 之类的东西。我认为对于不支持它的浏览器，我可以让它重新使用 Arial。

问题是我无法获得关于哪些浏览器支持以这种方式嵌入字体的明确答案。

到目前为止，我已经解决了 IE 的问题，但不支持 .ttf 文件。其他浏览器我不确定。

如果有人可以向我指出一些兼容性图表，那就太好了。

乔恩

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T16:27:28.893

[本文](http://www.webdirections.org/blog/the-return-of-font-embedding-to-the-web/)讨论了中途的浏览器支持。这是最相关的部分，尽管整篇文章都值得一读：

> CSS3（甚至是 1997 年和 1998 年的 CSS2 草案）长期以来一直承诺使用@font-face 规则来标准化字体嵌入方式。很多人可能不知道的是，Opera 9.5 已经支持此规则，Mac、Windows 和 iPhone OS 的 Safari 发布版本，并承诺用于 Firefox 3.1 和 IE6 及更高版本。
> 
> 可悲的是，虽然 Opera 9.5 和 Firefox 3.1 暗示了对 @font-face 的支持（请参阅下面#4 的评论），但实际上并非如此。
> 
> 不过有一个问题。除 IE 之外的所有浏览器都支持链接到 TrueType 字体文件。Microsoft 仅支持专有的 EOT 文件格式。

编辑：包括来自[Ric Tokyo](https://stackoverflow.com/users/42019/ric-tokyo)答案的[更新。](http://www.webdirections.org/blog/ubiquitous-web-font-embedding-just-got-a-step-closer/)

> [更新 2] Opera 10 和 Firefox 3.1 现在支持在当前发布的 alpha 或 beta 版本中链接到 TrueType 和 OpenType（但不包括 EOT）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T17:06:21.453

Safari 3.1（和[Webkit Nightly](http://nightly.webkit.org/)版本）、Firefox 3.1 和 Opera 10 支持 .ttf（TrueType 字体）和 .otf（OpenType 字体）的 @font-face 嵌入。Internet Explorer 版本 5+ 仅支持 .eot（一种专有的嵌入式开放类型格式）的 @font-face 嵌入。

Microsoft 制作了一个可怕的小字体转换工具，称为[WEFT](http://www.microsoft.com/typography/web/embedding/weft3/)（仅限 Windows），可用于将大多数字体格式转换为 .eot。

CSS3.info 有一个关于如何使用@font-face 规则的[简短教程。](http://www.css3.info/preview/web-fonts-with-font-face/)该站点是玩 CSS3 技巧（或者在本例中是 CSS2 提议的技巧）的绝佳资源。

[在A List Apart](http://www.alistapart.com/articles/cssatten)上有一篇关于这个主题的更详尽的文章。

确保您在网页中嵌入的任何字体都在其许可证中声明可以这样做，因为该字体将存在于您的网络服务器上的公共目录中，任何人都可以免费下载。许可证中并不总是明确涵盖此用途，但您通常可以直接联系设计人员询问。只要您包含指向他们页面的链接，他们通常会让您使用字体。我不确定 Franklin Gothic Medium 是否被批准用于此用途，但我怀疑是否如此。

这里有一些免费字体的资源。如果您进行了足够多的挖掘，通常可以找到适合您的类似面孔：

*   [雷·拉拉比](http://www.larabiefonts.com/)
*   [迪特·斯特夫曼](http://moorstation.org/typoasis/designers/steffmann/index.htm)
*   [乔斯·布伊文加](http://www.josbuivenga.demon.nl/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T16:29:37.923

[网络工具包也可以](http://www.clagnut.com/blog/2042/)

[quirks 模式](http://www.quirksmode.org/css/contents.html)长期以来一直是 js 和 css 兼容性表的好资源

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T16:31:13.927

@nezroy，[这](http://www.webdirections.org/blog/ubiquitous-web-font-embedding-just-got-a-step-closer/)是一个更新：

> [更新 2] Opera 10 和 Firefox 3.1 现在支持在当前发布的 alpha 或 beta 版本中链接到 TrueType 和 OpenType（但不包括 EOT）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T16:29:56.800

我记得 Safari 的人们自豪地写了一篇博文，说 Webkit 可以下载 ttf 字体并在页面源代码中自动使用它们。IE 一直支持下载位图字体。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T16:35:12.950

如果您不害怕某些 Java 脚本，这篇文章可以帮助您：[http](http://www.webresourcesdepot.com/use-any-font-via-javascript-typefacejs/) ://www.webresourcesdepot.com/use-any-font-via-javascript-typefacejs/ 。

我自己没有使用过它，但它承诺支持任何浏览器上的任何字体......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T17:22:42.683

好的，所以我认为最好的方法如下......

*   在第一个实例中使用 ttf 字体
*   回退到 IE 的 OET 字体
*   对于根本不支持嵌入字体的浏览器，请使用 Arial、sans-serif。

太好了，现在只需找到一些 EOT 字体。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-23T00:00:51.760

写到这里：

[http://interactivity.ifactory.com/2010/04/font-face/](http://interactivity.ifactory.com/2010/04/font-face/)

现在基本上 95% 的现代浏览器都支持它：

IE6+、FF 3.5+、Chrome、Safari 3.1+、Opera。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-01-28T16:29:04.040

他们没有，您最好的选择是执行以下操作：

```
<h1 id="MyHeading">my heading</h1>

h1#MyHeading {
    text-indent: -1000px;
    width: 200px;
    height: 50px;
    background-image: url(myheading.jpg);
} 
```

[这篇](http://www.digitalgarde.com/downloads/how-to-use-custom-fonts-in-your-html/)文章解释了一些其他的选择。

编辑：我不知道为什么这被否决了。底线是没有可访问的、对 seo 友好的方式来做所有浏览器都支持的事情。如果您想疏远您的用户，请选择其他解决方案之一。否则，我会让我的用户对我的 -1 感到满意。

# windows - 如何制作更改环境变量的 Windows 批处理文件？

> ID：488294
> 
> 赞同：3
> 
> 时间：2009-01-28T16:25:26.713
> 
> 标签：windows, scripting, batch-file

是否可以制作一个可以对环境变量进行**持久**更改的批处理文件？

例如，我的 installer.bat 脚本将一些文件复制到计算机文件系统中的**随机位置**。我想将该位置添加到 PATH 环境变量中，以便程序可以在当前会话中运行。

仅供参考 - 我安装的东西经常更改：我想在每次运行程序时都进行全新安装。此外，我不想覆盖其他以前安装的程序副本，以防万一其他（旧）实例仍在执行。

我希望能够做这样的事情：

```
rem install_and_run.bat
install.bat 
myapplication.exe 
```

不幸的是，这不起作用，因为 install.bat 永远不会“返回”到主脚本。myapplication.exe 永远不会被调用。接下来我尝试了：

```
cmd /C install.bat
myapplication.exe 
```

不幸的是，这不起作用，因为这意味着 install.bat 在完全独立的 cmd.exe shell 中运行。这意味着一旦脚本终止，任何环境变量更改都不会持续存在，因为 cmd.exe 也会终止。

必须有一种方法可以制作更改环境变量的批处理文件

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T16:28:54.443

在你的情况下，你想要的是

```
rem install_and_run.bat
call install.bat 
myapplication.exe 
```

也就是使用`call`to call `install.bat`，这样控制权就会返回到`install_and_run.bat`。

我认为您不了解环境变量是**per-process**。您的批处理文件在 cmd.exe 实例中运行，并且该实例具有环境。当您编写时，`cmd /C`您正在创建一个新的 cmd.exe 实例，它有自己的环境。然后`install.bat`对 cmd.exe 的新实例的环境进行“持久”更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T16:27:53.043

好吧，你可以这样做：

设置 EnvVariableName="某个值"

至于你从另一个批处理文件中调用一个单独的批处理文件，我相信调用命令会返回

`rem install_and_run.bat`
`call install.bat`
`myapplication.exe`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T16:52:34.880

您无法创建或修改环境变量并使其在批处理脚本 AFAIK 的控制台会话之间持续存在。

我有一个带有批处理脚本包装器的 VBScript 脚本，但我认为 Jay 为您提供了正确的解决方案。如果你喜欢，我可以发布我的代码。

# c# - 为什么认为最佳实践在类属性中没有复杂的逻辑？

> ID：488302
> 
> 赞同：6
> 
> 时间：2009-01-28T16:26:53.233
> 
> 标签：c#, properties

像这样的一些代码有什么缺点：

```
public class Class1
{
   public object Property1
   {

        set 
        {
             // Check some invariant , and null

             // throw exceptions if not satisfied

             // do some more complex logic

             //return value 
        }

   }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-28T16:31:04.533

缺点是，如果您正在执行需要花费大量时间的过多逻辑，并且/或者具有在逻辑上不从属性设置中流出的副作用，那么您将拥有一个非常复杂的类设计。

方法传统上用于指示正​​在执行具有后果的操作，而不是属性。虽然您绝对可以在其中包含逻辑，但过多可能会给您正在尝试做的事情带来错误的印象，即分配一个值，而不是执行操作。

最后，这一切都取决于“做一些更复杂的逻辑”是什么意思。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T16:34:49.707

很难回答这个问题，因为“复杂逻辑”非常模糊。

我认为对属性设置的基本健全性检查没有任何问题，并且当对象的一个​​属性发生更改时，需要对其进行某种处理是很常见的。

现在，如果通过“复杂逻辑”你的意思是做一些疯狂的数据库访问或创建网络连接来做某事，那么是的，那将是糟糕的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T16:41:21.363

如果你看到一个属性，你会假设它的行为就像一个字段，也就是说，你可以一遍又一遍地检索它的值：

```
if(obj.Prop.Equals(otherObj.Prop))
{
    Console.WriteLine(obj.Prop);
    Log.CreateEntry(obj.Prop);
} 
```

被`Prop`实现为一种方法。用户怀疑计算成本很高，可能会将结果复制到局部变量中并改为处理它。

属性*绝不能*更改对象。如果一个属性的值没有改变，它*应该总是返回相同的对象。*特别是如果对象的创建成本很高（比如每次调用都返回一个新的 StreamReader）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T16:52:23.383

属性应该努力做到没有副作用。如果类的消费者看不到副作用（懒惰地创建一个不会改变的字符串），那么这不是一个问题。默认情况下，调试器倾向于显示（因此评估）属性。如果他们有副作用，这可能会导致相当大的悲痛。

如果提供的值是非法的，则从 setter 中抛出通常是可以的。从吸气剂中投掷通常被认为是差的。

与以往一样，这些都是经验法则，情况可能会决定不遵守这些规则。一个很好的例子是通过 Linq to SQL 生成的类型的属性。如果您对子属性进行惰性查找，那么评估它确实会触发数据库读取。这是抵消但结果对象的易用性，可读性和一致性 - 这是平衡竞争规则的事情之一。

警惕那些说必须或从不的规则。有时这种性质的规则是存在的，并且是合理的，但它们实际上并不常见。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T16:30:22.837

预计房产的执行成本很低。如果不需要将属性的值保存在变量中以避免昂贵的属性代码执行，代码看起来会更整洁。

设置它们也是如此，它不期望分配一个值会调用一些昂贵的操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T16:59:35.443

为了代码的清晰，业务逻辑应该与属性设置器分开。简单的健全性检查可以而且应该经常在物业中进行。但是任何特定于应用程序的东西，或者不是立即隐含在类型中的东西都应该被抽象掉。对于最佳 OO 实践，您可能希望任何仅适用于该对象的逻辑成为该对象的一部分，并且与您如何处理该对象相关的任何复杂逻辑都应该在处理该对象的代码部分中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T16:32:41.537

为了使代码易于理解，最好能`get`准确地掌握`set`.

除了我们暂时看不到的“一些复杂的逻辑”之外，这段代码看起来并不像一团糟。

# javascript - 使用 jQuery 选择多个类

> ID：488305
> 
> 赞同：225
> 
> 时间：2009-01-28T16:27:07.960
> 
> 标签：javascript, jquery, jquery-selectors

我已经看得很清楚了，似乎无法找出如何在一个 jQuery 选择器语句中选择与某些类匹配的所有元素，例如：

```
$('.myClass', '.myOtherClass').removeClass('theclass'); 
```

关于如何实现这一目标的任何想法？唯一的其他选择是做

```
$('.myClass').removeClass('theclass');
$('.myOtherClass').removeClass('theclass'); 
```

但是我用很多类来做这个，所以它需要很多代码。

* * *

## 回答 #1

> 赞同：408
> 
> 时间：2009-01-28T16:29:25.707

这应该有效：

`$('.myClass, .myOtherClass').removeClass('theclass');`

您必须将多个选择器全部添加到 $() 的第一个参数中，否则您将给 jQuery 一个用于搜索的上下文，这不是您想要的。

这与您在 CSS 中所做的相同。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-28T16:29:41.993

你试过这个吗？

```
$('.myClass, .myOtherClass').removeClass('theclass'); 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2011-01-28T12:23:56.537

我用`$('.myClass.myOtherClass').removeClass('theclass');`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-31T08:42:47.887

```
// Due to this Code ): Syntax problem.    
$('.myClass', '.myOtherClass').removeClass('theclass'); 
```

根据 jQuery 文档： [https ://api.jquery.com/multiple-selector/](https://api.jquery.com/multiple-selector/)

何时可以通过这种方式选择多个类：

```
jQuery(“selector1, selector2, selectorN”) // double Commas. // IS valid.
jQuery('selector1, selector2, selectorN') // single Commas. // Is valid. 
```

通过将所有选择器括在单个 '...' ' 或双逗号中，“...”

因此，在您的情况下，调用多个类的正确方法是：

```
$('.myClass', '.myOtherClass').removeClass('theclass'); // your Code // Invalid.
$('.myClass , .myOtherClass').removeClass('theclass');  // Correct Code // Is valid. 
```

# asp.net - 我可以更改通过 IIS 保存的文件的所有者（使用 ASP.NET）

> ID：488310
> 
> 赞同：0
> 
> 时间：2009-01-28T16:27:35.150
> 
> 标签：asp.net, security, iis, permissions, windows-server-2003

有没有办法在 Windows Server 上使用 IIS 更改已保存文件的所有者。越容易越好。在文件已经保存到光盘之后，这将在保存或更改文件所有者期间完成，这并不重要。ASP.NET 中的一个示例非常受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T18:12:28.697

从理论上讲，它应该是相当直截了当的。您*应该*能够执行以下操作来更改现有文件的所有权：

```
string domain = "domain";
string user = "username";

FileInfo info = new FileInfo(@"c:\test.txt");

FileSecurity security = info.GetAccessControl();

System.Security.Principal.NTAccount newOwner =
    new System.Security.Principal.NTAccount(domain, user);

security.AddAccessRule(
        new FileSystemAccessRule(newOwner, FileSystemRights.FullControl,
            AccessControlType.Allow));
security.SetAccessRuleProtection(true, false);
security.SetOwner(newOwner);

info.SetAccessControl(security); 
```

然而，在实践中，由于 Windows 施加的限制，这实际上并不起作用。Windows 不允许您将文件的所有者更改为当前用户或管理员组以外的任何内容。

当它到达最后一行时，您将收到异常“不允许安全标识符成为此对象的所有者”。

谷歌搜索表明有可能解决这个问题，但是当我过去尝试过时，我未能让解决方法发挥作用。我很想知道是否有人成功地完成了这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-26T00:44:18.743

如果用户具有“还原文件和目录”权限，则用户可以将所有权分配给其他用户。默认情况下禁用此功能，因此您需要在尝试设置所有者之前启用它。.Net 没有对此的内置支持，因此您需要 PInvoke AdjustTokenPrivileges 并使用其他非托管函数来获取对此的输入。

我已经[在我的博客上详细描述了它的使用](http://blog.salamandersoft.co.uk/index.php/2009/10/setting-the-owner-of-files-and-directories-in-c/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T17:07:47.830

虽然这不是自定义示例，但我相信您的答案在于 [System.Security.AccessControl](http://msdn.microsoft.com/en-us/library/system.security.accesscontrol.aspx)命名空间。

查看 FileSecurity 类，它可以让您识别规则和权限。FileSecurity 类由 File.Create() 等方法使用。

# asp.net - 从 ASP.NET 为网页创建新选项卡或窗口

> ID：488311
> 
> 赞同：1
> 
> 时间：2009-01-28T16:27:40.610
> 
> 标签：asp.net, repeater

我有一个主页，我想成为我的 Web 应用程序中用户的一种调度中心。所以我希望主页保持打开状态，但是当用户选择某些任务时，我可以对其进行设置，以便使用他们选择的任务创建一个新的选项卡或页面。

我知道如何将控制权转移到另一个页面，但我怎样才能执行类似 Server.Transfer 的操作，只会使新页面出现在新选项卡中，并在旧选项卡/窗口中保持现有页面打开？

举一个我在做什么的例子。我目前在我的主页上有一个中继器，它构建了一个链接按钮列表。LinkBut​​tons 具有来自数据源的文本。用户单击链接按钮后，我想打开一个新页面，并且希望在这个新页面中保留会话状态。

这可以做到吗，怎么做？

我正在使用 .NET 3.5 中的 ASP.NET 版本。

编辑：我不在乎它是标签还是窗口。我只想能够生成一个新网页并保持现有网页打开。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T16:40:40.660

您不能在服务器端更改 UI 行为（例如，通过使用 Server.Transfer 或 Response.Redirect）——它只是不能那样工作。所以，有两种方法可以解决这个问题：

1.  如果您提前知道哪些特定任务需要打开新窗口/选项卡，请适当设置锚点或表单标签的目标（或使用 javascript 的 window.open() 函数）。
2.  如果需要在服务器端决定打开新窗口/选项卡，您可以生成并返回满足您需要的 javascript。

请记住，新选项卡/窗口的行为完全取决于浏览器和用户的设置，因此无法保证会发生这种情况 - 某些设置甚至可以强制在同一窗口中打开所有链接，无论目标或调用 window.open()。

如果您使用的是基于 cookie 的会话（这是默认功能），即使在新窗口或新选项卡中，用户仍将使用相同的会话，因此您无需执行任何特殊操作来保留会话状态。

如果您使用的是基于 url（或无 cookie）的会话密钥，则需要确保在使用 javascript 打开新窗口时使用该密钥正确格式化 url。我不是很肯定，但我相信使用目标属性和相对 url 应该会自动生成适当的 url。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T18:56:45.630

这就是我所做的。

我需要根据他们所做的选择添加一个 Session 状态变量，在 Firefox 中，它会产生一个很好的新选项卡：

在调度页面中，我只是使用 Server.Transfer 转到新页面（添加会话状态后），但是，在新页面上，我运行了一个 onload 脚本。这是我的代码：

在调度页面的项目命令事件处理程序中：

```
protected void RecentButtonsRepeater_ItemCommand(object source,
    RepeaterCommandEventArgs e)
{
    string code = ((LinkButton)e.Item.Controls[1]).Text;
    string sql = "SELECT RunID FROM ProductionRuns WHERE RunCode = @code";
    SqlConnection sqlconn = new SqlConnection(QCDataPath);
    sqlconn.Open();
    SqlCommand sqlcomm = new SqlCommand(sql, sqlconn);
    sqlcomm.Parameters.AddWithValue("@code", code);
    SqlDataReader sdr = sqlcomm.ExecuteReader();

    sdr.Read();

    int id = sdr.GetInt32(0);

    sdr.Close();
    sqlconn.Close();

    Session["RunID"] = id;
    Server.Transfer("Sheet.aspx");
} 
```

在 Sheet.aspx 标记中：

```
<script type="text/javascript">
    function ReOpenScoreHome() {
        window.open("Scoresheets.aspx", "reopenwindow");
    }
</script>
</head>
<body onload="ReOpenScoreHome()"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T16:30:44.300

我几乎肯定这是不可能的。大多数选项卡式浏览器都有一个可以调整的设置，告诉浏览器应该在哪里启动新页面——在全新的窗口或新选项卡中。

鉴于这是在用户的控制之下的事实，我认为目前没有办法以独立于浏览器的方式实现这一点。虽然如果 IE 的 DOM 扩展所公开的对象模型允许您这样做，我不会感到惊讶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T16:34:43.903

它不可能，新页面是否在选项卡中打开，或者新页面由浏览器中的用户设置控制，而不是由代码控制。

# flash - 使用 Deng 在 Flash 中嵌入 HTML

> ID：488327
> 
> 赞同：0
> 
> 时间：2009-01-28T16:29:41.010
> 
> 标签：flash, xhtml, adobe, plugins

[Deng](http://deng.com.br) XML 浏览器引擎声称能够在 Flash 对象中呈现 XHTML。有没有人有任何使用它的经验或可以推荐替代解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T22:09:57.570

上次我检查时，所有基于 Flash 的非官方渲染引擎都远未完成。您可能会找到一些用于 gecko 引擎的 Java 小程序库或包装器（这是 firefox 使用的一个）。JavaFX 还承诺在未来的版本中发布一个名为 JWebPane 的 Webkit 组件（Safari 和 Chrome 使用的引擎）。
如果您正在使用 Adob​​e AIR 构建桌面应用程序，那么您就有了一个具有`HTMLLoader`类的本机解决方案。

# file - gfortran：如何控制 .mod 文件的输出目录

> ID：488333
> 
> 赞同：8
> 
> 时间：2009-01-28T16:30:31.603
> 
> 标签：file, gcc, gfortran

有没有办法将由 gfortran (GCC) 生成的 .mod 文件放入单独的输出目录中？我知道如何使用 -o 标志放置目标文件或其他输出，如下所示：

```
gfortran -c test.f03 -o /path/to/output/dir/test.o 
```

但是 .mod 文件（由上述调用生成）不受 -o 标志的影响，并放置在当前目录中。一些商业编译器有一个像 -qmoddir 这样的标志，但我找不到 gfortran 类似的东西。

如果没有这样的标志，是否可以在额外的步骤中生成 .mod 文件以使 -o 标志起作用？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-22T06:51:10.643

GNU [gfortran](http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gfortran/Directory-Options.html#Directory-Options)文档指出`-M`*dir*或其同义词`-J`*dir*指定`.mod`文件的输出目录。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-03-15T22:03:53.750

# language-agnostic - 您选择框架或库的标准是什么？

> ID：488348
> 
> 赞同：2
> 
> 时间：2009-01-28T16:33:20.893
> 
> 标签：language-agnostic, open-source, frameworks

一般来说，您如何选择在您的应用程序中使用的框架或库？它必须是开源的吗？一定要商用吗？是否必须积极开发、完善文档或拥有漂亮的主页？如果您的语言对某些功能具有原生支持，您会选择第三方框架或库的原因是什么？

你的标准是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-28T16:38:20.683

1.  它必须工作。
2.  它必须是可行的——商业支持，积极开发，或者完整到除了端口之外不需要更新。
3.  它必须有合理的支持——示例、完整的源代码、开发者论坛、反馈/错误报告。
4.  它必须是稳定的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T16:46:18.170

如果有一个可行的开源选项，我将始终选择它，没有比拥有源代码并能够进行更改以满足您的需求更好的支持。如果没有 api 文档，我不会在上面浪费时间。

编辑：@[乔什布朗](https://stackoverflow.com/users/2030/josh-brown)评论

是的，我实际上不得不对我使用的开源库进行更改。我为项目的第一个版本使用了一个库，然后下一个版本的要求要求我添加一个新功能。自己修改库更容易，然后找到支持新功能的新库，然后修改我的代码以使用新库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T16:45:29.217

稳定是最重要的。如果它完成了你需要做的事情并且你能弄清楚，那么唯一剩下的就是它是否稳定。

如果它有一个清晰的界面文档并不那么重要——如果它有一个糟糕的界面文档更重要。如果这是一个庞大的项目，可以用它完成很多事情，并且您的预期用途可能会在未来发生变化（例如 TineMCE），那么需要一个积极的支持论坛。

开源确实有帮助，但不是必需的。如果它不是开源的，则需要一个演示，以便您可以在购买之前编写所有需要与它交互的代码。

到目前为止，我见过的图书馆中最酷的许可方案是 Js-Ext。如果您的应用程序是开源的，则它是开源的；但是如果你想通过你的项目赚钱，你需要一个许可证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T16:48:56.713

对于 C/C++，非工具开发：

*   我可以配置它如何分配内存吗？
*   我可以控制它如何执行 I/O 吗？
*   我可以控制它的并发性吗？

对于工具开发： - 这段代码是否让我觉得自己是个坏人？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T17:25:11.057

要求的标准：

*   必须符合项目要求，而不是相反（避免“当你有锤子时，每个问题看起来都像钉子”）
*   无需杂乱无章或技巧即可工作
*   稳定

重要但*可能*不会破坏交易：

*   良好的文档（就 Java 而言，这意味着 API 上至少有一套完整的 Javadocs）
*   活跃的用户社区
*   一致的，可预测的习语
*   未来版本的兼容性

可选，很高兴拥有：

*   开源
*   可用的教程和示例
*   针对性能进行了优化

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T16:36:23.307

以您从事的项目最有意义的为准。没有硬性规定。这就像决定使用哪种语言编码一样。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T16:47:20.023

1.  简单易学的设计
2.  可定制
3.  如果它不是免费的，它应该是一个非常合理的价格，没有版税来分发或整合
4.  大型社区

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T16:48:12.580

我会选择一个基于：

*   它应该是开源的（在大多数情况下，这将确保它的质量）

*   它的文档应该存在、更新并且易于访问

*   它应该有一个很好的学习曲线

*   使用起来应该很有趣

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-28T16:48:36.090

*   它必须没有运行时许可费用：我的雇主 (ISV) 可以支付每个开发人员的许可，但通常不会支付每个客户或每个最终用户的许可。

*   我必须能够支持它（这意味着我有源代码）：以防供应商停业，不会修复错误，或者不会在下一个版本中添加我们想要的新功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-28T16:49:09.537

1.  有据可查
2.  相当直观的 API（如果 ConvertToInt() 存在，ConvertToDouble() 也应该存在！）
3.  一致的约定（请参阅 PHP 了解如何不这样做！）
4.  示例代码（编译并运行！）
5.  源代码（这样您就可以修复错误、学习等）
6.  稳定的

至于何时使用新组件而不是使用现有组件

1.  该组件比原生组件具有更多的功能/特性（例如，.NET 数据网格在许多领域都需要，例如分组）
2.  完成组件的功能会花费您很长时间，或者您不知道如何操作（例如安全/加密组件）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-28T16:54:51.583

1.  稳定的 API
2.  兼容许可证
3.  非常适合您的技术堆栈
4.  大量用户（依赖它的应用程序），积极开发/维护
5.  开源更好（如果它的许可证适合您）
6.  渴望使用它的开发人员:)
7.  性能和特点

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-28T17:05:49.237

按重要性排序：

1.  它很容易理解和/或有据可查（教程是最好的）。
2.  我可以在工作和在家中一样使用它（所以开源很有帮助，但 copyleft 没有）
3.  它最近有活动。
4.  它是稳定的。它的一些迹象是版本> = 1.0。
5.  该项目试图保持与早期版本的兼容性。没有什么比为您的应用程序方便的新功能获取框架的新版本更烦人的了 - 然后认识到您的应用程序不再适用于该框架。

一些符合这些条件的项目：

*   [爪哇](http://java.sun.com/)
*   到目前为止我使用的[Apache Commons 库（IO、Logging、Math）](http://commons.apache.org/)
*   [JTS 拓扑套件](http://www.vividsolutions.com/jts/jtshome.htm)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-28T18:03:02.367

我想要的东西：

*   有效（你真的不能过分强调这一点）
*   写得很好（可能需要是OSS所以我可以看看这个）
*   维护良好 - 我想定期查看更新
*   有一个干净的界面
*   如果它坏了我可以修复（再次，OSS 是一个胜利）
*   不会将我锁定在单一供应商中

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-28T23:08:49.380

我喜欢上面tvanfosson的回答。

糟糕的文档或糟糕的主页是一种关闭，但不会像错误的代码或糟糕的 API 那样快速地把我推开。

至于使用语言已经支持的第三方库，我使用 jodatime 库而不是 Java 的内置日期处理（我认为大多数人都同意 sux。）我很高兴听到他们正在重做日期处理，更像是 Joda 的实现.

# python - 如何在 Python 中进行环境变量更改？

> ID：488366
> 
> 赞同：26
> 
> 时间：2009-01-28T16:36:47.673
> 
> 标签：python, environment-variables

根据我的阅读，对 Python 实例中环境变量的任何更改仅在该实例中可用，并且在实例关闭后消失。有没有办法通过将它们提交到系统来使它们坚持下去？

我需要这样做的原因是因为在我工作的工作室中，像 Maya 这样的工具严重依赖环境变量来配置跨多个平台的路径。

我的测试代码是

```
import os
os.environ['FAKE'] = 'C:\\' 
```

打开另一个 Python 实例并请求`os.environ['FAKE']`生成一个`KeyError`.

**注意：**可移植性将是一个问题，但我正在编写的小 API 将能够检查操作系统版本并在必要时触发不同的命令。

也就是说，我已经走上了使用 Windows 注册表技术的路线，并且将简单地编写替代方法，当它们成为要求时，它们将在其他平台上调用 shell 脚本。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-08-16T22:35:26.800

您可以在命令行中使用 SETX。

默认情况下，这些操作在 USER 环境变量上进行。要设置和修改 SYSTEM 变量，请使用 /M 标志

```
import os
env_var = "BUILD_NUMBER"
env_val = "3.1.3.3.7"
os.system("SETX {0} {1} /M".format(env_var,env_val)) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-28T18:16:58.033

> 通过将它们提交给系统来使它们坚持下去？

我想你在这里有点困惑。没有“系统”环境。每个进程都有自己的环境作为其内存的一部分。一个进程只能改变它自己的环境。进程可以为其创建的进程设置初始环境。

如果您确实认为需要为系统设置环境变量，则需要查看在最初加载它们的位置（如 Windows 上的注册表或 Linux 上的 shell 配置文件）中更改它们。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-28T17:09:48.763

在 Windows 下，您可以使用[此配方](http://code.activestate.com/recipes/416087/)通过注册表对环境变量进行持久更改，尽管这似乎有点过头了。

为了回应布赖恩的问题，你想要完成什么？可能有更简单的方法。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-03-16T15:41:30.710

似乎有适用于 Windows 的更简单的解决方案

```
import subprocess 
subprocess.call(['setx', 'Hello', 'World!'], shell=True) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-28T16:48:48.493

我不相信你能做到这一点；我能想到两种解决方法。

1.  该`os.putenv`函数为您开始使用的进程设置环境，即 os.system、popen 等。根据您要执行的操作，也许您可​​以拥有一个主 Python 实例来设置变量，然后生成新实例。

2.  您可以运行 shell 脚本或批处理文件来为您设置它，但这变得不那么可移植了。见这篇文章：

[http://code.activestate.com/recipes/159462/](http://code.activestate.com/recipes/159462/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-29T02:57:14.910

这样想吧。

您没有设置 shell 环境变量。

您正在使用一些给定的环境变量设置生成一个子shell；这个子shell 使用修改后的环境运行您的应用程序。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T16:46:09.730

根据[这个讨论](http://bytes.com/groups/python/22914-os-environ-os-path-chdir)，你不能这样做。你想达到什么目的？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-28T16:46:48.417

您正在分叉一个新进程，并且无法更改父进程的环境，因为如果您从 shell 启动新的 shell 进程，则无法更改

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-28T19:05:00.357

您可能想尝试由 Mark Hammond 开发的[Python Win32 Extensions](http://sourceforge.net/projects/pywin32/)，它包含在[ActivePython](http://www.activestate.com/activepython/downloads)中（或可以单独安装）。[您可以在Hammond 和 Robinson 的书中](http://oreilly.com/catalog/9781565926219/)了解如何执行许多与 Windows 相关的任务。

使用*PyWin32*访问 windows *COM 对象*，Python 程序可以使用对象的[环境属性](http://msdn.microsoft.com/en-us/library/fd7hxfdd.aspx)（环境变量的集合）`WScript.Shell`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-08T11:32:52.103

尝试使用允许您通过注册表设置变量的 py-setenv

`python -m pip install py-setenv`

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-01-29T03:38:25.967

来自 Python 内部？不，做不到！

如果您未绑定到 Python，则应考虑使用 shell 脚本（sh、bash 等）。“source”命令允许您运行修改环境的脚本，并像您想要的那样“粘”到您“获取”脚本的 shell。这里发生的是 shell 直接执行脚本而不是创建一个子-process 执行脚本。

这将是非常便携的 - 您可以在 Windows 上使用 cygwin 来执行此操作。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2016-07-17T08:45:49.613

以防有人可能需要此信息。我意识到这是 7 年前问过的，但即使我有时也忘记了。.

是的，有一种方法可以让它们“粘”在窗户上。只需转到控制面板，系统，高级系统设置，当系统属性窗口打开时，您应该会看到环境变量的选项（按钮）。.根据您使用的操作系统（谷歌搜索），实现这一点的过程会有所不同。

选择它（单击按钮），然后将打开“环境变量”窗口。它有 2 个拆分窗口，最上面的一个应该是您的“用户名的用户变量”。. .选择“新”，然后简单地设置变量。例如，我的一个是“Database_Password = mypassword”。

然后在您的应用程序中，您可以像这样访问它们：import os, os.environ.get('Database_Password')。你可以做类似的事情`pass = os.environ.get('Database_Password')`。

# objective-c - 如何在十进制和整数之间拆分 NSDecimalnumber 并返回

> ID：488376
> 
> 赞同：7
> 
> 时间：2009-01-28T16:38:57.030
> 
> 标签：objective-c, cocoa, math, nsdecimalnumber

我不知道如何从 NSDecimalnumber 中获取整数和十进制值。

例如，如果我有 10,5，如何得到 10 和 5？

如果我有 10 和 5，如何返回 10,5？

* * *

嗯，好的，看起来更好！

但是，我担心丢失小数。

这是一个国际化的应用程序。例如，如果用户设置价格“124,2356”，我想加载并保存确切的数字。

* * *

嗯，好吧，就是这样，但不尊重小数位数。如果存在一种从我设置的当前本地知道的方法。

这是因为它代表货币价值......

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-29T14:39:50.323

我使用 2 作为比例尺，因为您说这是用于货币，但您可以选择使用另一个四舍五入比例尺。我也忽略了舍入可能带来的任何异常，因为这是一个非常简单的示例。

```
NSDecimalNumberHandler *behavior = [NSDecimalNumberHandler decimalNumberHandlerWithRoundingMode:NSRoundDown scale:0 raiseOnExactness:NO raiseOnOverflow:NO raiseOnUnderflow:NO raiseOnDivideByZero:NO];
NSDecimalNumber *price = /* eg. 10.5 */;
NSDecimalNumber *dollars = [price decimalNumberByRoundingAccordingToBehavior: behavior];
NSDecimalNumber *cents = [price decimalNumberBySubtracting: dollars]; 
```

这将分别在`dollars`和`cents`变量中为您提供 10 和 0.5。如果你想要整数，你可以使用这个方法将你乘以`cents`10 的幂。

```
cents = [cents decimalNumberByMultiplyingByPowerOf10: 2]; 
```

这反过来将你乘以`cents`100，得到 10 和 5 in`dollars`和`cents`。您还应该知道，您可以在这里使用 10 的负幂进行除法。

所以，

```
cents = [cents decimalNumberByMultiplyingByPowerOf10: -2]; 
```

将撤消最后一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T17:01:28.623

不确定目标 c 有什么数学函数，但类似

```
Math.floor(10.5) = 10
(10.5 - 10) * 10 = 5 
```

一个更清晰的例子（10 的 cos）

```
Math.floor(20.4) = 20
(20.4 - 20) * 10 = 4; 
```

另一个问题

```
(5 / 10) = .5
10 + .5 = 10.5 
```

小数点上使用的 10 取决于小数位数......例如

```
Math.floor(20.44) = 20
(20.44 - 20) * 100 = 44; 
```

要求你乘以 100

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T19:05:37.203

如果您无权访问数学 fns，这可能会起作用：

```
double val = [dn doubleValue]; // dn is a NSDecimalNumber*
int intPart = (int) val;
double doublePart = (val - intPart); 
```

这可能会给您带来一些麻烦，循环可能永远不会终止，在这种情况下，您将不得不在其中放置一个计数器：

```
while (doublePart != (int)doublePart) doublePart*=10; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-28T21:15:26.597

`double floor (double x);`是一个 POSIX 函数。此函数可用于查找不大于 的最大整数值`x`。

```
double x = 10.5;

double y = floor (x);
// y = 10.0

double z = x - y;
// z = 0.5 
```

# c# - DataGridView - DataTable - 显示属性

> ID：488377
> 
> 赞同：0
> 
> 时间：2009-01-28T16:38:58.403
> 
> 标签：c#, datagridview, datatable

（.NET 2.0、System.Windows.FormsDataGridView 和 DataTable）

我有 1 个数据网格连接到 1 个数据表。

该数据表包含 1 列：包含我自己类型“MyObject”的对象。
MyObject 有一个*公共*字符串属性“MyProp”。

我想在网格中显示 1 列：显示表中 MyObjects 的属性 MyProp 的字符串值。

但我似乎无法让它工作。

示意图：

*   myTable.Column1.Name：“对象”
*   myDataSet 包含 1 个表：myTable（填充了几行）
*   myBindingSource.datasource = myDataSet
*   myBindingSource.DataMember = myTable
*   myDataGridView.DataSource = myBindingSource
*   在 myDataGridView: 1 DataGridViewTextBoxColumn

*   试用一：

Column.DataPropertyName="Obj"（默认生成）

显示（覆盖）MyObject.ToString() 的结果 不是我想要的，这个函数用于记录。

*   试玩2：

GridViewColumn.DataPropertyName="Obj.MyProp"

不显示任何内容（从未调用 MyProp 的*get*）

*   试用 3：使 MyProp 属性可绑定：

    ```
    [Bindable (BindableSupport.Yes)]
    public string MyProp
    { ... 
    ```

    相同，与试用 2 没有区别

**简而言之：**

GridViewColumn.DataPropertyName 似乎不支持*进一步深入*到数据表列中的对象。

有人有什么想法吗？

提前致谢！

简

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T17:24:21.727

尝试将 Obj.MyProp 字符串值放入数据表行。将对象放入其中需要将其转换为字符串表示形式 (Obj.ToString())，这将为您提供所看到的输出。

数据表很像电子表格，而不像 Array(Of objects)。你必须这样对待它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T18:01:07.427

您只能绑定到数据源的直接属性。对于`DataTable`，这意味着列。两个选项跃入脑海：

*   不要使用`DataTable`- 只需使用`List<MyObject>`or`BindingList<MyObject>`
*   （或）覆盖`MyObject.ToString()`返回`MyProp`

第二个不是很灵活-我会选择第一个。毕竟，1-column`DataTable`真正为您做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T18:07:25.527

这可以通过 OnRowDataBound 事件来完成。

在网格视图中

1.  声明一个 onrowdatabound 方法

2.  使用模板

在方法中：

1.  抓取物体

2.  根据需要填充或操作显示

您还可以使用模板而不是默认布局来做您想做的事情。

# sharepoint - 当用户在 MOSS 上的 SharePoint 设计器中修改其 MySite 时会发生什么？

> ID：488388
> 
> 赞同：1
> 
> 时间：2009-01-28T16:41:30.597
> 
> 标签：sharepoint, moss, sharepoint-designer, mysite

我们的一位用户使用 SharePoint 设计器修改了他们的 MOSS MySite。现在所有新创建的 MySites 都包含该用户的自定义设置。

这是 MOSS 的工作方式吗？我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T20:56:29.817

他们没有修改自己的 MySite，他们修改了 person.aspx 页面（重影）。此页面用作所有后续 mysite person.aspx 页面的模板。当页面更改时，Moss 不会更新任何已创建的 mysites。

**更新**

正如[Nico](https://stackoverflow.com/users/22970/nico)指出的那样，我的语言并不准确。答案已更新以反映这一点。

他们没有修改自己的 MySite，而是修改了所有 mysite 的模板。当模板更改时，Moss 不会更新任何已创建的 mysites。

# .net - 解析来自 Web 服务的 XML 结果

> ID：488392
> 
> 赞同：2
> 
> 时间：2009-01-28T16:42:03.640
> 
> 标签：.net, xml, web-services, parsing

我是 Web 服务和 XML 的新手，我的任务是解析返回的 XML 响应数据包。

在 C#.NET 中解析 XML 结果的最佳方法是什么？

我需要绑定到数据网格作为搜索查询的最终结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T16:46:16.687

如果您有权访问 Web 服务的 wsdl，则有一个实用程序`wsdl`将生成所需的类和反序列化以调用 Web 服务并将其响应解析为这些类。

[使用w3schools](http://www.w3schools.com/webservices/tempconvert.asmx)的示例 web 服务，您只需运行以下命令行：

```
wsdl "http://www.w3schools.com/webservices/tempconvert.asmx?WSDL" 
```

这将生成一个文件 TempConvert.cs，您可以将其添加到您的项目中。那么调用webservice就是调用生成的函数：

```
Double fahrenheit = 32.2;
TempConvert tempConverter = new TempConvert();
string Celcius = tempConverter.FahrenheitToCelsius(fahrenheit.ToString()); 
```

TempConvert 类负责构建 XML 查询、联系 web 服务以及解析回复的详细信息。这是一个超级简单的示例，因此您只得到一个字符串，但由于您的 web 服务可能是稍微复杂一点，你会得到更复杂的类，其中包含你想要的解析形式的数据。根据 Web 服务的复杂性，这甚至可以像字符串数组一样简单，或者像巨大的类层次结构一样复杂。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T17:25:16.080

在决定哪种技术最好之前，您应该了解有关 XML 解析的基本知识。

对于 XMLDocument 类型的对象，整个 XML 被加载到内存中，而对于阅读器对象，它是一个流，只有正在处理的块被加载到内存中。显然，阅读器使用的内存很少，但不会让您返回/领先于正在处理的当前节点。尽管缺点是内存中有 xml 文件的副本，但您对 doc 有很大的自由度。

因此，如果预期 xml 的大小很大，那么 XmlDocument 将不是最佳的。使用 xml 应用什么样的逻辑也会影响选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T16:47:58.587

如果没有 WSDL，您可以使用下面的库

[系统文件](http://msdn.microsoft.com/en-us/library/system.xml.aspx)

你也可以使用 LINQ 你可以使用

System.Xml.Linq

LINQ 绑定的命名空间。

您需要查看数据包并找出方案是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T16:46:49.197

有很多不同的方法可以做到这一点，您可以将 xml 反序列化为一个对象，使用 LINQ-to-XML 来提取数据，将 XML 加载到 DOM 中并将数据 xpath 输出等。

你有响应数据包的 XSD 吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T16:47:01.927

在 C# 中解析 XML 的最常用方法是使用 System.XML 中的 XMLDocument。

但是，如果 Web 服务是基于 SOAP 的，那么使用它的最简单方法是将对该服务的引用添加到您的项目中，并让向导为您生成解析代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T16:47:03.863

添加：使用 System.Xml

当您仔细阅读 XML 的结构时，您会看到彼此之间的元素（请参阅对象 XmlElement 和 XmlNode）。每个都有子对象集合 (XmlNode.ChildNodes[])。

[XPath](http://en.wikipedia.org/wiki/XPath)是一种导航到特定节点或节点子集的方法。有关基本概述，请阅读[本文](http://www.go4expert.com/forums/showthread.php?t=2720)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T17:46:53.977

@LB：您没有提到解析返回的 XML 的目的是什么。如果您在 XML 中执行一些修改或查询某些特定数据，我会理解，但如果您想简单地加载它以便它可以显示在 Datagrid 中，那么我相信您有两个非常简单（和常规使用）选项：

*   直接将 DataGrid 绑定到 XML，或使用 XmlDataSource 作为中介。
*   将 XML 加载到 DataSet 中并将 DataGrid 绑定到该 Dataset。

就个人而言，我从不喜欢将 XML 转换为数据集，除非我有时间为 XML 文档创建特定的模式。所以，我倾向于第一个选项。

# linux - X窗口转发？

> ID：488396
> 
> 赞同：1
> 
> 时间：2009-01-28T16:44:14.303
> 
> 标签：linux, x11

如何转发 Linux (Debian Lenny) 下程序的 X 窗口输出？有什么建议和/或经验吗？

最简单的方法是使用新的 DISPLAY 环境变量重新启动该进程，但我根本不想取消该进程。我想要的是“即时”将 X 输出更改为另一台机器......

显然有一些“X 代理”可以为我做到这一点，但我在这方面没有任何经验，谷歌也不能给我一个快速的解决方案。

[编辑]澄清：我不想转发整个桌面（使用 VNC 或类似的）我也不想只转发一个窗口。我想转发某个进程的所有输出，而不重新启动该进程。[/edit]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T16:46:12.680

我认为这在飞行中是不可能的……但是您可以使用 VNC 来查看机器上正在发生的事情。

不是即时的，但本教程可能会有所帮助：[http ://www.vanemery.com/Linux/XoverSSH/X-over-SSH2.html](http://www.vanemery.com/Linux/XoverSSH/X-over-SSH2.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T16:54:17.793

您的程序与 X 服务器建立了一个套接字连接（可能是一个 unix 域套接字，也可能是一个 tcp/ip 套接字）。一旦打开，就无法将该套接字连接重定向到其他地方。

也许您可以在客户端和服务器之间放置一些代理（从一开始就），它将重定向到不同的服务器，但是它将如何在新服务器上的一个服务器上创建任何 X 对象？它必须非常聪明地处理之前发生的事情，并将通过套接字传来的每个 X 命令重播到新服务器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T18:48:34.430

```
ssh -Y user@server 
```

-Y 部分 telssh 到隧道 X，所以当我从客户端启动一些程序时，它将显示在我的屏幕上。缺点是客户端必须安装 X（在 Windows 上可行但不实用），它仅适用于您从客户端启动的程序，您无法连接现有的视频输出。

考虑到您的编辑，您需要查看已启动过程的视频输出，这种方法显然对您不利。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T13:57:35.940

听起来像是[xmove](http://en.wikipedia.org/wiki/Xmove)的工作。它在 [Debian](http://packages.debian.org/search?keywords=xmove&searchon=names&suite=all&section=all)中（尽管不幸的是 Lenny 似乎缺少它；也许 sid 版本可以工作？）和[Ubuntu](http://packages.ubuntu.com/search?keywords=xmove&searchon=names&suite=all&section=all)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T13:14:10.210

由于到目前为止没有给出答案，只有建议做其他事情，我想我会回答我自己的问题。:-)

我能做的最接近的事情是在 Linux 上使用 x11vnc（作为 X 服务器）和 Ultra VNC 作为 Windows 上的客户端。可能还有其他 VNC 客户端也支持连接到单个窗口，但我找到了 Ultra VNC 并停止查找。

x11vnc 和 Ultra VNC 都获得了仅转发单个窗口的协议支持。需要做一些配置，它只会转发一个窗口，而不是从同一进程创建的任何新窗口。弹出窗口和对话窗口可能会导致问题，因为它们可能会显示在桌面的未转发部分或仅显示原始窗口顶部的一部分...

这是迄今为止我发现的最不坏的解决方案。

# visual-studio - 是否可以在 Visual Studio 中插入相对于光标位置的多行代码片段？

> ID：488400
> 
> 赞同：6
> 
> 时间：2009-01-28T16:45:28.437
> 
> 标签：visual-studio, code-snippets

在 Visual Studio 中使用包含多行的代码片段时，以下行将保留在 .snippet 文件中设置的空白，而不是相对于原始光标位置定位代码。

使用 foreach 代码段时，您将获得如下代码：

```
 foreach (var item in collection)
{

} 
```

代替：

```
 foreach (var item in collection)
    {

    } 
```

有没有办法改变这种行为？.snippet 文件中是否需要使用关键字？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T16:54:12.740

片段文件的代码部分包含在保留空白的 CDATA 中。我能告诉你的最好的事情是进入文件并编辑它以满足你的需要。您唯一的其他选择是在使用代码段自动格式化代码后快速进行，这将修复缩进`Ctrl+K`。`Ctrl+D`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-28T15:30:35.810

编辑片段文件：

1.  以管理员身份打开一些文本编辑器，如记事本
2.  打开要修复的片段文件，例如 foreach.snippet。（位于我的计算机上的 C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC#\Snippets\1033\Visual C# 中）
3.  删除代码元素的前导选项卡。因此，将 Code... xml 元素从以下位置更改：

    ```
     <Code Language="csharp"><![CDATA[foreach ($type$ $identifier$ in $collection$)
            {
                $selected$ $end$
            }]]>
            </Code> 
    ```

至：

```
 <Code Language="csharp"><![CDATA[foreach ($type$ $identifier$ in $collection$)
{
    $selected$ $end$
}]]>
            </Code> 
```

# javascript - 在地图中绘图

> ID：488437
> 
> 赞同：1
> 
> 时间：2009-01-28T16:55:19.150
> 
> 标签：javascript, map

我想在地图中定义一些点，并希望通过单击它们来加入这 2 个点。基本上，功能是识别地图中的位置并通过单线连接它们。出于某种原因，我无法使用谷歌地图 API，并希望使用 JavaScript 来实现这一点。

提前致谢，米兰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T19:58:59.530

使用 HTML 本身的 Javascript 不能在两点之间产生一条线（以任何角度）。但这可以通过：

*   使用带有一些矢量图形（SVG和VML）的Javascript，谷歌地图实际上使用这种技术来做一些图形，比如路由等。[（链接）](https://developer.mozilla.org/en/SVG)
*   HTML5 CANVAS 元素（带有 excanvas 扩展以在 IE 中完成这项工作），[（链接）](https://developer.mozilla.org/En/Drawing_Graphics_with_Canvas)
*   只需将“假”行作为 html 小元素位置非常靠近彼此[（链接）](http://www.walterzorn.com/jsgraphics/jsgraphics_e.htm)

# teamcity - 在 TeamCity 上运行 Watin

> ID：488443
> 
> 赞同：17
> 
> 时间：2009-01-28T16:57:36.320
> 
> 标签：teamcity, watin

我正在尝试通过 TeamCity 运行一个简单的 Watin 测试，但 Internet Explorer 窗口从未像通常通过 CruiseControl 那样显示。

我收到一个错误，它找不到文本字段，所以有些东西正在运行。但是没有窗户我看不到什么。

我需要对 TeamCity 服务器的设置进行特定更改吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-29T11:56:49.527

[在另一个论坛](http://devnet.jetbrains.net/message/5259538)上找到这个

所有学分归马特·贝克所有

供将来尝试使用 TeamCity 自动运行 WatiN 测试的任何人参考。您必须使用`\bin\agent.bat start`而不是作为服务来启动构建代理。WatiN 需要完整的 UI 才能正确执行，并且它不会将此环境作为服务。我希望这能让其他人更容易！

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-08-05T14:54:30.143

在 Teamcity 代理的服务属性窗口 ( `services.msc`) 上的帐户选项卡下，选中“允许服务与桌面交互”，这将允许本地服务帐户生成 Internet Explorer。但是您肯定会遇到其他问题，例如 cookie 阻止、密码保存等，因此请以本地服务身份登录并修复这些问题。

最简单的方法是使用`psexec`（[http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)），调用`psexec -i -s cmd.exe`生成一个作为本地帐户运行的 cmd，然后在设置所有内容时启动 Internet Explorer（隐私本地帐户在 IE 中的设置非常高）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-27T17:06:33.737

如果您作为服务安装，请确保将其停止并禁用。然后，使用以下内容创建一个 .bat 文件

```
C:
cd teamcity\buildagent\bin\
agent.bat start 
```

现在只需在您的启动文件夹中创建此批处理文件的快捷方式！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-08T01:51:53.273

1.  停止代理服务。执行命令：从控制台 net stop TCBuildAgent。
2.  从控制台运行 c:\teamcity\buildagent\bin\agent.bat start（取决于你的 teamcity 安装路径）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-04T18:30:37.687

请尝试这个简单的解决方案：转到服务，编辑服务属性，选择登录选项卡，然后选中带有标签的框：“允许服务与桌面交互”。

在竹子里为我工作。

干杯，佩德罗·奥·莫莱罗

# java - jsp utf编码

> ID：488448
> 
> 赞同：8
> 
> 时间：2009-01-28T16:59:49.030
> 
> 标签：java, jsp, encoding, utf

我很难弄清楚如何处理这个问题：

我正在为一所意大利大学开发一个网络工具，我必须显示带有重音的单词（例如 è、ù、...）；有时我从 PostgreSql 表（UTF8 编码）中得到这些词，但大多数情况下我必须从文件中读取长段落。这些文件被编码为 utf-8 xml，并在 Smultron 或任何 utf-8 编辑器中显示良好（它们是在 python 旧文件中使用实体`&egrave;`而不是“è”来解析创建的）。

我编写了一个 java 类，它从 xml 文件中提取相关段，它的工作原理如下：

`String s = parseText(filename, position)`

如果我将返回的字符串写入文件，一切看起来都很好；问题是，如果我这样做

`out.write(s)`

在 jsp 页面中，我得到了奇怪的字符。顺便说一句，我用

`String s = getWordFromPostgresql(...)`

`out.write(s)`

在同一个jsp中，它显示OK。

有什么提示吗？

谢谢尼古拉

* * *

@[克罗森沃尔德](https://stackoverflow.com/questions/488448/jsp-utf-encoding/488467#488467)

感谢您的回复，但是该指令已经在页面中，但它不起作用（实际上它“起作用”但仅适用于我从数据库中获取的字符串）。我认为从文件中读取有些东西，但我无法理解......它们在“java”中工作但不在“jsp”中（想不出更好的解释......）

这是从实际代码中提取的一个基本示例：从文件中读取的方法返回一个 Map，从 Mark（表示文本中位置的对象）到 String（包含文本）：

这是在 .jsp 页面中（上面的帖子中引用了 utf 指令）

```
 // ...
    Map<Mark, String> map = TestoMarkParser.parseMarks(...);
    out.write(map.get(m)); 
```

这是结果：

“Fu per√≤ cos√¨ in uso il Genere Enharmonico, che quelli quali vi si esercitavano”

如果我将相同的代码放在 java 类中，并用 System.out.println 替换 out.write，结果是这样的：

“Fu però così in uso il Genere Enharmonico, che quelli quali vi si esercitavano”

* * *

我一直在用十六进制编辑器做一些分析，这里是：

原始字符串：“fu però così”

ò 在 xml 文件中：C3 B2

ò 由 jsp 文件中的 out.write() 呈现：E2 88 9A E2 89 A4

ò 通过以下方式写入文件：

```
FileWriter w = new FileWriter(new File("out.txt"));
w.write(s);     // s is the parsed string
w.close(); 
```

C3 B2

将每个字符的值打印为 int

```
0: 70 = F
1: 117 = u
2: 32 =  
3: 112 = p
4: 101 = e
5: 114 = r
6: 8730 = � 
7: 8804 = � 
8: 32 =  
9: 99 = c
10: 111 = o
11: 115 = s
12: 8730 = �
13: 168 = �
14: 10 = ` 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-28T17:06:23.230

在 jsp 页面指令中，您应该尝试将内容类型设置为 utf-8，这也会将 pageEncoding 设置为 utf-8。

```
<%@page contentType="text/html;charset=UTF-8"%> 
```

UTF-8*不是*jsp 中的默认内容类型，因此会产生各种有趣的问题。问题是底层流默认被解释为 ISO-8859-1 流。如果您将一些 unicode 字节写入此流，它们将被解释为 ISO-8859-1。我发现将编码设置为 utf-8 是最好的解决方案。

**编辑**：此外，java中的*字符串*变量应该*始终*是unicode。所以你应该总是可以说

```
System.out.println(myString) 
```

并在您的网络服务器的控制台窗口中查看正确的字符集（或者只是在调试器中停止并检查它）。我怀疑当你这样做时你会看到不正确的字符，这让我相信你在构造字符串时遇到了编码问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-19T20:07:45.773

我有一些国际 jsp [它们具有“特殊”国际（相对于英语）字符]。

在它们的顶部插入这个 [并且只有这个，即：*也没有 contentType 指令（导致重复的 contentType 错误*）] 可以让它们正确保存和呈现：

```
<%@page pageEncoding="UTF-8"%> 
```

这个参考 [http://www.inter-locale.com/codeset1.jsp] 帮助我发现了这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T18:07:08.333

```
String s = parseText(filename, position) 
```

这个方法在哪里定义？我猜这是您自己的方法，它打开文件并提取特定的数据块。在这个过程中的某个地方，它正在从字节转换为字符，可能使用 JVM 的默认编码。

如果您正在运行的 JVM 的默认编码与文件中的实际编码不匹配，那么您将在字符串中得到不正确的字符。除此之外，如果您正在阅读以多字节形式（例如 UTF-8）编码的内容，您的“位置”可能指向多字节编码的中间。

如果源文件是格式良好的 XML，那么最好使用真正的解析器（例如 JDK 中内置的解析器）来解析它们，因为解析器会提供正确的字节到字符的转换。然后使用 XPath 表达式检索值。

如果您过去没有使用过 XML 解析器，这里有两个我写的关于[解析](http://www.kdgregory.com/index.php?page=xml.parsing)和[XPath](http://www.kdgregory.com/index.php?page=xml.xpath)的文档。

* * *

编辑：您可能会发现有用的一件事是使用以下内容打印出字符串中的实际字符值：

```
public static void main(String[] argv) throws Exception
{
    String s = "testing\u20ac";
    for (int ii = 0 ; ii < s.length() ; ii++)
    {
        System.out.println(ii + ": " + (int)s.charAt(ii) + " = " + s.charAt(ii));
    }
} 
```

您可能还应该打印出您的默认字符集，以便您知道任何特定的字节序列是如何转换为字符的：

```
public static void main(String[] argv) throws Exception
{
    System.out.println(Charset.defaultCharset());
} 
```

最后，您应该将服务页面作为原始字节进行检查，以准确查看返回给客户端的内容。

* * *

编辑＃2：字符ò是Unicode值00F2，它将被UTF-8编码为C3 B2。这两个代码与您在之前的答案中显示的符号不对应。

有关 Unicode 字符的更多信息，请参阅 Unicode.org 上的[代码表](http://www.unicode.org/charts/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-26T10:33:24.420

我也有同样的问题，一切都是“utf-8”，为什么我看到
无意义的字符，问题出在 jsp 中，它必须在页面的开头。

```
 <%request.setCharacterEncoding("utf-8");%> 
```

一切都会好起来的。

# python - python 脚本可以持续更改 Windows 环境变量吗？（优雅地）

> ID：488449
> 
> 赞同：10
> 
> 时间：2009-01-28T17:00:53.553
> 
> 标签：python, windows, scripting, batch-file

继我[之前的问题](https://stackoverflow.com/questions/488294/how-can-i-make-a-windows-batch-file-which-changes-an-environment-variable)之后，是否可以制作一个持续更改 Windows 环境变量的 Python 脚本？

一旦 python 解释器终止，对 os.environ 的更改就不会持续存在。如果我在 UNIX 上编写脚本，我可能会执行以下操作：

```
set foo=`myscript.py` 
```

但是很可惜， cmd.exe 没有任何像 sh 的反引号行为那样工作的东西。我已经看到了一个非常冗长的解决方案......它'不是很漂亮，所以我们肯定可以改进这个：

```
for /f "tokens=1* delims=" %%a in ('python  ..\myscript.py') do set path=%path%;%%a 
```

微软的头脑肯定有比这更好的解决方案！

**注意：**[这个问题](https://stackoverflow.com/questions/488366/how-do-i-make-environment-variable-changes-stick-in-python)的完全重复。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T18:10:53.960

您可能想尝试由 Mark Hammond 开发的[Python Win32 Extensions](http://sourceforge.net/projects/pywin32/)，它包含在[ActivePython](http://www.activestate.com/activepython/downloads)中（或可以单独安装）。[您可以在Hammond 和 Robinson 的书中](http://oreilly.com/catalog/9781565926219/)了解如何执行许多与 Windows 相关的任务。

使用*PyWin32*访问 windows *COM 对象*，Python 程序可以使用对象的环境[属性](http://msdn.microsoft.com/en-us/library/fd7hxfdd.aspx)`WScript.Shell`- 环境变量的集合。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T18:25:05.460

Windows 根据存储在注册表中的值为每个进程独立设置环境变量。

但是，[Windows XP Service Pack 2 支持工具](http://www.microsoft.com/downloads/details.aspx?FamilyId=49AE8576-9BB9-4126-9761-BA8011FABF38&displaylang=en)中有一个名为 setx.exe 的工具，它允许您从命令行更改全局环境变量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T14:16:08.647

我使用 win32api 的解决方案：

```
import os, sys, win32api, win32con
'''Usage: appendenv.py envvar data_to_append'''
def getenv_system(varname, default=None):
    '''
    Author: Denis Barmenkov <barmenkov at bpc.ru>

    Copyright: this code is free, but if you want to use it, 
               please keep this multiline comment along with function source. 
               Thank you.

    2006-01-28 15:30
    '''
    v = default
    try:
        rkey = win32api.RegOpenKey(win32con.HKEY_LOCAL_MACHINE, 'SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment')
        try:
            v = str(win32api.RegQueryValueEx(rkey, varname)[0])
            v = win32api.ExpandEnvironmentStrings(v)
        except:
            pass
    finally:
        win32api.RegCloseKey(rkey)
    return v

#My set function
def setenv_system(varname, value):
    try:
        rkey = win32api.RegOpenKeyEx(win32con.HKEY_LOCAL_MACHINE, 'SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment',0 ,win32con.KEY_WRITE)
        try:
            win32api.RegSetValueEx(rkey, varname, 0, win32con.REG_SZ, value)
            return True
        except Exception, (error):
            pass
    finally:
        win32api.RegCloseKey(rkey)
    return False

if len(sys.argv) == 3:
    value = getenv_system(sys.argv[1])
    if value:
        setenv_system(sys.argv[1],value + ";" + sys.argv[2])
        print "OK! %s = %s" % (sys.argv[1], getenv_system(sys.argv[1]))
    else:
        print "ERROR: No such environment variable. (%s)" % sys.argv[1]
else:
    print "Usage: appendenv.py envvar data_to_append" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-28T17:00:31.677

此[链接](http://code.activestate.com/recipes/577621/)提供了使用内置`winreg`库的解决方案。

（复制面食）

```
import sys
from subprocess import check_call
if sys.hexversion > 0x03000000:
    import winreg
else:
    import _winreg as winreg

class Win32Environment:
    """Utility class to get/set windows environment variable"""

    def __init__(self, scope):
        assert scope in ('user', 'system')
        self.scope = scope
        if scope == 'user':
            self.root = winreg.HKEY_CURRENT_USER
            self.subkey = 'Environment'
        else:
            self.root = winreg.HKEY_LOCAL_MACHINE
            self.subkey = r'SYSTEM\CurrentControlSet\Control\Session Manager\Environment'

    def getenv(self, name):
        key = winreg.OpenKey(self.root, self.subkey, 0, winreg.KEY_READ)
        try:
            value, _ = winreg.QueryValueEx(key, name)
        except WindowsError:
            value = ''
        return value

    def setenv(self, name, value):
        # Note: for 'system' scope, you must run this as Administrator
        key = winreg.OpenKey(self.root, self.subkey, 0, winreg.KEY_ALL_ACCESS)
        winreg.SetValueEx(key, name, 0, winreg.REG_EXPAND_SZ, value)
        winreg.CloseKey(key)
        # For some strange reason, calling SendMessage from the current process
        # doesn't propagate environment changes at all.
        # TODO: handle CalledProcessError (for assert)
        check_call('''\
"%s" -c "import win32api, win32con; assert win32api.SendMessage(win32con.HWND_BROADCAST, win32con.WM_SETTINGCHANGE, 0, 'Environment')"''' % sys.executable) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T17:24:23.023

您冗长的解决方案可能是最好的主意；我不相信这可以直接从 Python 中实现。本文提出了另一种方法，使用临时批处理文件：

[http://code.activestate.com/recipes/159462/](http://code.activestate.com/recipes/159462/)

# asp.net - IE7的“查看源代码”按钮如何与javascript交互？

> ID：488450
> 
> 赞同：0
> 
> 时间：2009-01-28T17:00:53.600
> 
> 标签：asp.net, javascript, html, internet-explorer-7, view-source

我正在调试其他人的代码，该代码是用 ASP.NET 制作的，带有一些 javascript 效果。这是我们使用可编辑数据预先填充的表单，其中一个文本框正在填充不正确的值。

我知道文本框在后面的代码中填充了正确的值，但是在它和浏览器之间的某个地方被覆盖了。

在试图找出发生的地方时，我遇到了一个有趣的情况。如果我在有问题的元素附近右键单击并选择“查看页面源”，我可以向下滚动到该元素并查看

```
<input name="RecurrenceProperties$TextBox57" type="text" value="HEY ITS THE RIGHT VALUE" id="RecurrenceProperties_TextBox57" /> 
```

但错误的值出现在呈现的 html 和 IE 开发人员工具栏中。

这似乎是一条线索，但我对“查看源代码”的工作原理知之甚少，无法说明幕后发生的事情。在“查看源”源的生成和实际呈现的页面之间会发生什么？

编辑：我通过在 javascript 中出现的 ID 的任何地方放置一个断点来发现它出错的地方（不是很优雅，但我找到了它）。

禁用 javascript 和使用 IE8 的建议非常有帮助。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T17:08:17.080

您通过“查看源代码”看到的是已获取的原始 HTML。HTML 不包括通过 DHTML/JavaScript 完成的任何更改。

* * *

## 更新

受 Manik 评论的启发，这是一个跨浏览器¹的书签，用于显示内部**呈现**`<body>`的内容：

```
javascript:"<pre>"+document.body.innerHTML.replace(/([&<>])/g,function(c){return"&"+{"&":"amp","<":"lt",">":"gt"}[c]+";";})+"</pre>" 
```

¹虽然似乎不适用于 Safari。有谁知道为什么？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T17:15:14.790

如果您想查看 javascript 对您的页面有什么影响，请在页面上使用 IE8 或 FireFox/Firebug 来查看它在（不）在做什么。

他们还将为您提供有关 Css 样式的信息，如果情况实际上是显示了错误的元素，而隐藏了正确的元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T17:22:49.080

如前所述，“查看源代码”将显示服务器发送的 HTML，通过 JavaScript 进行的修改不会反映在“查看源代码”中。

我建议寻找任何可能修改“RecurrenceProperties_TextBox57”文本框值的 JavaScript 代码。检查`<script type="text/javascript"></script>`引用文本框的任何代码的源区域。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T17:23:44.007

如果是我，我要做的第一件事就是禁用 javascript 并加载页面。这将缩小您的错误很快出现的范围，特别是如果您怀疑 javascript 有问题。

至于视图源正在做什么，它向您展示了浏览器正在解释什么......从服务器发送的代码。这些代码都没有在视图源代码中执行。

# c++ - 为什么我在 Visual Studio 2008 中无法获得像样的功能浏览器？

> ID：488456
> 
> 赞同：3
> 
> 时间：2009-01-28T17:03:31.567
> 
> 标签：c++, visual-studio, visual-studio-2008

没有办法为我列出 C++ 解决方案中的函数......我有一个类浏览器，但这没有帮助，因为这个项目没有类。我需要一个 c++ 文件中所有函数的简单列表，然后只需双击一个即可跳转到其源（作为侧窗格，而不是下拉菜单）......我必须在这里遗漏一些东西，因为我已经看过了谷歌搜索了这么简单的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T17:09:28.433

在使用 Visual Studio 的 10 年中，我从未找到一种内置的方法来做到这一点。但是，[Visual Assist X](http://www.visualassist.com/)会在其大纲视图中为您执行此操作。缺点是它不是免费的，但我发现它是在 Visual Studio 中使用 C++ 的重要工具。恕我直言，物有所值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T17:12:18.320

对象浏览器/类视图在“全局函数和变量”、“全局类型定义”和“宏和常量”下列出了自由浮动函数和类型（在英文版中可能会有所不同）。它显示了解决方案中的所有函数，而不仅仅是 C++ 文件中的函数。

选项卡和代码编辑器之间的导航栏显示了当前 C++ 文件中的所有函数，尽管它是一个组合框，因此您需要单击一次将其打开并再次跳转到它:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T17:24:08.250

我同意这不是很直观，但我认为最接近的方法是转到类视图并选择“全局函数和变量”。顾名思义，这将为您提供项目中所有全局函数和变量的列表，所有这些都在“类视图”窗格中。据我所知，整个解决方案都没有办法做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T17:13:53.527

在源文件中，如果您右键单击一个函数（例如，它在标题中声明的位置，或从另一个函数使用/调用的位置），那么我认为上下文菜单上有一个“转到定义”。

类似地，浏览器数据库（即`*.bsc`文件）窗口（根据某些键绑定由什么显示`<Alt><F12>`）：那不是也列出了全局函数，可能以“ `::`”为前缀吗？

# vim - vi / vim - 如何将标签标签/标题长度设置为固定大小的字符

> ID：488462
> 
> 赞同：9
> 
> 时间：2009-01-28T17:05:25.743
> 
> 标签：vim, tabs, vi

当我在 vi/vim(7.2) 中打开新选项卡时，如果打开的文件位于不同的路径中，选项卡标题会显示完整路径并占用屏幕空间，因此其他选项卡不可见。这意味着我无法使用鼠标单击我想要的选项卡，但必须使用 : & 键盘命令在选项卡之间移动。

有什么办法可以将选项卡标题限制为最大“大小/长度”，所以我只能看到远程相对路径中文件的最后 12 个字符？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-01-21T00:02:03.433

你可以通过设置 'guitablabel' 很好地为 gvim 做这件事。

这是我的 .gvimrc 的摘录，它将默认值修改为仅显示文件名的最多 12 个字符，但保留修改后的缓冲区的“+”。工具提示未修改，因此您可以从中获取完整路径，或者在命令模式下按 Ctrl-G。

```
如果版本 >= 700
    "设置 showtabline 显示多个选项卡时
    设置 showtabline=1
    "设置标签标签最多显示 12 个字符
    设置 guitablabel=%-0.12t%M
万一

" 不在 GUI 中显示工具栏（仅菜单）
设置 guioptions-=T

" 不显示撕下菜单
设置 guioptions-=t

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T19:07:09.790

回答我自己的问题：

在阅读了上面的[Chad Birch](https://stackoverflow.com/users/41665/chad-birch)并在谷歌上搜索设置表格后，我发现了[TabLineSet](http://vim.sourceforge.net/scripts/script.php?script_id=1507)插件可以解决问题，以及一些脚本解释[here](http://tech.groups.yahoo.com/group/vim/message/67176?threaded=1&var=1&p=2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T17:11:49.507

```
:help setting-tabline 
```

似乎有相关信息，但我对vim脚本不够熟悉，无法帮助您获得所需的确切效果。希望其他人可以从这一点开始。

另见：

```
:help statusline 
```

有关打印各种信息的一些信息，这应该很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-10T21:23:34.747

我发现以下[博客文章](http://blog.golden-ratio.net/2008/08/19/using-tabs-in-vim/)是最简洁的。

该链接提供了以下功能，应将其放置在您的`.gvimrc`文件中。

```
function! GuiTabLabel()
    " add the tab number
    let label = '['.tabpagenr()

    " modified since the last save?
    let buflist = tabpagebuflist(v:lnum)
    for bufnr in buflist
        if getbufvar(bufnr, '&modified')
            let label .= '*'
            break
        endif
    endfor

    " count number of open windows in the tab
    let wincount = tabpagewinnr(v:lnum, '$')
    if wincount > 1
        let label .= ', '.wincount
    endif
    let label .= '] '

    " add the file name without path information
    let n = bufname(buflist[tabpagewinnr(v:lnum) - 1])
    let label .= fnamemodify(n, ':t')

    return label
endfunction

set guitablabel=%{GuiTabLabel()} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-06T10:00:46.533

根据总标签标签长度动态调整标签标签长度的示例。（这适用于控制台版本的 vim）。把它放在你的 .vimrc 的末尾

```
if exists( '+showtabline' )
    function! MyTabLine()
        let s = ''
        let wn = ''
        let t = tabpagenr()
        let i = 1

        let cnt = 0
        let totalLen = 0
        while i <= tabpagenr( '$' )
          let winnr = tabpagewinnr( i )
          let buflist = tabpagebuflist( i )
          let bufnr = buflist[winnr - 1]
          let file = bufname( bufnr )
          let buftype = getbufvar( bufnr , 'buftype' )
          if buftype == 'nofile'
              if file =~ '\/.'
                  let file = substitute( file , '.*\/\ze.' , '' , '' )
              endif
          else
              let file = fnamemodify( file , ':p:t' )
          endif
        "<Number><Space><file><Space>
          let totalLen = totalLen + 3 + len(file)
          let i = i + 1
        endwhile

        let i = 1 
        while i <= tabpagenr( '$' )
            let buflist = tabpagebuflist( i )
            let winnr = tabpagewinnr( i )
            let s .= '%' . i . 'T'
            let s .= ( i == t ? '%1*' : '%2*' )
            let wn = tabpagewinnr( i ,'$' )

            let s .= '%#TabNum#'
            let s .= i
            "let s .= '%*'
            let s .= ( i == t ? '%#TabLineSel#' : '%#TabLine#' )
            let bufnr = buflist[winnr - 1]
            let file = bufname( bufnr )
            let buftype = getbufvar( bufnr , 'buftype' )
            if buftype == 'nofile'
                if file =~ '\/.'
                    let file = substitute( file , '.*\/\ze.' , '' , '' )
                endif
            else
                let file = fnamemodify( file , ':p:t' )
            endif

            "echo totalLen . "/" . &columns . ", file=" . file
            if totalLen > &columns && len(file) > 16
                let file = strpart( file, 0, 6 )  . "~" . strpart( file, len(file)-10 )
            endif
            if file == ''
                let file = '[No Name]'
            endif
            let s .= ' ' . file . ' '
            let i = i + 1
        endwhile
        let s .= '%T%#TabLineFill#%='
        let s .= ( tabpagenr('$') > 1 ? '%999XX' : 'X' )
        return s
    endfunction
    set stal=2
    set tabline=%!MyTabLine()
    highlight link TabNum Special
endif 
```

# sql-server - 在 SSIS 中的 DerivedColumn 数据流任务中检查数字

> ID：488463
> 
> 赞同：3
> 
> 时间：2009-01-28T17:05:26.057
> 
> 标签：sql-server, sql-server-2005, ssis, expression

有什么方法可以检查 Sql Server Integration Services 2005 中数据流任务的派生列/条件拆分中的字段是否为数字。

功能应该类似于 ISNUMERIC() 函数。

目前我正在使用

`((DT_NUMERIC,12,0)fieldname= (DT_NUMERIC,12,0)fieldname)`

在派生列表达式中检查字段名称是否为数字。但是如果字段名称包含像 123ABC 这样的字符而不是数字 123，则上面的表达式会因为转换失败而引发异常，并且包执行会停止。

如果我们有一个像 ISNUMERIC() 这样的函数，那么我们就不需要做所有这些马戏团了。有谁知道在 SSIS 中是否有这样的功能来检查该字段是否为数字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T17:23:29.780

我们使用以下技术：

1.  在派生列组件的属性表单上，您可以单击标记为“配置错误输出”的按钮以调出错误输出配置。

2.  将此列（或任何其他列）的错误和截断操作配置为“忽略失败”

3.  现在，如果该列的转换连续失败，包将继续执行。该行的列值将设置为空。您可以使用后续组件来检查空值，并采取适当的措施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T17:13:08.023

您可以重定向错误行并处理错误。或者使用脚本任务。

# ruby-on-rails - Rails - make_resourceful 与嵌套资源

> ID：488484
> 
> 赞同：0
> 
> 时间：2009-01-28T17:13:20.720
> 
> 标签：ruby-on-rails, rest

我在我的 Rails 应用程序中使用[make_resourceful](http://mr.hamptoncatlin.com/)插件，并尝试使用嵌套资源。

我的控制器代码如下所示：

```
class ClientRegionsController < ApplicationController
  make_resourceful do
    actions :all
    belongs_to :client

    response_for(:create) do |format|
      format.html { redirect_to client_client_regions_path }
    end

    response_for(:update) do |format|
      format.html { redirect_to client_client_regions_path }
    end
  end

  private

  def current_objects
    @current_objects ||= ClientRegion.paginate(:page => params[:page], :order => "name")
  end
end 
```

我想在索引操作中获得的是给定客户端的所有 client_regions，即：

```
 client_1.client_regions 
```

我实际得到的是系统中的所有客户区域，即：

```
ClientRegion.all 
```

我一直在为此挠头，所以我想我会在这里问。

奇怪的是其他操作按我的预期工作，只是索引操作有问题。

编辑：我的路线定义为

```
map.resources :clients, :has_many => :client_regions 
```

所以路径是

```
/clients/1/client_regions
/clients/1/client_regions/new
/clients/1/client_regions/20/edit 
```

ETC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T10:24:43.223

好的 - 我自己解决了这个问题。

我留下了一些代码来简化它，但这就是问题的根源。（已编辑问题以将其放回）

解决方法是将 current_objects 方法更改为

```
def current_objects
    @current_objects ||= @client.client_regions.paginate(:page => params[:page], :order => "name")
end 
```

事后看来真的很明显......

# javascript - noscript 标签，如果未启用，我需要提供替代 html

> ID：488492
> 
> 赞同：3
> 
> 时间：2009-01-28T17:16:03.210
> 
> 标签：javascript, html, detect

如果用户的浏览器上未启用 JavaScript，是否可以用 HTML 替换 javascript？

我知道我可以使用`<noscript>this displays in place of javascript</noscript>`

这工作正常，但它仍然运行 javascript。

理论上我想要这个：

如果启用了 javascript，则
  运行 javascript

如果未启用
  javascript，请不要运行 javascript 并提供替代方法

我正在使用这个 jQuery 插件： http: [//malsup.com/jquery/cycle/int2.html](http://malsup.com/jquery/cycle/int2.html)

当我在 safari 上禁用 javascript 时，它会显示所有三个项目，都在一个 div 中。该插件淡入每个项目，但禁用它会连续显示所有三个项目，而不会像启用 javascript 那样淡入和淡出。

禁用 javascript 后，我​​想阻止它同时显示所有三个项目。我将向您展示它的外观以及禁用 JavaScript 时的作用。

禁用视图： http: [//i42.tinypic.com/212y1j6.png](http://i42.tinypic.com/212y1j6.png)（注意它们 3 堆叠在彼此之上） - 我想阻止这种情况发生，因为 JavaScript 被禁用

启用视图：http: [//i39.tinypic.com/9gwu3d.png](http://i39.tinypic.com/9gwu3d.png)

这是项目所在的 div 的代码：

```
$(document).ready(function() {
    $('#featured-programs-left').cycle({ 
        fx:     'fade', 
        speed:  'slow',
        timeout: 15000,
        next:   '#next2',
        prev:   '#prev2' 
    });
});

<div id="featured-programs-left">

<div>
    <a href="http://site.com/academics/majors/emergency_medical_technician_-_paramedic/" title="Emergency Medical Technician - Paramedic"><img src="http://site.com/images/uploads/images/emt.jpg" alt="Emergency Medical Technician - Paramedic" /></a>
    <strong>Emergency Medical Technician - Paramedic</strong>
    <p>This unique A.A.S. degree program, a partnership between College and Faxton-St. Luke&#8217;s Healthcare provides the paramedic student the education necessary to function in an</p> 
    <p><a href="http://site.com/academics/majors/emergency_medical_technician_-_paramedic/" title="Learn more about Emergency Medical Technician - Paramedic">Learn more</a></p>
</div>

<div>
    <a href="http://site.com/academics/majors/travel_tourism_hospitality_events_management/" title="Travel &amp; Tourism: Hospitality &amp; Events Management"><img src="http://site.com/images/uploads/images/hospitality_event_planning.jpg" alt="Travel &amp; Tourism: Hospitality &amp; Events Management" /></a>
    <strong>Travel &amp; Tourism: Hospitality &amp; Events Management</strong>
    <p>This program prepares students for exciting careers in the travel and tourism industry and the hospitality and events planning field. Graduates are prepared to:<br</p> 
    <p><a href="http://site.com/academics/majors/travel_tourism_hospitality_events_management/" title="Learn more about Travel &amp; Tourism: Hospitality &amp; Events Management">Learn more</a></p>
</div>

<div>
    <a href="http://site.com/academics/majors/fashion_buying_merchandising/" title="Fashion Buying &amp; Merchandising"><img src="http://site.com/images/uploads/images/fashion_merchandising.jpg" alt="Fashion Buying &amp; Merchandising" /></a>
    <strong>Fashion Buying &amp; Merchandising</strong>
    <p>This program prepares graduates for careers throughout the Fashion Industry including positions in buying, fashion merchandising, retail and wholesale sales, retail</p> 
    <p><a href="http://site.com/academics/majors/fashion_buying_merchandising/" title="Learn more about Fashion Buying &amp; Merchandising">Learn more</a></p>
</div>

</div> 
```

div的CSS

```
#featured-programs-left img,
#featured-programs-right img{
    xfloat:left;
    overflow:auto;
    xclear:left;
    xwidth:351px;
    xpadding:0 5px 5px 0;
    border:0;
}

#featured-programs-left,
#featured-programs-right {
    height:625px;
    float:left;
    overflow:auto;
    clear:left;
    clear:right;
    width:100%;
    xborder:2px solid red;
}

#featured-programs-left div,
#featured-programs-right div {
    xborder:1px solid purple;
    overflow:auto;
    clear:left;
    clear:right;
    width:352px;
    height:345px;
}

#featured-programs-left {
    float:left;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T17:24:37.470

使用的替代方法`<noscript>`是在页面加载后立即使用 JavaScript 隐藏某个元素。如果 JavaScript 被禁用，则元素将保持显示状态。如果启用了 JavaScript，您的脚本将被执行并且元素将被隐藏。

```
window.onload = function () {
    document.getElementById("no_script").style.display = "none";
}

<div id="no_script">
You don't have JavaScript enabled.
</div> 
```

* * *

## 更新

如果你想做相反的事情（在启用 JavaScript 时显示一些 HTML），你总是可以使用各种方法将新元素注入到 DOM 树中。这是一个：

```
$(document).ready(function() {
    $('#container').html($('#content').html());
});

<div id="container"></div>
<script type="text/html" id="content">
    <div>Your <em>HTML</em> goes here</div>
</script> 
```

[感谢John Resig](http://ejohn.org/blog/javascript-micro-templating/)在`<script type="text/html">`HTML 中隐藏 HTML 模板的技巧。浏览器显然不会执行或呈现`<script>`非常规类型的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T22:45:02.500

有点像[Ates 的解决方案](https://stackoverflow.com/questions/488492/noscript-tag-i-need-to-present-alternative-html-if-not-enabled#488536)，您可以使用 Javascript 为启用它的用户更改内容。例如，假设您有一个精美的菜单，它为 Javascript 用户提供了超级简单的导航，但对非 JS 用户毫无价值。在 HTML 中将显示属性设置为“无”，然后使用 JS 启用它。在您的情况下，如果您有不想向非 JS 用户显示的内容，您可以默认隐藏它。缺点是如果浏览器关闭了 JS 和 CSS，这将不起作用。如果您对此感到担心，可以使用 JS 插入内容。

```
<html>
<head>
  <script>
    $(document).ready(function() {
      $('.jsok').show();
    });
  </script>
  <style>
    .jsok { display: none; }
  </style>
 </head>
 <body>
   <div class="jsok"><!-- content for JS users here--></div>
   <div><!-- content for everyone here --></div>
   <noscript><!-- content for non-js users here --></noscript>
 </body>
 </html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T17:23:22.853

如果启用了脚本，它将运行脚本。如果您想暂存 <noscript> 行为，请在浏览器中禁用 JavaScript 并尝试一下。

# .net - 带有 PHP 客户端的 WCF 服务 - 复杂类型作为参数不起作用

> ID：488497
> 
> 赞同：3
> 
> 时间：2009-01-28T17:17:38.030
> 
> 标签：.net, php, wcf

我有一个具有三种方法的 WCF 服务。其中两个方法返回自定义类型（这些按预期工作），第三个方法将自定义类型作为参数并返回一个布尔值。当通过 PHP soap 客户端调用第三个方法时，它返回一个“对象引用未设置为对象实例”异常。

**示例自定义类型：**

_ 公共课 MyClass

```
Private _propertyA As Double
<DataMember()> _
Public Property PropertyA() As Double
    Get
        Return _propertyA
    End Get
    Set(ByVal value As Double)
        _propertyA = value
    End Set
End Property

Private _propertyB As Double
<DataMember()> _
Public Property PropertyB() As Double
    Get
        Return _propertyB
    End Get
    Set(ByVal value As Double)
        _propertyB = value
    End Set
End Property

Private _propertyC As Date
<DataMember()> _
Public Property PropertyC() As Date
    Get
        Return _propertyC
    End Get
    Set(ByVal value As Date)
        _propertyC = value
    End Set
End Property 
```

结束类

**方法：**

公共函数 Add(ByVal param As MyClass) As Boolean 实现 IService1.Add ' ... 结束函数

**PHP客户端调用：**

$client->Add(array('param'=>array('PropertyA' => 1, 'PropertyB' => 2, 'PropertyC' => "2009-01-01" )));

WCF 服务适用于 .Net 客户端，但我是 PHP 新手，无法使其正常工作。

是否可以在 PHP 中创建“MyClass”的实例。

任何帮助，将不胜感激。

注意：我使用的是 PHP 5（Windows 的 XAMPP 1.7.0）。

谢谢

马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-10-05T08:58:19.787

我不再有 XAMPP 设置以进行测试，但这里有一些示例代码：

PHP：

```
$wsdl = "https://....../ServiceName.svc?wsdl";
$endpoint = "https://...../ServiceName.svc/endpointName";
$client = new SoapClient($wsdl, array('location'=>$endpoint));

$container = new stdClass();

$container->request->PropertyA = 'Test 1';
$container->request->PropertyB = 'Test 2';
$container->request->PropertyC = '05/10/2010';

$response = $client->ServiceMethodA($container); 
```

request 是 Web 服务预期的参数名称。

如果您有一个引用其他自定义类型的自定义类型，您可以按如下方式设置这些属性：

```
$container->request->OtherCustomType->Property1 = 'Test'; 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T17:28:03.123

我敢打赌这是因为您使用 Date 类型作为参数之一，并且它没有通过 PHP 正确序列化。尝试使用字符串并手动解析它。我知道，不是很安全，但你能做什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T09:51:11.637

我尝试将 MyClass 中的所有属性类型更改为 String，但仍然出现相同的错误。

我还尝试使用 $myClassInstance = new $Client->MyClass(); 实例化 MyClass；但这会产生以下错误：

“类名必须是文件名.php 中的有效对象或字符串”

上面是否需要服务命名空间，例如 $myClassInstance = new $Client->Namespace\MyClass()？

服务的 wsdl 不包含 MyClass 的任何描述。MyClass 类具有**DataContract()**和**ServiceKnownType(GetType(MyClass))**属性，并且所有属性都应用了**DataMember()**属性，但在 wsdl 中仍然没有提及 MyClass。这可能是php无法实例化它的原因吗？

谢谢

马特

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-14T17:42:13.313

本守则

$myClassInstance = new $Client->MyClass(); 是语法错误

但是这段代码

$myClassInstance = 新的 $Client->MyClass; 虽然这段代码有效

这是正确的语法删除双括号

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-03T06:07:56.617

wcf 中的 wsdl 与旧的 Web 服务有很大不同，它将 xsd 拆分为不同的文件。请仔细阅读你的wsdl，你应该可以看到这样的几行

这是你xsd。

# python - Datastore 中的一对多关系和 Google App Engine 中的取消引用

> ID：488498
> 
> 赞同：4
> 
> 时间：2009-01-28T17:17:57.747
> 
> 标签：python, google-app-engine

我在两个实体之间有一对多的关系：第一个是卫星，第二个是频道。卫星表单返回一个卫星名称，我希望它出现在另一个 HTML 页面中，其中包含频道数据，您可以在其中说该频道与该卫星相关。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T18:13:02.200

这听起来像是使用 App Engine 的 Datastore API 一部分的 ReferenceProperty 的好案例。这是一个让您入门的想法：

```
class Satellite(db.Model):
  name = db.StringProperty()

class Channel(db.Model):
  satellite = db.ReferenceProperty(Satellite, collection_name='channels')
  freq = db.StringProperty() 
```

有了这个，你可以像这样分配通道：

```
my_sat = Satellite(name='SatCOM1')
my_sat.put()
Channel(satellite=my_sat,freq='28.1200Hz').put()
... #Add other channels ... 
```

然后循环遍历给定卫星对象的通道：

```
for chan in my_sat.channels: 
  print 'Channel frequency: %s' % (chan.freq) 
```

无论如何，这几乎遵循[这篇](http://code.google.com/appengine/articles/modeling.html)描述如何在 App Engine 中建模实体关系的文章。希望这可以帮助。

# asp.net - ASP.NET 会员密码？

> ID：488499
> 
> 赞同：1
> 
> 时间：2009-01-28T17:17:59.243
> 
> 标签：asp.net, asp.net-membership

如果我要求密码长度在 7 到 16 个字符之间并至少包含 1 个数字密码，然后发送一个不包含数字字符和 % 符号和 ^ 符号的临时密码，密码会失败吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T17:50:35.217

你会没事的。它仅在您更改它时检查复杂性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T17:27:45.823

我不相信。只有在创建或更改密码时才应检查密码复杂性要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T17:28:01.847

IIRC，临时密码将遵循您建立的规则。我会使用 MembershipUser 方法：ResetPassword，为用户创建所有临时密码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T17:29:44.540

我建议创建所有临时密码以匹配密码复杂性规则。

但是，这些规则仅在更改密码时执行，而不是在您登录时执行。

不应使用百分比符号，以防它被误解为转义的十六进制。

# python - MS Outlook CDO/MAPI 阻止 Python 文件输出？

> ID：488504
> 
> 赞同：1
> 
> 时间：2009-01-28T17:19:56.963
> 
> 标签：python, winapi, outlook, mapi

这是我遇到的问题的一个例子。我正在使用 Python Win32 扩展来访问 Outlook 邮箱并检索邮件。

下面是一个应该将“hello world”写入文本文件的脚本。我需要从 Outlook 邮箱中获取一些消息，但我发现了一些奇怪的东西。附加到邮箱一次后，我无法再将任何内容打印到文件中。这是显示问题的精简版本：

```
#!/usr/bin/env python

from win32com.client import Dispatch

fh = open('foo.txt', 'w')
fh.write('hello ')
fh.close()

session = Dispatch('MAPI.session')
session.Logon('','',0,1,0,0,'exchange.foo.com\nprodreport');
session.Logoff()

fh = open('foo.txt', 'a')
fh.write('world')
fh.close() 
```

如果我不附加到邮箱并注释掉以下行，它显然可以正常工作：

```
session = Dispatch('MAPI.session')
session.Logon('','',0,1,0,0,'exchange.foo.com\ncorey');
session.Logoff() 
```

为什么在我的脚本中间打开与邮箱的会话会阻止进一步的文件输出？有任何想法吗？（其他操作不被阻塞，只是这个文件 i/o asfaik）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:12:38.007

回答我自己的问题。当您阅读电子邮件时，您的工作目录似乎发生了变化。如果您将其重新设置，则您的文件 i/o 工作正常。

正确的脚本如下所示：

```
#!/usr/bin/env python

import os
from win32com.client import Dispatch

fh = open('foo.txt', 'w')
fh.write('hello ')
fh.close()

cwd = os.getcwd()

session = Dispatch('MAPI.session')
session.Logon('','',0,1,0,0,'exchange.foo.com\ncorey');
session.Logoff()

os.chdir(cwd)

fh = open('foo.txt', 'a')
fh.write('world')
fh.close() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T11:15:22.607

是的，在使用 CDO/MAPI 时，目录更改是一个已知的问题。它在 MSDN 的某处“记录”（例如[http://support.microsoft.com/kb/269170](http://support.microsoft.com/kb/269170)）。您可以像这样在 Python 中轻松复制它：

```
 import os
import win32com.client

print os.getcwd ()
win32com.client.Dispatch ("MAPI.Session")
print os.getcwd () 

```

# emacs - Emacs lgrep 中的扩展 RE？

> ID：488516
> 
> 赞同：1
> 
> 时间：2009-01-28T17:22:07.053
> 
> 标签：emacs

Mx lgrep 的默认值是使用 -e 作为模式。我想使用 -E，但看起来 -e 被硬编码到 grep.el 中。告诉我我错了！有什么提示吗？（我使用的是 22.1 版 - 23 版的草更绿了吗？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T18:16:07.537

如果您使用 的`C-u`前缀`M-x lgrep`，您可以在执行之前编辑生成的命令行。`grep-command`是 Emacs 的各种 grep 函数使用的默认命令字符串，您可以`M-x customize-variable RET grep-command`更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T18:11:37.343

如果了解您的问题，解决方案可能是更改**grep-command**变量。

此变量的默认值设置为：“grep -nH -e”，您可能希望将“-e”更改为“-E”

# php - 基于数据映射器的多态域对象

> ID：488518
> 
> 赞同：0
> 
> 时间：2009-01-28T17:22:30.203
> 
> 标签：php, oop, dns, data-access-layer

我有一个基本的域对象，比如由数据库中的单个表表示的 Person 或 Campaign 或 Event。但是，我也有这些对象的更复杂版本，例如 PersonCampaign 或 PersonEvent 甚至是理论上可以扩展基础对象之一的 CampaignEvent。

然而，由于多种原因，这变得复杂，因为 PHP 不支持多重继承（例如 PersonEvent 扩展 Person 或 Event）。并且还因为一些域对象实际上是具有不同属性和功能的工厂对象（例如，事件实际上是按电子邮件、电话、传真等事件类型的子类）。

我能看到的最简单的解决方案是根据从数据访问层返回的数据来更改对象的实际性质。

有没有人有更好的方法来处理这个问题？或者创建可以根据数据访问层当前可用的内容更改属性和行为的统一域对象是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-01T16:34:57.920

一个解决方案是封装其他对象：

PersonEvent 类包含一个 Person 和一个 Event。

可通过函数 $PersonEvent->get_event() 或属性 $PersonEvent->Event 访问；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-01T16:54:04.620

从 OOP 的角度来看，PersonEvent 并不是真正的对象，而是一种关系。

Person 类可以获得如下功能：

```
get_events()
add_event($Event)
remove_event($Event) 
```

和事件类

```
get_person()
set_person($Person)
unset_person() // set person_id to NULL 
```

（假设人和事件之间存在 1:N 的关系）

不好的部分是，这会使数据映射器复杂化或根本不会使用数据映射器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T17:55:34.660

有这样的设置怎么样：

表：人员、销售人员、客户人员等。人员表存储有关人员的所有子类型的通用信息。然后还有其他表 FK'd 到 person 表。它存储有关该子类型的其他唯一信息。

您的对象要么扩展，要么调用通用的“人”对象来访问主要数据，然后调用它的唯一类型对象来访问该子类型的唯一数据？

# django - Django settings.EMAIL_HOST_USER 问题

> ID：488528
> 
> 赞同：0
> 
> 时间：2009-01-28T17:23:40.107
> 
> 标签：django, email, settings

我需要一些关于 django 电子邮件的帮助。我已将 settings.EMAIL_HOST_USER 设置为“do-not-re...@mysite.com”，每当我尝试在任何情况下发送电子邮件时，都会使用“do-not-re...@mysite”。 com' 作为来自地址并发送它，即使我在发送该特定电子邮件时提供了不同的发件人地址。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T18:29:53.187

EMAIL_HOST_USER 仅用于邮件服务器上的身份验证。

您可能还需要设置 DEFAULT_FROM_EMAIL。

# apache - 导入/导出 Apache Jackrabbit 存储库的最佳方式

> ID：488537
> 
> 赞同：6
> 
> 时间：2009-01-28T17:24:39.653
> 
> 标签：apache, import, export, repository, jackrabbit

从 Apache Jackrabbit 存储库导入/导出数据的最佳方式是什么？

现在，我有一个基于存储库的网站，服务器中有超过 100GB 的数据，但我经常需要在我的笔记本中获取这些数据的子集以进行本地演示。

我怎样才能以最简单和最快的方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T17:28:11.550

谷歌搜索我最好的选择是这个工具：http: [//svn.apache.org/repos/asf/jackrabbit/sandbox/jackrabbit-jcr-import-export-tool/README.txt](http://svn.apache.org/repos/asf/jackrabbit/sandbox/jackrabbit-jcr-import-export-tool/README.txt)

但是，仅从 README 文件来看，它看起来并不是很可靠。

另一个问题是它需要我提前知道我要导出的所有文件的文件名，这会很麻烦，因为我提取的主要标准是复制最新的文件，即使用创建日期作为筛选。

理想的解决方案是让我像在常规文件系统中一样浏览存储库中的文件，并使用简单的复制工具来提取数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T19:02:22.383

我自己正在调查这个。Session.exportSystemView() 和 Session.importXML() 会起作用吗？这些显然允许您将子树序列化/反序列化为 XML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-05T21:13:18.587

遗憾的是，没有那么多通用的 JCR 工具。Sling 有两个 jcr explorer，一个基于 GWT，另一个基于 JS，但都没有导出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-16T09:41:42.140

Day有CRX，但要花一些钱

# php - 在 Windows XP 上创建虚拟 LAMP 机器的最简单方法是什么？

> ID：488561
> 
> 赞同：10
> 
> 时间：2009-01-28T17:31:24.817
> 
> 标签：php, mysql, linux, apache, virtual-machine

我需要在我的 XPSP3 机器上设置一个运行 Apache、MySQL 和 PHP 的测试环境。我最初的测试环境是一个在 Win2k 下运行这三个的旧盒子。那个盒子死了。在 Windows 上运行从来都不是最优的，因为最终的托管环境是 CentOS Linux。

现在在 XP 上设置虚拟机最直接的方法是什么？当我可以编码时，我不想把所有的时间都花在修补测试环境上。

作为一个后续问题，在我的测试环境中使用与我的部署相同的发行版有多重要？我根本不了解 CentOS，但我对 Fedora 或 Ubuntu 很满意。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-28T17:34:29.197

下载免费的[VMWare 播放器并安装来自](http://www.vmware.com/products/player/)[VMWare 设备市场](http://www.vmware.com/appliances/directory/)的预制开源 LAMP VM 之一。除设备市场外，许多地方也提供虚拟机。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-28T17:48:19.293

虚拟机很棒——我爱他们。但是，如果您真的急于开始，请查看适用于 Windows 的 WAMPserver： [http ://www.wampserver.com/en/](http://www.wampserver.com/en/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-28T18:01:11.437

VMWare 要求您提交您的联系信息以下载 VMWare 服务器。

[Sun 的 VirtualBox](http://www.virtualbox.org/)完成了这项工作，您无需注册或麻烦即可下载该应用程序。使用“主机网络”进行设置，您将能够通过 SSH 在您的 LAN 中使用其自己的 IP 地址连接到 LAMP 实例。

[单击此处下载预构建的 Virtual Box 映像](http://sourceforge.net/projects/virtualboximage)，类似于 VMWare 虚拟设备。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-28T18:54:36.647

我认为最快最简单的方法是使用 VirtualBox 和 Ubuntu Server 映像：

1.  [从http://www.virtualbox.org/wiki/Downloads](http://www.virtualbox.org/wiki/Downloads)获取 VirtualBox
2.  获取 Ubuntu 服务器镜像[http://downloads.sourceforge.net/virtualboximage/ubuntu-8.10-server-x86.7z（LAMP](http://downloads.sourceforge.net/virtualboximage/ubuntu-8.10-server-x86.7z)服务器未安装，MySQL root 密码为 toor）
3.  在某处提取图像
4.  安装 VirtualBox
5.  打开 VirtualBox，转到文件 > 虚拟媒体管理器
6.  单击添加按钮并转到提取图像的路径，选择它并单击确定。（您已创建硬盘映像）
7.  现在在 VB 的主窗口中单击 New 以创建新机器。下一个
8.  为其设置一个名称并设置“操作系统->“其他”和“版本”->“其他/未知”。下一步
9.  将基本内存至少设置为 256mb。下一个
10.  现在选择您已经创建的高清图像。下一个
11.  结束。现在转到新创建的虚拟机，右键单击并选择“设置”
12.  在常规选项中单击高级选项卡并选择启用 PAE/NX 和 VT-x/AMD-V（如果您的 CPU 支持）。点击确定
13.  您现在可以选择并启动您的虚拟机
14.  **使用ubuntu**登录:reverse

现在你有一个 LAMP 服务器 ;) 信息在这里[Ubuntu 服务器指南](https://help.ubuntu.com/8.10/serverguide/C/index.html)

* * *

学分：

*   VirtualBox - [http://www.virtualbox.org/](http://www.virtualbox.org/)
*   VirtualBox 图片项目 - [http://virtualbox.wordpress.com/](http://virtualbox.wordpress.com/)
*   Ubuntu 服务器[http://www.ubuntu.com/products/whatisubuntu/serveredition](http://www.ubuntu.com/products/whatisubuntu/serveredition)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-28T17:36:36.057

尝试以下 VMWare LAMP 设备之一或 Google“vmware lamp”了解更多信息：

*   [http://www.rpath.org/project/lamp/](http://www.rpath.org/project/lamp/)
*   [http://canned-os.blogspot.com/2006/10/grandmas-lamp-its-easy-enough-for.html](http://canned-os.blogspot.com/2006/10/grandmas-lamp-its-easy-enough-for.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-28T17:41:39.057

上次我去那里寻找 ISO 时，我很确定 CentOS 站点有一个可供下载的虚拟机，但我现在找不到它……也许我把它与其他东西混淆了。无论如何，获取 CentOS ISO 很容易，您只需将它们安装到虚拟机中即可。或者，正如其他人所说，您可以查看 VM 市场。我认为[这](http://www.vmware.com/appliances/directory/60819)可能正是您所需要的，但我看起来并不难。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T17:33:58.043

www.xampp.org

就是这样

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-28T17:39:21.557

使用免费版本的[VMWare Server](http://www.vmware.com/products/server/)或其[VM Player](http://www.vmware.com/products/player/)与免费的[LAMP 堆栈虚拟设备](http://www.vmware.com/appliances/directory/854)（预配置的 VM）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-28T18:03:34.923

其他人已经将您指向 VMware 的虚拟设备商店，所以我将回答您的另一个问题：如果您对 Fedora 感到满意，那么您应该可以很好地应对 CentOS，因为这两个发行版都是基于 RedHat 的。出于这个原因，我建议您使用与生产环境完全相同的发行版；发行版之间的差异通常很小，但有时可能会咬人。

再见！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-13T15:14:57.140

All this Wamps and Xaamps are not necessary. The best way to use LAMP on Windows is by manually installing it. This way you are in control and you will also learn a lot. It is very simple so here's my howto on this topic:

[LAMP on Windows](http://www.techytalk.info/2009/03/apache-mysql-php-server-on-windows/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-02-08T04:04:42.993

为 Windows 版 WAMPserver 投票：[http ://www.wampserver.com/en/](http://www.wampserver.com/en/)

I tried a VM but it required too many resources on my netbook (yes netbook) and it adds the complexity of yet another OS to manage, backup and move files to and from. Basically my time is too limited to be playing with yet another OS.

With the WAMPServer installed, I just needed to set an ALIAS to my existing project location, load my data into MySQL and I was good to go.

I really wish I would have found it eons ago.

I would have upvoted the other answer but I don't yet rate.. :)

# windows-services - Microsoft 服务间通信问题

> ID：488565
> 
> 赞同：1
> 
> 时间：2009-01-28T17:32:44.130
> 
> 标签：windows-services, msmq, message-queue

我目前正在构建两个 Windows 服务：

*   第一个从互联网连接获取消息并将这些消息插入数据库。这是为了快速稳定而设计的，不做任何其他处理

*   第二个对自上次运行以来到达的任何新消息执行批处理。

我正在尝试一种方法，以便第二个服务仅在准备好处理新消息时运行其批处理，并且如果第二个服务出错，则第一个服务将继续运行，反之亦然。目前它每 5 秒使用一次循环。

我目前正在考虑使用消息队列，其中第一个服务仅在队列为空时写入消息，第二个服务将查看队列是否包含任何消息，如果不进入异步等待直到消息到达然后删除消息并运行。因此，使用队列并不是真正的队列，而是作为一个二进制开关，当它的状态改变时会导致一个事件被触发到第二个服务。

我想有一种更好的方法可以做到这一点，我还没有遇到过有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T17:58:12.113

实际上，您的方式正是**我**将如何实现这些结果。使用 MSMQ，您不必检查是否有消息写入队列，第一个服务只是写入队列，第二个服务只是从中读取以处理它（当它处于活动状态时）。

使用 MSMQ 的美妙之处在于，一个或另一个服务可以关闭，但*队列*会上升，因此您可以继续处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-08T18:49:23.577

在我看来，对于这种情况，您所需要的只是一个邮槽。第一个服务存储到数据库中，然后发送“待办事项”消息。另一个只是等待入站消息。

对于这么简单的事情，MSMQ 有点重量级。然后，您也可以使用 MSMQ 并完全摆脱该数据库。 *那*将是做到这一点的方法。

# tdd - D3 与 TDD 最佳实践

> ID：488581
> 
> 赞同：8
> 
> 时间：2009-01-28T17:38:29.250
> 
> 标签：tdd

哪一个为大型软件提供更多优势，比如 Photoshop？

另外，TDD 不仅仅指单元测试，因为您也可以在 D3 中使用单元测试，但与 TDD 的方式不同。

D3：设计驱动开发

TDD：测试驱动开发

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-03-17T21:41:11.177

DDD = 领域驱动**设计**

TDD 意味着在您编写任何行为单元之前，您必须对该行为进行测试，并且仅对该行为进行测试。只有在这些测试失败后，您才会实施该行为。在我看到的每一个化身中，TDD 都处于方法或类的级别——可能是几个类一起工作。最终结果是您获得了高度可测试的代码，因此代码非常松散。归根结底，TDD 是关于创建可以测试的代码。

DDD 是一种更为抽象的哲学和一组设计模式，用于解决如何设计一个大型、可扩展和可维护的系统。归根结底，DDD 是关于创建一个隐含或显式捕获重要领域知识的代码生态系统。

所以你看，它们当然不是相互排斥的。我认识的几乎所有熟悉 DDD 的人都是 TDD 的铁杆爱好者。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-03-08T14:59:18.600

TDD 既不是自下而上的，也不是在编码之前编写测试。TDD 是关于使用测试来推动开发，目标是在交付之前对代码进行测试。它首先要确保用户需求以使自动化用户验收测试成为可能的形式编写。它继续通过集成和功能测试到单元测试。最终，单元测试确实占据了最大的份额。

应该首先编写测试的原因是因为当考虑（设计）问题的解决方案时，您会自动期望解决方案应该做什么。任何期望都可以表示为测试，那么为什么不立即记录期望并同时对其进行自动化测试以确保解决方案实现该目标呢？

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-28T17:47:19.590

我也不认为它们是相互排斥的，我认为您可以使用 TDD 来获得 DDD。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-10T12:23:33.570

在我看来，当您首先（在 TDD 中）编写测试时，您就是在设计系统。如果我们不能先写测试，说明需求有歧义。我们可以在测试之前编写故事并将其用作已知的规范`Test As Specification`。通过测试后，我们可以使用测试作为已知文档`Test As Document`。当新的开发人员添加到项目中时，他们可以使用这些测试来学习系统业务。

在 DDD 中，您只需使用故事来创建对象之间的关系。在 DDD 中重要的是您应该只关注域。例如，在编写领域业务逻辑时，您不应该担心在数据库中保存实体。简而言之，在编写业务逻辑时，您不应该考虑领域之外的任何事情。

# audio - SoX wav 声音播放

> ID：488585
> 
> 赞同：0
> 
> 时间：2009-01-28T17:38:36.253
> 
> 标签：audio, wav, playback

我试过这个：

```
sox -u -r 11.025k -b 8 -c 1 infile.wav outfile.wav 
```

但是当我播放时声音是乱码且无法识别。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T17:48:03.630

尝试这个：

```
sox -t wav infile.wav -r 11025 -b 8 -c 1 outfile.wav 
```

你说的方式，参数被应用到`infile.wav`，而不是`outfile.wav`。

# c# - 调用 INotifyPropertyChanged 的 PropertyChanged 事件的最佳方式是什么？

> ID：488587
> 
> 赞同：10
> 
> 时间：2009-01-28T17:39:11.463
> 
> 标签：c#, .net, .net-3.5, inotifypropertychanged, automatic-properties

当您实现 INotifyPropertyChanged 接口时，您负责在每次更新类中的属性时调用 PropertyChanged 事件。

这通常会导致以下代码：

```
 public class MyClass: INotifyPropertyChanged

        private bool myfield;
        public bool MyField
        {
            get { return myfield; }
            set
            {
                if (myfield == value)
                    return;
                myfield = value;
                OnPropertyChanged(new PropertyChangedEventArgs("MyField"));
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        private void OnPropertyChanged(PropertyChangedEventArgs e)
        {
            PropertyChangedEventHandler h = PropertyChanged;
            if (h != null)
                h(this, e);
        }
   } 
```

即每个属性**12 行。**

如果能够像这样装饰自动属性，那就简单多了：

```
[INotifyProperty]
public double MyField{ get; set; } 
```

但不幸的是，这是不可能的（例如，请参阅 msdn 上的[这篇文章）](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=2298922&SiteID=1)

如何减少每个属性所需的代码量？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T19:11:08.247

*实际上，每个属性*只有 3-4 行；其他行在所有“通知”属性上*摊销：*

```
class Person : INotifyPropertyChanged
{
    #region INotifyPropertyChanged: Shared bit
    public event PropertyChangedEventHandler PropertyChanged;

    private void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, e);
    }
    #endregion

    private string _firstName;
    public string FirstName
    {
        get { return _firstName; }
        set
        {
            if (_firstName == value)
                return;
            _firstName = value;
            OnPropertyChanged(new PropertyChangedEventArgs("FirstName"));
        }
    }

    // Ditto for other properties
} 
```

您可以尝试以下类似的方法，它会分担更多负载：

```
private string _firstName;
public string FirstName
{
    get { return _firstName; }
    set { SetNotifyingProperty("FirstName", ref _firstName, value); }
}
private void SetNotifyingProperty<T>(string propertyName,
                                     ref T field, T value)
{
    if (value.Equals(field))
        return;
    field = value;
    OnPropertyChanged(new PropertyChangedEventArgs(propertyName));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T17:39:45.253

我现在要做的是在课堂上写这个：

```
 //AUTOGENERATE INotifyProperty
 private bool myfield; 
```

我写了一个小工具，它在部分类中生成所有需要的属性代码。这绝不是一个优雅的解决方案，但它有效:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-16T12:35:56.620

外包是最有意义的。

使用以下代码编写一个类（ObservableObject）：

```
class ObservableObject : INotifyPropertyChanged
{
  public event PropertyChangedEventHandler PropertyChanged;

  protected void OnPropertyChanged(string name)
  {
    PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(name));
  }
} 
```

由于受保护，从此类派生的所有类都可以访问该方法。

例子：

```
class Example : ObservableObject
{
  //propfull
  private string name;
  public string Name
  {
    get {return name;}
    set 
    {
      name = value;
      OnPropertyChanged(nameof(Name));
    }
  }
} 
```

# mysql - JPA EntityManager 使用区分大小写的键查找

> ID：488592
> 
> 赞同：11
> 
> 时间：2009-01-28T17:40:16.797
> 
> 标签：mysql, jpa, find, case-sensitive, entitymanager

我正在尝试使用 JPA EntityManager find() 方法。我的主键是一个与用户名相对应的字符串。

我正在使用 JPA / Hibernate / MYSQL。

我的问题是搜索用户 'David' 匹配用户 'david'，我认为是由于底层 MYSQL 中不区分大小写的字符串匹配。这给我带来了一大堆问题！

有没有人对此有一个优雅的解决方案？我可以进行本机 SQL 调用并使用此处记录的 BINARY 运算符：http: [//dev.mysql.com/doc/refman/5.0/en/charset-binary-op.html](http://dev.mysql.com/doc/refman/5.0/en/charset-binary-op.html)

有人有更好的解决方案吗？塔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T17:54:13.947

您可以更改列类型以使其不区分大小写吗？[MySQL 指南](http://dev.mysql.com/doc/refman/5.0/en/case-sensitivity.html)提供了有关如何执行此操作的信息。

这或多或少是您使用 BINARY 运算符发现的，但它适用于列类型，而不是在您运行*SELECT时*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-10-04T07:58:29.310

[有一个类似的问题](https://stackoverflow.com/questions/7609087/database-independent-string-comparison-with-jpa)。您必须将表或整个数据库的排序规则设置为区分大小写的排序规则。

请参阅： [参考手册 12.1.10 CREATE DATABASE SYNTAX](http://dev.mysql.com/doc/refman/5.5/en/create-database.html)和 [9.1.3.2。数据库字符集和排序规则](http://dev.mysql.com/doc/refman/5.5/en/charset-database.html)

# ado.net - 如何使用 ADO.NET 请求数据库产品名称？

> ID：488600
> 
> 赞同：1
> 
> 时间：2009-01-28T17:41:57.323
> 
> 标签：ado.net, odbc, database

我开发了一个具有自定义数据库配置的产品。我将 ADO.NET 与 System.Data.Odbc.OdbcConnection 一起使用。为了在数据库之间做出一些区别，有一个简单的解决方案来检测连接的当前 DBMS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T18:33:58.653

我认为 OdbcConnection.Driver 属性在 OP 的上下文中可能更合适，因为 ServerVersion 应该只返回版本号。

Driver 属性将返回 DLL 的名称，例如 SQL Server 的“Sqlsrv32.dll”。然后OP可以应用基于案例的逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T17:49:07.577

connection.Database 可以工作，或者您可以执行

```
select db_name() 
```

扩展connection.Database

```
connection.Open();
        Console.WriteLine("ServerVersion: " + connection.ServerVersion
            + "\nDatabase: " + connection.Database);
        connection.ChangeDatabase("master");
        Console.WriteLine("ServerVersion: " + connection.ServerVersion
            + "\nDatabase: " + connection.Database);
        Console.ReadLine(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T18:54:55.033

我找到了以下解决方案：

```
DataTable td = conn.GetSchema(DbMetaDataCollectionNames.DataSourceInformation);
DataRow info = td.Rows[0];
String name = info[DbMetaDataColumnNames.DataSourceProductName]; 
```

例如，这将返回**Microsoft SQL Server**，并且与驱动程序无关。

# regex - 你如何对正则表达式进行单元测试？

> ID：488601
> 
> 赞同：63
> 
> 时间：2009-01-28T17:42:00.087
> 
> 标签：regex, unit-testing, tdd

我是 TDD 的新手，我发现 RegExp 是一个非常特殊的案例。是否有任何特殊的方法来对它们进行单元测试，或者我可以将它们视为常规功能吗？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-01-28T17:52:10.797

您应该始终测试您的正则表达式，就像任何其他代码块一样。它们最多是一个函数，它接受一个字符串并返回一个布尔值，或者返回一个值数组。

这里有一些关于在为 regexen 设计单元测试时要考虑什么的建议。这些不是单元测试设计的硬性规定，而是一些指导你思考的指导方针。与往常一样，权衡您的测试需求与失败成本以及实施它们所需的时间。（我发现“实施”测试很容易！:-]）

需要考虑的要点：

*   将每个组（括号）视为一个花括号。
*   想想每一个 | 作为条件。确保测试每个分支。
*   将每个修饰符（*、+、?）视为不同的路径。
*   （上面的旁注：记住 *、+、? 和 *?、+? 和 ?? 之间的区别。）
*   对于 \d、\s、\w 和它们的否定，在每个范围内尝试几个。
*   对于 * 和 +，您需要为每个测试“无值”、“一个”和“一个或多个”。
*   对于重要的“控制”字符（例如，您要查找的正则表达式中的字符串）进行测试，看看如果它们出现在错误的位置会发生什么情况。这可能会让你大吃一惊。
*   如果您有真实世界的数据，请尽可能多地使用它。
*   如果不这样做，请确保测试应该有效的简单和复杂表单。
*   确保测试插入时正则表达式控制字符的作用。
*   确保验证空字符串是否被正确接受/拒绝。
*   确保验证每个不同类型的空格字符的字符串是否被正确接受或拒绝。
*   确保正确处理不区分大小写（i 标志）。在文本解析中（除了空格），这几乎比其他任何事情都更让我感到痛苦。
*   如果您有 x、m 或 s 选项，请确保您了解它们的作用并对其进行测试（此处的行为可能不同）

对于返回列表的正则表达式，还请记住：

*   验证您期望的数据是否以正确的顺序在正确的字段中返回。
*   验证轻微的修改不会返回好的数据。
*   验证混合的匿名组和命名组是否正确解析（例如，`(?<name> thing1 ( thing2) )`） - 根据您使用的正则表达式引擎，此行为可能会有所不同。
*   再一次，进行大量现实世界的试验。

如果您使用任何高级功能，例如非回溯组，请确保您完全了解该功能的工作原理，并使用上述指南，构建适用于和反对每个功能的示例字符串。

根据您的正则表达式库实现，捕获组的方式也可能不同。Perl 5 有一个'open paren order' 排序，C# 有一部分，除了命名组等等。确保尝试您的口味，以确切了解它的作用。

然后，将它们与您的其他单元测试直接集成到它们自己的模块中或与包含正则表达式的模块一起。对于特别讨厌的正则表达式，您可能会发现需要进行大量测试来验证模式和您使用的所有功能是否正确。如果正则表达式构成了该方法所做的大部分（或几乎所有）工作，我将使用上面的建议来设计输入以测试该函数，而不是直接测试正则表达式。这样，如果稍后您决定该正则表达式不是要走的路，或者您想分解它，您可以在不更改接口的情况下捕获正则表达式提供的行为 - 即调用正则表达式的方法。

只要您真的知道正则表达式功能应该如何以您的正则表达式风格工作，您就应该能够为它开发体面的测试用例。只要确保您真的、真的、真的了解该功能的工作原理！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-28T17:53:10.593

只需向它抛出一堆值，检查您是否得到正确的结果（无论是匹配/不匹配还是特定的替换值等）。

重要的是，如果有任何你*想*知道它们是否会起作用的极端情况，请在单元测试中捕获它们并在评论中*解释*它们为什么起作用。这样，其他想要更改正则表达式的人将能够检查极端情况是否仍然有效，并且会提示他们如何修复它如果它坏了。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-28T17:48:06.437

大概您的正则表达式包含在类的方法中。例如：

```
public bool ValidateEmailAddress( string emailAddr )
{
    // Validate the email address using regular expression.
    return RegExProvider.Match( this.ValidEmailRegEx, emailAddr );
} 
```

您现在可以为此方法编写测试。我想重点是正则表达式是一个实现细节——您的测试需要测试接口，在这种情况下，它只是验证电子邮件方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T17:45:51.030

我将创建一组具有预期输出值的输入值，就像所有其他测试用例一样。

另外，我可以彻底推荐免费的 Regex Tool [Expresso](http://www.ultrapico.com/Expresso.htm)。这是一个很棒的正则表达式编辑器/调试器，过去让我免于痛苦。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T17:46:30.123

我总是像执行任何其他功能一样测试它们。确保它们与您认为它们应该匹配的东西匹配，并且它们不匹配它们不应该匹配的东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-28T20:32:54.093

我喜欢针对相反的正则表达式测试正则表达式，我将针对可能的测试执行两者并确保交叉点为空。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-05-05T06:29:39.133

考虑首先编写测试，并且只编写通过每个测试所需的正则表达式。如果您需要扩展您的正则表达式，请通过添加失败测试来实现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-28T17:56:01.260

我认为一个简单的输入输出测试就足够了。随着时间的流逝，在某些情况下您的正则表达式会失败，请不要忘记在修复时将这些情况也添加到测试中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-16T14:34:58.407

在您选择的单元测试库中使用固定装置并遵循通常的 TDD 方法：

*   检查：测试是绿色的
*   通过为下一个“功能”添加测试来打破测试
*   通过调整正则表达式使其变为绿色（不破坏现有测试）
*   重构正则表达式以获得更好的可读性（例如，命名组、字符类而不是字符范围，...）

这是 spock 作为测试运行程序的示例夹具存根：

```
@Grab('org.spockframework:spock-core:1.3-groovy-2.5')
@GrabExclude('org.codehaus.groovy:groovy-nio')
@GrabExclude('org.codehaus.groovy:groovy-macro')
@GrabExclude('org.codehaus.groovy:groovy-sql')
@GrabExclude('org.codehaus.groovy:groovy-xml')

import spock.lang.Unroll

class RegexSpec extends spock.lang.Specification {
  String REGEX = /[-+]?\d+(\.\d+)?([eE][-+]?\d+)?/

  @Unroll
  def 'matching example #example for case "#description" should yield #isMatchExpected'(String description, String example, Boolean isMatchExpected) {
    expect:
    isMatchExpected == (example ==~ REGEX)

    where:
    description                                  | example        || isMatchExpected
    "empty string"                               | ""             || false
    "single non-digit"                           | "a"            || false
    "single digit"                               | "1"            || true
    "integer"                                    | "123"          || true
    "integer, negative sign"                     | "-123"         || true
    "integer, positive sign"                     | "+123"         || true
    "float"                                      | "123.12"       || true
    "float with exponent extension but no value" | "123.12e"      || false
    "float with exponent"                        | "123.12e12"    || true
    "float with uppercase exponent"              | "123.12E12"    || true
    "float with non-integer exponent"            | "123.12e12.12" || false
    "float with exponent, positive sign"         | "123.12e+12"   || true
    "float with exponent, negative sign"         | "123.12e-12"   || true
  }
} 
```

它可以作为独立的 groovy 脚本运行，例如

```
groovy regex-test.groovy 
```

免责声明：该片段摘自我几周前写的一系列博客文章

*   [使用 Java 和 JUnit 4 的正则表达式 TDD](http://metamorphant.de/blog/posts/2019-03-21-tdd-regex-junit-parameterized-tests/)
*   [使用 Groovy 和 Spock 的正则表达式 TDD](http://metamorphant.de/blog/posts/2019-04-30-tdd-regex-spock-data-driven-tests/)
*   [使用 clojure.test 的正则表达式 TDD](http://metamorphant.de/blog/posts/2019-05-01-tdd-regex-clojure.test-tests/)

# .net - 如何在此 RegEx 中指定可选的捕获组？

> ID：488614
> 
> 赞同：5
> 
> 时间：2009-01-28T17:45:18.770
> 
> 标签：.net, regex

**如何修复此 RegEx 以选择性地捕获文件扩展名？**

我正在尝试将字符串与可选组件匹配，但似乎有问题。（匹配的字符串来自打印机日志。）

我的正则表达式（.NET 风格）如下：

```
.*(header_\d{10,11}_).*(_.*_\d{8}).*(\.\w{3,4}).*
-------------------------------------------
.*                   # Ignore some garbage in the front
(header_             # Match the start of the file name,
    \d{10,11}_)      #     including the ID (10 - 11 digits)
.*                   # Ignore the type code in the middle
(_.*_\d{8})          # Match some random characters, then an 8-digit date
.*                   # Ignore anything between this and the file extension
(\.\w{3,4})          # Match the file extension, 3 or 4 characters long
.*                   # Ignore the rest of the string 
```

我希望这可以匹配以下字符串：

```
str1 = "header_0000000602_t_mc2e1nrobr1a3s55niyrrqvy_20081212[1].doc [Compatibility Mode]"
str2 = "Microsoft PowerPoint - header_00000000076_d_al41zguyvgqfj2454jki5l55_20071203[1].txt"
str3 = "header_00000000076_d_al41zguyvgqfj2454jki5l55_20071203[1]" 
```

捕获组返回如下内容：

```
$1  =  header_0000000602_
$2  =  _mc2e1nrobr1a3s55niyrrqvy_20081212
$3  =  .doc 
```

如果未找到文件扩展名，则 $3 可以为空。$3 是可选部分，您可以在上面的 str3 中看到。

如果我添加“？” 到第三个捕获组“(.\w{3,4})?”的末尾，RegEx 不再为任何字符串捕获 $3。如果我添加“+”而不是“(.\w{3,4})+”，RegEx 将不再捕获 str3，这是意料之中的。

我觉得使用“？” 在第三个捕获组的末尾是适当的事情，但它不像我预期的那样工作。我可能对我用来忽略部分字符串的“。*”部分太天真了。

没有按预期工作：

```
.*(header_\d*_).*(_.*_.{8}).*(\.\w{3,4})?.* 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T17:49:11.240

一种可能性是倒数第二个`.*`是贪婪的。您可以尝试将其更改为：

```
.*(header_\d*_).*(_.*_.{8}).*?(\.\w{3,4})?.*
                             ^ Added that 
```

这是不正确的，这将匹配您提供的输入，但它假定`.`它遇到的第一个是文件扩展名的开头：

```
.*(header_\d*_).*(_.*_.{8})[^\.]*(\.\w{3,4})?.* 
```

**编辑：**删除我在第二个正则表达式中的转义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T18:00:07.023

我相信问题出在您的 3rd`.*`上，您在上面用“忽略此和文件扩展名之间的任何内容”进行了注释。它是贪婪的，所以它会匹配任何东西。当您将扩展模式设为可选时，第三个`.*`匹配到字符串的末尾，这是允许的。`.`假设在那个无关位中永远不会有 ' ' 字符，您可以替换`.*`为`[^.]*`，其余部分有望在您恢复`?`必须删除的之后工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T17:53:00.267

好吧，`.*`可能是启动正则表达式的错误方式 - 它会匹配`*`任何 (.) 的 0 个或多个 ( ) 单个字符 ...这意味着您的整个文件名将仅与它匹配。如果您将其关闭，则正则表达式将在达到`header`您想要的内容时开始匹配。您也可以将其替换为`\w`匹配分词符。我还建议使用诸如[The Regex Coach](http://www.weitz.de/regex-coach/)之类的工具，这样您就可以逐步检查它，看看到底出了什么问题以及您的捕获组将是什么。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T18:19:44.563

在您的第二个匹配项中指定您只想匹配所有没有句点的字符，*然后*为您的扩展名进行匹配。

```
".*(header_\d{10,11}_).*(_.*_\d{8})[^.]*(\.\w{3,4})?" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T18:37:55.993

这是你的正确结果

```
.*?(header_\d*_).*?(_.*_.{8})[^.]*(\.\w{3,4})?.*
-------------------------------------------
.*?                  # Prevent a greedy match
(header_             # 
    \d{10,11}_)      # 
.*?                  # Prevent a greedy match
(_.*_\d{8})          # 
[^.]*                # Take everything that is NOT a period
(\.\w{3,4})          # Match the extension
.*                   # 
```

隐含的假设是，句点将是数字匹配后文件扩展名的开头。以下不符合此要求：

```
string unmatched = "header_00000000076_d_al41zguyvgqfj2454jki5l55_20071203[1].foobar.txt" 
```

**此外**，在 .NET 中取出您的组时，请确保您的代码如下所示：

```
regex.Match(string_to_match).Groups[1].Value
regex.Match(string_to_match).Groups[2].Value
regex.Match(string_to_match).Groups[3].Value 
```

而不是这个：

```
// 0 index == string_to_match
regex.Match(string_to_match).Groups[0].Value
regex.Match(string_to_match).Groups[1].Value
regex.Match(string_to_match).Groups[2].Value 
```

这是一开始让我绊倒的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T18:11:15.767

这适用于您发布的示例：

```
^.*?(?<header>\d+)_.*?_(?<date>\d{8}).*?(?:\.(?<ext>\w{3,4}))?[\w\s\[\]]*$ 
```

我假设文本“标题”以及它与日期之间的随机字符并不重要，因此此正则表达式不会捕获这些字符。为了清楚起见，我还使用了 .NET 命名捕获功能，但请注意，其他风格的 RegEx 不支持它。

如果文件名后面的文本包含 [ 和 ] 以外的任何非字母数字字符，则需要修改模式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T18:31:17.943

这是适用于您发布的内容的内容：

```
^.*(?<header>header_\d{10,11})_.*(?<date>_[a-z0-9]+_\d{8})(\[\d+\])(?<ext>(\.[a-zA-Z0-9]{3,4})?).* 
```

替换是：

```
Header: $1
Date: $2
Extension: $4 
```

我没有在替换中使用命名组，因为我不知道如何让 TextMate 执行此操作，但命名组有助于强制捕获。

# installation - Wix 重大升级

> ID：488620
> 
> 赞同：11
> 
> 时间：2009-01-28T17:46:48.813
> 
> 标签：installation, wix, windows-installer

如何在“重大升级”期间使用 WIX 防止覆盖配置文件？

我希望在初始安装时安装该文件，在卸载时删除该文件，并在“主要升级”时保持不变。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-28T18:02:24.320

最直接的方法是在 InstallExecute 或 InstallFinalize 之后安排 RemoveExistingProducts。这样配置文件不会被删除然后再次安装（就像您在 InstallInitialize 之前安排的那样）。当然，这么晚安排 RemoveExistingProduct 意味着您需要非常小心您的组件规则。

我个人最喜欢的是将配置视为“用户数据”，而根本没有 installtouch 它。您随应用程序提供默认设置，但任何更改都由用户在其私人用户配置文件中进行。让您摆脱在设置过程中无法很好解决的各种令人讨厌的迁移问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T18:32:39.233

你想要它被覆盖吗？如果不是这种情况，我将配置文件分配给它们自己的组件并将它们标记为**Never Overwrite**。这样升级不会覆盖文件，但卸载会删除它。

例如

```
<Component Id="myComp" Guid="myguid" NeverOverwrite="yes"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T18:24:06.100

您可以使用 UPGRADINGPRODUCTCODE 属性来检查您是否正在升级。我们使用它来确定是否应该运行“清理”自定义操作：

```
<Custom Action="" After="CleanUpFiles">
  <![CDATA[REMOVE="ALL" AND NOT UPGRADINGPRODUCTCODE]]>
</Custom> 
```

我同意 Rob 的观点，因为配置是用户数据，存储在他们的 AppData 文件夹中，并且从未由 MSI 创建。相反，它被设置为默认值（我们将其作为默认配置存储在程序文件中），并由应用程序本身复制。但是如果用户想卸载我们的产品，我们不想让这些东西弄乱用户的机器，所以我们制作了一个 CleanUpFiles 来搜索 HD 以查找任何遗留的垃圾。

# php - php媒人

> ID：488635
> 
> 赞同：0
> 
> 时间：2009-01-28T17:49:48.057
> 
> 标签：php, tracking

我认为在 php 中有一个简单的媒人代码很酷。这个想法是应用程序连接到服务器或特定网页，网页将其 IP 和最后一个 X ips 并在页面上打印（他的第一个）

问题是当 5 ppl 在同一秒点击页面时会发生什么。我该如何处理？我不能使用全局/共享内存？所以我需要将IP写入文件并每次读取/写入它们（10x同一秒）会很糟糕吗？我想它可以很慢，但如果可能的话，我希望对其进行优化。

存储在mysql数据库中更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T17:52:12.857

我建议使用 APC 将信息缓存在内存中。这仅适用于 1 台服务器。对于多台服务器，您应该查看类似 memCacheD 的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T17:55:29.777

我不太确定您为什么要费心这样做，除非作为学习练习，但是您基本上会将信息保留在某个地方，即使只是相对较短的时间，并且您需要合理的事务语义。

可能最简单的选择是选择数据库；MySQL 会很好，如果您真的不需要将数据存储特别长时间，那么您不妨使用内存表 - 为此使用`MEMORY`（或`HEAP`）存储引擎。以这种方式使用数据库意味着您不必太担心并发写入冲突等问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T17:56:40.633

您无需将请求者的 IP 写入文件 - Apache 已经为您完成了。只需 grep /var/log/httpd/access_log 文件的最后几行（如果您在 linux 上），您将找到有关服务器收到的最后请求的信息 - IP、referer、URL。而且它们是连载的。

再见！

# windows - 如何使用 windows api 检查用户是否具有对文件的访问权限

> ID：488637
> 
> 赞同：1
> 
> 时间：2009-01-28T17:51:00.567
> 
> 标签：windows, security, winapi

我正在尝试为 Windows 编写一个简单的函数来回答以下问题。

用户 (U) 是否对文件 (F) 拥有权限 (R)？
其中，
   R 是 (GENERIC_READ, GENERIC_WRITE, GENERIC_EXECUTE) 的某种组合
   U 不必登录或模拟

我编写的代码如下所示。应用程序调用显示的第一个 UserHasPermission。

GetEffectiveRightsFromAcl 返回的访问权限对于我测试的所有用户/文件组合 ($001200A9) 都是相同的。我仔细检查了一下，$001200A9 不仅仅是一个指向实际存储访问权限的位置的指针。

我的问题是双重的：
1.有没有更好的方法呢？
2\. 谁能告诉我哪里出错了？

```
函数 UserHasPermission(APermission: Longword; out HasPermission: Boolean; AFileName: WideString; AUserName: String; ADomainName: String): Boolean;
    变量
      SID：PSID；
      ACL：PACL；
    开始
      SID := 无；
      ACL := 无；
      尝试
        结果 := GetUserSID(SID, AUserNAme, ADomainName);
        结果 := 结果和 GetFileDACL(AFileName, ACL);
        结果 := Result 和 UserHasPermission(APermission, HasPermission, ACL, SID);
      最后
        处置（SID）；
      结尾;
    结尾;

    功能 UserHasPermission(APermission: Longword; out HasPermission: Boolean; AACL: PACL; AUserSID: PSID): Boolean;
    变量
      T：受托人；
      权限：ACCESS_MASK；
    开始
      BuildTrusteeWithSid(@T, AUserSID);
      结果 := GetEffectiveRightsFromAcl(AACL, @T, @Rights) = ERROR_SUCCESS;
      HasPermission := (Rights and APermission) = APermission;
    结尾;

    函数 GetUserSID（出 ASID：PSID；AUserName：WideString；const ADomainName：WideString）：布尔值；
    变量
      NSID，NDomain：长字；
      使用：SID_NAME_USE；
      域名：WideString；
    开始
      结果：=错误；
      如果长度（AUserName）> 0 那么
        开始
          如果长度（ADomainName）> 0 则
            AUserName := ADomainName + '\' + AUserName;

          // 确定内存需求
          NSID := 0;
          NDomain := 0;
          LookupAccountNameW(nil, PWideChar(AUserName), nil, NSID, nil, NDomain, Use);

          //分配内存
          获取内存（ASID，NSID）；
          SetLength(域名, NDomain);

          结果 := LookupAccountNameW(nil, PWideChar(AUserName), ASID, NSID, PWideChar(DomainName), NDomain, Use);
        结尾;
    结尾;

    函数 GetFileDACL(AFileName: WideString; out AACL: PACL): Boolean;
    变量
      SD：PSecurityDescriptor；
      NSD，NN需要：长字；
      目前，已取消：Longbool；
    开始
      GetFileSecurityW(PWideChar(AFileName), DACL_SECURITY_INFORMATION, nil, 0, NNeeded);
      GetMem(SD, NNeeded);
      尝试
        NSD := NNeeded;
        结果 := GetFileSecurityW(PWideChar(AFileName), DACL_SECURITY_INFORMATION, SD, NSD, NNeeded);
        结果 := Result 和 GetSecurityDescriptorDacl(SD, Present, AACL, Defualted);
        结果：=结果和现在；
      最后
        处置（SD）；
      结尾;
    结尾;

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T11:49:52.713

> GetEffectiveRightsFromAcl 对于我测试的所有用户/文件组合 ($001200A9) 都是相同的。

这一切都取决于 ACL，例如，如果每个人都被授予完全控制权，那么任何使用都将拥有完全控制权。

代码看起来很合理，您正在使用 Win32 安全 API 之一 ( [`GetEffectiveRightsFromAcl`](http://msdn.microsoft.com/en-us/library/aa446637(VS.85).aspx)) 来完成繁重的工作。

建议：创建非常具体的 ACL 来测试您的代码（[SDDL](http://msdn.microsoft.com/en-us/library/aa379567(VS.85).aspx)使这更容易），从一个不授予授权的 ACL 开始，然后是一个仅包含不同用户的 ACL。

# visual-studio-2008 - Visual Studio 2008 Emacs 模式

> ID：488638
> 
> 赞同：3
> 
> 时间：2009-01-28T17:51:50.097
> 
> 标签：visual-studio-2008, emacs, ide

在 Visual Studio 2008 中使用 emacs 模式时，制表键不再插入制表符。它只是格式化当前行。可以将选项卡重新映射到 Edit.IncreaseIndent 但这会产生许多不良副作用。有没有其他人经历过这个？如果是这样，是否有修复/破解？

我还注意到，启用 emacs 模式后，文本编辑器的性能会随着时间的推移而迅速下降。它达到了光标更新有整秒滞后的地步。我怀疑这与 kill ring 或 Edit.EmacsSetMark 的实现方式有关，因为在默认模式下 Emacs.SetMark 不起作用。

对这些问题的任何想法或帮助都会很棒。甚至只是其他一些人分享我的痛苦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T22:40:24.273

试试 Ctrl+q TAB

我每天都使用它，在 VS2008 SP1 中没有性能下降。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-02T01:42:30.870

不确定这是否适用于 VS2008，但[为 VS2010 的 Emacs 仿真扩展](http://visualstudiogallery.msdn.microsoft.com/en-us/09dc58c4-6f47-413a-9176-742be7463f92)提供的解决方法是：

> **已知的问题**
> 
> *   在空白行上按 Tab 不会添加正确的缩进。解决方法是**将文本添加到该行，然后按 Tab。**
> *   当智能感知语句完成处于活动状态时按 Tab 将不会完成。解决方法是使用另一个完成字符或 Enter 来提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T22:18:04.367

我没有在 VS 2008 中尝试过，但是在大多数带有 emacs 键绑定的应用程序中，如果你执行 Shift-Tab，它会插入一个 Tab 而不是缩进。（通过在 Vim 中使用 Vimacs 插件学习）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-25T15:27:55.207

我正在使用 Emacs 模式，我注意到性能下降。虽然不确定它是否相关。

我希望 emacs 模式不是那么错误。自 2005 年以来有了很大改进，但有时诸如 ctrl-n 和 ctrl-p 之类的简单命令不起作用（例如，在 aspx 中）。

# php - 获取 MySQL 列的宽度？

> ID：488659
> 
> 赞同：0
> 
> 时间：2009-01-28T17:57:02.910
> 
> 标签：php, pdf, text, width

我想知道我是否可以以某种方式将 MySQL 中的列标题文本转换为实际宽度大小的像素。我正在尝试从数据库生成 PDF，我希望它自动调整列宽。因为我将它用于许多表格，所以宽度必须不同，所以我应该能够看到它：“此列的标题称为 CompanyID，因此它的宽度应为 40”。我可以实现这样的目标吗？我可以将文本字符长度转换为实际宽度吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T23:02:16.477

FPDF 恰好有一个[GetStringWidth()](http://www.fpdf.org/en/doc/getstringwidth.htm)方法可以预测字符串的宽度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T18:03:12.163

您需要有某种方法来计算将在 PDF 中使用的字体度量 - 您使用的是哪个 PDF 生成库？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T18:06:38.147

虽然我强烈建议使用字符宽度相等的字体（也许是 Courier New），然后将字符串长度乘以您确定的一个字符的宽度，但您*可以*使用一些服务器端代码来做的伎俩。从这里开始，我将使用 PHP 进行演讲。:)

假设您可以访问 GD 库，您可以使用**imagettfbbox()**函数返回字符串边界框的坐标；下面是一个例子：

```
<?php
$size = 15;
$angle = 0;
$path = 'name_of_font.ttf';
$bounding = imagettfbbox($size, $angle, $path, "This is some text.");

// $bounding is now an array of values that contain
// information regarding the invisible "box" around
// the text; the only element you're really interested
// in, though, the one that will tell you the width of
// the text, is $bounding[2]
?> 
```

因此，每当您需要推断字符串的宽度时，只需调用此函数并使用结果数组的索引 2 处的元素即可获取所需的信息。希望我有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T18:01:28.487

我不确定这是否可能。我想最好的折衷方案是为字符选择任意宽度，然后将其乘以 mysql 字段名称的字符串长度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T18:04:09.837

如果我没有误解，这完全取决于您使用的字体，并且与存储在 MySQL 中的数据没有任何关系。您当然可以想出一种近似它的方法，但这在很大程度上取决于您使用的字体的功能。例如，字体是等宽的吗？如果不是，则名为“llllll”的列将比名为“MMMMMM”的列薄得多，即使它们的字符数相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T18:24:35.553

您需要一个函数来计算字符串的宽度，给定（如 Mike Houston 所说）它将呈现的字体（面、大小等）。这与 MySQL 无关，与打印/渲染文本，因此请查看您的 PDF 库。或者，可能是您操作系统的打印/图形库。

# wcf - WCF 绑定

> ID：488666
> 
> 赞同：1
> 
> 时间：2009-01-28T18:00:33.807
> 
> 标签：wcf, wcf-binding

所以，我有一个 WCF 服务，它同时在 net.tcp 和 net.pipe 上进行侦听。我已经生成了一个 WCF 代理客户端，我希望它能够通过 tcp 或命名管道进行连接。我不想要 app.config 中的配置，而是代码中的配置。

WCF 客户端将在运行时获取端点地址，例如“net.tcp://mymachine:10001/MyService”或“net.pipe://localhost/MyService”。我认为它只是使用基于 Uri 方案的正确 NetTcpBinding 或 NetNamedPipeBinding - 但它看起来不是那样的。

我不能只设置代理以采用命名管道或 tcp 绑定，它会根据端点地址选择一个吗？

编辑：好的，所以我嗅探方案并填充绑定：

```
var uri = new Uri("net.tcp://localhost:10001/MyService");
Binding b;
if (uri.Scheme == Uri.UriSchemeNetPipe) {
    b = new NetNamedPipeBinding();
} else if (uri.Scheme == Uri.UriSchemeNetTcp) {
    b = new NetTcpBinding();
} else if (uri.Scheme == Uri.UriSchemeHttp || uri.Scheme == Uri.UriSchemeHttps) {
    b = new WSHttpBinding();
}

var proxy = new ClientProxy(b, new EndpointAddress(uri)); 
```

但我收到连接失败 - *“通信对象 System.ServiceModel.Channels.ServiceChannel 无法用于通信，因为它处于故障状态。”*

如果将 Binding 更改为 BindingElement，并使用带有 CustomBinding 的 NamedPipeTransportBindingElement、TcpTransportBindingElement 等，它可以工作……但我不确定我是否理解其中的区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T18:04:58.307

不，你不能。绑定中只能有一个传输元素，拥有多个元素是没有意义的。

您必须查看该方案，然后在此基础上选择正确的绑定。这很简单，使用 Uri 类，它将为您执行解析。

# python - 在python中计算指数移动平均线

> ID：488670
> 
> 赞同：30
> 
> 时间：2009-01-28T18:01:44.507
> 
> 标签：python, signal-processing, average, digital-filter

我有一个日期范围和每个日期的测量值。我想计算每个日期的指数移动平均值。有人知道怎么做这个吗？

我是 python 新手。标准python库中似乎没有内置平均值，这让我觉得有点奇怪。也许我没有找对地方。

那么，给定以下代码，我如何计算日历日期的 IQ 点的移动加权平均值？

```
from datetime import date
days = [date(2008,1,1), date(2008,1,2), date(2008,1,7)]
IQ = [110, 105, 90] 
```

（可能有更好的方法来构建数据，任何建议将不胜感激）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-28T19:15:34.593

编辑：似乎[`mov_average_expw()`](http://www.scipy.org/scipy/scikits/browser/trunk/timeseries/scikits/timeseries/lib/moving_funcs.py)来自[SciKits的](http://pytseries.sourceforge.net/lib/moving_funcs.html)[scikits.timeseries.lib.movi](http://scikits.appspot.com/) ​​ng_funcs子模块的功能（补充[SciPy](http://scipy.org/)的附加工具包）更适合您问题的措辞。

* * *

要使用平滑因子计算数据的[指数平滑](http://en.wikipedia.org/wiki/Exponential_smoothing)`alpha`（`(1 - alpha)`用维基百科的术语）：

```
>>> alpha = 0.5
>>> assert 0 < alpha <= 1.0
>>> av = sum(alpha**n.days * iq 
...     for n, iq in map(lambda (day, iq), today=max(days): (today-day, iq), 
...         sorted(zip(days, IQ), key=lambda p: p[0], reverse=True)))
95.0 
```

上面的不是很漂亮，所以让我们稍微重构一下：

```
from collections import namedtuple
from operator    import itemgetter

def smooth(iq_data, alpha=1, today=None):
    """Perform exponential smoothing with factor `alpha`.

    Time period is a day.
    Each time period the value of `iq` drops `alpha` times.
    The most recent data is the most valuable one.
    """
    assert 0 < alpha <= 1

    if alpha == 1: # no smoothing
        return sum(map(itemgetter(1), iq_data))

    if today is None:
        today = max(map(itemgetter(0), iq_data))

    return sum(alpha**((today - date).days) * iq for date, iq in iq_data)

IQData = namedtuple("IQData", "date iq")

if __name__ == "__main__":
    from datetime import date

    days = [date(2008,1,1), date(2008,1,2), date(2008,1,7)]
    IQ = [110, 105, 90]
    iqdata = list(map(IQData, days, IQ))
    print("\n".join(map(str, iqdata)))

    print(smooth(iqdata, alpha=0.5)) 
```

例子：

```
$ python26 smooth.py
IQData(date=datetime.date(2008, 1, 1), iq=110)
IQData(date=datetime.date(2008, 1, 2), iq=105)
IQData(date=datetime.date(2008, 1, 7), iq=90)
95.0 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-28T18:12:07.030

我做了一些谷歌搜索，发现了以下示例代码（[http://osdir.com/ml/python.matplotlib.general/2005-04/msg00044.html](http://osdir.com/ml/python.matplotlib.general/2005-04/msg00044.html)）：

```
def ema(s, n):
    """
    returns an n period exponential moving average for
    the time series s

    s is a list ordered from oldest (index 0) to most
    recent (index -1)
    n is an integer

    returns a numeric array of the exponential
    moving average
    """
    s = array(s)
    ema = []
    j = 1

    #get n sma first and calculate the next n period ema
    sma = sum(s[:n]) / n
    multiplier = 2 / float(1 + n)
    ema.append(sma)

    #EMA(current) = ( (Price(current) - EMA(prev) ) x Multiplier) + EMA(prev)
    ema.append(( (s[n] - sma) * multiplier) + sma)

    #now calculate the rest of the values
    for i in s[n+1:]:
        tmp = ( (i - ema[j]) * multiplier) + ema[j]
        j = j + 1
        ema.append(tmp)

    return ema 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-10-04T12:42:55.487

我总是用 Pandas 计算 EMA：

这是一个如何做到这一点的例子：

```
import pandas as pd
import numpy as np

def ema(values, period):
    values = np.array(values)
    return pd.ewma(values, span=period)[-1]

values = [9, 5, 10, 16, 5]
period = 5

print ema(values, period) 
```

关于 Pandas EWMA 的更多信息：

[http://pandas.pydata.org/pandas-docs/stable/generated/pandas.ewma.html](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.ewma.html)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-03-10T17:31:16.263

您还可以使用 SciPy 过滤器方法，因为 EMA 是 IIR 过滤器。*与enumerate()*方法相比，这将具有在我的系统上使用*timeit*在大型数据集上测量的速度大约 64 倍的好处。

 *```
import numpy as np
from scipy.signal import lfilter

x = np.random.normal(size=1234)
alpha = .1 # smoothing coefficient
zi = [x[0]] # seed the filter state with first value
# filter can process blocks of continuous data if <zi> is maintained
y, zi = lfilter([1.-alpha], [1., -alpha], x, zi=zi) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-28T18:10:09.187

我不知道 Python，但对于平均部分，你的意思是指数衰减的低通滤波器的形式

```
y_new = y_old + (input - y_old)*alpha 
```

其中 alpha = dt/tau，dt = 滤波器的时间步长，tau = 滤波器的时间常数？（这个的变时间步的形式如下，只要把dt/tau剪成不大于1.0）

```
y_new = y_old + (input - y_old)*dt/tau 
```

如果要过滤日期之类的内容，请确保转换为浮点数，例如自 1970 年 1 月 1 日以来的秒数。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-28T18:46:59.893

我的 python 有点生疏（如果我以某种方式弄乱了语法，任何人都可以随意编辑此代码以进行更正），但这里是......

```
def movingAverageExponential(values, alpha, epsilon = 0):

   if not 0 < alpha < 1:
      raise ValueError("out of range, alpha='%s'" % alpha)

   if not 0 <= epsilon < alpha:
      raise ValueError("out of range, epsilon='%s'" % epsilon)

   result = [None] * len(values)

   for i in range(len(result)):
       currentWeight = 1.0

       numerator     = 0
       denominator   = 0
       for value in values[i::-1]:
           numerator     += value * currentWeight
           denominator   += currentWeight

           currentWeight *= alpha
           if currentWeight < epsilon: 
              break

       result[i] = numerator / denominator

   return result 
```

此函数向后移动，从列表的末尾到开头，通过向后工作计算每个值的指数移动平均值，直到元素的权重系数小于给定的 epsilon。

在函数结束时，它会在返回列表之前反转值（以便调用者的顺序正确）。

（旁注：如果我使用的是 python 以外的语言，我会先创建一个全尺寸的空数组，然后按倒序填充它，这样我就不必在最后反转它。但我不'认为你不能在 python 中声明一个大的空数组。在 python 列表中，追加比前置要便宜得多，这就是我以相反顺序构建列表的原因。如果我错了，请纠正我。）

'alpha' 参数是每次迭代的衰减因子。例如，如果您使用 0.5 的 alpha，那么今天的移动平均值将由以下加权值组成：

```
today:        1.0
yesterday:    0.5
2 days ago:   0.25
3 days ago:   0.125
...etc... 
```

当然，如果你有大量的值，那么十天或十五天前的值对今天的加权平均值贡献不大。'epsilon' 参数让您设置一个截止点，低于该截止点​​您将不再关心旧值（因为它们对今天的价值的贡献将是微不足道的）。

你会像这样调用函数：

```
result = movingAverageExponential(values, 0.75, 0.0001) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-06-25T00:38:56.737

在 matplotlib.org 示例 ( [http://matplotlib.org/examples/pylab_examples/finance_work2.html](http://matplotlib.org/examples/pylab_examples/finance_work2.html) ) 中提供了一个使用 numpy 的指数移动平均 (EMA) 函数的好例子：

```
def moving_average(x, n, type):
    x = np.asarray(x)
    if type=='simple':
        weights = np.ones(n)
    else:
        weights = np.exp(np.linspace(-1., 0., n))

    weights /= weights.sum()

    a =  np.convolve(x, weights, mode='full')[:len(x)]
    a[:n] = a[n]
    return a 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-02-12T20:35:05.880

我发现@earino 的上述代码片段非常有用 - 但我需要一些可以持续平滑值流的东西 - 所以我将它重构为：

```
def exponential_moving_average(period=1000):
    """ Exponential moving average. Smooths the values in v over ther period. Send in values - at first it'll return a simple average, but as soon as it's gahtered 'period' values, it'll start to use the Exponential Moving Averge to smooth the values.
    period: int - how many values to smooth over (default=100). """
    multiplier = 2 / float(1 + period)
    cum_temp = yield None  # We are being primed

    # Start by just returning the simple average until we have enough data.
    for i in xrange(1, period + 1):
        cum_temp += yield cum_temp / float(i)

    # Grab the timple avergae
    ema = cum_temp / period

    # and start calculating the exponentially smoothed average
    while True:
        ema = (((yield ema) - ema) * multiplier) + ema 
```

我像这样使用它：

```
def temp_monitor(pin):
    """ Read from the temperature monitor - and smooth the value out. The sensor is noisy, so we use exponential smoothing. """
    ema = exponential_moving_average()
    next(ema)  # Prime the generator

    while True:
        yield ema.send(val_to_temp(pin.read())) 
```

（其中 pin.read() 产生我想使用的下一个值）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-08-12T03:00:42.980

这是我基于[http://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:moving_averages处理的一个简单示例](http://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:moving_averages)

请注意，与他们的电子表格不同，我不计算 SMA，也不会等待 10 个样本后生成 EMA。这意味着我的值略有不同，但如果你绘制它，它会在 10 个样本之后完全遵循。在前 10 个样本中，我计算的 EMA 被适当地平滑了。

```
def emaWeight(numSamples):
    return 2 / float(numSamples + 1)

def ema(close, prevEma, numSamples):
    return ((close-prevEma) * emaWeight(numSamples) ) + prevEma

samples = [
22.27, 22.19, 22.08, 22.17, 22.18, 22.13, 22.23, 22.43, 22.24, 22.29,
22.15, 22.39, 22.38, 22.61, 23.36, 24.05, 23.75, 23.83, 23.95, 23.63,
23.82, 23.87, 23.65, 23.19, 23.10, 23.33, 22.68, 23.10, 22.40, 22.17,
]
emaCap = 10
e=samples[0]
for s in range(len(samples)):
    numSamples = emaCap if s > emaCap else s
    e =  ema(samples[s], e, numSamples)
    print e 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-10-03T05:12:07.567

可能最短：

```
#Specify decay in terms of span
#data_series should be a DataFrame

ema=data_series.ewm(span=5, adjust=False).mean() 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-11-28T20:21:08.263

[一种快速方法（从此处](https://codereview.stackexchange.com/a/166640/94621)复制粘贴）如下：

```
def ExpMovingAverage(values, window):
    """ Numpy implementation of EMA
    """
    weights = np.exp(np.linspace(-1., 0., window))
    weights /= weights.sum()
    a =  np.convolve(values, weights, mode='full')[:len(values)]
    a[:window] = a[window]
    return a 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-07-19T06:48:27.587

我使用列表和衰减率作为输入。考虑到深度递归在 python 中不稳定，我希望这个只有两行代码的小函数可以帮助你。

```
def expma(aseries, ratio):
    return sum([ratio*aseries[-x-1]*((1-ratio)**x) for x in range(len(aseries))]) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-09-28T10:40:10.810

更简单地说，使用熊猫

```
def EMA(tw):
    for x in tw:
        data["EMA{}".format(x)] = data['close'].ewm(span=x, adjust=False).mean()
        EMA([10,50,100]) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-10-02T02:29:04.180

Papahaba 的答案*几乎*就是我想要的（谢谢！），但我需要匹配初始条件。使用 IIR 滤波器`scipy.signal.lfilter`当然是最有效的。这是我的还原：

给定一个 NumPy 向量，`x`

```
import numpy as np
from scipy import signal

period = 12
b = np.array((1,), 'd')
a = np.array((period, 1-period), 'd')
zi = signal.lfilter_zi(b, a)
y, zi = signal.lfilter(b, a, x, zi=zi*x[0:1]) 
```

获取向量中返回的 N 点 EMA（此处为 12）`y`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-07-29T00:26:33.350

我在这里参加聚会有点晚了，但是给出的解决方案都不是我想要的。使用递归和投资百科中给出的确切公式是一个不错的小挑战。不需要 numpy 或 pandas。

```
prices = [{'i': 1, 'close': 24.5}, {'i': 2, 'close': 24.6}, {'i': 3, 'close': 24.8}, {'i': 4, 'close': 24.9},
          {'i': 5, 'close': 25.6}, {'i': 6, 'close': 25.0}, {'i': 7, 'close': 24.7}]

def rec_calculate_ema(n):
    k = 2 / (n + 1)
    price = prices[n]['close']
    if n == 1:
        return price
    res = (price * k) + (rec_calculate_ema(n - 1) * (1 - k))
    return res

print(rec_calculate_ema(3)) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-02-24T11:03:55.713

```
import pandas_ta as ta

data["EMA3"] = ta.ema(data["close"], length=3) 
```

# asp.net - ASP.NET -> WCF 服务需要 Windows 身份验证

> ID：488676
> 
> 赞同：2
> 
> 时间：2009-01-28T18:03:47.093
> 
> 标签：asp.net, wcf, authentication, authorization, windows-authentication

我的任务是构建一个基本的管理应用程序。该应用程序需要一个 ASP.NET 前端，它使用 WCF 与许多后端服务通信。

一项要求是应用程序的用户使用 Windows 身份验证进行身份验证。如果应用程序逻辑包含在 ASP.NET 应用程序中，我可以做到这一点，但我不知道如何在后端 WCF 服务中执行身份验证？

*   是否可以将凭据传递给 WCF 服务并让它执行身份验证？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T19:00:34.873

这取决于...（请注意，其中大部分基于 HTTP/IIS 作为传输，如果使用 TCP 或其他绑定可能会有所不同）

WCF 本身可以设置为使用当前运行的凭据使用传输或消息安全性。

如果 WCF 服务（以及它需要使用当前凭据与之通信的任何内容）与 ASP>NET 前端在同一个框上，您可能会没事

...否则您可能会遇到“[双跳](http://blogs.msdn.com/nunos/archive/2004/03/12/88468.aspx)认证”问题。基本上，windows auth 将在网络服务器上获得一个“模拟”身份，这在本地很好，但它没有权限从网络服务器进行身份验证。为此，您需要一个“委托”身份。

我知道用于获取委派身份的选项是 Kerberos 和基本身份验证。

因此，如果当您说“Windows 身份验证”时，您实际上是指每个人（客户端和所有服务器）都在同一个 AD 域上，您可能没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T11:26:59.813

我有一个使用 Windows 身份验证的 ASP.NET 站点，它需要调用启用了匿名和 Windows 身份验证的 WCF 服务。我遇到的问题是将 Windows 凭据传递给 WCF 服务。

为此，我做了以下

1.  在站点的 Web.config 中，我确保我的 WCF 绑定使用了 Windows 身份验证：security mode="TransportCredentialOnly"

    传输 clientCredentialType="Windows"

2.  在 IIS 中，我使用 .Net 4 和经典托管管道模式创建了一个应用程序池

3.  在我的网站身份验证设置中

    匿名身份验证 - 已禁用

    ASP.NET 模拟 - 已启用

    Windows 身份验证 - 已启用

这对我有用。

# oop - 在“现实世界”中使用单一职责原则

> ID：488684
> 
> 赞同：19
> 
> 时间：2009-01-28T18:05:41.753
> 
> 标签：oop, solid-principles, single-responsibility-principle

我基本上想知道有多少人认为在现实世界的代码中使用单一职责原则是合理的，**以及**有多少人实际这样做了。在[Podcast #38](https://blog.stackoverflow.com/2009/01/podcast-38/)中，Joel 谈到这种 OOP 原则在现实世界中是多么无用；并且这进一步证明了像鲍勃叔叔这样的人可能没有编写过非平凡的系统。

我亲自编写过一些软件项目或在一些软件项目中发挥了重要作用，但在我年轻的职业生涯中直到现在才遇到这种模式。我喜欢这个原则的声音，并且真的很想开始使用它。我发现 Joel 在播客中的论点非常薄弱（如果您继续阅读[此处](https://blog.stackoverflow.com/2009/01/podcast-38/)的博客评论，其他人也会如此）。但是，这有什么真相吗？

社区是怎么想的？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-28T18:24:42.480

我有一些应用[SOLID](http://www.lostechies.com/blogs/chad_myers/archive/2008/03/07/pablo-s-topic-of-the-month-march-solid-principles.aspx)原则的经验，我的经验主要是好的。我还听了播客，听起来 Jeff 和 Joel 都没有尝试过他们谈论的任何事情，时间足够长，无法真正评估其好处。反对的主要论据通常是“您编写更多代码”。如果我看看我所做的事情，我会多写 10% 的代码（通常是接口定义），但因为一切都是高度解耦的，所以它更易于维护。我几乎从来没有遇到过我的应用程序某个部分的更改会破坏其他部分的情况。所以我必须维护的 20% 的额外代码是为自己买单的。

Jeff 也错过了代码质量这一点。他不认为代码质量对客户有很大好处。他是对的，客户不在乎。客户确实关心快速实施新功能，这就是代码质量的用武之地。我发现，保持尽可能高的代码质量的投资总是在几个月内收回成本。高品质 = 低维护。

我同意他们的观点，就像任何事情一样，你必须对这些事情务实。如果您需要交付某些东西，那么请继续快速而肮脏地完成它。不过事后清理。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-28T18:37:03.437

我正在做一个项目，该项目在一个应该可以被其他人轻松扩展的框架中做很多不同的、非常复杂的事情。

起初，班级很大，做的事情很多。为了改变这些行为，您必须扩展这些类。这些方法都是虚拟的，不会改变对象的状态，所以很容易做到这一点。

但是随着系统的发展，框架最终会变成一系列单体对象，每个对象都有很长的继承链，这一点变得越来越清楚。这也导致了意外的依赖关系——一个抽象方法采用类 X 的集合来生成在基类中定义的对象 Y，这要求每个人都必须这样做，即使它对继承树的一半没有意义。这也导致了需要数十个单元测试才能使代码覆盖率超过 80% 的大量类，而且复杂性如此之大，以至于您不确定是否正确地涵盖了所有内容。很明显，这种设计会导致框架非常僵化和不灵活。

因此，我们按照 SRP 线重新设计了所有内容。您将拥有您的接口、一个基类，并且可能还有一个或多个实现类。每一个都*组成*执行整个过程的关键功能的不同对象。如果你想改变一个部分，你没有重写一个方法，你会产生另一个对象来扩展必要的接口/基类并以不同的方式执行它的工作。SRP 甚至被分解为类方法的参数和返回值。对于那些需要灵活的系统部分，而不是传递用于生成 Y 对象的 X 类的集合，创建了一个类来封装 Y 对象的生成过程。然后系统中的组件将传递这些生产者，将它们与其他生产者组合（生产者的责任），并最终使用它们来生产 Y。这允许创建不同类型的生产者，所有这些都可以完全按照相同的，尽管他们做了截然不同的事情。此举还大大减少了每个类的代码库，并使它们更容易测试。

我想说的是，作为一个新开发者，将所有内容分解到这个级别是非常困难的。您几乎必须编写一大堆泥巴，了解它的工作原理，然后将其重新设计为几个不同的组件，每个组件负责整体的一部分。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T18:12:34.580

我没有读过或听过乔尔的评论，所以不能具体评论。

我认为你必须从目标的角度来看待单一责任原则，而不是严格的要求。与软件开发中的许多事情一样，应该为理想而奋斗，但是，除非您的代码没有金钱收益或成本，否则您必须务实地满足客户的需求。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-28T18:15:45.713

在实践中，在 OO 情况下很难获得真正的 SRP。考虑一个存在于复杂系统中的类。它可能只有一项面向业务的职责（例如打印报告），但它在内部还有许多其他违反纯 SRP 理念的职责，例如日志记录和异常处理。如果您显着更改您的日志记录机制，您可能需要更改您的打印类进行的调用。

这就是设计 AOP 的原因。使用它，您无需更改任何内容，只需更改日志记录类即可更改日志记录。

出于显而易见的原因，争取面向业务的 SRP 是件好事，但对于足够复杂的系统，您永远不会在 OOP 中获得真正的 SRP。AOP，当然，但不是 OOP。

我不知道这是否是乔尔的推理，但这就是我处理这个想法的方式。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-28T20:36:17.643

大量编程理论中的一些最大的问题是他们专注于建议代码中的好的属性，实际上是代码的好属性。它们是正确的，因为它们本质上是正确的，因此不是特别有用。

是的，代码应该写得很好，是的，事情不应该被可怕地重复，是的，更改不应该在意想不到的地方造成奇怪的中断。但是，归根结底，以简单易懂的方式表达解决方案的真正简单、真正一致的代码远比满足某些严格原则的大型复杂系统更有价值。作为一个行业，我们倾向于把好的想法走得太远，在寻求“正确”解决方案而不是最好的解决方案时造成大量不必要的复杂性。

保罗。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T18:46:36.977

我认为成为一名纪律严明的 OO 开发人员并尽可能遵守 SRP 的最大好处是易于测试和维护，所以我认为 SRP 对于任何要测试/维护的系统来说都是一个很好的目标（基本上，除了一次性系统）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-08T03:57:43.370

我认为 SOLID 原则有时不符合设计类时通常应用的自然/业务逻辑。Robert C. Martin 举了一个 Rectange 和 Square 类的例子（Square 不应该是 Rectangle 的后代）。

[http://www.hanselminutes.com/default.aspx?showID=163](http://www.hanselminutes.com/default.aspx?showID=163)

我不确定它是否与 SRP 有关，但想法是一样的。SOLID 原则可能会导致违反直觉的决定，而且很难跨越这个障碍。

对我来说，“准则”比“原则”更合适。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T18:23:54.620

总的来说，我同意 SOLID 原则，但您也必须将它们纳入上下文。如果您正在编写概念证明，那么 SOLID 原则就不那么适用了。

另一方面，如果您要开发的产品的使用寿命将跨越数年，那么您最好仔细查看 SOLID 原则并加以应用。否则，它将在生产力方面花费公司大量资金。

关于乔尔和他的评论，他有一个有效的观点。有时产品需要发货或公司倒闭。就是那样子。

作为开发人员，交付产品是您的工作，但仅仅因为截止日期很紧并不意味着您使用糟糕的架构。选择使用数据集还是业务实体是一个简单的决定，两者都有类似的实施工作，但从长远来看，两者之间的新功能开发和维护是激烈的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-28T18:38:20.097

我认为应该可以为所有类编写一个简单的一行主要职责。这个单行中的“和”这个词通常不是一个好兆头。单一职责通常归结为选择适当的抽象。

GUI 附近的类倾向于反映 GUI，并具有“成为 XXXX 的 gui”的单一职责。懦夫的解决方案..

# c++ - 在 C++ 中重构一个类

> ID：488687
> 
> 赞同：5
> 
> 时间：2009-01-28T18:06:48.617
> 
> 标签：c++, refactoring

我有一个实现许多功能的 A 类。A类非常稳定。

现在我有一个新的功能需求，其中一些功能与 A 实现的功能相匹配。我不能直接从 A 类继承我的新类，因为这会给我的新类带来很多冗余。

那么，我应该在两个类中复制公共代码吗？

或者，我应该创建一个新的基类并将公共代码移动到基类，并从中派生类 A 和新类吗？但这会导致我现有的班级发生变化。

那么，哪种方法更好呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-28T18:11:00.887

除非有很好的理由不修改 A 类，否则重构并创建一个公共基础（或者更好的是，一个两者都可以使用但不一定派生自的公共类）。

您始终可以使用私有继承来访问共享功能，而无需修改类作为外部接口 - 此更改需要重建，但仅此而已。将所有功能留在类 A 上，然后将它们转发给共享实现类。

您可能不想重构而是复制代码的一个原因是，如果新类的功能可能会更改，但旧类中不需要相同的更改。不复制代码的原因之一是只需要在一个地方进行修复或更改。如果发生会破坏原始类的更改，那么您可能想要复制代码。尽管在大多数情况下，只有当这两个类不像您想象的那样相似时才会发生这种情况，并且您会努力尝试抽象出一组通用的功能。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-28T18:14:28.180

(1) 除非您或您的雇主准备无限期地保留这两个副本，否则不要在两个类别中复制通用代码。

(2) 根据定义进行重构会更改您已经拥有的类。您建议的重构称为[“Extract SuperClass”](http://www.refactoring.com/catalog/extractSuperclass.html)，然后是派生类共有的每个方法的[“Pull Up Method” 。](http://www.refactoring.com/catalog/pullUpMethod.html)这是一个很好的方法。

编辑：我记得重构背后的真正宝石：在合理范围内，它是完全流动和可逆的。从来没有“权利”，只有“现在的权利”。如果您稍后决定对这些类使用继承不是一个好的对象模型，那么您可以再次重构以使用组合（正如 Josh 极好的建议）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T07:47:26.017

如果您希望类可替换（“IS-A”关系），类应该共享一个公共基类。

你可以考虑作曲。您的新类 B 可以是围绕类 A 类型的私有成员变量的包装类。类 B 可以在不更改类 A 的情况下用新方法或逻辑扩充类 A。如果您不能更改类 A，这很方便（例如，它是由另一个团队拥有的封闭源代码软件，或者您害怕使用 A 类破坏与现有代码的兼容性）。

有关漂亮的图表，请参阅[“用委托替换继承”](http://www.refactoring.com/catalog/replaceInheritanceWithDelegation.html)重构模式。

# eclipse - Eclipse PHP IDE 的烦恼

> ID：488691
> 
> 赞同：1
> 
> 时间：2009-01-28T18:07:45.087
> 
> 标签：eclipse, phpeclipse

这是一个很小的问题，但它让我很恼火。我正在使用 Eclipse 版本：3.3.0（内部版本号：I20070625-1500）。特别是 PHPeclipse 1.2.0.200807121925PRD。

所以这就是问题所在，当我在回声中时“”；语句（在引号内输入一些标记以输出）并按回车键，Eclipse 会自动终止我所在的行：

> ” 。

...然后在下一行的光标前加上：

> "

这不是我想要的行为。我宁愿它根本不这样做。但是对于我的生活，我无法弄清楚我可以在 Eclipse 首选项中的哪个位置更改此行为。

我意识到可能会有一些人会支持这种默认行为。我对这些论点的兴趣不如我对如何控制 IDE 的这种行为的兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T18:29:05.623

我不确定它可能是哪个确切设置，但请尝试 Window->Preferences->PHP->Editor 和 ->Code Assist 或 ->Typing。您可能会在那里找到可以帮助您更改设置的内容。编辑：它*可能*是 -> Typing 下的 Automatically Close Strings 复选框。

# character-encoding - 如何在 yaml 文件中设置字符编码

> ID：488694
> 
> 赞同：21
> 
> 时间：2009-01-28T18:09:51.870
> 
> 标签：character-encoding, yaml

我们正在为新的 Rails 2.2 i18n 系统使用简单的后端，我想知道在 yaml 文件中设置编码的正确语法。

换句话说，这个 xml 的 yaml 是什么：

```
<?xml encoding="UTF-8" ?> 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-15T18:55:16.060

您*无法*在 YAML 中定义编码。但也没有*必要*，因为编码是在文件级别完成的，并且对 YAML 及其解析是透明的。编写 YAML 文档时，您只需要记住这一点。

在文件级别，YAML 1.1 支持 UTF-8 和 UTF-16，但不支持 UTF-32。1.1 规范的[全部细节](http://yaml.org/spec/current.html#id2513364)是

> 所有字符 [...] 都是 Unicode 代码点。每个这样的代码点都写成一个或多个八位字节，具体取决于所使用的字符编码。请注意，在 UTF-16 中，#xFFFF 以上的字符使用代理对写为四个八位字节。YAML 处理器必须支持 UTF-16 和 UTF-8 字符编码。如果字符流不以字节顺序标记 (#FEFF) 开头，则字符编码应为 UTF-8。否则，它应为 UTF-8、UTF-16 LE 或 UTF-16 BE，如字节顺序标记所示。在输出时，建议只为 UTF-16 字符编码发出字节顺序标记。请注意，明确不支持 UTF-32 编码。

对于 YAML 1.2，[也支持 UTF-32](https://yaml.org/spec/1.2/spec.html#id2771184)。

# sql - SQL求和差异

> ID：488705
> 
> 赞同：1
> 
> 时间：2009-01-28T18:13:41.957
> 
> 标签：sql

我的 SQL Server 查询是：

```
SELECT
  ep.employeeID, ep.punchdate, rc.creditAmount
FROM
  EmployeePunch ep 
    INNER JOIN
      ResponderCredit rc ON rc.employeeID = ep.employeeID AND 
      rc.punchdate = rc.creditdate
ORDER BY ep.employeeID 
```

并得到一个结果集：

```
EmployeeID      Date             CreditAmount
-----------    -------          -------------- 
  5             01/01/2007              5
  5             03/01/2007              7
  5             04/22/2007              15
  6             01/01/2007              3
  6             01/12/2007              4 
```

我想按 EmployeeID 和 Credit 金额分组。问题是我需要在最大和最小日期之间更改信用额度，所以：

```
EmployeeID          CreditAmount
-----------         --------------
  5                          10
  6                          1 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T18:32:40.640

在甲骨文中：

```
SELECT  r1.employeeID, amMax - amMin
FROM    (
    SELECT employeeID, amMin
    FROM  (
        SELECT
            ROW_NUMBER() OVER (PARTITION BY ep.EmployeeID ORDER BY rc.creditdate) AS rnMin,
            ep.employeeID, rc.creditAmount AS amMin
        FROM
            EmployeePunch ep, ResponderCredit rc
        WHERE
            rc.employeeID = ep.employeeID
            AND rc.punchdate = rc.creditdate
        )
    WHERE rn_min = 1
    ) r1,
    (
    SELECT employeeID, amMin
    FROM  (
        SELECT
            ROW_NUMBER() OVER (PARTITION BY ep.EmployeeID ORDER BY rc.creditdate DESC) AS rnMax,
            ep.employeeID, rc.creditAmount AS amMax
        FROM
            EmployeePunch ep, ResponderCredit rc
        WHERE
            rc.employeeID = ep.employeeID
            AND rc.punchdate = rc.creditdate
        )
    WHERE rn_max = 1
    ) r2
WHERE   r1.employeeID = r2.employeeID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T18:19:39.743

对于 MS SQL，应该这样做

```
SELECT
  ep.employeeID, rc.creditAmount, 
  datediff(month, max(ep.punchdate), min(ep.punchdate))
FROM
  EmployeePunch ep 
INNER JOIN
  ResponderCredit rc ON rc.employeeID = ep.employeeID AND 
    rc.punchdate = rc.creditdate 
group by
  EmployeeID, Credit
ORDER BY
  ep.employeeID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T18:35:52.333

这是 MSSQL 的解决方案。

如果信用在一段时间内下降，它将显示负值。

它有一些内部连接，可能可以优化，但可能不会太多

```
选择 maxCredit.employeeID、maxCredit.creditAmount - minCredit.creditAmount
从
(
选择
    ep.employeeID, rc.creditAmount
从
    EmployeePunch ep
内部联接
    ResponderCredit rc
ON rc.employeeID = ep.employeeID 和 rc.punchdate = rc.creditdate
内部联接
    (
    选择 ep2.employeeID，MAX(ep2.punchdate) 作为 maxCreditdate
    FROM EmployeePunch ep2 GROUP BY ep2.employeeID
    ) 内最大
ON innermax.employeeID = ep.employeeID 和 ep.punchdate = innermax.maxcreditDate
) 最大信用
内部联接
(
选择
    ep.employeeID, rc.creditAmount
从
    EmployeePunch ep
内部联接
    ResponderCredit rc
ON rc.employeeID = ep.employeeID 和 rc.punchdate = rc.creditdate
内部联接
    (
    选择 ep3.employeeID, MIN(ep3.punchdate) AS minCreditdate
    FROM EmployeePunch ep3 GROUP BY ep3.employeeID
    ) 内敏
ON innermin.employeeID = ep.employeeID 和 ep.punchdate = innermin.mincreditDate
) minCredit
ON maxCredit.employeeID = minCredit.employeeID

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T18:45:10.193

这就是你要找的我相信......

```
SELECT
  ep.employeeID, Max(datediff(day, ep.punchdate, rc.creditDate)) As [# of Days], rc.creditAmount
FROM
  EmployeePunch ep 
INNER JOIN
  ResponderCredit rc 
ON 
    rc.employeeID = ep.employeeID AND rc.punchdate = rc.creditdate
group by ep.employeeID, rc.creditAmount
ORDER BY ep.employeeID 
```

将产生结果：

```
EmployeeID    # of Days    CreditAmount    
5                 0             5    
5                 2             7    
5                 111           15    
6                 0             3    
6                 334           4 
```

# windows - 检测一个程序是否已经安装了 NSIS

> ID：488717
> 
> 赞同：12
> 
> 时间：2009-01-28T18:18:03.803
> 
> 标签：windows, nsis, autorun

我正在使用 NSIS 为程序创建安装程序，检测该程序是否已安装的最佳方法是什么？另外，由于我正在从 autorun.inf 运行安装程序，如果它找到已安装的副本，我可以立即退出安装程序吗？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-28T22:08:34.667

这个怎么样。我在一个旧的 NSIS 脚本中有这个。

```
; Check to see if already installed
  ReadRegStr $R0 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\<YOUR-APP-NAME>" "UninstallString"
  IfFileExists $R0 +1 NotInstalled
  messagebox::show MB_DEFBUTTON4|MB_TOPMOST "<YOUR-APP-NAME>" \
    "0,103" \
    "<YOUR-APP-NAME> is already installed." \
    "Launch Uninstall" "Cancel"
    Pop $R1
  StrCmp $R1 2 Quit +1
  Exec $R0
Quit:
  Quit

NotInstalled: 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-01T21:55:34.357

我一直在使用稍微复杂的测试，它还检查已安装软件的版本：

```
!define PRODUCT_VERSION "1.2.0"

!include "WordFunc.nsh"
  !insertmacro VersionCompare

Var UNINSTALL_OLD_VERSION

...

Section "Core System" CoreSystem
  StrCmp $UNINSTALL_OLD_VERSION "" core.files
  ExecWait '$UNINSTALL_OLD_VERSION'

core.files:

  ...
  WriteRegStr HKLM "Software\${PRODUCT_REG_KEY}" "" $INSTDIR
  WriteRegStr HKLM "Software\${PRODUCT_REG_KEY}" "Version" "${PRODUCT_VERSION}"
  ...
SectionEnd

...

Function .onInit
  ;Check earlier installation
  ClearErrors
  ReadRegStr $0 HKLM "Software\${PRODUCT_REG_KEY}" "Version"
  IfErrors init.uninst ; older versions might not have "Version" string set
  ${VersionCompare} $0 ${PRODUCT_VERSION} $1
  IntCmp $1 2 init.uninst
    MessageBox MB_YESNO|MB_ICONQUESTION "${PRODUCT_NAME} version $0 seems to be already installed on your system.$\nWould you like to proceed with the installation of version ${PRODUCT_VERSION}?" \
        IDYES init.uninst
    Quit

init.uninst:
  ClearErrors
  ReadRegStr $0 HKLM "Software\${PRODUCT_REG_KEY}" ""
  IfErrors init.done
  StrCpy $UNINSTALL_OLD_VERSION '"$0\uninstall.exe" /S _?=$0'

init.done:
FunctionEnd 
```

你当然要填写细节，这只给你一个粗略的骨架。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-02T04:41:19.153

创建卸载程序后，在注册表中创建产品名称条目

```
!define PRODUCT_UNINST_ROOT_KEY "HKLM"
!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${COMPANY_NAME} ${PRODUCT_NAME}"
Section -Post
  SetShellVarContext current
  WriteUninstaller "${UNINST_PATH}\uninst.exe"
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)" 
```

要查看产品是否已安装，请执行

```
Function IsProductInstalled
  ClearErrors
  ReadRegStr $2 ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName"  
  StrCmp $2 "" exit 
```

在您的卸载中，您应该这样做

```
Section Uninstall
    DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T18:46:16.413

这通常通过让 NSIS 在安装时为您的产品插入注册表项来完成。然后，这是一种检测该注册表项是否存在的简单方法，如果存在，则保释

# .net - ASP.NET MVC：AJAX ActionLink - 以 HTML 属性为目标

> ID：488726
> 
> 赞同：5
> 
> 时间：2009-01-28T18:21:01.270
> 
> 标签：.net, asp.net-mvc, asp.net-ajax

我有一个 Ajax actionlink，它在控制器方法中请求一个字符串。我想将该字符串插入到超链接的属性中。如何指定目标 id 元素的属性字段？

```
<img id="CHANGE-MY-SRC" src=ViewData["src"] >

<%=Ajax.ActionLink("Change IMG Source","actionChange",new AjaxOptions()         
UpdateTargetId="CHANGE-MY-SRC"})%> 
```

* * *

```
public string actionChange()
{
   ViewData["src"]= "somethingNew";

   return ????????
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T23:01:31.547

Ajax 助手的默认行为不支持这一点。但是，您可以创建一个在 Ajax 请求返回时运行的自定义 JavaScript 处理程序，然后使用它将值注入到属性中

创建一个通用 JavaScript 文件（例如，将其加载到母版页中）并添加此函数：

```
// Creates an Ajax OnComplete handler that will inject 
///the contents into the specified attribute, rather than the InnerHtml
function createAttributeInjector(attributeName) {
    return function(ajaxContext) {
        if(ajaxContext.get_updateTarget() !== null) {
            ajaxContext.get_updateTarget()[attributeName] = ajaxContext.get_data();
        }
        // IMPORTANT: Suppress the default behavior!
        return false;
    }
} 
```

然后，在构建 Ajax 链接时：

```
Ajax.ActionLink("Change IMG Source", "actionChange", new AjaxOptions() {
    UpdateTargetId="CHANGE-MY-SRC", 
    OnCompleted="createAttributeInjector('src')"
} 
```

免责声明：我无法对此进行测试，但我已经对 Ajax 助手做过类似的事情。如果您有问题，请在评论中发布我的答案，我很乐意提供帮助！如果它有效，请在评论中告诉我！

如果您有源代码（[可以在 CodePlex 上获得](http://www.codeplex.com/aspnet/SourceControl/changeset/view/21528#266382)），您可以查看 MicrosoftMvcAjaxScript 项目中的 AjaxContext.cs 文件，以获取可以从 OnCompleted 处理程序访问的属性的完整列表

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T18:31:48.253

我不确定您的确切意思，但您可以提供一组 HTML 属性，某些版本的 ActionLink 扩展。

```
Ajax.ActionLink( string linkText,
                 string action,
                 object routeValues,
                 AjaxOptions ajaxOptions,
                 object htmlAttributes ) 
```

例子：

```
<%= Ajax.ActionLink( "add",
                     "AddThing",
                     new { id = ViewData.Model.ID },
                     new AjaxOptions { Confirm = "Are you sure?",
                                       UpdateTargetId = "thingList"
                                     },
                     new { title = "Add a thing to the database." } ); %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-12T17:31:24.930

我猜要简单得多，您可以使用 Url.Action （您设置的操作返回您想要的字符串，但不是返回您使用 Response.Write(...)。

或者更简单，您在标签中使用 src="<%= ViewData["src"] %>" ！

我看到您已经有了解决方案，但这可以节省您下次的时间..

# java - Java 中的继承——创建子类的对象也会调用超类的构造函数。为什么？

> ID：488727
> 
> 赞同：25
> 
> 时间：2009-01-28T18:22:45.230
> 
> 标签：java, inheritance, constructor, subclass

我有一个关于 Java 继承的问题。

我有两个类`A`and`B`和类 B**继承**自 A：

```
public class A {
     public A() {
         System.out.println("Hi!");
     }
}

public class B extends A {
     public B() {
         System.out.println("Bye!");
     }

     public static void main(String[] args) {
         B b = new B();
     }
} 
```

当我运行程序 B 时，输出是：

```
Hi!
Bye! 
```

> **问题**：为什么在我创建和对象时调用构造**函数**？`class A``class B`

我知道 B 继承了 A 的所有内容——所有实例或类变量以及所有方法，从这个意义上说，B 的对象具有 A 的所有特征以及 B 中定义的一些其他特征。但是，我不知道也没有想象一下，当我创建 B 类型的对象时，也会调用 A 的构造函数。所以，写这个：

```
B b = new B(); 
```

创建**两个对象 - 一个是 B 类型，一个是 A 类型**。

这越来越有趣了，

有人可以解释为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-28T18:28:16.483

它不会创建两个对象，只有一个：*B*。

从另一个类继承时，**必须**在构造函数中调用 super()。如果您不这样做，编译器将为您插入该调用，您可以清楚地看到。

调用超类构造函数是因为否则对象将处于未初始化状态，子类的开发人员可能不知道。

在编译器插入 super 调用后，您的子类实际上如下所示：

```
public class B extends A {
    public B() {
        super();
        System.out.println("Bye!");
    }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-28T18:28:10.820

它没有创建2个对象，它只创建了B的一个实例。调用超类构造函数的原因是，就像你说的，B拥有A的所有字段，这些字段需要初始化。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-28T18:27:38.417

请记住，继承是基类和子类之间的“是”关系，因此每次您拥有一个子类的实例时，根据定义，您也将拥有一个基类的实例（作为实例的一部分，而不是作为两个单独的实例）。为了正确初始化基类，调用构造函数。

此外，想想如果你的子类依赖于基类的某些内部状态会发生什么。你不希望基类的实例被初始化吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T18:30:00.240

这样做是因为构造函数用于初始化对象。由于 B 也是 A，它首先调用 A 的构造函数，然后调用 B 的构造函数。

作为旁注，您可以`super(arg1, etc)`根据传递的参数类型来选择调用 A 的哪个构造函数......但它必须是构造函数中的第一行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T18:28:36.090

构造函数包含 A 的所有初始化。您没有创建两个对象。您正在创建一个对象，然后运行超类的初始化程序来初始化其成员，然后运行派生类的初始化程序来初始化其成员。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-28T18:29:36.480

它不创建两个对象，它只创建一个对象 b. b 属于 B 类型和 A 类型。构造函数基本上是说这里是构造我所需要做的。因此，当您创建一个新的“B”实例时，您正在构建一个既是 B() 又是 A() 的对象。想象以下场景：

```
class Q {
  int i;
  public Q() {
    // set default value
    i= 99;
  }
}

class Z extends Q {
  public Z() {
  }
} 
```

如果 Q 的构造函数没有被调用，我将如何获得它的默认值？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T18:30:49.207

B的创建不会创建额外的A。

但是通过创造 B，你创造了一种 A，因为 B**是**A。

Java/C++ 为您隐式调用 A 的构造函数。为什么？语言设计。但是这样做很好，因为 A 的构造函数可能包含一些初始化。由于 B 使用了 A 的所有功能和错误，因此这些功能最好正确初始化。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-28T18:31:02.123

类的构造函数是大多数 OOP 中非常重要的概念

类通过提供状态和操作该状态的方法，可以更轻松地维护不变量。构造函数的作用是使类进入符合那些不变量的状态（或抛出从而禁止使用 invliad 对象）。这在许多语言中比预期的要宽松一些，因为允许构造函数在其他地方传递自己的“this”引用，但这至少在类的控制之下（因此它可以知道它处于足够稳定和有效的状态以便世界其他地方可以访问）

继承使这变得复杂，因为 B 在非常真实的意义上是 A，因此可以调用 A 提供的任何方法。因此，作为 A 的 B 的部分应该有机会在 B 进入之前初始化自己，因此A 的构造函数在 B 构造函数的实际工作开始之前被调用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-28T18:28:31.927

如果 A 在其构造函数中初始化成员并且您忘记在派生类中调用 super ，则 A 的成员可能处于错误状态。Java 正试图阻止你在自己的脚下开枪。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-28T18:29:46.027

只创建一个对象，两个承包商都在同一个对象上运行。

原因很简单，因为您知道 B 具有 A 的所有变量和方法，因此如果 A 的某些变量需要初始化，以便 A 的方法可以工作，则必须有人对其进行初始化 - 并且有人是 A 的构造函数。

例如：

```
public class A {
     public A() {
        x = 1;
     }
     private int x;
     public int getX() {
        return x;
     }
}

public class B extends A {
     public B() {
     }

     public static void main(String[] args) {
         B b = new B();
         System.out.println(b.getX()); // should print 1 
     }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-10-05T12:15:29.393

当新对象是 create(B) 时，内部 BA 对象被创建（因为 extends 关键字）。在 B 类 JVM 中搜索 B 类构造函数，但由于扩展关键字，它转到超类构造函数。在一个类 x 值被初始化。但是 x 是私有的，因此我们可以访问外部类的 throw `getXxx()`方法并获取结果。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-11-04T05:27:54.020

当创建子类对象时，在内部它不是为超类对象创建的。但是应该为超类成员分配内存。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-06-27T11:45:56.913

在java中，当你创建子类的对象时，总是调用父类的构造函数，因为Object类是每个超类的父类，当你调用Object类的构造函数时，只会创建你的对象，java不支持多重继承在类的情况下，如果你扩展任何其他类，那么你的子类和 Object 类之间的关系是通过 Parent 类，所以要调用 Object 类的构造函数，必须调用 Parent 类的构造函数。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-08-05T08:56:05.663

每个超类都有一个构造函数，并且层次结构中的每个构造函数都在创建子类的对象时运行。

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2015-06-28T12:13:16.093

如果未创建超类对象，那么子类如何访问超类非静态方法和变量。

我研究了非静态方法和变量只能通过对象访问..

# c++ - 使用 std::map 时这些做法是否适当？

> ID：488729
> 
> 赞同：9
> 
> 时间：2009-01-28T18:23:24.683
> 
> 标签：c++, enums, map, standard-library

我对使用有一些疑问`std::map`：

1.  使用 a作为良好实践`enum`的关键吗？`std::map`考虑以下代码：

    ```
    enum Shape{
        Circle,
        Rectangle
    };

    int main(int argc, char* argv[])
    {
         std::map<Shape,std::string> strMap;
         // strMap.insert(Shape::Circle,"Circle"); // This will not compile
         strMap[Shape::Circle] = "Circle";         // But this will work
         return 0;
    } 
    ```

2.  在上面的示例中，为什么`insert()`在重载运算符正常工作时调用生成编译器错误`[]`？推荐使用以下哪种方法将项目插入到 中`std::map`？

3.  我知道在类`find()`上使用该方法时`std::map`，它不是在容器中进行顺序搜索，而是进行一些对数搜索，这将比顺序搜索快得多。这种理解正确吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-28T18:30:16.900

1.  将枚举作为 key_type 本身并不坏。（**编辑**）但是，如果您只使用顺序枚举值，`std::vector`则具有 O(1) 访问权限的 a 会更好。
2.  `insert`必须像这样使用：`mapVar.insert(make_pair(key, value));` 另见[cppreference.com](http://www.cppreference.com/wiki/stl/map/insert)。
3.  是的，`std::map`按照标准的保证，有 O(log(n)) 查找，如果 n 足够高，这比 O(n) 快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T18:34:51.960

插入失败，因为 value_type 是 std::pair

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T18:34:07.483

1）在 std::map 中保持枚举作为键是一种好习惯吗？

好吧，为了提高效率，使用这么小的枚举，最好使用向量或 tr1::array 值（如果您的值类型支持“空”值）或智能指针。前任： `vector<string>`

为了正确-我相信你很好。Map 可以使用任何可排序的键类型——即具有 operator< 或您为其提供排序功能的键类型。枚举默认有排序

2）`strMap.insert(Shape::Circle,"Circle")`为什么插入方法[给出]编译器错误？

因为 insert 不接受两个值。它需要一对。尝试：

```
#include <utility>
...
strMap.insert(make_pair(Circle, string("Circle"))); 
```

3）当在地图类中使用 find() 方法时，[它]正在做一些对数搜索......对吗？

是的。map::find 是 O(lg(map::size())) 时间。map 将其键值对存储在按键排序的数据结构中。插入和擦除是 O(lg(n))，就像 find 一样。它还提供双向迭代器，这意味着您可以在 O(1) 恒定时间内找到映射中的下一项或上一项，但一次不能向前和向后跳过多个元素。

**编辑：**更正了枚举默认排序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T18:34:24.287

尝试使用

```
strMap.insert(std::pair<Shape, std::string>(Circle,"Circle")); 
```

而是（不是 Shape::Circle！）。

枚举值在与 C++ 中的枚举相同的范围内可见（非常丑陋，我绝对不喜欢它，但就是这样！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T18:47:48.307

对于这种情况，您通常只需要枚举到字符串的静态映射，执行以下操作通常更容易：

```
enum Shape{
    Circle,
    Rectangle,
    NShapes,
};

char *ShapeNames[] = 
{  
    "Circle",
    "Rectangle",    
};

void CheckShapeNames()
{
    // Use a static_assert here instead if you have it in your library
    int ShapeNamesCount[(sizeof(ShapeNames)/sizeof(char*)) == NShapes];
} 
```

从那时起，访问形状名称只需访问 ShapeNames 数组即可：

```
string name = ShapeNames[Shape::Circle]; 
```

甚至：

```
for (int i=0; i < Shape::NShapes; ++i)
{
    cout << ShapeNames[i];
} 
```

# windows - 使用 NSIS 检测目标卷是否为 NTFS

> ID：488731
> 
> 赞同：0
> 
> 时间：2009-01-28T18:24:03.590
> 
> 标签：windows, installation, nsis, ntfs

我正在使用 NSIS 为需要在 NTFS 卷上运行的程序创建安装程序。如何检测安装到路径是否在 NTFS 卷上并采取相应措施（显示帮助/警告消息）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T17:23:10.743

使用外部工具并不总是一个好主意（并非每个命令行工具都存在于 Windows 的家庭版本中）最好直接使用系统插件调用正确的 API。

```
!include LogicLib.nsh

StrCpy $0 "c:\"
System::Call 'Kernel32::GetVolumeInformation(t "$0",t,i ${NSIS_MAX_STRLEN},*i,*i,*i,t.r1,i ${NSIS_MAX_STRLEN})i.r0'
${If} $0 <> 0
    MessageBox mb_ok "fs=$1"
${EndIf} 
```

但在这种情况下，您不应该检查文件系统类型，而应该寻找您需要的实际功能（压缩、加密、连接、稀疏文件等）

```
!define FILE_SUPPORTS_ENCRYPTION 0x00020000
!define FILE_READ_ONLY_VOLUME 0x00080000
!define FILE_VOLUME_QUOTAS 0x00000020

!macro MakeBitFlagYesNo flags bit outvar
IntOp ${outvar} ${flags} & ${bit}
${IfThen} ${outvar} <> 0 ${|} StrCpy ${outvar} "Yes" ${|}
${IfThen} ${outvar} == 0 ${|} StrCpy ${outvar} "No" ${|}
!macroend

StrCpy $0 "c:\"
System::Call 'Kernel32::GetVolumeInformation(t "$0",t,i ${NSIS_MAX_STRLEN},*i,*i,*i.r1,t,i ${NSIS_MAX_STRLEN})i.r0'
${If} $0 <> 0
    !insertmacro MakeBitFlagYesNo $1 ${FILE_SUPPORTS_ENCRYPTION} $2
    !insertmacro MakeBitFlagYesNo $1 ${FILE_READ_ONLY_VOLUME} $3
    !insertmacro MakeBitFlagYesNo $1 ${FILE_VOLUME_QUOTAS} $4
    MessageBox mb_ok "flags=$1 $\nFILE_SUPPORTS_ENCRYPTION=$2$\nFILE_READ_ONLY_VOLUME=$3$\nFILE_VOLUME_QUOTAS=$4"
${EndIf} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T19:19:14.070

我对 NSIS 不熟悉，但您可能会发现这个“DOS”小技巧很有帮助。

我确实注意到可以使用 NSIS 打开文件，所以这可能会有所帮助——

```
chkntfs c: | find "file system" > yourfile.abc 
```

CHKNTFS 是用于管理 CHKDSK 操作的实用程序，但如果您在没有命令行开关的情况下运行该命令，它只会报告结果。

“C:”是你感兴趣的驱动器——

您可以从命令提示符运行它来查看结果，当然，没有**"> yourfile.abc"** 部分，这就是将输出定向到该文件的原因。

在任何人对此投反对票之前，我只是把它作为一个发人深省的建议提供，也许会引发真正的解决方案并记住这样的座右铭——善良......哈哈......

编辑：这个片段可能会有所帮助——我没有办法真正测试这个——这是编译时使用——你很可能想要运行时间......但是，它可能会给你一个想法......

我“假设”没有一个已经命名为 NTFS 的定义——如果是这样，请相应地更改它。第一次调用创建包含文件，第二次调用它（双 > ）... FIND 的 /C 选项只是计算包含搜索项的数字行。因此，0 或 1 结果。

```
!system 'echo "!define NTFS=" > newinclude.nsh'
!system 'chkntfs c: | find /c "NTFS" >> newinclude.nsh'
!include newinclude.nsh
!ifdef NTFS
  !echo "NTFS is defined and value should reflect accordingly; 0=NO, 1=Yes it is NTFS"
!endif 
```

**编辑：（再次，大声笑）**

这是一个片段，它将设置一个 ENVIRONMENT 变量，据我所知，它在运行时应该很容易阅读——您可以构造一个要执行的变量，相应地替换驱动器号。

```
ExecWait 'chkntfs c: | find /c "NTFS"  > tempfile.abc'
ExecWait 'set /p NTFS= < tempfile.abc'
Exec     'del tempfile.abc' 
```

现在，如果不是 NTFS，则名为 NTFS 的环境变量应该保存为 0，如果正在检查的卷是 NTFS，则保存为 1。

或者直接

```
ExecWait 'chkntfs c: | find /c "NTFS"' $0 
```

$0 保存返回码；结果有点倒退，因为这是错误返回码。如果 0 你有 NTFS 并且 > 0 意味着没有 NTFS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T20:50:10.767

您的测试需要在运行时进行，因此[Borzio 的](https://stackoverflow.com/questions/488731/detecting-if-the-target-volume-is-ntfs-using-nsis#488954)答案本身不会起作用。

看起来 ExecWait 命令也不允许重定向，因此以这种方式执行它然后检查文件的内容是行不通的。

在我看来，您最好的选择是选择以下之一：

*   制作一个运行 chkntfs 的批处理文件，然后根据结果设置错误级别
*   编写 C/C++/VB/等。将运行 chkntfs 然后根据结果设置错误级别的应用程序
*   编写 C/C++/VB/等。将使用 Win32 API 来确定文件系统的应用程序
*   为 NSIS 编写一个插件，该插件将使用 Win32 API 来确定文件系统

**编辑：** Borzio 在我完成之前更新了他的 :)

您可能需要添加我在 Winamp 论坛上找到的内容：[ExecWait with file redirection](http://forums.winamp.com/showthread.php?postid=834044)

```
 ExpandEnvStrings $1 %COMSPEC%
  ExecWait '"$1" /C chkntfs c: | find /c "NTFS"' $0 
```

没有`ExpandEnvStrings $1 %COMSPEC%`，它无法在我的系统上生成重定向文件。

我已经测试了上述内容，它确实有效，NTFS 为 0，非 NTFS 为 1。

这种方法唯一可能的缺点是在代码执行期间会短暂弹出一个命令窗口。

# asp.net-mvc - Web MVC 框架是否更易于与动态语言一起使用？

> ID：488732
> 
> 赞同：1
> 
> 时间：2009-01-28T18:24:05.150
> 
> 标签：asp.net-mvc, dynamic-languages

我之所以问这个问题是因为我观察到像 RoR 和 Django 这样的框架是两个领先的 MVC 框架，它们确实激起了社区。我知道早在 RoR 或 Django 出现之前，Java 世界中就有 MVC 框架，但并没有那么令人兴奋。

如果您想使用 MVC 模式构建应用程序，像 Ruby / Python 这样的语言是更好的选择吗？如果您是 .net 开发人员并且非常精通 Python/Ruby，您是否看到使用 IronPython/IronRuby 构建 ASP.net MVC 应用程序的任何优势？

我真的很期待 Visual Studio 能够像支持 C# 一样支持动态语言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T18:32:35.647

老实说，这并不是将 Java 与 RoR 和 Python 进行比较的最佳示例。因为 Java 的 MVC 实现是在其 Windows 端开发而不是 Web 端。而且 JSP 从来都不是 Web 开发人员的最爱，所以它从一开始就有点落后。

但是要回答你的问题。没有理由不使用 C# 或 VB.NET 等静态语言来开发 ASP.NET MVC。确实没有大量的静态语言可以为 Web 提供非常好的 MVC 实现，所以这可能就是为什么您会看到大部分的开发都是在 RoR、Python 和 PHP 中进行的。

但是，如果您想了解更改和推出使用 C# 开发的 MVC 应用程序的速度有多快，您实际上不必再看您当前所在的站点。Jeff Atwood 和团队做得很好，他们不断更新架构，没有任何问题。

因此，我建议您将 C# 与 ASP.NET MVC 一起使用，暂时忘记 IronPython，因为该语言尚未解决所有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T19:54:25.280

我觉得已经没有那么大的优势了。

我认为所有优秀的 MVC 框架都利用了它们所编写的语言/平台的“A”级特性。

.NET 现在具有许多特性，使其本质上是“灵活/动态”的，但仍可进行类型检查。我认为 .NET 4.0 只是添加了*动态*关键字。

网上有一两个安德斯的视频谈论这个。他在 PDC 讨论 C#4 和 C#5 的发展方向。我认为在 MSDN 网站上进行了一次圆桌讨论。

# delphi - 将 DUnit CheckEquals 中的问题与货币字段值进行比较

> ID：488746
> 
> 赞同：7
> 
> 时间：2009-01-28T18:27:52.990
> 
> 标签：delphi, dunit

我正在比较 DUnit 中的一些货币值，但它在我的机器上根本不起作用（在其他机器上工作，但在我的机器上不起作用）。

一个例子：

```
CheckEquals(16.65, SomeCurrencyFieldValue); 
```

提高：

```
expected: <16,65> but was: <16,65> 
```

如果执行以下操作，则比较有效：

```
var
  Temp: Currency;
begin
  Temp := 16.65;
  CheckEquals(Temp, SomeCurrencyFieldValue); 
```

**问题是：为什么当我将值直接传递给 CheckEquals 方法时比较不起作用？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T19:12:58.123

这个问题与`Currency`值如何在运行时转换为`Extended`值与浮点文字如何`Extended`在编译时转换为值有关。如果两种情况下的转换不同，则传递给的值`CheckEquals`可能不相等。

值得在调试器的 CPU 窗口中检查任何一个值是否在准备函数调用的过程中通过中间`Double`值。`Extended`额外的转换会影响结果的确切值。

要考虑的另一件事是 16.65 不能完全表示为一个`Extended`值，但它*可以*完全表示为一个`Currency`值。虽然`Currency`被归类为浮点类型，但它实际上是定点缩放的 64 位整数。`CheckEquals`这可能是在考虑到这一点的情况下在 DUnit 中请求额外过载的理由。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T18:33:06.957

我看到 Delphi 2007 dUnit 源中只有 CheckEquals() 用于扩展值。但是你可以使用这个：

```
procedure CheckEquals(expected, actual: extended; delta: extended;
  msg: string = ''); overload; virtual; 
```

并为货币价值提供适当的增量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-10T15:17:36.460

我遇到了同样的问题。看起来有些 DLL 修改了 FPU（处理器）控制字。这解释了为什么错误并不总是发生。当添加一些使用除以前测试套件之外的其他单元的新测试时，它可能会突然出现。或者，如果软件更新安装了错误的 DLL。我在我的博客上写过：

*   [为什么 1.99 突然不再等于 1.99](http://mikejustin.wordpress.com/2009/05/04/why-is-199-199/)

我还发现 Delphi 包含一个 SafeLoadLibrary 函数，它可以恢复控制字。

这也解释了为什么原始问题提到该问题与机器有关。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-07-16T15:51:38.343

这是一个建议的解决方案：

```
procedure CheckEquals(expected, actual: double; Precision:integer; msg:string ='');overload;virtual; 
```

...

```
procedure TAbstractTest.CheckEquals(expected, actual: double;
  Precision: integer; msg: string);
var
  I: Integer;
begin
  FCheckCalled := true;
  for I := 0 to Precision do begin
    Expected := Expected * 10;
    Actual := Actual * 10;
  end;
  if Round(Expected) <> Round(Actual) then
    FailNotEquals( IntToStr(Round(Expected)), IntToStr(Round(Actual)), msg, CallerAddr);
end; 
```

我知道它的糟糕实现，但只是一个想法，我更喜欢“delta”，而且更容易使用。

在当前版本的 dunit 中，您可以使用

```
procedure CheckEquals(expected, actual: extended; delta: extended; msg: string = ''); overload; virtual;
CheckEquals(0.011,0.01,0.009,'will pass'); 
```

# asp.net - 扩展 ASP.NET 会话状态服务器

> ID：488748
> 
> 赞同：5
> 
> 时间：2009-01-28T18:28:12.083
> 
> 标签：asp.net, session-state, load-balancing

设想：

该网站托管在三台服务器上，每台服务器都使用[IIS](http://en.wikipedia.org/wiki/Internet_Information_Services)。

所有三台服务器都使用 Windows Server 2003 附带的网络负载平衡软件进行集群。

所有三个站点都配置为将会话状态存储在已指定为“状态服务器”的单独服务器上。

我被要求扩大“状态服务器”。有没有一种方法可以让我拥有多个状态服务器并在它们之间同步状态，因此如果其中一个状态服务器出现故障，其他状态服务器将能够提供状态信息？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T18:30:48.990

我们在我工作的地方使用[Scale Out State Server](http://www.scaleoutsoftware.com/products/stateServer/index.html)，它的工作非常出色，而且设置起来非常简单。我了解 Microsoft 也在开发名为[Velocity](http://blogs.msdn.com/velocity/)的类似产品，但我对此没有任何经验。

SOSS 唯一的缺点是您必须为此付费——但我除了与他们的销售和支持团队互动之外，什么都没有。如果你最终获得了许可，请帮我一个忙，让他们知道来自 Gratis 的 Daniel 派你来的；）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-28T18:37:58.990

我会去memcached。您可以在每个 Web 服务器上设置它，然后您可以使用您添加的每个新 Web 服务器对其进行扩展。我之前在 codeplex 上找到了几个客户。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T18:32:52.777

您正在寻找一种分布式缓存技术。Microsoft Velocity 是一个由 Microsoft 发布的示例，用于将默认 ASP.NET 会话状态替换为可以分发的 Velocity。还有其他缓存提供程序，例如 Memcache。

**编辑：**更新此答案以获取与当前时间更相关的信息，这种类型的功能内置于 Windows Azure 和 AppFabric 产品中。可以在此处查看有关此的一些简要信息：[Windows Server 和 Azure AppFabric 虚拟发布 5 月 20 日](http://www.hanselman.com/blog/WindowsServerAndAzureAppFabricVirtualLaunchMay20th.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-12T10:05:12.253

SQL 服务器上的会话数据库可以通过很少的代码和配置更改轻松扩展。您可以将 asp.net 会话粘贴到会话数据库中，并且无论场中的哪个 Web 服务器为请求提供服务，您的基于会话 ID 的 sql 状态服务器映射都可以完美运行。这可能是使用 SQL Server 扩展 ASP.NET 会话状态的最佳方法之一。有关更多信息，请阅读链接

[会话状态的真正横向扩展模型](http://www.bulletproofideas.net/2011/01/true-scale-out-model-for-aspnet-session.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-17T18:39:18.647

您可以做的最好的事情是完全避免使用状态服务器。

真正扩展会话状态的唯一方法是完全避免依赖于会话存储后端（in-proc、sql、mongo 或其他）。

如果会话数据足够小以适合（通常在大多数应用程序中）请求的标头中，则应将其保存在 cookie 中（已签名！）并随着请求本身来回移动。无单点故障，无扩展问题，无需调整内存或 CPU 要求。

JWT 是一个可以用于此的已知标准，这里的这篇文章指向一个基于 JWT 的 ASP.Net 会话状态提供程序：

[http://www.drupalonwindows.com/en/content/aspnet-session-state-scaling-and-performance-issues](http://www.drupalonwindows.com/en/content/aspnet-session-state-scaling-and-performance-issues)

# ssl - 在发布 xml 之前验证对等证书？

> ID：488754
> 
> 赞同：1
> 
> 时间：2009-01-28T18:29:15.997
> 
> 标签：ssl, certificate

我需要通过 https 将 XML 发布到服务器，但我需要在推送 XML（包含敏感信息）之前验证自签名服务器证书是否正确。

我更喜欢 perl 解决方案，但似乎没有*真正验证*证书的 CPAN 解决方案 - 我认为 Crypt::SSLeay 会这样做，但不是在我的测试中（[http://perlmonks.org/? node_id=739072](http://perlmonks.org/?node_id=739072) )

我简要地查看了 python（虽然我不确定是否可以在我们的生产服务器上安装任何非 perl 语言），但似乎直到版本 2.6.0 才支持证书验证。

也许我可以掏出一些钱 - wget 似乎实际上验证了对等证书，但我不确定如何在验证之前保留 xml 帖子。似乎这需要两个 wget 请求：一个用于验证证书，一个用于发布 xml。这对我来说似乎不是最安全的解决方案（第二个帖子可能被劫持）。

有小费吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:19:22.970

您应该使用 cURL，而不是 wget。cURL 支持对等证书验证。

你可以在命令行上shell out并执行cURL，或者使用Perl库；万维网::卷曲。

[http://curl.online-mirror.de/docs/sslcerts.html](http://curl.online-mirror.de/docs/sslcerts.html)

祝你好运！

# sql - 防止值在mysql中变为负数的最佳方法

> ID：488761
> 
> 赞同：0
> 
> 时间：2009-01-28T18:30:15.120
> 
> 标签：sql, optimization, mysql

我们有一个表，通过在该表中记录交易来维护帐户余额。即最近的一行是帐户余额。

在记录提款时，我们希望确保余额​​永远不会变为负数。我们提出的解决方案类似于：

```
INSERT INTO `txns`
  (`account_id`, `prev_balance`, `txn_type`, `new_balance`,  `amount`, `description`)
SELECT 
  t.account_id, t.new_balance, $txn_type, t.new_balance - $amount, $amount, $description
FROM`txns` t
WHERE t.account_id = '$account'
  AND (select new_balance 
        FROM txns 
        WHERE account_id = '$account' 
        ORDER BY txn_id desc limit 1) >= $amount
ORDER BY txn_id desc LIMIT 1;" 
```

但是我们有点担心 ANDed 子查询的性能（我们在之前的项目中遇到了子查询性能问题）。这里的开发人员都不是 sql 专家。押金没有附加条款。

这一切都在 MySQL 5.0 上

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T18:51:17.950

我不能说任何关于查询的性能，对不起。但是您可能需要考虑触发器以防止“new_balance”变成负数。（因为如果'new_balance'低于$amount，我觉得做空插入很奇怪，但它可能仍然有效:)）。

有关如何创建触发器的详细信息，请参阅[MySQL 5.0的文档。](http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html)

基本上，如果 NEW.new_balance 为负数，您会将支票放入 BEFORE 触发器中。如果是，那么您将使用“STOP ACTION”（执行中的故意错误）来中止触发器和 INSERT 查询。请参阅评论中提到的页面上的想法。

更新：修改了一下（我在家里安装 MySQL 的借口）。

我的版本存在为每个输入到moneylog 的值第二次写入数据库的问题。

也许切换到存储过程是可取的。或者其他人有更好的主意，我不太喜欢 DB :)

```
CREATE DATABASE triggertest;
CONNECT triggertest;

CREATE TABLE transferlog (
  account SMALLINT UNSIGNED NOT NULL ,
  amount INT NOT NULL,
  new_balance INT NOT NULL
) ENGINE=INNODB;

CREATE TABLE stopaction (
  entry CHAR(20) NOT NULL,
  dummy SMALLINT,
  UNIQUE(`entry`)
);

INSERT INTO stopaction (`entry`) VALUES ('stop');

DELIMITER #
CREATE TRIGGER nonneg_insert BEFORE INSERT ON transferlog
  FOR EACH ROW BEGIN
    INSERT INTO stopaction (`entry`)
      SELECT CASE WHEN NEW.new_balance<0 THEN 'stop'
                  ELSE 'none' END;
    DELETE FROM stopaction WHERE entry!='stop';
  END;
#

CREATE TRIGGER nonneg_update BEFORE UPDATE ON transferlog
  FOR EACH ROW BEGIN
    INSERT INTO stopaction (`entry`)
      SELECT CASE WHEN NEW.new_balance<0 THEN 'stop'
                  ELSE 'none' END;
    DELETE FROM stopaction WHERE entry!='stop';
  END;
#
DELIMITER ;

INSERT INTO transferlog (`account`, `amount`, `new_balance`)  
  VALUES (1, 1000, 1000);
INSERT INTO transferlog (`account`, `amount`, `new_balance`)
  VALUES (1, -1000, 0);
INSERT INTO transferlog (`account`, `amount`, `new_balance`)
  VALUES (1, -1000, -1000);
INSERT INTO transferlog (`account`, `amount`, `new_balance`)
  VALUES (1, 10, 20);
SELECT version();

DROP DATABASE triggertest; 
```

也许它会适合你，我对 INSERT-Lines 的输出是：

```
mysql> INSERT INTO transferlog (`account`, `amount`, `new_balance`)  VALUES (1, 1000, 1000);
Query OK, 1 row affected (0.03 sec)

mysql> INSERT INTO transferlog (`account`, `amount`, `new_balance`)  VALUES (1, -1000, 0);
Query OK, 1 row affected (0.02 sec)

mysql> INSERT INTO transferlog (`account`, `amount`, `new_balance`)  VALUES (1, -1000, -1000);
ERROR 1062 (23000): Duplicate entry 'stop' for key 1

mysql> INSERT INTO transferlog (`account`, `amount`, `new_balance`)  VALUES (1, 10, 20);
Query OK, 1 row affected (0.02 sec)

mysql> SELECT version();
+---------------------+
| version()           |
+---------------------+
| 5.0.67-community-nt |
+---------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T18:55:11.543

你为什么不这样做：

```
INSERT INTO `txns`
  (`account_id`, `prev_balance`, `txn_type`, `new_balance`,  `amount`, `description`)
SELECT *
FROM (
 SELECT
  t.account_id, t.new_balance, $txn_type, t.new_balance - $amount, $amount, $description
 FROM `txns` t
 WHERE t.account_id = '$account'
 ORDER BY txn_id desc
 LIMIT 1
)
WHERE new_balance - $amount > 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T19:01:36.120

我必须同意触发的想法。如果这是无论如何输入数据都必须遵循的会计规则，则它需要在触发器中。

如果这仅适用于这种特殊情况，则在 SQL 代码中执行此操作。我不知道 mySQL，但在 SQL 服务器中，我会将检查放入 if 语句中，如果满足 IF 条件，则事务失败。这里的关键不是忽略数据而是主动失败交易，否则用户认为数据已经输入，而数据不符合输入标准。我永远不会为未封装在事务中的金融系统编写任何 cdode，如果不满足业务规则，它将回滚整个事务并向用户发送错误。

# .net - 使用 LinkBut tons 作为超链接是不好的做法吗？

> ID：488764
> 
> 赞同：3
> 
> 时间：2009-01-28T18:30:27.570
> 
> 标签：.net, asp.net

我有一个 Web 应用程序，其起始页由各种链接组成。我为这些链接使用了 System.Web.UI.WebControls 的 LinkBut​​ton 控件。我在回发时做了一些处理，然后我重定向到适当的页面。我发现的问题是在 IE7 中我无法右键单击“链接”并在新选项卡中打开。回发发生并出现新页面，但在当前选项卡中，而不是新页面！我也尝试了 chrome 中的网络应用程序，右键单击链接时，chrome 甚至没有提供选项。

看来，如果用户可能需要在新选项卡中打开目标页面，我需要使用超链接或超链接控件。但是，如果我仍然可以选择在跳转到该链接之前进行一些处理，那就太好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T18:36:01.520

通常，像普通超链接一样使用 LinkBut​​ton 是不好的做法，在 POST 返回后执行 302 重定向甚至更糟糕。

1.  一方面，它破坏了您已经找到的浏览器交互。
2.  但更重要的是，如果您有外部网站，它会破坏您网站的搜索引擎索引。

此外，您仍然可以对实际的超链接进行一些预处理，但您只是在不同的庄园中进行。如果您告诉我们您在做什么，也许我们可以帮助您找到更好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T18:34:32.553

您可以使用超链接到某个中间页面并传递一些查询字符串参数。然后在中间页面的页面加载中进行重定向。这样，您仍然可以在新选项卡或窗口中打开链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T18:37:02.703

为什么不直接将查询字符串与您需要的数据一起传递呢？回发，然后重定向不仅会降低性能（客户端往返次数的两倍），而且会散发出糟糕设计的味道。

# python - 验证子类中的 Python 参数

> ID：488772
> 
> 赞同：0
> 
> 时间：2009-01-28T18:31:42.980
> 
> 标签：python, inheritance, decorator, static-typing

我正在尝试验证一些 python 参数。在我们在 Python 3.0 中获得新的静态类型之前，最好的方法是什么。

这是我正在尝试的示例：

```
class A(object):
    @accepts(int, int, int)
    def __init__(a, b, c):
        pass

class B(A):
    @accepts(int, int, int, int)
    def __init__(a, b, c, d):
        A.__init__(a, b, c) 
```

正如您所看到的，装饰器很好地对我的类的输入进行类型检查，但是我必须为第二个类定义所有参数，当我有多个继承级别时，这会变得非常讨厌。我可以使用 kwargs 取得一些成功，但它不如上面的类型检查方法那么好。

本质上，我想从 kwargs 列表中弹出一个参数并检查它的类型，然后将其余部分传递给它的父级，但是随着规模的扩大，以一种非常灵活和干净的方式执行此操作。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T19:32:30.813

为什么不只定义一个`any`值，并用 装饰子类构造函数`@accepts(any, any, any, int)`？您的装饰器不会检查标有 的参数`any`，并且`@accepts`超类构造函数上的 将检查子类传递给它的所有参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T19:17:18.613

您可能想玩转该`inspect`模块。它会让你枚举超类、参数列表和其他有趣的东西。似乎您可能想要检查超类`__init__`方法的参数列表并将其与子类中的参数列表进行比较。我不确定这是否对你有用。

不过，我会小心你所做的假设。假设仅仅因为类 A 有*N*个参数`__init__`，子类将至少包含*N*个参数并将第一个*N*传递给超类，这可能是不安全的。如果子类更具体，那么它可能会用 2 个参数填充其超类`__init__`方法的所有参数。

# svn - 如何在 Apache+SVN 上使用 SVNParentPath 指令列出所有存储库？

> ID：488778
> 
> 赞同：18
> 
> 时间：2009-01-28T18:32:42.260
> 
> 标签：svn, apache2, mod-dav-svn

我通过 Apache 使用 SVN，`dav_svn_module`如下所示：

```
<Location /svn>
  DAV svn
  SVNParentPath C:/svn_repository
  AuthName "Subversion Repository"
  ...
</Location> 
```

这让我可以访问我的存储库：

```
C:/svn_repository/repo1
C:/svn_repository/repo2
C:/svn_repository/repo3 
```

通过这些网址：

```
https://examples.com/svn/repo1
https://examples.com/svn/repo2
https://examples.com/svn/repo3 
```

这些 URL 工作得很好。当我只去 /svn （没有 repo 名称）时，我得到一个 403/forbidden 响应。我想看看 repos 列表。那可能吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-28T19:00:38.663

添加这一行

```
SVNListParentPath on 
```

就在 SVNParentPath 下。重启阿帕奇。

# c# - Internet Explorer 无法打开 Internet 站点

> ID：488789
> 
> 赞同：1
> 
> 时间：2009-01-28T18:34:28.793
> 
> 标签：c#, asp.net, javascript, updatepanel, servercontrols

我有奇怪的错误，但这似乎只发生在 IE6 中，而且是随机发生的。我正在我公司的网站上实施omniture 分析。我制作了一个文字服务器控件并从更新面板中调用它。控件所做的只是构建 java 脚本并使用 ScriptManager.RegisterStartupScript(Control, Type, String, String, Boolean) 将 java 脚本添加到页面。这一切都很好，除了随机错误（见附图）。

从我读过的内容来看，这似乎是 IE6 中的一个错误，如果它在 body 标记内的子元素中创建，则会导致 java 脚本错误，而我的脚本最终位于 form 标记内。我只是想知道是否有任何其他方法可以用来注册不会导致此错误的控件。

[图片 http://img132.imageshack.us/my.php?image=errornf7.jpg](http://img132.imageshack.us/my.php?image=errornf7.jpg)

// 我似乎无法正确显示图像，所以我将链接到它。

[错误截图](http://img132.imageshack.us/my.php?image=errornf7.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-01T00:38:57.927

这看起来像是脚本在加载之前修改 DOM 的情况。如果我是你，我会考虑在 DOM 准备好时添加脚本。很多 JS 库都有这样做的方法。

有关此类错误的更多信息：http: [//blog.mjjames.co.uk/2007/11/knowing-whats-on-your-page.html](http://blog.mjjames.co.uk/2007/11/knowing-whats-on-your-page.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T22:25:08.860

抱歉，如果这最终完全偏离了基地，但我记得不久前遇到过这样的事情。我通过在我的脚本标签中添加“延迟”来修复它，即：

```
<script defer="true"> ... </script> 
```

这可以防止脚本在页面的其余部分完成加载之前运行，从而避免了听起来与您得到的非常相似的 IE DOM 错误。不过，我没有使用过 ASP，所以我不知道如何通过 ScriptManager 添加 defer 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-29T12:44:53.993

我也遇到过这个问题。我发现它也会影响 IE6 和某些版本的 IE7。在我的情况下，问题实际上是由 ScriptManager.RegisterStartupScript 方法引起的。一旦我删除它工作正常

# asp.net - 使用 Linq to SQL 时设置 ValidateRequest=false 是否安全？

> ID：488797
> 
> 赞同：4
> 
> 时间：2009-01-28T18:36:23.300
> 
> 标签：asp.net, linq-to-sql

我只使用 Linq to SQL 进行数据库访问，所以我认为关闭请求验证是安全的......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T18:40:55.943

所以你不关心人们在你的页面上插入 HTML/javascript 来允许他们进行跨站点脚本攻击吗？参数化查询仅有助于防止 SQL 注入，而不是所有攻击向量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T19:03:39.873

这是不安全的。Linq To SQL 确实针对 SQL 注入进行投影，因为它将数据作为参数传递。

如果您关闭验证，您将面临跨端脚本问题。

# php - PHP & MySQL 比较密码

> ID：488804
> 
> 赞同：6
> 
> 时间：2009-01-28T18:40:34.210
> 
> 标签：php, mysql, login, passwords

如何检查用户是否输入了正确的登录密码？

这就是（从一堆组合中......）我正在做的事情：

```
<?

$login = $_POST['login'];
$password = $_POST['password'];

mysql_connect('localhost', 'root', 'abc123');

mysql_select_db('aun_vox') or die(mysql_error());

$q = mysql_query("SELECT password FROM customer WHERE login='$login'");
$db_pass = mysql_result($q, 0);

if(md5($password) == $db_pass)
{
    echo "You did it.";
}

else echo "Wrong.";

?> 
```

正如我从输出中看到的那样，该`mysql_result`位有问题，但我无法找出正确的方法。

有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-28T19:02:43.090

我看到您将密码的哈希值存储在数据库中，但为了其他读者的利益，*切勿*将密码以纯文本形式存储在数据库中。你不想像[Monster.com.uk 一样](http://www.dailymail.co.uk/sciencetech/article-1128822/Hackers-steal-details-4-5m-users-Monster-uk-Britains-biggest-cyber-theft-case.html)！

您应该使用比`MD5()`. 理想情况下，您应该使用 SHA256。在 PHP 中使用该[`hash()`](http://php.net/hash)函数可以使用此哈希方法。

您还应该对密码应用随机[盐。](http://en.wikipedia.org/wiki/Salt_(cryptography))为每个用户的帐户存储不同的盐值。这有助于击败字典攻击和[彩虹表](http://en.wikipedia.org/wiki/Rainbow_table)攻击。

你应该学会使用[mysqli](http://php.net/mysqli)扩展而不是旧的 mysql 扩展。Mysqli 支持参数化查询，因此可以减少对某些 SQL 注入攻击的脆弱性。

这是一些示例代码。我还没有测试它，但它应该非常接近工作：

```
$input_login = $_POST['login'];
$input_password = $_POST['password'];

$stmt = $mysqli->prepare("SELECT password, salt FROM customer WHERE login = ?");
$stmt->bind_param("s", $input_login);
$stmt->execute();
$stmt->bind_result($password_hash, $salt);

while ($stmt->fetch()) {
  $input_password_hash = hash('sha256', $input_password . $salt);
  if ($input_password_hash == $password_hash) {
    return true;
  }
  // You may want to log failed password attempts here,
  // for security auditing or to lock an account with
  // too many attempts within a short time.
}
$stmt->close();

// No rows matched $input_login, or else password did not match
return false; 
```

* * *

其他一些人建议查询应该测试，`login = ? AND password = ?`但我不喜欢这样做。如果这样做，您将无法知道查找失败是因为登录名不存在，还是因为用户提供了错误的密码。

当然，您不应向用户透露导致登录尝试失败的原因，但*您*可能需要知道，以便记录可疑活动。

* * *

@Javier 在他的回答中说，您不应该从数据库中检索密码（或本例中的密码哈希）。我不同意。

Javier 展示了调用`md5()`PHP 代码并将生成的哈希字符串发送到数据库。但这不支持轻松地对密码进行加盐。您必须执行单独的查询来检索此用户的盐，然后才能在 PHP 中执行散列。

另一种方法是通过网络将*明文*密码从 PHP 应用程序发送到数据库服务器。任何窃听您网络的人都可以看到此密码。如果您记录了 SQL 查询，则任何有权访问日志的人都可以看到密码。有上进心的黑客甚至可以在垃圾箱中寻找旧的文件系统备份媒体，并可能以这种方式读取日志文件！

较小的风险是将密码哈希字符串从数据库中提取到 PHP 应用程序中，将其与用户输入的哈希值（也在 PHP 代码中）进行比较，然后丢弃这些变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T18:52:26.027

首先，确保在查询中使用变量之前正确转义变量 - 使用 mysql_real_escape_string()。

那么，为什么不使用 MySQL MD5 函数来检查查询中的有效登录呢？

```
SELECT login FROM customer WHERE login='$login' AND password = MD5('$password') 
```

然后只需使用 mysql_num_rows() 来计算返回的行数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T18:51:46.543

几点：

*   不要在查询字符串中插入字符串数据。尤其是用户提供的数据。如果我使用“Robert' ;drop table customer”登录会发生什么？使用转义例程，或者（更好）使用准备好的语句和绑定参数。
*   不要在数据库中存储明文密码。（你没问题）
*   不要从您的数据库中检索密码。

我通常做的是这样的：

```
$q = preparestatement ("SELECT id FROM customer WHERE login=? AND password=?");
bindvalue ($q, $_POST['login']);
bindvalue ($q, md5($_POST['password']));
$id = execprepared ($q);

if($id) {
    echo "You did it.";
} else {
    echo "Wrong.";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-12T21:25:08.657

从 FORM POST 方法获取用户密码并将 $_POST['password'] //from form// 转换为 php/jsp/any other 中的适当格式，然后与数据库中的格式化密码进行比较

通常，当您可以比较数据库中存在的 md45('{$_POST['password']}')= 时，会使用 md5 加密；或者一般 mysql 在创建密码时使用 password('your password') 命令，因此首先将您的 $_POST['password'] 放入 mysqli_query 和 mysqli_fetch_array 以获取加密的密码值，然后进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-30T12:08:03.783

大于 PHP 5.6，可以使用 hash_compare 函数。

```
 $users_password = hash(sha256,$salt.$post_password);

 if (hash_equals($users_dbpassword, $users_password)) {
      //pass is good
 } else {
       // pass failed
 } 
```

[http://php.net/manual/ru/function.hash-equals.php](http://php.net/manual/ru/function.hash-equals.php)

# c# - 如何从带有 where 子句的列表中获取数据到另一个列表？

> ID：488808
> 
> 赞同：3
> 
> 时间：2009-01-28T18:42:21.523
> 
> 标签：c#, linq, .net-3.5, c#-3.0

我有一个包含多个类的列表，其中包含一个整数 (Id) 属性。

我也有一个整数列表。

现在，我想将我的对象列表修剪为仅具有整数列表中的属性的那些类。

例子：

```
List of MyObject
[MyObjectA].Id = 1
[MyObjectB].Id = 2
[MyObjectC].Id = 3
[MyObjectD].Id = 4

List of Integer
1
2

Final list should be 
[MyObjectA]
[MyObjectB] 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T18:45:31.113

您可以使用包含：

```
var finalList = originalList.Where(x => idList.Contains(x.Id)).ToList(); 
```

或加入：

```
var finalList = (from entry in originalList
                join id in idList on entry.Id equals id
                select entry).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:39:04.443

或者，如果您有两个列表，每个列表都有属性，请尝试以下操作：

```
List<someObj1> firstList ... //assume this has items
List<otherObj2> secondList ... //assume this has items
var finalList = firstList.Where(so1 => secondList.Select(oo2 => oo2.Prop1).Contains(so1.Prop1) && so1.Prop2 == "foo");

//Prop1 is a property of the someObj1 and otherObj objects. 
//Prop2 is a property of the someObj1 object. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T18:49:02.617

这应该这样做：

```
// Assume objList is IEnumerable<MyObject> and intList is IEnumerable<int>.
IEnumerable<MyObject> intersection =
  from obj in objList
    join i in intList on obj.Id equals i
  select obj 
```

请注意，如果多个对象具有相同的 id，或者该 id 在列表中多次列出并且一个对象与之对应，则该对象将在结果列表中出现多次。

我认为该组更适合较大的列表，因为其他一些解决方案将多次遍历列表以搜索相应的对象。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-28T18:48:46.237

怎么样：

```
list.RemoveAll(x => list2.IndexOf(x.Id) >= 0); 
```

# visual-studio - 检查 .lib 文件的工具？

> ID：488809
> 
> 赞同：74
> 
> 时间：2009-01-28T18:42:25.860
> 
> 标签：visual-studio

我正在评估一些文档不足的软件。当我构建一个示例项目时，我收到一个链接器错误，如下所示：

```
错误 LNK2019：未解析的外部符号
```

这个应用程序没有很多 lib 文件，所以我可以通过反复试验来解决这个问题，但我知道有一个更*优雅*的方法可以解决这个问题。

在 Java 世界中，我会使用**grep FOO *.jar**来查找 jar，并且我正在寻找 C++ 模拟。我正在使用 Visual Studio 2005 中的 C++ 代码。

我怀疑带有 /LIST 选项的 lib.exe 实用程序可以获取信息，但到目前为止我还没有成功。它只是打印这个：

```
Microsoft (R) 库管理器版本 8.00.50727.762
版权所有 (C) 微软公司。版权所有。

花岗岩50.dll
花岗岩50.dll
花岗岩50.dll
花岗岩50.dll
...

```

有什么建议么？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-01-28T19:03:52.120

首先，您需要知道您正在查看哪种类型的库。一些库仅包含 DLL 的链接（即导入库），而其他库则是成为可执行映像一部分的代码对象（即静态库）。从该输出的外观来看，您正在查看一个 DLL 导入库。

接下来，您要使用正确的工具。Lib.exe 用于从库中提取目标文件等。这与 Java 的 jar 实用程序几乎相同。Microsoft 提供了 dumpbin.exe，它将从库中转储信息。我看到[LarryF](https://stackoverflow.com/questions/488809/tools-for-inspecting-lib-files#488823)已经提到了这一点。

对于导入库，运行`dumpbin.exe -headers foo.lib`并将其重定向到输出文件。输出将包含相关 DLL 导出的每个符号的片段。搜索以 开头的行`" Symbol name :"`。请注意，如果您想要完全匹配，“符号名称”前后有两个空格。您还可以运行输出`findstr`以生成符号列表并将其重定向到文本文件，如果您想要更好看的东西：

```
dumpbin.exe -headers foo.lib | findstr /c:"  Symbol name  :" > foo-exports.txt 
```

另一种选择是使用`depends.exe`.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-28T18:46:50.500

不止一件事可能是您的问题。我不确定查看 lib 文件是否是解决它的最佳方法，恕我直言……但是，DUMPBIN.exe 可能是您正在寻找的工具。从命令行使用它，但请确保设置了路径，或者使用 VS 在 VS 开始菜单中为您安装的“Visual Studio 命令提示符”。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-12-13T04:19:47.920

如果你有一个 DLL 并想在你的代码中使用它，并且你有一个 DLL`__declspec(dllimport)`的 DEF 文件，你可以轻松地创建所需的 LIB 文件：

```
lib /def:mydll.def /nologo /machine:x86 
```

创建**mydll.lib**

此命令应在 Visual Studio SDK 命令提示符中运行。

如果您没有一个 DEF 文件，可以非常容易地手动编写：您在**DependencyWalker** ( [http://www.dependencywalker.com](http://www.dependencywalker.com) ) 中打开 DLL，选择“另存为”->“带有导入/导出列表的文本”并在 txt 文件中包含所有导出函数的**名称**和**序号，如下所示：**

```
Export  Ordinal      Hint         Function                          Entry Point
------  -----------  -----------  --------------------------------  -----------
[C  ]    2 (0x0002)   1 (0x0001)  gsasl_base64_from                 0x000024F0
[C  ]    3 (0x0003)   2 (0x0002)  gsasl_base64_to                   0x000024A0
[C  ]    4 (0x0004)   3 (0x0003)  gsasl_callback                    0x000018B0
[C  ]    5 (0x0005)   4 (0x0004)  gsasl_callback_hook_get           0x00001900
[C  ]    6 (0x0006)   5 (0x0005)  gsasl_callback_hook_set           0x000018F0
[C  ]    7 (0x0007)   6 (0x0006)  gsasl_callback_set                0x000018A0
[C  ]    8 (0x0008)   7 (0x0007)  gsasl_check_version               0x00001870
[C  ]    9 (0x0009)   8 (0x0008)  gsasl_client_mechlist             0x00001E20
[C  ]   10 (0x000A)   9 (0x0009)  gsasl_client_start                0x00001F40 
```

其余的很快就完成了。创建一个具有以下格式的**DEF 文件：**

```
EXPORTS
gsasl_base64_from @2
gsasl_base64_to @3
gsasl_callback @4
gsasl_callback_hook_get @5
gsasl_callback_hook_set @6
gsasl_callback_set @7
gsasl_check_version @8
gsasl_client_mechlist @9
gsasl_client_start @10
gsasl_client_suggest_mechanism @11 
```

@后面的数字是序数。

* * *

PD：DependencyWalker 甚至可以**取消修饰**C++ 导出的神秘名称，例如

```
Foo@@YGHHH@Z   -->   int Foo(int, int). 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-02-12T03:10:17.547

这适用于视觉 C++ express 9 .lib ：

```
dumpbin.exe -headers clangParse.lib | findstr /c:"COMDAT"  > clangParse-exports.txt 
```

或者

```
dumpbin.exe -headers clangParse.lib | findstr /c:"sym="  > clangParse-exports.txt 
```

谢谢你 d.shawley

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-04-28T12:30:07.113

打开 Visual Studio 命令提示符

dumpbin /all Effects11.lib > D:\1.txt

# sql - Tinyint vs 比特？

> ID：488811
> 
> 赞同：84
> 
> 时间：2009-01-28T18:43:01.210
> 
> 标签：sql, mysql, sql-server, types

我不想在这里引发一场宗教战争，但是关于如何在数据库中表示布尔值似乎有两种思想流派。有人说`bit`是合适的数据类型，而其他人则认为`tinyint`更好。

我知道的唯一区别是：

*   `bit`: 存储大小为 1 位，可能的值为 0 或 1
*   `tinyint`: 存储大小为 1 字节，可能的值为 0-255

当您需要表示布尔值时，哪种数据类型更好？是否`tinyint`值得“以防万一”您需要值 > 1 的额外开销？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-01-28T18:55:06.367

当您向表中添加一个位列时，它将在每条记录中占据一个完整的字节，而不仅仅是一个位。当您添加第二个位列时，它将存储在同一个字节中。第九位列将需要第二个字节的存储空间。具有 1 位列的表不会获得任何存储优势。

Tinyint和bit都可以工作，我都成功使用过，没有强烈的偏好。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-28T18:45:46.993

位...除非您属于“真/假/找不到文件”氏族

[如果你没有得到参考...](http://thedailywtf.com/Comments/Classic-WTF-What-Is-Truth.aspx)

在 Linq2SQL 的情况下，bit 与 true/false 一起工作，这使得编程更容易。两者都有优势。

并且还需要考虑编程维护。如果您（或初级实习程序员）使用 2、3、25、41、167、200 等会发生什么？这是在哪里记录的？**位是自我记录的**并且非常普遍。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-28T18:54:36.507

我在适当的时候使用位。除了在语义上是正确的类型（语义计数！）之外，单行（无论如何在 SQL Server 上）中的多个位字段（最多 8 个）可以合并到一个存储字节中。在第八个之后，接下来的 8 个需要一个额外的字节，依此类推。

参考：

*   [SQL 2000](http://msdn.microsoft.com/en-us/library/aa225961(SQL.80).aspx)
*   [SQL 2005](http://msdn.microsoft.com/en-us/library/ms177603(SQL.90).aspx)
*   [SQL 2008](http://msdn.microsoft.com/en-us/library/ms177603.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-28T18:53:42.780

对于 MySql 用户 -[为什么你不应该在 MySQL 中使用 BIT 列](http://www.xaprb.com/blog/2006/04/11/bit-values-in-mysql/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-28T18:51:09.963

之前的 StackOverflow 帖子：[MySQL 中的 BIT 和 TINYINT 有什么区别？](https://stackoverflow.com/questions/290223/what-is-the-difference-between-bit-and-tinyint-in-mysql)

添加新的“BOOL”列时，MySQL 实际上使用 TINYINT。

我会坚持使用**BOOL**（又名**TINYINT**）并继续生活。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-28T18:45:52.080

根据定义，布尔值只允许两个值。为什么你需要更多的东西呢？如果您需要三个（或更多）状态逻辑，则使用更大的数据类型，但我会（并且确实）坚持使用标准布尔逻辑的位字段。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T18:59:10.960

我使用 bit 是因为它使我不必使用检查约束，并且因为我的 ORM 会自动将 bit 转换为可为空的布尔值 (C#)，我非常感谢一旦编码。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-07-17T18:14:40.113

**错误的零空间**

无论您的选择是什么，您都可以设置为`NULL`，`0`它不会占用*额外的空间*（因为数据库几乎总是`NULL`对每一行的每个字段都有一个标志，只是坐在那里；[更多信息在这里](http://www.sqlskills.com/blogs/paul/misconceptions-around-null-bitmap-size/)）。如果您还确保默认/最可能的值为`false`，您将节省更多空间！

**一些真实的空间**

要表示的值`true`需要字段类型定义的空间；如果一个表有多个这样的列， using`BIT`只会节省空间，因为它每 8 个字段使用一个字节（而不是`TINYINT`每个字段使用一个字节）。

`TINYINT`具有允许您自定义 8 值[位掩码](http://www.ugrad.cs.ubc.ca/~cs490/sec202/notes/intro/bitmask.pdf)的优点，而无需担心管理一堆额外的列，并且搜索理论上更快（单个整数字段与多个位字段）。但也有一些缺点，例如排序较慢、花哨的交叉索引内容以及缺少字段名称。对我来说，这是最大的损失；您的数据库将需要外部文档来记录哪些位在哪些位掩码中做了什么。

在任何情况下，都要避免使用`TEXT`字段来存储布尔值或它们的集合。对于服务器来说，搜索文本需要做更多的工作，而像“开、关、关”这样的任意命名方案可能会损害互操作性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-02-08T12:21:21.167

所有这些理论上的讨论都很棒，但实际上，至少如果你使用 MySQL 并且真的使用 SQLServer，那么最好为你的布尔值坚持使用非二进制数据，原因很简单，当你使用它时更容易使用'正在输出数据，查询等。如果您试图实现 MySQL 和 SQLServer 之间的互操作性（即在两者之间同步数据），这一点尤其重要，因为两者对 BIT 数据类型的处理是不同的。所以在实践中，如果你坚持使用数字数据类型，你会少很多麻烦。我建议 MySQL 坚持使用存储为 TINYINT(1) 的 BOOL 或 BOOLEAN。甚至 MySQL Workbench 和 MySQL Administrator 显示 BIT 数据类型的方式也不好（它是二进制数据的一个小符号）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-28T18:50:01.273

我刚刚尝试按位分组（SQL Server 2k5），它对我来说效果很好。我喜欢为应用程序使用正确的数据类型。如果它是一个真/假字段，那么我使用的是位......

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-03-26T20:12:55.113

我认为我没有看到上面提到的，但存在无法聚合 BIT 列（例如 MIN、MAX，尤其是 SUM）的问题。我刚刚使用2008进行了测试，问题仍然存在。这是我最近使用 tinyint 的最大原因——另一个是我喜欢 tinyint 的扩展方式——当你的“双值”位标志突然需要更多可能的值时，总是很痛苦。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-28T18:50:39.527

我们使用 int "vector" 字段构建所有表。然后，我们将该字段用作 32 位的集合，我们可以将其分配用于任何目的。（可能对一组状态使用一组位）。如果我们忘记了，避免我们不得不继续添加标志字段。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-28T18:51:00.523

[@Kevin：](https://stackoverflow.com/questions/488811/tinyint-vs-bit#488815)我相信您可以`group by`在位字段上使用（SQL Server 2005）：

```
declare @t table (
    descr varchar(10),
    myBit1 bit, 
    myBit2 bit
)
insert into @t values ('test1', 0, 1)
insert into @t values ('test2', 1, 0)
insert into @t values ('test3', 1, 1)
insert into @t values ('test4', 0, 0)

select myBit1, count(myBit1) from @t group by myBit1
select myBit2, count(myBit1) from @t group by myBit2 
```

结果：

```
myBit1 
------ -----------
0      2
1      2

myBit2 
------ -----------
0      2
1      2 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-07-28T04:43:56.923

TinyInt 是我的偏好。然后，在对字段进行汇总计数时，您不必强制转换它。此外，一些前端语言对 Bit 的解释与其他语言不同，使用 TinyInt 可以使验证检查对任何前端语言都通用。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-01-28T18:54:34.917

如果您使用的是 MySQL，那么不建议使用 BIT 数据类型 - [http://www.xaprb.com/blog/2006/04/11/bit-values-in-mysql/](http://www.xaprb.com/blog/2006/04/11/bit-values-in-mysql/)

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-01-28T18:57:52.040

我喜欢将 char(1) 与 'T' 或 'F' 一起使用。是的，它可以与其他值一起被滥用，但至少它很容易在报告或其他难以使用位或二进制值的地方查看。

# hibernate - Grails 中的 GORM 和 StaleObjectStateException

> ID：488812
> 
> 赞同：7
> 
> 时间：2009-01-28T18:44:49.600
> 
> 标签：hibernate, grails, grails-orm

我正在编写一个小型 Grails 应用程序，并且在运行以下相当简单的代码时，我继续获得 StaleObjectStateException:s 大约 1/10:th 对“createfoo”的调用。很可能我错过了使用 GORM 的最佳方式。

这是代码：

```
def viewfoo = {
  session.user.refresh()
  // ...
}

def createfoo = {
  session.user.refresh()
  var user = session.user
  if (param["name"]) {
    var newFoo = new Foo()
    newFoo.name = param["name"]
    if (newFoo.validate()) {
      newFoo.save()
      if (user.validate()) {
        user.addToFoos(newFoo)
      } else {
        user.discard()
      }
    } else {
      newFoo.discard()
    }
  }
} 
```

我关于 GORM 最佳实践的问题：

1.  “if-validate()-then-save()-else-discard()”是在 GORM 中持久化新对象的正确方法吗？

2.  我应该验证我将要保存（）的所有对象吗？即我应该在上面的代码中同时验证 Foo 对象和用户对象吗？验证用户对象会隐式检查 Foo 对象的状态吗？

3.  我做了什么才能得到 StaleObjectStateException？:-)

GORM/休眠异常：

```
原因：具有标识符 [15] 的类 [Foo] 的对象：乐观锁定失败；嵌套异常是 org.hibernate.StaleObjectStateException：行已被另一个事务更新或删除（或未保存的值映射不正确）：[Foo#15]

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T20:06:05.943

我注意到的一件事是您没有保存用户，即使您刚刚添加了一些 foo 。事实上，保存用户应该避免需要保存 foo。

您不必验证用户：它的属性不会被不受信任的来源更改，并且无论何时保存都会检查数据库级别的约束。

最后，像 user.refresh() 这样的东西最好移到你的操作之外并进入拦截器或过滤器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T21:26:01.320

我不确定您为什么会遇到问题，但是域对象上有一种[合并](http://grails.org/doc/1.0.x/ref/Domain%20Classes/merge.html)方法。它允许您将当前对象重新附加到当前持久上下文。

我不太了解您的 Foo，或者您对 User 对象进行了哪些自定义，或者您使用的 grails/java 版本以便能够重现这一点。

我认为这与您在用户对象上进行的刷新有关，这导致数据库版本得到更新（因此不同步），但我不能确定。

此外，根据[这篇文章的评论，我相信在 grails 1.1 中验证然后丢弃的行为正在发生变化并且不太必要](http://blog.peterdelahunty.com/2008/12/stealth-little-gotcha-in-grails-with.html)

# silverlight - XAML 最佳实践指南

> ID：488813
> 
> 赞同：3
> 
> 时间：2009-01-28T18:44:50.787
> 
> 标签：silverlight, xaml

我有一个大型 Silverlight 应用程序，我们决定重新设计整个界面。由于现在是完善一些问题的好时机，因此我想阅读一些 XAML 良好实践，以便在设计时加以考虑。

有谁知道一本关于 XAML 的好 Silverlight（甚至 WPF）书籍或指南？我不是在寻找有关 XAML 的教程，我只是想知道一些好的做法。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T19:46:15.203

这是一个很好的链接，与经常使用 wpf 和 silverlight (XAML) 的人进行视频采访 [http://dotnet.org.za/rudi/archive/2009/01/13/xaml-guidelines-released.aspx](http://dotnet.org.za/rudi/archive/2009/01/13/xaml-guidelines-released.aspx)

# linux - 什么进程正在使用我所有的磁盘 IO

> ID：488826
> 
> 赞同：124
> 
> 时间：2009-01-28T18:47:01.890
> 
> 标签：linux, io, performance, system-administration, iostat

如果我使用“top”，我可以看到哪个 CPU 很忙，以及哪个进程正在使用我所有的 CPU。

如果我使用“iostat -x”，我可以看到哪个驱动器正忙。

但是我如何查看哪个进程正在使用驱动器的所有吞吐量？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2009-01-28T19:40:13.077

您正在寻找`iotop`（假设您的内核 >2.6.20 和 Python 2.5）。如果做不到这一点，您正在考虑挂钩文件系统。我推荐前者。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-29T17:06:58.117

要找出哪些处于状态“D”（等待磁盘响应）的进程当前正在运行：

`while true; do date; ps aux | awk '{if($8=="D") print $0;}'; sleep 1; done`

或者

`watch -n1 -d "ps axu | awk '{if (\$8==\"D\") {print \$0}}'"`

```
Wed Aug 29 13:00:46 CLT 2012
root       321  0.0  0.0      0     0 ?        D    May28   4:25  \_ [jbd2/dm-0-8]
Wed Aug 29 13:00:47 CLT 2012
Wed Aug 29 13:00:48 CLT 2012
Wed Aug 29 13:00:49 CLT 2012
Wed Aug 29 13:00:50 CLT 2012
root       321  0.0  0.0      0     0 ?        D    May28   4:25  \_ [jbd2/dm-0-8]
Wed Aug 29 13:00:51 CLT 2012
Wed Aug 29 13:00:52 CLT 2012
Wed Aug 29 13:00:53 CLT 2012
Wed Aug 29 13:00:55 CLT 2012
Wed Aug 29 13:00:56 CLT 2012
root       321  0.0  0.0      0     0 ?        D    May28   4:25  \_ [jbd2/dm-0-8]
Wed Aug 29 13:00:57 CLT 2012
root       302  0.0  0.0      0     0 ?        D    May28   3:07  \_ [kdmflush]
root       321  0.0  0.0      0     0 ?        D    May28   4:25  \_ [jbd2/dm-0-8]
Wed Aug 29 13:00:58 CLT 2012
root       302  0.0  0.0      0     0 ?        D    May28   3:07  \_ [kdmflush]
root       321  0.0  0.0      0     0 ?        D    May28   4:25  \_ [jbd2/dm-0-8]
Wed Aug 29 13:00:59 CLT 2012
root       302  0.0  0.0      0     0 ?        D    May28   3:07  \_ [kdmflush]
root       321  0.0  0.0      0     0 ?        D    May28   4:25  \_ [jbd2/dm-0-8]
Wed Aug 29 13:01:00 CLT 2012
root       302  0.0  0.0      0     0 ?        D    May28   3:07  \_ [kdmflush]
root       321  0.0  0.0      0     0 ?        D    May28   4:25  \_ [jbd2/dm-0-8]
Wed Aug 29 13:01:01 CLT 2012
root       302  0.0  0.0      0     0 ?        D    May28   3:07  \_ [kdmflush]
root       321  0.0  0.0      0     0 ?        D    May28   4:25  \_ [jbd2/dm-0-8]
Wed Aug 29 13:01:02 CLT 2012
Wed Aug 29 13:01:03 CLT 2012
root       321  0.0  0.0      0     0 ?        D    May28   4:25  \_ [jbd2/dm-0-8] 
```

从结果可以看出，jdb2/dm-0-8（ext4 日志进程）和 kdmflush 一直在阻塞你的 Linux。

有关更多详细信息，此 URL 可能会有所帮助：[Linux Wait-IO Problem](http://www.chile-offshore.com/en/interesting-articles/126-linux-wait-io-problem)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-09-08T22:27:16.010

即使在不能运行 iotop 的旧 CentOS 5.x 系统上，[atop也能很好地工作并轻松安装。](http://www.atoptool.nl/)点击`d`显示磁盘详细信息，`?`寻求帮助。

```
ATOP - mybox                           2014/09/08  15:26:00                           ------                            10s elapsed
PRC |  sys    0.33s |  user   1.08s |                | #proc    161  |  #zombie    0 |  clones    31 |                | #exit         16  |
CPU |  sys   4% |  user     11% |  irq       0%  | idle    306%  |  wait     79% |               |  steal     1%  | guest     0%  |
cpu |  sys   2% |  user      8% |  irq       0%  | idle     11%  |  cpu000 w 78% |               |  steal     0%  | guest     0%  |
cpu |  sys   1% |  user      1% |  irq       0%  | idle     98%  |  cpu001 w  0% |               |  steal     0%  | guest     0%  |
cpu |  sys   1% |  user      1% |  irq       0%  | idle     99%  |  cpu003 w  0% |               |  steal     0%  | guest     0%  |
cpu |  sys   0% |  user      1% |  irq       0%  | idle     99%  |  cpu002 w  0% |               |  steal     0%  | guest     0%  |
CPL |  avg1    2.09 |  avg5    2.09 |  avg15   2.09  |               |  csw    54184 |  intr   33581 |                | numcpu     4  |
MEM |  tot     8.0G |  free   81.9M |  cache   2.9G  | dirty   0.8M  |  buff  174.7M |  slab  305.0M |                |               |
SWP |  tot     2.0G |  free    2.0G |                |               |               |               |  vmcom   8.4G  | vmlim   6.0G  |
LVM |  Group00-root |  busy     85% |  read       0  | write  30658  |  KiB/w      4 |  MBr/s   0.00 |  MBw/s  11.98  | avio 0.28 ms  |
DSK |          xvdb |  busy     85% |  read       0  | write  23706  |  KiB/w      5 |  MBr/s   0.00 |  MBw/s  11.97  | avio 0.36 ms  |
NET |  transport    |  tcpi    2705 |  tcpo    2008  | udpi      36  |  udpo      43 |  tcpao     14 |  tcppo     45  | tcprs      1  |
NET |  network      |  ipi     2788 |  ipo     2072  | ipfrw      0  |  deliv   2768 |               |  icmpi      7  | icmpo     20  |
NET |  eth0    ---- |  pcki    2344 |  pcko    1623  | si 1455 Kbps  |  so  781 Kbps |  erri       0 |  erro       0  | drpo       0  |
NET |  lo      ---- |  pcki     423 |  pcko     423  | si   88 Kbps  |  so   88 Kbps |  erri           0 |  erro       0  | drpo       0  |
NET |  eth1    ---- |  pcki  22 |  pcko      26  | si    3 Kbps  |  so    5 Kbps |  erri       0 |  erro       0  | drpo       0  |

  PID                   RDDSK                    WRDSK                   WCANCL                    DSK                   CMD        1/1
 9862                      0K                   53124K                       0K                    98%                   java
  358                      0K                     636K                       0K                     1%                   jbd2/dm-0-8
13893                      0K                     192K                      72K                     0%                   java
 1699                      0K                      60K                       0K                     0%                   syslogd
 4668                      0K                      24K                       0K                     0%                   zabbix_agentd 
```

这清楚地表明 java pid 9862 是罪魁祸首。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-09-01T08:47:18.033

TL;博士

如果可以使用`iotop`，请这样做。否则这可能会有所帮助。

* * *

使用`top`，然后使用这些快捷方式：

```
d 1 = set refresh time from 3 to 1 second

1   = show stats for each cpu, not cumulated 
```

这必须显示`> 1.0 wa`至少一个核心的值 - 如果没有磁盘等待，则根本没有 IO 负载，无需进一步查看。重要的负载通常开始`> 15.0 wa`。

```
x       = highlight current sort column 
< and > = change sort column
R       = reverse sort order 
```

选择“S”，进程状态列。颠倒排序顺序，使“R”（运行）进程显示在顶部。如果您可以发现“D”进程（等待磁盘），那么您就知道您的罪魁祸首可能是什么。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-12-04T17:56:23.597

带有 -a 标志的 iotop：

```
-a, --accumulated     show accumulated I/O instead of bandwidth 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-23T04:20:01.380

对于 KDE 用户，您可以使用“ctrl-esc”顶部调用系统活动监视器，并且有带有进程 ID 和名称的 I/O 活动图表。

由于“新用户状态”，我没有上传图片的权限，但您可以查看下面的图片。它有一个 IO 读写列。

![](https://i.stack.imgur.com/BhaCK.png)

[![](https://i.stack.imgur.com/fCKEa.png)](https://i.stack.imgur.com/fCKEa.png)
[（来源：[kde.org](https://www.kde.org/announcements/4.2/screenshots/krunner-system-activity_thumb.png)）]

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T18:55:41.480

您是否考虑过`lsof`（列出打开的文件）？

# c# - 如何将整个可滚动画布保存为 Png

> ID：488827
> 
> 赞同：2
> 
> 时间：2009-01-28T18:48:22.090
> 
> 标签：c#, wpf, canvas, png

我有一个实现 VirtualizingPanel 和 IScrollInfo 的 Canvas 类。此类包含在 ScrollViewer 中。如何将整个 Canvas 类的内容仅保存为 Png？

我知道如何保存为 Png，问题是只获取特定控件的最简单方法是什么。当控件不在视野范围内时，它会被剪裁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T19:28:46.017

我认为您无法使用虚拟化面板来做到这一点，因为它的整个生活目标是将其包含的孩子数量保持在绝对最低限度。

您可能想要做的是在代码中创建一个非虚拟化版本并将其用于您的 png 生成。

# html - 用数字另一种颜色

> ID：488830
> 
> 赞同：61
> 
> 时间：2009-01-28T18:48:54.037
> 
> 标签：html, css, colors, html-lists

```
<ol>
   <li>test</li>
   <li>test</li>
</ol> 
```

将显示为：

1.  测试
2.  测试

我想要有颜色的数字和黑色的文字！

我可以编辑 css，但我无权访问 HTML。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-01-28T19:35:11.823

[CSS 规范](http://www.w3.org/TR/CSS2/generate.html#counters)给出了一个这样做的例子。不幸的是，虽然它适用于 Firefox 3，但它似乎不适用于 IE7：

```
<html>
<head>
    <style>
        ol { counter-reset: item; }
        ol li { display: block; }
        ol li:before {
            content: counter(item) ". ";
            counter-increment: item;
            color: red;
        }
    </style>
</head>
<body>
    <ol>
        <li>item</li>
        <li>item</li>
        <li>item</li>
    </ol>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-01-28T18:50:27.513

不确定这是否有效，但我认为它应该：

```
<li style='color: red;'><span style='color:black;'>test</span></li> 
```

**编辑**
如果您无法编辑html，那么恐怕这是不可能的。如果您可以将 javascript 添加到 HTML（一次在头部），那么您可以这样做：

```
$(document).ready( function() {
 $('ol li').wrapInner('<span class="black"> </span>').addClass('red');
}); 
```

为此，您将需要 jQuery 库。
然后在你的 CSS 中设置一个带有 color:red/black 声明的红色和黑色类。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-10-10T12:08:45.710

这是一个解决方案，它还包装了每个列表项的文本，左对齐在第一行下方（而不是在列表编号下方）：

**HTML**

```
<ol class="GreenNumbers">
   <li>Long text that might wrap onto a second line.</li>
   <li>Long text that might wrap onto a second line.</li>
   <li>Long text that might wrap onto a second line.</li>
</ol> 
```

**CSS**

```
.GreenNumbers {
    list-style-type: none;
}
.GreenNumbers ol {
    margin-left: 2em;
}
.GreenNumbers li {
    counter-increment: count-me;
}
.GreenNumbers li::before {
    content: counter(count-me) ". ";
    display: block;
    position: relative;
    max-width: 0px;
    max-height: 0px;
    left: -1.3em;
    top: .05em;
    color: #008000;
    font-weight: bold;
} 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2021-01-14T22:02:17.170

## 现代方法 (2021) - ::marker 伪元素

`::marker`伪元素的引入使得改变有序列表中数字的颜色（和其他样式）变得更加简单。

例子：

```
ol li::marker {
    color: red;
} 
```

现代浏览器已经支持使用`::marker`：[https ://caniuse.com/css-marker-pseudo](https://caniuse.com/css-marker-pseudo)

我们正处于不再需要旧的解决方案（变通办法）的地步，大多数网站现在都可以轻松使用`::marker`。

请记住，并非所有属性都在标记标签上可用。有关更多详细信息，请参阅 MDN 文档：[https ://developer.mozilla.org/en-US/docs/Web/CSS/::marker](https://developer.mozilla.org/en-US/docs/Web/CSS/::marker)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-28T18:55:49.470

这应该可以满足您的需求：

[http://archivist.incutio.com/viewlist/css-discuss/67894](http://archivist.incutio.com/viewlist/css-discuss/67894)

HTML

```
<ol>
    <li>1 some text here</li>
    <li>2 some more text that can span longer than one line</li>
</ol> 
```

CSS

```
ol { list-style: none; padding-left: 2em; text-indent: -1em;}

li:first-letter { float: left; 
                  font-size: ??; 
                  color: white; 
                  background: orange; 
                  line-height: 1.0; } 
```

除非您想根据您的设计更改颜色和背景。

下一个是矫枉过正，但为您提供了大量有关如何设置列表样式的信息：

[http://print.wordpress.com/2006/02/22/css-beautifully-numbered-lists/](http://print.wordpress.com/2006/02/22/css-beautifully-numbered-lists/)

-亚当

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-05-07T19:57:21.240

@kdgregory 的代码对我有用，但它影响了我的项目符号列表。我更改`li`为`ol li`防止子弹物品受到影响。像这样：

```
ol { counter-reset: item }
ol li { display: block }
ol li:before { content: counter(item) ". "; counter-increment: item; color: red; } 
```

PS 我也更喜欢在 CSS 中使用大写的元素，`BODY`这样我可以很容易地将它与 classes`.body`和 ids区分开来`#body`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T19:20:58.420

[从我在其他地方找到的类似问题](http://archivist.incutio.com/viewlist/css-discuss/35180)的答案：

> 顺便说一句，CSS3 将允许使用 ::marker 伪元素轻松设置列表标记的样式。

但是现在看来您必须将 . 添加`<span>`到您的 html 中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T19:06:38.933

为了扩展其他人所说的内容以及额外的问题说明，CSS没有内置的方法可以做到这一点而无需接触HTML。如果您希望保持 HTML 尽可能干净和语义化，我会使用 javascript（可能使用 jQuery 之类的库）来调整 DOM 以使 css 更有效。

但是，我会警告使用颜色来传达信息。我不确定彩色数字的用途是什么，但是使用颜色来显示信息会使色盲用户脱离循环，并且对可访问性来说是一个很大的禁忌。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-15T17:38:52.440

**html**：

```
 <ol>
    <li>1 A long bullet here it is long to show how it behaves on a second line</li>
    <li>2 A long bullet here it is long to show how it behaves on a second line</li>
    <li>3 A long bullet here it is long to show how it behaves on a second line</li>
    <li>4 A long bullet here it is long to show how it behaves on a second line</li>
    <li>5 A long bullet here it is long to show how it behaves on a second line</li>
    </ol> 
```

**CSS**：

```
ol {列表样式：无；左边距：10px；文本缩进：0px；左边距：5px;}

ol li {颜色：#666;}

ol li:first-letter {color:#69A8DE; 填充右：5px；左边距：-15px;}

```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-10-08T04:44:47.810

too bad you can't edit the html... how about js?

```
<script>
var x = document.getElementsByTagName('li');
for (i=0; i<x.length; i++) { x[i].innerHTML ="<span>" + x[i].innerHTML + "</span>" }

// or with jQuery
$('.li').each(function(){this.innerHTML="<span>" + this.innerHTML + "</span>" })
</script>

<style>
li {color: #DDD;}
li span {color: black;}
</style> 
```

if not, maybe a good-enough solution would be

```
ol {background-color: #DDD;}
li {background-color: white;} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-08T17:02:42.310

在 CSS 中更改 ul li{ color: yourcolor} 的颜色 在 html 中，在 li 中放置一个带有类的 span 并赋予它另一种颜色。它适用于任何它不是和图像的列表样式。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-11-01T14:07:23.980

这有点晚了，但我想与社区分享，我花了很长时间才做到这一点。我找到了一个解决方案来更改适用于每个浏览器的 OL 数字背景和颜色。需要在`li`.

[看这里](http://jsfiddle.net/yKgFF/18/)

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2009-01-28T19:51:00.527

这很容易，只要您不想为不同的列表项编号分配不同的颜色。无需修改 HTML。虽然可能无法在 100% 的浏览器中运行..

```
ol {color:red;}
ol li {color:black;} 
```

# javascript - iPhone Web 应用程序的最佳客户端数据存储？

> ID：488836
> 
> 赞同：0
> 
> 时间：2009-01-28T18:50:53.910
> 
> 标签：javascript, iphone, database

我正在构建一个针对 iPhone 的网络应用程序。它类似于待办事项列表。我需要应用程序能够离线工作，即它应该允许用户在没有与服务器的连接时添加/编辑/删除条目，稍后当服务器再次在线时会同步。

你如何建议我在客户端存储这些数据（记住它是一个网络应用程序）？我认为 cookie 使用起来并不安全，因为它们可能会在某个时候被清除。我知道 Dojo 和 ExtJs 都提供对客户端数据存储的支持——哪个库将提供最好的功能，同时保持精益求精？我应该调查哪些其他图书馆？这些选项是否提供与服务器端数据存储的同步功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T19:37:58.730

Mobile Safari 基于 WebKit，并配备了基于 HTML5 的客户端数据库存储。请参阅此[Surfin' Safari 博客文章](http://webkit.org/blog/126/webkit-does-html5-client-side-database-storage/)。

如果您的 Web 应用程序仅适用于 iPhone，那么这绝对是您应该采用的方向。

# c++ - 如何使用 C++ 为 Windows 应用程序创建 GUI？

> ID：488837
> 
> 赞同：26
> 
> 时间：2009-01-28T18:50:57.060
> 
> 标签：c++, visual-studio, user-interface, winapi

我正在决定如何为小型 c++/win32 api 项目（工作 Visual Studio C++ 2008）开发 GUI。该项目只需要几个组件来启动主流程，因此它的重量非常轻（几乎只有 1 个按钮和一个文本框......）。我的问题是这样的：

我没有在 Windows 上开发 GUI 的经验，但我可以轻松学习。那么，我应该使用什么？一个可视化编辑器（拖放代码生成g：到目前为止我对桌面 GUI 设计的偏好（java/swing））。还是我应该使用特定的库？无论哪种方式，我应该使用哪个库或可视化编辑器？我听说有人提到用 C# 编写 GUI，然后调用 C++ 代码......问题是，这是一个如此简单的 GUI，我会发现将其全部保存在 C++ 中会更容易，但我对任何事情都持开放态度最好的建议是。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-28T18:57:57.843

到目前为止，最好的 C++ GUI 库是[Qt](http://www.qt.io/)，它全面、易学、速度非常快，而且是多平台的。

啊，它最近获得了 LGPL 许可证，所以现在你可以免费下载它并包含在商业程序中

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-28T19:00:35.857

如果您正在做一个非常简单的 GUI，并且您已经在使用 Visual Studio，那么使用 MFC 可能是有意义的。您可以使用 Visual Studio MFC 向导创建一个基于对话框的应用程序，在其上放置两个控件，然后就可以离开了。

MFC 已经过时并且有相当多的烦恼，但如果您只是在谈论一个按钮和一个文本框，它肯定会为您完成工作。

我对 Qt 没有任何经验，因此无法将两者进行比较。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-28T19:19:05.490

我非常喜欢简单地使用 Microsoft Visual Studio 并编写本机 Win32 应用程序。

对于像您描述的那样简单的 GUI，您可以简单地创建一个[对话框](http://msdn.microsoft.com/en-us/library/ms644994(VS.85).aspx)并将其用作您的主应用程序窗口。Visual Studio 中由 Win32 项目向导创建的默认应用程序实际上会弹出一个窗口，因此您可以用 Dialog Box[替换](http://msdn.microsoft.com/en-us/library/ms645452(VS.85).aspx)该窗口，并将 WndProc 替换为类似（但更简单）的[DialogProc](http://msdn.microsoft.com/en-us/library/ms645469(VS.85).aspx)。

那么，问题是工具和成本之一。除了实际创建对话框模板资源之外，Visual C++[速成版](http://www.microsoft.com/Express/)可以满足您的所有需求。为此，您可以手动将其编码到[RC 文件中，也可以手动](http://msdn.microsoft.com/en-us/library/aa381003(VS.85).aspx)将其编码到[内存中](http://msdn.microsoft.com/en-us/library/ms644994(VS.85).aspx#templates_in_memory)。相关的 SO 问题：[Windows API Dialogs without using resource files](https://stackoverflow.com/questions/61634/windows-api-dialogs-without-using-resource-files)。

或者您可以尝试其他人推荐的[免费资源编辑器之一。](https://stackoverflow.com/questions/381915/free-resource-editor-for-windows-rc-files)

最后，[Visual Studio 2008 标准版](http://www.amazon.com/o/ASIN/B000WLY9XG)是一个更昂贵的选择，但为您提供了一个集成的资源编辑器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T19:01:37.880

只需创建一个新的 MFC C++ 应用程序。它是内置的，非常简单，世界上存在数千个示例......

此外，您可以直接在 Visual Studio 中设计您的对话框，为它们指定变量名称，然后为您生成 90% 的代码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-28T19:19:05.910

我强烈建议不要使用普通的 Win32，因为很难让它在所有情况下都能正常工作，这是相当乏味和乏味的工作，而且 Common Controls 库也不*完整*。此外，大部分工作已为您完成。

每次我最终完成普通的 Win32 时，我都必须花费至少几个小时来处理最琐碎的任务，因为我必须查找所有参数、标志、函数、宏并弄清楚如何正确连接它们。我通常更喜欢简单的拖放，不要让我使用我的大脑类型的解决方案，然后在 2 分钟内将东西拼凑在一起。

作为一个轻量级工具包，我建议[使用 omgui](http://omgui.sourceforge.net/)，它有一个干净漂亮的 API。但是，它不附带任何工具。

如果您需要工具支持，您可能最终想要选择 MFC（Visual Studio 中内置的资源编辑器）或 Qt。我不知道 wxWidgets 是否有任何工具，但我想它有。

**编辑：** David Citron 提到，Visual Studio 中的资源编辑器显然会生成与 Win32 兼容的资源文件，因此如果您想保持简单，这可能是首选方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-29T15:50:06.297

避免 QT（对于新手）或任何无用的库（对于这样的基本事物来说是荒谬的）

只需使用 VS Win32 api 向导，添加按钮和文本框...仅此而已！

25秒内！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T19:00:55.310

来自诺基亚的 Qt 绝对是要走的路。另一种选择是 gtk，但 Qt 得到了更好的支持和记录。无论哪种方式，它们都是免费的。它们都被广泛使用并且众所周知，因此很容易找到问题的答案。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-28T19:09:48.160

对于这样一个简单的应用程序，即使是 MFC 也将是矫枉过正。如果不想引入另一个依赖项，只需在普通的 Win32 中执行即可。如果您从未使用过 MFC，这对您来说会更容易。

查看 Charles Petzold 的经典“Programming Windows”或一些在线教程（例如[http://www.winprog.org/tutorial/](http://www.winprog.org/tutorial/)），您就可以开始了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-28T19:15:14.033

如果你想了解win32，WTL [http://wtl.sourceforge.net/](http://wtl.sourceforge.net/)是相当轻量级的MFC 等价物，但你必须喜欢模板才能使用它。

如果你想要一些简单的 MFC 已经与 VS 集成，它也有大量的额外代码和网络中已知错误的解决方法。

Qt 也是非常棒的框架，它有一套很好的工具、对话框编辑器、主题和许多其他东西，而且您的应用程序将准备好跨平台，尽管需要一些时间来适应。

你也有 Gtk、wxWindow，如果你已经在 linux 上使用过它，你不会有任何问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-29T10:29:11.153

一个带有一些文本和一个按钮的简单“窗口”只是一个 MessageBox。您可以使用单个函数调用来创建它们；你不需要任何图书馆。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-29T16:10:12.760

我在小型项目中使用过 wxWidgets，我很喜欢它。Qt 是另一个不错的选择，但对于商业用途，您可能需要购买许可证。如果您使用 C++ 编写，请不要使用 Win32 API，因为您最终会使其面向对象。这并不容易且耗时。此外，Win32 API 有太多的宏，感觉它提供的东西过于复杂。

# oop - 库存系统的 OOP 方法

> ID：488840
> 
> 赞同：0
> 
> 时间：2009-01-28T18:51:16.717
> 
> 标签：oop

我们正在开发一个系统来跟踪我们外地办事处的库存。

该系统的核心将有一个“资产”列表——比如自行车、电脑、帐篷。每个资产都会经历“活动”、“丢失”、“已签出”、“已库存”等状态。一些州有其他信息，例如“签出至”或“库存者”。

所以，我认为每个 State 都将是父类的子类，或者可能实现 iState 接口。那部分对我来说很清楚。

我坚持的是一个很好的 OOP 设计，可以将哪些状态的业务逻辑置于前一个状态之后（Asset 对象将存储它的“最后一个”状态）。例如，签入只能跟随签出。活动必须是资产上记录的第一个状态。

任何想法或指示都会有所帮助。在这一点上，没有一个 GoF 设计模式让我大吃一惊。

是的，我知道我们应该关注 COTS，但管理层决定暂时继续推出我们自己的工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T19:07:42.067

你有点回答了你自己的问题。查看[状态](http://www.dofactory.com/Patterns/PatternState.aspx)模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T19:07:31.363

唔。这听起来更像是工作流程/业务规则问题，而不是 OOD。我不知道任何像您描述的那样强制执行状态顺序/依赖关系的 OO 原则。

# c# - 在 C# 中的 foreach 语句中的每次迭代中都会调用返回集合的方法吗？

> ID：488856
> 
> 赞同：7
> 
> 时间：2009-01-28T18:55:08.847
> 
> 标签：c#, .net, loops, iterator

我今天早上正在处理一些 C# 代码，我有类似的东西：

```
foreach(DataRow row in MyMethod.GetDataTable().Rows) {
//do something
} 
```

因此，由于我对语言框架没有完全了解，我想知道 GetDataTable() 是否在每次迭代完成时被调用，或者它是否只被调用一次并且结果数据（将是 Rows）保存在内存循环通过它。无论如何，我声明了一个新集合来保存它并从那里开始工作......

我添加了一个新变量，所以我做了：

```
DataRowCollection rowCollection = MyMethod.GetDataTable().Rows;
foreach(DataRow row in rowCollection) {
//do something
} 
```

但我不太确定这是否有必要。

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-28T18:57:18.263

别担心；它只会在内部执行一次 GetDataTable() 以从 DataRowCollection 中获取枚举器对象，然后在每次循环运行时从中获取一个新项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T10:21:36.630

foreach 循环只是语法糖

```
var enumerator = MyMethod.GetDataTable().Rows.GetEnumerator();
while (enumerator.MoveNext())
{
    DataRow row = enumerator.Current;
    // Initial foreach content
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T19:00:47.307

Gustavo - 套用我的一位老 CS 教授的话：调试器是你的朋友！如果您有几分钟和一些耐心，您可以将表格的提取包装在另一个类中并在那里放置一个断点。您会发现，确实创建了一个对象，因此不会重复调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T18:57:08.593

它只被调用一次然后存储。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T18:57:44.830

你在做的事情本质上是一样的。在第一种情况下，您正在创建对 DataRowCollection 类的引用，然后运行 ​​foreach，而在第一种情况下，您没有创建引用。在这两种情况下，您都在堆上的 DataRowCollection 实例上调用 .GetEnumerator()。

在从方法 GetDataTable() 检索到实例后，您将在实例上调用它。

GetDataTable() 只被调用一次。

# eclipse - 在 Eclipse 中处理 Tomcat：让它像 MyEclipse 一样简单？

> ID：488862
> 
> 赞同：1
> 
> 时间：2009-01-28T18:55:55.520
> 
> 标签：eclipse, tomcat, integration, myeclipse

我已经使用 MyEclipse 很多年了。我得出的结论是，我宁愿放弃 MyEclipse 并恢复到普通的旧 Eclipse，**除了**一个细节：MyEclipse 的 Tomcat 集成。有谁知道可以提供这种集成的 Eclipse 插件？

这是我当前的 MyEclipse 设置所做的，我想保留它：

1.  与我自己的 Tomcat 外部副本（我选择的版本）集成。
    *   从 IDE 中启动和停止该外部服务器。
    *   根据项目的构建路径处理 Tomcat 的构建路径。
    *   将项目部署到该外部副本（类、库、资源和所有）。
    *   修改后的 JSP 和类的热更新。

实际上，只要我在 IDE 中玩游戏，我就可以在大多数情况下避开 Ant。

使用 Eclipse，我知道我可以实现 1\. 和 2\. 其他步骤呢？

注意：以防万一被问到，为什么要放弃 MyEclipse？

*   避免更新许可证。
*   MyEclipse 与 SpringIDE 冲突。
*   MyEclipse 的 JSP 和 CSS 编辑器很痛苦……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T19:05:09.543

Re 3：Eclipse（特别是 Web 工具平台功能）可以从 Tomcat 安装中的库 + 存储在 WEB-INF/lib 中的库创建构建路径。或者，您可以通过项目属性的“J2EE 模块依赖项”部分设置希望在 Tomcat 中可见的库。

回复 4：是的

回复 5：是的

我认为 WTP 中的默认 JSP/CSS 编辑器与 MyEclipse 中的相同。

WTP 支持不同的部署模式。它可以部署到您现有的安装中，也可以在本地创建新的 Tomcat 服务器（基于您现有的设置，并使用现有的 Tomcat 安装），并在那里部署……您的开发 Tomcat 以这种方式完全分离。此外，您可以在 Tomcat 中创建多个服务器（我在处理同一项目的不同分支时使用它），然后启动您想要的一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T04:34:50.017

Re 2：Eclipse 的 Sysdeo 插件支持从您的 IDE [http://www.eclipsetotale.com/tomcatPlugin.html启动/停止](http://www.eclipsetotale.com/tomcatPlugin.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-18T21:21:27.173

试试 Eclipse 的 Java EE 版本。与Tomcat的集成非常好。

（而且我也使用 MyEclipse 有一段时间了，在角落里太脆弱了，但我喜欢他们的热部署。）。

# django - Django 部署：削减 Apache 的开销

> ID：488864
> 
> 赞同：9
> 
> 时间：2009-01-28T18:56:44.957
> 
> 标签：django, apache, deployment, mod-wsgi

我有一个小型 VPS 服务器，它有一个 Nginx 前端，它提供静态媒体文件并将 Django 请求传递回运行 mod_wsgi 的 Apache 2.2 prefork MPM 服务器。

加载并运行一个（非常）小的站点后，它当前使用 143MB 的 256MB 内存。

使用该`top`命令，我可以看到 Apache 使用了 52.9% 的可用 RAM，其次是 memcache，使用了 2.1%。

考虑到我打算在这台服务器上放置很多 Django 项目，我想知道是否有什么办法可以减少 Apache 使用的 RAM 量？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T20:00:59.800

如果你想坚持使用 Apache，有一些建议，大致按难易程度排列：

*   使用 Apache worker MPM 而不是 prefork。每个客户端连接使用的实际内存会更少，但请注意，为 Linux 上的 Apache 分配的虚拟内存可能看起来非常高，因为 Linux 为每个线程的堆栈分配了 8MB。这实际上并不重要，除非您的 VPS 是脑死亡并且限制虚拟内存而不是实际的 RSS（驻留集大小）内存。[在这种情况下，您可以在此处](http://code.google.com/p/modwsgi/wiki/ApplicationIssues)了解如何降低线程堆栈大小（在 Memory-constrained VPS 部分下）。
*   编辑您的 Apache 配置文件并大致按比例减少 StartServers、MaxClients、MinSpareThreads 和 MaxSpareThreads 设置。适当的级别将是您所需的内存使用量和您需要能够服务的并发客户端数量之间的平衡。
*   切换到[mod_wsgi](http://code.google.com/p/modwsgi/)（在守护程序模式下）而不是 mod_python。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-24T12:13:57.013

为了记录，OP对术语MPM的使用是没有意义的。Apache 中的 MPM 不是一个选项，您在使用 Apache 时总是使用 MPM。选择是您使用的 MPM。在 UNIX 上，两个主要的 MPM 或多处理模块是 prefork 和 worker。在 Windows 上，总是使用 winnt MPM。可以在 Apache 网站上的 Apache 文档中找到有关不同 MPM 的详细信息。但是，在 mod_wsgi 的上下文中，您最好阅读以下内容：

[http://code.google.com/p/modwsgi/wiki/ProcessesAndThreading](http://code.google.com/p/modwsgi/wiki/ProcessesAndThreading)

简而言之：

*   prefork MPM 是多进程/单线程的。
*   worker MPM 是多进程/多线程的。
*   winnt MPM 在单进程/多线程中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T19:03:30.450

您可以考虑使用[Spawning](http://pypi.python.org/pypi/Spawning/0.8.10)进行部署。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T19:07:46.713

你可以在 FastCGI 上运行 Django。然后 nginx 可以直接驱动它，而不是通过 Apache。

# c# - GraphicsPath - 为什么 AddLine 方法的顺序很重要

> ID：488873
> 
> 赞同：0
> 
> 时间：2009-01-28T18:58:51.787
> 
> 标签：c#, gdi+

我正在用以下代码绘制一个三角形

```
int x = x coordinate for center;
int ax = x coordinate for left;
int bx = x coordinate for right;
int top = y coordinate for top;
int bottom = y coordinate for bottom;

//           (x, top)
//(ax, bottom)      (bx, bottom) 

GraphicsPath path = new GraphicsPath();
// _
path.AddLine(ax, bottom, bx, bottom);
// /
path.AddLine(ax, bottom, x, top);
// \
path.AddLine(bx, bottom, x, top);
// order of drawing is _ / \ (bottom line, left side, right side) 
```

当我调用 DrawPath 时，它总是绘制我的线条，无论顺序如何。但是当我调用 FillPath 时，它什么也不做。只有当我的订单是 / _ \ 或 \ _ / 时，我的三角形才会真正成交。为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T19:22:57.293

事实证明，我最初发布的答案并没有真正解决问题，并且它在我的机器上工作，因为我引入了一个额外的更改，即更改**FillMode**：

```
GraphicsPath path = new GraphicsPath(FillMode.Winding); 
```

当您使用**缠绕**模式时，即使您没有按顺序添加线条，算法也会检测到闭合路径。

# c++ - 如何使用模板中的放置删除/新建来重置课程？

> ID：488874
> 
> 赞同：1
> 
> 时间：2009-01-28T18:58:56.670
> 
> 标签：c++, pool, placement-new

我有一个池管理器模板类。当一个类对象被添加回池管理器时，我想将它重置回它的初始状态。我想在它上面调用放置析构函数和放置构造函数，以便在下次池管理器发出它时完全重置它。我已经尝试了很多方法来让它工作，但我很难过。这是我尝试过的一个例子。

```
template <class T>
void PoolClass<T>::ReleaseToPool(T *obj)
{
     obj->~T();   //call destructor

     obj->T::T(); //call constructor
     //also tried new (obj)T(); //but this doesn't seem to work either

     //then misc code to add a pointer to the object
     //to my list of available objects for re-use later
} 
```

我尝试了一堆不同的语法，但似乎都没有。代码本身是跨平台的，所以应该使用 gcc（在 mingw 或 linux 或 mac 下）编译，对于 Windows，我仍在使用 vs 2003。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T19:26:19.050

怎么样：

```
template <class T>
void PoolClass<T>::ReleaseToPool(T *obj)
{
    obj->~T();                  //call destructor
    obj = new ((void *)obj)T(); //call constructor

    // add a pointer to the object to the list...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T19:30:57.027

Boost 有一个[Pool](http://www.boost.org/doc/libs/1_37_0/libs/pool/doc/index.html)库。使用他们的而不是自己编写可能更容易。

# boost - boost::Windows 服务和用户应用程序之间的进程间

> ID：488877
> 
> 赞同：4
> 
> 时间：2009-01-28T18:59:28.900
> 
> 标签：boost, windows-services, interprocess

我正在使用 boost::interprocess 在两个应用程序之间进行通信。当两个应用程序由同一个用户启动时，效果很好。

当其中一个应用程序是服务时，它会失败。

我发现共享媒体实际上是在“TMP”目录中创建的文件。所以它失败了，因为每个应用程序都在他自己的“TMP”目录中创建自己的文件。

也许我没有将它用于我的特定目的的好方法。

有人知道如何解决我的问题吗？

非常感谢，

网卡

* * *

**编辑**：我尝试使用“ *managed_mapped_file* ”。我的问题是 win32 实现正在调用“ *CreateFileMapping* ”而没有指定对象的名称。在我的特殊情况下，我认为我需要指定类似“ *Global\MyMappedFile* ”的内容，以便应用程序和服务都可以查看映射文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T13:53:25.033

这是可行的：

*   我正在使用“ *boost::interprocess::managed_windows_shared_memory* ”
*   我的部分的名称是“Global\MySharedMemory”
*   我必须处理应用程序启动而服务未启动的情况。这是因为即使我的应用程序可以对共享内存进行读/写访问，它也无法创建它。只有服务可以。（事实上​​，应用程序可以当且仅当运行它的用户具有特殊权限*SeCreateGlobalPrivilege*）

也许有人可以找到更好的方法;-)

网卡

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-05T06:51:03.810

这是关于 Window Stations 和 ACL 的。您需要修改源以使其在 Windows 服务和用户应用程序之间工作。在 vista 和 win7 中，服务在 winsta0 上运行，而在 winsta1 上运行应用程序。所以你需要给一个带有正确 DACL 的 LPSECURITY_ATTRIBUTES。

# reporting-services - Reporting Services：Tablix RepeatColumnHeaders 不适用于某些报告

> ID：488900
> 
> 赞同：44
> 
> 时间：2009-01-28T19:03:44.757
> 
> 标签：reporting-services

所以我有各种报告，其中包含在 Tablix 中呈现的数据集......漂亮的花园品种。Tablix 控件有一个名为*RepeatColumnHeaders*的属性，我已为每个相关报表将其设置为**True**。该属性的解释是“指示列标题是否在每个页面上重复出现在数据区域的哪一部分上。” 听起来很简单，但在某些报告中它有效，而在其他报告中则无效。我似乎找不到可能影响这一点的报告有什么不同。在一个标题重复的报告中，有一些相当神秘的分组魔法，但在一个不起作用的示例中，Tablix 只有一个级别——没有分组。我希望多嵌套的问题是问题，而不是平面问题。

也许这是一个完全不同的问题。我拼凑了一个简单的 Tablix 渲染**SELECT * FROM Foo**，接受了所有默认值，这导致 RepeatColumnHeaders 被设置为**False**，你瞧，列标题*确实*为该报告重复...... Grrr。

任何见解都非常感谢。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-29T15:01:09.203

从我设法挖掘的内容来看，这有点不可思议。在分组窗格中，选择高级模式，然后选择最外面的静态行。然后，您应该会看到“RepeatOnNewPage”属性。

**更新：查找高级模式**：
@HCL 的评论链接到[@user359904 的另一个答案](https://stackoverflow.com/questions/488900/reporting-services-tablix-repeatcolumnheaders-doesnt-work-on-some-reports/2986024#2986024)，其中包含有关如何查找和进入高级模式的信息：

1.  选择tablix
2.  报表下方是“行组”和“列组”，一直到“列组”右侧是一个向下的小箭头。
3.  单击箭头，选择高级模式。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2010-06-06T21:48:52.760

我找到了一个适合我的解决方案。文尼的回答让我明白了这一点。

谢天谢地，我不必重新创建我的 tablix。我有三行组成了我的 tablix 标题。我在最高级别组之外添加了三行。这些行不绑定到任何组。我修改了这些行，使它们完全复制了我在最高级别组中的标题行。对于每个标题行，我将 KeepWithGroup 属性设置为“After”，并将“RepeatOnNewPage”属性设置为 true。我测试了报告。标题出现在每一页的顶部，但由于最高级别组内和最高级别组上方的标题行重复，标题在第一页顶部和每个分节符处重复两次。我删除了最上面部分的标题行，重复内容消失了。标题在最高级别组的每个中断处和每页的顶部正确重复。最高级别组中没有标题行。

**设置 KeepWithGroup 和 RepeatOnNewPage：**选择 tablix。在设计窗格下方的组框中，单击“列组”文本右侧的向下箭头，并确保选中“高级模式”。单击第一个静态行并将 KeepWithGroup 属性设置为“After”并将“RepeatOnNewPage”设置为 true。对构成标题的每一行执行此操作。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-28T22:43:05.843

~~很抱歉 beernuts 没有将您的回复标记为答案；我希望你能保持代表点。~~

情节变厚了。在三个测试中，我发现使用向导创建报告与获得所需的标题行为之间以及不使用向导与无法实现所需行为之间存在 1:1 的相关性。从那里我比较了一个工作和非工作示例的 rdl 文件，并找到了这个元素：

```
<RepeatOnNewPage>真</RepeatOnNewPage>

```

在文档中：

```
报表 > 正文 > ReportItems > Tablix > TablixBody > TablixRowHierarchy
  > Tablix 成员 > Tablix 成员

```

我将相同的内容添加到非工作 rdl 并且标题开始重复。

但是，我无法在设计器中找到切换它的设置、属性等。它似乎与前面描述的明显属性完全不相符。难道只是法师的神器？幸运的是，这是一个相当简单的解决方法，因为我无法使用向导重新创建十几个报告。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-09-22T17:49:57.373

您的帖子仍在使用中；）谢谢大家。我在您提供的内容的基础上提出了恢复重复标题行的解决方案。我不必使用高级模式，只是一些见解......我在所有行组之外有两个标题行，没有列组。这是我为将两个标题行放入 tablix 标题所做的操作：

1.  右键单击一个标题行和“添加组（列组）”，父组
2.  按“1”分组（此组稍后将被删除，因此无论您放什么都无所谓
3.  单击确定并添加标题行。
4.  合并新标题行中的所有列
5.  在列组窗格中，右键单击刚刚创建的组和“删除组”，选择“仅组”框**重要**
6.  现在您有了标题行，您可以在上方或下方插入行以添加更多标题行。
7.  将您的标题行移动到新的标题行并删除您的旧标题行。
8.  最后...确保将 Tablix 属性选中为“在每一页上重复列标题”

它运行良好且易于重复（我有很多 tablix）。

真诚的，艾伦

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T20:57:47.600

在标题不重复的报告中，您是否在任何时候删除了 tablix 中的默认标题行？一旦我这样做了，无论我尝试什么设置，tablix 中的标题都不会重复。我必须重新创建 tablix 才能让它工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-18T19:21:32.877

现在是 2014 年，我正在运行 2012 版本，我用你的帖子解决了我的问题 - 我们店里有经验的 SSRS 开发人员不知道如何解决（我只是一个新手）。非常感谢您提供解决方案 - 这似乎是一个永恒的问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-15T15:16:29.743

我正在从我的 SSRS 2012 服务器添加一些屏幕截图..

![在此处输入图像描述](https://i.stack.imgur.com/RNBGb.png)

现在，单击“行组”下的“（静态）”，然后按 F4。

![在此处输入图像描述](https://i.stack.imgur.com/7G5Wg.png)

另请阅读 [TechNet - SSRS：如何在每页上重复标题](http://social.technet.microsoft.com/wiki/contents/articles/19398.ssrs-how-to-repeat-headers-on-each-page.aspx)

# .net - ASP.NET MVC Html.ActionLink 结果 URL - 编码方式

> ID：488908
> 
> 赞同：6
> 
> 时间：2009-01-28T19:05:53.863
> 
> 标签：.net, asp.net-mvc, routing, html-helper, actionlink

我在 MVC 控制器中创建了大量的操作。

```
public ActionResult DoSmth1(string token)
public ActionResult DoAnother2(string token) 
```

当我必须调用 ActionLink 时..

```
=Html.ActionLink<SomeController>( x=> x.DoSmth(item.property), item.property)
=Html.ActionLink<AnotherController>( x=> x.DoAnother(item.property), item.property) 
```

...它为我生成了不同的 URL：

```
/Some/DoSmth/stringvalue
/Another/DoAnother?property=stringvalue 
```

在哪里设置它构建 URL 的方式？我完全没有想法......（（

* * *

好的，有一些方法： - 如果属性名称与路由模式中使用的相同 - 例如控制器、操作和 id - MVC 将**始终**使用路由构建器 (/c/a/id)。

这有点帮助（所以 -**尽可能将参数命名为“id”**））

但总体问题仍然有效......

* * *

> > 必须与路由中的令牌命名相同

正是——我第一次有这个想法。

但是 - 现在我只有默认路由（{controller}/{action}/{id}），但仍然有带有“属性”的 URL 斜杠......这很奇怪。

*   还有一种欺骗方式——创建一个精确的路由来匹配给定的控制器及其参数名称——似乎这将是最终的答案——但我仍然不想这样做（（

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T19:19:53.477

你没有显示你的路线，但在这个例子中你几乎肯定会选择不同的路线。操作的参数必须与路由中的令牌命名相同，以便生成的 URL 将路由令牌与 ActionLink 的 lambda 形式相匹配。与路由令牌不匹配的任何内容都将作为查询字符串参数附加，就像您的第二个 URL 一样。看到查询字符串参数是您隐式传递的名称（在本例中为“属性”）与路由标记不匹配的有力证据。由于您使用相同的令牌名称获得不同的结果，因此我得出结论您正在走不同的路线。顺便说一句，我建议使用 RouteLink 而不是 ActionLink 来构建链接，这样您就可以确定要匹配的路由。

# java - Java 相当于 Cocoa NSNotification？

> ID：488919
> 
> 赞同：5
> 
> 时间：2009-01-28T19:07:38.977
> 
> 标签：java, objective-c, cocoa, events, notifications

我正在使用 SWT 小部件编写 Java 应用程序。我想在某个事件发生时更新某些小部件的状态（例如，更新数据模型的状态）。

Java 中是否有类似于 Cocoa 的 NSNotificationCenter 的东西，我可以在其中注册一个对象以侦听通知事件并响应它们，以及让其他对象“触发”通知？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-31T02:58:19.287

好的，假设例如，您希望在 Loader 开始扫描和完成扫描时通知程序的某些部分（不要担心 Loader 是什么，或者扫描是什么，这些是来自我上一份工作中的一些代码）。您定义一个接口，将其称为“ScanListener”，例如

```
public interface ScanListener
{
  public void scanStarted();
  public void scanCompleted();
} 
```

现在 Loader 定义了一个方法让你的其他代码注册回调，比如

```
public void addScanListener(ScanListener listener)
{
  listeners.add(listener);
} 
```

Loader，当它开始扫描时，执行以下代码

```
for (ScanListener listener : listeners)
{
  listener.scanStarted();
} 
```

当它完成时，它对 listener.scanCompleted(); 做同样的事情。

需要通知这些事件的代码实现了该接口（它们自己或在内部类中），并调用“loader.addScanListener(this)”。它的 scanStarted() 和 scanCompleted() 方法在适当的时候被调用。您甚至可以使用带有参数和/或返回结果的回调来做到这一点。全取决于你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T19:18:49.080

您在寻找什么样的通知？如果你想要的只是一个对象能够告诉其他任何人“嘿，我已经改变了，相应地更新”，最简单的方法是使用现有的 Observer 接口和 Observable 类。或者用一个接口编写你自己的接口，该接口定义你想从改变的那个监听器上调用什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-31T17:32:43.123

没有预先存在的每进程服务在 java 中分派事件，相当于默认的 NSNotificationCenter。在 java 中，事件的类型由事件对象指定为特定类型（这也意味着通知方法取决于该类型）而不是使用字符串。在泛型之前，编写一个也是类型安全的通用事件调度器和接收器是不可能的（见证 AWT 和 Spring 库中 *Event 类和 *EventListener 接口的激增）。

有一些用于事件调度的设施。正如[保罗](https://stackoverflow.com/questions/488919/java-equivalent-of-cocoa-nsnotification/488950#488950)所提到的`java.util.Observable`，正如您所指出的，它需要子类化。还有`java.beans.PropertyChangeSupport`，根据您的情况，这可能很有用。

你也可以自己写一个。源代码`PropertyChangeSupport`可能在 openjdk 中可用，您可以查看废弃的[Apache Commons Event](http://commons.apache.org/sandbox/events/)项目。根据您的需要，您可能不得不担心线程、序列化、内存泄漏（确保注销或使用弱引用）和并发修改（迭代侦听器列表的副本，因为侦听器可能决定注销自己）响应变化）。

既然 Java 中存在泛型，那么泛型事件调度库将成为可能；但是，我没有遇到任何。任何人？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-31T18:17:13.987

实际上，Java 中内置了一个功能，可以完全满足您的需求，但这不是您可能考虑过的，而且老实说，对于您想要的东西，它可能有点重量级。

然而，这就是说，它确实存在。

这是JMX。

您创建 MBean，然后其他人可以注册来自这些 MBean 的事件。然后 MBean 可以发送通知。

我个人不会考虑在这种情况下使用它（我只是自己动手），但是该设施就在那里，并且定义明确并记录在案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-31T18:08:20.087

不是 Java，但 IPython 项目在[这里](http://bazaar.launchpad.net/%7Eipython-dev/ipython/trunk/annotate/head%3A/IPython/kernel/core/notification.py)有一个用 Python 编写的通知中心，您可以将其用作 Java 版本的模板。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-30T16:26:13.653

在 Java 中，这将是提供者向其侦听器发出通知。但是 Java 不提供通过 Cocoa 的 NSNotification 获得的松散耦合，因为在 Java 中，提供者和订阅者必须相互引用。比较“为 Java 开发人员学习 Objective-C”中的第 18 章。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-12T19:39:33.387

在**Java** 中有一个**IOS** **NSNotificationCenter**的实现。 您可以在以下位置找到源代码： [This Github project](http://getobjects.googlecode.com/svn/core/trunk/org/getobjects/foundation/NSNotificationCenter.java)

 **# language-agnostic - 自动跟踪开发时间

> ID：488922
> 
> 赞同：29
> 
> 时间：2009-01-28T19:08:35.417
> 
> 标签：language-agnostic, development-environment

我正在做一个个人项目，我很想在最后说：“我在这个项目上花了 X 个小时”。现在解决这个问题的一种方法是使用手动时间跟踪器（从：到：）。我遇到了这个问题，因为我只能在第一周或两周内始终如一地使用它。所以我想自动跟踪开发时间。

我的一个想法是在构建过程中插入一个简短的脚本，每次调用构建过程时都会在日志文件中插入一个时间戳。稍后，我可以分析每个构建之间的间隔，并希望计算出对正在发生的事情的准确描述。

有没有人知道如何实现这样的时间跟踪工具？

根据已经提供的答案快速跟进：

1.  停止/启动跟踪器还不错，但需要大量的纪律，这是我可能应该努力的。但他们不为我工作。
2.  特定的应用程序跟踪程序很棒，但我目前在 Mac OS X 上。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-28T21:04:55.497

我的观点是，保持一份轻量级的开发日志会让你受益匪浅。笔记、草图、时间、日期等，设计。这不是您问题的答案，但它是很少有开发人员拥有的一门学科，也是他们迫切需要的一门学科。

生活很忙，人们必须学会跟踪/预算他们的时间并约束自己以养成良好的行为和习惯。

我鼓励你战斗并赢得这场战斗。如果您提高技能，当有更大的收益时，不要妥协如此容易自动化的东西。您可能还想查看 LifeHacker 以获得一些想法。

有点没有答案，但我希望你觉得它有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-25T23:13:59.993

如果您使用源代码控制，则可以在签出和签入项目时在提交和签出时使用 svn（或任何其他）挂钩将时间戳记录到数据库等。

完成这项工作的诀窍——在单个开发人员项目中最简单——是确保在完成一段时间的工作后检查你的工作，并在进行实际工作之前立即检查。

这对于您的项目可能不可行。构建过程检查等也会遇到同样的问题 - 即您可能工作 3 小时，然后再构建 8 小时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T19:24:35.120

我们为我们的 IDE（在我们的例子中是 IntelliJ）编写了一个插件，它可以自动跟踪每个项目花费的时间。IDE 的 API 允许您列出编辑、更改窗口等事件，因此我们会在每次发生此类事件时记录一个记录。报告模块查看这些原始数据并通过比较记录之间的时间戳来确定每个项目花费的总时间。如果差异大于 5 分钟，则假定在此期间未完成任何工作。

它并不完美，也不是 100% 准确，但您确实消除了通过一些外部工具自己手动跟踪这些东西的所有偷听。

# c# - Silverlight TreeView ScrollBars 在 StackPanel 中消失

> ID：488923
> 
> 赞同：2
> 
> 时间：2009-01-28T19:08:38.413
> 
> 标签：c#, silverlight

我正在构建一个将数据从 web 服务加载到 TreeView 控件的项目。当 TreeView 本身包含在 LayoutRoot 网格中并且它的高度设置为 Auto 时，如果内容超出了 treeview 滚动条的垂直或水平限制，则会按预期自动出现。

如果将相同的 TreeView 控件放置在 StackPanel 中，它的行为就会发生变化。当数据超出其限制时，不会出现滚动条，并且数据只是从边缘剪掉而无法访问。如果我在这种情况下手动设置 TreeView 的高度，滚动条将按预期再次出现。

显然，StackPanel 和 TreeView 之间似乎存在一些我没有看到的交互。

任何人都可以解释这一点并提出适当的方法来处理这种情况吗？

根据评论中的要求：

以下 XAML 工作正常并按预期呈现滚动条（注意 TreeView 上的高度已指定）：

```
<StackPanel >
            <controls:TreeView ItemTemplate="{StaticResource MainEntryIndexTemplate}" 
                                     x:Name="CodeBookIndexTreeView" Height="500" />
</StackPanel> 
```

以下还按预期显示滚动条（注意没有 StackPanel，但 TreeView 的高度设置为自动）：

```
 <controls:TreeView ItemTemplate="{StaticResource MainEntryIndexTemplate}" 
                                 x:Name="CodeBookIndexTreeView" Height="Auto" /> 
```

最后，此代码失败，因为 TreeView 将不显示滚动条，并且数据从控件的底部和/或右侧滚动（注意 TreeView 在 StackPanel 中并且 TreeView 的高度设置为 Auto）：

```
<StackPanel >
                <controls:TreeView ItemTemplate="{StaticResource MainEntryIndexTemplate}" 
                                         x:Name="CodeBookIndexTreeView" Height="Auto" />
    </StackPanel> 
```

干杯，

史蒂夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T20:40:31.037

在 Silverlight.net 论坛的帮助下，设法弄清楚了这一点。[您可以在此处](http://silverlight.net/forums/p/69145/167215.aspx#167215)阅读原始问题和答案。事实证明，垂直方向（默认方向）的 StackPanel 将为其子级提供无限大小，因此由于 TreeView 具有无限大小，滚动条将永远不会显示。使用网格作为布局元素时不会发生这种情况。

以下 XAML 将按预期呈现 TreeView 滚动条。（请注意，TreeView 包含在 Grid 的第 2 行，而不是 StackPanel 中，并且 TreeView 的 Height 设置为 Auto。）此代码段中有一些额外的控件，因为这是在第一名：

```
<Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <StackPanel Orientation="Horizontal" Grid.Row="0">
                <TextBlock Text="Enter Search Term" />
                <TextBox x:Name="SearchTermTextBox" Width="200" KeyUp="SearchTermTextBox_KeyUp"/>
            </StackPanel>
            <Button x:Name="SearchButton" Content="Search" Click="SearchButton_Click" Width="100" 
                      HorizontalAlignment="Left" Grid.Row="1" />
            <controls:TreeView ItemTemplate="{StaticResource MainEntryIndexTemplate}" 
                                     x:Name="CodeBookIndexTreeView" Height="Auto" Grid.Row="2" />
</Grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T19:38:22.877

是的 - StackPanels 似乎不是包含可变大小对象的一个​​很好的控件。

相似地; 我在使用由堆栈面板中的文本块组成的 DataTemplates 时遇到了麻烦，在 ListBox 中用作 ListItem 模板。意图是让文本块换行，但它只是继续超出列表框的边界，没有水平滚动。到目前为止，我管理的最好的方法是修复包含堆栈面板的网格的宽度，但尚未找到令人满意的解决方案.. 很想知道是否有一个！

# java - 哪些 Java MVC 框架可以轻松与 StringTemplate 集成？

> ID：488930
> 
> 赞同：17
> 
> 时间：2009-01-28T19:11:32.260
> 
> 标签：java, frameworks, integration, template-engine, stringtemplate

很难看出*StringTemplate*如何轻松（或不）与*流行的*Java Web MVC 框架集成。

**哪些 Java MVC 框架可以轻松与 StringTemplate 集成？**

一个很好的答案：

*   提到了一种与框架集成的**解决方案，**
*   包括指向有用和适用 的内容的**链接，例如：**
    *   一个**教程**，
    *   或**文件**，
    *   或对**源代码**的引用：
        *   **免费**，
        *   和**开源**或**公共领域**。

**读者/选民**，如果您知道它是真实且伟大的，请为解决方案投票。

在这个问题的范围内，除了 StringTemplate 之外，我*对任何其他模板引擎都不感兴趣*。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-28T21:54:09.953

我已经让 StringTemplate 与 Spring 一起工作。基本上，只需要一个自定义视图。

但首先，免责声明：这是一个实验性的黑客攻击。我从未在生产代码中使用过它，在此之前它可以使用一些改进。不过，我认为回答您关于 StringTemplate 与 Web MVC 框架集成的难易程度的问题就足够了。

参考：[Spring Web MVC 文档](http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html)

字符串模板视图.java：

```
import java.io.PrintWriter;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.antlr.stringtemplate.StringTemplate;
import org.antlr.stringtemplate.StringTemplateGroup;
import org.springframework.core.io.Resource;
import org.springframework.web.servlet.view.InternalResourceView;

public class StringTemplateView extends InternalResourceView {

    @Override
    protected void renderMergedOutputModel(Map model, HttpServletRequest request,
            HttpServletResponse response) throws Exception {

        // Provides a Spring resource descriptor referring to the .st file
        Resource templateFile = getApplicationContext().getResource(getUrl());

        // Kind of redundant...
        StringTemplateGroup group = new StringTemplateGroup("group", templateFile.getFile().getParent());
        StringTemplate template = group.getInstanceOf(getBeanName());
        template.setAttributes(model);

        // Output to client
        PrintWriter writer = response.getWriter();
        writer.print(template);
        writer.flush();
        writer.close();
    }
} 
```

还有一个示例视图解析器定义：

```
<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="viewClass" value="myapp.web.view.StringTemplateView"/>
    <property name="prefix" value="/WEB-INF/st-views/"/>
    <property name="suffix" value=".st"/>
</bean> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T21:34:28.120

快速搜索后，我[看到了使用 StringTemplate 作为 Spring 视图的演示](http://jira.springframework.org/browse/SPR-3266)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-29T03:44:14.413

有一个不错的 StringTemplate 实现作为 Spring MVC 的视图，它也支持 SiteMesh 集成。

[https://github.com/tomcz/spring-stringtemplate/](https://github.com/tomcz/spring-stringtemplate/)

在这个项目中有一个使用 ST 作为视图技术的 webapp 示例实现（包括 sitemesh 集成）。这里不值得重复，所以直接指向它的指针是：

[https://github.com/tomcz/spring-stringtemplate/tree/master/src/test/webapp/WEB-INF](https://github.com/tomcz/spring-stringtemplate/tree/master/src/test/webapp/WEB-INF)

作者还提供了对 XSS 预防的编码/转义输出的支持。这种支持适用于 HTML、CSS、XML、JS 和 URL。

如果您是 Maven 用户，该项目可在 central

```
<dependency>
  <groupId>com.watchitlater</groupId>
  <artifactId>spring-stringtemplate</artifactId>
  <version>1.5.1</version>
</dependency> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-21T12:09:02.267

开源的 Java WEB 框架[JPublish](http://code.google.com/p/jpublish/)，与 ST 配合得非常好。按照上面的链接，您将在那里找到以下内容：

*   JPublish 框架用户指南
*   一个实用的演示（可从 Google 代码下载 ~5.7MB）向您展示如何使用 JPublish 中的 ST。你会意识到它是多么容易。

玩得开心，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T15:51:57.223

某位 Harry Karamidas于 2008 年 12 月在 ST 的官方网站上[分享了一个](http://www.stringtemplate.org/share/list)**Struts适配器。**[直接链接](http://www.stringtemplate.org/share/1229347891527/st_struts_adapter_with_demo.0.2.zip)到 zip 文件。

# html - 如何将 HTML 表格转换为固定字体的文本表格？

> ID：488936
> 
> 赞同：6
> 
> 时间：2009-01-28T19:14:12.957
> 
> 标签：html, perl, text

我在 Perl 中有一个应用程序，它读取基于 HTML 的标记并将其转换为文本输出。我遇到的一件事是需要轻松地将 HTML 表格转换为固定字体输出。

```
 <table border="1">
 <tr><td>Hello</td>
     <td>World</td>
 <tr>
     <td>foo</td>
     <td>bar</td>
 </tr></table> 
```

我正在寻找可以采用上表并创建类似以下内容的东西。

```
 ------------------------------
 | Hello     | World          |
 ------------------------------
 | foo       | bar            |
 ------------------------------ 
```

我知道如何在 Perl 中解决这个问题并编写该过程，但我希望那里有一些库已经可以为我做这件事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T19:37:21.350

我使用[Text::Table](http://search.cpan.org/~anno/Text-Table-1.114/lib/Text/Table.pm)取得了巨大成功。结合[HTML::TreeBuilder](http://search.cpan.org/~petek/HTML-Tree-3.23/lib/HTML/TreeBuilder.pm)之类的东西应该很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T21:17:32.617

如果可用，我会使用外部程序，如[lynx](http://en.wikipedia.org/wiki/Lynx_(web_browser))、[links](http://en.wikipedia.org/wiki/Links_(web_browser))或[w3m](http://en.wikipedia.org/wiki/W3m)。不过，我不知道他们中的任何一个是否可以处理向他们抛出的任意 HTML。

# c# - 在 C# 中使除法返回双倍的最佳实践是什么

> ID：488942
> 
> 赞同：5
> 
> 时间：2009-01-28T19:15:53.827
> 
> 标签：c#

在 c# 中，当您想除以如下方法的结果时，强制它返回双精度值而不是默认整数的最佳方法是什么。

```
(int)Math.Ceiling((double)(System.DateTime.DaysInMonth(2009, 1) / 7)); 
```

如您所见，我需要除法返回一个双精度数，以便我可以使用上限函数。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-28T19:20:11.230

两个数字相除`int`返回一个`int`，截断任何小数点。这通常也适用于其他数据类型：算术运算不会更改其操作数的类型。

因此，要强制执行某种返回类型，您必须适当地转换操作数。在您的特定情况下，将其中一个运算符转换为 : 实际上就足够了`double`，C# 将自动执行另一个操作数的转换。

您可以选择：您可以显式转换任一操作数。然而，由于第二个操作数是一个*字面*量，最好直接将该字面量设为正确的类型。

这可以使用类型后缀（**`d`**在 的情况下`double`）或在其后面写一个小数点来完成。后一种方式通常是优选的。在你的情况下：

```
(int)Math.Ceiling(System.DateTime.DaysInMonth(2009, 1) / 7.0); 
```

请注意，这个小数点表示法总是产生*`double`*. 要制作`float`，您需要使用其类型后缀：`7f`.

顺便说一句，基本运算符的这种行为对于几乎所有语言来说都是相同的。一个值得注意的例外：VB，其中除法运算符通常产生`Double`. `\`如果不需要该转换，则有一个特殊的整数除法运算符 ( )。另一个例外以一种奇怪的方式与 C++ 相关：相同类型的两个指针之间的区别是`ptrdiff_t`. 这是有道理的，但它打破了运算符始终产生与其操作数相同类型的模式。特别是，减去 2`unsigned int`不会*产生*a `signed int`。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-28T19:23:15.200

将 7 更改为双倍：

```
(int) Math.Ceiling(System.DateTime.DaysInMonth(2009, 1) / 7.0); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T19:24:09.863

只需除以文字双精度：

```
(int)Math.Ceiling((System.DateTime.DaysInMonth(2009, 1) / 7.0)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T19:19:25.817

据我所知，你不能强制一个函数返回不同的类型，所以转换结果是你最好的选择。将函数的结果转换为双精度然后除法应该可以解决问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T19:27:57.097

为了扩展康拉德的答案......

将 7 更改为 7.0，将 7 更改为 7D，将 7 更改为 7M 都可以为您提供您想要的答案。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-08-24T17:27:32.270

对于完全避免强制转换和浮点数学的完全不同的方法......

```
int result = val1 / val2;
if (val1 % val2 != 0) result++; 
```

所以，在你的情况下......

```
int numDaysInMonth = System.DateTime.DaysInMonth(2009, 1);
int numWeeksInMonth = numDaysInMonth / 7;
if (numDaysInMonth % numWeeksInMonth != 0) numWeeksInMonth++; 
```

这种方法非常冗长，但在某些特殊情况下可能更可取。从技术上讲，模数方法应该有轻微的性能优势，但你很难测量它。

在你的情况下，我会坚持接受的答案:-)

# silverlight - 如何在 Silverlight 中设置组合框以允许单击项目？

> ID：488949
> 
> 赞同：2
> 
> 时间：2009-01-28T19:18:26.910
> 
> 标签：silverlight, combobox

我的应用程序中有几个数据绑定组合框，我注意到当我打开组合框以单击一个项目时，它不会选择该项目，除非我单击文本的右侧。我假设在进行选择时，有某种方法可以将文本区域作为项目的一部分。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T20:26:11.207

我正在使用：

```
<ComboBoxItem Content="{Binding time}"/> 
```

在我切换到它之后它工作得很好：

```
<TextBlock Text="{Binding time}"/> 
```

现在无论我在哪里点击它仍然选择。

希望这对下一个人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-01T12:39:43.157

感谢您的提示，我也想出了如何解决它，但是像您一样，我认为默认设置会像这样工作，所以我搜索了一个简单的答案。我错了，您必须处理点击并手动将其传回

干杯

# authentication - 为什么要创建两个身份验证 cookie？一个用于 www，另一个不带 www

> ID：488951
> 
> 赞同：2
> 
> 时间：2009-01-28T19:18:51.357
> 
> 标签：authentication, cookies, dotnetnuke

我的 dotnetnuke 网站出现了这个问题，其中 .DOTNETNUKE cookie 被创建了两次，

一种用于 www.website.com，另一种用于 website.com。

当用户使用 website.com 的 url 登录并尝试访问 www.website.com 的页面时，它会导致他们使用 www.website.com 的新 cookie 重新登录。这会产生两个 cookie，一个用于 www.website.com，另一个用于 website.com。

我该如何解决这个问题，有没有人有任何想法从哪里开始？

谢谢！约翰

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T19:30:09.027

这与点规则有关。浏览器所做的一项安全检查是确保 cookie 的域具有与其所在域相同的句点数。来自 www.example.com 的 cookie 将具有域“www.example.com”或“*.example.com”，而来自“example.com”的 cookie 将具有域“example.com”。所以浏览器的想法是“example.com 与 www.example.com 不/可能不一样，最好获取一个新的 cookie 以防万一。”

设置您的服务器，使其将您的用户重定向到 www 或 no-www。确保您选择其中一个并坚持下去。拥有两个不仅会导致您当前的 cookie 问题，而且可能会损害您的页面在搜索引擎中的排名。

请参阅此处了解更多信息：

[关于 SO 的问题](https://stackoverflow.com/questions/486621/when-should-one-use-a-www-subdomain#486763)

[点规则的东西](http://my.opera.com/yngve/blog/show.dml/267415)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T22:18:36.157

为了避免 IIS 配置，我在这里[http://urlrewriting.net/149/en/home.html](http://urlrewriting.net/149/en/home.html)找到了一个 url 重写工具。它就像一个魅力！

# c++ - 如何创建对模板类执行操作的静态模板成员函数？

> ID：488959
> 
> 赞同：25
> 
> 时间：2009-01-28T19:20:17.237
> 
> 标签：c++, stl, templates, vector, static-members

我正在尝试创建一个从 std::vector 中删除重复项的通用函数。因为我不想为每个向量类型创建一个函数，所以我想让它成为一个模板函数，可以接受任何类型的向量。这是我所拥有的：

```
//foo.h

Class Foo {

template<typename T>
static void RemoveVectorDuplicates(std::vector<T>& vectorToUpdate);

};

//foo.cpp

template<typename T>
void Foo::RemoveVectorDuplicates(std::vector<T>& vectorToUpdate) {
for(typename T::iterator sourceIter = vectorToUpdate.begin(); (sourceIter != vectorToUpdate.end() - 1); sourceIter++) {
        for(typename T::iterator compareIter = (vectorToUpdate.begin() + 1); compareIter != vectorToUpdate.end(); compareIter++) {
            if(sourceIter == compareIter) {
                vectorToUpdate.erase(compareIter);
            }
        }
    }
}

//SomeOtherClass.cpp

#include "foo.h"

...

void SomeOtherClass::SomeFunction(void) {
    std::vector<int> myVector;

    //fill vector with values

    Foo::RemoveVectorDuplicates(myVector);
} 
```

我不断收到链接器错误，但它编译得很好。关于我做错了什么的任何想法？

更新：根据 Iraimbilanja 给出的答案，我去重写了代码。但是，以防万一有人想让工作代码执行 RemoveDuplicates 函数，这里是：

```
//foo.h

Class Foo {

    template<typename T>
    static void RemoveVectorDuplicates(T& vectorToUpdate){
        for(typename T::iterator sourceIter = vectorToUpdate.begin(); sourceIter != vectorToUpdate.end(); sourceIter++) {
            for(typename T::iterator compareIter = (sourceIter + 1); compareIter != vectorToUpdate.end(); compareIter++) {
            if(*sourceIter == *compareIter) {
                compareIter = vectorToUpdate.erase(compareIter);
            }
        }
    }
}; 
```

事实证明，如果我在签名中指定 std::vector，迭代器将无法正常工作。所以我不得不采用更通用的方法。此外，当擦除 compareIter 时，循环的下一次迭代会产生指针异常。擦除后 compareIter 的后减量可以解决该问题。我还修复了迭代器比较和第二个循环中 compareIter 初始化中的错误。

更新 2：

我看到这个问题又得到了赞成票，所以我想用一个更好的算法来更新它，这个算法使用了一些 C++14 的优点。我的前一个只有在向量中存储的类型实现 operator== 并且它需要一堆副本和不必要的比较时才有效。而且，事后看来，没有必要让它成为一个类的成员。这种新算法允许自定义比较谓词，在发现重复项时缩小比较空间，并显着减少副本数量。名称已更改为`erase_duplicates`更好地符合 STL 算法命名约定。

```
template<typename T>
static void erase_duplicates(T& containerToUpdate) 
{
    erase_duplicates(containerToUpdate, nullptr);
}

template<typename T>
static void erase_duplicates(T& containerToUpdate, 
  std::function<bool (typename T::value_type const&, typename T::value_type const&)> pred) 
{
    auto lastNonDuplicateIter = begin(containerToUpdate);
    auto firstDuplicateIter = end(containerToUpdate);
    while (lastNonDuplicateIter != firstDuplicateIter) {
        firstDuplicateIter = std::remove_if(lastNonDuplicateIter + 1, firstDuplicateIter, 
            [&lastNonDuplicateIter, &pred](auto const& compareItem){
            if (pred != nullptr) {
                return pred(*lastNonDuplicateIter, compareItem);
            }
            else {
                return *lastNonDuplicateIter == compareItem;
            }
        });
        ++lastNonDuplicateIter;
    }
    containerToUpdate.erase(firstDuplicateIter, end(containerToUpdate));
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-28T19:30:04.767

## 简答

在头文件中定义函数，最好在类定义中。

## 长答案

在 .cpp 中定义模板函数意味着它不会`#include`d 进入任何翻译单元：它只对定义它的翻译单元可用。

因此`RemoveVectorDuplicates`必须在头文件中定义，因为这是编译器可以文本替换模板参数的唯一方法，从而*实例化*模板，生成可用的类。

### 对于这种不便，有两种解决方法

**首先**，您可以从 .cpp 中删除并在*标题**末尾*`#include "foo.h"`添加另一个：

 **```
#include "foo.cpp" 
```

这使您可以一致地组织文件，但不提供单独编译的通常优势（更小的依赖项，更快和更少的编译）。

**其次**，您可以在 .cpp 中定义模板函数，并为所有将要使用的类型显式实例化它。

例如，这可以放在 .cpp 的末尾以使该函数可与`int`s 一起使用：

```
template void Foo::RemoveVectorDuplicates(std::vector<int>*); 
```

但是，这假设您只使用模板来节省一些输入，而不是提供真正的通用性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T04:39:46.810

您可以选择的一种方法是首先`std::sort()`使用向量，然后使用预先存在的`std::unique()`函数删除重复项。排序需要 O(nlog n) 时间，之后删除重复项只需要 O(n) 时间，因为所有重复项都出现在一个块中。您当前的“all-vs-all”比较算法需要 O(n^2) 时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T19:26:28.987

您不能在 .cpp 文件中实现模板函数。完整的实现必须在任何实例化的地方都可见。

只需在标题中的类定义内定义函数即可。这是实现模板函数的常用方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T22:04:24.457

我建议使用更“通用”的方法，而不是传递一个容器，只接收两个迭代器。

像 It remove_duplicates(It first, It last) 这样的东西，会返回一个迭代器，所以你可以像 remove: 一样调用`v.erase(remove_duplicates(v.begin(), v.end()), v.end())`。

```
template <typename It>
It remove_duplicate(It first, It last)
{
  It current = first;
  while(current != last) {
    // Remove *current from [current+1,last)
    It next = current;
    ++next;
    last = std::remove(next, last, *current);
    current = next;
  }
  return last;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T19:48:31.623

与您的问题无关（已经解释过），为什么这是一个静态函数而不是全局驻留在命名空间中？这将有点 C++-ier。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T20:00:47.387

我不认为代码编译....

vectorToUpdate.erase where std::vector* vectorToUpdate.... 有没有其他人注意到应该有 & 的地方有 *？该代码绝对没有被编译。如果要使用指向向量的指针，则必须使用“->”而不是“。” 我知道这实际上有点挑剔，但它指出编译器甚至不关心你的代码......

# php - 解析bbcode的最佳方法

> ID：488963
> 
> 赞同：9
> 
> 时间：2009-01-28T19:21:57.763
> 
> 标签：php, cakephp, bbcode, sablecc

我想为 php 网站开发一个 bbcode 过滤器。（我正在使用 cakephp，它将是一个 bbcode 助手）我有一些要求。

**Bbcodes 可以嵌套。所以这样的事情是有效的。**

```
[block]  
    [block]  
    [/block]  
    [block]  
        [block]  
        [/block]  
    [/block]  
[/block] 
```

**Bbcode 可以有 0 个或多个参数。**

示例：

```
[video: url="url", width="500", height="500"]Title[/video] 
```

**Bbcodes 可能有多种行为。**

比方说，`[url]text[/url]`将转换为`[url:url="text"]text[/url]` 或视频 bbcode 将能够在 youtube、dailymotion 之间进行选择......

我认为它可以满足我的大部分需求。我已经用正则表达式做了一些事情。但我最大的问题是匹配参数。事实上，我得到了嵌套的 bbcode 和 0 参数的 bbcode。但是当我为参数添加正则表达式匹配时，它没有正确匹配嵌套的 bbcode。

`"\[($tag)(=.*)\"\](.*)\[\/\1\]"` // 不是 .* 而是非贪婪匹配器

我现在没有完整的正则表达式，但我有一些看起来像那样的东西（上图）。

那么有没有办法用正则表达式或其他东西有效地匹配 bbcode。我唯一能想到的是使用访问者模式并以这种方式将我的文本与每个可能的标签分开，我可以对我的文本解析有更多的控制，我可能可以验证我的文档，所以如果输入文本没有'没有有效的 bbcode。我可以在保存任何内容之前通知用户错误。

我会使用 sablecc 创建我的文本解析器。 [http://sablecc.org/](http://sablecc.org/)

有更好的主意吗？或任何可能导致高效灵活的 bbcode 解析器的东西？

谢谢你，对不起我的英语不好......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T19:36:02.553

有几个现有的用于解析 BBCode 的库，查看这些库可能比尝试使用自己的库更容易：

这是一对，如果你环顾四周，我相信还有更多：
[PECL bbcode](http://pecl.php.net/package/bbcode)
[PEAR HTML_BBCodeParser](http://pear.php.net/package/HTML_BBCodeParser)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-18T04:46:39.167

我自己一直在研究 bbcode 解析器。他们中的大多数使用正则表达式和 PHP4 并在 PHP 5.2+ 上产生错误或根本不工作。PECL bbcode 和 PEAR HTML_BBCodeParser 似乎不再维护（2012 年末），并且不容易安装在我必须使用的共享主机设置上。[StringParser_BBCode](http://www.christian-seiler.de/projekte/php/bbcode/index_en.html)对 5.2+ 进行了一些小的调整，但添加新标签的方法很笨拙，最后一次更新是在 2008 年。

埋在 Bing 搜索的第 4 页（我快绝望了），我找到[了 jBBCode](http://jbbcode.com/)，它看起来很新，需要 PHP 5.3。麻省理工学院执照。我还没有尝试构建自定义标签，但到目前为止，它是我尝试过的唯一一个在使用 PHP 5.3 的共享主机帐户上开箱即用的标签。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-28T21:06:59.407

有一个[pecl](http://pecl.php.net/package/bbcode)和[PEAR](http://pear.php.net/package/HTML_BBCodeParser) BBCode 解析库。无需重新发明您自己多年的工作，软件就足够难了。

如果这些都不是一个选项，我会专注于将 BBCode 转换为有效的 XML 字符串，然后使用您最喜欢的 XML 解析例程。这里非常非常粗略的想法，但是

1.  通过 htmlspecialchars 运行代码以转义任何需要转义的实体

2.  将所有 [ 和 ] 字符分别转换为 < 和 >

3.  不要忘记在 [tagname:

如果 BBCode 嵌套正确，您应该都可以将此字符串传递给 XML 解析对象（SimpleXML、DOMDocument 等）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T19:32:48.583

> 回应：“有更好的主意吗？” （我假设这不仅仅是为了改进 bbcode 特定建议的邀请）

我们最近研究了 bbcode 路线，并决定改用[htmlpurifier](http://htmlpurifier.org/)。该决定部分基于此处 htmlpurifier 组列出的各种方法之间的比较（诚然可能有偏见）以及[此处](http://htmlpurifier.org/comparison.html#Summary)对 bbcode 的讨论（同样，由 htmlpurifer 组[）](http://htmlpurifier.org/comparison.html#AltMarkup)

而且我认为你的英语非常好。我相信这比我用你的母语做的要好得多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-03-09T20:47:26.450

使用`preg_split()`with `PREG_DELIM_CAPTURE`flag 将源代码拆分为标签和非标签。然后迭代保持打开块堆栈的标签（即，当您看到开始标签时，将其添加到数组中。当您看到结束标签时，从数组末尾删除元素，直到结束标签与开始标签匹配。）

# c# - 什么是最好的 C# 字体选择控件？

> ID：488967
> 
> 赞同：2
> 
> 时间：2009-01-28T19:23:07.213
> 
> 标签：c#, winforms, fonts

首先，这个问题的一些背景......

我有一个生成网页的 C# .NET 2.0 程序...我正在寻找一种控件，该控件允许用户选择 Web 友好字体以用于生成网页以在尽可能多的计算机上运行。我目前正在使用 MS 字体对话框，但我还没有找到过滤它的可用字体列表的方法。此外，如果它具有更有吸引力的使用界面，我不介意购买控件...

所以...您觉得哪种字体选择/挑选控件最好，哪些属性适合您的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T04:20:40.163

我最喜欢的可以通过[DevExpress.com](http://www.devexpress.com/)获得。他们的[ExtraEditors](http://www.devexpress.com/Help/?document=XtraEditors)库有一个 FontEdit 组件。此外，如果您接受他们的控件，它将改善您的应用程序的整体外观。

[http://www.devexpress.com/Products/NET/Controls/WinForms/Editors/](http://www.devexpress.com/Products/NET/Controls/WinForms/Editors/)

# mediawiki - 有没有一种简单的方法来制作一个令人愉悦的 mediawiki 表格？

> ID：488969
> 
> 赞同：8
> 
> 时间：2009-01-28T19:24:08.227
> 
> 标签：mediawiki

我在拇指驱动器上使用 MediaWiki 实例来跟踪大量内容。过去，我一直很着急，所以我没有机会寻找一种制作表格的好方法，所以这种语法很好地满足了我的目的：

```
{| border=1
...
|} 
```

现在我想要一些更好的东西；我习惯于使用 CSS 来制作更好的表格边框，但我没有找到一种通过 MediaWiki 执行此语法的干净方法。基本上，我想要一个看起来等同于这个 HTML 的表格：

```
<table style="border-collapse: collapse">
    <tr>
        <td style="border: 1px solid black">one</td>
        <td style="border: 1px solid black">two</td>
    </tr>
</table> 
```

在每个单元格上设置边界将很困难。我最初的猜测是我需要在某处的 CSS 文件中添加一个表类；如果是这样，适当的文件可能位于何处？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-02T19:08:10.153

像他们在 Wikipedia 中所做的那样：创建一个“[漂亮](http://fi.wikipedia.org/wiki/Template:Prettytable)的”模板（参见[源代码](http://fi.wikipedia.org/w/index.php?title=Malline:Prettytable&action=edit)；你可以跳过花哨的`<noinclude>`东西），在其中放置一些 HTML / CSS，例如：

```
border="1" cellpadding="4" cellspacing="0" style="margin: 1em 1em 1em 0; 
background: #f9f9f9; border: 1px #aaa solid; border-collapse: collapse;" 
```

然后在你的表格中使用这样的模板；它做了一个简单的“包含”：

```
{| {{Prettytable}}
...
|} 
```

相同的技术可用于样式单元格。你应该在不同的维基百科（和其他维基媒体项目）中找到更多这样的例子。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-28T19:37:00.463

您可以自定义通过 MediaWiki 命名空间中的页面使用的 CSS，例如**`MediaWiki:Common.css`**. 还有皮肤特定的 CSS 页面，例如**`MediaWiki:Monobook.css`**默认皮肤。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T19:32:31.050

正如您所写，您可以编辑[Mediawiki CSS 文件](http://www.mediawiki.org/wiki/Manual:CSS)。这是要走的路; 但是，如果由于某种原因您不能使用 CSS，您始终可以使用包含特定于单元格样式标签的 Wiki 模板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-31T22:49:25.333

使用此工具快速生成表格 - [http://www.tablesgenerator.com/mediawiki_tables](http://www.tablesgenerator.com/mediawiki_tables)

# file-io - 文件访问被拒绝，C# 控制台应用程序错误

> ID：488976
> 
> 赞同：2
> 
> 时间：2009-01-28T19:26:16.350
> 
> 标签：file-io, c#-3.0, access-denied

这是 C# (3.0) 控制台应用程序的一个非常奇怪的安全问题。

该应用程序创建一个文件夹并将一堆文件复制到该文件夹​​中，然后它还会生成一些文件并将它们保存到同一个文件夹中。文件流总是关闭的。复制的文件是使用 File.Copy 完成的。一旦文件在那里，我似乎无法再次访问它们 - 在代码的后面，如果我想删除或打开现有文件，我会收到拒绝访问错误，但我只是在那里创建或复制了文件所以我知道我有权限！

Visual Studio 2008, Windows 7 (beta) - 尝试以管理员身份运行，但没有帮助。我还授予了父文件夹权限，以便“每个人”都具有写入权限，并且它位于我登录的用户文档文件夹下。

谢谢！

更新：我在 XP 上试过，结果相同，所以不是 Win 7 :)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T20:45:03.150

文件是否设置了只读属性？尝试删除只读文件可能会引发拒绝访问异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T19:50:19.233

如果您在 using 块中执行所有流声明，则应保证它们不会导致问题。

# asp.net - 为什么 Response.Redirect 关闭我的浏览器窗口而不是重定向？

> ID：488982
> 
> 赞同：0
> 
> 时间：2009-01-28T19:27:37.050
> 
> 标签：asp.net, response.redirect

无论出于何种原因，当我使用 Response.Redirect 时，窗口只是关闭而不是导航到给定的 URL，这里是代码。

```
 if (mode == "print")
    {
        error_code.Text = "";
        //thumb.Src = file_loc + "source/" + "certificate_thumbnail.jpeg";
        link.HRef = "Certificates/" + u_name + ".pdf";
        link.Visible = true;
        Response.Redirect("http://xx.xxxxxxxxxxxxx.xx.gov/cert/Certificates/" + u_name + ".pdf");

    } 
```

（考虑到我的客户是谁，出于安全考虑，我删除了网址......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T19:30:25.687

也许 Adob​​e Reader 插件正在使浏览器崩溃？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T19:30:48.307

使用 Firefox 中的 Firebug 或用于 Internet Explorer 的[Fiddler](http://www.fiddlertool.com/)之类的 http 调试代理来准确查看服务器的响应包含的内容。也许响应不是 PDF，而是包含 Javascript 的 text/html `window.close()`。

我的猜测是，您发布的代码由于某种原因没有被执行，并且正在发生其他事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T19:32:19.973

您拥有的默认 PDF 阅读器可能会导致这种情况。

如果你这样做

```
Response.Redirect("http://www.google.com"); 
```

发生什么了？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T13:34:34.987

问题是由于您打开了一个包含重定向到 .pdf 的 aspx 页面。由于 aspx 在 IE 打开时已预编译，因此它期望 text/html 返回 - 但是，当您重定向它实际接收的应用程序/pdf 时，IE 会自行关闭并关闭。在 Firefox 中试一试——我敢打赌，效果很好。

我目前实际上有完全相同的问题，但尚未找到解决方法。但是请查看此链接[https://stackoverflow.com/questions/400010/ie-closure-just-opened-popup-window](https://stackoverflow.com/questions/400010/ie-closing-just-opened-popup-window)那里有一些好东西可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T19:47:21.143

尝试重定向到您知道有效的 PDF。通过在 Google 上搜索 PDF，我找到了这个 PDF（[http://www.utoronto.ca/cip/sa_ArtGt.pdf](http://www.utoronto.ca/cip/sa_ArtGt.pdf)）。那么，如果您重定向到该链接，它是否仍会关闭浏览器窗口？如果不是，则很可能与您的特定 PDF 文件有关。如果您的 PDF 文件有问题，请尽可能尝试重新生成它。

# c - 关于用 C 组织代码文件的最佳文章

> ID：488984
> 
> 赞同：15
> 
> 时间：2009-01-28T19:28:08.670
> 
> 标签：c, code-organization

你能推荐我为了用 C 编写一个组织良好的代码我应该阅读/学习什么吗？

我想学习的一件事是在 .h 和 .c 文件中拆分项目的原则，去哪里以及为什么，变量命名，何时使用全局变量......

我对处理这个特定问题的**书籍和文章感兴趣。**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-28T19:37:05.500

[John Lakos 所著的《Large Scale C++ Software Design](http://www.amazon.co.uk/Large-Scale-C-Software-Design-APC/dp/0201633620)》是一本涵盖很多内容的好书（适用于 C 和 C++）：

此外，要记住的一个好的经验法则是“永远不要做任何在头文件中分配内存的事情”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-05-20T11:21:13.773

关于文件布局，没有太多选择。

分区通常是以下之一（这里的包是单个库或二进制文件）：

1.  .../project/.../package/module.{c,h}
2.  .../project/.../{src,include}/package/module.{c,h} // 非接口头文件转到*src*
3.  .../project/.../package/{src,include}/module.{c,h} // 非接口头文件转到*src*

分区 (1) 很方便，因为属于特定包的所有文件都存储在一个目录中，因此可以轻松地移动包，但是通过这种方法将 API 标头与私有标头分离并检测 API 更改并非易事。(2) 和 (3) 非常相似，它们使 API 发布和 API 更改检测变得微不足道，而 (2) 在您总是发布整个项目的情况下稍微容易一些， (3) 当您发布单个包时稍微好一些（例如用于修补目的）

在任何 C/C++ 项目中，通常都有以下常用包：

1.  常用宏和数据类型
2.  记录包
3.  应用程序引导包（如果项目中有超过 1 个二进制文件）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T20:01:26.543

特定于 unix（而不是`c`natch），但仍然如此：

> [递归使被认为是有害的](http://miller.emu.id.au/pmiller/books/rmch/)

使用所描述的构建结构，您可以使用**大量**文件。所以每个逻辑单元都有一个头文件和一个源文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T19:33:27.957

我认为你将在这个主题上获得的最好的教育读物是阅读 Linux Kernel 源代码之类的东西。它有一个很好的源代码布局，基本上是标准的大型 C 项目。[这里](http://www.gsp.com/cgi-bin/man.cgi?section=9&topic=style)也是关于如何为 BSD 源代码组合源文件的指南。

说真的，只需开始阅读内核源代码并了解所有内容是如何组合在一起的。显然，这是一个计划得很好的项目。*******